<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Need help with TFTP transfering</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 22 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p191301">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">kant</div>
					<div class="post-datetime">
						7 Feb 2013, 21:28					</div>
				</div>
				<div class="post-content content">
					<p>Hi, </p><p>I bricked my Netgear wifi router WNR854T while trying to flash OpenWrt firmware, over wireless connection. Yes, it doesn&#039;t work anymore, and i got freaked out. Luckily I found the fix on Netgear&#039;s website: <br /><a href="http://kb.netgear.com/app/answers/detail/a_id/150/kw/amber/r_id/100109">http://kb.netgear.com/app/answers/detai … _id/100109</a> </p><p>I can ping it at 192.168.1.1, but the joy doesn&#039;t last very long, since Im gonna have to manually flash a new firmware over, and not having the web interface, but TFTP instead... I supposed that I dont have TFTP available in windows, so I downloaded a client exe file, but it keeps saying &quot;no tftp server available&quot;...</p><p>After a whole night messing around, I could enable the native TFTP in my laptop (Win 7, 64bit). But still, I can not flash the new firmware v1.4.38 - It keeps saying &quot;Time out expired / Retries expired&quot;, and the syntax is right, i double checked.</p><p>I tried connect to the webinterface, and found the OpenWrt interface. Should I use this interface to flash the new original firmware from netgear? </p><p>Thanks so much for your help, and so sorry for my terrible english. I&#039;m freaked out.</p>											<p class="post-edited">(Last edited by <strong>kant</strong> on 7 Feb 2013, 21:33)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p191303">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">jeffster</div>
					<div class="post-datetime">
						7 Feb 2013, 21:32					</div>
				</div>
				<div class="post-content content">
					<p>If you have the OpenWRT interface running, the first thing I would try is a flash of the OpenWRT firmware. You would use the &quot;generic&quot; version for your router&#039;s hardware since you no longer need to &quot;fool&quot; the manufacturer&#039;s loader into thinking it is OEM firmware.</p><p>If you need to use TFTP again, <a href="http://wiki.openwrt.org/doc/howto/generic.flashing.tftp">http://wiki.openwrt.org/doc/howto/generic.flashing.tftp</a> has some good suggestions.</p><p>I find that running <em>tcpdump </em>on the interface of the machine that you are going to flash from can help see the moment the router comes alive. I don&#039;t know the Windows equivalent, unfortunately.</p><p>It can be very frustrating with the short timeout of may devices. I remember spending hours one night when I soft-bricked a WRT54G.</p><p>P.S. Your English is very good!</p>											<p class="post-edited">(Last edited by <strong>jeffster</strong> on 7 Feb 2013, 21:36)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p191305">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">kant</div>
					<div class="post-datetime">
						7 Feb 2013, 21:44					</div>
				</div>
				<div class="post-content content">
					<p>Thank you so much Jeffster, there&#039;re a lot to read, and to be honest I don&#039;t know where to start from. I didn&#039;t really know what i am doing, haha. </p><p>Will ask for help if i got anymore problem, thanks.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p191307">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">lizby</div>
					<div class="post-datetime">
						7 Feb 2013, 21:52					</div>
				</div>
				<div class="post-content content">
					<p>In windows, after struggling for years with different tftp software, I have used tftpd32 and tftpd64 successfully (after turning off the firewall--remember to turn it back on).&nbsp; Easy as can be.&nbsp; This is with a direct wire from the PC to the device.</p>											<p class="post-edited">(Last edited by <strong>lizby</strong> on 7 Feb 2013, 21:55)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p191310">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">kant</div>
					<div class="post-datetime">
						7 Feb 2013, 22:03					</div>
				</div>
				<div class="post-content content">
					<p>Hi again, I tried the web interface, and flash this: openwrt-wnr854t-squashfs-webupgrade.img which i downloaded from the wiki- but got a red error: </p><p><em>The uploaded image file does not contain a supported format. Make sure that you choose the generic image format for your platform.</em></p><p>I tried with the OEM firmware but also got the same error.</p><p>What should i do now? TFTP it is? The wiki asked me to check my hardware&#039;s bootloader ... but i couldn&#039;t find it yet: </p><p><em>You must determine whether your hardware&#039;s bootloader has a TFTP client or server. Consult your specific model&#039;s OpenWRT Wiki page for details on necessary settings and the TFTP type offered if any.</em></p>											<p class="post-edited">(Last edited by <strong>kant</strong> on 7 Feb 2013, 22:07)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p191313">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">kant</div>
					<div class="post-datetime">
						7 Feb 2013, 22:26					</div>
				</div>
				<div class="post-content content">
					<p>Hi Lizby, Thanks for your help, I tried using TFTPD32, can you have a look at my settings? </p><p>Server Interface: my computer IPv4<br />I guess i&#039;m going with &quot;Client&quot; tab, since that&#039;s the only tab I can input value - detail as below:<br />- Host: Router&#039;s IP<br />- Port: No idea<br />- Local File: Firmware to transfer<br />- Remote file: blank<br />- blocksize: default<br />- and then click on PUT ... </p><p>I waited on it like 5&#039;, and it keeps saying &quot;block #0&quot; ...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p191314">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">jeffster</div>
					<div class="post-datetime">
						7 Feb 2013, 22:28					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m not familiar with that specific router, but <a href="http://wiki.openwrt.org/toh/netgear/wnr854t">http://wiki.openwrt.org/toh/netgear/wnr854t</a> suggests</p><div class="quotebox"><blockquote><p>LuCI Web Upgrade Process</p><p>Browse to the System → Flash Firmware page<br />Upload openwrt-orion-squashfs.img<br />Wait for reboot</p></blockquote></div><p>Note that the image is a &quot;generic&quot; one for the hardware</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p191328">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">lizby</div>
					<div class="post-datetime">
						8 Feb 2013, 00:18					</div>
				</div>
				<div class="post-content content">
					<p>I used &quot;Tftp server&quot; tab.&nbsp; Under settings, make sure &quot;Tftp Server&quot; is checked.&nbsp; Under &quot;TFTP&quot; in the settings window I didn&#039;t change anything except the base directory.</p><p>I have serial console available, so I did the tftpboot command from the console on the router.&nbsp; I&#039;m sorry I didn&#039;t notice that you didn&#039;t say you had serial console, so perhaps you do want &quot;client&quot; and &quot;put&quot;.</p><p>For &quot;Port&quot;, I would set it to the default tftp port, 69--but perhaps it&#039;s using that.</p><p>The wiki says the default server address is 192.168.1.2--do you have your PC set to that address?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p191339">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">qasdfdsaq</div>
					<div class="post-datetime">
						8 Feb 2013, 03:30					</div>
				</div>
				<div class="post-content content">
					<p>If LuCI is not accepting the firmware file and you are sure you are using the right one, you can try SSH into the router and use the command line flash utility - that will allow you to override the checks if you are absolutely certain you are using the correct image.</p><p>That said if you can access the web interface and the command line then the router is hardly &quot;bricked&quot;</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p191359">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">kant</div>
					<div class="post-datetime">
						8 Feb 2013, 06:49					</div>
				</div>
				<div class="post-content content">
					<p>Thank you all for your support. I do appreciate all of this. </p><p>@Jeffster: I managed to successfully flash the generic orion firmware. The Web UI is up and running good now, but the router still have that orange dim light, just like when it&#039;s bricked. Tried to flash both OEM firmware and specific Orion firmware for wnr854t, but it keeps saying <strong>The uploaded image file does not contain a supported format. Make sure that you choose the generic image format for your platform.</strong></p><p>@lizby: I found myself starring at a new error: &quot;Error in recov. Error code is 10054 (an existing connectiong was forcibly removed by the remote host&quot; - So, i&#039;m stuck. </p><p>@qasdfdsaq: thanks for joining the circle, i&#039;m not really familiar with the term &quot;SSH into the router&quot; to &quot;use the cmd line flash utility&quot; ... and i&#039;m not that certain about this img... <br />i&#039;m using the Netgear WNR854T - in the wiki it says, go with Orion, so I did, and I downloaded the &quot;webupgrade&quot; img ... but the LUCI doesn&#039;t accept it. Even the original firmware from manufacturer. </p><p>Can anyone please kindly use teamviewer to check my computer and see what&#039;s going on here??</p><p>Also, my skype name is kant.nguyen, if you have some freetime to help out, it&#039;d be great.</p>											<p class="post-edited">(Last edited by <strong>kant</strong> on 8 Feb 2013, 06:52)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p191386">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">kant</div>
					<div class="post-datetime">
						8 Feb 2013, 12:12					</div>
				</div>
				<div class="post-content content">
					<p>Hi, ive done something stupid. </p><p>Since there&#039;s a conflict in IP Address between my modem (192.168.1.1) and my wifi router (netgear - same ip), i supposed it&#039;s the cause why I don&#039;t have the internet connection. So i decided to change the wifi router&#039;s IP to 192.168.1.5 on the modem&#039;s mask (my apologize, im not familiar with the technical saying), and its broadcasting IP to 192.168.5.1 ... </p><p>Now i can&#039;t connect to the web interface anymore. The Power light which was dim orange, not change to blinking green, which was a positive news, i guess, since green is way better than red-ish orange. but turn out the homepage of the router says I got a corrupted firmware... </p><br /><p>Here&#039;s the setup: My computer connect to 2 network: <br />+ Wireless: Tenda Wifi router at 192.168.0.1, so I can still go online yelling for help.<br />+ Cable: RJ45 to my almost-bricked Netgear - I set the IP manually: Router - 192.168.5.1 // Computer - 192.168.5.2<br />I ping 192.168.5.1, but i got this &quot;Reply from 192.168.5.2: Destination Unreachable&quot; and &quot;Request time out&quot; </p><p>... <br />I tried reset factory by holding the reset button for a while, but I guess either the router&#039;s been fried, or the OpenWRT have some other way of reset...</p>											<p class="post-edited">(Last edited by <strong>kant</strong> on 8 Feb 2013, 12:33)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p191500">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">darki</div>
					<div class="post-datetime">
						9 Feb 2013, 16:38					</div>
				</div>
				<div class="post-content content">
					<p>you should check the routing table in your PC, you probably have two default routes, one of them as the real default route, the other one just dangling there. Something like this:</p><p>IPv4 Route Table<br />===========================================================================<br />Active Routes:<br />Network Destination&nbsp; &nbsp; &nbsp; &nbsp; Netmask&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Gateway&nbsp; &nbsp; &nbsp; &nbsp;Interface&nbsp; Metric<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0&nbsp; &nbsp; 192.168.137.2&nbsp; 192.168.137.119&nbsp; &nbsp; &nbsp;50<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0&nbsp; &nbsp; &nbsp; 192.168.1.1&nbsp; &nbsp; &nbsp;192.168.1.38&nbsp; &nbsp; &nbsp;35<br />---<br />now, the real default route is the one wiht smaller Metric value.<br />As windows machines tend to make a mess of routing when connected to two networks, my suggestion is to be connected to one network at any given moment (so, try first to diconnect your &quot;network for yelling for help&quot;, and see if it helps you reach the other device).</p>											<p class="post-edited">(Last edited by <strong>darki</strong> on 9 Feb 2013, 16:38)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>