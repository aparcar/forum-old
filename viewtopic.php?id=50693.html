<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> VPN Connection troubles</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 13 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p233876">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">TLN</div>
					<div class="post-datetime">
						19 May 2014, 15:57					</div>
				</div>
				<div class="post-content content">
					<p>Hello.</p><p>I set up a VPN connection, but it hangs up, it worked 10 min max. Sometimes it reconnects, sometimes not.</p><p>in Logread I got this:<br />==========<br />May 19 18:53:38 OpenWrt daemon.warn pppd[3761]: read error: Connection reset by peer<br />May 19 18:53:38 OpenWrt daemon.warn pppd[3761]: write error: Broken pipe<br />May 19 18:53:38 OpenWrt daemon.err pppd[3761]: Fatal signal 10<br />May 19 18:53:38 OpenWrt daemon.info pppd[3761]: Exit.<br />May 19 18:53:44 OpenWrt daemon.info pppd[1287]: No response to 5 echo-requests<br />May 19 18:53:44 OpenWrt daemon.notice pppd[1287]: Serial link appears to be disconnected.<br />May 19 18:53:44 OpenWrt daemon.info pppd[1287]: Connect time 9.1 minutes.<br />May 19 18:53:44 OpenWrt daemon.info pppd[1287]: Sent 47266 bytes, received 46176 bytes.<br />May 19 18:53:44 OpenWrt daemon.err pppd[1287]: MPPE disabled<br />May 19 18:53:44 OpenWrt daemon.notice netifd: Interface &#039;VPN&#039; has lost the connection<br />May 19 18:53:45 OpenWrt user.info firewall: removing VPN (pptp-VPN) from zone wan<br />May 19 18:53:47 OpenWrt daemon.notice pppd[1287]: Connection terminated.<br />May 19 18:53:47 OpenWrt daemon.notice pppd[1287]: Modem hangup<br />==========<br />I use it over 3g connection via dongle, but got no sign of errors on 3g connectivity. Device is MR-3020, if that makes sense.</p><p>What might be the cause? <br />Do you thing it will improve, if I change to L2TP IPsec connection? I guess OpenWrt supports only L2TP connection, and I need to get IPsec working. </p><p>Regards.<br />Victor.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p233909">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">nozombian</div>
					<div class="post-datetime">
						19 May 2014, 21:00					</div>
				</div>
				<div class="post-content content">
					<p>It could be problem of 3g modem/firmware. I had some trouble in here too, modem hanged and stopped to respond, making reconnect impossible. I solved it using a ping test script and when it hanged, powered off the usb and then on. But I don&#039;t have that solution anymore, it worked much more longer than 10 mins though.</p><p>First I&#039;d try to run a ping on the background to ensure your isp does not disconnect you when idle.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p233911">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">TLN</div>
					<div class="post-datetime">
						19 May 2014, 21:12					</div>
				</div>
				<div class="post-content content">
					<p>Well, my 3G connection is still online. I don&#039;t ping something, as VPN sets the default route, but anyways.<br />I&#039;ve tried to sceen a ping and see what happens. It still fails. And obviously I&#039;ve tried to ping it from outside. </p><p>I just took a logread once again:</p><p>May 19 23:56:47 OpenWrt daemon.notice netifd: Interface &#039;VPN&#039; is now up<br />May 19 23:56:48 OpenWrt user.notice ifup: Enabling Router Solicitations on VPN (pptp-VPN)<br />May 19 23:56:50 OpenWrt user.info firewall: adding VPN (pptp-VPN) to zone wan<br />May 19 23:56:53 OpenWrt daemon.info pppd[31344]: No response to 5 echo-requests<br />May 19 23:56:53 OpenWrt daemon.notice pppd[31344]: Serial link appears to be disconnected.<br />May 19 23:56:53 OpenWrt daemon.info pppd[31344]: Connect time 0.1 minutes.<br />May 19 23:56:53 OpenWrt daemon.info pppd[31344]: Sent 304 bytes, received 153 bytes.<br />May 19 23:56:53 OpenWrt daemon.info dnsmasq[1699]: reading /tmp/resolv.conf.auto<br />May 19 23:56:53 OpenWrt daemon.info dnsmasq[1699]: using nameserver 217.23.130.1#53<br />May 19 23:56:53 OpenWrt daemon.info dnsmasq[1699]: using nameserver 217.23.142.1#53<br />May 19 23:56:53 OpenWrt daemon.info dnsmasq[1699]: using nameserver 192.168.104.3#53<br />May 19 23:56:53 OpenWrt daemon.info dnsmasq[1699]: using nameserver 192.168.104.4#53<br />May 19 23:56:53 OpenWrt daemon.info dnsmasq[1699]: using local addresses only for domain lan<br />May 19 23:56:53 OpenWrt daemon.err pppd[31344]: MPPE disabled<br />May 19 23:56:53 OpenWrt daemon.notice netifd: Interface &#039;VPN&#039; has lost the connection<br />May 19 23:56:54 OpenWrt user.info firewall: removing VPN (pptp-VPN) from zone wan<br />May 19 23:56:56 OpenWrt daemon.notice pppd[31344]: Connection terminated.<br />May 19 23:56:56 OpenWrt daemon.notice pppd[31344]: Modem hangup<br />May 19 23:57:26 OpenWrt daemon.info dnsmasq[1699]: reading /tmp/resolv.conf.auto<br />May 19 23:57:26 OpenWrt daemon.info dnsmasq[1699]: using nameserver 192.168.104.3#53<br />May 19 23:57:26 OpenWrt daemon.info dnsmasq[1699]: using nameserver 192.168.104.4#53<br />May 19 23:57:26 OpenWrt daemon.info dnsmasq[1699]: using local addresses only for domain lan<br />May 19 23:57:31 OpenWrt daemon.info pppd[31344]: Using interface pptp-VPN<br />May 19 23:57:31 OpenWrt daemon.notice pppd[31344]: Connect: pptp-VPN &lt;--&gt; pptp (MYVPNSERVERNAMEHERE)<br />May 19 23:57:31 OpenWrt daemon.warn pppd[7141]: Non-zero Async Control Character Maps are not supported!<br />May 19 23:57:31 OpenWrt daemon.notice pppd[31344]: CHAP authentication succeeded<br />May 19 23:57:31 OpenWrt daemon.notice pppd[31344]: MPPE 128-bit stateless compression enabled<br />May 19 23:57:32 OpenWrt daemon.notice pppd[31344]: local&nbsp; IP address MYIPHERE<br />May 19 23:57:32 OpenWrt daemon.notice pppd[31344]: remote IP address REMOTEIPHERE<br />May 19 23:57:32 OpenWrt daemon.notice pppd[31344]: primary&nbsp; &nbsp;DNS address 217.23.130.1<br />May 19 23:57:32 OpenWrt daemon.notice pppd[31344]: secondary DNS address 217.23.142.1<br />May 19 23:57:32 OpenWrt daemon.notice netifd: Interface &#039;VPN&#039; is now up<br />May 19 23:57:34 OpenWrt user.notice ifup: Enabling Router Solicitations on VPN (pptp-VPN)<br />May 19 23:57:35 OpenWrt user.info firewall: adding VPN (pptp-VPN) to zone wan<br />May 19 23:58:07 OpenWrt daemon.info dnsmasq[1699]: reading /tmp/resolv.conf.auto<br />May 19 23:58:07 OpenWrt daemon.info dnsmasq[1699]: using nameserver 217.23.130.1#53<br />May 19 23:58:07 OpenWrt daemon.info dnsmasq[1699]: using nameserver 217.23.142.1#53<br />May 19 23:58:07 OpenWrt daemon.info dnsmasq[1699]: using nameserver 192.168.104.3#53<br />May 19 23:58:07 OpenWrt daemon.info dnsmasq[1699]: using nameserver 192.168.104.4#53<br />May 19 23:58:07 OpenWrt daemon.info dnsmasq[1699]: using local addresses only for domain lan<br />May 19 23:59:14 OpenWrt daemon.info hostapd: wlan0: STA 6c:fd:b9:ae:f7:5c WPA: group key handshake completed (RSN)<br />May 20 00:02:29 OpenWrt daemon.warn pppd[7141]: read error: Connection reset by peer<br />May 20 00:02:29 OpenWrt daemon.warn pppd[7141]: write error: Broken pipe<br />May 20 00:02:29 OpenWrt daemon.err pppd[7141]: Fatal signal 11<br />May 20 00:02:29 OpenWrt daemon.info pppd[7141]: Exit.<br />May 20 00:02:34 OpenWrt daemon.info pppd[31344]: No response to 5 echo-requests<br />May 20 00:02:34 OpenWrt daemon.notice pppd[31344]: Serial link appears to be disconnected.<br />May 20 00:02:34 OpenWrt daemon.info pppd[31344]: Connect time 5.1 minutes.<br />May 20 00:02:34 OpenWrt daemon.info pppd[31344]: Sent 5608 bytes, received 4672 bytes.<br />May 20 00:02:34 OpenWrt daemon.err pppd[31344]: MPPE disabled<br />May 20 00:02:34 OpenWrt daemon.notice netifd: Interface &#039;VPN&#039; has lost the connection<br />May 20 00:02:35 OpenWrt user.info firewall: removing VPN (pptp-VPN) from zone wan<br />May 20 00:02:37 OpenWrt daemon.notice pppd[31344]: Connection terminated.<br />May 20 00:02:37 OpenWrt daemon.notice pppd[31344]: Modem hangup<br />May 20 00:03:05 OpenWrt daemon.info dnsmasq[1699]: reading /tmp/resolv.conf.auto<br />May 20 00:03:05 OpenWrt daemon.info dnsmasq[1699]: using nameserver 192.168.104.3#53<br />May 20 00:03:05 OpenWrt daemon.info dnsmasq[1699]: using nameserver 192.168.104.4#53<br />May 20 00:03:05 OpenWrt daemon.info dnsmasq[1699]: using local addresses only for domain lan<br />May 20 00:03:10 OpenWrt daemon.info pppd[31344]: Using interface pptp-VPN<br />May 20 00:03:10 OpenWrt daemon.notice pppd[31344]: Connect: pptp-VPN &lt;--&gt; pptp (MYVPNSERVERNAMEHERE)<br />May 20 00:03:10 OpenWrt daemon.warn pppd[7440]: Non-zero Async Control Character Maps are not supported!<br />May 20 00:03:10 OpenWrt daemon.notice pppd[31344]: CHAP authentication succeeded<br />May 20 00:03:11 OpenWrt daemon.notice pppd[31344]: MPPE 128-bit stateless compression enabled<br />May 20 00:03:12 OpenWrt daemon.notice pppd[31344]: local&nbsp; IP address MYIPHERE<br />May 20 00:03:12 OpenWrt daemon.notice pppd[31344]: remote IP address REMOTEIPHERE<br />May 20 00:03:12 OpenWrt daemon.notice pppd[31344]: primary&nbsp; &nbsp;DNS address 217.23.130.1<br />May 20 00:03:12 OpenWrt daemon.notice pppd[31344]: secondary DNS address 217.23.142.1<br />May 20 00:03:12 OpenWrt daemon.notice netifd: Interface &#039;VPN&#039; is now up</p><br /><br /><p>Looks like it&#039;s the VPN server terminates the connection, or somehoe that 5echo-requests doesn&#039;t reach me. <br />Might be some firewall configuration or something else. I set some ports to forward, but this is typical services. I&#039;ve read that someone needed to add a firewall rule to accept PPTP. But it should work for a same time then. Now I got 10 mins, then 10 sec, then 5 min.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>