<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Working on Netgear WNDR3700v5</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 31 Mar 2018 and 7 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 4 of 6</div><nav><ul><li><a href="viewtopic.php%3Fid=56737&amp;p=1.html">1</a></li><li><a href="viewtopic.php%3Fid=56737&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=56737&amp;p=3.html">3</a></li><li class="pagination-current"><span>4</span></li><li><a href="viewtopic.php%3Fid=56737&amp;p=5.html">5</a></li><li><a href="viewtopic.php%3Fid=56737&amp;p=6.html">6</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p344348">
				<div class="post-metadata">
					<div class="post-num">Post #76</div>
					<div class="post-author">balans</div>
					<div class="post-datetime">
						21 Nov 2016, 20:48					</div>
				</div>
				<div class="post-content content">
					<p>I`m also looking for some news regarding this topic , i have a virgin V5 lying here to be flashed.<br />So what to do try the LEDE or should i go the trunk openwrt way</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p344595">
				<div class="post-metadata">
					<div class="post-num">Post #77</div>
					<div class="post-author">hikey</div>
					<div class="post-datetime">
						23 Nov 2016, 15:46					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>balans wrote:</cite><blockquote><p>I`m also looking for some news regarding this topic , i have a virgin V5 lying here to be flashed.<br />So what to do try the LEDE or should i go the trunk openwrt way</p></blockquote></div><p><strong>I am not allowed to post link here, please remove space in ”ht tp://“</strong></p><p>1) Download telnetenable.exe from&nbsp; ht tp://xdd.co/router/telnetenable.exe<br />&nbsp; &nbsp; LEDE firmware from&nbsp; ht tp://xdd.co/router/lede3700v5.bin<br />&nbsp; &nbsp; (Optional) original eeprom from ht tp://xdd.co/router/eeprom-wndr3700v5.bin</p><p>2) <br /><strong>Enable telnet on your router</strong><br />Open a command window<br /></p><div class="codebox"><pre><code>win+r cmd</code></pre></div><p> enter <br /></p><div class="codebox"><pre><code>arp -a
  Internet Address      Physical Address      Type
  192.168.1.1           00-c0-02-12-xx-xx dynamic</code></pre></div><p>Enable telnet on your router<br /></p><div class="codebox"><pre><code>telnetenable.exe 192.168.1.1 00c00212xxxx admin password</code></pre></div><p>the 00c00212xxxx is the mac of your router<br /></p><div class="codebox"><pre><code>telnet 192.168.1.1</code></pre></div><p>you will get the root shell #</p><p><strong>Replace the bootloader with my uboot</strong><br />in the root shell<br /></p><div class="codebox"><pre><code>wget ht tp://xdd.co/router/pb-uboot-wndr3700v5.bin
mtd_write write pb-uboot-wndr3700v5.bin Bootloader</code></pre></div><p>reboot router and hold reset for 10s.<br />3) Flash new firmware<br />open your browser and goto 192.168.1.1 and upload the lede3700v5.bin</p><p>complete...</p><p>optional:<br />If you have tried the firmware on openwrt.org , you might have to rewrite the eeprom because the rom was build with a wrong firmware size.(which would have overwrited the eeprom)<br />You may replace it with command in putty<br /></p><div class="codebox"><pre><code>mtd write eeprom_wndr3700v5.bin factory</code></pre></div>											<p class="post-edited">(Last edited by <strong>hikey</strong> on 23 Nov 2016, 15:53)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p344680">
				<div class="post-metadata">
					<div class="post-num">Post #78</div>
					<div class="post-author">andrius</div>
					<div class="post-datetime">
						24 Nov 2016, 17:41					</div>
				</div>
				<div class="post-content content">
					<p>Could we also get links to source code to these u-boot and lede images? After all these are binaries of modified GPL source code...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p344686">
				<div class="post-metadata">
					<div class="post-num">Post #79</div>
					<div class="post-author">hikey</div>
					<div class="post-datetime">
						24 Nov 2016, 18:50					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>andrius wrote:</cite><blockquote><p>Could we also get links to source code to these u-boot and lede images? After all these are binaries of modified GPL source code...</p></blockquote></div><p>I am so sorry that I knew little about the GPL license.<br />I didn&#039;t know what I did somehow have against the regulation.</p><p>I have deleted all the firmware and uboot on webhost to compliance the regulation.<br />I believe it should be OK if I use the firmwares I built on my own router only...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p344687">
				<div class="post-metadata">
					<div class="post-num">Post #80</div>
					<div class="post-author">andrius</div>
					<div class="post-datetime">
						24 Nov 2016, 18:59					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>hikey wrote:</cite><blockquote><div class="quotebox"><cite>andrius wrote:</cite><blockquote><p>Could we also get links to source code to these u-boot and lede images? After all these are binaries of modified GPL source code...</p></blockquote></div><p>I am so sorry that I knew little about the GPL license.<br />I didn&#039;t know what I did somehow have against the regulation.</p><p>I have deleted all the firmware and uboot on webhost to compliance the regulation.<br />I believe it should be OK if I use the firmwares I built on my own router only...</p></blockquote></div><p>But why not put the source somewhere too instead of removing binaries? That way everybody can benefit from your fixes. And both upstream OpenWrt and LEDE might get fixed too.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p345405">
				<div class="post-metadata">
					<div class="post-num">Post #81</div>
					<div class="post-author">Siebevp</div>
					<div class="post-datetime">
						1 Dec 2016, 17:26					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>hikey wrote:</cite><blockquote><div class="quotebox"><cite>balans wrote:</cite><blockquote><p>I`m also looking for some news regarding this topic , i have a virgin V5 lying here to be flashed.<br />So what to do try the LEDE or should i go the trunk openwrt way</p></blockquote></div><p><strong>I am not allowed to post link here, please remove space in ”ht tp://“</strong></p><p>1) Download telnetenable.exe from&nbsp; ht tp://xdd.co/router/telnetenable.exe<br />&nbsp; &nbsp; LEDE firmware from&nbsp; ht tp://xdd.co/router/lede3700v5.bin<br />&nbsp; &nbsp; (Optional) original eeprom from ht tp://xdd.co/router/eeprom-wndr3700v5.bin</p><p>2) <br /><strong>Enable telnet on your router</strong><br />Open a command window<br /></p><div class="codebox"><pre><code>win+r cmd</code></pre></div><p> enter <br /></p><div class="codebox"><pre><code>arp -a
  Internet Address      Physical Address      Type
  192.168.1.1           00-c0-02-12-xx-xx dynamic</code></pre></div><p>Enable telnet on your router<br /></p><div class="codebox"><pre><code>telnetenable.exe 192.168.1.1 00c00212xxxx admin password</code></pre></div><p>the 00c00212xxxx is the mac of your router<br /></p><div class="codebox"><pre><code>telnet 192.168.1.1</code></pre></div><p>you will get the root shell #</p><p><strong>Replace the bootloader with my uboot</strong><br />in the root shell<br /></p><div class="codebox"><pre><code>wget ht tp://xdd.co/router/pb-uboot-wndr3700v5.bin
mtd_write write pb-uboot-wndr3700v5.bin Bootloader</code></pre></div><p>reboot router and hold reset for 10s.<br />3) Flash new firmware<br />open your browser and goto 192.168.1.1 and upload the lede3700v5.bin</p><p>complete...</p><p>optional:<br />If you have tried the firmware on openwrt.org , you might have to rewrite the eeprom because the rom was build with a wrong firmware size.(which would have overwrited the eeprom)<br />You may replace it with command in putty<br /></p><div class="codebox"><pre><code>mtd write eeprom_wndr3700v5.bin factory</code></pre></div></blockquote></div><p>I was able to install lede-r2320 firmware, it al worked fine and well, but I need kmod-bridge package in order to get the igmpproxy package. I can&#039;t install the kmod-bridge package because the kernel doesn&#039;t match. The 2320 has kernel version 4.4.32 and for the package I need kernel version 4.4.35. If you could pls help me with this. It is the last thing I need to take advantage of the firmware. Otherwise my iptv wont work.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p345407">
				<div class="post-metadata">
					<div class="post-num">Post #82</div>
					<div class="post-author">andrius</div>
					<div class="post-datetime">
						1 Dec 2016, 17:55					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Siebevp wrote:</cite><blockquote><p>I was able to install lede-r2320 firmware, it al worked fine and well, but I need kmod-bridge package in order to get the igmpproxy package. I can&#039;t install the kmod-bridge package because the kernel doesn&#039;t match. The 2320 has kernel version 4.4.32 and for the package I need kernel version 4.4.35. If you could pls help me with this. It is the last thing I need to take advantage of the firmware. Otherwise my iptv wont work.</p></blockquote></div><p>Well, like you said yourself kernel modules have to be compiled at the same time as image. So you can&#039;t use hikey&#039;s kernel and kernel module packages from LEDE repository. So nothing you can do without the source code... That&#039;s one of the reasons why I asked hikey to push source code somewhere... Well, you can still use official LEDE images but keep in mind that your 2.4 GHz wifi won&#039;t work due to corrupted factory partition.</p>											<p class="post-edited">(Last edited by <strong>andrius</strong> on 1 Dec 2016, 17:56)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p345451">
				<div class="post-metadata">
					<div class="post-num">Post #83</div>
					<div class="post-author">ldpinney</div>
					<div class="post-datetime">
						2 Dec 2016, 05:25					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve built new firmware for the WNDR3700v5 based on work by andrius and hikey.<br />However I am currently in China and WITHOUT my WNDR3700v5.</p><p>I am looking for someone to verify these fixes before submitting the patch to OpenWrt and LEDE.<br />It has the boot loader and factory partitions set WRITABLE.</p><p>Anyone willing to test? :<br />Please e-mail ldpinney&lt;AT&gt;yahoo.com</p>											<p class="post-edited">(Last edited by <strong>ldpinney</strong> on 2 Dec 2016, 06:01)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p346577">
				<div class="post-metadata">
					<div class="post-num">Post #84</div>
					<div class="post-author">Er3bus</div>
					<div class="post-datetime">
						13 Dec 2016, 13:27					</div>
				</div>
				<div class="post-content content">
					<p>@hikey Can you please provide the source code?</p>											<p class="post-edited">(Last edited by <strong>Er3bus</strong> on 13 Dec 2016, 13:28)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p346640">
				<div class="post-metadata">
					<div class="post-num">Post #85</div>
					<div class="post-author">thwuensche</div>
					<div class="post-datetime">
						14 Dec 2016, 01:03					</div>
				</div>
				<div class="post-content content">
					<p>With the patch from ldpinney on a fresh build of openwrt master and the conversion tool from francis I was able to build an image which can be uploaded with the stock firmware of the device and it seems to be working. I&#039;m getting into the LUCI configuration console and can configure the device. No further need to open the device and fit a serial console.</p><p>The steps have been the following:<br /></p><ul><li><p>Configure the openwrt source with menuconfig for the device and enable luci in the configuration</p></li><li><p>Apply the patch from ldpinney for the dts file</p></li><li><p>Build openwrt</p></li><li><p>Convert the resulting sysupdate.bin with the tool from francis</p></li><li><p>Compress the result with the stock zipImage as described by francis</p></li><li><p>Upload the resulting sysupdate.img with the devices stock firmware - be patient here</p></li></ul><p>After reboot I got a fresh openwrt installation on the router</p><p>Will test further ...</p><p>Regards, thwuensche</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p346641">
				<div class="post-metadata">
					<div class="post-num">Post #86</div>
					<div class="post-author">andrius</div>
					<div class="post-datetime">
						14 Dec 2016, 01:34					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>thwuensche wrote:</cite><blockquote><p>With the patch from ldpinney on a fresh build of openwrt master and the conversion tool from francis I was able to build an image which can be uploaded with the stock firmware of the device and it seems to be working. I&#039;m getting into the LUCI configuration console and can configure the device. No further need to open the device and fit a serial console.</p><p>The steps have been the following:<br /></p><ul><li><p>Configure the openwrt source with menuconfig for the device and enable luci in the configuration</p></li><li><p>Apply the patch from ldpinney for the dts file</p></li><li><p>Build openwrt</p></li><li><p>Convert the resulting sysupdate.bin with the tool from francis</p></li><li><p>Compress the result with the stock zipImage as described by francis</p></li><li><p>Upload the resulting sysupdate.img with the devices stock firmware - be patient here</p></li></ul><p>After reboot I got a fresh openwrt installation on the router</p><p>Will test further ...</p><p>Regards, thwuensche</p></blockquote></div><p>When you do further testing please test 2.4 GHz WiFi. Other people updating from non-stock broken versions can&#039;t get WiFi working (even when rewriting factory partition)...</p><p>P.S. the patch I sent ldpinney is <a href="https://stikonas.eu/files/dts.patch">https://stikonas.eu/files/dts.patch</a> @thwuensche You are using the same patch, aren&#039;t you?</p>											<p class="post-edited">(Last edited by <strong>andrius</strong> on 14 Dec 2016, 01:36)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p346891">
				<div class="post-metadata">
					<div class="post-num">Post #87</div>
					<div class="post-author">andrius</div>
					<div class="post-datetime">
						17 Dec 2016, 03:19					</div>
				</div>
				<div class="post-content content">
					<p>So ldpinney now created a patch that fixes remaining WiFi issues!</p><p><a href="https://patchwork.ozlabs.org/patch/706643/">https://patchwork.ozlabs.org/patch/706643/</a></p><p>Both radios should work well with this patch.</p><p>Note that you still need to restore your eeprom (factory partition) to a working version as hikey previously said if you tried earlier images. And since eeprom contains your MAC address you might want to change it with hex editor and set your own values. (see earlier posts in this thread for info how to do that)</p><p>EDIT: this patch have now been merged into LEDE.</p>											<p class="post-edited">(Last edited by <strong>andrius</strong> on 20 Dec 2016, 15:39)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p348972">
				<div class="post-metadata">
					<div class="post-num">Post #88</div>
					<div class="post-author">Markismus</div>
					<div class="post-datetime">
						10 Jan 2017, 16:51					</div>
				</div>
				<div class="post-content content">
					<p>This is just great! I just installed OpenWRT on my ZyXEL P-2812HNU-F1 to test the system and now when I am just, you people got it working on the Netgear WNDR3700v5.</p><br /><p>I am still a bit fuzzy on the workflow, though. If someone could elaborate on the steps by thwuensche? <br /></p><div class="quotebox"><blockquote><p>The steps have been the following:<br /></p><ol class="decimal"><li><p>Configure the openwrt source with menuconfig for the device and enable luci in the configuration</p></li><li><p>Apply the patch from ldpinney for the dts file</p></li><li><p>Build openwrt</p></li><li><p>Convert the resulting sysupdate.bin with the tool from francis</p></li><li><p>Compress the result with the stock zipImage as described by francis</p></li><li><p>Upload the resulting sysupdate.img with the devices stock firmware - be patient here.</p></li></ol></blockquote></div><br /><br /><p><em>OPTIMZED WORKFLOW for LINUX</em><br />Replace step 1-3 by (replace xx&#039;s by tt&#039;s)</p><div class="codebox"><pre><code>wget hxxps://downloads.lede-project.org/snapshots/targets/ramips/mt7621/lede-ramips-mt7621-wndr3700v5-squashfs-sysupgrade.bin</code></pre></div><br /><p><em>WORKFLOW FOR LINUX</em></p><p><strong>First.</strong> So you have to build openwrt from source (replace xx&#039;s with tt&#039;s):</p><p><strong>a.</strong> Clone openwrt to your system:<br /></p><div class="codebox"><pre><code>git clone hxxps://github.com/openwrt/openwrt.git
cd openwrt
cat README
./scripts/feeds update -a
./scripts/feeds install -a</code></pre></div><p><strong>b.</strong>configure openwrt source:<br /></p><div class="codebox"><pre><code>make menuconfig</code></pre></div><p><strong>c.</strong>I selected </p><div class="codebox"><pre><code>Target System (Ralink RT288x/RT3xxx)  
Subtarget (MT7621 based boards)
 &gt; LuCI &gt; 1. Collections &lt;*&gt; luci   </code></pre></div><br /><p><strong>Second.</strong> <br /><strong>a.</strong> I applied the patch manually replacing the content of /target/linux/ramips/dts/WNDR3700V5.dts by:<br /></p><div class="codebox"><pre><code>/dts-v1/;

#include &quot;mt7621.dtsi&quot;

/ {
    compatible = &quot;mediatek,mt7621-eval-board&quot;,&quot;ralink,mt7621-soc&quot;;
    model = &quot;Netgear WNDR3700v5&quot;;

    memory@0 {
        device_type = &quot;memory&quot;;
        reg = &lt;0x0 0x8000000&gt;;
    };

    chosen {
        bootargs = &quot;console=ttyS0,57600 maxcpus=2&quot;;
    };

    gpio-leds {
        compatible = &quot;gpio-leds&quot;;

        wps {
            label = &quot;wndr3700v5:green:wps&quot;;
            gpios = &lt;&amp;gpio0 12 1&gt;;
        };

        power {
            label = &quot;wndr3700v5:green:power&quot;;
            gpios = &lt;&amp;gpio0 18 1&gt;;
        };
    };

    gpio-keys-polled {
        compatible = &quot;gpio-keys-polled&quot;;
        #address-cells = &lt;1&gt;;
        #size-cells = &lt;0&gt;;
        poll-interval = &lt;20&gt;;

        wps {
            label = &quot;wndr3700v5:wps&quot;;
            gpios = &lt;&amp;gpio0 7 0&gt;;
            linux,code = &lt;0x211&gt;;
        };

        wifi {
            label = &quot;wndr3700v5:wifi&quot;;
            gpios = &lt;&amp;gpio0 8 0&gt;;
            linux,code = &lt;0xf7&gt;;
        };

        reset {
            label = &quot;wndr3700v5:reset&quot;;
            gpios = &lt;&amp;gpio0 14 0&gt;;
            linux,code = &lt;0x198&gt;;
        };
    };

    gpio_export {
        compatible = &quot;gpio-export&quot;;
        #size-cells = &lt;0&gt;;

        usbpower {
            gpio-export,name = &quot;usbpower&quot;;
            gpio-export,output = &lt;1&gt;;
            gpios = &lt;&amp;gpio0 10 1&gt;;
        };
    };
};

&amp;spi0 {
    status = &quot;okay&quot;;

    m25p80@0 {
        #address-cells = &lt;1&gt;;
        #size-cells = &lt;1&gt;;
        compatible = &quot;mx25l12805d&quot;;
        reg = &lt;0&gt;;
        linux,modalias = &quot;m25p80&quot;, &quot;w25q128&quot;;
        spi-max-frequency = &lt;10000000&gt;;

        partition@0 {
            label = &quot;u-boot&quot;;
            reg = &lt;0x0 0x30000&gt;;
            read-only;
        };

        partition@30000 {
            label = &quot;u-boot-env&quot;;
            reg = &lt;0x30000 0x10000&gt;;
            read-only;
        };

        factory: partition@f30000 {
            label = &quot;factory&quot;;
            reg = &lt;0xf30000 0x10000&gt;;
            read-only;
        };

        partition@50000 {
            label = &quot;firmware&quot;;
            reg = &lt;0x50000 0xee0000&gt;;
        };
    };
};

&amp;pcie {
    status = &quot;okay&quot;;

    pcie0 {
        mt76@0,0 {
            reg = &lt;0x0000 0 0 0 0&gt;;
            device_type = &quot;pci&quot;;
            mediatek,mtd-eeprom = &lt;&amp;factory 0x8000&gt;;
            mediatek,2ghz = &lt;0&gt;;
        };
    };

    pcie1 {
        mt76@1,0 {
            reg = &lt;0x0000 0 0 0 0&gt;;
            device_type = &quot;pci&quot;;
            mediatek,mtd-eeprom = &lt;&amp;factory 0x0000&gt;;
            mediatek,5ghz = &lt;0&gt;;
        };
    };
};

&amp;ethernet {
    mtd-mac-address = &lt;&amp;factory 0x0000000c&gt;;
};

&amp;pinctrl {
    state_default: pinctrl0 {
        gpio {
            ralink,group =  &quot;rgmii2&quot;, &quot;mdio&quot;, &quot;wdt&quot;;
            ralink,function = &quot;gpio&quot;;
        };
    };
};</code></pre></div><p><strong>Third.</strong><br /><strong>a.</strong> </p><div class="codebox"><pre><code>make</code></pre></div><p>This takes rather long, so I continued on with step 4.</p><p><strong>Fourth.</strong><br /><strong>a.</strong> Create the tool from Francis. Clone Francis&#039;s git repo (Replace xx&#039;s with tt&#039;s):<br /></p><div class="codebox"><pre><code>git clone hxxps://github.com/Vic063/WNDR3700v5-firmware.git
cd WNDR3700v5-firmware/
g++ WNDR3700v5-Firmware/*.cpp -o WNDR3700v5-Firmware-tool</code></pre></div><p>[b.] Use the tool on the newly generated firmware from step 3. The relevant file was generated in openwrt/bin/ramips, so:<br /></p><div class="codebox"><pre><code>cp ../openwrt/bin/ramips/openwrt-ramips-mt7621-wndr3700v5-squashfs-sysupgrade.bin .
./WNDR3700v5-Firmware-tool openwrt-ramips-mt7621-wndr3700v5-squashfs-sysupgrade.bin</code></pre></div><p>It now asks for a firmware code. I&#039;ve entered 1.0.0.18 and it generated a new, larger, identically named binary file and renamed the old binary with a suffix &#039;-original&#039;. (Comparing the binary files with the one available from openwrt download, shows that they are all different in size.)</p><p><strong>Fifth.</strong><br />I&nbsp; downloaded the whole source tarball of v1.0.0.17, that contains the tool zipImage:<br /></p><div class="codebox"><pre><code>wget http://www.downloads.netgear.com/files/GPL/WNDR3700v5_V1.0.0.17_src.tar.gz.zip
unzip WNDR3700v5_V1.0.0.17_src.tar.gz.zip
tar -xvf WNDR3700v5_V1.0.0.17_src.tar.gz
ln -s WNDR3700v5_V1.0.0.17_src/image/tools/src/zipImage/zipImage zipImage-tool
./zipImage-tool openwrt-ramips-mt7621-wndr3700v5-squashfs-sysupgrade.bin </code></pre></div><p>This resulted in:<br /></p><div class="codebox"><pre><code>$ ./zipImage-tool openwrt-ramips-mt7621-wndr3700v5-squashfs-sysupgrade.bin
  adding: openwrt-ramips-mt7621-wndr3700v5-squashfs-sysupgrade.bin (deflated 30%)
bin file size: &lt;5617184 bytes&gt;
actually read &lt;5617184 bytes&gt;
The first magic sign is found at offset 0x10
The second magic sign is found at offset 0x4f
CheckSum OK: 0x00
Success to build normal img!</code></pre></div><p>A bit worrisome is that it is actually a sysupgrade binary file that fitted through Francis&#039; tool--not the factory.bin! On the other hand, all the LEDE binary files are sysupgrades (and fit through the tool, too).</p><p><strong>Sixth</strong><br />Uploading the created img-file via the http interface as new firmware didn&#039;t do anything. </p><p>I&#039;ve zipImage&#039;ed the tooled LEDE binary and uploaded the img-file: <strong><span style="color: green"><span class="bbu"><em>Joy</em></span></span></strong>!!! </p><p>EDIT: 2.4GHz and 5GHz WiFi are working.</p>											<p class="post-edited">(Last edited by <strong>Markismus</strong> on 11 Jan 2017, 13:05)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p349045">
				<div class="post-metadata">
					<div class="post-num">Post #89</div>
					<div class="post-author">Markismus</div>
					<div class="post-datetime">
						11 Jan 2017, 16:01					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>andrius wrote:</cite><blockquote><p>If anybody else got confused by the picture on the first page, TX and VCC pins seems to be swapped in that picture. Once I plugged them correctly, I was able to input using serial console.</p></blockquote></div><br /><p>Thank you! Thank you! Thank you! Thank you! Thank you! Thank you! Thank you! Thank you! Thank you! Thank you! Thank you! Thank you! Thank you! Thank you! Thank you! Thank you! Thank you! Thank you! Thank you! Thank you! Thank you! Thank you! Thank you! Thank you! </p><p>So somewhere around rather late in the evening I decided that it would be fun to flash an Openwrt image, since LEDE was bothering me and I just wanted the same distro on both my routers to compare more easily. I forgot to use Francis&#039; tool and I soft bricked it!</p><p>No biggie, just tftp a new one...but I couldn&#039;t get a positive reponse on &#039;ping 192.168.1.1&#039; anymore. So I soldered a header and enabled the serial console....and nothing...no input. Took me an hour before I reread the entire thread and finally understood andrius remark! Now I&#039;ve got:<br /></p><div class="codebox"><pre><code>******************************************                                      
    Uboot StandAlone Entry                                                      
******************************************                                      
0, cmd                                                                          
1, 0x0000000D                                                                   
cmd : 0x0000000D                                                                
                                                                                
                                                                                
Press Ctrl+C to Enter the Main loop...                                          
                                                                                
                                                                                
U-Boot 1.1.3 (Dec 30 2014 - 10:10:36)                                           
SERCOMM # </code></pre></div><p>Very happy puppy!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p349090">
				<div class="post-metadata">
					<div class="post-num">Post #90</div>
					<div class="post-author">ldpinney</div>
					<div class="post-datetime">
						12 Jan 2017, 02:31					</div>
				</div>
				<div class="post-content content">
					<p>Markismus</p><p>Do yourself a favor and replace the bootloader <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p><a href="https://github.com/pinney/MT7621-u-boot-mod/blob/master/bin/MT7621S_uboot.bin">https://github.com/pinney/MT7621-u-boot … _uboot.bin</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p349096">
				<div class="post-metadata">
					<div class="post-num">Post #91</div>
					<div class="post-author">andrius</div>
					<div class="post-datetime">
						12 Jan 2017, 03:43					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>ldpinney wrote:</cite><blockquote><p>Markismus</p><p>Do yourself a favor and replace the bootloader <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p><a href="https://github.com/pinney/MT7621-u-boot-mod/blob/master/bin/MT7621S_uboot.bin">https://github.com/pinney/MT7621-u-boot … _uboot.bin</a></p></blockquote></div><p>I&#039;m using this bootloader already but wanted to ask, does it have web recovery? I tried pressing reset for long enough but it didn&#039;t boot into web recovery. But then my firmware wasn&#039;t bricked, so maybe it doesn&#039;t boot to recovery if everything is fine.</p><p>It&#039;s just that it&#039;s quite hard to close the case of this router... Don&#039;t want to open it one more time...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p349099">
				<div class="post-metadata">
					<div class="post-num">Post #92</div>
					<div class="post-author">ldpinney</div>
					<div class="post-datetime">
						12 Jan 2017, 05:27					</div>
				</div>
				<div class="post-content content">
					<p>Yes it has a web interface :</p><p>Option 5</p><p>###</p><p>U-Boot 1.1.3 (Nov 22 2015 - 11:45:37)</p><p>Board: Ralink APSoC DRAM:&nbsp; 448 MB</p><p>relocate_code Pointer at: 9bfb4000</p><br /><p>Config XHCI 40M PLL </p><p>flash manufacture id: ef, device id 40 19</p><p>Warning: un-recognized chip ID, please update bootloader!</p><p>============================================ </p><p>Pinney UBoot Version: 1.0</p><p>-------------------------------------------- </p><p>ASIC MT7621A DualCore (MAC to MT7530 Mode)</p><p>DRAM_CONF_FROM: Auto-Detection </p><p>DRAM_TYPE: DDR3 </p><p>DRAM bus: 16 bit</p><p>Xtal Mode=3 OCP Ratio=1/3</p><p>Flash component: SPI Flash</p><p>Date:Nov 22 2015&nbsp; Time:11:45:37</p><p>============================================ </p><p>icache: sets:256, ways:4, linesz:32 ,total:32768</p><p>dcache: sets:256, ways:4, linesz:32 ,total:32768 </p><p>set LAN/WAN WLL</p><br /><p>&nbsp; &nbsp; &nbsp; &nbsp;_&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;_____&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;_____<br />&nbsp; &nbsp; &nbsp; &nbsp; /&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )&nbsp; &nbsp; &nbsp; &nbsp;/&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )&nbsp; &nbsp;♥<br />&nbsp; &nbsp; &nbsp; &nbsp;/&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /&nbsp; &nbsp; &nbsp; &nbsp;/_____/&nbsp; &nbsp; &nbsp; &nbsp;_&nbsp; &nbsp; &nbsp; _&nbsp; &nbsp; &nbsp; &nbsp;_<br />&nbsp; &nbsp; &nbsp; /&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /&nbsp; &nbsp; &nbsp; &nbsp;/&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /&nbsp; &nbsp;/&nbsp; &nbsp; ) /&nbsp; &nbsp; )&nbsp; /__)&nbsp; &nbsp; /&nbsp; &nbsp; &nbsp;/<br />&nbsp; &nbsp;_/____/ ♠&nbsp; /_____/&nbsp; &nbsp;♣&nbsp; /&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /&nbsp; &nbsp;/&nbsp; &nbsp; / /&nbsp; &nbsp; /&nbsp; (_&nbsp; &nbsp; &nbsp; &nbsp;(___/ ♦<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _____/&nbsp; <br />-------------------------------------------------------------------------</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href="https://github.com/pinney/MT7621-u-boot-mod">https://github.com/pinney/MT7621-u-boot-mod</a></p><p>-------------------------------------------------------------------------</p><br /><p>Please choose the operation: </p><p>&nbsp; &nbsp;1: Load system code to SDRAM via TFTP. <br />&nbsp; &nbsp;2: Load system code then write to Flash via TFTP. <br />&nbsp; &nbsp;3: Boot system code via Flash (default).<br />&nbsp; &nbsp;4: Entr boot command line interface.<br />&nbsp; &nbsp;5: Load system code then write to Flash via Httpd.<br />&nbsp; &nbsp;7: Load Boot Loader code then write to Flash via Serial. <br />&nbsp; &nbsp;9: Load Boot Loader code then write to Flash via TFTP.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p349182">
				<div class="post-metadata">
					<div class="post-num">Post #93</div>
					<div class="post-author">Markismus</div>
					<div class="post-datetime">
						12 Jan 2017, 22:12					</div>
				</div>
				<div class="post-content content">
					<p>This is so much fun! </p><p>Thanks for the assurances about what bootloader to use. Things were still kind of fuzzy on that subject.</p><p>Is the patch for the dts-file pulled into the master branch of OpenWrt, yet? I rather not use both the LEDE and OpenWrt distribution this first week.</p>											<p class="post-edited">(Last edited by <strong>Markismus</strong> on 13 Jan 2017, 00:48)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p349654">
				<div class="post-metadata">
					<div class="post-num">Post #94</div>
					<div class="post-author">Markismus</div>
					<div class="post-datetime">
						19 Jan 2017, 00:36					</div>
				</div>
				<div class="post-content content">
					<p>So I followed ldpinney&#039;s guide </p><div class="codebox"><pre><code>You MUST have a working serial console (UART)

You MUST have a working TFTP server

You MUST have a USB stick...

###

From the SECOMM bootloader :

Press Ctrl+C to Enter the Main loop...

tftp the initramfs and boot it. (the uboot partition is set writable)

tftpboot 0x81000000 openwrt-ramips-mt7621-wndr3700v5-initramfs-kernel.bin

bootm 0x81000000

Place the new bootloader on a USB stick.

Insert the USB Stick and mount it.

mount /dev/sda2 /mnt

root@OpenWrt:/# mtd unlock /dev/mtd0
Unlocking /dev/mtd0 ...

root@OpenWrt:/# mtd write /mnt/mt7621s-uboot.bin /dev/mtd0
Unlocking /dev/mtd0 ...

Writing from /mnt/uboot.bin to /dev/mtd0 ...  

Writing from uboot.bin to /dev/mtd0 ...

reboot</code></pre></div><p>However, I replaced the mt7621s-uboot.bin (from his googledrive 125.5kB) with the one in his link MT7621S_uboot.bin (from his link above (32425 bytes, retrieved with wget)). When I download the file via the github web interface it&#039;s 122KB. So obviously <strong>wget is not the way</strong> to get this file! </p><p>Everything went perfectly, except I only had one message &quot;Writing from /mnt/uboot.... to ....&quot; instead of 2. After rebooting nothing happened. After several tries the router seems utterly unresponsive. I see nothing via the serial connection. <span class="bbu">It turns out that I flashed the&nbsp; github page!</span></p><p>Is there any way to resuscitate the router? Or did I in fact utterly brick it? Lesson to be learned: to flash your router in a hurry before getting to other things!</p><p>For the moment I have started looking into flash memory chip programmers for the Macronix MX25L12835F. Does anyone know what kind of programmers are good or even better a link to a decent one?</p>											<p class="post-edited">(Last edited by <strong>Markismus</strong> on 19 Jan 2017, 01:08)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p349662">
				<div class="post-metadata">
					<div class="post-num">Post #95</div>
					<div class="post-author">andrius</div>
					<div class="post-datetime">
						19 Jan 2017, 01:14					</div>
				</div>
				<div class="post-content content">
					<p>Probably fully bricked unless you can desolder and rewrite the chip...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p349663">
				<div class="post-metadata">
					<div class="post-num">Post #96</div>
					<div class="post-author">Markismus</div>
					<div class="post-datetime">
						19 Jan 2017, 01:20					</div>
				</div>
				<div class="post-content content">
					<p>Yes. I an afraid of that, too. <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>Would you be willing to make a backup of the flash memory, so that I can program it with a working image?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p349668">
				<div class="post-metadata">
					<div class="post-num">Post #97</div>
					<div class="post-author">ldpinney</div>
					<div class="post-datetime">
						19 Jan 2017, 01:42					</div>
				</div>
				<div class="post-content content">
					<p>Markismus</p><p>OK email me and I&#039;ll send you a full image.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p350658">
				<div class="post-metadata">
					<div class="post-num">Post #98</div>
					<div class="post-author">Bringel</div>
					<div class="post-datetime">
						30 Jan 2017, 23:05					</div>
				</div>
				<div class="post-content content">
					<p>WNDR3700v5 owner here.&nbsp; &nbsp; I&#039;m super excited about the work being done.&nbsp; &nbsp;Does this all mean that an openwrt image will soon appear for this router?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p350667">
				<div class="post-metadata">
					<div class="post-num">Post #99</div>
					<div class="post-author">andrius</div>
					<div class="post-datetime">
						30 Jan 2017, 23:50					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Bringel wrote:</cite><blockquote><p>WNDR3700v5 owner here.&nbsp; &nbsp; I&#039;m super excited about the work being done.&nbsp; &nbsp;Does this all mean that an openwrt image will soon appear for this router?</p></blockquote></div><p>I don&#039;t think anybody bothered to submit those patches to openwrt, they were only submitted to LEDE. Well, they are mostly identical anyway, so try <a href="https://downloads.lede-project.org/releases/17.01.0-rc1/targets/ramips/mt7621/lede-17.01.0-rc1-r3042-ec095b5-ramips-mt7621-wndr3700v5-squashfs-sysupgrade.bin">https://downloads.lede-project.org/rele … pgrade.bin</a></p><p>This is only sysupgrade image. Either you need to flash it with serial cable or follow instructions on this thread that tell how to convert it into factory image.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p350695">
				<div class="post-metadata">
					<div class="post-num">Post #100</div>
					<div class="post-author">Bringel</div>
					<div class="post-datetime">
						31 Jan 2017, 07:00					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>andrius wrote:</cite><blockquote><div class="quotebox"><cite>Bringel wrote:</cite><blockquote><p>WNDR3700v5 owner here.&nbsp; &nbsp; I&#039;m super excited about the work being done.&nbsp; &nbsp;Does this all mean that an openwrt image will soon appear for this router?</p></blockquote></div><p>I don&#039;t think anybody bothered to submit those patches to openwrt, they were only submitted to LEDE. Well, they are mostly identical anyway, so try ....</p><p>This is only sysupgrade image. Either you need to flash it with serial cable or follow instructions on this thread that tell how to convert it into factory image.</p></blockquote></div><p><img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />&nbsp; I just looked up LEDE.&nbsp; Very cool!&nbsp; &nbsp;</p><p>Thanks for posting the bin file, but I don&#039;t want to risk bricking my router.&nbsp; I&#039;ll just wait on an image.&nbsp; &nbsp;I&#039;m in no rush.&nbsp; &nbsp;I&#039;ll be using it as a client bridge. </p><p>Thanks for the info!</p>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 4 of 6</div><nav><ul><li><a href="viewtopic.php%3Fid=56737&amp;p=1.html">1</a></li><li><a href="viewtopic.php%3Fid=56737&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=56737&amp;p=3.html">3</a></li><li class="pagination-current"><span>4</span></li><li><a href="viewtopic.php%3Fid=56737&amp;p=5.html">5</a></li><li><a href="viewtopic.php%3Fid=56737&amp;p=6.html">6</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>