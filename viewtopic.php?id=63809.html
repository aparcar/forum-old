<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Accessing the root password</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 12 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p317496">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">sreekanth.a</div>
					<div class="post-datetime">
						31 Mar 2016, 10:40					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>I have developed a web page (With PHP) to login to SOM9331 module. The web pages are working properly but I don&#039;t know how to extract the password from web page compare it and authenticate it.</p><p>I am posting the old web page which we developed couple of years back,</p><div class="codebox"><pre><code>&lt;?php session_start();?&gt;

&lt;html&gt;&lt;head&gt;
&lt;title&gt;test&lt;/title&gt;
&lt;?php 
//if(!isset($_SESSION[&#039;user&#039;])){
if (isset($_POST[&#039;submit&#039;]))
{  
    $p=$_POST[&#039;pwd1&#039;];                    //Taking the password entered by the user into a variable
     $c = shell_exec(&quot;./cgi-bin/Login $p&quot;);            //Executing the program for password authentication
      $d=&#039;Correct&#039;;
      if((strcmp($c,$d))==0)                    //Comparing the results (correct password or not)
    {
        $_SESSION[&#039;user&#039;] = &quot;admin&quot;;
        $_SESSION[&#039;logged_in&#039;] = true;             //set you&#039;ve logged in
        $_SESSION[&#039;last_activity&#039;] = time();         //your last activity was now, having logged in.
        $_SESSION[&#039;expire_time&#039;] = 1*1*150;         //timeout duration 
        header(&#039;Location: www/frameset.html&#039;);        //redirecting
    }
}
//}

?&gt;&lt;style type=&quot;text/css&quot;&gt;
input[type=&quot;submit&quot;]
{
    background:#B0C4DE;
    outline: none;
}
input[type=&quot;submit&quot;]::-moz-focus-inner
{
    border : 0px;
}
input[type=&quot;submit&quot;]:hover 
{
    background:white;
    outline: none;
}
a 
{
    color: black;
    text-decoration: none;
    outline: 0;
}
a:hover 
{
    color: grey;
    position: relative;
    background: none;
}
.center
{
    margin:auto;
    width:700px;
}
#op
{
    opacity: 0.8;
}
  &lt;/style&gt;
  
  &lt;script type=&quot;Text/JavaScript&quot;&gt;
/********* Input validation on entered password *********/
function logvalidate()
{
    if(document.input.pwd1.value==&quot;&quot;)
    {
        document.getElementById(&#039;une&#039;).innerHTML = &quot;Password field should not be empty &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&quot;;
        input.pwd1.focus();
        return(false);
    }
    else
    {
        return(true);
    }
}

function logout()
{
      alert(&#039;Your Session has been expired, Please Login again. &#039;);
}
  &lt;/script&gt;
  
  &lt;meta content=&quot;text/html; charset=ISO-8859-1&quot; http-equiv=&quot;content-type&quot;&gt;

&lt;/head&gt;
&lt;?php
/*if($_GET[&#039;flag&#039;])
    $flag = $_GET[&#039;flag&#039;];
    
    if(strcmp($flag,&#039;1&#039;)==0)
    echo &#039;&lt;body onload =&quot;rebooted()&quot;&gt;&#039;;
    else if((strcmp($flag,&#039;2&#039;)==0))
    echo &#039;&lt;body onload =&quot;logout()&quot;&gt;&#039;;
    else

echo &#039;&lt;body&gt;&#039;;?&gt;*/?&gt;
&lt;br&gt;

&lt;br&gt;

&lt;br&gt;

&lt;br&gt;

&lt;br&gt;

&lt;br&gt;

&lt;br&gt;



&lt;br&gt;

&lt;div class=&quot;center&quot; id=&quot;op&quot;&gt;
&lt;div style=&quot;margin-left: 28px; width: 711px;&quot; align=&quot;center&quot;&gt;
&lt;div align=&quot;left&quot;&gt; &lt;img style=&quot;width: 180px; height: 64px;&quot; alt=&quot;logo&quot; src=&quot;www/logo2.jpg&quot;&gt;&lt;/div&gt;
&lt;div align=&quot;center&quot;&gt;
&lt;form name=&quot;input&quot; action=&quot;&quot; method=&quot;post&quot; onsubmit=&quot;return(logvalidate())&quot;&gt;
  &lt;table style=&quot;width: 667px; margin-top: 11px; height: 101px;&quot; border=&quot;2&quot;&gt;
    &lt;tbody&gt;
      &lt;tr&gt;
        &lt;td&gt;
        &lt;div&gt; &lt;/div&gt;
        &lt;table style=&quot;height: 37px; width: 655px; margin-left: 0px;&quot; bgcolor=&quot;#f0f0f0&quot; border=&quot;0&quot;&gt;
          &lt;tbody&gt;
            &lt;tr&gt;
              &lt;td style=&quot;width: 310px; text-align: left;&quot;&gt;&amp;nbsp; &lt;big&gt;&lt;font style=&quot;font-family: verdana; font-size: 12px;&quot;&gt;Username:&lt;/font&gt;&lt;/big&gt;&lt;/td&gt;
              &lt;td align=&quot;left&quot; width=&quot;230&quot;&gt;&lt;big&gt;&lt;font style=&quot;font-family: verdana; font-size: 12px;&quot;&gt;Admin&lt;/font&gt;&lt;/big&gt;&lt;/td&gt;
            &lt;/tr&gt;
          &lt;/tbody&gt;
        &lt;/table&gt;
        &lt;table style=&quot;width: 657px; height: 36px;&quot; border=&quot;0&quot;&gt;
          &lt;tbody&gt;
            &lt;tr&gt;
              &lt;td style=&quot;width: 359px; height: 31px;&quot; align=&quot;left&quot;&gt;&lt;big&gt;&amp;nbsp;
              &lt;font style=&quot;font-family: verdana; font-size: 12px;&quot;&gt;Password:&lt;/font&gt;
              &lt;/big&gt; &lt;/td&gt;
              &lt;td style=&quot;width: 282px; height: 31px;&quot; align=&quot;left&quot;&gt;&lt;input style=&quot;padding: 2px; width: 234px;&quot; name=&quot;pwd1&quot; type=&quot;password&quot;&gt;&lt;/td&gt;
            &lt;/tr&gt;
          &lt;/tbody&gt;
        &lt;/table&gt;
&lt;div id=&quot;une&quot; align=&quot;right&quot; style=&quot;font-family: verdana; font-size: 12px; color:red;&quot;&gt;&lt;?php if((strcmp($c,$d))!=0)echo &#039;The Password you have entered is
incorrect&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&#039;;?&gt;&lt;/div&gt;
        &lt;table style=&quot;width: 655px; margin-left: 0px; height: 35px;&quot; bgcolor=&quot;#f0f0f0&quot; border=&quot;0&quot;&gt;
          &lt;tbody&gt;
            &lt;tr&gt;
              &lt;td style=&quot;width: 358px; text-align: left; height: 31px;&quot;&gt;&amp;nbsp;
              &lt;/td&gt;
              &lt;td style=&quot;width: 281px; height: 31px;&quot; align=&quot;left&quot;&gt;&lt;input value=&quot;Submit&quot; name=&quot;submit&quot; type=&quot;submit&quot;&gt;&lt;/td&gt;
            &lt;/tr&gt;
          &lt;/tbody&gt;
        &lt;/table&gt;
        &lt;/td&gt;
      &lt;/tr&gt;
    &lt;/tbody&gt;
  &lt;/table&gt;
&lt;/form&gt;
&lt;/div&gt;
&amp;nbsp; &lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/body&gt;&lt;/html&gt;</code></pre></div><p>I am not sure what script was there inside ./cgi-bin/Login.&nbsp; The above page provides the access to all other pages when the password is correct.</p><br /><p>Thanks &amp; Regards,<br />Sreekanth</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p317507">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Max Hopper</div>
					<div class="post-datetime">
						31 Mar 2016, 11:24					</div>
				</div>
				<div class="post-content content">
					<p>Umm, assistance for PHP programming can be gotten @ <a href="https://stackoverflow.com/">StackExchange</a>.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p317508">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">sreekanth.a</div>
					<div class="post-datetime">
						31 Mar 2016, 11:28					</div>
				</div>
				<div class="post-content content">
					<p>Yes, Thanks.</p><p>But if I want to write a script in CGI which execute when called and return the password of root will fine.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p317520">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">sreekanth.a</div>
					<div class="post-datetime">
						31 Mar 2016, 13:15					</div>
				</div>
				<div class="post-content content">
					<p>To be more specific.</p><p>When I type the IP address of the router the luci page will open and ask for the authentication. The web page which I developed will do the same, but I don&#039;t know how to compare the password which is stored in /etc/shadow and the password entered in the password filed in the web page.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p317522">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">eduperez</div>
					<div class="post-datetime">
						31 Mar 2016, 13:40					</div>
				</div>
				<div class="post-content content">
					<p>IMHO, sending the root password through a web page is a call for serious trouble...</p><p>You cannot recover the original password from the contents of the shadow file, because it has been hashed; however, you can hash the password received by the web page, and compare the results with the content of the shadow file. Have some pointers on the matter:</p><p><a href="http://www.tldp.org/LDP/lame/LAME/linux-admin-made-easy/shadow-file-formats.html">http://www.tldp.org/LDP/lame/LAME/linux … rmats.html</a><br /><a href="http://linux.die.net/man/5/shadow">http://linux.die.net/man/5/shadow</a><br /><a href="http://linux.die.net/man/3/crypt">http://linux.die.net/man/3/crypt</a><br /><a href="http://www.yourownlinux.com/2015/08/etc-shadow-file-format-in-linux-explained.html">http://www.yourownlinux.com/2015/08/etc … ained.html</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p317592">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Max Hopper</div>
					<div class="post-datetime">
						31 Mar 2016, 20:24					</div>
				</div>
				<div class="post-content content">
					<p><strong>LOL</strong><br />That is also how RACF authorises logins.&nbsp; The ID is DES-encrypted with the password and compared to the stored value.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p318235">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">sreekanth.a</div>
					<div class="post-datetime">
						5 Apr 2016, 09:32					</div>
				</div>
				<div class="post-content content">
					<p>Thanks eduperez,</p><p>I wrote a small CGI script which will compare the password and it is working fine.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>