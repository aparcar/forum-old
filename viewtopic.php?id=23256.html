<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> ip_conntrack_sip and ip_nat_sip modules, are they loaded?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 27 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p100977">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">pbix</div>
					<div class="post-datetime">
						20 Jan 2010, 15:00					</div>
				</div>
				<div class="post-content content">
					<p>OK,</p><p>I have OpenWrt v8.09.01 loaded on my router and I am experimenting with SIP.&nbsp; The signaling protocol for VoIP.&nbsp; I will admit to a certain level of confusion fed by hours of googling about this subject without much success.&nbsp; Fortunately for me this forum exists so I am not without hope.</p><p>The first question I have on this subject is how can I tell if the Linux modules ip_conntrack_sip and ip_nat_sip are properly loaded in my router.&nbsp; The web page <a href="http://www.iptel.org/sipalg/">http://www.iptel.org/sipalg/</a> indicates I should see these with the lsmod command.&nbsp; But on OpenWrt when I run this command there are no modules listed related to sip.</p><p>I some more questions about this subject but think it will be most productive to start with something simple.&nbsp; Hopefully someone will be able to tell me how to inspect my router to see if the modules are loaded and if they are not how to load them.</p><p>Thanks,<br />pbix</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p100991">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Timothy</div>
					<div class="post-datetime">
						20 Jan 2010, 17:32					</div>
				</div>
				<div class="post-content content">
					<p>Did you compile the modules as part of the kernel (aka pressing y and it showing as a *) or did you compile them as modules ?</p><p>If they are modules have you looking in /lib/modules for them and if needed tried insmod ?</p><p>So far your question is a generic linux one and not specific to openwrt.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p100998">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">pbix</div>
					<div class="post-datetime">
						20 Jan 2010, 19:20					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Timothy wrote:</cite><blockquote><p>If they are modules have you looking in /lib/modules for them and if needed tried insmod ?</p><p>So far your question is a generic linux one and not specific to openwrt.</p></blockquote></div><p>Yes I agree my question is rather generic.&nbsp; The specifics to openwrt come from the fact the tools used in Linux like modprobe and ipkg are not available on Openwrt.&nbsp; So things become very confused for us Noobs.&nbsp; So anyway I have not compiled anything and my question is what can I learn from the command prompt.</p><p>I do not know if they are &quot;modules&quot; or not.&nbsp; I am too much of a Noob to know precisely what that means.&nbsp; According to the URL I listed these are &quot;patches&quot; to the 2.6.11 or higher kernal.&nbsp; Did these get integrated at some point so a patch is not needed?&nbsp; Did they get turned into a &quot;module&quot; that needs some other action to include?</p><p>From my command line I looked in /lib/modules, the only thing there is another directory &quot;2.4.35.4&quot;.&nbsp; The contents of that directory contain many object files but do not include specific object files that match what I am looking for.</p><p>If these are not there is it possible to install something to get them or is the only solution to recompile OpenWRT?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p101000">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Timothy</div>
					<div class="post-datetime">
						20 Jan 2010, 19:28					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>pbix wrote:</cite><blockquote><p>The specifics to openwrt come from the fact the tools used in Linux like modprobe and ipkg are not available on Openwrt. </p><p>I do not know if they are &quot;modules&quot; or not.&nbsp; I am too much of a Noob to know precisely what that means.&nbsp; According to the URL I listed these are &quot;patches&quot; to the 2.6.11 or higher kernal.&nbsp; Did these get integrated at some point so a patch is not needed?&nbsp; Did they get turned into a &quot;module&quot; that needs some other action to include?</p><p>From my command line I looked in /lib/modules, the only thing there is another directory &quot;2.4.35.4&quot;.&nbsp; The contents of that directory contain many object files but do not include specific object files that match what I am looking for.</p><p>If these are not there is it possible to install something to get them or is the only solution to recompile OpenWRT?</p></blockquote></div><p>modprobe isn&#039;t there, but the module tools (lsmod, rmmod, insmod) are. ipkg has been replaced by opkg, but I digress.</p><p>Did you compile the image yourself, or did you download it from the repository?<br />I&#039;m not sure which modules are included in the stock images as I tend to compile my own. It&#039;s quite a nice build environment compared to others if you use the tagged releases, most recent being 8.09.2</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p101009">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">pbix</div>
					<div class="post-datetime">
						20 Jan 2010, 20:07					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Timothy wrote:</cite><blockquote><p>[I&#039;m not sure which modules are included in the stock images as I tend to compile my own.</p></blockquote></div><p>I guess I will read between the lines of your last post.</p><p>1)&nbsp; These modules are not included in the build I am running.<br />2)&nbsp; There is no way to install them, the only way is to recompile with the correct options selected.</p><p>Anyone want to disagree with the above?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p101013">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">snowyowlster</div>
					<div class="post-datetime">
						20 Jan 2010, 20:51					</div>
				</div>
				<div class="post-content content">
					<p>I think you will get the sip modules if you install the additional packages<br />kmod-ipt-nathelper-extra&nbsp; and iptables-mod-nat-extra<br />Also install <br />kmod-ipt-conntrack-extra and iptables-mod-conntrack-extra</p><p>The modules can be easily installed by using the opkg command (assuming the router is connected to the Internet)<br />opkg install kmod-ipt-nathelper-extra&nbsp; and iptables-mod-nat-extra kmod-ipt-conntrack-extra and iptables-mod-conntrack-extra</p><p>There is no need to recompile these modules since the compiled versions are already there on the website (and are pulled down automatically with the opkg command)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p101028">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">pbix</div>
					<div class="post-datetime">
						20 Jan 2010, 22:27					</div>
				</div>
				<div class="post-content content">
					<p>The following results from my opkg install attempt.</p><div class="codebox"><pre><code>root@OpenWrt:~# opkg install kmod-ipt-nathelper-extra
Collected errors:
 * Cannot find package kmod-ipt-nathelper-extra.

root@OpenWrt:~# opkg install iptables-mod-nat-extra
Package iptables-mod-nat-extra (1.3.8-4.1) installed in root is up to date.

root@OpenWrt:~# opkg install kmod-ipt-conntrack-extra
Package kmod-ipt-conntrack-extra (2.4.35.4-brcm-2.4-1) installed in root is up to date.

root@OpenWrt:~# opkg install iptables-mod-conntrack-extra
Package iptables-mod-conntrack-extra (1.3.8-4.1) installed in root is up to date.
root@OpenWrt:~#</code></pre></div><p>I think the critical one is the first one which failed.&nbsp; Looking at <a href="http://download.berlin.freifunk.net/fonera/Packages">http://download.berlin.freifunk.net/fonera/Packages</a> it seems that the modules I am interested in are included in that package.</p><p>But what happened to it?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p101082">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">Timothy</div>
					<div class="post-datetime">
						21 Jan 2010, 11:46					</div>
				</div>
				<div class="post-content content">
					<p>Before you try opkg install &lt;whatever&gt; do an opkg update (not sure if you did or not).</p><p>That will update the list of available packages</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p101131">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">pbix</div>
					<div class="post-datetime">
						21 Jan 2010, 22:39					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Timothy wrote:</cite><blockquote><p>Before you try opkg install &lt;whatever&gt; do an opkg update (not sure if you did or not).</p><p>That will update the list of available packages</p></blockquote></div><p>Thanks Timothy but I did the update already.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p101700">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">snowyowlster</div>
					<div class="post-datetime">
						29 Jan 2010, 16:18					</div>
				</div>
				<div class="post-content content">
					<p>I am guessing that you are running the brcm-2.4 image (on a wrt54g ?) - please confirm. <br />Anyway&nbsp; - just do an <br />opkg update<br />opkg list |grep nat</p><p>opkg list |grep conn</p><p>This will give you all the packages related to nat and conntracking. Install all the packages unless it&#039;s pretty clear that they are unnecessary.&nbsp; Alternatively go to<br /><a href="http://downloads.openwrt.org/kamikaze/8.09.1/brcm-2.4/packages/">http://downloads.openwrt.org/kamikaze/8 … /packages/</a><br />and look through the kmod and iptables packages&nbsp; and figure out what you need and use opkg to install. </p><p>Since you have just started using openwrt, another way of installing packages&nbsp; would be to</p><p>cd /tmp<br />wget <a href="http://downloads.openwrt.org/kamikaze/8.09.1/brcm-2.4/packages/file.ipk">http://downloads.openwrt.org/kamikaze/8 … s/file.ipk</a><br />and then do<br />opkg install file.ipk</p><p>Snowyowlster</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>