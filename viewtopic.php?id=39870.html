<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Kernel compile error - LKM not enabled</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 19 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p180346">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">X-log</div>
					<div class="post-datetime">
						11 Oct 2012, 17:54					</div>
				</div>
				<div class="post-content content">
					<p>Then trying to compile trunk (33725) version of x86 openwrt I&#039;m getting error that kernel configuration has modules disabled even then kernel_menuconfig shows &quot;Enable loadable module support&quot; as checked.</p><p>So how do I enable kernel module support?</p><br /><div class="codebox"><pre><code>. /extra/openwrt/include/shell.sh; grep &#039;=[ym]&#039; /extra/openwrt/build_dir/linux-x86_generic/linux-3.3.8/.config | LC_ALL=C sort | md5s &gt; /extra/openwrt/build_dir/linux-x86_generic/linux-3.3.8/.vermagic
touch /extra/openwrt/build_dir/linux-x86_generic/linux-3.3.8/.configured
rm -f /extra/openwrt/build_dir/linux-x86_generic/linux-3.3.8/vmlinux /extra/openwrt/build_dir/linux-x86_generic/linux-3.3.8/System.map
make -C /extra/openwrt/build_dir/linux-x86_generic/linux-3.3.8 HOSTCFLAGS=&quot;-O2 -I/extra/openwrt/staging_dir/host/include -Wall -Wmissing-prototypes -Wstrict-prototypes&quot; CROSS_COMPILE=&quot;i486-openwrt-linux-uclibc-&quot; ARCH=&quot;x86&quot; KBUILD_HAVE_NLS=no CONFIG_SHELL=&quot;/bin/bash&quot; V=&#039;&#039; CC=&quot;ccache_cc&quot; modules
make[5]: Entering directory `/extra/openwrt/build_dir/linux-x86_generic/linux-3.3.8&#039;
  HOSTCC  scripts/kconfig/conf.o
  SHIPPED scripts/kconfig/zconf.tab.c
  SHIPPED scripts/kconfig/zconf.lex.c
  SHIPPED scripts/kconfig/zconf.hash.c
  HOSTCC  scripts/kconfig/zconf.tab.o
  HOSTLD  scripts/kconfig/conf
scripts/kconfig/conf --silentoldconfig Kconfig
*
* Restart config...
*
*
* General setup
*
Prompt for development and/or incomplete code/drivers (EXPERIMENTAL) [Y/n/?] y
Cross-compiler tool prefix (CROSS_COMPILE) [] 
Local version - append to kernel release (LOCALVERSION) [] 
Automatically append version information to the version string (LOCALVERSION_AUTO) [N/y/?] n
Kernel compression mode
  1. Gzip (KERNEL_GZIP)
  2. Bzip2 (KERNEL_BZIP2)
  3. LZMA (KERNEL_LZMA)
&gt; 4. XZ (KERNEL_XZ)
  5. LZO (KERNEL_LZO)
choice[1-5?]: 4
Default hostname (DEFAULT_HOSTNAME) [(none)] (none)
Support for paging of anonymous memory (swap) (SWAP) [Y/n/?] y
System V IPC (SYSVIPC) [Y/n/?] y
POSIX Message Queues (POSIX_MQUEUE) [N/y/?] n
BSD Process Accounting (BSD_PROCESS_ACCT) [N/y/?] n
open by fhandle syscalls (FHANDLE) [N/y/?] n
Export task/process statistics through netlink (EXPERIMENTAL) (TASKSTATS) [N/y/?] n
Auditing support (AUDIT) [N/y/?] n
Kernel .config support (IKCONFIG) [N/m/y/?] n
Kernel log buffer size (16 =&gt; 64KB, 17 =&gt; 128KB) (LOG_BUF_SHIFT) [17] 17
Checkpoint/restore support (CHECKPOINT_RESTORE) [N/y/?] n
Automatic process group scheduling (SCHED_AUTOGROUP) [N/y/?] n
Enable deprecated sysfs features to support old userspace tools (SYSFS_DEPRECATED) [N/y/?] n
Kernel-&gt;user space relay support (formerly relayfs) (RELAY) [N/y/?] n
Crash logging (CRASHLOG) [Y/n] y
Initial RAM filesystem and RAM disk (initramfs/initrd) support (BLK_DEV_INITRD) [Y/n/?] y
  Initramfs source file(s) (INITRAMFS_SOURCE) [] 
  Support initial ramdisks compressed using gzip (RD_GZIP) [Y/n/?] y
  Support initial ramdisks compressed using bzip2 (RD_BZIP2) [Y/n/?] y
  Support initial ramdisks compressed using LZMA (RD_LZMA) [Y/n/?] y
  Support initial ramdisks compressed using XZ (RD_XZ) [N/y/?] n
  Support initial ramdisks compressed using LZO (RD_LZO) [N/y/?] n
Optimize for size (CC_OPTIMIZE_FOR_SIZE) [N/y/?] n
Enable full-sized data structures for core (BASE_FULL) [Y/n/?] y
Enable futex support (FUTEX) [Y/n/?] y
Enable eventpoll support (EPOLL) [Y/n/?] y
Enable signalfd() system call (SIGNALFD) [Y/n/?] y
Enable timerfd() system call (TIMERFD) [Y/n/?] y
Enable eventfd() system call (EVENTFD) [Y/n/?] y
Use full shmem filesystem (SHMEM) [Y/?] y
Enable AIO support (AIO) [Y/n/?] y
Embedded system (EMBEDDED) [Y/n/?] y
Enable VM event counters for /proc/vmstat (VM_EVENT_COUNTERS) [Y/n/?] y
Enable PCI quirk workarounds (PCI_QUIRKS) [Y/n/?] y
Enable SLUB debugging support (SLUB_DEBUG) [Y/n/?] y
Disable heap randomization (COMPAT_BRK) [N/y/?] n
Choose SLAB allocator
  1. SLAB (SLAB)
&gt; 2. SLUB (Unqueued Allocator) (SLUB)
  3. SLOB (Simple Allocator) (SLOB)
choice[1-3?]: 2
Profiling support (PROFILING) [Y/n/?] y
OProfile system profiling (OPROFILE) [M/n/y/?] m
  OProfile multiplexing support (EXPERIMENTAL) (OPROFILE_EVENT_MULTIPLEX) [N/y/?] (NEW) aborted!

Console input/output is redirected. Run &#039;make oldconfig&#039; to update configuration.

make[7]: *** [silentoldconfig] Error 1
make[6]: *** [silentoldconfig] Error 2

The present kernel configuration has modules disabled.
Type &#039;make config&#039; and enable loadable module support.
Then build a kernel with module support enabled.

make[5]: *** [modules] Error 1
make[5]: Leaving directory `/extra/openwrt/build_dir/linux-x86_generic/linux-3.3.8&#039;
make[4]: *** [/extra/openwrt/build_dir/linux-x86_generic/linux-3.3.8/.modules] Error 2
make[4]: Leaving directory `/extra/openwrt/target/linux/x86&#039;
make[3]: *** [compile] Error 2
make[3]: Leaving directory `/extra/openwrt/target/linux&#039;</code></pre></div><p><a href="http://pastebin.com/raw.php?i=Rz44gUya">Kernel compile log</a><br /><a href="http://pastebin.com/raw.php?i=wf6b1NJL">Kernel .config</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p180369">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">lazyfai</div>
					<div class="post-datetime">
						12 Oct 2012, 04:40					</div>
				</div>
				<div class="post-content content">
					<p>Console input/output is redirected. Run &#039;make oldconfig&#039; to update configuration.</p><p>This is the problem, you old .config doesn&#039;t has enough lines like <br />&nbsp; OProfile multiplexing support (EXPERIMENTAL) (OPROFILE_EVENT_MULTIPLEX) [N/y/?] (NEW) aborted!<br />which is newly added options...</p><p>Simple way is to run &quot;make oldconfig&quot; interactively to update the .config file.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>