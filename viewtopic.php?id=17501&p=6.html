<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> RB450 - using Five Ethernet Ports</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 6 Feb 2018 and 6 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 6 of 9</div><nav><ul><li><a href="viewtopic.php%3Fid=17501&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=17501&amp;p=4.html">4</a></li><li><a href="viewtopic.php%3Fid=17501&amp;p=5.html">5</a></li><li class="pagination-current"><span>6</span></li><li><a href="viewtopic.php%3Fid=17501&amp;p=7.html">7</a></li><li><a href="viewtopic.php%3Fid=17501&amp;p=8.html">8</a></li><li><a href="viewtopic.php%3Fid=17501&amp;p=9.html">9</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p88700">
				<div class="post-metadata">
					<div class="post-num">Post #126</div>
					<div class="post-author">phorn</div>
					<div class="post-datetime">
						25 May 2009, 23:53					</div>
				</div>
				<div class="post-content content">
					<p>I think the bridge is a separate issue. Based on what you posted, it looks like the bridge is working. But just to make sure, could you run<br /></p><div class="quotebox"><blockquote><p>brctl show</p></blockquote></div><p>That should list the interfaces attached to each bridge port.</p><p>In order to get forwarding to properly work in a bridge, you need to enable lan&lt;-&gt;lan forwarding in your firewall configuration.</p><p>From what you posted, others are trying to ping the router, but the packets are coming in untagged.&nbsp; The openwrt system did manage to send just one packet (possibly an ARP packet which might ignore vlans).</p><p>Here is a simple shell command to print the status of all the ports and some of the vlans.</p><div class="quotebox"><blockquote><p>swconfig dev eth1 vlan $v get enable_vlan<br />swconfig dev eth1 vlan $v get name<br />for v in 0 1 2 3; do swconfig dev eth1 vlan $v get ports; done<br />for p in 0 1 7 8; do swconfig dev eth1 port $p get status; swconfig dev eth1 port $p get tagged; done</p></blockquote></div><p>The output will read the status from the switch, so this should tell us if something is being configured wrong. I don&#039;t own any device with a IP178C so I was just going off the spec sheet, and there is a chance that I made a mistake somewhere. It is possible that the tagged bit for the CPU is not being set correctly, so everything is coming in untagged.</p><p>Have you tried doing a ping from openwrt to someone else attached to the switch? Or an arping?</p><p>This is just a random guess, but another thing to try is this:<br /></p><div class="quotebox"><blockquote><p>swconfig dev eth1 port 4 set tagged 2</p></blockquote></div><p>The bit for removing vlan tags on port 4 is the same as adding tags for the cpu port 8, so there&#039;s a chance that is mixed up.</p>											<p class="post-edited">(Last edited by <strong>phorn</strong> on 26 May 2009, 00:06)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p88714">
				<div class="post-metadata">
					<div class="post-num">Post #127</div>
					<div class="post-author">robrob</div>
					<div class="post-datetime">
						26 May 2009, 04:45					</div>
				</div>
				<div class="post-content content">
					<div class="codebox"><pre><code>root@OpenWrt:/# brctl show
bridge name     bridge id               STP enabled     interfaces
br-lan          8000.000c42332b86       no              eth0
                                                        eth1
root@OpenWrt:/#</code></pre></div><div class="codebox"><pre><code>root@OpenWrt:/# swconfig dev eth1 vlan $v get enable_vlan
Unknown attribute &quot;enable_vlan&quot;
root@OpenWrt:/# swconfig dev eth1 vlan $v get name
Unknown attribute &quot;name&quot;
root@OpenWrt:/# for v in 0 1 2 3; do swconfig dev eth1 vlan $v get ports; done
0 1 2 3 4 5 6 7 8
0 1 2 3 4 5 6 8
7 8
0 1 2 3 4 5 6 7 8
root@OpenWrt:/#

root@OpenWrt:/# for p in 0 1 7 8; do swconfig dev eth1 port $p get status; swcon
fig dev eth1 port $p get tagged; done
up, 100 Mbps, full duplex, auto-negotiate
2
down, auto-negotiate (in progress)
2
down, auto-negotiate (in progress)
2
up, 100 Mbps, cpu port
2
root@OpenWrt:/#</code></pre></div><div class="quotebox"><blockquote><p>Have you tried doing a ping from openwrt to someone else attached to the switch? Or an arping?</p></blockquote></div><p>Yes, I can ping from the kamikaze command line out the wan port (eth0) and it will respond to outside pings, but the switch ports will neither send or receive pings--through the router or port to port.</p>											<p class="post-edited">(Last edited by <strong>robrob</strong> on 26 May 2009, 05:02)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p88719">
				<div class="post-metadata">
					<div class="post-num">Post #128</div>
					<div class="post-author">phorn</div>
					<div class="post-datetime">
						26 May 2009, 06:36					</div>
				</div>
				<div class="post-content content">
					<p>To start with, your configuration is such that all the interfaces are bridged together.&nbsp; This has nothing to do with VLANs. If you intend to do this, I think you may need to read up on STP (Spanning Tree Protocol) which is how bridges work across different switches.</p><p>Just to make it clear, I highly recommend not bridging eth0 and eth1 together, just to gain one additional port. The performance is so poor that you are better off buying an additional 4 or 8-port switch than using a software bridge. I merely suggested that as an example, but if you do this, you&#039;ll still be stuck with the whole 20Mbps limit going between them due to the ag71xx driver performance.</p><p>Can you please explain exactly what you intend to do with your RB492 (and what you are putting in your /etc/config/network).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p88739">
				<div class="post-metadata">
					<div class="post-num">Post #129</div>
					<div class="post-author">robrob</div>
					<div class="post-datetime">
						26 May 2009, 14:01					</div>
				</div>
				<div class="post-content content">
					<p>Patrick,</p><p>Thanks again for all the hand holding. This router and networking thing is just a hobby for me and I obviously still have a lot to learn. I removed the &#039;eth0 eth1&#039; bridge and set up the network file as you suggested several posts back. Everything is now working as it should using this network file:<br /></p><div class="codebox"><pre><code>config switch eth1
option reset 1
option enable_vlan 1

config switch_vlan
option device eth1
option vlan 1
option ports &quot;0 1 2 3 4 5 8t&quot;

config switch_vlan
option device eth1
option vlan 2
option ports &quot;6 7 8t&quot;

config interface lan
option ifname &quot;eth1.1&quot;
option proto static
option type bridge
option ipaddr 192.168.2.1
option netmask 255.255.255.0

config interface lan2
option ifname &quot;eth1.2&quot;
option proto static
option ipaddr 192.168.3.1
option netmask 255.255.255.0

config interface wan
option ifname &quot;eth0&quot;
option proto static
option ipaddr 192.168.1.7
option netmask 255.255.255.0
option gateway 192.168.1.1
option dns 208.67.222.222</code></pre></div><p>To recap what was done to get the RB493AH working:</p><p>Fresh svn checkout<br />Placed your patch <a href="http://inst.eecs.berkeley.edu/~pathorn/ip175c/ar71xx-ip175c.patch">http://inst.eecs.berkeley.edu/~pathorn/ … 175c.patch</a> in the top kamikaze directory<br />implemented the patch with this command: patch -p0 &lt; ar71xx-ip175c.patch<br />Selected &quot;Target Profile/AR7xx&quot; and &quot;Base system/swconfig&quot; in &quot;make menuconfig&quot;<br />Compiled Kamikaze<br />Edited the /etc/config/network file as shown above.<br />Edited the /etc/config/firewall.</p><p>Thanks Patrick for all the work on the IP175 and 178 swtich driver and getting it running on the RB4xx routers.</p><p>Rob</p>											<p class="post-edited">(Last edited by <strong>robrob</strong> on 27 May 2009, 14:22)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p88841">
				<div class="post-metadata">
					<div class="post-num">Post #130</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						27 May 2009, 15:44					</div>
				</div>
				<div class="post-content content">
					<p>Could you please open a ticket for the switch support patches? Since Patrick&#039;s previous work is already integrated into trunk, it would be good to have the latest fixes there too <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>~ JoW</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p88875">
				<div class="post-metadata">
					<div class="post-num">Post #131</div>
					<div class="post-author">phorn</div>
					<div class="post-datetime">
						28 May 2009, 05:26					</div>
				</div>
				<div class="post-content content">
					<p>Already done: <a href="https://dev.openwrt.org/ticket/5193">https://dev.openwrt.org/ticket/5193</a><br />I&#039;ve been busy so I haven&#039;t posted this anywhere yet.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p89138">
				<div class="post-metadata">
					<div class="post-num">Post #132</div>
					<div class="post-author">robrob</div>
					<div class="post-datetime">
						2 Jun 2009, 17:30					</div>
				</div>
				<div class="post-content content">
					<p>What a pisser. After &quot;svn up&quot;&#039;ing a few times the IPC 178 switch driver is no longer working. The dmesg lists &quot;driver=Generic PHY&quot; I verifed 2.6.28.10 is being compiled (uname -a) and all of Patrick&#039;s edits are in the three files that are patched.</p><p>&quot;swconfig dev eth1 help&quot; gives &quot;failed to connect to the switch&quot;</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p89162">
				<div class="post-metadata">
					<div class="post-num">Post #133</div>
					<div class="post-author">napierzaza</div>
					<div class="post-datetime">
						2 Jun 2009, 22:24					</div>
				</div>
				<div class="post-content content">
					<p>Argh, I can&#039;t find enough reliable info on the routerboards. I want a 8+ port Gigabit switch and would love to have it running OpenWRT or linux or what have you. I went to the mikrotik site and nothing there was fitting the bill. But the link you posted has all sorts of models I haven&#039;t seen on the Mikrotik site (but still don&#039;t fit). Is there something I&#039;m missing? Can someone point me in the right direction here?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p89168">
				<div class="post-metadata">
					<div class="post-num">Post #134</div>
					<div class="post-author">robrob</div>
					<div class="post-datetime">
						2 Jun 2009, 23:58					</div>
				</div>
				<div class="post-content content">
					<p>As long as we&#039;re dreaming, give me an RB493AH with an 8 port giga switch, dual USB, and of course OpenWrt.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p89184">
				<div class="post-metadata">
					<div class="post-num">Post #135</div>
					<div class="post-author">phorn</div>
					<div class="post-datetime">
						3 Jun 2009, 09:17					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>robrob wrote:</cite><blockquote><p>What a pisser. After &quot;svn up&quot;&#039;ing a few times the IPC 178 switch driver is no longer working. The dmesg lists &quot;driver=Generic PHY&quot; I verifed 2.6.28.10 is being compiled (uname -a) and all of Patrick&#039;s edits are in the three files that are patched.</p></blockquote></div><p>I can&#039;t find any reason for it to have changed with the latest updates.</p><p>After running &quot;make&quot;, go to the bottom of &quot;build_dir/linux-ar71xx/linux-2.6.28.10/drivers/net/phy/ip175c.c&quot; and add this printk statement:<br /></p><div class="codebox"><pre><code>int __init ip175c_init(void)
{
        printk(KERN_WARN &quot;Registered ip175c\n&quot;);
        return phy_driver_register(&amp;ip175c_driver);
}</code></pre></div><p>Then, run &quot;make&quot; again.</p><p>This should help narrow down if there is another problem with loading order.</p><p>You could try updating back to an older revision but I don&#039;t think that is related.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p89252">
				<div class="post-metadata">
					<div class="post-num">Post #136</div>
					<div class="post-author">mtadeu</div>
					<div class="post-datetime">
						4 Jun 2009, 00:04					</div>
				</div>
				<div class="post-content content">
					<p>I try svv 16299, download patch from #5193, and the printk. Install it (rb450):<br /></p><div class="codebox"><pre><code>Atheros AR7130 rev 2 (id:0xa8), CPU:300.000 MHz, AHB:150.000 MHz, DDR:300.000 MHz
Determined physical RAM map:
 memory: 02000000 @ 00000000 (usable)
...
Serial: 8250/16550 driver1 ports, IRQ sharing disabled
serial8250.0: ttyS0 at MMIO 0x18020000 (irq = 11) is a 16550A
console handover: boot [early0] -&gt; real [ttyS0]
Registered ip175c
ag71xx_mdio: probed
eth0: Atheros AG71xx at 0xba000000, irq 5
eth1: Atheros AG71xx at 0xb9000000, irq 4                                                                                                                   
....
# swconfig dev eth1 help
Switch 1: eth1(eth1), ports: 6, vlans: 16
...
# ifconfig
br-lan    Link encap:Ethernet  HWaddr 00:0C:42:2E:C3:07
          inet addr:10.10.0.52  Bcast:10.10.0.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

eth0      Link encap:Ethernet  HWaddr 00:0C:42:2E:C3:07
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
          Interrupt:5


# ping 10.10.0.52
Segmentation fault</code></pre></div><p>I try remove the bridge<br /></p><div class="codebox"><pre><code># ifconfig
eth0      Link encap:Ethernet  HWaddr 00:0C:42:2E:C3:07
          inet addr:10.10.0.52  Bcast:10.10.0.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
          Interrupt:5</code></pre></div><p>Same seg fault<br />in logread<br /></p><div class="codebox"><pre><code>Jan  1 00:00:09 OpenWrt user.info kernel: input: gpio-buttons as /devices/platform/gpio-buttons/input/input0
Jan  1 00:00:09 OpenWrt user.info sysinit: Aiee, segfault! You should probably report this as a bug to the developer
Jan  1 00:00:09 OpenWrt user.debug kernel: ar71xx-wdt: enabling watchdog timer
Jan  1 00:00:09 OpenWrt user.info sysinit: watchdog: WDIOC_SETTIMEOUT: Invalid argument
Jan  1 00:00:25 OpenWrt daemon.info init: starting pid 179, tty &#039;/dev/ttyS0&#039;: &#039;/bin/ash --login&#039;</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p89254">
				<div class="post-metadata">
					<div class="post-num">Post #137</div>
					<div class="post-author">chillifire</div>
					<div class="post-datetime">
						4 Jun 2009, 01:40					</div>
				</div>
				<div class="post-content content">
					<p>Might be something systematic? I had the same segfault on a DIR300 on r16301.</p><p><a href="http://forum.openwrt.org/viewtopic.php?pid=89253#p89253">http://forum.openwrt.org/viewtopic.php?pid=89253#p89253</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p89263">
				<div class="post-metadata">
					<div class="post-num">Post #138</div>
					<div class="post-author">mtadeu</div>
					<div class="post-datetime">
						4 Jun 2009, 05:07					</div>
				</div>
				<div class="post-content content">
					<p>Good news: SVN 16316 have some patchs to ar71xx. svn up and I Include #5193 patchs, without phorn printk. Also, the correct is KERN_WARNING <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />robrob: The #5193 patchs is not applied to trunk, yet.<br />Need more tests, but now I can ping !<br /></p><div class="codebox"><pre><code>Linux version 2.6.28.10 (marcos@nbmt) (gcc version 4.1.2) #1 Wed Jun 3 20:56:30 BRT 2009
prom: fw_arg0=00000007, fw_arg1=a0861c00, fw_arg2=00000000, fw_arg3=00000000
MyLoader: sysp=fbe3d6e0, boardp=d1b0e9fb, parts=10fb9599
console [early0] enabled
CPU revision is: 00019374 (MIPS 24Kc)
Atheros AR7130 rev 2 (id:0xa8), CPU:300.000 MHz, AHB:150.000 MHz, DDR:300.000 MHz
Determined physical RAM map:
 memory: 02000000 @ 00000000 (usable)                                                                                                                       
...
ag71xx_mdio: probed
eth0: Atheros AG71xx at 0xba000000, irq 5
eth0: connected to PHY at 0:04 [uid=02430d80, driver=Generic PHY]
eth1: Atheros AG71xx at 0xb9000000, irq 4
eth1: connected to 4 PHYs
eth1: connected to PHY at 0:00 [uid=02430d80, driver=IC+ IP175C]</code></pre></div><p>Well, I need to try trunk because when run kamikaze 8.09 with icplus-patch.v3.1, the interface hang after random time (hours or days), in RB450, <br />The watchdog do not boot. Only interfaces hang. I put the &quot;lost ping watchdog&quot; script to save some data. dmesg show notting abnormal. load average is HI (6 or more).</p>											<p class="post-edited">(Last edited by <strong>mtadeu</strong> on 4 Jun 2009, 18:47)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p89385">
				<div class="post-metadata">
					<div class="post-num">Post #139</div>
					<div class="post-author">robrob</div>
					<div class="post-datetime">
						5 Jun 2009, 17:56					</div>
				</div>
				<div class="post-content content">
					<p>Patrick, I tried to add your printk statement but couldn&#039;t get it to compile so I started over with a new svn, then tried the patch from this thread, and then the two #5193 patches. All three builds dmesg still showed eth1: driver=Generic PHY</p><p>But I can now ping without a segfault.</p>											<p class="post-edited">(Last edited by <strong>robrob</strong> on 6 Jun 2009, 04:59)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p89468">
				<div class="post-metadata">
					<div class="post-num">Post #140</div>
					<div class="post-author">phorn</div>
					<div class="post-datetime">
						7 Jun 2009, 07:03					</div>
				</div>
				<div class="post-content content">
					<p>Also, what do you mean by &quot;all three builds&quot;? Just apply both of the patches from #5193.</p><p>Then, run &quot;make&quot;. After building it, edit &quot;build_dir/linux-ar71xx/linux-2.6.28.10/drivers/net/phy/ip175c.c&quot; like before, and add:<br />printk(KERN_WARNING &quot;Registered ip175c\n&quot;);</p><p>(I had forgotten the ING on KERN_WARNING)<br />Then, run &quot;make&quot; one more time and it should build that file.</p><p>Then, could you post the output of &quot;dmesg&quot;, at least until it has printed the &quot;registered ip175c&quot; and the &quot;eth1: using Generic PHY&quot;</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p89675">
				<div class="post-metadata">
					<div class="post-num">Post #141</div>
					<div class="post-author">robrob</div>
					<div class="post-datetime">
						10 Jun 2009, 23:45					</div>
				</div>
				<div class="post-content content">
					<p>Patrick,</p><p>I compiled&nbsp; a fresh svn with no patches and flashed the router, tried your patch and flashed, then reverted the patch and applied the&nbsp; two #5193 patches, compiled and flashed. All 3 images gave the phy=generic dmesg.</p><p>I get an error when I insert your printk statement. Where exactly does it go in the ip175c.c file?</p><p>Thanks again for the help.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p89687">
				<div class="post-metadata">
					<div class="post-num">Post #142</div>
					<div class="post-author">phorn</div>
					<div class="post-datetime">
						11 Jun 2009, 08:39					</div>
				</div>
				<div class="post-content content">
					<p><strong>I compiled&nbsp; a fresh svn with no patches and flashed the router</strong><br />You sure you cleaned out the kernel sources? It&#039;s not smart enough to figure out exactly which .patch files changed since the last build, so you may have just compiled the same kernel three times unless you made clean.</p><p>Just to make absolutely sure, do:<br />TOPDIR=$PWD make -C target/linux clean<br /></p><div class="quotebox"><blockquote><p>make: Entering directory `/home/ext/prog/kamikaze/target/linux&#039;<br />make[1]: Entering directory `/home/ext/prog/kamikaze/target/linux/ar71xx&#039;<br />rm -rf /ext/prog/kamikaze/build_dir/linux-ar71xx<br />make[1]: Leaving directory `/home/ext/prog/kamikaze/target/linux/ar71xx&#039;<br />make: Leaving directory `/home/ext/prog/kamikaze/target/linux&#039;</p></blockquote></div><p>Download this one-line diff: <a href="http://www-inst.eecs.berkeley.edu/~pathorn/900-add_print_statement.patch">http://www-inst.eecs.berkeley.edu/~path … ment.patch</a><br />Save it in the &quot;target/linux/ar71xx/patches-2.6.28/&quot; directory.</p><p>Then, type &quot;make&quot;.&nbsp; To check, you can afterwards open up &quot;build_dir/linux-ar71xx/linux-2.6.28.10/drivers/net/phy/ip175c.c&quot; and make sure there is a print statement near the bottom.<br />You can also check build_dir/linux-ar71xx/linux-2.6.28.10/drivers/net/Makefile and make sure CONFIG_AG71XX is in the middle of the makefile instead of the 10th line.</p>											<p class="post-edited">(Last edited by <strong>phorn</strong> on 11 Jun 2009, 08:41)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p89722">
				<div class="post-metadata">
					<div class="post-num">Post #143</div>
					<div class="post-author">robrob</div>
					<div class="post-datetime">
						11 Jun 2009, 19:09					</div>
				</div>
				<div class="post-content content">
					<p>Patrick,</p><p>Your were right again, after the &quot;make clean&quot; the patches were applied and the IP175 driver is being used.</p><p>Here&#039;s the dmesg:<br /></p><div class="codebox"><pre><code>dmesg
Linux version 2.6.28.10 (rob@Server) (gcc version 4.1.2) #1 Thu Jun 11 10:48:50 EDT 2009
prom: fw_arg0=00000007, fw_arg1=a0861c00, fw_arg2=00000000, fw_arg3=00000000
MyLoader: sysp=f5fff9f9, boardp=fbfbffd3, parts=fffefffe
console [early0] enabled
CPU revision is: 00019374 (MIPS 24Kc)
Atheros AR7161 rev 2 (id:0xaa), CPU:680.000 MHz, AHB:170.000 MHz, DDR:340.000 MHz
Determined physical RAM map:
 memory: 08000000 @ 00000000 (usable)
Initrd not found or empty - disabling initrd
Zone PFN ranges:
  Normal   0x00000000 -&gt; 0x00008000
Movable zone start PFN for each node
early_node_map[1] active PFN ranges
    0: 0x00000000 -&gt; 0x00008000
On node 0 totalpages: 32768
free_area_init_node: node 0, pgdat 80282480, node_mem_map 81000000
  Normal zone: 256 pages used for memmap
  Normal zone: 0 pages reserved
  Normal zone: 32512 pages, LIFO batch:7
  Movable zone: 0 pages used for memmap
Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 32512
Kernel command line: rootfstype=squashfs,yaffs,jffs2 noinitrd console=ttyS0,115200
Primary instruction cache 64kB, VIPT, 4-way, linesize 32 bytes.
Primary data cache 32kB, 4-way, VIPT, cache aliases, linesize 32 bytes
Writing ErrCtl register=00000800
Readback ErrCtl register=00000800
PID hash table entries: 512 (order: 9, 2048 bytes)
Dentry cache hash table entries: 16384 (order: 4, 65536 bytes)
Inode-cache hash table entries: 8192 (order: 3, 32768 bytes)
Memory: 126960k/131072k available (1853k kernel code, 3944k reserved, 337k data, 136k init, 0k highmem)
SLUB: Genslabs=6, HWalign=32, Order=0-3, MinObjects=0, CPUs=1, Nodes=1
Calibrating delay loop... 452.19 BogoMIPS (lpj=2260992)
Mount-cache hash table entries: 512
net_namespace: 480 bytes
NET: Registered protocol family 16
MIPS: machine is MikroTik RouterBOARD 493/AH
registering PCI controller with io_map_base unset
pci 0000:00:00.0: reg 10 32bit mmio: [0x000000-0xfffffff]
pci 0000:00:00.0: reg 14 io port: [0x00-0xff]
pci 0000:00:00.0: supports D1 D2
pci 0000:00:00.0: PME# supported from D0 D1 D2 D3hot
pci 0000:00:00.0: PME# disabled
pci 0000:00:12.0: reg 10 32bit mmio: [0x000000-0x00ffff]
pci 0000:00:14.0: reg 10 32bit mmio: [0x000000-0x00ffff]
pci 0000:00:14.0: PME# supported from D0 D3hot
pci 0000:00:14.0: PME# disabled
PCI: mapping irq 32 to pin1@0000:00:12.0
PCI: mapping irq 34 to pin1@0000:00:14.0
NET: Registered protocol family 2
Switched to high resolution mode on CPU 0
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 4096 (order: 3, 32768 bytes)
TCP bind hash table entries: 4096 (order: 2, 16384 bytes)
TCP: Hash tables configured (established 4096 bind 4096)
TCP reno registered
NET: Registered protocol family 1
squashfs: version 3.0 (2006/03/15) Phillip Lougher
Registering mini_fo version $Id$
JFFS2 version 2.2. (NAND) (SUMMARY)  Â© 2001-2006 Red Hat, Inc.
yaffs Jun 11 2009 10:46:04 Installing.
msgmni has been set to 248
io scheduler noop registered
io scheduler deadline registered (default)
Serial: 8250/16550 driver1 ports, IRQ sharing disabled
serial8250.0: ttyS0 at MMIO 0x18020000 (irq = 11) is a 16550A
console handover: boot [early0] -&gt; real [ttyS0]
ip175c_init called.
ag71xx_mdio: probed
eth0: Atheros AG71xx at 0xb9000000, irq 4
eth1: Atheros AG71xx at 0xba000000, irq 5
eth1: connected to PHY at 0:00 [uid=02430d80, driver=IC+ IP175C]
NAND flash driver for RouterBoard 4xx series version 0.1.10
NAND SPI clock 28333 kHz (AHB 170000 kHz / 6)
FLASH SPI clock 28333 kHz (AHB 170000 kHz / 6)
NAND device: Manufacturer ID: 0xad, Chip ID: 0x76 (Hynix NAND 64MiB 3,3V 8-bit)
Scanning device for bad blocks
Creating 3 MTD partitions on &quot;NAND 64MiB 3,3V 8-bit&quot;:
0x00000000-0x00040000 : &quot;booter&quot;
0x00040000-0x00400000 : &quot;kernel&quot;
0x00400000-0x04000000 : &quot;rootfs&quot;
mtd: partition &quot;rootfs&quot; set to be root filesystem
split_squashfs: error occured while reading from &quot;NAND 64MiB 3,3V 8-bit&quot;
Atheros AR71xx SPI Controller driver version 0.2.2
Atheros AR71xx hardware watchdog driver version 0.1.0
ar71xx-wdt: timeout=15 secs (max=25)
TCP westwood registered
NET: Registered protocol family 17
802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;
All bugs added by David S. Miller &lt;davem@redhat.com&gt;
yaffs: dev is 32505858 name is &quot;mtdblock2&quot;
yaffs: passed flags &quot;&quot;
yaffs: Attempting MTD mount on 31.2, &quot;mtdblock2&quot;
yaffs_read_super: isCheckpointed 0
VFS: Mounted root (yaffs filesystem) readonly.
Freeing unused kernel memory: 136k freed
Please be patient, while OpenWrt loads ...
Algorithmics/MIPS FPU Emulator v1.5
save exit: isCheckpointed 0
ar71xx: pll_reg 0xb8050010: 0x1099
eth0: link up (100Mbps/Full duplex)
device eth0 entered promiscuous mode
br-lan: topology change detected, propagating
br-lan: port 1(eth0) entering forwarding state
cfg80211: Using static regulatory domain info
cfg80211: Regulatory domain: US
        (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp)
        (2402000 KHz - 2472000 KHz @ 40000 KHz), (600 mBi, 2700 mBm)
        (5170000 KHz - 5190000 KHz @ 40000 KHz), (600 mBi, 2300 mBm)
        (5190000 KHz - 5210000 KHz @ 40000 KHz), (600 mBi, 2300 mBm)
        (5210000 KHz - 5230000 KHz @ 40000 KHz), (600 mBi, 2300 mBm)
        (5230000 KHz - 5330000 KHz @ 40000 KHz), (600 mBi, 2300 mBm)
        (5735000 KHz - 5835000 KHz @ 40000 KHz), (600 mBi, 3000 mBm)
cfg80211: Calling CRDA for country: US
SCSI subsystem initialized
usbcore: registered new interface driver usbfs
usbcore: registered new interface driver hub
usbcore: registered new device driver usb
PCI: Enabling device 0000:00:14.0 (0000 -&gt; 0002)
ath: Country alpha2 being used: AM
ath: Regpair detected: 0x30
phy0: Selected rate control algorithm &#039;ath9k_rate_control&#039;
Registered led device: ath9k-phy0::radio
Registered led device: ath9k-phy0::assoc
Registered led device: ath9k-phy0::tx
Registered led device: ath9k-phy0::rx
phy0: Atheros AR9160 MAC/BB Rev:0 AR5133 RF Rev:b0: mem=0xb0010000, irq=34
cfg80211: Calling CRDA for country: AM
PPP generic driver version 2.4.2
ip_tables: (C) 2000-2006 Netfilter Core Team
Driver &#039;sd&#039; needs updating - please use bus_type methods
ehci_hcd: USB 2.0 &#039;Enhanced&#039; Host Controller (EHCI) Driver
nf_conntrack version 0.5.0 (2048 buckets, 8192 max)
CONFIG_NF_CT_ACCT is deprecated and will be removed soon. Please use
nf_conntrack.acct=1 kernel paramater, acct=1 nf_conntrack module option or
sysctl net.netfilter.nf_conntrack_acct=1 to enable it.
IMQ driver loaded successfully.
        Hooking IMQ before NAT on PREROUTING.
        Hooking IMQ after NAT on POSTROUTING.
wlan: trunk
ath_hal: module license &#039;Proprietary&#039; taints kernel.
ath_hal: 2009-05-08 (AR5210, AR5211, AR5212, AR5416, RF5111, RF5112, RF2413, RF5413, RF2133, RF2425, REGOPS_FUNC, XR)
ath_rate_minstrel: Minstrel automatic rate control algorithm 1.2 (trunk)
ath_rate_minstrel: look around rate set to 10%
ath_rate_minstrel: EWMA rolloff level set to 75%
ath_rate_minstrel: max segment size in the mrr set to 6000 us
wlan: mac acl policy registered
ath_pci: trunk
PCI: Enabling device 0000:00:12.0 (0000 -&gt; 0002)
Atheros HAL provided by OpenWrt, DD-WRT and MakSat Technologies
wifi0: 11a rates: 6Mbps 9Mbps 12Mbps 18Mbps 24Mbps 36Mbps 48Mbps 54Mbps
wifi0: 11b rates: 1Mbps 2Mbps 5.5Mbps 11Mbps
wifi0: 11g rates: 1Mbps 2Mbps 5.5Mbps 11Mbps 6Mbps 9Mbps 12Mbps 18Mbps 24Mbps 36Mbps 48Mbps 54Mbps
wifi0: turboA rates: 6Mbps 9Mbps 12Mbps 18Mbps 24Mbps 36Mbps 48Mbps 54Mbps
wifi0: turboG rates: 6Mbps 12Mbps 18Mbps 24Mbps 36Mbps 48Mbps 54Mbps
wifi0: H/W encryption support: WEP AES AES_CCM TKIP
ath_pci: wifi0: Atheros 5212: mem=0x10000000, irq=32
uhci_hcd: USB Universal Host Controller Interface driver
Initializing USB Mass Storage driver...
usbcore: registered new interface driver usb-storage
USB Mass Storage support registered.
gpio-buttons driver version 0.1.1
input: gpio-buttons as /devices/platform/gpio-buttons/input/input0</code></pre></div><p>Once again, thanks for the help.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p89769">
				<div class="post-metadata">
					<div class="post-num">Post #144</div>
					<div class="post-author">robrob</div>
					<div class="post-datetime">
						12 Jun 2009, 07:01					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m getting these messages every 10 seconds or so when nothing is plugged into the switch. Any way to stop it other than making sure an active connection is up?<br /></p><div class="codebox"><pre><code>Trying 10/HALF
Trying 10/HALF
Trying 10/HALF
Trying 10/HALF
Trying 10/HALF
Trying 10/HALF
Trying 10/HALF
Trying 10/HALF
Trying 10/HALF
Trying 10/HALF
Trying 10/HALF
Trying 10/HALF
Trying 10/HALF
Trying 10/HALF
Trying 10/HALF</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p89890">
				<div class="post-metadata">
					<div class="post-num">Post #145</div>
					<div class="post-author">jirka</div>
					<div class="post-datetime">
						15 Jun 2009, 12:45					</div>
				</div>
				<div class="post-content content">
					<p>Hi,<br />I compiled a latest openwrt without patches and flashed the RB450.&nbsp; SVN was &quot;svn.openwrt.org/openwrt/trunk&quot; and Revision 16438.<br />I added:<br />- message &quot;ip175c: LOADED&quot; into ip175.c<br />- compilation flags SW_CONFIG=y, SW_IP175=y ... .</p><p>I have tried:<br />root@OpenWrt:/# swconfig dev eth0 help<br />Failed to connect to the switch</p><p>Where is mistake ? <br />Can I compile kernel with debug info messages to solve this problem ? <br />Is PCI needed in RB450 ? I have read dmesg from RB493 and there area messages about connection PCI to the switch.</p><p>Thanks for help<br />Jirka</p><br /><div class="codebox"><pre><code>root@OpenWrt:/# dmesg
Linux version 2.6.28.10 (vyvojar@linxdevel) (gcc version 4.1.2) #1 Mon Jun 15 12
:38:40 CEST 2009
prom: fw_arg0=00000007, fw_arg1=a0861c00, fw_arg2=00000000, fw_arg3=00000000
MyLoader: sysp=36e053bc, boardp=927fbb7f, parts=f0e1f3f1
console [early0] enabled
CPU revision is: 00019374 (MIPS 24Kc)
Atheros AR7130 rev 2 (id:0xa8), CPU:300.000 MHz, AHB:150.000 MHz, DDR:300.000 MH
z
Determined physical RAM map:
 memory: 02000000 @ 00000000 (usable)
Initrd not found or empty - disabling initrd
Zone PFN ranges:
  Normal   0x00000000 -&gt; 0x00002000
Movable zone start PFN for each node
early_node_map[1] active PFN ranges
    0: 0x00000000 -&gt; 0x00002000
On node 0 totalpages: 8192
free_area_init_node: node 0, pgdat 802824f0, node_mem_map 81000000
  Normal zone: 64 pages used for memmap
  Normal zone: 0 pages reserved
  Normal zone: 8128 pages, LIFO batch:0
  Movable zone: 0 pages used for memmap
Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 8128
Kernel command line: rootfstype=squashfs,yaffs,jffs2 noinitrd console=ttyS0,1152
00
Primary instruction cache 64kB, VIPT, 4-way, linesize 32 bytes.
Primary data cache 32kB, 4-way, VIPT, cache aliases, linesize 32 bytes
Writing ErrCtl register=0000c040
Readback ErrCtl register=0000c040
PID hash table entries: 128 (order: 7, 512 bytes)
Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
Memory: 29664k/32768k available (1854k kernel code, 3104k reserved, 336k data, 1
36k init, 0k highmem)
SLUB: Genslabs=6, HWalign=32, Order=0-3, MinObjects=0, CPUs=1, Nodes=1
Calibrating delay loop... 199.88 BogoMIPS (lpj=999424)
Mount-cache hash table entries: 512
net_namespace: 480 bytes
NET: Registered protocol family 16
MIPS: machine is MikroTik RouterBOARD 450
NET: Registered protocol family 2
Switched to high resolution mode on CPU 0
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 1024 (order: 1, 8192 bytes)
TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
TCP: Hash tables configured (established 1024 bind 1024)
TCP reno registered
NET: Registered protocol family 1
squashfs: version 3.0 (2006/03/15) Phillip Lougher
Registering mini_fo version $Id$
JFFS2 version 2.2. (NAND) (SUMMARY)  Â© 2001-2006 Red Hat, Inc.
yaffs Jun 15 2009 12:35:09 Installing.
msgmni has been set to 57
io scheduler noop registered
io scheduler deadline registered (default)
Serial: 8250/16550 driver1 ports, IRQ sharing disabled
serial8250.0: ttyS0 at MMIO 0x18020000 (irq = 11) is a 16550A
console handover: boot [early0] -&gt; real [ttyS0]
ag71xx_mdio: probed
eth0: Atheros AG71xx at 0xba000000, irq 5
eth0: connected to PHY at 0:04 [uid=02430d80, driver=Generic PHY]
eth1: Atheros AG71xx at 0xb9000000, irq 4
eth1: connected to 4 PHYs
ip175c: LOADED
NAND flash driver for RouterBoard 4xx series version 0.1.10
NAND SPI clock 25000 kHz (AHB 150000 kHz / 6)
FLASH SPI clock 25000 kHz (AHB 150000 kHz / 6)
NAND device: Manufacturer ID: 0xad, Chip ID: 0x76 (Hynix NAND 64MiB 3,3V 8-bit)
Scanning device for bad blocks
Bad eraseblock 3217 at 0x03244000
Creating 3 MTD partitions on &quot;NAND 64MiB 3,3V 8-bit&quot;:
0x00000000-0x00040000 : &quot;booter&quot;
0x00040000-0x00400000 : &quot;kernel&quot;
0x00400000-0x04000000 : &quot;rootfs&quot;
mtd: partition &quot;rootfs&quot; set to be root filesystem
split_squashfs: no squashfs found in &quot;NAND 64MiB 3,3V 8-bit&quot;
Atheros AR71xx SPI Controller driver version 0.2.2
Atheros AR71xx hardware watchdog driver version 0.1.0
ar71xx-wdt: timeout=15 secs (max=28)
TCP westwood registered
NET: Registered protocol family 17
802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;
All bugs added by David S. Miller &lt;davem@redhat.com&gt;
yaffs: dev is 32505858 name is &quot;mtdblock2&quot;
yaffs: passed flags &quot;&quot;
yaffs: Attempting MTD mount on 31.2, &quot;mtdblock2&quot;
yaffs: block 2961 is marked bad
block 2962 is bad
yaffs_read_super: isCheckpointed 0
VFS: Mounted root (yaffs filesystem) readonly.
Freeing unused kernel memory: 136k freed
Please be patient, while OpenWrt loads ...
Algorithmics/MIPS FPU Emulator v1.5
save exit: isCheckpointed 0
device eth0 entered promiscuous mode
ar71xx: pll_reg 0xb8050010: 0x1099
eth1: link up (100Mbps/Full duplex)
PPP generic driver version 2.4.2
ip_tables: (C) 2000-2006 Netfilter Core Team
ar71xx: pll_reg 0xb8050014: 0x1099
eth0: link up (100Mbps/Full duplex)
br-lan: topology change detected, propagating
br-lan: port 1(eth0) entering forwarding state
nf_conntrack version 0.5.0 (512 buckets, 2048 max)
CONFIG_NF_CT_ACCT is deprecated and will be removed soon. Please use
nf_conntrack.acct=1 kernel paramater, acct=1 nf_conntrack module option or
sysctl net.netfilter.nf_conntrack_acct=1 to enable it.
gpio-buttons driver version 0.1.1
input: gpio-buttons as /devices/platform/gpio-buttons/input/input0
ar71xx-wdt: enabling watchdog timer
root@OpenWrt:/#

root@OpenWrt:/# lsmod | grep sw
root@OpenWrt:/# 

root@OpenWrt:/# ls /lib/modules/2.6.28.10/
button-hotplug.ko     iptable_raw.ko        ppp_generic.ko
crc-ccitt.ko          nf_conntrack.ko       pppoe.ko
gpio_buttons.ko       nf_conntrack_ftp.ko   pppox.ko
input-core.ko         nf_conntrack_ipv4.ko  slhc.ko
input-polldev.ko      nf_conntrack_irc.ko   x_tables.ko
ip_tables.ko          nf_conntrack_tftp.ko  xt_NOTRACK.ko
ipt_LOG.ko            nf_defrag_ipv4.ko     xt_TCPMSS.ko
ipt_MASQUERADE.ko     nf_nat.ko             xt_limit.ko
ipt_REJECT.ko         nf_nat_ftp.ko         xt_mac.ko
iptable_filter.ko     nf_nat_irc.ko         xt_multiport.ko
iptable_mangle.ko     nf_nat_tftp.ko        xt_state.ko
iptable_nat.ko        ppp_async.ko          xt_tcpudp.ko
root@OpenWrt:/#
root@OpenWrt:/#
root@OpenWrt:/# lspci
root@OpenWrt:/#
root@OpenWrt:/# swconfig dev eth0 help
Failed to connect to the switch
root@OpenWrt:/#
root@OpenWrt:/# ls /proc/net/
arp                  netfilter            rt_cache
dev                  netlink              snmp
dev_mcast            netstat              sockstat
igmp                 nf_conntrack         softnet_stat
ip_conntrack         nf_conntrack_expect  stat
ip_conntrack_expect  packet               tcp
ip_mr_cache          protocols            udp
ip_mr_vif            psched               udplite
ip_tables_matches    ptype                unix
ip_tables_names      raw                  vlan
ip_tables_targets    route                wireless
mcfilter             rt_acct
root@OpenWrt:/#
root@OpenWrt:/#
root@OpenWrt:/#
root@OpenWrt:/#
root@OpenWrt:/# ps -a
  PID USER       VSZ STAT COMMAND
    1 root      1396 S    init
    2 root         0 SW&lt;  [kthreadd]
    3 root         0 SW&lt;  [ksoftirqd/0]
    4 root         0 SW&lt;  [events/0]
    5 root         0 SW&lt;  [khelper]
   38 root         0 SW&lt;  [kblockd/0]
   61 root         0 SW   [pdflush]
   62 root         0 SW   [pdflush]
   63 root         0 SW&lt;  [kswapd0]
   64 root         0 SW&lt;  [aio/0]
   87 root         0 SW&lt;  [mtdblockd]
  178 root      1388 S    /bin/sh /etc/init.d/rcS S boot
  183 root      1388 S    logger -s -p 6 -t sysinit
  184 root      1408 R    /bin/ash --login
  195 root      1400 S    syslogd -C16
  197 root      1380 S    klogd
  209 root       916 S    /sbin/hotplug2 --override --persistent --set-worker /
  328 root      1396 S    udhcpc -t 0 -i eth1 -b -p /var/run/eth1.pid -R
  598 root      1384 S    /usr/sbin/httpd -p 80 -h /www -r OpenWrt
  602 root      1384 S    telnetd -l /bin/login.sh
  620 nobody     896 S    /usr/sbin/dnsmasq -K -D -y -Z -b -E -s lan -S /lan/ -
  627 root      1392 S    watchdog -t 5 /dev/watchdog
  649 root      1168 S    /usr/sbin/dropbear -p 22
  695 root      1388 R    ps -a
root@OpenWrt:/#</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p89895">
				<div class="post-metadata">
					<div class="post-num">Post #146</div>
					<div class="post-author">phorn</div>
					<div class="post-datetime">
						15 Jun 2009, 13:39					</div>
				</div>
				<div class="post-content content">
					<p>@robrob:<br />Port 4 on the routerboards is physically isolated and for all practical purposes is a standalone network port.&nbsp; That message comes from the generic autonegotiation code in drivers/net/phy.c. I don&#039;t think there is anything you can do about it, except comment out the pr_info line in that file.</p><p>The original version of icplus.c seemed to also call &quot;genphy_...&quot; for port 4, but maybe it disabled that autonegotiation somehow.&nbsp; You should also be able to get rid of it by turning the dmesg log level down, by setting some flag in /proc.</p><p>I would really only be concerned if the message was incorrect (if you plugged it into a host capable of 100/full, and it continued to print out &quot;10/half&quot;)</p><p>@jirka:<br />The bug report has not been included in OpenWRT SVN yet, so that would explain why you ran into trouble. You need to apply it yourself:<br /><a href="https://dev.openwrt.org/attachment/ticket/5193/ag71xx_phy.patch">https://dev.openwrt.org/attachment/tick … _phy.patch</a></p><p>Click to download in Original Format, and then apply it with &quot;patch -p0 &lt; ag71xx_phy.patch&quot; from your kamikaze trunk.</p><p>You will also have to run:<br /></p><div class="codebox"><pre><code>TOPDIR=$PWD make -C target/linux clean</code></pre></div><p>*after* applying the patches, in order to ensure that the extracted kernel tree is re-extracted. Just running &quot;make&quot; without cleaning will lead you to the same problem robrob had.</p><p>I will try to pester the openwrt channel and maybe send an email to the dev list. These patches are relatively simple so they should be included without much trouble.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p89900">
				<div class="post-metadata">
					<div class="post-num">Post #147</div>
					<div class="post-author">jirka</div>
					<div class="post-datetime">
						15 Jun 2009, 14:57					</div>
				</div>
				<div class="post-content content">
					<p>Ok, i will ignore the message:<br />swconfig dev eth0 help ... -&gt; Failed to connect to the switch</p><p>But, I have tried to setup interfaces separetly not in bridge. ETH0 is ok. I used script in this thread /etc/config/network ... and&nbsp; ETH1.2,ETH1.3,ETH1.4 and ETH1.5 are wrong. I have tried &quot;ping -I from this interfaces&quot; and &quot;ping from the PC to&quot;. There was not response.<br />I have watched some packes on eth1 ... tcpdump -i eth1.</p><p>I would like to know If i can compile some revision of openwrt for RB450 whitch supporting ethx interfaces separetly. Now I&#039;m trying Revision 15328.</p><p>Thanks for help<br />Jirka</p><br /><div class="quotebox"><cite>phorn wrote:</cite><blockquote><p>@robrob:<br />Port 4 on the routerboards is physically isolated and for all practical purposes is a standalone network port.&nbsp; That message comes from the generic autonegotiation code in drivers/net/phy.c. I don&#039;t think there is anything you can do about it, except comment out the pr_info line in that file.</p><p>The original version of icplus.c seemed to also call &quot;genphy_...&quot; for port 4, but maybe it disabled that autonegotiation somehow.&nbsp; You should also be able to get rid of it by turning the dmesg log level down, by setting some flag in /proc.</p><p>I would really only be concerned if the message was incorrect (if you plugged it into a host capable of 100/full, and it continued to print out &quot;10/half&quot;)</p><p>@jirka:<br />The bug report has not been included in OpenWRT SVN yet, so that would explain why you ran into trouble. You need to apply it yourself:<br /><a href="https://dev.openwrt.org/attachment/ticket/5193/ag71xx_phy.patch">https://dev.openwrt.org/attachment/tick … _phy.patch</a></p><p>Click to download in Original Format, and then apply it with &quot;patch -p0 &lt; ag71xx_phy.patch&quot; from your kamikaze trunk.</p><p>You will also have to run:<br /></p><div class="codebox"><pre><code>TOPDIR=$PWD make -C target/linux clean</code></pre></div><p>*after* applying the patches, in order to ensure that the extracted kernel tree is re-extracted. Just running &quot;make&quot; without cleaning will lead you to the same problem robrob had.</p><p>I will try to pester the openwrt channel and maybe send an email to the dev list. These patches are relatively simple so they should be included without much trouble.</p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p89907">
				<div class="post-metadata">
					<div class="post-num">Post #148</div>
					<div class="post-author">mtadeu</div>
					<div class="post-datetime">
						15 Jun 2009, 15:59					</div>
				</div>
				<div class="post-content content">
					<p>@jirka: IP175C is conected to eth1<br />use: swconfig dev eth1 help</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p89908">
				<div class="post-metadata">
					<div class="post-num">Post #149</div>
					<div class="post-author">jirka</div>
					<div class="post-datetime">
						15 Jun 2009, 16:07					</div>
				</div>
				<div class="post-content content">
					<p>It is the same message.</p><p>root@OpenWrt:/# swconfig dev eth0 help<br />Failed to connect to the switch<br />root@OpenWrt:/# swconfig dev eth1 help<br />Failed to connect to the switch</p><p>I think eth0 is for RB450. Eth1 is for RB493.</p><p>Jirka</p><div class="quotebox"><cite>mtadeu wrote:</cite><blockquote><p>@jirka: IP175C is conected to eth1<br />use: swconfig dev eth1 help</p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p89911">
				<div class="post-metadata">
					<div class="post-num">Post #150</div>
					<div class="post-author">robrob</div>
					<div class="post-datetime">
						15 Jun 2009, 16:40					</div>
				</div>
				<div class="post-content content">
					<p>jirka,</p><p>Without the patch phorn linked to above none of the switch ethernet ports will work. eth0 is the WAN port, eth1 is the switch. Apply the patch, run the above clean command, compile and it should work.</p>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 6 of 9</div><nav><ul><li><a href="viewtopic.php%3Fid=17501&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=17501&amp;p=4.html">4</a></li><li><a href="viewtopic.php%3Fid=17501&amp;p=5.html">5</a></li><li class="pagination-current"><span>6</span></li><li><a href="viewtopic.php%3Fid=17501&amp;p=7.html">7</a></li><li><a href="viewtopic.php%3Fid=17501&amp;p=8.html">8</a></li><li><a href="viewtopic.php%3Fid=17501&amp;p=9.html">9</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>