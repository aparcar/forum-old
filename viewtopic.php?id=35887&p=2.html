<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Custom x86 Image (NO LONGER MAINTAINED)</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 6 Sep 2015 and 6 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 2 of 17</div><nav><ul><li><a href="viewtopic.php%3Fid=35887&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li><li><a href="viewtopic.php%3Fid=35887&amp;p=3.html">3</a></li><li><a href="viewtopic.php%3Fid=35887&amp;p=4.html">4</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=35887&amp;p=17.html">17</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p170209">
				<div class="post-metadata">
					<div class="post-num">Post #26</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						18 Jun 2012, 03:38					</div>
				</div>
				<div class="post-content content">
					<p>I agree that is really odd. I&#039;ll make a note to look into why.</p><p>I&#039;m using a uuid with btrfs currently so I&#039;d expect it to have worked.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p172203">
				<div class="post-metadata">
					<div class="post-num">Post #27</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						13 Jul 2012, 17:19					</div>
				</div>
				<div class="post-content content">
					<p>@Alex<br/>Sorry for the delay: my response to your other 2 points was in a text file on my development machine which died.</p><p>I had an auto-mount problem and I believe it was addressed by editing /etc/config/fstab.</p><p>I noticed the same thing with the wi-fi radios on the current build.&nbsp; I think it is related to a kernel option I enabled, but I don&#039;t know which one exactly.&nbsp; I was working on why this happened when I suffered some hardware failures.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p172205">
				<div class="post-metadata">
					<div class="post-num">Post #28</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						13 Jul 2012, 17:19					</div>
				</div>
				<div class="post-content content">
					<p>It&#039;s been awhile since I surfaced with an update and I feel I owe those interested in this build an update on the state of things.</p><p>In late June I had my primary development environment die on me along with a number of components in my storage server.&nbsp; My development machine was setup to use the server for storage purposes so this was something of a two for one special of suck.&nbsp; I have spent the last 2-3 weeks working on getting my build environment back online along with everything else that was affected by my hardware failures.</p><p>The new hardware has been stable for a few days now and I am working on getting my first post-failure build done.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p172395">
				<div class="post-metadata">
					<div class="post-num">Post #29</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						16 Jul 2012, 03:52					</div>
				</div>
				<div class="post-content content">
					<p>Good to hear you are still working on it as I still may end up using it.</p><p>Been using Fedora 17 on my box for a while and it seems I still can&#039;t get everything to work right.&nbsp; Its crazy but Samba is refusing to work for me, seriously WTF.</p><p>Its also notable that the only distro that allows me to setup an AP on 5Ghz is your build of OpenWRT.&nbsp; I can only assume there is some patch in there bypassing the annoying issue of the WiFi card being set as the WORLD domain.</p><p>At this point though I am still waiting for my ISP to switch me to PPPoE and 100Mbit VDSL, that is the point where I will know if my router can handle it or not.</p><p>I&#039;m starting to wish I had just bought a Buffalo WZR-HP-AG300H though, I did not expect to have so many problems getting a distro to work properly.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p173372">
				<div class="post-metadata">
					<div class="post-num">Post #30</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						27 Jul 2012, 02:50					</div>
				</div>
				<div class="post-content content">
					<p>I managed to get an updated build complete this evening.&nbsp; I am working on getting it published to my web hosting right now.&nbsp; I&#039;ll post back in the next few hours when the publish is complete.&nbsp; Build is for svn revision r32878.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p173380">
				<div class="post-metadata">
					<div class="post-num">Post #31</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						27 Jul 2012, 06:13					</div>
				</div>
				<div class="post-content content">
					<p>New build and image are online at: <a href="https://nusku.net/openwrt/r32878/">https://nusku.net/openwrt/r32878/</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p174228">
				<div class="post-metadata">
					<div class="post-num">Post #32</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						7 Aug 2012, 03:30					</div>
				</div>
				<div class="post-content content">
					<p>I was uploading a new build this afternoon and took out my web-hosts storage.&nbsp; I am in the process of recovering and getting the new image online.&nbsp; I will report back with my progress in the OP of this thread.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p175156">
				<div class="post-metadata">
					<div class="post-num">Post #33</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						17 Aug 2012, 18:43					</div>
				</div>
				<div class="post-content content">
					<p>Builds are back online at <a href="https://nusku.net/openwrt">https://nusku.net/openwrt</a>&nbsp; Sorry for any problems this may have caused the community.</p>											<p class="post-edited">(Last edited by <strong>mcrosson</strong> on 17 Aug 2012, 18:44)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p175664">
				<div class="post-metadata">
					<div class="post-num">Post #34</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						24 Aug 2012, 03:24					</div>
				</div>
				<div class="post-content content">
					<p>Did you ever get the chance to try adding back IMQ support in the kernel?</p><p>I found out my router isn&#039;t handling my new 70Mbit broadband properly even with QoS off.&nbsp; So I am currently using Fedora 17 on my Atom which I will trade for your build if you get QoS working.</p><p>So no pressure then. :-p</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p175710">
				<div class="post-metadata">
					<div class="post-num">Post #35</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						24 Aug 2012, 16:07					</div>
				</div>
				<div class="post-content content">
					<p>I have not looked closely at the IMQ patches.&nbsp; It looks like I&#039;ll need to create a customized kernel patch and patch the iptables package.&nbsp; I do have it on my to do list.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p175728">
				<div class="post-metadata">
					<div class="post-num">Post #36</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						24 Aug 2012, 21:06					</div>
				</div>
				<div class="post-content content">
					<p>I wonder what the reasoning is for NOT including it pre-patches in the source when it IS included in the firmware releases?</p><p>That is one thing that threw me about your version, even the web UI is slightly different to the router firmware version.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p175729">
				<div class="post-metadata">
					<div class="post-num">Post #37</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						24 Aug 2012, 21:13					</div>
				</div>
				<div class="post-content content">
					<p>They changed out the kernel version in the trunk of the repo.&nbsp; Probably why the IMQ patches haven&#039;t made it in yet.</p><p>The webui may be different due to the luci sources being updated.</p><p>I am working off trunk and the latest from the pre-configured feeds.&nbsp; Most of the stuff in my build is slightly different than the release due to version bumps and the like.</p><br/><p>I did take a little bit of a closer look at bringing in the IMQ patches and it should be do-able but there is a bit of work I will need to do in order to make sure the patches get applied correctly.&nbsp; I also need to be sure I drop the IMQ patches in the right locations.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p175730">
				<div class="post-metadata">
					<div class="post-num">Post #38</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						24 Aug 2012, 21:49					</div>
				</div>
				<div class="post-content content">
					<p>Thanks, its much appreciated.</p><p>You might even consider using QoS yourself as it really makes WORLDS of difference to usability, I hate not having it enabled now as I have to be so careful when downloading to avoid lagging the whole network.&nbsp; </p><p>I remember back when I was still on 5Mbit it allowed me to download from Usenet while streaming the 1080p Microsoft E3 presentation.&nbsp; The Usenet download was literally throttled down to a few Kbytes but it did its job perfectly as there was no buffering whatsoever of the video stream and once its was done the download bumped back up to full speed.&nbsp; </p><p>Even when I went to 40Mbit I was using to to watch Netflix while downloading off Usenet, its just darn useful to get the most out of your connection as otherwise you have to guess how much to limit your download which can be completely wrong if other people in the house are using the connection too.</p><p>Incidentally the way I had it configured:</p><p>Priority: ICMP, DNS<br/>Express: HTTPS, SSH<br/>Normal: HTTP<br/>Bulk/Low: FTP, NNTP</p><p>I have no idea if this is optimal but it seemed to work well.&nbsp; Also, https might need lowering over time as more sites use it as standard but for now it was a good compromise as most downloads still go over standard http so it means important sites like ebay or online banking get a higher priority than downloads, but normal http downloads still get higher than FTP or NNTP.&nbsp; I suspect that Netflix goes over https so gets a good priority, even if it doesn&#039;t it would fall into Normal priority and so higher than NNTP.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p175731">
				<div class="post-metadata">
					<div class="post-num">Post #39</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						24 Aug 2012, 21:52					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Alex Atkin UK wrote:</cite><blockquote><p>Thanks, its much appreciated.</p><p>You might even consider using QoS yourself as it really makes WORLDS of difference to usability, I hate not having it enabled now as I have to be so careful when downloading to avoid lagging the whole network.</p></blockquote></div><p>I have already setup the basic layer 7 QoS stuff that is present in the build <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile"/>&nbsp; I&#039;ve just never used the IMQ / ingress stuff before.</p><br/><p>Edit (IMQ): Just found where I needed to drop the kernel patches and the necessary bits are showing in menuconfig.&nbsp; I also think I found where to apply the iptables patches.&nbsp; Going to run a test build shortly.</p>											<p class="post-edited">(Last edited by <strong>mcrosson</strong> on 24 Aug 2012, 21:56)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p175732">
				<div class="post-metadata">
					<div class="post-num">Post #40</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						24 Aug 2012, 22:00					</div>
				</div>
				<div class="post-content content">
					<p>Ooooh exciting, it better bloody compile now. :-p</p><p>I will be honest, I have no idea how the normal QoS stuff works.</p><p>All I ever did was install the QoS package which has a dependency on mod-IMQ.&nbsp; I also tried replicating the iptables rules on a standard Linux distro and it complained of missing functionality in iptables, again implying it was using the IMQ patches.</p><p>Initially I was using the QoS on DD-WRT which seems very closely related to the QoS on OpenWRT.</p><p>Another interesting thing I have noticed though, routing 70Mbit on the Atom uses almost an entire core when maxed out since my ISP switched to PPPoE.&nbsp; I really hope that means there is enough headroom for QoS.&nbsp; Although I am fortunate, my ISP said they can switch me back to a VLAN if I REALLY need it as one of the things that convinced me to join them was the fact they weren&#039;t using PPPoE.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p175733">
				<div class="post-metadata">
					<div class="post-num">Post #41</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						24 Aug 2012, 22:21					</div>
				</div>
				<div class="post-content content">
					<p>Full till 100Mbit should be ok on a dual core atom I&#039;d think, can you post back with success / failure once you get the IMQ stuff turned on?&nbsp; I&#039;m curiuos how well a dual core atom can really keep up.</p><p>On the build front: it&#039;s going... will be a few hours before I really know if the compile worked or not.&nbsp; After it&#039;s done with this round I plan to reset and re-build with an updated trunk.&nbsp; I&#039;ll be posting back once everything looks ok from my end.&nbsp; I&#039;ve not worked with IMQ before, so I&#039;ll need your help testing and validating it works as expected.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p175735">
				<div class="post-metadata">
					<div class="post-num">Post #42</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						24 Aug 2012, 22:30					</div>
				</div>
				<div class="post-content content">
					<p>Its pretty easy to prove if its working or not, at least it is with Usenet downloads.</p><p>Ensure you are maxing out your connection with traffic that is set to Bulk/Low priority.&nbsp; Then start a download using a protocol with a higher priority, you should see the lower priority download pretty much instantly reduce its speed.&nbsp; Then do the same with QoS off and you should see the behaviour is far less predictable, more than like the bulk download will retain a higher speed.</p><p>If I can ever figure out where I left the USB stick I had put OpenWRT on, I would try out the IMQ enabled build ASAP.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p175737">
				<div class="post-metadata">
					<div class="post-num">Post #43</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						24 Aug 2012, 23:09					</div>
				</div>
				<div class="post-content content">
					<p>@Alex</p><p>You will need to start fresh.&nbsp; The opkg stuff doesn&#039;t have an upgrade mechanism for built-in packages like the kernel.&nbsp; (I&#039;ve been meaning to write some kind of upgrade tool, but other things first <img src="https://forum.openwrt.org/img/smilies/tongue.png" width="15" height="15" alt="tongue"/>)</p><p>Edit: IMQ enabled build got far enough where I&#039;m confident my changes won&#039;t cause a bigger problem.&nbsp; I&#039;m resetting the environment, updating the sources and kicking off a fresh build now.&nbsp; I&#039;ll post back with status / download link once everything looks good on my end.</p>											<p class="post-edited">(Last edited by <strong>mcrosson</strong> on 24 Aug 2012, 23:30)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p175743">
				<div class="post-metadata">
					<div class="post-num">Post #44</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						25 Aug 2012, 01:32					</div>
				</div>
				<div class="post-content content">
					<p>Yeah but without it, I have nothing to copy it onto.</p><p>The rest of my sticks are 8GB and 16GB, a huge waste when it works fine on a cheapo 2GB.</p><p>Looking forward to trying this out.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p175746">
				<div class="post-metadata">
					<div class="post-num">Post #45</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						25 Aug 2012, 02:15					</div>
				</div>
				<div class="post-content content">
					<p>It just blew up compiling openssl.&nbsp; Hopefully it&#039;s a quick package fix.&nbsp; The IMQ stuff looked clean though on the last round so it&#039;s just a matter of finishing up the package builds and publishing.&nbsp; Unfortunately my outgoing connection is a little light so it&#039;ll take awhile to publish once complete.</p><p>I&#039;ll definitely be posting back once it&#039;s all online.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p175754">
				<div class="post-metadata">
					<div class="post-num">Post #46</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						25 Aug 2012, 06:27					</div>
				</div>
				<div class="post-content content">
					<p>@Alex: New build is up and hosted: <a href="https://nusku.net/openwrt/r33271/">https://nusku.net/openwrt/r33271/</a>&nbsp; -- This version includes the IMQ patches.</p><br/><p>There was a build issue that required me to turn off OpenSSL&#039;s threading support.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p175858">
				<div class="post-metadata">
					<div class="post-num">Post #47</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						27 Aug 2012, 02:38					</div>
				</div>
				<div class="post-content content">
					<p>Found out why the Buffalo was struggling, it was the traffic monitoring iptables rules that seem to vastly increase the load on the router, far more than the QoS does.&nbsp; </p><p>It handles my connection fine now even with QoS enabled as long as I remove those rules, although it still hits 100% load which makes me suspect there is some performance loss that is just not easily noticeable.&nbsp; No way a router hitting 100% load can possibly be working &quot;fine&quot; IMO.</p><p>So I will still be switching to the Atom as soon as I can as it handled the monitoring in Fedora 17, although even on that it seemed to use up 50% CPU (oddly pppd took up 33% even though it uses next to nothing on the Buffalo).&nbsp; </p><p>Not tested your build yet as I need to physically move my NAS box to do that.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p175861">
				<div class="post-metadata">
					<div class="post-num">Post #48</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						27 Aug 2012, 03:17					</div>
				</div>
				<div class="post-content content">
					<p>My current build has a bad root password... You&#039;ll need to reset it before your first boot.&nbsp; I&#039;m working on getting an updated build done but it will be awhile before i can get it uploaded.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176041">
				<div class="post-metadata">
					<div class="post-num">Post #49</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						28 Aug 2012, 10:41					</div>
				</div>
				<div class="post-content content">
					<p>Just tested your build and it was able to both setup a 5Ghz 802.11n network (which I cannot do on stock Linux distros as they do not let me switch the card into the GB region correctly) and its able to handle 100Mbit over that WiFi network.&nbsp; </p><p>That duplicate WiFi interface bug is darn annoying though, its now showing THREE WiFi interfaces in LuCI when I only have one WiFi card.&nbsp; Funny as it was only showing four on the old build when I had TWO WiFi cards.</p><p>Most importantly though, QoS isn&#039;t working.&nbsp; I can see its marking the traffic correctly in /proc/net/ip_conntrack but its not doing the actual QoS handling as its not throttling the traffic and I see nothing passing over the ifb0 device which I believe is where all marked traffic is sent in order to apply the QoS throttling.&nbsp; </p><p>It seems that its missing the PREROUTING iptables rules that route the traffic to the QoS interface.</p><p>Incidentally if you want to check if QoS is working yourself then its easy enough.&nbsp; Set the downstream and upstream values much lower than your real internet connection then do a speedtest.&nbsp; It should throttle your connection as if your Internet is the speed of the settings on the QoS page.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176057">
				<div class="post-metadata">
					<div class="post-num">Post #50</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						28 Aug 2012, 12:06					</div>
				</div>
				<div class="post-content content">
					<p>Did you fiddle with the mac address in /etc/config/wireless? Thats usually the reason that causes OpenWrt to duplicate the wifi definitions.</p>									</div>
			</article>

			
		
						<div class="notice">
				<p>Sorry, posts 51 to 50 are missing from our archive.</p>
			</div>
		
		
	
	<div class="pagination"><div class="pagination-number">Page 2 of 17</div><nav><ul><li><a href="viewtopic.php%3Fid=35887&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li><li><a href="viewtopic.php%3Fid=35887&amp;p=3.html">3</a></li><li><a href="viewtopic.php%3Fid=35887&amp;p=4.html">4</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=35887&amp;p=17.html">17</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>