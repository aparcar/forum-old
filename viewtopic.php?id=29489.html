<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> openVPN Can&#039;t connect clients</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 4 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p132726">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">tomi513</div>
					<div class="post-datetime">
						11 Apr 2011, 20:45					</div>
				</div>
				<div class="post-content content">
					<p>Hello.<br />I installed the openvpn and I wanted to connect as a client to the server openvpn<br />I can not ping server after openvpn or 172.16.0.1<br />Please help me!!</p><p>my setup</p><p>root@1043dn:~$ cat /etc/openvpn/my-vpn.conf<br />client<br />dev tun<br />proto tcp<br />remote 195.117.191.20 1194</p><p>resolv-retry infinite<br />nobind<br />persist-key<br />persist-tun<br />ca /etc/openvpn/ca.crt</p><p>cert&nbsp; /etc/openvpn/user03.crt<br />key&nbsp; /etc/openvpn/user03.key<br />comp-lzo<br />verb 3</p><br /><p>what gets in logread<br />logread<br />Apr 11 19:40:00 1043dn daemon.notice openvpn(custom_config)[4422]: OpenVPN 2.1.4 mips-openwrt-linux [SSL] [LZO2] [EPOLL] built on Apr&nbsp; 5 2011<br />Apr 11 19:40:00 1043dn daemon.warn openvpn(custom_config)[4422]: WARNING: No server certificate verification method has been enabled.&nbsp; See <a href="http://openvpn.net/howto.html#mitm">http://openvpn.net/howto.html#mitm</a> for more info.<br />Apr 11 19:40:00 1043dn daemon.warn openvpn(custom_config)[4422]: NOTE: OpenVPN 2.1 requires &#039;--script-security 2&#039; or higher to call user-defined scripts or executables<br />Apr 11 19:40:00 1043dn daemon.warn openvpn(custom_config)[4422]: WARNING: file &#039;/etc/openvpn/user03.key&#039; is group or others accessible<br />Apr 11 19:40:00 1043dn daemon.notice openvpn(custom_config)[4422]: LZO compression initialized<br />Apr 11 19:40:00 1043dn daemon.notice openvpn(custom_config)[4422]: Control Channel MTU parms [ L:1544 D:140 EF:40 EB:0 ET:0 EL:0 ]<br />Apr 11 19:40:00 1043dn daemon.notice openvpn(custom_config)[4422]: Socket Buffers: R=[87380-&gt;131072] S=[16384-&gt;131072]<br />Apr 11 19:40:00 1043dn daemon.notice openvpn(custom_config)[4422]: Data Channel MTU parms [ L:1544 D:1450 EF:44 EB:135 ET:0 EL:0 AF:3/1 ]<br />Apr 11 19:40:00 1043dn daemon.notice openvpn(custom_config)[4422]: Attempting to establish TCP connection with 195.117.191.20:1194 [nonblock]<br />Apr 11 19:40:01 1043dn daemon.notice openvpn(custom_config)[4422]: TCP connection established with 195.117.191.20:1194<br />Apr 11 19:40:01 1043dn daemon.notice openvpn(custom_config)[4422]: TCPv4_CLIENT link local: [undef]<br />Apr 11 19:40:01 1043dn daemon.notice openvpn(custom_config)[4422]: TCPv4_CLIENT link remote: 195.117.191.20:1194<br />Apr 11 19:40:01 1043dn daemon.notice openvpn(custom_config)[4422]: TLS: Initial packet from 195.117.191.20:1194, sid=f6fda0e8 e1e7eede<br />Apr 11 19:40:01 1043dn cron.info crond[2761]: crond: USER root pid 4424 cmd if ! pidof oscam &gt; /dev/null; then /etc/init.d/oscam start; fi<br />Apr 11 19:40:01 1043dn cron.info crond[2761]: crond: USER root pid 4425 cmd /etc/init.d/temp<br />Apr 11 19:40:04 1043dn daemon.notice openvpn(custom_config)[4422]: VERIFY OK: depth=1, /C=PL/ST=Podkarpackie/L=Brzezowka/O=ADVX/CN=advx-vpn-server/emailAddress=zosselp@gmail.com<br />Apr 11 19:40:04 1043dn daemon.notice openvpn(custom_config)[4422]: VERIFY OK: depth=0, /C=PL/ST=Podkarpackie/L=Brzezowka/O=ADVX/CN=vpn-server/emailAddress=zosselp@gmail.com<br />Apr 11 19:40:09 1043dn daemon.notice openvpn(custom_config)[4422]: Data Channel Encrypt: Cipher &#039;BF-CBC&#039; initialized with 128 bit key<br />Apr 11 19:40:09 1043dn daemon.notice openvpn(custom_config)[4422]: Data Channel Encrypt: Using 160 bit message hash &#039;SHA1&#039; for HMAC authentication<br />Apr 11 19:40:09 1043dn daemon.notice openvpn(custom_config)[4422]: Data Channel Decrypt: Cipher &#039;BF-CBC&#039; initialized with 128 bit key<br />Apr 11 19:40:09 1043dn daemon.notice openvpn(custom_config)[4422]: Data Channel Decrypt: Using 160 bit message hash &#039;SHA1&#039; for HMAC authentication<br />Apr 11 19:40:09 1043dn daemon.notice openvpn(custom_config)[4422]: Control Channel: TLSv1, cipher TLSv1/SSLv3 DHE-RSA-AES256-SHA, 1024 bit RSA<br />Apr 11 19:40:09 1043dn daemon.notice openvpn(custom_config)[4422]: [vpn-server] Peer Connection Initiated with 195.117.191.20:1194<br />Apr 11 19:40:11 1043dn daemon.notice openvpn(custom_config)[4422]: SENT CONTROL [vpn-server]: &#039;PUSH_REQUEST&#039; (status=1)<br />Apr 11 19:40:11 1043dn daemon.notice openvpn(custom_config)[4422]: PUSH: Received control message: &#039;PUSH_REPLY,route 172.16.0.0 255.255.255.0,topology net30,ping 10,ping-restart 120,ifconfig 172.16.0.14 172.16.0.13&#039;<br />Apr 11 19:40:11 1043dn daemon.notice openvpn(custom_config)[4422]: OPTIONS IMPORT: timers and/or timeouts modified<br />Apr 11 19:40:11 1043dn daemon.notice openvpn(custom_config)[4422]: OPTIONS IMPORT: --ifconfig/up options modified<br />Apr 11 19:40:11 1043dn daemon.notice openvpn(custom_config)[4422]: OPTIONS IMPORT: route options modified<br />Apr 11 19:40:11 1043dn daemon.notice openvpn(custom_config)[4422]: TUN/TAP device tun0 opened<br />Apr 11 19:40:11 1043dn daemon.notice openvpn(custom_config)[4422]: TUN/TAP TX queue length set to 100<br />Apr 11 19:40:11 1043dn daemon.notice openvpn(custom_config)[4422]: /sbin/ifconfig tun0 172.16.0.14 pointopoint 172.16.0.13 mtu 1500<br />Apr 11 19:40:11 1043dn daemon.notice openvpn(custom_config)[4422]: /sbin/route add -net 172.16.0.0 netmask 255.255.255.0 gw 172.16.0.13<br />Apr 11 19:40:11 1043dn daemon.notice openvpn(custom_config)[4422]: Initialization Sequence Completed</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p132730">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">cptdondo</div>
					<div class="post-datetime">
						11 Apr 2011, 21:30					</div>
				</div>
				<div class="post-content content">
					<p>Can you ping the gateway?&nbsp; This is usually due to routing tables. Make sure the routing tables on both ends make sense.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p132732">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">tomi513</div>
					<div class="post-datetime">
						11 Apr 2011, 21:45					</div>
				</div>
				<div class="post-content content">
					<p>yes, I can&#039;t ping gatwey.&nbsp; <br />I can connect to the server with openvpn on windows and I can ping, but as the link with openwrt as clinet can not ping the server with openvpn. It seems to me that you need to add a route. But how?<br />My routing on openwrt.<br />Kernel IP routing table<br />Destination&nbsp; &nbsp; &nbsp;Gateway&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Genmask&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Flags Metric Ref&nbsp; &nbsp; Use Iface<br />195.114.190.154 *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;255.255.255.255 UH&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; 0 pppoe-wan<br />172.16.0.13&nbsp; &nbsp; &nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;255.255.255.255 UH&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; 0 tun0<br />192.168.178.0&nbsp; &nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;255.255.255.0&nbsp; &nbsp;U&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; 0 br-lan<br />172.16.0.0&nbsp; &nbsp; &nbsp; 172.16.0.13&nbsp; &nbsp; &nbsp;255.255.255.0&nbsp; &nbsp;UG&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; 0 tun0<br />default&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Krakow-bras2.in 0.0.0.0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;UG&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; 0 pppoe-wan</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p132836">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">JaromirN</div>
					<div class="post-datetime">
						12 Apr 2011, 19:39					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>tomi513 wrote:</cite><blockquote><p>yes, I can&#039;t ping gatwey.&nbsp; <br />I can connect to the server with openvpn on windows and I can ping, but as the link with openwrt as clinet can not ping the server with openvpn. It seems to me that you need to add a route. But how?<br />My routing on openwrt.<br />Kernel IP routing table<br />Destination&nbsp; &nbsp; &nbsp;Gateway&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Genmask&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Flags Metric Ref&nbsp; &nbsp; Use Iface<br />195.114.190.154 *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;255.255.255.255 UH&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; 0 pppoe-wan<br />172.16.0.13&nbsp; &nbsp; &nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;255.255.255.255 UH&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; 0 tun0<br />192.168.178.0&nbsp; &nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;255.255.255.0&nbsp; &nbsp;U&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; 0 br-lan<br />172.16.0.0&nbsp; &nbsp; &nbsp; 172.16.0.13&nbsp; &nbsp; &nbsp;255.255.255.0&nbsp; &nbsp;UG&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; 0 tun0<br />default&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Krakow-bras2.in 0.0.0.0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;UG&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; 0 pppoe-wan</p></blockquote></div><p>Looking ok, check firewalls and server side</p><p>Inet:&nbsp; 172.16.0.14&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ping&nbsp; should be yes (sw. off local firewall before testing)<br />Dest: 172.16.0.1?&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if yes - should be pingable also - start here if not working (firstly switch off any firewalls <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /> )</p><p>BTW: better to use UDP instead of TCP..</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p132844">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">tomi513</div>
					<div class="post-datetime">
						12 Apr 2011, 21:40					</div>
				</div>
				<div class="post-content content">
					<p>How&nbsp; switch off any firewalls?? <br />I&#039;m using the latest version openwrt, and I have everything configured by default.<br />Secondly, I have a high CPU load on openwrt within 90%. A little weird.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p132907">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">JaromirN</div>
					<div class="post-datetime">
						13 Apr 2011, 15:04					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>tomi513 wrote:</cite><blockquote><p>How&nbsp; switch off any firewalls?? <br />I&#039;m using the latest version openwrt, and I have everything configured by default.<br />Secondly, I have a high CPU load on openwrt within 90%. A little weird.</p></blockquote></div><p>Firewall:<br />Sorry, i have no clue about your network design, which routers/firewalls/OS you are using between your client and server<br />Default OpenWRT iptables configuration is open. So no restriction here. </p><br /><p>90%?<br /> it is too much.. my experience - everything over 60% -&gt; watchdog has no chance to reset counter on time. - so still rebooting.<br />Also another apps will be bad working. Start fixing here.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>