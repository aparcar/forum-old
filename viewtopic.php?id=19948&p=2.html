<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> D-Link DIR-615 HW rev C1 USB</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 9 Apr 2018 and 30 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 2 of 5</div><nav><ul><li><a href="viewtopic.php%3Fid=19948&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li><li><a href="viewtopic.php%3Fid=19948&amp;p=3.html">3</a></li><li><a href="viewtopic.php%3Fid=19948&amp;p=4.html">4</a></li><li><a href="viewtopic.php%3Fid=19948&amp;p=5.html">5</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p118274">
				<div class="post-metadata">
					<div class="post-num">Post #26</div>
					<div class="post-author">LinkZ</div>
					<div class="post-datetime">
						1 Oct 2010, 19:59					</div>
				</div>
				<div class="post-content content">
					<p>Yes, the AR9130 does have onboard USB, so it is possible to add USB to this board.&nbsp; However, at this point I think the signal lines (to the USB placeholder on the PCB) aren&#039;t actually connected to the chip.&nbsp; This mod might not be feasible on this board, unless we can successfully trace the signal lines to the respective USB pinouts of the AR9130... or find another trace to the USB pinouts of the AR9130.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p118333">
				<div class="post-metadata">
					<div class="post-num">Post #27</div>
					<div class="post-author">regressor</div>
					<div class="post-datetime">
						2 Oct 2010, 14:03					</div>
				</div>
				<div class="post-content content">
					<p>Well... There is no ar9130 datasheet in public so we known nothing about ar9130 usb pins <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /> To trace signal lines someone should blow off processor from pcb of bricked dir-615 and look under it.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p118336">
				<div class="post-metadata">
					<div class="post-num">Post #28</div>
					<div class="post-author">regressor</div>
					<div class="post-datetime">
						2 Oct 2010, 16:20					</div>
				</div>
				<div class="post-content content">
					<p>More info:</p><p>Pull-down resistors 15K - soldered.</p><p>1. Booting without ethernet wires connected: D-=0, D+=0; inserting USB2 flashdrive: D-=0, D+=0; (no pull-up on d+! internal pull-down enabled ?)<br />2. Booting with ethernet wires connected: D-=3.3V, D+=0; (internal pull-up enabled?); inserting flash: (D-=3.3V, D+=0)</p><p>So:</p><p>1. USB datalines connected to AR9130<br />2. Looks like they connected to atheros GPIO pins (led pins ??) or USB pins works in GPIO mode.</p><br /><p>Is there any way to get specs for 9130 ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p119415">
				<div class="post-metadata">
					<div class="post-num">Post #29</div>
					<div class="post-author">ddwrt</div>
					<div class="post-datetime">
						20 Oct 2010, 20:34					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>regressor wrote:</cite><blockquote><p>More info:</p><p>Pull-down resistors 15K - soldered.</p><p>1. Booting without ethernet wires connected: D-=0, D+=0; inserting USB2 flashdrive: D-=0, D+=0; (no pull-up on d+! internal pull-down enabled ?)<br />2. Booting with ethernet wires connected: D-=3.3V, D+=0; (internal pull-up enabled?); inserting flash: (D-=3.3V, D+=0)</p><p>So:</p><p>1. USB datalines connected to AR9130<br />2. Looks like they connected to atheros GPIO pins (led pins ??) or USB pins works in GPIO mode.</p><br /><p>Is there any way to get specs for 9130 ?</p></blockquote></div><p>look at this - <a href="http://www.atheros.com/pt/bulletins/AR9001AP-3NGBulletin.pdf">http://www.atheros.com/pt/bulletins/AR9 … lletin.pdf</a></p><p>&quot;Interfaces:<br />- USB 2.0: host, device, OTG modes&quot;</p><p>I&#039;m interested too this topic <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p119442">
				<div class="post-metadata">
					<div class="post-num">Post #30</div>
					<div class="post-author">melodic</div>
					<div class="post-datetime">
						21 Oct 2010, 05:34					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>ddwrt wrote:</cite><blockquote><div class="quotebox"><cite>regressor wrote:</cite><blockquote><p>More info:</p><p>Pull-down resistors 15K - soldered.</p><p>1. Booting without ethernet wires connected: D-=0, D+=0; inserting USB2 flashdrive: D-=0, D+=0; (no pull-up on d+! internal pull-down enabled ?)<br />2. Booting with ethernet wires connected: D-=3.3V, D+=0; (internal pull-up enabled?); inserting flash: (D-=3.3V, D+=0)</p><p>So:</p><p>1. USB datalines connected to AR9130<br />2. Looks like they connected to atheros GPIO pins (led pins ??) or USB pins works in GPIO mode.</p><br /><p>Is there any way to get specs for 9130 ?</p></blockquote></div><p>look at this - <a href="http://www.atheros.com/pt/bulletins/AR9001AP-3NGBulletin.pdf">http://www.atheros.com/pt/bulletins/AR9 … lletin.pdf</a></p><p>&quot;Interfaces:<br />- USB 2.0: host, device, OTG modes&quot;</p><p>I&#039;m interested too this topic <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></blockquote></div><p>Look at the PCB. The board have USB!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p119485">
				<div class="post-metadata">
					<div class="post-num">Post #31</div>
					<div class="post-author">LinkZ</div>
					<div class="post-datetime">
						21 Oct 2010, 21:48					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>melodic wrote:</cite><blockquote><p>Look at the PCB. The board have USB!</p></blockquote></div><p>We were hoping it was that simple... but it is not.&nbsp; To my knowledge, no one has gotten USB to work on this board.</p>											<p class="post-edited">(Last edited by <strong>LinkZ</strong> on 21 Oct 2010, 21:49)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p119763">
				<div class="post-metadata">
					<div class="post-num">Post #32</div>
					<div class="post-author">regressor</div>
					<div class="post-datetime">
						26 Oct 2010, 15:57					</div>
				</div>
				<div class="post-content content">
					<p>The board have USB. But signal on its lines is not ok. This is may be:<br />1. pcb design problem - wrong processor pins connected (they connected!)<br />2. config problem - bootloader do some wrong configuration on start</p><p>Add: I bought tp-link wr941nd and got usb on it. The platform is almost same. <br />USB on 941nd require to solder USB_RREF (pull-down) resistor 4.7K near main cpu ar9132. <br />I&#039;ll try to find this resistor on dir-615 board.</p><p>Also wr941 usb require u-boot changes:</p><p>void ar7100_usb_initial_config(void)<br />{<br />&nbsp; &nbsp; ar7100_reg_wr_nf(AR7100_USB_PLL_CONFIG, 0x00001030);<br />}</p>											<p class="post-edited">(Last edited by <strong>regressor</strong> on 7 Jan 2011, 04:34)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p124733">
				<div class="post-metadata">
					<div class="post-num">Post #33</div>
					<div class="post-author">regressor</div>
					<div class="post-datetime">
						7 Jan 2011, 04:55					</div>
				</div>
				<div class="post-content content">
					<p>UP - New info added...<br />TODO: <br />1. Find RREF cpu resistor pads near cpu (it has +3V from cpu and ground connection)<br />2. Add usb pre-initialization code to openwrt</p><p>Pre-initialization code looks like this (code from u-boot and I don&#039;t know if this works in Openwrt):<br />#define KSEG1ADDR(a) (((a) &amp; 0x1fffffff) | KSEG1)<br />#define ar7100_reg_wr_nf(_phys, _val) ((*(volatile unsigned int *)KSEG1ADDR(_phys)) = (_val))<br />ar7100_reg_wr_nf(AR7100_USB_PLL_CONFIG, 0x00001030);</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125031">
				<div class="post-metadata">
					<div class="post-num">Post #34</div>
					<div class="post-author">regressor</div>
					<div class="post-datetime">
						10 Jan 2011, 10:09					</div>
				</div>
				<div class="post-content content">
					<p>Looks like RREF is a R11 at the bottom of the pcb. I soldered it (4.7K) and now D-/D+ is ok (0V after boot, D+=3v after connecting flashdrive).<br />Trying to solve usb PLL issue. The code above is for ar9132 <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125072">
				<div class="post-metadata">
					<div class="post-num">Post #35</div>
					<div class="post-author">LinkZ</div>
					<div class="post-datetime">
						10 Jan 2011, 18:52					</div>
				</div>
				<div class="post-content content">
					<p>Excellent.&nbsp; Glad you&#039;re working on this <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125074">
				<div class="post-metadata">
					<div class="post-num">Post #36</div>
					<div class="post-author">regressor</div>
					<div class="post-datetime">
						10 Jan 2011, 19:14					</div>
				</div>
				<div class="post-content content">
					<p>Partial success. I tried to init usb during openwrt load, but no success <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /> Then I tried to setup pll by hands at u-boot prompt:</p><p>AP81 (ar7100) U-boot<br />DRAM:&nbsp; AP81 initdram</p><p>sri:ddr_init<br />32 MB<br />Top of RAM usable for U-Boot at: 82000000<br />Reserving 177k for U-Boot at: 81fd0000<br />Reserving 192k for malloc() at: 81fa0000<br />Reserving 44 Bytes for Board Info at: 81f9ffd4<br />Reserving 36 Bytes for Global Data at: 81f9ffb0<br />Reserving 128k for boot params() at: 81f7ffb0<br />Stack Pointer at: 81f7ff98<br />Now running in RAM - U-Boot at: 81fd0000<br />ar7100 flash_init<br />id read 0x10000107<br />flash size 400000, sector count = 64<br />Flash:&nbsp; 4 MB<br />Using default environment</p><p>In:&nbsp; &nbsp; serial<br />Out:&nbsp; &nbsp;serial<br />Err:&nbsp; &nbsp;serial<br />Net:&nbsp; &nbsp;eth_initialize CONFIG_NET_MULTI<br />ag7100_enet_initialize<br />eth0: 00:18:e7:e3:98:72<br />ethernet found.<br />eth0<br />httpd start</p><p>hostaddr = 0xc0a8&nbsp; &nbsp;1<br />ar7100&gt; mw.l 0xb8050008 0x00001030<br />ar7100&gt; boot</p><p>And got here:<br />scsi 0:0:0:0: Direct-Access&nbsp; &nbsp; &nbsp;Kingston DT Mini 10&nbsp; &nbsp; &nbsp; &nbsp;1.00 PQ: 0 ANSI: 2<br />sd 0:0:0:0: [sda] 7822288 512-byte logical blocks: (4.00 GB/3.72 GiB)<br />sd 0:0:0:0: [sda] Write Protect is off<br />sd 0:0:0:0: [sda] Assuming drive cache: write through<br />sd 0:0:0:0: [sda] Assuming drive cache: write through<br /> sda: sda1 sda2<br />sd 0:0:0:0: [sda] Assuming drive cache: write through<br />sd 0:0:0:0: [sda] Attached SCSI removable disk</p><br /><p>Trying to make modded u-boot...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125153">
				<div class="post-metadata">
					<div class="post-num">Post #37</div>
					<div class="post-author">regressor</div>
					<div class="post-datetime">
						11 Jan 2011, 17:48					</div>
				</div>
				<div class="post-content content">
					<p>Ok. I did it. Again... <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p><strong>Part1: Software... (no need to flash u-boot - only Openwrt)</strong></p><p>1. Download svn source code<br />2. Edit file target/linux/ar71xx/files/arch/mips/ar71xx/mach-dir-615-c1.c<br />&nbsp; 2.1. Add line <span style="color: blue">#include &quot;dev-usb.h&quot;</span> after line <span style="color: blue">#include &quot;dev-leds-gpio.h&quot;</span><br />&nbsp; 2.2. Add line <span style="color: blue">ar71xx_add_device_usb();</span> [s]after line <span style="color: blue">ar71xx_add_device_eth(1);</span>[/s] before line <span style="color: blue">&quot;if (nvram_parse_mac_addr(....&quot;</span><br />3. Edit file target/linux/ar71xx/files/arch/mips/ar71xx/setup.c<br />&nbsp; 3.1 Add line <span style="color: blue">ar71xx_pll_wr(0x08, 0x00001030);</span> before line <span style="color: blue">ar71xx_detect_mem_size();</span><br />4. Run &#039;make menuconfig&#039; and select platform/profile and other options <br />(usb-core, usb-storage, usb2.0, block-extroot, etc - all what you want)<br />5. Compile image and flash it to router.</p><p><strong>Part 2. Hardware</strong></p><p>1. Solder usb socket (i soldered horisontal for testing but later i&#039;ll replace it with part of usb extender)<br />2. Solder usb power. My Dir-615C2 use 5V power source so I just solder a wire from power input to usb +5V line. But I think i&#039;ll install dc/dc 0505 isolator instead of this wire.<br />3. Solder two usb data line resitors (r237/r230 - 22 Ohms)</p><p><a href="http://www.radikal.ru"><span class="postimg"><img src="http://s007.radikal.ru/i302/1101/84/cac7bb371d58.jpg" alt="http://s007.radikal.ru/i302/1101/84/cac7bb371d58.jpg" /></span></a></p><p>3. Solder pull-down resistors at the bottom of the pcb. Use small 0603 smd 15k resistors (marked as &#039;153&#039;).</p><p><a href="http://www.radikal.ru"><span class="postimg"><img src="http://i019.radikal.ru/1101/4b/ee639981b015.jpg" alt="http://i019.radikal.ru/1101/4b/ee639981b015.jpg" /></span></a></p><p>4. Solder usb_rref 4,7Khoms resistor at the bottom of the pcb near ar9130 processor (look photo). I soldered 0805 size because didn&#039;t find 4k7 0603 size at home. If your solder skills not good - ask to solder this in any cellphone repair service (size of 0603 resistor - 1.6x0.8 mm)</p><p><a href="http://www.radikal.ru"><span class="postimg"><img src="http://s015.radikal.ru/i331/1101/33/595e44a91088.jpg" alt="http://s015.radikal.ru/i331/1101/33/595e44a91088.jpg" /></span></a></p><p>5. Solder serial header (you&#039;ll need it <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p><a href="http://www.radikal.ru"><span class="postimg"><img src="http://i003.radikal.ru/1101/66/e204df8339a6.jpg" alt="http://i003.radikal.ru/1101/66/e204df8339a6.jpg" /></span></a></p><p><strong>Now check pcb... Twice! Connect serial and power router on.......</strong><br />Wait until device boot and connect flashdrive. If you did all well you&#039;ll see at serial console:</p><p><a href="http://www.radikal.ru"><span class="postimg"><img src="http://i001.radikal.ru/1101/ee/67d38cbc514e.jpg" alt="http://i001.radikal.ru/1101/ee/67d38cbc514e.jpg" /></span></a></p><br /><p>Now time to make memory mod.... <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></p>											<p class="post-edited">(Last edited by <strong>regressor</strong> on 26 Feb 2011, 13:15)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125154">
				<div class="post-metadata">
					<div class="post-num">Post #38</div>
					<div class="post-author">LinkZ</div>
					<div class="post-datetime">
						11 Jan 2011, 17:58					</div>
				</div>
				<div class="post-content content">
					<p>Thanks regressor!&nbsp; You should add this to the wiki:<br /><a href="http://wiki.openwrt.org/toh/d-link/dir-615">http://wiki.openwrt.org/toh/d-link/dir-615</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125395">
				<div class="post-metadata">
					<div class="post-num">Post #39</div>
					<div class="post-author">siniy</div>
					<div class="post-datetime">
						14 Jan 2011, 11:13					</div>
				</div>
				<div class="post-content content">
					<p>regressor, you did an excellent job! Thanks a lot. I would never found out about usb_rref part.<br />Can you upload compiled openwrt image? I compiled it in the past and it took hours. Also to test and make sure there is no problem on software part.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125504">
				<div class="post-metadata">
					<div class="post-num">Post #40</div>
					<div class="post-author">regressor</div>
					<div class="post-datetime">
						15 Jan 2011, 05:51					</div>
				</div>
				<div class="post-content content">
					<p>Dir-615 in addition to usb also has 6 free GPIO pins!</p><p>gpio7&nbsp; -----&gt; led21 (last right unpopulated led 21 resistor)<br />gpio2&nbsp; -----&gt; r2&nbsp; &nbsp; (unpopulated resistor near cpu)<br />gpio0&nbsp; -----&gt; led12, r203&nbsp; (unpopulated led 12 resistor)<br />gpio8&nbsp; -----&gt; tp5&nbsp; &nbsp;(testpoint at the bottom of pcb near cpu)<br />gpio9&nbsp; -----&gt; tp6&nbsp; &nbsp;(testpoint at the bottom of pcb near cpu)<br />gpio11 -----&gt; tp7&nbsp; &nbsp;(testpoint at the bottom of pcb near cpu)</p><p><strong>siniy</strong>, i have image (it has preconfigured ip/gate/dns) but i have no idea how to upload it here.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125520">
				<div class="post-metadata">
					<div class="post-num">Post #41</div>
					<div class="post-author">siniy</div>
					<div class="post-datetime">
						15 Jan 2011, 12:08					</div>
				</div>
				<div class="post-content content">
					<p>You can upload it to <a href="http://sendspace.com">http://sendspace.com</a> and paste link here.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125521">
				<div class="post-metadata">
					<div class="post-num">Post #42</div>
					<div class="post-author">regressor</div>
					<div class="post-datetime">
						15 Jan 2011, 12:51					</div>
				</div>
				<div class="post-content content">
					<p>Here is the link: <a href="http://www.sendspace.com/file/81yy9d">http://www.sendspace.com/file/81yy9d</a><br />This is a dir-615c1-squashfs-factory image. Included: e2fsprog, ext2, usb, block-extroot<br />Default ip: 10.10.104.220</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125543">
				<div class="post-metadata">
					<div class="post-num">Post #43</div>
					<div class="post-author">s0ull</div>
					<div class="post-datetime">
						15 Jan 2011, 16:26					</div>
				</div>
				<div class="post-content content">
					<p>Great job, regressor! <br />Would it be working with DIR-615 rev. D4?</p>											<p class="post-edited">(Last edited by <strong>s0ull</strong> on 15 Jan 2011, 16:27)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125586">
				<div class="post-metadata">
					<div class="post-num">Post #44</div>
					<div class="post-author">regressor</div>
					<div class="post-datetime">
						16 Jan 2011, 04:36					</div>
				</div>
				<div class="post-content content">
					<p>No, D4 has different hardware...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125595">
				<div class="post-metadata">
					<div class="post-num">Post #45</div>
					<div class="post-author">tuckata</div>
					<div class="post-datetime">
						16 Jan 2011, 11:50					</div>
				</div>
				<div class="post-content content">
					<p>A great job, regressor!</p><p>I have a TP-LINK TL-WR941ND router and the same problem. I&#039;ve managed to bring it up and I successfully use it for some time now and the solution is exactly the same. I&#039;ve posted a kernel patch <a href="https://lists.openwrt.org/pipermail/openwrt-devel/2011-January/009141.html">https://lists.openwrt.org/pipermail/ope … 09141.html</a> which is the same as yours, with the only (minor) diffrence that I bring the PLL up in dev-usb.c, in the beginning of__init ar91xx_usb_setup(void).</p><p>cheers</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125598">
				<div class="post-metadata">
					<div class="post-num">Post #46</div>
					<div class="post-author">regressor</div>
					<div class="post-datetime">
						16 Jan 2011, 12:42					</div>
				</div>
				<div class="post-content content">
					<p>I tried to fire up PLL at usb setup, but it didn&#039;t work for unknown reason <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /> so I moved this code at the beginning of memory intialization.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125606">
				<div class="post-metadata">
					<div class="post-num">Post #47</div>
					<div class="post-author">tuckata</div>
					<div class="post-datetime">
						16 Jan 2011, 15:00					</div>
				</div>
				<div class="post-content content">
					<p>It works for me for several months now. Initially I&#039;ve put the USB PLL init between the ar71xx_device_stop(RESET_MODULE_USBSUS_OVERRIDE); and ar71xx_device_start(RESET_MODULE_USB_HOST); in the beginning of dev-usb.c&#039;s __init ar71xx_usb_setup(void). It seemed the logical place to put it but it didn&#039;t work. I don&#039;t know why - may be USB PLL init while the USB device is stopped doesn&#039;t take effect. So, next I moved the PLL init in the beginning of __init ar71xx_usb_setup(void), right before ar71xx_device_stop(RESET_MODULE_USBSUS_OVERRIDE); is called and it worked fine. I haven&#039;t tried it after ar71xx usb device start because all worked fine, but it may be even better since the USB device would be in a known state. I&#039;ve installed usb flash dive (extroot), external usb hdd (with samba share on it), usb sound card, bluetooth, printer, 3g dongle, and all works fine.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p126023">
				<div class="post-metadata">
					<div class="post-num">Post #48</div>
					<div class="post-author">housecall</div>
					<div class="post-datetime">
						20 Jan 2011, 16:07					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>regressor wrote:</cite><blockquote><p>Here is the link: <a href="http://www.sendspace.com/file/81yy9d">http://www.sendspace.com/file/81yy9d</a><br />This is a dir-615c1-squashfs-factory image. Included: e2fsprog, ext2, usb, block-extroot<br />Default ip: 10.10.104.220</p></blockquote></div><p>I have download it,Thanks for your sharing!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p126872">
				<div class="post-metadata">
					<div class="post-num">Post #49</div>
					<div class="post-author">regressor</div>
					<div class="post-datetime">
						30 Jan 2011, 13:47					</div>
				</div>
				<div class="post-content content">
					<p>Looks like usb mod impact a wan-lan perfomance badly (both: wr941nd and dir-615c2). I had 95Mbit before (torrent) and now have 15Mbit (top shows ~20% cpu load during test). LAN-PC iperf test shows 95Mbit and 50% cpu).</p><p>Is there any way to find a bottleneck ?</p><p>Add: Both wr941nd and dir-615c2 has bottleneck at wan interface. This looks like atheros ar91xx chip bug (tplink and dlink didn&#039;t soldered usb parts!)</p>											<p class="post-edited">(Last edited by <strong>regressor</strong> on 30 Jan 2011, 14:43)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p128122">
				<div class="post-metadata">
					<div class="post-num">Post #50</div>
					<div class="post-author">regressor</div>
					<div class="post-datetime">
						12 Feb 2011, 18:07					</div>
				</div>
				<div class="post-content content">
					<p><strong>Ok perfomance and stability problem solved</strong>. Now I have 11MB/sec LAN-WAN&nbsp; speed (55% cpu), 64MB of RAM and 4Gb flash drive. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>The&nbsp; <span style="color: blue">ar71xx_add_device_usb();</span> line at file target/linux/ar71xx/files/arch/mips/ar71xx/mach-dir-615-c1.c should be added at the beginning of the dir615c1_setup function: just before <span style="color: blue">&quot;if (nvram_parse_mac_addr(....&quot;</span> line.</p>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 2 of 5</div><nav><ul><li><a href="viewtopic.php%3Fid=19948&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li><li><a href="viewtopic.php%3Fid=19948&amp;p=3.html">3</a></li><li><a href="viewtopic.php%3Fid=19948&amp;p=4.html">4</a></li><li><a href="viewtopic.php%3Fid=19948&amp;p=5.html">5</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>