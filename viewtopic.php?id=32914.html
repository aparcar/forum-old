<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Is OpenWRT still vulnerable to DNS-rebind attacks?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 23 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p148246">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">F1aw</div>
					<div class="post-datetime">
						12 Nov 2011, 05:04					</div>
				</div>
				<div class="post-content content">
					<p>I am just curious if the issue of DNS rebind attacks is strictly the responsibility of the end-users, or OpenWRT can do something/has done something already to mitigate the risks of these attacks.</p><p>The issue came to my attention after searching for OpenWRT rebind attack. There are a number of articles on the web including one by <a href="http://www.forbes.com/sites/firewall/2010/07/13/millions-of-home-routers-vulnerable-to-web-hack/">Forbes</a> from 2010 claiming that OpenWRT and DD-WRT routers can be hacked using DNS rebinding. This claim was originally made by Craig Heffner who did a presentation at &quot;Black Hat&quot; <a href="https://www.blackhat.com/html/bh-us-10/bh-us-10-archives.html">security conference</a> in 2010. Here is a link to his <a href="https://media.blackhat.com/bh-us-10/whitepapers/Heffner/BlackHat-USA-2010-Heffner-How-to-Hack-Millions-of-Routers-wp.pdf">whitepaper</a> that does an excellent job of describing the details behind rebind attacks. He claims that Kamikaze r16206 is vulnerable to his approach.</p><p>My question - Has there been something done in OpenWRT trunk to address the issue, or is this solely the responsibility of the users to implement firewall rules blocking WAN ip? Page 32 of the whitepaper gives a list of possible solutions for users and firmware authors.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p148257">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						12 Nov 2011, 12:07					</div>
				</div>
				<div class="post-content content">
					<p>Yes it has various countermeasures. Dnsmasq has the rebind protection enbled, discarding RFC1918 responses by default, uhttpd rejects HTTP requests to public IP addresses from private IP addresses by default and LuCI has randomized tokens in the URL since pretty much forever.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p148336">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">F1aw</div>
					<div class="post-datetime">
						13 Nov 2011, 07:12					</div>
				</div>
				<div class="post-content content">
					<p>Thanks @jow, I am also running uhttpd on a non-standard port. This way it would be very unlikely anyone will be able to guess the user:pass@url:port combination. The fact that this attack is so trivial to carry out is scaring me, but OpenWRT seems to have enough countermeasures.</p><p>I still cannot understand why Craig Heffner decided to label OpenWRT as vulnerable if /etc/config/dhcp has the rebind_protection enabled. That claim could have generated too much negative publicity for OpenWRT.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p148642">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">janptak</div>
					<div class="post-datetime">
						15 Nov 2011, 07:54					</div>
				</div>
				<div class="post-content content">
					<p>Form Your post it seems Craig Heffner made this claim a year ago. Since then openWrt improved &amp; everybody forget about this claim so theres no negative impact anymore.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>