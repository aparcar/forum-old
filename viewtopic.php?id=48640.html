<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Slow network throughput with TP-Link TL-WDR4300</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 26 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p223759">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">dtgoof</div>
					<div class="post-datetime">
						25 Jan 2014, 23:27					</div>
				</div>
				<div class="post-content content">
					<p>I have a TP-Link TL-WDR4300 gigabit router with OpenWRT Barrier Breaker, which is connected over ethernet to my ISP. I&#039;m using a pretty standard setup with a local subnet and NAT, but have some speed problems.</p><p>If I connect my computer directly to the ISP and make some speed tests with an FTP server of my ISP (curl -o /dev/null ftp://ftp-server/bigfile) I get about 70 MB/s, however with the router in between I only get about 15.5 MB/s, which is rather slow in comparison.</p><p>I investigated further and run curl on the router itself, which also gave me only about 18 MB/s, so NAT is not the issue. Things get really bizzare when I measured the speed between the router and my computer with ncat and pv, where I only got 8-12 MB/s.</p><p>In all these cases the CPU load was 100%. But I have the feeling, that the router should handle all this with much higher throughput. Is there something obvious, which I could have misconfigured or what else might be the reason for this behavior?</p>											<p class="post-edited">(Last edited by <strong>dtgoof</strong> on 25 Jan 2014, 23:29)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p223841">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">dtgoof</div>
					<div class="post-datetime">
						27 Jan 2014, 00:09					</div>
				</div>
				<div class="post-content content">
					<p>As I have tested now, the original firmware does not have these issues and gives me decent speed. But this is not really a satisfying solution.</p><p>So again, does anyone have an idea of what I could try to improve the network speed?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p223844">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">zloop</div>
					<div class="post-datetime">
						27 Jan 2014, 01:04					</div>
				</div>
				<div class="post-content content">
					<p>OpenWrt does not work with Hardware NAT like the WDR4300 is using. <br />(There is no driver code from Atheros available/published)<br />Hardware NAT involves some hacks to &quot;normal&quot; networking (and it could break some protocols too)</p><p>see: <a href="https://dev.openwrt.org/ticket/11779">https://dev.openwrt.org/ticket/11779</a><br />for the &quot;normal&quot; transfer rates that are possible</p><div class="quotebox"><blockquote><p>It doesn&#039;t change the fact that the way this is implemented is completely messed up and requires lot of hacks all over the network stack. Until we find a clean way to implement this, I won&#039;t bother porting any of the code. =&gt; wontfix.</p></blockquote></div><p>The devs don&#039;t have enough time at their hands to add this feature - so you have to work on it yourself or find someone with the necessary skills and knowledge for this.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p223862">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">dtgoof</div>
					<div class="post-datetime">
						27 Jan 2014, 10:40					</div>
				</div>
				<div class="post-content content">
					<p>Thank you for your answer. I have now run a test with hardware NAT disabled in the web interface and the speed dropped down to 30 MB/s. So there is a remarkable difference, but this is still twice as fast with OpenWrt.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p223870">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						27 Jan 2014, 13:52					</div>
				</div>
				<div class="post-content content">
					<p><a href="https://forum.openwrt.org/viewtopic.php?id=45864">https://forum.openwrt.org/viewtopic.php?id=45864</a></p><p>same issue?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p223963">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">dtgoof</div>
					<div class="post-datetime">
						28 Jan 2014, 15:45					</div>
				</div>
				<div class="post-content content">
					<p>Indeed, with Attitute Adjustment I get about 30 MB/s, i.e. the same as with the original firmware, with hardware NAT disabled. I am fine with that for now, so I can continue to use OpenWrt. Thank you very much!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p224047">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">nozombian</div>
					<div class="post-datetime">
						29 Jan 2014, 16:00					</div>
				</div>
				<div class="post-content content">
					<p>I hope that some developer will have some time to investigate, why is barrier breaker that slow in comparison to AA. What scares me, that I remember AA being launched as stable, but it wasn&#039;t, terrible problems with atheros wifi on AA forced me to upgrade to BB. 250 mbit lines are quite common for a reasonable price in here and there&#039;s no other firmware with so many functions <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>Maybe the new IPv6 stuff is slowing the BB down?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>