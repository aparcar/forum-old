<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Support for Marvell 88F5xx81 based routers</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 18 Jan 2014 and 6 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 19 of 46</div><nav><ul><li><a href="viewtopic.php%3Fid=12358&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=12358&amp;p=17.html">17</a></li><li><a href="viewtopic.php%3Fid=12358&amp;p=18.html">18</a></li><li class="pagination-current"><span>19</span></li><li><a href="viewtopic.php%3Fid=12358&amp;p=20.html">20</a></li><li><a href="viewtopic.php%3Fid=12358&amp;p=21.html">21</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=12358&amp;p=46.html">46</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p93861">
				<div class="post-metadata">
					<div class="post-num">Post #451</div>
					<div class="post-author">maddes.b</div>
					<div class="post-datetime">
						8 Sep 2009, 17:50					</div>
				</div>
				<div class="post-content content">
					<p>To check if sysupgrade is available on your current installation, see if &quot;/lib/upgrade/platform.sh&quot; exists.</p><p>Square brackets mark optional parts of the command, here &quot;-v&quot; if you want verbose output, otherwise leave it out.</p><p>Do you really want to upgrade to the current/last snapshot of the OpenWrt team?<br />( <a href="http://downloads.openwrt.org/snapshots/trunk/orion/">http://downloads.openwrt.org/snapshots/trunk/orion/</a> openwrt-wrt350nv2-squashfs.img )<br />If so, then there is no combined flash image available officially yet.<br />Check out the other posts (e.g <a href="https://forum.openwrt.org/viewtopic.php?pid=89744#p89744">#341</a>) how to get the rootfs and create a combined flash image with it (uImage + padding + rootfs).</p>											<p class="post-edited">(Last edited by <strong>maddes.b</strong> on 8 Sep 2009, 17:57)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93862">
				<div class="post-metadata">
					<div class="post-num">Post #452</div>
					<div class="post-author">Watha</div>
					<div class="post-datetime">
						8 Sep 2009, 17:58					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>DaBigMac wrote:</cite><blockquote><p>Tried using sysupgrade, results as follows</p><div class="codebox"><pre><code>root@OpenWrt:/# sysupgrade [-v] http://downloads.openwrt.org/snapshots/trunk/ori
on/openwrt-wrt350nv2-squashfs.img
Firmware upgrade is not implemented for this platform.</code></pre></div><p>Did I do something wrong? I used the firmware posted on your ftp site..</p></blockquote></div><p>The sysupgrade stuff isn&#039;t upstream yet, so when you upgraded base-files you lost the ability to sysupgrade. You could try downgrading base-files.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93864">
				<div class="post-metadata">
					<div class="post-num">Post #453</div>
					<div class="post-author">dallienl</div>
					<div class="post-datetime">
						8 Sep 2009, 18:05					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve been watching this forum for a few months and would like to thank Maddes for the incredible work he has done. You must have put in a lot of time and effort.</p><p>I&#039;ve managed to make a RAM image from the tutorials in this thread as it was running fine so I flashed a image from the FTP <a href="ftp://ftp.maddes.net/openwrt/kamikaze/orion/build_17456/squashfs/NOT_FOR_NEWBIES_openwrt-wrt350nv2-squashfs-webupgrade.all_ipv6.img">ftp://ftp.maddes.net/openwrt/kamikaze/o … l_ipv6.img</a>&nbsp; &nbsp;&nbsp; everything is running perfect but OpenVPN crashes with &quot;Unable to handle kernel NULL pointer dereference at virtual address&quot; Am I the only one with this issue?</p><p>As I&#039;ve read in the thread <a href="http://forum.openwrt.org/viewtopic.php?id=20713">http://forum.openwrt.org/viewtopic.php?id=20713</a> I will create my own image with the kmod-tun precompiled. Will keep you posted.</p><p>Thanks and a big bow for Maddes.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93866">
				<div class="post-metadata">
					<div class="post-num">Post #454</div>
					<div class="post-author">maddes.b</div>
					<div class="post-datetime">
						8 Sep 2009, 18:10					</div>
				</div>
				<div class="post-content content">
					<p>The major tasks were done by Kaloz, DirkNL, StrikerNL and Lennert (kernel, drivers, initial webupgrade, etc.).<br />I&#039;m just trying to get the administrative tasks done (sysupgrade, webupgrade, etc.).</p><p>Note it&#039;s still beta (currently investigating the WLAN problems)<br />I&#039;m just an experienced user with some programming background.</p><p>@dallienl:<br />Was &quot;kmod-tun&quot; set to &quot;Y&quot; (included in uImage) or just normally set to &quot;M&quot; (separate module, must be installed)</p>											<p class="post-edited">(Last edited by <strong>maddes.b</strong> on 8 Sep 2009, 18:16)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93873">
				<div class="post-metadata">
					<div class="post-num">Post #455</div>
					<div class="post-author">DaBigMac</div>
					<div class="post-datetime">
						8 Sep 2009, 18:26					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>drizzt81 wrote:</cite><blockquote><p>Drizzt81&#039;s list of stupid things not to do:</p><p>1. running <em>opkg upgrade</em> semi-bricked my router (serial access still worked), but no network interfaces were available<br />... to be continued</p></blockquote></div><p>Never to be outdone in the performing of stupidity, I decided to see if I could reproduce drizzt&#039;s error. Suprise, suprise! I did.. with similar results..</p><p>I know what the problem is though, opkg detects new versions of the default, installed packages and downloads/installs them to the /root partition, which of course, quickly fills (a df in a 2nd session confirmed that the /root partition had reached 100%) and the upgrade hangs...</p><p>Perhaps maddes.b would be kind enough to create another image set with a /root partition size large enough to accommodate the installation of upgrades to the base system? Or perhaps that&#039;s unnecessary, can anyone suggest a workaround? The updates may not be so vital now, but it won&#039;t be long before newer packages require dependencies which cannot be met by the default modules.</p><p>Cheers,</p><p>DBM</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93874">
				<div class="post-metadata">
					<div class="post-num">Post #456</div>
					<div class="post-author">dallienl</div>
					<div class="post-datetime">
						8 Sep 2009, 18:29					</div>
				</div>
				<div class="post-content content">
					<p>Nope currently I&#039;m using the precompiled image from the FTP the kmon-tun is not included. Tomorrow will compile a new image with the kmod-tun and see if OpenVPN then runs.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93876">
				<div class="post-metadata">
					<div class="post-num">Post #457</div>
					<div class="post-author">Watha</div>
					<div class="post-datetime">
						8 Sep 2009, 18:33					</div>
				</div>
				<div class="post-content content">
					<p>/rom is 100% full on my un-upgraded system - it&#039;s a read-only squashfs filesystem. I&#039;m not totally familiar with sysupgrade, but I suspect it rewrites /rom with the new filesystem image. Using opkg to upgrade packages that are part of /root is less than ideal, as it duplicates the contents in /jffs, but it&#039;s not normally encountered when using proper releases as the package versions are stable.</p>											<p class="post-edited">(Last edited by <strong>Watha</strong> on 8 Sep 2009, 18:50)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93877">
				<div class="post-metadata">
					<div class="post-num">Post #458</div>
					<div class="post-author">maddes.b</div>
					<div class="post-datetime">
						8 Sep 2009, 18:38					</div>
				</div>
				<div class="post-content content">
					<p>If you want to restart with your current installation, just execute &quot;firstboot&quot;, then reboot.<br />All your configs will be gone, and it will be just as it was when you flashed it.</p><p>About the modules:<br />There is no workaround.<br />It&#039;s not stable, it is ongoing developement (trunk version = BETA and sometime ALPHA).<br />If your system is working with it, then do not upgrade, just wait for a stable release (hopefully somewhen).<br />If you need additional or newer modules (or kernel), then backup everything and reflash with the latest BETA.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93878">
				<div class="post-metadata">
					<div class="post-num">Post #459</div>
					<div class="post-author">maddes.b</div>
					<div class="post-datetime">
						8 Sep 2009, 18:41					</div>
				</div>
				<div class="post-content content">
					<p>@dallienl<br />Keep an eye on the log when installing OpenVPN: From what site is the module downloaded?</p><p>Otherwise install your own build module directly.<br />Reboot, do *not* call &quot;opkg update&quot;, copy your module to /tmp and install via &quot;opkg install /tmp/kmod....&quot;</p><p>P.S.:<br />Does NL at the end of your nick indicate the netherlands?</p>											<p class="post-edited">(Last edited by <strong>maddes.b</strong> on 8 Sep 2009, 18:41)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93880">
				<div class="post-metadata">
					<div class="post-num">Post #460</div>
					<div class="post-author">maddes.b</div>
					<div class="post-datetime">
						8 Sep 2009, 18:46					</div>
				</div>
				<div class="post-content content">
					<p>Watha is correct, /root (home dir of root user) or just / (root of filesystem) is always 100% full.<br />The base of the filesystem is a read-only squashfs, which is then overlayed by a read-writeable JFFS (see /jffs).</p><p>So if you change /etc/firewall.user, then you will find your version in /jffs/etc/firewall.user, while the original version is still in /rom/etc/firewall.user.<br />Deletion of a file results in a metafile inside /jffs/path/to/deleted/<br />That&#039;s why you can return to the initial state with firstboot.</p><p>To find out how much flash space is free use &quot;df /jffs&quot;</p>											<p class="post-edited">(Last edited by <strong>maddes.b</strong> on 8 Sep 2009, 18:48)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93883">
				<div class="post-metadata">
					<div class="post-num">Post #461</div>
					<div class="post-author">maddes.b</div>
					<div class="post-datetime">
						8 Sep 2009, 20:20					</div>
				</div>
				<div class="post-content content">
					<p>I switched back to r17264 and WLAN worked again, seems that something got brocken somewhere down the road.<br />Will try to narrow it done.</p><p><strong>Updating your WLAN/Wifi driver should fix this problem!!!</strong> (e.g. worked for me on Intel 3945ABG)</p><p>Worked: <a href="https://dev.openwrt.org/changeset/17264">r17264</a><br />Broken: <a href="https://dev.openwrt.org/changeset/17296">r17296</a>, <a href="https://dev.openwrt.org/changeset/17357">r17357</a>, <a href="https://dev.openwrt.org/changeset/17399">r17399</a></p><p>Created <a href="https://dev.openwrt.org/ticket/5815">defect ticket #5815</a> for this.</p><p>Rebuild r17264 with the most current sysupgrade and webupgrade patches, and posted it on my ftp space.<br />It is recommended to only use kernel modules from this repository and hold them.<br />After installing the kernel modules I holded all installed packages (will now continue and install the other packages)<br /></p><div class="codebox"><pre><code>opkg list_installed | cut -d &#039; &#039; -f 1 | xargs opkg flag hold ; # semicolon forces the necessary space at the end</code></pre></div>											<p class="post-edited">(Last edited by <strong>maddes.b</strong> on 10 Sep 2009, 22:53)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93890">
				<div class="post-metadata">
					<div class="post-num">Post #462</div>
					<div class="post-author">dallienl</div>
					<div class="post-datetime">
						8 Sep 2009, 21:45					</div>
				</div>
				<div class="post-content content">
					<p>Currently using the 17456 only problem with wireless was my Vista wouldn&#039;t connect. It was visible but not response. Using Windows 7 everything was okay, think it was an OS issue. Had to manually edit wireless file file though, using only webif no sugar, see config below. </p><div class="codebox"><pre><code>config &#039;wifi-device&#039; &#039;wlan0&#039;
    option &#039;type&#039; &#039;mac80211&#039;
    option &#039;country&#039; &#039;nl&#039;
    option &#039;hwmode&#039; &#039;11bg&#039;
    option &#039;channel&#039; &#039;05&#039;
    option &#039;maxassoc&#039; &#039;&#039;
    option &#039;distance&#039; &#039;10&#039;
    option &#039;diversity&#039; &#039;&#039;
    option &#039;txantenna&#039; &#039;&#039;
    option &#039;rxantenna&#039; &#039;&#039;
    option &#039;disabled&#039; &#039;0&#039;
    option &#039;antenna&#039; &#039;&#039;

config &#039;wifi-iface&#039;
    option &#039;device&#039; &#039;wlan0&#039;
    option &#039;network&#039; &#039;lan&#039;
    option &#039;mode&#039; &#039;ap&#039;
    option &#039;ssid&#039; &#039;XXXXXXX&#039;
    option &#039;bssid&#039; &#039;&#039;
    option &#039;encryption&#039; &#039;psk2&#039;
    option &#039;server&#039; &#039;&#039;
    option &#039;port&#039; &#039;&#039;
    option &#039;hidden&#039; &#039;0&#039;
    option &#039;isolate&#039; &#039;0&#039;
    option &#039;txpower&#039; &#039;&#039;
    option &#039;bgscan&#039; &#039;0&#039;
    option &#039;frag&#039; &#039;&#039;
    option &#039;rts&#039; &#039;&#039;
    option &#039;wds&#039; &#039;0&#039;
    option &#039;key&#039; &#039;XXXXXXXX&#039;
    option &#039;key1&#039; &#039;&#039;
    option &#039;key2&#039; &#039;&#039;
    option &#039;key3&#039; &#039;&#039;
    option &#039;key4&#039; &#039;root&#039;
    option &#039;80211h&#039; &#039;&#039;
    option &#039;compression&#039; &#039;&#039;
    option &#039;bursting&#039; &#039;&#039;
    option &#039;ff&#039; &#039;&#039;
    option &#039;wmm&#039; &#039;&#039;
    option &#039;xr&#039; &#039;&#039;
    option &#039;ar&#039; &#039;&#039;
    option &#039;turbo&#039; &#039;&#039;
    option &#039;macpolicy&#039; &#039;none&#039;
    option &#039;maclist&#039; &#039;&#039;</code></pre></div><p>Just finished compiling the new image including kmod-tun for the OpenVPN issue and flashed it. Will do some testing tomorrow.</p><p>If you need any assistance in alpha / beta testing I will be glad to help your effort. </p><p>Yes the NL stands for the Netherlands I&#039;m Dutch / German.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93892">
				<div class="post-metadata">
					<div class="post-num">Post #463</div>
					<div class="post-author">maddes.b</div>
					<div class="post-datetime">
						8 Sep 2009, 22:11					</div>
				</div>
				<div class="post-content content">
					<p>Just to make sure, you can connect via WLAN to the router when using Windows 7?<br />No cable connected to the computer, rebooted, then connected to WLAN?<br />But not when using Vista?</p><p>If that would be the case then it maybe fixed via router configuration.</p>											<p class="post-edited">(Last edited by <strong>maddes.b</strong> on 8 Sep 2009, 22:11)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93903">
				<div class="post-metadata">
					<div class="post-num">Post #464</div>
					<div class="post-author">operron</div>
					<div class="post-datetime">
						9 Sep 2009, 00:59					</div>
				</div>
				<div class="post-content content">
					<p>maddes, what are the WLAN issue you are talking about ?<br />I use your image (r17456) and have no issue with WLAN. I have also managed to get 11n working... well exception made of the 5 GHz band but I can use the HT40 capability.<br />Vista and Linux clients can connect seamlessly.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93906">
				<div class="post-metadata">
					<div class="post-num">Post #465</div>
					<div class="post-author">maddes.b</div>
					<div class="post-datetime">
						9 Sep 2009, 01:16					</div>
				</div>
				<div class="post-content content">
					<p>Hm, people reported that they have WLAN issues.<br />So I retested my WLAN again and also have connection issues.<br />I only need WLAN rarely, so I didn&#039;t noticed before.</p><p>Can you post your result of &quot;uci show wireless&quot; (remember to remove your keys).<br />Or better contact me per mail so we can check step by step what you installed and configured.</p>											<p class="post-edited">(Last edited by <strong>maddes.b</strong> on 9 Sep 2009, 01:17)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93908">
				<div class="post-metadata">
					<div class="post-num">Post #466</div>
					<div class="post-author">drizzt81</div>
					<div class="post-datetime">
						9 Sep 2009, 01:27					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>operron wrote:</cite><blockquote><p>maddes, what are the WLAN issue you are talking about ?<br />I use your image (r17456) and have no issue with WLAN. I have also managed to get 11n working... well exception made of the 5 GHz band but I can use the HT40 capability.<br />Vista and Linux clients can connect seamlessly.</p></blockquote></div><p>Quick detail on my WLAN Issue: I am using the router as an AP, i.e. the WAN port is not connected. I set up a WLAN and tried to connect from WinXP (Thinkpad T40, Intel WLAN afaik) and was unable to acquire an IP, which led my windows client to connect to the other WLAN, which is also in range.</p><p>Due to time constraints, I have not been able to debug this neatly and eliminate variables to pinpoint the issue just yet. More testing next week at the earliest.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93913">
				<div class="post-metadata">
					<div class="post-num">Post #467</div>
					<div class="post-author">falso</div>
					<div class="post-datetime">
						9 Sep 2009, 03:21					</div>
				</div>
				<div class="post-content content">
					<p>Hello ppl, </p><p>I bricked my router (wrt350n v2.1). i tried opkg upgrade... <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /><br />Power led and lan are still blinking, still no access via http, ssh or telnet. <br />How can i solve this? <br />Thanks</p>											<p class="post-edited">(Last edited by <strong>falso</strong> on 9 Sep 2009, 03:29)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93915">
				<div class="post-metadata">
					<div class="post-num">Post #468</div>
					<div class="post-author">Nilfred</div>
					<div class="post-datetime">
						9 Sep 2009, 05:08					</div>
				</div>
				<div class="post-content content">
					<p>opkg upgrade is <a href="https://forum.openwrt.org/viewtopic.php?pid=16350#p16350">listed on Common mistakes</a> Please read before posting.<br />Do reset button issue firstboot or only enter <a href="http://wiki.openwrt.org/oldwiki/openwrtdocs/troubleshooting#failsafe.mode">failsafe mode</a>?<br />Anyway, build a <a href="http://www.nslu2-linux.org/wiki/HowTo/AddASerialPort">serial cable</a>. It&#039;s worth to have one.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93918">
				<div class="post-metadata">
					<div class="post-num">Post #469</div>
					<div class="post-author">falso</div>
					<div class="post-datetime">
						9 Sep 2009, 06:19					</div>
				</div>
				<div class="post-content content">
					<p>I am trying to enter to failsafe but i cant. I dont know what i&#039;m doing wrong. <br />I am pushing reset two secs after power on but nothing happens incl. ping! <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /><br />What type of serial cable do i need? I haveWRTt350n v2.1!<br />Thanks.</p>											<p class="post-edited">(Last edited by <strong>falso</strong> on 9 Sep 2009, 06:40)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93920">
				<div class="post-metadata">
					<div class="post-num">Post #470</div>
					<div class="post-author">andrewm1973</div>
					<div class="post-datetime">
						9 Sep 2009, 07:49					</div>
				</div>
				<div class="post-content content">
					<p>Upgrading to 128M</p><p>The inital ground work was done by jdoering in this thread</p><p><a href="http://forum.dsmg600.info/viewtopic.php?id=2388&amp;p=1">http://forum.dsmg600.info/viewtopic.php?id=2388&amp;p=1</a></p><p>Kmper made a post in the WRT350Nv2/Marvell thread in the Open-WRT forum about his upgrade</p><p><a href="https://forum.openwrt.org/viewtopic.php?pid=78468#p78468">https://forum.openwrt.org/viewtopic.php … 468#p78468</a></p><p>However Kmpers patches did not work.</p><p>There is an error in Kmpers u-boot patches that will display 128M ok - but fail to work.</p><p>I suspect Kmper followed jdoering too closely to the letter and was looking for the pattern </p><p>10 60 A0 E3</p><p>however the WRT350N-V2 only comes with 32M RAM instead of the 64M standard on the Slug</p><p>This means the pattern he should have been looking for was </p><p>00 60 A0 E3</p><p>I initially followed Kmper to the letter, got the boot screens to show me 128M and then have my router fall over when using more than 32M of memory.&nbsp; This sent me off on a bit of a wild goose chase for bad soldering.</p><p>Using the MD command in u-boot I compared my registers on the 350n with DNS-323</p><div class="codebox"><pre><code>address   WRT350Nv2     DNS-323     Description                    WRT350Nv2-After-Kmper_patch

f1001400: 03148400      03148400    SDRAM_CONFIG_REG                03148400
          04041000      04041000    SDRAM_DUNIT_CTRL_REG            04041000
          11602220      11602220    SDRAM_TIMING_CTRL_LOW_REG       11602220
          0000040c      0000040c    SDRAM_TIMING_CTRL_HIGH_REG      0000040c
f1001410: 00000000      00000010    SDRAM_ADDR_CTRL_REG             00000000  &lt;&lt;WRONG
          00000000      00000000    SDRAM_OPEN_PAGE_CTRL_REG        00000000
          00000000      00000000    SDRAM_OPERATION_REG             00000000
          00000062      00000062    SDRAM_MODE_REG                  00000062
f1001420: 00000000      00000000    SDRAM_EXTENDED_MODE_REG         00000000
          00000000      00000000                                    00000000
          00063305      00063305                                    00063305
          00000000      00000000    SDRAM_OPERATION_CTRL_REG        00000000
          

f1001500: 00000000      00000000                                    00000000
          01ff0001      03ff0001    SDRAM_BANK0_SIZE                07ff0001
          10000000      10000000                                    10000000
          00000000      00000000                                    00000000
f1001510: 20000000      20000000                                    20000000
          00000000      00000000                                    00000000
          30000000      30000000                                    30000000
          00000000      00000000                                    00000000</code></pre></div><p>This shows two differences</p><p>SDRAM_ADDR_CTRL_REG is 00000000 on WRT350N and 00000010 on DNS-323<br />SDRAM_BANK0_SIZE&nbsp; &nbsp; is 01ff0001 on WRT350N and 03ff0001 on DNS-323</p><p>So Kmpers first patch of changing memory location 0x315f to 10 00 ff 07 is correct</p><p>However the second one is obv wrong as the WRT350 does not have 01 as the value in SDRAM_ADDR_CTRL_REG&nbsp; in the first place.&nbsp; The pattern 00 60 A0 E3 is also so common it will be dangerous to just trying random instances of that.</p><p>So search begins for corrent patch.</p><p>First up downloaded source codes from linksys GPL center</p><p><a href="http://www.linksysbycisco.com/gpl">http://www.linksysbycisco.com/gpl</a></p><p>And also download Dis-Arm by Christoph Gießelink</p><p><a href="http://hp.giesselink.com/pcuti.htm">http://hp.giesselink.com/pcuti.htm</a></p><p>Type the following at the linux shell prompt to get your MTD partition map</p><div class="codebox"><pre><code>&gt;cat /proc/mtd

dev:    size    erasesize name
mtd0: 00100000 00010000 &quot;kernel&quot;
mtd1: 00650000 00010000 &quot;rootfs&quot;
mtd2: 00510000 00010000 &quot;rootfs_data&quot;
mtd3: 00040000 00010000 &quot;lang&quot;
mtd4: 00020000 00010000 &quot;nvram&quot;
mtd5: 00040000 00010000 &quot;u-boot&quot;
mtd6: 00010000 00010000 &quot;eRcOmM_do_not_touch&quot;
mtd7: 00760000 00010000 &quot;image&quot;</code></pre></div><p>So in my case the u-boot is in mtd5 so I use the following command to save the image to my USB stick</p><p>dd if=/dev/mtdblock5 of=/home/usb/mtd5.bin count=00010000</p><p>Your u-boot partition may be in a different block than mtd5.&nbsp; Your USB stick may be mounted at a different location to mine.</p><br /><p>&lt;Continued Next Post&gt;</p>											<p class="post-edited">(Last edited by <strong>andrewm1973</strong> on 9 Sep 2009, 09:35)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93921">
				<div class="post-metadata">
					<div class="post-num">Post #471</div>
					<div class="post-author">andrewm1973</div>
					<div class="post-datetime">
						9 Sep 2009, 07:53					</div>
				</div>
				<div class="post-content content">
					<p>Upgrading to 128M continued</p><p>Then go to your desktop and use Dis-Arm to turn the hex file into something semi human readable</p><p>(in my case I typed&nbsp; &gt;disarm -o mt5.bin &gt; uboot.asm)</p><p>You can now open up the disassembled file (uboot.asm) in an editor (notepad etc)</p><p>out of curiosty do a search for </p><p>0000315c:</p><p>and you should see</p><p>0000315c:&nbsp; 01ff0001&nbsp; mvneqs&nbsp; &nbsp;r0,r1</p><p>The &quot;mvneqs r0,r1&quot; is jibberish because this is constant data.&nbsp; The 01ff0001 should look familiar though <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></p><p>Now onto the search for the other patch.</p><p>In the source code I search for </p><p>SDRAM_ADDR_CTRL_REG</p><p>and come up with this in the source code</p><div class="codebox"><pre><code>Density:        
    bl     _getDensity
    mov     r8, r7
    mov     r8, r8, LSR #20 /* Move density 20 bits to the right  */
                            /* For example 0x10000000 --&gt; 0x1000 */
        
    mov     r6, #0x00
    cmp     r8, #DRAM_DEV_DENSITY_128M
    beq     densCont
        
    mov     r6, #0x10
    cmp     r8, #DRAM_DEV_DENSITY_256M
    beq     densCont
        
    mov     r6, #0x20
    cmp     r8, #DRAM_DEV_DENSITY_512M
    beq     densCont

    /* This is an error. return */
    b       exit_ddrAutoConfig
        
densCont:
    MV_REG_WRITE_ASM (r6, r5, SDRAM_ADDR_CTRL_REG)</code></pre></div><p>However reading a bit further I see that _getDensity is issuing I2C commands to an SPD-ROM and the WRT350N does not have one.</p><p>So the search continues and I find in the file</p><p>mvDramIfBasicInit<br /></p><div class="codebox"><pre><code>#if 0
/* DDR 1 256M samsung M368L3223ETM-CCC */
#define SDRAM0_BANK0_SIZE    0x7ff0001
#define SDRAM_CONFIG    0x3248400    
#define SDRAM_MODE    0x62    
#define DUNIT_CTRL_LOW    0x4041040
#define SDRAM_ADDR_CTRL    0x10
#define SDRAM_TIME_CTRL_LOW    0x1501110
#define SDRAM_TIME_CTRL_HI    0x409
#define SDRAM_ODT_CTRL_LOW    0x0
#define SDRAM_ODT_CTRL_HI    0x0    
#define SDRAM_DUNIT_ODT_CTRL    0x0
#define SDRAM_EXT_MODE                0x0
#endif

/* DDR 1 32M micron MT46VSM16P-6T */
#define STATIC1_SDRAM0_BANK0_SIZE         0x1ff0001
#define STATIC1_SDRAM_CONFIG         0x3148400    
#define STATIC1_SDRAM_MODE         0x62    
#define STATIC1_DUNIT_CTRL_LOW         0x4041000
#define STATIC1_SDRAM_ADDR_CTRL         0x0
#define STATIC1_SDRAM_TIME_CTRL_LOW     0x11602220
#define STATIC1_SDRAM_TIME_CTRL_HI         0x40c
#define STATIC1_SDRAM_ODT_CTRL_LOW         0x0
#define STATIC1_SDRAM_ODT_CTRL_HI         0x0    
#define STATIC1_SDRAM_DUNIT_ODT_CTRL    0x0
#define STATIC1_SDRAM_EXT_MODE          0x0</code></pre></div><p>So the data being loaded into SDRAM_ADDR_CTRL is likely stored together.</p><p>From Kmpers post we at least know the address of the SDRAM0_BANK0_Size (being at 0x315C)</p><p>So here is the disassembly of memory locations in that area (ignore opcodes they are still jibberish)</p><div class="codebox"><pre><code>0000314c:  f1001504  mrs??    r1,cpsr
00003150:  f100150c  mrs??    r1,cpsr
00003154:  f1001514  mrs??    r1,cpsr
00003158:  f100151c  mrs??    r1,cpsr
0000315c:  01ff0001  mvneqs   r0,r1
00003160:  f101011c  mrs??    r0,cpsr
00003164:  03148400  tsteq    r4,#0
00003168:  f1020318  mrs??    r0,cpsr
0000316c:  f1020114  mrs??    r0,cpsr
00003170:  04041000  streq    r1,[r4],#-0
00003174:  f1020320  mrs??    r0,cpsr
00003178:  f1020404  mrs??    r0,cpsr
0000317c:  11602220  msrne    spsr_all,r0</code></pre></div><p>Bit of pattern matching and we can see</p><div class="codebox"><pre><code>315C contains 01ff0001     which is STATIC1_SDRAM0_BANK0_SIZE        0x1ff0001
3160
3164 contains 03148400     which is STATIC1_SDRAM_CONFIG            0x3148400
3168
316c
3170 contains 04041000     which is STATIC1_DUNIT_CTRL_LOW             0x4041000
3174
3178
317c contains 11602220     which is STATIC1_SDRAM_TIME_CTRL_LOW        0x11602220</code></pre></div><p>The other statics are not 4 bytes long so will be either packed together OR inlined by the assembler</p><p>There is NO data-bytes anywhere near address 315c that contain 62 (something else searchable for as it is pointless looking for what we are really after the 0x00 as it is everywhere where as 0x62 will be less common)</p><p>So we go in search of</p><p>STATIC1_SDRAM_ADDR_CTRL</p><p>And we find in the file</p><p>mvDramIfBasicInit</p><p>in a subroutine with a snippit shown below</p><div class="codebox"><pre><code>_mvDramIfStatic1Init:

    ldr    r6, = STATIC1_SDRAM_ADDR_CTRL
    MV_REG_WRITE_ASM(r6, r5, DRAM_BUF_REG4)</code></pre></div><p>SO - the STATIC1_SDRAM_ADDR_CTRL is being loaded into the location DRAM_BUF_REG4</p><br /><br /><p>&lt;Continued Next Post&gt;</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93922">
				<div class="post-metadata">
					<div class="post-num">Post #472</div>
					<div class="post-author">andrewm1973</div>
					<div class="post-datetime">
						9 Sep 2009, 07:58					</div>
				</div>
				<div class="post-content content">
					<p>Upgrading to 128M continued-2</p><p>We search for the text</p><p>DRAM_BUF_REG4</p><p>And we find in the file</p><p>mvDramIf<br /></p><div class="codebox"><pre><code>    /* calc SDRAM_ADDR_CTRL_REG  and save it to temp register */
    temp = sdramAddrCtrlRegCalc(&amp;bankInfo[0]);
    if(-1 == temp)
    {
        mvOsPrintf(&quot;Dram: ERR. sdramAddrCtrlRegCalc failed !!!\n&quot;);
        return MV_ERROR;
    }
    MV_REG_WRITE(DRAM_BUF_REG4, temp);</code></pre></div><p>The comment at the start of this file says</p><div class="codebox"><pre><code>/*******************************************************************************
* mvDramIfDetect - Prepare DRAM interface configuration values.
*
* DESCRIPTION:
*       This function implements the full DRAM detection and timing 
*       configuration for best system performance.
*       Since this routine runs from a ROM device (Boot Flash), its stack 
*       resides on RAM, that might be the system DRAM. Changing DRAM 
*       configuration values while keeping vital data in DRAM is risky. That
*       is why the function does not preform the configuration setting but 
*       prepare those in predefined 32bit registers (in this case IDMA 
*       registers are used) for other routine to perform the settings.
*       The function will call for board DRAM SPD information for each DRAM 
*       chip select. The function will then analyze those SPD parameters of 
*       all DRAM banks in order to decide on DRAM configuration compatible 
*       for all DRAM banks.
*       The function will set the CPU DRAM address decode registers.
*       Note: This routine prepares values that will overide configuration of
*       mvDramBasicAsmInit().
*       
* INPUT:
*       forcedCl - Forced CAL Latency. If equal to zero, do not force.
*
* OUTPUT:
*       None.
*
* RETURN:
*       None.
*
*******************************************************************************/</code></pre></div><p>So we have confirmation that the SDRAM_ADDR_CTRL_REG is definitly being loaded into a temp register.&nbsp; However this file is looking for I2C SPD eeproms again</p><p>So look or other instances of DRAM_BUF_REG4</p><p>and we find it in the file</p><p>mvDramIfBasicInit<br /></p><div class="codebox"><pre><code>#define DRAM_BUF_REG4    0x20404    /* sdram address control        */</code></pre></div><p>So we now have an address of the IDMA? register being used for DRAM_BUF_REG4.&nbsp; That info will be usefull when we are looking through the DISASSEMBLED file</p><p>It also appears in the file</p><p>mvDramIfConfig</p><div class="codebox"><pre><code>_mvDramIfConfig:      
        
        /* 3) Write SDRAM address control register */ 
        ldr     r1, =(INTER_REGS_BASE + DRAM_BUF_REG4)
        ldr     r4, [r1]
        ldr     r1, =(INTER_REGS_BASE + SDRAM_ADDR_CTRL_REG)
        str     r4, [r1]</code></pre></div><p>Which is the part that writes to the SDRAM control register</p><p>This is in the dissaembled file</p><div class="codebox"><pre><code>00003240:  e59f13b4  ldr      r1,#0x35fc ; = #0xf1020404
00003244:  e5914000  ldr      r4,[r1,#0]
00003248:  e59f13b0  ldr      r1,#0x3600 ; = #0xf1001410
0000324c:  e5814000  str      r4,[r1,#0]</code></pre></div><p>So now we just have to find all the parts in the disassembled file that put info INTO location f1020404 and work out which one coresponds to the static load of 0x00</p><p>We search for #0xF1020404 in the Disassembled file and fine three likely candidates</p><div class="codebox"><pre><code>00002ac4:  e3a06000  mov      r6,#0
00002ac8:  e59f56a8  ldr      r5,#0x3178 ; = #0xf1020404
00002acc:  e5856000  str      r6,[r5,#0]

00002b84:  e3a06020  mov      r6,#0x20
00002b88:  e59f55e8  ldr      r5,#0x3178 ; = #0xf1020404
00002b8c:  e5856000  str      r6,[r5,#0]

00003588:  e3a04000  mov      r4,#0
0000358c:  e59f1068  ldr      r1,#0x35fc ; = #0xf1020404
00003590:  e5814000  str      r4,[r1,#0]</code></pre></div><p>My bet would be candidate 1</p><p>remeber code that we first found to load the static value in was</p><div class="codebox"><pre><code>_mvDramIfStatic1Init:

    ldr    r6, = STATIC1_SDRAM_ADDR_CTRL
    MV_REG_WRITE_ASM(r6, r5, DRAM_BUF_REG4)</code></pre></div><p>(note mov and ldr are similar instructions.&nbsp; I am not an ARM expert but from a quick read mov is like ldr for an 8 bit literal)</p><p>othe other two options are precluded due to</p><p>option 2 is loading the literal 0x20 into the temp register (we are looking for the value 0x00)<br />option 3 is using the register r4 (the code we are looking for is using r6)</p><p>SO we have a new location to try modify</p><p>00002ac4:&nbsp; &nbsp;e3a06000</p><p>must become</p><p>00002ac4:&nbsp; &nbsp;e3a06030</p><br /><p>So in your favorite Hex-Editor (I used Notepad++ with HEX plugin) you have to modify your bin file so that</p><p>Address 0000315f changes from 0x01 to 0x07<br />Address 00002ac4 changes from 0x00 to 0x30</p><p>Save the file to the USB stick.</p><p>Go back to the Linux Prompt on the router and use the DD command to write the two updated bytes (315F = 12639 decimal, 2AC4 = 10948 decimal)</p><div class="codebox"><pre><code>dd if=/home/usb/mtd5.bin of=/dev/mtdblock5 bs=1 skip=12639 seek=12639 count=1
dd if=/home/usb/mtd5.bin of=/dev/mtdblock5 bs=1 skip=10948 seek=10948 count=1</code></pre></div><p>Reboot and Robert is your aunties husband.</p><br /><p>&lt;Continued Next Post&gt;</p>											<p class="post-edited">(Last edited by <strong>andrewm1973</strong> on 9 Sep 2009, 08:31)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93923">
				<div class="post-metadata">
					<div class="post-num">Post #473</div>
					<div class="post-author">andrewm1973</div>
					<div class="post-datetime">
						9 Sep 2009, 08:23					</div>
				</div>
				<div class="post-content content">
					<p>Upgrading to 128M continued-3</p><p>The paint by numbers version</p><p>_STEP ONE_&nbsp; Read and understand previous 3 posts and more importantly read post by jdoering on the SLUG forum<br />_STEP TWO_ dont continue if you love your router too much to risk loosing it</p><p>Steps 3 and onwards......</p><p>go to u-boot</p><p>type </p><p>&gt;md fffc3150</p><div class="codebox"><pre><code>fffc3150: f100150c f1001514 f100151c 01ff0001    ................               
fffc3160: f101011c 03148400 f1020318 f1020114    ................               
fffc3170: 04041000 f1020320 f1020404 11602220    .... ....... &quot;`.               
fffc3180: f102040c 0000040c f1040108 f1040114    ................               
fffc3190: f1041910 f1041a08 f1041a30 0fff0001    ........0.......               
fffc31a0: 03248400 0000030f f1001400 f1040000    ..$.............               
fffc31b0: 00005181 00005182 00005281 f1040008    .Q...Q...R......               
fffc31c0: f1001418 f100141c 00041040 f1001404    ........@.......               
fffc31d0: f1001410 f1001420 f1001494 f1001498    .... ...........               
fffc31e0: 00000a01 f100149c f10014c0 f10014c4    ................               
fffc31f0: 00f95001 f1010010 0047f001 0044d001    .P........G...D.               
fffc3200: f1001484 f1001408 f100140c 11812220    ............ &quot;..               
fffc3210: ffff0000 e35d0000 0a000000 e92d001e    ......].......-.               
fffc3220: e59f13c4 e5914000 e59f13c0 e5814000    .....@.......@..               
fffc3230: e59f13bc e5914000 e59f13b8 e5814000    .....@.......@..               
fffc3240: e59f13b4 e5914000 e59f13b0 e5814000    .....@.......@..</code></pre></div><p>If your output is not identical dont continue</p><p>type </p><p>&gt;md fffc2ac0</p><div class="codebox"><pre><code>fffc2ac0: e5856000 e3a06000 e59f56a8 e5856000    .`..0`...V...`..               
fffc2ad0: e59f66a4 e59f56a4 e5856000 e59f66a0    .f...V...`...f..               
fffc2ae0: e59f56a0 e5856000 e3a06000 e59f5698    .V...`...`...V..               
fffc2af0: e5856000 e3a06000 e59f5690 e5856000    .`...`...V...`..               
fffc2b00: e3a06000 e59f5688 e5856000 e3a06000    .`...V...`...`..               
fffc2b10: e59f5680 e5856000 e3a0d000 eb0001bc    .V...`..........               
fffc2b20: e1a0200a e1a0f00b e1a0b00e e1a0a002    . ..............               
fffc2b30: e3a06000 e59f5610 e5856000 e59f560c    .`...V...`...V..               
fffc2b40: e5856000 e59f5608 e5856000 e59f5604    .`...V...`...V..               
fffc2b50: e5856000 e59f6640 e59f5600 e5856000    .`..@f...V...`..               
fffc2b60: e59f6638 e59f55fc e5856000 e3a06062    8f...U...`..b`..               
fffc2b70: e59f55f4 e5856000 e59f65f0 e59f55f0    .U...`...e...U..               
fffc2b80: e5856000 e3a06020 e59f55e8 e5856000    .`.. `...U...`..               
fffc2b90: e59f65e4 e59f55e4 e5856000 e59f6600    .e...U...`...f..               
fffc2ba0: e59f55e0 e5856000 e3a06000 e59f55d8    .U...`...`...U..               
fffc2bb0: e5856000 e3a06000 e59f55d0 e5856000    .`...`...U...`..</code></pre></div><p>If your output is not identical dont continue</p><p>type</p><p>&gt;md f1001400</p><div class="codebox"><pre><code>f1001400: 03148400 04041000 11602220 0000040c    ........ &quot;`.....               
f1001410: 00000000 00000000 00000000 00000062    ............b...               
f1001420: 00000000 00000000 00063305 00000000    .........3......               
f1001430: 76543210 fedcba98 000100ff 00000000    .2Tv............               
f1001440: 00000000 00000000 00000000 00000000    ................               
f1001450: 00000000 00000000 00000000 00000000    ................               
f1001460: 00000000 00000000 00000000 00000000    ................               
f1001470: 065528d5 00000052 00000000 00006330    .(U.R.......0c..               
f1001480: 00000000 0047f001 00000102 00000001    ......G.........               
f1001490: 00000000 00000000 00000000 00000000    ................               
f10014a0: 00000000 00000000 00000001 00000000    ................               
f10014b0: 000001e0 00000000 00000000 00000000    ................               
f10014c0: 071f128a 071f128a 00000000 00000000    ................               
f10014d0: 00000000 00000000 00000000 00000000    ................               
f10014e0: f7ff4cff 00000000 00000000 0000000f    .L..............               
f10014f0: 00000000 00000000 00000000 00000000    ................</code></pre></div><p>Make sure address f1001410 = 00000000</p><p>type</p><p>&gt;md f1001500</p><div class="codebox"><pre><code>f1001500: 00000000 01ff0001 10000000 00000000    ................               
f1001510: 20000000 00000000 30000000 00000000    ... .......0....               
f1001520: 00000000 00000000 00000000 00000000    ................               
f1001530: 00000000 00000000 00000000 00000000    ................               
f1001540: 00000000 00000000 00000000 00000000    ................               
f1001550: 00000000 00000000 00000000 00000000    ................               
f1001560: 00000000 00000000 00000000 00000000    ................               
f1001570: 00000000 00000000 00000000 00000000    ................               
f1001580: 00000000 00000000 00000000 00000000    ................               
f1001590: 00000000 00000000 00000000 00000000    ................               
f10015a0: 00000000 00000000 00000000 00000000    ................               
f10015b0: 00000000 00000000 00000000 00000000    ................               
f10015c0: 00000000 00000000 00000000 00000000    ................               
f10015d0: 00000000 00000000 00000000 00000000    ................               
f10015e0: 00000000 00000000 00000000 00000000    ................               
f10015f0: 00000000 00000000 00000000 00000000    ................</code></pre></div><p>make sure location f1001504 = 01ff0001</p><p>boot to linux shell</p><p>type</p><p>cat /proc/mtd</p><div class="codebox"><pre><code>dev:    size    erasesize name
mtd0: 00100000 00010000 &quot;kernel&quot;
mtd1: 00650000 00010000 &quot;rootfs&quot;
mtd2: 00510000 00010000 &quot;rootfs_data&quot;
mtd3: 00040000 00010000 &quot;lang&quot;
mtd4: 00020000 00010000 &quot;nvram&quot;
mtd5: 00040000 00010000 &quot;u-boot&quot;
mtd6: 00010000 00010000 &quot;eRcOmM_do_not_touch&quot;
mtd7: 00760000 00010000 &quot;image&quot;</code></pre></div><p>Take note of you u-boot location</p><p>use the following command to save a binary image to the USB rive</p><p>dd if=/dev/mtdblock5 of=/home/usb/mtd5.bin count=00010000</p><p>(Note: your USB location and your MTDBlock number may be different than mine)</p><p>Use a hex editor to modify the following locations</p><p>Address 0000315f changes from 0x01 to 0x07 (data around this should look like 10 00 ff 01 if not dont continue)<br />Address 00002ac4 changes from 0x00 to 0x30 (data around this should look like 00 60 A0 E3 if not dont continue)</p><p>Save the file to the USB stick.</p><p>Go back to the Linux Prompt on the router and use the DD command to write the two updated bytes (315F = 12639 decimal, 2AC4 = 10948 decimal)</p><p>dd if=/home/usb/mtd5.bin of=/dev/mtdblock5 bs=1 skip=12639 seek=12639 count=1<br />dd if=/home/usb/mtd5.bin of=/dev/mtdblock5 bs=1 skip=10948 seek=10948 count=1</p><p>(Note: your USB location and your MTDBlock number may be different than mine)</p><p>reboot and go back to u-boot prompt</p><p>type &gt;md f1001400 and &gt;md F1001500 again to check the two locations of interest have changed.</p><div class="codebox"><pre><code>f1001400: 03148400 04041000 11602220 0000040c    ........ &quot;`.....               
f1001410: 00000030 00000000 00000000 00000062    ............b...               
f1001420: 00000000 00000000 00063305 00000000    .........3......               
f1001430: 76543210 fedcba98 000100ff 00000000    .2Tv............               
f1001440: 00000000 00000000 00000000 00000000    ................               
f1001450: 00000000 00000000 00000000 00000000    ................               
f1001460: 00000000 00000000 00000000 00000000    ................               
f1001470: 065528d5 00000052 00000000 00006330    .(U.R.......0c..               
f1001480: 00000000 0047f001 00000102 00000001    ......G.........               
f1001490: 00000000 00000000 00000000 00000000    ................               
f10014a0: 00000000 00000000 00000001 00000000    ................               
f10014b0: 000001e0 00000000 00000000 00000000    ................               
f10014c0: 071f128a 071f128a 00000000 00000000    ................               
f10014d0: 00000000 00000000 00000000 00000000    ................               
f10014e0: f7ff4cff 00000000 00000000 0000000f    .L..............               
f10014f0: 00000000 00000000 00000000 00000000    ................          

f1001500: 00000000 07ff0001 10000000 00000000    ................               
f1001510: 20000000 00000000 30000000 00000000    ... .......0....               
f1001520: 00000000 00000000 00000000 00000000    ................               
f1001530: 00000000 00000000 00000000 00000000    ................               
f1001540: 00000000 00000000 00000000 00000000    ................               
f1001550: 00000000 00000000 00000000 00000000    ................               
f1001560: 00000000 00000000 00000000 00000000    ................               
f1001570: 00000000 00000000 00000000 00000000    ................               
f1001580: 00000000 00000000 00000000 00000000    ................               
f1001590: 00000000 00000000 00000000 00000000    ................               
f10015a0: 00000000 00000000 00000000 00000000    ................               
f10015b0: 00000000 00000000 00000000 00000000    ................               
f10015c0: 00000000 00000000 00000000 00000000    ................               
f10015d0: 00000000 00000000 00000000 00000000    ................               
f10015e0: 00000000 00000000 00000000 00000000    ................               
f10015f0: 00000000 00000000 00000000 00000000    ................</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93924">
				<div class="post-metadata">
					<div class="post-num">Post #474</div>
					<div class="post-author">dallienl</div>
					<div class="post-datetime">
						9 Sep 2009, 08:35					</div>
				</div>
				<div class="post-content content">
					<p>Did a quick test with another XP system, also this system could&#039;t connect. Seems the only system that can connect with my config is the windows 7 system.</p><p>Tonight I will do some wireless sniffing to see what&#039;s the difference between Windows 7 and XP connecting. Starting my OpenVPN tests now.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93925">
				<div class="post-metadata">
					<div class="post-num">Post #475</div>
					<div class="post-author">andrewm1973</div>
					<div class="post-datetime">
						9 Sep 2009, 08:36					</div>
				</div>
				<div class="post-content content">
					<p>maddes - i have not forgotten about you.</p><p>I just got tied up a bit with the ram upgrade and have not had a chance to open one of the new routers to take photos and save images for you.</p><p>will do that in the next day or so.&nbsp; right now i need rest</p>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 19 of 46</div><nav><ul><li><a href="viewtopic.php%3Fid=12358&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=12358&amp;p=17.html">17</a></li><li><a href="viewtopic.php%3Fid=12358&amp;p=18.html">18</a></li><li class="pagination-current"><span>19</span></li><li><a href="viewtopic.php%3Fid=12358&amp;p=20.html">20</a></li><li><a href="viewtopic.php%3Fid=12358&amp;p=21.html">21</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=12358&amp;p=46.html">46</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0.001 -->

</body>
</html>