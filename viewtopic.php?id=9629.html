<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> How do i flash Kamikaze to a Gateworks ixp4xx board?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 30 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p43336">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Gawen</div>
					<div class="post-datetime">
						27 Feb 2007, 11:42					</div>
				</div>
				<div class="post-content content">
					<p>Sorry for asking, but i didnt find a hint in wiki and forum...</p><p>How do i flash openwrt to a 8 mb flash Gateworks Avila board?</p><p>Wich files do i need?</p><br /><p>This worked for me with dd-wrt (from their flashing.txt):</p><p>instructions for GW2348-2 or generic 8 MB flash devices</p><p>fis init -f<br />load -r -v -b 0x00800000 zImage<br />fis create -b 0x00800000 -f 0x050080000 -l 0x00200000 -r 0x00800000 linux<br />fis create -n linux<br />load -r -v -b 0x00800000 root.fs<br />fis create -b 0x00800000 -f 0x050280000 -l 0x00520000 ramdisk<br />fis create -b 0x00800000 -f 0x0507A0000 -l 0x00020000 mampf<br />fis create -b 0x00800000 -f 0x0507C0000 -l 0x00020000 nvram<br />fis load linux<br />exec</p><br /><p>consider to configure the boot script<br />fis load linux<br />exec<br />using fconfig</p>											<p class="post-edited">(Last edited by <strong>Gawen</strong> on 27 Feb 2007, 11:44)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p43356">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Gawen</div>
					<div class="post-datetime">
						27 Feb 2007, 18:27					</div>
				</div>
				<div class="post-content content">
					<p>Downloaded openwrt-avila-2.6-zImage and openwrt-ixp4xx-2.6-jffs2-64k.img from <a href="http://downloads.openwrt.org/snapshots/ixp4xx-2.6/">http://downloads.openwrt.org/snapshots/ixp4xx-2.6/</a>, renamed them to zImage and root.fs and flashed them dd-wrt style. </p><p>Worked with the Kernel, but not with the FS...</p><p>...<br />IXP4XX-Flash.0: Found 1 x16 devices at 0x0 in 16-bit bank&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br /> Intel/Sharp Extended Query Table at 0x0031&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />9 RedBoot partit<br />Using buffer write methodXP4XX-Flash.0eachable&nbsp; &nbsp; <br />cfi_cmdset_0001: Erase suspend on write enabled&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />gethostbyname:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />Creati<br />Searching for RedBoot partition table in IXP4XX-Flash.0 at offset 0xfe0000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />connect: Network is unreachable&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />9 RedBoot partitions found on MTD device IXP4XX-Flash.0hable&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />0x007c0000-0x007e0000 : &quot;nvram&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />connect: Network is u<br />0x007e0000-0x00fc0000 : &quot;unallocated&quot;&nbsp; &nbsp;<br />i2c /dev entries driver&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />0x00fc0000-0x00fc1000 : &quot;RedBoot config&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />ip_conntrack version 2.4<br />0x00fe0000-0x01000000 : &quot;FIS directory&quot; conntracknreachable&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />i2c /dev entries driver&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />ip_conntrack version 2.4 (512 buckets, 4096 max) - 248 bytes per conntrack&nbsp; &nbsp; &nbsp; <br />ip_tables: (C) 2000-2006 Netfilter Core Teamrk is unreachable&nbsp; &nbsp; &nbsp; <br />ip_tables: (C) 2000-2006 Netfilter Core Team&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />TCP westwood registeredo&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />All bugs added by David S. Miller &lt;davem@redhat.com&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />gethostb&nbsp; &nbsp; &nbsp; &nbsp; <br />st<br />drivers/rtc/hctosys.c: unable to open rtc device (rtc0)k 0x1985 not found at 0x00000004: 0xe381 inchable&nbsp; &nbsp; &nbsp; <br />Time: OSTS clocksource has been installed.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />conn<br />jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00000000: 0xe3a0 ineraseblock(): Magic bitmask 0x1985 not found at 0x00000008: 0xe1a0 inyname: Netw<br />stead unre<br />jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00000004: 0xe381 in&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />...</p><br /><p>jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x001e001c: 0x13c8 in<br />stead<br />jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x001e0020: 0x4144 in<br />stead<br />jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x001e0024: 0x2bc8 in<br />stead<br />Further such events for this erase block will not be printed<br />Cowardly refusing to erase blocks on filesystem with no valid JFFS2 nodes<br />empty_blocks 0, bad_blocks 0, c-&gt;nr_blocks 16<br />VFS: Cannot open root device &quot;mtdblock2&quot; or unknown-block(31,2)<br />Please append a correct &quot;root=&quot; boot option<br />Kernel panic - not syncing: VFS: Unable to mount root fs on unknown-block(31,2)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p43363">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">holgi03</div>
					<div class="post-datetime">
						27 Feb 2007, 19:41					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Gawen wrote:</cite><blockquote><p>Downloaded openwrt-avila-2.6-zImage and openwrt-ixp4xx-2.6-jffs2-64k.img from <a href="http://downloads.openwrt.org/snapshots/ixp4xx-2.6/">http://downloads.openwrt.org/snapshots/ixp4xx-2.6/</a>, r)</p></blockquote></div><p>fis init -f<br />load -r -b %{FREEMEMLO} openwrt-gateway7001-2.6-zImage<br />fis create kernel<br />load -r -b %{FREEMEMLO} openwrt-ixp4xx-2.6-jffs2-128k.img<br />fis create rootfs</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p43364">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Gawen</div>
					<div class="post-datetime">
						27 Feb 2007, 19:44					</div>
				</div>
				<div class="post-content content">
					<p>Thx, ill try this!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p56395">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">vpnsecure</div>
					<div class="post-datetime">
						24 Sep 2007, 18:50					</div>
				</div>
				<div class="post-content content">
					<p>After installing OpenWRT on dozens of WRT54GL, WRTSL54GS, and Asus 500Gp&#039;s, it is time to move to a platform with a faster processor. I would like your assistance loading Kamikaze the Gateworks Avila GW-2348-4. I&#039;ll apologize for what may turn out to be an easy question in advance. </p><p>I have a fairly impressive IPSec VPN running White Russian .9 on the WRTSL54GS . I am getting around 4.2Mbps using AES-128 encryption. I would like to be able to use AES-256 at 10Mbps+ without maxing out the CPU. (ok, I&#039;m getting off topic.)</p><p>Here is what I did to flash the Avila GW2348-4:<br /></p><div class="codebox"><pre><code> 
fis init -f
load -r -b %{FREEMEMLO} openwrt-avila-2.6-zImage
fis create kernel
load -r -b %{FREEMEMLO} openwrt-ixp4xx-2.6-squashfs.img
fis create rootfs</code></pre></div><p>This is what I get when I reboot:<br /></p><div class="codebox"><pre><code>+No devices on IDE controller 0

Trying NPE-B...success. Using NPE-B with PHY 0.
Ethernet eth0: MAC address 00:d0:12:03:42:53
IP: 192.168.1.1/255.255.255.0, Gateway: 192.168.1.1
Default server: 192.168.1.2

RedBoot(tm) bootstrap and debug environment [ROM]
Gateworks certified release, version 2.02 - built 05:22:19, Mar  3 2006

Platform: Gateworks Avila GW234X (IXP42X 533MHz) BE
Copyright (C) 2000, 2001, 2002, 2003, 2004 Red Hat, Inc.
Copyright (C) 2004, 2005 Gateworks Corporation

RAM: 0x00000000-0x04000000, [0x000298b0-0x03fc1000] available
FLASH: 0x50000000 - 0x51000000, 128 blocks of 0x00020000 bytes each.
== Executing boot script in 2.500 seconds - enter ^C to abort
RedBoot&gt; fis load kernel
RedBoot&gt; exec
Using base address 0x00029c00 and length 0x000e8024
Uncompressing Linux................................................................. done, booting the kernel.
Linux version 2.6.21.6 (nbd@ds10) (gcc version 4.1.2) #11 Thu Jul 26 18:11:21 CEST 2007
CPU: XScale-IXP42x Family [690541c1] revision 1 (ARMv5TE), cr=000039ff
Machine: Gateworks Avila Network Platform
Memory policy: ECC disabled, Data cache writeback
CPU0: D VIVT undefined 5 cache
CPU0: I cache: 32768 bytes, associativity 32, 32 byte lines, 32 sets
CPU0: D cache: 32768 bytes, associativity 32, 32 byte lines, 32 sets
Built 1 zonelists.  Total pages: 16256
Kernel command line: root=/dev/mtdblock2 rootfstype=squashfs,jffs2 noinitrd console=ttyS0,115200 init=/etc/preinit
PID hash table entries: 256 (order: 8, 1024 bytes)
Dentry cache hash table entries: 8192 (order: 3, 32768 bytes)
Inode-cache hash table entries: 4096 (order: 2, 16384 bytes)
Memory: 64MB = 64MB total
Memory: 62848KB available (1788K code, 167K data, 76K init)
Mount-cache hash table entries: 512
CPU: Testing write buffer coherency: ok
NET: Registered protocol family 16
IXP4xx: Using 16MiB expansion bus window size
PCI: IXP4xx is host
PCI: IXP4xx Using direct access for memory space
PCI: bus0: Fast back to back transfers enabled
NET: Registered protocol family 2
Time: OSTS clocksource has been installed.
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 2048 (order: 2, 16384 bytes)
TCP bind hash table entries: 2048 (order: 1, 8192 bytes)
TCP: Hash tables configured (established 2048 bind 2048)
TCP reno registered
NetWinder Floating Point Emulator V0.97 (double precision)
squashfs: version 3.0 (2006/03/15) Phillip Lougher
Registering mini_fo version $Id$
JFFS2 version 2.2. (NAND) (C) 2001-2006 Red Hat, Inc.
io scheduler noop registered
io scheduler deadline registered (default)
IXP4xx Watchdog Timer: heartbeat 60 sec
Serial: 8250/16550 driver $Revision: 1.90 $ 2 ports, IRQ sharing disabled
serial8250.0: ttyS0 at MMIO 0xc8000000 (irq = 15) is a XScale
serial8250.0: ttyS1 at MMIO 0xc8001000 (irq = 13) is a XScale
IXP4XX Q Manager 0.2.1 initialized.
IXP4XX NPE driver Version 0.3.0 initialized
ixp4xx_crypto 0.0.1 registered successfully
IXP4XX-Flash.0: Found 1 x16 devices at 0x0 in 16-bit bank
 Intel/Sharp Extended Query Table at 0x0031
Using buffer write method
cfi_cmdset_0001: Erase suspend on write enabled
Searching for RedBoot partition table in IXP4XX-Flash.0 at offset 0xfe0000
6 RedBoot partitions found on MTD device IXP4XX-Flash.0
Creating 6 MTD partitions on &quot;IXP4XX-Flash.0&quot;:
0x00000000-0x00080000 : &quot;RedBoot&quot;
npe: searching for firmware...
npe: found at 0x12104, unknown/NPE-A func: 03, rev: 5.8, size: 1074729484, id: 5003c508
npe: found at 0x3fd1c, IXP465/NPE-A func: 81, rev: 2.0, size: 12848, id: 10810200
npe: found at 0x42f4c, IXP425/NPE-B func: 01, rev: 2.0, size: 12848, id: 01010200
Image loaded to NPE-B Func:1, Rel: 2:0, Status: 82400000
npe: found at 0x4617c, IXP425/NPE-C func: 01, rev: 2.0, size: 12848, id: 02010200
Image loaded to NPE-C Func:1, Rel: 2:0, Status: 80800000
0x00080000-0x00180000 : &quot;kernel&quot;
0x00180000-0x002a0000 : &quot;rootfs&quot;
0x00280000-0x002a0000 : &quot;rootfs_data&quot;
0x002a0000-0x00fe0000 : &quot;unallocated&quot;
0x00fe0000-0x00fff000 : &quot;FIS directory&quot;
0x00fff000-0x01000000 : &quot;RedBoot config&quot;
i2c /dev entries driver
nf_conntrack version 0.5.0 (512 buckets, 4096 max)
ip_tables: (C) 2000-2006 Netfilter Core Team
TCP westwood registered
NET: Registered protocol family 1
NET: Registered protocol family 17
802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;
All bugs added by David S. Miller &lt;davem@redhat.com&gt;
XScale DSP coprocessor detected.
ixp4xx_mac driver 0.3.1: eth0 on NPE-B with PHY[0] initialized
ixp4xx_mac driver 0.3.1: eth1 on NPE-C with PHY[1] initialized
drivers/rtc/hctosys.c: unable to open rtc device (rtc0)
VFS: Mounted root (squashfs filesystem) readonly.
Freeing init memory: 76K
Warning: unable to open an initial console.
- preinit -
jffs2 not ready yet; using ramdisk
mini_fo: using base directory: /
mini_fo: using storage directory: /tmp/root
- init -

init started:  BusyBox v1.4.2 (2007-07-23 08:26:10 CEST) multi-call binary

Please press Enter to activate this console. eth0: link up, 100Mbps, full-duplex, lpa 0x41E1
eth0: link up, 100Mbps, full-duplex, lpa 0x41E1
PPP generic driver version 2.4.2
wlan: 0.8.4.2 (svn r2568)
ath_hal: module license &#039;Proprietary&#039; taints kernel.
ath_hal: 0.9.30.13 (AR5210, AR5211, AR5212, AR5416, RF5111, RF5112, RF2413, RF5413, RF2133, REGOPS_FUNC)
ath_rate_minstrel: Minstrel automatic rate control algorithm 1.2 (svn r2568)
ath_rate_minstrel: look around rate set to 10%
ath_rate_minstrel: EWMA rolloff level set to 75%
ath_rate_minstrel: max segment size in the mrr set to 6000 us
wlan: mac acl policy registered
ath_pci: 0.9.4.5 (svn r2568)
jffs2: Too few erase blocks (1)



BusyBox v1.4.2 (2007-07-23 08:26:10 CEST) Built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 KAMIKAZE (7.07) -----------------------------------
  * 10 oz Vodka       Shake well with ice and strain
  * 10 oz Triple sec  mixture into 10 shot glasses.
  * 10 oz lime juice  Salute!
 ---------------------------------------------------
root@OpenWrt:/#</code></pre></div><p>nbd asked skycode to make a larger rootfs partition in another thread. Assuming that this is the same problem I am having, I still need some help.<br /><a href="http://forum.openwrt.org/viewtopic.php?id=11809">http://forum.openwrt.org/viewtopic.php?id=11809</a></p><p>DD-WRT has step by step directions to flash the GW-2348. I would be happy to write a WIKI page for OpenWRT once I get this figured out.<br /><a href="http://www.dd-wrt.com/wiki/index.php/Installation#Gateworks_Avila_Network_Processor_GW2348">http://www.dd-wrt.com/wiki/index.php/In … sor_GW2348</a></p><p>The docs to flash the GW-2348 are located here for anyone else looking for more information.<br /><a href="http://ecos.sourceware.org/docs-latest/redboot/flash-image-system.html">http://ecos.sourceware.org/docs-latest/ … ystem.html</a></p><p><strong>Update:</strong><br />I tried searching for &quot;fis create&quot; and found the Kamikaze Installation<br /><a href="http://wiki.x-wrt.org/index.php/Kamikaze_Installation#Installing_on_RedBoot_devices">http://wiki.x-wrt.org/index.php/Kamikaz … ot_devices</a><br />The section on computing free space is one of the things I was missing.<br /><a href="http://wiki.x-wrt.org/index.php/Kamikaze_Installation#Computing_the_remaining_free_space_size">http://wiki.x-wrt.org/index.php/Kamikaz … space_size</a></p><p>I am much closer to a working router using the following commands.<br /></p><div class="codebox"><pre><code>fis init -f
load -r -b %{FREEMEMLO} openwrt-avila-2.6-zImage
fis create kernel
fis free
load -r -b %{FREEMEMLO} openwrt-ixp4xx-2.6-squashfs.img
fis create -l 0xE60000 rootfs (Replace 0xE60000 with the value you calculated from fis free.)</code></pre></div><p>Right now I&#039;m trying to figure out why eth0 does not work. Logread shows dhcpdiscover and dhcpoffer. The workstation is not getting an IP address and setting a static IP address does not work. </p><p><strong>Update 2:</strong></p><p>I&#039;m not sure exactly what I did but the ethernet ports are now working. I added the wan section to /etc/config/network and entered &quot;ifup wan&quot; to bring up eth1.</p><p>The following thread may be of some help to those getting started with Kamikaze.<br /><a href="http://forum.openwrt.org/viewtopic.php?id=11451">http://forum.openwrt.org/viewtopic.php?id=11451</a></p><div class="codebox"><pre><code>root@OpenWrt:/etc/config# cat network
# Network configuration file

config interface loopback
        option ifname   lo
        option proto    static
        option ipaddr   127.0.0.1
        option netmask  255.0.0.0

config interface lan
        option ifname   eth0
        option proto    static
        option ipaddr   192.168.1.1
        option netmask  255.255.255.0

config interface wan
        option ifname   eth1
        option proto    dhcp</code></pre></div><p>The last thing I did was to install the X-WRT Web Interface by following the instructions here.<br /><a href="http://wiki.x-wrt.org/index.php/Kamikaze_Installation#Updating_OpenWrt_Kamikaze">http://wiki.x-wrt.org/index.php/Kamikaz … t_Kamikaze</a></p><p>So far, so good. My next project is to figure out what I am going to do for an IPSec VPN. Kamikaze replaced OpenSwan with IPSec-Tools with the kernel change from 2.4 to 2.6. I have a project that might not work with IPSec-Tools. Anyway, I&#039;m getting off-topic again.</p><p>Thank You,</p><p>Kevin</p>											<p class="post-edited">(Last edited by <strong>vpnsecure</strong> on 25 Sep 2007, 18:20)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p58226">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">nlinux</div>
					<div class="post-datetime">
						30 Oct 2007, 03:44					</div>
				</div>
				<div class="post-content content">
					<p>We&#039;ll I&#039;ve sort of successfully flashed and booted a Gateworks GW2345 which is pretty much identical to the GW2348-4 but has a couple more bells and whistles.&nbsp; &nbsp;I am having the same problem that none of the Ethernet ports are working.&nbsp; If you or anyone else knows what or why or would be a lot of help.&nbsp; I see my wireless cards when I do a dmesg, and I&#039;ve tried adding them to /etc/config/network with static addresses but they don&#039;t come up right either.</p><p>ideas?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p58231">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">dboreham</div>
					<div class="post-datetime">
						30 Oct 2007, 07:42					</div>
				</div>
				<div class="post-content content">
					<p>I posted a complete log of my successful installation of OpenWrt on a gateworks board on the Avila mailing list. You can find the posts<br />in the archive here : <a href="http://lists.unixstudios.net/avila/2007/10/933">http://lists.unixstudios.net/avila/2007/10/933</a> (the thread with subject &quot;(GW2348-4 + DD-WRT) = (Headaches + Missing Hair)&quot;,<br />look for posts in that thread by me, there are several.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p58267">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">nlinux</div>
					<div class="post-datetime">
						30 Oct 2007, 20:28					</div>
				</div>
				<div class="post-content content">
					<p>hrmmm, where is that mailing list?&nbsp; That doesn&#039;t look like the same list that&#039;s on Avila&#039;s site?</p><p>Anyway,&nbsp; I&#039;ve tried this with 7.07 and 7.09 now and I get the same problem,&nbsp; Here&#039;s my config and bootlog:</p><p>The simple is, I have no eth0 or eth anything after flashing, but I can serial console with the best of them <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>I see this:</p><p>ixp4xx_mac driver 0.3.1: eth0 on NPE-B with PHY[0] initialized<br />ixp4xx_mac driver 0.3.1: eth1 on NPE-C with PHY[1] initialized</p><p>and then this:</p><p>eth0: PHY[0] unresponsive<br />eth0: link down</p><p>Which I think is at the core of my problems.</p><br /><br /><br /><div class="codebox"><pre><code>RedBoot&gt; fis init -f
About to initialize [format] FLASH image system - continue (y/n)? y
*** Initialize FLASH Image System
... Erase from 0x50080000-0x50fe0000: ...........................................................................................................................
... Unlock from 0x50fe0000-0x51000000: .
... Erase from 0x50fe0000-0x51000000: .
... Program from 0x03fe0000-0x04000000 at 0x50fe0000: .
... Lock from 0x50fe0000-0x51000000: .
RedBoot&gt; load -r -b %{FREEMEMLO} openwrt-avila-2.6-zImage
Using default protocol (TFTP)
Raw file loaded 0x00029c00-0x0010f81f, assumed entry at 0x00029c00
RedBoot&gt; fis create kernel
... Erase from 0x50080000-0x50180000: ........
... Program from 0x00029c00-0x0010f820 at 0x50080000: ........
... Unlock from 0x50fe0000-0x51000000: .
... Erase from 0x50fe0000-0x51000000: .
... Program from 0x03fe0000-0x04000000 at 0x50fe0000: .
... Lock from 0x50fe0000-0x51000000: .
RedBoot&gt; load -r -b %{FREEMEMLO} openwrt-ixp4xx-2.6-squashfs.img
Using default protocol (TFTP)
Raw file loaded 0x00029c00-0x00269bff, assumed entry at 0x00029c00
RedBoot&gt; fis create -l 0xe00000 rootfs
... Erase from 0x50180000-0x50f80000: ................................................................................................................
... Program from 0x00029c00-0x00269c00 at 0x50180000: ..................
... Unlock from 0x50fe0000-0x51000000: .
... Erase from 0x50fe0000-0x51000000: .
... Program from 0x03fe0000-0x04000000 at 0x50fe0000: .
... Lock from 0x50fe0000-0x51000000: .
RedBoot&gt; fis free
  0x50F80000 .. 0x50FE0000
RedBoot&gt; fconfig
Run script at boot: true
Boot script: 
.. fis load kernel
.. exec
Enter script, terminate with empty line
&gt;&gt; fis load kernel
&gt;&gt; exec
&gt;&gt; 
Boot script timeout (100ms resolution): 25
Use BOOTP for network configuration: false
Gateway IP address: 
Local IP address: 192.168.3.2
Local IP address mask: 255.255.255.0
Default server IP address: 192.168.3.1
Console baud rate: 115200
GDB connection port: 9000
Force console for special debug messages: false
Network debug at boot time: false
Default network device: npe_eth0
Update RedBoot non-volatile configuration - continue (y/n)? y
... Unlock from 0x50fe0000-0x51000000: .
... Erase from 0x50fe0000-0x51000000: .
... Program from 0x03fe0000-0x04000000 at 0x50fe0000: .
... Lock from 0x50fe0000-0x51000000: .
RedBoot&gt; fis load kernel
RedBoot&gt; exec
Using base address 0x00029c00 and length 0x000e5c20
Uncompressing Linux................................................................ done, booting the kernel.
Linux version 2.6.21.6 (mkelly@VDev) (gcc version 4.1.2) #2 Tue Oct 30 10:59:02 EDT 2007
CPU: XScale-IXP42x Family [690541c1] revision 1 (ARMv5TE), cr=000039ff
Machine: Gateworks Avila Network Platform
Memory policy: ECC disabled, Data cache writeback
CPU0: D VIVT undefined 5 cache
CPU0: I cache: 32768 bytes, associativity 32, 32 byte lines, 32 sets
CPU0: D cache: 32768 bytes, associativity 32, 32 byte lines, 32 sets
Built 1 zonelists.  Total pages: 16256
Kernel command line: root=/dev/mtdblock2 rootfstype=squashfs,jffs2 noinitrd console=ttyS0,115200 init=/etc/preinit
PID hash table entries: 256 (order: 8, 1024 bytes)
Dentry cache hash table entries: 8192 (order: 3, 32768 bytes)
Inode-cache hash table entries: 4096 (order: 2, 16384 bytes)
Memory: 64MB = 64MB total
Memory: 62848KB available (1772K code, 173K data, 76K init)
Mount-cache hash table entries: 512
CPU: Testing write buffer coherency: ok
NET: Registered protocol family 16
IXP4xx: Using 16MiB expansion bus window size
PCI: IXP4xx is host
PCI: IXP4xx Using direct access for memory space
PCI: bus0: Fast back to back transfers enabled
dmabounce: registered device 0000:00:01.0 on pci bus
dmabounce: registered device 0000:00:02.0 on pci bus
dmabounce: registered device 0000:00:03.0 on pci bus
Time: OSTS clocksource has been installed.
NET: Registered protocol family 2
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 2048 (order: 2, 16384 bytes)
TCP bind hash table entries: 2048 (order: 1, 8192 bytes)
TCP: Hash tables configured (established 2048 bind 2048)
TCP reno registered
NetWinder Floating Point Emulator V0.97 (double precision)
squashfs: version 3.0 (2006/03/15) Phillip Lougher
Registering mini_fo version $Id$
JFFS2 version 2.2. (NAND) (SUMMARY)  (C) 2001-2006 Red Hat, Inc.
io scheduler noop registered
io scheduler deadline registered (default)
IXP4xx Watchdog Timer: heartbeat 60 sec
Serial: 8250/16550 driver $Revision: 1.90 $ 2 ports, IRQ sharing disabled
serial8250.0: ttyS0 at MMIO 0xc8000000 (irq = 15) is a XScale
serial8250.0: ttyS1 at MMIO 0xc8001000 (irq = 13) is a XScale
IXP4XX Q Manager 0.2.1 initialized.
IXP4XX NPE driver Version 0.3.0 initialized
ixp4xx_crypto 0.0.1 registered successfully
IXP4XX-Flash.0: Found 1 x16 devices at 0x0 in 16-bit bank
 Intel/Sharp Extended Query Table at 0x0031
Using buffer write method
cfi_cmdset_0001: Erase suspend on write enabled
Searching for RedBoot partition table in IXP4XX-Flash.0 at offset 0xfe0000
6 RedBoot partitions found on MTD device IXP4XX-Flash.0
Creating 6 MTD partitions on &quot;IXP4XX-Flash.0&quot;:
0x00000000-0x00080000 : &quot;RedBoot&quot;
npe: searching for firmware...
npe: found at 0x12104, unknown/NPE-A func: 03, rev: 5.8, size: 1074729484, id: 5003c508
npe: found at 0x3fd1c, IXP465/NPE-A func: 81, rev: 2.0, size: 12848, id: 10810200
npe: found at 0x42f4c, IXP425/NPE-B func: 01, rev: 2.0, size: 12848, id: 01010200
Image loaded to NPE-B Func:1, Rel: 2:0, Status: 80800000
npe: found at 0x4617c, IXP425/NPE-C func: 01, rev: 2.0, size: 12848, id: 02010200
Image loaded to NPE-C Func:1, Rel: 2:0, Status: 80800000
0x00080000-0x00180000 : &quot;kernel&quot;
0x00180000-0x00f80000 : &quot;rootfs&quot;
mtd: partition &quot;rootfs&quot; set to be root filesystem
mtd: partition &quot;rootfs_data&quot; created automatically, ofs=3A0000, len=BE0000 
0x003a0000-0x00f80000 : &quot;rootfs_data&quot;
0x00f80000-0x00fe0000 : &quot;unallocated&quot;
0x00fe0000-0x00fff000 : &quot;FIS directory&quot;
0x00fff000-0x01000000 : &quot;RedBoot config&quot;
i2c /dev entries driver
nf_conntrack version 0.5.0 (512 buckets, 4096 max)
ip_tables: (C) 2000-2006 Netfilter Core Team
TCP westwood registered
NET: Registered protocol family 1
NET: Registered protocol family 17
802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;
All bugs added by David S. Miller &lt;davem@redhat.com&gt;
XScale DSP coprocessor detected.
ixp4xx_mac driver 0.3.1: eth0 on NPE-B with PHY[0] initialized
ixp4xx_mac driver 0.3.1: eth1 on NPE-C with PHY[1] initialized
drivers/rtc/hctosys.c: unable to open rtc device (rtc0)
VFS: Mounted root (squashfs filesystem) readonly.
Freeing init memory: 76K
Warning: unable to open an initial console.
- preinit -
jffs2 not ready yet; using ramdisk
mini_fo: using base directory: /
mini_fo: using storage directory: /tmp/root
- init -

Please press Enter to activate this console. 
eth0: PHY[0] unresponsive
eth0: link down
SCSI subsystem initialized
usbcore: registered new interface driver usbfs
usbcore: registered new interface driver hub
usbcore: registered new device driver usb
PPP generic driver version 2.4.2
wlan: 0.8.4.2 (svn r2756)
ath_hal: module license &#039;Proprietary&#039; taints kernel.
ath_hal: 0.9.30.13 (AR5210, AR5211, AR5212, AR5416, RF5111, RF5112, RF2413, RF5413, RF2133, REGOPS_FUNC)
ath_rate_minstrel: Minstrel automatic rate control algorithm 1.2 (svn r2756)
ath_rate_minstrel: look around rate set to 10%
ath_rate_minstrel: EWMA rolloff level set to 75%
ath_rate_minstrel: max segment size in the mrr set to 6000 us
wlan: mac acl policy registered
ath_pci: 0.9.4.5 (svn r2756)
PCI: enabling device 0000:00:02.0 (0340 -&gt; 0342)
ath_pci: switching rfkill capability off
ath_pci: switching per-packet transmit power control off
wifi0: 11a rates: 6Mbps 9Mbps 12Mbps 18Mbps 24Mbps 36Mbps 48Mbps 54Mbps
wifi0: 11b rates: 1Mbps 2Mbps 5.5Mbps 11Mbps
wifi0: 11g rates: 1Mbps 2Mbps 5.5Mbps 11Mbps 6Mbps 9Mbps 12Mbps 18Mbps 24Mbps 36Mbps 48Mbps 54Mbps
wifi0: turboA rates: 6Mbps 9Mbps 12Mbps 18Mbps 24Mbps 36Mbps 48Mbps 54Mbps
wifi0: turboG rates: 6Mbps 12Mbps 18Mbps 24Mbps 36Mbps 48Mbps 54Mbps
wifi0: H/W encryption support: WEP AES AES_CCM TKIP
wifi0: mac 10.5 phy 6.1 radio 6.3
wifi0: Use hw queue 1 for WME_AC_BE traffic
wifi0: Use hw queue 0 for WME_AC_BK traffic
wifi0: Use hw queue 2 for WME_AC_VI traffic
wifi0: Use hw queue 3 for WME_AC_VO traffic
wifi0: Use hw queue 8 for CAB traffic
wifi0: Use hw queue 9 for beacons
wifi0: Atheros 5212: mem=0x48000000, irq=27
PCI: enabling device 0000:00:03.0 (0340 -&gt; 0342)
ath_pci: switching rfkill capability off
ath_pci: switching per-packet transmit power control off
wifi1: 11a rates: 6Mbps 9Mbps 12Mbps 18Mbps 24Mbps 36Mbps 48Mbps 54Mbps
wifi1: 11b rates: 1Mbps 2Mbps 5.5Mbps 11Mbps
wifi1: 11g rates: 1Mbps 2Mbps 5.5Mbps 11Mbps 6Mbps 9Mbps 12Mbps 18Mbps 24Mbps 36Mbps 48Mbps 54Mbps
wifi1: turboA rates: 6Mbps 9Mbps 12Mbps 18Mbps 24Mbps 36Mbps 48Mbps 54Mbps
wifi1: turboG rates: 6Mbps 12Mbps 18Mbps 24Mbps 36Mbps 48Mbps 54Mbps
wifi1: H/W encryption support: WEP AES AES_CCM TKIP
wifi1: mac 10.5 phy 6.1 radio 6.3
wifi1: Use hw queue 1 for WME_AC_BE traffic
wifi1: Use hw queue 0 for WME_AC_BK traffic
wifi1: Use hw queue 2 for WME_AC_VI traffic
wifi1: Use hw queue 3 for WME_AC_VO traffic
wifi1: Use hw queue 8 for CAB traffic
wifi1: Use hw queue 9 for beacons
wifi1: Atheros 5212: mem=0x48010000, irq=26
USB Universal Host Controller Interface driver v3.0
usbcore: registered new interface driver usbserial
drivers/usb/serial/usb-serial.c: USB Serial support registered for generic
usbcore: registered new interface driver usbserial_generic
drivers/usb/serial/usb-serial.c: USB Serial Driver core
Initializing USB Mass Storage driver...
usbcore: registered new interface driver usb-storage
USB Mass Storage support registered.
drivers/usb/serial/usb-serial.c: USB Serial support registered for FTDI USB Serial Device
usbcore: registered new interface driver ftdi_sio
drivers/usb/serial/ftdi_sio.c: v1.4.3:USB FTDI Serial Converters Driver
drivers/usb/serial/usb-serial.c: USB Serial support registered for pl2303
usbcore: registered new interface driver pl2303
drivers/usb/serial/pl2303.c: Prolific PL2303 USB to serial adaptor driver
jffs2_scan_eraseblock(): End of filesystem marker found at 0x0
jffs2_build_filesystem(): unlocking the mtd device... done.
jffs2_build_filesystem(): erasing all blocks after the end marker... done.
mini_fo: using base directory: /
mini_fo: using storage directory: /jffs



BusyBox v1.7.2 (2007-10-29 15:50:55 EDT) built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 KAMIKAZE (bleeding edge, r9461) -------------------
  * 10 oz Vodka       Shake well with ice and strain
  * 10 oz Triple sec  mixture into 10 shot glasses.
  * 10 oz lime juice  Salute!
 ---------------------------------------------------
root@OpenWrt:/$</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p58307">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">nlinux</div>
					<div class="post-datetime">
						31 Oct 2007, 14:41					</div>
				</div>
				<div class="post-content content">
					<p>Well,&nbsp; I made a little progress, but still no ethernet ports.</p><p>I added these interfaces to /etc/config/network:</p><div class="codebox"><pre><code>config interface wan
        option ifname   eth1
        option proto    static
        option ipaddr   192.168.1.2
        option netmask  255.255.255.0

config interface wl0
        option ifname   wifi0
        option proto    static
        option ipaddr   192.168.1.3
        option netmask  255.255.255.0

config interface wl1
        option ifname   wifi1
        option proto    static
        option ipaddr   192.168.1.4
        option netmask  255.255.255.0</code></pre></div><p>Now my two radios appear to respond correctly when I do Ifup on them.</p><p>The weird thing is that eth1 gives me the exact same error as eth0:</p><div class="codebox"><pre><code>eth1: PHY[1] unresponsive
eth1: link down</code></pre></div><p>I confused on these.&nbsp; Could this be related to the NPE firmware?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p58354">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">Kaloz</div>
					<div class="post-datetime">
						1 Nov 2007, 14:20					</div>
				</div>
				<div class="post-content content">
					<p>The 2345 needs additional support due to the switch they&#039;ve used. I&#039;m working on it.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p58355">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">nlinux</div>
					<div class="post-datetime">
						1 Nov 2007, 15:20					</div>
				</div>
				<div class="post-content content">
					<p>Well, good to know it&#039;s not just me <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>I have a copy of their Development kit for this board.&nbsp; If any of that would help you out.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p58453">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">nlinux</div>
					<div class="post-datetime">
						3 Nov 2007, 15:56					</div>
				</div>
				<div class="post-content content">
					<p>with the help of Avila I got the ports working. </p><p>Remapping the PHY&#039;s to 1 and 5 for eth0 and eth1 worked sort of.&nbsp; &nbsp;eth1 being a single port works great, but the 4 port gang only works if I have an active link on the first port.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>