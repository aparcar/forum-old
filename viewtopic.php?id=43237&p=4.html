<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> U-Boot mod for routers with AR9331/AR9344</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 3 Apr 2015 and 7 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 4 of 25</div><nav><ul><li><a href="viewtopic.php%3Fid=43237&amp;p=1.html">1</a></li><li><a href="viewtopic.php%3Fid=43237&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=43237&amp;p=3.html">3</a></li><li class="pagination-current"><span>4</span></li><li><a href="viewtopic.php%3Fid=43237&amp;p=5.html">5</a></li><li><a href="viewtopic.php%3Fid=43237&amp;p=6.html">6</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=43237&amp;p=25.html">25</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p204544">
				<div class="post-metadata">
					<div class="post-num">Post #76</div>
					<div class="post-author">sevikcla</div>
					<div class="post-datetime">
						13 Jun 2013, 21:12					</div>
				</div>
				<div class="post-content content">
					<p>Hi fjorger!<br/>Actually I&#039;ve got two modules, one untouched <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile"/><br/>Does this work even if its not openwrt as default?</p><p>Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p204563">
				<div class="post-metadata">
					<div class="post-num">Post #77</div>
					<div class="post-author">fjorger</div>
					<div class="post-datetime">
						14 Jun 2013, 00:22					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>Yes, that area is present on stock firmware too (needed for WIFI to work properly).<br/>The problem is accessing using Telnet or SSH on stock firmware to copy the info you need to your computer (backup).<br/>Nonetheless you can always move to openwrt (without touching those areas - art and uboot).</p><p>Regards,</p><p>fjorger.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p204575">
				<div class="post-metadata">
					<div class="post-num">Post #78</div>
					<div class="post-author">wwxsyf</div>
					<div class="post-datetime">
						14 Jun 2013, 04:56					</div>
				</div>
				<div class="post-content content">
					<p>Hi pepe2k:</p><p>I have a board TL-WR740N Ver:5.3 which has AR9331 Soc, the flash is Spantion FL032PIF,Manuf Id 0x1, DeviceId0 0x2, DeviceId1 0x15<br/>if using atheros defualt bootloader,the board can works, bellow is boot log.</p><p>U-Boot 1.1.4 (Jun 13 2013 - 02:57:04)<br/>AP121 (ar9331) U-boot</p><p>DRAM:&nbsp; 16 MB<br/>Top of RAM usable for U-Boot at: 81000000<br/>Reserving 139k for U-Boot at: 80fdc000<br/>Reserving 192k for malloc() at: 80fac000<br/>Reserving 44 Bytes for Board Info at: 80fabfd4<br/>Reserving 36 Bytes for Global Data at: 80fabfb0<br/>Reserving 128k for boot params() at: 80f8bfb0<br/>Stack Pointer at: 80f8bf98<br/>Now running in RAM - U-Boot at: 80fdc000<br/>Flash Manuf Id 0x1, DeviceId0 0x2, DeviceId1 0x15<br/>flash size 4194304, sector count = 64<br/>Flash:&nbsp; 4 MB<br/>Using default environment</p><p>In:&nbsp; &nbsp; serial<br/>Out:&nbsp; &nbsp;serial<br/>Err:&nbsp; &nbsp;serial<br/>Net:&nbsp; &nbsp;ag7240_enet_initialize...<br/>Fetching MAC Address from 0x80ff4068<br/>Fetching MAC Address from 0x80ff4068<br/>: cfg1 0x5 cfg2 0x7114<br/>eth0: 00:03:7f:11:50:eb<br/>eth0 up<br/>: cfg1 0xf cfg2 0x7214<br/>eth1: 00:03:7f:11:50:ec<br/>athrs26_reg_init_lan<br/>ATHRS26: resetting s26<br/>ATHRS26: s26 reset done<br/>eth1 up<br/>eth0, eth1<br/>Hit any key to stop autoboot:&nbsp; 0 <br/>ar7240&gt; </p><p>But I replaced it with your bootloader uboot_for_wr740n_v4.bin which is downloaded from &quot;<a href="http://www.tech-blog.pl/pliki/u-boot_for_tp-link_AR9331_by_pepe2k.tar.gz">http://www.tech-blog.pl/pliki/u-boot_for_tp-link_AR9331_by_pepe2k.tar.gz</a>&quot;,the board cannot work, in other words, the board cannot boot again, I tried to restart the board many times,and found no any info at serial console.</p><p>Could you help to update the uboot which suppor the flash? thanrk you very much!</p><p>Best regards!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p204584">
				<div class="post-metadata">
					<div class="post-num">Post #79</div>
					<div class="post-author">slboat</div>
					<div class="post-datetime">
						14 Jun 2013, 06:51					</div>
				</div>
				<div class="post-content content">
					<p>great work and less picture:) i was test this on wr703,but with write large flash chip,like 8mbyte,16mbyte,it&#039;s kind very slowly:( that&#039;s the kind good reason to mod the upload server on it.use tftp is very fast,but with this http sever(i think it has be called uip),is kind really slowly.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p204603">
				<div class="post-metadata">
					<div class="post-num">Post #80</div>
					<div class="post-author">pepe2k</div>
					<div class="post-datetime">
						14 Jun 2013, 13:11					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>wwxsyf wrote:</cite><blockquote><p>I have a board TL-WR740N Ver:5.3 which has AR9331 Soc, the flash is Spantion FL032PIF,Manuf Id 0x1, DeviceId0 0x2, DeviceId1 0x15</p></blockquote></div><p>This model has only 16 MB RAM and 2 MB FLASH... it isn&#039;t supported by OpenWrt... buy something better.</p><div class="quotebox"><cite>wwxsyf wrote:</cite><blockquote><p>if using atheros defualt bootloader,the board can works, bellow is boot log.</p><p>[...]</p><p>But I replaced it with your bootloader uboot_for_wr740n_v4.bin which is downloaded from &quot;<a href="http://www.tech-blog.pl/pliki/u-boot_for_tp-link_AR9331_by_pepe2k.tar.gz">http://www.tech-blog.pl/pliki/u-boot_for_tp-link_AR9331_by_pepe2k.tar.gz</a>&quot;,the board cannot work, in other words, the board cannot boot again, I tried to restart the board many times,and found no any info at serial console.</p><p>Could you help to update the uboot which suppor the flash? thanrk you very much!</p></blockquote></div><p>This problem isn&#039;t related to FLASH chip type. This version of U-Boot can work with unrecognized chip too.<br/>I don&#039;t have this device so I can&#039;t check why it isn&#039;t working with my modification...</p><div class="quotebox"><cite>slboat wrote:</cite><blockquote><p>i was test this on wr703,but with write large flash chip,like 8mbyte,16mbyte,it&#039;s kind very slowly:( that&#039;s the kind good reason to mod the upload server on it.use tftp is very fast,but with this http sever(i think it has be called uip),is kind really slowly.</p></blockquote></div><p>Web server isn&#039;t a problem, uploading is as fast as in TFTP mode or even faster... Probably you don&#039;t know how NOR FLASH (and not only) works. If you want to save any data in FLASH you need to erase it first. So, firmware upgrade mode in this modification does 4 things, one by one: downloads firmware from browser to RAM, erases FLASH, copies firmware from RAM to FLASH and reboots the device.</p>											<p class="post-edited">(Last edited by <strong>pepe2k</strong> on 14 Jun 2013, 13:11)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p204606">
				<div class="post-metadata">
					<div class="post-num">Post #81</div>
					<div class="post-author">slboat</div>
					<div class="post-datetime">
						14 Jun 2013, 13:34					</div>
				</div>
				<div class="post-content content">
					<p><span class="postimg"><img src="http://see.sl088.com/w/images/d/d7/JustCapIt4684.jpg" alt="http://see.sl088.com/w/images/d/d7/JustCapIt4684.jpg"/></span><br/>it seems only four byte for one second,no flush,the uip is kind suck if use this work type,i know some about flash chip,i belive that&#039;s you talk nor flash,if use page write and erase,it should not need so slow,take about 40 minute to a 8mbyte flash chip,is not fast at all.</p><p>if i wasn&#039;t wrong,mips is take from some other route&#039;s uip to wr703.use it to flash the art and uboot are prefect fine,but for the fulll-flash,it&#039;s not do the best work</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p204607">
				<div class="post-metadata">
					<div class="post-num">Post #82</div>
					<div class="post-author">pepe2k</div>
					<div class="post-datetime">
						14 Jun 2013, 13:42					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>slboat wrote:</cite><blockquote><p><span class="postimg"><img src="http://see.sl088.com/w/images/d/d7/JustCapIt4684.jpg" alt="http://see.sl088.com/w/images/d/d7/JustCapIt4684.jpg"/></span><br/>it seems only four byte for one second,no flush,the uip is kind suck if use this work type,i know some about flash chip,i belive that&#039;s you talk nor flash,if use page write and erase,it should not need so slow,take about 40 minute to a 8mbyte flash chip,is not fast at all.</p></blockquote></div><p>Your English is horrible... I don&#039;t know what do you mean and what are you using but... it&#039;s not my modification (the image which you have included). In my modification there isn&#039;t any bytes counter!</p><p>Full upgrade firmware on WR703N which 16 MB FLASH shouldn&#039;t take more than 45 sec. Usually it takes about 30 s. So, you are doing something wrong or you have bought cheap, not original or broken FLASH chips? If you have problem with data uploading, check your network cables or... change browser.</p><div class="quotebox"><cite>slboat wrote:</cite><blockquote><p>if i wasn&#039;t wrong,mips is take from some other route&#039;s uip to wr703.use it to flash the art and uboot are prefect fine,but for the fulll-flash,it&#039;s not do the best work</p></blockquote></div><p>No, it&#039;s the same uIP version.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p204608">
				<div class="post-metadata">
					<div class="post-num">Post #83</div>
					<div class="post-author">slboat</div>
					<div class="post-datetime">
						14 Jun 2013, 13:47					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>pepe2k wrote:</cite><blockquote><div class="quotebox"><cite>slboat wrote:</cite><blockquote><p><span class="postimg"><img src="http://see.sl088.com/w/images/d/d7/JustCapIt4684.jpg" alt="http://see.sl088.com/w/images/d/d7/JustCapIt4684.jpg"/></span><br/>it seems only four byte for one second,no flush,the uip is kind suck if use this work type,i know some about flash chip,i belive that&#039;s you talk nor flash,if use page write and erase,it should not need so slow,take about 40 minute to a 8mbyte flash chip,is not fast at all.</p></blockquote></div><p>Your English is horrible... I don&#039;t know what do you mean and what are you using but... it&#039;s not my modification (the image which you have included). In my modification there isn&#039;t any bytes counter!</p><p>Full upgrade firmware on WR703N which 16 MB FLASH shouldn&#039;t take more than 45 sec. Usually it takes about 30 s. So, you are doing something wrong or you have bought cheap, not original or broken FLASH chips? If you have problem with data uploading, check your network cables or... change browser.</p><div class="quotebox"><cite>slboat wrote:</cite><blockquote><p>if i wasn&#039;t wrong,mips is take from some other route&#039;s uip to wr703.use it to flash the art and uboot are prefect fine,but for the fulll-flash,it&#039;s not do the best work</p></blockquote></div><p>No, it&#039;s the same uIP version.</p></blockquote></div><p>yes,the engilish i use is really bad:(, i think you are right,i still use the old mips&#039;s uboot,i got do some new test.</p><p>another fun part,it now have a mini http server,so why not put the setmac with the page...like<br/><a href="http://192.168.1.1/mac.html">http://192.168.1.1/mac.html</a></p><br/><p>and with a index page-like welcome page in <br/><a href="http://192.168.1.1/index.html">http://192.168.1.1/index.html</a><br/>with here you can chooice what you like to do,</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p204613">
				<div class="post-metadata">
					<div class="post-num">Post #84</div>
					<div class="post-author">pepe2k</div>
					<div class="post-datetime">
						14 Jun 2013, 14:01					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>slboat wrote:</cite><blockquote><p>another fun part,it now have a mini http server,so why not put the setmac with the page...like<br/><a href="http://192.168.1.1/mac.html">http://192.168.1.1/mac.html</a></p><p>and with a index page-like welcome page in <br/><a href="http://192.168.1.1/index.html">http://192.168.1.1/index.html</a><br/>with here you can chooice what you like to do,</p></blockquote></div><p>If you need that kind of functionalities... you can add them by yourself. And don&#039;t forget to publish your sources! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile"/></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p204620">
				<div class="post-metadata">
					<div class="post-num">Post #85</div>
					<div class="post-author">slboat</div>
					<div class="post-datetime">
						14 Jun 2013, 15:12					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>pepe2k wrote:</cite><blockquote><div class="quotebox"><cite>slboat wrote:</cite><blockquote><p>another fun part,it now have a mini http server,so why not put the setmac with the page...like<br/><a href="http://192.168.1.1/mac.html">http://192.168.1.1/mac.html</a></p><p>and with a index page-like welcome page in <br/><a href="http://192.168.1.1/index.html">http://192.168.1.1/index.html</a><br/>with here you can chooice what you like to do,</p></blockquote></div><p>If you need that kind of functionalities... you can add them by yourself. And don&#039;t forget to publish your sources! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile"/></p></blockquote></div><p>yep!cool!it&#039;s really cool mod,i always wonder why tp-link dont remove the tips&quot;no vaild address in flash&quot;.<br/>i add it to my todo list,http://see.sl088.com/wiki/WR703_Uboot_%E5%B8%A6Web%E7%9A%84Mod%E7%89%88%E6%9C%AC</p><p>i think mips should marge this to the web-failsafe project.it&#039;s a very great mod.<br/>(i problelly use too many cool,any way,cool mod and cool site.)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p204621">
				<div class="post-metadata">
					<div class="post-num">Post #86</div>
					<div class="post-author">pepe2k</div>
					<div class="post-datetime">
						14 Jun 2013, 15:20					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>slboat wrote:</cite><blockquote><p>yep!cool!it&#039;s really cool mod,i always wonder why tp-link dont remove the tips&quot;no vaild address in flash&quot;.<br/>i add it to my todo list,http://see.sl088.com/wiki/WR703_Uboot_%E5%B8%A6Web%E7%9A%84Mod%E7%89%88%E6%9C%AC</p></blockquote></div><p>&quot;no vaild address in flash&quot; information is hard coded, TP-Link version of U-Boot doesn&#039;t take MAC from FLASH. But, it doesn&#039;t matter, because it&#039;s only for U-Boot runtime, so you can use any valid MAC. My modification uses MAC from FLASH and has also option to change MAC address in FLASH in U-Boot command line.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p204637">
				<div class="post-metadata">
					<div class="post-num">Post #87</div>
					<div class="post-author">wwxsyf</div>
					<div class="post-datetime">
						14 Jun 2013, 18:55					</div>
				</div>
				<div class="post-content content">
					<p>Hi pepe2k:</p><p>Thank you for your busy schedule to reply me</p><br/><div class="quotebox"><cite>pepe2k wrote:</cite><blockquote><div class="quotebox"><cite>wwxsyf wrote:</cite><blockquote><p>I have a board TL-WR740N Ver:5.3 which has AR9331 Soc, the flash is Spantion FL032PIF,Manuf Id 0x1, DeviceId0 0x2, DeviceId1 0x15</p></blockquote></div><p>This model has only 16 MB RAM and 2 MB FLASH... it isn&#039;t supported by OpenWrt... buy something better.<br/>-&gt;Yes, the model only 2M Flash, I have replaced it with 4M flash which part number is Spantion FL032PIF</p><br/><div class="quotebox"><cite>wwxsyf wrote:</cite><blockquote><p>if using atheros defualt bootloader,the board can works, bellow is boot log.</p><p>[...]</p><p>But I replaced it with your bootloader uboot_for_wr740n_v4.bin which is downloaded from &quot;<a href="http://www.tech-blog.pl/pliki/u-boot_for_tp-link_AR9331_by_pepe2k.tar.gz">http://www.tech-blog.pl/pliki/u-boot_for_tp-link_AR9331_by_pepe2k.tar.gz</a>&quot;,the board cannot work, in other words, the board cannot boot again, I tried to restart the board many times,and found no any info at serial console.</p><p>Could you help to update the uboot which suppor the flash? thanrk you very much!</p></blockquote></div><p>This problem isn&#039;t related to FLASH chip type. This version of U-Boot can work with unrecognized chip too.<br/>I don&#039;t have this device so I can&#039;t check why it isn&#039;t working with my modification...<br/>-&gt;Got it, I will try to update the uboot again and check the results, thank you very much!</p><div class="quotebox"><cite>slboat wrote:</cite><blockquote><p>i was test this on wr703,but with write large flash chip,like 8mbyte,16mbyte,it&#039;s kind very slowly:( that&#039;s the kind good reason to mod the upload server on it.use tftp is very fast,but with this http sever(i think it has be called uip),is kind really slowly.</p></blockquote></div><p>Web server isn&#039;t a problem, uploading is as fast as in TFTP mode or even faster... Probably you don&#039;t know how NOR FLASH (and not only) works. If you want to save any data in FLASH you need to erase it first. So, firmware upgrade mode in this modification does 4 things, one by one: downloads firmware from browser to RAM, erases FLASH, copies firmware from RAM to FLASH and reboots the device.</p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p204830">
				<div class="post-metadata">
					<div class="post-num">Post #88</div>
					<div class="post-author">slboat</div>
					<div class="post-datetime">
						17 Jun 2013, 13:18					</div>
				</div>
				<div class="post-content content">
					<p>i make a full trying for this mod uboot,it&#039;s great,very fast,but not yet support the mx&#039;s 16m flash chip.<br/>and in the flash web page,i can go flash art page and uboot page,that&#039;s great.<br/>but it seems have a wired problem,sometimes the route doesnot start at all,(about 3times in 10 times),i test on tree route them are same problem,just plug in fast the power,and plug out fast.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p204832">
				<div class="post-metadata">
					<div class="post-num">Post #89</div>
					<div class="post-author">pepe2k</div>
					<div class="post-datetime">
						17 Jun 2013, 13:27					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>slboat wrote:</cite><blockquote><p>but it seems have a wired problem,sometimes the route doesnot start at all,(about 3times in 10 times),i test on tree route them are same problem,just plug in fast the power,and plug out fast.</p></blockquote></div><p>Read my previous posts very carefully... I know about this bug and I have already a solution - it will be added in next release.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p204834">
				<div class="post-metadata">
					<div class="post-num">Post #90</div>
					<div class="post-author">slboat</div>
					<div class="post-datetime">
						17 Jun 2013, 13:30					</div>
				</div>
				<div class="post-content content">
					<p>as i can see,if we plug out at this timeing:</p><br/><p>Hit any key to stop autobooting:&nbsp; 1 </p><p>it may case this problem</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p204835">
				<div class="post-metadata">
					<div class="post-num">Post #91</div>
					<div class="post-author">slboat</div>
					<div class="post-datetime">
						17 Jun 2013, 13:33					</div>
				</div>
				<div class="post-content content">
					<p>i not found the bug you talk about...my bad english not give me mush help:(</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p204837">
				<div class="post-metadata">
					<div class="post-num">Post #92</div>
					<div class="post-author">pepe2k</div>
					<div class="post-datetime">
						17 Jun 2013, 13:35					</div>
				</div>
				<div class="post-content content">
					<p>Please, just wait for new version... it will solve your problem.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p204838">
				<div class="post-metadata">
					<div class="post-num">Post #93</div>
					<div class="post-author">sevikcla</div>
					<div class="post-datetime">
						17 Jun 2013, 13:53					</div>
				</div>
				<div class="post-content content">
					<p>Hi fjorger! <br/>I&#039;ve manged to solve the wifi problem. However restoring the ART wasn&#039;t sufficient, i also needed to change the MAC-address from the UBOOT console. Changed from 65:51:7e:01:6e:4a&nbsp; -&gt; 64:51:7e:01:6e:4a.</p><p>How come that 65:.... isn&#039;t working but 64:... is?</p><p>Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p204839">
				<div class="post-metadata">
					<div class="post-num">Post #94</div>
					<div class="post-author">slboat</div>
					<div class="post-datetime">
						17 Jun 2013, 13:59					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>pepe2k wrote:</cite><blockquote><p>Just a small but very important notice: I found a bug in my project. So, if you want to use it, please wait for the next release which I&#039;m going to publish in next days.</p><p>In very rare cases (2 from 20 different routers) this bug may result in silent crash the U-Boot at PLL register setting stage (so it won&#039;t boot and a hardware reset is needed). This bug is not critical - it doesn&#039;t occur every time.</p><p>It took me couple of days to discover the reason and then test the solution.</p></blockquote></div><p>i found it:) it&#039;s same,i upload a video for it.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p204841">
				<div class="post-metadata">
					<div class="post-num">Post #95</div>
					<div class="post-author">fjorger</div>
					<div class="post-datetime">
						17 Jun 2013, 14:14					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>sevikcla wrote:</cite><blockquote><p>Hi fjorger! <br/>I&#039;ve manged to solve the wifi problem. However restoring the ART wasn&#039;t sufficient, i also needed to change the MAC-address from the UBOOT console. Changed from 65:51:7e:01:6e:4a&nbsp; -&gt; 64:51:7e:01:6e:4a.</p><p>How come that 65:.... isn&#039;t working but 64:... is?</p><p>Thanks!</p></blockquote></div><p>Hi sevikcla,</p><p>Glad you make it.<br/>About the wrong MAC, maybe the other &quot;65&quot; isn&#039;t valid?? Probably pepe2K knows why it happened!</p><p>Best Regards,</p><p>fjorger,</p>											<p class="post-edited">(Last edited by <strong>fjorger</strong> on 17 Jun 2013, 14:15)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p204842">
				<div class="post-metadata">
					<div class="post-num">Post #96</div>
					<div class="post-author">slboat</div>
					<div class="post-datetime">
						17 Jun 2013, 14:16					</div>
				</div>
				<div class="post-content content">
					<p>another problem<br/>&lt;code&gt;<br/>uboot&gt; <br/>bootargs=console=ttyS0,115200 root=31:02 rootfstype=squashfs init=/sbin/init mtdparts=ar7240-nor0:128k(u-boot),3904(firmware),64k(ART)<br/>bootcmd=bootm 0x9F020000<br/>bootdelay=1<br/>baudrate=115200<br/>ipaddr=192.168.1.1<br/>serverip=192.168.1.2<br/>stdin=serial<br/>stdout=serial<br/>stderr=serial<br/>ethact=eth0<br/>nc=setenv stdin nc;setenv stdout nc;setenv stderr nc;version;</p><p>Environment size: 343 bytes</p><p>uboot&gt; setenv serverip 192.168.2.100<br/>uboot&gt; tftpboot 0x81000000 tftpboot&#039; - try &#039;help&#039;<br/>## Error: unknown command &#039;<br/>uboot&gt; tftpboot 0x81000000 uboot_for_wr703n.bin<br/>Link down: eth1<br/>Ethernet mode (duplex/speed): 1/100 Mbps<br/>*** ERROR: `ethaddr&#039; not set<br/>Link down: eth1<br/>uboot&gt;<br/>&lt;/code&gt;<br/>it seems lost the ethaddr at defalut setting</p>											<p class="post-edited">(Last edited by <strong>slboat</strong> on 17 Jun 2013, 14:16)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p204844">
				<div class="post-metadata">
					<div class="post-num">Post #97</div>
					<div class="post-author">slboat</div>
					<div class="post-datetime">
						17 Jun 2013, 14:18					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>sevikcla wrote:</cite><blockquote><p>Hi pepe2k!<br/>I just installed your modified U-boot version on a&nbsp; <a href="http://v-solution.en.alibaba.com/product/747017376-218088660/WLM112_LAN_WAN_WLAN_WiFi_module.html">WLM113 module</a>, which should be almost identically to wr703n, according to the manufacturers. It works great except for the WIFI, when I run wifi from the cmd prompt I get <br/></p><div class="codebox"><pre><code>root@OpenWrt:~# wifi
Configuration file: /var/run/hostapd-phy0.conf
Could not set interface wlan0 flags (UP): Cannot assign requested address
nl80211: Could not set interface &#039;wlan0&#039; UP
nl80211 driver initialization failed.
Failed to start hostapd for phy0</code></pre></div><p>I have also tested the MR3020 version of the uboot and openwrt. Same issue.</p><p>Since I&#039;m a novice on openwrt it would be great if you could point me in the right direction on how to solve this.</p><p>Console dump<br/></p><div class="codebox"><pre><code>*****************************************
*      U-Boot 1.1.4  (Apr 22 2013)      *
*****************************************

AP121 (AR9331) U-Boot for TL-MR3020

DRAM:  32 MB
FLASH: Macronix MX25L320 (4 MB)

LED on during eth initialization...

## Error: MAC address stored in flash is invalid!
Using fixed address!
## Error: MAC address stored in flash is invalid!
Using fixed address!
Hit any key to stop autobooting:  0

Booting image at: 0x9F020000...
Uncompressing kernel image...
OK
Starting kernel...

[    0.000000] Linux version 3.3.8 (x@Ubuntu) (gcc version 4.6.4 20121001 (prerelease) (Linaro GCC 4.6-2012.10) ) #25 Thu Jun 13 12:32:06 CEST 2013
[    0.000000] bootconsole [early0] enabled
[    0.000000] CPU revision is: 00019374 (MIPS 24Kc)
[    0.000000] SoC: Atheros AR9330 rev 1
[    0.000000] Clocks: CPU:400.000MHz, DDR:400.000MHz, AHB:200.000MHz, Ref:25.000MHz
[    0.000000] Determined physical RAM map:
[    0.000000]  memory: 02000000 @ 00000000 (usable)
[    0.000000] Initrd not found or empty - disabling initrd
[    0.000000] Zone PFN ranges:
[    0.000000]   Normal   0x00000000 -&gt; 0x00002000
[    0.000000] Movable zone start PFN for each node
[    0.000000] Early memory PFN ranges
[    0.000000]     0: 0x00000000 -&gt; 0x00002000
[    0.000000] Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 8128
[    0.000000] Kernel command line:  board=TL-WR703N console=ttyATH0,115200 rootfstype=squashfs,jffs2 noinitrd
[    0.000000] PID hash table entries: 128 (order: -3, 512 bytes)
[    0.000000] Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
[    0.000000] Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
[    0.000000] Primary instruction cache 64kB, VIPT, 4-way, linesize 32 bytes.
[    0.000000] Primary data cache 32kB, 4-way, VIPT, cache aliases, linesize 32 bytes
[    0.000000] Writing ErrCtl register=00000000
[    0.000000] Readback ErrCtl register=00000000
[    0.000000] Memory: 29156k/32768k available (2084k kernel code, 3612k reserved, 397k data, 208k init, 0k highmem)
[    0.000000] SLUB: Genslabs=9, HWalign=32, Order=0-3, MinObjects=0, CPUs=1, Nodes=1
[    0.000000] NR_IRQS:51
[    0.000000] Calibrating delay loop... 265.42 BogoMIPS (lpj=1327104)
[    0.080000] pid_max: default: 32768 minimum: 301
[    0.080000] Mount-cache hash table entries: 512
[    0.090000] NET: Registered protocol family 16
[    0.090000] gpiochip_add: registered GPIOs 0 to 29 on device: ath79
[    0.100000] MIPS: machine is TP-LINK TL-WR703N v1
[    0.350000] bio: create slab &lt;bio-0&gt; at 0
[    0.360000] Switching to clocksource MIPS
[    0.360000] NET: Registered protocol family 2
[    0.370000] IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
[    0.370000] TCP established hash table entries: 1024 (order: 1, 8192 bytes)
[    0.370000] TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
[    0.380000] TCP: Hash tables configured (established 1024 bind 1024)
[    0.390000] TCP reno registered
[    0.390000] UDP hash table entries: 256 (order: 0, 4096 bytes)
[    0.400000] UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
[    0.400000] NET: Registered protocol family 1
[    0.430000] squashfs: version 4.0 (2009/01/31) Phillip Lougher
[    0.430000] JFFS2 version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006 Red Hat, Inc.
[    0.440000] msgmni has been set to 56
[    0.440000] io scheduler noop registered
[    0.450000] io scheduler deadline registered (default)
[    0.450000] Serial: 8250/16550 driver, 1 ports, IRQ sharing disabled
[    0.460000] ar933x-uart: ttyATH0 at MMIO 0x18020000 (irq = 11) is a AR933X UART
[    0.460000] console [ttyATH0] enabled, bootconsole disabled
[    0.460000] console [ttyATH0] enabled, bootconsole disabled
[    0.480000] m25p80 spi0.0: found mx25l3205d, expected m25p80
[    0.480000] m25p80 spi0.0: mx25l3205d (4096 Kbytes)
[    0.490000] 5 tp-link partitions found on MTD device spi0.0
[    0.490000] Creating 5 MTD partitions on &quot;spi0.0&quot;:
[    0.500000] 0x000000000000-0x000000020000 : &quot;u-boot&quot;
[    0.510000] 0x000000020000-0x0000000fe404 : &quot;kernel&quot;
[    0.510000] mtd: partition &quot;kernel&quot; must either start or end on erase block boundary or be smaller than an erase block -- forcing read-only
[    0.520000] 0x0000000fe404-0x0000003f0000 : &quot;rootfs&quot;
[    0.530000] mtd: partition &quot;rootfs&quot; must either start or end on erase block boundary or be smaller than an erase block -- forcing read-only
[    0.540000] mtd: partition &quot;rootfs&quot; set to be root filesystem
[    0.550000] mtd: partition &quot;rootfs_data&quot; created automatically, ofs=370000, len=80000
[    0.550000] 0x000000370000-0x0000003f0000 : &quot;rootfs_data&quot;
[    0.560000] 0x0000003f0000-0x000000400000 : &quot;art&quot;
[    0.570000] 0x000000020000-0x0000003f0000 : &quot;firmware&quot;
[    0.590000] ag71xx_mdio: probed
[    0.590000] eth0: Atheros AG71xx at 0xb9000000, irq 4
[    1.150000] ag71xx ag71xx.0: eth0: connected to PHY at ag71xx-mdio.1:04 [uid=004dd041, driver=Generic PHY]
[    1.160000] TCP cubic registered
[    1.160000] NET: Registered protocol family 17
[    1.160000] 8021q: 802.1Q VLAN Support v1.8
[    1.170000] VFS: Mounted root (squashfs filesystem) readonly on device 31:2.
[    1.180000] Freeing unused kernel memory: 208k freed
- preinit -
Press the [f] key and hit [enter] to enter failsafe mode
- regular preinit -
[    6.560000] JFFS2 notice: (404) jffs2_build_xattr_subsystem: complete building xattr subsystem, 1 of xdatum (0 unchecked, 0 orphan) and 12 of xref (0 dead, 2 orphan) found.
switching to jffs2
- init -

Please press Enter to activate this console. [    8.390000] Compat-drivers backport release: compat-drivers-2012-09-04-2-gddac993
[    8.390000] Backport based on wireless-testing.git master-2012-09-07
[    8.400000] compat.git: wireless-testing.git
[    8.430000] cfg80211: Calling CRDA to update world regulatory domain
[    8.440000] cfg80211: World regulatory domain updated:
[    8.440000] cfg80211:   (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp)
[    8.450000] cfg80211:   (2402000 KHz - 2472000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
[    8.460000] cfg80211:   (2457000 KHz - 2482000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
[    8.460000] cfg80211:   (2474000 KHz - 2494000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
[    8.470000] cfg80211:   (5170000 KHz - 5250000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
[    8.480000] cfg80211:   (5735000 KHz - 5835000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
[    8.720000] SCSI subsystem initialized
[    8.860000] usbcore: registered new interface driver usbfs
[    8.860000] usbcore: registered new interface driver hub
[    8.870000] usbcore: registered new device driver usb
[    9.350000] ieee80211 phy0: Atheros AR9330 Rev:1 mem=0xb8100000, irq=2
[    9.350000] cfg80211: Calling CRDA for country: US
[    9.360000] cfg80211: Regulatory domain changed to country: US
[    9.360000] cfg80211:   (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp)
[    9.370000] cfg80211:   (2402000 KHz - 2472000 KHz @ 40000 KHz), (300 mBi, 2700 mBm)
[    9.380000] cfg80211:   (5170000 KHz - 5250000 KHz @ 40000 KHz), (300 mBi, 1700 mBm)
[    9.390000] cfg80211:   (5250000 KHz - 5330000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
[    9.390000] cfg80211:   (5490000 KHz - 5600000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
[    9.400000] cfg80211:   (5650000 KHz - 5710000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
[    9.410000] cfg80211:   (5735000 KHz - 5835000 KHz @ 40000 KHz), (300 mBi, 3000 mBm)
[    9.840000] PPP generic driver version 2.4.2
[    9.890000] ip_tables: (C) 2000-2006 Netfilter Core Team
[   10.010000] NET: Registered protocol family 24
[   10.040000] ehci_hcd: USB 2.0 &#039;Enhanced&#039; Host Controller (EHCI) Driver
[   10.050000] ehci-platform ehci-platform: Generic Platform EHCI Controller
[   10.050000] ehci-platform ehci-platform: new USB bus registered, assigned bus number 1
[   10.090000] ehci-platform ehci-platform: irq 3, io mem 0x1b000000
[   10.110000] ehci-platform ehci-platform: USB 2.0 started, EHCI 1.00
[   10.110000] hub 1-0:1.0: USB hub found
[   10.110000] hub 1-0:1.0: 1 port detected
[   10.140000] nf_conntrack version 0.5.0 (458 buckets, 1832 max)</code></pre></div></blockquote></div><br/><p>it may seems you have two wifi interface in it.</p><p>and it have two mac address maybe...do you try reset all the setting to default?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p204845">
				<div class="post-metadata">
					<div class="post-num">Post #98</div>
					<div class="post-author">slboat</div>
					<div class="post-datetime">
						17 Jun 2013, 14:18					</div>
				</div>
				<div class="post-content content">
					<p>and if you dont wana reset,you may try this</p><p> rm -f /etc/config/wireless; wifi detect &gt; /etc/config/wireless</p><p>it happen to me,if replace the mac address in the uboot <br/><span class="postimg"><img src="http://see.sl088.com/w/images/b/b4/JustCapIt4805.jpg" alt="http://see.sl088.com/w/images/b/b4/JustCapIt4805.jpg"/></span></p>											<p class="post-edited">(Last edited by <strong>slboat</strong> on 17 Jun 2013, 14:19)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p204846">
				<div class="post-metadata">
					<div class="post-num">Post #99</div>
					<div class="post-author">pepe2k</div>
					<div class="post-datetime">
						17 Jun 2013, 14:18					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>slboat wrote:</cite><blockquote><p>another problem [...]</p></blockquote></div><p>Try to set ethaddr in U-Boot env.</p><p>And PLEASE, use &quot;Edit&quot; in your posts!</p>											<p class="post-edited">(Last edited by <strong>pepe2k</strong> on 17 Jun 2013, 14:19)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p204847">
				<div class="post-metadata">
					<div class="post-num">Post #100</div>
					<div class="post-author">slboat</div>
					<div class="post-datetime">
						17 Jun 2013, 14:20					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>pepe2k wrote:</cite><blockquote><div class="quotebox"><cite>slboat wrote:</cite><blockquote><p>another problem [...]</p></blockquote></div><p>Try to set ethaddr in U-Boot env.</p><p>And PLEASE, use &quot;Edit&quot; in your posts!</p></blockquote></div><p>i see it work,but you may put it in the default setting,the orgin version is use ipaddr not use ethaddr.</p><p>uboot&gt; setenv ethaddr 192.168.2.1<br/>uboot&gt; tftpboot 0x81000000 uboot_for_wr703n.bin<br/>Link down: eth1<br/>Using eth0 device<br/>TFTP from server 192.168.2.100; our IP address is 192.168.2.1<br/>Filename &#039;uboot_for_wr703n.bin&#039;.<br/>Load address: 0x81000000</p>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 4 of 25</div><nav><ul><li><a href="viewtopic.php%3Fid=43237&amp;p=1.html">1</a></li><li><a href="viewtopic.php%3Fid=43237&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=43237&amp;p=3.html">3</a></li><li class="pagination-current"><span>4</span></li><li><a href="viewtopic.php%3Fid=43237&amp;p=5.html">5</a></li><li><a href="viewtopic.php%3Fid=43237&amp;p=6.html">6</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=43237&amp;p=25.html">25</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>