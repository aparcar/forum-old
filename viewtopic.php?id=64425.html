<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> 3G wan connection problem</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 6 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p321173">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">sowmyabr</div>
					<div class="post-datetime">
						25 Apr 2016, 10:00					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>I am working on SOM9331 openwrt Chaos calmer version and installed packages required for 3g data communication as mentioned here:<a href="https://wiki.openwrt.org/doc/recipes/3gdongle">https://wiki.openwrt.org/doc/recipes/3gdongle</a>.</p><p>I am using N703 3g modem from Neoway. Currently I have added basic commands to check pin insertion, SIM registration. Here is the chat script:<br /></p><div class="codebox"><pre><code>ABORT   BUSY
ABORT   &#039;NO CARRIER&#039;
ABORT   ERROR
REPORT  CONNECT
TIMEOUT 20
&quot;&quot; &quot;ATI&quot;
TIMEOUT 10
OK      &quot;AT+CPIN?&quot;
TIMEOUT 10
OK      &quot;AT+CREG?&quot;
TIMEOUT 10
OK      &quot;AT+CSQ&quot;
TIMEOUT 10
OK      &quot;AT+XIIC=1&quot;
TIMEOUT 15
OK</code></pre></div><p>Added wan interface in network configuration and upon exection of <em>ifup wan</em>, the chat script is restarting after execution of all commands.<br />Here is the logread output:<br /></p><div class="codebox"><pre><code>Sat Apr 23 13:50:11 2016 daemon.notice netifd: Interface &#039;wan&#039; is setting up now
Sat Apr 23 13:50:13 2016 daemon.notice pppd[5166]: pppd 2.4.7 started by root, uid 0
Sat Apr 23 13:50:13 2016 daemon.notice pppd[5166]: Removed stale lock on ttyUSB2 (pid 4883)
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: abort on (BUSY)
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: abort on (NO CARRIER)
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: abort on (ERROR)
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: report (CONNECT)
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: timeout set to 20 seconds
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: send (ATI^M)
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: timeout set to 10 seconds
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: expect (OK)
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: ATI^M^M
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: NEOWAY^M
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: N703^M
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: V501^M
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: OK
Sat Apr 23 13:50:14 2016 local2.info chat[5168]:  -- got it
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: send (AT+CPIN?^M)
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: timeout set to 10 seconds
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: expect (OK)
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: ^M
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: AT+CPIN?^M^M
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: +CPIN: READY^M
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: ^M
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: OK
Sat Apr 23 13:50:14 2016 local2.info chat[5168]:  -- got it
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: send (AT+CREG?^M)
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: timeout set to 10 seconds
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: expect (OK)
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: ^M
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: AT+CREG?^M^M
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: +CREG: 0,1^M
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: ^M
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: OK
Sat Apr 23 13:50:14 2016 local2.info chat[5168]:  -- got it
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: send (AT+CSQ^M)
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: timeout set to 10 seconds
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: expect (OK)
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: ^M
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: AT+CSQ^M^M
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: +CSQ: 19,99^M
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: ^M
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: OK
Sat Apr 23 13:50:14 2016 local2.info chat[5168]:  -- got it
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: send (AT+XIIC=1^M)
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: timeout set to 15 seconds
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: expect (OK)
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: ^M
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: AT+XIIC=1^M^M
Sat Apr 23 13:50:14 2016 local2.info chat[5168]: OK
Sat Apr 23 13:50:14 2016 local2.info chat[5168]:  -- got it
Sat Apr 23 13:50:14 2016 daemon.info pppd[5166]: Serial connection established.
Sat Apr 23 13:50:14 2016 kern.info kernel: [ 1157.630000] 3g-wan: renamed from ppp0
Sat Apr 23 13:50:14 2016 daemon.info pppd[5166]: Using interface 3g-wan
Sat Apr 23 13:50:14 2016 daemon.notice pppd[5166]: Connect: 3g-wan &lt;--&gt; /dev/ttyUSB2
Sat Apr 23 13:50:45 2016 daemon.warn pppd[5166]: LCP: timeout sending Config-Requests
Sat Apr 23 13:50:45 2016 daemon.notice pppd[5166]: Connection terminated.
Sat Apr 23 13:50:45 2016 daemon.warn pppd[5166]: Receive serial link is not 8-bit clean:
Sat Apr 23 13:50:45 2016 daemon.warn pppd[5166]: Problem: all had bit 7 set to 0
Sat Apr 23 13:50:46 2016 daemon.notice pppd[5166]: Modem hangup
Sat Apr 23 13:50:46 2016 daemon.info pppd[5166]: Exit.
Sat Apr 23 13:50:46 2016 daemon.notice netifd: Interface &#039;wan&#039; is now down
Sat Apr 23 13:50:46 2016 daemon.notice netifd: Interface &#039;wan&#039; is setting up now
Sat Apr 23 13:50:48 2016 daemon.notice pppd[5218]: pppd 2.4.7 started by root, uid 0
Sat Apr 23 13:50:49 2016 local2.info chat[5220]: abort on (BUSY)
Sat Apr 23 13:50:49 2016 local2.info chat[5220]: abort on (NO CARRIER)
Sat Apr 23 13:50:49 2016 local2.info chat[5220]: abort on (ERROR)
Sat Apr 23 13:50:49 2016 local2.info chat[5220]: report (CONNECT)
Sat Apr 23 13:50:49 2016 local2.info chat[5220]: timeout set to 20 seconds
Sat Apr 23 13:50:49 2016 local2.info chat[5220]: send (ATI^M)
Sat Apr 23 13:50:49 2016 local2.info chat[5220]: timeout set to 10 seconds
Sat Apr 23 13:50:49 2016 local2.info chat[5220]: expect (OK)
Sat Apr 23 13:50:49 2016 local2.info chat[5220]: ATI^M^M
Sat Apr 23 13:50:49 2016 local2.info chat[5220]: NEOWAY^M
Sat Apr 23 13:50:49 2016 local2.info chat[5220]: N703^M
Sat Apr 23 13:50:49 2016 local2.info chat[5220]: V501^M
Sat Apr 23 13:50:49 2016 local2.info chat[5220]: OK
Sat Apr 23 13:50:49 2016 local2.info chat[5220]:  -- got it
Sat Apr 23 13:50:49 2016 local2.info chat[5220]: send (AT+CPIN?^M)
Sat Apr 23 13:50:49 2016 local2.info chat[5220]: timeout set to 10 seconds
Sat Apr 23 13:50:49 2016 local2.info chat[5220]: expect (OK)
Sat Apr 23 13:50:49 2016 local2.info chat[5220]: ^M
Sat Apr 23 13:50:49 2016 local2.info chat[5220]: AT+CPIN?^M^M
Sat Apr 23 13:50:49 2016 local2.info chat[5220]: +CPIN: READY^M
Sat Apr 23 13:50:49 2016 local2.info chat[5220]: ^M
Sat Apr 23 13:50:49 2016 local2.info chat[5220]: OK
Sat Apr 23 13:50:49 2016 local2.info chat[5220]:  -- got it
Sat Apr 23 13:50:49 2016 local2.info chat[5220]: send (AT+CREG?^M)
Sat Apr 23 13:50:50 2016 local2.info chat[5220]: timeout set to 10 seconds
Sat Apr 23 13:50:50 2016 local2.info chat[5220]: expect (OK)
Sat Apr 23 13:50:50 2016 local2.info chat[5220]: ^M
Sat Apr 23 13:50:50 2016 local2.info chat[5220]: AT+CREG?^M^M
Sat Apr 23 13:50:50 2016 local2.info chat[5220]: +CREG: 0,1^M
Sat Apr 23 13:50:50 2016 local2.info chat[5220]: ^M
Sat Apr 23 13:50:50 2016 local2.info chat[5220]: OK
Sat Apr 23 13:50:50 2016 local2.info chat[5220]:  -- got it
Sat Apr 23 13:50:50 2016 local2.info chat[5220]: send (AT+CSQ^M)
Sat Apr 23 13:50:50 2016 local2.info chat[5220]: timeout set to 10 seconds
Sat Apr 23 13:50:50 2016 local2.info chat[5220]: expect (OK)
Sat Apr 23 13:50:50 2016 local2.info chat[5220]: ^M
Sat Apr 23 13:50:50 2016 local2.info chat[5220]: AT+CSQ^M^M
Sat Apr 23 13:50:50 2016 local2.info chat[5220]: +CSQ: 19,99^M
Sat Apr 23 13:50:50 2016 local2.info chat[5220]: ^M
Sat Apr 23 13:50:50 2016 local2.info chat[5220]: OK
Sat Apr 23 13:50:50 2016 local2.info chat[5220]:  -- got it
Sat Apr 23 13:50:50 2016 local2.info chat[5220]: send (AT+XIIC=1^M)
Sat Apr 23 13:50:50 2016 local2.info chat[5220]: timeout set to 15 seconds
Sat Apr 23 13:50:50 2016 local2.info chat[5220]: expect (OK)
Sat Apr 23 13:50:50 2016 local2.info chat[5220]: ^M
Sat Apr 23 13:50:50 2016 local2.info chat[5220]: AT+XIIC=1^M^M
Sat Apr 23 13:50:50 2016 local2.info chat[5220]: +CME ERROR
Sat Apr 23 13:50:50 2016 local2.info chat[5220]:  -- failed
Sat Apr 23 13:50:50 2016 local2.info chat[5220]: Failed (ERROR)
Sat Apr 23 13:50:50 2016 daemon.err pppd[5218]: Connect script failed
Sat Apr 23 13:50:51 2016 daemon.info pppd[5218]: Exit.
Sat Apr 23 13:50:51 2016 daemon.notice netifd: Interface &#039;wan&#039; is now down
Sat Apr 23 13:50:51 2016 daemon.notice netifd: Interface &#039;wan&#039; is setting up now
Sat Apr 23 13:50:53 2016 daemon.notice pppd[5240]: pppd 2.4.7 started by root, uid 0</code></pre></div><p>Can anyone help me the cause for the restarting of the chatscript and how to disable it?</p><p>Regards,<br />Sowmya</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>