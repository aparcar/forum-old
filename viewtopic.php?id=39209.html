<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> I&#039;m an idiot - help</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 27 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p177346">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Skaboy607</div>
					<div class="post-datetime">
						8 Sep 2012, 02:08					</div>
				</div>
				<div class="post-content content">
					<p>I installed openwrt on my new wr1043nd and was configuring the LAN, I I putted my settings but it didn&#039;t work so then I changed the address type type from static to dhcp which was silly because now I can&#039;t access the router. </p><p>From reading, I kind of understand what I&#039;ve done and why it&#039;s wrong but not sure how to fix?</p><p>Any help please?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p177348">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">slh</div>
					<div class="post-datetime">
						8 Sep 2012, 02:17					</div>
				</div>
				<div class="post-content content">
					<p><a href="http://wiki.openwrt.org/toh/tp-link/tl-wr1043nd#failsafe.mode">http://wiki.openwrt.org/toh/tp-link/tl- … lsafe.mode</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p177704">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Skaboy607</div>
					<div class="post-datetime">
						11 Sep 2012, 00:12					</div>
				</div>
				<div class="post-content content">
					<p>This didn&#039;t work, when I try to telnet in, the CMD window just closes?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p177713">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Skaboy607</div>
					<div class="post-datetime">
						11 Sep 2012, 01:30					</div>
				</div>
				<div class="post-content content">
					<p>Ok, with a lot more trying, I have got somewhere.........I was able to telnet to the router and was following the instructions here</p><p><a href="http://wiki.openwrt.org/doc/howto/generic.failsafe#in.failsafe.mode">http://wiki.openwrt.org/doc/howto/gener … lsafe.mode</a></p><p>I tried typing &#039;uci get network.lan.ipaddr&#039; at the prompt &#039;root@(none):/#&#039; but it says it is an invalid command.</p><p>So I found this post</p><p><a href="https://forum.openwrt.org/viewtopic.php?pid=160914#p160914">https://forum.openwrt.org/viewtopic.php … 14#p160914</a></p><p>and used the command &#039;cat /etc/config/network&#039;</p><p>and got the following results</p><p>config &#039;interface&#039; &#039;loopback&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ifname&#039; &#039;lo&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;proto&#039; &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ipaddr&#039; &#039;127.0.0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;netmask&#039; &#039;255.0.0.0&#039;</p><p>config &#039;interface&#039; &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ifname&#039; &#039;eth0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;type&#039; &#039;bridge&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;defaultroute&#039; &#039;0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;peerdns&#039; &#039;0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;dns&#039; &#039;192.164.1.254&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;proto&#039; &#039;dhcp&#039;</p><p>config &#039;interface&#039; &#039;wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ifname&#039; &#039;eth0.2&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;proto&#039; &#039;dhcp&#039;</p><p>config &#039;switch&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;name&#039; &#039;rtl8366rb&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;reset&#039; &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;enable_vlan&#039; &#039;1&#039;</p><p>config &#039;switch_vlan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;device&#039; &#039;rtl8366rb&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;vlan&#039; &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ports&#039; &#039;1 2 3 4 5t&#039;</p><p>config &#039;switch_vlan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;device&#039; &#039;rtl8366rb&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;vlan&#039; &#039;2&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ports&#039; &#039;0 5t&#039;</p><p>I&#039;ve tried both the two ip address provided at the top, i.e. 192.168.1.254 and 127.0.0.1 but both of them come up with error loading page.</p><p>I made some progress but now I am stuck!</p><p>Thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p177728">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">gsenna</div>
					<div class="post-datetime">
						11 Sep 2012, 05:42					</div>
				</div>
				<div class="post-content content">
					<p>Hi,<br />Do you know how to use &#039;vi&#039; editor?<br />You could go into failsafe mode, do &#039;mount_root&#039; and then &#039;vi /etc/config/network&#039;. Then edit interface lan&#039;s proto option to &#039;static&#039; and add &#039;option ipaddr (your-desired-ip)&#039;.<br />By the way, vi is not very intuitive so maybe search for a tutorial with the basics first.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p177729">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">gsenna</div>
					<div class="post-datetime">
						11 Sep 2012, 05:46					</div>
				</div>
				<div class="post-content content">
					<p>The lan interface part should look like this:<br /></p><div class="codebox"><pre><code>config &#039;interface&#039; &#039;lan&#039;
        option &#039;ifname&#039; &#039;eth0.1&#039;
        option &#039;type&#039; &#039;bridge&#039;
        option &#039;proto&#039; &#039;static&#039;
        option &#039;netmask&#039; &#039;255.255.255.0&#039;
        option &#039;ipaddr&#039; &#039;192.168.1.1&#039;</code></pre></div><p>That would give router the 192.168.1.1 ip address.</p>											<p class="post-edited">(Last edited by <strong>gsenna</strong> on 11 Sep 2012, 05:47)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p177755">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">Skaboy607</div>
					<div class="post-datetime">
						11 Sep 2012, 11:29					</div>
				</div>
				<div class="post-content content">
					<p>I see the problem, the router has no IP!</p><p>If use the command &#039;firstboot&#039; or &#039;mtd -r erase rootfs_data&#039;, will it restore it back to openwrt factory defaults, i.e. a static ip?</p><p>Another idea.....it&#039;s setup to be dhcp, so if I plug TP-link router into a current working router that is handing out IP&#039;s, it will be assigned one and then I can access it?</p><p>Is that right?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p177801">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">dabyd64</div>
					<div class="post-datetime">
						11 Sep 2012, 17:34					</div>
				</div>
				<div class="post-content content">
					<p>Just add that &quot;option ipaddr 192.168.1.1&quot; under lan , save and reboot. <br />How to use vi editor:<br /><a href="https://forum.openwrt.org/viewtopic.php?id=39077">https://forum.openwrt.org/viewtopic.php?id=39077</a><br />At the end of the first post.</p><p>If you don&#039;t have any complex config, do the <strong>mtd-r erase rootfs_data</strong> and start again! It will return to the stock configs, the router ip will be 192.168.1.1</p>											<p class="post-edited">(Last edited by <strong>dabyd64</strong> on 11 Sep 2012, 17:40)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p177927">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">Skaboy607</div>
					<div class="post-datetime">
						12 Sep 2012, 14:37					</div>
				</div>
				<div class="post-content content">
					<p>Got it all sorted, thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p177952">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">robthebrew</div>
					<div class="post-datetime">
						12 Sep 2012, 17:17					</div>
				</div>
				<div class="post-content content">
					<p>Skaboy607, can you write up how you fixed the issue in &quot;idiot-proof&quot; language (maybe with screenshots) so other &quot;idiots&quot; who I would like to call novices, can fix their problems too? Saves much searching, and can be incorporated in the WiKi.<br />Thanks, and have fun.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>