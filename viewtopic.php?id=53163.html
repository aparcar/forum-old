<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> SMStools compiled for Barrier Breaker</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 23 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p249454">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">jabss</div>
					<div class="post-datetime">
						6 Oct 2014, 23:52					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>I&#039;ve successfully compiled SMStools (<a href="http://smstools3.kekekasvi.com">http://smstools3.kekekasvi.com</a>) for Barrier Breaker.<br />I believe it would be quite beneficial for the OpenWRT Community to include it in the available packages.</p><p>I&#039;m not a professional coder (actually I spent quite some time doing cut n&#039; paste from the Internet in order to get it working) so I&#039;m not familiar with the process of adding packages to a development tree.</p><p>I&#039;m available to share everything (Makefile, patches, code, directory structure, etc.) with anyone that would know how to add it correctly to the repositories.</p><p>Just reply me back.</p><p>Thanks<br />Jabss</p>											<p class="post-edited">(Last edited by <strong>jabss</strong> on 7 Oct 2014, 00:11)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p249527">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Straitvodka</div>
					<div class="post-datetime">
						7 Oct 2014, 12:36					</div>
				</div>
				<div class="post-content content">
					<p>Looks interesting <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Maybe a friend of mine would be interested in this, his name is Dairyman.</p><p>As you can see we have already setup SMS to work with openwrt and we have been working on a new them (new look) for Luci also. We have not set SMS up as a package but rather Dairyman has programmed the sms tool into the openwrt scripts.</p><p>We have had this running for some 6 months now i guess, Cobia recently created a tool to create packages and so now our ROOTER firmware scripts can be included as a package for compilation into the final image. Im not sure if Dairyman would be interested in a standalone sms package but I am sure many other would as it allows more customisation.</p><p>Have a look at this photo of my setup in Luci:</p><p><a href="http://s10.postimg.org/hglnjcy21/sms.jpg">http://s10.postimg.org/hglnjcy21/sms.jpg</a></p><p>Here is our somewhat dated website:</p><p><a href="http://ofmodemsandmen.com/">http://ofmodemsandmen.com/</a></p><p>O just so you know we are in no way Openwrt developers. Just a bunch of farmers.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p252813">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">jensk</div>
					<div class="post-datetime">
						2 Nov 2014, 09:24					</div>
				</div>
				<div class="post-content content">
					<p>Hi Jabss,</p><p>would you mind sharing what you have? I was just about to start doing exactly the same thing when I found this post <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Cheers,<br />Jens</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p253198">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">fendant</div>
					<div class="post-datetime">
						5 Nov 2014, 16:19					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m also really interested in integrating the SMS tools on my custom Openwrt build for Alix.&nbsp; Can you share?<br />You might be interested that I am working to get FrontlineSMS running (which needs a working 1.6 jvm) on Barrier Breaker (on x86 for now, but probably on Pi to with Arm based jvm).&nbsp; &nbsp;I&#039;m happy to share this work too once it&#039;s working <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p253619">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">jabss</div>
					<div class="post-datetime">
						8 Nov 2014, 15:37					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>I can share the build folder with a working structure so you can build on your own binary.<br />(I think it&#039;s always preferable to get a build structure rather than having just the binary because of security reasons - you never know what is compiled within).</p><p>I&#039;ll put everything in a tar file and share it temporarily somewhere in the net. Stay tuned.</p><p>Will you then be knowlegeable enough to add it to the openwrt repository so everybody could benefit of it?</p><p>Cheers,<br />Jabss</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p253651">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">jabss</div>
					<div class="post-datetime">
						8 Nov 2014, 20:58					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>As promised,here you have a guide that shows:</p><p><strong>How to compile SMStools3 for OpenWRT - Tested with Barrier Breaker </strong></p><p>1) Create a build root environment as described here: <a href="http://wiki.openwrt.org/doc/howto/buildroot.exigence">http://wiki.openwrt.org/doc/howto/buildroot.exigence</a><br />&nbsp; &nbsp; &nbsp;I used a Ubuntu PC to do it </p><p>2)&nbsp; Extract <a href="https://db.tt/9mw1h1RX">this file</a> to the package/utils directory. The Makefiles and the directory structure is the correct one.<br />&nbsp; &nbsp; &nbsp;After this, you should have the following directory structure:</p><div class="codebox"><pre><code>xxx@xxx:(your-build-root-path)$ ls -R
.:
files Makefile package.sh patches src

./files:
examples scripts

./files/examples:
language-ISO-8859-15.fi operator_logo1.sms README received_sms.sms send_sms_unicode.sms smsd.conf.full smsd.conf.non-root
language-UTF-8.fi operator_logo2.sms received_report.sms send_sms.sms smsd.conf.easy smsd.conf.net

./files/scripts:
callhandler email2sms eventhandler-utf-8 hex2bin load_balancing.sh pkill regular_run sms2html sms2xml smsevent smstest.php unicode2sms
checkhandler-utf-8 eventhandler_report forwardsms hex2dec mysmsd README sendsms sms2unicode sms3 smsresend sql_demo

./patches:
001-smsd.patch 010-makefile.patch

./src:
alarm.c blacklist.c cfgfile.c charset.c extras.c locking.c logging.c Makefile modeminit.h pdu.h smsd_cfg.c stats.c version.h whitelist.h
alarm.h blacklist.h cfgfile.h charset.h extras.h locking.h logging.h modeminit.c pdu.c smsd.c smsd_cfg.h stats.h whitelist.c</code></pre></div><p>3) Go to the builroot root directory and run make menuconfig. You&#039;ll find the smstools3 option under utilities. Select it, and exit menuconfig.<br />&nbsp; &nbsp; Note that you may also need to select the correct architecture for your router. My router is a TL-WR1043N/ND so I had to select ar71xx in &quot;make menuconfig&quot;. </p><p>4) Run make, and wait for some time (hours) to have all of it compiled.<br />5)You should find the installation package here: (your-build-root-path)/openwrt/bin/ar71xx/packages/base/smstools3_3.1.15-2_ar71xx.ipk<br />If you didn&#039;t want/weren&#039;t able to compile and trust pre-compiled binaries (I won&#039;t advise it) here you have the <a href="https://db.tt/ZThek8ml">compiled installation file</a> ready to install on a TL-1043ND</p><p>6) Copy this file to your router and install it with &quot;opkg install smstools3_3.1.15-2_ar71xx.ipk&quot;<br />I realised that running SMSTools3 as daemon was having some problems creating the log directories, and therefore fails to start, but if created&nbsp; manually it works.<br />Because of this, I created a workaround that works fine:</p><p>7) Create a file named /bin/smstools_wrapper and copy the code below to it:<br /></p><div class="codebox"><pre><code>#!/bin/sh
#Wrapper - creates the directories and log files before starting
# as it seems they arent saved during reboots
mkdir /var/log/smsd_stats
mkdir /var/spool/sms
mkdir /var/spool/sms/outgoing
mkdir /var/spool/sms/failed
mkdir /var/spool/sms/incoming
mkdir /var/spool/sms/checked
mkdir /var/spool/sms/sent
mkdir /var/run/smstools
#calls smsd
/usr/bin/smsd</code></pre></div><p>8) In order to have it started automatically add &quot;/bin/smstools_wrapper&quot; to the file /etc/rc.local</p><p>And that&#039;s it! After these steps you should have a SMSTools3 daemon running in your OpenWRT router.</p><p>Note that you&#039;ll need to fill in the configuration file in order to match your SMS device, like you would do in any other linux box.<br />I add my config file just for reference.&nbsp; It works on an Huawei USB stick.<br /></p><div class="codebox"><pre><code>root@Mojito:~# cat /etc/smsd.conf | grep -v &quot;#&quot;
devices = GSM1
outgoing = /var/spool/sms/outgoing
checked = /var/spool/sms/checked
incoming = /var/spool/sms/incoming
logfile = /var/log/smsd.log
infofile = /var/run/smstools/smsd.working
pidfile = /var/run/smstools/smsd.pid
outgoing = /var/spool/sms/outgoing
checked = /var/spool/sms/checked
failed = /var/spool/sms/failed
incoming = /var/spool/sms/incoming
sent = /var/spool/sms/sent
stats = /var/log/smsd_stats
receive_before_send = no
autosplit = 3
eventhandler = /bin/sms-received

[GSM1]
device = /dev/ttyUSB1
incoming = yes
baudrate = 9600</code></pre></div><p><strong>Can anyone be able to add this to the OpenWRT repositories so everyone could benefit from it?</strong></p><p>Thanks and good luck!<br />Jabss</p>											<p class="post-edited">(Last edited by <strong>jabss</strong> on 8 Nov 2014, 21:19)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p257845">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">cindy.wijaya</div>
					<div class="post-datetime">
						16 Dec 2014, 06:03					</div>
				</div>
				<div class="post-content content">
					<p>Thanks Jabss,</p><p>Great Job!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p257930">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">suckerz</div>
					<div class="post-datetime">
						17 Dec 2014, 04:35					</div>
				</div>
				<div class="post-content content">
					<p>mantabs</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p258028">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">ahmad123</div>
					<div class="post-datetime">
						18 Dec 2014, 07:06					</div>
				</div>
				<div class="post-content content">
					<p>Jabbs, I try to compile using your tutorial but failed. I am using Attitude Adjustment. Is there any correction should be made in the makefile ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p258503">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">drEagle</div>
					<div class="post-datetime">
						23 Dec 2014, 17:05					</div>
				</div>
				<div class="post-content content">
					<p>updated, fixed and proposed upsream.<br />see : <a href="https://github.com/openwrt/packages/pull/694">https://github.com/openwrt/packages/pull/694</a></p><div class="quotebox"><blockquote><p>Tested successfull as an email/sms gateway with :<br />- Device: ID 12d1:1001 Huawei Technologies Co., Ltd. E169/E620/E800 HSDPA Modem<br />- Trunk: OpenWrt Chaos Calmer r43753<br />- Kirkwood : Globalscale Technologies Guruplug Server Plus</p><p>Send and receive SMS with modem : OK<br />Forward received SMS to mailhub : OK</p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p277703">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">pingo</div>
					<div class="post-datetime">
						27 May 2015, 15:19					</div>
				</div>
				<div class="post-content content">
					<p>jabss great job with the instructions and preparing the source</p><p>/usr/bin/sendsms did not work for me (could not find bash and after changing to sh I was getting seg faults)</p><p>But doing&nbsp; printf &quot;To: 38611111111\n\nHello world!&quot; &gt; /var/spool/sms/outgoing/some_random_name worked fine.</p>											<p class="post-edited">(Last edited by <strong>pingo</strong> on 28 May 2015, 11:20)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>