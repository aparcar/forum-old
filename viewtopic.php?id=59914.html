<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Recover: Ralink RT3052   id:1 rev:3</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 19 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p293540">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">SethuM</div>
					<div class="post-datetime">
						26 Sep 2015, 14:59					</div>
				</div>
				<div class="post-content content">
					<p>Hello All!!</p><p>I&#039;m new to OpenWRT and Embeded systems.</p><p>I&#039;m having &quot;Ralink RT3052&nbsp; &nbsp;id:1 rev:3&quot; box with U-Boot 1.1.3. I was trying to install OpenWRT latest image on it via Console.</p><br /><p>I&#039;ve TFTP Server in CentOS, and working fine with IP 192.168.1.100. I was trying to use &quot;9&quot; apperantly the attempt was not successful. Please see below logs from console.</p><p>####&nbsp; &nbsp;9: Load Boot Loader code then write to Flash via TFTP.&nbsp; ####</p><br /><p>Minicom(Serial) Config:<br />Serial Device&nbsp; &nbsp; &nbsp; : /dev/ttyUSB0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />Bps/Par/Bits&nbsp; &nbsp; &nbsp; &nbsp;: 57600 8N1 <br />Hardware Flow Control : Yes<br />Software Flow Control : No&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><br /><p>##################################### Console ###################################</p><p>[root@pxe ~]# minicom -s</p><p>Welcome to minicom 2.6.2</p><p>OPTIONS: I18n<br />Compiled on Jun 10 2014, 03:20:53.<br />Port /dev/ttyUSB0, 16:32:00</p><p>Press CTRL-A Z for help on special keys</p><br /><br /><p>U-Boot 1.1.3 (Oct 21 2010 - 15:03:00)</p><p>Board: Ralink APSoC DRAM:&nbsp; 64 MB<br />relocate_code Pointer at: 83fb0000<br />config usb....<br />flash_protect ON: from 0xBF000000 to 0xBF01E507<br />flash_protect ON: from 0xBF030000 to 0xBF030FFF<br />*** Warning - bad CRC, using default environment</p><p>============================================<br />Ralink UBoot Version: 3.4.0.0<br />--------------------------------------------<br />ASIC 3052_MP2 (Port5&lt;-&gt;None)<br />DRAM component: 256 Mbits SDR<br />DRAM bus: 32 bit<br />Total memory: 64 MBytes<br />Flash component: NOR Flash<br />Date:Oct 21 2010&nbsp; Time:15:03:00<br />============================================<br />icache: sets:256, ways:4, linesz:32 ,total:32768<br />dcache: sets:128, ways:4, linesz:32 ,total:16384</p><p> ##### The CPU freq = 384 MHZ ####</p><p> SDRAM bus set to 32 bit<br /> SDRAM size =64 Mbytes</p><p>Please choose the operation:<br />&nbsp; &nbsp;1: Load system code to SDRAM via TFTP.<br />&nbsp; &nbsp;2: Load system code then write to Flash via TFTP.<br />&nbsp; &nbsp;3: Boot system code via Flash (default).<br />&nbsp; &nbsp;4: Entr boot command line interface.<br />&nbsp; &nbsp;7: Load Boot Loader code then write to Flash via Serial.<br />&nbsp; &nbsp;9: Load Boot Loader code then write to Flash via TFTP.</p><p>You choosed 9</p><p> 0</p><br /><p>9: System Load Boot Loader then write to Flash via TFTP.<br /> Warning!! Erase Boot Loader in Flash then burn new one. Are you sure?(Y/N)<br /> Please Input new ones /or Ctrl-C to discard<br />&nbsp; &nbsp; &nbsp; &nbsp; Input device IP (10.10.10.123) ==:192.168.1.100<br />&nbsp; &nbsp; &nbsp; &nbsp; Input server IP (10.10.10.3) ==:&nbsp; &nbsp; &nbsp; &nbsp; Input Uboot filename () ==:</p><p> netboot_common, argc= 3</p><p> NetTxPacket = 0x83FE6780</p><p> KSEG1ADDR(NetTxPacket) = 0xA3FE6780</p><p> NetLoop,call eth_halt !</p><p> NetLoop,call eth_init !<br />Trying Eth0 (10/100-M)</p><p> Waitting for RX_DMA_BUSY status Start... done</p><p> Header Payload scatter function is Disable !!</p><p> ETH_STATE_ACTIVE!!<br />*** Warning: no boot file name; using &#039;test.bin&#039;<br />Using Eth0 (10/100-M) device<br />TFTP from server 10.10.10.3; our IP address is 192.168.1.100<br />Filename &#039;test.bin&#039;.</p><p> TIMEOUT_COUNT=10,Load address: 0x80100000<br />Loading: *<br />Abort</p><p> b_end =BF7FFFFF<br />Un-Protecting sectors 0..9 in bank 1<br />Un-Protected 10 sectors</p><p> Erase U-Boot block !!<br />From 0xBF000000 To 0xBF02FFFF</p><p> b_end =BF7FFFFF<br />Erase Flash from 0xbf000000 to 0xbf02ffff in Bank # 1</p><p> erase sector&nbsp; = 0</p><p> Elase Sector 0 with 8K SIZE,The sector 0 is Total 64K<br />*<br /> Exit Sector 0 erase&nbsp; !!</p><p> erase sector&nbsp; = 1<br />*sect = 1,s_last = 9,erase poll = 513072</p><p> erase sector&nbsp; = 2<br />sect = 2,s_last = 9,erase poll = 511839</p><p> erase sector&nbsp; = 3<br />sect = 3,s_last = 9,erase poll = 489385</p><p> erase sector&nbsp; = 4<br />sect = 4,s_last = 9,erase poll = 510869</p><p> erase sector&nbsp; = 5<br />*sect = 5,s_last = 9,erase poll = 539352</p><p> erase sector&nbsp; = 6<br />sect = 6,s_last = 9,erase poll = 530519</p><p> erase sector&nbsp; = 7<br />sect = 7,s_last = 9,erase poll = 539573</p><p> erase sector&nbsp; = 8<br />*sect = 8,s_last = 9,erase poll = 740828</p><p> erase sector&nbsp; = 9<br />sect = 9,s_last = 9,erase poll = 716278<br /> done<br />Erased 10 sectors</p><p> Copy uboot[0 byte] to Flash[0xBF000000]....<br />Zero length ???</p><p> b_end =BF7FFFFF<br />Protecting sectors 0..9 in bank 1<br />Protected 10 sectors</p><br /><p>################################## Console END ###################################</p><p>Now my Ralink RT3052 is unusabel. I&#039;m not getting anythin in minicom console with same serial settings. I tried to change many other baud rates. But no luck.</p><p>Please help me to recover my device and help me to load latest OpenWRT Firmware to RT3052.</p><p>Your comments, suggestions, greately appreciated!</p><p>Thank You!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p293559">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">maurer</div>
					<div class="post-datetime">
						26 Sep 2015, 18:27					</div>
				</div>
				<div class="post-content content">
					<p>it seems you&#039;ve erased your bootloader.<br />The only solution now for you is to desolder the flashc chip and burn a new bootloader (uboot) via a flash programmer like this one:<br /><a href="http://sigma-shop.com/userfiles/productimages/product_179.jpg">http://sigma-shop.com/userfiles/product â€¦ ct_179.jpg</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p293563">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Napsi-GER-</div>
					<div class="post-datetime">
						26 Sep 2015, 18:48					</div>
				</div>
				<div class="post-content content">
					<p>Hello SethuM,</p><p>you should have choosen option &quot;2&quot;.<br />With option &quot;9&quot; you have deleted your bootloader and turned your device into a brick by not providing a bootloader image file.<br />You <strong>should</strong> have read appropriate Documentation <strong>before, AND</strong> the serial printout <strong>while</strong> flashing.<br />It even asked you if you want to overwrite the bootloader.<br /></p><div class="codebox"><pre><code>Warning!! Erase Boot Loader in Flash then burn new one. Are you sure?(Y/N)</code></pre></div><p>The only option left for getting it working again is to unsolder the flash chip and burn a new bootloader, if you get a working bootloader as an image file. Else you have a bricked device.<br />EDIT:<br />maurer was faster than me <img src="https://forum.openwrt.org/img/smilies/tongue.png" width="15" height="15" alt="tongue" /></p><p>Napsi-GER-</p>											<p class="post-edited">(Last edited by <strong>Napsi-GER-</strong> on 26 Sep 2015, 19:33)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p293577">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Degeneratescum</div>
					<div class="post-datetime">
						26 Sep 2015, 21:08					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve had a similar accident with this awful Ralink u-boot myself.</p><p>I found that I could reprogram the flash chip in-situ using a test clip and a Raspberry Pi as the programmer. Apparently this isn&#039;t supposed to work, but it did for me. It may depend on the power consumption of the specific board. More discussion here:</p><p><a href="https://forum.openwrt.org/viewtopic.php?id=58206">https://forum.openwrt.org/viewtopic.php?id=58206</a></p><p>(The photo shows an AR9331 based WR-703n, but I first did this with a Ralink system)</p>											<p class="post-edited">(Last edited by <strong>Degeneratescum</strong> on 26 Sep 2015, 21:10)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p293668">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">SethuM</div>
					<div class="post-datetime">
						27 Sep 2015, 16:20					</div>
				</div>
				<div class="post-content content">
					<p>Guys thanks for your comments!<br />I&#039;ll keep my boxes away from my hands.. I&#039;m not an expert on Chip level debugging. </p><p>Cheers!</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>