<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Asterisk on WRT54GS/OpenWRT with 2 phones on a PAP2</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 13 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p39092">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Gazoo2</div>
					<div class="post-datetime">
						17 Dec 2006, 23:57					</div>
				</div>
				<div class="post-content content">
					<p>Does anyone know what is missing if anything to get 2 phones on my asterisk home server to be able to call each other.</p><p>I have a WRT54GS running OpenWRT/asterisk connected to a PAP2 with 2 extensions 5060/5061, this is all on the lan side of my gateway/router WRT54G 192.168.1.1</p><br /><p>BusyBox v1.00 (2006.11.07-01:40+0000) Built-in shell (ash)</p><br /><p> ---------------------------------------------------<br />root@OpenWrt:~# asterisk -r<br />Asterisk 1.2.1, Copyright (C) 1999 - 2005 Digium.<br />Written by Mark Spencer &lt;markster@digium.com&gt;<br />=========================================================================<br />Connected to Asterisk 1.2.1 currently running on OpenWrt (pid = 3353)<br />OpenWrt*CLI&gt; sip show peers<br />Name/username&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Host&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Dyn Nat ACL Port&nbsp; &nbsp; &nbsp;Status<br />phone2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;192.168.1.135&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;5060&nbsp; &nbsp; &nbsp;Unmonitored<br />phone1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;192.168.1.135&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;5060&nbsp; &nbsp; &nbsp;Unmonitored<br />2 sip peers [2 online , 0 offline]<br />OpenWrt*CLI&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*****Looks like astersisk ports are both 5060******<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; instead of 5060/5061</p><br /><br /><p>Here is some of the errors I am getting </p><br /><p>Jan&nbsp; 1 05:10:33 NOTICE[3363]: chan_sip.c:10817 handle_request_register: Registration from &#039;phone1 &lt;sip:5560@192.168.1.130<br />&gt;&#039; failed for &#039;192.168.1.135&#039; - Not a local SIP domain</p><p>Jan&nbsp; 1 05:11:03 NOTICE[3363]: chan_sip.c:10817 handle_request_register: Registration from &#039;phone2 &lt;sip:5561@192.168.1.130<br />&gt;&#039; failed for &#039;192.168.1.135&#039; - Not a local SIP domain</p><br /><br /><p>(Not a local SIP domain)&nbsp; so asterisks sees the extensions but they are not under the sip domain??<br />My extensions.conf file is blank as I don&#039;t know how to set up extensions for PAP2 with 2 phones</p><p>in my sip.conf file</p><p>autodomain=yes</p><br /><p>OpenWrt*CLI&gt; sip show settings</p><p>Global Settings:<br />----------------<br />&nbsp; SIP Port:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;5060<br />&nbsp; Bindaddress:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0<br />&nbsp; Videosupport:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;No<br />&nbsp; AutoCreatePeer:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;No<br />&nbsp; Allow unknown access:&nbsp; &nbsp;Yes<br />&nbsp; Promsic. redir:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;No<br />&nbsp; SIP domain support:&nbsp; &nbsp; &nbsp;Yes<br />&nbsp; Call to non-local dom.: Yes<br />&nbsp; URI user is phone no:&nbsp; &nbsp;No<br />&nbsp; Our auth realm&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; asterisk<br />&nbsp; Realm. auth:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; No<br />&nbsp; User Agent:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Asterisk PBX<br />&nbsp; MWI checking interval:&nbsp; 10 secs<br />&nbsp; Reg. context:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(not set)<br />&nbsp; Caller ID:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; asterisk<br />&nbsp; From: Domain:<br />&nbsp; Record SIP history:&nbsp; &nbsp; &nbsp;Off<br />&nbsp; Call Events:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Off<br />&nbsp; IP ToS:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x0<br />&nbsp; OSP Support:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; No<br />&nbsp; SIP realtime:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Disabled</p><p>Global Signalling Settings:<br />---------------------------<br />&nbsp; Codecs:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;none<br />&nbsp; Relax DTMF:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;No<br />&nbsp; Compact SIP headers:&nbsp; &nbsp; No<br />&nbsp; RTP Timeout:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 (Disabled)<br />&nbsp; RTP Hold Timeout:&nbsp; &nbsp; &nbsp; &nbsp;0 (Disabled)<br />&nbsp; MWI NOTIFY mime type:&nbsp; &nbsp;application/simple-message-summary<br />&nbsp; DNS SRV lookup:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Yes<br />&nbsp; Pedantic SIP support:&nbsp; &nbsp;No<br />&nbsp; Reg. max duration:&nbsp; &nbsp; &nbsp; 3600 secs<br />&nbsp; Reg. default duration:&nbsp; 120 secs<br />&nbsp; Outbound reg. timeout:&nbsp; 20 secs<br />&nbsp; Outbound reg. attempts: 0<br />&nbsp; Notify ringing state:&nbsp; &nbsp;Yes</p><p>Default Settings:<br />-----------------<br />&nbsp; Context:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; default<br />&nbsp; Nat:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RFC3581<br />&nbsp; DTMF:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;rfc2833<br />&nbsp; Qualify:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />&nbsp; Use ClientCode:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;No<br />&nbsp; Progress inband:&nbsp; &nbsp; &nbsp; &nbsp; Never<br />&nbsp; Language:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Defaults to English)<br />&nbsp; Musicclass:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;default<br />&nbsp; Voice Mail Extension:&nbsp; &nbsp;asterisk</p><p>----<br />OpenWrt*CLI&gt;</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p39094">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">candlerb</div>
					<div class="post-datetime">
						18 Dec 2006, 00:05					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Gazoo2 wrote:</cite><blockquote><p>Does anyone know what is missing if anything to get 2 phones on my asterisk home server to be able to call each other.</p></blockquote></div><p>Well, one thing&#039;s for sure: this is not an issue relating to the development of the OpenWrt platform itself.</p><p>If you have a working installation of Asterisk - and I&#039;d recommend zandbelt&#039;s recent packages - then this is a user&#039;s question about Asterisk.</p><div class="quotebox"><blockquote><p>Jan&nbsp; 1 05:10:33 NOTICE[3363]: chan_sip.c:10817 handle_request_register: Registration from &#039;phone1 &lt;sip:5560@192.168.1.130&gt;&#039; failed for &#039;192.168.1.135&#039; - Not a local SIP domain</p><p>Jan&nbsp; 1 05:11:03 NOTICE[3363]: chan_sip.c:10817 handle_request_register: Registration from &#039;phone2 &lt;sip:5561@192.168.1.130&gt;&#039; failed for &#039;192.168.1.135&#039; - Not a local SIP domain</p></blockquote></div><p>I suggest you post those errors, plus your entire sip.conf file, to the asterisk-users@lists.digium.com mailing list.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p39112">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Gazoo2</div>
					<div class="post-datetime">
						18 Dec 2006, 03:20					</div>
				</div>
				<div class="post-content content">
					<p>ok well thank you for pointing me in the right direction, I will try the mailing list and other forums on asterisks, looks like the asterisk 1.4 release has a gui that might be working with it too.</p><br /><p>Thank you</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>