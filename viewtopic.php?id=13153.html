<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Recover crashed WRT54GS ?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 31 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p58056">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Kh3ops</div>
					<div class="post-datetime">
						25 Oct 2007, 23:12					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>Trying to upgrade to XWRT from OpenWRT, I had the great idea to force the upgrade...</p><div class="quotebox"><blockquote><p>root@OpenWrt:~# wget <a href="http://downloads.x-wrt.org/xwrt/kamikaze/7.09/brcm-2.4/open">http://downloads.x-wrt.org/xwrt/kamikaz â€¦ m-2.4/open</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; wrt-wrt54gs-2.4-squashfs.bin<br />Connecting to downloads.x-wrt.org [88.198.39.176:80]<br />openwrt-wrt54gs-2.4- 100% |*******************************************************************************************************************************************************************************************|&nbsp; 1924 KB 00:00:00 ETA<br />root@OpenWrt:~#<br />root@OpenWrt:~#<br />root@OpenWrt:~# dd bs=32 if=openwrt-wrt54gs-2.4-squashfs.bin of=openwrt-wrt54gs-2.4-squashfs.trx<br />61569+0 records in<br />61569+0 records out<br />root@OpenWrt:~# mtd -e linux -r write openwrt-wrt54gs-2.4-squashfs.trx linux<br />Bad trx header<br />This is not the correct file format; refusing to flash.<br />Please specify the correct file or use -f to force.<br />Image check failed.<br />root@OpenWrt:~# mtd -f -e linux -r write openwrt-wrt54gs-2.4-squashfs.trx linux<br />Bad trx header<br />This is not the correct file format; refusing to flash.<br />Please specify the correct file or use -f to force.<br />Unlocking linux ...<br />Erasing linux ...</p><p>Writing from openwrt-wrt54gs-2.4-squashfs.trx to linux ...&nbsp; [w]</p></blockquote></div><p>Right now, the router is crashed and won&#039;t boot anymore (blinking power led).</p><p>Is there any way to recover it? Using serial cable maybe?</p><p>Thanks for you help,</p><p>Kh3ops</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p58067">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">ggp81</div>
					<div class="post-datetime">
						26 Oct 2007, 10:51					</div>
				</div>
				<div class="post-content content">
					<p>Did you set boot wait on? If yes (or if you don&#039;t know), try to reflash it using tftp</p><p><a href="http://wiki.openwrt.org/OpenWrtDocs/Installing/TFTP">http://wiki.openwrt.org/OpenWrtDocs/Installing/TFTP</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p58073">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">mbm</div>
					<div class="post-datetime">
						26 Oct 2007, 13:02					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Kh3ops wrote:</cite><blockquote><div class="codebox"><pre><code>root@OpenWrt:~# dd bs=32 if=openwrt-wrt54gs-2.4-squashfs.bin of=openwrt-wrt54gs-2.4-squashfs.trx
61569+0 records in
61569+0 records out</code></pre></div></blockquote></div><p>The way the command was written above, it&#039;s nothing more than a copy. If you want the trx file, download the trx file; don&#039;t try to convert between them --&nbsp; there is *one* trx file, that trx file works on *all* devices.</p><div class="quotebox"><blockquote><div class="codebox"><pre><code>root@OpenWrt:~# mtd -e linux -r write openwrt-wrt54gs-2.4-squashfs.trx linux
Bad trx header
This is not the correct file format; refusing to flash.
Please specify the correct file or use -f to force.
Image check failed.</code></pre></div></blockquote></div><p>This warns you that the file isn&#039;t actually a trx file and you shouldn&#039;t flash it.</p><div class="quotebox"><blockquote><div class="codebox"><pre><code>root@OpenWrt:~# mtd -f -e linux -r write openwrt-wrt54gs-2.4-squashfs.trx linux
Bad trx header
This is not the correct file format; refusing to flash.
Please specify the correct file or use -f to force.
Unlocking linux ...
Erasing linux ...

Writing from openwrt-wrt54gs-2.4-squashfs.trx to linux ...  [w]</code></pre></div><p>Right now, the router is crashed and won&#039;t boot anymore (blinking power led).</p></blockquote></div><p>.. but you flashed anyway.</p><p>Luckily for you there is yet *another* protection mechanism designed to prevent users from doing exactly what you just did.</p><p>The WRT54G can&#039;t boot the firmware, it&#039;s stuck in CFE; essentially a bios -- think of this as a PC with an &quot;insert OS and press any key to continue&quot; error. TFTP a new firmware (use the bin file) and it should boot again.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>