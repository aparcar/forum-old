<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> how to make the router button work?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 6 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p147718">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">kyokyowin</div>
					<div class="post-datetime">
						6 Nov 2011, 03:00					</div>
				</div>
				<div class="post-content content">
					<p>how to make the router button work? I have a router ,firmawre image openwrt-ramips-rt305x-wr512-3gn-4M-squashfs-sysupgrade.bin ,but the button didn&#039;t work ,I follow the wiki how to log $action of button ,but have nothing...can someone give me some suggest? Thanks~</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p147731">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">3zl</div>
					<div class="post-datetime">
						6 Nov 2011, 12:24					</div>
				</div>
				<div class="post-content content">
					<p>as control of leds and buttons are highly hardware dependent, you have to gather infos about the gpio of your router.<br />Hint to search openwrt / google :&nbsp; &nbsp; &nbsp; &nbsp; gpioctl&nbsp; button&nbsp; led&nbsp; &nbsp; sysctl</p><p>as well as any infos o your routers I/O</p><p>there is alot of code aout there dealing with routers I/O, so go and learn<br />&nbsp; &nbsp;example : <a href="https://forum.openwrt.org/viewtopic.php?id=28193">https://forum.openwrt.org/viewtopic.php?id=28193</a></p><p>good luck</p><p>3zl</p>											<p class="post-edited">(Last edited by <strong>3zl</strong> on 6 Nov 2011, 12:28)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p147812">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">kyokyowin</div>
					<div class="post-datetime">
						7 Nov 2011, 05:24					</div>
				</div>
				<div class="post-content content">
					<p>thanks~I find the reset of gpio10 can pressed tx value 0 and unpressed rx value 1 ,but how can i use it to reset??I have mkdir /etc/hotplug.d/button/00-reset and input so code,but it doesn&#039;t work!</p><p>scripts like this <br />#! /bin/sh</p><p>[ &quot;$BUTTON&quot; = &quot;reset&quot; ] &amp;&amp; [ &quot;$ACTION&quot; = &quot;pressed&quot; ] &amp;&amp; {<br />reboot<br />} </p><br /><div class="quotebox"><cite>3zl wrote:</cite><blockquote><p>as control of leds and buttons are highly hardware dependent, you have to gather infos about the gpio of your router.<br />Hint to search openwrt / google :&nbsp; &nbsp; &nbsp; &nbsp; gpioctl&nbsp; button&nbsp; led&nbsp; &nbsp; sysctl</p><p>as well as any infos o your routers I/O</p><p>there is alot of code aout there dealing with routers I/O, so go and learn<br />&nbsp; &nbsp;example : <a href="https://forum.openwrt.org/viewtopic.php?id=28193">https://forum.openwrt.org/viewtopic.php?id=28193</a></p><p>good luck</p><p>3zl</p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p147827">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">3zl</div>
					<div class="post-datetime">
						7 Nov 2011, 08:37					</div>
				</div>
				<div class="post-content content">
					<p>did you check&nbsp; ?</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href="http://wiki.openwrt.org/doc/howto/hardware.button">http://wiki.openwrt.org/doc/howto/hardware.button</a><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href="http://wiki.openwrt.org/doc/uci/system">http://wiki.openwrt.org/doc/uci/system</a></p><p>maybe you have to query the button directly by scripting with gpioctl ( eventually install the packet) and put that script in a cron job.</p>											<p class="post-edited">(Last edited by <strong>3zl</strong> on 7 Nov 2011, 22:21)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p148020">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">craswer</div>
					<div class="post-datetime">
						9 Nov 2011, 15:25					</div>
				</div>
				<div class="post-content content">
					<p>Hello, I have the same problem with buttons in wr512-3gn (the buttons didn&#039;t work)</p><p>I put a simple script in /etc/hotplug.d/button/buttons and don&#039;t see anything in logread. The script is:</p><div class="codebox"><pre><code>#!/bin/sh
logger $BUTTON
logger $ACTION</code></pre></div><p>I try to see the file /sys/kernel/debug/gpio , but i can&#039;t find anything about buttons :</p><div class="codebox"><pre><code>GPIOs 0-23, RT305X-GPIO0:
 gpio-1   (reserved            ) in  lo
 gpio-2   (reserved            ) in  lo
 gpio-3   (reserved            ) in  lo
 gpio-4   (reserved            ) in  lo
 gpio-9   (wr512:green:3g      ) out hi
 gpio-11  (wr512:green:gateway ) out hi
 gpio-12  (wr512:green:ap      ) out hi
 gpio-13  (wr512:green:station ) out hi
 gpio-14  (wr512:green:wps     ) out hi
 gpio-15  (reserved            ) in  lo
 gpio-16  (reserved            ) in  lo
 gpio-17  (reserved            ) in  lo
 gpio-18  (reserved            ) in  lo

GPIOs 24-39, RT305X-GPIO1:
 gpio-24  (reserved            ) in  lo
 gpio-25  (reserved            ) in  lo
 gpio-26  (reserved            ) in  lo
 gpio-27  (reserved            ) in  lo
 gpio-28  (reserved            ) in  lo
 gpio-29  (reserved            ) in  lo
 gpio-30  (reserved            ) in  lo
 gpio-31  (reserved            ) in  lo
 gpio-32  (reserved            ) in  lo
 gpio-33  (reserved            ) in  lo
 gpio-34  (reserved            ) in  lo
 gpio-35  (reserved            ) in  lo
 gpio-36  (reserved            ) in  lo
 gpio-37  (reserved            ) in  lo
 gpio-38  (reserved            ) in  lo
 gpio-39  (reserved            ) in  lo

GPIOs 40-51, RT305X-GPIO2:
 gpio-40  (reserved            ) in  lo
 gpio-41  (reserved            ) in  lo
 gpio-42  (reserved            ) in  lo
 gpio-43  (reserved            ) in  lo
 gpio-44  (reserved            ) in  lo
 gpio-45  (reserved            ) in  lo
 gpio-46  (reserved            ) in  lo
 gpio-47  (reserved            ) in  lo
 gpio-48  (reserved            ) in  lo
 gpio-49  (reserved            ) in  lo
 gpio-50  (reserved            ) in  lo
 gpio-51  (reserved            ) in  lo</code></pre></div><p>Any idea?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p148027">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">craswer</div>
					<div class="post-datetime">
						9 Nov 2011, 16:15					</div>
				</div>
				<div class="post-content content">
					<p>Solved! A newbie error <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>I list all packages that contains &quot;gpio&quot;</p><div class="codebox"><pre><code>root@OpenWrt:~# opkg list | grep gpio
gpioctl - 1.0-1 - Tool for controlling gpio pins
kmod-gpio-dev - 2.6.39.4-1 - Kernel module to allows control of GPIO pins using a character device.
kmod-gpiotoggling - 2.6.39.4+b57866441932eabc75b6c4252103121f606dc820-1 - Toggle GPIOs in kernel space
kmod-i2c-gpio - 2.6.39.4-1 - Kernel modules for a very simple bitbanging I2C driver utilizing the
kmod-i2c-gpio-custom - 2.6.39.4-2 - Kernel module for register a custom i2c-gpio platform device.
kmod-i2c-mux-gpio - 2.6.39.4-1 - Kernel modules for GENERIC_GPIO I2C bus mux/switching devices.
kmod-input-gpio-buttons - 2.6.39.4-1 - Kernel module for support polled GPIO buttons input device
kmod-input-gpio-encoder - 2.6.39.4-1 - GPIO rotay encoder
kmod-input-gpio-keys - 2.6.39.4-1 - This driver implements support for buttons connected
kmod-input-gpio-keys-polled - 2.6.39.4-1 - Kernel module for support polled GPIO keys input device
kmod-leds-gpio - 2.6.39.4-1 - Kernel module for LEDs on GPIO lines
kmod-ledtrig-gpio - 2.6.39.4-1 - Kernel module that allows LEDs to be controlled by gpio events.
kmod-mmc-over-gpio - 2.6.39.4-4 - Support for driving an MMC/SD card over GPIO pins via SPI.
kmod-pwm-gpio-custom - 2.6.39.4-1 - Kernel module to register a custom pwm-gpio platform device.
kmod-rotary-gpio-custom - 2.6.39.4-1 - Kernel module for register a custom rotary-gpio-encoder platform device.
kmod-spi-gpio - 2.6.39.4-1 - This package contains the GPIO-based bitbanging SPI Master
kmod-spi-gpio-old - 2.6.39.4-1 - This package contains the GPIO based bitbanging SPI controller driver
kmod-w1-gpio-custom - 2.6.39.4-2 - Kernel module to register a custom w1-gpio platform device.
kmod-w1-master-gpio - 2.6.39.4-1 - Kernel module for the GPIO 1-wire bus master driver
luci-app-mmc-over-gpio - trunk+svn7790-1 - MMC-over-GPIO configuration module</code></pre></div><p>Then I list all packages installed in my router:</p><div class="codebox"><pre><code>root@OpenWrt:~# opkg list_installed | grep gpio
kmod-leds-gpio - 2.6.39.4-1</code></pre></div><p>OUX! I don&#039;t have any packages with &quot;button&quot;.... I install this packages</p><div class="codebox"><pre><code>root@OpenWrt:~# opkg install kmod-input-gpio-buttons kmod-input-gpio-keys kmod-input-gpio-keys-polled</code></pre></div><p>Now the RESET button work, but not the MODE button. This is OK for me <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p148029">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">3zl</div>
					<div class="post-datetime">
						9 Nov 2011, 16:33					</div>
				</div>
				<div class="post-content content">
					<p>google search with : wr512-3gn gpio button<br />reveals</p><p>&nbsp; &nbsp;<a href="http://club.dealextreme.com/forums/Forums.dx/threadid.960455">http://club.dealextreme.com/forums/Foru … did.960455</a>&nbsp; &nbsp;<br />......&quot;Also some gpios are shared with the second uart, 7,8,9,10 if the remaining of the port is still used as GPIO. So could work depending on where GPIO8 is?</p><p>You defined GPIO 0 and 8 as input buttons named WPS and WPS2, are they exposed somewhere, on a testpoint?&quot;</p><p> if they arent supported in you openwrt version you may test the buttos directly running a script in cron using &quot;gpioctl get &lt;pin&gt;&quot;</p><p>more infos <br />&nbsp; <a href="http://www.mail-archive.com/openwrt-devel@lists.openwrt.org/msg10480.html">http://www.mail-archive.com/openwrt-dev … 10480.html</a><br />&nbsp; <a href="https://lists.openwrt.org/pipermail/openwrt-devel/2011-February/009785.html">https://lists.openwrt.org/pipermail/ope … 09785.html</a></p><p>...just take a ride and wade through the internet ( as i did)</p><p>regards<br />3zl</p>											<p class="post-edited">(Last edited by <strong>3zl</strong> on 9 Nov 2011, 16:43)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>