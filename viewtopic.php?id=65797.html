<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> LAN clients get IP from DHCP from WAN interface</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 29 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p329528">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">freewifimarketing.net</div>
					<div class="post-datetime">
						23 Jun 2016, 07:50					</div>
				</div>
				<div class="post-content content">
					<p>Hi, I configured IP for my LAN with DHCP pool, but LAN clients always get IP from DHCP server from WAN when WAN interface connected. How can I stop it and let my client getting IP from IP pool from LAN?</p><div class="codebox"><pre><code>Boot and Recovery Environment for Embedded Devices
Copyright (C) 2015 HackPascal &lt;hackpascal@gmail.com&gt;
Build date 2015-11-03 [git-0fd8ec8]
Version 1.0 (r791)

DRAM: 64MB
Platform: Atheros AR9341 rev 1
Board: Atheros AP123 reference board
Clocks: CPU: 560MHz, DDR: 400MHz, AHB: 200MHz, Ref: 40MHz
Flash: Macronix MX25L6435E (8MB) on ath79-spi
ag71xx-eth: Using MAC address bc:d1:77:3c:a7:e0
eth0: Atheros AR8228/AR8229 rev 1

Network started on eth0, inet addr 192.168.1.1, netmask 255.255.255.0

Press any key to interrupt autoboot ... 0

Trying to boot firmware from 0x9f020000 ...
TP-LINK firmware image header detected.
    Image Name:   08410008
    Data Size:    1176608 Bytes
    Load Address: 80060000
    Entry Point:  80060000
Uncompressing data (LZMA) ... done.
Flushing cache ... done.

Starting kernel at 0x80060000...

[    0.000000] Linux version 3.18.23 (buildbot@builder1) (gcc version 4.8.3 (Ope
nWrt/Linaro GCC 4.8-2014.04 r47269) ) #1 Sun Jan 31 18:39:35 CET 2016
[    0.000000] bootconsole [early0] enabled
[    0.000000] CPU0 revision is: 0001974c (MIPS 74Kc)
[    0.000000] SoC: Atheros AR9341 rev 1
[    0.000000] Determined physical RAM map:
[    0.000000]  memory: 04000000 @ 00000000 (usable)
[    0.000000] Initrd not found or empty - disabling initrd
[    0.000000] Zone ranges:
[    0.000000]   Normal   [mem 0x00000000-0x03ffffff]
[    0.000000] Movable zone start for each node
[    0.000000] Early memory node ranges
[    0.000000]   node   0: [mem 0x00000000-0x03ffffff]
[    0.000000] Initmem setup node 0 [mem 0x00000000-0x03ffffff]
[    0.000000] Primary instruction cache 64kB, VIPT, 4-way, linesize 32 bytes.
[    0.000000] Primary data cache 32kB, 4-way, VIPT, cache aliases, linesize 32
bytes
[    0.000000] Built 1 zonelists in Zone order, mobility grouping on.  Total pag
es: 16256
[    0.000000] Kernel command line:  board=TL-WR841N-v8  console=ttyS0,115200 ro
otfstype=squashfs,jffs2 noinitrd
[    0.000000] PID hash table entries: 256 (order: -2, 1024 bytes)
[    0.000000] Dentry cache hash table entries: 8192 (order: 3, 32768 bytes)
[    0.000000] Inode-cache hash table entries: 4096 (order: 2, 16384 bytes)
[    0.000000] Writing ErrCtl register=00000460
[    0.000000] Readback ErrCtl register=00000460
[    0.000000] Memory: 60812K/65536K available (2586K kernel code, 128K rwdata,
540K rodata, 256K init, 193K bss, 4724K reserved)
[    0.000000] SLUB: HWalign=32, Order=0-3, MinObjects=0, CPUs=1, Nodes=1
[    0.000000] NR_IRQS:51
[    0.000000] Clocks: CPU:560.000MHz, DDR:400.000MHz, AHB:200.000MHz, Ref:40.00
0MHz
[    0.000000] Calibrating delay loop... 278.93 BogoMIPS (lpj=1394688)
[    0.070000] pid_max: default: 32768 minimum: 301
[    0.070000] Mount-cache hash table entries: 1024 (order: 0, 4096 bytes)
[    0.080000] Mountpoint-cache hash table entries: 1024 (order: 0, 4096 bytes)
[    0.090000] NET: Registered protocol family 16
[    0.090000] MIPS: machine is TP-LINK TL-WR841N/ND v8
[    0.540000] Switched to clocksource MIPS
[    0.550000] NET: Registered protocol family 2
[    0.550000] TCP established hash table entries: 1024 (order: 0, 4096 bytes)
[    0.550000] TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
[    0.560000] TCP: Hash tables configured (established 1024 bind 1024)
[    0.570000] TCP: reno registered
[    0.570000] UDP hash table entries: 256 (order: 0, 4096 bytes)
[    0.570000] UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
[    0.580000] NET: Registered protocol family 1
[    0.590000] futex hash table entries: 256 (order: -1, 3072 bytes)
[    0.620000] squashfs: version 4.0 (2009/01/31) Phillip Lougher
[    0.620000] jffs2: version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORIT
Y) (c) 2001-2006 Red Hat, Inc.
[    0.630000] msgmni has been set to 118
[    0.640000] io scheduler noop registered
[    0.640000] io scheduler deadline registered (default)
[    0.650000] Serial: 8250/16550 driver, 16 ports, IRQ sharing enabled
Ãº[    0.680000] serial8250.0: ttyS0 at MMIO 0x18020000 (irq = 11, base_baud = 25
00000) is a 16550A
[    0.690000] console [ttyS0] enabled
[    0.690000] console [ttyS0] enabled
[    0.700000] bootconsole [early0] disabled
[    0.700000] bootconsole [early0] disabled
[    0.710000] m25p80 spi0.0: found mx25l6405d, expected m25p80
[    0.710000] m25p80 spi0.0: mx25l6405d (8192 Kbytes)
[    0.720000] 5 tp-link partitions found on MTD device spi0.0
[    0.720000] Creating 5 MTD partitions on &quot;spi0.0&quot;:
[    0.730000] 0x000000000000-0x000000020000 : &quot;u-boot&quot;
[    0.730000] 0x000000020000-0x00000013f620 : &quot;kernel&quot;
[    0.740000] 0x00000013f620-0x0000007f0000 : &quot;rootfs&quot;
[    0.750000] mtd: device 2 (rootfs) set to be root filesystem
[    0.750000] 1 squashfs-split partitions found on MTD device rootfs
[    0.760000] 0x000000360000-0x0000007f0000 : &quot;rootfs_data&quot;
[    0.760000] 0x0000007f0000-0x000000800000 : &quot;art&quot;
[    0.770000] 0x000000020000-0x0000007f0000 : &quot;firmware&quot;
[    0.800000] libphy: ag71xx_mdio: probed
[    1.390000] ag71xx ag71xx.0: connected to PHY at ag71xx-mdio.1:00 [uid=004dd0
42, driver=Generic PHY]
[    1.400000] eth0: Atheros AG71xx at 0xb9000000, irq 4, mode:MII
[    1.990000] ag71xx-mdio.1: Found an AR934X built-in switch
[    2.030000] eth1: Atheros AG71xx at 0xba000000, irq 5, mode:GMII
[    2.040000] TCP: cubic registered
[    2.040000] NET: Registered protocol family 17
[    2.050000] bridge: automatic filtering via arp/ip/ip6tables has been depreca
ted. Update your scripts to load br_netfilter if you need this.
[    2.060000] Bridge firewalling registered
[    2.060000] 8021q: 802.1Q VLAN Support v1.8
[    2.080000] VFS: Mounted root (squashfs filesystem) readonly on device 31:2.
[    2.080000] Freeing unused kernel memory: 256K (80390000 - 803d0000)
[    3.160000] init: Console is alive
[    3.170000] init: - watchdog -
[    5.200000] init: - preinit -
[    5.820000] random: procd urandom read with 9 bits of entropy available
Press the [f] key and hit [enter] to enter failsafe mode
Press the [1], [2], [3] or [4] key and hit [enter] to select the debug level
[    7.900000] eth1: link up (1000Mbps/Full duplex)
[    9.060000] jffs2: notice: (346) jffs2_build_xattr_subsystem: complete buildi
ng xattr subsystem, 0 of xdatum (0 unchecked, 0 orphan) and 0 of xref (0 dead, 0
 orphan) found.
[    9.080000] mount_root: switching to jffs2 overlay
[    9.130000] eth1: link down
[    9.140000] procd: - early -
[    9.150000] procd: - watchdog -
[    9.880000] procd: - ubus -
[   10.890000] procd: - init -
Please press Enter to activate this console.
[   11.750000] NET: Registered protocol family 10
[   11.760000] ip6_tables: (C) 2000-2006 Netfilter Core Team
[   11.780000] Loading modules backported from Linux version master-2015-03-09-0
-g141f155
[   11.790000] Backport generated by backports.git backports-20150129-0-gdd4a670

[   11.800000] ip_tables: (C) 2000-2006 Netfilter Core Team
[   11.810000] nf_conntrack version 0.5.0 (954 buckets, 3816 max)
[   11.860000] xt_time: kernel timezone is -0000
[   11.890000] cfg80211: Calling CRDA to update world regulatory domain
[   11.920000] cfg80211: World regulatory domain updated:
[   11.920000] cfg80211:  DFS Master region: unset
[   11.930000] cfg80211:   (start_freq - end_freq @ bandwidth), (max_antenna_gai
n, max_eirp), (dfs_cac_time)
[   11.940000] cfg80211:   (2402000 KHz - 2472000 KHz @ 40000 KHz), (N/A, 2000 m
Bm), (N/A)
[   11.940000] cfg80211:   (2457000 KHz - 2482000 KHz @ 20000 KHz, 92000 KHz AUT
O), (N/A, 2000 mBm), (N/A)
[   11.950000] cfg80211:   (2474000 KHz - 2494000 KHz @ 20000 KHz), (N/A, 2000 m
Bm), (N/A)
[   11.960000] cfg80211:   (5170000 KHz - 5250000 KHz @ 80000 KHz, 160000 KHz AU
TO), (N/A, 2000 mBm), (N/A)
[   11.970000] cfg80211:   (5250000 KHz - 5330000 KHz @ 80000 KHz, 160000 KHz AU
TO), (N/A, 2000 mBm), (0 s)
[   11.980000] cfg80211:   (5490000 KHz - 5730000 KHz @ 160000 KHz), (N/A, 2000
mBm), (0 s)
[   11.990000] cfg80211:   (5735000 KHz - 5835000 KHz @ 80000 KHz), (N/A, 2000 m
Bm), (N/A)
[   12.000000] cfg80211:   (57240000 KHz - 63720000 KHz @ 2160000 KHz), (N/A, 0
mBm), (N/A)
[   12.060000] PPP generic driver version 2.4.2
[   12.070000] NET: Registered protocol family 24
[   12.150000] ieee80211 phy0: Atheros AR9340 Rev:1 mem=0xb8100000, irq=47
[   12.170000] cfg80211: Calling CRDA for country: US
[   12.170000] cfg80211: Regulatory domain changed to country: US
[   12.180000] cfg80211:  DFS Master region: FCC
[   12.180000] cfg80211:   (start_freq - end_freq @ bandwidth), (max_antenna_gai
n, max_eirp), (dfs_cac_time)
[   12.190000] cfg80211:   (2402000 KHz - 2472000 KHz @ 40000 KHz), (N/A, 3000 m
Bm), (N/A)
[   12.200000] cfg80211:   (5170000 KHz - 5250000 KHz @ 80000 KHz, 160000 KHz AU
TO), (N/A, 2300 mBm), (N/A)
[   12.210000] cfg80211:   (5250000 KHz - 5330000 KHz @ 80000 KHz, 160000 KHz AU
TO), (N/A, 2300 mBm), (0 s)
[   12.220000] cfg80211:   (5490000 KHz - 5730000 KHz @ 160000 KHz), (N/A, 2300
mBm), (0 s)
[   12.230000] cfg80211:   (5735000 KHz - 5835000 KHz @ 80000 KHz), (N/A, 3000 m
Bm), (N/A)
[   12.230000] cfg80211:   (57240000 KHz - 63720000 KHz @ 2160000 KHz), (N/A, 40
00 mBm), (N/A)
[   20.910000] device eth1 entered promiscuous mode
[   20.930000] IPv6: ADDRCONF(NETDEV_UP): br-lan: link is not ready
[   20.960000] IPv6: ADDRCONF(NETDEV_UP): eth0: link is not ready
[   22.600000] IPv6: ADDRCONF(NETDEV_UP): wlan0: link is not ready
[   22.610000] device wlan0 entered promiscuous mode
[   22.610000] br-lan: port 2(wlan0) entered forwarding state
[   22.620000] br-lan: port 2(wlan0) entered forwarding state
[   22.640000] IPv6: ADDRCONF(NETDEV_CHANGE): wlan0: link becomes ready
[   22.650000] IPv6: ADDRCONF(NETDEV_CHANGE): br-lan: link becomes ready
[   22.860000] eth1: link up (1000Mbps/Full duplex)
[   22.860000] br-lan: port 1(eth1) entered forwarding state
[   22.870000] br-lan: port 1(eth1) entered forwarding state
[   24.620000] br-lan: port 2(wlan0) entered forwarding state
[   24.870000] br-lan: port 1(eth1) entered forwarding state
[   49.410000] random: nonblocking pool is initialized</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p329536">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">eduperez</div>
					<div class="post-datetime">
						23 Jun 2016, 10:15					</div>
				</div>
				<div class="post-content content">
					<p>Is this a real question, or are you just trying to spam the forums with your &quot;free wifi marketing&quot;?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p329539">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">freewifimarketing.net</div>
					<div class="post-datetime">
						23 Jun 2016, 10:38					</div>
				</div>
				<div class="post-content content">
					<p>I am stuck with this situation for long and today I realize that the 100MSH is only 2 RJ-45 port while wr841n have 5 so maybe the configuration is not match, can I change VLAN to separate WAN and LAN?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p329573">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">ckm</div>
					<div class="post-datetime">
						23 Jun 2016, 16:01					</div>
				</div>
				<div class="post-content content">
					<p>/etc/config/dhcp</p><p>config dhcp lan<br />&nbsp; &nbsp; option interface&nbsp; &nbsp; lan<br />&nbsp; &nbsp; option start&nbsp; &nbsp; &nbsp;100<br />&nbsp; &nbsp; option limit&nbsp; &nbsp; 150<br />&nbsp; &nbsp; option leasetime&nbsp; &nbsp; 12h<br />&nbsp; &nbsp; </p><p>config dhcp wan<br />&nbsp; &nbsp; option interface&nbsp; &nbsp; wan<br />&nbsp; &nbsp; option ignore&nbsp; &nbsp; 1</p><br /><p>Be sure the&nbsp; option ignore&nbsp; &nbsp; 1&nbsp; &nbsp;is here in the config file at the bottom of the config dhcp wan.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p329638">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">freewifimarketing.net</div>
					<div class="post-datetime">
						24 Jun 2016, 07:40					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>ckm wrote:</cite><blockquote><p>/etc/config/dhcp</p><br /><p>Be sure the&nbsp; option ignore&nbsp; &nbsp; 1&nbsp; &nbsp;is here in the config file at the bottom of the config dhcp wan.</p></blockquote></div><p>Thanks CKM for your reply, here is my /etc/config/hdcp</p><div class="codebox"><pre><code>config dnsmasq
    option domainneeded &#039;1&#039;
    option boguspriv &#039;1&#039;
    option filterwin2k &#039;0&#039;
    option localise_queries &#039;1&#039;
    option rebind_protection &#039;1&#039;
    option rebind_localhost &#039;1&#039;
    option local &#039;/lan/&#039;
    option domain &#039;lan&#039;
    option expandhosts &#039;1&#039;
    option nonegcache &#039;0&#039;
    option authoritative &#039;1&#039;
    option readethers &#039;1&#039;
    option leasefile &#039;/tmp/dhcp.leases&#039;
    option resolvfile &#039;/tmp/resolv.conf.auto&#039;
    option localservice &#039;1&#039;

config dhcp &#039;lan&#039;
    option interface &#039;lan&#039;
    option start &#039;100&#039;
    option limit &#039;150&#039;
    option leasetime &#039;12h&#039;
    option dhcpv6 &#039;server&#039;
    option ra &#039;server&#039;

config dhcp &#039;wan&#039;
    option interface &#039;wan&#039;
    option ignore &#039;1&#039;

config odhcpd &#039;odhcpd&#039;
    option maindhcp &#039;0&#039;
    option leasefile &#039;/tmp/hosts/odhcpd&#039;
    option leasetrigger &#039;/usr/sbin/odhcpd-update&#039;</code></pre></div><p>please note I am running <br />Model&nbsp; &nbsp; TP-Link TL-WR841N/ND v8<br />Firmware Version&nbsp; &nbsp; OpenWrt Chaos Calmer 15.05.1 / LuCI 15.05-149-g0d8bbd2 Release (git-15.363.78009-956be55)</p><p>on 100MSH hardware with 1 LAN and 1 WAN only<br />Can you take a look at /etc/config/network and advice if any change needed</p><div class="codebox"><pre><code>config interface &#039;loopback&#039;
    option ifname &#039;lo&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;127.0.0.1&#039;
    option netmask &#039;255.0.0.0&#039;

config globals &#039;globals&#039;
    option ula_prefix &#039;fd3b:408a:53d6::/48&#039;

config interface &#039;lan&#039;
    option ifname &#039;eth1&#039;
    option force_link &#039;1&#039;
    option type &#039;bridge&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;192.168.1.1&#039;
    option netmask &#039;255.255.255.0&#039;
    option ip6assign &#039;60&#039;

config interface &#039;wan&#039;
    option ifname &#039;eth0&#039;
    option proto &#039;dhcp&#039;

config interface &#039;wan6&#039;
    option ifname &#039;eth0&#039;
    option proto &#039;dhcpv6&#039;

config switch
    option name &#039;switch0&#039;
    option reset &#039;1&#039;
    option enable_vlan &#039;1&#039;

config switch_vlan
    option device &#039;switch0&#039;
    option vlan &#039;1&#039;
    option ports &#039;0 1 2 3 4&#039;</code></pre></div>											<p class="post-edited">(Last edited by <strong>freewifimarketing.net</strong> on 24 Jun 2016, 07:46)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p329646">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">ckm</div>
					<div class="post-datetime">
						24 Jun 2016, 10:44					</div>
				</div>
				<div class="post-content content">
					<p>Have you tried just setting it up as a AP access point this is a working config of a working AP.you get all your IP from your main router. </p><p>/ect/config/wireless<br />config wifi-device &#039;radio0&#039;<br />&nbsp; &nbsp; option type &#039;mac80211&#039;<br />&nbsp; &nbsp; option hwmode &#039;11g&#039;<br />&nbsp; &nbsp; option path &#039;pci0000:00/0000:00:00.0&#039;<br />&nbsp; &nbsp; option htmode &#039;HT20&#039;<br />&nbsp; &nbsp; option channel &#039;6&#039;<br />&nbsp; &nbsp; option txpower &#039;22&#039;<br />&nbsp; &nbsp; option country &#039;US&#039;</p><p>config wifi-iface<br />&nbsp; &nbsp; option device &#039;radio0&#039;<br />&nbsp; &nbsp; option network &#039;lan&#039;<br />&nbsp; &nbsp; option mode &#039;ap&#039;<br />&nbsp; &nbsp; option ssid &#039;OpenWrt&#039;<br />&nbsp; &nbsp; option encryption &#039;psk&#039;<br />&nbsp; &nbsp; option key &#039;ef0c1de21c&#039;</p><p>/ect/config/network<br />config interface &#039;loopback&#039;<br />&nbsp; &nbsp; option ifname &#039;lo&#039;<br />&nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; option ipaddr &#039;127.0.0.1&#039;<br />&nbsp; &nbsp; option netmask &#039;255.0.0.0&#039;</p><p>config globals &#039;globals&#039;<br />&nbsp; &nbsp; option ula_prefix &#039;fdde:d647:0de0::/48&#039;</p><p>config interface &#039;lan&#039;<br />&nbsp; &nbsp; option ifname &#039;eth1&#039;<br />&nbsp; &nbsp; option force_link &#039;1&#039;<br />&nbsp; &nbsp; option type &#039;bridge&#039;<br />&nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; option ipaddr &#039;192.168.1.1&#039;<br />&nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;<br />&nbsp; &nbsp; option ip6assign &#039;60&#039;</p><br /><p>/ect/config/dhcp<br />config dnsmasq<br />&nbsp; &nbsp; option domainneeded &#039;1&#039;<br />&nbsp; &nbsp; option boguspriv &#039;1&#039;<br />&nbsp; &nbsp; option filterwin2k &#039;0&#039;<br />&nbsp; &nbsp; option localise_queries &#039;1&#039;<br />&nbsp; &nbsp; option rebind_protection &#039;1&#039;<br />&nbsp; &nbsp; option rebind_localhost &#039;1&#039;<br />&nbsp; &nbsp; option local &#039;/lan/&#039;<br />&nbsp; &nbsp; option domain &#039;lan&#039;<br />&nbsp; &nbsp; option expandhosts &#039;1&#039;<br />&nbsp; &nbsp; option nonegcache &#039;0&#039;<br />&nbsp; &nbsp; option authoritative &#039;1&#039;<br />&nbsp; &nbsp; option readethers &#039;1&#039;<br />&nbsp; &nbsp; option leasefile &#039;/tmp/dhcp.leases&#039;<br />&nbsp; &nbsp; option resolvfile &#039;/tmp/resolv.conf.auto&#039;</p><p>config dhcp &#039;lan&#039;<br />&nbsp; &nbsp; option interface &#039;lan&#039;<br />&nbsp; &nbsp; option dhcpv6 &#039;server&#039;<br />&nbsp; &nbsp; option ra &#039;server&#039;<br />&nbsp; &nbsp; option ignore &#039;1&#039;<br />&nbsp; &nbsp; option ra_management &#039;1&#039;</p><p>config dhcp &#039;wan&#039;<br />&nbsp; &nbsp; option interface &#039;wan&#039;<br />&nbsp; &nbsp; option ignore &#039;1&#039;</p><p>config odhcpd &#039;odhcpd&#039;<br />&nbsp; &nbsp; option maindhcp &#039;0&#039;<br />&nbsp; &nbsp; option leasefile &#039;/tmp/hosts/odhcpd&#039;<br />&nbsp; &nbsp; option leasetrigger &#039;/usr/sbin/odhcpd-update&#039;</p><p>you plug the cat-5 to the lan not the wan if i need some better wifi for clients i setup a AP.It&#039;s just a thought if you still want to find a fix for this problem some body mite have a fix.</p>											<p class="post-edited">(Last edited by <strong>ckm</strong> on 24 Jun 2016, 10:48)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p329661">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">freewifimarketing.net</div>
					<div class="post-datetime">
						24 Jun 2016, 13:33					</div>
				</div>
				<div class="post-content content">
					<p>another strange is that<br />1. If I plug CAT5 cable in WAN port -&gt; LAN always get IP from WAN interface<br />2. If unplug WAN port during boot up -&gt; LAN can get IP from local pools but WAN could not be connect after I plug CAT5 cable to WAN again</p><div class="codebox"><pre><code>[    0.000000] Linux version 3.18.23 (buildbot@builder1) (gcc version 4.8.3 (OpenWrt/Linaro GCC 4.8-2014.04 r47269) ) #1 Sun Jan 31 18:39:35 CET 2016
[    0.000000] MyLoader: sysp=1e0f1e0f, boardp=1e0f1e0f, parts=1e0f1e0f
[    0.000000] bootconsole [early0] enabled
[    0.000000] CPU0 revision is: 0001974c (MIPS 74Kc)
[    0.000000] SoC: Atheros AR9341 rev 1
[    0.000000] Determined physical RAM map:
[    0.000000]  memory: 04000000 @ 00000000 (usable)
[    0.000000] Initrd not found or empty - disabling initrd
[    0.000000] Zone ranges:
[    0.000000]   Normal   [mem 0x00000000-0x03ffffff]
[    0.000000] Movable zone start for each node
[    0.000000] Early memory node ranges
[    0.000000]   node   0: [mem 0x00000000-0x03ffffff]
[    0.000000] Initmem setup node 0 [mem 0x00000000-0x03ffffff]
[    0.000000] On node 0 totalpages: 16384
[    0.000000] free_area_init_node: node 0, pgdat 803762b0, node_mem_map 81000000
[    0.000000]   Normal zone: 128 pages used for memmap
[    0.000000]   Normal zone: 0 pages reserved
[    0.000000]   Normal zone: 16384 pages, LIFO batch:3
[    0.000000] Primary instruction cache 64kB, VIPT, 4-way, linesize 32 bytes.
[    0.000000] Primary data cache 32kB, 4-way, VIPT, cache aliases, linesize 32 bytes
[    0.000000] pcpu-alloc: s0 r0 d32768 u32768 alloc=1*32768
[    0.000000] pcpu-alloc: [0] 0 
[    0.000000] Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 16256
[    0.000000] Kernel command line:  board=TL-WR841N-v8  console=ttyS0,115200 rootfstype=squashfs,jffs2 noinitrd
[    0.000000] PID hash table entries: 256 (order: -2, 1024 bytes)
[    0.000000] Dentry cache hash table entries: 8192 (order: 3, 32768 bytes)
[    0.000000] Inode-cache hash table entries: 4096 (order: 2, 16384 bytes)
[    0.000000] Writing ErrCtl register=00000df0
[    0.000000] Readback ErrCtl register=00000df0
[    0.000000] Memory: 60812K/65536K available (2586K kernel code, 128K rwdata, 540K rodata, 256K init, 193K bss, 4724K reserved)
[    0.000000] SLUB: HWalign=32, Order=0-3, MinObjects=0, CPUs=1, Nodes=1
[    0.000000] NR_IRQS:51
[    0.000000] Clocks: CPU:560.000MHz, DDR:400.000MHz, AHB:200.000MHz, Ref:40.000MHz
[    0.000000] Calibrating delay loop... 278.93 BogoMIPS (lpj=1394688)
[    0.070000] pid_max: default: 32768 minimum: 301
[    0.070000] Mount-cache hash table entries: 1024 (order: 0, 4096 bytes)
[    0.080000] Mountpoint-cache hash table entries: 1024 (order: 0, 4096 bytes)
[    0.090000] NET: Registered protocol family 16
[    0.090000] MIPS: machine is TP-LINK TL-WR841N/ND v8
[    0.540000] Switched to clocksource MIPS
[    0.550000] NET: Registered protocol family 2
[    0.550000] TCP established hash table entries: 1024 (order: 0, 4096 bytes)
[    0.550000] TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
[    0.560000] TCP: Hash tables configured (established 1024 bind 1024)
[    0.570000] TCP: reno registered
[    0.570000] UDP hash table entries: 256 (order: 0, 4096 bytes)
[    0.570000] UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
[    0.580000] NET: Registered protocol family 1
[    0.590000] PCI: CLS 0 bytes, default 32
[    0.590000] futex hash table entries: 256 (order: -1, 3072 bytes)
[    0.620000] squashfs: version 4.0 (2009/01/31) Phillip Lougher
[    0.620000] jffs2: version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006 Red Hat, Inc.
[    0.630000] msgmni has been set to 118
[    0.640000] io scheduler noop registered
[    0.640000] io scheduler deadline registered (default)
[    0.650000] Serial: 8250/16550 driver, 16 ports, IRQ sharing enabled
[    0.660000] console [ttyS0] disabled
[    0.680000] serial8250.0: ttyS0 at MMIO 0x18020000 (irq = 11, base_baud = 2500000) is a 16550A
[    0.690000] console [ttyS0] enabled
[    0.700000] bootconsole [early0] disabled
[    0.710000] m25p80 spi0.0: found mx25l6405d, expected m25p80
[    0.710000] m25p80 spi0.0: mx25l6405d (8192 Kbytes)
[    0.720000] 5 tp-link partitions found on MTD device spi0.0
[    0.720000] Creating 5 MTD partitions on &quot;spi0.0&quot;:
[    0.730000] 0x000000000000-0x000000020000 : &quot;u-boot&quot;
[    0.730000] 0x000000020000-0x00000013f620 : &quot;kernel&quot;
[    0.740000] 0x00000013f620-0x0000007f0000 : &quot;rootfs&quot;
[    0.750000] mtd: device 2 (rootfs) set to be root filesystem
[    0.750000] 1 squashfs-split partitions found on MTD device rootfs
[    0.760000] 0x000000360000-0x0000007f0000 : &quot;rootfs_data&quot;
[    0.760000] 0x0000007f0000-0x000000800000 : &quot;art&quot;
[    0.770000] 0x000000020000-0x0000007f0000 : &quot;firmware&quot;
[    0.800000] libphy: ag71xx_mdio: probed
[    1.390000] ag71xx ag71xx.0: connected to PHY at ag71xx-mdio.1:00 [uid=004dd042, driver=Generic PHY]
[    1.400000] eth0: Atheros AG71xx at 0xb9000000, irq 4, mode:MII
[    1.990000] ag71xx-mdio.1: Found an AR934X built-in switch
[    2.030000] eth1: Atheros AG71xx at 0xba000000, irq 5, mode:GMII
[    2.040000] TCP: cubic registered
[    2.040000] NET: Registered protocol family 17
[    2.050000] bridge: automatic filtering via arp/ip/ip6tables has been deprecated. Update your scripts to load br_netfilter if you need this.
[    2.060000] Bridge firewalling registered
[    2.060000] 8021q: 802.1Q VLAN Support v1.8
[    2.080000] VFS: Mounted root (squashfs filesystem) readonly on device 31:2.
[    2.080000] Freeing unused kernel memory: 256K (80390000 - 803d0000)
[    3.160000] init: Console is alive
[    3.170000] init: - watchdog -
[    5.210000] init: - preinit -
[    5.820000] random: procd urandom read with 9 bits of entropy available
[    7.900000] eth1: link up (1000Mbps/Full duplex)
[    9.140000] jffs2: notice: (346) jffs2_build_xattr_subsystem: complete building xattr subsystem, 0 of xdatum (0 unchecked, 0 orphan) and 0 of xref (0 dead, 0 orphan) found.
[    9.160000] mount_root: switching to jffs2 overlay
[    9.210000] eth1: link down
[    9.220000] procd: - early -
[    9.220000] procd: - watchdog -
[   10.030000] procd: - ubus -
[   11.040000] procd: - init -
[   11.820000] NET: Registered protocol family 10
[   11.830000] ip6_tables: (C) 2000-2006 Netfilter Core Team
[   11.850000] Loading modules backported from Linux version master-2015-03-09-0-g141f155
[   11.850000] Backport generated by backports.git backports-20150129-0-gdd4a670
[   11.860000] ip_tables: (C) 2000-2006 Netfilter Core Team
[   11.880000] nf_conntrack version 0.5.0 (954 buckets, 3816 max)
[   11.920000] xt_time: kernel timezone is -0000
[   11.960000] cfg80211: Calling CRDA to update world regulatory domain
[   11.960000] cfg80211: World regulatory domain updated:
[   11.970000] cfg80211:  DFS Master region: unset
[   11.970000] cfg80211:   (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp), (dfs_cac_time)
[   11.980000] cfg80211:   (2402000 KHz - 2472000 KHz @ 40000 KHz), (N/A, 2000 mBm), (N/A)
[   11.990000] cfg80211:   (2457000 KHz - 2482000 KHz @ 20000 KHz, 92000 KHz AUTO), (N/A, 2000 mBm), (N/A)
[   12.000000] cfg80211:   (2474000 KHz - 2494000 KHz @ 20000 KHz), (N/A, 2000 mBm), (N/A)
[   12.010000] cfg80211:   (5170000 KHz - 5250000 KHz @ 80000 KHz, 160000 KHz AUTO), (N/A, 2000 mBm), (N/A)
[   12.020000] cfg80211:   (5250000 KHz - 5330000 KHz @ 80000 KHz, 160000 KHz AUTO), (N/A, 2000 mBm), (0 s)
[   12.030000] cfg80211:   (5490000 KHz - 5730000 KHz @ 160000 KHz), (N/A, 2000 mBm), (0 s)
[   12.040000] cfg80211:   (5735000 KHz - 5835000 KHz @ 80000 KHz), (N/A, 2000 mBm), (N/A)
[   12.040000] cfg80211:   (57240000 KHz - 63720000 KHz @ 2160000 KHz), (N/A, 0 mBm), (N/A)
[   12.110000] PPP generic driver version 2.4.2
[   12.120000] NET: Registered protocol family 24
[   12.200000] ath: EEPROM regdomain: 0x0
[   12.200000] ath: EEPROM indicates default country code should be used
[   12.200000] ath: doing EEPROM country-&gt;regdmn map search
[   12.200000] ath: country maps to regdmn code: 0x3a
[   12.200000] ath: Country alpha2 being used: US
[   12.200000] ath: Regpair used: 0x3a
[   12.210000] ieee80211 phy0: Selected rate control algorithm &#039;minstrel_ht&#039;
[   12.210000] ieee80211 phy0: Atheros AR9340 Rev:1 mem=0xb8100000, irq=47
[   12.240000] cfg80211: Calling CRDA for country: US
[   12.240000] cfg80211: Regulatory domain changed to country: US
[   12.250000] cfg80211:  DFS Master region: FCC
[   12.250000] cfg80211:   (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp), (dfs_cac_time)
[   12.260000] cfg80211:   (2402000 KHz - 2472000 KHz @ 40000 KHz), (N/A, 3000 mBm), (N/A)
[   12.270000] cfg80211:   (5170000 KHz - 5250000 KHz @ 80000 KHz, 160000 KHz AUTO), (N/A, 2300 mBm), (N/A)
[   12.280000] cfg80211:   (5250000 KHz - 5330000 KHz @ 80000 KHz, 160000 KHz AUTO), (N/A, 2300 mBm), (0 s)
[   12.290000] cfg80211:   (5490000 KHz - 5730000 KHz @ 160000 KHz), (N/A, 2300 mBm), (0 s)
[   12.300000] cfg80211:   (5735000 KHz - 5835000 KHz @ 80000 KHz), (N/A, 3000 mBm), (N/A)
[   12.300000] cfg80211:   (57240000 KHz - 63720000 KHz @ 2160000 KHz), (N/A, 4000 mBm), (N/A)
[   20.960000] device eth1 entered promiscuous mode
[   20.980000] IPv6: ADDRCONF(NETDEV_UP): br-lan: link is not ready
[   21.030000] device eth0 entered promiscuous mode
[   21.030000] br-wan: port 1(eth0) entered forwarding state
[   21.040000] br-wan: port 1(eth0) entered forwarding state
[   22.090000] br-wan: port 1(eth0) entered disabled state
[   22.950000] eth1: link up (1000Mbps/Full duplex)
[   23.110000] br-lan: port 1(eth1) entered forwarding state
[   23.110000] br-lan: port 1(eth1) entered forwarding state
[   23.190000] IPv6: ADDRCONF(NETDEV_CHANGE): br-lan: link becomes ready
[   23.240000] IPv6: ADDRCONF(NETDEV_UP): wlan0: link is not ready
[   23.280000] device wlan0 entered promiscuous mode
[   23.280000] br-lan: port 2(wlan0) entered forwarding state
[   23.290000] br-lan: port 2(wlan0) entered forwarding state
[   23.350000] IPv6: ADDRCONF(NETDEV_CHANGE): wlan0: link becomes ready
[   25.110000] br-lan: port 1(eth1) entered forwarding state
[   25.290000] br-lan: port 2(wlan0) entered forwarding state
[   45.330000] random: nonblocking pool is initialized
[   90.480000] device eth0 left promiscuous mode
[   90.480000] br-wan: port 1(eth0) entered disabled state
[   90.550000] device eth0 entered promiscuous mode
[   90.550000] IPv6: ADDRCONF(NETDEV_UP): br-wan: link is not ready</code></pre></div>											<p class="post-edited">(Last edited by <strong>freewifimarketing.net</strong> on 24 Jun 2016, 13:40)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p329668">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">Max Hopper</div>
					<div class="post-datetime">
						24 Jun 2016, 15:01					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dmesg wrote:</cite><blockquote><div class="codebox"><pre><code>[   21.030000] br-wan: port 1(eth0) entered forwarding state
[   21.040000] br-wan: port 1(eth0) entered forwarding state
[   22.090000] br-wan: port 1(eth0) entered disabled state
[   22.950000] eth1: link up (1000Mbps/Full duplex)
[   23.110000] br-lan: port 1(eth1) entered forwarding state
[   23.110000] br-lan: port 1(eth1) entered forwarding state</code></pre></div></blockquote></div><p>It would appear that the two Ethernet ports are being bridged.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p330284">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">freewifimarketing.net</div>
					<div class="post-datetime">
						1 Jul 2016, 16:47					</div>
				</div>
				<div class="post-content content">
					<p>Please guide me how to solve this. Thank you.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>