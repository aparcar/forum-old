<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Newer Lantiq VR9 support</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 18 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=50860&amp;p=2.html">2</a></li></ul></nav></div>
			
		
		
			<article class="post" id="p234943">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Kronos2001</div>
					<div class="post-datetime">
						29 May 2014, 01:31					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve been running Barrier Breaker on an ECI /r modem from Openreach.&nbsp; It is running as a router and also an end point for an HE IPv6 tunnel.</p><p>Astoria Networks have released newer firmware and support software in their EasyBox 904 source.&nbsp; I&#039;ve updated my local Barrier Breaker to use this and it&#039;s been running well.&nbsp; Has anyone else tried this newer version??</p><p>drv_dsl_cpe_api_vrx-4.11.11.tar.gz<br />drv_mei_cpe-1.2.1.tar.gz<br />dsl_cpe_control_vrx-4.11.11.tar.gz<br />dsl_vr9_firmware_xdsl-05.05.01.07.01.06_05.05.03.03.01.02.tar.gz</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235457">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">vrx200</div>
					<div class="post-datetime">
						2 Jun 2014, 22:39					</div>
				</div>
				<div class="post-content content">
					<p>Would be good to see added to buildroot for the lantiq vr9 builds.</p><p>Could I ask how updated your build from the current:<br />{drv_dsl_cpe_api_vrx-4.11.4.tar.gz&nbsp; drv_mei_cpe-1.2.0.tar.gz&nbsp; dsl_cpe_control_vrx-4.11.4.tar.gz}</p><p>To the later EasyBox source.<br />drv_dsl_cpe_api_vrx-4.11.11.tar.gz&nbsp; drv_mei_cpe-1.2.1.tar.gz&nbsp; dsl_cpe_control_vrx-4.11.11.tar.gz</p><p>Did try replacing the files in dl and editing mei patch &amp; make files of 4.14.4 but&nbsp; failed to get sync.</p><p>Help would be most welcome!</p><p>Thanks !</p>											<p class="post-edited">(Last edited by <strong>vrx200</strong> on 2 Jun 2014, 23:25)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235468">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Kronos2001</div>
					<div class="post-datetime">
						3 Jun 2014, 00:34					</div>
				</div>
				<div class="post-content content">
					<p>Starting with the latest Barrier Breaker from GIT you can make the changes that I did with the patch at <a href="http://www.ianhastie.me.uk/lantiq-update.patch.gz">lantiq-update.patch.gz</a>.&nbsp; Then just copy the new files</p><p>drv_dsl_cpe_api_vrx-4.11.11.tar.gz<br />drv_mei_cpe-1.2.1.tar.gz<br />dsl_cpe_control_vrx-4.11.11.tar.gz</p><p>into the dl subdir.&nbsp; Configure and compile.&nbsp; Then get the firmware from</p><p>dsl_vr9_firmware_xdsl-05.05.01.07.01.06_05.05.03.03.01.02.tar.gz</p><p>which needs to be available as /lib/firmware/vdsl.bin.</p><p>Looks like just about what you&#039;ve done.&nbsp; There might be some bits in my config since I tend to enable all the available Lantiq stuff which is not the case by default.&nbsp; You can get my config from <a href="http://www.ianhastie.me.uk/openwrt.config.gz">openwrt.config.gz</a>.&nbsp; However since I usually prefer command line there is no web interface there.&nbsp; It&#039;s a slightly oversized image too, but works OK with Asbokid&#039;s autoboot setup.</p><p>Let me know how you get on with it.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235746">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">vrx200</div>
					<div class="post-datetime">
						5 Jun 2014, 16:07					</div>
				</div>
				<div class="post-content content">
					<p>Hi<br />Could I ask for a little help with the network files.</p><p>All the other kernel files work and build successfully. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>As soon as I change either&nbsp; package/network/config/ltq-vdsl-app/Makefile&nbsp; &nbsp;or the&nbsp; package/network/config/ltq-vdsl-app/patches/100-compat.patch&nbsp; &nbsp;the build fails at patch 100.</p><p>Any guidance , example or&nbsp; copies of the two ltq-vdsl-app files would be very welcome.</p><p>Thanks again!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235806">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">Kronos2001</div>
					<div class="post-datetime">
						6 Jun 2014, 01:44					</div>
				</div>
				<div class="post-content content">
					<p>Well firstly is my patch applying OK?&nbsp; In the openwrt root directory this should be done by the command </p><div class="codebox"><pre><code>zcat lantiq-update.patch.gz | patch -p1</code></pre></div><p>Once that&#039;s been done it should compile OK.&nbsp; What errors are you getting?&nbsp; What source are you patching?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235813">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">vrx200</div>
					<div class="post-datetime">
						6 Jun 2014, 03:09					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for getting back.</p><p>Changed to the back up laptop (Ubuntu) system &amp; manually went through each file change and it worked first time. (grrr- hence the removal of the post earlier)</p><p>Its the patch 100&nbsp; {package/network/config/ltq-vdsl-app/patches/100-compat.patch} that seems to be causing the issue.</p><p>I&#039;ll jump back to main system tommorrow and&nbsp; report back with the info</p><p>Thanks!</p>											<p class="post-edited">(Last edited by <strong>vrx200</strong> on 6 Jun 2014, 03:21)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235879">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">vrx200</div>
					<div class="post-datetime">
						6 Jun 2014, 20:04					</div>
				</div>
				<div class="post-content content">
					<p>Just a quick update to say your patch works no problem on most versions of Linux.</p><p>[The issue looks like it was down to something with the cross compiler on the other system- It&#039;s working now )</p><p>Thanks again for the patch &amp; Help <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Appreciated!</p>											<p class="post-edited">(Last edited by <strong>vrx200</strong> on 6 Jun 2014, 20:04)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235925">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">narotic</div>
					<div class="post-datetime">
						7 Jun 2014, 17:13					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve been running the VG3503J-V2 with OpenWRT r40773 on Telecom Italia&#039;s ADSL2+ network. It has been running stable for 3 weeks now, much better than what I was expecting lacking &#039;official&#039; OpenWRT support.</p><p>Has anybody else attempted to set the SNR margin (<strong>locs</strong> command in <strong>vdsl_cpe_control</strong>). With the default OpenWRT build it doesn&#039;t seem to work, but I&#039;m not sure if that&#039;s a problem with the firmware or perhaps limitations of the DSLAM.</p><p>I&#039;ll try to build an image with your patches for the newer version (thanks!) and report back.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235960">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">Kronos2001</div>
					<div class="post-datetime">
						7 Jun 2014, 23:29					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>narotic wrote:</cite><blockquote><p>I&#039;ve been running the VG3503J-V2 with OpenWRT r40773 on Telecom Italia&#039;s ADSL2+ network. It has been running stable for 3 weeks now, much better than what I was expecting lacking &#039;official&#039; OpenWRT support.</p></blockquote></div><p>Interesting to see that the code is working for you.&nbsp; You can see in git that blogic has put in a lot of time on the Lantiq support.</p><div class="quotebox"><cite>narotic wrote:</cite><blockquote><p>Has anybody else attempted to set the SNR margin (<strong>locs</strong> command in <strong>vdsl_cpe_control</strong>). With the default OpenWRT build it doesn&#039;t seem to work, but I&#039;m not sure if that&#039;s a problem with the firmware or perhaps limitations of the DSLAM.</p></blockquote></div><p>I haven&#039;t tried setting the target noise margin with locs.&nbsp; Seems the value you need to provide is a change in noise margin value, and I would guess multiplied by 10.&nbsp; So to reduce target noise margin by 1.5dB would be <strong>locs 0 -15</strong>.&nbsp; I&#039;m going to try to see if BT&#039;s DLM will notice my line has become stable and see what it does.</p><div class="quotebox"><cite>narotic wrote:</cite><blockquote><p>I&#039;ll try to build an image with your patches for the newer version (thanks!) and report back.</p></blockquote></div><p>Thanks for trying it.&nbsp; It&#039;s mostly a matter of updating source code versions and hash values.&nbsp; Just one thing.&nbsp; Could you please run the following on you router with the current firmware? </p><div class="codebox"><pre><code>opkg list | grep ltq-</code></pre></div><p>&nbsp; That would be quite helpful as I&#039;ve really focused on the VDSL support side.</p>											<p class="post-edited">(Last edited by <strong>Kronos2001</strong> on 7 Jun 2014, 23:32)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235968">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">narotic</div>
					<div class="post-datetime">
						8 Jun 2014, 02:20					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Kronos2001 wrote:</cite><blockquote><p>Interesting to see that the code is working for you.&nbsp; You can see in git that blogic has put in a lot of time on the Lantiq support.</p></blockquote></div><p>Absolutely, and his efforts are greatly appreciated! As well as those of others (particularly on kitz.co.uk).</p><div class="quotebox"><cite>Kronos2001 wrote:</cite><blockquote><p>I haven&#039;t tried setting the target noise margin with locs.&nbsp; Seems the value you need to provide is a change in noise margin value, and I would guess multiplied by 10.&nbsp; So to reduce target noise margin by 1.5dB would be <strong>locs 0 -15</strong>.&nbsp; I&#039;m going to try to see if BT&#039;s DLM will notice my line has become stable and see what it does.</p></blockquote></div><p>I have tried various negative and positive values up to -100, but always end up with the same SNRM. Don&#039;t forget to resync after changing the value (<strong>acs 2</strong>).</p><div class="quotebox"><cite>Kronos2001 wrote:</cite><blockquote><p>Thanks for trying it.&nbsp; It&#039;s mostly a matter of updating source code versions and hash values.&nbsp; Just one thing.&nbsp; Could you please run the following on you router with the current firmware? </p><div class="codebox"><pre><code>opkg list | grep ltq-</code></pre></div><p>&nbsp; That would be quite helpful as I&#039;ve really focused on the VDSL support side.</p></blockquote></div><div class="codebox"><pre><code>root@modem:~# opkg list | grep ltq
kmod-ltq-atm-vr9 - 3.10.36-1
kmod-ltq-ifxos - 3.10.36+1.5.14-3
kmod-ltq-ptm-vr9 - 3.10.36-1
kmod-ltq-vdsl-vr9 - 3.10.36+4.11.4-1
kmod-ltq-vdsl-vr9-mei - 3.10.36+1.2.0-1
ltq-vdsl-app - 4.11.4-1</code></pre></div><p>I wouldn&#039;t really need both atm and ptm kernel modules, but I can spare a couple of bytes and will be ready when VDSL will finally arrive here (if ever). Firmware is version 5.5.2.0.1.1 by the way; the newer version linked here did not work on my device.</p><p>For completeness: I&#039;m using it as a pure modem in bridge mode, where my OpenWRT router handles the pppoe connection. There were earlier reports that such a setup was problematic, but it works ok here.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235993">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">narotic</div>
					<div class="post-datetime">
						8 Jun 2014, 13:42					</div>
				</div>
				<div class="post-content content">
					<p>Your patch compiles without problems on r41051 and seems to run fine. Do you plan a pull request for OpenWRT?</p><p>The new firmware (5.5.3.3.1.2) doesn&#039;t work for me however: the modem reports an exception and doesn&#039;t sync. Since the Vodafone EasyBox 904 xDSL is used in Germany, I suspect the firmware is only suited for Annex B.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236994">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">vrx200</div>
					<div class="post-datetime">
						16 Jun 2014, 17:02					</div>
				</div>
				<div class="post-content content">
					<p>Trying to make some config changes before going live on the vdsl.</p><p>Keep getting:</p><div class="codebox"><pre><code>/build_dir/target-mips_34kc+dsp_uClibc-0.9.33.2/linux-lantiq_xrx200/ltq-ptm-vr9/ifxmips_ptm_vdsl.c:281:ptm_hard_start_xmit: not in showtime </code></pre></div><br /><p>Any tips on how to stop this repeating over and over to allow some configs before connecting .<br />Or maybe I&#039;ve got something missing in the build?</p><p>Thanks again!</p>											<p class="post-edited">(Last edited by <strong>vrx200</strong> on 16 Jun 2014, 17:09)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p237019">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">Kronos2001</div>
					<div class="post-datetime">
						16 Jun 2014, 20:26					</div>
				</div>
				<div class="post-content content">
					<p>I get this problem as well.&nbsp; All it means is that it&#039;s trying to send data out through the VDSL connection, ptm0, before the connection is made.&nbsp; showtime means that connection has been made and is ready.&nbsp; It might be possible to fix this with dependencies in the init system, but I don&#039;t know what would be needed for that.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p243282">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">vrx200</div>
					<div class="post-datetime">
						9 Aug 2014, 01:01					</div>
				</div>
				<div class="post-content content">
					<p>Quick update with this.</p><p>So far so good , nice&nbsp; stable a joy to use...... Thanks kronos!</p><p>Run simply in bridge mode config interface &#039;lan&#039;</p><p>Lan1 ------------------------&gt; router wan <br />Lan2 ---&gt;5 port switch---&gt; router lan</p><p>Is there a way to configure lan2 to aviod the 5 port switch on a router such as the hh4/hh5? </p><p>Something like the unlocked HG612 does with PTM1.301 or a 192.168.1.2 ip option like the standard unlocked eci/r patch ?</p><p>Tried various switch configs and vlans options but no joy as of yet.</p><p>Worked through <a href="http://wiki.openwrt.org/doc/uci/network">http://wiki.openwrt.org/doc/uci/network</a>&nbsp; &amp; <a href="http://wiki.openwrt.org/doc/uci/network/switch">http://wiki.openwrt.org/doc/uci/network/switch</a>&nbsp; <br />No luck as of yet . { Networking is not a strong point &amp; probably doing something silly }</p><br /><p>Any help , pointers would be most welcome!<br />Thank again for the help!</p>											<p class="post-edited">(Last edited by <strong>vrx200</strong> on 9 Aug 2014, 03:14)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p244943">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">iMx</div>
					<div class="post-datetime">
						26 Aug 2014, 12:03					</div>
				</div>
				<div class="post-content content">
					<p>vrx220, I suspect we&#039;re after the same thing - I started a post below:</p><p><a href="https://forum.openwrt.org/viewtopic.php?id=52358">https://forum.openwrt.org/viewtopic.php?id=52358</a></p><p>The aspect that confused me, I can find OpenWRT boot logs (On the Kitz thread) that are supposedly running the same hardware version as me, and yet they see eth0 and eth1 in their boot logs?</p><p>The default ECI firmware seems to assign VLAN 102 to the bridge interface, i.e br0.102, when you activate the second port.&nbsp; Need to find some time to have a play with OpenWRT using a similar concept.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p245085">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">vrx200</div>
					<div class="post-datetime">
						27 Aug 2014, 17:53					</div>
				</div>
				<div class="post-content content">
					<p>Hi</p><p>First I tried this:<br /><a href="http://simplebeian.wordpress.com/2014/03/12/accessing-your-modem-from-openwrt-router/">http://simplebeian.wordpress.com/2014/0 … rt-router/</a></p><p>Then I also noticed the old builds eth0/eth1 like you.</p><p>The old dts files used to have two interface options hence the etho &amp; eth1 in earlier builds.</p><p>old lantiq .dts-files<br /></p><div class="codebox"><pre><code>+++@92 &amp; 107
lan1: interface@0 
lan2: interface@1 </code></pre></div><p>This seem to have caused a load of put through issues highlighted on the kitz thread.&nbsp; {Maybe due to etop reisters ?}</p><p>You could try adding the oem switch_utility into the build&nbsp; ifx_ethsw /switch_utility thats is in the openreach glp files.<br /><a href="http://www.openreach.co.uk/orpg/home/products/super-fastfibreaccess/super-fastfibreaccess/landrgnu.do">http://www.openreach.co.uk/orpg/home/pr … andrgnu.do</a></p><p>Another option is to try current openwrt xway switch into the dts files.<br />Add lantiq,switch; on line 98 into the file.</p><div class="codebox"><pre><code> target/linux/lantiq/dts/VG3503J.dtsi
++98 
lantiq,switch;</code></pre></div><br /><p>Not had much luck with it yet or really the time to play around.&nbsp; Also networking is not a strong point of mine.</p><div class="codebox"><pre><code>root@OpenWrt:/# swconfig dev switch0 help
switch0: eth0(Lantiq XRX200 Switch), ports: 7 (cpu @ 6), vlans: 64
     --switch
        Attribute 1 (int): enable_vlan (Enable VLAN mode)
        Attribute 2 (none): apply (Activate changes in the hardware)
        Attribute 3 (none): reset (Reset the switch)
     --vlan
        Attribute 1 (int): vid (VLAN ID (0-4094))
        Attribute 2 (int): enable (Enable VLAN)
        Attribute 3 (ports): ports (VLAN port mapping)
     --port
        Attribute 1 (int): uvr (Unknown VLAN Rule)
        Attribute 2 (int): vsr (VLAN Security Rule)
        Attribute 3 (int): vinr (VLAN Ingress Tag Rule)
        Attribute 4 (int): tvm (Transparent VLAN Mode)
        Attribute 5 (int): pvid (Primary VLAN ID)
        Attribute 6 (string): link (Get port link information)

root@OpenWrt:/# swconfig dev switch0 show
Global attributes:
        enable_vlan: 0
Port 0:
        uvr: 0
        vsr: 0
        vinr: 0
        tvm: 0
        pvid: 1
        link: port:0 link:down
Port 1:
        uvr: 0
        vsr: 0
        vinr: 0
        tvm: 0
        pvid: 1
        link: port:1 link:down
Port 2:
        uvr: 0
        vsr: 0
        vinr: 0
        tvm: 0
        pvid: 1
        link: port:2 link:up speed:100baseT full-duplex auto
Port 3:
        uvr: 0
        vsr: 0
        vinr: 0
        tvm: 0
        pvid: 1
        link: port:3 link:down
Port 4:
        uvr: 0
        vsr: 0
        vinr: 0
        tvm: 0
        pvid: 1
        link: port:4 link:up speed:100baseT full-duplex auto
Port 5:
        uvr: 0
        vsr: 0
        vinr: 0
        tvm: 0
        pvid: 1
        link: port:5 link:down
Port 6:
        uvr: 0
        vsr: 0
        vinr: 0
        tvm: 0
        pvid: 1
        link: port:6 link:up speed:1000baseT full-duplex auto
VLAN 1:
        vid: 1
        enable: 1
        ports: 0 1 2 3 4 5 6
root@OpenWrt:/# </code></pre></div><p>Hope this helps as your scripting software would be ideal addition to these eci&#039;r</p>											<p class="post-edited">(Last edited by <strong>vrx200</strong> on 27 Aug 2014, 18:12)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p245089">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">iMx</div>
					<div class="post-datetime">
						27 Aug 2014, 18:49					</div>
				</div>
				<div class="post-content content">
					<p>Cool, thanks.</p><p>&quot;Software&quot; might be going a bit far, I hacked together a modification to the muninlite package in the OpenWRT opkg repo - from bugmancx&#039;s HG612 munin templates on github&nbsp; - can now graph the basics using a munin instance elsewhere.</p><p>I just edited the munin-node script /usr/sbin/munin-node to include the below, after installing muninlite on the ECI:</p><div class="codebox"><pre><code>fetch_dsl() {
  echo &quot;dsl_dw_att_data_rate.value&quot; $(grep &quot;Attain Data Rate&quot; /tmp/dsl.txt |cut -d:  -f2|cut -d\  -f1)
  echo &quot;dsl_up_att_data_rate.value&quot; $(grep &quot;Attain Data Rate&quot; /tmp/dsl.txt |cut -d:  -f2|cut -d\  -f4)
  echo &quot;dsl_dw_act_data_rate.value&quot; $(grep &quot;Actual Data Rate&quot; /tmp/dsl.txt |cut -d:  -f2|cut -d\  -f1)
  echo &quot;dsl_up_act_data_rate.value&quot; $(grep &quot;Actual Data Rate&quot; /tmp/dsl.txt |cut -d:  -f2|cut -d\  -f4)
}

  
config_dsl() {
  echo &quot;graph_title Attainable vs Actual&quot;
  echo &quot;graph_category dsl&quot;
  echo &quot;graph_args --base 1000&quot;
  echo &quot;graph_scale yes&quot;
  echo &quot;graph_vlabel Actual (-) Attainable (+)&quot;
  echo &#039;dsl_dw_act_data_rate.label Act. Down&#039;
  echo &#039;dsl_dw_act_data_rate.draw LINE&#039;
  echo &#039;dsl_dw_act_data_rate.graph no&#039;
  echo &#039;dsl_up_act_data_rate.label Act. Up&#039;
  echo &#039;dsl_up_act_data_rate.draw LINE&#039;
  echo &#039;dsl_up_act_data_rate.graph no&#039;
  echo &#039;dsl_dw_att_data_rate.label Downstream&#039;
  echo &#039;dsl_dw_att_data_rate.draw AREA&#039;
  echo &#039;dsl_dw_att_data_rate.negative dsl_dw_act_data_rate&#039;
  echo &#039;dsl_up_att_data_rate.label Upstream&#039;
  echo &#039;dsl_up_att_data_rate.draw AREA&#039;
  echo &#039;dsl_up_att_data_rate.negative dsl_up_act_data_rate&#039;
}



fetch_dsl_errors() {
  echo &quot;dsl_dw_fec_err.value&quot; $(grep ^&quot;FEC Errors&quot; /tmp/dsl.txt |cut -d:  -f2|cut -d\  -f1)
  echo &quot;dsl_up_fec_err.value&quot; $(grep ^&quot;FEC Errors&quot; /tmp/dsl.txt |cut -d:  -f2|cut -d\  -f3)
  echo &quot;dsl_dw_crc_err.value&quot; $(grep ^&quot;CRC_P Errors&quot; /tmp/dsl.txt |cut -d:  -f2|cut -d\  -f1)
  echo &quot;dsl_up_crc_err.value&quot; $(grep ^&quot;CRC_P Errors&quot; /tmp/dsl.txt |cut -d:  -f2|cut -d\  -f3)
}

config_dsl_errors() {
  echo &quot;graph_title Errors&quot;
  echo &quot;graph_category dsl&quot;
  echo &quot;graph_args --base 1000&quot;
  echo &#039;graph_vlabel errors down (-) / up (+) per ${graph_period}&#039;
  echo &quot;graph_scale no&quot;
  echo &quot;dsl_dw_crc_err.label CRC errors&quot;
  echo &quot;dsl_dw_crc_err.type DERIVE&quot;
  echo &quot;dsl_dw_crc_err.graph no&quot;
  echo &quot;dsl_up_crc_err.label CRC errors&quot;
  echo &quot;dsl_up_crc_err.type DERIVE&quot;
  echo &quot;dsl_up_crc_err.negative dsl_dw_crc_err&quot;
  echo &quot;dsl_up_crc_err.info Errors received&quot;
  echo &quot;dsl_dw_fec_err.label FEC errors&quot;
  echo &quot;dsl_dw_fec_err.type DERIVE&quot;
  echo &quot;dsl_dw_fec_err.graph no&quot;
  echo &quot;dsl_up_fec_err.label FEC errors&quot;
  echo &quot;dsl_up_fec_err.type DERIVE&quot;
  echo &quot;dsl_up_fec_err.negative dsl_dw_fec_err&quot;
  echo &quot;dsl_up_fec_err.info Errors received&quot;      
}     


fetch_dsl_line_att() {
  echo &quot;dsl_line_att.value&quot; $(grep ^&quot;Line Attenuation&quot; /tmp/dsl.txt |cut -d:  -f2|cut -d\  -f1|sed &quot;s/dB//&quot;)
}

config_dsl_line_att() {
  echo &quot;graph_title Line Attenuation (dB)&quot;
  echo &#039;graph_args --base 1000&#039;
  echo &#039;graph_vlabel Line Attenuation (dB)&#039;
  echo &#039;graph_category dsl&#039;
  echo &#039;graph_scale no&#039;
  echo &quot;dsl_line_att.label Line Attenuation&quot;
  echo &quot;dsl_line_att.draw LINE&quot;
}


fetch_dsl_sig_att() {
  echo &quot;dsl_sig_att.value&quot; $(grep ^&quot;Signal Attenuation&quot; /tmp/dsl.txt |cut -d:  -f2|cut -d\  -f1|sed &quot;s/dB//&quot;)
}

config_dsl_sig_att() {
  echo &quot;graph_title Signal Attenuation (dB)&quot;
  echo &#039;graph_args --base 1000&#039;
  echo &#039;graph_vlabel Signal Attenuation (dB)&#039;
  echo &#039;graph_category dsl&#039;
  echo &#039;graph_scale no&#039;
  echo &quot;dsl_sig_att.label Signal Attenuation&quot;
  echo &quot;dsl_sig_att.draw LINE&quot;
}
 

fetch_dsl_int_dep() {
  echo &quot;dsl_dw_int_dep.value&quot; $(grep ^&quot;Interleave Depth&quot; /tmp/dsl.txt |cut -d:  -f2|cut -d\  -f1)
  echo &quot;dsl_up_int_dep.value&quot; $(grep ^&quot;Interleave Depth&quot; /tmp/dsl.txt |cut -d:  -f2|cut -d\  -f3)
}

config_dsl_int_dep() {  
  echo &#039;graph_title Interleave Depth&#039;
  echo &#039;graph_args --base 1000&#039;
  echo &#039;graph_vlabel Interleave Depth&#039;
  echo &#039;graph_category dsl&#039;
  echo &#039;graph_scale no&#039;
  echo &#039;dsl_dw_int_dep.label Downstream&#039;
  echo &#039;dsl_dw_int_dep.draw LINE&#039;
  echo &#039;dsl_up_int_dep.label Upstream&#039;
  echo &#039;dsl_up_int_dep.draw LINE&#039;
}


fetch_dsl_noise() {
  echo &quot;dsl_dw_noise.value&quot; $(grep ^&quot;Noise Margin&quot; /tmp/dsl.txt |cut -d:  -f2|cut -d\  -f1|sed &quot;s/dB//&quot;)
  echo &quot;dsl_up_noise.value&quot; $(grep ^&quot;Noise Margin&quot; /tmp/dsl.txt |cut -d:  -f2|cut -d\  -f3|sed &quot;s/dB//&quot;)
}

config_dsl_noise() {  
  echo &#039;graph_title Noise Margin (dB)&#039;
  echo &#039;graph_args --base 1000&#039;
  echo &#039;graph_vlabel Noise Margin (dB)&#039;
  echo &#039;graph_category dsl&#039;
  echo &#039;graph_scale no&#039;
  echo &#039;dsl_dw_noise.label Downstream&#039;
  echo &#039;dsl_dw_noise.draw LINE&#039;
  echo &#039;dsl_up_noise.label Upstream&#039;
  echo &#039;dsl_up_noise.draw LINE&#039;
} 
 
  
fetch_dsl_tran_pwr() {
  echo &quot;dsl_dw_tran_pwr.value&quot; $(grep ^&quot;Transmit power&quot; /tmp/dsl.txt |cut -d:  -f2|cut -d\  -f1|sed &quot;s/dBm//&quot;)
  echo &quot;dsl_up_tran_pwr.value&quot; $(grep ^&quot;Transmit power&quot; /tmp/dsl.txt |cut -d:  -f2|cut -d\  -f3|sed &quot;s/dBm//&quot;)
}

config_dsl_tran_pwr() {  
  echo &#039;graph_title Transmit Power (dBm)&#039;
  echo &#039;graph_args --base 1000&#039;
  echo &#039;graph_vlabel Transmit Power (dBm)&#039;
  echo &#039;graph_category dsl&#039;
  echo &#039;graph_scale no&#039;
  echo &#039;dsl_dw_tran_pwr.label Downstream&#039;
  echo &#039;dsl_dw_tran_pwr.draw LINE&#039;
  echo &#039;dsl_up_tran_pwr.label Upstream&#039;
  echo &#039;dsl_up_tran_pwr.draw LINE&#039;
} </code></pre></div><p>Then enable cron:</p><div class="codebox"><pre><code>/etc/init.d/cron enable
/etc/init.d/cron start</code></pre></div><p>Add the following cron entry:</p><div class="codebox"><pre><code>*/5 * * * *   /etc/init.d/dsl_control status &gt; /tmp/dsl.txt</code></pre></div><p>Then point your munin instance at the ECI&#039;s LAN IP.&nbsp; Quick and very dirty, but gives me some stats.&nbsp; I messed around with rebuilding OpenWRT to include busybox login, so that telnet could be enabled again, but ultimately settled on just using muninlite a) because I already have munin running b) I&#039;d rather use something dedicated rather than running a desktop app. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p245090">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">vrx200</div>
					<div class="post-datetime">
						27 Aug 2014, 19:37					</div>
				</div>
				<div class="post-content content">
					<p>Excellent Thanks! {off the take a look <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />}</p><p>If you do {or anyone else reading}&nbsp; manage&nbsp; to find a&nbsp; lan1 &amp; lan2 set up&nbsp; similar the hg612, could post a how to.....as it would be very welcome!</p><p>Its been niggling me for a while lan1 ptm101 &amp;&nbsp; lan2 ptm103 grrrr.</p><div class="codebox"><pre><code> {From asbokids hg612 work /blog}
We see there are two Ethernet VLAN’s being presented down the VDSL PTM link, one which gets bridged directly through to the internal ‘LAN1&#039; port on the Huawei device. This is our internet connection, which gets tagged with VLAN tag 101 on the PTM link.

However, there is another connection, VLAN301, which terminates on the Huawei device itself; If you click around the Huawei web interface, you’ll find a DHCP client expects to get an IP address from this VLAN, providing a control network for the HG216 to run TR-069 autoconfiguration.

https://en.wikipedia.org/wiki/TR-069

Because the existing PTM1.301 interface isnt a bridge it’s IP terminated, I couldn’t find any way of bridging this VLAN directly to a laptop via the ‘unused’ LAN2 port (that you’ll be familiar with if you’ve updated the firmware on your Huawei device, as it’s this port that is configured on 192.168.1.1/24 for the web interface and telnet access).

However, it can be done through the CLI;

using brctl command after logging in via telnet and typing ‘shell’, you can end up with the PTM1.301 interface bridged to the physical LAN2</code></pre></div><p>Thanks!</p>											<p class="post-edited">(Last edited by <strong>vrx200</strong> on 27 Aug 2014, 20:58)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p245348">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">vrx200</div>
					<div class="post-datetime">
						29 Aug 2014, 22:38					</div>
				</div>
				<div class="post-content content">
					<p>Another option could be to try two interfaces eth0 &amp; eth1.<br />The phy 11g&#039;s have been patched so it might not suffer the put though issues.</p><p>Add an extra interface&nbsp; eth0 &amp; eth1 interface in the dtsi file.<br /></p><div class="codebox"><pre><code> target/linux/lantiq/dts/VG3503J.dtsi
eth@E108000 {
            #address-cells = &lt;1&gt;;
            #size-cells = &lt;0&gt;;
            compatible = &quot;lantiq,xrx200-net&quot;;
            reg = &lt;    0xE108000 0x3000 /* switch */
                0xE10B100 0x70 /* mdio */
                0xE10B1D8 0x30 /* mii */
                0xE10B308 0x30 /* pmac */
            &gt;;
            interrupt-parent = &lt;&amp;icu0&gt;;
            interrupts = &lt;73 72&gt;;
                        
            lan1: interface@0 {
                compatible = &quot;lantiq,xrx200-pdi&quot;;
                #address-cells = &lt;1&gt;;
                #size-cells = &lt;0&gt;;
                reg = &lt;0&gt;;
                mac-address = [ 00 11 22 33 44 55 ];
                ethernet@4 {
                    compatible = &quot;lantiq,xrx200-pdi-port&quot;;
                    reg = &lt;4&gt;;
                    phy-mode = &quot;mii&quot;;
                    phy-handle = &lt;&amp;phy13&gt;;
                };
            };
                       
                        lan2: interface@1 {
                    compatible = &quot;lantiq,xrx200-pdi&quot;;
                #address-cells = &lt;1&gt;;
                #size-cells = &lt;0&gt;;
                reg = &lt;1&gt;;
                mac-address = [ 00 11 22 33 44 56 ];
                          
                                ethernet@2 {
                        compatible = &quot;lantiq,xrx200-pdi-port&quot;;
                        reg = &lt;2&gt;;
                        phy-mode = &quot;mii&quot;;
                        phy-handle = &lt;&amp;phy11&gt;;
                             };
            };
 </code></pre></div>											<p class="post-edited">(Last edited by <strong>vrx200</strong> on 29 Aug 2014, 22:47)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p245350">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">iMx</div>
					<div class="post-datetime">
						29 Aug 2014, 22:45					</div>
				</div>
				<div class="post-content content">
					<p>We&#039;re kind of hijacking this thread <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> I have posted to the dedicated one that I started, will try this last option as well.</p><p><a href="https://forum.openwrt.org/viewtopic.php?pid=245349#p245349">https://forum.openwrt.org/viewtopic.php … 49#p245349</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p246578">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">deckso</div>
					<div class="post-datetime">
						9 Sep 2014, 22:11					</div>
				</div>
				<div class="post-content content">
					<p>could any1 give info step by step how turn on VDSL (RJ11)&nbsp; on tplink 8970<br />on ATM mode...i get synchro but cant connect...nothin happen</p><p>on PTM no synchro my config is:</p><div class="quotebox"><blockquote><p>config interface &#039;loopback&#039;<br />option ifname &#039;lo&#039;<br />option proto &#039;static&#039;<br />option ipaddr &#039;127.0.0.1&#039;<br />option netmask &#039;255.0.0.0&#039;</p><p>config globals &#039;globals&#039;<br />option ula_prefix &#039;fd1d:62de:db00::/48&#039;</p><p>config interface &#039;lan&#039;<br />option ifname &#039;eth0&#039;<br />option force_link &#039;1&#039;<br />option type &#039;bridge&#039;<br />option proto &#039;static&#039;<br />option netmask &#039;255.255.255.0&#039;<br />option ip6assign &#039;60&#039;<br />option macaddr &#039;e8:de:27:bc:d0:ba&#039;<br />option ipaddr &#039;192.168.1.2&#039;<br />option gateway &#039;192.168.1.1&#039;</p><p>config interface &#039;wan&#039;<br />option _orig_bridge &#039;false&#039;<br />option ifname &#039;ptm0.35&#039;<br />option proto &#039;pppoe&#039;<br />option username &#039;neostrada.pl&#039;<br />option password &#039;a&#039;</p><p>config interface &#039;wan6&#039;<br />option ifname &#039;@wan&#039;<br />option proto &#039;dhcpv6&#039;</p><p>config vdsl &#039;dsl&#039;<br />option annex &#039;a&#039;<br />option firmware &#039;/lib/firmware/vdsl.bin&#039;<br />option tone &#039;av&#039;<br />option xfer_mode &#039;ptm&#039;</p></blockquote></div><p> </p><div class="quotebox"><blockquote><p>patch który dałes: root@OpenWrt:/tmp# zcat lantiq-update.patch.gz | patch -p1<br />-ash: patch: not found<br />root@OpenWrt:/tmp#</p></blockquote></div><p> </p><div class="quotebox"><blockquote><p>after delete kmod-adsl<br />Tue Sep 9 17:53:42 2014 user.emerg syslog: Failed to find ltq_ptm_vr9. Maybe it is a built in module ?</p></blockquote></div>											<p class="post-edited">(Last edited by <strong>deckso</strong> on 9 Sep 2014, 22:12)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p246599">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">vrx200</div>
					<div class="post-datetime">
						10 Sep 2014, 01:39					</div>
				</div>
				<div class="post-content content">
					<p>You need to manually add the lantiq vdsl driver into the /lib/firmware either at build stage or via scp (Secure Copy)&nbsp; if openwrt is already installed&nbsp; on the modem.</p><p>Also make sure to&nbsp; install&nbsp; the correct vdsl firmware for your providers band plan profiles:</p><div class="codebox"><pre><code>The following shows the band profile and band plan compatibility:
Band Profile List Band Plan List
0 VDSL2 Profile8a 0 Annex A M1_EU32
1 VDSL2 Profile8b 1 Annex A M9_EU64
2 VDSL2 Profile8c 2 Annex A EU128
3 VDSL2 Profile8d 3 Annex B 997-M1c-A-7
4 VDSL2 Profile12a 4 Annex B 997-M2x-A
5 VDSL2 Profile12b 5 Annex B 997-M2x-M
6 VDSL2 Profile17a 6 Annex B 998-M1x-A
7 VDSL2 Profile30a 7 Annex B 998-M1x-B
8 VDSL2 Profile17b 8 Annex B 998-M2x-A
                   9 Annex B 998-M2x-M
                   10 Annex B 998-M2x-B
                   11 Annex B 998-M2x-NUS0
                   12 Annex B 998e17-M2x-NUS0
                   13 Annex B 998ADE17-M2x-A
                   14 Annex B 998ADE30-M2x-JUS0
                   15 Annex C_A
                   16 Annex C_M
                   17 Annex C_8K</code></pre></div><p>In Kronos&#039;s first post example&nbsp; dsl_vr9_firmware&nbsp; is&nbsp; _xdsl-05.05.01.07.01.<strong>06</strong> &lt;-vdsl part| _ | adsl part -&gt;05.05.03.03.01.02<br />The last digit in the first number string represents the profile &amp; plan, which in this case&nbsp; is : 17a&nbsp; Annex B 998-M1x-A.</p>											<p class="post-edited">(Last edited by <strong>vrx200</strong> on 10 Sep 2014, 02:00)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p246670">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">deckso</div>
					<div class="post-datetime">
						10 Sep 2014, 19:52					</div>
				</div>
				<div class="post-content content">
					<p>i found how to make it work on different router&nbsp; (there is all info about config)<br /><a href="ftp://ftp.draytek.pl/POMOC/Gotowe_przyklady/WAN/WAN_NeostradaFiber.pdf">ftp://ftp.draytek.pl/POMOC/Gotowe_przyk … aFiber.pdf</a></p><br /><p>i have it - lib/firmware/vdsl.bin<br />my profile is:&nbsp; VDSL2 Profile17a 6 Annex B 998-M1x-A<br />file name: dsl_vr9_firmware_xdsl-05.06.00.08.01.06_05.05.02.00.01.01 it should be ok ? <br />i dont get synchro on PTM moze.... but on ATM mode... i have synchro... but cant connect...cant do nothin...<br />Status: UP<br />Line State: showtime_tc_sync [0x801]<br />Line Speed: 66.112 Mb/s / 8.568 Mb/s<br />Line Attenuation: 18.2 dB / 0 dB<br />Noise Margin: 9 dB / 8.3 dB</p><br /><p>i read that i need VLAN ID : 35.... how to make it work ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p246673">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">vrx200</div>
					<div class="post-datetime">
						10 Sep 2014, 20:15					</div>
				</div>
				<div class="post-content content">
					<p>Has kmod-ltq-ptm-vr9 been definitenly ticked in the build root?</p><div class="codebox"><pre><code>root@modem:~# opkg list | grep ltq-</code></pre></div><p>If everything is installed as it should be try the double check the firewall settings for the vlan.</p><p><a href="http://openrouter.info/forum/viewtopic.php?f=18&amp;t=2727&amp;sid=467b1ee841723d4e2a90c1d1582c4744">http://openrouter.info/forum/viewtopic. … d1582c4744</a></p>											<p class="post-edited">(Last edited by <strong>vrx200</strong> on 10 Sep 2014, 20:47)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p246680">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">deckso</div>
					<div class="post-datetime">
						10 Sep 2014, 20:44					</div>
				</div>
				<div class="post-content content">
					<p>root@OpenWrt:~# opkg list | grep ltq-<br />kmod-ltq-atm-vr9 - 3.10.49-1<br />kmod-ltq-deu-vr9 - 3.10.49-1<br />kmod-ltq-hcd-vr9 - 3.10.49-1<br />kmod-ltq-ifxos - 3.10.49+1.5.14-3<br />kmod-ltq-vdsl-vr9 - 3.10.49+4.11.4-1<br />kmod-ltq-vdsl-vr9-mei - 3.10.49+1.2.0-1<br />ltq-vdsl-app - 4.11.4-1<br />ltq-vdsl-vr9-fw-installer - 1-1</p><p>im newbe please give command and i will g0ive answer</p><br /><p>on this site guys dont know yet whats up <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p>											<p class="post-edited">(Last edited by <strong>deckso</strong> on 10 Sep 2014, 20:53)</p>
									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=50860&amp;p=2.html">2</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>