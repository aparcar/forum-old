<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> IPV6 in local lan</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 16 Apr 2018 and 22 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 2 of 2</div><nav><ul><li><a href="viewtopic.php%3Fid=27508&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p134860">
				<div class="post-metadata">
					<div class="post-num">Post #26</div>
					<div class="post-author">Despot</div>
					<div class="post-datetime">
						7 May 2011, 20:33					</div>
				</div>
				<div class="post-content content">
					<p>Okay, if you didn&#039;t bridge network links and used Unique Local addresses on one link and Globally Unique addresses on the other, I can see ULA + GUA being useful for the part of the network that needed global access. </p><p>I was going to ask why one couldn&#039;t achieve the same goal by subnetting a /64 global prefix (since we all seem to have one and the number of addresses available in that space is commonly known as &quot;massive&quot;) and configuring your firewall and routing tables accordingly. Then I ran across this post: <a href="http://www.clarksys.com/blog/2010/08/18/howto-subnet-ipv6-for-network-links/">http://www.clarksys.com/blog/2010/08/18 … ork-links/</a></p><p>...now I have to try it. <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p134899">
				<div class="post-metadata">
					<div class="post-num">Post #27</div>
					<div class="post-author">Cybjit</div>
					<div class="post-datetime">
						8 May 2011, 16:16					</div>
				</div>
				<div class="post-content content">
					<p>I still do not understand your aversion against using both ULA and GUA on the same interface(s).<br />Of course it is possible to do everything with GUA, but some people want to have a stable local prefix for local communication. </p><p>If I for example publish a service only intended for my local network using ULA, I can simply enter the address statically in my DNS and filter fc00::/7 at my border.<br />Using GUA I have to make sure that I know which source addresses i should allow or not, or employ a stateful firewall at the border. For DNS something like mDNS is required as my ISP will probably change my prefix from time to time.</p><p>It is worth noticing that the blog post you linked to was about someone having a direct allocation from ARIN.</p>											<p class="post-edited">(Last edited by <strong>Cybjit</strong> on 8 May 2011, 16:17)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p135622">
				<div class="post-metadata">
					<div class="post-num">Post #28</div>
					<div class="post-author">KillaB</div>
					<div class="post-datetime">
						20 May 2011, 01:08					</div>
				</div>
				<div class="post-content content">
					<p>Interesting....I see that newer FRITZ!Box models use ULA by default and then automatically disable it&#039;s use upon configuring a global prefix.<br /><a href="http://www.getipv6.info/index.php/Customer_problems_that_could_occur#AVM">http://www.getipv6.info/index.php/Custo … _occur#AVM</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p135809">
				<div class="post-metadata">
					<div class="post-num">Post #29</div>
					<div class="post-author">Despot</div>
					<div class="post-datetime">
						23 May 2011, 00:39					</div>
				</div>
				<div class="post-content content">
					<p>Cybjit, I think you&#039;ve misunderstood my last post. I was acknowledging that there are certain scenarios in which a ULA would be useful, not expressing aversion to them. That said, as a firm believer in the KISS principle, I am certainly inclined to use the simplest configuration possible. The potential for errors and vulnerabilities increases (possibly exponentially) as the complexity of a configuration increases. So I wouldn&#039;t want to deploy ULA + GUA without a compelling reason, such as the scenarios you&#039;ve described.</p><p>Do you have any further information on the possibility of ISPs changing customers&#039; prefixes? I hadn&#039;t heard of this, and would like to know more. I sort of expected DDNS to join IP masquarading on the list of technologies that were thankfully unnecessary in IPv6 environments.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p136582">
				<div class="post-metadata">
					<div class="post-num">Post #30</div>
					<div class="post-author">Cybjit</div>
					<div class="post-datetime">
						6 Jun 2011, 00:38					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>KillaB wrote:</cite><blockquote><p>Interesting....I see that newer FRITZ!Box models use ULA by default and then automatically disable it&#039;s use upon configuring a global prefix.<br /><a href="http://www.getipv6.info/index.php/Customer_problems_that_could_occur#AVM">http://www.getipv6.info/index.php/Custo … _occur#AVM</a></p></blockquote></div><p>I did not realize ULA is not part of the default address selection, but this will be fixed by <a href="http://tools.ietf.org/html/draft-ietf-6man-rfc3484-revise-02">the next revision of RFC 3484</a>.<br />Apparently Windows 7 does not have any rule for them (<a href="http://starshock.blogspot.com/2011/01/windows-7-source-address-selection-and.html">blog post</a>), so that can cause problems.</p><div class="quotebox"><cite>Despot wrote:</cite><blockquote><p>Cybjit, I think you&#039;ve misunderstood my last post. I was acknowledging that there are certain scenarios in which a ULA would be useful, not expressing aversion to them. That said, as a firm believer in the KISS principle, I am certainly inclined to use the simplest configuration possible. The potential for errors and vulnerabilities increases (possibly exponentially) as the complexity of a configuration increases. So I wouldn&#039;t want to deploy ULA + GUA without a compelling reason, such as the scenarios you&#039;ve described.</p><p>Do you have any further information on the possibility of ISPs changing customers&#039; prefixes? I hadn&#039;t heard of this, and would like to know more. I sort of expected DDNS to join IP masquarading on the list of technologies that were thankfully unnecessary in IPv6 environments.</p></blockquote></div><p>I definitely agree with you that things should be kept as simple as possible, so if they are not needed, ULA should not be used.</p><p>Not really, but I have not heard any ISP say prefixes will be stable. Considering broadband ISPs are very late to the IPv6 party, I suspect they do not even know themselves how it will be handled.<br />It will probably be simplest for the ISP to not give any guarantees, but keep prefixes stable as long as network topology does not change.<br />There are also privacy implications of keeping an IP-address forever, so some customers might actually like to have their prefix changed periodically.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p203874">
				<div class="post-metadata">
					<div class="post-num">Post #31</div>
					<div class="post-author">Cybjit</div>
					<div class="post-datetime">
						6 Jun 2013, 12:17					</div>
				</div>
				<div class="post-content content">
					<p>I just had a look at the ULA generation in OpenWrt trunk, and it uses up a completely full random entropy pool.<br />Maybe I am nit-picking, but randomness might be scarce on a router just booting up, and I would rather see the bits used for the ssh key generation.</p><div class="codebox"><pre><code>#!/bin/sh

[ &quot;$(uci get network.globals.ula_prefix)&quot; != &quot;auto&quot; ] &amp;&amp; exit 0
# Sometimes results are empty, therefore try until it works...          
local r1 r2 r3
while [ -z &quot;$r1&quot; -o -z &quot;$r2&quot; -o -z &quot;$r3&quot; ]; do
        r1=$(printf &quot;%02x&quot; $(($(&lt;/dev/urandom tr -dc 0-9 | dd bs=9 count=1) % 256)))
        r2=$(printf &quot;%01x&quot; $(($(&lt;/dev/urandom tr -dc 0-9 | dd bs=9 count=1) % 65536)))
        r3=$(printf &quot;%01x&quot; $(($(&lt;/dev/urandom tr -dc 0-9 | dd bs=9 count=1) % 65536)))
done

uci -q batch &lt;&lt;-EOF &gt;/dev/null
        set network.globals.ula_prefix=fd$r1:$r2:$r3::/48
        commit network
EOF

exit 0</code></pre></div><p>It generates a large decimal number, modulate it down to a small one, and then convert it to hex.<br />Unfortunatly it sometimes gets octal numbers instead (starts with 0), which make the modulus fail, so it loops until it succeds.</p><p>Why not generate hex directly, for example:<br /></p><div class="codebox"><pre><code>r1=$(dd if=/dev/urandom bs=1 count=1 |hexdump -e &#039;1/1 &quot;%02x&quot;&#039;)
r2=$(dd if=/dev/urandom bs=2 count=1 |hexdump -e &#039;2/1 &quot;%02x&quot;&#039;)
r3=$(dd if=/dev/urandom bs=2 count=1 |hexdump -e &#039;2/1 &quot;%02x&quot;&#039;)</code></pre></div><p>Other parts of OpenWrt assumes the existance of hexdump, so I do not think that should be a problem.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p203877">
				<div class="post-metadata">
					<div class="post-num">Post #32</div>
					<div class="post-author">CyrusFF</div>
					<div class="post-datetime">
						6 Jun 2013, 12:54					</div>
				</div>
				<div class="post-content content">
					<p>There is no real reason for that other than my inability with complex shell-scripts. I just changed it to your variant. Thanks for your feedback.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p203881">
				<div class="post-metadata">
					<div class="post-num">Post #33</div>
					<div class="post-author">Cybjit</div>
					<div class="post-datetime">
						6 Jun 2013, 13:46					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>CyrusFF wrote:</cite><blockquote><p>There is no real reason for that other than my inability with complex shell-scripts. I just changed it to your variant. Thanks for your feedback.</p></blockquote></div><p>Glad I could help <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 2 of 2</div><nav><ul><li><a href="viewtopic.php%3Fid=27508&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>