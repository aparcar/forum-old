<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> How to build latest V4L</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 30 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p187075">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Eddiie</div>
					<div class="post-datetime">
						26 Dec 2012, 19:52					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I&#039;m still trying to resolve the symbol problems the em28xx module needs in order to work.&nbsp; In the hours of search and reading, it looks like support for my device is in the latest V4L modules at linuxtv.&nbsp; &nbsp; How does one download the latest source and build build for OpenWRT?&nbsp; &nbsp;Already am able to make my builds using the instructions provided on this site (trunk), what&#039;s next?&nbsp; The docs seems to fade away or maybe I have not finished reading yet.</p><p>attitude_adjustment</p><p>The directions on the site posted here:&nbsp; <br /><a href="http://www.linuxtv.org/wiki/index.php/How_to_Obtain,_Build_and_Install_V4L-DVB_Device_Drivers">http://www.linuxtv.org/wiki/index.php/H â€¦ ce_Drivers</a></p><p>don&#039;t seem to apply to OpenWRT, obviously.&nbsp; &nbsp;Do I maybe put this source in the package directory?</p>											<p class="post-edited">(Last edited by <strong>Eddiie</strong> on 26 Dec 2012, 19:59)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188612">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Eddiie</div>
					<div class="post-datetime">
						11 Jan 2013, 19:44					</div>
				</div>
				<div class="post-content content">
					<p>Anyone have a quick HOW TO build V4L&nbsp; - Video 4 Linux on OpenWRT?</p><p>I have trunk build environment, headers, latest code, when running make I get error -<br />make[2]: *** No rule to make target `/usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/wrppmc/Platform&#039;.&nbsp; Stop.</p><p>My command -<br />sudo make ARCH=mips CROSS_COMPILE=/home/Eddiie/Downloads/openwrt/trunk/build_dir/target-mips_r2_uClibc-0.9.33.2/OpenWrt-SDK-ar71xx-for-linux-i686-gcc-4.6-linaro_uClibc-0.9.33.2/staging_dir/toolchain-mips_r2_gcc-4.6-linaro_uClibc-0.9.33.2/bin/mips-openwrt-linux-uclibc-</p><br /><p>Eddiie@ubuntu2:~/media_build$ sudo make ARCH=mips CROSS_COMPILE=/home/Eddiie/Downloads/openwrt/trunk/build_dir/target-mips_r2_uClibc-0.9.33.2/OpenWrt-SDK-ar71xx-for-linux-i686-gcc-4.6-linaro_uClibc-0.9.33.2/staging_dir/toolchain-mips_r2_gcc-4.6-linaro_uClibc-0.9.33.2/bin/mips-openwrt-linux-uclibc-<br />make -C /home/Eddiie/media_build/v4l<br />make[1]: Entering directory `/home/Eddiie/media_build/v4l&#039;<br />creating symbolic links...<br />make -C firmware prep<br />make[2]: Entering directory `/home/Eddiie/media_build/v4l/firmware&#039;<br />make[2]: Leaving directory `/home/Eddiie/media_build/v4l/firmware&#039;<br />make -C firmware<br />make[2]: Entering directory `/home/Eddiie/media_build/v4l/firmware&#039;<br />make[2]: Nothing to be done for `default&#039;.<br />make[2]: Leaving directory `/home/Eddiie/media_build/v4l/firmware&#039;<br />Kernel build directory is /lib/modules/3.2.0-29-generic-pae/build<br />make -C ../linux apply_patches<br />make[2]: Entering directory `/home/Eddiie/media_build/linux&#039;<br />Patches for 3.2.0-29-generic-pae already applied.<br />make[2]: Leaving directory `/home/Eddiie/media_build/linux&#039;<br />make -C /lib/modules/3.2.0-29-generic-pae/build SUBDIRS=/home/Eddiie/media_build/v4l&nbsp; modules<br />make[2]: Entering directory `/usr/src/linux-headers-3.2.0-29-generic-pae&#039;<br />/usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/Kbuild.platforms:35: /usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/alchemy/Platform: No such file or directory<br />/usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/Kbuild.platforms:35: /usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/ar7/Platform: No such file or directory<br />/usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/Kbuild.platforms:35: /usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/ath79/Platform: No such file or directory<br />/usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/Kbuild.platforms:35: /usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/bcm47xx/Platform: No such file or directory<br />/usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/Kbuild.platforms:35: /usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/bcm63xx/Platform: No such file or directory<br />/usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/Kbuild.platforms:35: /usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/cavium-octeon/Platform: No such file or directory<br />/usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/Kbuild.platforms:35: /usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/cobalt/Platform: No such file or directory<br />/usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/Kbuild.platforms:35: /usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/dec/Platform: No such file or directory<br />/usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/Kbuild.platforms:35: /usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/emma/Platform: No such file or directory<br />/usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/Kbuild.platforms:35: /usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/jazz/Platform: No such file or directory<br />/usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/Kbuild.platforms:35: /usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/jz4740/Platform: No such file or directory<br />/usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/Kbuild.platforms:35: /usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/lantiq/Platform: No such file or directory<br />/usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/Kbuild.platforms:35: /usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/lasat/Platform: No such file or directory<br />/usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/Kbuild.platforms:35: /usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/loongson/Platform: No such file or directory<br />/usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/Kbuild.platforms:35: /usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/mipssim/Platform: No such file or directory<br />/usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/Kbuild.platforms:35: /usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/mti-malta/Platform: No such file or directory<br />/usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/Kbuild.platforms:35: /usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/netlogic/Platform: No such file or directory<br />/usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/Kbuild.platforms:35: /usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/pmc-sierra/Platform: No such file or directory<br />/usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/Kbuild.platforms:35: /usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/pnx833x/Platform: No such file or directory<br />/usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/Kbuild.platforms:35: /usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/pnx8550/Platform: No such file or directory<br />/usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/Kbuild.platforms:35: /usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/powertv/Platform: No such file or directory<br />/usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/Kbuild.platforms:35: /usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/rb532/Platform: No such file or directory<br />/usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/Kbuild.platforms:35: /usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/sgi-ip22/Platform: No such file or directory<br />/usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/Kbuild.platforms:35: /usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/sgi-ip27/Platform: No such file or directory<br />/usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/Kbuild.platforms:35: /usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/sgi-ip32/Platform: No such file or directory<br />/usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/Kbuild.platforms:35: /usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/sibyte/Platform: No such file or directory<br />/usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/Kbuild.platforms:35: /usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/sni/Platform: No such file or directory<br />/usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/Kbuild.platforms:35: /usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/txx9/Platform: No such file or directory<br />/usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/Kbuild.platforms:35: /usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/vr41xx/Platform: No such file or directory<br />/usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/Kbuild.platforms:35: /usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/wrppmc/Platform: No such file or directory<br />make[2]: *** No rule to make target `/usr/src/linux-headers-3.2.0-29-generic-pae/arch/mips/wrppmc/Platform&#039;.&nbsp; Stop.<br />make[2]: Leaving directory `/usr/src/linux-headers-3.2.0-29-generic-pae&#039;<br />make[1]: *** [default] Error 2<br />make[1]: Leaving directory `/home/Eddiie/media_build/v4l&#039;<br />make: *** [all] Error 2</p><p>Only file in wrppmc&nbsp; is Makefile.&nbsp; &nbsp; No Platform</p><p>What am I missing?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188653">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Eddiie</div>
					<div class="post-datetime">
						12 Jan 2013, 10:03					</div>
				</div>
				<div class="post-content content">
					<p>Following directions for Cross Compiling - <a href="http://wiki.openwrt.org/doc/devel/crosscompile">http://wiki.openwrt.org/doc/devel/crosscompile</a></p><p>I now get these results -</p><p>Eddiie@ubuntu2:~/media_build$ sudo make CC=/home/Eddiie/Downloads/openwrt/trunk/staging_dir/toolchain-mips_r2_gcc-4.6-linaro_uClibc-0.9.33.2/bin/mips-openwrt-linux-uclibc-gcc LD=/home/Eddiie/Downloads/openwrt/trunk/staging_dir/toolchain-mips_r2_gcc-4.6-linaro_uClibc-0.9.33.2/binmips-openwrt-linux-uclibc-ld CFLAGS=/home/Eddiie/Downloads/openwrt/trunk/staging_dir/toolchain-mips_r2_gcc-4.6-linaro_uClibc-0.9.33.2/usr/include/ LDFLAGS=/home/Eddiie/Downloads/openwrt/trunk/staging_dir/toolchain-mips_r2_gcc-4.6-linaro_uClibc-0.9.33.2/usr/lib/<br />make -C /home/Eddiie/media_build/v4l<br />make[1]: Entering directory `/home/Eddiie/media_build/v4l&#039;<br />creating symbolic links...<br />make -C firmware prep<br />make[2]: Entering directory `/home/Eddiie/media_build/v4l/firmware&#039;<br />make[2]: Leaving directory `/home/Eddiie/media_build/v4l/firmware&#039;<br />make -C firmware<br />make[2]: Entering directory `/home/Eddiie/media_build/v4l/firmware&#039;<br />make[2]: Nothing to be done for `default&#039;.<br />make[2]: Leaving directory `/home/Eddiie/media_build/v4l/firmware&#039;<br />Kernel build directory is /lib/modules/3.2.0-29-generic-pae/build<br />make -C ../linux apply_patches<br />make[2]: Entering directory `/home/Eddiie/media_build/linux&#039;<br />Patches for 3.2.0-29-generic-pae already applied.<br />make[2]: Leaving directory `/home/Eddiie/media_build/linux&#039;<br />make -C /lib/modules/3.2.0-29-generic-pae/build SUBDIRS=/home/Eddiie/media_build/v4l&nbsp; modules<br />make[2]: Entering directory `/usr/src/linux-headers-3.2.0-29-generic-pae&#039;<br />/usr/src/linux-headers-3.2.0-29-generic-pae/arch/x86/Makefile:81: stack protector enabled but no compiler support<br />&nbsp; CC [M]&nbsp; /home/Eddiie/media_build/v4l/altera-lpt.o<br />Assembler messages:<br />Error: Bad value (i686) for -march<br />cc1: error: unrecognized command line option &#039;-mregparm=3&#039;<br />cc1: error: unrecognized command line option &#039;-march=i686&#039;<br />make[3]: *** [/home/Eddiie/media_build/v4l/altera-lpt.o] Error 1<br />make[2]: *** [_module_/home/Eddiie/media_build/v4l] Error 2<br />make[2]: Leaving directory `/usr/src/linux-headers-3.2.0-29-generic-pae&#039;<br />make[1]: *** [default] Error 2<br />make[1]: Leaving directory `/home/Eddiie/media_build/v4l&#039;<br />make: *** [all] Error 2<br />Eddiie@ubuntu2:~/media_build$</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p240245">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">zloop</div>
					<div class="post-datetime">
						14 Jul 2014, 19:26					</div>
				</div>
				<div class="post-content content">
					<p>i played around with updating and it needs some fixing:<br />- delete all patches except the SHM one<br />- for autoreconf it&#039;s necessary to have 2 macros (AM_ICONV,gl_VISIBILITY); I just copied those from gnulib; a patchfile to copy to /patches dir is at: <a href="http://paste.debian.net/109696/">http://paste.debian.net/109696/</a></p><p>Makefile<br /></p><div class="codebox"><pre><code>#
# Copyright (C) 2009-2014 OpenWrt.org
# Copyright (C) 2009 David Cooper &lt;dave@kupesoft.com&gt;
#
# This is free software, licensed under the GNU General Public License v2.
# See /LICENSE for more information.
#

include $(TOPDIR)/rules.mk

PKG_NAME:=v4l-utils
PKG_VERSION:=1.2.1-git
PKG_RELEASE:=1

PKG_SOURCE:=$(PKG_NAME)-$(PKG_VERSION).tar.bz2
#PKG_SOURCE_URL:=http://www.linuxtv.org/downloads/v4l-utils
#PKG_MD5SUM:=4cc0fb4ded302ea9e89e5e1b56a7252b
PKG_SOURCE_PROTO:=git
PKG_SOURCE_URL:=git://linuxtv.org/v4l-utils.git
PKG_SOURCE_SUBDIR:=$(PKG_NAME)-$(PKG_VERSION)
PKG_SOURCE_VERSION:=d1a262e9e5dde4002dd1167d7eef3835dfd32f49

PKG_BUILD_DEPENDS:=argp-standalone
PKG_FIXUP:=autoreconf

include $(INCLUDE_DIR)/uclibc++.mk
include $(INCLUDE_DIR)/package.mk

define Package/libv4l/Default
  TITLE:=Video 4 Linux
  URL:=http://www.linuxtv.org/
endef

define Package/libv4l/Default/description
  libv4l is a collection of libraries which adds a thin abstraction layer on
  top of video4linux2 devices. The purpose of this (thin) layer is to make it
  easy for application writers to support a wide variety of devices without
  having to write separate code for different devices in the same class. libv4l
  consists of 3 different libraries: libv4lconvert, libv4l1 and libv4l2.

  libv4l1 offers the (deprecated) v4l1 API on top of v4l2 devices, independent
  of the drivers for those devices supporting v4l1 compatibility (which many
  v4l2 drivers do not).

  libv4l2 offers the v4l2 API on top of v4l2 devices, while adding for the
  application transparent libv4lconvert conversion where necessary.
endef

define Package/libv4l
  $(call Package/libv4l/Default)
  SECTION:=libs
  CATEGORY:=Libraries
  TITLE+= wrapper libraries
  DEPENDS := +libpthread +librt $(CXX_DEPENDS)
endef

define Package/libv4l/description
  $(call Package/libv4l/Default/description)
endef

define Package/v4l-utils
  $(call Package/libv4l/Default)
  SECTION:=utils
  CATEGORY:=Utilities
  TITLE+= utilities
  DEPENDS := +libv4l $(CXX_DEPENDS)
endef

define Package/v4l-utils/description
  $(call Package/libv4l/Default/description)
  This package contains the video4linux utilities.
endef

TARGET_CPPFLAGS+= -I$(TOOLCHAIN_DIR)/include

TARGET_CFLAGS += $(FPIC)

CONFIGURE_ARGS += \
    --without-jpeg \
    --disable-qv4l2


define Build/InstallDev
    $(INSTALL_DIR) $(1)/usr/include
    $(CP) $(PKG_INSTALL_DIR)/usr/include/*.h $(1)/usr/include/
    $(INSTALL_DIR) $(1)/usr/lib
    $(CP) $(PKG_INSTALL_DIR)/usr/lib/libv4l{1,2,convert}.{a,so*} $(1)/usr/lib/
    $(INSTALL_DIR) $(1)/usr/lib/pkgconfig
    $(CP) $(PKG_INSTALL_DIR)/usr/lib/pkgconfig/libv4l{1,2,convert}.pc $(1)/usr/lib/pkgconfig/
endef

define Package/libv4l/install
    $(INSTALL_DIR) $(1)/usr/lib
    $(CP) $(PKG_INSTALL_DIR)/usr/lib/libv4l{1,2,convert}.so.* $(1)/usr/lib/
    $(INSTALL_DIR) $(1)/usr/lib/libv4l
    $(CP) $(PKG_INSTALL_DIR)/usr/lib/libv4l/v4l{1compat,2convert}.so $(1)/usr/lib/libv4l/
endef

define Package/v4l-utils/install
    $(INSTALL_DIR) $(1)/etc
    $(CP) $(PKG_INSTALL_DIR)/etc/rc_maps.cfg $(1)/etc/
    $(CP) $(PKG_INSTALL_DIR)/etc/rc_keymaps $(1)/etc/
    $(INSTALL_DIR) $(1)/usr/bin
    $(CP) $(PKG_INSTALL_DIR)/usr/bin/{cx18,ivtv}-ctl $(1)/usr/bin/
    $(CP) $(PKG_INSTALL_DIR)/usr/bin/decode_tm6000 $(1)/usr/bin/
    $(CP) $(PKG_INSTALL_DIR)/usr/bin/ir-keytable $(1)/usr/bin/
    $(CP) $(PKG_INSTALL_DIR)/usr/bin/v4l2-{compliance,ctl,sysfs-path} $(1)/usr/bin/
endef

$(eval $(call BuildPackage,libv4l))
$(eval $(call BuildPackage,v4l-utils))</code></pre></div><p>atm make complains about:<br />- missing -std=gnu99 flags (the makefile has those set in &quot;CC&quot; variable but this is&nbsp; not getting invocated somehow in the makerule or libtool)<br />- missing iconv header</p><div class="codebox"><pre><code>TARGET_CPPFLAGS+= -I$(TOOLCHAIN_DIR)/include</code></pre></div><p>is needed for syscall.h that are not in default includepath; if missing SYS_ioctl is not replaced and throws undefined symbol</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p260365">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">badpitt</div>
					<div class="post-datetime">
						7 Jan 2015, 01:51					</div>
				</div>
				<div class="post-content content">
					<p>Could somebody help this guy please? I have the very same problem and no idea of cross-compiling. If he was successfull he could give me the resulting package...</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>