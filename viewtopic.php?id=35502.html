<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> I lost the IP address to my TP-Link MR3020 and don&#039;t have root acces</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 21 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p160903">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Smoopu</div>
					<div class="post-datetime">
						15 Mar 2012, 04:31					</div>
				</div>
				<div class="post-content content">
					<p>So, I decided to change the default IP address(192.168.1.1), stupid I know, on the device to something I now can&#039;t remember and now I can&#039;t SSH into the device without the new IP address that I can&#039;t remember. I have no idea what to do now... I have tried looking up the IP address using ARP -a, ifconfig, and netstat -n. It has been a huge headache and I just want to make it right now. Can anyone suggest what I do so that I can regain my access to the device. I know the password and everything I just cant SSH into it...</p>											<p class="post-edited">(Last edited by <strong>Smoopu</strong> on 15 Mar 2012, 04:32)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p160908">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">johnisaacson</div>
					<div class="post-datetime">
						15 Mar 2012, 06:05					</div>
				</div>
				<div class="post-content content">
					<p>Hi Smoopu<br />You have a few ways. From easy to hard.</p><p>As a general hint,&nbsp; click on the openwrt <a href="https://forum.openwrt.org/index.php">https://forum.openwrt.org/index.php</a> documentation and then enter in the wiki search a topic you want.<br />Most times this will get you quickly to some help. There is a lot more information in the forum search but takes more digging but has more gold.</p><p>1. Try the openwrt failsafe and check it that way. Search the forums and wiki&#039;s. <a href="http://wiki.openwrt.org/doc/howto/generic.failsafe">http://wiki.openwrt.org/doc/howto/generic.failsafe</a></p><p>2. Try a reset to defaults on the router (check the router information for loading new firmware) and reload firmware.</p><p>3. Install a serial cable and check it that way. There is lots of information on this forum on the subject.<br />For me this is the best way.</p><p>4. If you have a windows box then you can download something like this <a href="http://download.cnet.com/Advanced-IP-Scanner/3000-2085_4-10115592.html">http://download.cnet.com/Advanced-IP-Sc â€¦ 15592.html</a>.<br />Assuming your router is funtional.<br />Connect your router directly to your network port.<br />Set the ip range as a guess say 192.168.0.0 to 192.168.0.255 and run a scan. It will show up as a device.<br />Change the range say to 192.168.1.0 to 192.168.1.255 and run the scan again.</p><p>5. If you enabled the wifi perhaps you can sniff it out and gain access that way.</p><p>There may be easier ways I&#039;m sure, perhaps others will help.</p><p>Good luck.</p><p>~john</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p160914">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">johan666</div>
					<div class="post-datetime">
						15 Mar 2012, 10:19					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Smoopu wrote:</cite><blockquote><p>So, I decided to change the default IP address(192.168.1.1), stupid I know, on the device to something I now can&#039;t remember and now I can&#039;t SSH into the device without the new IP address that I can&#039;t remember. I have no idea what to do now... I have tried looking up the IP address using ARP -a, ifconfig, and netstat -n. It has been a huge headache and I just want to make it right now. Can anyone suggest what I do so that I can regain my access to the device. I know the password and everything I just cant SSH into it...</p></blockquote></div><p>It is not a big due.<br />If your mr3020 use squashfs,<br />- change your LAN IP to 192.168.1.x<br />- trigger your mr3020 to failsafe mode<br />- telnet to 192.168.1.1&nbsp; (not ssh)<br />- mount_root<br />- cat /etc/config/network&nbsp; &lt;---- your can see your mr3020 IP you previously set.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p161219">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Daygi</div>
					<div class="post-datetime">
						18 Mar 2012, 00:08					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I had a similare problem. I acceded to failsafe mode by telnet access.</p><p>But, I launched this command : rm -rf /overlay/* </p><p>I think that is a mistake... :-s</p><p>And now i can&#039;t acces to telnet. </p><p>I can ping 192.168.1.1 in failsafe mode, but i can&#039;t acces by telnet...</p><p>I try with serial port, but nothing...</p><p>Do you have an other solution to fix my error.?</p><p>Thank you for your help.<br />And sorry for my english ;-)</p><p>David</p>											<p class="post-edited">(Last edited by <strong>Daygi</strong> on 18 Mar 2012, 00:09)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p161256">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">johan666</div>
					<div class="post-datetime">
						18 Mar 2012, 12:46					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Daygi wrote:</cite><blockquote><p>Hi,</p><p>I had a similare problem. I acceded to failsafe mode by telnet access.</p><p>But, I launched this command : rm -rf /overlay/* </p><p>I think that is a mistake... :-s</p><p>And now i can&#039;t acces to telnet. </p><p>I can ping 192.168.1.1 in failsafe mode, but i can&#039;t acces by telnet...</p><p>I try with serial port, but nothing...</p><p>Do you have an other solution to fix my error.?</p></blockquote></div><p>If you use firmware with SquashFS, you will have failsafe mode.<br />In failsafe, it won&#039;t mount overlay, only the r/o rom,<br />so you should able to telnet into it.</p><p>delete overlay shouldn&#039;t be a problem too, it is just like factory reset.</p><p>Your info is insufficient, don&#039;t know why there is problem.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p161261">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Daygi</div>
					<div class="post-datetime">
						18 Mar 2012, 14:16					</div>
				</div>
				<div class="post-content content">
					<p>Yes i use the SquashFS</p><p>I read this page:<br /><a href="http://wiki.openwrt.org/doc/howto/generic.failsafe">http://wiki.openwrt.org/doc/howto/generic.failsafe</a></p><p>But I don&#039;t launch &quot;mount_root&quot; commande, I think.</p><p>I do a &quot;rm -f /overlay/*&quot;</p><p>Now, </p><p>I try to active the failsafe mode, I think that&#039;s good. I can ping 192.168.1.1.</p><p>In a same time, I try to acces in a telnet to 192.168.1.1, but the command return&nbsp; that:</p><div class="quotebox"><blockquote><p>david@lap01:~$ telnet 192.168.1.1<br />Trying 192.168.1.1...<br />telnet: Unable to connect to remote host: Connection refused<br />david@lap01:~$ <br />david@lap01:~$ telnet 192.168.1.1<br />Trying 192.168.1.1...<br />telnet: Unable to connect to remote host: Connection refused<br />david@lap01:~$ sudo nmap -sS 192.168.1.1</p><p>Starting Nmap 5.00 ( <a href="http://nmap.org">http://nmap.org</a> ) at 2012-03-18 13:37 CET<br />All 1000 scanned ports on 192.168.1.1 are closed<br />MAC Address: xx:xx:xx:xx:xx:xx (Unknown)</p><p>Nmap done: 1 IP address (1 host up) scanned in 13.35 seconds</p></blockquote></div><p>In a same time i scan port, but the telnet port is maybe closed...</p><br /><p>It possible to set a harware reset factory on MR3020?</p>											<p class="post-edited">(Last edited by <strong>Daygi</strong> on 18 Mar 2012, 14:23)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p161263">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">Daygi</div>
					<div class="post-datetime">
						18 Mar 2012, 14:52					</div>
				</div>
				<div class="post-content content">
					<p>Ok, that good, I recovery acces...</p><p>1. Plug power <br />2. Push de button &quot;WPS&quot;<br />3. When the WPS Led flash slowly, switch on AP mode to 3G mode. The LED flash quicky.<br />4. You can acces on telnet.</p><p>I hope to help anybody.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p161266">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						18 Mar 2012, 15:12					</div>
				</div>
				<div class="post-content content">
					<p>where did you find point 3????<br />thanks for sharing!</p>											<p class="post-edited">(Last edited by <strong>nebbia88</strong> on 18 Mar 2012, 15:13)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p161269">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">ttony</div>
					<div class="post-datetime">
						18 Mar 2012, 15:49					</div>
				</div>
				<div class="post-content content">
					<p>Resetting the router to factory default(hard reset) won&#039;t do it? Always wporked for me.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p161272">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">Daygi</div>
					<div class="post-datetime">
						18 Mar 2012, 16:34					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nebbia88 wrote:</cite><blockquote><p>where did you find point 3????<br />thanks for sharing!</p></blockquote></div><p>Nowhere... I&#039;m lucky... It is maybe a feature</p><p>I try that&#039;s all...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p161296">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						18 Mar 2012, 23:16					</div>
				</div>
				<div class="post-content content">
					<p>so are you sure that it&#039;s really needed?</p><p>@ttony if you lose access to router how would you reset it???</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p179592">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">flyy</div>
					<div class="post-datetime">
						28 Sep 2012, 05:26					</div>
				</div>
				<div class="post-content content">
					<p>hi,<br />I read <a href="http://wiki.openwrt.org/doc/howto/generic.failsafe">http://wiki.openwrt.org/doc/howto/generic.failsafe</a>, I can telnet 192.168.1.1</p><p>If I type &#039;passwd&#039; I get<br />&#039;passwd: /etc/passwd: Read-only file system<br />passwd: can&#039;t update password file /etc/passwd&#039;</p><div class="codebox"><pre><code>root@(none):/# uci get network.lan.ipaddr
uci: Entry not found</code></pre></div><div class="codebox"><pre><code>root@(none):/# firstboot
Unlocking rootfs_data ...
Erasing rootfs_data ...
mount: mounting /dev/mtdblock3 on /overlay failed: Invalid argument</code></pre></div><p>This works...<br /></p><div class="codebox"><pre><code>root@(none):/# mtd -r erase rootfs_data
Unlocking rootfs_data ...
Erasing rootfs_data ...
Rebooting ...</code></pre></div><p>But what have I to to do after that?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>