<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> [exroot] usb flash drive not detected MR3420 v2.2</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 30 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p200623">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">blinkxxx</div>
					<div class="post-datetime">
						4 May 2013, 10:44					</div>
				</div>
				<div class="post-content content">
					<p>Hi all, I have my <strong>MR3420 v2.2</strong> here.. flash with : <br />* <a href="http://downloads.openwrt.org/snapshots/trunk/ar71xx/openwrt-ar71xx-generic-tl-mr3420-v2-squashfs-factory.bin">http://downloads.openwrt.org/snapshots/ â€¦ actory.bin</a><br />*http://downloads.openwrt.org/snapshots/trunk/ar71xx/openwrt-ar71xx-generic-tl-mr3420-v2-squashfs-sysupgrade.bin</p><p>want to exroot my device, but seems my flashdrive not detected.<br />First I wanna describe my steps to do it all, perhaps there&#039;s wrong or what..<br /><strong>Please notice, this is a fresh install, after I flashed my device I didn&#039;t install anything except the USB package.</strong><br /></p><ul><li><p>Flash with f/w and sysupgrade.</p></li><li><p>Install usb package needed : block-mount, kmod-usb-storage, kmod-fs-ext4</p></li><li><p>Reboot device</p></li><li><p>Prepare an USB Flash Drive mine is Transcend JF-300-16GB w/Led indicator (already make partition inside, 100mb linux swap and rest for space)</p></li><li><p>Make sure usb script already started with command : &quot;/etc/init.d/usb enable&quot; and &quot;/etc/init.d/usb start&quot;</p></li><li><p>Plug in my flash drive</p></li></ul><p>result is : <br /></p><ul><li><p>My flash drive&#039;s led didn&#039;t on or blink</p></li><li><p>There&#039;s no new mount under my /dev</p></li></ul><p>my /dev : <br /></p><div class="codebox"><pre><code>root@OpenWrt:~# ls /dev
bus                 mtd3ro              port                ttyS15
console             mtd4                ppp                 ttyS2
cpu_dma_latency     mtd4ro              ptmx                ttyS3
full                mtd5                pts                 ttyS4
kmsg                mtd5ro              random              ttyS5
log                 mtdblock0           shm                 ttyS6
mem                 mtdblock1           tty                 ttyS7
mtd0                mtdblock2           ttyS0               ttyS8
mtd0ro              mtdblock3           ttyS1               ttyS9
mtd1                mtdblock4           ttyS10              urandom
mtd1ro              mtdblock5           ttyS11              watchdog
mtd2                network_latency     ttyS12              zero
mtd2ro              network_throughput  ttyS13
mtd3                null                ttyS14</code></pre></div><p>my FULL dmseg : <br /></p><div class="codebox"><pre><code>[    0.000000] Linux version 3.8.11 (openwrt@callisto.lab.bufferbloat.net) (gcc version 4.6.4 (OpenWrt/Linaro GCC 4.6-2012.12 r36507) ) #1 Fri May 3 05:53:53 EDT 2013
[    0.000000] MyLoader: sysp=8b8b81ac, boardp=96e34c72, parts=b298aa77
[    0.000000] bootconsole [early0] enabled
[    0.000000] CPU revision is: 0001974c (MIPS 74Kc)
[    0.000000] SoC: Atheros AR9341 rev 1
[    0.000000] Clocks: CPU:535.000MHz, DDR:400.000MHz, AHB:200.000MHz, Ref:25.000MHz
[    0.000000] Determined physical RAM map:
[    0.000000]  memory: 02000000 @ 00000000 (usable)
[    0.000000] Initrd not found or empty - disabling initrd
[    0.000000] Zone ranges:
[    0.000000]   Normal   [mem 0x00000000-0x01ffffff]
[    0.000000] Movable zone start for each node
[    0.000000] Early memory node ranges
[    0.000000]   node   0: [mem 0x00000000-0x01ffffff]
[    0.000000] On node 0 totalpages: 8192
[    0.000000] free_area_init_node: node 0, pgdat 80318a40, node_mem_map 81000000
[    0.000000]   Normal zone: 64 pages used for memmap
[    0.000000]   Normal zone: 0 pages reserved
[    0.000000]   Normal zone: 8128 pages, LIFO batch:0
[    0.000000] Primary instruction cache 64kB, VIPT, 4-way, linesize 32 bytes.
[    0.000000] Primary data cache 32kB, 4-way, VIPT, cache aliases, linesize 32 bytes
[    0.000000] pcpu-alloc: s0 r0 d32768 u32768 alloc=1*32768
[    0.000000] pcpu-alloc: [0] 0
[    0.000000] Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 8128
[    0.000000] Kernel command line:  board=TL-MR3420-v2 console=ttyS0,115200 rootfstype=squashfs,jffs2 noinitrd
[    0.000000] PID hash table entries: 128 (order: -3, 512 bytes)
[    0.000000] Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
[    0.000000] Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
[    0.000000] __ex_table already sorted, skipping sort
[    0.000000] Writing ErrCtl register=00000000
[    0.000000] Readback ErrCtl register=00000000
[    0.000000] Memory: 28724k/32768k available (2281k kernel code, 4044k reserved, 599k data, 252k init, 0k highmem)
[    0.000000] SLUB: Genslabs=9, HWalign=32, Order=0-3, MinObjects=0, CPUs=1, Nodes=1
[    0.000000] NR_IRQS:51
[    0.070000] Calibrating delay loop... 266.64 BogoMIPS (lpj=1333248)
[    0.080000] pid_max: default: 32768 minimum: 301
[    0.080000] Mount-cache hash table entries: 512
[    0.090000] NET: Registered protocol family 16
[    0.090000] MIPS: machine is TP-LINK TL-MR3420 v2
[    0.510000] bio: create slab &lt;bio-0&gt; at 0
[    0.520000] Switching to clocksource MIPS
[    0.530000] NET: Registered protocol family 2
[    0.530000] TCP established hash table entries: 512 (order: 0, 4096 bytes)
[    0.530000] TCP bind hash table entries: 512 (order: -1, 2048 bytes)
[    0.540000] TCP: Hash tables configured (established 512 bind 512)
[    0.540000] TCP: reno registered
[    0.540000] UDP hash table entries: 256 (order: 0, 4096 bytes)
[    0.550000] UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
[    0.560000] NET: Registered protocol family 1
[    0.560000] PCI: CLS 0 bytes, default 32
[    0.580000] squashfs: version 4.0 (2009/01/31) Phillip Lougher
[    0.580000] jffs2: version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006 Red Hat, Inc.
[    0.590000] msgmni has been set to 56
[    0.600000] Block layer SCSI generic (bsg) driver version 0.4 loaded (major 253)
[    0.600000] io scheduler noop registered
[    0.610000] io scheduler deadline registered (default)
[    0.610000] Serial: 8250/16550 driver, 16 ports, IRQ sharing enabled
[    0.650000] serial8250.0: ttyS0 at MMIO 0x18020000 (irq = 11) is a 16550A
[    0.650000] console [ttyS0] enabled, bootconsole disabled
[    0.670000] ath79-spi ath79-spi: master is unqueued, this is deprecated
[    0.670000] m25p80 spi0.0: found en25q32b, expected m25p80
[    0.680000] m25p80 spi0.0: en25q32b (4096 Kbytes)
[    0.690000] 5 tp-link partitions found on MTD device spi0.0
[    0.690000] Creating 5 MTD partitions on &quot;spi0.0&quot;:
[    0.700000] 0x000000000000-0x000000020000 : &quot;u-boot&quot;
[    0.700000] 0x000000020000-0x000000120070 : &quot;kernel&quot;
[    0.710000] mtd: partition &quot;kernel&quot; must either start or end on erase block boundary or be smaller than an erase block -- forcing read-only
[    0.720000] 0x000000120070-0x0000003f0000 : &quot;rootfs&quot;
[    0.730000] mtd: partition &quot;rootfs&quot; must either start or end on erase block boundary or be smaller than an erase block -- forcing read-only
[    0.740000] mtd: partition &quot;rootfs&quot; set to be root filesystem
[    0.750000] mtd: partition &quot;rootfs_data&quot; created automatically, ofs=2D0000, len=120000
[    0.760000] 0x0000002d0000-0x0000003f0000 : &quot;rootfs_data&quot;
[    0.760000] 0x0000003f0000-0x000000400000 : &quot;art&quot;
[    0.770000] 0x000000020000-0x0000003f0000 : &quot;firmware&quot;
[    0.790000] libphy: ag71xx_mdio: probed
[    0.800000] eth0: Atheros AG71xx at 0xb9000000, irq 4, mode:MII
[    1.360000] ag71xx ag71xx.0 eth0: connected to PHY at ag71xx-mdio.1:00 [uid=004dd042, driver=Generic PHY]
[    1.370000] eth1: Atheros AG71xx at 0xba000000, irq 5, mode:GMII
[    1.920000] eth1: Found an AR934X built-in switch
[    2.960000] TCP: cubic registered
[    2.960000] NET: Registered protocol family 17
[    2.960000] Bridge firewalling registered
[    2.970000] 8021q: 802.1Q VLAN Support v1.8
[    2.980000] VFS: Mounted root (squashfs filesystem) readonly on device 31:2.
[    2.990000] Freeing unused kernel memory: 252k freed
[    7.390000] eth0: link up (100Mbps/Half duplex)
[    8.210000] jffs2: notice: (466) jffs2_build_xattr_subsystem: complete building xattr subsystem, 17 of xdatum (1 unchecked, 16 orphan) and 27 of xref (0 dead, 17 orphan) found.
[    8.920000] SCSI subsystem initialized
[    9.030000] usbcore: registered new interface driver usbfs
[    9.040000] usbcore: registered new interface driver hub
[    9.050000] usbcore: registered new device driver usb
[    9.580000] ehci_hcd: USB 2.0 &#039;Enhanced&#039; Host Controller (EHCI) Driver
[    9.590000] ehci-platform: EHCI generic platform driver
[    9.600000] ehci-platform ehci-platform: EHCI Host Controller
[    9.600000] ehci-platform ehci-platform: new USB bus registered, assigned bus number 1
[    9.610000] ehci-platform ehci-platform: irq 3, io mem 0x1b000000
[    9.640000] ehci-platform ehci-platform: USB 2.0 started, EHCI 1.00
[    9.640000] hub 1-0:1.0: USB hub found
[    9.650000] hub 1-0:1.0: 1 port detected
[    9.660000] ohci_hcd: USB 1.1 &#039;Open&#039; Host Controller (OHCI) Driver
[    9.720000] Initializing USB Mass Storage driver...
[    9.720000] usbcore: registered new interface driver usb-storage
[    9.730000] USB Mass Storage support registered.
[   30.070000] eth0: link down
[   30.510000] compat-drivers backport release: compat-drivers-2013-03-28-5
[   30.520000] Backport based on wireless-testing.git master-2013-04-16
[   30.530000] compat.git: wireless-testing.git
[   30.570000] cfg80211: Calling CRDA to update world regulatory domain
[   30.570000] cfg80211: World regulatory domain updated:
[   30.580000] cfg80211:   (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp)
[   30.590000] cfg80211:   (2402000 KHz - 2472000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
[   30.590000] cfg80211:   (2457000 KHz - 2482000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
[   30.600000] cfg80211:   (2474000 KHz - 2494000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
[   30.610000] cfg80211:   (5170000 KHz - 5250000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
[   30.620000] cfg80211:   (5735000 KHz - 5835000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
[   30.860000] NET: Registered protocol family 10
[   31.380000] ath: EEPROM regdomain: 0x0
[   31.380000] ath: EEPROM indicates default country code should be used
[   31.380000] ath: doing EEPROM country-&gt;regdmn map search
[   31.380000] ath: country maps to regdmn code: 0x3a
[   31.380000] ath: Country alpha2 being used: US
[   31.380000] ath: Regpair used: 0x3a
[   31.390000] ieee80211 phy0: Selected rate control algorithm &#039;minstrel_ht&#039;
[   31.390000] ieee80211 phy0: Atheros AR9340 Rev:0 mem=0xb8100000, irq=47
[   31.400000] cfg80211: Calling CRDA for country: US
[   31.410000] cfg80211: Regulatory domain changed to country: US
[   31.410000] cfg80211:   (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp)
[   31.420000] cfg80211:   (2402000 KHz - 2472000 KHz @ 40000 KHz), (300 mBi, 2700 mBm)
[   31.430000] cfg80211:   (5170000 KHz - 5250000 KHz @ 40000 KHz), (300 mBi, 1700 mBm)
[   31.440000] cfg80211:   (5250000 KHz - 5330000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
[   31.440000] cfg80211:   (5490000 KHz - 5600000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
[   31.450000] cfg80211:   (5650000 KHz - 5710000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
[   31.460000] cfg80211:   (5735000 KHz - 5835000 KHz @ 40000 KHz), (300 mBi, 3000 mBm)
[   31.620000] PPP generic driver version 2.4.2
[   31.820000] ip_tables: (C) 2000-2006 Netfilter Core Team
[   31.930000] NET: Registered protocol family 24
[   31.980000] nf_conntrack version 0.5.0 (452 buckets, 1808 max)
[   32.200000] ip6_tables: (C) 2000-2006 Netfilter Core Team
[   36.900000] IPv6: ADDRCONF(NETDEV_UP): eth1: link is not ready
[   36.900000] device eth1 entered promiscuous mode
[   36.920000] IPv6: ADDRCONF(NETDEV_UP): br-lan: link is not ready
[   36.950000] IPv6: ADDRCONF(NETDEV_UP): eth0: link is not ready
[   37.570000] eth1: link up (1000Mbps/Full duplex)
[   37.580000] br-lan: port 1(eth1) entered forwarding state
[   37.590000] br-lan: port 1(eth1) entered forwarding state
[   37.590000] IPv6: ADDRCONF(NETDEV_CHANGE): eth1: link becomes ready
[   37.600000] IPv6: ADDRCONF(NETDEV_CHANGE): br-lan: link becomes ready
[   38.570000] eth0: link up (100Mbps/Half duplex)
[   38.580000] IPv6: ADDRCONF(NETDEV_CHANGE): eth0: link becomes ready
[   39.590000] br-lan: port 1(eth1) entered forwarding state
[   43.820000] IPv6: ADDRCONF(NETDEV_UP): wlan0: link is not ready
[   43.840000] device wlan0 entered promiscuous mode
[   43.870000] IPv6: ADDRCONF(NETDEV_UP): wlan0: link is not ready
[   44.080000] br-lan: port 2(wlan0) entered forwarding state
[   44.080000] br-lan: port 2(wlan0) entered forwarding state
[   44.090000] IPv6: ADDRCONF(NETDEV_CHANGE): wlan0: link becomes ready
[   46.080000] br-lan: port 2(wlan0) entered forwarding state</code></pre></div><p>already check with <strong>usbutils</strong>, seems my slot fine, result :<br /></p><div class="codebox"><pre><code>Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub</code></pre></div><p>even, I can found that my slot goes fine through dmesg<br /></p><div class="codebox"><pre><code>[    8.920000] SCSI subsystem initialized
[    9.030000] usbcore: registered new interface driver usbfs
[    9.040000] usbcore: registered new interface driver hub
[    9.050000] usbcore: registered new device driver usb
[    9.580000] ehci_hcd: USB 2.0 &#039;Enhanced&#039; Host Controller (EHCI) Driver
[    9.590000] ehci-platform: EHCI generic platform driver
[    9.600000] ehci-platform ehci-platform: EHCI Host Controller
[    9.600000] ehci-platform ehci-platform: new USB bus registered, assigned bus number 1
[    9.610000] ehci-platform ehci-platform: irq 3, io mem 0x1b000000
[    9.640000] ehci-platform ehci-platform: USB 2.0 started, EHCI 1.00
[    9.640000] hub 1-0:1.0: USB hub found
[    9.650000] hub 1-0:1.0: 1 port detected
[    9.660000] ohci_hcd: USB 1.1 &#039;Open&#039; Host Controller (OHCI) Driver
[    9.720000] Initializing USB Mass Storage driver...
[    9.720000] usbcore: registered new interface driver usb-storage
[    9.730000] USB Mass Storage support registered.</code></pre></div><p>Please kindly assist me, I don&#039;t know what I missed here.</p><p>= = = = = = UPDATE = = = = = = = =<br />I have my device reverted to original firmware, and usb status Led goes ON and then my Flashdrive&#039;s LED goes ON.<br />so, USB Slot work functionally.</p>											<p class="post-edited">(Last edited by <strong>blinkxxx</strong> on 6 May 2013, 11:06)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p205964">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">manoranjan2050</div>
					<div class="post-datetime">
						28 Jun 2013, 20:07					</div>
				</div>
				<div class="post-content content">
					<p>can u provide info and provide firmware how u reverted to original firmware ....... please help me ..... many thanks adv.......</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p205968">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Dioptimizer</div>
					<div class="post-datetime">
						28 Jun 2013, 21:27					</div>
				</div>
				<div class="post-content content">
					<p>I would say even more, in Trunk (for mr3420v2) does not work USB power.<br />Problem is lack of testers.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p206799">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Dioptimizer</div>
					<div class="post-datetime">
						9 Jul 2013, 21:34					</div>
				</div>
				<div class="post-content content">
					<p>Please check USB port on Trunk or yourself build after <a href="https://dev.openwrt.org/changeset/37194">r37194</a> changes.<br />If also does not work full control gpio4 (in/out &gt; hi/low) let me know.<br />Thank you.</p><p><a href="https://dev.openwrt.org/ticket/13201">https://dev.openwrt.org/ticket/13201</a></p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>