<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> ifup wan fails with dsl</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 20 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p9210">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">cornelinux</div>
					<div class="post-datetime">
						7 Jul 2005, 00:53					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>I installed openwrt-brcm-2.4-squashfs.trx on a asus wl 500g.</p><p>I configured:<br />ppp_passwd=xxx<br />ppp_idletime=5<br />ppp_username=xxx<br />ppp_redialperiod=30<br />pppoe_ifname=eth0<br />pppoe_passwd=xxx<br />pppoe_idletime=5<br />pppoe_username=xxx<br />ppp_mtu=1492</p><p>root@OpenWrt:~# nvram get wan_proto<br />pppoe<br />root@OpenWrt:~# nvram get wan_ifname<br />ppp0</p><p>As described in <a href="http://openwrt.org/cgi-bin/viewcvs.cgi/*checkout*/buildroot/README.pppoe">http://openwrt.org/cgi-bin/viewcvs.cgi/ … ADME.pppoe</a></p><p>But now, when I restart the networt or do a ifup wan:<br />root@OpenWrt:~# ifup wan<br />### ifup wan: ignored wan_proto=&quot;pppoe&quot; (not supported)</p><p>What is missing?<br />root@OpenWrt:~# ipkg list<br />bridge - 1.0.6-1 -<br />busybox - 1.00-2 -<br />dnsmasq - 2.22-1 -<br />dropbear - 0.45-3 -<br />ipkg - 0.99.149-1 -<br />iptables - 1.3.1-1 -<br />kernel - 2.4.30-brcm-1 -<br />kmod-brcm-et - 2.4.30-brcm-1 -<br />kmod-brcm-wl - 2.4.30-brcm-1 -<br />kmod-diag - 2.4.30-brcm-1 -<br />kmod-ppp - 2.4.30-brcm-1 -<br />kmod-pppoe - 2.4.30-brcm-1 -<br />kmod-wlcompat - 2.4.30-brcm-1 -<br />openwrt-utils - 1 -<br />ppp - 2.4.3-4 -<br />ppp-mod-pppoe - 2.4.3-4 -<br />wificonf - 1 -<br />wireless-tools - 28.pre7-1 -<br />zlib - 1.2.2-1 -<br />Successfully terminated.</p><br /><p>Kind regards<br />Cornelius</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p9291">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">brian</div>
					<div class="post-datetime">
						10 Jul 2005, 20:26					</div>
				</div>
				<div class="post-content content">
					<p>You used the instructions for the stable&nbsp; version of openwrt. I think that you&#039;re using the experimental version, because you have installed ppp-mod-pppoe package, that is the pppoe plugin for pppd, used in the experimental version of openwrt to connect via pppoe.<br />So read this:<br /><a href="http://wiki.openwrt.org/OpenWrtFaq?highlight=%28Howto%29#head-76cd4bb437ec1f574e60ad97f8bff10b43ed3064">http://wiki.openwrt.org/OpenWrtFaq?high … 0b43ed3064</a></p><p>If you have the stable version, then you have to install pppoecd package.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p9292">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">cornelinux</div>
					<div class="post-datetime">
						10 Jul 2005, 20:50					</div>
				</div>
				<div class="post-content content">
					<p>HEllo,</p><p>that&#039;s exactly what I did in a second attemp.</p><p>I used <br />pppoe_ifname=eth0<br />for my asus.</p><p>Nothing happend. Can not connect via DSL.</p><p>Regards<br />Cornelius</p>											<p class="post-edited">(Last edited by <strong>cornelinux</strong> on 10 Jul 2005, 20:51)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p9654">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">hitek146</div>
					<div class="post-datetime">
						18 Jul 2005, 09:09					</div>
				</div>
				<div class="post-content content">
					<p>I am having exactly the same problem, although I am using the wireless interface:</p><p>pppoe_ifname=eth1</p><p>and receive the error: &#039;ignored wan_proto=&quot;pppoe&quot;&nbsp; (not supported)&#039;, even though the S50pppoe script appears to be looking for that value....</p><p>I am using White Russian, and have tried every configuration that I can find or think of.&nbsp; I actually require the use of MPPE encryption over the PPPoE connection(after I get it working without MPPE, I&#039;m just trying a simple non-encrypted connect, for now), so maybe I am using the wrong client in the first place......</p><p>Does anyone know how to get PPPoE working in White Russian????</p><p>Hitek</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p9655">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">hitek146</div>
					<div class="post-datetime">
						18 Jul 2005, 11:30					</div>
				</div>
				<div class="post-content content">
					<p>I have gotten it partially working. The error seemed to be related to a parent interface misconfiguration.&nbsp; Still working on the encryption.....</p><p>Hitek</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p9681">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">cornelinux</div>
					<div class="post-datetime">
						18 Jul 2005, 22:04					</div>
				</div>
				<div class="post-content content">
					<p>Hi hitek,</p><p>what was this &quot;a parent interface misconfig&quot;?<br />Could you please be a bit more precise. It might help me, using my problem...</p><p>Kind regards<br />Cornelius</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p9685">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">hitek146</div>
					<div class="post-datetime">
						18 Jul 2005, 23:35					</div>
				</div>
				<div class="post-content content">
					<p>Edit:&nbsp; after rereading this, I thought I might add that:&nbsp; &quot;AC&quot; = Access Concentrator, or &quot;PPPoE server&quot;....<br />------------------------------------------</p><p>I don&#039;t know how much help I can be, since I never used Linux until about 3 days ago... <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" />&nbsp; &nbsp;What I discovered is this:</p><p>I cannot get the wireless interface to connect unless I use &quot;wl ap 0&quot; and &quot;wl join xxxxx&quot;....&nbsp; Putting the SSID and mode into the &quot;wl0&quot; nvram variables does nothing for me at all.&nbsp; I suppose there may be a script somewhere that uses those variables to initiate a connection, but since the documentation says almost nothing about scripts or startup procedure, I cannot find out how most of the system&#039;s configuration is being set.&nbsp; It seems there are many things happening at startup that I do not see reflected in any of the scripts that I can find under the /etc directory.&nbsp; This being the case, I have been forced to connect by placing the &quot;wl&quot; commands into a script in the init.d directory, along with the other settings that I needed made, but could not be done by setting NVRAM variables alone.&nbsp; After the scripts have executed at startup, my VLAN 2 interface has been created for the wireless interface, leaving VLAN1 for the WAN(int. ports 0 and 5) and VLAN0 for the other four ports.&nbsp; My wireless interface connecting to the AP is then the last thing scripted in the init.d directory.&nbsp; This leaves me after startup with 3 VLANs and a wireless connection to the AP, at which point the PPPoE client does start to connect.&nbsp; I should note that I used the &quot;wifi_xxxx&quot; NVRAM variables for the wireless, leaving the &quot;wan_xxxx&quot; variables to their original use.&nbsp; I changed the &quot;S50pppoe&quot; script to look at the &quot;wifi_proto&quot; variable instead of the &quot;wan_proto&quot; variable so the PPPoE client tries to connect on the correct interface.</p><p>Now that I have partially explained my configuration, you may see that by &quot;parent interface misconfiguration&quot;, I meant that the wifi interface was not working properly, and this was causing my error.&nbsp; I am still getting the error, but not all of the time.&nbsp; When the unit boots up, the wireless connects to the AP as it is supposed to, and then the PPPoE starts to connect over the wifi interface, as it should.&nbsp; The error appears when I try to connect with PPPoE when there is no connection to the AC.&nbsp; This happened to me because of a problem with the wifi interface that I have not identified yet.&nbsp; My original problem was that the ifup wifi command was being issued in a script after the wireless had already connected to the AP.&nbsp; This, apparently, is a big issue for my installation, as executing a &quot;ifup wifi&quot; command after the interface is already connected literally kills the wireless connection, and this is where I was getting the PPPoE errors.</p><p>Here is what would happen:<br />The unit would boot up, and the wireless would automatically connect.&nbsp; This placed an entry in the access concentrator&#039;s (AP&#039;s) log that told me the client was connected.&nbsp; Somehow, immediately after the successful connection, the &quot;ifup wifi&quot; command was being executed again, essentially killing the wifi session.&nbsp; It is still a problem for me that once my initial wireless connection has been established, I cannot reconnect again without rebooting the router, and this is a huge issue.....&nbsp; When the second instance of the &quot;ifup wifi&quot; was executed, the wireless connection was killed, and this then caused the &quot;ignored wan_proto=pppoe&quot; error.&nbsp; As soon as I removed the second &quot;ifup wifi&quot; statement, the wireless would stay connected after startup, and then the PPPoE client would dial and connect(without encryption) properly.&nbsp; Unfortunately, as soon as the wireless link is gone, I am unable to re-establish it, and the PPPoE error appears again.&nbsp; Basically, the &quot;ifup wifi&quot; command is useless to me once it has already been executed at startup.&nbsp; I don&#039;t know if any of this will help you, or not, but in my case the problem is because the link I am trying to PPPoE over is invalid at the immediate time that it is attempting to connect.</p><p>I was also getting &quot;eth1&quot; invalid errors along with the &quot;ignored wan_proto=pppoe&quot; errors....</p><p>Does anyone reading this know any of the answers to any of the questions I asked above?&nbsp; Anyone know what scripts I am not seeing?&nbsp; At what point is this OS creating the VLAN0 and VLAN1 interfaces?&nbsp; I cannot find alot of things being done at startup....&nbsp; I also see alot of packages installed that seem to be different versions of the same thing...&nbsp; How many PPP packages are there, and which one(s) is/are being used???&nbsp; How can I tell this?&nbsp; What do I need to do to use the &quot;kmod&quot; packages?&nbsp; Is simply installing them all I have to do?&nbsp; All of the Linux documentation I have seen seems to be fairly consistant between between different distributions, but OpenWRT seems to be different from all of the others, with the differences not clearly stated anywhere....&nbsp; For example, why is there no networking.sh file?&nbsp; Is a user just supposed to &quot;know&quot; what to do if things are not in the standard places?&nbsp; My installation has no S50pptp script, but I see others have it...&nbsp; How and where would that file be generated, and why do others have it when i don&#039;t(not that I need it)?&nbsp; MPPE....&nbsp; Anyone...&nbsp; Anyone....</p><p>Sorry to have asked so many of my own questions... <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" />&nbsp; If there are anymore questions you have for me, cornelinux, feel free to ask....</p><p>Hitek</p>											<p class="post-edited">(Last edited by <strong>hitek146</strong> on 18 Jul 2005, 23:40)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p9699">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">hitek146</div>
					<div class="post-datetime">
						19 Jul 2005, 05:26					</div>
				</div>
				<div class="post-content content">
					<p>I have gotten it to work.&nbsp; Apparently, installing the packages is not enough, they need to be registered(yes, I can hear the collective &quot;duh!&quot;.... <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> ), but I still do not understand how you know which packages are needed or used....&nbsp; Finding the one, single reference to the &quot;logread&quot; command helped greatly.....</p><p>Hitek</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>