<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> [SOLVED] How to replace kernel .config with mine?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 21 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p216767">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">ndarkness</div>
					<div class="post-datetime">
						5 Nov 2013, 10:27					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>I was wondering whether it is possible to load a preconfigured version of the kernel in openWRT or not. I mean, I have enabled some features on the openWRT kernel and I would like to import them ( through its .config) so that if I wanted to recompile my kernel on a different machine I only had to copy and paste the kernel .config.&nbsp; However, I have seen that the folder where to place the file <em>build_dir</em> is just created after compilation, so, do I have to compile at least once before being able to copy my kernel .config to the proper folder?</p><p>Thanks in advance!</p><p>regards</p>											<p class="post-edited">(Last edited by <strong>ndarkness</strong> on 8 Nov 2013, 11:36)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p216780">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						5 Nov 2013, 12:41					</div>
				</div>
				<div class="post-content content">
					<p>Why not patch the kernel config source directly?<br />Generic: <a href="https://dev.openwrt.org/browser/trunk/target/linux/generic/config-3.10">https://dev.openwrt.org/browser/trunk/t … onfig-3.10</a><br />then platform: <a href="https://dev.openwrt.org/browser/trunk/target/linux/ar71xx/config-3.10">https://dev.openwrt.org/browser/trunk/t … onfig-3.10</a></p><p>Do a patch for needed changes there.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p216808">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">ndarkness</div>
					<div class="post-datetime">
						5 Nov 2013, 19:59					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>hnyman wrote:</cite><blockquote><p>Why not patch the kernel config source directly?<br />Generic: <a href="https://dev.openwrt.org/browser/trunk/target/linux/generic/config-3.10">https://dev.openwrt.org/browser/trunk/t … onfig-3.10</a><br />then platform: <a href="https://dev.openwrt.org/browser/trunk/target/linux/ar71xx/config-3.10">https://dev.openwrt.org/browser/trunk/t … onfig-3.10</a></p><p>Do a patch for needed changes there.</p></blockquote></div><p>Wowo! I didn´t know that I could patch the kernel config directly. But, how do I do it? I mean, I do know how to patch packages files or kernel files, but not the config source. Is in the same way? I mean, firstly I have to issue some command akin to <br /></p><div class="codebox"><pre><code>~$make /target/linux/{clean,prepare} V=s QUILT=1</code></pre></div><p>and then how I patch the source? And what is even more important, where should I place the patch, once I get it, on the new machine?</p><p>Thanks in advance!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p216813">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Zajec</div>
					<div class="post-datetime">
						5 Nov 2013, 20:31					</div>
				</div>
				<div class="post-content content">
					<p>You may also want to check &quot;make kernel_menuconfig&quot;</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p216856">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">ndarkness</div>
					<div class="post-datetime">
						6 Nov 2013, 10:45					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Zajec wrote:</cite><blockquote><p>You may also want to check &quot;make kernel_menuconfig&quot;</p></blockquote></div><p>that&#039;s the point, I want to avoid making the kernel selection each time, since I have already the .conf of the kernel.</p><p>Thanks in advance!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p216859">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">FriedZombie</div>
					<div class="post-datetime">
						6 Nov 2013, 12:00					</div>
				</div>
				<div class="post-content content">
					<p>quilt is used to create patched, if you read on it explains how to do that.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p216860">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">FriedZombie</div>
					<div class="post-datetime">
						6 Nov 2013, 12:00					</div>
				</div>
				<div class="post-content content">
					<p>quilt is used to create patched, if you read on it explains how to do that<br /><a href="http://wiki.openwrt.org/doc/devel/patches#adding.a.new.patch">http://wiki.openwrt.org/doc/devel/patch … .new.patch</a></p>											<p class="post-edited">(Last edited by <strong>FriedZombie</strong> on 6 Nov 2013, 12:01)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p216948">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">ndarkness</div>
					<div class="post-datetime">
						7 Nov 2013, 10:05					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>FriedZombie wrote:</cite><blockquote><p>quilt is used to create patched, if you read on it explains how to do that<br /><a href="http://wiki.openwrt.org/doc/devel/patches#adding.a.new.patch">http://wiki.openwrt.org/doc/devel/patch … .new.patch</a></p></blockquote></div><p>Thanks for replying,</p><p>I do know how to create patches, but I do not know how I should modify the .conf of the kernel with the patch. For instance, If I want to enable the following option</p><div class="codebox"><pre><code># CONFIG_USB_NET_CDCETHER is not set</code></pre></div><p>in the generic configuration given by hnyman <a href="https://dev.openwrt.org/browser/trunk/target/linux/generic/config-3.10">geberic kernel config </a></p><p>What should I do with QUILT, modify that line in order to resemble something like this</p><div class="codebox"><pre><code># CONFIG_USB_NET_CDCETHER=y</code></pre></div><p>Thanks in advance!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p216952">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						7 Nov 2013, 10:43					</div>
				</div>
				<div class="post-content content">
					<p>You could just first &quot;make clean&quot; to clear built files, and edit that file with a text editor. Uncomment the line (remove # ) and change the end to &quot;=y&quot;<br /># CONFIG_USB_NET_CDCETHER is not set <br />--&gt;<br />CONFIG_USB_NET_CDCETHER=y</p><p>If I understand right, the generic config is evaluated first, then then platform-specific config is added to that. So, you could just add that line to your platform confic defaults file.</p><p>It might also work if you just include that line in your .config. (I don&#039;t currently have any kernel modifications, so I am not quite sure how the kernel options behave there.)</p><p>Ps.<br />After you have configured the system as you like, look at the output of &quot;./scripts/diffconfig.sh&quot;. It should list all your deviations from the defaults. You can use that file as the .config template. E.g. I use the following file that I expand to full .config with &quot;make defconfig&quot;.&nbsp; <a href="http://koti.welho.com/hnyman1/Openwrt/trunk-r38641-2013-11-04/WNDR3700-trunk-r38641-2013-11-04-1919.diffconfig">http://koti.welho.com/hnyman1/Openwrt/t … diffconfig</a></p>											<p class="post-edited">(Last edited by <strong>hnyman</strong> on 7 Nov 2013, 10:45)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p217036">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">ndarkness</div>
					<div class="post-datetime">
						8 Nov 2013, 11:35					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>hnyman wrote:</cite><blockquote><p>You could just first &quot;make clean&quot; to clear built files, and edit that file with a text editor. Uncomment the line (remove # ) and change the end to &quot;=y&quot;<br /># CONFIG_USB_NET_CDCETHER is not set <br />--&gt;<br />CONFIG_USB_NET_CDCETHER=y</p><p>If I understand right, the generic config is evaluated first, then then platform-specific config is added to that. So, you could just add that line to your platform confic defaults file.</p><p>It might also work if you just include that line in your .config. (I don&#039;t currently have any kernel modifications, so I am not quite sure how the kernel options behave there.)</p><p>Ps.<br />After you have configured the system as you like, look at the output of &quot;./scripts/diffconfig.sh&quot;. It should list all your deviations from the defaults. You can use that file as the .config template. E.g. I use the following file that I expand to full .config with &quot;make defconfig&quot;.&nbsp; <a href="http://koti.welho.com/hnyman1/Openwrt/trunk-r38641-2013-11-04/WNDR3700-trunk-r38641-2013-11-04-1919.diffconfig">http://koti.welho.com/hnyman1/Openwrt/t … diffconfig</a></p></blockquote></div><p>Thanks again hnyman, I hardcore my modifications in the Config-3.10 and it works perfectly, now the packages I wanted are by default selected.</p><p>Thanks</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>