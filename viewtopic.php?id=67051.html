<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Need space to install package for USB storage</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 29 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p335272">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">markos</div>
					<div class="post-datetime">
						21 Aug 2016, 06:41					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I installed the Chaos Calmer 15.05.1 in a TL-MR3020, without problem.</p><p>but now I need to install packages to use a pen drive and install the rootfs:<br /><a href="https://wiki.openwrt.org/doc/howto/extroot">https://wiki.openwrt.org/doc/howto/extroot</a></p><p>But I can&#039;t install the basic packages. </p><p><a href="https://wiki.openwrt.org/doc/howto/usb.overview">https://wiki.openwrt.org/doc/howto/usb.overview</a><br /><a href="https://wiki.openwrt.org/doc/howto/usb.essentials">https://wiki.openwrt.org/doc/howto/usb.essentials</a><br /><a href="https://wiki.openwrt.org/doc/howto/usb.storage">https://wiki.openwrt.org/doc/howto/usb.storage</a></p><p>For example, I don&#039;t have space to install kmod-fs-ext4:</p><p>root@OpenWrt:/# opkg install kmod-fs-ext4<br />Installing kmod-fs-ext4 (3.18.23-1) to root...<br />Collected errors:<br /> * verify_pkg_installable: Only have 176kb available on filesystem /overlay, pkg kmod-fs-ext4 needs 221<br /> * opkg_install_cmd: Cannot install package kmod-fs-ext4.</p><p>What options I have to increase space and install the required packages?</p><p>Thank you,<br />Markos</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p335281">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Max Hopper</div>
					<div class="post-datetime">
						21 Aug 2016, 08:25					</div>
				</div>
				<div class="post-content content">
					<p>Build system or Image Generator.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p335287">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">MagicSimon</div>
					<div class="post-datetime">
						21 Aug 2016, 10:36					</div>
				</div>
				<div class="post-content content">
					<p>I would check if you have some unneeded packages installed and remove them. Once you have your usb working and can install packages there.</p><div class="quotebox"><cite>Max Hopper wrote:</cite><blockquote><p>Build system or Image Generator.</p></blockquote></div><p>I don&#039;t understand that. Would you mind elaborating? At least a whole sentence might be helpful.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p335288">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">stas2z</div>
					<div class="post-datetime">
						21 Aug 2016, 10:40					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>MagicSimon wrote:</cite><blockquote><p>At least a whole sentence might be helpful.</p></blockquote></div><p>Use image builder to build your own image with all usb storage packages preinstalled or build whole firmware with it from scratch with buildroot.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p335337">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">markos</div>
					<div class="post-datetime">
						21 Aug 2016, 16:55					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>From what I saw generate an image using Image Generator is a much more complex step. Also I would need a machine with 64-bit system.</p><p>From what I saw during package installation attempts the system installed (Chaos Calmer 15.05.1) already has some packages, for example, I would not need to install kmod-usb-uhci or kmod-usb-ohci or even kmod-usb2. (<a href="https://wiki.openwrt.org/doc/howto/usb.essentials">https://wiki.openwrt.org/doc/howto/usb.essentials</a>)</p><p>insmod usbcore<br />module is already loaded - usbcore<br />opkg install kmod-usb2<br />Package kmod-usb2 (3.18.23-1) installed in root is up to date.</p><p>root@OpenWrt:~# opkg install kmod-usb-uhci<br />Installing kmod-usb-uhci (3.18.23-1) to root...<br />Downloading <a href="http://downloads.openwrt.org/chaos_calmer/15.05.1/ar71xx/generic/packages/base/kmod-usb-uhci_3.18.23-1_ar71xx.ipk.">http://downloads.openwrt.org/chaos_calm … r71xx.ipk.</a><br />Configuring kmod-usb-uhci.<br />root@OpenWrt:~# insmod usbcore<br />module is already loaded - usbcore<br />root@OpenWrt:~# opkg install kmod-usb2<br />Package kmod-usb2 (3.18.23-1) installed in root is up to date.<br />root@OpenWrt:~# insmod ehci-hcd<br />module is already loaded - ehci-hcd</p><p>Now I&#039;m trying to figure out which packages are in the area where I can remove and which are in the area where I can not remove.</p><p>I&#039;m would like to get a few bytes to install only the modules for storage (<a href="https://wiki.openwrt.org/doc/howto/usb.storage">https://wiki.openwrt.org/doc/howto/usb.storage</a>).</p><p>I think the command opkg list-installed show all packages installed and I don&#039;t know are removable or not.</p><p>Any tip?</p><p>Thanks,<br />Markos</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p335342">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						21 Aug 2016, 17:09					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>markos wrote:</cite><blockquote><p>Also I would need a machine with 64-bit system.</p></blockquote></div><p>This ain&#039;t true at all. From a hardware POV, all you need is a Linux desktop computer (32 or 64 bit) with at least 4 GB (the more the better) RAM and lots of disk space, i.e. 100 GB (the more the merrier). The CPU clock is also very important. The higher the clock, the faster your computer will compile. From a software POV, your computer will need to have a compiler (preferable GCC) and some required libraries.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p335415">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">RangerZ</div>
					<div class="post-datetime">
						22 Aug 2016, 02:02					</div>
				</div>
				<div class="post-content content">
					<p>Markos, if you have not figured it out yet, you can not simply delete packages that are part of the flashed image.&nbsp; The only way to reduce the size is to make your own and eliminate packages you do not need.&nbsp; The question then becomes what?</p><p>The TL-MR3020 is marginal spec wise for the current software (4mb/32mb) which as you have discovered takes almost the full 4mb.&nbsp; There are a number of posts on this device, some of which ask the same question.&nbsp; Even if you do figure this out, you will struggle with the same issue going forward if you want to do other things.&nbsp; </p><p>There are a number of other devices out there that can be had for $20 - $30 delivered.&nbsp; The TOH can be sorted by &quot;Travel Router&quot; to get you a list of what is available.&nbsp; Check the supported columns and verify if it is in current, trunk or a user project (which may or may not be well supported)<br /><a href="https://wiki.openwrt.org/toh/views/toh_extended_all?dataflt%5BDevice+Type*%7E%5D=travel">https://wiki.openwrt.org/toh/views/toh_ … %5D=travel</a></p><p>You can get by with an 8mb/32mb device, but a 16/64 will offer you more flexibility going forward and not be much more money.</p><p>This is the least expensive GLI, which comes with OpenWrt installed and already configured for USB.&nbsp; <br /><a href="http://www.gl-inet.com/product/gl-mt300n/">http://www.gl-inet.com/product/gl-mt300n/</a></p><p>It&#039;s a trade off between Time (and skills) vs Money.&nbsp; I do not know which you have more of.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p335419">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">tunk</div>
					<div class="post-datetime">
						22 Aug 2016, 02:49					</div>
				</div>
				<div class="post-content content">
					<p>Older OpenWrt versions have slightly more free space, which may (or may not) be enough for your packages.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p335450">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">dktn</div>
					<div class="post-datetime">
						22 Aug 2016, 11:21					</div>
				</div>
				<div class="post-content content">
					<p><a href="https://forum.openwrt.org/search.php?action=show_user_posts&amp;user_id=141227">https://forum.openwrt.org/search.php?ac … _id=141227</a></p>											<p class="post-edited">(Last edited by <strong>dktn</strong> on 22 Aug 2016, 11:23)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p335525">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">MagicSimon</div>
					<div class="post-datetime">
						22 Aug 2016, 21:49					</div>
				</div>
				<div class="post-content content">
					<p>@RangerZ: just to clarify. The problem is that the prebuild image takes basically up all the space of the TL-MR3020, right? So he is not able to at least install the usb und fs modules to make use of an usb storage device (and install some packages there)?</p><p>Only solution for that problem is the get a different device or build a smaller image on his own (i.e. with less packages included)?</p><p>Last question: Does the &quot;removing packages with opkg is not freeing space&quot; just referr to packages that are part of the image or to any package whether part of the image or later installed with opkg? Or worded differently: Do you (slowly) use up space if I install a package with `opkg install` and then later remove it again?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>