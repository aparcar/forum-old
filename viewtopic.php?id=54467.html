<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> PPPoE connection issue.</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 25 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p256898">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Dolfik</div>
					<div class="post-datetime">
						7 Dec 2014, 19:40					</div>
				</div>
				<div class="post-content content">
					<p>Hi, i have router Zyxel Keenetic Lite rev. B, and i can&#039;t estabilish connection through router. I try 3 some firmware, two firmware from manufacturer and OpenWrt, and no one did not work with PPPoE.<br />First log without &quot;option keepalive &#039;30&#039;&quot;: <a href="http://pastebin.com/z0sJ56CS.">http://pastebin.com/z0sJ56CS.</a><br />Second log with &quot;option keepalive &#039;30&#039;&quot; and cat /etc/config/network: <a href="http://pastebin.com/Aqd2a6yK">http://pastebin.com/Aqd2a6yK</a> <br />Please help me.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p256900">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">mk24</div>
					<div class="post-datetime">
						7 Dec 2014, 19:59					</div>
				</div>
				<div class="post-content content">
					<p>If you have a separate DSL modem, you need to configure the modem itself for bridge mode.&nbsp; In most cases the phone company provided device is a combination modem/router which is pre-configured to issue DHCP addresses and take regular IP traffic on the ethernet port.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p256905">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Dolfik</div>
					<div class="post-datetime">
						7 Dec 2014, 20:59					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>mk24 wrote:</cite><blockquote><p>If you have a separate DSL modem, you need to configure the modem itself for bridge mode.&nbsp; In most cases the phone company provided device is a combination modem/router which is pre-configured to issue DHCP addresses and take regular IP traffic on the ethernet port.</p></blockquote></div><p>I do not have a modem, i think problem in my router, because if i connect cable to PC its work perfectly.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p256957">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">123serge123</div>
					<div class="post-datetime">
						8 Dec 2014, 15:47					</div>
				</div>
				<div class="post-content content">
					<p>Possibly you need add &#039;option macaddr XX:XX:XX:XX:XX&#039; into wan section of network-file (where XX:XX:XX:XX:XX - your PC MAC address)?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p256961">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">captainfreeky</div>
					<div class="post-datetime">
						8 Dec 2014, 16:28					</div>
				</div>
				<div class="post-content content">
					<p>use this via ssh or telnet uci set network.wan.macaddr=your mac in 00:00:00...... format <br />2nd --- &gt; uci show&nbsp; /etc/config/network&nbsp; &nbsp; &nbsp;<br />the above command will show you the mac add inserted </p><p>3r ---&gt;&nbsp; &nbsp;uci commit network</p><p>4 --&gt; ifdown wan &amp;&amp; ifup wan</p><p>5th -----&gt;&nbsp; &nbsp;/etc/init.d/network restart</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p256982">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Dolfik</div>
					<div class="post-datetime">
						8 Dec 2014, 20:24					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for answers, i try it, but it still does not work.<br />Log and config: <a href="http://pastebin.com/CRdFeWJf">http://pastebin.com/CRdFeWJf</a><br />Mac address i take from the bottom side of the router (MAC-address WAN).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p256992">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">captainfreeky</div>
					<div class="post-datetime">
						8 Dec 2014, 21:28					</div>
				</div>
				<div class="post-content content">
					<p>Which OS are you using ? not at router end at your machine ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p256993">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">captainfreeky</div>
					<div class="post-datetime">
						8 Dec 2014, 21:30					</div>
				</div>
				<div class="post-content content">
					<p>as per your log this is where the pppoe is not able to complete pppoe discovery<br />Mon Dec&nbsp; 8 21:52:10 2014 daemon.warn pppd[2672]: Timeout waiting for PADS packets<br />Mon Dec&nbsp; 8 21:52:10 2014 daemon.err pppd[2672]: Unable to complete PPPoE Discover</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p256996">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">Dolfik</div>
					<div class="post-datetime">
						8 Dec 2014, 22:13					</div>
				</div>
				<div class="post-content content">
					<p>I use windows 7 and windows 8.1. I also tried to connect through WiFi, and get same errors.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p257038">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">123serge123</div>
					<div class="post-datetime">
						9 Dec 2014, 04:07					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Dolfik wrote:</cite><blockquote><p>Mac address i take from the bottom side of the router (MAC-address WAN).</p></blockquote></div><p>Why? You need computer MAC not router. Some providers control connected devices by means of MAC.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p257221">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">Dolfik</div>
					<div class="post-datetime">
						10 Dec 2014, 17:26					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>123serge123 wrote:</cite><blockquote><div class="quotebox"><cite>Dolfik wrote:</cite><blockquote><p>Mac address i take from the bottom side of the router (MAC-address WAN).</p></blockquote></div><p>Why? You need computer MAC not router. Some providers control connected devices by means of MAC.</p></blockquote></div><p>I change MAC address, but this still not work. Router authorized successfully, receive ip address, but can not perform echo requests.<br />Log: <a href="http://pastebin.com/t0btdSz6">http://pastebin.com/t0btdSz6</a></p>											<p class="post-edited">(Last edited by <strong>Dolfik</strong> on 10 Dec 2014, 17:26)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p257225">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">eduperez</div>
					<div class="post-datetime">
						10 Dec 2014, 17:39					</div>
				</div>
				<div class="post-content content">
					<p>Looks like your ppp interface is going down immediately; add the following line to the &quot;ppoe-wan&quot; interface configuration, and paste the results here:</p><div class="codebox"><pre><code>option &#039;pppd_options&#039; &#039;debug&#039;</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p257235">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">Dolfik</div>
					<div class="post-datetime">
						10 Dec 2014, 18:17					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>eduperez wrote:</cite><blockquote><p>Looks like your ppp interface is going down immediately; add the following line to the &quot;ppoe-wan&quot; interface configuration, and paste the results here:</p><div class="codebox"><pre><code>option &#039;pppd_options&#039; &#039;debug&#039;</code></pre></div></blockquote></div><p>I added this option.<br />Log: <a href="http://pastebin.com/JGdS0TtG">http://pastebin.com/JGdS0TtG</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p257287">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">eduperez</div>
					<div class="post-datetime">
						10 Dec 2014, 22:58					</div>
				</div>
				<div class="post-content content">
					<p>I am no expert here, but it looks like your router is establishing a connection, you even get an IP address and a couple of nameservers. But then your pppd starts sending echo request, and after 5 consecutive unanswered requests, it assumes the connection is down:<br /></p><div class="codebox"><pre><code>Wed Dec 10 19:31:55 2014 daemon.info pppd[1656]: No response to 5 echo-requests
Wed Dec 10 19:31:55 2014 daemon.notice pppd[1656]: Serial link appears to be disconnected.</code></pre></div><p>However, when it sends a termination request to the other peer, it responds:<br /></p><div class="codebox"><pre><code>Wed Dec 10 19:31:55 2014 daemon.debug pppd[1656]: sent [LCP TermReq id=0x6 &quot;Peer not responding&quot;]
Wed Dec 10 19:31:55 2014 daemon.debug pppd[1656]: rcvd [LCP TermAck id=0x6]</code></pre></div><p>So perhaps the connection was working after all... I would try to determine whether the connection is really down, or is just a problem with the echo requests. In the interface configuration, add the following line:<br /></p><div class="codebox"><pre><code>option keepalive 100</code></pre></div><p>That should give you plenty of time to test the connection (start with a PING the other end of the link, then try some other site, ...).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p257470">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">Dolfik</div>
					<div class="post-datetime">
						12 Dec 2014, 16:50					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>eduperez wrote:</cite><blockquote><p>I am no expert here, but it looks like your router is establishing a connection, you even get an IP address and a couple of nameservers. But then your pppd starts sending echo request, and after 5 consecutive unanswered requests, it assumes the connection is down:<br /></p><div class="codebox"><pre><code>Wed Dec 10 19:31:55 2014 daemon.info pppd[1656]: No response to 5 echo-requests
Wed Dec 10 19:31:55 2014 daemon.notice pppd[1656]: Serial link appears to be disconnected.</code></pre></div><p>However, when it sends a termination request to the other peer, it responds:<br /></p><div class="codebox"><pre><code>Wed Dec 10 19:31:55 2014 daemon.debug pppd[1656]: sent [LCP TermReq id=0x6 &quot;Peer not responding&quot;]
Wed Dec 10 19:31:55 2014 daemon.debug pppd[1656]: rcvd [LCP TermAck id=0x6]</code></pre></div><p>So perhaps the connection was working after all... I would try to determine whether the connection is really down, or is just a problem with the echo requests. In the interface configuration, add the following line:<br /></p><div class="codebox"><pre><code>option keepalive 100</code></pre></div><p>That should give you plenty of time to test the connection (start with a PING the other end of the link, then try some other site, ...).</p></blockquote></div><p>That&#039;s not work.<br />Log: <a href="http://pastebin.com/YBPnYQT6">http://pastebin.com/YBPnYQT6</a><br />Full /etc/config/network: <a href="http://pastebin.com/MxJbDNi9">http://pastebin.com/MxJbDNi9</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p257524">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">eduperez</div>
					<div class="post-datetime">
						12 Dec 2014, 23:11					</div>
				</div>
				<div class="post-content content">
					<p>Now I see lots of &quot;Configuration Request&quot; messages related to an IP address... try putting this in your config file:</p><div class="codebox"><pre><code>option &#039;pppd_options&#039; &#039;debug noipdefault&#039;</code></pre></div><p>.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p257970">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">Dolfik</div>
					<div class="post-datetime">
						17 Dec 2014, 14:29					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>eduperez wrote:</cite><blockquote><p>Now I see lots of &quot;Configuration Request&quot; messages related to an IP address... try putting this in your config file:</p><div class="codebox"><pre><code>option &#039;pppd_options&#039; &#039;debug noipdefault&#039;</code></pre></div><p>.</p></blockquote></div><p>New log: <a href="http://pastebin.com/biqByWa8">http://pastebin.com/biqByWa8</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p257976">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">eduperez</div>
					<div class="post-datetime">
						17 Dec 2014, 16:34					</div>
				</div>
				<div class="post-content content">
					<p>There is something confusing in those logs: it seems like the connection is down, but then there are some PPP messages, later the connection seems to be up again, and I do not see when it goes down... Could you please mark in your logs when you put the connection down manually, when you put it up again, and when it stops working?</p><p>Also, I would like to know the details of how do you configure your computer when you use it to establish the connection.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p257988">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">Dolfik</div>
					<div class="post-datetime">
						17 Dec 2014, 19:48					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>eduperez wrote:</cite><blockquote><p>There is something confusing in those logs: it seems like the connection is down, but then there are some PPP messages, later the connection seems to be up again, and I do not see when it goes down... Could you please mark in your logs when you put the connection down manually, when you put it up again, and when it stops working?</p><p>Also, I would like to know the details of how do you configure your computer when you use it to establish the connection.</p></blockquote></div><p>I dont down connection manually, i just change my settings through SSH and reboot router.<br />I use default PPPoE settings in Windows 7, just create connection, enter my login and password, and all work fine.<br />Also i try change MTU size, i use 1400, 1450, 1496 and default 1500 (current).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p258002">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">eduperez</div>
					<div class="post-datetime">
						18 Dec 2014, 00:01					</div>
				</div>
				<div class="post-content content">
					<p>In the logs from your last post, link seems to be stable; are you sure it is not working?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>