<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> WDS question</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 22 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p8643">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">tosuja</div>
					<div class="post-datetime">
						22 Jun 2005, 17:54					</div>
				</div>
				<div class="post-content content">
					<p>Hi. Let&#039;s say that I have several (let&#039;s say 5) repeaters in WDS mode. Every repeater is in range of other ones. How will the repeating behave? What about radio noise and speed decrease? I understand that WDS means that &quot;what comes in goes out&quot;. Is it right? Is the repeating &quot;inteligent&quot; and routes the packets to it&#039;s destination somehow instead of just repeating and hoping that it eventually reaches it&#039;s target?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p8647">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">wirelessjoe</div>
					<div class="post-datetime">
						22 Jun 2005, 20:49					</div>
				</div>
				<div class="post-content content">
					<p>I never tryed it with OpenWrt and Lots of AP&#039;s but with Hyperwrt<br />you can remove: wl0_mode=ap, wl0_mode=sta, wl0_mode=wet etc<br />don&#039;t break that bridge<br />then run wl0_mode=wds</p><p>WRT54G-1[BR0][WDS]&lt;---------------&gt;[WDS][BR0]WRT54G-2</p><p>do you know what I mean ?</p>											<p class="post-edited">(Last edited by <strong>wirelessjoe</strong> on 22 Jun 2005, 22:32)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p8648">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">tosuja</div>
					<div class="post-datetime">
						22 Jun 2005, 21:22					</div>
				</div>
				<div class="post-content content">
					<p>wl0_mode=wds does not seem to be in the documentation, interesting. However I have no problem making it work, I&#039;m just asking how WDS works when using several repeaters, what&#039;s the speed penalty and so on. I have to cover quite large area for public usage and I&#039;d like to know if it&#039;s possible to do it using WDS.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p8653">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">wirelessjoe</div>
					<div class="post-datetime">
						22 Jun 2005, 22:15					</div>
				</div>
				<div class="post-content content">
					<p>please don&#039;t miss understand me because I used Hyperwrt for this, (I do use OpenWrt for Other things)</p><p>yes I tried this with Hyperwrt Firmware, WDS-WPA-PSK with AES encryption <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></p><p>[ anything and everything, download, upload, voip-(vonage)(asterisk), firewall, qos, mass-mess] ha everything over WDS<br />my connections are not bad, I feel its very fast, (I mean Transfer 228.795 MB took 110-sec over WDS link)<br />2 WRTs configure as WDS node, they don&#039;t accept any other wireless client (but you may configure them as AP too - if you have wireless clients) all my pc&#039;s on Ethernet LAN - </p><p>Note: I think&nbsp; you should not configure same WRT as AP and WDS node (cause then things start to slow down) now we can buy more Linksys box and put them as AP and connect them to WDS nodes with RJ45 cable</p><p>NOW you want to know how to do it: from here all the credits to &quot;Traveller&quot; and I am using Linksys V3.0 so I remove all afterburner stuff</p><p>I posted the following to Linksysinfo a while back.&nbsp; I&#039;m currently using it between 2 GS&#039;es.&nbsp; Note that &quot;gmode 6&quot; doesn&#039;t seem to be used to control afterburner anymore, in the most recent Linksys-firmware / drivers.&nbsp; They switched to &quot;afterburner_override&quot; for that.</p><br /><p>Here&#039;s the posting:</p><p>I just setup a WPA-PSK AES-encrypted WDS point to point-link between 2 v1.0 WRT54GS&#039;s, running HyperWRT_2.1b1_GS. It&#039;s actually pretty straightforward, if you&#039;re familiar with the inner workings of the units. BTW: WDS only halves throughput if you use an AP with 1 radio, like the WRT54G(S), on the far end of a WDS-link to connect clients which need to talk to something on the other side of that WDS-link. The radio will have to repeat all data in that case. If you only connect to the LAN-ports on both sides, WDS is about as fast as regular AP -&gt; client. I&#039;m currently pulling around 20 Mbit/sec over a distance of around 2 KM with this setup, using external directional antenna&#039;s. </p><br /><p>Here&#039;s my setup: </p><p>LAN &lt;---&gt; WRT54GS 1 &lt;----WDS----&gt; WRT54GS 2 &lt;---&gt; LAN </p><p>Start out by factory-defaulting and configuring basic IP on both units. Also configure wireless for the desired channel and SSID. Make sure you select &quot;G-only&quot; wireless mode. Enable WPA-PSK, choose AES for encryption and select a strong pass-phrase. I always change the &quot;Group Key Renewal&quot;-interval to 600 seconds. Under &quot;Advanced Wireless&quot;, you could tweak antenna and power-settings. It&#039;s best to keep the wireless settings identical on both units. Once everything works, you can backup your settings and start playing with them. Locking the transmission-rate to the highest possible value sometimes improves throughput. Under &quot;Administration -&gt; Management&quot; you could turn off UPnP, enable HTTPS and &quot;Wireless Access Web&quot;. </p><p>One of the first things you need to know to set up WDS, is the MAC-address of the wireless interface for all units participating. This can be found in the web-interface, under &quot;Status -&gt; Wireless&quot;. </p><p>Let&#039;s assume: </p><p>WRT54GS 1: 00:0F:66:11:11:11 <br />WRT54GS 2: 00:0F:66:22:22:22 </p><p>These are the settings I will use in my example below: </p><p>SSID: Test <br />WPA PSK: SuperSecret </p><p>And now for the good stuff. Let&#039;s start by configuring WRT54GS 1: </p><p>Under &quot;Administration -&gt; Management&quot;, click the &quot;Firewall&quot;-button and paste the following into the window, then click &quot;Save&quot; at the bottom: </p><p>----------------------------------------------------- <br /># Some NVRAM presets. <br />nvram set wl_mode=wds <br />nvram set wl0_mode=wds <br />nvram set wl_lazywds=0 <br />nvram set wl0_lazywds=0 <br />nvram set wl_afterburner=off <br />nvram set wl0_afterburner=off <br />nvram set wl_afterburner_override=0 <br />nvram set wl0_afterburner_override=0 <br />nvram set wl_wds=00:0F:66:22:22:22 <br />nvram set wl0_wds=00:0F:66:22:22:22 </p><p># No lazywds. <br />wl lazywds 0 <br />----------------------------------------------------- </p><p>Now close the &quot;Firewall Script&quot;-window and, still under &quot;Administration -&gt; Management&quot;, click the &quot;Startup&quot;-button. Paste the following into the window and click &quot;Save&quot; at the bottom: </p><p>----------------------------------------------------- <br /># Authenticate WPA-PSK encrypted WDS-interfaces. <br />nas4not lan wds0.2 up auto aes psk &#039;SuperSecret&#039; &#039;Test&#039; <br />----------------------------------------------------- </p><br /><p>That&#039;s it for WRT54GS 1. The config for WRT54GS 2 is identical, except for the MAC-address for WDS. Each unit uses the other unit&#039;s MAC-address. For clarity, here it is: </p><p>Under &quot;Administration -&gt; Management&quot;, click the &quot;Firewall&quot;-button and paste the following into the window, then click &quot;Save&quot; at the bottom: </p><p>----------------------------------------------------- <br /># Some NVRAM presets. <br />nvram set wl_mode=wds <br />nvram set wl0_mode=wds <br />nvram set wl_lazywds=0 <br />nvram set wl0_lazywds=0 <br />nvram set wl_afterburner=off <br />nvram set wl0_afterburner=off <br />nvram set wl_afterburner_override=0 <br />nvram set wl0_afterburner_override=0 <br />nvram set wl_wds=00:0F:66:11:11:11 <br />nvram set wl0_wds=00:0F:66:11:11:11 </p><p># No lazywds. <br />wl lazywds 0 <br />----------------------------------------------------- </p><p>Now close the &quot;Firewall Script&quot;-window and, still under &quot;Administration -&gt; Management&quot;, click the &quot;Startup&quot;-button. Paste the following into the window and click &quot;Save&quot; at the bottom: </p><p>----------------------------------------------------- <br /># Authenticate WPA-PSK encrypted WDS-interfaces. <br />nas4not lan wds0.2 up auto aes psk &#039;SuperSecret&#039; &#039;Test&#039; <br />----------------------------------------------------- </p><br /><p>That&#039;s it. Reboot both units and they should start talking to eachother. Some notes about the configuration above: </p><p>This is a WDS-only configuration. All AP-functionality is disabled. The units won&#039;t accept clients and won&#039;t even send out any beacons, as far as I can tell. It&#039;s identical to the WAP54G &quot;bridge-mode&quot;. If you need to connect clients, change the first 2 NVRAM-parameters in the example above to: </p><p>nvram set wl_mode=ap <br />nvram set wl0_mode=ap </p><br /><p>The latest wireless drivers and NAS allow for some pretty neat tricks. <img src="https://forum.openwrt.org/img/smilies/cool.png" width="15" height="15" alt="cool" /> You can setup multiple WPA-PSK encrypted WDS-links and use a different encryption, <img src="https://forum.openwrt.org/img/smilies/lol.png" width="15" height="15" alt="lol" /> pass-phrase and SSID for any of the WDS-links and AP-mode, for example. I won&#039;t go into too much details at the moment, but if you use the above configuration in AP-mode, with clients, you should be able to change the &quot;Wireless Security&quot;-parameters in the web-interface to anything you want, as long as it&#039;s WPA. The clients will use those settings and the WDS-link will use the settings you pasted into to &quot;Startup&quot;-window as the `nas4not&#039; command-line. </p><p>Good luck and for anyone who tries, please post any results and questions. </p><br /><br /><p>Grtz, </p><p>Traveller / WirelessJoe</p>											<p class="post-edited">(Last edited by <strong>wirelessjoe</strong> on 22 Jun 2005, 22:27)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p8681">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">mrmoj</div>
					<div class="post-datetime">
						24 Jun 2005, 03:21					</div>
				</div>
				<div class="post-content content">
					<p>tosuja, I&#039;m not sure your question was answered, so let me give it a try.&nbsp; I&#039;ve heard that WDS networks are indeed plagued by slowness, because when a node broadcasts X to all nodes in its area, when they all hear it, they re-broadcast it again.&nbsp; so all these secondary nodes have wasted the amount of time it takes to send/receive X twice.&nbsp; now this second node&#039;s neighbors hear the message, and again rebroadcast it, and have wasted just as much time on the same message as the 2nd-teir nodes.&nbsp; At this point, some nodes will have heard the message twice maybe.&nbsp; This wastes bandwidth/time again, of course, because if there&#039;s data going through the airwaves, you can&#039;t talk and have to wait.</p><p>contrast this with Olsr.&nbsp; nodes sense their neighbors and tell other nodes who they can contact.&nbsp; After just a few seconds, every node in the mesh can see a route to every other node in the mesh.&nbsp; messages are only broadcast to the node that can take the messages closer to its destination, and not broadcast needlessly everywhere just to make sure every corner heard it.</p><p>check out <a href="http://doctormojo.com/wrt54g/">http://doctormojo.com/wrt54g/</a> to see how I implemented a similar situation, and the topology map at the bottom (that is _not_ currently being auto-generated) but _was_ last night.</p><p>check out <a href="http://meshcube.org/meshwiki/OlsrTopologyVisualization">http://meshcube.org/meshwiki/OlsrTopologyVisualization</a> to see another auto-generated topo map.&nbsp; Everybody on that map can route to everybody else on that map, and there would be no &#039;wasted&#039; bandwidth persay.</p><p>hope this helps and is not too far off-topic!</p>											<p class="post-edited">(Last edited by <strong>mrmoj</strong> on 26 Jun 2005, 02:00)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p8731">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">sbingner</div>
					<div class="post-datetime">
						26 Jun 2005, 01:14					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>tosuja wrote:</cite><blockquote><p>Hi. Let&#039;s say that I have several (let&#039;s say 5) repeaters in WDS mode. Every repeater is in range of other ones. How will the repeating behave? What about radio noise and speed decrease? I understand that WDS means that &quot;what comes in goes out&quot;. Is it right? Is the repeating &quot;inteligent&quot; and routes the packets to it&#039;s destination somehow instead of just repeating and hoping that it eventually reaches it&#039;s target?</p></blockquote></div><p>*sigh* ok, in WDS there is a point-to-point link configured for every AP you want to talk to.&nbsp; Those linke are then added to a software bridge... and if you have multiple links, you NEED spanning tree running on it.&nbsp; &nbsp;The spanning tree protocol will determine a root bridge and a path, then all packets will traverse the spanning tree via WDS links.</p><p>So, depending on how you&#039;re set up it could actually end up bouncing off all 5 routers, or you could only hit one or two...&nbsp; personally I&#039;ve configured mine with brouting to ROUTE over the wds links (ospf) so it will use the best path but you still have to have them all added to the bridge so that nas can configure them</p><p>Sam</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p8736">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">wirelessjoe</div>
					<div class="post-datetime">
						26 Jun 2005, 05:11					</div>
				</div>
				<div class="post-content content">
					<p>again I ddin&#039;t do this yet</p><p>what if we forget about bridge and WDS, break all interfaces apart, then use as real router, then do nat firewalling etc</p><p>I know its more work</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p8737">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">sbingner</div>
					<div class="post-datetime">
						26 Jun 2005, 05:26					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>wirelessjoe wrote:</cite><blockquote><p>again I ddin&#039;t do this yet</p><p>what if we forget about bridge and WDS, break all interfaces apart, then use as real router, then do nat firewalling etc</p><p>I know its more work</p></blockquote></div><p>just don&#039;t try to run WPA on it then, that won&#039;t work...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p8741">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">wirelessjoe</div>
					<div class="post-datetime">
						26 Jun 2005, 08:10					</div>
				</div>
				<div class="post-content content">
					<p>Thanks Sbingner</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p8786">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">tosuja</div>
					<div class="post-datetime">
						27 Jun 2005, 10:02					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>sbingner wrote:</cite><blockquote><p>*sigh* ok, in WDS there is a point-to-point link configured for every AP you want to talk to.&nbsp; Those linke are then added to a software bridge... and if you have multiple links, you NEED spanning tree running on it.&nbsp; &nbsp;The spanning tree protocol will determine a root bridge and a path, then all packets will traverse the spanning tree via WDS links.</p><p>So, depending on how you&#039;re set up it could actually end up bouncing off all 5 routers, or you could only hit one or two...&nbsp; personally I&#039;ve configured mine with brouting to ROUTE over the wds links (ospf) so it will use the best path but you still have to have them all added to the bridge so that nas can configure them<br />Sam</p></blockquote></div><p>I was commanded to test 10 Linksyses in WDS mode and of course only possibility was to use STP. Final throughput was 8Mb/s which is enough for my purposes.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>