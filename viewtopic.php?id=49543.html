<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> tl-mr3040 v2.2 wrong firmware flashed, device do not boot</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 29 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p227671">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">lieni</div>
					<div class="post-datetime">
						15 Mar 2014, 20:49					</div>
				</div>
				<div class="post-content content">
					<p>Everything went well with my device, and i wanted to add an additional flash, but for the driver i had no space. i tried to uninstall some packeges, but no one was uninstalled becaus missing space. so far so well, i desidet to start again by flashing die factory firmware, but I took the wrong version</p><p><a href="http://downloads.openwrt.org/backfire/10.03.1/ar71xx/openwrt-ar71xx-tl-mr3420-v1-squashfs-factory.bin">http://downloads.openwrt.org/backfire/1 … actory.bin</a><br />instad of<br /><a href="http://downloads.openwrt.org/backfire/10.03.1/ar71xx/openwrt-ar71xx-tl-mr3420-v2-squashfs-factory.bin">http://downloads.openwrt.org/backfire/1 … actory.bin</a></p><p>Now my device will not boot anymore. Is there a way out. Yes I know, this should not happen, but anyway, if someone has an idea, pleas let me know</p><p>thanks <br />lieni</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p227784">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">hackru</div>
					<div class="post-datetime">
						17 Mar 2014, 15:58					</div>
				</div>
				<div class="post-content content">
					<p>Connect to gnd, tp_in and tp_out pads. uboot have tftp recovery.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p227807">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">MBS</div>
					<div class="post-datetime">
						17 Mar 2014, 21:08					</div>
				</div>
				<div class="post-content content">
					<p>Read those pages first:<br /><a href="http://wiki.openwrt.org/doc/hardware/port.serial">http://wiki.openwrt.org/doc/hardware/port.serial</a><br /><a href="http://wiki.openwrt.org/toh/tp-link/tl-mr3040#serial.console">http://wiki.openwrt.org/toh/tp-link/tl- … al.console</a><br /><a href="http://wiki.openwrt.org/toh/tp-link/tl-mr3040#manual.flash.under.u-boot.serial.console1">http://wiki.openwrt.org/toh/tp-link/tl- … l.console1</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228041">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">lieni</div>
					<div class="post-datetime">
						20 Mar 2014, 19:00					</div>
				</div>
				<div class="post-content content">
					<p>Thanks a lot, till now I could not reflah my device. I have first to organize a seial to USB cable, which I found with the nocia ca-42. Quit cheap but heavy to get anymore.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228063">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">lieni</div>
					<div class="post-datetime">
						20 Mar 2014, 23:03					</div>
				</div>
				<div class="post-content content">
					<p>I did it. I could install Luci and now I try to extend the rootfs. But with very success.<br />I can&#039;t my device ti mount, because I can&#039;t install kmod-usb-storage (My versions I got from <a href="http://downloads.openwrt.org/snapshots/trunk/ar71xx/">http://downloads.openwrt.org/snapshots/trunk/ar71xx/</a></p><p>root@OpenWrt:/tmp# opkg install kmod-usb-storage<br />Installing kmod-usb-storage (3.10.32-1) to root...<br />Downloading <a href="http://downloads.openwrt.org/snapshots/trunk/ar71xx/packages/kmod-usb-storage_3.10.32-1_ar71xx.ipk.">http://downloads.openwrt.org/snapshots/ … r71xx.ipk.</a><br />Collected errors:<br /> * satisfy_dependencies_for: Cannot satisfy the following dependencies for kmod-usb-storage:<br /> * &nbsp; &nbsp; kernel (= 3.10.32-1-731080935ab5c562909a75433f9c7f81) * &nbsp; &nbsp; kernel (= 3.10.32-1-731080935ab5c562909a75433f9c7f81) * <br /> * opkg_install_cmd: Cannot install package kmod-usb-storage.<br />root@OpenWrt:/tmp#</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228146">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">MBS</div>
					<div class="post-datetime">
						21 Mar 2014, 20:32					</div>
				</div>
				<div class="post-content content">
					<p>Well, trunk images are tricky. They get built every 2-3 days and thus that hash number changes. Especially kernel modules are very sensitive to this issue. So, you need to download and install a new image and also quickly install all the kernel modules and packages you need.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228157">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						21 Mar 2014, 22:40					</div>
				</div>
				<div class="post-content content">
					<p>or download imagebuilder package along with sysupgrade image, so you get all packages &quot;forever&quot;...</p><p><a href="http://downloads.openwrt.org/snapshots/trunk/ar71xx/OpenWrt-ImageBuilder-ar71xx_generic-for-linux-x86_64.tar.bz2">http://downloads.openwrt.org/snapshots/ … 64.tar.bz2</a></p><p>then you have to extract it and point /etc/opkg.conf to your webserver..</p>											<p class="post-edited">(Last edited by <strong>nebbia88</strong> on 21 Mar 2014, 22:41)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228185">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">lieni</div>
					<div class="post-datetime">
						22 Mar 2014, 16:32					</div>
				</div>
				<div class="post-content content">
					<p>Thank you MBS,<br />Ok I did&nbsp; everything from beginning (with the newest trunk) and tried to install everything I need.<br />Because I have to few space I made an overlay over my rootfs see output from df h:<br />rootfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;14.8G&nbsp; &nbsp; &nbsp;41.3M&nbsp; &nbsp; &nbsp;14.0G&nbsp; &nbsp;0% /<br />/dev/root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2.0M&nbsp; &nbsp; &nbsp; 2.0M&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 100% /rom<br />tmpfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 14.1M&nbsp; &nbsp; 896.0K&nbsp; &nbsp; &nbsp;13.2M&nbsp; &nbsp;6% /tmp<br />/dev/sda1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 14.8G&nbsp; &nbsp; &nbsp;41.3M&nbsp; &nbsp; &nbsp;14.0G&nbsp; &nbsp;0% /overlay<br />overlayfs:/overlay&nbsp; &nbsp; &nbsp; &nbsp;14.8G&nbsp; &nbsp; &nbsp;41.3M&nbsp; &nbsp; &nbsp;14.0G&nbsp; &nbsp;0% /<br />tmpfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;512.0K&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; 512.0K&nbsp; &nbsp;0% /dev</p><br /><p>My rootfs is now 15GB but, when I perform free:<br />root@OpenWrt:/etc# free<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;total&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;used&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;free&nbsp; &nbsp; &nbsp; &nbsp;shared&nbsp; &nbsp; &nbsp; buffers<br />Mem:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;28892&nbsp; &nbsp; &nbsp; &nbsp; 23476&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;5416&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2512<br />-/+ buffers:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 20964&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;7928<br />Swap:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0</p><p>Do I have now 15GB and free lies, or do I have just 5MB free, which is not enough for my wishes Later I wanted to build a swapfile on my new fs, but do see openwrt my rootspace?</p><p>Also to you nebia88, thanks a lot.This I will do, as soon as I come back into the same troubles, but I believe this is a little bit time consuming.<br />Sooner or later I will build everything myself, also to make new packages after my wishes, but for the moment, I would be glad, if everything would work as I expect.</p><p>PS:<br />my /etc/config/fstab looks like this:<br />config global<br />&nbsp; &nbsp; option anon_swap &#039;0&#039;<br />&nbsp; &nbsp; option anon_mount &#039;0&#039;<br />&nbsp; &nbsp; option auto_swap &#039;1&#039;<br />&nbsp; &nbsp; option auto_mount &#039;1&#039;<br />&nbsp; &nbsp; option delay_root &#039;5&#039;<br />&nbsp; &nbsp; option check_fs &#039;0&#039;</p><p>config mount<br />&nbsp; &nbsp; &nbsp; &nbsp; option target /overlay<br />&nbsp; &nbsp; &nbsp; &nbsp; option fstype &#039;ext4&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option options &#039;rw,realtime,barrier=1,data=ordered&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option enabled_fsck &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option enabled &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;/dev/sda1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option is_rootfs &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />#config swap<br />#&nbsp; &nbsp; option enabled &#039;1&#039;<br />#&nbsp; &nbsp; option device &#039;/dev/sda2&#039;</p><p>config global &#039;automount&#039;<br />&nbsp; &nbsp; option from_fstab &#039;1&#039;<br />&nbsp; &nbsp; option anon_mount &#039;0&#039;</p><p>config global &#039;autoswap&#039;<br />&nbsp; &nbsp; option from_fstab &#039;1&#039;<br />&nbsp; &nbsp; option anon_swap &#039;0&#039;</p><p>config mount</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228211">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">MBS</div>
					<div class="post-datetime">
						23 Mar 2014, 00:23					</div>
				</div>
				<div class="post-content content">
					<p>free shows your RAM usage. Use &quot;df&quot; to check your disk usage.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>