<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Local network ignoring etc/hosts?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 30 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p283066">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">danab11</div>
					<div class="post-datetime">
						11 Jul 2015, 01:49					</div>
				</div>
				<div class="post-content content">
					<p>Hi all - a bit of a newbie... my apologies if this is a dumb question.<br />I telnet&#039;d into my router (BCM96368) and added the hosts file missing in /etc<br />I then added some entries into the hosts file (motivation is to block ads). Then I run ping on the router and it gos to the updated IP that I entered in the hosts file - as expected.<br />However, when I go to a computer on the network, with a dhcp connection to this router, I still get the old IP (after I flush dns).<br />How can the router get one IP internally (as defined in the hosts file) and a computer connected to it get a different IP (I guess the &#039;true&#039; IP)?<br />Anything I am missing?</p><br /><p>Thanks in advance</p><p>Dan.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p283292">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">eduperez</div>
					<div class="post-datetime">
						12 Jul 2015, 23:27					</div>
				</div>
				<div class="post-content content">
					<p>Is that router acting as a DNS for your network?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p283301">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">danab11</div>
					<div class="post-datetime">
						13 Jul 2015, 00:09					</div>
				</div>
				<div class="post-content content">
					<p>Its a regular router that connects me to my ISP via PPPOE.<br />But I don&#039;t understand how modifying the hosts file only affects the routers pings and not computers connected to it (via DHCP).<br />Wondering if there is any way to do this?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p283330">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">eduperez</div>
					<div class="post-datetime">
						13 Jul 2015, 11:00					</div>
				</div>
				<div class="post-content content">
					<p>That file will only affect other computers in your network if those computers use that router as a DNS, and the DNS in that router is configured to use that file.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p283399">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">danab11</div>
					<div class="post-datetime">
						13 Jul 2015, 22:23					</div>
				</div>
				<div class="post-content content">
					<p>When you say &quot;using the router as a DNS&quot;, I am assuming the situation in which the computer connected to the router, gets its IP and DNS settings from the router via DHCP? This is exactly the case I am describing.<br />But why would the router internally use the hosts file but computers connected to it ignore it.<br />Doesn&#039;t make sense to me...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p283421">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						13 Jul 2015, 23:29					</div>
				</div>
				<div class="post-content content">
					<p>It wouldn&#039;t. Check that your computer is actually using the router as a DNS server and that there is no manual override.</p><p>Also, did you restart dnsmasq?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p283424">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">danab11</div>
					<div class="post-datetime">
						13 Jul 2015, 23:36					</div>
				</div>
				<div class="post-content content">
					<p>Strangely, I cannot see dnsmasq available. Not even a configuration file.<br />But there was also no hosts file, I needed to add it manually.<br />I confirmed that there was no overrides on the computer of any sort. The Windows network connection interface shows it inherited the DNS from the router.<br />Strange that hooking up to the router via telnet, I ran ping xxx and got the ip in the hosts file and from the connected computer I ran ping xxx and got the original ip. (After flushing dns of course).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p283427">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						13 Jul 2015, 23:57					</div>
				</div>
				<div class="post-content content">
					<p>Configuration is in /etc/config/dhcp. Do a /etc/init.d/dnsmasq restart.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p283428">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">danab11</div>
					<div class="post-datetime">
						14 Jul 2015, 00:00					</div>
				</div>
				<div class="post-content content">
					<p>When I cd into etc and list all dirs, I dont see the config directory.<br />Also, in etc/init.d I dont see dnsmasq<br />Pretty lost here...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p283446">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						14 Jul 2015, 00:52					</div>
				</div>
				<div class="post-content content">
					<p>Sounds like your overlay is messed up. Re-flash without keeping config.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p283501">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">eduperez</div>
					<div class="post-datetime">
						14 Jul 2015, 11:48					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>danab11 wrote:</cite><blockquote><p>Strangely, I cannot see dnsmasq available. Not even a configuration file.</p></blockquote></div><p>That is very strange! If you do not have a DNS running on your router, this is not going to work.</p><div class="quotebox"><cite>danab11 wrote:</cite><blockquote><p>The Windows network connection interface shows it inherited the DNS from the router.</p></blockquote></div><p>Do you mean the DNS in the Windows computers is the IP address of the router, or that it is the same IP address as configured on the router?</p><div class="quotebox"><cite>danab11 wrote:</cite><blockquote><p>When I cd into etc and list all dirs, I dont see the config directory.</p></blockquote></div><p>That is pretty serious... it is strange that your router works at all.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>