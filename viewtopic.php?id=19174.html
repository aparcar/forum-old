<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> SAMBA will not stay up</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 30 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p83079">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">rian</div>
					<div class="post-datetime">
						3 Mar 2009, 08:55					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m running 8.09 with samba3.<br />I have a very simple smb.conf pointing to a mostly empty directory.<br />Connecting with smbclient from another machine authenticates OK, and ls the share returns<br />the contents of the directory, followed by</p><p>&nbsp; Receiving SMB: Server stopped responding <br />&nbsp; Error in dskattr: Call returned zero bytes (EOF)</p><p>The main smbd process is still running, but it appears the handling thread crashed badly. From dmesg</p><p>Process smbd (pid: 2095, threadinfo=81d80000, task=81c3d918)<br />Stack : 00000000 81808aa8 00000000 00000000 816d2324 81d81e10 8007bec8 8155b200<br />&nbsp; &nbsp; &nbsp; &nbsp; 00001fb6 00000001 80ae2000 800645e0 816d2704 81d81e10 8007bec8 800862dc<br />&nbsp; &nbsp; &nbsp; &nbsp; 7fca95e0 00000001 00000000 81d81ecc 81d81e88 7fca8a50 8007c170 00000000<br />&nbsp; &nbsp; &nbsp; &nbsp; 00000001 81d067b8 81c0cea0 816d2704 00000000 00000000 00000000 00000000<br />&nbsp; &nbsp; &nbsp; &nbsp; 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000<br />&nbsp; &nbsp; &nbsp; &nbsp; ...<br />Call Trace:[&lt;8007bec8&gt;][&lt;800645e0&gt;][&lt;8007bec8&gt;][&lt;800862dc&gt;][&lt;8007c170&gt;][&lt;8007c34c&gt;][&lt;80012c3c&gt;][&lt;8003af48&gt;][&lt;80081418&gt;][&lt;8007d880&gt;][&lt;8000b130&gt;]</p><p>Code: afb00010&nbsp; 8c820008&nbsp; 00a08821 &lt;8c42008c&gt; 8c500154&nbsp; 3c027371&nbsp; 34427368&nbsp; aca20000&nbsp; 8a060036 </p><p>The smbd.log file is empty - as it always is.</p><p>smb.conf :</p><p>[global]<br /> netbios name = possum<br /> syslog = 0<br /> syslog only = no<br /> workgroup = test<br /> security = user<br /> encrypt passwords = yes<br /> guest account = nobody<br /> local master = yes<br /> name resolve order = lmhosts hosts bcast</p><p>[freeagent]<br /> comment = Main disk<br /> path = /mnt/freeagent<br /> browseable = yes<br /> public = no<br /> writeable = no<br /> valid users = me</p><p>Running on a ASUS-WL500W, openwrt-brcm47xx-squashfs.trx, 2.6 kernel (given up on the wifi for now) CPU Broadcom BCM47XX (BCM3302). The path will one day be the mountpoint for a disk, but at the moment it is just a directory with one file in it for testing. Crash also happens with security=share.</p><p>Does anyone have samba3 stable on a similar platform?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p83081">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">rian</div>
					<div class="post-datetime">
						3 Mar 2009, 09:37					</div>
				</div>
				<div class="post-content content">
					<p>Little bit more information.<br />Samba2 crashes the same way.<br />With crazy use of grabbing child processes with strace, it appears to be crashing in the system call <strong>statfs</strong></p><p>My test file of place.holder caused</p><p>statfs(&quot;./place.holder&quot;,&nbsp; &lt;unfinished ...&gt;<br />+++ killed by SIGSEGV +++</p><p>I&#039;m thinking this might be something bigger than samba...</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>