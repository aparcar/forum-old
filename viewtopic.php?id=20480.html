<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> current limits using ath9k driver...tranfert rate, options, help</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 29 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p88806">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">desigabri</div>
					<div class="post-datetime">
						27 May 2009, 03:09					</div>
				</div>
				<div class="post-content content">
					<p>hi all<br />I create this topics because I&#039;m engaged about having ath9k driver working onto OpenWRT.</p><p>I lived a big part of my time in the last 2 months trying setting up a router with 11n capabilities and after some time needed for choising and then for buying the card I believed I would became a lucky owner of a hight speed wireless router... I believed it!!!<br />Ok, it is in developement but I had hard time looking for the right options for setting it up, Hard time understanding where&nbsp; I could set it and so on.<br />In particular I setted up a BCM6358 AGPF-S0 (Alice Gate) router with a Atheros Ar5416 miniPCI card and OpenWRT_luci.<br />Finally I can connect to it at 300Mbps, 130Mbs, 54Mbps BUT the max transfert rate speed is limited up to 200Kbps. It is a very poor result and My only hopeness is that there are some options to pass to the kernel or to set in any configuration file to have it working faster.</p><p>Is there anyone having some skills about ath9k driver that can write down here or link here any interesting information?</p><p>I can start passing my little skills about it that I wasn&#039;t able to find anywhere.</p><br /><p>#################################################################################<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UPDATED<br />#################################################################################</p><p>1) To pass 11n mode to the router you need to add this line to &quot;/etc/config/wireless&quot; file<br />&quot;option &#039;hwmode_11n&#039; &#039;g&#039; &quot;<br />or<br />&quot;option &#039;hwmode_11n&#039; &#039;a&#039; &quot;</p><br /><p>you haven&#039;t to pass:&nbsp; option &#039;hwmode&#039; &#039;n&#039; that you will find everywhere searching information on the web and forums&nbsp; because it doesn&#039;t work.<br />Option &#039;hwmode_11n&quot; simpli means to tells to apply 11n mode onto a &quot;g&quot; card or onto an &quot;a&quot; card. I really don&#039;t know if it works using value &quot;ag&quot; or &quot;ga&quot; too for 11bgan cards. If you know it, please add here you knowledge.</p><p>ieee80211n=1 will be setted automatically by the firmware if you will use the option &#039;hwmode_11n&#039;, so there isn&#039;t the need of setting it as you read surfing the net and forums.</p><p>2) After that You need only to chose ed add the capabilities of your card and you&#039;ll have the card setted up in 11n mode.</p><p>So always into the &quot;/etc/config/wireless&quot; file you should add something like this but refered about the capabilities supported by your hardware:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ht_capab&#039; &#039;[SHORT-GI-40][DSSS_CCK-40][HT40-][HT40+][HT20]&#039;<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp;#other options to try alone or mixed togheter<br />&nbsp; &nbsp; &nbsp; &nbsp;#option &#039;ht_capab&#039; &#039;[HT40+][HT40-][HT20][HT-GI-40][HT-GI-20]&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp;#option &#039;ht_capab&#039; &#039;[TX-STBC]&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp;#option &#039;ht_capab&#039; &#039;[RX-STBC12]&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp;#option &#039;ht_capab&#039; &#039;[DELAYED-BA]&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp;#option &#039;ht_capab&#039; &#039;[RX-STBC123]&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp;#option &#039;ht_capab&#039; &#039;[SHORT-GI-40]&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp;#option &#039;ht_capab&#039; &#039;[DSSS_CCK-40]&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp;#option &#039;ht_capab&#039; &#039;[HT40-]&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp;#option &#039;ht_capab&#039; &#039;[HT40+]&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp;#option &#039;ht_capab&#039; &#039;[SHORT-GI-20]&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp;#option &#039;ht_capab&#039; &#039;[HT20]&#039;</p><br /><p>You can find the capabilities of you card using the command: &quot;iw list&quot; at the command line prompt (via Terminal) but I&#039;m not able to know exactly which are the right options. For example I get: HT40 cabable and others but who tells me how to pass HT40 option to the firmware? does it should be [HT40+] and [HT40-]? Where can I find a full list of working OPTIONS?</p><p>for example I get this iw list OUTPUT:<br />/$ iw list<br />Wiphy phy0<br />&nbsp; &nbsp; Band 1:<br />&nbsp; &nbsp; &nbsp; &nbsp; HT capabilities: 0x104e<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 20/40 MHz operation<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * SM PS disabled<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 40 MHz short GI<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * max A-MSDU len 3839<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * DSSS/CCK 40 MHz<br />&nbsp; &nbsp; &nbsp; &nbsp; HT A-MPDU factor: 0x0003 (65535 bytes)<br />&nbsp; &nbsp; &nbsp; &nbsp; HT A-MPDU density: 0x0006 (8 usec)<br />&nbsp; &nbsp; &nbsp; &nbsp; HT MCS set: ff ff 00 00 00 00 00 00 00 00 00 00 01 00 00 00<br />&nbsp; &nbsp; &nbsp; &nbsp; HT TX/RX MCS rate indexes supported:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MCS index 0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MCS index 1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MCS index 2<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MCS index 3<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MCS index 4<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MCS index 5<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MCS index 6<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MCS index 7<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MCS index 8<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MCS index 9<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MCS index 10<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MCS index 11<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MCS index 12<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MCS index 13<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MCS index 14<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MCS index 15<br />&nbsp; &nbsp; &nbsp; &nbsp; Frequencies:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 2412 MHz [1] (20.0 dBm)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 2417 MHz [2] (20.0 dBm)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 2422 MHz [3] (20.0 dBm)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 2427 MHz [4] (20.0 dBm)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 2432 MHz [5] (20.0 dBm)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 2437 MHz [6] (20.0 dBm)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 2442 MHz [7] (20.0 dBm)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 2447 MHz [8] (20.0 dBm)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 2452 MHz [9] (20.0 dBm)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 2457 MHz [10] (20.0 dBm)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 2462 MHz [11] (20.0 dBm)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 2467 MHz [12] (disabled)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 2472 MHz [13] (disabled)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 2484 MHz [14] (disabled)<br />&nbsp; &nbsp; &nbsp; &nbsp; Bitrates:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 1.0 Mbps<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 2.0 Mbps (short preamble supported)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 5.5 Mbps (short preamble supported)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 11.0 Mbps (short preamble supported)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 6.0 Mbps<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 9.0 Mbps<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 12.0 Mbps<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 18.0 Mbps<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 24.0 Mbps<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 36.0 Mbps<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 48.0 Mbps<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 54.0 Mbps<br />&nbsp; &nbsp; max # scan SSIDs: 4<br />&nbsp; &nbsp; Supported interface modes:<br />&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * IBSS<br />&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * managed<br />&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * AP<br />&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * AP/VLAN<br />&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * monitor<br />&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * mesh point</p><p>WHO KNOWS WHICH OPTIONS CORRISPOND TO THESE CAPABILITIES? <br />COULD the &quot;HT TX/RX MCS rate indexes supported&quot; influences the tranfert rate speed? (remember that I can get up to 200kbps only), and if yes then which is the [???????] option to use for setting it?</p><p>so you need the:</p><p>3) iw package</p><p>installed into your system and:</p><p>4) hostapd_full package</p><p>you will read options succesfully setted reading /var/run/hostapd-wlan0.conf file&nbsp; (about wlan0)</p><p>--------------------------------------------------------------------------------------------------------------------------------------------------------<br />28-05-2009:</p><p>Thanks to thalience and linuxb, we know that there are some issues onto ath9k driver. Those issues are known as it is known the solution:</p><p>If you use the last sources from ath9k trunk, then you&#039;ll have the driver working. If you are using the openwrt trunk, then you&#039;ll NOT have the driver working well until the ath9k of openwrt trunk will be updated.</p><p>FOR openwrt users using TRUNK thanks to &quot;linuxb&quot;:</p><p>the ath9k 404 patch:<br /><a href="http://www.4shared.com/file/108392866/6">http://www.4shared.com/file/108392866/6</a> … 4-wmm.html<br />The patch goes in: trunk/package/mac80211/patches/&nbsp; &nbsp;</p><p>the hostapd.sh modification: <br />Then edit the trunk/package/hostapd/files/hostapd.sh<br />include this into that file, you can put these lines in between debug=0 and wpa=$wpa</p><p>tx_queue_data3_aifs=7<br />tx_queue_data3_cwmin=15<br />tx_queue_data3_cwmax=1023<br />tx_queue_data3_burst=0<br />tx_queue_data2_aifs=3<br />tx_queue_data2_cwmin=15<br />tx_queue_data2_cwmax=63<br />tx_queue_data2_burst=0<br />tx_queue_data1_aifs=1<br />tx_queue_data1_cwmin=7<br />tx_queue_data1_cwmax=15<br />tx_queue_data1_burst=3.0<br />tx_queue_data0_aifs=1<br />tx_queue_data0_cwmin=3<br />tx_queue_data0_cwmax=7<br />tx_queue_data0_burst=1.5<br />wme_enabled=1<br />wme_ac_bk_cwmin=4<br />wme_ac_bk_cwmax=10<br />wme_ac_bk_aifs=7<br />wme_ac_bk_txop_limit=0<br />wme_ac_bk_acm=0<br />wme_ac_be_aifs=3<br />wme_ac_be_cwmin=4<br />wme_ac_be_cwmax=10<br />wme_ac_be_txop_limit=0<br />wme_ac_be_acm=0<br />wme_ac_vi_aifs=2<br />wme_ac_vi_cwmin=3<br />wme_ac_vi_cwmax=4<br />wme_ac_vi_txop_limit=94<br />wme_ac_vi_acm=0<br />wme_ac_vo_aifs=2<br />wme_ac_vo_cwmin=2<br />wme_ac_vo_cwmax=3<br />wme_ac_vo_txop_limit=47<br />wme_ac_vo_acm=0</p><br /><p>Now compile and try it.</p><p>FOR openwrt users thanks to &quot;thalience&quot;:</p><p>(it doesn&#039;t work for me olso if it seems to be the same patch reported by linuxb because the patch is made for GIT and I&#039;m using SVN; and then he wrote about editing the hostapd.conf file that I can&#039;t find anywhere in my openwrt installation so I can&#039;t do the modification).<br />I don&#039;t report the thalience suggestions again, because you&#039;ll find them at the next post so you can read it easily.</p><br /><p>03-06-2009<br />starting from 16301 trunk version there should be no problems working with ath9k driver;</p><p>1) there is no need of editing mac80211.sh (in the sources files for automatically setting up the options:</p><p>&nbsp; &nbsp;option &#039;hwmode_11n&#039; &#039;g&#039; <br />&nbsp; &nbsp;option &#039;ht_capab&#039; &#039;[SHORT-GI-40][DSSS_CCK-40][HT40-][HT40+][HT20]&#039;</p><p>&nbsp; (or anyother different value option) into the wireless config file.</p><p>2) there is no need to apply the 404 patch because it has already been patched into the new driver;</p><p>3) the hostapd.sh modification (trunk/package/hostapd/files/hostapd.sh) may not to be necesarly. You should test with or without and anyway it sholud be important to know what these options do and what we can change about them</p><p>6-06-2009<br />I found these two links with explanations about use of hostapd.conf options in order to modify the mac80211.sh source file for&nbsp; first working wireless config after the flash.</p><p><a href="http://hostap.epitest.fi/gitweb/gitweb.cgi?p=hostap-06.git;a=blob_plain;f=hostapd/hostapd.conf;hb=HEAD">http://hostap.epitest.fi/gitweb/gitweb. … nf;hb=HEAD</a><br /><a href="http://hostap.epitest.fi/gitweb/gitweb.cgi?p=hostap.git;a=blob_plain;f=hostapd/hostapd.conf">http://hostap.epitest.fi/gitweb/gitweb. … stapd.conf</a><br />##################################################################################<br />##################################################################################</p><p>PLEASE IF YOU KNOW SOMETHING MORE OR SOMETHING BETTER PLEASE HELP ME/US WRITING ABOUT IT HERE (I will try to keep updated the main POST).</p>											<p class="post-edited">(Last edited by <strong>desigabri</strong> on 6 Jun 2009, 18:45)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p88920">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">thalience</div>
					<div class="post-datetime">
						28 May 2009, 22:00					</div>
				</div>
				<div class="post-content content">
					<p>It would help if you could post a little more information about your testing setup. I&#039;m assuming that you are testing wifi performance (and not routing between wired ports). Are you testing throughput from AP to Station, from Station to AP, or both?</p><p>Are you building trunk, using a snapshot, using 8.09, or what?</p><p>That said, I noticed a discussion on the ath9k mailing list about a recently-introduced bug that would really hurt AP -&gt; Station transfers. It is present in trunk, and probably recent snapshots as well.</p><p>Fortunately, this bug can be worked around without recompiling (by putting settings into hostapd.conf):<br /><a href="http://osdir.com/ml/linux-wireless/2009-05/msg01156.html">http://osdir.com/ml/linux-wireless/2009 … 01156.html</a></p><p>And here is the patch to fix the bug, if you want to just build a fixed version:<br /><a href="http://osdir.com/ml/linux-wireless/2009-05/msg01189.html">http://osdir.com/ml/linux-wireless/2009 … 01189.html</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p88921">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">linuxb</div>
					<div class="post-datetime">
						28 May 2009, 22:12					</div>
				</div>
				<div class="post-content content">
					<p>Hi.<br />Im not an expert on ath9k,Openwrt og Linux, but as you I have tried to get it working lately (this is on a x86 with an mini-pci AR5416). </p><p>1)<br />I could not get option &#039;hwmode_11n&#039;to work before I saw your post, but it works now, thanks.<br />I dont think it works with &#039;ag&#039; or &#039;ga&#039;, but I dont think it matters, if you leave out hwmode_11n, you wont get HT speed,&nbsp; and just use the channel number to determine a or g.</p><p>2)<br />Here is a link to hostapd.conf sample file, (git). Its some explanation there: <br /><a href="http://hostap.epitest.fi/gitweb/gitweb.cgi?p=hostap-06.git;a=blob_plain;f=hostapd/hostapd.conf;hb=HEAD">http://hostap.epitest.fi/gitweb/gitweb. … nf;hb=HEAD</a></p><p>Basically HT40 means that you will use 2 channels, a primary and a secondary channel. The primary channel is the channel you specify in your config.<br />HT40+ means that the secondary will be 40MHz above the primary channel.<br />Your iw list shows that you can use channel 1 to 11. That means that the highest HT40+ channel you can use is channel 7(1 to 7), since the secondary channel will be 11. Therefore Channel 8 would not work with HT40+, because the secondary channel would have been 12, and iw list shows that channel aint available.</p><p>From hostapd.conf:<br />#&nbsp; &nbsp; freq&nbsp; &nbsp; &nbsp; &nbsp; HT40-&nbsp; &nbsp; &nbsp; &nbsp; HT40+<br />#&nbsp; &nbsp; 2.4 GHz&nbsp; &nbsp; &nbsp; &nbsp; 5-13&nbsp; &nbsp; &nbsp; &nbsp; 1-7 (1-9 in Europe/Japan)<br />#&nbsp; &nbsp; 5 GHz&nbsp; &nbsp; &nbsp; &nbsp; 40,48,56,64&nbsp; &nbsp; 36,44,52,60</p><p>For your iw list, try this settings:</p><p>option &#039;ht_capab&#039; &#039;[HT40-] or(only one of them) [HT40+] [SHORT-GI-40][DSSS_CCK-40]&#039;</p><p>I dont know it is an option for setting the&nbsp; HT TX/RX MCS rates, maybe via iw?, but there is no need the driver selects the rates automatically.</p><p>I think I have read on this forum about high cpu usage on routers with ath9k,&nbsp; therfore some speed issues, but I dont know since im on x86.</p><p>Try this setting and I think you should see some improvements:</p><p>Set your wireless to channel 11&nbsp; &nbsp;(for example)<br />add this to /etc/config/wireless </p><p>option &#039;hwmode_11n&#039; &#039;g&#039;<br />option &#039;ht_capab&#039; &#039;[HT40-][SHORT-GI-40][DSSS_CCK-40]&#039;</p><br /><p>If you are building openwrt from trunk use this patch to sort out a typo in a patch to wireless-testing git some weeks ago.<br />(you probably dont need it when next compat wireless comes)</p><p><a href="http://www.4shared.com/file/108392866/60d6716b/404-wmm.html">http://www.4shared.com/file/108392866/6 … 4-wmm.html</a> <br />The patch goes in: trunk/package/mac80211/patches/&nbsp; &nbsp;</p><p>Then edit the trunk/package/hostapd/files/hostapd.sh <br />include this into that file, you can put these lines in between debug=0 and wpa=$wpa</p><p>tx_queue_data3_aifs=7<br />tx_queue_data3_cwmin=15<br />tx_queue_data3_cwmax=1023<br />tx_queue_data3_burst=0<br />tx_queue_data2_aifs=3<br />tx_queue_data2_cwmin=15<br />tx_queue_data2_cwmax=63<br />tx_queue_data2_burst=0<br />tx_queue_data1_aifs=1<br />tx_queue_data1_cwmin=7<br />tx_queue_data1_cwmax=15<br />tx_queue_data1_burst=3.0<br />tx_queue_data0_aifs=1<br />tx_queue_data0_cwmin=3<br />tx_queue_data0_cwmax=7<br />tx_queue_data0_burst=1.5<br />wme_enabled=1<br />wme_ac_bk_cwmin=4<br />wme_ac_bk_cwmax=10<br />wme_ac_bk_aifs=7<br />wme_ac_bk_txop_limit=0<br />wme_ac_bk_acm=0<br />wme_ac_be_aifs=3<br />wme_ac_be_cwmin=4<br />wme_ac_be_cwmax=10<br />wme_ac_be_txop_limit=0<br />wme_ac_be_acm=0<br />wme_ac_vi_aifs=2<br />wme_ac_vi_cwmin=3<br />wme_ac_vi_cwmax=4<br />wme_ac_vi_txop_limit=94<br />wme_ac_vi_acm=0<br />wme_ac_vo_aifs=2<br />wme_ac_vo_cwmin=2<br />wme_ac_vo_cwmax=3<br />wme_ac_vo_txop_limit=47<br />wme_ac_vo_acm=0</p><br /><p>Now compile and try it.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p88942">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">desigabri</div>
					<div class="post-datetime">
						29 May 2009, 11:50					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>thalience wrote:</cite><blockquote><p>It would help if you could post a little more information about your testing setup. I&#039;m assuming that you are testing wifi performance (and not routing between wired ports). Are you testing throughput from AP to Station, from Station to AP, or both?</p><p>Are you building trunk, using a snapshot, using 8.09, or what?</p><p>That said, I noticed a discussion on the ath9k mailing list about a recently-introduced bug that would really hurt AP -&gt; Station transfers. It is present in trunk, and probably recent snapshots as well.</p><p>Fortunately, this bug can be worked around without recompiling (by putting settings into hostapd.conf):<br /><a href="http://osdir.com/ml/linux-wireless/2009-05/msg01156.html">http://osdir.com/ml/linux-wireless/2009 … 01156.html</a></p><p>And here is the patch to fix the bug, if you want to just build a fixed version:<br /><a href="http://osdir.com/ml/linux-wireless/2009-05/msg01189.html">http://osdir.com/ml/linux-wireless/2009 … 01189.html</a></p></blockquote></div><p>hi, thalience, thanks for your help</p><p>I&#039;m trying the wireless transfer rate speed using the router as AP, my notebook as client and having the LAN of the AP connected directly to to the Internet. I could say that my notebook is in the same intranet of wired clients. wireless and LAN are bridged without any firewall, NAT or other rules.<br />at the client side I use both XP and Linux with a miniPCI card and a pcmcia cards.<br />The AP is using the same miniPCI card of the AP</p>											<p class="post-edited">(Last edited by <strong>desigabri</strong> on 29 May 2009, 11:50)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p88953">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">thalience</div>
					<div class="post-datetime">
						29 May 2009, 17:07					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>desigabri wrote:</cite><blockquote><p>hi, thalience, thanks for your help</p><p>I&#039;m trying the wireless transfer rate speed using the router as AP, my notebook as client and having the LAN of the AP connected directly to to the Internet. I could say that my notebook is in the same intranet of wired clients. wireless and LAN are bridged without any firewall, NAT or other rules.<br />at the client side I use both XP and Linux with a miniPCI card and a pcmcia cards.<br />The AP is using the same miniPCI card of the AP</p></blockquote></div><p>Glad to help!</p><p>I just did some testing with trunk (modified to use kernel 2.6.30-rc7) on an AP81-based router (mips cpu, atheros 3x3 wifi on AHB bus).</p><p>I streamed data from the router to a wifi client station (laptop with ipw2200 wifi, which is a G part, no N support). </p><p>Without the fix I described, the transfer was slow overall (about 250KBps) and bursty.</p><p>By editing /lib/wifi/hostapd.sh on the router to include the lines suggested by linuxb, I was able to get around 1.5MBps (the practical limit for the G card in my laptop).</p><p>Transfer rates were measured using GKrellm&#039;s network monitor on the laptop, so they are very approximate.</p><p>I did no testing of the laptop -&gt; router transfers.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p89055">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">desigabri</div>
					<div class="post-datetime">
						1 Jun 2009, 02:18					</div>
				</div>
				<div class="post-content content">
					<p>hi,<br />I&#039;m writing only to report some results<br />my test aren&#039;t made with professional systems so results change I thing for varius environment condition:</p><br /><p>In particular it seems to me that </p><p>options [HT40-] [HT40+][HT40-GI-40] get similar results.<br />I had better results using a Linux FTP server vs a Windows XP ftp server.<br />Better results using a Linux FTP client vs a Windows FTP client...</p><p>all two client side wireless card got similar tranfer rate speeds no matter the link speed.</p><p>at 54mbps all two cards got about 2,8MB/s tranfer rate Speed&nbsp; (about 23Mbps for the same notebook, spatial position so for Linux as for XP in client side or server side)</p><p>at 11n&nbsp; (no matter for linking at 108-130-216-243-270-300Mbps ) the tranfer rates were about:</p><p>TP-LINK TL-WN861N (miniPCI):<br />4,2MB/S for Server XP client XP&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;---&gt; about 33Mbps<br />5,2MB/s for Server Linux client XP&nbsp; &nbsp; &nbsp; &nbsp; ---&gt; about 42Mbps<br />5,8MB/s for Server Linux client Linux&nbsp; &nbsp; ---&gt; about 47Mbps</p><p>NETGEAR WN511B (pcmcia):<br />3,2MB/S for Server XP client XP&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;---&gt; about 25Mbps<br />4,8MB/s for Server Linux client XP&nbsp; &nbsp; &nbsp; &nbsp; ---&gt; about 38Mbps</p><p>NETGEAR WN511B (pcmcia) mounted onto another notebook:<br />6,2MB/s for Server Linux client XP&nbsp; &nbsp; &nbsp; &nbsp; ---&gt; about 50Mbps</p><p>The problem was that I got different results testing at different times. I think that environment situation (other wireless network working) condizionated the results.<br />So these are the results I was able to get as maximum rates. NOT VERY HIGH I THINK...but I think too that there were problems relates to the CPU utilization of the server and the client.<br />The server was connected to the LAN via ethernet and the client connected via WIFI. No firewall.<br />Server side with LOW CPU utilization, Client side with CPU utilizzation among 75%-80% during the tranfer</p>											<p class="post-edited">(Last edited by <strong>desigabri</strong> on 3 Jun 2009, 04:04)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p89163">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">tusc</div>
					<div class="post-datetime">
						2 Jun 2009, 22:55					</div>
				</div>
				<div class="post-content content">
					<p>Wow,</p><p>I saw a BIG jump in rates after today&#039;s latest svn update.</p><p>This must be what made the difference: <a href="https://dev.openwrt.org/changeset/16300">https://dev.openwrt.org/changeset/16300</a> (Updates to compat-wireless-2009-06-02)</p><p>I presume it has to do with one of the ath9k updates from yesterday:</p><p><a href="http://git.kernel.org/?p=linux/kernel/git/linville/wireless-testing.git;a=log;h=master-2009-06-01">http://git.kernel.org/?p=linux/kernel/g … 2009-06-01</a></p><p>From my laptop running Vista w/ an Intel 3945abg chipset to the AP (Planex MZK-W04NU) I&#039;m getting about 18Mbps.</p>											<p class="post-edited">(Last edited by <strong>tusc</strong> on 2 Jun 2009, 23:48)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p89195">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">desigabri</div>
					<div class="post-datetime">
						3 Jun 2009, 13:00					</div>
				</div>
				<div class="post-content content">
					<p>hi,<br />18Mbps is less then the tranfert speed of a wireless G (22-24Mbps)<br />but If you got this tranfer rate without any other modification, it sounds very good!</p><p>I compiled and flashed the 16301 trunk version (with&nbsp; today in the morning but I haven&#039;t had time to test it. I&#039;ll do it tonight and after that I&#039;ll report it.</p><p>thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p89281">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">desigabri</div>
					<div class="post-datetime">
						4 Jun 2009, 12:15					</div>
				</div>
				<div class="post-content content">
					<p><img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" />(<br />yes, you are right about new drivers. With trunk version 16309 they work without modification of config files but they are poor in tranfer rate:</p><p>I got 1,9-2,2 MB/s&nbsp; ----&gt; about 16-18Mbps so for the TP-Link WN861N client as for Netgear WN511B client connected to my router. This is less then what you can get by a 54Mbps Link speed connection.</p><p>Anyway this is very better then previus results: 200kB ---&gt; about 1,6Mbps......</p><p>Anyone knows anything about working settings to apply for new driver? It seemed to me NOT to be so fast as the previus using the same settings modifications.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p89338">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">linuxb</div>
					<div class="post-datetime">
						5 Jun 2009, 02:37					</div>
				</div>
				<div class="post-content content">
					<p>Im seeing pretty good wifi speed on my x86 AP. (an old Aopen XCcube with Pentium M 1.7Ghz and 512MB ram)<br />My client is an Lenovo 3000 N200 with vista sp1, with an Atheros AR5418 wifi. My cards are dualband, this test is on A. (channel 40)&nbsp; <br />This is from todays trunk: (my laptop was pretty close to the AP 4-5 feet)</p><p>login as: root<br />root@192.168.0.9&#039;s password:</p><br /><p>BusyBox v1.13.4 (2009-06-04 12:09:03 CEST) built-in shell (ash)<br />Enter &#039;help&#039; for a list of built-in commands.</p><p>&nbsp; _______&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;________&nbsp; &nbsp; &nbsp; &nbsp; __<br /> |&nbsp; &nbsp; &nbsp; &nbsp;|.-----.-----.-----.|&nbsp; |&nbsp; |&nbsp; |.----.|&nbsp; |_<br /> |&nbsp; &nbsp;-&nbsp; &nbsp;||&nbsp; _&nbsp; |&nbsp; -__|&nbsp; &nbsp; &nbsp;||&nbsp; |&nbsp; |&nbsp; ||&nbsp; &nbsp;_||&nbsp; &nbsp;_|<br /> |_______||&nbsp; &nbsp;__|_____|__|__||________||__|&nbsp; |____|<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |__| W I R E L E S S&nbsp; &nbsp;F R E E D O M<br /> KAMIKAZE (bleeding edge, r16342) -------------------<br />&nbsp; * 10 oz Vodka&nbsp; &nbsp; &nbsp; &nbsp;Shake well with ice and strain<br />&nbsp; * 10 oz Triple sec&nbsp; mixture into 10 shot glasses.<br />&nbsp; * 10 oz lime juice&nbsp; Salute!<br /> ---------------------------------------------------<br />root@OpenWrt:~# iperf -c 192.168.0.10 -i10 -t60 -w80k<br />------------------------------------------------------------<br />Client connecting to 192.168.0.10, TCP port 5001<br />TCP window size:&nbsp; &nbsp;160 KByte (WARNING: requested 80.0 KByte)<br />------------------------------------------------------------<br />[&nbsp; 3] local 192.168.0.9 port 47331 connected with 192.168.0.10 port 5001<br />[ ID] Interval&nbsp; &nbsp; &nbsp; &nbsp;Transfer&nbsp; &nbsp; &nbsp;Bandwidth<br />[&nbsp; 3]&nbsp; 0.0-10.0 sec&nbsp; &nbsp; 156 MBytes&nbsp; &nbsp; 131 Mbits/sec<br />[ ID] Interval&nbsp; &nbsp; &nbsp; &nbsp;Transfer&nbsp; &nbsp; &nbsp;Bandwidth<br />[&nbsp; 3] 10.0-20.0 sec&nbsp; &nbsp; 157 MBytes&nbsp; &nbsp; 132 Mbits/sec<br />[ ID] Interval&nbsp; &nbsp; &nbsp; &nbsp;Transfer&nbsp; &nbsp; &nbsp;Bandwidth<br />[&nbsp; 3] 20.0-30.0 sec&nbsp; &nbsp; 158 MBytes&nbsp; &nbsp; 133 Mbits/sec<br />[ ID] Interval&nbsp; &nbsp; &nbsp; &nbsp;Transfer&nbsp; &nbsp; &nbsp;Bandwidth<br />[&nbsp; 3] 30.0-40.0 sec&nbsp; &nbsp; 158 MBytes&nbsp; &nbsp; 133 Mbits/sec<br />[ ID] Interval&nbsp; &nbsp; &nbsp; &nbsp;Transfer&nbsp; &nbsp; &nbsp;Bandwidth<br />[&nbsp; 3] 40.0-50.0 sec&nbsp; &nbsp; 158 MBytes&nbsp; &nbsp; 132 Mbits/sec<br />[ ID] Interval&nbsp; &nbsp; &nbsp; &nbsp;Transfer&nbsp; &nbsp; &nbsp;Bandwidth<br />[&nbsp; 3] 50.0-60.0 sec&nbsp; &nbsp; 159 MBytes&nbsp; &nbsp; 133 Mbits/sec<br />[ ID] Interval&nbsp; &nbsp; &nbsp; &nbsp;Transfer&nbsp; &nbsp; &nbsp;Bandwidth<br />[&nbsp; 3]&nbsp; 0.0-60.0 sec&nbsp; &nbsp; 946 MBytes&nbsp; &nbsp; 132 Mbits/sec<br />root@OpenWrt:~# iperf -s -w80k<br />------------------------------------------------------------<br />Server listening on TCP port 5001<br />TCP window size:&nbsp; &nbsp;160 KByte (WARNING: requested 80.0 KByte)<br />------------------------------------------------------------<br />[&nbsp; 4] local 192.168.0.9 port 5001 connected with 192.168.0.10 port 49208<br />[ ID] Interval&nbsp; &nbsp; &nbsp; &nbsp;Transfer&nbsp; &nbsp; &nbsp;Bandwidth<br />[&nbsp; 4]&nbsp; 0.0-60.0 sec&nbsp; &nbsp; 709 MBytes&nbsp; 99.1 Mbits/sec<br />^Croot@OpenWrt:~#</p>											<p class="post-edited">(Last edited by <strong>linuxb</strong> on 5 Jun 2009, 02:38)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p89441">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">desigabri</div>
					<div class="post-datetime">
						6 Jun 2009, 18:57					</div>
				</div>
				<div class="post-content content">
					<p>hi,<br />I forgot to say that my clients are about 5mt (15fts) far from the AP and that there is a cement wall between them.</p><p>I found these two links with explanations about use of hostapd.conf options in order to modify the mac80211.sh source file for&nbsp; first working wireless config after the flash.</p><p><a href="http://hostap.epitest.fi/gitweb/gitweb.cgi?p=hostap-06.git;a=blob_plain;f=hostapd/hostapd.conf;hb=HEAD">http://hostap.epitest.fi/gitweb/gitweb. … nf;hb=HEAD</a><br /><a href="http://hostap.epitest.fi/gitweb/gitweb.cgi?p=hostap.git;a=blob_plain;f=hostapd/hostapd.conf">http://hostap.epitest.fi/gitweb/gitweb. … stapd.conf</a></p>											<p class="post-edited">(Last edited by <strong>desigabri</strong> on 6 Jun 2009, 21:49)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p90556">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">thorstenk</div>
					<div class="post-datetime">
						29 Jun 2009, 00:31					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I have the problem, that when i add the hwmode_11n option&nbsp; to the wireless config file, my card does not work anymore as an AP, do you know this problem and a solution for it??</p><p>Thx,</p><p>Thorsten</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p90558">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">linuxb</div>
					<div class="post-datetime">
						29 Jun 2009, 01:26					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>thorstenk wrote:</cite><blockquote><p>Hi,</p><p>I have the problem, that when i add the hwmode_11n option&nbsp; to the wireless config file, my card does not work anymore as an AP, do you know this problem and a solution for it??</p><p>Thx,</p><p>Thorsten</p></blockquote></div><p>I dont know what causes that problem. What channel/hwmode are you trying to use, and whats the ouput from iw list?<br />Im just thinking it could be because your trying to use hw_mode with channels that your cards regdomain dont allow.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p90559">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">thorstenk</div>
					<div class="post-datetime">
						29 Jun 2009, 01:30					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>it works now, I had to set the encryption from psk to psk2.<br />However there is no increase in speed :-(. I have still around 20Mbit/sec!<br />Before using &quot;option hwmode_11n g&quot; it was not realy slower ...<br />Any other tips for increasing the speed?</p><br /><p>Thorsten</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p95744">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">foxtroop11</div>
					<div class="post-datetime">
						12 Oct 2009, 03:39					</div>
				</div>
				<div class="post-content content">
					<p>This has been a great help, however should the output as seen on Windows actually say N? I put a R52N card in my windows machine with drivers and it says G, have no idea if it&#039;s my laptop or the router that is incorrect.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p95778">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">linuxb</div>
					<div class="post-datetime">
						12 Oct 2009, 23:14					</div>
				</div>
				<div class="post-content content">
					<p>Yes vista should list your network as N after scanning. And you should connect at 300mbps.<br />If it say G, then you probably only can connect at 54mbps. <br />It could be your hostapd settings. Is you firmware from trunk, what revision? </p><p>Can you post your hostapd.conf: cat /var/run/hostapd-wlan0.conf</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p95876">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">linuxb</div>
					<div class="post-datetime">
						14 Oct 2009, 13:54					</div>
				</div>
				<div class="post-content content">
					<p>Ok. I asked for revision because it seems that the option &#039;hw_mode&#039; has slightly changed in trunk. </p><p>To get &#039;N&#039; you could try to apply the wme parameters in hostapd conf. So I suggest you paste this in to your /lib/wifi/hostapd.conf file (on your router), you could paste it after the $hostapd_cfg (before the EOF):</p><div class="codebox"><pre><code>tx_queue_data3_aifs=7
tx_queue_data3_cwmin=15
tx_queue_data3_cwmax=1023
tx_queue_data3_burst=0
tx_queue_data2_aifs=3
tx_queue_data2_cwmin=15
tx_queue_data2_cwmax=63
tx_queue_data2_burst=0
tx_queue_data1_aifs=1
tx_queue_data1_cwmin=7
tx_queue_data1_cwmax=15
tx_queue_data1_burst=3.0
tx_queue_data0_aifs=1
tx_queue_data0_cwmin=3
tx_queue_data0_cwmax=7
tx_queue_data0_burst=1.5
wme_enabled=1
wme_ac_bk_cwmin=4
wme_ac_bk_cwmax=10
wme_ac_bk_aifs=7
wme_ac_bk_txop_limit=0
wme_ac_bk_acm=0
wme_ac_be_aifs=3
wme_ac_be_cwmin=4
wme_ac_be_cwmax=10
wme_ac_be_txop_limit=0
wme_ac_be_acm=0
wme_ac_vi_aifs=2
wme_ac_vi_cwmin=3
wme_ac_vi_cwmax=4
wme_ac_vi_txop_limit=94
wme_ac_vi_acm=0
wme_ac_vo_aifs=2
wme_ac_vo_cwmin=2
wme_ac_vo_cwmax=3
wme_ac_vo_txop_limit=47
wme_ac_vo_acm=0</code></pre></div><p>Then edit your /etc/config/wireless and add this:</p><div class="codebox"><pre><code>option &#039;hwmode_11n&#039; &#039;g&#039;
option &#039;ht_capab&#039; &#039;[HT40-][SHORT-GI-40][DSSS_CCK-40]&#039;</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p97889">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">Ogion</div>
					<div class="post-datetime">
						25 Nov 2009, 11:48					</div>
				</div>
				<div class="post-content content">
					<p>Hello, I&#039;m using two Ubiquiti RouterStation pro with SR71-A 3x3 mimo minipci cards.<br />My hostapd.conf:<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# cat /var/run/hostapd-wlan0.conf 
ctrl_interface=/var/run/hostapd-wlan0
driver=nl80211
interface=wlan0
hw_mode=a
channel=64

ssid=testssid
wpa=0

country_code=no
ieee80211n=1
ht_capab=[HT40-][SHORT-GI-40][DSSS_CCK-40]




wme_enabled=1
wme_ac_bk_cwmin=4
wme_ac_bk_cwmax=10
wme_ac_bk_aifs=7
wme_ac_bk_txop_limit=0
wme_ac_bk_acm=0
wme_ac_be_aifs=3
wme_ac_be_cwmin=4
wme_ac_be_cwmax=10
wme_ac_be_txop_limit=0
wme_ac_be_acm=0
wme_ac_vi_aifs=2
wme_ac_vi_cwmin=3
wme_ac_vi_cwmax=4
wme_ac_vi_txop_limit=94
wme_ac_vi_acm=0
wme_ac_vo_aifs=2
wme_ac_vo_cwmin=2
wme_ac_vo_cwmax=3
wme_ac_vo_txop_limit=47
wme_ac_vo_acm=0
tx_queue_data3_aifs=7
tx_queue_data3_cwmin=15
tx_queue_data3_cwmax=1023
tx_queue_data3_burst=0
tx_queue_data2_aifs=3
tx_queue_data2_cwmin=15
tx_queue_data2_cwmax=63
tx_queue_data2_burst=0
tx_queue_data1_aifs=1
tx_queue_data1_cwmin=7
tx_queue_data1_cwmax=15
tx_queue_data1_burst=3.0
tx_queue_data0_aifs=1
tx_queue_data0_cwmin=3
tx_queue_data0_cwmax=7
tx_queue_data0_burst=1.5</code></pre></div><p>On client i have:<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# cat /etc/config/wireless 
config wifi-device  wlan0
    option type     mac80211
    option channel  64
    option macaddr    00:15:6d:84:15:15
    option hwmode_11n a
    option txpower    1
    list ht_capab    HT40-
    list ht_capab    SHORT-GI-40
    list ht_capab    DSSS_CCK-40

config wifi-iface
    option device   wlan0
    option network  wifi
    option mode     sta
    option ssid     testssid
    option encryption none</code></pre></div><p>I successfully connect to AP bun have slight speed:<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# iperf -c 192.168.168.2 -i10 -t60
------------------------------------------------------------
Client connecting to 192.168.168.2, TCP port 5001
TCP window size: 16.0 KByte (default)
------------------------------------------------------------
[  3] local 192.168.168.4 port 49818 connected with 192.168.168.2 port 5001
[ ID] Interval       Transfer     Bandwidth
[  3]  0.0-10.0 sec  18.8 MBytes  15.8 Mbits/sec
[ ID] Interval       Transfer     Bandwidth
[  3] 10.0-20.0 sec  19.4 MBytes  16.2 Mbits/sec
[ ID] Interval       Transfer     Bandwidth
[  3] 20.0-30.0 sec  18.5 MBytes  15.5 Mbits/sec
[ ID] Interval       Transfer     Bandwidth
[  3] 30.0-40.0 sec  21.2 MBytes  17.8 Mbits/sec
[ ID] Interval       Transfer     Bandwidth
[  3] 40.0-50.0 sec  20.1 MBytes  16.9 Mbits/sec
[ ID] Interval       Transfer     Bandwidth
[  3] 50.0-60.0 sec  17.9 MBytes  15.0 Mbits/sec
[ ID] Interval       Transfer     Bandwidth
[  3]  0.0-60.0 sec    116 MBytes  16.2 Mbits/sec</code></pre></div><p>But in debug files i get:<br /></p><div class="codebox"><pre><code>root@OpenWrt:/sys/kernel/debug/ath9k/phy0# cat rcstat 
 Rate         Success  Retries  XRetries PER

  6.0:        0        0        0        0
  9.0:        0        0        0        0
 12.0:        0        0        0        0
 18.0:        0        0        0        0
 24.0:        0        0        0        0
 36.0:        0        0        0        0
 48.0:        0        0        0        0
 54.0:        0        0        0        0
  6.5:        0        0        0        0
 13.0:        0        0        0        0
 19.5:        0        0        0        0
 26.0:        0        0        0        0
 39.0:        0        0        0        0
 52.0:        0        0        0        0
 58.5:        0        0        0        0
 65.0:        0        0        0        0
 13.0:        0        0        0        0
 26.0:        0        0        0        0
 39.0:        0        0        0        0
 52.0:        0        0        0        0
 78.0:        0        0        0        0
104.0:        0        0        0        0
117.0:        0        0        0        0
130.0:        0        0        0        0
 13.5:        0        0        0        0
 27.5:        0        0        0        0
 40.5:        0        0        0        0
 54.0:        0        0        0        0
 81.5:      836       73        0        6
108.0:        0        0        0        0
121.5:        0        0        0        0
135.0:        0        0        0        0
150.0:        0        0        0        0
 27.0:        0        0        0        0
 54.0:        0        0        0        0
 81.0:        0        0        0        0
108.0:    33935     9436        0       20
162.0:    28216    32293     1322       27
216.0:    18483    42778     2796       76
243.0:     5820    15934     1108       35
270.0:     6722     5183      362       54
300.0:   630278    10812      114       57
root@OpenWrt:/sys/kernel/debug/ath9k/phy0# cat xmit 
                            BE         BK        VI        VO

MPDUs Queued:               22         12         0      1878
MPDUs Completed:            22         12         0      1878
Aggregates:             230113        382         0         1
AMPDUs Queued:         2003148       3657         0       691
AMPDUs Completed:      2002702       3657         0       691
AMPDUs Retried:         390881         50         0         0
AMPDUs XRetried:           446          0         0         0
FIFO Underrun:               0          0         0         0
TXOP Exceeded:               0          0         0         0
TXTIMER Expiry:              0          0         0         0
DESC CFG Error:              0          0         0         0
DATA Underrun:               0          0         0         0
DELIM Underrun:              0          0         0         0</code></pre></div><p>And it is other info:<br /></p><div class="codebox"><pre><code>root@OpenWrt:/# iwconfig 
lo        no wireless extensions.

eth0      no wireless extensions.

eth1      no wireless extensions.

wlan0     IEEE 802.11abgn  ESSID:&quot;stepa&quot;  
          Mode:Managed  Frequency:5.32 GHz  Access Point: 00:15:6D:84:15:1C   
          Bit Rate=6 Mb/s   Tx-Power=1 dBm   
          RTS thr:off   Fragment thr:off
          Encryption key:off
          Power Management:off
          Link Quality=66/70  Signal level=-44 dBm  
          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:0   Missed beacon:0

root@OpenWrt:/# iw phy phy0 info
Wiphy phy0
    Band 1:
        HT capabilities: 0x104e
            * 20/40 MHz operation
            * SM PS disabled
            * 40 MHz short GI
            * max A-MSDU len 3839
            * DSSS/CCK 40 MHz
        HT A-MPDU factor: 0x0003 (65535 bytes)
        HT A-MPDU density: 0x0006 (8 usec)
        HT MCS set: ff ff 00 00 00 00 00 00 00 00 00 00 01 00 00 00
        HT TX/RX MCS rate indexes supported:
            MCS index 0
            MCS index 1
            MCS index 2
            MCS index 3
            MCS index 4
            MCS index 5
            MCS index 6
            MCS index 7
            MCS index 8
            MCS index 9
            MCS index 10
            MCS index 11
            MCS index 12
            MCS index 13
            MCS index 14
            MCS index 15
        Frequencies:
            * 2412 MHz [1] (20.0 dBm)
            * 2417 MHz [2] (20.0 dBm)
            * 2422 MHz [3] (20.0 dBm)
            * 2427 MHz [4] (20.0 dBm)
            * 2432 MHz [5] (20.0 dBm)
            * 2437 MHz [6] (20.0 dBm)
            * 2442 MHz [7] (20.0 dBm)
            * 2447 MHz [8] (20.0 dBm)
            * 2452 MHz [9] (20.0 dBm)
            * 2457 MHz [10] (20.0 dBm)
            * 2462 MHz [11] (20.0 dBm)
            * 2467 MHz [12] (disabled)
            * 2472 MHz [13] (disabled)
            * 2484 MHz [14] (disabled)
        Bitrates (non-HT):
            * 1.0 Mbps
            * 2.0 Mbps (short preamble supported)
            * 5.5 Mbps (short preamble supported)
            * 11.0 Mbps (short preamble supported)
            * 6.0 Mbps
            * 9.0 Mbps
            * 12.0 Mbps
            * 18.0 Mbps
            * 24.0 Mbps
            * 36.0 Mbps
            * 48.0 Mbps
            * 54.0 Mbps
    Band 2:
        HT capabilities: 0x104e
            * 20/40 MHz operation
            * SM PS disabled
            * 40 MHz short GI
            * max A-MSDU len 3839
            * DSSS/CCK 40 MHz
        HT A-MPDU factor: 0x0003 (65535 bytes)
        HT A-MPDU density: 0x0006 (8 usec)
        HT MCS set: ff ff 00 00 00 00 00 00 00 00 00 00 01 00 00 00
        HT TX/RX MCS rate indexes supported:
            MCS index 0
            MCS index 1
            MCS index 2
            MCS index 3
            MCS index 4
            MCS index 5
            MCS index 6
            MCS index 7
            MCS index 8
            MCS index 9
            MCS index 10
            MCS index 11
            MCS index 12
            MCS index 13
            MCS index 14
            MCS index 15
        Frequencies:
            * 5180 MHz [36] (20.0 dBm)
            * 5200 MHz [40] (20.0 dBm)
            * 5220 MHz [44] (20.0 dBm)
            * 5240 MHz [48] (20.0 dBm)
            * 5260 MHz [52] (20.0 dBm)
            * 5280 MHz [56] (20.0 dBm)
            * 5300 MHz [60] (20.0 dBm)
            * 5320 MHz [64] (20.0 dBm)
            * 5500 MHz [100] (disabled)
            * 5520 MHz [104] (disabled)
            * 5540 MHz [108] (disabled)
            * 5560 MHz [112] (disabled)
            * 5580 MHz [116] (disabled)
            * 5600 MHz [120] (disabled)
            * 5620 MHz [124] (disabled)
            * 5640 MHz [128] (disabled)
            * 5660 MHz [132] (disabled)
            * 5680 MHz [136] (disabled)
            * 5700 MHz [140] (disabled)
            * 5745 MHz [149] (20.0 dBm)
            * 5765 MHz [153] (20.0 dBm)
            * 5785 MHz [157] (20.0 dBm)
            * 5805 MHz [161] (20.0 dBm)
            * 5825 MHz [165] (20.0 dBm)
        Bitrates (non-HT):
            * 6.0 Mbps
            * 9.0 Mbps
            * 12.0 Mbps
            * 18.0 Mbps
            * 24.0 Mbps
            * 36.0 Mbps
            * 48.0 Mbps
            * 54.0 Mbps
    max # scan SSIDs: 4
    Supported interface modes:
         * IBSS
         * managed
         * AP
         * AP/VLAN
         * monitor
         * mesh point

root@OpenWrt:/# iwlist scan
lo        Interface doesn&#039;t support scanning.

eth0      Interface doesn&#039;t support scanning.

eth1      Interface doesn&#039;t support scanning.

wlan0     Scan completed :
          Cell 01 - Address: 00:15:6D:84:15:1C
                    Channel:64
                    Frequency:5.32 GHz (Channel 64)
                    Quality=63/70  Signal level=-47 dBm  
                    Encryption key:off
                    ESSID:&quot;testssid&quot;
                    Bit Rates:6 Mb/s; 9 Mb/s; 12 Mb/s; 18 Mb/s; 24 Mb/s
                              36 Mb/s; 48 Mb/s; 54 Mb/s
                    Mode:Master
                    Extra:tsf=000000007eaa17a4
                    Extra: Last beacon: 90ms ago
                    (Unknown Wireless Token 0x8C05)

root@OpenWrt:/# uname -a
Linux OpenWrt 2.6.30.9 #3 Sat Nov 21 02:40:31 OMST 2009 mips GNU/Linux</code></pre></div><p>Can you tell me what i do wrong, and how can i get link with 300mbps bandwidth?</p><p>Thanks and excuses me for my bad english language.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>