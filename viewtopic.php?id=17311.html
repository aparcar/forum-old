<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> update to kamikaze failed  (asus WL-500g Premium)</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 17 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p74648">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">khatar</div>
					<div class="post-datetime">
						13 Oct 2008, 22:37					</div>
				</div>
				<div class="post-content content">
					<p>hello all,</p><p>I tried to upgrade from my two years old whiterussian to a kamikaze. I tried mtd method as described here:</p><p><a href="http://wiki.openwrt.org/OpenWrtDocs/Hardware/Asus/WL500GP">http://wiki.openwrt.org/OpenWrtDocs/Har â€¦ us/WL500GP</a></p><p>but my router never booted again. So i connected on it with the diagmode telnetd to grab some informations. I was surprised to see the net conf has nothing to do with the documented one: </p><p>Please help or my wife would kill me :-)</p><p>Some grabbed info:</p><p>seen in motd:</p><p>KAMIKAZE (7.09) </p><p>seen in dmesg:</p><p>Detected &#039;ASUS WL-500g Premium&#039;<br />CPU: BCM4704 rev 9 at 264 MHz <br />eth0: Broadcom 47xx 10/100BaseT Ethernet 00:1b:fc:10:3f:bc<br />eth1: Broadcom 47xx 10/100BaseT Ethernet 40:10:18:00:00:2d</p><p>seen in ifconfig:</p><p>eth0&nbsp; &nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 00:1B:FC:10:3F:BC&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:192.168.1.1&nbsp; Bcast:192.168.1.255&nbsp; Mask:255.255.255.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:1556 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:975 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000 <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:110543 (107.9 KiB)&nbsp; TX bytes:99438 (97.1 KiB)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Interrupt:4 </p><p>eth1&nbsp; &nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 40:10:18:00:00:2D&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BROADCAST MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:0 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000 <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:0 (0.0 B)&nbsp; </p><p>tried:</p><p>root@(none):/# mount_root<br />root@(none):/# wifi detect &gt; /etc/config/wireless<br />broadcom: Detect failed</p><br /><p>regards</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p74649">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">oxo</div>
					<div class="post-datetime">
						13 Oct 2008, 22:44					</div>
				</div>
				<div class="post-content content">
					<p>I have just done 2 of my asus wl-500gp&#039;s with no problems.<br />Did you mean that you attached a cable between the asus and your pc and did a telnet and got an Openwrt prompt<br />If yes, then the box is working.<br />You need to edit /etc/config/wireless<br />and do a passwd to get rid of telnet and start ssh</p><p>and do a /etc/init.d/network restart (or just toggle the power ...)</p>											<p class="post-edited">(Last edited by <strong>oxo</strong> on 13 Oct 2008, 22:45)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p74677">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">khatar</div>
					<div class="post-datetime">
						14 Oct 2008, 08:38					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>oxo wrote:</cite><blockquote><p>Did you mean that you attached a cable between the asus and your pc and did a telnet and got an Openwrt prompt<br />If yes, then the box is working.</p></blockquote></div><p>i did it, but it was in the diag mode!</p><div class="quotebox"><cite>oxo wrote:</cite><blockquote><p>You need to edit /etc/config/wireless and do a passwd to get rid of telnet and start ssh.</p></blockquote></div><p>the doc says it can be generated</p><div class="codebox"><pre><code>wifi detect &gt; /etc/config/wireless</code></pre></div><p>but as i said</p><div class="codebox"><pre><code># wifi detect &gt; /etc/config/wireless
broadcom: Detect failed</code></pre></div><p>The file is still empty and the available interfaces confuses me:</p><p>Interfaces expected after reading the doc:</p><p>br-lan 192.168.1.1/24<br />vlan0&nbsp; &nbsp;LAN ports (1 to 4)<br />vlan1 WAN port DHCP<br />wl0/ath0 WiFi</p><p>Seen interfaces:</p><p>eth0&nbsp; 192.168.1.1&nbsp; <br />eth1&nbsp; ? </p><p>regards</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p74713">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">oxo</div>
					<div class="post-datetime">
						14 Oct 2008, 21:10					</div>
				</div>
				<div class="post-content content">
					<p>What is the /etc/config/network on the box ...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p74731">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">khatar</div>
					<div class="post-datetime">
						15 Oct 2008, 09:14					</div>
				</div>
				<div class="post-content content">
					<p>well ... i tried to enter to diag mode again and have no more answer. I can&#039;t even ping my router anymore ...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p74743">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Yanira</div>
					<div class="post-datetime">
						15 Oct 2008, 12:11					</div>
				</div>
				<div class="post-content content">
					<div class="codebox"><pre><code>root@OpenWrt:~# rm -rf /etc/config/wireless
root@OpenWrt:~# wifi detect &gt; /etc/config/wireless</code></pre></div><p>If /etc/config/wireless is there, even if it&#039;s empty it will not be detected, IIRC.</p>											<p class="post-edited">(Last edited by <strong>Yanira</strong> on 15 Oct 2008, 12:14)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p74744">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">oxo</div>
					<div class="post-datetime">
						15 Oct 2008, 12:26					</div>
				</div>
				<div class="post-content content">
					<p>If you can, use tcpdump or wireshark on your pc and send a trace of what happens at power on of your router.</p><p><a href="http://www.wireshark.org/download.html">http://www.wireshark.org/download.html</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p74745">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">oxo</div>
					<div class="post-datetime">
						15 Oct 2008, 13:26					</div>
				</div>
				<div class="post-content content">
					<p>Or on the other hand, revert back to original Asus software using Asus SW utility to obtain peace with the wife<br />- and check that the device can still work</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p74749">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">khatar</div>
					<div class="post-datetime">
						15 Oct 2008, 15:03					</div>
				</div>
				<div class="post-content content">
					<p>@Yanira</p><p>read my old post, allready done and failed</p><p>@oxo</p><p>I am now connected in diag mode and have:</p><p>root@OpenWrt:/# cat /etc/config/network <br />#### VLAN configuration <br />config switch eth0<br />&nbsp; &nbsp; &nbsp; &nbsp; option vlan0&nbsp; &nbsp; &quot;1 2 3 4 5*&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; option vlan1&nbsp; &nbsp; &quot;0 5&quot;</p><br /><p>#### Loopback configuration<br />config interface loopback<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname&nbsp; &nbsp;&quot;lo&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto&nbsp; &nbsp; static<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr&nbsp; &nbsp;127.0.0.1<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask&nbsp; 255.0.0.0</p><br /><p>#### LAN configuration<br />config interface lan<br />&nbsp; &nbsp; &nbsp; &nbsp; option type&nbsp; &nbsp; &nbsp;bridge<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname&nbsp; &nbsp;&quot;lan&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto&nbsp; &nbsp; static<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr&nbsp; &nbsp;192.168.1.1<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask&nbsp; 255.255.255.0</p><br /><p>#### WAN configuration<br />config interface&nbsp; &nbsp; &nbsp; &nbsp; wan<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname&nbsp; &nbsp;&quot;wan&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto&nbsp; &nbsp; dhcp</p><p>root@OpenWrt:/# cat /etc/config/wireless<br />config wifi-device&nbsp; wl0<br />&nbsp; &nbsp; &nbsp; &nbsp; option type&nbsp; &nbsp; &nbsp;broadcom<br />&nbsp; &nbsp; &nbsp; &nbsp; option channel&nbsp; 5</p><p>&nbsp; &nbsp; &nbsp; &nbsp; # REMOVE THIS LINE TO ENABLE WIFI:<br />&nbsp; &nbsp; &nbsp; &nbsp; # option disabled 1</p><p>config wifi-iface<br />&nbsp; &nbsp; &nbsp; &nbsp; option device&nbsp; &nbsp;wl0<br />&nbsp; &nbsp; &nbsp; &nbsp; option network&nbsp; lan<br />&nbsp; &nbsp; &nbsp; &nbsp; option mode&nbsp; &nbsp; &nbsp;ap<br />&nbsp; &nbsp; &nbsp; &nbsp; option ssid&nbsp; &nbsp; &nbsp;OpenWrt<br />&nbsp; &nbsp; &nbsp; &nbsp; option encryption none</p><p>/etc/init.d/network start</p><p>root@(none):/etc/config# /etc/init.d/network start<br />/sbin/ifup: /sbin/ifdown: 18: cannot create /var/state/network.92: Directory nonexistent<br />mv: cannot rename &#039;/var/state/network.92&#039;: No such file or directory<br />/bin/uci: /bin/uci: 189: cannot create /var/state/network: Directory nonexistent<br />/sbin/ifup: /sbin/ifdown: 18: cannot create /var/state/network.118: Directory nonexistent<br />mv: cannot rename &#039;/var/state/network.118&#039;: No such file or directory<br />ifconfig: SIOCGIFFLAGS: No such device<br />/bin/uci: /bin/uci: 189: cannot create /var/state/network: Directory nonexistent<br />/sbin/hotplug-call: .: 1: Can&#039;t open /var/state/network<br />/bin/uci: /bin/uci: 189: cannot create /var/state/network: Directory nonexistent<br />ifconfig: SIOCSIFADDR: No such device<br />/sbin/ifup: /sbin/ifdown: 18: cannot create /var/state/network.153: Directory nonexistent<br />mv: cannot rename &#039;/var/state/network.153&#039;: No such file or directory<br />/bin/uci: /bin/uci: 189: cannot create /var/state/network: Directory nonexistent<br />/sbin/hotplug-call: .: 1: Can&#039;t open /var/state/network<br />ifconfig: SIOCGIFFLAGS: No such device<br />/bin/uci: /bin/uci: 189: cannot create /var/state/network: Directory nonexistent<br />Can&#039;t open /var/lock/dhcp-wan<br />udhcpc: cannot open pidfile /var/run/wan.pid: No such file or directory<br />udhcpc (v1.4.2) started<br />udhcpc: SIOCGIFINDEX failed: No such device<br />No Broadcom wl interface found!<br />No Broadcom wl interface found!<br />ifconfig: SIOCGIFFLAGS: No such device<br />/bin/uci: /bin/uci: 189: cannot create /var/state/network: Directory nonexistent<br />ifconfig: SIOCSIFADDR: No such device<br />/bin/uci: /bin/uci: 189: cannot create /var/state/wireless: Directory nonexistent<br />/bin/uci: /bin/uci: 189: cannot create /var/state/wireless: Directory nonexistent<br />/bin/uci: /bin/uci: 189: cannot create /var/state/network: Directory nonexistent<br />No Broadcom wl interface found!<br />wl0(broadcom): enable failed<br />/sbin/hotplug-call: .: 1: Can&#039;t open /var/state/network</p><p>If i try to power on the normal mode, it is like the interface doesn&#039;t answer arp requests. this is the libcap file :</p><p><a href="http://musil.biblibre.com/power_on">http://musil.biblibre.com/power_on</a></p><p>regards</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p74752">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">oxo</div>
					<div class="post-datetime">
						15 Oct 2008, 15:27					</div>
				</div>
				<div class="post-content content">
					<p>OK the first packet was to port 4919, which is good.</p><p>Please read: <a href="http://wiki.openwrt.org/OpenWrtDocs/Hardware/Asus/WL500GP">http://wiki.openwrt.org/OpenWrtDocs/Har â€¦ us/WL500GP</a> (Installation) and/or <a href="http://forum.openwrt.org/viewtopic.php?id=12778">http://forum.openwrt.org/viewtopic.php?id=12778</a> and see if there is something you can do, while I re-read your posts.</p><p>I know it seems daft, please double check you don&#039;t have firewall enabled on your pc (I have forgotten more than once)</p><p>Please forget about things that don&#039;t work in diag mode: lets try and get it in &quot;ordinary&quot; mode</p><p>(I&#039;ll try and put one of my devices in diag mode to see the same symtons but it isn&#039;t &quot;important&quot; as the device can run Kami )</p>											<p class="post-edited">(Last edited by <strong>oxo</strong> on 15 Oct 2008, 21:20)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p74772">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">khatar</div>
					<div class="post-datetime">
						15 Oct 2008, 23:08					</div>
				</div>
				<div class="post-content content">
					<p>oxo,</p><p>thanks to your help, i just seen that the situation wasn&#039;t so bad i can&#039;t retry from the start. I have done an mtd write again and it worked almost fine this time. I can&#039;t connect to the wifi with my laptop but now my iwlist gets</p><p>eth1&nbsp; &nbsp; &nbsp; Scan completed :<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Cell 01 - Address: 00:1B:FC:10:3F:BC<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ESSID:&quot;voltaire&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Mode:Master<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Channel:5<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Frequency:2.432 GHz (Channel 5)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Quality=96/100&nbsp; Signal level=-30 dBm&nbsp; Noise level=-127 dBm<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Encryption key:on<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IE: WPA Version 1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Group Cipher : TKIP<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Pairwise Ciphers (1) : TKIP<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Authentication Suites (1) : 802.1x<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Bit Rates:1 Mb/s; 2 Mb/s; 5.5 Mb/s; 11 Mb/s; 18 Mb/s<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 24 Mb/s; 36 Mb/s; 54 Mb/s; 6 Mb/s; 9 Mb/s<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 12 Mb/s; 48 Mb/s<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Extra:tsf=000000023115ff9d</p><p>So i think i&#039;m close to the victory ... still searching <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>regards</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p74774">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">oxo</div>
					<div class="post-datetime">
						15 Oct 2008, 23:31					</div>
				</div>
				<div class="post-content content">
					<p>Great <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>