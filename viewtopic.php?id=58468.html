<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Set router to Static IP, turned of DHCP.  Now I can&#039;t connect at all</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 7 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p283342">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">bryan4real</div>
					<div class="post-datetime">
						13 Jul 2015, 13:16					</div>
				</div>
				<div class="post-content content">
					<p>Brand new WRT1900AC, v2, fresh install.&nbsp; Everything seemed to be working correct with Luci</p><p>I changed to static IP of 192.168.1.200, and turned off DHCP (because my main router is providing it).&nbsp; It lost connection while applying changes (as expected), but I was unable to reconnect, even after reboot.</p><p>I can see the WRT1900AC on my main router.</p><p>Connecting via wired just gives me a self-assigned IP (no network connection).<br />Connecting via LAN (192.168.1.200) doesn&#039;t work (not sure if expected or not)</p><p>Did I immediately brick my new router?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p283354">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">eduperez</div>
					<div class="post-datetime">
						13 Jul 2015, 15:38					</div>
				</div>
				<div class="post-content content">
					<p>OpenWRT disables telnet after you change the root password, are you using SSH to connect to the device?<br />When your computer is connected to the LAN, what network parameters does it receive from the main router?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p283355">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">bryan4real</div>
					<div class="post-datetime">
						13 Jul 2015, 15:59					</div>
				</div>
				<div class="post-content content">
					<p>Oh yes, I changed the root password.</p><p>As far as I know, my computer receives no network parameters.&nbsp; I downloaded a UDPIntercept tool linked somewhere on the OpenWRT wiki, and never got anything (windows).</p><p>I tried SSH and Telnet via putty, but it timed out.&nbsp; However, I&#039;m not sure what IP to use (I tried 192.168.1.1, .2, and .200).</p><p>Unfortunately, my mac only has wifi, so I don&#039;t have a lot of unix tools available</p><p>I tried holding down reset, and all sorts of failsafe mode, or reboot tricks, but nothing worked.&nbsp; Now I&#039;m trying to connect via TTL (I already have a USB to UART), but that&#039;s not working either (not getting anything in my terminal)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p283378">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">tunk</div>
					<div class="post-datetime">
						13 Jul 2015, 20:18					</div>
				</div>
				<div class="post-content content">
					<p>Is it possible to login from your main router with SSH?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p283387">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">eduperez</div>
					<div class="post-datetime">
						13 Jul 2015, 21:02					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>bryan4real wrote:</cite><blockquote><p>Oh yes, I changed the root password.</p></blockquote></div><p>Forget about TELNET and use SSH.</p><div class="quotebox"><cite>bryan4real wrote:</cite><blockquote><p>As far as I know, my computer receives no network parameters.</p></blockquote></div><p>Isn&#039;t your main router acting as a DHCP server? How is it configured? How is your MAC configured?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p283403">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">bryan4real</div>
					<div class="post-datetime">
						13 Jul 2015, 22:30					</div>
				</div>
				<div class="post-content content">
					<p>I got it working via Telnet (twice, cause I ran into a similar problem again).&nbsp; How do I change the IP of the router without locking myself out of luci/ssh (essentially bricking the router, since it seems this model doesn&#039;t have failsafe)?</p><p>I&#039;m still stuck at this point, because anytime I change anything meaningful, I get locked out and have to start all over via reflashing.&nbsp; I&#039;m trying to start a whole new network based on this OpenWRT router, without taking down the existing network in the process.&nbsp; At the least, is there a way to build in a safe backdoor via a new interface, so if I mess up, I can reconnect there and try to troubleshoot?</p><p>Even changing IP to just 192.168.1.2 make the web console and ssh completely inaccessible, even though it was providing me internet access when connected.</p><p>Main server is DHCP.&nbsp; I have it reserve an IP for the OpenWRT router&#039;s MAC.&nbsp; Nothing beyond that.</p><p>--------------------</p><p>For posterity for anyone else who comes across this thread with the same issue, here is what I did to get tty working via serial that&#039;s different from the wiki:</p><p>First, if you have a v2 unit, then disassembling is MUCH easier than other guides will have you believe.&nbsp; You only need to remove the two legs on the front (blue side).&nbsp; Then the blue part slides off very easily (not nearly as much force as guides will say).&nbsp; Also, in v2, the serial port is located in a different location in the front, so you don&#039;t even need to touch the black part of the case.</p><p>For the pins, there were a few &quot;gotchas&quot; for me:</p><p>(I used a PL2303 USB to serial adapter).<br />First, DONT cross the RX/TX lines (this may be obvious, but I thought you connect the TX of one side to the RX of the other.&nbsp; It&#039;s actually TX to TX, RX to RX).</p><p>Second, don&#039;t connect the Vcc line at all.&nbsp; For some reason it stops the router from booting (maybe too much EM interference?)... anyway, even at 3.3V, you don&#039;t need it.&nbsp; Just connect GND, TX, and RX.</p><p>Last, when preparing to load the firmware via TFTP, the command &quot;setenv firmware_name firmware_image_name.img&quot; seems to do nothing.&nbsp; The device always just looks for &quot;cobra.img&quot;.&nbsp; I imagine the environment variable name changed, but for now, you can just rename your image to cobra.img</p>											<p class="post-edited">(Last edited by <strong>bryan4real</strong> on 13 Jul 2015, 22:36)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p283425">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">tmo26</div>
					<div class="post-datetime">
						13 Jul 2015, 23:37					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>bryan4real wrote:</cite><blockquote><p>I can see the WRT1900AC on my main router.</p></blockquote></div><p>How do you &quot;see&quot; the WRT1900AC?</p><div class="quotebox"><cite>bryan4real wrote:</cite><blockquote><p>I got it working via Telnet (twice, cause I ran into a similar problem again).&nbsp; How do I change the IP of the router without locking myself out of luci/ssh?</p></blockquote></div><p>Describe step by step what you are doing to change the IP, from the moment you telnet into the 1900AC, to the moment where you lose connection. Preferably copy&amp;paste putty&#039;s output.<br />And please also show how you try to reconnect.</p><div class="quotebox"><cite>bryan4real wrote:</cite><blockquote><p>I tried SSH and Telnet via putty, but it timed out.</p></blockquote></div><div class="quotebox"><cite>bryan4real wrote:</cite><blockquote><p>Even changing IP to just 192.168.1.2 make the web console and ssh completely inaccessible</p></blockquote></div><p>How did you manage to connect via ssh if it timed out?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p283448">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">DBAA</div>
					<div class="post-datetime">
						14 Jul 2015, 00:54					</div>
				</div>
				<div class="post-content content">
					<p>Generally to extend a network:<br />- change the LAN interface IP address to something that is on the same LAN as your main router but doesn&#039;t conflict with it (ex if main is 192.168.1.1/24 change the new one to 192.168.1.2/24)<br />- disable DHCP server <br />- use a cable connecting LAN on your main router to LAN on this new router</p><p>You doing anything different?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p283496">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">bryan4real</div>
					<div class="post-datetime">
						14 Jul 2015, 10:58					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>tmo26 wrote:</cite><blockquote><p>How do you &quot;see&quot; the WRT1900AC?</p></blockquote></div><p>Sorry, that&#039;s a poor way to phrase it.&nbsp; DCHP allocated it an IP (the server &quot;saw&quot; the connected MAC address)</p><div class="quotebox"><cite>bryan4real wrote:</cite><blockquote><p>I got it working via Telnet (twice, cause I ran into a similar problem again).&nbsp; How do I change the IP of the router without locking myself out of luci/ssh?</p></blockquote></div><div class="quotebox"><cite>tmo26 wrote:</cite><blockquote><p>Describe step by step what you are doing to change the IP, from the moment you telnet into the 1900AC, to the moment where you lose connection. Preferably copy&amp;paste putty&#039;s output.</p></blockquote></div><p>Sorry, I don&#039;t have the putty available, but I remember the steps I took:</p><p>After flash, visit 192.168.1.1 to make sure it&#039;s running.<br />Telnet to 192.168.1.1, set root password, log-out<br />SSH in, but only to check (don&#039;t change anything).<br />Use Luci for the next steps (which I did differently each time:)</p><p>First time:<br />go to interfaces, manually set IP (Is it the WAN IP or the LAN IP?&nbsp; -- I&#039;m sure my confusion here is a large part of why I&#039;m having trouble)<br />turn off DHCP<br />automatically disconnect from luci since the IP changed.<br />try opening 192.168.1.1, 192.168.1.2, 192.168.1.200, both in browser, via ssh (&quot;root@...&quot;) and telnet -- timeout on all of them<br />restart router<br />try again<br />try holding down reset button (no effect)<br />try the multiple power down, power up trick (no effect)<br />make this thread<br />take apart and use TTL to re-flash -- Success</p><p>Second time: (reserve IP on main server to give openwrt router 192.168.1.2)<br />go to interfaces, check that WAN has 192.168.1.2 (it does)<br />set LAN gateway and DNS to be 192.168.1.1<br />set LAN IP to 192.168.1.2<br />restart<br />have internet, but cannot connect to openwrt router at all (tried all methods same as first time... also reflashed in the end)</p><div class="quotebox"><cite>bryan4real wrote:</cite><blockquote><p>Even changing IP to just 192.168.1.2 make the web console and ssh completely inaccessible</p></blockquote></div><div class="quotebox"><cite>tmo26 wrote:</cite><blockquote><p>How did you manage to connect via ssh if it timed out?</p></blockquote></div><p>I didn&#039;t.&nbsp; The only successful SSH connections were before any IP changes</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p283497">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">bryan4real</div>
					<div class="post-datetime">
						14 Jul 2015, 11:01					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>DBAA wrote:</cite><blockquote><p>Generally to extend a network:<br />- change the LAN interface IP address to something that is on the same LAN as your main router but doesn&#039;t conflict with it (ex if main is 192.168.1.1/24 change the new one to 192.168.1.2/24)</p></blockquote></div><p>what about the WAN interface?&nbsp; don&#039;t touch it?&nbsp; Should the LAN interface IP and WAN be different or the same?&nbsp; Should I reserve one or both on the main router?</p><div class="quotebox"><cite>DBAA wrote:</cite><blockquote><p>- disable DHCP server</p></blockquote></div><p>If I don&#039;t disable DHCP, will it still work, assuming no IP address conflicts (as in I&#039;m the only one on the network, temporarily?, or set different IP ranges?)</p><div class="quotebox"><cite>DBAA wrote:</cite><blockquote><p>- use a cable connecting LAN on your main router to LAN on this new router</p></blockquote></div><p>why connect to the openWRT LAN instead of WAN?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p283515">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">RangerZ</div>
					<div class="post-datetime">
						14 Jul 2015, 17:55					</div>
				</div>
				<div class="post-content content">
					<p>It sounds like you are trying to create a &quot;Dumb AP&quot;.<br /><a href="https://forum.openwrt.org/viewtopic.php?id=58313">https://forum.openwrt.org/viewtopic.php?id=58313</a><br /><a href="http://wiki.openwrt.org/doc/recipes/dumbap">http://wiki.openwrt.org/doc/recipes/dumbap</a></p><p>Reading the above, I think you are almost there.&nbsp; What I do not see is that to configure (access after turning off DHCP) the OpenWRT router you will probably (should) set a fixed IP on the client.&nbsp; The IP your client is getting that is not in the 192.168.1.x range indicates a problem and I think this is it.&nbsp; The MAC reservation on your main router could also be a problem.&nbsp; I suggest loosing it. </p><p>If your goal is an AP I will suggest the following.</p><p>First, in general, if you can, change the subnet of the Primary Router to something other than 192.168.1.1(192.168.111.1). In general as new routers get this as a default, I find it will eliminates conflicts when you connect a NEW router to an existing LAN. It eliminates 2 DHCP servers trying to set the same address range.&nbsp; Instructions below assume you did NOT do this.</p><p>The following assumes you are on CC 15.05 RC2, otherwise your prompts may be slightly different.</p><p>On your &quot;Main Router&quot; identify the DHCP range.&nbsp; (lets assume it to be 192.168.1.100 - 150)<br />Lets reserve (mentally) an IP for the WRT1900AC, which is outside of the DHCP range (192.168.1.200).&nbsp; Remove the MAC association to the WRT1900AC.</p><p>Reset your WRT1900AC to OpenWRT defaults (new install).<br />Disconnect your WRT1900AC from the &quot;Main Router&quot;.<br />Connect a clinet to the WRT1900AC via Cat-5 using a LAN port (not WAN) <br />Set your client to 192.168.1.2 (address must not be used by your main router)<br />Open 192.168.1.1 in a browser.<br />Set password/login<br />Go To Network=&gt; Interfaces =&gt; LAN =&gt; Edit<br />Lan Interface =&gt; Common Configuration =&gt; General setup<br />IPV4 Address: Change to 192.168.1.200<br />IPV4 gateway: Set 192.168.1.1 (Main Router IP)<br />Use Custom DHCP servers: 192.168.1.1 (Main Router IP)</p><p>Lan Interface =&gt; DHCP Server =&gt; General Setup<br />Ignore Interface: Check this box</p><p>Save &amp; Apply</p><p>Close the browser after you see the turning image in the upper left.<br />Open the browser<br />Log into LuCi at 192.168.1.200 (pray if you will, but I have faith).&nbsp; You should be able to navigate the router, but do not make any changes.</p><p>Connect a cable from one of the LAN connections on the WRT1900AC to the Main Router LAN.&nbsp; </p><p>IGNORE anything you see that says WAN on both the physical device and OpenWRT GUI.&nbsp; You are bypassing the WAN.&nbsp; Leave all the Interfaces and rules (at least for now).&nbsp; They are basically ignored.</p><p>After a minute or two try accessing your Main Router control panel 192.168.1.1.&nbsp; Then try to access the Internet.&nbsp; (If this does not work, reset your client to DHCP and try again, and/or reboot things)</p><p>Reset your client to DHCP.</p><p>You are done</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p283520">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">bryan4real</div>
					<div class="post-datetime">
						14 Jul 2015, 19:09					</div>
				</div>
				<div class="post-content content">
					<p>Thanks!</p><p>I finally got it using a really round-about version of your post.</p><p>Basically, using defaults, I connected a wired LAN client.<br />Turned on wifi, connected a different wifi client.<br />Changed NATed subnet of the lan (but not for the wifi) to 192.168.2.1<br />played with settings until that could get the internet and get Luci.<br />Then played with wifi settings to do the same thing (but still on original subnet)<br />Changed wired back to original subnet.</p><p>Obviously, there was not really a need to do all that, but I was playing extra safe that I didn&#039;t permanently loose SSH or Luci connections (hence the &quot;transition&quot; subnet).&nbsp; The bright side it: I learned a lot.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p283564">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">RangerZ</div>
					<div class="post-datetime">
						15 Jul 2015, 00:42					</div>
				</div>
				<div class="post-content content">
					<p>I am glad you got this working, though I am not really following your process.</p><p>I think from what was written is that your router was always working, but the IP assigned to the PC was in a different subnet and would not connect by any method even if the IP you were trying to contact was correct.</p><p>If you are on windows, then CMD and ipconfig would answer all these questions</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>