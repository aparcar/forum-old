<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Broadcom 963168VX_P400 network configuration</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 25 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p235753">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">thom1337</div>
					<div class="post-datetime">
						5 Jun 2014, 17:18					</div>
				</div>
				<div class="post-content content">
					<p>Hi all,</p><p>I have managed to flash OpenWRT to my 963168VX_P400 board, however I can&#039;t seem to ping 192.168.1.1 and access the control panel.<br />I&#039;m using a serial cable to flash/observe.</p><p>This is the bootlog:<br /></p><div class="codebox"><pre><code>*** Press any key to stop auto run (1 seconds) ***
Auto run second count down: 0
Booting from latest image (0xb8010000) ...
Code Address: 0x80010000, Entry Address: 0x80010000
LZMA: Prossible old LZMA format, trying to decompress..
Decompression OK!
Entry at 0x80010000
Starting program at 0x80010000
[    0.000000] Linux version 3.10.36 (thom@thom-laptop) (gcc version 4.8.3 (OpenWrt/Linaro GCC 4.8-2014.04 r41006) ) #13 Thu Jun 5 15:10:25 BST4
[    0.000000] Detected Broadcom 0x63268 CPU revision d0
[    0.000000] CPU frequency is 400 MHz
[    0.000000] 128MB of RAM installed
[    0.000000] registering 52 GPIOs
[    0.000000] board_bcm963xx: Boot address 0xb8000000
[    0.000000] board_bcm963xx: CFE version: 1.0.38-116.17
[    0.000000] bootconsole [early0] enabled
[    0.000000] CPU revision is: 0002a080 (Broadcom BMIPS4350)
[    0.000000] board_bcm963xx: board name: 963168VX_P400
[    0.000000] Determined physical RAM map:
[    0.000000]  memory: 08000000 @ 00000000 (usable)
[    0.000000] Initrd not found or empty - disabling initrd
[    0.000000] Zone ranges:
[    0.000000]   Normal   [mem 0x00000000-0x07ffffff]
[    0.000000] Movable zone start for each node
[    0.000000] Early memory node ranges
[    0.000000]   node   0: [mem 0x00000000-0x07ffffff]
[    0.000000] Primary instruction cache 64kB, VIPT, 4-way, linesize 16 bytes.
[    0.000000] Primary data cache 32kB, 2-way, VIPT, cache aliases, linesize 16 bytes
[    0.000000] Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 32512
[    0.000000] Kernel command line:  root=/dev/mtdblock2 rootfstype=squashfs,jffs2 noinitrd console=ttyS0,115200
[    0.000000] PID hash table entries: 512 (order: -1, 2048 bytes)
[    0.000000] Dentry cache hash table entries: 16384 (order: 4, 65536 bytes)
[    0.000000] Inode-cache hash table entries: 8192 (order: 3, 32768 bytes)
[    0.000000] Memory: 126344k/131072k available (2346k kernel code, 4728k reserved, 618k data, 296k init, 0k highmem)
[    0.000000] NR_IRQS:256
[    0.000000] Calibrating delay loop... 397.82 BogoMIPS (lpj=795648)
[    0.032000] pid_max: default: 32768 minimum: 301
[    0.036000] Mount-cache hash table entries: 512
[    0.044000] NET: Registered protocol family 16
[    0.056000] bio: create slab &lt;bio-0&gt; at 0
[    0.060000] Switching to clocksource MIPS
[    0.068000] NET: Registered protocol family 2
[    0.072000] TCP established hash table entries: 1024 (order: 1, 8192 bytes)
[    0.080000] TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
[    0.084000] TCP: Hash tables configured (established 1024 bind 1024)
[    0.092000] TCP: reno registered
[    0.096000] UDP hash table entries: 256 (order: 0, 4096 bytes)
[    0.100000] UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
[    0.108000] NET: Registered protocol family 1
[    0.116000] audit: initializing netlink socket (disabled)
[    0.120000] type=2000 audit(0.120:1): initialized
[    0.124000] squashfs: version 4.0 (2009/01/31) Phillip Lougher
[    0.132000] jffs2: version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006 Red Hat, Inc.
[    0.144000] msgmni has been set to 246
[    0.148000] io scheduler noop registered
[    0.152000] io scheduler deadline registered (default)
ï¿½[    0.164000] console [ttyS0] enabled, bootconsole disabled= 13) is a bcm63xx_uart
[    0.164000] console [ttyS0] enabled, bootconsole disabled
[    0.180000] bcm63xx-spi bcm63xx-spi: at 0xb0000800 (irq 88, FIFOs size 542)
[    0.188000] m25p80 spi1.0: found mx25l25635e, expected m25p80
[    0.196000] m25p80 spi1.0: mx25l25635e (32768 Kbytes)
[    0.200000] bcm63xxpart: CFE boot tag found with version 6 and board type 963268BU_P300
[    0.208000] bcm63xxpart: Partition 0 is CFE offset 0 and length 10000
[    0.216000] bcm63xxpart: Partition 1 is kernel offset 10100 and length 10ff00
[    0.224000] bcm63xxpart: Partition 2 is rootfs offset 120000 and length 1ed0000
[    0.228000] bcm63xxpart: Partition 3 is nvram offset 1ff0000 and length 10000
[    0.236000] bcm63xxpart: Partition 4 is linux offset 10000 and length 1fe0000
[    0.244000] bcm63xxpart: Spare partition is offset 310004 and length 1cdfffc
[    0.252000] 5 bcm63xxpart partitions found on MTD device spi1.0
[    0.256000] Creating 5 MTD partitions on &quot;spi1.0&quot;:
[    0.264000] 0x000000000000-0x000000010000 : &quot;CFE&quot;
[    0.268000] 0x000000010100-0x000000120000 : &quot;kernel&quot;
[    0.276000] mtd: partition &quot;kernel&quot; must either start or end on erase block boundary or be smaller than an erase block -- forcing read-only
[    0.288000] 0x000000120000-0x000001ff0000 : &quot;rootfs&quot;
[    0.296000] mtd: device 2 (rootfs) set to be root filesystem
[    0.300000] mtd: partition &quot;rootfs_data&quot; created automatically, ofs=0x310000, len=0x1ce0000
[    0.312000] 0x000000310000-0x000001ff0000 : &quot;rootfs_data&quot;
[    0.316000] 0x000001ff0000-0x000002000000 : &quot;nvram&quot;
[    0.324000] 0x000000010000-0x000001ff0000 : &quot;linux&quot;
[    0.368000] bcm63xx-wdt bcm63xx-wdt:  started, timer margin: 30 sec
[    0.376000] TCP: cubic registered
[    0.380000] NET: Registered protocol family 17
[    0.384000] 8021q: 802.1Q VLAN Support v1.8
[    0.400000] VFS: Mounted root (squashfs filesystem) readonly on device 31:2.
[    0.412000] Freeing unused kernel memory: 296K (802f6000 - 80340000)
procd: Console is alive
procd: - watchdog -
procd: - preinit -
ifconfig: SIOCGIFFLAGS: No such device
Press the [f] key and hit [enter] to enter failsafe mode
Press the [1], [2], [3] or [4] key and hit [enter] to select the debug level
[    3.268000] Button Hotplug driver version 0.4.1
jffs2 is not ready - marker found
ifconfig: SIOCGIFFLAGS: No such device
procd: - early -
procd: - watchdog -
procd: - ubus -
procd: - init -
Please press Enter to activate this console.
[    8.392000] NET: Registered protocol family 10
[    8.416000] nf_conntrack version 0.5.0 (1978 buckets, 7912 max)
[    8.432000] ip6_tables: (C) 2000-2006 Netfilter Core Team
[    8.448000] ip_tables: (C) 2000-2006 Netfilter Core Team
[    8.508000] xt_time: kernel timezone is -0000
[    8.524000] PPP generic driver version 2.4.2
[    8.532000] NET: Registered protocol family 24
[   16.372000] jffs2_scan_eraseblock(): End of filesystem marker found at 0x0
[   16.388000] jffs2_build_filesystem(): unlocking the mtd device... done.
[   16.392000] jffs2_build_filesystem(): erasing all blocks after the end marker... 


BusyBox v1.22.1 (2014-06-05 12:31:30 BST) built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.</code></pre></div><p>Ping to 192.168.1.1:<br /></p><div class="codebox"><pre><code>root@OpenWrt:/# ping 192.168.1.1
PING 192.168.1.1 (192.168.1.1): 56 data bytes
ping: sendto: Network is unreachable</code></pre></div><p>/etc/config/network<br /></p><div class="codebox"><pre><code>root@OpenWrt:/# cat /etc/config/network

config interface &#039;loopback&#039;
        option ifname &#039;lo&#039;
        option proto &#039;static&#039;
        option ipaddr &#039;127.0.0.1&#039;
        option netmask &#039;255.0.0.0&#039;

config globals &#039;globals&#039;
        option ula_prefix &#039;fd01:e58b:ddcc::/48&#039;

config interface &#039;lan&#039;
        option ifname &#039;eth1&#039;
        option force_link &#039;1&#039;
        option type &#039;bridge&#039;
        option proto &#039;static&#039;
        option ipaddr &#039;192.168.1.1&#039;
        option netmask &#039;255.255.255.0&#039;
        option ip6assign &#039;60&#039;

config interface &#039;wan&#039;
        option ifname &#039;eth0&#039;
        option proto &#039;dhcp&#039;

config interface &#039;wan6&#039;
        option ifname &#039;@wan&#039;
        option proto &#039;dhcpv6&#039;

root@OpenWrt:/# </code></pre></div><p>ifconfig -a<br /></p><div class="codebox"><pre><code>root@OpenWrt:/# ifconfig -a
eth0      Link encap:Ethernet  HWaddr 02:10:18:78:54:01  
          inet6 addr: fe80::10:18ff:fe78:5401/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:27 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:8314 (8.1 KiB)

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

root@OpenWrt:/# </code></pre></div><p>My Ubuntu uses a static IP of 192.168.1.100, netmask of 255.255.255.0 and gateway of 192.168.1.1</p><p>Another problem I have is that occasionally when I flash it gives me the following error when I boot:<br /></p><div class="codebox"><pre><code>[   11.300000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00fe0000: 0x8936 instead
[   11.308000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00fe0004: 0x2728 instead
[   11.320000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00fe0008: 0x5b5d instead
[   11.328000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00fe000c: 0xe19f instead
[   11.340000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00fe0010: 0x2fd2 instead
[   11.348000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00fe0014: 0x5647 instead
[   11.360000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00fe0018: 0x308d instead
[   11.368000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00fe001c: 0xd118 instead
[   11.380000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00fe0020: 0x6e75 instead
[   11.388000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00fe0024: 0xad68 instead
[   11.396000] jffs2: Further such events for this erase block will not be printed
[   11.428000] jffs2: Old JFFS2 bitmask found at 0x00fee908
[   11.436000] jffs2: You cannot use older JFFS2 filesystems with newer kernels
[   11.444000] jffs2_scan_eraseblock(): End of filesystem marker found at 0xff0000
[   11.452000] jffs2_build_filesystem(): unlocking the mtd device... done.
[   11.456000] jffs2_build_filesystem(): erasing all blocks after the end marker... </code></pre></div><p>When I reflash it the error goes away.</p><p>cat /proc/mtd (reflashed):<br /></p><div class="codebox"><pre><code>root@OpenWrt:/# cat /proc/mtd
dev:    size   erasesize  name
mtd0: 00010000 00010000 &quot;CFE&quot;
mtd1: 0010ff00 00010000 &quot;kernel&quot;
mtd2: 01ed0000 00010000 &quot;rootfs&quot;
mtd3: 01ce0000 00010000 &quot;rootfs_data&quot;
mtd4: 00010000 00010000 &quot;nvram&quot;
mtd5: 01fe0000 00010000 &quot;linux&quot;</code></pre></div><p>Any help/advice/comments/questions are much appreciated!</p><p>Thank you!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235760">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">qasdfdsaq</div>
					<div class="post-datetime">
						5 Jun 2014, 19:03					</div>
				</div>
				<div class="post-content content">
					<p>From the bootlog:<br /></p><div class="codebox"><pre><code>ifconfig: SIOCGIFFLAGS: No such device</code></pre></div><p>Seems to indicate it is failing to detect/probe the eth1 interface, to which your 192.168.1.1/LAN IP is assigned.</p><p>I can&#039;t find any info on 96318VX_P400 specifically but the closest I found was this:<br /><a href="http://wiki.openwrt.org/toh/zyxel/vmg1312-b30a">http://wiki.openwrt.org/toh/zyxel/vmg1312-b30a</a><br />Supposedly it has 4 LAN ports and no WAN port (but some 2-port &quot;LAN Transformer&quot;?)</p><p>Given that you have an eth port assigned as WAN in your configuration I would suspect the default switch/interface configuration is not correct for your device. What is the actual (true) port configuration on your device?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235770">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">thom1337</div>
					<div class="post-datetime">
						5 Jun 2014, 19:47					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>qasdfdsaq wrote:</cite><blockquote><p>From the bootlog:<br /></p><div class="codebox"><pre><code>ifconfig: SIOCGIFFLAGS: No such device</code></pre></div><p>Seems to indicate it is failing to detect/probe the eth1 interface, to which your 192.168.1.1/LAN IP is assigned.</p><p>I can&#039;t find any info on 96318VX_P400 specifically but the closest I found was this:<br /><a href="http://wiki.openwrt.org/toh/zyxel/vmg1312-b30a">http://wiki.openwrt.org/toh/zyxel/vmg1312-b30a</a><br />Supposedly it has 4 LAN ports and no WAN port (but some 2-port &quot;LAN Transformer&quot;?)</p><p>Given that you have an eth port assigned as WAN in your configuration I would suspect the default switch/interface configuration is not correct for your device. What is the actual (true) port configuration on your device?</p></blockquote></div><p>There is no WAN port, I&#039;ll try to assign the WAN to one of the Ethernet ports now, which might take me a while to do.<br />These are the ports on the router:<br /><span class="postimg"><img src="http://maarseveent.com/private/20140605_174504.jpg" alt="http://maarseveent.com/private/20140605_174504.jpg" /></span></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235794">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">qasdfdsaq</div>
					<div class="post-datetime">
						6 Jun 2014, 00:12					</div>
				</div>
				<div class="post-content content">
					<p>It shouldn&#039;t take too long. If there is no WAN port then the default two-interface config is the problem. Presumably the four RJ45 ports in your picture are all on one ethernet switch, which goes by the interface of eth0, and eth1 does not exist.</p><p>Just change eth1 to eth0 in the lan section and remove the wan section completely.</p>											<p class="post-edited">(Last edited by <strong>qasdfdsaq</strong> on 6 Jun 2014, 00:13)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236593">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">thom1337</div>
					<div class="post-datetime">
						13 Jun 2014, 03:48					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>qasdfdsaq wrote:</cite><blockquote><p>It shouldn&#039;t take too long. If there is no WAN port then the default two-interface config is the problem. Presumably the four RJ45 ports in your picture are all on one ethernet switch, which goes by the interface of eth0, and eth1 does not exist.</p><p>Just change eth1 to eth0 in the lan section and remove the wan section completely.</p></blockquote></div><p>Thanks for the help. I tried doing so, I can now ping 192.168.1.1 internally (through serial) but I can&#039;t ping it from my computer. (With a static IP of 192.168.1.100, gateway 192.168.1.1)</p>											<p class="post-edited">(Last edited by <strong>thom1337</strong> on 13 Jun 2014, 03:48)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236670">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">qasdfdsaq</div>
					<div class="post-datetime">
						13 Jun 2014, 16:59					</div>
				</div>
				<div class="post-content content">
					<p>Did you try all the ethernet ports or just one? I do suspect that, given the default interface configuration is wrong, the switch configuration may also need tweaking, as, so far, it seems there is no switch config at all. However the bootlog doesn&#039;t indicate any detection of a separate switch.</p><p>Are you able to do, e.g. wireshark on another machine connected to the router, while pinging anything (e.g. 192.168.1.255) from the serial interface? Does anything come up? Do the network LEDs blink at all?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236673">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">thom1337</div>
					<div class="post-datetime">
						13 Jun 2014, 17:33					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>qasdfdsaq wrote:</cite><blockquote><p>Did you try all the ethernet ports or just one? I do suspect that, given the default interface configuration is wrong, the switch configuration may also need tweaking, as, so far, it seems there is no switch config at all. However the bootlog doesn&#039;t indicate any detection of a separate switch.</p><p>Are you able to do, e.g. wireshark on another machine connected to the router, while pinging anything (e.g. 192.168.1.255) from the serial interface? Does anything come up? Do the network LEDs blink at all?</p></blockquote></div><p>All of the ethernet ports give the same message:<br /></p><div class="codebox"><pre><code>From 192.168.1.100 icmp_seq=35 Destination Host Unreachable</code></pre></div><p>... and none of the network LEDs come up.</p><p>I&#039;m going to give wireshark/switch configuration a try now, thank you!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236677">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">qasdfdsaq</div>
					<div class="post-datetime">
						13 Jun 2014, 18:20					</div>
				</div>
				<div class="post-content content">
					<p>If the network LEDs don&#039;t light up Wireshark is unlikely to help, I&#039;m guessing the switch/ports haven&#039;t been initialised properly. Though most routers have a default switch config that just forwards everything out on every port if there is no switch driver installed.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236715">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">thom1337</div>
					<div class="post-datetime">
						14 Jun 2014, 02:00					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>qasdfdsaq wrote:</cite><blockquote><p>If the network LEDs don&#039;t light up Wireshark is unlikely to help, I&#039;m guessing the switch/ports haven&#039;t been initialised properly. Though most routers have a default switch config that just forwards everything out on every port if there is no switch driver installed.</p></blockquote></div><p>Thanks a lot for all the help, I managed to figure out the problem. I disabled the firewall and everything started working! Going to read the instructions on how to configure it properly tomorrow.</p>											<p class="post-edited">(Last edited by <strong>thom1337</strong> on 14 Jun 2014, 02:00)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p245529">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">dmcdonnell</div>
					<div class="post-datetime">
						31 Aug 2014, 23:54					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>thom1337 wrote:</cite><blockquote><p>Hi all,</p><p>I have managed to flash OpenWRT to my 963168VX_P400 board..........</p></blockquote></div><p>I wonder how you built the image to flash? I have a similar board and have unlocked the CFE. My board id 963268VX. I would like to try building an image from Trunk - openwrt-963168VX-squashfs-cfe.bin</p><p>Thank you in anticipation.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>