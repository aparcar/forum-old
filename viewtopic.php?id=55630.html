<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> VPN Appliance (OpenVPN)</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 24 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p264449">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">RangerZ</div>
					<div class="post-datetime">
						7 Feb 2015, 04:11					</div>
				</div>
				<div class="post-content content">
					<p>I am looking to build an OpenVPN appliance into an environment as follows:</p><p>Internet &lt;=&gt;&nbsp; Router&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@192.168.1.1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;=&gt; VPN Appliance @192.168.1.15<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DHCP&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 192.168.1.100-110&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TAP&nbsp; (1189)&nbsp; &nbsp; &nbsp; &nbsp; 192.168.1.200 -210<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Static Leases&nbsp; 192.168.1.2-99&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TUN&nbsp; (1190)&nbsp; &nbsp; &nbsp; &nbsp;192.168.3.0/24 (?)</p><p>I want TAP for Windows, and TUN for my IOS.&nbsp; I have this substantially working on a device configured as a router, but want to separate the functions.&nbsp; Performance is fair.&nbsp; &nbsp;Does anyone think that this will negatively impact performance?</p><p>I am using a PC Engines ALIX on CC 44070.&nbsp; There are two ports, eth0 and eth1, and I only plan to use 1 (unless I can use 2 router ports and improve performance somehow.&nbsp; Dreaming I&#039;m sure).&nbsp; The router will be a Buffalo WZR-HP-G300NH.&nbsp; I have a DD-WRT in service that has over 20 static leases and other config that I would rather not have to duplicate right off, but I do have a spare of the same with AA 12.09 on it (Having issues with static leases however, but can work around that)</p><p>I have not found a &quot;Recipe&quot; for this, but have found two posts that create APs which I think is a small part of the solution.&nbsp; I think that this can be done with the network, dhcp and firewall files.&nbsp; </p><p>I am very new to openWRT, so please, I need some level of detail more than add an XYZ section.</p><p>I promise to write this up for the Community Documentation. </p><p>from <a href="http://wiki.openwrt.org/doc/recipes/bridgedap">http://wiki.openwrt.org/doc/recipes/bridgedap</a></p><p>/etc/config/network <br />====================<br />config interface loopback &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ?????<br />&nbsp; &nbsp; &nbsp;option ifname lo <br />&nbsp; &nbsp; &nbsp;option proto static <br />&nbsp; &nbsp; &nbsp;option ipaddr 127.0.0.1 <br />&nbsp; &nbsp; &nbsp;option netmask 255.0.0.0 </p><p>config interface lan &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Using this would give me a guaranteed IP and a single connection<br />&nbsp; &nbsp; &nbsp;option ifname eth0 <br />&nbsp; &nbsp; &nbsp;option type bridge <br />&nbsp; &nbsp; &nbsp;option proto static <br />&nbsp; &nbsp; &nbsp;option ipaddr 192.168.1.15 <br />&nbsp; &nbsp; &nbsp;option netmask 255.255.255.0 <br />&nbsp; &nbsp; &nbsp;option gateway 192.168.1.1 <br />&nbsp; &nbsp; &nbsp;option dns 192.168.1.1 </p><p>from <a href="http://wiki.openwrt.org/doc/recipes/dumbap">http://wiki.openwrt.org/doc/recipes/dumbap</a></p><p>config interface lan &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Using this might not get me an IP and two connections<br />&nbsp; &nbsp; &nbsp;option type &#039;bridge&#039; <br />&nbsp; &nbsp; &nbsp;option ifname &#039;eth0 eth1&#039;&nbsp; &nbsp;# Bridges lan and wan <br />&nbsp; &nbsp; &nbsp;option proto &#039;dhcp&#039;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Change as appropriate<br />&nbsp; &nbsp; &nbsp;<br />I think the sections </p><p>config interface &#039;wan&#039;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Don&#039;t need a WAN<br />&nbsp; &nbsp; option ifname &#039;eth0&#039;<br />&nbsp; &nbsp; option proto &#039;dhcp&#039;</p><p>config interface &#039;wan6&#039;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Don&#039;t need an IPV6 WAN either<br />&nbsp; &nbsp; option ifname &#039;eth0&#039;<br />&nbsp; &nbsp; option proto &#039;dhcpv6&#039;</p><p>can go away</p><p>I have the following for the VPN TUN config.</p><p>config route&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Points Traffic for the TUN back to the LAN<br />&nbsp; &nbsp; option interface &#039;lan&#039;<br />&nbsp; &nbsp; option target &#039;192.168.1.1&#039;<br />&nbsp; &nbsp; option gateway &#039;192.168.3.1&#039;<br />&nbsp; &nbsp; option metric &#039;1&#039;</p><p>config interface &#039;tun0&#039;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Configures the TUN interface<br />&nbsp; &nbsp; option ifname &#039;tun0&#039;<br />&nbsp; &nbsp; option proto &#039;none&#039;</p><p>and then a globals section</p><p>config globals &#039;globals&#039;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ????????????<br />&nbsp; &nbsp; option ula_prefix &#039;fd62:858f:22ee::/48&#039;</p><br /><p>/etc/config/dhcp&nbsp; <br />================<br />config dnsmasq&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ???????????<br />&nbsp; &nbsp; option domainneeded &#039;1&#039;<br />&nbsp; &nbsp; option boguspriv &#039;1&#039;<br />&nbsp; &nbsp; option localise_queries &#039;1&#039;<br />&nbsp; &nbsp; option rebind_protection &#039;1&#039;<br />&nbsp; &nbsp; option rebind_localhost &#039;1&#039;<br />&nbsp; &nbsp; option local &#039;/lan/&#039;<br />&nbsp; &nbsp; option domain &#039;lan&#039;<br />&nbsp; &nbsp; option expandhosts &#039;1&#039;<br />&nbsp; &nbsp; option authoritative &#039;1&#039;<br />&nbsp; &nbsp; option readethers &#039;1&#039;<br />&nbsp; &nbsp; option leasefile &#039;/tmp/dhcp.leases&#039;<br />&nbsp; &nbsp; option resolvfile &#039;/tmp/resolv.conf.auto&#039;<br />&nbsp; &nbsp; option localservice &#039;1&#039;</p><p>config dhcp &#039;lan&#039;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ??????????<br />&nbsp; &nbsp; option interface &#039;lan&#039;<br />&nbsp; &nbsp; option leasetime &#039;12h&#039;<br />&nbsp; &nbsp; option dhcpv6 &#039;server&#039;<br />&nbsp; &nbsp; option ra &#039;server&#039;<br />&nbsp; &nbsp; option ra_management &#039;1&#039;<br />&nbsp; &nbsp; option limit &#039;25&#039;<br />&nbsp; &nbsp; option start &#039;150&#039;</p><p>config dhcp &#039;wan&#039;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Delete, no WAN<br />&nbsp; &nbsp; option interface &#039;wan&#039;<br />&nbsp; &nbsp; option ignore &#039;1&#039;</p><p>config odhcpd &#039;odhcpd&#039;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Not a clue what this is<br />&nbsp; &nbsp; option maindhcp &#039;0&#039;<br />&nbsp; &nbsp; option leasefile &#039;/tmp/hosts/odhcpd&#039;<br />&nbsp; &nbsp; option leasetrigger &#039;/usr/sbin/odhcpd-update&#039;</p><p>What do I need in the DHCP File?&nbsp; I want DHCP done by the Primary Router.&nbsp; While I generally prefer to use static leases, I am concerned I may run into an issue accessing the device if I do so.&nbsp; </p><p>/etc/config/firewall<br />=====================<br />config defaults&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; KEEP<br />&nbsp; &nbsp; option syn_flood &#039;1&#039;<br />&nbsp; &nbsp; option input &#039;ACCEPT&#039;<br />&nbsp; &nbsp; option output &#039;ACCEPT&#039;<br />&nbsp; &nbsp; option forward &#039;REJECT&#039;</p><p>config zone&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; KEEP<br />&nbsp; &nbsp; option name &#039;lan&#039;<br />&nbsp; &nbsp; option input &#039;ACCEPT&#039;<br />&nbsp; &nbsp; option output &#039;ACCEPT&#039;<br />&nbsp; &nbsp; option forward &#039;ACCEPT&#039;<br />&nbsp; &nbsp; option network &#039;lan&#039;</p><p>config zone&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DELETE<br />&nbsp; &nbsp; option name &#039;wan&#039;<br />&nbsp; &nbsp; option output &#039;ACCEPT&#039;<br />&nbsp; &nbsp; option forward &#039;REJECT&#039;<br />&nbsp; &nbsp; option masq &#039;1&#039;<br />&nbsp; &nbsp; option mtu_fix &#039;1&#039;<br />&nbsp; &nbsp; option input &#039;REJECT&#039;<br />&nbsp; &nbsp; option network &#039;wan wan6&#039;</p><p>config rule&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DELETE<br />&nbsp; &nbsp; option name &#039;Allow-DHCP-Renew&#039;<br />&nbsp; &nbsp; option src &#039;wan&#039;<br />&nbsp; &nbsp; option proto &#039;udp&#039;<br />&nbsp; &nbsp; option dest_port &#039;68&#039;<br />&nbsp; &nbsp; option target &#039;ACCEPT&#039;<br />&nbsp; &nbsp; option family &#039;ipv4&#039;</p><p>config rule&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ????<br />&nbsp; &nbsp; option name &#039;Allow-Ping&#039;<br />&nbsp; &nbsp; option src &#039;wan&#039;<br />&nbsp; &nbsp; option proto &#039;icmp&#039;<br />&nbsp; &nbsp; option icmp_type &#039;echo-request&#039;<br />&nbsp; &nbsp; option family &#039;ipv4&#039;<br />&nbsp; &nbsp; option target &#039;ACCEPT&#039;</p><p>config rule&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DELETE???<br />&nbsp; &nbsp; option name &#039;Allow-DHCPv6&#039;<br />&nbsp; &nbsp; option src &#039;wan&#039;<br />&nbsp; &nbsp; option proto &#039;udp&#039;<br />&nbsp; &nbsp; option src_ip &#039;fe80::/10&#039;<br />&nbsp; &nbsp; option src_port &#039;547&#039;<br />&nbsp; &nbsp; option dest_ip &#039;fe80::/10&#039;<br />&nbsp; &nbsp; option dest_port &#039;546&#039;<br />&nbsp; &nbsp; option family &#039;ipv6&#039;<br />&nbsp; &nbsp; option target &#039;ACCEPT&#039;</p><p>config rule&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DELETE???<br />&nbsp; &nbsp; option name &#039;Allow-ICMPv6-Input&#039;<br />&nbsp; &nbsp; option src &#039;wan&#039;<br />&nbsp; &nbsp; option proto &#039;icmp&#039;<br />&nbsp; &nbsp; list icmp_type &#039;echo-request&#039;<br />&nbsp; &nbsp; list icmp_type &#039;echo-reply&#039;<br />&nbsp; &nbsp; list icmp_type &#039;destination-unreachable&#039;<br />&nbsp; &nbsp; list icmp_type &#039;packet-too-big&#039;<br />&nbsp; &nbsp; list icmp_type &#039;time-exceeded&#039;<br />&nbsp; &nbsp; list icmp_type &#039;bad-header&#039;<br />&nbsp; &nbsp; list icmp_type &#039;unknown-header-type&#039;<br />&nbsp; &nbsp; list icmp_type &#039;router-solicitation&#039;<br />&nbsp; &nbsp; list icmp_type &#039;neighbour-solicitation&#039;<br />&nbsp; &nbsp; list icmp_type &#039;router-advertisement&#039;<br />&nbsp; &nbsp; list icmp_type &#039;neighbour-advertisement&#039;<br />&nbsp; &nbsp; option limit &#039;1000/sec&#039;<br />&nbsp; &nbsp; option family &#039;ipv6&#039;<br />&nbsp; &nbsp; option target &#039;ACCEPT&#039;</p><p>config rule&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DELETE???<br />&nbsp; &nbsp; option name &#039;Allow-ICMPv6-Forward&#039;<br />&nbsp; &nbsp; option src &#039;wan&#039;<br />&nbsp; &nbsp; option dest &#039;*&#039;<br />&nbsp; &nbsp; option proto &#039;icmp&#039;<br />&nbsp; &nbsp; list icmp_type &#039;echo-request&#039;<br />&nbsp; &nbsp; list icmp_type &#039;echo-reply&#039;<br />&nbsp; &nbsp; list icmp_type &#039;destination-unreachable&#039;<br />&nbsp; &nbsp; list icmp_type &#039;packet-too-big&#039;<br />&nbsp; &nbsp; list icmp_type &#039;time-exceeded&#039;<br />&nbsp; &nbsp; list icmp_type &#039;bad-header&#039;<br />&nbsp; &nbsp; list icmp_type &#039;unknown-header-type&#039;<br />&nbsp; &nbsp; option limit &#039;1000/sec&#039;<br />&nbsp; &nbsp; option family &#039;ipv6&#039;<br />&nbsp; &nbsp; option target &#039;ACCEPT&#039;</p><p>config include&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; KEEP<br />&nbsp; &nbsp; option path &#039;/etc/firewall.user&#039;</p><p>config include &#039;miniupnpd&#039;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DELETE module<br />&nbsp; &nbsp; option type &#039;script&#039;<br />&nbsp; &nbsp; option path &#039;/usr/share/miniupnpd/firewall.include&#039;<br />&nbsp; &nbsp; option family &#039;any&#039;<br />&nbsp; &nbsp; option reload &#039;1&#039;</p><p>config forwarding&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DELETE/MOVE TO ROUTER<br />&nbsp; &nbsp; option dest &#039;wan&#039;<br />&nbsp; &nbsp; option src &#039;lan&#039;</p><p>config rule&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOVE TO ROUTER<br />&nbsp; &nbsp; option name &#039;Allow_VPN_TAP&#039;<br />&nbsp; &nbsp; option target &#039;ACCEPT&#039;<br />&nbsp; &nbsp; option dest_port &#039;1190&#039;<br />&nbsp; &nbsp; option src &#039;wan&#039;<br />&nbsp; &nbsp; option proto &#039;udp&#039;<br />&nbsp; &nbsp; option family &#039;ipv4&#039;</p><p>config redirect&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOVE TO ROUTER<br />&nbsp; &nbsp; option target &#039;DNAT&#039;<br />&nbsp; &nbsp; option src &#039;wan&#039;<br />&nbsp; &nbsp; option dest &#039;lan&#039;<br />&nbsp; &nbsp; option proto &#039;udp&#039;<br />&nbsp; &nbsp; option src_dport &#039;1190&#039;<br />&nbsp; &nbsp; option dest_ip &#039;192.168.15.1&#039;<br />&nbsp; &nbsp; option dest_port &#039;1190&#039;<br />&nbsp; &nbsp; option name &#039;OpenVPN_TAP&#039;</p><p>config redirect&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOVE TO ROUTER<br />&nbsp; &nbsp; option enabled &#039;1&#039;<br />&nbsp; &nbsp; option target &#039;DNAT&#039;<br />&nbsp; &nbsp; option src &#039;wan&#039;<br />&nbsp; &nbsp; option dest &#039;lan&#039;<br />&nbsp; &nbsp; option proto &#039;udp&#039;<br />&nbsp; &nbsp; option src_dport &#039;1189&#039;<br />&nbsp; &nbsp; option dest_ip &#039;192.168.15.1&#039;<br />&nbsp; &nbsp; option dest_port &#039;1189&#039;<br />&nbsp; &nbsp; option name &#039;OpenVPN_TUN&#039;</p><p>config rule&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOVE TO ROUTER<br />&nbsp; &nbsp; option name &#039;Allow_VPN_TUN&#039;<br />&nbsp; &nbsp; option target &#039;ACCEPT&#039;<br />&nbsp; &nbsp; option dest_port &#039;1189&#039;<br />&nbsp; &nbsp; option src &#039;wan&#039;<br />&nbsp; &nbsp; option proto &#039;udp&#039;<br />&nbsp; &nbsp; option family &#039;ipv4&#039;</p><p>config zone&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; KEEP<br />&nbsp; &nbsp; &nbsp; &nbsp; option name&nbsp; &nbsp; &nbsp; &nbsp; &#039;vpn_tunnel&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; list&nbsp; &nbsp;network&nbsp; &nbsp; &nbsp;&#039;tun0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option input&nbsp; &nbsp; &nbsp; &nbsp;&#039;ACCEPT&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option output&nbsp; &nbsp; &nbsp; &#039;ACCEPT&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option forward&nbsp; &nbsp; &nbsp;&#039;ACCEPT&#039;</p><p>config forwarding&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; KEEP<br />&nbsp; &nbsp; &nbsp; &nbsp; option src&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option dest&nbsp; &nbsp; &nbsp; &nbsp; &#039;vpn_tunnel&#039;<br />&nbsp; &nbsp; <br />config forwarding&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; KEEP<br />&nbsp; &nbsp; &nbsp; &nbsp; option src&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#039;vpn_tunnel&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option dest&nbsp; &nbsp; &nbsp; &nbsp; &#039;lan&#039;</p><p>config forwarding&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ?????&nbsp; How do I get the TUN traffic back to the internet?<br />&nbsp; &nbsp; &nbsp; &nbsp; option src&nbsp; &nbsp; &nbsp; &nbsp; &#039;vpn_tunnel&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option dest&nbsp; &nbsp; &nbsp; &nbsp;&#039;wan&#039; </p><p>Equaly as unclear about the firewalls.&nbsp; </p><p>I think the last config forward can go as there is no WAN on the appliance.<br />I expect to have a vpn_tunnel zone and lan zone, so I need those rules.<br />I think some of the rules need to go to the primary router. (redirect DNAT and rule Allow_VPN_TUN\TAP)<br />Not sure how to configure the rules between the router and the appliance.&nbsp; I assume its LAN-router to LAN-appliance, WAN is not relevant until traffic is on the Primary Router.<br />Do I need to have a different zone name for the appliance LAN? (LAN-A)<br />I assume on the Router I need something to pass all traffic on the OpenVPN Ports to the Appliance (Port forward)<br />&nbsp; &nbsp; Proto UDP<br />&nbsp; &nbsp; port 1189, 1190<br />&nbsp; &nbsp; from IP 192.168.1.1<br />&nbsp; &nbsp; To IP 192.168.1.15<br />&nbsp; &nbsp; <br />What am I not thinking of?</p><p>I would rather edit files directly vs using UCI commands.</p><p>Thanks... RangerZ</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>