<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Sky Wireless Booster - AirTies Air4400</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 22 Apr 2018 and 24 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=48201&amp;p=2.html">2</a></li></ul></nav></div>
			
		
		
			<article class="post" id="p221685">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">ant_thomas</div>
					<div class="post-datetime">
						5 Jan 2014, 02:00					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>Sky in the UK are giving away free wireless extenders. These are in fact AirTies Air4400 wireless extenders. Unfortunately they don&#039;t have any official Access Point mode which makes it useless to me. </p><p>Does anyone if it would be possible to run any form of OpenWRT on them?</p><p>It is BCM5357 based.</p><p>I&#039;ve taken photos of the internals if they&#039;re of any interest.</p><p><a href="http://imgur.com/a/GrsDZ/">http://imgur.com/a/GrsDZ/</a></p>											<p class="post-edited">(Last edited by <strong>ant_thomas</strong> on 5 Jan 2014, 02:00)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p221686">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">FriedZombie</div>
					<div class="post-datetime">
						5 Jan 2014, 02:19					</div>
				</div>
				<div class="post-content content">
					<p>Well it does have 8mb flash memory and 32mb ram memory (according to the pics).<br />And looks more or less similar to the <a href="http://wiki.openwrt.org/toh/d-link/dir-615">dir615 k1</a>.<br />As well it does seem to have an uart/ttl (j2) and a jtag (j1) header (unpopulated).</p><p>It looks possible to get openwrt running on this.</p><p>according to the sticker it is an <a href="http://www.airties.com/products/wap/Air4400">air4400</a><br />Official firmware <a href="http://www.airties.com/firmwares/AirTies_Air4400_FW_1.6.0.9.bin">AirTies_Air4400_FW_1.6.0.9.bin</a><br /><a href="http://pastebin.com/raw.php?i=auZiDcCY">Binwalk output</a> from the AirTies_Air4400_FW_1.6.0.9.bin</p><p>Pinout based on image, a square is always pin 1 (<span style="color: red"><strong>pinout can be incorrect</strong></span> be sure to measure).<br />J2:<br /></p><div class="codebox"><pre><code>1 = RX
2 = gnd
3 = Vcc
4 = gnd
5 = TX</code></pre></div><p><strong><span style="color: red">pinout can be incorrect</span></strong> be sure to measure it don&#039;t connect the Vcc and use a ttl adapter and not a com/rs232 port directly. The logic levels are 3.3v</p>											<p class="post-edited">(Last edited by <strong>FriedZombie</strong> on 7 Jan 2014, 00:02)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p221689">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">ant_thomas</div>
					<div class="post-datetime">
						5 Jan 2014, 03:24					</div>
				</div>
				<div class="post-content content">
					<p>Well that looks promising.</p><p>I don&#039;t think I currently have a ttl adapter but could probably do with buying one anyway. I do have some Raspberry Pis which run on 3.3V logic and have TTL pins if I could use on of those for diagnostic purposes.</p><p>What could I do that would be useful for helping port Open-WRT to it?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p221813">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">FriedZombie</div>
					<div class="post-datetime">
						6 Jan 2014, 14:59					</div>
				</div>
				<div class="post-content content">
					<p>I was a bout to type a lengthy step by step guide on how to check my pinout, but somehow I don&#039;t think that&#039;s really <a href="https://pbs.twimg.com/media/BdEnkUIIcAA7qMZ.jpg:large">needed</a> <img src="https://forum.openwrt.org/img/smilies/tongue.png" width="15" height="15" alt="tongue" /></p><p>But basically double check my findings (since I don&#039;t have the actual device). and capture a bootlog <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> (the pi will work fine for that).</p><p>Also do you have access to some kind of web interface by any chance? it could be that you have to set your computer manually to 192.168.1.10 and see if there is web interface on 192.168.1.1 (or similar).</p><br /><p>And the uboot env would be nice as well <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> in the u-boot console the command is: printenv</p>											<p class="post-edited">(Last edited by <strong>FriedZombie</strong> on 6 Jan 2014, 15:33)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p221836">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">ant_thomas</div>
					<div class="post-datetime">
						6 Jan 2014, 20:53					</div>
				</div>
				<div class="post-content content">
					<p>Good find! I would place myself very much at the bottom of the amateur ladder so any step by step would certainly be followed but I&#039;m confident enough to give it a go...!</p><p>Yes, there&#039;s a web interface. Not many options.</p><p>Connect to a different router<br />Wireless Security Settings<br />Firmware update (current firmware Firmware Version:1.0.0.31)</p><p>Anything helpful I could do regarding the web interface?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p221842">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">ant_thomas</div>
					<div class="post-datetime">
						6 Jan 2014, 21:49					</div>
				</div>
				<div class="post-content content">
					<p>Here&#039;s the boot output - <a href="http://paste.ubuntu.com/6705097/">http://paste.ubuntu.com/6705097/</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p221854">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">ant_thomas</div>
					<div class="post-datetime">
						7 Jan 2014, 00:08					</div>
				</div>
				<div class="post-content content">
					<p>How do I get the uboot env?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p221858">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						7 Jan 2014, 00:27					</div>
				</div>
				<div class="post-content content">
					<p>type ctrl+c when you see &quot;waiting for magic...&quot;</p>											<p class="post-edited">(Last edited by <strong>nebbia88</strong> on 7 Jan 2014, 00:27)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p221859">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">ant_thomas</div>
					<div class="post-datetime">
						7 Jan 2014, 00:32					</div>
				</div>
				<div class="post-content content">
					<p>Tried that and had a look around.</p><p>Available commands: et, reset, saveenv, setenv, getenv, readflash, writeflash, nvram, reboot, flash, batch, go, boot, load, save, airboot, airfw, airdt, ping, arp, ifconfig, show, help</p><div class="codebox"><pre><code>bcm5357 # getenv
(null)
*** command status = 0
bcm5357 # show devices
Device Name          Description
-------------------  ---------------------------------------------------------
uart0                NS16550 UART at 0x18000300
flash0.boot          ST Serial flash offset 00000000 size 128KB
flash0.nvrampad      ST Serial flash offset 00020000 size 32KB
flash0.nvram         ST Serial flash offset 00028000 size 96KB
flash0.config        ST Serial flash offset 00040000 size 64KB
flash0.asd           ST Serial flash offset 00050000 size 64KB
flash0.kernel        ST Serial flash offset 00060000 size 3904KB
flash0.rootfs        ST Serial flash offset 00430000 size 3904KB
flash1.boot          ST Serial flash offset 00000000 size 128KB
flash1.nvrampad      ST Serial flash offset 00020000 size 32KB
flash1.nvram         ST Serial flash offset 00028000 size 96KB
flash1.config        ST Serial flash offset 00040000 size 64KB
flash1.asd           ST Serial flash offset 00050000 size 64KB
flash1.kernel        ST Serial flash offset 00060000 size 3904KB
flash1.rootfs        ST Serial flash offset 00430000 size 3904KB
flash2.allflash      ST Serial flash offset 00000000 size 8192KB
eth0                 Broadcom BCM47XX 10/100/1000 Mbps Ethernet Controller
*** command status = 0

bcm5357 # help
Available commands:

et                  Broadcom Ethernet utility.
reset               Reboots the board
saveenv             Save all environment variables to nvram
setenv              Set a value to an mnram variable. Don&#039;t use &#039;=&#039; (equal) sign
getenv              Get an environment variable from nvram
readflash           Read flash&#039;s different partitions to a fixed memory address.
writeflash          Write to flash&#039;s different partitions from a fixed memory ad
dress.
nvram               NVRAM utility.
reboot              Reboot.
flash               Update a flash memory device
batch               Load a batch file into memory and execute it
go                  Verify and boot OS image.
boot                Load an executable file into memory and execute it
load                Load an executable file into memory without executing it
save                Save a region of memory to a remote file via TFTP
airboot             Start AirTies Boot Protocol
airfw               Start AirTies Firmware Protocol
airdt               Start AirTies Detect Protocol
ping                Ping a remote IP host.
arp                 Display or modify the ARP Table
ifconfig            Configure the Ethernet interface
show clocks         Show current values of the clocks.
show devices        Display information about the installed devices.
help                Obtain help for CFE commands

For more information about a command, enter &#039;help command-name&#039;
*** command status = 0
bcm5357 # nvram show
sb/1/ofdm2gpo=0x75555555
antswctl2g=0x1
boardrev=0x1162
sb/1/mcs2gpo0=0x5555
sb/1/mcs2gpo1=0x7755
et0macaddr=00:90:4c:08:02:2b
sb/1/mcs2gpo2=0x5555
sb/1/mcs2gpo3=0x7555
sb/1/mcs2gpo4=0x5555
sb/1/mcs2gpo5=0x7755
watchdog=0
boot_wait=on
sb/1/mcs2gpo6=0x5555
sb/1/temps_period=5
sb/1/mcs2gpo7=0x7555
sb/1/rssismc2g=0xf
et0mdcport=0
f_rootfs_end=0x007fffff
flashboot=NOR
reset_gpio=21
pmon_ver=CFE 5.100.138.20
sb/1/rssisav2g=0x7
sb/1/bxa2g=0x3
vlan2ports=0 5
sb/1/triso2g=0x5
sb/1/sromrev=8
rootfs_auto_size=0x002F6040
MAC_ETH_0=18:28:61:DB:19:C0
gpio7=wps_led
sb/1/pa2gw2a0=0xFA87
sb/1/pa2gw2a1=0xFA99
SERIAL_NUMBER=AT1581347042775
sb/1/tempthresh=120
wl_msglevel=0x1
sb/1/itt2ga0=0x20
sb/1/itt2ga1=0x20
f_config_addr=0x00040000
WPS_PIN_0=89001127
boardtype=0x058e
HW_REVISION=TW_0.3
et_swleds=0xd
lan_netmask=255.255.255.0
PRODUCT_ID=SB601
BOOT_DELAY=3
f_uboot_end=0x0001ffff
sb/1/regrev=0
sb/1/ag0=0x2
sb/1/ag1=0x2
f_kernel2_size=0x00379fc0
sb/1/ag2=0x2
sb/1/ag3=0xff
sb/1/rssismf2g=0xf
vlan2hwname=et0
sb/1/extpagain2g=0x2
nvram_revision=402
xtalfreq=20000
sb/1/stbcpo=0x0
boardflags2=0x1000
sb/1/bwduppo=0x0
sb/1/aa2g=0x3
sb/1/txchain=0x3
fwserver_addr=239.254.0.229
wait_time=3
f_uboot_addr=0x00000000
sb/1/pa2gw1a0=0x1648
f_kernel2_addr=0x00430000
sb/1/pa2gw1a1=0x1617
sb/1/boardflags2=0x1000
f_config_end=0x0004ffff
sb/1/boardflags=0x710
enable_mc_fw_upgrade=off
sb/1/leddc=0xffff
boot_flag=success
lan_ipaddr=192.168.2.1
STARTUP_SCRIPT=airboot
clkfreq=300,150,75
vlan1hwname=et0
sdram_config=0x103
vlan1ports=0 1 2 3 4 5
sb/1/temps_hysteresis=5
BOOTLOADER_VER=CFE_1.0.37
sb/1/macaddr=00:90:4c:08:12:2b
sb/1/ccode=0
boardflags=0x710
TELNET_ENABLED=OFF
sdram_refresh=0x8040
wandevs=vlan2
f_asd_end=0x0005ffff
sb/1/cck2gpo=0x0
sdram_ncdl=0x00000000
sb/1/pa2gw0a0=0xFE7C
sb/1/pa2gw0a1=0xFE82
Version=16777247
f_image_num=0
sb/1/bw40po=0x0
sb/1/devid=0x4329
f_kernel_size=0x00379fc0
f_asd_addr=0x00050000
et0phyaddr=30
MAC_WLAN_0=18:28:61:DB:19:C1
sb/1/pdetrange2g=0x2
landevs=vlan1 wl0
rootfs_auto_offset=0x00139FC0
sb/1/tssipos2g=0x1
sdram_init=0x0419
sb/1/antswctl2g=0x1
f_kernel_end=0x0042ffff
gpio20=wps_button
f_rootfs_addr=0x00430000
sb/1/tri2g=0xff
sb/1/ledbh0=11
sb/1/maxp2ga0=0x50
sb/1/ledbh1=11
sb/1/maxp2ga1=0x50
f_kernel_addr=0x00060000
sb/1/ledbh2=11
sb/1/ledbh3=11
sb/1/ledbh5=11
sb/1/cddpo=0x0
sb/1/ledbh6=11
sb/1/opo=0x0
sb/1/rxchain=0x3
sb/1/rxpo2g=0xff
boardnum=555
f_kernel2_end=0x007fffff
sb/1/antswitch=0x0
dualimage=enabled
size: 2468 bytes (30300 left)
*** command status = 0</code></pre></div>											<p class="post-edited">(Last edited by <strong>ant_thomas</strong> on 7 Jan 2014, 00:34)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p221877">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">Zajec</div>
					<div class="post-datetime">
						7 Jan 2014, 08:36					</div>
				</div>
				<div class="post-content content">
					<p>ant_thomas: forget about U-Boot, just use CFE, some short howto can be found on: <a href="http://wiki.openwrt.org/doc/techref/bootloader/cfe">http://wiki.openwrt.org/doc/techref/bootloader/cfe</a></p><p>It seems this device has some partitions that are not supported by bcm47xxpart. Please dump for me &quot;cfe&quot;, &quot;Config&quot; and &quot;ASD&quot; partitions. I think that:<br />cfe: /dev/mtdblock0<br />Config: /dev/mtdblock2<br />ASD: /dev/mtdblock3</p><p>If this device has USB, you can just dump them to some USB disk. Connect one, see where it&#039;s mounted (&quot;mount&quot; command) and dump mtdblock to it (cat /dev/mtdblock0 &gt; /mnt/pendrive/cfe.bin).</p><p>If devices doesn&#039;t have USB, you can try faking dump to be some image accessible over http. I think your http files are located in /webs/. If that is correct, you can try sth like &quot;cat /dev/mtdblock0 &gt; /webs/cfe.jpeg&quot; and then access it like <a href="http://192.168.1.1/cfe.jpeg">http://192.168.1.1/cfe.jpeg</a></p><p>If you provide dump of these partitions I&#039;ll try to add support for them in bcm47xxpart.</p>											<p class="post-edited">(Last edited by <strong>Zajec</strong> on 7 Jan 2014, 08:36)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p221896">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">ant_thomas</div>
					<div class="post-datetime">
						7 Jan 2014, 10:48					</div>
				</div>
				<div class="post-content content">
					<p>zajec: Thanks for the details, I&#039;ll sort that this evening.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p221976">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">Zajec</div>
					<div class="post-datetime">
						7 Jan 2014, 21:35					</div>
				</div>
				<div class="post-content content">
					<p>Some nvram entries that may be device specific:</p><div class="codebox"><pre><code>boardnum=555
boardrev=0x1162
boardtype=0x058e
HW_REVISION=TW_0.3
PRODUCT_ID=SB601</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p221977">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">FriedZombie</div>
					<div class="post-datetime">
						7 Jan 2014, 21:45					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Zajec wrote:</cite><blockquote><p>If you provide dump of these partitions I&#039;ll try to add support for them in bcm47xxpart.</p></blockquote></div><p>Sounds like a plan <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />, since I currently don&#039;t really have the time for it.<br />Also couldn&#039;t you dump the partitions to a tftp server as well?</p><p>Dumping it to the web directory is probably not going to work, since it is /var/unpacked/webs and it is loaded in ram only.<br />there exists a symlink from /webs -&gt; /var/unpacked/webs</p><p>The file that is unpacked onboot is /webs.tar.lzma</p><p>Also I wouldn&#039;t be surprised if the firmware I posted earlier for the airties 4400 just flashes, but it would be a good thing to have the partition dumps. There could always be hiding something interesting in it:)</p><p>p.s. Also sory for the u-boot cfe mixup <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>											<p class="post-edited">(Last edited by <strong>FriedZombie</strong> on 7 Jan 2014, 22:01)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p221979">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">ant_thomas</div>
					<div class="post-datetime">
						7 Jan 2014, 22:06					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Zajec wrote:</cite><blockquote><p>Some nvram entries that may be device specific:</p><div class="codebox"><pre><code>boardnum=555
boardrev=0x1162
boardtype=0x058e
HW_REVISION=TW_0.3
PRODUCT_ID=SB601</code></pre></div></blockquote></div><p>Did you get the dumps?</p><p>Copying to /webs seemed to work fine assuming the dumps are suitable.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p221981">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">FriedZombie</div>
					<div class="post-datetime">
						7 Jan 2014, 22:13					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>ant_thomas wrote:</cite><blockquote><p>Did you get the dumps?</p><p>Copying to /webs seemed to work fine assuming the dumps are suitable.</p></blockquote></div><p>Nope we both didn&#039;t you are the only one of us with a <em>sky wireless booster</em><br />If you dumped the images, I would share them on a file sharing site. I usually use google drive for sharing things like this.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p221982">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">ant_thomas</div>
					<div class="post-datetime">
						7 Jan 2014, 22:19					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>FriedZombie wrote:</cite><blockquote><p>Nope we both didn&#039;t you are the only one of us with a <em>sky wireless booster</em><br />If you dumped the images, I would share them on a file sharing site. I usually use google drive for sharing things like this.</p></blockquote></div><p>Sorry, that was supposed to be directed at Zajec. I&#039;ve sent them to him.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p221983">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">Zajec</div>
					<div class="post-datetime">
						7 Jan 2014, 22:23					</div>
				</div>
				<div class="post-content content">
					<p>I got the dumps, analyzing them. Thanks.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p222108">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">ant_thomas</div>
					<div class="post-datetime">
						8 Jan 2014, 22:22					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Zajec wrote:</cite><blockquote><p>I got the dumps, analyzing them. Thanks.</p></blockquote></div><p>Zajec: Have you managed to make any progress?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p222113">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">Zajec</div>
					<div class="post-datetime">
						8 Jan 2014, 23:01					</div>
				</div>
				<div class="post-content content">
					<p>Not much. So I&#039;ve analyzed your flash dump.<br />1) Standard CFE on 0x00000000 → 0x00200000<br />2) Main NVRAM on 0x00280000 → ...<br />3) Backup NVRAM on 0x00380000 → ...<br />4) Config on 0x00040000 → 0x00050000. Starts with:</p><div class="codebox"><pre><code>0004:0000 | E0 0D DC BA  67 4A 00 00  F2 4C 4C F6  31 7C 27 8D | à.ÜºgJ..òLLö1|&#039;.
0004:0010 | 3C 63 6F 6E  66 69 67 20  76 65 72 73  69 6F 6E 3D | &lt;config version=</code></pre></div><p>5) ASD on 0x00050000 → 0x00060000. Starts with:</p><div class="codebox"><pre><code>0005:0000 | E0 0D DC BA  E2 00 00 00  00 00 05 00  45 2E E6 33 | à.Üºâ.......E.æ3
0005:0010 | BD 93 A7 FC  63 75 72 72  65 6E 74 5F  6C 61 6E 67 | ½.§ücurrent_lang</code></pre></div><p>6) Kernel on 0x006000 →0x00139???. Starts with:</p><div class="codebox"><pre><code>0006:0000 | 5D 00 00 02  00 E8 BC 2A  00 00 00 00  00 00 00 24 | ]....è¼*.......$
0006:0010 | E0 C1 86 9C  B0 B1 53 C1  CF 25 27 9F  D5 69 C7 95 | àÁ..°±SÁÏ%&#039;.ÕiÇ.</code></pre></div><br /><p>And there is a part I&#039;ve no idea how to handle yet:</p><div class="codebox"><pre><code>0013:9F50 | 80 06 00 00  80 06 00 00  04 C2 0C 20  05 05 02 01 | .........Â. ....
0013:9F60 | 4C 69 6E 75  78 20 4B 65  72 6E 65 6C  20 49 6D 61 | Linux Kernel Ima
0013:9F70 | 67 65 00 00  00 00 00 00  00 00 00 00  00 00 00 00 | ge..............
0013:9F80 | 27 05 19 56  04 7C 5B E3  52 6A BE 76  00 2A 00 00 | &#039;..V.|[ãRj¾v.*..
0013:9F90 | 00 00 00 00  00 00 00 00  14 29 A2 B9  05 05 07 03 | .........)¢¹....
0013:9FA0 | 53 42 36 30  31 20 52 6F  6F 74 46 53  00 00 00 00 | SB601 RootFS....
0013:9FB0 | 00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00 | ................
0013:9FC0 | 73 68 73 71  F9 00 00 00  00 00 00 00  00 00 00 00 | shsqù...........
0013:9FD0 | 00 00 00 00  00 00 00 00  00 00 00 00  03 00 00 00 | ................
0013:9FE0 | 00 00 10 00  C0 01 00 76  BE 6A 52 F8  1E 00 00 00 | ....À..v¾jRø....</code></pre></div><p>(we have to somehow detect where squashfs starts).</p><p>We also have to figure out how to prepare a valid image.</p>											<p class="post-edited">(Last edited by <strong>Zajec</strong> on 8 Jan 2014, 23:11)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p222119">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						8 Jan 2014, 23:16					</div>
				</div>
				<div class="post-content content">
					<p>shsq is a marker of squashfs file system start?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p222123">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">Zajec</div>
					<div class="post-datetime">
						9 Jan 2014, 00:07					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nebbia88 wrote:</cite><blockquote><p>shsq is a marker of squashfs file system start?</p></blockquote></div><p>That&#039;s right, but it&#039;s located in the middle of flash block and we can&#039;t scan (read) every possible place looking for magics.</p><p>We should find/notice LZMA compressed kernel, go to it&#039;s end and see what&#039;s next. Unfortunately LZMA doesn&#039;t have a nice magic and AFAIK doesn&#039;t store compressed size in the header. What we can see in your flash:</p><div class="codebox"><pre><code>5D 00 00 02  00 E8 BC 2A  00 00 00 00  00</code></pre></div><p>is a LZMA header.</p><p>1) 0x02 = Properties<br />lc: 3, lp: 0, pb: 2</p><p>2) 0x0000005D = Dictionary Size</p><p>3) 0x000000002ABCE8 = Uncompressed Size<br />Decimal value is 2800872 (bytes)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p222125">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">ant_thomas</div>
					<div class="post-datetime">
						9 Jan 2014, 00:27					</div>
				</div>
				<div class="post-content content">
					<p>Zajec: Is there anything else you&#039;d like me to do? or dump?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p222221">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">Atarii</div>
					<div class="post-datetime">
						9 Jan 2014, 22:43					</div>
				</div>
				<div class="post-content content">
					<p>Wow, so I&#039;ve been independently analysing the Wireless Booster this week too and had no idea this thread existed! Anyway, looks like you guys have gone down a slightly different route than me (hooking up a serial cable was still on my todo list), but I&#039;ll contribute all my findings so far:</p><br /><p><strong>Enable Telnet</strong><br />Telnet is supported by the device, it&#039;s just disabled on boot. There is an nvram variable TELNET_ENABLED (as shown as TELNET_ENABLED=OFF in the log from ant_thomas). I believe that if you use &#039;setenv&#039; and &#039;saveenv&#039; commands in the CFE console to change it to TELNET_ENABLED=ON, it should work.</p><br /><p><strong>Firmware image</strong><br />You can download the firmware image directly from the update web servers. Follow a similar process as defined here: <a href="https://code.google.com/p/sky-router-tool/wiki/SagemFAST2504#Sky_Auto-Update">https://code.google.com/p/sky-router-to … uto-Update</a> </p><p>Navigate to:<br /><a href="http://sb601.skyfirmware.com/timecheck/?mac=XXXXXXXXXX&amp;firmwareVersion=1.0.0.31&amp;model=SB601&amp;product=skydsl">http://sb601.skyfirmware.com/timecheck/ … uct=skydsl</a> (replace XXXXXXXXXXwith a valid MAC address)<br />The response will contain something like: <a href="http://sb601.skyfirmware.com/?mac=XXXXXXXXXX&amp;firmwareVersion=1.0.0.31&amp;model=SB601&amp;product=skydsl">http://sb601.skyfirmware.com/?mac=XXXXX … uct=skydsl</a></p><p>And that will respond with a URL similar to <a href="http://download-ext.skyfirmware.com/S/AAAAAAAAAA/BBBBBBBBBBBB/download/firmware/sb601/AirTies_SB601_FW_1.0.0.31.bin">http://download-ext.skyfirmware.com/S/A … 0.0.31.bin</a> (AAA and BBB are a session)<br />That final URL will you will give the AirTies_SB601_FW_1.0.0.31.bin</p><p>This firmware image extracts nicely with &quot;binwalk -e AirTies_SB601_FW_1.0.0.31.bin&quot;:</p><div class="codebox"><pre><code>test@test:~/# ls
5C0 5C0.7z AirTies_SB601_FW_1.0.0.31.bin DA580.squashfs squashfs-root

test@test:~/# ls squashfs-root/
bin dev etc lib mnt proc ramdisk root sbin sys tmp usr var webs webs-admin webs-guest webs.tar.lzma</code></pre></div><p>The web.tar.gz is there (as you guys mentioned) and also extracts fine.</p><div class="codebox"><pre><code>test@test:~/# ls webs/
air.css config.bin global images invalid_host.html lan lang.js login.html main.html menu_frame.html report tools wireless wizard_model.js cgi-bin errors homepage.html index.html js lang licence_information.html loginmain.html management ncsi.txt style top.html wizard.html</code></pre></div><br /><p><strong>Addresses</strong><br />Theses addresses are stored in nvram (check for example f_rootfs_addr and f_rootfs_end):<br /></p><div class="codebox"><pre><code>uboot 0x00000000 - 0x0001ffff
config 0x00040000 - 0x0004ffff
asd 0x00050000 - 0x0005ffff
kernel 0x00060000 - 0x0042ffff
rootfs 0x00430000 - 0x007fffff</code></pre></div><p>They match some of the addresses you have already.</p><br /><p><strong>Config backup/restore</strong><br />As you guys have also noticed, this is a rebranded Airties 4400 and uses a skinned web interface. A lot of the original Airties web pages have been removed, but there are some still available (just the top navigation menu links disabled). All checks are done client-side by the Definitions.js file i.e. &quot;var __DEF_HideLan_Menu = true;&quot;. You can use a web proxy (such as Burp proxy) to modify the Definitions.js file, to re-enable the menus. The most interesting one here is the page to save/restore the config. To do this, change:</p><div class="codebox"><pre><code>var __DEF_ShowSaveConfigOnheToolsPage = false;
var __DEF_ShowRestoreConfigOnheToolsPage = false;</code></pre></div><p>to</p><div class="codebox"><pre><code>var __DEF_ShowSaveConfigOnheToolsPage = true;
var __DEF_ShowRestoreConfigOnheToolsPage = true;</code></pre></div><p>You can also enable the buttons in the webpage via Firebug or similar (they are hidden via display: none CSS).<br />Now when you go to Tools -&gt; you should see the Backup and Restore buttons. Backup will give you a config.bin file. This file is CRC checked on Restore, so you can&#039;t modify it and re-upload as far as I can tell.</p><p><span class="postimg"><img src="https://dl.dropboxusercontent.com/s/84zrechowghioco/BackupRestore.PNG" alt="https://dl.dropboxusercontent.com/s/84zrechowghioco/BackupRestore.PNG" /></span></p><p><strong>Enable syslog</strong><br />Using the same approach as above, you can enable the Report (syslog) menu by changing:</p><div class="codebox"><pre><code>var __DEF_HideMenuReport = 1; -&gt; var __DEF_HideMenuReport = 0;</code></pre></div><p>This will allow you to set a remote syslog server; useful for debugging.</p><br /><p><strong>Other useful hidden webapges</strong><br />/lan/ip_and_dhcp_settings.html<br />/lan/dhcp_setup.html<br />/lan/dhcp_client.html<br />/lan/operation_mode.html<br />/tools/sntp.html</p><br /><p><strong>Modify settings via SOAP API</strong><br />The web interface uses a SOAP (?) interface to save/query settings. You can use this same interface to edit the config file, it just requires a POST to /cgi-bin/webapp, with the correct XML.For example, to disable automatic updates:</p><div class="codebox"><pre><code>POST /cgi-bin/webapp

&lt;xmlrequest version=&quot;1.0.1&quot;&gt; 
&lt;command inst=&quot;cfgmgr-0&quot;&gt;&lt;key&gt;begin_transaction&lt;/key&gt;&lt;value&gt;http_upgrade_for_sky-0&lt;/value&gt;&lt;/command&gt; 
&lt;set inst=&quot;http_upgrade_for_sky-0&quot;&gt;&lt;key&gt;httpserverforfw&lt;/key&gt;&lt;value&gt;DISABLED/&lt;/value&gt;&lt;/set&gt; 
&lt;command inst=&quot;cfgmgr-0&quot;&gt;&lt;key&gt;commit&lt;/key&gt;&lt;value&gt;http_upgrade_for_sky-0&lt;/value&gt;&lt;/command&gt; 
&lt;command inst=&quot;cfgmgr-0&quot;&gt;&lt;key&gt;save&lt;/key&gt;&lt;value/&gt;&lt;/command&gt; 
&lt;command inst=&quot;cfgmgr-0&quot;&gt;&lt;key&gt;end_transaction&lt;/key&gt;&lt;value&gt;http_upgrade_for_sky-0&lt;/value&gt;&lt;/command&gt; 
&lt;/xmlrequest&gt;</code></pre></div><p>The best way to find valid XML requests, is to use a proxy and record the requests to /cgi-bin/webapp</p><br /><p><strong>UPNP</strong><br />A UPNP Service appears to run on port 49152, but only for a while on first boot. You can query information from it, from /wps_device.xml and /wps_scpd.xml URLs</p><br /><p>What&#039;s needed next for this project? Happy to help out</p>											<p class="post-edited">(Last edited by <strong>Atarii</strong> on 9 Jan 2014, 22:50)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p222224">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">Zajec</div>
					<div class="post-datetime">
						9 Jan 2014, 23:02					</div>
				</div>
				<div class="post-content content">
					<p>Atarii: yeah, you were analyzing this device from a bit different POV. You were examining possibilities with original firmware, while I was looking how to run OpenWrt on it.</p><p>I got some short discussion with Hauke, this device support is a bit complicated.</p><p>So first of all, it seems CFE verifies kernel and rootfs:</p><div class="codebox"><pre><code>Searching for kernel and rootfs images..
Checking kernel..
Kernel check ok..
Checking rootfs..
Rootfs check ok..</code></pre></div><p>It means out firmware image has to be compatible with the original one. It means we can&#039;t really go the easy way and for example put rootfs (SquashFs) the the beginning of flash block.</p><p>We have to:</p><ol class="decimal"><li><p>Consider if we want/need/can use loader (this may be not possible because of CFE checks)</p></li><li><p>Figure out a way to find LZMA compressed kernel (I assume we don&#039;t use loader) (note: LZMA doesn&#039;t use any nice MAGIC)</p></li><li><p>Put some magic data between kernel and rootfs in our firmware image</p></li><li><p>Figure out how to find a rootfs (there are simple MAGICs, but offset is unknown and doesn&#039;t fit flash block)</p></li></ol>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p222239">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">Atarii</div>
					<div class="post-datetime">
						10 Jan 2014, 01:13					</div>
				</div>
				<div class="post-content content">
					<p>Just wanted to confirm, enabling telnet works. I connected up a serial cable and sent the following:</p><div class="codebox"><pre><code>bcm5357 # nvram set TELNET_ENABLED=ON

*** command status = 0

bcm5357 # nvram commit

Writing nvram to 1. slot. Rev: 479

Writing nvram to 2. slot. Rev: 480</code></pre></div><p>Thanks for your input Zajec, shame it&#039;s not simple to get OpenWRT on the device. <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=48201&amp;p=2.html">2</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>