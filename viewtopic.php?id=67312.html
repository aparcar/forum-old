<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> LTE modem with QMI protocol</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 5 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p336860">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">ivan1970</div>
					<div class="post-datetime">
						1 Sep 2016, 14:05					</div>
				</div>
				<div class="post-content content">
					<p>I have a linksys E4200 v1 router with an LTE usb dongle zte mf821 (branded polsat).<br />I installed Chaos Calmer connected on WAN network through the LTE dongle using QMI protocol (qmi_wwan), all working fine but I have an issue that happens on both wireless and wired network: sometimes browsing over internet the connection on browser freeze. <br />I found this article related 3 qmi_wwan bugs that could be the cause of my issue, and if I understand well they has been solved into 3.8 linux kernel. Could you confirm me if these fix has already present into Chaos Calmer firmware?<br />if yes, could you help me to understand what could be the cause of my issue?<br />thanks<br />Ivan</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p336895">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">ivan1970</div>
					<div class="post-datetime">
						1 Sep 2016, 19:20					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m sorry but I haven&#039;t the permission to insert an URL into message, there is a way to insert it?<br />thanks<br />Ivan</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p336954">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">ivan1970</div>
					<div class="post-datetime">
						2 Sep 2016, 11:05					</div>
				</div>
				<div class="post-content content">
					<p>you can find the article at mail-archive (dot) com site at this relative URL: <br />/linux-usb (at) vger (dot) kernel (dot) org/msg19917 (dot) html</p><p>thanks<br />Ivan</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p337215">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">ivan1970</div>
					<div class="post-datetime">
						5 Sep 2016, 11:22					</div>
				</div>
				<div class="post-content content">
					<p>nobody can help me?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p337223">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">augustus_meyer</div>
					<div class="post-datetime">
						5 Sep 2016, 12:46					</div>
				</div>
				<div class="post-content content">
					<p>Unfortunately, I can only give my opinion based on previous experience with other modems:<br />On a stripped-down debian (3.12 kernel) I use a Sierra MC7710 in QMI mode, for 2 years. Had trouble to get it up, only with help of Sierra support and&nbsp; installation of newest QMI drivers.<br />AFAIK, on openwrt a special downsized QMI is used, which also might include a downsized/simplified driver.<br />You should post your question on the LEDE developer forum, because the driver author now is with them, I think.<br />Otherwise, you might verify the openwrt driver source containing the patches _or_ use another driver for the modem.</p><p>Actually, I am thankful for your question, as I am just trying to set up an integrated Huawei LTE-modem into my openwrt-router, as a backup for fixed line internet. Although aiming at QMI, I will stick to cdc-ether driver, which seems to be more &quot;mature&quot;.</p>											<p class="post-edited">(Last edited by <strong>augustus_meyer</strong> on 5 Sep 2016, 12:48)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p337240">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">ivan1970</div>
					<div class="post-datetime">
						5 Sep 2016, 17:02					</div>
				</div>
				<div class="post-content content">
					<p>Hello Augustus,<br />thanks for your answer, could you tell me where can I foud the LEDE developer forum? <br />To post a question to them I need to install their distribution or it is ok to have openwrt distribution?<br />thanks<br />Ivan</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p337258">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">augustus_meyer</div>
					<div class="post-datetime">
						5 Sep 2016, 21:50					</div>
				</div>
				<div class="post-content content">
					<p>Just be &quot;neutral&quot; when putting up yor question should be sufficient.<br /><a href="https://lists.infradead.org/mailman/listinfo/lede-dev">https://lists.infradead.org/mailman/listinfo/lede-dev</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p337709">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">bmork</div>
					<div class="post-datetime">
						9 Sep 2016, 13:36					</div>
				</div>
				<div class="post-content content">
					<p>I think a description of the observed issues, including configuration and already tested workaround attempts, will be more useful.</p><p>There are a number of known and fixed issues realted to QMI support.&nbsp; Verifying each one of them without any specific reason, seems like a waste of time. FWIW, I am pretty sure the three mentioned fixes are present in any current OpenWrt kernel. But I didn&#039;t bother to check because I see no evidence here that it is relevant.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p337724">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">ivan1970</div>
					<div class="post-datetime">
						9 Sep 2016, 15:53					</div>
				</div>
				<div class="post-content content">
					<p>Hello bmork,<br />You are right, but I&#039;m not been able to isolate this issue. <br />I have an LTE connection with an high bandwidth (about 20Mbps in download and 5Mbps in upload) and very often browsing on internet on very light html pages the browser hung on receiving data packet. Then I need stop the session and refresh the page to solve the issue. <br />I also noted that I have no issue downloading big file, but I have a lot of issue to keep on an OpenVPN session, because after some seconds (or minutes) that the VPN is UP, the connection go down until the OpenVPN software automatically restart it.&nbsp; <br />this is the network configuration of WWAN adapter, please let me know which other configuration parts do you need.</p><p>config interface &#039;wwan&#039;<br />&nbsp; &nbsp; option proto &#039;qmi&#039;<br />&nbsp; &nbsp; option device &#039;/dev/cdc-wdm0&#039;<br />&nbsp; &nbsp; option ifname &#039;wwan0&#039;<br />&nbsp; &nbsp; option apn &#039;tre.it&#039;<br />&nbsp; &nbsp; option delay &#039;40&#039;<br />&nbsp; &nbsp; option dns &#039;8.8.8.8 8.8.4.4&#039;</p><br /><p>thanks<br />Ivan</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p337730">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">bmork</div>
					<div class="post-datetime">
						9 Sep 2016, 16:39					</div>
				</div>
				<div class="post-content content">
					<p>A failing browser session on a PC is very &quot;far&quot; away from the LTE session. There&#039;s a lot going on inbetween.&nbsp; I assume you have a wifi-connection to OpenWrt, which routes to qmi_wwan, which talks to the LTE modem over USB, which again has an LTE session to the mobile nework.&nbsp; Each part can fail, and to some degree be debugged.&nbsp; But it does not make sense to start at the far end. You start debugging at the last poiint where you can repreduce the problem.&nbsp; If that is the PC, then there is no reason to debug anywhere else....</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p337735">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">ivan1970</div>
					<div class="post-datetime">
						9 Sep 2016, 17:10					</div>
				</div>
				<div class="post-content content">
					<p>From my test I saw that I have the same issue for both wireless and wired network, than I would exclude that the connection between my PC and the router is the cause of my issue (I also tried to disable wwan connection, I connected router wan port to an ADSL modem and I don&#039;t have any issue). I also tried to connect the LTE USB dongle directly to my PC and I don&#039;t have any issues, for this reason I supposed that the problem was on QMI/LTE side. In which way can I debug qmi_wwan and USB driver? Could be useful to collect tcpdump logs?<br />thanks<br />Ivan</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>