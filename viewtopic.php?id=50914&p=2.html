<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Optimized and feature rich trunk build for select routers</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 20 Aug 2014 and 5 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 2 of 155</div><nav><ul><li><a href="viewtopic.php%3Fid=50914&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li><li><a href="viewtopic.php%3Fid=50914&amp;p=3.html">3</a></li><li><a href="viewtopic.php%3Fid=50914&amp;p=4.html">4</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=50914&amp;p=155.html">155</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p236587">
				<div class="post-metadata">
					<div class="post-num">Post #26</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						13 Jun 2014, 02:50					</div>
				</div>
				<div class="post-content content">
					<p>Did you.... restart the service? <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236589">
				<div class="post-metadata">
					<div class="post-num">Post #27</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						13 Jun 2014, 03:23					</div>
				</div>
				<div class="post-content content">
					<p>Looks like you&#039;re still on LAN? Maybe you didn&#039;t see my edit above, it doesn&#039;t work on LAN here either. Try outside <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>											<p class="post-edited">(Last edited by <strong>arokh</strong> on 13 Jun 2014, 03:23)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236591">
				<div class="post-metadata">
					<div class="post-num">Post #28</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						13 Jun 2014, 03:37					</div>
				</div>
				<div class="post-content content">
					<p>Maybe something to do with my config using addresses from the LAN for VPN (192.168.1.50 and 192.168.1.51). Perhaps it would work if configured to use a different subnet. Anyway why would you use VPN from your LAN?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236652">
				<div class="post-metadata">
					<div class="post-num">Post #29</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						13 Jun 2014, 12:54					</div>
				</div>
				<div class="post-content content">
					<p>Cool <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> Doing a rebuild of r41173 which includes ext4 and a working fstab. Plugging a disk should &quot;just work&quot;.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236674">
				<div class="post-metadata">
					<div class="post-num">Post #30</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						13 Jun 2014, 17:36					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>bmccoy11 wrote:</cite><blockquote><p>In the next build, could you also add luci-app-openvpn?</p></blockquote></div><p>I added it to the latest version, but it seems to be pretty broken. Messes up my config on save (doesn&#039;t keep the &quot;secret&quot; option for instance). Going to make into a module instead in the next build.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236691">
				<div class="post-metadata">
					<div class="post-num">Post #31</div>
					<div class="post-author">bmccoy11</div>
					<div class="post-datetime">
						13 Jun 2014, 21:25					</div>
				</div>
				<div class="post-content content">
					<p>ext4 works great out of the box now, thanks! I&#039;ve found out that (I live in a rural area with 1-2 other weak 2.4GHZ wireless signals in my home) the sweet spot for the best speed:range ratio, I had to set the transmit power on 2.4GHZ to 22dBm (158mW) and 24dBm for 5ghz (251mW), I set the Fragmentation Threshold on both radios to 2346, and the RTS/CTS Threshold to 2347. Is there a way to set the 5ghz radio to N-only?</p>											<p class="post-edited">(Last edited by <strong>bmccoy11</strong> on 13 Jun 2014, 21:25)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236692">
				<div class="post-metadata">
					<div class="post-num">Post #32</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						13 Jun 2014, 21:47					</div>
				</div>
				<div class="post-content content">
					<p>option hwmode &#039;11n&#039; in /etc/config/wireless should do the trick. Or use luci.</p>											<p class="post-edited">(Last edited by <strong>arokh</strong> on 13 Jun 2014, 21:48)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236700">
				<div class="post-metadata">
					<div class="post-num">Post #33</div>
					<div class="post-author">bmccoy11</div>
					<div class="post-datetime">
						13 Jun 2014, 23:29					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>arokh wrote:</cite><blockquote><p>I find it pretty easy to navigate the current structure, but I&#039;ll have a look at that. Seems like I need PHP which isn&#039;t available on the hosting server, I&#039;ve asked jow maybe it can be installed.</p><p>New release out <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></blockquote></div><p><a href="https://www.x10hosting.com/">x10Hosting</a> would work good for hosting these builds, as long as you build a small website that links to these builds so your account won&#039;t get suspended. I&#039;ve been using them for a few months, with no major issues. They have PHP 5.4, Litespeed web server, unlimited storage, they support h5ai/Apaxy, and best of all, it&#039;s free. If you&#039;d like, I could even build a website for you during my spare time that mirrors the files hosted on enduser.subsignal.org/~trondah/</p>											<p class="post-edited">(Last edited by <strong>bmccoy11</strong> on 13 Jun 2014, 23:32)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236734">
				<div class="post-metadata">
					<div class="post-num">Post #34</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						14 Jun 2014, 11:06					</div>
				</div>
				<div class="post-content content">
					<p>Post your /var/etc/openvpn.conf and your OpenWRT.ovpn.</p><p>Hey if you want to build a nice website with h5ai that mirrors enduser at a daily interval, I&#039;m all for it <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236736">
				<div class="post-metadata">
					<div class="post-num">Post #35</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						14 Jun 2014, 11:15					</div>
				</div>
				<div class="post-content content">
					<p>In your client .ovpn file, change</p><div class="codebox"><pre><code>option compress &#039;lzo&#039;</code></pre></div><p>to</p><div class="codebox"><pre><code>comp-lzo</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236739">
				<div class="post-metadata">
					<div class="post-num">Post #36</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						14 Jun 2014, 11:20					</div>
				</div>
				<div class="post-content content">
					<p>You changed the port to 450, I&#039;m assuming you&#039;ve opened that in the firewall as well? BTW, if you remove /etc/openvpn/OpenWRT.ovpn it should create a new one.</p>											<p class="post-edited">(Last edited by <strong>arokh</strong> on 14 Jun 2014, 11:22)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236741">
				<div class="post-metadata">
					<div class="post-num">Post #37</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						14 Jun 2014, 11:22					</div>
				</div>
				<div class="post-content content">
					<p>Well, then everything is correctly set up. What OpenVPN client are you using? Next step would be tcpdump -nn -i eth1 port 450 and check log while you connect.</p>											<p class="post-edited">(Last edited by <strong>arokh</strong> on 14 Jun 2014, 11:23)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236748">
				<div class="post-metadata">
					<div class="post-num">Post #38</div>
					<div class="post-author">bmccoy11</div>
					<div class="post-datetime">
						14 Jun 2014, 12:09					</div>
				</div>
				<div class="post-content content">
					<p>I deleted all of my VPN related posts because they really aren&#039;t directly related to this build <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />.<br />I&#039;ll start working on the website as soon as Freenom comes back up (so I can get a domain for the website)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236755">
				<div class="post-metadata">
					<div class="post-num">Post #39</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						14 Jun 2014, 13:15					</div>
				</div>
				<div class="post-content content">
					<p>So u got it working?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236789">
				<div class="post-metadata">
					<div class="post-num">Post #40</div>
					<div class="post-author">zzz2002</div>
					<div class="post-datetime">
						14 Jun 2014, 19:08					</div>
				</div>
				<div class="post-content content">
					<p>? are the various bit and pieces, things like VPN removable. <br />You build sounds good, but some there are somethings I would prefer not to have on board.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236790">
				<div class="post-metadata">
					<div class="post-num">Post #41</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						14 Jun 2014, 19:22					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m trying to make the build as minimal as possible with only necessary services, it&#039;s not even 5 MB. OpenVPN is like 135 KB, what is it you feel is a waste of space? You can&#039;t remove stuff from the ROM, but patches are provided so you can build yourself.</p>											<p class="post-edited">(Last edited by <strong>arokh</strong> on 14 Jun 2014, 19:23)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236858">
				<div class="post-metadata">
					<div class="post-num">Post #42</div>
					<div class="post-author">bmccoy11</div>
					<div class="post-datetime">
						15 Jun 2014, 06:14					</div>
				</div>
				<div class="post-content content">
					<p>So, apparently my Freenom account has been blacklisted for no reason.</p><p>If you&#039;d like a website, all I ask is that you sign up at <a href="http://www.freenom.com/en/index.html">http://www.freenom.com/en/index.html</a> , get a free domain (such as arokh-router.tk), and set its nameservers to ns1.x10hosting.com and ns2.x10hosting.com . That way you will have full control over the domain.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236880">
				<div class="post-metadata">
					<div class="post-num">Post #43</div>
					<div class="post-author">zzz2002</div>
					<div class="post-datetime">
						15 Jun 2014, 14:43					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>arokh wrote:</cite><blockquote><p>I&#039;m trying to make the build as minimal as possible with only necessary services, it&#039;s not even 5 MB. OpenVPN is like 135 KB, what is it you feel is a waste of space? You can&#039;t remove stuff from the ROM, but patches are provided so you can build yourself.</p></blockquote></div><p>I appreciate that, but your definition of &quot;necessary&quot; and mine a different.</p><p>I don&#039;t think they are a waste of space for everybody, just they are not of interest to me.</p><p>However, I am concerned that adding software that I do not need adds unnecessary complexity.<br />With complexity comes increased risk of system failure, and a greater attack surface for hackers et al.</p><p>The following are not things I use:</p><ul><li><p>OpenVPN - this might be of use some time in the future, I currently use webdav. caldav, opencloud ...</p></li><li><p>Dynamic DNS Support - I run my own DNS (bind 9)</p></li><li><p>USB Storage support &amp; SFTP - not needed see openVPN</p></li></ul><p>One thing that i have been trying to do is to send commands from systems behind the router to the router.<br />I run two servers that provide email, calendar, address book, cloud stuff ... (I am missing some). <br />I run fail2ban as part of my attempt to keep the bad guys out.<br />My usual &quot;ban&quot; time is 60 minutes, but if I get a very persistent then the &quot;recidivist&quot; filter kicks in and bans the IP for a week. <br />It would be nice to hand off the bans to the routers firewall, even if only for the &quot;recidivist&quot; bans.</p>											<p class="post-edited">(Last edited by <strong>zzz2002</strong> on 15 Jun 2014, 14:44)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236886">
				<div class="post-metadata">
					<div class="post-num">Post #44</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						15 Jun 2014, 15:56					</div>
				</div>
				<div class="post-content content">
					<p>OpenVPN: 140KB<br />ddns-scripts: 7KB<br />USB2+SFTP:~100KB</p><p>See what I&#039;m getting at?</p><p>OpenVPN is installed with a static key, it&#039;s impossible to use it without acquiring the key from your router. Don&#039;t like it? Turn it off. DDNS is a set of scripts, does nothing by itself. SFTP is just a binary called by dropbear when the SSH/SFTP client asks for it. SSH is not available from the outside by default. The things you mention are useful to most people, and are standard in most routers. Your concerns about security and complexity with regards to the mentioned software are unfounded.</p><p>In this build, there&#039;s builtin SSH brute force detection from wan in firewall.user. It limits the amount of new connections to 4 pr minute, and drops the packet if it exceeds that. SSH from the outside is not allowed by default, a disabled rule to redirect port 222 from outside to SSH is included. Combine those and you don&#039;t need fail2ban IMO. You can also look into port knocking if you&#039;re worried about brute force attacks. Your concerns about security and complexity are invalid. My build is 1.9MB larger than the official releases which are completely stripped for features.</p><p>Anyways, you are free to not use this build or build yourself. I&#039;m not here to cater to your specific needs, I&#039;m making this build for myself and sharing it in case someone else find it useful.</p>											<p class="post-edited">(Last edited by <strong>arokh</strong> on 15 Jun 2014, 16:03)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236908">
				<div class="post-metadata">
					<div class="post-num">Post #45</div>
					<div class="post-author">bmccoy11</div>
					<div class="post-datetime">
						15 Jun 2014, 21:09					</div>
				</div>
				<div class="post-content content">
					<p>Be careful, if you have Dropbear listening on WAN, then you might get someone from China trying to get in. Luckily this build has built in SSH brute force detection, and automatically blocks IPs after 10 failed log-in attempts. I had someone/something from China trying to get into my router yesterday, but their IPs were automatically blocked.</p>											<p class="post-edited">(Last edited by <strong>bmccoy11</strong> on 15 Jun 2014, 21:12)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236911">
				<div class="post-metadata">
					<div class="post-num">Post #46</div>
					<div class="post-author">bmccoy11</div>
					<div class="post-datetime">
						15 Jun 2014, 21:43					</div>
				</div>
				<div class="post-content content">
					<p>I think this build is great, because it&#039;s only missing three packages that I use (samba36-server, luci-app-samba, and dnscrypt-proxy).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236925">
				<div class="post-metadata">
					<div class="post-num">Post #47</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						16 Jun 2014, 01:13					</div>
				</div>
				<div class="post-content content">
					<p>Not 10 failed log-in attempts, but 4 new connections pr minute. It does not matter if the login succeeds or not, if there has been 4 new connections within the past 60 seconds then the packet is dropped. If you want it to be more strict, just lower the value in firewall.user and optionally increase the time.</p><p>It&#039;s possible to do more fancy things like block a client for an extended period of time upon a set amount of failed login attempts, but at least for me the problem is mostly solved just by using a redirect from port 222 instead of the default port 22. I&#039;ve only had one attempt there and this added protection stopped the automated attack.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236926">
				<div class="post-metadata">
					<div class="post-num">Post #48</div>
					<div class="post-author">wesleyhey</div>
					<div class="post-datetime">
						16 Jun 2014, 01:31					</div>
				</div>
				<div class="post-content content">
					<p>ok so question on the openvpn</p><p>how can I change the IP range? I use 192.168.2.1 for my ip range</p><p>I would like to have a road warrior and this default connection does not seem to work.</p><p>I am missing something to get my laptop to connect to the router and see everything at my house when I am away, some type of road warrior configuration will work great,</p><p>I cannot change the ROM files which looks like is what auto generates these settings</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236928">
				<div class="post-metadata">
					<div class="post-num">Post #49</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						16 Jun 2014, 03:29					</div>
				</div>
				<div class="post-content content">
					<p>Just change your /etc/config/openvpn and your client .ovpn file to reflect those settings. You&#039;ll need to update /etc/config/igmpproy as well for UPnP to work.</p>											<p class="post-edited">(Last edited by <strong>arokh</strong> on 16 Jun 2014, 03:30)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236931">
				<div class="post-metadata">
					<div class="post-num">Post #50</div>
					<div class="post-author">bmccoy11</div>
					<div class="post-datetime">
						16 Jun 2014, 06:37					</div>
				</div>
				<div class="post-content content">
					<p>OpenVPN is constantly restarting. Ugh.</p><div class="quotebox"><blockquote><p>Sun Jun 15 20:31:10 2014 daemon.warn openvpn(default)[1831]: Could not determine IPv4/IPv6 protocol. Using AF_INET6<br />Sun Jun 15 20:31:10 2014 daemon.notice openvpn(default)[1831]: Socket Buffers: R=[163840-&gt;131072] S=[163840-&gt;131072]<br />Sun Jun 15 20:31:10 2014 daemon.notice openvpn(default)[1831]: setsockopt(IPV6_V6ONLY=0)<br />Sun Jun 15 20:31:10 2014 daemon.notice openvpn(default)[1831]: UDP link local (bound): [AF_INET6][undef]:450<br />Sun Jun 15 20:31:10 2014 daemon.notice openvpn(default)[1831]: UDP link remote: [AF_UNSPEC]<br />Sun Jun 15 20:33:10 2014 daemon.notice openvpn(default)[1831]: Inactivity timeout (--ping-restart), restarting<br />Sun Jun 15 20:33:10 2014 daemon.notice openvpn(default)[1831]: SIGUSR1[soft,ping-restart] received, process restarting<br />Sun Jun 15 20:33:10 2014 daemon.notice openvpn(default)[1831]: Restart pause, 5 second(s)<br />Sun Jun 15 20:33:15 2014 daemon.notice openvpn(default)[1831]: Re-using pre-shared static key<br />Sun Jun 15 20:33:15 2014 daemon.notice openvpn(default)[1831]: Preserving previous TUN/TAP instance: tun0<br />Sun Jun 15 20:33:15 2014 daemon.warn openvpn(default)[1831]: Could not determine IPv4/IPv6 protocol. Using AF_INET6<br />Sun Jun 15 20:33:15 2014 daemon.notice openvpn(default)[1831]: Socket Buffers: R=[163840-&gt;131072] S=[163840-&gt;131072]<br />Sun Jun 15 20:33:15 2014 daemon.notice openvpn(default)[1831]: setsockopt(IPV6_V6ONLY=0)<br />Sun Jun 15 20:33:15 2014 daemon.notice openvpn(default)[1831]: UDP link local (bound): [AF_INET6][undef]:450<br />Sun Jun 15 20:33:15 2014 daemon.notice openvpn(default)[1831]: UDP link remote: [AF_UNSPEC]<br />Sun Jun 15 20:35:15 2014 daemon.notice openvpn(default)[1831]: Inactivity timeout (--ping-restart), restarting<br />Sun Jun 15 20:35:15 2014 daemon.notice openvpn(default)[1831]: SIGUSR1[soft,ping-restart] received, process restarting<br />Sun Jun 15 20:35:15 2014 daemon.notice openvpn(default)[1831]: Restart pause, 5 second(s)<br />Sun Jun 15 20:35:20 2014 daemon.notice openvpn(default)[1831]: Re-using pre-shared static key<br />Sun Jun 15 20:35:20 2014 daemon.notice openvpn(default)[1831]: Preserving previous TUN/TAP instance: tun0<br />Sun Jun 15 20:35:20 2014 daemon.warn openvpn(default)[1831]: Could not determine IPv4/IPv6 protocol. Using AF_INET6<br />Sun Jun 15 20:35:20 2014 daemon.notice openvpn(default)[1831]: Socket Buffers: R=[163840-&gt;131072] S=[163840-&gt;131072]<br />Sun Jun 15 20:35:20 2014 daemon.notice openvpn(default)[1831]: setsockopt(IPV6_V6ONLY=0)<br />Sun Jun 15 20:35:20 2014 daemon.notice openvpn(default)[1831]: UDP link local (bound): [AF_INET6][undef]:450<br />Sun Jun 15 20:35:20 2014 daemon.notice openvpn(default)[1831]: UDP link remote: [AF_UNSPEC]</p></blockquote></div><p>P.S, could you sign up for a domain at Freenom and PM me the domain?</p>									</div>
			</article>

			
		
						<div class="notice">
				<p>Sorry, posts 51 to 50 are missing from our archive.</p>
			</div>
		
		
	
	<div class="pagination"><div class="pagination-number">Page 2 of 155</div><nav><ul><li><a href="viewtopic.php%3Fid=50914&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li><li><a href="viewtopic.php%3Fid=50914&amp;p=3.html">3</a></li><li><a href="viewtopic.php%3Fid=50914&amp;p=4.html">4</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=50914&amp;p=155.html">155</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>