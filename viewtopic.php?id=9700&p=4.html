<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> White Russian 0.9 on WRT54GL often &quot;crashing&quot; req. reboot</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 6 Apr 2018 and 4 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 4 of 5</div><nav><ul><li><a href="viewtopic.php%3Fid=9700&amp;p=1.html">1</a></li><li><a href="viewtopic.php%3Fid=9700&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=9700&amp;p=3.html">3</a></li><li class="pagination-current"><span>4</span></li><li><a href="viewtopic.php%3Fid=9700&amp;p=5.html">5</a></li></ul></nav></div>
			
		
		
			<article class="post" id="p45367">
				<div class="post-metadata">
					<div class="post-num">Post #76</div>
					<div class="post-author">Duon</div>
					<div class="post-datetime">
						28 Mar 2007, 06:51					</div>
				</div>
				<div class="post-content content">
					<p>So ... my router WAS working just fine, but today it has crashed at least 8 times, all requiring reboots ... *sigh*</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45464">
				<div class="post-metadata">
					<div class="post-num">Post #77</div>
					<div class="post-author">sammy2ooo</div>
					<div class="post-datetime">
						29 Mar 2007, 14:45					</div>
				</div>
				<div class="post-content content">
					<p>This problem should be fixed as fast as possible, as it makes a lot users routers unusable. What can I do to help the devs? </p><p>Does Kamikaze suffer from this issue? This would be a possible workround at least for me.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45471">
				<div class="post-metadata">
					<div class="post-num">Post #78</div>
					<div class="post-author">lc</div>
					<div class="post-datetime">
						29 Mar 2007, 17:08					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>sammy2ooo wrote:</cite><blockquote><p>This problem should be fixed as fast as possible, as it makes a lot users routers unusable. What can I do to help the devs? </p><p>Does Kamikaze suffer from this issue? This would be a possible workround at least for me.</p></blockquote></div><p>WRT54GL: Kamikaze (2.4 Kernel) uses the latest Broadcom wl driver (4.80.53.0) WhiteRussion uses 3.90.37.0. So chances exist that Kamikaze does not suffer from this issue because Broadcom may have fixed it. However I cannot test it since my setup is not Kamikaze-compatible. </p><p>The alternative (which I could test) would be to create a version of WR which includes the latest wl. Since I am not good on compiling I haven&#039;t had a chance to play to find what exactly has to be compiled into a new WR image to make the new wl system work in WR. Just replacing wl.o does not work (see my previous posts).</p>											<p class="post-edited">(Last edited by <strong>lc</strong> on 29 Mar 2007, 17:09)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45472">
				<div class="post-metadata">
					<div class="post-num">Post #79</div>
					<div class="post-author">haye</div>
					<div class="post-datetime">
						29 Mar 2007, 17:11					</div>
				</div>
				<div class="post-content content">
					<p>@sammy2000:</p><p>If you don&#039;t mind trying a Kamikaze version, then please have a look here:<br /><a href="http://downloads.openwrt.org/snapshots/brcm47xx-2.6/">http://downloads.openwrt.org/snapshots/brcm47xx-2.6/</a></p><p>This is the Kamikaze package with Kernel 2.6, it uses a GPL module for the Broadcom hardware. This module seems to be quite stable now, so it&#039;s worth a try. I&#039;ll have a look at it in week or so. The Kamikaze package for Kernel 2.4 uses the binary only module from Broadcom, it is a different version to the one used in White Russian, but it&#039;s still a closed source Broadcom module.</p><p>I&#039;m very interested in your Kamikaze results, and I&#039;ll post mine here, too.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45473">
				<div class="post-metadata">
					<div class="post-num">Post #80</div>
					<div class="post-author">nbd</div>
					<div class="post-datetime">
						29 Mar 2007, 17:16					</div>
				</div>
				<div class="post-content content">
					<p>no, broadcom wifi is not supported yet, so don&#039;t bother trying</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45477">
				<div class="post-metadata">
					<div class="post-num">Post #81</div>
					<div class="post-author">haye</div>
					<div class="post-datetime">
						29 Mar 2007, 17:33					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for clarifying that, I think I mixed it up with brcm47xx-2.6 while reading your last note on this ticket:<br /><a href="https://dev.openwrt.org/ticket/1312">https://dev.openwrt.org/ticket/1312</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45479">
				<div class="post-metadata">
					<div class="post-num">Post #82</div>
					<div class="post-author">nbd</div>
					<div class="post-datetime">
						29 Mar 2007, 17:50					</div>
				</div>
				<div class="post-content content">
					<p>Hey everybody, I&#039;ve written a short script that may or may not help with the stability issues. It adds some of the nvram fixups found in the Linksys firmware.<br /><a href="http://nbd.name/nvram-fixup.sh">http://nbd.name/nvram-fixup.sh</a></p><p>Please note that this hasn&#039;t been tested very much, so don&#039;t blame me if it crashes your router, eats your dog for breakfast or burns down your house.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45485">
				<div class="post-metadata">
					<div class="post-num">Post #83</div>
					<div class="post-author">haye</div>
					<div class="post-datetime">
						29 Mar 2007, 18:23					</div>
				</div>
				<div class="post-content content">
					<p>Thanks nbd, I&#039;ll try it.<br />Btw, a finalising &quot;nvram commit&quot; is necessary, isn&#039;t it?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45502">
				<div class="post-metadata">
					<div class="post-num">Post #84</div>
					<div class="post-author">lc</div>
					<div class="post-datetime">
						29 Mar 2007, 22:19					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nbd wrote:</cite><blockquote><p>Hey everybody, I&#039;ve written a short script that may or may not help with the stability issues. It adds some of the nvram fixups found in the Linksys firmware.<br /><a href="http://nbd.name/nvram-fixup.sh">http://nbd.name/nvram-fixup.sh</a></p><p>Please note that this hasn&#039;t been tested very much, so don&#039;t blame me if it crashes your router, eats your dog for breakfast or burns down your house.</p></blockquote></div><p>Thanks for the script! I ran it on a few systems (WRT54GL v1.1, boardflags=0x2558) that reboot quite often. </p><p>On systems with (intentionally) reduced tx power it turned up the tx power to the factory value, no other changes:<br /></p><div class="codebox"><pre><code>Checking Linksys WRT54G* fixups...
Adding fixups for BCM5352E
nvram: pa0maxpwr: &#039;0x05&#039; -&gt; &#039;0x4e&#039;</code></pre></div><p>On systems operating at 0x4e tx power there are no changes at all:<br /></p><div class="codebox"><pre><code>Checking Linksys WRT54G* fixups...
Adding fixups for BCM5352E</code></pre></div><p>Since also the 0x4e tx power systems suffer from the kernel panic / reboot problem I am afraid this is no remedy <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45504">
				<div class="post-metadata">
					<div class="post-num">Post #85</div>
					<div class="post-author">kebab</div>
					<div class="post-datetime">
						29 Mar 2007, 22:46					</div>
				</div>
				<div class="post-content content">
					<p>Thanks nbd for the script.</p><p>I have also tried using it on a WRT54GL 1.1. </p><p>No nvram settings were changed, so as lc said this is no remedy.</p>											<p class="post-edited">(Last edited by <strong>kebab</strong> on 29 Mar 2007, 22:48)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45506">
				<div class="post-metadata">
					<div class="post-num">Post #86</div>
					<div class="post-author">haye</div>
					<div class="post-datetime">
						29 Mar 2007, 22:57					</div>
				</div>
				<div class="post-content content">
					<p>I hope I&#039;ll have more luck than you two guys, I tested the script a few minutes ago on four access points, and it changed the NVRAM var &#039;opo&#039; from &#039;0x02&#039; to &#039;0x0008&#039; on all of them. Anyone knows what &#039;opo&#039; is responsible for?</p><p>Maybe my WRTs won&#039;t hang anymore and start to reboot like yours now ;-). It would be a great leap forward for me and my installation...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45508">
				<div class="post-metadata">
					<div class="post-num">Post #87</div>
					<div class="post-author">Duon</div>
					<div class="post-datetime">
						29 Mar 2007, 23:38					</div>
				</div>
				<div class="post-content content">
					<p>Thanks nbd for posting that.</p><p>On my WRT54GL:<br /></p><div class="codebox"><pre><code>root@OpenWrt:/etc# ./nvram-fixup.sh
Checking Linksys WRT54G* fixups...
Adding fixups for BCM5352E
nvram: opo: &#039;0x02&#039; -&gt; &#039;0x0008&#039;
root@OpenWrt:/etc#</code></pre></div><p>I just committed that and rebooted, hopefully it will help. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>If not, I may backup my current install and try a Kamikaze snapshot.</p>											<p class="post-edited">(Last edited by <strong>Duon</strong> on 30 Mar 2007, 00:09)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45509">
				<div class="post-metadata">
					<div class="post-num">Post #88</div>
					<div class="post-author">kebab</div>
					<div class="post-datetime">
						30 Mar 2007, 00:07					</div>
				</div>
				<div class="post-content content">
					<p>The opo setting on my WRT54GL was already set to 0x0008, so I suspect this will not make any difference. This router occasionally reboots, but mainly crashes.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45510">
				<div class="post-metadata">
					<div class="post-num">Post #89</div>
					<div class="post-author">haye</div>
					<div class="post-datetime">
						30 Mar 2007, 00:13					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for dashing my hopes ;-)...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45511">
				<div class="post-metadata">
					<div class="post-num">Post #90</div>
					<div class="post-author">nbd</div>
					<div class="post-datetime">
						30 Mar 2007, 00:14					</div>
				</div>
				<div class="post-content content">
					<p>please show me the output of &#039;nvram show | grep sdram&#039;</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45512">
				<div class="post-metadata">
					<div class="post-num">Post #91</div>
					<div class="post-author">haye</div>
					<div class="post-datetime">
						30 Mar 2007, 00:42					</div>
				</div>
				<div class="post-content content">
					<p>This is from one of my favourite crashers:<br /></p><div class="codebox"><pre><code>nvram show | grep sdram
size: 1838 bytes (30930 left)
sdram_config=0x0062
sdram_refresh=0x0000
sdram_ncdl=0xfe0008
sdram_init=0x010b</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45514">
				<div class="post-metadata">
					<div class="post-num">Post #92</div>
					<div class="post-author">kebab</div>
					<div class="post-datetime">
						30 Mar 2007, 01:01					</div>
				</div>
				<div class="post-content content">
					<p>This is from one of my rebooting/crashing WRT54GL 1.1 routers:</p><p>sdram_config=0x0062<br />size: 10535 bytes (22233 left)<br />sdram_refresh=0x0000<br />sdram_ncdl=0xfe0009<br />sdram_init=0x010b</p>											<p class="post-edited">(Last edited by <strong>kebab</strong> on 30 Mar 2007, 01:05)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45515">
				<div class="post-metadata">
					<div class="post-num">Post #93</div>
					<div class="post-author">kebab</div>
					<div class="post-datetime">
						30 Mar 2007, 01:04					</div>
				</div>
				<div class="post-content content">
					<p>This is from one of my Buffalo WHR-G54S routers that reboots quite regularly.</p><p>size: 1214 bytes (31554 left)<br />sdram_config=0x22<br />sdram_refresh=0<br />sdram_ncdl=0x1f<br />sdram_init=0x0100</p>											<p class="post-edited">(Last edited by <strong>kebab</strong> on 30 Mar 2007, 01:05)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45524">
				<div class="post-metadata">
					<div class="post-num">Post #94</div>
					<div class="post-author">Duon</div>
					<div class="post-datetime">
						30 Mar 2007, 05:02					</div>
				</div>
				<div class="post-content content">
					<p>From my WRT54GL v1.1, which has been crashing for the last couple of days (stable so far today, fingers crossed):<br /></p><div class="codebox"><pre><code>sdram_config=0x0062
sdram_refresh=0x0000
sdram_ncdl=0xfe0108
sdram_init=0x010b</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45527">
				<div class="post-metadata">
					<div class="post-num">Post #95</div>
					<div class="post-author">lc</div>
					<div class="post-datetime">
						30 Mar 2007, 07:48					</div>
				</div>
				<div class="post-content content">
					<p>From a few WRT54GLs who all have the usual symptoms:</p><div class="codebox"><pre><code>size: 10082 bytes (22686 left)
sdram_config=0x0062
sdram_refresh=0x0000
sdram_ncdl=0xff0109
sdram_init=0x010b

size: 10124 bytes (22644 left)
sdram_config=0x0062
sdram_refresh=0x0000
sdram_ncdl=0xff0108
sdram_init=0x010b

size: 10081 bytes (22687 left)
sdram_config=0x0062
sdram_refresh=0x0000
sdram_ncdl=0xff010a
sdram_init=0x010b</code></pre></div><p>Looking at most units out there shows that the only value which differs is sdram_ncdl. </p><p>Here is all the different values I found:<br /></p><div class="codebox"><pre><code>sdram_ncdl=0xfd0009
sdram_ncdl=0xfe0008
sdram_ncdl=0xfe0009
sdram_ncdl=0xfe000a
sdram_ncdl=0xfe0107
sdram_ncdl=0xfe0108
sdram_ncdl=0xfe0109
sdram_ncdl=0xff0008
sdram_ncdl=0xff0107
sdram_ncdl=0xff0108
sdram_ncdl=0xff0109
sdram_ncdl=0xff010a
sdram_ncdl=0xff0208</code></pre></div><p>What exactly does this value mean?</p>											<p class="post-edited">(Last edited by <strong>lc</strong> on 30 Mar 2007, 10:00)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46160">
				<div class="post-metadata">
					<div class="post-num">Post #96</div>
					<div class="post-author">gmayer</div>
					<div class="post-datetime">
						10 Apr 2007, 01:20					</div>
				</div>
				<div class="post-content content">
					<p>Hey guys, I&#039;m back. I&#039;ve read all your posts and various attempts to fix the problem, sad to see that nobody seems to have come up with a real solution yet. I took another look at Sveasoft and thought that perhaps they&#039;ve found a workaround and sent them an email regarding these crashes. Check out what they responded:</p><div class="quotebox"><blockquote><p>The problem is on the GL V.1.1 and is due to the sdram nvram parameters<br />being set incorrectly. We solved it several months ago</p></blockquote></div><p>That seems to confirm what nbd is hinting at. nbd, what value should these sdram parameters have? Is it model specific? lc has a whole bunch of these, I checked on my assortment of 24 deployed WRT54GL&#039;s (all of which are v1.1 and are experiencing these issues) and found the following unique, sorted values</p><div class="codebox"><pre><code>0xfd0008
0xfe0007
0xfe0008
0xfe0009
0xfe0108
0xfe0109
0xff0008
0xff0107
0xff0108
0xff0109</code></pre></div><p>Similar to lc&#039;s values, but I got a few different ones in there too. Why the heck are they all different if I never changed them and the hardware is identical? What do they mean?</p><p>Btw, I thought I was only plagued by random reboots. Now I&#039;ve confirmed several crashes too on my hardware, i.e. internal memory corruption <em>without</em> the unit rebooting itself, causing MUCH more grief because I need to go on site and power cycle the buggers myself :-( But it seems to contradict what others are finding here, I get very few crashes and mostly reboots on my WRT54GL&#039;s.</p><p>Edit: I&#039;ve run nbd&#039;s script on one of my heavily used hotspots (keeping fingers crossed ;-) and it changed quite a few values:</p><div class="codebox"><pre><code>Checking Linksys WRT54G* fixups...
Adding fixups for BCM5352E
nvram: pa0b0: &#039;0x170c&#039; -&gt; &#039;0x168b&#039;
nvram: pa0b1: &#039;0xfa24&#039; -&gt; &#039;0xfabf&#039;
nvram: pa0b2: &#039;0xfe70&#039; -&gt; &#039;0xfeaf&#039;
nvram: pa0maxpwr: &#039;0x48&#039; -&gt; &#039;0x4e&#039;</code></pre></div><p>I did this 10 minutes ago and will have to sit and wait if it makes the reboots disappear...</p>											<p class="post-edited">(Last edited by <strong>gmayer</strong> on 10 Apr 2007, 01:37)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46161">
				<div class="post-metadata">
					<div class="post-num">Post #97</div>
					<div class="post-author">mbm</div>
					<div class="post-datetime">
						10 Apr 2007, 01:39					</div>
				</div>
				<div class="post-content content">
					<p>sdram_init determines the ram capacity<br />sdram_config sets various config parameters<br />sdram_ncdl is for timing</p><p>An sdram_ncdl value of 0 will cause it to recalculate the timing the next boot; nonzero values are timing information.</p><p>We already know that linksys shipped with horrible sdram settings on some boards and we already have startup scripts to correct these values (/etc/init.d/S05nvram). Not all of the &quot;my router crashes&quot; reports here are caused by the same issue, it&#039;s just the same symptom.</p><p>EDIT - did anyone mistakenly copy nvram settings from one router to another? this _WILL_ cause problems.</p>											<p class="post-edited">(Last edited by <strong>mbm</strong> on 10 Apr 2007, 01:44)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46180">
				<div class="post-metadata">
					<div class="post-num">Post #98</div>
					<div class="post-author">lc</div>
					<div class="post-datetime">
						10 Apr 2007, 07:45					</div>
				</div>
				<div class="post-content content">
					<p>Hi mbm,</p><p>thanks for the explanation. What about the crashes that only occur when wireless radio is turned on? Is this an sdram issue?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46194">
				<div class="post-metadata">
					<div class="post-num">Post #99</div>
					<div class="post-author">gmayer</div>
					<div class="post-datetime">
						10 Apr 2007, 12:46					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>mdm wrote:</cite><blockquote><p>sdram_init determines the ram capacity<br />sdram_config sets various config parameters<br />sdram_ncdl is for timing</p><p>An sdram_ncdl value of 0 will cause it to recalculate the timing the next boot; nonzero values are timing information.</p></blockquote></div><p>Good to see a second developer here. Thanks for the info mbm, though I still don&#039;t understand why the sdram_ncdl timing values would be different for the same router, model and revision. Also why doesn&#039;t one just set it to zero to be safe?</p><div class="quotebox"><cite>mdm wrote:</cite><blockquote><p>We already know that linksys shipped with horrible sdram settings on some boards and we already have startup scripts to correct these values (/etc/init.d/S05nvram). Not all of the &quot;my router crashes&quot; reports here are caused by the same issue, it&#039;s just the same symptom.</p></blockquote></div><p>Is the /etc/init.d/S05nvram you mentioned any different from nbd&#039;s nvram-fixup.sh? Cause the latter actually makes no difference on one of my production boxes, in fact it now seems to reboot more often than before (I&#039;ve since reverted to my previous config of course), though it only touched the pa0b&lt;n&gt; and pa0maxpwr variables.</p><div class="quotebox"><cite>mbm wrote:</cite><blockquote><p>EDIT - did anyone mistakenly copy nvram settings from one router to another? this _WILL_ cause problems.</p></blockquote></div><p>I do use standard configuration images that were created on one specific router and then applied to a whole lot of others (makes installation and configuration a hell of a lot easier), but scanning through them in a hex editor yields no reference to the sdram_* and pa0* parameters so I think this is unlikely to be the problem. Or am I mistaken?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46195">
				<div class="post-metadata">
					<div class="post-num">Post #100</div>
					<div class="post-author">mbm</div>
					<div class="post-datetime">
						10 Apr 2007, 13:09					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>lc wrote:</cite><blockquote><p>Hi mbm,</p><p>thanks for the explanation. What about the crashes that only occur when wireless radio is turned on? Is this an sdram issue?</p></blockquote></div><p>Actually that may a problem with the power, turning on the wireless increases the draw on the power supply and may push the limits of what the power supply can provide. Try replacing the power adapter.</p>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 4 of 5</div><nav><ul><li><a href="viewtopic.php%3Fid=9700&amp;p=1.html">1</a></li><li><a href="viewtopic.php%3Fid=9700&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=9700&amp;p=3.html">3</a></li><li class="pagination-current"><span>4</span></li><li><a href="viewtopic.php%3Fid=9700&amp;p=5.html">5</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0.001 -->

</body>
</html>