<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> [SOLVED] TL-MR3020 Lan/Wan IP address after basic configuration</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 25 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p223284">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">abhay</div>
					<div class="post-datetime">
						20 Jan 2014, 20:37					</div>
				</div>
				<div class="post-content content">
					<p>Hello</p><p>This is a total NOOB question. I managed to flash OpenWRT on my TP-Link TL-MR3020. It works fine.</p><p>Router Model&nbsp; &nbsp; TP-Link TL-MR3020 v1<br />Firmware Version&nbsp; &nbsp;&nbsp; OpenWrt Attitude Adjustment 12.09 / LuCI 0.11.1 Release (0.11.1)<br />Kernel Version&nbsp; &nbsp; 3.3.8</p><p>I followed all the steps, telnet, passwd, ssh, enable wifi, enable WPA2, etc.</p><p>Currently it is operating in Bridged AP mode. When I connect the WAN/LAN port to our local LAN, I am able to connect to the internet over Wi-Fi.</p><p>My problem is that now I am not able to find the IP address of the router to use SSH access to the router. Or the Luci interface for that matter.</p><p>I tried using arping on the MAC address, but there is no response. Of course I can access it by connecting it directly to my computer and using the default 192.168.1.1 address, but it sort of defeats the purpose.</p><p>So the question is how can I find the IP address of the router to connect to it once it is connected to the LAN? What information do you need to help?</p><p>Thanks in advance!</p>											<p class="post-edited">(Last edited by <strong>abhay</strong> on 22 Jan 2014, 00:53)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p223286">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">chhatc</div>
					<div class="post-datetime">
						20 Jan 2014, 21:00					</div>
				</div>
				<div class="post-content content">
					<p>hi abhay,</p><p>Do you have another router sitting between the TL-MR3020 and your internet connection.<br />I&#039;m guessing you do because. If so, why not try to figure out which IP addresses have been assigned to what devices using their MAC?</p><p>The wifi bridge (is it set up via WDS?) should be acting like a dhcp client receiving an IP from the main AP and the main AP should have been set up as an authoritative DHCP server.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p223295">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">abhay</div>
					<div class="post-datetime">
						20 Jan 2014, 22:40					</div>
				</div>
				<div class="post-content content">
					<p>Hi</p><p>The problem is that I don&#039;t have access to the main router.</p><p>I&#039;m trying to understand the mechanism. Am I using the wrong MAC address? Why is there no response to the ARP-ping?</p><p>The MR3020 has only one RJ-45 jack that functions as WAN/LAN port depending on the mode it&#039;s in.</p><p>So essentially there is one interface eth0 and one wlan0 what is bridged together to as br-lan. But when I run ifconfig, they all show the same MAC address.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p223297">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						20 Jan 2014, 22:49					</div>
				</div>
				<div class="post-content content">
					<p>you need to change the default ip to something in the &quot;main router&quot; network subnet.. possibly out of DHCP server range, to avoid ip conflicts..</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p223324">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">abhay</div>
					<div class="post-datetime">
						21 Jan 2014, 02:22					</div>
				</div>
				<div class="post-content content">
					<p>I don&#039;t understand what you mean. Why would there be an IP conflict? Our LAN DHCP server allocates the IP address without problem. The bridged WiFi network also works without problem. IP address are correctly allocated to connected clients. I just want to find the IP address allocated to the LAN interface.</p><p>Normally, when I know the MAC address of an interface and want to lookup the IP address, I use the arping command like this:</p><p>arping -i eth0 -c 5 &lt;MAC Addr&gt;</p><p>All interfaces here are on the same LAN, so ideally it should not be a problem.</p><p>But in this case, there is no response to my ARPs from the interface LAN (bridge) interface. Is there any chance that ARPs are disabled/suppressed?</p>											<p class="post-edited">(Last edited by <strong>abhay</strong> on 21 Jan 2014, 02:22)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p223341">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						21 Jan 2014, 08:25					</div>
				</div>
				<div class="post-content content">
					<p>i don&#039;t think arping works like you think xD</p><p>anyway.. usually you set the lan ip of the router to static, and if it&#039;s really a bridged ap, not routed ap, you should choose an ip that the dhcp server of the main router will never assign.<br />i guess you disabled the dhcp server on the 3020?</p>											<p class="post-edited">(Last edited by <strong>nebbia88</strong> on 21 Jan 2014, 08:27)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p223384">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">abhay</div>
					<div class="post-datetime">
						21 Jan 2014, 20:12					</div>
				</div>
				<div class="post-content content">
					<p>I may not know how ARP works, but for sure I&#039;ve been using arping to find IP addresses for a long time. man arping:</p><p>arping -c 3 00:11:85:4c:01:01<br />&nbsp; &nbsp; &nbsp; &nbsp;ARPING 00:11:85:4c:01:01<br />&nbsp; &nbsp; &nbsp; &nbsp;60 bytes from 88.1.180.225 (00:11:85:4c:01:01): icmp_seq=0 time=13.367 msec<br />&nbsp; &nbsp; &nbsp; &nbsp;60 bytes from 88.1.180.225 (00:11:85:4c:01:01): icmp_seq=1 time=13.929 msec<br />&nbsp; &nbsp; &nbsp; &nbsp;60 bytes from 88.1.180.225 (00:11:85:4c:01:01): icmp_seq=2 time=13.929 msec</p><p>&nbsp; &nbsp; &nbsp; &nbsp;--- 00:11:85:4c:01:01 statistics ---<br />&nbsp; &nbsp; &nbsp; &nbsp;3 packets transmitted, 3 packets received,&nbsp; &nbsp;0% unanswered</p><p>Moreover, I can easily get replies using the arping-scan-net script:</p><p>$ sudo ./arping-scan-net.sh 14:10:9f:e3:49:b5<br />Got answer with address: 172.16.31.168</p><p>My router is working fine. I just want to find be able to access it using ssh so I want to find the IP address allocated to it.</p><p>Anyway, let me try assigning a static IP just to test it.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p223409">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">abhay</div>
					<div class="post-datetime">
						22 Jan 2014, 00:51					</div>
				</div>
				<div class="post-content content">
					<p>So mystery solved ... (partially)</p><p>(1) The default bridged configuration works out of the box, but the LAN interface is never allocated an IP address by the main DHCP server on the network. I still don&#039;t understand how this mode works. It is almost like a &quot;pass-through&quot; or a transparent &quot;bridge&quot; between the wired and wireless worlds. Maybe that is what bridged mode means?</p><p>(2) So I configured the router as AP following the excellent tutorial here: <a href="http://%20http://www.clarenceho.net/blog/articles/2012/08/27/tp-link-tl-mr3020-as-ap-and-router-with-openwrt"> http://www.clarenceho.net/blog/article … th-openwrt</a>.</p><p>And voila!<br /></p><div class="codebox"><pre><code>$ sudo ./arping-scan-net.sh 90:F6:52:D6:E8:05
Got answer with address: 172.16.31.209</code></pre></div><p>So I finally found the IP address of the LAN/WAN port ... but, now I couldn&#039;t ssh into it or see the LuCI UI on that address.</p><p>It needs a small change in the firewall rules as documented here: <a href="https://forum.openwrt.org/viewtopic.php?pid=166701#p166701">https://forum.openwrt.org/viewtopic.php … 01#p166701</a>.</p><p>I&#039;m not sure if it is necessary, but I also added a forwarding rule from wan/lan zone to wifi zone.</p><p>Now I am able to ssh into the router from both the wired and wireless networks. Works like a charm!</p><p>I have some more questions but those will go into another post.</p><p>Thank you everyone.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>