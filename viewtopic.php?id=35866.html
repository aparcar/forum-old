<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Help with MACfilter on wireless - Blackfire RC6 and RC5.</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 30 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p162656">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">nitromethanol</div>
					<div class="post-datetime">
						30 Mar 2012, 20:25					</div>
				</div>
				<div class="post-content content">
					<p>Hi forum,<br />&nbsp; &nbsp; &nbsp; I have a problem with macfilter. Does not work for me. I tested over TP-link 1043ND with Rc5, Rc6 and final version without success. Any device can connect to WiFi network, in spite of not been on mac white list.&nbsp; I &#039;ll apreciate any comments.<br />&nbsp; &nbsp; &nbsp; Thanks.<br />&nbsp; &nbsp; &nbsp;</p><p>File: /etc/config/wireless <br /></p><div class="codebox"><pre><code>config &#039;wifi-device&#039; &#039;radio0&#039;
    option &#039;type&#039; &#039;mac80211&#039;
    option &#039;macaddr&#039; &#039;XX:XX:XX:XX:XX:XX&#039;
    option &#039;htmode&#039; &#039;HT20&#039;
    option &#039;country&#039; &#039;AR&#039;
    option &#039;distance&#039; &#039;200&#039;
    option &#039;channel&#039; &#039;6&#039;
    option &#039;disabled&#039; &#039;0&#039;
    option &#039;txpower&#039; &#039;20&#039;
     ...

     ...
config &#039;wifi-iface&#039;
    option &#039;device&#039; &#039;radio0&#039;
    option &#039;mode&#039; &#039;ap&#039;
    option &#039;ssid&#039; &#039;WiFi&#039;
    option &#039;encryption&#039; &#039;psk2&#039;
    option &#039;key&#039; &#039;*****************&#039;
    option &#039;network&#039; &#039;vlan_2&#039;
    option &#039;isolate&#039; &#039;1&#039;
    option &#039;maxassoc&#039; &#039;15&#039;
    option &#039;macfilter&#039; &#039;allow&#039;
    list &#039;maclist&#039; &#039;DD:DD:DD:DD:DD:DD&#039;
    list &#039;maclist&#039; &#039;AA:AA:AA:AA:AA:AA&#039;</code></pre></div><p>I made a &quot;query&quot; to the running config and this is the result.</p><div class="codebox"><pre><code>root@AP1:~# cat /var/run/hostapd-phy0.conf 

ctrl_interface=/var/run/hostapd-phy0
driver=nl80211
wmm_ac_bk_cwmin=4
wmm_ac_bk_cwmax=10
wmm_ac_bk_aifs=7
wmm_ac_bk_txop_limit=0
wmm_ac_bk_acm=0
wmm_ac_be_aifs=3
wmm_ac_be_cwmin=4
wmm_ac_be_cwmax=10
wmm_ac_be_txop_limit=0
wmm_ac_be_acm=0
wmm_ac_vi_aifs=2
wmm_ac_vi_cwmin=3
wmm_ac_vi_cwmax=4
wmm_ac_vi_txop_limit=94
wmm_ac_vi_acm=0
wmm_ac_vo_aifs=2
wmm_ac_vo_cwmin=2
wmm_ac_vo_cwmax=3
wmm_ac_vo_txop_limit=47
wmm_ac_vo_acm=0
tx_queue_data3_aifs=7
tx_queue_data3_cwmin=15
tx_queue_data3_cwmax=1023
tx_queue_data3_burst=0
tx_queue_data2_aifs=3
tx_queue_data2_cwmin=15
tx_queue_data2_cwmax=63
tx_queue_data2_burst=0
tx_queue_data1_aifs=1
tx_queue_data1_cwmin=7
tx_queue_data1_cwmax=15
tx_queue_data1_burst=3.0
tx_queue_data0_aifs=1
tx_queue_data0_cwmin=3
tx_queue_data0_cwmax=7
tx_queue_data0_burst=1.5
hw_mode=g
channel=6

country_code=AR


logger_syslog=127
logger_syslog_level=2
logger_stdout=127
logger_stdout_level=2
ieee80211d=1
....

....
bss=wlan2
ctrl_interface=/var/run/hostapd-phy0
ap_isolate=1
wpa_passphrase=**************
auth_algs=1
wpa=2
wpa_pairwise=CCMP
ssid=Zona-WiFi
bridge=br-vlan_2
wmm_enabled=1
bssid=XX:XX:XX:XX:XX:XX
ignore_broadcast_ssid=0


max_num_sta=15</code></pre></div><p>There is no MAC list on it?<br />Thanks a lot!</p>											<p class="post-edited">(Last edited by <strong>nitromethanol</strong> on 4 Apr 2012, 15:46)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p163273">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">nitromethanol</div>
					<div class="post-datetime">
						4 Apr 2012, 16:22					</div>
				</div>
				<div class="post-content content">
					<p>Hi again,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; I found a 2008 tread that explain the syntax with UCI command, so i tested again. A made this on command prompt without success.</p><p>How is it configured</p><div class="codebox"><pre><code>root@AP:~# uci show wireless
wireless.radio0=wifi-device
wireless.radio0.type=mac80211
wireless.radio0.macaddr=xx:xx:xx:xx:xx:xx
wireless.radio0.hwmode=11ng
wireless.radio0.htmode=HT20
wireless.radio0.country=AR
wireless.radio0.distance=200
wireless.radio0.channel=1
wireless.radio0.txpower=20
....

....
wireless.@wifi-iface[2]=wifi-iface
wireless.@wifi-iface[2].device=radio0
wireless.@wifi-iface[2].mode=ap
wireless.@wifi-iface[2].ssid=WiFi
wireless.@wifi-iface[2].encryption=psk2
wireless.@wifi-iface[2].key=*************
wireless.@wifi-iface[2].network=vlan_1
wireless.@wifi-iface[2].isolate=1
wireless.@wifi-iface[2].maxassoc=15
wireless.@wifi-iface[2].maclist=AA:AA:AA:AA:AA:AA BB:BB:BB:BB:BB:BB
wireless.@wifi-iface[2].macfilter=allow</code></pre></div><p>Then start changing macfilter with macpolicy:<br /></p><div class="codebox"><pre><code>root@AP:~# uci set wireless.@wifi-iface[2].macfilter=
root@AP:~# uci set wireless.@wifi-iface[2].macpolicy=allow
root@AP:~# uci commit
root@AP:~# wifi</code></pre></div><p>macpolicy does not work too. <br />Now i am thinking that MAC wite-list does not work at all. Can be? Can somebody give a clue what&#039;s going on?<br />Thanks a lot.</p>											<p class="post-edited">(Last edited by <strong>nitromethanol</strong> on 4 Apr 2012, 16:24)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p163275">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						4 Apr 2012, 16:34					</div>
				</div>
				<div class="post-content content">
					<p>Yes, mac lists got only implemented later for mac80211.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p163333">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">nitromethanol</div>
					<div class="post-datetime">
						4 Apr 2012, 23:13					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jow wrote:</cite><blockquote><p>Yes, mac lists got only implemented later for mac80211.</p></blockquote></div><p>How later? Which version has this feature?<br />Thanks for answering!!!</p>											<p class="post-edited">(Last edited by <strong>nitromethanol</strong> on 24 May 2012, 23:31)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>