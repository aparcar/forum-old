<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Please help me with my fonera before I go insane!!!</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 18 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p81247">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">oiluig86</div>
					<div class="post-datetime">
						6 Feb 2009, 22:07					</div>
				</div>
				<div class="post-content content">
					<p>Hi<br />Maybe i am facing with first case of telepathy between two elctronic devices!!! <img src="https://forum.openwrt.org/img/smilies/lol.png" width="15" height="15" alt="lol" /><br />Stop joking, I have a fonera 2201 with open-wrt installed (dd-wrt doesn&#039;t work) and my aim is to make a wireless adapter for my xbox360 ( biggest discoveries often start from small problems <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /> ). My Access point is a D-link with ADSL modem (I&#039;m italian) and 4 ethernet ports, i keep original software cause it seems to be flexible.<br />Configuration files in fonera are these:</p><div class="codebox"><pre><code>/etc/config/wireless

config &#039;wifi-device&#039; &#039;wifi0&#039;
        option &#039;type&#039; &#039;atheros&#039;
        option &#039;agmode&#039; &#039;11bg&#039;
        option &#039;channel&#039; &#039;0&#039;
        option &#039;maxassoc&#039; &#039;&#039;
        option &#039;distance&#039; &#039;&#039;
        option &#039;diversity&#039; &#039;1&#039;
        option &#039;txantenna&#039; &#039;0&#039;
        option &#039;rxantenna&#039; &#039;0&#039;
        option &#039;disabled&#039; &#039;0&#039;
        option &#039;antenna&#039; &#039;&#039;

config &#039;wifi-iface&#039;
        option &#039;device&#039; &#039;wifi0&#039;
        option &#039;network&#039; &#039;lan&#039;
        option &#039;mode&#039; &#039;sta&#039;
        option &#039;encryption&#039; &#039;none&#039;
        option &#039;ssid&#039; &#039;myssid&#039;   &lt;-- ssid of my D-link AP
        option &#039;bssid&#039; &#039;&#039;
        option &#039;server&#039; &#039;&#039;
        option &#039;port&#039; &#039;&#039;
        option &#039;hidden&#039; &#039;0&#039;
option &#039;hidden&#039; &#039;0&#039;
        option &#039;isolate&#039; &#039;0&#039;
        option &#039;txpower&#039; &#039;18&#039;
        option &#039;bgscan&#039; &#039;0&#039;
        option &#039;frag&#039; &#039;&#039;
        option &#039;rts&#039; &#039;&#039;
        option &#039;wds&#039; &#039;1&#039;
        option &#039;key1&#039; &#039;&#039;
        option &#039;key2&#039; &#039;&#039;
        option &#039;key3&#039; &#039;&#039;
        option &#039;key4&#039; &#039;&#039;
        option &#039;80211h&#039; &#039;&#039;
        option &#039;compression&#039; &#039;&#039;
        option &#039;bursting&#039; &#039;&#039;
        option &#039;ff&#039; &#039;&#039;
        option &#039;wmm&#039; &#039;&#039;
        option &#039;xr&#039; &#039;&#039;
        option &#039;ar&#039; &#039;&#039;
        option &#039;turbo&#039; &#039;&#039;
        option &#039;macpolicy&#039; &#039;none&#039;


/etc/config/network

config &#039;interface&#039; &#039;loopback&#039;
        option &#039;ifname&#039; &#039;lo&#039;
        option &#039;proto&#039; &#039;static&#039;
        option &#039;ipaddr&#039; &#039;127.0.0.1&#039;
        option &#039;netmask&#039; &#039;255.0.0.0&#039;

config &#039;interface&#039; &#039;lan&#039;
        option &#039;type&#039; &#039;bridge&#039;
        option &#039;proto&#039; &#039;static&#039;
        option &#039;ipaddr&#039; &#039;192.168.10.1&#039;
        option &#039;netmask&#039; &#039;255.255.255.0&#039;
        option &#039;ifname&#039; &#039;eth0.0&#039;
        option &#039;macaddr&#039; &#039;&#039;
        option &#039;ip6addr&#039; &#039;&#039;
        option &#039;gateway&#039; &#039;&#039;
        option &#039;ip6gw&#039; &#039;&#039;


/etc/config/dhcp

config dnsmasq
        option domainneeded     1
        option boguspriv        1
        option filterwin2k      &#039;0&#039;  #enable for dial on demand
        option localise_queries 1
        option local    &#039;/lan/&#039;
        option domain   &#039;lan&#039;
        option expandhosts      1
        option nonegcache       0
        option authoritative    1
        option readethers       1
        option leasefile        &#039;/tmp/dhcp.leases&#039;
        option resolvfile       &#039;/tmp/resolv.conf.auto&#039;

config dhcp lan
        option interface        lan
        option start    100
        option limit    150
        option leasetime        12h

config dhcp wan
        option interface        wan
        option ignore   1</code></pre></div><p>wan interface doesn&#039;t appear cause i want to keep disabled.<br />when i start the fonera ifconfig, route and iwconfig shows that<br /></p><div class="codebox"><pre><code>ifconfig:
ath0      Link encap:Ethernet  HWaddr 00:18:84:A0:02:11
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:6254 errors:0 dropped:3127 overruns:0 frame:0
          TX packets:601 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:1528424 (1.4 MiB)  TX bytes:68848 (67.2 KiB)

br-lan    Link encap:Ethernet  HWaddr 00:18:84:A0:02:10
          inet addr:192.168.10.1  Bcast:192.168.10.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:2683 errors:0 dropped:0 overruns:0 frame:0
          TX packets:10 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:153829 (150.2 KiB)  TX bytes:1400 (1.3 KiB)

eth0      Link encap:Ethernet  HWaddr 00:18:84:A0:02:10
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:591 errors:0 dropped:0 overruns:0 frame:0
          TX packets:3132 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:68630 (67.0 KiB)  TX bytes:799552 (780.8 KiB)
          Interrupt:255 Base address:0x1000

eth0.0    Link encap:Ethernet  HWaddr 00:18:84:A0:02:10
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:591 errors:0 dropped:0 overruns:0 frame:0
          TX packets:3131 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:59174 (57.7 KiB)  TX bytes:786655 (768.2 KiB)

lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

wifi0     Link encap:UNSPEC  HWaddr 00-18-84-A0-02-11-00-00-00-00-00-00-00-00-00
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:138499 errors:0 dropped:24998 overruns:0 frame:44217
          TX packets:620 errors:2 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:195
          RX bytes:13625807 (12.9 MiB)  TX bytes:86570 (84.5 KiB)
          Interrupt:3 Memory:b0000000-b00ffffc


route:

Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
192.168.10.0   *               255.255.255.0 U     0      0        0 br-lan


iwconfig

ath0      IEEE 802.11g  ESSID:&quot;myssid&quot;  Nickname:&quot;&quot;
          Mode:Managed  Frequency:2.412 GHz  Access Point: 02:21:91:1B:D3:30
          Bit Rate:36 Mb/s   Tx-Power:18 dBm   Sensitivity=1/1
          Retry:off   RTS thr:off   Fragment thr:off
          Encryption key:off
          Power Management:off
          Link Quality=66/70  Signal level=-30 dBm  Noise level=-96 dBm
          Rx invalid nwid:59068  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:0   Missed beacon:0</code></pre></div><p>The system obviously doesn&#039;t work ( otherwise i wasn&#039;t here!! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> ).<br />I&#039;ve got a some doubts:<br />1. Why there are 3 interfaces with the same MAC address?? br-lan eth0 and eth0.0 has the same MAC address but only br-lan is useful indeed it compares in routing table<br />2. Why access-point in ath0 is associated?? I don&#039;t give it any MAC address!!<br />3. D-link dhcp server table shows this<br /></p><div class="codebox"><pre><code>Client wireless connected
BSSID                       associated
00:18:84:A0:02:11           yes

Client LAN DHCP connected
hostname                   MAC address          ip address     
      //                       00:18:84:A0:02:10      192.168.1.2</code></pre></div><p>it has ath0 MAC address associated but it receives an ip request from eth0/eth0.0/br-lan MAC-address and it assigns an ip address!!!....HOW IS IT POSSIBLE?!?!?!?</p><p>last thing: i connect a laptop to fonera via ethernet: dhcp server works properly and the ip address assigned to laptop is 192.168.10.133<br />Please anyone ca give a way to understand what&#039;s happening in my room?!?!</p>											<p class="post-edited">(Last edited by <strong>oiluig86</strong> on 6 Feb 2009, 22:09)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p81255">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">CyrusFF</div>
					<div class="post-datetime">
						6 Feb 2009, 23:41					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>oiluig86 wrote:</cite><blockquote><p>1. Why there are 3 interfaces with the same MAC address?? br-lan eth0 and eth0.0 has the same MAC address but only br-lan is useful indeed it compares in routing table</p></blockquote></div><p>They are: bridge, switch, vlan in this order.</p><div class="quotebox"><cite>oiluig86 wrote:</cite><blockquote><p>2. Why access-point in ath0 is associated?? I don&#039;t give it any MAC address!!</p></blockquote></div><p>You don&#039;t need to, its WLAN.</p><div class="quotebox"><cite>oiluig86 wrote:</cite><blockquote><p>it has ath0 MAC address associated but it receives an ip request from eth0/eth0.0/br-lan MAC-address and it assigns an ip address!!!....HOW IS IT POSSIBLE?!?!?!?</p></blockquote></div><p>That is because you have bridged the WLAN interface to lan. Because of protocol limitations in WLAN you cannot simply bridge over WLAN interfaces in station (client) mode. This leads to all kind of strange behaviour. You should either setup routing instead of bridging on your fonera or use adhoc or WDS mode.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p81392">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">oiluig86</div>
					<div class="post-datetime">
						8 Feb 2009, 14:00					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>CyrusFF wrote:</cite><blockquote><div class="quotebox"><cite>oiluig86 wrote:</cite><blockquote><p>it has ath0 MAC address associated but it receives an ip request from eth0/eth0.0/br-lan MAC-address and it assigns an ip address!!!....HOW IS IT POSSIBLE?!?!?!?</p></blockquote></div><p>That is because you have bridged the WLAN interface to lan. Because of protocol limitations in WLAN you cannot simply bridge over WLAN interfaces in station (client) mode. This leads to all kind of strange behaviour. You should either setup routing instead of bridging on your fonera or use adhoc or WDS mode.</p></blockquote></div><p>I red about this thing that fonera can&#039;t bridge in client mode...but yesterday i tried for last time and magically works!!! with the same configuration...now i can play halo in xbox live!!! YESSAAAAAA!!!!! <img src="https://forum.openwrt.org/img/smilies/lol.png" width="15" height="15" alt="lol" /></p>											<p class="post-edited">(Last edited by <strong>oiluig86</strong> on 8 Feb 2009, 14:00)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>