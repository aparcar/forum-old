<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> NVRAM &lt;--&gt; configuration files</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 7 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p96697">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Vwaju</div>
					<div class="post-datetime">
						1 Nov 2009, 00:58					</div>
				</div>
				<div class="post-content content">
					<p>In <a href="http://wiki.openwrt.org/oldwiki/openwrtdocs/kamikazeconfiguration">http://wiki.openwrt.org/oldwiki/openwrt … figuration</a> is says:</p><p>&quot;As OpenWRT expanded to new platforms without NVRAM, NVRAM was abandoned in favour of configuration files in /etc/config.&quot;</p><p>Where are these configuration files stored, if not in NVRAM.&nbsp; (The Linksys&nbsp; WRT54GL does not have a hard drive, as far as I can tell.)</p><p>Thanks &amp; Best Regards,</p><p>Vwaju<br />New York City</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p96698">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						1 Nov 2009, 02:31					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Vwaju wrote:</cite><blockquote><p>In <a href="http://wiki.openwrt.org/oldwiki/openwrtdocs/kamikazeconfiguration">http://wiki.openwrt.org/oldwiki/openwrt … figuration</a> is says:</p><p>&quot;As OpenWRT expanded to new platforms without NVRAM, NVRAM was abandoned in favour of configuration files in /etc/config.&quot;</p><p>Where are these configuration files stored, if not in NVRAM.&nbsp; (The Linksys&nbsp; WRT54GL does not have a hard drive, as far as I can tell.)</p></blockquote></div><p>You already pointed out above that the configuration files are stored in <em>/etc/config</em> directory.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p96710">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Vwaju</div>
					<div class="post-datetime">
						1 Nov 2009, 15:31					</div>
				</div>
				<div class="post-content content">
					<p>Thank you for responding, mazilo.</p><p>What I meant was:&nbsp; What *hardware* is used for storage of the file system?</p><p>Vwaju<br />New York City</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p96713">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						1 Nov 2009, 15:56					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Vwaju wrote:</cite><blockquote><p>What I meant was:&nbsp; What *hardware* is used for storage of the file system?</p></blockquote></div><p>I may be wrong; however, I believe this is hardware dependent. If you do a <em>df</em> when logged into your system, it should tell you where the <em>/etc</em> directory is. On my Netgear WGT634U, the <em>df</em> spits out the following partitions information:<br /></p><div class="codebox"><pre><code>Filesystem           1K-blocks      Used Available Use% Mounted on
/dev/root                 1792      1792         0 100% /rom
tmpfs                    14560        72     14488   0% /tmp
tmpfs                      512         0       512   0% /dev
/dev/mtdblock3            4608       404      4204   9% /jffs
mini_fo:/jffs             1792      1792         0 100% /
/dev/sda1               116648     15896     94730  14% /mnt/sda1</code></pre></div><p>According to the above information, the <em>/etc</em> directory resides on <em>/dev/mtdblock3</em> partition. A copy of READ ONLY file system, including <em>/etc</em> directory can be found on <em>/rom</em> directory.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p96714">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">Dogge</div>
					<div class="post-datetime">
						1 Nov 2009, 16:22					</div>
				</div>
				<div class="post-content content">
					<p>It&#039;s normally stored in the JFFS2 partition.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p96821">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">aport</div>
					<div class="post-datetime">
						3 Nov 2009, 23:24					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Vwaju wrote:</cite><blockquote><p>Thank you for responding, mazilo.</p><p>What I meant was:&nbsp; What *hardware* is used for storage of the file system?</p><p>Vwaju<br />New York City</p></blockquote></div><p>OpenWRT uses a read-only squashfs filesystem for the rootfs and then uses a program called mini_fo to overlay a read/write JFFS2 partition to store changes and modifications.</p><p>A standard embedded linux setup might have a partition called &quot;nvram.&quot; OpenWRT has &quot;rootfs&quot; and &quot;rootfs_data&quot; the first being squashfs and the latter being JFFS2.</p><br /><p>System configuration is done via a utility called UCI. NVRAM for instance has one &quot;config&quot; file that is setup:<br /></p><div class="codebox"><pre><code>key=value
key=value
key=value</code></pre></div><p>and this is written to a partition.</p><p>UCI&#039;s config files are stored in /etc/config/ and have a different syntax. If any modifications are made to these files, or any file on the filesystem for that matter, the &quot;dirty&quot; copy is stored on JFFS2 partition.</p><br /><br /><p>I hope this explanation makes sense. It&#039;s a quite different approach than the standard nvram setup. Though the standard nvram setup is outdated and not very flexible.</p><br /><br /><br /><br /><p>Edit: I re-read your question. Everything is just stored on the flash chip, on different partitions. Typcially a router with an &quot;nvram&quot; setup just had a partition on the flash chip called &quot;nvram&quot; ... not some special piece of hardware made specifically for storing settings.</p>											<p class="post-edited">(Last edited by <strong>aport</strong> on 3 Nov 2009, 23:29)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p96899">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">Vwaju</div>
					<div class="post-datetime">
						5 Nov 2009, 02:36					</div>
				</div>
				<div class="post-content content">
					<p>Thanks, aport.&nbsp; That&#039;s helpful.</p><p>Vwaju</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>