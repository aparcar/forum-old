<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> OpenWRT VM as a VPN gateway</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 18 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p297444">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">privacymatters</div>
					<div class="post-datetime">
						26 Oct 2015, 04:36					</div>
				</div>
				<div class="post-content content">
					<p>Hello all, thanks for taking the time to read my questions here...&nbsp; &nbsp;Firstly I&#039;m not a network engineer but I&#039;m familiar with basic Linux administration.&nbsp; OpenWRT is my first real dive into routing.</p><p>I run a number of VMs on my LAN here which do various tasks like downloading Linux ISO&#039;s from Bittorrent, cataloging them and storing them on a physical storage server on the same LAN.&nbsp; &nbsp;The VMs need to have direct access to the LAN at all times.</p><p>In this age of metadata retention and so on, I feel it best to run a VPN to ensure that the Bittorrent VMs can only access the internet through a VPN, but at the same time retain access to the LAN so they can access the storage server, and so they can be managed from clients on the LAN.&nbsp; It&#039;s also important to ensure that if the VPN drops, the VM clients cannot access the internet, but can still access the LAN. </p><p>I guessed that the way to achieve this would be to install a VM on the LAN running OpenWRT, connect it to a VPN (in this case, PIA), and have the OpenWRT route between the LAN and the physical router currently providing internet access.</p><p>I&#039;m not sure how to do this... I have OpenWRT installed and running on my hypervisor, I&#039;ve configured it&#039;s LAN interface to the LAN with an IP so it&#039;s reachable.&nbsp; &nbsp;OpenWRT - 192.168.0.2, Physical SOHO router - 192.168.0.1, everything else is also on 192.168.0.0/24</p><p>So, how do I make this act as a router, so that I can point certain clients gateways at 192.168.0.2 and have them gain internet access through 192.168.0.1?</p><p>Secondly, and more importantly, how do I make this a VPN gateway, such that it will connect to PIA, and that all clients that connect use that VPN tunnel, and most important of all, if the VPN drops, the routing stops?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>