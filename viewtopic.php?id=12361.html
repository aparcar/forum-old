<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> DMZ setup does not work as expected</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 25 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p55003">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">petrug</div>
					<div class="post-datetime">
						3 Sep 2007, 21:17					</div>
				</div>
				<div class="post-content content">
					<p>Hello all,</p><p>I recently bought an ASUS WL500. Replacing the original firmware with OpenWRT was no problem. Thanks to all developers that work on this project.</p><p>For the time being, I just installed it behind my other router that is doing PPPOE, so the WAN is just using DHCP.</p><p>My next goal is to setup some sort of DMZ. I want to isolate one port so that a machine on that port cannot access the machines on the other ports, but still can access the WAN. It&#039;s not necessary that this isolated port can be reached from the internet, so it&#039;s no real DMZ setup.</p><p>I have gone through great parts of the documentation that deal with VLAN, tagging and so on. I found the following two tutorials, that deal more or less with the subject:<br /><a href="http://wiki.openwrt.org/DemilitarizedZoneHowto">http://wiki.openwrt.org/DemilitarizedZoneHowto</a><br /><a href="http://wiki.openwrt.org/OpenWrtDocs/NetworkInterfaces">http://wiki.openwrt.org/OpenWrtDocs/NetworkInterfaces</a></p><p>The latter deals with an ASUS WL500, so I thought it should be easy to setup. But up to now I failed.</p><p>I wanted to make the setup step by step and verify each step to see if it really works. I installed tcpdump and iptraf to have an overview what is going on on the network interfaces. Between each configuration step, I save the config to NVRAM and reset the router. </p><p>My problem is that after a bootup,&nbsp; I never see any traffic on the vlan2 interface.</p><p>Is that intentional? I thought that when I have setup the vlan2 interface and connected a machine to the port I specified, I could see that the packets will flow through vlan2. But they don&#039;t, they keep getting through eth0.</p><p>Even if I ping the address that is assigned to the vlan2 interface, the packets are accounted for eth0, not for the vlan2.</p><p>From my understanding setting up any iptables rules will not work if the packets don&#039;t traverse the right interface.</p><p>My current setup looks like this and is not changed that much from the original settings:</p><p>vlan0hwname=et0<br />vlan0ports=2 3 4 5*<br />vlan1hwname=et0<br />vlan1ports=0 5<br />vlan2hwname=et0<br />vlan2ports=1 5</p><p>wan_device=vlan1<br />wan_dhcp_lease=<br />wan_dhcp_num=<br />wan_dhcp_start=<br />wan_hostname=OpenWrt<br />wan_ifname=eth1<br />wan_proto=dhcp</p><p>lan_ifname=br0<br />lan_ifnames=eth0 eth2<br />lan_ipaddr=192.168.1.1<br />lan_netmask=255.255.255.0<br />lan_proto=static</p><p>dmz_ifname=vlan2<br />dmz_ifnames=vlan2<br />dmz_ipaddr=192.168.3.1<br />dmz_netmask=255.255.255.0<br />dmz_proto=static</p><p>One thing that irritates my as a newbie is, that the second tutorial says that I should set &quot;wan_ifname=vlan1&quot;. Now I&#039;m wondering what the difference between a ifname and a device is. If I set it as suggested, my WAN stops working.</p><p>I&#039;m lost now.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>