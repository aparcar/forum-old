<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> bad firmware on dir-300</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 25 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p193815">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">m.m.m</div>
					<div class="post-datetime">
						4 Mar 2013, 21:01					</div>
				</div>
				<div class="post-content content">
					<p>hi all,<br />I wanted to upgrade my dir-300 rev A1 but after uploading the firmware file, just a screen appeared just says:<br />&quot;it works!&quot;<br />then I refreshed the page for so many times but nothing appeared, even the it works message!<br />since I am a noob beginner, I found out I should make a contact with the router with its serial port after a lot of searching. built the ttl to rs232 converter exactly same as this:<br /><a href="http://isl3893.sourceforge.net/serial-max3232.gif">http://isl3893.sourceforge.net/serial-max3232.gif</a><br />and every time I open the putty.exe with settings written in here:<br /><a href="http://www.dd-wrt.com/wiki/index.php/Recover_from_a_Bad_Flash">http://www.dd-wrt.com/wiki/index.php/Re â€¦ _Bad_Flash</a><br />just a blank black screen opens up and nothing happens,<br />should I use jTag port?<br />how can I understand that it&#039;s bootloader is not gone? because I read somewhere if the bootloader is gone, then we should use jTag port.</p><p>sorry for my bad English, and also for my noobness <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /><br />thanks a lot. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>											<p class="post-edited">(Last edited by <strong>m.m.m</strong> on 7 Mar 2013, 10:48)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193819">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">MBS</div>
					<div class="post-datetime">
						4 Mar 2013, 23:28					</div>
				</div>
				<div class="post-content content">
					<p>Have you tested your serial converter by just connecting its Tx and Rx wires together and typing something in putty? Do you see the echo of what you are typing?<br />If that worked, have you tried to swap Tx and Rx when connecting to the router?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193882">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">m.m.m</div>
					<div class="post-datetime">
						5 Mar 2013, 15:49					</div>
				</div>
				<div class="post-content content">
					<p>thanks for the replay.<br />I can&#039;t even type anything in the putty terminal!<br />I couldn&#039;t understand you, do you mean I should connect the routers rx and tx ports directly to my serial port?<br />I also swapped Tx and Rx from the router but it didn&#039;t work either.<br />I forgot to say: I am using a rs232/usb converter because I am using a laptop.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193899">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">MBS</div>
					<div class="post-datetime">
						5 Mar 2013, 19:42					</div>
				</div>
				<div class="post-content content">
					<p>No, I mean that you should only connect your converters Tx to your converters Rx. No connection to the router. This way you can test, if your converter works properly. Whatever you type in putty should appear instantly (check local echo settings of putty, if available - I never used it).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193935">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">t3st3r</div>
					<div class="post-datetime">
						5 Mar 2013, 23:48					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>m.m.m wrote:</cite><blockquote><p>since noob beginner, I found out I should make a contact with the router with its serial port after a lot of searching. built the ttl to rs232 converter</p></blockquote></div><p>You&#039;re doing things in either strange or even dangerous ways. As of 2013 the simplest way to convert USB to low-voltage UART is to use appropriate chip like FT232, CP201...2103 and somesuch. And of course there are ready solutions based on these ICs selling around. Starting from &quot;old&quot; mobile phone cables&nbsp; (which convert USB to low-voltage UART excatly like that one you need) up to embedded developer tools (those guys are often use those UARTs for debug). In fact USB to UART converters are quite common and inexpensive these days. You can read openwrt wiki to get some ideas on this. </p><p>If I got it right. you are about to convert USB to RS232 first (RS232 is *not* level compatible with 3.3V UART!) and then ... downconvert it to 3.3V UART using MAX232? </p><p>Usually &quot;USB to RS232&quot; converter is in fact some USB to UART bridge IC like FT232, CP2101 or similar, which converts USB to low-voltage UART (like that one you actually need) and then another IC shifts levels to RS232 using IC like MAX232 to reach RS232 compatibility (i.e. bipolar 12V levels, you don&#039;t need or want them!). Then you put yet another MAX232 to ... downshift levels back to 3.3V UART? <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Well, you see, it&#039;s a bit silly: two extra MAX232-like ICs on the way and RS232 physical level used which you don&#039;t need or want anyway. OTOH it makes things more complicated, could make signal worse and harder to troubleshoot as there are more connections involved. Though theoretically it could work and isn&#039;t anyhow invalid on it&#039;s own. Just somewhat suboptimal. </p><p>And hopefully you&#039;ve never attached RS232 (bi-polar, 12V) levels to 3.3V UART. Doing so is likely to fry router CPU. Pay extra attention to this. As for me it&#039;s not a great idea to have RS232 bipolar 12V levels around when dealing with 3.3V ICs. Basically it&#039;s wrong to attach digital I/O pins to anything above IC supply (i.e. 3.3V) or below GNS (0V). Doing so is likely to fry IC. That&#039;s why modern ICs need MAX232-like level shifter to operate with ancient bipolar RS232 levels. </p><p>Then, guy suggested that<br />1) Grab your converter. <br />2) Connect converter&#039;s TX pin to converter&#039;s RX pin. There should be no other devices attached to UART (i.e. don&#039;t connect bricked device, etc). <br />3) Start some terminal and connect to that COM port.<br />4) Set up port to use no flow control. And make sure local echo is off. <br />5) Type something. <br />5) Check if you can see what you type.</p><p>If everything is done correctly and your converter actually works, you will see same text as you typed because it&#039;s transmitted via TX line and then immediately received via RX like on the same port (that&#039;s why guy asked to connect them). Note that terminal could do local echo - make sure it&#039;s off. This test allows to understand if your converter actually works and is able to transmit data and receive it back.&nbsp; It&#039;s easier since no external devices involved, only converter itself should work for this test. If you can&#039;t get past this point, there is something wrong with your converter, OS drivers, port settings or something else, not anyhow related to bricked device(s) or something like that.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p194121">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">m.m.m</div>
					<div class="post-datetime">
						7 Mar 2013, 11:18					</div>
				</div>
				<div class="post-content content">
					<p>thanks for the replay, I tested it, when I open the putty terminal, I can type anything in it but after pressing enter, nothing appears. I could not find any settings for the local echo.<br />I tested these but didn&#039;t get any reaction:<br />echo &#039;hi&#039;<br />echo &quot;hi&quot;<br />echo&quot;hi&quot;<br />echo &#039;hi&#039;;<br />I used my routers VCC and GND terminals as the power supply for my converter.<br />I have sp3232 and max232, I didn&#039;t try the max232. should I try it or are they the same?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p194125">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">MBS</div>
					<div class="post-datetime">
						7 Mar 2013, 12:24					</div>
				</div>
				<div class="post-content content">
					<p>you were supposed to receive an echo of every keypress, instantly. Since that failed, there is a problem with your converter. My recommendation is to get a cheap usb-ttl 3.3V converter (aka cell phone cable).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p194129">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">m.m.m</div>
					<div class="post-datetime">
						7 Mar 2013, 13:15					</div>
				</div>
				<div class="post-content content">
					<p>which one do you think I should use?<br />max232 (5v)<br />or<br />sp3232 (3.3v)<br />?<br />thanks.<br />I want to make something so I don&#039;t want to buy any modules <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p194185">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">MBS</div>
					<div class="post-datetime">
						7 Mar 2013, 21:45					</div>
				</div>
				<div class="post-content content">
					<p>no offense, but this seems to be above your skills. your main focus in this forum should be to get your router running again. so do yourself a favor and get a ready built cable.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p194360">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">m.m.m</div>
					<div class="post-datetime">
						9 Mar 2013, 19:03					</div>
				</div>
				<div class="post-content content">
					<p>I could not find a 3.3 one at our local stores. <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /> I&#039;m trying to make it, but I don&#039;t know why, it doesn&#039;t work.<br />and a replay to t3st3r:<br />do you mean I could use my rs232 - usb converter as a ttl - rs232 module too? how? I could not understand what do you exactly mean. could you please provide a schematic for that? thanks.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p194368">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">m.m.m</div>
					<div class="post-datetime">
						9 Mar 2013, 20:05					</div>
				</div>
				<div class="post-content content">
					<p>please take a look<br />this is what I get in terminal:<br /><a href="http://avardeh.persiangig.com/files/lesson.gif">http://avardeh.persiangig.com/files/lesson.gif</a><br />sorry for the bad quality I tried to keep it in low size.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p194950">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">m.m.m</div>
					<div class="post-datetime">
						15 Mar 2013, 12:08					</div>
				</div>
				<div class="post-content content">
					<p>somebody help please!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p195965">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">m.m.m</div>
					<div class="post-datetime">
						24 Mar 2013, 21:25					</div>
				</div>
				<div class="post-content content">
					<p>it seems no one knows the way to fix it <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p195973">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">vhrm</div>
					<div class="post-datetime">
						24 Mar 2013, 22:30					</div>
				</div>
				<div class="post-content content">
					<p>Help with what?&nbsp; &nbsp;You&#039;re not answering anyone&#039;s questions and you&#039;re not listening to what people are suggesting.</p><p>In Putty local echo is on the main &quot;Terminal&quot; settings screen.&nbsp; &nbsp;It&#039;s an option very mysteriously called &quot;Local echo&quot;.&nbsp; &nbsp;For your test session turn both &quot;local echo&quot; and &quot;local line editing&quot;&nbsp; to &quot;off&quot;.&nbsp; &nbsp; And make sure you click &quot;save session&quot; after you change the settings otherwise they&#039;ll only be changed for that one time.</p><p>In your video&nbsp; you&#039;re seeing that when?&nbsp; You haven&#039;t said what&#039;s connected to what etc.</p><p>You also haven&#039;t said what&nbsp; serial settings you&#039;re using and why ( baud rate, parity , flow control etc.)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p196045">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">m.m.m</div>
					<div class="post-datetime">
						25 Mar 2013, 11:41					</div>
				</div>
				<div class="post-content content">
					<p>thanks for the replay, I found the local echo settings and turned it off but nothing changed <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /> I still get a response like this:<br /><a href="http://avardeh.persiangig.com/files/lesson.gif">http://avardeh.persiangig.com/files/lesson.gif</a><br />there is a 5v ttl to rs232 converter available in stores here, but my router can only provide 3.3v.<br />my settings are:<br />speed:115200<br />local echo,local line editing:force off<br />flow control: none<br />parity:none<br />data bits:8<br />stop bits:1<br />I am making the converter currently on a breadboard.<br />I tried it again, it&#039;s not working anymore. I can&#039;t either type anything on terminal! <img src="https://forum.openwrt.org/img/smilies/yikes.png" width="15" height="15" alt="yikes" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p196106">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">vhrm</div>
					<div class="post-datetime">
						25 Mar 2013, 19:17					</div>
				</div>
				<div class="post-content content">
					<p>a)&nbsp; like @MBS said in his 2nd message.&nbsp; &nbsp;Did you try&nbsp; disconnecting tx and rx from the board and shorting them together ?&nbsp; &nbsp; &nbsp; on your chip (not on the board )&nbsp; to see that when you are&nbsp; sending to yourself you see letters ?&nbsp; &nbsp; &nbsp; </p><p>b) What speed is listed for your router in the wiki <a href="http://wiki.openwrt.org/toh/d-link/dir-300">http://wiki.openwrt.org/toh/d-link/dir-300</a>&nbsp; ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p196188">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">thierry69</div>
					<div class="post-datetime">
						26 Mar 2013, 08:20					</div>
				</div>
				<div class="post-content content">
					<p>are you sure to use the right port number ? <img src="https://forum.openwrt.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /><br />because on laptop rs232 port i think it is COM1 or 2<br /><a href="http://isl3893.sourceforge.net/serial-max3232.gif">http://isl3893.sourceforge.net/serial-max3232.gif</a> , if you use this one&nbsp; , you don&#039;t use the usb port ?</p><div class="quotebox"><cite>m.m.m wrote:</cite><blockquote><p>I forgot to say: I am using a rs232/usb converter because I am using a laptop.</p></blockquote></div><p>usb to RS232 + RS232 to TTL converter ?? or RS232 to TTL only ?</p>											<p class="post-edited">(Last edited by <strong>thierry69</strong> on 26 Mar 2013, 15:15)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p196245">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">m.m.m</div>
					<div class="post-datetime">
						26 Mar 2013, 15:29					</div>
				</div>
				<div class="post-content content">
					<p>yes, I connected pins 13 and 14 together and I am just using my router&#039;s GND, VCC ports. so I think the speed and more options don&#039;t matter yet, and because I am using usb to rs232 converter, my com port number every time goes one up. it&#039;s com12 now.<br />is it wrong to use a usb to RS232 and then a RS232 to ttl converter? so what should I do? :-?</p>											<p class="post-edited">(Last edited by <strong>m.m.m</strong> on 26 Mar 2013, 15:32)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p196253">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">robthebrew</div>
					<div class="post-datetime">
						26 Mar 2013, 15:59					</div>
				</div>
				<div class="post-content content">
					<p>If you have already tried RS232, your router&#039;s serial is quite likely fried. RS232 is 12V nominal.<br />What you would be best with (if you really want to roll your own) is an old Nokia cable. There is info around the site somewhere on how to hack it. Or google &quot;nokia serial ttl hack&quot; or similar.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p196261">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">FriedZombie</div>
					<div class="post-datetime">
						26 Mar 2013, 16:12					</div>
				</div>
				<div class="post-content content">
					<p>I think first of test if the comport itself is working properly<br /><a href="http://www.ni.com/white-paper/3450/en">http://www.ni.com/white-paper/3450/en</a></p><p>Hyperterminal is a rather old program, but putty can be used for that as well.</p><p>Check if it functions properly, because usb to rs232 can be a real pain in the neck because of the issues that can occure.</p><p>And of course you also allready could have fried the routers serial as well in the process,but the voltage that comes from rs232 can be from arround 5 to 15 volt. So you can be inluck.</p><p>A lot of usb -&gt;rs232 adapters I have used where arround 5 volt.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p196302">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">vhrm</div>
					<div class="post-datetime">
						26 Mar 2013, 19:26					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>robthebrew wrote:</cite><blockquote><p>If you have already tried RS232, your router&#039;s serial is quite likely fried. RS232 is 12V nominal.<br />What you would be best with (if you really want to roll your own) is an old Nokia cable. There is info around the site somewhere on how to hack it. Or google &quot;nokia serial ttl hack&quot; or similar.</p></blockquote></div><p>You&#039;re absolutely right, but wasn&#039;t this addressed just a few messages ago?</p><p>Also there&#039;s nothing particularly incorrect about his basic design, he&#039;s just bad about testing, and communicating (and some other things )...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p196307">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">thierry69</div>
					<div class="post-datetime">
						26 Mar 2013, 20:08					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>m.m.m wrote:</cite><blockquote><p>is it wrong to use a usb to RS232 and then a RS232 to ttl converter? so what should I do? :-?</p></blockquote></div><br /><br /><p>can be put together the output of rx and tx of the adapter USB/RS232&nbsp; (without plugging the adapter RS232/TTL)</p><p>pin <strong>2</strong> and <strong>3</strong> and type something in your terminal ??&nbsp; (maybe I say a stupidity)</p><p><a href="http://www.imagup.com/npic/1178987108.html"><span class="postimg"><img src="http://npic.imagup.com/1/1178987108.jpg" alt="http://npic.imagup.com/1/1178987108.jpg" /></span></a>&nbsp; <a href="http://www.imagup.com/npic/1178987802.html"><span class="postimg"><img src="http://npic.imagup.com/2/1178987801.jpg" alt="http://npic.imagup.com/2/1178987801.jpg" /></span></a></p><p>i think this is your adapter&nbsp; (or similar )usb/rs232 :</p><p><a href="http://www.imagup.com/npic/1178987288.html"><span class="postimg"><img src="http://npic.imagup.com/1/1178987288.jpg" alt="http://npic.imagup.com/1/1178987288.jpg" /></span></a></p>											<p class="post-edited">(Last edited by <strong>thierry69</strong> on 26 Mar 2013, 21:06)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p196626">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">m.m.m</div>
					<div class="post-datetime">
						29 Mar 2013, 16:14					</div>
				</div>
				<div class="post-content content">
					<p>I think I do. when I type something (like afsdfgfdg, even not a echo command) and then press enter, in that line, what I wrote appears and the only thing appears is that the pointer comes to the first word of the line. just like this photo:<br /><a href="http://avardeh.persiangig.com/files/lesson.gif">http://avardeh.persiangig.com/files/lesson.gif</a><br />and then when I type something new in that line, every word of it overwrites my previous command.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p196808">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">m.m.m</div>
					<div class="post-datetime">
						1 Apr 2013, 01:22					</div>
				</div>
				<div class="post-content content">
					<p>is it the right respond or my converter is corrupted?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p196818">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">thierry69</div>
					<div class="post-datetime">
						1 Apr 2013, 09:39					</div>
				</div>
				<div class="post-content content">
					<p>hi,</p><p>i think the simply way is to buy a sub/TTL converter&nbsp; about 2 or 3 â‚¬&nbsp; on Eb** ,&nbsp; <br />after we can help you more easily with a good serial link.</p><p><a href="http://www.imagup.com/npic/1179463962.html"><span class="postimg"><img src="http://npic.imagup.com/1/1179463962.jpg" alt="http://npic.imagup.com/1/1179463962.jpg" /></span></a></p><p>I think there is problem between the driver of the first USB/RS232 converter and the second converter rs232 to ttl ...</p>											<p class="post-edited">(Last edited by <strong>thierry69</strong> on 1 Apr 2013, 09:45)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>