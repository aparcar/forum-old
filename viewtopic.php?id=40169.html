<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Sagem F@ST 2604 - Illegal Image</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 5 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p181629">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">skualos</div>
					<div class="post-datetime">
						27 Oct 2012, 21:31					</div>
				</div>
				<div class="post-content content">
					<p>Hello.<br />Sagem F@ST 2604 support has just been added (<a href="http://wiki.openwrt.org/toh/sagem/fast2604">http://wiki.openwrt.org/toh/sagem/fast2604</a>) with changeset 33886 (<a href="https://dev.openwrt.org/changeset/33886">https://dev.openwrt.org/changeset/33886</a>).</p><p>I tried to install all of the images for that device through tftp (router is the client), but always get the same meesasge: </p><p>Not regular image file<br />Tftp Image failed: Illegal image.</p><p>Is there a way to get around this ?</p><p>Below is the log of the telnet connection with the router. Mine is from Portugal locked to the Optimus network on the ppp login.</p><p>Trying 192.168.1.1...<br />Connected to 192.168.1.1.<br />Escape character is &#039;^]&#039;.<br />FAST2604 ADSL Router (Software Version:3.35.12a4G)<br />Login: SuperUser<br />Password: c|!xn0v!s<br />Note: If you have problem with Backspace key, please make sure you configure your terminal emulator settings. For instance, from HyperTerminal you would need to use File-&gt;Properties-&gt;Setting-&gt;Back Space key sends.</p><p>&nbsp; &nbsp;Main Menu</p><p>1.&nbsp; ADSL Link State<br />2.&nbsp; LAN<br />3.&nbsp; WAN<br />4.&nbsp; DNS Server<br />5.&nbsp; Route Setup<br />6.&nbsp; NAT<br />7.&nbsp; Firewall<br />8.&nbsp; Quality Of Service<br />9.&nbsp; Management<br />10. Passwords<br />11. Diag<br />12. Reset to Default<br />13. Save and Reboot<br />14. Exit<br /> -&gt; 9</p><p>Note: If you have problem with Backspace key, please make sure you configure your terminal emulator settings. For instance, from HyperTerminal you would need to use File-&gt;Properties-&gt;Setting-&gt;Back Space key sends.</p><p>&nbsp; &nbsp;Management Menu</p><p>1. Settings<br />2. System Log<br />3. SNMP Agent<br />4. SIP Proxy<br />5. Access Control<br />6. Update Software<br />7. Exit<br />/ Management -&gt; 6</p><br /><p>Note: If you have problem with Backspace key, please make sure you configure your terminal emulator settings. For instance, from HyperTerminal you would need to use File-&gt;Properties-&gt;Setting-&gt;Back Space key sends.</p><br /><p>&nbsp; &nbsp;Update Software Menu</p><p>1. Update Software<br />2. Exit<br />/ Management/Update Software -&gt; 1</p><p>&nbsp; &nbsp; &nbsp; &nbsp; Update Software</p><p>Press &lt;enter&gt; to use current value<br />Press &lt;esc&gt; and &lt;enter&gt; to cancel</p><p>Tftp Server IP address (): 192.168.1.2<br />Update Software File Name (bcm963xx_fs_kernel): openwrt-F@ST2604-squashfs-cfe.bin<br />kill process [pid: 204] [name: pvc2684d]...<br />kill process [pid: 674] [name: klogd]...<br />kill process [pid: 668] [name: syslogd]...<br />kill process [pid: 718] [name: pppd]...<br />kill process [pid: 263] [name: igmp]...</p><p>Remaining modules:<br />vnet 592 0 - Live 0xc000c000<br />ipt_string 1776 0 - Live 0xc010c000<br />ipt_REJECT 4544 0 - Live 0xc0110000<br />nat_cache 7856 0 - Live 0xc0058000<br />ip_conntrack 29296 1 nat_cache, Live 0xc005e000<br />ip_tables 14144 2 ipt_string,ipt_REJECT, Live 0xc000e000<br />wl 882672 0 - Live 0xc01b6000<br />bcm_enet 25856 1 vnet, Live 0xc001b000<br />bcmprocfs 12320 0 - Live 0xc0016000<br />br2684 66048 4294967294 - Live 0xc0036000<br />blaa_dd 6880 0 - Live 0xc0013000<br />adsldd 168240 0 - Live 0xc006f000<br />atmapi 56000 3 br2684,blaa_dd,adsldd, Live 0xc0027000<br />Done removing processes<br />Not regular image file<br />Allocating 4194324 bytes for flash image.<br />Memory allocated<br />Total image size: 2490372<br />Not regular image file<br />Tftp Image failed: Illegal image.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p181634">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">KanjiMonster</div>
					<div class="post-datetime">
						27 Oct 2012, 22:30					</div>
				</div>
				<div class="post-content content">
					<p>The wiki says</p><div class="quotebox"><blockquote><p><strong>Flashing ANY Firmware</strong></p><p> You must set your TCP/IP v4 protocol to: </p><p> IP: 192.168.1.2</p><p> Netmask: 255.255.255.0</p><p> Gateway: 192.168.1.1</p><p>DNS: (optional, can be blank).</p><p> Then: </p><p> Power off the router.</p><p> Press reset button near the antenna.</p><p> Keep it pressed while powering up during ~20+ seconds.</p><p> Acces to <a href="http://192.168.1.1">http://192.168.1.1</a> and upload binary file.</p><p> Wait until router reboots.</p></blockquote></div><p>Have you tried that?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p181635">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">skualos</div>
					<div class="post-datetime">
						27 Oct 2012, 22:39					</div>
				</div>
				<div class="post-content content">
					<p>Yes, but on the router GUI the only option is &#039;upload settings&#039;, not &#039;upload software&#039;.<br />But I tried it anyway, and it gives the same &#039;Illegal image&#039; message.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p181641">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">KanjiMonster</div>
					<div class="post-datetime">
						28 Oct 2012, 00:22					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>skualos wrote:</cite><blockquote><p>Yes, but on the router GUI the only option is &#039;upload settings&#039;, not &#039;upload software&#039;.<br />But I tried it anyway, and it gives the same &#039;Illegal image&#039; message.</p></blockquote></div><p>If you get &quot;upload settings&quot; then you are doing it wrong.</p><p>There should be one static page with only black on white text, and the form for uploading the image, nothing more, nothing less.</p><p>Note that you have to press the reset button before powering on the router and keep it pressed for at least 20 seconds. If you can ping the device on 192.168.1.1 and get responses with TTL=100, you succeeded.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p181643">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">skualos</div>
					<div class="post-datetime">
						28 Oct 2012, 01:17					</div>
				</div>
				<div class="post-content content">
					<p>You were right. In fact you have to hold the reset button for around 40 seconds, then the green power led turns red. Then when I went to 192.168.1.1 I got the black on white text.</p><p>But now I&#039;m having another problem. This page has two buttons, one is &quot;upload file&quot;, then you have to wait one minute, then click on the &quot;save / reboot&quot; button.</p><p>When I click to upload my image, I&#039;m redirected to another page: <a href="http://192.168.1.1/upload.cgi">http://192.168.1.1/upload.cgi</a></p><p>This page displays the following code: (note that the first html bracket is missing, wich I think is the reason the upload is not working.</p><div class="codebox"><pre><code>html&gt;
   &lt;head&gt;
      &lt;meta HTTP-EQUIV=&#039;Pragma&#039; CONTENT=&#039;no-cache&#039;&gt;
            &lt;script language=&quot;javascript&quot;&gt;
&lt;!-- hide

var progress = 0;

function isInProgress() {
   if ( progress == 0 )  {
      progress = 1;
      return true;
   }
   alert(&#039;Upload software is in progress. Please wait for a minute.&#039;);
   return false;
}

// done hiding --&gt;
&lt;/script&gt;
   &lt;/head&gt;
   &lt;body&gt;
      &lt;blockquote&gt;
         &lt;form method=&#039;post&#039; ENCTYPE=&#039;multipart/form-data&#039; action=&#039;upload.cgi&#039; onSubmit=&#039;return isInProgress();&#039;&gt;
            &lt;b&gt;Update Software&lt;/b&gt;&lt;br&gt;
            &lt;br&gt;
            &lt;b&gt;Step 1:&lt;/b&gt; Obtain an updated software image file or configuration file from Sagem.&lt;br&gt;
            &lt;br&gt;
            &lt;b&gt;Step 2:&lt;/b&gt; Enter the path to the file location in the box below or 
            click the &amp;quot;Browse&amp;quot; button to locate the file.&lt;br&gt;
            &lt;br&gt;
            &lt;b&gt;Step 3:&lt;/b&gt; Click the &quot;Update Software&quot; button once to upload the new
            file.&lt;br&gt;
            &lt;br&gt;
            NOTE: The update process takes about 1 minutes to complete, and your DSL Router 
            will not reboot automatically, you have to click &#039;Save/Reboot&#039; button to reboot router.&lt;br&gt;
            &lt;br&gt;
            &lt;table border=&quot;0&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot;&gt;
               &lt;tr&gt;
                  &lt;td&gt;Software File Name:&amp;nbsp;
                  &lt;/td&gt;
                  &lt;td&gt;&lt;input type=&#039;file&#039; name=&#039;filename&#039; size=&#039;15&#039;&gt;&lt;/td&gt;
               &lt;/tr&gt;
            &lt;/table&gt;
            &lt;p align=&quot;center&quot;&gt;&lt;input type=&#039;submit&#039; value=&#039;Update Software&#039;&gt;&lt;/p&gt;
         &lt;/form&gt;
      &lt;/blockquote&gt;
       &lt;blockquote&gt;
        &lt;form action=&#039;upload.cgi&#039; method=&#039;get&#039; &gt;
        &lt;table border=&quot;0&quot; cellpadding=&quot;4&quot; cellspacing=&quot;0&quot;&gt;
              &lt;tr&gt;
                     &lt;td width=&quot;120&quot; &gt;Current MAC Address:&lt;/td&gt;
                     &lt;td&gt;
                        À¨
                     &lt;/td&gt;
              &lt;/tr&gt;
        &lt;/table&gt;
        &lt;/form&gt;
      &lt;/blockquote&gt;
       &lt;blockquote&gt;
        
        &lt;form action=&#039;reboot.cgi&#039; &gt;
        
       &lt;tr&gt;
        &lt;blockquote&gt;
         &lt;center&gt;
            &lt;br&gt;
            &lt;strong&gt;Click the button below to save and reboot the router.&lt;/strong&gt;
        &lt;/blockquote&gt;&lt;/center&gt;
              &lt;p align=&quot;center&quot;&gt;
              &lt;input type=&#039;submit&#039;  value=&#039;Save/Reboot&#039;&gt;
              &lt;/p&gt;      
      &lt;/tr&gt;
      &lt;/form&gt;
      
      &lt;/blockquote&gt;
   &lt;/body&gt;
&lt;/html&gt;</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p181644">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">KanjiMonster</div>
					<div class="post-datetime">
						28 Oct 2012, 01:30					</div>
				</div>
				<div class="post-content content">
					<p>No Idea. Maybe try again? </p><p>I had that effect also with the unmodified bootloaders (i.e. that the page after uploading the image was displayed as source code), but there it was just cosmetical, as it directly flashed without any further confirmation after uploading.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p181645">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">skualos</div>
					<div class="post-datetime">
						28 Oct 2012, 01:37					</div>
				</div>
				<div class="post-content content">
					<p>I tried several times. I tried waiting a couple minutes then rebooting the router manually, and also tried clicking &quot;back&quot; on the browser, to come back to the first page, and then from there click on the reboot button.</p><p>Every time the router comes back to its factory defaults...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p181647">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">KanjiMonster</div>
					<div class="post-datetime">
						28 Oct 2012, 02:31					</div>
				</div>
				<div class="post-content content">
					<p>Have you tried a different browser? Maybe it doesn&#039;t like the one you use. If that doesn&#039;t help, then you will have to wait for the one that wrote the support for the device (I only committed it, but I don&#039;t own such a device).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p181675">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">skualos</div>
					<div class="post-datetime">
						28 Oct 2012, 14:37					</div>
				</div>
				<div class="post-content content">
					<p>Hello. I was using Firefox on Windows 7.</p><p>I tried IE on Windows 7 and Firefox and Chrome on Ubuntu 12.04.</p><p>Thoes 3 did not load the source code after hitting the &quot;Update Software&quot; button.</p><p>Instead they loaded the same page, but with one difference.</p><p>In the first page I have the router mac address:</p><p>Current MAC Address: 00:25:69:73:80:93</p><p>After the page reloads, I have </p><p>Current MAC Address: À¨</p><p>Then I click &quot;Save/Reboot&quot;, but the firmware is still the one from Sagem.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p181903">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">skualos</div>
					<div class="post-datetime">
						30 Oct 2012, 21:40					</div>
				</div>
				<div class="post-content content">
					<p>hello<br />anyone have some more ideias ?<br />thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193674">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">1050356</div>
					<div class="post-datetime">
						3 Mar 2013, 14:18					</div>
				</div>
				<div class="post-content content">
					<p>Hi!</p><p>I new at this forum..</p><p>My english is far away to be perfect... sorry!</p><p>First of all, thanks for receiving me at your comunity!</p><p>I&#039;ve a sagem F@ST 2604 (From a Portuguese company CLIXNOVIS) and i entered in router menu of two ways...</p><p>1- By clicking in reset button for 40 seconds long. Then will appear a menu with the option update software. (Acessing router through IE9 192.168.1.1).<br />Then i select (open wrt -&gt; openwrt-F@ST2604-squashfs-cfe.bin) throw browse file button.<br />After that i click in update and i wait a minute. Then i click in SAVE/Apply.<br />But nothing happens.....</p><p>2- Method i define a static ip in my computer (192.168.1.2 and a mask:255 255 255 0).<br /> I have installed a server tftp where i put the file(.bin) and i connect to router with teraterm aplication with telnet connection to IP 192.168.1.1. <br />The router ask me for login and I put:<br />user:SuperUser&nbsp; pass:c|!xn0v!s .<br />Then will appear the menu of router in teraterm, then i select Management (9) -&gt; Update Soft(6)-&gt; Update(1) and<br />the router ask me to witch IP it should connect (I give mine 192.168.1.2).<br />Next question is what is the name of the file: openwrt-F@ST2604-squashfs-cfe.bin </p><p>then it start to transfer the file...</p><p>But happens to me the same that happens to skualos....</p><p>Trying 192.168.1.1...<br />Connected to 192.168.1.1.<br />Escape character is &#039;^]&#039;.<br />FAST2604 ADSL Router (Software Version:3.35.12a4G)<br />Login: SuperUser<br />Password: c|!xn0v!s<br />Note: If you have problem with Backspace key, please make sure you configure your terminal emulator settings. For instance, from HyperTerminal you would need to use File-&gt;Properties-&gt;Setting-&gt;Back Space key sends.</p><p>&nbsp; &nbsp;Main Menu</p><p>1.&nbsp; ADSL Link State<br />2.&nbsp; LAN<br />3.&nbsp; WAN<br />4.&nbsp; DNS Server<br />5.&nbsp; Route Setup<br />6.&nbsp; NAT<br />7.&nbsp; Firewall<br />8.&nbsp; Quality Of Service<br />9.&nbsp; Management<br />10. Passwords<br />11. Diag<br />12. Reset to Default<br />13. Save and Reboot<br />14. Exit<br />-&gt; 9</p><p>Note: If you have problem with Backspace key, please make sure you configure your terminal emulator settings. For instance, from HyperTerminal you would need to use File-&gt;Properties-&gt;Setting-&gt;Back Space key sends.</p><p>&nbsp; &nbsp;Management Menu</p><p>1. Settings<br />2. System Log<br />3. SNMP Agent<br />4. SIP Proxy<br />5. Access Control<br />6. Update Software<br />7. Exit<br />/ Management -&gt; 6</p><p>Note: If you have problem with Backspace key, please make sure you configure your terminal emulator settings. For instance, from HyperTerminal you would need to use File-&gt;Properties-&gt;Setting-&gt;Back Space key sends.</p><p>&nbsp; &nbsp;Update Software Menu</p><p>1. Update Software<br />2. Exit<br />/ Management/Update Software -&gt; 1</p><p>&nbsp; &nbsp; &nbsp; &nbsp; Update Software</p><p>Press &lt;enter&gt; to use current value<br />Press &lt;esc&gt; and &lt;enter&gt; to cancel</p><p>Tftp Server IP address (): 192.168.1.2<br />Update Software File Name (bcm963xx_fs_kernel): openwrt-F@ST2604-squashfs-cfe.bin<br />kill process [pid: 204] [name: pvc2684d]...<br />kill process [pid: 674] [name: klogd]...<br />kill process [pid: 668] [name: syslogd]...<br />kill process [pid: 718] [name: pppd]...<br />kill process [pid: 263] [name: igmp]...</p><p>Remaining modules:<br />vnet 592 0 - Live 0xc000c000<br />ipt_string 1776 0 - Live 0xc010c000<br />ipt_REJECT 4544 0 - Live 0xc0110000<br />nat_cache 7856 0 - Live 0xc0058000<br />ip_conntrack 29296 1 nat_cache, Live 0xc005e000<br />ip_tables 14144 2 ipt_string,ipt_REJECT, Live 0xc000e000<br />wl 882672 0 - Live 0xc01b6000<br />bcm_enet 25856 1 vnet, Live 0xc001b000<br />bcmprocfs 12320 0 - Live 0xc0016000<br />br2684 66048 4294967294 - Live 0xc0036000<br />blaa_dd 6880 0 - Live 0xc0013000<br />adsldd 168240 0 - Live 0xc006f000<br />atmapi 56000 3 br2684,blaa_dd,adsldd, Live 0xc0027000<br />Done removing processes<br />Not regular image file<br />Allocating 4194324 bytes for flash image.<br />Memory allocated<br />Total image size: 2490372<br />Not regular image file</p><br /><p>Can you help me</p><br /><p>Thanks for your attention....</p><p>best regards</p><p>1050356</p>											<p class="post-edited">(Last edited by <strong>1050356</strong> on 3 Mar 2013, 14:31)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>