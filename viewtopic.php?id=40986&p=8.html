<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> dead after flashing wr703n</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 14 Feb 2014 and 3 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 8 of 13</div><nav><ul><li><a href="viewtopic.php%3Fid=40986&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=40986&amp;p=6.html">6</a></li><li><a href="viewtopic.php%3Fid=40986&amp;p=7.html">7</a></li><li class="pagination-current"><span>8</span></li><li><a href="viewtopic.php%3Fid=40986&amp;p=9.html">9</a></li><li><a href="viewtopic.php%3Fid=40986&amp;p=10.html">10</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=40986&amp;p=13.html">13</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p192301">
				<div class="post-metadata">
					<div class="post-num">Post #176</div>
					<div class="post-author">robthebrew</div>
					<div class="post-datetime">
						17 Feb 2013, 18:30					</div>
				</div>
				<div class="post-content content">
					<p>Did you see this thread:<br /><a href="https://forum.openwrt.org/viewtopic.php?id=42317">https://forum.openwrt.org/viewtopic.php?id=42317</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p192446">
				<div class="post-metadata">
					<div class="post-num">Post #177</div>
					<div class="post-author">jemamena</div>
					<div class="post-datetime">
						19 Feb 2013, 01:31					</div>
				</div>
				<div class="post-content content">
					<p>Hello, <br />I have manage to upload nebbia88&#039;s firmware in my WR703n v1.7 and the ethernet works fine. My problem is that when I try to install some packages ( such as kmod-video-core) it doesn&#039;t install them. Any ideas? are them packages somewhere else or are they not available yet? <br />Thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p192473">
				<div class="post-metadata">
					<div class="post-num">Post #178</div>
					<div class="post-author">nozombian</div>
					<div class="post-datetime">
						19 Feb 2013, 10:29					</div>
				</div>
				<div class="post-content content">
					<p>kmod packages are usually strictly checking svn revision, so if you have different version than is in orfficial repo, you will either have to compile them on your own and include them right in the image with [ * ] option (this is what I strongly recommend), or try to force opkg to install them anyway. I don&#039;t know which switch exactly does this, but you can try some --force: <a href="http://wiki.openwrt.org/doc/techref/opkg#options">http://wiki.openwrt.org/doc/techref/opkg#options</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p192479">
				<div class="post-metadata">
					<div class="post-num">Post #179</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						19 Feb 2013, 11:07					</div>
				</div>
				<div class="post-content content">
					<p>The switch is &quot;force-depends&quot;, but there is risk.</p><p>In general, there is quite strict kernel version &amp; options check through a checksum. In practice, you can only install kmods compiled at the same compilation run as the kernel itself.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p192490">
				<div class="post-metadata">
					<div class="post-num">Post #180</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						19 Feb 2013, 12:42					</div>
				</div>
				<div class="post-content content">
					<p>Only risk is that you eventually have to access failsafe and do a firstboot.. So try the failsafe procedure, and if all works as expected, give force-depends a go, since my image is same revision of rc1 in downloads.. Also maybe backup yout setting before trying <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>											<p class="post-edited">(Last edited by <strong>nebbia88</strong> on 19 Feb 2013, 12:42)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p192759">
				<div class="post-metadata">
					<div class="post-num">Post #181</div>
					<div class="post-author">jemamena</div>
					<div class="post-datetime">
						22 Feb 2013, 01:20					</div>
				</div>
				<div class="post-content content">
					<p>I would like to say that seems to be a solution but seems quite risky and to be honest, with my Linux knowledge I don&#039;t think I will get too far and I really don&#039;t want to brick another one (until I&#039;ll do the serial connection, fingers crossed to that). <br />I suppose once the firmware for the v1.7 is official, someone that knows better what is doing than me will leave the packages in the repos. am I right?<br />Thanks for the advices anyway. It&#039;s just a shame that at least for now is not possible to do the same things you could do with the older versions</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p192803">
				<div class="post-metadata">
					<div class="post-num">Post #182</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						22 Feb 2013, 14:03					</div>
				</div>
				<div class="post-content content">
					<p>You cannot brick it installing packages! Failsafe will always work.. Just make sure that NOW it&#039;s working <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193178">
				<div class="post-metadata">
					<div class="post-num">Post #183</div>
					<div class="post-author">johnson4d</div>
					<div class="post-datetime">
						25 Feb 2013, 22:50					</div>
				</div>
				<div class="post-content content">
					<p>I have a bricked WR703N (wish I read the warnings first!). I also have a brand new v1.7 box.</p><p>I&#039;ve read through this whole thread 2 times now and I&#039;m still unclear what I have to do.....</p><p>For the bricked box, I&#039;ve order the serial TTL. When I get it, I see there is a patch from Nebbia, how exactly do I apply that patch? Do I edit a file using vi or do I TFTP a file or something? How do I apply patches?</p><p>For the new box, what is the process to flash with OpenWRT. I see Nebbia has a file on dropbox - openwrt-ar71xx-generic-tl-wr703n-v1-squashfs-factory.bin - is this version pre-patched and if so I assume this can safely use this for flashing a brand new WR703N with OpenWRT.</p><p>Apologies for the basic nature of this message, but I really need some help. Please help :-)</p><div class="quotebox"><cite>Uncle_Vernon wrote:</cite><blockquote><p>This patched file has recovered my bricked wr703n. The case is stamped V1.6 and the Ethernet sticker says </p><p>TL-WR703N <br />12B048</p><p>The other wr703n I bough of the same Chinese vendor (later order) loaded the snapshot without issue.</p><p>Thanks so much for the efforts to put the patched file together.</p><div class="quotebox"><cite>nebbia88 wrote:</cite><blockquote><p>I ask to the users with bricked 703 and a serial console to test this:</p><p>it&#039;s patched with this,</p><p><a href="https://dev.openwrt.org/changeset/32093">https://dev.openwrt.org/changeset/32093</a></p><p>from mr3020 (almost same board..)</p><p>Thanks to Squonk to point this out <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p><a href="https://www.dropbox.com/s/npiapitjpq4ygzs/openwrt-ar71xx-generic-tl-wr703n-AArc1-r34185-eth-fix.zip">https://www.dropbox.com/s/npiapitjpq4yg … th-fix.zip</a></p><p>WARNING: it has wifi enabled and unencrypted by default <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p></blockquote></div></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193272">
				<div class="post-metadata">
					<div class="post-num">Post #184</div>
					<div class="post-author">johnson4d</div>
					<div class="post-datetime">
						27 Feb 2013, 02:29					</div>
				</div>
				<div class="post-content content">
					<p>Sorry for the spam.... One quick question, which hopefully has a very quick answer.</p><p>Assume I have a bricked WR703N. Also assume that I have a serial connection to the box. Is the fix simply to enable the ethernet interface over the serial connection? If this can be done, the problem is fixed right?</p><p>Or maybe I am trivialising something that is far deeper..... :-/</p><p>Please confirm.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193285">
				<div class="post-metadata">
					<div class="post-num">Post #185</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						27 Feb 2013, 08:39					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>johnson4d wrote:</cite><blockquote><p>Assume I have a bricked WR703N. Also assume that I have a serial connection to the box. Is the fix simply to enable the ethernet interface over the serial connection? If this can be done, the problem is fixed right?</p><p>Or maybe I am trivialising something that is far deeper..... :-/</p><p>Please confirm.</p></blockquote></div><p>I confirm that you are trivialising the fix. ;-)</p><p>It may look rather similar (a console session on terminal), but a serial connection to the console avoids the whole TCP/IP &amp; other internet protocols stack. During the early boot, the console session is typically to the boot manager (like u-boot), and then later the session is passed to the Linux kernel, if it still runs. </p><p>Having direct access to the boot manager helps you to recover even from situation, where the Linux kernel is badly damaged. But the boot manager has usually nothing to do with Openwrt (or Linux), so it depends from the specific boot manager, what commands are usable etc.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193289">
				<div class="post-metadata">
					<div class="post-num">Post #186</div>
					<div class="post-author">johnson4d</div>
					<div class="post-datetime">
						27 Feb 2013, 09:35					</div>
				</div>
				<div class="post-content content">
					<p>Thank you so much for the response.</p><p>Ha, I just found this out for myself - life is never so easy :-(</p><p>OK, I got the serial connection up. I want to apply a fix to the existing version of OpenWRT that is deployed on my bricked box. In essence, I really want a way to simply turn on the eth0. I must have read this whole post a dozen times, each time I seem to find something new (that I missed previously). I see there is a patch, but I don&#039;t know how to apply it.</p><p>Can you please help?</p><div class="quotebox"><cite>hnyman wrote:</cite><blockquote><div class="quotebox"><cite>johnson4d wrote:</cite><blockquote><p>Assume I have a bricked WR703N. Also assume that I have a serial connection to the box. Is the fix simply to enable the ethernet interface over the serial connection? If this can be done, the problem is fixed right?</p><p>Or maybe I am trivialising something that is far deeper..... :-/</p><p>Please confirm.</p></blockquote></div><p>I confirm that you are trivialising the fix. ;-)</p><p>It may look rather similar (a console session on terminal), but a serial connection to the console avoids the whole TCP/IP &amp; other internet protocols stack. During the early boot, the console session is typically to the boot manager (like u-boot), and then later the session is passed to the Linux kernel, if it still runs. </p><p>Having direct access to the boot manager helps you to recover even from situation, where the Linux kernel is badly damaged. But the boot manager has usually nothing to do with Openwrt (or Linux), so it depends from the specific boot manager, what commands are usable etc.</p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193313">
				<div class="post-metadata">
					<div class="post-num">Post #187</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						27 Feb 2013, 13:53					</div>
				</div>
				<div class="post-content content">
					<p>You need to flash an image with the fix!</p><p>You can do it enabling wifi, connect to it, flash from gui..</p><p> <a href="https://forum.openwrt.org/viewtopic.php?pid=186075#p186075">https://forum.openwrt.org/viewtopic.php … 75#p186075</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193360">
				<div class="post-metadata">
					<div class="post-num">Post #188</div>
					<div class="post-author">johnson4d</div>
					<div class="post-datetime">
						27 Feb 2013, 22:35					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for the reply Nebbia, I was hoping you would reply :-)</p><p>Thats a shame. I already tried to flash with your patched AA and although the box is fully recovered, I cannot install certain packages (USB related packages for example). There is a dependancy issue. If I add --nodeps to the package install, it installs, but it doesn&#039;t work. I have been working with the AA RC1 here: <a href="http://downloads.openwrt.org/attitude_adjustment/12.09-rc1/ar71xx/generic/">http://downloads.openwrt.org/attitude_a … x/generic/</a></p><p>The software above is surely different to your patched AA RC1 (aside from the patch fix discussed in this post), I noticed that the banner is slightly different so maybe there are some subtle changes.....? If I install the software from the URL above, I can install the packages no problem and they run perfectly, which is why I want to simply fix the existing version I have instead of re-flashing to a new version.</p><p>I was hoping there is a way to fix the U-Boot without touching the kernel - for clarity you are saying this is not possible?<br />On a side note, has anyone tried downgrading the TP-Link software before trying to install the OpenWRT software? Or maybe, the U-Boot is seperate to the TP-Link code so it would make no difference.....</p><p>Thanks for any replies in advance, they are really helping me.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193362">
				<div class="post-metadata">
					<div class="post-num">Post #189</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						27 Feb 2013, 22:41					</div>
				</div>
				<div class="post-content content">
					<p>--force-depends or --nodeps???</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193366">
				<div class="post-metadata">
					<div class="post-num">Post #190</div>
					<div class="post-author">johnson4d</div>
					<div class="post-datetime">
						27 Feb 2013, 22:55					</div>
				</div>
				<div class="post-content content">
					<p>From above; &quot;If I add --nodeps to the package install, it installs, but it doesn&#039;t work.&quot; so that option doesn&#039;t work....</p><p>I also just tried --force-depends as follows: root@OpenWrt:/# opkg install kmod-usb-storage kmod-fs-ext4 block-mount --force-d<br />epends</p><p>Collected errors:<br /> * satisfy_dependencies_for: Cannot satisfy the following dependencies for kmod-usb-storage:<br /> *&nbsp; &nbsp; &nbsp; kernel (= 3.3.8-1-5440da3a2c45184a32da6bba25b8dd2a) *&nbsp; &nbsp;kernel (= 3.3.8-1-5440da3a2c45184a32da6bba25b8dd2a) * <br /> * satisfy_dependencies_for: Cannot satisfy the following dependencies for kmod-fs-ext4:<br /> *&nbsp; &nbsp; &nbsp; kernel (= 3.3.8-1-5440da3a2c45184a32da6bba25b8dd2a) *&nbsp; &nbsp;kernel (= 3.3.8-1-5440da3a2c45184a32da6bba25b8dd2a) * </p><br /><p>It&nbsp; seems to think the kernel of your patched AA is different to the packages on the web for AA RC1 at <a href="http://downloads.openwrt.org/attitude_adjustment/12.09-rc1/ar71xx/generic/packages/">http://downloads.openwrt.org/attitude_a … /packages/</a></p><p>Any ideas?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193368">
				<div class="post-metadata">
					<div class="post-num">Post #191</div>
					<div class="post-author">johnson4d</div>
					<div class="post-datetime">
						27 Feb 2013, 22:56					</div>
				</div>
				<div class="post-content content">
					<p>But when I try to install the packages on a clean AA RC1 install (hardware not affected by this bug), it installs perfectly and see&#039;s my USB. :-(</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193380">
				<div class="post-metadata">
					<div class="post-num">Post #192</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						28 Feb 2013, 00:05					</div>
				</div>
				<div class="post-content content">
					<p>i confirm the bug, but have absolutely no idea of how to solve it...</p><p>after forcing the package is installed but there are lots of &quot;unknown symbol&quot; errors..</p><br /><p>i thought that using the same svn revision would avoid the deps problems of kmod&#039;s <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>quick solution? use trunk.. but it&#039;s not always stable or safe to flash!</p><p>or built a fresh AA from svn, including all needed kmods...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193599">
				<div class="post-metadata">
					<div class="post-num">Post #193</div>
					<div class="post-author">johnson4d</div>
					<div class="post-datetime">
						2 Mar 2013, 01:09					</div>
				</div>
				<div class="post-content content">
					<p>OK, I am making good progress and learning lots :-)</p><p>I have created my own AA image, with the USB KMOD included and it works - good times. Now, I want to compile ALL the packages, so that they can be installed later via OPKG.</p><p>When I do make menuconfig, I can see under &#039;Global build settings&#039; an option for &#039;Select all packages by default&#039; - I have a * for this but no packages created :-(</p><p>I know there are 1000s of packages, but if I compile them at the time I create my AA image I shouldn&#039;t have any compatibility issues. Can someone explain how to create packages (nmap, etc) so that they can be installed later via OPKG?</p><p>Thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193933">
				<div class="post-metadata">
					<div class="post-num">Post #194</div>
					<div class="post-author">blurp76</div>
					<div class="post-datetime">
						5 Mar 2013, 23:37					</div>
				</div>
				<div class="post-content content">
					<p>My TL-WR703N seems to have an even newer version of U-Boot, i bought it already bricked in China and then resurrected via serial port and the help of nebbia who sent me a dump of his &#039;art&#039; partition.</p><p>root@OpenWrt:~# grep -a U-Boot /dev/mtd0ro | cut -d&#039;I&#039; -f1<br />U-Boot 1.1.4 (Dec&nbsp; 4 2012 - 11:19:44)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />root@OpenWrt:~#&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p>I&#039;m really not an expert of openwrt, but i tried flashing different images and only the seems to work on my device is the one posted at #77. Other builds are giving me troubles with lan and wifi. But still with this version i can&#039;t see to install kmods due to kernel differences. Is the any working build around that will let me install applications?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193936">
				<div class="post-metadata">
					<div class="post-num">Post #195</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						5 Mar 2013, 23:49					</div>
				</div>
				<div class="post-content content">
					<p>What problems did you have with trunk snapshot?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193941">
				<div class="post-metadata">
					<div class="post-num">Post #196</div>
					<div class="post-author">blurp76</div>
					<div class="post-datetime">
						6 Mar 2013, 00:35					</div>
				</div>
				<div class="post-content content">
					<p>I just installed <br /><a href="http://downloads.openwrt.org/snapshots/trunk/ar71xx/openwrt-ar71xx-generic-tl-wr703n-v1-jffs2-factory.bin">http://downloads.openwrt.org/snapshots/ … actory.bin</a></p><p>i&#039;m unable to start wifi at the moment, lan seems to work ok..</p><div class="codebox"><pre><code>root@OpenWrt:/etc/config# cat wireless                                          
config wifi-device  radio0                                                      
        option type     mac80211                                                
        option channel  11                                                      
        option hwmode   11ng                                                    
        option path     &#039;platform/ar933x_wmac&#039;                                  
        option htmode   HT20                                                    
        list ht_capab   SHORT-GI-20                                             
        list ht_capab   SHORT-GI-40                                             
        list ht_capab   RX-STBC1                                                
        list ht_capab   DSSS_CCK-40                                             
        # REMOVE THIS LINE TO ENABLE WIFI:                                      
        #option disabled 1                                                      
                                                                                
config wifi-iface                                                               
        option device   radio0                                                  
        option network  lan                                                     
        option mode     ap                                                      
        option ssid     OpenWrt                                                 
        option encryption none                                                  

root@OpenWrt:/etc/config# wifi on                                               
/sbin/wifi: eval: line 1: hostapd_set_log_options: not found                    
/sbin/wifi: eval: line 1: hostapd_set_bss_options: not found                    
/sbin/wifi: eval: line 1: hostapd: not found                                    
Failed to start hostapd for phy0                                                
root@OpenWrt:/etc/config#          </code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193943">
				<div class="post-metadata">
					<div class="post-num">Post #197</div>
					<div class="post-author">blurp76</div>
					<div class="post-datetime">
						6 Mar 2013, 00:59					</div>
				</div>
				<div class="post-content content">
					<p>I was able to fix it with instructions at:</p><p><a href="https://dev.openwrt.org/ticket/12818">https://dev.openwrt.org/ticket/12818</a></p><p>with:</p><div class="codebox"><pre><code>root@OpenWrt:/tmp# wget http://downloads.openwrt.org/attitude_adjustment/12.09-rc1/ar71xx/generic/packages/wpad-mini_20120910-1_ar71xx.ipk  

root@OpenWrt:/tmp# opkg install wpad-mini_20120910-1_ar71xx.ipk                 
Installing wpad-mini (20120910-1) to root...                                    
Configuring wpad-mini.                                                          
root@OpenWrt:/tmp#      
               </code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p195121">
				<div class="post-metadata">
					<div class="post-num">Post #198</div>
					<div class="post-author">xbaha</div>
					<div class="post-datetime">
						17 Mar 2013, 00:21					</div>
				</div>
				<div class="post-content content">
					<p>hi,<br />i am confused, do we use this patch:<br /><a href="https://www.dropbox.com/s/d15fca1nuky2rtn/mach-tl-wr703n-fix-eth.patch">https://www.dropbox.com/s/d15fca1nuky2r … -eth.patch</a><br />or this:<br /><a href="https://dev.openwrt.org/changeset/32093/trunk/target/linux/ar71xx/files/arch/mips/ath79/mach-tl-mr3020.c">https://dev.openwrt.org/changeset/32093 … l-mr3020.c</a><br />or both??</p><p>the above 2 links are patches for 2 different files....??</p><p>thanks.</p><div class="quotebox"><cite>nebbia88 wrote:</cite><blockquote><p>i think he wanted something like this:</p><p><a href="https://www.dropbox.com/s/d15fca1nuky2rtn/mach-tl-wr703n-fix-eth.patch">https://www.dropbox.com/s/d15fca1nuky2r … -eth.patch</a></p><div class="codebox"><pre><code>Index: target/linux/ar71xx/files/arch/mips/ath79/mach-tl-wr703n.c
===================================================================
--- target/linux/ar71xx/files/arch/mips/ath79/mach-tl-wr703n.c  (revision 34185)
+++ target/linux/ar71xx/files/arch/mips/ath79/mach-tl-wr703n.c  (working copy)
@@ -12,6 +12,7 @@
 #include &lt;linux/gpio.h&gt;
  
 #include &lt;asm/mach-ath79/ath79.h&gt;
+#include &lt;asm/mach-ath79/ar71xx_regs.h&gt;
  
 #include &quot;dev-eth.h&quot;
 #include &quot;dev-gpio-buttons.h&quot;
@@ -62,6 +63,8 @@
    u8 *mac = (u8 *) KSEG1ADDR(0x1f01fc00);
    u8 *ee = (u8 *) KSEG1ADDR(0x1fff1000);
  
+   ath79_setup_ar933x_phy4_switch(false, true);
+
    ath79_register_m25p80(&amp;tl_wr703n_flash_data);
    ath79_register_leds_gpio(-1, ARRAY_SIZE(tl_wr703n_leds_gpio),
                 tl_wr703n_leds_gpio);
@@ -77,6 +80,7 @@
  
    ath79_register_mdio(0, 0x0);
    ath79_register_eth(0);
+   ath79_eth0_data.phy_mask = BIT(0);
  
    ath79_register_wmac(ee, mac);
 }</code></pre></div></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p195136">
				<div class="post-metadata">
					<div class="post-num">Post #199</div>
					<div class="post-author">robthebrew</div>
					<div class="post-datetime">
						17 Mar 2013, 10:28					</div>
				</div>
				<div class="post-content content">
					<p>xbaha, the first is for wr703n the second for mr3020</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p195165">
				<div class="post-metadata">
					<div class="post-num">Post #200</div>
					<div class="post-author">xbaha</div>
					<div class="post-datetime">
						17 Mar 2013, 16:47					</div>
				</div>
				<div class="post-content content">
					<p>Thanks alot for the clarification,<br />i patched the source, but the thing is, there was an extra line in my code (just downloded last trunk)</p><p>//&nbsp; &nbsp; ath79_setup_ar933x_phy4_switch(false, false);<br />&nbsp; &nbsp; ath79_setup_ar933x_phy4_switch(false, true);</p><p>i just omitted the existing one, and added the patched one, just want to make sure my code below is ok?</p><p>Thanks.</p><div class="quotebox"><cite>robthebrew wrote:</cite><blockquote><p>xbaha, the first is for wr703n the second for mr3020</p></blockquote></div><br /><br /><br /><div class="quotebox"><cite>code wrote:</cite><blockquote><p>/*<br /> *&nbsp; TP-LINK TL-WR703N board support<br /> *<br /> *&nbsp; Copyright (C) 2011 dongyuqi &lt;729650915@qq.com&gt;<br /> *&nbsp; Copyright (C) 2011-2012 Gabor Juhos &lt;juhosg@openwrt.org&gt;<br /> *<br /> *&nbsp; This program is free software; you can redistribute it and/or modify it<br /> *&nbsp; under the terms of the GNU General Public License version 2 as published<br /> *&nbsp; by the Free Software Foundation.<br /> */</p><p>#include &lt;linux/gpio.h&gt;</p><p>#include &lt;asm/mach-ath79/ath79.h&gt;<br />#include &lt;asm/mach-ath79/ar71xx_regs.h&gt;</p><p>#include &quot;dev-eth.h&quot;<br />#include &quot;dev-gpio-buttons.h&quot;<br />#include &quot;dev-leds-gpio.h&quot;<br />#include &quot;dev-m25p80.h&quot;<br />#include &quot;dev-usb.h&quot;<br />#include &quot;dev-wmac.h&quot;<br />#include &quot;machtypes.h&quot;</p><p>#define TL_WR703N_GPIO_LED_SYSTEM&nbsp; &nbsp; 27<br />#define TL_WR703N_GPIO_BTN_RESET&nbsp; &nbsp; 11</p><p>#define TL_WR703N_GPIO_USB_POWER&nbsp; &nbsp; 8</p><p>#define TL_WR703N_KEYS_POLL_INTERVAL&nbsp; &nbsp; 20&nbsp; &nbsp; /* msecs */<br />#define TL_WR703N_KEYS_DEBOUNCE_INTERVAL&nbsp; &nbsp; (3 * TL_WR703N_KEYS_POLL_INTERVAL)</p><p>static const char *tl_wr703n_part_probes[] = {<br />&nbsp; &nbsp; &quot;tp-link&quot;,<br />&nbsp; &nbsp; NULL,<br />};</p><p>static struct flash_platform_data tl_wr703n_flash_data = {<br />&nbsp; &nbsp; .part_probes&nbsp; &nbsp; = tl_wr703n_part_probes,<br />};</p><p>static struct gpio_led tl_wr703n_leds_gpio[] __initdata = {<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; .name&nbsp; &nbsp; &nbsp; &nbsp; = &quot;tp-link:blue:system&quot;,<br />&nbsp; &nbsp; &nbsp; &nbsp; .gpio&nbsp; &nbsp; &nbsp; &nbsp; = TL_WR703N_GPIO_LED_SYSTEM,<br />&nbsp; &nbsp; &nbsp; &nbsp; .active_low&nbsp; &nbsp; = 1,<br />&nbsp; &nbsp; },<br />};</p><p>static struct gpio_keys_button tl_wr703n_gpio_keys[] __initdata = {<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; .desc&nbsp; &nbsp; &nbsp; &nbsp; = &quot;reset&quot;,<br />&nbsp; &nbsp; &nbsp; &nbsp; .type&nbsp; &nbsp; &nbsp; &nbsp; = EV_KEY,<br />&nbsp; &nbsp; &nbsp; &nbsp; .code&nbsp; &nbsp; &nbsp; &nbsp; = KEY_RESTART,<br />&nbsp; &nbsp; &nbsp; &nbsp; .debounce_interval = TL_WR703N_KEYS_DEBOUNCE_INTERVAL,<br />&nbsp; &nbsp; &nbsp; &nbsp; .gpio&nbsp; &nbsp; &nbsp; &nbsp; = TL_WR703N_GPIO_BTN_RESET,<br />&nbsp; &nbsp; &nbsp; &nbsp; .active_low&nbsp; &nbsp; = 0,<br />&nbsp; &nbsp; }<br />};</p><p>static void __init tl_wr703n_setup(void)<br />{<br />&nbsp; &nbsp; u8 *mac = (u8 *) KSEG1ADDR(0x1f01fc00);<br />&nbsp; &nbsp; u8 *ee = (u8 *) KSEG1ADDR(0x1fff1000);</p><p>&nbsp; &nbsp; /* disable PHY_SWAP and PHY_ADDR_SWAP bits */<br />//&nbsp; &nbsp; ath79_setup_ar933x_phy4_switch(false, false);<br />&nbsp; &nbsp; ath79_setup_ar933x_phy4_switch(false, true);</p><p>&nbsp; &nbsp; ath79_register_m25p80(&amp;tl_wr703n_flash_data);<br />&nbsp; &nbsp; ath79_register_leds_gpio(-1, ARRAY_SIZE(tl_wr703n_leds_gpio),<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; tl_wr703n_leds_gpio);<br />&nbsp; &nbsp; ath79_register_gpio_keys_polled(-1, TL_WR703N_KEYS_POLL_INTERVAL,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ARRAY_SIZE(tl_wr703n_gpio_keys),<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tl_wr703n_gpio_keys);</p><p>&nbsp; &nbsp; gpio_request_one(TL_WR703N_GPIO_USB_POWER,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; GPIOF_OUT_INIT_HIGH | GPIOF_EXPORT_DIR_FIXED,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &quot;USB power&quot;);<br />&nbsp; &nbsp; ath79_register_usb();</p><p>&nbsp; &nbsp; ath79_init_mac(ath79_eth0_data.mac_addr, mac, 0);</p><p>&nbsp; &nbsp; ath79_register_mdio(0, 0x0);<br />&nbsp; &nbsp; ath79_register_eth(0);<br />&nbsp; &nbsp; ath79_eth0_data.phy_mask = BIT(0);<br />&nbsp; &nbsp; </p><p>&nbsp; &nbsp; ath79_register_wmac(ee, mac);<br />}</p><p>MIPS_MACHINE(ATH79_MACH_TL_WR703N, &quot;TL-WR703N&quot;, &quot;TP-LINK TL-WR703N v1&quot;,<br />&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; tl_wr703n_setup);</p></blockquote></div>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 8 of 13</div><nav><ul><li><a href="viewtopic.php%3Fid=40986&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=40986&amp;p=6.html">6</a></li><li><a href="viewtopic.php%3Fid=40986&amp;p=7.html">7</a></li><li class="pagination-current"><span>8</span></li><li><a href="viewtopic.php%3Fid=40986&amp;p=9.html">9</a></li><li><a href="viewtopic.php%3Fid=40986&amp;p=10.html">10</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=40986&amp;p=13.html">13</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>