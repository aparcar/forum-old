<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> DLNA/UPnP media server not visible from wired lan to wifi: TL-WR1043ND</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 28 Apr 2018 and 2 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=43160&amp;p=2.html">2</a></li></ul></nav></div>
			
		
		
			<article class="post" id="p196346">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">dpg</div>
					<div class="post-datetime">
						27 Mar 2013, 03:11					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I&#039;ve just installed OpenWRT on a TP-Link TL-WR1043ND. I have a DLNA media server running on the wired LAN which is not immediately visible to clients on the wifi network. They see the DLNA server randomly after some time, but not always.</p><p>After lots of searching on here and elsewhere it seems that the issue is that DLNA uses multicast to announce server availability but OpenWRT does not copy multicast packets from the wired LAN to the wireless network.</p><p>Some previous posts have suggested that using igmpproxy is the solution, but all of the examples I have seen are discussing making multicast from the WAN available on the LAN. What I think I need to do is proxy the multicast announcements sent on the wired LAN to the wifi network.</p><p>I&#039;ve tried all combinations I can think of, but can&#039;t find a configuration of igmpproxy that works.</p><p>This is my ifconfig:</p><p>br-lan&nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 64:70:02:40:63:8C&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:192.168.1.1&nbsp; Bcast:192.168.1.255&nbsp; Mask:255.255.255.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:2162917 errors:0 dropped:7057 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:2425509 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0 <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:257030963 (245.1 MiB)&nbsp; TX bytes:1141148035 (1.0 GiB)</p><p>eth0&nbsp; &nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 64:70:02:40:63:8C&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:18113569 errors:0 dropped:154 overruns:60037 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:16417836 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000 <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:1359873919 (1.2 GiB)&nbsp; TX bytes:4242649814 (3.9 GiB)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Interrupt:4 </p><p>eth0.1&nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 64:70:02:40:63:8C&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:1901742 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:1948010 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0 <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:237559123 (226.5 MiB)&nbsp; TX bytes:499581105 (476.4 MiB)</p><p>eth0.2&nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 64:70:02:40:63:8C&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:192.168.0.10&nbsp; Bcast:192.168.0.255&nbsp; Mask:255.255.255.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:9101140 errors:0 dropped:2929 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:7702271 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0 <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:5059208064 (4.7 GiB)&nbsp; TX bytes:1143172262 (1.0 GiB)</p><p>lo&nbsp; &nbsp; &nbsp; &nbsp; Link encap:Local Loopback&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:127.0.0.1&nbsp; Mask:255.0.0.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP LOOPBACK RUNNING&nbsp; MTU:16436&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:2649 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:2649 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0 <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:947834 (925.6 KiB)&nbsp; TX bytes:947834 (925.6 KiB)</p><p>wlan0&nbsp; &nbsp; &nbsp;Link encap:Ethernet&nbsp; HWaddr 64:70:02:40:63:8C&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:295113 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:524147 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:32 <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:34395913 (32.8 MiB)&nbsp; TX bytes:665261569 (634.4 MiB)</p><p>I&#039;m assuming eth0.1 is the wired LAN, eth0.2 is the wired WAN, br-lan is the bridged wired LAN and wifi and wlan0 is the wifi.</p><p>So, it seems to me that I want to proxy igmp from eth0.1 to wlan0. So I have set igmpproxyconfig to:</p><p>quickleave</p><p>phyint eth0.1 upstream ratelimit 0 threshold 1</p><p>phyint wlan0 downstream ratelimit 0 threshold 1&nbsp; &nbsp; </p><p>When I run it with igmpproxy -d ./igmpproxy.conf I get the error:<br />There must be at least 2 Vif&#039;s where one is upstream.</p><p>Which seems as if I have not got the interfaces right.</p><p>Any ideas? Am I on the right tracks with using igmpproxy? If so any ideas on how I should configure it correctly? Or is there something completely different I should be trying to get DLNA servers on the wired LAN visible from the wifi network?</p><p>After trying everything obvious I could see from the forums here or from general google searches it seems that it might be the case that OpenWRT may not support DLNA from wired to wireless LANs... I would love to find out that I am wrong as I like many of the other features of OpenWRT... should I try a differnet firmware?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p196479">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">dpg</div>
					<div class="post-datetime">
						28 Mar 2013, 02:05					</div>
				</div>
				<div class="post-content content">
					<p>I have to admit defeat. I&#039;ve resorted to rewiring my house (we had the builders in today anyway) so that all foreseen DLNA clients are on the wired LAN and now all of my DLNA media servers are discovered instantly by the clients. It is a real pity that OpenWRT does not have an obvious method to get UPnP/DLNA working for wireless clients. I have yet to see a solution to this multicast bridging problem with OpenWRT - while my rather drastic solution has been to build a physical network to get things working other people have resorted to using the original T-Link firmware... I would still like to find a workaround so that visitor laptops in my wifi network can use DLNA, so, please, if anyone has a solution I am all ears.</p><p>I think this is one of the only real problems with OpenWRT, but it is a major one as most people want to be able to connect their TVs, iPads, etc. to their media servers... while this remains an unsolved problem I do not see OpenWRT ever hitting the mainstream.</p>											<p class="post-edited">(Last edited by <strong>dpg</strong> on 28 Mar 2013, 02:07)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p196762">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">ericwongcm</div>
					<div class="post-datetime">
						31 Mar 2013, 14:30					</div>
				</div>
				<div class="post-content content">
					<p>What is your igmpproxy config?</p><p>Sounds to me you didn&#039;t configure igmpproxy accordingly<br /><a href="http://wiki.openwrt.org/doc/howto/udp_multicast">http://wiki.openwrt.org/doc/howto/udp_multicast</a></p><p>FYI, your problem is merely a configuration issue... not that Openwrt doesn&#039;t support this.</p>											<p class="post-edited">(Last edited by <strong>ericwongcm</strong> on 31 Mar 2013, 14:31)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p196991">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">dpg</div>
					<div class="post-datetime">
						2 Apr 2013, 17:06					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>ericwongcm wrote:</cite><blockquote><p>What is your igmpproxy config?</p><p>Sounds to me you didn&#039;t configure igmpproxy accordingly</p></blockquote></div><p>I configured it as I mentioned in the first post:</p><div class="quotebox"><cite>dpg wrote:</cite><blockquote><p>I&#039;m assuming eth0.1 is the wired LAN, eth0.2 is the wired WAN, br-lan is the bridged wired LAN and wifi and wlan0 is the wifi.</p><p>So, it seems to me that I want to proxy igmp from eth0.1 to wlan0. So I have set igmpproxyconfig to:</p><p>quickleave</p><p>phyint eth0.1 upstream ratelimit 0 threshold 1</p><p>phyint wlan0 downstream ratelimit 0 threshold 1&nbsp; &nbsp;</p><p>When I run it with igmpproxy -d ./igmpproxy.conf I get the error:<br />There must be at least 2 Vif&#039;s where one is upstream.</p><p>Which seems as if I have not got the interfaces right.</p></blockquote></div><p>I read the instructions at the link you sent before I tried anything out. The link is explaining how to get incoming multicast from the WAN proxied onto the LAN. I wanted to do something slightly different and get multicast from the wired LAN proxied onto the wireless LAN. So my original question was which interfaces I should use to get this working.</p><p>I tried eth0.1 and wlan0 but this didn&#039;t work as it generated errors about needing at least two Vifs... so if you have any suggestions I would love to hear them.</p><p>Thanks.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p197058">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">ericwongcm</div>
					<div class="post-datetime">
						3 Apr 2013, 08:11					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dpg wrote:</cite><blockquote><p>I&#039;m assuming eth0.1 is the wired LAN, eth0.2 is the wired WAN, br-lan is the bridged wired LAN and wifi and wlan0 is the wifi.</p><p>So, it seems to me that I want to proxy igmp from eth0.1 to wlan0. So I have set igmpproxyconfig to:</p><p>quickleave</p><p>phyint eth0.1 upstream ratelimit 0 threshold 1</p><p>phyint wlan0 downstream ratelimit 0 threshold 1&nbsp; &nbsp;</p><p>When I run it with igmpproxy -d ./igmpproxy.conf I get the error:<br />There must be at least 2 Vif&#039;s where one is upstream.</p><p>Which seems as if I have not got the interfaces right.</p><p>I read the instructions at the link you sent before I tried anything out. The link is explaining how to get incoming multicast from the WAN proxied onto the LAN. I wanted to do something slightly different and get multicast from the wired LAN proxied onto the wireless LAN. So my original question was which interfaces I should use to get this working.</p><p>I tried eth0.1 and wlan0 but this didn&#039;t work as it generated errors about needing at least two Vifs... so if you have any suggestions I would love to hear them.</p><p>Thanks.</p></blockquote></div><p>Don&#039;t make assumptions. Check what is the real name of your router interface via LUCI or command.</p><p>The error &quot;There must be at least 2 Vif&#039;s where one is upstream.&quot; is saying your router doesn&#039;t have any devices connected with those IP address range you specify... which means you need to check your IP address if you have already configured igmp config correctly..</p><p>It appears like your igmp config doesn&#039;t contain the required line to set your subnet IP address<br />altnet 10.254.0.0/16</p><p>My igmp config which seems to work look like this...<br />My lan is using 192.168.15.x for all connected devices.<br />WLAN is connected to the upstream router for internet access.<br />My Openwrt router have DHCP disabled and IP address are all acquired from upstream internet router.</p><div class="quotebox"><blockquote><p>config igmpproxy<br />&nbsp; &nbsp; option quickleave 1</p><p>config phyint<br />&nbsp; &nbsp; option network wwan<br />&nbsp; &nbsp; option direction upstream<br />&nbsp; &nbsp; list altnet 192.168.15.0/24</p><p>config phyint<br />&nbsp; &nbsp; option network wwan<br />&nbsp; &nbsp; option direction downstream<br />&nbsp; &nbsp; list altnet 192.168.15.0/24<br />&nbsp; &nbsp; <br />config phyint<br />&nbsp; &nbsp; option network lan<br />&nbsp; &nbsp; option direction downstream<br />&nbsp; &nbsp; list altnet 192.168.15.0/24</p><p>config phyint<br />&nbsp; &nbsp; option network lan<br />&nbsp; &nbsp; option direction upstream<br />&nbsp; &nbsp; list altnet 192.168.15.0/24</p></blockquote></div>											<p class="post-edited">(Last edited by <strong>ericwongcm</strong> on 3 Apr 2013, 08:12)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p197193">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">BigD</div>
					<div class="post-datetime">
						4 Apr 2013, 12:37					</div>
				</div>
				<div class="post-content content">
					<p>&quot; it might be the case that OpenWRT may not support DLNA from wired to wireless LANs&quot;</p><p>I&#039;ve noticed the same thing but for me when the router is freshly rebooted, dlna from wired to wireless works for a while. Then after a while it stops working and the wireless and wired clients can&#039;t see dlna servers past the divide any longer. </p><p>Until this is fixed you can create a wireless wds client router and connect to that one via wire. This seems to work.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p197491">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">dpg</div>
					<div class="post-datetime">
						6 Apr 2013, 19:55					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>ericwongcm wrote:</cite><blockquote><p>Don&#039;t make assumptions. Check what is the real name of your router interface via LUCI or command.</p></blockquote></div><p>In my original post I pasted the output from ifconfig which showed all of the interfaces:<br />br-lan<br />eth0<br />eth0.1<br />eth0.2<br />lo<br />wlan0</p><div class="quotebox"><cite>ericwongcm wrote:</cite><blockquote><p>The error &quot;There must be at least 2 Vif&#039;s where one is upstream.&quot; is saying your router doesn&#039;t have any devices connected with those IP address range you specify... which means you need to check your IP address if you have already configured igmp config correctly..</p><p>It appears like your igmp config doesn&#039;t contain the required line to set your subnet IP address<br />altnet 10.254.0.0/16</p></blockquote></div><p>I&#039;ve tried with and without altnet lines to specify the IP addresses, I always get the same error &quot;There must be at least 2 Vif&#039;s where one is upstream.&quot;</p><p>The only time I can get igmpproxy to run is if I specify that it should proxy between interfaces eth0.2 and br-lan (and this works whether or not I specify the addresses in the altnet config line, btw).</p><p>However, this is proxying between the WAN and the bridged LAN (wired+wifi) and this is not what I want to do - I want to get multicast from the wired LAN proxied onto the wifi network.</p><p>From looking at your config it looks as if you are proxying between the WAN and LAN, which, is working for me too. So, the question remains - can I use igmpproxy to proxy multicast traffic between the wired and wireless LANS?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p197492">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">dpg</div>
					<div class="post-datetime">
						6 Apr 2013, 20:01					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>BigD wrote:</cite><blockquote><p>&quot; Until this is fixed you can create a wireless wds client router and connect to that one via wire. This seems to work.</p></blockquote></div><p>I&#039;m a bit confused - do you mean set up a second router to act as a client of the wifi network from the first router?</p><p>The trouble with doing this is that the first OpenWRT router is not copying any multicast packets onto the wifi, so the second router or any hosts connected to it through its wired LAN would not receive multicast either.</p><p>I&#039;m sure I&#039;ve misunderstood - can you explain further?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p197542">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">BigD</div>
					<div class="post-datetime">
						7 Apr 2013, 12:27					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dpg wrote:</cite><blockquote><div class="quotebox"><cite>BigD wrote:</cite><blockquote><p>&quot; Until this is fixed you can create a wireless wds client router and connect to that one via wire. This seems to work.</p></blockquote></div><p>I&#039;m a bit confused - do you mean set up a second router to act as a client of the wifi network from the first router?</p><p>The trouble with doing this is that the first OpenWRT router is not copying any multicast packets onto the wifi, so the second router or any hosts connected to it through its wired LAN would not receive multicast either.</p><p>I&#039;m sure I&#039;ve misunderstood - can you explain further?</p></blockquote></div><p>For me, in this case multicast would work even over wifi. I think this has to do with WDS working in a different way than an ordinary STA connection (the wiki mentions something about &quot;using a 4-address-format to allow transparent ethernet bridging on the station&quot;). I&#039;m talking about having a wired connection to the client router though, if this would work even if you connected to the client router over wireless I do not know.&nbsp; </p><p>I&#039;m using a media player connected to a wr703 router which is connected to the main network though wds and I can browse dlna servers just fine.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p197556">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">ericwongcm</div>
					<div class="post-datetime">
						7 Apr 2013, 14:50					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dpg wrote:</cite><blockquote><p>From looking at your config it looks as if you are proxying between the WAN and LAN, which, is working for me too. So, the question remains - can I use igmpproxy to proxy multicast traffic between the wired and wireless LANS?</p></blockquote></div><p>Yes, I am proxying between WAN and LAN because my WIFI is configured as the WWAN and it is configured as WAN.</p><p>My configuration is correct for what I am doing.<br />Check how you have configured your router.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p197941">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">dpg</div>
					<div class="post-datetime">
						10 Apr 2013, 20:10					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>BigD wrote:</cite><blockquote><p>For me, in this case multicast would work even over wifi. I think this has to do with WDS working in a different way than an ordinary STA connection (the wiki mentions something about &quot;using a 4-address-format to allow transparent ethernet bridging on the station&quot;). I&#039;m talking about having a wired connection to the client router though, if this would work even if you connected to the client router over wireless I do not know.&nbsp; </p><p>I&#039;m using a media player connected to a wr703 router which is connected to the main network though wds and I can browse dlna servers just fine.</p></blockquote></div><p>This is an interesting workaround, but, unfortunately, it does mean deploying two routers.</p><p>Just to check whether I have got it right:</p><p> [H1]----wired----[R1]----wired WDS----[R2]----wireless----[H2]<br />DLNA&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WR1043&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WR1043&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DLNA<br />media&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;router&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; router&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;media<br />server&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; OpenWRT&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; OpenWRT&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; client</p><p>Is it the case that the second router (R2) copies the multicast arriving from R1 over the wired WDS connection onto the wifi because it is a WDS link so it treats it differently to a normal wired link?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p197942">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">dpg</div>
					<div class="post-datetime">
						10 Apr 2013, 20:18					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>ericwongcm wrote:</cite><blockquote><p>My configuration is correct for what I am doing.<br />Check how you have configured your router.</p></blockquote></div><p>This was what I was hoping to get some help with. The configuration is pretty much out-of-the-box, I have the interfaces I showed in the original post with the output from ifconfig and I can only get igmpproxy to work between eth0.2 (the WAN) and br-lan (the bridged wired/wifi LANs). If you can help me find out which aspects of the router configuration I should check to help configure igmpproxy to work between wired and wifi LANs I would be very grateful.</p>											<p class="post-edited">(Last edited by <strong>dpg</strong> on 10 Apr 2013, 20:19)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p197946">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">dpg</div>
					<div class="post-datetime">
						10 Apr 2013, 20:52					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>ericwongcm wrote:</cite><blockquote><p>Sounds to me you didn&#039;t configure igmpproxy accordingly</p><p>FYI, your problem is merely a configuration issue... not that Openwrt doesn&#039;t support this.</p></blockquote></div><p>I&#039;ve just discovered an open bug report for this issue at: <a href="https://dev.openwrt.org/ticket/13042">https://dev.openwrt.org/ticket/13042</a> so perhaps it may be more than just a configuration issue after all.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p198830">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">BigD</div>
					<div class="post-datetime">
						18 Apr 2013, 20:47					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dpg wrote:</cite><blockquote><p>Just to check whether I have got it right:</p><p> [H1]----wired----[R1]----wired WDS----[R2]----wireless----[H2]<br />DLNA&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WR1043&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WR1043&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DLNA<br />media&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;router&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; router&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;media<br />server&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; OpenWRT&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; OpenWRT&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; client</p><p>Is it the case that the second router (R2) copies the multicast arriving from R1 over the wired WDS connection onto the wifi because it is a WDS link so it treats it differently to a normal wired link?</p></blockquote></div><p>Well in my case, it&#039;s a wireless wds connection (I&#039;m not even sure there is such a thing as a wired wds connection), but the last link is wired.</p><p>In any case, it&#039;s a bug, and the wds solution is only a workaround. Hopefully it will get some attention and get fixed properly.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p198895">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">Gatak</div>
					<div class="post-datetime">
						19 Apr 2013, 11:52					</div>
				</div>
				<div class="post-content content">
					<p><strong><span class="bbu">SOLUTION!</span></strong></p><br /><p>The problem with multicast is multicast snooping. Disable it and the bridge will forward all multicast packets (DLNA/UPnP).</p><p><strong>echo &quot;0&quot;&gt;/sys/devices/virtual/net/br-lan/bridge/multicast_snooping</strong></p><p>Substitude <strong>br-lan</strong> with your actual bridge interface, for example <strong>br0</strong>.<br />You must of course disable multicast_snooping on all wlan-wired bridges in your network.</p>											<p class="post-edited">(Last edited by <strong>Gatak</strong> on 19 Apr 2013, 11:53)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p198926">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">BigD</div>
					<div class="post-datetime">
						19 Apr 2013, 16:46					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Gatak wrote:</cite><blockquote><p><strong><span class="bbu">SOLUTION!</span></strong></p><br /><p>The problem with multicast is multicast snooping. Disable it and the bridge will forward all multicast packets (DLNA/UPnP).</p><p><strong>echo &quot;0&quot;&gt;/sys/devices/virtual/net/br-lan/bridge/multicast_snooping</strong></p><p>Substitude <strong>br-lan</strong> with your actual bridge interface, for example <strong>br0</strong>.<br />You must of course disable multicast_snooping on all wlan-wired bridges in your network.</p></blockquote></div><p>Amazing! </p><p>First impression is that it does indeed seems to work.&nbsp; Time will tell if it will this is a temporary thing or not. Even before, at times, dlna access worked for on random occasions. But this seems very promising. Thanks so much Gatak!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p198934">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">Gatak</div>
					<div class="post-datetime">
						19 Apr 2013, 17:37					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>BigD wrote:</cite><blockquote><div class="quotebox"><cite>Gatak wrote:</cite><blockquote><p><strong><span class="bbu">SOLUTION!</span></strong></p><br /><p>The problem with multicast is multicast snooping. Disable it and the bridge will forward all multicast packets (DLNA/UPnP).</p><p><strong>echo &quot;0&quot;&gt;/sys/devices/virtual/net/br-lan/bridge/multicast_snooping</strong></p><p>Substitude <strong>br-lan</strong> with your actual bridge interface, for example <strong>br0</strong>.<br />You must of course disable multicast_snooping on all wlan-wired bridges in your network.</p></blockquote></div><p>Amazing! </p><p>First impression is that it does indeed seems to work.&nbsp; Time will tell if it will this is a temporary thing or not. Even before, at times, dlna access worked for on random occasions. But this seems very promising. Thanks so much Gatak!</p></blockquote></div><p>Geat that it worked! I got the tip from #netfilter on FreeNode <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>I am running the following setup on a WR1043ND with VLAN disabled (option enable_vlan &#039;0&#039;):</p><p><strong>[client A]</strong> &lt;-wired-&gt; <strong>[eth0-bridge-wlan0]</strong> &lt;-wifi-&gt; <strong>[wlan0-bridge-eth0]</strong> &lt;-wired-&gt; <strong>[client B]</strong></p><p>The guide on the Wiki is now updated too: <a href="http://wiki.openwrt.org/doc/howto/udp_multicast">http://wiki.openwrt.org/doc/howto/udp_multicast</a></p>											<p class="post-edited">(Last edited by <strong>Gatak</strong> on 19 Apr 2013, 17:39)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p198957">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">BigD</div>
					<div class="post-datetime">
						19 Apr 2013, 21:20					</div>
				</div>
				<div class="post-content content">
					<p>Correct me if I&#039;m wrong Gatak, but this is not a setting that will survive reboot so the command has to be entered into /etc/rc.local so that it is run on start up.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p198959">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">FriedZombie</div>
					<div class="post-datetime">
						19 Apr 2013, 21:26					</div>
				</div>
				<div class="post-content content">
					<p>No it doesn&#039;t survive a reboot, so you are correct that it should be added to /etc/rc.local</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p198981">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">Gatak</div>
					<div class="post-datetime">
						20 Apr 2013, 07:43					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>BigD wrote:</cite><blockquote><p>Correct me if I&#039;m wrong Gatak, but this is not a setting that will survive reboot so the command has to be entered into /etc/rc.local so that it is run on start up.</p></blockquote></div><p>No, you are right that you would have to put it in rc.local or type it manually each reboot. Maybe I should have added this in the wiki too <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p199251">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">dpg</div>
					<div class="post-datetime">
						22 Apr 2013, 22:29					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Gatak wrote:</cite><blockquote><p><strong><span class="bbu">SOLUTION!</span></strong></p><br /><p>The problem with multicast is multicast snooping. Disable it and the bridge will forward all multicast packets (DLNA/UPnP).</p><p><strong>echo &quot;0&quot;&gt;/sys/devices/virtual/net/br-lan/bridge/multicast_snooping</strong></p></blockquote></div><p>Brilliant Gatak. Works perfectly. Just what I was looking for.</p><p>Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p199268">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">ericwongcm</div>
					<div class="post-datetime">
						23 Apr 2013, 03:44					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Gatak wrote:</cite><blockquote><p><strong><span class="bbu">SOLUTION!</span></strong></p><br /><p>The problem with multicast is multicast snooping. Disable it and the bridge will forward all multicast packets (DLNA/UPnP).</p><p><strong>echo &quot;0&quot;&gt;/sys/devices/virtual/net/br-lan/bridge/multicast_snooping</strong></p><p>Substitude <strong>br-lan</strong> with your actual bridge interface, for example <strong>br0</strong>.<br />You must of course disable multicast_snooping on all wlan-wired bridges in your network.</p></blockquote></div><p>How do I do this if I don&#039;t have /sys/devices/virtual/net/br-lan/bridge/multicast_snooping<br />in my router?</p><p>root@Vodafone-HG556A:/sys/devices/virtual/net/br-lan/bridge# ls<br />ageing_time&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;hello_time&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; stp_state<br />bridge_id&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;hello_timer&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;tcn_timer<br />flush&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;max_age&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;topology_change<br />forward_delay&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;priority&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; topology_change_detected<br />gc_timer&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; root_id&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;topology_change_timer<br />group_addr&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; root_path_cost<br />group_fwd_mask&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; root_port</p><p>I am interested to use method rather than IGMP proxy... (if it means I can install and run one app less.)</p>											<p class="post-edited">(Last edited by <strong>ericwongcm</strong> on 23 Apr 2013, 03:59)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p199354">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">Gatak</div>
					<div class="post-datetime">
						23 Apr 2013, 15:54					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>ericwongcm wrote:</cite><blockquote><div class="quotebox"><cite>Gatak wrote:</cite><blockquote><p><strong><span class="bbu">SOLUTION!</span></strong></p><br /><p>The problem with multicast is multicast snooping. Disable it and the bridge will forward all multicast packets (DLNA/UPnP).</p><p><strong>echo &quot;0&quot;&gt;/sys/devices/virtual/net/br-lan/bridge/multicast_snooping</strong></p><p>Substitude <strong>br-lan</strong> with your actual bridge interface, for example <strong>br0</strong>.<br />You must of course disable multicast_snooping on all wlan-wired bridges in your network.</p></blockquote></div><p>How do I do this if I don&#039;t have /sys/devices/virtual/net/br-lan/bridge/multicast_snooping<br />in my router?</p><p>root@Vodafone-HG556A:/sys/devices/virtual/net/br-lan/bridge# ls<br />ageing_time&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;hello_time&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; stp_state<br />bridge_id&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;hello_timer&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;tcn_timer<br />flush&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;max_age&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;topology_change<br />forward_delay&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;priority&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; topology_change_detected<br />gc_timer&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; root_id&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;topology_change_timer<br />group_addr&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; root_path_cost<br />group_fwd_mask&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; root_port</p><p>I am interested to use method rather than IGMP proxy... (if it means I can install and run one app less.)</p></blockquote></div><p>What version of OpenWRT do you use? I am using Trunk version (daily build) <a href="http://downloads.openwrt.org/snapshots/trunk/ar71xx/">http://downloads.openwrt.org/snapshots/trunk/ar71xx/</a></p><p>It could be that you do not have a recent enough kernel that supports this.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p199440">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">ericwongcm</div>
					<div class="post-datetime">
						24 Apr 2013, 04:09					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Gatak wrote:</cite><blockquote><p>What version of OpenWRT do you use? I am using Trunk version (daily build) <a href="http://downloads.openwrt.org/snapshots/trunk/ar71xx/">http://downloads.openwrt.org/snapshots/trunk/ar71xx/</a></p><p>It could be that you do not have a recent enough kernel that supports this.</p></blockquote></div><p>The message logs above comes from HG556A router running BARRIER BREAKER (Bleeding Edge, r35770)</p><p>I use another rt3052 router running Attitude Adjustment which doesn&#039;t have this multicast_snooping either..</p><p>Any idea from which revision onwards this features is implemented?<br />(adding this information to wiki will be useful...)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p199480">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">Gatak</div>
					<div class="post-datetime">
						24 Apr 2013, 13:06					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>ericwongcm wrote:</cite><blockquote><div class="quotebox"><cite>Gatak wrote:</cite><blockquote><p>What version of OpenWRT do you use? I am using Trunk version (daily build) <a href="http://downloads.openwrt.org/snapshots/trunk/ar71xx/">http://downloads.openwrt.org/snapshots/trunk/ar71xx/</a></p><p>It could be that you do not have a recent enough kernel that supports this.</p></blockquote></div><p>The message logs above comes from HG556A router running BARRIER BREAKER (Bleeding Edge, r35770)</p><p>I use another rt3052 router running Attitude Adjustment which doesn&#039;t have this multicast_snooping either..</p><p>Any idea from which revision onwards this features is implemented?<br />(adding this information to wiki will be useful...)</p></blockquote></div><p>The wiki says &quot;Luckily, starting from 2.6.34, the kernel has IGMP snooping feature for the software bridges (disabled by default in OpenWrt) which should prevent unnecessary traffic on ports that were not actually subscribing&quot; So it depends on the kernel you have. I would assume this feature is available in kernel 2.6.34 and newer. </p><p>You can check your kernel version from the shell: </p><div class="quotebox"><blockquote><p>root@WiFi-AP:~# cat /proc/version<br />Linux version 3.8.7 (openwrt@OpenWRTBuild) (gcc version 4.6.4 (OpenWrt/Linaro GCC 4.6-2012.12 r36349) ) #1 Wed Apr 17 16:22:31 MST 2013</p></blockquote></div><p>Had a quick look. OpenWRT 10.03.1 has kernel 2.6.30, so it would be in later release than last official &quot;stable&quot;. Latest official beta (Attitude Adjustment 12.09) should be ok since is has a 3.x kernel. Trunk (nightly builds) are obviously ok too.</p>											<p class="post-edited">(Last edited by <strong>Gatak</strong> on 24 Apr 2013, 13:12)</p>
									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=43160&amp;p=2.html">2</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>