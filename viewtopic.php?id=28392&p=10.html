<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Build for WNDR3700/WNDR3800</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 9 Jul 2013 and 6 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 10 of 63</div><nav><ul><li><a href="viewtopic.php%3Fid=28392&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=28392&amp;p=8.html">8</a></li><li><a href="viewtopic.php%3Fid=28392&amp;p=9.html">9</a></li><li class="pagination-current"><span>10</span></li><li><a href="viewtopic.php%3Fid=28392&amp;p=11.html">11</a></li><li><a href="viewtopic.php%3Fid=28392&amp;p=12.html">12</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=28392&amp;p=63.html">63</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p170317">
				<div class="post-metadata">
					<div class="post-num">Post #226</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						18 Jun 2012, 23:27					</div>
				</div>
				<div class="post-content content">
					<p>The pptp client setup registers a host route dependency with netifd, as soon as a default route (or a smaller subnet route covering the vpn server ip) becomes available, the pptp iface is brought up.<br/>Problem is that the resolving of the symbolic vpn server hostname to ips happens directly on setup and is not deferred, therefore the mechanism might fail due to no available dns but would otherwise work as intended when using the server ip directly.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p170345">
				<div class="post-metadata">
					<div class="post-num">Post #227</div>
					<div class="post-author">Dickie</div>
					<div class="post-datetime">
						19 Jun 2012, 05:48					</div>
				</div>
				<div class="post-content content">
					<p>OK - makes sense.&nbsp; </p><p>I tried it with an IP Address, and get the same problem.&nbsp; Looking at the systemlog from the boot, it looks like its not loading the PPTP until after the interface is up, but it never actually creates the connection.</p><br/><p>Jun 18 19:33:06 RouterTest daemon.notice netifd: Interface &#039;lan&#039; is now up<br/>Jun 18 19:33:06 RouterTest daemon.notice netifd: Interface &#039;loopback&#039; is now up<br/>Jun 18 19:33:06 RouterTest kern.info kernel: [&nbsp; &nbsp;37.880000] ADDRCONF(NETDEV_UP): eth1: link is not ready<br/>Jun 18 19:33:07 RouterTest daemon.notice netifd: wan (775): udhcpc (v1.19.4) started<br/><strong>Jun 18 19:33:07 RouterTest daemon.notice netifd: Interface &#039;MYVPN&#039; is now down</strong><br/>Jun 18 19:33:07 RouterTest daemon.notice netifd: wan (775): Sending discover...<br/>Jun 18 19:33:07 RouterTest user.info sysinit: &#039;radio0&#039; is disabled<br/>Jun 18 19:33:07 RouterTest user.info sysinit: &#039;radio1&#039; is disabled<br/>Jun 18 19:33:08 RouterTest user.notice ifup: Enabling Router Solicitations on lan (br-lan)<br/>Jun 18 19:33:08 RouterTest user.info sysinit: &#039;radio0&#039; is disabled<br/>Jun 18 19:33:08 RouterTest user.info sysinit: &#039;radio1&#039; is disabled<br/>Jun 18 19:33:08 RouterTest kern.info kernel: [&nbsp; &nbsp;39.850000] br-lan: port 1(eth0.1) entered forwarding state<br/>Jun 18 19:33:10 RouterTest daemon.notice netifd: wan (775): Sending discover...<br/>Jun 18 19:33:10 RouterTest user.notice upnp daemon: external interface not found, not starting<br/>Jun 18 19:33:10 RouterTest user.info sysinit: Loading defaults<br/>Jun 18 19:33:10 RouterTest kern.debug kernel: [&nbsp; &nbsp;41.850000] ar71xx: pll_reg 0xb8050014: 0x11110000<br/>Jun 18 19:33:10 RouterTest kern.info kernel: [&nbsp; &nbsp;41.850000] eth1: link up (1000Mbps/Full duplex)<br/>Jun 18 19:33:10 RouterTest kern.info kernel: [&nbsp; &nbsp;41.880000] ADDRCONF(NETDEV_CHANGE): eth1: link becomes ready<br/>Jun 18 19:33:11 RouterTest user.info sysinit: Loading synflood protection<br/>Jun 18 19:33:11 RouterTest user.info sysinit: Adding custom chains<br/>Jun 18 19:33:12 RouterTest user.notice ifup: Enabling Router Solicitations on loopback (lo)<br/>Jun 18 19:33:12 RouterTest user.info sysinit: Loading zones<br/>Jun 18 19:33:13 RouterTest daemon.notice netifd: wan (775): Sending discover...<br/>Jun 18 19:33:13 RouterTest daemon.notice netifd: wan (775): Sending select for Z.Z.Z.Z (removed)...<br/>Jun 18 19:33:13 RouterTest daemon.notice netifd: wan (775): Lease of Z.Z.Z.Z (removed) obtained, lease time 176571<br/>Jun 18 19:33:13 RouterTest daemon.notice netifd: Interface &#039;wan&#039; is now up<br/><strong>Jun 18 19:33:14 RouterTest daemon.info pppd[1455]: Plugin pptp.so loaded.<br/>Jun 18 19:33:14 RouterTest daemon.info pppd[1455]: PPTP plugin version 1.00<br/>Jun 18 19:33:14 RouterTest daemon.notice pppd[1455]: pppd 2.4.5 started by root, uid 0</strong><br/>Jun 18 19:33:14 RouterTest user.notice ifup: Allowing Router Advertisements on wan (eth1)<br/>Jun 18 19:33:14 RouterTest user.info sysinit: Loading forwardings<br/>Jun 18 19:33:14 RouterTest user.info sysinit: Loading rules<br/>Jun 18 19:33:15 RouterTest user.info sysinit: Loading redirects<br/>Jun 18 19:33:15 RouterTest user.info sysinit: Loading includes<br/>Jun 18 19:33:15 RouterTest user.info sysinit: Loading interfaces<br/>Jun 18 19:33:15 RouterTest user.info firewall: adding lan (br-lan) to zone lan<br/><strong>Jun 18 19:33:15 RouterTest daemon.info pppd[1455]: Using interface pptp-MYVPN<br/>Jun 18 19:33:15 RouterTest daemon.notice pppd[1455]: Connect: pptp-MYVPN &lt;--&gt; pptp (y.y.y.y) (removed)</strong><br/>Jun 18 19:33:16 RouterTest user.info syslog: SNet version started</p><p>And then there are no more pppd/pptp messages.&nbsp; If I immediately go to manually connect it through LUCI, then it comes straight up (end addresses removed).</p><p>Jun 18 19:39:00 RouterTest daemon.info pppd[1455]: Terminating on signal 15<br/>Jun 18 19:39:00 RouterTest daemon.notice pppd[1455]: Connection terminated.<br/>Jun 18 19:39:00 RouterTest daemon.info pppd[1455]: Exit.<br/>Jun 18 19:39:00 RouterTest daemon.notice netifd: Interface &#039;MYVPN&#039; is now down<br/>Jun 18 19:39:00 RouterTest daemon.info dnsmasq[2083]: reading /tmp/resolv.conf.auto<br/>Jun 18 19:39:00 RouterTest daemon.info dnsmasq[2083]: using nameserver 75.75.75.75#53<br/>Jun 18 19:39:00 RouterTest daemon.info dnsmasq[2083]: using nameserver 75.75.76.76#53<br/>Jun 18 19:39:00 RouterTest daemon.info dnsmasq[2083]: using local addresses only for domain lan<br/>Jun 18 19:39:00 RouterTest daemon.info pppd[2645]: Plugin pptp.so loaded.<br/>Jun 18 19:39:00 RouterTest daemon.info pppd[2645]: PPTP plugin version 1.00<br/>Jun 18 19:39:00 RouterTest daemon.notice pppd[2645]: pppd 2.4.5 started by root, uid 0<br/>Jun 18 19:39:01 RouterTest daemon.info pppd[2645]: Using interface pptp-MYVPN<br/>Jun 18 19:39:01 RouterTest daemon.notice pppd[2645]: Connect: pptp-MYVPN &lt;--&gt; pptp (y.y.y.y)<br/>Jun 18 19:39:02 RouterTest daemon.notice pppd[2645]: CHAP authentication succeeded<br/>Jun 18 19:39:02 RouterTest daemon.notice pppd[2645]: MPPE 128-bit stateless compression enabled<br/>Jun 18 19:39:02 RouterTest daemon.notice pppd[2645]: local&nbsp; IP address x.x.x.156<br/>Jun 18 19:39:02 RouterTest daemon.notice pppd[2645]: remote IP address x.x.x.1<br/>Jun 18 19:39:03 RouterTest daemon.notice netifd: Interface &#039;MYVPN&#039; is now up<br/>Jun 18 19:39:03 RouterTest user.notice ifup: Enabling Router Solicitations on MYVPN (pptp-MYVPN)<br/>Jun 18 19:39:03 RouterTest user.info firewall: adding MYVPN (pptp-MYVPN) to zone wan</p>											<p class="post-edited">(Last edited by <strong>Dickie</strong> on 19 Jun 2012, 05:49)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p170372">
				<div class="post-metadata">
					<div class="post-num">Post #228</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						19 Jun 2012, 11:57					</div>
				</div>
				<div class="post-content content">
					<p>This does not appear to be a race condition, the order on my test installation is the same.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p170427">
				<div class="post-metadata">
					<div class="post-num">Post #229</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						19 Jun 2012, 19:22					</div>
				</div>
				<div class="post-content content">
					<p>I have included the newly enabled support for 6rd connections to my r32462 trunk build. There is not yet any LuCI support, so only manual config is available. But it might still work. If anybody has 6rd connectivity, please test it and report bugs, so that Jow gets feedback. See <a href="https://dev.openwrt.org/changeset/32431">https://dev.openwrt.org/changeset/32431</a> for more info. </p><p>Unless there are any critical errors found in the next 24 hours, this is probably the last build before late July.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p170445">
				<div class="post-metadata">
					<div class="post-num">Post #230</div>
					<div class="post-author">Dickie</div>
					<div class="post-datetime">
						19 Jun 2012, 22:47					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jow wrote:</cite><blockquote><p>This does not appear to be a race condition, the order on my test installation is the same.</p></blockquote></div><p>Did some more testing today, and seems to be consistent rather than a timing / occasional failure.<br/>Is there any underlying dependency with dnsmasq?&nbsp; <br/>The only reason I ask is if you look at the boot log the pptp extension is loaded, the connection start, and then nothing happens - its followed shortly afterwards by dnsmasq starting up.<br/>When you look at the manual connect version the first thing that happens after the connection initiates is dnsmasq reports using /tmp/resolv.conf.auto&nbsp; (this is with both IP and hostname targets).</p><p>The only other thing I may change is that I have the PPTP and the WAN interface in the same firewall zone (which isn&#039;t enabled until Eth1 comes up), but dont think this looks like a filtering issue.</p>											<p class="post-edited">(Last edited by <strong>Dickie</strong> on 19 Jun 2012, 22:48)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p170447">
				<div class="post-metadata">
					<div class="post-num">Post #231</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						19 Jun 2012, 23:09					</div>
				</div>
				<div class="post-content content">
					<p>The only thing I could imagine is that GRE frames are blocked somehow. Maybe enable the firewall logging options and see how much stuff is rejected until the wan rules are brought up?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p170459">
				<div class="post-metadata">
					<div class="post-num">Post #232</div>
					<div class="post-author">Dickie</div>
					<div class="post-datetime">
						20 Jun 2012, 03:39					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jow wrote:</cite><blockquote><p>The only thing I could imagine is that GRE frames are blocked somehow. Maybe enable the firewall logging options and see how much stuff is rejected until the wan rules are brought up?</p></blockquote></div><p>So I moved the interface into the &#039;unspecified&#039; firewall zone and now its working perfectly after a reboot.&nbsp; <br/>I&#039;ll play around when I get more time to see if putting it in its own zone (rather than it being bound to the Eth1) works just as well, but for now we&#039;re all up and running perfectly.&nbsp; Thanks again for taking the time to lend some brain power to this.</p><p>Update: Ok , after further testing its clearly the zone config.&nbsp; I put the PPTP interface in its own zone, and it comes up correctly during boot and after the ETH1 interface is up.&nbsp; :-)</p>											<p class="post-edited">(Last edited by <strong>Dickie</strong> on 20 Jun 2012, 04:05)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p171989">
				<div class="post-metadata">
					<div class="post-num">Post #233</div>
					<div class="post-author">bibabart</div>
					<div class="post-datetime">
						10 Jul 2012, 16:33					</div>
				</div>
				<div class="post-content content">
					<p>When can we expect a new build of the Attitude Adjustment trunk version? I need to install some extra&#039;s like ebtables, kmod-ebtables and kmod-macvlan, but they won&#039;t install due tue kernel version conflicts.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p172002">
				<div class="post-metadata">
					<div class="post-num">Post #234</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						10 Jul 2012, 19:42					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>bibabart wrote:</cite><blockquote><p>When can we expect a new build of the Attitude Adjustment trunk version? I need to install some extra&#039;s like ebtables, kmod-ebtables and kmod-macvlan, but they won&#039;t install due tue kernel version conflicts.</p></blockquote></div><p>Like I wrote on June 19th: <a href="https://forum.openwrt.org/viewtopic.php?pid=170427#p170427">https://forum.openwrt.org/viewtopic.php?pid=170427#p170427</a><br/></p><div class="quotebox"><cite>hnyman wrote:</cite><blockquote><p>... this is probably the last build before late July.</p></blockquote></div><p>I will be able to build the next version around July 20th.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p172166">
				<div class="post-metadata">
					<div class="post-num">Post #235</div>
					<div class="post-author">Dickie</div>
					<div class="post-datetime">
						13 Jul 2012, 03:22					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>hnyman wrote:</cite><blockquote><p>... this is probably the last build before late July.<br/>I will be able to build the next version around July 20th.</p></blockquote></div><p>I am successfully building against the latest trunk using hnyman&#039;s original config - so if you need it, and can give me somewhere to upload it...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p172552">
				<div class="post-metadata">
					<div class="post-num">Post #236</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						17 Jul 2012, 21:00					</div>
				</div>
				<div class="post-content content">
					<p>Trunk build has been udpated to r32765.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p175155">
				<div class="post-metadata">
					<div class="post-num">Post #237</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						17 Aug 2012, 18:41					</div>
				</div>
				<div class="post-content content">
					<p>I will probably stop doing Backfire builds soon, as there have been almost no changes lately and as the trunk &quot;Attitude Adjustment&quot; nears release. It is possible that Backfire is retired when AA is released, but devs have not yet made any formal decisions about that. <a href="https://lists.openwrt.org/pipermail/openwrt-devel/2012-August/016427.html">https://lists.openwrt.org/pipermail/openwrt-devel/2012-August/016427.html</a></p><p>After the release AA will most likely be the new stable branch, and I will probably build both AA and the new trunk from that point onward. Not quite sure yet. Depends a bit from the exact SVN branching after the forthcoming AA release.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p175157">
				<div class="post-metadata">
					<div class="post-num">Post #238</div>
					<div class="post-author">johnthomas00</div>
					<div class="post-datetime">
						17 Aug 2012, 18:44					</div>
				</div>
				<div class="post-content content">
					<p>Hnyman, thank you for these builds.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p175200">
				<div class="post-metadata">
					<div class="post-num">Post #239</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						18 Aug 2012, 01:08					</div>
				</div>
				<div class="post-content content">
					<p>After noticing that Jow today enabled support for showing dhcpv6 leases in Luci, I made a new private test build where I replaced radvd module with dnsmasq&#039;s built-in ipv6 RA functionality, which was added in the recent 2.62 version as &#039;dnsmasq-dhcpv6&#039; variant.</p><p>There is no uci config support for that, yet, so I made a rather crude hack to /etc/init.d/dnsmasq to insert the correct line to dnsmasq config. The following line makes dnsmasq to perform router advertisements for stateless autoconfig for LAN with the given prefix:</p><div class="codebox"><pre><code>+++ /etc/init.d/dnsmasq
@@ -501,6 +502,8 @@
        echo &gt;&gt; $CONFIGFILE
        config_foreach dhcp_cname_add cname
        echo &gt;&gt; $CONFIGFILE
+
+       echo &quot;dhcp-range=2001:1111:2222:abcd::, ra-names&quot; &gt;&gt; $CONFIGFILE

        # add own hostname
        [ $ADD_LOCAL_HOSTNAME -eq 1 ] &amp;&amp; [ -n &quot;$lanaddr&quot; ] &amp;&amp; {</code></pre></div><p>Dnsmasq accepted that happily. I turned radvd off and IPv6 still worked, as PC autoconfigured itself using dnsmasq&#039;s RA functionality. (But apparently the autoconfigured ipv6 addresses are not shown in Luci&#039;s DHCPv6 list, as they are no formal leases, so no change there.)</p><p>There was related discussion in openwrt-devel in July and even a rather elegant uci based config example in patch attachment: <a href="https://lists.openwrt.org/pipermail/openwrt-devel/2012-July/015906.html">https://lists.openwrt.org/pipermail/openwrt-devel/2012-July/015906.html</a></p><p>dnsmasq config line examples: <a href="http://www.thekelleys.org.uk/dnsmasq/docs/dnsmasq.conf.example">http://www.thekelleys.org.uk/dnsmasq/docs/dnsmasq.conf.example</a></p><p>Currently radvd is still the easier and better supported way for providing ipv6 router advertisements and stateless autoconfiguration, but as Openwrt aims for small footprint, it is quite possible that sooner or later the built-in support in dnsmasq is enabled by default and radvd is pushed to sidelines. </p><p>Radvd nicely determines the correct ipv6 prefix from LAN interface&#039;s address, but dnsmasq seems to require a prefix or address (without prefix length) in the config statement. So, providing that in the config script requires minor coding.</p><p>-------------<br/>EDIT:<br/>I made a more elegant uci based version. The following code reads an optional &#039;raprefix&#039; option from /etc/config/dhcp. For each interface with that option, dnsmasq wiil be configured to act as stateless ra provider for that interface using that prefix. It would be even more elegant to sniff the correct prefix from LAN ipv6 address, but I didn&#039;t implement that, yet.<br/></p><div class="codebox"><pre><code>root@OpenWrt:/etc/init.d# diff /rom/etc/init.d/dnsmasq dnsmasq
--- /rom/etc/init.d/dnsmasq
+++ dnsmasq
@@ -367,6 +367,11 @@
        xappend &quot;--dhcp-range=$networkid,$START,$END,$NETMASK,$leasetime${options:+ $options}&quot;

        dhcp_option_add &quot;$cfg&quot; &quot;$networkid&quot;
+
+       config_get raprefix &quot;$cfg&quot; raprefix
+       [ -n &quot;$raprefix&quot; ] &amp;&amp; {
+               xappend &quot;--dhcp-range=$networkid,$raprefix,ra-names&quot;
+       }
 }

 dhcp_option_add() {</code></pre></div><p>Extract from /etc/config/dhcp:<br/></p><div class="codebox"><pre><code>config &#039;dhcp&#039; &#039;lan&#039;
        option &#039;interface&#039; &#039;lan&#039;
        option &#039;start&#039; &#039;100&#039;
        option &#039;limit&#039; &#039;150&#039;
        option &#039;leasetime&#039; &#039;12h&#039;
        option &#039;force&#039; &#039;1&#039;
        option &#039;raprefix&#039; &#039;2001:1111:2222:abcd::&#039;</code></pre></div><p>System log:<br/></p><div class="codebox"><pre><code>Aug 18 13:57:10 OpenWrt daemon.info dnsmasq[5391]: started, version 2.62 cachesize 150
Aug 18 13:57:10 OpenWrt daemon.info dnsmasq[5391]: compile time options: IPv6 GNU-getopt no-DBus no-i18n no-IDN DHCP DHCPv6 no-Lua TFTP no-conntrack
Aug 18 13:57:10 OpenWrt daemon.info dnsmasq-dhcp[5391]: DHCP, IP range 192.168.1.100 -- 192.168.1.249, lease time 12h
Aug 18 13:57:10 OpenWrt daemon.info dnsmasq-dhcp[5391]: DHCPv4-derived IPv6 names on 2001:1111:2222:abcd::
Aug 18 13:57:10 OpenWrt daemon.info dnsmasq-dhcp[5391]: SLAAC on 2001:1111:2222:abcd:: prefix valid 2h</code></pre></div><p>Ps. The dhcpv6 support in dnsmasq seems to increase its uncompressed size by 30 kB, which is much less than radvd.</p>											<p class="post-edited">(Last edited by <strong>hnyman</strong> on 18 Aug 2012, 15:16)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p175555">
				<div class="post-metadata">
					<div class="post-num">Post #240</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						23 Aug 2012, 00:24					</div>
				</div>
				<div class="post-content content">
					<p>There seems to a be a bug in USB hotplug unmounting, which prevents some USB drives being logically unmounted when they are removed. That will lead into mount problems when a disk is attached the next time. I have added a short-term fix to my build while waiting the devs figure out a more permanent solution. See <a href="https://dev.openwrt.org/ticket/12056">https://dev.openwrt.org/ticket/12056</a> (and <a href="https://dev.openwrt.org/ticket/12043)">https://dev.openwrt.org/ticket/12043)</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176152">
				<div class="post-metadata">
					<div class="post-num">Post #241</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						28 Aug 2012, 22:42					</div>
				</div>
				<div class="post-content content">
					<p>I remembered an old about processor-specific gcc compiler optimizations in Arokh&#039;s thread and decided to experiment a bit. References to the earlier discussions:<br/><a href="https://forum.openwrt.org/viewtopic.php?pid=161348#p161348">https://forum.openwrt.org/viewtopic.php?pid=161348#p161348</a><br/><a href="https://forum.openwrt.org/viewtopic.php?pid=160079#p160079">https://forum.openwrt.org/viewtopic.php?pid=160079#p160079</a></p><p>As I compile firmware only for WNDR3700v1/v2/3800 family, which all have similar processors, I can tailor the optimization to be processor-specific. Instead of leaving the code suitable for the whole &#039;mips32r2&#039; CPU series, I can set it to support specifically this router&#039;s &#039;24kc&#039; processors. Original config is &quot;-Os -pipe -mips32r2 -mtune=mips32r2 -fno-caller-saves&quot; and comes from <a href="https://dev.openwrt.org/browser/trunk/target/linux/ar71xx/Makefile#L13">https://dev.openwrt.org/browser/trunk/target/linux/ar71xx/Makefile#L13</a></p><p>I did the optimization by adding a few lines to my config (can be also done through menuconfig):<br/></p><div class="codebox"><pre><code>CONFIG_DEVEL=y
CONFIG_TARGET_OPTIONS=y
CONFIG_TARGET_OPTIMIZATION=&quot;-Os -pipe -march=24kc -mtune=24kc -fno-caller-saves&quot;</code></pre></div><p>I used the Openssl benchmark for measuring the CPU power. It can be found in Wiki:<br/><a href="http://wiki.openwrt.org/inbox/benchmark.openssl">http://wiki.openwrt.org/inbox/benchmark.openssl</a></p><p>The improvement was quite large for most measurements. The older v1 has practically identical kernel &amp; build version and the CPU optimizations. It clearly beats the v2 which has no optimizations: <br/></p><div class="codebox"><pre><code>WNDR3700v1 / r33288 / -march=24kc  -mtune=24kc
| 1.0.1c |  33849080 |  11416910 |  8066650 |  4917620 |  5249110 |  1875610 |  9133810 |  7940310 |  7051220 |  7.5 |  256.9 |  25.9 |  21.4 |

WNDR3700v2 / r33275 / -mips32r2  -mtune=mips32r2
| 1.0.1c |  33704030 |  11410380 |  7957250 |  4804920 |  4865770 |  1768170 |  8224980 |  7162790 |  6426480 |  6.0 |  205.1 |  20.6 |  16.7 |</code></pre></div><p>This CPU optimization should help especially CPU-heavy tasks, e.g. all encryption related stuff. I have not yet uploaded the new version to the FTP server, but if I do not find any drawbacks in real-life use in the next few days, I will probably leave that optimization on.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176299">
				<div class="post-metadata">
					<div class="post-num">Post #242</div>
					<div class="post-author">tt</div>
					<div class="post-datetime">
						29 Aug 2012, 15:10					</div>
				</div>
				<div class="post-content content">
					<p>Sounds promising, but are those two results from the same processor? The 24kc one says 3700v1 but the mips32r2 one says 3700v2.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176306">
				<div class="post-metadata">
					<div class="post-num">Post #243</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						29 Aug 2012, 16:00					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>tt wrote:</cite><blockquote><p>Sounds promising, but are those two results from the same processor? The 24kc one says 3700v1 but the mips32r2 one says 3700v2.</p></blockquote></div><p>That line is the used code optimization. v1 was optimized for 24kc, while v2 had the standard mips32r2 code. The results are highlighting the difference that the code optimization makes.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176395">
				<div class="post-metadata">
					<div class="post-num">Post #244</div>
					<div class="post-author">tt</div>
					<div class="post-datetime">
						30 Aug 2012, 16:10					</div>
				</div>
				<div class="post-content content">
					<p>Ah! I thought those were the two WNDR model # variants, 3700v2 being the newer unit. :-)</p><p>That&#039;s a surprising improvement. I guess there might be some encryption-related instruction support in the 24kc. I wouldn&#039;t expect this type of perf bump for &quot;normal&quot; workloads, but it&#039;s good to see.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176399">
				<div class="post-metadata">
					<div class="post-num">Post #245</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						30 Aug 2012, 16:30					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>tt wrote:</cite><blockquote><p>Ah! I thought those were the two WNDR model # variants, 3700v2 being the newer unit. :-)</p></blockquote></div><p>That is also true. I have both...<br/>And currently my v1 has been flashed with the 24kc optimized firmware, while v2 has the one day older firmware for generic mips32r2 without optimizations.</p>											<p class="post-edited">(Last edited by <strong>hnyman</strong> on 30 Aug 2012, 19:30)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176458">
				<div class="post-metadata">
					<div class="post-num">Post #246</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						30 Aug 2012, 23:38					</div>
				</div>
				<div class="post-content content">
					<p>Forgot about that, turned on for my builds too <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile"/></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176707">
				<div class="post-metadata">
					<div class="post-num">Post #247</div>
					<div class="post-author">Cythrawl</div>
					<div class="post-datetime">
						2 Sep 2012, 22:52					</div>
				</div>
				<div class="post-content content">
					<p>I am getting the same problem with your builds as Arokh&#039;s. </p><p>When I plug my USB Drive into it, it will reboot and just hang. The power light will flash green and all the Lan lights are on (no WiFi). Network shows no connection and I cant even ping or connect to the router. If I unplug the drive everything is fine. The drive works just fine on a PC, and I have tried fromatting it to EXT4 to see if it was something to do with it being NTFS. Its only on the recent builds tho, as older ones it would boot fine with the drive plugged in (But I could never get it to appear on the network as a share though.). Even tried clearing all the firmware data as well..</p><p>Any ideas on what could be causing it? Am I missing something that I should have done?</p><p>Thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176738">
				<div class="post-metadata">
					<div class="post-num">Post #248</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						3 Sep 2012, 08:47					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Cythrawl wrote:</cite><blockquote><p>Any ideas on what could be causing it? Am I missing something that I should have done?</p></blockquote></div><p>Sorry, no idea.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176927">
				<div class="post-metadata">
					<div class="post-num">Post #249</div>
					<div class="post-author">zzz2002</div>
					<div class="post-datetime">
						5 Sep 2012, 04:49					</div>
				</div>
				<div class="post-content content">
					<p>I &quot;updated&quot; a couple of days ago to r33275 ... and suddenly none of my mail servers can be accessed from the WAN side, but only from the LAN side. All remote access is blocked.<br/>What changed?</p>											<p class="post-edited">(Last edited by <strong>zzz2002</strong> on 5 Sep 2012, 05:26)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176936">
				<div class="post-metadata">
					<div class="post-num">Post #250</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						5 Sep 2012, 08:09					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>zzz2002 wrote:</cite><blockquote><p>I &quot;updated&quot; a couple of days ago to r33275 ... and suddenly none of my mail servers can be accessed from the WAN side, but only from the LAN side. All remote access is blocked.<br/>What changed?</p></blockquote></div><p>Compared to the previous version a few days ago: nothing regarding firewall etc. has changed to my knowledge.<br/>But I have no idea from which version you have updated from...<br/>My build contains nothing special regarding firewall etc., so the possible change should be in the main Openwrt code.</p><p>-----</p><p>The official Attitude Adjustment 12.09 beta has been published. Seems to be based on revision 33312. My last build 33311 is equivalent to that, as the last check-in 33312 concerned another target platform than ar71xx.</p>											<p class="post-edited">(Last edited by <strong>hnyman</strong> on 5 Sep 2012, 08:26)</p>
									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 10 of 63</div><nav><ul><li><a href="viewtopic.php%3Fid=28392&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=28392&amp;p=8.html">8</a></li><li><a href="viewtopic.php%3Fid=28392&amp;p=9.html">9</a></li><li class="pagination-current"><span>10</span></li><li><a href="viewtopic.php%3Fid=28392&amp;p=11.html">11</a></li><li><a href="viewtopic.php%3Fid=28392&amp;p=12.html">12</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=28392&amp;p=63.html">63</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>