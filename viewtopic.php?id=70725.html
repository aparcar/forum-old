<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Recovery TL-WR740n v4.21</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 19 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p357044">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">gblouzada</div>
					<div class="post-datetime">
						25 Apr 2017, 04:10					</div>
				</div>
				<div class="post-content content">
					<p>Hi</p><p>I have this router model (TL-WR740n v4.21) that has the following problem, there was no firmware modification but I was able to access the terminal via serial according to the tutorial provided, it boot correctly but I can not give the command &#039; Tpl &#039;to perform the cleaning and uploading firmware commands. It appears several times &quot;SQUASHFHS error&quot; then &quot;(none) login:&quot; and does not accept keyboard commands, I checked the connection and everything is ok.</p><p>Does it still have a solution ??</p><p>Terminal</p><div class="codebox"><pre><code>U-Boot 1.1.4 (Nov 30 2011 - 15:18:38)

AP121 (ar9330) U-boot

DRAM:  32 MB
led turning on for 1s...
id read 0x100000ff
flash size 4194304, sector count = 64
Flash:  4 MB
Using default environment

In:    serial
Out:   serial
Err:   serial
Net:   ag7240_enet_initialize...
No valid address in Flash. Using fixed address
No valid address in Flash. Using fixed address
: cfg1 0x5 cfg2 0x7114
eth0: 00:03:7f:09:0b:ad
ag7240_phy_setup
eth0 up
: cfg1 0xf cfg2 0x7214
eth1: 00:03:7f:09:0b:ad
athrs26_reg_init_lan
ATHRS26: resetting s26
ATHRS26: s26 reset done
ag7240_phy_setup
eth1 up
eth0, eth1
Autobooting in 1 seconds
## Booting image at 9f020000 ...
   Uncompressing Kernel Image ... OK

Starting kernel ...

Booting AR9330(Hornet)...
Linux version 2.6.31--LSDK-9.2.0.312 (root@bogon) (gcc version 4.3.3 (GCC) ) #221 Wed Nov 30 14:10:12 CST 2011
flash_size passed from bootloader = 4
CPU revision is: 00019374 (MIPS 24Kc)
Determined physical RAM map:
 memory: 02000000 @ 00000000 (usable)
User-defined physical RAM map:
 memory: 02000000 @ 00000000 (usable)
Zone PFN ranges:
  Normal   0x00000000 -&gt; 0x00002000
Movable zone start PFN for each node
early_node_map[1] active PFN ranges
    0: 0x00000000 -&gt; 0x00002000
Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 8128
Kernel command line: console=ttyS0,115200 root=31:02 rootfstype=squashfs init=/sbin/init mtdparts=ar7240-nor0:128k(u-boot),1024k(kernel),2816(rootfs),64k(config),64k(ART) mem=32M
PID hash table entries: 128 (order: 7, 512 bytes)
Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
Primary instruction cache 64kB, VIPT, 4-way, linesize 32 bytes.
Primary data cache 32kB, 4-way, VIPT, cache aliases, linesize 32 bytes
Writing ErrCtl register=00000000
Readback ErrCtl register=00000000
Memory: 29864k/32768k available (1888k kernel code, 2904k reserved, 524k data, 116k init, 0k highmem)
Hierarchical RCU implementation.
NR_IRQS:128
plat_time_init: plat time init done
Calibrating delay loop... 266.24 BogoMIPS (lpj=532480)
Mount-cache hash table entries: 512
NET: Registered protocol family 16
===== ar7240_platform_init: 0


Whoops! This kernel is for product wr741 v4.0!

bio: create slab &lt;bio-0&gt; at 0
SCSI subsystem initialized
usbcore: registered new interface driver usbfs
usbcore: registered new interface driver hub
usbcore: registered new device driver usb
NET: Registered protocol family 2
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 1024 (order: 1, 8192 bytes)
TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
TCP: Hash tables configured (established 1024 bind 1024)
TCP reno registered
NET: Registered protocol family 1
AR7240 GPIOC major 0
squashfs: version 4.0 (2009/01/31) Phillip Lougher
NTFS driver 2.1.29 [Flags: R/O].
msgmni has been set to 58
alg: No test for lzma (lzma-generic)
alg: No test for stdrng (krng)
io scheduler noop registered
io scheduler anticipatory registered
io scheduler deadline registered
io scheduler cfq registered (default)
Serial: 8250/16550 driver, 1 ports, IRQ sharing disabled
ttyS0: detected caps 00000000 should be 00000100
serial8250.0: ttyS0 at MMIO 0xb8020000 (irq = 19) is a 16550A
console [ttyS0] enabled
PPP generic driver version 2.4.2
NET: Registered protocol family 24
cmdlinepart partition parsing not available
set partition boot
set partition kernel
set partition rootfs
set partition config
set partition art
set partition â–’
Searching for RedBoot partition table
5 RedBoot partitions found on MTD device ar7240-nor0
Creating 5 MTD partitions on &quot;ar7240-nor0&quot;:
0x000000000000-0x000000020000 : &quot;boot&quot;
0x000000020000-0x000000120000 : &quot;kernel&quot;
0x000000120000-0x0000003e0000 : &quot;rootfs&quot;
0x0000003e0000-0x0000003f0000 : &quot;config&quot;
0x0000003f0000-0x000000400000 : &quot;art&quot;
-&gt;Oops: flash id 0x1c3016 .
ehci_hcd: USB 2.0 &#039;Enhanced&#039; Host Controller (EHCI) Driver
Port Status 1c000004
ar7240-ehci ar7240-ehci.0: ATH EHCI
ar7240-ehci ar7240-ehci.0: new USB bus registered, assigned bus number 1
ehci_reset Intialize USB CONTROLLER in host mode: 3
ehci_reset Port Status 1c000000
ar7240-ehci ar7240-ehci.0: irq 3, io mem 0x1b000000
ehci_reset Intialize USB CONTROLLER in host mode: 3
ehci_reset Port Status 1c000000
ar7240-ehci ar7240-ehci.0: USB 2.0 started, EHCI 1.00
usb usb1: configuration #1 chosen from 1 choice
hub 1-0:1.0: USB hub found
hub 1-0:1.0: 1 port detected
TCP cubic registered
NET: Registered protocol family 17
802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;
All bugs added by David S. Miller &lt;davem@redhat.com&gt;
ar7240wdt_init: Registering WDT success
VFS: Mounted root (squashfs filesystem) readonly on device 31:2.
Freeing unused kernel memory: 116k freed
init started:  BusyBox v1.01 (2011.04.01-07:49+0000) multi-call binary
This Board use 2.6.31
xt_time: kernel timezone is -0000
nf_conntrack version 0.5.0 (512 buckets, 5120 max)
ip_tables: (C) 2000-2006 Netfilter Core Team
insmod: cannot open module `/lib/modules/2.6.31/kernel/iptable_raw.ko&#039;: No such file or directory
insmod: cannot open module `/lib/modules/2.6.31/kernel/flashid.ko&#039;: No such file or directory
PPPoL2TP kernel driver, V1.0
PPTP driver version 0.8.3
insmod: cannot open module `/lib/modules/2.6.31/kernel/harmony.ko&#039;: No such file or directory
unlzma/peek_old_byte: position 319679 out of range
SQUASHFS error: crypto_decompress_update returned -96585, data probably corrupt
SQUASHFS error: squashfs_read_data failed to read block 0x203f6c
SQUASHFS error: Unable to read data cache entry [203f6c]
SQUASHFS error: Unable to read page, block 203f6c, size 9b84
SQUASHFS error: Unable to read data cache entry [203f6c]
SQUASHFS error: Unable to read page, block 203f6c, size 9b84
SQUASHFS error: Unable to read data cache entry [203f6c]
SQUASHFS error: Unable to read page, block 203f6c, size 9b84
SQUASHFS error: Unable to read data cache entry [203f6c]
SQUASHFS error: Unable to read page, block 203f6c, size 9b84
SQUASHFS error: Unable to read data cache entry [203f6c]
SQUASHFS error: Unable to read page, block 203f6c, size 9b84
SQUASHFS error: Unable to read data cache entry [203f6c]
SQUASHFS error: Unable to read page, block 203f6c, size 9b84
SQUASHFS error: Unable to read data cache entry [203f6c]
SQUASHFS error: Unable to read page, block 203f6c, size 9b84
SQUASHFS error: Unable to read data cache entry [203f6c]
SQUASHFS error: Unable to read page, block 203f6c, size 9b84
SQUASHFS error: Unable to read data cache entry [203f6c]
SQUASHFS error: Unable to read page, block 203f6c, size 9b84
SQUASHFS error: Unable to read data cache entry [203f6c]
SQUASHFS error: Unable to read page, block 203f6c, size 9b84
SQUASHFS error: Unable to read data cache entry [203f6c]
SQUASHFS error: Unable to read page, block 203f6c, size 9b84
SQUASHFS error: Unable to read data cache entry [203f6c]
SQUASHFS error: Unable to read page, block 203f6c, size 9b84
SQUASHFS error: Unable to read data cache entry [203f6c]
SQUASHFS error: Unable to read page, block 203f6c, size 9b84
SQUASHFS error: Unable to read data cache entry [203f6c]
SQUASHFS error: Unable to read page, block 203f6c, size 9b84
SQUASHFS error: Unable to read data cache entry [203f6c]
SQUASHFS error: Unable to read page, block 203f6c, size 9b84
SQUASHFS error: Unable to read data cache entry [203f6c]
SQUASHFS error: Unable to read page, block 203f6c, size 9b84
SQUASHFS error: Unable to read data cache entry [203f6c]
SQUASHFS error: Unable to read page, block 203f6c, size 9b84
SQUASHFS error: Unable to read data cache entry [203f6c]
SQUASHFS error: Unable to read page, block 203f6c, size 9b84
unlzma/peek_old_byte: position 319679 out of range
SQUASHFS error: crypto_decompress_update returned -96585, data probably corrupt
SQUASHFS error: squashfs_read_data failed to read block 0x203f6c
SQUASHFS error: Unable to read data cache entry [203f6c]
SQUASHFS error: Unable to read page, block 203f6c, size 9b84

 (none) mips #221 Wed Nov 30 14:10:12 CST 2011 (none)
(none) login:</code></pre></div>											<p class="post-edited">(Last edited by <strong>gblouzada</strong> on 25 Apr 2017, 05:59)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p357084">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">mk24</div>
					<div class="post-datetime">
						25 Apr 2017, 21:08					</div>
				</div>
				<div class="post-content content">
					<p>Copy &quot;tpl&quot; (lower case t) to the clipboard then paste it to your terminal window right after the &quot;auto booting in 1 seconds&quot; message appears.<br />Also this may be one of the models where you need to add a wire to hook up serial input.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p357085">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">gblouzada</div>
					<div class="post-datetime">
						25 Apr 2017, 21:43					</div>
				</div>
				<div class="post-content content">
					<p>Hi mk24</p><p>Then I made the connection according to the manual, this connection is to the TX of the router, this part is working cool, what is not working is the terminal receive commands from the keyboard.</p><p>Thank you anyway, if you have any other ideas, feel free to</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>