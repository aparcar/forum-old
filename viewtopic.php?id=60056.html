<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> DNS resolution problem at first try</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 2 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p294347">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">EpicLPer</div>
					<div class="post-datetime">
						2 Oct 2015, 19:58					</div>
				</div>
				<div class="post-content content">
					<p>Hello there!</p><p>So for a while I&#039;ve researched this problem now and I can&#039;t quite figure out why this is happening or what settings cause this.<br />When first connecting/resolving an URL (as example when I&#039;m doing an update on Linux via apt-get update) I get a bunch of error messages regarding that the network cannot be reached. However when I&#039;m doing it a second time it&#039;ll work just fine.<br />I&#039;m seeing this problem with all of my Linux PCs in my network, not only via Terminal but also as example when just surfing around. I often get an error message that says it can, once again, not resolve the host but after a second it&#039;ll display the page just fine. I can then refresh it as often as I want without it doing that again, except when I used a lot of different other URLs then and probably cleared something on OpenWRT, not sure.</p><p>I&#039;m not seeing this with Windows btw., maybe it&#039;s a bit more tolerant when it comes to network stuff.</p><p>So, anyways, back on topic. Do you guys know what settings could cause this on OpenWRT if any? Currently I&#039;m using &quot;OpenWrt Chaos Calmer r44873&quot; with LuCI (git-15.069.64601-4ab6dce).<br />My network is built up with 2 OpenWRT routers whereas one acts as DNS and DHCP client and the other one connected after it just as a WiFi Access Point and nothing more.<br />For some reason I can&#039;t connect to the update site of OpenWRT with the second one but that&#039;d be topic for a second thread here I guess. LAN devices work no problem at all tho.</p><p>Thanks for helping an OpenWRT beginner! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>											<p class="post-edited">(Last edited by <strong>EpicLPer</strong> on 2 Oct 2015, 20:00)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p294363">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">eduperez</div>
					<div class="post-datetime">
						2 Oct 2015, 22:35					</div>
				</div>
				<div class="post-content content">
					<p>Which DNS servers have you configured your PCs to use?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p294369">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">EpicLPer</div>
					<div class="post-datetime">
						2 Oct 2015, 22:55					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>eduperez wrote:</cite><blockquote><p>Which DNS servers have you configured your PCs to use?</p></blockquote></div><p>My main router aka. 192.168.0.1<br />Hm, maybe I should try Google DNS and see if it persists, comes into my mind right now <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p294501">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">EpicLPer</div>
					<div class="post-datetime">
						3 Oct 2015, 21:52					</div>
				</div>
				<div class="post-content content">
					<p>Okay, tried to use the Google DNS on Linux for a day now and there&#039;s no real change there now.<br />Big surprise is that I saw a same behaviour today on Windows too, aka. some pictures on websites not loading but after a second reload they worked fine.</p><p>Any ideas still?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p294507">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">shallpion</div>
					<div class="post-datetime">
						3 Oct 2015, 22:56					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>EpicLPer wrote:</cite><blockquote><p>Okay, tried to use the Google DNS on Linux for a day now and there&#039;s no real change there now.<br />Big surprise is that I saw a same behaviour today on Windows too, aka. some pictures on websites not loading but after a second reload they worked fine.</p><p>Any ideas still?</p></blockquote></div><p>Did you try to disable ipv6? (may not be relevant though)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p294510">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">EpicLPer</div>
					<div class="post-datetime">
						3 Oct 2015, 22:59					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>shallpion wrote:</cite><blockquote><div class="quotebox"><cite>EpicLPer wrote:</cite><blockquote><p>Okay, tried to use the Google DNS on Linux for a day now and there&#039;s no real change there now.<br />Big surprise is that I saw a same behaviour today on Windows too, aka. some pictures on websites not loading but after a second reload they worked fine.</p><p>Any ideas still?</p></blockquote></div><p>Did you try to disable ipv6? (may not be relevant though)</p></blockquote></div><p>Yep, in fact I did that a long time ago already</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p294521">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">Napsi-GER-</div>
					<div class="post-datetime">
						3 Oct 2015, 23:40					</div>
				</div>
				<div class="post-content content">
					<p>Hello EpicLPer,</p><p>can you provide the output of the Traceroute Function in LuCI for e.g. &quot;dev.openwrt.org&quot; or &quot;8.8.8.8&quot;?<br />And the dnslookup for e.g. &quot;dev.openwrt.org&quot;? Maybe we can track this Problem down to your router.<br />Btw, did you change any Firewall settings and is the wifi network bridged to the LAN network?</p><p>Traceroute and Dns Lookups performed on the Clients (2 times, if the first fails) could be relevant too. Just some Mindstorming <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Napsi-GER-</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p294546">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">RangerZ</div>
					<div class="post-datetime">
						4 Oct 2015, 02:09					</div>
				</div>
				<div class="post-content content">
					<p>Regarding your ability to download packages for the AP, I had this problem and I recall it was having a field populated that should not have been (or visa versa).</p><p>This config appears to work, but I do not recall which was the element that fixed things.&nbsp; My router is 192.168.111.1, yours is 192.168.0.1.</p><div class="codebox"><pre><code>Network=&gt;LAN=&gt;Edit=&gt;Common Config=&gt;General Setup
IPv4 Address                   192.168.111.7
IPv4 gateway                   192.168.111.1
Net Mask                       255.255.255.0
Use custom DNS servers         192.168.111.1

Network=&gt;DHCP &amp; DNS=&gt;Server Settings=&gt;General Settings
DNS Forwardings                192.168.111.1</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p294557">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">EpicLPer</div>
					<div class="post-datetime">
						4 Oct 2015, 03:13					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>RangerZ wrote:</cite><blockquote><p>Regarding your ability to download packages for the AP, I had this problem and I recall it was having a field populated that should not have been (or visa versa).</p><p>This config appears to work, but I do not recall which was the element that fixed things.&nbsp; My router is 192.168.111.1, yours is 192.168.0.1.</p><div class="codebox"><pre><code>Network=&gt;LAN=&gt;Edit=&gt;Common Config=&gt;General Setup
IPv4 Address                   192.168.111.7
IPv4 gateway                   192.168.111.1
Net Mask                       255.255.255.0
Use custom DNS servers         192.168.111.1

Network=&gt;DHCP &amp; DNS=&gt;Server Settings=&gt;General Settings
DNS Forwardings                192.168.111.1</code></pre></div></blockquote></div><p>Thanks! This at least fixed the issues to finally be able to use the software section in LuCI and via console.<br />I&#039;ll see if it fixed the DNS problems too since it kinda makes sense actually, wonder I didn&#039;t see that so far <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p294559">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">Napsi-GER-</div>
					<div class="post-datetime">
						4 Oct 2015, 03:19					</div>
				</div>
				<div class="post-content content">
					<p>Hello RangerZ,</p><div class="quotebox"><blockquote><p>DNS Forwardings&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 192.168.111.1</p></blockquote></div><p>was the entry that fixed your problem. If you install OpenWRT on a router (implementing the usage of dnsmasq), it will try to resolve hostnames by dnsmasq (even if you set &quot;use custom dns servers&quot;), which in case of only AP operation can&#039;t resolve them properly (in fact, it is not <strong>that</strong> simple). So you can prime it with a dns-server to ask (192.168.111.1 or 8.8.8.8 [should work also if local hostnames should be omitted]) or disable it completely, so the router uses the config (&quot;use custom dns servers&quot; field) given by dhcp or manual configuration.</p><p>Aiming to the problem of EpicLPer,</p><p>a good practice is to prime dnsmasq on the router with dns-servers to ask (eg: 8.8.8.8, or the ones from your provider) so it can resolve unknown hostnames by asking them.</p><p>Napsi-GER-</p>											<p class="post-edited">(Last edited by <strong>Napsi-GER-</strong> on 4 Oct 2015, 03:20)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>