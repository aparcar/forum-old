<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Setting up a wl-500gP with Kamikaze (AP-mode, samba, DHCP-Server)</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 26 Mar 2018 and 22 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 2 of 2</div><nav><ul><li><a href="viewtopic.php%3Fid=11495&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p53413">
				<div class="post-metadata">
					<div class="post-num">Post #26</div>
					<div class="post-author">brucebertrand</div>
					<div class="post-datetime">
						5 Aug 2007, 04:16					</div>
				</div>
				<div class="post-content content">
					<p><strong>pivot /mnt /mnt</strong> is correct.&nbsp; It just means make /mnt the new root and put the old root in the <em>new</em> /mnt</p><p>&quot;pivot&quot; by itself is not a command...it&#039;s a function in /bin/firstboot which is called by the new /sbin/init</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p53829">
				<div class="post-metadata">
					<div class="post-num">Post #27</div>
					<div class="post-author">mountaindude</div>
					<div class="post-datetime">
						13 Aug 2007, 21:11					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Bilkid wrote:</cite><blockquote><p>so this:<br />root@AsusGP:/# mount<br />rootfs on / type rootfs (rw)<br />/dev/root on /rom type squashfs (ro)<br />none on /dev type devfs (rw)<br />none on /proc type proc (rw)<br />none on /tmp type tmpfs (rw,nosuid,nodev)<br />none on /dev/pts type devpts (rw)<br />/dev/mtdblock/4 on /jffs type jffs2 (rw)<br />/jffs on / type mini_fo (rw)<br />/dev/scsi/host0/bus0/target0/lun0/part1 on /mnt/sea100 type ext3 (rw)<br />/dev/scsi/host0/bus0/target0/lun0/part5 on /mnt/sea200 type ext3 (rw)<br />/dev/scsi/host0/bus0/target0/lun0/part6 on /mnt/sea300 type ext3 (rw)<br />none on /proc/bus/usb type usbfs (rw)</p><br /><p>says I&#039;m not set?</p></blockquote></div><p>brucebertrand and others, we newbies sure appreciate your help.</p><p>I still don&#039;t get it though, how can you tell from Bilkid&#039;s output that you are booting from the USB memory stick and not the built-in flash?<br />For example, what does &quot;rootfs on / type rootfs (rw)&quot; indicate?</p><p><em>Update</em><br />I&#039;ve tried booting with and without the memory stick and capturing the output of mount in each case. The only thing differing is:</p><p>Booting with memory stick: <br />root@OpenWrt:~# mount<br />rootfs on / type rootfs (rw)<br />/dev/root on /rom type squashfs (ro)<br />none on /proc type proc (rw)<br /><strong>none on /rom/sys type sysfs (rw)</strong><br />none on /tmp type tmpfs (rw,nosuid,nodev)<br />tmpfs on /dev type tmpfs (rw)<br />none on /dev/pts type devpts (rw)<br />/dev/mtdblock3 on /jffs type jffs2 (rw)<br />/jffs on / type mini_fo (rw)<br />none on /proc/bus/usb type usbfs (rw)</p><br /><p>Booting without memory stick attached:<br />root@OpenWrt:~# mount<br />rootfs on / type rootfs (rw)<br />/dev/root on /rom type squashfs (ro)<br />none on /proc type proc (rw)<br /><strong>none on /sys type sysfs (rw)</strong><br />none on /tmp type tmpfs (rw,nosuid,nodev)<br />tmpfs on /dev type tmpfs (rw)<br />none on /dev/pts type devpts (rw)<br />/dev/mtdblock3 on /jffs type jffs2 (rw)<br />/jffs on / type mini_fo (rw)<br />none on /proc/bus/usb type usbfs (rw)</p><br /><p>The single line differing is highlighten. Does this mean I am in fact booting off the stick when it is attached..?</p><br /><p>Another comment:<br />It seems that with Kamikaze 7.07 the memory stick does not show up as /dev/scsi/..., but rather as /dev/sda and /dev/sda1. <br />Can anyone confirm that this is correct, and that on 7.07 with 2.6.22 you should use /dev/sda or /dev/sda1 instead?<br />But which one? </p><br /><br /><p>Many thanks..</p>											<p class="post-edited">(Last edited by <strong>mountaindude</strong> on 13 Aug 2007, 21:45)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p53843">
				<div class="post-metadata">
					<div class="post-num">Post #28</div>
					<div class="post-author">mountaindude</div>
					<div class="post-datetime">
						14 Aug 2007, 01:57					</div>
				</div>
				<div class="post-content content">
					<p>Some additional info:</p><p>The output from logread indicate there is something going wrong during initialization of the memory stick.<br />Anyone know what the error means?</p><p>root@mini:~# logread<br />r.info kernel: uhci_hcd 0000:00:03.1: UHCI Host Controller<br />Jan&nbsp; 1 00:01:12 mini user.info kernel: uhci_hcd 0000:00:03.1: new USB bus registered, assigned bus number 2<br />Jan&nbsp; 1 00:01:12 mini user.info kernel: uhci_hcd 0000:00:03.1: irq 6, io base 0x00000120<br />Jan&nbsp; 1 00:01:12 mini user.info kernel: usb usb2: configuration #1 chosen from 1 choice<br />Jan&nbsp; 1 00:01:12 mini user.info kernel: hub 2-0:1.0: USB hub found<br />Jan&nbsp; 1 00:01:12 mini user.info kernel: hub 2-0:1.0: 2 ports detected<br />Jan&nbsp; 1 00:01:12 mini user.info kernel: usb 1-1: new full speed USB device using uhci_hcd and address 2<br />Jan&nbsp; 1 00:01:12 mini user.err kernel: usb 1-1: device descriptor read/64, error -71<br />Jan&nbsp; 1 00:01:12 mini user.warn kernel: PCI: Enabling device 0000:00:03.2 (0000 -&gt; 0002)<br />Jan&nbsp; 1 00:01:12 mini user.warn kernel: PCI: Fixing up device 0000:00:03.2<br />Jan&nbsp; 1 00:01:12 mini user.info kernel: ehci_hcd 0000:00:03.2: EHCI Host Controller<br />Jan&nbsp; 1 00:01:12 mini user.info kernel: ehci_hcd 0000:00:03.2: new USB bus registered, assigned bus number 3<br />Jan&nbsp; 1 00:01:12 mini user.info kernel: ehci_hcd 0000:00:03.2: irq 6, io mem 0x40000000<br />Jan&nbsp; 1 00:01:12 mini user.info kernel: ehci_hcd 0000:00:03.2: USB 2.0 started, EHCI 1.00, driver 10 Dec 2004<br />Jan&nbsp; 1 00:01:12 mini user.info kernel: usb usb3: configuration #1 chosen from 1 choice<br />Jan&nbsp; 1 00:01:12 mini user.info kernel: hub 3-0:1.0: USB hub found<br />Jan&nbsp; 1 00:01:12 mini user.info kernel: hub 3-0:1.0: 4 ports detected<br />Jan&nbsp; 1 00:01:13 mini user.notice kernel: SCSI subsystem initialized<br />Jan&nbsp; 1 00:01:13 mini user.info kernel: Initializing USB Mass Storage driver...<br />Jan&nbsp; 1 00:01:13 mini user.info kernel: usbcore: registered new interface driver usb-storage<br />Jan&nbsp; 1 00:01:13 mini user.info kernel: USB Mass Storage support registered.<br />Jan&nbsp; 1 00:01:13 mini user.info kernel: usb 1-1: new full speed USB device using uhci_hcd and address 3<br />Jan&nbsp; 1 00:01:14 mini user.info kernel: usb 1-1: not running at top speed; connect to a high speed hub<br />Jan&nbsp; 1 00:01:14 mini user.info kernel: usb 1-1: configuration #1 chosen from 1 choice<br />Jan&nbsp; 1 00:01:14 mini user.info kernel: scsi0 : SCSI emulation for USB Mass Storage devices<br />Jan&nbsp; 1 00:01:14 mini user.debug kernel: usb-storage: device found at 3<br />Jan&nbsp; 1 00:01:14 mini user.debug kernel: usb-storage: waiting for device to settle before scanning<br /><strong>Jan&nbsp; 1 00:01:15 mini user.info : Illegal instruction<br />Jan&nbsp; 1 00:01:16 mini user.info : /sbin/hotplug-call: /etc/hotplug.d/usb/10-usb-storage: 12: /sbin/usb-storage: Permission denied</strong><br />Jan&nbsp; 1 00:01:17 mini cron.notice crond[1671]: crond 2.3.2 dillon, started, log level 8<br />Jan&nbsp; 1 00:01:17 mini authpriv.info dropbear[1675]: Running in background<br />Jan&nbsp; 1 00:01:19 mini user.notice kernel: scsi 0:0:0:0: Direct-Access&nbsp; &nbsp; &nbsp;USB 2.0&nbsp; Flash Disk&nbsp; &nbsp; &nbsp; &nbsp;2.00 PQ: 0 ANSI: 2<br />Jan&nbsp; 1 00:01:19 mini user.notice kernel: sd 0:0:0:0: [sda] 517376 512-byte hardware sectors (265 MB)<br />Jan&nbsp; 1 00:01:19 mini user.notice kernel: sd 0:0:0:0: [sda] Write Protect is off<br />Jan&nbsp; 1 00:01:19 mini user.debug kernel: sd 0:0:0:0: [sda] Mode Sense: 0b 00 00 08<br />Jan&nbsp; 1 00:01:19 mini user.err kernel: sd 0:0:0:0: [sda] Assuming drive cache: write through<br />Jan&nbsp; 1 00:01:19 mini user.notice kernel: sd 0:0:0:0: [sda] 517376 512-byte hardware sectors (265 MB)<br />Jan&nbsp; 1 00:01:19 mini user.notice kernel: sd 0:0:0:0: [sda] Write Protect is off<br />Jan&nbsp; 1 00:01:19 mini user.debug kernel: sd 0:0:0:0: [sda] Mode Sense: 0b 00 00 08<br />Jan&nbsp; 1 00:01:19 mini user.err kernel: sd 0:0:0:0: [sda] Assuming drive cache: write through<br />Jan&nbsp; 1 00:01:19 mini user.info kernel:&nbsp; sda1<br />Jan&nbsp; 1 00:01:19 mini user.notice kernel: sd 0:0:0:0: [sda] Attached SCSI removable disk<br />Jan&nbsp; 1 00:01:19 mini user.debug kernel: usb-storage: device scan complete</p><br /><p><strong>/sbin/init is as follows:</strong></p><br /><div class="codebox"><pre><code>#!/bin/sh

boot_dev=&quot;/dev/sda1&quot;

# /sbin/udevtrigger

/sbin/hotplug2 --persistent &amp;
echo /sbin/hotplug-call &gt; /proc/sys/kernel/hotplug

# for module in usbcore usb-ohci ehci-hcd uhci-hcd scsi_mod sd_mod usb-storage jbd ext3 ; do {
for module in usbcore ehci-hcd scsi_mod sd_mod usb-storage jbd ext3 ; do {
       insmod $module
}; done

echo &quot;pos 0:&quot; &gt; /blog
date &gt;&gt; /blog
sleep 10s
#mount $boot_dev /mnt -t ext3 -o rw,noatime
umount /dev/sda1

sleep 10s
mount /dev/sda1 /mnt -t ext3 -o rw,noatime
sleep 15s
echo &quot;pos 1:&quot; &gt;&gt; /blog
date &gt;&gt; /blog

# if everything looks ok, do the pivot root
[ -x /mnt/sbin/init ] &amp;&amp; {
        echo &quot;pos 1.5:&quot; &gt;&gt; /blog
        date &gt;&gt; /blog
        . /bin/firstboot
        pivot /mnt /mnt
        echo &quot;pos 2:&quot; &gt;&gt; /blog
        date &gt;&gt; /blog
}

echo &quot;pos 3:&quot; &gt;&gt; /blog
date &gt;&gt; /blog
exec /bin/busybox init
echo &quot;pos 4:&quot; &gt;&gt; /blog
date &gt;&gt; /blog</code></pre></div><p>Only thing that ever shows up in the /blog file is<br /></p><div class="codebox"><pre><code>Sat Jan  1 00:00:05 UTC 2000
pos 1:
Sat Jan  1 00:00:41 UTC 2000
pos 3:
Sat Jan  1 00:00:56 UTC 2000</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p54015">
				<div class="post-metadata">
					<div class="post-num">Post #29</div>
					<div class="post-author">mountaindude</div>
					<div class="post-datetime">
						16 Aug 2007, 18:51					</div>
				</div>
				<div class="post-content content">
					<p>Ok, a lot of time later I have come to realize what was causing my issues. As I&#039;ve noticed on the forum that others have had similar (same?) problems, I&#039;ll write a few lines.</p><p><strong>Make sure you edit the config files not only on the router, but also on the USB stick!</strong><br />Turned out my system booted fine off the stick, but the /etc/config/network file on the stick was the same as the original install when flashing the system, i.e. not reflecting the network setup. <br />No wonder I couldn&#039;g connect to the router when it had booted with the USB stick....</p><p>And oh, I have exactly the same system setup as described in the howto, including same IP numbers. Only difference is that I use fixed IPs on the LAN side of the OpenWRT router, rather than DHCP. Also Wireless is disabled. </p><p>Once I made sure the /etc/config/network file on the built-in flash and on the USB stick were the same, all was fine.</p><p>Good luck!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p55410">
				<div class="post-metadata">
					<div class="post-num">Post #30</div>
					<div class="post-author">semi</div>
					<div class="post-datetime">
						10 Sep 2007, 10:02					</div>
				</div>
				<div class="post-content content">
					<p>Wow, just wanted to say thanks. I updated my router to kamikaze a few weeks back and could not get samba to work for the life of me, even though it worked fine on the same config in whiterussian. Wasn&#039;t until I found this tutorial that I noticed it was because of the lack of a line in /etc/hosts.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p57137">
				<div class="post-metadata">
					<div class="post-num">Post #31</div>
					<div class="post-author">orso</div>
					<div class="post-datetime">
						7 Oct 2007, 00:17					</div>
				</div>
				<div class="post-content content">
					<p>I followed your usb-stick guide. It seems to boot of from the stick at reboot. But when i run ipkg it reads the native ipkg.conf file and not the /mnt/etc/ipkg.conf file. So my old ipkg.conf resides on the usbstick and i got a new one in /etc.</p><p>This is confusing.</p><p>root@OpenWrt:/mnt# df -m<br />Filesystem&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1M-blocks&nbsp; &nbsp; &nbsp; Used Available Use% Mounted on<br />none&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 15&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; 15&nbsp; &nbsp;0% /tmp<br />/dev/mtdblock/4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 6&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2&nbsp; 66% /jffs<br />mini_fo:/jffs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 100% /mnt<br />/dev/scsi/host0/bus0/target0/lun0/part1&nbsp; &nbsp; &nbsp; &nbsp;917&nbsp; &nbsp; &nbsp; &nbsp; 21&nbsp; &nbsp; &nbsp; &nbsp;849&nbsp; &nbsp;2% /</p><br /><p>root@OpenWrt:/mnt# mount<br />rootfs on / type rootfs (rw)<br />/dev/root on /mnt/rom type squashfs (ro)<br />none on /dev type devfs (rw)<br />none on /proc type proc (rw)<br />none on /tmp type tmpfs (rw,nosuid,nodev)<br />none on /dev/pts type devpts (rw)<br />/dev/mtdblock/4 on /jffs type jffs2 (rw)<br />mini_fo:/jffs on /mnt type mini_fo (rw)<br />/dev/scsi/host0/bus0/target0/lun0/part1 on / type ext3 (rw)<br />none on /proc/bus/usb type usbfs (rw)</p><p>/tmp&nbsp; &nbsp; &nbsp; &nbsp; none&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;9%&nbsp; &nbsp; &nbsp; 1388KiB of 15256KiB<br />/jffs&nbsp; &nbsp; &nbsp; &nbsp; /dev/mtdblock/4&nbsp; &nbsp;&nbsp; 66%&nbsp; &nbsp; &nbsp; 4028KiB of 6144KiB<br />/mnt&nbsp; &nbsp; &nbsp; &nbsp;mini_fo:/jffs&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp;100%&nbsp; &nbsp; &nbsp; 1216KiB of 1216KiB<br />/&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /dev/scsi/host0/bus0/target0/lun0/part1&nbsp; &nbsp;&nbsp; 3%&nbsp; 24578KiB of 938575KiB</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p57149">
				<div class="post-metadata">
					<div class="post-num">Post #32</div>
					<div class="post-author">orso</div>
					<div class="post-datetime">
						7 Oct 2007, 11:22					</div>
				</div>
				<div class="post-content content">
					<p>next problem:</p><p>root@OpenWrt:~# openvpn --genkey --secret static.key<br />openvpn: can&#039;t load library &#039;libssl.so.0.9.8&#039;</p><p>root@OpenWrt:~# find / -name libssl*<br />/jffs/usr/lib/libssl.so.0.9.8<br />/mnt/usr/lib/libssl.so.0.9.8<br />/tmp/usr/lib/libssl.so.0.9.8</p><p>root@OpenWrt:~# openvpn&nbsp; <br />openvpn: can&#039;t load library &#039;libssl.so.0.9.8&#039;</p><p>its there but openvpn cant find it. So then there is a major problem on my setup or this howto needs a revision.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p57153">
				<div class="post-metadata">
					<div class="post-num">Post #33</div>
					<div class="post-author">orso</div>
					<div class="post-datetime">
						7 Oct 2007, 11:55					</div>
				</div>
				<div class="post-content content">
					<p>fixed it:</p><p>edit /etc/profile (i prefer nano editor) to:<br />export PATH=/bin:/sbin:/usr/bin:/usr/sbin:/mnt/bin:/mnt/sbin:/mnt/usr/bin:/mnt/usr/sbin:/mnt/bin:/mnt/sbin<br />export HOME=/mnt/tmp<br />export LD_LIBRARY_PATH=/lib:/usr/lib:/mnt/usr/lib:/mnt/lib</p><p>save and exit. and then run &quot; . /etc/profile &quot; from the shell (without &quot;).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p58019">
				<div class="post-metadata">
					<div class="post-num">Post #34</div>
					<div class="post-author">tonyboy</div>
					<div class="post-datetime">
						25 Oct 2007, 01:12					</div>
				</div>
				<div class="post-content content">
					<p>hmm, I think I&#039;m not booting from the usb-stick!?</p><p>This is my output from df -m command (just after reboot):</p><p>root@OpenWrt:/sbin# df -m<br />Filesystem&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1M-blocks&nbsp; &nbsp; &nbsp; Used Available Use% Mounted on<br />none&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 15&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; 15&nbsp; &nbsp;0% /tmp<br />/dev/mtdblock/4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 6&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;5&nbsp; 13% /jffs<br />mini_fo:/jffs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 100% /<br />root@OpenWrt:/sbin# </p><p>Shouldn&#039;t the last line contain the usb device?</p><p>This is what mount says;</p><p>root@OpenWrt:/sbin# mount<br />rootfs on / type rootfs (rw)<br />/dev/root on /rom type squashfs (ro)<br />none on /dev type devfs (rw)<br />none on /proc type proc (rw)<br />none on /tmp type tmpfs (rw,nosuid,nodev)<br />none on /dev/pts type devpts (rw)<br />/dev/mtdblock/4 on /jffs type jffs2 (rw)<br />mini_fo:/jffs on / type mini_fo (rw)<br />none on /proc/bus/usb type usbfs (rw)<br />root@OpenWrt:/sbin# </p><p>Any ideas?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p58031">
				<div class="post-metadata">
					<div class="post-num">Post #35</div>
					<div class="post-author">spelth</div>
					<div class="post-datetime">
						25 Oct 2007, 10:53					</div>
				</div>
				<div class="post-content content">
					<p>are you able to mount your stick, when the router is running?<br />try a pivot when the stick is already mounted</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p58032">
				<div class="post-metadata">
					<div class="post-num">Post #36</div>
					<div class="post-author">tonyboy</div>
					<div class="post-datetime">
						25 Oct 2007, 12:21					</div>
				</div>
				<div class="post-content content">
					<p>Yes, no problem to mount the stick during normal run! And I can browse the filesystem that is on it.</p><p>Pivot, thats something new for me... whats that? <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> <br />(I&#039;m still learning, will search and read about it, any good links?)</p><div class="quotebox"><cite>spelth wrote:</cite><blockquote><p>are you able to mount your stick, when the router is running?<br />try a pivot when the stick is already mounted</p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p58034">
				<div class="post-metadata">
					<div class="post-num">Post #37</div>
					<div class="post-author">spelth</div>
					<div class="post-datetime">
						25 Oct 2007, 13:26					</div>
				</div>
				<div class="post-content content">
					<p>Have you already read this tutorial? (Section 1, boot from USB-Stick)</p><p>OpenWrt does not mount your usb-stick automatically as root-partition.</p><p>Pivot uses pivot_root: <a href="http://linux.die.net/man/2/pivot_root">http://linux.die.net/man/2/pivot_root</a><br />and is implemented in /bin/firstboot</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p58062">
				<div class="post-metadata">
					<div class="post-num">Post #38</div>
					<div class="post-author">tonyboy</div>
					<div class="post-datetime">
						26 Oct 2007, 03:03					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for the info! But I&#039;ve done exactly what says in the tutorial. The problem might be that the USB-stick does not mount during boot, because its not mounted when I ssh into the router. After mounting it I do pivot with the following command;<br /></p><div class="codebox"><pre><code>root@OpenWrt:/bin# firstboot pivot /mnt /mnt
firstboot has already been run
jffs2 partition is mounted, only resetting files
root@OpenWrt:/bin# df -m
Filesystem           1M-blocks      Used Available Use% Mounted on
none                        15         0        15   0% /tmp
/dev/mtdblock/4              6         0         5   6% /jffs
mini_fo:/jffs                2         2         0 100% /
/dev/scsi/host0/bus0/target0/lun0/part1        62         9        50  15% /mnt
root@OpenWrt:/bin#</code></pre></div><div class="quotebox"><cite>spelth wrote:</cite><blockquote><p>Have you already read this tutorial? (Section 1, boot from USB-Stick)</p><p>OpenWrt does not mount your usb-stick automatically as root-partition.</p><p>Pivot uses pivot_root: <a href="http://linux.die.net/man/2/pivot_root">http://linux.die.net/man/2/pivot_root</a><br />and is implemented in /bin/firstboot</p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p58459">
				<div class="post-metadata">
					<div class="post-num">Post #39</div>
					<div class="post-author">spelth</div>
					<div class="post-datetime">
						3 Nov 2007, 19:35					</div>
				</div>
				<div class="post-content content">
					<p>What does happen when you run only the pivot_root /mnt /mnt?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p64137">
				<div class="post-metadata">
					<div class="post-num">Post #40</div>
					<div class="post-author">johngillespie</div>
					<div class="post-datetime">
						27 Feb 2008, 11:03					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I&#039;ve followed this tutorial on a Asus WL500gP running Kamikaze 7.09 but can&#039;t boot from the key I&#039;m using. In the tutorial you mention that things are different when using USB1 instead of USB2, I think that my key is USB1 since it&#039;s old. When you spoke about things being different with USB1 did you mean when using a router that has USB1 or when using a USB key that uses USB1 ? I am able to mount and write files to the USB key but whenever I try booting off it the unit seems to freeze yet if I insert it after booting I can mount it and use it correctly.</p><p>Regards,</p><p>John Gillespie</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p64587">
				<div class="post-metadata">
					<div class="post-num">Post #41</div>
					<div class="post-author">zzzpt</div>
					<div class="post-datetime">
						4 Mar 2008, 23:09					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>spelth wrote:</cite><blockquote><p>But then samba wouldn&#039;t start, because it looks for your Router&#039;s name and IP.<br />So wee need to add a line to /etc/hosts<br />(this is my /etc/hosts: SR-71 is my Router&#039;s name)<br /></p><div class="codebox"><pre><code>127.0.0.1 localhost
192.168.2.1 SR-71</code></pre></div><p>Then you should able to ping yourself with<br /></p><div class="codebox"><pre><code>root@SR-71:~# ping sr-71
PING SR-71 (192.168.2.1): 56 data bytes
64 bytes from 192.168.2.1: icmp_seq=0 ttl=64 time=0.7 ms
64 bytes from 192.168.2.1: icmp_seq=1 ttl=64 time=0.4 ms
64 bytes from 192.168.2.1: icmp_seq=2 ttl=64 time=0.4 ms
64 bytes from 192.168.2.1: icmp_seq=3 ttl=64 time=3.7 ms

--- SR-71 ping statistics ---
4 packets transmitted, 4 packets received, 0% packet loss
round-trip min/avg/max = 0.4/1.3/3.7 ms</code></pre></div><p>If this was successful, you can edit the <br />/etc/samba/smb.conf<br />actually, your /tmp is shared.</p><p>And now, turn on SAMBA with<br /></p><div class="codebox"><pre><code>/etc/init.d/samba start</code></pre></div></blockquote></div><p>thanks <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />i was missing this</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p64656">
				<div class="post-metadata">
					<div class="post-num">Post #42</div>
					<div class="post-author">zzzpt</div>
					<div class="post-datetime">
						5 Mar 2008, 23:16					</div>
				</div>
				<div class="post-content content">
					<p>Well still problem with Windows Vista ...<br />And in XP it asks me for user/pass, put root/pass and it didnt worked.</p><p>I&#039;m trying to install Samba3<br /></p><div class="quotebox"><blockquote><p>root@OpenWrt:/mnt/disc0_2$ ipkg install samba_3.0.28-2_mipsel.ipk <br />Installing samba (3.0.28-2) to root...<br />package samba suggests installing cups<br />Nothing to be done<br />An error ocurred, return value: 1.<br />Collected errors:<br />ERROR: Cannot satisfy the following dependencies for samba:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;popt readline gnutls openldap-libs</p></blockquote></div><p>Going to try to install these packages <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 2 of 2</div><nav><ul><li><a href="viewtopic.php%3Fid=11495&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>