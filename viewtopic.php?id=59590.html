<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> TP-Link WDR4300 semi-bricked, garbage output on serial console&gt;SOLVED</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 14 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p291609">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">lo0p</div>
					<div class="post-datetime">
						13 Sep 2015, 12:42					</div>
				</div>
				<div class="post-content content">
					<p>Good morning everybody,</p><p>after an unexpected power-loss my TP-Link WDR4300 is semi-bricked. After power-on, all leds are on for a second and after that only the power-led is on. Pressing the reset-button while starting the &quot;ying-yang&quot; led is also on.</p><p>First test with wireshark, router directly connected to the pc (configured with static ip) result in:</p><div class="codebox"><pre><code>Who has 192.168.1.66? Tell 0.0.0.0&quot;</code></pre></div><p> <img src="https://forum.openwrt.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /></p><p>Okidoo, next step. Connecting my Raspberry to the serial port of the router and starting minicom:</p><div class="codebox"><pre><code>Port /dev/ttyAMA0

Press CTRL-A Z for help on special keys



U-Boot 1.1.4 (�Y.¤&amp;H��¢j�ÂÒ��ÒҚºJj)5)ª-boot DB120��C¡H�$ié@ 128 MB
id read 0x100000ff�鍅³¶X.ÒWKҕ�qMB, sector cï]�{ 128
Flash:  8 MB
Using default enviroî[Y�5
PCIe Resetj*



              j(%¹éA   serial
Ï]/&#039;Ò«K髥�±5Err:   seriá¶CáNet:   ag93ᶴøßåî¥º�▒¥Ñѥ�±¥é�镹\.
No valid X-�«kÍ́Òn Flash. Using féҼY-¤,�«kÍ5 wasp  reset maskͺã°㰳³°��CáWASP  - e
eth0 up
etèјCáAutobooting in 1 secïîäó�ፊ## Booting imaçY¤,*2Ád0000 ...
   Uncï[.礮Ök֥¹���ernel Image ..® OK
                                                  4r֊�r¢ÊBʉ�Õե±��ÉÅR (gcc ver  Óꁆartiîç ëe·Y-$ÉÉɩH¨Hø[    0.000000] Liîõø ö¥¹▒ÖË                             *
                                                                               ¥
                                                                               ¢
                                                                               2
[    0ͮ���LLLW¤(ëkµÍé@CPU:560.0뵰�S(/    EE%¥¢ª�r���j!é±AAHB鱺²²µ®°��S)/ $U�éh0.z
[   預��LLL&amp;&amp;¦&quot;�ÑѕÉɵ¥¹��àhysical RAM mapºCມ+
                                               r������ê�Amemory: 08000000 @ 0ꁰܺͅd[ Ҡ���KLL&amp;&amp;&amp;RÒҽ¹��äanges:
[    0.00000°W$$$êK䰵�±�A [mem 0x00000000-0¸�������ÖÕPÚցA  0.000000] SË˅�±��ôons[    0.ݰ���LLW $$ë�U닁A 0: [mem 0ø���LLL&amp;▒      ÂÁmffffff]
[    0.00000°W$*®U+%å�Ònstruction cacèY$ÓKÄ偲%AQ±@4-way, linesize ³��±^ÖË֩Hh   2Ɋ[    0.000000] Rë�W답Åache èáóèŠ´X,«*¹ÑÉѥ�Íé@8192 (orderͺ�&amp;Ö+֩Hø5�º²ÂåÑ�Íͥ°°▒°��)
[    0.000000] ÐR)$˭Ô                                                       [  ͍۠1[    0.000000Ý�鐨+K%�Ñѥ¹��Èelay loop..Ȯ�278®¹³ Â¯Ö֫*
                                                    5BbÁ©õb394688)
[   �▒�L        ��ê�áid_max: defauìꁺ��&amp;¦�j¥¹¥µÕյé@301
[    0.0700°鰘W¤ê«꫹ÑѵÆache hash tableƠY�Éɥ�Íé@512
[    0.08Ͱ���W ªE¥���¥ÍÑ͕Éɕ��àrotocol family 1¶Cá[    0.0ම���LW *
                                                                  5¥j��¡¥¹��Ós ͕t
[    0.3±걘��LW$¬ÖKÉ֕�Ñѕ�slab &lt;bio-0&gt; at 0
[    0.310000] PÃR$íkÑсÅridge to bus 0000ź��C¡+r������ê�áci_bus 0000:00: roï   ]Û۠   °�¦&amp;©��¥}�ÕÍՁa000:00: No busn resoõ¹¬Éë▒¹��Ìor root bus, wé̶¶�]®j%ÕÍՁ`      ]
[    °�¦&amp;«��¥�a000:00:00.0º énv¡顶Z-¤¬+K#�Ñѥ½¹�Éata
[    0.340000]ɠ¸¬       �Ò҂�Ò҂�r�ÒIҁ`: assigned [mem �¼L&amp;&amp;&amp;£            ÂÅ`01ffÒ                                                                               ͥ2[    0.360000] TĄ̃�Y.WJ�+k¡���Ðash table åзº¹ZY.&#039;R��BzÉɑ�ÉéA1, 8ɱ¹² â¹⹺Y®RHh    ͬͥÍ                                                                              ե͡+                                                                              éͥ͠Í                                                                               r
[   ���ML&amp;&amp;&amp;VR��ÍÉt version͠���HJ*äE�B䕚U55Ie¥ (LZMÁ© ¨ÒҔRSQJ$¥¨ê�Rõ%ꊕzI%Qe¥@(c6[    0.430000] iïŐ®,VV«#�Ùoop registereäC١+                                    +
                                                r¢�����ê�Ño schedõìåòꁠ¤YX,+Ë˫�͕)[    0.44000°W¤ª�++Åé@8250/16550 drivåŹ��L                                     ͅͅd[    0.500000] m25p80 spi0.0: found s25fl064k, expected m25p80nabl¥奲Cá[    0.4͠&amp;[    0.500000] m25p80 spi0.0: s25fl064k (8192 Kbytes)
[    0.510000] 5 tp-link partitions found on MTD device spi0.0
[    0.510000] Creating 5 MTD partitions on &quot;spi0.0&quot;:
[    0.520000] 0x000000000000-0x000000020000 : &quot;u-boot&quot;
[    0.520000] 0x000000020000-0x00000012e5fc : &quot;kernel&quot;
[    0.530000] mtd: partition &quot;kernel&quot; must either start or end on erase block y
[    0.540000] 0x00000012e5fc-0x0000007f0000 : &quot;rootfs&quot;
[    0.550000] mtd: partition &quot;rootfs&quot; must either start or end on erase block y
[    0.560000] mtd: device 2 (rootfs) set to be root filesystem
[    0.570000] 1 squashfs-split partitions found on MTD device rootfs
[    0.570000] 0x000000350000-0x0000007f0000 : &quot;rootfs_data&quot;
[    0.580000] 0x0000007f0000-0x000000800000 : &quot;art&quot;
[    0.590000] 0x000000020000-0x0000007f0000 : &quot;firmware&quot;
[    0.620000] switch0: Atheros AR8327 rev. 2 switch registered on ag71xx-mdio.0
[    1.840000] libphy: ag71xx_mdio: probed
[    2.390000] ag71xx ag71xx.0: connected to PHY at ag71xx-mdio.0:00 [uid=004dd]
[    2.400000] eth0: Atheros AG71xx at 0xb9000000, irq 4, mode:RGMII
[    2.410000] TCP: cubic registered
[    2.420000] NET: Registered protocol family 17
[    2.420000] Bridge firewalling registered
[    2.420000] 8021q: 802.1Q VLAN Support v1.8
[    2.440000] VFS: Mounted root (squashfs filesystem) readonly on device 31:2.
[    2.440000] Freeing unused kernel memory: 272K (8034c000 - 80390000)
[    2.720000] SQUASHFS error: xz_dec_run error, data probably corrupt
[    2.730000] SQUASHFS error: squashfs_read_data failed to read block 0x6e
[    2.730000] SQUASHFS error: Unable to read data cache entry [6e]
[    2.740000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    2.750000] SQUASHFS error: Unable to read data cache entry [6e]
[    2.750000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    2.760000] SQUASHFS error: Unable to read data cache entry [6e]
[    2.760000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    2.770000] SQUASHFS error: Unable to read data cache entry [6e]
[    2.780000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    2.780000] SQUASHFS error: Unable to read data cache entry [6e]
[    2.790000] SQUASHFS error: Unable to read page, block 6e, size 259f4
procd: Console is alive
procd: - watchdog -
[    4.480000] usbcore: registered new interface driver usbfs
[    4.480000] usbcore: registered new interface driver hub
[    4.490000] usbcore: registered new device driver usb
[    4.500000] ehci_hcd: USB 2.0 &#039;Enhanced&#039; Host Controller (EHCI) Driver
[    4.510000] ehci-platform: EHCI generic platform driver
[    4.510000] ehci-platform ehci-platform: EHCI Host Controller
[    4.520000] ehci-platform ehci-platform: new USB bus registered, assigned bu1
[    4.530000] ehci-platform ehci-platform: irq 3, io mem 0x1b000000
[    4.550000] ehci-platform ehci-platform: USB 2.0 started, EHCI 1.00
[    4.550000] hub 1-0:1.0: USB hub found
[    4.560000] hub 1-0:1.0: 1 port detected
procd: - preinit -
[    4.660000] SQUASHFS error: xz_dec_run error, data probably corrupt
[    4.670000] SQUASHFS error: squashfs_read_data failed to read block 0x6e
[    4.670000] SQUASHFS error: Unable to read data cache entry [6e]
[    4.680000] SQUASHFS error: Unable to read page, block 6e, size 259f4
procd: Failed to start preinit
procd: - early -
procd: - watchdog -
[    4.940000] SQUASHFS error: Unable to read data cache entry [6e]
[    4.940000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    4.950000] usb 1-1: new high-speed USB device number 2 using ehci-platform
[    4.960000] SQUASHFS error: Unable to read data cache entry [6e]
[    4.960000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    4.970000] SQUASHFS error: Unable to read data cache entry [6e]
[    4.980000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    4.990000] SQUASHFS error: Unable to read data cache entry [6e]
[    4.990000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.000000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.010000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.020000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.020000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.030000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.040000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.040000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.050000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.060000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.070000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.070000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.080000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.090000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.090000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.100000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.110000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.120000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.120000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.130000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.140000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.150000] hub 1-1:1.0: USB hub found
[    5.150000] hub 1-1:1.0: 4 ports detected
[    5.160000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.160000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.170000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.180000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.190000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.190000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.200000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.210000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.220000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.220000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.230000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.240000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.240000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.250000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.260000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.260000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.270000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.280000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.290000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.290000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.300000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.310000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.320000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.320000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.330000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.340000] SQUASHFS error: Unable to read page, block 6e, size 259f4
procd: - ubus -
procd: - init -
[    5.660000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.670000] SQUASHFS error: Unable to read page, block 6e, size 259f4
Please press Ent[    5.800000] SQUASHFS error: Unable to read data cache entry ]
er to activate t[    5.810000] SQUASHFS error: Unable to read page, block 6e, s4
his console.
[    5.820000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.820000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.830000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.840000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.840000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.850000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.860000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.860000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.870000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.880000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.890000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.890000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.900000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.910000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.920000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.920000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.930000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.940000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.950000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.950000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.960000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.970000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.970000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.980000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.990000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.990000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    6.000000] SQUASHFS error: Unable to read data cache entry [6e]
[    6.010000] SQUASHFS error: Unable to read page, block 6e, size 259f4
procd: - init complete -</code></pre></div><p>A lot of garbage first but serial connection seems to be fine as the rest is clear.</p><p>Interrupting the boot process with tpl command and checking the environment:</p><div class="codebox"><pre><code>db12x&gt; printenv
bootargs=console½ºº^*)�ª����½½Ñõ31:02 rootfstype=squáóèæó Z+�õ_sbin/init mtdpa b
baudrate=1±M&amp;SH¨E¡���Éõ`xba:0xbe:0ø³X&#039;��é`x08:0x41
�.Ö«Ñõçerial�L)�Âáa060000 ${dirý]K¬ë�¹Åin&amp;&amp;erase 0x9f000°���%�V�«5¥é�íÆp.b $fill
stderr=seréXH¨E¡��ÑõÊth0

Enviroîíåîô ®��éA686/65532 bytes</code></pre></div><p>Trying to tftboot to get the load-adress</p><div class="codebox"><pre><code>db12x&gt; tftpboot
eth0 link dow®Cá*** Warning: no âë��Íile name; using &#039;6F0±P¦(�)«ëuj(UÍ¥¹��Êth0 e
TFTP froí óåò¶Y.RS�r�²Âr�r���ÚzÕÉ��P address is 19²�Lr�r���j(¥±�¹�µ��N6F01A8C  .
Ì+G�Áddress: 0x81000000
Ìïáäé®�RBþT T
Retry count å¼¬VVÖ�Ñ�ÉÑ¥¹��again
eth0 link down</code></pre></div><p>eth0 link down is ok as actually not configured. But... is 0x81000000 the adress where I need to write the new img to? Yesterday I tried to connect to a tftpserver after setting setenv ipaddr and serverip, only once I was lucky and saw in the servers logfile that the router is expecting the new image with the name 0A00A8C0.img. Unfortunately the router did not downloaded it.</p><p>Any suggestions?</p><p>Any</p>											<p class="post-edited">(Last edited by <strong>lo0p</strong> on 16 Sep 2015, 21:49)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p291620">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">makarel</div>
					<div class="post-datetime">
						13 Sep 2015, 15:02					</div>
				</div>
				<div class="post-content content">
					<p>hi</p><p>check your router documentation and tftp procedure @wiki<br />also do a firstboot from safemode and check if it works before reflashing <br />check wiki for failsafe</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p291629">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">lo0p</div>
					<div class="post-datetime">
						13 Sep 2015, 15:57					</div>
				</div>
				<div class="post-content content">
					<p>I am not able to force the WDR4300 to boot into failsafe mode.</p><p>Tried (yesterday and today after your hint) every combination, LAN/WAN-Port, clicking or pressing the reset button at different times, PCs LAN-interface with static IP 192.168.0/1.x. Wireshark with filter on UDP port 4919 shows no packets. Therefore the same with recvudp.</p><p>When I keep pressed the reset button, the ying-yang symbol starts to light, stops after some seconds. In general, after boot-process, the router has only the power-led permanently on, nothing else.</p><p>Atm I am lost <img src="https://forum.openwrt.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p291630">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Fragment</div>
					<div class="post-datetime">
						13 Sep 2015, 16:04					</div>
				</div>
				<div class="post-content content">
					<p>Do you happen to have another serial bridge i.e. USB&lt;=&gt;UART cable? I just want to rule out bad serial hardware/connection.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p291638">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">makarel</div>
					<div class="post-datetime">
						13 Sep 2015, 16:51					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>lo0p wrote:</cite><blockquote><p>I am not able to force the WDR4300 to boot into failsafe mode.</p><p>Tried (yesterday and today after your hint) every combination, LAN/WAN-Port, clicking or pressing the reset button at different times, PCs LAN-interface with static IP 192.168.0/1.x. Wireshark with filter on UDP port 4919 shows no packets. Therefore the same with recvudp.</p><p>When I keep pressed the reset button, the ying-yang symbol starts to light, stops after some seconds. In general, after boot-process, the router has only the power-led permanently on, nothing else.</p><p>Atm I am lost <img src="https://forum.openwrt.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /></p></blockquote></div><p>seems newer versions of OWRT dont implement btn_trigger failsafe anymore.. too bad..<br />but it can be triggered with TTL serial.. check that too</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p291640">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">lo0p</div>
					<div class="post-datetime">
						13 Sep 2015, 17:16					</div>
				</div>
				<div class="post-content content">
					<p>Afaik the trigger on serial is pressing &quot;f+enter&quot;, tried that without success.</p><p>@Fragment</p><p>Will buy an USB&lt;&gt;UART next week, have the same idea, just to exclude improper cabling (even if it is very simple). In some tutorials about unbricking different TP-Link routers I saw that is necessary to connect 3.3v to rx on the raspberry in combination with a 10kohm resistor.<br />Dunno if this is necessary on the wdr4300 too.</p><p>The first garbage and the following clear output makes me curious. No idea which part of the flash-layout crashed and how to fix.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p291641">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">makarel</div>
					<div class="post-datetime">
						13 Sep 2015, 17:30					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><p>[&nbsp; &nbsp; 5.320000] SQUASHFS error: Unable to read data cache entry [6e]<br />[&nbsp; &nbsp; 5.320000] SQUASHFS error: Unable to read page, block 6e, size 259f4</p></blockquote></div><div class="quotebox"><blockquote><p>[&nbsp; &nbsp; 0.520000] 0x000000000000-0x000000020000 : &quot;u-boot&quot;<br />[&nbsp; &nbsp; 0.520000] 0x000000020000-0x00000012e5fc : &quot;kernel&quot;<br />[&nbsp; &nbsp; 0.540000] 0x00000012e5fc-0x0000007f0000 : &quot;rootfs&quot;<br />[&nbsp; &nbsp; 0.570000] 0x000000350000-0x0000007f0000 : &quot;rootfs_data&quot;<br />[&nbsp; &nbsp; 0.580000] 0x0000007f0000-0x000000800000 : &quot;art&quot;<br />[&nbsp; &nbsp; 0.590000] 0x000000020000-0x0000007f0000 : &quot;firmware&quot;</p></blockquote></div><p>id say its the kernel.. you have to reflash from uboot.. tftp style<br />did you powerloss while you were flashing the device?.. all sections except rootfs_data should be RO</p><div class="quotebox"><blockquote><p>No valid X-�«kÍ́Òn Flash. Using féҼY-¤,�«kÍ5 wasp&nbsp; reset maskͺã°㰳³°��CáWASP&nbsp; - e<br />eth0 up<br />etèјCáAutobooting in 1 secïîäó�ፊ## Booting imaçY¤,*2Ád0000 ...<br />&nbsp; &nbsp;Uncï[.礮Ök֥¹���ernel Image ..® OK</p></blockquote></div><p>that autobooting in 1 sec its your uboot &gt; kernel start mark where it can be interrupted with fast &quot;tpl&quot; i think<br /><a href="http://wiki.openwrt.org/toh/tp-link/tl-wdr4300">http://wiki.openwrt.org/toh/tp-link/tl-wdr4300</a></p>											<p class="post-edited">(Last edited by <strong>makarel</strong> on 13 Sep 2015, 17:37)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p291666">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">lo0p</div>
					<div class="post-datetime">
						13 Sep 2015, 19:17					</div>
				</div>
				<div class="post-content content">
					<p>No, device was in normal/idle status. I was watching TV and *bam* in my whole apartment general power off, seconds later power was up again. That the routers fw was corrupted I noticed 1h later because my tablet had no wlan.</p><p>I can interrupt with tpl as mentioned in the first post. But I do net get any clear output, e.g. printenv brings </p><div class="codebox"><pre><code>db12x&gt; printenv
bootargs=console½ºº^*)�ª����½½Ñõ31:02 rootfstype=squáóèæó Z+�õ_sbin/init mtdpa b
baudrate=1±M&amp;SH¨E¡���Éõ`xba:0xbe:0ø³X&#039;��é`x08:0x41
�.Ö«Ñõçerial�L)�Âáa060000 ${dirý]K¬ë�¹Åin&amp;&amp;erase 0x9f000°���%�V�«5¥é�íÆp.b $fill
stderr=seréXH¨E¡��ÑõÊth0

Enviroîíåîô ®��éA686/65532 bytes</code></pre></div><p>After complete init, w/ clear ouput&nbsp; in the end, I got the message &quot;Please press Ener to activate this console.&quot; but pressing enter results in &quot;SQUASHFS error: Unable to read page, block 6e, s4&quot;.</p><p>In the meantime I have my backup 1043ND up and running but I need the WDR4300s 5Ghz Wlan to have streaming via Wlan running smooth. 2.4Ghz is no option here as it is overpopulated, I have more than 30 SSIDs on 2.4Ghz around here. On 5Ghz I am the only one <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p291671">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">makarel</div>
					<div class="post-datetime">
						13 Sep 2015, 19:32					</div>
				</div>
				<div class="post-content content">
					<p>well regarding trash on screen .. it might be a codepage error.. better wait for TTL adapter though<br />strange that kernel broke being RO partition</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p292107">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">lo0p</div>
					<div class="post-datetime">
						16 Sep 2015, 19:51					</div>
				</div>
				<div class="post-content content">
					<p>Got the USB-UART today. Output is now w/o garbage. Dunno why it was on the raspberry. Going to follow the instructions for failsafe now.</p><p>Attached the clear output of the bootsequence on serial console, maybe there is something inside for insiders <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><div class="codebox"><pre><code>U-Boot 1.1.4 (Sep 16 2014 - 18:23:37)

U-boot DB120


DRAM:  128 MB
id read 0x100000ff
flash size 8MB, sector count = 128
Flash:  8 MB
Using default environment

PCIe Reset OK!!!!!!
In:    serial
Out:   serial
Err:   serial
Net:   ag934x_enet_initialize...
No valid address in Flash. Using fixed address
 wasp  reset mask:c03300
WASP  ----&gt; S17 PHY *
: cfg1 0x7 cfg2 0x7114
eth0: ba:be:fa:ce:08:41
athrs17_reg_init: complete
eth0 up
eth0
Autobooting in 1 seconds
## Booting image at 9f020000 ...
   Uncompressing Kernel Image ... OK

Starting kernel ...

[    0.000000] Linux version 3.10.49 (bb@builder1) (gcc version 4.8.3 (OpenWrt/Linaro GCC 4.8-2014.04 r42625) ) #3 Wed Oct 1 14:00:51 CEST 2014
[    0.000000] bootconsole [early0] enabled
[    0.000000] CPU revision is: 0001974c (MIPS 74Kc)
[    0.000000] SoC: Atheros AR9344 rev 2
[    0.000000] Clocks: CPU:560.000MHz, DDR:450.000MHz, AHB:225.000MHz, Ref:40.000MHz
[    0.000000] Determined physical RAM map:
[    0.000000]  memory: 08000000 @ 00000000 (usable)
[    0.000000] Initrd not found or empty - disabling initrd
[    0.000000] Zone ranges:
[    0.000000]   Normal   [mem 0x00000000-0x07ffffff]
[    0.000000] Movable zone start for each node
[    0.000000] Early memory node ranges
[    0.000000]   node   0: [mem 0x00000000-0x07ffffff]
[    0.000000] Primary instruction cache 64kB, VIPT, 4-way, linesize 32 bytes.
[    0.000000] Primary data cache 32kB, 4-way, VIPT, cache aliases, linesize 32 bytes
[    0.000000] Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 32512
[    0.000000] Kernel command line:  board=TL-WDR4300 console=ttyS0,115200 rootfstype=squashfs,jffs2 noinitrd
[    0.000000] PID hash table entries: 512 (order: -1, 2048 bytes)
[    0.000000] Dentry cache hash table entries: 16384 (order: 4, 65536 bytes)
[    0.000000] Inode-cache hash table entries: 8192 (order: 3, 32768 bytes)
[    0.000000] Writing ErrCtl register=00000000
[    0.000000] Readback ErrCtl register=00000000
[    0.000000] Memory: 126052k/131072k available (2369k kernel code, 5020k reserved, 621k data, 272k init, 0k highmem)
[    0.000000] SLUB: HWalign=32, Order=0-3, MinObjects=0, CPUs=1, Nodes=1
[    0.000000] NR_IRQS:51
[    0.000000] Calibrating delay loop... 278.93 BogoMIPS (lpj=1394688)
[    0.070000] pid_max: default: 32768 minimum: 301
[    0.070000] Mount-cache hash table entries: 512
[    0.080000] NET: Registered protocol family 16
[    0.080000] MIPS: machine is TP-LINK TL-WDR3600/4300/4310
[    0.090000] registering PCI controller with io_map_base unset
[    0.310000] bio: create slab &lt;bio-0&gt; at 0
[    0.310000] PCI host bridge to bus 0000:00
[    0.320000] pci_bus 0000:00: root bus resource [mem 0x10000000-0x13ffffff]
[    0.320000] pci_bus 0000:00: root bus resource [io  0x0000]
[    0.330000] pci_bus 0000:00: No busn resource found for root bus, will use [bus 00-ff]
[    0.330000] pci 0000:00:00.0: invalid calibration data
[    0.340000] pci 0000:00:00.0: BAR 0: assigned [mem 0x10000000-0x1001ffff 64bit]
[    0.340000] pci 0000:00:00.0: BAR 6: assigned [mem 0x10020000-0x1002ffff pref]
[    0.350000] pci 0000:00:00.0: using irq 40 for pin 1
[    0.350000] Switching to clocksource MIPS
[    0.360000] NET: Registered protocol family 2
[    0.360000] TCP established hash table entries: 1024 (order: 1, 8192 bytes)
[    0.360000] TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
[    0.370000] TCP: Hash tables configured (established 1024 bind 1024)
[    0.370000] TCP: reno registered
[    0.380000] UDP hash table entries: 256 (order: 0, 4096 bytes)
[    0.380000] UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
[    0.390000] NET: Registered protocol family 1
[    0.410000] squashfs: version 4.0 (2009/01/31) Phillip Lougher
[    0.410000] jffs2: version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006 Red Hat, Inc.
[    0.420000] msgmni has been set to 246
[    0.430000] io scheduler noop registered
[    0.430000] io scheduler deadline registered (default)
[    0.440000] Serial: 8250/16550 driver, 16 ports, IRQ sharing enabled
[    0.470000] serial8250.0: ttyS0 at MMIO 0x18020000 (irq = 11) is a 16550A
[    0.470000] console [ttyS0] enabled, bootconsole disabled
[    0.470000] console [ttyS0] enabled, bootconsole disabled
[    0.490000] ath79-spi ath79-spi: master is unqueued, this is deprecated
[    0.500000] m25p80 spi0.0: found s25fl064k, expected m25p80
[    0.500000] m25p80 spi0.0: s25fl064k (8192 Kbytes)
[    0.510000] 5 tp-link partitions found on MTD device spi0.0
[    0.510000] Creating 5 MTD partitions on &quot;spi0.0&quot;:
[    0.520000] 0x000000000000-0x000000020000 : &quot;u-boot&quot;
[    0.520000] 0x000000020000-0x00000012e5fc : &quot;kernel&quot;
[    0.530000] mtd: partition &quot;kernel&quot; must either start or end on erase block boundary or be smaller than an erase block -- forcing read-only
[    0.540000] 0x00000012e5fc-0x0000007f0000 : &quot;rootfs&quot;
[    0.550000] mtd: partition &quot;rootfs&quot; must either start or end on erase block boundary or be smaller than an erase block -- forcing read-only
[    0.560000] mtd: device 2 (rootfs) set to be root filesystem
[    0.570000] 1 squashfs-split partitions found on MTD device rootfs
[    0.570000] 0x000000350000-0x0000007f0000 : &quot;rootfs_data&quot;
[    0.580000] 0x0000007f0000-0x000000800000 : &quot;art&quot;
[    0.590000] 0x000000020000-0x0000007f0000 : &quot;firmware&quot;
[    0.620000] switch0: Atheros AR8327 rev. 2 switch registered on ag71xx-mdio.0
[    1.850000] libphy: ag71xx_mdio: probed
[    2.400000] ag71xx ag71xx.0: connected to PHY at ag71xx-mdio.0:00 [uid=004dd033, driver=Atheros AR8216/AR8236/AR8316]
[    2.410000] eth0: Atheros AG71xx at 0xb9000000, irq 4, mode:RGMII
[    2.420000] TCP: cubic registered
[    2.430000] NET: Registered protocol family 17
[    2.430000] Bridge firewalling registered
[    2.430000] 8021q: 802.1Q VLAN Support v1.8
[    2.450000] VFS: Mounted root (squashfs filesystem) readonly on device 31:2.
[    2.450000] Freeing unused kernel memory: 272K (8034c000 - 80390000)
[    2.740000] SQUASHFS error: xz_dec_run error, data probably corrupt
[    2.740000] SQUASHFS error: squashfs_read_data failed to read block 0x6e
[    2.750000] SQUASHFS error: Unable to read data cache entry [6e]
[    2.760000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    2.760000] SQUASHFS error: Unable to read data cache entry [6e]
[    2.770000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    2.780000] SQUASHFS error: Unable to read data cache entry [6e]
[    2.780000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    2.790000] SQUASHFS error: Unable to read data cache entry [6e]
[    2.790000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    2.800000] SQUASHFS error: Unable to read data cache entry [6e]
[    2.810000] SQUASHFS error: Unable to read page, block 6e, size 259f4
procd: Console is alive
procd: - watchdog -
[    4.480000] usbcore: registered new interface driver usbfs
[    4.490000] usbcore: registered new interface driver hub
[    4.500000] usbcore: registered new device driver usb
[    4.500000] ehci_hcd: USB 2.0 &#039;Enhanced&#039; Host Controller (EHCI) Driver
[    4.510000] ehci-platform: EHCI generic platform driver
[    4.520000] ehci-platform ehci-platform: EHCI Host Controller
[    4.520000] ehci-platform ehci-platform: new USB bus registered, assigned bus number 1
[    4.530000] ehci-platform ehci-platform: irq 3, io mem 0x1b000000
[    4.560000] ehci-platform ehci-platform: USB 2.0 started, EHCI 1.00
[    4.560000] hub 1-0:1.0: USB hub found
[    4.570000] hub 1-0:1.0: 1 port detected
procd: - preinit -
[    4.670000] SQUASHFS error: xz_dec_run error, data probably corrupt
[    4.680000] SQUASHFS error: squashfs_read_data failed to read block 0x6e
[    4.680000] SQUASHFS error: Unable to read data cache entry [6e]
[    4.690000] SQUASHFS error: Unable to read page, block 6e, size 259f4
procd: Failed to start preinit
procd: - early -
procd: - watchdog -
[    4.910000] SQUASHFS error: Unable to read data cache entry [6e]
[    4.910000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    4.960000] SQUASHFS error: Unable to read data cache entry [6e]
[    4.960000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    4.980000] SQUASHFS error: Unable to read data cache entry [6e]
[    4.980000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.000000] usb 1-1: new high-speed USB device number 2 using ehci-platform
[    5.000000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.010000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.020000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.020000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.030000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.040000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.050000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.050000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.060000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.070000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.080000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.080000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.090000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.100000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.100000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.110000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.120000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.120000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.130000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.140000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.150000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.150000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.160000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.170000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.180000] hub 1-1:1.0: USB hub found
[    5.180000] hub 1-1:1.0: 4 ports detected
[    5.190000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.190000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.200000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.210000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.220000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.220000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.230000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.240000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.250000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.250000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.260000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.270000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.280000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.280000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.290000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.300000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.300000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.310000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.320000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.320000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.330000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.340000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.350000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.350000] SQUASHFS error: Unable to read page, block 6e, size 259f4
procd: - ubus -
procd: - init -
[    5.680000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.690000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.700000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.710000] SQUASHFS error: Unable to read page, block 6e, size 259f4
Please press Ent[    5.830000] SQUASHFS error: Unable to read data cache entry [6e]
er to activate t[    5.840000] SQUASHFS error: Unable to read page, block 6e, size 259f4
his console.
[    5.850000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.860000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.860000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.870000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.880000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.890000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.890000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.900000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.910000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.910000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.920000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.930000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.940000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.940000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.950000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.960000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.970000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.970000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    5.980000] SQUASHFS error: Unable to read data cache entry [6e]
[    5.990000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    6.000000] SQUASHFS error: Unable to read data cache entry [6e]
[    6.000000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    6.010000] SQUASHFS error: Unable to read data cache entry [6e]
[    6.020000] SQUASHFS error: Unable to read page, block 6e, size 259f4
[    6.030000] SQUASHFS error: Unable to read data cache entry [6e]
[    6.030000] SQUASHFS error: Unable to read page, block 6e, size 259f4
procd: - init complete -</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p292110">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">lo0p</div>
					<div class="post-datetime">
						16 Sep 2015, 20:16					</div>
				</div>
				<div class="post-content content">
					<p>Weehooh... my WDR4300 is up and running again <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> Flashing the new image was done within minutes.</p><p>Thanks for all your assistance!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p292395">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">moxu</div>
					<div class="post-datetime">
						18 Sep 2015, 16:51					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>lo0p wrote:</cite><blockquote><p>Weehooh... my WDR4300 is up and running again <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> Flashing the new image was done within minutes.</p><p>Thanks for all your assistance!</p></blockquote></div><p>Congrats!!! I also bricked my wdr4300 2 days ago... it was probably the most difficult devop problem I&#039;ve ever tried fixing. No USB-UART was used, just network ip&#039;s, and it may not have been as severe the issue in this thread. But the wiki doc&#039;s didn&#039;t help me much, so I&#039;d like to share how I fixed it.</p><p>PROBLEM:</p><p>unable to connect to router ip, no wifi / wan / lan - basically unresponsive, but the lights showed connections to ethernet ports and the star light was blinking</p><p>SOLUTION</p><p>Hit the wps button many times really fast after the lights go on / off after holding wps when powered up<br />The star should blink double as fast as normal rapidly (it was blinking already but the speed increased 2x)<br />That should indicate it&#039;s in failsafe mode <br />I tried setting up my static IP as suggested in the wiki (192.168.0.66) - didn&#039;t work<br />used a netscan and experimented with different configurations<br />I eventually discovered that 192.168.1.2 (local) 255.255.255.0 192.168.1.1 (router) worked<br />I was able to ping the router at 192.168.1.1 - telnet in - but no wan<br />So I changed the network setting - at this point I followed the wiki directions<br />After reboot I regained access to ssh / web gui<br />Re-flashed - all good</p><p>CONCLUSION</p><p>Don&#039;t brick your router, it sucks</p>											<p class="post-edited">(Last edited by <strong>moxu</strong> on 18 Sep 2015, 17:01)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>