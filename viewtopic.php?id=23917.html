<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> WRT160NL and a serial moden</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 6 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p104737">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">kheston</div>
					<div class="post-datetime">
						16 Mar 2010, 20:21					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve read a number of posts that describe using a WRT160NL with USB storage but nothing so far about plugging in other devices.&nbsp; I&#039;d like to use (share) a serial (DB9) modem (1x cellular) with my 160 but I&#039;m pretty sure I&#039;d be the first to try it and am wondering where to start.&nbsp; </p><p>I have a number of USB to Serial adapters to choose from by I haven&#039;t found a post regarding loading the driver into Kamikaze for one yet.</p><p>Suggestions?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p104754">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">staylo</div>
					<div class="post-datetime">
						16 Mar 2010, 23:09					</div>
				</div>
				<div class="post-content content">
					<p>Hi kheston,</p><p>It&#039;s usually just a matter of installing the correct kmod-usb-serial packages for your USB-serial chipset (for example, kmod-usb-serial-ftdi for FTDI-based chipsets). The device should then appear as /dev/ttyUSB0 .</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p107766">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">kheston</div>
					<div class="post-datetime">
						24 Apr 2010, 18:11					</div>
				</div>
				<div class="post-content content">
					<p>I finally got around to trying this.&nbsp; I&#039;ve loaded the ftdi module, but it can&#039;t see my usb-to-serial converter.&nbsp; Nothing is listed when I look in /proc/bus/usb and I don&#039;t get any errors in dmesg either.</p><p>Any idea what I&#039;ve missed?</p><p>Here are the modules I&#039;ve loaded:</p><div class="codebox"><pre><code>root@OpenWrt:~# opkg list | grep kmod
kmod-ath - 2.6.32.9+2010-02-16-3
kmod-ath9k - 2.6.32.9+2010-02-16-3
kmod-button-hotplug - 2.6.32.9-1
kmod-crc-ccitt - 2.6.32.9-1
kmod-crypto-aes - 2.6.32.9-1
kmod-crypto-arc4 - 2.6.32.9-1
kmod-crypto-core - 2.6.32.9-1
kmod-input-core - 2.6.32.9-1
kmod-input-gpio-buttons - 2.6.32.9-1
kmod-input-polldev - 2.6.32.9-1
kmod-ipt-conntrack - 2.6.32.9-1
kmod-ipt-core - 2.6.32.9-1
kmod-ipt-nat - 2.6.32.9-1
kmod-ipt-nathelper - 2.6.32.9-1
kmod-leds-gpio - 2.6.32.9-1
kmod-mac80211 - 2.6.32.9+2010-02-16-3
kmod-nls-base - 2.6.32.9-1
kmod-ppp - 2.6.32.9-1
kmod-pppoe - 2.6.32.9-1
kmod-usb-core - 2.6.32.9-1
kmod-usb-ohci - 2.6.32.9-1
kmod-usb-serial - 2.6.32.9-1
kmod-usb-serial-ftdi - 2.6.32.9-1
root@OpenWrt:~#</code></pre></div>											<p class="post-edited">(Last edited by <strong>kheston</strong> on 24 Apr 2010, 18:12)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p107774">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">kheston</div>
					<div class="post-datetime">
						24 Apr 2010, 19:30					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve figured out that I have a prolific 2303-based device and have loaded the appropriate packages.&nbsp; I&#039;ve also loaded usbutils.&nbsp; It looks like the driver is loading, but the device doesn&#039;t show up.&nbsp; Am I supposed to change the hotplug scripts?</p><p>Here&#039;s my dmesg tail:</p><div class="codebox"><pre><code>ohci_hcd: USB 1.1 &#039;Open&#039; Host Controller (OHCI) Driver
usbcore: registered new interface driver usbserial
USB Serial support registered for generic
usbcore: registered new interface driver usbserial_generic
usbserial: USB Serial Driver core
USB Serial support registered for FTDI USB Serial Device
usbcore: registered new interface driver ftdi_sio
ftdi_sio: v1.5.0:USB FTDI Serial Converters Driver
USB Serial support registered for pl2303
usbcore: registered new interface driver pl2303
pl2303: Prolific PL2303 USB to serial adaptor driver
ar71xx-wdt: enabling watchdog timer</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p107781">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">staylo</div>
					<div class="post-datetime">
						24 Apr 2010, 22:00					</div>
				</div>
				<div class="post-content content">
					<p>Since you&#039;ve installed the usbutils package, use the &#039;lsusb&#039; tool.</p><p>From the output you should have ID followed by two sets of 4-digit hexadecimal values, these are the vendor and product IDs of your adapter.</p><p>Edit /etc/modules.d/usb-serial-pl2303 (may be named differently, but should have 2303 in it at least) and add &#039;vendor=0xYYYY product=0xZZZZ&#039; to the end of the first line (where YYYY and ZZZZ are the vendor and product IDs of your device respectively). Reboot and see if that has an effect.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p107796">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">vincentfox</div>
					<div class="post-datetime">
						25 Apr 2010, 05:15					</div>
				</div>
				<div class="post-content content">
					<p>WAY way back in 2006 I hooked up my phone to WRTSL54GS with USB, maybe it&#039;ll help.&nbsp; With all the Wiki reorgs hard to locate, but it&#039;s here:</p><p><a href="http://nuwiki.openwrt.org/oldwiki/MobileAPHowTo2">http://nuwiki.openwrt.org/oldwiki/MobileAPHowTo2</a></p>											<p class="post-edited">(Last edited by <strong>vincentfox</strong> on 25 Apr 2010, 08:07)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p107903">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">kheston</div>
					<div class="post-datetime">
						26 Apr 2010, 06:14					</div>
				</div>
				<div class="post-content content">
					<p>staylo,</p><p>lsusb is supposed to dump hex values to stdout, no?&nbsp; Nothing is output.&nbsp; Shouldn&#039;t I see at least an error?</p><p>vincent,</p><p>looking at your URL now...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p107967">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">kheston</div>
					<div class="post-datetime">
						27 Apr 2010, 00:10					</div>
				</div>
				<div class="post-content content">
					<p>It&#039;s as though the usb2serial device isn&#039;t plugged in:<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# cat /etc/modules.d/*-usb-serial ; lsusb
usbserial
root@OpenWrt:~#</code></pre></div><p>Are there any other places to look for the HW hex values?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p108052">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">kheston</div>
					<div class="post-datetime">
						28 Apr 2010, 02:24					</div>
				</div>
				<div class="post-content content">
					<p>I was missing the usb2 and uhci modules.&nbsp; Got it working!</p><p>----------------------------------<br />root@OpenWrt:~# dmesg | tail<br />....<br />usb 1-1: new full speed USB device using ar71xx-ehci and address 2<br />usb 1-1: configuration #1 chosen from 1 choice<br />pl2303 1-1:1.0: pl2303 converter detected<br />usb 1-1: pl2303 converter now attached to ttyUSB0<br />----------------------------------<br />root@OpenWrt:~# lsusb<br />Bus 001 Device 002: ID 067b:2303 Prolific Technology, Inc. PL2303 Serial Port<br />Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub<br />root@OpenWrt:~#<br />----------------------------------</p><p>Here&#039;s everything I&#039;ve loaded:</p><p>(10.03-beta)</p><p>openwrt-ar71xx-wrt160nl-squashfs.bin </p><p>iw_0.9.19-1_ar71xx.ipk<br />kmod-ath9k_2.6.32.9+2010-02-16-3_ar71xx.ipk<br />kmod-ath_2.6.32.9+2010-02-16-3_ar71xx.ipk<br />kmod-crypto-aes_2.6.32.9-1_ar71xx.ipk<br />kmod-crypto-arc4_2.6.32.9-1_ar71xx.ipk<br />kmod-crypto-core_2.6.32.9-1_ar71xx.ipk<br />kmod-mac80211_2.6.32.9+2010-02-16-3_ar71xx.ipk<br />kmod-nls-base_2.6.32.9-1_ar71xx.ipk<br />kmod-usb-core_2.6.32.9-1_ar71xx.ipk<br />kmod-usb-ohci_2.6.32.9-1_ar71xx.ipk<br />kmod-usb-serial-ftdi_2.6.32.9-1_ar71xx.ipk<br />kmod-usb-serial-pl2303_2.6.32.9-1_ar71xx.ipk<br />kmod-usb-serial_2.6.32.9-1_ar71xx.ipk<br />kmod-usb-uhci_2.6.32.9-1_ar71xx.ipk<br />kmod-usb2_2.6.32.9-1_ar71xx.ipk<br />libusb_0.1.12-2_ar71xx.ipk<br />usbutils_0.86-1_ar71xx.ipk<br />wireless-tools_29-4_ar71xx.ipk<br />zlib_1.2.3-5_ar71xx.ipk<br />---------------------------------------------------</p><p>Modem is responding to AT commands.&nbsp; Now to figure out how to connect to an ISP...</p>											<p class="post-edited">(Last edited by <strong>kheston</strong> on 28 Apr 2010, 03:46)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p108056">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">vincentfox</div>
					<div class="post-datetime">
						28 Apr 2010, 05:07					</div>
				</div>
				<div class="post-content content">
					<p>Yeah you have to load either OHCI or UCHI depending on your device.&nbsp; Was my old Wiki page of any use?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p108062">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">kheston</div>
					<div class="post-datetime">
						28 Apr 2010, 08:04					</div>
				</div>
				<div class="post-content content">
					<p>Yes, very helpful.&nbsp; Gave me lots of clues.</p><p>I&#039;m getting an authentication error from AT&amp;T (see below), but here&#039;s what I&#039;ve got that&#039;s working (all but the successful log in part):</p><p>/etc/ppp/options<br /></p><div class="codebox"><pre><code>lock
usepeerdns
defaultroute
noipdefault
#noauth
asyncmap 0
crtscts
modem
57600</code></pre></div><p>/etc/ppp/peers/chat-test<br /></p><div class="codebox"><pre><code>&quot;&quot; &quot;ATZ&quot;

# The next two lines should be left commented out until
# the script works.

# &quot;OK&quot; &quot;ATL0&quot;
# &quot;OK&quot; &quot;ATM0&quot;

SAY &quot;Dialing modem...\n&quot;
&quot;OK&quot; &quot;ATDT \T&quot;
ABORT BUSY
ABORT &quot;NO CARRIER&quot;
TIMEOUT 60
CONNECT \c</code></pre></div><p>/etc/ppp/chap-secrets<br /></p><div class="codebox"><pre><code>#USERNAME  PROVIDER  PASSWORD  IPADDRESS
username@pacbell.net    *       &quot;somepassword&quot;        *</code></pre></div><p>The script that attempts to log me in:<br /></p><div class="codebox"><pre><code>pppd /dev/ttyUSB0 connect &#039;/usr/sbin/chat -v -T5551234 -f/etc/ppp/peers/chat-test&#039; updetach debug name username@pacbell.net</code></pre></div><p>The (obfuscated) error:<br /></p><div class="codebox"><pre><code>sent [LCP ConfAck id=0x2 &lt;mru 1514&gt; &lt;asyncmap 0x0&gt; &lt;auth chap MD5&gt; &lt;magic 0x00000000&gt; &lt;pcomp&gt; &lt;accomp&gt;]
rcvd [CHAP Challenge id=0x3 &lt;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&gt;, name = &quot;HiPer.att.net&quot;]
sent [CHAP Response id=0x3 &lt;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&gt;, name = &quot;username@pacbell.net&quot;]
rcvd [CHAP Failure id=0x3 &quot;&quot;]
CHAP authentication failed
CHAP authentication failed
sent [LCP TermReq id=0x2 &quot;Failed to authenticate ourselves to peer&quot;]
rcvd [LCP TermReq id=0x4]
sent [LCP TermAck id=0x4]
sent [LCP TermReq id=0x3 &quot;Failed to authenticate ourselves to peer&quot;]
rcvd [LCP TermReq id=0x3 &quot;Failed to authenticate ourselves to peer&quot;]
sent [LCP TermAck id=0x3]
rcvd [LCP TermAck id=0x3]
Connection terminated.</code></pre></div><p>NOTE: I had to use a null-modem cable to get my usb2serial device to talk with my US Robotics modem.</p>											<p class="post-edited">(Last edited by <strong>kheston</strong> on 28 Apr 2010, 20:17)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110149">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">kheston</div>
					<div class="post-datetime">
						29 May 2010, 20:24					</div>
				</div>
				<div class="post-content content">
					<p>Worked some more on this.&nbsp; I appear to be making a connection to the dial-up server, but I can&#039;t get packets to route through it yet.&nbsp; Keeping at it...</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>