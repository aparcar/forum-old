<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> RSS downloader</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 29 Mar 2018 and 4 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 4 of 4</div><nav><ul><li><a href="viewtopic.php%3Fid=31294&amp;p=1.html">1</a></li><li><a href="viewtopic.php%3Fid=31294&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=31294&amp;p=3.html">3</a></li><li class="pagination-current"><span>4</span></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p285157">
				<div class="post-metadata">
					<div class="post-num">Post #76</div>
					<div class="post-author">stangri</div>
					<div class="post-datetime">
						27 Jul 2015, 19:09					</div>
				</div>
				<div class="post-content content">
					<p>you need to use leech-defmission recipe.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p285442">
				<div class="post-metadata">
					<div class="post-num">Post #77</div>
					<div class="post-author">Udavf</div>
					<div class="post-datetime">
						29 Jul 2015, 12:30					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>stangri wrote:</cite><blockquote><p>you need to use leech-defmission recipe.</p></blockquote></div><p>doesnt work neither</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p285570">
				<div class="post-metadata">
					<div class="post-num">Post #78</div>
					<div class="post-author">stangri</div>
					<div class="post-datetime">
						30 Jul 2015, 06:22					</div>
				</div>
				<div class="post-content content">
					<p>transmission recipe? have you configured either defmission or transmission recipe?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p285598">
				<div class="post-metadata">
					<div class="post-num">Post #79</div>
					<div class="post-author">Udavf</div>
					<div class="post-datetime">
						30 Jul 2015, 11:33					</div>
				</div>
				<div class="post-content content">
					<p>tried both and default recipe.<br />as i understand default recipe must just download file to directory, without adding it to transmission, but it doesnt do it</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p307957">
				<div class="post-metadata">
					<div class="post-num">Post #80</div>
					<div class="post-author">aleksey_t</div>
					<div class="post-datetime">
						17 Jan 2016, 12:23					</div>
				</div>
				<div class="post-content content">
					<p>leech 1.5-2 is out. It&#039;s a bugfix release mostly focused on leech for Ubuntu (and probably Debian), it fixes $HISTORY feature on those platforms. $HISTORY on OpenWRT wasn&#039;t affected. It also fixes leech-match-test for all platforms including OpenWRT, but if you&#039;re not concerned with that issue then update is not necessary.</p><p>Changelog:</p><div class="codebox"><pre><code>1.5-2

[*] fixed RFC822 timestamp parsing issue on Ubuntu (and apparently Debian)
[*] fixed similar issue (grep options) in leech-defmission recipe
[*] fixed issue in leech-match-test when sometimes it wasn&#039;t reporting file
    as matched pattern(s) when it did (if filename had multiple whitespaces
    in it)</code></pre></div><p>Downloads: <a href="https://bitbucket.org/alekseyt/leech/downloads">https://bitbucket.org/alekseyt/leech/downloads</a></p>											<p class="post-edited">(Last edited by <strong>aleksey_t</strong> on 17 Jan 2016, 12:29)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p307958">
				<div class="post-metadata">
					<div class="post-num">Post #81</div>
					<div class="post-author">aleksey_t</div>
					<div class="post-datetime">
						17 Jan 2016, 12:28					</div>
				</div>
				<div class="post-content content">
					<p>@Udavf<br />Sorry for the late reply, for some reason i didn&#039;t get notifications about replies in this thread...</p><p>If it doesn&#039;t show any errors and still download anything, then i would say download filters in CONFIG_DIR/wild-downloads and CONFIG_DIR/downloads are not set correctly.</p><p>Simple way to check this is to set .* (dot asterisk) filter in CONFIG_DIR/downloads - that should download everything. If it still doesn&#039;t, then normally i&#039;m asking for entire content of CONFIG_DIR preferably emailed to me to check what might be wrong.</p><p>As a side note, you can always email me directly (email on BitBucket page).</p>											<p class="post-edited">(Last edited by <strong>aleksey_t</strong> on 17 Jan 2016, 12:30)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p319333">
				<div class="post-metadata">
					<div class="post-num">Post #82</div>
					<div class="post-author">discrucio</div>
					<div class="post-datetime">
						12 Apr 2016, 18:09					</div>
				</div>
				<div class="post-content content">
					<p>@aleksey_t<br />Thanks for the updates! I noticed that if $COOKIE is not set, the &#039;-b&#039; flag is immediately followed by $FOOD, leading to the following error:<br />Downloading feed: http://..../ Failed: 4</p><p>Is it possible to make the &#039;-b&#039; flag optional until $COOKIE is found?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p319581">
				<div class="post-metadata">
					<div class="post-num">Post #83</div>
					<div class="post-author">aleksey_t</div>
					<div class="post-datetime">
						14 Apr 2016, 08:36					</div>
				</div>
				<div class="post-content content">
					<p>@discrucio<br />Thank you for pointing that out. I wasn&#039;t able to reproduce this issue, but making -b optional is probably the correct approach anyway. I&#039;ll get to it shortly.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p320164">
				<div class="post-metadata">
					<div class="post-num">Post #84</div>
					<div class="post-author">stangri</div>
					<div class="post-datetime">
						18 Apr 2016, 06:08					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>discrucio wrote:</cite><blockquote><p>@aleksey_t</p><p>Many thanks for the great script. I would like to share my recipe for <a href="http://aria2.sourceforge.net/">aria2</a>. Uses aria2&#039;s JSON-RPC interface. Tested with leech 1.2-1 entware package on OpenWRT BB.</p><div class="codebox"><pre><code>ARIA2_SERVER=&quot;http://&quot;$HOST_PORT&quot;/jsonrpc&quot;

ARIA2_PARAM=&#039;{&quot;id&quot;:null,&quot;jsonrpc2&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;aria2.addUri&quot;,&quot;params&quot;:[&quot;token:&#039;&quot;$RPC_SECRET&quot;&#039;&quot;,[&quot;&#039;$LEECH_URL&#039;&quot;]]}&#039;

exec curl -X POST \
-H &#039;Content-Type: application/json&#039; -H &#039;Accept: application/json&#039; \
-d $ARIA2_PARAM $ARIA2_SERVER</code></pre></div></blockquote></div><br /><p>I&#039;m struggling to add an option of&nbsp; $DOWNLOADS_DIR to the rpc call to aria2. Can anyone help me please? I&#039;m not sure if that&#039;s bash or json or something but I&#039;ve tried this:<br /></p><div class="codebox"><pre><code>ARIA2_PARAM=&#039;{&quot;id&quot;:null,&quot;jsonrpc2&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;aria2.addUri&quot;,&quot;params&quot;:[&quot;token:&#039;&quot;$RPC_SECRET&quot;&#039;&quot;,[&quot;&#039;$LEECH_URL&#039;&quot;],[&quot;dir:&#039;&quot;$DOWNLOADS_DIR&quot;&#039;&quot;]]}&#039;</code></pre></div><p>and it didn&#039;t work, here&#039;s what I&#039;ve got in the log:<br /></p><div class="codebox"><pre><code>2016-04-17 20:06:48.419203 [INFO] [rpc_helper.cc:103] Executing RPC method aria2.addUri
2016-04-17 20:06:48.419459 [DEBUG] [RpcMethod.cc:101] Exception caught
Exception: [RpcMethodImpl.h:68] errorCode=1 The parameter at 1 has wrong type.
2016-04-17 20:06:48.419505 [DEBUG] [HttpServer.cc:296] HTTP Server sends response:
HTTP/1.1 400 Bad Request</code></pre></div><p>I&#039;ve tried to read up on arrays and structures in json but couldn&#039;t figure out what&#039;s wrong with my request.</p>											<p class="post-edited">(Last edited by <strong>stangri</strong> on 18 Apr 2016, 06:09)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p320173">
				<div class="post-metadata">
					<div class="post-num">Post #85</div>
					<div class="post-author">aleksey_t</div>
					<div class="post-datetime">
						18 Apr 2016, 07:50					</div>
				</div>
				<div class="post-content content">
					<p>@discrucio<br />I&#039;ve made changes in 33fccd9 (<a href="https://bitbucket.org/alekseyt/leech/commits/33fccd9d584387f208bba4a04d4f97c262e68dce">https://bitbucket.org/alekseyt/leech/co … c262e68dce</a>), leech won&#039;t set -b option unless $COOKIE is set. Hopefully those changes would resolve your difficulty with cookies. I would appreciate if you tell me if it does, if it doesn&#039;t i can look into this issue further.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p320178">
				<div class="post-metadata">
					<div class="post-num">Post #86</div>
					<div class="post-author">discrucio</div>
					<div class="post-datetime">
						18 Apr 2016, 09:46					</div>
				</div>
				<div class="post-content content">
					<p>@aleksey_t<br />Works great, thanks!</p><p>@stangri<br />Try:<br /></p><div class="codebox"><pre><code>ARIA2_PARAM=&#039;{&quot;id&quot;:null,&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;aria2.addUri&quot;,&quot;params&quot;:[&quot;token:&#039;&quot;$RPC_SECRET&quot;&#039;&quot;,[&quot;&#039;$LEECH_URL&#039;&quot;],{&quot;dir&quot;:&quot;&#039;$LEECH_DOWNLOADS_DIR&#039;&quot;}]}&#039;</code></pre></div><p>I will do some more tests and submit a PR if it works</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p320257">
				<div class="post-metadata">
					<div class="post-num">Post #87</div>
					<div class="post-author">stangri</div>
					<div class="post-datetime">
						18 Apr 2016, 20:04					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>discrucio wrote:</cite><blockquote><p>@aleksey_t<br />Works great, thanks!</p><p>@stangri<br />Try:<br /></p><div class="codebox"><pre><code>ARIA2_PARAM=&#039;{&quot;id&quot;:null,&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;aria2.addUri&quot;,&quot;params&quot;:[&quot;token:&#039;&quot;$RPC_SECRET&quot;&#039;&quot;,[&quot;&#039;$LEECH_URL&#039;&quot;],{&quot;dir&quot;:&quot;&#039;$LEECH_DOWNLOADS_DIR&#039;&quot;}]}&#039;</code></pre></div><p>I will do some more tests and submit a PR if it works</p></blockquote></div><p>Well, I set DOWNLOADS_DIR and not LEECH_DOWNLOADS_DIR, but other than that the line above works! Thank you so much, you wouldn&#039;t believe how much time I spent trying to get the syntax right on this one! <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p320278">
				<div class="post-metadata">
					<div class="post-num">Post #88</div>
					<div class="post-author">aleksey_t</div>
					<div class="post-datetime">
						18 Apr 2016, 22:53					</div>
				</div>
				<div class="post-content content">
					<p>@discrucio<br />Note that lately were was TARGET_DIR implemented for leech-transmission recipe. The idea behind this variable is that <strong>Transmission</strong> downloads dir could be overridden with variable set in environment, like TARGET_DIR=/my/dir CONFIG_DIR=/etc/leech /usr/sbin/leech and this would override any downloads dir configured in <strong>Transmission</strong>.</p><p>The point is that files downloaded by leech are not the same files that downloaded by Transmission and destination directories could be different.</p><p>I don&#039;t know if aria2 has own downloads directory for files and if it would overlap with leech&#039;s downloads dir, and if that matters at all. I can take whatever changes you&#039;re happy with, just wanted to point that out, maybe you would find this idea appealing for aria2 recipe.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p329189">
				<div class="post-metadata">
					<div class="post-num">Post #89</div>
					<div class="post-author">aleksey_t</div>
					<div class="post-datetime">
						20 Jun 2016, 19:59					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m glad to announce that leech 1.6 is out. Many thanks to stangri and discrucio.</p><p>Changelog:<br /></p><div class="codebox"><pre><code>1.6

[+] leech now support TARGET_DIR option in leech-transmission and leech-aria2
    recipes to explicitely set downloads dir in external downloader software
    (Transmission and aria2 respectively) (by stangri, /pull-request/3/)
[+] leech will pass LEECH_TARGET_DIR to each invoked recipe (for recipes that
    could use this option)

[*] fixed issue when leech was setting empty -b option to cURL when $COOKIE
    wasn&#039;t set in environment</code></pre></div>											<p class="post-edited">(Last edited by <strong>aleksey_t</strong> on 21 Jun 2016, 14:24)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p329265">
				<div class="post-metadata">
					<div class="post-num">Post #90</div>
					<div class="post-author">stangri</div>
					<div class="post-datetime">
						21 Jun 2016, 10:34					</div>
				</div>
				<div class="post-content content">
					<p>Credit should go to discrucio for providing the proper json syntax for aria2. <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p353063">
				<div class="post-metadata">
					<div class="post-num">Post #91</div>
					<div class="post-author">discrucio</div>
					<div class="post-datetime">
						27 Feb 2017, 15:33					</div>
				</div>
				<div class="post-content content">
					<p>@aleksey_t</p><p>I tried installing the latest package in LEDE snapshot r3582 and got the following error:<br /></p><div class="codebox"><pre><code>Collected errors:
 * pkg_init_from_file: Malformed package file leech_1.6-1_all.ipk.</code></pre></div><p>I wrote a quick Makefile to re-package your scripts using LEDE buildroot and the ipk installed successfully.</p><p>If you permit it, I will submit a PR to the Packages repository in Github.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p353396">
				<div class="post-metadata">
					<div class="post-num">Post #92</div>
					<div class="post-author">aleksey_t</div>
					<div class="post-datetime">
						3 Mar 2017, 00:23					</div>
				</div>
				<div class="post-content content">
					<p>@discrucio<br />[Disregard edited out text]. I&#039;ve got what you want to do. You can do whatever, it&#039;s a free software.</p>											<p class="post-edited">(Last edited by <strong>aleksey_t</strong> on 3 Mar 2017, 00:32)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p364848">
				<div class="post-metadata">
					<div class="post-num">Post #93</div>
					<div class="post-author">frunzie</div>
					<div class="post-datetime">
						3 Sep 2017, 14:37					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>discrucio wrote:</cite><blockquote><p>@aleksey_t</p><p>I tried installing the latest package in LEDE snapshot r3582 and got the following error:<br /></p><div class="codebox"><pre><code>Collected errors:
 * pkg_init_from_file: Malformed package file leech_1.6-1_all.ipk.</code></pre></div><p>I wrote a quick Makefile to re-package your scripts using LEDE buildroot and the ipk installed successfully.</p><p>If you permit it, I will submit a PR to the Packages repository in Github.</p></blockquote></div><p>Hi</p><p>Can You share re-package because got problem with install ipk on LEDE....</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p370540">
				<div class="post-metadata">
					<div class="post-num">Post #94</div>
					<div class="post-author">discrucio</div>
					<div class="post-datetime">
						6 Jan 2018, 16:01					</div>
				</div>
				<div class="post-content content">
					<p>@frunzie</p><p>Hi there, I didn&#039;t submit the PR because the contribution guidelines require a package license (I couldn&#039;t find any in aleksey_t&#039;s repo). Here&#039;s the makefile I used:</p><div class="codebox"><pre><code>#
# Copyright (C) 2004-2018 OpenWrt.org
#
# This is free software, licensed under the GNU General Public License v2.
# See /LICENSE for more information.
#

include $(TOPDIR)/rules.mk

PKG_NAME:=leech
PKG_VERSION:=1.6-2
PKG_RELEASE:=1

PKG_SOURCE_PROTO:=git
PKG_SOURCE_URL:=https://bitbucket.org/alekseyt/leech.git
PKG_SOURCE_VERSION:=749cd75f242024a9d39d7671e95d7b40e2f35e99
PKG_MIRROR_HASH:=b89c5d0846cf9d0e8736754e47a50538a80a7876886ad0737c1a30d7960f3e76

PKG_INSTALL:=1

include $(INCLUDE_DIR)/package.mk

define Package/leech
    SECTION:=net
    CATEGORY:=Network
    SUBMENU:=Download Manager
    TITLE:=RSS-feeds parser/files downloader
    URL:=https://bitbucket.org/alekseyt/leech/
    DEPENDS:=+xsltproc +curl
endef

define Package/leech/description
    leech downloads files for you if you give it RSS-feeds of your favorite trackers.
endef

define Build/Compile
endef

define Build/Install
endef

define Package/leech/install
    $(INSTALL_DIR) $(1)/usr/sbin
    $(INSTALL_BIN) $(PKG_BUILD_DIR)/sbin/* $(1)/usr/sbin

    $(INSTALL_DIR) $(1)/etc/leech
    $(INSTALL_CONF) $(PKG_BUILD_DIR)/config/* $(1)/etc/leech

    $(INSTALL_DIR) $(1)/usr/share/leech
    $(INSTALL_DATA) $(PKG_BUILD_DIR)/share/leech/* $(1)/usr/share/leech
endef

define Package/leech/conffiles
/etc/leech/default
/etc/leech/downloads
/etc/leech/foods
/etc/leech/wild-downloads
/etc/leech/reverse-downloads
endef

$(eval $(call BuildPackage,leech))</code></pre></div>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 4 of 4</div><nav><ul><li><a href="viewtopic.php%3Fid=31294&amp;p=1.html">1</a></li><li><a href="viewtopic.php%3Fid=31294&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=31294&amp;p=3.html">3</a></li><li class="pagination-current"><span>4</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>