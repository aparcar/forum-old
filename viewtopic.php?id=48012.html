<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> TL-WR703N problem creating extroot</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 26 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p220877">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Ektus</div>
					<div class="post-datetime">
						25 Dec 2013, 18:29					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve got the &quot;standard&quot; package from <a href="http://www.madox.net/blog/projects/tp-link-tl-wr703n/">madox</a> installed on my TL-WR703N, which comes with USB support. In order to get USBIP working I need more space and a small USB hub is attached anyway. So I tried configuring extroot on an attached thumb drive following the steps found on <a href="http://en.code-bude.net/2013/02/16/how-to-increase-storage-on-tp-link-wr703n-with-extroot/">en-code.net</a>, but all I get is this:<br /></p><div class="codebox"><pre><code>login as: root
root@192.168.0.36&#039;s password:


BusyBox v1.19.4 (2013-02-21 15:00:55 EST) built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 -----------------------------------------------------
 BARRIER BREAKER (35706_2013-02-23, r35706)
 -----------------------------------------------------
  * 1/2 oz Galliano         Pour all ingredients into
  * 4 oz cold Coffee        an irish coffee mug filled
  * 1 1/2 oz Dark Rum       with crushed ice. Stir.
  * 2 tsp. Creme de Cacao
 -----------------------------------------------------
root@OpenWrt:~# df
Filesystem           1K-blocks      Used Available Use% Mounted on
rootfs                     320       228        92  71% /
/dev/root                 2816      2816         0 100% /rom
tmpfs                    14672       368     14304   3% /tmp
tmpfs                      512         0       512   0% /dev
/dev/mtdblock3             320       228        92  71% /overlay
/dev/sda1              3628936     88536   3356056   3% /tmp/whole_root-disabled
overlayfs:/overlay         320       228        92  71% /
root@OpenWrt:~#</code></pre></div><p>Searching the forum for the &quot;root-disabled&quot; message did yield only two threads and no solutions. </p><div class="codebox"><pre><code>root@OpenWrt:~# vi /etc/fstab
/dev/sda1       /       ext4    rw,sync 0       0
~</code></pre></div><p>Ahem. /etc/fstab is almost empty. That&#039;s just the mount line, and it is mounted there, and the fstab on the usb stick is the same. It wasn&#039;t empty when I altered the entry, and I&#039;m not sure if I did format it with EXT2 or EXT4.</p><p>Any hints? How should it look, if it&#039;s the problem? The <a href="http://wiki.openwrt.org/doc/howto/extroot">OpenWRT extroot wiki</a> is very extensive, but so much so that I can&#039;t locate the correct information <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>Regards<br />Ektus.</p><p>P.S.: Older topics:<br /><a href="https://forum.openwrt.org/viewtopic.php?id=44512">Extroot not working with TL-WDR4300 (Attitude Adjustment 12.09)</a><br /><a href="https://forum.openwrt.org/viewtopic.php?id=39951">How to mount fileFS.img from USB disk to rootfs?</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p220891">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						25 Dec 2013, 23:33					</div>
				</div>
				<div class="post-content content">
					<p>full log of what you did and all command output could be useful.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p220897">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">makarel</div>
					<div class="post-datetime">
						26 Dec 2013, 01:33					</div>
				</div>
				<div class="post-content content">
					<p>first post here is prety complete of what you have to do<br /><a href="https://forum.openwrt.org/viewtopic.php?id=24138">https://forum.openwrt.org/viewtopic.php?id=24138</a><br /><a href="http://wiki.openwrt.org/doc/howto/extroot">http://wiki.openwrt.org/doc/howto/extroot</a></p><p>here seems you can hack 2 more usb ports:)<br /><a href="http://wiki.openwrt.org/toh/tp-link/tl-wdr4300">http://wiki.openwrt.org/toh/tp-link/tl-wdr4300</a></p><p>or if you want this thread<br /><a href="http://blog.philippklaus.de/2011/04/openwrt-on-a-tp-link-tl-wr1043nd-gigabit-router/">http://blog.philippklaus.de/2011/04/ope â€¦ it-router/</a></p><p>all of them describe pretty much same procedure</p><p>hf</p><p>ps: in your guide.. the guy there forgot the &quot;option is_rootfs 1&quot; inside fstab thats why doesn&#039;t mount as extroot instead just normal mount</p>											<p class="post-edited">(Last edited by <strong>makarel</strong> on 26 Dec 2013, 01:40)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p220899">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Ektus</div>
					<div class="post-datetime">
						26 Dec 2013, 03:39					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nebbia88 wrote:</cite><blockquote><p>full log of what you did and all command output could be useful.</p></blockquote></div><p>I did just follow the steps in the linked blog.</p><p>Current output immediately after boot, last change: target &#039;/mnt&#039; instead of &#039;/&#039;:</p><div class="codebox"><pre><code>login as: root
root@192.168.0.36&#039;s password:


BusyBox v1.19.4 (2013-02-21 15:00:55 EST) built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 -----------------------------------------------------
 BARRIER BREAKER (35706_2013-02-23, r35706)
 -----------------------------------------------------
  * 1/2 oz Galliano         Pour all ingredients into
  * 4 oz cold Coffee        an irish coffee mug filled
  * 1 1/2 oz Dark Rum       with crushed ice. Stir.
  * 2 tsp. Creme de Cacao
 -----------------------------------------------------
root@OpenWrt:~# df
Filesystem           1K-blocks      Used Available Use% Mounted on
rootfs                     320       248        72  78% /
/dev/root                 2816      2816         0 100% /rom
tmpfs                    14672       328     14344   2% /tmp
tmpfs                      512         0       512   0% /dev
/dev/mtdblock3             320       248        72  78% /overlay
/dev/sda1              3628936     88536   3356056   3% /tmp/overlay-disabled
overlayfs:/overlay         320       248        72  78% /
root@OpenWrt:~# vi /etc/config/fstab

config global &#039;automount&#039;
        option from_fstab &#039;1&#039;
        option anon_mount &#039;1&#039;

config global &#039;autoswap&#039;
        option from_fstab &#039;1&#039;
        option anon_swap &#039;0&#039;

config mount
        option target &#039;/mnt&#039;
        option device &#039;/dev/sda1&#039;
        option fstype &#039;ext4&#039;
        option options &#039;rw,sync&#039;
        option enabled &#039;1&#039;
        option is_rootfs &#039;1&#039;

config swap
        option device &#039;/dev/sda2&#039;
        option enabled &#039;0&#039;

~
~
root@OpenWrt:~#</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p220900">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">Ektus</div>
					<div class="post-datetime">
						26 Dec 2013, 03:49					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>makarel wrote:</cite><blockquote><p>first post here is prety complete of what you have to do<br /><a href="https://forum.openwrt.org/viewtopic.php?id=24138">https://forum.openwrt.org/viewtopic.php?id=24138</a></p><br /><p>ps: in your guide.. the guy there forgot the &quot;option is_rootfs 1&quot; inside fstab thats why doesn&#039;t mount as extroot instead just normal mount</p></blockquote></div><p>That&#039;s pretty much what I did, and I have added &quot;option is_rootfs 1&quot; since (via luci in the &quot;mount&quot; tab), but to no avail, see last post. block-extroot is not available, though:</p><div class="codebox"><pre><code>root@OpenWrt:~# opkg update
Downloading http://www.madox.net/wr703n/35706_2013-02-23/packages/Packages.gz.
Updated list of available packages in /var/opkg-lists/www.madox.net.
root@OpenWrt:~# opkg install block-extroot
Unknown package &#039;block-extroot&#039;.
Collected errors:
 * opkg_install_cmd: Cannot install package block-extroot.
root@OpenWrt:~#</code></pre></div><p>I do have a squashfs build, though. Is there a jffs build available with usb and block support enabled? The standard builds won&#039;t do, as there&#039;s not enough space left to install those modules in order to get more space...</p><br /><p>Regards</p><p>Ektus.</p>											<p class="post-edited">(Last edited by <strong>Ektus</strong> on 26 Dec 2013, 03:54)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p220901">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Ektus</div>
					<div class="post-datetime">
						26 Dec 2013, 04:12					</div>
				</div>
				<div class="post-content content">
					<p>I found a solution in <a href="https://forum.openwrt.org/viewtopic.php?id=28980">https://forum.openwrt.org/viewtopic.php?id=28980</a></p><div class="codebox"><pre><code>cp /.extroot.md5sum /tmp/overlay-disabled/etc/extroot.md5sum</code></pre></div><p>This did the trick.</p><div class="codebox"><pre><code>root@192.168.0.36&#039;s password:


BusyBox v1.19.4 (2013-02-21 15:00:55 EST) built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 -----------------------------------------------------
 BARRIER BREAKER (35706_2013-02-23, r35706)
 -----------------------------------------------------
  * 1/2 oz Galliano         Pour all ingredients into
  * 4 oz cold Coffee        an irish coffee mug filled
  * 1 1/2 oz Dark Rum       with crushed ice. Stir.
  * 2 tsp. Creme de Cacao
 -----------------------------------------------------
root@OpenWrt:~# df
Filesystem           1K-blocks      Used Available Use% Mounted on
rootfs                 3628936     88536   3356056   3% /
/dev/root                 2816      2816         0 100% /rom
tmpfs                    14672       536     14136   4% /tmp
tmpfs                      512         0       512   0% /dev
/dev/sda1              3628936     88536   3356056   3% /overlay
overlayfs:/overlay     3628936     88536   3356056   3% /
root@OpenWrt:~#</code></pre></div>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>