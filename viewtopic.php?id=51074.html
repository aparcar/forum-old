<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> &quot;Bricked&quot; TL-WDR4900 v1.3</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 25 Mar 2018 and 14 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=51074&amp;p=2.html">2</a></li></ul></nav></div>
			
		
		
			<article class="post" id="p236393">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Steve192</div>
					<div class="post-datetime">
						11 Jun 2014, 22:29					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>Today I wanted to switch from DD-WRT to OpenWRT to have more functionality. Before I was able to flash OpenWRT I noticed, that the Webinterface of DD-WRT was not reachable ( blank page ). After further investigation, a lot of the services of DD-WRT were not running anymore and almost nothing was working.</p><p>So I wanted to remove DD-WRT and replace it with OpenWRT, but I had some trouble finding a way to flash it.</p><p>I am able to ping the router, connect to ssh (although my username and password are not recognized), connect to wifi, use DHCP etc.</p><p>I tried a hard reset (30/30/30) several times but nothing happened. I also tried to set my IP to static 192.168.0.66 and started a TFTP server to serve a new firmware to my router ( like described in <a href="http://wiki.openwrt.org/toh/tp-link/tl-wdr4900">http://wiki.openwrt.org/toh/tp-link/tl-wdr4900</a> ), but the file was never fetched. The router just instantly boots up and is in the same situation.</p><p>What can I now do to remove DD-WRT and install OpenWRT ?</p><p>Since this is not directly DD-WRT related I do hope you will be able to help me.</p><p>Best Regards</p><p>Steve</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236419">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">ryts</div>
					<div class="post-datetime">
						12 Jun 2014, 01:33					</div>
				</div>
				<div class="post-content content">
					<p>Personally I think you would be better off reverting from dd-wrt to stock firmware and then coming to OpenWRT.</p><p>The best know-how for that is surely on the dd-wrt forums/wiki/some such?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236428">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">dabyd64</div>
					<div class="post-datetime">
						12 Jun 2014, 03:23					</div>
				</div>
				<div class="post-content content">
					<p><strong>Edit 10/08/2017 - added new link, as the old was dead </strong></p><p>I tried the recovery mode and it worked perfect.<br />Download and extract this file:</p><p> <a href="https://mega.nz/#!RkU2gZyI!FCtrgn7lXVQlmfo9meq-mWyyIKkZkvi2xvtVRMw61Co">https://mega.nz/#!RkU2gZyI!FCtrgn7lXVQl â€¦ vtVRMw61Co</a><br />- Set your ip to 192.168.0.66, mask 255.255.255.0. Do not set anything else.<br />- Connect the computer to the WDR4900&#039;s&nbsp; switch,any port is ok, BUT NOT wan port!<br />- Open TFTPD32, leave it visible.<br />- Power on the router while keeping pressed the WPS/reset button, wait while keeping pressed at least 20 seconds.<br />- At some point, you should see that TFTPD32 starts a transfer. Just wait, the router will self reboot after 2 minutes or so.<br />- Done!</p><p>Also, have you tried the emergency mode? When the system led blink, quicly start pushing the reset button ,then the led should blink much faster.<br />Set your ip to 192.168.1.11, and telnet to 192.1681.1.<br />You should be on Openwrt shell, now type &quot;mtd -r erase rootfs_data&quot;<br />It will reset all the data, and restart. Then it will be a fresh Openwrt installation</p>											<p class="post-edited">(Last edited by <strong>dabyd64</strong> on 10 Aug 2017, 23:15)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236470">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">ryts</div>
					<div class="post-datetime">
						12 Jun 2014, 12:43					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dabyd64 wrote:</cite><blockquote><p>Also, have you tried the emergency mode? When the system led blink, quicly start pushing the reset button ,then the led should blink much faster.<br />Set your ip to 192.168.1.11, and telnet to 192.1681.1.<br />You should be on Openwrt shell, now type &quot;mtd -r erase rootfs_data&quot;<br />It will reset all the data, and restart. Then it will be a fresh Openwrt installation</p></blockquote></div><p>Given that he is still with dd-wrt, does this still hold?&nbsp; It may default to 192.168.0.1 for telnet address.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236475">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">dabyd64</div>
					<div class="post-datetime">
						12 Jun 2014, 12:49					</div>
				</div>
				<div class="post-content content">
					<p>Ouch, nope ddwrt doesn&#039;t do this I think. Try the bootloader mode.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236512">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Steve192</div>
					<div class="post-datetime">
						12 Jun 2014, 17:51					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for the answers. I tried to flash the firmware again with the files dabyd64 provided, but it still seems to not be working.</p><p>The router just starts up, all leds (exept for the 2 wifi leds) are lighing up, then all leds exept for the power led turn off and the lan port 1 led starts to flash. Seconds after this, the lan led stops flashing for a few seconds. Then it starts flashing again and the wifi led turns on (I guess dd-wrt is starting at that point). (I can upload a video if you like)</p><p>The TFTP Server does not give any messeges. Here is a screenshot of my lan interface configuration :</p><p><a href="http://oi59.tinypic.com/b65340.jpg">http://oi59.tinypic.com/b65340.jpg</a></p><p>Windows firewall is turned off btw.</p><p>Is there something I could be doing wrong ?</p><p>EDIT: When my the router is turned off tftp32.exe shows 127.0.0.1 as IP-Adress. Is there a possibility that it recognizes the new IP (192.168.0.66) too late ?</p>											<p class="post-edited">(Last edited by <strong>Steve192</strong> on 12 Jun 2014, 18:02)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236513">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">dabyd64</div>
					<div class="post-datetime">
						12 Jun 2014, 18:01					</div>
				</div>
				<div class="post-content content">
					<p>All seems OK. For me it worked, and I was using windows 8. Remember to set your ethernet as &quot;work network&quot;, not public, maybe it blocks that connections in public mode.<br />Are you running TFTPD32 as admin? (Right clic-&gt;open as administrator)<br />I think it&#039;s some program that blocks the connection.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236516">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">Steve192</div>
					<div class="post-datetime">
						12 Jun 2014, 18:21					</div>
				</div>
				<div class="post-content content">
					<p>Yes I&#039;m running it as admin.</p><p>The windows 8.1 network center sais &quot;Not identified network&quot; - &quot;public network&quot;. Unfortunatly I cannot change the type of an unidentified network.</p><p>I will try to use ubuntu to do it and will report back.</p><p>EDIT: I also tried it with ubuntu and had no success. In the meantime I installed wireshark on both ubuntu and windows 8.1 to see if the router is searching for a tftp server, and I found nothing.</p><p>Is there anything else I could do? Why is my router not searching for a tftp server ? The bios is intact ...</p>											<p class="post-edited">(Last edited by <strong>Steve192</strong> on 12 Jun 2014, 19:03)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236538">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						12 Jun 2014, 21:31					</div>
				</div>
				<div class="post-content content">
					<p>try to put an ethernet switch (or another router) between 4900 and pc, so that ethernet link is always &quot;up&quot; and tftpd starts correctly and always see the right ip.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236548">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">dabyd64</div>
					<div class="post-datetime">
						12 Jun 2014, 22:32					</div>
				</div>
				<div class="post-content content">
					<p>Strange thing. Although tftpd32 puts 127.0.0.1, this is only due the fact that the LAN interface is down, and works when you power the router.<br />I made a small video:<br /><a href="http://www.youtube.com/watch?v=54PAS0gvW2k">http://www.youtube.com/watch?v=54PAS0gvW2k</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236553">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">Steve192</div>
					<div class="post-datetime">
						12 Jun 2014, 23:08					</div>
				</div>
				<div class="post-content content">
					<p>OK this is strange...</p><p>I&#039;m doing the exact same thing and it does not connect to the tftp Server. I will upload a Video tomorrow</p><p>I also tried to add a switch between the Router and my PC and it did not work.</p>											<p class="post-edited">(Last edited by <strong>Steve192</strong> on 12 Jun 2014, 23:09)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236557">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">dabyd64</div>
					<div class="post-datetime">
						12 Jun 2014, 23:49					</div>
				</div>
				<div class="post-content content">
					<p>Maybe its something related with the version? Maybe some bootloader version disables this method</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236758">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">Steve192</div>
					<div class="post-datetime">
						14 Jun 2014, 14:07					</div>
				</div>
				<div class="post-content content">
					<p>I have hardware version 1.3 what Version do you have ?</p><p>I finaly made a video of me trying to use the tftp bootloader method. I&#039;m also showing that the Firmware partially boots up and DHCP works. </p><p>&quot;Bricked&quot; WDR4900: <a href="http://youtu.be/b8F1zBzq5-c">http://youtu.be/b8F1zBzq5-c</a></p><p>If you have no more ideas i will try to connect to the mainboard via RS232. Is the tutorial on <a href="http://wiki.openwrt.org/toh/tp-link/tl-wdr4900">http://wiki.openwrt.org/toh/tp-link/tl-wdr4900</a> up to date ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236759">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						14 Jun 2014, 14:20					</div>
				</div>
				<div class="post-content content">
					<p>not RS232, it must be a 3.3v ttl serial adapter...</p><p> obviously you tried powering up with reset button pressed BEFORE power button, not after like it&#039;s shown in video?<br />try also other button (wifi toggle?) ot BOTH.</p>											<p class="post-edited">(Last edited by <strong>nebbia88</strong> on 14 Jun 2014, 14:28)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236761">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">Steve192</div>
					<div class="post-datetime">
						14 Jun 2014, 14:32					</div>
				</div>
				<div class="post-content content">
					<p>The wifi button is just a switch. But i will try to press the button after powering up. Is there an indicator when I should press it ?</p><p>If this does not work, I have one of these laying around<br /><a href="https://www.amazon.de/dp/B00D77F79W/ref=cm_sw_r_udp_awd_3idNtb0CSB5WBP7E">https://www.amazon.de/dp/B00D77F79W/ref â€¦ 0CSB5WBP7E</a></p><p>Can this be used to connect to the mainboard ?</p><p>EDIT: I tried it in the exact moment as shown in the other video with no success</p>											<p class="post-edited">(Last edited by <strong>Steve192</strong> on 14 Jun 2014, 14:42)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236764">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">makro</div>
					<div class="post-datetime">
						14 Jun 2014, 14:51					</div>
				</div>
				<div class="post-content content">
					<p>Yes, that adapter should work.</p><p>I have a v1.3, but mine has green LEDs, yours has blue. Not that the TFTP feature is implemented in the LEDs, but it&#039;s still a difference. Do you remember what firmware your WDR4900 shipped with, or did you update to latest stock firmware before flashing DD-WRT? The TFTP reset button method may only be implemented in the most recent firmware, I think it was first discovered last year. My WDR4900 shipped with 130424, and I&#039;ve used the TFTP recovery without issue.</p><p>I don&#039;t know if the Wi-Fi toggle will do anything, but no harm trying it in both positions. The reset button should be pressed and held before you power the router on, and until the transfer is finished.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236767">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">Steve192</div>
					<div class="post-datetime">
						14 Jun 2014, 15:13					</div>
				</div>
				<div class="post-content content">
					<p>OK same version different hardware is strange. Especially if you think about the use of a hardware version.</p><p>My wdr4900 was shipped with the 130320 firmware as far as I know and I did not update it</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236774">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">dabyd64</div>
					<div class="post-datetime">
						14 Jun 2014, 16:24					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve checked mine, is v1.3 too.<br />I suggest to try with other computer</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236775">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">Steve192</div>
					<div class="post-datetime">
						14 Jun 2014, 16:28					</div>
				</div>
				<div class="post-content content">
					<p>I tried it with 3 several computers and operating systems ( windows 7; windows 8.1; ubuntu 12.04) now. None worked</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236777">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">dabyd64</div>
					<div class="post-datetime">
						14 Jun 2014, 16:32					</div>
				</div>
				<div class="post-content content">
					<p>Then, get a serial cable and let&#039;s ser what the hell is happening there! <img src="https://forum.openwrt.org/img/smilies/lol.png" width="15" height="15" alt="lol" /></p>											<p class="post-edited">(Last edited by <strong>dabyd64</strong> on 14 Jun 2014, 16:32)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p239995">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">Steve192</div>
					<div class="post-datetime">
						11 Jul 2014, 21:46					</div>
				</div>
				<div class="post-content content">
					<p>Hi</p><p>I finally had time to use my serial cable and try to fix my router. <br />Sadly I had problems doing so. I was not able to access the command prompt by typing &quot;vl&quot; or &quot;tpl&quot; just after the router boots.<br />There was no reaction to &quot;vl&quot; or &quot;tpl&quot;. There was also no change when I pressed the reset button while booting up.</p><p>Here is the log:</p><div class="codebox"><pre><code>U-Boot 2010.12-svn18602 (Mar 20 2013 - 10:42:31)

CPU:   P1014, Version: 1.0, (0x80f10110)
Core:  E500, Version: 5.1, (0x80212151)
Clock Configuration:
       CPU0:800  MHz, 
       CCB:400  MHz,
       DDR:333.333 MHz (666.667 MT/s data rate) (Asynchronous), IFC:100  MHz
L1:    D-cache 32 kB enabled
       I-cache 32 kB enabled
Board: P1014RDB 
SPI:   ready
DRAM:  128 MiB
L2:    256 KB enabled
Using default environment

PCIe1: Root Complex of mini PCIe Slot, x1, regs @ 0xffe0a000
  01:00.0     - 168c:abcd - Network controller
PCIe1: Bus 00 - 01
PCIe2: Root Complex of PCIe Slot, x1, regs @ 0xffe09000
  03:00.0     - 168c:0033 - Network controller
PCIe2: Bus 02 - 03
In:    serial
Out:   serial
Err:   serial
Net:   initialization for Atheros AR8327/AR8328
AR8327/AR8328 v1.1 is found!
eTSEC1
vl
vl
Autobooting in 1 seconds
vl
vl
vl
SF: Detected S25FL128S_64K with page size 256, total 16 MiB
16384 KiB S25FL128S_64K at 0:0 is now current device
vl
vl
vl
vl
vl
SPI flash read successful
SPI flash read successful
## Booting kernel from Legacy Image at 02000000 ...
   Image Name:   Linux-3.10.40
   Image Type:   PowerPC Linux Kernel Image (gzip compressed)
   Data Size:    1918109 Bytes = 1.8 MiB
   Load Address: 01000000
   Entry Point:  01000514
   Verifying Checksum ... OK
## Flattened Device Tree blob at 03000000</code></pre></div><p>What am I doing wrong ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p240006">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">Experimentator</div>
					<div class="post-datetime">
						11 Jul 2014, 22:48					</div>
				</div>
				<div class="post-content content">
					<p>Check flow control option <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p240010">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">Steve192</div>
					<div class="post-datetime">
						11 Jul 2014, 22:54					</div>
				</div>
				<div class="post-content content">
					<p>Flow contol is turned off as described in <a href="http://wiki.openwrt.org/toh/tp-link/tl-wdr4900">http://wiki.openwrt.org/toh/tp-link/tl-wdr4900</a></p><p><a href="http://imgur.com/aXDsIUM">http://imgur.com/aXDsIUM</a></p><p>EDIT: Works now! I had to turn off &quot;append LF&quot;</p>											<p class="post-edited">(Last edited by <strong>Steve192</strong> on 11 Jul 2014, 22:58)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p240014">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">Experimentator</div>
					<div class="post-datetime">
						11 Jul 2014, 23:08					</div>
				</div>
				<div class="post-content content">
					<p>Very good news. Do you have any idea why tftp recovery using recovery mode won&#039;t work ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p240021">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">Steve192</div>
					<div class="post-datetime">
						11 Jul 2014, 23:29					</div>
				</div>
				<div class="post-content content">
					<p>Nope, I have no idea ... <br />I have a newer bootloader version ( U-Boot 2010.12-svn18602, the tutorial used U-Boot 2010.12-svn15934 ) so maybe they removed the possibility to start the tftp client by pressing the reset button. But I could not imagine why to do this.</p><p>Another possibility would be that the physical reset button is somehow damaged since there is no reaction when I pressed it, not even with dd-wrt &quot;booted&quot; (it should erase nvram if pressed in dd-wrt).</p><p>Anyway I now flashed the firmware with the serial cable and it worked. ( I had to turn off &quot;append LF&quot; to get to the command prompt and turn it back on to enter commands )</p><p>Thanks for the help everybody <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=51074&amp;p=2.html">2</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>