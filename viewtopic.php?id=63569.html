<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Can&#039;t get into OnNetworks N150 router</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 18 Apr 2018 and 27 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=63569&amp;p=2.html">2</a></li></ul></nav></div>
			
		
		
			<article class="post" id="p316030">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">werlej83</div>
					<div class="post-datetime">
						22 Mar 2016, 01:52					</div>
				</div>
				<div class="post-content content">
					<p>I installed the image openwrt-15.05.1-ar71xx-generic-n150r-squashfs-factory.img via the factory firmware upgrade page</p><p>after it completed, I am unable to access the web interface or via telnet or SSH.</p><p>Anything I can do to get into the router without having to go via serial?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p316085">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">bolvan</div>
					<div class="post-datetime">
						22 Mar 2016, 11:52					</div>
				</div>
				<div class="post-content content">
					<p>There&#039;re only 2 options. serial or network.<br />if network does not work then only serial is left.<br />Read wiki and find if your device supports TFTP recovery. Use it to reflash the image.<br />Ensure image is for your device not another</p>											<p class="post-edited">(Last edited by <strong>bolvan</strong> on 22 Mar 2016, 11:53)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p321423">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">jchau</div>
					<div class="post-datetime">
						27 Apr 2016, 07:29					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m experiencing the same problem.&nbsp; </p><p>I followed the instructions at <a href="https://wiki.openwrt.org/toh/netgear/wnr612v2">https://wiki.openwrt.org/toh/netgear/wnr612v2</a>, which stated </p><div class="quotebox"><blockquote><p>Note: The device is re-branded as the On Networks N150 router, in a different casing.</p></blockquote></div><p>I downloaded openwrt-15.05.1-ar71xx-generic-n150r-squashfs-factory.img, verified the checksums, and installed it using the web interface.&nbsp; However, this appears to have bricked the wireless router.&nbsp; </p><p>Even if I connect via a wired Ethernet connection (though one of the LAN ports on the router; the corresponding LED lights up on the router, but nothing else), the router does not respond to DHCP requests.&nbsp; Manually setting my computer&#039;s IP address to 192.168.1.2/24 and trying to connect to the router at 192.168.1.1 fails (ping fails, and the router doesn&#039;t respond on any common ports).&nbsp; </p><p>There appears to be clearance sales on this router around now.&nbsp; I suspect that many others buying this router now are expecting to be able to install OpenWRT on it (due to the bad reviews on the stock firmware).&nbsp; So I want to leave a warning for others:</p><p><span style="color: red"><span class="bbu">WARNING:</span> Installing openwrt-15.05.1-ar71xx-generic-n150r-squashfs-factory.img via the web interface bricks the router.<br />From my experience and werlej83&#039;s report, the On Networks N150R is <strong>NOT</strong> compatible with OpenWRT.</span></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p321425">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">tmo26</div>
					<div class="post-datetime">
						27 Apr 2016, 08:20					</div>
				</div>
				<div class="post-content content">
					<p>A serial bootlog could help in resolving this issue.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p321427">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">jchau</div>
					<div class="post-datetime">
						27 Apr 2016, 08:46					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>tmo26 wrote:</cite><blockquote><p>A serial bootlog could help in resolving this issue.</p></blockquote></div><p>I wish I had a 3.3V serial port /adapter I could use to debug this, and I might order one if I need to (but it&#039;ll probably cost me more than this router does ($3 USD after rebate)).&nbsp; </p><p>I think I can get the boot loader into a firmware recovery mode (without using the serial port) by holding down the reset button when I power on the router.&nbsp; So far, I&#039;ve been able to resend the OpenWRT firmware using tftp, but I haven&#039;t been able to get it to boot yet.&nbsp; </p><p>It&#039;s late at night here.&nbsp; I may try different firmware images later (perhaps this weekend).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p321432">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">jchau</div>
					<div class="post-datetime">
						27 Apr 2016, 09:24					</div>
				</div>
				<div class="post-content content">
					<p>I was able to successfully flash and boot OpenWRT-14.07 (Barrier Breaker) <a href="https://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/openwrt-ar71xx-generic-n150r-squashfs-factory.img">https://downloads.openwrt.org/barrier_b … actory.img</a> using tftp.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p321435">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">jchau</div>
					<div class="post-datetime">
						27 Apr 2016, 09:40					</div>
				</div>
				<div class="post-content content">
					<p>And a subsequent upgrade from Barrier Breaker (14.07) to Chaos Calmer (15.05.1) using the LuCI interface to flash the openwrt-15.05.1-ar71xx-generic-n150r-squashfs-sysupgrade.bin firmware image was successful.&nbsp; </p><p>My current recommendation to install OpenWRT on the On Networks N150R is to:<br />1. Install openwrt-ar71xx-generic-n150r-squashfs-factory.img for Barrier Breaker (OpenWRT 14.07).<br />2. Then use OpenWRT to upgrade to openwrt-15.05.1-ar71xx-generic-n150r-squashfs-sysupgrade.bin.</p><p>Feel free to ask if you have trouble with this procedure; I&#039;ll try to update the wiki page this weekend.&nbsp; </p><p>Now, to sleep <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p321460">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">tmo26</div>
					<div class="post-datetime">
						27 Apr 2016, 13:11					</div>
				</div>
				<div class="post-content content">
					<p>This doesn&#039;t really solve the issue with direct flashing of 15.05.1...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p321473">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">TabsFolders.com</div>
					<div class="post-datetime">
						27 Apr 2016, 15:05					</div>
				</div>
				<div class="post-content content">
					<p>Could you let us know how exactly you got the router into recovery mode and what settings on the tftp server. Eg. ethernet over dhcp; or bootp, or manual (what ip address). etc.&nbsp; <br />Thanks.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p321513">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">jchau</div>
					<div class="post-datetime">
						27 Apr 2016, 17:51					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>TabsFolders.com wrote:</cite><blockquote><p>Could you let us know how exactly you got the router into recovery mode and what settings on the tftp server. Eg. ethernet over dhcp; or bootp, or manual (what ip address). etc.&nbsp; <br />Thanks.</p></blockquote></div><p>I did this using my computer running Gentoo Linux, using <a href="https://www.kernel.org/pub/software/network/tftp/">tftp-hpa</a>, following the instructions in &quot;Using netkit&#039;s tftp&quot; from <a href="https://wiki.openwrt.org/doc/howto/generic.flashing.tftp#linuxbsd">https://wiki.openwrt.org/doc/howto/gene … p#linuxbsd</a>.&nbsp; You may need to adjust the tftp command(s) depending on which tftp client you use.&nbsp; </p><h5>Preparation:</h5><p>Download and verify the checksum for <a href="https://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/openwrt-ar71xx-generic-n150r-squashfs-factory.img">openwrt-ar71xx-generic-n150r-squashfs-factory.img (OpenWRT Barrier Breaker 14.07)</a>.</p><h5>Instructions:</h5><p>1. Connect to a LAN port on the router using the included Ethernet cable.</p><p>2. The bootloader&#039;s recovery mode seems to have a DHCP server, so you can configure the Ethernet interface to use DHCP as usual.&nbsp; <br />Alternatively, if you&#039;re not using DHCP, on the connected computer, as root (other commands can be done as a normal user):<br /></p><div class="codebox"><pre><code>ifconfig enp0s12 192.168.1.2/24 up</code></pre></div><p>where enp0s12 is the name of the computer&#039;s Ethernet interface.&nbsp; </p><p>3. Start and configure the tftp client (in the directory containing the firmware image):<br /></p><div class="codebox"><pre><code>tftp 192.168.1.1
binary
rexmt 1
timeout 60
trace</code></pre></div><p>4. Continuously ping the router.&nbsp; This will let you know when the bootloader&#039;s firmware recovery mode is ready (and when you can release the reset button on the next step).&nbsp; </p><p>5. With the router off, while steadily holding down (i.e., pressing and holding) the reset button, power on the router.&nbsp; You can do this either by using the built-in power button or by unplugging and plugging back in the power cable.&nbsp; </p><p>Hold the reset button until you see some reply pings from step 4.&nbsp; </p><p>6. In the tftp client, issue the command:<br /></p><div class="codebox"><pre><code>put openwrt-ar71xx-generic-n150r-squashfs-factory.img</code></pre></div><p>.</p><p>7. The router will then install (flash) the firmware image and restart, booting OpenWRT.&nbsp; Give it a few minutes; when the power light is steady green, you can try connecting to the router and proceed with the &quot;First Login&quot; part of installation.&nbsp; </p><p>I recommend using telnet to connect to the router first, to configure the admin password.&nbsp; In my experience with this router, if I set the admin password using the LuCI web interface, LuCI would continue to prompt me for a password (and the telnet server that allows the password to be reset will continue running).&nbsp; I don&#039;t know why.</p>											<p class="post-edited">(Last edited by <strong>jchau</strong> on 27 Apr 2016, 17:52)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p321517">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">jchau</div>
					<div class="post-datetime">
						27 Apr 2016, 18:32					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>tmo26 wrote:</cite><blockquote><p>This doesn&#039;t really solve the issue with direct flashing of 15.05.1...</p></blockquote></div><p>I know this isn&#039;t ideal: it&#039;s more of a workaround than a solution, and the original problem still remains in how the OpenWRT 15.05.1 factory firmware image interacts with the router. Sorry.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p321583">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">yellowsnow4free</div>
					<div class="post-datetime">
						28 Apr 2016, 06:03					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jchau wrote:</cite><blockquote><p>My current recommendation to install OpenWRT on the On Networks N150R is to:<br />1. Install openwrt-ar71xx-generic-n150r-squashfs-factory.img for Barrier Breaker (OpenWRT 14.07).<br />2. Then use OpenWRT to upgrade to openwrt-15.05.1-ar71xx-generic-n150r-squashfs-sysupgrade.bin.</p><p>Feel free to ask if you have trouble with this procedure; I&#039;ll try to update the wiki page this weekend.</p></blockquote></div><p>Thanks jchau!</p><p>I just received my N150R today (free after rebate) and if I have time soon I&#039;m gonna try and flash it for OpenWRT of some kind.</p><p>Just to confirm, for your method I don&#039;t require a special cable or anything, right?</p>											<p class="post-edited">(Last edited by <strong>yellowsnow4free</strong> on 28 Apr 2016, 06:04)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p321588">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">bengal571</div>
					<div class="post-datetime">
						28 Apr 2016, 07:54					</div>
				</div>
				<div class="post-content content">
					<p>I followed jchau&#039;s advice to load 14.07 first (via serial/tftp). I then performed sysupgrade to 15.05.1.</p><p>My problem is that the router boots and runs, but it will not keep any of the settings I Save and Apply after a power cycle? Do you know what could be causing this issue?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p321664">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">TabsFolders.com</div>
					<div class="post-datetime">
						28 Apr 2016, 17:11					</div>
				</div>
				<div class="post-content content">
					<p>Thank you @jchau for the amazingly detailed instructions!!!&nbsp; I have un-bricked the router and working well for now on 14.07.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p321669">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">TabsFolders.com</div>
					<div class="post-datetime">
						28 Apr 2016, 17:22					</div>
				</div>
				<div class="post-content content">
					<p>P.S. as a thank you contact me at kamil.bukala at tabsfolders.com for a free 1 year subscription.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p321670">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">TabsFolders.com</div>
					<div class="post-datetime">
						28 Apr 2016, 17:28					</div>
				</div>
				<div class="post-content content">
					<p>P.P.S. Also as @bengal571 wrote, mine won&#039;t store configuration after poweroff.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p321930">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">linuxrocks123</div>
					<div class="post-datetime">
						30 Apr 2016, 11:04					</div>
				</div>
				<div class="post-content content">
					<p>I decided to risk it and flashed openwrt-ar71xx-generic-n150r-squashfs-factory.img (Barrier Breaker) using the web interface instead of TFTP.&nbsp; It went fine!&nbsp; So it appears the TFTP procedure isn&#039;t necessary unless you&#039;ve already bricked it by flashing the latest version.</p>											<p class="post-edited">(Last edited by <strong>linuxrocks123</strong> on 30 Apr 2016, 11:14)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p321941">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">linuxrocks123</div>
					<div class="post-datetime">
						30 Apr 2016, 12:27					</div>
				</div>
				<div class="post-content content">
					<p>I found out the reason for the config not surviving reboots -- the image is too large for the device&#039;s flash, so there&#039;s no space to save the config left!&nbsp; Specifically, there&#039;s not enough space left for the jffs image -- you can see so from typing dmesg.&nbsp; This may be the reason for the soft brick when installing 15.05 as well...</p>											<p class="post-edited">(Last edited by <strong>linuxrocks123</strong> on 30 Apr 2016, 12:28)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p321988">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">jchau</div>
					<div class="post-datetime">
						30 Apr 2016, 21:40					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>linuxrocks123 wrote:</cite><blockquote><p>I found out the reason for the config not surviving reboots -- the image is too large for the device&#039;s flash, so there&#039;s no space to save the config left!&nbsp; Specifically, there&#039;s not enough space left for the jffs image -- you can see so from typing dmesg.&nbsp; This may be the reason for the soft brick when installing 15.05 as well...</p></blockquote></div><p>Good catch, linuxrocks123.</p><p>For reference, here&#039;s my dmesg after a fresh flash (only config I changed was the root password):<br /></p><div class="codebox"><pre><code>[    0.000000] Linux version 3.18.23 (buildbot@builder1) (gcc version 4.8.3 (OpenWrt/Linaro GCC 4.8-2014.04 r47269) ) #1 Sun Jan 31 18:39:35 CET 2016
[    0.000000] MyLoader: sysp=f7e5de55, boardp=be3d3bbf, parts=f7edde55
[    0.000000] bootconsole [early0] enabled
[    0.000000] CPU0 revision is: 00019374 (MIPS 24Kc)
[    0.000000] SoC: Atheros AR7240 rev 2
[    0.000000] Determined physical RAM map:
[    0.000000]  memory: 02000000 @ 00000000 (usable)
[    0.000000] Initrd not found or empty - disabling initrd
[    0.000000] Zone ranges:
[    0.000000]   Normal   [mem 0x00000000-0x01ffffff]
[    0.000000] Movable zone start for each node
[    0.000000] Early memory node ranges
[    0.000000]   node   0: [mem 0x00000000-0x01ffffff]
[    0.000000] Initmem setup node 0 [mem 0x00000000-0x01ffffff]
[    0.000000] On node 0 totalpages: 8192
[    0.000000] free_area_init_node: node 0, pgdat 803762b0, node_mem_map 81000000
[    0.000000]   Normal zone: 64 pages used for memmap
[    0.000000]   Normal zone: 0 pages reserved
[    0.000000]   Normal zone: 8192 pages, LIFO batch:0
[    0.000000] Primary instruction cache 64kB, VIPT, 4-way, linesize 32 bytes.
[    0.000000] Primary data cache 32kB, 4-way, VIPT, cache aliases, linesize 32 bytes
[    0.000000] pcpu-alloc: s0 r0 d32768 u32768 alloc=1*32768
[    0.000000] pcpu-alloc: [0] 0 
[    0.000000] Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 8128
[    0.000000] Kernel command line:  board=WNR612V2 console=ttyS0,115200 mtdparts=spi0.0:256k(u-boot)ro,64k(u-boot-env)ro,3712k(firmware),64k(art)ro rootfstype=squashfs,jffs2 noinitrd
[    0.000000] PID hash table entries: 128 (order: -3, 512 bytes)
[    0.000000] Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
[    0.000000] Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
[    0.000000] Writing ErrCtl register=00000000
[    0.000000] Readback ErrCtl register=00000000
[    0.000000] Memory: 28324K/32768K available (2586K kernel code, 128K rwdata, 540K rodata, 256K init, 193K bss, 4444K reserved)
[    0.000000] SLUB: HWalign=32, Order=0-3, MinObjects=0, CPUs=1, Nodes=1
[    0.000000] NR_IRQS:51
[    0.000000] Clocks: CPU:400.000MHz, DDR:400.000MHz, AHB:200.000MHz, Ref:5.000MHz
[    0.000000] Calibrating delay loop... 265.42 BogoMIPS (lpj=1327104)
[    0.080000] pid_max: default: 32768 minimum: 301
[    0.080000] Mount-cache hash table entries: 1024 (order: 0, 4096 bytes)
[    0.090000] Mountpoint-cache hash table entries: 1024 (order: 0, 4096 bytes)
[    0.100000] NET: Registered protocol family 16
[    0.100000] MIPS: machine is NETGEAR WNR612 V2
[    0.550000] registering PCI controller with io_map_base unset
[    0.560000] PCI host bridge to bus 0000:00
[    0.570000] pci_bus 0000:00: root bus resource [mem 0x10000000-0x13ffffff]
[    0.570000] pci_bus 0000:00: root bus resource [io  0x0000]
[    0.580000] pci_bus 0000:00: No busn resource found for root bus, will use [bus 00-ff]
[    0.580000] pci 0000:00:00.0: [168c:002b] type 00 class 0x028000
[    0.580000] pci 0000:00:00.0: fixup device configuration
[    0.590000] pci 0000:00:00.0: reg 0x10: [mem 0x00000000-0x0000ffff 64bit]
[    0.590000] pci 0000:00:00.0: supports D1
[    0.590000] pci 0000:00:00.0: PME# supported from D0 D1 D3hot
[    0.590000] pci_bus 0000:00: busn_res: [bus 00-ff] end is updated to 00
[    0.590000] pci 0000:00:00.0: BAR 0: assigned [mem 0x10000000-0x1000ffff 64bit]
[    0.590000] pci 0000:00:00.0: using irq 40 for pin 1
[    0.600000] Switched to clocksource MIPS
[    0.600000] NET: Registered protocol family 2
[    0.610000] TCP established hash table entries: 1024 (order: 0, 4096 bytes)
[    0.610000] TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
[    0.620000] TCP: Hash tables configured (established 1024 bind 1024)
[    0.630000] TCP: reno registered
[    0.630000] UDP hash table entries: 256 (order: 0, 4096 bytes)
[    0.640000] UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
[    0.640000] NET: Registered protocol family 1
[    0.650000] PCI: CLS 0 bytes, default 32
[    0.650000] futex hash table entries: 256 (order: -1, 3072 bytes)
[    0.660000] squashfs: version 4.0 (2009/01/31) Phillip Lougher
[    0.670000] jffs2: version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006 Red Hat, Inc.
[    0.680000] msgmni has been set to 55
[    0.690000] io scheduler noop registered
[    0.690000] io scheduler deadline registered (default)
[    0.690000] Serial: 8250/16550 driver, 16 ports, IRQ sharing enabled
[    0.700000] console [ttyS0] disabled
[    0.730000] serial8250.0: ttyS0 at MMIO 0x18020000 (irq = 11, base_baud = 12500000) is a 16550A
[    0.740000] console [ttyS0] enabled
[    0.740000] bootconsole [early0] disabled
[    0.750000] m25p80 spi0.0: found mx25l3205d, expected m25p80
[    0.760000] m25p80 spi0.0: mx25l3205d (4096 Kbytes)
[    0.770000] 4 cmdlinepart partitions found on MTD device spi0.0
[    0.770000] Creating 4 MTD partitions on &quot;spi0.0&quot;:
[    0.780000] 0x000000000000-0x000000040000 : &quot;u-boot&quot;
[    0.780000] 0x000000040000-0x000000050000 : &quot;u-boot-env&quot;
[    0.790000] 0x000000050000-0x0000003f0000 : &quot;firmware&quot;
[    0.800000] 2 netgear-fw partitions found on MTD device firmware
[    0.800000] 0x000000050000-0x000000172440 : &quot;kernel&quot;
[    0.810000] 0x000000172440-0x0000003f0000 : &quot;rootfs&quot;
[    0.820000] mtd: device 4 (rootfs) set to be root filesystem
[    0.820000] 1 squashfs-split partitions found on MTD device rootfs
[    0.830000] 0x0000003b0000-0x0000003f0000 : &quot;rootfs_data&quot;
[    0.840000] 0x0000003f0000-0x000000400000 : &quot;art&quot;
[    0.880000] libphy: ag71xx_mdio: probed
[    1.480000] ag71xx ag71xx.0: connected to PHY at ag71xx-mdio.0:04 [uid=004dd041, driver=Generic PHY]
[    1.490000] eth0: Atheros AG71xx at 0xb9000000, irq 4, mode:MII
[    2.080000] ag71xx-mdio.0: Found an AR7240/AR9330 built-in switch
[    2.120000] eth1: Atheros AG71xx at 0xba000000, irq 5, mode:GMII
[    2.130000] TCP: cubic registered
[    2.130000] NET: Registered protocol family 17
[    2.130000] bridge: automatic filtering via arp/ip/ip6tables has been deprecated. Update your scripts to load br_netfilter if you need this.
[    2.150000] Bridge firewalling registered
[    2.150000] 8021q: 802.1Q VLAN Support v1.8
[    2.160000] VFS: Mounted root (squashfs filesystem) readonly on device 31:4.
[    2.170000] Freeing unused kernel memory: 256K (80390000 - 803d0000)
[    3.440000] init: Console is alive
[    3.440000] init: - watchdog -
[    4.980000] usbcore: registered new interface driver usbfs
[    4.990000] usbcore: registered new interface driver hub
[    4.990000] usbcore: registered new device driver usb
[    5.000000] ehci_hcd: USB 2.0 &#039;Enhanced&#039; Host Controller (EHCI) Driver
[    5.010000] ehci-platform: EHCI generic platform driver
[    5.020000] ohci_hcd: USB 1.1 &#039;Open&#039; Host Controller (OHCI) Driver
[    5.030000] ohci-platform: OHCI generic platform driver
[    5.520000] init: - preinit -
[    6.270000] random: procd urandom read with 9 bits of entropy available
[    8.330000] eth1: link up (1000Mbps/Full duplex)
[    8.410000] mount_root: jffs2 not ready yet, using temporary tmpfs overlay
[    8.460000] eth1: link down
[    8.480000] procd: - early -
[    8.480000] procd: - watchdog -
[    9.200000] procd: - ubus -
[   10.210000] procd: - init -
[   11.180000] NET: Registered protocol family 10
[   11.190000] ip6_tables: (C) 2000-2006 Netfilter Core Team
[   11.210000] Loading modules backported from Linux version master-2015-03-09-0-g141f155
[   11.220000] Backport generated by backports.git backports-20150129-0-gdd4a670
[   11.230000] ip_tables: (C) 2000-2006 Netfilter Core Team
[   11.250000] nf_conntrack version 0.5.0 (446 buckets, 1784 max)
[   11.300000] xt_time: kernel timezone is -0000
[   11.340000] cfg80211: Calling CRDA to update world regulatory domain
[   11.370000] cfg80211: World regulatory domain updated:
[   11.370000] cfg80211:  DFS Master region: unset
[   11.380000] cfg80211:   (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp), (dfs_cac_time)
[   11.390000] cfg80211:   (2402000 KHz - 2472000 KHz @ 40000 KHz), (N/A, 2000 mBm), (N/A)
[   11.390000] cfg80211:   (2457000 KHz - 2482000 KHz @ 20000 KHz, 92000 KHz AUTO), (N/A, 2000 mBm), (N/A)
[   11.400000] cfg80211:   (2474000 KHz - 2494000 KHz @ 20000 KHz), (N/A, 2000 mBm), (N/A)
[   11.410000] cfg80211:   (5170000 KHz - 5250000 KHz @ 80000 KHz, 160000 KHz AUTO), (N/A, 2000 mBm), (N/A)
[   11.420000] cfg80211:   (5250000 KHz - 5330000 KHz @ 80000 KHz, 160000 KHz AUTO), (N/A, 2000 mBm), (0 s)
[   11.430000] cfg80211:   (5490000 KHz - 5730000 KHz @ 160000 KHz), (N/A, 2000 mBm), (0 s)
[   11.440000] cfg80211:   (5735000 KHz - 5835000 KHz @ 80000 KHz), (N/A, 2000 mBm), (N/A)
[   11.450000] cfg80211:   (57240000 KHz - 63720000 KHz @ 2160000 KHz), (N/A, 0 mBm), (N/A)
[   11.530000] PPP generic driver version 2.4.2
[   11.540000] NET: Registered protocol family 24
[   11.600000] PCI: Enabling device 0000:00:00.0 (0000 -&gt; 0002)
[   11.610000] ath: phy0: Enable LNA combining
[   11.610000] ath: phy0: eeprom contains invalid mac address: ff:ff:ff:ff:ff:ff
[   11.620000] ath: phy0: random mac address will be used: c6:ce:f8:00:9a:da
[   11.630000] ath: EEPROM regdomain: 0x0
[   11.630000] ath: EEPROM indicates default country code should be used
[   11.630000] ath: doing EEPROM country-&gt;regdmn map search
[   11.630000] ath: country maps to regdmn code: 0x3a
[   11.630000] ath: Country alpha2 being used: US
[   11.630000] ath: Regpair used: 0x3a
[   11.640000] ieee80211 phy0: Selected rate control algorithm &#039;minstrel_ht&#039;
[   11.640000] ieee80211 phy0: Atheros AR9285 Rev:2 mem=0xb0000000, irq=40
[   11.650000] cfg80211: Calling CRDA for country: US
[   11.670000] cfg80211: Regulatory domain changed to country: US
[   11.670000] cfg80211:  DFS Master region: FCC
[   11.680000] cfg80211:   (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp), (dfs_cac_time)
[   11.690000] cfg80211:   (2402000 KHz - 2472000 KHz @ 40000 KHz), (N/A, 3000 mBm), (N/A)
[   11.700000] cfg80211:   (5170000 KHz - 5250000 KHz @ 80000 KHz, 160000 KHz AUTO), (N/A, 2300 mBm), (N/A)
[   11.710000] cfg80211:   (5250000 KHz - 5330000 KHz @ 80000 KHz, 160000 KHz AUTO), (N/A, 2300 mBm), (0 s)
[   11.720000] cfg80211:   (5490000 KHz - 5730000 KHz @ 160000 KHz), (N/A, 2300 mBm), (0 s)
[   11.720000] cfg80211:   (5735000 KHz - 5835000 KHz @ 80000 KHz), (N/A, 3000 mBm), (N/A)
[   11.730000] cfg80211:   (57240000 KHz - 63720000 KHz @ 2160000 KHz), (N/A, 4000 mBm), (N/A)
[   22.090000] jffs2: Too few erase blocks (4)
[   24.660000] device eth1 entered promiscuous mode
[   24.690000] IPv6: ADDRCONF(NETDEV_UP): br-lan: link is not ready
[   24.720000] IPv6: ADDRCONF(NETDEV_UP): eth0: link is not ready
[   26.820000] eth1: link up (1000Mbps/Full duplex)
[   26.820000] br-lan: port 1(eth1) entered forwarding state
[   26.830000] br-lan: port 1(eth1) entered forwarding state
[   26.850000] IPv6: ADDRCONF(NETDEV_CHANGE): br-lan: link becomes ready
[   28.830000] br-lan: port 1(eth1) entered forwarding state
[   76.530000] random: nonblocking pool is initialized</code></pre></div><p>The relevant part seems to be<br /></p><div class="codebox"><pre><code>[    0.750000] m25p80 spi0.0: found mx25l3205d, expected m25p80
[    0.760000] m25p80 spi0.0: mx25l3205d (4096 Kbytes)
[    0.770000] 4 cmdlinepart partitions found on MTD device spi0.0
[    0.770000] Creating 4 MTD partitions on &quot;spi0.0&quot;:
[    0.780000] 0x000000000000-0x000000040000 : &quot;u-boot&quot;
[    0.780000] 0x000000040000-0x000000050000 : &quot;u-boot-env&quot;
[    0.790000] 0x000000050000-0x0000003f0000 : &quot;firmware&quot;
[    0.800000] 2 netgear-fw partitions found on MTD device firmware
[    0.800000] 0x000000050000-0x000000172440 : &quot;kernel&quot;
[    0.810000] 0x000000172440-0x0000003f0000 : &quot;rootfs&quot;
[    0.820000] mtd: device 4 (rootfs) set to be root filesystem
[    0.820000] 1 squashfs-split partitions found on MTD device rootfs
[    0.830000] 0x0000003b0000-0x0000003f0000 : &quot;rootfs_data&quot;
[    0.840000] 0x0000003f0000-0x000000400000 : &quot;art&quot;</code></pre></div><p>and<br /></p><div class="codebox"><pre><code>[   22.090000] jffs2: Too few erase blocks (4)</code></pre></div><p>The &quot;rootfs_data&quot; partition is only from 0x3b0000-0x3f0000 (the only space in the 4MB of flash that isn&#039;t taken up by something else), which is 262144 bytes long (if I&#039;m interpreting this correctly), so we only have 256kiB of space for the jffs2 partition to store new and changed files.&nbsp; </p><p>Also, df shows:<br /></p><div class="codebox"><pre><code>Filesystem           1K-blocks      Used Available Use% Mounted on
rootfs                   14288        68     14220   0% /
/dev/root                 2304      2304         0 100% /rom
tmpfs                    14288       408     13880   3% /tmp
tmpfs                    14288        68     14220   0% /tmp/root
overlayfs:/tmp/root      14288        68     14220   0% /
tmpfs                      512         0       512   0% /dev</code></pre></div><p>Contrast this with my other router (Buffalo WZR-600DHP) running OpenWRT:<br /></p><div class="codebox"><pre><code>Filesystem           1K-blocks      Used Available Use% Mounted on
rootfs                   28992       996     27996   3% /
/dev/root                 2304      2304         0 100% /rom
tmpfs                    63100      1220     61880   2% /tmp
/dev/mtdblock8           28992       996     27996   3% /overlay
overlayfs:/overlay       28992       996     27996   3% /
tmpfs                      512         0       512   0% /dev</code></pre></div><p>On the &quot;On Networks N150R&quot;, probably because there isn&#039;t enough space on the flash for a jffs2 filesystem, a tmpfs filesystem (i.e., a RAM disk) is used instead:<br /></p><div class="codebox"><pre><code># cat /proc/mounts
rootfs / rootfs rw 0 0
/dev/root /rom squashfs ro,relatime 0 0
proc /proc proc rw,nosuid,nodev,noexec,noatime 0 0
sysfs /sys sysfs rw,nosuid,nodev,noexec,noatime 0 0
tmpfs /tmp tmpfs rw,nosuid,nodev,noatime 0 0
tmpfs /tmp/root tmpfs rw,noatime,mode=755 0 0
overlayfs:/tmp/root / overlay rw,noatime,lowerdir=/,upperdir=/tmp/root/upper,workdir=/tmp/root/work 0 0
tmpfs /dev tmpfs rw,nosuid,relatime,size=512k,mode=755 0 0
devpts /dev/pts devpts rw,nosuid,noexec,relatime,mode=600 0 0
debugfs /sys/kernel/debug debugfs rw,noatime 0 0</code></pre></div><p>I wonder what the minimum requirements for OpenWRT are nowadays (for Chaos Calmer 15.05.1).&nbsp; I suppose we can always make a more barebones flash image?&nbsp; Or perhaps compile OpenWRT to optimize for space?&nbsp; It&#039;s been a few years since I&#039;ve delved into this stuff.</p><p>Related: <a href="https://wiki.openwrt.org/doc/techref/flash.layout">https://wiki.openwrt.org/doc/techref/flash.layout</a>.</p>											<p class="post-edited">(Last edited by <strong>jchau</strong> on 30 Apr 2016, 21:41)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p321989">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">jchau</div>
					<div class="post-datetime">
						30 Apr 2016, 21:51					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jchau wrote:</cite><blockquote><p>And a subsequent upgrade from Barrier Breaker (14.07) to Chaos Calmer (15.05.1) using the LuCI interface to flash the openwrt-15.05.1-ar71xx-generic-n150r-squashfs-sysupgrade.bin firmware image was successful.&nbsp; </p><p>My current recommendation to install OpenWRT on the On Networks N150R is to:<br />1. Install openwrt-ar71xx-generic-n150r-squashfs-factory.img for Barrier Breaker (OpenWRT 14.07).<br />2. Then use OpenWRT to upgrade to openwrt-15.05.1-ar71xx-generic-n150r-squashfs-sysupgrade.bin.</p><p>Feel free to ask if you have trouble with this procedure; I&#039;ll try to update the wiki page this weekend.&nbsp; </p><p>Now, to sleep <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></blockquote></div><p>I did one more experiment: I tried flashing openwrt-15.05.1-ar71xx-generic-n150r-squashfs-factory.img using tftp again (after doing steps 1 and 2 above).&nbsp; And this too, was successful.&nbsp; </p><p>From this, I suspect that OpenWRT 14.07 made some change to the flash that enables OpenWRT 15.05.1 to successfully boot on the On Networks N150R.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p321993">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">Borromini</div>
					<div class="post-datetime">
						30 Apr 2016, 23:07					</div>
				</div>
				<div class="post-content content">
					<p>Somebody should test installing 15.05 directly through TFTP, with a router running stock firmware. Until then, the 14.07 procedure is only based on conjecture.</p><p>The JFSS2 partition not working can be fixed by typing<br /></p><div class="codebox"><pre><code>mtd -r erase rootfs_data</code></pre></div>											<p class="post-edited">(Last edited by <strong>Borromini</strong> on 30 Apr 2016, 23:08)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p322073">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">jchau</div>
					<div class="post-datetime">
						1 May 2016, 19:27					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Borromini wrote:</cite><blockquote><p>The JFSS2 partition not working can be fixed by typing<br /></p><div class="codebox"><pre><code>mtd -r erase rootfs_data</code></pre></div></blockquote></div><p>Thanks for the suggestion.&nbsp; I tried </p><div class="codebox"><pre><code>mtd -r erase rootfs_data</code></pre></div><p> as you suggested, but this does not fix the problem.&nbsp; (E.g., after I erased rootfs_data and the router rebooted, I set a new root password; after rebooting one more time, the root password is forgotten. And the overlayfs mounted on / still uses /tmp/root, which is a tmpfs filesystem.)</p><p>Although the command would probably fix a corrupted rootfs_data partition (by deleting it and starting over), I don&#039;t think that&#039;s the problem in this case; rather, the problem is that the rootfs_data partition (currently just 4 blocks) is too small to hold a jffs2 filesystem. </p><p>The solution to this problem is probably to try to shrink the squashfs filesystem by a few blocks to free up a few more blocks for the jffs2 filesystem.&nbsp; (I&#039;ve been trying to do this with OpenWRT-ImageBuilder this weekend, but I&#039;ve been getting a Segmentation fault for package_install when I run </p><div class="codebox"><pre><code>make image PROFILE=WNR612V2</code></pre></div><p> that I need to debug, perhaps another weekend.)</p><p>I&#039;m thinking that we may be able to free up a few blocks<br /></p><ul><li><p>with the &quot;-Os&quot; gcc flag, </p></li><li><p>perhaps removing the ppp packages (for people who don&#039;t need PPPoE)</p></li><li><p>and if need be, perhaps remove LuCI, though for my purposes, I prefer having a web UI</p></li></ul>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p322158">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">tango</div>
					<div class="post-datetime">
						2 May 2016, 05:13					</div>
				</div>
				<div class="post-content content">
					<p>I have two of the On Networks N150R Router. The first one I was able to use TFTP and re-flash the firmware to the NetGear WNR612v2 using the image &quot;wnr612v2-V1.0.0.3_1.0.2&quot;. The second router is being stubborn. After many attempts, no go on trying to TFTP the NetGear image to the router. I&#039;m using Windows 7 with a ping going in one window and the TFTP command in the second window. I&#039;ve also tried the tftp2.exe program with no luck. The firmware version in the second router is On Networks v1.0.0.3_1.0.5. Upgrading firmware from the On Network web interface using the image&nbsp; &quot;wnr612v2-V1.0.0.3_1.0.2&quot; does not work.</p><p>Can I upgrade to v14.07 of OpenWRT from the On Networks web interface? By using this image &quot;openwrt-14.07-ar71xx-generic-n150r-squashfs-factory.img&quot;.</p><p>Then, using OpenWRT&#039;s web interface, flash the NetGear image?</p><p>I thought I would ask as I&#039;m concerned about bricking the router with not having TFTP working. Does OpenWRT always have TFTP recovery built-in their images? Is it possible On Network could of removed TFTP recovery from their v1.0.0.3_1.0.5 image?</p><p>I would like to use the routers as repeaters so I&#039;m trying to keep both of them on the same firmware.</p><p>@jchau - Many thanks for the TFTP tutorial. If you can get a fully working OpenWRT image working I would consider using that on both routers.</p><p>Please don&#039;t respond to this post if all you have to say is &quot;Why would want to use the NetGear firmware?&quot;</p><p>Thanks in Advance.</p>											<p class="post-edited">(Last edited by <strong>tango</strong> on 2 May 2016, 05:50)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p322167">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">jchau</div>
					<div class="post-datetime">
						2 May 2016, 08:10					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>tango wrote:</cite><blockquote><p>I thought I would ask as I&#039;m concerned about bricking the router with not having TFTP working. Does OpenWRT always have TFTP recovery built-in their images?</p></blockquote></div><p>@tango, although I haven&#039;t personally verified this, <a href="https://wiki.openwrt.org/doc/techref/bootloader">https://wiki.openwrt.org/doc/techref/bootloader</a> indicates that &quot;the bootloader is not part of OpenWRT&quot;.&nbsp; It is the bootloader (not OpenWRT) that provides the TFTP firmware recovery mode.&nbsp; From my understanding, OpenWRT generally avoids altering the bootloader, so unless something goes wrong, flashing OpenWRT should not affect the TFTP firmware recovery mode of the bootloader.&nbsp; </p><p>In your case, this means that flashing OpenWRT should neither fix the bootloader&#039;s TFTP firmware recovery mode nor break it (but I can&#039;t provide any guarantees right now; it&#039;s possible that the OpenWRT firmware image for the N150R has some quirks that I don&#039;t know about.).&nbsp; </p><div class="quotebox"><cite>tango wrote:</cite><blockquote><p>I have two of the On Networks N150R Router. The first one I was able to use TFTP and re-flash the firmware to the NetGear WNR612v2 using the image &quot;wnr612v2-V1.0.0.3_1.0.2&quot;. The second router is being stubborn. After many attempts, no go on trying to TFTP the NetGear image to the router. I&#039;m using Windows 7 with a ping going in one window and the TFTP command in the second window. I&#039;ve also tried the tftp2.exe program with no luck.</p></blockquote></div><p>Can you elaborate on what you mean by &quot;no luck&quot;?&nbsp; Does the router respond to pings after you try to put it in the bootloader&#039;s firmware recovery mode?&nbsp; </p><p>This is just a guess, so it might not actually be your problem, but since you mention two routers, make sure you disconnect your computer from the first router (and any other network) (only connect to the second router) before you try to use TFTP to flash the second router.&nbsp; </p><p>Also, since you have 2 routers, I&#039;m guessing that you&#039;ve set them to different IP addresses; note that these settings don&#039;t apply to the bootloader (and the bootloader&#039;s TFTP server would still be configured to listen at 192.168.1.1 (unless you&#039;ve made changes to the bootloader, which I wouldn&#039;t recommend)).</p><p>Another diagnostic: when I have my router in the bootloader&#039;s firmware recovery mode, the power light blinks repeatedly.&nbsp; Check to see if your router does the same?</p><p>Good luck!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p322174">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">tango</div>
					<div class="post-datetime">
						2 May 2016, 08:56					</div>
				</div>
				<div class="post-content content">
					<p>I only had one router connected at a time and there was no other connections into the router except the ethernet cable from the computer. I set up a static IP of 192.168.1.2. When the router was booted normally, everything was working and the router was responding to pings without error. When in the TFTP recovery mode, I would occasionally get a good reply ping and I would start the&nbsp; TFTP command, but the transfer would never take place. I never really could tell whether I was in recovery mode or not. I&#039;ll take your advice and look for a blinking power light on the router.</p><p><strong>UPDATE:</strong> Success! Checking for a blinking power light did the trick, didn&#039;t have to ping at all. Thanks jchau. Note for future people doing the upgrade, the only two LED&#039;s on is a blinking power LED and a solid LAN LED from your wired ethernet connection This means TFTP recovery mode is running.</p><p>Notes: After flashing to the NetGear firmware and doing a &quot;restore factory defaults&quot; from the web interface a couple of things changed. 1. Login changed from admin/admin to admin/password and region changed to &quot;Europe&quot; under wireless settings. U.S. users will want to change back to &quot;United States&quot;.</p>											<p class="post-edited">(Last edited by <strong>tango</strong> on 2 May 2016, 10:25)</p>
									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=63569&amp;p=2.html">2</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>