<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> ralink rt5572 usb and openwrt problem</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 2 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p175891">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">ushoplias</div>
					<div class="post-datetime">
						27 Aug 2012, 11:10					</div>
				</div>
				<div class="post-content content">
					<p>Hi,<br />I am trying to use TP-LINK TL-WDN3200 (Ralink rt5572) usb device with TP-Link TL-MR3220 router.<br />I successfully installed openwrt trunk on the router. None of the kernel modules recognised the device, so I searched for a driver and found one on the ralink website DPO_RT5572_LinuxSTA_2.6.0.1_20120629.<br />Compilation:<br />-changes in Makefile:<br />PLATFORM = INF_AR9<br />LINUX_SRC = /home/ivan/work/openwrt/trunk/build_dir/linux-ar71xx_generic/linux-3.3.8/<br />CROSS_COMPILE = /home/ivan/work/openwrt/trunk/staging_dir/toolchain-mips_r2_gcc-4.6-linaro_uClibc-0.9.33.2/bin/mips-openwrt-linux-uclibc-<br />-compile:<br />make ARCH=&quot;mips&quot;</p><p>Compilation goes with some warnings, but it gets to rt5572sta.ko</p><p>Now on the router:</p><p>root@OpenWrt:/# insmod rt5572sta.ko <br />[237748.140000] rtusb init rt2870 ---&gt;<br />[237748.140000] <br />[237748.140000] <br />[237748.140000] === pAd = c0fb3000, size = 556328 ===<br />[237748.140000] <br />[237748.150000] &lt;-- RTMPAllocAdapterBlock, Status=0<br />[237748.160000] NVM is EFUSE<br />[237748.170000] usbcore: registered new interface driver rt2870<br />root@OpenWrt:/# ifconfig ra0 up<br />[237766.600000] NICLoadFirmware: We need to load firmware<br />[237766.870000] &lt;-- RTMPAllocTxRxRingMemory, Status=0<br />[237766.880000] RTMP_TimerListAdd: add timer obj c0ffb1c0!<br />[237766.880000] RTMP_TimerListAdd: add timer obj c0ffb1f0!<br />[237766.890000] RTMP_TimerListAdd: add timer obj c0ffb220!<br />[237766.890000] RTMP_TimerListAdd: add timer obj c0ffb190!<br />[237766.900000] RTMP_TimerListAdd: add timer obj c0ffb100!<br />[237766.900000] RTMP_TimerListAdd: add timer obj c0ffb130!<br />[237766.910000] RTMP_TimerListAdd: add timer obj c0fc5b34!<br />[237766.910000] RTMP_TimerListAdd: add timer obj c0fb5018!<br />[237766.920000] RTMP_TimerListAdd: add timer obj c0fb504c!<br />[237766.920000] RTMP_TimerListAdd: add timer obj c0fc5bd8!<br />[237766.930000] RTMP_TimerListAdd: add timer obj c0fc5ad4!<br />[237766.930000] RTMP_TimerListAdd: add timer obj c0fc5ba4!<br />[237766.940000] --&gt;RTUSBVenderReset<br />[237766.950000] &lt;--RTUSBVenderReset<br />[237767.190000] BBP_R254 = 80<br />[237767.390000] Key1Str is Invalid key length(0) or Type(0)<br />[237767.390000] Key2Str is Invalid key length(0) or Type(0)<br />[237767.400000] Key3Str is Invalid key length(0) or Type(0)<br />[237767.400000] Key4Str is Invalid key length(0) or Type(0)<br />[237767.410000] 1. Phy Mode = 5<br />[237767.410000] 2. Phy Mode = 5<br />[237767.420000] NVM is Efuse and its size =3c[3c0-3fb] <br />[237767.450000] Power = 909<br />[237767.450000] Power2 = a0a<br />[237767.460000] Power = 909<br />[237767.460000] Power2 = a0a<br />[237767.460000] Power = 909<br />[237767.470000] Power2 = a0a<br />[237767.470000] Power = 909<br />[237767.470000] Power2 = b0b<br />[237767.480000] Power = a09<br />[237767.480000] Power2 = b0b<br />[237767.490000] Power = a0a<br />[237767.490000] Power2 = b0b<br />[237767.550000] 3. Phy Mode = 5<br />[237767.550000] AntCfgInit: primary/secondary ant 0/1<br />[237767.550000] bAutoTxAgcG = 0<br />[237767.580000] ---&gt; InitFrequencyCalibration<br />[237767.590000] InitFrequencyCalibration: frequency offset in the EEPROM = 33</p><p>The device is recognised and up<br />root@OpenWrt:/# ifconfig ra0<br />ra0&nbsp; &nbsp; &nbsp; &nbsp;Link encap:Ethernet&nbsp; HWaddr 90:F6:52:17:0E:12&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:0 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000 <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:0 (0.0 B)&nbsp; TX bytes:0 (0.0 B)<br />root@OpenWrt:/# iwconfig ra0<br />ra0&nbsp; &nbsp; &nbsp; &nbsp;Ralink STA&nbsp; ESSID:&quot;11n-AP&quot;&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Mode:Auto&nbsp; Frequency=2.412 GHz&nbsp; Access Point: Not-Associated&nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Bit Rate:1 Mb/s&nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RTS thr:off&nbsp; &nbsp;Fragment thr:off<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Encryption key:off<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Link Quality=10/100&nbsp; Signal level:0 dBm&nbsp; Noise level:0 dBm<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Rx invalid nwid:0&nbsp; Rx invalid crypt:0&nbsp; Rx invalid frag:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Tx excessive retries:0&nbsp; Invalid misc:0&nbsp; &nbsp;Missed beacon:0</p><p>But no connection could be made, and no scanning result<br />root@OpenWrt:/# iwlist ra0 scanning<br />ra0&nbsp; &nbsp; &nbsp; &nbsp;No scan results</p><p>Am I missing something, doing something wrong, or this driver needs a patch for mips ?</p><p>P.S.<br />On linux x86 platform same device with the same driver works.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186158">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">keinz</div>
					<div class="post-datetime">
						15 Dec 2012, 19:10					</div>
				</div>
				<div class="post-content content">
					<p>*kick* </p><p>I&#039;m trying the same thing.. Did you already succeeded with this? I can&#039;t even succesfully compile the driver...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p187027">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">matteone</div>
					<div class="post-datetime">
						26 Dec 2012, 12:34					</div>
				</div>
				<div class="post-content content">
					<p>same problem here with TP-LINK TL-WDN3200 - (Ralink rt5572)<br />got the driver sources from Ralink and compiled no problem on Ubuntu 12.10 and it works perfectly too<br />compiled on openwrt trunk for ar71xx successfully but when I try to get the interface up:</p><p>&lt;4&gt;[&nbsp; 222.210000] &lt;-- RTMPAllocTxRxRingMemory, Status=0<br />&lt;4&gt;[&nbsp; 222.280000] --&gt;RTUSBVenderReset<br />&lt;4&gt;[&nbsp; 222.730000] Key1Str is Invalid key length(0) or Type(0)<br />&lt;4&gt;[&nbsp; 222.740000] Key2Str is Invalid key length(0) or Type(0)<br />&lt;4&gt;[&nbsp; 222.750000] Key3Str is Invalid key length(0) or Type(0)<br />&lt;4&gt;[&nbsp; 222.750000] Key4Str is Invalid key length(0) or Type(0)<br />&lt;4&gt;[&nbsp; 222.760000] 1. Phy Mode = 5<br />&lt;4&gt;[&nbsp; 222.760000] 2. Phy Mode = 5<br />&lt;4&gt;[&nbsp; 222.760000] NVM is Efuse and its size =3c[3c0-3fb] <br />&lt;4&gt;[&nbsp; 222.810000] Power = a0a<br />&lt;4&gt;[&nbsp; 222.810000] Power2 = d0d<br />&lt;4&gt;[&nbsp; 222.830000] Power = b0b<br />&lt;4&gt;[&nbsp; 222.830000] Power2 = d0d<br />&lt;4&gt;[&nbsp; 222.900000] AntCfgInit: primary/secondary ant 0/1<br />&lt;4&gt;[&nbsp; 222.900000] bAutoTxAgcG = 0<br />&lt;4&gt;[&nbsp; 222.930000] ---&gt; InitFrequencyCalibration<br />&lt;4&gt;[&nbsp; 222.960000] MCS Set = ff ff 00 00 01<br />&lt;4&gt;[&nbsp; 222.970000] &lt;==== rt28xx_init, Status=0<br />&lt;4&gt;[&nbsp; 223.230000] Invalid Frame Type!!!<br />&lt;4&gt;[&nbsp; 223.570000] Invalid Frame Type!!!<br />&lt;4&gt;[&nbsp; 224.080000] Invalid Frame Type!!!<br />&lt;4&gt;[&nbsp; 224.590000] Invalid Frame Type!!!</p><p>and then the router (tplink WDR4300) reboots...anyone trying to port this driver to openwrt?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p233508">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Top-Dog</div>
					<div class="post-datetime">
						15 May 2014, 06:08					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m trying a similar thing, trying to get 5 GHz on my Carambola2 (AR9331 SoC, also mips) with a USB Tplink Tl-WDN3200 (based on RT5572). Firstly, what changes need to made to the makefile? And, what parameters need to be used to &#039;make&#039; the driver? Just these (below), or something different...? Any help would be appreciated. </p><br /><p>-changes in Makefile:<br />PLATFORM = INF_AR9<br />LINUX_SRC = /home/ivan/work/openwrt/trunk/build_dir/linux-ar71xx_generic/linux-3.3.8/<br />CROSS_COMPILE = /home/ivan/work/openwrt/trunk/staging_dir/toolchain-mips_r2_gcc-4.6-linaro_uClibc-0.9.33.2/bin/mips-openwrt-linux-uclibc-<br />-compile:<br />make ARCH=&quot;mips&quot;</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p234694">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">Top-Dog</div>
					<div class="post-datetime">
						27 May 2014, 08:50					</div>
				</div>
				<div class="post-content content">
					<p>bump. I really need an answer this week</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>