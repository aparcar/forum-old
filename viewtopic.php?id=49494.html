<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> why l2tp connected at first and then disconnected?(solved)</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 13 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p227505">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">xgyc2802</div>
					<div class="post-datetime">
						13 Mar 2014, 11:22					</div>
				</div>
				<div class="post-content content">
					<p>Hi all,<br />&nbsp; &nbsp; &nbsp; &nbsp;I installed xl2tp on my DIR-615 d3 router and added a new interface &#039;vpn&#039; for the l2tp connection, but it failed. In the system log, I read that:<br />Sep&nbsp; 8 23:48:12 OpenWrt daemon.info xl2tpd[782]: Listening on IP address 0.0.0.0, port 1701<br />Sep&nbsp; 8 23:48:12 OpenWrt daemon.notice xl2tpd[782]: Connecting to host lns.zju.edu.cn, port 1701<br />Sep&nbsp; 8 23:48:12 OpenWrt daemon.notice xl2tpd[782]: Connection established to 10.5.1.5, 1701.&nbsp; Local: 49490, Remote: 2898 (ref=0/0).<br />Sep&nbsp; 8 23:48:12 OpenWrt daemon.notice xl2tpd[782]: Calling on tunnel 49490<br />Sep&nbsp; 8 23:48:12 OpenWrt daemon.notice xl2tpd[782]: Call established with 10.5.1.5, Local: 30501, Remote: 62500, Serial: 1 (ref=0/0)<br />Sep&nbsp; 8 23:48:16 OpenWrt daemon.info pppd[786]: CHAP authentication succeeded<br />Sep&nbsp; 8 23:48:16 OpenWrt daemon.notice pppd[786]: CHAP authentication succeeded<br />Sep&nbsp; 8 23:48:16 OpenWrt user.info sysinit: Loading zones<br />Sep&nbsp; 8 23:48:16 OpenWrt daemon.notice pppd[786]: local&nbsp; IP address 222.205.14.28<br />Sep&nbsp; 8 23:48:16 OpenWrt daemon.notice pppd[786]: remote IP address 10.5.1.5<br />Sep&nbsp; 8 23:48:16 OpenWrt daemon.notice pppd[786]: primary&nbsp; &nbsp;DNS address 10.10.0.21<br />Sep&nbsp; 8 23:48:16 OpenWrt daemon.notice pppd[786]: secondary DNS address 10.10.2.21<br />Sep&nbsp; 8 23:48:16 OpenWrt daemon.notice netifd: Interface &#039;vpn&#039; is now up</p><br /><br /><p>So I think the l2tp connection is ok, but then...</p><br /><br /><br /><p>Sep&nbsp; 8 23:48:31 OpenWrt daemon.crit xl2tpd[1239]: setsockopt recvref[30]: Protocol not available<br />Sep&nbsp; 8 23:48:31 OpenWrt daemon.info xl2tpd[1239]: Using l2tp kernel support.<br />Sep&nbsp; 8 23:48:31 OpenWrt daemon.info xl2tpd[1240]: consider_pidfile: There&#039;s already a xl2tpd server running.<br />Sep&nbsp; 8 23:48:31 OpenWrt daemon.notice netifd: Interface &#039;vpn&#039; has lost the connection<br />Sep&nbsp; 8 23:48:31 OpenWrt daemon.info xl2tpd[782]: Disconnecting from 10.5.1.5, Local: 49490, Remote: 2898<br />Sep&nbsp; 8 23:48:31 OpenWrt daemon.debug xl2tpd[782]: Terminating pppd: sending TERM signal to pid 786<br />Sep&nbsp; 8 23:48:31 OpenWrt daemon.info xl2tpd[782]: Connection 2898 closed to 10.5.1.5, port 1701 (Goodbye!)<br />Sep&nbsp; 8 23:48:31 OpenWrt daemon.info pppd[786]: Terminating on signal 15<br />Sep&nbsp; 8 23:48:31 OpenWrt daemon.info pppd[786]: Connect time 0.3 minutes.<br />Sep&nbsp; 8 23:48:31 OpenWrt daemon.info pppd[786]: Sent 0 bytes, received 0 bytes.<br />Sep&nbsp; 8 23:48:31 OpenWrt daemon.notice pppd[786]: Connection terminated.<br />Sep&nbsp; 8 23:48:31 OpenWrt daemon.info xl2tpd[782]: Can not find tunnel 49490 (refhim=0)<br />Sep&nbsp; 8 23:48:31 OpenWrt daemon.debug xl2tpd[782]: network_thread: unable to find call or tunnel to handle packet.&nbsp; call = 30501, tunnel = 49490 Dumping.<br />Sep&nbsp; 8 23:48:31 OpenWrt daemon.notice netifd: Interface &#039;vpn&#039; is now down<br />Sep&nbsp; 8 23:48:31 OpenWrt daemon.notice netifd: wan (585): Received SIGTERM</p><br /><p>After that, the l2tp can&#039;t be connected any more. The system log says: No such tunnel &#039;l2tp-vpn&#039;. What&#039;s the matter?<br />Thanks very much in advance!</p>											<p class="post-edited">(Last edited by <strong>xgyc2802</strong> on 27 Mar 2014, 12:22)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p227507">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">xgyc2802</div>
					<div class="post-datetime">
						13 Mar 2014, 11:50					</div>
				</div>
				<div class="post-content content">
					<p>Now I solve the problem. Something is wrong with the DNS. <br />In Network--DHCP and DNS, uncheck &quot;Discard upstream RFC1918 responses&quot;, save and apply.<br />Everything is OK.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>