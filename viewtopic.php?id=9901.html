<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Fonera mixed mode (AP+mesh)</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 29 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p44526">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">onebit</div>
					<div class="post-datetime">
						16 Mar 2007, 09:46					</div>
				</div>
				<div class="post-content content">
					<p>On fonera with latest kamikaze I try this configuration to have an <strong>access point</strong> and an <strong>adhoc</strong> mesh node on same atheros wireless card.</p><p><strong>/etc/config/wireless</strong><br /></p><div class="quotebox"><blockquote><p>config wifi-device wifi0<br />&nbsp; &nbsp; &nbsp; &nbsp; option type atheros<br />&nbsp; &nbsp; &nbsp; &nbsp; option channel 5</p><p>config wifi-iface<br />&nbsp; &nbsp; &nbsp; &nbsp; option device wifi0<br />&nbsp; &nbsp; &nbsp; &nbsp; option network lan<br />&nbsp; &nbsp; &nbsp; &nbsp; option mode ap<br />&nbsp; &nbsp; &nbsp; &nbsp; option ssid testap<br />&nbsp; &nbsp; &nbsp; &nbsp; option encryption none<br />&nbsp; &nbsp; &nbsp; &nbsp; option hidden 0</p><p>config wifi-iface<br />&nbsp; &nbsp; &nbsp; &nbsp; option device wifi0<br />&nbsp; &nbsp; &nbsp; &nbsp; option mode adhoc<br />&nbsp; &nbsp; &nbsp; &nbsp; option ssid testmesh<br />&nbsp; &nbsp; &nbsp; &nbsp; option encryption none<br />&nbsp; &nbsp; &nbsp; &nbsp; option hidden 0</p></blockquote></div><p>But with /<em>sbin/wifi up</em> I get an error:</p><div class="quotebox"><blockquote><p>wifi0: Invalid mode combination in config<br />wlanconfig: ioctl: Input/output error<br />enable_atheros(wifi0): Failed to set up adhoc vif</p></blockquote></div><p>What is my mistake?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p44546">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">thepeople</div>
					<div class="post-datetime">
						16 Mar 2007, 15:18					</div>
				</div>
				<div class="post-content content">
					<p>if you use a ad-hoc interface on a card it can be the only interface, no other vap&#039;s are allowed</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p44548">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Wallace78</div>
					<div class="post-datetime">
						16 Mar 2007, 15:19					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>onebit wrote:</cite><blockquote><p>On fonera with latest kamikaze I try this configuration to have an <strong>access point</strong> and an <strong>adhoc</strong> mesh node on same atheros wireless card.<br />...<br />What is my mistake?</p></blockquote></div><p>A few time ago I read somewhere (openwrt wiki?) that you can&#039;t mix adhoc and ap modes... there are also other virtualizing limits (maximum number of APs and STAs; check the wiki and/or the forum). I still don&#039;t know why, but I think is a sort of &quot;hard limit&quot;.<br />I come to the forum right now to search a bit before loosing myself into the code...</p><p>Please report here if you succeded in such thing.</p><p>ciao</p><p>Wallace</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p44549">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">thepeople</div>
					<div class="post-datetime">
						16 Mar 2007, 15:20					</div>
				</div>
				<div class="post-content content">
					<p><a href="http://nbd.name/openwrt.html#x1-100001.2.2">http://nbd.name/openwrt.html#x1-100001.2.2</a> it is a driver limitation</p>											<p class="post-edited">(Last edited by <strong>thepeople</strong> on 16 Mar 2007, 15:21)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p44588">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">Wallace78</div>
					<div class="post-datetime">
						17 Mar 2007, 01:12					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>thepeople wrote:</cite><blockquote><p><a href="http://nbd.name/openwrt.html#x1-100001.2.2">http://nbd.name/openwrt.html#x1-100001.2.2</a> it is a driver limitation</p></blockquote></div><p>What do you mean for &quot;driver limitation&quot;? It&#039;s the Atheros HAL, the madwifi driver or something else?</p><p>ciao</p><p>Wallace</p><p>p.s.: thanks for the nbd page, I didn&#039;t know it, and there are a lot of usefull developers infos!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p44592">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Wallace78</div>
					<div class="post-datetime">
						17 Mar 2007, 01:31					</div>
				</div>
				<div class="post-content content">
					<p>What I found out searching a little bit:</p><p>- Atheros chipsets can do it: ad-hoc and AP mode togheter with one radio. This beacouse Roofnet guys do it.<br />- Here the their madwifi.stripped <a href="http://pdos.lcs.mit.edu/~jbicket/madwifi.stripped/">http://pdos.lcs.mit.edu/~jbicket/madwifi.stripped/</a> . It is described as a &quot;device driver for Atheros chipsets which allows you to send and receive pure 802.11 frames, as opposed to 802.3 (normal ethernet) frames. This allows you to build your own access point with specific policy or algorithms.&quot;<br />- As far as I can understand they do it using Click... a dependancy that maybe can be avoided.<br />- nbd more than one year ago told me on the forum that it wasn&#039;t possible to do in on broadcom hardware (no WRT54G, Asus wl500g, and so on).</p><p>So we have to have a look at Roofnet/Meraki code to see if it is possible to port this feature to madwifi head! Am I right?</p><p>ciao</p><p>Wallace</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p44615">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">danversj</div>
					<div class="post-datetime">
						17 Mar 2007, 12:13					</div>
				</div>
				<div class="post-content content">
					<p>Having an adhoc and infrastructue-mode on the same interface would be useful, but I don&#039;t think it&#039;s essential to forming a mesh network - Freifunk has proved that it can all be done in adhoc mode alone.&nbsp; Of course, outsiders to the mesh network might feel more comfortable associating with an access point rather than an adhoc network.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p44623">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">Kevin</div>
					<div class="post-datetime">
						17 Mar 2007, 13:57					</div>
				</div>
				<div class="post-content content">
					<p>you can also do it in infrastructure mode alone, of course, if you have control over the mesh design</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p44657">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">danversj</div>
					<div class="post-datetime">
						17 Mar 2007, 23:22					</div>
				</div>
				<div class="post-content content">
					<p>Yeah, it depends on what sort of organisation is behind the mesh network.&nbsp; If it is a company or organisation controlling the network hardware, then you can specify what hardware everyone uses.&nbsp; If it is a community mesh where everyone brings their own equipment, you are kind-of forced to use the lowest common denominator in hardware and wireless protocols.</p><p>Adhoc on Channel 10 works for everyone, no matter what hardware they&#039;ve got.&nbsp; Of course, it helps if the wireless drivers can force a BSSID, or you get BSSID splits which is what happened in Freifunk before Sven-Ola added the fixed-BSSID to the wl driver.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p44686">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">Mitar</div>
					<div class="post-datetime">
						18 Mar 2007, 16:28					</div>
				</div>
				<div class="post-content content">
					<p>I am also interested in such ap/ad-hoc configuration. This could attract more people to our community wireless network.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p44687">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">Wallace78</div>
					<div class="post-datetime">
						18 Mar 2007, 16:52					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>danversj wrote:</cite><blockquote><p>Having an adhoc and infrastructue-mode on the same interface would be useful, but I don&#039;t think it&#039;s essential to forming a mesh network - Freifunk has proved that it can all be done in adhoc mode alone.&nbsp; Of course, outsiders to the mesh network might feel more comfortable associating with an access point rather than an adhoc network.</p></blockquote></div><p>There are some flaws in doing it in ad-hoc only. As an example in ad-hoc there&#039;s no OFDM (54mbit!)... and having two interfaces it seems better to me, as an example for QoS purposes, or to split the wireless side into public/private as FON does. It&#039;s a matter of flexibility...<br />If I could at least access to the Fonera, set one virtual AP to ad-hoc, and load my software in it, I would keep the Fonera into the FON social network (keeping the FON_* ssid for foneros usage and doing my own business on the other virtual ap)... instead now I&#039;m obliged to remove their firmware beacouse it&#039;s useless to me. Having them using (support) standard OpenWrt distro would be even better... I don&#039;t like this way to use open projects... I prefer companies that contribute to head development instead of forking (moreover I know that OpenWrt developers are very kind, if one send them patches and features compatible with their guidelines they apply them in short time; as an example nbd spent a lot of time with me to add meshing capabilities to qos-scripts!).</p><p>Anyway, I found also a note from Sven-Ola (on his server there&#039;s a dir with freifunk packages compiled for FON firmware) saying that ad-hoc+AP works (unstable, but works).<br />It would be nice to port this feature into OpenWrt.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p44694">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">Mitar</div>
					<div class="post-datetime">
						18 Mar 2007, 18:25					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Wallace78 wrote:</cite><blockquote><p>Anyway, I found also a note from Sven-Ola (on his server there&#039;s a dir with freifunk packages compiled for FON firmware) saying that ad-hoc+AP works (unstable, but works).<br />It would be nice to port this feature into OpenWrt.</p></blockquote></div><p>Do you know what are the differences they did? Or why is it possible with their firmware?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p44700">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">Wallace78</div>
					<div class="post-datetime">
						18 Mar 2007, 20:03					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Mitar wrote:</cite><blockquote><div class="quotebox"><cite>Wallace78 wrote:</cite><blockquote><p>Anyway, I found also a note from Sven-Ola (on his server there&#039;s a dir with freifunk packages compiled for FON firmware) saying that ad-hoc+AP works (unstable, but works).<br />It would be nice to port this feature into OpenWrt.</p></blockquote></div><p>Do you know what are the differences they did? Or why is it possible with their firmware?</p></blockquote></div><p>No, I don&#039;t. All I got is here:</p><p><a href="http://olsrexperiment.de/sven-ola/fonera/">http://olsrexperiment.de/sven-ola/fonera/</a></p><p>&quot;Known Problems: Adhoc+Mastermode does not work perfect, some wifi cards<br />do not want to cooperate (at least my atheros/madwifi does not see the<br />Hotspot with kubunu nor do it see the WPA &quot;MyPlace&quot;). A centrino IPW2100<br />and a Siemens-Atheros-USB (ndiswrapper) work fine. Ad-hoc is fine too now. <br />You also need to put FF_IP=x.x.x.x in /etc/init.d/S80freifunk currently.&quot;</p><p>The diffs are in one of the packages in that dir... maybe in one of:</p><p>kmod-madwifi_2.4.32+0.9.0-ar531x-1_mips.ipk&nbsp; <br />hostapd-mini_0.5.5-1_mips.ipk <br />ff-fonera-pack_0.2-1_mips.ipk&nbsp; <br />base-files-ar531x-2.4_8-0_mips.ipk</p><p>Didn&#039;t have time to look at them (and I don&#039;t know where to get sources; last time I found the Freifunk CVS, one year ago, it was quite messy!).</p><p>ciao</p><p>Wallace</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p44778">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">lan</div>
					<div class="post-datetime">
						19 Mar 2007, 22:30					</div>
				</div>
				<div class="post-content content">
					<p>Hi everybody, I tested Ad-hoc+ap on meraki and it works! But the SDK has lots of problems and there&#039;s no docs <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /> Is there any plan of embedding these features on OpenWRT? If there&#039;s any, how long will it take (approx.)?</p><p>Ciao</p><p>lan</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p44823">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">Mitar</div>
					<div class="post-datetime">
						20 Mar 2007, 11:12					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Wallace78 wrote:</cite><blockquote><p>Didn&#039;t have time to look at them (and I don&#039;t know where to get sources; last time I found the Freifunk CVS, one year ago, it was quite messy!).</p></blockquote></div><p>Maybe this could help?</p><p><a href="http://download.fon.com/firmware/fonera/latest/fonera.tar.bz2">http://download.fon.com/firmware/fonera … ra.tar.bz2</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45227">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">zabi</div>
					<div class="post-datetime">
						26 Mar 2007, 11:49					</div>
				</div>
				<div class="post-content content">
					<p>This kinda sounds intresting i tried AP+adhoc&nbsp; with madwifi on openwrt....when i have an AP first it fails (thats also whats said on madwifi docs)...but if i have adhoc first and then i create a Ap (VAP) on it it works.....a bit unstable tho but works on my raw openwrt and madwifi by just using wlanconfig.<br />Anyhow its got issues like same channel should be used for adhoc and AP etc which i dont think should be the case.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45236">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">Mitar</div>
					<div class="post-datetime">
						26 Mar 2007, 16:54					</div>
				</div>
				<div class="post-content content">
					<p>Can you post some configuration and exact versions of your modules?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45280">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">Wallace78</div>
					<div class="post-datetime">
						27 Mar 2007, 02:56					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Ian wrote:</cite><blockquote><p>Hi everybody, I tested Ad-hoc+ap on meraki and it works!</p></blockquote></div><p>The guys at Roofnet (Meraki parent) rewrote a part of l2 of the madwifi driver... they got it working a long time ago...</p><div class="quotebox"><cite>Mitar wrote:</cite><blockquote><p>Maybe this could help?</p><p><a href="http://download.fon.com/firmware/fonera">http://download.fon.com/firmware/fonera</a> ? ra.tar.bz2</p></blockquote></div><p>I was referring to the Freifunk code!</p><div class="quotebox"><cite>zabi wrote:</cite><blockquote><p>Anyhow its got issues like same channel should be used for adhoc and AP etc which i dont think should be the case.</p></blockquote></div><p>That&#039;s not an issue... remember that you only have one radio (one channel)! Having two ssids doesn&#039;t mean you have two radios (nor double troughput)!</p><p>ciao</p><p>Wallace78</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45293">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">zabi</div>
					<div class="post-datetime">
						27 Mar 2007, 09:50					</div>
				</div>
				<div class="post-content content">
					<p>I tried it on madwifi(0.9.2.1) and openwrt kamikaze (x86).<br />Its pretty basic; wlanconfig create ath wlandev wifi0 wlanmode adhoc ; wlanconfig create ath wlandev wifi0 wlanmode ap ;</p><p>True asking for multiple channels from one server is illogical...but what i meant was wouldn&#039;t the performance be affected dues to same channel presence esp in a mesh where in multiple nodes and access points and clients are on same channel ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46484">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">datacop</div>
					<div class="post-datetime">
						15 Apr 2007, 20:16					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>zabi wrote:</cite><blockquote><p>True asking for multiple channels from one server is illogical...but what i meant was wouldn&#039;t the performance be affected dues to same channel presence esp in a mesh where in multiple nodes and access points and clients are on same channel ?</p></blockquote></div><p>it will reduce the performance of course, but speed is not always essential. <br />For example i got a mesh routing connection over 2,2 km, and the maximal throughput is about 400kb/s, so there should be enough space for other connections.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p48287">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">yapoo</div>
					<div class="post-datetime">
						12 May 2007, 15:41					</div>
				</div>
				<div class="post-content content">
					<p>Hi, everyone.</p><p>A little while ago, a patch of CLICK was submitted.<br /><a href="https://dev.openwrt.org/changeset/7196">https://dev.openwrt.org/changeset/7196</a><br />Does this boost this topic? Does this make adhoc &amp; ap mode of atheros module more reliable?</p><p>zukky</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p49086">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">danversj</div>
					<div class="post-datetime">
						25 May 2007, 10:39					</div>
				</div>
				<div class="post-content content">
					<p>I can get Adhoc+master mode working if I don&#039;t use the OpenWRT routines for setting up wireless - i.e - /etc/config/wireless and &quot;wifi up&quot;.</p><p>I am using a Meraki Mini with Kamikaze snapshot from 17 May 2007.<br />Here is <strong>/etc/config/network</strong><br /></p><div class="codebox"><pre><code># Copyright (C) 2006 OpenWrt.org

config interface loopback
        option ifname   lo
        option proto    static
        option ipaddr   127.0.0.1
        option netmask  255.0.0.0

config interface lan
        option type     bridge
        option ifname   eth0 ath2
        option proto    static
        option ipaddr   192.168.1.1
        option netmask  255.255.255.0

config interface mesh
        option ifname   ath0
        option proto    static
        option ipaddr   10.10.255.254
        option netmask  255.255.0.0

config interface wifi
        option ifname   ath1
        option proto    static
        option ipaddr   10.10.200.1
        option netmask  255.255.255.240</code></pre></div><p>and <strong>/etc/config/wireless</strong></p><div class="codebox"><pre><code>config wifi-device  wifi0
        option type     atheros
        option channel  5
#       option diversity 1
#       option txantenna 0
#       option rxantenna 0
#       option distance  2000
# disable radio to prevent an open ap after reflashing:
        option disabled 0


config wifi-iface
        option device   wifi0
        option network  mesh
        option mode     adhoc
        option ssid     dans_mesh
        option hidden   0
        option txpower  15
        option bgscan   enable
        option encryption none

config wifi-iface
        option device   wifi0
        option network  wifi
        option mode     ap
        option ssid     dans_open_network
        option hidden   0

config wifi-iface
        option device   wifi0
        option network  lan
        option mode     ap
        option ssid     dans_LAN
        option hidden   0</code></pre></div><p>if I let the OpenWRT init scripts handle this I get this situation</p><div class="codebox"><pre><code>root@OpenWrt:/# wifi up
wifi0: Invalid mode combination in config
root@OpenWrt:/# iwconfig
eth0      no wireless extensions.

lo        no wireless extensions.

br-lan    no wireless extensions.

wifi0     no wireless extensions.

ath0      IEEE 802.11g  ESSID:&quot;&quot;  Nickname:&quot;&quot;
          Mode:Ad-Hoc  Frequency:2.432 GHz  Cell: 02:18:0A:01:20:67
          Bit Rate:0 kb/s   Tx-Power=15 dBm   Sensitivity=0/3
          Retry:off   RTS thr:off   Fragment thr:off
          Encryption key:off
          Power Management:off
          Link Quality=0/94  Signal level=-94 dBm  Noise level=-94 dBm
          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:0   Missed beacon:0

ath1      IEEE 802.11g  ESSID:&quot;dans_open_network&quot;  Nickname:&quot;&quot;
          Mode:Master  Frequency:2.432 GHz  Access Point: 06:18:0A:01:20:67
          Bit Rate:0 kb/s   Tx-Power=15 dBm   Sensitivity=0/3
          Retry:off   RTS thr:off   Fragment thr:off
          Encryption key:off
          Power Management:off
          Link Quality=0/94  Signal level=-94 dBm  Noise level=-94 dBm
          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:0   Missed beacon:0

ath2      IEEE 802.11g  ESSID:&quot;dans_LAN&quot;  Nickname:&quot;&quot;
          Mode:Master  Frequency:2.432 GHz  Access Point: 0A:18:0A:01:20:67
          Bit Rate:0 kb/s   Tx-Power=15 dBm   Sensitivity=0/3
          Retry:off   RTS thr:off   Fragment thr:off
          Encryption key:off
          Power Management:off
          Link Quality=0/94  Signal level=-94 dBm  Noise level=-94 dBm
          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:0   Missed beacon:0</code></pre></div><p>the <strong>mesh</strong> interface has no ssid when it should be <strong>dans_mesh</strong>, and I can see but can&#039;t connect to <strong>dans_open_network</strong> and <strong>dans_LAN</strong>.</p><p>If however, I do this:</p><div class="codebox"><pre><code>root@OpenWrt:/# wifi down
wifi0: Invalid mode combination in config
root@OpenWrt:/# wlanconfig ath create wlandev wifi0 wlanmode adhoc
ath0
root@OpenWrt:/# wlanconfig ath create wlandev wifi0 wlanmode ap
ath1
root@OpenWrt:/# wlanconfig ath create wlandev wifi0 wlanmode ap
ath2
root@OpenWrt:/# iwconfig ath0 essid dans_mesh
root@OpenWrt:/# iwconfig ath1 essid dans_open_network
root@OpenWrt:/# iwconfig ath2 essid dans_LAN
root@OpenWrt:/# iwconfig
eth0      no wireless extensions.

lo        no wireless extensions.

br-lan    no wireless extensions.

wifi0     no wireless extensions.

ath0      IEEE 802.11g  ESSID:&quot;dans_mesh&quot;  Nickname:&quot;&quot;
          Mode:Ad-Hoc  Frequency:2.412 GHz  Cell: 02:18:0A:01:20:67
          Bit Rate:0 kb/s   Tx-Power=15 dBm   Sensitivity=0/3
          Retry:off   RTS thr:off   Fragment thr:off
          Encryption key:off
          Power Management:off
          Link Quality=0/94  Signal level=-94 dBm  Noise level=-94 dBm
          Rx invalid nwid:2  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:0   Missed beacon:0

ath1      IEEE 802.11g  ESSID:&quot;dans_open_network&quot;  Nickname:&quot;&quot;
          Mode:Master  Frequency:2.412 GHz  Access Point: 06:18:0A:01:20:67
          Bit Rate:0 kb/s   Tx-Power=15 dBm   Sensitivity=0/3
          Retry:off   RTS thr:off   Fragment thr:off
          Encryption key:off
          Power Management:off
          Link Quality=0/94  Signal level=-94 dBm  Noise level=-94 dBm
          Rx invalid nwid:2  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:0   Missed beacon:0

ath2      IEEE 802.11g  ESSID:&quot;dans_LAN&quot;  Nickname:&quot;&quot;
          Mode:Master  Frequency:2.412 GHz  Access Point: 0A:18:0A:01:20:67
          Bit Rate:0 kb/s   Tx-Power=15 dBm   Sensitivity=0/3
          Retry:off   RTS thr:off   Fragment thr:off
          Encryption key:off
          Power Management:off
          Link Quality=0/94  Signal level=-94 dBm  Noise level=-94 dBm
          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:0   Missed beacon:0

root@OpenWrt:/# ifconfig ath0 up
root@OpenWrt:/# ifconfig ath1 up
root@OpenWrt:/# ifconfig ath2 up</code></pre></div><p>everything seems to work the way I expect - I find it is important to do the <em>ifconfig athX up</em> in the right order or not all the wireless come up (checking from my laptop with NetStumbler).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p49097">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">malbon</div>
					<div class="post-datetime">
						25 May 2007, 13:17					</div>
				</div>
				<div class="post-content content">
					<p>Hi All,<br />The click patch doesn&#039;t do anything other than setup click for roofnet without requireing ath0 to be up or defined. Which is actually bad in some ways as monitor interfaces (which click uses to send raw packets) need to be defined last for them to work.</p><p>Mike</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p49121">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">RalucaM</div>
					<div class="post-datetime">
						26 May 2007, 00:40					</div>
				</div>
				<div class="post-content content">
					<p><strong>danversj:</strong> Are you sure the AP actually works? Playing with the latest kamikaze firmware (may 23rd), I set both interfaces, but the AP doesn&#039;t really work, as I don&#039;t see it when I scan the network. The adhoc interface works fine though, I could connect and talk with other adhoc nodes. Were you able to associate with the AP?</p>											<p class="post-edited">(Last edited by <strong>RalucaM</strong> on 26 May 2007, 00:40)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p49124">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">danversj</div>
					<div class="post-datetime">
						26 May 2007, 04:03					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>RalucaM wrote:</cite><blockquote><p><strong>danversj:</strong> Are you sure the AP actually works? Playing with the latest kamikaze firmware (may 23rd), I set both interfaces, but the AP doesn&#039;t really work, as I don&#039;t see it when I scan the network. The adhoc interface works fine though, I could connect and talk with other adhoc nodes. Were you able to associate with the AP?</p></blockquote></div><p>I could associate with both APs - although I only had DHCP set up on &quot;dans_LAN&quot;.&nbsp; This was with me using the <em>wlanconfig</em> commands.&nbsp; If I used <strong>/etc/config/wireless</strong> and <strong>wifi up</strong> I could not associate to either AP at all.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>