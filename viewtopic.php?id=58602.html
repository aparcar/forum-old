<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Need help getting camera to work with Wansview NCS601W</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 14 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p284339">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Xevious</div>
					<div class="post-datetime">
						21 Jul 2015, 18:09					</div>
				</div>
				<div class="post-content content">
					<p>So I installed 15.05-rc2 on my Wansview NCS601W (ramips / RT3050), but I can&#039;t get the onboard camera to work with motion / mjpeg-streamer / ffmpeg.</p><p>Motion fails with this error:<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# motion -c /etc/motion.conf
[0] [NTC] [ALL] conf_load: Processing thread 0 - config file /etc/motion.conf
[0] [ALR] [ALL] conf_cmdparse: Unknown config option &quot;ffmpeg_output_movies&quot;
[0] [ALR] [ALL] conf_cmdparse: Unknown config option &quot;ffmpeg_output_debug_movies&quot;
[0] [ALR] [ALL] conf_cmdparse: Unknown config option &quot;ffmpeg_timelapse&quot;
[0] [ALR] [ALL] conf_cmdparse: Unknown config option &quot;ffmpeg_timelapse_mode&quot;
[0] [ALR] [ALL] conf_cmdparse: Unknown config option &quot;ffmpeg_bps&quot;
[0] [ALR] [ALL] conf_cmdparse: Unknown config option &quot;ffmpeg_variable_bitrate&quot;
[0] [ALR] [ALL] conf_cmdparse: Unknown config option &quot;ffmpeg_video_codec&quot;
[0] [ALR] [ALL] conf_cmdparse: Unknown config option &quot;ffmpeg_deinterlace&quot;
[0] [ALR] [ALL] conf_cmdparse: Unknown config option &quot;movie_filename&quot;
[0] [ALR] [ALL] conf_cmdparse: Unknown config option &quot;timelapse_filename&quot;
[0] [NTC] [ALL] motion_startup: Motion 3.4.0-Git-78ba2da Started
[0] [NTC] [ALL] motion_startup: Logging to syslog
[0] [NTC] [ALL] motion_startup: Using log type (ALL) log level (NTC)
[0] [NTC] [ALL] main: Thread 1 is from /etc/motion.conf
[0] [NTC] [ALL] main: Thread 1 is device: /dev/video0 input -1
[0] [NTC] [ALL] main: Stream port 8081
[0] [NTC] [ALL] main: Waiting for threads to finish, pid: 4910
[0] [NTC] [STR] httpd_run: motion-httpd testing : IPV4 addr: 127.0.0.1 port: 8080
[0] [NTC] [STR] httpd_run: motion-httpd Bound : IPV4 addr: 127.0.0.1 port: 8080
[0] [NTC] [STR] httpd_run: motion-httpd/3.4.0-Git-78ba2da running, accepting connections
[0] [NTC] [STR] httpd_run: motion-httpd: waiting for data on 127.0.0.1 port TCP 8080
[1] [NTC] [ALL] motion_init: Thread 1 started , motion detection Enabled
[1] [NTC] [VID] vid_v4lx_start: Using videodevice /dev/video0 and input -1
[1] [NTC] [VID] v4l2_get_capability:
---------------------
cap.driver: &quot;uvcvideo&quot;
cap.card: &quot;UVC Camera (1b3b:2975)&quot;
cap.bus_info: &quot;usb-101c1000.ohci-1&quot;
cap.capabilities=0x84000001
---------------------
[1] [NTC] [VID] v4l2_get_capability: - VIDEO_CAPTURE
[1] [NTC] [VID] v4l2_get_capability: - STREAMING
[1] [NTC] [VID] v4l2_select_input: name = &quot;Camera 1&quot;, type 0x00000002, status 00000000
[1] [NTC] [VID] v4l2_select_input: - CAMERA
[1] [WRN] [VID] v4l2_select_input: Device doesn&#039;t support VIDIOC_G_STD
[1] [NTC] [VID] v4l2_set_pix_format: Config palette index 17 (YU12) doesn&#039;t work.
[1] [NTC] [VID] v4l2_set_pix_format: Supported palettes:
[1] [NTC] [VID] v4l2_set_pix_format: (0) MJPG (MJPEG)
[1] [NTC] [VID] v4l2_set_pix_format: 0 - MJPEG (compressed : 1) (0x47504a4d)
[1] [NTC] [VID] v4l2_set_pix_format Selected palette MJPG
[1] [ERR] [VID] VIDIOC_TRY_FMT failed for format v4l2_set_pix_format: Input/output error
[1] [ERR] [VID] v4l2_set_pix_format: Unable to find a compatible palette format.
[1] [NTC] [VID] vid_v4lx_start: Using V4L1
[1] [NTC] [ALL] image_ring_resize: Resizing pre_capture buffer to 1 items
[1] [ERR] [ALL] motion_init: Error capturing first image
[1] [NTC] [STR] http_bindsock: motion-stream testing : IPV4 addr: 127.0.0.1 port: 8081
[1] [NTC] [STR] http_bindsock: motion-stream Bound : IPV4 addr: 127.0.0.1 port: 8081
[1] [NTC] [ALL] motion_init: Started motion-stream server in port 8081 auth Disabled
[1] [ERR] [ALL] motion_loop: Video device fatal error - Closing video device
[1] [NTC] [VID] vid_close: Closing video device /dev/video0</code></pre></div><p>I tried all the palette options in /etc/motion.conf, but I always get an error as above.</p><p>The output of &quot;v4l2-ctl --info --all&quot; is:<br /></p><div class="codebox"><pre><code>Driver Info (not using libv4l2):
        Driver name   : uvcvideo
        Card type     : UVC Camera (1b3b:2975)
        Bus info      : usb-101c1000.ohci-1
        Driver version: 3.18.18
        Capabilities  : 0x84000001
                Video Capture
                Streaming
                Device Capabilities
        Device Caps   : 0x04000001
                Video Capture
                Streaming
Priority: 2
Video input : 0 (Camera 1: ok)
Format Video Capture:
        Width/Height  : 640/480
        Pixel Format  : &#039;MJPG&#039;
        Field         : None
        Bytes per Line: 0
        Size Image    : 307712
        Colorspace    : SRGB
Crop Capability Video Capture:
        Bounds      : Left 0, Top 0, Width 640, Height 480
        Default     : Left 0, Top 0, Width 640, Height 480
        Pixel Aspect: 1/1
Streaming Parameters Video Capture:
        Capabilities     : timeperframe
        Frames per second: 30.000 (30/1)
        Read buffers     : 0
                     brightness (int)    : min=1 max=255 step=1 default=132 value=132
                       contrast (int)    : min=0 max=255 step=1 default=32 value=32
                     saturation (int)    : min=0 max=255 step=1 default=64 value=64
                            hue (int)    : min=-90 max=90 step=1 default=0 value=0
                          gamma (int)    : min=5 max=30 step=5 default=30 value=30
           power_line_frequency (menu)   : min=0 max=2 default=2 value=2
                      sharpness (int)    : min=0 max=15 step=1 default=2 value=2
         backlight_compensation (int)    : min=0 max=1 step=1 default=0 value=0
                   pan_absolute (int)    : min=-648000 max=648000 step=3600 default=0 value=0
                  tilt_absolute (int)    : min=-648000 max=648000 step=3600 default=0 value=0
                  zoom_absolute (int)    : min=1 max=3 step=1 default=1 value=1
                  iris_absolute (int)    : min=0 max=6 step=1 default=6 value=6
                     brightness (int)    : min=1 max=255 step=1 default=132 value=132
                       contrast (int)    : min=0 max=255 step=1 default=32 value=32
                     saturation (int)    : min=0 max=255 step=1 default=64 value=64
                            hue (int)    : min=-90 max=90 step=1 default=0 value=0
                          gamma (int)    : min=5 max=30 step=5 default=30 value=30
           power_line_frequency (menu)   : min=0 max=2 default=2 value=2
                      sharpness (int)    : min=0 max=15 step=1 default=2 value=2
         backlight_compensation (int)    : min=0 max=1 step=1 default=0 value=0</code></pre></div><p>All I got to work is grab a single image with the command&nbsp; &quot;v4l2-ctl&nbsp; --stream-count=1 --stream-to=/tmp/test.jpg&quot;</p><p>Any suggestions how to get a stream from this device, preferrably using motion?</p>											<p class="post-edited">(Last edited by <strong>Xevious</strong> on 21 Jul 2015, 18:10)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p284497">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Xevious</div>
					<div class="post-datetime">
						22 Jul 2015, 13:02					</div>
				</div>
				<div class="post-content content">
					<p>With mjpeg-streamer, I get the following errors:</p><div class="codebox"><pre><code>root@OpenWrt:~# mjpg_streamer -i &quot;input_uvc.so -d /dev/video0&quot; -o &quot;output_http.so&quot;
MJPG Streamer Version: svn rev: Unversioned directory
 i: Using V4L2 device.: /dev/video0
 i: Desired Resolution: 640 x 480
 i: Frames Per Second.: not limited
 i: Format............: JPEG
 i: TV-Norm...........: DEFAULT
Unable to set format: 1196444237 res: 640x480
 Init v4L2 failed !! exit fatal 
 i: init_VideoIn failed</code></pre></div><div class="codebox"><pre><code>root@OpenWrt:~# mjpg_streamer -i &quot;input_uvc.so -d /dev/video0 -y&quot; -o &quot;output_http.so&quot;
MJPG Streamer Version: svn rev: Unversioned directory
 i: Using V4L2 device.: /dev/video0
 i: Desired Resolution: 640 x 480
 i: Frames Per Second.: 15
 i: Format............: YUYV
 i: JPEG Quality......: 80
 i: TV-Norm...........: DEFAULT
Unable to set format: 1448695129 res: 640x480
 Init v4L2 failed !! exit fatal 
 i: init_VideoIn failed</code></pre></div><p>And it also leaves an error in syslog:<br /></p><div class="codebox"><pre><code>[ 1616.930000] uvcvideo: Failed to query (130) UVC probe control : -32 (exp. 26).</code></pre></div><p>Any suggestions?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p284828">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Xevious</div>
					<div class="post-datetime">
						24 Jul 2015, 14:06					</div>
				</div>
				<div class="post-content content">
					<p>This is the syslog with tracing enabled in the uvcvideo kmod when I try to start motion:</p><div class="codebox"><pre><code>[  225.200000] uvcvideo: uvc_v4l2_open
[  225.200000] uvcvideo: uvc_v4l2_ioctl(VIDIOC_QUERYCAP)
[  225.210000] uvcvideo: uvc_v4l2_ioctl(VIDIOC_ENUMINPUT)
[  225.220000] uvcvideo: uvc_v4l2_ioctl(VIDIOC_S_INPUT)
[  225.220000] uvcvideo: uvc_v4l2_ioctl(VIDIOC_G_STD)
[  225.220000] uvcvideo: Unsupported ioctl 0x40085617
[  225.220000] uvcvideo: uvc_v4l2_ioctl(VIDIOC_TRY_FMT)
[  225.220000] uvcvideo: Trying format 0x32315559 (YU12): 320x240.
[  225.220000] uvcvideo: Using default frame interval 33333.3 us (30.0 fps).
[  225.220000] uvcvideo: Failed to query (130) UVC probe control : -32 (exp. 26).
[  225.240000] uvcvideo: uvc_v4l2_ioctl(VIDIOC_ENUM_FMT)
[  225.240000] uvcvideo: uvc_v4l2_ioctl(VIDIOC_ENUM_FMT)
[  225.250000] uvcvideo: uvc_v4l2_ioctl(VIDIOC_TRY_FMT)
[  225.250000] uvcvideo: Trying format 0x47504a4d (MJPG): 320x240.
[  225.250000] uvcvideo: Using default frame interval 33333.3 us (30.0 fps).
[  225.250000] uvcvideo: Failed to query (130) UVC probe control : -32 (exp. 26).
[  235.310000] uvcvideo: uvc_v4l2_release</code></pre></div>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>