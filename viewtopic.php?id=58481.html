<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> OpenWRT VLAN switch firewall is blocking(PLEASE HELP)</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 18 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p283503">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">xzoli8</div>
					<div class="post-datetime">
						14 Jul 2015, 12:48					</div>
				</div>
				<div class="post-content content">
					<p>Hi there, after a lot of research, discussion on the pfSense forum and testing/trying I decided to ask some support from some OpenWRT network experts to help me out in a configuration which I have been struggeling aprox. 3 weeks.<br />OK,&nbsp; some additional explanation before this issue.</p><p>I&#039;m planning a hotspot network which will consist of an Intel Jetway NF9D IPC running a pfsense router/firewall operating system, one Asus RT-N16 soho router running OpenWRT Barrier Breaker 14.07, also 2 TP-LINK soho routers, an TL-WR1043ND and TL-WDR3600, these last two also run the mentioned OpenWRT firmwares.<br />pfSense acts as a router/firewall, the ASUS RT-N16 as a VLAN switch running OpenWRT, and the other 2 devices will be access points.</p><p>I have setup on the pfSense router one subnet(LAN interface) with 192.168.1.0/24 on one port, I also created a VLAN trunk on another port with 3 VLANs(RLANVID3, WLANVID4, WLANVID5) with VLAN subnets 192.168.3.0/24, 4.0/24, 5.0/24. Then I set up a the ASUS RT-N16 to acts as a VLAN switch, and I also tested the first two VLANs to see it is working properly (for VLAN 3 and VLAN 4 I specified 2 access/untagged ports) on the OpenWRT switch interface. When I connect client devices on these ports I can get IP addresses and I can reach the Internet, it works fine.</p><p>My goal is to access the VLAN switch interface using one VLAN IP address(e.g VLAN3-192.168.3.2/24) via the pfSense LAN subnet(192.168.1.0/24), for this purpose on the OpenWRT VLAN switch interface I tagged the CPU port for VLAN ID 3, I created an interface for the VLAN3 subnet with a static IP address, mentioned earlier.</p><p>The main problem is if I ping that interface IP address from the pfSense router interface I get replies, but if I ping it from the pfSense LAN subnet I can&#039;t get replies, also I can&#039;t access the VLAN3 interface IP(192.168.3.2 is the OpenWRT VLAN3 subnet GUI/shell IP address) neither via http/s or ssh protocols from the pfSense LAN subnet, but I can access it via http/s and ssh from the VLAN3 subnet, so the VLAN switch configuration is good. I think the OpenWRT firewall deny the incomming packets from the pfSense LAN subnet(192.168.1.0/24) which are destined for the VLAN switch VLAN3 IP address(192.168.3.2/24), so I would need an advanced/expert user to help me out in firewall configuration if it is a linux firewall issue in order to be able to access the VLAN switch interface (OpenWRT GUI and shell too).</p><p>Here I added the network diagram, where the red line indicates that I want to access the OpenWRT GUI and shell, also the OpenWRT configuration set up by me:</p><p><a href="http://s24.postimg.org/m6zy2ay11/Hotspot_Network_Diagram_2.jpg">http://s24.postimg.org/m6zy2ay11/Hotspo â€¦ gram_2.jpg</a></p><p>Ping from the GUI and shell:</p><p><a href="http://postimg.org/image/mnjx7kxep/">http://postimg.org/image/mnjx7kxep/</a></p><p><a href="http://postimg.org/image/vewbdoir1/">http://postimg.org/image/vewbdoir1/</a></p><p>VLAN switch configuration:</p><p><a href="http://postimg.org/image/gmghq1w47/">http://postimg.org/image/gmghq1w47/</a></p><p>network interfaces configuration:</p><p><a href="http://postimg.org/image/vyh4ef8cv/">http://postimg.org/image/vyh4ef8cv/</a></p><p>Local LAN interface config:</p><p><a href="http://postimg.org/image/wn1rsjhgn/">http://postimg.org/image/wn1rsjhgn/</a></p><p><a href="http://postimg.org/image/eg09u3s1f/">http://postimg.org/image/eg09u3s1f/</a></p><p><a href="http://postimg.org/image/7y3v2qdsh/">http://postimg.org/image/7y3v2qdsh/</a></p><p>VLAN3 interface config:</p><p><a href="http://postimg.org/image/f5h6dk9zv/">http://postimg.org/image/f5h6dk9zv/</a></p><p><a href="http://postimg.org/image/w5nj4v403/">http://postimg.org/image/w5nj4v403/</a></p><p><a href="http://postimg.org/image/qbwfjf8pp/">http://postimg.org/image/qbwfjf8pp/</a></p>											<p class="post-edited">(Last edited by <strong>xzoli8</strong> on 21 Jul 2015, 21:58)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>