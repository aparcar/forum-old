<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> RB450 - using Five Ethernet Ports</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 6 Feb 2018 and 6 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 9 of 9</div><nav><ul><li><a href="viewtopic.php%3Fid=17501&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=17501&amp;p=7.html">7</a></li><li><a href="viewtopic.php%3Fid=17501&amp;p=8.html">8</a></li><li class="pagination-current"><span>9</span></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p110338">
				<div class="post-metadata">
					<div class="post-num">Post #201</div>
					<div class="post-author">BitBrusher</div>
					<div class="post-datetime">
						1 Jun 2010, 15:26					</div>
				</div>
				<div class="post-content content">
					<p>duvi</p><p>I think, as Patrick said, we both have the same problem: kernel (ag71xx?) <span style="color: #FF0000"> is not config_init&#039;ing</span> the switch.<br/>IP17xx is kind of silent in what it is doing. I myself don´t know anymore what are the original messages. I tampered with the sources a lot.<br/>Module maintainers are already on the way to rescue us! Right, Patrick?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110347">
				<div class="post-metadata">
					<div class="post-num">Post #202</div>
					<div class="post-author">luboznaiko</div>
					<div class="post-datetime">
						1 Jun 2010, 18:27					</div>
				</div>
				<div class="post-content content">
					<p>Hi<br/>I have rb433uah with ip175d chip, with original patch from Martin Mares and revision 19705 i can use my switch with these changes:</p><p>gencho@lamq:~/openwrt$ diff -uaH 19705_orig/target/linux/ar71xx/files/arch/mips/ar71xx/mach-rb-4xx.c 19705/target/linux/ar71xx/files/arch/mips/ar71xx/mach-rb-4xx.c<br/>--- 19705_orig/target/linux/ar71xx/files/arch/mips/ar71xx/mach-rb-4xx.c 2010-05-14 09:15:44.000000000 +0300<br/>+++ 19705/target/linux/ar71xx/files/arch/mips/ar71xx/mach-rb-4xx.c&nbsp; &nbsp; &nbsp; 2010-05-13 18:46:58.000000000 +0300<br/>@@ -213,10 +213,10 @@<br/>&nbsp; &nbsp; &nbsp; &nbsp; rb4xx_generic_setup();<br/>&nbsp; &nbsp; &nbsp; &nbsp; rb433_add_device_spi();</p><p>-&nbsp; &nbsp; &nbsp; &nbsp;ar71xx_add_device_mdio(0xffffffe9);<br/>+&nbsp; &nbsp; &nbsp; &nbsp;ar71xx_add_device_mdio(0xffffffe0);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; ar71xx_eth0_data.phy_if_mode = PHY_INTERFACE_MODE_MII;<br/>-&nbsp; &nbsp; &nbsp; &nbsp;ar71xx_eth0_data.phy_mask = 0x00000006;<br/>+&nbsp; &nbsp; &nbsp; &nbsp;ar71xx_eth0_data.phy_mask = 0x00000001;<br/>&nbsp; &nbsp; &nbsp; &nbsp; ar71xx_eth0_data.speed = SPEED_100;<br/>&nbsp; &nbsp; &nbsp; &nbsp; ar71xx_eth0_data.duplex = DUPLEX_FULL;</p><p>But it&#039;s not possible to configure vlans, ports 1 and 2 works like switch and port 4 is my wan and it&#039;s possible to set an ipaddress, routing, bridging etc...<br/>I try this configuration with patch from Patrick Horn and i can see my switch and swconfig works on dev eth1 but i have no luck to configure it (set ipaddress, vlans, etc...).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110371">
				<div class="post-metadata">
					<div class="post-num">Post #203</div>
					<div class="post-author">MPG</div>
					<div class="post-datetime">
						1 Jun 2010, 23:10					</div>
				</div>
				<div class="post-content content">
					<p>I am with similar problems in rb450 with IP175D:</p><p> dmesg |grep eth<br/>eth0: Atheros AG71xx at 0xba000000, irq 5<br/>eth0: connected to PHY at ag71xx-mdio:04 [uid=02430d80, driver=Generic PHY]<br/>eth1: Atheros AG71xx at 0xb9000000, irq 4<br/>eth1: using fixed link parameters<br/>eth0: link up (100Mbps/Full duplex)<br/>eth0: link down<br/>device eth0 entered promiscuous mode<br/>eth1: link up (100Mbps/Full duplex)<br/>eth0: link up (100Mbps/Full duplex)<br/>br-lan: port 1(eth0) entering forwarding state</p><p>dmesg |grep IP17<br/>IP17xx: Found IP175D at ag71xx-mdio:00</p><p>swconfig dev 0 show<br/>Failed to connect to the switch<br/>swconfig dev eth0 show<br/>Failed to connect to the switch</p><p>br-lan&nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 00:0C:42:52:2F:3C<br/>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:192.168.1.1&nbsp; Bcast:192.168.1.255&nbsp; Mask:255.255.255.0<br/>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br/>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:13 errors:0 dropped:0 overruns:0 frame:0<br/>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:5 errors:0 dropped:0 overruns:0 carrier:0<br/>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0<br/>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:1750 (1.7 KiB)&nbsp; TX bytes:994 (994.0 B)</p><p>eth0&nbsp; &nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 00:0C:42:52:2F:3C<br/>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br/>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:14 errors:0 dropped:0 overruns:0 frame:0<br/>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:5 errors:0 dropped:0 overruns:0 carrier:0<br/>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000<br/>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:1992 (1.9 KiB)&nbsp; TX bytes:994 (994.0 B)<br/>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Interrupt:5</p><p>eth1&nbsp; &nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 00:0C:42:52:2F:3D<br/>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:192.168.10.118&nbsp; Bcast:192.168.10.255&nbsp; Mask:255.255.255.0<br/>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br/>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:929 errors:0 dropped:0 overruns:0 frame:0<br/>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:187 errors:0 dropped:0 overruns:0 carrier:0<br/>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000<br/>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:93482 (91.2 KiB)&nbsp; TX bytes:73195 (71.4 KiB)<br/>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Interrupt:4</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110410">
				<div class="post-metadata">
					<div class="post-num">Post #204</div>
					<div class="post-author">phorn</div>
					<div class="post-datetime">
						2 Jun 2010, 13:07					</div>
				</div>
				<div class="post-content content">
					<p>Hi all,</p><p>Thanks all for trying this out. Too bad it&#039;s not showing up. If anyone has , it would be good to trace the ag71xx_phy code between the probe() call and config_init(). Some of it might go into drivers/net/phy/ as well. I don&#039;t really have a router to test with, so it&#039;s a bit tricky for me to try stuff.</p><p>I find it easiest to edit the code directly inside build_dir/linux-* It will go away if you make clean, but for debugging it&#039;s pretty simple since it only has to recompile the files you changed.</p><p>I think the reason that martin&#039;s original driver works is that I think it&#039;s for an older SVN version, before the change to ag71xx_phy. luboznaiko, which SVN version were you testing on?</p><p>While I may have made a mistake porting the code, I don&#039;t think it&#039;s likely to be in the probe() or config_init() functions, and we can see it&#039;s never seems to get initialized.</p><p>Here&#039;s what I&#039;m thinking:<br/>There are 5 ethernet phy/mdio addresses associated with eth0. ag71xx_phy is doing a loop through all of them, and it gets &quot;ip17xx&quot; for ports 0,1,2,3. However, port 4 is actually attached to eth1, not the switch so it gets &quot;Generic Phy&quot;.</p><p>Since Generic Phy is the last one to be probed, perhaps it is the only one ag71xx decides to call config_init for, and not the others.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110413">
				<div class="post-metadata">
					<div class="post-num">Post #205</div>
					<div class="post-author">BitBrusher</div>
					<div class="post-datetime">
						2 Jun 2010, 14:24					</div>
				</div>
				<div class="post-content content">
					<p>Patrick</p><p>the only reference to config-init is inside drivers/net/phy/phy.c (around line 402 in phy_mii_ioctl()) .</p><p>This is what I did:<br/></p><div class="codebox"><pre><code>        pr_info(&quot;PHY MII IOCTL: Should I call config_init for %s: &quot;, phydev-&gt;attached_dev-&gt;name);
        if (mii_data-&gt;reg_num == MII_BMCR
                         &amp;&amp; val &amp; BMCR_RESET
                         &amp;&amp; phydev-&gt;drv-&gt;config_init) {
                 phy_scan_fixups(phydev);
                 phydev-&gt;drv-&gt;config_init(phydev); 
                 pr_info(&quot;YES\n&quot;);
         }
         else
                 pr_info(&quot;NO\n&quot;);</code></pre></div><p>Yesterday I played with it a little and found this code is never executed.<br/>ioctl with method SIOCSMIIREG is never called.<br/>Any other place I could poke some lines?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110415">
				<div class="post-metadata">
					<div class="post-num">Post #206</div>
					<div class="post-author">duvi</div>
					<div class="post-datetime">
						2 Jun 2010, 14:34					</div>
				</div>
				<div class="post-content content">
					<p>I have some success on RB433UAH!</p><p>After playing a little in mach-rb4xx.c, I managed to get &#039;ether2&#039; and &#039;ether3&#039; ports working (ping), and swconfig also sees the switch. Unfortunately, ether1 doesn&#039;t work anymore ): , which was the only one working before. Somehow we have to find this out (:</p><p>Here&#039;s what I modified in mach-rb4xx.c (almost the same as luboznaiko suggested):<br/></p><div class="codebox"><pre><code>@@static void __init rb433_setup(void)

-       ar71xx_add_device_mdio(0xffffffe9);
+       ar71xx_add_device_mdio(0xffffffe0);

-       ar71xx_eth1_data.phy_mask = 0x00000010;
+       ar71xx_eth1_data.phy_mask = 0x00000001;</code></pre></div><p>This makes the switch work, but it is seen as eth0, not eth1 as it&#039;s supposed to be I guess.<br/>Maybe that&#039;s the reason &#039;ether1&#039; stops working.</p><p>Regarding to swconfig &#039;ether2&#039; is port1, &#039;ether3&#039; is port2, and &#039;ether1&#039; is port4.<br/>This is also strange, because i thought &#039;ether1&#039; is a stand alone port, it shouldn&#039;t be seen as a switch port. Right?</p><p>And also there is no Generic PHY detected in dmesg, only IP17XX PHY.</p><p>I&#039;ll post dmesg later, now I&#039;m not with the board.</p><p>Maybe a little more play with those addresses and masks should get everything working. Isn&#039;t there any way to find the correct values for them.</p>											<p class="post-edited">(Last edited by <strong>duvi</strong> on 2 Jun 2010, 14:36)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110420">
				<div class="post-metadata">
					<div class="post-num">Post #207</div>
					<div class="post-author">MPG</div>
					<div class="post-datetime">
						2 Jun 2010, 15:33					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>phorn wrote:</cite><blockquote><p>I think the reason that martin&#039;s original driver works is that I think it&#039;s for an older SVN version, before the change to ag71xx_phy. luboznaiko, which SVN version were you testing on?</p><p>While I may have made a mistake porting the code, I don&#039;t think it&#039;s likely to be in the probe() or config_init() functions, and we can see it&#039;s never seems to get initialized.</p><p>Here&#039;s what I&#039;m thinking:<br/>There are 5 ethernet phy/mdio addresses associated with eth0. ag71xx_phy is doing a loop through all of them, and it gets &quot;ip17xx&quot; for ports 0,1,2,3. However, port 4 is actually attached to eth1, not the switch so it gets &quot;Generic Phy&quot;.</p><p>Since Generic Phy is the last one to be probed, perhaps it is the only one ag71xx decides to call config_init for, and not the others.</p></blockquote></div><p>My SVN version -&gt; 21648</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110476">
				<div class="post-metadata">
					<div class="post-num">Post #208</div>
					<div class="post-author">gk65</div>
					<div class="post-datetime">
						3 Jun 2010, 15:21					</div>
				</div>
				<div class="post-content content">
					<p>I have an RB433UAH with IP175D.<br/>I&#039;m working with trunk 21642 patched with <a href="http://www-inst.eecs.berkeley.edu/~pathorn/ip175c/ip175d-2010-05-31.zip">http://www-inst.eecs.berkeley.edu/~path … -05-31.zip</a></p><p>I&#039;ve made the following changes in mach-rb4xx.c ( after luboznaiko and duvi )<br/></p><div class="codebox"><pre><code>@@static void __init rb433_setup(void)

-       ar71xx_add_device_mdio(0xffffffe9);
+       ar71xx_add_device_mdio(0xffffffe0);

+       ar71xx_eth0_data.phy_mask = 0x00000001;</code></pre></div><p>I don&#039;t know what these &#039;magic&#039; numbers mean!</p><p>The result:<br/> - well functioning eth0<br/> - half functioning eth1</p><p>No outgoing packets on eth1. Incoming is processed (mac address picked up...)<br/>The ifconfig shows dropped TX packets.<br/>The ethertool shows no link on eth1:<br/></p><div class="codebox"><pre><code>root@OpenWrt:~# ethtool eth1
Settings for eth1:
        Supported ports: [ TP MII ]
        Supported link modes:   10baseT/Half 10baseT/Full
                                100baseT/Half 100baseT/Full
        Supports auto-negotiation: Yes
        Advertised link modes:  10baseT/Half 10baseT/Full
                                100baseT/Half 100baseT/Full
        Advertised auto-negotiation: Yes
        Speed: 100Mb/s
        Duplex: Full
        Port: MII
        PHYAD: 0
        Transceiver: external
        Auto-negotiation: on
        Current message level: 0x000000ff (255)
        Link detected: no</code></pre></div><p>Do you have any ideas?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110660">
				<div class="post-metadata">
					<div class="post-num">Post #209</div>
					<div class="post-author">luboznaiko</div>
					<div class="post-datetime">
						7 Jun 2010, 01:12					</div>
				</div>
				<div class="post-content content">
					<p>Hi again,<br/>I have some kind of solution for our problem.<br/>I&#039;m not sure what is the problem with patching SVN checkouts but there is a problem.<br/>Because of that I use &quot;git&quot; like described in <a href="https://forum.openwrt.org/viewtopic.php?pid=110258#p110258">https://forum.openwrt.org/viewtopic.php … 58#p110258</a> from phorn<br/>And after applying patches I just copying the file ip17xx.c from SVN revission 19075, patched with original patches from Martin Mares.<br/>After that i have working eth0 and eth1 but with no VLAN support (or I don&#039;t know how to do it)<br/>Phorn, please post a link to the original patches from Martin Mares, and maybe someone will help us to solve this problem.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110734">
				<div class="post-metadata">
					<div class="post-num">Post #210</div>
					<div class="post-author">luboznaiko</div>
					<div class="post-datetime">
						7 Jun 2010, 23:03					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m again,<br/>for the people with rb433uah i make a dirty patch for SVN revision 21642<br/><a href="http://liut.org/rb433uah/rb433uah.patch">http://liut.org/rb433uah/rb433uah.patch</a><br/>eth1 works like switch but i have no luck to configure vlans<br/>this patch is just a diff between original 21642 revision and patched one<br/>the steps are:<br/>svn co svn://svn.openwrt.org/openwrt/trunk@21642 21642<br/>cd 21642<br/>patch -p1 &lt; rb433uah.patch<br/>and after make you must have working eth0 and eth1</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110736">
				<div class="post-metadata">
					<div class="post-num">Post #211</div>
					<div class="post-author">duvi</div>
					<div class="post-datetime">
						8 Jun 2010, 00:30					</div>
				</div>
				<div class="post-content content">
					<p>I can confirm that this way the ports are working but vlans are not on RB433UAH.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110750">
				<div class="post-metadata">
					<div class="post-num">Post #212</div>
					<div class="post-author">gk65</div>
					<div class="post-datetime">
						8 Jun 2010, 09:24					</div>
				</div>
				<div class="post-content content">
					<div class="codebox"><pre><code>make[8]: *** No rule to make target `drivers/net/phy/ip17xx.o&#039;, needed by `drivers/net/phy/built-in.o&#039;.  Stop.</code></pre></div><p>I think you forgot rename /drivers/net/phy/ip175c.c to /drivers/net/phy/ip17xx.c.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110754">
				<div class="post-metadata">
					<div class="post-num">Post #213</div>
					<div class="post-author">luboznaiko</div>
					<div class="post-datetime">
						8 Jun 2010, 10:32					</div>
				</div>
				<div class="post-content content">
					<p>My fault, you must copy or rename ip175c.c to ip17xx.c </p><p>patch -p1 &lt; rb433uah.patch; cp target/linux/generic-2.6/files/drivers/net/phy/{ip175c.c,ip17xx.c}</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110916">
				<div class="post-metadata">
					<div class="post-num">Post #214</div>
					<div class="post-author">phorn</div>
					<div class="post-datetime">
						10 Jun 2010, 09:04					</div>
				</div>
				<div class="post-content content">
					<p>Here are the original patches:<br/><a href="http://inst.eecs.berkeley.edu/~pathorn/ip175c/martin-patches-2010-02-20-ip17xx.zip">http://inst.eecs.berkeley.edu/~pathorn/ … ip17xx.zip</a><br/>Sorry for not having a link to them earlier. That could have been useful.</p><p>Luboznaiko, does your patch do something different to cause the switch to be inited? I might give this another look over the weekend.</p><p>The phy masks look interesting, but I&#039;d rather avoid having to change all the different routerboard models (as well as other ar71xx devices) just to make this switch driver work. Or was the phy mask actually completely wrong and the old driver was just ignoring it?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110925">
				<div class="post-metadata">
					<div class="post-num">Post #215</div>
					<div class="post-author">duvi</div>
					<div class="post-datetime">
						10 Jun 2010, 11:01					</div>
				</div>
				<div class="post-content content">
					<p>You don&#039;t need to patch anymore, IP17xx driver has been in trunk for a day.</p><p>The wan port, the switch and vlans are all working fine on RB433UAH.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110945">
				<div class="post-metadata">
					<div class="post-num">Post #216</div>
					<div class="post-author">BitBrusher</div>
					<div class="post-datetime">
						10 Jun 2010, 16:44					</div>
				</div>
				<div class="post-content content">
					<p>Hi All</p><p>Anyone had the same luck with RB450 with 175D chipset ??</p><p>duvi , did you change the values in mach-rb4xx.c or are they the originals??</p>											<p class="post-edited">(Last edited by <strong>BitBrusher</strong> on 10 Jun 2010, 16:52)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110947">
				<div class="post-metadata">
					<div class="post-num">Post #217</div>
					<div class="post-author">duvi</div>
					<div class="post-datetime">
						10 Jun 2010, 17:18					</div>
				</div>
				<div class="post-content content">
					<p>No, I didn&#039;t change anything, everything works out of the box.</p><p>Okay, one thing doesn&#039;t. You have to modify the network config file, swap eth0 and eth1 or something. I see there is a default network config file for rb433, but for me it didn&#039;t make it to the rootfs during compilation.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p113676">
				<div class="post-metadata">
					<div class="post-num">Post #218</div>
					<div class="post-author">mtadeu</div>
					<div class="post-datetime">
						24 Jul 2010, 04:25					</div>
				</div>
				<div class="post-content content">
					<p>I use RB450 with 175D. trunk r22372.&nbsp; All ports works fine in individual VLAN.<br/>dmesg relevant part<br/></p><div class="codebox"><pre><code>MIPS: machine is MikroTik RouterBOARD 450                                                                                                                     
Atheros AR71xx SPI Controller driver version 0.2.4                                                                                                            
IP17xx: Found IP175D at ag71xx-mdio:00                                                                                                                        
ag71xx_mdio: probed                                                                                                                                           
eth0: Atheros AG71xx at 0xba000000, irq 5                                                                                                                     
eth0: connected to PHY at ag71xx-mdio:04 [uid=02430d80, driver=Generic PHY]
eth1: Atheros AG71xx at 0xb9000000, irq 4
eth1: connected to PHY at ag71xx-mdio:00 [uid=02430d80, driver=IC+ IP17xx]</code></pre></div><p>etc/config/network<br/>config switch eth1<br/>&nbsp; &nbsp; &nbsp; &nbsp; option name&nbsp; &nbsp; &nbsp;eth1<br/>&nbsp; &nbsp; &nbsp; &nbsp; option reset&nbsp; &nbsp; 1<br/>&nbsp; &nbsp; &nbsp; &nbsp; option enable_vlan 1</p><p>config switch_vlan<br/>&nbsp; &nbsp; &nbsp; &nbsp; option device&nbsp; &nbsp;eth1<br/>&nbsp; &nbsp; &nbsp; &nbsp; option vlan&nbsp; &nbsp; &nbsp;5<br/>&nbsp; &nbsp; &nbsp; &nbsp; option ports&nbsp; &nbsp; &quot;5t 0&quot;</p><p>config switch_vlan<br/>&nbsp; &nbsp; &nbsp; &nbsp; option device&nbsp; &nbsp;eth1<br/>&nbsp; &nbsp; &nbsp; &nbsp; option vlan&nbsp; &nbsp; &nbsp;4<br/>&nbsp; &nbsp; &nbsp; &nbsp; option ports&nbsp; &nbsp; &quot;5t 1&quot;</p><p>config switch_vlan<br/>&nbsp; &nbsp; &nbsp; &nbsp; option device&nbsp; &nbsp;eth1<br/>&nbsp; &nbsp; &nbsp; &nbsp; option vlan&nbsp; &nbsp; &nbsp;3<br/>&nbsp; &nbsp; &nbsp; &nbsp; option ports&nbsp; &nbsp; &quot;5t 2&quot;</p><p>config switch_vlan<br/>&nbsp; &nbsp; &nbsp; &nbsp; option device&nbsp; &nbsp;eth1<br/>&nbsp; &nbsp; &nbsp; &nbsp; option vlan&nbsp; &nbsp; &nbsp;2<br/>&nbsp; &nbsp; &nbsp; &nbsp; option ports&nbsp; &nbsp; &quot;5t 3&quot;</p>											<p class="post-edited">(Last edited by <strong>mtadeu</strong> on 26 Jul 2010, 05:04)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p113742">
				<div class="post-metadata">
					<div class="post-num">Post #219</div>
					<div class="post-author">mtadeu</div>
					<div class="post-datetime">
						26 Jul 2010, 04:25					</div>
				</div>
				<div class="post-content content">
					<p>The same image works fine in rb450G. eth0 and four VLANs in eth1 are ok.<br/></p><div class="codebox"><pre><code>CPU revision is: 00019374 (MIPS 24Kc)
Atheros AR7161 rev 2, CPU:680.000 MHz, AHB:170.000 MHz, DDR:340.000 MHz
MIPS: machine is MikroTik RouterBOARD 450G
ag71xx_mdio: probed
eth0: Atheros AG71xx at 0xba000000, irq 5
eth0: connected to PHY at ag71xx-mdio:04 [uid=004dd041, driver=Atheros AR8216/AR8316]
eth1: Atheros AG71xx at 0xb9000000, irq 4
eth1: AR8316 switch driver attached
eth1: connected to PHY at ag71xx-mdio:00 [uid=004dd041, driver=Atheros AR8216/AR8316]</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p115533">
				<div class="post-metadata">
					<div class="post-num">Post #220</div>
					<div class="post-author">BitBrusher</div>
					<div class="post-datetime">
						19 Aug 2010, 16:00					</div>
				</div>
				<div class="post-content content">
					<p>Hi <br/>Does anyone know if ip17xx is already supported in Backfire main stream??</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p116738">
				<div class="post-metadata">
					<div class="post-num">Post #221</div>
					<div class="post-author">mtadeu</div>
					<div class="post-datetime">
						9 Sep 2010, 04:10					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>BitBrusher wrote:</cite><blockquote><p>Hi <br/>Does anyone know if ip17xx is already supported in Backfire main stream??</p></blockquote></div><p>I try backfire 22933 and don&#039;t work. The VLAN do not work:<br/></p><div class="codebox"><pre><code>root@OpenWrt:/# swconfig dev eth0 show
Failed to connect to the switch
root@OpenWrt:/# swconfig dev eth1 show
Failed to connect to the switch</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p117335">
				<div class="post-metadata">
					<div class="post-num">Post #222</div>
					<div class="post-author">smalltime</div>
					<div class="post-datetime">
						17 Sep 2010, 03:12					</div>
				</div>
				<div class="post-content content">
					<p>Greetings</p><p>I&#039;ve been looking into the IP17xx driver as this board has the IP175D switch chip.&nbsp; I&#039;m interested in trying out the mirroring support that is mentioned on the vendors web page for the <a href="http://www.icplus.com.tw/pp-IP175D.html">pp-IP175D</a> switch chip.</p><p>I cant find the datasheet anywhere, does anyone know if the datasheet is available?&nbsp; If not can anyone share the registers I should be looking for?</p><p>Thanks everyone for your work on the RB433UAH, and openwrt so far.</p><p>sml</p><p>[/edit]malformed url</p>											<p class="post-edited">(Last edited by <strong>smalltime</strong> on 17 Sep 2010, 03:13)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p169846">
				<div class="post-metadata">
					<div class="post-num">Post #223</div>
					<div class="post-author">DrRobin</div>
					<div class="post-datetime">
						12 Jun 2012, 19:21					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>We are trying to get Backfire working on a RB433 with an IP175D switch chip.&nbsp; Our basic image is built on a recent trunk and we have tried a variety of patches for both the IP175D and the AR7130.&nbsp; This is what we can get it to do...</p><p>The AR7130 Eth0 works okay at 10/100MB through Phy4 and recognises it as Generic Phy.&nbsp; This is understandable as it is really just using Phy4 as a dumb interface.</p><p>Eth1 on the AR7130 recognises the switch as a IP17xx but it won&#039;t transmit or receive data through to either Port 1 or Port 2.</p><p>Port 1 and Port work and VLANs work on these.&nbsp; We have been able to test this by plugging in a couple of computers and see traffic through the switch.</p><p>So just to re-iterate, we seem to be setting up the switch, but whilst the two physical ports work, we can&#039;t get anything in or out of the AR7130.</p><p>We are just going back to a previous trunk release and we are going to check whether the &#039;auto-baud&#039; rate has been turned off, to see if that makes any difference.</p><p>If anyone has it working on a RB433 or RB450 could you post the trunk version and any other useful information please?</p><p>On a slightly different tack I note that this issue is a current ticket (#6119) and is four from the top of the list.&nbsp; Anyone know if it is going to be addressed soon?</p><p>Regards</p><p>Robin</p>											<p class="post-edited">(Last edited by <strong>DrRobin</strong> on 12 Jun 2012, 19:21)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 9 of 9</div><nav><ul><li><a href="viewtopic.php%3Fid=17501&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=17501&amp;p=7.html">7</a></li><li><a href="viewtopic.php%3Fid=17501&amp;p=8.html">8</a></li><li class="pagination-current"><span>9</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>