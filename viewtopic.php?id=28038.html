<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> TL-MR3420  Usb-Hub rejected 1 configuration due to insufficient availa</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 13 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p124847">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">DerMicha</div>
					<div class="post-datetime">
						8 Jan 2011, 15:32					</div>
				</div>
				<div class="post-content content">
					<p>Hello,<br />i have a Tplink 3420 with Openwrt from Trunk (r24915), running with extroot on usb Stick without any Problems.<br />But when i plug the Stick in a Usb-hub nothing will work.<br />Testet with 1 passiv and 1 aktive hub. Only the Usb Hub in my Hp-w2207h Screen will work.???</p><p>Dmesg when power on with Stick into a Hub:</p><div class="quotebox"><blockquote><p>usbcore: registered new interface driver usbfs<br />usbcore: registered new interface driver hub<br />usbcore: registered new device driver usb<br />ehci_hcd: USB 2.0 &#039;Enhanced&#039; Host Controller (EHCI) Driver<br />ar71xx-ehci ar71xx-ehci: Atheros AR91xx built-in EHCI controller<br />ar71xx-ehci ar71xx-ehci: new USB bus registered, assigned bus number 1<br />ar71xx-ehci ar71xx-ehci: irq 3, io mem 0x1b000000<br />ar71xx-ehci ar71xx-ehci: USB 2.0 started, EHCI 1.00<br />usb usb1: configuration #1 chosen from 1 choice<br />hub 1-0:1.0: USB hub found<br />hub 1-0:1.0: 1 port detected<br />ohci_hcd: USB 1.1 &#039;Open&#039; Host Controller (OHCI) Driver<br />uhci_hcd: USB Universal Host Controller Interface driver<br />Initializing USB Mass Storage driver...<br />usbcore: registered new interface driver usb-storage<br />USB Mass Storage support registered.<br />usb 1-1: new high speed USB device using ar71xx-ehci and address 2<br />usb 1-1: configuration #1 chosen from 1 choice<br />hub 1-1:1.0: USB hub found<br />hub 1-1:1.0: 4 ports detected<br />usb 1-1.1: new low speed USB device using ar71xx-ehci and address 3<br />usb 1-1.1: configuration #1 chosen from 1 choice<br />usb 1-1.4: new high speed USB device using ar71xx-ehci and address 4<br />usb 1-1.4: <strong>rejected 1 configuration due to insufficient available bus power</strong><br />usb 1-1.4: no configuration chosen from 1 choice</p></blockquote></div><p>Ok. Google for the Problem &quot;<strong>rejected 1 configuration due to insufficient available bus power</strong>&quot; and send this Command over shh:<br /></p><div class="quotebox"><blockquote><p>echo 1 &gt; /sys/bus/usb/devices/1-1.4/bConfigurationValue</p></blockquote></div><p>Again the Dmesg Output:<br /></p><div class="quotebox"><blockquote><p>usb 1-1.4: new config #1 exceeds power limit by 100mA<br />scsi0 : SCSI emulation for USB Mass Storage devices<br />usb-storage: device found at 4<br />usb-storage: waiting for device to settle before scanning<br />scsi 0:0:0:0: Direct-Access&nbsp; &nbsp; &nbsp;SanDisk&nbsp; Cruzer Micro&nbsp; &nbsp; &nbsp;8.02 PQ: 0 ANSI: 0 CCS<br />usb-storage: device scan complete<br />sd 0:0:0:0: [sda] 15695871 512-byte logical blocks: (8.03 GB/7.48 GiB)<br />sd 0:0:0:0: [sda] Write Protect is off<br />sd 0:0:0:0: [sda] Mode Sense: 45 00 00 08<br />sd 0:0:0:0: [sda] Assuming drive cache: write through<br />sd 0:0:0:0: [sda] Assuming drive cache: write through<br /> sda: sda1 sda2<br />sd 0:0:0:0: [sda] Assuming drive cache: write through<br />sd 0:0:0:0: [sda] Attached SCSI removable disk<br />usb 1-1.2: new low speed USB device using ar71xx-ehci and address 4<br />usb 1-1.2: configuration #1 chosen from 1 choice<br />usb 1-1.4: 200mA is over 100mA budget for port 4!</p></blockquote></div><p>So where must i stored the Command &quot;echo 1 &gt; /sys/bus/usb/devices/1-1.4/bConfigurationValue&quot; to boot from Usb?<br />There Files are to Late : /etc/init.d/boot , /etc/init.d/rcS , /etc/init.d/defconfig (swap mountet but not extroot)</p>											<p class="post-edited">(Last edited by <strong>DerMicha</strong> on 8 Jan 2011, 18:07)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p127391">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">rolandk</div>
					<div class="post-datetime">
						5 Feb 2011, 12:41					</div>
				</div>
				<div class="post-content content">
					<p>i think we need a kernel konfig option or add that command into initrd somehow....<br />no option/kernel-param found in the sources. maybe that is a question for linux-usb mailing list....</p><p>&gt;usb 1-1.4: 200mA is over 100mA budget for port 4!<br />so, it appears the usb device is telling &quot;i can only deliver a maximum of 100mA&quot; and you do manual override!?<br />have seen &quot;overload&quot; message with 2.5&quot; harddisks on my windows machine,too- but it worked and the message was related to harddisk-spinup, as it draws more power on spinup - so maybe the device may draw (i.e. hub + stick together) more power when it initializes?</p><p>anyway, we should check the hardware specs for the chipset and the attached usb circuits, i cannot believe that it only supports 100mA consumers, as this port is meant to run an UMTS stick and i would wonder if all of them only use &lt;100mA</p><p>one more question:<br />may that manual override kill anything or is it just meant as a mechanism to tell the driver not to init the device as it may fail anyway when it gets too few power? i thought USB was sorta &quot;overload safe&quot; !?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>