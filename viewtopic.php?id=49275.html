<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Newbie needs help upgrading MR3020</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 29 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p226543">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">samseawright</div>
					<div class="post-datetime">
						1 Mar 2014, 03:27					</div>
				</div>
				<div class="post-content content">
					<p>My latest problem is that when I my upgrade was complete, rather than restarting, I lost internet connection. The router is now 192.168.1.1, IP address is 192.168.1.107, subnet mask is 255.255.255.0 My status is connected, Thunderbolt Ethernet is currently active and has the IP address 192.168.1.107. but I can&#039;t open a page in my browser. <br />Do I need to start over? Was my open wrt bad?. it was in a zip file format when I selected it in the upgrade. <br />I&#039;m really not that bad at following directions, but this project is making me lose my self confidence. How should I proceed?<br />Many thanks, <br />Sam</p>											<p class="post-edited">(Last edited by <strong>samseawright</strong> on 1 Mar 2014, 03:37)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p226544">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						1 Mar 2014, 03:39					</div>
				</div>
				<div class="post-content content">
					<p>can you telnet or&nbsp; ssh router ip?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p226545">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">samseawright</div>
					<div class="post-datetime">
						1 Mar 2014, 03:54					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for getting back, I appreciate your help! No I can not telnet or ssh, the browser page does not respond. This is my very first attempt, I have zero experience in programming or hacking, I&#039;m an artist try to expand my horizons.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p226548">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">glenten</div>
					<div class="post-datetime">
						1 Mar 2014, 04:47					</div>
				</div>
				<div class="post-content content">
					<p>Have you tried a power cycle and see how it&#039;s coming back up?</p><p>Or can you get in via failsafe?</p><p>Have a look at,<br /><a href="http://wiki.openwrt.org/toh/tp-link/tl-mr3020#failsafe.mode">http://wiki.openwrt.org/toh/tp-link/tl- … lsafe.mode</a><br />and <a href="http://wiki.openwrt.org/doc/howto/generic.failsafe#in.failsafe.mode">http://wiki.openwrt.org/doc/howto/gener … lsafe.mode</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p226585">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">samseawright</div>
					<div class="post-datetime">
						1 Mar 2014, 17:45					</div>
				</div>
				<div class="post-content content">
					<p>glenten,<br />Thanks for your help,<br />I haven&#039;t opened the links you posted yet, but looking forward to resolving my newbie problems and moving forward. Please stay tuned, I may need additional advise,<br />Thanks,</p><p>Sam</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p226587">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">samseawright</div>
					<div class="post-datetime">
						1 Mar 2014, 18:51					</div>
				</div>
				<div class="post-content content">
					<p>Last login: Sat Mar&nbsp; 1 11:18:28 on ttys000<br />Sams-MacBook-Pro-3:~ samseawright$ telnet 192.168.1.1<br />Trying 192.168.1.1...<br />Connected to 192.168.1.1.<br />Escape character is &#039;^]&#039;.</p><p> Hers the problem I&#039;m encountering at log in<br />=== IMPORTANT ============================<br />&nbsp; Use &#039;passwd&#039; to set your login password<br />&nbsp; this will disable telnet and enable SSH<br /> ------------------------------------------</p><br /><p>BusyBox v1.19.4 (2013-03-14 11:28:31 UTC) built-in shell (ash)<br />Enter &#039;help&#039; for a list of built-in commands.</p><p>&nbsp; _______&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;________&nbsp; &nbsp; &nbsp; &nbsp; __<br /> |&nbsp; &nbsp; &nbsp; &nbsp;|.-----.-----.-----.|&nbsp; |&nbsp; |&nbsp; |.----.|&nbsp; |_<br /> |&nbsp; &nbsp;-&nbsp; &nbsp;||&nbsp; _&nbsp; |&nbsp; -__|&nbsp; &nbsp; &nbsp;||&nbsp; |&nbsp; |&nbsp; ||&nbsp; &nbsp;_||&nbsp; &nbsp;_|<br /> |_______||&nbsp; &nbsp;__|_____|__|__||________||__|&nbsp; |____|<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |__| W I R E L E S S&nbsp; &nbsp;F R E E D O M<br /> -----------------------------------------------------<br /> ATTITUDE ADJUSTMENT (12.09, r36088)<br /> -----------------------------------------------------<br />&nbsp; * 1/4 oz Vodka&nbsp; &nbsp; &nbsp; Pour all ingredients into mixing<br />&nbsp; * 1/4 oz Gin&nbsp; &nbsp; &nbsp; &nbsp; tin with ice, strain into glass.<br />&nbsp; * 1/4 oz Amaretto<br />&nbsp; * 1/4 oz Triple sec<br />&nbsp; * 1/4 oz Peach schnapps<br />&nbsp; * 1/4 oz Sour mix<br />&nbsp; * 1 splash Cranberry juice<br /> -----------------------------------------------------<br />root@(none):/# passwd<br />Changing password for root<br />New password: <br />Retype password: <br />passwd: /etc/passwd: Read-only file system<br />passwd: can&#039;t update password file /etc/passwd<br />root@(none):/# passwd<br />Changing password for root<br />New password: <br />Retype password: <br />passwd: /etc/passwd: Read-only file system<br />passwd: can&#039;t update password file /etc/passwd<br />root@(none):/#</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p226588">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						1 Mar 2014, 19:00					</div>
				</div>
				<div class="post-content content">
					<p>you are in failsafe mode so no password set possible.</p><p>just run &quot;firstboot&quot; then power cycle, you should then be able to telnet without failsafe mode then set password and so on <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p226590">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">samseawright</div>
					<div class="post-datetime">
						1 Mar 2014, 19:26					</div>
				</div>
				<div class="post-content content">
					<p>Thanks nebbia88,<br />I found my way out of that one, heres where I&#039;m at now. I&#039;m sure you have a simple solution. Thanks in advance!<br />Sams-MacBook-Pro-3:~ samseawright$ ping google.com<br />PING google.com (74.125.226.65): 56 data bytes<br />64 bytes from 74.125.226.65: icmp_seq=0 ttl=57 time=82.374 ms<br />64 bytes from 74.125.226.65: icmp_seq=1 ttl=57 time=33.797 ms<br />64 bytes from 74.125.226.65: icmp_seq=2 ttl=57 time=35.004 ms<br />64 bytes from 74.125.226.65: icmp_seq=3 ttl=57 time=30.307 ms<br />64 bytes from 74.125.226.65: icmp_seq=4 ttl=57 time=44.100 ms<br />64 bytes from 74.125.226.65: icmp_seq=5 ttl=57 time=32.987 ms<br />^C&nbsp; &nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;<br />--- google.com ping statistics ---<br />6 packets transmitted, 6 packets received, 0.0% packet loss<br />round-trip min/avg/max/stddev = 30.307/43.095/82.374/18.081 ms<br />Sams-MacBook-Pro-3:~ samseawright$ cd /tmp<br />Sams-MacBook-Pro-3:tmp samseawright$ <br />Sams-MacBook-Pro-3:tmp samseawright$ cd /tmp<br />Sams-MacBook-Pro-3:tmp samseawright$ opkg update &amp;&amp; opkg install <a href="http://piratebox.aod-rpg.de/piratebox_0.6.3_all.ipk">http://piratebox.aod-rpg.de/piratebox_0.6.3_all.ipk</a><br />-bash: opkg: command not found<br />Sams-MacBook-Pro-3:tmp samseawright$ cd /tmp<br />Sams-MacBook-Pro-3:tmp samseawright$ opkg update &amp;&amp; opkg install <a href="http://piratebox.aod-rpg.de/">http://piratebox.aod-rpg.de/</a><br />-bash: opkg: command not found<br />Sams-MacBook-Pro-3:tmp samseawright$&nbsp; ping -n 1 8.8.8.8<br />usage: ping [-AaDdfnoQqRrv] [-b boundif] [-c count] [-G sweepmaxsize] [-g sweepminsize]<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [-h sweepincrsize] [-i wait] [-l preload] [-M mask | time] [-m ttl]<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [-p pattern] [-S src_addr] [-s packetsize] [-t timeout]<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [-W waittime] [-z tos] host<br />&nbsp; &nbsp; &nbsp; &nbsp;ping [-AaDdfLnoQqRrv] [-c count] [-I iface] [-i wait] [-l preload]<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [-M mask | time] [-m ttl] [-p pattern] [-S src_addr]<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [-s packetsize] [-T ttl] [-t timeout] [-W waittime]<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [-z tos] mcast-group<br />Sams-MacBook-Pro-3:tmp samseawright$ opkg update<br />-bash: opkg: command not found<br />Sams-MacBook-Pro-3:tmp samseawright$ opkg install piratebox<br />-bash: opkg: command not found<br />Sams-MacBook-Pro-3:tmp samseawright$ opkg update<br />-bash: opkg: command not found<br />Sams-MacBook-Pro-3:tmp samseawright$ <br />Sams-MacBook-Pro-3:tmp samseawright$ <br />Sams-MacBook-Pro-3:tmp samseawright$ <br />Sams-MacBook-Pro-3:tmp samseawright$ <br />Sams-MacBook-Pro-3:tmp samseawright$ <br />Sams-MacBook-Pro-3:tmp samseawright$ <br />Sams-MacBook-Pro-3:tmp samseawright$ <br />Sams-MacBook-Pro-3:tmp samseawright$ opkg update<br />-bash: opkg: command not found<br />Sams-MacBook-Pro-3:tmp samseawright$ opkg update<br />-bash: opkg: command not found<br />Sams-MacBook-Pro-3:tmp samseawright$ opkg install kmod-usb-uhci<br />-bash: opkg: command not found<br />Sams-MacBook-Pro-3:tmp samseawright$ insmod usbcore ## may return: file exists<br />-bash: insmod: command not found<br />Sams-MacBook-Pro-3:tmp samseawright$ insmod uhci<br />-bash: insmod: command not found<br />Sams-MacBook-Pro-3:tmp samseawright$ opkg install kmod-usb-ohci ## may return: up to date.<br />-bash: opkg: command not found<br />Sams-MacBook-Pro-3:tmp samseawright$ insmod usb-ohci<br />-bash: insmod: command not found<br />Sams-MacBook-Pro-3:tmp samseawright$ opkg update<br />-bash: opkg: command not found<br />Sams-MacBook-Pro-3:tmp samseawright$ opkg install kmod-usb-uhci<br />-bash: opkg: command not found<br />Sams-MacBook-Pro-3:tmp samseawright$ insmod usbcore ## may return: file exists<br />-bash: insmod: command not found<br />Sams-MacBook-Pro-3:tmp samseawright$ insmod uhci<br />-bash: insmod: command not found<br />Sams-MacBook-Pro-3:tmp samseawright$ opkg install kmod-usb-ohci ## may return: up to date.<br />-bash: opkg: command not found<br />Sams-MacBook-Pro-3:tmp samseawright$ insmod usb-ohci<br />-bash: insmod: command not found<br />Sams-MacBook-Pro-3:tmp samseawright$ <br />Sams-MacBook-Pro-3:tmp samseawright$ ssh root@192.168.2.111<br />ping google.com<br />ping google.com<br />ssh: connect to host 192.168.2.111 port 22: Operation timed out<br />Sams-MacBook-Pro-3:tmp samseawright$ ping google.com<br />PING google.com (74.125.226.232): 56 data bytes<br />64 bytes from 74.125.226.232: icmp_seq=0 ttl=57 time=31.054 ms<br />64 bytes from 74.125.226.232: icmp_seq=1 ttl=57 time=34.871 ms<br />64 bytes from 74.125.226.232: icmp_seq=2 ttl=57 time=33.442 ms<br />64 bytes from 74.125.226.232: icmp_seq=3 ttl=57 time=35.429 m<br />64 bytes from 74.125.226.232: icmp_seq=19 ttl=57 time=38.026 ms<br />64 bytes from 74.125.226.232: icmp_seq=20 ttl=57 time=34.492 ms<br />^C<br />--- google.com ping statistics ---<br />21 packets transmitted, 21 packets received, 0.0% packet loss<br />round-trip min/avg/max/stddev = 31.054/34.207/42.666/2.382 ms<br />Sams-MacBook-Pro-3:tmp samseawright$&nbsp; ping -n 1 8.8.8.8 <br />usage: ping [-AaDdfnoQqRrv] [-b boundif] [-c count] [-G sweepmaxsize] [-g sweepminsize]<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [-h sweepincrsize] [-i wait] [-l preload] [-M mask | time] [-m ttl]<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [-p pattern] [-S src_addr] [-s packetsize] [-t timeout]<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [-W waittime] [-z tos] host<br />&nbsp; &nbsp; &nbsp; &nbsp;ping [-AaDdfLnoQqRrv] [-c count] [-I iface] [-i wait] [-l preload]<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [-M mask | time] [-m ttl] [-p pattern] [-S src_addr]<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [-s packetsize] [-T ttl] [-t timeout] [-W waittime]<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [-z tos] mcast-group<br />Sams-MacBook-Pro-3:tmp samseawright$ opkg update<br />-bash: opkg: command not found<br />Sams-MacBook-Pro-3:tmp samseawright$ <br />Sams-MacBook-Pro-3:tmp samseawright$</p>											<p class="post-edited">(Last edited by <strong>samseawright</strong> on 1 Mar 2014, 19:27)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p226591">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">glenten</div>
					<div class="post-datetime">
						1 Mar 2014, 19:53					</div>
				</div>
				<div class="post-content content">
					<p>Seems you are executing the opkg commands etc in the shell on your laptop instead of the router.</p><br /><div class="quotebox"><cite>samseawright wrote:</cite><blockquote><p>Sams-MacBook-Pro-3:tmp samseawright$ ssh root@192.168.2.111</p><p>ssh: connect to host 192.168.2.111 port 22: Operation timed out</p></blockquote></div><p>Is 192.168.2.111 the address of your MR3020?</p><p>You could perhaps verify with e.g.;<br /></p><div class="codebox"><pre><code>traceroute google.com</code></pre></div><p>from your laptop.</p><p>If you can&#039;t SSH into the router it could be because you haven&#039;t got the password set?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p226593">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">samseawright</div>
					<div class="post-datetime">
						1 Mar 2014, 20:02					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for pointing the way glenten. <br />Ill give it a try.</p><p>Sam</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p226602">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">samseawright</div>
					<div class="post-datetime">
						1 Mar 2014, 21:09					</div>
				</div>
				<div class="post-content content">
					<p>glenten,<br />I have no idea where to start to resolve this, </p><p>root@(none):/# reboot -f<br />Connection closed by foreign host.<br />Sams-MacBook-Pro-3:~ samseawright$ traceroute google.com<br />traceroute: unknown host google.com<br />Sams-MacBook-Pro-3:~ samseawright$ passwd<br />Changing password for samseawright.<br />Old Password:<br />New Password:<br />Retype New Password:<br />passwd: authentication token failure<br />Sams-MacBook-Pro-3:~ samseawright$ <br />Thanks,<br />Sam</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p226607">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">glenten</div>
					<div class="post-datetime">
						1 Mar 2014, 22:15					</div>
				</div>
				<div class="post-content content">
					<p>Keep up the mood <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><br /><p>Keep in mind that you should pay attention to your command prompt to check whether you are executing commands on your PC or the router.<br />When it is<br />Sams-MacBo....$<br />you are not &quot;in&quot; the router.<br />E.g.<br /></p><div class="quotebox"><cite>samseawright wrote:</cite><blockquote><p>Sams-MacBook-Pro-3:~ samseawright$ passwd</p></blockquote></div><p>you were actually starting to change the password of the pc and not the router.</p><br /><div class="quotebox"><cite>samseawright wrote:</cite><blockquote><p>root@(none):/# reboot -f</p></blockquote></div><p>What did you do in failsafe?<br />Perhaps run mount_root and firstboot? And without errors?</p><p>I&#039;m curious to know whether or not your router is reset back to default settings, like address i 192.168.1.1 etc.</p><br /><p>Could you explain how you have connected both your router and the laptop? Is your router connected to another router or modem? Is your laptop connected the MR3020 router via Ethernet but at the same time connected to another router by wireless?</p><p>Could you;<br /></p><div class="codebox"><pre><code>ping -c 4 192.168.1.1
telnet 192.168.1.1
ssh root@192.168.1.1</code></pre></div><p>and post the output?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p226613">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">samseawright</div>
					<div class="post-datetime">
						2 Mar 2014, 00:25					</div>
				</div>
				<div class="post-content content">
					<p>Thanks,<br />I really appreciate the help.I was of line for a while, Ill ry what you suggested and re post.<br />Sam</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p226614">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">samseawright</div>
					<div class="post-datetime">
						2 Mar 2014, 01:03					</div>
				</div>
				<div class="post-content content">
					<p>glenten, here are the resulting outputs, Im no longer connected to the router and have wi fi on.I&#039;m afraid that I have changed my macbook password in terminal, but don&#039;t know what it is!<br />What a mess.</p><p>Last login: Sat Mar&nbsp; 1 17:29:45 on ttys000<br />Sams-MacBook-Pro-3:~ samseawright$ ping -c 4 192.168.1.1<br />PING 192.168.1.1 (192.168.1.1): 56 data bytes<br />64 bytes from 192.168.1.1: icmp_seq=0 ttl=64 time=1.542 ms<br />64 bytes from 192.168.1.1: icmp_seq=1 ttl=64 time=4.549 ms<br />64 bytes from 192.168.1.1: icmp_seq=2 ttl=64 time=2.270 ms<br />64 bytes from 192.168.1.1: icmp_seq=3 ttl=64 time=3.903 ms</p><p>--- 192.168.1.1 ping statistics ---<br />4 packets transmitted, 4 packets received, 0.0% packet loss<br />round-trip min/avg/max/stddev = 1.542/3.066/4.549/1.210 ms<br />Sams-MacBook-Pro-3:~ samseawright$ <br />Sams-MacBook-Pro-3:~ samseawright$ <br />Sams-MacBook-Pro-3:~ samseawright$ telnet 192.168.1.1</p><p>Trying 192.168.1.1...<br />telnet: connect to address 192.168.1.1: Connection refused<br />telnet: Unable to connect to remote host<br />Sams-MacBook-Pro-3:~ samseawright$ ssh root@192.168.1.1<br />ssh: connect to host 192.168.1.1 port 22: Connection refused<br />Sams-MacBook-Pro-3:~ samseawright$ <br />Now I really need help. Thanks<br />AM</p>											<p class="post-edited">(Last edited by <strong>samseawright</strong> on 2 Mar 2014, 01:06)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p226619">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">samseawright</div>
					<div class="post-datetime">
						2 Mar 2014, 03:43					</div>
				</div>
				<div class="post-content content">
					<p>glenten, here is the point in my upgrade that things fall apart. When I connect to&nbsp; wi-fi and then directly from my home router via ethernet my connection is &quot;closed by foreign host&quot;</p><p>as documented below:</p><p>12. Turn ON your laptop’s wireless (for OSX, click on the wifi icon and select “Turn Wi-Fi On”)</p><p>13. Connect the MR3020 (or WR703N) to your gateway router (e.g. your home network router) with an ethernet cable and plug the power back in. Wait a couple of minutes until the router boots up. With your computer connected to your home network, try sshing into the router (Note: use the “ipaddr” you assigned in step 9):<br />Connection closed by foreign host.<br />Sams-MacBook-Pro-3:~ samseawright$ ssh root@192.168.2.111<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;lo&#039;<br />ssh root@192.168.2.111static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;127.0.0.1&#039;<br />ping google.comnetmask &#039;255.0.0.0&#039;<br />ssh: connect to host 192.168.2.111 port 22: Operation timed out<br />Sams-MacBook-Pro-3:~ samseawright$ <br />Sams-MacBook-Pro-3:~ samseawright$ ssh root@192.168.2.111<br />ssh: connect to host 192.168.2.111 port 22: Operation timed out<br />Sams-MacBook-Pro-3:~ samseawright$ <br />Sams-MacBook-Pro-3:~ samseawright$ ping google.com<br />PING google.com (173.194.43.1): 56 data bytes<br />64 bytes from 173.194.43.1: icmp_seq=0 ttl=57 time=127.991 ms</p><p>I am plugging my ethernet into a cat5 wall plug that is connected to my wife&#039;s business network, I have no idea what is in-between the router and the gateway router. Should I plug directly into the gateway router<br />Thanks again!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p226660">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">glenten</div>
					<div class="post-datetime">
						2 Mar 2014, 23:01					</div>
				</div>
				<div class="post-content content">
					<p>When you were in failsafe mode, did you reset to default settings by running mount_root and firstboot (without error output)?</p><p>If I recall correctly, I think that the single Ethernet port on MR3020 is configured as WAN in default.<br />If that is so then you can&#039;t telnet/SSH into the router through that connection because of the default firewall configuration. Only through WiFi, but in default settings there&#039;s no WiFi.</p><p>When you are trying to telnet/SSH and gets &quot;Connection refused&quot; you are likely rejected by the firewall of MR3020.<br />When you get &quot;Operation timed out&quot; you are most likely entering a wrong IP address or haven&#039;t connected router etc. correctly (unless the firewall is configured to drop traffic, then you would also experience timeout).</p><p>I will suggest that you enter failsafe again.<br />When you have the MR3020 in failsafe and have telnet&#039;ed in by; telnet 192.168.1.1<br />you should run mount_root and see something like this;<br /></p><div class="codebox"><pre><code>$ telnet 192.168.1.1
Trying 192.168.1.1...
Connected to 192.168.1.1.</code></pre></div><div class="codebox"><pre><code>root@(none):/# mount_root
mount_root: jffs2 is ready</code></pre></div><p>If you get something else when running mount_root please post that output.</p><p>After a successful mount_root you could;<br /></p><div class="codebox"><pre><code>cat /etc/config/network</code></pre></div><p>and post the output here.</p><p>If that output has something like;<br /></p><div class="codebox"><pre><code>config interface &#039;wan&#039;
        option ifname &#039;eth0&#039;
        option proto &#039;dhcp&#039;</code></pre></div><p>You have to make some changes (open the firewall for SSH / change Eth0 to lan so there is no firewall at all / enable WiFi)</p><p>Do you know how to edit the configuration files by the VI editor?</p>											<p class="post-edited">(Last edited by <strong>glenten</strong> on 2 Mar 2014, 23:03)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p226665">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">samseawright</div>
					<div class="post-datetime">
						2 Mar 2014, 23:45					</div>
				</div>
				<div class="post-content content">
					<p>Great stuff and interestingly beginning to make since. I have a vi &#039;cheat sheet&quot; but have not ventured into editing in it. Your help is greatly appreciated, particularly since I am a complete stranger. Thank you many times over and I&#039;m sure I will need more help later.<br />Best,<br />Sam</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p226666">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">samseawright</div>
					<div class="post-datetime">
						3 Mar 2014, 00:01					</div>
				</div>
				<div class="post-content content">
					<p>Here are latest results after mount-root.<br />root@(none):/# mount_root<br />/sbin/mount_root: line 1: pi_include: not found<br />/sbin/mount_root: line 1: pi_include: not found<br />/sbin/mount_root: line 1: set_jffs_mp: not found<br />/sbin/mount_root: line 1: determine_root_device: not found<br />/sbin/mount_root: line 1: can&#039;t create /.extroot.md5sum: Read-only file system<br />switching to jffs2<br />root@(none):/# <br />root@(none):/# mount_root<br />/sbin/mount_root: line 1: pi_include: not found<br />/sbin/mount_root: line 1: pi_include: not found<br />/sbin/mount_root: line 1: set_jffs_mp: not found<br />/sbin/mount_root: line 1: determine_root_device: not found<br />switching to jffs2<br />root@(none):/# mount_root<br />/sbin/mount_root: line 1: pi_include: not found<br />/sbin/mount_root: line 1: pi_include: not found<br />/sbin/mount_root: line 1: set_jffs_mp: not found<br />/sbin/mount_root: line 1: determine_root_device: not found<br />switching to jffs2<br />mount: mounting overlayfs:/overlay on /mnt failed: Invalid argument<br />mount: mounting /proc on /overlay/proc failed: No such file or directory<br />jffs2 not ready yet; using ramdisk<br />mount: mounting overlayfs:/tmp/root on /mnt failed: Invalid argument<br />creating directories... done<br />setting up symlinks... done<br />pivot_root: No such file or directory<br />Could not open mtd device: rootfs<br />Could not open mtd device: rootfs<br />root@(none):/#</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p226669">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">glenten</div>
					<div class="post-datetime">
						3 Mar 2014, 00:28					</div>
				</div>
				<div class="post-content content">
					<p>You&#039;re very welcome <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><br /><p>Only run mount_root once.<br />I think, that you can ignore the &quot;not found lines&quot;.<br />Important is to get the &quot;switching to jffs2&quot;.</p><p>Please post the output of (run one command at a time);<br /></p><div class="codebox"><pre><code>cat /etc/config/network
cat /etc/config/wireless
cat /etc/config/firewall</code></pre></div><p>Then I can suggest what to alter with the vi editor.</p><p>If you can&#039;t cat /etc/config/network then probably mount_root didn&#039;t succeed.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p226670">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">samseawright</div>
					<div class="post-datetime">
						3 Mar 2014, 00:29					</div>
				</div>
				<div class="post-content content">
					<p>root@(none):/# mount_root<br />/sbin/mount_root: line 1: pi_include: not found<br />/sbin/mount_root: line 1: pi_include: not found<br />/sbin/mount_root: line 1: set_jffs_mp: not found<br />/sbin/mount_root: line 1: determine_root_device: not found<br />/sbin/mount_root: line 1: can&#039;t create /.extroot.md5sum: Read-only file system<br />switching to jffs2<br />root@(none):/# cat /etc/config/network</p><p>config interface &#039;loopback&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;lo&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;127.0.0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.0.0.0&#039;</p><p>config interface &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option type &#039;bridge&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;192.168.1.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;</p><p>root@(none):/#</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p226671">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">samseawright</div>
					<div class="post-datetime">
						3 Mar 2014, 00:36					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for education. Heres where I&#039;m at following your latest suggested entries:</p><p> -----------------------------------------------------<br />root@(none):/# mount_root<br />/sbin/mount_root: line 1: pi_include: not found<br />/sbin/mount_root: line 1: pi_include: not found<br />/sbin/mount_root: line 1: set_jffs_mp: not found<br />/sbin/mount_root: line 1: determine_root_device: not found<br />/sbin/mount_root: line 1: can&#039;t create /.extroot.md5sum: Read-only file system<br />switching to jffs2<br />root@(none):/# cat /etc/config/network</p><p>config interface &#039;loopback&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;lo&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;127.0.0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.0.0.0&#039;</p><p>config interface &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option type &#039;bridge&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;192.168.1.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;</p><p>root@(none):/# cat /etc/config/wireless<br />config wifi-device&nbsp; radio0<br />&nbsp; &nbsp; &nbsp; &nbsp; option type&nbsp; &nbsp; &nbsp;mac80211<br />&nbsp; &nbsp; &nbsp; &nbsp; option channel&nbsp; 11<br />&nbsp; &nbsp; &nbsp; &nbsp; option macaddr&nbsp; 64:66:b3:79:20:c8<br />&nbsp; &nbsp; &nbsp; &nbsp; option hwmode&nbsp; &nbsp;11ng<br />&nbsp; &nbsp; &nbsp; &nbsp; option htmode&nbsp; &nbsp;HT20<br />&nbsp; &nbsp; &nbsp; &nbsp; list ht_capab&nbsp; &nbsp;SHORT-GI-20<br />&nbsp; &nbsp; &nbsp; &nbsp; list ht_capab&nbsp; &nbsp;SHORT-GI-40<br />&nbsp; &nbsp; &nbsp; &nbsp; list ht_capab&nbsp; &nbsp;RX-STBC1<br />&nbsp; &nbsp; &nbsp; &nbsp; list ht_capab&nbsp; &nbsp;DSSS_CCK-40<br />&nbsp; &nbsp; &nbsp; &nbsp; # REMOVE THIS LINE TO ENABLE WIFI:<br />&nbsp; &nbsp; &nbsp; &nbsp; option disabled 1</p><p>config wifi-iface<br />&nbsp; &nbsp; &nbsp; &nbsp; option device&nbsp; &nbsp;radio0<br />&nbsp; &nbsp; &nbsp; &nbsp; option network&nbsp; lan<br />&nbsp; &nbsp; &nbsp; &nbsp; option mode&nbsp; &nbsp; &nbsp;ap<br />&nbsp; &nbsp; &nbsp; &nbsp; option ssid&nbsp; &nbsp; &nbsp;OpenWrt<br />&nbsp; &nbsp; &nbsp; &nbsp; option encryption none</p><p>root@(none):/# cat /etc/config/firewall<br />config defaults<br />&nbsp; &nbsp; &nbsp; &nbsp; option syn_flood&nbsp; &nbsp; &nbsp; &nbsp; 1<br />&nbsp; &nbsp; &nbsp; &nbsp; option input&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ACCEPT<br />&nbsp; &nbsp; &nbsp; &nbsp; option output&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ACCEPT<br />&nbsp; &nbsp; &nbsp; &nbsp; option forward&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; REJECT<br /># Uncomment this line to disable ipv6 rules<br />#&nbsp; &nbsp; &nbsp; &nbsp;option disable_ipv6&nbsp; &nbsp; &nbsp;1</p><p>config zone<br />&nbsp; &nbsp; &nbsp; &nbsp; option name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;lan<br />&nbsp; &nbsp; &nbsp; &nbsp; option network&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option input&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ACCEPT<br />&nbsp; &nbsp; &nbsp; &nbsp; option output&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ACCEPT<br />&nbsp; &nbsp; &nbsp; &nbsp; option forward&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; REJECT</p><p>config zone<br />&nbsp; &nbsp; &nbsp; &nbsp; option name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;wan<br />&nbsp; &nbsp; &nbsp; &nbsp; option network&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#039;wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option input&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; REJECT<br />&nbsp; &nbsp; &nbsp; &nbsp; option output&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ACCEPT<br />&nbsp; &nbsp; &nbsp; &nbsp; option forward&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; REJECT<br />&nbsp; &nbsp; &nbsp; &nbsp; option masq&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1<br />&nbsp; &nbsp; &nbsp; &nbsp; option mtu_fix&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1</p><p>config forwarding<br />&nbsp; &nbsp; &nbsp; &nbsp; option src&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lan<br />&nbsp; &nbsp; &nbsp; &nbsp; option dest&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;wan</p><p># We need to accept udp packets on port 68,<br /># see <a href="https://dev.openwrt.org/ticket/4108">https://dev.openwrt.org/ticket/4108</a><br />config rule<br />&nbsp; &nbsp; &nbsp; &nbsp; option name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Allow-DHCP-Renew<br />&nbsp; &nbsp; &nbsp; &nbsp; option src&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; wan<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; udp<br />&nbsp; &nbsp; &nbsp; &nbsp; option dest_port&nbsp; &nbsp; &nbsp; &nbsp; 68<br />&nbsp; &nbsp; &nbsp; &nbsp; option target&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ACCEPT<br />&nbsp; &nbsp; &nbsp; &nbsp; option family&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ipv4</p><p># Allow IPv4 ping<br />config rule<br />&nbsp; &nbsp; &nbsp; &nbsp; option name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Allow-Ping<br />&nbsp; &nbsp; &nbsp; &nbsp; option src&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; wan<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; icmp<br />&nbsp; &nbsp; &nbsp; &nbsp; option icmp_type&nbsp; &nbsp; &nbsp; &nbsp; echo-request<br />&nbsp; &nbsp; &nbsp; &nbsp; option family&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ipv4<br />&nbsp; &nbsp; &nbsp; &nbsp; option target&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ACCEPT</p><p># Allow DHCPv6 replies<br /># see <a href="https://dev.openwrt.org/ticket/10381">https://dev.openwrt.org/ticket/10381</a><br />config rule<br />&nbsp; &nbsp; &nbsp; &nbsp; option name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Allow-DHCPv6<br />&nbsp; &nbsp; &nbsp; &nbsp; option src&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; wan<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; udp<br />&nbsp; &nbsp; &nbsp; &nbsp; option src_ip&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;fe80::/10<br />&nbsp; &nbsp; &nbsp; &nbsp; option src_port&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;547<br />&nbsp; &nbsp; &nbsp; &nbsp; option dest_ip&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fe80::/10<br />&nbsp; &nbsp; &nbsp; &nbsp; option dest_port&nbsp; &nbsp; &nbsp; &nbsp; 546<br />&nbsp; &nbsp; &nbsp; &nbsp; option family&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ipv6<br />&nbsp; &nbsp; &nbsp; &nbsp; option target&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ACCEPT</p><p># Allow essential incoming IPv6 ICMP traffic<br />config rule<br />&nbsp; &nbsp; &nbsp; &nbsp; option name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Allow-ICMPv6-Input<br />&nbsp; &nbsp; &nbsp; &nbsp; option src&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; wan<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto&nbsp; &nbsp; icmp<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo-request<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo-reply<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; destination-unreachable<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; packet-too-big<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; time-exceeded<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bad-header<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unknown-header-type<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; router-solicitation<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; neighbour-solicitation<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; router-advertisement<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; neighbour-advertisement<br />&nbsp; &nbsp; &nbsp; &nbsp; option limit&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1000/sec<br />&nbsp; &nbsp; &nbsp; &nbsp; option family&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ipv6<br />&nbsp; &nbsp; &nbsp; &nbsp; option target&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ACCEPT</p><p># Allow essential forwarded IPv6 ICMP traffic<br />config rule<br />&nbsp; &nbsp; &nbsp; &nbsp; option name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Allow-ICMPv6-Forward<br />&nbsp; &nbsp; &nbsp; &nbsp; option src&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; wan<br />&nbsp; &nbsp; &nbsp; &nbsp; option dest&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; icmp<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo-request<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo-reply<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; destination-unreachable<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; packet-too-big<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; time-exceeded<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bad-header<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unknown-header-type<br />&nbsp; &nbsp; &nbsp; &nbsp; option limit&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1000/sec<br />&nbsp; &nbsp; &nbsp; &nbsp; option family&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ipv6<br />&nbsp; &nbsp; &nbsp; &nbsp; option target&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ACCEPT</p><p># include a file with users custom iptables rules<br />config include<br />&nbsp; &nbsp; &nbsp; &nbsp; option path /etc/firewall.user</p><br /><p>### EXAMPLE CONFIG SECTIONS<br /># do not allow a specific ip to access wan<br />#config rule<br />#&nbsp; &nbsp; &nbsp; &nbsp;option src&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lan<br />#&nbsp; &nbsp; &nbsp; &nbsp;option src_ip&nbsp; &nbsp;192.168.45.2<br />#&nbsp; &nbsp; &nbsp; &nbsp;option dest&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;wan<br />#&nbsp; &nbsp; &nbsp; &nbsp;option proto&nbsp; &nbsp; tcp<br />#&nbsp; &nbsp; &nbsp; &nbsp;option target&nbsp; &nbsp;REJECT</p><p># block a specific mac on wan<br />#config rule<br />#&nbsp; &nbsp; &nbsp; &nbsp;option dest&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;wan<br />#&nbsp; &nbsp; &nbsp; &nbsp;option src_mac&nbsp; 00:11:22:33:44:66<br />#&nbsp; &nbsp; &nbsp; &nbsp;option target&nbsp; &nbsp;REJECT</p><p># block incoming ICMP traffic on a zone<br />#config rule<br />#&nbsp; &nbsp; &nbsp; &nbsp;option src&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lan<br />#&nbsp; &nbsp; &nbsp; &nbsp;option proto&nbsp; &nbsp; ICMP<br />#&nbsp; &nbsp; &nbsp; &nbsp;option target&nbsp; &nbsp;DROP</p><p># port redirect port coming in on wan to lan<br />#config redirect<br />#&nbsp; &nbsp; &nbsp; &nbsp;option src&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; wan<br />#&nbsp; &nbsp; &nbsp; &nbsp;option src_dport&nbsp; &nbsp; &nbsp; &nbsp; 80<br />#&nbsp; &nbsp; &nbsp; &nbsp;option dest&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;lan<br />#&nbsp; &nbsp; &nbsp; &nbsp;option dest_ip&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 192.168.16.235<br />#&nbsp; &nbsp; &nbsp; &nbsp;option dest_port&nbsp; &nbsp; &nbsp; &nbsp; 80<br />#&nbsp; &nbsp; &nbsp; &nbsp;option proto&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tcp</p><p># port redirect of remapped ssh port (22001) on wan<br />#config redirect<br />#&nbsp; &nbsp; &nbsp; &nbsp;option src&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; wan<br />#&nbsp; &nbsp; &nbsp; &nbsp;option src_dport&nbsp; &nbsp; &nbsp; &nbsp; 22001<br />#&nbsp; &nbsp; &nbsp; &nbsp;option dest&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;lan<br />#&nbsp; &nbsp; &nbsp; &nbsp;option dest_port&nbsp; &nbsp; &nbsp; &nbsp; 22<br />#&nbsp; &nbsp; &nbsp; &nbsp;option proto&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tcp</p><p># allow IPsec/ESP and ISAKMP passthrough<br />#config rule<br />#&nbsp; &nbsp; &nbsp; &nbsp;option src&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; wan<br />#&nbsp; &nbsp; &nbsp; &nbsp;option dest&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;lan<br />#&nbsp; &nbsp; &nbsp; &nbsp;option protocol&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;esp<br />#&nbsp; &nbsp; &nbsp; &nbsp;option target&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ACCEPT</p><p>#config rule<br />#&nbsp; &nbsp; &nbsp; &nbsp;option src&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; wan<br />#&nbsp; &nbsp; &nbsp; &nbsp;option dest&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;lan<br />#&nbsp; &nbsp; &nbsp; &nbsp;option src_port&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;500<br />#&nbsp; &nbsp; &nbsp; &nbsp;option dest_port&nbsp; &nbsp; &nbsp; &nbsp; 500<br />#&nbsp; &nbsp; &nbsp; &nbsp;option proto&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; udp<br />#&nbsp; &nbsp; &nbsp; &nbsp;option target&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ACCEPT</p><p>### FULL CONFIG SECTIONS<br />#config rule<br />#&nbsp; &nbsp; &nbsp; &nbsp;option src&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lan<br />#&nbsp; &nbsp; &nbsp; &nbsp;option src_ip&nbsp; &nbsp;192.168.45.2<br />#&nbsp; &nbsp; &nbsp; &nbsp;option src_mac&nbsp; 00:11:22:33:44:55<br />#&nbsp; &nbsp; &nbsp; &nbsp;option src_port 80<br />#&nbsp; &nbsp; &nbsp; &nbsp;option dest&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;wan<br />#&nbsp; &nbsp; &nbsp; &nbsp;option dest_ip&nbsp; 194.25.2.129<br />#&nbsp; &nbsp; &nbsp; &nbsp;option dest_port&nbsp; &nbsp; &nbsp; &nbsp; 120<br />#&nbsp; &nbsp; &nbsp; &nbsp;option proto&nbsp; &nbsp; tcp<br />#&nbsp; &nbsp; &nbsp; &nbsp;option target&nbsp; &nbsp;REJECT</p><p>#config redirect<br />#&nbsp; &nbsp; &nbsp; &nbsp;option src&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lan<br />#&nbsp; &nbsp; &nbsp; &nbsp;option src_ip&nbsp; &nbsp;192.168.45.2<br />#&nbsp; &nbsp; &nbsp; &nbsp;option src_mac&nbsp; 00:11:22:33:44:55<br />#&nbsp; &nbsp; &nbsp; &nbsp;option src_port&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1024<br />#&nbsp; &nbsp; &nbsp; &nbsp;option src_dport&nbsp; &nbsp; &nbsp; &nbsp; 80<br />#&nbsp; &nbsp; &nbsp; &nbsp;option dest_ip&nbsp; 194.25.2.129<br />#&nbsp; &nbsp; &nbsp; &nbsp;option dest_port&nbsp; &nbsp; &nbsp; &nbsp; 120<br />#&nbsp; &nbsp; &nbsp; &nbsp;option proto&nbsp; &nbsp; tcp<br />root@(none):/#</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p226673">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">glenten</div>
					<div class="post-datetime">
						3 Mar 2014, 01:21					</div>
				</div>
				<div class="post-content content">
					<p>With the configuration you posted, your Ethernet port is configured as LAN with static IP address. Therefore it will not require an IP address via DHCP when it&#039;s connected by cable to your regular Internet equipment.</p><p>I can post how to change that and enable WiFi. But I&#039;m in doubt, what is your actual end goal may I ask? How do you aim at having things connected and configured? Did you already get the upgrade as you wished so you only miss the configuration part?<br />You posted some earlier from a guide. Are you aiming at doing a LibraryBox?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p226674">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">glenten</div>
					<div class="post-datetime">
						3 Mar 2014, 01:25					</div>
				</div>
				<div class="post-content content">
					<p>Another thing.. when the Ethernet port is configured as LAN I would expect that you should be able to either telnet or SSH (depending whether you have set the password) into the MR3020 when it is connected to your laptop by cable, without putting MR3020 into failsafe mode.</p>											<p class="post-edited">(Last edited by <strong>glenten</strong> on 3 Mar 2014, 01:26)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p226676">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">samseawright</div>
					<div class="post-datetime">
						3 Mar 2014, 01:55					</div>
				</div>
				<div class="post-content content">
					<p>Yes,I&#039;m trying to make a david darts pirate box and later if all works a library box. I never expected the problems that I&#039;ve encountered since undertaking the project. on his web site, it seems so simple. here is the command line for installing the pirate box software onto the thumb drive on the MR3020:<br />cd /tmp<br />opkg update &amp;&amp; opkg install <a href="http://piratebox.aod-rpg.de/piratebox_0.6.3_all.ipk">http://piratebox.aod-rpg.de/piratebox_0.6.3_all.ipk</a><br />Also,<br />failsafe was the way I could find to connect with the router.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p226797">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">glenten</div>
					<div class="post-datetime">
						4 Mar 2014, 18:01					</div>
				</div>
				<div class="post-content content">
					<p>Is it this one your are following? <a href="http://daviddarts.com/piratebox-diy-openwrt/">http://daviddarts.com/piratebox-diy-openwrt/</a></p><p>I&#039;m not familiar with PirateBox or LibraryBox besides the overall concept.<br />The instructions on <a href="http://daviddarts.com/piratebox-diy-openwrt/">http://daviddarts.com/piratebox-diy-openwrt/</a> assumes a specific configuration of your existing Internet equipment, I would expect that your router would be handing out addresses by DHCP so I would propose to set it up like that instead.</p><p>In /etc/config/network you had;<br /></p><div class="codebox"><pre><code>root@(none):/# cat /etc/config/network

config interface &#039;loopback&#039;
        option ifname &#039;lo&#039;
        option proto &#039;static&#039;
        option ipaddr &#039;127.0.0.1&#039;
        option netmask &#039;255.0.0.0&#039;

config interface &#039;lan&#039;
        option ifname &#039;eth0&#039;
        option type &#039;bridge&#039;
        option proto &#039;static&#039;
        option ipaddr &#039;192.168.1.1&#039;
        option netmask &#039;255.255.255.0&#039;</code></pre></div><p>If you uncomment/substitute the lines in the lan section with;<br /></p><div class="codebox"><pre><code>config interface &#039;wan&#039;
    option ifname &#039;eth0&#039;
    option proto &#039;dhcp&#039;</code></pre></div><p>Then you should be able to get Internet connection for the MR3020 by cable to your existing router.</p><br /><br /><p>To enable wireless and access the router from LAN;<br /></p><div class="codebox"><pre><code>vi /etc/config/wireless</code></pre></div><p>Change the 1 to a 0 in &quot;option disabled 1&quot;<br />so it gets &quot;option disabled 0&quot; or remove the whole line.</p><p>Change &quot;option encryption none&quot; -&gt; &quot;option encryption psk2&quot;</p><p>Add an extra line under &quot;option encryption psk2&quot;<br />with &quot;option key password&quot; (with a password of your choosing)</p><p>When you&#039;re done it should look like;<br /></p><div class="codebox"><pre><code>config wifi-device  radio0
        option type     mac80211
        option channel  11
        option macaddr  64:66:b3:79:20:c8
        option hwmode   11ng
        option htmode   HT20
        list ht_capab   SHORT-GI-20
        list ht_capab   SHORT-GI-40
        list ht_capab   RX-STBC1
        list ht_capab   DSSS_CCK-40
        # REMOVE THIS LINE TO ENABLE WIFI:
        option disabled 0

config wifi-iface
        option device   radio0
        option network  lan
        option mode     ap
        option ssid     OpenWrt
        option encryption psk2
        option key      password</code></pre></div><p>Then you should hopefully be able to connect wireless to MR3020 from your laptop and telnet/SSH in via 192.168.1.1</p><p>By the way, <a href="http://wiki.openwrt.org/doc/uci/network#interfaces">http://wiki.openwrt.org/doc/uci/network#interfaces</a> is a very good reference.<br />And so is <a href="http://wiki.openwrt.org/doc/uci/wireless">http://wiki.openwrt.org/doc/uci/wireless</a> and <a href="http://wiki.openwrt.org/doc/uci/firewall">http://wiki.openwrt.org/doc/uci/firewall</a></p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>