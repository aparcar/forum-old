<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Poor wifi performance</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 10 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p280799">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">fenris</div>
					<div class="post-datetime">
						20 Jun 2015, 12:43					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve been given an HP laptop that I&#039;m trying to connect via wifi. Archer C5 with BB. LuCI says the bitrate is 150Mbps, but on downloads and operations over NFS i typically max out at a little over 2Mpbs, which is unbearable. The wifi adapter in the HP is from Intel:</p><p>02:00.0 Network controller: Intel Corporation Centrino Wireless-N 1000 [Condor Peak]</p><p>Wifi settings:<br />config wifi-device &#039;radio1&#039;<br />&nbsp; &nbsp; option type &#039;mac80211&#039;<br />&nbsp; &nbsp; option hwmode &#039;11g&#039;<br />&nbsp; &nbsp; option path &#039;platform/qca955x_wmac&#039;<br />&nbsp; &nbsp; option htmode &#039;HT40&#039;<br />&nbsp; &nbsp; option channel &#039;6&#039;<br />&nbsp; &nbsp; option country &#039;NO&#039;<br />&nbsp; &nbsp; option txpower &#039;20&#039;</p><p>Is there anything I can try to get better performance, or do I need to get a new wifi card? If so, the dealer I use has a mini-PCIe card called &quot;Intel Dual Band Wireless-AC 7260&quot; - has anyone got any experience with that?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p280823">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">tomrev</div>
					<div class="post-datetime">
						20 Jun 2015, 18:29					</div>
				</div>
				<div class="post-content content">
					<p>Your router is quite powerful that shouldn&#039;t have slow transfer rate like that. What your storage you use? The USB flash drive may be bottleneck. </p><p>Interference may be the culprit. Try change&nbsp; &quot;option htmode &#039;HT40&#039; &quot; to &quot;option htmode &#039;HT20&#039; &quot; or reduce txpower to lower value may help.</p><p>If possible try to use other wireless or wifi adapter to test.</p><p>edit: HT40 -&gt; HT20, Thanks fenris for correct word and not mention my mistake. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>											<p class="post-edited">(Last edited by <strong>tomrev</strong> on 21 Jun 2015, 06:12)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p280838">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">fenris</div>
					<div class="post-datetime">
						20 Jun 2015, 21:59					</div>
				</div>
				<div class="post-content content">
					<p>Changing htmode to HT20 didn&#039;t do anything, neither did lowering the power. USB doesn&#039;t come into play here, NFS isn&#039;t mounted from the router, but from a box connected to it via gigabit ethernet.</p><p>I have no other adapters to try with, but I&#039;m considering buying the one mentioned in my first post.</p><p>With iperf3 I&#039;ve managed to squeeze out a little over 10Mbps, but I get nothing near that in regular use.</p><p>Any other ideas?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p280869">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">tomrev</div>
					<div class="post-datetime">
						21 Jun 2015, 06:16					</div>
				</div>
				<div class="post-content content">
					<p>Do you add firewall rules correctly? </p><p>Guide here -&gt; <a href="http://wiki.openwrt.org/doc/howto/nfs.server">http://wiki.openwrt.org/doc/howto/nfs.server</a> also have several optimization.</p>											<p class="post-edited">(Last edited by <strong>tomrev</strong> on 21 Jun 2015, 06:19)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p281211">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">fenris</div>
					<div class="post-datetime">
						24 Jun 2015, 11:45					</div>
				</div>
				<div class="post-content content">
					<p>There are no firewall or traffic shaping rules that come into play here, and the bad performance is not isolated to NFS - downloading files, for instance, also peak at about 2Mbps. Connecting with a cable gives me the performance I expect.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p281283">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">drawz</div>
					<div class="post-datetime">
						25 Jun 2015, 04:42					</div>
				</div>
				<div class="post-content content">
					<p>Are there other routers on the same or overlapping channels? Have you tried the 5 GHz band? Chaos Calmer may work better, but unless you can install Luci from command line, wait for the next RC or final.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p281737">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">fenris</div>
					<div class="post-datetime">
						29 Jun 2015, 10:01					</div>
				</div>
				<div class="post-content content">
					<p>There are very few other routers around here, and not close enough that they should cause problems. Different channels doesn&#039;t seem to have any effect, I&#039;m currently on 6, which is the one with the least interference (even though all are pretty clean). I can&#039;t try 5GHz, since I haven&#039;t got any clients for it.</p><p>Running a wifi analyzer on my phone the signal strength is about -60DBm, and it can only see one other network, at so low signal strength that it is barely detected.</p><p>I also tried running a speedtest on my Android phone, and it also tops out at about 10Mbps. Apart from a printer those are the only two wireless clients I have, but it makes me pretty sure that the router is the problem. With the phone I just hadn&#039;t noticed it before, since I rarely use it for anything that involves wifi.</p><p>I guess I&#039;ll have to try CC, which will be a pain because I have a lot of configuration and stuff to move over. Installing LuCI is no problem. It would be much better to get BB to work properly, though. Is there anything else I can try, other than giving up and install CC?</p><p>I&#039;m a little worried that CC will be the same, which would force me to revert to stock firmware, and I *really* don&#039;t want to do that.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p281772">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">mk24</div>
					<div class="post-datetime">
						29 Jun 2015, 17:13					</div>
				</div>
				<div class="post-content content">
					<p>The antennas in the laptop are likely single band, so it won&#039;t work well to simply slap in a dual band PCIe card.&nbsp; Also some laptops have a BIOS lock against replacing the wifi card with a different model.&nbsp; You could of course try USB cards.</p><p>There have been quite a few developments and improvements to the ath10k driver lately so going to a newer firmware is likely to help.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p281780">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">fenris</div>
					<div class="post-datetime">
						29 Jun 2015, 18:18					</div>
				</div>
				<div class="post-content content">
					<p>It&#039;s unclear what kind of antennas are in the laptop from the manual, so you probably have a point there. I&#039;ve asked HP, and they said the BIOS has no white/blacklist of accepted cards, but USB might still be better.</p><p>But that&#039;s still unlikely to be the problem, as my phone has the same problem - it tops out at about 10Mbps. This is also all on 2.4GHz 802.11b/g/n, so improvements in ath10k are unlikely to help, as I only really use ath9k.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p281831">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">golialive</div>
					<div class="post-datetime">
						30 Jun 2015, 00:07					</div>
				</div>
				<div class="post-content content">
					<p>Hey there.</p><p>You could start with taking the laptop to another wifi setup on one hand and use another wifi client device on the c5 on the ther hand. If the laptop works on another wifi setup as expected, then the laptop is not your problem. If another wifi client device works on your c5 as expected, then the router is not your problem. If both work in different environments properlay, they just don&#039;t want to play nicely.</p><p>Although it happens rarely, sometimes the laptop antennas aren&#039;t properly contected to the laptop wifi card. You could just open the laptops maintenance slot hand have a look.</p><p>Regards,<br />Stephan.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p281832">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">drawz</div>
					<div class="post-datetime">
						30 Jun 2015, 00:14					</div>
				</div>
				<div class="post-content content">
					<p>How are you sharing files again?<br />Does stock firmware work properly? With proper signal strength?<br />What hardware rev?</p><p>It almost sounds like an amplifier is not turned on or something.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p281857">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">fenris</div>
					<div class="post-datetime">
						30 Jun 2015, 09:36					</div>
				</div>
				<div class="post-content content">
					<p>I should have made this clear earlier: I have tried the laptop elsewhere, and it works perfectly there. Other wifi clients have the same problem on the C5.</p><p>drawz: I&#039;m sharing files over NFS, from a box connected to one of the ports of the router&#039;s switch. Other machines, connected with a cable, get good performance, so it&#039;s not my NFS setup. As I&#039;ve mentioned before, *all* network performance is abysmal, not just NFS. The main reason I mentioned NFS was just to clarify that this is not a problem with my uplink, wired clients get close to 100Mbps. I haven&#039;t used stock firmware since I bought the router, but I had no problems with it then. Hardware rev is 1.20. If an amplifier isn&#039;t turned on, as you say, is that only for the one radio? In that case, maybe I could get a new wifi adapter for the laptop that supports the other radio...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p281969">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">drawz</div>
					<div class="post-datetime">
						1 Jul 2015, 05:11					</div>
				</div>
				<div class="post-content content">
					<p>The amplifiers are per radio and that is pure speculation. If that were the problem, I would imagine that a newer OpenWrt build would have fixed this. I would either try CC rc2 (note that you do have to install luci manually from command line), wait for CC final, or revert to stock. Reverting to stock would mostly tell you if it&#039;s a genuine hardware problem.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p281988">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">fenris</div>
					<div class="post-datetime">
						1 Jul 2015, 11:24					</div>
				</div>
				<div class="post-content content">
					<p>OK, thanks a lot for all the tips I&#039;ve gotten in this thread. I have never really had any real need to use wifi for anything up until now when I got the laptop, so there&#039;s a lot I don&#039;t know and understand about it, and this has been educational.</p><p>I bought an ac USB adapter yesterday, so I&#039;ll flash CCrc2 today and see how that turns out, it will also allow me to set up an AP on one of my PC&#039;s to determine if the router is the problem.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>