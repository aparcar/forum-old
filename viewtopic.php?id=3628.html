<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> nvram is the wrong choice as master config</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 29 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p16985">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Purist</div>
					<div class="post-datetime">
						11 Dec 2005, 01:16					</div>
				</div>
				<div class="post-content content">
					<p>After spending nearly a day &quot;configuring&quot; OpenWRT (stable RC4) by altering<br />most init scripts, effectively forking my own private distro, I&#039;ve decided to<br />post here my reasons for doing so. Hopefully this post will be perceived as<br />constructive criticism and not merely flaimbait.</p><p>My reason for choosing OpenWRT was that I could use the full power of a shell<br />based distro and not be limited by some web interface (Linksys or some other<br />&lt;cool name&gt;WRT). Unfortunately, I&#039;ve discovered quickly that the limits of the<br />web interface were preserved in a lower layer, i.e. the miscrosoftish nvram<br />registry, which OpenWRT unfortunately adopted.</p><p>Perusing some of the posts here, I&#039;ve discovered that using the nvram as<br />master config was a design decisions of the OpenWRT team. I&#039;m trying to<br />argue two points: (1) that keeping the nvram as master config is wrong for a<br />shell focused distro, and (2) that similar Linksys compatibility can be<br />achieved by a less annoying import/export procedure.</p><p>(1) The nvram registry makes perfect sense for a firmware that lacks a<br />&nbsp; &nbsp; writable file system, and is web focused, i.e. Linksys and clones.<br />&nbsp; &nbsp; The &quot;param=value&quot; paradigm fits web applications like a glove.</p><p>&nbsp; &nbsp; When a writable file system is available, keeping the nvram as master<br />&nbsp; &nbsp; config is a bad decision. Many important kernel features (e.g. iptables<br />&nbsp; &nbsp; firewall) and applications (e.g. dnsmasq) require more powerful languages<br />&nbsp; &nbsp; than &quot;param=value&quot; offers. The OpenWRT compatibility with Linksys firmware<br />&nbsp; &nbsp; is fairly limited anyway, as as illustrated by OpenWRT ignoring the<br />&nbsp; &nbsp; important wk_mode parameter. Having the init scripts rewrite the firewall<br />&nbsp; &nbsp; rules on every boot to fit wk_mode, which thankfully is not done,<br />&nbsp; &nbsp; illustrates the limitations of the nvram as master config. OpenWRT has to<br />&nbsp; &nbsp; play a constant catchup game if it really wants to keep up with the<br />&nbsp; &nbsp; plethora of Linksys parameters.</p><p>&nbsp; &nbsp; I found the master nvram approach very annoying in some specific cases. An<br />&nbsp; &nbsp; example is the deletion at boot time of /etc/resolv.conf if<br />&nbsp; &nbsp; lan_dns is not set, even if lan_proto=static. An even more annoying one<br />&nbsp; &nbsp; was the dnsmasq init script: it added wrong DHCP ranges, which were<br />&nbsp; &nbsp; impossible to fix using the nvram. I have multiple subnets connected to<br />&nbsp; &nbsp; the WRT, so a single nvram &quot;lan&quot; setting is not feasible, whereas I can<br />&nbsp; &nbsp; easily specify them in dnsmasq.conf.</p><p>(2) So what&#039;s the solution? Mine was to effectively import the settings into<br />&nbsp; &nbsp; /etc files, sometimes manually, e.g. for wk_mode, and _prevent_ the boot<br />&nbsp; &nbsp; scripts from subsequently changing them. The import could easily be<br />&nbsp; &nbsp; automated in the firstboot script. The import approach (as opposed to<br />&nbsp; &nbsp; master) has the added benefit that one can use config files from most<br />&nbsp; &nbsp; other LSB (Linux Standards Base) disk based distro&#039;s. E.g, I&#039;ve imported<br />&nbsp; &nbsp; quagga rip config from a disk based box; quagga init script thankfully<br />&nbsp; &nbsp; didn&#039;t read the nvram at all.</p><p>&nbsp; &nbsp; I personally don&#039;t care at all about exporting to nvram. Most people<br />&nbsp; &nbsp; choosing to use OpenWRT would only care about import anyway, as long as<br />&nbsp; &nbsp; the nvram is preserved, which will allow them to back out of OpenWRT if a<br />&nbsp; &nbsp; shell based router is too rich for them. Exporting the config of features<br />&nbsp; &nbsp; not present in Linksys firmware (e.g. wifi_*) is pointless anyway.</p><p>&nbsp; &nbsp; Most people using a web based WRT distro are probably unaware of the nvram<br />&nbsp; &nbsp; language because they don&#039;t use it directly, while most admins would<br />&nbsp; &nbsp; probably find (like me) that using the nvram registry means learning new<br />&nbsp; &nbsp; config settings, which don&#039;t have any advantages but plenty of<br />&nbsp; &nbsp; disadvantages in a shell router.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p16987">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">wbx</div>
					<div class="post-datetime">
						11 Dec 2005, 01:43					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Purist wrote:</cite><blockquote><p>After spending nearly a day &quot;configuring&quot; OpenWRT (stable RC4) by altering<br />most init scripts, effectively forking my own private distro, I&#039;ve decided to<br />post here my reasons for doing so. Hopefully this post will be perceived as<br />constructive criticism and not merely flaimbait.</p></blockquote></div><p>It is very difficult for me, not to flame you now. Because you spent only a day and did not understand anything about the reasons behind the scene. </p><div class="quotebox"><cite>Purist wrote:</cite><blockquote><p>My reason for choosing OpenWRT was that I could use the full power of a shell<br />based distro and not be limited by some web interface (Linksys or some other<br />&lt;cool name&gt;WRT). Unfortunately, I&#039;ve discovered quickly that the limits of the<br />web interface were preserved in a lower layer, i.e. the miscrosoftish nvram<br />registry, which OpenWRT unfortunately adopted.</p></blockquote></div><p>There are some good reasons to have some backward compatibility.<br />1. Your router would not boot without nvram. You can&#039;t just remove it and use it for something else.<br />CFE, the bootloader on most of the systems we support in whiterussian, checks nvram for some stuff. (boot_wait as example).<br />2. Users which like to try OpenWrt are happy that their old configuration is used to setup the new system.<br />(just network configuration)<br />3. With 2.4 kernel and the binary only wl.o driver for the wireless chip, we need nvram to configure some of the wireless settings. et.o, the driver for the switch use nvramto setup vlan.&nbsp; </p><div class="quotebox"><cite>Purist wrote:</cite><blockquote><p>Perusing some of the posts here, I&#039;ve discovered that using the nvram as<br />master config was a design decisions of the OpenWRT team. I&#039;m trying to<br />argue two points: (1) that keeping the nvram as master config is wrong for a<br />shell focused distro, and (2) that similar Linksys compatibility can be<br />achieved by a less annoying import/export procedure.</p></blockquote></div><p>What do you think we are trying todo in the future? If it would be such a simple task, we already had it working.<br />Please feel free to submit patches. In Kamikaze our base configuration will be saved in /etc/config.<br />So please make a better research next time. You can see our efforts in our subversion repository.<br />Next release will have support for a lot more systems without nvram. (AR7/Soekris/Netgear WGT634U/..)</p><div class="quotebox"><cite>Purist wrote:</cite><blockquote><p>(2) So what&#039;s the solution? Mine was to effectively import the settings into<br />&nbsp; &nbsp; /etc files, sometimes manually, e.g. for wk_mode, and _prevent_ the boot<br />&nbsp; &nbsp; scripts from subsequently changing them. The import could easily be<br />&nbsp; &nbsp; automated in the firstboot script. The import approach (as opposed to<br />&nbsp; &nbsp; master) has the added benefit that one can use config files from most<br />&nbsp; &nbsp; other LSB (Linux Standards Base) disk based distro&#039;s. E.g, I&#039;ve imported<br />&nbsp; &nbsp; quagga rip config from a disk based box; quagga init script thankfully<br />&nbsp; &nbsp; didn&#039;t read the nvram at all.</p></blockquote></div><p>The boot scripts never change NVRAM permanently (one exception boot_wait, which is needed for recovery of a broken system). There are only some overwrites in RAM. </p><div class="quotebox"><cite>Purist wrote:</cite><blockquote><p>Most people using a web based WRT distro are probably unaware of the nvram<br />&nbsp; &nbsp; language because they don&#039;t use it directly, while most admins would<br />&nbsp; &nbsp; probably find (like me) that using the nvram registry means learning new<br />&nbsp; &nbsp; config settings, which don&#039;t have any advantages but plenty of<br />&nbsp; &nbsp; disadvantages in a shell router.</p></blockquote></div><p>Feel free to submit patches and try Kamikaze. <a href="http://dev.openwrt.org">http://dev.openwrt.org</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p16988">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">bani</div>
					<div class="post-datetime">
						11 Dec 2005, 01:43					</div>
				</div>
				<div class="post-content content">
					<p>the problem is that some of the non-free binary-only tools (eg nas) read the nvram for parameters. <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>i agree the nvram is rather limiting and arcane compared to normal scripts and config files though. redhat&#039;s /etc/sysconfig/network-scripts is pretty good for configuring and controlling interfaces.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p16995">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Purist</div>
					<div class="post-datetime">
						11 Dec 2005, 06:24					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>bani wrote:</cite><blockquote><p>the problem is that some of the non-free binary-only tools (eg nas) read the nvram for parameters. <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>i agree the nvram is rather limiting and arcane compared to normal scripts and config files though. redhat&#039;s /etc/sysconfig/network-scripts is pretty good for configuring and controlling interfaces.</p></blockquote></div><p>Keeping the interface network config in nvram is not the issue. After all, the<br />Redhat ifcfg scripts are nothing more than param=value pairs. The location is<br />not that relevant except to network init tool/scripts. If it has to be the<br />nvram for compatibility reasons, that&#039;s not really a problem. I didn&#039;t change<br />the location of those settings in my setup, simply because I didn&#039;t care where<br />they were.</p><p>The problems start when one tries to extend the param=value approach to more<br />complex apps: dns, dhcp, firewall. AFAICT, all the indispensable binary-only<br />tools (CFE included) deal only with the hardware and network interface<br />config. There&#039;s no good reason to shoehorn the other apps to use the nvram.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p16997">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">Purist</div>
					<div class="post-datetime">
						11 Dec 2005, 07:32					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>wbx wrote:</cite><blockquote><p>It is very difficult for me, not to flame you now. Because<br />you spent only a day and did not understand anything about the reasons<br />behind the scene.</p></blockquote></div><p>We&#039;re in different circles (and probably different countries) with<br />different philosophies. Most IT people I know will not spend a day<br />configuring something, they&#039;ll just buy/use another box/software which<br />can do what they want without having to bend over backwards. I consider<br />spending a day on this a reasonable time investment on my part.</p><div class="quotebox"><cite>wbx wrote:</cite><blockquote><p>There are some good reasons to have some backward<br />compatibility.&nbsp; 1. Your router would not boot without nvram. You can&#039;t<br />just remove it and use it for something else.&nbsp; CFE, the bootloader on<br />most of the systems we support in whiterussian, checks nvram for some<br />stuff. (boot_wait as example).&nbsp; 2. Users which like to try OpenWrt are<br />happy that their old configuration is used to setup the new system.<br />(just network configuration) 3. With 2.4 kernel and the binary only<br />wl.o driver for the wireless chip, we need nvram to configure some of<br />the wireless settings. et.o, the driver for the switch use nvramto<br />setup vlan.</p></blockquote></div><p>I agree with all 3 points, none of which support using the nvram for<br />anything beyond hardware and (layer 2) network interface setup. I&#039;m<br />not convinced the drivers need to know any layer 3 stuff (IP address<br />etc.), but I&#039;ve seen my fair share of silly closed source software<br />before, so I&#039;ll assume you are right.</p><div class="quotebox"><cite>wbx wrote:</cite><blockquote><p>What do you think we are trying todo in the future? If it<br />would be such a simple task, we already had it working.&nbsp; Please feel<br />free to submit patches. In Kamikaze our base configuration will be<br />saved in /etc/config.&nbsp; So please make a better research next time. You<br />can see our efforts in our subversion repository.&nbsp; Next release will<br />have support for a lot more systems without<br />nvram. (AR7/Soekris/Netgear WGT634U/..)</p></blockquote></div><p>I&#039;m sorry to have to say this, but the OpenWRT teams in not doing a<br />good job at letting people outside where White Russian is headed, and<br />even less so for Kamikaze. I couldn&#039;t find any mention of it in any<br />sticky posts or site news. There&#039;s no TODO file or even a changelog in<br />the source tree. If one has to build a mental picture from the svn<br />commit messages, then it&#039;s really more than most would be developers<br />would normally do. I&#039;m not the only one to think this:<br /><a href="http://forum.openwrt.org/viewtopic.php?id=3482">http://forum.openwrt.org/viewtopic.php?id=3482</a>. So, don&#039;t blame me for<br />not guessing what you&#039;re planning for the future.</p><p>I agree that making a unified config for all the hardware platforms<br />will be a nasty problem if various platforms need config bits in<br />different places for the binary-only stuff. Presumably you&#039;d have to<br />export enough stuff from /etc/config to the right places on each<br />platform. BTW, the search feature on this board ignores &#039;/&#039;<br />characters, so I couldn&#039;t find the precise posts which mention<br />/etc/config.</p><div class="quotebox"><cite>wbx wrote:</cite><blockquote><p>Feel free to submit patches and try<br />Kamikaze. <a href="http://dev.openwrt.org">http://dev.openwrt.org</a></p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p17000">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">mbm</div>
					<div class="post-datetime">
						11 Dec 2005, 08:30					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ll be the first to admit that there are flaws in the development model but please refrain from flaming the developers based on your initial reaction. I appoligize if it wasn&#039;t actually ment as a flame but it certainly came across that way.</p><p>Using nvram:<br />- nvram is required by the bootloader and various proprietary drivers and utils<br />- nvram is a fixed size and location, you cannot reclaim the space<br />- nvram is preserved across all upgrades</p><p>Creating a config file on the filesystem:<br />- duplicates many values alreay in nvram<br />- may require an additional parser<br />- may be difficult for a script or web interface to modify the configuration<br />- is not preserved across upgrades; the filesystem gets wiped out when you reflash with a newer release</p><p>EDIT -</p><p>OpenWrt&#039;s policy is to only use nvram when the configuration calls for a simple &lt;key&gt;=&lt;value&gt; already in nvram; it will not try to create anything more complicated in nvram. As an example, SSH keys and firewall rules are kept on the filesystem.</p><p>The /etc/resolv.conf is a link to /tmp (ramdisk) to avoid writing to flash each time the router renews it&#039;s dhcp/ppp connection or a lan_dns variable which can be used when lan_proto=static. It&#039;s simply us trying to avoid wearing out the flash with continuous writes; you can just delete the /etc/resolv.conf symlink and create your own.</p>											<p class="post-edited">(Last edited by <strong>mbm</strong> on 11 Dec 2005, 08:51)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p17004">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">bani</div>
					<div class="post-datetime">
						11 Dec 2005, 11:30					</div>
				</div>
				<div class="post-content content">
					<p>how does openwrt handle platforms without nvram?</p>											<p class="post-edited">(Last edited by <strong>bani</strong> on 11 Dec 2005, 11:38)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p17005">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">dl</div>
					<div class="post-datetime">
						11 Dec 2005, 11:31					</div>
				</div>
				<div class="post-content content">
					<p>I had similar thoughts about <a href="http://forum.openwrt.org/viewtopic.php?id=2699">an nvram free configuration</a> after my previous nightmares with other (DD-WRT, Sveasoft) releases due largely to nvram confusion. But after using OpenWRT for a few weeks I came to not only appreciate OW&#039;s minimal dependence on nvram, but also the utility of nvram for some purposes.</p><p>I routinely clear nvram after installing OW (not recommended on some models!) to rid all the linksys garbage, but then set only a few vars for minimal config instead installing an init script to basically customize the configuration. Virtually anything that can be specified in nvram can be overridden in a startup script, but even so I&#039;ve even added a few nvram vars myself (that my startup scripts reference) because these are easier to reference via a web page or step a customer thru changing via telnet. For obscure reasons my clients are not currently remotely accessible (tunneling, vlan, etc) so if I need to step a customer thru changing xmit antenna the last thing I want to do is to step them through vi to edit the startup script <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />.</p><p>The lack of a documented &quot;path&quot;, true, but being a one man developer of a major software package myself (content management system) I fully appreciate that documenting, providing roadpaths&#039;s etc is a massive amount of work, equal to or greater than the sw development itself, and with limited resources I&#039;d prefer that development take precedence. From what I&#039;ve seen so far I have trust in the sanity of the roadpath for openwrt.</p><p>- DL</p>											<p class="post-edited">(Last edited by <strong>dl</strong> on 11 Dec 2005, 11:34)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p17006">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">mbm</div>
					<div class="post-datetime">
						11 Dec 2005, 11:34					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>bani wrote:</cite><blockquote><p>how does openwrt handle platforms without nvram?</p></blockquote></div><p>A set of fles in /etc/config/ which use the same key pairs as nvram. The files are named after the set of variables they contain, in other words there&#039;s a /etc/config/network which contains the various lan_* and wan_* variables used by networking components like the ifup script.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p17007">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">bani</div>
					<div class="post-datetime">
						11 Dec 2005, 11:38					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>wbx wrote:</cite><blockquote><p>1. Your router would not boot without nvram. You can&#039;t just remove it and use it for something else.<br />CFE, the bootloader on most of the systems we support in whiterussian, checks nvram for some stuff. (boot_wait as example).</p></blockquote></div><p>i dont think he was suggesting platform-specific nvram settings be removed. but i don&#039;t think _openwrt_ should rely on platform-specific nvram settings. boot_wait should matter only to CFE, not openwrt (as an example).</p><div class="quotebox"><cite>wbx wrote:</cite><blockquote><p>2. Users which like to try OpenWrt are happy that their old configuration is used to setup the new system. (just network configuration)</p></blockquote></div><p>i&#039;m not sure this is a good argument for using nvram for all settings. i&#039;m not sure backwards compatibility with linksys (dd-wrt, etc) firmware is all that good of an idea, as it&#039;s rather limiting. and on some platforms (routerboard, soekris, gumstix, etc) it doesn&#039;t apply at all.</p><div class="quotebox"><cite>wbx wrote:</cite><blockquote><p>3. With 2.4 kernel and the binary only wl.o driver for the wireless chip, we need nvram to configure some of the wireless settings. et.o, the driver for the switch use nvramto setup vlan.</p></blockquote></div><p>i think this is a good reason for openwrt to adopt opensource driver when they become usable <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>											<p class="post-edited">(Last edited by <strong>bani</strong> on 11 Dec 2005, 11:42)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p17010">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">bani</div>
					<div class="post-datetime">
						11 Dec 2005, 11:46					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Purist wrote:</cite><blockquote><div class="quotebox"><cite>bani wrote:</cite><blockquote><p>the problem is that some of the non-free binary-only tools (eg nas) read the nvram for parameters. <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>i agree the nvram is rather limiting and arcane compared to normal scripts and config files though. redhat&#039;s /etc/sysconfig/network-scripts is pretty good for configuring and controlling interfaces.</p></blockquote></div><p>Keeping the interface network config in nvram is not the issue. After all, the<br />Redhat ifcfg scripts are nothing more than param=value pairs. The location is<br />not that relevant except to network init tool/scripts. If it has to be the<br />nvram for compatibility reasons, that&#039;s not really a problem. I didn&#039;t change<br />the location of those settings in my setup, simply because I didn&#039;t care where<br />they were.</p></blockquote></div><p>well imagine a setup with 30, 50, 100 ethernets/subnets/vlans. at some point nvram will be insufficient to store the basic system config, even if the hardware is easily capable of it</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p17011">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">mbm</div>
					<div class="post-datetime">
						11 Dec 2005, 11:49					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>bani wrote:</cite><blockquote><p>i think this is a good reason for openwrt to adopt opensource driver when they become usable <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></blockquote></div><p>Which will happen <strong>when they become usable</strong> ...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p17012">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">dl</div>
					<div class="post-datetime">
						11 Dec 2005, 11:54					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>bani wrote:</cite><blockquote><p>well imagine a setup with 30, 50, 100 ethernets/subnets/vlans. at some point nvram will be insufficient to store the basic system config, even if the hardware is easily capable of it</p></blockquote></div><p>So what&#039;s the problem? You just break the bridge in nvram (so you don&#039;t have to tear it down in a script) and setup everything with a script.</p><p>- DL</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p17014">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">bani</div>
					<div class="post-datetime">
						11 Dec 2005, 12:27					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dl wrote:</cite><blockquote><div class="quotebox"><cite>bani wrote:</cite><blockquote><p>well imagine a setup with 30, 50, 100 ethernets/subnets/vlans. at some point nvram will be insufficient to store the basic system config, even if the hardware is easily capable of it</p></blockquote></div><p>So what&#039;s the problem? You just break the bridge in nvram (so you don&#039;t have to tear it down in a script) and setup everything with a script.</p><p>- DL</p></blockquote></div><p>...which defeats the purpose of storing such things in nvram.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p17017">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">Vincent Bernat</div>
					<div class="post-datetime">
						11 Dec 2005, 12:40					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>bani wrote:</cite><blockquote><div class="quotebox"><cite>dl wrote:</cite><blockquote><div class="quotebox"><cite>bani wrote:</cite><blockquote><p>well imagine a setup with 30, 50, 100 ethernets/subnets/vlans. at some point nvram will be insufficient to store the basic system config, even if the hardware is easily capable of it</p></blockquote></div><p>So what&#039;s the problem? You just break the bridge in nvram (so you don&#039;t have to tear it down in a script) and setup everything with a script.</p><p>- DL</p></blockquote></div><p>...which defeats the purpose of storing such things in nvram.</p></blockquote></div><p>...only for this particular case. This is not a common case, isn&#039;t it ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p17024">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">bani</div>
					<div class="post-datetime">
						11 Dec 2005, 14:24					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Vincent Bernat wrote:</cite><blockquote><div class="quotebox"><cite>bani wrote:</cite><blockquote><p>...which defeats the purpose of storing such things in nvram.</p></blockquote></div><p>...only for this particular case. This is not a common case, isn&#039;t it ?</p></blockquote></div><p>well, i switched from official linksys firmware to dd-wrt to openwrt, and was astonished to find the nvram was about 90% full.</p><p>so i think &#039;keeping compatibility across firmware versions&#039; is not a good reason to keep settings in nvram. only things in nvram should be what&#039;s required by the bootloader (CFE) to basically boot the system (like pc bios cmos settings) and nothing more.</p>											<p class="post-edited">(Last edited by <strong>bani</strong> on 11 Dec 2005, 14:27)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p17025">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">mbm</div>
					<div class="post-datetime">
						11 Dec 2005, 14:28					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>bani wrote:</cite><blockquote><p>well, i switched from official linksys firmware to dd-wrt to openwrt, and was astonished to find the nvram was about 90% full.</p></blockquote></div><p>You trashed out your nvram by installing various firmwares that abused it; why are you complaining about OpenWrt&#039;s use of nvram? OpenWrt doesn&#039;t create any nvram variables and only really uses a handful of the variables in nvram, the rest is just trash from the other firmwares.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p17029">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">bani</div>
					<div class="post-datetime">
						11 Dec 2005, 15:28					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>mbm wrote:</cite><blockquote><div class="quotebox"><cite>bani wrote:</cite><blockquote><p>well, i switched from official linksys firmware to dd-wrt to openwrt, and was astonished to find the nvram was about 90% full.</p></blockquote></div><p>You trashed out your nvram by installing various firmwares that abused it; why are you complaining about OpenWrt&#039;s use of nvram? OpenWrt doesn&#039;t create any nvram variables and only really uses a handful of the variables in nvram, the rest is just trash from the other firmwares.</p></blockquote></div><p>i&#039;m saying the claim for using nvram as some sort of compatibility system across different firmwares is a bad justification &quot;they can just upgrade from (svea|linksys|ddwrt|etc) and it will work&quot;, especially since some firmwares use different variables names and are in fact not compatible.</p><p>but if you erase nvram and reboot openwrt, you can see it does in fact create nvram variables. what you probably meant to say (but worded badly) is that openwrt doesn&#039;t create any new custom nvram variables.</p><p>but even openwrt has changed variable names a few times (eg obsoleted variables / changed names) so openwrt itself may be leaving trash too <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>i think it&#039;s a good idea to keep nvram clean as possible. just because linksys or other firmware uses block_java=1 i don&#039;t think this is a good justification for openwrt to do the same thing <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p17030">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">nbd</div>
					<div class="post-datetime">
						11 Dec 2005, 15:31					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>bani wrote:</cite><blockquote><p>but even openwrt has changed variable names a few times (eg obsoleted variables / changed names) so openwrt itself may be leaving trash too <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></blockquote></div><p>Wrong, because OpenWrt doesn&#039;t create any nvram variables by itself<br />EDIT: at least it doesn&#039;t commit any variables automatically. The small amount of default variables that are created are also used by the original firmware.</p>											<p class="post-edited">(Last edited by <strong>nbd</strong> on 11 Dec 2005, 15:38)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p17031">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">mbm</div>
					<div class="post-datetime">
						11 Dec 2005, 15:49					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>bani wrote:</cite><blockquote><p>but if you erase nvram and reboot openwrt, you can see it does in fact create nvram variables. what you probably meant to say (but worded badly) is that openwrt doesn&#039;t create any new custom nvram variables.</p></blockquote></div><p>Actually nvram gets initialized with a default set of variables from the bootloader; we&#039;re not responsible for what values CFE writes to the nvram and recommend against erasing nvram because some devices have some nasty defaults. OpenWrt will attempt to fix a few hardware bugs by changing the values with the S05nvram script, but to say OpenWrt creates any variables is wrong.<br /></p><div class="quotebox"><cite>bani wrote:</cite><blockquote><p>but even openwrt has changed variable names a few times (eg obsoleted variables / changed names) so openwrt itself may be leaving trash too <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></blockquote></div><p>There might have been a few variables which changed due to wireless driver upgrades, but the reset of the system (which is to say the ifup script and maybe one or two of the init.d scripts) still uses the same set of variables they always did.<br /></p><div class="quotebox"><cite>bani wrote:</cite><blockquote><p>i think it&#039;s a good idea to keep nvram clean as possible. just because linksys or other firmware uses block_java=1 i don&#039;t think this is a good justification for openwrt to do the same thing <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></blockquote></div><p>I&#039;m sorry but you&#039;re really restating the obvious here -- Did you really mean to imply that OpenWrt is hell bent on destroying nvram by creating all sorts of trivial, meaningless, random and obscufiated variables ... ?</p><p>Nobody ever said that we were going to maintain full backwards compatibility with every other firmware in existance, only that we happen to have some backwards compatibility because we use some of the same variables.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p17035">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">bani</div>
					<div class="post-datetime">
						11 Dec 2005, 16:22					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nbd wrote:</cite><blockquote><p>EDIT: at least it doesn&#039;t commit any variables automatically.</p></blockquote></div><p>whats the <em>nvram commit</em> doing in S05nvram then <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>											<p class="post-edited">(Last edited by <strong>bani</strong> on 11 Dec 2005, 16:22)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p17036">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">mbm</div>
					<div class="post-datetime">
						11 Dec 2005, 16:25					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>bani wrote:</cite><blockquote><div class="quotebox"><cite>nbd wrote:</cite><blockquote><p>EDIT: at least it doesn&#039;t commit any variables automatically.</p></blockquote></div><p>whats the <em>nvram commit</em> doing in S05nvram then <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></blockquote></div><p>It&#039;s there because we&#039;re forced to. Some routers have a nasty tendancy to crash and won&#039;t work properly until you commit a few changes and reboot.</p><p>Seriously, I&#039;m getting sick of this thread and the conspiracy theories ...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p17081">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">wbx</div>
					<div class="post-datetime">
						12 Dec 2005, 02:19					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Purist wrote:</cite><blockquote><p>We&#039;re in different circles (and probably different countries) with<br />different philosophies. Most IT people I know will not spend a day<br />configuring something, they&#039;ll just buy/use another box/software which<br />can do what they want without having to bend over backwards. I consider<br />spending a day on this a reasonable time investment on my part.</p></blockquote></div><p>Then please buy another box. </p><div class="quotebox"><cite>Purist wrote:</cite><blockquote><p>I&#039;m sorry to have to say this, but the OpenWRT teams in not doing a<br />good job at letting people outside where White Russian is headed, and<br />even less so for Kamikaze. I couldn&#039;t find any mention of it in any<br />sticky posts or site news. There&#039;s no TODO file or even a changelog in<br />the source tree. If one has to build a mental picture from the svn<br />commit messages, then it&#039;s really more than most would be developers<br />would normally do. I&#039;m not the only one to think this:<br /><a href="http://forum.openwrt.org/viewtopic.php?id=3482">http://forum.openwrt.org/viewtopic.php?id=3482</a>. So, don&#039;t blame me for<br />not guessing what you&#039;re planning for the future.</p></blockquote></div><p>Use IRC and try to get in contact with us. I personally have no fun in writing down what we want todo.<br />I&#039;ll better spent the time to actually do something. Shut up and hack is my philosophy.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p17135">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">danversj</div>
					<div class="post-datetime">
						13 Dec 2005, 07:24					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>wbx wrote:</cite><blockquote><div class="quotebox"><cite>Purist wrote:</cite><blockquote><p>We&#039;re in different circles (and probably different countries) with<br />different philosophies. Most IT people I know will not spend a day<br />configuring something, they&#039;ll just buy/use another box/software which<br />can do what they want without having to bend over backwards. I consider<br />spending a day on this a reasonable time investment on my part.</p></blockquote></div><p>Then please buy another box.</p></blockquote></div><p>Purist: This response from the developers may seem harsh but it is fair.&nbsp; They work tirelessly on OpenWRT and provide it to you &quot;as is&quot;, free of charge.&nbsp; For OpenWRT to be as useful as it is and be free is the wonder of Open Source Software, and the people who write it.&nbsp; On the other hand, with OSS you generally don&#039;t get 24/7 customer service and thorough documentation unless you pay for it.&nbsp; That said, OpenWRTs documentation has improved in leaps and bounds over the past 6 months and is continues to do so - there are useful additions to the documentation wiki every day.</p><p>If you want to play with bleeding edge software, be prepared to do a bit of work yourself.&nbsp; If you want a product that works, right here, right now, then expect to pay for it, and don&#039;t expect it to have bleeding edge features.&nbsp; If you think that OpenWRT should be better documented, then contribute some yourself for the benefit of everyone.&nbsp; If you want to know where OpenWRT is headed - ask the developers!&nbsp; I can imagine that the future of OpenWRT is not set in stone - it&#039;s difficult to outline a &quot;roadmap&quot; for OpenWRT when there isn&#039;t even a road to travel on.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>