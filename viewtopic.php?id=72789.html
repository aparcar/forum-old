<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> A nice guy needs help... WR941 V3.6 - switch LAN plus WAN</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 15 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p369617">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">x0101222</div>
					<div class="post-datetime">
						15 Dec 2017, 01:16					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I am so sorry to bring this topic from dd wrt area but I need the help from someone that can interact in the telnet &quot;program&quot; node.</p><p>I have been using the <strong>WR841 </strong>with very nice results in DD WRT, and I am also a old user of this Linux-based firmware.</p><br /><p>I am now with an issue where I need to extend the wi-fi range in my house and I chose some (2) <strong>WR941 </strong>V3.6 because of it&#039;s 3 antennas and cheap price on the re-sale market.(15€)</p><p>However I faced the problem that I cannot have switch habitability between the Lan port&#039;s, <em>plus WAN port assigned to Lan</em> , and the main 4G router:</p><p>4G router .........................WR941 <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Lan clients (5) - not working to WWW environment<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WI-FI - OK all super ok.</p><br /><p>The <strong>WR841 </strong>is working fine, <em>only when I placed the WR941</em> I cannot have any more the LAN side able to go to the internet. they only work &quot;locally&quot;, even with the 941 almost as default, only making WAN Disable, Assignet to Lan, default WIFI (works always fine), router as -&gt;router&nbsp; and nothing more changed.</p><p>After some tests and re-tests I just cannot find the correct command scrip to make the &quot;patch&quot; of the <strong>lan plus wan</strong> able to solve this problem:</p><p>swconfig dev &lt;port&gt; set enable_vlan 1<br />swconfig dev &lt;port&gt; set apply</p><br /><p>Router Name DD-WRT <br />Router Model TP-Link TL-WR941ND v2/v3 </p><p>LAN MAC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;74:EA:3A:A2:8B:AD <br />WAN MAC&nbsp; &nbsp; &nbsp; &nbsp; 74:EA:3A:A2:8B:AD <br />Wireless MAC&nbsp; 74:EA:3A:A2:8B:AE <br />WAN IPv4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Disabled <br />LAN IP&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 192.168.1.1 </p><br /><br /><p>root@DD-WRT:~# ifconfig -a</p><p>ath0&nbsp; &nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 74:EA:3A:A2:8B:AE<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:2830 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:2731 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:309427 (302.1 KiB)&nbsp; TX bytes:1504206 (1.4 MiB)</p><p>br0&nbsp; &nbsp; &nbsp; &nbsp;Link encap:Ethernet&nbsp; HWaddr 74:EA:3A:A2:8B:AD<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:192.168.1.1&nbsp; Bcast:192.168.1.255&nbsp; Mask:255.255.255.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:5029 errors:0 dropped:160 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:5850 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:409464 (399.8 KiB)&nbsp; TX bytes:5089373 (4.8 MiB)</p><p>br0:0&nbsp; &nbsp; &nbsp;Link encap:Ethernet&nbsp; HWaddr 74:EA:3A:A2:8B:AD<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:169.254.255.1&nbsp; Bcast:169.254.255.255&nbsp; Mask:255.255.0.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1</p><p>eth0&nbsp; &nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 74:EA:3A:A2:8B:AE<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:815 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:0 (0.0 B)&nbsp; TX bytes:75853 (74.0 KiB)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Interrupt:255</p><p>lo&nbsp; &nbsp; &nbsp; &nbsp; Link encap:Local Loopback<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:127.0.0.1&nbsp; Mask:255.0.0.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP LOOPBACK RUNNING MULTICAST&nbsp; MTU:65536&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:175 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:175 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:10420 (10.1 KiB)&nbsp; TX bytes:10420 (10.1 KiB)</p><p>vlan0&nbsp; &nbsp; &nbsp;Link encap:Ethernet&nbsp; HWaddr 74:EA:3A:A2:8B:AD<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:500 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:0 (0.0 B)&nbsp; TX bytes:37672 (36.7 KiB)</p><p>vlan1&nbsp; &nbsp; &nbsp;Link encap:Ethernet&nbsp; HWaddr 74:EA:3A:A2:8B:AF<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:315 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:0 (0.0 B)&nbsp; TX bytes:31621 (30.8 KiB)</p><br /><p>all the tries that I made return with the following message:</p><p><strong>Port setup by default:<br />WAN Port Assignment vlan1</strong></p><p>root@DD-WRT:~# swconfig dev vlan1 set enable_vlan 1<br />Failed to connect to the switch. Use the &quot;list&quot; command to see which switches are available.</p><br /><p>swconfig list does not provide any reply in the terminal:</p><p>root@DD-WRT:~# swconfig list<br />root@DD-WRT:~#</p><br /><p>Would someone be so kind to help me and make a script patch or command start-up list that can solve this issue?</p><br /><p>I am really sorry but I made all the testes and tries that a noob can do with the knowledge that I have...</p><br /><p>will this part be relevant for this issue?</p><br /><p>wiki.openwrt.org/toh/tp-link/tl-wr941nd<br />.................................<br />Specific configuration<br />VLAN Config</p><p>This device does not have a programmable switch and require special configuration (only v3.x hardware). Each port is presented with a different interface (lan1, lan2, lan3, lan4, wan).<br />VLAN in Chaos Calmer+</p><p>First, set the main port (eth0) with an MTU of at least 1504 in /etc/config/network :<br />config interface &#039;eth&#039;<br />&nbsp; &nbsp; option ifname &#039;eth0&#039;<br />&nbsp; &nbsp; option mtu &#039;1504&#039;<br />&nbsp; &nbsp; option proto &#039;none&#039;</p><p>Then just create different interfaces for each port. <br />..............................................................................</p><br /><p>Otherwise... well.. 30€ on the top of the desk <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>thank you for reading until here this message!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p369747">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">x0101222</div>
					<div class="post-datetime">
						18 Dec 2017, 15:29					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I really would like to have some inouts about my issue... if it is a dead end or if I may have an alternative, even with other firmware...</p><p>Thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p369752">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">WWTK</div>
					<div class="post-datetime">
						18 Dec 2017, 17:11					</div>
				</div>
				<div class="post-content content">
					<p>openwrt and dd-wrt are completely different under the hood setup wise.&nbsp; While its true most people here have used dd-wrt (myself included) there is a reason we chose openwrt.&nbsp; Not that one is better, but its just a matter of taste i ran just great on dd-wrt, but openwrt has a more linux like environment that i prefer.</p><p>as far as your issue goes, it does seem to either be an issue with either your vlans, or maybe firewall.&nbsp; Make sure your firewall is allowing forwarding, or better yet, disable it completely until you have the connectivity you want, then decide if you need to restrict things at all.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p369757">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">eduperez</div>
					<div class="post-datetime">
						18 Dec 2017, 19:03					</div>
				</div>
				<div class="post-content content">
					<p>I tried, but I could not understand what are you trying to do and how is it failing... I could not figure out how many devices are involved, how is each one configured, and how are they connected to each other.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p369766">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">mk24</div>
					<div class="post-datetime">
						19 Dec 2017, 01:45					</div>
				</div>
				<div class="post-content content">
					<p>You&#039;re making this too complicated.&nbsp; Just move the &quot;wan&quot; hardware interface out of the WAN network and into the existing LAN bridge.&nbsp; In other words the lan section of /etc/config/network should have an option ifname &#039;lan1 lan2 lan3 lan4 wan&#039;.&nbsp; The wan section has no interfaces attached, since you are not routing to a wan, just bridging around LAN devices.</p><p>This should also be possible from the Network--Interface edit-- Physical Settings pages of LuCI.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p369790">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">x0101222</div>
					<div class="post-datetime">
						19 Dec 2017, 16:33					</div>
				</div>
				<div class="post-content content">
					<p>Hi.</p><p>Thanks for all for the inputs.</p><p>i will try to OpenWRT and see how I can handle it.</p><p>BR</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>