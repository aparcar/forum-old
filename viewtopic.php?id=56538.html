<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> TP Link WDR 4300  No  Wireless</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 7 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p270419">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">mxpdsa</div>
					<div class="post-datetime">
						29 Mar 2015, 22:29					</div>
				</div>
				<div class="post-content content">
					<p>Hello everyone.</p><p>Firstly to apologize to my bad English.</p><p>I need help.</p><p>After the firmware update router tp link WDR 4300 router is bricked.<br />I did a recovery <a href="https://www.youtube.com/watch?v=t35Pei_eb6o">https://www.youtube.com/watch?v=t35Pei_eb6o</a></p><p>Now I have a problem. </p><p>Wireless does not exist anymore? - I did upgrade the various firmware and dovngrade and did not help.<br />I also returned to the factory stock firmware even that did not help.<br />Wireless Switch is On.<br />Is there any solution to my problem.</p><p>root@OpenWrt:/# dmesg<br />[&nbsp; &nbsp; 0.000000] Linux version 3.10.49 (bb@builder1) (gcc version 4.8.3 (OpenWrt/Linaro GCC 4.8-2014.04 r42625) ) #3 Wed Oct 1 14:00:51 CEST 2014<br />[&nbsp; &nbsp; 0.000000] MyLoader: sysp=d41aa8a5, boardp=3bb52003, parts=bd952718<br />[&nbsp; &nbsp; 0.000000] bootconsole [early0] enabled<br />[&nbsp; &nbsp; 0.000000] CPU revision is: 0001974c (MIPS 74Kc)<br />[&nbsp; &nbsp; 0.000000] SoC: Atheros AR9344 rev 2<br />[&nbsp; &nbsp; 0.000000] Clocks: CPU:560.000MHz, DDR:450.000MHz, AHB:225.000MHz, Ref:40.000MHz<br />[&nbsp; &nbsp; 0.000000] Determined physical RAM map:<br />[&nbsp; &nbsp; 0.000000]&nbsp; memory: 08000000 @ 00000000 (usable)<br />[&nbsp; &nbsp; 0.000000] Initrd not found or empty - disabling initrd<br />[&nbsp; &nbsp; 0.000000] Zone ranges:<br />[&nbsp; &nbsp; 0.000000]&nbsp; &nbsp;Normal&nbsp; &nbsp;[mem 0x00000000-0x07ffffff]<br />[&nbsp; &nbsp; 0.000000] Movable zone start for each node<br />[&nbsp; &nbsp; 0.000000] Early memory node ranges<br />[&nbsp; &nbsp; 0.000000]&nbsp; &nbsp;node&nbsp; &nbsp;0: [mem 0x00000000-0x07ffffff]<br />[&nbsp; &nbsp; 0.000000] On node 0 totalpages: 32768<br />[&nbsp; &nbsp; 0.000000] free_area_init_node: node 0, pgdat 80334b60, node_mem_map 81000000<br />[&nbsp; &nbsp; 0.000000]&nbsp; &nbsp;Normal zone: 256 pages used for memmap<br />[&nbsp; &nbsp; 0.000000]&nbsp; &nbsp;Normal zone: 0 pages reserved<br />[&nbsp; &nbsp; 0.000000]&nbsp; &nbsp;Normal zone: 32768 pages, LIFO batch:7<br />[&nbsp; &nbsp; 0.000000] Primary instruction cache 64kB, VIPT, 4-way, linesize 32 bytes.<br />[&nbsp; &nbsp; 0.000000] Primary data cache 32kB, 4-way, VIPT, cache aliases, linesize 32 bytes<br />[&nbsp; &nbsp; 0.000000] pcpu-alloc: s0 r0 d32768 u32768 alloc=1*32768<br />[&nbsp; &nbsp; 0.000000] pcpu-alloc: [0] 0<br />[&nbsp; &nbsp; 0.000000] Built 1 zonelists in Zone order, mobility grouping on.&nbsp; Total pages: 32512<br />[&nbsp; &nbsp; 0.000000] Kernel command line:&nbsp; board=TL-WDR4300 console=ttyS0,115200 rootfstype=squashfs,jffs2 noinitrd<br />[&nbsp; &nbsp; 0.000000] PID hash table entries: 512 (order: -1, 2048 bytes)<br />[&nbsp; &nbsp; 0.000000] Dentry cache hash table entries: 16384 (order: 4, 65536 bytes)<br />[&nbsp; &nbsp; 0.000000] Inode-cache hash table entries: 8192 (order: 3, 32768 bytes)<br />[&nbsp; &nbsp; 0.000000] Writing ErrCtl register=00000000<br />[&nbsp; &nbsp; 0.000000] Readback ErrCtl register=00000000<br />[&nbsp; &nbsp; 0.000000] Memory: 126052k/131072k available (2369k kernel code, 5020k reserved, 621k data, 272k init, 0k highmem)<br />[&nbsp; &nbsp; 0.000000] SLUB: HWalign=32, Order=0-3, MinObjects=0, CPUs=1, Nodes=1<br />[&nbsp; &nbsp; 0.000000] NR_IRQS:51<br />[&nbsp; &nbsp; 0.060000] Calibrating delay loop... 278.93 BogoMIPS (lpj=1394688)<br />[&nbsp; &nbsp; 0.070000] pid_max: default: 32768 minimum: 301<br />[&nbsp; &nbsp; 0.070000] Mount-cache hash table entries: 512<br />[&nbsp; &nbsp; 0.080000] NET: Registered protocol family 16<br />[&nbsp; &nbsp; 0.080000] MIPS: machine is TP-LINK TL-WDR3600/4300/4310<br />[&nbsp; &nbsp; 0.090000] registering PCI controller with io_map_base unset<br />[&nbsp; &nbsp; 0.310000] bio: create slab &lt;bio-0&gt; at 0<br />[&nbsp; &nbsp; 0.310000] PCI host bridge to bus 0000:00<br />[&nbsp; &nbsp; 0.320000] pci_bus 0000:00: root bus resource [mem 0x10000000-0x13ffffff]<br />[&nbsp; &nbsp; 0.320000] pci_bus 0000:00: root bus resource [io&nbsp; 0x0000]<br />[&nbsp; &nbsp; 0.330000] pci_bus 0000:00: No busn resource found for root bus, will use [bus 00-ff]<br />[&nbsp; &nbsp; 0.330000] pci 0000:00:00.0: [168c:0033] type 00 class 0x028000<br />[&nbsp; &nbsp; 0.330000] pci 0000:00:00.0: invalid calibration data<br />[&nbsp; &nbsp; 0.340000] pci 0000:00:00.0: reg 10: [mem 0x00000000-0x0001ffff 64bit]<br />[&nbsp; &nbsp; 0.340000] pci 0000:00:00.0: reg 30: [mem 0x00000000-0x0000ffff pref]<br />[&nbsp; &nbsp; 0.340000] pci 0000:00:00.0: supports D1<br />[&nbsp; &nbsp; 0.340000] pci 0000:00:00.0: PME# supported from D0 D1 D3hot<br />[&nbsp; &nbsp; 0.340000] pci_bus 0000:00: busn_res: [bus 00-ff] end is updated to 00<br />[&nbsp; &nbsp; 0.340000] pci 0000:00:00.0: BAR 0: assigned [mem 0x10000000-0x1001ffff 64bit]<br />[&nbsp; &nbsp; 0.340000] pci 0000:00:00.0: BAR 6: assigned [mem 0x10020000-0x1002ffff pref]<br />[&nbsp; &nbsp; 0.350000] pci 0000:00:00.0: using irq 40 for pin 1<br />[&nbsp; &nbsp; 0.350000] Switching to clocksource MIPS<br />[&nbsp; &nbsp; 0.360000] NET: Registered protocol family 2<br />[&nbsp; &nbsp; 0.360000] TCP established hash table entries: 1024 (order: 1, 8192 bytes)<br />[&nbsp; &nbsp; 0.360000] TCP bind hash table entries: 1024 (order: 0, 4096 bytes)<br />[&nbsp; &nbsp; 0.370000] TCP: Hash tables configured (established 1024 bind 1024)<br />[&nbsp; &nbsp; 0.370000] TCP: reno registered<br />[&nbsp; &nbsp; 0.370000] UDP hash table entries: 256 (order: 0, 4096 bytes)<br />[&nbsp; &nbsp; 0.380000] UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)<br />[&nbsp; &nbsp; 0.390000] NET: Registered protocol family 1<br />[&nbsp; &nbsp; 0.390000] PCI: CLS 0 bytes, default 32<br />[&nbsp; &nbsp; 0.410000] squashfs: version 4.0 (2009/01/31) Phillip Lougher<br />[&nbsp; &nbsp; 0.410000] jffs2: version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006 Red Hat, Inc.<br />[&nbsp; &nbsp; 0.420000] msgmni has been set to 246<br />[&nbsp; &nbsp; 0.430000] io scheduler noop registered<br />[&nbsp; &nbsp; 0.430000] io scheduler deadline registered (default)<br />[&nbsp; &nbsp; 0.440000] Serial: 8250/16550 driver, 16 ports, IRQ sharing enabled<br />[&nbsp; &nbsp; 0.470000] serial8250.0: ttyS0 at MMIO 0x18020000 (irq = 11) is a 16550A<br />[&nbsp; &nbsp; 0.470000] console [ttyS0] enabled, bootconsole disabled<br />[&nbsp; &nbsp; 0.490000] ath79-spi ath79-spi: master is unqueued, this is deprecated<br />[&nbsp; &nbsp; 0.500000] m25p80 spi0.0: found s25fl064k, expected m25p80<br />[&nbsp; &nbsp; 0.500000] m25p80 spi0.0: s25fl064k (8192 Kbytes)<br />[&nbsp; &nbsp; 0.510000] 5 tp-link partitions found on MTD device spi0.0<br />[&nbsp; &nbsp; 0.510000] Creating 5 MTD partitions on &quot;spi0.0&quot;:<br />[&nbsp; &nbsp; 0.520000] 0x000000000000-0x000000020000 : &quot;u-boot&quot;<br />[&nbsp; &nbsp; 0.520000] 0x000000020000-0x00000012e5fc : &quot;kernel&quot;<br />[&nbsp; &nbsp; 0.530000] mtd: partition &quot;kernel&quot; must either start or end on erase block boundary or be smaller than an erase block -- forcing read-only<br />[&nbsp; &nbsp; 0.540000] 0x00000012e5fc-0x0000007f0000 : &quot;rootfs&quot;<br />[&nbsp; &nbsp; 0.550000] mtd: partition &quot;rootfs&quot; must either start or end on erase block boundary or be smaller than an erase block -- forcing read-only<br />[&nbsp; &nbsp; 0.560000] mtd: device 2 (rootfs) set to be root filesystem<br />[&nbsp; &nbsp; 0.570000] 1 squashfs-split partitions found on MTD device rootfs<br />[&nbsp; &nbsp; 0.570000] 0x000000350000-0x0000007f0000 : &quot;rootfs_data&quot;<br />[&nbsp; &nbsp; 0.580000] 0x0000007f0000-0x000000800000 : &quot;art&quot;<br />[&nbsp; &nbsp; 0.590000] 0x000000020000-0x0000007f0000 : &quot;firmware&quot;<br />[&nbsp; &nbsp; 0.620000] switch0: Atheros AR8327 rev. 2 switch registered on ag71xx-mdio.0<br />[&nbsp; &nbsp; 1.850000] libphy: ag71xx_mdio: probed<br />[&nbsp; &nbsp; 2.400000] ag71xx ag71xx.0: connected to PHY at ag71xx-mdio.0:00 [uid=004dd033, driver=Atheros AR8216/AR8236/AR8316]<br />[&nbsp; &nbsp; 2.410000] eth0: Atheros AG71xx at 0xb9000000, irq 4, mode:RGMII<br />[&nbsp; &nbsp; 2.420000] TCP: cubic registered<br />[&nbsp; &nbsp; 2.420000] NET: Registered protocol family 17<br />[&nbsp; &nbsp; 2.430000] Bridge firewalling registered<br />[&nbsp; &nbsp; 2.430000] 8021q: 802.1Q VLAN Support v1.8<br />[&nbsp; &nbsp; 2.450000] VFS: Mounted root (squashfs filesystem) readonly on device 31:2.<br />[&nbsp; &nbsp; 2.450000] Freeing unused kernel memory: 272K (8034c000 - 80390000)<br />[&nbsp; &nbsp; 4.630000] usbcore: registered new interface driver usbfs<br />[&nbsp; &nbsp; 4.630000] usbcore: registered new interface driver hub<br />[&nbsp; &nbsp; 4.640000] usbcore: registered new device driver usb<br />[&nbsp; &nbsp; 4.650000] ehci_hcd: USB 2.0 &#039;Enhanced&#039; Host Controller (EHCI) Driver<br />[&nbsp; &nbsp; 4.660000] ehci-platform: EHCI generic platform driver<br />[&nbsp; &nbsp; 4.660000] ehci-platform ehci-platform: EHCI Host Controller<br />[&nbsp; &nbsp; 4.670000] ehci-platform ehci-platform: new USB bus registered, assigned bus number 1<br />[&nbsp; &nbsp; 4.680000] ehci-platform ehci-platform: irq 3, io mem 0x1b000000<br />[&nbsp; &nbsp; 4.710000] ehci-platform ehci-platform: USB 2.0 started, EHCI 1.00<br />[&nbsp; &nbsp; 4.710000] hub 1-0:1.0: USB hub found<br />[&nbsp; &nbsp; 4.720000] hub 1-0:1.0: 1 port detected<br />[&nbsp; &nbsp; 5.040000] usb 1-1: new high-speed USB device number 2 using ehci-platform<br />[&nbsp; &nbsp; 5.190000] hub 1-1:1.0: USB hub found<br />[&nbsp; &nbsp; 5.190000] hub 1-1:1.0: 4 ports detected<br />[&nbsp; &nbsp; 6.430000] eth0: link up (1000Mbps/Full duplex)<br />[&nbsp; &nbsp; 8.340000] eth0: link down<br />[&nbsp; &nbsp; 9.730000] NET: Registered protocol family 10<br />[&nbsp; &nbsp; 9.750000] nf_conntrack version 0.5.0 (1973 buckets, 7892 max)<br />[&nbsp; &nbsp; 9.760000] ip6_tables: (C) 2000-2006 Netfilter Core Team<br />[&nbsp; &nbsp; 9.770000] Loading modules backported from Linux version master-2014-05-22-0-gf2032ea<br />[&nbsp; &nbsp; 9.780000] Backport generated by backports.git backports-20140320-37-g5c33da0<br />[&nbsp; &nbsp; 9.790000] ip_tables: (C) 2000-2006 Netfilter Core Team<br />[&nbsp; &nbsp; 9.830000] xt_time: kernel timezone is -0000<br />[&nbsp; &nbsp; 9.860000] cfg80211: Calling CRDA to update world regulatory domain<br />[&nbsp; &nbsp; 9.860000] cfg80211: World regulatory domain updated:<br />[&nbsp; &nbsp; 9.870000] cfg80211:&nbsp; DFS Master region: unset<br />[&nbsp; &nbsp; 9.870000] cfg80211:&nbsp; &nbsp;(start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp), (dfs_cac_time)<br />[&nbsp; &nbsp; 9.880000] cfg80211:&nbsp; &nbsp;(2402000 KHz - 2472000 KHz @ 40000 KHz), (N/A, 2000 mBm), (N/A)<br />[&nbsp; &nbsp; 9.890000] cfg80211:&nbsp; &nbsp;(2457000 KHz - 2482000 KHz @ 40000 KHz), (N/A, 2000 mBm), (N/A)<br />[&nbsp; &nbsp; 9.900000] cfg80211:&nbsp; &nbsp;(2474000 KHz - 2494000 KHz @ 20000 KHz), (N/A, 2000 mBm), (N/A)<br />[&nbsp; &nbsp; 9.910000] cfg80211:&nbsp; &nbsp;(5170000 KHz - 5250000 KHz @ 160000 KHz), (N/A, 2000 mBm), (N/A)<br />[&nbsp; &nbsp; 9.910000] cfg80211:&nbsp; &nbsp;(5250000 KHz - 5330000 KHz @ 160000 KHz), (N/A, 2000 mBm), (0 s)<br />[&nbsp; &nbsp; 9.920000] cfg80211:&nbsp; &nbsp;(5490000 KHz - 5730000 KHz @ 160000 KHz), (N/A, 2000 mBm), (0 s)<br />[&nbsp; &nbsp; 9.930000] cfg80211:&nbsp; &nbsp;(5735000 KHz - 5835000 KHz @ 80000 KHz), (N/A, 2000 mBm), (N/A)<br />[&nbsp; &nbsp; 9.940000] cfg80211:&nbsp; &nbsp;(57240000 KHz - 63720000 KHz @ 2160000 KHz), (N/A, 0 mBm), (N/A)<br />[&nbsp; &nbsp; 9.980000] PPP generic driver version 2.4.2<br />[&nbsp; &nbsp;10.000000] NET: Registered protocol family 24<br />[&nbsp; &nbsp;10.060000] ath: phy0: Unable to initialize hardware; initialization status: -5<br />[&nbsp; &nbsp;10.070000] ath9k ar934x_wmac: failed to initialize device<br />[&nbsp; &nbsp;10.070000] ath9k: probe of ar934x_wmac failed with error -5<br />[&nbsp; &nbsp;10.080000] PCI: Enabling device 0000:00:00.0 (0000 -&gt; 0002)<br />[&nbsp; &nbsp;10.090000] ath: phy1: Unable to initialize hardware; initialization status: -5<br />[&nbsp; &nbsp;10.100000] ath9k 0000:00:00.0: Failed to initialize device<br />[&nbsp; &nbsp;10.100000] ath9k: probe of 0000:00:00.0 failed with error -5<br />[&nbsp; &nbsp;17.380000] jffs2_scan_eraseblock(): End of filesystem marker found at 0x0<br />[&nbsp; &nbsp;17.390000] jffs2_build_filesystem(): unlocking the mtd device... done.<br />[&nbsp; &nbsp;20.130000] IPv6: ADDRCONF(NETDEV_UP): eth0: link is not ready<br />[&nbsp; &nbsp;20.160000] IPv6: ADDRCONF(NETDEV_UP): eth0.1: link is not ready<br />[&nbsp; &nbsp;20.160000] device eth0.1 entered promiscuous mode<br />[&nbsp; &nbsp;20.170000] device eth0 entered promiscuous mode<br />[&nbsp; &nbsp;20.200000] IPv6: ADDRCONF(NETDEV_UP): br-lan: link is not ready<br />[&nbsp; &nbsp;20.210000] IPv6: ADDRCONF(NETDEV_UP): eth0.2: link is not ready<br />[&nbsp; &nbsp;21.680000] eth0: link up (1000Mbps/Full duplex)<br />[&nbsp; &nbsp;21.680000] IPv6: ADDRCONF(NETDEV_CHANGE): eth0: link becomes ready<br />[&nbsp; &nbsp;21.730000] br-lan: port 1(eth0.1) entered forwarding state<br />[&nbsp; &nbsp;21.730000] br-lan: port 1(eth0.1) entered forwarding state<br />[&nbsp; &nbsp;21.740000] IPv6: ADDRCONF(NETDEV_CHANGE): eth0.1: link becomes ready<br />[&nbsp; &nbsp;21.740000] IPv6: ADDRCONF(NETDEV_CHANGE): eth0.2: link becomes ready<br />[&nbsp; &nbsp;21.750000] IPv6: ADDRCONF(NETDEV_CHANGE): br-lan: link becomes ready<br />[&nbsp; &nbsp;23.730000] br-lan: port 1(eth0.1) entered forwarding state<br />[&nbsp; &nbsp;17.400000] jffs2_build_filesystem(): erasing all blocks after the end marker... done.<br />[&nbsp; &nbsp;30.190000] jffs2: notice: (934) jffs2_build_xattr_subsystem: complete building xattr subsystem, 0 of xdatum (0 unchecked, 0 orphan) and 0 of xref (0 dead, 0 orphan) found.<br />root@OpenWrt:/#</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p270426">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">drawz</div>
					<div class="post-datetime">
						29 Mar 2015, 23:06					</div>
				</div>
				<div class="post-content content">
					<p>Try flipping the wireless on/off switch - it was backward in some cases and/or some versions of OpenWrt I believe.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p270431">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">mxpdsa</div>
					<div class="post-datetime">
						29 Mar 2015, 23:18					</div>
				</div>
				<div class="post-content content">
					<p>I tried but it did not help.<br />Is there a solution?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p270435">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">ninno</div>
					<div class="post-datetime">
						30 Mar 2015, 00:00					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>mxpdsa wrote:</cite><blockquote><p>I tried but it did not help.<br />Is there a solution?</p></blockquote></div><p>I guess you already double checked your config, so how did you brick it - could that have damaged the &quot;art&quot; - partition? (Which is bad because its device specific and could cause such a problem). <a href="https://wiki.openwrt.org/doc/howto/restore_art_partition">https://wiki.openwrt.org/doc/howto/rest … _partition</a></p><div class="codebox"><pre><code>root@ap1:~# cat /proc/mtd 
dev:    size   erasesize  name
...
mtd4: 00010000 00010000 &quot;art&quot;
...</code></pre></div><p>Try to dump it (dd if=/dev/mtd4 of=/tmp/art), check if its empty or contains something what should not be there (&quot;strings /tmp/art&quot; should not return any real strings like from config files or whatever). One of mine starts like this:</p><div class="codebox"><pre><code>0:02:03:04:05:06
&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;$ &amp;&amp;$ &amp;&amp;$ $$$&quot; 
$$$&quot; 
$$$&quot; 
&quot;&quot;&quot; 
&quot;&quot;&quot; 
&quot;&quot;&quot; 
ABEG12</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p270446">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">mxpdsa</div>
					<div class="post-datetime">
						30 Mar 2015, 02:20					</div>
				</div>
				<div class="post-content content">
					<p>Hello I did</p><p>root @ OpenWrt: / # cat / proc / mtd<br />dev: size erasesize name<br />mtd0: 00020000 00010000 &quot;u-boot&quot;<br />MTD1: 00010000 0010e5fc &quot;kernel&quot;<br />mtd2: 00010000 006c1a04 &quot;rootfs&quot;<br />mtd3: 004a0000 00010000 &quot;rootfs_data&quot;<br />mtd4: 00010000 00010000 &quot;art&quot;<br />mtd5: 00010000 007d0000 &quot;firmware&quot;</p><p>I also create&nbsp; the dump file<br />art.backup but hex editor did not fare <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>Is my art.backup file <br /><a href="http://www.filedropper.com/art_2">http://www.filedropper.com/art_2</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p270465">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">ninno</div>
					<div class="post-datetime">
						30 Mar 2015, 08:15					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>mxpdsa wrote:</cite><blockquote><p>Hello I did</p><p>root @ OpenWrt: / # cat / proc / mtd<br />...<br />mtd4: 00010000 00010000 &quot;art&quot;</p><br /><p>Is my art.backup file <br /><a href="http://www.filedropper.com/art_2">http://www.filedropper.com/art_2</a></p></blockquote></div><p>This looks like a backup of /dev/mtd5 (includes only kernel/firmware/data), it doesnt include the art partition or the bootloader:<br /><a href="http://wiki.openwrt.org/toh/tp-link/tl-wdr4300?#flash_layout">http://wiki.openwrt.org/toh/tp-link/tl- … ash_layout</a></p><p>Can you just dump /dev/mtd4?</p><p>Edit:<br />Just to clearify: the &quot;how to restore art&quot; link mentions mtd5 - for wdr4300 mtd4 is correct, just rely on what /proc/mtd shows for your router</p>											<p class="post-edited">(Last edited by <strong>ninno</strong> on 30 Mar 2015, 08:31)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p270479">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">mxpdsa</div>
					<div class="post-datetime">
						30 Mar 2015, 10:50					</div>
				</div>
				<div class="post-content content">
					<p>I think it MTD4 empty<br /><a href="http://www.filedropper.com/mtd4">http://www.filedropper.com/mtd4</a></p><br /><p>There is a possibility of copying from another router and that you may have you?</p><p>root@OpenWrt:/# cat&nbsp; /proc/mtd<br />dev:&nbsp; &nbsp; size&nbsp; &nbsp;erasesize&nbsp; name<br />mtd0: 00020000 00010000 &quot;u-boot&quot;<br />mtd1: 0010e5fc 00010000 &quot;kernel&quot;<br />mtd2: 006c1a04 00010000 &quot;rootfs&quot;<br />mtd3: 004a0000 00010000 &quot;rootfs_data&quot;<br />mtd4: 00010000 00010000 &quot;art&quot;<br />mtd5: 007d0000 00010000 &quot;firmware&quot;</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p270592">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">ninno</div>
					<div class="post-datetime">
						31 Mar 2015, 00:32					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>mxpdsa wrote:</cite><blockquote><p>I think it MTD4 empty<br /><a href="http://www.filedropper.com/mtd4">http://www.filedropper.com/mtd4</a></p><p>There is a possibility of copying from another router and that you may have you?</p></blockquote></div><p>Yes, this file looks bad indeed.</p><p>Here is the only one i have for that model, its from a wdr4300 v1.1 (if i remember correctly, can check tomorrow):<br /><a href="http://wikisend.com/download/514202/mtd4">http://wikisend.com/download/514202/mtd4</a></p><p>Hopefully you can get your router to work again using that, good luck. If it doesnt work you might have to search for another one.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p270600">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">mxpdsa</div>
					<div class="post-datetime">
						31 Mar 2015, 02:36					</div>
				</div>
				<div class="post-content content">
					<p>Hello friend I had no luck with flash!</p><p>I tried following the instructions on the following link</p><p><a href="https://wiki.openwrt.org/doc/howto/restore_art_partition">https://wiki.openwrt.org/doc/howto/rest … _partition</a></p><p>Where is making a mistake?</p><p>root@OpenWrt:/# ls /tmp<br />TZ&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lock&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mtd4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; state<br />dhcp.leases&nbsp; &nbsp; &nbsp; &nbsp;log&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;overlay&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;sysinfo<br />dnsmasq.d&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;luci-indexcache&nbsp; &nbsp;resolv.conf<br />etc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;luci-modulecache&nbsp; resolv.conf.auto<br />hosts&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;luci-sessions&nbsp; &nbsp; &nbsp;run</p><p>root@OpenWrt:/# mtd -r write /tmp/mtd4 art<br />Could not open mtd device: art<br />Can&#039;t open device for writing!<br />root@OpenWrt:/#</p><br /><br /><p>db12x&gt; tftpboot 0x80000000 mtd4<br />Using eth0 device<br />TFTP from server 192.168.1.100; our IP address is 192.168.1.111<br />Filename &#039;mtd4&#039;.<br />Load address: 0x80000000<br />Loading: #############<br />done<br />Bytes transferred = 65536 (10000 hex)</p><br /><p>db12x&gt; erase 0xbf7f0000 +0x10000<br />Error: end address (0xbf7fffff) not in flash!<br />Bad address format<br />db12x&gt;</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p270620">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">ninno</div>
					<div class="post-datetime">
						31 Mar 2015, 09:08					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>mxpdsa wrote:</cite><blockquote><p>Hello friend I had no luck with flash!</p><p>db12x&gt; erase 0xbf7f0000 +0x10000<br />Error: end address (0xbf7fffff) not in flash!<br />Bad address format<br />db12x&gt;</p></blockquote></div><p>Your address should be different. This is for a wr1043nd:</p><div class="codebox"><pre><code>ar7100&gt; printenv
bootargs=console=ttyS0,115200 root=31:02 rootfstype=jffs2 init=/sbin/init mtdparts=ar9100-nor0:128k(u-boot),1024k(kernel),4096k(rootfs),64k(art)
bootcmd=bootm 0xbf020000</code></pre></div><p>...so this router would map the flash to 0xbfxxxxxx, and for it the address you used would be correct.</p><p>The wdr4300 has more memory and other mappings:<br /><a href="http://wiki.openwrt.org/toh/tp-link/tl-wdr4300#original_bootloader_settings">http://wiki.openwrt.org/toh/tp-link/tl- … r_settings</a></p><p>Just rely on your own &quot;printenv&quot; for the calculation of the addresses.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p270622">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">vilpalu</div>
					<div class="post-datetime">
						31 Mar 2015, 09:28					</div>
				</div>
				<div class="post-content content">
					<p>hi, got two wdr4300 v1.7 which has the same art&#039;s (all FF)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p270663">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">lems</div>
					<div class="post-datetime">
						31 Mar 2015, 17:17					</div>
				</div>
				<div class="post-content content">
					<p>This might be a dumb question, but how does one bork one&#039;s ART partition? By not removing the bootloader from the original firmware, and flashing that via mtd, or so? Or is this even possible from within OpenWrt? Because I read that the partition is not writeable by default.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p270674">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">mxpdsa</div>
					<div class="post-datetime">
						31 Mar 2015, 17:58					</div>
				</div>
				<div class="post-content content">
					<p>What is my address?</p><p>db12x&gt; printenv<br />bootargs=console=ttyS0,115200 root=31:02 rootfstype=squashfs init=/sbin/init mtd&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;parts=ath-nor0:256k(u-boot),64k(u-boot-env),6336k(rootfs),1408k(uImage),64k(mib0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;),64k(ART)<br />bootcmd=bootm 0x9f020000<br />bootdelay=1<br />baudrate=115200<br />ethaddr=0xba:0xbe:0xfa:0xce:0x08:0x41<br />ipaddr=192.168.1.111<br />serverip=192.168.1.100<br />dir=<br />lu=tftp 0x80060000 ${dir}u-boot.bin&amp;&amp;erase 0x9f000000 +$filesize;cp.b $fileaddr&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x9f000000 $filesize<br />lf=tftp 0x80060000 ${dir}db12x${bc}-jffs2&amp;&amp;erase 0x9f050000 +0x630000;cp.b $file&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;addr 0x9f050000 $filesize<br />lk=tftp 0x80060000 ${dir}vmlinux${bc}.lzma.uImage&amp;&amp;erase 0x9f680000 +$filesize;c&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;p.b $fileaddr 0x9f680000 $filesize<br />stdin=serial<br />stdout=serial<br />stderr=serial<br />ethact=eth0</p><p>Environment size: 686/65532 bytes<br />db12x&gt;</p><br /><p>When you do this after flash system will not boot?</p><p>b12x&gt; tftpboot 0x80000000 mtd4<br />dup 1 speed 1000<br />Using eth0 device<br />TFTP from server 192.168.1.100; our IP address is 192.168.1.111<br />Filename &#039;mtd4&#039;.<br />Load address: 0x80000000<br />Loading: #############<br />done<br />Bytes transferred = 65536 (10000 hex)<br />db12x&gt; erase 0x9f020000 +0x10000</p><p>First 0x2 last 0x2 sector size 0x10000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2<br />Erased 1 sectors<br />db12x&gt; cp.b 0x8000000 0x9f020000 0x10000<br />Copy to Flash... write addr: 9f020000<br />done<br />db12x&gt;</p><br /><p>b12x&gt; reset</p><p>U-Boot 1.1.4 (Nov 13 2014 - 11:10:12)</p><p>U-boot DB120</p><br /><p>DRAM:&nbsp; 128 MB<br />id read 0x100000ff<br />flash size 8MB, sector count = 128<br />Flash:&nbsp; 8 MB<br />Using default environment</p><p>PCIe Reset OK!!!!!!<br />In:&nbsp; &nbsp; serial<br />Out:&nbsp; &nbsp;serial<br />Err:&nbsp; &nbsp;serial<br />Net:&nbsp; &nbsp;ag934x_enet_initialize...<br />No valid address in Flash. Using fixed address<br /> wasp&nbsp; reset mask:c03300<br />WASP&nbsp; ----&gt; S17 PHY *<br />: cfg1 0x7 cfg2 0x7114<br />eth0: ba:be:fa:ce:08:41<br />athrs17_reg_init: complete<br />eth0 up<br />eth0<br />Autobooting in 1 seconds<br />## Booting image at 9f020000 ...<br />&nbsp; &nbsp;Uncompressing Kernel Image ... Stream with EOS marker is not supportedLZMA ERROR 1 - must RESET board to recover</p><p>U-Boot 1.1.4 (Nov 13 2014 - 11:10:12)</p><p>U-boot DB120</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p270678">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">mxpdsa</div>
					<div class="post-datetime">
						31 Mar 2015, 18:19					</div>
				</div>
				<div class="post-content content">
					<p>My router is TL - WDR4300 rev 1.0 and I installed Barrier Breaker - 14:07</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p270743">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">ninno</div>
					<div class="post-datetime">
						1 Apr 2015, 01:35					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>mxpdsa wrote:</cite><blockquote><p>Autobooting in 1 seconds<br />## Booting image at 9f020000 ...<br />&nbsp; &nbsp;Uncompressing Kernel Image ... Stream with EOS marker is not supportedLZMA ERROR 1 - must RESET board to recover</p><p>...</p><p>My router is TL - WDR4300 rev 1.0 and I installed Barrier Breaker - 14:07</p></blockquote></div><p>Now you erased both, so you need to flash both <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />(firmware + art-partition).<br />Dont touch 0x9f000000++ -&gt; should be the uboot</p><br /><div class="quotebox"><cite>vilpalu wrote:</cite><blockquote><p>hi, got two wdr4300 v1.7 which has the same art&#039;s (all FF)</p></blockquote></div><p>Well, this is strange - if thats supposed to be FFed, im out - the router i took the ART-Partition from is a wdr4300 v1.2 (not v1.1, i checked this today), did not see an empty art-partition by now...</p><p>If its another one, not v1.7, maybe:&nbsp; (WITHOUT warranty):</p><p># recover ART<br />tftpboot 0x80060000 mtd4<br />erase 0x9f7f0000 +0x10000<br />cp.b 0x80060000 0x9f7f0000 0x10000</p><p># recover firmware:<br />You need a factory image, eg. <a href="https://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/openwrt-ar71xx-generic-tl-wdr4300-v1-squashfs-factory.bin">https://downloads.openwrt.org/barrier_b … actory.bin</a></p><p>tftpboot 0x80060000 openwrt-ar71xx-generic-tl-wdr4300-v1-squashfs-factory.bin<br />erase 0x9f020000 +0x7c0000<br />cp.b 0x80060000 0x9f020000 0x7c0000</p><p>(i never recovered a wdr4300, only wr1043nd)</p><p>Good luck again</p>											<p class="post-edited">(Last edited by <strong>ninno</strong> on 1 Apr 2015, 01:38)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p270749">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">mxpdsa</div>
					<div class="post-datetime">
						1 Apr 2015, 02:36					</div>
				</div>
				<div class="post-content content">
					<p>I can not believe now doing everything <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Thank greatest friend <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />)))</p><p>How can I backup all / all partitions, in case there are problems that can easily do a restore?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p270750">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">mxpdsa</div>
					<div class="post-datetime">
						1 Apr 2015, 02:50					</div>
				</div>
				<div class="post-content content">
					<p>Another question <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>USB Storage server? whether there is a possibility.</p><p>(This router I bought most of these reasons)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p270781">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">ninno</div>
					<div class="post-datetime">
						1 Apr 2015, 10:16					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>mxpdsa wrote:</cite><blockquote><p>I can not believe now doing everything <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />Thank greatest friend <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />)))</p><p>How can I backup all / all partitions, in case there are problems that can easily do a restore?</p></blockquote></div><p>So you got your router back? Perfect <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>You can always save /dev/mtd0,mtd4,mtd5. mtd5 includes firmware + any configuration changes, mtd4 - art partition, mtd0 is your bootloader (not so easy to flash back if it ever gets deleted).<br />Backup of the router can also be taken from the luci web interface - no need for the console, just try it.</p><div class="quotebox"><cite>mxpdsa wrote:</cite><blockquote><p>Another question <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /><br />USB Storage server? whether there is a possibility.<br />(This router I bought most of these reasons)</p></blockquote></div><p>I never used openwrt for storage, but sure can be done and its seems nicely integrated into the web interface as well, just check out how to configures samba for example here:<br /><a href="http://wiki.openwrt.org/doc/recipes/usb-storage-samba-webinterface">http://wiki.openwrt.org/doc/recipes/usb … binterface</a><br /><a href="http://wiki.openwrt.org/doc/uci/samba">http://wiki.openwrt.org/doc/uci/samba</a><br /><a href="http://wiki.openwrt.org/doc/uci/fstab">http://wiki.openwrt.org/doc/uci/fstab</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p270799">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">mxpdsa</div>
					<div class="post-datetime">
						1 Apr 2015, 13:01					</div>
				</div>
				<div class="post-content content">
					<p>I did a backup and I sincerely hope that we will not need it again <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>dd if=/dev/mtd1 of=/tmp/mtd1-kernel.backup<br />dd if=/dev/mtd2 of=/tmp/mtd2-rootfs.backup<br />dd if=/dev/mtd3 of=/tmp/mtd3-rootfs_data.backup<br />dd if=/dev/mtd4 of=/tmp/mtd4-art.backup<br />dd if=/dev/mtd5 of=/tmp/mtd5-firmware.backup</p><br /><p>Thanks a lot friends!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p270806">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">vilpalu</div>
					<div class="post-datetime">
						1 Apr 2015, 13:34					</div>
				</div>
				<div class="post-content content">
					<p>I was wrong about all FF in ART. start from 0x4ff9 to 0x541f is info <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>