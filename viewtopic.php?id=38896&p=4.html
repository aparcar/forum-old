<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> TP-Link MR3220V2</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 7 Oct 2014 and 6 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 4 of 6</div><nav><ul><li><a href="viewtopic.php%3Fid=38896&amp;p=1.html">1</a></li><li><a href="viewtopic.php%3Fid=38896&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=38896&amp;p=3.html">3</a></li><li class="pagination-current"><span>4</span></li><li><a href="viewtopic.php%3Fid=38896&amp;p=5.html">5</a></li><li><a href="viewtopic.php%3Fid=38896&amp;p=6.html">6</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p186279">
				<div class="post-metadata">
					<div class="post-num">Post #76</div>
					<div class="post-author">obsy</div>
					<div class="post-datetime">
						17 Dec 2012, 14:10					</div>
				</div>
				<div class="post-content content">
					<p>gpio8 - usb power<br />gpio26 - usb LED</p>									</div>
			</article>

			
		
						<div class="notice">
				<p>Sorry, posts 77 to 75 are missing from our archive.</p>
			</div>
		
		
		
			<article class="post" id="p185866">
				<div class="post-metadata">
					<div class="post-num">Post #76</div>
					<div class="post-author">drum</div>
					<div class="post-datetime">
						12 Dec 2012, 22:05					</div>
				</div>
				<div class="post-content content">
					<p>Hello guys, need help please....i am noob with all this....</p><p>Steps witch i did are:</p><p>1. Flashed router with build from post 19 (mr3220-v2-aabeta2). It went all ok...</p><p>2. Flashed router thru luci web interface with build r33720 from here <a href="http://wiki.openwrt.org/toh/tp-link/tl-ap121">http://wiki.openwrt.org/toh/tp-link/tl-ap121</a> and it didnt went well, seems it is bricked now <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad"/></p><p>What can i do? Can you write me details how to bring it back in life again?</p><p>Thanks</p>											<p class="post-edited">(Last edited by <strong>drum</strong> on 12 Dec 2012, 22:10)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186312">
				<div class="post-metadata">
					<div class="post-num">Post #77</div>
					<div class="post-author">drum</div>
					<div class="post-datetime">
						17 Dec 2012, 21:11					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nebbia88 wrote:</cite><blockquote><p>Serial console is the only way.. :-(</p></blockquote></div><p>tnx for help</p><p>I have more few questions....</p><p>1. Can someone confirm me that build from here <a href="http://wiki.openwrt.org/toh/tp-link/tl-ap121">http://wiki.openwrt.org/toh/tp-link/tl-ap121</a> is working? I have notice it have 3.4MB and other builds from this topic are 3.8MB</p><p>2. Where can i find some tiny build for this router? All builds from this topic dont have enough free space for my needs...</p><p>Thanks,<br />...sry for my bad english...</p>											<p class="post-edited">(Last edited by <strong>drum</strong> on 17 Dec 2012, 23:47)</p>
									</div>
			</article>

			
		
						<div class="notice">
				<p>Sorry, posts 78 to 76 are missing from our archive.</p>
			</div>
		
		
		
			<article class="post" id="p185867">
				<div class="post-metadata">
					<div class="post-num">Post #77</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						12 Dec 2012, 22:22					</div>
				</div>
				<div class="post-content content">
					<p>Have you tried failsafe mode? Also, if I may ask, why did you flash the second time?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186315">
				<div class="post-metadata">
					<div class="post-num">Post #78</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						17 Dec 2012, 21:53					</div>
				</div>
				<div class="post-content content">
					<p>when you connect serial, can you try my build? it has only luci included.. how many packages do you have to install?</p>									</div>
			</article>

			
		
						<div class="notice">
				<p>Sorry, posts 79 to 77 are missing from our archive.</p>
			</div>
		
		
		
			<article class="post" id="p185869">
				<div class="post-metadata">
					<div class="post-num">Post #78</div>
					<div class="post-author">drum</div>
					<div class="post-datetime">
						12 Dec 2012, 22:51					</div>
				</div>
				<div class="post-content content">
					<p>Fail safe do not help.....</p><p>This second flash i was trying at first place from TP-Link WebGUI via Firmware Upgrade but i had issue with error warning (Error code: 18005 Upgrade unsuccessfully because the version of the upgraded file was incorrect. Please check the file name.)</p><p>So than i tryed next build mentoined in step 1 and it was sucesfull but there was not enough space left to install required packages to run webcam on it. </p><p>To make it in easy way and save some time with uninstalling unnecessary packages i was hoping that with this second build there will be more empty space, so i tryed to flash it...</p><p>Now when i turn it on there is only powered power led and nothing else happens...</p>											<p class="post-edited">(Last edited by <strong>drum</strong> on 12 Dec 2012, 23:11)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186330">
				<div class="post-metadata">
					<div class="post-num">Post #79</div>
					<div class="post-author">drum</div>
					<div class="post-datetime">
						18 Dec 2012, 00:06					</div>
				</div>
				<div class="post-content content">
					<p>yes i can try, but with luci installed there will not be enough free space to install support to run webcam on it. I allready have older 3220 (rev1.2) with basic build of openwrt and there is not posible to install luci and my packages.</p>									</div>
			</article>

			
		
						<div class="notice">
				<p>Sorry, posts 80 to 78 are missing from our archive.</p>
			</div>
		
		
		
			<article class="post" id="p185994">
				<div class="post-metadata">
					<div class="post-num">Post #79</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						14 Dec 2012, 08:18					</div>
				</div>
				<div class="post-content content">
					<p>Serial console is the only way.. :-(</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186901">
				<div class="post-metadata">
					<div class="post-num">Post #80</div>
					<div class="post-author">embedded.mcu</div>
					<div class="post-datetime">
						24 Dec 2012, 13:57					</div>
				</div>
				<div class="post-content content">
					<p>I am newbie in openwrt.</p><p>I have downloaded the trunk and complied the images for MR3220.</p><p>i have go the output images for both v1 and v2 boards.</p><p>is the images for v2 is correct? i have MR3220v2 board. I have earlier flashed Cyndy&#039;s image it works 3g connection and Ethernet connections.</p><p>is it safe to use this build?</p>									</div>
			</article>

			
		
						<div class="notice">
				<p>Sorry, posts 81 to 79 are missing from our archive.</p>
			</div>
		
		
		
			<article class="post" id="p186030">
				<div class="post-metadata">
					<div class="post-num">Post #80</div>
					<div class="post-author">johndoe</div>
					<div class="post-datetime">
						14 Dec 2012, 13:31					</div>
				</div>
				<div class="post-content content">
					<p>openwrt_user please post normal torrent link because I can&#039;t uncompres zip/uue file (CRC Errors)</p>											<p class="post-edited">(Last edited by <strong>johndoe</strong> on 14 Dec 2012, 22:40)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186182">
				<div class="post-metadata">
					<div class="post-num">Post #81</div>
					<div class="post-author">openwrt_user</div>
					<div class="post-datetime">
						16 Dec 2012, 01:51					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>johndoe wrote:</cite><blockquote><p>openwrt_user please post normal torrent link because I can&#039;t uncompres zip/uue file (CRC Errors)</p></blockquote></div><p>I modified my previous posts. I uuencoded the torrent file now.</p>									</div>
			</article>

			
		
						<div class="notice">
				<p>Sorry, posts 82 to 80 are missing from our archive.</p>
			</div>
		
		
		
			<article class="post" id="p186903">
				<div class="post-metadata">
					<div class="post-num">Post #81</div>
					<div class="post-author">robthebrew</div>
					<div class="post-datetime">
						24 Dec 2012, 14:10					</div>
				</div>
				<div class="post-content content">
					<p>&quot;trunk&quot; is never safe. It is bleeding edge new stuff. At the moment Attitude Adjustment is the stable release.<br />If you want to test or develop go with Trunk, otherwise go with AA.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p187028">
				<div class="post-metadata">
					<div class="post-num">Post #82</div>
					<div class="post-author">openwrt_user</div>
					<div class="post-datetime">
						26 Dec 2012, 12:34					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Dioptimizer wrote:</cite><blockquote><p>2 <strong>All</strong><br />Could you create a new ticket and put it on <a href="https://dev.openwrt.org/">https://dev.openwrt.org/</a> working patch for this device, confirming stable work and a fully bootlog for this device.<br />Patch should include the major changes over the last trunk source.<br />It would speed up official support OpenWRT firmware of the device.</p></blockquote></div><p>I added the patches to the <a href="https://dev.openwrt.org/ticket/12026">ticket</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p187241">
				<div class="post-metadata">
					<div class="post-num">Post #83</div>
					<div class="post-author">sancho</div>
					<div class="post-datetime">
						28 Dec 2012, 16:12					</div>
				</div>
				<div class="post-content content">
					<p>I did the similar thing - flashed the firmware from post #19, the WPA wifi encryption did not work. I tried to flash the link from the wiki (the r33720 trunk version) ending up with bricking the router.<br />Any suggestions with unbricking, please?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p187247">
				<div class="post-metadata">
					<div class="post-num">Post #84</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						28 Dec 2012, 17:37					</div>
				</div>
				<div class="post-content content">
					<p>already tried to trigger failsafe mode? get the FAST SYS LED flashing?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p187249">
				<div class="post-metadata">
					<div class="post-num">Post #85</div>
					<div class="post-author">robthebrew</div>
					<div class="post-datetime">
						28 Dec 2012, 17:44					</div>
				</div>
				<div class="post-content content">
					<p>Perhaps Trunks should be renamed &quot;rotten core&quot; or &quot;YouAreFuBar&quot;. So many peops mistake it for something functional.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p187274">
				<div class="post-metadata">
					<div class="post-num">Post #86</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						28 Dec 2012, 22:42					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>RalfFriedl wrote:</cite><blockquote><p>Update:<br />The serial signal is on the two small pads on the back side.<br />TP18 is TX.<br />TP23 is RX.</p></blockquote></div><p> <a href="https://dev.openwrt.org/ticket/12026#comment:29">https://dev.openwrt.org/ticket/12026#comment:29</a> </p><div class="quotebox"><blockquote><p>Beware however that it may not be a good idea to connect Rx directly to TP23 without the resistors of the voltage divider. I killed the X input of my device,</p></blockquote></div><p>Could someone please elaborate what is safe to connect to TP23 and why?? Resistors??</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p187275">
				<div class="post-metadata">
					<div class="post-num">Post #87</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						28 Dec 2012, 22:43					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>robthebrew wrote:</cite><blockquote><p>Perhaps Trunks should be renamed &quot;rotten core&quot; or &quot;YouAreFuBar&quot;. So many peops mistake it for something functional.</p></blockquote></div><p>seems to me that everywhere in wiki it&#039;s written that trunk images are risky, unstable, and built for testing..</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188387">
				<div class="post-metadata">
					<div class="post-num">Post #88</div>
					<div class="post-author">4lltim3z0ck3r</div>
					<div class="post-datetime">
						9 Jan 2013, 12:27					</div>
				</div>
				<div class="post-content content">
					<p>is there a (safe) release with working wpa?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188431">
				<div class="post-metadata">
					<div class="post-num">Post #89</div>
					<div class="post-author">viraga84</div>
					<div class="post-datetime">
						9 Jan 2013, 21:38					</div>
				</div>
				<div class="post-content content">
					<p>Dear all,<br />can I use this router as a wlan radio (with usb sound card)?</p><p><a href="http://mightyohm.com/blog/2008/10/building-a-wifi-radio-part-1-introduction/">Mighty Ohm link</a></p><p>Thank you for your replies!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188468">
				<div class="post-metadata">
					<div class="post-num">Post #90</div>
					<div class="post-author">cindy.wijaya</div>
					<div class="post-datetime">
						10 Jan 2013, 10:22					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>viraga84 wrote:</cite><blockquote><p>Dear all,<br />can I use this router as a wlan radio (with usb sound card)?</p><p><a href="http://mightyohm.com/blog/2008/10/building-a-wifi-radio-part-1-introduction/">Mighty Ohm link</a></p><p>Thank you for your replies!</p></blockquote></div><p>Of course <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188469">
				<div class="post-metadata">
					<div class="post-num">Post #91</div>
					<div class="post-author">cindy.wijaya</div>
					<div class="post-datetime">
						10 Jan 2013, 10:23					</div>
				</div>
				<div class="post-content content">
					<p><strong>Adding support to TP-LINK MR3220 V.2 + MR3420 V.2<br />OpenWrt Attitude Adjustment 12.09-rc1</strong></p><p>diff<br /></p><div class="codebox"><pre><code>Index: target/linux/ar71xx/files/arch/mips/ath79/mach-tl-wr841n-v8.c
===================================================================
--- target/linux/ar71xx/files/arch/mips/ath79/mach-tl-wr841n-v8.c    (revision 35052)
+++ target/linux/ar71xx/files/arch/mips/ath79/mach-tl-wr841n-v8.c    (working copy)
@@ -8,6 +8,9 @@
  *  by the Free Software Foundation.
  */
 
+#include &quot;dev-usb.h&quot; 
+#include &lt;linux/gpio.h&gt;
+
 #include &lt;linux/platform_device.h&gt;
 
 #include &lt;asm/mach-ath79/ath79.h&gt;
@@ -32,7 +35,7 @@
 
 #define TL_WR841NV8_GPIO_BTN_RESET    17
 #define TL_WR841NV8_GPIO_SW_RFKILL    16
-
+#define TL_WR841NV8_GPIO_USB_POWER    4
 #define TL_WR841NV8_KEYS_POLL_INTERVAL    20    /* msecs */
 #define TL_WR841NV8_KEYS_DEBOUNCE_INTERVAL (3 * TL_WR841NV8_KEYS_POLL_INTERVAL)
 
@@ -111,6 +114,13 @@
                     ARRAY_SIZE(tl_wr841n_v8_gpio_keys),
                     tl_wr841n_v8_gpio_keys);
 
+    /* enable power for the USB port */
+    gpio_request(TL_WR841NV8_GPIO_USB_POWER, &quot;USB power&quot;);
+    gpio_direction_input(TL_WR841NV8_GPIO_USB_POWER);
+
+    ath79_register_usb();
+    /* END for the USB port */
+
     ath79_register_m25p80(&amp;tl_wr841n_v8_flash_data);
 
     ath79_setup_ar934x_eth_cfg(AR934X_ETH_CFG_SW_PHY_SWAP);
@@ -135,5 +145,5 @@
     ath79_register_wmac(ee, mac);
 }
 
-MIPS_MACHINE(ATH79_MACH_TL_WR841N_V8, &quot;TL-WR841N-v8&quot;, &quot;TP-LINK TL-WR841N/ND v8&quot;,
+MIPS_MACHINE(ATH79_MACH_TL_WR841N_V8, &quot;TL-WR841N-v8&quot;, &quot;TP-LINK TL-MR3420 v2 | TP-LINK TL-WR841N/ND v8 (3G)&quot;,
          tl_wr841n_v8_setup);
Index: target/linux/ar71xx/files/arch/mips/ath79/mach-tl-wr741nd-v4.c
===================================================================
--- target/linux/ar71xx/files/arch/mips/ath79/mach-tl-wr741nd-v4.c    (revision 35052)
+++ target/linux/ar71xx/files/arch/mips/ath79/mach-tl-wr741nd-v4.c    (working copy)
@@ -13,6 +13,7 @@
 #include &lt;asm/mach-ath79/ath79.h&gt;
 #include &lt;asm/mach-ath79/ar71xx_regs.h&gt;
 
+#include &quot;dev-usb.h&quot;
 #include &quot;common.h&quot;
 #include &quot;dev-eth.h&quot;
 #include &quot;dev-gpio-buttons.h&quot;
@@ -120,6 +121,7 @@
                     ARRAY_SIZE(tl_wr741ndv4_gpio_keys),
                     tl_wr741ndv4_gpio_keys);
 
+    ath79_register_usb();
     ath79_register_m25p80(&amp;tl_wr741ndv4_flash_data);
     ath79_init_mac(ath79_eth0_data.mac_addr, mac, 1);
     ath79_init_mac(ath79_eth1_data.mac_addr, mac, -1);
@@ -132,4 +134,4 @@
 }
 
 MIPS_MACHINE(ATH79_MACH_TL_WR741ND_V4, &quot;TL-WR741ND-v4&quot;,
-         &quot;TP-LINK TL-WR741ND v4&quot;, tl_wr741ndv4_setup);
+         &quot;TP-LINK TL-MR3220 v2 | TP-LINK TL-WR741ND v4 (3G)&quot;, tl_wr741ndv4_setup);
Index: target/linux/ar71xx/image/Makefile
===================================================================
--- target/linux/ar71xx/image/Makefile    (revision 35052)
+++ target/linux/ar71xx/image/Makefile    (working copy)
@@ -848,8 +848,7 @@
 
 $(eval $(call SingleProfile,TPLINKOLD,$(fs_squash),TLWR841NV15,tl-wr841nd-v1.5,TL-WR841N-v1.5,ttyS0,115200,0x08410002,2,4M))
 
-$(eval $(call SingleProfile,TPLINK,$(fs_64kraw),TLMR3220,tl-mr3220-v1,TL-MR3220,ttyS0,115200,0x32200001,1,4M))
-$(eval $(call SingleProfile,TPLINK,$(fs_64kraw),TLMR3420,tl-mr3420-v1,TL-MR3420,ttyS0,115200,0x34200001,1,4M))
+
 $(eval $(call SingleProfile,TPLINK,$(fs_64kraw),TLWA701,tl-wa701n-v1,TL-WA901ND,ttyS0,115200,0x07010001,1,4M))
 $(eval $(call SingleProfile,TPLINK,$(fs_64kraw),TLWA7510NV1,tl-wa7510n,TL-WA7510N,ttyS0,115200,0x75100001,1,4M))
 $(eval $(call SingleProfile,TPLINK,$(fs_64kraw),TLWA901NV1,tl-wa901nd-v1,TL-WA901ND,ttyS0,115200,0x09010001,1,4M))
@@ -869,11 +868,12 @@
 $(eval $(call SingleProfile,TPLINK,$(fs_64kraw),TLWR1043,tl-wr1043nd-v1,TL-WR1043ND,ttyS0,115200,0x10430001,1,8M))
 
 $(eval $(call SingleProfile,TPLINK-LZMA,$(fs_64kraw),TLMR11U,tl-mr11u-v1,TL-MR11U,ttyATH0,115200,0x00110101,1,4Mlzma))
-$(eval $(call SingleProfile,TPLINK-LZMA,$(fs_64kraw),TLMR3020,tl-mr3020-v1,TL-MR3020,ttyATH0,115200,0x30200001,1,4Mlzma))
-$(eval $(call SingleProfile,TPLINK-LZMA,$(fs_64kraw),TLMR3040,tl-mr3040-v1,TL-MR3040,ttyATH0,115200,0x30400001,1,4Mlzma))
+
 $(eval $(call SingleProfile,TPLINK-LZMA,$(fs_64kraw),TLWR703,tl-wr703n-v1,TL-WR703N,ttyATH0,115200,0x07030101,1,4Mlzma))
 $(eval $(call SingleProfile,TPLINK-LZMA,$(fs_64kraw),TLWR740NV4,tl-wr740n-v4,TL-WR741ND-v4,ttyATH0,115200,0x07400004,1,4Mlzma))
+########### referensi mr3220 v.2
 $(eval $(call SingleProfile,TPLINK-LZMA,$(fs_64kraw),TLWR741NV4,tl-wr741nd-v4,TL-WR741ND-v4,ttyATH0,115200,0x07410004,1,4Mlzma))
+########### 
 $(eval $(call SingleProfile,TPLINK-LZMA,$(fs_64kraw),TLWR841NV8,tl-wr841n-v8,TL-WR841N-v8,ttyS0,115200,0x08410008,1,4Mlzma))
 $(eval $(call SingleProfile,TPLINK-LZMA,$(fs_64kraw),TLWR1041,tl-wr1041n-v2,TL-WR1041N-v2,ttyS0,115200,0x10410002,1,4Mlzma))
 $(eval $(call SingleProfile,TPLINK-LZMA,$(fs_64kraw),TLWR2543,tl-wr2543-v1,TL-WR2543N,ttyS0,115200,0x25430001,1,8Mlzma,-v 3.13.99))
@@ -912,6 +912,19 @@
 
 $(eval $(call SingleProfile,ZyXEL,$(fs_64k),NBG_460N_550N_550NH,nbg460n_550n_550nh,NBG460N,ttyS0,115200,NBG-460N))
 
+$(eval $(call SingleProfile,TPLINK-LZMA,$(fs_64kraw),TLMR3020V1,tl-mr3020-v1,TL-MR3020,ttyATH0,115200,0x30200001,1,4Mlzma))
+$(eval $(call SingleProfile,TPLINK-LZMA,$(fs_64kraw),TLMR3040V1,tl-mr3040-v1,TL-MR3040,ttyATH0,115200,0x30400001,1,4Mlzma))
+$(eval $(call SingleProfile,TPLINK,$(fs_64kraw),TLMR3220V1,tl-mr3220-v1,TL-MR3220,ttyS0,115200,0x32200001,1,4M))
+$(eval $(call SingleProfile,TPLINK,$(fs_64kraw),TLMR3420V1,tl-mr3420-v1,TL-MR3420,ttyS0,115200,0x34200001,1,4M))
+############ MR3220 V.2
+$(eval $(call SingleProfile,TPLINK-LZMA,$(fs_64kraw),TLMR3220V2,tl-mr3220-v2,TL-WR741ND-v4,ttyATH0,115200,0x32200002,1,4Mlzma))
+$(eval $(call SingleProfile,TPLINK-LZMA,$(fs_64kraw),TLMR3420V2,tl-mr3420-v2,TL-WR841N-v8,ttyS0,115200,0x34200002,1,4Mlzma))
+############ 
+#----------------------tambahan
+$(eval $(call MultiProfile,TLMR3220,TLMR3220V1 TLMR3220V2))
+$(eval $(call MultiProfile,TLMR3420,TLMR3420V1 TLMR3420V2))
+$(eval $(call MultiProfile,TLMR3020,TLMR3020V1 TLMR3020V2))
+#----------------------
 $(eval $(call MultiProfile,AP121,AP121_2M AP121_4M))
 $(eval $(call MultiProfile,EWDORIN, EWDORINAP EWDORINRT))
 $(eval $(call MultiProfile,TEW652BRP,TEW652BRP_FW TEW652BRP_RECOVERY))
Index: target/linux/ar71xx/patches-3.3/610-MIPS-ath79-openwrt-machines.patch
===================================================================
--- target/linux/ar71xx/patches-3.3/610-MIPS-ath79-openwrt-machines.patch    (revision 35052)
+++ target/linux/ar71xx/patches-3.3/610-MIPS-ath79-openwrt-machines.patch    (working copy)
@@ -555,6 +555,7 @@
 +config ATH79_MACH_TL_WR741ND_V4
 +    bool &quot;TP-LINK TL-WR741ND v4 support&quot;
 +    select SOC_AR933X
++    select ATH79_DEV_USB
 +    select ATH79_DEV_ETH
 +    select ATH79_DEV_GPIO_BUTTONS
 +    select ATH79_DEV_LEDS_GPIO
@@ -573,6 +574,7 @@
 +config ATH79_MACH_TL_WR841N_V8
 +    bool &quot;TP-LINK TL-WR841N/ND v8 support&quot;
 +    select SOC_AR934X
++    select ATH79_DEV_USB
 +    select ATH79_DEV_ETH
 +    select ATH79_DEV_GPIO_BUTTONS
 +    select ATH79_DEV_LEDS_GPIO
Index: target/linux/ar71xx/base-files/etc/uci-defaults/network
===================================================================
--- target/linux/ar71xx/base-files/etc/uci-defaults/network    (revision 35052)
+++ target/linux/ar71xx/base-files/etc/uci-defaults/network    (working copy)
@@ -134,6 +134,12 @@
     ucidef_add_switch_vlan &quot;switch0&quot; &quot;1&quot; &quot;0 1 2 3 4&quot;
     ;;
 
+tl-mr3420-v2)
+    ucidef_set_interfaces_lan_wan &quot;eth1&quot; &quot;eth0&quot;
+    ucidef_add_switch &quot;switch0&quot; &quot;1&quot; &quot;1&quot;
+    ucidef_add_switch_vlan &quot;switch0&quot; &quot;1&quot; &quot;0 1 2 3 4&quot;
+    ;;
+
 wrt160nl)
     ucidef_set_interfaces_lan_wan &quot;eth0&quot; &quot;eth1&quot;
     ucidef_add_switch &quot;eth0&quot; &quot;1&quot; &quot;1&quot;
@@ -187,6 +193,7 @@
 tew-632brp |\
 tew-712br |\
 tl-mr3220 |\
+tl-mr3220-v2 |\
 tl-mr3420 |\
 tl-wr741nd |\
 tl-wr741nd-v4 |\
Index: tools/firmware-utils/src/mktplinkfw.c
===================================================================
--- tools/firmware-utils/src/mktplinkfw.c    (revision 35052)
+++ tools/firmware-utils/src/mktplinkfw.c    (working copy)
@@ -32,7 +32,9 @@
 #define HEADER_VERSION_V1    0x01000000
 #define HWID_TL_MR3020_V1    0x30200001
 #define HWID_TL_MR3220_V1    0x32200001
+#define HWID_TL_MR3220_V2    0x32200002
 #define HWID_TL_MR3420_V1    0x34200001
+#define HWID_TL_MR3420_V2    0x34200002
 #define HWID_TL_WA701N_V1    0x07010001
 #define HWID_TL_WA7510N_V1    0x75100001
 #define HWID_TL_WA901ND_V1    0x09010001
@@ -173,6 +175,12 @@
         .kernel_ep    = 0x80060000,
         .rootfs_ofs    = 0x100000,
     }, {
+        .id             = &quot;16Mlzma&quot;,
+        .fw_max_len     = 0xfc0000,
+        .kernel_la      = 0x80060000,
+        .kernel_ep      = 0x80060000,
+        .rootfs_ofs     = 0x100000,
+    }, {
         /* terminating entry */
     }
 };
@@ -189,11 +197,21 @@
         .hw_rev        = 1,
         .layout_id    = &quot;4M&quot;,
     }, {
+        .id        = &quot;TL-MR3220v2&quot;,
+        .hw_id        = HWID_TL_MR3220_V2,
+        .hw_rev        = 1,
+        .layout_id    = &quot;4Mlzma&quot;,
+    }, {
         .id        = &quot;TL-MR3420v1&quot;,
         .hw_id        = HWID_TL_MR3420_V1,
         .hw_rev        = 1,
         .layout_id    = &quot;4M&quot;,
     }, {
+        .id        = &quot;TL-MR3420v2&quot;,
+        .hw_id        = HWID_TL_MR3420_V2,
+        .hw_rev        = 1,
+        .layout_id    = &quot;4Mlzma&quot;,
+    }, {
         .id        = &quot;TL-WA701Nv1&quot;,
         .hw_id        = HWID_TL_WA701N_V1,
         .hw_rev        = 1,</code></pre></div><p><a href="http://pastebin.com/gzf2VNhK">pastebin-diff</a></p><p>Download (iix)<br /><a href="http://openwrt.agromapia.com/firmware/aarc1/">http://openwrt.agromapia.com/firmware/aarc1/</a></p><p>Download (int)<br /><a href="https://www.box.com/s/qebaprwq0798dyu19h1c">https://www.box.com/s/qebaprwq0798dyu19h1c</a></p><p>folder contains:<br /></p><div class="codebox"><pre><code>md5sums
openwrt-ar71xx-generic-tl-mr3020-v1-squashfs-factory.bin
openwrt-ar71xx-generic-tl-mr3220-v1-squashfs-factory.bin
openwrt-ar71xx-generic-tl-mr3220-v2-squashfs-factory.bin
openwrt-ar71xx-generic-tl-mr3420-v1-squashfs-factory.bin
openwrt-ar71xx-generic-tl-mr3420-v2-squashfs-factory.bin</code></pre></div><br /><p>Previous firmware:<br /><a href="https://www.box.com/s/cqk23ztqlux1zs034896">https://www.box.com/s/cqk23ztqlux1zs034896</a>[/spoiler]</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188477">
				<div class="post-metadata">
					<div class="post-num">Post #92</div>
					<div class="post-author">evo</div>
					<div class="post-datetime">
						10 Jan 2013, 12:30					</div>
				</div>
				<div class="post-content content">
					<p>Registered just to say thanks to you, cindy, you did the great work here with the patches!<br />I was trying to install fresh AA recently, everything went well except WAN (didn&#039;t tried USB though), and there you go with the new ones.</p>											<p class="post-edited">(Last edited by <strong>evo</strong> on 10 Jan 2013, 12:32)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188519">
				<div class="post-metadata">
					<div class="post-num">Post #93</div>
					<div class="post-author">4lltim3z0ck3r</div>
					<div class="post-datetime">
						10 Jan 2013, 18:09					</div>
				</div>
				<div class="post-content content">
					<p>Works like a Charm now... Thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188575">
				<div class="post-metadata">
					<div class="post-num">Post #94</div>
					<div class="post-author">PVi1</div>
					<div class="post-datetime">
						11 Jan 2013, 11:16					</div>
				</div>
				<div class="post-content content">
					<p>Hello all,</p><p>I have checket out aa svn revision 35052, applied patch from cindy but still getting the error on compile:<br />AP: TPLINK MR3220v2<br />Command used to checkout svn:<br />svn co -r 35052 svn://svn.openwrt.org/openwrt/branches/attitude_adjustment/</p><p>Applied patch<br /></p><div class="codebox"><pre><code>@server:~/openwrt/$ cd attitude_adjustment/
@server:~/openwrt/attitude_adjustment$ patch -p0 &lt; cindy_patch_usb</code></pre></div><p>Error details:<br /></p><div class="codebox"><pre><code>@server:~/openwrt/attitude_adjustment$ make V=s
make[1]: Entering directory `/home/retrolc/openwrt/attitude_adjustment&#039;
make[2]: Entering directory `/home/retrolc/openwrt/attitude_adjustment&#039;
make[3]: Entering directory `/home/retrolc/openwrt/attitude_adjustment/target/linux&#039;
make[4]: Entering directory `/home/retrolc/openwrt/attitude_adjustment/target/linux/ar71xx&#039;
if [ -s &quot;/home/retrolc/openwrt/attitude_adjustment/build_dir/linux-ar71xx_generic/linux-3.3.8/patches/series&quot; ]; then (cd &quot;/home/retrolc/openwrt/attitude_adjustment/build_dir/linux-ar71xx_generic/linux-3.3.8&quot;; if quilt --quiltrc=- next &gt;/dev/null 2&gt;&amp;1; then quilt --quiltrc=- push -a; else quilt --quiltrc=- top &gt;/dev/null 2&gt;&amp;1; fi ); fi
Applying patch platform/610-MIPS-ath79-openwrt-machines.patch
patching file arch/mips/ath79/machtypes.h
patching file arch/mips/ath79/Kconfig
patch: **** malformed patch at line 666:      bool &quot;Ubiquiti Networks XM (rev 1.0) board&quot;

Patch platform/610-MIPS-ath79-openwrt-machines.patch does not apply (enforce with -f)
make[4]: *** [/home/retrolc/openwrt/attitude_adjustment/build_dir/linux-ar71xx_generic/linux-3.3.8/.quilt_checked] Error 1
make[4]: Leaving directory `/home/retrolc/openwrt/attitude_adjustment/target/linux/ar71xx&#039;
make[3]: *** [compile] Error 2
make[3]: Leaving directory `/home/retrolc/openwrt/attitude_adjustment/target/linux&#039;
make[2]: *** [target/linux/compile] Error 2
make[2]: Leaving directory `/home/retrolc/openwrt/attitude_adjustment&#039;
make[1]: *** [/home/retrolc/openwrt/attitude_adjustment/staging_dir/target-mips_r2_uClibc-0.9.33.2/stamp/.target_compile] Error 2
make[1]: Leaving directory `/home/retrolc/openwrt/attitude_adjustment&#039;
make: *** [world] Error 2</code></pre></div><p>Can you help me please?</p><p>Thanks.</p><p>Peter</p>											<p class="post-edited">(Last edited by <strong>PVi1</strong> on 11 Jan 2013, 11:25)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188580">
				<div class="post-metadata">
					<div class="post-num">Post #95</div>
					<div class="post-author">evo</div>
					<div class="post-datetime">
						11 Jan 2013, 11:48					</div>
				</div>
				<div class="post-content content">
					<p>yep, there is an error in this patchfile.<br />Open it and replace line 209 with</p><div class="codebox"><pre><code>@@ -67,6 +147,458 @@ config ATH79_MACH_PB44</code></pre></div><p>This should do the trick.</p><p>Also, after compilation with that new cindy patch wifi wont turn on automatically anymore for some reason (i&#039;m aware of mac80211.sh), and LEDs aren&#039;t working anymore, except the power one...</p>											<p class="post-edited">(Last edited by <strong>evo</strong> on 11 Jan 2013, 12:03)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188585">
				<div class="post-metadata">
					<div class="post-num">Post #96</div>
					<div class="post-author">robthebrew</div>
					<div class="post-datetime">
						11 Jan 2013, 13:29					</div>
				</div>
				<div class="post-content content">
					<p>Could it be that the gpios of the LEDs have changed?<br />I would edit out the LED assignments from mach-tl-wr841n-v8.c and then try manually switching them via gpio calls</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188587">
				<div class="post-metadata">
					<div class="post-num">Post #97</div>
					<div class="post-author">evo</div>
					<div class="post-datetime">
						11 Jan 2013, 14:31					</div>
				</div>
				<div class="post-content content">
					<p>It seemed that I&#039;ve used newer revision, and that could have been a problem for all that stuff. Would try with r35052 (as patch says) soon. Also almost bricked my modem using cindy&#039;s sysupgrade on my build, but luckily failsafe worked out for me!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188588">
				<div class="post-metadata">
					<div class="post-num">Post #98</div>
					<div class="post-author">PVi1</div>
					<div class="post-datetime">
						11 Jan 2013, 15:04					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>evo wrote:</cite><blockquote><p>yep, there is an error in this patchfile.<br />Open it and replace line 209 with</p><div class="codebox"><pre><code>@@ -67,6 +147,458 @@ config ATH79_MACH_PB44</code></pre></div><p>This should do the trick.</p><p>Also, after compilation with that new cindy patch wifi wont turn on automatically anymore for some reason (i&#039;m aware of mac80211.sh), and LEDs aren&#039;t working anymore, except the power one...</p></blockquote></div><p>Hi evo,</p><p>are you sure with the line number?<br />when i open the patch from the pastebin <a href="http://pastebin.com/gzf2VNhK">http://pastebin.com/gzf2VNhK</a> i can see this on line 209:<br />&nbsp; &nbsp;.layout_id&nbsp; &nbsp; &nbsp; = &quot;4Mlzma&quot;,</p><p>Can you post the original text that have to be replaced?</p><p>Thanks,</p><p>Peter</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188595">
				<div class="post-metadata">
					<div class="post-num">Post #99</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						11 Jan 2013, 15:58					</div>
				</div>
				<div class="post-content content">
					<p>i cannot understand why are you using this patches if 3220v2 is supported in trunk!</p><p><a href="https://dev.openwrt.org/changeset/34779">https://dev.openwrt.org/changeset/34779</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188601">
				<div class="post-metadata">
					<div class="post-num">Post #100</div>
					<div class="post-author">evo</div>
					<div class="post-datetime">
						11 Jan 2013, 16:35					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>PVi1 wrote:</cite><blockquote><p>Hi evo,</p><p>are you sure with the line number?<br />when i open the patch from the pastebin <a href="http://pastebin.com/gzf2VNhK">http://pastebin.com/gzf2VNhK</a> i can see this on line 209:<br />&nbsp; &nbsp;.layout_id&nbsp; &nbsp; &nbsp; = &quot;4Mlzma&quot;,</p><p>Can you post the original text that have to be replaced?</p><p>Thanks,</p><p>Peter</p></blockquote></div><p>I was talking about the patch file:</p><p>&lt;...&gt;/OpenWRT/aptitude_adjustment/build_dir/linux-ar71xx_generic/linux-3.3.8/patches/platform/610-MIPS-ath79-openwrt-machines.patch</p><p>P.S. I forgot that I&#039;ve used newer revision. Generally you just search</p><div class="codebox"><pre><code>@@ -67,6 +147,456 @@ config ATH79_MACH_PB44</code></pre></div><p>And replace with</p><div class="codebox"><pre><code>@@ -67,6 +147,458 @@ config ATH79_MACH_PB44</code></pre></div><p>I had the same problem as you, I guess something went wrong with line numbers when they wrote it.</p><p>@nebbia88: didn&#039;t knew that, thanks!</p>											<p class="post-edited">(Last edited by <strong>evo</strong> on 11 Jan 2013, 16:46)</p>
									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 4 of 6</div><nav><ul><li><a href="viewtopic.php%3Fid=38896&amp;p=1.html">1</a></li><li><a href="viewtopic.php%3Fid=38896&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=38896&amp;p=3.html">3</a></li><li class="pagination-current"><span>4</span></li><li><a href="viewtopic.php%3Fid=38896&amp;p=5.html">5</a></li><li><a href="viewtopic.php%3Fid=38896&amp;p=6.html">6</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0.001 -->

</body>
</html>