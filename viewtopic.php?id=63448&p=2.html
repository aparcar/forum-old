<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> IPv6 Internet for Clients</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 3 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 2 of 2</div><nav><ul><li><a href="viewtopic.php%3Fid=63448&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p316185">
				<div class="post-metadata">
					<div class="post-num">Post #26</div>
					<div class="post-author">cmsigler</div>
					<div class="post-datetime">
						22 Mar 2016, 21:18					</div>
				</div>
				<div class="post-content content">
					<p>P.S.:&nbsp; If you have problems later on, check this default route on your workstation:<br /></p><div class="codebox"><pre><code>default via fe80::16cc:20ff:fe4c:4306 dev wlan0  proto ra  metric 1024  expires 1719se</code></pre></div><p>just in case the link-local address which ends in 4306 should be 4307 instead.&nbsp; A quick speculation on my part that may be 100% wrong!&nbsp; Again, radvd/odhcpd <em>shouldn&#039;t</em> mess this up.</p><p>Happy IPv6ing!</p><p>Clemmitt</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p316187">
				<div class="post-metadata">
					<div class="post-num">Post #27</div>
					<div class="post-author">johndoe</div>
					<div class="post-datetime">
						22 Mar 2016, 21:57					</div>
				</div>
				<div class="post-content content">
					<p>Right after the reboot it doesn&#039;t work, but as soon as I ping the router on its global ipv6 address it works. Strange. One more question: Why does the router have 2 global ipv6 addresses?</p><p>Concerning your last post. I didn&#039;t quite get it...</p><div class="codebox"><pre><code>$ ifconfig
          br-lan    Link encap:Ethernet  HWaddr 14:CC:20:4C:43:06  
          inet addr:192.168.1.1  Bcast:192.168.1.255  Mask:255.255.255.0
          inet6 addr: 2001:638:208:d800:16cc:20ff:fe4c:4307/64 Scope:Global
          inet6 addr: fe80::16cc:20ff:fe4c:4306/64 Scope:Link
          inet6 addr: fddd:a179:869c:10::1/60 Scope:Global
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:10229 errors:0 dropped:0 overruns:0 frame:0
          TX packets:8768 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:3650612 (3.4 MiB)  TX bytes:4757745 (4.5 MiB)

eth0      Link encap:Ethernet  HWaddr 14:CC:20:4C:43:06  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:2168 errors:0 dropped:11 overruns:0 frame:0
          TX packets:2085 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:814496 (795.4 KiB)  TX bytes:877584 (857.0 KiB)
          Interrupt:5 

eth1      Link encap:Ethernet  HWaddr 14:CC:20:4C:43:07  
          inet addr:131.246.228.75  Bcast:131.246.228.255  Mask:255.255.255.0
          inet6 addr: 2001:638:208:d800:16cc:20ff:fe4c:4307/64 Scope:Global
          inet6 addr: fe80::16cc:20ff:fe4c:4307/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:20496 errors:0 dropped:99 overruns:0 frame:0
          TX packets:9715 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:6489249 (6.1 MiB)  TX bytes:3730063 (3.5 MiB)
          Interrupt:4 

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:24 errors:0 dropped:0 overruns:0 frame:0
          TX packets:24 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:3971 (3.8 KiB)  TX bytes:3971 (3.8 KiB)

wlan0     Link encap:Ethernet  HWaddr 14:CC:20:4C:43:06  
          inet6 addr: fe80::16cc:20ff:fe4c:4306/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:8290 errors:0 dropped:0 overruns:0 frame:0
          TX packets:7135 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:3010151 (2.8 MiB)  TX bytes:4088675 (3.8 MiB)</code></pre></div><p>But as you can see here, the Link address of wlan0 is ...4306</p>											<p class="post-edited">(Last edited by <strong>johndoe</strong> on 22 Mar 2016, 22:01)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p316216">
				<div class="post-metadata">
					<div class="post-num">Post #28</div>
					<div class="post-author">cmsigler</div>
					<div class="post-datetime">
						23 Mar 2016, 01:12					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I think I can answer your question <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> The address fddd:a179:869c:10::1/60 is a ULA (Unique Local [Universal] Address) assigned automatically by OpenWRT.&nbsp; (OpenWRT&#039;s IPv6 support is pretty complete and standards-compliant.)&nbsp; This is the IPv6 substitute for 10.0.0.0/8, 172.16.0.0/12 and 192.168.0.0/16.&nbsp; These can be used within an organization, even a large one like an IBM-type corporation, and are designed to be unique by random assignment.&nbsp; Collision on the address space is statistically rare.</p><p>Not sure why you have to ping the global 2001: IPv6 address to make the initial traffic connection.&nbsp; Your wlan0 doesn&#039;t have a global address (I guess that&#039;s the design) and I wonder if this has anything to do with it.&nbsp; Maybe if you were connected by Ethernet cable directly to br-lan you wouldn&#039;t need to do the ping(?).&nbsp; Dunno.</p><p>Enjoy.</p><p>Clemmitt</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p316221">
				<div class="post-metadata">
					<div class="post-num">Post #29</div>
					<div class="post-author">iiradu</div>
					<div class="post-datetime">
						23 Mar 2016, 01:36					</div>
				</div>
				<div class="post-content content">
					<p>So you want to add IPv4 to router? I mean to be live?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p316225">
				<div class="post-metadata">
					<div class="post-num">Post #30</div>
					<div class="post-author">Octet</div>
					<div class="post-datetime">
						23 Mar 2016, 01:45					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>just to clarify the huge amount of IPs here:</p><div class="quotebox"><blockquote><p>inet6 addr: 2001:638:208:d800:16cc:20ff:fe4c:4307/64 Scope:Global</p></blockquote></div><p>This is your global IPv6 address. It is globally assigned to your gateway only.</p><div class="quotebox"><blockquote><p>inet6 addr: fe80::16cc:20ff:fe4c:4306/64 Scope:Link</p></blockquote></div><p>This is the link-local address. It is assigned to your link, where link means something like node. Eg all devices connected to your wifi chip are on the same link.<br />In IPv4, this was equal to something between 169.254.1.0 and 169.254.254.255 (if there was no dhcp available). It is used to self autoconfigure the network.</p><div class="quotebox"><blockquote><p>inet6 addr: fddd:a179:869c:10::1/60 Scope:Global</p></blockquote></div><p>The fc00::/7 block (ULA) is the v6 equivalent of the former 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16 ranges. However, fd00::/8 is the only defined subnet, the fc00::/8 block remains undefined until now. Even if the scope of ULAs is global, they are not inteded to be globally routed. This would actually only be achieveable with specially configured routing tables.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p316239">
				<div class="post-metadata">
					<div class="post-num">Post #31</div>
					<div class="post-author">cvmiller</div>
					<div class="post-datetime">
						23 Mar 2016, 05:12					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>johndoe wrote:</cite><blockquote><p>Hi,</p><p>@cvmiller: The final goal is to have ipv4 and ipv6 on the wifi clients and three of the LAN clients. One of the LAN clients should only be allowed to use ipv6. Will this work with your script?</p></blockquote></div><p>The script just uses ebtables to &quot;extend&quot; the universitity&#039;s provided IPv6 prefix into your LAN/WLAN network. So therefore _all_ hosts in your LAN or WLAN should receive Global IPv6 addreses (2001:...) and should be able to access the internet. You would have to put in firewall rules to prevent clients from connecting via IPv6.</p><p>I hope this helps.</p><p>PS. Be sure to adjust the values to those used by your router. For example, looking at your output, it looks like the INSIDE interface is &#039;wlan0&#039;.<br /></p><div class="codebox"><pre><code># change these to match your interfaces
INSIDE=eth0.1
OUTSIDE=eth1
BRIDGE=br-lan

# IPv6 Management address
BRIDGE_IP6=2001:470:1d:583::11

# not used for OpenWRT
# change IPv4 address to match your IPv4 networks
INSIDE_IP=192.168.11.1
OUTSIDE_IP=10.1.1.177</code></pre></div>											<p class="post-edited">(Last edited by <strong>cvmiller</strong> on 23 Mar 2016, 05:13)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p316274">
				<div class="post-metadata">
					<div class="post-num">Post #32</div>
					<div class="post-author">user772</div>
					<div class="post-datetime">
						23 Mar 2016, 12:59					</div>
				</div>
				<div class="post-content content">
					<p>I think I might have the same problem - or similar issues at least, and not quite sure how to troubleshoot this further.</p><p>I&#039;ve a Huawei E3372 (HiLink) connected to OpenWrt (Chaos Calmer), and I get an IPv6 address for the OpenWrt box from the 4G dongle. Both &quot;br-lan&quot; and &quot;eth2&quot; have globally routable IPv6 addresses, and I can ping say google with IPv6 sourcing from both interfaces.</p><p>A PC connected behind the OpenWrt box gets a globally routable IPv6 address, and has link local default gateway. If I try to traceroute with IPv6 from the PC, I don&#039;t even get to the next hop (OpenWrt) at all. This seems to be because OpenWrt doesn&#039;t know about the neighbor (the public IP of the PC doesn&#039;t show up in &quot;ip -6 neigh&quot;). </p><p>If I ping the global IPv6 address of br-lan from the PC, then the global address of the PC becomes visible in &quot;ip -6 neigh&quot; on openWrt, and a traceroute to google shows the openwrt (global) address as the first hop, but doesn&#039;t go further than that.</p><p>Then looking at a tcpdump from the eth2 interface (the CDC Ethernet interface to the Huawei), I can see that echo-request goes out from the interface and I can see the Huawei sending neighbor solicitation messages to the openwrt box asking who has the global IP of the PC. These messages seem to go unanswered, so the echo-reply is never send back to the openwrt box and therefore never gets back to the client either.</p><p>So I guess the first question is if I&#039;ve understood the way this should work correctly - the openwrt box should handle replying to the neighbor solicitation message on behalf of the client to tell the upstream &quot;router&quot; to send traffic to it? I don&#039;t think the Huawei (or the 4G provider) will support any kind of prefix delegation.</p><p>Then if the concept is correct, then the next question would be how to troubleshoot this further. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>/etc/config/dhcp has the following for the two logical interfaces:</p><p>config dhcp &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option interface &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option start &#039;100&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option limit &#039;150&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option leasetime &#039;12h&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ra_management &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ra &#039;relay&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option dhcpv6 &#039;relay&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ndp &#039;relay&#039;</p><p>config dhcp &#039;wan26&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option interface &#039;wan26&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option dhcpv6 &#039;relay&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ra &#039;relay&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ndp &#039;relay&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option master &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ignore &#039;1&#039;</p><p>&quot;wan26&quot; is a logical interface with dhcpv6 using eth2 as the transport, and &#039;lan&#039; is the normal logical interface for the bridge group.</p><p>Any pointers on what to check/try would be appreciated.... thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p316292">
				<div class="post-metadata">
					<div class="post-num">Post #33</div>
					<div class="post-author">user772</div>
					<div class="post-datetime">
						23 Mar 2016, 15:11					</div>
				</div>
				<div class="post-content content">
					<p>It looks like updating to 15.05.01 fixed part of the problem; don&#039;t need to ping the public IPv6 address or &quot;br-lan&quot; anymore to get that side of the connectivity up.</p><p>Traceroute from the client still seems to die after the openwrt box though, and seems things are still the same on the wan side - the 4G dongle sends a neighbor solicitation searching for the public IP of the client which goes unanswered.</p><p>Edit: I did notice the etables based script, but I&#039;d rather not enable bridging if it&#039;s possible to get this to work without it as there might be issues should I need to create multiple VLANs behind openwrt. From a networking perspective kind of thinking about the global IPv6 addresses as &quot;loopbacks&quot; that are used for the communication itself and the link-local addresses are used for the transport. Which kind of seems would be possible if openwrt would answer the neighbor solicitation request on behalf of the client sitting behind it.</p>											<p class="post-edited">(Last edited by <strong>user772</strong> on 23 Mar 2016, 16:24)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p316319">
				<div class="post-metadata">
					<div class="post-num">Post #34</div>
					<div class="post-author">cvmiller</div>
					<div class="post-datetime">
						23 Mar 2016, 17:32					</div>
				</div>
				<div class="post-content content">
					<p>Hi user772,</p><p>Can we see your addresses and routing table?<br />ip addr<br />ip -6 route</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p316342">
				<div class="post-metadata">
					<div class="post-num">Post #35</div>
					<div class="post-author">user772</div>
					<div class="post-datetime">
						23 Mar 2016, 19:12					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>Sure - I&#039;ll (at least try to) sanitize some of the IP addressing to protect the innocent, but here&#039;s how they look <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>ip addr<br /></p><div class="quotebox"><blockquote><p>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default<br />&nbsp; &nbsp; link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00<br />&nbsp; &nbsp; inet 127.0.0.1/8 scope host lo<br />&nbsp; &nbsp; &nbsp; &nbsp;valid_lft forever preferred_lft forever<br />&nbsp; &nbsp; inet6 ::1/128 scope host<br />&nbsp; &nbsp; &nbsp; &nbsp;valid_lft forever preferred_lft forever<br />2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000<br />&nbsp; &nbsp; link/ether 14:cc:20:ac:38:6f brd ff:ff:ff:ff:ff:ff<br />&nbsp; &nbsp; inet6 fe80::16cc:20ff:feac:386f/64 scope link<br />&nbsp; &nbsp; &nbsp; &nbsp;valid_lft forever preferred_lft forever<br />3: eth1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel master br-lan state UP group default qlen 1000<br />&nbsp; &nbsp; link/ether 14:cc:20:ac:38:6e brd ff:ff:ff:ff:ff:ff<br />5: eth2: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UNKNOWN group default qlen 1000<br />&nbsp; &nbsp; link/ether 0c:5b:8f:27:9a:64 brd ff:ff:ff:ff:ff:ff<br />&nbsp; &nbsp; inet 192.168.100.100/24 brd 192.168.100.255 scope global eth2<br />&nbsp; &nbsp; &nbsp; &nbsp;valid_lft forever preferred_lft forever<br />&nbsp; &nbsp; inet6 2001:xxxx:xxxx:xxxx:xxxx:8fff:fe27:9a64/64 scope global noprefixroute dynamic<br />&nbsp; &nbsp; &nbsp; &nbsp;valid_lft 7183sec preferred_lft 3583sec<br />&nbsp; &nbsp; inet6 fe80::zzzz:8fff:fe27:9a64/64 scope link<br />&nbsp; &nbsp; &nbsp; &nbsp;valid_lft forever preferred_lft forever<br />7: br-lan: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default<br />&nbsp; &nbsp; link/ether 14:cc:20:ac:38:6e brd ff:ff:ff:ff:ff:ff<br />&nbsp; &nbsp; inet 192.168.1.1/24 brd 192.168.1.255 scope global br-lan<br />&nbsp; &nbsp; &nbsp; &nbsp;valid_lft forever preferred_lft forever<br />&nbsp; &nbsp; inet6 2001:xxxx:xxxx:xxxx:xxxx:8fff:fe27:9a64/64 scope global noprefixroute dynamic<br />&nbsp; &nbsp; &nbsp; &nbsp;valid_lft 7183sec preferred_lft 3583sec<br />&nbsp; &nbsp; inet6 fdac:206:26dc::1/60 scope global noprefixroute<br />&nbsp; &nbsp; &nbsp; &nbsp;valid_lft forever preferred_lft forever<br />&nbsp; &nbsp; inet6 fe80::16cc:20ff:feac:386e/64 scope link<br />&nbsp; &nbsp; &nbsp; &nbsp;valid_lft forever preferred_lft forever<br />8: wlan0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq master br-lan state UP group default qlen 1000<br />&nbsp; &nbsp; link/ether 14:cc:20:ac:38:6c brd ff:ff:ff:ff:ff:ff<br />&nbsp; &nbsp; inet6 fe80::16cc:20ff:feac:386c/64 scope link<br />&nbsp; &nbsp; &nbsp; &nbsp;valid_lft forever preferred_lft forever<br />9: wlan1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq master br-lan state UP group default qlen 1000<br />&nbsp; &nbsp; link/ether 14:cc:20:ac:38:6d brd ff:ff:ff:ff:ff:ff<br />&nbsp; &nbsp; inet6 fe80::16cc:20ff:feac:386d/64 scope link<br />&nbsp; &nbsp; &nbsp; &nbsp;valid_lft forever preferred_lft forever</p></blockquote></div><p>ip -6 route</p><div class="quotebox"><blockquote><p>default from 2001:xxxx:xxxx:xxxx::/64 via fe80::b8ab:beff:fe34:0 dev eth2&nbsp; proto static&nbsp; metric 384<br />2001:xxxx:xxxx:xxxx:yyyy:d10d:e5e6:ff1c dev br-lan&nbsp; proto static&nbsp; metric 1024<br />2001:xxxx:xxxx:xxxx:zzzz:8fff:fe27:9a64 dev br-lan&nbsp; proto static&nbsp; metric 1024<br />2001:xxxx:xxxx:xxxx:wwww:3be4:f6ef:7e27 dev br-lan&nbsp; proto static&nbsp; metric 1024<br />2001:xxxx:xxxx:xxxx:kkkk:ce1a:6d0:4753 dev br-lan&nbsp; proto static&nbsp; metric 1024<br />2001:xxxx:xxxx:xxxx:mmmm:c4d9:66e5:ac26 dev br-lan&nbsp; proto static&nbsp; metric 1024<br />2001:xxxx:xxxx:xxxx:nnnn:f9bb:e3d4:44a2 dev br-lan&nbsp; proto static&nbsp; metric 1024<br />2001:xxxx:xxxx:xxxx::/64 dev eth2&nbsp; proto static&nbsp; metric 256<br />fdac:206:26dc::1 dev br-lan&nbsp; proto static&nbsp; metric 1024<br />fdac:206:26dc::/64 dev br-lan&nbsp; proto static&nbsp; metric 1024<br />unreachable fdac:206:26dc::/48 dev lo&nbsp; proto static&nbsp; metric 2147483647&nbsp; error -128<br />fe80::/64 dev eth2&nbsp; proto kernel&nbsp; metric 256<br />fe80::/64 dev br-lan&nbsp; proto kernel&nbsp; metric 256<br />fe80::/64 dev eth0&nbsp; proto kernel&nbsp; metric 256<br />fe80::/64 dev wlan1&nbsp; proto kernel&nbsp; metric 256<br />fe80::/64 dev wlan0&nbsp; proto kernel&nbsp; metric 256</p></blockquote></div><p>And here&#039;s what tcpdump -n -vv -i eth2 ip6 shows when trying to ping to the outside:</p><div class="quotebox"><blockquote><p>18:56:13.160572 IP6 (hlim 127, next-header ICMPv6 (58) payload length: 40) 2001:xxxx:xxxx:xxxx:wwww:3be4:f6ef:7e27 &gt; 2a00:1450:4001:808::2003: [icmp6 sum ok] ICMP6, echo request, seq 182<br />18:56:13.236887 IP6 (hlim 255, next-header ICMPv6 (58) payload length: 32) fe80::b8ab:beff:fe34:0 &gt; ff02::1:ffef:7e27: [icmp6 sum ok] ICMP6, neighbor solicitation, length 32, who has 2001:xxxx:xxxx:xxxx:wwww:3be4:f6ef:7e27<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; source link-address option (1), length 8 (1): ba:ab:be:34:00:00<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0000:&nbsp; baab be34 0000<br />18:56:13.237366 IP6 (hlim 255, next-header ICMPv6 (58) payload length: 32) 2001:xxxx:xxxx:xxxx:zzzz:8fff:fe27:9a64 &gt; ff02::1:ffef:7e27: [icmp6 sum ok] ICMP6, neighbor solicitation, length 32, who has 2001:xxxx:xxxx:xxxx:wwww:3be4:f6ef:7e27<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; source link-address option (1), length 8 (1): 0c:5b:8f:27:9a:64<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0000:&nbsp; 0c5b 8f27 9a64</p></blockquote></div><p>thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p316410">
				<div class="post-metadata">
					<div class="post-num">Post #36</div>
					<div class="post-author">cvmiller</div>
					<div class="post-datetime">
						24 Mar 2016, 01:21					</div>
				</div>
				<div class="post-content content">
					<p>Thanks User772.</p><p>I understand the need for privacy, but I am looking to see if the prefixes are different between your WAN interface (appears to be eth2) and your LAN interface (br-lan). You have obfuscated the prefix portion, and I can&#039;t tell.</p><p>Also there is a lot happening on the br-lan interface (again can&#039;t tell because of the obfuscation) but no networks ( I don&#039;t see a /64) on the br-lan. This is why it<strong> isn&#039;t working</strong>.</p><p>But I can&#039;t tell you why, because I can&#039;t see the prefixes. Feel free to zap out host portion of the address, but without the prefixes, it is dang hard to troubleshoot.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p316455">
				<div class="post-metadata">
					<div class="post-num">Post #37</div>
					<div class="post-author">user772</div>
					<div class="post-datetime">
						24 Mar 2016, 08:52					</div>
				</div>
				<div class="post-content content">
					<p>Sorry - I tried to obfuscate the addresses so that they would still have all the relevant information. xxxx:xxxx:xxxx:xxxx is the same on both eth2 and br-lan, so both interfaces have the same global IP address on them. The address the client has gotten (with xxxx:xxxx:xxxx:wwww) is then of course different. Figured it would be more important to see the host section so that it would be possible to see what the neighbor solicitation message was for.</p><p>Having the same global address on both interfaces does seem quite strange (at least from an IPv4 perspective), but at the same time I figured that doesn&#039;t really matter as all the routing is based on the link local (fe80) addresses. The client&#039;s default gateway is fe80::16cc:20ff:feac:386e (on br-lan) and the openwrt box has a default gateway to fe80::b8ab:beff:fe34:0.</p><p>I also tried to get rid of the HiLink USB dongle by using a ZTE MF823, but the problem I ran into there was that it didn&#039;t seem to support IPv6 when converted into a modem (so PPP wasn&#039;t able to get an IPv6 address at all). I&#039;ve not tried that as a RNDIS/tether device yet though, but guessing it&#039;ll behave similarly.</p><p>thanks for the help..</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p316503">
				<div class="post-metadata">
					<div class="post-num">Post #38</div>
					<div class="post-author">cvmiller</div>
					<div class="post-datetime">
						24 Mar 2016, 17:48					</div>
				</div>
				<div class="post-content content">
					<p>User772,</p><p>Obfuscating prefixes in IPv6 is not helpful. It is better to do string substitution. It is like I said my router is routing my wan is xxx.xxx.xx.74 and my lan is xx.xx.xx.1. How is one to troubleshoot a network?</p><p>How is it that your WAN and LAN have the same prefix? And somehow magically your client attached to the LAN has a different prefix? </p><p>Using the &#039;relay&#039; option will sort of bridge IPv6 traffic across your router (odhcpd does this), which will give you the same prefix on the wan and lan. But then your client should have the same prefix.</p><p>Although it works at layer 2 (briding), v6brouter document will explain this a bit better:<br /><a href="http://ipv6-net.blogspot.ca/2016/02/nat-tiness-and-v6brouter.html">http://ipv6-net.blogspot.ca/2016/02/nat … outer.html</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p316513">
				<div class="post-metadata">
					<div class="post-num">Post #39</div>
					<div class="post-author">user772</div>
					<div class="post-datetime">
						24 Mar 2016, 18:39					</div>
				</div>
				<div class="post-content content">
					<p>Point taken. The subnet is the same on both sides of the openwrt box, and I guess the obfuscating screwed that up. Bits 65-72 are different, which is what I tried to show by having wwww (for the host) instead of xxxx for that piece. But it&#039;s all from the same /64.</p><p>I figured the same prefix for the WAN and LAN might come from odhcpd proxying things between the two but since this is all kind of new to me, I wasn&#039;t really sure what all it does and doesn&#039;t. My hope was that it would proxy the stuff needed to get an IPv6 address for the host(s) behind it and then route using the link local addresses on each interface, while keeping track of what global addresses are where and spoofing replies to neighbor solicitation messages as needed. </p><p>So for example when the client gets an IP from the global /64 (thru relay with odhcpd), that would allow odhcpd to learn the global address assigned for the client, install a host route into the routing table for the client&#039;s global address (pointing to the client&#039;s local address) and then spoof any replies for neighbor solicitation messages searching for that IP from the WAN side.</p><p>Not sure if that makes sense. But I guess making this into a L2 bridge for IPv6 traffic would then be the way to go for now - I could look at doing something nasty with IPv6 NAT, but I don&#039;t really want to do that either. At least not until there&#039;s also IPv6 support on the wired connection too.</p><p>And again, appreciate the help. Thanks.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p316550">
				<div class="post-metadata">
					<div class="post-num">Post #40</div>
					<div class="post-author">johndoe</div>
					<div class="post-datetime">
						25 Mar 2016, 00:08					</div>
				</div>
				<div class="post-content content">
					<p>I still haven&#039;t solved the last problem. Every day I first have to ping6 my router on its global IPv6 to be able to reach other IPv6 destinations. </p><p>Before I issue a ping6 from my laptop to the router:</p><div class="codebox"><pre><code>$ ip -6 neigh
fe80::16cc:20ff:fe4c:4306 dev wlan0 lladdr 14:cc:20:4c:43:06 router REACHABLE</code></pre></div><p>After ping6 to router:<br /></p><div class="codebox"><pre><code>$ ip -6 neigh
2001:638:208:d800:16cc:20ff:fe4c:4307 dev wlan0 lladdr 14:cc:20:4c:43:06 router REACHABLE
fe80::16cc:20ff:fe4c:4306 dev wlan0 lladdr 14:cc:20:4c:43:06 router REACHABLE</code></pre></div><p>Is there any way to avoid the need to ping the router every time?</p>											<p class="post-edited">(Last edited by <strong>johndoe</strong> on 25 Mar 2016, 00:08)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p317139">
				<div class="post-metadata">
					<div class="post-num">Post #41</div>
					<div class="post-author">user772</div>
					<div class="post-datetime">
						28 Mar 2016, 19:14					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m not sure if it will help with that issue, but might be worth a try to restart odhcp with &quot;/etc/init.d/odhcpd restart&quot;.... that seemed to fix the issue I was having with not being able to connect out/thru the router at all. Guessing odhcpd needs something else to be up when it starts (interfaces possibly?), but that&#039;s just a guess..</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p317143">
				<div class="post-metadata">
					<div class="post-num">Post #42</div>
					<div class="post-author">netprince</div>
					<div class="post-datetime">
						28 Mar 2016, 19:53					</div>
				</div>
				<div class="post-content content">
					<p>I am having this problem too.&nbsp; Looks like the router isn&#039;t (stops?) responding to NDP packets for some reason.&nbsp; Have you gotten any further figuring this out?&nbsp; Do you have QOS enabled?&nbsp; </p><div class="quotebox"><cite>johndoe wrote:</cite><blockquote><p>I still haven&#039;t solved the last problem. Every day I first have to ping6 my router on its global IPv6 to be able to reach other IPv6 destinations. </p><p>Before I issue a ping6 from my laptop to the router:</p><div class="codebox"><pre><code>$ ip -6 neigh
fe80::16cc:20ff:fe4c:4306 dev wlan0 lladdr 14:cc:20:4c:43:06 router REACHABLE</code></pre></div><p>After ping6 to router:<br /></p><div class="codebox"><pre><code>$ ip -6 neigh
2001:638:208:d800:16cc:20ff:fe4c:4307 dev wlan0 lladdr 14:cc:20:4c:43:06 router REACHABLE
fe80::16cc:20ff:fe4c:4306 dev wlan0 lladdr 14:cc:20:4c:43:06 router REACHABLE</code></pre></div><p>Is there any way to avoid the need to ping the router every time?</p></blockquote></div>											<p class="post-edited">(Last edited by <strong>netprince</strong> on 28 Mar 2016, 19:53)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p317447">
				<div class="post-metadata">
					<div class="post-num">Post #43</div>
					<div class="post-author">johndoe</div>
					<div class="post-datetime">
						30 Mar 2016, 22:37					</div>
				</div>
				<div class="post-content content">
					<p>Nope, no QOS. I haven&#039;t found a solution, yet.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p352108">
				<div class="post-metadata">
					<div class="post-num">Post #44</div>
					<div class="post-author">ellisgl</div>
					<div class="post-datetime">
						16 Feb 2017, 21:20					</div>
				</div>
				<div class="post-content content">
					<p>@cmsigler Thanks for #p315621- This got my Turris Omnia up and running with AT&amp;T uVerse (3800HGV-B modem)!</p><p>Well it was working till I try to add a forwarding rule, then all heck broke lose and I had to restore the old dhcp rules.</p>											<p class="post-edited">(Last edited by <strong>ellisgl</strong> on 16 Feb 2017, 22:29)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 2 of 2</div><nav><ul><li><a href="viewtopic.php%3Fid=63448&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>