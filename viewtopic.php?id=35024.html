<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> TP-Link TL-WR1043ND Android USB tethering</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 28 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p158786">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">fisch3r</div>
					<div class="post-datetime">
						26 Feb 2012, 19:09					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I installed OpenWrt (Backfire 10.03.1-rc6) on a TP-Link TL-WR1043ND (v. 1.8) and tried to use usb tethering with my Samsung Galaxy GT-I9001 (firmware 2.3.5). I basically followed the steps here: <a href="https://forum.openwrt.org/viewtopic.php?pid=146384#p146384">https://forum.openwrt.org/viewtopic.php â€¦ 84#p146384</a><br />However the phone does not get mounted to usb0 and there are no rndis messages. Here are some outputs:</p><p>lsusb -v<br /></p><div class="codebox"><pre><code>Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass            9 Hub
  bDeviceSubClass         0 Unused
  bDeviceProtocol         1 Single TT
  bMaxPacketSize0        64
  idVendor           0x1d6b Linux Foundation
  idProduct          0x0002 2.0 root hub
  bcdDevice            2.06
  iManufacturer           3 Linux 2.6.32.27 ehci_hcd
  iProduct                2 Atheros AR91xx built-in EHCI controller
  iSerial                 1 ar71xx-ehci
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength           25
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0xe0
      Self Powered
      Remote Wakeup
    MaxPower                0mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass         9 Hub
      bInterfaceSubClass      0 Unused
      bInterfaceProtocol      0 Full speed (or root) hub
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0004  1x 4 bytes
        bInterval              12
Hub Descriptor:
  bLength               9
  bDescriptorType      41
  nNbrPorts             1
  wHubCharacteristic 0x0009
    Per-port power switching
    Per-port overcurrent protection
    TT think time 8 FS bits
  bPwrOn2PwrGood       10 * 2 milli seconds
  bHubContrCurrent      0 milli Ampere
  DeviceRemovable    0x00
  PortPwrCtrlMask    0xff
 Hub Port Status:
   Port 1: 0000.0503 highspeed power enable connect
Device Status:     0x0001
  Self Powered

Bus 001 Device 006: ID 04e8:6881 Samsung Electronics Co., Ltd 
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass            2 Communications
  bDeviceSubClass         0 
  bDeviceProtocol         0 
  bMaxPacketSize0        64
  idVendor           0x04e8 Samsung Electronics Co., Ltd
  idProduct          0x6881 
  bcdDevice            4.00
  iManufacturer           1 SAMSUNG
  iProduct                2 SAMSUNG_Android
  iSerial                 3 0123456789ABCDEF
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength           75
    bNumInterfaces          2
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0xc0
      Self Powered
    MaxPower               96mA
    Interface Association:
      bLength                 8
      bDescriptorType        11
      bFirstInterface         0
      bInterfaceCount         2
      bFunctionClass          2 Communications
      bFunctionSubClass       6 Ethernet Networking
      bFunctionProtocol       0 
      iFunction               9 RNDIS
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass         2 Communications
      bInterfaceSubClass      2 Abstract (modem)
      bInterfaceProtocol    255 Vendor Specific (MSFT RNDIS?)
      iInterface              7 RNDIS Communications Control
      CDC Header:
        bcdCDC               1.10
      CDC Call Management:
        bmCapabilities       0x00
        bDataInterface          1
      CDC ACM:
        bmCapabilities       0x00
      CDC Union:
        bMasterInterface        4
        bSlaveInterface         5 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x86  EP 6 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0008  1x 8 bytes
        bInterval               9
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           2
      bInterfaceClass        10 CDC Data
      bInterfaceSubClass      0 Unused
      bInterfaceProtocol      0 
      iInterface              8 RNDIS Ethernet Data
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x85  EP 5 IN
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x04  EP 4 OUT
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               0
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass            2 Communications
  bDeviceSubClass         0 
  bDeviceProtocol         0 
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0000
  (Bus Powered)</code></pre></div><p>dmesg | grep usb<br /></p><div class="codebox"><pre><code>Registered led device: tl-wr1043nd:green:usb
usbcore: registered new interface driver usbfs
usbcore: registered new interface driver hub
usbcore: registered new device driver usb
usb usb1: configuration #1 chosen from 1 choice
usbcore: registered new interface driver cdc_ether
usbcore: registered new interface driver rndis_host
usb 1-1: new high speed USB device using ar71xx-ehci and address 2
usb 1-1: configuration #1 chosen from 1 choice
usb 1-1: USB disconnect, address 2
usb 1-1: new high speed USB device using ar71xx-ehci and address 3
usb 1-1: configuration #1 chosen from 1 choice
usb 1-1: USB disconnect, address 3
usb 1-1: new high speed USB device using ar71xx-ehci and address 4
usb 1-1: configuration #1 chosen from 1 choice
usb 1-1: bad CDC descriptors
usb 1-1: USB disconnect, address 4
usb 1-1: new high speed USB device using ar71xx-ehci and address 5
usb 1-1: configuration #1 chosen from 1 choice
usb 1-1: USB disconnect, address 5
usb 1-1: new high speed USB device using ar71xx-ehci and address 6
usb 1-1: configuration #1 chosen from 1 choice
usb 1-1: bad CDC descriptors</code></pre></div><p>installed packages...<br /></p><div class="codebox"><pre><code>base-files - 43.29-r28680
busybox - 1.15.3-3.1
crda - 1.1.1-1
dnsmasq - 2.55-6
dropbear - 0.53.1-4
firewall - 2-34.6
hotplug2 - 1.0-beta-3
iptables - 1.4.6-3.1
iptables-mod-conntrack - 1.4.6-3.1
iptables-mod-nat - 1.4.6-3.1
iw - 0.9.22-2
kernel - 2.6.32.27-1
kmod-ath - 2.6.32.27+2011-09-14-1
kmod-ath9k - 2.6.32.27+2011-09-14-1
kmod-ath9k-common - 2.6.32.27+2011-09-14-1
kmod-button-hotplug - 2.6.32.27-1
kmod-cfg80211 - 2.6.32.27+2011-09-14-1
kmod-crc-ccitt - 2.6.32.27-1
kmod-crypto-aes - 2.6.32.27-1
kmod-crypto-arc4 - 2.6.32.27-1
kmod-crypto-core - 2.6.32.27-1
kmod-input-core - 2.6.32.27-1
kmod-input-gpio-buttons - 2.6.32.27-1
kmod-input-polldev - 2.6.32.27-1
kmod-ipt-conntrack - 2.6.32.27-1
kmod-ipt-core - 2.6.32.27-1
kmod-ipt-nat - 2.6.32.27-1
kmod-ipt-nathelper - 2.6.32.27-1
kmod-leds-gpio - 2.6.32.27-1
kmod-mac80211 - 2.6.32.27+2011-09-14-1
kmod-nls-base - 2.6.32.27-1
kmod-ppp - 2.6.32.27-1
kmod-pppoe - 2.6.32.27-1
kmod-usb-core - 2.6.32.27-1
kmod-usb-net - 2.6.32.27-1
kmod-usb-net-cdc-ether - 2.6.32.27-1
kmod-usb-net-rndis - 2.6.32.27-1
kmod-usb-ohci - 2.6.32.27-1
kmod-usb2 - 2.6.32.27-1
libc - 0.9.30.1-43.29
libgcc - 4.3.3+cs-43.29
libip4tc - 1.4.6-3.1
libiwinfo - 16
liblua - 5.1.4-7
libnl-tiny - 0.1-1
libpthread - 0.9.30.1-43.29
librt - 0.9.30.1-43.29
libuci - 12012009.6-4
libuci-lua - 12012009.6-4
libusb-1.0 - 1.0.8-1
libxtables - 1.4.6-3.1
lua - 5.1.4-7
luci - 0.10+svn7852-1
luci-app-firewall - 0.10+svn7852-1
luci-i18n-english - 0.10+svn7852-1
luci-lib-core - 0.10+svn7852-1
luci-lib-ipkg - 0.10+svn7852-1
luci-lib-lmo - 0.10+svn7852-1
luci-lib-nixio - 0.10+svn7852-1
luci-lib-sys - 0.10+svn7852-1
luci-lib-web - 0.10+svn7852-1
luci-mod-admin-core - 0.10+svn7852-1
luci-mod-admin-full - 0.10+svn7852-1
luci-proto-core - 0.10+svn7852-1
luci-proto-ppp - 0.10+svn7852-1
luci-sgi-cgi - 0.10+svn7852-1
luci-theme-base - 0.10+svn7852-1
luci-theme-openwrt - 0.10+svn7852-1
mtd - 13
opkg - 576-2
ppp - 2.4.4-16.1
ppp-mod-pppoe - 2.4.4-16.1
swconfig - 9
uci - 12012009.6-4
udev - 142-1
udevtrigger - 106-1
uhttpd - 23.3
usbutils - 003-1
wireless-tools - 29-4
wpad-mini - 20110527-1
zlib - 1.2.3-5</code></pre></div><p>Any idea what could be the problem here?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p159630">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">gidoca</div>
					<div class="post-datetime">
						4 Mar 2012, 21:31					</div>
				</div>
				<div class="post-content content">
					<p>have you installed kmod-usb-net-cdc-ether and kmod-usb-net-rndis? I believe those are needed.</p><p>EDIT: sorry, I didn&#039;t read to the bottom, my bad. In that case, I don&#039;t know.</p>											<p class="post-edited">(Last edited by <strong>gidoca</strong> on 4 Mar 2012, 21:42)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p159637">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">zorxd</div>
					<div class="post-datetime">
						4 Mar 2012, 22:12					</div>
				</div>
				<div class="post-content content">
					<p>I think there is a bug starting with Android 2.3 (it was working in Android 2.2)</p><p>the bug is this:<br /></p><div class="quotebox"><blockquote><p>usb 1-1: bad CDC descriptors</p></blockquote></div>											<p class="post-edited">(Last edited by <strong>zorxd</strong> on 4 Mar 2012, 22:13)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p162138">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">edwards</div>
					<div class="post-datetime">
						26 Mar 2012, 10:08					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>zorxd wrote:</cite><blockquote><p>I think there is a bug starting with Android 2.3 (it was working in Android 2.2)</p><p>the bug is this:<br /></p><div class="quotebox"><blockquote><p>usb 1-1: bad CDC descriptors</p></blockquote></div></blockquote></div><p>I have an wr703n and my nexus one(2.3.6) works well <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>So, I guess it&#039;s not a bug with android 2.3</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>