<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Redboot commands and Flash health</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 6 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p300742">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">pathlost</div>
					<div class="post-datetime">
						22 Nov 2015, 02:20					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>I had this old fonera 2100 with dd-wrt on it (build 9994) and I was recently playing a little with it. Final idea was to install OpenWRT, but before that I upgraded from dd-wrt 9994 to build 14929 (via web). It completed fine and i was experimenting some wireless settings until suddenly it stopped working.</p><p>Now comes the part where I need some help...<br />Redboot was still working, on static IP 192.168.1.254 port 9000. So, I tryed to recover via telnet. </p><p>a) &quot;fis list&quot; showed some partitions, but with no names.<br />b) After the first &quot;fis init&quot; that I did, the &quot;fis list&quot; does not show anything anymore! Empty! What is supposed to have in the flash after a &quot;fis init&quot; command?</p><p>c) A 2nd consequence seems to be that the Redboot configuration is gone! It has no more static IP at 192.168.1.254. I have to use a switch connected to a DHCP server to give the fonera an IP.</p><p>d) with &quot;fconfig -l&quot; I confirmed the boot script is gone. But when I try to write a new one, the router goes offline after I hit &quot;y&quot; to write to flash.</p><p>e) &quot;fis init&quot; or &quot;fis init -f&quot; do not seem to work: any command that erases or writes to flash, causes instantenous loss of connection of the putty terminal. No ping.</p><p>f) I also tried to load and create &quot;linux&quot; or &quot;rootfs&quot; + &quot;vmlinux.bin.l7&quot; (Openwrt/gargoyle/ddwrt) but they never appear after I do &quot;fis list&quot;.</p><p>The symptom is: After every failed attempt to write, erase or initialiase the flash, I lose ethernet connectivity and have to power down the fonera and try again. I give plenty of time to each operation.</p><p>My main questions are:<br />1. What is supposed to see with &quot;fis list&quot; after we issue &quot;fis init (-f)&quot; ?<br />2. Can anyone suggest any good commands on Redeboot shell to diagnose the flash? How to confirm this is an hardware failure?<br />3. Another nice idea would be to load an image and run it without storing in flash, just to check the router, but I don&#039;t know how to do that...(load command and &quot;exec&quot; or &quot;go&quot; command?)</p>											<p class="post-edited">(Last edited by <strong>pathlost</strong> on 22 Nov 2015, 02:29)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p300810">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">pathlost</div>
					<div class="post-datetime">
						22 Nov 2015, 20:06					</div>
				</div>
				<div class="post-content content">
					<p>This is interesting!<br />With the router cooled down (unpowered for some time) I could complete the fis init. I would like to be sure about the next step. I want to load openwrt or gargoyle via redboot/ tftp.</p><p>Do I need to create anything else besides the rootfs and vmlinux?</p><p>RedBoot&gt; fis list<br />Name FLASH addr Mem addr Length Entry point<br />RedBoot 0xA8000000 0xA8000000 0x00030000 0x00000000<br />FIS directory 0xA87E0000 0xA87E0000 0x0000F000 0x00000000<br />RedBoot config 0xA87EF000 0xA87EF000 0x00001000 0x00000000</p><p>Also, boot script is not configured:</p><p>RedBoot&gt; fconfig -l<br />Run script at boot: false<br />Use BOOTP for network configuration: true<br />Default server IP address: 0.0.0.0<br />Console baud rate: 9600<br />GDB connection port: 9000<br />Force console for special debug messages: false<br />Network debug at boot time: false</p><p>Any advice?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>