<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> SOLVED: Strange ssh login problem, key keeps changing</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 7 Apr 2018 and 29 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 3</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=50739&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=50739&amp;p=3.html">3</a></li></ul></nav></div>
			
		
		
			<article class="post" id="p234160">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">projects</div>
					<div class="post-datetime">
						22 May 2014, 01:47					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve built another custom of my own, nothing special, simply added bash into the programs, nothing else changed. Uploaded to the device, rebooted but now every time I try to connect, I get a new ssh key and ssh login is also very random. One minute I can log in, the next I can&#039;t. </p><p>Deleting the key on the workstation I am trying to ssh in from sometimes works, sometimes does not. </p><p>Rather confused. <br />The device is a TP-Link.</p><p>UPDATE: The problem was a device on the lan which is not releasing it&#039;s dhcp IP. When the dhcp server hands the same IP out again, there is a conflict.</p>											<p class="post-edited">(Last edited by <strong>projects</strong> on 11 Jun 2014, 23:50)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p234166">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">tmo26</div>
					<div class="post-datetime">
						22 May 2014, 02:16					</div>
				</div>
				<div class="post-content content">
					<p>Please copy &amp; paste what you get when you try to login via ssh (more than one login attempt please), so we can see what&#039;s going on.</p>											<p class="post-edited">(Last edited by <strong>tmo26</strong> on 22 May 2014, 02:18)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p234168">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">projects</div>
					<div class="post-datetime">
						22 May 2014, 02:29					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m assuming you mean the ssh key changes? <br />When I would clear the key from the /root/.ssh/known_hosts file, I could then get a prompt but it&#039;s random.<br />On one machine I log in as root, and cannot end the password, it&#039;s always wrong.<br />At the same time, I&#039;ll try another machine, then I am able to log in from that one while the other still can&#039;t.<br />The RSA key keeps changing yet I can see the device is live, it&#039;s not rebooting or anything.</p><p># ssh 192.168.2.100<br />@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@<br />@&nbsp; &nbsp; WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!&nbsp; &nbsp; &nbsp;@<br />@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@<br />IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!<br />Someone could be eavesdropping on you right now (man-in-the-middle attack)!<br />It is also possible that the RSA host key has just been changed.<br />The fingerprint for the RSA key sent by the remote host is<br />7f:e6:89:9c:04:87:95:66:71:72:c8:21:52:86:90:c3.<br />Please contact your system administrator.<br />Add correct host key in /root/.ssh/known_hosts to get rid of this message.<br />Offending key in /root/.ssh/known_hosts:1<br />RSA host key for 192.168.2.100 has changed and you have requested strict checking.<br />Host key verification failed.</p><p># scp openwrt-ar71xx-generic-tl-wr703n-v1-squashfs-sysupgrade.bin root@192.168.2.100:/tmp<br />@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@<br />@&nbsp; &nbsp; WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!&nbsp; &nbsp; &nbsp;@<br />@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@<br />IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!<br />Someone could be eavesdropping on you right now (man-in-the-middle attack)!<br />It is also possible that the RSA host key has just been changed.<br />The fingerprint for the RSA key sent by the remote host is<br />5e:7d:27:91:b4:e1:90:70:b5:1b:59:ba:31:ea:cf:80.<br />Please contact your system administrator.<br />Add correct host key in /root/.ssh/known_hosts to get rid of this message.<br />Offending key in /root/.ssh/known_hosts:1<br />RSA host key for 192.168.2.100 has changed and you have requested strict checking.<br />Host key verification failed.<br />lost connection</p><p># scp openwrt-ar71xx-generic-tl-wr703n-v1-squashfs-sysupgrade.bin root@192.168.2.100:/tmp<br />@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@<br />@&nbsp; &nbsp; WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!&nbsp; &nbsp; &nbsp;@<br />@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@<br />IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!<br />Someone could be eavesdropping on you right now (man-in-the-middle attack)!<br />It is also possible that the RSA host key has just been changed.<br />The fingerprint for the RSA key sent by the remote host is<br />5e:7d:27:91:b4:e1:90:70:b5:1b:59:ba:31:ea:cf:80.<br />Please contact your system administrator.<br />Add correct host key in /root/.ssh/known_hosts to get rid of this message.<br />Offending key in /root/.ssh/known_hosts:1<br />RSA host key for 192.168.2.100 has changed and you have requested strict checking.<br />Host key verification failed.<br />lost connection</p><p># Write failed: Broken pipe<br />root@fi128:/iso/tmp/image_builder/bin/ar71xx# ssh 192.168.2.100<br />@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@<br />@&nbsp; &nbsp; WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!&nbsp; &nbsp; &nbsp;@<br />@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@<br />IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!<br />Someone could be eavesdropping on you right now (man-in-the-middle attack)!<br />It is also possible that the RSA host key has just been changed.<br />The fingerprint for the RSA key sent by the remote host is<br />7f:e6:89:9c:04:87:95:66:71:72:c8:21:52:86:90:c3.<br />Please contact your system administrator.<br />Add correct host key in /root/.ssh/known_hosts to get rid of this message.<br />Offending key in /root/.ssh/known_hosts:1<br />RSA host key for 192.168.2.100 has changed and you have requested strict checking.<br />Host key verification failed.</p>											<p class="post-edited">(Last edited by <strong>projects</strong> on 22 May 2014, 02:30)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p234177">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">qasdfdsaq</div>
					<div class="post-datetime">
						22 May 2014, 04:14					</div>
				</div>
				<div class="post-content content">
					<p>The fact that the keys do not appear at all random but alternate between two keys that remain the same would suggest you have two different devices on the same IP address. That or somehow one device is alternating between two different configurations.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p234186">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">projects</div>
					<div class="post-datetime">
						22 May 2014, 07:19					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ll do some digging in the morning. There should not be two devices on the same IP since the devices are being booted using dhcp. </p><p>Thank you very much for the lead.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p234200">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">tmo26</div>
					<div class="post-datetime">
						22 May 2014, 11:47					</div>
				</div>
				<div class="post-content content">
					<p>Are you doing the ssh 192.168.2.100 from one machine and the scp from another, or are you doing ssh and scp from one and the same machine?</p><p>Assuming the first (2 different machines): In /root/.ssh/known_host, delete the entries for 192.168.2.100 *on both machines* and you should be ok.</p><p>Hmmm... thinking of it, it&#039;s strange that you get different fingerprints for 192.168.2.100 on different machines.</p><p>I tend to think the same as qasdfdsaq already pointed out: There are two devices on the same IP. Don&#039;t you also have a DIR-505...? Just guessing...</p><p>By the way: How did you connect your TP-Link router (which one?), via cable or via wireless?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p234276">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">projects</div>
					<div class="post-datetime">
						22 May 2014, 23:26					</div>
				</div>
				<div class="post-content content">
					<p>&gt;Are you doing the ssh 192.168.2.100 from one machine and the scp from another, <br />&gt;or are you doing ssh and scp from one and the same machine?</p><p>I might have done and scp and ssh from one machine but I also tried ssh from another one.</p><p>&gt;Assuming the first (2 different machines): In /root/.ssh/known_host, delete the entries for <br />&gt;192.168.2.100 *on both machines* and you should be ok.</p><p>Yes, I did that and sometimes the device would accept a login, the next it would not. Sometimes I might have tried 5 or 6 times from one machine, then tried from another and got in instantly. The next moment, I would have to clear the ssh key again and could not log int yet again. Very random.</p><p>&gt;Hmmm... thinking of it, it&#039;s strange that you get different fingerprints for 192.168.2.100 on <br />&gt;different machines.</p><p>I don&#039;t often use dhcp to assign ip&#039;s but in this case, it was simpler to let the device pick up it&#039;s IP which I could also confirm having been handed out from the leases.</p><p>&gt;I tend to think the same as qasdfdsaq already pointed out: There are two devices on the same IP. <br />&gt;Don&#039;t you also have a DIR-505...? Just guessing...</p><p>Sure do but that one is in limbo pending another question and is connected directly to a laptop, not the network.</p><p>&gt;By the way: How did you connect your TP-Link router (which one?), via cable or via wireless</p><p>Cable only. it&#039;s the TL-WR703N</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p234277">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">projects</div>
					<div class="post-datetime">
						22 May 2014, 23:34					</div>
				</div>
				<div class="post-content content">
					<p>So weird. I just made a new build based on some input from another thread.<br />I tried to scp it to the device only to get the ssh key error. I again deleted the key from known hosts and tried again. This time I got the password prompt but again, it won&#039;t let me in. I am only using the default &#039;admin&#039; password at the moment no less.</p><p>Tried ssh just for the heck of it and getting password prompt but again, cannot login as it is not accepting password.</p><p>root@fi128:/iso/tmp/image_builder/bin/ar71xx# scp openwrt-ar71xx-generic-tl-wr703n-v1-squashfs-sysupgrade.bin root@192.168.2.100:/tmp<br />root@192.168.2.100&#039;s password:<br />Permission denied, please try again.<br />root@192.168.2.100&#039;s password:<br />Permission denied, please try again.<br />root@192.168.2.100&#039;s password:<br />Permission denied (publickey,password).<br />lost connection<br />root@fi128:/iso/tmp/image_builder/bin/ar71xx# ssh 192.168.2.100<br />root@192.168.2.100&#039;s password:<br />Permission denied, please try again.<br />root@192.168.2.100&#039;s password:<br />Permission denied, please try again.<br />root@192.168.2.100&#039;s password:<br />Permission denied (publickey,password).</p>											<p class="post-edited">(Last edited by <strong>projects</strong> on 22 May 2014, 23:37)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p234282">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">projects</div>
					<div class="post-datetime">
						22 May 2014, 23:43					</div>
				</div>
				<div class="post-content content">
					<p>Maybe this has something to do with it?<br />When I created my last build which is running, I put a &#039;network&#039; and &#039;dhcp&#039; file into the files/etc/config directory because that seems to make the device become a dhcp client when it boots.<br />The only two options I am really wanting in both those files are</p><p>option rebind_protection &#039;0&#039; in dhcp so dhcp will pick up upstream dns servers<br />and <br />option proto &#039;dhcp&#039; in the network file so that I can specify dhcp client</p><p>Perhaps I don&#039;t even need those and instead, need to &#039;set&#039; these modes upon boot.<br />However, I have yet to learn how to set commands to run when the device is boot. <br />Even my files/etc/rc.local gets wiped out for a default rc.local when I boot my device with my new builds.<br />However, I have tested by putting a file in files/etc/config and it seems to stick.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p234283">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">projects</div>
					<div class="post-datetime">
						22 May 2014, 23:44					</div>
				</div>
				<div class="post-content content">
					<p>Here is something new that just happened.</p><p>root@fi128:/iso/tmp/image_builder/bin/ar71xx# scp openwrt-ar71xx-generic-tl-wr703n-v1-squashfs-sysupgrade.bin root@192.168.2.100:/tmp<br />root@192.168.2.100&#039;s password:<br />Permission denied, please try again.<br />root@192.168.2.100&#039;s password:<br />Read from socket failed: Connection reset by peer<br />lost connection</p><p>So I tried again and got the key error again.</p><p>root@fi128:/iso/tmp/image_builder/bin/ar71xx# scp openwrt-ar71xx-generic-tl-wr703n-v1-squashfs-sysupgrade.bin root@192.168.2.100:/tmp<br />@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@<br />@&nbsp; &nbsp; WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!&nbsp; &nbsp; &nbsp;@<br />@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@<br />IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!<br />Someone could be eavesdropping on you right now (man-in-the-middle attack)!<br />It is also possible that the RSA host key has just been changed.<br />The fingerprint for the RSA key sent by the remote host is<br />5e:7d:27:91:b4:e1:90:70:b5:1b:59:ba:31:ea:cf:80.<br />Please contact your system administrator.<br />Add correct host key in /root/.ssh/known_hosts to get rid of this message.<br />Offending key in /root/.ssh/known_hosts:1<br />RSA host key for 192.168.2.100 has changed and you have requested strict checking.<br />Host key verification failed.<br />lost connection</p><p>Then, removed the host from known hosts, tried again and this time it worked.</p><p>root@fi128:/iso/tmp/image_builder/bin/ar71xx# vi /root/.ssh/known_hosts<br />root@fi128:/iso/tmp/image_builder/bin/ar71xx# scp openwrt-ar71xx-generic-tl-wr703n-v1-squashfs-sysupgrade.bin root@192.168.2.100:/tmp<br />The authenticity of host &#039;192.168.2.100 (192.168.2.100)&#039; can&#039;t be established.<br />RSA key fingerprint is 5e:7d:27:91:b4:e1:90:70:b5:1b:59:ba:31:ea:cf:80.<br />Are you sure you want to continue connecting (yes/no)? yes<br />Warning: Permanently added &#039;192.168.2.100&#039; (RSA) to the list of known hosts.<br />root@192.168.2.100&#039;s password:<br />openwrt-ar71xx-generic-tl-wr703n-v1-squashfs-sysupgrade.bin&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 100% 2624KB&nbsp; &nbsp;1.3MB/s&nbsp; &nbsp;00:02<br />root@fi128:/iso/tmp/image_builder/bin/ar71xx#</p>											<p class="post-edited">(Last edited by <strong>projects</strong> on 22 May 2014, 23:46)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p234284">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">projects</div>
					<div class="post-datetime">
						22 May 2014, 23:48					</div>
				</div>
				<div class="post-content content">
					<p>I wrote the new build then the device rebooted yet the IP it has was still pinging even while I watched the LED. <br />You guys are right, there has to be two devices with the same name on my network. I&#039;m stumped.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p234292">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">qasdfdsaq</div>
					<div class="post-datetime">
						23 May 2014, 00:43					</div>
				</div>
				<div class="post-content content">
					<p>arp -a should tell you the MAC address of the other device, which ought to aid in identifying it.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p234298">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">projects</div>
					<div class="post-datetime">
						23 May 2014, 01:40					</div>
				</div>
				<div class="post-content content">
					<p>These commands run on the tp-link;</p><p># ifconfig eth0 | awk &#039;/HWaddr/ {print $5}&#039;<br />08:57:00:41:2E:6A</p><p># ifconfig<br />br-lan&nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 08:57:00:41:2E:6A<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:192.168.2.100&nbsp; Bcast:192.168.255.255&nbsp; Mask:255.255.0.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:25971 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:10455 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:1878650 (1.7 MiB)&nbsp; TX bytes:1153471 (1.0 MiB)</p><p>eth0&nbsp; &nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 08:57:00:41:2E:6A<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:26515 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:10525 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:2357852 (2.2 MiB)&nbsp; TX bytes:1156691 (1.1 MiB)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Interrupt:4</p><p>lo&nbsp; &nbsp; &nbsp; &nbsp; Link encap:Local Loopback<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:127.0.0.1&nbsp; Mask:255.0.0.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP LOOPBACK RUNNING&nbsp; MTU:16436&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:0 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:0 (0.0 B)&nbsp; TX bytes:0 (0.0 B)</p><p># arp -a<br />IP address&nbsp; &nbsp; &nbsp; &nbsp;HW type&nbsp; &nbsp; &nbsp;Flags&nbsp; &nbsp; &nbsp; &nbsp;HW address&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Mask&nbsp; &nbsp; &nbsp;Device<br />192.168.1.205&nbsp; &nbsp; 0x1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;00:e0:4d:9d:90:d6&nbsp; &nbsp; &nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; br-lan<br />192.168.1.29&nbsp; &nbsp; &nbsp;0x1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;00:20:94:10:44:93&nbsp; &nbsp; &nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; br-lan<br />192.168.1.1&nbsp; &nbsp; &nbsp; 0x1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;00:10:db:e1:37:8e&nbsp; &nbsp; &nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; br-lan</p><p>Looking on my firewall which is handing out dhcp IP&#039;s;</p><p>IP Address&nbsp; &nbsp; &nbsp;MAC Address&nbsp; &nbsp; &nbsp;Lease Time&nbsp; &nbsp; &nbsp;Action<br />192.168.2.100&nbsp; &nbsp; &nbsp;085700412e6a&nbsp; &nbsp; &nbsp;unlimited&nbsp; &nbsp; &nbsp;Release</p>											<p class="post-edited">(Last edited by <strong>projects</strong> on 23 May 2014, 02:14)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p234300">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">projects</div>
					<div class="post-datetime">
						23 May 2014, 02:11					</div>
				</div>
				<div class="post-content content">
					<p>Stumped. It&#039;s still acting weird.</p>											<p class="post-edited">(Last edited by <strong>projects</strong> on 23 May 2014, 02:15)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p234301">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">metai</div>
					<div class="post-datetime">
						23 May 2014, 02:25					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>projects wrote:</cite><blockquote><p>I&#039;ve built another custom of my own, nothing special, simply added bash into the programs, nothing else changed.</p></blockquote></div><p>So your TP-Link is still running dnsmasq, serving DHCP? *.100 is by default the first IP address DHCP gives out, it may thoroughly confuse another machine in your network.</p>											<p class="post-edited">(Last edited by <strong>metai</strong> on 23 May 2014, 02:25)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p234302">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">projects</div>
					<div class="post-datetime">
						23 May 2014, 02:28					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>metai wrote:</cite><blockquote><div class="quotebox"><cite>projects wrote:</cite><blockquote><p>I&#039;ve built another custom of my own, nothing special, simply added bash into the programs, nothing else changed.</p></blockquote></div><p>So your TP-Link is still running dnsmasq, serving DHCP? *.100 is by default the first IP address DHCP gives out, it may thoroughly confuse another machine in your network.</p></blockquote></div><p>I want this unit to be a dhcp client only, picking up it&#039;s ip from a local dhcp server. I don&#039;t want a dhcp server installed on this device.</p><p>Also, if you&#039;ll notice, the ip is actually 192.168.2.100, not 192.168.0.100 or 192.168.1.100.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p234304">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">metai</div>
					<div class="post-datetime">
						23 May 2014, 02:32					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>projects wrote:</cite><blockquote><p>I don&#039;t want a dhcp server installed on this device.</p></blockquote></div><p>I get that. OpenWrt comes with one running on the LAN interface by default. Is it still enabled?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p234305">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">projects</div>
					<div class="post-datetime">
						23 May 2014, 02:37					</div>
				</div>
				<div class="post-content content">
					<p>Is it process 625? I was sure I removed the dhcp server in my new builds based on input from another post.<br />Also, it would probably be handing out something other than 192.168.2.x since I&#039;ve never configured it. And, there is no lease file in /tmp</p><p>&nbsp; PID USER&nbsp; &nbsp; &nbsp; &nbsp;VSZ STAT COMMAND<br />&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp; 1504 S&nbsp; &nbsp; init<br />&nbsp; &nbsp; 2 root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 SW&nbsp; &nbsp;[kthreadd]<br />&nbsp; &nbsp; 3 root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 SW&nbsp; &nbsp;[ksoftirqd/0]<br />&nbsp; &nbsp; 4 root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 SW&nbsp; &nbsp;[kworker/0:0]<br />&nbsp; &nbsp; 5 root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 SW&nbsp; &nbsp;[kworker/u:0]<br />&nbsp; &nbsp; 6 root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 SW&lt;&nbsp; [khelper]<br />&nbsp; &nbsp; 7 root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 SW&nbsp; &nbsp;[kworker/u:1]<br />&nbsp; &nbsp;63 root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 SW&nbsp; &nbsp;[sync_supers]<br />&nbsp; &nbsp;65 root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 SW&nbsp; &nbsp;[bdi-default]<br />&nbsp; &nbsp;67 root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 SW&lt;&nbsp; [kblockd]<br />&nbsp; &nbsp;96 root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 SW&nbsp; &nbsp;[kswapd0]<br />&nbsp; 144 root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 SW&nbsp; &nbsp;[fsnotify_mark]<br />&nbsp; 173 root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 SW&lt;&nbsp; [ath79-spi]<br />&nbsp; 184 root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 SW&nbsp; &nbsp;[mtdblock0]<br />&nbsp; 189 root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 SW&nbsp; &nbsp;[mtdblock1]<br />&nbsp; 194 root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 SW&nbsp; &nbsp;[mtdblock2]<br />&nbsp; 199 root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 SW&nbsp; &nbsp;[mtdblock3]<br />&nbsp; 204 root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 SW&nbsp; &nbsp;[mtdblock4]<br />&nbsp; 209 root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 SW&nbsp; &nbsp;[mtdblock5]<br />&nbsp; 250 root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 SW&nbsp; &nbsp;[kworker/0:1]<br />&nbsp; 437 root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 SWN&nbsp; [jffs2_gcd_mtd3]<br />&nbsp; 480 root&nbsp; &nbsp; &nbsp; 1504 S&nbsp; &nbsp; init<br />&nbsp; 555 root&nbsp; &nbsp; &nbsp; 1508 S&nbsp; &nbsp; /sbin/syslogd -C16<br />&nbsp; 557 root&nbsp; &nbsp; &nbsp; 1488 S&nbsp; &nbsp; /sbin/klogd<br />&nbsp; 559 root&nbsp; &nbsp; &nbsp; &nbsp;848 S&nbsp; &nbsp; /sbin/hotplug2 --override --persistent --set-rules-file /etc/hotplug2.rules --set-coldplug-cmd /sbin/udevtrigger --max-children 1<br />&nbsp; 565 root&nbsp; &nbsp; &nbsp; &nbsp;872 S&nbsp; &nbsp; /sbin/ubusd<br />&nbsp; 582 root&nbsp; &nbsp; &nbsp; 1528 S&nbsp; &nbsp; /sbin/netifd<br />&nbsp; 625 root&nbsp; &nbsp; &nbsp; 1508 S&nbsp; &nbsp; udhcpc -p /var/run/udhcpc-br-lan.pid -s /lib/netifd/dhcp.script -f -t 0 -i br-lan -r 192.168.1.1 -C<br />&nbsp; 907 root&nbsp; &nbsp; &nbsp; 1152 S&nbsp; &nbsp; /usr/sbin/dropbear -P /var/run/dropbear.1.pid -p 22<br />&nbsp; 914 root&nbsp; &nbsp; &nbsp; 1500 S&nbsp; &nbsp; /sbin/watchdog -t 5 /dev/watchdog<br />&nbsp; 946 root&nbsp; &nbsp; &nbsp; 1504 S&nbsp; &nbsp; /usr/sbin/ntpd -n -p 0.openwrt.pool.ntp.org -p 1.openwrt.pool.ntp.org -p 2.openwrt.pool.ntp.org -p 3.openwrt.pool.ntp.org<br />&nbsp; 954 root&nbsp; &nbsp; &nbsp; 1244 S&nbsp; &nbsp; /usr/sbin/dropbear -P /var/run/dropbear.1.pid -p 22<br />&nbsp; 955 root&nbsp; &nbsp; &nbsp; 1508 S&nbsp; &nbsp; -ash<br /> 7871 root&nbsp; &nbsp; &nbsp; 1220 S&nbsp; &nbsp; /usr/sbin/dropbear -P /var/run/dropbear.1.pid -p 22<br /> 7914 root&nbsp; &nbsp; &nbsp; 1508 S&nbsp; &nbsp; -ash<br />15118 root&nbsp; &nbsp; &nbsp; 1488 S&nbsp; &nbsp; sleep 1<br />15119 root&nbsp; &nbsp; &nbsp; 1496 R&nbsp; &nbsp; ps</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p234306">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">tmo26</div>
					<div class="post-datetime">
						23 May 2014, 02:38					</div>
				</div>
				<div class="post-content content">
					<p>Post the output of</p><div class="codebox"><pre><code>uci show dhcp
uci show network</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p234307">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">projects</div>
					<div class="post-datetime">
						23 May 2014, 02:38					</div>
				</div>
				<div class="post-content content">
					<p>Not to mention, it was working fine up until this started yesterday but I&#039;m not sure what changed.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p234308">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">qasdfdsaq</div>
					<div class="post-datetime">
						23 May 2014, 02:40					</div>
				</div>
				<div class="post-content content">
					<p>Looks like it is, yes.</p><p>Also you have to run the arp -a command on a different machine (e.g. the one you are SSH&#039;ing <em>from</em>) while the TP-Link is off/disconnected, and you are pinging it&#039;s IP. Obviously it&#039;ll only do something useful if the other device is active and responding.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p234310">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">projects</div>
					<div class="post-datetime">
						23 May 2014, 02:40					</div>
				</div>
				<div class="post-content content">
					<p># uci show dhcp<br />dhcp.@dnsmasq[0]=dnsmasq<br />dhcp.@dnsmasq[0].domainneeded=1<br />dhcp.@dnsmasq[0].boguspriv=1<br />dhcp.@dnsmasq[0].filterwin2k=0<br />dhcp.@dnsmasq[0].localise_queries=1<br />dhcp.@dnsmasq[0].rebind_protection=0<br />dhcp.@dnsmasq[0].rebind_localhost=1<br />dhcp.@dnsmasq[0].local=/lan/<br />dhcp.@dnsmasq[0].domain=lan<br />dhcp.@dnsmasq[0].expandhosts=1<br />dhcp.@dnsmasq[0].nonegcache=0<br />dhcp.@dnsmasq[0].authoritative=1<br />dhcp.@dnsmasq[0].readethers=1<br />dhcp.@dnsmasq[0].leasefile=/tmp/dhcp.leases<br />dhcp.@dnsmasq[0].resolvfile=/tmp/resolv.conf.auto<br />dhcp.lan=dhcp<br />dhcp.lan.interface=lan<br />dhcp.lan.start=100<br />dhcp.lan.limit=150<br />dhcp.lan.leasetime=12h<br />dhcp.lan.dhcpv6=hybrid<br />dhcp.lan.ra=hybrid<br />dhcp.lan.ndp=hybrid<br />dhcp.wan=dhcp<br />dhcp.wan.interface=wan<br />dhcp.wan.ignore=1<br />dhcp.odhcpd=odhcpd<br />dhcp.odhcpd.maindhcp=0<br />dhcp.odhcpd.leasefile=/tmp/hosts/odhcpd<br />dhcp.odhcpd.leasetrigger=/usr/sbin/odhcpd-update<br />dhcp.wan6=dhcp<br />dhcp.wan6.dhcpv6=hybrid<br />dhcp.wan6.ra=hybrid<br />dhcp.wan6.ndp=hybrid<br />dhcp.wan6.master=1</p><p># uci show network<br />network.loopback=interface<br />network.loopback.ifname=lo<br />network.loopback.proto=static<br />network.loopback.ipaddr=127.0.0.1<br />network.loopback.netmask=255.0.0.0<br />network.globals=globals<br />network.globals.ula_prefix=fd5f:467e:351c::/48<br />network.lan=interface<br />network.lan.ifname=eth0<br />network.lan.type=bridge<br />network.lan.ipaddr=192.168.1.1<br />network.lan.netmask=255.255.255.0<br />network.lan.ip6assign=60<br />network.lan.proto=dhcp</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p234311">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">tmo26</div>
					<div class="post-datetime">
						23 May 2014, 02:42					</div>
				</div>
				<div class="post-content content">
					<p>What&#039;s the IP of your main router, which should serve dhcp to your tp-link?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p234313">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">projects</div>
					<div class="post-datetime">
						23 May 2014, 02:43					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>qasdfdsaq wrote:</cite><blockquote><p>Looks like it is, yes.</p><p>Also you have to run the arp -a command on a different machine (e.g. the one you are SSH&#039;ing <em>from</em>) while the TP-Link is off/disconnected, and you are pinging it&#039;s IP. Obviously it&#039;ll only do something useful if the other device is active and responding.</p></blockquote></div><p>I didn&#039;t run arp from another machine but I did install a new build on the tp-link and while it was rebooting, I could still ping it&#039;s IP. That&#039;s why I said it&#039;s strange then, you guys were right, there&#039;s something else on that IP.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p234314">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">projects</div>
					<div class="post-datetime">
						23 May 2014, 02:44					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>tmo26 wrote:</cite><blockquote><p>What&#039;s the IP of your main router, which should serve dhcp to your tp-link?</p></blockquote></div><p>192.168.1.1</p>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 1 of 3</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=50739&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=50739&amp;p=3.html">3</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>