<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Build problem: zlib.h: No such file or directory</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 20 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p35156">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Yossarian</div>
					<div class="post-datetime">
						10 Oct 2006, 08:37					</div>
				</div>
				<div class="post-content content">
					<p>I installed Debian 3.1 just so that I could build OpenWrt. I ran svn to get the code and ran make menuconfig (not changing anything) then ran make. It crunched for a long time then died with this error:</p><p>[output snipped]<br />make -C lzma prepare<br />make[2]: Entering directory `/root/openwrt/whiterussian/openwrt/target/lzma&#039;<br />/root/openwrt/whiterussian/openwrt/scripts/download.pl /root/openwrt/whiterussian/openwrt/dl lzma406.zip a09378411cba5f786b5c49c9c58496df <a href="http://www.7-zip.org/dl">http://www.7-zip.org/dl</a><br />--01:24:33--&nbsp; <a href="http://www.7-zip.org/dl/lzma406.zip">http://www.7-zip.org/dl/lzma406.zip</a><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&gt; `-&#039;<br />Resolving <a href="http://www.7-zip.org">www.7-zip.org</a>... 69.73.175.23<br />Connecting to <a href="http://www.7-zip.org">www.7-zip.org</a>[69.73.175.23]:80... connected.<br />HTTP request sent, awaiting response... 200 OK<br />Length: 185,934 [application/zip]</p><p>100%[================================================================================================&gt;] 185,934&nbsp; &nbsp; &nbsp; &nbsp;--.--K/s</p><p>01:24:33 (9.81 MB/s) - `-&#039; saved [185934/185934]</p><p>unzip -q /root/openwrt/whiterussian/openwrt/dl/lzma406.zip -d /root/openwrt/whiterussian/openwrt/build_mipsel/lzma<br />patch -d /root/openwrt/whiterussian/openwrt/build_mipsel/lzma -p1 &lt; lzma-406-zlib-stream.patch<br />patching file SRC/7zip/Compress/LZMA/LZMADecoder.cpp<br />patching file SRC/7zip/Compress/LZMA/LZMADecoder.h<br />patching file SRC/7zip/Compress/LZMA_Lib/makefile<br />patching file SRC/7zip/Compress/LZMA_Lib/ZLib.cpp<br />touch /root/openwrt/whiterussian/openwrt/build_mipsel/lzma/.unpacked<br />make[2]: Leaving directory `/root/openwrt/whiterussian/openwrt/target/lzma&#039;<br />make -C lzma compile<br />make[2]: Entering directory `/root/openwrt/whiterussian/openwrt/target/lzma&#039;<br />make -C /root/openwrt/whiterussian/openwrt/build_mipsel/lzma/SRC/7zip/Compress/LZMA_Lib<br />make[3]: Entering directory `/root/openwrt/whiterussian/openwrt/build_mipsel/lzma/SRC/7zip/Compress/LZMA_Lib&#039;<br />g++ -O3 -Wall -c ZLib.cpp<br />ZLib.cpp:28:18: zlib.h: No such file or directory<br />ZLib.cpp:53: error: parse error before `*&#039; token<br />ZLib.cpp:54: error: missing &#039;;&#039; before right brace<br />ZLib.cpp:56: error: ISO C++ forbids defining types within return type<br />ZLib.cpp:56: error: destructors must be member functions<br />ZLib.cpp:56: error: return type specification for destructor invalid<br />ZLib.cpp:56: error: virtual outside class declaration<br />ZLib.cpp:58: error: virtual outside class declaration<br />ZLib.cpp: In function `LONG QueryInterface(const GUID&amp;, void**)&#039;:<br />ZLib.cpp:58: error: invalid use of `this&#039; in non-member function<br />ZLib.cpp:58: error: `AddRef&#039; undeclared (first use this function)<br />ZLib.cpp:58: error: (Each undeclared identifier is reported only once for each<br />&nbsp; &nbsp;function it appears in.)<br />ZLib.cpp:58: error: invalid use of `this&#039; in non-member function<br />ZLib.cpp: At global scope:<br />ZLib.cpp:58: error: virtual outside class declaration<br />ZLib.cpp: In function `ULONG AddRef()&#039;:<br />ZLib.cpp:58: error: `ULONG AddRef()&#039; used prior to declaration<br />ZLib.cpp:58: error: `__m_RefCount&#039; undeclared (first use this function)<br />ZLib.cpp: At global scope:<br />ZLib.cpp:58: error: virtual outside class declaration<br />ZLib.cpp: In function `ULONG Release()&#039;:<br />ZLib.cpp:58: error: invalid use of `this&#039; in non-member function<br />ZLib.cpp: At global scope:<br />ZLib.cpp:61: error: virtual outside class declaration<br />ZLib.cpp: In function `LONG Read(void*, unsigned int, UInt32*)&#039;:<br />ZLib.cpp:62: error: `m_size&#039; undeclared (first use this function)<br />ZLib.cpp:62: error: `m_offset&#039; undeclared (first use this function)<br />ZLib.cpp:66: error: `m_data&#039; undeclared (first use this function)<br />ZLib.cpp: At global scope:<br />ZLib.cpp:78: error: virtual outside class declaration<br />ZLib.cpp:83: error: virtual outside class declaration<br />ZLib.cpp:103: error: virtual outside class declaration<br />ZLib.cpp:107: error: parse error before `protected&#039;<br />ZLib.cpp:109: error: `UInt64 m_size&#039; used prior to declaration<br />ZLib.cpp:110: error: `UInt64 m_offset&#039; used prior to declaration<br />ZLib.cpp:111: error: parse error before `}&#039; token<br />ZLib.cpp:118: error: parse error before `*&#039; token<br />ZLib.cpp:119: error: missing &#039;;&#039; before right brace<br />ZLib.cpp:120: error: ISO C++ forbids defining types within return type<br />ZLib.cpp:120: error: destructors must be member functions<br />ZLib.cpp:120: error: return type specification for destructor invalid<br />ZLib.cpp:120: error: virtual outside class declaration<br />ZLib.cpp:122: error: virtual outside class declaration<br />ZLib.cpp: In function `LONG QueryInterface(const GUID&amp;, void**)&#039;:<br />ZLib.cpp:122: error: redefinition of `LONG QueryInterface(const GUID&amp;, void**)&#039;<br />ZLib.cpp:58: error: `LONG QueryInterface(const GUID&amp;, void**)&#039; previously<br />&nbsp; &nbsp;defined here<br />ZLib.cpp:122: error: redefinition of `LONG QueryInterface(const GUID&amp;, void**)&#039;<br />ZLib.cpp:58: error: `LONG QueryInterface(const GUID&amp;, void**)&#039; previously<br />&nbsp; &nbsp;defined here<br />ZLib.cpp:122: error: invalid use of `this&#039; in non-member function<br />ZLib.cpp: At global scope:<br />ZLib.cpp:122: error: virtual outside class declaration<br />ZLib.cpp: In function `ULONG AddRef()&#039;:<br />ZLib.cpp:122: error: redefinition of `ULONG AddRef()&#039;<br />ZLib.cpp:58: error: `ULONG AddRef()&#039; previously defined here<br />ZLib.cpp:122: error: redefinition of `ULONG AddRef()&#039;<br />ZLib.cpp:58: error: `ULONG AddRef()&#039; previously defined here<br />ZLib.cpp: At global scope:<br />ZLib.cpp:122: error: virtual outside class declaration<br />ZLib.cpp: In function `ULONG Release()&#039;:<br />ZLib.cpp:122: error: redefinition of `ULONG Release()&#039;<br />ZLib.cpp:58: error: `ULONG Release()&#039; previously defined here<br />ZLib.cpp:122: error: redefinition of `ULONG Release()&#039;<br />ZLib.cpp:58: error: `ULONG Release()&#039; previously defined here<br />ZLib.cpp:122: error: invalid use of `this&#039; in non-member function<br />ZLib.cpp: At global scope:<br />ZLib.cpp:125: error: virtual outside class declaration<br />ZLib.cpp: In function `LONG Write(const void*, unsigned int, UInt32*)&#039;:<br />ZLib.cpp:126: error: `m_maxsize&#039; undeclared (first use this function)<br />ZLib.cpp: At global scope:<br />ZLib.cpp:145: error: virtual outside class declaration<br />ZLib.cpp:150: error: virtual outside class declaration<br />ZLib.cpp: In function `LONG Seek(long long int, unsigned int, UInt64*)&#039;:<br />ZLib.cpp:150: error: redefinition of `LONG Seek(long long int, unsigned int,<br />&nbsp; &nbsp;UInt64*)&#039;<br />ZLib.cpp:83: error: `LONG Seek(long long int, unsigned int, UInt64*)&#039;<br />&nbsp; &nbsp;previously defined here<br />ZLib.cpp:150: error: redefinition of `LONG Seek(long long int, unsigned int,<br />&nbsp; &nbsp;UInt64*)&#039;<br />ZLib.cpp:83: error: `LONG Seek(long long int, unsigned int, UInt64*)&#039;<br />&nbsp; &nbsp;previously defined here<br />ZLib.cpp: At global scope:<br />ZLib.cpp:170: error: virtual outside class declaration<br />ZLib.cpp:176: error: parse error before `protected&#039;<br />ZLib.cpp:178: error: redefinition of `UInt64 m_size&#039;<br />ZLib.cpp:109: error: `UInt64 m_size&#039; previously declared here<br />ZLib.cpp:179: error: `UInt64 m_maxsize&#039; used prior to declaration<br />ZLib.cpp:180: error: redefinition of `UInt64 m_offset&#039;<br />ZLib.cpp:110: error: `UInt64 m_offset&#039; previously declared here<br />ZLib.cpp:181: error: parse error before `}&#039; token<br />ZLib.cpp:183: error: syntax error before `int&#039;<br />ZLib.cpp:188: error: `inStreamSpec&#039; was not declared in this scope<br />ZLib.cpp:190: error: syntax error before `*&#039; token<br />ZLib.cpp:191: error: `outStreamSpec&#039; was not declared in this scope<br />ZLib.cpp:211: error: parse error before `for&#039;<br />ZLib.cpp:211: error: parse error before `;&#039; token<br />ZLib.cpp:211: error: syntax error before `++&#039; token<br />ZLib.cpp:213: error: syntax error before `.&#039; token<br />ZLib.cpp:214: error: syntax error before `.&#039; token<br />ZLib.cpp:215: error: syntax error before `.&#039; token<br />ZLib.cpp:216: error: syntax error before `.&#039; token<br />ZLib.cpp:217: error: syntax error before `.&#039; token<br />ZLib.cpp:218: error: syntax error before `.&#039; token<br />ZLib.cpp:220: error: syntax error before `.&#039; token<br />ZLib.cpp:221: error: syntax error before `.&#039; token<br />ZLib.cpp:223: error: syntax error before `.&#039; token<br />ZLib.cpp:224: error: syntax error before `.&#039; token<br />ZLib.cpp:230: error: parse error before `if&#039;<br />ZLib.cpp:240: error: syntax error before `-&gt;&#039; token<br />ZLib.cpp:241: error: ISO C++ forbids declaration of `destLen&#039; with no type<br />ZLib.cpp:241: error: invalid conversion from `UInt64&#039; to `int*&#039;<br />ZLib.cpp:243: error: parse error before `return&#039;<br />ZLib.cpp:246: error: syntax error before `int&#039;<br />ZLib.cpp:250: error: redefinition of `CMyComPtr&lt;ISequentialInStream&gt; inStream&#039;<br />ZLib.cpp:188: error: `CMyComPtr&lt;ISequentialInStream&gt; inStream&#039; previously<br />&nbsp; &nbsp;declared here<br />ZLib.cpp:250: error: `inStreamSpec&#039; was not declared in this scope<br />ZLib.cpp:252: error: syntax error before `*&#039; token<br />ZLib.cpp:253: error: redefinition of `CMyComPtr&lt;ISequentialOutStream&gt; outStream<br />&nbsp; &nbsp;&#039;<br />ZLib.cpp:191: error: `CMyComPtr&lt;ISequentialOutStream&gt; outStream&#039; previously<br />&nbsp; &nbsp;declared here<br />ZLib.cpp:253: error: `outStreamSpec&#039; was not declared in this scope<br />ZLib.cpp:259: error: parse error before `if&#039;<br />ZLib.cpp:262: error: redefinition of `UInt64 fileSize&#039;<br />ZLib.cpp:239: error: `UInt64 fileSize&#039; previously declared here<br />ZLib.cpp:264: error: parse error before `if&#039;<br />ZLib.cpp:269: error: syntax error before `-&gt;&#039; token<br />ZLib.cpp:270: error: ISO C++ forbids declaration of `destLen&#039; with no type<br />ZLib.cpp:270: error: redefinition of `int*destLen&#039;<br />ZLib.cpp:241: error: `int*destLen&#039; previously declared here<br />ZLib.cpp:270: error: invalid conversion from `UInt64&#039; to `int*&#039;<br />ZLib.cpp:272: error: parse error before `return&#039;<br />make[3]: *** [ZLib.o] Error 1<br />make[3]: Leaving directory `/root/openwrt/whiterussian/openwrt/build_mipsel/lzma/SRC/7zip/Compress/LZMA_Lib&#039;<br />make[2]: *** [/root/openwrt/whiterussian/openwrt/build_mipsel/lzma/SRC/7zip/Compress/LZMA_Lib/liblzma.a] Error 2<br />make[2]: Leaving directory `/root/openwrt/whiterussian/openwrt/target/lzma&#039;<br />make[1]: *** [lzma-compile] Error 2<br />make[1]: Leaving directory `/root/openwrt/whiterussian/openwrt/target&#039;<br />make: *** [target/compile] Error 2</p><br /><br /><br /><p>Clearly, zlib.h is not really missing, so I assume that I have missed something obvious. Any ideas?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p35252">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">PS3</div>
					<div class="post-datetime">
						11 Oct 2006, 19:03					</div>
				</div>
				<div class="post-content content">
					<p>I had the same problem. <br />Compiling on the pre-packaged Fedora-fc5-i386, running under VMWare Player.<br />Since this is not really meant as a development installation, I had to install a lot of extra software.<br />Fortunately, this is easy with the yum command line tool.<br />The problem with zlib.h disappeared after I installed zlib-devel.i386 with this command:<br /></p><div class="codebox"><pre><code>yum install zlib-devel.i386</code></pre></div><p>Next problem that I am facing is compile error in iptables:<br /></p><div class="codebox"><pre><code>/openwrt/whiterussian/openwrt/staging_dir_mipsel/bin/mipsel-linux-uclibc-gcc -Os -pipe -mips32 -mtune=mips32 -funit-at-a-time  -Wall -Wunused -I/openwrt/whiterussian/openwrt/build_mipsel/linux/include -Iinclude/ -DIPTABLES_VERSION=\&quot;1.3.3\&quot;  -fPIC -o extensions/libipt_string_sh.o -c extensions/libipt_string.c
extensions/libipt_string.c: In function `parse_string&#039;:
extensions/libipt_string.c:50: error: `BM_MAX_NLEN&#039; undeclared (first use in this function)
extensions/libipt_string.c:50: error: (Each undeclared identifier is reported only once
extensions/libipt_string.c:50: error: for each function it appears in.)
extensions/libipt_string.c:50: error: structure has no member named `string&#039;
extensions/libipt_string.c: In function `parse_hex_string&#039;:
extensions/libipt_string.c:95: error: structure has no member named `string&#039;
extensions/libipt_string.c:117: error: structure has no member named `string&#039;
extensions/libipt_string.c:123: error: structure has no member named `string&#039;
extensions/libipt_string.c:126: error: `BM_MAX_NLEN&#039; undeclared (first use in this function)
extensions/libipt_string.c:130: error: structure has no member named `len&#039;
extensions/libipt_string.c: In function `parse&#039;:
extensions/libipt_string.c:154: error: structure has no member named `len&#039;
extensions/libipt_string.c:154: error: structure has no member named `string&#039;
extensions/libipt_string.c: In function `print&#039;:
extensions/libipt_string.c:240: error: structure has no member named `string&#039;
extensions/libipt_string.c:240: error: structure has no member named `len&#039;
extensions/libipt_string.c:242: error: structure has no member named `string&#039;
extensions/libipt_string.c:242: error: structure has no member named `len&#039;
extensions/libipt_string.c:245: error: structure has no member named `string&#039;
extensions/libipt_string.c:245: error: structure has no member named `len&#039;
extensions/libipt_string.c: In function `save&#039;:
extensions/libipt_string.c:257: error: structure has no member named `string&#039;
extensions/libipt_string.c:257: error: structure has no member named `len&#039;
extensions/libipt_string.c:259: error: structure has no member named `string&#039;
extensions/libipt_string.c:259: error: structure has no member named `len&#039;
extensions/libipt_string.c:262: error: structure has no member named `string&#039;
extensions/libipt_string.c:262: error: structure has no member named `len&#039;
make[3]: *** [extensions/libipt_string_sh.o] Error 1
make[3]: Leaving directory `/openwrt/whiterussian/openwrt/build_mipsel/iptables-1.3.3&#039;
make[2]: *** [/openwrt/whiterussian/openwrt/build_mipsel/iptables-1.3.3/.built] Error 2
make[2]: Leaving directory `/openwrt/whiterussian/openwrt/package/iptables&#039;
make[1]: *** [iptables-compile] Error 2
make[1]: Leaving directory `/openwrt/whiterussian/openwrt/package&#039;
make: *** [package/compile] Error 2</code></pre></div><p>I have found out that the compile problem might go away by using iptables-1.3.3-20051023 as is told over <a href="http://lists.netfilter.org/pipermail/netfilter/2005-October/063400.html">here</a>.<br />Unfortunately, the patching files of the openwrt build do not accept this other version (the differences are really big), so this is not a real solution.<br />I am looking for a version of the file ipt_string.h that will cooperate with the openwrt version of libipt_string.c,</p><p>So far, I am stuck. Any help would be appreciated.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p35268">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Yossarian</div>
					<div class="post-datetime">
						11 Oct 2006, 23:45					</div>
				</div>
				<div class="post-content content">
					<p>Thanks! On Debian, the correct incantation was &quot;apt-get install zlib1g-dev&quot;.</p><p>I did not run into the problem you describe, but I&#039;m using Debian instead of FC5. Actually, I&#039;m running Debian inside VMware on top of FC5, because I&#039;m a longtime RedHat user but they say that Debian is the preferred development platform for OpenWrt. VMware Server is free (gratis) and you only need about 3 gigs of disk space to install Debian inside VMware.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>