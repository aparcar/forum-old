<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> sam&#039;s firmware collections for TP-Link WR703N</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 6 Feb 2018 and 1 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 12</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=33387&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=33387&amp;p=3.html">3</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=33387&amp;p=12.html">12</a></li></ul></nav></div>
			
		
		
			<article class="post" id="p150595">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">s7mx1</div>
					<div class="post-datetime">
						7 Dec 2011, 23:15					</div>
				</div>
				<div class="post-content content">
					<h5><span class="bbu">Admin note: the user provided firmwares in this thread are reported to <strong>brick</strong> recent TP-Link WR703N hardware revisions! The images are unmaintained and unofficial, it is not advised to use them.</span></h5><br /><br /><br /><br /><br /><p>Just like it&#039;s 11N big brothers WR703N contains a 400MHz CPU, 32MB memory, 4MB flash storage and what&#039;s more is one usb 2.0 port. This makes it perfect for a few exciting projects due to its extreme low power consumption and miniature size.</p><p>More hardware information can be found on the wiki page and forum discussion. I will list couple of projects around WR703N which I have been working on. Hopefully someone will find them useful.</p><p>I created these firmwares with those criteria in mind: <br /><strong>high performance</strong><br /><strong>low maintenance</strong><br /><strong>minimal user action</strong></p><p>Changes since 1229, aka <strong>The Big Squeeze</strong><br />* More file system (including cd/dvd-rom) support in nas firmware<br />* replaced user space nfs server by kernel one to save memory in nas firmware<br />* mobile phone usb tethering support<br />* usb printer support<br />* firewall improvement<br />* multi wan (uplinks) support<br />* Easy switch Network profile<br />* Improved web GUI<br />* Disabled wifi client due to security concerns.<br />* Shortened hostname<br />* AP on by default as a management interface. <br />* Unique AP SSID so we can have multiple devices running at the same time<br />* Squeezed it really hard so I can put more stuff in<br />* Make the AP key same for both nas and pulseaudio firmware<br />* Added a status page for pulseaudio so you can get essential information like sample rate like a breeze<br />* Added nfs client support for pulseaudio firmware. It&#039;s now possible to mount remote nfs share<br />* Updated the format page on nas firmware. It should work much better with huge hard disk.</p><br /><br /><p>Firmware List</p><p><strong><a href="https://forum.openwrt.org/viewtopic.php?pid=150596#p150596">NAS (network attached storage)</a></strong><br />Key Features:<br /><strong>*</strong> High throughput 9-10MB/s read and write FTP<br /><strong>*</strong> NFS server (kernel mode) support with 9MB/s read and 6.5MB/s write throughput.<br /><strong>*</strong> FTP, NFS and Wifi AP works out of box with internet sharing<br /><strong>*</strong> OpenVPN server/client with lzo support.<br /><strong>*</strong> Easy to use web page to format disk with a single click<br /><strong>*</strong> Excellent file system support including ext2/3, (v)fat, ntfs<br /><strong>*</strong> CD/DVD-ROM with ISO9660, Joliet and UDF disk support<br /><strong>*</strong> usb printer support<br /><strong>*</strong> support mounting iso images via loop module<br /><strong>*</strong> multiple wan/uplinks and usb tethering support for mobile phone<br /><strong>*</strong> Intuitive web gui for switching between 3 most used network profile without the risk of &#039;bricking&#039; the router by mistake.</p><br /><p><strong><a href="https://forum.openwrt.org/viewtopic.php?pid=150597#p150597">PulseAudio (audio streaming much like airplay)</a></strong><br />Key Features:<br /><strong>*</strong> Universal usb 1.0/1.1/2.0 sound card/speakers support<br /><strong>*</strong> Plug and Play. Sound card/Speakers can be added/removed whenever you want<br /><strong>*</strong> Default sample rate set to 44.1Khz if the sound card/speakers supports it so you can have the best music playback possible<br /><strong>*</strong> Physical volume buttons (up/down/mute) control playback volume<br /><strong>*</strong> WebOS support (tested on TouchPad)<br /><strong>*</strong> Very low delay and smooth playback with good wifi network<br /><strong>*</strong> All-in-one pulseaudio status page covering sinks, sink inputs, clients and logs<br /><strong>*</strong> usb printer support<br /><strong>*</strong> multiple wan/uplinks and usb tethering support for mobile phone<br /><strong>*</strong> Intuitive web gui for switching between 3 most used network profile without the risk of &#039;bricking&#039; the router by mistake.<br /><strong>*</strong> NFS client support<br /><strong>*</strong> PREEMPT kernel geared for audio playback</p>											<p class="post-edited">(Last edited by <strong>jow</strong> on 10 Jan 2013, 16:37)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150596">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">s7mx1</div>
					<div class="post-datetime">
						7 Dec 2011, 23:16					</div>
				</div>
				<div class="post-content content">
					<p><strong>NAS firmware</strong></p><p>This is a firmware for those who want to share out their usb hard drive over local network. Setting up a NAS like a pro has never been easier thanks to configuration-free ftp, nfs. Pre-configured WiFi HotSpot (AP) allows any wifi devices/clients to access files on the usb disk instantly and better still those wifi devices/clients will be able to surf the internet or access resources on the local home network at the same time. This is all done without any messing around configuration files on WR703N, no file to edit, no commend line to type. </p><p>Ever dreaming of access files out and about? No problem. OpenVPN server/client with lzo compression support is build in. Due to security reasons I dare not to pre-configure openvpn for you. Please head to openwrt&#039;s excellent wiki for setting up openvpn.</p><p>This firmware requires minimal configuration but do read through the rest of this post before try it out!!!!</p><p><strong>Requirements:</strong><br />* A router that has dhcp support that is connected to your home local network (Any out of shelf router bought recently should do)<br />* Ethernet cable with one end connected to the lan port of the above router and the other end connected to the lan port of WR703N<br />* usb 2.0 hard disk (formatted as a single ext3 partition preferable but not necessary)<br />* 5V usb power adapter. You will need a power adapter with sufficient current to power your hard disk. Personally I am using one 5V 1.0A power adapter and usb hard drive works fine.</p><p><strong>Flash the firmware:</strong><br />Get version 28854-1229 (aka <strong>The big Squeeze</strong>) firmware from here <a href="http://xbox-remote.googlecode.com/files/openwrt-nas-28854-1229-tl-wr703n-v1-squashfs-factory.bin">http://xbox-remote.googlecode.com/files … actory.bin</a><br />Flash it with the usual way either with web upgrade if you are using original firmware or mtd command if you are using openwrt.</p><p><strong>First Boot:</strong><br />The first time you boot WR703N after you flashed the firmware please make sure the usb hard disk is disconnected from WR703N till the router is initialised, i.e. steady blue LED. After you have steady blue LED open the following address <a href="http://nas/">http://nas/</a> using your web browser. You should see a system information page. If everything goes all right you can then plug in your usb hard disk. If your hard disk is formatted as a single ext3 partition then you don&#039;t need to do anything otherwise please head to the &quot;How to format usb disk&quot; section.</p><p><strong>Configure network/wifi client the easy way</strong><br />See my post <a href="https://forum.openwrt.org/viewtopic.php?pid=150598#p150598">here</a> for details on how to switch between 3 predefined network profile and among other things like enable wifi client. </p><p><strong>How to format usb disk:</strong><br />Make sure you have copied out all files from your usb hard disk as this process will destroy any existing partition and file system on your usb hard disk. This process cannot be undone. </p><p>Open the following link <a href="http://nas/cgi-bin/webif/power-format.sh">http://nas/cgi-bin/webif/power-format.sh</a> from your web browser and following the instruction. When all done it will automatically reboot WR703N. The time it takes for the format process varies. It takes less than 1 minute to format a slow usb 2.0 memory stick.</p><p><strong>How to access files within local network </strong><br />After the router is initialised, i.e. steady blue LED, with usb hard disk connected, you can access files on the usb hard disk using any ftp client pointing to ftp://nas/ with <br /></p><div class="codebox"><pre><code>username:   root
password:    root</code></pre></div><p>If your hard disk have multiple partitions they will be automatically mounted on folder <strong>disk-xy</strong> where &quot;x&quot; will be letters staring from <strong>a</strong> and &quot;y&quot; will be the number of that partition. For example to access the 2nd partition you can just navigate into folder <strong>disk-a2</strong>. </p><p>CD/DVD-ROM will be mounted on folder <strong>cdrom-y</strong> where &quot;y&quot; will be the number of that cd/dvd-rom starts from &quot;0&quot;. For example, the first cd/dvd-rom will be mounted on <strong>cdrom-0</strong>.</p><p><strong> FTP Clients </strong><br />If you are using windows you can try NetDrive or ExpanDrive which can mount any ftp server as a windows drive which hides away the ftp bits therefore make files on the usb drive available to any software that does not have ftp support. </p><p>Modern Linux distribution like Ubuntu has excellent ftp support and you should not have any problem with ftp using default file manager, for example with nautilus working on ftp is no different than working on a local disk.</p><p>Android user should try ES File Explorer which has very good ftp support.</p><p>XBMC (the ultimate media player) does support ftp protocol natively. </p><p><strong> NFS Clients </strong></p><p>To access nfs all you need to do is pointing the nfs client to nas:/mnt/sda1. Linux supports nfs natively and you should be able to find quite a few windows clients as well. The latest XBMC across all platforms should support nfs natively.</p><p>Due to limited CPU power the nfs write throughout is not as good as I expected even though it beats the read throughout of many commercial nas selling twice the price. I would recommend using ftp to upload really big files.</p><p><strong> WiFi HotSpot (AP) access </strong><br />The WiFi HotSpot is pre-configured to<br /></p><div class="codebox"><pre><code>SSID:  NAS-xxxx
KEY:    UEC7wzdu</code></pre></div><p>where xxxx refers the last 4 digits of the device&#039;s mac address which is printed on the back of WR703N. Make sure your wifi client support 11G or 11N WPA/WPA2 protocol.</p><p><strong> Multiple Wan/Uplinks and USB Tethering Support </strong><br />If your mobile phone supports usb tethering then you can use WR703N to share out your mobile phone&#039;s internet via the built in AP. It cannot be easier!! Just plug in the usb cable and enable the usb tethering option on your mobile and off you go. </p><p>I know that quite a lot phones nowadays can do wifi tethering but remember the wifi chip inside is not as good as the one inside WR703N. It will dramatically reduce the battery of the mobile phone. By using usb tethering you removed all the problems and besides you can charge your mobile phone at the same time.</p><p>Multiple wan is enabled by default for all wan/uplink interfaces. </p><p><strong>Compatibility</strong><br />I would really like it to work with every single usb hard disk out there. But in reality some works better. I noticed that one of my usb-ide converter (USB to Parallel-ATA bridge made by sunplus) keeps disconnecting under heavy uploading (writing) via ftp. I have&#039;t found out why but its likely to do with kernel module that shipped with openwrt. If you experienced similar problems I would suggest swap another usb (adapter) hard disk to see any difference.</p><br /><p><strong>Some nice pictures</strong><br /><span class="postimg"><img src="http://xbox-remote.googlecode.com/files/router.jpg" alt="http://xbox-remote.googlecode.com/files/router.jpg" /></span><br /><span class="postimg"><img src="http://xbox-remote.googlecode.com/files/wr703n-01.jpg" alt="http://xbox-remote.googlecode.com/files/wr703n-01.jpg" /></span><br /><span class="postimg"><img src="http://xbox-remote.googlecode.com/files/wr703n-02.jpg" alt="http://xbox-remote.googlecode.com/files/wr703n-02.jpg" /></span></p><br /><p><strong> Q &amp; A </strong><br />Q: What&#039;s the performance like?<br />A: With ftp and a 2.5 inch usb 2.0 hard disk I can achieve around 10MB/s read and 9MB/s write throughput. CPU is a bit tight at maximum transfer rate. I can get similar read throughput with nfs but only 6.5MB/s write throughput possibly because of the limited CPU power.</p><p>Q: Why not samba? FTP is really ancient<br />A:&nbsp; Samba is not really designed for embedded environment like WR703N. Samba is huge and slow. With the same hardware I can only achieve 7MB/s read and 6MB/s write throughput. </p><p>Q: Can I use it to stream 1080p HD videos?<br />A: You certainly can. But be aware that maximum bitrate you can stream probably will be capped to 80Mbps which is probably the hard limit of 100Mbps network.</p><p>Q: Can I just unplug the usb hard disk whenever I feel like?<br />A: Absolutely not!! If you unplug the usb hard disk without proper unmount process then expect missing/corrupted file/folders, unable to access them via ftp (i.e. empty ftp folder) and kidnapped by aliens :). If you really need to unplug the usb hard disk you should go to <a href="http://nas/cgi-bin/webif/status-usb.sh">http://nas/cgi-bin/webif/status-usb.sh</a> and click unmount for all mounted partition. You should only attempt to unplug it after the unmount process is done for each and every partition though most likely only /dev/sda1.</p><p>Q: How do I found out status of my usb hard disk, like available space?<br />A: Open this link <a href="http://nas/cgi-bin/webif/status-basic.sh">http://nas/cgi-bin/webif/status-basic.sh</a> and look for /dev/sda1 and it will till you&nbsp; free space (in KiB) and total space in (KiB) for your usb hard disk</p><p>Q: Can I use opkg install additional packages?<br />A: In short no. All packages are cherry picked and only the needed bits ended up in this firmware. 4MB flash really makes it challenging to squeeze everything you need inside. </p><p>Q: Do you offer warranty?<br />A: This is a hobby project and no warranty is offered.</p><p>Q: How can I use nfs?<br />A: All you need to is mount openwrt-nas:/mnt</p><p>Q: What&#039;s the root password?<br />A: The root password is &quot;root&quot; without quote.</p><p>Q: Does this firmware support 3G modem?<br />A: No. I don&#039;t have any 3G modem. However usb tethering (via mobile phone) is supported since firmware version 28854-1229.</p><p>Q: Do you have a full list of the features of this firmware?<br />A: The changes I made are too many to list. Most important features include but not limited to<br />&nbsp; &nbsp; * configuration free ftp, nfs<br />&nbsp; &nbsp; * support EFI GUID partition in addition to dos partition<br />&nbsp; &nbsp; * authentication-free web server<br />&nbsp; &nbsp; * automatic mount usb hard disk with ext2/3, (v)fat, ntfs file system<br />&nbsp; &nbsp; * usb cd/dvd-rom with ISO9660, Joliet and UDF disk support<br />&nbsp; &nbsp; * added loop module so you could mount iso images on WR703N and possibly share it out via ftp/nfs.<br />&nbsp; &nbsp; * can format the disk from web page<br />&nbsp; &nbsp; * all nfs, ftp process will be restarted when hard disk umounted using the web page<br />&nbsp; &nbsp; * pre-configured network, wifi and network sharing on wifi AP works out of box<br />&nbsp; &nbsp; * openvpn with ssl and lzo support build in<br />&nbsp; &nbsp; * support usb 1.1/2.0 hard disk<br />&nbsp; &nbsp; * multiple wan/uplinks support with usb tethering<br />&nbsp; &nbsp; * usb printer support<br />&nbsp; &nbsp; * easy to use web gui to switch most common network profiles</p><p>Q: What packages are installed?<br />A:&nbsp; Full list of packages<br /></p><div class="codebox"><pre><code>base-files
base-files-network
block-mount
busybox
crda
dnsmasq
dropbear
e2fsprogs
haserl
hotplug2
ip
iptables
iptables-mod-conntrack
iptables-mod-conntrack-extra
iptables-mod-ipopt
iptables-mod-nat
iw
kernel
kmod-ath
kmod-ath9k
kmod-ath9k-common
kmod-button-hotplug
kmod-cfg80211
kmod-crypto-aes
kmod-crypto-arc4
kmod-crypto-core
kmod-fs-exportfs
kmod-fs-ext3
kmod-fs-isofs
kmod-fs-nfs-common
kmod-fs-nfsd
kmod-fs-ntfs
kmod-fs-udf
kmod-fs-vfat
kmod-input-core
kmod-input-gpio-buttons
kmod-input-gpio-keys-polled
kmod-input-polldev
kmod-ipt-conntrack
kmod-ipt-conntrack-extra
kmod-ipt-core
kmod-ipt-ipopt
kmod-ipt-nat
kmod-ipt-nathelper
kmod-leds-gpio
kmod-lib-crc16
kmod-lib-crc-itu-t
kmod-loop
kmod-mac80211
kmod-nls-base
kmod-nls-utf8
kmod-scsi-cdrom
kmod-scsi-core
kmod-tun
kmod-usb2
kmod-usb-core
kmod-usb-net
kmod-usb-net-cdc-ether
kmod-usb-net-rndis
kmod-usb-ohci
kmod-usb-printer
kmod-usb-storage
libblkid
libc
libcom
libext2fs
libgcc
libip4tc
liblzo
libnl-tiny
libpthread
librpc
librt
libuci
libuuid
libwrap
libxtables
mtd
nfs-kernel-server
openvpn
opkg
p910nd
portmap
resize2fs
restorefactory
swconfig
tune2fs
uci
uhttpd
vsftpd
webif
wireless-tools
wpad-mini</code></pre></div><p>Q: When I try &quot;mount_root&quot; under fail safe I saw some error messages like this. What&#039;s wrong?<br /></p><div class="codebox"><pre><code>root@(none):/# mount_root
/sbin/mount_root: line 1: pi_include: not found
/sbin/mount_root: line 1: pi_include: not found
/sbin/mount_root: line 1: set_jffs_mp: not found
/sbin/mount_root: line 1: determine_root_device: not found
/sbin/mount_root: line 1: can&#039;t create /.extroot.md5sum: Read-only file system
switching to jffs2</code></pre></div><p>A: Nothing to worry about. The mount_root command tries to load every scripts under /lib/preinit/ and 50_determine_usb_root which comes from extra-root does not like to be loaded that way, that&#039;s all. It should mount jffs2 partition just fine.</p>											<p class="post-edited">(Last edited by <strong>s7mx1</strong> on 2 Jan 2012, 16:46)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150597">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">s7mx1</div>
					<div class="post-datetime">
						7 Dec 2011, 23:16					</div>
				</div>
				<div class="post-content content">
					<p><strong>PulseAudio firmware</strong></p><p>Pulseaudio is a sound server which gets installed on machines running on linux like latest Ubuntu. It is less known for people outside linux though you can install it on Windows. This firmware enables you streaming lossless audio cross wifi network which is very similar to airplay but with extreme cheap price tag.</p><p>This firmware is extremely easy to use. Optionally you will need to configure the wifi client which is just one click away.</p><p><strong>Requirements:</strong><br />* A 802.11g or 802.11n wifi router with dhcp support<br />* usb sound card or speakers<br />* any powered usb port can deliver 500 mA current or a usb battery pack</p><p><strong>Flash the firmware</strong><br />Get&nbsp; version 28854-1229 (aka <strong>The big Squeeze</strong>) firmware from <a href="http://xbox-remote.googlecode.com/files/openwrt-pulseaudio-28854-1229-tl-wr703n-v1-squashfs-factory.bin">http://xbox-remote.googlecode.com/files … actory.bin</a> and flash the usual way either with web upgrade if you are using original firmware or mtd command if you are using openwrt.</p><p><strong> WiFi HotSpot (AP) access </strong><br />The WiFi HotSpot is pre-configured to<br /></p><div class="codebox"><pre><code>SSID:  PulseAudio-xxxx
KEY:    UEC7wzdu</code></pre></div><p>where xxxx refers the last 4 digits of the device&#039;s mac address which is printed on the back of WR703N. Make sure your wifi client support 11G or 11N WPA/WPA2 protocol.</p><p><strong>Configure network/wifi client the easy way</strong><br />See my post <a href="https://forum.openwrt.org/viewtopic.php?pid=150598#p150598">here</a> for details on how to switch between 3 predefined network profile and among other things like enable wifi client. </p><p><strong>Plug the usb sound card/speakers </strong><br />Just plug in your usb sound card/speakers and as soon as the WR703N is initialised (with steady blue LED light) and it will be ready to go.</p><p>It&#039;s truly plug and play. You can plug in/out whenever you like. You can swap to a totally different sound card/speakers. The firmware should be smart enough to sort it out for you.</p><p><strong>Physical Volume buttons</strong><br />If your sound card/speakers has volume button (up/down/mute) . They should in most cases work straight out of the box. You can use them to increase, reduce or mute the current sound playing.</p><p><strong> PulseAudio Status Page </strong><br />I reckon this will be the most useful/visited page of this entire firmware. It will show detailed information on pulseaudio sinks, sink inputs, clients and also logs related to pulseaudio. You will be able to easily find out what sample rate the current sound card is running (under sinks section) and how many usb sound card is configured (card0, card1 etc under sinks section). The page is refreshed automatically every one minute.</p><p>The pulseaudio status page can be accessed from <a href="http://pulseaudio/cgi-bin/webif/power-pulseaudio.sh">here</a></p><p>If your&#039;s does not work this is the best place to visit. This is a typical pulseaudio status page screenshoot</p><p><span class="postimg"><img src="http://xbox-remote.googlecode.com/files/pulse-status-01.png" alt="http://xbox-remote.googlecode.com/files/pulse-status-01.png" /></span></p><p>and here </p><p><span class="postimg"><img src="http://xbox-remote.googlecode.com/files/pulse-status-01.png" alt="http://xbox-remote.googlecode.com/files/pulse-status-01.png" /></span></p><p>If your status page looks like the following it means that your usb sound card/speakers are not detected or supported.</p><p><span class="postimg"><img src="http://xbox-remote.googlecode.com/files/pulse-status-03.png" alt="http://xbox-remote.googlecode.com/files/pulse-status-03.png" /></span></p><br /><p><strong>PulseAudio Clients</strong><br />To actually play sound out from sound card/speakers attached to WR703N you will need a pulseaudio capable client to send audio to it. To make it easier for you I have gathered some sample configuration which can be downloaded from <a href="http://xbox-remote.googlecode.com/files/pulse-config-1229.zip">http://xbox-remote.googlecode.com/files … g-1229.zip</a>.</p><p><em>linux based clients</em><br />It is really ease to set up with most recent linux distribution as pulseaudio is chosen by the default audio system. In most cases all you need to do is to drop file client.conf-external (in the linux folder of the extracted zip file) to /etc/pulse/client.conf if you want to set this globally or to ~/.pulse/client.conf to affect current user alone. You will need to log out and then log back in for it to take effects.</p><p><em> WebOS </em><br />WebOS is very similar to modern linux which uses pulseaudio by default however the pulseaudio shipped with it is missing some key components that prevent gapless integration.&nbsp; You will need a rooted webos device and copy over the file client.conf-external (in the webos folder of the extracted zip file) to /etc/pulse/client.conf. You will need to restart your webos device for it to take effects. </p><p>Due to the bizarre way Palm/HP implemented pulseaudio on webos, the volume control on webos device will not work with WR703N however this should not be a problem if you have physical volume buttons on your sound card/speakers. The notification sound will not work as well. But other than that it works beautifully. I have been watching youtube 4oD tv programs on my touchpad (WebOS 3.02) which streams to WR703N on the same wifi network. During more than one hour playback I have not noticed any audio/video out of sync problems which is very common for similar wifi streaming solutions. This is excellent result to say at least.</p><p><em> mpd </em><br />MPD as a music system deserve to be highlighted here. It&#039;s small, efficient, runs on a large range of small embedded hardware and of course your PC. The very best feature of mpd makes it stand out from other pulseaudio capable music clients is the ability to re-sample audio internally. </p><p>The re-sampling process will kick in if the pulseaudio was given a 44.1KHz audio stream when the sound card only supports 48KHz sample rate playback. The hardware that WR703N runs unlike CPUs inside your PC such that it does have a floating point unit which make is really hard for re-sampling. Therefore you will likely to hear &#039;pops&#039; occasionally when re-sampling is going on. If the mpd is running on a capable machine (CPU with a floating point) the re-sampling process can be shifted from WR703N to mpd which can yields better quality playback.</p><p>In the mpd folder of the extracted zip file you will find 3 audio output sample files. The output-resample-on-server.conf means re-sample will be done on WR703N if any, output-resample-to-44100.conf/output-resample-to-48000.conf means MPD will force re-sample to 44.1Khz and 48Khz respectively. You could just copy the contents of the corresponding file to your main mpd configuration file and restart mpd for it to take effects.</p><p>Please make sure that the sample rate defined in output section of your mpd configuration file matches that hardware sample rate of your usb sound card/speakers. The sample rate that your usb sondcard/speakers runs at can be found out easily by checking this page <a href="http://pulseaudio/cgi-bin/webif/power-pulseaudio.sh">http://pulseaudio/cgi-bin/webif/power-pulseaudio.sh</a><br />If you have a spare machine and you want to utilise the CPU power on it to do the heavy lifting for re-sampling so that you can have smooth playback whatever the sample rate of the audio source, then you will need a pulseaudio relay. The idea is to have another pulseaudio running on the same network preferable on 100Mb/s wired and point every pulseaudio clients to that pulseaudio replay machine instead of WR703N, it then forward the (re-sampled, mixed) audio stream to WR703N. </p><p>I am currently running a pulseaudio replay with Atom D510 @1.5GHz, the CPU usage is about 10% of a single core for resampling (ffmpeg method) 44.1Khz audio to 48Khz. I believe any&nbsp; modern CPUs (ARM or X86) with floating point unit should do the job. The machine runs pulseaudio replay does not need any sound card as sound is actually played on WR703N. I would recommend using pulseaudio version 1.1 if possible.</p><p>Sample pulseaudio replay server configuration files ( in linux -&gt; pulse-replay sub folder of the extracted zip file) which can be copied over to /etc/pulse/.&nbsp; </p><p>To help detecting when WR703N becomes available I have crated a monitoring script and its accompany upstart service file. It works great for the pulseaudio replay. You will need to copy pulse-monitor.conf (in linux -&gt; pulse-monitor sub folder ) to /etc/init/ and copy <br />pulse-monitor.sh in the same folder to&nbsp; /etc/init.d/ then start the service by<br /></p><div class="codebox"><pre><code>initctl start pulse-monitor</code></pre></div><p><strong>Some nice pictures</strong></p><p><strong></p><p><span class="postimg"><img src="http://xbox-remote.googlecode.com/files/wr703n-03.jpg" alt="http://xbox-remote.googlecode.com/files/wr703n-03.jpg" /></span><br /><span class="postimg"><img src="http://xbox-remote.googlecode.com/files/wr703n-04.jpg" alt="http://xbox-remote.googlecode.com/files/wr703n-04.jpg" /></span></p><p>[b] Q &amp; A </strong><br />Q: What&#039;s the CPU usage of the running pulseaudio?<br />A: The CPU usage is about 12% and load is about 0.5 for puseaudio playing back 48Khz audio streaming without re-sampling. The resampling however does not increase much cpu usage.</p><p>Q: What&#039;s the power consumption like?<br />A:&nbsp; With running pulseaudio I measured 1.5Watt from main power socket. This translates to about 240mA current consumption (assume 80% efficiency of the power adapter) with my Sweex usb speakers. I have been running WR703N with the same speakers setup with 4x 2700mAh batteries for 8 hours straight.</p><p>Q: My wifi network has high latency and playback is choppy. Can I adjust the buffer size?<br />A: You can go to <a href="http://pulseaudio/cgi-bin/webif/system-editor.sh?path=/etc/pulse&amp;edit=daemon.conf">http://pulseaudio/cgi-bin/webif/system- … aemon.conf</a> from your browser and increase default-fragment-size-msec value. Save it and then apply changes then reboot it. However it may not solve all the problems and audio delay will be increased as a result. This can cause audio/video out of sync if the value is set too high. It would be best to improve your wifi network, i.e. investing better wifi router.</p><p>Q: My wifi coverage/signal is weak. What should I do?<br />A: Move around WR703N to get the best reception. You should also consider adding additional antenna or get a wifi range extender. </p><p>Q: The sound is choppy. What&#039;s wrong?<br />A: Move WR703N near to the wifi router, if this solves the problem then see weak wifi signal Q&amp;A just above. Make sure that there is plenty free CPU resources on the pulseaudio client (mpd), pulseaudio replay sever if you have one. You may want to adjust default-fragment-size-msec if there is a high latency on your wifi network. It&#039;s worth to also look into getting a less congested&nbsp; wifi channel and avoid and other interference from other 2.4G wifi devices (like bluetooth or microwave etc).</p><p>Q: What usb sound card/speakers does it support?<br />A: Virtually any usb sound card/speakers should work with it. But be aware some usb sound card/speakers may consume more power in which case you will need a usb power adapter that can deliver more current. If you just need a cheap usb speakers I would recommend Sweex GO Stereo Speaker Bar, Creative A40 or Logitech Black S150.</p><p>Q: I am planning to use the lan port of WR703N to provide internet access to my pc/laptop, is it doable?<br />A: If the <a href="https://forum.openwrt.org/viewtopic.php?pid=150598#p150598">wifi client setting</a> is setup up correcting then you should be able to surf internet with the lan port of WR703N automatically. It should not intefere with the pulseaudio wifi streaming though all traffic go through the wifi interface. I have been able to watching 720p east ender show that way and music streamed wirelessly to pulseaudio plays smoothly.</p>											<p class="post-edited">(Last edited by <strong>s7mx1</strong> on 30 Dec 2011, 15:53)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150598">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">s7mx1</div>
					<div class="post-datetime">
						7 Dec 2011, 23:16					</div>
				</div>
				<div class="post-content content">
					<p><strong>How to configure the network the easy way</strong></p><p>Configuring network especially changing to something vastly different is not an easy task. There are so many elements involved: network, wifi, dhcp and firewall. Even if you are very familiar with openwrt you are likely to run into trouble or missed something. </p><p>Added to the fact that latest WR703N is notorious at providing accessible TTL pins I feel strongly that by providing a robust and easy to switch network profile/network will benefit all end users of WR703N. </p><p>After a bit study I realised that with only one ethernet port the end user will most likely to use one of the three network setups with WR703N which will be explained later. I exposed those 3 network setup with a shiny new web gui page so you can switch between them with a single click. This page can be accessed from</p><p><a href="http://nas/cgi-bin/webif/power-network.sh">http://nas/cgi-bin/webif/power-network.sh</a>&nbsp; for nas firmware<br /><a href="http://pulseaudio/cgi-bin/webif/power-network.sh">http://pulseaudio/cgi-bin/webif/power-network.sh</a>&nbsp; for pulseaudio firmware</p><p>Setting up is straightforward but please read through the rest of the post to fully understand the meaning and possible consequence of each setting. After you click the &quot;Set network mode&quot; button it will need to restart itself so the changes can take effect.</p><p><strong>Wifi Station</strong><br />You need to provide the upstream wifi router&#039;s SSID and KEY if you want WR703N to connect to it via wifi. </p><p>If you put in wrong combination of upstream wifi router&#039;s SSID and KEY or upstream wifi router is not accessible, refuse to connect etc, this will ruin the build-in AP on WR703N since the wifi ap share the same hardware as the wifi client. In that scenario the wifi chip will keep fast switching channels in the hope of connecting to the up stream wifi router and as a result the build-in AP&#039;s channel will keep switching as well which makes it impossible for any clients to connect to.</p><p>By default SSID is set to &quot;Disabled&quot; which disables the wifi client.</p><p><strong>Unique Device ID</strong><br />If you have multiple WR703N running on the same network with the same firmware,&nbsp; for example you have 2 WR703N powered by my pulseaudio firmware running on the same network. Then it is advisable to turn on the &quot;Unique Device ID&quot; features which will use the last 4 letters of the mac address of each device. This unique device id string will be append to the hostname of each device and you will be able to use the unique-fied hostname to access each individual device, for example if your last 4 letters of the mac address is ab12 and after you turned on &quot;Unique Device ID&quot; you will be able to access the device with hostname like pulseaudio-ab12&nbsp; (for pulseaudio firmware) or nas-ab12 (for nas firmware) instead of pulseaudio/nas.</p><p>By default its disabled.</p><br /><p><strong> Explanation of the 3 network setup/mode</strong></p><p>1) Mode 1: <br />&nbsp; &nbsp; The ethernet port (eth0) of WR703N acts like lan port. Together with wifi AP (wlan0) it forms a bridged lan. This bridged lan sits on a private network of 172.16.0.0/24 (nas) or 172.16.10.0.24 (pulseaudio). DHCP server is turned on on this bridged lan so you can connect your pc to either the lan port of WR703N or the wifi AP.<br />&nbsp; &nbsp; Optionally you can set wifi station so it will connect to upstream wifi AP as a client. This interface wlan1 will act like an wan port. </p><br /><p>2) Mode 2:<br />&nbsp; &nbsp;The ethernet port (eth0) of WR703N acts like wan port which you need to connect to upstream (e.g. another router).<br />&nbsp; &nbsp;Wifi AP (wlan0) sits on a private network of 172.16.0.0/24 (nas) or 172.16.10.0.24 (pulseaudio). DHCP server is turned on on wifi AP so you can connect your pc via wifi. <br />&nbsp; &nbsp; Optionally you can set wifi station so it will connect to upstream wifi AP as a client. This interface wlan1 will act like another wan port. </p><p>3) Mode 3:<br />&nbsp; &nbsp;Wifi AP (wlan0) sits on a private network of 172.16.0.0/24 (nas) or 172.16.10.0.24 (pulseaudio). DHCP server is turned on on wifi AP so you can connect your pc via wifi. <br />&nbsp; &nbsp;The ethernet port (eth0) of WR703N acts like lan port. Together with wifi client (wlan1) it forms a WDS bridged lan. This bridged lan will have an ip addressed assigned by the upstream wifi AP (the one wlan1 is connected to). DHCP is not running on this wds bridged lan and any dhcp requested is handled by up stream wifi router directly. The good thing about this wds bridged lan is that you can think the ethernet port of WR703N as an extended lan port of the upstream wifi router.</p><p>Pulseaudio firmware uses mode 1 by default and nas firmware uses mode 2 by default.</p><p><strong> What about the usb tethering? </strong><br />If you connected your mobile phone with WR703n and enabled usb tethering the usb network interface USB0 will automatically appear which acts as wan port. No configuration is need for this.</p>											<p class="post-edited">(Last edited by <strong>s7mx1</strong> on 30 Dec 2011, 15:26)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150599">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">s7mx1</div>
					<div class="post-datetime">
						7 Dec 2011, 23:16					</div>
				</div>
				<div class="post-content content">
					<p>reserved</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150691">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Lennong</div>
					<div class="post-datetime">
						9 Dec 2011, 01:21					</div>
				</div>
				<div class="post-content content">
					<p>Very nice! I&#039;m trying it out now. Can you please do a full package list and post it as reference for us lesser dudes? <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150692">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">cncaihua</div>
					<div class="post-datetime">
						9 Dec 2011, 03:05					</div>
				</div>
				<div class="post-content content">
					<p>great work! WR703N is best choice for offline download ,it consumes so little power.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150730">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">s7mx1</div>
					<div class="post-datetime">
						9 Dec 2011, 12:14					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Lennong wrote:</cite><blockquote><p>Very nice! I&#039;m trying it out now. Can you please do a full package list and post it as reference for us lesser dudes? <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></blockquote></div><p>I had to remove the package info from the firmware and therefore &quot;opkg list&quot; will show nothing with this nas firmware. This is to save some precious firmware space.&nbsp; Let me know how it goes.</p><p>Here is the full package list:</p><div class="codebox"><pre><code>base-files-network
base-files
blkid
block-mount
busybox
crda
dnsmasq
dropbear
e2fsprogs
fdisk
haserl
hotplug2
iptables-mod-conntrack
iptables-mod-nat
iptables
iw
kernel
kmod-ath9k-common
kmod-ath9k
kmod-ath
kmod-button-hotplug
kmod-cfg80211
kmod-crypto-aes
kmod-crypto-arc4
kmod-crypto-core
kmod-fs-ext4
kmod-input-core
kmod-input-gpio-buttons
kmod-input-gpio-keys-polled
kmod-input-polldev
kmod-ipt-conntrack
kmod-ipt-core
kmod-ipt-nat
kmod-leds-gpio
kmod-lib-crc16
kmod-mac80211
kmod-nls-base
kmod-nls-utf8
kmod-scsi-core
kmod-tun
kmod-usb-core
kmod-usb-storage
kmod-usb2
libblkid
libc
libcom_err
libext2fs
libgcc
libip4tc
liblzo
libnl-tiny
libpthread
librpc
librt
libuci
libuuid
libwrap
libxtables
mtd
openvpn
opkg
portmap
resize2fs
restorefactory
swconfig
tune2fs
uci
uhttpd
unfs3
vsftpd
webif
wireless-tools
wpad-mini</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150747">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">maurer</div>
					<div class="post-datetime">
						9 Dec 2011, 14:39					</div>
				</div>
				<div class="post-content content">
					<p>a build with transmission <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /> ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150749">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">Lennong</div>
					<div class="post-datetime">
						9 Dec 2011, 15:42					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>s7mx1 wrote:</cite><blockquote><p><strong>NAS firmware</strong></p><p>This is a firmware for those who want to share out their usb hard drive over local network. Setting up a NAS like a pro has never been easier thanks to configuration-free ftp, nfs. Pre-configured WiFi HotSpot (AP) allows any wifi devices/clients to access files on the usb disk instantly and better still those wifi devices/clients will be able to surf the internet or access resources on the local home network at the same time. This is all done without any messing around configuration files on WR703N, no file to edit, no commend line to type. </p><p>Ever dreaming of access files out and about? No problem. OpenVPN server/client with lzo compression support is build in. Due to security reasons I dare not to pre-configure openvpn for you. Please head to openwrt&#039;s excellent wiki for setting up openvpn.</p><p>This firmware requires minimal configuration but do read through the rest of this post before try it out!!!!</p><p><strong>Requirements:</strong><br />* A router that has dhcp support that is connected to your home local network (Any out of shelf router bought recently should do)<br />* Ethernet cable with one end connected to the lan port of the above router and the other end connected to the lan port of WR703N<br />* usb 2.0 hard disk (formatted as a single ext3 partition preferable but not necessary)<br />* 5V usb power adapter. You will need a power adapter with sufficient current to power your hard disk. Personally I am using one 5V 1.0A power adapter and usb hard drive works fine.</p><p><strong>Flash the firmware:</strong><br />Get the firmware from here <a href="http://xbox-remote.googlecode.com/files/openwrt-nas-28854-tl-wr703n-v1-squashfs-factory.bin">http://xbox-remote.googlecode.com/files … actory.bin</a><br />Flash it with the usual way either with web upgrade if you are using original firmware or mtd command if you are using openwrt.</p><p><strong>First Boot:</strong><br />The first time you boot WR703N after you flashed the firmware please make sure the usb hard disk is disconnected from WR703N till the router is initialised, i.e. steady blue LED. After you have steady blue LED open the following address <a href="http://openwrt-nas">http://openwrt-nas</a> using your web browser. You should see a system information page. If everything goes all right you can then plug in your usb hard disk. If your hard disk is formatted as a single ext3 partition then you don&#039;t need to do anything otherwise please head to the &quot;How to format usb disk&quot; section.</p><p><strong>How to format usb disk:</strong><br />Make sure you have copied out all files out from your usb hard disk as this process will destroy any existing partition and file system on your usb hard disk. This process cannot be undone. </p><p>Open the following link <a href="http://openwrt-nas/cgi-bin/webif/system-format.sh">http://openwrt-nas/cgi-bin/webif/system-format.sh</a> from your web browser and following the instruction. When all done it will automatically reboot WR703N. The time it takes for the format process varies. It takes less than 1 minute to format a slow usb 2.0 memory stick.</p><p><strong> How to access files within local network </strong><br />After the router is initialised, i.e. steady blue LED, with usb hard disk connected, you can access files on the usb hard disk using any ftp client pointing to ftp://openwrt-nas with <br /></p><div class="codebox"><pre><code>username:   root
password:    root</code></pre></div><p><strong> FTP Clients </strong><br />If you are using windows you can try NetDrive or ExpanDrive which can mount any ftp server as a windows drive which hides away the ftp bits therefore make files on the usb drive available to any software that does not have ftp support. </p><p>Modern Linux distribution like Ubuntu has excellent ftp support and you should not have any problem with ftp using default file manager, for example with nautilus working on ftp is no different than working on a local disk.</p><p>Android user should try ES File Explorer which has very good ftp support.</p><p>XBMC (the ultimate media player) does support ftp protocol natively. </p><p><strong> WiFi HotSpot (AP) access </strong><br />The WiFi HotSpot is pre-configured to<br /></p><div class="codebox"><pre><code>SSID:  OpenWrt-NAS
KEY:    j2*C71wzdu</code></pre></div><p>Make sure your wifi client support 11G or 11N WPA/WPA2 protocol.</p><p><strong>Some nice pictures</strong><br /><a href="http://xbox-remote.googlecode.com/files/router.jpg">http://xbox-remote.googlecode.com/files/router.jpg</a><br /><a href="http://xbox-remote.googlecode.com/files/wr703n-01.jpg">http://xbox-remote.googlecode.com/files/wr703n-01.jpg</a><br /><a href="http://xbox-remote.googlecode.com/files/wr703n-02.jpg">http://xbox-remote.googlecode.com/files/wr703n-02.jpg</a></p><br /><p><strong> Q &amp; A </strong><br />Q: What&#039;s the performance like?<br />A: With ftp and a 2.5 inch usb 2.0 hard disk I can achieve around 10MB/s read and 10MB/s write throughput. CPU is a bit tight at maximum transfer rate. </p><p>Q: Why not samba? FTP is really ancient<br />A:&nbsp; Samba is not really designed for embedded environment like WR703N. Samba is huge and slow. With the same hardware I can only achieve 7MB/s read and 6MB/s write throughput. </p><p>Q: Can I use it to stream 1080p HD videos?<br />A: You certainly can. But be aware that maximum bitrate you can stream probably will be capped to 80Mbps which is probably the hard limit of 100Mbps network.</p><p>Q: Can I just unplug the usb hard disk whenever I feel like?<br />A: Absolutely not!! If you unplug the usb hard disk without proper unmount process then expect missing/corrupted file/folders, unable to access them via ftp (i.e. empty ftp folder) and kidnapped by aliens <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />. If you really need to unplug the usb hard disk you should go to <a href="http://openwrt-nas/cgi-bin/webif/status-usb.sh">http://openwrt-nas/cgi-bin/webif/status-usb.sh</a> and click unmount for all mounted partition. You should only attempt to unplug it after the unmount process is done for each and every partition though most likely only /dev/sda1.</p><p>Q: How do I found out status of my usb hard disk, like available space?<br />A: Open this link <a href="http://openwrt-nas/cgi-bin/webif/status-basic.sh">http://openwrt-nas/cgi-bin/webif/status-basic.sh</a> and look for /dev/sda1 and it will till you&nbsp; free space (in KiB) and total space in (KiB) for your usb hard disk</p><p>Q: Can I use opkg install additional packages?<br />A: In short no. All packages are cherry picked and only the needed bits ended up in this firmware. 4MB flash really makes it challenging to squeeze everything you need inside. </p><p>Q: Do you offer warranty?<br />A: This is a hobby project and no warranty is offered.</p><p>Q: How can I use nfs?<br />A: All you need to is mount openwrt-nas:/mnt</p><p>Q: What&#039;s the root password?<br />A: The root password is &quot;root&quot; without quote.</p><p>Q: Do you have a full list of the features of this firmware?<br />A: The changes I made are too many to list. Most important features include but not limited to<br />&nbsp; &nbsp; * configuration free ftp, nfs<br />&nbsp; &nbsp; * support EFI GUID partition in addition to dos partition<br />&nbsp; &nbsp; * authentication-free web server<br />&nbsp; &nbsp; * automatic mount usb hard disk with ext3 file system<br />&nbsp; &nbsp; * can format the disk from web page<br />&nbsp; &nbsp; * all nfs, ftp process will be restarted when hard disk umounted using the web page<br />&nbsp; &nbsp; * pre-configured network, wifi and network sharing on wifi AP works out of box<br />&nbsp; &nbsp; * openvpn with ssl and lzo support build in<br />&nbsp; &nbsp; * support only usb 2.0 hard disk</p><p>Q: What packages are installed?<br />A:&nbsp; Full list of packages<br /></p><div class="codebox"><pre><code>base-files-network
base-files
blkid
block-mount
busybox
crda
dnsmasq
dropbear
e2fsprogs
fdisk
haserl
hotplug2
iptables-mod-conntrack
iptables-mod-nat
iptables
iw
kernel
kmod-ath9k-common
kmod-ath9k
kmod-ath
kmod-button-hotplug
kmod-cfg80211
kmod-crypto-aes
kmod-crypto-arc4
kmod-crypto-core
kmod-fs-ext4
kmod-input-core
kmod-input-gpio-buttons
kmod-input-gpio-keys-polled
kmod-input-polldev
kmod-ipt-conntrack
kmod-ipt-core
kmod-ipt-nat
kmod-leds-gpio
kmod-lib-crc16
kmod-mac80211
kmod-nls-base
kmod-nls-utf8
kmod-scsi-core
kmod-tun
kmod-usb-core
kmod-usb-storage
kmod-usb2
libblkid
libc
libcom_err
libext2fs
libgcc
libip4tc
liblzo
libnl-tiny
libpthread
librpc
librt
libuci
libuuid
libwrap
libxtables
mtd
openvpn
opkg
portmap
resize2fs
restorefactory
swconfig
tune2fs
uci
uhttpd
unfs3
vsftpd
webif
wireless-tools
wpad-mini</code></pre></div></blockquote></div><p>Excellent! Thanks!</p><p>It runs very nice, and no nasty high load like other homebuilt I&#039;ve tried. </p><p>A couple of things:<br />I cannot get my Huawei E173 to fly even though I get driver hook. I also tried to to firmware upgrade from web ui, but it flips out and reboots.</p><p>A part from those issues I get really good throughput, up to 35Mbit to a USB flash disk via ftp. That was more than I expected, nice! I put the router in another room, tried out XBMC and then streamed a 2h video powered from a 1600mAh battery I had lying around! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150766">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">s7mx1</div>
					<div class="post-datetime">
						9 Dec 2011, 17:31					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Lennong wrote:</cite><blockquote><p>Excellent! Thanks!</p><p>It runs very nice, and no nasty high load like other homebuilt I&#039;ve tried. </p><p>A couple of things:<br />I cannot get my Huawei E173 to fly even though I get driver hook. I also tried to to firmware upgrade from web ui, but it flips out and reboots.</p><p>A part from those issues I get really good throughput, up to 35Mbit to a USB flash disk via ftp. That was more than I expected, nice! I put the router in another room, tried out XBMC and then streamed a 2h video powered from a 1600mAh battery I had lying around! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></blockquote></div><p>No 3G modem support in this firmware I am afraid. I use my phone to do the tethering and don&#039;t have a 3G modem.</p><p>The web ui firmware upgrade is bit flaky. I found mtd method is more reliable. You can either transfer the firmware over via ftp or scp then run<br /></p><div class="codebox"><pre><code>mtd -r write /path/to/firmware firmware</code></pre></div><p>I assume you are streaming it via wifi, then 35Mbit/s is indeed a good throughput.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150807">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">Lennong</div>
					<div class="post-datetime">
						10 Dec 2011, 05:43					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>s7mx1 wrote:</cite><blockquote><div class="quotebox"><cite>Lennong wrote:</cite><blockquote><p>Excellent! Thanks!</p><p>It runs very nice, and no nasty high load like other homebuilt I&#039;ve tried. </p><p>A couple of things:<br />I cannot get my Huawei E173 to fly even though I get driver hook. I also tried to to firmware upgrade from web ui, but it flips out and reboots.</p><p>A part from those issues I get really good throughput, up to 35Mbit to a USB flash disk via ftp. That was more than I expected, nice! I put the router in another room, tried out XBMC and then streamed a 2h video powered from a 1600mAh battery I had lying around! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></blockquote></div><p>No 3G modem support in this firmware I am afraid. I use my phone to do the tethering and don&#039;t have a 3G modem.</p><p>The web ui firmware upgrade is bit flaky. I found mtd method is more reliable. You can either transfer the firmware over via ftp or scp then run<br /></p><div class="codebox"><pre><code>mtd -r write /path/to/firmware firmware</code></pre></div><p>I assume you are streaming it via wifi, then 35Mbit/s is indeed a good throughput.</p></blockquote></div><p>I&#039;m gonna solder on the UART pins anyway so no biggie. Yes, I was surprised over the throughput, as well as the ultra low power usage, amazing combination!</p><p>I&#039;ve tried to recreate your build, but I get a too big build and fail to generate image. I assume you are chopping out bits and pieces here and there? Do you have any pointers on paths to go when chopping it? </p><p>My goal is to have extroot on a stick, FAT support,&nbsp; 3G and multiWAN in one package, prefereably managed by either LuCI or x-Wrt. I have a tiny powered 4-port USB-hub that will fit inside the router and a couple of stripped flash memories that also will fit in there, I will flip the exisiting USB port and connect it after the hub and possibly glue another USB port next to it. The result will be two internal USB disks and one external + MultiWAN with fall-over to 3G. It will be the perfect travelcompanion for sharing and viewing media for both business and pleasure! I did managed to fit all that inside my Ralink 3050F based wr512-3gn with 4MB flash, but it seems like the Atheros chip takes more precious space for the basic functionality.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150809">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">maurer</div>
					<div class="post-datetime">
						10 Dec 2011, 08:38					</div>
				</div>
				<div class="post-content content">
					<p>@Lennong<br />post some pictures after you finish your project.<br />nice idea, by the way</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150811">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">Lennong</div>
					<div class="post-datetime">
						10 Dec 2011, 09:18					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>maurer wrote:</cite><blockquote><p>@Lennong<br />post some pictures after you finish your project.<br />nice idea, by the way</p></blockquote></div><p>Will do!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150830">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">s7mx1</div>
					<div class="post-datetime">
						10 Dec 2011, 16:37					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>maurer wrote:</cite><blockquote><p>a build with transmission <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /> ?</p></blockquote></div><p>Probably I can squeeze transmission in with the expenses of openvpn. Will do it at later time but now I really want to release the pulseaudio firmware.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150833">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">s7mx1</div>
					<div class="post-datetime">
						10 Dec 2011, 17:17					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Lennong wrote:</cite><blockquote><p>I&#039;ve tried to recreate your build, but I get a too big build and fail to generate image. I assume you are chopping out bits and pieces here and there? Do you have any pointers on paths to go when chopping it? </p><p>My goal is to have extroot on a stick, FAT support,&nbsp; 3G and multiWAN in one package, prefereably managed by either LuCI or x-Wrt. I have a tiny powered 4-port USB-hub that will fit inside the router and a couple of stripped flash memories that also will fit in there, I will flip the exisiting USB port and connect it after the hub and possibly glue another USB port next to it. The result will be two internal USB disks and one external + MultiWAN with fall-over to 3G. It will be the perfect travelcompanion for sharing and viewing media for both business and pleasure! I did managed to fit all that inside my Ralink 3050F based wr512-3gn with 4MB flash, but it seems like the Atheros chip takes more precious space for the basic functionality.</p></blockquote></div><p>@Lennong</p><p>I will be surprised if you can squeeze every package I listed without major changes to the source code. I have spent hours and hours on minimising space out of my home gateway (TP-Link WR841ND shown in the first picture) which uses very similar CPU and it also got 4MB flash. I managed to reuse the work done on WR841ND and apply them almost straight to WR703N. The svn repository of patches (against trunk version 28854) can be found&nbsp; at <a href="https://xbox-remote.googlecode.com/svn/trunk/embeded-system/openwrt/nas/trunk-28854">https://xbox-remote.googlecode.com/svn/ … runk-28854</a><br />You can check out by doing<br /></p><div class="codebox"><pre><code>svn co https://xbox-remote.googlecode.com/svn/trunk/embeded-system/openwrt/nas/trunk-28854 openwrt-nas</code></pre></div><p>where you will find openwrt configuration file &quot;config-nas&quot; which you need to copy to .config in your openwrt root folder. patches can be found in &quot;patches&quot; folder which you need to apply by &quot;patch -p0&quot;.</p><p>Remember those patches are against trunk revision 28854. If you want to have a working station wifi (i.e. using WR703N connect to other wireless AP) you will need to downgrade &quot;package/mac80211&quot; to revision 28294.</p><p>For your plan I would suggest:<br />1) Remove CONFIG_CLEAN_IPKG=y in the .config so that you will retain installed package information<br />2) Build openvpn as a module or remove it (1.3MB raw disk space) if you don&#039;t need it so that there is room for ppp&nbsp; which has a lot dependencies<br />3) Set every configuration file you need beforehand so it works straight out of the box for example, 3G auth, overlay or root on usb disk etc. Have a look at my patches to get an idea.</p><p>The reason AR71xx platform uses so much space I guess is because it takes around 830KB raw space for the kernel wifi driver and its dependency alone. The reason I choose xwrt over luci is purely because of the size.</p><p>Good luck to your project.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150861">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">Lennong</div>
					<div class="post-datetime">
						11 Dec 2011, 08:14					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>s7mx1 wrote:</cite><blockquote><div class="quotebox"><cite>Lennong wrote:</cite><blockquote><p>I&#039;ve tried to recreate your build, but I get a too big build and fail to generate image. I assume you are chopping out bits and pieces here and there? Do you have any pointers on paths to go when chopping it? </p><p>My goal is to have extroot on a stick, FAT support,&nbsp; 3G and multiWAN in one package, prefereably managed by either LuCI or x-Wrt. I have a tiny powered 4-port USB-hub that will fit inside the router and a couple of stripped flash memories that also will fit in there, I will flip the exisiting USB port and connect it after the hub and possibly glue another USB port next to it. The result will be two internal USB disks and one external + MultiWAN with fall-over to 3G. It will be the perfect travelcompanion for sharing and viewing media for both business and pleasure! I did managed to fit all that inside my Ralink 3050F based wr512-3gn with 4MB flash, but it seems like the Atheros chip takes more precious space for the basic functionality.</p></blockquote></div><p>@Lennong</p><p>I will be surprised if you can squeeze every package I listed without major changes to the source code. I have spent hours and hours on minimising space out of my home gateway (TP-Link WR841ND shown in the first picture) which uses very similar CPU and it also got 4MB flash. I managed to reuse the work done on WR841ND and apply them almost straight to WR703N. The svn repository of patches (against trunk version 28854) can be found&nbsp; at <a href="https://xbox-remote.googlecode.com/svn/trunk/embeded-system/openwrt/nas/trunk-28854">https://xbox-remote.googlecode.com/svn/ … runk-28854</a><br />You can check out by doing<br /></p><div class="codebox"><pre><code>svn co https://xbox-remote.googlecode.com/svn/trunk/embeded-system/openwrt/nas/trunk-28854 openwrt-nas</code></pre></div><p>where you will find openwrt configuration file &quot;config-nas&quot; which you need to copy to .config in your openwrt root folder. patches can be found in &quot;patches&quot; folder which you need to apply by &quot;patch -p0&quot;.</p><p>Remember those patches are against trunk revision 28854. If you want to have a working station wifi (i.e. using WR703N connect to other wireless AP) you will need to downgrade &quot;package/mac80211&quot; to revision 28294.</p><p>For your plan I would suggest:<br />1) Remove CONFIG_CLEAN_IPKG=y in the .config so that you will retain installed package information<br />2) Build openvpn as a module or remove it (1.3MB raw disk space) if you don&#039;t need it so that there is room for ppp&nbsp; which has a lot dependencies<br />3) Set every configuration file you need beforehand so it works straight out of the box for example, 3G auth, overlay or root on usb disk etc. Have a look at my patches to get an idea.</p><p>The reason AR71xx platform uses so much space I guess is because it takes around 830KB raw space for the kernel wifi driver and its dependency alone. The reason I choose xwrt over luci is purely because of the size.</p><p>Good luck to your project.</p></blockquote></div><p>Very nice and handy info there, thanks! It actually looks quite logical if one looks into the config and patch files, will dig into it! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150869">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">lazyfai</div>
					<div class="post-datetime">
						11 Dec 2011, 12:55					</div>
				</div>
				<div class="post-content content">
					<p>Hi,<br />I have built the firmware with basic USB storage support but not much space left for FTP/NFS things, can you share your &quot;.config&quot; ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150874">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">s7mx1</div>
					<div class="post-datetime">
						11 Dec 2011, 14:04					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>lazyfai wrote:</cite><blockquote><p>Hi,<br />I have built the firmware with basic USB storage support but not much space left for FTP/NFS things, can you share your &quot;.config&quot; ?</p></blockquote></div><p>@lazyfai</p><p>See post <a href="https://forum.openwrt.org/viewtopic.php?pid=150833#p150833">#16</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150875">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">maurer</div>
					<div class="post-datetime">
						11 Dec 2011, 14:28					</div>
				</div>
				<div class="post-content content">
					<p>i also tried to build some time ago a nas image but the hdd fsiled to mount.<br />do you use 2.5 hdd only powered from 703n usb ? or external powered?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150876">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">s7mx1</div>
					<div class="post-datetime">
						11 Dec 2011, 14:33					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>maurer wrote:</cite><blockquote><p>i also tried to build some time ago a nas image but the hdd fsiled to mount.<br />do you use 2.5 hdd only powered from 703n usb ? or external powered?</p></blockquote></div><p>@maurer</p><p>I can power the 2.5 HDD from 703N&#039;s usb port providing 703N gets its power from a 5v, 1A usb power adapter which comes with my HTC mobile phone.&nbsp; I previously tried a 5V, 0.75A usb power adapter but the hard disk struggles to power up.</p>											<p class="post-edited">(Last edited by <strong>s7mx1</strong> on 11 Dec 2011, 14:34)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150913">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">Generalenthu</div>
					<div class="post-datetime">
						11 Dec 2011, 22:48					</div>
				</div>
				<div class="post-content content">
					<p>@s7mx1</p><p>I saw your (I think) message on raspi forum and joined this forum. Eagerly waiting for your pulse audio firmware. Any idea when you will be releasing it.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150918">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">s7mx1</div>
					<div class="post-datetime">
						11 Dec 2011, 23:48					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Generalenthu wrote:</cite><blockquote><p>@s7mx1</p><p>I saw your (I think) message on raspi forum and joined this forum. Eagerly waiting for your pulse audio firmware. Any idea when you will be releasing it.</p></blockquote></div><p>@Generalenthu</p><p>Yes. that was me.</p><p>I just got physical volume buttons on my usb speakers working, now I can adjust the pulseaudio output volume by pressing the&nbsp; volume up/down button on my speakers which is really cool. </p><p>I will try to release it early next week (it&#039;s Sunday night local time), so stay tuned.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150945">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">Generalenthu</div>
					<div class="post-datetime">
						12 Dec 2011, 08:20					</div>
				</div>
				<div class="post-content content">
					<p>Really nice to see you dotting the i&#039;s and crossing the t&#039;s. I ordered my unit mid last week and is yet to be shipped. On a related note, is there enough flash memory to include mpd in the firmware. All my music is on a nas which could be mounted on boot along with a remote mpd database. This may be impractical though.</p><p>To me the obvious alternative is to just run pulseaudio making it discoverable. I guess it could be connected to mpd running elsewhere. Anyways, I am a linux n00b; pardon me if it sounds ignorant.</p><p>I am planning to use a USB soundcard plugged into wr703n and connect it to aux in an ipod dock. Ideally would like to be able to draw power for wr703n from ipod male connector, but am not finding suitable cables.</p><p>Anyways, this setup should give Sonos a serious run for its money!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150966">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">Lennong</div>
					<div class="post-datetime">
						12 Dec 2011, 13:43					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>s7mx1 wrote:</cite><blockquote><div class="quotebox"><cite>Lennong wrote:</cite><blockquote><p>I&#039;ve tried to recreate your build, but I get a too big build and fail to generate image. I assume you are chopping out bits and pieces here and there? Do you have any pointers on paths to go when chopping it? </p><p>My goal is to have extroot on a stick, FAT support,&nbsp; 3G and multiWAN in one package, prefereably managed by either LuCI or x-Wrt. I have a tiny powered 4-port USB-hub that will fit inside the router and a couple of stripped flash memories that also will fit in there, I will flip the exisiting USB port and connect it after the hub and possibly glue another USB port next to it. The result will be two internal USB disks and one external + MultiWAN with fall-over to 3G. It will be the perfect travelcompanion for sharing and viewing media for both business and pleasure! I did managed to fit all that inside my Ralink 3050F based wr512-3gn with 4MB flash, but it seems like the Atheros chip takes more precious space for the basic functionality.</p></blockquote></div><p>@Lennong</p><p>I will be surprised if you can squeeze every package I listed without major changes to the source code. I have spent hours and hours on minimising space out of my home gateway (TP-Link WR841ND shown in the first picture) which uses very similar CPU and it also got 4MB flash. I managed to reuse the work done on WR841ND and apply them almost straight to WR703N. The svn repository of patches (against trunk version 28854) can be found&nbsp; at <a href="https://xbox-remote.googlecode.com/svn/trunk/embeded-system/openwrt/nas/trunk-28854">https://xbox-remote.googlecode.com/svn/ … runk-28854</a><br />You can check out by doing<br /></p><div class="codebox"><pre><code>svn co https://xbox-remote.googlecode.com/svn/trunk/embeded-system/openwrt/nas/trunk-28854 openwrt-nas</code></pre></div><p>where you will find openwrt configuration file &quot;config-nas&quot; which you need to copy to .config in your openwrt root folder. patches can be found in &quot;patches&quot; folder which you need to apply by &quot;patch -p0&quot;.</p><p>Remember those patches are against trunk revision 28854. If you want to have a working station wifi (i.e. using WR703N connect to other wireless AP) you will need to downgrade &quot;package/mac80211&quot; to revision 28294.</p><p>For your plan I would suggest:<br />1) Remove CONFIG_CLEAN_IPKG=y in the .config so that you will retain installed package information<br />2) Build openvpn as a module or remove it (1.3MB raw disk space) if you don&#039;t need it so that there is room for ppp&nbsp; which has a lot dependencies<br />3) Set every configuration file you need beforehand so it works straight out of the box for example, 3G auth, overlay or root on usb disk etc. Have a look at my patches to get an idea.</p><p>The reason AR71xx platform uses so much space I guess is because it takes around 830KB raw space for the kernel wifi driver and its dependency alone. The reason I choose xwrt over luci is purely because of the size.</p><p>Good luck to your project.</p></blockquote></div><p>I&#039;ve finally got some time for testing your config. It should be doable to rip out OpenVPN and throw in PPP instead. When you say downgrade the mac80211 package, how do I do that?</p>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 1 of 12</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=33387&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=33387&amp;p=3.html">3</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=33387&amp;p=12.html">12</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>