<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Slow LAN speed (gigabit) on 1043ND</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 5 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p175943">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">cmay</div>
					<div class="post-datetime">
						27 Aug 2012, 15:46					</div>
				</div>
				<div class="post-content content">
					<p>Greetings.</p><p>I have a 1043ND from TP-Link.<br />I installed OpenWrt on it and no matter what i do, i have problems on reaching full gigabit speed inside the LAN.<br />In order to remove disk speed from the equation i&#039;m using NetIO on my Windows machines to measure the speed at which i can communicate between them. With the stock firmware and using DD-Wrt i can easily reach over 110MBps (giving an over 95% network speed usage on the task manager). When transfering large files i can reach a high and steady speed of around 70MBps.<br />If i do that with the same router but using OpenWRT (which i would prefer using if not for this problem) i can&#039;t reach over 30 or 40MBps. The file transfers get a little less average than with the other firmwares and wuth much less stable.<br />In both situations i make the measurements right after installation and after changing the login password. No messing around on QoS, etc. I tried disabling some services on the openwrt, like the logs, etc., but to no avail.</p><p>So, my question is: why is this happening, and what can i do to avoid it?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176036">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">cmay</div>
					<div class="post-datetime">
						28 Aug 2012, 09:13					</div>
				</div>
				<div class="post-content content">
					<p>Just to clarify that i&#039;m using the latest backfire release.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176123">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">cmay</div>
					<div class="post-datetime">
						28 Aug 2012, 18:37					</div>
				</div>
				<div class="post-content content">
					<p>Noone has any idea about this?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176128">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">JaromirN</div>
					<div class="post-datetime">
						28 Aug 2012, 19:14					</div>
				</div>
				<div class="post-content content">
					<p>seems you can&#039;t reach so large number as 110Mbytes per second of&nbsp; file transfer.. Because u need&nbsp; some space also for tcp/ip handling.. so multiply&nbsp; cca by 10x&nbsp; instead of&nbsp; 8x.. in that case u are getting more than 1,1GBITS per sec. <br />Generally if u are passing data over bridge only.. my experience is almost the same ( cifs needs some bytes for protocol handling.. mainly if you are using windows). If u are passing data trough router.. the CPU isn&#039;t&nbsp; Rambo <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> u have to count less..</p>											<p class="post-edited">(Last edited by <strong>JaromirN</strong> on 28 Aug 2012, 19:28)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176141">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">cmay</div>
					<div class="post-datetime">
						28 Aug 2012, 21:03					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for your answer.<br />However, it&#039;s a bit away from my question.<br />The speed i refer is not using file transfer. That is ofc much slower, also because of disk limit.<br />I&#039;m using NetIO to measure the speed. Besides, that is not the point. The point is that using the same router (not the same model: it&#039;s the exact same machine) i get much higer speed over the gigabit LAN using the stock firmware and DD-Wrt than using openwrt (or gargoyle, for what matters). It&#039;s a huge difference.<br />Again, my question is... why? Is there anything that i need to disable on the openwrt services to obtain a speed similar to the other firmwares?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176150">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">JaromirN</div>
					<div class="post-datetime">
						28 Aug 2012, 22:26					</div>
				</div>
				<div class="post-content content">
					<p>Check real speed also. May you are not on full throttle of Eth. link speed.<br />If you have LAN ports segmented to number networks.. they will be slow due to routing.. Also check if u have Wifi on the same subnet.. if yes.. there could be impact also (switch off at test moment). Do u have all ports on full speed? Cables? Collisions?&nbsp; Could be more reasons.. I am using 1043 and it is stable but i agree not so fast like CISCO or orig. firmware. That is cost for general OS.</p>											<p class="post-edited">(Last edited by <strong>JaromirN</strong> on 28 Aug 2012, 22:43)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176163">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">cmay</div>
					<div class="post-datetime">
						29 Aug 2012, 00:14					</div>
				</div>
				<div class="post-content content">
					<p>Ok. now we are talking <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /><br />And thanks again for your answer!</p><p>Let&#039;s see: all hardware components are the same: the cables, the computers, the router. It&#039;s the same components on both tests. The only thing that changes is the firmware.<br />The router is fast enough. It can handle blazing speeds using NetIO when using the stock firmware or DD-wrt. In fact the data transfer is marginally faster on the 1043ND than through a gigabit switch i have around (used it only for &quot;benchmark&quot;, usually it&#039;s disconnected).<br />As i stated before, the only problem with speed is when using openwrt firmware. And about the processor: i tried to see the router&#039;s processor usage while doing a data transfer with openwrt and it&#039;s far from maxed.<br />Windows task manager shows it&#039;s a gigabit connection on every test. So i honestly think that i can rule out hardware-related issues.</p><p>About my lan settings: i can&#039;t be too technical, unfortunately. Let me just say that both tests are made with &quot;out of the box&quot; configurations, on the stock firmware, on the DD-wrt and on the OpenWrt. They are made right after setting a password.<br />So, this means that every connected computer is in the same subnet, being the default 192.168.1.xxx. No routing between computers.<br />Right now i have the stock firmware installed and i cannot do the wifi switch off test with openwrt. What i can do say is that i&#039;m absolutely certain that when running both stock and DD-wrt, it does not matter having the wireless on or off in terms of gigabit lan speed. Also, the wifi is on the same subnet. Of course that moving data betwen a wired client and a wireless client, i get much lower speeds. But that&#039;s not the problem.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176285">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">JaromirN</div>
					<div class="post-datetime">
						29 Aug 2012, 12:27					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>cmay wrote:</cite><blockquote><p>Ok. now we are talking <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /><br />And thanks again for your answer!</p><p>Let&#039;s see: all hardware components are the same: the cables, the computers, the router. It&#039;s the same components on both tests. The only thing that changes is the firmware.<br />The router is fast enough. It can handle blazing speeds using NetIO when using the stock firmware or DD-wrt. In fact the data transfer is marginally faster on the 1043ND than through a gigabit switch i have around (used it only for &quot;benchmark&quot;, usually it&#039;s disconnected).<br />As i stated before, the only problem with speed is when using openwrt firmware. And about the processor: i tried to see the router&#039;s processor usage while doing a data transfer with openwrt and it&#039;s far from maxed.<br />Windows task manager shows it&#039;s a gigabit connection on every test. So i honestly think that i can rule out hardware-related issues.</p><p>About my lan settings: i can&#039;t be too technical, unfortunately. Let me just say that both tests are made with &quot;out of the box&quot; configurations, on the stock firmware, on the DD-wrt and on the OpenWrt. They are made right after setting a password.<br />So, this means that every connected computer is in the same subnet, being the default 192.168.1.xxx. No routing between computers.<br />Right now i have the stock firmware installed and i cannot do the wifi switch off test with openwrt. What i can do say is that i&#039;m absolutely certain that when running both stock and DD-wrt, it does not matter having the wireless on or off in terms of gigabit lan speed. Also, the wifi is on the same subnet. Of course that moving data betwen a wired client and a wireless client, i get much lower speeds. But that&#039;s not the problem.</p></blockquote></div><p>As i said.. i am agree OpenWRT not so fast as with stock firmware.. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />.. don&#039;t forget.. original firmware has all memory dedicated for network operations mostly..OWRT not.. Also support of some 1043ND chips are not ideal yet..&nbsp; That why is nice if we have a choice..stock fmw/OWRT/DDWRT..</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176302">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">cmay</div>
					<div class="post-datetime">
						29 Aug 2012, 15:24					</div>
				</div>
				<div class="post-content content">
					<p>Ok. So, it&#039;s just a matter of optimization, and there&#039;s nothing i can do about it.<br />Too bad, because i thought i could switch off some services/functions or uninstall some components and get the speed up.<br />Unfortunately, i really need the gigabit lan to be as fast as it can, so i can&#039;t use OpenWrt for now. I really hope that this is something that get addressed, because i like it better in all other aspects.<br />Thanks for your opinion. Do you think i should try disabling something on OpenWrt in order to test the speed (besided the Wifi. I need it.)?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176491">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">cmay</div>
					<div class="post-datetime">
						31 Aug 2012, 09:52					</div>
				</div>
				<div class="post-content content">
					<p>Ok. I have an update.<br />Yesterday i installed Gargoyle (and before OpenWRT - this is happening with both) and made some random speed tests through the day.<br />Surprisingly, sometimes i could get very high file transfers, probably at least as high as with i had with stock firmware or DD-wrt.<br />I can&#039;t yet assign a cause to that, for me is still random. I can say that sometimes the file transfer is very low others is high. Also, even when i&#039;m having high file transfer speeds, the tests like iperf and NetIO show consistently very low speeds. Let me reiterate that nothing of this happens with stock or dd-wrt, where the file transfers and NetIO are always fast.<br />Also, i took the chance to make a 3~ish gigabyte file transfer while i had the speeds high between 2 wired computers and use a 3rd wired computer to check the router load while it happened. Not only messing with the web interface did nothing to upset the transfer speed, but the processor load appeared very low all the time. In fact, if i had the page still just showing the processor load, the load plummeted to around 0.10 even when the file transfer was still in high speed on other 2 lan wires.<br />On the ocasions that i was having another slow file transfer, the processor usage was about the same.<br />This tells me that the processor capability has no effect on wired lan to wired lan transfer speed. Yet, the software tests showed consistently low. Could it be that there is some sort of feature to prevent overflow to lan PCs?</p><p>JaromiN suggested that the low trasnfer speed could be because the support of these chips is not yet finely tuned. With this new data i&#039;m starting to believe that it might not be the case, or else i would not had observed high file transfer speeds.</p><p>I&#039;ll update when (if?) i reach some conclusion about what is causing this random transfer slow-ups/speed-ups. Meanwhile, if anyone, including JaromiN, (who was the only one kind enough to answer so far) has any other suggestions, please tell me. I love OpenWRT but this problem is driving me nuts.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176493">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">cmay</div>
					<div class="post-datetime">
						31 Aug 2012, 10:04					</div>
				</div>
				<div class="post-content content">
					<p>Sorry... i forgot to mention this, maybe it helps in finding an answer:<br />When idle, with no connections (like after being overnight with no clients connected) or with low workload (like only 1 PC connected browsing the internet) and no messing around on the web interface, the outside temperature is noticeably lower with OpenWRT/Gargoyle than with the stock firmware. I can&#039;t give you numbers, only the subjective feeling in my palm, but it&#039;s a considerable difference.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p200487">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">embeewee</div>
					<div class="post-datetime">
						3 May 2013, 01:38					</div>
				</div>
				<div class="post-content content">
					<p>Any news on this? I happen to have the same problem... I have two machine on the same lan, both indicated to operate at 1Gbps. File transfers seem to be capped at 100Mbps (about 11 megabytes per second)... First it seemed to be a NIC problem, the Intel 82579LM has an issue with auto negotiation and first got stuck at 100Mbps (which was also indicated by the OS). Now I forced it to 1Gbps and it looks like that&#039;s fine now. Transfer speeds still around 11 megabytes per second though.<br />Transfers from another machine also shows the 11 megabytes max...<br />Edit: transfer between the 2nd and 3rd machine (on the same switch) shows 77 MB per second, so it must be the 1043ND...</p>											<p class="post-edited">(Last edited by <strong>embeewee</strong> on 3 May 2013, 01:54)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228016">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">Sly</div>
					<div class="post-datetime">
						20 Mar 2014, 13:30					</div>
				</div>
				<div class="post-content content">
					<p>Hello there. I have a similar issue with 1043ND (1st generation).</p><p>I just had installed a 1Gb internet connection at home so I have ISPs equipment, which then connects into my 1043ND router.<br />With stock firmware on router I was able to get 110Mbs on wired and 80Mbs on wireless running internet speed test. In this scenario the network cards were negotiating 1Gb on Ethernet port and 150 Mb on wireless. I have tried to tweak settings with no avail.<br />I have then upgraded to DD-WRT software and I got 155Mbs on cable and only 40Mbs on wireless at internet speed test. After the upgrade the Ethernet card is negotiation 1Gb, but the wireless card is negotiating only 65Mb connection to the router. <br />I must also specify that if I connect the laptop to ISPs equipment directly (excluding) and run the internet speed test I get at 600Mbs or more. The cables from laptop to router and router to ISP device are the same and supporting 1Gb connection.<br />I have isolated the issue at TP Link 1043 ND level, but i&#039;m not very good in networking so not entirely sure what settings I should mess with to get it faster. <br />Issues remaining now:<br />- internet connection should get better<br />- wifi card to negotiate 300Mbs connection with the router as both devices (laptop and router) are capable. At the moment with DD-WRT is negotiating only 65Mbs.</p><p>Any ideas on how can this be improved?<br />Thank you.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228040">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">Nilfred</div>
					<div class="post-datetime">
						20 Mar 2014, 18:55					</div>
				</div>
				<div class="post-content content">
					<p>Currently (2014/03) no OpenWrt supported router supports Gbit WAN routing speed.<br />Try with so called &quot;hardware NAT&quot; routers with manufacturer firmware. Around 600 Mbps.</p><p>TL-WR1043ND V2.0 is one of mosts faster routing speed currently supported. Around 200 Mbps.</p><p>You has been <strong>downgraded</strong> to DD-WRT <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228042">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">Hausmeister</div>
					<div class="post-datetime">
						20 Mar 2014, 19:03					</div>
				</div>
				<div class="post-content content">
					<p>I only have 150 mBit/s here, but the same Problem. </p><p>TP-Link WR1043ND v1 and i only get ~120 mBit/s. With the (almost) latest OpenWRT Trunk self compiled. Softirqd is at 100% CPU Load. If i connect directly to the modem i get &gt;160 mBit/s. </p><p>It&#039;s a shame, but i think i (we) need a newer device.</p>											<p class="post-edited">(Last edited by <strong>Hausmeister</strong> on 20 Mar 2014, 19:04)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228107">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">nozombian</div>
					<div class="post-datetime">
						21 Mar 2014, 11:40					</div>
				</div>
				<div class="post-content content">
					<p>Have you tried attitude adjustment? It had better results I think when comes to NAT speed, but wifi driver is faulty.</p><p>The new v2 is probably way faster and has 64MB RAM, I will test the nat throughtput later, I&#039;ve updated the <a href="http://wiki.openwrt.org/inbox/benchmark.openssl">openssl benchmark</a> yet. V2 has hardware acceleratied NAT, which openwrt does not support, so stock firmware will always be about 5 times faster <img src="https://forum.openwrt.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /></p><p>Btw. I came to v2 this way: I have bricked my wr1043nd v1 when reverting back to stock (I don&#039;t know what went wrong, did that many times with wr841 and 741), so I sent it for replacement (it was still in 2 yrs warranty), and V2 came replaced. Free upgrade <img src="https://forum.openwrt.org/img/smilies/cool.png" width="15" height="15" alt="cool" /></p><p>edit: results</p><p>WR841n openwrt BB NAT<br /><a href="http://www.speedtest.net/my-result/3385606941"><span class="postimg"><img src="http://www.speedtest.net/result/3385606941.png" alt="http://www.speedtest.net/result/3385606941.png" /></span></a></p><p>wr1043nd v2 openwrt BB NAT<br /><a href="http://www.speedtest.net/my-result/3385610602"><span class="postimg"><img src="http://www.speedtest.net/result/3385610602.png" alt="http://www.speedtest.net/result/3385610602.png" /></span></a></p><p>wr1043nd v2 openwrt BB as a bridge (probably my MAX speed today)<br /><a href="http://www.speedtest.net/my-result/3385613514"><span class="postimg"><img src="http://www.speedtest.net/result/3385613514.png" alt="http://www.speedtest.net/result/3385613514.png" /></span></a></p><p>I think it is better to have openwrt in bridge (dumb ap mode) and do the NAT on media converter, I have mikrotik on the fibre, which comes with the service.</p>											<p class="post-edited">(Last edited by <strong>nozombian</strong> on 21 Mar 2014, 11:57)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228123">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">Sly</div>
					<div class="post-datetime">
						21 Mar 2014, 15:42					</div>
				</div>
				<div class="post-content content">
					<p>@Nilfred: what would you suggest then? What would be the best option in the scenario I have presented? Sorry for the funny question, but I&#039;m not into networking at all. Thanks in advance.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228147">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">Nilfred</div>
					<div class="post-datetime">
						21 Mar 2014, 20:43					</div>
				</div>
				<div class="post-content content">
					<p>a) 1043v2 stock firmware.<br />b) Downgrade your fiber to 200 Mbps or less.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228151">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">Sly</div>
					<div class="post-datetime">
						21 Mar 2014, 21:26					</div>
				</div>
				<div class="post-content content">
					<p>So you say v2 firmware goes fine on v1 hardware?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228164">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">Nilfred</div>
					<div class="post-datetime">
						22 Mar 2014, 02:38					</div>
				</div>
				<div class="post-content content">
					<p>Nope, not, hell no. No way.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>