<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> TCPdump crash</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 29 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p338347">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">hungrymind.bb</div>
					<div class="post-datetime">
						15 Sep 2016, 16:09					</div>
				</div>
				<div class="post-content content">
					<p>Hi,<br />I&#039;m using a TP-LINK TL-WR1043ND v2 home wireless router with OpenWRT Linux version 4.1.23 to capture the traffic in a home environment.<br />I need to capture the packets continuously for a month in 12 hours chunks.<br />So I used following command<br /></p><div class="codebox"><pre><code>tcpdump -i br-lan -w &quot;/mnt/usb/pcap/%y-%m-%d/%H_%M_%S.pcap&quot; -s0 -X -B 4096 -G 43200 2&gt;&gt;/mnt/usb/logs/log_error_$today</code></pre></div><p>In addition to that I&#039;ve set a cron job to a Kill the tcpdump at midnight 12:00AM and start a new one immediately, to make sure, I have separate files for each days.</p><p>But unfortunately, each and every day tcpdump crashing frequently. I found following in the log file<br /></p><div class="codebox"><pre><code>tcpdump: listening on br-lan, link-type EN10MB (Ethernet), capture size 65535 bytes
tcpdump: pcap_loop: corrupted frame on kernel ring mac offset 86 + caplen 3960314657 &gt; frame len 262144
4783 packets captured
4784 packets received by filter
0 packets dropped by kernel
tcpdump: listening on br-lan, link-type EN10MB (Ethernet), capture size 65535 bytes</code></pre></div><p>Is it a bug of tcpdump?<br />Why I&#039;m getting this error message<br /></p><div class="codebox"><pre><code>tcpdump: pcap_loop: corrupted frame on kernel ring mac offset 86 + caplen 3960314657 &gt; frame len 262144</code></pre></div><p>Can anybody help me to I overcome this issue please?</p><p>My tcpdump and libpcab versions are <br />tcpdump version 4.5.1<br />libpcap version 1.7.4</p>											<p class="post-edited">(Last edited by <strong>hungrymind.bb</strong> on 15 Sep 2016, 16:21)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p339611">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">hungrymind.bb</div>
					<div class="post-datetime">
						29 Sep 2016, 03:44					</div>
				</div>
				<div class="post-content content">
					<p>At last I found the solution. Its simple, I just reinstalled openwrt with a stable version(Chaos Calmer). Earlier it was Bleeding edge. Now its working perfectly.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>