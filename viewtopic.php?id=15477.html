<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Failsafe won&#039;t work, can&#039;t disable the firewall</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 6 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p67513">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">WrinkledCheese</div>
					<div class="post-datetime">
						27 Apr 2008, 22:34					</div>
				</div>
				<div class="post-content content">
					<p>Hey everyone.&nbsp; </p><p>I have a Linksys WRT54G v2.0<br />I was trying to upgrade my WRT54G from an official firmware to an official one.&nbsp; I didn&#039;t mean to install OpenWRT in the first place.&nbsp; But I know how to use many features of the Linux OS and I&#039;m familiar with the command line so it seems I have downloaded it in the past.&nbsp; One thing I am not familiar with are IPTABLES.</p><p>So, I accidentally locked myself out of my router and the internet.</p><p>I was checking around the docs and found out that I could just have the router boot without running the iptables script, allowing me access once again.&nbsp; </p><p>I have enabled and comited boot_wait, whether or not it&#039;s still set to on is a mystery.&nbsp; I may have reset the NVRAM with the reset button.</p><p>Anyway.&nbsp; I tried the following on what I believe is version 1.0 of white russian.&nbsp; The site says it&#039;s currently 0.9 RC# but when I was in the info page it said it was white russian 1.0.<br /></p><div class="codebox"><pre><code>2.1. How to get into failsafe mode
OpenWrt itself uses the reset button to enter into failsafe mode, and for no other purpose. In particular, it will not reset the NVRAM. The boot loader, however, may reset the NVRAM in response to the reset button. Therefore, it&#039;s important to know what&#039;s running when you hold down the reset button. One indicator is that OpenWrt will light the DMZ LED (on systems that have one) from the time it begins until the time the bootup scripts complete. If the DMZ LED has not yet lit up, you are still in the bootloader!
2.1.1. All Models (RC5+)
When OpenWrt boots, it will broadcast a UDP packet to port 4919 of network 192.168.1.x containing the message:
Press reset now, to enter Failsafe!
You can use the recvudp utility provided below, or a network monitor/sniffer to view the messages, for example nc -l  -p 4919 -u. Remember, your PC must be set to have an address like 192.168.1.2 When the above message appears, press and hold the reset button for 2 seconds. You should now get the message:
Entering Failsafe!</code></pre></div><p>I ran man on nc to figure out what the options were and found that I could just copy and paste.&nbsp; I ran that and almost exactly 15 seconds after I plug the router back in the DMZ light comes on and with almost no delay the message &quot;Press reset now, to enter Failsafe!&quot; apears.&nbsp; I use a watch screwdriver to push the reset and use my desktop clock to time it.&nbsp; I tried repeatedly pressing it.&nbsp; 2 seconds, until the DMZ light is off but nothing.&nbsp; I can&#039;t disable the firewall.</p><p>So I figure I have two options.<br />1)&nbsp; Figure out what&#039;s not working with the failsafe mode<br />2)&nbsp; Flash using tftp assuming the 15 seconds that the boot loader has is hopefully enough to get the tftp started and&nbsp; starting to flash.</p><p>Then there is option 3).&nbsp; I don&#039;t remember quite where I read it but I read something that if boot_wait is off there is still a way, albeit more difficult, to flash the router with a new firmware and hence a new firewall script that isn&#039;t locking me out of it.&nbsp; I was pretty sure I had included a rule for ssh from the lan but nothing is working.&nbsp; I tried connecting to both the WAN and LAN port and I can get the message at either end of the router but I can&#039;t get in through any of the ports I thought I had left open.&nbsp; Not 8080 for the webif module.&nbsp; Nothing.</p><p>Any help would be greatly appreciated.&nbsp; Everything I could find at this site hasn&#039;t worked and I am really hoping there is something I can do to get the failsafe to work.</p><p>I&#039;m going to try tftp and hope that works</p>											<p class="post-edited">(Last edited by <strong>WrinkledCheese</strong> on 27 Apr 2008, 22:37)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>