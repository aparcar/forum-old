<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> OpenWrt on TPLink MR3020 - Ushare dlna svr does not start after reboot</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 12 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p185450">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">jslefort</div>
					<div class="post-datetime">
						7 Dec 2012, 04:44					</div>
				</div>
				<div class="post-content content">
					<p>Had a bright idea to try to use the MR3020 to stream media to various devices, especially when on the road.&nbsp; Figured it was low powered enough to run easily in the car, etc...&nbsp; &nbsp;</p><p>Samba is working great, but I am trying to possibly use a streaming dlna server. My thinking is that something like ushare would be a little more efficient that file sharing using samba.&nbsp; &nbsp;I plan to have the media stored in the correct format to play, without any need to transcode.&nbsp; Ushare seems to the light weight dlna server to use and works great, but for the life of me, I can&#039;t seem to get ushare to start after a re-boot.&nbsp; &nbsp; Without it starting automically, it defeats my purpose.</p><p>From the command line, both: /etc/init.d/ushare start and Sxx script in the /etc/rc.d dirs works fine running it manually and the ushare process is shown, as well as media streaming functions; however, after the process never gets started after a reboot.</p><p>The normal auto-startl method: /etc/init.d/ushare enable&nbsp; puts the correct symbolic links in /etc/rc.d, but after a boot, I never see ushare getting started.&nbsp; &nbsp;I have also tried to put commands/scripts in the /etc/rc.local with no luck.&nbsp; </p><p>config ushare<br />&nbsp; &nbsp; &nbsp; &nbsp; option user &#039;nobody&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option servername &#039;OpenWrt&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option content_directories &#039;/mnt/usbdata/tmp&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option disable_telnet &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option disable_webif &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option username &#039;nobody&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option enabled &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option interface &#039;wlan0&#039;</p><p>when manually runing, it works great..<br />root@OpenWrt:/etc/config# ps | grep ushare<br /> 1919 nobody&nbsp; &nbsp;21764 S&nbsp; &nbsp; /usr/bin/ushare -n -v OpenWrt -i wlan0 -c /mnt/usbdata/tmp -w -t<br /> 1935 root&nbsp; &nbsp; &nbsp; 1492 S&nbsp; &nbsp; grep ushare</p><br /><p>I do notice when running manually, with verbose option,&nbsp; there&#039;s a statement about &#039;Interface wlan0 is down&#039; even though it&#039;s not and the functionality is working fine.&nbsp; Could this be the issue with it not auto-starting after a boot.&nbsp; I&#039;m lost as to what to look for after a boot.&nbsp; I put print statements in the auto-start script before and after the &#039;service_start&#039; line and I see the before/after statements I put in; however, no ushare process is started.</p><p>Any ideas?</p><br /><p>Verbose log after starting manually.&nbsp; There&#039;s a warning/error around wlan0 not being up, even though it is and the streaming works great.</p><p>root@OpenWrt:/etc/init.d#&nbsp; /usr/bin/ushare -n -v OpenWrt -i wlan0 -c /mnt/usbdata/tmp -w -t<br />Interface wlan0 is down.<br />Recheck uShare&#039;s configuration and try again !<br />uShare (version 1.1a), a lightweight UPnP A/V and DLNA Media Server.<br />Benjamin Zores (C) 2005-2007, for GeeXboX Team.<br />See <a href="http://ushare.geexbox.org/">http://ushare.geexbox.org/</a> for updates.<br />Initializing UPnP subsystem ...<br />UPnP MediaServer listening on 192.168.33.1:49153<br />Sending UPnP advertisement for device ...<br />Listening for control point connections ...</p><br /><p>wlan0&nbsp; &nbsp; &nbsp;Link encap:Ethernet&nbsp; HWaddr 90:F6:52:76:56:76<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:192.168.33.1&nbsp; Bcast:192.168.33.255&nbsp; Mask:255.255.255.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:99 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:32<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:0 (0.0 B)&nbsp; TX bytes:51232 (50.0 KiB)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p185995">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						14 Dec 2012, 08:21					</div>
				</div>
				<div class="post-content content">
					<p>What about init.d/ushare start??</p><p>Also that script has execution permission?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>