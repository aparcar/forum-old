<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Reject IP from entering WAN</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 23 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p333131">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">dirk1312</div>
					<div class="post-datetime">
						2 Aug 2016, 14:45					</div>
				</div>
				<div class="post-content content">
					<p>Hi all,</p><p>I wanted to configure the firewall&#039;s uci interface to reject a given ip from entering LAN. The &quot;speciality&quot; is, that the client that shall be blocked comes over VPN.</p><p>Therefore I added the following line to my <strong>/etc/config/firewall</strong></p><br /><div class="codebox"><pre><code>config rule
    option src &#039;vpn&#039;
    option dest &#039;lan&#039;
    option src_ip &#039;10.1.1.2&#039;
    option target &#039;REJECT&#039;</code></pre></div><p>and restarted the firewall afterwards with <strong>/etc/init.d/firewall restart</strong></p><p>Because this didn&#039;t work, I checked with which local ip the VPN client is masqued and tried this as well:</p><div class="codebox"><pre><code>config rule
    option src &#039;vpn&#039;
    option dest &#039;lan&#039;
    option src_ip &#039;10.50.50.157&#039;
    option target &#039;REJECT&#039;</code></pre></div><p>Because this didn&#039;t work neither, I tried to add the lines to several positions within the firewall file (beginning, end, middle,...) but this didn&#039;t work for me, too.</p><p>Could you please help me? Which is the correct src_ip in my case and any ideas, why this does not work?</p><p>As additional info: I checked, if I can enter the LAN after connecting via VPN by calling luci (10.50.50.1). Is that perhaps the fault, that this is not recognized as part of the LAN, since the client also needs the router?</p><p>Thanks and kind regards,</p><p>Dirk</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>