<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Q1000Z / P-870HNU-51c</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 21 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p273086">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">jewest</div>
					<div class="post-datetime">
						20 Apr 2015, 01:32					</div>
				</div>
				<div class="post-content content">
					<p>Hey everyone!</p><p>Been using OpenWRT for a while now however new to the forum and hoping to help add support for some additional devices. </p><p>Working with Zyxel model similar to others where OpenWRT has support. Provided specs below. </p><p>Model: Zyxel Q1000z / P-870HNU-51c<br />Board ID: 96368MVWG<br />Flash: MX29GL256ELT2I<br />Ram: 2x W9425G6JH-5 <br />Ethernet: BCM53115<br />Wireless: BCM43222KFBG</p><p>After trying various firmware revisions from the download section as well as a couple revisions I compiled myself I am stuck with the following kernel panic. </p><div class="codebox"><pre><code>Starting program at 0x80a00000
[    0.000000] Linux version 3.18.11 (root@kali) (gcc version 4.8.3 (OpenWrt/Linaro GCC 4.8-2014.04 r45483) ) #1 Fri Apr 17 21:18:37 CDT 2015
[    0.000000] Detected Broadcom 0x6368 CPU revision b2
[    0.000000] CPU frequency is 400 MHz
[    0.000000] 64MB of RAM installed
[    0.000000] board_bcm963xx: Boot address 0xb8000000
[    0.000000] board_bcm963xx: CFE version: 1.13.0-104.4
[    0.000000] bootconsole [early0] enabled
[    0.000000] CPU0 revision is: 0002a031 (Broadcom BMIPS4350)
[    0.000000] board: board name: P870HW-51a_v2
[    0.000000] MIPS: machine is Zyxel P870HW-51a v2
[    0.000000] Determined physical RAM map:
[    0.000000]  memory: 04000000 @ 00000000 (usable)
[    0.000000] Initrd not found or empty - disabling initrd
[    0.000000] Zone ranges:
[    0.000000]   Normal   [mem 0x00000000-0x03ffffff]
[    0.000000] Movable zone start for each node
[    0.000000] Early memory node ranges
[    0.000000]   node   0: [mem 0x00000000-0x03ffffff]
[    0.000000] Initmem setup node 0 [mem 0x00000000-0x03ffffff]
[    0.000000] Primary instruction cache 64kB, VIPT, 4-way, linesize 16 bytes.
[    0.000000] Primary data cache 32kB, 2-way, VIPT, cache aliases, linesize 16 bytes
[    0.000000] Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 16256
[    0.000000] Kernel command line:  root=/dev/mtdblock2 rootfstype=squashfs,jffs2 noinitrd console=ttyS0,115200
[    0.000000] PID hash table entries: 256 (order: -2, 1024 bytes)
[    0.000000] Dentry cache hash table entries: 8192 (order: 3, 32768 bytes)
[    0.000000] Inode-cache hash table entries: 4096 (order: 2, 16384 bytes)
[    0.000000] Memory: 59904K/65536K available (2713K kernel code, 133K rwdata, 568K rodata, 1312K init, 192K bss, 5632K reserved)
[    0.000000] NR_IRQS:256
[    0.000000] Calibrating delay loop... 397.82 BogoMIPS (lpj=795648)
[    0.036000] pid_max: default: 32768 minimum: 301
[    0.040000] Mount-cache hash table entries: 1024 (order: 0, 4096 bytes)
[    0.044000] Mountpoint-cache hash table entries: 1024 (order: 0, 4096 bytes)
[    0.052000] NET: Registered protocol family 16
[    0.060000] registering PCI controller with io_map_base unset
[    0.076000] PCI host bridge to bus 0000:00
[    0.080000] pci_bus 0000:00: root bus resource [mem 0x30000000-0x37ffffff]
[    0.084000] pci_bus 0000:00: root bus resource [io  0x8000000-0x800ffff]
[    0.088000] pci_bus 0000:00: No busn resource found for root bus, will use [bus 00-ff]
[    0.096000] pci 0000:00:01.0: BAR 0: assigned [mem 0x30000000-0x30003fff]
[    0.100000] Switched to clocksource MIPS
[    0.104000] PCI: Enabling device 0000:00:01.0 (0000 -&gt; 0002)
[    0.132000] ssb: Found chip with id 0xA8D6, rev 0x00 and package 0x08
[    0.196000] ssb: Sonics Silicon Backplane found on PCI device 0000:00:01.0
[    0.204000] NET: Registered protocol family 2
[    0.212000] TCP established hash table entries: 1024 (order: 0, 4096 bytes)
[    0.216000] TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
[    0.224000] TCP: Hash tables configured (established 1024 bind 1024)
[    0.232000] TCP: reno registered
[    0.236000] UDP hash table entries: 256 (order: 0, 4096 bytes)
[    0.240000] UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
[    0.248000] NET: Registered protocol family 1
[    0.252000] futex hash table entries: 256 (order: -1, 3072 bytes)
[    0.260000] squashfs: version 4.0 (2009/01/31) Phillip Lougher
[    0.268000] jffs2: version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006 Red Hat, Inc.
[    0.280000] msgmni has been set to 117
[    0.284000] io scheduler noop registered
[    0.288000] io scheduler deadline registered (default)
[    0.292000] bcm63xx_uart.0: ttyS0 at MMIO 0xb0000100 (irq = 10, base_baud = 1â–’[    0.304000] console [ttyS0] enabled
[    0.304000] console [ttyS0] enabled
[    0.312000] bootconsole [early0] disabled
[    0.312000] bootconsole [early0] disabled
[    0.320000] bcm63xx-rng bcm63xx-rng: registered RNG driver
[    0.328000] 18000000.nor: Found 1 x16 devices at 0x0 in 16-bit bank. Manufacturer ID 0x0000c2 Chip ID 0x00227e
[    0.336000] Amd/Fujitsu Extended Query Table at 0x0040
[    0.340000]   Amd/Fujitsu Extended Query version 1.3.
[    0.348000] number of CFI chips: 1
[    0.352000] bcm63xxpart: CFE boot tag CRC invalid (expected ffffffff, actual bc2b198b)
[    0.360000] 3 bcm63xxpart partitions found on MTD device 18000000.nor
[    0.364000] Creating 3 MTD partitions on &quot;18000000.nor&quot;:
[    0.372000] 0x000000000000-0x000000010000 : &quot;CFE&quot;
[    0.376000] 0x000000010000-0x0000003f0000 : &quot;linux&quot;
[    0.384000] mtd: partition &quot;linux&quot; must either start or end on erase block boundary or be smaller than an erase block -- forcing read-only
[    0.396000] 0x0000003f0000-0x000000400000 : &quot;nvram&quot;
[    0.404000] bcm63xx-spi bcm63xx-spi: at 0xb0000800 (irq 9, FIFOs size 542)
[    0.448000] b53_common: found switch: BCM63xx, rev 0
[    0.452000] bcm63xx-wdt bcm63xx-wdt:  started, timer margin: 30 sec
[    0.460000] TCP: cubic registered
[    0.464000] NET: Registered protocol family 17
[    0.468000] bridge: automatic filtering via arp/ip/ip6tables has been deprecated. Update your scripts to load br_netfilter if you need this.
[    0.480000] 8021q: 802.1Q VLAN Support v1.8
[    0.492000] jffs2: Too few erase blocks (1)
[    0.496000] List of all partitions:
[    0.500000] 1f00              64 mtdblock0  (driver?)
[    0.504000] 1f01            3968 mtdblock1  (driver?)
[    0.508000] 1f02              64 mtdblock2  (driver?)
[    0.516000] No filesystem could mount root, tried:  squashfs jffs2
[    0.520000] Kernel panic - not syncing: VFS: Unable to mount root fs on unknown-block(31,2)
[    0.520000] ---[ end Kernel panic - not syncing: VFS: Unable to mount root fs on unknown-block(31,2)
[   33.132000] random: nonblocking pool is initialized</code></pre></div><p>I believe this is caused by either an issue with the partition layout or incompatibility with the MX29GL256ELT2I flash. Just not sure how to verify and resolve. </p><p>I am able to boot into OpenWRT live using the vmlinux.elf loaded at CFE boot over tftp. This is a pain to set up using AT commands but it works and I assume because the flash is not involved. Also notice many devices such as wireless and Ethernet are not present when using OpenWRT live vs stock. </p><p>First &quot;live&quot;/host boot after applying OpenWRT firmware. Seems to modify the file system but does not depend on it. <br /></p><div class="codebox"><pre><code>CFE version 1.13.0-104.4 for BCM96368 (32bit,SP,BE)
Build Date: 08/17/2010 (kuanjung@MSGSW4-server2)
Copyright (C) 2000-2009 Broadcom Corporation.

Parallel flash device: name S29GL256P90, id 0x2222 size 32768KB
Total Flash size: 32768K with 256 sectors
ethsw: found bcm53115!
Chip ID: BCM6368B2, MIPS: 400MHz
Main Thread: TP0
Total Memory: 67108864 bytes (64MB)
Boot Address: 0xb8000000

Board IP address                  : 192.168.0.2:ffffff00
Host IP address                   : 192.168.0.100
Gateway IP address                : 192.168.0.1
Run from flash/host (f/h)         : f
Default host run file name        : vmlinux
Default host flash file name      : bcm963xx_fs_kernel
Boot delay (0-9 seconds)          : 5
Boot image (0=latest, 1=previous) : 0
Board Id (0-11)                   : 96368MVWG
Number of MAC Addresses (1-32)    : 4
Base MAC Address                  : 08:6c:87:6f:b0:8c
PSI Size (1-128 KBytes            : 128
Enable Backup PSI [0|1]           : 0
System Log Size (0-256) KBytes    : 0
Main Thread Number [0|1]          : 0

*** Press any key to stop auto run (5 seconds) ***
Auto run second count down: 3
web info: Waiting for connection on socket 0.
CFE&gt;
CFE&gt; ATIP
Press:  &lt;enter&gt; to use current value
        &#039;-&#039; to go previous parameter
        &#039;.&#039; to clear the current value
        &#039;x&#039; to exit this command
Board IP address                  :  192.168.0.2:ffffff00
Host IP address                   :  192.168.0.100
Gateway IP address                :  192.168.0.1
Run from flash/host (f/h)         :  f  h
Default host run file name        :  vmlinux
Default host flash file name      :  bcm963xx_fs_kernel
Boot delay (0-9 seconds)          :  5
Boot image (0=latest, 1=previous) :  0
*** command status = 0
CFE&gt; ATGO
Wait for Multiboot Service Packet...  0
0x80010000/3296796 0x80334e1c/230144 Entry at 0x80014d10
Closing network.
Disabling Switch ports.
Flushing Receive Buffers...
0 buffers found.
Closing DMA Channels.
Starting program at 0x80014d10
[    0.000000] Linux version 3.10.49 (jeff@kali) (gcc version 4.8.3 (OpenWrt/Lin                 aro GCC 4.8-2014.04 r44952) ) #1 Sat Apr 18 00:02:23 CDT 2015
[    0.000000] Detected Broadcom 0x6368 CPU revision b2
[    0.000000] CPU frequency is 400 MHz
[    0.000000] 64MB of RAM installed
[    0.000000] registering 38 GPIOs
[    0.000000] board_bcm963xx: Boot address 0xb8000000
[    0.000000] board_bcm963xx: CFE version: 1.13.0-104.4
[    0.000000] bootconsole [early0] enabled
[    0.000000] CPU revision is: 0002a031 (Broadcom BMIPS4350)
[    0.000000] board: board name: 96368MVWG
[    0.000000] Determined physical RAM map:
[    0.000000]  memory: 04000000 @ 00000000 (usable)
[    0.000000] Initrd not found or empty - disabling initrd
[    0.000000] Zone ranges:
[    0.000000]   Normal   [mem 0x00000000-0x03ffffff]
[    0.000000] Movable zone start for each node
[    0.000000] Early memory node ranges
[    0.000000]   node   0: [mem 0x00000000-0x03ffffff]
[    0.000000] Primary instruction cache 64kB, VIPT, 4-way, linesize 16 bytes.
[    0.000000] Primary data cache 32kB, 2-way, VIPT, cache aliases, linesize 16                  bytes
[    0.000000] Built 1 zonelists in Zone order, mobility grouping on.  Total pag                 es: 16256
[    0.000000] Kernel command line:  root=/dev/mtdblock2 rootfstype=squashfs,jff                 s2 noinitrd console=ttyS0,115200
[    0.000000] PID hash table entries: 256 (order: -2, 1024 bytes)
[    0.000000] Dentry cache hash table entries: 8192 (order: 3, 32768 bytes)
[    0.000000] Inode-cache hash table entries: 4096 (order: 2, 16384 bytes)
[    0.000000] Memory: 61400k/65536k available (2353k kernel code, 4136k reserve                 d, 621k data, 288k init, 0k highmem)
[    0.000000] NR_IRQS:256
[    0.000000] Calibrating delay loop... 397.82 BogoMIPS (lpj=795648)
[    0.032000] pid_max: default: 32768 minimum: 301
[    0.036000] Mount-cache hash table entries: 512
[    0.044000] NET: Registered protocol family 16
[    0.052000] registering PCI controller with io_map_base unset
[    0.060000] bio: create slab &lt;bio-0&gt; at 0
[    0.064000] PCI host bridge to bus 0000:00
[    0.068000] pci_bus 0000:00: root bus resource [mem 0x30000000-0x37ffffff]
[    0.072000] pci_bus 0000:00: root bus resource [io  0x8000000-0x800ffff]
[    0.076000] pci_bus 0000:00: No busn resource found for root bus, will use [b                 us 00-ff]
[    0.092000] pci 0000:00:01.0: BAR 0: assigned [mem 0x30000000-0x30003fff]
[    0.096000] Switching to clocksource MIPS
[    0.104000] PCI: Enabling device 0000:00:01.0 (0000 -&gt; 0002)
[    0.132000] ssb: Found chip with id 0xA8D6, rev 0x00 and package 0x08
[    0.196000] ssb: Sonics Silicon Backplane found on PCI device 0000:00:01.0
[    0.204000] NET: Registered protocol family 2
[    0.208000] TCP established hash table entries: 512 (order: 0, 4096 bytes)
[    0.216000] TCP bind hash table entries: 512 (order: -1, 2048 bytes)
[    0.224000] TCP: Hash tables configured (established 512 bind 512)
[    0.228000] TCP: reno registered
[    0.232000] UDP hash table entries: 256 (order: 0, 4096 bytes)
[    0.240000] UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
[    0.248000] NET: Registered protocol family 1
[    0.252000] squashfs: version 4.0 (2009/01/31) Phillip Lougher
[    0.260000] jffs2: version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORIT                 Y) (c) 2001-2006 Red Hat, Inc.
[    0.272000] msgmni has been set to 119
[    0.276000] io scheduler noop registered
[    0.280000] io scheduler deadline registered (default)
[    0.284000] bcm63xx_uart.0: ttyS0 at MMIO 0xb0000100 (irq = 10) is a bcm63xx_                 â–’[    0.292000] console [ttyS0] enabled, bootconsole disabled
[    0.292000] console [ttyS0] enabled, bootconsole disabled
[    0.304000] bcm63xx-rng bcm63xx-rng: registered RNG driver
[    0.312000] physmap platform flash device: 08000000 at 18000000
[    0.320000] physmap-flash.0: Found 1 x16 devices at 0x0 in 16-bit bank. Manuf                 acturer ID 0x0000c2 Chip ID 0x00227e
[    0.332000] Amd/Fujitsu Extended Query Table at 0x0040
[    0.336000]   Amd/Fujitsu Extended Query version 1.3.
[    0.340000] number of CFI chips: 1
[    0.344000] bcm63xxpart: CFE boot tag found with version 6 and board type 963                 68VVW
[    0.352000] bcm63xxpart: Partition 0 is CFE offset 0 and length 20000
[    0.360000] bcm63xxpart: Partition 1 is kernel offset 20100 and length 128e20
[    0.364000] bcm63xxpart: Partition 2 is rootfs offset 148f20 and length 1e970                 e0
[    0.372000] bcm63xxpart: Partition 3 is nvram offset 1fe0000 and length 20000
[    0.380000] bcm63xxpart: Partition 4 is linux offset 20000 and length 1fc0000
[    0.388000] bcm63xxpart: Spare partition is offset 400004 and length 1bdfffc
[    0.396000] 5 bcm63xxpart partitions found on MTD device physmap-flash.0
[    0.404000] Creating 5 MTD partitions on &quot;physmap-flash.0&quot;:
[    0.408000] 0x000000000000-0x000000020000 : &quot;CFE&quot;
[    0.416000] 0x000000020100-0x000000148f20 : &quot;kernel&quot;
[    0.420000] mtd: partition &quot;kernel&quot; must either start or end on erase block b                 oundary or be smaller than an erase block -- forcing read-only
[    0.436000] 0x000000148f20-0x000001fe0000 : &quot;rootfs&quot;
[    0.440000] mtd: partition &quot;rootfs&quot; must either start or end on erase block b                 oundary or be smaller than an erase block -- forcing read-only
[    0.456000] mtd: device 2 (rootfs) set to be root filesystem
[    0.460000] mtd: partition &quot;rootfs_data&quot; created automatically, ofs=0x400000,                  len=0x1be0000
[    0.468000] 0x000000400000-0x000001fe0000 : &quot;rootfs_data&quot;
[    0.476000] 0x000001fe0000-0x000002000000 : &quot;nvram&quot;
[    0.484000] 0x000000020000-0x000001fe0000 : &quot;linux&quot;
[    0.492000] bcm63xx-spi bcm63xx-spi: at 0xb0000800 (irq 9, FIFOs size 542)
[    0.540000] b53_common: found switch: BCM63xx, rev 0
[    0.544000] bcm63xx-wdt bcm63xx-wdt:  started, timer margin: 30 sec
[    0.556000] TCP: cubic registered
[    0.556000] NET: Registered protocol family 17
[    0.564000] 8021q: 802.1Q VLAN Support v1.8
[    0.576000] VFS: Mounted root (squashfs filesystem) readonly on device 31:2.
[    0.584000] Freeing unused kernel memory: 288K (802f8000 - 80340000)
[    1.916000] init: failed to symlink /tmp -&gt; /var
[    1.920000] init: Console is alive
[    1.924000] init: - watchdog -
[    2.928000] init: - preinit -
Press the [f] key and hit [enter] to enter failsafe mode
Press the [1], [2], [3] or [4] key and hit [enter] to select the debug level
[    6.800000] mount_root: jffs2 not ready yet, using temporary tmpfs overlay
ifconfig: SIOCGIFFLAGS: No such device
[    6.832000] procd: - early -
[    6.836000] procd: - watchdog -
[    7.616000] procd: - ubus -
[    8.628000] procd: - init -
Please press Enter to activate this console.
[   17.524000] jffs2_scan_eraseblock(): End of filesystem marker found at 0x0
[   17.536000] jffs2_build_filesystem(): unlocking the mtd device... done.
[   17.540000] jffs2_build_filesystem(): erasing all blocks after the end marker                 ... done.
[  193.508000] jffs2: notice: (605) jffs2_build_xattr_subsystem: complete building xattr subsystem, 0 of xdatum (0 unchecked, 0 orphan) and 0 of xref (0 dead, 0 orphan) found.



BusyBox v1.23.2 (2015-04-17 21:05:32 CDT) built-in shell (ash)

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 -----------------------------------------------------
 CHAOS CALMER (Bleeding Edge, r45483)
 -----------------------------------------------------
  * 1 1/2 oz Gin            Shake with a glassful
  * 1/4 oz Triple Sec       of broken ice and pour
  * 3/4 oz Lime Juice       uâ–’â–’Kâ–’â–’Ñ¹
  * 1 1/2 oz Orange Juice
  * 1 tsp. Grenadine Syrup
 -----------------------------------------------------
root@OpenWrt:/#</code></pre></div><p>ls /dev - Stock (Qwest / Zyxel) firmware<br /></p><div class="codebox"><pre><code># ls -l /dev
crw-rw-r--    1 admin    root     222,   0 Jan  3  2011 ac97
crw-rw-r--    1 admin    root     212,   0 Jan  3  2011 bcm
crw-rw-r--    1 admin    root     236,   0 Jan  3  2011 bcm_omci
crw-rw-r--    1 admin    root     237,   0 Jan  3  2011 bcm_ploam
crw-rw-r--    1 admin    root     235,   0 Jan  3  2011 bcm_user_ploam
crw-rw-r--    1 admin    root     210,   0 Jan  3  2011 bcmaal20
crw-rw-r--    1 admin    root     208,   0 Jan  3  2011 bcmadsl0
crw-rw-r--    1 admin    root     208,   1 Jan  3  2011 bcmadsl1
crw-rw-r--    1 admin    root     205,   0 Jan  3  2011 bcmatm0
crw-rw-r--    1 admin    root     226,   0 Jan  3  2011 bcmatmb0
crw-rw-r--    1 admin    root     209,   0 Jan  3  2011 bcmendpoint0
crw-rw-r--    1 admin    root     241,   0 Jan  3  2011 bcmfap
crw-rw-r--    1 admin    root     231,   0 Jan  3  2011 bcmgpon
crw-rw-r--    1 admin    root     229,   0 Jan  3  2011 bcmgpon_bar3
crw-rw-r--    1 admin    root     230,   0 Jan  3  2011 bcmgpon_ploam
crw-rw-r--    1 admin    root     211,   0 Jan  3  2011 bcmles0
crw-rw-r--    1 admin    root     234,   0 Jan  3  2011 bcmmoca0
crw-rw-r--    1 admin    root     224,   0 Jan  3  2011 bcmprof
crw-rw-r--    1 admin    root     207,   0 Jan  3  2011 bcmvdsl0
crw-rw-r--    1 admin    root     238,   0 Jan  3  2011 bcmvlan
crw-rw-r--    1 admin    root     228,   0 Jan  3  2011 bcmxtmcfg0
crw-rw-r--    1 admin    root     213,   0 Jan  3  2011 bounce
crw-rw-r--    1 admin    root     206,   0 Jan  3  2011 brcmboard
crw-rw-r--    1 admin    root      68,   0 Jan  3  2011 capi20
crw-rw-r--    1 admin    root       5,   1 Jan  1 00:00 console
crw-rw-r--    1 admin    root     242,   0 Jan  3  2011 fcache
lrwxrwxrwx    1 admin    root            9 Jan  3  2011 fuse -&gt; /var/fuse
crw-rw-r--    1 admin    root      10, 183 Jan  3  2011 hwrandom
crw-rw-r--    1 admin    root      89,   0 Jan  3  2011 i2c-0
prw-rw-r--    1 admin    root            0 Jan  3  2011 initctl
crw-rw-r--    1 admin    root      45, 128 Jan  3  2011 ippp0
crw-rw-r--    1 admin    root      45, 129 Jan  3  2011 ippp1
crw-rw-r--    1 admin    root      45,   0 Jan  3  2011 isdn
crw-rw-r--    1 admin    root      45,  64 Jan  3  2011 isdnctrl
crw-rw-r--    1 admin    root      45,  64 Jan  3  2011 isdnctrl0
crw-rw-r--    1 admin    root      45, 255 Jan  3  2011 isdninfo
crw-rw-r--    1 admin    root       1,   2 Jan  3  2011 kmem
crw-rw-r--    1 admin    root     125,   0 Jan  3  2011 linux-uk-proxy
crw-rw-r--    1 admin    root     126,   0 Jan  3  2011 linux-user-bde
lrwxrwxrwx    1 admin    root           12 Jan  3  2011 log -&gt; /var/log/log
crw-rw-r--    1 admin    root       1,   1 Jan  3  2011 mem
drwxrwxr-x    2 admin    root           21 Jan  3  2011 misc
crw-rw-r--    1 admin    root      90,   0 Jan  3  2011 mtd0
crw-rw-r--    1 admin    root      90,   2 Jan  3  2011 mtd1
brw-rw-r--    1 admin    root      31,   0 Jan  3  2011 mtdblock0
brw-rw-r--    1 admin    root      31,   1 Jan  3  2011 mtdblock1
brw-rw-r--    1 admin    root      31,   2 Jan  3  2011 mtdblock2
brw-rw-r--    1 admin    root      31,   3 Jan  3  2011 mtdblock3
brw-rw-r--    1 admin    root      31,   4 Jan  3  2011 mtdblock4
brw-rw-r--    1 admin    root      31,   5 Jan  3  2011 mtdblock5
brw-rw-r--    1 admin    root      31,   6 Jan  3  2011 mtdblock6
brw-rw-r--    1 admin    root      31,   7 Jan  3  2011 mtdblock7
crw-rw-r--    1 admin    root       1,   3 Jan  3  2011 null
crw-rw-r--    1 admin    root     227,   0 Jan  3  2011 p8021ag0
crw-rw-r--    1 admin    root     232,   0 Jan  3  2011 pktcmf
crw-rw-r--    1 admin    root     214,   0 Jan  3  2011 pmon
crw-rw-r--    1 admin    root       1,   4 Jan  3  2011 port
crw-rw-r--    1 admin    root     108,   0 Jan  3  2011 ppp
crw-rw-r--    1 admin    root     180,   0 Jan  3  2011 printer0
crw-rw-r--    1 admin    root       5,   2 Jan  3  2011 ptmx
crw-rw-r--    1 admin    root       2,   0 Jan  3  2011 ptyp0
crw-rw-r--    1 admin    root       2,   1 Jan  3  2011 ptyp1
crw-rw-r--    1 admin    root     240,   0 Jan  3  2011 pwrmngt
lrwxrwxrwx    1 admin    root            4 Jan  3  2011 ram -&gt; ram1
brw-rw-r--    1 admin    root       1,   0 Jan  3  2011 ram0
brw-rw-r--    1 admin    root       1,   1 Jan  3  2011 ram1
brw-rw-r--    1 admin    root       1,   2 Jan  3  2011 ram2
brw-rw-r--    1 admin    root       1,   3 Jan  3  2011 ram3
crw-rw-r--    1 admin    root       1,   8 Jan  3  2011 random
brw-rw-r--    1 admin    root       8,   0 Jan  3  2011 sda0
brw-rw-r--    1 admin    root       8,   1 Jan  3  2011 sda1
brw-rw-r--    1 admin    root       8,   2 Jan  3  2011 sda2
brw-rw-r--    1 admin    root       8,   3 Jan  3  2011 sda3
brw-rw-r--    1 admin    root       8,   4 Jan  3  2011 sda4
brw-rw-r--    1 admin    root       8,  16 Jan  3  2011 sdb0
brw-rw-r--    1 admin    root       8,  17 Jan  3  2011 sdb1
brw-rw-r--    1 admin    root       8,  18 Jan  3  2011 sdb2
brw-rw-r--    1 admin    root       8,  19 Jan  3  2011 sdb3
brw-rw-r--    1 admin    root       8,  20 Jan  3  2011 sdb4
brw-rw-r--    1 admin    root       8,  32 Jan  3  2011 sdc0
brw-rw-r--    1 admin    root       8,  33 Jan  3  2011 sdc1
brw-rw-r--    1 admin    root       8,  34 Jan  3  2011 sdc2
brw-rw-r--    1 admin    root       8,  48 Jan  3  2011 sdd0
brw-rw-r--    1 admin    root       8,  49 Jan  3  2011 sdd1
brw-rw-r--    1 admin    root       8,  50 Jan  3  2011 sdd2
brw-rw-r--    1 admin    root       8,  64 Jan  3  2011 sde0
brw-rw-r--    1 admin    root       8,  65 Jan  3  2011 sde1
brw-rw-r--    1 admin    root       8,  66 Jan  3  2011 sde2
brw-rw-r--    1 admin    root       8,  80 Jan  3  2011 sdf0
brw-rw-r--    1 admin    root       8,  81 Jan  3  2011 sdf1
brw-rw-r--    1 admin    root       8,  82 Jan  3  2011 sdf2
brw-rw-r--    1 admin    root       8,  96 Jan  3  2011 sdg0
brw-rw-r--    1 admin    root       8,  97 Jan  3  2011 sdg1
brw-rw-r--    1 admin    root       8,  98 Jan  3  2011 sdg2
brw-rw-r--    1 admin    root       8, 112 Jan  3  2011 sdh0
brw-rw-r--    1 admin    root       8, 113 Jan  3  2011 sdh1
brw-rw-r--    1 admin    root       8, 114 Jan  3  2011 sdh2
crw-rw-r--    1 admin    root     225,   0 Jan  3  2011 si3215
crw-rw-r--    1 admin    root     223,   0 Jan  3  2011 slac
crw-rw-r--    1 admin    root     233,   0 Jan  3  2011 spu
crw-rw-r--    1 admin    root       5,   0 Jan  1 00:06 tty
crw-rw-r--    1 admin    root       4,   0 Jan  3  2011 tty0
crw-rw-r--    1 admin    root       4,   1 Jan  3  2011 tty1
crw-rw-r--    1 admin    root       4,  64 Jan  1 00:06 ttyS0
crw-rw-r--    1 admin    root       4,  65 Jan  3  2011 ttyS1
crw-rw-r--    1 admin    root       3,   0 Jan  3  2011 ttyp0
crw-rw-r--    1 admin    root       3,   1 Jan  3  2011 ttyp1
crw-rw-r--    1 admin    root     254,   0 Jan  3  2011 ubi0
crw-rw-r--    1 admin    root      10,  63 Jan  3  2011 ubi_ctrl
crw-rw-r--    1 admin    root       1,   9 Jan  3  2011 urandom
crw-rw-r--    1 admin    root       1,   5 Jan  3  2011 zero
#</code></pre></div><p>s /dev - Custom OpenWRT<br /></p><div class="codebox"><pre><code>root@OpenWrt:/# ls -l /dev
crw-r--r--    1 root     root        5,   1 Jan  1  1970 console
crw-r--r--    1 root     root       10,  63 Jan  1  1970 cpu_dma_latency
crw-rw-rw-    1 root     root        1,   7 Jan  1  1970 full
crw-r--r--    1 root     root       10, 183 Jan  1  1970 hwrng
crw-r--r--    1 root     root        1,  11 Jan  1  1970 kmsg
srw-rw-rw-    1 root     root             0 Apr 18 02:14 log
crw-r--r--    1 root     root        1,   1 Jan  1  1970 mem
crw-r--r--    1 root     root       90,   0 Jan  1  1970 mtd0
crw-r--r--    1 root     root       90,   1 Jan  1  1970 mtd0ro
crw-r--r--    1 root     root       90,   2 Jan  1  1970 mtd1
crw-r--r--    1 root     root       90,   3 Jan  1  1970 mtd1ro
crw-r--r--    1 root     root       90,   4 Jan  1  1970 mtd2
crw-r--r--    1 root     root       90,   5 Jan  1  1970 mtd2ro
crw-r--r--    1 root     root       90,   6 Jan  1  1970 mtd3
crw-r--r--    1 root     root       90,   7 Jan  1  1970 mtd3ro
crw-r--r--    1 root     root       90,   8 Jan  1  1970 mtd4
crw-r--r--    1 root     root       90,   9 Jan  1  1970 mtd4ro
crw-r--r--    1 root     root       90,  10 Jan  1  1970 mtd5
crw-r--r--    1 root     root       90,  11 Jan  1  1970 mtd5ro
brw-r--r--    1 root     root       31,   0 Jan  1  1970 mtdblock0
brw-r--r--    1 root     root       31,   1 Jan  1  1970 mtdblock1
brw-r--r--    1 root     root       31,   2 Jan  1  1970 mtdblock2
brw-r--r--    1 root     root       31,   3 Jan  1  1970 mtdblock3
brw-r--r--    1 root     root       31,   4 Jan  1  1970 mtdblock4
brw-r--r--    1 root     root       31,   5 Jan  1  1970 mtdblock5
crw-r--r--    1 root     root       10,  62 Jan  1  1970 network_latency
crw-r--r--    1 root     root       10,  61 Jan  1  1970 network_throughput
crw-rw-rw-    1 root     root        1,   3 Jan  1  1970 null
crw-r--r--    1 root     root        1,   4 Jan  1  1970 port
crw-rw-rw-    1 root     root        5,   2 Jan  1  1970 ptmx
drwxr-xr-x    2 root     root             0 Jan  1  1970 pts
crw-r--r--    1 root     root        1,   8 Jan  1  1970 random
lrwxrwxrwx    1 root     root            14 Apr 18 02:14 root -&gt; /dev/mtdblock2
drwxr-xr-x    2 root     root            40 Jan  1  1970 shm
crw-r--r--    1 root     root        5,   0 Jan  1  1970 tty
crw-r--r--    1 root     root        4,  64 Apr 18 02:19 ttyS0
crw-r--r--    1 root     root        1,   9 Jan  1  1970 urandom
crw-r--r--    1 root     root       10, 130 Jan  1  1970 watchdog
crw-rw-rw-    1 root     root        1,   5 Jan  1  1970 zero</code></pre></div><p>I figure I will have to compile some drivers for the various missing devices but that should not be an issue - although I am surprised the the LAN at least is not working. I also tried the standard b43 driver when compiling but no luck - not sure if this is because its running live or what.. </p><p>I think the first issue to resolve is the kernel panic though.. Hoping it is trivial but and guidance would be appreciated!!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p273292">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">eliazu</div>
					<div class="post-datetime">
						21 Apr 2015, 16:52					</div>
				</div>
				<div class="post-content content">
					<p>hey,</p><p>which various firmware revisions have you tried?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p273759">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">jewest</div>
					<div class="post-datetime">
						24 Apr 2015, 17:03					</div>
				</div>
				<div class="post-content content">
					<p>The two main ones I was trying were.</p><p>openwrt-96368MVWG-generic-squashfs-cfe.bin&nbsp; <br />openwrt-P870HW-51a_v2-squashfs-zyxcfe.bin</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p273871">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">alekseymmntv</div>
					<div class="post-datetime">
						25 Apr 2015, 09:17					</div>
				</div>
				<div class="post-content content">
					<p>Hi. Sorry for my bad English. I think it is useful to look at:&nbsp; &nbsp;<a href="http://foro.seguridadwireless.net/openwrt/%28desarrollo%29-openwrt-en-zyxel-p870hnu-51b/">http://foro.seguridadwireless.net/openw â€¦ 70hnu-51b/</a> <br />My question is - as you have entered the firmware?&nbsp; This way I have does not work -<br />Unplug the power source<br />Press the RESET button at the router, don&#039;t release it yet!<br />Plug the power source<br />Wait some seconds<br />Release the RESET button<br />Browse to 192.168.1.1</p><p>Explain step by step please.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p275042">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">jewest</div>
					<div class="post-datetime">
						4 May 2015, 03:10					</div>
				</div>
				<div class="post-content content">
					<p>Flash is easy.. I was able to use steps documented in the forum below with good success. </p><p><a href="http://forum.kitz.co.uk/index.php?topic=13939.0">http://forum.kitz.co.uk/index.php?topic=13939.0</a></p><br /><p>If anyone is interested I was able to get a copy of the GPL source files for this device. Just not sure where to go from here. I am able to build the stock firmware but even that has issues upon boot - thinking this is because the cross-tools are pretty old compared to my dev system but thankfully openwrt has a more current toolchain if I can just get it to work for this model.. </p><p>Source package - <a href="https://drive.google.com/file/d/0B3Y7ZFhM58OSLWY0UTRGSjFFbTQ/view?usp=sharing">https://drive.google.com/file/d/0B3Y7ZF â€¦ sp=sharing</a></p><br /><p>I feel like there was an attempt to document the overall process below however I found this this be somewhat unclear.&nbsp; </p><p><a href="http://wiki.openwrt.org/doc/devel/add.new.device">http://wiki.openwrt.org/doc/devel/add.new.device</a></p>											<p class="post-edited">(Last edited by <strong>jewest</strong> on 4 May 2015, 03:12)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p275051">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">jewest</div>
					<div class="post-datetime">
						4 May 2015, 05:48					</div>
				</div>
				<div class="post-content content">
					<p>Draft has been added to wiki toh:wip</p><p><a href="http://wiki.openwrt.org/toh/zyxel/p-870hnu-51c">http://wiki.openwrt.org/toh/zyxel/p-870hnu-51c</a></p><p>Will keep updated as we progress.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p275143">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">danitool</div>
					<div class="post-datetime">
						4 May 2015, 20:46					</div>
				</div>
				<div class="post-content content">
					<p>Hi <strong>jewest</strong>, thanks for the info at the wiki, it makes easier to know the router features.</p><p>About the kernel panic, probably you didn&#039;t define correctly the mtd partitions, mtd0 should be 0x020000 size. </p><p>I also noticed the Board ID is wrong. It&#039;s a common manufacturer&#039;s fault, there are lot of BCM6368 based routers with this board ID but with a different layout. Therefore you shouldn&#039;t use it, use a custom one instead</p><p>Finally in your bootlog I don&#039;t see the BCM63115 Gigabit switch detected, it should be detected via SPI interface (using slave select 0).</p><p>As an example here you can see a patch for supporting a similar router, also with a wrong board ID and a BCM53115 switch (but this one is connected to the SPI slave select 1)</p><p><a href="https://dev.openwrt.org/changeset/44831">https://dev.openwrt.org/changeset/44831</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p275222">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">jewest</div>
					<div class="post-datetime">
						5 May 2015, 08:16					</div>
				</div>
				<div class="post-content content">
					<p>I can probably get a good start then since the patch code under 44831 seems close to this model. </p><p>This may be a rookie question but to make b53-switch probe spi0,0 would I create a new patch similar to the code below?<br /></p><div class="codebox"><pre><code>ndex: arch/mips/bcm63xx/boards/board_bcm963xx.c
===================================================================
--- a/arch/mips/bcm63xx/boards/board_bcm963xx.c
+++ b/arch/mips/bcm63xx/boards/board_bcm963xx.c
@@ -2132,6 +2132,48 @@
         .has_ehci0 = 1,
 };
 
+static struct b53_platform_data P870HNU-51c_b53_pdata = {
+        .alias    = &quot;eth0&quot;,
+};
+
+static struct spi_board_info P870HNU-51c_spi_devices[] = {
+        {
+                .modalias = &quot;b53-switch&quot;,
+                .max_speed_hz = 781000,
+                .bus_num = 0,
+                .chip_select = 1,
+                .platform_data = &amp;DGND3700v1_3800B_b53_pdata,
+        }
+};
+
+static struct board_info __initdata board_P870HNU-51c = {
+        .name                           = &quot;P870HNU-51c&quot;,
+        .expected_cpu_id                = 0x6368,
+
+        .has_uart0                      = 1,
+        .has_pci                        = 1,
+        .has_ohci0                      = 1,
+        .has_ehci0                      = 1,
+        .num_usbh_ports                 = 2,
+
+        .has_enetsw                     = 1,
+        .enetsw = {
+                .used_ports = {
+                        [5] = {
+                                .used  = 1,
+                                .phy_id  = 0xff,
+                                .bypass_link = 1,
+                                .force_speed = 1000,
+                                .force_duplex_full = 1,
+                                .name  = &quot;RGMII&quot;,
+                        },
+                },
+        },
+
+        .spis = P870HNU-51c_spi_devices,
+        .num_spis = ARRAY_SIZE(P870HNU-51c_spi_devices),
+};
+
 static struct sprom_fixup __initdata vr3025u_fixups[] = {
         { .offset = 97, .value = 0xfeb3 },
         { .offset = 98, .value = 0x1618 },
@@ -2723,6 +2765,7 @@
 #ifdef CONFIG_BCM63XX_CPU_6368
         &amp;board_96368mvwg,
         &amp;board_96368mvngr,
+        &amp;board_DGND3700v1_3800B,
         &amp;board_P870HW51A_V2,
         &amp;board_VR3025u,
         &amp;board_VR3025un,
         &amp;board_P870HNU-51c,
@@ -2813,6 +2856,7 @@
         { .compatible = &quot;comtrend,vr-3025u&quot;, .data = &amp;board_VR3025u, },
         { .compatible = &quot;comtrend,vr-3025un&quot;, .data = &amp;board_VR3025un, },
         { .compatible = &quot;comtrend,wap-5813n&quot;, .data = &amp;board_WAP5813n, },
+        { .compatible = &quot;netgear,dgnd3700v1&quot;, .data = &amp;board_DGND3700v1_3800B, },
         { .compatible = &quot;zyxel,p870hw-51a-v2&quot;, .data = &amp;board_P870HW51A_V2, },
         { .compatible = &quot;zyxel,p970hnu-51c&quot;, .data = &amp;board_P870HNU-51c, },
 #endif
 #ifdef CONFIG_BCM63XX_CPU_63268</code></pre></div><br /><p>I did try the latest trunk this evening built for the DGND3700v1 however did not have much improvement. Full boot log below. </p><div class="codebox"><pre><code>CFE&gt; ATTR openwrt-DGND3700v1_3800B-squashfs-cfe.bin
Loading 192.168.0.100:openwrt-DGND3700v1_3800B-squashfs-cfe.bin ...
Finished loading 6815748 bytes

Flashing root file system and kernel at 0xb9000000:
.....................................................

.
*** Image flash done *** !

Resetting board...â–’

CFE version 1.13.0-104.4 for BCM96368 (32bit,SP,BE)
Build Date: 08/17/2010 (kuanjung@MSGSW4-server2)
Copyright (C) 2000-2009 Broadcom Corporation.

Parallel flash device: name S29GL256P90, id 0x2222 size 32768KB
Total Flash size: 32768K with 256 sectors
ethsw: found bcm53115!
Chip ID: BCM6368B2, MIPS: 400MHz
Main Thread: TP0
Total Memory: 67108864 bytes (64MB)
Boot Address: 0xb8000000

Board IP address                  : 192.168.0.2:ffffff00
Host IP address                   : 192.168.0.100
Gateway IP address                : 192.168.0.1
Run from flash/host (f/h)         : f
Default host run file name        : vmlinux
Default host flash file name      : bcm963xx_fs_kernel
Boot delay (0-9 seconds)          : 5
Boot image (0=latest, 1=previous) : 0
Board Id (0-11)                   : 96368MVWG
Number of MAC Addresses (1-32)    : 4
Base MAC Address                  : 08:6c:87:6f:b0:8c
PSI Size (1-128 KBytes            : 128
Enable Backup PSI [0|1]           : 0
System Log Size (0-256) KBytes    : 0
Main Thread Number [0|1]          : 0

*** Press any key to stop auto run (5 seconds) ***
Auto run second count down: 0
Checking Reset button on GPIO 34
Wait for Multiboot Service Packet...  0
flash_addr_kernel b9000100
Booting from latest image (0xb9000000) ...
Code Address: 0x80A00000, Entry Address: 0x80a00000
LZMA: Prossible old LZMA format, trying to decompress..
Decompression OK!
Entry at 0x80a00000
Closing network.
Disabling Switch ports.
Flushing Receive Buffers...
45 buffers found.
Closing DMA Channels.
Starting program at 0x80a00000
[    0.000000] Linux version 3.18.11 (jeff@jeff-Virtual-Machine) (gcc version 4. 8.3 (OpenWrt/Linaro GCC 4.8-2014.04 r45605) ) #1 Mon May 4 22:24:56 CDT 2015
[    0.000000] Detected Broadcom 0x6368 CPU revision b2
[    0.000000] CPU frequency is 400 MHz
[    0.000000] 64MB of RAM installed
[    0.000000] board_bcm963xx: Boot address 0xb8000000
[    0.000000] board_bcm963xx: CFE version: 1.13.0-104.4
[    0.000000] bootconsole [early0] enabled
[    0.000000] CPU0 revision is: 0002a031 (Broadcom BMIPS4350)
[    0.000000] board: board name: DGND3700v1_3800B
[    0.000000] MIPS: machine is Netgear DGND3700v1/DGND3800B
[    0.000000] Determined physical RAM map:
[    0.000000]  memory: 04000000 @ 00000000 (usable)
[    0.000000] Initrd not found or empty - disabling initrd
[    0.000000] Zone ranges:
[    0.000000]   Normal   [mem 0x00000000-0x03ffffff]
[    0.000000] Movable zone start for each node
[    0.000000] Early memory node ranges
[    0.000000]   node   0: [mem 0x00000000-0x03ffffff]
[    0.000000] Initmem setup node 0 [mem 0x00000000-0x03ffffff]
[    0.000000] Primary instruction cache 64kB, VIPT, 4-way, linesize 16 bytes.
[    0.000000] Primary data cache 32kB, 2-way, VIPT, cache aliases, linesize 16  bytes
[    0.000000] Built 1 zonelists in Zone order, mobility grouping on.  Total pag es: 16256
[    0.000000] Kernel command line:  root=/dev/mtdblock2 rootfstype=squashfs,jff s2 noinitrd console=ttyS0,115200
[    0.000000] PID hash table entries: 256 (order: -2, 1024 bytes)
[    0.000000] Dentry cache hash table entries: 8192 (order: 3, 32768 bytes)
[    0.000000] Inode-cache hash table entries: 4096 (order: 2, 16384 bytes)
[    0.000000] Memory: 59964K/65536K available (2656K kernel code, 132K rwdata,  560K rodata, 1316K init, 192K bss, 5572K reserved)
[    0.000000] NR_IRQS:256
[    0.000000] Calibrating delay loop... 397.82 BogoMIPS (lpj=795648)
[    0.036000] pid_max: default: 32768 minimum: 301
[    0.040000] Mount-cache hash table entries: 1024 (order: 0, 4096 bytes)
[    0.044000] Mountpoint-cache hash table entries: 1024 (order: 0, 4096 bytes)
[    0.056000] NET: Registered protocol family 16
[    0.064000] registering PCI controller with io_map_base unset
[    0.076000] PCI host bridge to bus 0000:00
[    0.080000] pci_bus 0000:00: root bus resource [mem 0x30000000-0x37ffffff]
[    0.084000] pci_bus 0000:00: root bus resource [io  0x8000000-0x800ffff]
[    0.088000] pci_bus 0000:00: No busn resource found for root bus, will use [b us 00-ff]
[    0.096000] pci 0000:00:01.0: BAR 0: assigned [mem 0x30000000-0x30003fff]
[    0.100000] Switched to clocksource MIPS
[    0.104000] PCI: Enabling device 0000:00:01.0 (0000 -&gt; 0002)
[    0.132000] ssb: Found chip with id 0xA8D6, rev 0x00 and package 0x08
[    0.176000] ssb: WARNING: Using fallback SPROM failed (err -2)
[    0.180000] ssb: WARNING: Invalid SPROM CRC (corrupt SPROM)
[    0.188000] ssb: Unsupported SPROM revision 255 detected. Will extract v1
[    0.216000] ssb: Sonics Silicon Backplane found on PCI device 0000:00:01.0
[    0.224000] NET: Registered protocol family 2
[    0.232000] TCP established hash table entries: 1024 (order: 0, 4096 bytes)
[    0.236000] TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
[    0.244000] TCP: Hash tables configured (established 1024 bind 1024)
[    0.252000] TCP: reno registered
[    0.256000] UDP hash table entries: 256 (order: 0, 4096 bytes)
[    0.260000] UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
[    0.268000] NET: Registered protocol family 1
[    0.272000] futex hash table entries: 256 (order: -1, 3072 bytes)
[    0.280000] squashfs: version 4.0 (2009/01/31) Phillip Lougher
[    0.288000] jffs2: version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORIT Y) (c) 2001-2006 Red Hat, Inc.
[    0.296000] msgmni has been set to 117
[    0.304000] io scheduler noop registered
[    0.308000] io scheduler deadline registered (default)
[    0.312000] bcm63xx_uart.0: ttyS0 at MMIO 0xb0000100 (irq = 10, base_baud = 1 â–’[    0.324000] console [ttyS0] enabled
[    0.324000] console [ttyS0] enabled
[    0.328000] bootconsole [early0] disabled
[    0.328000] bootconsole [early0] disabled
[    0.340000] bcm63xx-rng bcm63xx-rng: registered RNG driver
[    0.344000] 18000000.nor: Found 1 x16 devices at 0x0 in 16-bit bank. Manufact urer ID 0x0000c2 Chip ID 0x00227e
[    0.356000] Amd/Fujitsu Extended Query Table at 0x0040
[    0.360000]   Amd/Fujitsu Extended Query version 1.3.
[    0.368000] number of CFI chips: 1
[    0.372000] bcm63xxpart: CFE boot tag found with version 6 and board type 963 68MVWG
[    0.380000] 6 bcm63xxpart partitions found on MTD device 18000000.nor
[    0.384000] Creating 6 MTD partitions on &quot;18000000.nor&quot;:
[    0.392000] 0x000000000000-0x000000020000 : &quot;CFE&quot;
[    0.396000] 0x000000020100-0x0000004f0100 : &quot;rootfs&quot;
[    0.400000] mtd: partition &quot;rootfs&quot; must either start or end on erase block b oundary or be smaller than an erase block -- forcing read-only
[    0.416000] mtd: device 1 (rootfs) set to be root filesystem
[    0.420000] mtdsplit: no squashfs found in &quot;rootfs&quot;
[    0.428000] mtdsplit: no squashfs found in &quot;18000000.nor&quot;
[    0.432000] 0x0000004f0100-0x0000005c2117 : &quot;kernel&quot;
[    0.436000] mtd: partition &quot;kernel&quot; must either start or end on erase block b oundary or be smaller than an erase block -- forcing read-only
[    0.452000] 0x000000020000-0x000001e40000 : &quot;linux&quot;
[    0.456000] 0x000001e40000-0x000001fe0000 : &quot;board_data&quot;
[    0.464000] 0x000001fe0000-0x000002000000 : &quot;nvram&quot;
[    0.472000] bcm63xx-spi bcm63xx-spi: at 0xb0000800 (irq 9, FIFOs size 542)
[    0.492000] b53-switch: probe of spi0.1 failed with error -22
[    0.532000] bcm63xx-wdt bcm63xx-wdt:  started, timer margin: 30 sec
[    0.544000] TCP: cubic registered
[    0.548000] NET: Registered protocol family 17
[    0.552000] bridge: automatic filtering via arp/ip/ip6tables has been depreca ted. Update your scripts to load br_netfilter if you need this.
[    0.564000] 8021q: 802.1Q VLAN Support v1.8
[    0.576000] jffs2: Flash size not aligned to erasesize, reducing to 768KiB
[    0.580000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00000000: 0x8002 instead
[    0.592000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00000004: 0x8026 instead
[    0.600000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00000008: 0x000d instead
[    0.612000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x0000000c: 0x6d00 instead
[    0.620000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00000010: 0x0094 instead
[    0.632000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x0000001c: 0xfdff instead
[    0.640000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00000020: 0xb77f instead
[    0.652000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00000024: 0x905d instead
[    0.660000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00000028: 0xd580 instead
[    0.668000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x0000002c: 0xa6fa instead
[    0.680000] jffs2: Further such events for this erase block will not be print ed
[    0.688000] jffs2: Old JFFS2 bitmask found at 0x00001f90
[    0.696000] jffs2: You cannot use older JFFS2 filesystems with newer kernels
[    0.748000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00020000: 0xa720 instead
[    0.760000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00020004: 0x554d instead
[    0.768000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00020008: 0x1e51 instead
[    0.776000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x0002000c: 0xd243 instead
[    0.788000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00020010: 0x8318 instead
[    0.796000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00020014: 0x4ff6 instead
[    0.808000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00020018: 0xa978 instead
[    0.816000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x0002001c: 0x2927 instead
[    0.828000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00020020: 0xfd2b instead
[    0.836000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00020024: 0x6529 instead
[    0.848000] jffs2: Further such events for this erase block will not be print ed
[    0.904000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00040000: 0xd323 instead
[    0.912000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00040004: 0x2886 instead
[    0.924000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00040008: 0x7df5 instead
[    0.932000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x0004000c: 0x7bf1 instead
[    0.944000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00040010: 0xe968 instead
[    0.952000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00040014: 0x9ace instead
[    0.960000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00040018: 0x09ce instead
[    0.972000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x0004001c: 0xe2c7 instead
[    0.980000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00040020: 0x12eb instead
[    0.992000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00040024: 0xf1a4 instead
[    1.000000] jffs2: Further such events for this erase block will not be print ed
[    1.056000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00060000: 0x7292 instead
[    1.068000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00060004: 0x025d instead
[    1.076000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00060008: 0xdaf0 instead
[    1.088000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x0006000c: 0xd646 instead
[    1.096000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00060010: 0x3d30 instead
[    1.108000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00060014: 0xdd5b instead
[    1.116000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00060018: 0x6a12 instead
[    1.124000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x0006001c: 0xcf0d instead
[    1.136000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00060020: 0x997f instead
[    1.144000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00060024: 0x1f0a instead
[    1.156000] jffs2: Further such events for this erase block will not be print ed
[    1.168000] jffs2: Old JFFS2 bitmask found at 0x00064144
[    1.176000] jffs2: You cannot use older JFFS2 filesystems with newer kernels
[    1.224000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00080000: 0xcb4e instead
[    1.236000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00080004: 0x2064 instead
[    1.244000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00080008: 0xd9f7 instead
[    1.252000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x0008000c: 0x63cb instead
[    1.264000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00080010: 0x29d9 instead
[    1.272000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00080014: 0x0983 instead
[    1.284000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00080018: 0x1097 instead
[    1.292000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x0008001c: 0xdb7c instead
[    1.304000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00080020: 0x071b instead
[    1.312000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x00080024: 0xf2f4 instead
[    1.324000] jffs2: Further such events for this erase block will not be print ed
[    1.380000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x000a0000: 0xffcd instead
[    1.388000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x000a0004: 0xa27e instead
[    1.400000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x000a0008: 0x588c instead
[    1.408000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x000a000c: 0xf4df instead
[    1.416000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x000a0010: 0xb01e instead
[    1.428000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x000a0014: 0x1814 instead
[    1.436000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x000a0018: 0xeeee instead
[    1.448000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x000a001c: 0xb117 instead
[    1.456000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x000a0020: 0xf39e instead
[    1.468000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at  0x000a0024: 0xa39a instead
[    1.476000] jffs2: Further such events for this erase block will not be print ed
[    1.484000] jffs2: Old JFFS2 bitmask found at 0x000a0a60
[    1.492000] jffs2: You cannot use older JFFS2 filesystems with newer kernels
[    1.532000] jffs2: Old JFFS2 bitmask found at 0x000b6130
[    1.536000] jffs2: You cannot use older JFFS2 filesystems with newer kernels
[    1.548000] jffs2: Old JFFS2 bitmask found at 0x000b8144
[    1.552000] jffs2: You cannot use older JFFS2 filesystems with newer kernels
[    1.572000] jffs2: Cowardly refusing to erase blocks on filesystem with no va lid JFFS2 nodes
[    1.580000] jffs2: empty_blocks 0, bad_blocks 0, c-&gt;nr_blocks 6
[    1.584000] VFS: Cannot open root device &quot;mtdblock2&quot; or unknown-block(31,2):  error -5
[    1.592000] Please append a correct &quot;root=&quot; boot option; here are the availab le partitions:
[    1.604000] 1f00             128 mtdblock0  (driver?)
[    1.608000] 1f01            4928 mtdblock1  (driver?)
[    1.612000] 1f02             840 mtdblock2  (driver?)
[    1.620000] 1f03           30848 mtdblock3  (driver?)
[    1.624000] 1f04            1664 mtdblock4  (driver?)
[    1.628000] 1f05             128 mtdblock5  (driver?)
[    1.632000] Kernel panic - not syncing: VFS: Unable to mount root fs on unkno wn-block(31,2)
[    1.632000] ---[ end Kernel panic - not syncing: VFS: Unable to mount root fs  on unknown-block(31,2)
[   33.536000] random: nonblocking pool is initialized</code></pre></div><p>With the failure noted though this was a quick build so I will need to investigate how to properly set the mtd partitions.</p>											<p class="post-edited">(Last edited by <strong>jewest</strong> on 5 May 2015, 08:19)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p275244">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">danitool</div>
					<div class="post-datetime">
						5 May 2015, 11:45					</div>
				</div>
				<div class="post-content content">
					<p>As I said previously you should use the slave select 0 (AKA chip select). Your code is still using slave select 1.</p><p>Use something like this instead:<br /></p><div class="codebox"><pre><code>static struct spi_board_info P870HNU-51c_spi_devices[] = {
        {
                .modalias = &quot;b53-switch&quot;,
                .max_speed_hz = 781000,
                .bus_num = 0,
                .chip_select = 0,
                .platform_data = &amp;P870HNU-51c_b53_pdata,
        }
};</code></pre></div><p>About mtd partitions, for some reason the kernel is not recognizing the rootfs as a valid squashfs. I suspect the CFE has double image&nbsp; protection. This means sometimes it will flash/boot images to/from the middle of the flash. To force the use of whole flash, and flashing always after the end of CFE, you should pad the image to at least 1/2 the flash size.</p><p>Add the parameter&nbsp; <strong>--pad 16</strong> to the image ImageDTB generator line. </p><p>Also notice the netgear has a board_data partition, it&#039;s harmless for your router, but you don&#039;t need it, you can delete it and readjust the linux parition size.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p275310">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">jewest</div>
					<div class="post-datetime">
						5 May 2015, 20:04					</div>
				</div>
				<div class="post-content content">
					<p>Haha that is what I get for working on this late at night <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />.. Yep chip select = 0 was what I meant but got side tracked re writing the patch and missed it upon posting. </p><p>Ill give it a try this afternoon and should have more to report shortly.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p275327">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">jewest</div>
					<div class="post-datetime">
						5 May 2015, 20:51					</div>
				</div>
				<div class="post-content content">
					<p>Patch code update - 570-board_P870HNU_51c.patch<br /></p><div class="codebox"><pre><code>--- a/arch/mips/bcm63xx/boards/board_bcm963xx.c
+++ b/arch/mips/bcm63xx/boards/board_bcm963xx.c
@@ -1930,6 +1930,48 @@ static struct board_info __initdata boar
     .num_spis = ARRAY_SIZE(DGND3700v1_3800B_spi_devices),
 };
 
+static struct b53_platform_data P870HNU_51c_b53_pdata = {
+        .alias    = &quot;eth0&quot;,
+};
+
+static struct spi_board_info P870HNU_51c_spi_devices[] = {
+        {
+                .modalias = &quot;b53-switch&quot;,
+                .max_speed_hz = 781000,
+                .bus_num = 0,
+                .chip_select = 0,
+                .platform_data = &amp;P870HNU_51c_b53_pdata,
+        }
+};
+
+static struct board_info __initdata board_P870HNU_51c = {
+        .name                           = &quot;P870HNU_51c&quot;,
+        .expected_cpu_id                = 0x6368,
+
+        .has_uart0                      = 1,
+        .has_pci                        = 1,
+        .has_ohci0                      = 1,
+        .has_ehci0                      = 1,
+        .num_usbh_ports                 = 1,
+
+        .has_enetsw                     = 1,
+        .enetsw = {
+                .used_ports = {
+                        [5] = {
+                                .used  = 1,
+                                .phy_id  = 0xff,
+                                .bypass_link = 1,
+                                .force_speed = 1000,
+                                .force_duplex_full = 1,
+                                .name  = &quot;RGMII&quot;,
+                        },
+                },
+        },
+
+        .spis = P870HNU_51c_spi_devices,
+        .num_spis = ARRAY_SIZE(P870HNU_51c_spi_devices),
+};
+
 static struct sprom_fixup __initdata vr3025u_fixups[] = {
     { .offset = 97, .value = 0xfeb3 },
     { .offset = 98, .value = 0x1618 },
@@ -2384,6 +2426,7 @@ static const struct board_info __initcon
     &amp;board_VR3025u,
     &amp;board_VR3025un,
     &amp;board_WAP5813n,
+    &amp;board_P870HNU_51c,
 #endif
 #ifdef CONFIG_BCM63XX_CPU_63268
     &amp;board_963268bu_p300,
@@ -2485,6 +2528,7 @@ static struct of_device_id const bcm963x
     { .compatible = &quot;comtrend,wap-5813n&quot;, .data = &amp;board_WAP5813n, },
     { .compatible = &quot;netgear,dgnd3700v1&quot;, .data = &amp;board_DGND3700v1_3800B, },
     { .compatible = &quot;zyxel,p870hw-51a-v2&quot;, .data = &amp;board_P870HW51A_V2, },
+    { .compatible = &quot;zyxel,p870hnu-51c&quot;, .data = &amp;board_P870HNU_51c, },
 #endif
 #ifdef CONFIG_BCM63XX_CPU_63268
     { .compatible = &quot;brcm,bcm963268bu_p300&quot;, .data = &amp;board_963268bu_p300, },</code></pre></div><br /><p>/opt/openwrt_trunk/target/linux/bcrm63xx/image/Makefile<br />Added line 419-420<br /></p><div class="codebox"><pre><code># ZyXEL P870HNU-51c
$(eval $(call ImageDTB,ZYXCFEDTB,P870HNU-51c,P870HNU-51c,p870hnu-51c,96368MVGW,6368,--rsa-signature &quot;ZyXEL&quot; --signature &quot;ZyXEL_0001&quot; --image-offset 0x20000 --block-size 0x20000 --pad 16))</code></pre></div><p>/opt/openwrt_trunk/target/linux/bcrm63xx/profiles/zyxel.mk<br />Added line 15 - 22<br /></p><div class="codebox"><pre><code>define Profile/P870HNU-51c
    NAME:=ZyXEL P870HNU-51c
    PACKAGES:=kmod-b43 wpad-mini
endef
define Profile/P870HNU_51c/Description
  Package set optimized for P870HNU-51c.
endef
$(eval $(call Profile,P870HNU_51c))</code></pre></div><p>/opt/openwrt_trunk/target/linux/bcrm63xx/base-files/etc/uci-deafults/02_network<br />Add line 116<br /></p><div class="codebox"><pre><code>P870hnu-51c |\</code></pre></div><br /><p>/opt/openwrt_trunk/target/linux/bcrm63xx/base-files/lib/brcm63xx.sh<br />Looks like this was changed by Jogo a couple weeks ago where the code outlined under changeset 44831 no longer seems valid. Because of this I added line 237 - 239 under the new format. Issue is that I am not sure how or where to apply settings for status_led=, brcm63xx_has_reset_button=, or ifname=.. <br /></p><div class="codebox"><pre><code>    &quot;Zyxel P870HNU-51c&quot;)
        board_name=&quot;p870hnu-51c&quot;
        ;;</code></pre></div><p>/opt/openwrt_trunk/target/linux/bcrm63xx/base-files/etc/uci-deafults/01_leds<br />Added line 43 - 50<br /></p><div class="codebox"><pre><code>P870HNU-51c)
    ucidef_set_led_netdev &quot;lan&quot; &quot;LAN&quot; &quot;P870HNU-51c:green:lan&quot; &quot;eth0.1&quot;
    ucidef_set_led_netdev &quot;wan&quot; &quot;WAN&quot; &quot;P870HNU-51c:green:inet&quot; &quot;eth0.2&quot;
    ucidef_set_led_netdev &quot;wlan0&quot; &quot;WIFI2G&quot; &quot;P870HNU-51c:green:wifi2g&quot; &quot;wlan0&quot;
    ucidef_set_led_netdev &quot;wlan1&quot; &quot;WIFI5G&quot; &quot;P870HNU-51c:blue:wifi5g&quot; &quot;wlan1&quot;
    ucidef_set_led_usbdev &quot;usb1&quot; &quot;USB1&quot; &quot;P870HNU-51c:green:usb-back&quot; &quot;1-1&quot;
    ucidef_set_led_usbdev &quot;usb2&quot; &quot;USB2&quot; &quot;P870HNU-51c:green:usb-front&quot; &quot;1-2&quot;
    ;;</code></pre></div><br /><p>Hopefully I have this mostly correct.. Building now with results to follow.</p>											<p class="post-edited">(Last edited by <strong>jewest</strong> on 16 May 2015, 08:47)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p275381">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">jewest</div>
					<div class="post-datetime">
						6 May 2015, 06:12					</div>
				</div>
				<div class="post-content content">
					<p>Progress is good <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />.. </p><p>b53 switch has been recognized on spi0,0 and after playing arround with the pad settings I was able to flash.. Ended up having to use --pad 6 since CFE was rejecting firmware images larger then 8388608 bytes. </p><div class="codebox"><pre><code>CFE&gt; ATTR openwrt-P870HNU-51c-squashfs-zyxcfe.bin
Loading 192.168.0.100:openwrt-P870HNU-51c-squashfs-zyxcfe.bin ...
Finished loading 8388608 bytes

Illegal image ! Image crc failed.
*** command status = -1</code></pre></div><br /><p>OpenWRT successful boot log below. <br /></p><div class="codebox"><pre><code>CFE&gt; ATTR openwrt-P870HNU-51c-squashfs-zyxcfe.bin
Loading 192.168.0.100:openwrt-P870HNU-51c-squashfs-zyxcfe.bin ...
Finished loading 7602180 bytes

Flashing root file system and kernel at 0xb8020000:
...........................................................

.
*** Image flash done *** !

Resetting board...â–’

CFE version 1.13.0-104.4 for BCM96368 (32bit,SP,BE)
Build Date: 08/17/2010 (kuanjung@MSGSW4-server2)
Copyright (C) 2000-2009 Broadcom Corporation.

Parallel flash device: name S29GL256P90, id 0x2222 size 32768KB
Total Flash size: 32768K with 256 sectors
ethsw: found bcm53115!
Chip ID: BCM6368B2, MIPS: 400MHz
Main Thread: TP0
Total Memory: 67108864 bytes (64MB)
Boot Address: 0xb8000000

Board IP address                  : 192.168.0.2:ffffff00
Host IP address                   : 192.168.0.100
Gateway IP address                : 192.168.0.1
Run from flash/host (f/h)         : f
Default host run file name        : vmlinux
Default host flash file name      : bcm963xx_fs_kernel
Boot delay (0-9 seconds)          : 5
Boot image (0=latest, 1=previous) : 0
Board Id (0-11)                   : 96368MVWG
Number of MAC Addresses (1-32)    : 4
Base MAC Address                  : 08:6c:87:6f:b0:8c
PSI Size (1-128 KBytes            : 128
Enable Backup PSI [0|1]           : 0
System Log Size (0-256) KBytes    : 0
Main Thread Number [0|1]          : 0

*** Press any key to stop auto run (5 seconds) ***
Auto run second count down: 0
Checking Reset button on GPIO 34
Wait for Multiboot Service Packet...  0
flash_addr_kernel b8020100
Booting from latest image (0xb8020000) ...
Code Address: 0x80A00000, Entry Address: 0x80a00000
LZMA: Prossible old LZMA format, trying to decompress..
Decompression OK!
Entry at 0x80a00000
Closing network.
Disabling Switch ports.
Flushing Receive Buffers...
49 buffers found.
Closing DMA Channels.
Starting program at 0x80a00000
[    0.000000] Linux version 3.18.11 (jeff@jeff-Virtual-Machine) (gcc version 4.8.3 (OpenWrt/Linaro GCC 4.8-2014.04 r45605) ) #3 Tue May 5 22:00:44 CDT 2015
[    0.000000] Detected Broadcom 0x6368 CPU revision b2
[    0.000000] CPU frequency is 400 MHz
[    0.000000] 64MB of RAM installed
[    0.000000] board_bcm963xx: Boot address 0xb8000000
[    0.000000] board_bcm963xx: CFE version: 1.13.0-104.4
[    0.000000] bootconsole [early0] enabled
[    0.000000] CPU0 revision is: 0002a031 (Broadcom BMIPS4350)
[    0.000000] board: board name: 96368MVWG
[    0.000000] MIPS: machine is ZyXEL P870HNU-51c
[    0.000000] Determined physical RAM map:
[    0.000000]  memory: 04000000 @ 00000000 (usable)
[    0.000000] Initrd not found or empty - disabling initrd
[    0.000000] Zone ranges:
[    0.000000]   Normal   [mem 0x00000000-0x03ffffff]
[    0.000000] Movable zone start for each node
[    0.000000] Early memory node ranges
[    0.000000]   node   0: [mem 0x00000000-0x03ffffff]
[    0.000000] Initmem setup node 0 [mem 0x00000000-0x03ffffff]
[    0.000000] Primary instruction cache 64kB, VIPT, 4-way, linesize 16 bytes.
[    0.000000] Primary data cache 32kB, 2-way, VIPT, cache aliases, linesize 16 bytes
[    0.000000] Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 16256
[    0.000000] Kernel command line:  root=/dev/mtdblock2 rootfstype=squashfs,jffs2 noinitrd console=ttyS0,115200
[    0.000000] PID hash table entries: 256 (order: -2, 1024 bytes)
[    0.000000] Dentry cache hash table entries: 8192 (order: 3, 32768 bytes)
[    0.000000] Inode-cache hash table entries: 4096 (order: 2, 16384 bytes)
[    0.000000] Memory: 59964K/65536K available (2656K kernel code, 132K rwdata, 560K rodata, 1316K init, 192K bss, 5572K reserved)
[    0.000000] NR_IRQS:256
[    0.000000] Calibrating delay loop... 397.82 BogoMIPS (lpj=795648)
[    0.036000] pid_max: default: 32768 minimum: 301
[    0.040000] Mount-cache hash table entries: 1024 (order: 0, 4096 bytes)
[    0.044000] Mountpoint-cache hash table entries: 1024 (order: 0, 4096 bytes)
[    0.056000] NET: Registered protocol family 16
[    0.064000] registering PCI controller with io_map_base unset
[    0.076000] PCI host bridge to bus 0000:00
[    0.080000] pci_bus 0000:00: root bus resource [mem 0x30000000-0x37ffffff]
[    0.084000] pci_bus 0000:00: root bus resource [io  0x8000000-0x800ffff]
[    0.088000] pci_bus 0000:00: No busn resource found for root bus, will use [bus 00-ff]
[    0.096000] pci 0000:00:01.0: BAR 0: assigned [mem 0x30000000-0x30003fff]
[    0.100000] Switched to clocksource MIPS
[    0.104000] PCI: Enabling device 0000:00:01.0 (0000 -&gt; 0002)
[    0.132000] ssb: Found chip with id 0xA8D6, rev 0x00 and package 0x08
[    0.176000] ssb: WARNING: Using fallback SPROM failed (err -2)
[    0.180000] ssb: WARNING: Invalid SPROM CRC (corrupt SPROM)
[    0.188000] ssb: Unsupported SPROM revision 255 detected. Will extract v1
[    0.216000] ssb: Sonics Silicon Backplane found on PCI device 0000:00:01.0
[    0.224000] NET: Registered protocol family 2
[    0.232000] TCP established hash table entries: 1024 (order: 0, 4096 bytes)
[    0.236000] TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
[    0.244000] TCP: Hash tables configured (established 1024 bind 1024)
[    0.252000] TCP: reno registered
[    0.256000] UDP hash table entries: 256 (order: 0, 4096 bytes)
[    0.260000] UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
[    0.268000] NET: Registered protocol family 1
[    0.272000] futex hash table entries: 256 (order: -1, 3072 bytes)
[    0.280000] squashfs: version 4.0 (2009/01/31) Phillip Lougher
[    0.288000] jffs2: version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006 Red Hat, Inc.
[    0.296000] msgmni has been set to 117
[    0.304000] io scheduler noop registered
[    0.308000] io scheduler deadline registered (default)
[    0.312000] bcm63xx_uart.0: ttyS0 at MMIO 0xb0000100 (irq = 10, base_baud = 1562500) is â–’[    0.324000] console [ttyS0] enabled
[    0.324000] console [ttyS0] enabled
[    0.328000] bootconsole [early0] disabled
[    0.328000] bootconsole [early0] disabled
[    0.340000] bcm63xx-rng bcm63xx-rng: registered RNG driver
[    0.344000] 18000000.nor: Found 1 x16 devices at 0x0 in 16-bit bank. Manufacturer ID 0x0000c2 Chip ID 0x00227e
[    0.356000] Amd/Fujitsu Extended Query Table at 0x0040
[    0.360000]   Amd/Fujitsu Extended Query version 1.3.
[    0.368000] number of CFI chips: 1
[    0.372000] bcm63xxpart: CFE boot tag found with version 6 and board type 96368MVGW
[    0.380000] 6 bcm63xxpart partitions found on MTD device 18000000.nor
[    0.384000] Creating 6 MTD partitions on &quot;18000000.nor&quot;:
[    0.392000] 0x000000000000-0x000000020000 : &quot;CFE&quot;
[    0.396000] 0x000000020100-0x00000014340c : &quot;kernel&quot;
[    0.400000] mtd: partition &quot;kernel&quot; must either start or end on erase block boundary or be smaller than an erase block -- forcing read-only
[    0.416000] 0x00000014340c-0x000001e40000 : &quot;rootfs&quot;
[    0.420000] mtd: partition &quot;rootfs&quot; must either start or end on erase block boundary or be smaller than an erase block -- forcing read-only
[    0.436000] mtd: device 2 (rootfs) set to be root filesystem
[    0.440000] 1 squashfs-split partitions found on MTD device rootfs
[    0.448000] 0x000000760000-0x000001e40000 : &quot;rootfs_data&quot;
[    0.456000] 0x000000020000-0x000001e40000 : &quot;linux&quot;
[    0.460000] 0x000001e40000-0x000001fe0000 : &quot;board_data&quot;
[    0.468000] 0x000001fe0000-0x000002000000 : &quot;nvram&quot;
[    0.476000] bcm63xx-spi bcm63xx-spi: at 0xb0000800 (irq 9, FIFOs size 542)
[    0.520000] b53_common: found switch: BCM63xx, rev 0
[    0.524000] bcm63xx-wdt bcm63xx-wdt:  started, timer margin: 30 sec
[    0.532000] TCP: cubic registered
[    0.536000] NET: Registered protocol family 17
[    0.540000] bridge: automatic filtering via arp/ip/ip6tables has been deprecated. Update your scripts to load br_netfilter if you need this.
[    0.556000] 8021q: 802.1Q VLAN Support v1.8
[    0.568000] VFS: Mounted root (squashfs filesystem) readonly on device 31:2.
[    0.592000] Freeing unused kernel memory: 1316K (80357000 - 804a0000)
[    1.924000] init: failed to symlink /tmp -&gt; /var
[    1.928000] init: Console is alive
[    1.932000] init: - watchdog -
[    5.744000] pps_core: LinuxPPS API ver. 1 registered
[    5.748000] pps_core: Software ver. 5.3.6 - Copyright 2005-2007 Rodolfo Giometti &lt;giometti@linux.it&gt;
[    5.760000] PTP clock support registered
[    5.808000] usbcore: registered new interface driver usbfs
[    5.812000] usbcore: registered new interface driver hub
[    5.820000] usbcore: registered new device driver usb
[    5.832000] exFAT: Version 1.2.9
[    5.912000] SCSI subsystem initialized
[    5.928000] ehci_hcd: USB 2.0 &#039;Enhanced&#039; Host Controller (EHCI) Driver
[    5.936000] ehci-platform: EHCI generic platform driver
[    6.048000] ehci-platform ehci-platform: EHCI Host Controller
[    6.052000] ehci-platform ehci-platform: new USB bus registered, assigned bus number 1
[    6.060000] ehci-platform ehci-platform: irq 15, io mem 0xb0001500
[    6.080000] ehci-platform ehci-platform: USB 2.0 started, EHCI 1.00, overcurrent ignored
[    6.088000] hub 1-0:1.0: USB hub found
[    6.092000] hub 1-0:1.0: 1 port detected
[    6.100000] ohci_hcd: USB 1.1 &#039;Open&#039; Host Controller (OHCI) Driver
[    6.108000] ohci-platform: OHCI generic platform driver
[    6.116000] ohci-platform ohci-platform: Generic Platform OHCI controller
[    6.124000] ohci-platform ohci-platform: new USB bus registered, assigned bus number 2
[    6.132000] ohci-platform ohci-platform: irq 13, io mem 0xb0001600
[    6.196000] hub 2-0:1.0: USB hub found
[    6.200000] hub 2-0:1.0: 1 port detected
[    6.224000] usbcore: registered new interface driver usb-storage
[    7.136000] init: - preinit -
[    8.092000] random: mktemp urandom read with 31 bits of entropy available
Press the [f] key and hit [enter] to enter failsafe mode
Press the [1], [2], [3] or [4] key and hit [enter] to select the debug level
[   11.368000] mount_root: loading kmods from internal overlay
[   11.724000] block: attempting to load /etc/config/fstab
[   11.736000] block: unable to load configuration (fstab: Entry not found)
[   11.744000] block: no usable configuration
[   11.748000] mount_root: jffs2 not ready yet, using temporary tmpfs overlay
ifconfig: SIOCGIFFLAGS: No such device
[   11.800000] procd: - early -
[   11.800000] procd: - watchdog -
[   12.700000] procd: - ubus -
[   13.708000] procd: - init -
Please press Enter to activate this console.
[   17.388000] NET: Registered protocol family 10
[   17.416000] NET: Registered protocol family 8
[   17.420000] NET: Registered protocol family 20
[   18.052000] wl: module license &#039;unspecified&#039; taints kernel.
[   18.060000] Disabling lock debugging due to kernel taint
[   18.164000] SSB/BCMA glue driver successfully attached
[   18.196000] fallback_sprom: pci bus/device num mismatch: expected 0/0, but got 0/1
[   18.204000] BCMA8D6(00:01) using sprom version 0
[   18.216000] wl0: 5.10.56.27 driver failed with code 15
[   18.236000] device-mapper: ioctl: 4.28.0-ioctl (2014-09-17) initialised: dm-devel@redhat.com
[   18.328000] RPC: Registered named UNIX socket transport module.
[   18.336000] RPC: Registered udp transport module.
[   18.340000] RPC: Registered tcp transport module.
[   18.344000] RPC: Registered tcp NFSv4.1 backchannel transport module.
[   18.372000] ntfs: driver 2.1.31 [Flags: R/O MODULE].
[   18.428000] ip6_tables: (C) 2000-2006 Netfilter Core Team
[   18.484000] using random self ethernet address
[   18.488000] using random host ethernet address
[   18.492000] usb0: HOST MAC ba:d0:34:42:cc:58
[   18.496000] usb0: MAC b6:35:48:68:d5:b8
[   18.500000] using random self ethernet address
[   18.504000] using random host ethernet address
[   18.512000] g_ether gadget: Ethernet Gadget, version: Memorial Day 2008
[   18.516000] g_ether gadget: g_ether ready
[   18.524000] Loading modules backported from Linux version master-2015-03-09-0-g141f155
[   18.532000] Backport generated by backports.git backports-20150129-0-gdd4a670
[   18.588000] cfg80211: Calling CRDA to update world regulatory domain
[   18.596000] cfg80211: World regulatory domain updated:
[   18.604000] cfg80211:  DFS Master region: unset
[   18.608000] cfg80211:   (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp), (dfs_cac_time)
[   18.616000] cfg80211:   (2402000 KHz - 2472000 KHz @ 40000 KHz), (N/A, 2000 mBm), (N/A)
[   18.624000] cfg80211:   (2457000 KHz - 2482000 KHz @ 40000 KHz), (N/A, 2000 mBm), (N/A)
[   18.632000] cfg80211:   (2474000 KHz - 2494000 KHz @ 20000 KHz), (N/A, 2000 mBm), (N/A)
[   18.640000] cfg80211:   (5170000 KHz - 5250000 KHz @ 80000 KHz), (N/A, 2000 mBm), (N/A)
[   18.652000] cfg80211:   (5250000 KHz - 5330000 KHz @ 80000 KHz, 160000 KHz AUTO), (N/A, 2000 mBm), (0 s)
[   18.660000] cfg80211:   (5490000 KHz - 5730000 KHz @ 160000 KHz), (N/A, 2000 mBm), (0 s)
[   18.668000] cfg80211:   (5735000 KHz - 5835000 KHz @ 80000 KHz), (N/A, 2000 mBm), (N/A)
[   18.676000] cfg80211:   (57240000 KHz - 63720000 KHz @ 2160000 KHz), (N/A, 0 mBm), (N/A)
[   19.032000] hidraw: raw HID events driver (C) Jiri Kosina
[   19.100000] Broadcom 43xx driver loaded [ Features: PNL ]
[   19.120000] ip_tables: (C) 2000-2006 Netfilter Core Team
[   19.148000] nf_conntrack version 0.5.0 (957 buckets, 3828 max)
[   19.196000] usbcore: registered new interface driver ums-alauda
[   19.204000] usbcore: registered new interface driver ums-cypress
[   19.212000] usbcore: registered new interface driver ums-datafab
[   19.224000] usbcore: registered new interface driver ums-freecom
[   19.232000] usbcore: registered new interface driver ums-isd200
[   19.244000] usbcore: registered new interface driver ums-jumpshot
[   19.260000] usbcore: registered new interface driver ums-karma
[   19.268000] usbcore: registered new interface driver ums-sddr09
[   19.280000] usbcore: registered new interface driver ums-sddr55
[   19.292000] usbcore: registered new interface driver ums-usbat
[   19.312000] usbcore: registered new interface driver usbhid
[   19.316000] usbhid: USB HID core driver
[   19.332000] usbcore: registered new interface driver usbserial
[   19.340000] usbcore: registered new interface driver usbserial_generic
[   19.344000] usbserial: USB Serial support registered for generic
[   19.492000] xt_time: kernel timezone is -0000
[   19.516000] usbcore: registered new interface driver ftdi_sio
[   19.520000] usbserial: USB Serial support registered for FTDI USB Serial Device
[   19.564000] PPP generic driver version 2.4.2
[   19.572000] NET: Registered protocol family 24
[   28.360000] IPv6: ADDRCONF(NETDEV_UP): usb0: link is not ready
[   32.740000] random: nonblocking pool is initialized
[   40.648000] jffs2_scan_eraseblock(): End of filesystem marker found at 0x0
[   40.664000] jffs2_build_filesystem(): unlocking the mtd device... done.
[   40.668000] jffs2_build_filesystem(): erasing all blocks after the end marker... done.
[  177.180000] jffs2: notice: (1362) jffs2_build_xattr_subsystem: complete building xattr subsystem, 0 of xdatum (0 unchecked, 0 orphan) and 0 of xref (0 dead, 0 orphan) found.

BusyBox v1.23.2 (2015-05-05 21:35:28 CDT) built-in shell (ash)

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 -----------------------------------------------------
 CHAOS CALMER (Bleeding Edge, r45605)
 -----------------------------------------------------
  * 1 1/2 oz Gin            Shake with a glassful
  * 1/4 oz Triple Sec       of broken ice and pour
  * 3/4 oz Lime Juice       unstrained into a goblet.
  * 1 1/2 oz Orange Juice
  * 1 tsp. Grenadine Syrup
 -----------------------------------------------------
root@OpenWrt:/# </code></pre></div>											<p class="post-edited">(Last edited by <strong>jewest</strong> on 6 May 2015, 06:59)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p275422">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">danitool</div>
					<div class="post-datetime">
						6 May 2015, 11:55					</div>
				</div>
				<div class="post-content content">
					<p>About the CRC fault, this also happens in my bcm6358 router with firmwares &gt;8MB. Try to use the CFE web interface for flashing, it works for me.</p><p>About the switch, I still don&#039;t see the external BCM53115 switch detected. Looks like it&#039;s detecting the integrated switch instead.</p><p>On my DGND3700 I get this line in the dmesg:<br /></p><div class="codebox"><pre><code>b53_common: found switch: BCM53115, rev 8</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p275521">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">jewest</div>
					<div class="post-datetime">
						7 May 2015, 03:01					</div>
				</div>
				<div class="post-content content">
					<p>Web UI worked for the larger image with --pad 16.</p><p>Not sure how to move forward on the b53 switch though.. Possibly the wrong SPI chip select or a driver issue maybe?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p275540">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">Khaleal</div>
					<div class="post-datetime">
						7 May 2015, 11:44					</div>
				</div>
				<div class="post-content content">
					<p>So are you talking about the ZyXEL Q1000Z supplied by CenturyLink? Is it possible to edit the firmware to unlock all of it&#039;s features?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p276462">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">jewest</div>
					<div class="post-datetime">
						16 May 2015, 08:45					</div>
				</div>
				<div class="post-content content">
					<p>spi0,0 actually does work here.. Issue was in my patch format and once resolved I have the same detection &quot;b53_common: found switch: BCM53115, rev 8&quot;.. </p><p>Now that the switch is detected I can hopefully get it configured.. When manually modifying the /etc/config/network file I can get some progress but not full connectivity. It seems that board settings defined in 02_network are not being applied by default also (same with 01_leds).</p><p>Any insight here would be appreciated!!</p><p>Updated patch code from previous post and included latest full 02_network and 01_leds files below.</p><p>02_network<br /></p><div class="codebox"><pre><code>#!/bin/sh
#
# Copyright (C) 2012 OpenWrt.org
#

[ -e /etc/config/network ] &amp;&amp; exit 0

touch /etc/config/network

. /lib/functions/uci-defaults.sh
. /lib/brcm63xx.sh

ucidef_set_interface_loopback

case &quot;$(brcm63xx_board_name)&quot; in

cvg834g |\
rta770bw |\
rta770w |\
spw303v |\
spw500v)
    ucidef_set_interface_lan &quot;eth0&quot;
    ;;

ar1004g |\
bcm96338gw |\
bcm96338w |\
cpva642 |\
ct-5365 |\
ct-536p_5621t |\
ct-6373 |\
dg834g_v4 |\
dsl-2640b-b |\
dsl-2640u |\
fast2604 |\
rta1320 |\
v2110)
    ucidef_set_interface_lan &quot;eth0&quot;
    ucidef_add_switch &quot;eth0&quot; &quot;1&quot; &quot;1&quot;
    ucidef_add_switch_vlan &quot;eth0&quot; &quot;1&quot; &quot;0 1 2 3 4 5&quot;
    ;;

agpf-s0 |\
bcm96348gw |\
bcm96348gw-10 |\
bcm96348gw-11 |\
bcm96358vw |\
bcm96358vw2 |\
cpva502p |\
dg834gt |\
dmv-s0 |\
dsl-2650u |\
dv-201amr |\
f5d7633 |\
fast2404 |\
magic |\
rg100a |\
rta1025W |\
td-w8900gb |\
usr9108 |\
v2500v_bb)
    ucidef_set_interfaces_lan_wan &quot;eth1&quot; &quot;eth0&quot;
    ucidef_add_switch &quot;eth1&quot; &quot;1&quot; &quot;1&quot;
    ucidef_add_switch_vlan &quot;eth1&quot; &quot;1&quot; &quot;0 1 2 3 4 5&quot;
    ;;

dsl-274xb-c |\
hg553 |\
hg556a_* |\
homehub2a)
    ucidef_set_interface_lan &quot;eth0.1&quot;
    ucidef_add_switch &quot;eth0&quot; &quot;1&quot; &quot;1&quot;
    ucidef_add_switch_vlan &quot;eth0&quot; &quot;1&quot; &quot;0 1 2 3 4 5t&quot;
    ;;

dva-g3810bn |\
hg520 |\
neufbox4)
    ucidef_set_interfaces_lan_wan &quot;eth1.1&quot; &quot;eth0&quot;
    ucidef_add_switch &quot;eth1&quot; &quot;1&quot; &quot;1&quot;
    ucidef_add_switch_vlan &quot;eth1&quot; &quot;1&quot; &quot;0 1 2 3 4 5t&quot;
    ;;

a4001n1 |\
a4001n |\
ar-5381u |\
ar-5387un |\
bcm963281tan |\
bcm96328avng |\
bcm96368mvngr |\
dsl-274xb-f |\
dsl-275xb-d |\
fast2504n |\
fast2704v2 |\
p870hw-51a_v2 |\
p870hnu-51c |\
vr-3025un |\
vr-3025u)
    ucidef_set_interface_lan &quot;eth0.1&quot;
    ucidef_add_switch &quot;eth0&quot; &quot;1&quot; &quot;1&quot;
    ucidef_add_switch_vlan &quot;eth0&quot; &quot;1&quot; &quot;0 1 2 3 8t&quot;
    ;;
    
bcm96368mvwg)
    ucidef_set_interface_lan &quot;eth0.1&quot;
    ucidef_add_switch &quot;eth0&quot; &quot;1&quot; &quot;1&quot;
    ucidef_add_switch_vlan &quot;eth0&quot; &quot;1&quot; &quot;1 2 4 5 8t&quot;
    ;;

wap-5831n)
    ucidef_set_interfaces_lan_wan &quot;eth0.1&quot; &quot;eth0.2&quot;
    ucidef_add_switch &quot;eth0&quot; &quot;1&quot; &quot;1&quot;
    ucidef_add_switch_vlan &quot;eth0&quot; &quot;1&quot; &quot;0 1 2 3 5t&quot;
    ucidef_add_switch_vlan &quot;eth0&quot; &quot;2&quot; &quot;4 5t&quot;
    ;;
    
dgnd3700v1_dgnd3800b)
    ucidef_set_interfaces_lan_wan &quot;eth0.1&quot; &quot;eth0.2&quot;
    ucidef_add_switch &quot;eth0&quot; &quot;1&quot; &quot;1&quot;
    ucidef_add_switch_vlan &quot;eth0&quot; &quot;1&quot; &quot;1 2 3 4 8t&quot;
    ucidef_add_switch_vlan &quot;eth0&quot; &quot;2&quot; &quot;0 8t&quot;
    ;;

neufbox6)
    ucidef_set_interfaces_lan_wan &quot;eth0.1&quot; &quot;eth0.2&quot;
    ucidef_add_switch &quot;switch0&quot; &quot;1&quot; &quot;1&quot;
    ucidef_add_switch_vlan &quot;switch0&quot; &quot;1&quot; &quot;1 2 3 4 9t&quot;
    ucidef_add_switch_vlan &quot;switch0&quot; &quot;2&quot; &quot;0 9t&quot;
    ;;

vg50)
    ucidef_set_interfaces_lan_wan &quot;eth0.1&quot; &quot;eth0.2&quot;
    ucidef_add_switch &quot;switch0&quot; &quot;1&quot; &quot;1&quot;
    ucidef_add_switch_vlan &quot;switch0&quot; &quot;1&quot; &quot;0 1 2 3 8t&quot;
    ucidef_add_switch_vlan &quot;switch0&quot; &quot;2&quot; &quot;4 8t&quot;
    ;;

bcm963268bu_p300)
    ucidef_set_interface_lan &quot;eth0.1&quot;
    ucidef_add_switch &quot;switch0&quot; &quot;1&quot; &quot;1&quot;
    ucidef_add_switch_vlan &quot;switch0&quot; &quot;1&quot; &quot;0 3 4 5 6 7 8t&quot;
    ;;

*)
    ucidef_set_interfaces_lan_wan &quot;eth1&quot; &quot;eth0&quot;
    ;;

esac

uci commit network

exit 0</code></pre></div><p>01_leds<br /></p><div class="codebox"><pre><code>#!/bin/sh
#
# Copyright (C) 2013-2014 OpenWrt.org
#

. /lib/functions/uci-defaults.sh
. /lib/brcm63xx.sh

case &quot;$(brcm63xx_board_name)&quot; in
a4001n1)
    ucidef_set_led_netdev &quot;lan&quot; &quot;LAN&quot; &quot;A4001N1:green:eth&quot; &quot;eth0&quot;
    ucidef_set_led_usbdev &quot;usb&quot; &quot;USB&quot; &quot;A4001N1:green:3g&quot; &quot;1-1&quot;
    ;;
a4001n)
    ucidef_set_led_usbdev &quot;usb&quot; &quot;USB&quot; &quot;A4001N:green:usb&quot; &quot;1-1&quot;
    ;;
dgnd3700v1_dgnd3800b)
    ucidef_set_led_netdev &quot;lan&quot; &quot;LAN&quot; &quot;DGND3700v1_3800B:green:lan&quot; &quot;eth0.1&quot;
    ucidef_set_led_netdev &quot;wan&quot; &quot;WAN&quot; &quot;DGND3700v1_3800B:green:inet&quot; &quot;eth0.2&quot;
    ucidef_set_led_netdev &quot;wlan0&quot; &quot;WIFI2G&quot; &quot;DGND3700v1_3800B:green:wifi2g&quot; &quot;wlan0&quot;
    ucidef_set_led_netdev &quot;wlan1&quot; &quot;WIFI5G&quot; &quot;DGND3700v1_3800B:blue:wifi5g&quot; &quot;wlan1&quot;
    ucidef_set_led_usbdev &quot;usb1&quot; &quot;USB1&quot; &quot;DGND3700v1_3800B:green:usb-back&quot; &quot;1-1&quot;
    ucidef_set_led_usbdev &quot;usb2&quot; &quot;USB2&quot; &quot;DGND3700v1_3800B:green:usb-front&quot; &quot;1-2&quot;
    ;;
fast2704v2)
    ucidef_set_led_usbdev &quot;usb&quot; &quot;USB&quot; &quot;F@ST2704V2:green:usb&quot; &quot;1-1&quot;
    ;;
hg553)
    ucidef_set_led_netdev &quot;lan&quot; &quot;LAN&quot; &quot;HW553:blue:lan&quot; &quot;eth0&quot;
    ucidef_set_led_usbdev &quot;usb1&quot; &quot;USB1&quot; &quot;HW553:red:hspa&quot; &quot;1-1&quot;
    ucidef_set_led_usbdev &quot;usb2&quot; &quot;USB2&quot; &quot;HW553:blue:hspa&quot; &quot;1-2&quot;
    ;;
hg556a_*)
    ucidef_set_led_netdev &quot;lan&quot; &quot;LAN&quot; &quot;HW556:red:dsl&quot; &quot;eth0&quot;
    ucidef_set_led_usbdev &quot;usb&quot; &quot;USB&quot; &quot;HW556:red:hspa&quot; &quot;1-2&quot;
    ;;
homehub2a)
    ucidef_set_led_netdev &quot;lan&quot; &quot;LAN&quot; &quot;HOMEHUB2A:blue:broadband&quot; &quot;eth0.1&quot;
    ucidef_set_led_netdev &quot;wlan0&quot; &quot;WIFI&quot; &quot;HOMEHUB2A:green:wireless&quot; &quot;wlan0&quot;
    ucidef_set_led_usbdev &quot;usb1&quot; &quot;USB1&quot; &quot;HOMEHUB2A:blue:phone&quot; &quot;1-1&quot;
    ucidef_set_led_usbdev &quot;usb2&quot; &quot;USB2&quot; &quot;HOMEHUB2A:green:phone&quot; &quot;2-1&quot;
    ;;
p870hnu-51c)
    ucidef_set_led_netdev &quot;lan&quot; &quot;LAN&quot; &quot;P870HNU-51c:green:lan&quot; &quot;eth0.1&quot;
    ucidef_set_led_netdev &quot;wan&quot; &quot;WAN&quot; &quot;P870HNU-51c:green:inet&quot; &quot;eth0.2&quot;
    ucidef_set_led_netdev &quot;wlan0&quot; &quot;WIFI2G&quot; &quot;P870HNU-51c:green:wifi2g&quot; &quot;wlan0&quot;
    ucidef_set_led_usbdev &quot;usb1&quot; &quot;USB1&quot; &quot;P870HNU-51c:green:usb-back&quot; &quot;1-1&quot;
    ;;
esac

ucidef_commit_leds

exit 0</code></pre></div><p>From what I can see swconfig can see 8 switch ports total with data for 1 2 3 4 and 8 - assuming 1 2 3 and 4 are the 4 ports on the back and 8 is the internal connection to the SOC.. So it seems like we are close for base functionality here.</p>											<p class="post-edited">(Last edited by <strong>jewest</strong> on 16 May 2015, 08:51)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p276480">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">danitool</div>
					<div class="post-datetime">
						16 May 2015, 12:30					</div>
				</div>
				<div class="post-content content">
					<p>To check which port is connected internally to the CPU, disconnect all lan cables and execute the command<br /></p><div class="codebox"><pre><code>swconfig dev switch0 show</code></pre></div><p>It will show the status of all ports.<br />Now you can check the ports wired externally to a physical rj45 connector. Just connect a lan cable to each port and execute the command again. </p><p>It&#039;s possible your router has the internal port5 connected to the CPU. In this case the config can be something like this<br /></p><div class="quotebox"><blockquote><p><strong>p870hnu-51c</strong>)<br />&nbsp; &nbsp; ucidef_set_interface_lan &quot;eth0.1&quot;<br />&nbsp; &nbsp; ucidef_add_switch &quot;eth0&quot; &quot;1&quot; &quot;1&quot;<br />&nbsp; &nbsp; ucidef_add_switch_vlan &quot;eth0&quot; &quot;1&quot; &quot;0 1 2 3 5t&quot;<br />&nbsp; &nbsp; ;;</p></blockquote></div>											<p class="post-edited">(Last edited by <strong>danitool</strong> on 16 May 2015, 12:30)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p276504">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">jewest</div>
					<div class="post-datetime">
						16 May 2015, 21:30					</div>
				</div>
				<div class="post-content content">
					<p>I have been trying however on my end I have some variation. That is right though 0 1 2 and 3 external then I think port8 is connected to the CPU. </p><p>With all ports disconnected &#039;swconfig dev switch0 show | grep link&#039; provides<br /></p><div class="codebox"><pre><code>root@OpenWrt:/# swconfig dev switch0 show | grep link
        link: port:0 link:down
        link: port:1 link:down
        link: port:2 link:down
        link: port:3 link:down
        link: port:4 link:down
        link: port:5 link:down
        link: port:6 link:down
        link: port:7 link:down
        link: port:8 link:up speed:1000baseT full-duplex</code></pre></div>											<p class="post-edited">(Last edited by <strong>jewest</strong> on 16 May 2015, 22:31)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p276523">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">jewest</div>
					<div class="post-datetime">
						17 May 2015, 03:19					</div>
				</div>
				<div class="post-content content">
					<p>Provided a full boot log below with the modified network settings applied. To me it seems that defaults are not even trying to apply. </p><p>Also having an issue where after it will take firmware just fine but after the first power cycle boot fails with a crc error. </p><div class="codebox"><pre><code>CFE&gt; ATTR openwrt-P870HNU-51c-jffs2-128k-zyxcfe.bin
Loading 192.168.0.100:openwrt-P870HNU-51c-jffs2-128k-zyxcfe.bin ...
Finished loading 7208964 bytes

Flashing root file system and kernel at 0xb9000000:
........................................................

.
*** Image flash done *** !

Resetting board...â–’

CFE version 1.13.0-104.4 for BCM96368 (32bit,SP,BE)
Build Date: 08/17/2010 (kuanjung@MSGSW4-server2)
Copyright (C) 2000-2009 Broadcom Corporation.

Parallel flash device: name S29GL256P90, id 0x2222 size 32768KB
Total Flash size: 32768K with 256 sectors
ethsw: found bcm53115!
Chip ID: BCM6368B2, MIPS: 400MHz
Main Thread: TP0
Total Memory: 67108864 bytes (64MB)
Boot Address: 0xb8000000

Board IP address                  : 192.168.0.2:ffffff00
Host IP address                   : 192.168.0.100
Gateway IP address                : 192.168.0.1
Run from flash/host (f/h)         : f
Default host run file name        : vmlinux
Default host flash file name      : bcm963xx_fs_kernel
Boot delay (0-9 seconds)          : 5
Boot image (0=latest, 1=previous) : 0
Board Id (0-11)                   : 96368MVWG
Number of MAC Addresses (1-32)    : 4
Base MAC Address                  : 08:6c:87:6f:b0:8c
PSI Size (1-128 KBytes            : 128
Enable Backup PSI [0|1]           : 0
System Log Size (0-256) KBytes    : 0
Main Thread Number [0|1]          : 0

*** Press any key to stop auto run (5 seconds) ***
Auto run second count down: 0
Checking Reset button on GPIO 34
Wait for Multiboot Service Packet...  0
flash_addr_kernel b9000100
Booting from latest image (0xb9000000) ...
Code Address: 0x80A00000, Entry Address: 0x80a00000
LZMA: Prossible old LZMA format, trying to decompress..
Decompression OK!
Entry at 0x80a00000
Closing network.
Disabling Switch ports.
Flushing Receive Buffers...
30 buffers found.
Closing DMA Channels.
Starting program at 0x80a00000
[    0.000000] Linux version 3.18.11 (jeff@jeff-Virtual-Machine) (gcc version 4.8.3 (OpenWrt/Linaro GCC 4.8-2014.04 r45692) ) #5 Sat May 16 18:51:24 CDT 2015
[    0.000000] Detected Broadcom 0x6368 CPU revision b2
[    0.000000] CPU frequency is 400 MHz
[    0.000000] 64MB of RAM installed
[    0.000000] board_bcm963xx: Boot address 0xb8000000
[    0.000000] board_bcm963xx: CFE version: 1.13.0-104.4
[    0.000000] bootconsole [early0] enabled
[    0.000000] CPU0 revision is: 0002a031 (Broadcom BMIPS4350)
[    0.000000] board: board name: P870HNU_51c
[    0.000000] MIPS: machine is ZyXEL P870HNU-51c
[    0.000000] Determined physical RAM map:
[    0.000000]  memory: 04000000 @ 00000000 (usable)
[    0.000000] Initrd not found or empty - disabling initrd
[    0.000000] Zone ranges:
[    0.000000]   Normal   [mem 0x00000000-0x03ffffff]
[    0.000000] Movable zone start for each node
[    0.000000] Early memory node ranges
[    0.000000]   node   0: [mem 0x00000000-0x03ffffff]
[    0.000000] Initmem setup node 0 [mem 0x00000000-0x03ffffff]
[    0.000000] Primary instruction cache 64kB, VIPT, 4-way, linesize 16 bytes.
[    0.000000] Primary data cache 32kB, 2-way, VIPT, cache aliases, linesize 16 bytes
[    0.000000] Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 16256
[    0.000000] Kernel command line:  root=/dev/mtdblock2 rootfstype=squashfs,jffs2 noinitrd console=ttyS0,115200
[    0.000000] PID hash table entries: 256 (order: -2, 1024 bytes)
[    0.000000] Dentry cache hash table entries: 8192 (order: 3, 32768 bytes)
[    0.000000] Inode-cache hash table entries: 4096 (order: 2, 16384 bytes)
[    0.000000] Memory: 59964K/65536K available (2656K kernel code, 133K rwdata, 560K rodata, 1316K init, 192K bss, 5572K reserved)
[    0.000000] NR_IRQS:256
[    0.000000] Calibrating delay loop... 397.82 BogoMIPS (lpj=795648)
[    0.036000] pid_max: default: 32768 minimum: 301
[    0.040000] Mount-cache hash table entries: 1024 (order: 0, 4096 bytes)
[    0.044000] Mountpoint-cache hash table entries: 1024 (order: 0, 4096 bytes)
[    0.052000] NET: Registered protocol family 16
[    0.060000] registering PCI controller with io_map_base unset
[    0.068000] PCI host bridge to bus 0000:00
[    0.072000] pci_bus 0000:00: root bus resource [mem 0x30000000-0x37ffffff]
[    0.076000] pci_bus 0000:00: root bus resource [io  0x8000000-0x800ffff]
[    0.080000] pci_bus 0000:00: No busn resource found for root bus, will use [bus 00-ff]
[    0.088000] pci 0000:00:01.0: BAR 0: assigned [mem 0x30000000-0x30003fff]
[    0.092000] Switched to clocksource MIPS
[    0.096000] PCI: Enabling device 0000:00:01.0 (0000 -&gt; 0002)
[    0.124000] ssb: Found chip with id 0xA8D6, rev 0x00 and package 0x08
[    0.168000] ssb: WARNING: Using fallback SPROM failed (err -2)
[    0.172000] ssb: WARNING: Invalid SPROM CRC (corrupt SPROM)
[    0.180000] ssb: Unsupported SPROM revision 255 detected. Will extract v1
[    0.208000] ssb: Sonics Silicon Backplane found on PCI device 0000:00:01.0
[    0.216000] NET: Registered protocol family 2
[    0.224000] TCP established hash table entries: 1024 (order: 0, 4096 bytes)
[    0.228000] TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
[    0.236000] TCP: Hash tables configured (established 1024 bind 1024)
[    0.244000] TCP: reno registered
[    0.248000] UDP hash table entries: 256 (order: 0, 4096 bytes)
[    0.252000] UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
[    0.260000] NET: Registered protocol family 1
[    0.264000] futex hash table entries: 256 (order: -1, 3072 bytes)
[    0.272000] squashfs: version 4.0 (2009/01/31) Phillip Lougher
[    0.280000] jffs2: version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006 Red Hat, Inc.
[    0.288000] msgmni has been set to 117
[    0.296000] io scheduler noop registered
[    0.300000] io scheduler deadline registered (default)
â–’[    0.316000] console [ttyS0] enabled MMIO 0xb0000100 (irq = 10, base_baud = 1562500) is a bcm63xx_uart
[    0.316000] console [ttyS0] enabled
[    0.320000] bootconsole [early0] disabled
[    0.320000] bootconsole [early0] disabled
[    0.332000] bcm63xx-rng bcm63xx-rng: registered RNG driver
[    0.336000] 18000000.nor: Found 1 x16 devices at 0x0 in 16-bit bank. Manufacturer ID 0x0000c2 Chip ID 0x00227e
[    0.348000] Amd/Fujitsu Extended Query Table at 0x0040
[    0.352000]   Amd/Fujitsu Extended Query version 1.3.
[    0.360000] number of CFI chips: 1
[    0.364000] bcm63xxpart: CFE boot tag found with version 6 and board type 96368MVGW
[    0.372000] 6 bcm63xxpart partitions found on MTD device 18000000.nor
[    0.376000] Creating 6 MTD partitions on &quot;18000000.nor&quot;:
[    0.384000] 0x000000000000-0x000000020000 : &quot;CFE&quot;
[    0.388000] 0x000000020100-0x0000001432e2 : &quot;kernel&quot;
[    0.396000] 0x0000001432e2-0x000001e40000 : &quot;rootfs&quot;
[    0.400000] mtd: device 2 (rootfs) set to be root filesystem
[    0.408000] 1 squashfs-split partitions found on MTD device rootfs
[    0.412000] 0x0000004e0000-0x000001e40000 : &quot;rootfs_data&quot;
[    0.420000] 0x000000020000-0x000001e40000 : &quot;linux&quot;
[    0.428000] 0x000001e40000-0x000001fe0000 : &quot;board_data&quot;
[    0.432000] 0x000001fe0000-0x000002000000 : &quot;nvram&quot;
[    0.440000] bcm63xx-spi bcm63xx-spi: at 0xb0000800 (irq 9, FIFOs size 542)
[    0.464000] b53_common: found switch: BCM53115, rev 8
[    0.504000] bcm63xx-wdt bcm63xx-wdt:  started, timer margin: 30 sec
[    0.516000] TCP: cubic registered
[    0.520000] NET: Registered protocol family 17
[    0.524000] bridge: automatic filtering via arp/ip/ip6tables has been deprecated. Update your scripts to load br_netfilter if you need this.
[    0.536000] 8021q: 802.1Q VLAN Support v1.8
[    0.552000] VFS: Mounted root (squashfs filesystem) readonly on device 31:2.
[    0.576000] Freeing unused kernel memory: 1316K (80357000 - 804a0000)
[    1.992000] init: failed to symlink /tmp -&gt; /var
[    1.996000] init: Console is alive
[    2.000000] init: - watchdog -
[    4.608000] usbcore: registered new interface driver usbfs
[    4.616000] usbcore: registered new interface driver hub
[    4.620000] usbcore: registered new device driver usb
[    4.636000] exFAT: Version 1.2.9
[    4.656000] SCSI subsystem initialized
[    4.672000] ehci_hcd: USB 2.0 &#039;Enhanced&#039; Host Controller (EHCI) Driver
[    4.684000] ehci-platform: EHCI generic platform driver
[    4.792000] ehci-platform ehci-platform: EHCI Host Controller
[    4.796000] ehci-platform ehci-platform: new USB bus registered, assigned bus number 1
[    4.804000] ehci-platform ehci-platform: irq 15, io mem 0xb0001500
[    4.824000] ehci-platform ehci-platform: USB 2.0 started, EHCI 1.00, overcurrent ignored
[    4.832000] hub 1-0:1.0: USB hub found
[    4.836000] hub 1-0:1.0: 1 port detected
[    4.844000] ohci_hcd: USB 1.1 &#039;Open&#039; Host Controller (OHCI) Driver
[    4.852000] ohci-platform: OHCI generic platform driver
[    4.860000] ohci-platform ohci-platform: Generic Platform OHCI controller
[    4.868000] ohci-platform ohci-platform: new USB bus registered, assigned bus number 2
[    4.876000] ohci-platform ohci-platform: irq 13, io mem 0xb0001600
[    4.940000] hub 2-0:1.0: USB hub found
[    4.944000] hub 2-0:1.0: 1 port detected
[    4.956000] usbcore: registered new interface driver usb-storage
[    5.052000] init: - preinit -
[    5.696000] random: mktemp urandom read with 23 bits of entropy available
Press the [f] key and hit [enter] to enter failsafe mode
Press the [1], [2], [3] or [4] key and hit [enter] to select the debug level
[    9.088000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b20000: 0x3600 instead
[    9.100000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b20004: 0x5a79 instead
[    9.108000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b20008: 0x4c5f instead
[    9.116000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b2000c: 0x3031 instead
[    9.128000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b20018: 0x7665 instead
[    9.136000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b2001c: 0x2032 instead
[    9.148000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b20028: 0x3638 instead
[    9.156000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b2002c: 0x3936 instead
[    9.168000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b20030: 0x384d instead
[    9.176000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b20034: 0x5700 instead
[    9.184000] jffs2: Further such events for this erase block will not be printed
[    9.196000] jffs2: Old JFFS2 bitmask found at 0x00b20a00
[    9.200000] jffs2: You cannot use older JFFS2 filesystems with newer kernels
[    9.224000] jffs2: Old JFFS2 bitmask found at 0x00b2b8fc
[    9.228000] jffs2: You cannot use older JFFS2 filesystems with newer kernels
[    9.268000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b40000: 0x8be7 instead
[    9.276000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b40004: 0x0f76 instead
[    9.288000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b40008: 0x9578 instead
[    9.296000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b4000c: 0xea19 instead
[    9.308000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b40010: 0x7d49 instead
[    9.316000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b40014: 0x2b32 instead
[    9.328000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b40018: 0xac95 instead
[    9.336000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b4001c: 0x6947 instead
[    9.348000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b40020: 0xe7de instead
[    9.356000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b40024: 0x8eba instead
[    9.364000] jffs2: Further such events for this erase block will not be printed
[    9.424000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b60000: 0x9e6e instead
[    9.432000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b60004: 0x537d instead
[    9.440000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b60008: 0xd779 instead
[    9.452000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b6000c: 0x57ff instead
[    9.460000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b60010: 0xf570 instead
[    9.472000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b60014: 0x151a instead
[    9.480000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b60018: 0x3f8c instead
[    9.492000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b6001c: 0x9248 instead
[    9.500000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b60020: 0x7f84 instead
[    9.512000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b60024: 0xf09e instead
[    9.520000] jffs2: Further such events for this erase block will not be printed
[    9.576000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b80000: 0x984c instead
[    9.588000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b80004: 0xacb0 instead
[    9.596000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b80008: 0xdab1 instead
[    9.604000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b8000c: 0x6aa5 instead
[    9.616000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b80010: 0x7d77 instead
[    9.624000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b80014: 0x7424 instead
[    9.636000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b80018: 0xbec3 instead
[    9.644000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b8001c: 0xc9a7 instead
[    9.656000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b80020: 0x4944 instead
[    9.664000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00b80024: 0x54d0 instead
[    9.676000] jffs2: Further such events for this erase block will not be printed
[    9.732000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00ba0000: 0x86b8 instead
[    9.740000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00ba0004: 0xfa99 instead
[    9.752000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00ba0008: 0xa8c5 instead
[    9.760000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00ba000c: 0x235a instead
[    9.768000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00ba0010: 0xa5ba instead
[    9.780000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00ba0014: 0xb580 instead
[    9.788000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00ba0018: 0xfc79 instead
[    9.800000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00ba001c: 0xe9ae instead
[    9.808000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00ba0020: 0x27c0 instead
[    9.820000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00ba0024: 0x15bd instead
[    9.828000] jffs2: Further such events for this erase block will not be printed
[    9.884000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00bc0000: 0xe1d1 instead
[    9.896000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00bc0004: 0x710b instead
[    9.904000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00bc0008: 0x9b4a instead
[    9.916000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00bc000c: 0x29a7 instead
[    9.924000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00bc0010: 0xdf0f instead
[    9.936000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00bc0014: 0xf277 instead
[    9.944000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00bc0018: 0x220b instead
[    9.952000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00bc001c: 0xc55b instead
[    9.964000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00bc0020: 0x9a28 instead
[    9.972000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00bc0024: 0x7f47 instead
[    9.984000] jffs2: Further such events for this erase block will not be printed
[   10.040000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00be0000: 0x10c0 instead
[   10.048000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00be0004: 0x525a instead
[   10.060000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00be0008: 0xbf86 instead
[   10.068000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00be000c: 0x6efe instead
[   10.080000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00be0010: 0x35c4 instead
[   10.088000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00be0014: 0x2ef2 instead
[   10.100000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00be0018: 0xe7d9 instead
[   10.108000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00be001c: 0x967f instead
[   10.116000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00be0020: 0xb135 instead
[   10.128000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00be0024: 0xa0ab instead
[   10.136000] jffs2: Further such events for this erase block will not be printed
[   10.192000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00c00000: 0x9f46 instead
[   10.204000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00c00004: 0xd728 instead
[   10.212000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00c00008: 0x89ef instead
[   10.224000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00c0000c: 0xb161 instead
[   10.232000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00c00010: 0xfb6a instead
[   10.244000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00c00014: 0xa2c3 instead
[   10.252000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00c00018: 0x991b instead
[   10.264000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00c0001c: 0xc345 instead
[   10.272000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00c00020: 0x0fae instead
[   10.280000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00c00024: 0xd495 instead
[   10.292000] jffs2: Further such events for this erase block will not be printed
[   10.316000] jffs2: Old JFFS2 bitmask found at 0x00c09b7c
[   10.320000] jffs2: You cannot use older JFFS2 filesystems with newer kernels
[   10.360000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00c20000: 0x61da instead
[   10.372000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00c20004: 0x0728 instead
[   10.380000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00c20008: 0x3cac instead
[   10.388000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00c2000c: 0xd4b6 instead
[   10.400000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00c20010: 0xefa3 instead
[   10.408000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00c20014: 0xfab6 instead
[   10.420000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00c20018: 0xbacc instead
[   10.428000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00c2001c: 0x0883 instead
[   10.440000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00c20020: 0xe08b instead
[   10.448000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00c20024: 0x80a0 instead
[   10.460000] jffs2: Further such events for this erase block will not be printed
[   10.492000] jffs2: Old JFFS2 bitmask found at 0x00c30ecc
[   10.496000] jffs2: You cannot use older JFFS2 filesystems with newer kernels
[   10.528000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00c40000: 0xa2a2 instead
[   10.536000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00c40004: 0xe47c instead
[   10.548000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00c40008: 0xf6a1 instead
[   10.556000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00c4000c: 0x89af instead
[   10.568000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00c40010: 0x10a4 instead
[   10.576000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00c40014: 0x2d8c instead
[   10.588000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00c40018: 0x7117 instead
[   10.596000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00c4001c: 0xa687 instead
[   10.604000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00c40020: 0x40fe instead
[   10.616000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00c40024: 0xd2ad instead
[   10.624000] jffs2: Further such events for this erase block will not be printed
[   11.948000] jffs2_scan_eraseblock(): End of filesystem marker found at 0x11e0000
[   11.956000] jffs2_build_filesystem(): unlocking the mtd device... done.
[   11.964000] jffs2_build_filesystem(): erasing all blocks after the end marker...
[   33.356000] random: nonblocking pool is initialized
[   63.516000] done.
[   63.520000] jffs2: notice: (254) jffs2_build_xattr_subsystem: complete building xattr subsystem, 0 of xdatum (0 unchecked, 0 orphan) and 0 of xref (0 dead, 0 orphan) found.
[   63.540000] mount_root: overlay filesystem has not been fully initialized yet
[   65.792000] mount_root: switching to jffs2 overlay
ifconfig: SIOCGIFFLAGS: No such device
[   65.828000] procd: - early -
[   65.828000] procd: - watchdog -
[   67.480000] procd: - ubus -
[   68.488000] procd: - init -
Please press Enter to activate this console.
[   70.808000] NET: Registered protocol family 10
[   72.240000] wl: module license &#039;unspecified&#039; taints kernel.
[   72.244000] Disabling lock debugging due to kernel taint
[   72.352000] SSB/BCMA glue driver successfully attached
[   72.384000] fallback_sprom: pci bus/device num mismatch: expected 0/0, but got 0/1
[   72.392000] BCMA8D6(00:01) using sprom version 0
[   72.404000] wl0: 5.10.56.27 driver failed with code 15
[   72.460000] ntfs: driver 2.1.31 [Flags: R/O MODULE].
[   72.484000] ip6_tables: (C) 2000-2006 Netfilter Core Team
[   72.520000] Loading modules backported from Linux version master-2015-03-09-0-g141f155
[   72.528000] Backport generated by backports.git backports-20150129-0-gdd4a670
[   72.540000] ip_tables: (C) 2000-2006 Netfilter Core Team
[   72.560000] nf_conntrack version 0.5.0 (957 buckets, 3828 max)
[   72.596000] usbcore: registered new interface driver ums-alauda
[   72.604000] usbcore: registered new interface driver ums-cypress
[   72.616000] usbcore: registered new interface driver ums-datafab
[   72.624000] usbcore: registered new interface driver ums-freecom
[   72.632000] usbcore: registered new interface driver ums-isd200
[   72.644000] usbcore: registered new interface driver ums-jumpshot
[   72.652000] usbcore: registered new interface driver ums-karma
[   72.664000] usbcore: registered new interface driver ums-sddr09
[   72.672000] usbcore: registered new interface driver ums-sddr55
[   72.680000] usbcore: registered new interface driver ums-usbat
[   72.712000] xt_time: kernel timezone is -0000
[   73.308000] cfg80211: Calling CRDA to update world regulatory domain
[   73.340000] cfg80211: World regulatory domain updated:
[   73.344000] cfg80211:  DFS Master region: unset
[   73.348000] cfg80211:   (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp), (dfs_cac_time)
[   73.356000] cfg80211:   (2402000 KHz - 2472000 KHz @ 40000 KHz), (N/A, 2000 mBm), (N/A)
[   73.368000] cfg80211:   (2457000 KHz - 2482000 KHz @ 40000 KHz), (N/A, 2000 mBm), (N/A)
[   73.376000] cfg80211:   (2474000 KHz - 2494000 KHz @ 20000 KHz), (N/A, 2000 mBm), (N/A)
[   73.384000] cfg80211:   (5170000 KHz - 5250000 KHz @ 80000 KHz), (N/A, 2000 mBm), (N/A)
[   73.392000] cfg80211:   (5250000 KHz - 5330000 KHz @ 80000 KHz, 160000 KHz AUTO), (N/A, 2000 mBm), (0 s)
[   73.400000] cfg80211:   (5490000 KHz - 5730000 KHz @ 160000 KHz), (N/A, 2000 mBm), (0 s)
[   73.408000] cfg80211:   (5735000 KHz - 5835000 KHz @ 80000 KHz), (N/A, 2000 mBm), (N/A)
[   73.416000] cfg80211:   (57240000 KHz - 63720000 KHz @ 2160000 KHz), (N/A, 0 mBm), (N/A)
[   73.532000] PPP generic driver version 2.4.2
[   73.536000] NET: Registered protocol family 24
[   73.588000] Broadcom 43xx driver loaded [ Features: PNL ]



BusyBox v1.23.2 (2015-05-16 15:09:42 CDT) built-in shell (ash)

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 -----------------------------------------------------
 CHAOS CALMER (Bleeding Edge, r45692)
 -----------------------------------------------------
  * 1 1/2 oz Gin            Shake with a glassful
  * 1/4 oz Triple Sec       of broken ice and pour
  * 3/4 oz Lime Juice       unstrained into a goblet.
  * 1 1/2 oz Orange Juice
  * 1 tsp. Grenadine Syrup
 -----------------------------------------------------
root@OpenWrt:/# reboot

CFE version 1.13.0-104.4 for BCM96368 (32bit,SP,BE)
Build Date: 08/17/2010 (kuanjung@MSGSW4-server2)
Copyright (C) 2000-2009 Broadcom Corporation.

Parallel flash device: name S29GL256P90, id 0x2222 size 32768KB
Total Flash size: 32768K with 256 sectors
ethsw: found bcm53115!
Chip ID: BCM6368B2, MIPS: 400MHz
Main Thread: TP0
Total Memory: 67108864 bytes (64MB)
Boot Address: 0xb8000000

Board IP address                  : 192.168.0.2:ffffff00
Host IP address                   : 192.168.0.100
Gateway IP address                : 192.168.0.1
Run from flash/host (f/h)         : f
Default host run file name        : vmlinux
Default host flash file name      : bcm963xx_fs_kernel
Boot delay (0-9 seconds)          : 5
Board Id (0-11)                   : 96368MVWG
Number of MAC Addresses (1-32)    : 4
Base MAC Address                  : 08:6c:87:6f:b0:8c
PSI Size (1-128 KBytes            : 128
Enable Backup PSI [0|1]           : 0
System Log Size (0-256) KBytes    : 0
Main Thread Number [0|1]          : 0

*** Press any key to stop auto run (5 seconds) ***
Auto run second count down: 0
Checking Reset button on GPIO 34
Wait for Multiboot Service Packet...  0
flash_addr_kernel b8020100
Booting from only image (0xb8020000) ...
Code Address: 0x80A00000, Entry Address: 0x80a00000
Linux file system CRC error.  Corrupted image?
web info: Waiting for connection on socket 0.
CFE&gt;</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p276544">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">danitool</div>
					<div class="post-datetime">
						17 May 2015, 12:39					</div>
				</div>
				<div class="post-content content">
					<p>For the CRC error, after the first boot you can execute the command<br /></p><div class="codebox"><pre><code>mtd fixtrx linux</code></pre></div><p>Or add your router to the file:<br /><a href="https://dev.openwrt.org/browser/trunk/target/linux/brcm63xx/base-files/etc/uci-defaults/09_fix_crc">https://dev.openwrt.org/browser/trunk/t â€¦ 09_fix_crc</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p276606">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">jewest</div>
					<div class="post-datetime">
						18 May 2015, 05:01					</div>
				</div>
				<div class="post-content content">
					<p>Nice that worked!! Same issue when adding to the config files though where it does not apply. </p><p>Same with the switch.. I am able to get some functionality with manual configuration just no default config is being applied across led network and now crc config files.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p277459">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">jewest</div>
					<div class="post-datetime">
						25 May 2015, 06:56					</div>
				</div>
				<div class="post-content content">
					<p>For the switch configuration.. In the current state I am able to enable the switch - Connectivity exists externally just I am not able to gain connectivity to the OS/SOC. Provided latest test configuration below.</p><p>/etc/config/network<br /></p><div class="codebox"><pre><code>config interface &#039;loopback&#039;
        option ifname &#039;lo&#039;
        option proto &#039;static&#039;
        option ipaddr &#039;127.0.0.1&#039;
        option netmask &#039;255.0.0.0&#039;

config globals &#039;globals&#039;
        option ula_prefix &#039;fda9:b384:91bb::/48&#039;

config interface &#039;eth0&#039;
        option ifname &#039;eth0&#039;
        option proto &#039;static&#039;
        option ipaddr &#039;192.168.1.2&#039;
        option netmask &#039;255.255.255.0&#039;

config interface &#039;lan&#039;
        option ifname &#039;eth0&#039;
        option force_link &#039;1&#039;
        option type &#039;bridge&#039;
        option proto &#039;static&#039;
        option ipaddr &#039;192.168.1.2&#039;
        option netmask &#039;255.255.255.0&#039;
        option ip6assign &#039;60&#039;

config interface &#039;wan&#039;
        option ifname &#039;eth0.1&#039;
        option proto &#039;dhcp&#039;

config interface &#039;wan6&#039;
        option ifname &#039;eth0.1&#039;
        option proto &#039;dhcpv6&#039;

config &#039;switch&#039; &#039;eth0&#039;
        option &#039;enable&#039; &#039;1&#039;

config &#039;switch_vlan&#039;
        option &#039;vlan&#039;   &#039;0&#039;
        option &#039;device&#039; &#039;eth0&#039;
        option &#039;ports&#039;  &#039;1 2 3 8t&#039;

config &#039;switch_vlan&#039;
        option &#039;vlan&#039;   &#039;1&#039;
        option &#039;device&#039; &#039;eth0&#039;
        option &#039;ports&#039;  &#039;0 8t&#039;

config &#039;switch_port&#039;
        option &#039;port&#039;   &#039;0&#039;
        option &#039;pvid&#039;   &#039;1&#039;</code></pre></div><p>With this applied ifconfig provides the following<br /></p><div class="codebox"><pre><code>br-lan    Link encap:Ethernet  HWaddr 08:6C:87:6F:B0:8C
          inet addr:192.168.1.2  Bcast:192.168.1.255  Mask:255.255.255.0
          inet6 addr: fda9:b384:91bb::1/60 Scope:Global
          inet6 addr: fe80::a6c:87ff:fe6f:b08c/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:156 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:0 (0.0 B)  TX bytes:14688 (14.3 KiB)

eth0      Link encap:Ethernet  HWaddr 08:6C:87:6F:B0:8C
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:5815 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 B)  TX bytes:1896437 (1.8 MiB)

eth0.1    Link encap:Ethernet  HWaddr 08:6C:87:6F:B0:8C
          inet6 addr: fe80::a6c:87ff:fe6f:b08c/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:994 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:0 (0.0 B)  TX bytes:333197 (325.3 KiB)

lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:23002 errors:0 dropped:0 overruns:0 frame:0
          TX packets:23002 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:1564576 (1.4 MiB)  TX bytes:1564576 (1.4 MiB)</code></pre></div><p>Configuration based on details provided from swconfig however I sure I am missing something here. <br /></p><div class="codebox"><pre><code>root@OpenWrt:/# swconfig dev switch0 show
Global attributes:
        enable_vlan: 1
        ports: 0x011f
        reset_mib: ???
        enable_jumbo: 0
        allow_vid_4095: 0
Port 0:
        mib: TxOctets            : 0
TxDropPkts          : 0
TxBroadcastPkts     : 0
TxMulticastPkts     : 0
TxUnicastPkts       : 0
TxCollisions        : 0
TxSingleCollision   : 0
TxMultipleCollision : 0
TxDeferredTransmit  : 0
TxLateCollision     : 0
TxExcessiveCollision: 0
TxPausePkts         : 0
RxOctets            : 0
RxUndersizePkts     : 0
RxPausePkts         : 0
Pkts64Octets        : 0
Pkts65to127Octets   : 0
Pkts128to255Octets  : 0
Pkts256to511Octets  : 0
Pkts512to1023Octets : 0
Pkts1024to1522Octets: 0
RxOversizePkts      : 0
RxJabbers           : 0
RxAlignmentErrors   : 0
RxFCSErrors         : 0
RxGoodOctets        : 0
RxDropPkts          : 0
RxUnicastPkts       : 0
RxMulticastPkts     : 0
RxBroadcastPkts     : 0
RxSAChanges         : 0
RxFragments         : 0
RxJumboPkts         : 0
RxSymbolErrors      : 0
RxDiscarded         : 0

        pvid: 1
        link: port:0 link:down
Port 1:
        mib: TxOctets            : 0
TxDropPkts          : 0
TxBroadcastPkts     : 0
TxMulticastPkts     : 0
TxUnicastPkts       : 0
TxCollisions        : 0
TxSingleCollision   : 0
TxMultipleCollision : 0
TxDeferredTransmit  : 0
TxLateCollision     : 0
TxExcessiveCollision: 0
TxPausePkts         : 0
RxOctets            : 136142
RxUndersizePkts     : 0
RxPausePkts         : 0
Pkts64Octets        : 40
Pkts65to127Octets   : 539
Pkts128to255Octets  : 406
Pkts256to511Octets  : 20
Pkts512to1023Octets : 0
Pkts1024to1522Octets: 0
RxOversizePkts      : 0
RxJabbers           : 0
RxAlignmentErrors   : 0
RxFCSErrors         : 0
RxGoodOctets        : 136142
RxDropPkts          : 0
RxUnicastPkts       : 0
RxMulticastPkts     : 813
RxBroadcastPkts     : 192
RxSAChanges         : 1
RxFragments         : 0
RxJumboPkts         : 0
RxSymbolErrors      : 0
RxDiscarded         : 1005

        pvid: 0
        link: port:1 link:up speed:1000baseT full-duplex auto
Port 2:
        mib: TxOctets            : 0
TxDropPkts          : 0
TxBroadcastPkts     : 0
TxMulticastPkts     : 0
TxUnicastPkts       : 0
TxCollisions        : 0
TxSingleCollision   : 0
TxMultipleCollision : 0
TxDeferredTransmit  : 0
TxLateCollision     : 0
TxExcessiveCollision: 0
TxPausePkts         : 0
RxOctets            : 173927
RxUndersizePkts     : 0
RxPausePkts         : 0
Pkts64Octets        : 69
Pkts65to127Octets   : 691
Pkts128to255Octets  : 508
Pkts256to511Octets  : 28
Pkts512to1023Octets : 0
Pkts1024to1522Octets: 0
RxOversizePkts      : 0
RxJabbers           : 0
RxAlignmentErrors   : 0
RxFCSErrors         : 0
RxGoodOctets        : 173927
RxDropPkts          : 0
RxUnicastPkts       : 0
RxMulticastPkts     : 1045
RxBroadcastPkts     : 251
RxSAChanges         : 0
RxFragments         : 0
RxJumboPkts         : 0
RxSymbolErrors      : 0
RxDiscarded         : 498

        pvid: 0
        link: port:2 link:down
Port 3:
        mib: TxOctets            : 0
TxDropPkts          : 0
TxBroadcastPkts     : 0
TxMulticastPkts     : 0
TxUnicastPkts       : 0
TxCollisions        : 0
TxSingleCollision   : 0
TxMultipleCollision : 0
TxDeferredTransmit  : 0
TxLateCollision     : 0
TxExcessiveCollision: 0
TxPausePkts         : 0
RxOctets            : 0
RxUndersizePkts     : 0
RxPausePkts         : 0
Pkts64Octets        : 0
Pkts65to127Octets   : 0
Pkts128to255Octets  : 0
Pkts256to511Octets  : 0
Pkts512to1023Octets : 0
Pkts1024to1522Octets: 0
RxOversizePkts      : 0
RxJabbers           : 0
RxAlignmentErrors   : 0
RxFCSErrors         : 0
RxGoodOctets        : 0
RxDropPkts          : 0
RxUnicastPkts       : 0
RxMulticastPkts     : 0
RxBroadcastPkts     : 0
RxSAChanges         : 0
RxFragments         : 0
RxJumboPkts         : 0
RxSymbolErrors      : 0
RxDiscarded         : 0

        pvid: 0
        link: port:3 link:down
Port 4:
        mib: TxOctets            : 0
TxDropPkts          : 0
TxBroadcastPkts     : 0
TxMulticastPkts     : 0
TxUnicastPkts       : 0
TxCollisions        : 0
TxSingleCollision   : 0
TxMultipleCollision : 0
TxDeferredTransmit  : 0
TxLateCollision     : 0
TxExcessiveCollision: 0
TxPausePkts         : 0
RxOctets            : 0
RxUndersizePkts     : 0
RxPausePkts         : 0
Pkts64Octets        : 0
Pkts65to127Octets   : 0
Pkts128to255Octets  : 0
Pkts256to511Octets  : 0
Pkts512to1023Octets : 0
Pkts1024to1522Octets: 0
RxOversizePkts      : 0
RxJabbers           : 0
RxAlignmentErrors   : 0
RxFCSErrors         : 0
RxGoodOctets        : 0
RxDropPkts          : 0
RxUnicastPkts       : 0
RxMulticastPkts     : 0
RxBroadcastPkts     : 0
RxSAChanges         : 0
RxFragments         : 0
RxJumboPkts         : 0
RxSymbolErrors      : 0
RxDiscarded         : 0

        pvid: 0
        link: port:4 link:down
Port 5:
        mib: ???
        pvid: 0
        link: port:5 link:down
Port 6:
        mib: ???
        pvid: 0
        link: port:6 link:down
Port 7:
        mib: ???
        pvid: 0
        link: port:7 link:down
Port 8:
        mib: TxOctets            : 119355
TxDropPkts          : 0
TxBroadcastPkts     : 123
TxMulticastPkts     : 675
TxUnicastPkts       : 0
TxCollisions        : 0
TxSingleCollision   : 0
TxMultipleCollision : 0
TxDeferredTransmit  : 0
TxLateCollision     : 0
TxExcessiveCollision: 0
TxPausePkts         : 0
RxOctets            : 0
RxUndersizePkts     : 0
RxPausePkts         : 0
Pkts64Octets        : 0
Pkts65to127Octets   : 0
Pkts128to255Octets  : 0
Pkts256to511Octets  : 0
Pkts512to1023Octets : 0
Pkts1024to1522Octets: 0
RxOversizePkts      : 0
RxJabbers           : 0
RxAlignmentErrors   : 0
RxFCSErrors         : 0
RxGoodOctets        : 0
RxDropPkts          : 0
RxUnicastPkts       : 0
RxMulticastPkts     : 0
RxBroadcastPkts     : 0
RxSAChanges         : 0
RxFragments         : 0
RxJumboPkts         : 0
RxSymbolErrors      : 0
RxDiscarded         : 0

        pvid: 0
        link: port:8 link:up speed:1000baseT full-duplex
VLAN 1:
        ports: 0 8t
root@OpenWrt:/# swconfig dev switch0 show | grep link
        link: port:0 link:down
        link: port:1 link:up speed:1000baseT full-duplex auto
        link: port:2 link:down
        link: port:3 link:down
        link: port:4 link:down
        link: port:5 link:down
        link: port:6 link:down
        link: port:7 link:down
        link: port:8 link:up speed:1000baseT full-duplex</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p277474">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">danitool</div>
					<div class="post-datetime">
						25 May 2015, 11:55					</div>
				</div>
				<div class="post-content content">
					<p>Test this config</p><div class="codebox"><pre><code>config interface &#039;loopback&#039;
        option ifname &#039;lo&#039;
        option proto &#039;static&#039;
        option ipaddr &#039;127.0.0.1&#039;
        option netmask &#039;255.0.0.0&#039;

config globals &#039;globals&#039;
        option ula_prefix &#039;fda5:ace8:376d::/48&#039;

config interface &#039;lan&#039;
        option ifname &#039;eth0.1&#039;
        option type &#039;bridge&#039;
        option proto &#039;static&#039;
        option ipaddr &#039;192.168.1.1&#039;
        option netmask &#039;255.255.255.0&#039;
        option ip6assign &#039;60&#039;

config interface &#039;wan&#039;
        option ifname &#039;eth0.2&#039;
        option proto &#039;dhcp&#039;
        
config switch
        option name &#039;eth0&#039;
        option reset &#039;1&#039;
        option enable_vlan &#039;1&#039;

config switch_vlan
        option device &#039;eth0&#039;
        option vlan &#039;1&#039;
        option ports &#039;1 2 3 8t&#039;

config switch_vlan
        option device &#039;eth0&#039;
        option vlan &#039;2&#039;
        option ports &#039;0 8t&#039; </code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p277529">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">jewest</div>
					<div class="post-datetime">
						25 May 2015, 20:55					</div>
				</div>
				<div class="post-content content">
					<p>Applied the configuration but still not getting through the switch the OS/SOC. Looking at the swconfig for port 8 shows null counters where port 1 (lan 1) seems to increment at least for RX. Tried to disable vlan&#039;s also but did not have much luck there either.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p282107">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">Reed_Solomon</div>
					<div class="post-datetime">
						2 Jul 2015, 07:02					</div>
				</div>
				<div class="post-content content">
					<p>So I&#039;ve got one of these routers as well, latest openwrt RC2 installs fine, and you can get into the device and log in from the serial connection, but no access through ethernet.&nbsp; I also tried danitool&#039;s configuration and it didn&#039;t work.&nbsp; The power light is on red, not green, not sure if that signifies anything.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>