<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> 2A to USB with OpenWRT</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 6 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p347940">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">dgoiko</div>
					<div class="post-datetime">
						29 Dec 2016, 11:51					</div>
				</div>
				<div class="post-content content">
					<p>Hello.</p><p>I&#039;m looking for the best relation of price/quality on a piece of hardware compatible with OpenWRT which is able to power up a 2A USB device smoothly.</p><p>This is the scenario:</p><p>I want to plug an alfa wireless usb card (AWUS036NH) attached to an external yagi antena to an OpenWRT router and use it to connect to a distant AP. Then, the device will make a local wifi network, or provide ethernet access (if the device doesnt have wifi itself, its not a must, althought it would be interesting) to add a local AP.</p><p>Installing USB drivers and Alfa is not a problem, I currently have it working on a Raspberry Pi 3 with the latest trunk compiled, and it works just fine.</p><p>Why I want to do that?</p><p>I used to have a dual antenna conceptronic router, however we changed the AP antenna ant the conceptronic strenght was not enough. When I bought a Yagi antenna and connected it to one of the pigtails I found out it wont work as expected (I guess the device uses both antennas at the same time, not an expert in wifi though), so I tried to connect the Yagi to my usb NIC (AWUS036NH) and found out the target network was in range, and the connection worked just fine. Next step was to attach the Alfa to a router and make it connect through it. PD: I realize an ubiquiti antenna would have made the deal in one single device, but thats not the goal of this.</p><p>I just know the basics of electricity, however, as far I know, the usb port current output depends on the AC adapter max current. However, I&#039;m not sure if there&#039;s a limitation. For example, the router uses 0,2 A and the wifi card uses 2, will a 2,2 A (2,5 to be safe) power source will be enough, or some hardware pieces will have a limitation that wont allow the usb to have the full 2A current? (Sorry for the electrical newbie question xD).</p><p>As you know, raspberry pi is not the optimal hardware for network stuff, but it is working just fine, I dont need faster speeds or anything like that. The reasons to switch to another platform are:</p><p>1.- I want to use my raspberry somewhere else, and I&#039;d preffer to get a working replacement for this scenario at a lower price than a raspberry (which goes from 40 to 50 $, depending on accesories and AC adaptor).<br />2.- Experimenting and learning about usb current limitations and planification.</p><p>After some research I came up with those devices:<br />&lt;openwrtwiki&gt;/toh/gl-inet/gl-inet_64xx<br />&lt;openwrtwiki&gt;/toh/tp-link/tl-wr703n<br />&lt;openwrtwiki&gt;/toh/tp-link/tl-mr3020</p><p>Those are the requeriments of the device:<br />1.- Device+appropiate AC converter&#039;s price should be lower than Raspberry Pi3 + case+ AC converter + cheap sd<br />2.- Device MUST be able to power a 2A usb network card<br />3.- Device should have usb AC input: I already have 2.5A/3A power supplies, and it it easier and cheaper to find appropiate AC converters. This is not a must if the in-box power supply gives enough current for the Alfa<br />4.- Built-in wifi in the device is not a must, but it is highly desirable.</p><p>Currently, the cheapest device that APPARENTLY fullfills my needs is this one:</p><br /><p>&nbsp; &nbsp; TP-LINK-TL-MR3020-Portable-3G-4G-USB-Modem-Wireless-N-WiFi-Router-Access-point</p><br /><p>It is as cheap as 28$ and free shipping, plus 5-10 $ for a 2.5 A charger.</p><br /><p>Please, keep in mind that normal wifi adaptors dont give enough current to the antena to reach my AP. AWUS036NH is the strongest (correct me if I&#039;m wrong) Alfa I know, so it MAY need full power everytime to reach its target. I&#039;m not sure of this though, I&#039;m not an expert in wifi+current</p><p>PS: AWUS036NH claims to be a 2A network adapter, however I have not measured its current yet. I&#039;m waiting the shipment of a current usb&nbsp; meter. Unless someone knows the exact current, we&#039;ll asume it is 2A.</p><p>PS2: I&#039;ve seen that it is possible to hardware hack devices like GL and the MR3020 to attach an external antenna. Will those devices be able to deliver 2A current to the antenna (while using a big enough AC converter, lets say 3A) or its limited to 0,2-0,5 A like normal wifi cards?</p><p>PS3: Even thought I&#039;m now curious about this and I&#039;d like to have ti solved my way, if any of you know a device like the ones listed before which can be plugged DIRECTLY to a SINGLE pigtail antena and deliver ~2A current, please tell me so I can evaluate pros and cons.</p><p>PS4: I want to learn soldering, however, I&#039;m not ready to do hardware hacks myself. I know someone who would do the soldering for me, so hardware hack is on the table, although I preffer avoiding it.</p>											<p class="post-edited">(Last edited by <strong>dgoiko</strong> on 29 Dec 2016, 11:56)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p347941">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">tmo26</div>
					<div class="post-datetime">
						29 Dec 2016, 12:31					</div>
				</div>
				<div class="post-content content">
					<p>2A out of a USB port is quite a bit. Only &quot;charging&quot; USB ports or USB Type C will be able to deliver 2A.</p><p>What makes you think the MR3020 can deliver 2A?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p347951">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">mk24</div>
					<div class="post-datetime">
						29 Dec 2016, 16:39					</div>
				</div>
				<div class="post-content content">
					<p>Many of the pocket routers and others with their primary power supply being 5 volts, have the USB port directly connected to that power rail.&nbsp; So there is no hardware inside the router limiting how much power you can draw from the USB port, it is limited by the power supply.</p><p>Routers with a 12 volt input have an internal regulator to produce 5 volts for the USB port.&nbsp; The capacity of those varies.</p><p>You can always use an external powered USB hub.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p347967">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">dgoiko</div>
					<div class="post-datetime">
						29 Dec 2016, 19:17					</div>
				</div>
				<div class="post-content content">
					<p>Thank you both for your replies, specially mk24&#039;s.</p><p>Asuming normal 5v routers like MR3020 have the usb directly connected to the power rail any of them can suit my needs about usb current.</p><p>This being solved, which one of the routers I mentioned performs better with OpenWRT? Is there a 5v router that suits my needs better? GL-Inet seem to be TL-MR3020 clones with&nbsp; better specifications, do they really perform better? One even had an external detachable antenna...</p><div class="quotebox"><cite>tmo26 wrote:</cite><blockquote><p>2A out of a USB port is quite a bit. Only &quot;charging&quot; USB ports or USB Type C will be able to deliver 2A.</p><p>What makes you think the MR3020 can deliver 2A?</p></blockquote></div><br /><p>That was the core of my question. I know my raspberry can power the Alfa, as it can fastcharge devices connected to it, but I wasnt sure about routers until mk24 pointed out that most 5v routers have the usb power connected directly to the main power rail. In that case,&nbsp; as long as the AC converter can provide 2A+the consumption of the board itself the alfa will be correctly powered.</p><p>Anyway, I&#039;d like confirmation that those specific routers work as that (however, it is the cheapest way to build it, so probably they do xD)</p>											<p class="post-edited">(Last edited by <strong>dgoiko</strong> on 29 Dec 2016, 19:38)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p348044">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">dgoiko</div>
					<div class="post-datetime">
						30 Dec 2016, 10:39					</div>
				</div>
				<div class="post-content content">
					<p>Hello.</p><p>Those are images of the MR3020 board:</p><p>&lt;I cannot post the images, the forum says too many links :S&gt;<br />TOP IMAGE:<br />wiki(dot)openwrt(dot)org/_media/media/tplink/tl-mr3020/tl-mr3020_top-pcb.jpg?w=450&amp;tok=c19faf</p><p>BOTTOM IMAGE<br />wiki(dot)openwrt(dot)org/_media/media/tplink/tl-mr3020/tl-mr3020_bottom-pcb.jpg?w=450&amp;tok=afdbab</p><p>DETAILED IMAGE:<br />wiki(DOT)openwrt(dot)org/_detail/media/tplink/tl-mr3020/tl-mr3020_top-pcb-gpio-pins.jpg?id=toh%3Atp-link%3Atl-mr3020</p><p>As I said before I got little (almost nothing) knoweldge about PCB boards, soldering and stuff like that, I&#039;m in the software field, however, it appears to me that the microusb power rail is directly connected to the normal USB one, am I wrong? There are two copper rails between them in the top image, aren&#039;t they?</p>											<p class="post-edited">(Last edited by <strong>dgoiko</strong> on 30 Dec 2016, 10:51)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p348056">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">rambler</div>
					<div class="post-datetime">
						30 Dec 2016, 15:03					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dgoiko wrote:</cite><blockquote><p>it appears to me that the microusb power rail is directly connected to the normal USB one, am I wrong? There are two copper rails between them in the top image, aren&#039;t they?</p></blockquote></div><p>You are wrong, they are connected thru a current limiting switch (Texas Instruments TPS2041B, marked U6 on the board). It is designed for 500 mA continuous and shuts USB power off at 1 amp or when overheated.</p><p>Of course nothing stops you from bypassing it, or blowing things up any other way. If desired, short two pads marked R113 next to the mini-USB connector.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>