<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Set Date/Eastern Time at BOOT (Kamikaze 7.06)</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 14 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p52959">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Ocean</div>
					<div class="post-datetime">
						28 Jul 2007, 06:16					</div>
				</div>
				<div class="post-content content">
					<p><strong>&gt;&gt;&gt;&nbsp; SETTING Time/TIMEZONE (will update date and time at each router reboot)</strong><br />&nbsp; &nbsp; <span style="color: #FF0000">1- </span>echo &quot;EST5EDT,M3.2.0/2:00:00,M11.1.0/2:00:00&quot; &gt; /etc/TZ&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (Set your TimeZone)<br />&nbsp; &nbsp; <span style="color: #FF0000">2- </span>vim /etc/init.d/timedate<br />&nbsp; &nbsp; &nbsp; &nbsp; |--&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #!/bin/sh /etc/rc.common<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; START=90<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; start() {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rdate -s <span style="color: blue">&lt;NTP Server Address&gt;</span><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; <span style="color: #FF0000">3- </span>chmod 755 /etc/init.d/timedate<br />&nbsp; &nbsp; <span style="color: #FF0000">4- </span>/etc/init.d/timedate enable<br />&nbsp; &nbsp; <span style="color: #FF0000">5- </span>reboot</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p53181">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">napierzaza</div>
					<div class="post-datetime">
						31 Jul 2007, 23:39					</div>
				</div>
				<div class="post-content content">
					<p>I tried this, but when I try to enable it I get a message that says it does not exist.</p><p>Que pasa? I included the START string and entered the date query into the function exactly as above.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p53361">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">napierzaza</div>
					<div class="post-datetime">
						3 Aug 2007, 22:35					</div>
				</div>
				<div class="post-content content">
					<p>Just so everyone knows, it&#039;s not the string presented above to enable.</p><p> It&#039;s actually:<br /></p><div class="codebox"><pre><code>/etc/rc.common /etc/init.d/timedate enable</code></pre></div>											<p class="post-edited">(Last edited by <strong>napierzaza</strong> on 3 Aug 2007, 22:35)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p53362">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">forum2006</div>
					<div class="post-datetime">
						3 Aug 2007, 22:43					</div>
				</div>
				<div class="post-content content">
					<p>/etc/init.d/timedate:<br /></p><div class="codebox"><pre><code>#!/bin/sh /etc/rc.common
START=90

start() {
        rdate -s &lt;NTP Server Address&gt;
}</code></pre></div><div class="codebox"><pre><code>/etc/init.d/timedate start
/etc/init.d/timedate enable</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p53363">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">napierzaza</div>
					<div class="post-datetime">
						3 Aug 2007, 23:14					</div>
				</div>
				<div class="post-content content">
					<p>I don&#039;t know if you&#039;re version works, mine does I believe, the first example doesn&#039;t. Does mine not work or are you just posting a similar fix?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p53366">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">napierzaza</div>
					<div class="post-datetime">
						4 Aug 2007, 00:11					</div>
				</div>
				<div class="post-content content">
					<p>in fact your example returns the same error I&#039;ve been getting</p><div class="codebox"><pre><code>root@openwrt:~# /etc/init.d/timedate start
-ash: /etc/init.d/timedate: not found
root@ openwrt:~# /etc/init.d/timedate enable
-ash: /etc/init.d/timedate: not found
root@ openwrt:~#</code></pre></div>											<p class="post-edited">(Last edited by <strong>napierzaza</strong> on 4 Aug 2007, 07:30)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p53376">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">napierzaza</div>
					<div class="post-datetime">
						4 Aug 2007, 07:58					</div>
				</div>
				<div class="post-content content">
					<p>Actually, though mine gives no error, it also does not set the time.</p><p>Also using the below is actually creating the files in the rc.d directory.<br />/etc/rc.common /etc/init.d/timedate enable</p>											<p class="post-edited">(Last edited by <strong>napierzaza</strong> on 4 Aug 2007, 17:19)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p53409">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">napierzaza</div>
					<div class="post-datetime">
						5 Aug 2007, 03:12					</div>
				</div>
				<div class="post-content content">
					<p>Alas, according to logread it&#039;s still not working:</p><div class="codebox"><pre><code>Dec 31 19:00:31 openwrt user.info : /etc/init.d/rcS: /etc/init.d/rcS: 8: /etc/rc.d/S90timedate: not found</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p53487">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">napierzaza</div>
					<div class="post-datetime">
						6 Aug 2007, 19:56					</div>
				</div>
				<div class="post-content content">
					<p>My guess is that the boot up script is not actually wrapping the rc.common with the cron script. And that NOT incorporating the command into a function will cause it to function.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p53599">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">napierzaza</div>
					<div class="post-datetime">
						9 Aug 2007, 00:33					</div>
				</div>
				<div class="post-content content">
					<p>I find it really strange that I&#039;m the only one getthing this, has anyone else tried this on the WRT54GS or WRT54G bin image? Because I am completely following the above directions and getting nowhere.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p53651">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">Ocean</div>
					<div class="post-datetime">
						10 Aug 2007, 00:17					</div>
				</div>
				<div class="post-content content">
					<p>I don&#039;t know what to say... The directions above work for me so this is why I posted this documentation here..... It doesn&#039;t matter what version of router you have. Are you using Kamikaze 7.06? version 7.07 also work fine.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p53659">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">Sonic</div>
					<div class="post-datetime">
						10 Aug 2007, 01:52					</div>
				</div>
				<div class="post-content content">
					<p>I want to use fr.pool.ntp.org to sync time but doesn&#039;t work. can you give an example valid server adress ?<br />btw, fr.pool.ntp.org works with ntpclient or windows time sync ...<br />thx!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p53674">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">forum2006</div>
					<div class="post-datetime">
						10 Aug 2007, 11:23					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;d really suggest installing/using the ntpclient package and make use of UCI (/etc/config/ntpclient). Of course, you still have to set the timezone in /etc/TZ manually. ntpclient is more easy to sync the time...</p>											<p class="post-edited">(Last edited by <strong>forum2006</strong> on 10 Aug 2007, 11:38)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p53702">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">napierzaza</div>
					<div class="post-datetime">
						10 Aug 2007, 22:17					</div>
				</div>
				<div class="post-content content">
					<p>I am using Kamikaze 7.07<br />It might somehow be significant in terms of what hardware, because maybe the image built for 2.4 broadcoms is broken.</p><p>I don&#039;t think you&#039;re making it up. But I&#039;m making very certain that I follow your directions and they are just giving me errors</p>											<p class="post-edited">(Last edited by <strong>napierzaza</strong> on 10 Aug 2007, 22:19)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p55663">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">whbjr</div>
					<div class="post-datetime">
						14 Sep 2007, 04:33					</div>
				</div>
				<div class="post-content content">
					<p>Try making it executable:<br /></p><div class="codebox"><pre><code>chmod +x /etc/init.d/timedate
/etc/init.d/timedate enable</code></pre></div><p>If you run &quot;ls -l /etc/init.d&quot; you&#039;ll see that the scripts there all have the &quot;x&quot; bits set.&nbsp; New scripts need that bit set, too.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p85148">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">arfyness</div>
					<div class="post-datetime">
						5 Apr 2009, 02:19					</div>
				</div>
				<div class="post-content content">
					<p>rdate fails for me, I don&#039;t care why.&nbsp; So I use nptclient instead.&nbsp; Also, I have combined the methods above (on this page) with some methods from <a href="http://martybugs.net/wireless/openwrt/timesync.cgi">another page</a>.</p><p>At boot, I use the ntp.org pool, and set the clock directly (without the -l option, therefore not using the adjtimex(2) call -- see the <a href="http://doolittle.icarus.com/ntpclient/README">ntpclient author&#039;s site</a> for more information about using the -l option.)</p><p><strong>/etc/init.d/clockset:</strong>&nbsp; <span style="color: #8b0000">(Remember to run ntpclient it in the background, in case it hangs.)</span><br /></p><div class="codebox"><pre><code>#!/bin/sh /etc/rc.common
START=90

start() {
        /usr/sbin/ntpclient -sh us.pool.ntp.org &amp;
}</code></pre></div><p>Then I do the enable command:&nbsp; &nbsp; &nbsp; root@wrt:/etc/# <strong>/etc/init.d/clockset enable</strong><br />____________________</p><p>That should do to initially set the clock on boot, provided upstream connection to the ntp pool servers.&nbsp; However, I also want to synchronize the clock to my LAN.&nbsp; I already have a machine (simply &quot;lan-time&quot; here) which is a ntp server. So...</p><p><strong>/usr/local/timesync.sh:</strong>&nbsp; <span style="color: #8b0000">(Remember to run ntpclient it in the background, in case it hangs.)</span><br /></p><div class="codebox"><pre><code>#/bin/sh
/usr/bin/killall ntpclient &gt; /dev/null 2&gt; /dev/null
/usr/sbin/ntpclient -s -l -h lan-time &amp;</code></pre></div><p><strong>root&#039;s crontab:</strong><br /></p><div class="codebox"><pre><code>*/30  * * * *   /usr/local/timesync.sh</code></pre></div><p>These parts serve to keep the time synchronized with the rest of my lan.</p><p>-- Nate</p><p><span style="color: #8b0000">EDIT:&nbsp; Changed <strong>*/10</strong> to <strong>*/30</strong> in root&#039;s crontab.&nbsp; Checking every 10min is just ... I like 30 better.</span></p>											<p class="post-edited">(Last edited by <strong>arfyness</strong> on 7 Apr 2009, 01:18)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>