<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> TL-WR1043ND v1.8 does not forward ethernet traffic as AP</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 21 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p230684">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">qsuscs</div>
					<div class="post-datetime">
						19 Apr 2014, 00:41					</div>
				</div>
				<div class="post-content content">
					<p>Hi all,</p><p>I have a TP-LINK TL-WR1043ND v1.8 running Attitude Adjustment (12.09, r36088) and configured it as AP (see <a href="http://pastie.org/private/msgthodwkbcucmbs3udya">http://pastie.org/private/msgthodwkbcucmbs3udya</a>).<br />Wifi to ethernet works fine, but if I connect a computer via ethernet, the DHCP request doesn&#039;t seem to be forwarded. If I set an according IP manually, I can ping the router/AP, but only that, everything else fails.</p><p>Did I miss something, or what am I doing wrong?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p230903">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">qsuscs</div>
					<div class="post-datetime">
						21 Apr 2014, 14:49					</div>
				</div>
				<div class="post-content content">
					<p>Hello? :&lt;</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p230906">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">3zl</div>
					<div class="post-datetime">
						21 Apr 2014, 14:58					</div>
				</div>
				<div class="post-content content">
					<p>only eth0 ?</p><p>where is the dhcp-server coming into ?</p><p>some more precise infos please</p><p>regards<br />3zl</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p230933">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">qsuscs</div>
					<div class="post-datetime">
						21 Apr 2014, 18:48					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>3zl wrote:</cite><blockquote><p>only eth0 ?</p><p>where is the dhcp-server coming into ?</p></blockquote></div><p>I’m not sure what you mean… The device has one ethernet adapter, connected to a switch. In stock firmware and OpenWRT default, WAN and LAN 1-4 are seperated by VLAN. I (at least I think so) disabled the VLAN stuff and made a bridge over the Ethernet and WLAN interface, so that all should be the same.</p><p>DHCP is coming into eth0 from an AVM FRITZ!Box 7390.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p230935">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">3zl</div>
					<div class="post-datetime">
						21 Apr 2014, 19:02					</div>
				</div>
				<div class="post-content content">
					<p>welll...may or may not work...dont know</p><p>&quot;made a bridge over the Ethernet and WLAN interface&quot;&nbsp; how ?</p><p>you do want nat for your WR1043 ? or use as simple switch ?</p><p>wifi-clients gets IP from FRITZBOX-dhcpd ?</p><p>post network + wireless config</p><p>use tcpdump on CPE &amp; client to check the traffic</p><p>( you could do with default settings i.e. vlans : disable wan if and feed FRITZBOX to LAN my do the job )</p><p>regards<br />3zl</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p230936">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">qsuscs</div>
					<div class="post-datetime">
						21 Apr 2014, 19:10					</div>
				</div>
				<div class="post-content content">
					<p>I already posted the config: <a href="http://pastie.org/private/msgthodwkbcucmbs3udya">http://pastie.org/private/msgthodwkbcucmbs3udya</a><br />It should not do any NAT, just act as a “stupid” AP with a switch, so yes, the Ethernet and WLAN clients get DHCP from the FRITZ!Box.<br />How should I do tcpdump?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p230938">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						21 Apr 2014, 19:21					</div>
				</div>
				<div class="post-content content">
					<p>imho you should not delete switch, instead add all ports to vlan 1:</p><p><a href="http://wiki.openwrt.org/doc/recipes/dumbap#for.devices.with.switch.only.e.g.wrt54gl">http://wiki.openwrt.org/doc/recipes/dum … .g.wrt54gl</a></p>											<p class="post-edited">(Last edited by <strong>nebbia88</strong> on 21 Apr 2014, 19:21)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p230939">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">3zl</div>
					<div class="post-datetime">
						21 Apr 2014, 19:42					</div>
				</div>
				<div class="post-content content">
					<p>network config missing internal switch reset ?</p><br /><br /><br /><div class="quotebox"><cite>nebbia88 wrote:</cite><blockquote><p>imho you should not delete switch, instead add all ports to vlan 1:</p><p><a href="http://wiki.openwrt.org/doc/recipes/dumbap#for.devices.with.switch.only.e.g.wrt54gl">http://wiki.openwrt.org/doc/recipes/dum … .g.wrt54gl</a></p></blockquote></div><p>good point</p><p>or if the setup its too difficult for you <br />&nbsp; &nbsp; &nbsp; &nbsp;: set&nbsp; the ethernet-switch-config default and use lan-ports as dump switch <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - works in my DIR 600</p><p>anaylse/trace the traffic in/out with tcpdump / wireshark</p><p>regards<br />3zl</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p230942">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">qsuscs</div>
					<div class="post-datetime">
						21 Apr 2014, 20:23					</div>
				</div>
				<div class="post-content content">
					<p>Great, works now! I restored the original config and adjusted it a bit, it now looks like this:<br /></p><div class="codebox"><pre><code>config interface &#039;loopback&#039;
        option ifname &#039;lo&#039;
        option proto &#039;static&#039;
        option ipaddr &#039;127.0.0.1&#039;
        option netmask &#039;255.0.0.0&#039;

config interface &#039;lan&#039;
        option ifname &#039;eth0.1&#039;
        option type &#039;bridge&#039;
        option proto &#039;dhcp&#039;
        option hostname &#039;Legendary&#039;
        option _orig_ifname &#039;eth0.1 radio0.network1&#039;
        option _orig_bridge &#039;true&#039;

config switch
        option name &#039;rtl8366rb&#039;
        option reset &#039;1&#039;
        option enable_vlan &#039;1&#039;

config switch_vlan
        option device &#039;rtl8366rb&#039;
        option vlan &#039;1&#039;
        option ports &#039;0 1 2 3 4 5t&#039;</code></pre></div><p>I still wonder what the two options “_orig_ifname” and “_orig_bridge” do, though.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>