<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> ath9k</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 27 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p71820">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">acoul</div>
					<div class="post-datetime">
						6 Aug 2008, 08:55					</div>
				</div>
				<div class="post-content content">
					<p>I have not tested yet the driver as I don&#039;t own an atheros 802.11n wifi card.&nbsp; The driver compiles fine for x86.&nbsp; For non x86 platforms the driver can only be compiled using gcc 3.4.6 as gcc-4.x has <a href="https://dev.openwrt.org/cgi-bin/trac.fcgi/ticket/3816">this issue</a>.</p>											<p class="post-edited">(Last edited by <strong>acoul</strong> on 6 Aug 2008, 08:56)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p71965">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">acoul</div>
					<div class="post-datetime">
						8 Aug 2008, 14:37					</div>
				</div>
				<div class="post-content content">
					<p><a href="http://wifi.ozo.com/airo/openwrt/firmware/kamikaze/2.6/x86/testing/">here</a> you may find a x86 firmware optimized for alix/wrap/soekris SBC boards. it contains&nbsp; latest linux kernel with latest mac80211/ath9k drivers.&nbsp; some debug flags are active so this is not for production use. I would like to thank nikpanGR from <a href="http://en.wikipedia.org/wiki/Athens_Wireless_Metropolitan_Network">awmn</a> for providing a pair of Unex DNMA-83 (Atheros 9160) 802.11n cards in order to conduct these tests.</p>											<p class="post-edited">(Last edited by <strong>acoul</strong> on 8 Aug 2008, 16:20)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p72020">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">acoul</div>
					<div class="post-datetime">
						9 Aug 2008, 12:55					</div>
				</div>
				<div class="post-content content">
					<p><a href="http://wifi.ozo.com/airo/openwrt/firmware/kamikaze/2.6/x86/testing/old/12254/">here</a> is a preliminary (not all patches/packages ported yet)&nbsp; linux-2.6.27-rc2-git3 openwrt image for x86 testing with most of the debug options enabled. have not tested it yet as I am away from the lab.</p>											<p class="post-edited">(Last edited by <strong>acoul</strong> on 20 Aug 2008, 16:05)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p72069">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">acoul</div>
					<div class="post-datetime">
						10 Aug 2008, 19:53					</div>
				</div>
				<div class="post-content content">
					<p>tested and it works:<br /></p><div class="codebox"><pre><code>Linux version 2.6.27-rc2-git4 (alex@extreme) (gcc version 4.2.2) #3 Sun Aug 10 19:35:56 EEST 2008</code></pre></div><p>you can get it <a href="http://wifi.ozo.com/airo/openwrt/firmware/kamikaze/2.6/x86/testing/">here</a> along with patches &amp; .config for linux- kernel 2.6.27.&nbsp; 065-rootfs_split.patch is openwrt-linux-2.6.26.2 backport.</p>											<p class="post-edited">(Last edited by <strong>acoul</strong> on 11 Aug 2008, 13:08)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p72238">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">acoul</div>
					<div class="post-datetime">
						13 Aug 2008, 17:11					</div>
				</div>
				<div class="post-content content">
					<p><a href="http://10.2.19.1/airo/openwrt/firmware/kamikaze/2.6/x86/testing/">update</a><br /></p><div class="quotebox"><cite>Chanelog wrote:</cite><blockquote><p>* linux-2.6.27-rc3<br />* latest mac80211/ath9k patches applied</p></blockquote></div><p>I&#039;ve made available the modified mac80211 package I use along with the additional ath9k patches. the later have to go under the target/linux/x86/patches directory.&nbsp; still with the atheros 802.11n cards I have, I am unable to get an association.&nbsp; I have also created a relative <a href="http://marc.info/?l=linux-wireless&amp;m=121820791905464&amp;w=2">ticket</a> on the wireless-testing mailing list.</p>											<p class="post-edited">(Last edited by <strong>acoul</strong> on 13 Aug 2008, 18:05)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p72478">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">acoul</div>
					<div class="post-datetime">
						20 Aug 2008, 09:41					</div>
				</div>
				<div class="post-content content">
					<p>apparently ad-hoc mode is broken on latest wireless-2.6 tree</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p72503">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">acoul</div>
					<div class="post-datetime">
						20 Aug 2008, 19:32					</div>
				</div>
				<div class="post-content content">
					<p>ath9k is working fine with hostapd offering AP mode:<br /></p><div class="codebox"><pre><code>root@OpenWrt:/# hostapd -dd /etc/hostapd.conf
Configuration file: /etc/hostapd.conf
Opening raw packet socket for ifindex -1209973692
BSS count 1, BSSID mask ff:ff:ff:ff:ff:ff (0 bits)
SIOCGIWRANGE: WE(compiled)=22 WE(source)=21 enc_capa=0xf
Failed to update rate sets in kernel module
RATE[0] rate=10 flags=0x2
RATE[1] rate=20 flags=0x2
RATE[2] rate=55 flags=0x2
RATE[3] rate=110 flags=0x2
RATE[4] rate=60 flags=0x0
RATE[5] rate=90 flags=0x0
RATE[6] rate=120 flags=0x0
RATE[7] rate=180 flags=0x0
RATE[8] rate=240 flags=0x0
RATE[9] rate=360 flags=0x0
RATE[10] rate=480 flags=0x0
RATE[11] rate=540 flags=0x0
Could not set passive scanning: Unknown error -1
Flushing old station entries
Deauthenticate all stations
Mode: IEEE 802.11g  Channel: 1  Frequency: 2412 MHz
Failed to set CTS protect in kernel driver
Failed to set Short Slot Time option in kernel driver
Could not set preamble for kernel driver
Using interface wlan0 with hwaddr 00:0b:6b:b0:21:fa and ssid &#039;awmn&#039;
Failed to set CTS protect in kernel driver
Failed to set Short Slot Time option in kernel driver
Could not set preamble for kernel driver
wlan0: Setup of interface done.
MGMT (TX callback) ACK
Wireless event: cmd=0x8b04 len=12</code></pre></div><div class="codebox"><pre><code>wlan0     IEEE 802.11abgn  ESSID:&quot;awmn&quot;
          Mode:Master  Frequency:2.412 GHz  Tx-Power=27 dBm
          Retry min limit:7   RTS thr:off   Fragment thr=2352 B
          Encryption key:off
          Power Management:off
          Link Quality:0  Signal level:0  Noise level:0
          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:0   Missed beacon:0

mon.wlan0  IEEE 802.11abgn  Mode:Monitor  Frequency:2.412 GHz  Tx-Power=27 dBm
          Retry min limit:7   RTS thr:off   Fragment thr=2352 B
          Encryption key:off
          Power Management:off
          Link Quality:0  Signal level:0  Noise level:0
          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:0   Missed beacon:0</code></pre></div><div class="codebox"><pre><code>wlan0     IEEE 802.11abgn  ESSID:&quot;awmn&quot;
          Mode:Managed  Frequency:2.412 GHz  Access Point: 00:0B:6B:B0:21:FA
          Bit Rate=1 Mb/s   Tx-Power=23 dBm
          Retry min limit:7   RTS thr:off   Fragment thr=2352 B
          Encryption key:off
          Power Management:off
          Link Quality=50/100  Signal level:-63 dBm  Noise level=-95 dBm
          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:0   Missed beacon:0</code></pre></div><p>I was only able to use 802.11g mode under hostapd, here are some iperf benchmarks:<br /></p><div class="codebox"><pre><code>root@OpenWrt:/# iperf -c 192.168.100.1 -u  -b 100m
------------------------------------------------------------
Client connecting to 192.168.100.1, UDP port 5001
Sending 1470 byte datagrams
UDP buffer size:   107 KByte (default)
------------------------------------------------------------
[  5] local 192.168.100.2 port 43263 connected with 192.168.100.1 port 5001
[  5]  0.0-10.0 sec  24.3 MBytes  20.3 Mbits/sec
[  5] Sent 17302 datagrams
[  5] Server Report:
[  5]  0.0-10.0 sec  24.3 MBytes  20.3 Mbits/sec  0.125 ms    0/17301 (0%)
[  5]  0.0-10.0 sec  1 datagrams received out-of-order</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p79211">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">RoundSparrow</div>
					<div class="post-datetime">
						7 Jan 2009, 21:01					</div>
				</div>
				<div class="post-content content">
					<p>FYI - some work is being done on the ATH9K support &gt; 802.11g speeds.&nbsp; See: <a href="http://forum.openwrt.org/viewtopic.php?pid=79159#p79159">http://forum.openwrt.org/viewtopic.php?pid=79159#p79159</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p84469">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">bladezibit</div>
					<div class="post-datetime">
						24 Mar 2009, 19:13					</div>
				</div>
				<div class="post-content content">
					<p>I can&#039;t get the ath9k driver for an atheros n wireless card to switch to Master mode on the standard linux kernel. Have you applied a special patch or make some tweaks to be in master mode ?</p><p>I know I&#039;m not using OpenWrt but... it seems like a kernel issue so we are all on the same ground at this level <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Here&#039;s what I get: </p><div class="codebox"><pre><code>wrvs4400 ~ # /etc/init.d/hostapd start
 * Starting wlan0
 *   Configuring wireless network for wlan0
Error for wireless request &quot;Set Mode&quot; (8B06) :
    SET failed on device wlan0 ; Invalid argument.
 *   wlan0 does not support setting the mode to &quot;master&quot;
 *     wlan0 connected to ESSID &quot;aphrodite2&quot; at 00:00:00:00:00:00
 *     in managed mode on channel 6 (WEP disabled)
 *   Bringing up wlan0
 *     192.168.6.1/24                                                                                                   [ ok ]
 * Starting hostapd ...
Configuration file: /etc/hostapd/hostapd.conf</code></pre></div><div class="codebox"><pre><code>wlan0     IEEE 802.11bgn  ESSID:&quot;aphrodite2&quot;
          Mode:Managed  Frequency:2.437 GHz  Access Point: Not-Associated
          Tx-Power=27 dBm
          Retry min limit:7   RTS thr:off   Fragment thr=2352 B
          Encryption key:off
          Power Management:off
          Link Quality:0  Signal level:0  Noise level:0
          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:0   Missed beacon:0</code></pre></div><p>Thanks !</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>