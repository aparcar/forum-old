<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> openwrt working as fonera cliente and sharing conection</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 23 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p134322">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Oslec</div>
					<div class="post-datetime">
						29 Apr 2011, 21:26					</div>
				</div>
				<div class="post-content content">
					<p>Hi all.</p><p>this is the situation,</p><p>My ISP (ZON Portugal) is a Fonera&#039;s partner, in my home I have a router with a Fonera vlan, and a Wifi connection, so no problem here.</p><p>But when I&#039;m in my beach house I use the neighbors Fonera&#039;s connection so I can have Internet connection.</p><p>So far so good, but here is the problem, I have to put outside my windows a Linksys WUSB300n or my wrt54g v2.2 working as client, either way I can only connect one PC at time.</p><p>What I want is to put my wrt54g to connect to the Fonera router as a client and make the Fonera client authentication and share the connection to several computer, to at least ( mine and my daughter&#039;s netbook) </p><p>I was thinking on connect a second router as an AP (Thomson TG784) to one of the lan&#039;s port wrt54g and shared the connection via Wifi.</p><p>can anyone tel me how can I configure the wrt54g to make the Fonera authentication and share the connection?</p><p>thx in advance...</p><p>P.S.-Sorry the lousy english <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p134324">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						29 Apr 2011, 21:35					</div>
				</div>
				<div class="post-content content">
					<p><a href="http://wiki.openwrt.org/doc/howto/clientmode">Client mode discussion</a><br /><a href="http://wiki.openwrt.org/doc/recipes/relayclient">Bridged Client Mode (with relayd)</a><br /><a href="http://wiki.openwrt.org/doc/recipes/routedclient#using.masquerade">Routed Client (Using MASQUERADE)</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p134345">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						30 Apr 2011, 12:50					</div>
				</div>
				<div class="post-content content">
					<p><a href="https://forum.openwrt.org/viewtopic.php?pid=134080#p134080">OpenWrt / Traveling with all your wifi gadgets and connecting them all to one w</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p134353">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Oslec</div>
					<div class="post-datetime">
						30 Apr 2011, 15:34					</div>
				</div>
				<div class="post-content content">
					<p>I think I have wrongly explained myself <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" />...</p><p>I can already access Fonera network with my wrt54g as client, no problem here, I can inclusive using a PC authenticate and browse the web.</p><p>My problem is that I only have access to the internet one PC at time because after the first authentication with a PC I can no longer authenticate another PC while the first connection is active.</p><p>what I want it to make the wrt54g manage the Fonera web authentication login and them share that conection.<br />But I dont know how to make the web authentication login, nor I can find a package&nbsp; like the one for chilispot web authentication login.</p><p>I&#039;m running backfire 10.03.1-rc4 version brcm-2.4.</p><p>Thx.</p>											<p class="post-edited">(Last edited by <strong>Oslec</strong> on 30 Apr 2011, 15:36)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p134357">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						30 Apr 2011, 17:41					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Oslec wrote:</cite><blockquote><p>I&#039;m running backfire 10.03.1-rc4 version brcm-2.4.</p></blockquote></div><p>I guess your wrt54g is running bridged client (sta) mode. Try &quot;Routed Client (Using MASQUERADE)&quot; advised by jow. The first computer up connecting to the internet should do the web authentication.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p134436">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Oslec</div>
					<div class="post-datetime">
						2 May 2011, 13:52					</div>
				</div>
				<div class="post-content content">
					<p>Thx <strong>jow</strong> and <strong>fyi</strong> for your help...</p><p><em>Apparently</em> the setup is working, I say apparently, because to test if the setup was really working, I shutdown all the hardware (wrt54g, TG784, Desktop wireless client and Notebook wireless client). Restart them all, and now a weird thing happen, I didn&#039;t need to authenticate to have Internet access trough Fonera, like the first time I tried to access Internet on Desktop client. Not that I&#039;m complaining, but is this to be expected?</p><p>this is the setup layout: <br /><span class="postimg"><img src="http://img193.imageshack.us/img193/4972/80211routedmasq.png" alt="http://img193.imageshack.us/img193/4972/80211routedmasq.png" /></span></p><p>Thx.</p>											<p class="post-edited">(Last edited by <strong>Oslec</strong> on 2 May 2011, 18:14)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p134445">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						2 May 2011, 16:24					</div>
				</div>
				<div class="post-content content">
					<p>Run &quot;uci export wireless&quot; and &quot;uci export network&quot; on wrt54g.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p134473">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">Oslec</div>
					<div class="post-datetime">
						2 May 2011, 22:24					</div>
				</div>
				<div class="post-content content">
					<p>Today I restarted the hardware again, and this time before I coud access the web&nbsp; the Fonera portal appear prompting for Login <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />...<br />So everything is working fine.</p><p>anyway here is the output from the commands you tell me to run:<br /></p><div class="codebox"><pre><code> 
eu@OpenWrt:/tmp# uci export wireless
package &#039;wireless&#039;

config &#039;wifi-device&#039; &#039;wl0&#039;
        option &#039;type&#039; &#039;broadcom&#039;
        option &#039;channel&#039; &#039;13&#039;

config &#039;wifi-iface&#039;
        option &#039;device&#039; &#039;wl0&#039;
        option &#039;ssid&#039; &#039;FON_ZON_FREE_INTERNET&#039;
        option &#039;encryption&#039; &#039;none&#039;
        option &#039;network&#039; &#039;wan&#039;
        option &#039;mode&#039; &#039;sta&#039;


root@OpenWrt:/tmp# uci export network
package &#039;network&#039;

config &#039;switch&#039; &#039;eth0&#039;
        option &#039;enable&#039; &#039;1&#039;

config &#039;switch_vlan&#039; &#039;eth0_0&#039;
        option &#039;device&#039; &#039;eth0&#039;
        option &#039;vlan&#039; &#039;0&#039;
        option &#039;ports&#039; &#039;1 2 3 4 5&#039;

config &#039;switch_vlan&#039; &#039;eth0_1&#039;
        option &#039;device&#039; &#039;eth0&#039;
        option &#039;vlan&#039; &#039;1&#039;
        option &#039;ports&#039; &#039;0 5&#039;

config &#039;interface&#039; &#039;loopback&#039;
        option &#039;ifname&#039; &#039;lo&#039;
        option &#039;proto&#039; &#039;static&#039;
        option &#039;ipaddr&#039; &#039;127.0.0.1&#039;
        option &#039;netmask&#039; &#039;255.0.0.0&#039;

config &#039;interface&#039; &#039;lan&#039;
        option &#039;type&#039; &#039;bridge&#039;
        option &#039;ifname&#039; &#039;eth0.0&#039;
        option &#039;proto&#039; &#039;static&#039;
        option &#039;netmask&#039; &#039;255.255.255.0&#039;
        option &#039;ipaddr&#039; &#039;192.168.2.1&#039;

config &#039;interface&#039; &#039;wan&#039;
        option &#039;proto&#039; &#039;dhcp&#039;</code></pre></div><p>Thx again both of you...</p>											<p class="post-edited">(Last edited by <strong>Oslec</strong> on 2 May 2011, 22:25)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p134518">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						3 May 2011, 11:09					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Oslec wrote:</cite><blockquote><p>Today I restarted the hardware again, and this time before I coud access the web&nbsp; the Fonera portal appear prompting for Login <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />...</p></blockquote></div><p>From what you described and the output, I can tell you two things,<br /></p><div class="quotebox"><blockquote><p>a) After each power cycle of wrt54g, you need to do the web authentication &quot;once&quot;. Maybe also within the dhcp leased time which I&#039;m not sure.<br />b) The wrt54g is running <a href="http://wiki.openwrt.org/doc/recipes/routedclient#using.masquerade">Routed Client (Using MASQUERADE)</a> mode.</p></blockquote></div><p>I can see that you have installed brcm-2.4 (type broadcom) build to wrt54g. You can improve it by creating a virtual ap like,<br /></p><div class="codebox"><pre><code>config &#039;wifi-device&#039; &#039;wl0&#039;
        option &#039;type&#039; &#039;broadcom&#039;
        option &#039;channel&#039; &#039;13&#039;
        option &#039;txpower&#039; &#039;20&#039;

config &#039;wifi-iface&#039;
        option &#039;device&#039; &#039;wl0&#039;
        option &#039;ssid&#039; &#039;FON_ZON_FREE_INTERNET&#039;
        option &#039;encryption&#039; &#039;none&#039;
        option &#039;network&#039; &#039;wan&#039;
        option &#039;mode&#039; &#039;sta&#039;

config &#039;wifi-iface&#039;
        option &#039;device&#039; &#039;wl0&#039;
        option &#039;ssid&#039; &#039;MYHOME&#039;
        option &#039;encryption&#039; &#039;psk2&#039;
        option &#039;key&#039; &#039;secretkey&#039;
        option &#039;network&#039; &#039;lan&#039;
        option &#039;mode&#039; &#039;ap&#039;</code></pre></div><p>No need for the Thomson TG784.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p134564">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">Oslec</div>
					<div class="post-datetime">
						3 May 2011, 16:51					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><p>a) After each power cycle of wrt54g, you need to do the web authentication &quot;once&quot;. Maybe also within the dhcp leased time which I&#039;m not sure.</p></blockquote></div><p>I was expecting the web authentication to appear after a power cycle, but that didn&#039;t happened in the first complete restart, it seems that was one of that anomalies that make the rule exception <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />...</p><div class="quotebox"><blockquote><p>b) The wrt54g is running <a href="http://wiki.openwrt.org/doc/recipes/routedclient#using.masquerade">Routed Client (Using MASQUERADE)</a> mode.<br />I can see that you have installed brcm-2.4 (type broadcom) build to wrt54g. You can improve it by creating a virtual ap like,</p></blockquote></div><p>I know. I chose this layout on performance premise, one radio handle the wireless clients and the other the communication with the Fonera AP.<br />If I could debrick my Asus WL500W I certainly would use only one router, as it can handle 802.11n and the Fonera router can also handle 802.11n.<br />If I configure the WRT54g to handle a second wifi vlan that means it have to split the bandwidth in to much connections and a major limitation on the bandwidth per client would occur, if it is only web navigation probably I wouldn&#039;t notice such a limitation, but when lan communication occur this limitation would certainly make itself noticeable.</p><p>But I thank you for your concern.</p>											<p class="post-edited">(Last edited by <strong>Oslec</strong> on 3 May 2011, 20:53)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>