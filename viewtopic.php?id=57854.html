<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Trunk building error: loadable module support disabled</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 28 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p279310">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">mirko_47</div>
					<div class="post-datetime">
						8 Jun 2015, 19:51					</div>
				</div>
				<div class="post-content content">
					<p>Hi all,</p><p>I&#039;m facing some problems trying to build OpenWrt trunk.<br />First of all, even if I&#039;m quite sure that I&#039;ve followed the right procedure, to be 100% sure, I will write down here what I&#039;ve done to set up the buildroot:<br /></p><div class="codebox"><pre><code>$ sudo apt-get update &amp;&amp; sudo apt-get upgrade
$ sudo apt-get install sudo apt-get install build-essential subversion libncurses5-dev zlib1g-dev gawk git git-core ccache gcc-multilib flex gettext libssl-dev xsltproc quilt libxml-parser-perl python3.4-dev qemu-utils
$ svn co svn://svn.openwrt.org/openwrt/trunk
$ cd trunk 
$ ./scripts/feeds update -a
$ ./scripts/feeds install -a
$ make menuconfig
$ make defconfig
$ make kernel_menuconfig
$ make kernel_oldconfig
$ make prereq </code></pre></div><p>then running </p><div class="codebox"><pre><code>$ make -j 7</code></pre></div><p> I get:</p><div class="codebox"><pre><code>mirko@PC-Mirko:~$ cd /home/mirko/Desktop/trunk/
mirko@PC-Mirko:~/Desktop/trunk$ make -j 7
Checking &#039;rsync&#039;... ok.
 make[1] world
 make[2] tools/install
 make[2] package/cleanup
 make[3] -C tools/patch-image compile
 make[3] -C tools/make-ext4fs compile
 make[3] -C tools/patch compile
 make[3] -C tools/sstrip compile
 make[3] -C tools/flock compile
 make[3] -C tools/firmware-utils compile
 make[3] -C tools/patch install
 make[3] -C tools/sed compile
 make[3] -C tools/m4 compile
 make[3] -C tools/xz compile
 make[3] -C tools/yaffs2 compile
 make[3] -C tools/cmake compile
 make[3] -C tools/scons compile
 make[3] -C tools/lzma compile
 make[3] -C tools/sed install
 make[3] -C tools/m4 install
 make[3] -C tools/xz install
 make[3] -C tools/pkg-config compile
 make[3] -C tools/sstrip install
 make[3] -C tools/mkimage compile
 make[3] -C tools/patch-image install
 make[3] -C tools/yaffs2 install
 make[3] -C tools/flock install
 make[3] -C tools/squashfs4 compile
 make[3] -C tools/autoconf compile
 make[3] -C tools/pkg-config install
 make[3] -C tools/make-ext4fs install
 make[3] -C tools/autoconf install
 make[3] -C tools/automake compile
 make[3] -C tools/missing-macros compile
 make[3] -C tools/automake install
 make[3] -C tools/missing-macros install
 make[3] -C tools/libtool compile
 make[3] -C tools/libtool install
 make[3] -C tools/gmp compile
 make[3] -C tools/libelf compile
 make[3] -C tools/flex compile
 make[3] -C tools/mklibs compile
 make[3] -C tools/e2fsprogs compile
 make[3] -C tools/firmware-utils install
 make[3] -C tools/mm-macros compile
 make[3] -C tools/scons install
 make[3] -C tools/gengetopt compile
 make[3] -C tools/patchelf compile
 make[3] -C tools/lzma install
 make[3] -C tools/squashfs4 install
 make[3] -C tools/libelf install
 make[3] -C tools/flex install
 make[3] -C tools/mklibs install
 make[3] -C tools/mkimage install
 make[3] -C tools/mm-macros install
 make[3] -C tools/bison compile
 make[3] -C tools/bison install
 make[3] -C tools/findutils compile
 make[3] -C tools/bc compile
 make[3] -C tools/patchelf install
 make[3] -C tools/findutils install
 make[3] -C tools/quilt compile
 make[3] -C tools/padjffs2 compile
 make[3] -C tools/quilt install
 make[3] -C tools/padjffs2 install
 make[3] -C tools/bc install
 make[3] -C tools/e2fsprogs install
 make[3] -C tools/mtd-utils compile
 make[3] -C tools/qemu compile
 make[3] -C tools/gengetopt install
 make[3] -C tools/gmp install
 make[3] -C tools/mpfr compile
 make[3] -C tools/mtd-utils install
 make[3] -C tools/qemu install
 make[3] -C tools/mpfr install
 make[3] -C tools/mpc compile
 make[3] -C tools/mpc install
 make[3] -C tools/cmake install
 make[2] toolchain/install
 make[3] -C toolchain/gdb prepare
 make[3] -C toolchain/gcc/minimal prepare
 make[3] -C toolchain/binutils prepare
 make[3] -C toolchain/kernel-headers prepare
 make[3] -C toolchain/uClibc/headers prepare
 make[3] -C toolchain/kernel-headers compile
 make[3] -C toolchain/uClibc prepare
 make[3] -C toolchain/uClibc/utils prepare
 make[3] -C toolchain/binutils compile
 make[3] -C toolchain/gdb compile
 make[3] -C toolchain/binutils install
 make[3] -C toolchain/gcc/minimal compile
 make[3] -C toolchain/gcc/initial prepare
 make[3] -C toolchain/gcc/final prepare
 make[3] -C toolchain/gdb install
 make[3] -C toolchain/gcc/minimal install
 make[3] -C toolchain/kernel-headers install
 make[3] -C toolchain/uClibc/headers compile
 make[3] -C toolchain/uClibc/headers install
 make[3] -C toolchain/gcc/initial compile
 make[3] -C toolchain/gcc/initial install
 make[3] -C toolchain/uClibc compile
 make[3] -C toolchain/uClibc install
 make[3] -C toolchain/gcc/final compile
 make[3] -C toolchain/gcc/final install
 make[3] -C toolchain/uClibc/utils compile
 make[3] -C toolchain/uClibc/utils install
 make[2] target/compile
 make[3] -C target/linux compile
make -r world: build failed. Please re-run make with -j1 V=s to see what&#039;s going on
/home/mirko/Desktop/trunk/include/toplevel.mk:181: recipe for target &#039;world&#039; failed
make: *** [world] Error 1
mirko@PC-Mirko:~/Desktop/trunk$ </code></pre></div><p>I&#039;ve uploaded <strong><a href="https://drive.google.com/folderview?id=0BxHW2MMDoAYffldnUk9IY2dZN1J5TnJPT3dxdlFvRC03VExrR3p2TEFwcVc3dXlBdEdIdVE&amp;usp=sharing">here</a></strong> the log folder (and also diffconfig, buildroot .config, kernel buildroot .config), in which under<br /></p><div class="codebox"><pre><code>/logs/target/linux</code></pre></div><p> into compile.txt I can see that the log reports a problem with LKMs:<br /></p><div class="codebox"><pre><code>...
virtio-scsi support (SCSI_VIRTIO) [N/m/?] (NEW) aborted!

Console input/output is redirected. Run &#039;make oldconfig&#039; to update configuration.

scripts/kconfig/Makefile:36: recipe for target &#039;silentoldconfig&#039; failed
make[7]: *** [silentoldconfig] Error 1
Makefile:543: recipe for target &#039;silentoldconfig&#039; failed
make[6]: *** [silentoldconfig] Error 2

The present kernel configuration has modules disabled.
Type &#039;make config&#039; and enable loadable module support.
Then build a kernel with module support enabled.

Makefile:1161: recipe for target &#039;modules&#039; failed
make[5]: *** [modules] Error 1
Makefile:22: recipe for target &#039;/home/mirko/Desktop/trunk/build_dir/target-x86_64_uClibc-0.9.33.2/linux-x86_64/linux-4.0.4/.modules&#039; failed
make[4]: *** [/home/mirko/Desktop/trunk/build_dir/target-x86_64_uClibc-0.9.33.2/linux-x86_64/linux-4.0.4/.modules] Error 2
Makefile:13: recipe for target &#039;compile&#039; failed
make[3]: *** [compile] Error 2</code></pre></div><p>Now I&#039;ve tried to understand where I&#039;ve done something wrong but I didn&#039;t solve anything, running:<br /></p><div class="codebox"><pre><code>make kernel_menuconfig</code></pre></div><p>I see loadable module support enabled!!!<br />So as you can see I&#039;m stuck... if someone would be so kind to give me an hand, any help will be really appreciated.<br />Thanks to everyone in advance.</p>											<p class="post-edited">(Last edited by <strong>mirko_47</strong> on 13 Jun 2015, 19:01)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p279644">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">mirko_47</div>
					<div class="post-datetime">
						10 Jun 2015, 22:55					</div>
				</div>
				<div class="post-content content">
					<p>bump... anyone??? pleeeeaaseeee</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p279646">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">zloop</div>
					<div class="post-datetime">
						11 Jun 2015, 00:31					</div>
				</div>
				<div class="post-content content">
					<p>Clean your buildroot (make distclean : this removes even config)</p><p>Simply run make menuconfig<br />and after that &quot;make -j 7&quot;</p><p>You dont need the kernel stuff because you do not change the settings AND you dont need defconfig after you have selected the x86-64 target since you just created a config with menuconfig.</p><p>the prereq target will be built with the normal make too - thus its not needed</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p279696">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">mirko_47</div>
					<div class="post-datetime">
						11 Jun 2015, 13:58					</div>
				</div>
				<div class="post-content content">
					<p>Thank you very much for your answer.</p><p>Already tried the method that you&#039;ve proposed but it doesn&#039;t work...<br />(The buildroot that I&#039;ve used was fresh installed).<br />In any case I need to run:<br /></p><div class="codebox"><pre><code>make kernel_menuconfig</code></pre></div><p>Because I need CPU frequency scaling drivers, that by default aren&#039;t enabled with the 4.0.4 kernel that I&#039;ve used, or using the 3.18.14 kernel (build process fails again, maybe when I return at home I will upload the log)I also need SMP, which is not enabled by default.</p><p>Thank you very much again.</p><p>EDIT:&nbsp; maybe I&#039;ve found something: <a href="https://forum.openwrt.org/viewtopic.php?pid=155420#p155420">https://forum.openwrt.org/viewtopic.php … 20#p155420</a></p>											<p class="post-edited">(Last edited by <strong>mirko_47</strong> on 11 Jun 2015, 16:06)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p279721">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">mirko_47</div>
					<div class="post-datetime">
						11 Jun 2015, 19:58					</div>
				</div>
				<div class="post-content content">
					<p>no way, even adding manually <br /></p><div class="codebox"><pre><code>CONFIG_KERNEL_MODULES=y </code></pre></div><p>I get the same error...</p><p>...honestly I&#039;ve still no idea of what I&#039;m doing wrong; I mean looking to the &quot;<strong><a href="http://wiki.openwrt.org/doc/howto/build">how to build</a></strong>&quot; guide I&#039;m doing it wright, but I always get same error, could be the trunk that is broken for that specific choice of kernel/target?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p279724">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						11 Jun 2015, 20:19					</div>
				</div>
				<div class="post-content content">
					<p>Did you by any chance ran &quot;make kernel_menuconfig&quot; without first doing a normal build? If yes then it might be due to the fact that the Linux kernel source tree was not even prepared yet, try &quot;make target/linux/prepare&quot; (or a normal &quot;make&quot; run) before jumping into kernel_menuconfig.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p279851">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">mirko_47</div>
					<div class="post-datetime">
						13 Jun 2015, 13:08					</div>
				</div>
				<div class="post-content content">
					<p>Thank you very much for your answer,</p><p>As you&#039;ve suggested today I&#039;ve tried again to build OpenWrt (both with 4.0.4 &amp; 3.18 kernel) launching <br /></p><div class="codebox"><pre><code>$ make target/linux/prepare</code></pre></div><p>before <br /></p><div class="codebox"><pre><code>$ make kernel_menuconfig</code></pre></div><p>But I obtain exactly the same error reported in the previously uploaded log:<br />(/logs/target/linux/compile.txt log:)<br /></p><div class="codebox"><pre><code>net/sched/Kconfig:44: warning: menuconfig statement without prompt
.config:4440:warning: override: SPARSEMEM_MANUAL changes choice state
.config:4712:warning: override: TREE_RCU changes choice state
*
* Restart config...
*
*
* SCSI low-level drivers
*
SCSI low-level drivers (SCSI_LOWLEVEL) [Y/n] y
  iSCSI Initiator over TCP/IP (ISCSI_TCP) [N/m/?] n
  iSCSI Boot Sysfs Interface (ISCSI_BOOT_SYSFS) [N/m/?] n
  Chelsio T3 iSCSI support (SCSI_CXGB3_ISCSI) [N/m/?] n
  Chelsio T4 iSCSI support (SCSI_CXGB4_ISCSI) [N/m/?] n
  QLogic NetXtreme II iSCSI support (SCSI_BNX2_ISCSI) [N/m/?] n
  ServerEngines&#039; 10Gbps iSCSI - BladeEngine 2 (BE2ISCSI) [N/m/?] n
  3ware 5/6/7/8xxx ATA-RAID support (BLK_DEV_3W_XXXX_RAID) [N/m/?] n
  HP Smart Array SCSI driver (SCSI_HPSA) [N/m/?] n
  3ware 9xxx SATA-RAID support (SCSI_3W_9XXX) [N/m/?] n
  3ware 97xx SAS/SATA-RAID support (SCSI_3W_SAS) [N/m/?] n
  ACARD SCSI support (SCSI_ACARD) [N/m/?] n
  Adaptec AACRAID support (SCSI_AACRAID) [N/m/?] n
  Adaptec AIC7xxx Fast -&gt; U160 support (New Driver) (SCSI_AIC7XXX) [N/m/?] n
  Adaptec AIC79xx U320 support (SCSI_AIC79XX) [N/m/?] n
  Adaptec AIC94xx SAS/SATA support (SCSI_AIC94XX) [N/m/?] n
  Marvell 88SE64XX/88SE94XX SAS/SATA support (SCSI_MVSAS) [N/m/?] n
  Marvell UMI driver (SCSI_MVUMI) [N/m/?] n
  Adaptec I2O RAID support  (SCSI_DPT_I2O) [N/m/?] n
  AdvanSys SCSI support (SCSI_ADVANSYS) [N/m/?] n
  ARECA (ARC11xx/12xx/13xx/16xx) SATA/SAS RAID Host Adapter (SCSI_ARCMSR) [N/m/?] n
  ATTO Technology&#039;s ExpressSAS RAID adapter driver (SCSI_ESAS2R) [N/m/?] n
  LSI Logic New Generation RAID Device Drivers (MEGARAID_NEWGEN) [N/y/?] n
  LSI Logic Legacy MegaRAID Driver (MEGARAID_LEGACY) [N/m/?] n
  LSI Logic MegaRAID SAS RAID Module (MEGARAID_SAS) [N/m/?] n
  LSI MPT Fusion SAS 2.0 Device Driver (SCSI_MPT2SAS) [N/m/?] n
  LSI MPT Fusion SAS 3.0 Device Driver (SCSI_MPT3SAS) [N/m/?] n
  Universal Flash Storage Controller Driver Core (SCSI_UFSHCD) [N/m/?] n
  HighPoint RocketRAID 3xxx/4xxx Controller support (SCSI_HPTIOP) [N/m/?] n
  BusLogic SCSI support (SCSI_BUSLOGIC) [N/m/?] n
  VMware PVSCSI driver support (VMWARE_PVSCSI) [N/m/?] n
  DMX3191D SCSI support (SCSI_DMX3191D) [N/m/?] n
  EATA ISA/EISA/PCI (DPT and generic EATA/DMA-compliant boards) support (SCSI_EATA) [N/m/?] n
  Future Domain 16xx SCSI/AHA-2920A support (SCSI_FUTURE_DOMAIN) [N/m/?] n
  Intel/ICP (former GDT SCSI Disk Array) RAID Controller support (SCSI_GDTH) [N/m/?] n
  Intel(R) C600 Series Chipset SAS Controller (SCSI_ISCI) [N/m/?] n
  IBM ServeRAID support (SCSI_IPS) [N/m/?] n
  Initio 9100U(W) support (SCSI_INITIO) [N/m/?] n
  Initio INI-A100U2W support (SCSI_INIA100) [N/m/?] n
  Promise SuperTrak EX Series support (SCSI_STEX) [N/m/?] n
  SYM53C8XX Version 2 SCSI support (SCSI_SYM53C8XX_2) [N/m/?] n
  IBM Power Linux RAID adapter support (SCSI_IPR) [N/m/?] n
  Qlogic QLA 1240/1x80/1x160 SCSI support (SCSI_QLOGIC_1280) [N/m/?] n
  QLogic ISP4XXX and ISP82XX host adapter family support (SCSI_QLA_ISCSI) [N/m/?] n
  Tekram DC395(U/UW/F) and DC315(U) SCSI support (SCSI_DC395x) [N/m/?] n
  Tekram DC390(T) and Am53/79C974 SCSI support (new driver) (SCSI_AM53C974) [N/m/?] n
  Western Digital WD7193/7197/7296 support (SCSI_WD719X) [N/m/?] n
  SCSI debugging host and device simulator (SCSI_DEBUG) [N/m/?] n
  PMC SIERRA Linux MaxRAID adapter support (SCSI_PMCRAID) [N/m/?] n
  PMC-Sierra SPC 8001 SAS/SATA Based Host Adapter driver (SCSI_PM8001) [N/m/?] n
  virtio-scsi support (SCSI_VIRTIO) [N/m/?] (NEW) aborted!

Console input/output is redirected. Run &#039;make oldconfig&#039; to update configuration.

scripts/kconfig/Makefile:36: recipe for target &#039;silentoldconfig&#039; failed
make[7]: *** [silentoldconfig] Error 1
Makefile:543: recipe for target &#039;silentoldconfig&#039; failed
make[6]: *** [silentoldconfig] Error 2

The present kernel configuration has modules disabled.
Type &#039;make config&#039; and enable loadable module support.
Then build a kernel with module support enabled.

Makefile:1161: recipe for target &#039;modules&#039; failed
make[5]: *** [modules] Error 1
Makefile:22: recipe for target &#039;/home/mirko/Desktop/openwrt/build_dir/target-x86_64_uClibc-0.9.33.2/linux-x86_64/linux-4.0.4/.modules&#039; failed
make[4]: *** [/home/mirko/Desktop/openwrt/build_dir/target-x86_64_uClibc-0.9.33.2/linux-x86_64/linux-4.0.4/.modules] Error 2
Makefile:13: recipe for target &#039;compile&#039; failed
make[3]: *** [compile] Error 2</code></pre></div><p>Saving the kernel config performing </p><div class="codebox"><pre><code>$ make kernel_oldconfig</code></pre></div><p>or using the &quot;save&quot; function of <br /></p><div class="codebox"><pre><code>$ make kernel_menuconfig</code></pre></div><p> menu makes no difference...</p><p>This afternoon I&#039;ll retry using Fedora 22, or Debian 8, but if I&#039;ve to be honest I doubt it will change anything...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p279855">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						13 Jun 2015, 13:47					</div>
				</div>
				<div class="post-content content">
					<p>You have to add a line about that &quot;new/unknown&quot; SCSI_VIRTIO to your kernel config file.<br />Most likely:<br /># CONFIG_SCSI_VIRTIO is not set</p>											<p class="post-edited">(Last edited by <strong>hnyman</strong> on 13 Jun 2015, 13:48)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p279873">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">mirko_47</div>
					<div class="post-datetime">
						13 Jun 2015, 17:30					</div>
				</div>
				<div class="post-content content">
					<p>unfortunately this is one of the first thing that I tried to do, but it didn&#039;t solved anything.<br />The real problem is that the kernel that I&#039;m trying to build seems to have the &quot;loadable module support&quot; disabled, and even adding manually &quot;CONFIG_KERNEL_MODULES=y&quot; into kernel&#039;s .config helps...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p279886">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">mirko_47</div>
					<div class="post-datetime">
						13 Jun 2015, 19:14					</div>
				</div>
				<div class="post-content content">
					<p>just finished the last try, trying building it with Fedora, but as expected the situation remains the same.<br />Also trying to build it with different target and leaving untouched the kernel (4.0.4) .config I get the same error...</p><p>Now I&#039;m at my wit&#039;s end...&nbsp; could it be that I&#039;m missing some dependencies?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p279970">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">mirko_47</div>
					<div class="post-datetime">
						14 Jun 2015, 11:54					</div>
				</div>
				<div class="post-content content">
					<p>Just finished to build a linux kernel-only without errors, so it isn&#039;t a problem of missing dependencies.</p><p>As zloop reported <strong><a href="https://forum.openwrt.org/viewtopic.php?pid=256857#p256857">here</a></strong> it seems OpenWrt loads the default kernel&#039;s .config file from /target/linux/(target_arch)/config-(kernel_version).</p><p>In my case I can found &quot;config-3.18&quot; which I thought that it can cause problems using with the 4.0.4 kernel, but using also a newer .config that I already successfully used for 4.0.0 kern version the situation doesn&#039;t change.</p><p>So at this time I&#039;m quite sure that the only way to fix this error is add for each &quot;CONFIG_xxx&quot; line present into kernel.config file a line &quot;# CONFIG_xxx is not set&quot; as suggested by hnyman, but since the number of the lines to add is not very small does anyone knows a method to do that fast?</p><br /><p>Thank you very much in advance.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p279974">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">zloop</div>
					<div class="post-datetime">
						14 Jun 2015, 12:48					</div>
				</div>
				<div class="post-content content">
					<p>copy config-3.18 to config-4.0</p><p>After you run &quot;make prepare&quot; you should run<br />&quot;make kernel_oldconfig&quot;<br />This adds *most* of the symbols</p><p>If some symbols are not added to the arch specific section then add them to the generic one</p><p>I ran into this problem doing some test builds:<br />source: <a href="https://lists.openwrt.org/pipermail/openwrt-devel/2015-May/033289.html">https://lists.openwrt.org/pipermail/ope … 33289.html</a></p><p>Be sure to check with &quot;git diff&quot; if there are any other *major* differences introduced by that</p><p>What arch/target are you wanting to test with 4.0.x ?<br />x86-64,x86,omap and malta should boot if you update the symbols in the way I described</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p280704">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">mirko_47</div>
					<div class="post-datetime">
						19 Jun 2015, 19:06					</div>
				</div>
				<div class="post-content content">
					<p>Maybe, I&#039;ve just find a way to fix the issue (and the solution seem to be easier than I expected):</p><p>-Run make kernel_menuconfig into the OpenWrt buildroot folder<br />-save the kern.config<br />-download from kernel.org the linux4.0.4 tarball, extract and then run make menuconfig into the extracted folder<br />-load the ker.config and save it, for example as kern_fixed.conmfig.<br />-load again into the OpenWrt buildroot the kern_fixed.conmfig.<br />This seems to fix all the missing symbols.</p><p>Thanks you very much to everyone again.<br />Regards.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>