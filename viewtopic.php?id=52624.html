<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> wan trafic monitor</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 7 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p246383">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">phantanphu</div>
					<div class="post-datetime">
						8 Sep 2014, 04:56					</div>
				</div>
				<div class="post-content content">
					<p>dd-wrt have buiit in wan trafic monitor, it saves trafic daily and monthly. Does Openwrt has the similar tool?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p246385">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">derdigge</div>
					<div class="post-datetime">
						8 Sep 2014, 05:10					</div>
				</div>
				<div class="post-content content">
					<p>look for packag luci-app-statistics it is much better than that tool from ddwrt.<br />Also take a look at all collectd-mod-* packages which will extend the statistic funcionality ...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p246387">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">drawz</div>
					<div class="post-datetime">
						8 Sep 2014, 07:36					</div>
				</div>
				<div class="post-content content">
					<p>luci-app-vnstat is a bit lighter weight (storage/memory-wise) and can provide the requested info, but is less flexible than luci-app-statistics/collectd for other stuff.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p246396">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">rseiler</div>
					<div class="post-datetime">
						8 Sep 2014, 09:59					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m about to give up trying to get luci-app-vnstat to work. It seems to work when I&#039;m watching it, but then it seems that after a number of days when I go to check in on it I find that it hasn&#039;t been recording anything for days.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p246398">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						8 Sep 2014, 10:04					</div>
				</div>
				<div class="post-content content">
					<p>Try darkstat, real easy and lightweight.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p246434">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">tmo26</div>
					<div class="post-datetime">
						8 Sep 2014, 13:27					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>rseiler wrote:</cite><blockquote><p>I&#039;m about to give up trying to get luci-app-vnstat to work. It seems to work when I&#039;m watching it, but then it seems that after a number of days when I go to check in on it I find that it hasn&#039;t been recording anything for days.</p></blockquote></div><p>Did you reboot the device during the time period in question?<br />I&#039;m not sure whether the vnstat database is stored persistently or in RAM. The latter would explain that you don&#039;t see any data (if the device has been rebooted).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p246462">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">rseiler</div>
					<div class="post-datetime">
						8 Sep 2014, 17:40					</div>
				</div>
				<div class="post-content content">
					<p>No reboot. You&#039;re right that it&#039;s not stored in a persistent area, so the files need to backed up periodically. However, if it was a reboot, all data would be lost, not just certain periods like I&#039;m seeing.</p><p>Since the data files are binary and can&#039;t be viewed manually, it&#039;s difficult to tell whether the problem lies in the vnstat process itself or luci-app-vnstat that displays it. I see that the vnstat portion was just updated days ago for the first time in years, so I&#039;ll try updating to it to see if it helps. Darkstat that arokh mentioned is plan b.<br /><a href="http://humdi.net/vnstat/CHANGES">http://humdi.net/vnstat/CHANGES</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p246858">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">phantanphu</div>
					<div class="post-datetime">
						12 Sep 2014, 15:59					</div>
				</div>
				<div class="post-content content">
					<p>How can I make vnstat does not erase data after reboot.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p246874">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">moeller0</div>
					<div class="post-datetime">
						12 Sep 2014, 21:31					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>phantanphu wrote:</cite><blockquote><p>How can I make vnstat does not erase data after reboot.</p></blockquote></div><p>please see: <a href="http://wiki.openwrt.org/doc/howto/vnstat">http://wiki.openwrt.org/doc/howto/vnstat</a></p><br /><p>Below my version of vnstatbackup</p><br /><p>#!/bin/sh<br />## Please visit <a href="http://wiki.openwrt.org/doc/howto/vnstat">http://wiki.openwrt.org/doc/howto/vnstat</a><br /># 20121008sm: automate parsing of vnstat related information<br /># place this script in /etc/init.d<br /># make it executable: chmod 755 /etc/init.d/vnstatbackup<br /># 4 CRON: echo &quot;*/30 * * * * /etc/init.d/vnstatbackup backup&quot; &gt;&gt; /etc/crontabs/root<br />#&nbsp; &nbsp; &nbsp; &nbsp;/etc/init.d/cron restart<br /># 4 INIT add<br /># /etc/init.d/vnstatbackup restore<br /># to /etc/rc.local</p><br /><p># edit this<br />BACKUP_BASE_DIR=&quot;/home/persistent&quot;&nbsp; &nbsp; &nbsp; # where to store the database backup</p><p># for vnstat have a look at /etc/vnstat.conf (code taken from /etc/init.d/vnstat)<br />vnstat_option() {<br />&nbsp; &nbsp; sed -ne &quot;s/^[[:space:]]*$1[[:space:]]*[&#039;\&quot;]\([^&#039;\&quot;]*\)[&#039;\&quot;].*/\1/p&quot; \<br />&nbsp; &nbsp; /etc/vnstat.conf<br />}<br />VNSTAT_DB_DIR=&quot;$(vnstat_option DatabaseDir)&quot;<br />VNSTAT_BASE_DIR=`dirname ${VNSTAT_DB_DIR}` #${VNSTAT_DB_DIR%/*}<br />VNSTAT_SUB_DIR=`basename ${VNSTAT_DB_DIR}` #&quot;vnstat&quot;</p><p>#echo &quot;VNSTAT_DB_DIR ${VNSTAT_DB_DIR}&quot;<br />#echo &quot;VNSTAT_BASE_DIR ${VNSTAT_BASE_DIR}&quot;<br />#echo &quot;VNSTAT_SUB_DIR ${VNSTAT_SUB_DIR}&quot;<br />#echo &quot;BACKUP_BASE_DIR ${BACKUP_BASE_DIR}&quot;</p><p>case $1 in<br />&nbsp; &nbsp; backup)<br />&nbsp; &nbsp; &nbsp; &nbsp; cp -r ${VNSTAT_BASE_DIR}/${VNSTAT_SUB_DIR} ${BACKUP_BASE_DIR}<br />&nbsp; &nbsp; &nbsp; &nbsp; ;;<br />&nbsp; &nbsp; restore)<br />&nbsp; &nbsp; &nbsp; &nbsp; cp -r ${BACKUP_BASE_DIR}/${VNSTAT_SUB_DIR} ${VNSTAT_BASE_DIR}<br />&nbsp; &nbsp; &nbsp; &nbsp; ;;<br />&nbsp; &nbsp; *)<br />&nbsp; &nbsp; &nbsp; &nbsp; echo &quot;Please use &#039;backup&#039; or &#039;restore&#039; parameter for run&quot;;<br />&nbsp; &nbsp; &nbsp; &nbsp; ;;<br />esac</p><p>exit 0</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p246875">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						12 Sep 2014, 21:43					</div>
				</div>
				<div class="post-content content">
					<p>A backup script seems unnecessary. Just make sure vnstat uses a different directory than /tmp and you&#039;re set.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>