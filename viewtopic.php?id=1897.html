<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Compiling php with mysql</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 30 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p8954">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Oliver</div>
					<div class="post-datetime">
						1 Jul 2005, 05:58					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I&#039;m currently trying to compile php5 with mysql support (as an extension).<br />I succeeded compiling a fastcgi binary without mysql, you can get it here :</p><p><a href="http://www.ohardt.com/computer/dev/openwrt/binaries/">http://www.ohardt.com/computer/dev/openwrt/binaries/</a></p><p>It works perfectly with thhtpd compiled by aorlinsk.</p><p>Anyway, when running ./configure and trying to include the mysql libraries I run into the problem that the compiler (linker ?) complains that it can&#039;t find libz.so.1 that libmysqlclient.so requires. All the libraries are in place, I even linked libz.so.1 from the ../usr/lib/myqsl directory but no success.</p><p>I think I can fix the problem by adding -rpath-link with the path to the libz binaries to the linker ( ld ) but I have no idea how to do that. </p><p>Any ideas anyone ?</p><p>&nbsp; Oliver</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p9009">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">aorlinsk</div>
					<div class="post-datetime">
						2 Jul 2005, 01:27					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>I have compiled PHP5 with MySQL support. If you want to test the packages (i made no testing myself) you can find them in <a href="http://aorlinsk2.free.fr/openwrt/ipkg/php5/">http://aorlinsk2.free.fr/openwrt/ipkg/php5/</a> , and the source package can be found in <a href="http://aorlinsk2.free.fr/openwrt/ipkg-src/">http://aorlinsk2.free.fr/openwrt/ipkg-src/</a> </p><p>Please advise me whether if the packages are working.</p><p>Anael</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p9024">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">enzo</div>
					<div class="post-datetime">
						2 Jul 2005, 09:54					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>aorlinsk wrote:</cite><blockquote><p>Hello,</p><p>I have compiled PHP5 with MySQL support. If you want to test the packages (i made no testing myself) you can find them in <a href="http://aorlinsk2.free.fr/openwrt/ipkg/php5/">http://aorlinsk2.free.fr/openwrt/ipkg/php5/</a> , and the source package can be found in <a href="http://aorlinsk2.free.fr/openwrt/ipkg-src/">http://aorlinsk2.free.fr/openwrt/ipkg-src/</a> </p><p>Please advise me whether if the packages are working.</p><p>Anael</p></blockquote></div><p>By the way: as you guys are at it, please consider creating a PHP for OpenWRT with Sqlite support. This would allow totally self-contained applications, without need for an external RDBMS. Incidentally, Sqlite itself has already been ported to OpenWRT by Florian Fainelli: <a href="http://nthill.free.fr/openwrt/tracker/packages/show.php?id=1733">http://nthill.free.fr/openwrt/tracker/p … hp?id=1733</a> . (That package includes also libsqlite3.a and sqlite3.h, which are required for development but may be removed at runtime). </p><p>Enzo</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p9030">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Nico</div>
					<div class="post-datetime">
						2 Jul 2005, 13:22					</div>
				</div>
				<div class="post-content content">
					<p>Hi Anael and Enzo,</p><p>I started integrating the PHP sources from Anael (aorlinsk) into CVS. I&#039;m extending them to provides as much extensions as we can (MySQL, PostgreSQL, LDAP, SQLite...). It should be ready on monday.</p><p>Thanks for your great work and your help</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p9034">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">aorlinsk</div>
					<div class="post-datetime">
						2 Jul 2005, 14:32					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>enzo wrote:</cite><blockquote><div class="quotebox"><cite>aorlinsk wrote:</cite><blockquote><p>Hello,</p><p>I have compiled PHP5 with MySQL support. If you want to test the packages (i made no testing myself) you can find them in <a href="http://aorlinsk2.free.fr/openwrt/ipkg/php5/">http://aorlinsk2.free.fr/openwrt/ipkg/php5/</a> , and the source package can be found in <a href="http://aorlinsk2.free.fr/openwrt/ipkg-src/">http://aorlinsk2.free.fr/openwrt/ipkg-src/</a> </p><p>Please advise me whether if the packages are working.</p><p>Anael</p></blockquote></div><p>By the way: as you guys are at it, please consider creating a PHP for OpenWRT with Sqlite support. This would allow totally self-contained applications, without need for an external RDBMS. Incidentally, Sqlite itself has already been ported to OpenWRT by Florian Fainelli: <a href="http://nthill.free.fr/openwrt/tracker/packages/show.php?id=1733">http://nthill.free.fr/openwrt/tracker/p … hp?id=1733</a> . (That package includes also libsqlite3.a and sqlite3.h, which are required for development but may be removed at runtime). </p><p>Enzo</p></blockquote></div><p>Hi,</p><p>This is not a problem to include SQLite, I think I already managed to do it.<br />But I&#039;d like to use the shared SQLite package (3.x) provided by Florian Fainelli.<br />So, quick summary : <br />PHP 5.0.4 =&gt; SQLite 2.x built in, this doesn&#039;t use shared libs and takes more space.<br />PHP 5.1.0b2 =&gt; SQLite 3.x with dbo extension, I couldn&#039;t figure out how to avoid using the built-in SQLite 3</p><p>I&#039;ll have a try to tweak PHP 5.1.0b2 tonight to use shared SQLite lib.</p><p>Anael</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p9039">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Nico</div>
					<div class="post-datetime">
						2 Jul 2005, 16:51					</div>
				</div>
				<div class="post-content content">
					<p>Anael,</p><p>have you tried using the <a href="http://pecl.php.net/get/SQLite-1.0.tgz">extension</a> from <a href="http://pecl.php.net/">PECL</a> ?<br />I&#039;m planning to use it to add SQLite to PHP4.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p9040">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">enzo</div>
					<div class="post-datetime">
						2 Jul 2005, 16:55					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>aorlinsk wrote:</cite><blockquote><p>Hi,</p><p>This is not a problem to include SQLite, I think I already managed to do it.<br />But I&#039;d like to use the shared SQLite package (3.x) provided by Florian Fainelli.<br />So, quick summary : <br />PHP 5.0.4 =&gt; SQLite 2.x built in, this doesn&#039;t use shared libs and takes more space.<br />PHP 5.1.0b2 =&gt; SQLite 3.x with dbo extension, I couldn&#039;t figure out how to avoid using the built-in SQLite 3</p><p>I&#039;ll have a try to tweak PHP 5.1.0b2 tonight to use shared SQLite lib.</p><p>Anael</p></blockquote></div><p>Yes, using the shared SQLite is definitely better, as other applications might want to use as well. &quot;./configure --help&quot; suggests:<br /></p><div class="codebox"><pre><code>[...]
  --without-sqlite      Do not include sqlite support.
                          Use --with-sqlite=DIR to specify DIR where
                          Sqlite include and library files are located,
                          if not using bundled library.
[...]</code></pre></div><p>Alternatively, you might consider porting PHP4, which is probably also smaller.</p><p>Enzo</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p9041">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">Nico</div>
					<div class="post-datetime">
						2 Jul 2005, 17:07					</div>
				</div>
				<div class="post-content content">
					<p>Anael,</p><p>since SQLite3 is <a href="http://openwrt.org/cgi-bin/viewcvs.cgi/openwrt/package/sqlite/">already</a> in CVS, you can try what Enzo suggests :<br /></p><div class="codebox"><pre><code>./configure \
  ... \
  --with-sqlite=&quot;$(STAGING_DIR)/usr&quot; \
  ... \</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p9049">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">aorlinsk</div>
					<div class="post-datetime">
						3 Jul 2005, 00:03					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>As far as I know, the PHP module provided for SQLite in PHP 5.0.x (or the one you find for PHP4 in PECL), the one you configure with --with-sqlite=[DIR], is suitable only for SQLite 2.x</p><p>If we want to use AND link with SQLite 3.x (the one is in CVS), it is only possible with new pdo extension (available in PHP 5.1.0b2 or in PECL for PHP 5.0.3+).<br />However it looks like we have to use bundeled SQLite 3.x (provided with pdo). I need a way to do --with-pdo-sqlite=[DIR], unfortunately this doesn&#039;nt work.</p><p>If you want the base files for php 5.1.0b2 (ipkg source), you can find them here <a href="http://aorlinsk2.free.fr/openwrt/ipkg-src/">http://aorlinsk2.free.fr/openwrt/ipkg-src/</a>&nbsp; but job is not finished (package creation has to be updated)</p><p>Also note that I can&#039;t get xml modules to work out-of-the-box. I&#039;ll surely have a look at this later (it worked in PHP4).</p><p>Anael</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p9063">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">enzo</div>
					<div class="post-datetime">
						3 Jul 2005, 10:52					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>aorlinsk wrote:</cite><blockquote><p>Hi,</p><p>As far as I know, the PHP module provided for SQLite in PHP 5.0.x (or the one you find for PHP4 in PECL), the one you configure with --with-sqlite=[DIR], is suitable only for SQLite 2.x</p><p>If we want to use AND link with SQLite 3.x (the one is in CVS), it is only possible with new pdo extension (available in PHP 5.1.0b2 or in PECL for PHP 5.0.3+).<br />However it looks like we have to use bundeled SQLite 3.x (provided with pdo). I need a way to do --with-pdo-sqlite=[DIR], unfortunately this doesn&#039;nt work.<br />[...]</p></blockquote></div><p>Perhaps it would be wise to wait for stable releases, and for now stick to SQLite 2.8.14 and perhaps also PHP 4.3.9, don&#039;t you think? That&#039;s the approach taken by RHEL and other distributions thought for production systems... Although I don&#039;t know how easy it would be to integrate SQlite in PHP4 without having to install PEAR and relative overhead. </p><p>Also, for OpenWRT that space is at a premium, so I&#039;d happily trade advanced features for smaller size of the executables.</p><p>Cheers --</p><p>Enzo</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p9143">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">Nico</div>
					<div class="post-datetime">
						5 Jul 2005, 12:21					</div>
				</div>
				<div class="post-content content">
					<p>PHP4 was added in CVS (HEAD) yesterday.</p><p>There are 3 versions :<br /> . cli : PHP4 compiled as CLI (for interactive use)<br /> . cgi : PHP4 as a CGI<br /> . fastcgi : PHP4 for use with a FastCGI compatible server (lighttpd)</p><p>The following extensions are available :<br /> . ftp<br /> . gd<br /> . ldap<br /> . mysql<br /> . openssl<br /> . pcre<br /> . postgresql<br /> . sessions<br /> . socket<br /> . sqlite<br /> . xml</p><p>Feedback welcome !</p><p>Thanks Anael and Enzo for the help.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p9172">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">Oliver</div>
					<div class="post-datetime">
						6 Jul 2005, 00:45					</div>
				</div>
				<div class="post-content content">
					<p>Hey,</p><p>sorry for totally missing out on this thread, was gone for the 4th of July weekend.</p><p>I finally managed to get php 5 (5.1b2 and 5.0.4)&nbsp; compiled inculding mysql as a shared module.<br />I use the configure as it shows phpconfig of the php aorlinsk compiled but my executable is rought 4 to 5 MB large which is HUGE compared to aorlinsks php (slightly over 1MB). </p><p>So I guess the questions is directed to aorlinsk, how do you keep the executables so small ?&nbsp; </p><p>I&#039;d be more than happy to prepare some php5.1.b2 packages but right now they&#039;re way too large.</p><p>Cheers,</p><p>&nbsp; Oliver</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p9182">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">aorlinsk</div>
					<div class="post-datetime">
						6 Jul 2005, 11:20					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Oliver wrote:</cite><blockquote><p>Hey,</p><p>sorry for totally missing out on this thread, was gone for the 4th of July weekend.</p><p>I finally managed to get php 5 (5.1b2 and 5.0.4)&nbsp; compiled inculding mysql as a shared module.<br />I use the configure as it shows phpconfig of the php aorlinsk compiled but my executable is rought 4 to 5 MB large which is HUGE compared to aorlinsks php (slightly over 1MB). </p><p>So I guess the questions is directed to aorlinsk, how do you keep the executables so small ?&nbsp; </p><p>I&#039;d be more than happy to prepare some php5.1.b2 packages but right now they&#039;re way too large.</p><p>Cheers,</p><p>&nbsp; Oliver</p></blockquote></div><p>I think you have to explicitely disable some extensions and features using --without-xxxx or by enabling the shared creation of shared libraries, using --with-xxxxx=shared,PATH</p><p>Maybe what happens is your php binary is not able to load shared libraries, so the extensions are builtin and thus the executable is huge.</p><p>You can have a look at the makefiles I used to deliver the modules, included in the source packages you&#039;ll find here <a href="http://aorlinsk2.free.fr/openwrt/ipkg-src/">http://aorlinsk2.free.fr/openwrt/ipkg-src/</a></p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>