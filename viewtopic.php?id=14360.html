<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Change wan MAC address</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 28 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p62726">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">cbreaker</div>
					<div class="post-datetime">
						2 Feb 2008, 22:13					</div>
				</div>
				<div class="post-content content">
					<p>Greetings, I haven&#039;t been using OpenWRT/Kamikaze for very long, but I&#039;m not a linux newbie.&nbsp; &nbsp; I&#039;m having a hard time figuring the right way to change the MAC address of WAN on my WRT-54GL.</p><p>Most of the documentation out there must pertain to WhiteRussian because nothing seems to apply anymore.&nbsp; &nbsp;Most docs say to use an nvram parameter wan_hwaddr to set it, but it seems to have no effect.</p><p>ifconfig shows this:</p><p>br-lan&nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 00:1D:7E:DC:31:44&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:192.168.0.8&nbsp; Bcast:192.168.0.255&nbsp; Mask:255.255.255.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:53 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:83 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0 <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:5257 (5.1 KiB)&nbsp; TX bytes:12708 (12.4 KiB)</p><p>eth0&nbsp; &nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 00:1D:7E:DC:31:44&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:3383 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:3894 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000 <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:361769 (353.2 KiB)&nbsp; TX bytes:685028 (668.9 KiB)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Interrupt:4 </p><p>eth0.0&nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 00:1D:7E:DC:31:44&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:3395 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:3500 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0 <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:301917 (294.8 KiB)&nbsp; TX bytes:535915 (523.3 KiB)</p><p>eth0.1&nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 00:1D:7E:DC:31:44&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:10.10.10.10&nbsp; Bcast:10.10.10.255&nbsp; Mask:255.255.255.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:405 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0 <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:0 (0.0 B)&nbsp; TX bytes:133245 (130.1 KiB)</p><p>lo&nbsp; &nbsp; &nbsp; &nbsp; Link encap:Local Loopback&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:127.0.0.1&nbsp; Mask:255.0.0.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP LOOPBACK RUNNING&nbsp; MTU:16436&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:0 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0 <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:0 (0.0 B)&nbsp; TX bytes:0 (0.0 B)</p><p>wl0&nbsp; &nbsp; &nbsp; &nbsp;Link encap:Ethernet&nbsp; HWaddr 00:1D:7E:DC:31:46&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:0 errors:0 dropped:0 overruns:0 frame:195<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:0 errors:119 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000 <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:0 (0.0 B)&nbsp; TX bytes:0 (0.0 B)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Interrupt:2 Base address:0x5000 </p><p>I have set 10.10.10.10 as the WAN address static for now, for testing.&nbsp; &nbsp;The webif set the address on eth0.1 - isn&#039;t that a virtual interface?&nbsp; &nbsp;The MAC is the same as all the others.&nbsp; &nbsp; Do I need to do something to specify the correct WAN interface?&nbsp; &nbsp;What is it called?&nbsp; &nbsp;All of the documentation I&#039;ve seen online shows vlan0 as being wan or something, and that interface does not exist.</p><p>Any points in the right direction would be greatly appreciated.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p62727">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">MMCM</div>
					<div class="post-datetime">
						2 Feb 2008, 23:32					</div>
				</div>
				<div class="post-content content">
					<p>add &quot;option macaddr xx:xx:xx:xx:xx:xx&quot; to the corresponding &quot;config interface&quot; section in /etc/config/network</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p62731">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">cbreaker</div>
					<div class="post-datetime">
						3 Feb 2008, 00:14					</div>
				</div>
				<div class="post-content content">
					<p>Thanks.&nbsp; &nbsp;I actually just guessed what it was five minutes before your reply <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>But does the interface name of eth0.1 seem right for the WAN?&nbsp; &nbsp;I&#039;ll be testing it in a couple hours - the device is actually not here, it&#039;s remote.&nbsp; &nbsp;I&#039;ve installed and configured most of OpenWRT remotely but unfortunately I don&#039;t have a robot over there that can plug in the WAN interface for me.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p62752">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">MMCM</div>
					<div class="post-datetime">
						3 Feb 2008, 12:26					</div>
				</div>
				<div class="post-content content">
					<p>Normally eth0.1 is the WAN interface, if you didn&#039;t change the vlan configuration too much.<br />However, it&#039;s configuration section is &quot;config interface wan&quot;</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p62753">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">forum2008</div>
					<div class="post-datetime">
						3 Feb 2008, 12:55					</div>
				</div>
				<div class="post-content content">
					<p>If you didn&#039;t changed to much in the wan section in /etc/config/network you can run the commands below to change the wan MAC address.</p><div class="codebox"><pre><code>uci set network.wan.macaddr=&quot;&lt;mac_address&gt;&quot;
uci commit network
ifdown wan &amp;&amp; ifup wan</code></pre></div>											<p class="post-edited">(Last edited by <strong>forum2008</strong> on 3 Feb 2008, 12:55)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p62972">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">jackiam</div>
					<div class="post-datetime">
						6 Feb 2008, 22:25					</div>
				</div>
				<div class="post-content content">
					<p>This works great for me also but does anybody have a script that will set network.wan.macaddr=&lt;network.lan.macaddr&gt;+1 or something like that. I assume that the MAC address is derived from the nvram setting but where does that happen?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p62977">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">cbreaker</div>
					<div class="post-datetime">
						7 Feb 2008, 00:59					</div>
				</div>
				<div class="post-content content">
					<p>Actually, I&#039;m not sure where it gets the original values.&nbsp; &nbsp;For the router I installed OpenWRT on (Linksys WRT54GL) it just had one - 00:1D:7E:DC:31:44 which OpenWRT assigned to both the LAN and WAN ports.&nbsp; &nbsp;nvRAM on this unit shows this:&nbsp; et0macaddr=00:1D:7E:DC:31:44&nbsp; but that could have been left behind from the DD-WRT install that was on this unit.&nbsp; &nbsp;It could get the information from the network chip like in a PC, maybe.</p><p>It will be interesting to see how it works with my Motorola WR850R, since that unit apparently has no pre-determined MAC addresses.&nbsp; &nbsp;When I installed DD-WRT on that one, I had to assign both the WAN and LAN addresses manually and it was a pain in the butt.</p><p>I&#039;m curious as to why you&#039;d like to automate it with a script or some such?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p62981">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">jackiam</div>
					<div class="post-datetime">
						7 Feb 2008, 03:01					</div>
				</div>
				<div class="post-content content">
					<p>The original Linksys firmware uses 2 different MAC addresses. My nvram contains a 2nd MAC address in il0macaddr which is set to a value of et0macaddr +2 but I&#039;m not certain if this is a remnant of the Linksys sonfig. or not.</p><p>Manually setting the WAN macaddr is no big deal for my personal router but this loadfile will be installed on potentially many more and I want to make the configuration automagical.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>