<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> WRT54GSv2 WLAN monitoring</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 26 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p61448">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">harry66</div>
					<div class="post-datetime">
						8 Jan 2008, 23:49					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>seems like I am missing some specific part when setting up my WLAN for kind of airodump.</p><p>Here I get stuck:</p><p>root@OpenWrt:~# airodump-ng prism0<br />Error setting monitor mode on prism0</p><p>And this is how I get there:<br />&nbsp; - installed brcm-2.4 stock binary of Kamikaze 7.09<br />&nbsp; - setup lan iface<br />&nbsp; - setup wifi in non-bridged mode<br />&nbsp; - setup ipkg<br />&nbsp; - install both aircrack-{ng|ptw}<br />&nbsp; - reboot to make sure everything is config&#039;ed correct<br />&nbsp; - issue &quot;wlc monitor 1&quot;</p><p>ifconfig ~&gt;<br />root@OpenWrt:~# ifconfig<br />eth0&nbsp; &nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 00:0F:66:C7:78:35<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:311 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:529 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:28991 (28.3 KiB)&nbsp; TX bytes:123227 (120.3 KiB)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Interrupt:5</p><p>eth0.0&nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 00:0F:66:C7:78:35<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:192.168.3.199&nbsp; Bcast:192.168.3.255&nbsp; Mask:255.255.255.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:312 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:257 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:23485 (22.9 KiB)&nbsp; TX bytes:33195 (32.4 KiB)</p><p>eth0.1&nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 00:0F:66:C7:78:35<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:273 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:0 (0.0 B)&nbsp; TX bytes:88179 (86.1 KiB)</p><p>lo&nbsp; &nbsp; &nbsp; &nbsp; Link encap:Local Loopback<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:127.0.0.1&nbsp; Mask:255.0.0.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP LOOPBACK RUNNING&nbsp; MTU:16436&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:0 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:0 (0.0 B)&nbsp; TX bytes:0 (0.0 B)</p><p>prism0&nbsp; &nbsp; Link encap:UNSPEC&nbsp; HWaddr 00-0F-66-C7-78-37-00-00-00-00-00-00-00-00-00<br />-00<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST&nbsp; MTU:0&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:0 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:0 (0.0 B)&nbsp; TX bytes:0 (0.0 B)</p><p>wl0&nbsp; &nbsp; &nbsp; &nbsp;Link encap:Ethernet&nbsp; HWaddr 00:0F:66:C7:78:37<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:192.168.1.1&nbsp; Bcast:192.168.1.255&nbsp; Mask:255.255.255.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:0 errors:0 dropped:0 overruns:0 frame:23231<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:0 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:0 (0.0 B)&nbsp; TX bytes:0 (0.0 B)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Interrupt:4 Base address:0x1000</p><p>root@OpenWrt:~#</p><p>looks good</p><p>iwconfig ~&gt;<br />root@OpenWrt:~# iwconfig<br />lo&nbsp; &nbsp; &nbsp; &nbsp; no wireless extensions.</p><p>eth0&nbsp; &nbsp; &nbsp; no wireless extensions.</p><p>eth0.0&nbsp; &nbsp; no wireless extensions.</p><p>eth0.1&nbsp; &nbsp; no wireless extensions.</p><p>wl0&nbsp; &nbsp; &nbsp; &nbsp;IEEE 802.11-DS&nbsp; ESSID:&quot;&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Mode:Repeater&nbsp; Frequency:2.432 GHz&nbsp; Tx-Power:19 dBm<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RTS thr:2347 B&nbsp; &nbsp;Fragment thr:2346 B<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Encryption key:off</p><p>prism0&nbsp; &nbsp; no wireless extensions.</p><p>root@OpenWrt:~#</p><p>looks good - prism0 is present, but still:<br />root@OpenWrt:~# airodump-ng prism0<br />Error setting monitor mode on prism0<br />root@OpenWrt:~#</p><p>Can you give me a hint please! What am I missing?</p><p>Many thanks!<br />harry</p><br /><br /><br /><p>--- additional -------------------------------------------<br />root@OpenWrt:~# airodump-ng prism0<br />Error setting monitor mode on prism0<br />root@OpenWrt:~# cat /etc/config/network<br />#### VLAN configuration<br />config switch eth0<br />&nbsp; &nbsp; &nbsp; &nbsp; option vlan0&nbsp; &nbsp; &quot;1 2 3 4 5*&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; option vlan1&nbsp; &nbsp; &quot;0 5&quot;</p><br /><p>#### Loopback configuration<br />config interface loopback<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname&nbsp; &nbsp;&quot;lo&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto&nbsp; &nbsp; static<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr&nbsp; &nbsp;127.0.0.1<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask&nbsp; 255.0.0.0</p><br /><p>#### LAN configuration<br />config interface lan<br />&nbsp; &nbsp; &nbsp; &nbsp; #option type&nbsp; &nbsp; bridge<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname&nbsp; &nbsp;&quot;eth0.0&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto&nbsp; &nbsp; static<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr&nbsp; &nbsp;192.168.3.199<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask&nbsp; 255.255.255.0<br />&nbsp; &nbsp; &nbsp; &nbsp; option dns&nbsp; &nbsp; &nbsp; 192.168.3.1</p><p>#### WiFi interface<br />config interface wifi<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname&nbsp; &nbsp;&quot;wl0&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto&nbsp; &nbsp; static<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr&nbsp; &nbsp;192.168.1.1<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask&nbsp; 255.255.255.0</p><p>#### WAN configuration<br />config interface&nbsp; &nbsp; &nbsp; &nbsp; wan<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname&nbsp; &nbsp;&quot;eth0.1&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto&nbsp; &nbsp; dhcp<br />root@OpenWrt:~#<br />root@OpenWrt:~# cat /etc/config/wireless<br />config wifi-device&nbsp; wl0<br />&nbsp; &nbsp; &nbsp; &nbsp; option type&nbsp; &nbsp; &nbsp;broadcom<br />&nbsp; &nbsp; &nbsp; &nbsp; option channel&nbsp; 5</p><p>&nbsp; &nbsp; &nbsp; &nbsp; # REMOVE THIS LINE TO ENABLE WIFI:<br />&nbsp; &nbsp; &nbsp; &nbsp; option disabled 0</p><p>config wifi-iface<br />&nbsp; &nbsp; &nbsp; &nbsp; option device&nbsp; &nbsp;wl0<br />&nbsp; &nbsp; &nbsp; &nbsp; option network&nbsp; wifi<br />&nbsp; &nbsp; &nbsp; &nbsp; option mode&nbsp; &nbsp; &nbsp;sta<br />&nbsp; &nbsp; &nbsp; &nbsp; option ssid&nbsp; &nbsp; &nbsp;bogus<br />&nbsp; &nbsp; &nbsp; &nbsp; option encryption none<br />root@OpenWrt:~#</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p61504">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">harry66</div>
					<div class="post-datetime">
						9 Jan 2008, 20:00					</div>
				</div>
				<div class="post-content content">
					<p>hmmm no replies. no &quot;search the forum&quot; flames.<br />does that mean i found a bug?</p><p>/harry</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p61577">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">knowname</div>
					<div class="post-datetime">
						11 Jan 2008, 09:19					</div>
				</div>
				<div class="post-content content">
					<p>Here&#039;s what I get....</p><p>&nbsp; bootup-</p><p>no prism0 from &quot;iwconfig&quot;<br />no prism0 from &quot;ifconfig&quot;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; Source 0 (wireless): Opening wrt54g source interface prism0...<br />&nbsp; &nbsp; &nbsp; &nbsp; FATAL: ioctl: No such device <br />&nbsp; &nbsp; &nbsp; &nbsp; from<br />&nbsp; &nbsp; &nbsp; &nbsp;&quot;kismet_drone -f /etc/kismet/kismet_drone.conf&quot;</p><p>still no prism0 with &quot;ifconfig wl0 up&quot;</p><p>&nbsp; &nbsp; &nbsp;ARP linktype is set to 1 (Ethernet) - expected ARPHRD_IEEE80211<br />or ARPHRD_IEEE80211_PRISM instead.&nbsp; Make sure RFMON is enabled:<br />run &#039;ifconfig wl0 up; iwconfig wl0 mode Monitor channel &lt;#&gt;&#039;&nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; from<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;airodump-ng wl0&quot;&nbsp; </p><p>&nbsp; &quot;iwconfig&quot; now has prism0&nbsp; no wireless extensions after &quot;airodump-ng wl0&quot; ran once and failed.&nbsp; </p><p> Now &quot;airodump-ng prism0&quot; works.&nbsp; </p><p>The best part is :&nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &quot;kismet_drone -f /etc/kismet/kismet_drone.conf&quot;</p><p>kismet drone finally works for me with Kamikaze 7.09!!!</p><p>So I don&#039;t have a prism0 until &quot;airodump-ng wl0&quot; tries running once and fails. Then the prism0 is up. I didn&#039;t &quot;ifconfig wl0 up&quot; after &quot;airodump-ng wl0&quot; ran the first time but a prism0 appeared after. No prism0 before running &quot;airodump-ng wl0&quot;. Now &quot;airodump-ng prism0&quot; works after failing once with &quot;airodump-ng wl0&quot; It seems running &quot;airodump-ng wl0&quot; also switched wl0 into Monitor mode. How nice of aircrack-ng to help me get a kismet drone working!&nbsp; Kismet drone seems to scan better than airodump-ng. Maybe it&#039;s just me. I don&#039;t know if any of that helps you but I&#039;m doing this on a WRT54GS v2.1.&nbsp; &nbsp; Good Luck</p>											<p class="post-edited">(Last edited by <strong>knowname</strong> on 11 Jan 2008, 09:54)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p67775">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">airsurfer</div>
					<div class="post-datetime">
						3 May 2008, 21:15					</div>
				</div>
				<div class="post-content content">
					<p>Indeed, the whole monitoring issue on WRT54G (mine is v4) is a bit strange. Here is a sequence of commands one can run with &quot;kamikaze 7.09 &amp; 2.4 kernel&quot; to get monitoring to work:</p><p>###<br />wl monitor 1<br />ifconfig wl0 up<br />iwconfig wl0 txpower 5mW<br />airodump-ng wl0<br />airodump-ng prism0<br />###</p><p>I reduce the power for monitoring since it should not emit anything anyway ...</p><p> Note that without running &quot;airodump-ng wl0&quot; (which fails), &quot;prism0&quot; does not work.</p>											<p class="post-edited">(Last edited by <strong>airsurfer</strong> on 3 May 2008, 21:20)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p70812">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">anfin</div>
					<div class="post-datetime">
						12 Jul 2008, 15:47					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for the info on this thread - I&#039;ve managed to get airodump-ng working and capturing packets to a remotely mounted filesystem.</p><p>However I&#039;m having issues with airodump-ng wrongly identifying the type of encryption - it initially shows as &quot;WEP&quot; but changes to &quot;WPA2&quot; after a while even though I know the network is WEP.</p><p>I&#039;ve found something <a href="http://www.aircrack-ng.org/doku.php?id=airodump-ng#airodump-ng_keeps_switching_between_wep_and_wpa">here</a> that mentions a similar problem: -</p><div class="quotebox"><blockquote><p>Airodump-ng keeps switching between WEP and WPA</p><p>This is happening because your driver doesn&#039;t discard corrupted packets (that have an invalid CRC). If it&#039;s a ipw2100 (Centrino b), it just can&#039;t be helped; go buy a better card. If it&#039;s a Prism2, try upgrading the firmware.</p></blockquote></div><p>Has anybody else had similar problems or maybe a solution?</p><p>(I am using Kamikaze on a WRT54GL) </p><p>Thanks.</p>											<p class="post-edited">(Last edited by <strong>anfin</strong> on 12 Jul 2008, 15:47)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>