<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> WAP54G and Kamikaze</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 23 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p64910">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">mic_p</div>
					<div class="post-datetime">
						10 Mar 2008, 20:31					</div>
				</div>
				<div class="post-content content">
					<p>Hi all. I have a WAP54G 3.1 and I&#039;m trying to install the last 7.09 version, but it simple &quot;doesn&#039;t work&quot;. It only reply to my &quot;ping&quot; but no other interaction (ssh, telnet, web, ...)<br />The whiterussian 0.9 work well, but Kamikaze no. The &quot;act&quot; led near the power one are power off (with the original firmware and with the whiterussian it switch on). The firmware, I think, it&#039;s the right one (brcm-2.4-squashfs).</p><p>How / what I have to do the for make it working?</p><p>Thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p64994">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">grunthos</div>
					<div class="post-datetime">
						12 Mar 2008, 11:03					</div>
				</div>
				<div class="post-content content">
					<p>I too find my self in a similar place. <br />I have another wrt linksys V3 running DDWRT.<br />I was fiddling about with different versions of firmware, installed tomato and then after reading around I saw some features that may have suited a project I was working on in the openwrt firmware. </p><p>Perhaps a little about my computer knowledge, CPM with a Z80. (so long ago, forgotten it mostly by now.. Then Amiga then Dos and various Windows to XP </p><p>I have reasonable network configuration abilities, hard setting ip addresses, gateways, etc. Can handle doc command prompts OK.</p><p>Have had a little fiddle with Ubuntu but do not know too much about Linux architecture.</p><p>I installed Kamikaze 7.09 without fully understanding what I was doing.</p><p>Much reading, trial and error enabled a ping to 192.168.1.1 but no web page. telnet 192.168.1.1 produces<br />&nbsp; <br /> === IMPORTANT ============================<br />&nbsp; Use &#039;passwd&#039; to set your login password<br />&nbsp; this will disable telnet and enable SSH<br /> ------------------------------------------</p><br /><p>BusyBox v1.4.2 (2007-09-29 09:36:14 CEST) Built-in shell (ash)<br />Enter &#039;help&#039; for a list of built-in commands.</p><p>&nbsp; _______&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;________&nbsp; &nbsp; &nbsp; &nbsp; __<br /> |&nbsp; &nbsp; &nbsp; &nbsp;|.-----.-----.-----.|&nbsp; |&nbsp; |&nbsp; |.----.|&nbsp; |_<br /> |&nbsp; &nbsp;-&nbsp; &nbsp;||&nbsp; _&nbsp; |&nbsp; -__|&nbsp; &nbsp; &nbsp;||&nbsp; |&nbsp; |&nbsp; ||&nbsp; &nbsp;_||&nbsp; &nbsp;_|<br /> |_______||&nbsp; &nbsp;__|_____|__|__||________||__|&nbsp; |____|<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |__| W I R E L E S S&nbsp; &nbsp;F R E E D O M<br /> KAMIKAZE (7.09) -----------------------------------<br />&nbsp; * 10 oz Vodka&nbsp; &nbsp; &nbsp; &nbsp;Shake well with ice and strain<br />&nbsp; * 10 oz Triple sec&nbsp; mixture into 10 shot glasses.<br />&nbsp; * 10 oz lime juice&nbsp; Salute!<br /> ---------------------------------------------------<br />root@(none):/#</p><br /><p>I did try passwd and then found I could no longer telnet. <br />Ping still worked OK. <br />Tried an SSH client and also TFTP</p><p>Manged to get it back to telnet state. <br />IPKG command</p><p>root@(none):/# ipkg update<br />ipkg: cannot create directory &#039;/usr/lib/ipkg/lists&#039;: Read-only file system<br />ipkg: cannot create directory &#039;/usr/lib/ipkg/lists&#039;: Read-only file system<br />ipkg: cannot create directory &#039;/usr/lib/ipkg/lists&#039;: Read-only file system<br />An error ocurred, return value: 22.<br />Collected errors:<br />ipkg_update_cmd: ERROR: failed to make directory /usr/lib/ipkg/lists: Read-only<br />file system<br />root@(none):/#</p><p>and then</p><p>root@(none):/# ipkg list<br />ipkg: cannot create directory &#039;/usr/lib/ipkg/lists&#039;: Read-only file system<br />ipkg: cannot create directory &#039;/usr/lib/ipkg/lists&#039;: Read-only file system<br />base-files-brcm47xx-2.6 - 10-9078 -<br />bridge - 1.0.6-1 -<br />busybox - 1.4.2-2 -<br />dnsmasq - 2.39-1 -<br />dropbear - 0.50-2 -<br />hotplug2 - 0.9+r102-2 -<br />iptables - 1.3.7-1 -<br />kernel - 2.6.22-brcm47xx-1 -<br />kmod-diag - 2+2.6.22-brcm47xx-1 -<br />kmod-madwifi - 2.6.22+r2568-20070710-brcm47xx-2 -<br />kmod-ppp - 2.6.22-brcm47xx-1 -<br />kmod-pppoe - 2.6.22-brcm47xx-1 -<br />kmod-switch - 2.6.22-brcm47xx-1 -<br />libgcc - 4.1.2-10 -<br />mtd - 5 -<br />ppp - 2.4.3-8 -<br />ppp-mod-pppoe - 2.4.3-8 -<br />uclibc - 0.9.28-10 -<br />udevtrigger - 106-1 -<br />wireless-tools - 29-1 -<br />Done.</p><br /><p>I have tried to TFTP origonal firmware.BIN but get timeouts. <br />I am now well sure I am in past my abilities and am unsure if I should try the passwwd and SSH options again as suggested by <a href="http://martybugs.net/wireless/openwrt/flash.cgi">http://martybugs.net/wireless/openwrt/flash.cgi</a></p><br /><p>Tried </p><p>mtd -r write openwrt-brcm-2.4-squashfs.trx linux</p><p>says it cant find the file<br />tried <br />mtd -r write c:/openwrt-brcm-2.4-squashfs.trx linux</p><p>As expected I need to get to the DOS files, not sure haow to address this.</p><p>Tried changing the password</p><p>root@(none):/# passwd<br />Changing password for root<br />New password:<br />Retype password:<br />passwd: cannot update password file /etc/passwd<br />root@(none):/# exit<br />Seems I am stuck</p>											<p class="post-edited">(Last edited by <strong>grunthos</strong> on 12 Mar 2008, 21:38)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p65120">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">turingtest</div>
					<div class="post-datetime">
						13 Mar 2008, 21:28					</div>
				</div>
				<div class="post-content content">
					<p>grunthos:&nbsp; The normal procedure for installing openwrt is as follows<br />1. Flash the appropriate firmware image to your router and wait for it to reboot.<br />2. Telnet into the router at 192.168.1.1 and use passwd to change password. This disables telnet access.<br />3. SSH into the router at 192.168.1.1 and configure it as required. </p><p>Use of telnet is disabled because it&#039;s an old, insecure protocol. You shouldn&#039;t need to re-enable it after flashing. If you&#039;re&nbsp; using windows I recommend <a href="http://www.chiark.greenend.org.uk/~sgtatham/putty">putty</a> as an SSH client. <br />I&#039;m really not sure why you&#039;re getting &quot;Read-only file system&quot; errors. Could you explain exactly how you &quot;Manged to get it back to telnet state&quot; are you running in failsafe mode or something?<br />The first thing I would try is power cycling the router and SSHing into it with putty.<br />If that doesn&#039;t work I would think the easiest thing would be to re-flash it with kamikaze either via command line or TFTP. <br />BTW: in order to flash a firmware image with &quot;mtd -r write firmware.trx linux&quot; you need to get the firmware onto the router first. You can do this using wget or scp, wget is probably easiest, e.g.<br /></p><div class="codebox"><pre><code>cd /tmp
wget http://downloads.openwrt.org/kamikaze/7.09/&lt;whatever image you need&gt; 
mtd -r write &lt;your image&#039;s filename&gt; linux</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p65127">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">grunthos</div>
					<div class="post-datetime">
						13 Mar 2008, 23:41					</div>
				</div>
				<div class="post-content content">
					<p>Wow what a pathway to functionality that was.. Thanks Turingtest... for the above. I did try that at least a dozen times but it simply did not work at the stage I was at. Until later. I got your message just as the router was booting into the GUI web page Webif<br />I will update this post later tonight as I am sure that a lot of what I did, although gleaned from pages like <br />-----------------------------------------------------------------------------------<br />&quot;2.12. How do I reflash / How do I revert back to my previous firmware?</p><p>Make sure you have set boot_wait=on. To verify this do:</p><p>nvram get boot_wait</p><p>should return on. You can set boot_wait=on to on by doing:</p><p>nvram set boot_wait=on<br />nvram commit</p><p>When this is done you can follow the OpenWrtDocs/Deinstalling page.</p><p>boot_wait indicates whether or not the boot loader (CFE) should wait for a tftp transfered firmware before it loads the firmware present on the ROM. To adjust the length of time the CFE waits for this TFTP transfer, use the sparsely known wait_time variable. In example:</p><p>nvram set wait_time=30<br />nvram commit</p><p>This would cause the boot_wait period to be 30 seconds, allowing plenty of time for TFTP transfer. The default varies between models and versions and seems to range between 1 and 3 seconds.&quot;<br />--------------------------------------------------------<br />although useful was somewhat confusing. eg. NVram did not exist, seems it has been deleted in favor of config files.</p><p>I did find a command string, something like /sbin/??? It was the first step to getting things going, it at least rescued the partition, from there I could at least telnet in under the &quot;safe/rescue mode and set the passwd. from there SSH with putty... Then came my long learning curve..</p><p>Will get to work now and update the rest later.....</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p65336">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">grunthos</div>
					<div class="post-datetime">
						18 Mar 2008, 18:19					</div>
				</div>
				<div class="post-content content">
					<p>A real fix for those dead brick routers.<br />Needless to say the pathway to getting things going was long and tedious. <br />I did reach the point where the router was performing well with kamakaze and webif web interface. <br />Thanks to the Xwrt guys. <br />The list of packages able to be easily installed was most impressive. I will be again installing Openwrt/webIF and exploring more.</p><p>Very impressive and powerfull stuff. Pick a feature/package that you need and add it!!!</p><br /><p>--------------------------------------------------------------------------<br />Once I had fiddled with it for a few days I decided to get it back to the more familiar DDwrt firmware. (I needed to do some survey work with it. The last thing you need is a new operating system that may not quite do what is needed.)</p><p>By this stage I was fluent in safe mode, telnet, ping, SSH/Putty MTD commands etc.<br />------------------------------------------------<br />I followed the instructions at <br /><a href="http://wiki.openwrt.org/Faq#head-1953fb5817d85ead5452ef5d9338d4599d465569">http://wiki.openwrt.org/Faq#head-1953fb … 599d465569</a></p><p>boot_wait did not seem to be an option available to me<br />----------------------------------------------------------------<br />and then the instructions at <br /><a href="http://wiki.openwrt.org/OpenWrtDocs/Deinstalling">http://wiki.openwrt.org/OpenWrtDocs/Deinstalling</a><br />--------------------------------------------------<br />comments like...<br />&quot;You need to convert the bin (eg. openwrt-wrt54g-squashfs.bin) file to a trx file before reflashing&quot; </p><p>WRONG! The openwrt-brcm-squashfs.trx is a generic trx file that will work on any supported broadcom platform. The openwrt-wrt54g-squashfs.bin is just &quot;bin header + openwrt-brcm-squashfs.trx&#039;, the bin header just contains the firmware version number and what models the firmware can be loaded on; the bin header is only used for verification before writing the trx data to the flash. The mtd utility writes the given file to flash without verifying it; use one of the openwrt-brcm-squashfs.trx when using mtd. Converting the openwrt-wrt54g-squashfs.bin file back to a trx is just plain ignorant. &quot;</p><p>were far from helpful and just plain rude, demonstrating an arrogant attitude that seems to demonstrate a wish to not only look down on others less knowledgable but a wish, for whatever reason, to keep them in a lesser place. </p><p>Whilst some people may know lots about linux and its operations, I do not profess to do so.&nbsp; I am more than happy to install it on a spare computer and learn. ( any one of three that sit under my desk ticking away at different projects.) I started out back in the early 1980&#039;s building my own z80 based computer, adding CPM operating system to it along with floppy disk drives, from there, many different computers and systems. I have now spent over 60 hours on a $70.00 router. For me it is the search for knowledge.. but so hard to extract here?<br />End of gripe.<br />------------------------------------------------------------<br />Refering to the Bin to TRx conversion, instructions stating that</p><p>1.2. Using the webif<br />Since White Russian RC4 you can use the webif to go back to the original firmware. The webif automatically recognizes a firmware image uploaded in BIN or TRX format and converts it accordingly. </p><p>Load the webif in your web browser and goto the System / Firmware upgrade page <br />make sure Erase the JFFS2 partition is checked <br />choose the BIN or TRX firmware file (downloaded before from the manufactures website onto your PC) <br />-----------------------------------------------------------------<br />This statement would seem to be inaccurate as the web based update with linksys.BIN stated errors in the trx file.</p><p>Back to the CLI/ Putty</p><p>Trimming the file with dd bs=32 skip=1 if=original.bin of=original.trx<br />and <br />mtd -e linux -r write original.trx linux resulted in a very unhappy router.</p><p>Over the weekend I wandered into the workshop and manufactured a Jtag buffer cable. This was soon ticking away under the desk, backing up all sections of the flash, but no amount of re writing, including a full dump from when the whole thing was working well. I extracted the data from another router, sadly different version, did not help....</p><p>Many hours searching the openwrt community resulted in little extra information.<br />---------------------------------------------</p><p>A few hours ago, wandering about the DDwrt community, with heaps of people responding to questions, I discovered the following.</p><p><a href="http://www.wlan-skynet.de/download/skynet_repairkit_1.5_setup.exe">http://www.wlan-skynet.de/download/skyn … _setup.exe</a></p><p>would seem to be the best thing since sliced bread....</p><p>Its all apps in one package. You need a Jtag cable, install the software, get the jtag talking, run the web update and key in your MAC address found on the sticker of the wrt router. Select the hardware version from the web updated code and it generates a new&nbsp; CFE.BIN, once that is installed with the command <br />tjtag -flash:cfe<br />reboot and use the supplied TFTP software to but any standard XXXXX.bin file back on and reboot. The standard web page is available with normal passwords etc. to enable normal configuration<br />I did glean from Openwrt, that the CFE had to have the mac address hard/soft coded. Thus the repair kit works oh so well.</p><p>I look forward to more semi destructive explorations.<br />What I did find was many people who have routers stuck/bricked and finding no answers. With any luck my postings will lead them to successful rescues.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>