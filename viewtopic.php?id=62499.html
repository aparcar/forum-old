<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> [BCM43602 wireless adapter issue] NEED HELP for x86 platform!</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 1 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p309822">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">huming2207</div>
					<div class="post-datetime">
						1 Feb 2016, 07:03					</div>
				</div>
				<div class="post-content content">
					<p>Hi everyone,</p><p>I&#039;ve just got a Broadcom BCM43602 PCIe wireless adapter for my computer and then I&#039;ve attached it to my PC. Now I installed VMware ESXi 6.0 on the PC and then created an virtual machine with offical OpenWrt 15.05 x86 generic image downloaded from openwrt&#039;s offical website. Everything works fine except this Broadcom wireless adapter, it seems doesn&#039;t work at all!</p><p><strong>The problem is, when I access LuCI interface, on the &quot;Wifi&quot; section, no matter how I&#039;ve tried to click the &quot;Enable&quot; or &quot;Disable&quot;, or tried to modify the settings in many different ways, it always shows me &quot;Wireless is disabled or not associated&quot;.</strong></p><p><strong><br />I&#039;ve also tried using some thrid-party broadcom firmware where I&#039;ve found on some Chinese online forums. </strong></p><p><strong>For example, currently I&#039;m using this one: <a href="https://drive.google.com/file/d/0BwIfEsuWu9wTNHhOeFFmazU1Mmc/view?usp=sharing">https://drive.google.com/file/d/0BwIfEs â€¦ sp=sharing</a></strong></p><p><strong>Also, if I use it to connect some other wireless APs as client mode, it seems working, so I think I may using the&nbsp; right driver or firmware. But why it cannot be enabled as AP mode? </strong></p><br /><br /><br /><p>So here is some logs:</p><p> --- dmesg log ---</p><div class="codebox"><pre><code>root@OpenWrt:~# dmesg | grep brcm
[    7.083953] usbcore: registered new interface driver brcmfmac
[    7.742523] brcmfmac 0000:03:00.0: irq 24 for MSI/MSI-X
[    7.743136] brcmfmac: brcmf_c_preinit_dcmds: Firmware version = wl0: Nov 10 2015 06:38:10 version 7.35.177.61 (r598657) FWID 01-ea662a8c
[    7.749924] brcmfmac: brcmf_cfg80211_reg_notifier: not a ISO3166 code</code></pre></div><p> --- Content in my /etc/config, I&#039;ve already modified something, doesn&#039;t work either ---</p><div class="codebox"><pre><code>root@OpenWrt:~# cat /etc/config/wireless

config wifi-device &#039;radio0&#039;
    option type &#039;mac80211&#039;
    option path &#039;pci0000:00/0000:00:15.0/0000:03:00.0&#039;
    option macaddr &#039;ac:bc:32:7e:c9:c5&#039;
    option device &#039;wl0&#039;
    option hwmode &#039;11a&#039;
    option channel &#039;36&#039;
    option htmode &#039;VHT80&#039;
    option txpower &#039;20&#039;
    option country &#039;00&#039;

config wifi-iface
    option device &#039;radio0&#039;
    option mode &#039;ap&#039;
    option ssid &#039;OpenWrt&#039;
    option encryption &#039;none&#039;
    option network &#039;lan&#039;</code></pre></div><div class="codebox"><pre><code>root@OpenWrt:~# cat /etc/config/network

config interface &#039;loopback&#039;
    option ifname &#039;lo&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;127.0.0.1&#039;
    option netmask &#039;255.0.0.0&#039;

config interface &#039;lan&#039;
    option ifname &#039;eth1&#039;
    option type &#039;bridge&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;192.168.55.10&#039;
    option netmask &#039;255.255.255.0&#039;
        option gateway &#039;192.168.55.1&#039;

config interface &#039;wan&#039;
    option ifname &#039;eth0&#039;
    option proto &#039;dhcp&#039;</code></pre></div><br /><p>&nbsp; --- Here is &quot;lspci&quot;&nbsp; information ---</p><div class="codebox"><pre><code>root@OpenWrt:~# lspci
00:00.0 Host bridge: Intel Corporation 440BX/ZX/DX - 82443BX/ZX/DX Host bridge (rev 01)
00:01.0 PCI bridge: Intel Corporation 440BX/ZX/DX - 82443BX/ZX/DX AGP bridge (rev 01)
00:07.0 ISA bridge: Intel Corporation 82371AB/EB/MB PIIX4 ISA (rev 08)
00:07.1 IDE interface: Intel Corporation 82371AB/EB/MB PIIX4 IDE (rev 01)
00:07.3 Bridge: Intel Corporation 82371AB/EB/MB PIIX4 ACPI (rev 08)
00:07.7 System peripheral: VMware Virtual Machine Communication Interface (rev 10)
00:0f.0 VGA compatible controller: VMware SVGA II Adapter
00:11.0 PCI bridge: VMware PCI bridge (rev 02)
00:15.0 PCI bridge: VMware PCI Express Root Port (rev 01)
00:15.1 PCI bridge: VMware PCI Express Root Port (rev 01)
00:15.2 PCI bridge: VMware PCI Express Root Port (rev 01)
00:15.3 PCI bridge: VMware PCI Express Root Port (rev 01)
00:15.4 PCI bridge: VMware PCI Express Root Port (rev 01)
00:15.5 PCI bridge: VMware PCI Express Root Port (rev 01)
00:15.6 PCI bridge: VMware PCI Express Root Port (rev 01)
00:15.7 PCI bridge: VMware PCI Express Root Port (rev 01)
00:16.0 PCI bridge: VMware PCI Express Root Port (rev 01)
00:16.1 PCI bridge: VMware PCI Express Root Port (rev 01)
00:16.2 PCI bridge: VMware PCI Express Root Port (rev 01)
00:16.3 PCI bridge: VMware PCI Express Root Port (rev 01)
00:16.4 PCI bridge: VMware PCI Express Root Port (rev 01)
00:16.5 PCI bridge: VMware PCI Express Root Port (rev 01)
00:16.6 PCI bridge: VMware PCI Express Root Port (rev 01)
00:16.7 PCI bridge: VMware PCI Express Root Port (rev 01)
00:17.0 PCI bridge: VMware PCI Express Root Port (rev 01)
00:17.1 PCI bridge: VMware PCI Express Root Port (rev 01)
00:17.2 PCI bridge: VMware PCI Express Root Port (rev 01)
00:17.3 PCI bridge: VMware PCI Express Root Port (rev 01)
00:17.4 PCI bridge: VMware PCI Express Root Port (rev 01)
00:17.5 PCI bridge: VMware PCI Express Root Port (rev 01)
00:17.6 PCI bridge: VMware PCI Express Root Port (rev 01)
00:17.7 PCI bridge: VMware PCI Express Root Port (rev 01)
00:18.0 PCI bridge: VMware PCI Express Root Port (rev 01)
00:18.1 PCI bridge: VMware PCI Express Root Port (rev 01)
00:18.2 PCI bridge: VMware PCI Express Root Port (rev 01)
00:18.3 PCI bridge: VMware PCI Express Root Port (rev 01)
00:18.4 PCI bridge: VMware PCI Express Root Port (rev 01)
00:18.5 PCI bridge: VMware PCI Express Root Port (rev 01)
00:18.6 PCI bridge: VMware PCI Express Root Port (rev 01)
00:18.7 PCI bridge: VMware PCI Express Root Port (rev 01)
02:00.0 Ethernet controller: Intel Corporation 82545EM Gigabit Ethernet Controller (Copper) (rev 01)
02:01.0 Ethernet controller: Intel Corporation 82545EM Gigabit Ethernet Controller (Copper) (rev 01)
03:00.0 Network controller: Broadcom Corporation BCM43602 802.11ac Wireless LAN SoC (rev 01)</code></pre></div><p>Anyone has any idea or solution for solving this problem? Please help! Great thanks!</p><p>Regards,<br />Jackson</p>											<p class="post-edited">(Last edited by <strong>huming2207</strong> on 1 Feb 2016, 07:09)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p309830">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Lars Melin</div>
					<div class="post-datetime">
						1 Feb 2016, 09:46					</div>
				</div>
				<div class="post-content content">
					<p>The std driver you get with the card is a client (sta) driver, what you need is an ap driver or a combined driver (ap_sta) but they are only available from Broadcom on a NDA.<br />OpenWRT has a 3rd party, independent from Broadcom, developed driver but I don&#039;t think it will work with such a recent wifi chip as BCM43602.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p309841">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">meuleman</div>
					<div class="post-datetime">
						1 Feb 2016, 11:59					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Lars Melin wrote:</cite><blockquote><p>The std driver you get with the card is a client (sta) driver, what you need is an ap driver or a combined driver (ap_sta) but they are only available from Broadcom on a NDA.<br />OpenWRT has a 3rd party, independent from Broadcom, developed driver but I don&#039;t think it will work with such a recent wifi chip as BCM43602.</p></blockquote></div><p>That is all not true. <br />The 43602 is fullmac device and it is fully supported by mainline kernel driver brcmfmac which is maintained by broadcom. You will need firmware. The firmware you use (from the archive) appears to be ok, but the nvram isn&#039;t. I would not use that txt file unless you know for 100% sure that it belongs to the device you have. And I&#039;m not talking about it being a 43602. The nvram file is board specific and differs per manufacturer, that is why it is not being published. The 43602 firmware can be found in the linux firmware repository. The repository does have two firwmares. One for AP and one for STA. Though the sta version will also work in AP mode, but not as optimized. Vice versa is also true, the AP version will work in STA mode, but has limited features in that case. So you can choose whatever you prefer. <br />Openwrt uses the 43602 through the r8000 and it has been tested and verified working. There is still some work in progress to get it better, but getting the 43602 to work with OpenWrt should definately be possible. <br />So start of with firmware from the linux firmware repository and dont use a nvram file initially. Then get the module loaded with debug enabled. It means that you have to enabled debugging in the openwrt config and you&#039;ll somehow have to get the brcmfmac loaded with &quot;debug=0x1fffff&quot; or modify the brcmfmac source code to have this debug setting as default. Do note; openwrt uses backports. This means that it will use the brcmfmac from the backport and not the one which is default in the kernel. </p><p>What I do not know is if the image you use has brcmfmac enabled/built in. My guess is that it hasn&#039;t. So you&#039;ll have to download the source and build your own image (after having it configured for brcmfmac support).</p><p>Where did your 43602 come from? Perhaps if you tell me the source I can tell whether you&#039;ll need a nvram file or not.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p309844">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Zajec</div>
					<div class="post-datetime">
						1 Feb 2016, 12:38					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>huming2207 wrote:</cite><blockquote><p>The problem is, when I access LuCI interface, on the &quot;Wifi&quot; section, no matter how I&#039;ve tried to click the &quot;Enable&quot; or &quot;Disable&quot;, or tried to modify the settings in many different ways, it always shows me &quot;Wireless is disabled or not associated&quot;.</p></blockquote></div><p>Try configuring interface without LuCI for now.</p><div class="quotebox"><cite>huming2207 wrote:</cite><blockquote><div class="codebox"><pre><code>root@OpenWrt:~# dmesg | grep brcm
[    7.083953] usbcore: registered new interface driver brcmfmac
[    7.742523] brcmfmac 0000:03:00.0: irq 24 for MSI/MSI-X
[    7.743136] brcmfmac: brcmf_c_preinit_dcmds: Firmware version = wl0: Nov 10 2015 06:38:10 version 7.35.177.61 (r598657) FWID 01-ea662a8c
[    7.749924] brcmfmac: brcmf_cfg80211_reg_notifier: not a ISO3166 code</code></pre></div></blockquote></div><p>So the device is working, firmware running.</p><div class="quotebox"><cite>huming2207 wrote:</cite><blockquote><p>config wifi-device &#039;radio0&#039;<br />&nbsp; &nbsp; option type &#039;mac80211&#039;<br />&nbsp; &nbsp; option path &#039;pci0000:00/0000:00:15.0/0000:03:00.0&#039;<br />&nbsp; &nbsp; option macaddr &#039;ac:bc:32:7e:c9:c5&#039;<br />&nbsp; &nbsp; option device &#039;wl0&#039;</p></blockquote></div><p>It shouldn&#039;t be &quot;wl0&quot; (you don&#039;t need &quot;device&quot; at all). Maybe better generate a new config file? Like</p><div class="codebox"><pre><code>rm /etc/config/wireless
wifi detect &gt; /etc/config/wireless</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p309850">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">huming2207</div>
					<div class="post-datetime">
						1 Feb 2016, 13:45					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>meuleman wrote:</cite><blockquote><div class="quotebox"><cite>Lars Melin wrote:</cite><blockquote><p>The std driver you get with the card is a client (sta) driver, what you need is an ap driver or a combined driver (ap_sta) but they are only available from Broadcom on a NDA.<br />OpenWRT has a 3rd party, independent from Broadcom, developed driver but I don&#039;t think it will work with such a recent wifi chip as BCM43602.</p></blockquote></div><p>That is all not true. <br />The 43602 is fullmac device and it is fully supported by mainline kernel driver brcmfmac which is maintained by broadcom. You will need firmware. The firmware you use (from the archive) appears to be ok, but the nvram isn&#039;t. I would not use that txt file unless you know for 100% sure that it belongs to the device you have. And I&#039;m not talking about it being a 43602. The nvram file is board specific and differs per manufacturer, that is why it is not being published. The 43602 firmware can be found in the linux firmware repository. The repository does have two firwmares. One for AP and one for STA. Though the sta version will also work in AP mode, but not as optimized. Vice versa is also true, the AP version will work in STA mode, but has limited features in that case. So you can choose whatever you prefer. <br />Openwrt uses the 43602 through the r8000 and it has been tested and verified working. There is still some work in progress to get it better, but getting the 43602 to work with OpenWrt should definately be possible. <br />So start of with firmware from the linux firmware repository and dont use a nvram file initially. Then get the module loaded with debug enabled. It means that you have to enabled debugging in the openwrt config and you&#039;ll somehow have to get the brcmfmac loaded with &quot;debug=0x1fffff&quot; or modify the brcmfmac source code to have this debug setting as default. Do note; openwrt uses backports. This means that it will use the brcmfmac from the backport and not the one which is default in the kernel. </p><p>What I do not know is if the image you use has brcmfmac enabled/built in. My guess is that it hasn&#039;t. So you&#039;ll have to download the source and build your own image (after having it configured for brcmfmac support).</p><p>Where did your 43602 come from? Perhaps if you tell me the source I can tell whether you&#039;ll need a nvram file or not.</p></blockquote></div><p>I&#039;ve bought from Taobao.com (the Chinese one, &quot;full&quot; version of AliExpress), which is Apple OEM card, used in Macbook Pro. The actual name is BCM946302CS.</p><p>Also the &quot;third-party&quot; broadcom firmware which I&#039;m using right now has a text file (maybe this is the NVRAM configuration file you&#039;ve mentioned??), named &quot;brcmfmac43602-pcie.txt&quot;, the content is:</p><div class="codebox"><pre><code># NV VER: 0.2.3.0.XV1
# 20130829 Change Note:
# Enable Out of band GPIO for connected standby
# 20130809 Change Note:
# REMOVE 2x2 BTC effect BIT
# Change CCODE to XV/1
# 20130816 Change Note:
# Change PA parameters for TSSI 
# 20130830 Change Note:
# Change Power-per-rate settings
# 20130903 Change Note:
# Change Power-per-rate settings
devid=0x4374
boardtype=0x5f0
boardrev=0x1200
boardflags=0x201
#boardflags2=0x00800000
macaddr=A4:5E:60:DE:51:D9
sromrev=9
xtalfreq=37400
nocrc=1
ag0=0x2
ag1=0x2
ag2=0xff
ag3=0xff
txchain=0x1
rxchain=0x1
aa2g=1
aa5g=1
ccode=XV
regrev=1
ledbh0=0xff
ledbh1=0xff
ledbh2=0xff
ledbh3=0xff
leddc=0xffff
pa2gw0a0=0xFFC5
pa2gw1a0=0x1597
pa2gw2a0=0xFED8
pa2gw0a1=0xFFC9
pa2gw1a1=0x15B5
pa2gw2a1=0xFED4
maxp2ga0=64
maxp2ga1=64
maxp5ga0=50
maxp5ga1=50
maxp5gha0=50
maxp5gha1=50
maxp5gla0=64
maxp5gla1=72
pa0itssit=62
pa1itssit=62
antswctl2g=0x9
antswctl5g=0xa
antswitch=0x0
subband5gver=0
pa5gw0a0=0xFFBB
pa5gw1a0=0x120C
pa5gw2a0=0xFEF2
pa5gw0a1=0xFFCA
pa5gw1a1=0x1332
pa5gw2a1=0xFEF9
pa5glw0a0=0xFFC6
pa5glw1a0=0x11e4
pa5glw2a0=0xFF01
pa5glw0a1=0xFFCB
pa5glw1a1=0x135D
pa5glw2a1=0xFEF6
pa5ghw0a0=0xFFC1
pa5ghw1a0=0x1253
pa5ghw2a0=0xFEF9
pa5ghw0a1=0xFFCE
pa5ghw1a1=0x1356
pa5ghw2a1=0xFEF5
extpagain2g=2
extpagain5g=2
pdetrange2g=2
pdetrange5g=2
triso2g=4
triso5g=5
tssipos2g=1
tssipos5g=1
cckbw202gpo=0x0000
cckbw20ul2gpo=0x0000
legofdmbw202gpo=0x77777777
legofdmbw20ul2gpo=0x77777777
mcsbw202gpo=0xBBBBBBBB
mcsbw20ul2gpo=0xBBBBBBBB
mcsbw402gpo=0xBBBBBBBB
mcs32po=0x5555
leg40dup2gpo=0x2
legofdmbw205glpo=0x44332200
legofdmbw20ul5glpo=0x44332200
legofdmbw205gmpo=0x00000000
legofdmbw20ul5gmpo=0x00000000
legofdmbw205ghpo=0x00000000
legofdmbw20ul5ghpo=0x00000000
mcsbw205glpo=0x66442200
mcsbw20ul5glpo=0x66442200
mcsbw405glpo=0xaa887766
mcsbw205gmpo=0x11110000
mcsbw20ul5gmpo=0x11110000
mcsbw405gmpo=0x33221100
mcsbw205ghpo=0x11110000
mcsbw20ul5ghpo=0x11110000
mcsbw405ghpo=0x33221100
itt2ga0=0x20
itt5ga0=0x3e
itt2ga1=0x20
itt5ga1=0x3e
tempthresh=120
otpimagesize=232
usbepnum=0x2
muxenab=0x0
noisecaloffset=14
noisecaloffset5g=14
rssicorrnorm_core0=0x2004
rssicorrnorm_core1=0x2004
rssicorrnorm_core0_5g1=0x2203
rssicorrnorm_core0_5g2=0x1f03
rssicorrnorm_core0_5g3=0x1903
rssicorrnorm_core1_5g1=0x2a03
rssicorrnorm_core1_5g2=0x2303
rssicorrnorm_core1_5g3=0x1d03
triso5g_l_c0=5
triso5g_l_c1=5
triso5g_m_c0=5
triso5g_m_c1=5
triso5g_h_c0=5
triso5g_h_c1=5
pa2gw0a0_lo=0xFFFA
pa2gw1a0_lo=0x0766
pa2gw2a0_lo=0xFF7B
pa2gw0a1_lo=0xFFEE
pa2gw1a1_lo=0x07AD
pa2gw2a1_lo=0xFF6E
pa5gw0a0_lo=0xFFF0
pa5gw1a0_lo=0x08D0
pa5gw2a0_lo=0xFF5C
pa5gw0a1_lo=0xFFD4
pa5gw1a1_lo=0x09B0
pa5gw2a1_lo=0xFF3F
pa5glw0a0_lo=0xFFE1
pa5glw1a0_lo=0x0934
pa5glw2a0_lo=0xFF4A
pa5glw0a1_lo=0xFFEA
pa5glw1a1_lo=0x09AD
pa5glw2a1_lo=0xFF4E
pa5ghw0a0_lo=0xFFDD
pa5ghw1a0_lo=0x08DD
pa5ghw2a0_lo=0xFF4D
pa5ghw0a1_lo=0xFFDE
pa5ghw1a1_lo=0x09D1
pa5ghw2a1_lo=0xFF46

# Out-of-band GPIO wakeup
sd_gpout=0
sd_gpval=1
sd_gpdc=0</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p309851">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">huming2207</div>
					<div class="post-datetime">
						1 Feb 2016, 13:56					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>meuleman wrote:</cite><blockquote><div class="quotebox"><cite>Lars Melin wrote:</cite><blockquote><p>The std driver you get with the card is a client (sta) driver, what you need is an ap driver or a combined driver (ap_sta) but they are only available from Broadcom on a NDA.<br />OpenWRT has a 3rd party, independent from Broadcom, developed driver but I don&#039;t think it will work with such a recent wifi chip as BCM43602.</p></blockquote></div><p>That is all not true. <br />The 43602 is fullmac device and it is fully supported by mainline kernel driver brcmfmac which is maintained by broadcom. You will need firmware. The firmware you use (from the archive) appears to be ok, but the nvram isn&#039;t. I would not use that txt file unless you know for 100% sure that it belongs to the device you have. And I&#039;m not talking about it being a 43602. The nvram file is board specific and differs per manufacturer, that is why it is not being published. The 43602 firmware can be found in the linux firmware repository. The repository does have two firwmares. One for AP and one for STA. Though the sta version will also work in AP mode, but not as optimized. Vice versa is also true, the AP version will work in STA mode, but has limited features in that case. So you can choose whatever you prefer. <br />Openwrt uses the 43602 through the r8000 and it has been tested and verified working. There is still some work in progress to get it better, but getting the 43602 to work with OpenWrt should definately be possible. <br />So start of with firmware from the linux firmware repository and dont use a nvram file initially. Then get the module loaded with debug enabled. It means that you have to enabled debugging in the openwrt config and you&#039;ll somehow have to get the brcmfmac loaded with &quot;debug=0x1fffff&quot; or modify the brcmfmac source code to have this debug setting as default. Do note; openwrt uses backports. This means that it will use the brcmfmac from the backport and not the one which is default in the kernel. </p><p>What I do not know is if the image you use has brcmfmac enabled/built in. My guess is that it hasn&#039;t. So you&#039;ll have to download the source and build your own image (after having it configured for brcmfmac support).</p><p>Where did your 43602 come from? Perhaps if you tell me the source I can tell whether you&#039;ll need a nvram file or not.</p></blockquote></div><p>Here is a photo I&#039;ve taken for my wireless adapter: <a href="https://drive.google.com/file/d/0BwIfEsuWu9wTeGNzQUxEaTllU2s/view?usp=sharing">https://drive.google.com/file/d/0BwIfEs â€¦ sp=sharing</a></p><p>BTW I&#039;ve changed &quot;device ID&quot; and MAC address in the text configuration file, but it still doesn&#039;t work. Here is the modified version which is running in my computer:</p><div class="codebox"><pre><code># NV VER: 0.2.3.0.XV1
# 20130829 Change Note:
# Enable Out of band GPIO for connected standby
# 20130809 Change Note:
# REMOVE 2x2 BTC effect BIT
# Change CCODE to XV/1
# 20130816 Change Note:
# Change PA parameters for TSSI 
# 20130830 Change Note:
# Change Power-per-rate settings
# 20130903 Change Note:
# Change Power-per-rate settings
devid=0x43ba
boardtype=0x5f0
boardrev=0x1200
boardflags=0x201
#boardflags2=0x00800000
macaddr=AC:BC:32:7E:C9:C5
sromrev=9
xtalfreq=37400
nocrc=1
ag0=0x2
ag1=0x2
ag2=0xff
ag3=0xff
txchain=0x1
rxchain=0x1
aa2g=1
aa5g=1
ccode=XV
regrev=1
ledbh0=0xff
ledbh1=0xff
ledbh2=0xff
ledbh3=0xff
leddc=0xffff
pa2gw0a0=0xFFC5
pa2gw1a0=0x1597
pa2gw2a0=0xFED8
pa2gw0a1=0xFFC9
pa2gw1a1=0x15B5
pa2gw2a1=0xFED4
maxp2ga0=64
maxp2ga1=64
maxp5ga0=50
maxp5ga1=50
maxp5gha0=50
maxp5gha1=50
maxp5gla0=64
maxp5gla1=72
pa0itssit=62
pa1itssit=62
antswctl2g=0x9
antswctl5g=0xa
antswitch=0x0
subband5gver=0
pa5gw0a0=0xFFBB
pa5gw1a0=0x120C
pa5gw2a0=0xFEF2
pa5gw0a1=0xFFCA
pa5gw1a1=0x1332
pa5gw2a1=0xFEF9
pa5glw0a0=0xFFC6
pa5glw1a0=0x11e4
pa5glw2a0=0xFF01
pa5glw0a1=0xFFCB
pa5glw1a1=0x135D
pa5glw2a1=0xFEF6
pa5ghw0a0=0xFFC1
pa5ghw1a0=0x1253
pa5ghw2a0=0xFEF9
pa5ghw0a1=0xFFCE
pa5ghw1a1=0x1356
pa5ghw2a1=0xFEF5
extpagain2g=2
extpagain5g=2
pdetrange2g=2
pdetrange5g=2
triso2g=4
triso5g=5
tssipos2g=1
tssipos5g=1
cckbw202gpo=0x0000
cckbw20ul2gpo=0x0000
legofdmbw202gpo=0x77777777
legofdmbw20ul2gpo=0x77777777
mcsbw202gpo=0xBBBBBBBB
mcsbw20ul2gpo=0xBBBBBBBB
mcsbw402gpo=0xBBBBBBBB
mcs32po=0x5555
leg40dup2gpo=0x2
legofdmbw205glpo=0x44332200
legofdmbw20ul5glpo=0x44332200
legofdmbw205gmpo=0x00000000
legofdmbw20ul5gmpo=0x00000000
legofdmbw205ghpo=0x00000000
legofdmbw20ul5ghpo=0x00000000
mcsbw205glpo=0x66442200
mcsbw20ul5glpo=0x66442200
mcsbw405glpo=0xaa887766
mcsbw205gmpo=0x11110000
mcsbw20ul5gmpo=0x11110000
mcsbw405gmpo=0x33221100
mcsbw205ghpo=0x11110000
mcsbw20ul5ghpo=0x11110000
mcsbw405ghpo=0x33221100
itt2ga0=0x20
itt5ga0=0x3e
itt2ga1=0x20
itt5ga1=0x3e
tempthresh=120
otpimagesize=232
usbepnum=0x2
muxenab=0x0
noisecaloffset=14
noisecaloffset5g=14
rssicorrnorm_core0=0x2004
rssicorrnorm_core1=0x2004
rssicorrnorm_core0_5g1=0x2203
rssicorrnorm_core0_5g2=0x1f03
rssicorrnorm_core0_5g3=0x1903
rssicorrnorm_core1_5g1=0x2a03
rssicorrnorm_core1_5g2=0x2303
rssicorrnorm_core1_5g3=0x1d03
triso5g_l_c0=5
triso5g_l_c1=5
triso5g_m_c0=5
triso5g_m_c1=5
triso5g_h_c0=5
triso5g_h_c1=5
pa2gw0a0_lo=0xFFFA
pa2gw1a0_lo=0x0766
pa2gw2a0_lo=0xFF7B
pa2gw0a1_lo=0xFFEE
pa2gw1a1_lo=0x07AD
pa2gw2a1_lo=0xFF6E
pa5gw0a0_lo=0xFFF0
pa5gw1a0_lo=0x08D0
pa5gw2a0_lo=0xFF5C
pa5gw0a1_lo=0xFFD4
pa5gw1a1_lo=0x09B0
pa5gw2a1_lo=0xFF3F
pa5glw0a0_lo=0xFFE1
pa5glw1a0_lo=0x0934
pa5glw2a0_lo=0xFF4A
pa5glw0a1_lo=0xFFEA
pa5glw1a1_lo=0x09AD
pa5glw2a1_lo=0xFF4E
pa5ghw0a0_lo=0xFFDD
pa5ghw1a0_lo=0x08DD
pa5ghw2a0_lo=0xFF4D
pa5ghw0a1_lo=0xFFDE
pa5ghw1a1_lo=0x09D1
pa5ghw2a1_lo=0xFF46

# Out-of-band GPIO wakeup
sd_gpout=0
sd_gpval=1
sd_gpdc=0</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p309852">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">huming2207</div>
					<div class="post-datetime">
						1 Feb 2016, 14:00					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Zajec wrote:</cite><blockquote><div class="quotebox"><cite>huming2207 wrote:</cite><blockquote><p>The problem is, when I access LuCI interface, on the &quot;Wifi&quot; section, no matter how I&#039;ve tried to click the &quot;Enable&quot; or &quot;Disable&quot;, or tried to modify the settings in many different ways, it always shows me &quot;Wireless is disabled or not associated&quot;.</p></blockquote></div><p>Try configuring interface without LuCI for now.</p><div class="quotebox"><cite>huming2207 wrote:</cite><blockquote><div class="codebox"><pre><code>root@OpenWrt:~# dmesg | grep brcm
[    7.083953] usbcore: registered new interface driver brcmfmac
[    7.742523] brcmfmac 0000:03:00.0: irq 24 for MSI/MSI-X
[    7.743136] brcmfmac: brcmf_c_preinit_dcmds: Firmware version = wl0: Nov 10 2015 06:38:10 version 7.35.177.61 (r598657) FWID 01-ea662a8c
[    7.749924] brcmfmac: brcmf_cfg80211_reg_notifier: not a ISO3166 code</code></pre></div></blockquote></div><p>So the device is working, firmware running.</p><div class="quotebox"><cite>huming2207 wrote:</cite><blockquote><p>config wifi-device &#039;radio0&#039;<br />&nbsp; &nbsp; option type &#039;mac80211&#039;<br />&nbsp; &nbsp; option path &#039;pci0000:00/0000:00:15.0/0000:03:00.0&#039;<br />&nbsp; &nbsp; option macaddr &#039;ac:bc:32:7e:c9:c5&#039;<br />&nbsp; &nbsp; option device &#039;wl0&#039;</p></blockquote></div><p>It shouldn&#039;t be &quot;wl0&quot; (you don&#039;t need &quot;device&quot; at all). Maybe better generate a new config file? Like</p><div class="codebox"><pre><code>rm /etc/config/wireless
wifi detect &gt; /etc/config/wireless</code></pre></div></blockquote></div><br /><p>Thanks, I&#039;ve already tried to re-generate the wireless config file but it still doesn&#039;t work. I&#039;m modifying the wireless config file manually and it has the same result, doesn&#039;t work.</p>											<p class="post-edited">(Last edited by <strong>huming2207</strong> on 1 Feb 2016, 14:04)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p309864">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">huming2207</div>
					<div class="post-datetime">
						1 Feb 2016, 16:15					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Zajec wrote:</cite><blockquote><div class="quotebox"><cite>huming2207 wrote:</cite><blockquote><p>The problem is, when I access LuCI interface, on the &quot;Wifi&quot; section, no matter how I&#039;ve tried to click the &quot;Enable&quot; or &quot;Disable&quot;, or tried to modify the settings in many different ways, it always shows me &quot;Wireless is disabled or not associated&quot;.</p></blockquote></div><p>Try configuring interface without LuCI for now.</p><div class="quotebox"><cite>huming2207 wrote:</cite><blockquote><div class="codebox"><pre><code>root@OpenWrt:~# dmesg | grep brcm
[    7.083953] usbcore: registered new interface driver brcmfmac
[    7.742523] brcmfmac 0000:03:00.0: irq 24 for MSI/MSI-X
[    7.743136] brcmfmac: brcmf_c_preinit_dcmds: Firmware version = wl0: Nov 10 2015 06:38:10 version 7.35.177.61 (r598657) FWID 01-ea662a8c
[    7.749924] brcmfmac: brcmf_cfg80211_reg_notifier: not a ISO3166 code</code></pre></div></blockquote></div><p>So the device is working, firmware running.</p><div class="quotebox"><cite>huming2207 wrote:</cite><blockquote><p>config wifi-device &#039;radio0&#039;<br />&nbsp; &nbsp; option type &#039;mac80211&#039;<br />&nbsp; &nbsp; option path &#039;pci0000:00/0000:00:15.0/0000:03:00.0&#039;<br />&nbsp; &nbsp; option macaddr &#039;ac:bc:32:7e:c9:c5&#039;<br />&nbsp; &nbsp; option device &#039;wl0&#039;</p></blockquote></div><p>It shouldn&#039;t be &quot;wl0&quot; (you don&#039;t need &quot;device&quot; at all). Maybe better generate a new config file? Like</p><div class="codebox"><pre><code>rm /etc/config/wireless
wifi detect &gt; /etc/config/wireless</code></pre></div></blockquote></div><p>BTW, after the reset procedure, the wireless configuration file is:<br /></p><div class="codebox"><pre><code>root@OpenWrt:/tmp# cat /etc/config/wireless
config wifi-device  radio0
    option type     mac80211
    option channel  36
    option hwmode    11a
    option path    &#039;pci0000:00/0000:00:15.0/0000:03:00.0&#039;
    option htmode    VHT80
    # REMOVE THIS LINE TO ENABLE WIFI:
    option disabled 1

config wifi-iface
    option device   radio0
    option network  lan
    option mode     ap
    option ssid     OpenWrt
    option encryption none</code></pre></div><p>Then I returned to LuCI, it still doesn&#039;t work.</p>											<p class="post-edited">(Last edited by <strong>huming2207</strong> on 1 Feb 2016, 16:16)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p309894">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">Zajec</div>
					<div class="post-datetime">
						1 Feb 2016, 20:22					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>huming2207 wrote:</cite><blockquote><p>BTW, after the reset procedure, the wireless configuration file is:<br /></p><div class="codebox"><pre><code>root@OpenWrt:/tmp# cat /etc/config/wireless
config wifi-device  radio0
    option type     mac80211
    option channel  36
    option hwmode    11a
    option path    &#039;pci0000:00/0000:00:15.0/0000:03:00.0&#039;
    option htmode    VHT80
    # REMOVE THIS LINE TO ENABLE WIFI:
    option disabled 1

config wifi-iface
    option device   radio0
    option network  lan
    option mode     ap
    option ssid     OpenWrt
    option encryption none</code></pre></div><p>Then I returned to LuCI, it still doesn&#039;t work.</p></blockquote></div><p>Use this config, remove &quot;option disabled 1&quot; line, call &quot;/etc/init.d/network reload&quot;. After 5 seconds execute &quot;ifconfig&quot; and &quot;logread -l 100&quot;, provide output of both.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p309923">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">huming2207</div>
					<div class="post-datetime">
						2 Feb 2016, 00:53					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Zajec wrote:</cite><blockquote><p>Use this config, remove &quot;option disabled 1&quot; line, call &quot;/etc/init.d/network reload&quot;. After 5 seconds execute &quot;ifconfig&quot; and &quot;logread -l 100&quot;, provide output of both.</p></blockquote></div><p>This is the restart procedure:</p><div class="codebox"><pre><code>root@OpenWrt:~# vim /etc/config/wireless
root@OpenWrt:~# /etc/init.d/network reload
root@OpenWrt:~#  ifconfig
br-lan    Link encap:Ethernet  HWaddr 00:0C:29:0B:6C:B4
          inet addr:192.168.55.10  Bcast:192.168.55.255  Mask:255.255.255.0
          inet6 addr: fe80::20c:29ff:fe0b:6cb4/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:7 errors:0 dropped:7 overruns:0 frame:0
          TX packets:1355 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:2288 (2.2 KiB)  TX bytes:119470 (116.6 KiB)

eth0      Link encap:Ethernet  HWaddr 00:0C:29:0B:6C:AA
          inet addr:192.168.2.44  Bcast:192.168.2.255  Mask:255.255.255.0
          inet6 addr: fe80::20c:29ff:fe0b:6caa/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:3481 errors:0 dropped:0 overruns:0 frame:0
          TX packets:2314 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:1860899 (1.7 MiB)  TX bytes:222397 (217.1 KiB)

eth1      Link encap:Ethernet  HWaddr 00:0C:29:0B:6C:B4
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:597 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 B)  TX bytes:47732 (46.6 KiB)

lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:102 errors:0 dropped:0 overruns:0 frame:0
          TX packets:102 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:8106 (7.9 KiB)  TX bytes:8106 (7.9 KiB)

wlan0     Link encap:Ethernet  HWaddr AC:BC:32:7E:C9:C5
          inet6 addr: fe80::aebc:32ff:fe7e:c9c5/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:7 errors:0 dropped:0 overruns:0 frame:0
          TX packets:21 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:2288 (2.2 KiB)  TX bytes:2294 (2.2 KiB)</code></pre></div><br /><p>...and this is the log:</p><div class="codebox"><pre><code>Mon Feb  1 22:45:03 2016 authpriv.info dropbear[377]: Child connection from 192.168.2.64:51362
Mon Feb  1 22:45:06 2016 authpriv.notice dropbear[377]: Password auth succeeded for &#039;root&#039; from 192.168.2.64:51362
Mon Feb  1 22:46:20 2016 daemon.notice netifd: Network device &#039;wlan0&#039; link is down
Mon Feb  1 22:46:20 2016 daemon.notice netifd: radio0 (542): command failed: Operation not supported (-95)
Mon Feb  1 22:46:20 2016 daemon.notice netifd: radio0 (559): command failed: Operation not supported (-95)
Mon Feb  1 22:46:20 2016 daemon.notice netifd: radio0 (559): command failed: Operation not supported (-95)
Mon Feb  1 22:46:20 2016 daemon.notice netifd: radio0 (559): command failed: File exists (-17)
Mon Feb  1 22:46:20 2016 daemon.notice netifd: radio0 (559): Configuration file: /var/run/hostapd-phy0.conf
Mon Feb  1 22:46:20 2016 daemon.notice netifd: radio0 (559): Failed to create interface mon.wlan0: -95 (Operation not supported)
Mon Feb  1 22:46:20 2016 daemon.notice netifd: radio0 (559): wlan0: interface state UNINITIALIZED-&gt;HT_SCAN
Mon Feb  1 22:46:20 2016 kern.info kernel: [31664.129371] device wlan0 entered promiscuous mode
Mon Feb  1 22:46:20 2016 kern.info kernel: [31664.129477] br-lan: port 2(wlan0) entered forwarding state
Mon Feb  1 22:46:20 2016 kern.info kernel: [31664.129574] br-lan: port 2(wlan0) entered forwarding state
Mon Feb  1 22:46:20 2016 daemon.notice netifd: radio0 (559): Switch own primary and secondary channel to get secondary channel with no Beacons from other BSSes
Mon Feb  1 22:46:20 2016 daemon.notice netifd: radio0 (559): Could not set channel for kernel driver
Mon Feb  1 22:46:20 2016 daemon.notice netifd: radio0 (559): Interface initialization failed
Mon Feb  1 22:46:20 2016 daemon.notice netifd: radio0 (559): wlan0: interface state HT_SCAN-&gt;DISABLED
Mon Feb  1 22:46:20 2016 daemon.notice netifd: radio0 (559): wlan0: AP-DISABLED
Mon Feb  1 22:46:20 2016 daemon.notice netifd: radio0 (559): wlan0: interface state DISABLED-&gt;DISABLED
Mon Feb  1 22:46:20 2016 daemon.notice netifd: radio0 (559): wlan0: AP-DISABLED
Mon Feb  1 22:46:20 2016 daemon.notice netifd: radio0 (559): hostapd_free_hapd_data: Interface wlan0 wasn&#039;t started
Mon Feb  1 22:46:20 2016 daemon.notice netifd: radio0 (559): nl80211: deinit ifname=wlan0 disabled_11b_rates=0
Mon Feb  1 22:46:20 2016 kern.info kernel: [31664.260109] device wlan0 left promiscuous mode
Mon Feb  1 22:46:20 2016 kern.info kernel: [31664.260326] br-lan: port 2(wlan0) entered disabled state
Mon Feb  1 22:46:21 2016 daemon.notice netifd: radio0 (559): ELOOP: remaining socket: sock=16 eloop_data=0x88e4450 user_data=(nil) handler=0x806892f
Mon Feb  1 22:46:21 2016 daemon.notice netifd: radio0 (559): cat: can&#039;t open &#039;/var/run/wifi-phy0.pid&#039;: No such file or directory
Mon Feb  1 22:46:21 2016 daemon.notice netifd: radio0 (559): Command failed: Invalid argument
Mon Feb  1 22:46:21 2016 daemon.notice netifd: Network device &#039;wlan0&#039; link is up</code></pre></div><br /><p>So... I can find something like:</p><div class="codebox"><pre><code>Mon Feb  1 22:46:20 2016 daemon.notice netifd: radio0 (559): command failed: Operation not supported (-95)
Mon Feb  1 22:46:20 2016 daemon.notice netifd: radio0 (559): command failed: Operation not supported (-95)</code></pre></div><p>Does it means it has something wrong with the driver?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p309924">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">huming2207</div>
					<div class="post-datetime">
						2 Feb 2016, 00:56					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Zajec wrote:</cite><blockquote><p>Use this config, remove &quot;option disabled 1&quot; line, call &quot;/etc/init.d/network reload&quot;. After 5 seconds execute &quot;ifconfig&quot; and &quot;logread -l 100&quot;, provide output of both.</p></blockquote></div><p>BTW, I checked with iw, using command &quot;iw phy&quot;, and it has this output:</p><div class="codebox"><pre><code>    valid interface combinations:
         * #{ managed } &lt;= 1, #{ P2P-device } &lt;= 1, #{ P2P-client, P2P-GO } &lt;= 1,
           total &lt;= 3, #channels &lt;= 2
         * #{ managed } &lt;= 1, #{ AP } &lt;= 1, #{ P2P-client } &lt;= 1, #{ P2P-device } &lt;= 1,
           total &lt;= 4, #channels &lt;= 1
         * #{ AP } &lt;= 4,
           total &lt;= 4, #channels &lt;= 1, STA/AP BI must match</code></pre></div><br /><p>So the broadcom closed-source driver should support AP mode, but why it fails when I try to turn the AP mode on?</p>											<p class="post-edited">(Last edited by <strong>huming2207</strong> on 2 Feb 2016, 01:02)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p309926">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">Zajec</div>
					<div class="post-datetime">
						2 Feb 2016, 01:02					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>huming2207 wrote:</cite><blockquote><div class="codebox"><pre><code>Mon Feb  1 22:46:20 2016 daemon.notice netifd: radio0 (559): Could not set channel for kernel driver
Mon Feb  1 22:46:20 2016 daemon.notice netifd: radio0 (559): Interface initialization failed</code></pre></div></blockquote></div><p>Now you&#039;re talking. Try switching from VHT80 to VHT40 or maybe even VHT20.</p><div class="quotebox"><cite>huming2207 wrote:</cite><blockquote><div class="codebox"><pre><code>Mon Feb  1 22:46:20 2016 daemon.notice netifd: radio0 (559): command failed: Operation not supported (-95)
Mon Feb  1 22:46:20 2016 daemon.notice netifd: radio0 (559): command failed: Operation not supported (-95)</code></pre></div></blockquote></div><p>brcmfmac doesn&#039;t allow removing interfaces, OpenWrt can live with that.</p><div class="quotebox"><cite>huming2207 wrote:</cite><blockquote><p>So the broadcom closed-source driver should support AP mode, but why it fails when I try to turn the AP mode on?</p></blockquote></div><p>By calling brcmfmac a closed-soruce driver you&#039;re quite confusing.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p309927">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">huming2207</div>
					<div class="post-datetime">
						2 Feb 2016, 01:05					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Zajec wrote:</cite><blockquote><div class="quotebox"><cite>huming2207 wrote:</cite><blockquote><div class="codebox"><pre><code>Mon Feb  1 22:46:20 2016 daemon.notice netifd: radio0 (559): Could not set channel for kernel driver
Mon Feb  1 22:46:20 2016 daemon.notice netifd: radio0 (559): Interface initialization failed</code></pre></div></blockquote></div><p>Now you&#039;re talking. Try switching from VHT80 to VHT40 or maybe even VHT20.</p><div class="quotebox"><cite>huming2207 wrote:</cite><blockquote><div class="codebox"><pre><code>Mon Feb  1 22:46:20 2016 daemon.notice netifd: radio0 (559): command failed: Operation not supported (-95)
Mon Feb  1 22:46:20 2016 daemon.notice netifd: radio0 (559): command failed: Operation not supported (-95)</code></pre></div></blockquote></div><p>brcmfmac doesn&#039;t allow removing interfaces, OpenWrt can live with that.</p><div class="quotebox"><cite>huming2207 wrote:</cite><blockquote><p>So the broadcom closed-source driver should support AP mode, but why it fails when I try to turn the AP mode on?</p></blockquote></div><p>By calling brcmfmac a closed-soruce driver you&#039;re quite confusing.</p></blockquote></div><p>Yay! Right now when I set to VHT40, it seems working!<br />The SSID shows up immidiately!</p><p>But when I have a look at the log, it still has some error messages:</p><div class="codebox"><pre><code>Mon Feb  1 23:03:10 2016 daemon.notice netifd: Network device &#039;wlan0&#039; link is down
Mon Feb  1 23:03:10 2016 daemon.notice netifd: radio0 (2671): command failed: Operation not supported (-95)
Mon Feb  1 23:03:10 2016 daemon.notice netifd: radio0 (2687): command failed: Operation not supported (-95)
Mon Feb  1 23:03:10 2016 daemon.notice netifd: radio0 (2687): command failed: Operation not supported (-95)
Mon Feb  1 23:03:10 2016 daemon.notice netifd: radio0 (2687): command failed: File exists (-17)
Mon Feb  1 23:03:10 2016 daemon.notice netifd: radio0 (2687): Configuration file: /var/run/hostapd-phy0.conf
Mon Feb  1 23:03:10 2016 daemon.notice netifd: radio0 (2687): Failed to create interface mon.wlan0: -95 (Operation not supported)
Mon Feb  1 23:03:10 2016 daemon.notice netifd: radio0 (2687): wlan0: interface state UNINITIALIZED-&gt;HT_SCAN
Mon Feb  1 23:03:10 2016 kern.info kernel: [32673.832650] device wlan0 entered promiscuous mode
Mon Feb  1 23:03:10 2016 kern.info kernel: [32673.832754] br-lan: port 2(wlan0) entered forwarding state
Mon Feb  1 23:03:10 2016 kern.info kernel: [32673.832858] br-lan: port 2(wlan0) entered forwarding state
Mon Feb  1 23:03:10 2016 daemon.notice netifd: radio0 (2687): Switch own primary and secondary channel to get secondary channel with no Beacons from other BSSes
Mon Feb  1 23:03:10 2016 daemon.notice netifd: radio0 (2687): wlan0: Could not connect to kernel driver
Mon Feb  1 23:03:10 2016 daemon.notice netifd: radio0 (2687): Using interface wlan0 with hwaddr ac:bc:32:7e:c9:c5 and ssid &quot;OpenWrt&quot;
Mon Feb  1 23:03:10 2016 kern.err kernel: [32674.008248] brcmfmac: brcmf_add_if: ERROR: netdev:wlan0 already exists
Mon Feb  1 23:03:10 2016 kern.err kernel: [32674.008388] brcmfmac: brcmf_add_if: ignore IF event
Mon Feb  1 23:03:11 2016 daemon.notice netifd: radio0 (2687): wlan0: interface state HT_SCAN-&gt;ENABLED
Mon Feb  1 23:03:11 2016 daemon.notice netifd: radio0 (2687): wlan0: AP-ENABLED
Mon Feb  1 23:03:11 2016 daemon.notice netifd: Network device &#039;wlan0&#039; link is up</code></pre></div><p>So... should I care about those errors in the log?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p309936">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">huming2207</div>
					<div class="post-datetime">
						2 Feb 2016, 02:20					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Zajec wrote:</cite><blockquote><p>Use this config, remove &quot;option disabled 1&quot; line, call &quot;/etc/init.d/network reload&quot;. After 5 seconds execute &quot;ifconfig&quot; and &quot;logread -l 100&quot;, provide output of both.</p></blockquote></div><p>Also I would like to know... is it possible to let the adapter sends both 2.4GHZ and 5GHZ signal? I&#039;ve tried add one more network interface which was set to 2.4GHZ in the configuration file, but the adapter doesn&#039;t work again...</p><p>My configuration is:</p><div class="codebox"><pre><code>root@OpenWrt:~# cat /etc/config/wireless

config wifi-device &#039;radio0&#039;
    option type &#039;mac80211&#039;
    option path &#039;pci0000:00/0000:00:15.0/0000:03:00.0&#039;
    option hwmode &#039;11a&#039;
    option channel &#039;36&#039;
    option htmode &#039;VHT40&#039;
    option txpower &#039;20&#039;
    option country &#039;00&#039;

config wifi-iface
    option device &#039;radio0&#039;
    option network &#039;lan&#039;
    option mode &#039;ap&#039;
    option ssid &#039;OpenWrt&#039;
    option encryption &#039;none&#039;

config wifi-iface
    option device &#039;radio0&#039;
    option mode &#039;ap&#039;
    option ssid &#039;OpenWrt&#039;
    option encryption &#039;none&#039;</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p309970">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">meuleman</div>
					<div class="post-datetime">
						2 Feb 2016, 11:35					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>huming2207 wrote:</cite><blockquote><p>I&#039;ve bought from Taobao.com (the Chinese one, &quot;full&quot; version of AliExpress), which is Apple OEM card, used in Macbook Pro. The actual name is BCM946302CS.</p></blockquote></div><p>Yes that txt file is what I call a nvram file. And no, you should not use it. The apple card does not require an external nvram file. So only put the firmware (brcmfmac43602-pcie.bin) on your system. Do not put the nvram file on your system. That file is not for your device.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p309972">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">meuleman</div>
					<div class="post-datetime">
						2 Feb 2016, 11:42					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>huming2207 wrote:</cite><blockquote><p>Also I would like to know... is it possible to let the adapter sends both 2.4GHZ and 5GHZ signal? I&#039;ve tried add one more network interface which was set to 2.4GHZ in the configuration file, but the adapter doesn&#039;t work again...</p></blockquote></div><p>Yes and no. The device is not an RSDB device (Real Simultaneous Dual Band), but you can use 2.4G and 5G in &quot;parallel&quot; by time slicing using a feature called VSDB, but that has obviously limited possibilities. You can for example be a client in 2.4 and have a p2p go in the 5g. But you can for example not have an AP in 2.4g and sta in 5g. The reason is that sta can &quot;time-slicing&quot; using powersave, and p2p can also do that using dedicated methods, but AP can&#039;t. In that case you&#039;ll not transmit/receive at the same time in 2.4 and 5. but you will a short while on one frequency and then a short period on the other frequency.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p309979">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">Zajec</div>
					<div class="post-datetime">
						2 Feb 2016, 12:01					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>huming2207 wrote:</cite><blockquote><p>Yay! Right now when I set to VHT40, it seems working!<br />The SSID shows up immidiately!</p></blockquote></div><p>Kernel gets list of supported channels (and combinations) from a driver. It seems firmware told brcmfmac it doesn&#039;t support 80 MHz width. It can be related to the country setting from a NVRAM.</p><div class="quotebox"><cite>huming2207 wrote:</cite><blockquote><p>So... should I care about those errors in the log?</p></blockquote></div><p>No.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p309993">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">huming2207</div>
					<div class="post-datetime">
						2 Feb 2016, 14:46					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Zajec wrote:</cite><blockquote><div class="quotebox"><cite>huming2207 wrote:</cite><blockquote><p>Yay! Right now when I set to VHT40, it seems working!<br />The SSID shows up immidiately!</p></blockquote></div><p>Kernel gets list of supported channels (and combinations) from a driver. It seems firmware told brcmfmac it doesn&#039;t support 80 MHz width. It can be related to the country setting from a NVRAM.</p><div class="quotebox"><cite>huming2207 wrote:</cite><blockquote><p>So... should I care about those errors in the log?</p></blockquote></div><p>No.</p></blockquote></div><br /><p>Emm... I changed to US (America), CN (China) and AU (Austrlia), and it doesn&#039;t work.</p><div class="quotebox"><cite>meuleman wrote:</cite><blockquote><p>&nbsp; <br />Yes and no. The device is not an RSDB device (Real Simultaneous Dual Band), but you can use 2.4G and 5G in &quot;parallel&quot; by time slicing using a feature called VSDB, but that has obviously limited possibilities. You can for example be a client in 2.4 and have a p2p go in the 5g. But you can for example not have an AP in 2.4g and sta in 5g. The reason is that sta can &quot;time-slicing&quot; using powersave, and p2p can also do that using dedicated methods, but AP can&#039;t. In that case you&#039;ll not transmit/receive at the same time in 2.4 and 5. but you will a short while on one frequency and then a short period on the other frequency.</p></blockquote></div><p>Thanks. I&#039;ve found on OpenWrt-Wiki, does it means if I set the mode to &quot;p2p&quot; instead of &quot;ap&quot;, then it will &quot;automatically send&quot;&nbsp; 2.4GHZ and 5GHZ in VSDB feature as you mentioned?</p>											<p class="post-edited">(Last edited by <strong>huming2207</strong> on 2 Feb 2016, 14:46)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>