<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> compile just one file for OpenWRT</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 6 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p68283">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">thetruelighthouse</div>
					<div class="post-datetime">
						15 May 2008, 21:13					</div>
				</div>
				<div class="post-content content">
					<p>Hey Guys,</p><p>I want to compile just one C-File for my OpenWRT-Router.<br />I followed the instructions her: <a href="http://forum.openwrt.org/viewtopic.php?id=8410">http://forum.openwrt.org/viewtopic.php?id=8410</a></p><p>Now I have this build-environment. But what know?</p><p>What do I have to do to compile my single source File to get my small programm running on my OpenWRT-Router?</p><p>thanks for your advice.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p68285">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">thetruelighthouse</div>
					<div class="post-datetime">
						15 May 2008, 21:23					</div>
				</div>
				<div class="post-content content">
					<p>I found this:</p><p><a href="http://forum.openwrt.org/viewtopic.php?id=5669">http://forum.openwrt.org/viewtopic.php?id=5669</a></p><p>Am I able to use a commad like &quot;gcc -o mybinary mysource.c&quot; after setting the right Paths?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p68314">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">aoz.syn</div>
					<div class="post-datetime">
						16 May 2008, 17:07					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>thetruelighthouse wrote:</cite><blockquote><p>Am I able to use a commad like &quot;gcc -o mybinary mysource.c&quot; after setting the right Paths?</p></blockquote></div><p>You need a cross-compile environment, then yes - you should be able to roughly do that.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p68316">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">thetruelighthouse</div>
					<div class="post-datetime">
						16 May 2008, 18:22					</div>
				</div>
				<div class="post-content content">
					<p>Does not work so far...</p><p>I compiled the whole OpenWRT Package in &quot;/home/user/whiterussian/&quot;</p><p>Is set the paths like this:</p><div class="codebox"><pre><code>export PATH=/home/user/whiterussian/staging_dir_mipsel/usr/bin:/home/user/whiterussian/staging_dir_mipsel/bin:/bin:/sbin:/usr/bin:/usr/sbin


PREFIX=/home/user/whiterussian/staging_dir_mipsel/bin/

export AR=$PREFIX/mipsel-linux-uclibc-ar
export AS=$PREFIX/mipsel-linux-uclibc-as
export LD=$PREFIX/mipsel-linux-uclibc-ld
export NM=$PREFIX/mipsel-linux-uclibc-nm
export CC=$PREFIX/mipsel-linux-uclibc-gcc
export CPP=$PREFIX/mipsel-linux-uclibc-cpp
export GCC=$PREFIX/mipsel-linux-uclibc-gcc
export CC=$PREFIX/mipsel-linux-uclibc-gcc
export CXX=$PREFIX/mipsel-linux-uclibc-g++
export RANLIB=$PREFIX/mipsel-linux-uclibc-ranlib

export LIBTOOL=/home/user/whiterussian/toolchain_build_mipsel/binutils-2.16.1-build/ld/libtool

export CFLAGS=&quot;-Os -s&quot;

export LDFLAGS=&quot;-L/home/user/whiterussian/staging_dir_mipsel/usr/lib&quot;

export CPPFLAGS=&quot;-I/home/user/whiterussian/openwrt/staging_dir_mipsel/usr/include&quot;</code></pre></div><p>now back in &quot;/home/user/&quot; i have a file called &quot;test.cpp&quot;</p><div class="codebox"><pre><code>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;


int main(void) {
  printf(&quot;test\ngive it a try\n\n&quot;);
  return 0 ;
}</code></pre></div><p>then tried to compile it with:<br />&quot;g++ -o test test.cpp&quot;</p><p>after that I scp&#039;d the file &quot;test&quot; to my OpenWRT-Box</p><p>root@aWrt:/opt# test<br />root@aWrt:/opt#</p><p>... nothing happend....</p>											<p class="post-edited">(Last edited by <strong>thetruelighthouse</strong> on 16 May 2008, 18:22)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p68317">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">ciscostu</div>
					<div class="post-datetime">
						16 May 2008, 19:27					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><p>then tried to compile it with:<br />&quot;g++ -o test test.cpp&quot;</p></blockquote></div><p>Does &#039;which g++&#039; show you&#039;re using the g++ in the cross-compile environment?</p><p>If no, try &#039;$PREFIX/mipsel-linux-uclibc-g++ -o test test.cpp&#039;.</p><p>Hope this helps,<br />Charlie</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p68318">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">thetruelighthouse</div>
					<div class="post-datetime">
						16 May 2008, 19:59					</div>
				</div>
				<div class="post-content content">
					<p>thanks a lot!</p><p>I looks like it is working &quot;a bit&quot;...</p><div class="codebox"><pre><code>root@aWrt:/opt# ./test
./test: can&#039;t load library &#039;libstdc++.so.6&#039;
root@aWrt:/opt#</code></pre></div><p>I found <a href="http://forum.openwrt.org/viewtopic.php?id=5446">this Post</a> and <a href="http://forum.openwrt.org/viewtopic.php?pid=56609">this Post</a>.<br />How do I compile my file against the needed Library? I guess it is just a argument for the g++ compiler.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p68319">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">aoz.syn</div>
					<div class="post-datetime">
						16 May 2008, 20:07					</div>
				</div>
				<div class="post-content content">
					<p>Why are you using g++ anyway?&nbsp; Are you writing C or C++?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p68321">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">ciscostu</div>
					<div class="post-datetime">
						16 May 2008, 20:22					</div>
				</div>
				<div class="post-content content">
					<p>libstdc++.so.6 is provided by this package-</p><p><a href="http://downloads.openwrt.org/kamikaze/7.09/brcm-2.4/packages/libstdcpp_3.4.6-10_mipsel.ipk">libstdcpp_3.4.6-10_mipsel.ipk</a></p><p>No need to recompile unless you&#039;re really hurting for space.</p><p>Charlie</p>											<p class="post-edited">(Last edited by <strong>ciscostu</strong> on 16 May 2008, 20:23)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p68324">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">thetruelighthouse</div>
					<div class="post-datetime">
						16 May 2008, 20:49					</div>
				</div>
				<div class="post-content content">
					<p>thank you!<br />and thanks for the link!</p><p>I works again &quot;a bit&quot; more ;-)</p><div class="codebox"><pre><code>root@aWrt:/opt# ./test
Aborted
root@aWrt:/opt#</code></pre></div><p>I know it does not say much... Any ideas?</p>											<p class="post-edited">(Last edited by <strong>thetruelighthouse</strong> on 16 May 2008, 20:50)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p68326">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">thetruelighthouse</div>
					<div class="post-datetime">
						16 May 2008, 21:28					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>aoz.syn wrote:</cite><blockquote><p>Why are you using g++ anyway?&nbsp; Are you writing C or C++?</p></blockquote></div><p>For my project should just C be fine. <br />But I got troubles using gcc:</p><div class="codebox"><pre><code>mipsel-linux-uclibc-gcc -o test test.cpp
/tmp/ccUYdduD.o:(.eh_frame+0x11): undefined reference to `__gxx_personality_v0&#039;
collect2: ld returned 1 exit status</code></pre></div><p>using &quot;mipsel-linux-uclibc-gcc -lstdc++ -o test test.cpp&quot;<br />it compiles without exiting</p><br /><p>But anyway I&#039;m still not able to execute a self compiles binary on my OpenWRT-Box, because of the the &quot;Aborted&quot; message - see above...<br />Any ideas?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p68328">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">ciscostu</div>
					<div class="post-datetime">
						16 May 2008, 22:36					</div>
				</div>
				<div class="post-content content">
					<p>Try running your app under <a href="http://downloads.openwrt.org/kamikaze/packages/mipsel/strace_4.5.14-1_mipsel.ipk">strace</a> to get some debugging info.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p68329">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">thetruelighthouse</div>
					<div class="post-datetime">
						16 May 2008, 23:01					</div>
				</div>
				<div class="post-content content">
					<p>Wow, this is cool! Thanks!<br />Thanks for your help so far!</p><div class="codebox"><pre><code>root@aWrt:/opt# strace test
execve(&quot;/usr/bin/test&quot;, [&quot;test&quot;], [/* 10 vars */]) = 0
svr4_syscall()                          = -1 ERRNO_4090 (Unknown error 4090)
stat(&quot;/etc/ld.so.cache&quot;, 0x7fff7a90)    = -1 ENOENT (No such file or directory)
open(&quot;&quot;, O_RDONLY)                      = 3
fstat(3, {st_mode=S_IFREG|0644, st_size=10370, ...}) = 0
old_mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2aaae000
read(3, &quot;\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\10\0\1\0\0\0 \5\0\000&quot;..., 4096) = 4096
old_mmap(NULL, 344064, PROT_NONE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2aaed000
old_mmap(0x2aaed000, 10296, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_FIXED, -1, 0) = 0x2aaed000
old_mmap(0x2ab2f000, 2178, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED, 3, 0) = 0x2ab2f000
old_mmap(0x2ab30000, 68976, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x2ab30000
close(3)                                = 0
munmap(0x2aaae000, 4096)                = 0
open(&quot;/lib/libm.so.0&quot;, O_RDONLY)        = 3
fstat(3, {st_mode=0, st_size=26098, ...}) = 0
old_mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, 715841780, 0x2aaed000) = 0x2aaae000
read(3, &quot;\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\10\0\1\0\0\0000\f\0&quot;..., 4096) = 4096
old_mmap(NULL, 290816, PROT_NONE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2ab41000
old_mmap(0x2ab41000, 25932, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_FIXED, -1, 0) = 0x2ab41000
old_mmap(0x2ab87000, 1522, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED, 3, 0) = 0x2ab87000
close(3)                                = 0
munmap(0x2aaae000, 4096)                = 0
open(&quot;ÃŒÂ®*X|gcc_s.so.1&quot;, O_RDONLY)    = 3
fstat(3, {st_mode=0, st_size=59178, ...}) = 0
old_mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2aaae000
read(3, &quot;\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\10\0\1\0\0\0\0\30\0&quot;..., 4096) = 4096
old_mmap(NULL, 323584, PROT_NONE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2ab88000
old_mmap(0x2ab88000, 56980, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_FIXED, 3, 0) = 0x2ab88000
old_mmap(0x2abd6000, 1834, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED, 3, 0) = 0x2abd6000
close(3)                                = 0
munmap(0x2aaae000, 4096)                = 0
open(&quot;ÃŒÂ®*X|Â¸zHÂ«Âª*/lib/libgcc_s.so.1&quot;, O_RDONLY) = 3
fstat(3, {st_mode=S_IFREG|0644, st_size=401919, ...}) = 0
old_mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2aaae000
read(3, &quot;\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\10\0\1\0\0\0\20\272&quot;..., 4096) = 4096
old_mmap(NULL, 684032, PROT_NONE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2abd7000
old_mmap(0x2abd7000, 394356, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_FIXED, -1, 0) = 0x2abd7000
old_mmap(0x2ac78000, 4607, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED, 3, 0) = 0x2ac78000
old_mmap(0x2ac7a000, 15768, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, 3, 0x61000) = 0x2ac7a000
close(3)                                = 0
munmap(0x2aaae000, 4096)                = 0
open(&quot;/lib/libÂ¨zHÂ«Âª*/lib/libc.so.0&quot;, O_RDONLY) = 3
fstat(3, {st_mode=S_IFREG|0644, st_size=401919, ...}) = 0
close(3)                                = 0
open(&quot;ÃŒÂ®*X|zHÂ«Âª*/lib/libc.so.0&quot;, O_RDONLY) = 3
fstat(3, {st_mode=0, st_size=0, ...})   = 0
close(3)                                = 0
open(&quot;/lib/libc.so.0&quot;, O_RDONLY)        = 3
fstat(3, {st_mode=0, st_size=401919, ...}) = 0
close(3)                                = 0
ioctl(0, TIOCNXCL, {B38400 opost isig icanon echo ...}) = 0
ioctl(1, TIOCNXCL, {B38400 opost isig icanon echo ...}) = 0
getuid()                                = 0
getgid()                                = 0
setgid(0)                               = 0
setuid(0)                               = 0
exit(1)                                 = ?
Process 751 detached</code></pre></div><p>looks like it is looking for a /etc/ld.so.cache is missing...<br />I guess my program needs to look somewhere else for its libraries....</p><p>Andy Ideas?</p>											<p class="post-edited">(Last edited by <strong>thetruelighthouse</strong> on 16 May 2008, 23:06)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p68331">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">thetruelighthouse</div>
					<div class="post-datetime">
						16 May 2008, 23:37					</div>
				</div>
				<div class="post-content content">
					<p>HEY!</p><p>I just got my first test working! ;-)</p><p>I used the command &quot;mispel-linux-uclibc-gcc -O -o test test.cpp&quot;<br />the option &quot;-O&quot; was the key... I have no glue what this option does, but it works!</p><p>The documentation of gcc says something that this prams are automatically passed to various sub-processes invoked by gcc...</p><p>Thank you very much for your support!</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>