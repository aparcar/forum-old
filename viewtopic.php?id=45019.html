<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> TP-LINK Stock firmware vs. OpenWRT: WDS speed</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 4 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p206057">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Boompje123</div>
					<div class="post-datetime">
						30 Jun 2013, 10:35					</div>
				</div>
				<div class="post-content content">
					<p>Dear all,</p><p>Yet another question from me, sorry about that. I checked the Wiki but couldn&#039;t find anything.</p><p>My question:<br />Why is it that with stock TP-LINK firmware (on my wdr4900) when running WDS link, clients can still connect at 150 Mbit to the SSID of the WDS Station. With OpenWRT, on the other hand, clients only get single stream N - 65 Mbit when they connect to the WDS Station&#039;s SSID.</p><p>In sum:<br />Main Router (WDS Master) - Secondary Router (wdr4900 / WDS Station) - SSID of wdr4900 - Client (Stock: 150 Mbit/OpenWRT: 65 Mbit connection)</p><p>Anyone have an explanation? I can see that the WDS Master and Station are connected at a speed of 270-300 Mbit, thus leaving very little room for the secondary SSID. Honestly, I would rather have the WDS link function at 150 Mbit and the SSID function at 150 Mbit.</p><p>My wan downstream is 60 Mbit so 150 Mbit WDS link is sufficient anyway.</p><p>Thank you for helping / reading <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />Emile</p>											<p class="post-edited">(Last edited by <strong>Boompje123</strong> on 30 Jun 2013, 10:38)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p206060">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						30 Jun 2013, 12:01					</div>
				</div>
				<div class="post-content content">
					<p>have you checked the &quot;noscan&quot; option?</p><p><a href="http://wiki.openwrt.org/doc/uci/wireless#common.options">http://wiki.openwrt.org/doc/uci/wireless#common.options</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p206064">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Boompje123</div>
					<div class="post-datetime">
						30 Jun 2013, 14:11					</div>
				</div>
				<div class="post-content content">
					<p>Yep its set at 1</p><br /><p>config wifi-device &#039;radio0&#039;<br />&nbsp; &nbsp; option type &#039;mac80211&#039;<br />&nbsp; &nbsp; option channel &#039;36&#039;<br />&nbsp; &nbsp; option hwmode &#039;11na&#039;<br />&nbsp; &nbsp; option path &#039;pci0000:00/0000:00:00.0/0000:01:00.0&#039;<br />&nbsp; &nbsp; option htmode &#039;HT20&#039;<br />&nbsp; &nbsp; list ht_capab &#039;LDPC&#039;<br />&nbsp; &nbsp; list ht_capab &#039;SHORT-GI-20&#039;<br />&nbsp; &nbsp; list ht_capab &#039;SHORT-GI-40&#039;<br />&nbsp; &nbsp; list ht_capab &#039;TX-STBC&#039;<br />&nbsp; &nbsp; list ht_capab &#039;RX-STBC1&#039;<br />&nbsp; &nbsp; list ht_capab &#039;DSSS_CCK-40&#039;<br />&nbsp; &nbsp; option noscan &#039;1&#039;</p><p>config wifi-device &#039;radio1&#039;<br />&nbsp; &nbsp; option type &#039;mac80211&#039;<br />&nbsp; &nbsp; option hwmode &#039;11ng&#039;<br />&nbsp; &nbsp; option path &#039;pci0001:02/0001:02:00.0/0001:03:00.0&#039;<br />&nbsp; &nbsp; list ht_capab &#039;LDPC&#039;<br />&nbsp; &nbsp; list ht_capab &#039;SHORT-GI-20&#039;<br />&nbsp; &nbsp; list ht_capab &#039;SHORT-GI-40&#039;<br />&nbsp; &nbsp; list ht_capab &#039;TX-STBC&#039;<br />&nbsp; &nbsp; list ht_capab &#039;RX-STBC1&#039;<br />&nbsp; &nbsp; list ht_capab &#039;DSSS_CCK-40&#039;<br />&nbsp; &nbsp; option country &#039;NL&#039;<br />&nbsp; &nbsp; option channel &#039;13&#039;<br />&nbsp; &nbsp; option htmode &#039;HT40-&#039;<br />&nbsp; &nbsp; option txpower &#039;20&#039;<br />&nbsp; &nbsp; option noscan &#039;1&#039;</p><p>config wifi-iface<br />&nbsp; &nbsp; option ssid &#039;MainSSIDtoBridge&#039;<br />&nbsp; &nbsp; option encryption &#039;psk2&#039;<br />&nbsp; &nbsp; option device &#039;radio1&#039;<br />&nbsp; &nbsp; option mode &#039;sta&#039;<br />&nbsp; &nbsp; option bssid &#039;F8:D1:11:BE:2C:6A&#039;<br />&nbsp; &nbsp; option key &#039;XXX&#039;<br />&nbsp; &nbsp; option wds &#039;1&#039;<br />&nbsp; &nbsp; option network &#039;lan wan&#039;</p><p>config wifi-iface<br />&nbsp; &nbsp; option device &#039;radio1&#039;<br />&nbsp; &nbsp; option mode &#039;ap&#039;<br />&nbsp; &nbsp; option encryption &#039;psk2+ccmp&#039;<br />&nbsp; &nbsp; option key &#039;XXX&#039;<br />&nbsp; &nbsp; option ssid &#039;SecondarySSID&#039;<br />&nbsp; &nbsp; option network &#039;lan wan&#039;</p>											<p class="post-edited">(Last edited by <strong>Boompje123</strong> on 30 Jun 2013, 14:13)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p206079">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">nozombian</div>
					<div class="post-datetime">
						30 Jun 2013, 18:01					</div>
				</div>
				<div class="post-content content">
					<p>I don&#039;t know why you can&#039;t connect at full speed, maybe I&#039;d try to pick a different channel like 12 (13 is at the edge of the spectrum). But 150 mbit wifi will handle 60mbit connection only in ideal conditions, if you&#039;re in the same room with router and far away from civilization and interference.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p206087">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						30 Jun 2013, 18:26					</div>
				</div>
				<div class="post-content content">
					<p>well, i tried an simpler setup on my wr703n, with AA 12.09, a client, and an ap, on the same and only radio.</p><p>with only the ap enabled, it supports HT40 and rate is 150 Mbps, when enabling also client, it stops broadcasting HT Capabilities, and the clients connects at 65 Mbps maximum.</p><p>also Inssider shows channel 1 and max rate 65 Mbps, while before it showed 1+5 and 150 Mbps.</p><p>seems to me like a bug when there are multiple interface on same radio?</p><p>here is a wireshark cap file that shows difference between the 2 Beacons:</p><p><a href="https://www.dropbox.com/s/g0eglkdoi3j9q4o/ht_prob.cap">https://www.dropbox.com/s/g0eglkdoi3j9q4o/ht_prob.cap</a></p><p>look under Tag: HT Information Subset</p><br /><p>EDIT:</p><p><a href="https://dev.openwrt.org/ticket/12720">https://dev.openwrt.org/ticket/12720</a></p><br /><p>-.-</p>											<p class="post-edited">(Last edited by <strong>nebbia88</strong> on 30 Jun 2013, 18:39)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p206097">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Boompje123</div>
					<div class="post-datetime">
						30 Jun 2013, 22:31					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for the info guys. So it looks like its a bug.. kinda annoying.</p><p>I&#039;ll try switching channels/HT tomorrow. Just did a quick test on channel 12 tho, that didn&#039;t change anything</p><p>Again, will try some more tomorrow.</p><p>Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p206098">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">Boompje123</div>
					<div class="post-datetime">
						30 Jun 2013, 22:31					</div>
				</div>
				<div class="post-content content">
					<p>Also: thanks for testing nebbia. That&#039;s super kind</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p229527">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">FurryFur</div>
					<div class="post-datetime">
						8 Apr 2014, 00:51					</div>
				</div>
				<div class="post-content content">
					<p>Posted culprit process and temporary solution for this bug on the tracker <a href="https://dev.openwrt.org/ticket/12720#comment:22">https://dev.openwrt.org/ticket/12720#comment:22</a></p><p>Here is a copy and paste for the lazy:</p><div class="quotebox"><blockquote><p>Here is a temporary fix. Put this in your start up script:<br />killall -9 hostapd<br />hostapd -P /var/run/wifi-phy0.pid -B /var/run/hostapd-phy0.conf<br />exit 0<br />This fixes the issue for me unless I change some settings which cause networking to restart, then the issue comes back again. It appears to be caused when wpa_supplicant starts after hostapd. I inserted some sleep events into the network start-up scripts and monitored with inSSIDer in order to determine exactly when my interface was getting locked back to 20MHz. The interface locks to 20MHz exactly as wpa_supplicant starts. It seems like wpa_supplicant is somehow changing the radio settings back to 20MHz but I couldn&#039;t track down the exact cause of this.<br />I am running OpenWrt Attitude Adjustment 12.09 Final on a TL-WR842ND V1.0<br />I have my routers configured with two virtual wireless interfaces, one in Access Point (WDS) mode and the second in Client (WDS) modes. I have several routers setup in the network like this however the behavior exhibits itself even with just two routers. The condition for triggering this bug seems to be to have your router configured in both client and access point mode i.e. you have wpa_supplicant (client connection) starting after hostapd (access point managment) has started. It was awhile ago since I tested this so I&#039;m not sure if the same behavior occurs when the router is configured in Client Mode only (could be caused by wpa_supplicant alone?) but I have a feeling that it does not.</p></blockquote></div>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>