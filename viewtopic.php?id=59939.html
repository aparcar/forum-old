<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> unable to compile trunk when place additional file into package</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 16 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p293671">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">nedoskiv</div>
					<div class="post-datetime">
						27 Sep 2015, 16:38					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>I used to place some files into openwrt root directory. To achieve that just copy them into package/base-files/files/ directory<br />It work for me so far. I decide to download trunk and do the same, but when place a file inside package/base .....&nbsp; &nbsp;it fails to compile, here is the last lines from compilation (make V=s).<br />Actually after many retries looks like one of my files make compilation fail, it is 11k binary file compiled for mips , here is the last lines from compilation (make V=s).</p><br /><p>mkdir -p /storage/openwrt/dd_1/build_dir/target-mips_34kc_musl-1.1.11/linux-ar71xx_generic/base-files/ipkg-ar71xx/base-files/tmp<br />mkdir -p /storage/openwrt/dd_1/build_dir/target-mips_34kc_musl-1.1.11/linux-ar71xx_generic/base-files/ipkg-ar71xx/base-files/usr/lib<br />mkdir -p /storage/openwrt/dd_1/build_dir/target-mips_34kc_musl-1.1.11/linux-ar71xx_generic/base-files/ipkg-ar71xx/base-files/usr/bin<br />mkdir -p /storage/openwrt/dd_1/build_dir/target-mips_34kc_musl-1.1.11/linux-ar71xx_generic/base-files/ipkg-ar71xx/base-files/sys<br />mkdir -p /storage/openwrt/dd_1/build_dir/target-mips_34kc_musl-1.1.11/linux-ar71xx_generic/base-files/ipkg-ar71xx/base-files/www<br />mkdir -p /storage/openwrt/dd_1/build_dir/target-mips_34kc_musl-1.1.11/linux-ar71xx_generic/base-files/ipkg-ar71xx/base-files/root<br />ln -sf /proc/mounts /storage/openwrt/dd_1/build_dir/target-mips_34kc_musl-1.1.11/linux-ar71xx_generic/base-files/ipkg-ar71xx/base-files/etc/mtab<br />rm -f /storage/openwrt/dd_1/build_dir/target-mips_34kc_musl-1.1.11/linux-ar71xx_generic/base-files/ipkg-ar71xx/base-files/var<br />ln -sf /tmp /storage/openwrt/dd_1/build_dir/target-mips_34kc_musl-1.1.11/linux-ar71xx_generic/base-files/ipkg-ar71xx/base-files/var<br />mkdir -p /storage/openwrt/dd_1/build_dir/target-mips_34kc_musl-1.1.11/linux-ar71xx_generic/base-files/ipkg-ar71xx/base-files/etc<br />ln -sf /tmp/resolv.conf /tmp/fstab /tmp/TZ /storage/openwrt/dd_1/build_dir/target-mips_34kc_musl-1.1.11/linux-ar71xx_generic/base-files/ipkg-ar71xx/base-files/etc/<br />chmod 0600 /storage/openwrt/dd_1/build_dir/target-mips_34kc_musl-1.1.11/linux-ar71xx_generic/base-files/ipkg-ar71xx/base-files/etc/shadow<br />chmod 1777 /storage/openwrt/dd_1/build_dir/target-mips_34kc_musl-1.1.11/linux-ar71xx_generic/base-files/ipkg-ar71xx/base-files/tmp<br />rm -f /storage/openwrt/dd_1/build_dir/target-mips_34kc_musl-1.1.11/linux-ar71xx_generic/base-files/ipkg-ar71xx/base-files/etc/config/network<br />for conffile in /storage/openwrt/dd_1/build_dir/target-mips_34kc_musl-1.1.11/linux-ar71xx_generic/base-files/ipkg-ar71xx/base-files/etc/config/*; do if [ -f &quot;$conffile&quot; ]; then grep &quot;${conffile##/storage/openwrt/dd_1/build_dir/target-mips_34kc_musl-1.1.11/linux-ar71xx_generic/base-files/ipkg-ar71xx/base-files}&quot; /storage/openwrt/dd_1/build_dir/target-mips_34kc_musl-1.1.11/linux-ar71xx_generic/base-files/ipkg-ar71xx/base-files/CONTROL/conffiles || echo &quot;${conffile##/storage/openwrt/dd_1/build_dir/target-mips_34kc_musl-1.1.11/linux-ar71xx_generic/base-files/ipkg-ar71xx/base-files}&quot; &gt;&gt; /storage/openwrt/dd_1/build_dir/target-mips_34kc_musl-1.1.11/linux-ar71xx_generic/base-files/ipkg-ar71xx/base-files/CONTROL/conffiles; fi done<br />grep: /storage/openwrt/dd_1/build_dir/target-mips_34kc_musl-1.1.11/linux-ar71xx_generic/base-files/ipkg-ar71xx/base-files/CONTROL/conffiles: No such file or directory<br />find /storage/openwrt/dd_1/build_dir/target-mips_34kc_musl-1.1.11/linux-ar71xx_generic/base-files/ipkg-ar71xx/base-files -name &#039;CVS&#039; -o -name &#039;.svn&#039; -o -name &#039;.#*&#039; -o -name &#039;*~&#039;| xargs -r rm -rf<br />Package base-files is missing dependencies for the following libraries:<br />libc.so.0<br />make[3]: *** [/storage/openwrt/dd_1/bin/ar71xx/packages/base/base-files_159-r47048_ar71xx.ipk] Error 1<br />make[3]: Leaving directory `/storage/openwrt/dd_1/package/base-files&#039;<br />make[2]: *** [package/base-files/compile] Error 2<br />make[2]: Leaving directory `/storage/openwrt/dd_1&#039;<br />make[1]: *** [/storage/openwrt/dd_1/staging_dir/target-mips_34kc_musl-1.1.11/stamp/.package_compile] Error 2<br />make[1]: Leaving directory `/storage/openwrt/dd_1&#039;<br />make: *** [world] Error 2</p><br /><p>any ideas how to correct this&nbsp; problem?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p293672">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Borromini</div>
					<div class="post-datetime">
						27 Sep 2015, 16:44					</div>
				</div>
				<div class="post-content content">
					<p>Did you read <a href="https://wiki.openwrt.org/doc/howto/build#custom_files">these instructions</a>?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p293761">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">nedoskiv</div>
					<div class="post-datetime">
						28 Sep 2015, 09:21					</div>
				</div>
				<div class="post-content content">
					<p>I did nothing wrong and curious thing is that one file cause compilation to fail, if I include other files, there is no problem, but if put this file, never mind in what base-files directory, compilation fails with the above error. Very strange ................. (same file is included in BB_14.07 compilation and it work without problem)</p>											<p class="post-edited">(Last edited by <strong>nedoskiv</strong> on 28 Sep 2015, 09:39)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p293763">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						28 Sep 2015, 09:33					</div>
				</div>
				<div class="post-content content">
					<p>What is the file?&nbsp; (There is the warning about a missing &quot;libc&quot; dependency, which looks strange).</p><p>My guess is that somehow your file replaces a normal file and compilation fails as the system thinks that the base-files package needs a new dependency. </p><p>Like Borromini indicated via the wiki link, the normal place to add custom files is NOT &lt;buildroot&gt;/package/base-files/files. Normal place is &lt;buildroot&gt;/files and the files placed there should be handled properly. Have you tried that already?</p>											<p class="post-edited">(Last edited by <strong>hnyman</strong> on 28 Sep 2015, 09:34)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p293775">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">nedoskiv</div>
					<div class="post-datetime">
						28 Sep 2015, 13:19					</div>
				</div>
				<div class="post-content content">
					<p>Thank u for your help guys, looks like I was in mistake putting files into packages directory, it works fine so far, but now you show me the better/right way and&nbsp; it worked, thank you.</p>											<p class="post-edited">(Last edited by <strong>nedoskiv</strong> on 28 Sep 2015, 13:19)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>