<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> comgt Problem</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 30 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p97581">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">vasquez</div>
					<div class="post-datetime">
						18 Nov 2009, 18:23					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I setup a nslu2 with openwrt (tried 8.09.1 and trunk, squashfs) and want to use a Huawei E160 for a 3g connection. Device shows up fine as ttyUSB0, I can talk with the modem with minicom without any problem. I followed all the tutorials around, but I&#039;m hitting a wall with comgt/gcom: Whenever I call it, I get this:</p><p>(should ask for the PIN):<br />------------------<br />root@OpenWrt:~# gcom -d /dev/ttyUSB0<br />comgt 23:09:44 -&gt; -- Error Report --<br />comgt 23:09:44 -&gt; ----&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;^<br />comgt 23:09:44 -&gt; Error @74, line 4, Could not write to COM device. (1)<br />root@OpenWrt:~# <br />----------------------<br />The dmesg output is very weird (see below)<br />I tried all the command switches, no default script etc.</p><p>I removed all the references to gcom in /lib/modules/3g.sh, but then I have to setup the PIN with minicom and the connection is slow.</p><p>Any hints? Thanks.</p><br /><p>----------<br />dmesg (any more, too much for the ringbuffer btw!):<br />------------[ cut here ]------------<br />WARNING: at drivers/usb/serial/usb-serial.c:327 ()<br />Modules linked in: option usb_storage usbserial ohci_hcd ipt_MASQUERADE iptable_nat nf_nat xt_NOTRACK iptable_raw xt_state nf_conntrack_ipv4 nf_defrag_ipv4 nf_conntrack ehci_hcd sd_mod pppoe pppox ipt_REJECT xt_TCPMSS ipt_LOG xt_multiport xt_mac xt_limit iptable_mangle iptable_filter ip_tables xt_tcpudp x_tables ext2 ext3 jbd ppp_async ppp_generic slhc usbcore scsi_mod crc_ccitt<br />Function entered at [&lt;c01d024c&gt;] from [&lt;c00310a8&gt;]<br />Function entered at [&lt;c0031060&gt;] from [&lt;bf132778&gt;]<br /> r6:c1dfa800 r5:c1dfa800 r4:c10d3800<br />Function entered at [&lt;bf132724&gt;] from [&lt;c01148ec&gt;]<br /> r5:00000054 r4:c1dfa800<br />Function entered at [&lt;c01148c4&gt;] from [&lt;c01121d4&gt;]<br />Function entered at [&lt;c01121b8&gt;] from [&lt;c01123e0&gt;]<br /> r5:c1dfa800 r4:00000054<br />Function entered at [&lt;c0112370&gt;] from [&lt;c0113914&gt;]<br /> r5:00000054 r4:c1068800<br />Function entered at [&lt;c0113638&gt;] from [&lt;c011696c&gt;]<br />Function entered at [&lt;c0116878&gt;] from [&lt;c0116a50&gt;]<br />Function entered at [&lt;c0116a10&gt;] from [&lt;bf152e94&gt;]<br />Function entered at [&lt;bf152de0&gt;] from [&lt;bf01cf0c&gt;]<br /> r8:c1072960 r7:00000000 r6:ffc021e0 r5:00000000 r4:c1072960<br />Function entered at [&lt;bf01ce90&gt;] from [&lt;bf0dc1b0&gt;]<br /> r5:c1e90600 r4:ffc01080<br />Function entered at [&lt;bf0dc0c4&gt;] from [&lt;bf0dcb70&gt;]<br /> r9:ffffff8d r8:c10729e0 r7:c1e906c0 r6:ffc021e0 r5:ffc023c0<br />r4:ffc01080<br />Function entered at [&lt;bf0dca98&gt;] from [&lt;bf0df9e4&gt;]<br />Function entered at [&lt;bf0df8ec&gt;] from [&lt;bf0e152c&gt;]<br />Function entered at [&lt;bf0e12f4&gt;] from [&lt;bf01cc9c&gt;]<br />Function entered at [&lt;bf01cc58&gt;] from [&lt;c0055884&gt;]<br /> r5:00000000 r4:c1058720<br />Function entered at [&lt;c0055840&gt;] from [&lt;c0056ed0&gt;]<br /> r7:000003ff r6:00000000 r5:0000001a r4:c0223f58<br />Function entered at [&lt;c0056e3c&gt;] from [&lt;c0020064&gt;]<br /> r5:c023cc20 r4:0000001a<br />Function entered at [&lt;c0020000&gt;] from [&lt;c00209b0&gt;]<br />Exception stack(0xc1e29ab8 to 0xc1e29b00)<br />9aa0:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;000f4229 000003e8 <br />9ac0: 00000000 00000017 000f4240 c1e29f70 c1c9e92c 000003ff be9fa89c c1e29f70 <br />9ae0: 00000000 c1e29b24 3b9a70c5 c1e29b00 c008b1b0 c00eef80 20000013 ffffffff <br /> r7:000003ff r6:04000000 r5:0000001f r4:ffffffff<br />Function entered at [&lt;c008b0d4&gt;] from [&lt;c008bc5c&gt;]<br /> r5:00000000 r4:fffffffc<br />Function entered at [&lt;c008b7e4&gt;] from [&lt;c008beb0&gt;]<br />Function entered at [&lt;c008bc68&gt;] from [&lt;c008c138&gt;]<br />Function entered at [&lt;c008bf68&gt;] from [&lt;c0020da0&gt;]<br />---[ end trace acad35f743645df7 ]---</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p100837">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">bosterm</div>
					<div class="post-datetime">
						18 Jan 2010, 23:23					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I have the same problem here. I am running 8.09.1 on an NSLU2 and using an Huawei E169 UMTS stick.</p><p>After bootup, I &quot;activate&quot; the full functionality of the stick using </p><div class="codebox"><pre><code>usb_modeswitch -v 12d1 -p 1001 -H 1</code></pre></div><p>and get /dev/ttyUSB0, /dev/ttyUSB1, /dev/ttyUSB2 and /dev/ttyUSB3.</p><p>However, if I try </p><div class="codebox"><pre><code>gcom -d /dev/ttyUSB0</code></pre></div><p>,</p><p>I get </p><div class="codebox"><pre><code>comgt 10:26:08 -&gt; -- Error Report --
comgt 10:26:08 -&gt; ----&gt;                       ^
comgt 10:26:08 -&gt; Error @74, line 4, Could not write to COM device. (1)</code></pre></div><p>.</p><p>Now, here is the strange part: As soon as I use minicom to &quot;talk&quot; to the stick, comgt will work subsequently. </p><p>I&#039;m now looking for a way to automate my workaround...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p100839">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">bosterm</div>
					<div class="post-datetime">
						19 Jan 2010, 00:27					</div>
				</div>
				<div class="post-content content">
					<p>Ok, seems like I am not the only one who discovered this workaround:</p><p><a href="http://nuwiki.openwrt.org/oldwiki/openwrtdocs/customizing/hardware/umts">http://nuwiki.openwrt.org/oldwiki/openw … dware/umts</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p100863">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">vasquez</div>
					<div class="post-datetime">
						19 Jan 2010, 08:26					</div>
				</div>
				<div class="post-content content">
					<p>Wow, didn&#039;t see this. Thanks for the workaround.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p100925">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">bosterm</div>
					<div class="post-datetime">
						20 Jan 2010, 01:19					</div>
				</div>
				<div class="post-content content">
					<p>I found a way to perform this automatically, using stty [1]:</p><div class="codebox"><pre><code>stty -F /dev/ttyUSB0 1:0:8bd:0:3:1c:7f:15:1:5:1:0:11:13:1a:0:12:f:17:16:0:0:0:0:0:0:0:0:0:0:0:0:0:0:0:0</code></pre></div><p>works for me.&nbsp; If it doesn&#039;t work for you, here is the trick:</p><p>Find a working state, e.g., using minicom. As soon as you can connect using comgt/gcom, save your configuration with &quot;stty -F /dev/ttyUSB0 -g&quot;. The output string can then be used as seen above in order to configure /dev/ttyUSB*.</p><p>[1] To get stty, see <a href="https://forum.openwrt.org/viewtopic.php?pid=100923#p100923">https://forum.openwrt.org/viewtopic.php … 23#p100923</a><br />[2] For a full automation, see <a href="https://forum.openwrt.org/viewtopic.php?pid=100921#p100921">https://forum.openwrt.org/viewtopic.php … 21#p100921</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p100985">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">vasquez</div>
					<div class="post-datetime">
						20 Jan 2010, 16:51					</div>
				</div>
				<div class="post-content content">
					<p>Thanks a lot!</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>