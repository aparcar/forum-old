<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Would be nice to have some advice for my next project.</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 22 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p165429">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">kasperfish</div>
					<div class="post-datetime">
						22 Apr 2012, 16:19					</div>
				</div>
				<div class="post-content content">
					<p>Hi all!</p><p>I&#039;m Kasper from Belgium and discovered openwrt yesterday while browsing the internet for collecting info for my next hobby project. I immediately ordered a TP-LINK TL-WR703N from ebay to enter the wonderful world of openwrt. Mainly I&#039;m a web developer (php,sql,ajax,jquery and so on...) and started doing some arduino stuff since last year. While the arduino is also a wonderful piece of technology it has its limits. it does not have enough processing capabilities for my next project. I think openwrt can help me doing what I want. However I face a problem... I&#039;m not into linux (yet :-).</p><p>basically I want to connect an arduino to the USB port from my TL-WR703N together with a webcam for streaming video (using an USB hub). I understand I can use the openwrt/linux command line to send/receive serial data to/from the arduino. It would be great to bypass the terminal with a web interface hosted on the TL-WR703N. In the past I placed my web interfaces on the arduino but it lacks processing power and memory to handle streaming webcam video. That&#039;s why I&#039;m here ;-)</p><p>1) does the USB from the TL-WR703N has enough bandwidth for streaming video and controlling an arduino over serial? <br />2) Is the 4mb flash memory from the TL-WR703N enough to install lighttpd so I can use php serial class to communicate with the arduino through a web interface? Is php the best technology to do the trick or is there something better to bypass the terminal?</p><br /><p>Any info and suggestions are welcome. </p><p>Peace!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p165480">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">towolf</div>
					<div class="post-datetime">
						22 Apr 2012, 23:57					</div>
				</div>
				<div class="post-content content">
					<p>1. yes. <br />2. itâ€™s tight. there will only be a few hundred kb free for a default image and up to 1mb free for a totally slimmed down custom image.</p><p>php probably will not fit. but i dunno. personally, i use cgi shell scripts since the shell is built in and my stuff is not very elaborate.</p><p>by the way, you can hook the arduino directly to the serial port on the board of the router, hence you can avoid the usb hub. you have to solder a header or wires directly to the correct pads on the board for that.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p165481">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">towolf</div>
					<div class="post-datetime">
						22 Apr 2012, 23:59					</div>
				</div>
				<div class="post-content content">
					<p>just bite the bullet and learn some shell. something that will certainly prove useful in many other situations.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p165486">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Xerion</div>
					<div class="post-datetime">
						23 Apr 2012, 00:47					</div>
				</div>
				<div class="post-content content">
					<p>If you are going to use a usb hub anyway, you might as well use a usb stick and extroot, then the flash size won&#039;t matter...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p165490">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">lizby</div>
					<div class="post-datetime">
						23 Apr 2012, 02:05					</div>
				</div>
				<div class="post-content content">
					<p>What Xerion says is very true.&nbsp; It would also be easier to use usb/serial off of the hub than to try the very delicate and fragile soldering of the internal serial.&nbsp; Yes you will have the power to do webcam streaming.&nbsp; PHP is very heavy for a flash device with 4 or 8 meg of flash--but that can be solved with usb flash memory (but might still be sluggish).</p><p>I would also recommend not using lighttpd on such a small and low-powered linux device.&nbsp; cgi using the built-in server works well.</p><p>It would probably be possible to do what you want internally without usb flash (but using the hub because you need to talk both to the webcam and the arduino).&nbsp; Tell us more about the project.</p>											<p class="post-edited">(Last edited by <strong>lizby</strong> on 23 Apr 2012, 02:07)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p165544">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">kasperfish</div>
					<div class="post-datetime">
						23 Apr 2012, 15:39					</div>
				</div>
				<div class="post-content content">
					<p>thank you all!</p><p>The plan is to make a remote laser cat toy for touch enabled devices. Logging in on the openwrt router will display a webinterface -&gt; streaming video from the webcam. Clicking, Touching or swiping the screen will move 2 remote servos (x and y movement). A laser (and maybe the webcam itself) will be mounted on the servos. This can be easily done with the arduino and the webcam as seperate nodes on the LAN but I like to use only one wifi connection for both the camera and arduino. <br />I can do it with a la fonera card but I&#039;m more interested in using an openwrt device as it seams it is more versatile :-)</p><p>However I like the idea of having a small php server on a small device like the TL-WR703N, I think shell scripts/cgi will fit my needs better. thank you for that! I&#039;ll dive into linux shell scripting as soon as I feel to...</p><p>extroot in combination with a php server will be an option too, but like I said I&#039;m almost a total noob with linux and prefer starting with the beginning. </p><p>I hope I&#039;ll receive my TP-link very soon so I can start experimenting :-)</p><p>EDIT<br />------</p><p>just an other quick question about cgi: I could easily make a webpage and post data to a cgi shell script through ajax. Lets say this data are the coordinates from a screen touch on my android phone. Now the cgi script has to talk serial to the arduino and move the servos according to these coordinates . Is this functionality available when I flash my TP-link with the standard openwrt image found here <a href="http://wiki.openwrt.org/toh/tp-link/tl-wr703n">http://wiki.openwrt.org/toh/tp-link/tl-wr703n</a> or do I need extra usb libraries? Is perl the best way to write cgi scripts for a linux platform like openwrt?</p>											<p class="post-edited">(Last edited by <strong>kasperfish</strong> on 23 Apr 2012, 17:15)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p165550">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">lizby</div>
					<div class="post-datetime">
						23 Apr 2012, 18:02					</div>
				</div>
				<div class="post-content content">
					<p>My openwrt project to do servo pan and tilt for a webcam (controllable by anyone over the web) is documented here:&nbsp; </p><p><a href="http://www.picaxeforum.co.uk/showthread.php?13705">http://www.picaxeforum.co.uk/showthread.php?13705</a></p><p>and here:</p><p><a href="http://www.picaxeforum.co.uk/showthread.php?9425">http://www.picaxeforum.co.uk/showthread.php?9425</a></p><p>I used a picaxe rather than the arduino, but the principle is the same.</p><p>Here is a fairly simple web page with radio buttons (/www/furnace.html):<br /></p><div class="codebox"><pre><code>&lt;html&gt;
&lt;head&gt;
&lt;title&gt;702 Furnace&lt;/title&gt;
&lt;/head&gt;

&lt;body&gt;
&lt;form name=&quot;form1&quot; method=&quot;get&quot; action=&quot;/cgi-bin/set-furnace.sh&quot;&gt;
  &lt;p&gt;
    Click a button to set furnace runtime
  &lt;/p&gt;
  &lt;p&gt;
&lt;TABLE BORDER=&quot;1&quot; CELLSPACING=&quot;0&quot; CELLPADDING=&quot;5&quot;&gt;
&lt;TR&gt;&lt;TD&gt;Furnace&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD&gt;Run Time&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD&gt;
    &lt;input name=&quot;Radio_Button&quot; type=&quot;radio&quot; value=&quot;p0&quot; onClick=&quot;this.form.submit()&quot;&gt; off&lt;br&gt;
&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD&gt;
    &lt;input name=&quot;Radio_Button&quot; type=&quot;radio&quot; value=&quot;p1&quot; onClick=&quot;this.form.submit()&quot;&gt; 15 minutes
&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD&gt;
    &lt;input name=&quot;Radio_Button&quot; type=&quot;radio&quot; value=&quot;p2&quot; onClick=&quot;this.form.submit()&quot;&gt; 30 minutes&lt;br&gt;
&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD&gt;
    &lt;input name=&quot;Radio_Button&quot; type=&quot;radio&quot; value=&quot;p3&quot; onClick=&quot;this.form.submit()&quot;&gt; 45 minutes
&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD&gt;
    &lt;input name=&quot;Radio_Button&quot; type=&quot;radio&quot; value=&quot;p4&quot; onClick=&quot;this.form.submit()&quot;&gt; 1 hour&lt;br&gt;
&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD&gt;
    &lt;input name=&quot;Radio_Button&quot; type=&quot;radio&quot; value=&quot;p5&quot; onClick=&quot;this.form.submit()&quot;&gt; 75 minutes&lt;br&gt;
&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD&gt;
    &lt;input name=&quot;Radio_Button&quot; type=&quot;radio&quot; value=&quot;p6&quot; onClick=&quot;this.form.submit()&quot;&gt; 90 minutes&lt;br&gt;
&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD&gt;
    &lt;input name=&quot;Radio_Button&quot; type=&quot;radio&quot; value=&quot;p7&quot; onClick=&quot;this.form.submit()&quot;&gt; 105 minutes&lt;br&gt;
&lt;/TD&gt;&lt;/TR&gt;
&lt;TR&gt;&lt;TD&gt;
    &lt;input name=&quot;Radio_Button&quot; type=&quot;radio&quot; value=&quot;p8&quot; onClick=&quot;this.form.submit()&quot;&gt; 2 hours
&lt;/TD&gt;&lt;/TR&gt;&lt;/TABLE&gt;
  &lt;/p&gt;
&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre></div><p>And its action script (simplified)--/www/cgi-bin/set-furnace.sh:<br /></p><div class="codebox"><pre><code>#!/bin/sh
tmp=$(echo &quot;$QUERY_STRING&quot;|awk -F&#039;=&#039; &#039;{print $2}&#039;)
echo &quot;$tmp&quot; &gt; /dev/ttyUSB0
echo &quot;$tmp&quot; &gt;&gt; /var/log/furnace.log
echo &quot;Content-type: text/html&quot;
echo &quot;&quot;
cat /www/furnace.html</code></pre></div><p>Hope this helps.</p>											<p class="post-edited">(Last edited by <strong>lizby</strong> on 23 Apr 2012, 18:03)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p165552">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">lizby</div>
					<div class="post-datetime">
						23 Apr 2012, 18:17					</div>
				</div>
				<div class="post-content content">
					<p>For usb serial, you with need to install packages for usb serial and your serial dongle (probably CH341, PL2303, or CP210x):</p><p>opkg update<br />opkg install kmod-usb-serial kmod-usb-serial-ch341 kmod-usb-serial-cp210x kmod-usb-serial-pl2303</p><p>Right now, these packages are not available in trunk for the WR703N&#039;s ar71xx platform, and have not been for a week or more.&nbsp; Hope this gets fixed soon, otherwise you will have to build your own firmware (or use the latest backfire release, 10.3.1).</p>											<p class="post-edited">(Last edited by <strong>lizby</strong> on 23 Apr 2012, 18:20)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p165553">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">towolf</div>
					<div class="post-datetime">
						23 Apr 2012, 18:31					</div>
				</div>
				<div class="post-content content">
					<p>Yeah you can POST to a CGI shell script. With mjpeg-streamer you can get pseudo motion jpeg. The last time I tried I got 640x480 at 20 fps, but at a fairly high bandwidth.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p165586">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">kasperfish</div>
					<div class="post-datetime">
						23 Apr 2012, 22:17					</div>
				</div>
				<div class="post-content content">
					<p>@lizby: thanks bro for your example! It will surely help me with my project.<br />@towolf: I&#039;ll try it as soon as I have my TP-link from CN... hope it won&#039;t take too long.</p><p>thank for the promt info and help!</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>