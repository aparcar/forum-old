<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> NetGear WGT634U</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 2 Sep 2015 and 4 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 3 of 9</div><nav><ul><li><a href="viewtopic.php%3Fid=33&amp;p=1.html">1</a></li><li><a href="viewtopic.php%3Fid=33&amp;p=2.html">2</a></li><li class="pagination-current"><span>3</span></li><li><a href="viewtopic.php%3Fid=33&amp;p=4.html">4</a></li><li><a href="viewtopic.php%3Fid=33&amp;p=5.html">5</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=33&amp;p=9.html">9</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p4295">
				<div class="post-metadata">
					<div class="post-num">Post #51</div>
					<div class="post-author">Guest</div>
					<div class="post-datetime">
						1 Feb 2005, 09:38					</div>
				</div>
				<div class="post-content content">
					<p>hey,</p><p>nice discussion! I just ordered a WGT634U and will try to compile my own kernel asap I got it <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>Just a stupid question. I didn&#039;t any researches on the topic. But isn&#039;t it possible to extract the Atheros HAL of the driver used by Netgear to get 108 Mbps mode working?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p4299">
				<div class="post-metadata">
					<div class="post-num">Post #52</div>
					<div class="post-author">Fabe</div>
					<div class="post-datetime">
						1 Feb 2005, 13:29					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>Well the hal comes in binary object code for several platforms.<br />It&#039;s just linked together with some glue code.<br />Normally you have an ath_hal module which contains all of this stuff.<br />Is there an ath_hal module?</p><p>Hm, I should get one of those devices...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p4301">
				<div class="post-metadata">
					<div class="post-num">Post #53</div>
					<div class="post-author">nomis52</div>
					<div class="post-datetime">
						1 Feb 2005, 13:56					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><p>This is because of the empty Makefile. Add the following line to the Makefile in arch/mips/bcm47xx/broadcom:</p><p>obj-y := sbutils.o sbpci.o (and all the other files in the broadcom dir)</p><p>If a file doesn&#039;t compile just remove it from the obj-y line. You won&#039;t need it then.</p><p>You&#039;re pretty close&nbsp; <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /> </p><p>Best,<br />&nbsp; &nbsp;Florian</p></blockquote></div><p>Thanks Florian, I&#039;ve edged a bit closer, on doing a make I got a couple of undefined references to ... , most of which I&#039;ve been able to fix. The only ones left are as follows:</p><div class="codebox"><pre><code> arch/mips/bcm47xx/broadcom/built-in.o: In function `osl_pci_read_config&#039;:
arch/mips/bcm47xx/broadcom/built-in.o(.text+0x3e50): undefined reference to `pcibios_read_config_dword&#039;
arch/mips/bcm47xx/broadcom/built-in.o: In function `osl_pci_write_config&#039;:
arch/mips/bcm47xx/broadcom/built-in.o(.text+0x3ef4): undefined reference to `pcibios_write_config_dword&#039;
arch/mips/pci/built-in.o: In function `pcibios_enable_device&#039;:
arch/mips/pci/built-in.o(.text+0x348): undefined reference to `pcibios_plat_dev_init&#039;</code></pre></div><p>I&#039;ve tried grepping the source for these three functions to identify which source files they are defined in, but with no sucess (so far). Any ideas ?</p><p>The Makefile in arch/mips/bcm47xx/broadcom/shared now looks like so:</p><div class="codebox"><pre><code>obj-y := bcmsrom.o bcmutils.o  hnddma.o linux_osl.o sbmips.o  sbpci.o sbutils.o sflash.o</code></pre></div><p>And the one in arch/mips/bcm47xx/broadcom/ is:</p><div class="codebox"><pre><code>obj-y := shared/</code></pre></div><p>Many thanks Florian for your patience on this one, once I&#039;ve got this working I&#039;m going to write it up.</p><p>Cheers,</p><p>Simon</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p4324">
				<div class="post-metadata">
					<div class="post-num">Post #54</div>
					<div class="post-author">nomis52</div>
					<div class="post-datetime">
						2 Feb 2005, 18:15					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><div class="codebox"><pre><code>arch/mips/bcm47xx/broadcom/built-in.o: In function `osl_pci_read_config&#039;:
arch/mips/bcm47xx/broadcom/built-in.o(.text+0x3e50): undefined reference to `pcibios_read_config_dword&#039;
arch/mips/bcm47xx/broadcom/built-in.o: In function `osl_pci_write_config&#039;:
arch/mips/bcm47xx/broadcom/built-in.o(.text+0x3ef4): undefined reference to `pcibios_write_config_dword&#039;
arch/mips/pci/built-in.o: In function `pcibios_enable_device&#039;:
arch/mips/pci/built-in.o(.text+0x348): undefined reference to `pcibios_plat_dev_init&#039;</code></pre></div></blockquote></div><br /><p>Ok here&#039;s an update:</p><p>I managed to get rid of 2 of the 3 previous errors by editing /arch/mips/bcm47xx/broadcom/shared/linux_osl.c.</p><p>Here is the diff.</p><div class="codebox"><pre><code>80c80
&lt;               pcibios_read_config_dword(pdev-&gt;bus-&gt;number, pdev-&gt;devfn, offset, &amp;val);---
&gt;               pci_read_config_dword(pdev, offset, &amp;val);
101c101
&lt;               pcibios_write_config_dword(pdev-&gt;bus-&gt;number, pdev-&gt;devfn, offset, val);---
&gt;               pci_write_config_dword(pdev, offset, val);</code></pre></div><p>The other one I fixed with the following diff on arch/mips/pci/fixup-bcm47xx.c</p><div class="codebox"><pre><code>18a19,23
&gt; /* Do platform specific device initialization at pci_enable_device() time */
&gt; int pcibios_plat_dev_init(struct pci_dev *dev)
&gt; {
&gt;       return 0;
&gt; }</code></pre></div><br /><p>Could someone who knows about the kernel confirm that this is correct ? </p><p>So finally the kernel compiled and I got a vmlinux in to top directory. I copied this to /tftpboot , gziped it and set the router up to boot from the tftp file. Now it says the following:</p><div class="codebox"><pre><code>CFE&gt; boot -z -elf -tftp 192.168.1.10:vmlinux.gz
Loader:elf Filesys:tftp Dev:eth0 File:192.168.1.10:vmlinux.gz Options:(null)
***************************
****  MAC Client V1.0  ****
***************************
et0macaddr value :flag =0 value=00-09-5b-f7-0c-84
et1macaddr value :flag =0 value=00-09-5b-f7-0c-85
MAC exist at least one
system ethernet mac exist and not default....
Skip mac client process.....
Loading: 0x80001000/2924678 0x802cb086/97218 Entry at 0x8027d000
Closing network.
et0: link down
Starting program at 0x8027d000</code></pre></div><p>At which point I get nothing more on the terminal. I&#039;m thinking this might be because I haven&#039;t told it to use ttyS1 as a console. I tried booting with </p><div class="codebox"><pre><code>CFE&gt; boot -z -elf -tftp 192.168.1.10:vmlinux.gz  console=ttyS1,115200</code></pre></div><p>but exactly the same thing happened.</p><p>Until tomorrow...</p><p>Simon</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p4330">
				<div class="post-metadata">
					<div class="post-num">Post #55</div>
					<div class="post-author">Guest</div>
					<div class="post-datetime">
						3 Feb 2005, 03:15					</div>
				</div>
				<div class="post-content content">
					<p>This is the same behavius as when trying to boot the plain openwrt kernel, and i have got some unverified respones to this about that the wlan-card needed some type of delay during the init-phase of the router.</p><p>Still awaiting some more information and a working (non netgear) 2.4.x kernel that will be able to boot on the device.<br />Will post more information about this as soon as i get any.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p4331">
				<div class="post-metadata">
					<div class="post-num">Post #56</div>
					<div class="post-author">nomis52</div>
					<div class="post-datetime">
						3 Feb 2005, 04:35					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><p>This is the same behavius as when trying to boot the plain openwrt kernel, and i have got some unverified respones to this about that the wlan-card needed some type of delay during the init-phase of the router.</p></blockquote></div><p>Just as a follow up on this, I tried booting without the minipci card attached. I still get the same behaviour.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p4409">
				<div class="post-metadata">
					<div class="post-num">Post #57</div>
					<div class="post-author">Guest</div>
					<div class="post-datetime">
						6 Feb 2005, 02:14					</div>
				</div>
				<div class="post-content content">
					<p>Netgear have &quot;Changed&quot; the GPL-source for 1.4.1.8 !!!??</p><p>It looks like they disabled FreeSwan and something with Iptables (maybe afraid of Harald Welte...)</p><p>I found it when I noticed that the source was dated: 01/17/05&nbsp; &nbsp; &nbsp; 16:50:00, so I downloaded it and run a diff against my earlier copy of this version.</p><p>/Claes</p><p>PS They have not added the telnetd source...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p4434">
				<div class="post-metadata">
					<div class="post-num">Post #58</div>
					<div class="post-author">jolt</div>
					<div class="post-datetime">
						6 Feb 2005, 19:23					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><p>Just as a follow up on this, I tried booting without the minipci card attached. I still get the same behaviour.</p></blockquote></div><p>Try this patch:</p><div class="codebox"><pre><code>--- printk.c    26 Oct 2004 09:30:19 -0000      1.1.1.2
+++ printk.c    6 Feb 2005 17:32:39 -0000
@@ -463,8 +463,25 @@ static void call_console_drivers(unsigne
        _call_console_drivers(start_print, end, msg_level);
 }

+#include &lt;linux/serial_reg.h&gt;
+
+static void
+serialputc(char c)
+{
+#if 1
+       if (c == &#039;n&#039;)
+               serialputc(&#039;r&#039;);
+
+//#define SER_PORT1(reg)       (*((volatile unsigned char *)(0xbf800000+reg)))
+#define SER_PORT1(reg) (*((volatile unsigned char *)(0xb8000400+reg)))
+       while (!(SER_PORT1(UART_LSR) &amp; UART_LSR_THRE));
+       SER_PORT1(UART_TX) = c;
+#endif
+}
+
 static void emit_log_char(char c)
 {
+       serialputc(c);
        LOG_BUF(log_end) = c;
        log_end++;
        if (log_end - log_start &gt; log_buf_len)</code></pre></div><p>This will give you early printk output. You&#039;ll probably oops before the serial driver is loaded.</p><p>Best,<br />&nbsp; Florian</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p4452">
				<div class="post-metadata">
					<div class="post-num">Post #59</div>
					<div class="post-author">p0lar</div>
					<div class="post-datetime">
						7 Feb 2005, 08:02					</div>
				</div>
				<div class="post-content content">
					<p>Hi all,</p><p>I&#039;m relatively new to the router-hacking scene but have read more on the specs of this router and think it&#039;s almost got it spot-on from a spec PoV (for me).</p><p>I&#039;d like to use these as VPN endpoints so the Mini-PCI&nbsp; card is intriguing.&nbsp; Might compatibility with the Soekris engineering VPN1411 be possible?</p><p>As well, what about booting from a USB mass storage device?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p4510">
				<div class="post-metadata">
					<div class="post-num">Post #60</div>
					<div class="post-author">nomis52</div>
					<div class="post-datetime">
						9 Feb 2005, 06:43					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><p>This will give you early printk output. You&#039;ll probably oops before the serial driver is loaded.<br />Best,<br />&nbsp; Florian</p></blockquote></div><p>Thanks for the patch Florian. It seems to be crapping out in the do_earlyinitcalls(void) function in arch/mips/kernel.setup.c</p><p>I added a bunch of printk&#039;s which all work fine until the top of the&nbsp; </p><div class="codebox"><pre><code>for (call = start; call &lt; end; call++)</code></pre></div><p>&nbsp; loop.</p><p>After that it just starts printing symbols on the screen and then stops after a few seconds.</p><p>Looking around the source to me it looks like this loop is initialising the modules that have been linked into the kernel. So I&#039;m guessing if this is the case, then one of the modules is causing the problem ?</p><p>Florian: are you able to post a copy of your .config file so I can check mine against your&#039;s ?</p><br /><p>On another note, I&#039;ve just checked out a new copy from cvs so I&#039;m now using 2.6.11 . I&#039;m getting the following when I try and compile :</p><div class="codebox"><pre><code>  LD      init/built-in.o
  LD      .tmp_vmlinux1
arch/mips/mm/built-in.o(.init.text+0x3680): In function `ld_mmu_r4xx0&#039;:
: undefined reference to `read_c0_config7&#039;
make: *** [.tmp_vmlinux1] Error 1</code></pre></div><p>grepping the source shows that read_c0_config7 isn&#039;t defined anywhere ( I could only find references to read_c0_config[0..3] )</p><p>I&#039;ve attached a copy of my .config file in case it helps</p><p>Simon</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p4628">
				<div class="post-metadata">
					<div class="post-num">Post #61</div>
					<div class="post-author">Guest</div>
					<div class="post-datetime">
						14 Feb 2005, 21:32					</div>
				</div>
				<div class="post-content content">
					<p>Hi Everybody!</p><p>I managed to get telnet access to the router :-)</p><p>When you try to connect with telnet the router simply terminates the connection.</p><p>I already gained access to the root filesystem with the ftp root hack, and I created a samba share for /, so I can browse through it using my favourite tools.</p><p>All of the configuration seemed right for the telnetd, but it didn&#039;t work.</p><p>After a look at the binaries from /usr/bin/in.telnetd, I noticed the string &quot;/tmp/telnetenable&quot; somewhere in it.</p><p>Then I tried to create a dummy file /tmp/telnetenable, and suddenly it worked!</p><p>Somewhere in the process I found out, I had a problem in /etc/hosts.allow, since I changed the default subnet from 192.168.1.0 to 192.168.0.0.<br />So be careful to the change the subnet there if you reconfigure the router via the web interface, this setting is not changed automatically.&nbsp; </p><p>After a reboot you have to create /tmp/telnetenable again!</p><p>I hope this helps you folks :-)<br />&nbsp; &nbsp; <br />Martin, Vienna, Austria</p><p>P.S.&nbsp; I have a card reader attached with 128MB CF. It would be fine, if someone found out how to boot from there, or just move /tmp &amp; /var/log to the CF-Card and use the freed space for more RAM or the root fs. Then there would be plenty of space to install additional software like sshd, I won&#039;t like to remove the samba server or other stuff.<br />Has anyone looked at the open source code from the ASUS WL-500G Spacelink Wireless Home Gateway? Is it compatible with the Netgear firmware? I&#039;d like to have the USB print server on the Netgear :-)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p4718">
				<div class="post-metadata">
					<div class="post-num">Post #62</div>
					<div class="post-author">Guest</div>
					<div class="post-datetime">
						19 Feb 2005, 02:27					</div>
				</div>
				<div class="post-content content">
					<p>Maybe time to start to &quot;organize&quot; some Wiki-pages on this site!?</p><p>If we look on the counter of this thread, it says (today) over 8000 readings and if we could give more info/ideas of what&#039;s possible to do with the 634U-thing, maybe a lot of others could/would contribute....</p><p>My sugestion is that we should start to organize facts and info on the Wiki at this site.</p><br /><p><strong> Example of documents to write:</strong></p><p>How to hack through the webinterface (../../ for FTP and SMB)</p><p>How to hack through a config-save (*)</p><p>How to extract a image-file (*)</p><p>How to get telnet running (1.4.1.8 img got one)</p><p>How to add and build a dropbear SSH-server</p><p>How to build a (or 2) serial interface(s) with info on circuits possible to use</p><p>How to setup up a uclib-toolchain (what choices when make...)</p><p>How to setup up a hndtools-mipsel toolchain (and build the Netgear source)</p><p>Howto emulate &quot;boot wait&quot; with STARTUP env</p><p>How to build and modify a Netgear &quot;origanal&quot; stuff</p><p>How to patch and get a diff of a current 2.6-kernel</p><p>How to boot or use storage on a USB-device</p><p>How to do &quot;nice&quot; things with the Madwifi HAL, like boosting </p><br /><p><strong>Some basic tutorials about:</strong></p><p>CRC32 checksums (*)</p><p>JFFS2 filesystem and mounting a &quot;loopback&quot; howto (on Linux) (*)</p><p>LRP-packages</p><p>Minix filesystem and mounting it &quot;loopback&quot; howto (on Linux) (*)</p><br /><p><strong>Other stuff like:</strong></p><p>Info about GPL-violations done by Netgear with this box</p><p>Links to information that&#039;s useable</p><p>Ideas about what we could do with the box</p><p>Scoreboard (like Netfilter project had in the begining)</p><br /><br /><p>What I sugesst is that it&#039;s possible to cooperate a bit more on this!</p><p>And Jolt, do you realy got your 634 running with a 2.6-kernel? (Everybody else looks to have problems)</p><p>If this place is wrong I have some machines with 10Mbit connection where we could put the Wiki on (for example a Sparc64 running OpenBSD -current and Python 2.3.4 installed or some Intel machine with Gentoo)</p><p>As an alternative I could give people &quot;accounts&quot; to a chrooted apache enviroment with some quoata and register a domain for it.</p><p>I wont to go ahead a bit speedier then it&#039;s happening here right now, and I have no resources (time) to do/investigate all things by myself! So, lets share and investigate together...</p><br /><p>What do you think?</p><br /><p>/Claes</p><p>PS Excuse me fpr my bad spelling, clock is 01:35 and I had some glases of wine this evening after a long workday and my mother tongue is not English!</p><p>(*) = Stuff that I like to fill in when I have time (in a near future)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p4731">
				<div class="post-metadata">
					<div class="post-num">Post #63</div>
					<div class="post-author">nomis52</div>
					<div class="post-datetime">
						20 Feb 2005, 14:24					</div>
				</div>
				<div class="post-content content">
					<p>Hi Claes,</p><p>I&#039;ve started documenting what I&#039;ve been doing here: <a href="http://www.nomis52.net/?section=projects&amp;sect2=netgear&amp;page=about">http://www.nomis52.net/?section=project … page=about</a></p><p>Hopefully that can address a few of the items on the list. </p><p>Some sections aren&#039;t filled in yet, but I&#039;ll try and get around to it as soon as I can.</p><p>After talking to Jolt I&#039;ve also got a 2.6 kernel running. At the moment I&#039;m trying to sort out why my USB devices aren&#039;t working.</p><p>Cheers,</p><p>Simon</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p4744">
				<div class="post-metadata">
					<div class="post-num">Post #64</div>
					<div class="post-author">Guest</div>
					<div class="post-datetime">
						20 Feb 2005, 22:40					</div>
				</div>
				<div class="post-content content">
					<p>Hi Simon,</p><p>Your newly added &quot;documention&quot; (and style) looked good!</p><p>I&#039;m not sure if I&#039;m going to build the serial interface. I have found MAX3180E/MAX3182E which not need any capacitors (I think). But is very very small for an amataur to solder. Anybody who know any other interface chip which don&#039;t need any &quot;extras&quot; (and board)?</p><p>An idea of how to changing the &quot;SETUP&quot; parameter for the &quot;Boot-process&quot; to be tftp-aware: If you don&#039;t have the CFE-shell (read: serial console), you could dd /dev/mtdblock4 to your USB-storage and modify it before you put it back with dd.</p><p>I&#039;m also thinking of small tarball (or ZIP-file) to upload with smb to get ssh (dropbear) and/or telnet shell after root hacked in Samba. I install it through add cronjob in /etc/crontab (which reloads &quot;automagicly&quot;). With this &quot;concept&quot; people need:<br />1. Webbrowser to do the /../../ hack with the share.<br />2. A machine with smb (almost every platform has it) to upload the extras to get a shell.<br />You need to edit /etc/samba/smb.conf (with FTP) to give the share / as path before you could do #2. I need to figure out how to get the box to get the change in smb.conf permanent.... I did it through hacking of config-save file (which needs some tools and setup). Anybody with some ideas about above?</p><p>/Claes</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p4847">
				<div class="post-metadata">
					<div class="post-num">Post #65</div>
					<div class="post-author">Guest</div>
					<div class="post-datetime">
						23 Feb 2005, 09:59					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><p>=&quot;I need to figure out how to get the box to get the change in smb.conf permanent.... I did it through hacking of config-save file (which needs some tools and setup). Anybody with some ideas about above?&quot;</p></blockquote></div><p>Excuse me if I am missing something here, but I just ran the command &#039;save-config&#039;, which essentially saves everything in /config/config.list, which happends to include that smb.conf. After a reboot, it turns up <strong>with</strong> the changes.</p><p>/Pjotrek :idea:</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p4987">
				<div class="post-metadata">
					<div class="post-num">Post #66</div>
					<div class="post-author">pjotrek</div>
					<div class="post-datetime">
						28 Feb 2005, 21:39					</div>
				</div>
				<div class="post-content content">
					<p><strong>Automagic installation of scripts &amp; binaries</strong></p><p>Pondering on the consequences of my last post â€“ 23/2 â€“ I decided this could be an opening into installing scripts &amp; binaries automagically after a reboot. To make a long story short, I found that opening.</p><p>The script <span style="color: green">/bin/save-config </span>saves all files in <span style="color: green">/config/config.list </span>to make them appear again after a reboot. config.list contains configuration files, no scripts. But, it contains <span style="color: green">/etc/cron.d/nfqueue</span>. nfqueue is included in cronâ€™s tabs if the option â€˜<span style="color: blue">Keyword Blocking</span>â€™ is selected to â€˜<span style="color: blue">Always</span>â€™ in â€˜<span style="color: blue">Block Sites</span>â€™ of the HTML Router Configurator.</p><p>So: simply add an extra line into the <span style="color: green">/etc/cron.d/nfqueue</span>, to run a script periodically, run save-config, add a few scripts here and there â€“ and we are there! We can have that script run every minute and do something useful, for instance, first time it is run, to install all our extra goodies. Automagically again and again, after each reboot.</p><p>I made a shadow filesystem on the USB-drive, running everything from there, including Idcâ€™s DropBear SSH and alternate BusyBox. All put into action by that cron entry.</p><p>I also had some problems with the router not renewing itâ€™s DHCP lease, so I added a script wanlease.sh to fix that. (Maybe someone knows what should <strong>really</strong> be done to fix that?) I also noted on several occasions (not always) that 5 or 6 upnpd processes started growing, up to 10 times the original footprint in less than an hour. Each time they reached that size, the router stopped working.<br />Since it seems to be working OK without them, I also added code to wanlease.sh to kill them. Since then I have <strong>much</strong> better stability in my router.<br />Plus all the other funâ€¦<br />Download my freeride and see if it can do something for you, too.</p><p>If wanted/needed, I can add a step-by-step description.</p><p>Included: tar of the freeride.<br />P.S. All attributes in the USB fs are 777, since I am running from a USB Flash memory only allowing fat32.</p><p>/Pjotrek :idea:</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p5022">
				<div class="post-metadata">
					<div class="post-num">Post #67</div>
					<div class="post-author">MMCM</div>
					<div class="post-datetime">
						2 Mar 2005, 14:56					</div>
				</div>
				<div class="post-content content">
					<p>Hi Pjotrek!</p><p>Your freeride package inspired me a lot :-)</p><p>There are some points of improvement though:<br />- Your script cannot install the new busybox automatically, when I tried it, it failed running it with &quot;<span style="color: green">--install</span>&quot;, trying to create hard links, which are not allowed to span different file system. It works if you copy it to the rootfs first. <br />BUT: I figured out, you can tell it to use symbolic links by specifying &quot;<span style="color: green">--install -s</span>&quot;, at least it worked for me :-)<br /><span style="color: red">When I ran &quot;ps&quot; of the new busybox, the &quot;Command&quot; column contained only garbage. Anybody else with this problem?</span><br />- have you tried to modify <span style="color: green">/config/config.list</span> to include any other file? Then you could create new scripts. You would have to include <span style="color: green">config/config.list </span>itself. I added serveral files modified by me to config.list, and the newly saved netgear.cfg seemed to contain a lot more data. I never tried to reboot the device, though.<br />- I extended your fixafterboot.sh to copy a whole directory tree to the root fs, so you can bulk replace patech or add new files, e. g. I patched in.telnetd to test the existence of &quot;<span style="color: green">/bin</span>&quot; instead of <span style="color: green">&quot;/tmp/telnetenable</span>&quot;.</p><p>My intention is to move as much as possible to the USB drive, to get free RAM for additional features, like a web server, vpn server, print server,...<br /><span style="color: green">/var/log </span>and <span style="color: green">/tmp </span>are good candidates for this.<br />I tried to move all files from <span style="color: green">/var/log </span>to <span style="color: green">/share/partition1/fs/var/log </span>and then wanted to umount the tmpfs and create a symbolic link to the new folder, but that didn&#039;t work. umount returned &quot;device busy&quot; or so.<br />When I used mount with the bind option, I could replace the <span style="color: green">/var/log </span>folder, but the tmpfs still exists :-(<br />Same on <span style="color: green">/tmp</span>.<br />Are there better ways to do that?</p><p>My current status:</p><p><span style="color: blue"># free<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; total&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;used&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;free&nbsp; &nbsp; &nbsp; &nbsp;shared&nbsp; &nbsp; &nbsp; buffers<br />&nbsp; Mem:&nbsp; &nbsp; &nbsp; &nbsp; 30452&nbsp; &nbsp; &nbsp; &nbsp; 27180&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3272&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 324<br /> Swap:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />Total:&nbsp; &nbsp; &nbsp; &nbsp; 30452&nbsp; &nbsp; &nbsp; &nbsp; 27180&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3272</span></p><p><span style="color: blue"># mount<br />rootfs on / type rootfs (rw)<br />/dev/root on / type tmpfs (rw)<br />/proc on /proc type proc (rw)<br />tmpfs on /tmp type tmpfs (rw)<br />tmpfs on /var/log type tmpfs (rw)<br />usbfs on /proc/bus/usb type usbfs (rw)<br />/dev/sda1 on /share/partition1 type vfat (rw)<br />/dev/sda1 on /tmp type vfat (rw)<br />/dev/sda1 on /var/log type vfat (rw)</span></p><p>Has anybody tried to use <span style="color: blue">pivot_root </span>to replace the whole rootfs? Does it only work at the init stage, or can it be used afterwards?<br />It would be fine to move/copy the whole rootfs fs to the USB drive, switch to it and destroy the original fs in RAM.</p><p>How long would a CF Card withstand the continous changes and writes to log files? Maybe it would be better to use a microdrive or real hard disk?</p><p>I think, it would be possible to format the CF/Disk with ext2 or ext3 fs to enable permissions. Maybe one could create a swapper area too with mkswap and swapon?</p><p>Many things to try :-)</p><p>Martin</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p5023">
				<div class="post-metadata">
					<div class="post-num">Post #68</div>
					<div class="post-author">pjotrek</div>
					<div class="post-datetime">
						2 Mar 2005, 17:17					</div>
				</div>
				<div class="post-content content">
					<p>Hi Martin,<br />Happy that you could use &amp; build on my ideas.</p><div class="quotebox"><blockquote><p>- have you tried to modify <span style="color: green">/config/config.list</span> to include any other file? Then you could create new scripts. You would have to include <span style="color: green">config/config.list </span>itself. I added serveral files modified by me to config.list, and the newly saved netgear.cfg seemed to contain a lot more data. I never tried to reboot the device, though.</p></blockquote></div><p>Yes, I have tried that. It does not work - config.list is gotten from the preloaded image every reboot, not from the saved config. So, even if you modify it, that does not count at next reboot.</p><div class="quotebox"><blockquote><p>My intention is to move as much as possible to the USB drive, to get free RAM for additional features, like a web server, vpn server, print server,...</p></blockquote></div><p>Sounds interesting, I want that too. But first I will try your ideas to see where that leads me. Must leave now, lets communicate later!</p><p>/Pjotrek&nbsp; <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p5026">
				<div class="post-metadata">
					<div class="post-num">Post #69</div>
					<div class="post-author">MMCM</div>
					<div class="post-datetime">
						3 Mar 2005, 01:50					</div>
				</div>
				<div class="post-content content">
					<p>Hi Pjotrek!</p><p>I rebooted the router with &#039;shutdown -r now&#039;, and all modified files I added to config.list reappeared correctly :-)<br />Note: I included config/config.list in the file itself.</p><p>Maybe you did&#039;t run save-config to store the changed settings before reboot?</p><p>Or does &#039;shutdown -r now&#039; behave differenty than power off? I don&#039;t think so, all my redirected tmp and log are gone...</p><p>P.S. Did anybody know?<br /><a href="http://192.168.1.1/cgi-bin/plrh_log.html">http://192.168.1.1/cgi-bin/plrh_log.html</a><br />;-)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p5036">
				<div class="post-metadata">
					<div class="post-num">Post #70</div>
					<div class="post-author">pjotrek</div>
					<div class="post-datetime">
						3 Mar 2005, 10:04					</div>
				</div>
				<div class="post-content content">
					<p>Hi MMCM,<br />I am glad it worked for you - I must have missed something :oops: . But cooperation is what all these communities are there for. Together we achieve more than the sum of of our individual work. <br />I will try some more things in the weekend - I will post the proceedings.<br />I suggest you post your scripts, for anybody to try and&nbsp; play with.<br />/Pjotrek [|-:{&gt;</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p5038">
				<div class="post-metadata">
					<div class="post-num">Post #71</div>
					<div class="post-author">nomis52</div>
					<div class="post-datetime">
						3 Mar 2005, 14:46					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><p>Hi Simon,</p><p>An idea of how to changing the &quot;SETUP&quot; parameter for the &quot;Boot-process&quot; to be tftp-aware: If you don&#039;t have the CFE-shell (read: serial console), you could dd /dev/mtdblock4 to your USB-storage and modify it before you put it back with dd.</p><p>/Claes</p></blockquote></div><p>I&#039;ve confirmed this works. I don&#039;t know the format of the nvram but running strings on the image shows the nvram variables.</p><p>If anyone wants a copy of an image let me know and I&#039;ll post it on the web.</p><p>Cheers,</p><p>Simon</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p5185">
				<div class="post-metadata">
					<div class="post-num">Post #72</div>
					<div class="post-author">jason</div>
					<div class="post-datetime">
						10 Mar 2005, 07:09					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><p>Hi Claes,</p><p>I&#039;ve started documenting what I&#039;ve been doing here: <a href="http://www.nomis52.net/?section=projects&amp;sect2=netgear&amp;page=about">http://www.nomis52.net/?section=project … page=about</a></p><p>Hopefully that can address a few of the items on the list. </p><p>Some sections aren&#039;t filled in yet, but I&#039;ll try and get around to it as soon as I can.</p><p>After talking to Jolt I&#039;ve also got a 2.6 kernel running. At the moment I&#039;m trying to sort out why my USB devices aren&#039;t working.</p><p>Cheers,</p><p>Simon</p></blockquote></div><p>Hi, Simon,</p><p>I am trying to build a 2.6.x kernel for WGT634U according to your steps in<br />this thread. I have successfully created a toolchain from<br />buildroot-0.9.27.tar.gz and created a vmlinux ELF file. However, after<br />setting the router to boot from the tftp file &#039;vmlinux.gz&#039;, there is nothing<br />on the terminal. Even with jolt&#039;s patch of printk.c, I can see only scrambled<br />messages on the terminal (terminal setting is still 115200,8N1, right?)<br />Since you have got a 2.6 kernel running, is it possible for you to share<br />your 2.6.x kernel source and the corresponding .config and vmlinux.gz with us?</p><p>Best regards,</p><p>Jason</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p5187">
				<div class="post-metadata">
					<div class="post-num">Post #73</div>
					<div class="post-author">jolt</div>
					<div class="post-datetime">
						10 Mar 2005, 10:01					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>unfortunately my patch is incomplete. Open the file:&nbsp; arch / mips / bcm47xx / setup.c and serach for sb_serial_init. Comment out this line.</p><p>Best,<br />&nbsp; Florian</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p5324">
				<div class="post-metadata">
					<div class="post-num">Post #74</div>
					<div class="post-author">Guest</div>
					<div class="post-datetime">
						16 Mar 2005, 05:47					</div>
				</div>
				<div class="post-content content">
					<p>DS275&nbsp; but it&#039;s hard to find, even Dallas SemiConductors website has a 1 week lead time on it.<br /></p><div class="quotebox"><blockquote><p>Hi Simon,</p><p>Your newly added &quot;documention&quot; (and style) looked good!</p><p>I&#039;m not sure if I&#039;m going to build the serial interface. I have found MAX3180E/MAX3182E which not need any capacitors (I think). But is very very small for an amataur to solder. Anybody who know any other interface chip which don&#039;t need any &quot;extras&quot; (and board)?</p><p>An idea of how to changing the &quot;SETUP&quot; parameter for the &quot;Boot-process&quot; to be tftp-aware: If you don&#039;t have the CFE-shell (read: serial console), you could dd /dev/mtdblock4 to your USB-storage and modify it before you put it back with dd.</p><p>I&#039;m also thinking of small tarball (or ZIP-file) to upload with smb to get ssh (dropbear) and/or telnet shell after root hacked in Samba. I install it through add cronjob in /etc/crontab (which reloads &quot;automagicly&quot;). With this &quot;concept&quot; people need:<br />1. Webbrowser to do the /../../ hack with the share.<br />2. A machine with smb (almost every platform has it) to upload the extras to get a shell.<br />You need to edit /etc/samba/smb.conf (with FTP) to give the share / as path before you could do #2. I need to figure out how to get the box to get the change in smb.conf permanent.... I did it through hacking of config-save file (which needs some tools and setup). Anybody with some ideas about above?</p><p>/Claes</p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p5325">
				<div class="post-metadata">
					<div class="post-num">Post #75</div>
					<div class="post-author">Guest</div>
					<div class="post-datetime">
						16 Mar 2005, 06:03					</div>
				</div>
				<div class="post-content content">
					<p>DS275&nbsp; but it&#039;s hard to find, even Dallas SemiConductors website has a 1 week lead time on it.<br /></p><div class="quotebox"><blockquote><p>Hi Simon,</p><p>Your newly added &quot;documention&quot; (and style) looked good!</p><p>I&#039;m not sure if I&#039;m going to build the serial interface. I have found MAX3180E/MAX3182E which not need any capacitors (I think). But is very very small for an amataur to solder. Anybody who know any other interface chip which don&#039;t need any &quot;extras&quot; (and board)?</p><p>An idea of how to changing the &quot;SETUP&quot; parameter for the &quot;Boot-process&quot; to be tftp-aware: If you don&#039;t have the CFE-shell (read: serial console), you could dd /dev/mtdblock4 to your USB-storage and modify it before you put it back with dd.</p><p>I&#039;m also thinking of small tarball (or ZIP-file) to upload with smb to get ssh (dropbear) and/or telnet shell after root hacked in Samba. I install it through add cronjob in /etc/crontab (which reloads &quot;automagicly&quot;). With this &quot;concept&quot; people need:<br />1. Webbrowser to do the /../../ hack with the share.<br />2. A machine with smb (almost every platform has it) to upload the extras to get a shell.<br />You need to edit /etc/samba/smb.conf (with FTP) to give the share / as path before you could do #2. I need to figure out how to get the box to get the change in smb.conf permanent.... I did it through hacking of config-save file (which needs some tools and setup). Anybody with some ideas about above?</p><p>/Claes</p></blockquote></div>									</div>
			</article>

			
		
						<div class="notice">
				<p>Sorry, posts 76 to 75 are missing from our archive.</p>
			</div>
		
		
	
	<div class="pagination"><div class="pagination-number">Page 3 of 9</div><nav><ul><li><a href="viewtopic.php%3Fid=33&amp;p=1.html">1</a></li><li><a href="viewtopic.php%3Fid=33&amp;p=2.html">2</a></li><li class="pagination-current"><span>3</span></li><li><a href="viewtopic.php%3Fid=33&amp;p=4.html">4</a></li><li><a href="viewtopic.php%3Fid=33&amp;p=5.html">5</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=33&amp;p=9.html">9</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>