<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> init.d script appears to have bricked my router.</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 16 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p94326">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">bmc</div>
					<div class="post-datetime">
						15 Sep 2009, 15:17					</div>
				</div>
				<div class="post-content content">
					<p>Hi, </p><p>I have a simple application that I need to run at startup so I wrote a sysV script for it and enabled it with the priority S=65 (this has worked fine for other applications I&#039;ve need to run at startup). I have confirmed that the application runs perfectly when started from a terminal, but it doesn&#039;t work when I include it at this stage in the startup process (I think something affects the file IO that it relies on as far as I can tell). </p><p>So I tried starting the script later by increasing the start value to S=100, after a reboot I lost all ability to communicate with the router (doesn&#039;t even respond to pings). Is this known behaviour, shouldn&#039;t you ever set the start value to over 99? I have read a number of guides and howtos on this area and none of them mention this problem. Does anyone have a suggestion where in the startup process I should run my application to ensure it works, I&#039;m a little worried about experimenting with this now in case I lock myself out of any more routers.</p><p>Cheers.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p94329">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						15 Sep 2009, 15:44					</div>
				</div>
				<div class="post-content content">
					<p>Hi.</p><p>Due to the nature of alphabetical (not numerical) sorting, 100 will be the *first* script that is executed. Depending on the commands you have in your script, it might break things badly. You can, however, try to enter failsafe mode, connect with telnet, run mount_root and fix the script.</p><p>Regards,<br />JoW</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p94332">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">cptdondo</div>
					<div class="post-datetime">
						15 Sep 2009, 15:46					</div>
				</div>
				<div class="post-content content">
					<p>Not sure how that could happen unless somehow 100 is running ahead of everything else and blocking.&nbsp; But you still should be able to go into recovery mode and reflash.&nbsp; However in the future:</p><p>Write a run once script:&nbsp; before you execute any new thing, check to see if it&#039;s been run before.&nbsp; If not, then write a flag in /etc before you start the app and run it.&nbsp; If the flag in /etc exists, don&#039;t run it.&nbsp; That way, you can run your app once, if it bricks, powercycle, and the next time it won&#039;t run.</p><p>Add a long delay:&nbsp; put a sleep 300 in the startup before the app runs.&nbsp; That gives you time to ssh in to the ap and see what happens when the app runs.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p94353">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">bmc</div>
					<div class="post-datetime">
						15 Sep 2009, 18:34					</div>
				</div>
				<div class="post-content content">
					<p>Thanks guys, I guess I just let my guard down because I&#039;d been successful in the past, I&#039;ll make sure I&#039;m more careful in future.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p94354">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">cptdondo</div>
					<div class="post-datetime">
						15 Sep 2009, 18:44					</div>
				</div>
				<div class="post-content content">
					<p>Heh.&nbsp; I&#039;m an epxert at bricking these things; I&#039;ve learned the hard way.&nbsp; I&#039;ve bricked about 3 routers so far; been able to recover all of them via variously painful ways (jtag and such.)</p><p>Far easier not to brick them in the first place.&nbsp; Although the newer routers seem to be more brick proof than the old ones. The trendnet BRP652 is especially nice; if you hose the install it automagically goes into failsafe - which has a web interface!&nbsp; Nice....</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>