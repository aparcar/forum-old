<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> How restore my router</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 28 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p318662">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">first-leon</div>
					<div class="post-datetime">
						8 Apr 2016, 12:09					</div>
				</div>
				<div class="post-content content">
					<p>Hello!<br />My router is not work <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>I have <a href="https://wiki.openwrt.org/toh/unbranded/a5-v11">https://wiki.openwrt.org/toh/unbranded/a5-v11</a><br />I build new firmwware in this script:</p><div class="codebox"><pre><code>PROFILE=&quot;A5-V11&quot;
PACKAGES=&quot;fdisk e2fsprogs openvpn-polarssl wpa-supplicant-mini kmod-usb2 kmod-fs-ext4 kmod-usb-ohci kmod-usb-storage block-mount \
-luci -dnsmasq -kmod-gpio-button-hotplug -kmod-leds-gpio -firewall -luci-app-firewall -iptables -luci-proto-ppp -ppp \
-ppp-mod-pppoe -kmod-ppp -kmod-pppoe -kmod-pppox -hostapd-common -kmod-ip6tables -ip6tables -kmod-ipv6 -libip6tc -odhcp6c -odhcpd &quot;
J=4
make -j$J image PROFILE=&quot;$PROFILE&quot; PACKAGES=&quot;$PACKAGES&quot; FILES=&quot;FILES&quot; &amp;&amp; echo firmware is here: &quot;$(pwd)/bin/ramips/openwrt-15.05.1-ramips-rt305x-a5-v11-squashfs-factory.bin&quot;</code></pre></div><p>And run:<br />mtd -r write my_firmware-squashfs-factory.bin firmware</p><p>And router not started.<br />I connect serial port and connect to console:<br /></p><div class="codebox"><pre><code>U-Boot 1.1.7 (Dec 13 2011 - 13:49:42)
Board: Ralink APSoC DRAM:  16 MB
relocate_code Pointer at: 80fb4000
******************************
Software System Reset Occurred
******************************
spi_wait_nsec: 42 
spi device id: 7f 9d 46 7f 9d (9d467f9d)
Warning: un-recognized chip ID, please update bootloader!
raspi_read: from:30000 len:1000 
.raspi_read: from:30000 len:1000 
.============================================ 
Ralink UBoot Version: 3.6.0.0
-------------------------------------------- 
ASIC 5350_MP (Port5&lt;-&gt;None)
DRAM_CONF_FROM: Boot-Strapping 
DRAM_TYPE: SDRAM 
DRAM_SIZE: 128 Mbits
DRAM_WIDTH: 16 bits
DRAM_TOTAL_WIDTH: 16 bits
TOTAL_MEMORY_SIZE: 16 MBytes
Flash component: SPI Flash
Date:Dec 13 2011  Time:13:49:42
============================================ 
icache: sets:256, ways:4, linesz:32 ,total:32768
dcache: sets:128, ways:4, linesz:32 ,total:16384 
 ##### The CPU freq = 360 MHZ #### 
 estimate memory size =16 Mbytes
raspi_read: from:40028 len:6 
.
raspi_read: from:0 len:30004 
....*************Is_update = 0 plat = 1**************
Please choose the operation: 
   1: Load system code to SDRAM via TFTP. 
   2: Load system code then write to Flash via TFTP. 
   3: Boot system code via Flash (default).
   4: Entr boot command line interface.
   7: Load Boot Loader code then write to Flash via Serial. 
   9: Load Boot Loader code then write to Flash via TFTP. 
You choosed 3

\0x08\0x08\0x08 0 

3: System Boot system code via Flash.

## Booting image at bc050000 ...
raspi_read: from:50000 len:40 
.Bad Magic Number,52334732 </code></pre></div><p>Where i press 2 for &quot;Load system code then write to Flash via TFTP. &quot; router write: &quot;Operation terminated&quot;</p><p>This log from console:</p><div class="codebox"><pre><code>U-Boot 1.1.7 (Dec 13 2011 - 13:49:42)
Board: Ralink APSoC DRAM:  16 MB
relocate_code Pointer at: 80fb4000
spi_wait_nsec: 42 
spi device id: 7f 9d 46 7f 9d (9d467f9d)
Warning: un-recognized chip ID, please update bootloader!
raspi_read: from:30000 len:1000 
.raspi_read: from:30000 len:1000 
.============================================ 
Ralink UBoot Version: 3.6.0.0
-------------------------------------------- 
ASIC 5350_MP (Port5&lt;-&gt;None)
DRAM_CONF_FROM: Boot-Strapping 
DRAM_TYPE: SDRAM 
DRAM_SIZE: 128 Mbits
DRAM_WIDTH: 16 bits
DRAM_TOTAL_WIDTH: 16 bits
TOTAL_MEMORY_SIZE: 16 MBytes
Flash component: SPI Flash
Date:Dec 13 2011  Time:13:49:42
============================================ 
icache: sets:256, ways:4, linesz:32 ,total:32768
dcache: sets:128, ways:4, linesz:32 ,total:16384 
 ##### The CPU freq = 360 MHZ #### 
 estimate memory size =16 Mbytes
raspi_read: from:40028 len:6 
.
raspi_read: from:0 len:30004 
....*************Is_update = 0 plat = 1**************
Please choose the operation: 
   1: Load system code to SDRAM via TFTP. 
   2: Load system code then write to Flash via TFTP. 
   3: Boot system code via Flash (default).
   4: Entr boot command line interface.
   7: Load Boot Loader code then write to Flash via Serial. 
   9: Load Boot Loader code then write to Flash via TFTP. 

You choosed 2

\0x08\0x08\0x08 0 

2: System Load Linux Kernel then write to Flash via TFTP. 

 Warning!! Erase Linux in Flash then burn new one. Are you sure?(Y/N)

 Operation terminated</code></pre></div><p>And i sure - my router have 32MB RAM (but UBOOT write 16MB RAM).</p><p>I know one method for restore my router: rewrite SPI flash (<a href="http://my-embedded.blogspot.ru/2013/12/mini-4g-router-rt5350f.html">http://my-embedded.blogspot.ru/2013/12/ â€¦ 5350f.html</a>).</p><p>Are there any other solutions to my problem?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p318984">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">first-leon</div>
					<div class="post-datetime">
						10 Apr 2016, 12:24					</div>
				</div>
				<div class="post-content content">
					<p>Hello!<br />I like my router. Help me please!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p318994">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">bolvan</div>
					<div class="post-datetime">
						10 Apr 2016, 14:00					</div>
				</div>
				<div class="post-content content">
					<p>Have you tried changing terminal program or terminal type ?<br />Program can add terminal escape characters or wrong end-of-line terminator and u-boot can treat it as not &quot;Y&quot;.<br />&quot;\0x08\0x08\0x08 0&quot;&nbsp; &lt;= this line likely means your program even cannot handle backspace<br />The one I&#039;ve always used w/o problems is putty<br />If it does not help change stop bits, parity and other parameters except baudrate</p>											<p class="post-edited">(Last edited by <strong>bolvan</strong> on 10 Apr 2016, 14:09)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p319276">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">first-leon</div>
					<div class="post-datetime">
						12 Apr 2016, 11:45					</div>
				</div>
				<div class="post-content content">
					<p>Hello!<br />I restore my router with this post <a href="http://mysku.ru/blog/ebay/37023.html#comment1194728">http://mysku.ru/blog/ebay/37023.html#comment1194728</a><br />Use utility onekeyRouterUpgrade_7.31.exe and firmware openwrt-a5-v11-lite-310-MW2015-03-14-factory.bin</p><p>Thank you!</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>