<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> try to seperate LAN, Wifi and DMZ</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 30 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p72346">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">jonje611</div>
					<div class="post-datetime">
						16 Aug 2008, 00:19					</div>
				</div>
				<div class="post-content content">
					<p>Hello!</p><p>I used the guide <a href="http://forum.openwrt.org/viewtopic.php?id=12452">http://forum.openwrt.org/viewtopic.php?id=12452</a> on this forum to seperate the LAN and WIFI ridge to LAN, DMZ and WIFI ports on a wrt GL router.</p><p>Seperating the diferent interface i easy, but the routing is not working properly and the firewall is not forwarding the clients requests from the internal network to the WAN. When disabling the firawall it is possibly to ping external sites from the router but not from internal network.</p><p>Please if someone could help me.</p><p>/J</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p72354">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">jonje611</div>
					<div class="post-datetime">
						16 Aug 2008, 10:03					</div>
				</div>
				<div class="post-content content">
					<p>Hi </p><p>I get a error message when running shorewall start i don&#039;t now what to do.</p><p>root@OpenWrt:~# shorewall start<br />/sbin/shorewall: /sbin/shorewall: 177: hostname: not found<br />Compiling...<br />Initializing...<br />Determining Zones...<br />&nbsp; &nbsp;IPv4 Zones: wan loc eth dmz wifi<br />&nbsp; &nbsp;Firewall Zone: fw<br />Validating interfaces file...<br />Validating hosts file...<br />Pre-processing Actions...<br />&nbsp; &nbsp;Pre-processing /usr/share/shorewall/action.Drop...<br />&nbsp; &nbsp;Pre-processing /usr/share/shorewall/action.Reject...<br />Validating Policy file...<br />Determining Hosts in Zones...<br />&nbsp; &nbsp;wan Zone: eth0.1:0.0.0.0/0<br />&nbsp; &nbsp;eth Zone: eth0.0:172.16.10.0/24<br />&nbsp; &nbsp;dmz Zone: eth0.2:172.16.30.0/24<br />&nbsp; &nbsp;wifi Zone: wl0:172.16.20.0/24<br />&nbsp; &nbsp;loc Zone: eth0.0:0.0.0.0/0 eth0.2:0.0.0.0/0 wl0:0.0.0.0/0<br />Deleting user chains...<br />Compiling /etc/shorewall/routestopped ...<br />Creating Interface Chains...<br />Compiling Common Rules<br />Adding Anti-smurf Rules<br />Adding rules for DHCP<br />Enabling RFC1918 Filtering<br />Compiling TCP Flags checking...<br />Compiling Kernel Route Filtering...<br />Compiling Martian Logging...<br />Compiling IP Forwarding...<br />Compiling /etc/shorewall/rules...<br />Compiling Actions...<br />Compiling /usr/share/shorewall/action.Drop for Chain Drop...<br />Compiling /usr/share/shorewall/action.Reject for Chain Reject...<br />Compiling /etc/shorewall/policy...<br />Compiling Masquerading/SNAT<br />Compiling Traffic Control Rules...<br />Compiling Rule Activation...<br />Shorewall configuration compiled to /var/lib/shorewall/.start<br />Giving up on lock file /var/lib/shorewall/lock<br />Processing /etc/shorewall/params ...<br />Starting Shorewall....<br />Initializing...<br />Processing /etc/shorewall/init ...<br />Clearing Traffic Control/QOS<br />/var/lib/shorewall/.start: /var/lib/shorewall/.start: 1399: ip: not found<br />Deleting user chains...<br />Processing /etc/shorewall/continue ...<br />Enabling Loopback and DNS Lookups<br />Creating Interface Chains...<br />Setting up SMURF control...<br />Processing /etc/shorewall/initdone ...<br />Setting up Black List...<br />Adding Anti-smurf Jumps...<br />Setting up rules for DHCP...<br />Setting up RFC1918 Filtering...<br />Setting up TCP Flags checking...<br />Setting up ARP filtering...<br />Setting up Route Filtering...<br />&nbsp; &nbsp;WARNING: Cannot set route filtering on wl0<br />/var/lib/shorewall/.start: /var/lib/shorewall/.start: 1399: ip: not found<br />Setting up Martian Logging...<br />&nbsp; &nbsp;WARNING: Cannot set Martian logging on wl0<br />Setting up Accept Source Routing...<br />IP Forwarding Enabled<br />Setting up SYN Flood Protection...<br />Setting up Rules...<br />Setting up Actions...<br />Creating action chain Drop<br />Creating action chain Reject<br />Creating action chain dropBcast<br />Creating action chain dropInvalid<br />Creating action chain dropNotSyn<br />Applying Policies...<br />Setting up Masquerading/SNAT...<br />&nbsp; &nbsp;ERROR: Unable to determine the routes through interface &quot;eth0.1&quot;<br />Processing /etc/shorewall/stop ...<br />/var/lib/shorewall/.start: /var/lib/shorewall/.start: 1399: ip: not found<br />&nbsp; &nbsp;ERROR: Command &quot;ip link list&quot; Failed<br />/var/lib/shorewall/.start: /var/lib/shorewall/.start: 1399: ip: not found<br />&nbsp; &nbsp;ERROR: Command &quot;ip link list&quot; Failed</p><br /><p>My routingtable looks like this:</p><p>Kernel IP routing table<br />Destination&nbsp; &nbsp; &nbsp;Gateway&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Genmask&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Flags Metric Ref&nbsp; &nbsp; Use Iface<br />192.168.1.0&nbsp; &nbsp; &nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;255.255.255.0&nbsp; &nbsp;U&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; 0 eth0.1<br />172.16.30.0&nbsp; &nbsp; &nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;255.255.255.0&nbsp; &nbsp;U&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; 0 eth0.2<br />172.16.10.0&nbsp; &nbsp; &nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;255.255.255.0&nbsp; &nbsp;U&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; 0 eth0.0<br />default&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;192.168.1.1&nbsp; &nbsp; &nbsp;0.0.0.0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;UG&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; 0 eth0.1</p><br /><p>Pleas help me se what is wrong.</p><p>/J</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p72857">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">izaak</div>
					<div class="post-datetime">
						1 Sep 2008, 06:12					</div>
				</div>
				<div class="post-content content">
					<p>there are a few holes/mistakes in this guide:</p><p>1) there are bogus router/DNS IPs in the config/network file, but i see you avoided that trap.</p><p>2) install the &#039;ip&#039; package:</p><p># ipkg update<br /># ipkg install ip</p><p>3) most importantly, which will really trip us shorewall newbies, the /etc/shorewall/masq config is completely wrong.&nbsp; instead of:</p><p>eth0.0&nbsp; &nbsp; &nbsp; &nbsp; eth0.1<br />wl0&nbsp; &nbsp; &nbsp; &nbsp; eth0.1</p><p>it should be:</p><p>eth0.1&nbsp; &nbsp; &nbsp; &nbsp; eth0.0<br />eth0.1&nbsp; &nbsp; &nbsp; &nbsp; wl0</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>