<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Locked out of dropbear since upgrading</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 4 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p16946">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Just Some Guy</div>
					<div class="post-datetime">
						10 Dec 2005, 01:07					</div>
				</div>
				<div class="post-content content">
					<p>I seem to have locked myself out of my WRT54GS when I upgraded to the new version of dropbear, which apparently no longer looks at ~/.ssh/authorized_keys .&nbsp; &nbsp;As I disabled password logins before noticing the change in search path for authorized_keys, ssh now gives:</p><p># ssh -l root -v 192.168.1.1<br />OpenSSH_4.2p1 FreeBSD-20050903, OpenSSL 0.9.7e-p1 25 Oct 2004<br />debug1: Reading configuration data /etc/ssh/ssh_config<br />debug1: Connecting to 192.168.1.1 [192.168.1.1] port 22.<br />debug1: Connection established.<br />debug1: permanently_set_uid: 0/0<br />debug1: identity file /root/.ssh/identity type -1<br />debug1: identity file /root/.ssh/id_rsa type -1<br />debug1: identity file /root/.ssh/id_dsa type -1<br />debug1: Remote protocol version 2.0, remote software version dropbear_0.45<br />debug1: no match: dropbear_0.45<br />debug1: Enabling compatibility mode for protocol 2.0<br />debug1: Local version string SSH-2.0-OpenSSH_4.2p1 FreeBSD-20050903<br />debug1: SSH2_MSG_KEXINIT sent<br />debug1: SSH2_MSG_KEXINIT received<br />debug1: kex: server-&gt;client aes128-cbc hmac-md5 none<br />debug1: kex: client-&gt;server aes128-cbc hmac-md5 none<br />debug1: sending SSH2_MSG_KEXDH_INIT<br />debug1: expecting SSH2_MSG_KEXDH_REPLY<br />debug1: Host &#039;192.168.1.1&#039; is known and matches the DSA host key.<br />debug1: Found key in /root/.ssh/known_hosts:1<br />debug1: ssh_dss_verify: signature correct<br />debug1: SSH2_MSG_NEWKEYS sent<br />debug1: expecting SSH2_MSG_NEWKEYS<br />debug1: SSH2_MSG_NEWKEYS received<br />debug1: SSH2_MSG_SERVICE_REQUEST sent<br />debug1: SSH2_MSG_SERVICE_ACCEPT received<br />debug1: Authentications that can continue: publickey<br />debug1: Next authentication method: publickey<br />debug1: Offering public key: /home/kirk/.ssh/id_rsa<br />debug1: Authentications that can continue: publickey<br />debug1: Trying private key: /root/.ssh/identity<br />debug1: Trying private key: /root/.ssh/id_rsa<br />debug1: Trying private key: /root/.ssh/id_dsa<br />debug1: No more authentication methods to try.<br />Permission denied (publickey).</p><p>So, here&#039;s where I&#039;m at.&nbsp; Nmap (with the router in &quot;normal&quot; mode) gives me these open ports:</p><p>PORT&nbsp; &nbsp; STATE&nbsp; SERVICE<br />22/tcp&nbsp; open&nbsp; &nbsp;ssh<br />80/tcp&nbsp; closed http<br />161/tcp closed snmp</p><p>In failsafe mode, I have:</p><p>PORT&nbsp; &nbsp; &nbsp;STATE SERVICE<br />22/tcp&nbsp; &nbsp;open&nbsp; ssh<br />111/tcp&nbsp; open&nbsp; rpcbind<br />676/tcp&nbsp; open&nbsp; unknown<br />2049/tcp open&nbsp; nfs</p><p>It looks like it wants to let me mount part of it as an NFS share - boy, that would be handy right about now - but I&#039;ve tried all the mount_nfs variations I can thing of with no success:</p><p># mount 192.168.1.1:/ /tmp/foo<br />[udp] 192.168.1.1:/: Permission denied</p><p>So, does anyone have any great ideas about how I can re-enable password authentication so that I can get back into the little box?&nbsp; In the worst case, my sheer luck I happened to use rsync to make a backup of /etc immediately before the fatal reboot locked me out, so having to revert to a re-install shouldn&#039;t be too incredibly painful.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>