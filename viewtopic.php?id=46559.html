<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Racoon Message no Agressive mode with Mikrotik Router</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 22 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p213668">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">redflag237</div>
					<div class="post-datetime">
						2 Oct 2013, 00:16					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I&#039;m trying to get Racoon running IPSec with a Mikrotik router.<br />Followed the Setup Basics from OWRT Homepage.</p><div class="quotebox"><blockquote><p>config &#039;racoon&#039;<br />&nbsp; option &#039;foreground&#039; &#039;0&#039;<br />&nbsp; option &#039;debug&#039; &#039;1&#039;<br />&nbsp; option &#039;zone&#039; &#039;vpn&#039;</p><p>config &#039;tunnel&#039; &#039;WN&#039;<br />&nbsp; option &#039;enabled&#039; &#039;1&#039;<br />&nbsp; option &#039;remote&#039; &#039;nobody.no-ip.org&#039;<br />&nbsp; option &#039;pre_shared_key&#039; &#039;test&#039;<br />&nbsp; option &#039;exchange_mode&#039; &#039;aggressive&#039;<br />&nbsp; option &#039;my_identifier&#039; &#039;@nobody.no-ip.org&#039;<br />&nbsp; list&nbsp; &nbsp;&#039;p1_proposal&#039; &#039;pre_g2_3des_md5&#039;<br />&nbsp; list&nbsp; &nbsp;&#039;sainfo&#039; &#039;WN_LAN&#039;<br />&nbsp; option &#039;dpd_delay&#039; &#039;60&#039;</p><p>config &#039;p1_proposal&#039; &#039;pre_g2_3des_md5&#039;<br />&nbsp; option &#039;encryption_algorithm&#039; &#039;3des&#039;<br />&nbsp; option &#039;hash_algorithm&#039; &#039;md5&#039;<br />&nbsp; option &#039;authentication_method&#039; &#039;pre_shared_key&#039;<br />&nbsp; option &#039;dh_group&#039; &#039;2&#039;<br />&nbsp; option &#039;lifetime&#039; &#039;28800&#039;</p><p>config &#039;sainfo&#039; &#039;WN_LAN&#039;<br />&nbsp; option &#039;local_subnet&#039; &#039;10.178.1.160/27&#039;<br />&nbsp; option &#039;remote_subnet&#039; &#039;10.178.1.32/27&#039;<br />&nbsp; option &#039;p2_proposal&#039; &#039;g2_aes_sha1&#039;</p><p>config &#039;p2_proposal&#039; &#039;g2_aes_sha1&#039;<br />&nbsp; option &#039;pfs_group&#039; &#039;2&#039;<br />&nbsp; option &#039;encryption_algorithm&#039; &#039;aes&#039;<br />&nbsp; option &#039;authentication_algorithm&#039; &#039;hmac_sha1&#039;<br />&nbsp; option &#039;lifetime&#039; &#039;1800&#039;</p></blockquote></div><p>This is the generated one:<br /></p><div class="quotebox"><blockquote><p># auto generated by /etc/init.d/racoon<br />path pre_shared_key &quot;/var/racoon/psk.txt&quot;;<br />path certificate &quot;/var/racoon/cert&quot;;<br />padding {<br />&nbsp; maximum_length 20; randomize off;<br />&nbsp; strict_check off; exclusive_tail off;<br />}<br />timer {<br />&nbsp; counter 5; interval 20 sec; persend 1;<br />&nbsp; phase1 30 sec; phase2 15 sec;<br />}</p><p>remote &quot;WN&quot; {<br />&nbsp; remote_address 123.123.123.123 ;<br />&nbsp; my_identifier fqdn&nbsp; &quot;@nobody.no-ip.org&quot;;<br />&nbsp; exchange_mode aggressive;<br />&nbsp; proposal_check obey;<br />&nbsp; nat_traversal on;<br />&nbsp; dpd_delay 60;<br />&nbsp; proposal {<br />&nbsp; &nbsp; lifetime time 28800 sec;<br />&nbsp; &nbsp; encryption_algorithm 3des;<br />&nbsp; &nbsp; hash_algorithm md5;<br />&nbsp; &nbsp; authentication_method pre_shared_key;<br />&nbsp; &nbsp; dh_group 2;<br />&nbsp; }<br />}<br />sainfo address 10.178.1.160/27 any address 10.178.1.32/27 any {<br />&nbsp; pfs_group 2;<br />&nbsp; lifetime time 1800 sec;<br />&nbsp; encryption_algorithm aes;<br />&nbsp; authentication_algorithm hmac_sha1;<br />&nbsp; compression_algorithm deflate;<br />}</p></blockquote></div><p>Mikrotik tells me, <strong>Phase 1 Timeout</strong>.<br />OpenWrt tells me <strong>ERROR: exchange Aggressive not allowed in any applicable rmconf.</strong></p><p>I&#039;m near to get crazy with this.<br />Can anybody help, please?</p>											<p class="post-edited">(Last edited by <strong>redflag237</strong> on 2 Oct 2013, 00:18)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p213715">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">redflag237</div>
					<div class="post-datetime">
						2 Oct 2013, 17:19					</div>
				</div>
				<div class="post-content content">
					<p>Seems as there is a problem with establishing the Phase 2.<br /></p><div class="codebox"><pre><code>racoonctl show-sa isakmp</code></pre></div><p>Shows me an existing Connection with the right IP/Port of the Mikrotik Device.<br />esp and AH are empty.</p><p>Does that mean that there is an Phase 1 already established?</p><p>Thx for reply, redflag</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>