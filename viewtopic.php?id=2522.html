<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> usb audio support (patch)</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 29 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p11705">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">davico</div>
					<div class="post-datetime">
						4 Sep 2005, 12:16					</div>
				</div>
				<div class="post-content content">
					<p>sent this to patches@openwrt.org as directed in the docs but it bounced <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>Hi devs,<br />The attached patch adds support for usb soundcards. It is a fairly<br />trivial patch which I created as described in the buildroot howto. I<br />did need to add a trivial kernel patch though, to change a few instances<br />of sprintf to snprintf in sound_core.c as I was getting unresolved<br />symbols for strcpy.</p><p>FYI, audio support is a standard feature of the stock asus wl500g/x<br />firmware so I think it would be a welcome addition to openwrt. Currently<br />I have not packaged any actual audio players, making this seem somewhat<br />useless, however I have built and use &quot;mpd&quot; which I will package next.<br />There are also the asus music binaries floating around as well as a copy<br />of &quot;madplay&quot; which people may wish to use to actually play stuff.</p><p>The patch is against current CVS (4/9/05).</p><p>comments/suggestions welcome,</p><p>Thanks,<br />David Collett</p><p>[ removed patch to make thread more readable ]</p>											<p class="post-edited">(Last edited by <strong>davico</strong> on 9 Oct 2005, 23:52)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p11729">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">wbx</div>
					<div class="post-datetime">
						5 Sep 2005, 10:58					</div>
				</div>
				<div class="post-content content">
					<p>thx a lot, I will apply it shortly.</p><p>Can you suggest any USB audio device for testing/using, which is cheap and good?</p><p>I corrected the Mailadress, further patches and bugreports to openwrt-devel@openwrt.org .</p><p>Sunshine!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p11731">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">davico</div>
					<div class="post-datetime">
						5 Sep 2005, 11:28					</div>
				</div>
				<div class="post-content content">
					<p>Sure, the card I use is:<br /><a href="http://www.soundmax.com.tw/product/SD-102.htm">http://www.soundmax.com.tw/product/SD-102.htm</a></p><p>It was cheap ($20 Australian), and uses a c-media chip supported by the linux driver.<br />Perhaps a UsbAudio wiki page is in order? I can do this if you like?</p><p>Dave</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p11827">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">wbx</div>
					<div class="post-datetime">
						8 Sep 2005, 10:33					</div>
				</div>
				<div class="post-content content">
					<p>UsbAudio page would be nice.</p><p>Can you resent your patch to openwrt-devel@openwrt.org. Copy&amp;paste from forum is really ugly and I failed with doing it right <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p12951">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">cyberwulf</div>
					<div class="post-datetime">
						28 Sep 2005, 19:00					</div>
				</div>
				<div class="post-content content">
					<p>wondering why there are no usable information about openWRT with audio on the ASUS wl500g (USB)&nbsp; this seems the first thread mentioning specific &#039;software&#039;.</p><p>i build madplay because i cannot find any ipkg for that - and it works great with the USB audio kernel modules in the old &#039;buildroot&#039; environment.<br />additionally i connected a LCD via a USB2serial converter and display id3 tags of mp3 files from a USB cardreader. this all works with 70% CPU usage (mp3 192Kbits and VBR) on the &#039;normal&#039; wl500g with 125MHz.</p><p>i used very cheap hardware: USB 1 hub (5€), USB audio stereo adapter (9,95€), cardreader (7€)... if someone want to know where to get this in germany i can tell you..</p><p>before i reinvent the wheel: is there any project out there that uses an WLAN router as a mobile mp3 player in car-environment, wich can be easily accessed via network neigbourhood?</p><p>i&#039;ve already coded the id3-tag-to-LCD-via_usb2serial into the madplayer and now working on some external buttons..</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p12952">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">olli</div>
					<div class="post-datetime">
						28 Sep 2005, 19:03					</div>
				</div>
				<div class="post-content content">
					<p>Would be cool if you can write a Howto on that in our wiki.</p><p>Maybe you can port and package your software using the OpenWrt SDK.</p><p>- <a href="http://wiki.openwrt.org">http://wiki.openwrt.org</a>/<br />- <a href="http://wiki.openwrt.org/BuildingPackagesHowTo">http://wiki.openwrt.org/BuildingPackagesHowTo</a></p>											<p class="post-edited">(Last edited by <strong>olli_04</strong> on 28 Sep 2005, 19:04)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p12953">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">cyberwulf</div>
					<div class="post-datetime">
						28 Sep 2005, 19:15					</div>
				</div>
				<div class="post-content content">
					<p>..i&#039;ve been absent awhile.. there seems to be some changes here ;-) i will look for the audio wiki</p><p>and let me say something to the &#039;SDK&#039;:<br />great work and many thanks to all developers!<br />BUT: it was very difficult for me to find a way to successfully build an image and even additional software for the ASUS wl500g (wich is the only device i used openWRT for). it takes time to get familiar with the structure and build processes.</p><p>i have a lot of services running on this device for a couple of month and even additional hardware - and no problems so far. even if i use the old &#039;buildroot&#039;.<br />but i have issues with the newer stuff. and because i&#039;m familiar with the old one (and it works), i don&#039;t know if it makes much sense to write an obsolete Howto...</p><p>hehe, you are fast.. there&#039;s the wiki.. so let me have a look at it :-)</p>											<p class="post-edited">(Last edited by <strong>cyberwulf</strong> on 28 Sep 2005, 19:16)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p12968">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">wbx</div>
					<div class="post-datetime">
						28 Sep 2005, 23:15					</div>
				</div>
				<div class="post-content content">
					<p>Can you tell me where to find USB audio for 9,95?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p13099">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">cyberwulf</div>
					<div class="post-datetime">
						1 Oct 2005, 17:40					</div>
				</div>
				<div class="post-content content">
					<p>i have mine from <a href="http://www.conrad.de">www.conrad.de</a> in germany. it works great (unless it seems to only support 48K sampling rate ;-) )</p><p>the usb headset from a friend of mine is working too.</p><p>a picture of my router with USB hardware can be found <a href="http://www.cyber-wulf.de/gals/wl500g/wl500g_usb_stuff.html">here</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p13241">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">davico</div>
					<div class="post-datetime">
						5 Oct 2005, 04:38					</div>
				</div>
				<div class="post-content content">
					<p>Hi Guys,</p><p>I&#039;ve finally stuck up a basic wiki page:<br /><a href="http://wiki.openwrt.org/UsbAudioHowto">http://wiki.openwrt.org/UsbAudioHowto</a></p><p>It is linked from the howto and customization pages</p><p>Dave</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p13351">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">cyberwulf</div>
					<div class="post-datetime">
						7 Oct 2005, 11:58					</div>
				</div>
				<div class="post-content content">
					<p>great :-)<br />you say, mpd is the only available audio application (through packages).<br />let me mention that madplay works too and i can host a package for that if anyone likes (and traffic is not too immense)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p13353">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">j0chen</div>
					<div class="post-datetime">
						7 Oct 2005, 12:22					</div>
				</div>
				<div class="post-content content">
					<p>With madplay you can even play streams with the script found in the linked post.&nbsp; </p><p><a href="http://wl500g.info/showpost.php?p=12136&amp;postcount=21">http://wl500g.info/showpost.php?p=12136 … stcount=21</a></p><p>It needs just a little change regarding netcat. This should be replaced with busybox&#039;s nc.</p><p>There&#039;s also a madplay binary linked, but an openwrt-packages would be definitively better!</p><br /><p>The uclinux-branch of mpd doesn&#039;t seem to be able to play streams, unfortunately.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p13360">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">davico</div>
					<div class="post-datetime">
						7 Oct 2005, 14:53					</div>
				</div>
				<div class="post-content content">
					<p>Madplay sounds like a good candidate for an official package, have you integraded it into buildroot or built the package by hand? Buildroot is not too hard and I&#039;m confident the package would be accepted if you wish to give it a crack (though you might be best waiting for libmad (see below)).</p><p>Regarding the uclinux branch of mpd: As it happens, there is no need to use this branch as wrt hardware has an mmu. I discovered this after initially getting confused between uclinux and uclibc (doh!). I decided to stick with the uclinux branch as it has libmad, vorbis (tremor) and flac all included in the source tree which is very convienient. I intend to split these out now though to pave the way for more packages to link against them (there is already libogg/libvorbis in CVS now for icecast) so you can expect the mpd package to switch to the official releases some time. It will hopefully work better.</p><p>Dave</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p13361">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">j0chen</div>
					<div class="post-datetime">
						7 Oct 2005, 15:05					</div>
				</div>
				<div class="post-content content">
					<p>Hi Dave, I already tried to build the official mpd a few weeks ago but I failed.&nbsp; I hope you are more successful than me, then there would be no more need for madplay at least for me.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p13364">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">cyberwulf</div>
					<div class="post-datetime">
						7 Oct 2005, 17:04					</div>
				</div>
				<div class="post-content content">
					<p>i&#039;ve packed madplay with libmad (and libid3tag) in a package by hand - even if i build it within the full buildroot environment ;-)</p><p>it needs libgcc and libz to run.</p><p>you can download it for testing purposes <a href="http://www.cyber-wulf.de/download/madplay-0.15.2b.ipk">here</a></p>											<p class="post-edited">(Last edited by <strong>cyberwulf</strong> on 7 Oct 2005, 20:15)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p13410">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">davico</div>
					<div class="post-datetime">
						8 Oct 2005, 18:23					</div>
				</div>
				<div class="post-content content">
					<p>Hi All,<br />I have created packages for libFLAC, libmad, libvorbisidec (tremor), and a new mpd package from the main branch which is build against these new libs. It all seems to work very nicely. I&#039;ve integrated these packages into buildroot and will submit them to the devs shortly.</p><p>In the meantime you can find them here:<br /><a href="http://users.tpg.com.au/davico/openwrt/packages/">http://users.tpg.com.au/davico/openwrt/packages/</a></p><p>You also need the existing libid3tag package, I&#039;ve put it at the above location for convienience since it is not in whiterussian.</p><p>I havent tested mpd with streams yet, it should work though. Let me know if you have any problems.</p><p>Dave</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p13442">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">j0chen</div>
					<div class="post-datetime">
						9 Oct 2005, 13:23					</div>
				</div>
				<div class="post-content content">
					<p>Hi Dave, thank you very much for your work! Now I don&#039;t have to use madplay for playing streams anymore.</p><p>What client are you using?<br />With both mpc and gmpc I always get an error message like:</p><div class="codebox"><pre><code> error: error parsing version number at &quot;0&quot;</code></pre></div><p>phpMp2 works.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p13445">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">davico</div>
					<div class="post-datetime">
						9 Oct 2005, 15:44					</div>
				</div>
				<div class="post-content content">
					<p>I am using the gmpc package in ubuntu, it is version 0.11.2.<br />My mpd package is based on the subversion repository, not the stable release, so that could explain your version error (though my gmpc works...). The reason I used subversion was because it has native oss output rather than libao and I couldnt be bothered packaging libao.</p><p>phpmp[2] would be nice to have in openwrt also, I tried using it with lighthttp/php4-fastcgi packages but it chewed up too much ram and caused playback problems in mpd. I could use one or the other but not both! My new mpd package seems to use a LOT less memory though, so I might try again and maby whip up a package for that too.</p><p>Dave</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p13447">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">davico</div>
					<div class="post-datetime">
						9 Oct 2005, 15:55					</div>
				</div>
				<div class="post-content content">
					<p>Actually, I spoke too soon.<br />I was actually using an mpd I built before I packaged it all up. During the packaging, I added &quot;-dave&quot; to the version string to try and prevent any confusion that this was actually an official 0.12.0 release. That is almost certainly the cause of your problem...</p><p>I&#039;ll fix it up and upload some new packages now.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p13448">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">davico</div>
					<div class="post-datetime">
						9 Oct 2005, 16:14					</div>
				</div>
				<div class="post-content content">
					<p>ok, I&#039;ve stuck a fixed mpd package up now, the others are the same</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p13451">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">j0chen</div>
					<div class="post-datetime">
						9 Oct 2005, 17:22					</div>
				</div>
				<div class="post-content content">
					<p>Dave, the new packages works perfectly. Thanks again!</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>