<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> WDS bridge and repeater</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 26 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p200525">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">matt78</div>
					<div class="post-datetime">
						3 May 2013, 12:20					</div>
				</div>
				<div class="post-content content">
					<p>Hi, I&#039;ve 2 access point with&nbsp; Atheros Communications Inc. AR5413/AR5414 Wireless Network Adapter [AR5006X(S) 802.11abg] wifi card.<br />I need to extend range of the first access point. I have read a lot of howto and recipe and I&#039;m trying to configure the access point in WDS mode. <br />The first machine is in access point mode with wds and 1 wan:<br />---------------------------------------------------------------------------------------------------------<br />cat /etc/config/network</p><p>config interface &#039;loopback&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;lo&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;127.0.0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.0.0.0&#039;</p><p>config interface &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option type &#039;bridge&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;192.168.1.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;</p><p>config interface &#039;wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;dhcp&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option type &#039;bridge&#039;</p><p>cat /etc/config/wireless</p><p>config wifi-device &#039;radio0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option type &#039;mac80211&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option macaddr &#039;00:80:48:7a:75:52&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option hwmode &#039;11g&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option country &#039;IT&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option channel &#039;3&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option txpower &#039;31&#039;</p><p>config wifi-iface<br />&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;radio0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option mode &#039;ap&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option network &#039;wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option encryption &#039;psk2&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option key &#039;xxx&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ssid &#039;TestAt2&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option wds &#039;1&#039;<br />---------------------------------------------------------------------------------------------------------</p><br /><p>the second machine hasn&#039;t wired lan and 2 wifi card, one configured as cliet WDS and one as ap:<br />---------------------------------------------------------------------------------------------------------<br />cat network</p><p>config interface &#039;loopback&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;lo&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;127.0.0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.0.0.0&#039;</p><p>config interface &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option type &#039;bridge&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;192.168.1.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;</p><p>config interface &#039;wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;dhcp&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option type &#039;bridge&#039;</p><p>config interface &#039;wwan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;dhcp&#039;</p><p>cat wireless</p><p>config wifi-device &#039;radio0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option type &#039;mac80211&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option macaddr &#039;00:80:48:7a:75:58&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option hwmode &#039;11g&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option country &#039;IT&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option txpower &#039;0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option channel &#039;3&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option disabled &#039;0&#039;</p><p>config wifi-device &#039;radio1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option type &#039;mac80211&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option macaddr &#039;00:80:48:7a:70:9f&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option hwmode &#039;11g&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option txpower &#039;20&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option country &#039;IT&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option channel &#039;8&#039;</p><p>config wifi-iface<br />&nbsp; &nbsp; &nbsp; &nbsp; option network &#039;wwan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ssid &#039;TestAt2&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option encryption &#039;psk2&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;radio0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option mode &#039;sta&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option bssid &#039;00:80:48:7A:75:52&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option key &#039;xxx&#039;</p><p>config wifi-iface<br />&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;radio1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option mode &#039;ap&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ssid &#039;OpenWrt&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option encryption &#039;none&#039;</p><p> cat firewall</p><p>config defaults<br />&nbsp; &nbsp; &nbsp; &nbsp; option syn_flood &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option input &#039;ACCEPT&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option output &#039;ACCEPT&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option forward &#039;ACCEPT&#039;</p><p>config zone<br />&nbsp; &nbsp; &nbsp; &nbsp; option name &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option network &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option input &#039;ACCEPT&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option output &#039;ACCEPT&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option forward &#039;ACCEPT&#039;</p><p>config zone<br />&nbsp; &nbsp; &nbsp; &nbsp; option name &#039;wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option output &#039;ACCEPT&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option masq &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option mtu_fix &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option input &#039;ACCEPT&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option forward &#039;ACCEPT&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option network &#039;wan bridge relay wwan&#039;</p><p>config forwarding<br />&nbsp; &nbsp; &nbsp; &nbsp; option src &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option dest &#039;wan&#039;</p><p>---------------------------------------------------------------------------------------------------------</p><p>on the second machine, I can use network, I can ping and resolve dns, but if I use the ap mode, I can&#039;t do nothing.</p><p>What I do wrong? Can you help me?</p><p>thanks a lot!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p200526">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">matt78</div>
					<div class="post-datetime">
						3 May 2013, 12:24					</div>
				</div>
				<div class="post-content content">
					<p>it&#039;s run on openwrt Attitude Adjustment</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p200530">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						3 May 2013, 12:39					</div>
				</div>
				<div class="post-content content">
					<p>One obvious mistake is having the same 192.128.1.1 as the LAN IP address on both routers. They are on the same subnet, so they should have different IP addresses.</p><p>Both routers need the wds 1 option in their wifi config, one with sta, one with ap.</p><p>The advice in Wiki article is quite valid and you can see my own WDS config as example:<br /><a href="http://wiki.openwrt.org/doc/recipes/atheroswds">http://wiki.openwrt.org/doc/recipes/atheroswds</a><br /><a href="https://forum.openwrt.org/viewtopic.php?pid=186066#p186066">https://forum.openwrt.org/viewtopic.php … 66#p186066</a>&nbsp; (you can disregard the ipv6-specific part)</p>											<p class="post-edited">(Last edited by <strong>hnyman</strong> on 3 May 2013, 12:42)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p200533">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">matt78</div>
					<div class="post-datetime">
						3 May 2013, 12:46					</div>
				</div>
				<div class="post-content content">
					<p>thank for reply.<br />I have just real the first link (it&#039;s seem so simple:-)), I will read the second.</p><p>The interface &#039;lan&#039; with 192.168.1.1 is not connected. The only wired connection is the wan on the first machine, with dhcp.<br />I have used &#039;lan&#039; only for the first configuration</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p200540">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						3 May 2013, 13:58					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>matt78 wrote:</cite><blockquote><p>The interface &#039;lan&#039; with 192.168.1.1 is not connected. The only wired connection is the wan on the first machine, with dhcp.<br />I have used &#039;lan&#039; only for the first configuration</p></blockquote></div><p>But the routers share the IP address space of the subnet, and the same address space is use both for LAN and wifi. You are creating one large subnet with WDS with both routers in the same 192.168.1.x address space. They really do need different IP addresses. And for that reason you need to turn the DHCP server in the second router off.</p><p>Set the address of the second router to .2, reboot / reload network and then connect to the router in its new address.</p>											<p class="post-edited">(Last edited by <strong>hnyman</strong> on 3 May 2013, 14:00)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p200541">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">matt78</div>
					<div class="post-datetime">
						3 May 2013, 14:21					</div>
				</div>
				<div class="post-content content">
					<p>i&#039;ve change ip address to .2 and dnsmasq it was off, but the second ap doesn&#039;t work.</p><p>can i try some other?</p>											<p class="post-edited">(Last edited by <strong>matt78</strong> on 3 May 2013, 14:22)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>