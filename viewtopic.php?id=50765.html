<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> TP-Link TL-WR1043NDv1(AR9132) overclocking</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 6 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p234401">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">alphasparc</div>
					<div class="post-datetime">
						23 May 2014, 18:12					</div>
				</div>
				<div class="post-content content">
					<p>I tested and overclocked the TL-WR1043ND Router.<br />Basically I integrated the changes and fix the checksum on the main tplink factory images. (with uboot)<br />The max stable clock on my modified WR1043NDv1 (RAM Modded to 64MB) is 440MHZ.<br />Don&#039;t bother trying larger values because I already did.<br />At 460MHZ it fried my Serial Port (yes my serial port is no longer working)<br />At 450MHZ it crashes on heavy Network Traffic.<br />Luckily I modified the latest original tp-link images with the tftp to 192.169.0.66 recovery hence I saved it via blind tftpboot.<br />This mod also has the new tftp recovery feature.<br />To use it if you are already using TP-Link firmware simply flash it as you would for a firmware upgrade<br />If you are on OpenWRT use the sysupgrade_to_factory then flash the overclock_firmware then flash back openwrt factory.<br />More information <a href="http://aspiregemstone.blogspot.sg/2014/05/overclock-tp-link-wr1043nd.html"> here</a><br />I made 3 versions 440_440_220, 430_430_215 and 420_420_210.<br />I made the images available <a href="https://github.com/gwlim/Openwrt_Firmware/tree/master/TP-Link_TL-WR1043ND/BackUp_Image"> here</a><br />I already benchmarked the openssl performance and placed on the wiki.</p>											<p class="post-edited">(Last edited by <strong>alphasparc</strong> on 1 Aug 2014, 06:53)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p234610">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">robnitro</div>
					<div class="post-datetime">
						26 May 2014, 18:41					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for doing a u-boot mod for ar9132 400 mhz atheros.<br />I have a g300nh with the same cpu and was wondering what the performance could be. <br />I wonder if it is the chip itself or the buffalo with ar9132 could do better?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p234613">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">alphasparc</div>
					<div class="post-datetime">
						26 May 2014, 19:07					</div>
				</div>
				<div class="post-content content">
					<p>It has alway been about the chip.<br />My unit has been RAM Modded to a DDR400 (hence 200Mhz) 64MB chip<br />I am not sure how the original 32MB units would behave.<br />The PLL register is 0x18050000<br />Original value is 50 =&gt; 0101 0000 =&gt; 2^4+2^6 =&gt; 80 =&gt; 80*5 = 400Mhz<br />Therefore 420Mhz =&gt; 84*5 =&gt; 2^2 + 2^4 + 2^5 =&gt; 0101 0100 =&gt; 54<br />Therefore 440Mhz =&gt; 88*5 =&gt; 2^3 + 2^4 + 2^5 =&gt; 0101 1000 =&gt; 58<br />Basically I compiled the uboot with different frequency the check the changed bits.<br />After I know the bit position I modified TP-Link firmware with bootloader (because it is uncompressed uboot) then fix the checksum.<br />The reason why I decided to mod tp-link firmware is because<br />1)TP-Link don&#039;t provide the new source for the tftp 192.168.0.66 recovery we want the recovery<br />2)WR1043ND bootloader is serial locked means you cannot modify the bootloader via Serial Console but tp-link firmware allows it and is more convienient.</p>											<p class="post-edited">(Last edited by <strong>alphasparc</strong> on 26 May 2014, 19:11)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p238375">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">raz123</div>
					<div class="post-datetime">
						28 Jun 2014, 18:35					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>alphasparc wrote:</cite><blockquote><p>I already benchmarked the openssl performance and placed on the wiki.</p></blockquote></div><p>Thanks for your work!</p><p>Though I couldn&#039;t find the benchmarks on either the OpenWRT wiki or your blog.<br />Think you could upload them somewhere?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p238376">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">alphasparc</div>
					<div class="post-datetime">
						28 Jun 2014, 19:18					</div>
				</div>
				<div class="post-content content">
					<p>It is on the wiki (OpenSSL Benchmark) fourth row from the top as of this post.</p>											<p class="post-edited">(Last edited by <strong>alphasparc</strong> on 28 Jun 2014, 19:20)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p238578">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">alphasparc</div>
					<div class="post-datetime">
						30 Jun 2014, 10:19					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>robnitro wrote:</cite><blockquote><p>Thanks for doing a u-boot mod for ar9132 400 mhz atheros.<br />I have a g300nh with the same cpu and was wondering what the performance could be. <br />I wonder if it is the chip itself or the buffalo with ar9132 could do better?</p></blockquote></div><p>If you can pass me a copy of the bootloader I can patch it for you, but I can&#039;t test it since I do not have the device.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259017">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">JohnV</div>
					<div class="post-datetime">
						29 Dec 2014, 05:15					</div>
				</div>
				<div class="post-content content">
					<p>I saw you also posting on this thread about overclocking.</p><p><a href="https://forum.openwrt.org/viewtopic.php?id=38777">https://forum.openwrt.org/viewtopic.php?id=38777</a></p><p>I was wondering if you were never able to get the kernel-entry-init.h mod to work for you.&nbsp; I assume not based on what you did here.</p><p>I am using AR7241 and when I try to write any value, even the standard value, Openwrt wont start.</p><p>Is this the same issue you saw?</p><p>Thanks for any advice as I really need to get something to underclock the device I am using, and there is nothing I can find besides the above post that seemed promising.</p><p>Thanks.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259019">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">alphasparc</div>
					<div class="post-datetime">
						29 Dec 2014, 07:51					</div>
				</div>
				<div class="post-content content">
					<p>Here is what will definitely work.<br />Download the GPL tarball.<br />Build the uboot 2 times with 2 different clock value.<br />The file containing the clock register is ar7240_soc.h<br />Find the hex value difference.<br />Find the calculation required for different clocks.<br />Find the hexvalue offset responsible for the clock difference.<br />Backup your uboot<br />edit it using hexeditor with the modified hexadecimal value<br />Flash it back to the uboot.<br />If you are not confident of doing it you can pass me the uboot.</p>											<p class="post-edited">(Last edited by <strong>alphasparc</strong> on 29 Dec 2014, 08:06)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259078">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">JohnV</div>
					<div class="post-datetime">
						29 Dec 2014, 19:37					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for the response.</p><p>The issue with this approach is we need to make this change on 100+ routers.</p><p>My understanding (which is limited), is that the u-boot partition contains information specfic to each router, i.e. MAC address.</p><p>So I don&#039;t think this approach would work for us unfortunately as would have to &quot;patch&quot; each router by hand.</p><p>I am unlear as to why the kernel init change would work on some routers, but not on others, but I am no MIPS expert.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259100">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">mk24</div>
					<div class="post-datetime">
						29 Dec 2014, 22:35					</div>
				</div>
				<div class="post-content content">
					<p>The factory unique MAC address of each unit is in the art partition not the boot loader code.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259103">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">JohnV</div>
					<div class="post-datetime">
						29 Dec 2014, 22:56					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>mk24 wrote:</cite><blockquote><p>The factory unique MAC address of each unit is in the art partition not the boot loader code.</p></blockquote></div><p>The MAC for the WLAN is in the ART, but I thought the MAC for the Ethernet is in U-Boot.</p><p>I am a bit confused by all this however....</p><p>It seems the first 64k is for U-Boot, the 2nd 64k is router specific (maybe u-boot environment as I have seen that term used also).&nbsp; But when I compile and read about u-boot, they all talk about a 128k bin file.</p><p>Can I replace just the first 64k and leave the 2nd 64k alone?</p><p>There is an image about halfway down I am referring to.&nbsp; It shows the flash layout.</p><p>&quot;U-Boot code takes up to 64 KiB (free flash cells should be stored 0xFF), environmental variables (ie. Env) is sewn in the code (ie. Hard coded), and another 64 KiB flash memory are only 2/3 value (the MAC address of the router model and possibly pin for WPS). The rest of the area is empty! The following chart should explain the structure of the data in the flash memory, and it is worth to him carefully.&quot;</p><p><a href="http://translate.google.com/translate?hl=en&amp;sl=pl&amp;u=http://www.tech-blog.pl/2013/03/29/zmodyfikowany-u-boot-dla-routerow-tp-link-z-atheros-ar9331-z-trybem-aktualizacji-oprogramowania-przez-www-i-konsola-sieciowa-netconsole/&amp;prev=search">http://translate.google.com/translate?h … rev=search</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259113">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">mk24</div>
					<div class="post-datetime">
						30 Dec 2014, 01:21					</div>
				</div>
				<div class="post-content content">
					<p>Yes that is true I checked on a MR3420v1 and it is as the page you found described.&nbsp; Except that the factory bootloader is much larger than 64K, it is almost all of both pages.&nbsp; I have a Netgear which has the MAC addresses in the ART but apparently this is a TP-Link thing and not necessarily the same for all Atheros based routers.</p><p>You could write a script that extracts the factory data by reading the stock mtd0 and then stripping off all but the very end with dd.&nbsp; Then that file would be cat&#039;d to the end of a prepared file which is the new bootloader code padded out to almost 128k so the final result is the proper size to flash.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259116">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">alphasparc</div>
					<div class="post-datetime">
						30 Dec 2014, 01:44					</div>
				</div>
				<div class="post-content content">
					<p>LZMA compressed boot loader is less than 64K hence most you need to overwrite 64K<br />Non LZMA compressed boot loader while bigger than 64K is definitely a lot smaller than 128K<br />You just need to mind the offset and the difference is definitely only a hex value and the offset is at a early section of the uboot.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259127">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">JohnV</div>
					<div class="post-datetime">
						30 Dec 2014, 03:13					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for sticking with me here.</p><p>How do I know if the boot loader is LZMA compressed or not?&nbsp; Where do I look to determine this?&nbsp; I dont see anything in the serial console stating yes or no.</p><p>Also, although the router I am working on is based on MR3220V1, it is not a TP-Link router.&nbsp; So I am not 100% sure if the u-boot is the same as GPL-TPLink, and in turn, if I compile U-Boot from TPLink&#039;s website, will it be the same as what I have.&nbsp; I guess only one way to find out......</p><p>I will try to compile u-boot and compare to whats on the router and see what I find.&nbsp; Will likely need some more help sorting the 2 .bin&#039;s out.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259132">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">mk24</div>
					<div class="post-datetime">
						30 Dec 2014, 03:38					</div>
				</div>
				<div class="post-content content">
					<p>On the router, make a copy of your bootloader partition to a file: <br />dd if=/dev/mtd0 of=/tmp/u-boot.bin</p><p>Then scp this file to your PC and examine with hex editor.&nbsp; An uncompressed u-boot will have readable text in it like the help text and error messages.&nbsp; Look for your MAC address in the place the web page talks about.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259133">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">JohnV</div>
					<div class="post-datetime">
						30 Dec 2014, 04:08					</div>
				</div>
				<div class="post-content content">
					<p>Its not compressed.&nbsp; Thanks for the pointer.</p><p>The mac address is at 0x0001FC00, as stated on the web page.</p><p>After it, is all FF, unused.&nbsp; The other values are not present, which is fine.</p><br /><p>If I compile a u-boot, can I make it only big enough to write to just before 0x0001FC00, and in turn leave everything after intact and simply replace the first part with the modified U-Boot?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259138">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">mk24</div>
					<div class="post-datetime">
						30 Dec 2014, 05:45					</div>
				</div>
				<div class="post-content content">
					<p>The flash chip doesn&#039;t let you erase part of a 64k block.&nbsp; If you&#039;re going to change anything in that second block (i.e. the new u-boot is larger than 64k) you have to prepare the whole block in a file and then write it.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259147">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">alphasparc</div>
					<div class="post-datetime">
						30 Dec 2014, 08:55					</div>
				</div>
				<div class="post-content content">
					<p>Hi the reason why I suggested modifying the hex value instead of using the uboot compiled is that you can never be sure if it boots.<br />When you diff the uboot with different clock values you will only locate a few offset difference (minus the timestamp so compile the uboot in quick succession) and that is the value that sets the clock.<br />And using the series of hex value pattern you can locate the hex value in the original uboot.<br />Also this solves the problem of size truncation.</p><br /><p>Fastest way backup uboot, mod hex value, flash back.<br />All your Mac Address, WPS and Model Number will be retained.</p>											<p class="post-edited">(Last edited by <strong>alphasparc</strong> on 30 Dec 2014, 12:12)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259244">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">JohnV</div>
					<div class="post-datetime">
						30 Dec 2014, 23:36					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for the help. </p><p>I have 3 images from TPlink compiled with different clock speeds for AR7241, and have been able to locate the offset that changed (28 (400mhz) -&gt; 1c (280mhz) -&gt; 1a (260mhz), offset 0x0000d4fb).&nbsp; This is compiled with 8meg flash set in the source code, not sure if that will matter in case this can help someone in the future.&nbsp; The compiled u-boot is 124k.</p><p>And the different offset values match the values in the source code so it seems to be accurate.&nbsp; I have no other differences in the 3 images.</p><p>I found the same sequence of hex from the 400mhz TPlink u-boot in the original u-boot from the router, and will change the value to one of the 2 other values.</p><br /><p>Here is my only worry.</p><p>If something goes wrong, the router will be completely bricked this way, correct?&nbsp; Since I am changing u-boot, if it fails to start at that clock speed for some reason, I assume u-boot will not start either?&nbsp; or is that incorrect, and u-boot will be OK, but Linux/Openwrt may not start.</p><p>Thanks again before I try this.</p>											<p class="post-edited">(Last edited by <strong>JohnV</strong> on 30 Dec 2014, 23:38)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259256">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">alphasparc</div>
					<div class="post-datetime">
						31 Dec 2014, 02:16					</div>
				</div>
				<div class="post-content content">
					<p>Messing with uboot always meant that if you did it wrongly it will not boot and you need a external flash programmer to recover.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259343">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">JohnV</div>
					<div class="post-datetime">
						31 Dec 2014, 19:36					</div>
				</div>
				<div class="post-content content">
					<p>Now I am at a loss.</p><p>I updated the u-boot, confirm that the byte has been changed, and when I boot the router, it remains in 400mHz, the default speed.</p><p>Here is what I have:</p><p>This is from TPLink U-Boot compiled for 400 mhz:</p><div class="codebox"><pre><code>Offset      0  1  2  3  4  5  6  7   8  9  A  B  C  D  E  F

0000D4F0   03 19 C0 24 3C 19 00 04  37 39 08 28 03 19 C0 25     À$&lt;   79 (  À%
0000D500   AD F8 00 00 3C 0F B8 05  8D F8 00 00 3C 19 FF FE   ø  &lt; ¸  ø  &lt; ÿþ
0000D510   37 39 FF FF 03 19 C0 24  AD F8 00 00 10 00 00 33   79ÿÿ  À$ø     3
0000D520   00 00 00 00 00 00 00 00  3C 0F B8 05 8D F8 00 00           &lt; ¸  ø  
0000D530   3C 19 FD FF 37 39 FF FF  03 19 C0 24 AD F8 00 00   &lt; ýÿ79ÿÿ  À$ø  
0000D540   3C 0F B8 05 8D F8 00 00  3C 19 FF B3 37 39 C0 00   &lt; ¸  ø  &lt; ÿ³79À 
0000D550   03 19 C0 24 3C 19 00 04  37 39 08 28 03 19 C0 25     À$&lt;   79 (  À%
0000D560   AD F8 00 00 3C 0F B8 05  8D F8 00 00 3C 19 FF FE   ø  &lt; ¸  ø  &lt; ÿþ
0000D570   37 39 FF FF 03 19 C0 24  AD F8 00 00 10 00 00 1B   79ÿÿ  À$ø      
0000D580   00 00 00 00 00 00 00 00  3C 0F B8 05 8D F8 00 00           &lt; ¸  ø  
0000D590   3C 19 FD FF 37 39 FF FF  03 19 C0 24 AD F8 00 00   &lt; ýÿ79ÿÿ  À$ø  
0000D5A0   3C 0F B8 05 8D F8 00 00  3C 19 FF B3 37 39 C0 00   &lt; ¸  ø  &lt; ÿ³79À </code></pre></div><br /><p>This is from TPLink U-Boot compiled for 280 mhz:</p><div class="codebox"><pre><code>Offset      0  1  2  3  4  5  6  7   8  9  A  B  C  D  E  F

0000D4F0   03 19 C0 24 3C 19 00 04  37 39 08 1C 03 19 C0 25     À$&lt;   79    À%
0000D500   AD F8 00 00 3C 0F B8 05  8D F8 00 00 3C 19 FF FE   ø  &lt; ¸  ø  &lt; ÿþ
0000D510   37 39 FF FF 03 19 C0 24  AD F8 00 00 10 00 00 33   79ÿÿ  À$ø     3
0000D520   00 00 00 00 00 00 00 00  3C 0F B8 05 8D F8 00 00           &lt; ¸  ø  
0000D530   3C 19 FD FF 37 39 FF FF  03 19 C0 24 AD F8 00 00   &lt; ýÿ79ÿÿ  À$ø  
0000D540   3C 0F B8 05 8D F8 00 00  3C 19 FF B3 37 39 C0 00   &lt; ¸  ø  &lt; ÿ³79À 
0000D550   03 19 C0 24 3C 19 00 04  37 39 08 28 03 19 C0 25     À$&lt;   79 (  À%
0000D560   AD F8 00 00 3C 0F B8 05  8D F8 00 00 3C 19 FF FE   ø  &lt; ¸  ø  &lt; ÿþ
0000D570   37 39 FF FF 03 19 C0 24  AD F8 00 00 10 00 00 1B   79ÿÿ  À$ø      
0000D580   00 00 00 00 00 00 00 00  3C 0F B8 05 8D F8 00 00           &lt; ¸  ø  
0000D590   3C 19 FD FF 37 39 FF FF  03 19 C0 24 AD F8 00 00   &lt; ýÿ79ÿÿ  À$ø  
0000D5A0   3C 0F B8 05 8D F8 00 00  3C 19 FF B3 37 39 C0 00   &lt; ¸  ø  &lt; ÿ³79À </code></pre></div><p>The offset that changed is D4FB.&nbsp; Changes from x28 to x1c.&nbsp; This matches the source code.</p><p>Note however, that D4F0 and D550 are duplicate entries on the 400Mhz compile.&nbsp; And the data below.&nbsp; However, only the offset at D4FB is changing from comple to compile.</p><p>This is from my router&#039;s u-boot:</p><div class="codebox"><pre><code>Offset      0  1  2  3  4  5  6  7   8  9  A  B  C  D  E  F

0000D270   03 19 C0 24 3C 19 00 04  37 39 08 28 03 19 C0 25     À$&lt;   79 (  À%
0000D280   AD F8 00 00 3C 0F B8 05  8D F8 00 00 3C 19 FF FE   ø  &lt; ¸  ø  &lt; ÿþ
0000D290   37 39 FF FF 03 19 C0 24  AD F8 00 00 10 00 00 33   79ÿÿ  À$ø     3
0000D2A0   00 00 00 00 00 00 00 00  3C 0F B8 05 8D F8 00 00           &lt; ¸  ø  
0000D2B0   3C 19 FD FF 37 39 FF FF  03 19 C0 24 AD F8 00 00   &lt; ýÿ79ÿÿ  À$ø  
0000D2C0   3C 0F B8 05 8D F8 00 00  3C 19 FF B3 37 39 C0 00   &lt; ¸  ø  &lt; ÿ³79À 
0000D2D0   03 19 C0 24 3C 19 00 04  37 39 08 28 03 19 C0 25     À$&lt;   79 (  À%
0000D2E0   AD F8 00 00 3C 0F B8 05  8D F8 00 00 3C 19 FF FE   ø  &lt; ¸  ø  &lt; ÿþ
0000D2F0   37 39 FF FF 03 19 C0 24  AD F8 00 00 10 00 00 1B   79ÿÿ  À$ø      
0000D300   00 00 00 00 00 00 00 00  3C 0F B8 05 8D F8 00 00           &lt; ¸  ø  
0000D310   3C 19 FD FF 37 39 FF FF  03 19 C0 24 AD F8 00 00   &lt; ýÿ79ÿÿ  À$ø  
0000D320   3C 0F B8 05 8D F8 00 00  3C 19 FF B3 37 39 C0 00   &lt; ¸  ø  &lt; ÿ³79À </code></pre></div><p>This matches the 400mhz compile I did, but the offset is at D27B.</p><p>I changed this value to &quot;1c&quot;.&nbsp; And wrote the u-boot, and rebooted.</p><p>Dmesg:</p><div class="codebox"><pre><code>[    0.000000] Linux version 3.10.49 (xxx@xxx-VirtualBox) (gcc version 4.8.3 (OpenWrt/Linaro GCC 4.8-2014.04 r371) ) #22 Mon Dec 29 13:25:06 TAHT 2014
[    0.000000] MyLoader: sysp=82408001, boardp=21452249, parts=a06c2203
[    0.000000] bootconsole [early0] enabled
[    0.000000] CPU revision is: 00019374 (MIPS 24Kc)
[    0.000000] SoC: Atheros AR7241 rev 1
[    0.000000] Clocks: CPU:400.000MHz, DDR:400.000MHz, AHB:200.000MHz, Ref:5.000MHz</code></pre></div><p>This is the memory location for the registers that control the clock speed, based on other threads:</p><div class="codebox"><pre><code>root@x:~# io -4 0x18050000
18050000:  00040828</code></pre></div><p>As you can see, the value is still 28........????</p><p>I then checked the byte from the u-boot that is on the flash:</p><div class="codebox"><pre><code>root@x:~# cat /dev/mtd0 &gt; /tmp/uboot_backup.bin
root@x:~# tmp=$(dd if=/tmp/uboot_backup.bin bs=1 skip=53883 count=1)
1+0 records in
1+0 records out
root@x:~# tmp=$(printf &quot;%02x\n&quot; &quot;&#039;$tmp&quot;)
root@x:~# echo $tmp
1c</code></pre></div><p>And the value is as it should be, 1c.</p><p>Can anyone check they hex dump from u-boot against the offset I am changing, to confirm....</p><p>All very strange!</p>											<p class="post-edited">(Last edited by <strong>JohnV</strong> on 31 Dec 2014, 19:44)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259344">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">alphasparc</div>
					<div class="post-datetime">
						31 Dec 2014, 19:44					</div>
				</div>
				<div class="post-content content">
					<p>The assumption you are making is that the TP-Link uboot source compiles to the same uboot as your device or there are many instance of the same byte pattern and you replaced only 1.<br />I remember my uboot on MR3420v1 (AR7241) has 2 instance of the byte pattern at very close offsets and I replaced both.</p>											<p class="post-edited">(Last edited by <strong>alphasparc</strong> on 31 Dec 2014, 19:45)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259348">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">JohnV</div>
					<div class="post-datetime">
						31 Dec 2014, 20:57					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for the advice.</p><p>I changed it in both offest locations, and it is working now.</p><br /><p>Still seems odd to me that the TP-Link compile only changes it in one place, but on my u-boot it needs it in both places.&nbsp; Obviously there is some differnce I am not aware of.</p><p>Regardless, thank you for your help and time on this, now to see if it actually allows the CPU to run at a lower temperature, which is my actual goal.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p266140">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">Davidwei</div>
					<div class="post-datetime">
						19 Feb 2015, 17:16					</div>
				</div>
				<div class="post-content content">
					<p>Hi,does your uboot support 16MB flash such as mx25L128? and if it is have httpd ?</p>											<p class="post-edited">(Last edited by <strong>Davidwei</strong> on 20 Feb 2015, 03:07)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>