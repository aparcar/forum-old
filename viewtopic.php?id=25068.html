<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> dhcp+pptp</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 22 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p110372">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">laragofplay</div>
					<div class="post-datetime">
						1 Jun 2010, 23:17					</div>
				</div>
				<div class="post-content content">
					<p>I have Linksys WRT160NL and installed OpenWRT backfire openwrt-ar71xx-wrt160nl-squashfs.bin from <a href="http://downloads.openwrt.org/backfire/10.03/ar71xx/">http://downloads.openwrt.org/backfire/10.03/ar71xx/</a>. I live in Russia and my provider use dual access, local ip and routes from dhcp and internet by pptp. </p><p>I use opkg install kmod-gre_2.6.32.10-1_ar71xx.ipk &amp; pptp_1.6.0-6_ar71xx.ipk. In a web the interface at me is either dhcp or ppoe or pptp how I can make dhcp+pptp?</p><p>May be install additional packages? what? or only use vi amd change scripts?</p><p>Sorry for my bad English, pls help me.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110386">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						2 Jun 2010, 04:55					</div>
				</div>
				<div class="post-content content">
					<p>Hi.</p><p>Choose pptp. The client will try to obtain a DHCP lease before establishing a pptp connection.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110849">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">laragofplay</div>
					<div class="post-datetime">
						9 Jun 2010, 13:26					</div>
				</div>
				<div class="post-content content">
					<p>ppp0 refreshing every 10-15 second, and dual access don&#039;t work, routes?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110891">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Joke</div>
					<div class="post-datetime">
						9 Jun 2010, 21:50					</div>
				</div>
				<div class="post-content content">
					<p>see <a href="https://forum.openwrt.org/viewtopic.php?id=25159">https://forum.openwrt.org/viewtopic.php?id=25159</a><br />I spent much time to setting up dhcp+pptp, but finally I got it works.<br />You should have two interfaces (I have two), wan and ppp0 - through wan you get ip/gate/dns from your ISP and through ppp0 (which is pptp in your case) you get point (another ip/gate from vpn server) to internet.<br />When you get connection to vpn-server, there will occur default route to send all traffic through ppp0. So if you want local ISP lan you should add some routes (until your provider gives you ones) to sent your packets to local gateway through wan.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111009">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">laragofplay</div>
					<div class="post-datetime">
						11 Jun 2010, 13:47					</div>
				</div>
				<div class="post-content content">
					<p>jow, Joke thx,</p><p>i use vi /etc/config/network and use web-gui but pptp connection die every 10 second (</p><p>i don&#039;t know wtf</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111026">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Joke</div>
					<div class="post-datetime">
						11 Jun 2010, 18:31					</div>
				</div>
				<div class="post-content content">
					<p>Try to reinstall pptp. It may helps. I&#039;ve got problem, when installing pptp for the first time!!!<br />Also try to install pptpd!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111380">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">laragofplay</div>
					<div class="post-datetime">
						17 Jun 2010, 14:37					</div>
				</div>
				<div class="post-content content">
					<p>It&#039;s not work <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>Apr&nbsp; 6 01:31:47 OpenWrt daemon.info pppd[1441]: Using interface ppp0<br />Apr&nbsp; 6 01:31:47 OpenWrt daemon.notice pppd[1441]: Connect: ppp0 &lt;--&gt; /dev/pts/0<br />Apr&nbsp; 6 01:31:47 OpenWrt daemon.crit pptp[3986]: anon fatal[get_ip_address:pptp.c:377]: gethostbyname &#039;vpn.internet.beeline.ru&#039;: HOST NOT FOUND<br />Apr&nbsp; 6 01:31:47 OpenWrt daemon.notice pppd[1441]: Modem hangup<br />Apr&nbsp; 6 01:31:47 OpenWrt daemon.notice pppd[1441]: Connection terminated.</p><p>then i nslookup beeline vpn server, and use pptp server on config as IP:</p><p>Apr&nbsp; 6 01:39:45 OpenWrt daemon.notice pptp[8953]: anon log[main:pptp.c:267]: The synchronous pptp option is NOT activated<br />Apr&nbsp; 6 01:39:45 OpenWrt daemon.warn pptp[8953]: anon warn[pptp_gre_bind:pptp_gre.c:95]: connect: Network is unreachable<br />Apr&nbsp; 6 01:39:45 OpenWrt daemon.crit pptp[8953]: anon fatal[main:pptp.c:275]: Cannot bind GRE socket, aborting.<br />Apr&nbsp; 6 01:39:45 OpenWrt daemon.err pppd[8796]: Failed to set PPP kernel option flags: Inappropriate ioctl for device<br />Apr&nbsp; 6 01:39:45 OpenWrt daemon.info pppd[8796]: Using interface ppp0<br />Apr&nbsp; 6 01:39:45 OpenWrt daemon.notice pppd[8796]: Connect: ppp0 &lt;--&gt; /dev/pts/2<br />Apr&nbsp; 6 01:39:45 OpenWrt daemon.notice pppd[8796]: Modem hangup<br />Apr&nbsp; 6 01:39:45 OpenWrt daemon.notice pppd[8796]: Connection terminated.</p><p>have idea?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111382">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">laragofplay</div>
					<div class="post-datetime">
						17 Jun 2010, 15:10					</div>
				</div>
				<div class="post-content content">
					<p>i changed /etc/config/network from Joke example:</p><p>config interface lan<br />&nbsp; &nbsp; option ifname&nbsp; &nbsp; eth0<br />&nbsp; &nbsp; option type&nbsp; &nbsp; bridge<br />&nbsp; &nbsp; option proto&nbsp; &nbsp; static<br />&nbsp; &nbsp; option ipaddr&nbsp; &nbsp; 192.168.1.1<br />&nbsp; &nbsp; option netmask&nbsp; &nbsp; 255.255.255.0<br />&nbsp; &nbsp;<br />config interface wan<br />&nbsp; &nbsp; option ifname&nbsp; &nbsp; eth1<br />&nbsp; &nbsp; option proto&nbsp; &nbsp; dhcp</p><p>config interface ppp0<br />&nbsp; &nbsp; option ifname&nbsp; &nbsp; ppp0<br />&nbsp; &nbsp; option proto&nbsp; &nbsp; pptp<br />&nbsp; &nbsp; option ipproto&nbsp; &nbsp; dhcp<br />&nbsp; &nbsp; option server&nbsp; &nbsp; server-name<br />&nbsp; &nbsp; option username&nbsp; &nbsp; username<br />&nbsp; &nbsp; option password&nbsp; &nbsp; userpassword<br />&nbsp; &nbsp; option keepalive 10</p><p> -----</p><p>but ppp0 connected one time and die, no ping ya.ru from device <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /><br />another time after reboot device or ifdown ppp0 if up ppp0 vpn not working:</p><p>Apr&nbsp; 6 01:33:13 OpenWrt daemon.notice pppd[1431]: pppd 2.4.4 started by root, uid 0<br />Apr&nbsp; 6 01:33:13 OpenWrt daemon.info pppd[1431]: Using interface ppp0<br />Apr&nbsp; 6 01:33:13 OpenWrt daemon.notice pppd[1431]: Connect: ppp0 &lt;--&gt; /dev/pts/1<br />Apr&nbsp; 6 01:33:43 OpenWrt daemon.crit pptp[1438]: anon fatal[get_ip_address:pptp.c:377]: gethostbyname &#039;vpn.internet.beeline.ru&#039;: HOST NOT FOUND</p><p>i don&#039;t understand wtf, may be help me?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111383">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">Joke</div>
					<div class="post-datetime">
						17 Jun 2010, 15:28					</div>
				</div>
				<div class="post-content content">
					<p>What model of router do you use?<br />The standard interface configuration is eht0.0 for lan and eth0.1 for wan for linksys routers. Eht1 is not used by default (dlink is another story). Read first VLAN and bridging concepts [url=]http://wiki.openwrt.org/oldwiki/openwrtdocs/networkinterfaces?s[]=vlan[/url]:<br />Next, post the output of (will see do you get IP address on wan from your ISP) </p><div class="codebox"><pre><code>ifconfig</code></pre></div><p>P.S.: pptpd is not necessary!</p>											<p class="post-edited">(Last edited by <strong>Joke</strong> on 17 Jun 2010, 15:39)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111414">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">laragofplay</div>
					<div class="post-datetime">
						18 Jun 2010, 02:22					</div>
				</div>
				<div class="post-content content">
					<p>config workable, vlan not necessary option, this config work on this device on mirwifi firmware (openwrt + hands)</p><p>but on 10.03 openwrt don&#039;t work.</p><p>May by who can make how to about wrt160nl + openwrt = russia dual access good work?!</p><p>P.S. on mirwifi firmware pptp package not installed, they use accel-pptp. i don&#039;t understang can i compile and install this. i confused change setting of eht interfaces and pptp don&#039;t connect(</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111441">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">Joke</div>
					<div class="post-datetime">
						18 Jun 2010, 12:28					</div>
				</div>
				<div class="post-content content">
					<p>Will you post output of ifconfig? Should be like this </p><div class="codebox"><pre><code> root@OpenWRT:~# ifconfig
br-lan    Link encap:Ethernet  HWaddr 00:24:01:DD:A0:44  
          inet addr:192.168.1.1  Bcast:192.168.1.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:27798 errors:0 dropped:0 overruns:0 frame:0
          TX packets:28711 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:4737417 (4.5 MiB)  TX bytes:26426232 (25.2 MiB)

eth0      Link encap:Ethernet  HWaddr 00:24:01:DD:A0:46  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:3666 errors:0 dropped:0 overruns:0 frame:0
          TX packets:4524 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:713068 (696.3 KiB)  TX bytes:810358 (791.3 KiB)
          Interrupt:4 

eth1      Link encap:Ethernet  HWaddr 00:24:01:DD:A0:47  
          inet addr:10.55.123.22  Bcast:10.55.123.255  Mask:255.255.254.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:121524 errors:0 dropped:0 overruns:0 frame:0
          TX packets:33952 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:5 
          RX bytes:114983465 (109.6 MiB)  TX bytes:5923367 (5.6 MiB)
          Interrupt:5 

imq0      Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00  
          UP RUNNING NOARP  MTU:16000  Metric:1
          RX packets:98137 errors:0 dropped:0 overruns:0 frame:0
          TX packets:50993 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:5 
          RX bytes:110023719 (104.9 MiB)  TX bytes:46710813 (44.5 MiB)

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:795 errors:0 dropped:0 overruns:0 frame:0
          TX packets:795 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:119405 (116.6 KiB)  TX bytes:119405 (116.6 KiB)

mon.wlan0 Link encap:UNSPEC  HWaddr 00-24-01-DD-A0-44-00-00-00-00-00-00-00-00-00-00  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:2623 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:160274 (156.5 KiB)  TX bytes:0 (0.0 B)

mon.wlan1 Link encap:UNSPEC  HWaddr 00-24-01-DD-A0-45-00-00-00-00-00-00-00-00-00-00  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

pptp-ppp0 Link encap:Point-to-Point Protocol  
          inet addr:93.175.6.232  P-t-P:81.5.90.75  Mask:255.255.255.255
          UP POINTOPOINT RUNNING NOARP MULTICAST  MTU:1452  Metric:1
          RX packets:1888 errors:0 dropped:0 overruns:0 frame:0
          TX packets:2377 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:3 
          RX bytes:593005 (579.1 KiB)  TX bytes:538425 (525.8 KiB)

wlan0     Link encap:Ethernet  HWaddr 00:24:01:DD:A0:44  
          UP BROADCAST MULTICAST  MTU:1500  Metric:1
          RX packets:24122 errors:0 dropped:0 overruns:0 frame:0
          TX packets:27952 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:4413321 (4.2 MiB)  TX bytes:26541357 (25.3 MiB)

wlan1     Link encap:Ethernet  HWaddr 00:24:01:DD:A0:45  
          UP BROADCAST MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:2476 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:266690 (260.4 KiB)</code></pre></div><p>Vlan isn&#039;t necessary option as far as you have other ethernet device for WAN traffic e.i. another lan/wan adapter inside your router (or you can do tricks with bridge and routes to internet etc.)<br />Do mirwifi firmware has the same configs structure, e.i. uses uci and store configs in /etc/config/...?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111442">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						18 Jun 2010, 12:44					</div>
				</div>
				<div class="post-content content">
					<p>The ppp/pptp scripts in 10.03 have lot of issues, you should try trunk or current backfire branch to see if you have more luck with pptp.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111445">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">mirred</div>
					<div class="post-datetime">
						18 Jun 2010, 14:53					</div>
				</div>
				<div class="post-content content">
					<p>I’ve got the problem described by laragofplay with latest trunk and Backfire branch. Router WNDR3700.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111456">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						18 Jun 2010, 18:29					</div>
				</div>
				<div class="post-content content">
					<p>If you disable the pptp interface temporarily and just request dhcp, is the network set up in a way that allows you to reach the vpn server? In your log I see both DNS and routing failures, this looks to me like dhcp didn&#039;t acquire enough/correct information in the first stage.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111491">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">laragofplay</div>
					<div class="post-datetime">
						19 Jun 2010, 02:14					</div>
				</div>
				<div class="post-content content">
					<p>dhcp work correct. if disable pptp dhcp work ok. vpn server ping and resolv ok from router. if on router only use dhcp and up vpn on computer - work ok.</p><p>i don&#039;t understand problem, i confused, but i know problem may be dns or masquerade.</p><p>MirWifi firmware not use pptp, they use accel-pptp kernel module.</p><div class="quotebox"><cite>ifconfig only dhcp: wrote:</cite><blockquote><p>root@OpenWrt:/# ifconfig<br />br-lan&nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 12:9C:E1:21:C9:8E<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:192.168.1.1&nbsp; Bcast:192.168.1.255&nbsp; Mask:255.255.255.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:199670 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:233426 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:23627896 (22.5 MiB)&nbsp; TX bytes:229574109 (218.9 MiB)</p><p>eth0&nbsp; &nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 12:9C:E1:21:C9:8E<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:199672 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:233426 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:26423960 (25.1 MiB)&nbsp; TX bytes:229574109 (218.9 MiB)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Interrupt:4</p><p>eth1&nbsp; &nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 42:9B:26:8A:21:33<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:10.190.185.239&nbsp; Bcast:10.190.191.255&nbsp; Mask:255.255.248.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:427612 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:199695 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:243766209 (232.4 MiB)&nbsp; TX bytes:26201401 (24.9 MiB)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Interrupt:5</p><p>lo&nbsp; &nbsp; &nbsp; &nbsp; Link encap:Local Loopback<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:127.0.0.1&nbsp; Mask:255.0.0.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP LOOPBACK RUNNING&nbsp; MTU:16436&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:6 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:6 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:390 (390.0 B)&nbsp; TX bytes:390 (390.0 B)</p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111493">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">laragofplay</div>
					<div class="post-datetime">
						19 Jun 2010, 02:19					</div>
				</div>
				<div class="post-content content">
					<p>if add wan and pptp as separate zones pptp not started, if wan &amp; pptp on one zone, masquerade not work to local... i don&#039;t know, it&#039;s may be...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111525">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">troex</div>
					<div class="post-datetime">
						19 Jun 2010, 13:36					</div>
				</div>
				<div class="post-content content">
					<p>I have similar issue but with static+pptp, pptp won&#039;t bring up after boot, a simple fix to bring it using /etc/rc.local:<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# cat /etc/rc.local 
# Put your custom commands here that should be executed once
# the system init finished. By default this file does nothing.

ifup vpn

exit 0</code></pre></div><p>I have wan and pptp sections separate<br /></p><div class="codebox"><pre><code>config interface wan
    option ifname     eth1
    option proto      static
    option ipaddr     10.69.9.120
    option netmask    255.255.248.0
    option gateway    10.69.8.1
    option dns        172.23.112.1

config interface vpn
    option proto        pptp
    option ifname       vpn
    option server       vpn3.interlan.ru
    option username     iuXXXXX
    option password     XXXXX</code></pre></div>											<p class="post-edited">(Last edited by <strong>troex</strong> on 19 Jun 2010, 13:37)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111672">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">laragofplay</div>
					<div class="post-datetime">
						21 Jun 2010, 17:37					</div>
				</div>
				<div class="post-content content">
					<p>i updated from 10.03 to trunk, use this config:</p><p>config &#039;interface&#039; &#039;loopback&#039;<br />&nbsp; &nbsp; option &#039;ifname&#039; &#039;lo&#039;<br />&nbsp; &nbsp; option &#039;proto&#039; &#039;static&#039;<br />&nbsp; &nbsp; option &#039;ipaddr&#039; &#039;127.0.0.1&#039;<br />&nbsp; &nbsp; option &#039;netmask&#039; &#039;255.0.0.0&#039;</p><p>config &#039;interface&#039; &#039;lan&#039;<br />&nbsp; &nbsp; option &#039;ifname&#039; &#039;eth0&#039;<br />&nbsp; &nbsp; option &#039;type&#039; &#039;bridge&#039;<br />&nbsp; &nbsp; option &#039;proto&#039; &#039;static&#039;<br />&nbsp; &nbsp; option &#039;ipaddr&#039; &#039;192.168.1.1&#039;<br />&nbsp; &nbsp; option &#039;netmask&#039; &#039;255.255.255.0&#039;</p><p>config &#039;interface&#039; &#039;wan&#039;<br />&nbsp; &nbsp; option &#039;peerdns&#039; &#039;1&#039;<br />&nbsp; &nbsp; option &#039;defaultroute&#039; &#039;1&#039;<br />&nbsp; &nbsp; option &#039;ifname&#039; &#039;ppp0&#039;<br />&nbsp; &nbsp; option &#039;proto&#039; &#039;pptp&#039;<br />&nbsp; &nbsp; option &#039;ppp_proto&#039; &#039;dhcp&#039;<br />&nbsp; &nbsp; option &#039;username&#039; &#039;myusername&#039;<br />&nbsp; &nbsp; option &#039;password&#039; &#039;mypassword&#039;<br />&nbsp; &nbsp; option &#039;keepalive&#039; &#039;10&#039;<br />&nbsp; &nbsp; option &#039;server&#039; &#039;vpn.internet.beeline.ru&#039;</p><p>config &#039;switch&#039; &#039;eth0&#039;<br />&nbsp; &nbsp; option &#039;reset&#039; &#039;1&#039;<br />&nbsp; &nbsp; option &#039;enable_vlan&#039; &#039;1&#039;</p><p>config &#039;switch_vlan&#039;<br />&nbsp; &nbsp; option &#039;device&#039; &#039;eth0&#039;<br />&nbsp; &nbsp; option &#039;vlan&#039; &#039;1&#039;<br />&nbsp; &nbsp; option &#039;ports&#039; &#039;0 1 2 3 4 5&#039;</p><p>config &#039;interface&#039; &#039;man&#039;<br />&nbsp; &nbsp; option &#039;proto&#039; &#039;dhcp&#039;<br />&nbsp; &nbsp; option &#039;ifname&#039; &#039;eth1&#039;</p><p>and this work! pptp connected! but no ping ya.ru from computers and no ping from router.</p><p>my route:</p><p>root@OpenWrt:~# route<br />Kernel IP routing table<br />Destination&nbsp; &nbsp; &nbsp;Gateway&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Genmask&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Flags Metric Ref&nbsp; &nbsp; Use Iface<br />85.21.80.93&nbsp; &nbsp; &nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;255.255.255.255 UH&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; 0 pptp-wan<br />192.168.1.0&nbsp; &nbsp; &nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;255.255.255.0&nbsp; &nbsp;U&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; 0 br-lan<br />10.190.184.0&nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;255.255.248.0&nbsp; &nbsp;U&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; 0 eth1<br />default&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;U&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; 0 pptp-wan</p><p>where my problem?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111673">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">laragofplay</div>
					<div class="post-datetime">
						21 Jun 2010, 17:39					</div>
				</div>
				<div class="post-content content">
					<p>root@OpenWrt:~# ifconfig<br />br-lan&nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 12:9C:E1:21:C9:8E<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:192.168.1.1&nbsp; Bcast:192.168.1.255&nbsp; Mask:255.255.255.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:162 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:63 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:15973 (15.5 KiB)&nbsp; TX bytes:12462 (12.1 KiB)</p><p>eth0&nbsp; &nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 12:9C:E1:21:C9:8E<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:164 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:63 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:18935 (18.4 KiB)&nbsp; TX bytes:12462 (12.1 KiB)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Interrupt:4</p><p>eth1&nbsp; &nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 42:9B:26:8A:21:33<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:10.190.186.14&nbsp; Bcast:10.190.191.255&nbsp; Mask:255.255.248.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:506 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:171 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:47921 (46.7 KiB)&nbsp; TX bytes:54745 (53.4 KiB)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Interrupt:5</p><p>lo&nbsp; &nbsp; &nbsp; &nbsp; Link encap:Local Loopback<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:127.0.0.1&nbsp; Mask:255.0.0.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP LOOPBACK RUNNING&nbsp; MTU:16436&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:60 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:60 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:4346 (4.2 KiB)&nbsp; TX bytes:4346 (4.2 KiB)</p><p>pptp-wan&nbsp; Link encap:Point-to-Point Protocol<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:89.179.10.81&nbsp; P-t-P:85.21.80.93&nbsp; Mask:255.255.255.255<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP POINTOPOINT RUNNING NOARP MULTICAST&nbsp; MTU:1452&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:4 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:154684 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:3<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:64 (64.0 B)&nbsp; TX bytes:70081749 (66.8 MiB)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p112198">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">troex</div>
					<div class="post-datetime">
						30 Jun 2010, 01:11					</div>
				</div>
				<div class="post-content content">
					<p>2 laragofplay:<br />When your pptp-wan interface goes up check that your interface is added to firewall rule<br /></p><div class="codebox"><pre><code>Apr  6 01:27:41 OpenWrt user.notice root: adding vpn (ppp0) to firewall zone wan</code></pre></div><p>also check /etc/config/firewall that you have your interface in wan rule:<br /></p><div class="codebox"><pre><code>config zone
    option name        wan
    option network    &quot;wan vpn&quot;
    option input    REJECT
    option output    ACCEPT 
    option forward    REJECT
    option masq        1 
    option mtu_fix    1</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p133932">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">jameslord</div>
					<div class="post-datetime">
						25 Apr 2011, 02:21					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jow wrote:</cite><blockquote><p>Hi.</p><p>Choose pptp. The client will try to obtain a DHCP lease before establishing a pptp connection.</p></blockquote></div><p>can you recommend kind of pptp client to us?<br />what about pptp - 1.7.1-3 - This package contains a PPTP (Point-to-Point Tunneling Protocol) client. ? will this client work?&nbsp; i want to use static ip + vpn tunnel <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />is any other pptp client that are easy to configure or acts efficiently?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p134449">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">aristo</div>
					<div class="post-datetime">
						2 May 2011, 17:29					</div>
				</div>
				<div class="post-content content">
					<p>I have the same problem. Also I`ve noticed, that pptp connection hangs after sending tons (up to hundreds of megabytes) of traffic (TX row in ifconfig output) without any answer. In this state connection has the correct IP, but still doesn`t work. If let this go, router LA will grow and it will reboot. I suppose there is some kind of race condition between pptp client and some other service. Any suggestions?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p146032">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">pythotiege</div>
					<div class="post-datetime">
						17 Oct 2011, 18:18					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>aristo wrote:</cite><blockquote><p>I have the same problem. Also I`ve noticed, that pptp connection hangs after sending tons (up to hundreds of megabytes) of traffic (TX row in ifconfig output) without any answer. In this state connection has the correct IP, but still doesn`t work. If let this go, router LA will grow and it will reboot. I suppose there is some kind of race condition between pptp client and some other service. Any suggestions?</p></blockquote></div><p>First of all check all the connections if there&#039;s any another service</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p210974">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">tc424</div>
					<div class="post-datetime">
						27 Aug 2013, 19:04					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jow wrote:</cite><blockquote><p>The ppp/pptp scripts in 10.03 have lot of issues, you should try trunk or current backfire branch to see if you have more luck with pptp.</p></blockquote></div><p>I think I&#039;ve sorted this in 10.03.1 by (a) making sure the underlying interface name is set in network.wan.device, and (b) commenting the pptp_scan() function out of /lib/network/pptp.sh. That script tries to configure the underlying interface, but pptp_scan() overrides the setting it needs. You can choose the method (e.g. dhcp, static) by setting network.wan.ipproto.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>