<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Installing OpenWrt in Xiaomi Wifi Mini</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 8 Feb 2018 and 5 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 10 of 21</div><nav><ul><li><a href="viewtopic.php%3Fid=54987&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=54987&amp;p=8.html">8</a></li><li><a href="viewtopic.php%3Fid=54987&amp;p=9.html">9</a></li><li class="pagination-current"><span>10</span></li><li><a href="viewtopic.php%3Fid=54987&amp;p=11.html">11</a></li><li><a href="viewtopic.php%3Fid=54987&amp;p=12.html">12</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=54987&amp;p=21.html">21</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p308534">
				<div class="post-metadata">
					<div class="post-num">Post #226</div>
					<div class="post-author">sharkys</div>
					<div class="post-datetime">
						21 Jan 2016, 22:53					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>StrangeOrange wrote:</cite><blockquote><p> </p><div class="codebox"><pre><code>iwpriv ra0 set NoForwarding=0
iwpriv rai0 set NoForwarding=0</code></pre></div></blockquote></div><p>Works well, I have added it into startup phase, <strong>thank you so much, really</strong>, as I was start to giving up already.</p><div class="quotebox"><cite>StrangeOrange wrote:</cite><blockquote><p> <br />Very often the modem that connects you to the Internet also has a private IP interface with a HTTP server listening, most often at 192.168.1.1 or 192.168.100.1. These settings allow you to reach it by going to <a href="http://modem/">http://modem/</a>. This can be useful to (depending on the modem hardware) view the event log, reboot the modem remotely, when the Internet link is down investigate the reason, sometimes there are even some tweaks that can be applied this way.</p></blockquote></div><p>Well, sorry for asking again, but I have no &#039;modem&#039;, I&#039;m connected via WAN (optics behind), getting IP via DHCP, so it is useless then, or ?<br />My point is then when I started to change manually the static IP of &#039;modem&#039;, I got disconnected completely from internet connection. The point is that I have already behind VPN something on 192.168.1.2 ...and also I have &quot;connection refused&quot; when trying <a href="http://modem/">http://modem/</a> even having VPN turned off anyway. I was originally thinking that it&#039;s some Firewall related problem (the problem with wifi clients pings/connections), as I saw Firewall-&gt;Custom rules...now I know it&#039;s not related, so I&#039;m rather curious. Thank you.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p308568">
				<div class="post-metadata">
					<div class="post-num">Post #227</div>
					<div class="post-author">StrangeOrange</div>
					<div class="post-datetime">
						22 Jan 2016, 05:52					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>sharkys wrote:</cite><blockquote><p>Well, sorry for asking again, but I have no &#039;modem&#039;, I&#039;m connected via WAN (optics behind), getting IP via DHCP, so it is useless then, or ?</p></blockquote></div><p>I guess so. You can remove the interface from <strong>/etc/config/network</strong> and clear the three lines in <strong>/etc/firewall.user</strong> that make it work, and it&#039;ll be gone.</p><p>Also, there is an entry for the modem in <strong>/etc/hosts</strong>, you may want to get rid of that too.</p><p>Just a suggestion but the fastest way to do it is to log in through SSH (PuTTY), type <strong>mc</strong> and press <em>Enter</em>. Use the file browser to locate each file, press <em>F4</em> to edit and when done <em>F2</em> to save, <em>Esc</em> to exit.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p308577">
				<div class="post-metadata">
					<div class="post-num">Post #228</div>
					<div class="post-author">StrangeOrange</div>
					<div class="post-datetime">
						22 Jan 2016, 08:05					</div>
				</div>
				<div class="post-content content">
					<p><strong>Re: PandoraBox and hardware-accelerated NAT</strong></p><p>If some websites are starting to take forever to load and never complete, HW NAT is the likely culprit. I had this issue today and switching it off cleared the problem for me, so if the same happens to any of you, you might want to try this first.</p><p>This might also be caused by a number of other factors, such as your modem overheating or suffering from a memory leak if it&#039;s been running for a long time without a reboot.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p308611">
				<div class="post-metadata">
					<div class="post-num">Post #229</div>
					<div class="post-author">fjorger</div>
					<div class="post-datetime">
						22 Jan 2016, 15:07					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>StrangeOrange wrote:</cite><blockquote><p><strong>Re: PandoraBox and hardware-accelerated NAT</strong></p><p>If some websites are starting to take forever to load and never complete, HW NAT is the likely culprit. I had this issue today and switching it off cleared the problem for me, so if the same happens to any of you, you might want to try this first.</p><p>This might also be caused by a number of other factors, such as your modem overheating or suffering from a memory leak if it&#039;s been running for a long time without a reboot.</p></blockquote></div><p>Hi StrangeOrange,</p><br /><p>Thanks for the warning.</p><br /><p>Regards,</p><p>FJorgeR.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p308623">
				<div class="post-metadata">
					<div class="post-num">Post #230</div>
					<div class="post-author">sharkys</div>
					<div class="post-datetime">
						22 Jan 2016, 16:33					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>StrangeOrange wrote:</cite><blockquote><div class="quotebox"><cite>sharkys wrote:</cite><blockquote><p>Well, sorry for asking again, but I have no &#039;modem&#039;, I&#039;m connected via WAN (optics behind), getting IP via DHCP, so it is useless then, or ?</p></blockquote></div><p>I guess so. You can remove the interface from <strong>/etc/config/network</strong> and clear the three lines in <strong>/etc/firewall.user</strong> that make it work, and it&#039;ll be gone.</p><p>Also, there is an entry for the modem in <strong>/etc/hosts</strong>, you may want to get rid of that too.</p><p>Just a suggestion but the fastest way to do it is to log in through SSH (PuTTY), type <strong>mc</strong> and press <em>Enter</em>. Use the file browser to locate each file, press <em>F4</em> to edit and when done <em>F2</em> to save, <em>Esc</em> to exit.</p></blockquote></div><p>Thank you....however when I was in cleaning process I found something weird - is it good idea to have hosts &quot;hardcoded&quot; ? </p><p>Eg. I got there :<br /></p><div class="codebox"><pre><code>10.0.0.1 OpenWrt
192.168.1.1 Modem</code></pre></div><p>...while Modem got somehow another internal IP and I renamed Openwrt to something else (in System -&gt; System), while my LAN IP is also different from 10.0.0.1. Maybe it&#039;s better to use Network -&gt; Hostnames instead ? (I guess it&#039;s not storing values in hosts...not sure about that)</p><p>Just my &#039;50&#039; cents.</p>											<p class="post-edited">(Last edited by <strong>sharkys</strong> on 23 Jan 2016, 07:59)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p308722">
				<div class="post-metadata">
					<div class="post-num">Post #231</div>
					<div class="post-author">kaper</div>
					<div class="post-datetime">
						23 Jan 2016, 16:19					</div>
				</div>
				<div class="post-content content">
					<p>Anybody who is running on StrangeOrange FW minimal version and have installed Transmission Deamon+Remote?<br />After few minutes / hours&nbsp; i get this error:</p><p>Unable to establish ubus connectionstack <br />traceback:&nbsp; &nbsp; &nbsp; &nbsp; [C]: in function &#039;?&#039;&nbsp; &nbsp; &nbsp; &nbsp; <br />?: in function &#039;ubus&#039;&nbsp; &nbsp; &nbsp; &nbsp; <br />?: in function &#039;dispatch&#039;&nbsp; &nbsp; &nbsp; &nbsp; <br />?: in function &lt;?:141&gt;</p><p>(After install u just edit etc/config/Transsmision conffig file for storing downloaded torrentss to my USB HDD mnt/sda1/Torrents/...</p><p>I am testing if it is really caused by Transmission or any other module/ files / etc... Thanks guys!</p><p>/edit: CONFIRMED, problem is caused by Transmission - any ideas?</p><p>---------------------------------------------------------------------------------------<br />edit1: I flashed v1216 and it seems, it is working, but after 1 hour there is a next problem:<br />I am really tired of testing this version, maybe i will go back to stable version without any issues at all... (Except 5G wifi won´t autoboot I can live with it)</p><p>Error after 1h:<br />/usr/lib/lua/luci/dispatcher.lua:448: Failed to execute function dispatcher target for entry &#039;/&#039;.The called action terminated with an exception:/usr/lib/lua/luci/sauth.lua:60: Security Exception: Session ID is invalid!stack traceback:&nbsp; &nbsp; &nbsp; &nbsp; [C]: in function &#039;assert&#039;&nbsp; &nbsp; &nbsp; &nbsp; /usr/lib/lua/luci/dispatcher.lua:448: in function &#039;dispatch&#039;&nbsp; &nbsp; &nbsp; &nbsp; /usr/lib/lua/luci/dispatcher.lua:195: in function &lt;/usr/lib/lua/luci/dispatcher.lua:194&gt;<br />Maybe anybody will know what can cause this error msg? Thanks!</p><p>edit2: Rebooted.. and test again if the problem occurs</p>											<p class="post-edited">(Last edited by <strong>kaper</strong> on 23 Jan 2016, 23:22)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p308789">
				<div class="post-metadata">
					<div class="post-num">Post #232</div>
					<div class="post-author">aldo</div>
					<div class="post-datetime">
						24 Jan 2016, 01:29					</div>
				</div>
				<div class="post-content content">
					<p>Hey StrangeOrange I have been running your openwrt optimal since today and 2 devices can&#039;t connect to the internet anymore.<br />A Philips Fidelio speaker (9800w) and the Heos link. </p><p>Could it be because of the different local IP range? I removed the MODEM switch and the text in firewall.user and hosts. Changed back the IP of the lan switch to 192.168.1.1. The two devices still won&#039;t connect and my macbook can&#039;t ssh into the router or reach the luci interface anymore.</p><p>Any idea&#039;s? I have an old settings backup from pandorabox. Perhaps replace some config files after a reset? Don&#039;t know which ones.</p>											<p class="post-edited">(Last edited by <strong>aldo</strong> on 24 Jan 2016, 01:43)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p308811">
				<div class="post-metadata">
					<div class="post-num">Post #233</div>
					<div class="post-author">kaper</div>
					<div class="post-datetime">
						24 Jan 2016, 09:37					</div>
				</div>
				<div class="post-content content">
					<p>Firstly i have to say, that i am disappointed that this FW is useless for me, i am missing some cool features from stock pandora, ip bandwidth...</p><p>I thought that this FW is tested, and is &quot;stable&quot;, but is not.<br />I tried to do all my best to test my patch, but its not stable at all. I tried both version.</p><p>I am back on STABLE release v1214 -&gt; there is one thing which not work, and it is autostart 5G wifi -&gt; i can live with it, but if anybody know how to fix it, i will be happy.<br />( I don´t know how and why. But my 5G now starts after reboot - <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> Nice... Hope this will stay)</p><p>Thanks to StrangeOrange, but if can recommend, i would better create stable FW - deoxided from bloatware, but i don´t see any sesne to remove bloatware from testing release, which are not stable.</p><p>Good luck to all. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> Byeee</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p308829">
				<div class="post-metadata">
					<div class="post-num">Post #234</div>
					<div class="post-author">StrangeOrange</div>
					<div class="post-datetime">
						24 Jan 2016, 15:28					</div>
				</div>
				<div class="post-content content">
					<p><em>Off-topic warning</em></p><div class="quotebox"><cite>kaper wrote:</cite><blockquote><p>Firstly i have to say, that i am disappointed that this FW is useless for me, [...]</p></blockquote></div><p>To put things in context, this person (user &quot;KartiQ&quot; from the MIUI forum, where I also posted this firmware) expected me to provide support over private messages and log in to his router remotely to fix his problems, and the problems were essentially that he wanted to reinstall and use the traffic accounting interface (&quot;IP Bandwidth&quot;), which I removed along with some other packages, but he did not want to build his own custom version from the sources I provided but instead wanted to do it by putting some of the removed files back into the filesystem. </p><p>I was assisting him initially but at some point, as it became apparent that my contribution towards finding a solution for his problem exceeded his own contribution, I bailed out. I <a href="http://en.miui.com/forum.php?mod=redirect&amp;goto=findpost&amp;ptid=208652&amp;pid=4010926">responded to him already</a> in the original thread, so I don&#039;t know what the purpose for bringing all this here is but if he had the same motivation towards patching PandoraBox that he has for discussing his expectations of what my patch should provide for him, we&#039;d already be halfway through to a flawless version of PandoraBox ready for everyone to flash.</p><p>To avoid causing any further disappointment, I&#039;d like to emphasize that I never claimed my patched firmware will be useful for user &quot;kaper&quot; or &quot;KarthiQ,&quot; or for anyone else for that matter. The way it works is basically: &quot;here it is, I did it, it works for me, and you can have it too, as it is.&quot; In particular, if your needs are very different than mine, you will need to evaluate your options carefully. Feel free to use my patch or the source as a base for what you want to have, but if you require some specific functionality, you might need to put some of your own work into setting it up. Please be aware of this. There are some limitations or bugs in PandoraBox, even with the latest version (their bug tracker currently has 49 issues open), and I could only deal with some of the most annoying things (from my point of view), I will not be able to fix all the other ones. </p><p>Thank you for your understanding, and I wish everyone a great Sunday evening or afternoon, depending on the timezone you are in.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p308833">
				<div class="post-metadata">
					<div class="post-num">Post #235</div>
					<div class="post-author">sharkys</div>
					<div class="post-datetime">
						24 Jan 2016, 15:46					</div>
				</div>
				<div class="post-content content">
					<p>@StrangeOrange, to be clear, for sure majority take it as it is, it&#039;s only your good will you are sharing it with us.<br />Any your response id absolutely on top and we really appreciate it. At least I do. THANK YOU, don&#039;t give up!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p308838">
				<div class="post-metadata">
					<div class="post-num">Post #236</div>
					<div class="post-author">kaper</div>
					<div class="post-datetime">
						24 Jan 2016, 16:31					</div>
				</div>
				<div class="post-content content">
					<p>Hello again, just to be clear.</p><p>I have no objection to your (StrangeOrange) person anything wrong, I just said my opinion and my experience with this FW. I tried rebuild it with your patches, as you helped me, but as you can see, i was getting errors.</p><p>As i wrote on MIUI Forum:<br />-You are talking with me as with developer, but I am not! Please respect it. I am just noob user, I am new in openwrt, and as every user, i just need some stable and solid FW in my small box.</p><p>- What is bad on PM? I just wrote you my login, for check settings, not for fixing my problems... nvm...</p><p>-I spent my 2 days of free time testing this fw and do this FW better, but i don´t enough skills and knowledge to make own custom FW etc.</p><p>-I am not blaming on you <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />.&nbsp; As I wrote, I appreciate your work, unfortunately things, which i need are not included, and i tried bring these things back, but everytime i had different problems.</p><p>I think only time will tell the views and experiences of other people on your work / FW. But I am afraid that few users are looking and using WRT on Xiaomi. Most of them are using original FW. (Although there is useless app on mobile, but for most ppl, this is so cool and they are happy with it...)</p><p>Just peace, and keep the good work.&nbsp; (Sry for my english)</p>											<p class="post-edited">(Last edited by <strong>kaper</strong> on 24 Jan 2016, 16:35)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p308857">
				<div class="post-metadata">
					<div class="post-num">Post #237</div>
					<div class="post-author">stamasd</div>
					<div class="post-datetime">
						24 Jan 2016, 18:07					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>StrangeOrange wrote:</cite><blockquote><p><strong>Re: PandoraBox and hardware-accelerated NAT</strong></p><p>If some websites are starting to take forever to load and never complete, HW NAT is the likely culprit. I had this issue today and switching it off cleared the problem for me, so if the same happens to any of you, you might want to try this first.</p><p>This might also be caused by a number of other factors, such as your modem overheating or suffering from a memory leak if it&#039;s been running for a long time without a reboot.</p></blockquote></div><p>Not sure if this has anything to do with this, but I found that the MiWiFi running PandoraBox after a while will not accept incoming connections from guests. The most reliable way to deal with this was to set a cron job to reboot the router every day at 3am.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p308881">
				<div class="post-metadata">
					<div class="post-num">Post #238</div>
					<div class="post-author">FENIX81</div>
					<div class="post-datetime">
						24 Jan 2016, 20:24					</div>
				</div>
				<div class="post-content content">
					<p>Hi StrangeOrange, thx for your work, this patched version rocks, best so far in my xiaomi mi wifi. I have setup 2.4ghz to act as a repeater, strong signal and flawless. Now I want to do the same with 5ghz, repeat another wifi signal, problem is that i cannot get results while scanning with this interface, i would like to put it in the same mode than the 2.4ghz and get all those results while scanning so i can repeat one of them with 5ghz interface, I don&#039;t know how can I achieve it (in case it is possible, maybe not?)</p><p>Thanks everybody for this useful forum/thread.</p><p>Regards</p><div class="quotebox"><cite>StrangeOrange wrote:</cite><blockquote><p><strong>Update #3 to my patched version, and this time a significant one</strong>, as I discovered <a href="http://downloads.pandorabox.org.cn/pandorabox/Xiaomi-Mini-R1CM/">where</a> some newer builds of PandoraBox are located. Accordingly, I was able to update the PandoraBox base for my images <strong>from release 1216 up to 1597</strong>, the latest one at the moment. It&#039;s still OpenWrt Barrier Breaker but it appears some parts were backported from newer branches.</p><p>There were many changes between the two releases, which meant I needed to redo a lot of my patches. There was some new stuff that needed to be removed and a couple of issues by default but I managed to sort them out (I think), and it all works well now, at least for me.</p><p>Some changes to the Wi-Fi setup suggest that performance might improve, and the package repository is slightly more up-to-date, so hopefully it was worth it. Also, as there&#039;s nothing wrong with the previous version, and flashing any new one might be potentially opening, so to say, Pandora<span class="bbu">&#039;s</span> box for some people, I kept the previous update (#2) in the downloads folder as well. Please make sure you get the one you want.</p><p>Just a short heads-up about this here so as not to abuse the hospitality of the OpenWrt forum (which is much appreciated) but I always update the original post whenever there is anything new so please look there for <strong><a href="https://forum.openwrt.org/viewtopic.php?pid=306678#p306678">full changelog and downloads</a></strong>.</p><p><em>(Anything below is unrelated to the new version announcement above.)</em></p><br /><div class="quotebox"><cite>darkpsy wrote:</cite><blockquote><p>If I set WPS setting to &quot;Disable&quot;, it&#039;s disabled indeed. But if I reboot the router - I see that WPS is enabled again</p></blockquote></div><p> That&#039;s not a bug, that&#039;s a &quot;feature&quot; of PandoraBox: just like the regulatory domain, the WPS settings are hardcoded into <strong>/lib/netifd/wireless/*.sh</strong> and <strong>/lib/wifi/*.sh</strong>, so you&#039;d need to make changes there. If you want to get rid of WPS completely, there&#039;s also <strong>/bin/wps_pbc</strong> activated from <strong>/etc/rc.button/reset</strong>.</p><div class="quotebox"><cite>irwan6179 wrote:</cite><blockquote><p>Anyone else having trouble using 5Ghz in client mode? I&#039;m using Luci but can&#039;t get the scanning button to work.</p></blockquote></div><p> I haven&#039;t really tried such a setup myself and in fact I wouldn&#039;t even have a way to test it now but I think your best bet is to have a look into the files above and see whatever hardcoded defaults are there that might be preventing it. This is a general note for anyone attempting a more complicated setup, the clash with the settings hardcoded into one of the myriad PandoraBox scripts is inevitable.</p><div class="quotebox"><cite>gazambuja wrote:</cite><blockquote><p>@StrangeOrange how to add new packages to this custom firmware? (I follow the *Edit* instructions)</p></blockquote></div><p> Manually: <strong>opkg --force-overwrite --offline-root /tmp/fw_fs install &lt;<em>PackageName</em>&gt;.ipk</strong></p><p>If you want to automate it, feel free to adapt to your needs the script <strong>4_Patch_Optimal.sh</strong> in <strong>scripts_patch.tar.gz</strong> within the <em>Source</em> ZIP file. If you were redoing the whole patch, you could just add them to the <strong>add_packages</strong> directory extracted with everything else from the <em>Source</em> file and put into <strong>/tmp/</strong> on the router, and then that script would install everything from that directory.</p><div class="quotebox"><cite>valentt wrote:</cite><blockquote><p>I live in EU and have lots of Huawei modems, and it would be great feature to have support for them in your image. Can you please consider putting Huawei drivers back in? </p><p>Also I would really like to be able to test how their traffic shaping works, that usually helps in having lower bufferbloat and better responsiveness.</p></blockquote></div><p>You can install any packages you want from the PandoraBox repository (see above for instructions). OpenWrt Barrier Breaker packages might also work, although I didn&#039;t test that. All the stuff I removed, including China DNS, Shadow Socks, Oray.com binaries, whatever they were supposed to do, etc. means there&#039;s more space for packages you choose to install yourself, and that&#039;s how OpenWrt is supposed to work in the first place (&quot;Wireless Freedom,&quot; not &quot;one size fits all&quot;).</p><p>Getting rid of the preloaded cruft was an important reason why I made this whole thing at all but if I&#039;m removing too much for your preference, you can also make your own custom version of the patch with the <em>Source</em> file I posted, and control what is being removed by editing <strong>rm_packages.txt</strong> and <strong>rm_files_*.txt</strong>. (As for the Huawei package in question, it&#039;s no longer preinstalled in the newer PandoraBox anyway, although it&#039;s probably still somewhere in the repository.)</p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p308915">
				<div class="post-metadata">
					<div class="post-num">Post #239</div>
					<div class="post-author">anarchy99</div>
					<div class="post-datetime">
						25 Jan 2016, 01:38					</div>
				</div>
				<div class="post-content content">
					<p>Hi</p><p>AnnoyingOrange</p><p>your tutorial failed with miwifi firmware so let&#039;s get back on subject</p><p>[Confidential information removed]</p>											<p class="post-edited">(Last edited by <strong>jow</strong> on 25 Jan 2016, 11:53)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p308916">
				<div class="post-metadata">
					<div class="post-num">Post #240</div>
					<div class="post-author">anarchy99</div>
					<div class="post-datetime">
						25 Jan 2016, 01:44					</div>
				</div>
				<div class="post-content content">
					<p>[Confidential information removed]</p>											<p class="post-edited">(Last edited by <strong>jow</strong> on 25 Jan 2016, 11:51)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p308918">
				<div class="post-metadata">
					<div class="post-num">Post #241</div>
					<div class="post-author">anarchy99</div>
					<div class="post-datetime">
						25 Jan 2016, 01:56					</div>
				</div>
				<div class="post-content content">
					<p>[Confidential information removed]</p>											<p class="post-edited">(Last edited by <strong>jow</strong> on 25 Jan 2016, 11:51)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p308955">
				<div class="post-metadata">
					<div class="post-num">Post #242</div>
					<div class="post-author">StrangeOrange</div>
					<div class="post-datetime">
						25 Jan 2016, 10:23					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>sharkys wrote:</cite><blockquote><p>THANK YOU, don&#039;t give up!</p></blockquote></div><p>Thank you, and other people who have expressed support. I really appreciate it. </p><div class="quotebox"><cite>stamasd wrote:</cite><blockquote><div class="quotebox"><cite>StrangeOrange wrote:</cite><blockquote><p><strong>Re: PandoraBox and hardware-accelerated NAT</strong></p><p>If some websites are starting to take forever to load and never complete, HW NAT is the likely culprit. I had this issue today and switching it off cleared the problem for me, so if the same happens to any of you, you might want to try this first.</p></blockquote></div><p>Not sure if this has anything to do with this, but I found that the MiWiFi running PandoraBox after a while will not accept incoming connections from guests. The most reliable way to deal with this was to set a cron job to reboot the router every day at 3am.</p></blockquote></div><p>Is this already with &quot;Hardware Accelerate&quot; switched off? Didn&#039;t happen to me so far (not sure about the longest uptime but my current one is 3 days and I put the router through some heavy traffic periods over this time). Although there are a lot of what seems to be driver debug messages logged with the &quot;alert&quot; priority, these seem harmless.</p><div class="quotebox"><cite>FENIX81 wrote:</cite><blockquote><p>I have setup 2.4ghz to act as a repeater, strong signal and flawless. Now I want to do the same with 5ghz, repeat another wifi signal, problem is that i cannot get results while scanning with this interface, i would like to put it in the same mode than the 2.4ghz and get all those results while scanning so i can repeat one of them with 5ghz interface, I don&#039;t know how can I achieve it (in case it is possible, maybe not?)</p></blockquote></div><p>The complete configuration settings for each interface are saved in <strong>/tmp/profiles/rt2860v2_<em>&lt;2|5&gt;</em>g.dat</strong> (these are generated by the scripts in <strong>/lib/netifd/wireless/*</strong> and <strong>/lib/wifi/*</strong>). The good news is, since both 2.4 GHz and 5 GHz seem to be using the same driver (rt2860v2), the settings are in the same format, and as you already managed to set it up on 2.4 GHz, perhaps you could move the relevant settings to the other file to see if that makes it work the same way too.</p><p>Those files are overwritten every time the scripts run but it seems they are only being used indirectly because of the symbolic links to them from <strong>/etc/Wireless/MT76X2/MT7612.dat</strong> and <strong>/etc/Wireless/RT2860/RT2860.dat</strong>, which are the configuration file paths that are actually hard-coded into the driver:</p><p><strong>strings /lib/modules/`uname -r`/mt76x2e.ko | fgrep /etc/</strong></p><p>Knowing this, to test your own settings for the 5 GHz interface, you could: </p><ul><li><p>Comment out line 29 in <strong>/lib/wifi/mt7612.sh</strong> by putting a pound (#) sign in front of it. This disables relinking to the automatically-generated config file:</p></li></ul><div class="quotebox"><blockquote><p><span style="color: red"><strong>#</strong></span>&nbsp; &nbsp; &nbsp; &nbsp; ln -s $CFG_FILES_2ND /etc/Wireless/MT76X2/MT7612.dat 2&gt;/dev/null</p></blockquote></div><ul><li><p>Remove the currently existing link:<br /><strong>rm -f /etc/Wireless/MT76X2/MT7612.dat</strong><br /></p></li><li><p>Link the configuration file the driver expects to find to your custom file:<br /><strong>ln -s MT76X2_Experiment.dat /etc/Wireless/MT76X2/MT7612.dat</strong><br /></p></li><li><p>Create your own configuration by merging the relevant settings from <strong>/tmp/profiles/*.dat</strong> and save it as <strong>/etc/Wireless/MT76X2/MT7612_Experiment.dat</strong></p></li></ul><p>Note: I didn&#039;t test this, so it might need some polishing, but in principle it should work, and this trick could also be adopted to straighten out other driver configuration-related driver issues (regulatory domain, WPS state, etc.) without extensively modifying the script files, and just bypassing them altogether instead.</p><p>As for what the particular settings mean and how to adjust them, maybe the text files included in this source code of a related driver can be helpful: <a href="http://pan.baidu.com/share/link?shareid=570477101&amp;uk=939937960">download link</a>, <a href="http://www.right.com.cn/forum/thread-128299-1-1.html">discussion</a> (Chinese). (If anyone has a better source of documentation for the driver settings, please share.)</p>											<p class="post-edited">(Last edited by <strong>StrangeOrange</strong> on 25 Jan 2016, 10:51)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p308966">
				<div class="post-metadata">
					<div class="post-num">Post #243</div>
					<div class="post-author">StrangeOrange</div>
					<div class="post-datetime">
						25 Jan 2016, 11:10					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>sharkys wrote:</cite><blockquote><p>I found something weird - is it good idea to have hosts &quot;hardcoded&quot; ? </p><p>Eg. I got there :<br /></p><div class="codebox"><pre><code>10.0.0.1 OpenWrt
192.168.1.1 Modem</code></pre></div><p>...while Modem got somehow another internal IP and I renamed Openwrt to something else (in System -&gt; System), while my LAN IP is also different from 10.0.0.1. Maybe it&#039;s better to use Network -&gt; Hostnames instead ? (I guess it&#039;s not storing values in hosts...not sure about that)</p><p>Just my &#039;50&#039; cents.</p></blockquote></div><p>I somehow missed this previous post from you and didn&#039;t answer before, sorry.</p><p>There needs to be some default IP address for the local interface. I changed it to 10.0.0.1 for the reasons I mentioned before but even if I didn&#039;t do it, there would still need to be another address there (192.168.1.1 by default).</p><p>On OpenWrt this is not just the usual hosts file but also where the DNS server gets its records from for DNS and reverse-DNS lookups, and I mainly put it there for this purpose. This allows you to, by default, open <a href="http://openwrt/">http://openwrt/</a> to reach the Web interface, whether in the Minimal or Optimal version (with different default IP addresses). It also makes it possible to have a &quot;green padlock&quot; (no certificate warnings) by just adding the default certificate as trusted, without changing any other settings. I was hoping setting it up like that would save a lot of time for a lot of people: no need to do anything unless you want to change the default hostname, and if you want to change it, you know that you need to do it in this file as well.</p><p>As for the modem part, I thought it&#039;s much easier to remove it if someone doesn&#039;t need it rather than to figure out where and how to add it, and many people can benefit from this option. Also, it should be harmless unless someone is beyond a double NAT, and there are hosts on the 192.168.1.0/24 subnet they need to access as well (quite an unusual setup but perhaps I&#039;m wrong?). I am open to removing it if there is a consensus against it, particularly so if it breaks someone&#039;s default setup.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p309078">
				<div class="post-metadata">
					<div class="post-num">Post #244</div>
					<div class="post-author">sharkys</div>
					<div class="post-datetime">
						26 Jan 2016, 16:27					</div>
				</div>
				<div class="post-content content">
					<p>No problem @StrangeOrange for me, really. The point was just it wasn&#039;t expected to be there while eg. you are using LuCi as I do to make required config, but I see your point now.... naturally it&#039;s very easy to be removed, so really no issue for me. There are much more important stuff, like for example make it rock stable ;-)</p><p>Btw, so far, with HW NAT disabled, all is fine so far.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p309103">
				<div class="post-metadata">
					<div class="post-num">Post #245</div>
					<div class="post-author">StrangeOrange</div>
					<div class="post-datetime">
						26 Jan 2016, 20:35					</div>
				</div>
				<div class="post-content content">
					<p><strong>International PandoraBox/OpenWrt updated, based on a newer yet PandoraBox release 1696.</strong></p><p>Since PandoraBox keeps evolving to include more and more packages, with this update I took a new approach and as an experiment decided to keep most of what was added, only removing the China-specific stuff, FTP server, MWAN, and the (incomplete anyway) translations to languages other than English.</p><p>As a result, the current version includes in particular <em>IP Bandwidth</em>, the traffic accounting interface that I used to remove with my patch and <em>Transmission</em>, a BitTorrent Client (new in this release), as well as a couple of other packages that will be immediately noticeable from the Web interface menu. All the kernel modules that were originally provided have also been kept, with the single exception of the Simplified Chinese codepage.</p><p>Hopefully this change is in line with what (at least the most vocal) people wanted, so let&#039;s see how it works out.</p><p>As you will notice immediately when trying to log in to the Web interface, PandoraBox now comes with the <em>Material</em> theme as the default one. I kept it this way and made it the default in the <em>Optimal</em> version as well. The previous <em>Bootstrap</em> theme is still included however, so you can switch back to it whenever you want to. I fixed the double-slash URL issues in both of them and also removed the badly-formatted &quot;Loading...&quot; text in the <em>Material</em> theme, so it should be really enjoyable.</p><p>This new PandoraBox version also seems to have added support for some USB network cards through kernel modules: a question about it was asked before, and now it should be possible to deduce whether a card is supported by looking at the file list in <strong>/lib/modules/...</strong>.</p><p>There are now three international PandoraBox versions to choose from, so hopefully there will be something for everyone:</p><ul><li><p>Release 1216 has been used the longest and seems to work well with packages from the repository. It is also the smallest in size.</p></li><li><p>Release 1597 improves 2.4 GHz Wi-Fi performance and backports some functionality from newer OpenWrt versions but trying to install certain packages on top of it seems to fail for some people.</p></li><li><p>Release 1696 has the potential to be the best PandoraBox yet but only time will tell whether this is the case. It also remains to be seen whether there is any impact on performance due to its larger size.</p></li></ul><p>I have been using release 1696 myself since I finished patching it earlier today and it works well for me but since I want to share it with everyone as soon as it is available, it could not be extensively tested, so please have that in mind.</p><ul><li><p><a href="https://forum.openwrt.org/viewtopic.php?pid=306678#p306678">Downloads and more information as usual in the original post</a></p></li></ul><p><strong>New version of Breed bootloader also available</strong></p><p>In other news, there is also a new version of Breed bootloader (release 833). According to the changelog the update was principally about adding support for more devices but maybe there are some smaller changes that did not warrant a mention. I mirrored it in the downloads folder but did not get to try it myself yet.</p><p><em>Thank you everyone, and hope you enjoy it.</em></p>											<p class="post-edited">(Last edited by <strong>StrangeOrange</strong> on 26 Jan 2016, 20:39)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p309104">
				<div class="post-metadata">
					<div class="post-num">Post #246</div>
					<div class="post-author">sharkys</div>
					<div class="post-datetime">
						26 Jan 2016, 20:41					</div>
				</div>
				<div class="post-content content">
					<p>@StrangeOrange, this sounds awesome, but let me ask you - what is the best way to perform upgrade please ?</p><div class="codebox"><pre><code>jffs2reset -y
sysupgrade -n &lt;filename&gt;.bin</code></pre></div><p>...and then restore config eg. via LuCI ?</p><p>Eg. no way to do it via LuCI directly ?</p><p>Btw, where to check the current PandoraBox version ? I mean mostly &quot;release&quot;.</p><p>Thank you once more.</p>											<p class="post-edited">(Last edited by <strong>sharkys</strong> on 26 Jan 2016, 20:45)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p309113">
				<div class="post-metadata">
					<div class="post-num">Post #247</div>
					<div class="post-author">StrangeOrange</div>
					<div class="post-datetime">
						26 Jan 2016, 21:35					</div>
				</div>
				<div class="post-content content">
					<p>On first boot in the Optimal version the <strong>/sbin/revert_config</strong> script will run, so the configuration will not be preserved throughout the upgrade but it can be restored anytime later. The way I&#039;d do it:</p><ul><li><p>To save (where <em>[...]</em> are any other filenames you want to backup as well):<br /><strong>tar czvf /tmp/config_backup.tar.gz /etc/config/* /etc/dropbear/* /etc/ethers /etc/hosts <em>[...]</em></strong></p></li><li><p>Store the backup file outside the device, and then copy it over again after the update.</p></li><li><p>To restore:<br /><strong>tar xzvf /tmp/config_backup.tar.gz -C /</strong></p></li></ul><p>After restoring the configuration manually you need to do <strong>/sbin/reload_config</strong> or <strong>reboot</strong>.</p><p>This is just one way to go about it, and probably far from the best. Backup and restore through the Web interface should work to the same effect, it&#039;s just that I never used it, so I don&#039;t know.</p><p><span style="color: red"><strong>Update: The above is a simplified <span class="bbu">example</span>. You need to <span class="bbu">adjust</span> it to your specific situation. Do not overwrite all the configuration with files saved from a different version and expect it to work.</strong></span></p><p><span style="color: blue"><strong>Copy only the files that you changed (from /overlay) and manually merge the changes into the new files, or, if you want to have a truly automated, version-independent configuration, one way would be to keep it as a list of <em>uci</em> commands.</strong></span></p>											<p class="post-edited">(Last edited by <strong>StrangeOrange</strong> on 27 Jan 2016, 06:03)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p309128">
				<div class="post-metadata">
					<div class="post-num">Post #248</div>
					<div class="post-author">sharkys</div>
					<div class="post-datetime">
						26 Jan 2016, 23:37					</div>
				</div>
				<div class="post-content content">
					<p>Seeems that on latest version Luci don&#039;t work, at least I&#039;m getting error below :</p><div class="codebox"><pre><code>error loading module &#039;luci.controller.commands&#039; from file &#039;/usr/lib/lua/luci/controller/commands.lua&#039;:
    /usr/lib/lua/luci/controller/commands.lua: unexpected end in precompiled chunk
stack traceback:
    [C]: ?
    [C]: in function &#039;require&#039;
    ?: in function &#039;createindex&#039;
    ?: in function &#039;createtree&#039;
    ?: in function &#039;dispatch&#039;
    ?: in function &lt;?:141&gt;</code></pre></div><p>I took <strong>XMWiFiMini-OpenWrt-PandoraBox-14.09r1696-StrangeOrange-Optimal-U4</strong></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p309146">
				<div class="post-metadata">
					<div class="post-num">Post #249</div>
					<div class="post-author">StrangeOrange</div>
					<div class="post-datetime">
						27 Jan 2016, 05:54					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>sharkys wrote:</cite><blockquote><p>Seeems that on latest version Luci don&#039;t work</p></blockquote></div><p>Reflashed it just to check again, and it does work for me:</p><p><span class="postimg"><img src="http://i.imgur.com/uu2QbgQ.png" alt="http://i.imgur.com/uu2QbgQ.png" /></span></p><p>Could it be because you changed some configuration files? </p><p>The way to backup and restore the configuration I posted above was an <span class="bbu">example</span> I was hoping you would <span class="bbu">adjust</span> to your needs. I will edit that post now with a warning. If you overwrite all the configuration with the files from the previous version, I would expect something like that to happen.</p><p>If it&#039;s some other change please share what it was but it does work by default, with either theme.</p>											<p class="post-edited">(Last edited by <strong>StrangeOrange</strong> on 27 Jan 2016, 06:07)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p309155">
				<div class="post-metadata">
					<div class="post-num">Post #250</div>
					<div class="post-author">sharkys</div>
					<div class="post-datetime">
						27 Jan 2016, 07:43					</div>
				</div>
				<div class="post-content content">
					<p>Thank you, problem was naturally with <strong>/etc/config/luci</strong> only...</p><p>**update** Does qos-scm works for you in Luci ? Maybe I would need to redo config manually ? ...hm</p><p>Also I can&#039;t install now watchcat :<br /></p><div class="codebox"><pre><code>Collected errors:
 * satisfy_dependencies_for: Cannot satisfy the following dependencies for luci-app-watchcat:
 *     watchcat * 
 * opkg_install_cmd: Cannot install package luci-app-watchcat.</code></pre></div>											<p class="post-edited">(Last edited by <strong>sharkys</strong> on 27 Jan 2016, 07:50)</p>
									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 10 of 21</div><nav><ul><li><a href="viewtopic.php%3Fid=54987&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=54987&amp;p=8.html">8</a></li><li><a href="viewtopic.php%3Fid=54987&amp;p=9.html">9</a></li><li class="pagination-current"><span>10</span></li><li><a href="viewtopic.php%3Fid=54987&amp;p=11.html">11</a></li><li><a href="viewtopic.php%3Fid=54987&amp;p=12.html">12</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=54987&amp;p=21.html">21</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0.001 -->

</body>
</html>