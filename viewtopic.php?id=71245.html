<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Is my TP-link bricked or can it be rescued?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 28 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p360446">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">bojan.pogacar</div>
					<div class="post-datetime">
						15 Jun 2017, 18:45					</div>
				</div>
				<div class="post-content content">
					<p>Hello!</p><p>I had an openwrt router (TP-Link TL-WDR3600).</p><p>Because of an electricity problem or user who was powering on/off many times after, the router don&#039;t boot any more.</p><p>Power led and led with arrows in a circle (the first from the right) are ON all the time and that is it.<br />If I plug in UTP cable the LAN led also lits.</p><p>Is any hope for this router?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p360461">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">slh</div>
					<div class="post-datetime">
						15 Jun 2017, 22:57					</div>
				</div>
				<div class="post-content content">
					<p>Check the wiki and follow the tftp rescue procedure.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p360471">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">bojan.pogacar</div>
					<div class="post-datetime">
						16 Jun 2017, 01:55					</div>
				</div>
				<div class="post-content content">
					<p>Hello!</p><p>I had to use my RPi to connect to serial or jtag pins of my router.</p><p>This was my serial output:</p><p>U-Boot 1ÂŽLÂBÂřŽĂÂ@9 2013 - 14:28:Â´LJCÂĄHÂ¨ĂŐ˝Â˝ĂŃÂB120</p><p>&nbsp; &nbsp; &nbsp; &nbsp; j&nbsp; &nbsp; &nbsp; &nbsp;5id read 0x100000ff<br />ÂÍĄĂŠ@ 8 MBpMB, sector couĂŽÂşîşOÂ¤&amp;&amp;SHĂĂČ<br />Using default envĂŠÂšĂéšŤÂÂĂĽĂ5<br />RKÂÂĂÉĽÂet OK!ÂĄĺĄĄÂĄÂĄÂĄÂ<br />Âą5<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Out:&nbsp; &nbsp;seÂ˛ZXÂHÂ¨%ĂĂŠ@&nbsp; serial<br />Net:&nbsp; &nbsp;ag934x_eĂŽĂdĂ´ĂĂŠÉŽ5 wasp&nbsp; rÍĽÂŽÂŠ+5ÂĂŠĂ03300<br />WASP&nbsp; ---ÂéÂÂŞĂÂ X-ÂÂŤkĂ<br />Ă&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Ó<br />ĂÉT<br />: cfg1 0x7 cfg2Â ÂÂźS)Â˘j)Ăżeth0: ba:be:fa:ce:08ÂşÂLCĂĄathrs1ÂˇĂĂ˛ĂĽĂ§áˇZ+ÂĂŠAcomplete<br />eth0 up<br />eth0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ÂUsing etĂ¨ÂčÂ˛YWkU5TFTP from serveĂ˛ÂLN&amp;)Â˛Ărň˛rÂ˛Â˛ĂÚÂ˝ĂĂŐÂP addresed 10Â°é°°Â </p><p>Router boots normaly, when I press CTRL+C, till then just waits.</p><p>I tried to flash the latest openwrt image and problem persists... It is waiting for something .. (TFTPD??)</p><p>How can I fix that.</p><p>Thank you!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p360501">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Antek</div>
					<div class="post-datetime">
						16 Jun 2017, 22:15					</div>
				</div>
				<div class="post-content content">
					<p>The serial output shows that the serial line settings are incorrect and you get garbled output. Try adjusting the baud rate, stop bits and parity to see if you can get clear-text output.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p360502">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">bojan.pogacar</div>
					<div class="post-datetime">
						16 Jun 2017, 22:29					</div>
				</div>
				<div class="post-content content">
					<p>Hello!</p><p>I am using minicom on RPi and scrambled text is just until I press CTRL+C. After CTRL+Crouter quits tring to get firmware from TFTP 192.168.0.66<br />When openwrt boots text is just fine, so I don&#039;t know how to fix that.</p><p>Problem is that router on every boot tries to load firmware from TFTP and it sits in that loop.</p><p>After examining visually Reset button it don&#039;t seem to be pressed all the time (broken)</p><p>Is there any other reason that uboot would be locked it TFTP loading on every boot?</p><p>Would it be any better if I would try to flash stock firmware with boot included (boot in filename)?. Would it fix uboot and load new one or would it do even more damage?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p360505">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Antek</div>
					<div class="post-datetime">
						16 Jun 2017, 23:26					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>bojan.pogacar wrote:</cite><blockquote><p>Problem is that router on every boot tries to load firmware from TFTP and it sits in that loop.</p></blockquote></div><p>Do I understand you correctly that the U-boot bootloader tries to load a firmware image from TFTP after a power cycle, and loops there until you hit &#039;CTRL+C&#039;? And when you do, it proceeds to load the OpenWRT firmware without issues?</p><p>This sounds very odd. Perhaps the bootloader is damaged or misconfigured? Also, some routers have what is called a &#039;bootsel&#039; pin on the PCB. These pins, when shorted or bridged in a specific way, instruct the CPU or the U-boot where it should primarily boot. Since we do not know what exactly happened, electrically or user-wise, then we don&#039;t know for sure.</p><p>Since I do not know the internals of your router, it is extremely difficult to say what causes the misbehavior. Fixing the bootloader of a router is always a precarious process since a mishap there will render the entire router more or less dead.</p><div class="quotebox"><blockquote><p>Is there any other reason that uboot would be locked it TFTP loading on every boot?</p></blockquote></div><p>You can try interrupting the U-boot and try typing &#039;printenv&#039;, if this command is available. The &#039;bootcmd&#039; environment variable will tell you how the bootloader is trying to proceed after it has initialized the system. Together with the U-boot manual from <a href="https://www.denx.de/wiki/DULG/Manual">https://www.denx.de/wiki/DULG/Manual</a> you should be able to determine what exactly is happening. U-boot has specific commands that it uses for booting from flash or RAM (bootm) or from TFTP (bootp)</p><div class="quotebox"><blockquote><p>Would it be any better if I would try to flash stock firmware with boot included (boot in filename)?. Would it fix uboot and load new one or would it do even more damage?</p></blockquote></div><p>Before we know more of what&#039;s happening to U-boot, flashing a stock firmware on top might do more harm than good. The stock firmwares are usually intended to be flashed from a graphical UI of the router&#039;s management portal, and as such, they might not be suitable for flashing directly from the bootloader environment.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p360509">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">bojan.pogacar</div>
					<div class="post-datetime">
						16 Jun 2017, 23:37					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Antek wrote:</cite><blockquote><p>Do I understand you correctly that the U-boot bootloader tries to load a firmware image from TFTP after a power cycle, and loops there until you hit &#039;CTRL+C&#039;? And when you do, it proceeds to load the OpenWRT firmware without issues?</p></blockquote></div><p>Yes, you are right.</p><p>What about if I provide an image to TFTP client of uboot. What about doing what it says on openwrt page about WDR 3600 to</p><div class="quotebox"><blockquote><p>cp openwrt-ar71xx-generic-tl-wdr3600-v1-squashfs-FACTORY.bin wdr3600v1_tp_recovery.bin</p></blockquote></div><p>Would uboot take this image and repair &quot;boot address&quot; if it is a software problem?</p><p>Could this damages my router ever further or is it safe?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p360514">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">mk24</div>
					<div class="post-datetime">
						17 Jun 2017, 01:12					</div>
				</div>
				<div class="post-content content">
					<p>You should get clean text from the outset.&nbsp; &nbsp;Try using a regular USB-serial adapter.&nbsp; Make sure your ground is hooked up properly.&nbsp; Do not connect anything to the 3.3 volt power pin on the serial header. </p><p>Holding the reset button or finding a bad firmware header / checksum / something activates the TFTP-recovery mode.&nbsp; Test the reset button with a voltmeter it should have 3.3 volts across it when not pressed.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>