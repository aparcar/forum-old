<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> How to block some websites with LUCI (OpenWRT)</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 7 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p324646">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">vjg</div>
					<div class="post-datetime">
						18 May 2016, 22:53					</div>
				</div>
				<div class="post-content content">
					<p>I have LUCI and OpenWRT. I know that I need to edit some files to do that, for example dnsmasq.conf and so on. But I don&#039;t know how to edit them. I don&#039;t see this option in LUCI.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324648">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Xotic750</div>
					<div class="post-datetime">
						18 May 2016, 22:57					</div>
				</div>
				<div class="post-content content">
					<p>You can create a rule in the <em>firewall</em> section in <em>luci</em>, <em>traffics rules</em>. You have provided too little information to be able to be more explicit, or even be certain that this is the best course of action.</p><p><span class="postimg"><img src="http://s32.postimg.org/ldhgafrr9/Screenshot_from_2016_05_18_21_58_34.png" alt="http://s32.postimg.org/ldhgafrr9/Screenshot_from_2016_05_18_21_58_34.png" /></span></p><p>Some background reading. <a href="https://wiki.openwrt.org/doc/uci/firewall">https://wiki.openwrt.org/doc/uci/firewall</a></p>											<p class="post-edited">(Last edited by <strong>Xotic750</strong> on 18 May 2016, 23:01)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324649">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">vjg</div>
					<div class="post-datetime">
						18 May 2016, 23:07					</div>
				</div>
				<div class="post-content content">
					<p>Yes, I have found &quot;Firewall - Traffic Rules&quot;. I made a new rule &quot;parent control&quot;. </p><p>I think that I need to write something here &quot;Extra arguments&quot;. For example I want to block &quot;google.com&quot;. What do I need to write in &quot;Extra arguments&quot; to do that?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324652">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">vjg</div>
					<div class="post-datetime">
						18 May 2016, 23:24					</div>
				</div>
				<div class="post-content content">
					<p>This is &quot;Network - Traffic Rules&quot;. I made the new rule &quot;parcontrol&quot;.<br /><span class="postimg"><img src="http://s019.radikal.ru/i610/1605/3a/8b96d2422dfa.jpg" alt="http://s019.radikal.ru/i610/1605/3a/8b96d2422dfa.jpg" /></span></p><p>You can see &quot;extra arguments&quot;. I think that I need to write here something to block &quot;google.com&quot;<br /><span class="postimg"><img src="http://i075.radikal.ru/1605/97/a2c1801a77e4.jpg" alt="http://i075.radikal.ru/1605/97/a2c1801a77e4.jpg" /></span></p>											<p class="post-edited">(Last edited by <strong>vjg</strong> on 18 May 2016, 23:25)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324653">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">Xotic750</div>
					<div class="post-datetime">
						18 May 2016, 23:25					</div>
				</div>
				<div class="post-content content">
					<p>That probably isn&#039;t the best place to add such a rule. But next to that is <em>Custom Rules</em> and you can probably just do the following for your example of blocking <em>google.com</em></p><div class="codebox"><pre><code>iptables -A INPUT -s google.com -j DROP
iptables -A OUTPUT -d google.com -j DROP</code></pre></div><p>Some may argue that <em>REJECT</em> would be preferable over <em>DROP</em>. But I&#039;m no expert.</p><p><a href="http://linux.die.net/man/8/iptables">iptables</a></p>											<p class="post-edited">(Last edited by <strong>Xotic750</strong> on 18 May 2016, 23:28)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324655">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">vjg</div>
					<div class="post-datetime">
						18 May 2016, 23:29					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Xotic750 wrote:</cite><blockquote><p>That probably isn&#039;t the best place to add such a rule. But next to that is <em>Custom Rules</em> and you can probably just do the following for your example of blocking <em>google.com</em></p><div class="codebox"><pre><code>iptables -A INPUT -s google.com -j DROP
iptables -A OUTPUT -d google.com -j DROP</code></pre></div><p>Some may argue that <em>REJECT</em> would be preferable over <em>DROP</em>. But I&#039;m no expert.</p><p><a href="http://linux.die.net/man/8/iptables">iptables</a></p></blockquote></div><p>Ok, I will try to do it. Thank you for help.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324658">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">Max Hopper</div>
					<div class="post-datetime">
						18 May 2016, 23:53					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>iptables wrote:</cite><blockquote><p><strong>-s</strong>, <strong>--source</strong> [!] address[/mask]<br />Source specification. Address can be either a network name, a hostname <strong>(please note that specifying any name to be resolved with a remote query such as DNS is a really bad idea)</strong>, a network IP address (with /mask), or a plain IP address.</p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324667">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">Xotic750</div>
					<div class="post-datetime">
						19 May 2016, 00:49					</div>
				</div>
				<div class="post-content content">
					<p>Perhaps <a href="https://www.privoxy.org/">privoxy</a> would be a better solution for this example (if you have the space and resources for it on your device)?</p><p><a href="https://wiki.openwrt.org/doc/howto/proxy.privoxy">https://wiki.openwrt.org/doc/howto/proxy.privoxy</a></p><p>Personally for parental control, I use <a href="https://www.opendns.com/">openDNS</a>, I don&#039;t have the resources to do it myself.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324729">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">Max Hopper</div>
					<div class="post-datetime">
						19 May 2016, 10:07					</div>
				</div>
				<div class="post-content content">
					<p>A <a href="https://forum.openwrt.org/viewtopic.php?id=62204">possibility</a>?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324756">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">vjg</div>
					<div class="post-datetime">
						19 May 2016, 14:30					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Xotic750 wrote:</cite><blockquote><p>That probably isn&#039;t the best place to add such a rule. But next to that is <em>Custom Rules</em> and you can probably just do the following for your example of blocking <em>google.com</em></p><div class="codebox"><pre><code>iptables -A INPUT -s google.com -j DROP
iptables -A OUTPUT -d google.com -j DROP</code></pre></div><p>Some may argue that <em>REJECT</em> would be preferable over <em>DROP</em>. But I&#039;m no expert.</p><p><a href="http://linux.die.net/man/8/iptables">iptables</a></p></blockquote></div><p>I tried to do it, but this does not work. </p><div class="quotebox"><cite>Xotic750 wrote:</cite><blockquote><p>Perhaps <a href="https://www.privoxy.org/">privoxy</a> would be a better solution for this example (if you have the space and resources for it on your device)?</p><p><a href="https://wiki.openwrt.org/doc/howto/proxy.privoxy">https://wiki.openwrt.org/doc/howto/proxy.privoxy</a></p><p>Personally for parental control, I use <a href="https://www.opendns.com/">openDNS</a>, I don&#039;t have the resources to do it myself.</p></blockquote></div><p>Free space: 94% (4.34 MB). I hope that 4,34Mb will be enough. </p><div class="quotebox"><cite>Max Hopper wrote:</cite><blockquote><p>A <a href="https://forum.openwrt.org/viewtopic.php?id=62204">possibility</a>?</p></blockquote></div><p>Ok, I will try to install &quot;privoxy&quot; and this <a href="https://forum.openwrt.org/viewtopic.php?id=62204">possibility</a> to see it will work or not.</p>											<p class="post-edited">(Last edited by <strong>vjg</strong> on 19 May 2016, 14:31)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324760">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">boolsheat</div>
					<div class="post-datetime">
						19 May 2016, 14:43					</div>
				</div>
				<div class="post-content content">
					<p>Use the hosts file on you router.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324761">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">vjg</div>
					<div class="post-datetime">
						19 May 2016, 14:43					</div>
				</div>
				<div class="post-content content">
					<p>I tried to install privoxy. Of course I need to read manual. I have found manual here (first steps): <a href="https://www.privoxy.org/user-manual/startup.html">https://www.privoxy.org/user-manual/startup.html</a></p><div class="quotebox"><blockquote><p>Starting Privoxy</p><p>Before launching Privoxy for the first time, you will want to configure your browser(s) to use Privoxy as a HTTP and HTTPS (SSL) proxy. The default is 127.0.0.1 (or localhost) for the proxy address, and port 8118 (earlier versions used port 8000). This is the one configuration step that must be done!</p><p>Please note that Privoxy can only proxy HTTP and HTTPS traffic. It will not work with FTP or other protocols.</p><p>Figure 2. Proxy Configuration Showing Mozilla/Netscape HTTP and HTTPS (SSL) Settings</p></blockquote></div><p>But I can&#039;t change proxy setting. I use Chromium with Linux mint. I tried to change proxy setting but I saw this :</p><div class="quotebox"><blockquote><p>When running Chromium under a supported desktop environment, the system proxy settings will be used. However, either your system is not supported or there was a problem launching your system configuration.</p><p>But you can still configure via the command line. Please see man chromium-browser for more information on flags and environment variables.</p></blockquote></div><p>I run &quot;chromium-browser&quot; in command line but I don&#039;t see any solution (how to change proxy for Chromium for Linux Mint).</p>											<p class="post-edited">(Last edited by <strong>vjg</strong> on 19 May 2016, 14:44)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324763">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">vjg</div>
					<div class="post-datetime">
						19 May 2016, 14:54					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>boolsheat wrote:</cite><blockquote><p>Use the hosts file on you router.</p></blockquote></div><p>Did you mean &quot;Network -&gt; hostnames&quot;? I added google.com to &quot;host name&quot; (Network-&gt; Hostnames-&gt;&quot;Add&quot;-&gt; &quot;google.com&quot; -&gt; &quot;216.58.214.46&quot;&nbsp; but this does not work. I want to block &quot;google.com&quot; but I can open &quot;google.com&quot;.</p><p>If you don&#039;t mean &quot;hostnames&quot; I don&#039;t see &quot;hosts file&quot; in LUCI (OpenWRT)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324766">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">vjg</div>
					<div class="post-datetime">
						19 May 2016, 15:13					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Max Hopper wrote:</cite><blockquote><p>A <a href="https://forum.openwrt.org/viewtopic.php?id=62204">possibility</a>?</p></blockquote></div><p>I downloaded this (https://github.com/stangri/openwrt-simple-adblock ) but I don&#039;t see button in Luci &quot;download software&quot;. I don&#039;t know how to install this possibility.</p><p>I run &quot;adblock&quot;&nbsp; in terminal (sudo sh adblock) but this does not work.</p><p>I see this possibility but I need to know how to install this (of course I can download this software from &quot;github&quot;, of course I can extract this software but I do not know what to do next). Luci has &quot;a graphical interface&quot; and I don&#039;t see &quot;button&quot; or &quot;terminal&quot; that can help to install this software (in Luci)</p>											<p class="post-edited">(Last edited by <strong>vjg</strong> on 19 May 2016, 15:22)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324770">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">Max Hopper</div>
					<div class="post-datetime">
						19 May 2016, 15:36					</div>
				</div>
				<div class="post-content content">
					<p>Correct. The service requires CLI skills (it is a <strong>possibility</strong>).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324775">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">vjg</div>
					<div class="post-datetime">
						19 May 2016, 15:48					</div>
				</div>
				<div class="post-content content">
					<p>Ok, but I have one problem. I don&#039;t see &quot;terminal&quot; in LUCI. To do something in &quot;terminal&quot; (command line) you need to find it. I see &quot;terminal&quot; in Linux Mint. But I don&#039;t see &quot;command line&quot; &quot;terminal&quot; in Luci (OpenWRT). </p><p>How can I improve &quot; bash/command-line skills&quot; if I don&#039;t see it in Luci?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324777">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">vjg</div>
					<div class="post-datetime">
						19 May 2016, 16:06					</div>
				</div>
				<div class="post-content content">
					<p>I have found the button &quot;Download and install package&quot; in Luci.</p><p>I see &quot;Available packages&quot;, and I don&#039;t see this &quot;adblock&quot; (this possibility). How can I add this software to &quot;Available packages&quot;?</p><p>My &quot;Available packages&quot;:<br />1. acl<br />2. agetty<br />3. ahcpd<br />4. aiccu<br />etc</p>											<p class="post-edited">(Last edited by <strong>vjg</strong> on 19 May 2016, 16:10)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324798">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">Xotic750</div>
					<div class="post-datetime">
						19 May 2016, 18:30					</div>
				</div>
				<div class="post-content content">
					<p>The terminal is not under <em>luci</em>. You would need to <a href="http://linuxcommand.org/man_pages/ssh1.html">ssh</a> from a terminal on your PC to your router IP.</p><p>I don&#039;t understand why you can&#039;t change the proxy settings on your PC</p><div class="quotebox"><cite>boolsheat wrote:</cite><blockquote><p>Use the hosts file on you router.</p></blockquote></div><p>This requires that you <em>ssh</em> to your router then <em>vi /etc/hosts </em> and add an entry like</p><div class="codebox"><pre><code>127.0.0.1 google.com</code></pre></div><p><a href="https://en.wikipedia.org/wiki/Hosts_(file)">https://en.wikipedia.org/wiki/Hosts_(file)</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324934">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">boolsheat</div>
					<div class="post-datetime">
						20 May 2016, 12:23					</div>
				</div>
				<div class="post-content content">
					<p>Yes, you can use WinSCP and use SCP protocol so its really easy to edit the file. I think its the best way. Example of a host file that blocks some google and facebook adresses:<br /><a href="http://mistman.pdp10.org/pub/comp/internet-tools/hostsfiles/goofbook/hosts">http://mistman.pdp10.org/pub/comp/inter … book/hosts</a></p><p>Another good resource for blocking ads, porn, malware, ec.:<br /><a href="https://github.com/StevenBlack/hosts">https://github.com/StevenBlack/hosts</a></p><p>Also note:<br />We recommend using 0.0.0.0 instead of 127.0.0.1</p><p>Using 0.0.0.0 is faster because you don&#039;t have to wait for a timeout. It also does not interfere with a web server that may be running on the local PC.</p>											<p class="post-edited">(Last edited by <strong>boolsheat</strong> on 20 May 2016, 12:29)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p325329">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">vjg</div>
					<div class="post-datetime">
						22 May 2016, 20:52					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Xotic750 wrote:</cite><blockquote><p>The terminal is not under <em>luci</em>. You would need to <a href="http://linuxcommand.org/man_pages/ssh1.html">ssh</a> from a terminal on your PC to your router IP.</p><p>I don&#039;t understand why you can&#039;t change the proxy settings on your PC</p><div class="quotebox"><cite>boolsheat wrote:</cite><blockquote><p>Use the hosts file on you router.</p></blockquote></div><p>This requires that you <em>ssh</em> to your router then <em>vi /etc/hosts </em> and add an entry like</p><div class="codebox"><pre><code>127.0.0.1 google.com</code></pre></div><p><a href="https://en.wikipedia.org/wiki/Hosts_(file)">https://en.wikipedia.org/wiki/Hosts_(file)</a></p></blockquote></div><p>Xotic750, thank you for vi and for ssh. Your idea is to work.&nbsp; Now I can change the proxy settings on my PC. </p><p>Also I used Putty SSH client (Linux Mint) and added&nbsp; 127.0.0.01 google.com<br />Now I can&#039;t open google.com. So this thing is to work.</p><p>But I can open news.google.com and support.google.com and google.com/mars/</p><p>How can I block any site with google.com For example, I&#039;d like to block something like that *google.com*</p><p>And I have some PC. I&#039;d like that some PC has all access and some PC has limited access.</p><p>If I add /etc/hosts (127.0.0.1 google.com) I think that google.com will be blocked on all my PC. But I&#039;d like to block google.com (this is only example) only for some PC.</p>											<p class="post-edited">(Last edited by <strong>vjg</strong> on 22 May 2016, 21:16)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p325330">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">vjg</div>
					<div class="post-datetime">
						22 May 2016, 21:04					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>boolsheat wrote:</cite><blockquote><p>Yes, you can use WinSCP and use SCP protocol so its really easy to edit the file. I think its the best way. Example of a host file that blocks some google and facebook adresses:<br /><a href="http://mistman.pdp10.org/pub/comp/internet-tools/hostsfiles/goofbook/hosts">http://mistman.pdp10.org/pub/comp/inter … book/hosts</a></p><p>Another good resource for blocking ads, porn, malware, ec.:<br /><a href="https://github.com/StevenBlack/hosts">https://github.com/StevenBlack/hosts</a></p><p>Also note:<br />We recommend using 0.0.0.0 instead of 127.0.0.1</p><p>Using 0.0.0.0 is faster because you don&#039;t have to wait for a timeout. It also does not interfere with a web server that may be running on the local PC.</p></blockquote></div><p>I have Linux Mint and I can&#039;t use WinSCP. I don&#039;t know but maybe WinSCP is only for Windows. But I have found Putty SSH client is to work also.</p><p>You gave me a host file with a lot of links. But it&#039;s not easy to write all names to host file (need time). Can I download these examples, make my own host file (with bad web sites) and copy this host file to router?</p>											<p class="post-edited">(Last edited by <strong>vjg</strong> on 22 May 2016, 21:10)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p325335">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">Xotic750</div>
					<div class="post-datetime">
						22 May 2016, 21:23					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>vjg wrote:</cite><blockquote><div class="quotebox"><cite>Xotic750 wrote:</cite><blockquote><p>The terminal is not under <em>luci</em>. You would need to <a href="http://linuxcommand.org/man_pages/ssh1.html">ssh</a> from a terminal on your PC to your router IP.</p><p>I don&#039;t understand why you can&#039;t change the proxy settings on your PC</p><div class="quotebox"><cite>boolsheat wrote:</cite><blockquote><p>Use the hosts file on you router.</p></blockquote></div><p>This requires that you <em>ssh</em> to your router then <em>vi /etc/hosts </em> and add an entry like</p><div class="codebox"><pre><code>127.0.0.1 google.com</code></pre></div><p><a href="https://en.wikipedia.org/wiki/Hosts_(file)">https://en.wikipedia.org/wiki/Hosts_(file)</a></p></blockquote></div><p>Xotic750, thank you for vi and for ssh. Your idea is to work.&nbsp; Now I can change the proxy settings on my PC. </p><p>Also I used Putty SSH client (Linux Mint) and added&nbsp; 127.0.0.01 google.com<br />Now I can&#039;t open google.com. So this thing is to work.</p><p>But I can open news.google.com and support.google.com and google.com/mars/</p><p>How can I block any site with google.com For example, I&#039;d like to block something like that *google.com*</p><p>And I have some PC. I&#039;d like that some PC has all access and some PC has limited access.</p><p>If I add /etc/hosts (127.0.0.1 google.com) I think that google.com will be blocked on all my PC. But I&#039;d like to block google.com (this is only example) only for some PC.</p></blockquote></div><p>I don&#039;t believe there is any way to do what you are now asking with the <em>hosts</em> file. You will need to look <em>privoxy</em> for something like that I think.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>