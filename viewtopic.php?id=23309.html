<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Problem with broadcom chip router and Atheros wifi cards, who knows?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 10 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p101242">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">youngjd</div>
					<div class="post-datetime">
						23 Jan 2010, 16:59					</div>
				</div>
				<div class="post-content content">
					<p>I have two wireless router:<br />1.Buffalo wzr-g300n, bcm4704+bcm5325F+bcm4306,4M flash/16M RAM, I change the bcm4306 mini-pci wifi card with bcm4318, no problem.<br />2.Buffalo WZR-g54, bcm4704+bcm5325+bcm4306, 4M flash/64M RAM</p><p>I want to change the wifi card with atheros cards. I&nbsp; tried 3 mini-PCI cards:&nbsp; atheros ar2413 / ar5212a( HP w500) /ar9160 (MB82 ) on&nbsp; both router, but these 3 cards can&#039;t work, NO wifi function!&nbsp; I have tried the newest version openwrt and dd-wrt, all failed.</p><p>under the new version openwrt, there is no lspci command, Under dd-wrt , no lspci command too, but under dd-wrt, I use &quot;cat /proc/pci&quot; command , I can see the atheros card is in&nbsp; PCI devices list.<br />I look at the &quot;ath_hal-20090508.tgz &quot;,&nbsp; in file&nbsp; ah_devid.h, I can see the right DeviceID of my 3 atheros cards.</p><p>so, who knows why?</p>											<p class="post-edited">(Last edited by <strong>youngjd</strong> on 23 Jan 2010, 17:05)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p101252">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						23 Jan 2010, 19:16					</div>
				</div>
				<div class="post-content content">
					<p>Did you install kmod-madwifi after changing the cards? You also need to regenerate the wireless configuration<br /></p><div class="codebox"><pre><code>rm /etc/config/wireless; wifi detect &gt; /etc/config/wireless</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p101255">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">youngjd</div>
					<div class="post-datetime">
						23 Jan 2010, 20:25					</div>
				</div>
				<div class="post-content content">
					<p>After I changed atheros wife , I&nbsp; flash the openwrt BCM47XX version. Is this version official&nbsp; support atheros?&nbsp; Does openwrt bcm47xx version need install kmod-madwifi ? and need regenerate the wireless configuration ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p101277">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						24 Jan 2010, 03:40					</div>
				</div>
				<div class="post-content content">
					<p>Yes, you need to do install kmod-madwifi, yes you need to regenerate the configuration.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p101280">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">youngjd</div>
					<div class="post-datetime">
						24 Jan 2010, 05:21					</div>
				</div>
				<div class="post-content content">
					<p>My mini-PCI cards is AR9160 (MB82). <br />I installed kmod-madwifi , No use. and I also tried another driver kmod-ath9k, faile too.</p><p>this is the dmesg</p><p>Linux version 2.6.30.10 (buildbot@tesla) (gcc version 4.3.3 (GCC) ) #1 Fri Jan 22 13:12:52 UTC 2010<br />CPU revision is: 00029006 (Broadcom BCM3302)<br />ssb: Core 0 found: ChipCommon (cc 0x800, rev 0x03, vendor 0x4243)<br />ssb: Core 1 found: Fast Ethernet (cc 0x806, rev 0x06, vendor 0x4243)<br />ssb: Core 2 found: Fast Ethernet (cc 0x806, rev 0x06, vendor 0x4243)<br />ssb: Core 3 found: USB 1.1 Hostdev (cc 0x808, rev 0x02, vendor 0x4243)<br />ssb: Core 4 found: PCI (cc 0x804, rev 0x08, vendor 0x4243)<br />ssb: Core 5 found: MIPS 3302 (cc 0x816, rev 0x00, vendor 0x4243)<br />ssb: Core 6 found: V90 (cc 0x807, rev 0x02, vendor 0x4243)<br />ssb: Core 7 found: IPSEC (cc 0x80B, rev 0x00, vendor 0x4243)<br />ssb: Core 8 found: MEMC SDRAM (cc 0x80F, rev 0x00, vendor 0x4243)<br />ssb: Initializing MIPS core...<br />ssb: core 0x0800, irq : 2(S)&nbsp; 3* 4&nbsp; 5&nbsp; 6&nbsp; D&nbsp; I <br />ssb: core 0x0806, irq : 2(S)&nbsp; 3&nbsp; 4* 5&nbsp; 6&nbsp; D&nbsp; I <br />ssb: core 0x0806, irq : 2(S)&nbsp; 3&nbsp; 4&nbsp; 5* 6&nbsp; D&nbsp; I <br />ssb: core 0x0808, irq : 2(S)* 3&nbsp; 4&nbsp; 5&nbsp; 6&nbsp; D&nbsp; I <br />ssb: core 0x0804, irq : 2(S)&nbsp; 3&nbsp; 4&nbsp; 5&nbsp; 6* D&nbsp; I <br />ssb: core 0x0816, irq : 2(S)* 3&nbsp; 4&nbsp; 5&nbsp; 6&nbsp; D&nbsp; I <br />ssb: core 0x0807, irq : 2(S)* 3&nbsp; 4&nbsp; 5&nbsp; 6&nbsp; D&nbsp; I <br />ssb: core 0x080b, irq : 2(S)* 3&nbsp; 4&nbsp; 5&nbsp; 6&nbsp; D&nbsp; I <br />ssb: core 0x080f, irq : 2(S)&nbsp; 3&nbsp; 4&nbsp; 5&nbsp; 6&nbsp; D&nbsp; I*<br />ssb: set_irq: core 0x0806, irq 4 =&gt; 4<br />ssb: set_irq: core 0x0806, irq 5 =&gt; 5<br />ssb: after irq reconfiguration<br />ssb: core 0x0800, irq : 2(S)&nbsp; 3* 4&nbsp; 5&nbsp; 6&nbsp; D&nbsp; I <br />ssb: core 0x0806, irq : 2(S)&nbsp; 3&nbsp; 4* 5&nbsp; 6&nbsp; D&nbsp; I <br />ssb: core 0x0806, irq : 2(S)&nbsp; 3&nbsp; 4&nbsp; 5* 6&nbsp; D&nbsp; I <br />ssb: core 0x0808, irq : 2(S)* 3&nbsp; 4&nbsp; 5&nbsp; 6&nbsp; D&nbsp; I <br />ssb: core 0x0804, irq : 2(S)&nbsp; 3&nbsp; 4&nbsp; 5&nbsp; 6* D&nbsp; I <br />ssb: core 0x0816, irq : 2(S)* 3&nbsp; 4&nbsp; 5&nbsp; 6&nbsp; D&nbsp; I <br />ssb: core 0x0807, irq : 2(S)* 3&nbsp; 4&nbsp; 5&nbsp; 6&nbsp; D&nbsp; I <br />ssb: core 0x080b, irq : 2(S)* 3&nbsp; 4&nbsp; 5&nbsp; 6&nbsp; D&nbsp; I <br />ssb: core 0x080f, irq : 2(S)&nbsp; 3&nbsp; 4&nbsp; 5&nbsp; 6&nbsp; D&nbsp; I*<br />ssb: Sonics Silicon Backplane found at address 0x18000000<br />Serial init done.<br />Determined physical RAM map:<br /> memory: 04000000 @ 00000000 (usable)<br />Initrd not found or empty - disabling initrd<br />Zone PFN ranges:<br />&nbsp; Normal&nbsp; &nbsp;0x00000000 -&gt; 0x00004000<br />Movable zone start PFN for each node<br />early_node_map[1] active PFN ranges<br />&nbsp; &nbsp; 0: 0x00000000 -&gt; 0x00004000<br />On node 0 totalpages: 16384<br />free_area_init_node: node 0, pgdat 802b2710, node_mem_map 81000000<br />&nbsp; Normal zone: 128 pages used for memmap<br />&nbsp; Normal zone: 0 pages reserved<br />&nbsp; Normal zone: 16256 pages, LIFO batch:3<br />Built 1 zonelists in Zone order, mobility grouping on.&nbsp; Total pages: 16256<br />Kernel command line: root=/dev/mtdblock2 rootfstype=squashfs,jffs2 noinitrd console=ttyS0,115200<br />Primary instruction cache 16kB, VIPT, 2-way, linesize 16 bytes.<br />Primary data cache 16kB, 2-way, VIPT, cache aliases, linesize 16 bytes<br />NR_IRQS:128<br />PID hash table entries: 256 (order: 8, 1024 bytes)<br />console [ttyS0] enabled<br />Dentry cache hash table entries: 8192 (order: 3, 32768 bytes)<br />Inode-cache hash table entries: 4096 (order: 2, 16384 bytes)<br />Memory: 61724k/65536k available (2345k kernel code, 3736k reserved, 420k data, 132k init, 0k highmem)<br />Calibrating delay loop... 263.16 BogoMIPS (lpj=526336)<br />Mount-cache hash table entries: 512<br />net_namespace: 1008 bytes<br />NET: Registered protocol family 16<br />bio: create slab &lt;bio-0&gt; at 0<br />Switched to high resolution mode on CPU 0<br />NET: Registered protocol family 2<br />IP route cache hash table entries: 1024 (order: 0, 4096 bytes)<br />TCP established hash table entries: 2048 (order: 2, 16384 bytes)<br />TCP bind hash table entries: 2048 (order: 1, 8192 bytes)<br />TCP: Hash tables configured (established 2048 bind 2048)<br />TCP reno registered<br />NET: Registered protocol family 1<br />squashfs: version 4.0 (2009/01/31) Phillip Lougher<br />Registering mini_fo version $Id$<br />JFFS2 version 2.2. (NAND) (SUMMARY)&nbsp; Â© 2001-2006 Red Hat, Inc.<br />msgmni has been set to 120<br />alg: No test for stdrng (krng)<br />io scheduler noop registered<br />io scheduler deadline registered (default)<br />Serial: 8250/16550 driver, 2 ports, IRQ sharing enabled<br />serial8250: ttyS0 at MMIO 0xb8000300 (irq = 3) is a 16550A<br />serial8250: ttyS1 at MMIO 0xb8000400 (irq = 3) is a 16550A<br />serial8250.0: ttyS0 at MMIO 0xb8000300 (irq = 3) is a 16550A<br />serial8250.0: ttyS1 at MMIO 0xb8000400 (irq = 3) is a 16550A<br />b44.c:v2.0<br />eth0: Broadcom 44xx/47xx 10/100BaseT Ethernet 00:0d:0b:27:17:dc<br />eth1: Broadcom 44xx/47xx 10/100BaseT Ethernet 00:0d:0b:27:17:dd<br />flash init: 0x1c000000 0x02000000<br />Physically mapped flash: Found 1 x16 devices at 0x0 in 16-bit bank<br />Physically mapped flash: Found an alias at 0x400000 for the chip at 0x0<br />Physically mapped flash: Found an alias at 0x800000 for the chip at 0x0<br />Physically mapped flash: Found an alias at 0xc00000 for the chip at 0x0<br />Physically mapped flash: Found an alias at 0x1000000 for the chip at 0x0<br />Physically mapped flash: Found an alias at 0x1400000 for the chip at 0x0<br />Physically mapped flash: Found an alias at 0x1800000 for the chip at 0x0<br />Physically mapped flash: Found an alias at 0x1c00000 for the chip at 0x0<br /> Intel/Sharp Extended Query Table at 0x0035<br />Using auto-unlock on power-up/resume<br />cfi_cmdset_0001: Erase suspend on write enabled<br />erase region 0: offset=0x0,size=0x2000,blocks=8<br />erase region 1: offset=0x10000,size=0x10000,blocks=63<br />Flash device: 0x400000 at 0x1fc00000<br />bootloader size: 262144<br />Creating 4 MTD partitions on &quot;Physically mapped flash&quot;:<br />0x000000000000-0x000000040000 : &quot;cfe&quot;<br />0x000000040000-0x0000003f0000 : &quot;linux&quot;<br />0x000000120c00-0x0000003f0000 : &quot;rootfs&quot;<br />mtd: partition &quot;rootfs&quot; must either start or end on erase block boundary or be smaller than an erase block -- forcing read-only<br />mtd: partition &quot;rootfs&quot; set to be root filesystem<br />mtd: partition &quot;rootfs_data&quot; created automatically, ofs=2C0000, len=130000 <br />0x0000002c0000-0x0000003f0000 : &quot;rootfs_data&quot;<br />0x0000003f0000-0x000000400000 : &quot;nvram&quot;<br />BCM47xx Watchdog Timer enabled (30 seconds, nowayout)<br />TCP westwood registered<br />NET: Registered protocol family 17<br />Bridge firewalling registered<br />802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;<br />All bugs added by David S. Miller &lt;davem@redhat.com&gt;<br />VFS: Mounted root (squashfs filesystem) readonly on device 31:2.<br />Freeing unused kernel memory: 132k freed<br />Please be patient, while OpenWrt loads ...<br />diag: Detected &#039;Buffalo (unknown)&#039;<br />b44: eth0: Link is up at 100 Mbps, full duplex.<br />b44: eth0: Flow control is off for TX and off for RX.<br />roboswitch: Probing device eth0: No Robo switch in managed mode found, phy_id = 0xffffffff<br />roboswitch: Probing device eth1: &lt;3&gt;roboswitch: [/var/lib/buildbot/slave/brcm47xx-trunk/build/build_dir/linux-brcm47xx/kmod-switch/switch-robo.c:131] SIOCGETCPHYRD failed!<br />roboswitch: [/var/lib/buildbot/slave/brcm47xx-trunk/build/build_dir/linux-brcm47xx/kmod-switch/switch-robo.c:131] SIOCGETCPHYRD failed!<br />No Robo switch in managed mode found, phy_id = 0xffffffff<br />roboswitch: Probing device eth2: No such device<br />roboswitch: Probing device eth3: No such device<br />b44: eth0: powering down PHY<br />mini_fo: using base directory: /<br />mini_fo: using storage directory: /jffs<br />b44: eth0: Link is up at 100 Mbps, full duplex.<br />b44: eth0: Flow control is off for TX and off for RX.<br />device eth0 entered promiscuous mode<br />br-lan: port 1(eth0) entering forwarding state<br />b44: eth1: powering down PHY<br />br-lan: port 1(eth0) entering disabled state<br />br-lan: port 1(eth0) entering forwarding state<br />Generic kernel compatibility enabled based on linux-next next-20100113<br />cfg80211: Calling CRDA to update world regulatory domain<br />b44: eth1: Link is up at 10 Mbps, half duplex.<br />b44: eth1: Flow control is off for TX and off for RX.<br />roboswitch: Probing device eth0: No Robo switch in managed mode found, phy_id = 0xffffffff<br />roboswitch: Probing device eth1: Invalid phy address (5)<br />roboswitch: Probing device eth2: No such device<br />roboswitch: Probing device eth3: No such device<br />Broadcom 43xx driver loaded [ Features: PL, Firmware-ID: FW13 ]<br />Broadcom 43xx-legacy driver loaded [ Features: PLID, Firmware-ID: FW10 ]<br />PPP generic driver version 2.4.2<br />ip_tables: (C) 2000-2006 Netfilter Core Team<br />NET: Registered protocol family 24<br />nf_conntrack version 0.5.0 (1024 buckets, 4096 max)<br />CONFIG_NF_CT_ACCT is deprecated and will be removed soon. Please use<br />nf_conntrack.acct=1 kernel paramater, acct=1 nf_conntrack module option or<br />sysctl net.netfilter.nf_conntrack_acct=1 to enable it.<br />ath_hal: module license &#039;Proprietary&#039; taints kernel.<br />Disabling lock debugging due to kernel taint<br />ath_hal: 2009-05-08 (AR5210, AR5211, AR5212, AR5416, RF5111, RF5112, RF2413, RF5413, RF2133, RF2425, REGOPS_FUNC, XR)<br />ath_pci: trunk<br />wlan: trunk<br />wlan: mac acl policy registered<br />ath_rate_minstrel: Minstrel automatic rate control algorithm 1.2 (trunk)<br />ath_rate_minstrel: look around rate set to 10%<br />ath_rate_minstrel: EWMA rolloff level set to 75%<br />ath_rate_minstrel: max segment size in the mrr set to 6000 us<br />root@OpenWrt:/jffs/lib/wifi# exit</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>