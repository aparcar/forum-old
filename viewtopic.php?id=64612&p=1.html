<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Need help unbricking a MR3020...</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 20 Apr 2018 and 28 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=64612&amp;p=2.html">2</a></li></ul></nav></div>
			
		
		
			<article class="post" id="p322375">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">ichiban</div>
					<div class="post-datetime">
						3 May 2016, 15:16					</div>
				</div>
				<div class="post-content content">
					<p>Hey guys,</p><p>My first post here on openWRT forums. Hoping some of you guys can give me some input on how to solve the problem I have been having. </p><p>I have recently acquired a MR3020 for airplay purposes via USB audio. While trying to flash a firmware via Windows/Firefox after rebooting the device does not seem to be working or accessible via telnet. </p><p>Entering failsafe openWRT works, the LED flashes and I am able to enter telnet to 192.168.1.1. However the problem is when I use the command passwd it is a &quot;read-only&quot; file. Now when I try the command mount_root, it says invalid. </p><p>I am stuck on how to restore a factory firmware on the device. I want to get it back to the original firmware if anything. Or get it to work. </p><p>Not sure where I messed up but any input would be greatly appreciated! </p><p>Much thanks.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p322379">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Xotic750</div>
					<div class="post-datetime">
						3 May 2016, 16:22					</div>
				</div>
				<div class="post-content content">
					<p>It doesn&#039;t sound bricked. Have you tried <em>ssh root@192.168.1.1</em> with <strong>password</strong>?</p>											<p class="post-edited">(Last edited by <strong>Xotic750</strong> on 3 May 2016, 16:28)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p322380">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">ichiban</div>
					<div class="post-datetime">
						3 May 2016, 16:27					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve never set a password before... Is there a default password? I have no tried to SSH yet. I am using a windows machine, just got ubuntu dual-boot to my other laptop.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p322381">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Xotic750</div>
					<div class="post-datetime">
						3 May 2016, 16:30					</div>
				</div>
				<div class="post-content content">
					<p><a href="https://forum.openwrt.org/viewtopic.php?id=64596">Someone else had a problem with connecting</a> with <em>ssh</em> in the threads and he had to disable the Windows firewall before he could connect.</p>											<p class="post-edited">(Last edited by <strong>Xotic750</strong> on 3 May 2016, 16:32)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p322386">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">ichiban</div>
					<div class="post-datetime">
						3 May 2016, 16:57					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Xotic750 wrote:</cite><blockquote><p><a href="https://forum.openwrt.org/viewtopic.php?id=64596">Someone else had a problem with connecting</a> with <em>ssh</em> in the threads and he had to disable the Windows firewall before he could connect.</p></blockquote></div><p>Using my linux machine I still couldn&#039;t SSH or Telnet in regular operation mode. <br />In failsafe, I can only Telnet and not SSH.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p322387">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Xotic750</div>
					<div class="post-datetime">
						3 May 2016, 17:04					</div>
				</div>
				<div class="post-content content">
					<p>What does <em>nmap 192.168.1.1</em> show when you device is in regular operation?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p322392">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">ichiban</div>
					<div class="post-datetime">
						3 May 2016, 17:37					</div>
				</div>
				<div class="post-content content">
					<p>When I run nmap to the MR3020, it says hosts seems down.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p322394">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">aru</div>
					<div class="post-datetime">
						3 May 2016, 17:42					</div>
				</div>
				<div class="post-content content">
					<p>I think you can transfer&nbsp; 15.05.1 image to your router and use sysupgrade to flash</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p322398">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">ichiban</div>
					<div class="post-datetime">
						3 May 2016, 18:06					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>aru wrote:</cite><blockquote><p>I think you can transfer&nbsp; 15.05.1 image to your router and use sysupgrade to flash</p></blockquote></div><p>Not sure how I can transfer the new image and flash over... <br />Is there an easier way that doesn&#039;t require me to type all this random stuff into the terminal to get it going? <br />I tried the netcat solution on windows and it doesn&#039;t work. Not even sure what else I can do....<br />Perhaps there&#039;s a way on Linux?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p322407">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">aru</div>
					<div class="post-datetime">
						3 May 2016, 19:12					</div>
				</div>
				<div class="post-content content">
					<p>put the image on your linux box web server and use wget to fetch.<br />And nc is also a nice way.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p322409">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">ichiban</div>
					<div class="post-datetime">
						3 May 2016, 19:59					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>aru wrote:</cite><blockquote><p>put the image on your linux box web server and use wget to fetch.<br />And nc is also a nice way.</p></blockquote></div><p>Any step by step guide to do that? <br />Sorry but I am new to the whole linux OS and openWRT stuff.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p322454">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">aru</div>
					<div class="post-datetime">
						4 May 2016, 05:46					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>ichiban wrote:</cite><blockquote><p>Any step by step guide to do that? <br />Sorry but I am new to the whole linux OS and openWRT stuff.</p></blockquote></div><p>Connect MR3020 wan port to another working router lan port， and your computer connect to MR3020 lan port.&nbsp; &nbsp;login to MR3020 by telnet, execute following commands<br />opkg update<br />opkg install luci<br />/etc/init.d/uhttpd start</p>											<p class="post-edited">(Last edited by <strong>aru</strong> on 4 May 2016, 05:51)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p322460">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">ichiban</div>
					<div class="post-datetime">
						4 May 2016, 07:15					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>aru wrote:</cite><blockquote><div class="quotebox"><cite>ichiban wrote:</cite><blockquote><p>Any step by step guide to do that? <br />Sorry but I am new to the whole linux OS and openWRT stuff.</p></blockquote></div><p>Connect MR3020 wan port to another working router lan port， and your computer connect to MR3020 lan port.&nbsp; &nbsp;login to MR3020 by telnet, execute following commands<br />opkg update<br />opkg install luci<br />/etc/init.d/uhttpd start</p></blockquote></div><p>Can you update the router in the failsafe mode? Or does it have to be in Normal Operation mode, because in Normal Operation mode the MR3020 cannot be found or host is unreachable.</p><p>And the MR3020 does not have a lan-port. It is only a single port mini-router...</p>											<p class="post-edited">(Last edited by <strong>ichiban</strong> on 4 May 2016, 07:17)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p322461">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">aru</div>
					<div class="post-datetime">
						4 May 2016, 07:49					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>ichiban wrote:</cite><blockquote><p>Can you update the router in the failsafe mode? Or does it have to be in Normal Operation mode, because in Normal Operation mode the MR3020 cannot be found or host is unreachable.</p><p>And the MR3020 does not have a lan-port. It is only a single port mini-router...</p></blockquote></div><p>OK. You can flash firmware in failsafe mode.<br /><a href="https://wiki.openwrt.org/doc/howto/generic.failsafe">https://wiki.openwrt.org/doc/howto/generic.failsafe</a><br />See the latest one: Flash new firmware in failsafe mode</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p322496">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">ichiban</div>
					<div class="post-datetime">
						4 May 2016, 12:34					</div>
				</div>
				<div class="post-content content">
					<p>cat yourfirmware.bin | pv -b | nc -l -p 3333</p><p>nc linux.machine.ip.192.168.1.2 3333 &gt; /tmp/yourfirmware.bin</p><p>These commands don&#039;t work in terminal on my ubuntu install.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p322673">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">ichiban</div>
					<div class="post-datetime">
						5 May 2016, 19:41					</div>
				</div>
				<div class="post-content content">
					<p>Anyone help?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p322968">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">ichiban</div>
					<div class="post-datetime">
						8 May 2016, 13:45					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>aru wrote:</cite><blockquote><div class="quotebox"><cite>ichiban wrote:</cite><blockquote><p>Can you update the router in the failsafe mode? Or does it have to be in Normal Operation mode, because in Normal Operation mode the MR3020 cannot be found or host is unreachable.</p><p>And the MR3020 does not have a lan-port. It is only a single port mini-router...</p></blockquote></div><p>OK. You can flash firmware in failsafe mode.<br /><a href="https://wiki.openwrt.org/doc/howto/generic.failsafe">https://wiki.openwrt.org/doc/howto/generic.failsafe</a><br />See the latest one: Flash new firmware in failsafe mode</p></blockquote></div><p>I tried NC via windows and when I type the commands it doesn&#039;t do anything.<br />There is nothing that shows up on the prompt and the router does nothing. <br />Is it bricked?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p323007">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">wiputc</div>
					<div class="post-datetime">
						8 May 2016, 20:28					</div>
				</div>
				<div class="post-content content">
					<p>Do not panic, it is actually pretty hard to brick a router, unless you unplug it in the middle of flashing or do anything bordering stupid. If it can load to the point you can telnet in, even in failsafe, that is a pretty good sign that it is still functioning, even if the file system may be corrupted or something.</p><p>You may want to try this, before going crazy with the failsafe. It was quite a while ago when I flashed my TL-MR3020 with 12.09, if I remember correctly it will straight away provide a DHCP on its sole LAN port when it went up after initial flashing. Pretty sure you&#039;ve tried this, but if you haven&#039;t, please do. (In case I didn&#039;t make myself clear: switch your IPv4 setting to &#039;obtain IP address automatically&#039;)</p><p>After initial flashing, the device should be accessible through web GUI <a href="http://192.168.1.1">http://192.168.1.1</a> or SSH. If you use Windows, use putty or tutty or other SSH client of your choice (plenty of them around, just google it). I don&#039;t think normal mode&nbsp; will be available via telnet.</p><p>If all these did not work... then we start reading the failsafe article.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p323135">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">ichiban</div>
					<div class="post-datetime">
						9 May 2016, 18:04					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>wiputc wrote:</cite><blockquote><p>After initial flashing, the device should be accessible through web GUI <a href="http://192.168.1.1">http://192.168.1.1</a> or SSH. If you use Windows, use putty or tutty or other SSH client of your choice (plenty of them around, just google it). I don&#039;t think normal mode&nbsp; will be available via telnet.</p><p>If all these did not work... then we start reading the failsafe article.</p></blockquote></div><p>I&#039;ve tried all this... been trying to ping 192.168.1.1 and no luck. The only way to access the router is via failsafe mode via 192.168.1.1 when ipv4 settings set to 192.168.1.2. </p><p>Does anyone have a proper step-by-step guide on how to flash a firmware in failsafe mode for a MR3020? <br />I am trying the commands that are listed in the failsafe generic article and it doesn&#039;t seem to do anything.</p><p><span class="postimg"><img src="http://i.imgur.com/E21PYFF.png" alt="http://i.imgur.com/E21PYFF.png" /></span></p>											<p class="post-edited">(Last edited by <strong>ichiban</strong> on 9 May 2016, 18:19)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p323140">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">Xotic750</div>
					<div class="post-datetime">
						9 May 2016, 19:55					</div>
				</div>
				<div class="post-content content">
					<p>Is the procedure that you are following?</p><p><a href="https://wiki.openwrt.org/doc/howto/generic.failsafe#when_you_are_in_failsafe_mode">https://wiki.openwrt.org/doc/howto/gene … lsafe_mode</a></p><div class="quotebox"><blockquote><p>NOTE: there is a bug report that sometimes firstboot or mtd-r erase rootfs_data may not work and &quot;hangs&quot;. If that happens then the files can be deleted using the &quot;rm…&quot; method. The overlay is &quot;on top&quot; of the SquashFS so deleting overlay files just leaves the original SquashFS files showing.</p></blockquote></div><p>from</p><div class="quotebox"><blockquote><p>Wiping JFFS2 file system (&#039;Factory reset&#039; to default config)</p><p>This procedure is safe (it will restore the default setup and not brick your router).<br />It will clear the JFFS2 partition, resetting all custom settings and removing all installed packages, logs, dumps, and temp files, the OpenWrt equivalent of a factory reset. If you need any of these, take a backup to some other device in failsafe mode before doing this.<br />Run mount_root first (see above) to mount the JFFS2 partition. Once the JFFS2 partition is mounted for read/write, use any of these commands to erase the files on it, which resets the router:</p><p>firstboot<br />mtd -r erase rootfs_data (this will reboot the device as part of the process)<br />rm -r /overlay/*&nbsp; (or /overlay/upper/* on some routers)<br />NOTE: there is a bug report that sometimes firstboot or mtd-r erase rootfs_data may not work and &quot;hangs&quot;. If that happens then the files can be deleted using the &quot;rm…&quot; method. The overlay is &quot;on top&quot; of the SquashFS so deleting overlay files just leaves the original SquashFS files showing.</p></blockquote></div><p>followed by <em>reboot</em> if the <em>rm</em> method is used?<br /></p><div class="quotebox"><blockquote><p>Finished/reboot - If you are done with failsafe mode use reboot to reboot</p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p323221">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">ichiban</div>
					<div class="post-datetime">
						10 May 2016, 15:19					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Xotic750 wrote:</cite><blockquote><p>Is the procedure that you are following?</p><p><a href="https://wiki.openwrt.org/doc/howto/generic.failsafe#when_you_are_in_failsafe_mode">https://wiki.openwrt.org/doc/howto/gene … lsafe_mode</a></p><div class="quotebox"><blockquote><p>NOTE: there is a bug report that sometimes firstboot or mtd-r erase rootfs_data may not work and &quot;hangs&quot;. If that happens then the files can be deleted using the &quot;rm…&quot; method. The overlay is &quot;on top&quot; of the SquashFS so deleting overlay files just leaves the original SquashFS files showing.</p></blockquote></div><p>from</p><div class="quotebox"><blockquote><p>Wiping JFFS2 file system (&#039;Factory reset&#039; to default config)</p><p>This procedure is safe (it will restore the default setup and not brick your router).<br />It will clear the JFFS2 partition, resetting all custom settings and removing all installed packages, logs, dumps, and temp files, the OpenWrt equivalent of a factory reset. If you need any of these, take a backup to some other device in failsafe mode before doing this.<br />Run mount_root first (see above) to mount the JFFS2 partition. Once the JFFS2 partition is mounted for read/write, use any of these commands to erase the files on it, which resets the router:</p><p>firstboot<br />mtd -r erase rootfs_data (this will reboot the device as part of the process)<br />rm -r /overlay/*&nbsp; (or /overlay/upper/* on some routers)<br />NOTE: there is a bug report that sometimes firstboot or mtd-r erase rootfs_data may not work and &quot;hangs&quot;. If that happens then the files can be deleted using the &quot;rm…&quot; method. The overlay is &quot;on top&quot; of the SquashFS so deleting overlay files just leaves the original SquashFS files showing.</p></blockquote></div><p>followed by <em>reboot</em> if the <em>rm</em> method is used?<br /></p><div class="quotebox"><blockquote><p>Finished/reboot - If you are done with failsafe mode use reboot to reboot</p></blockquote></div></blockquote></div><p>The RM method did not work. So I tried the MTD method. <br />Even after the reboot the router cannot be accessed via 192.168.1.1. It always says the host is unreachable. <br />The only way to still access the router still is via the failsafe mode.</p><p><span class="postimg"><img src="http://i.imgur.com/aMZ5DSj.png" alt="http://i.imgur.com/aMZ5DSj.png" /></span></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p323223">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">Xotic750</div>
					<div class="post-datetime">
						10 May 2016, 15:27					</div>
				</div>
				<div class="post-content content">
					<p>The instructions say</p><div class="quotebox"><blockquote><p>Run mount_root first</p></blockquote></div><p>I don&#039;t see that in your screenshot?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p323248">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">ichiban</div>
					<div class="post-datetime">
						10 May 2016, 20:19					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Xotic750 wrote:</cite><blockquote><p>The instructions say</p><div class="quotebox"><blockquote><p>Run mount_root first</p></blockquote></div><p>I don&#039;t see that in your screenshot?</p></blockquote></div><p>It doesn&#039;t matter, I&#039;ve tried it before. Tried it even running the mtd command. After reboot the router doesn&#039;t do anything. 192.168.1.1 is still unreachable. <br /><span class="postimg"><img src="http://i.imgur.com/gPoxqah.png" alt="http://i.imgur.com/gPoxqah.png" /></span></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p323255">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">tmo26</div>
					<div class="post-datetime">
						10 May 2016, 20:59					</div>
				</div>
				<div class="post-content content">
					<p>Sidenote to ichiban: Why are you taking pictures of your screen, when simple copy &amp; paste (+usage of the &lt;code&gt; tag) would be sufficient?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p323256">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">Max Hopper</div>
					<div class="post-datetime">
						10 May 2016, 21:25					</div>
				</div>
				<div class="post-content content">
					<p>Coupled with BB @ Bleeding Edge.</p><p>This will all end in tears (but more interesting than watching paint dry).</p>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=64612&amp;p=2.html">2</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0.001 -->

</body>
</html>