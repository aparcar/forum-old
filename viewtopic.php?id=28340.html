<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Using OpenWRT to route LAN traffic through an OpenVPN remote server</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 13 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p126626">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">nodje</div>
					<div class="post-datetime">
						27 Jan 2011, 07:45					</div>
				</div>
				<div class="post-content content">
					<p>Currently living in China, where internet is all but open, VPN connection is a need.<br />But I&#039;m tired of individual VPN connection as I have dozens of devices that needs to surf the free web.</p><p>I need to find a way to get LAN traffic through a single OpenVPN client connection.</p><p>I&#039;m turning to OpenWRT to get a solution that would possibly avoid using a spare machine.</p><p>Being quite newbie in networks, I reckon it&#039;s not really a common problem, as google has been able to provide a clear answer.<br />If it is a &quot;classic&quot; problem, please let me know what is the straight forward solution.</p><p>My thinking is the following:<br />- router acting as vpn client and routing absolutely ALL traffic through remote OpenVPN server - would work fine but not flexible<br />- a combination of proxy server using a vpn client connection, hopefully on an OpenWRT box - leaving &quot;plain&quot; connection as an option.</p><p>Comments would be really helpful of course, but I know it&#039;s quite demanding to explain crystal clear stuff to obscured mind...</p><p>So basically, I&#039;d like to secure a few things before buying a compatible router and I&#039;d be happy enough with a few answers:</p><p>- is OpenWRT able to act as an OpenVPN client ?<br />- is it able to share that connection over the LAN?<br />- can tinyproxy be used to proxy connection to this openvpn connection?</p><p>cheers</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p126867">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">minimou</div>
					<div class="post-datetime">
						30 Jan 2011, 12:49					</div>
				</div>
				<div class="post-content content">
					<p>Hello</p><p>I&#039;ve personnaly openwrt running with openvpn in client mode and it just work fine.</p><p>just to answer your 3 questions:<br />1)yes, but if you have a big connection this will slow down the connection as the poor routers aren&#039;t design to do cryto <br />2)yes<br />3)partly<br />i think that tinyproxy can only redirect to another proxy (or i haven&#039;t found the good option), so you will have to put squid on the server side (or another proxy software)</p><p>Did you already have a openvpn server up and running (if yes tell us the configuration)?<br />What OS did you use (win,mac,linux,...)?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p126937">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">nodje</div>
					<div class="post-datetime">
						31 Jan 2011, 05:16					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>thanks for your answer.</p><p>I have an OpenVPN 2.1.4 server running on Ubuntu 10.04.</p><p>I&#039;m connecting to it with UDP tun device, with redirect-gateway option.</p><p>I didn&#039;t realize that crypto would be that demanding for the router. <br />This alone justifies a dedicated machine. <br />I kind of wanted to avoid that, thinking it would be neater and more eco to have just a router taking care of that.<br />Maybe I can just give it a try, but probably not with a WRT54G.<br />Any powerful router that could support VPN encryption and dual WLAN?</p><p>I guess a Soekris box would be perfect for the job, right? But they don&#039;t seem to provide wireless though.</p><p>I&#039;ve tested the config I&#039;d like to have set on a router on an old OSX 10.4 box:<br />- a machine acting as openVPN client<br />- a proxy redirecting to this vpn tunnel.</p><p>I&#039;ve successfully installed the OpenVPN client and Squid.<br />I can connect through VPN tunnel with a browser, but Squid doesn&#039;t.<br />A browser using the local Squid proxy can access the web just as regular machine on the chinese web.<br />I actually don&#039;t understand how Squid can bypass the vpn tunnel setup with redirect-gateway option.</p><p>cheers</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>