<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> WAG160N v1 AnnexA firmware issue</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 6 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p174638">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">bflorin</div>
					<div class="post-datetime">
						11 Aug 2012, 20:28					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m traing to re-write the firmware for WAG160N v1 AnnexA, but without any success <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" />. I have access only from serial (CFE). <br />When i&#039;m traing to flash the original firware (&quot;WAG160Nv1-EU-ANNEXA-ETSI-1.00.16-code.bin&quot;) i receive the following error: </p><div class="codebox"><pre><code>CFE&gt; f 192.168.1.100:WAG160Nv1-EU-ANNEXA-ETSI-1.00.16-code.bin
Loading 192.168.1.100:WAG160Nv1-EU-ANNEXA-ETSI-1.00.16-code.bin ...
Finished loading 3465216 bytes
Firmware tag version [0] is not compatible with the current Tag version [6].
*** command status = -1</code></pre></div><p>Also i was traing to flash &quot;openwrt-96358VW-generic-squashfs-cfe.bin&quot; or other customes FW&#039;s and i had another issue (see below):</p><div class="codebox"><pre><code>VFS: Cannot open root device &quot;mtdblock2&quot; or unknown-block(0,0)
Please append a correct &quot;root=&quot; boot option; here are the available partitions:
Kernel panic - not syncing: VFS: Unable to mount root fs on unknown-block(0,0)</code></pre></div><p>Below are the booting informations from the bloody router:</p><div class="codebox"><pre><code>CFE version 1.0.37-5.4 for BCM96358 (32bit,SP,BE)
Build Date: ? 10 19:25:21 CST 2008 (root@9DavidZhang2)
Copyright (C) 2000-2005 Broadcom Corporation.

Boot Address 0xbfc00000

Initializing Arena.
Initializing Devices.
Parallel flash device: name MX29LV320AB, id 0x22a8, size 4096KB
CPU type 0x2A010: 300MHz, Bus: 133MHz, Ref: 64MHz
Total memory: 33554432 bytes (32MB)

Total memory used by CFE:  0x80401000 - 0x80528800 (1210368)
Initialized Data:          0x8041E550 - 0x8041FF60 (6672)
BSS Area:                  0x8041FF60 - 0x80426800 (26784)
Local Heap:                0x80426800 - 0x80526800 (1048576)
Stack Area:                0x80526800 - 0x80528800 (8192)
Text (code) segment:       0x80401000 - 0x8041E544 (120132)
Boot area (physical):      0x00529000 - 0x00569000
Relocation Factor:         I:00000000 - D:00000000

Board IP address                  : 192.168.1.1:ffffff00
Host IP address                   : 192.168.1.100
Gateway IP address                :
Run from flash/host (f/h)         : f
Default host run file name        : vmlinux
Default host flash file name      : bcm963xx_fs_kernel
Boot delay (0-9 seconds)          : 1
Board Id Name                     : 96358VW
Psi size in KB                    : 24
Number of MAC Addresses (1-32)    : 32
Base MAC Address                  : 00:22:6b:e5:93:13
Ethernet PHY Type                 : Internal
Memory size in MB                 : 32
CMT Thread Number                 : 1

*** Press any key to stop auto run (1 seconds) ***
Auto run second count down: 1
web info: Waiting for connection on socket 0.
CFE&gt;</code></pre></div><p>any hint and/or support from you guys is welcomed...</p>											<p class="post-edited">(Last edited by <strong>bflorin</strong> on 11 Aug 2012, 20:29)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p174763">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">bflorin</div>
					<div class="post-datetime">
						13 Aug 2012, 13:46					</div>
				</div>
				<div class="post-content content">
					<p>hello all,</p><p>i finally writed on of the original FW (thanks to 1up and jow for the tips -- <a href="https://forum.openwrt.org/viewtopic.php?id=29536)">https://forum.openwrt.org/viewtopic.php?id=29536)</a>. Unfortunatly this didn&#039;t solve my problem <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" />. Now the router reboot with the following error message:<br /></p><div class="codebox"><pre><code>VFS: Cannot open root device &quot;31:0&quot; or unknown-block(31,0)
Please append a correct &quot;root=&quot; boot option
Kernel panic: VFS: Unable to mount root fs on unknown-block(31,0)
 &lt;0&gt;Rebooting in 1 seconds..</code></pre></div><p>i suppose that i have a partition table issue. Can somebody help me to solve this?</p><p>Below is the entire output from the boot till i receive the error:<br /></p><div class="codebox"><pre><code>CFE version 1.0.37-5.4 for BCM96358 (32bit,SP,BE)
Build Date: ? 10 19:25:21 CST 2008 (root@9DavidZhang2)
Copyright (C) 2000-2005 Broadcom Corporation.

Boot Address 0xbfc00000

Initializing Arena.
Initializing Devices.
Parallel flash device: name MX29LV320AB, id 0x22a8, size 4096KB
CPU type 0x2A010: 300MHz, Bus: 133MHz, Ref: 64MHz
Total memory: 33554432 bytes (32MB)

Total memory used by CFE:  0x80401000 - 0x80528800 (1210368)
Initialized Data:          0x8041E550 - 0x8041FF60 (6672)
BSS Area:                  0x8041FF60 - 0x80426800 (26784)
Local Heap:                0x80426800 - 0x80526800 (1048576)
Stack Area:                0x80526800 - 0x80528800 (8192)
Text (code) segment:       0x80401000 - 0x8041E544 (120132)
Boot area (physical):      0x00529000 - 0x00569000
Relocation Factor:         I:00000000 - D:00000000

Board IP address                  : 192.168.1.1:ffffff00
Host IP address                   : 192.168.1.100
Gateway IP address                :
Run from flash/host (f/h)         : f
Default host run file name        : vmlinux
Default host flash file name      : image.bin
Boot delay (0-9 seconds)          : 1
Board Id Name                     : 96358GW
Psi size in KB                    : 24
Number of MAC Addresses (1-32)    : 32
Base MAC Address                  : 00:22:6b:e5:93:13
Ethernet PHY Type                 : Internal
Memory size in MB                 : 32
CMT Thread Number                 : 0

*** Press any key to stop auto run (1 seconds) ***
Auto run second count down: 0
Code Address: 0x80010000, Entry Address: 0x8022e018
Decompression OK!
Entry at 0x8022e018
Closing network.
Starting program at 0x8022e018
Linux version 2.6.8.1 (stroot@SBU-II-1) (gcc version 3.4.2) #1 Mon May 5 17:39:03 CST 2008
Parallel flash device: name MX29LV320AB, id 0x22a8, size 4096KB
96358GW prom init
CPU revision is: 0002a010
Determined physical RAM map:
 memory: 01fa0000 @ 00000000 (usable)
On node 0 totalpages: 8096
  DMA zone: 4096 pages, LIFO batch:1
  Normal zone: 4000 pages, LIFO batch:1
  HighMem zone: 0 pages, LIFO batch:1
Built 1 zonelists
Kernel command line: root=31:0 ro noinitrd console=ttyS0,115200
brcm mips: enabling icache and dcache...
Primary instruction cache 32kB, physically tagged, 2-way, linesize 16 bytes.
Primary data cache 16kB 2-way, linesize 16 bytes.
PID hash table entries: 128 (order 7: 1024 bytes)
Using 150.000 MHz high precision timer.
Dentry cache hash table entries: 8192 (order: 3, 32768 bytes)
Inode-cache hash table entries: 4096 (order: 2, 16384 bytes)
Memory: 29228k/32384k available (1884k kernel code, 3112k reserved, 279k data, 92k init, 0k highmem)
Calibrating delay loop... 299.82 BogoMIPS
Mount-cache hash table entries: 512 (order: 0, 4096 bytes)
Checking for &#039;wait&#039; instruction...  unavailable.
NET: Registered protocol family 16
Total Flash size: 4096K with 71 sectors
File system address: 0xbfc10100
Scratch pad is not used for this flash part.
Can&#039;t analyze prologue code at 801e597c
Initializing Cryptographic API
PPP generic driver version 2.4.2
NET: Registered protocol family 24
Using noop io scheduler
bcm963xx_mtd driver v1.0
Failed to read image tag from flash
brcmboard: brcm_board_init entry
ERROR - Invalid number of MAC addresses (-2029341365) is configured.
Serial: BCM63XX driver $Revision: 1.1.1.1 $
ttyS0 at MMIO 0xfffe0100 (irq = 10) is a BCM63XX
ttyS1 at MMIO 0xfffe0120 (irq = 11) is a BCM63XX
blaadd: blaa_detect entry
adsl: adsl_init entry
Broadcom BCMPROCFS v1.0 initialized
u32 classifier
NET: Registered protocol family 2
IP: routing cache hash table of 512 buckets, 4Kbytes
TCP: Hash tables configured (established 2048 bind 4096)
ip_conntrack version 2.1 (253 buckets, 0 max) - 400 bytes per conntrack
ip_ct_h323: init success
ip_conntrack_pptp version 2.1 loaded
ip_conntrack_rtsp v0.01 loading
ip_nat_h323: init success
ip_nat_pptp version 2.0 loaded
ip_nat_rtsp v0.01 loading
ip_tables: (C) 2000-2002 Netfilter core team
netfilter PSD loaded - (c) astaro AG
ipt_random match loaded
NET: Registered protocol family 1
NET: Registered protocol family 17
Ebtables v2.0 registered
NET: Registered protocol family 8
NET: Registered protocol family 20
802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;
All bugs added by David S. Miller &lt;davem@redhat.com&gt;
VFS: Cannot open root device &quot;31:0&quot; or unknown-block(31,0)
Please append a correct &quot;root=&quot; boot option
Kernel panic: VFS: Unable to mount root fs on unknown-block(31,0)
 &lt;0&gt;Rebooting in 1 seconds..</code></pre></div><p>some other error during the boot (included in the above list) is:<br /></p><div class="codebox"><pre><code>bcm963xx_mtd driver v1.0
Failed to read image tag from flash
brcmboard: brcm_board_init entry
ERROR - Invalid number of MAC addresses (-2029341365) is configured.</code></pre></div><p>Thanks in advance for your help!</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>