<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> WRT54g-&gt;Make a swap partition on a SD-CARD?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 20 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p28695">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">sdzx</div>
					<div class="post-datetime">
						11 Jun 2006, 18:14					</div>
				</div>
				<div class="post-content content">
					<p>I bought a wrt54g 2.2,and now use open-wrt<br />and want to add a sd-card(1G),<br />Can i build a swap partition on SD-card to increase the poor memory of 16M?<br />how can i do that?need to rebuilt the knnel?<br />how to bulid?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p28732">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">stephen</div>
					<div class="post-datetime">
						12 Jun 2006, 16:59					</div>
				</div>
				<div class="post-content content">
					<p>If you can live with slooooooow swap... probably yes. Last time I measured throughput I ended up with something about 200kB/s.<br />Make sure that your SD mod will work with a 1GB card (I have tested several cards up to 512MB - successfully - but there have been reports of failure).<br />Kernel building instructions have been spotted in the wiki,</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p28760">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">sdzx</div>
					<div class="post-datetime">
						13 Jun 2006, 05:46					</div>
				</div>
				<div class="post-content content">
					<p>Thanks, has anyone tested to increase the memory of 16M to 32M or more?<br />I think more memory can execute more program and can increase the speed and stability of hard works,such as BT and Emule,is that true?</p>											<p class="post-edited">(Last edited by <strong>sdzx</strong> on 13 Jun 2006, 05:48)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p29079">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">spcsys</div>
					<div class="post-datetime">
						18 Jun 2006, 13:21					</div>
				</div>
				<div class="post-content content">
					<p>I have looked around on how to build portable apps on <a href="http://portableapps.com">http://portableapps.com</a>/ which are designed for USB flash drives and remember the author specifically talking about methods of reducing cache, swap, etc to flash devices b/c it will destroy the flash device after so many writes. I am not certain of the differences b/w SD and other flash technologies as far as how many writes / flashes until that area of the chip goes bad but you may want to consider this as a swap partition may wear the chip away.</p><p>You could always buy older chips on sale once every 6 months though.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p29109">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">ulmen</div>
					<div class="post-datetime">
						19 Jun 2006, 01:01					</div>
				</div>
				<div class="post-content content">
					<p>I have 20M of Swapspace on a SD-Card, just because one can do that. If its reasonable, i don&#039;t know... since the cards are cheap, i don&#039;t care if it&#039;s destroyed or useless. Perhaps it gets usefull if i load more work onto the router...</p><p>Unfortunatelly i lost the step-by-step tutorial i wrote while building the image via the image-builder, but because of much smoother ways to get swap onto the SD-Card, it&#039;s not that big loss. But i have the whole root filesystem on the SD-Card and don&#039;t use the build-in read-write flash. Thus, i get another _fast_ empty storage, but i don&#039;t use this either 0o.</p><p>For simple swap on the sd-card, simply get the mmc.o somewhere for your kernel (not that hard via some search engine [or just ask]), or read instructions to build it yourself (harder). Additional, some filesystem modules via ipkg ... kmod-ext2/ext3 or whatever you like most. Last but not least, you might need e2fsprogs to format your card. Write some nifty initscript, and you are done.</p><p>The only odd think i encountered was some limitation on the filesize of the swapfiles, but i didn&#039;t investigated this and simply created two times 10M.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p29371">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">sdzx</div>
					<div class="post-datetime">
						23 Jun 2006, 15:02					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>ulmen wrote:</cite><blockquote><p>I have 20M of Swapspace on a SD-Card, just because one can do that. If its reasonable, i don&#039;t know... since the cards are cheap, i don&#039;t care if it&#039;s destroyed or useless. Perhaps it gets usefull if i load more work onto the router...<br />.</p></blockquote></div><p>oh,bad news.&nbsp; THE tutorial is very very important for me and other poor man,can you just even repeart the great thing again?best with pictures,hehe,hard works ,thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p29445">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">ulmen</div>
					<div class="post-datetime">
						25 Jun 2006, 01:37					</div>
				</div>
				<div class="post-content content">
					<p>As said, the way i got my swap on the sd-card is very complex and propably not what one might want to use.</p><p>The first step was to get the whole root filesystem on the sd-card, as described in <a href="http://cryptomilch.de/~ulmen/openwrt/rootonmmchowto">http://cryptomilch.de/~ulmen/openwrt/rootonmmchowto</a>.<br />At this point, i would recommend just to mount the sd-card anywhere and use this mountpoint instead of /etc below instead of using my howto. The following steps apply either way.</p><p>Having a read-writeable root (or a read-writeable mountpoint), simply create a emtpy file of the desired size anywhere.<br /></p><div class="codebox"><pre><code>dd if=/dev/zero of=/etc/swapfile count=&lt;desired size in blocks&gt;</code></pre></div><p>This may take quite long, because the speed of the sd-card is very poor.</p><p>Then, turn the file into a swapfile.<br /></p><div class="codebox"><pre><code>mkswap /etc/swapfile</code></pre></div><p>The last step is to write a initscript to autoenable the swap at boot-time.<br /></p><div class="codebox"><pre><code>vi /etc/init.d/S15swapon
#!/bin/sh
swapon /etc/swapfile</code></pre></div><p>and make it executable with<br /></p><div class="codebox"><pre><code>chmod +x /etc/init.d/S15swapon</code></pre></div><p>Reboot or execute it by hand to have the swap enabled.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p29513">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">sdzx</div>
					<div class="post-datetime">
						26 Jun 2006, 16:59					</div>
				</div>
				<div class="post-content content">
					<p>OH,thanks.<br />emm,i&#039;d to test it sunday.Thanks any well</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p44445">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">m4rc0</div>
					<div class="post-datetime">
						14 Mar 2007, 21:43					</div>
				</div>
				<div class="post-content content">
					<p>how to get mkswap and swapon?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p49289">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">xtrem57</div>
					<div class="post-datetime">
						29 May 2007, 17:06					</div>
				</div>
				<div class="post-content content">
					<p>Up,</p><p>The tutorial isn&#039;t online anymore... someone do know another one ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p49316">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">boomer</div>
					<div class="post-datetime">
						29 May 2007, 20:07					</div>
				</div>
				<div class="post-content content">
					<p>Hi Guys,</p><p>As I see the idea here is to have more RAM.</p><p>Could the following approach be applied?<br />OS kernel itself and root-file system to be built for execution in-place (XIP) in the board flash â€“ not compressed, and not copied to RAM? <br />I guess it will require a lot of changes â€“ boot-loader, kernel, the image, but it will save some RAM usage.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p49319">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">mbm</div>
					<div class="post-datetime">
						29 May 2007, 21:02					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>boomer wrote:</cite><blockquote><p>Could the following approach be applied?<br />OS kernel itself and root-file system to be built for execution in-place (XIP) in the board flash â€“ not compressed, and not copied to RAM?</p></blockquote></div><p>On most platforms you have 4M flash and 16M ram, while you could technically use XIP it would mean using uncompressed code and the result would be that the flash would be full with little more than the kernel. Thus, it was decided that compressing the kernel and root filesystem was more important and no effort was spent on XIP.</p><p>SD is one of the few cases for XIP, but you won&#039;t be able to use it on the root filesystem (sd isn&#039;t direclty accessable) so the only place you&#039;ll be able to use it is the kernel. The amount of RAM you&#039;d save, is limited by your ability to use the flash, meaning the most you&#039;d save is maybe 3M. Is it really worth the trouble?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>