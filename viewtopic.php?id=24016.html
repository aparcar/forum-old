<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> WNR2000(v1): where are the JTAG pins?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 3 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p105220">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">jal2</div>
					<div class="post-datetime">
						24 Mar 2010, 23:58					</div>
				</div>
				<div class="post-content content">
					<p>Does anyone know where the JTAG pins are located on a WNR2000 (FCC ID PY308200083)?<br />I want to patch the bootloader and be prepared in case I break it. There are no obvious pins rows.</p><p>I&#039;ve found two test point groups on the back of the PCB:</p><p>- group 1: TP8, TP26-TP30 (six pins)<br />- group 2: TP2, TP12, TP16, TP18, TP19 (five pins)</p><p>so, assuming the JTAG pins are put closely together (not always true) and EJTAG requiring<br />five pins beside GND and Vcc (TDI, TDO, TMS, TCK and nTRST), while DINT and SRST are optional, both are candidates.</p><p>Unfortunately the traces on the PCB are difficult to follow towards the CPU.</p><p>Anyhow, it may be easier to replace the SPI flash by a socket.</p><p>The whole PCB, backside:<br /><a href="http://s10.directupload.net/file/d/2108/ro49uz5v_jpg.htm"><span class="postimg"><img src="http://s10.directupload.net/images/100324/temp/ro49uz5v.jpg" alt="http://s10.directupload.net/images/100324/temp/ro49uz5v.jpg" /></span></a></p><p>Group 1:<br /><a href="http://s10b.directupload.net/file/d/2108/jazkdwhn_jpg.htm"><span class="postimg"><img src="http://s10b.directupload.net/images/100324/temp/jazkdwhn.jpg" alt="http://s10b.directupload.net/images/100324/temp/jazkdwhn.jpg" /></span></a></p><p>Group 2:<br /><a href="http://s10.directupload.net/file/d/2108/egfqtz3f_jpg.htm"><span class="postimg"><img src="http://s10.directupload.net/images/100324/temp/egfqtz3f.jpg" alt="http://s10.directupload.net/images/100324/temp/egfqtz3f.jpg" /></span></a></p>											<p class="post-edited">(Last edited by <strong>jal2</strong> on 25 Mar 2010, 00:40)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p105221">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">jal2</div>
					<div class="post-datetime">
						25 Mar 2010, 01:01					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve compared the traces of the WNR2000 to the ones of WR941ND with the same AR9132, but a dedicated JTAG header - you can find a hi-res picture <a href="http://images.lark.net.cn/tl-wr941n/01.jpg">here</a> or <a href="http://farm4.static.flickr.com/3401/3333293102_b8282111f8_b.jpg">here</a>. Serial port traces and JTAG traces run close together, so I&#039;d guess group 2 above are the JTAG pins (TP2, ...).</p>											<p class="post-edited">(Last edited by <strong>jal2</strong> on 26 Mar 2010, 01:10)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p105334">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">jal2</div>
					<div class="post-datetime">
						27 Mar 2010, 00:05					</div>
				</div>
				<div class="post-content content">
					<p>I measured the voltages and resistance to Vcc and GND of testpoints TP2, TP12, TP16, TP18, TP19 yesterday. Doubt that they are JTAG, I couldn&#039;t find any reasonable pullups there.<br />Maybe JTAG is located at the frontside of the PCB at R149, RR213, R334, ... instead?<br />They were covered by some kind of finish, I had to remove it with pure alcohol to get to the solder.</p><p>Anyhow, I&#039;ll try to use a <a href="http://deadhacker.com/2010/02/03/jtag-enumeration/">hw tool</a> to find the pins. It will take me one or two weeks to get the Arduino and the software running.</p><p>BTW, does anyone know the JTAG IDCODE and IR length for the Atheros AR9130?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p107333">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">cyrusza</div>
					<div class="post-datetime">
						19 Apr 2010, 22:56					</div>
				</div>
				<div class="post-content content">
					<p>Hi jal2!<br />Have you found the pinout? Any news about the bootloader?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p107438">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">jal2</div>
					<div class="post-datetime">
						21 Apr 2010, 00:21					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>cyrusza wrote:</cite><blockquote><p>Have you found the pinout? Any news about the bootloader?</p></blockquote></div><p>No, sorry, not yet. The Arduino test program is working fine with a WRT54G, but my first five pin candidates for JTAG on the WNR2000 failed. I&#039;ll include the testpoints around TP2 next.</p><p>thanatos2k wants to try the <a href="https://forum.openwrt.org/viewtopic.php?pid=106253#p106253">patched bootloader</a><br />but we haven&#039;t figured out how to overwrite the old one on his board - mtd failed and u-boot seems to lack the command to write to the SPI flash.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p107444">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">cyrusza</div>
					<div class="post-datetime">
						21 Apr 2010, 01:12					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jal2 wrote:</cite><blockquote><div class="quotebox"><cite>cyrusza wrote:</cite><blockquote><p>Have you found the pinout? Any news about the bootloader?</p></blockquote></div><p>No, sorry, not yet. The Arduino test program is working fine with a WRT54G, but my first five pin candidates for JTAG on the WNR2000 failed. I&#039;ll include the testpoints around TP2 next.</p><p>thanatos2k wants to try the <a href="https://forum.openwrt.org/viewtopic.php?pid=106253#p106253">patched bootloader</a><br />but we haven&#039;t figured out how to overwrite the old one on his board - mtd failed and u-boot seems to lack the command to write to the SPI flash.</p></blockquote></div><p>Understood. Thank you for you work! I hope on a solution because this router is really unusable with Netgear firmware...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p108800">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">jal2</div>
					<div class="post-datetime">
						9 May 2010, 12:30					</div>
				</div>
				<div class="post-content content">
					<p>Sorry for the long delay. We failed to detect the JTAG pins in the group around TP2 as well. Next step is to sacrifice two boards,<br />WNR2000 and TP-Link WR1043ND, remove the SoC and look at the traces. The TP-Link has a JTAG header and features the same SoC.<br />I just wait for the delivery of the second WNR2000.</p><p>Maybe we could also keep the SoC of the WNR2000 in reset and access the SPI flash with some external hardware hoping that the SoC pins towards the SPI are kept in high-z during reset. Any volunteers? <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p109662">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">jal2</div>
					<div class="post-datetime">
						22 May 2010, 23:46					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jal2 wrote:</cite><blockquote><p>Maybe we could also keep the SoC of the WNR2000 in reset and access the SPI flash with some external hardware hoping that the SoC pins towards the SPI are kept in high-z during reset. Any volunteers? <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></blockquote></div><p>I tried this while waiting for the second device and failed. It seems like with nSRST asserted, the pins SCLK and SI (on the SPI flash) are tied to ground and WP#, HOLD# and CS# are at Vcc.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110302">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">jal2</div>
					<div class="post-datetime">
						1 Jun 2010, 00:46					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jal2 wrote:</cite><blockquote><p>Next step is to sacrifice two boards,<br />WNR2000 and TP-Link WR1043ND, remove the SoC and look at the traces</p></blockquote></div><p>Found the JTAG pins this way using the JTAGenum program. Have a look at <br /><a href="http://wiki.openwrt.org/toh/netgear/wnr2000#jtag">http://wiki.openwrt.org/toh/netgear/wnr2000#jtag</a> for the mapping and some pictures.</p><p>Next task is to run tjtag and test if it supports the CPU/flash.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111177">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">nabcore</div>
					<div class="post-datetime">
						14 Jun 2010, 08:39					</div>
				</div>
				<div class="post-content content">
					<p>Hey, great job on that; that showed a lot patience and perseverance.&nbsp; </p><p>What will your next move be after this? See if you can back up and restore the U-boot partition via JTAG and then start experimenting with your own compiles of U-boot?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>