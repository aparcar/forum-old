<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> BarierBreaker rc3 installation problems on two devices</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 19 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p244834">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">levicki</div>
					<div class="post-datetime">
						25 Aug 2014, 13:09					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>1. Installing BB-rc3 over Attitude Adjustment on TL-WR1043ND-v1 using sysupgrade from GUI while keeping configuration results in web access being cut off after upgrade (both HTTP and HTTPS). The problem seems to be related to missing ubus and mod-tls packages for uhttpd as well as new config being considerably different.</p><p>2. Installing BB-rc3 over Attitude Adjustment on Ubiquiti RouterStation Pro using sysupgrade from GUI while keeping configuration files disables all access to the unit (HTTP and HTTPS same issue as in TL-WR1043ND), and failsafe mode followed by TFTP flash is required to regain access. I had sshd installed instead of dropbear which was set to allow root login using authorized_keys only. After sysupgrade, PuTTY reported that dropbear is running on the unit instead of sshd. Furthermore, at the end of flashing an error about being unable to append configuration to partition and bad TRX checksum was reported so due to borked configuration files login was of course impossible via ssh.</p><p>In my opinion, sysupgrade should check if dropbear is disabled in startup and if it is, it should look for replacement ssh server and make sure it will be operational after flash and reboot. Same goes for HTTPS, if uhttpd is configured for HTTPS and luci-ssl is installed it should continue working after upgrade. Also, it would be about time to switch to OpenSSH with SFTP support as default, at least for devices with more memory or at least also include /etc/ssh/* in default config backup.</p><p>Fix for TP-Link was trivial -- cp /rom/etc/config/uhttpd.conf /etc/config and edit to match previous listening address/port settings. Fix for RouterStation Pro took me a whole day because I had to reconfigure from scratch. It seems that VLAN settings for RS Pro do not get set correctly through GUI -- I cut myself off the device and had to reflash 4 times until I gave up on GUI and set the config by copying preconfigured network file directly from PC. Network config was not overly complicated -- two unmanaged interfaces (VLAN 20, 30) and one admin interface (VLAN 10) but it refused to apply correctly from GUI. I can attach config if needed.</p><p>Finally, config backup for some reason contains uhttpd.crt and uhttpd.key twice.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>