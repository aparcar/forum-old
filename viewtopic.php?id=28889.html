<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> OpenWrt on RB493G</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 23 Apr 2018 and 27 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=28889&amp;p=2.html">2</a></li></ul></nav></div>
			
		
		
			<article class="post" id="p129774">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">klekac</div>
					<div class="post-datetime">
						2 Mar 2011, 14:47					</div>
				</div>
				<div class="post-content content">
					<p>Hi, I have been trying to deploy OpenWrt for RB493GAH (AR7161 + 2x AR8316, 9xEth). I compiled latest trunk (r25819) with modified some files:</p><div class="codebox"><pre><code>$ svn diff
Index: target/linux/ar71xx/files/arch/mips/ar71xx/mach-rb4xx.c
===================================================================
--- target/linux/ar71xx/files/arch/mips/ar71xx/mach-rb4xx.c    (revision 25819)
+++ target/linux/ar71xx/files/arch/mips/ar71xx/mach-rb4xx.c    (working copy)
@@ -341,3 +341,30 @@
 
 MIPS_MACHINE(AR71XX_MACH_RB_493, &quot;493&quot;, &quot;MikroTik RouterBOARD 493/AH&quot;,
          rb493_setup);
+
+static void __init rb493g_setup(void)
+{
+    rb4xx_generic_setup();
+
+    spi_register_board_info(rb4xx_microsd_info,
+                ARRAY_SIZE(rb4xx_microsd_info));
+
+
+    ar71xx_add_device_mdio(0x3fffffe0);
+
+    ar71xx_init_mac(ar71xx_eth0_data.mac_addr, ar71xx_mac_base, 1);
+    ar71xx_eth0_data.phy_if_mode = PHY_INTERFACE_MODE_RGMII;
+    ar71xx_eth0_data.phy_mask = BIT(0);
+
+    ar71xx_init_mac(ar71xx_eth1_data.mac_addr, ar71xx_mac_base, 0);
+    ar71xx_eth1_data.phy_if_mode = PHY_INTERFACE_MODE_RGMII;
+    ar71xx_eth1_data.phy_mask = BIT(4);
+
+    ar71xx_add_device_eth(1);
+    ar71xx_add_device_eth(0);
+
+    ar71xx_pci_init(ARRAY_SIZE(rb4xx_pci_irqs), rb4xx_pci_irqs);
+}
+
+MIPS_MACHINE(AR71XX_MACH_RB_493G, &quot;493G&quot;, &quot;MikroTik RouterBOARD 493G/AH&quot;,
+         rb493g_setup);
Index: target/linux/ar71xx/files/arch/mips/ar71xx/machtype.h
===================================================================
--- target/linux/ar71xx/files/arch/mips/ar71xx/machtype.h    (revision 25819)
+++ target/linux/ar71xx/files/arch/mips/ar71xx/machtype.h    (working copy)
@@ -31,6 +31,7 @@
     AR71XX_MACH_RB_450,    /* MikroTik RouterBOARD 450 */
     AR71XX_MACH_RB_450G,    /* MikroTik RouterBOARD 450G */
     AR71XX_MACH_RB_493,    /* Mikrotik RouterBOARD 493/493AH */
+    AR71XX_MACH_RB_493G,    /* Mikrotik RouterBOARD 493G/493GAH */
     AR71XX_MACH_RB_750,    /* MikroTik RouterBOARD 750 */
     AR71XX_MACH_PB42,    /* Atheros PB42 */
     AR71XX_MACH_PB44,    /* Atheros PB44 */</code></pre></div><p>How values can be used in ar71xx_eth?_data.phy_mask, ar71xx_add_device_mdio?</p><p>When I boot from network the switch driver is attached only on eth1 and this device work well. Device eth0 dosn&#039;t work:-(</p><div class="codebox"><pre><code>root@OpenWrt:/# dmesg
...
ag71xx_mdio: probed
eth0: Atheros AG71xx at 0xba000000, irq 5
eth0: connected to PHY at ag71xx-mdio:04 [uid=004dd041, driver=Atheros AR8216/AR8316]
eth1: Atheros AG71xx at 0xb9000000, irq 4
eth1: AR8316 switch driver attached.
eth1: connected to PHY at ag71xx-mdio:00 [uid=004dd041, driver=Atheros AR8216/AR8316]
...</code></pre></div><p>Do you have any idea?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p134965">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">pmootrey</div>
					<div class="post-datetime">
						9 May 2011, 19:05					</div>
				</div>
				<div class="post-content content">
					<p>I have the same issue. Please let me know if you find an answer.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p145442">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">KanjiMonster</div>
					<div class="post-datetime">
						9 Oct 2011, 15:07					</div>
				</div>
				<div class="post-content content">
					<p>I have received a RB493G and started working on it. As soon as I verified the NAND is working as it should I&#039;ll push it to OpenWrt. In the mean time, feel free to play with my <a href="https://github.com/KanjiMonster/openwrt/tree/rb493g">github branch</a>, or locally apply <a href="https://github.com/KanjiMonster/openwrt/commit/3f1def02d2b095ef63c3ba470e4db1e51ad502a5.patch">these</a> <a href="https://github.com/KanjiMonster/openwrt/commit/c17dccb15f5ae9839346ade634c8453e6098f2e6.patch">three</a> <a href="https://github.com/KanjiMonster/openwrt/commit/d0423eabc4eacd7f680ba8ac4c8c11bada118feb.patch">commits</a>.</p><p>Both switches and the leds are working, the reset button is not (haven&#039;t found out yet how to get its state). I haven&#039;t tested the card reader yet (I don&#039;t have a card <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" />, nor have I tested whether the NAND works correctly with OpenWrt (there are reports of writes not working).</p><p><strong>Edit:</strong> In case you are interested in the switch/port mapping (don&#039;t expect any sanity there):</p><div class="codebox"><pre><code>              Eth9  Eth8  Eth7  Eth6  Eth5  Eth4  Eth3  Eth2
              [1/1] [1/3] [1/4] [1/2] [0/1] [0/4] [0/3] [0/2]
Eth1/PoE [1/5]</code></pre></div><p><strong>Edit 2:</strong> Just flashed it with wget2nand and ... it works. So writing to NAND seems to be working fine. I&#039;ll test USB (somehow missed it), then I&#039;ll probably commit it in the next few days.</p>											<p class="post-edited">(Last edited by <strong>KanjiMonster</strong> on 9 Oct 2011, 20:41)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p145662">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">KanjiMonster</div>
					<div class="post-datetime">
						12 Oct 2011, 12:51					</div>
				</div>
				<div class="post-content content">
					<p>In case anybody cares, RB493G support is now in trunk. I won&#039;t add the reset button, since it shares a GPIO line with the MDIO bus of the second AR8316, and this setup isn&#039;t really supported in Linux, so it would need a hack. And since the reset button is (IMO) not really good reachable, I decided to not bother.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p147040">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">RussellSenior</div>
					<div class="post-datetime">
						30 Oct 2011, 12:49					</div>
				</div>
				<div class="post-content content">
					<p>Sweet!&nbsp; Thank you!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p147236">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">robrob</div>
					<div class="post-datetime">
						1 Nov 2011, 17:24					</div>
				</div>
				<div class="post-content content">
					<p>Is VLAN fully functional on the RB493G? It appears this router if fully up and running with the exception of the reset button. Is that true? I&#039;m getting ready to drop some serious coin on the router, 2 mini-pci radios, MicroSD card, case, 4 antennas, 4 antenna leads, power supply and the USB power injector and want to make sure it runs OpenWrt as well as my RouterStation Pro. Wow, after typing all that out I&#039;m going to have to reconsider this upgrade <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>I love the specs of this router: Lots of RAM and NAND, 9 Gigabit Ethernet ports, 3 mini-pci slots, MicroSD card slot, USB 2.0 port.</p>											<p class="post-edited">(Last edited by <strong>robrob</strong> on 1 Nov 2011, 17:27)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p147242">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">KanjiMonster</div>
					<div class="post-datetime">
						1 Nov 2011, 18:01					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>robrob wrote:</cite><blockquote><p>Is VLAN fully functional on the RB493G? It appears this router if fully up and running with the exception of the reset button. Is that true? I&#039;m getting ready to drop some serious coin on the router, 2 mini-pci radios, MicroSD card, case, 4 antennas, 4 antenna leads, power supply and the USB power injector and want to make sure it runs OpenWrt as well as my RouterStation Pro. Wow, after typing all that out I&#039;m going to have to reconsider this upgrade <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>I love the specs of this router: Lots of RAM and NAND, 9 Gigabit Ethernet ports, 3 mini-pci slots, MicroSD card slot, USB 2.0 port.</p></blockquote></div><p><strong>Edit</strong>: Yes, VLAN works as good as on the RB450G or on the RS Pro.</p><p>Note the caveats: the switches are separate and only connected through the CPU (so you have to actively bridge them), and the NAND isn&#039;t working for some (it looks like the ST Micro NAND isn&#039;t properly driven by linux/has timing issues - Samsungs NANDs work fine). And the USB is unpowered, so you have to use something with external power (be it a powered hub).</p><p>KM</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p147275">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">robrob</div>
					<div class="post-datetime">
						2 Nov 2011, 02:51					</div>
				</div>
				<div class="post-content content">
					<p>Thanks Kanji.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p148693">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">Mihaloo</div>
					<div class="post-datetime">
						15 Nov 2011, 21:51					</div>
				</div>
				<div class="post-content content">
					<p>Hi,<br />I have in RB495G installed openWRT and I can&#039;t save file or directory on nand memory. When I after reboot file or directory which i make missing. Please help.</p><div class="codebox"><pre><code>Bad eraseblock 673 at 0x000005420000
Bad eraseblock 802 at 0x000006440000
Bad eraseblock 806 at 0x0000064c0000
Bad eraseblock 812 at 0x000006580000
Bad eraseblock 814 at 0x0000065c0000
Bad eraseblock 856 at 0x000006b00000
Bad eraseblock 943 at 0x0000075e0000
Bad eraseblock 945 at 0x000007620000
Bad eraseblock 952 at 0x000007700000
Bad eraseblock 954 at 0x000007740000
Bad eraseblock 966 at 0x0000078c0000
Creating 3 MTD partitions on &quot;NAND01GW3B2CN6&quot;:
0x000000000000-0x000000040000 : &quot;booter&quot;
0x000000040000-0x000000400000 : &quot;kernel&quot;
0x000000400000-0x000008000000 : &quot;rootfs&quot;
mtd: partition &quot;rootfs&quot; set to be root filesystem
split_squashfs: no squashfs found in &quot;NAND01GW3B2CN6&quot;
GPIO Bitbanged MDIO: probed
ag71xx_mdio: probed
eth0: Atheros AG71xx at 0xba000000, irq 5
eth0: AR8316 switch driver attached.
ar8316: Using port 4 as switch port
eth1: Atheros AG71xx at 0xb9000000, irq 4
eth1: AR8316 switch driver attached.
ar8316: Using port 4 as switch port
Atheros AR71xx hardware watchdog driver version 0.1.0
TCP westwood registered
NET: Registered protocol family 17
802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;
All bugs added by David S. Miller &lt;davem@redhat.com&gt;
yaffs: dev is 32505862 name is &quot;mtdblock6&quot; ro
yaffs: passed flags &quot;&quot;
VFS: Mounted root (yaffs filesystem) readonly on device 31:6.
Freeing unused kernel memory: 188k freed
Button Hotplug driver version 0.4.1
- preinit -
Press the [f] key and hit [enter] to enter failsafe mode
eth0: link up (1000Mbps/Full duplex)
- regular preinit -
- init -
eth0: link down
SCSI subsystem initialized
usbcore: registered new interface driver usbfs
usbcore: registered new interface driver hub
usbcore: registered new device driver usb
NET: Registered protocol family 8
NET: Registered protocol family 20
PPP generic driver version 2.4.2
ip_tables: (C) 2000-2006 Netfilter Core Team
NET: Registered protocol family 24
ehci_hcd: USB 2.0 &#039;Enhanced&#039; Host Controller (EHCI) Driver
ar71xx-ehci ar71xx-ehci: Atheros AR71xx built-in EHCI controller
ar71xx-ehci ar71xx-ehci: new USB bus registered, assigned bus number 1
ar71xx-ehci ar71xx-ehci: irq 3, io mem 0x1b000000
ar71xx-ehci ar71xx-ehci: USB 2.0 started, EHCI 1.00
hub 1-0:1.0: USB hub found
hub 1-0:1.0: 2 ports detected
nf_conntrack version 0.5.0 (4012 buckets, 16048 max)
ath_hal: module license &#039;Proprietary&#039; taints kernel.
Disabling lock debugging due to kernel taint
ath_hal: 2009-05-08 (AR5210, AR5211, AR5212, AR5416, RF5111, RF5112, RF2413, RF5413, RF2133, RF2425, REGOPS_FUNC, XR)
ath_pci: trunk
wlan: trunk
wlan: mac acl policy registered
ath_rate_minstrel: Minstrel automatic rate control algorithm 1.2 (trunk)
ath_rate_minstrel: look around rate set to 10%
ath_rate_minstrel: EWMA rolloff level set to 75%
ath_rate_minstrel: max segment size in the mrr set to 6000 us
ohci_hcd: USB 1.1 &#039;Open&#039; Host Controller (OHCI) Driver
ar71xx-ohci ar71xx-ohci: Atheros AR71xx built-in OHCI controller
ar71xx-ohci ar71xx-ohci: new USB bus registered, assigned bus number 2
ar71xx-ohci ar71xx-ohci: irq 14, io mem 0x1c000000
hub 2-0:1.0: USB hub found
hub 2-0:1.0: 2 ports detected
uhci_hcd: USB Universal Host Controller Interface driver
usbcore: registered new interface driver cdc_acm
cdc_acm: v0.26:USB Abstract Control Model driver for USB modems and ISDN adapters
usbcore: registered new interface driver usblp
usbcore: registered new interface driver usbserial
USB Serial support registered for generic
usbcore: registered new interface driver usbserial_generic
usbserial: USB Serial Driver core
USB Serial support registered for Sierra USB modem
usbcore: registered new interface driver sierra
sierra: v.1.7.40:USB Driver for Sierra Wireless USB modems
usbcore: registered new interface driver sierra_net
Initializing USB Mass Storage driver...
usbcore: registered new interface driver usb-storage
USB Mass Storage support registered.
usbcore: registered new interface driver ums-alauda
usbcore: registered new interface driver ums-cypress
usbcore: registered new interface driver ums-datafab
usbcore: registered new interface driver ums-freecom
usbcore: registered new interface driver ums-isd200
usbcore: registered new interface driver ums-jumpshot
usbcore: registered new interface driver ums-karma
usbcore: registered new interface driver ums-sddr09
usbcore: registered new interface driver ums-sddr55
usbcore: registered new interface driver ums-usbat
usbcore: registered new interface driver cxacru
usbcore: registered new interface driver speedtch
[ueagle-atm] driver ueagle 1.4 loaded
usbcore: registered new interface driver ueagle-atm
cm109: Keymap for Komunikate KIP1000 phone loaded
usbcore: registered new interface driver cm109
cm109: CM109 phone driver: 20080805 (C) Alfred E. Heggestad
usbcore: registered new interface driver usbhid
usbhid: USB HID core driver
usbcore: registered new interface driver yealink
yealink: yld-20051230:Yealink phone driver
fuse init (API version 7.16)
nand_erase_nand: attempt to erase a bad block at page 0x00002000

Please press Enter to activate this console. device eth0 entered promiscuous mode
eth1: link up (1000Mbps/Full duplex)
device eth1.1 entered promiscuous mode
device eth1 entered promiscuous mode
br-lan: port 2(eth1.1) entering forwarding state
br-lan: port 2(eth1.1) entering forwarding state
eth0: link up (1000Mbps/Full duplex)
br-lan: port 1(eth0) entering forwarding state
br-lan: port 1(eth0) entering forwarding state



BusyBox v1.19.3 (2011-11-15 14:15:58 CET) built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 ATTITUDE ADJUSTMENT (bleeding edge, r29152) ----------
  * 1/4 oz Vodka      Pour all ingredients into mixing
  * 1/4 oz Gin        tin with ice, strain into glass.
  * 1/4 oz Amaretto
  * 1/4 oz Triple sec
  * 1/4 oz Peach schnapps
  * 1/4 oz Sour mix
  * 1 splash Cranberry juice
 -----------------------------------------------------
root@OpenWrt:/# a
arping    ash       ath_info  athchans  athkey    athstats  awk
root@OpenWrt:/# a
arping    ash       ath_info  athchans  athkey    athstats  awk
root@OpenWrt:/#
80211stats         find               mesg               strings
[                  firstboot          mkdir              swconfig
[[                 free               mkfifo             switch_root
arping             fw                 mknod              sync
ash                grep               mktemp             sysctl
ath_info           gunzip             mount              syslogd
athchans           gzip               mount_root         sysupgrade
athkey             halt               mtd                tail
athstats           head               mv                 tar
awk                hexdump            nc                 tee
basename           hostapd            netmsg             telnet
brctl              hostid             netstat            telnetd
bunzip2            hotplug-call       nice               test
busybox            hotplug2           nslookup           time
bzcat              hwclock            ntpd               top
cat                id                 opkg               touch
chgrp              ifconfig           passwd             tr
chmod              ifdown             pgrep              traceroute
chown              ifup               pidof              true
chroot             init               ping               uci
clear              insmod             ping6              udevtrigger
cmp                ipcalc.sh          pivot_root         udhcpc
cp                 iptables           pkill              umount
crond              iptables-restore   poweroff           uname
crontab            iptables-save      pppd               uniq
cut                iwconfig           printf             uptime
date               iwlist             ps                 vconfig
dbclient           iwpriv             pwd                vi
dd                 kill               reboot             watchdog
df                 killall            reset              wc
dirname            klogd              rm                 wget
dmesg              led.sh             rmdir              wget2nand
dnsmasq            less               rmmod              which
dropbear           ln                 route              wifi
dropbearkey        lock               scp                wlanconfig
du                 logger             sed                wpa_supplicant
echo               login.sh           seq                wpad
egrep              logread            sh                 xargs
env                ls                 sleep              yes
expr               lsmod              sort               zcat
false              madwifi_multi      ssh
fgrep              md5sum             start-stop-daemon
root@OpenWrt:/# ls
bin         lib         overlay     root        tmp         www
dev         lost+found  proc        sbin        usr
etc         mnt         rom         sys         var
root@OpenWrt:/# led.sh
root@OpenWrt:/# led.sh
root@OpenWrt:/# led.sh
root@OpenWrt:/# led.sh
root@OpenWrt:/# led.sh
root@OpenWrt:/# led.sh
root@OpenWrt:/# top
Mem: 11236K used, 245576K free, 0K shrd, 0K buff, 4536K cached
CPU:   0% usr   0% sys   0% nic 100% idle   0% io   0% irq   0% sirq
Load average: 0.05 0.05 0.05 1/32 1341
  PID  PPID USER     STAT   VSZ %VSZ %CPU COMMAND
  535     1 root     S     1492   1%   0% /bin/ash --login
  589     1 root     S     1484   1%   0% /sbin/syslogd -C16
 1207     1 root     S     1484   1%   0% /sbin/udhcpc -t 0 -i eth1.2 -b -p /va
    1     0 root     S     1480   1%   0% init
 1288     1 root     S     1476   1%   0% /usr/sbin/ntpd -n -p 0.openwrt.pool.n
 1284     1 root     S     1476   1%   0% /sbin/watchdog -t 5 /dev/watchdog
 1341   535 root     R     1472   1%   0% top
  591     1 root     S     1464   1%   0% /sbin/klogd
 1312     1 root     S     1136   0%   0% /usr/sbin/dropbear -P /var/run/dropbe
 1274     1 nobody   S      928   0%   0% /usr/sbin/dnsmasq -K -D -y -Z -b -E -
  593     1 root     S      800   0%   0% /sbin/hotplug2 --override --persisten
    6     2 root     SW       0   0%   0% [rcu_kthread]
    5     2 root     SW       0   0%   0% [kworker/u:0]
  235     2 root     SW       0   0%   0% [kworker/0:1]
   62     2 root     SW       0   0%   0% [sync_supers]
    2     0 root     SW       0   0%   0% [kthreadd]
    3     2 root     SW       0   0%   0% [ksoftirqd/0]
  198     2 root     SW       0   0%   0% [mtdblock5]
    7     2 root     SW&lt;      0   0%   0% [khelper]
^X^C8     2 root     SW       0   0%   0% [kworker/u:1]
root@OpenWrt:/#
root@OpenWrt:/#
root@OpenWrt:/#
root@OpenWrt:/# cat /dev/mtd
mtd0       mtd1ro     mtd3       mtd4ro     mtd6       mtdblock1  mtdblock4
mtd0ro     mtd2       mtd3ro     mtd5       mtd6ro     mtdblock2  mtdblock5
mtd1       mtd2ro     mtd4       mtd5ro     mtdblock0  mtdblock3  mtdblock6
root@OpenWrt:/# cat /dev/mtd
mtd0       mtd1ro     mtd3       mtd4ro     mtd6       mtdblock1  mtdblock4
mtd0ro     mtd2       mtd3ro     mtd5       mtd6ro     mtdblock2  mtdblock5
mtd1       mtd2ro     mtd4       mtd5ro     mtdblock0  mtdblock3  mtdblock6
root@OpenWrt:/# cat /dev/mtd
cat: can&#039;t open &#039;/dev/mtd&#039;: No such file or directory
root@OpenWrt:/# cat /dev/mtd
mtd0       mtd1ro     mtd3       mtd4ro     mtd6       mtdblock1  mtdblock4
mtd0ro     mtd2       mtd3ro     mtd5       mtd6ro     mtdblock2  mtdblock5
mtd1       mtd2ro     mtd4       mtd5ro     mtdblock0  mtdblock3  mtdblock6
root@OpenWrt:/# cat /proc/mtd
dev:    size   erasesize  name
mtd0: 0000b000 00001000 &quot;routerboot&quot;
mtd1: 00001000 00001000 &quot;hard_config&quot;
mtd2: 00002000 00001000 &quot;bios&quot;
mtd3: 00001000 00001000 &quot;soft_config&quot;
mtd4: 00040000 00020000 &quot;booter&quot;
mtd5: 003c0000 00020000 &quot;kernel&quot;
mtd6: 07c00000 00020000 &quot;rootfs&quot;
root@OpenWrt:/# mount
rootfs on / type rootfs (rw)
/dev/root on / type yaffs (rw,noatime)
proc on /proc type proc (rw,noatime)
sysfs on /sys type sysfs (rw,noatime)
tmpfs on /tmp type tmpfs (rw,nosuid,nodev,noatime,size=128408k)
tmpfs on /dev type tmpfs (rw,noatime,size=512k,mode=755)
devpts on /dev/pts type devpts (rw,noatime,mode=600)
debugfs on /sys/kernel/debug type debugfs (rw,relatime)
none on /proc/bus/usb type usbfs (rw,relatime)
root@OpenWrt:/#</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p177556">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">renne</div>
					<div class="post-datetime">
						9 Sep 2012, 21:01					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>KanjiMonster wrote:</cite><blockquote><p>In case anybody cares, RB493G support is now in trunk.</p></blockquote></div><p>There is no Wiki page for the RB493G in the Table of Hardware.</p><p>Can you set up a Wiki page for OpenWRT-beginners, please?</p><p>Thanx,</p><p>Renne</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178649">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">renne</div>
					<div class="post-datetime">
						18 Sep 2012, 19:13					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>renne wrote:</cite><blockquote><p>There is no Wiki page for the RB493G in the Table of Hardware.</p></blockquote></div><p>Now, there is a Wiki-article for the RB493G! <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p187026">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">Del</div>
					<div class="post-datetime">
						26 Dec 2012, 12:12					</div>
				</div>
				<div class="post-content content">
					<p>I am trying to get a serial console to my newly acquired RB493G,but so far unsuccessful. Would be great to get some confirmation on what I have done so far to help me track down what I need to do. Disclaimer: I have not set up a serial console before. So here it goes:</p><p>Checked which port the serial uses (needed a trip in motherboard&#039;s bios to get it going):<br /></p><div class="codebox"><pre><code>$ dmesg|grep tty
[    0.000000] console [tty0] enabled
[    1.380983] serial8250: ttyS0 at I/O 0x3f8 (irq = 4) is a 16550A
[    1.464579] 00:08: ttyS0 at I/O 0x3f8 (irq = 4) is a 16550A
[10345.017177] cdc_acm 2-6:1.1: ttyACM0: USB ACM device</code></pre></div><p>Installed minicom and set it up according to the wiki:<br /><a href="http://ubuntuone.com/2wo2hjZlEavBMt4CpbRImH">http://ubuntuone.com/2wo2hjZlEavBMt4CpbRImH</a></p><p>Acquired a null-modem cable (or at least a colleague of mine claimed it was a null-modem cable) and a gender changer (female-female). Connected cable to router and PC, started minicom, plugged in power cord to the router. Lights and beeps from the router, but no change in the minicom window. Also tried starting minicom shortly after powering the router, but only the welcome screen of minicom.</p><p>So is there something obvious I am not doing here? On the hardware side, I would like to test on one more PC, and I am also thinking about obtaining another cable, or somehow try to confirm that it indeed is a null-modem cable (I will try to check the wiring).</p>											<p class="post-edited">(Last edited by <strong>Del</strong> on 26 Dec 2012, 12:15)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p187029">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">renne</div>
					<div class="post-datetime">
						26 Dec 2012, 12:56					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Del wrote:</cite><blockquote><p>I am trying to get a serial console to my newly acquired RB493G,but so far unsuccessful.<br />Installed minicom and set it up according to the wiki:<br /><a href="http://ubuntuone.com/2wo2hjZlEavBMt4CpbRImH">http://ubuntuone.com/2wo2hjZlEavBMt4CpbRImH</a></p></blockquote></div><p>Looks good. :-)</p><div class="quotebox"><cite>Del wrote:</cite><blockquote><p>Acquired a null-modem cable (or at least a colleague of mine claimed it was a null-modem cable) and a gender changer (female-female).</p></blockquote></div><p>You probably have a extension cable which is wired 1:1. If you add the gender changer, it&#039;s still 1:1. Null-modem cables are crossed and have a female connector on both sides.<br />Have a look at <a href="http://en.wikipedia.org/wiki/Null_modem">Wikipedia</a>. Do you have a continuity tester?</p><p>I use a <a href="http://de.hama.com/00039786/hama-data-transfer-cable-usb-a-plug-9-pin-d-socket-195-m">Hama Data Transfer Cable, USB-A Plug - 9-pin D-Socket, 1.95 m</a>.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p187041">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">Del</div>
					<div class="post-datetime">
						26 Dec 2012, 15:03					</div>
				</div>
				<div class="post-content content">
					<p>Indeed, I opened up the cable connectors, they are not crosslinked. Found two alternatives on amazon.com:<br /><a href="http://www.amazon.com/StarTech-RS232-Serial-Modem-Adapter/dp/B000DZH4V0/ref=pd_sim_e_2">http://www.amazon.com/StarTech-RS232-Se … pd_sim_e_2</a><br /><a href="http://www.amazon.com/gp/product/B008634VJY/ref=gno_cart_title_2">http://www.amazon.com/gp/product/B00863 … rt_title_2</a><br />but I will check at work first, chances are shipping will take just as long. In any case, it will probably be some days before I get to have another go again.</p><p>Thanks for your help <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188270">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">Del</div>
					<div class="post-datetime">
						8 Jan 2013, 10:22					</div>
				</div>
				<div class="post-content content">
					<p>Finally, ended up with the USB-cable from Amazon, and I have serial console <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Also got netboot working, but the openwrt-ar71xx-nand-vmlinux-initramfs.elf image linked from the wiki does not work, it does not support 493G. I built my own image from trunk, and it works nicely. However, running wget2nand fails. Wget2nand attempts to <br />download the file openwrt-ar71xx-nand-vmlinux-lzma.elf, but this file does not exist (not in any of the openwrt downloads, nor among the files I built). How did you get about this?</p><p>Edit: There is a file&nbsp; openwrt-ar71xx-nand-vmlinux-initramfs-lzma.elf, will that one do the trick?</p>											<p class="post-edited">(Last edited by <strong>Del</strong> on 8 Jan 2013, 10:42)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188310">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">Del</div>
					<div class="post-datetime">
						8 Jan 2013, 17:53					</div>
				</div>
				<div class="post-content content">
					<p>Seems like I am slowly approaching a solution, one more obstacle left.</p><p>Found the relevant changeset for wget2nand:<br /><a href="https://dev.openwrt.org/changeset/34366">https://dev.openwrt.org/changeset/34366</a><br />so it seems a namechange for the vmlinux file took place right after 12.09-RC1 was released. Fair enough, I changed the filename back in the wget2nand script only to find out that my RB493G contains a new flash chip from Toshiba. This flash chip is unfortunately not supported by the kernel following 12.09-RC1, it gave me a kernel panic. Knowing the issues earlier from <a href="https://dev.openwrt.org/ticket/10272">https://dev.openwrt.org/ticket/10272</a> I figured it was natural to start testing with the kernel in trunk to see if support for the Toshiba nand is already in the kernel. Now for some reason the nand images are nowhere to be found in trunk: <a href="http://downloads.openwrt.org/snapshots/trunk/ar71xx/">http://downloads.openwrt.org/snapshots/trunk/ar71xx/</a> so off to compile some new images. I included some extra software in the build, only to find out that it made my initramfs image to big to fit the kernel partition on the nand, there really is little headroom. After a more minimal compile I let the file openwrt-ar71xx-nand-vmlinux-initramfs-lzma.elf play the role of the kernel, and copied it over to the kernel partition. Unpacked the openwrt-ar71xx-nand-rootfs.tar.gz file to the rootfs partition (just like the wget2nand script does). Now it actually boots fine (no error messages related to the Toshiba nand), but it does not mount the root partition during boot, so I end up with no storage space for opkg to do it&#039;s magic. A simple<br /></p><div class="codebox"><pre><code>cat /proc/mounts</code></pre></div><p>does not list any root partition. Nothing (not even the system ssh key, it provides a new one every boot) is remembered between reboots.</p><p>Would be great to some activity beisdes my own in this thread <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>BTW, I did a bit of wiki-editing too: <a href="http://wiki.openwrt.org/toh/mikrotik/rb493g">http://wiki.openwrt.org/toh/mikrotik/rb493g</a></p>											<p class="post-edited">(Last edited by <strong>Del</strong> on 8 Jan 2013, 17:58)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188334">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">renne</div>
					<div class="post-datetime">
						8 Jan 2013, 21:37					</div>
				</div>
				<div class="post-content content">
					<p>Can you try to do a netboot with <a href="http://downloads.openwrt.org/attitude_adjustment/12.09-beta2/ar71xx/nand/openwrt-ar71xx-nand-vmlinux-initramfs.elf">initramfs of 12.09-beta2</a> and run </p><div class="codebox"><pre><code>wget2nand http://downloads.openwrt.org/attitude_adjustment/12.09-beta2/ar71xx/nand/</code></pre></div><p> on your RB493G?</p><p>If it fails, try to format the NAND via the bootloader of the RB493G and try again, please.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188343">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">Del</div>
					<div class="post-datetime">
						8 Jan 2013, 22:42					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for keeping me company <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Just got to the bottom of it. I had to disable the ramfs option in make menuconfig, then it exposed the jffs2 and squashfs images (which is of no use), but it also built the kernel file openwrt-ar71xx-nand-vmlinux-lzma.elf. I just copied it over to the kernel partition on the RB493G, and that did the trick. It mounts the root filesystem fine, and I am already up and running with the net, persistent through reboots. Have to admit I scratched my head more than once today ;-p Really feels good though.</p><p>Now I need to figure out why I only have 2.4GHz radio, I thought it also had 5GHz (it&#039;s <a href="http://routerboard.com/R52Hn">http://routerboard.com/R52Hn</a> )</p><p>Did you have a look at the wiki?</p><p>BTW, as mentioned, I have to use trunk. Even RC1 doesn&#039;t support the Toshiba nand on my board.</p>											<p class="post-edited">(Last edited by <strong>Del</strong> on 8 Jan 2013, 22:45)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188348">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">renne</div>
					<div class="post-datetime">
						8 Jan 2013, 23:41					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Del wrote:</cite><blockquote><p>Have to admit I scratched my head more than once today ;-p Really feels good though.</p></blockquote></div><p>Routerboards are quite complicated to handle, but 9x 1000Base-T + 3x Mini-PCI ... <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><div class="quotebox"><cite>Del wrote:</cite><blockquote><p>Now I need to figure out why I only have 2.4GHz radio, I thought it also had 5GHz (it&#039;s <a href="http://routerboard.com/R52Hn">http://routerboard.com/R52Hn</a> )</p></blockquote></div><p>Seems to be like my R52nM with 2 dBm more transmit power. If I remind well I prefered the R52nM over the R52Hn because of less power consumption. But even with the 2.4 GHz antennas my Nexus 4 can connect with OpenWrt @ 5 GHz. In which country do you live btw. which country did you select for WLAN?</p><div class="quotebox"><cite>Del wrote:</cite><blockquote><p>Did you have a look at the wiki?</p></blockquote></div><p>Gets better with your help! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><div class="quotebox"><cite>Del wrote:</cite><blockquote><p>BTW, as mentioned, I have to use trunk. Even RC1 doesn&#039;t support the Toshiba nand on my board.</p></blockquote></div><p>It seems Mikrotik switches nand vendors every quarter. And it seems there is no revision number on the PCB <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /><br />Maybe you can add the model number of your Toshiba nand chip to the &#039;Flash-Chip&#039;-line in the hardware info table of the Wiki.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188392">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">Del</div>
					<div class="post-datetime">
						9 Jan 2013, 12:57					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>renne wrote:</cite><blockquote><p>Routerboards are quite complicated to handle, but 9x 1000Base-T + 3x Mini-PCI ... <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p></blockquote></div><p>Indeed, I now have three ports free. The hardware is quite capable too. It is more snappy than my old router (identical CPU, so storage and/or memory is better, not sure I am up to benchmarking that just yet, need a little break now).<br /></p><div class="quotebox"><cite>renne wrote:</cite><blockquote><p>Seems to be like my R52nM with 2 dBm more transmit power. If I remind well I prefered the R52nM over the R52Hn because of less power consumption. But even with the 2.4 GHz antennas my Nexus 4 can connect with OpenWrt @ 5 GHz. In which country do you live btw. which country did you select for WLAN?</p></blockquote></div><p>I live in Norway, it is currently set for US, no different from my previous router where both radios worked fine. There really is no trace of the second radio on this thing, guess I will have to figure out how ath9k advertise the radios.<br /></p><div class="quotebox"><cite>renne wrote:</cite><blockquote><p>It seems Mikrotik switches nand vendors every quarter. And it seems there is no revision number on the PCB <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /><br />Maybe you can add the model number of your Toshiba nand chip to the &#039;Flash-Chip&#039;-line in the hardware info table of the Wiki.</p></blockquote></div><p>I added both of the other known chips.</p><p>Already replaced my old router, now I need to get the configuration finished. First up is setting up a guest network. I made a user-friendly walk-through of it on the wiki, it is one of those cases where I find CLI less efficient:<br /><a href="http://wiki.openwrt.org/doc/recipes/guest-wlan-webinterface">http://wiki.openwrt.org/doc/recipes/gue … binterface</a></p><p>I also plan to get openvpn server up and running, but it seems the Luci functionality is broken and the package removed. Not sure how to allocate the time to learn lua, learn the ways of luci, and then get the openvpn part up to speed again. Life really is too short.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188394">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">Del</div>
					<div class="post-datetime">
						9 Jan 2013, 13:14					</div>
				</div>
				<div class="post-content content">
					<p>Bah, just figured out the radio. There is of course only one radio, but I am free to choose from both 2.4GHz and 5GHz when I set the channel for a wireless network. I can create multiple networks, but they will use the same radio.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188395">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">renne</div>
					<div class="post-datetime">
						9 Jan 2013, 13:19					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Del wrote:</cite><blockquote><p>The hardware is quite capable too. It is more snappy than my old router (identical CPU, so storage and/or memory is better, not sure I am up to benchmarking that just yet, need a little break now).</p></blockquote></div><p>I was really impressed by the 30 MByte/s Samba speed.</p><div class="quotebox"><cite>Del wrote:</cite><blockquote><p>I live in Norway, it is currently set for US, no different from my previous router where both radios worked fine. There really is no trace of the second radio on this thing, guess I will have to figure out how ath9k advertise the radios.</p></blockquote></div><p>You should use the setting for Norway as there are a channel tables based on national regulations to avoid interference with other systems (like weather-, flight- or military radar). Unfortunately the Linux kernel isn&#039;t capable to handle 5500 - 5700 MHz, yet.<br />For dual-band you need a second card and another two antennas.</p><div class="quotebox"><cite>Del wrote:</cite><blockquote><p>I added both of the other known chips. First up is setting up a guest network. I made a user-friendly walk-through of it on the wiki, it is one of those cases where I find CLI less efficient:<br /><a href="http://wiki.openwrt.org/doc/recipes/guest-wlan-webinterface">http://wiki.openwrt.org/doc/recipes/gue … binterface</a></p></blockquote></div><p>Great! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><div class="quotebox"><cite>Del wrote:</cite><blockquote><p>I also plan to get openvpn server up and running, but it seems the Luci functionality is broken and the package removed.</p></blockquote></div><p> Ouch - OpenVPN is on my todo list, too.</p>											<p class="post-edited">(Last edited by <strong>renne</strong> on 9 Jan 2013, 13:21)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188396">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">Del</div>
					<div class="post-datetime">
						9 Jan 2013, 13:30					</div>
				</div>
				<div class="post-content content">
					<p>OpenVPN is a rather critical functionality for a router. We can of course set it up the standard CLI way, but lacking a user friendly route will shut out a whole lot of users.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188397">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">Del</div>
					<div class="post-datetime">
						9 Jan 2013, 13:32					</div>
				</div>
				<div class="post-content content">
					<p>30MBytes/s is really impressive. Is that from a USB attached disk? It could very well be the harddrive that poses a limit. I will try to find some time to do some benching of it. Sharing a ramdisk over samba should provide good numbers (and this baby&nbsp; has a lot of ram).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188398">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">renne</div>
					<div class="post-datetime">
						9 Jan 2013, 13:32					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Del wrote:</cite><blockquote><p>OpenVPN is a rather critical functionality for a router. We can of course set it up the standard CLI way, but lacking a user friendly route will shut out a whole lot of users.</p></blockquote></div><p>Which means writing tickets to get it fixed until final release. Did you try the SD-card-reader?</p>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=28889&amp;p=2.html">2</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>