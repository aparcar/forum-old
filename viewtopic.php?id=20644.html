<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Alix LuCI blues</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 20 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p89683">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">j4k32</div>
					<div class="post-datetime">
						11 Jun 2009, 06:58					</div>
				</div>
				<div class="post-content content">
					<p>Hello, I&#039;ve installed the x86 version of Kamakaze 8.09.1 onto an Alix 3d2 board, and everything works just fine, it&#039;s just LuCI that gives me a blank page when I navigate to it now.</p><p>I did create a larger /usr partition, copied all of the contents of the /usr directory from the image then remounted it in the /etc/preinit file. All seemed to be working fine. I originally had the thing running, but it appears that LuCI broke after adding a few packages. When I execute LuCI from the command line I get: Status: 500 Internal Server Error</p><p>I ran an strace against luci, and I do see a few errors on some initial file reads, but it always eventually finds what it&#039;s trying to read. It finally gives up the ghost looking something like this:</p><p>open(&quot;/etc/config/luci&quot;, O_RDONLY)&nbsp; &nbsp; &nbsp; = 3<br />flock(3, LOCK_SH)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 0<br />lseek(3, 0, SEEK_SET)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 0<br />fcntl(3, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 0 (flags O_RDONLY)<br />ioctl(3, SNDCTL_TMR_TIMEBASE or TCGETS, 0xbfaeb75c) = -1 ENOTTY (Inappropriate ioctl for device)<br />read(3, &quot;\nconfig \&#039;core\&#039; \&#039;main\&#039;\n\toption \&#039;l&quot;..., 4096) = 677<br />read(3, &quot;&quot;, 4096)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 0<br />ioctl(2147483647, SNDCTL_TMR_TIMEBASE or TCGETS, 0xbfaeb744) = -1 EBADF (Bad file descriptor)<br />stat(&quot;/tmp/.uci/luci&quot;, 0xbfaeb6d0)&nbsp; &nbsp; &nbsp; = -1 ENOENT (No such file or directory)<br />flock(3, LOCK_UN)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 0<br />close(3)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />write(1, &quot;Status: 500 Internal Server Erro&quot;..., 35) = 35<br />write(1, &quot;\r\n&quot;, 2)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 2<br />rt_sigaction(SIGINT, {SIG_DFL}, {0x8049210, [INT], SA_RESTORER|SA_RESTART, 0xb7f4da08}, 8) = 0<br />munmap(0xb7f3f000, 16180)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 0<br />munmap(0xb7f37000, 29504)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 0<br />_exit(0)&nbsp; </p><br /><p>I don&#039;t think it&#039;s my remounted /usr directory, since every thing else seems to work fine, and luci worked fine before adding packages. And I don&#039;t see any other processes crabbing about dependencies or paths at all, so I&#039;m at a loss.</p><p>There is one other peculiar thing at boot up. Looking at the console during boot I see this:</p><p>Please be patient, while OpenWrt loads ...<br />- preinit -<br />Press CTRL-C for failsafe<br />- init -</p><p>Please press Enter to activate this console. /etc/rc.common: eval: line 13: lua: not found</p><p>Any one have any ideas?</p><p>Thanks</p>											<p class="post-edited">(Last edited by <strong>j4k32</strong> on 11 Jun 2009, 08:05)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p89697">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Yanira</div>
					<div class="post-datetime">
						11 Jun 2009, 11:48					</div>
				</div>
				<div class="post-content content">
					<p>I run m0n0wall since almost a year on a Alix 2c2 without any problems and testing SlugOS 5.3 on the NSLU2 at the moment.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p89703">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						11 Jun 2009, 14:27					</div>
				</div>
				<div class="post-content content">
					<p>Hi.</p><p> - Locate and edit /usr/lib/lua/luci/dispatcher.lua<br /> - Search the line &quot;luci.http.status(500, &quot;Internal Server Error&quot;)&quot;<br /> - Add the line &quot;luci.http.write(message)&quot; below<br /> - Save &amp; quit the file<br /> - Purge caches with rm -rf /tmp/luci-*<br /> - Re-execute luci from the cli, you should now get a stacktrace or sth. similar</p><p>~ JoW</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p89751">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">j4k32</div>
					<div class="post-datetime">
						12 Jun 2009, 01:47					</div>
				</div>
				<div class="post-content content">
					<p>Hello Jow,</p><p>Thanks for the suggestion.</p><p>After making the changes to the dispatcher.lua, and running luci from /www/cgi-bin here is what showed up on the console.</p><p>Status: 500 Internal Server Error<br />Content-Type: text/html; charset=utf-8<br />Cache-Control: no-cache<br />Expires: 0</p><p>/usr/lib/lua/luci/dispatcher.lua:209: bad argument #1 to &#039;basename&#039; (string expected, got nil)<br />stack traceback:<br />&nbsp; &nbsp; &nbsp; &nbsp; [C]: in function &#039;basename&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; /usr/lib/lua/luci/dispatcher.lua:209: in function &#039;dispatch&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; /usr/lib/lua/luci/dispatcher.lua:119: in function &lt;/usr/lib/lua/luci/dispatcher.lua:118&gt;</p><p>Thank you for your help!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p89756">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						12 Jun 2009, 02:50					</div>
				</div>
				<div class="post-content content">
					<p>Hi.</p><p>Looks like no theme is installed.<br />Make sure that at least &quot;luci-theme-openwrt&quot; is installed and that /etc/config/luci contains at least this keys:</p><div class="codebox"><pre><code>config &#039;core&#039; &#039;main&#039;
    option &#039;lang&#039; &#039;en&#039;
    option &#039;mediaurlbase&#039; &#039;/luci-static/openwrt.org&#039;
    option &#039;resourcebase&#039; &#039;/luci-static/resources&#039;</code></pre></div><p>HTH, JoW</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p89760">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">j4k32</div>
					<div class="post-datetime">
						12 Jun 2009, 03:42					</div>
				</div>
				<div class="post-content content">
					<p>That was it. </p><p>This line was missing from the top of my /etc/config/luci</p><p>option &#039;mediaurlbase&#039; &#039;/luci-static/openwrt.org&#039;</p><p>I added that theme line and it works now!</p><p>I think a package I installed somehow changed the luci config and removed that entry. </p><p>In any event it&#039;s back up and running, thank you JoW.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>