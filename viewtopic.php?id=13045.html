<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Change password remotely</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 20 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p57697">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">workhn</div>
					<div class="post-datetime">
						18 Oct 2007, 13:02					</div>
				</div>
				<div class="post-content content">
					<p>How do I change password remotely using ssh?<br />I tried &#039;plink ... &quot;echo -e &#039;adf\nadf&#039; | passwd&quot;. But it doesn&#039;t work. However such command doesn&#039;t work in normal terminal. Is there any suitable batch command?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p57754">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">workhn</div>
					<div class="post-datetime">
						19 Oct 2007, 10:28					</div>
				</div>
				<div class="post-content content">
					<p>The problem solved using &quot;expect&quot; command.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p57757">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Duff</div>
					<div class="post-datetime">
						19 Oct 2007, 11:19					</div>
				</div>
				<div class="post-content content">
					<p>I don&#039;t understand what you mean.</p><p>Do you have an example?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p57760">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">workhn</div>
					<div class="post-datetime">
						19 Oct 2007, 11:43					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Duff wrote:</cite><blockquote><p>I don&#039;t understand what you mean.</p><p>Do you have an example?</p></blockquote></div><p>I need to remotely run passwd command and automatically enter and retype password as a user could do manually. Or remotely change password somehow different way.</p><p>#passwd<br />...<br />Enter password: newpass<br />Re-type password: newppass<br />Password changed.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p57762">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">Duff</div>
					<div class="post-datetime">
						19 Oct 2007, 12:05					</div>
				</div>
				<div class="post-content content">
					<p>Yes, I understand.</p><p>But what command do you execute?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p57763">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">workhn</div>
					<div class="post-datetime">
						19 Oct 2007, 12:18					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Duff wrote:</cite><blockquote><p>Yes, I understand.</p><p>But what command do you execute?</p></blockquote></div><p>I downloaded &quot;<a href="http://expect.nist.gov/">expect</a>&quot; program. This program can reply predefined phrases to expected queries using special script. To connect trhough SSH I use plink program - command line version of PuTTY.</p><p>The script:<br /></p><div class="codebox"><pre><code>#change_password host curpass newpass

set host [lindex $argv 0]
set curpass [lindex $argv 1]
set newpass [lindex $argv 2]

spawn plink $host

expect &quot;login as:&quot;
send &quot;root\r&quot;
expect &quot;password:&quot;
send &quot;$curpass\r&quot;

expect {
    &quot;Access denied&quot; &quot;exit 1&quot;
}

expect &quot;:~#&quot;
send &quot;passwd\r&quot;
expect &quot;Enter new password:&quot;
send &quot;$newpass\r&quot;
expect &quot;Re-enter new password:&quot;
send &quot;$newpass\r&quot;
expect &quot;:~#&quot;
send &quot;exit\r&quot;
exit 0</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p57767">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">Duff</div>
					<div class="post-datetime">
						19 Oct 2007, 13:20					</div>
				</div>
				<div class="post-content content">
					<p>Ok, thanks.</p><p>Now, I have understand.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>