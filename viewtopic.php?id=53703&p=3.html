<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> TP-Link Archer C7: 802.11ac slower in OpenWRT than native firmware</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 19 Apr 2018 and 6 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 3 of 9</div><nav><ul><li><a href="viewtopic.php%3Fid=53703&amp;p=1.html">1</a></li><li><a href="viewtopic.php%3Fid=53703&amp;p=2.html">2</a></li><li class="pagination-current"><span>3</span></li><li><a href="viewtopic.php%3Fid=53703&amp;p=4.html">4</a></li><li><a href="viewtopic.php%3Fid=53703&amp;p=5.html">5</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=53703&amp;p=9.html">9</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p255766">
				<div class="post-metadata">
					<div class="post-num">Post #51</div>
					<div class="post-author">mastabog</div>
					<div class="post-datetime">
						27 Nov 2014, 19:09					</div>
				</div>
				<div class="post-content content">
					<p>@dem As I reported above and also in the 1st post, I hit 500+ Mbps on BB, so something must have been wrong with your BB setup (correct hw version file? wifi settings?)</p><p>Yes, I did test CC too, a couple of weeks ago and it performed the same as BB. There is a <strong>major</strong> difference between native fw and CC. You didn&#039;t see a difference because you used a crippled phone as a client which caps you at 250 Mbps -- any AC router hits 250 Mbps on any firmware. It&#039;s misleading state that there is no difference between firmwares when you can&#039;t push it to the capacity of the hardware.</p><p>On 3-stream AC1300 devices: plenty of laptops are 3-stream. The 3 antennas don&#039;t have to be external. For example, all Macbook Pros from 2013 onward (including early 2013) are 3-stream AC1300. You&#039;re not obliged to own a 3-stream AC1300 device, but using a crippled device to run the tests in 1st post is out of the scope of this thread and gives misleading results ... just like yours show that CC is just as fast/stable as the native fw, which is false.</p>											<p class="post-edited">(Last edited by <strong>mastabog</strong> on 27 Nov 2014, 20:58)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p255775">
				<div class="post-metadata">
					<div class="post-num">Post #52</div>
					<div class="post-author">mastabog</div>
					<div class="post-datetime">
						27 Nov 2014, 20:47					</div>
				</div>
				<div class="post-content content">
					<p>Followup to my post above, I just re-tested CC from today&#039;s trunk. Same conditions and setup as the 1st post.</p><p><strong>CC trunk 20141127, TCP test:</strong> Hits 537 Mbps, but pretty erratic overall, more erratic than BB (see my 1st post), averaging at 293 Mbps.</p><div class="codebox"><pre><code>[ ID] Interval       Transfer     Bandwidth
[192]  0.0- 1.0 sec  6.00 MBytes  50.3 Mbits/sec
[192]  1.0- 2.0 sec  32.0 MBytes   268 Mbits/sec
[192]  2.0- 3.0 sec  48.0 MBytes   403 Mbits/sec
[192]  3.0- 4.0 sec  56.0 MBytes   470 Mbits/sec
[192]  4.0- 5.0 sec  64.0 MBytes   537 Mbits/sec
[192]  5.0- 6.0 sec  64.0 MBytes   537 Mbits/sec
[192]  6.0- 7.0 sec  16.0 MBytes   134 Mbits/sec
[192]  7.0- 8.0 sec  16.0 MBytes   134 Mbits/sec
[192]  8.0- 9.0 sec  8.00 MBytes  67.1 Mbits/sec
[192]  9.0-10.0 sec  40.0 MBytes   336 Mbits/sec
[192]  0.0-10.1 sec   352 MBytes   293 Mbits/sec
Done.</code></pre></div><br /><p><strong>Tp-link firmware re-tested today, TCP test:</strong> Dead stable near 850 Mbps ... quite impressive, frustrating!</p><div class="codebox"><pre><code>[ ID] Interval       Transfer     Bandwidth
[184]  0.0- 1.0 sec   102 MBytes   856 Mbits/sec
[184]  1.0- 2.0 sec   104 MBytes   872 Mbits/sec
[184]  2.0- 3.0 sec   104 MBytes   872 Mbits/sec
[184]  3.0- 4.0 sec   104 MBytes   872 Mbits/sec
[184]  4.0- 5.0 sec  96.0 MBytes   805 Mbits/sec
[184]  5.0- 6.0 sec   104 MBytes   872 Mbits/sec
[184]  6.0- 7.0 sec   104 MBytes   872 Mbits/sec
[184]  7.0- 8.0 sec   104 MBytes   872 Mbits/sec
[184]  8.0- 9.0 sec   104 MBytes   872 Mbits/sec
[184]  9.0-10.0 sec  96.0 MBytes   805 Mbits/sec
[184]  0.0-10.0 sec  1024 MBytes   858 Mbits/sec
Done.</code></pre></div><br /><p>Also, now I captured CPU usage with htop on OpenWRT. It&#039;s at 100% ... that&#039;s definitely the bottleneck. Could a dev perhaps figure out why this happens? I only installed kmod-ath10k after flashing the CC snapshot, nothing else, so this is as bare and light as it can get. Here&#039;s a htop snapshot on the router during one iperf tcp test that was running on the LAN and WLAN client machines:</p><div class="codebox"><pre><code>  CPU[|||||||||||||||||||||||||||||||||98.1%]     Tasks: 16, 0 thr; 2 running
  Mem[||||||||||||                  23/123MB]     Load average: 0.47 0.35 0.18
  Swp[                                 0/0MB]     Uptime: 00:10:21

  PID USER      PRI  NI  VIRT   RES   SHR S CPU% MEM%   TIME+  Command
 1134 root       20   0  1604   480   304 S 16.4  0.4  0:13.29 /usr/sbin/hostapd -P /var/run/wif
 1353 root       20   0  1372   772   544 R  5.3  0.6  0:01.06 htop
  884 root       20   0  1364   388   312 S  0.7  0.3  0:00.05 /usr/sbin/telnetd -F -l /bin/logi
  805 root       20   0  1484   708   500 S  0.0  0.6  0:00.35 /sbin/netifd
  831 root       20   0  1156   560   400 S  0.0  0.4  0:00.10 /usr/sbin/odhcpd
  910 root       20   0  1364   468   392 S  0.0  0.4  0:00.13 /usr/sbin/ntpd -n -p 0.openwrt.po
 1241 root       20   0  1604   608   432 S  0.0  0.5  0:00.18 /usr/sbin/hostapd -P /var/run/wif
    1 root       20   0  1396   624   436 S  0.0  0.5  0:02.50 /sbin/procd
  471 root       20   0   888   284   216 S  0.0  0.2  0:00.03 /sbin/ubusd
  472 root       20   0   772   212   156 S  0.0  0.2  0:00.01 /sbin/askfirst /bin/ash --login
  753 root       20   0  1040   416   268 S  0.0  0.3  0:00.06 /sbin/logd -S 16
  863 root       20   0  1152   420   348 S  0.0  0.3  0:00.03 /usr/sbin/dropbear -F -P /var/run
 1116 root       20   0   808   312   244 S  0.0  0.2  0:00.01 odhcp6c -s /lib/netifd/dhcpv6.scr
 1163 nobody     20   0   928   508   412 S  0.0  0.4  0:00.04 /usr/sbin/dnsmasq -C /var/etc/dns
 1293 root       20   0  1364   448   368 S  0.0  0.4  0:00.02 /bin/ash --login
 1303 root       20   0  1364   448   368 S  0.0  0.4  0:00.00 /bin/ash --login</code></pre></div><br /><p>Here&#039;s the /etc/config/wireless I used after installing kmod-ath10k:</p><div class="codebox"><pre><code>config wifi-device &#039;radio0&#039;
    option type &#039;mac80211&#039;
    option path &#039;pci0000:01/0000:01:00.0&#039;
    option txpower &#039;17&#039;
    option country &#039;US&#039;
    option hwmode &#039;11a&#039;
    option htmode &#039;VHT80&#039;
    option channel &#039;36&#039;

config wifi-iface
    option device &#039;radio0&#039;
    option network &#039;lan&#039;
    option mode &#039;ap&#039;
    option ssid &#039;wlan-50&#039;
    option encryption &#039;psk-mixed&#039;
    option key &#039;PASSWORD&#039;

config wifi-device &#039;radio1&#039;
    option type &#039;mac80211&#039;
    option hwmode &#039;11g&#039;
    option path &#039;platform/qca955x_wmac&#039;
    option txpower &#039;30&#039;
    option htmode &#039;HT40&#039;
    option country &#039;US&#039;
    option channel &#039;1&#039;

config wifi-iface
    option device &#039;radio1&#039;
    option network &#039;lan&#039;
    option mode &#039;ap&#039;
    option ssid &#039;wlan-24&#039;
    option encryption &#039;psk-mixed&#039;
    option key &#039;PASSWORD&#039;</code></pre></div>											<p class="post-edited">(Last edited by <strong>mastabog</strong> on 27 Nov 2014, 21:00)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p255776">
				<div class="post-metadata">
					<div class="post-num">Post #53</div>
					<div class="post-author">dem</div>
					<div class="post-datetime">
						27 Nov 2014, 21:11					</div>
				</div>
				<div class="post-content content">
					<p>@Mastabog<br />Yes of course my BB setup was correct.&nbsp; &nbsp;I have tested two different versions of BB.&nbsp; &nbsp;My own compiled version and an older version.&nbsp; I have four Archer C7s now.</p><p>It would be good if you could post your newer data for CC since you have a newer AC wireless card so we can see how CC support is progressing with benchmarks.</p><p>In regards to my tests I think it&#039;s relevant that even at AC600 there&#039;s a big improvement in CC.&nbsp; I don&#039;t believe BB ath10k AC support is equivalent to CC.</p><p>Of course the three antennas for 3 MIMO don&#039;t have to be external.&nbsp; &nbsp;My point was that I&#039;m hardly going to strip my laptop and install an extra antenna just so I can have a higher spec AC wireless adapter nor am I going to buy a new laptop or install a bulky USB 3.0 adapter simply for that privilege.</p>											<p class="post-edited">(Last edited by <strong>dem</strong> on 27 Nov 2014, 21:28)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p255778">
				<div class="post-metadata">
					<div class="post-num">Post #54</div>
					<div class="post-author">dem</div>
					<div class="post-datetime">
						27 Nov 2014, 21:29					</div>
				</div>
				<div class="post-content content">
					<p>My CC&nbsp; &nbsp;Archer C7 uses a lot of system irq when using a lot of wifi too.&nbsp; &nbsp; &nbsp;The same happens with 2.4 Ghz though.</p><p>It would be interesting to see if this is the same within BB.&nbsp; &nbsp; &nbsp;I just wonder whether the TP Link firmware is able to use some kind of hardware acceleration for Wifi that Openwrt doesn&#039;t support as has been suggested after earlier NAT benchmark test comparisons.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p255779">
				<div class="post-metadata">
					<div class="post-num">Post #55</div>
					<div class="post-author">mastabog</div>
					<div class="post-datetime">
						27 Nov 2014, 21:42					</div>
				</div>
				<div class="post-content content">
					<p>@dem did you see my post above? I just reported CC performance tested today from today&#039;s trunk. It&#039;s worse than BB.</p><p>As for your phone test, once again: when you&#039;re not using 3-streams (full hw capacity) then everything is much easier, lighter on the CPU, things will look more stable, etc ... but that&#039;s just <strong>misleading</strong>. Moreover, you&#039;re not even able to max out 2-streams on 11ac as your phone caps you at 250 Mbps. Your phone test is simply not relevant and should <strong>not</strong> be trusted, it&#039;s misleading in pretty much all respects.</p><p>Also, you don&#039;t need an 802.11ac router (3-stream or 2-stream) to hit 250 Mbps. 802.11n will do that just fine. You could force the router to 11n (not 11ac) and you&#039;ll see you can hit 250 Mbps quite easily -- but please keep in mind this thread is about AC1300 speeds; you could create another thread if you wish to investigate stability for sub-AC1300.</p>											<p class="post-edited">(Last edited by <strong>mastabog</strong> on 28 Nov 2014, 01:37)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p256174">
				<div class="post-metadata">
					<div class="post-num">Post #56</div>
					<div class="post-author">DooMMasteR</div>
					<div class="post-datetime">
						1 Dec 2014, 21:55					</div>
				</div>
				<div class="post-content content">
					<p>Is there any development on this issue? I have just ordered a C7 (hopefully v2) and would like to see speeds above 500MBit/s in real world with OpenWRT</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p256298">
				<div class="post-metadata">
					<div class="post-num">Post #57</div>
					<div class="post-author">mastabog</div>
					<div class="post-datetime">
						2 Dec 2014, 17:33					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>DooMMasteR wrote:</cite><blockquote><p>Is there any development on this issue? I have just ordered a C7 (hopefully v2) and would like to see speeds above 500MBit/s in real world with OpenWRT</p></blockquote></div><p>Have you read my post above from 4 days ago?</p>											<p class="post-edited">(Last edited by <strong>mastabog</strong> on 2 Dec 2014, 17:34)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p256417">
				<div class="post-metadata">
					<div class="post-num">Post #58</div>
					<div class="post-author">odlg</div>
					<div class="post-datetime">
						3 Dec 2014, 15:27					</div>
				</div>
				<div class="post-content content">
					<p>The ath10k driver is developed here: <a href="http://wireless.kernel.org/en/users/Drivers/ath10k/">http://wireless.kernel.org/en/users/Drivers/ath10k/</a> - and development seems active, they do not talk much about performance though. <br />The driver in CC was last updated 2014-11-04 accoding to PKG_VERSION in <a href="http://git.openwrt.org/?p=openwrt.git;a=blob;f=package/kernel/mac80211/Makefile;hb=HEAD">http://git.openwrt.org/?p=openwrt.git;a … le;hb=HEAD</a> <br />The driver was &quot;released&quot; from the ath10k team at 2014-10-24. They have made a couple of pull requests (releases) since, if some developer updated to a newer release, the situation might improve. </p><p>The ath10k developers list a full hostapd configuration that is tuned for best possible throughput, have anybody tried that? It seems that there are some differences between the generated hostapd configuration and the one listed, but I do not know whether these differences are important. I only a 2x2 MIMO client and get 500-530 Mbit rather consistently.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p256437">
				<div class="post-metadata">
					<div class="post-num">Post #59</div>
					<div class="post-author">mastabog</div>
					<div class="post-datetime">
						3 Dec 2014, 18:08					</div>
				</div>
				<div class="post-content content">
					<p>I think PKG_VERSION refers to the date the opkg package was last modified for openwrt and not to the date the source files were last modified. Modifying the opkg package can happen for a ton of reasons not related to the actual source code of whatever is in the opkg package.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p261796">
				<div class="post-metadata">
					<div class="post-num">Post #60</div>
					<div class="post-author">omiez</div>
					<div class="post-datetime">
						17 Jan 2015, 03:42					</div>
				</div>
				<div class="post-content content">
					<p>Is 5Ghz working in OpenWrt with Archer C7 V.2.0?</p><p>If yes. How can i setuo 5Ghz, in web interface or only via config file?</p><p>Tnx</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p261889">
				<div class="post-metadata">
					<div class="post-num">Post #61</div>
					<div class="post-author">dagb</div>
					<div class="post-datetime">
						18 Jan 2015, 00:14					</div>
				</div>
				<div class="post-content content">
					<p>I believe this link may be of interest in this thread.&nbsp; &nbsp;:-)<br /><a href="http://lists.infradead.org/pipermail/ath10k/2015-January/004062.html">http://lists.infradead.org/pipermail/at … 04062.html</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p261897">
				<div class="post-metadata">
					<div class="post-num">Post #62</div>
					<div class="post-author">sat</div>
					<div class="post-datetime">
						18 Jan 2015, 04:39					</div>
				</div>
				<div class="post-content content">
					<p>@dagb that looks like a promising patch?</p><p>Anybody want to spool up a build of CC with that to see if their performance improves?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p261908">
				<div class="post-metadata">
					<div class="post-num">Post #63</div>
					<div class="post-author">dagb</div>
					<div class="post-datetime">
						18 Jan 2015, 12:16					</div>
				</div>
				<div class="post-content content">
					<p>There appears to be other performance-related patches floating around, too. And a bit of discussion around them.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p261958">
				<div class="post-metadata">
					<div class="post-num">Post #64</div>
					<div class="post-author">sat</div>
					<div class="post-datetime">
						18 Jan 2015, 20:19					</div>
				</div>
				<div class="post-content content">
					<p>Glad to hear it!&nbsp; </p><p>I&#039;m definitely seeing a TX Bitrate showing as 6 Mbit/s where the RX Bitrate is as high as 1053 Mbit/s!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p262093">
				<div class="post-metadata">
					<div class="post-num">Post #65</div>
					<div class="post-author">Grazfather</div>
					<div class="post-datetime">
						20 Jan 2015, 01:43					</div>
				</div>
				<div class="post-content content">
					<p>What&#039;s the expected rate we&#039;d expect between two wireless clients? I don&#039;t have a machine with a gigabit NIC (ordered a USB3 one, though), but I&#039;d like to help if anyone needs extra testing. I just got my C7 today and have avoided installing OpenWRT because I found this thread.</p><p>How can I test the connection speed to the router only? With openWRT installed I imagine I can just run the iperf server there and then test from my MPB, but I&#039;m SOL running stock firmware, I guess.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p262655">
				<div class="post-metadata">
					<div class="post-num">Post #66</div>
					<div class="post-author">nasho</div>
					<div class="post-datetime">
						24 Jan 2015, 14:55					</div>
				</div>
				<div class="post-content content">
					<p>Did someone try to build image without iptables at all, an use switch NAT if lan and wan are required . If CPU is the bottleneck than iptables is most likely the culprit. Iptables even if appears to do nothing, every packet is inspected and uses cycles. Every major new kernel release introduces new iptables feature and degrades performance.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p262665">
				<div class="post-metadata">
					<div class="post-num">Post #67</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						24 Jan 2015, 15:55					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nasho wrote:</cite><blockquote><p>an use switch NAT if lan and wan are required</p></blockquote></div><p>switch nat???</p><p>you mean hwnat?</p><p><a href="https://dev.openwrt.org/ticket/11779">https://dev.openwrt.org/ticket/11779</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p263038">
				<div class="post-metadata">
					<div class="post-num">Post #68</div>
					<div class="post-author">Grazfather</div>
					<div class="post-datetime">
						27 Jan 2015, 07:27					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nebbia88 wrote:</cite><blockquote><div class="quotebox"><cite>nasho wrote:</cite><blockquote><p>an use switch NAT if lan and wan are required</p></blockquote></div><p>switch nat???</p><p>you mean hwnat?</p><p><a href="https://dev.openwrt.org/ticket/11779">https://dev.openwrt.org/ticket/11779</a></p></blockquote></div><p>That is hilarious to read.</p><p>It&#039;s a shame that it doesn&#039;t look like it&#039;ll get done.</p><p>One commented touched on something that I think could work. Why not at least expose the device through simple sysfs nodes or something, disable the sw NAT, and then write script to configure it (basically parse the config from the web and convert it to whatever we need to configure the hw in a similar manner).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p263256">
				<div class="post-metadata">
					<div class="post-num">Post #69</div>
					<div class="post-author">sat</div>
					<div class="post-datetime">
						28 Jan 2015, 15:51					</div>
				</div>
				<div class="post-content content">
					<p>Is anybody able to get the ac radio working on the C7 with current trunk? The problem I&#039;m seeing is &quot;ath10k_pci 0000:01:00.0: Direct firmware load failed with error -2&quot;.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p263264">
				<div class="post-metadata">
					<div class="post-num">Post #70</div>
					<div class="post-author">sat</div>
					<div class="post-datetime">
						28 Jan 2015, 16:49					</div>
				</div>
				<div class="post-content content">
					<p>Here&#039;s the relevant full dmesg for the ath10k modules:</p><p>[&nbsp; 353.570000] ath10k_pci 0000:01:00.0: pci irq legacy interrupts 0 irq_mode 0 reset_mode 0<br />[&nbsp; 353.920000] ath10k_pci 0000:01:00.0: Direct firmware load failed with error -2<br />[&nbsp; 353.920000] ath10k_pci 0000:01:00.0: Falling back to user helper<br />[&nbsp; 354.060000] ath10k_pci 0000:01:00.0: otp stream is empty, using board.bin contents<br />[&nbsp; 355.240000] ath10k_pci 0000:01:00.0: qca988x hw2.0 (0x4100016c, 0x043202ff) fw 10.2-00082-4-2 api 3 htt 2.1 wmi 65.109.0.0 cal otp<br />[&nbsp; 355.250000] ath10k_pci 0000:01:00.0: debug 0 debugfs 1 tracing 0 dfs 1 testmode 1<br />[&nbsp; 355.860000] ath: EEPROM regdomain: 0x0<br />[&nbsp; 355.860000] ath: EEPROM indicates default country code should be used<br />[&nbsp; 355.870000] ath: doing EEPROM country-&gt;regdmn map search<br />[&nbsp; 355.870000] ath: country maps to regdmn code: 0x3a<br />[&nbsp; 355.880000] ath: Country alpha2 being used: US<br />[&nbsp; 355.880000] ath: Regpair used: 0x3a</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p263266">
				<div class="post-metadata">
					<div class="post-num">Post #71</div>
					<div class="post-author">sat</div>
					<div class="post-datetime">
						28 Jan 2015, 16:59					</div>
				</div>
				<div class="post-content content">
					<p>Actually I managed to fix this issue.&nbsp; Just an FYI.</p><p>After you install your router software and install the kmod-ath10k package, download this firmware to your local computer:</p><p><a href="https://github.com/kvalo/ath10k-firmware/blob/master/10.2.4/untested/firmware-3.bin_10.2.4.13-1">https://github.com/kvalo/ath10k-firmwar … 0.2.4.13-1</a></p><p>Then copy it to the router&#039;s firmware directory:</p><p>scp firmware-3.bin_10.2.4.13-1 root@192.168.1.1:/lib/firmware/ath10k/QCA988X/hw2.0/firmware-3.bin</p><p>Then reboot the router, and you should be back up with the 5ghz network. (Still with the 6MB/s TX Rate though.)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p265959">
				<div class="post-metadata">
					<div class="post-num">Post #72</div>
					<div class="post-author">valentt</div>
					<div class="post-datetime">
						17 Feb 2015, 22:48					</div>
				</div>
				<div class="post-content content">
					<p>Why it OpenWrt slower than stock firmware? I can help by shining a bit of light onto this subject. I&#039;m developing custom firwmares based on OpenWrt but I&#039;m not OpenWrt developer, still as I have few years of experience with OpenWrt I can explain why sometimes performance sucks.</p><p>OpenWrt has three main parts; linux kernel, software packages and wireless drivers. OpenWrt developers work on all of them. Consider the amount of code this is, and consider that all work is done by a handful of OpenWrt developers. If you work in software industry you know many people big companies hire to work on much smaller projects. So be thankful it works as good as it does, it is actually a miracle that it works as good as it does <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Main issue is that wifi chip manufacturers don&#039;t offer open source wifi drivers. If Atheros and Broadcom understood Open source as Intel does then you would get absolutely top speed and reliability from OpenWrt wifi drivers. You don&#039;t get top notch performance with OpenWrt because Atheros and Broadcom are choosing not release quality open source drivers.</p><p>Linux, BSDx and OpenWrt developers can only use other means to get wifi devices to work, usually reverse engineering, and without support from wifi chip companies it is not easy to support all features, get awesome performance and stability.</p><p>This is a long way of saying, that if performance sucks on OpenWrt you should blame Atheros and Broadcom for not giving you (OpenWrt community) high quality open source drivers!</p>											<p class="post-edited">(Last edited by <strong>valentt</strong> on 17 Feb 2015, 22:56)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p268180">
				<div class="post-metadata">
					<div class="post-num">Post #73</div>
					<div class="post-author">Czo_</div>
					<div class="post-datetime">
						9 Mar 2015, 21:14					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I found a strange thing, with test in the first post. I have two clients, an iMac 27&quot; (named lightning, with a Broadcom a/b/g/n/ac card, but one of three antenna connector destroyed, so i think, it&#039;s only working with dual stream, ip: 172.16.30.1 and 192.168.200.2), and a linux box (named hurricane, with a PCI based 1000Mbps network card with maximal speed ~650Mbps, ip: 172.16.30.252 and 192.168.200.1).</p><p>OpenWRT version: CC r44620 (for long time use, i need to mirror every package, so anyone can use r44620:&nbsp; <a href="http://openwrt.czo.hu/">http://openwrt.czo.hu/</a> )</p><p>i ran the first test:<br /></p><div class="codebox"><pre><code>[root@hurricane ~]# iperf -c 192.168.200.2 -i 1 -w 6M -l 2M -p 6001
------------------------------------------------------------
Client connecting to 192.168.200.2, TCP port 6001
TCP window size:  416 KByte (WARNING: requested 6.00 MByte)
------------------------------------------------------------
[  3] local 192.168.200.1 port 37875 connected with 192.168.200.2 port 6001
[ ID] Interval       Transfer     Bandwidth
[  3]  0.0- 1.0 sec  34.0 MBytes   285 Mbits/sec
[  3]  1.0- 2.0 sec  32.0 MBytes   268 Mbits/sec
[  3]  2.0- 3.0 sec  32.0 MBytes   268 Mbits/sec
[  3]  3.0- 4.0 sec  32.0 MBytes   268 Mbits/sec
[  3]  4.0- 5.0 sec  32.0 MBytes   268 Mbits/sec
[  3]  5.0- 6.0 sec  30.0 MBytes   252 Mbits/sec
[  3]  6.0- 7.0 sec  8.00 MBytes  67.1 Mbits/sec
[  3]  7.0- 8.0 sec  6.00 MBytes  50.3 Mbits/sec
[  3]  8.0- 9.0 sec  8.00 MBytes  67.1 Mbits/sec
[  3]  9.0-10.0 sec  26.0 MBytes   218 Mbits/sec
[  3]  0.0-10.1 sec   242 MBytes   201 Mbits/sec</code></pre></div><p>When i remove -w and -l arguments, i get a bit better speed:<br /></p><div class="codebox"><pre><code>[root@hurricane ~]# iperf -c 192.168.200.2 -i 1 -p 6001
------------------------------------------------------------
Client connecting to 192.168.200.2, TCP port 6001
TCP window size: 85.0 KByte (default)
------------------------------------------------------------
[  3] local 192.168.200.1 port 37876 connected with 192.168.200.2 port 6001
[ ID] Interval       Transfer     Bandwidth
[  3]  0.0- 1.0 sec  56.2 MBytes   472 Mbits/sec
[  3]  1.0- 2.0 sec  64.2 MBytes   539 Mbits/sec
[  3]  2.0- 3.0 sec  65.4 MBytes   548 Mbits/sec
[  3]  3.0- 4.0 sec  63.4 MBytes   532 Mbits/sec
[  3]  4.0- 5.0 sec  62.9 MBytes   527 Mbits/sec
[  3]  5.0- 6.0 sec  59.8 MBytes   501 Mbits/sec
[  3]  6.0- 7.0 sec  57.5 MBytes   482 Mbits/sec
[  3]  7.0- 8.0 sec  57.9 MBytes   485 Mbits/sec
[  3]  8.0- 9.0 sec  61.8 MBytes   518 Mbits/sec
[  3]  9.0-10.0 sec  61.5 MBytes   516 Mbits/sec
[  3]  0.0-10.0 sec   611 MBytes   512 Mbits/sec</code></pre></div><p>but, when i test over LAN the two commands seems nearly identical:<br /></p><div class="codebox"><pre><code>[root@hurricane ~]# iperf -c 172.16.30.1 -i 1 -w 6M -l 2M -p 6001
------------------------------------------------------------
Client connecting to 172.16.30.1, TCP port 6001
TCP window size:  416 KByte (WARNING: requested 6.00 MByte)
------------------------------------------------------------
[  3] local 172.16.30.252 port 53861 connected with 172.16.30.1 port 6001
[ ID] Interval       Transfer     Bandwidth
[  3]  0.0- 1.0 sec  78.0 MBytes   654 Mbits/sec
[  3]  1.0- 2.0 sec  78.0 MBytes   654 Mbits/sec
[  3]  2.0- 3.0 sec  78.0 MBytes   654 Mbits/sec
[  3]  3.0- 4.0 sec  76.0 MBytes   638 Mbits/sec
[  3]  4.0- 5.0 sec  78.0 MBytes   654 Mbits/sec
[  3]  5.0- 6.0 sec  78.0 MBytes   654 Mbits/sec
[  3]  6.0- 7.0 sec  76.0 MBytes   638 Mbits/sec
[  3]  7.0- 8.0 sec  78.0 MBytes   654 Mbits/sec
[  3]  8.0- 9.0 sec  78.0 MBytes   654 Mbits/sec
[  3]  9.0-10.0 sec  78.0 MBytes   654 Mbits/sec
[  3]  0.0-10.1 sec   778 MBytes   649 Mbits/sec
[root@hurricane ~]# iperf -c 172.16.30.1 -i 1 -p 6001
------------------------------------------------------------
Client connecting to 172.16.30.1, TCP port 6001
TCP window size:  325 KByte (default)
------------------------------------------------------------
[  3] local 172.16.30.252 port 53862 connected with 172.16.30.1 port 6001
[ ID] Interval       Transfer     Bandwidth
[  3]  0.0- 1.0 sec  78.1 MBytes   655 Mbits/sec
[  3]  1.0- 2.0 sec  77.5 MBytes   650 Mbits/sec
[  3]  2.0- 3.0 sec  77.6 MBytes   651 Mbits/sec
[  3]  3.0- 4.0 sec  77.5 MBytes   650 Mbits/sec
[  3]  4.0- 5.0 sec  77.6 MBytes   651 Mbits/sec
[  3]  5.0- 6.0 sec  77.5 MBytes   650 Mbits/sec
[  3]  6.0- 7.0 sec  77.5 MBytes   650 Mbits/sec
[  3]  7.0- 8.0 sec  77.8 MBytes   652 Mbits/sec
[  3]  8.0- 9.0 sec  77.5 MBytes   650 Mbits/sec
[  3]  9.0-10.0 sec  77.8 MBytes   652 Mbits/sec
[  3]  0.0-10.0 sec   776 MBytes   651 Mbits/sec</code></pre></div><p>When running tests over WiFi, i see very high software interrupt usage in GNU top on the router. I can&#039;t test with OEM firmware, becuse i used OEM firmware only to upload OpenWRT. Next weekend i wan&#039;t to test with two LAN clients with separated VLAN that bridged together (like wifi to lan bridge), to see CPU usage when forwarding packets LAN to LAN.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p268324">
				<div class="post-metadata">
					<div class="post-num">Post #74</div>
					<div class="post-author">loyukfai</div>
					<div class="post-datetime">
						11 Mar 2015, 05:00					</div>
				</div>
				<div class="post-content content">
					<p>Related?</p><p><a href="http://www.spinics.net/lists/linux-wireless/msg133009.html">http://www.spinics.net/lists/linux-wire … 33009.html</a></p><p>Cheers.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p275530">
				<div class="post-metadata">
					<div class="post-num">Post #75</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						7 May 2015, 06:00					</div>
				</div>
				<div class="post-content content">
					<p>Anyone tried on the latest firmware supported on OpenWRT <strong>firmware-4.bin_10.2.4.48</strong>?</p><p>Trunk currently uses <strong>firmware-4.bin_10.2.4.45</strong> and iperf seemed to get really tangled on that version when used with my Note 4.&nbsp; It would display the results on the Note 4 but the transmitting machine would think it hadn&#039;t finished for 10 seconds or so later, displaying a much lower result.</p><p>Quite frankly, I&#039;m not sure if I trust iperf any more.&nbsp; Because iperf is showing slower performance than older firmware, but real-world performance feels much much improved.&nbsp; I just wish I had an 802.11ac adapter for PC but I sent the USB stick I had back as it was performing worse the 802.11n stick I have.</p><p>I suspect performance will still be iffy though as the SIRQ hits 80% when doing iperf to my Note 4 from a machine on the LAN and THAT is only reaching 350Mbit.&nbsp; I&#039;m certainly glad my Archer C7 is for WiFi only, it would kill the Internet performance.</p>									</div>
			</article>

			
		
						<div class="notice">
				<p>Sorry, posts 76 to 75 are missing from our archive.</p>
			</div>
		
		
	
	<div class="pagination"><div class="pagination-number">Page 3 of 9</div><nav><ul><li><a href="viewtopic.php%3Fid=53703&amp;p=1.html">1</a></li><li><a href="viewtopic.php%3Fid=53703&amp;p=2.html">2</a></li><li class="pagination-current"><span>3</span></li><li><a href="viewtopic.php%3Fid=53703&amp;p=4.html">4</a></li><li><a href="viewtopic.php%3Fid=53703&amp;p=5.html">5</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=53703&amp;p=9.html">9</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>