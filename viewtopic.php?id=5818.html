<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> wrtsl54gs: trapped in failsafe.</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 23 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p27675">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">ravenpi</div>
					<div class="post-datetime">
						23 May 2006, 02:02					</div>
				</div>
				<div class="post-content content">
					<p>Hey, all -- I tried to play around with my wrtsl54gs, and got things working reasonably well, but was having problems getting the wireless to act as a client.&nbsp; Anyway, I decided to flush my nvram with &quot;mtd -r erase nvram&quot;... but it doesn&#039;t appear to have worked.&nbsp; When it reboots, I can&#039;t talk to it -- and, yes, I&#039;ve flushed my ARP cache.&nbsp; ;-)&nbsp; I can sneak in a tftp during its bootloader phase, but it doesn&#039;t seem to have affected anything one way or the other.&nbsp; It does seem to query my DHCP server on both my LAN &amp; WAN ports (for a freaking SLEW of addresses), but ignores all the responses, leastwise, it doesn&#039;t take an address in the available range.&nbsp; I can bring it back up into failsafe mode... but where do I go from here?&nbsp; (And, as a side note, the link to <a href="http://openwrt.inf.fh-brs.de/~nbd/nvram-clean.sh">http://openwrt.inf.fh-brs.de/~nbd/nvram-clean.sh</a> in the FAQ times out.)</p><p>Thanks for any advice...</p><p>-Ken</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p27686">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">vincentfox</div>
					<div class="post-datetime">
						23 May 2006, 03:33					</div>
				</div>
				<div class="post-content content">
					<p>If you bring up in failsafe, what does nvram show give? Completely empty?</p><p>I suppose you could manually repopulate it.&nbsp; If that&#039;s the route you want to go, you undoubtedly do not need all of them. Mine&#039;s huge, like 800 variables. Trimming out the ones I think you probably don&#039;t need:</p><p>boardflags=0x0018<br />boardnum=42<br />boardrev=0x10<br />boardtype=0x042f<br />boot_ver=v3.5<br />boot_wait=on<br />clkfreq=264<br />lan_dhcp=0<br />lan_dns=<br />lan_domain=<br />lan_gateway=<br />lan_hwaddr=00:14:BF:EB:97:AE<br />lan_hwnames=<br />lan_ifname=br0<br />lan_ifnames=eth0 eth2 eth3 eth4<br />lan_ipaddr=10.69.1.1<br />lan_lease=86400<br />lan_netmask=255.255.255.0<br />lan_proto=static<br />lan_route=<br />lan_stp=0<br />lan_wins=<br />vlan0hwname=et0<br />vlan0ports=0 1 2 3 5u<br />vlan1hwname=et0<br />vlan1ports=4 5<br />wan_device=vlan1<br />wan_dns=<br />wan_domain=<br />wan_gateway=0.0.0.0<br />wan_gateway_buf=0.0.0.0<br />wan_get_dns=<br />wan_get_domain=<br />wan_hostname=wyo<br />wan_hwaddr=<br />wan_hwname=<br />wan_ifname=eth1<br />wan_ifnames=eth1<br />wan_ipaddr=0.0.0.0<br />wan_lease=86400<br />wan_mtu=1500<br />wan_netmask=0.0.0.0<br />wan_primary=1<br />wan_proto=dhcp<br />wan_speed=4<br />wan_unit=0<br />wan_wins=<br />wl0_active_mac=<br />wl0_afterburner=auto<br />wl0_akm=<br />wl0_antdiv=-1<br />wl0_ap_isolate=0<br />wl0_auth=0<br />wl0_auth_mode=none<br />wl0_bcn=100<br />wl0_channel=1<br />wl0_closed=0<br />wl0_corerev=9<br />wl0_country=Worldwide<br />wl0_country_code=ALL<br />wl0_crypto=tkip<br />wl0_dtim=1<br />wl0_frag=2346<br />wl0_frameburst=on<br />wl0_gmode=6<br />wl0_gmode_protection=off<br />wl0_hwaddr=00:14:BF:EB:97:B0<br />wl0_ifname=eth2<br />wl0_infra=1<br />wl0_key1=<br />wl0_key2=<br />wl0_key3=<br />wl0_key4=<br />wl0_key=1<br />wl0_lazywds=1<br />wl0_mac_deny=<br />wl0_mac_list=<br />wl0_maclist=<br />wl0_macmode1=disabled<br />wl0_macmode=disabled<br />wl0_maxassoc=128<br />wl0_mode=ap<br />wl0_mrate=0<br />wl0_net_mode=mixed<br />wl0_net_reauth=36000<br />wl0_passphrase=<br />wl0_phytype=g<br />wl0_phytypes=g<br />wl0_plcphdr=long<br />wl0_radio=0<br />wl0_radioids=BCM2050<br />wl0_radius_ipaddr=<br />wl0_radius_key=<br />wl0_radius_port=1812<br />wl0_rate=0<br />wl0_rateset=default<br />wl0_rts=2347<br />wl0_ssid=test<br />wl0_txant=3<br />wl0_unit=0<br />wl0_wds=00:16:b6:19:90:b7<br />wl0_wds_timeout=1<br />wl0_wep=disabled<br />wl0_wep_bit=64<br />wl0_wep_buf=<br />wl0_wep_gen=<br />wl0_wep_last=<br />wl0_wme=off<br />wl0_wme_ap_be=15 63 3 0 0 off<br />wl0_wme_ap_bk=15 1023 7 0 0 off<br />wl0_wme_ap_vi=7 15 1 6016 3008 off<br />wl0_wme_ap_vo=3 7 1 3264 1504 off<br />wl0_wme_no_ack=off<br />wl0_wme_sta_be=15 1023 3 0 0 off<br />wl0_wme_sta_bk=15 1023 7 0 0 off<br />wl0_wme_sta_vi=7 15 2 6016 3008 off<br />wl0_wme_sta_vo=3 7 2 3264 1504 off<br />wl0_wpa_gtk_rekey=3600<br />wl0_wpa_psk=<br />wl0gpio2=0<br />wl0gpio3=0<br />wl0id=0x4320</p><p>So you could try cut and paste that list adding in nvram at the front of each line, then commit and reboot.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p27843">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">ravenpi</div>
					<div class="post-datetime">
						25 May 2006, 17:45					</div>
				</div>
				<div class="post-content content">
					<p>Sorry for the delay; I was out-of-office for a while.&nbsp; On reboot to failsafe -- even after clearing the nvram -- it&#039;s got a bit of stuff.&nbsp; I pasted your stuff in (changing MAC and IP addresses to suit my box), and still: no dice.&nbsp; I simply can&#039;t figure out how to get it back to its initial settings.&nbsp; Any other suggestions?&nbsp; (Note: I&#039;m not actually complaining, here; I always work on the assumption that I&#039;d better be willing to brick anything that I&#039;m uploading firmware to.&nbsp; But jeepers, it&#039;s weird to have it only work in failsafe; I&#039;d figured &quot;mtd -r erase nvram&quot; would have set me back to square 1.&nbsp; But nooooooo...)</p><p>Thanks again,</p><p>-Ken</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p27844">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Duon</div>
					<div class="post-datetime">
						25 May 2006, 17:53					</div>
				</div>
				<div class="post-content content">
					<p>Well... the NVRAM is used for both failsafe and normal mode, pherhaps the failsafe implents the default settings at startup but doesn&#039;t commit them?&nbsp; I suppose you are using SquashFS?&nbsp; Maybe something on your JFFS2 is funked.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p27846">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">ravenpi</div>
					<div class="post-datetime">
						25 May 2006, 18:22					</div>
				</div>
				<div class="post-content content">
					<p>But if that were the case, wouldn&#039;t it be fixed by re-flashing?&nbsp; I&#039;ve done that a couple of times, to no (apparent) avail.&nbsp; Maybe something&#039;s just horked in my flash?&nbsp; Any way to test that?&nbsp; (For the record, I&#039;ve been flashing with openwrt-wrtsl54gs-squashfs.bin.)&nbsp; And for the hell of it, I rebooted to failsafe, and did an &quot;nvram commit&quot;, but it, too, didn&#039;t change anything.&nbsp; On boot (without trying for failsafe) I&#039;ll get a couple pings (probably the bootloader checking to see if there are any TFTP attempts), and then nothin&#039;.&nbsp; I&#039;ve cleared my ARP cache, I&#039;ve sniffed for traffic... nothing.</p><p>-Ken</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p27847">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Duon</div>
					<div class="post-datetime">
						25 May 2006, 18:29					</div>
				</div>
				<div class="post-content content">
					<p>I had some problems a while back that I was unable to solve... amazingly, I flased back to Sveasoft Alchemy and then BACK to OpenWrt, and now all is well.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p27849">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">ravenpi</div>
					<div class="post-datetime">
						25 May 2006, 18:40					</div>
				</div>
				<div class="post-content content">
					<p>Woo-hoo!&nbsp; I tftp&#039;d the Linksys firmware, and it came up in Linksys mode (which gave me hope), then I re-tftp&#039;d the openwrt, and it&#039;s back!&nbsp; Thanks for the suggestion!!!</p><p>-Ken</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p27850">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">Duon</div>
					<div class="post-datetime">
						25 May 2006, 18:43					</div>
				</div>
				<div class="post-content content">
					<p>Alright!&nbsp; Good stuff.&nbsp; Glad that worked for you. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>											<p class="post-edited">(Last edited by <strong>Duon</strong> on 1 Jul 2006, 16:01)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p27851">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">wbx</div>
					<div class="post-datetime">
						25 May 2006, 18:46					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>where I can buy a Linksys WRT54SLGS?</p><p>bye<br /> wbx</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p27852">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">ravenpi</div>
					<div class="post-datetime">
						25 May 2006, 18:49					</div>
				</div>
				<div class="post-content content">
					<p>I got mine at Best Buy; for some reason, they just aren&#039;t on many store shelves (yet?).&nbsp; CompUSA, Staples and Circuit City didn&#039;t have it.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>