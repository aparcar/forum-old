<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Bridge or Repeater but not both?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 6 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p23669">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">LSU_guy</div>
					<div class="post-datetime">
						26 Mar 2006, 20:41					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m using OpenWRT RC4. I&#039;m using the web interface for my configuration. I have a network scenario where I want to setup an OpenWRT as a bridge and repeater.</p><p>Scenario:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;W/PC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;W/PC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;W/PC<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ||&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;||&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ||<br />Router &lt;==&gt; AP1 &lt;==&gt; AP2 &lt;==&gt; AP3<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |&nbsp; &nbsp; |&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |&nbsp; &nbsp; |&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |&nbsp; &nbsp; |<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;PC&nbsp; PC&nbsp; &nbsp; &nbsp; PC&nbsp; PC&nbsp; &nbsp; &nbsp; PC&nbsp; &nbsp;PC</p><p>Definitions: <br />Repeater: Just transmit what it hears via RF to the next node<br />Bridge: Take RF and send it to the wired PCs and vice-versa<br />W/PC: Wireless PC<br />PC: Regular PC<br />AP[X]: The device that needs to act as a bridge and repeater.</p><p>I have referred to the following:<br /><a href="http://forum.openwrt.org/viewtopic.php?id=57">http://forum.openwrt.org/viewtopic.php?id=57</a><br /><a href="http://forum.openwrt.org/viewtopic.php?id=861">http://forum.openwrt.org/viewtopic.php?id=861</a><br /><a href="http://wiki.openwrt.org/Faq?action=show&amp;redirect=WDSBridgingHowto#head-406c1a12b7ce715f9c22f06b2d2a3304d9a260d8">http://wiki.openwrt.org/Faq?action=show â€¦ 04d9a260d8</a></p><p>Problem:<br />From what I could gather, it should be as simple as setting the MAC addresses of all the APs in all other APs/Router. Is this correct? When I do this, my W/PCs work and can see the network but my regular PCs cannot see the network. The do not get an IP address from the router.</p><p>So in my wireless settings, I put my APs into &quot;bridge mode&quot;. That makes me see the regular PCs but not the W/PCs. </p><p>Does anyone know what I should try?</p><p>All your help is very appreciated.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p23670">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">joebush</div>
					<div class="post-datetime">
						26 Mar 2006, 20:46					</div>
				</div>
				<div class="post-content content">
					<p>wl0_mode=ap and wl0_wds=&quot;XX:XX:XX:XX:XX:XX YY:YY:YY:YY:YY:YY&quot; should do the trick.</p><p>This is what my configuration currently looks like and I didn&#039;t have a problem getting this working. Just make sure you set wl0_channel the same on all the devices.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p23675">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">LSU_guy</div>
					<div class="post-datetime">
						26 Mar 2006, 21:15					</div>
				</div>
				<div class="post-content content">
					<p>Hmmmm...I do have it set to AP. Both the SSID and channels are the same in all devices. But when I do that, the regular PCs (Wired) dont work on the network. Maybe its a bridging problem of sorts?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p23676">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">joebush</div>
					<div class="post-datetime">
						26 Mar 2006, 21:28					</div>
				</div>
				<div class="post-content content">
					<p>Does that mean that wds is working?</p><p>If it were a bridging problem, it should have been a problem before activating wds.</p>											<p class="post-edited">(Last edited by <strong>joebush</strong> on 26 Mar 2006, 21:34)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p23677">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">LSU_guy</div>
					<div class="post-datetime">
						26 Mar 2006, 21:35					</div>
				</div>
				<div class="post-content content">
					<p>Yes I can get WDS to work with what you suggested. I can have wireless devices that works. However my wired devices dont work cant even get a DHCP address.</p><p>If it keep the WDS MAC addresses around and try to change the &quot;wireless mode&quot; to bridged, then my wired devices work and my wireless devices dont.</p><p>Please note, that this is all done through the web-interface.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p23680">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">joebush</div>
					<div class="post-datetime">
						26 Mar 2006, 22:13					</div>
				</div>
				<div class="post-content content">
					<p>Bridged mode will connect the WAN port to the rest of the bridge. So the Wireless and LAN should be bridged anyway. The LAN ports are configured as vlan0, and br0 is the combination of vlan0 with eth1 (wireless).</p><p>Access point mode is the mode you want for the configuration you mentioned. Log into the router and run &#039;brctl show&#039;. This will show you the bridge. The attached wds ap&#039;s should also appear as part of the same bridge.</p>											<p class="post-edited">(Last edited by <strong>joebush</strong> on 26 Mar 2006, 22:18)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p23708">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">LSU_guy</div>
					<div class="post-datetime">
						27 Mar 2006, 07:32					</div>
				</div>
				<div class="post-content content">
					<p>I will try it and repost on how it goes.</p><p>Thanks for all your help and insight joe.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p23716">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">joebush</div>
					<div class="post-datetime">
						27 Mar 2006, 10:23					</div>
				</div>
				<div class="post-content content">
					<p>I just thought I&#039;d add that I noticed with either the original or oleg firmware there were different modes. Hybrid is what they called the mode (in the web interface) that bridged access points together AND allowed client access to them. It would be interesting to know exactly what parameters vary between the different settings. This may be where the problem lies as well.</p><p>Either way, your best bet is using the shell to configure your unit. It may take a little getting used to, but gives you much more control when configuring. Hope you get it working properly.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p23718">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">mbm</div>
					<div class="post-datetime">
						27 Mar 2006, 10:41					</div>
				</div>
				<div class="post-content content">
					<p>Huh? You can already do that, exactly as already posted.</p><p>Configure each as an AP, same channel and same encryption on all devices (I&#039;d also suggest you set the same ssid so you can roam, but that&#039;s not a requirement). Now, set wl0_wds on each device to a (space separated) list of the other BSSIDs (fancy term for the wifi mac). Restart wireless on each device (run /sbin/wifi or reboot).</p><p>Each wds link will create a new (point to point) wds0.x interface on the device, which will be added to br0. Since br0 is also the default for the wireless/wired lan bridge, you&#039;ll end up with a completely bridged network across multiple devices. Wifi will be basically a repeater, and the wired ethernet ports will be transparently bridged over the wds link.</p><p>....</p><p>Advanced topics -</p><p>The wds link is always added to br0, it&#039;s hardcoded into the hotplug script. You don&#039;t need to use br0 for the lan bridge; you can move that to br1 and have a br0 network of your wds links.</p><p>Further, if you&#039;re using wpa, you can have the different settings for wds vs clients. For example, you can have a different passphrase and higher security for the wds links than client connections. It&#039;s all done through a few wds overrides: wl0_wds_crypto wl0_wds_akm, wl0_wds_auth_mode, wl0_wds_ssid, wl0_wds_wpa_gtk_rekey (they&#039;re configured the same as their non wds equivilants)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p23958">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">LSU_guy</div>
					<div class="post-datetime">
						30 Mar 2006, 03:04					</div>
				</div>
				<div class="post-content content">
					<p>I think my issue was the same issue that Olli solved. </p><p><a href="http://forum.openwrt.org/viewtopic.php?id=3945">http://forum.openwrt.org/viewtopic.php?id=3945</a></p><p>Changing it to WDS with WPA (AES) seems to work.</p>											<p class="post-edited">(Last edited by <strong>LSU_guy</strong> on 30 Mar 2006, 04:14)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p23961">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">mbm</div>
					<div class="post-datetime">
						30 Mar 2006, 03:56					</div>
				</div>
				<div class="post-content content">
					<p>You&#039;ve created a network loop:<br /></p><div class="codebox"><pre><code>  A
 / \
B---C</code></pre></div><p>And your network is being killed by each node recieving a packet and broadcasting it out to all the other nodes.</p><p>If you insist on that network structure, turn on spanning tree for all the bridge interfaces.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p23962">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">LSU_guy</div>
					<div class="post-datetime">
						30 Mar 2006, 04:17					</div>
				</div>
				<div class="post-content content">
					<p>mbm thanks for all your help (you guys are great). My issue was resolved by reading the post Olli had made on </p><p><a href="http://forum.openwrt.org/viewtopic.php?id=3945">http://forum.openwrt.org/viewtopic.php?id=3945</a>.</p><p>It wasn&#039;t a spanning tree problem. I have STP on. The problem was related to RC4, WDS and WPA (TKIP). Changing it to WPA (AES) solved the problem.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>