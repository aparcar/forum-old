<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Let&#039;s Get More,Make WR703 With 16M Flash</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 6 Feb 2018 and 22 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 2 of 3</div><nav><ul><li><a href="viewtopic.php%3Fid=41449&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li><li><a href="viewtopic.php%3Fid=41449&amp;p=3.html">3</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p210016">
				<div class="post-metadata">
					<div class="post-num">Post #26</div>
					<div class="post-author">pepe2k</div>
					<div class="post-datetime">
						17 Aug 2013, 16:31					</div>
				</div>
				<div class="post-content content">
					<p>You have forgotten to dump and restore second 64 KiB block from original flash.<br />It contains MAC address and model number (which is also important).</p><p>My U-Boot modification size for this model is 64 KiB, but u-boot partition in OFW and in OpenWrt is 128 KiB, as you may noticed with &quot;cat /proc/mtd&quot;.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p210033">
				<div class="post-metadata">
					<div class="post-num">Post #27</div>
					<div class="post-author">sSpeaker</div>
					<div class="post-datetime">
						17 Aug 2013, 19:52					</div>
				</div>
				<div class="post-content content">
					<p>How can i do that from existing dump?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p210047">
				<div class="post-metadata">
					<div class="post-num">Post #28</div>
					<div class="post-author">pepe2k</div>
					<div class="post-datetime">
						18 Aug 2013, 00:40					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>sSpeaker wrote:</cite><blockquote><p>How can i do that from existing dump?</p></blockquote></div><p>Use any HEX editor and extract 64 KiB from address 0x10000 to 0x1FFF0 (exactly 64 KiB = 0x10000).<br />Then, using tftpboot command in U-Boot download prepared file and put it on offset 0x9F010000, for example:</p><div class="codebox"><pre><code>tftpboot 0x80080000 mac.bin
[...]
erase 0x9F010000 +0x10000
cp.b 0x80080000 0x9F010000 0x10000</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p210061">
				<div class="post-metadata">
					<div class="post-num">Post #29</div>
					<div class="post-author">sSpeaker</div>
					<div class="post-datetime">
						18 Aug 2013, 08:54					</div>
				</div>
				<div class="post-content content">
					<p>Thanks. Now printmodel show correct version.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p211555">
				<div class="post-metadata">
					<div class="post-num">Post #30</div>
					<div class="post-author">TheFonRanger</div>
					<div class="post-datetime">
						4 Sep 2013, 06:58					</div>
				</div>
				<div class="post-content content">
					<p>Hi Folks,</p><p>I am really confused after reading all of this. I want to modify one of my wr703n units to gain more storage space for baked in packages. It&#039;s no problem for me to cook an image, and I know how to make sysupgrade images 8 megs or whatever size I want, but beyond that I think I may have read way too much, because I am just lost and totally beyond confused now. 16 megs might be too much, I just need to be able to fit openvpn, luci and rt2800usb images on flash. Anything after that is just gravy.</p><p>I was not planning on messing with RAM at the moment, mostly because I doubt my soldering abilities with that many pins. I can backup all parts of the flash, ART and whatever, no issue. </p><p>So do I need to flash a custom uboot just to increase the flash capacity? How do you assemble the final flash image that you are going to burn with a programmer? I only have access to whatever I can run on Linux, I have no Windows license and I would rather not mess with that.</p><p>SLboat and the rest of you folks make this look so easy <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> I&#039;d like to make a writeup once I really get a grasp on what I have to do. Good news is that I haven&#039;t bought anything other than a bunch of routers... I plan on buying SLboat&#039;s programmer and some chips if I can ever get this figured out...</p><p>Thanks for any assistance you can offer.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p211563">
				<div class="post-metadata">
					<div class="post-num">Post #31</div>
					<div class="post-author">rambler</div>
					<div class="post-datetime">
						4 Sep 2013, 10:44					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>TheFonRanger wrote:</cite><blockquote><p>So do I need to flash a custom uboot just to increase the flash capacity?</p></blockquote></div><p>You don’t have to, as the OpenWRT kernel will recognize it by itself. However, stock uboot cannot reach beyond 4MiB, so unless you modify it, you loose the ability to recover the flash from uboot console. For an alternative uboot, take a look here: <a href="https://forum.openwrt.org/viewtopic.php?id=43237">https://forum.openwrt.org/viewtopic.php?id=43237</a></p><div class="quotebox"><blockquote><p>How do you assemble the final flash image that you are going to burn with a programmer?</p></blockquote></div><p>A complete flash image would look like that,</p><p>for stock firmware:<br />64KiB uboot + 64KiB data (PIN&amp;MAC) + 3.75MiB kernel&amp;fs + 64KiB config + 64KiB ART, exactly 4MiB in total; data &amp; ART blocks are from backups of <strong>that same router</strong>;</p><p>for OpenWRT:<br />64KiB uboot + 64KiB data (PIN&amp;MAC) + kernel&amp;fs + empty space as needed + 64KiB ART <strong>at the end of flash</strong>, in total the size of your flash. The maximum size of kernel&amp;fs is the size or your flash, less 128KiB uboot+data, less 64KiB ART. Data &amp; ART blocks are from backups of <strong>that same router</strong>.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p212079">
				<div class="post-metadata">
					<div class="post-num">Post #32</div>
					<div class="post-author">vdat_bg</div>
					<div class="post-datetime">
						11 Sep 2013, 11:56					</div>
				</div>
				<div class="post-content content">
					<p>Hello,<br />I want to mod my router wr703N too<br />Can you send to me full image for 16mB only to flash with programmer before soldering?</p><p>Thank You!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p212123">
				<div class="post-metadata">
					<div class="post-num">Post #33</div>
					<div class="post-author">rambler</div>
					<div class="post-datetime">
						11 Sep 2013, 21:40					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>vdat_bg wrote:</cite><blockquote><p>Hello,<br />I want to mod my router wr703N too<br />Can you send to me full image for 16mB only to flash with programmer before soldering?</p><p>Thank You!</p></blockquote></div><p>Please understand that the image <strong>must</strong> contain parts from your original flash ROM. Specifically, the data and ART blocks. The latter is most critical.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p213070">
				<div class="post-metadata">
					<div class="post-num">Post #34</div>
					<div class="post-author">vdat_bg</div>
					<div class="post-datetime">
						24 Sep 2013, 14:21					</div>
				</div>
				<div class="post-content content">
					<p>Hello Rambler,<br />Thanks for Answer.<br />I know that I must replace last 64kB Art partition of flash with original. </p><p>But I need modified uboot and file system.</p><p>Can&nbsp; You can provide to me a bin file where to replace my art partition?</p><p>Thank in advance</p><p>Vasil Atanasov</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p213097">
				<div class="post-metadata">
					<div class="post-num">Post #35</div>
					<div class="post-author">rambler</div>
					<div class="post-datetime">
						24 Sep 2013, 19:49					</div>
				</div>
				<div class="post-content content">
					<p>You need to replace the last 64KiB with “art” block (contains radio calibration data), AND you need to replace the second 64KiB with the corresponding data block of the original flash (it contains MAC address, device identification code, and PIN if applicable).</p><p>You should be able to assemble flash image yourself.</p><p>The parts you need:</p><p>&nbsp; &nbsp; 1. U-boot. That’s the first 64KiB block of the original flash, or an alternative <a href="https://forum.openwrt.org/viewtopic.php?pid=197331">uboot from pepe2k</a>, namely uboot_for_tp-link_tl-wr703n.bin from <a href="https://github.com/pepe2k/u-boot_mod/releases/download/2013-08-19/U-Boot_1.1.4_modification_for_routers_2013-08-19.tar.gz">here</a>. Whichever you choose, I’ll call it uboot.bin in the following (exactly 65536 bytes).<br />&nbsp; &nbsp; 2. The second 64KiB block of the original flash. I’ll call it data.bin in the following.<br />&nbsp; &nbsp; 3. OpenWRT Attitude Adjustment image for your device, get it <a href="http://downloads.openwrt.org/attitude_adjustment/12.09/ar71xx/generic/openwrt-ar71xx-generic-tl-wr703n-v1-squashfs-factory.bin">here</a>. I shall call it factory.bin in the following.<br />&nbsp; &nbsp; 4. Optionally, create a file empty.bin which is 12648448 bytes in size and contains FF’s (actually, it may contain anything, it shouldn’t matter).<br />&nbsp; &nbsp; 5. The last 64KiB of the original flash, I’ll call it art.bin in the following.</p><p>Now, combine the parts into the final image.bin. On Windows, it would be</p><div class="codebox"><pre><code>copy /b uboot.bin+data.bin+factory.bin+empty.bin+art.bin image.bin</code></pre></div><p> (On linux, you do it similarly with the “cat” command.) The resulting image.bin should be exactly 16MiB, the size of your flash.</p><p>Alternatively, use your hex editor to create an empty image.bin with the size of 16MiB (16777216 bytes), then paste into it (overwrite bytes, NOT insert)<br />&nbsp; &nbsp; 1. uboot.bin at file offset 0;<br />&nbsp; &nbsp; 2. data.bin at 0x10000;<br />&nbsp; &nbsp; 3. factory.bin at 0x20000;<br />&nbsp; &nbsp; 4. art.bin at 0xFF0000.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p213712">
				<div class="post-metadata">
					<div class="post-num">Post #36</div>
					<div class="post-author">vdat_bg</div>
					<div class="post-datetime">
						2 Oct 2013, 16:27					</div>
				</div>
				<div class="post-content content">
					<p>Hello Rambler,<br />Thanks for detailed description of making bin file. <br />Today I tested the device with new flash and it works fine.</p><br /><p>Best regards,<br />Vasil Atanasov</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p226784">
				<div class="post-metadata">
					<div class="post-num">Post #37</div>
					<div class="post-author">eeff11</div>
					<div class="post-datetime">
						4 Mar 2014, 14:41					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>xopal wrote:</cite><blockquote><div class="quotebox"><cite>alphasparc wrote:</cite><blockquote><p>Hi guys can you explain how to move the art partition and expand the filesystem to fill the larger flash chip?<br />I wish to upgrade my TP-link WDR4300 from 8MB of flash to 64MB so I can install owncloud on it (Don&#039;t reallly like extroot).<br />Also where can I get a cheap reliable external flash programmer preferably on ebay or other reliable sources that uses paypal.<br />Thanks</p></blockquote></div><p><strong>Art partition for 16MB Flash :</strong> </p><p>16MB total size in hex = 1000000</p><p>64kb art partition size in hex = 10000</p><p>Art partition hex address = 1000000 - 10000 = FF0000</p><br /><p><strong>Art partition for 64MB Flash :</strong></p><p>64MB total size in hex = 4000000</p><p>64kb art partition size in hex = 10000</p><p>Art partition hex address = 4000000 - 10000 = 3FF0000</p><p>Of course you need to modify u-boot environment to 64MB&nbsp; this is critical if you work with uboot command.</p><p>For openwrt firmware I can confirm you, openwrt will automatically detect the flash size IF your flash ID is on his list , so you don&#039;t need to compile openwrt with certain template size.</p><p>But you can compile openwrt with <strong>64MB template</strong> and put all your packages in it as much as flash chip can handle it.<br />Nice when you issuing the command <strong>&quot;fistboot&quot;</strong>, you don&#039;t need to install a bunch of your packages list.</p></blockquote></div><p>Anyone did 64MB flash? which model?IT&#039;s hard to get 128MB of DDR I RAM, 64MBx16.I think no way to support 256MB RAM, seems no such sops 66 single chip of 256MB RAM.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p244143">
				<div class="post-metadata">
					<div class="post-num">Post #38</div>
					<div class="post-author">shatterstar78</div>
					<div class="post-datetime">
						18 Aug 2014, 19:01					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>rambler wrote:</cite><blockquote><p>You need to replace the last 64KiB with “art” block (contains radio calibration data), AND you need to replace the second 64KiB with the corresponding data block of the original flash (it contains MAC address, device identification code, and PIN if applicable).</p><p>You should be able to assemble flash image yourself.</p><p>The parts you need:</p><p>&nbsp; &nbsp; 1. U-boot. That’s the first 64KiB block of the original flash, or an alternative <a href="https://forum.openwrt.org/viewtopic.php?pid=197331">uboot from pepe2k</a>, namely uboot_for_tp-link_tl-wr703n.bin from <a href="https://github.com/pepe2k/u-boot_mod/releases/download/2013-08-19/U-Boot_1.1.4_modification_for_routers_2013-08-19.tar.gz">here</a>. Whichever you choose, I’ll call it uboot.bin in the following (exactly 65536 bytes).<br />&nbsp; &nbsp; 2. The second 64KiB block of the original flash. I’ll call it data.bin in the following.<br />&nbsp; &nbsp; 3. OpenWRT Attitude Adjustment image for your device, get it <a href="http://downloads.openwrt.org/attitude_adjustment/12.09/ar71xx/generic/openwrt-ar71xx-generic-tl-wr703n-v1-squashfs-factory.bin">here</a>. I shall call it factory.bin in the following.<br />&nbsp; &nbsp; 4. Optionally, create a file empty.bin which is 12648448 bytes in size and contains FF’s (actually, it may contain anything, it shouldn’t matter).<br />&nbsp; &nbsp; 5. The last 64KiB of the original flash, I’ll call it art.bin in the following.</p><p>Now, combine the parts into the final image.bin. On Windows, it would be</p><div class="codebox"><pre><code>copy /b uboot.bin+data.bin+factory.bin+empty.bin+art.bin image.bin</code></pre></div><p> (On linux, you do it similarly with the “cat” command.) The resulting image.bin should be exactly 16MiB, the size of your flash.</p><p>Alternatively, use your hex editor to create an empty image.bin with the size of 16MiB (16777216 bytes), then paste into it (overwrite bytes, NOT insert)<br />&nbsp; &nbsp; 1. uboot.bin at file offset 0;<br />&nbsp; &nbsp; 2. data.bin at 0x10000;<br />&nbsp; &nbsp; 3. factory.bin at 0x20000;<br />&nbsp; &nbsp; 4. art.bin at 0xFF0000.</p></blockquote></div><p>Hi, first of all I&#039;m completely new to all of this, so please excuse the stupid questions. I&#039;m planing on doing the 16MByte Flash upgrade witch i got from SLboat. I have what I need to flash the chip, but how do i dump what I need from original flash?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p244375">
				<div class="post-metadata">
					<div class="post-num">Post #39</div>
					<div class="post-author">rambler</div>
					<div class="post-datetime">
						20 Aug 2014, 17:48					</div>
				</div>
				<div class="post-content content">
					<p>Directory /dev/ contains pseudo-files that represent flash partitions (see <a href="http://wiki.openwrt.org/doc/techref/flash.layout">http://wiki.openwrt.org/doc/techref/flash.layout</a>). In particular (assuming you have OpenWRT on the router), /dev/mtd0 is uboot+data (128 KiB), /dev/mtd4 is ART (64 KiB). To backup them (again assuming you run OpenWRT), first login to the router with SSH and make copies of these partitions in RAM, such as<br /></p><div class="codebox"><pre><code>cat /dev/mtd0 &gt; /tmp/mtd0.bin
cat /dev/mtd4 &gt; /tmp/mtd4.bin</code></pre></div><p>and then get them from /tmp to your PC with a SCP client.</p><p>Otherwise, once you&#039;ve de-soldered the flash, and hopefully not killed it, you should be able to read its contents with your flash programmer.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p245039">
				<div class="post-metadata">
					<div class="post-num">Post #40</div>
					<div class="post-author">hoatienii</div>
					<div class="post-datetime">
						27 Aug 2014, 07:30					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>slboat wrote:</cite><blockquote><p><span class="postimg"><img src="http://see.sl088.com/w/images/e/e4/Slboat_eos_4245.JPG" alt="http://see.sl088.com/w/images/e/e4/Slboat_eos_4245.JPG" /></span></p></blockquote></div><p>could you tell me the name of this</p>											<p class="post-edited">(Last edited by <strong>hoatienii</strong> on 27 Aug 2014, 07:30)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p245329">
				<div class="post-metadata">
					<div class="post-num">Post #41</div>
					<div class="post-author">hoatienii</div>
					<div class="post-datetime">
						29 Aug 2014, 17:57					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>hoatienii wrote:</cite><blockquote><div class="quotebox"><cite>slboat wrote:</cite><blockquote><p><span class="postimg"><img src="http://see.sl088.com/w/images/e/e4/Slboat_eos_4245.JPG" alt="http://see.sl088.com/w/images/e/e4/Slboat_eos_4245.JPG" /></span></p></blockquote></div><p>could you tell me the name of this</p></blockquote></div><p>And please tell me pinout of 16 to 8 adapter. Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p245375">
				<div class="post-metadata">
					<div class="post-num">Post #42</div>
					<div class="post-author">hoatienii</div>
					<div class="post-datetime">
						30 Aug 2014, 06:15					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>cindy.wijaya wrote:</cite><blockquote><div class="quotebox"><cite>alphasparc wrote:</cite><blockquote><p>Do you know if there is anyway we can solder in a socket instead of the SMT Flash so we can make it removable like the BIOS chip in a motherboard?</p></blockquote></div><p>I make it dualboot rom with very cheap tools less than $1</p><p>[spoiler=&quot;cheap rom programmer&quot;]<span class="postimg"><img src="http://img837.imageshack.us/img837/5536/rscn0071.jpg" alt="http://img837.imageshack.us/img837/5536/rscn0071.jpg" /></span>[/spoiler]<br />[spoiler=&quot;cheap rom programmer&quot;]<span class="postimg"><img src="http://img12.imageshack.us/img12/3456/dscn0045uz.jpg" alt="http://img12.imageshack.us/img12/3456/dscn0045uz.jpg" /></span>[/spoiler]<br />[spoiler=&quot;cheap rom programmer&quot;]<span class="postimg"><img src="http://img822.imageshack.us/img822/9769/dscn0057ep.jpg" alt="http://img822.imageshack.us/img822/9769/dscn0057ep.jpg" /></span>[/spoiler]<br />[spoiler=&quot;cheap rom programmer&quot;]<span class="postimg"><img src="http://img703.imageshack.us/img703/6122/dscn0059i.jpg" alt="http://img703.imageshack.us/img703/6122/dscn0059i.jpg" /></span>[/spoiler]<br />[spoiler=&quot;cheap rom programmer&quot;]<span class="postimg"><img src="http://img201.imageshack.us/img201/5589/rscn0050.jpg" alt="http://img201.imageshack.us/img201/5589/rscn0050.jpg" /></span>[/spoiler]<br />[spoiler=&quot;cheap rom programmer&quot;]<span class="postimg"><img src="http://img706.imageshack.us/img706/3924/rscn0058.jpg" alt="http://img706.imageshack.us/img706/3924/rscn0058.jpg" /></span>[/spoiler]<br />[spoiler=&quot;cheap rom programmer&quot;]<span class="postimg"><img src="http://img819.imageshack.us/img819/7461/rscn0060.jpg" alt="http://img819.imageshack.us/img819/7461/rscn0060.jpg" /></span>[/spoiler]</p><br /><p>i create a little tool to automatic flash but i haven&#039;t write full instruction yet <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /><br />[youtube]<a href="http://www.youtube.com/watch?feature=player_embedded&amp;v=A1hKTlWtBoY">http://www.youtube.com/watch?feature=pl … 1hKTlWtBoY</a>[/youtube]<br /><a href="http://openwrt.agromapia.com/software/oWRHeX.exe">http://openwrt.agromapia.com/software/oWRHeX.exe</a></p></blockquote></div><p>please give me, schematic sop16 to sop8. thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p245439">
				<div class="post-metadata">
					<div class="post-num">Post #43</div>
					<div class="post-author">anonym00se</div>
					<div class="post-datetime">
						31 Aug 2014, 03:34					</div>
				</div>
				<div class="post-content content">
					<p>hi all-</p><p>A h/w question for slboat or others; has anyone done the RAM or flash mod on similar TP-Link models such as the MR3040?&nbsp; It would be even better to get a router with the WR703&#039;s capability plus built-in Li-on battery pack to run completely standalone.</p>											<p class="post-edited">(Last edited by <strong>anonym00se</strong> on 31 Aug 2014, 03:35)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p248746">
				<div class="post-metadata">
					<div class="post-num">Post #44</div>
					<div class="post-author">zelea2</div>
					<div class="post-datetime">
						2 Oct 2014, 03:15					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve tried to upgrade the flash on my WR703N but for some unknown reason it doesn&#039;t work. I have a recent version of this router and I wanted to upgrade the flash and put OpenWRT on it.<br />This is what I&#039;ve got from the chinese gibberish page:<br />S-Ver=3.17.1 Build 140120 Rel.56593n<br />The version is consistent with the flash dump: 0x001FD00: 07 03 01 01 00 00 00 01</p><p>I&#039;ve got the new u-boot from here: <a href="https://github.com/pepe2k/u-boot_mod">https://github.com/pepe2k/u-boot_mod</a><br />I&#039;ve downloaded my cross-compiler packages<br /></p><div class="codebox"><pre><code>ii  binutils-mips-linux-gnu                2.24.51.20140903-1                              
ii  cpp-4.4-mips-linux-gnu                4.4.5-8
ii  gcc-4.4-base-mips-cross              4.4.5-8                                          
ii  gcc-4.4-mips-linux-gnu                 4.4.5-8
ii  gcc-4.4-mips-linux-gnu-base        4.4.5-8                                          
ii  libc-bin-mips-cross                        2.11.2-10
ii  libc-dev-bin-mips-cross                 2.11.2-10                                        
ii  libc6-dev-mips-cross                     2.11.2-10
ii  libc6-mips-cross                        2.11.2-10                                        
ii  libgcc1-mips-cross                        1:4.4.5-8
ii  libgomp1-mips-cross                    4.4.5-8                                          
ii  linux-libc-dev-mips-cross              2.6.32-30</code></pre></div><p>Then I&#039;ve issued&nbsp; &#039;make tplink_wr703n&#039;<br />Apart from a few warnings like: </p><ul><li><p>Warning: .gnu_attribute 4,3 requires `softfloat&#039;&nbsp; </p></li><li><p>Warning: u-boot uses -mhard-float (set by cpu/mips/start.o), common/libcommon.a(exports.o) uses -msoft-float</p></li></ul><p> everything went fine.<br /></p><div class="codebox"><pre><code>&gt; Preparing compressed U-Boot image &quot;u-boot.lzimg&quot;...
    Image Name: u-boot image
        Created: Thu Oct  2 00:41:51 2014
    Image Type: MIPS Linux Firmware (lzma compressed)
     Data Size: 47242 Bytes = 46.13 kB = 0.05 MB
  Load Address: 0x80010000
   Entry Point: 0x80010000
&gt; Preparing 64KB file filled with 0xFF...
&gt; Copying U-Boot image...
&gt; U-Boot image ready, size: 65536 bytes</code></pre></div><p>I haven&#039;t changed the DEFAULT_FLASH_SIZE_IN_MB because I&#039;m using a supported Winbond 25Q128FV chip which is automatically detected.<br />I&#039;ve then combined the&nbsp; uboot_for_tp-link_tl-wr703n.bin with the data and art areas from the original chip dump (as instructed by the wiki with the art at the end of the image) and flashed it into my new chip with an external programmer. After soldering the chip in place I can&#039;t get any reply from 192.168.1.1 (ICMP or UDP). I&#039;ve tried keeping the reset pressed for various amounts of seconds with no result.</p><p>Also worth mentioning is that the blue LED only stays lit for half a second after each power up.<br />Any ideas what I&#039;ve done wrong?<br />Should I try a precompiled u-boot like this one original_u-boot_images/tp-link_wr703n_v1_120228.bin instead?</p>											<p class="post-edited">(Last edited by <strong>zelea2</strong> on 2 Oct 2014, 04:59)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p249045">
				<div class="post-metadata">
					<div class="post-num">Post #45</div>
					<div class="post-author">MBS</div>
					<div class="post-datetime">
						3 Oct 2014, 21:19					</div>
				</div>
				<div class="post-content content">
					<p>Best would be to check the serial output now.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p249127">
				<div class="post-metadata">
					<div class="post-num">Post #46</div>
					<div class="post-author">xciton</div>
					<div class="post-datetime">
						4 Oct 2014, 16:14					</div>
				</div>
				<div class="post-content content">
					<p>You don&#039;t need to compile from source.</p><p>To eliminate a source of possible error that you&#039;re having, you can download his pre-compiled binaries at <a href="http://www.tech-blog.pl/pliki/u-boot_for_tp-link_AR9331_by_pepe2k.tar.gz">http://www.tech-blog.pl/pliki/u-boot_fo … e2k.tar.gz</a> .&nbsp; I&#039;ve used it successfully on my 3020&#039;s and 703N&#039;s.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p249139">
				<div class="post-metadata">
					<div class="post-num">Post #47</div>
					<div class="post-author">zelea2</div>
					<div class="post-datetime">
						4 Oct 2014, 17:44					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>xciton wrote:</cite><blockquote><p>To eliminate a source of possible error that you&#039;re having, you can download his pre-compiled binaries at <a href="http://www.tech-blog.pl/pliki/u-boot_for_tp-link_AR9331_by_pepe2k.tar.gz">http://www.tech-blog.pl/pliki/u-boot_fo … e2k.tar.gz</a> .&nbsp; I&#039;ve used it successfully on my 3020&#039;s and 703N&#039;s.</p></blockquote></div><p>That&#039;s what I&#039;ve used in the end. The binaries seems a litle bit out of date (they are more that a year old) but at least they work.<br />I now have 16MB of flash and 64MB of RAM in all my three WR703N (various versions).</p><p>This means there is a problem with the default MIPS chain tools from debian unstable (if there is no bug in the current git image).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259667">
				<div class="post-metadata">
					<div class="post-num">Post #48</div>
					<div class="post-author">slboat</div>
					<div class="post-datetime">
						3 Jan 2015, 12:40					</div>
				</div>
				<div class="post-content content">
					<p>with a little upgrade,now it support bb version very well<br /><span class="postimg"><img src="http://see.sl088.com/w/images/d/d1/SLboat-Mac-Screen_2014-11-02_7.00.22.jpg" alt="http://see.sl088.com/w/images/d/d1/SLboat-Mac-Screen_2014-11-02_7.00.22.jpg" /></span></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p273342">
				<div class="post-metadata">
					<div class="post-num">Post #49</div>
					<div class="post-author">hryamzik</div>
					<div class="post-datetime">
						21 Apr 2015, 23:42					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m trying to replace 2MB flash in a 702n router with 8MB chip. So I&#039;ve done the following:</p><p>1. Cloned <a href="https://github.com/pepe2k/u-boot_mod.git,">https://github.com/pepe2k/u-boot_mod.git,</a> modified the makefile to work with openwrt toolchain, compiled uboot for wr703n, here&#039;s the md5:<br /></p><div class="codebox"><pre><code> 3eeecc9c1a2654e00aee6876f0dc23ed *uboot_for_tp-link_tl-wr703n.bin</code></pre></div><p>2. Dumped original image with an SPI programmer.<br />3. Extracted code from 2MB chip by partitions mentioned in this topic:<br /></p><div class="codebox"><pre><code>dd bs=1 skip=0             count=$((64*1024))            if=702n.bin of=702.orig/uboot.bin
dd bs=1 skip=$((64*1024))  count=$((64*1024))            if=702n.bin of=702.orig/data.bin
dd bs=1 skip=$((128*1024)) count=$(((2*1024-64*3)*1024)) if=702n.bin of=702.orig/factory.bin
dd bs=1 skip=$(((2*1024-64)*1024))                       if=702n.bin of=702.orig/art.bin</code></pre></div><p>4. Filled 8MB image with new uboot, original data, factory and art partitions:<br /></p><div class="codebox"><pre><code>dd                            of=702n8m.bin if=uboot/uboot_for_tp-link_tl-wr703n.bin
dd seek=$((64*1024))          of=702n8m.bin if=702.orig/data.bin
dd seek=$((128*1024))         of=702n8m.bin if=702.orig/factory.bin
dd seek=$(((8*1024-64)*1024)) of=702n8m.bin if=702.orig/art.bin</code></pre></div><p>5. Flashed this image to a 8MB chip, soldered it...</p><p>And it doesn&#039;t work. The green LED (the one that&#039;s blue on 703) works at half brightness, network interface doesn&#039;t go up. If I solder original chip back it works.</p><p>So I have two questions at this point:<br />1. What am I missing, what am I doing wrong?<br />2. How to debug this?</p>											<p class="post-edited">(Last edited by <strong>hryamzik</strong> on 21 Apr 2015, 23:45)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p274985">
				<div class="post-metadata">
					<div class="post-num">Post #50</div>
					<div class="post-author">jagspaul</div>
					<div class="post-datetime">
						3 May 2015, 15:47					</div>
				</div>
				<div class="post-content content">
					<p>You have to check u-boot log.<br />To do this first you have to make your router serial port mod.<br />Then connect with a USB serial (TTL)<br />open a terminal (minicom/putty) and set Baud rate: 115200, 8 bit data, 1 stop bit, flow control none.<br />then power up the router and see u-boot log.</p><p>You can make a try with your original u-boot instead modified one.</p><p>dd&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; of=702n8m.bin if=702.orig/uboot.bin</p><p>/jags</p>											<p class="post-edited">(Last edited by <strong>jagspaul</strong> on 3 May 2015, 21:24)</p>
									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 2 of 3</div><nav><ul><li><a href="viewtopic.php%3Fid=41449&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li><li><a href="viewtopic.php%3Fid=41449&amp;p=3.html">3</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>