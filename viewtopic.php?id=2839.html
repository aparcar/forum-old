<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Package added: fdisk</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 4 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p13372">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Nico</div>
					<div class="post-datetime">
						7 Oct 2005, 23:38					</div>
				</div>
				<div class="post-content content">
					<p>A new package, <a href="http://openwrt.org/downloads/people/nico/man/man8/fdisk.8.html">fdisk</a> from util-linux, is available for testing. You can find it in my <a href="http://openwrt.org/downloads/people/nico/testing/mipsel/packages/">testing</a> repository.</p><p>Thanks to Philipp Kewisch for his contribution.</p><p>Only the fdisk utility is packaged at this time, not the cfdisk / sfdisk. Does anyone have a need to the later two ?</p><p>Please report success / failure / comments / problems in this thread. Thanks for your help !</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p13378">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">wl-hdd-user</div>
					<div class="post-datetime">
						8 Oct 2005, 01:51					</div>
				</div>
				<div class="post-content content">
					<p>I think fdisk is ok. <br />But maybe mk2fs for make ext2 ext3 partitions is very important too <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />Thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p13379">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Nico</div>
					<div class="post-datetime">
						8 Oct 2005, 01:54					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>wl-hdd-user wrote:</cite><blockquote><p>But maybe mk2fs for make ext2 ext3 partitions is very important too <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></blockquote></div><p>It&#039;s already there, look for <strong>e2fsprogs</strong> in my <a href="http://openwrt.org/downloads/people/nico/testing/mipsel/packages/">testing</a> repository.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p13394">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">macsat</div>
					<div class="post-datetime">
						8 Oct 2005, 12:28					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><p>It&#039;s already there, look for <strong>e2fsprogs</strong> in my <a href="http://openwrt.org/downloads/people/nico/testing/mipsel/packages/">testing</a> repository.</p></blockquote></div><p>...so all we need now is swapon Nico ;-)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p13405">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">Nico</div>
					<div class="post-datetime">
						8 Oct 2005, 17:51					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>macsat wrote:</cite><blockquote><p>...so all we need now is swapon...</p></blockquote></div><p>Done, see &quot;Package added: swap-utils&quot; <a href="http://openwrt.org/forum/viewtopic.php?id=2851">thread</a>.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p14460">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">olli</div>
					<div class="post-datetime">
						28 Oct 2005, 18:28					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Nico wrote:</cite><blockquote><div class="quotebox"><cite>wl-hdd-user wrote:</cite><blockquote><p>But maybe mk2fs for make ext2 ext3 partitions is very important too <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></blockquote></div><p>It&#039;s already there, look for <strong>e2fsprogs</strong> in my <a href="http://openwrt.org/downloads/people/nico/testing/mipsel/packages/">testing</a> repository.</p></blockquote></div><p>mke2fs is not working. Any idea what&#039;s wrong?</p><p>EDIT:<br />Okay, it seems like &quot;formatting&quot; doesn&#039;t work (with mke2fs from e2fsprogs). I could not format the &quot;SunDisk Cruzer Mini 512 MB&quot; correctly from the Asus WL-500G deluxe. &quot;Formatting&quot; another different stick works. When I try to mount it I get:</p><div class="codebox"><pre><code>root@OpenWrt:/# mount /dev/scsi/host0/bus0/target0/lun0/part1 /mnt
SQUASHFS error: Can&#039;t find a SQUASHFS superblock on sd(8,1)
VFS: Can&#039;t find ext2 filesystem on dev sd(8,1).
VFS: Can&#039;t find ext3 filesystem on dev sd(8,1).
FAT: bogus logical sector size 0
VFS: Can&#039;t find a valid FAT filesystem on dev 08:01.
mount: Mounting /dev/scsi/host0/bus0/target0/lun0/part1 on /mnt failed: Invalid argument
root@OpenWrt:/#</code></pre></div><p>When I &quot;format&quot; the USB stick with mke2fs on my desktop Linux PC mounting works without errors.</p>											<p class="post-edited">(Last edited by <strong>olli_04</strong> on 28 Oct 2005, 18:55)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p14462">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">frogzoo</div>
					<div class="post-datetime">
						28 Oct 2005, 19:04					</div>
				</div>
				<div class="post-content content">
					<p>So you&#039;ve checked the device file major/minor numbers are the same, yes?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p14463">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">olli</div>
					<div class="post-datetime">
						28 Oct 2005, 19:13					</div>
				</div>
				<div class="post-content content">
					<p>Yes, I double checked that. No way to get the Cruzer Mini &quot;formatted&quot; on the router it self.</p><p>&quot;Formatting&quot; and mounting other USB sticks directly on the router works perfect.</p>											<p class="post-edited">(Last edited by <strong>olli_04</strong> on 28 Oct 2005, 19:22)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p14464">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">frogzoo</div>
					<div class="post-datetime">
						28 Oct 2005, 19:28					</div>
				</div>
				<div class="post-content content">
					<p>No problems running fdisk though?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p15433">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">Scytmo</div>
					<div class="post-datetime">
						15 Nov 2005, 12:29					</div>
				</div>
				<div class="post-content content">
					<p>I have a WRT54G with the SD card mod, and a 128MB card installed.<br />I&#039;ve previously been using it with the FAT filesystem it came with (using the vfat kernel module), but I&#039;ve just successfully used fdisk and mke2fs to create an ext2 partition on the SD card, and I&#039;m now using that instead.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p15436">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">Duffin444</div>
					<div class="post-datetime">
						15 Nov 2005, 12:41					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve done the same.&nbsp; The ext2 file system allows me to install packages into the SD card without having to worry about how I would handle links.&nbsp; Now, with the addition of the LD_LIBRARY_PATH environment variable, I am able to install and use any package on the SD card.&nbsp; This makes the SD mod a really useful addition to the router.</p><p>-Duffin</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p15631">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">mtsales</div>
					<div class="post-datetime">
						17 Nov 2005, 19:26					</div>
				</div>
				<div class="post-content content">
					<p>How does the&nbsp; LD_LIBRARY_PATH environment variable work? Is it enabled by default in RC3?</p><p>Thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p15653">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">Duffin444</div>
					<div class="post-datetime">
						17 Nov 2005, 23:05					</div>
				</div>
				<div class="post-content content">
					<p>The LD_LIBRARY_PATH points to the locations of the libs folder.&nbsp; For instance, if I just wanted to use the default lib folders of /lib and /usr/lib I would use this line of code <br /></p><div class="codebox"><pre><code>export LD_LIBRARY_PATH=/lib:/usr/lib</code></pre></div><p>I used it to point to libraries loaded on my SD card like this (/mnt/sd was my SD moint-point)<br /></p><div class="codebox"><pre><code>export LD_LIBRARY_PATH=/lib:/usr/lib:/mnt/sd/lib:/mnt/sd/usr/lib</code></pre></div><p>I made a Wiki HowTo describing how I got my SD card formatted and ready to install packages on <a href="http://wiki.openwrt.org/PackagesOnExternalMediaHowTo">here</a>.</p><p>-Duffin</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p15667">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">mtsales</div>
					<div class="post-datetime">
						18 Nov 2005, 01:03					</div>
				</div>
				<div class="post-content content">
					<p>Hi Duffin</p><p>Thanks for helping. If you have stuff in /etc/init.d/ that needs libraries,&nbsp; where can you define LD_LIBRARY_PATH to be loaded before all the S.... stuff in /etc/init.d?</p><p>Once again, thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p15668">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">Duffin444</div>
					<div class="post-datetime">
						18 Nov 2005, 01:21					</div>
				</div>
				<div class="post-content content">
					<p>Now it kinda gets complicated.&nbsp; Do you need the libraries before ALL of the scripts in&nbsp; /etc/init.d?&nbsp; If not then you can just put the declaration of LD_LIBRARY_PATH in one of the low-numbered scripts.&nbsp; If indeed you need to execute it before all of the scripts then you have to worry about the path that you are going to declare being mounted or not.&nbsp; I doubt that the library paths are validated when you declare LD_LIBRARY_PATH, but the paths must exist when you try and load a library from them.</p><p>Long answer short, you can declare LD_LIBRARY_PATH in the same spot that the PATH variable is declared, in /etc/preinit, though I would place the export line in the &quot;else&quot; section of the if block that checks to see if failsafe is activated.</p><p>-Duffin</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p15696">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">mtsales</div>
					<div class="post-datetime">
						18 Nov 2005, 10:22					</div>
				</div>
				<div class="post-content content">
					<p>I have a S11mount that mounts my USB HD. I tryed placing LD_LIBRARY_PATH but I don&#039;t think it worked out.</p><p>I&#039;ll try to place it in the preinit as you suggested.</p><p>Thanks for your help</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p15698">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">Duffin444</div>
					<div class="post-datetime">
						18 Nov 2005, 10:48					</div>
				</div>
				<div class="post-content content">
					<p>I would declare the new lib path when you mount your external drive in S11mount.&nbsp; Try that and see if it works.&nbsp; You can see if the new path worked by running the following line at your prompt:<br /></p><div class="codebox"><pre><code>echo &quot;$LD_LIBRARY_PATH&quot;</code></pre></div><p>-Duffin</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p15703">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">Scytmo</div>
					<div class="post-datetime">
						18 Nov 2005, 11:10					</div>
				</div>
				<div class="post-content content">
					<p>Putting the declaration of LD_LIBRARY_PATH in one of the /etc/init.d/S* scripts won&#039;t persist beyond that particular script and the programs it runs - that is, it won&#039;t be available in subsequent /etc/init.d/S* scripts.&nbsp; These scripts are all called in sequence as a sub-shell of /etc/init.d/rcS and modifications to environment variables do not survive beyond the life of any given sub-shell (and its children).&nbsp; Environment variables are propagated DOWN the process tree if they are exported, but never propagated back UP the process tree.</p>											<p class="post-edited">(Last edited by <strong>Scytmo</strong> on 18 Nov 2005, 11:12)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p15712">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">mtsales</div>
					<div class="post-datetime">
						18 Nov 2005, 15:55					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Scytmo wrote:</cite><blockquote><p>Putting the declaration of LD_LIBRARY_PATH in one of the /etc/init.d/S* scripts won&#039;t persist beyond that particular script and the programs it runs - that is, it won&#039;t be available in subsequent /etc/init.d/S* scripts.&nbsp; These scripts are all called in sequence as a sub-shell of /etc/init.d/rcS and modifications to environment variables do not survive beyond the life of any given sub-shell (and its children).&nbsp; Environment variables are propagated DOWN the process tree if they are exported, but never propagated back UP the process tree.</p></blockquote></div><p>That explains why it didn&#039;t work when I tryed it.</p><p>Any suggestions where to define LD_LIBRARY_PATH to be available during boot and afterwards?</p><p>Thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p15717">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">Scytmo</div>
					<div class="post-datetime">
						18 Nov 2005, 17:13					</div>
				</div>
				<div class="post-content content">
					<p>Well, if you&#039;re running a squashfs install I would not recommend putting it in preinit, because preinit is run from the squashfs filesystem before the jffs filesystem (the one containing the files you edit) is remounted as the root partition, so you&#039;d have to change the ROM image and reflash to make the appropriate changes in preinit.</p><p>You could put it in each individual /etc/init.d/S* script that you want it in (i.e. the startup scripts for the programs that you want to run from the SD card).&nbsp; Or, if you want it automatically everywhere, you can put it in /etc/init.d/rcS somewhere before the &#039;for&#039; loop that runs the rest of the init scripts.&nbsp; If you do this, though, any errors in your modification could prevent all the services from starting (including telnet/ssh) so you&#039;d have to reboot in failsafe mode and fix your changes (see the Wiki on how to do this).</p><p>Remember to also do &#039;export LD_LIBRARY_PATH&#039; in the init script, otherwise the variable will not be made available to any programs/scripts that the init script runs.</p><p>Also note that if you choose to put it in each individual /etc/init.d/S* script that you need it in, you won&#039;t be able to confirm this setting by logging in and testing it in the shell... because the shell itself is launched from either the telnet or ssh daemons, which are themselves run from one of the init scripts.&nbsp; But if you put it in rcS, you will see the setting in the shell when you log in, because the telnet/ssh daemons will inherit the exported variable from rcS.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p15722">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">mtsales</div>
					<div class="post-datetime">
						18 Nov 2005, 18:30					</div>
				</div>
				<div class="post-content content">
					<p>Thanks a lot for your help.</p><p>I&#039;ll give it a try</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p15726">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">Duffin444</div>
					<div class="post-datetime">
						18 Nov 2005, 19:17					</div>
				</div>
				<div class="post-content content">
					<p>I learn something new everyday.&nbsp; Thanks Scytmo!</p><p>-Duffin</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>