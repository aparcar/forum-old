<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> option localservice &#039;0&#039; -- Is this a bad idea for dnsmasq? and OpenVPN</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 28 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p326054">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">biscuitmixer</div>
					<div class="post-datetime">
						27 May 2016, 04:52					</div>
				</div>
				<div class="post-content content">
					<div class="codebox"><pre><code>config dnsmasq
        option localservice &#039;0&#039; #enable queries from vpn</code></pre></div><p>I spent the better part of three hours trying to figure out why local DNS lookups weren&#039;t working from my Android phone, thinking it was an OpenVPN option or a strict firewall.&nbsp; I was unable to resolve any addresses at all with just 192.168.1.1 in the OpenVPN config.&nbsp; The Google DNS servers worked just fine.&nbsp; I had actually started to write a post with all of these configs in it when the answer came to me.</p><p>Maybe this should be in the OpenVPN documentation?&nbsp; Maybe not.&nbsp; Is this option a bad idea?&nbsp; I disabled it to make local DNS lookups work from my VPN.&nbsp; If it is a bad idea, I suppose I could type in the IP addresses with my stubby fingers on my phone instead.</p><p>I will be using this to access my home network securely from elsewhere.&nbsp; Separately, I have a VPN client to my provider on my phone if I want to be private.</p><p>Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p327282">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">arny91</div>
					<div class="post-datetime">
						5 Jun 2016, 16:43					</div>
				</div>
				<div class="post-content content">
					<p>Hi,<br />I reached the same conclusion while i was trying to find out why the names of the remote network hosts weren&#039;t resolved. Sincerely, i don&#039;t know if this is a bad idea, perhaps it is so in some specific network configurations.<br />Btw, seems like the vpn client does not know at all about &quot;push dhcp-option DNS x.x.x.x&quot; and &quot;push dhcp-option DOMAIN domain&quot; that are inside my /etc/config/openvpn.</p><p>At least you figured out in 3 hours, i&#039;ve been banging my head for days!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p327419">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">biscuitmixer</div>
					<div class="post-datetime">
						6 Jun 2016, 18:33					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>arny91 wrote:</cite><blockquote><p>Btw, seems like the vpn client does not know at all about &quot;push dhcp-option DNS x.x.x.x&quot; and &quot;push dhcp-option DOMAIN domain&quot; that are inside my /etc/config/openvpn.</p></blockquote></div><p>I&#039;m seeing the DNS and DOMAIN that OpenWrt pushes in the openvpn client log in Android.&nbsp; I think they are going through.&nbsp; When I had 192.168.1.1 and 8.8.8.8 for DNS, and I didn&#039;t have<br /></p><div class="codebox"><pre><code>config dnsmasq
        option localservice &#039;0&#039;</code></pre></div><p>set in /etc/config/dhcp, I was able to resolve outside internet addresses just fine.</p><p>I&#039;m not certain that the &quot;lan&quot; domain is going across.&nbsp; Things seem to be working.</p><div class="quotebox"><cite>arny91 wrote:</cite><blockquote><p>At least you figured out in 3 hours, i&#039;ve been banging my head for days!</p></blockquote></div><p>I count myself lucky that I found that dnsmasq option at all.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>