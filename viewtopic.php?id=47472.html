<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Auto Start Service at boot</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 16 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p218181">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">ari.anggara</div>
					<div class="post-datetime">
						22 Nov 2013, 07:26					</div>
				</div>
				<div class="post-content content">
					<p>Hi, <br />I have made a service, but when I reboot the machine, the service is not start automatically. <br />I have try /etc/init.d/myscript, but still not work. Can any body help me please ?</p><p>Regards,<br />Arie</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p218182">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">eigma</div>
					<div class="post-datetime">
						22 Nov 2013, 07:43					</div>
				</div>
				<div class="post-content content">
					<p>See <a href="http://wiki.openwrt.org/doc/techref/initscripts">http://wiki.openwrt.org/doc/techref/initscripts</a>.</p>											<p class="post-edited">(Last edited by <strong>eigma</strong> on 22 Nov 2013, 07:43)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p218183">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">ari.anggara</div>
					<div class="post-datetime">
						22 Nov 2013, 08:07					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I Have tried all the step, still not work. In the machine which has been configured before by my friend ( i don&#039;t know where he now ), there is a link to my service in /etc/rc.d, the name of the file is begin with S99myservice, all of the machine which has this link can automatically start the service at boot, some of them which don&#039;t have this link should start the service manually at start. In Ubuntu, i use </p><p>update-rc.d myservice defaults, </p><p>but as you know, it doesn&#039;t work in OpenWrt</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p218185">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">neryba</div>
					<div class="post-datetime">
						22 Nov 2013, 08:16					</div>
				</div>
				<div class="post-content content">
					<p>did you tryed&nbsp; /etc/init.d/myscript enable, or enable it by Luci?</p>											<p class="post-edited">(Last edited by <strong>neryba</strong> on 22 Nov 2013, 08:16)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p218187">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">ari.anggara</div>
					<div class="post-datetime">
						22 Nov 2013, 08:30					</div>
				</div>
				<div class="post-content content">
					<p>yes, i have tried that command, still not work,</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p218192">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						22 Nov 2013, 11:56					</div>
				</div>
				<div class="post-content content">
					<p>We cannot help you without knowing the script in question.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p218236">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">rullbandspelare</div>
					<div class="post-datetime">
						22 Nov 2013, 22:58					</div>
				</div>
				<div class="post-content content">
					<p>vi /etc/rc.local<br />And put the path to Your script there.<br />/etc/foo.sh &amp;<br />I put a &amp; at the end so that the router does not hang if it fails.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p218251">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">ari.anggara</div>
					<div class="post-datetime">
						23 Nov 2013, 08:18					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jow wrote:</cite><blockquote><p>We cannot help you without knowing the script in question.</p></blockquote></div><p>Hi,<br />This is my script,</p><p>#!/bin/sh -e</p><p>#start the VPN<br /># Define Bridge Interface<br />br=&quot;br-lan&quot;</p><p># Define list of TAP interfaces to be bridged,<br /># for example tap=&quot;tap0 tap1 tap2&quot;.<br />tap=&quot;tap0&quot;</p><p># Define physical ethernet interface to be bridged<br /># with TAP interface(s) above.<br />eth=&quot;eth0&quot;<br />eth_ip=&quot;172.168.0.123&quot;<br />eth_netmask=&quot;255.255.252.0&quot;<br />eth_broadcast=&quot;172.168.3.255&quot;</p><p>for t in $tap; do<br />&nbsp; &nbsp; openvpn --mktun --dev $t<br />&nbsp; &nbsp; done</p><p>&nbsp; &nbsp; brctl addbr $br<br />&nbsp; &nbsp; ifconfig $br up<br />&nbsp; &nbsp; brctl addif $br $eth</p><p>&nbsp; &nbsp; for t in $tap; do<br />&nbsp; &nbsp; &nbsp; &nbsp; brctl addif $br $t<br />&nbsp; &nbsp; &nbsp; &nbsp; done</p><p>&nbsp; &nbsp; &nbsp; &nbsp; for t in $tap; do<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ifconfig $t 0.0.0.0 promisc up<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; done</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ifconfig $eth 0.0.0.0 promisc up</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ifconfig $br $eth_ip netmask $eth_netmask broadcast $eth_broadcast</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; iptables -A INPUT -d $eth_ip -p icmp -m icmp --icmp-type 8 -j ACCEPT<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; iptables -A FORWARD -i $br -j ACCEPT</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; openvpn --config /etc/config/vhms/clients.ovpn &amp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #sysctl -p /etc/sysctl.conf</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>