<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Namecheap DDNS</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 28 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p287377">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">splify</div>
					<div class="post-datetime">
						13 Aug 2015, 03:38					</div>
				</div>
				<div class="post-content content">
					<p>Hi Guys</p><p>I&#039;ve been corresponding with namecheap tech-support to try and resolve this issue, the last email from them said they can&#039;t do anything on their end so I was wondering if someone knows anything.</p><p>My dynamic dns in openwrt isn&#039;t working, and the concluding email from namecheap said:</p><p>&quot;You can try remove the line containing the @ to % 40 escape from the file called url_escape.sed that is located in /usr/lib/ddns directory, that could resolve the issue.&quot;</p><p>and the following:</p><p>&quot;We are very sorry that you are facing such an unpleasant situation, but regretfully there is nothing we can do from our end to get the issue resolved.</p><p>As an alternative, we can suggest using Namecheap Dynamic DNS client: <a href="https://www.namecheap.com/support/knowledgebase/article.aspx/111/11/using-namecheap-dynamic-dns-client-version-20x-beta.\">https://www.namecheap.com/support/knowledgebase/article.aspx/111/11/using-namecheap-dynamic-dns-client-version-20x-beta.&quot;</a></p><p>Below is the output of the log. And they are referring to this string:</p><p>&quot;/var/run/ddns/Dyndns_IP4.err --capath /etc/ssl/certs --noproxy &#039;*&#039; &#039;<a href="https://dynamicdns.park-your-domain.com/update?host=%40&amp;domain=spifnspam.com&amp;password=bc23a8bcc45947bea49ae398771a51fe&amp;ip=79.183.69.200">https://dynamicdns.park-your-domain.com … 183.69.200</a>&#039;&quot;</p><p>They say the %40 isn&#039;t supposed to be there, and I couldn&#039;t find anywhere to remove it, any clue?</p><p>****LOG OUTPUT BELOW****</p><br /><p>145345&nbsp; &nbsp; &nbsp; &nbsp;: ************ ************** ************** **************<br /> 145345&nbsp; note : PID &#039;28837&#039; started at 2015-08-11 14:53<br /> 145345&nbsp; &nbsp; &nbsp; &nbsp;: uci configuration:<br />ddns.Dyndns_IP4.cacert=&#039;/etc/ssl/certs&#039;<br />ddns.Dyndns_IP4.domain=&#039;spifnspam.com&#039;<br />ddns.Dyndns_IP4.enabled=&#039;1&#039;<br />ddns.Dyndns_IP4.force_interval=&#039;0&#039;<br />ddns.Dyndns_IP4.interface=&#039;wan&#039;<br />ddns.Dyndns_IP4.ip_network=&#039;wan&#039;<br />ddns.Dyndns_IP4.ip_source=&#039;network&#039;<br />ddns.Dyndns_IP4.password=&#039;bc23a8bcc45947bea49ae398771a51fe&#039;<br />ddns.Dyndns_IP4.service_name=&#039;namecheap.com&#039;<br />ddns.Dyndns_IP4.use_https=&#039;1&#039;<br />ddns.Dyndns_IP4.use_logfile=&#039;1&#039;<br />ddns.Dyndns_IP4.use_syslog=&#039;2&#039;<br />ddns.Dyndns_IP4.username=&#039;@&#039;<br />ddns.Dyndns_IP4=service<br /> 145345&nbsp; &nbsp; &nbsp; &nbsp;: ddns version&nbsp; : 2.4.3-1<br /> 145345&nbsp; &nbsp; &nbsp; &nbsp;: verbose mode&nbsp; : 0 - run normal, NO console output<br /> 145346&nbsp; &nbsp; &nbsp; &nbsp;: check interval: 600 seconds<br /> 145346&nbsp; &nbsp; &nbsp; &nbsp;: force interval: 0 seconds<br /> 145346&nbsp; &nbsp; &nbsp; &nbsp;: retry interval: 60 seconds<br /> 145346&nbsp; &nbsp; &nbsp; &nbsp;: retry counter : 0 times<br /> 145346&nbsp; &nbsp; &nbsp; &nbsp;: No old process<br /> 145346&nbsp; &nbsp; &nbsp; &nbsp;: last update: 2015-08-11 00:48<br /> 145346&nbsp; &nbsp; &nbsp; &nbsp;: Detect registered/public IP<br /> 145346&nbsp; &nbsp; &nbsp; &nbsp;: #&gt; /usr/bin/nslookup spifnspam.com&nbsp; &gt;/var/run/ddns/Dyndns_IP4.dat 2&gt;/var/run/ddns/Dyndns_IP4.err<br /> 145346&nbsp; &nbsp; &nbsp; &nbsp;: Registered IP &#039;79.183.69.200&#039; detected<br /> 145346&nbsp; info : Starting main loop at 2015-08-11 14:53<br /> 145346&nbsp; &nbsp; &nbsp; &nbsp;: Detect local IP on &#039;network&#039;<br /> 145346&nbsp; &nbsp; &nbsp; &nbsp;: Local IP &#039;79.183.69.200&#039; detected on network &#039;wan&#039;<br /> 145346&nbsp; &nbsp; &nbsp; &nbsp;: Forced Update - L: &#039;79.183.69.200&#039; == R: &#039;79.183.69.200&#039;<br /> 145347&nbsp; &nbsp; &nbsp; &nbsp;: #&gt; /usr/bin/curl -RsS -o /var/run/ddns/Dyndns_IP4.dat --stderr /var/run/ddns/Dyndns_IP4.err --capath /etc/ssl/certs --noproxy &#039;*&#039; &#039;<a href="https://dynamicdns.park-your-domain.com/update?host=%40&amp;domain=spifnspam.com&amp;password=bc23a8bcc45947bea49ae398771a51fe&amp;ip=79.183.69.200">https://dynamicdns.park-your-domain.com … 183.69.200</a>&#039;<br /> 145348&nbsp; &nbsp; &nbsp; &nbsp;: DDNS Provider answered:<br />&lt;?xml version=&quot;1.0&quot;?&gt;&lt;interface-response&gt;&lt;Command&gt;SETDNSHOST&lt;/Command&gt;&lt;Language&gt;eng&lt;/Language&gt;&lt;IP&gt;79.183.69.200&lt;/IP&gt;&lt;ErrCount&gt;0&lt;/ErrCount&gt;&lt;ResponseCount&gt;0&lt;/ResponseCount&gt;&lt;Done&gt;true&lt;/Done&gt;&lt;debug&gt;&lt;![CDATA[]]&gt;&lt;/debug&gt;&lt;/interface-response&gt;<br /> 145348&nbsp; info : Forced update successful - IP: &#039;79.183.69.200&#039; send<br /> 145349&nbsp; &nbsp; &nbsp; &nbsp;: Waiting 600 seconds (Check Interval)<br /> 150349&nbsp; &nbsp; &nbsp; &nbsp;: Detect registered/public IP<br /> 150349&nbsp; &nbsp; &nbsp; &nbsp;: #&gt; /usr/bin/nslookup spifnspam.com&nbsp; &gt;/var/run/ddns/Dyndns_IP4.dat 2&gt;/var/run/ddns/Dyndns_IP4.err<br /> 150349&nbsp; &nbsp; &nbsp; &nbsp;: Registered IP &#039;79.183.69.200&#039; detected<br /> 150349&nbsp; info : Configured to run once<br /> 150349&nbsp; note : PID &#039;28837&#039; exit normal at 2015-08-11 15:03</p><p>Thanks for any clues.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p287379">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">makarel</div>
					<div class="post-datetime">
						13 Aug 2015, 03:53					</div>
				</div>
				<div class="post-content content">
					<p>hi<br />ssh &gt; nano /usr/lib/ddns/url_escape.sed<br />on AA is ~ line 20 &gt; s:@:%40:g</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p287409">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">splify</div>
					<div class="post-datetime">
						13 Aug 2015, 12:02					</div>
				</div>
				<div class="post-content content">
					<p>thanks for the replay man.</p><p>root@OpenWrt:/usr/lib/ddns# ls<br />dynamic_dns_functions.sh&nbsp; &nbsp;dynamic_dns_updater.sh&nbsp; &nbsp; &nbsp;services_ipv6<br />dynamic_dns_lucihelper.sh&nbsp; services</p><p>I don&#039;t have url_escape.sed there - should I have it ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p287419">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">chris5560</div>
					<div class="post-datetime">
						13 Aug 2015, 12:57					</div>
				</div>
				<div class="post-content content">
					<p>Inside CC 15.05 you are using, url encode is done inside script, so no external /usr/lib/ddns/url_escape.sed file.<br />ddns-scripts are encoding username and password.<br />I&#039;m wondering why namecheep should not support urlencoded url&#039;s ?</p><p>Looking on the provided log above I can&#039;t see any problems.<br />Namecheap report &quot;errcount = 0&quot; and &quot;done = true&quot; and ddns-scripts detect that L: &#039;79.183.69.200&#039; == R: &#039;79.183.69.200&#039; (L: local R: remote IP)</p><p>What is not working in detail ?<br />Christian</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p287498">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">splify</div>
					<div class="post-datetime">
						13 Aug 2015, 21:41					</div>
				</div>
				<div class="post-content content">
					<p>The IP isn&#039;t updated when I ping the hostname, it still remains the old one, even though everything looks like it should be working.</p><p>Namecheap say there is something wrong with the curl string being sent.</p><p>Or maybe they are running me in circles cuz they just don&#039;t want to support it, Idk.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p287499">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">chris5560</div>
					<div class="post-datetime">
						13 Aug 2015, 21:57					</div>
				</div>
				<div class="post-content content">
					<p>I just nslookup your host and get &quot;79.180.69.129&quot;<br />As you see in the log above:<br />145346&nbsp; &nbsp; &nbsp; &nbsp;: Registered IP &#039;79.183.69.200&#039; detected -&gt; that&#039;s nslookup answer<br />145346&nbsp; &nbsp; &nbsp; &nbsp;: Local IP &#039;79.183.69.200&#039; detected on network &#039;wan&#039;&nbsp; &nbsp; &nbsp;-&gt; this was detected locally<br />So there is no diff. <br />Is there a problem with your DNS resolution ? nslookup and ping might have different answers! please check<br />If my nslookup (see above) needs to be updated then try two things:<br />use &quot;option dns_server&quot; and set to &quot;google-public-dns-a.google.com&quot; if this still not helo<br />use &quot;option force_dnstcp&quot; !!! require BIND host package to be installed.<br />Christian</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p287512">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">Borromini</div>
					<div class="post-datetime">
						13 Aug 2015, 23:45					</div>
				</div>
				<div class="post-content content">
					<p>This is what works for me for Namecheap:</p><div class="codebox"><pre><code>config ddns &#039;global&#039;
    option date_format &#039;%F %R&#039;
    option log_lines &#039;250&#039;
    option allow_local_ip &#039;0&#039;
    option use_https &#039;1&#039;

config service &#039;Namecheap&#039;
    option ip_source &#039;network&#039;
    option ip_network &#039;wan&#039;
    option interface &#039;wan&#039;
    option check_interval &#039;10&#039;
    option check_unit &#039;minutes&#039;
    option force_interval &#039;72&#039;
    option force_unit &#039;hours&#039;
    option enabled &#039;1&#039;
    option use_syslog &#039;2&#039;
    option use_logfile &#039;1&#039;
    option service_name &#039;namecheap.com&#039;
    option domain &#039;volatilesystems.org&#039;
    option username &#039;@&#039;
    option password &#039;hash&#039;</code></pre></div><p>You can check the link to my website on the bottom left of the post for the functionality <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />.</p>											<p class="post-edited">(Last edited by <strong>Borromini</strong> on 13 Aug 2015, 23:45)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p287686">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">splify</div>
					<div class="post-datetime">
						15 Aug 2015, 13:45					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for your help guys.</p><p>What did it at the end was configuring /etc/config/ddns and removing:<br />&quot;&nbsp; &nbsp; &nbsp; &nbsp;option cacert &#039;/etc/ssl/certs&#039;&quot;</p><p>Also removed any IPv6 relevance.</p><p>Thanks Borromini for posting your config file - it helped me a bunch.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p287708">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">chris5560</div>
					<div class="post-datetime">
						15 Aug 2015, 18:41					</div>
				</div>
				<div class="post-content content">
					<p>You also removed &quot;option use_https&quot; or set to &quot;0&quot; (zero) ?<br />Yes ! Then you are communicating WITHOUT secure connection. Was this your plan ?<br />If you like to use secure communication (httpS;//) you need to set<br />option use_https &quot;1&quot;<br />option cacert &quot;/etc/ssl/certs&quot;<br />AND install ca-certificate package.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>