<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> x86 &quot;D-Link&quot; router/NAS project</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 20 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p189003">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">MasterWang</div>
					<div class="post-datetime">
						15 Jan 2013, 16:00					</div>
				</div>
				<div class="post-content content">
					<p>Hello. I am attempting to build a router/NAS system based on the <a href="http://www.intel.hk/content/www/us/en/motherboards/desktop-motherboards/desktop-board-d2500cc.html">Intel D2500CC </a> motherboard and <a href="http://item.taobao.com/item.htm?spm=a230r.1.10.2.VEf77X&amp;id=15908541969&amp;_u=f6r2oimcd8f">a strange D-Link ITX case</a> that I found on Taobao.</p><p>parts used:<br />1. Intel D2500CC ITX motherboard (the cpu supports x86_64, should I care?)<br />2. D-Link ITX case <br />3. 2GB DDR3 1333 (seems to be an overkill but thats the smallest ram sticks I could find *new*)<br />4. SATA-to-CF card adapter (boot drive)<br />5. 256MB old CF card (should be an overkill)<br />6. Intel WinMAX/Wifi Link 5150<br />7. some old 2.5&quot; SATA harddrive (will upgrade to a 1 TB drive later)</p><p>what I need help with:<br />I need to know how to compile a custom image that would support the hardware I listed.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p189009">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">flux</div>
					<div class="post-datetime">
						15 Jan 2013, 16:29					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>MasterWang wrote:</cite><blockquote><p>I need to know how to compile a custom image that would support the hardware I listed.</p></blockquote></div><p>just install debian without X</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p189010">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">MasterWang</div>
					<div class="post-datetime">
						15 Jan 2013, 16:33					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>flux wrote:</cite><blockquote><div class="quotebox"><cite>MasterWang wrote:</cite><blockquote><p>I need to know how to compile a custom image that would support the hardware I listed.</p></blockquote></div><p>just install debian without X</p></blockquote></div><p>Would Openwrt work as well? I have no experience dealing with full-fledged servers before.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p189024">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">MasterWang</div>
					<div class="post-datetime">
						15 Jan 2013, 19:14					</div>
				</div>
				<div class="post-content content">
					<p>I have installed the tools required to compile the custom image. In other words I am at the hard part: I am not sure which ones I need to install.&nbsp; Someone please enlighten me.</p><p>What I think I need to specifically include in the compilation:<br />- SATA support so the image will boot in the first place<br />- support for common filesystems so I can stick any harddrive in it if I want (ext, fat32... etc)<br />- USB support<br />- USB storage device support<br />- wifi support<br />- driver for my wifi card</p><p>What I think I must include but have no clue how to be sure:<br />- multi LAN support (my mobo has two LANs)<br />- Firewall<br />- QoS<br />- VPN support (PPtP)</p><p>One more question: why shouldn&#039;t I just include all packages into the compilation? Because it wastes RAM and makes the system unstable?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p189026">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">tgp1994</div>
					<div class="post-datetime">
						15 Jan 2013, 20:04					</div>
				</div>
				<div class="post-content content">
					<p>I think what flux was getting at is that the line between a &quot;server&quot; and a router is a very blurry one. You can essentially be running a fully fledged server.</p><p>I don&#039;t know much about building Openwrt / linux kernels in general (sorry for not adding much here), although you may be better off getting debian without X like flux said, and just running that. I would have to imagine that you would need to find all of the right modules to build into openwrt in order to get this working, whereas you currently have the extra breathing room for running a more ready-to-go (albeit heavier) kernel, built by debian for x86 platforms.</p><p>&quot;multi lan support&quot;, firewall, QoS, VPN support, those are all things either built into or readily available for installation on debian.</p><p>I have to admit though, I love Openwrt&#039;s LuCInterface. If you&#039;re after that, maybe there&#039;s a way of putting that on top of a debian backend?</p>											<p class="post-edited">(Last edited by <strong>tgp1994</strong> on 15 Jan 2013, 20:04)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p189027">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">MasterWang</div>
					<div class="post-datetime">
						15 Jan 2013, 20:16					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for the input tgp1994. Since I have no idea even where to begin I should be toying with OpenWrt for the moment to see if it does what I want good enough. If I am using Debian maybe I could squeeze even more performance out of the device by, say, installing 4 gigs of ram and run the system on RAMdisk for extra speed? </p><p>In any case this device is more or less a prototype. I will have to build another solid one for work-related purposes. The current one I will use at home. &quot;Mark 2&quot; will have many wifi antennas sticking out of it. I intend it to be the storage unit for security cameras AND a wifi hotspot. The thing will be using two wifi cards and supporting two wifi networks.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p189029">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						15 Jan 2013, 20:27					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>MasterWang wrote:</cite><blockquote><p>I need to know how to compile a custom image that would support the hardware I listed.</p></blockquote></div><p>You certainly can start from <a href="http://wiki.openwrt.org/doc/start">here</a>. In it and under the <strong>Developing</strong> section, you will find <a href="http://wiki.openwrt.org/doc/devel/env">Using Build Environments</a>. It will teach you how to configure your local OpenWRT source to build images for multiple configurations/ targets in one single checkout.</p><p>BTW, I wonder how much you will end up in your expenses by the time you have your hardware completely built, let alone the operational cost. Recently, I bought several units if this <a href="http://archlinuxarm.org/platforms/armv5/seagate-goflex-net">Seagate GoFLEX NET</a> for $9.99 from Fry&#039;s Electronics stores. This device does exactly what you wanna do and itself consumes a little less than 3 Watts of electricity. Granted, its RAM size is fixed to 128MB, but it should run just fine as a NAS and even with a <a href="http://freeswitch.org">FreeSWITCH</a>.</p><p>I am sure you will be able to find some inexpensive ready-to-run NAS from TaoBao or even AliExpress.</p><p>BTW, J&amp;R] is currently selling a <a href="http://www.jr.com/product/productListing.jsp?N=4294205859">POGOV4A101</a> for $29.99 (It was $19.99 over 12/12).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p189033">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">MasterWang</div>
					<div class="post-datetime">
						15 Jan 2013, 20:54					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>mazilo wrote:</cite><blockquote><div class="quotebox"><cite>MasterWang wrote:</cite><blockquote><p>I need to know how to compile a custom image that would support the hardware I listed.</p></blockquote></div><p>You certainly can start from <a href="http://wiki.openwrt.org/doc/start">here</a>. In it and under the <strong>Developing</strong> section, you will find <a href="http://wiki.openwrt.org/doc/devel/env">Using Build Environments</a>. It will teach you how to configure your local OpenWRT source to build images for multiple configurations/ targets in one single checkout.</p><p>BTW, I wonder how much you will end up in your expenses by the time you have your hardware completely built, let alone the operational cost. Recently, I bought several units if this <a href="http://archlinuxarm.org/platforms/armv5/seagate-goflex-net">Seagate GoFLEX NET</a> for $9.99 from Fry&#039;s Electronics stores. This device does exactly what you wanna do and itself consumes a little less than 3 Watts of electricity. Granted, its RAM size is fixed to 128MB, but it should run just fine as a NAS and even with a <a href="http://freeswitch.org">FreeSWITCH</a>.</p><p>I am sure you will be able to find some inexpensive ready-to-run NAS from TaoBao or even AliExpress.</p><p>BTW, J&amp;R] is currently selling a <a href="http://www.jr.com/product/productListing.jsp?N=4294205859">POGOV4A101</a> for $29.99 (It was $19.99 over 12/12).</p></blockquote></div><p>Ah Fry&#039;s. Unfortunately I am thousands of miles away from the nearest store. The current device I am working on should cost less than USD $200 when complete (HDD included). Not too bad. The other device which I will build will be used in an environment where power is consumed by tens of kilowatts so I really am not concerned about power consumption.</p><p>I must admit I am attracted to the idea of being able to fully customize my devices. The DIY spirit, you know.</p><p>(custom image is being compiled. dang is my laptop slow.)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p189034">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">tgp1994</div>
					<div class="post-datetime">
						15 Jan 2013, 20:56					</div>
				</div>
				<div class="post-content content">
					<p>That&#039;s something I want to do in the future too, just build my own router, so it&#039;s a modestly powerful but very small machine <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p189042">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">MasterWang</div>
					<div class="post-datetime">
						15 Jan 2013, 21:17					</div>
				</div>
				<div class="post-content content">
					<p>Compilation complete. Now I have a whole bunch of files:</p><p>OpenWrt-ImageBuilder-x86_generic-for-linux-x86_64.tar.bz2<br />openwrt-x86-generic-combined-ext4.img.gz<br />openwrt-x86-generic-combined-jffs2-128k.img<br />openwrt-x86-generic-combined-jffs2-64k.img<br />openwrt-x86-generic-combined-squashfs.img<br />openwrt-x86-generic-rootfs-ext4.img.gz<br />openwrt-x86-generic-rootfs-jffs2-128k.img<br />openwrt-x86-generic-rootfs-jffs2-64k.img<br />openwrt-x86-generic-rootfs-squashfs.img<br />openwrt-x86-generic-rootfs.tar.gz<br />openwrt-x86-generic-vmlinuz</p><p>Now I am confused. Someone please tell me:</p><p>1. The differences between &quot;combined&quot; and &quot;rootfs&quot;.<br />2. Do I unpack the zipped files and dd the big image file to my CF card or use one of the smaller .img files?<br />3. Is openwrt-x86-generic-combined-squashfs.img a good choice? Or should I use the openwrt-x86-generic-combined-ext4.img.gz one?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p189056">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						15 Jan 2013, 23:33					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>MasterWang wrote:</cite><blockquote><p>The current device I am working on should cost less than USD $200 when complete (HDD included). Not too bad.</p></blockquote></div><p>HDD itself may already cost $100.</p><p>You can also try to get those GoogleTV on a USB stick that runs on a dual-core RockChip RK3066 ARM Cortex A9 CPU for as low as $35 from AliExpress. It already comes with Android OS; however, it certainly will be an interesting project to port OpenWRT to this device.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p189070">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">MasterWang</div>
					<div class="post-datetime">
						16 Jan 2013, 07:59					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>mazilo wrote:</cite><blockquote><div class="quotebox"><cite>MasterWang wrote:</cite><blockquote><p>The current device I am working on should cost less than USD $200 when complete (HDD included). Not too bad.</p></blockquote></div><p>HDD itself may already cost $100.</p><p>You can also try to get those GoogleTV on a USB stick that runs on a dual-core RockChip RK3066 ARM Cortex A9 CPU for as low as $35 from AliExpress. It already comes with Android OS; however, it certainly will be an interesting project to port OpenWRT to this device.</p></blockquote></div><p>Thankfully I am friends with some people that run a PC shop so I can get things cheaper. 2.5&quot; HDDs are getting cheaper and cheaper anyway. The factories must have fully recovered from the effects of the flood in Thailand. I am able to get a 1TB 5200 rpm HDD at no more than $80. Sounds reasonable.</p><p>In any case I have already acquired the parts so the only reasonable course of action is to see it through. But thanks for informing me of the good deals!</p>											<p class="post-edited">(Last edited by <strong>MasterWang</strong> on 16 Jan 2013, 08:19)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p189085">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">drekthar</div>
					<div class="post-datetime">
						16 Jan 2013, 10:42					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>MasterWang wrote:</cite><blockquote><p>Compilation complete. Now I have a whole bunch of files:</p><p>OpenWrt-ImageBuilder-x86_generic-for-linux-x86_64.tar.bz2<br />openwrt-x86-generic-combined-ext4.img.gz<br />openwrt-x86-generic-combined-jffs2-128k.img<br />openwrt-x86-generic-combined-jffs2-64k.img<br />openwrt-x86-generic-combined-squashfs.img<br />openwrt-x86-generic-rootfs-ext4.img.gz<br />openwrt-x86-generic-rootfs-jffs2-128k.img<br />openwrt-x86-generic-rootfs-jffs2-64k.img<br />openwrt-x86-generic-rootfs-squashfs.img<br />openwrt-x86-generic-rootfs.tar.gz<br />openwrt-x86-generic-vmlinuz</p><p>Now I am confused. Someone please tell me:</p><p>1. The differences between &quot;combined&quot; and &quot;rootfs&quot;.<br />2. Do I unpack the zipped files and dd the big image file to my CF card or use one of the smaller .img files?<br />3. Is openwrt-x86-generic-combined-squashfs.img a good choice? Or should I use the openwrt-x86-generic-combined-ext4.img.gz one?</p></blockquote></div><br /><p>you should unzip this file openwrt-x86-generic-combined-ext4.img.gz and dd it into the cf card ..</p><p>and as far as the driver and modules are concerned about your build<br />use <br />make kernel_menuconfig to make sure all the needed drivers are included (by default the openwrt x86 kernel is well equipped)<br />then use make menuconfig to include all the modules and packages required...</p><p>i tried building a project like this before but you must understand openwrt is not designed to be a full fledged nas server so you will not have any of the data security hard drive maintenance and raid features. all you can do is read and write to the hard disk over a network with no security from data corruption or hard disk maintenance....</p><br /><p>in a nutshell all i&#039;m trying to say is openwrt though supported by x86 is a very limited platform as far as the capabilities of x86 are concerned so you would be better of with a a full fledged linux distribution taking advantage of the hardware and do all that you require from that distro such as the dual wifi,nas,and what not from there(all this assuming you have enough knowledge to setup a full linux distro up to your needs)</p>											<p class="post-edited">(Last edited by <strong>drekthar</strong> on 16 Jan 2013, 10:49)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p189092">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">Lennong</div>
					<div class="post-datetime">
						16 Jan 2013, 11:49					</div>
				</div>
				<div class="post-content content">
					<p><a href="http://linux.voyage.hk/">http://linux.voyage.hk/</a><br />Would suit your req perfectly. Debian based so most stuff you do in OpenWRT you do here. I have been doing a fair deal of compiling OpenWRT to various routers but after plugging in Voyage to my Alix board Im doing everything on it.</p>											<p class="post-edited">(Last edited by <strong>Lennong</strong> on 16 Jan 2013, 11:51)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p189104">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						16 Jan 2013, 14:57					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>MasterWang wrote:</cite><blockquote><p>I am able to get a 1TB 5200 rpm HDD at no more than $80. Sounds reasonable.</p></blockquote></div><p>I did some search on AliExpress about 2.5&quot; HD and they seemed to be more expensive than I can get locally from Fry&#039;s Electronics and/or MicroCenter stores. Every-now-and-then, either these stores has 1TB 5200RPM 2.5&quot; HD onsale for a little less than US$50. Right now, I am looking for some inexpensive Seagate FreeAgent SATA 1TB 7200RPM HD to use on my Seagate GoFLEX NET device which I plan to use for OpenWRT development purposes.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p189127">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">MasterWang</div>
					<div class="post-datetime">
						16 Jan 2013, 19:37					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Lennong wrote:</cite><blockquote><p><a href="http://linux.voyage.hk/">http://linux.voyage.hk/</a><br />Would suit your req perfectly. Debian based so most stuff you do in OpenWRT you do here. I have been doing a fair deal of compiling OpenWRT to various routers but after plugging in Voyage to my Alix board Im doing everything on it.</p></blockquote></div><p>I installed it but this distro looks like something for people beyond my level. I have no idea on how to install a web interface or a more familiar text editor like nano. (the system reports No space left of device, what the heck?)</p><p>P.S.: df -h says rootfs is at 100% usage while tempfs (mounted on /run) is at 1%.</p>											<p class="post-edited">(Last edited by <strong>MasterWang</strong> on 16 Jan 2013, 19:42)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>