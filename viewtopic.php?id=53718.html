<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> OpenVPN on WR1043 v2: Can not install package</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 2 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p252542">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">mindph</div>
					<div class="post-datetime">
						30 Oct 2014, 18:35					</div>
				</div>
				<div class="post-content content">
					<p>Hello</p><p>I have flashed my WR1043 v2 with this image<br /><a href="http://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/openwrt-ar71xx-generic-tl-wr1043nd-v2-squashfs-factory.bin">http://downloads.openwrt.org/barrier_br … actory.bin</a><br />Taken from <a href="http://wiki.openwrt.org/toh/tp-link/tl-wr1043nd#downloads.for.tl-wr1043nd.v2.x">http://wiki.openwrt.org/toh/tp-link/tl- … 043nd.v2.x</a></p><p>After flashing and login I try to install OpenVPN but it seems there is a problem with a kernel module</p><p>root@OpenWrt:~# opkg update<br />Downloading <a href="http://downloads.openwrt.org/barrier_breaker/14.07-rc3/ar71xx/generic/packages//Packages.gz.">http://downloads.openwrt.org/barrier_br … ckages.gz.</a><br />Updated list of available packages in /var/opkg-lists/barrier_breaker_base.<br />root@OpenWrt:~# opkg list |grep openvpn<br />collectd-mod-openvpn - 4.10.8-3 - OpenVPN traffic/compression input plugin<br />openvpn-easy-rsa - 2013-01-30-2 - Simple shell scripts to manage a Certificate Authority<br />openvpn-nossl - 2.3.4-1 - Open source VPN solution using plaintext (no SSL)<br />openvpn-openssl - 2.3.4-1 - Open source VPN solution using OpenSSL<br />openvpn-polarssl - 2.3.4-1 - Open source VPN solution using PolarSSL</p><p>root@OpenWrt:~# opkg install openvpn-openssl<br />Installing openvpn-openssl (2.3.4-1) to root...<br />Downloading <a href="http://downloads.openwrt.org/barrier_breaker/14.07-rc3/ar71xx/generic/packages//openvpn-openssl_2.3.4-1_ar71xx.ipk.">http://downloads.openwrt.org/barrier_br … r71xx.ipk.</a><br />Collected errors:<br /> * satisfy_dependencies_for: Cannot satisfy the following dependencies for openvpn-openssl:<br /> *&nbsp; &nbsp; &nbsp; kernel (= 3.10.49-1-94831e5bcf361d1c03e87a15e152b0e8) *<br /> * opkg_install_cmd: Cannot install package openvpn-openssl.</p><p>The kernel however is 3.10.49 just correctly</p><p>root@OpenWrt:~# uname -a<br />Linux OpenWrt 3.10.49 #3 Wed Oct 1 17:00:51 CEST 2014 mips GNU/Linux</p><p>What&#039;s going wrong here?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p252546">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">mindph</div>
					<div class="post-datetime">
						30 Oct 2014, 18:45					</div>
				</div>
				<div class="post-content content">
					<p>I have now tried the upgrade image, <br /><a href="http://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/openwrt-ar71xx-generic-tl-wr1043nd-v2-squashfs-sysupgrade.bin">http://downloads.openwrt.org/barrier_br … pgrade.bin</a><br />and there is the same problem</p><p>Installing openvpn-openssl (2.3.4-1) to root...<br />Downloading <a href="http://downloads.openwrt.org/barrier_breaker/14.07-rc3/ar71xx/generic/packages//openvpn-openssl_2.3.4-1_ar71xx.ipk.">http://downloads.openwrt.org/barrier_br … r71xx.ipk.</a><br />Collected errors:<br /> * satisfy_dependencies_for: Cannot satisfy the following dependencies for openvpn-openssl:<br /> *&nbsp; &nbsp; &nbsp; kernel (= 3.10.49-1-94831e5bcf361d1c03e87a15e152b0e8) *<br /> * opkg_install_cmd: Cannot install package openvpn-openssl.</p><p>My kernel according to luci is<br />3.10.49-1-0114c71ed85677c9c1e4911437af4743</p>											<p class="post-edited">(Last edited by <strong>mindph</strong> on 30 Oct 2014, 18:47)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p252548">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">mindph</div>
					<div class="post-datetime">
						30 Oct 2014, 18:59					</div>
				</div>
				<div class="post-content content">
					<p>--force-depends installs the tun but still complains about the kernel. I also tried to load from rc1 and rc2 but same problem with different checksums. Is that kmod-tun package wrong?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p252558">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">KHAN85</div>
					<div class="post-datetime">
						30 Oct 2014, 21:22					</div>
				</div>
				<div class="post-content content">
					<p>Compile your own openwrt with the module included.</p><p>./scripts/feeds update<br />./scripts/feeds install &lt;packages&gt;<br />make menuconfig<br />(select packages you want)<br />make world</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p252579">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">tmo26</div>
					<div class="post-datetime">
						30 Oct 2014, 23:34					</div>
				</div>
				<div class="post-content content">
					<p>update your opkg.conf</p><p>You&#039;re trying to install ..barrier_breaker/14.07<strong>-rc3</strong>/.../openvpn-openssl_2.3.4-1_ar71xx.ipk<br />While your firmware is ..barrier_breaker/14.07/</p><p>Note the difference.</p><p>Update your opkg conf to 14.07 and try again to install openvpn.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p252611">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">mindph</div>
					<div class="post-datetime">
						31 Oct 2014, 10:43					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>KHAN85 wrote:</cite><blockquote><p>Compile your own openwrt with the module included.</p><p>./scripts/feeds update<br />./scripts/feeds install &lt;packages&gt;<br />make menuconfig<br />(select packages you want)<br />make world</p></blockquote></div><p>Well I wanted to install it from package system not compile a system myself. I want to stay vanilla as possible on that box.</p><div class="quotebox"><cite>tmo26 wrote:</cite><blockquote><p>update your opkg.conf</p><p>You&#039;re trying to install ..barrier_breaker/14.07<strong>-rc3</strong>/.../openvpn-openssl_2.3.4-1_ar71xx.ipk<br />While your firmware is ..barrier_breaker/14.07/</p><p>Note the difference.</p><p>Update your opkg conf to 14.07 and try again to install openvpn.</p></blockquote></div><p>As said, I tried that. 14.07, 14.07-rc1, 14.07-rc2 and 14.07-rc3<br />/14.07/ gives me the error, that it can not find package.gz<br />The image I flashed installed a opkg.conf with rc3 in it. So is that a bug?</p>											<p class="post-edited">(Last edited by <strong>mindph</strong> on 31 Oct 2014, 10:45)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p252621">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">tmo26</div>
					<div class="post-datetime">
						31 Oct 2014, 13:19					</div>
				</div>
				<div class="post-content content">
					<p>post your opkg.conf</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p252623">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">yoyellow</div>
					<div class="post-datetime">
						31 Oct 2014, 13:32					</div>
				</div>
				<div class="post-content content">
					<p>i&#039;ve had the same issue, i built my own image, downloaded from git://git.openwrt.org/14.07/openwrt.git when trying to install openvpn with the correct opkg.conf.</p><p>this was a few days ago..</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p252629">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">mindph</div>
					<div class="post-datetime">
						31 Oct 2014, 14:21					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>tmo26 wrote:</cite><blockquote><p>post your opkg.conf</p></blockquote></div><p>dest root /<br />dest ram /tmp<br />lists_dir ext /var/opkg-lists<br />option overlay_root /overlay<br />src/gz barrier_breaker_base <a href="http://downloads.openwrt.org/barrier_breaker/14.07-rc3/ar71xx/generic/packages">http://downloads.openwrt.org/barrier_br … c/packages</a></p><p>as said, with this config and --force-depends it works but still complains about kernel dependencies<br />&nbsp; kernel (= 3.10.49-1-94831e5bcf361d1c03e87a15e152b0e8)<br />The openvpn server runs however and I can connect to it over lan.<br />My question was just, if there is a bug in the package dependencies as --force-depends is not really a proper way to install packages</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p252836">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">yoyellow</div>
					<div class="post-datetime">
						2 Nov 2014, 14:35					</div>
				</div>
				<div class="post-content content">
					<p>&quot;fun thing&quot; i found out, i tried to install with force-depends, and after a reboot my x86 machine hangs during boot on the openvpn kernel packages...</p><p>also, with every kmod package i try to install i get the same error.</p><p>satisfy_dependencies_for: Cannot satisfy the following dependencies for kmod-usb-hid:<br /> * &nbsp; &nbsp; kernel (= 3.10.49-1-3051dee8f07064b727e9d57fbfeb05ec) *</p><p>what am i doing wrong? this is an own built image, and im trying to install a package from official feed</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p252838">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">metai</div>
					<div class="post-datetime">
						2 Nov 2014, 14:44					</div>
				</div>
				<div class="post-content content">
					<p>Edit for clarity: This is in answer to <strong>mindph</strong></p><p>You needlessly keep experimenting into a wrong direction when you already got the answer from tmo26 above: For whatever reason*, your opkg.conf is wrong, it has the feed for 14.07-rc3 in it, you need to edit it and fill in the correct feeds for 14.07. It needs to look like this:<br /></p><div class="codebox"><pre><code>dest root /
dest ram /tmp
lists_dir ext /var/opkg-lists
option overlay_root /overlay
src/gz barrier_breaker_base http://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/packages/base
src/gz barrier_breaker_luci http://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/packages/luci
src/gz barrier_breaker_packages http://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/packages/packages
src/gz barrier_breaker_routing http://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/packages/routing
src/gz barrier_breaker_telephony http://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/packages/telephony
src/gz barrier_breaker_management http://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/packages/management
src/gz barrier_breaker_oldpackages http://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/packages/oldpackages</code></pre></div><p><em>*) Usually /etc/opkg.conf is not supposed to be preserved through sysupgrades, but you&#039;re not the first one to report that it has been preserved anyway.</em></p>											<p class="post-edited">(Last edited by <strong>metai</strong> on 2 Nov 2014, 15:10)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p252841">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">yoyellow</div>
					<div class="post-datetime">
						2 Nov 2014, 14:47					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>metai wrote:</cite><blockquote><p>You needlessly keep experimenting into a wrong direction when you already got the answer from tmo26 above: For whatever reason*, your opkg.conf is wrong, it has the feed for 14.07-rc3 in it, you need to edit it and fill in the correct feeds for 14.07. It needs to look like this:</p><br /><p><em>*) Usually /etc/opkg.conf is not supposed to be preserved through sysupgrades, but you&#039;re not the first one to report that it has been preserved anyway.</em></p></blockquote></div><br /><p>Mind you, the issue i am having is not the one that mindph seems to have.</p><p>my opkg.conf does indeed say 14.07 (without any RC) thou im trying to install package on an image i built myself (lastest git pull)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p252845">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">metai</div>
					<div class="post-datetime">
						2 Nov 2014, 15:05					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>yoyellow wrote:</cite><blockquote><p>Mind you, the issue i am having is not the one that mindph seems to have.</p></blockquote></div><p>Oh, sorry, I threw you into the same bucket for a second.</p><p>Your problem is a different one: Building OpenWrt yourself gives the kernel a different signature, the signature (as far as I can tell from /include/kernel-defaults.mk) is dependent on the .config, and your .config almost inevitably differs from the one the official builds use. You will probably never be able to satisfy the kernel signature expectations of official feed&#039;s packages with your own kernel.</p><p>So you&#039;d need to compile the packages yourself to have them match your kernel&#039;s signature. However, if you&#039;re already building an image yourself, why not just include the kernel modules you need?</p>											<p class="post-edited">(Last edited by <strong>metai</strong> on 2 Nov 2014, 15:08)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p252846">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">yoyellow</div>
					<div class="post-datetime">
						2 Nov 2014, 15:09					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>metai wrote:</cite><blockquote><div class="quotebox"><cite>yoyellow wrote:</cite><blockquote><p>Mind you, the issue i am having is not the one that mindph seems to have.</p></blockquote></div><p>Oh, sorry, I threw you into the same bucket for a second.</p><p>Your problem is a different one: Building OpenWrt yourself gives the kernel a different signature, the signature is dependent on the .config, and your .config almost inevitably differs from the one the official builds use. You will probably never be able to satisfy the kernel signature expectations of official feed&#039;s packages with your own kernel.</p><p>So you&#039;d need to compile the packages yourself to have them match your kernel&#039;s signature. However, if you&#039;re already building an image yourself, why not just include the kernel modules you need?</p></blockquote></div><br /><br /><p>Thanks thats teh info i needed, shame thou, as im simply experimenting with some packages, and building a new image all the time&nbsp; takes a bit longer. maybe i should just build all the packages with it, let it built overnight or something..</p><p>Still packages should install with --force-depends? or does this do something else..?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p252847">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">metai</div>
					<div class="post-datetime">
						2 Nov 2014, 15:32					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>yoyellow wrote:</cite><blockquote><p>Still packages should install with --force-depends?</p></blockquote></div><p>Yes they should, and yes they will, they just still complain about the dependencies. And I believe you&#039;re good as long as you <em>know</em> the signature is really the only thing that differs between your build and the official one.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p252848">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">yoyellow</div>
					<div class="post-datetime">
						2 Nov 2014, 15:35					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>metai wrote:</cite><blockquote><div class="quotebox"><cite>yoyellow wrote:</cite><blockquote><p>Still packages should install with --force-depends?</p></blockquote></div><p>Yes they should, and yes they will, they just still complain about the dependencies. And I believe you&#039;re good as long as you <em>know</em> the signature is really the only thing that differs between your build and the official one.</p></blockquote></div><p>yea well i tried that and then after a reboot it hangs with difference kmod packages installed</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p252957">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">mindph</div>
					<div class="post-datetime">
						3 Nov 2014, 15:11					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>metai wrote:</cite><blockquote><p>Edit for clarity: This is in answer to <strong>mindph</strong></p><p>You needlessly keep experimenting into a wrong direction when you already got the answer from tmo26 above: For whatever reason*, your opkg.conf is wrong, it has the feed for 14.07-rc3 in it,</p></blockquote></div><p>That is just the problem, the image at <br />&gt;http://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/openwrt-ar71xx-generic-tl-wr1043nd-v2-squashfs-sysupgrade.bin<br />seems to include a config, that&#039;s not working with the signature of the kernel it includes. The image is the actual <strong>stable</strong> one from the wiki page for the WR1043. It&#039;s not the trunk or something experimental. I just thought the stable sould work consistent out of the box. I tried that image after I failed badly to get openvpn to run with the trunk version (which even after using --force-depends failed to have the tun-nodes in /dev/net because the kernel modules fail to load). The stable one installs the right device nodes but still complains about kernel signature.<br />It is possible to get a vpn running with it the stable image, but not without dodging strict dependency requirements.</p>											<p class="post-edited">(Last edited by <strong>mindph</strong> on 3 Nov 2014, 15:15)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>