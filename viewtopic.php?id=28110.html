<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Netgear WNDR3700v2</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 5 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p125255">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">r.schroeder</div>
					<div class="post-datetime">
						12 Jan 2011, 23:07					</div>
				</div>
				<div class="post-content content">
					<p>Hi everyone.</p><p>I yesterday bought a brand new Netgear WNDR3700v2. All my tries to get OpenWrt onto it had no success. Upgrading the firmware through the web interface fails with the following message:</p><p>&quot;Firmware upgrade failed. Please check your file.&quot;</p><p>Has anybody had some success with a WNDR3700v2 so far?</p><p>Thanks in advance.<br />Robin</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125303">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						13 Jan 2011, 10:32					</div>
				</div>
				<div class="post-content content">
					<p>How do you know it&#039;s a V2? Are you using the factory image?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125308">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Borromini</div>
					<div class="post-datetime">
						13 Jan 2011, 11:43					</div>
				</div>
				<div class="post-content content">
					<p>Rename the OpenWrt firmware file to something that looks like a Netgear firmware file. That should work. But first make sure the hardware isn&#039;t any different from the v2 (same chips, I don&#039;t think the amount of flash or RAM should matter).</p>											<p class="post-edited">(Last edited by <strong>Borromini</strong> on 13 Jan 2011, 11:49)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125317">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">r.schroeder</div>
					<div class="post-datetime">
						13 Jan 2011, 16:32					</div>
				</div>
				<div class="post-content content">
					<p>I know that it&#039;s a WNDR3700v2 because it&#039;s printed on the bottom of the router and in the web interface of the original firmware. The FCC ID is PY308300092.</p><p>I already tried to rename the firmware, but that did no change. The error message is the same.</p><p>Then I simply opened the OpenWrt firmware (.img file) with my favourite editor &quot;vi&quot; and edited the first line (added &quot;v2&quot; to the end of the line). Then the error message changes to:</p><p>&quot;Warning! You are trying to upload a NA firmware with English GUI which is different from the world wide you had. Do you still want to continue?&quot;</p><p>When I klick on OK, I get to the upgrade page which includes the following information:</p><p>Current Version&nbsp; &nbsp; 1.0.0.6<br />Uploaded Version&nbsp; &nbsp; OpenWrt.r24045</p><p>I can klick on &quot;Yes&quot; and then I get this message:</p><p>&quot;This firmware file is incorrect! Please get the firmware file again and make sure it is the correct firmware for this product.&quot;</p><p>I don&#039;t know if the hardware is the same on my v2.</p><p>Robin</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125334">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">eleon216</div>
					<div class="post-datetime">
						13 Jan 2011, 19:05					</div>
				</div>
				<div class="post-content content">
					<p>have you tried tftp to flash openwrt?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125338">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">r.schroeder</div>
					<div class="post-datetime">
						13 Jan 2011, 19:39					</div>
				</div>
				<div class="post-content content">
					<p>Yes, i tried to flash with tftp. I used this as a base: <a href="https://forum.openwrt.org/viewtopic.php?pid=103295#p103295">https://forum.openwrt.org/viewtopic.php … 95#p103295</a></p><p>The result is the following:</p><p>.....<br />sent DATA &lt;block=9086, 512 bytes&gt;<br />received ACK &lt;block=9086&gt;<br />sent DATA &lt;block=9087, 512 bytes&gt;<br />received ACK &lt;block=9087&gt;<br />sent DATA &lt;block=9088, 512 bytes&gt;<br />received ACK &lt;block=9088&gt;<br />sent DATA &lt;block=9089, 136 bytes&gt;<br />received opcode=4669 sent DATA &lt;block=9089, 136 bytes&gt;<br />sent DATA &lt;block=9089, 136 bytes&gt;<br />sent DATA &lt;block=9089, 136 bytes&gt;<br />sent DATA &lt;block=9089, 136 bytes&gt;<br />Transfer timed out.</p><p>tftp&gt;</p><p>Then nothing more happens. I waited at least 20 minutes after the transfer, although it said &quot;timed out&quot;.</p><p>Is there another method I can try?</p><p>Thanks,<br />Robin</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125340">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">meta96</div>
					<div class="post-datetime">
						13 Jan 2011, 20:10					</div>
				</div>
				<div class="post-content content">
					<p>... on (pöse)amazon you have two versions (german manual only, international manual), maybe the german only has a different firmware (local check?) ...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125346">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">r.schroeder</div>
					<div class="post-datetime">
						13 Jan 2011, 21:18					</div>
				</div>
				<div class="post-content content">
					<p>I bought the international one (PES). The firmware version is 1.0.0.6, so it must be this one: <a href="http://kb.netgear.com/app/products/model/a_id/17703">http://kb.netgear.com/app/products/model/a_id/17703</a> (WNDR3700v2).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125352">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">ratbug</div>
					<div class="post-datetime">
						13 Jan 2011, 22:38					</div>
				</div>
				<div class="post-content content">
					<p>rename openwrt-wndr3700-***.img to WNDR3700.1.0.0.6.img or whatever the original name is</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125357">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">r.schroeder</div>
					<div class="post-datetime">
						13 Jan 2011, 23:30					</div>
				</div>
				<div class="post-content content">
					<p>The original name for my version of the router would be WNDR3700v2-V1.0.0.6.img. But I already tried that. Didn&#039;t succeed. Neither tftp nor web-interface.</p><p>Robin</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125361">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">KanjiMonster</div>
					<div class="post-datetime">
						14 Jan 2011, 01:01					</div>
				</div>
				<div class="post-content content">
					<p>The WNR3700v2 probably expects differently tagged images, so you need to build your own. Do you have a buildroot ready?</p><p>KM</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125386">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">Borromini</div>
					<div class="post-datetime">
						14 Jan 2011, 08:56					</div>
				</div>
				<div class="post-content content">
					<p>Is there a target for the WNDR3700 v2? Having a buildroot won&#039;t be enough if it doesn&#039;t work with v1 OpenWrt firmwares... You&#039;ll need to patch things.</p>											<p class="post-edited">(Last edited by <strong>Borromini</strong> on 14 Jan 2011, 15:24)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125396">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">juhosg</div>
					<div class="post-datetime">
						14 Jan 2011, 12:13					</div>
				</div>
				<div class="post-content content">
					<p>The firmware image is protected by a checksum value, so it is not possible to edit that with &#039;vi&#039;. I have checked the image of the v2 board, and that indeed uses a different tag. Although it would be possible to generate a firmware image with different tag, however it would not be a good idea to flash that into the board without more information about the underlying hardware.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125403">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">KanjiMonster</div>
					<div class="post-datetime">
						14 Jan 2011, 14:06					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>juhosg wrote:</cite><blockquote><p>The firmware image is protected by a checksum value, so it is not possible to edit that with &#039;vi&#039;. I have checked the image of the v2 board, and that indeed uses a different tag. Although it would be possible to generate a firmware image with different tag, however it would not be a good idea to flash that into the board without more information about the underlying hardware.</p></blockquote></div><p>I briefly looked at the u-boot sources, and at least the switch seems to be the same (using the same GPIOs for SDA/SCK). Also it looks like while the WNDR3700v2 has 16 MB Flash, they only use the first 8 MB; the partition layout defined in u-boot is the same as the one for the WNDR3700v1 (e.g. a ~6MB rootfs).</p><p>So I would guess the probability of the WNDR3700 configuration working for the v2 to be quite high. One might need to define a new MIPS_MACHINE probably.</p><p>KM</p><p><strong>Edit</strong>: In response to the latest commits, it seems to need a new imagetag too; according to the image.h it&#039;s 0x33373031.</p><p><strong>Edit 2</strong>: The LED/Button GPIOs are also the same.</p>											<p class="post-edited">(Last edited by <strong>KanjiMonster</strong> on 14 Jan 2011, 14:22)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125418">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">juhosg</div>
					<div class="post-datetime">
						14 Jan 2011, 15:57					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>KanjiMonster wrote:</cite><blockquote><p>I briefly looked at the u-boot sources, and at least the switch seems to be the same (using the same GPIOs for SDA/SCK). Also it looks like while the WNDR3700v2 has 16 MB Flash, they only use the first 8 MB; the partition layout defined in u-boot is the same as the one for the WNDR3700v1 (e.g. a ~6MB rootfs).</p></blockquote></div><p>That partition layout means nothing. It is not used by the stock kernel at all on the original WNDR3700:<br /></p><div class="codebox"><pre><code>...
   Entry Point:  80297000
   Verifying Checksum ... OK
   Uncompressing Kernel Image ... OK
No initrd
## Transferring control to Linux (at address 80297000) ...
## Giving linux memsize in bytes, 67108864

Starting kernel ...

Linux version 2.6.15 (ronger@ronger-desktop) (gcc version 3.4.4 (OpenWrt-2.0)) #1 Wed Aug 26 18:27:43 CST 2009
flash_size passed from bootloader = 8
CPU revision is: 00019374
Determined physical RAM map:
 memory: 04000000 @ 00000000 (usable)
Built 1 zonelists
Kernel command line: console=ttyS0,115200 root=31:09 rootfstype=squashfs init=/etc/preinit mtdparts=ar7100-nor0:320k(u
boot),128k(env),7296k(rootfs),64k(config),64k(config_bak),64k(pot),64k(traffic_meter),128k(language),64k(caldata),7471
040@458816(mount_fs)
...</code></pre></div><p>Additionally there is no guarantee, that the 16MB flash chip is supported by the m25p80 driver.<br /></p><div class="quotebox"><cite>KanjiMonster wrote:</cite><blockquote><p>So I would guess the probability of the WNDR3700 configuration working for the v2 to be quite high. One might need to define a new MIPS_MACHINE probably.</p></blockquote></div><p>Probably, although the best option would be to test an initramfs image first.</p><p>Gabor</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125573">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">kleptophobiac</div>
					<div class="post-datetime">
						15 Jan 2011, 23:17					</div>
				</div>
				<div class="post-content content">
					<p>The stock build of OpenWRT worked fine for a WNDR3700v2 I bought about two weeks ago. One I bought today did not take it. It leads me to think there may just be a firmware difference that is intended to preclude loading unofficial firmware.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125592">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">juhosg</div>
					<div class="post-datetime">
						16 Jan 2011, 09:26					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>kleptophobiac wrote:</cite><blockquote><p>The stock build of OpenWRT worked fine for a WNDR3700v2 I bought about two weeks ago.</p></blockquote></div><p>Interesting. Can you show the dmesg from that box?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125788">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">sjhwilkes</div>
					<div class="post-datetime">
						18 Jan 2011, 08:45					</div>
				</div>
				<div class="post-content content">
					<p>Exactly the same issue here with a box bought here in California.&nbsp; Googled prior to going to Frys to choose a box that would support open-wrt too...Here&#039;s to hoping one of you with more brains on this stuff than I can figure out a solution...I will read a load tomorrow and see if I can help.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p126000">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">suntsu</div>
					<div class="post-datetime">
						20 Jan 2011, 07:37					</div>
				</div>
				<div class="post-content content">
					<p>I yesterday created a WNDR3700 image from trunk with WNDR3700v2 tag. It seemed like it was flashed alright but the router didn&#039;t seem to boot up. It stopped, it seems, in bootloader, I was able to send images via tftp all the time, but only after sending the original one it worked again.</p><p>I really would like to get this beast running, is there anything I can do to help? I know basic C, can offer a shell to developers on my ubuntu box with access to my router. I don&#039;t have serial or JTAG on this box because it&#039;s only a day old. I could add that next week.</p><p>Regards,<br />SunTsu</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p126065">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">KanjiMonster</div>
					<div class="post-datetime">
						20 Jan 2011, 21:41					</div>
				</div>
				<div class="post-content content">
					<p>FYI, SmallNetBuilder just posted <a href="http://www.smallnetbuilder.com/wireless/wireless-reviews/31396-netgear-wndr3700v2-n600-wireless-dual-band-gigabit-router-reviewed">a review of the WNDR3700v2</a> which confirmes that the only changes are the bigger flash and a change in the antenna layout (resulting in slightly better 2.4Ghz performance and slightly worse 5Ghz performance, according to them).</p><p>KM</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p126068">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">juhosg</div>
					<div class="post-datetime">
						20 Jan 2011, 22:18					</div>
				</div>
				<div class="post-content content">
					<p>If someone is brave enough to try it, here is an experimental patch to generate an image for the v2 board:<br /></p><div class="codebox"><pre><code>diff --git a/target/linux/ar71xx/image/Makefile b/target/linux/ar71xx/image/Makefile
index 5105956..812d956 100644
--- a/target/linux/ar71xx/image/Makefile
+++ b/target/linux/ar71xx/image/Makefile
@@ -635,6 +635,7 @@ endef
 wndr3700_mtdlayout=mtdparts=spi0.0:320k(u-boot)ro,128k(u-boot-env)ro,1024k(kernel),6656k(rootfs),64k(art)ro,7680k@0x70000(firmware)
 define Image/Build/Profile/WNDR3700
     $(call Image/Build/Template/$(fs_64k)/$(1),Netgear,wndr3700,board=WNDR3700,wndr3700_mtdlayout,3700,WNDR3700)
+    $(call Image/Build/Template/$(fs_64k)/$(1),Netgear,wndr3700v2,board=WNDR3700,wndr3700_mtdlayout,3701,WNDR3700v2)
 endef

 define Image/Build/Profile/AP96</code></pre></div><p>The new image still uses the MTD layout of first unit, so it won&#039;t be possible to use the whole 16MB with that. Because the MTD layout can be different on the v2 it would be nice if someone would be able to paste a bootlog with the original firmware.</p><p>Gabor</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p126139">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">bbarrett</div>
					<div class="post-datetime">
						21 Jan 2011, 17:37					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>suntsu wrote:</cite><blockquote><p>I really would like to get this beast running, is there anything I can do to help?</p></blockquote></div><p>Use the scripts linked at the bottom of this page to gain telnet access to the router:<br /><a href="http://www1.chubb.wattle.id.au/PeterChubb/WNDR3700.html">http://www1.chubb.wattle.id.au/PeterChubb/WNDR3700.html</a></p><p>Then telnet into it and post the complete output of the dmesg command here.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p126162">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">sjhwilkes</div>
					<div class="post-datetime">
						21 Jan 2011, 21:26					</div>
				</div>
				<div class="post-content content">
					<p>Mine does not seem to have dmesg present...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p126186">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">hughescr</div>
					<div class="post-datetime">
						22 Jan 2011, 03:09					</div>
				</div>
				<div class="post-content content">
					<p>Confirmed there&#039;s no dmesg in busybox on the device.&nbsp; I&#039;ve downloaded the sources from netgear and am building now.&nbsp; I&#039;ll turn on dmesg in busybox and rebuild then, and see what I can get for you.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p126187">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">suntsu</div>
					<div class="post-datetime">
						22 Jan 2011, 03:09					</div>
				</div>
				<div class="post-content content">
					<p>same here, no dmesg</p><p>I tried above patch, afterwards the image was flashable and it booted. The only problem I had was that it was not pingable once it was booted up. Before that I was able to ping 6 times.<br />So, I prolly have some issues with my .config which I need to fix.</p><p>fun fact: stock image seems to be OpenWRT, too, at least the banner says so.<br />Anything else I can do?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>