<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Thomson TG585v8</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 1 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p333149">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">moham_96</div>
					<div class="post-datetime">
						2 Aug 2016, 23:49					</div>
				</div>
				<div class="post-content content">
					<p>Can i flash this router with openwrt?</p><p>I opened the case and found these chips in it :</p><p>BCM5325EKQMG</p><p>SDRAM: winbond w9825g6eh-75</p><p>FLASH: MX25L6445EMI10G</p><p>Wireless: ralink rt3070l</p><p>Note that this has a completely different hardware than it&#039;s predecessor (TG585v7) which was discussed here <a href="https://forum.openwrt.org/viewtopic.php?id=21489&amp;p=3">https://forum.openwrt.org/viewtopic.php â€¦ 89&amp;p=3</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333545">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">moham_96</div>
					<div class="post-datetime">
						7 Aug 2016, 13:18					</div>
				</div>
				<div class="post-content content">
					<p>Ok I was able to get serial output, it says &quot;CFG 04&quot; can this be used to flash bootloader ?</p><div class="codebox"><pre><code>ROM VER: 1.2.0
CFG 04
EEPROM Data OK
.............................

Version BL: 1.0.6
Multicore disable; Booting Linux kernel

BOOTING THE THOMSON LINUX KERNEL

Starting the kernel @ 0x801f5000 
Extra parameters passed to Linux:
        [0]: Thomson bootloader
        [1]: memsize=0x1FDD000
serial initialized
MC_PRIO = 0xc -&gt; 0xcc
Linux version 2.6.20.19 (buildmgm@dslws-build1.beijing.ap.thmulti.com) (gcc version 3.4.6) #1 Fri Aug 27 14:05:58 CST 2010
CPU revision is: 0001906c
Determined physical RAM map:
 memory: 01fdd000 @ 00002000 (usable)
On node 0 totalpages: 8159
  DMA zone: 63 pages used for memmap
  DMA zone: 0 pages reserved
  DMA zone: 8096 pages, LIFO batch:0
  Normal zone: 0 pages used for memmap
Built 1 zonelists.  Total pages: 8096
Kernel command line: root=/dev/mtdblock2 rootfstype=squashfs
1 MIPSR2 register sets available
Primary instruction cache 8kB, physically tagged, 4-way, linesize 16 bytes.
Primary data cache 8kB, 2-way, linesize 16 bytes.
Synthesized TLB refill handler (20 instructions).
Synthesized TLB load handler fastpath (32 instructions).
Synthesized TLB store handler fastpath (32 instructions).
Synthesized TLB modify handler fastpath (31 instructions).
Setting up vectored interrupts
PID hash table entries: 128 (order: 7, 512 bytes)
mips_hpt_frequency:133333333
r4k_offset: 000208d5(133333)
Using 133.333 MHz high precision timer.
[ifx_asc_init_hardware 1372]: ASC ID = 0x101044c4
[ifx_asc_init_hardware 1374]: TxFIFO size = 16, RxFIFO size = 16
[ifx_asc_init_hardware 1376]: TxFIFO CON = 0x1f01, RxFIFO CON = 0x1f01
Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
Memory: 26868k/32628k available (1705k kernel code, 5760k reserved, 288k data, 112k init, 0k highmem)
Calibrating delay loop... 261.63 BogoMIPS (lpj=130816)
Mount-cache hash table entries: 512
NET: Registered protocol family 16
usbcore: registered new interface driver usbfs
usbcore: registered new interface driver hub
usbcore: registered new device driver usb
NET: Registered protocol family 2
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 1024 (order: 0, 4096 bytes)
TCP bind hash table entries: 512 (order: -1, 2048 bytes)
TCP: Hash tables configured (established 1024 bind 512)
TCP reno registered
Amazon_Se Port Initialization
squashfs: version 3.4 (2008/08/26) Phillip Lougher
squashfs: LZMA suppport for slax.org by jro
JFFS2 version 2.2. (NAND) (C) 2001-2006 Red Hat, Inc.
io scheduler noop registered (default)
ttyS0 at MMIO 0xbe100c00 (irq = 66) is a IFX_ASC
ifx_asc_init: uart init successfully
Infineon Technologies Synchronous Serial Controller (SSC) driver version 1.0.3
ifx_sscAllocConnection: device spi-flash register sucessfully!
Creating 4 MTD partitions on &quot;spi-flash&quot;:
0x00040000-0x00100000 : &quot;userfs&quot;
0x00020000-0x00040000 : &quot;mtdss&quot;
0x001d0000-0x00800000 : &quot;rootfs&quot;
0x00100010-0x001d0000 : &quot;kernel&quot;
mtd: partition &quot;kernel&quot; doesn&#039;t start on an erase block boundary -- force read-only
Infineon Technologies Synchronous SPI flash driver version 1.0.0 
dwc_otg: version 2.40a 10-APR-2006 (ker:20614)
data_fifo[0]=0xbe120000
data_fifo[1]=0xbe121000
data_fifo[2]=0xbe122000
data_fifo[3]=0xbe123000
data_fifo[4]=0xbe124000
data_fifo[5]=0xbe125000
data_fifo[6]=0xbe126000
data_fifo[7]=0xbe127000
data_fifo[8]=0xbe128000
data_fifo[9]=0xbe129000
data_fifo[10]=0xbe12a000
data_fifo[11]=0xbe12b000
data_fifo[12]=0xbe12c000
data_fifo[13]=0xbe12d000
data_fifo[14]=0xbe12e000
data_fifo[15]=0xbe12f000
USB_WLAN_HOST_SUPPORT
DWC_otg: Using DMA mode 
dwc_otg dwc_otg: DWC OTG Controller
dwc_otg dwc_otg: new USB bus registered, assigned bus number 1
dwc_otg dwc_otg: irq 31, io mem 0x00000000
DWC_otg: Init: Port Power? op_state=1
DWC_otg: Init: Power Port (0)
usb usb1: configuration #1 chosen from 1 choice
hub 1-0:1.0: USB hub found
hub 1-0:1.0: 1 port detected
NET: Registered protocol family 26
TCP cubic registered
NET: Registered protocol family 1
NET: Registered protocol family 17
802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;
All bugs added by David S. Miller &lt;davem@redhat.com&gt;
Time: MIPS clocksource has been installed.
VFS: Mounted root (squashfs filesystem) readonly.
Freeing unused kernel memory: 112k freed
dwc_otg_hcd_handle_port_intr=======set hfir ea60 
usb 1-1: new high speed USB device using dwc_otg and address 2
dwc_otg_hcd_handle_port_intr=======set hfir 7530 
usb 1-1: configuration #1 chosen from 1 choice
Algorithmics/MIPS FPU Emulator v1.5
init started:  BusyBox v1.00 (2010.08.27-06:07+0000) multi-call binary
init started:  BusyBox v1.00 (2010.08.27-06:07+0000) multi-call binary
Starting pid 99, console /dev/ttyS0: &#039;/etc/init.d/rcS&#039;
Using /nmon/nmon.ko
nmon: module license &#039;unspecified&#039; taints kernel.
Button: Character device registered successfully.
SWWD: Enable guarding (ticks: 400 threshold: 280)
IPSecControl Character device registered successfully.
NET: Registered protocol family 3
NET: Registered protocol family 9
NET: Registered protocol family 4
NET: Registered protocol family 5
NET: Registered protocol family 18
NET: Registered protocol family 25
modprobe: could not parse modules.dep

modprobe: could not parse modules.dep

Using /lib/modules/rt3070ap.ko
Symbol usb_register_driver is being used by a non-GPL module, which will not be allowed in the future
Please see the file Documentation/feature-removal-schedule.txt in the kernel source tree for more details.
Symbol usb_deregister is being used by a non-GPL module, which will not be allowed in the future
Please see the file Documentation/feature-removal-schedule.txt in the kernel source tree for more details.
usbcore: registered new interface driver rt2870
Device ikanos not present.
Starting pid 257, console /dev/ttyS0: &#039;/bin/sh&#039;
Switching to RUNLEVEL 1 ...
route: SIOC[ADD|DEL]RT: File exists
route: SIOC[ADD|DEL]RT: File exists
linux application start ...
wait for linux_appl to initialize (1)
wait for linux_appl to initialize (2)
wait for linux_appl to initialize (3)
wait for linux_appl to initialize (4)

************* ERROR RECORD *************
000000:00:00.000000
Application NMON started after POWERON.
****************** END *****************

appl_init: BUILD VERIFIED!
dip_init() : button[FACTORY_RESET] has number[1]
End of initialisation
 start storagepl ...
/etc/rc1.d/S45storagepl: 17: /usr/bin/storagepl: not found
 storagepl is started 
checkd start ...
linuxappl: start loading after [  1002ms ]
Could not read ex-RIP, code 0x10003
WARNING: Unknown Parameter Type brgroup
WARNING: Unknown Parameter Type brgroup
wait until configuration load reaches phase 9 (now -1, 1s)
IOCTL: ADSLIOCTL_SET_TMM_SET_DIAG_MODE
wait until configuration load reaches phase 9 (now 3, 2s)
wait until configuration load reaches phase 9 (now 3, 3s)
wait until configuration load reaches phase 9 (now 3, 4s)
wait until configuration load reaches phase 9 (now 3, 5s)
IOCTL: ADSLIOCTL_SET_TMM_SET_DIAG_MODE
IOCTL: ADSLIOCTL_SET_TMM_SET_DIAG_MODE

Username : admin
Password : ***********
------------------------------------------------------------------------

                             ______  Thomson TG585 v8
                         ___/_____/\ 
                        /         /\\  Plusnet 8.2.7.8.DA
                  _____/__       /  \\ 
                _/       /\_____/___ \  Copyright (c) 1999-2010, THOMSON
               //       /  \       /\ \
       _______//_______/    \     / _\/______ 
      /      / \       \    /    / /        /\
   __/      /   \       \  /    / /        / _\__ 
  / /      /     \_______\/    / /        / /   /\
 /_/______/___________________/ /________/ /___/  \ 
 \ \      \    ___________    \ \        \ \   \  /
  \_\      \  /          /\    \ \        \ \___\/
     \      \/          /  \    \ \        \  /
      \_____/          /    \    \ \________\/
           /__________/      \    \  /
           \   _____  \      /_____\/
            \ /    /\  \    /___\/
             /____/  \  \  /
             \    \  /___\/
              \____\/

------------------------------------------------------------------------
{admin}=&gt;help
Following commands are available :

help             : Displays this help information
menu             : Displays menu
?                : Displays this help information
exit             : Exits this shell.
..               : Exits group selection.
saveall          : Saves current configuration.
ping             : Send ICMP ECHO_REQUEST packets.
traceroute       : Send ICMP/UDP packets to trace the ip path.

Following command groups are available :

firewall        service         connection      cwmp            dhcp            
dns             dsd             dyndns          eth             atm             
config          debug           env             expr            grp             
hostmgr         ids             igmp            interface       ip              
ipqos           label           language        mbus            memm            
mlp             nat             ppp             pptp            script          
sntp            software        statecheck      system          systemlog       
tls             tod             tunnel          upgrade         upnp            
user            wireless        xdsl            

{admin}=&gt;</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333553">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">hvdkamer</div>
					<div class="post-datetime">
						7 Aug 2016, 15:26					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m investigating a simalar device: Thomson TG782i. The problem with the Thomson devices is the locking of the bootloader bij the ISP. In your serial output I see no option to stop loading the kernel and get a bootloader prompt.</p><p>The box runs Linux but sourcecode is AFAIK not available. And instead of a normal shell you are dropped in a Thomson shell which hasn&#039;t got access to the needed commandline tools.</p><p>My next step is getting JTAG to work. That is new for me, so it will take a lot of time. But if it works it should be possible to flash a new bootloader and probably a self compiled OpenWRT. Even if xDSL and POTS doesn&#039;t work, the hardware can still be used -- it has a USB port -- for other purposes. It is a waste to throw it in the bin <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />. Even if I don&#039;t get it to work, learning about JTAG is worth the effort...</p><p>Success with your investigation.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333561">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">moham_96</div>
					<div class="post-datetime">
						7 Aug 2016, 16:26					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>hvdkamer wrote:</cite><blockquote><p>I&#039;m investigating a simalar device: Thomson TG782i. The problem with the Thomson devices is the locking of the bootloader bij the ISP. In your serial output I see no option to stop loading the kernel and get a bootloader prompt.</p><p>The box runs Linux but sourcecode is AFAIK not available. And instead of a normal shell you are dropped in a Thomson shell which hasn&#039;t got access to the needed commandline tools.</p><p>My next step is getting JTAG to work. That is new for me, so it will take a lot of time. But if it works it should be possible to flash a new bootloader and probably a self compiled OpenWRT. Even if xDSL and POTS doesn&#039;t work, the hardware can still be used -- it has a USB port -- for other purposes. It is a waste to throw it in the bin <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />. Even if I don&#039;t get it to work, learning about JTAG is worth the effort...</p><p>Success with your investigation.</p></blockquote></div><p>In this page <a href="https://wiki.openwrt.org/doc/hardware/port.serial">https://wiki.openwrt.org/doc/hardware/port.serial</a> it is stated that if the serial mode is &quot;CFG 04&quot; you can send a bootloader code to be flashed and as you can see from my serial output, it does enter &quot;CFG 04&quot; mode so maybe i can send a bootloader to the device! unfortunately i don&#039;t have that much info about this and although i&#039;m ready to brick and throw the device away i want to give it some more tries before i do so</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333567">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">hvdkamer</div>
					<div class="post-datetime">
						7 Aug 2016, 18:29					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>moham_96 wrote:</cite><blockquote><p>if the serial mode is &quot;CFG 04&quot; you can send a bootloader code to be flashed</p></blockquote></div><p>From the manual you linked:</p><div class="quotebox"><blockquote><p>Sometimes by shortcutting some pins, connecting them to ground or to power you can change the serial mode. Some of them can help you to restore the bootloader since they allow you to write directly to memory or load something to ram through the serial connection, which can be useful for restoring a bootloader. Also if the original bootloader is password protected with this method you can replace it with a custom bootloader and bypass it.</p><p>For example in lantiq danube socs the default mode is CFG 01, but changing to CFG 04 which is known as UART mode allows you to upload to ram through the serial connection and automatically execute a bootloader in ascii format through the serial connection.</p><p>It is recommended that you don&#039;t try blindly to shortcut or connect to anything the pins as it can brick the device. Find documentation before doing anything.</p></blockquote></div><p>It mentions Lantiq Danube SoC and you have a Broadcom. Also you didn&#039;t short things to get the CFG 04 string? I think that this part has a different meaning than what you&#039;ve found? Your Thomson shows the bootlader and then immediately starts the kernel. No messages to stop loading the latter. I&#039;m working on another router (Sitecom WLR-6000) and that one you can intterupt. See <a href="http://www.hetlab.tk/downloads/openwrt/bootlog_sitecom_wlr6000_1.txt">this log</a>. The prompt is:</p><div class="codebox"><pre><code>Please choose the operation:
   1: Load system code to SDRAM via TFTP.</code></pre></div><p>In this router you have one second to type a number. And with that you get the options I mentioned in <a href="https://forum.openwrt.org/viewtopic.php?pid=333080#p333080">this thread</a>. In your log I don&#039;t see a question what you want. Have you tried to type a number directly after the fist text appears? Does it do something different than normal. If yes you are on to something...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333725">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">moham_96</div>
					<div class="post-datetime">
						8 Aug 2016, 23:01					</div>
				</div>
				<div class="post-content content">
					<p>@hvdkamer yes i know it says &quot;Lantiq Danube SoC&quot; but i just thought that this rule &#039;might&#039; apply to this router.<br />And no the bootloader doesn&#039;t stop no matter what i press, i think that i have to change the bootloader through JTag</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p334052">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">hvdkamer</div>
					<div class="post-datetime">
						11 Aug 2016, 13:37					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>moham_96 wrote:</cite><blockquote><p>@hvdkamer yes i know it says &quot;Lantiq Danube SoC&quot; but i just thought that this rule &#039;might&#039; apply to this router.</p></blockquote></div><p>In my opinion this seems far fetched. But who knows <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />.</p><div class="quotebox"><cite>moham_96 wrote:</cite><blockquote><p>And no the bootloader doesn&#039;t stop no matter what i press, i think that i have to change the bootloader through JTag</p></blockquote></div><p>That is the point where I am with my Thomson TG782i. I&#039;ve tried to do JTAG via a Raspberry Pi, but that didn&#039;t work. The <a href="http://www.dx.com/p/ft232-ft232rl-usb-to-ttl-module-w-indicator-deep-blue-295929">ordered</a> FT232RL has arrived and hopefully I can get it to <a href="http://vak.ru/doku.php/proj/bitbang/bitbang-jtag">work</a> with OpenOCD. JTAG is new for me, but it looks like the trick for stubborn hardware <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p334072">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">moham_96</div>
					<div class="post-datetime">
						11 Aug 2016, 17:00					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>hvdkamer wrote:</cite><blockquote><p>[<br />That is the point where I am with my Thomson TG782i. I&#039;ve tried to do JTAG via a Raspberry Pi, but that didn&#039;t work. The <a href="http://www.dx.com/p/ft232-ft232rl-usb-to-ttl-module-w-indicator-deep-blue-295929">ordered</a> FT232RL has arrived and hopefully I can get it to <a href="http://vak.ru/doku.php/proj/bitbang/bitbang-jtag">work</a> with OpenOCD. JTAG is new for me, but it looks like the trick for stubborn hardware <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />.</p></blockquote></div><p>wishing you luck, let me know if it worked</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p345052">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">alexxtasi</div>
					<div class="post-datetime">
						27 Nov 2016, 22:07					</div>
				</div>
				<div class="post-content content">
					<p>hi there<br />I have an old TG585 v8 and want to use it as a wireless repeater, but has not such a feature. I am interested in having OpenWRT on it.<br />Since am have no experience in hardware or flashing routers.... I would wait for you :-)</p><p>any news on goal?</p><p>regards</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>