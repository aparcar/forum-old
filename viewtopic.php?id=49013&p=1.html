<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> [HowTo] Openwrt cheap Digital Stereo WiFi Internet Radio &amp; MP3 Player</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 7 Apr 2018 and 5 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 7</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=49013&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=49013&amp;p=3.html">3</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=49013&amp;p=7.html">7</a></li></ul></nav></div>
			
		
		
			<article class="post" id="p225463">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						16 Feb 2014, 14:00					</div>
				</div>
				<div class="post-content content">
					<p><em>edited: 07/01/2017</em></p><p><em><span style="color: red">This is my personal contribution how to create a very cheap digital internet radio and MP3 player, just by using an OpenWRT router e some few other components, without needing to solder anything.</span></em></p><p><em><span style="color: red">In three years I added here a lot of ideas and examples to improve and to enrich the Radio.</span></em></p><p><em><span style="color: red">I hope you like it <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></span></em></p><p><em><span style="color: red">Enjoy listening!</span></em></p><p>Check also my last How To&#039;s: <br />[How To] Openwrt + Asterisk11 + GSM/SMS channel (chan_dongle):<br /><a href="https://forum.openwrt.org/viewtopic.php?pid=253590#p253590">https://forum.openwrt.org/viewtopic.php … 90#p253590</a></p><p>and <br />[How To] Control a simple DIY relay board via internet Web page or SMS:<br /><a href="https://forum.openwrt.org/viewtopic.php?pid=258891#p258891">https://forum.openwrt.org/viewtopic.php … 91#p258891</a></p><p>and<br />[How To] Web SMS server with OpenWRT:<br /><a href="https://forum.openwrt.org/viewtopic.php?id=60910">https://forum.openwrt.org/viewtopic.php?id=60910</a></p><p>-------------------------------------------------------------------------------------------------------------------------------<br /><span style="color: #FF0000">[Updated 16/10/2014] - Added support for Barrier Breaker 14.07 - tested on TP-Link TL-WR710N</span><br />-------------------------------------------------------------------------------------------------------------------------------</p><p>OpenWRT is simply fantastic!</p><p>Wi-Fi Internet radio using small Wi-Fi AP/Router (30 €) , 4 port USB Switch (10 € with clock), 2 GB USB memory stick (5 €) and USB stereo audio adapter (5 €).<br /><strong>No hardware mods needed.</strong></p><p>Note: the router maintains full Wi-Fi/LAN/WAN/3G functionality <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p><span class="postimg"><img src="http://www.lovisolo.com/asterisk/software/openwrt/radio-mp3/P1070077.JPG" alt="http://www.lovisolo.com/asterisk/software/openwrt/radio-mp3/P1070077.JPG" /></span></p><p><span class="postimg"><img src="http://www.lovisolo.com/asterisk/software/openwrt/radio-mp3/P1070089.JPG" alt="http://www.lovisolo.com/asterisk/software/openwrt/radio-mp3/P1070089.JPG" /></span></p><p><span class="postimg"><img src="http://www.lovisolo.com/asterisk/software/openwrt/radio-mp3/P1070140.JPG" alt="http://www.lovisolo.com/asterisk/software/openwrt/radio-mp3/P1070140.JPG" /></span></p><p><span class="postimg"><img src="http://www.lovisolo.com/asterisk/software/openwrt/radio-mp3/P1070245.JPG" alt="http://www.lovisolo.com/asterisk/software/openwrt/radio-mp3/P1070245.JPG" /></span></p><p><span class="postimg"><img src="http://i55.tinypic.com/315hjig.jpg" alt="http://i55.tinypic.com/315hjig.jpg" /></span> <br />USB audio adapter (see <a href="https://mightyohm.com/forum/viewtopic.php?f=2&amp;t=232&amp;start=20">https://mightyohm.com/forum/viewtopic.p … p;start=20</a> for other compatible models)</p><p><span class="postimg"><img src="http://www.memorystock.it/media/catalog/product/cache/1/image/9df78eab33525d08d6e5fb8d27136e95/h/u/hub-nortek-422.jpg" alt="http://www.memorystock.it/media/catalog/product/cache/1/image/9df78eab33525d08d6e5fb8d27136e95/h/u/hub-nortek-422.jpg" /></span><br />USB hub 4 ports (this is unpowered but I would suggest you to use instead a HUB powered with external power supply)</p><br /><p>- VIDEO:</p><p><a href="http://www.youtube.com/watch?v=i5_o6L1cEtM&amp;feature=youtu.be">http://www.youtube.com/watch?v=i5_o6L1c … e=youtu.be</a></p><p>Italian audio:<br /><a href="https://www.youtube.com/watch?v=QfGRs9CtcHQ">https://www.youtube.com/watch?v=QfGRs9CtcHQ</a></p><br /><p><span class="bbu"><strong><br />- Instructions to install USB Overlay on TL-MR3020</strong></span><br /><em>note: for OpenWrt 12.09 &#039;Attitude Adjustment&#039;</em></p><p>Start from <strong>fresh install </strong>or reset to default with command: &quot;<strong>mtd -r erase rootfs_data</strong>&quot; <span style="color: #FF0000"><em><span class="bbu">(*** WARNING - this command will erase all your existing data and configurations! ***)</span></em></span></p><p>Prerequisites:<br />- Set root password and enable ssh<br />- configure network<br />- USB memory key &gt; 1 GB - ext4 formatted</p><p>note: I used a USB key with only one partition (/dev/sda1):</p><p><strong>opkg update<br />opkg install kmod-usb-uhci<br />opkg install kmod-usb-ohci<br />opkg install kmod-usb2<br />opkg install kmod-usb-core kmod-usb-storage usbutils block-mount kmod-fs-ext4 </strong></p><p> <strong>&nbsp; &nbsp;insmod usbcore </strong><br /><strong>&nbsp; &nbsp;insmod uhci&nbsp; </strong><br /><strong>&nbsp; &nbsp;insmod usb-ohci&nbsp; </strong><br /><strong>&nbsp; &nbsp;insmod ehci-hcd&nbsp; </strong></p><p>now reboot the router</p><p>than</p><p><strong>mkdir -p /mnt/share<br />mount -t ext4 /dev/sda1 /mnt/share -o rw,sync<br />tar -C /overlay -cvf - . | tar -C /mnt/share -xf -</strong></p><p>now with &quot;vi&quot; (the most stupid and prehistoric editor in the whole universe) edit &quot;fstab&quot;:</p><p><strong>vi /etc/config/fstab</strong></p><p>delete everything and insert the following lines (ESC+i):<br /><span style="color: #4000FF"><em><br />config global automount<br />&nbsp; &nbsp; &nbsp; &nbsp; option from_fstab 1<br />&nbsp; &nbsp; &nbsp; &nbsp; option anon_mount 1</em></span></p><p><span style="color: #4000FF"><em>config global autoswap<br />&nbsp; &nbsp; &nbsp; &nbsp; option from_fstab 1<br />&nbsp; &nbsp; &nbsp; &nbsp; option anon_swap 0</em></span></p><p><span style="color: #4000FF"><em>config mount<br />&nbsp; &nbsp; &nbsp; &nbsp; option target&nbsp; &nbsp;/overlay<br />&nbsp; &nbsp; &nbsp; &nbsp; option device&nbsp; &nbsp;/dev/sda1<br />&nbsp; &nbsp; &nbsp; &nbsp; option fstype&nbsp; &nbsp;ext4<br />&nbsp; &nbsp; &nbsp; &nbsp; option options&nbsp; rw,sync<br />&nbsp; &nbsp; &nbsp; &nbsp; option enabled&nbsp; 1<br />&nbsp; &nbsp; &nbsp; &nbsp; option enabled_fsck 0</em></span></p><p><span style="color: #4000FF"><em>config swap<br />&nbsp; &nbsp; &nbsp; &nbsp; option device&nbsp; &nbsp;/dev/sda2<br />&nbsp; &nbsp; &nbsp; &nbsp; option enabled&nbsp; 0</em></span></p><br /><p>press &quot;esc&quot; and then type &quot; :wq &quot; followed by &quot;enter&quot; to save.</p><p>Reboot and check if everything is OK with the &quot;df -kh&quot; command:</p><p>root@OpenWrt:~#df -kh<br />Filesystem&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Size&nbsp; &nbsp; &nbsp; Used Available Use% Mounted on<br />rootfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3.5G&nbsp; &nbsp; 122.5M&nbsp; &nbsp; &nbsp; 3.2G&nbsp; &nbsp;4% /<br />/dev/root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2.0M&nbsp; &nbsp; &nbsp; 2.0M&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 100% /rom<br />tmpfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 14.3M&nbsp; &nbsp; 388.0K&nbsp; &nbsp; &nbsp;13.9M&nbsp; &nbsp;3% /tmp<br />tmpfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;512.0K&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; 512.0K&nbsp; &nbsp;0% /dev<br />/dev/sda1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3.5G&nbsp; &nbsp; 122.5M&nbsp; &nbsp; &nbsp; 3.2G&nbsp; &nbsp;4% /overlay<br />overlayfs:/overlay&nbsp; &nbsp; &nbsp; &nbsp; 3.5G&nbsp; &nbsp; 122.5M&nbsp; &nbsp; &nbsp; 3.2G&nbsp; &nbsp;4% /</p><p>-------------------------------------------------------------------------------------------------------------</p><p> <span style="color: #FF0000"><span class="bbu"><em>NEW: Instructions for Barrier Breaker 14.07</em></span> </span><br /><em>note: 8 Mbytes of Flash needed!</em></p><p><strong>opkg update<br />opkg install kmod-usb-uhci<br />opkg install kmod-usb-ohci<br />opkg install kmod-usb2<br />opkg install kmod-usb-core kmod-usb-storage usbutils block-mount kmod-fs-ext4</strong></p><p>Mount the filesystem:</p><p><strong>mkdir /mnt/sda1<br />mount /dev/sda1 /mnt/sda1</strong></p><p>Copy contents from /overlay to usb device:</p><p><strong>tar -C /overlay -cvf - . | tar -C /mnt/sda1 -xf -</strong></p><p>Generate fstab file:</p><p><strong>block detect &gt; /etc/config/fstab</strong></p><p>Edit fstab file:</p><p><strong>vi /etc/config/fstab</strong></p><p>change the target to &#039;/overlay&#039; <br />change enabled option from &#039;0&#039; to &#039;1&#039;</p><p>Do not change UUID or other settings!</p><p>Reboot and check if everything is OK with the &quot;df -kh&quot; command</p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 9 Jan 2017, 00:10)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p225480">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">probono</div>
					<div class="post-datetime">
						16 Feb 2014, 17:31					</div>
				</div>
				<div class="post-content content">
					<p>Yes, I am also developing a project in this area:<br /><a href="https://github.com/probonopd/minikrebs/blob/master/doc/radio.md">https://github.com/probonopd/minikrebs/ … c/radio.md</a></p><p>Also, have a look at squeezelite.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p225608">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						17 Feb 2014, 23:37					</div>
				</div>
				<div class="post-content content">
					<p><span class="postimg"><img src="http://cdn.computeruniverse.net/media/images/300/90481695F2494D0A46D0402F808957CE.jpg" alt="http://cdn.computeruniverse.net/media/images/300/90481695F2494D0A46D0402F808957CE.jpg" /></span></p><p>I&#039;ve just connected a small USB numeric keypad to the router so I can change radio stations just by pressing numbers on keypad (0-9), adjust audio volume with &quot;+&quot; and &quot;-&quot; keys and also a Key to stop playing (the &quot;BS&quot; key).</p><p>References:<br /><a href="http://h-wrt.com/en/doc/sound">http://h-wrt.com/en/doc/sound</a><br /><a href="http://h-wrt.com/en/doc/kb">http://h-wrt.com/en/doc/kb</a><br /><a href="http://wiki.openwrt.org/doc/howto/hardware.button">http://wiki.openwrt.org/doc/howto/hardware.button</a><br /><a href="http://wiki.openwrt.org/doc/howto/usb.essentials">http://wiki.openwrt.org/doc/howto/usb.essentials</a><br /><a href="http://store.jpgottech.com/support/tp-link-mr3020-openwrt-flashing-guide/">http://store.jpgottech.com/support/tp-l … ing-guide/</a><br /><a href="https://mightyohm.com/forum/viewtopic.php?f=2&amp;t=232&amp;start=20">https://mightyohm.com/forum/viewtopic.p … p;start=20</a></p><p><a href="http://www.listenlive.eu/index.html">http://www.listenlive.eu/index.html</a> source for online radio streaming URLs</p><p>-------------------------------------------------------------------------------</p><p>- Instructions (tested on ATTITUDE ADJUSTMENT 12.09 STABLE, r36088 and Barrier Breaker 14.07):</p><p>Note: <span style="color: #FF0000">preconfigured external Overlay USB memory stick of 1 GB or more needed if FLASH &lt; 8 Mbytes!</span></p><p><span class="bbu">Preliminary steps:</span><br /> <span style="color: #FF0000"><em>note: not needed for Barrier Breaker 14.07</em></span></p><p>The first step is to make Hotplug execute scripts in /etc/hotplug.d/button when a button is clicked. Modify /etc/hotplug2.rules — remove &#039;^&#039; before &#039;button&#039; as follow:</p><p><strong>vi /etc/hotplug2.rules</strong></p><p><em><span style="color: #4000FF">[$include /etc/hotplug2-common.rules<br /> SUBSYSTEM ~~ (^net$|^input$|button$|^usb$|^ieee1394$|^block$|^atm$|^zaptel$|^tty$) {<br />&nbsp; &nbsp; exec /sbin/hotplug-call %SUBSYSTEM%<br />}<br /> DEVICENAME == watchdog {<br />&nbsp; &nbsp; exec /sbin/watchdog -t 5 /dev/watchdog<br />&nbsp; &nbsp; next-event</span></em></p><p>press &quot;esc&quot; and then type &quot; :wq &quot; followed by &quot;enter&quot; to save.</p><br /><p><span class="bbu">Installation instructions:</span></p><p>1) Install triggerhappy:</p><p><strong>&nbsp; &nbsp; opkg update<br />&nbsp; &nbsp; opkg install kmod-usb-hid<br />&nbsp; &nbsp; opkg install kmod-hid kmod-hid-generic<br />&nbsp; &nbsp; opkg install triggerhappy</strong></p><p>also install (some packages might be already installed):</p><p> <strong>&nbsp; &nbsp;opkg install kmod-usb-hid kmod-usb-core kmod-ledtrig-usbdev kmod-hid kmod-hid-generic<br />&nbsp; &nbsp;opkg install kmod-sound-core kmod-usb-audio madplay usbutils kmod-sound-cs5535audio <br />&nbsp; &nbsp;opkg install kmod-sound-i8x0 kmod-sound-soc-core usb-modeswitch<br />&nbsp; &nbsp;opkg install kmod-usb-uhci<br />&nbsp; &nbsp;opkg install kmod-button-hotplug<br />&nbsp; &nbsp;opkg install kmod-gpio-button-hotplug<br />&nbsp; &nbsp;opkg install kmod-usb-ohci<br />&nbsp; &nbsp;opkg install kmod-usb2<br />&nbsp; &nbsp;opkg install alsa-utils<br />&nbsp; &nbsp;opkg install alsa-lib&nbsp; &nbsp;</strong></p><p><strong>&nbsp; &nbsp;insmod usbcore</strong><br /><span style="color: #4000FF"><em>note: not needed for Barrier Breaker 14.07</em></span></p><p><strong>&nbsp; &nbsp;insmod uhci</strong><br /><span style="color: #4000FF"><em>note: not needed for Barrier Breaker 14.07</em></span></p><p><strong>&nbsp; &nbsp;insmod usb-ohci </strong><br /><span style="color: #4000FF"><em>note: not needed for Barrier Breaker 14.07</em></span></p><p><strong>&nbsp; &nbsp;insmod ehci-hcd</strong><br /><span style="color: #4000FF"><em>note: not needed for Barrier Breaker 14.07</em></span></p><p>2) launch the following command to find &quot;eventcodes&quot; for available buttons (KEY_LABEL):</p><p>&nbsp; <strong>&nbsp; thd --dump /dev/input/event*</strong></p><p>example:</p><p>root@OpenWrt:~# thd --dump /dev/input/event*<br />EV_KEY&nbsp; &nbsp; KEY_KP5&nbsp; &nbsp; 1&nbsp; &nbsp; /dev/input/event0<br /># KEY_KP5&nbsp; &nbsp; 1&nbsp; &nbsp; command<br />EV_KEY&nbsp; &nbsp; KEY_KP5&nbsp; &nbsp; 2&nbsp; &nbsp; /dev/input/event0<br /># KEY_KP5&nbsp; &nbsp; 2&nbsp; &nbsp; command<br />EV_KEY&nbsp; &nbsp; KEY_KP5&nbsp; &nbsp; 2&nbsp; &nbsp; /dev/input/event0<br /># KEY_KP5&nbsp; &nbsp; 2&nbsp; &nbsp; command<br />EV_KEY&nbsp; &nbsp; KEY_KP5&nbsp; &nbsp; 2&nbsp; &nbsp; /dev/input/event0<br /># KEY_KP5&nbsp; &nbsp; 2&nbsp; &nbsp; command<br />EV_KEY&nbsp; &nbsp; KEY_KP5&nbsp; &nbsp; 0&nbsp; &nbsp; /dev/input/event0<br /># KEY_KP5&nbsp; &nbsp; 0&nbsp; &nbsp; command<br />EV_KEY&nbsp; &nbsp; KEY_KP1&nbsp; &nbsp; 1&nbsp; &nbsp; /dev/input/event0<br /># KEY_KP1&nbsp; &nbsp; 1&nbsp; &nbsp; command<br />EV_KEY&nbsp; &nbsp; KEY_KP1&nbsp; &nbsp; 0&nbsp; &nbsp; /dev/input/event0<br /># KEY_KP1&nbsp; &nbsp; 0&nbsp; &nbsp; command<br />EV_KEY&nbsp; &nbsp; KEY_KP1&nbsp; &nbsp; 1&nbsp; &nbsp; /dev/input/event0<br /># KEY_KP1&nbsp; &nbsp; 1&nbsp; &nbsp; command<br />EV_KEY&nbsp; &nbsp; KEY_KP1&nbsp; &nbsp; 0&nbsp; &nbsp; /dev/input/event0<br /># KEY_KP1&nbsp; &nbsp; 0&nbsp; &nbsp; command</p><p>Note: A value of 1 corresponds to pressing a key, while 2 is generated by holding it; releasing it yields a value of 0.</p><p>3) edit &quot;/etc/triggerhappy/triggers.d/example.conf&quot;&nbsp; as follow (you may need to adjust the&quot;KEY_LABELS&quot; if you use a different keyboard, and change device &quot;PCM&quot; if you use a different USB sound device):</p><p><span style="color: #4000FF"><em><br />#<br />KEY_KP0 1 /usr/bin/killall madplay ; sleep 1 ; /usr/bin/wget -O - <a href="http://icestreaming.rai.it/4.mp3">http://icestreaming.rai.it/4.mp3</a> | /usr/bin/madplay - &amp;<br />KEY_KP1 1 /usr/bin/killall madplay ; sleep 1 ; /usr/bin/wget -O - <a href="http://str30.creacast.com/r101_thema4">http://str30.creacast.com/r101_thema4</a> | /usr/bin/madplay - &amp;<br />KEY_KP2 1 /usr/bin/killall madplay ; sleep 1 ; /usr/bin/wget -O - <a href="http://shoutcast.unitedradio.it:1203">http://shoutcast.unitedradio.it:1203</a> | /usr/bin/madplay - &amp;<br />KEY_KP3 1 /usr/bin/killall madplay ; sleep 1 ; /usr/bin/wget -O - <a href="http://shoutcast.unitedradio.it:1513">http://shoutcast.unitedradio.it:1513</a> | /usr/bin/madplay - &amp;<br />KEY_KP4 1 /usr/bin/killall madplay ; sleep 1 ; /usr/bin/wget -O - <a href="http://bbcwssc.ic.llnwd.net/stream/bbcwssc_mp1_ws-eieuk">http://bbcwssc.ic.llnwd.net/stream/bbcwssc_mp1_ws-eieuk</a> | /usr/bin/madplay - &amp;<br />KEY_KP5 1 /usr/bin/killall madplay ; sleep 1 ; /usr/bin/wget -O - <a href="http://server-10.stream-server.nl:8300">http://server-10.stream-server.nl:8300</a> | /usr/bin/madplay - &amp;<br />KEY_KP6 1 /usr/bin/killall madplay ; sleep 1 ; /usr/bin/wget -O - <a href="http://91.121.164.186:8600">http://91.121.164.186:8600</a> | /usr/bin/madplay - &amp;<br />KEY_KP7 1 /usr/bin/killall madplay ; sleep 1 ; /usr/bin/wget -O - <a href="http://stream.srg-ssr.ch/m/rsj/mp3_128">http://stream.srg-ssr.ch/m/rsj/mp3_128</a> | /usr/bin/madplay - &amp;<br />KEY_KP8 1 /usr/bin/killall madplay ; sleep 1 ; /usr/bin/wget -O - <a href="http://stream.srg-ssr.ch/m/rsc_it/mp3_128">http://stream.srg-ssr.ch/m/rsc_it/mp3_128</a> | /usr/bin/madplay - &amp;<br />KEY_KP9 1 /usr/bin/killall madplay ; sleep 1 ; /usr/bin/wget -O - <a href="http://stream.srg-ssr.ch/m/rsp/mp3_128">http://stream.srg-ssr.ch/m/rsp/mp3_128</a> | /usr/bin/madplay - &amp;<br />KEY_KPMINUS 1 /usr/bin/amixer -q set PCM 2%-<br />KEY_KPPLUS 1 /usr/bin/amixer -q set PCM 2%+<br />#KEY_KPENTER 1<br />#KEY_KPDOT 1<br />#KEY_KPSLASH 1<br />KEY_BACKSPACE 1 /usr/bin/killall madplay<br />#KEY_KPASTERISK 1<br />#<br /># eof</em></span></p><p>- Notes: <br />Keys KEY_KPENTER, KEY_KPDOT, KEY_KPSLASH, KEY_KPASTERISK, are not used in this example but you can use all of them to add more stations or functions, just uncomment them (remove #) and add after &quot;1 &quot; the commands to be executed (with full path!) - if you use more than one command per line, use &quot;;&quot; to separate them.<br />Key &quot;000&quot; cannot be used since it is the same as pressing 0 three times! <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /><br />Key &quot;Num Lock&quot; cannot be used, it does not influence the functionality of other keys if enabled or not, it just switches on/off the led <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> (... actually it does something more)<br />&quot;/usr/bin/killall madplay&quot; is needed to stop all running instances of madplay (if any) before starting the new madplay istance.</p><p>-<strong> Enable triggerhappy on boot with the following command:</strong></p><p>&nbsp; /etc/init.d/triggerhappy enable</p><p>------------------------------------------------------</p><p><span class="bbu">Extra stuffs.</span></p><p>To save anytime your current audio volume level, launch the following command (you could associate it with a key on the keypad):</p><p><strong>/usr/sbin/alsactl -f /etc/alsa0.state store 0 </strong></p><p>and then to restore this on boot, insert the following line in &quot;/etc/rc.local&quot; file, right before the &quot;exit 0&quot; line<br /> <span style="color: #4000FF"><em>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; /usr/sbin/alsactl -f /etc/alsa0.state restore 0<br /> </em></span></p><p>then finally reboot and enjoy your new Digital Stereo Wi-Fi Internet Radio <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p><span class="bbu">Note:</span> <br />to manually &quot;start&quot; and &quot;stop&quot; the Internet Radio, use the following commands:</p><p><strong>&nbsp; /etc/init.d/triggerhappy start </strong><br />to start the radio (mute) waiting for any input from the keypad</p><p><strong>&nbsp; /usr/bin/killall madplay; etc/init.d/triggerhappy stop </strong><br />to stop playing anything and kill triggerhappy daemon</p><p>------------------------------------------------------</p><p>There&#039;s no need to mpc or mpd daemon, nor firewall rules, just USB audio/HID drivers and madplay installed and you have a complete wifi internet radio.</p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 18 Aug 2016, 21:46)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p225638">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						18 Feb 2014, 10:06					</div>
				</div>
				<div class="post-content content">
					<p><strong>Updated video</strong> (with Keypad in action) <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p><a href="https://www.youtube.com/watch?v=FhCqoW731Lg&amp;feature=youtu.be">https://www.youtube.com/watch?v=FhCqoW7 … e=youtu.be</a></p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 19 Feb 2014, 10:34)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p225714">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						19 Feb 2014, 02:22					</div>
				</div>
				<div class="post-content content">
					<p>-------------------------------------------------------------------------------------------------------------------------------<br /><span style="color: #FF0000">[Updated 16/10/2014] - Added support for Barrier Breaker 14.07 - tested on TP-Link TL-WR710N</span><br />-------------------------------------------------------------------------------------------------------------------------------</p><p>I&#039;ve just added another function to my Internet Radio:<span style="color: #FF0000"> <strong>MP3 player</strong> </span><br /><em>Note: <span style="color: #FF0000">preconfigured external Overlay USB memory stick of 1 GB or more is needed!</span></em></p><p>I added this feature because I want to be able to listen to some music also when an internet connection is not available <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>note: there are a lot of how-to&#039;s on this subject, eg. <a href="https://forum.openwrt.org/viewtopic.php?pid=125196#p125196">https://forum.openwrt.org/viewtopic.php … 96#p125196</a> </p><p>I added/updated&nbsp; the following functions:</p><p>- MPD MP3 Player:</p><p>Key &quot;0&quot; = Start MPD and play the first song in playlist<br />Key &quot;.&quot;&nbsp; = jump to next song in playlist and start playing it </p><p>note: You may add &quot;jump to prev song&quot; function on the MP3 player ( &quot;/usr/bin/mpc prev&quot; command) sacrificing one radio channel.</p><p>- Volume:</p><p>Key &quot;Enter&quot; = set the volume at the minimum audible level (about 3%, NIGHT mode)<br />Key &quot;+&quot; increase volume +2%<br />Key&nbsp; &quot;-&quot; decrease volume -2%<br />Key &quot;BS&quot; stop playing </p><p>- Internet Radio:</p><p>added Keys &quot;/&quot; and &quot;*&quot; = two more stations (11 total)</p><p>- Extra feature: </p><p>the MP3 songs can be uploaded into the router using Vsftp server or Samba share (to be installed).</p><p><strong>You can switch anytime from Internet Radio to MP3 player (and vice versa) just by choosing one radio channel or press &quot;0&quot; key for MP3 player</strong> <img src="https://forum.openwrt.org/img/smilies/cool.png" width="15" height="15" alt="cool" /></p><p>Note: pressing the &quot;.&quot; key (next song - MP3 player) when you are listening to Internet Radio, does nothing, it works only when you are in MP3 player mode.</p><p>----------------------------------------------------------------------<br />- Instructions for ATTITUDE ADJUSTMENT 12.09 STABLE, r36088:<br /><strong><br />cd /root<br />opkg update<br />opkg install nano<br />opkg install mpd-mini<br />opkg install mpc<br />mkdir music<br />mkdir playlist<br /></strong></p><br /><p>than edit the &quot;/etc/mpd.conf&quot; to match the following configuration:</p><p><strong>nano /etc/mpd.conf</strong></p><p><span style="color: #4000FF">#<br />music_directory&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;~/music&quot;<br />playlist_directory&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;~/playlist&quot;<br />db_file&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;~/mpd.db&quot;<br />bind_to_address&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;127.0.0.1&quot;<br />port&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;6600&quot;<br />input {<br />&nbsp; &nbsp; &nbsp; &nbsp; plugin &quot;curl&quot;<br />}</span></p><p><span style="color: #4000FF">audio_output {<br />&nbsp; &nbsp; &nbsp; &nbsp; type&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;oss&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;My OSS Device&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; device&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;/dev/dsp&quot;&nbsp; &nbsp; &nbsp; # optional<br />}<br /># eof</span></p><p>Ctrl+x to save</p><br /><p>TriggerHappy configuration file modified &quot;etc/triggerhappy/triggers.d/example.conf&quot;:</p><p><strong>nano etc/triggerhappy/triggers.d/example.conf</strong></p><p><span style="color: #4000FF"># begin of file<br />#<br />## prerequisites: USB support, USB audio, USB hid, usb-modeswitch, sound-core, triggerhappy, madplay, mpd/mpc, asa, alsa-utils, alsa-lib<br />#<br />#<br />## - MP3 Player -<br />#<br />## kill all active players, start MPD, update playlist and play the first song:<br />KEY_KP0 1 /usr/bin/killall madplay mpd ; sleep 1 ; /usr/bin/mpd ; /usr/bin/mpc listall | /usr/bin/mpc add ; /usr/bin/mpc play<br />#<br />## jump to next song in playlist and start playing it:<br />KEY_KPDOT 1 /usr/bin/mpc next<br />#<br />## You may add &quot;jump to prev song&quot; function on the MP3 player ( &quot;/usr/bin/mpc prev&quot; command) sacrificing one radio channel<br />#<br />##&nbsp; - Internet Radio&nbsp; -<br />#<br />## kill all active players, launch madplay and start playing selected streaming URL:<br />KEY_KP1 1 /usr/bin/killall madplay mpd ; sleep 1 ; /usr/bin/wget -O - <a href="http://str30.creacast.com/r101_thema4">http://str30.creacast.com/r101_thema4</a> | /usr/bin/madplay - &amp;<br />KEY_KP2 1 /usr/bin/killall madplay mpd ; sleep 1 ; /usr/bin/wget -O - <a href="http://shoutcast.unitedradio.it:1203">http://shoutcast.unitedradio.it:1203</a> | /usr/bin/madplay - &amp;<br />KEY_KP3 1 /usr/bin/killall madplay mpd ; sleep 1 ; /usr/bin/wget -O - <a href="http://shoutcast.unitedradio.it:1513">http://shoutcast.unitedradio.it:1513</a> | /usr/bin/madplay - &amp;<br />KEY_KP4 1 /usr/bin/killall madplay mpd ; sleep 1 ; /usr/bin/wget -O - <a href="http://bbcwssc.ic.llnwd.net/stream/bbcwssc_mp1_ws-eieuk">http://bbcwssc.ic.llnwd.net/stream/bbcwssc_mp1_ws-eieuk</a> | /usr/bin/madplay - &amp;<br />KEY_KP5 1 /usr/bin/killall madplay mpd ; sleep 1 ; /usr/bin/wget -O - <a href="http://server-10.stream-server.nl:8300">http://server-10.stream-server.nl:8300</a> | /usr/bin/madplay - &amp;<br />KEY_KP6 1 /usr/bin/killall madplay mpd ; sleep 1 ; /usr/bin/wget -O - <a href="http://91.121.164.186:8600">http://91.121.164.186:8600</a> | /usr/bin/madplay - &amp;<br />KEY_KP7 1 /usr/bin/killall madplay mpd ; sleep 1 ; /usr/bin/wget -O - <a href="http://stream.srg-ssr.ch/m/rsj/mp3_128">http://stream.srg-ssr.ch/m/rsj/mp3_128</a> | /usr/bin/madplay - &amp;<br />KEY_KP8 1 /usr/bin/killall madplay mpd ; sleep 1 ; /usr/bin/wget -O - <a href="http://stream.srg-ssr.ch/m/rsc_it/mp3_128">http://stream.srg-ssr.ch/m/rsc_it/mp3_128</a> | /usr/bin/madplay - &amp;<br />KEY_KP9 1 /usr/bin/killall madplay mpd ; sleep 1 ; /usr/bin/wget -O - <a href="http://stream.srg-ssr.ch/m/rsp/mp3_128">http://stream.srg-ssr.ch/m/rsp/mp3_128</a> | /usr/bin/madplay - &amp;<br />KEY_KPASTERISK 1 /usr/bin/killall madplay mpd ; sleep 1 ; /usr/bin/wget -O - <a href="http://shoutcast.unitedradio.it:1115">http://shoutcast.unitedradio.it:1115</a> | /usr/bin/madplay - &amp;<br />KEY_KPSLASH 1 /usr/bin/killall madplay mpd ; sleep 1 ; /usr/bin/wget -O - <a href="http://shoutcast.unitedradio.it:1103">http://shoutcast.unitedradio.it:1103</a> | /usr/bin/madplay - &amp;<br />#<br />## - Volume controls -<br />#<br />## decrease volume -2%:<br />KEY_KPMINUS 1 /usr/bin/amixer -q set PCM 2%-<br />#<br />##&nbsp; increase volume +2%:<br />KEY_KPPLUS 1 /usr/bin/amixer -q set PCM 2%+<br />#<br />##&nbsp; set the volume at the minimum audible level (about 3%, NIGHT mode):<br />KEY_KPENTER 1 amixer -q set PCM 4<br />#<br />## - STOP music -<br />#<br />## Kill all active players and stop music:<br />KEY_BACKSPACE 1 /usr/bin/killall madplay mpd<br />#<br />#end of file</span></p><p>Ctrl+x to save<br />note: you may need to adjust the&quot;KEY_LABELS&quot; if you use a different keyboard and &quot;PCM&quot; if you use a different USB sound device<br />&quot;/usr/bin/killall madplay ; /usr/bin/killall mpd ; sleep 1&quot; is needed to stop all running instances of madplay or mpd (if any) before starting the new madplay or mpd istance.</p><p><span style="color: #FF0000"> Note: put all .mp3 files (filenames without spaces!) in the &quot;/root/music&quot; directory</span></p><p>In case this is a little &quot;single command line&quot; (not recursive) to remove spaces from filenames: <br /><strong>for f in *\ *; do mv &quot;$f&quot; &quot;${f// /_}&quot;; done</strong><br />-----------------------------------------------------------------------------------------------------</p><p><span style="color: #FF0000"><span class="bbu">NEW: Instructions for Barrier Breaker 14.07</span></span><br /><em>Note: <span style="color: #FF0000">preconfigured external Overlay USB memory stick of 1 GB or more is needed!</span></em></p><p><strong>opkg update<br />opkg install nano<br />opkg install mpd<br />opkg install mpc</strong></p><p><strong>nano /root/mp3-player</strong></p><p>insert the following lines:</p><p><span style="color: #4000FF">#!/bin/bash<br />cd /root<br />/usr/bin/mpd<br />/usr/bin/mpc listall<br />/usr/bin/mpc add *.mp3<br />/usr/bin/mpc play</span></p><p>Ctrl+x to save, than</p><p><strong>chmod 777 /root/mp3-player</strong></p><br /><p><strong>nano /root/next</strong></p><p>insert the following lines:</p><p><span style="color: #4000FF">#!/bin/bash<br />cd /root/music<br />/usr/bin/mpc next</span></p><p>Ctrl+x to save, than</p><p><strong>chmod 777 /root/next</strong></p><br /><p><strong>nano /root/prev</strong></p><p>insert the following lines:</p><p><span style="color: #4000FF">#!/bin/bash<br />cd /root/music<br />/usr/bin/mpc prev</span></p><p>Ctrl+x to save, than</p><p><strong>chmod 777 /root/prev</strong></p><br /><p><strong>nano /etc/triggerhappy/triggers.d/example.conf</strong></p><p><span style="color: #4000FF">## prerequisites: USB support, USB audio, USB hid, usb-modeswitch, sound-core, triggerhappy, madplay, mpd/mpc, asa, alsa-utils, alsa-lib<br />#<br />#<br />## - MP3 Player - opkg install mpd mpc<br />#<br />## kill all active players, start MPD, update playlist and play the first song:<br />KEY_NUMLOCK 1 /usr/bin/killall madplay ; /usr/bin/killall mpd ; sleep 1 ; /bin/sh /root/mp3-player - &amp;<br />#<br />## jump to next song in playlist and start playing it:<br />KEY_KPSLASH 1 /bin/sh /root/next - &amp;<br />#<br />## jump to prev song in playlist and start playing it:<br />KEY_KPASTERISK 1 /bin/sh /root/prev - &amp;<br />#</span></p><p>Ctrl+x to save</p><br /><p><strong>nano mpd.conf</strong></p><p>delete everything inside the file and insert the following:</p><p><span style="color: #4000FF">music_directory&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;~/&quot;<br />playlist_directory&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;~/&quot;<br />db_file&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;~/mpd.db&quot;<br />user&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;root&quot;<br />group&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;root&quot;<br />bind_to_address&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;127.0.0.1&quot;<br />port&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;6600&quot;<br />input {<br />&nbsp; &nbsp; &nbsp; &nbsp; plugin &quot;curl&quot;<br />}<br />audio_output {<br />&nbsp; &nbsp; &nbsp; &nbsp; type&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;oss&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;My OSS Device&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; device&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;/dev/dsp&quot;&nbsp; &nbsp; &nbsp; # optional<br />&nbsp; &nbsp; &nbsp; &nbsp; mixer_device&nbsp; &nbsp; &quot;/dev/mixer&quot;&nbsp; &nbsp; # optional<br />&nbsp; &nbsp; &nbsp; &nbsp; mixer_control&nbsp; &nbsp;&quot;PCM&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# optional<br />}<br />buffer_before_play&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;20%&quot;<br />connection_timeout&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;60&quot;<br />max_connections&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;10&quot;<br />max_playlist_length&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;16384&quot;<br />max_command_list_size&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;2048&quot;<br />max_output_buffer_size&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;8192&quot;</span></p><p>Ctrl+x to save and reboot.<br />note: you may need to adjust &quot;PCM&quot; value in mixer_control if you use a different USB sound device</p><p><span style="color: #FF0000"> Note: put all .mp3 files (filenames without spaces!) in the &quot;/root&quot; directory</span></p><p>In case this is a little &quot;single command line&quot; (not recursive) to remove spaces from filenames: <br /><strong>for f in *\ *; do mv &quot;$f&quot; &quot;${f// /_}&quot;; done</strong></p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 18 Jan 2018, 19:32)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p225730">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">written_direcon</div>
					<div class="post-datetime">
						19 Feb 2014, 09:44					</div>
				</div>
				<div class="post-content content">
					<p>Nice, nice work :-)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p225731">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						19 Feb 2014, 10:16					</div>
				</div>
				<div class="post-content content">
					<p>Next feature will be audio recording and storing in MP3 format, either from the input connector of USB audio stick or directly from an internet radio streaming, just by pressing a key! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Stay tuned! <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 20 Oct 2014, 20:21)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p225756">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						19 Feb 2014, 15:03					</div>
				</div>
				<div class="post-content content">
					<p><strong>MPD high CPU load problem.</strong></p><p>MPD (in conjunction with Alsa) has some high CPU load issues due to &quot;sample rate conversion&quot;, this may cause intermittent hangs with consequent router restart, it also has some issues with buffer size too small for the limited transfer rate of the flash memory (audio file skipping):</p><p>This is my &quot;/etc/mpd.conf&quot; file, tuned for best preformances on OpenWrt:</p><p><span style="color: #4000FF">#<br />music_directory&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;~/music&quot;<br />playlist_directory&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;~/playlist&quot;<br />db_file&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;~/mpd.db&quot;<br />bind_to_address&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;127.0.0.1&quot;<br />port&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;6600&quot;<br />input {<br />&nbsp; &nbsp; &nbsp; &nbsp; plugin &quot;curl&quot;<br />}</span></p><p><span style="color: #4000FF">audio_output {<br />&nbsp; &nbsp; &nbsp; &nbsp; type&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;oss&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;My OSS Device&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; device&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;/dev/dsp&quot;&nbsp; &nbsp; &nbsp; # optional<br />}<br /><strong>samplerate_converter&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;internal&quot;<br />audio_buffer_size&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;8192&quot;<br />buffer_before_play&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;25%&quot; # about 2 seconds delay before playing</strong><br /># eof</span></p><p>----------------------------------------------</p><p>To monitor CPU usage use &quot;cpusage&quot; command.</p><p>- Install: <br />opkg update<br />opkg install cpusage</p><p>- Use: <br />cpusage</p><p>- Output:<br />root@OpenWrt:~# cpusage<br />timestamp: 2014-02-19 14.19.13, user:&nbsp; 14.0%, nice:&nbsp; &nbsp;0.0%, system:&nbsp; &nbsp;0.0%, idle:&nbsp; 86.0%, iowait:&nbsp; &nbsp;0.0%, irq:&nbsp; &nbsp;0.0%, softirq:&nbsp; &nbsp;0.0%, <br />timestamp: 2014-02-19 14.19.14, user:&nbsp; 12.0%, nice:&nbsp; &nbsp;0.0%, system:&nbsp; &nbsp;0.0%, idle:&nbsp; 88.0%, iowait:&nbsp; &nbsp;0.0%, irq:&nbsp; &nbsp;0.0%, softirq:&nbsp; &nbsp;0.0%, <br />timestamp: 2014-02-19 14.19.15, user:&nbsp; 11.0%, nice:&nbsp; &nbsp;0.0%, system:&nbsp; &nbsp;1.0%, idle:&nbsp; 87.0%, iowait:&nbsp; &nbsp;0.0%, irq:&nbsp; &nbsp;0.0%, softirq:&nbsp; &nbsp;1.0%, <br />timestamp: 2014-02-19 14.19.16, user:&nbsp; &nbsp;9.0%, nice:&nbsp; &nbsp;0.0%, system:&nbsp; &nbsp;3.0%, idle:&nbsp; 88.0%, iowait:&nbsp; &nbsp;0.0%, irq:&nbsp; &nbsp;0.0%, softirq:&nbsp; &nbsp;0.0%, <br />timestamp: 2014-02-19 14.19.17, user:&nbsp; 12.0%, nice:&nbsp; &nbsp;0.0%, system:&nbsp; &nbsp;1.0%, idle:&nbsp; 86.0%, iowait:&nbsp; &nbsp;0.0%, irq:&nbsp; &nbsp;0.0%, softirq:&nbsp; &nbsp;1.0%, <br />timestamp: 2014-02-19 14.19.18, user:&nbsp; 13.9%, nice:&nbsp; &nbsp;0.0%, system:&nbsp; &nbsp;0.0%, idle:&nbsp; 85.1%, iowait:&nbsp; &nbsp;0.0%, irq:&nbsp; &nbsp;0.0%, softirq:&nbsp; &nbsp;1.0%, <br />timestamp: 2014-02-19 14.19.19, user:&nbsp; 11.0%, nice:&nbsp; &nbsp;0.0%, system:&nbsp; &nbsp;0.0%, idle:&nbsp; 88.0%, iowait:&nbsp; &nbsp;0.0%, irq:&nbsp; &nbsp;0.0%, softirq:&nbsp; &nbsp;1.0%, <br />timestamp: 2014-02-19 14.19.19, user:&nbsp; 10.0%, nice:&nbsp; &nbsp;0.0%, system:&nbsp; &nbsp;2.5%, idle:&nbsp; 85.0%, iowait:&nbsp; &nbsp;0.0%, irq:&nbsp; &nbsp;0.0%, softirq:&nbsp; &nbsp;2.5%, <br />.<br />.<br />.<br />^C</p><p><strong>use Ctrl+c to stop reading data, then you will see the summary report:</strong></p><p>---Summary----<br />Min: timestamp: 2014-02-19 14.19.19, user:&nbsp; &nbsp;9.0%, nice:&nbsp; &nbsp;0.0%, system:&nbsp; &nbsp;0.0%, idle:&nbsp; 85.0%, iowait:&nbsp; &nbsp;0.0%, irq:&nbsp; &nbsp;0.0%, softirq:&nbsp; &nbsp;0.0%, <br />Max: timestamp: 2014-02-19 14.19.19, user:&nbsp; 14.0%, nice:&nbsp; &nbsp;0.0%, system:&nbsp; &nbsp;3.0%, idle:&nbsp; 88.0%, iowait:&nbsp; &nbsp;0.0%, irq:&nbsp; &nbsp;0.0%, softirq:&nbsp; &nbsp;2.5%, <br />Avg: timestamp: 2014-02-19 14.19.19, user:&nbsp; 11.4%, nice:&nbsp; -0.0%, system:&nbsp; &nbsp;0.9%, idle:&nbsp; 86.9%, iowait:&nbsp; -0.0%, irq:&nbsp; -0.0%, softirq:&nbsp; &nbsp;0.8%,</p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 1 Mar 2014, 11:02)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p225776">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						19 Feb 2014, 18:41					</div>
				</div>
				<div class="post-content content">
					<p>-----------------<br />Audio recorder<br />-----------------</p><p>I want to share with you my progress <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p><strong>opkg update<br />opkg install ffmpeg </strong></p><p><span style="color: #FF0000">Note: [BUG] ffmpeg can&#039;t install if you have already installed mpd/mpc, you should install ffmpeg first! </span> <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /> <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /> <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>After a long searching I came up with this &quot;full path &amp; single line&quot; command to be associated to a key to record MP3 audio coming from the input connector of the USB audio device (mic input) and also with adding the timestamp to the filename:</p><p><strong>now=$(date +&quot;%Y-%m-%d----%H-%M-%S&quot;) ; /usr/bin/ffmpeg -f&nbsp; oss -ar 44100 -i /dev/dsp -acodec mp2 -ab&nbsp; 128k record.$now.mp3</strong></p><p>The out file name is:&nbsp; &quot;record.year-month-day---hours-minutes-seconds.mp3&quot; (eg. record.2014-02-21---11-29-51.mp3) </p><br /><p>command to stop recording:</p><p><strong>/usr/bin/killall - ffmpeg</strong></p><p>note: &quot;killall -&quot; = Sends a SIGTERM signal initially and then sends a SIGKILL signal to all processes that survive for 30 seconds after receipt of the signal first sent. This gives processes that catch the SIGTERM signal an opportunity to clean up.</p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 12 Nov 2015, 09:44)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p225872">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						20 Feb 2014, 21:57					</div>
				</div>
				<div class="post-content content">
					<p>Another discovery <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>if you connect a USB mouse you&#039;ll have two or three more buttons (it depends on how many buttons the mouse has):</p><p>BTN_LEFT<br />BTN_RIGHT<br />BTN_MIDDLE</p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 29 Oct 2014, 14:04)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p225882">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">King0fK0ng</div>
					<div class="post-datetime">
						20 Feb 2014, 23:55					</div>
				</div>
				<div class="post-content content">
					<p>Here is a picture of my internet radio build:</p><p>$80 shipped on sale. I have a Pogoplug running Logitech Media Server to serve up Pandora and local mp3/flac.</p><p><span class="postimg"><img src="http://ecx.images-amazon.com/images/I/81BQDT9GgcL.jpg" alt="http://ecx.images-amazon.com/images/I/81BQDT9GgcL.jpg" /></span></p><p>Joking aside. Awesome work, but a little dated now considering the cost of brand name manufactured internet radio now.</p><p>However I understand you didn&#039;t do this for practical reasons. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>											<p class="post-edited">(Last edited by <strong>King0fK0ng</strong> on 20 Feb 2014, 23:56)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p225887">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						21 Feb 2014, 00:31					</div>
				</div>
				<div class="post-content content">
					<p>I will use this project in conjunction with my hand-made Hi-Fi vacuum tube ampilfiers <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />Future and past tecnologies together!</p><p>All designed and hand made by myself using almost all recovered parts (except tubes) <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p><strong>&quot;WiFi Internet Digital Vacuum Tubes Radio&quot;</strong>, I&#039;m sure you can&#039;t buy anything similar <img src="https://forum.openwrt.org/img/smilies/lol.png" width="15" height="15" alt="lol" /><br />No LCD or super LED display, just old style original &quot;Magic Eye&quot; tubes.</p><p><span class="postimg"><img src="http://www.lovisolo.com/valvole/ampli1.jpg" alt="http://www.lovisolo.com/valvole/ampli1.jpg" /></span></p><p><span class="postimg"><img src="http://www.lovisolo.com/valvole/ampli3.jpg" alt="http://www.lovisolo.com/valvole/ampli3.jpg" /></span></p><p><span class="postimg"><img src="http://i44.servimg.com/u/f44/17/14/70/27/p1040416.jpg" alt="http://i44.servimg.com/u/f44/17/14/70/27/p1040416.jpg" /></span></p><p><span class="postimg"><img src="http://i44.servimg.com/u/f44/17/14/70/27/p1040415.jpg" alt="http://i44.servimg.com/u/f44/17/14/70/27/p1040415.jpg" /></span></p><p><span class="postimg"><img src="http://www.lovisolo.com/valvole/807.jpg" alt="http://www.lovisolo.com/valvole/807.jpg" /></span></p><p><span class="postimg"><img src="http://i34.servimg.com/u/f34/17/14/70/27/ampli-10.jpg" alt="http://i34.servimg.com/u/f34/17/14/70/27/ampli-10.jpg" /></span></p><p> <span class="postimg"><img src="http://i44.servimg.com/u/f44/17/14/70/27/p1030721.jpg" alt="http://i44.servimg.com/u/f44/17/14/70/27/p1030721.jpg" /></span></p><p><span class="postimg"><img src="http://i44.servimg.com/u/f44/17/14/70/27/p1030818.jpg" alt="http://i44.servimg.com/u/f44/17/14/70/27/p1030818.jpg" /></span><br /><strong>Note the USB connector on the tube board <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></strong></p><br /><p><span class="postimg"><img src="http://i44.servimg.com/u/f44/17/14/70/27/stereo11.jpg" alt="http://i44.servimg.com/u/f44/17/14/70/27/stereo11.jpg" /></span></p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 21 Feb 2014, 01:18)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p226028">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">BigD</div>
					<div class="post-datetime">
						23 Feb 2014, 04:28					</div>
				</div>
				<div class="post-content content">
					<p>Concerning the recording function.&nbsp; Have you considered using the opus codec (<a href="http://www.opus-codec.org">http://www.opus-codec.org</a>)?&nbsp; It has a fixed point implementation which is promising.&nbsp; When I tried to stream recorded audio a couple of years ago,&nbsp; the codec I tried to use (vorbis) was too taxing for the poor little router, but it wasn&#039;t a fixed point codec.&nbsp; </p><p>You might be more successful. </p><p>Best of luck!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p226114">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						23 Feb 2014, 23:40					</div>
				</div>
				<div class="post-content content">
					<p>Great collection of Radio&#039;s streaming URLs:</p><p><a href="http://arts-humanities.squidoo.com/second-life-streaming-radio-stations">http://arts-humanities.squidoo.com/seco … o-stations</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p226563">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						1 Mar 2014, 11:07					</div>
				</div>
				<div class="post-content content">
					<p>This How-To has been reviewed and updated today, I corrected some typos, added more instructions and detailed configurations. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 1 Mar 2014, 11:08)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p226740">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						3 Mar 2014, 23:26					</div>
				</div>
				<div class="post-content content">
					<p>I added several functions: </p><p><a href="http://www.youtube.com/watch?v=cg18hvhIn4E&amp;feature=youtu.be">http://www.youtube.com/watch?v=cg18hvhI … e=youtu.be</a></p><p><img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></p><p><span class="postimg"><img src="https://scontent-a-mxp.xx.fbcdn.net/hphotos-prn1/t1/1975269_766677970011951_1412693843_n.jpg" alt="https://scontent-a-mxp.xx.fbcdn.net/hphotos-prn1/t1/1975269_766677970011951_1412693843_n.jpg" /></span></p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 4 Mar 2014, 13:51)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p247945">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">bundevski</div>
					<div class="post-datetime">
						24 Sep 2014, 19:27					</div>
				</div>
				<div class="post-content content">
					<p>Wow I am impressed. I am planning to replicate your setup. My Modem is Huawei E3531s-2... <br />Can you please post instructions how to make this setup. </p><p>Also is it possible to use old USB stick (128MB) to be used as storage for file system (openwrt) ?</p><p><img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p251162">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						19 Oct 2014, 11:19					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve just updated the How To, I added instructions for Barrier Breaker 14.07 (tested on TP-Link TL-WR710N) and corrected some typos.<br /><img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>P.S.: I also successfully tested this audio device:</p><p><span class="postimg"><img src="http://www.music4company.com/images/Products/0-5ce1deb0-500.jpg" alt="http://www.music4company.com/images/Products/0-5ce1deb0-500.jpg" /></span></p><p>please note you need to modify configuration files to adapt device name (from &quot;PCM&quot; to &quot;Speaker&quot;) , check it with command &quot;alsamixer&quot;.</p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 22 Oct 2014, 17:13)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p251322">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						20 Oct 2014, 19:47					</div>
				</div>
				<div class="post-content content">
					<p><span class="bbu">Addendum:</span></p><p>in case you use Tp-Link TL-WR710N or any other router that has at least 8 MB of flash, and you don&#039;t want or can&#039;t use an external HDD overlay, but you want to add the MP3 player functionality to your OpenWrt Internet Radio, you can also use &quot;madplay&quot; for this function.</p><p>This &quot;single line command&quot; searches for .mp3 files in &quot;/root&quot; directory (or anywhere else if you adapt the path) and plays mp3 files in sequence:</p><p><strong>find /root/ -name \*[mM][Pp]3 | awk &#039;{print &quot;\&quot;&quot;$0&quot;\&quot;&quot;}&#039; | xargs madplay</strong></p><p>The bad news is there aren&#039;t the &quot;prev&quot; and &quot;next&quot; functions that you can have with mpd/mpc,<br />the good news is that madplay uses much less resources than mpd/mpc.</p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 20 Oct 2014, 20:09)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p251367">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						21 Oct 2014, 00:58					</div>
				</div>
				<div class="post-content content">
					<p>-----------------------------<br />Another extra-feature <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />-----------------------------</p><p>1) connect anytime an USB flash drive, fat32 formatted, with a lot of mp3 inside<br />2) press a &quot;key&quot; to start playing all mp3 in sequence<br />3) listen ... <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></p><p>Note: I choosed Fat32 to have full Windows/Mac/Linux compatibility and to avoid any file permission problems I could have with EXT or NTFS partitions (FAT32 formatted drives do not support file permissions <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /> ).</p><br /><p><span class="bbu">Instructions:</span></p><p><strong>opkg update<br />opkg install kmod-fs-vfat kmod-nls-cp437 kmod-nls-iso8859-1</strong></p><p>create and edit the &quot;/root/mount.sh&quot; file:</p><p><strong>nano /root/mount.sh</strong></p><p><em><span style="color: #4000FF">mkdir -p /mnt/music<br />mount -t vfat <span class="bbu">/dev/sdb1</span> /mnt/music<br />find /mnt/music -name \*[mM][Pp]3 | awk &#039;{print &quot;\&quot;&quot;$0&quot;\&quot;&quot;}&#039; | xargs madplay</span></em></p><p>Ctrl+x to save </p><p>Note: adapt &quot;/dev/sdb1&quot; to match your configuration.</p><p><strong>chmod 777 /root/mount.sh</strong></p><p>than attach the following &quot;single command line MP3 player&quot; to a key:</p><p><strong>/bin/sh /root/mount.sh - &amp;</strong> </p><p>triggerhappy configuration example: </p><p><em><span style="color: #4000FF">KEY_BACKSPACE 1 /usr/bin/killall madplay ; /usr/bin/killall mpd ; sleep 2 ; /bin/sh /root/mount.sh - &amp;</span></em></p><p>Note:&nbsp; &quot;/usr/bin/killall madplay ; /usr/bin/killall mpd ; sleep 2&quot; is needed to stop all running instances of madplay or mpd (if any) before starting the new madplay istance.</p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 21 Oct 2014, 19:53)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p251506">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						21 Oct 2014, 23:19					</div>
				</div>
				<div class="post-content content">
					<p>------------------------<br /><span style="color: #FF0000">Audio normalization</span><br />------------------------<br />I noticed that Internet Streaming Radio Stations use different audio volume levels one from each other, some of them have audio volume too high, some others too low, in consequence of that I have to adjust volume level too much frequently, same for MP3 files. <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>So, I came up with the idea to normalize the audio level on the fly <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Actually it is quite simple, for madplay it is enough to add two options in the command line, for MPD/MPC it is just a matter to enable an option in the config file.</p><p>- <span class="bbu">Example to enable audio normalization for madplay:</span></p><p><em><span style="color: #4000FF">/usr/bin/wget -O - <a href="http://205.164.62.15:9010/">http://205.164.62.15:9010/</a> | /usr/bin/madplay </span> <span style="color: #FF0000">--replay-gain=audiophile --attenuate=-0</span><span style="color: #4000FF"> - &amp;</span></em></p><p>note: you can also do some fine tuning for each preset station by using &quot;attenuate&quot; or &quot;amplify&quot; options:</p><p>ex:<br /><em><span style="color: #4000FF">/usr/bin/wget -O - <a href="http://205.164.62.15:9010/">http://205.164.62.15:9010/</a> | /usr/bin/madplay </span> <span style="color: #FF0000">--replay-gain=audiophile --attenuate=-2</span><span style="color: #4000FF"> - &amp;</span></em></p><p><em><span style="color: #4000FF">/usr/bin/wget -O - <a href="http://205.164.62.15:9010/">http://205.164.62.15:9010/</a> | /usr/bin/madplay </span> <span style="color: #FF0000">--replay-gain=audiophile --amplify=+1</span><span style="color: #4000FF"> - &amp;</span></em></p><p>just to be safe:<br /><strong>opkg update<br />opkg install lame</strong></p><p>- <span class="bbu">Enable normalization for MPD/MPC:</span></p><p><strong>nano /etc/mpd.conf</strong></p><p>change the following line:<br /><em><span style="color: #4000FF">#volume_normalization&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;no&quot;</span></em></p><p>to:<br /><em><span style="color: #4000FF">volume_normalization&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="color: #FF0000">&quot;yes&quot;</span></em></p><p>--------------------------</p><p>Note: <em>Audio normalization is the application of a constant amount of gain to an audio recording to bring the average or peak amplitude to a target level.<br />The standard used to normalize audio is &quot;ReplayGain.<br />ReplayGain is a proposed standard published by David Robinson in 2001 to measure the perceived loudness of audio in computer audio formats such as MP3 and Ogg Vorbis. It allows players to normalize loudness for individual tracks or albums. This avoids the common problem of having manually to adjust volume levels between tracks when playing audio files from albums that have been mastered at different loudness levels&quot;</em></p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 29 Oct 2014, 15:56)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p251531">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						22 Oct 2014, 01:14					</div>
				</div>
				<div class="post-content content">
					<p>---------------<br />Suggestions<br />---------------</p><p>If you have problems playing mp3s with spaces in the file name, this is a little &quot;single command line&quot; (not recursive) to remove spaces from filenames and convert them to underscores:</p><p><strong>for f in *\ *; do mv &quot;$f&quot; &quot;${f// /_}&quot;; done</strong></p><p>To upload mp3s to the router you can use samba share or ftp, I would suggest ftp, samba is too heavy.</p><p>Install ftp server:</p><p><strong>opkg update<br />opkg install vsftpd</strong></p><p><strong>/etc/init.d/vsftpd enable<br />/etc/init.d/vsftpd start<br /></strong></p><p>connect to ftp server using the following credentials: </p><p>ftp server: router_IP<br />port: 21 tcp (passive mode)<br />user id: root<br />password: root_password</p><p>note: destination directory = /root</p><p>-----------------------------------------------</p><p><span style="color: #FF0000">[BUG - OpenWrt 12.09 &#039;Attitude Adjustment&#039;]</span></p><p>I wanted to disable &quot;watchdog&quot; because the router rebooted too frequently.<br />I tried to &quot;killall watchdog&quot; or execute the &quot;/etc/init.d/watchdog stop&quot; in command line, but it didn&#039;t work.<br />Also /etc/init.d/watchdog disable had no effect, after rebooting watchdog were still running.</p><p>Solution:<br />-----------</p><p>Comment out (#) the watchdog lines in &#039;/etc/hotplug2.rules&#039;:</p><p>#DEVICENAME == watchdog {<br />#&nbsp; &nbsp; &nbsp; &nbsp; exec /sbin/watchdog -t 5 /dev/watchdog<br />#&nbsp; &nbsp; &nbsp; &nbsp; next-event<br />#}</p><p>Than:</p><p><strong>/etc/init.d/watchdog disable<br />/etc/init.d/watchdog stop</strong></p><p>In case you want to enable again watchdog on startup use:</p><p><strong>/etc/init.d/watchdog enable</strong></p><p>--------------------------------------------------------------</p><p>Still to do:</p><p>1) Web page or Luci module to easily modify preset radio stations and upload/rename/delete MP3 files (next)<br />2) Simple and cheap USB LCD display to show stations and songs informations (near)<br />3) FM and/or DVB-T radio OpenWrt functionality (far away)</p><p><strong>Any help will be greatly appreciated!</strong> <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>I also wanted to add bluetooth speakers but I abandoned the idea after weeks of testing, bluetooth does not work in OpenWrt, is badly broken, there is no way to pair and connect any device! <img src="https://forum.openwrt.org/img/smilies/mad.png" width="15" height="15" alt="mad" /> (dead)</p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 29 Oct 2014, 15:18)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p251563">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						22 Oct 2014, 10:28					</div>
				</div>
				<div class="post-content content">
					<p>You&#039;ll find my &quot;ready to use&quot; configuration files here:</p><p><a href="http://www.lovisolo.com/openwrt">http://www.lovisolo.com/openwrt</a></p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 22 Oct 2014, 10:35)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p252400">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						29 Oct 2014, 12:55					</div>
				</div>
				<div class="post-content content">
					<p>Another discovery <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Up to now to increase or decrease the audio volume you should press the + or - buttons several times, for each press you can change about 1% of it, but if you keep the buttons pressed nothing happens.</p><p>To increase or decrease audio volume continuously by keeping pressed the + and - keys you need to add the following two lines to the triggerhappy configuration file (/etc/triggerhappy/triggers.d/example.conf):</p><p><span style="color: #4000FF"><em>KEY_KPPLUS <strong>2</strong> /usr/bin/amixer -q set Speaker 1dB+<br />KEY_KPMINUS&nbsp; <strong>2</strong> /usr/bin/amixer -q set Speaker 1dB-</em></span></p><p>this is the complete section of audio volume controls:</p><p><span style="color: #4000FF"><em># set volume control to minumun addible level<br />KEY_BACKSPACE 1 /usr/bin/amixer -q set Speaker 4<br />#<br /># Volume controls<br />KEY_KPMINUS 1 /usr/bin/amixer -q set Speaker 1%-<br />KEY_KPPLUS 1 /usr/bin/amixer -q set Speaker 1%+<br />KEY_KPPLUS 2 /usr/bin/amixer -q set Speaker 1dB+<br />KEY_KPMINUS 2 /usr/bin/amixer -q set Speaker 1dB-<br />#<br /># Stop playing<br />KEY_KPENTER 1 /usr/bin/killall madplay ; /usr/bin/killall mpd</em></span></p><p>Note: A value of KEY_xxxxx <strong>1</strong> corresponds to pressing a key, while <strong>2</strong> is generated by holding it; releasing it yields a value of <strong>0</strong>.<br />By using of set 1% value, instead of 2% as per my previous posts, allows a more granular control over the audio volume level.&nbsp; </p><p><span style="color: #FF0000">You might need to change &quot;Speaker&quot; device name if you use a different USB sound card.</span></p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 30 Oct 2014, 21:55)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p252401">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						29 Oct 2014, 13:11					</div>
				</div>
				<div class="post-content content">
					<p><span class="bbu">Summarizing:</span></p><p>this audio device needs &quot;Speaker&quot; device name:</p><p><span class="postimg"><img src="http://www.music4company.com/images/Products/0-5ce1deb0-500.jpg" alt="http://www.music4company.com/images/Products/0-5ce1deb0-500.jpg" /></span></p><p>this other needs &quot;PCM&quot; device name:</p><p><span class="postimg"><img src="http://i55.tinypic.com/315hjig.jpg" alt="http://i55.tinypic.com/315hjig.jpg" /></span></p><p>Other USB audio devices might need different device name (check it with command <strong>alsamixer</strong> under &quot;Item:.....&quot;)</p><p>A good list of USB-audio adapters known to work with OpenWrt/mpd:<br /><a href="https://mightyohm.com/forum/viewtopic.php?f=2&amp;t=232">https://mightyohm.com/forum/viewtopic.php?f=2&amp;t=232</a></p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 29 Oct 2014, 14:22)</p>
									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 1 of 7</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=49013&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=49013&amp;p=3.html">3</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=49013&amp;p=7.html">7</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0.001 -->

</body>
</html>