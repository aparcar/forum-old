<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Support for Marvell 88F5xx81 based routers</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 18 Jan 2014 and 6 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 23 of 46</div><nav><ul><li><a href="viewtopic.php%3Fid=12358&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=12358&amp;p=21.html">21</a></li><li><a href="viewtopic.php%3Fid=12358&amp;p=22.html">22</a></li><li class="pagination-current"><span>23</span></li><li><a href="viewtopic.php%3Fid=12358&amp;p=24.html">24</a></li><li><a href="viewtopic.php%3Fid=12358&amp;p=25.html">25</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=12358&amp;p=46.html">46</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p95690">
				<div class="post-metadata">
					<div class="post-num">Post #551</div>
					<div class="post-author">operron</div>
					<div class="post-datetime">
						10 Oct 2009, 18:57					</div>
				</div>
				<div class="post-content content">
					<p>maddes has released a new build (17986) 3 days ago. I did a sysupgrade on my router&nbsp; (which went very well by the way) but unfortunately I was unable to get wifi working with that build.<br />So another sysuprgade later I was back with build 17650 and wifi working again.<br />Anyone with a similar experience (or a working wifi with maddes build 17986) ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p95715">
				<div class="post-metadata">
					<div class="post-num">Post #552</div>
					<div class="post-author">fatbob</div>
					<div class="post-datetime">
						11 Oct 2009, 14:27					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>fatbob wrote:</cite><blockquote><p>Currently I&#039;m looking at a D-Link DWA-547 PCI card (Atheros AR5416 chipset 802.11b/g/n) which suspiciously looks like it has an oversized mini-pci card under the cover. I haven&#039;t yet found a way to confirm this though... What do you think?</p></blockquote></div><p>It&#039;s <strong>not</strong> a mini-pci card on the above mentioned card. Found an FCC ID and the internal photos show this: <a href="https://fjallfoss.fcc.gov/prod/oet/forms/blobs/retrieve.cgi?attachment_id=701680&amp;native_or_pdf=pdf">https://fjallfoss.fcc.gov/prod/oet/form … or_pdf=pdf</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p95717">
				<div class="post-metadata">
					<div class="post-num">Post #553</div>
					<div class="post-author">maddes.b</div>
					<div class="post-datetime">
						11 Oct 2009, 15:26					</div>
				</div>
				<div class="post-content content">
					<p>If you want to go for a new build/revision for the wrt350n v2.x, then <a href="https://forum.openwrt.org/viewtopic.php?pid=82410#p82410">remember</a> that you can test without flashing via tftpboot, <strong>if</strong> you have serial access to router.<br />With a ramdisk image you can test boot, wlan/wifi and lan, which should be the first checks for a newly used build.<br />Use uci commands to set your desired configuration (you have documented your setup, haven&#039;t you?), then restart the network via the init.d script, after that check all possible connections/devices.</p>											<p class="post-edited">(Last edited by <strong>maddes.b</strong> on 11 Oct 2009, 15:30)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p95940">
				<div class="post-metadata">
					<div class="post-num">Post #554</div>
					<div class="post-author">fatbob</div>
					<div class="post-datetime">
						15 Oct 2009, 11:13					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>fatbob wrote:</cite><blockquote><p>Instead I bought a cheap Edup PCI card off Ebay with a mini-pci on it. My research indicated it would be a bcm4306 chipset which should work fine but when I opened it up it was a bcm4318 <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" />&nbsp; Sadly, the card seem to work fine but fails totally when running it as AP with hostapd. I have read reports that 4318 is unstable in AP-mode but should be better after some DMA-poisoning patches was added. This is worse and the AP doesn&#039;t even show up when doing &#039;iwlist wlan0&#039; scan from a nearby computer.</p></blockquote></div><p>Sorry for going a bit off-topic here, but I just want to report that the Broadcom 4318 mini-pci works just fine now as AP on my WNR854T. For some reason I can&#039;t think of it started working when I installed hostapd-full instead of hostapd-mini. Could be a fluke as I haven&#039;t tried to go back to hostapd-mini after it started working...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p96116">
				<div class="post-metadata">
					<div class="post-num">Post #555</div>
					<div class="post-author">operron</div>
					<div class="post-datetime">
						19 Oct 2009, 23:40					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>operron wrote:</cite><blockquote><p>maddes has released a new build (17986) 3 days ago. I did a sysupgrade on my router&nbsp; (which went very well by the way) but unfortunately I was unable to get wifi working with that build.<br />So another sysuprgade later I was back with build 17650 and wifi working again.<br />Anyone with a similar experience (or a working wifi with maddes build 17986) ?</p></blockquote></div><p>Ok, we&#039;ve got now the wifi working again...<br />We found the culprit: changeset 17821 introduced the capability to specify several wlan cards and the key to identify each of the card is obviously the mac address.<br />So, there is now a macaddr parameter for the wireless configuration and this parameter is absolutely mandatory !</p><p>If you boot on a fresh post 17821 openwrt image, you get a default wireless configuration that looks like this:<br /></p><div class="codebox"><pre><code>wireless.wifi0=wifi-device
wireless.wifi0.type=mac80211
wireless.wifi0.channel=5
[b]wireless.wifi0.macaddr=00:00:xx:xx:xx:xx[/b]
wireless.wifi0.hwmode=11ng
wireless.wifi0.disabled=0
wireless.@wifi-iface[0]=wifi-iface
wireless.@wifi-iface[0].device=wifi0
wireless.@wifi-iface[0].network=lan
wireless.@wifi-iface[0].mode=ap
wireless.@wifi-iface[0].ssid=OpenWrt
wireless.@wifi-iface[0].encryption=none</code></pre></div><p>with the macaddr parameter already setup with your wifi mac address.</p><p>One can tweak this default configuration to adapt to ones wishes, but remember to keep that macaddr parameter (with the real mac address of you card) or the wlan will stop working.</p><p>For example, my own configuration looks like that:<br /></p><div class="codebox"><pre><code>wireless.wifi0=wifi-device
wireless.wifi0.type=mac80211
wireless.wifi0.country=FR
wireless.wifi0.disabled=0
wireless.wifi0.hwmode=11ng
wireless.wifi0.channel=7
wireless.wifi0.txpower=20
wireless.wifi0.macaddr=00:00:xx:xx:xx:xx
wireless.@wifi-iface[0]=wifi-iface
wireless.@wifi-iface[0].device=wifi0
wireless.@wifi-iface[0].network=lan
wireless.@wifi-iface[0].mode=ap
wireless.@wifi-iface[0].ssid=My_Own_SSID
wireless.@wifi-iface[0].encryption=psk2
wireless.@wifi-iface[0].hidden=1
wireless.@wifi-iface[0].key=my_very_long_secret_key_in_hexa</code></pre></div><p>You can also note that the &quot;wifi0&quot; string is used to identify the card inside the wireless structure wereas we were used to use a &quot;wlan0&quot; string before... I&#039;m not sure this makes a big difference, but who knows ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p96228">
				<div class="post-metadata">
					<div class="post-num">Post #556</div>
					<div class="post-author">ChoHag</div>
					<div class="post-datetime">
						22 Oct 2009, 14:28					</div>
				</div>
				<div class="post-content content">
					<p>I can&#039;t find any information on configuring the switch in the wrt350n. Specifically I want to adjust which port is on which vlan (and set up one or two trunked ports). swconfig can&#039;t communicate with the switch at all.</p><p>It seems to work, though I&#039;ve not tested it thoroughly, to use vconfig to add vlans to the lan[1-4], but even if it does this seems somehow wrong.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p96350">
				<div class="post-metadata">
					<div class="post-num">Post #557</div>
					<div class="post-author">skier</div>
					<div class="post-datetime">
						25 Oct 2009, 08:50					</div>
				</div>
				<div class="post-content content">
					<p>Hello everybody,</p><p>I own a linkys wrt350n v2 router. I would like to install the wrt firmware because of the connection lost problems.<br />I have read this very long thread.. pfff.. and i am convinced that it&#039;s possible.<br />But before i do something stupid (yes i am a newbie in this kind of installs) i would like to get it right.</p><p>Which web-update image should i use now?<br />I have found this (<a href="ftp://ftp.maddes.net/openwrt/kamikaze/orion/build_17456/squashfs/">ftp://ftp.maddes.net/openwrt/kamikaze/o … /squashfs/</a>) page but there are so many builds i am afraid to use the wrong one.</p><p>Could please somebody point me to the right on?</p><p>thanks in advantage, Kees.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p96357">
				<div class="post-metadata">
					<div class="post-num">Post #558</div>
					<div class="post-author">maddes.b</div>
					<div class="post-datetime">
						25 Oct 2009, 12:50					</div>
				</div>
				<div class="post-content content">
					<p>If you start new, then take the lastest one. Right now build 18148 is available <a href="ftp://ftp.maddes.net/openwrt/trunk/orion/">on my ftp</a>.<br />For the case you have connection problems revert back to build 17264 (use sysupgrade info from <a href="https://forum.openwrt.org/viewtopic.php?pid=92789#p92789">#376</a>)</p><p>Remember this is all BETA and it is recommended to keep a copy of the repository you installed from.<br />Also you if you have a serial connection to your WRT350Nv2, then you can test with a ramdisk image without flashing (<a href="https://forum.openwrt.org/viewtopic.php?pid=95717#p95717">see #554</a>).</p>											<p class="post-edited">(Last edited by <strong>maddes.b</strong> on 7 Apr 2010, 21:36)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p96370">
				<div class="post-metadata">
					<div class="post-num">Post #559</div>
					<div class="post-author">XAVALON</div>
					<div class="post-datetime">
						25 Oct 2009, 20:28					</div>
				</div>
				<div class="post-content content">
					<p>maddes.b, thank you for compiling new builds into images. <br />But still which to use for if you have a stock firmware on your WRT350n v2</p><p>NOT_FOR_NEWBIES_openwrt-wrt350nv2-squashfs-webupgrade.img ? </p><p>And i understand there is no webbased interface? how to add this easily?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p96371">
				<div class="post-metadata">
					<div class="post-num">Post #560</div>
					<div class="post-author">maddes.b</div>
					<div class="post-datetime">
						25 Oct 2009, 20:40					</div>
				</div>
				<div class="post-content content">
					<p>@Xavalon:<br />According to your question it seems that you are a newbie to OpenWrt .<br />I strongly recommend to check out the OpenWrt docs, wiki and forum about how to handle OpenWrt in general, configuration via uci (especially your internet connection), installing packages via opkg, etc.<br />Hope you have some Linux knowledge too.</p><p>And to answer your WRT350Nv2 questions:<br />1. Yes, that&#039;s the correct file. Use at your own risk (=only flash if you can live with your router getting inoperable).<br />2. Setup internet connection, then install via opkg. Either package &quot;webif&quot; or luci packages &quot;luci-admin-full&quot; and &quot;luci-theme-openwrt&quot; (check this thread for more information).</p><p>Best wishes.</p>											<p class="post-edited">(Last edited by <strong>maddes.b</strong> on 17 Jan 2010, 19:44)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p96384">
				<div class="post-metadata">
					<div class="post-num">Post #561</div>
					<div class="post-author">Nilfred</div>
					<div class="post-datetime">
						26 Oct 2009, 05:07					</div>
				</div>
				<div class="post-content content">
					<p>Upgrade time for WNR854T users?: <strong>kmod-libertas_2.6.30.8+2009-10-09-1_orion.ipk</strong> seen on <a href="http://downloads.x-wrt.org/xwrt/kamikaze/snapshots/orion/packages/">xwrt repo</a><br /></p><div class="quotebox"><blockquote><p>Package: kmod-libertas<br />Version: 2.6.30.8+2009-10-09-1<br />Depends: kernel (=2.6.30.8-1), kmod-mac80211, kmod-usb-core<br />Provides: <br />Source: package/mac80211<br />Section: kernel<br />Priority: optional<br />Maintainer: OpenWrt Developers Team &lt;openwrt-devel@openwrt.org&gt;<br />Architecture: orion<br />Installed-Size: 263217<br />Filename: kmod-libertas_2.6.30.8+2009-10-09-1_orion.ipk<br />Size: 138181<br />MD5Sum: 7a73d55f1c48645e6de1312ef3a20284<br />Description:&nbsp; Marvell 88W8015 Wireless Driver</p></blockquote></div>											<p class="post-edited">(Last edited by <strong>Nilfred</strong> on 26 Oct 2009, 05:11)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p96393">
				<div class="post-metadata">
					<div class="post-num">Post #562</div>
					<div class="post-author">drizzt81</div>
					<div class="post-datetime">
						26 Oct 2009, 12:15					</div>
				</div>
				<div class="post-content content">
					<p>after upgrading to the latest release I noticed that there is something funky going on with the MAC addresses:</p><div class="codebox"><pre><code> ifconfig
br-lan    Link encap:Ethernet  HWaddr 00:00:00:00:51:81

eth0      Link encap:Ethernet  HWaddr 00:00:00:00:51:81

lan1      Link encap:Ethernet  HWaddr 00:00:00:00:51:81

lan2      Link encap:Ethernet  HWaddr 00:00:00:00:51:81

lan3      Link encap:Ethernet  HWaddr 00:00:00:00:51:81

lan4      Link encap:Ethernet  HWaddr 00:00:00:00:51:81

wan       Link encap:Ethernet  HWaddr 00:00:00:00:51:81</code></pre></div><p>I am not sure, but this does not look like a &quot;valid&quot; MAC address (the manufacturer prefix seems weird).</p><p>Cheers,</p><p>Greg</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p96407">
				<div class="post-metadata">
					<div class="post-num">Post #563</div>
					<div class="post-author">Nilfred</div>
					<div class="post-datetime">
						26 Oct 2009, 17:33					</div>
				</div>
				<div class="post-content content">
					<p>Do not try to change MAC addresses, brick is always the result.<br />Use serial console to revert if already bricked:</p><div class="quotebox"><blockquote><p>ifconfig br-lan hw ether 00:00:00:00:51:81</p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p96411">
				<div class="post-metadata">
					<div class="post-num">Post #564</div>
					<div class="post-author">operron</div>
					<div class="post-datetime">
						26 Oct 2009, 18:01					</div>
				</div>
				<div class="post-content content">
					<p>@drizzt81: same thing for me (maddes build 18148). However the router seems happy with that and works OK.<br />Just one note: this isn&#039;t something I have really focused on in the past, so I can&#039;t tell since when the mac addresses are like these ones.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p96420">
				<div class="post-metadata">
					<div class="post-num">Post #565</div>
					<div class="post-author">Nilfred</div>
					<div class="post-datetime">
						26 Oct 2009, 20:17					</div>
				</div>
				<div class="post-content content">
					<p><span style="color: red"><strong>NEWBIES</strong>: Skip this post</span><br /></p><div class="quotebox"><cite>fatbob wrote:</cite><blockquote><p>1) Do _not_ change the MAC address from the default 00:00:00:00:51:81 from WebIf if you don&#039;t have serial access. It will make the router inaccessible from the network (brick it) and requires a serial console to restore. </p><p>Analysis: Setting MAC address on the LAN interface in /etc/config/network will only set the adress on eth0 interface. The lan1, lan2, lan3 and lan4 interfaces will still have 00:00:00:00:51:81. I tried to decode /lib/network/config.sh which is responsible for setting the MAC address but failed to find out a way to modify it to do the right thing. I ended up setting the MAC address on the lanN interfaces one by one in /etc/init.d/network</p></blockquote></div><p>Please post the resulting /etc/init.d/network<br />I will try to export your findings to /etc/config/network via UCI more or less this way:<br /></p><div class="quotebox"><blockquote><p>uci set network.lan1=interface<br />uci set network.lan1.ifname=lan1<br />uci set network.lan1.macaddr=00:1B:2F:xx:xx:xx<br />uci set network.lan2=interface<br />uci set network.lan2.ifname=lan2<br />uci set network.lan2.macaddr=00:1B:2F:xx:xx:xx<br />uci set network.lan3=interface<br />uci set network.lan3.ifname=lan3<br />uci set network.lan3.macaddr=00:1B:2F:xx:xx:xx<br />uci set network.lan4=interface<br />uci set network.lan4.ifname=lan4<br />uci set network.lan4.macaddr=00:1B:2F:xx:xx:xx<br /><strong>uci set network.lan.macaddr=00:1B:2F:xx:xx:xx<br />uci set network.eth0.macaddr=00:1B:2F:xx:xx:xx</strong><br />uci commit network</p></blockquote></div><p>Not sure of bold ones, your /etc/init.d/network is the key.</p><p><strong>Edit</strong>: Bricked many times.</p><div class="quotebox"><blockquote><p>net eth0: received packet spanning multiple descriptors<br />user.err kernel: net eth0: received packet spanning multiple descriptors</p></blockquote></div><p>Can get it to work with same MAC on br-lan and lan1 (lanN whichever you connect to)<br />No lanN gets configured via UCI<br />Reverted to default 00:00:00:00:51:81</p><div class="quotebox"><blockquote><p>uci delete network.lan1<br />uci delete network.lan2<br />uci delete network.lan3<br />uci delete network.lan4<br />uci delete network.eth0.macaddr<br />uci set network.lan.macaddr=<br />uci commit network</p></blockquote></div>											<p class="post-edited">(Last edited by <strong>Nilfred</strong> on 26 Oct 2009, 22:30)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p96486">
				<div class="post-metadata">
					<div class="post-num">Post #566</div>
					<div class="post-author">fatbob</div>
					<div class="post-datetime">
						27 Oct 2009, 23:04					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Nilfred wrote:</cite><blockquote><p><span style="color: red"><strong>NEWBIES</strong>: Skip this post</span><br /></p><div class="quotebox"><cite>fatbob wrote:</cite><blockquote><p>1) Do _not_ change the MAC address from the default 00:00:00:00:51:81 from WebIf if you don&#039;t have serial access. It will make the router inaccessible from the network (brick it) and requires a serial console to restore. </p><p>Analysis: Setting MAC address on the LAN interface in /etc/config/network will only set the adress on eth0 interface. The lan1, lan2, lan3 and lan4 interfaces will still have 00:00:00:00:51:81. I tried to decode /lib/network/config.sh which is responsible for setting the MAC address but failed to find out a way to modify it to do the right thing. I ended up setting the MAC address on the lanN interfaces one by one in /etc/init.d/network</p></blockquote></div><p>Please post the resulting /etc/init.d/network</p></blockquote></div><p>I just added:<br /></p><div class="codebox"><pre><code>ifconfig lan1 hw ether &lt;MAC addr&gt;
ifconfig lan2 hw ether &lt;MAC addr&gt;
...etc...</code></pre></div><p>to boot() start() and restart() in /etc/init.d/network. It&#039;s an ugly hack, yes. <br />I think a proper way to do it is to modify /lib/network/config.sh to apply the MAC addr to eth0, br-lan and lanN interfaces.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p96490">
				<div class="post-metadata">
					<div class="post-num">Post #567</div>
					<div class="post-author">maddes.b</div>
					<div class="post-datetime">
						27 Oct 2009, 23:54					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m using build 17562 on my router, there it is also HWaddr 00:00:00:00:51:81.<br />And if I remember correctly it was this way when I started building images roughly a year ago (build 14xxx).<br />So I would guess that it is this way at least since Kamikaze 8.09</p><p>Just my two cents<br />Maddes</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p96492">
				<div class="post-metadata">
					<div class="post-num">Post #568</div>
					<div class="post-author">maddes.b</div>
					<div class="post-datetime">
						27 Oct 2009, 23:59					</div>
				</div>
				<div class="post-content content">
					<p>@someone who needs a changed MAC:<br />Please <a href="https://dev.openwrt.org/newticket">create a ticket</a> for this problem.<br />Do not forget to state...<br />a) your real name<br />b) your real mail address<br />c) used build<br />d) used hardware<br />e) what you want<br />f) what you did to get it<br />g) what you got</p><p>Then finally post the link to the new ticket here <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Another option is one of the OpenWrt mailing list or forum, as these seems to be a general issue and not a Marvell specific one.</p>											<p class="post-edited">(Last edited by <strong>maddes.b</strong> on 28 Oct 2009, 00:00)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p96499">
				<div class="post-metadata">
					<div class="post-num">Post #569</div>
					<div class="post-author">Nilfred</div>
					<div class="post-datetime">
						28 Oct 2009, 01:43					</div>
				</div>
				<div class="post-content content">
					<p>Does always badly brick saveenv in uboot?<br />Is the same MAC that come from uboot environment.<br />Someone equipped with JTAG adapter could possible test if can change MAC from there?<br />saveenv is reportedly bricker command, do not try without you JTAG adapter in handy.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p96501">
				<div class="post-metadata">
					<div class="post-num">Post #570</div>
					<div class="post-author">maddes.b</div>
					<div class="post-datetime">
						28 Oct 2009, 01:50					</div>
				</div>
				<div class="post-content content">
					<p>No, &quot;saveenv&quot; in uboot does not brick your router, but it can if you changed something to a bad value and save these changes to the flash with &quot;saveenv&quot;.<br />So not &quot;saveenv&quot; itself is the problem but the settings you change wrongly.<br />As always change U-Boot settings on your own risk (You saved a log of &quot;printenv&quot;, didn&#039;t you? You know what you are changing, don&#039;t you?).</p><p>Note that for some temporary changes you do not even need to save them to the flash, e.g. temporary ip address changes for tfpboot.</p>											<p class="post-edited">(Last edited by <strong>maddes.b</strong> on 28 Oct 2009, 01:53)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p96509">
				<div class="post-metadata">
					<div class="post-num">Post #571</div>
					<div class="post-author">Nilfred</div>
					<div class="post-datetime">
						28 Oct 2009, 05:19					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>maddes.b wrote:</cite><blockquote><p>@someone who needs a changed MAC:<br />Please <a href="https://dev.openwrt.org/newticket">create a ticket</a> for this problem.<br />Then finally post the link to the new ticket here <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></blockquote></div><p>Found related:<br /><a href="https://dev.openwrt.org/ticket/1014">#1014</a> new method to set MAC address in /etc/config/network<br /><a href="https://dev.openwrt.org/ticket/1321">#1321</a> patch: extend network/config.sh to support mtu and mac per bridge member<br /><a href="https://dev.openwrt.org/ticket/1348">#1348</a> redundant calls to setup_interface() at bridge creation<br /><a href="https://dev.openwrt.org/ticket/1428">#1428</a> Change MAC address causes interface to not respond to pings, etc.<br /><a href="https://dev.openwrt.org/ticket/4021">#4021</a> No more access to LAN iface when change MAC...<br /><a href="https://dev.openwrt.org/changeset/16269">Changeset 16269</a> network: prevent unnecessary interface down/up cycles if no mac address change is requested</p><p>Peeking around /lib/network/config.sh:<br />I think isn&#039;t honor <strong>macaddr</strong> when <strong>protocol=none</strong> only for <strong>protocol=static</strong><br />br-somethin is left to <strong>brctl</strong> config so it don&#039;t touch bridged interfaces nor change MAC address.<br />I also think I will been up saying &quot;there is nothing wrong with config.sh&quot; Must see...<br /></p><div class="quotebox"><cite>line 83 wrote:</cite><blockquote><p><span style="color: green"># Create the interface, if necessary.<br /># Return status 0 indicates that the setup_interface() call should continue<br /># Return status 1 means that everything is set up already.</span></p><p>prepare_interface<span style="color: brown">() {</span><br />&nbsp; &nbsp; <span style="color: blue">local</span> iface=&quot;$1&quot;<br />&nbsp; &nbsp; <span style="color: blue">local</span> config=&quot;$2&quot;<br />&nbsp; &nbsp; <span style="color: blue">local</span> vifmac=&quot;$3&quot;</p><p>&nbsp; &nbsp; <span style="color: green"># if we&#039;re called for the bridge interface itself, don&#039;t bother trying<br />&nbsp; &nbsp; # to create any interfaces here. The scripts have already done that, otherwise<br />&nbsp; &nbsp; # the bridge interface wouldn&#039;t exist.</span><br />&nbsp; &nbsp; [ &quot;br-$config&quot; = &quot;$iface&quot; <span style="color: blue">-o -e</span> &quot;$iface&quot; ] &amp;&amp; <span style="color: blue">return</span> 0;</p><p>&nbsp; &nbsp; ifconfig &quot;$iface&quot; 2&gt;/dev/null &gt;/dev/null &amp;&amp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: blue">local</span> proto<br />&nbsp; &nbsp; &nbsp; &nbsp; config_get proto &quot;$config&quot; proto</p><p>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: green"># make sure the interface is removed from any existing bridge and deconfigured,<br />&nbsp; &nbsp; &nbsp; &nbsp; # (deconfigured only if the interface is not set to proto=none)</span><br />&nbsp; &nbsp; &nbsp; &nbsp; unbridge &quot;$iface&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; [ &quot;$proto&quot; = none ] || ifconfig &quot;$iface&quot; 0.0.0.0</p><p>&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: green"># Change interface MAC address if requested</span><br />&nbsp; &nbsp; &nbsp; &nbsp; [ <span style="color: blue">-n</span> &quot;$vifmac&quot; ] &amp;&amp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ifconfig &quot;$iface&quot; down<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: red">ifconfig &quot;$iface&quot; <strong>hw ether</strong> &quot;$vifmac&quot; up</span><br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; }</p></blockquote></div><p>There is a ugly hack that bring up the interface early without setting the MAC (hope DaBigMac could see the difference in red color)<br /></p><div class="quotebox"><cite>line 233 wrote:</cite><blockquote><p>setup_interface() {<br />&nbsp; &nbsp; <span style="color: blue">local</span> iface=&quot;$1&quot;<br />&nbsp; &nbsp; <span style="color: blue">local</span> config=&quot;$2&quot;<br />&nbsp; &nbsp; <span style="color: blue">local</span> proto=&quot;$3&quot;<br />&nbsp; &nbsp; <span style="color: blue">local</span> vifmac=&quot;$4&quot;</p><p>&nbsp; &nbsp; [ <span style="color: blue">-n</span> &quot;$config&quot; ] || {<br />&nbsp; &nbsp; &nbsp; &nbsp; config=$(find_config &quot;$iface&quot;)<br />&nbsp; &nbsp; &nbsp; &nbsp; [ &quot;$?&quot; = 0 ] || <span style="color: blue">return</span> 1<br />&nbsp; &nbsp; }</p><p>&nbsp; &nbsp; prepare_interface &quot;$iface&quot; &quot;$config&quot; &quot;$vifmac&quot; || <span style="color: blue">return</span> 0</p><p>&nbsp; &nbsp; [ &quot;$iface&quot; = &quot;br-$config&quot; ] &amp;&amp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: green"># need to bring up the bridge and wait a second for<br />&nbsp; &nbsp; &nbsp; &nbsp; # it to switch to the &#039;forwarding&#039; state, otherwise<br />&nbsp; &nbsp; &nbsp; &nbsp; # it will lose its routes...</span><br />&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: red">ifconfig &quot;$iface&quot; up</span><br />&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: blue">sleep</span> 1<br />&nbsp; &nbsp; }</p><p>&nbsp; &nbsp; <span style="color: green"># Interface settings</span><br />&nbsp; &nbsp; <span style="color: blue">grep</span> &quot;$iface:&quot; /proc/net/dev &gt; /dev/null &amp;&amp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: blue">local</span> mtu macaddr<br />&nbsp; &nbsp; &nbsp; &nbsp; config_get mtu &quot;$config&quot; mtu<br />&nbsp; &nbsp; &nbsp; &nbsp; config_get macaddr &quot;$config&quot; macaddr<br />&nbsp; &nbsp; &nbsp; &nbsp; [ <span style="color: blue">-n</span> &quot;$macaddr&quot; ] &amp;&amp; $DEBUG ifconfig &quot;$iface&quot; down<br />&nbsp; &nbsp; &nbsp; &nbsp; $DEBUG <span style="color: red">ifconfig &quot;$iface&quot; ${macaddr:+<strong>hw ether</strong> &quot;$macaddr&quot;} ${mtu:+mtu $mtu} up</span><br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; set_interface_ifname &quot;$config&quot; &quot;$iface&quot;</p></blockquote></div><p>So the patch should be:<br /></p><div class="quotebox"><cite>line 250 @ r17427 wrote:</cite><blockquote><p>-&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: red">ifconfig &quot;$iface&quot; up</span><br />+&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: red">ifconfig &quot;$iface&quot; ${vifmac:+<strong>hw ether</strong> &quot;$vifmac&quot;} up</span></p></blockquote></div><p>Someone wiling to test? Going to sleep now. Also test if mtu is honored for br-lan will get 2 birds in one shot.</p>											<p class="post-edited">(Last edited by <strong>Nilfred</strong> on 28 Oct 2009, 17:53)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p96628">
				<div class="post-metadata">
					<div class="post-num">Post #572</div>
					<div class="post-author">maddes.b</div>
					<div class="post-datetime">
						30 Oct 2009, 00:24					</div>
				</div>
				<div class="post-content content">
					<p>Will be back home in 2.5 weeks. If no one has tested after I return, then I will do some more tests (check U-Boot mac address, check LinkSys stock FW mac address, check your change)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p96650">
				<div class="post-metadata">
					<div class="post-num">Post #573</div>
					<div class="post-author">bigjezza</div>
					<div class="post-datetime">
						30 Oct 2009, 14:58					</div>
				</div>
				<div class="post-content content">
					<p>Any tips on enabling 40mhz/300mbps connections? I&#039;ve blindly stabbed in the dark and gotten 11n @ 130mbps going OK, and it is performing faster than 11g</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p96704">
				<div class="post-metadata">
					<div class="post-num">Post #574</div>
					<div class="post-author">DaBigMac</div>
					<div class="post-datetime">
						1 Nov 2009, 11:55					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Nilfred wrote:</cite><blockquote><p>There is a ugly hack that bring up the interface early without setting the MAC (hope DaBigMac could see the difference in red color)</p></blockquote></div><p><img src="https://forum.openwrt.org/img/smilies/tongue.png" width="15" height="15" alt="tongue" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p96733">
				<div class="post-metadata">
					<div class="post-num">Post #575</div>
					<div class="post-author">Nilfred</div>
					<div class="post-datetime">
						2 Nov 2009, 02:31					</div>
				</div>
				<div class="post-content content">
					<p>One more change to /lib/network/config.sh<br /></p><div class="quotebox"><cite>line 133 wrote:</cite><blockquote><p>-&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $DEBUG ifconfig &quot;br-$config&quot; up<br />+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $DEBUG ifconfig &quot;br-$config&quot; ${vifmac:+hw ether &quot;$vifmac&quot;} up</p></blockquote></div><p>Fingers crossed...</p>									</div>
			</article>

			
		
						<div class="notice">
				<p>Sorry, posts 576 to 575 are missing from our archive.</p>
			</div>
		
		
	
	<div class="pagination"><div class="pagination-number">Page 23 of 46</div><nav><ul><li><a href="viewtopic.php%3Fid=12358&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=12358&amp;p=21.html">21</a></li><li><a href="viewtopic.php%3Fid=12358&amp;p=22.html">22</a></li><li class="pagination-current"><span>23</span></li><li><a href="viewtopic.php%3Fid=12358&amp;p=24.html">24</a></li><li><a href="viewtopic.php%3Fid=12358&amp;p=25.html">25</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=12358&amp;p=46.html">46</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0.001 -->

</body>
</html>