<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> how to install packages without internet?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 19 Apr 2018 and 23 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 2 of 2</div><nav><ul><li><a href="viewtopic.php%3Fid=32664&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p147568">
				<div class="post-metadata">
					<div class="post-num">Post #26</div>
					<div class="post-author">zordlyon</div>
					<div class="post-datetime">
						4 Nov 2011, 12:39					</div>
				</div>
				<div class="post-content content">
					<p>Ok, i has read the #18, but # 18 is not only for the direct install OpenWRT packages without using the scp command?</p><p>Or it is to install the packages on another partition without being root?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p147672">
				<div class="post-metadata">
					<div class="post-num">Post #27</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						5 Nov 2011, 14:16					</div>
				</div>
				<div class="post-content content">
					<p>Install libjpeg and libpthread before installing mjpg-streamer.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150681">
				<div class="post-metadata">
					<div class="post-num">Post #28</div>
					<div class="post-author">zordlyon</div>
					<div class="post-datetime">
						8 Dec 2011, 22:34					</div>
				</div>
				<div class="post-content content">
					<p>people after trying and trying...i just understand why i cant install this...if anyone have pacience to help me i appreciate...</p><div class="codebox"><pre><code>root@OpenWrt:/tmp# opkg install kmod-usb-core_2.4.35.4-brcm-2.4-1_mipsel.ipk -d 
ram /dev/mtdblock/4
Multiple packages (kmod-usb-core and kmod-usb-core) providing same name marked HOLD or PREFER.  Using latest.
Installing kmod-usb-core (2.4.35.4-brcm-2.4-1) to ram...
Configuring kmod-usb-core
sed: 20-usb-core: No such file or directory
opkg_conf_write_status_files: Can&#039;t open status file: /dev/mtdblock/4//usr/lib/opkg/status for writing: Not a directory
Collected errors:
 * Cannot find package /dev/mtdblock/4.</code></pre></div><p>my /etc/opkg.conf<br /></p><div class="codebox"><pre><code>src/gz snapshots http://mightyohm.com/files/kamikaze-2.4/packages/mipsel
dest root /
dest ram /tmp
dest /jffs /dev/mtdblock/4
lists_dir ext /var/opkg-lists</code></pre></div><p>What is wrong now?</p><p>I&#039;m trying install the USB storage for install de mpeg-streamer and other stuffs, but now just dont install...It say is installed, but it show this..</p><div class="codebox"><pre><code>root@OpenWrt:/tmp# opkg list
(...)
kmod-usb-core - 2.4.35.4-brcm-2.4-1 - 
kmod-usb-ohci - 2.4.35.4-brcm-2.4-1 - 
kmod-usb-uhci - 2.4.35.4-brcm-2.4-1 - 
kmod-usb2 - 2.4.35.4-brcm-2.4-1 - 
(...)</code></pre></div><div class="codebox"><pre><code>pkg files kmod-fs-ext3_2.4.35.4-brcm-2.4-1_mipsel.ipk 
Collected errors:
 * Package kmod-fs-ext3_2.4.35.4-brcm-2.4-1_mipsel.ipk not installed.</code></pre></div><p>Thanks..</p>											<p class="post-edited">(Last edited by <strong>zordlyon</strong> on 8 Dec 2011, 22:36)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150805">
				<div class="post-metadata">
					<div class="post-num">Post #29</div>
					<div class="post-author">zordlyon</div>
					<div class="post-datetime">
						10 Dec 2011, 03:10					</div>
				</div>
				<div class="post-content content">
					<p>People if anyone can tell me just some things, i thanks very much...</p><p>For asus wl520gu:<br />-Backfire 10.03.1 - rc4 - brcm47xx is the software recommended for transmitting video with a labtec cam?<br />-This firmware brings the packages for USB??<br />-Can i transmit the video via wireless with mjpg-streamer?</p><p>Please anyone help me with this questions...</p><p>Thanks..</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150816">
				<div class="post-metadata">
					<div class="post-num">Post #30</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						10 Dec 2011, 11:21					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>zordlyon wrote:</cite><blockquote><p>Ok, i has read the #18, but # 18 is not only for the direct install OpenWRT packages without using the scp command?</p></blockquote></div><p>What can you lose to give it a try?</p><p>What you need is a local host, which plays the role of download.openwrt.org, or saying &quot;man-in-the-middle&quot;, that is connected to the internet and with nginx installed and configured.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150825">
				<div class="post-metadata">
					<div class="post-num">Post #31</div>
					<div class="post-author">zordlyon</div>
					<div class="post-datetime">
						10 Dec 2011, 15:08					</div>
				</div>
				<div class="post-content content">
					<p>I, first thanks for the response...</p><br /><p>I have tried, but unsuccessfully, now first I need to know is what firmware I need to do.<br />I have been trying to do this in firmware brcm 2.4 kamikaze (Blending edge r12857) and I can not even install a few things and recognize a USB stick.</p><p>I&#039;m thinking about changing the firmware mentioned above, but wanted to know if it is better suited to what I said, not to go try to do things that do not, then i ask for help...</p><p>Thanks..</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150854">
				<div class="post-metadata">
					<div class="post-num">Post #32</div>
					<div class="post-author">zordlyon</div>
					<div class="post-datetime">
						11 Dec 2011, 03:26					</div>
				</div>
				<div class="post-content content">
					<p>Fyi, i have sucessed installed nginx on my pc and luci_hosts on 10.03.1 RC4 but i have a question how i connect the router to my pc? via lan1 or serial or SSH???</p><p>and more 1 question, the nginx is installed on my PC or on router?</p><p>Thanks..</p>											<p class="post-edited">(Last edited by <strong>zordlyon</strong> on 11 Dec 2011, 04:05)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150856">
				<div class="post-metadata">
					<div class="post-num">Post #33</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						11 Dec 2011, 05:08					</div>
				</div>
				<div class="post-content content">
					<p>Success means you can open 127.0.0.1/192.168.1.2 which is redirected to download.openwrt.org in the browser? It has nothing to do with the firmware you install.</p><p>My target is download.openwrt.org. What&#039;s yours? You don&#039;t have to modify opkg.conf.<br />My host is at 192.168.1.2. What&#039;s yours? It must connect to the internet to act as a reverse proxy.<br /></p><div class="quotebox"><blockquote><p>Router (192.168.1.1) -&gt; Host (nginx@192.168.1.2) -&gt; download.openwrt.org</p></blockquote></div><p>The next step is to tell the router/OpenWrt that download.openwrt.org is at 192.168.1.2. No files needed to be downloaded to local host. Just passing by.</p><p>Read #18 again. I don&#039;t think you understand what I&#039;d done.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150857">
				<div class="post-metadata">
					<div class="post-num">Post #34</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						11 Dec 2011, 05:23					</div>
				</div>
				<div class="post-content content">
					<p>I begin to wonder what you meant &quot;without internet&quot;. If no hosts can connect to the internet, then my method will not work. You have to download every files you need to a local host. But if you can connect to the internet, why not simply set it up in the router?</p><p>Edit:<br />Fine. I see you &quot;do not want to change settings&quot; but, did you modify opkg.conf to reflect &quot;mightyohm.com&quot; from &quot;download.openwrt.org&quot;? The uci commands I executed are not permanent unless you execute &quot;uci commit&quot;. They can be reverted by &quot;uci revert luci_hosts&quot; and I&#039;d said that.</p><p>If you follow my instructions, you don&#039;t have to worry about &quot;package dependence&quot;. How do you know which files have to be installed before &quot;mjpg-streamer&quot;? I&#039;d already told you that but you just didn&#039;t notice.<br /></p><div class="quotebox"><blockquote><p>root@OpenWrt:~# opkg info mjpg-streamer<br />Package: mjpg-streamer<br />Version: r68-2<br /><strong>Depends: libpthread, libjpeg</strong><br />Provides:<br />Status: unknown ok not-installed<br />Section: multimedia<br />Architecture: mips<br />maintainer: OpenWrt Developers Team &lt;openwrt-devel@openwrt.org&gt;<br />MD5Sum: d561d7731c7409dcf481747d46443474<br />Size: 113891<br />Filename: mjpg-streamer_r68-2_mips.ipk<br />Source: feeds/packages/multimedia/mjpg-streamer<br />Description: Streaming application for Linux-UVC compatible webcams</p></blockquote></div>											<p class="post-edited">(Last edited by <strong>fyi</strong> on 11 Dec 2011, 05:50)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150893">
				<div class="post-metadata">
					<div class="post-num">Post #35</div>
					<div class="post-author">zordlyon</div>
					<div class="post-datetime">
						11 Dec 2011, 19:41					</div>
				</div>
				<div class="post-content content">
					<p>I very thanks, one more time, the dependences is easy i think, because, if i need to install something, when i go install it, he tell me &quot;dependencies required&quot;, right???</p><p>I changed the version of the OpenWRT &quot;Kamikaze BRCM 2.4&quot; to &quot;backfire brcm47xx 10.03.1 rc4&quot; this weekend, and have it installed the following packages:<br />-kmod-usb-core<br />-kmod-usb-ohci<br />-kmod-usb-storage<br />-kmod-usb-uhci<br />-kmod-usb2<br />-kmod-fs-ext3<br />-kmod-fs-mbcache<br />-kernel-2.6.32.25-1<br />-block-mount<br />-libblkid<br />-libopenssl<br />-libusb<br />-libuuid<br />-swap-utils<br />-usbtutils<br />-zlib</p><p>Initially i start installing the &quot;Kmod-usb-*&quot; and he asked for dependencies, then i go to the site &quot;<a href="http://downloads.openwrt.org/backfire/10.03.1-rc4/brcm47xx/packages/">http://downloads.openwrt.org/backfire/1 … /packages/</a>&quot; and i download the dependencie required and send to the router via Scp &lt;package&gt; &lt;router&gt; :/tmp and install it...</p><p>In this way work on same way right??</p><p>Or there are other dependencies and they are not asked??</p><p>Thanks one more time, if I lived at your side would pay you a drink .. <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>											<p class="post-edited">(Last edited by <strong>zordlyon</strong> on 11 Dec 2011, 19:58)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150907">
				<div class="post-metadata">
					<div class="post-num">Post #36</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						11 Dec 2011, 21:30					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>zordlyon wrote:</cite><blockquote><p>In this way work on same way right??</p></blockquote></div><p>Yes.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150919">
				<div class="post-metadata">
					<div class="post-num">Post #37</div>
					<div class="post-author">zordlyon</div>
					<div class="post-datetime">
						11 Dec 2011, 23:49					</div>
				</div>
				<div class="post-content content">
					<p>Now, i&#039;m trying install packages on USB stick, but unsucessfully...what i have when i reboot the router is this:</p><div class="codebox"><pre><code>SCSI subsystem initialized
usbcore: registered new interface driver usbfs
usbcore: registered new interface driver hub
usbcore: registered new device driver usb
ehci_hcd: USB 2.0 &#039;Enhanced&#039; Host Controller (EHCI) Driver
ohci_hcd: USB 1.1 &#039;Open&#039; Host Controller (OHCI) Driver
ohci_hcd ssb0:1: SSB OHCI Controller
ohci_hcd ssb0:1: new USB bus registered, assigned bus number 1
ohci_hcd ssb0:1: irq 6, io mem 0x18003000
usb usb1: configuration #1 chosen from 1 choice
hub 1-0:1.0: USB hub found
hub 1-0:1.0: 2 ports detected
ohci_hcd ssb0:1: SSB EHCI Controller
ohci_hcd ssb0:1: new USB bus registered, assigned bus number 2
ohci_hcd ssb0:1: irq 6, io mem 0x18003800
ohci_hcd ssb0:1: USB 0.0 started, EHCI 1.00
usb usb2: configuration #1 chosen from 1 choice
hub 2-0:1.0: USB hub found
hub 2-0:1.0: 2 ports detected
uhci_hcd: USB Universal Host Controller Interface driver
Initializing USB Mass Storage driver...
usbcore: registered new interface driver usb-storage
USB Mass Storage support registered.
usb 2-1: new high speed USB device using ohci_hcd and address 2
usb 2-1: configuration #1 chosen from 1 choice
scsi0 : SCSI emulation for USB Mass Storage devices
scsi 0:0:0:0: Direct-Access              USB Flash Memory 1.00 PQ: 0 ANSI: 2
sd 0:0:0:0: [sda] 2002944 512-byte logical blocks: (1.02 GB/978 MiB)
sd 0:0:0:0: [sda] Write Protect is off
sd 0:0:0:0: [sda] Assuming drive cache: write through
sd 0:0:0:0: [sda] Assuming drive cache: write through
 sda: sda1
sd 0:0:0:0: [sda] Assuming drive cache: write through
sd 0:0:0:0: [sda] Attached SCSI removable disk</code></pre></div><p>And then i do this:</p><div class="codebox"><pre><code>root@OpenWrt:/# mount -t ext3 /dev/sda1 /mnt/share -o rw,sync
kjournald starting.  Commit interval 5 seconds
EXT3 FS on sda1, internal journal
EXT3-fs: recovery complete.
EXT3-fs: mounted filesystem with writeback data mode.</code></pre></div><p>I went to &quot;/ etc / opkg.conf&quot; and put &quot;dest usb / mnt / share&quot;</p><p>Then i try install a package on USB and i got the error:</p><div class="codebox"><pre><code>root@OpenWrt:/tmp# opkg install libjpeg_6b-1_brcm47xx.ipk -d usb /mnt/share
Installing libjpeg (6b-1) to usb...
Unknown package &#039;/mnt/share&#039;.
Configuring libjpeg.
Collected errors:
 * opkg_conf_parse_file: /etc/opkg.conf:5: Ignoring invalid line: `text /var/opkg-li
sts&#039;
 * opkg_install_cmd: Cannot install package /mnt/share.</code></pre></div><p>What i have on /etc/opkg.conf is this:</p><div class="codebox"><pre><code>src/gz packages http://downloads.openwrt.org/backfire/10.03.1-rc4/brcm47xx/packa
dest root /
dest ram /tmp
dest usb /mnt/share
text /var/opkg-lists
option overlay_root /overlay</code></pre></div><p>And what i have in /etc/config/fstab is:<br /></p><div class="codebox"><pre><code>&quot;/etc/config/fstab&quot; 20L, 406C



config &#039;global&#039; &#039;automount&#039;
        option &#039;from_fstab&#039; &#039;1&#039;
        option &#039;anon_mount&#039; &#039;1&#039;

config &#039;global&#039; &#039;autoswap&#039;
        option &#039;from_fstab&#039; &#039;1&#039;
        option &#039;anon_swap&#039; &#039;0&#039;

config &#039;mount&#039;
        option &#039;device&#039; &#039;/dev/sda1&#039;
        option &#039;fstype&#039; &#039;ext3&#039;
        option &#039;options&#039; &#039;rw,sync&#039;
        option &#039;enabled&#039; &#039;1&#039;
        option &#039;enabled_fsck&#039; &#039;0&#039;
        option &#039;target&#039; &#039;/mnt/share&#039;

config &#039;swap&#039;
        option &#039;device&#039; &#039;/dev/sda1&#039;
        option &#039;enabled&#039; &#039;1&#039;</code></pre></div><p>And running &quot;df&quot; i have this:</p><div class="codebox"><pre><code>root@OpenWrt:/tmp# df
Filesystem           1K-blocks      Used Available Use% Mounted on
/dev/root                 1920      1920         0 100% /rom
tmpfs                     6696       112      6584   2% /tmp
tmpfs                      512         0       512   0% /dev
/dev/mtdblock3            1152       952       200  83% /overlay
mini_fo:/overlay          1920      1920         0 100% /
/dev/sda1               980308     16588    913924   2% /mnt/share</code></pre></div><p>The packages i have installed is above...</p><p>What is wrong?</p><p>Thanks..</p>											<p class="post-edited">(Last edited by <strong>zordlyon</strong> on 11 Dec 2011, 23:56)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150925">
				<div class="post-metadata">
					<div class="post-num">Post #38</div>
					<div class="post-author">zordlyon</div>
					<div class="post-datetime">
						12 Dec 2011, 00:28					</div>
				</div>
				<div class="post-content content">
					<p>Unsucess...i have followed this for extroot:</p><div class="quotebox"><blockquote><p>Duplicate data</p><p>Copy necessary files from flash to the new root partition:<br />For pivot overlay you can either use an empty new rootfs OR copy the contents of the current overlay (JFFS2) to the new rootfs (assuming the filesystem for the new external rootfs is mounted on /mnt/sda1):<br />tar -C /overlay -cvf - . | tar -C /mnt/sda1 -xf -<br />For pivot root (only possible as of r26109!) you must make sure to have a complete root filesystem on the external rootfs device. One possible way to get such a system (assuming the filesystem for the new external rootfs is mounted on /mnt/sda1) is to issue<br />mkdir -p /tmp/cproot<br />mount --bind / /tmp/cproot<br />tar -C /tmp/cproot -cvf - . | tar -C /mnt/sda1 -xf -<br />umount /tmp/cproot</p></blockquote></div><p>And i got this:<br /></p><div class="codebox"><pre><code>root@OpenWrt:/# df
Filesystem           1K-blocks      Used Available Use% Mounted on
/dev/root                 1920      1920         0 100% /rom
tmpfs                     6696        52      6644   1% /tmp
tmpfs                      512         0       512   0% /dev
/dev/sda1               980308     37548    892964   4% /overlay
mini_fo:/overlay          1920      1920         0 100% /</code></pre></div><p>but when i try install i got:<br /></p><div class="codebox"><pre><code>root@OpenWrt:/tmp# opkg install libjpeg_6b-1_brcm47xx.ipk -d usb /overlay
Installing libjpeg (6b-1) to ram...
Unknown package &#039;/overlay&#039;.
Configuring libjpeg.
Collected errors:
 * opkg_conf_parse_file: /etc/opkg.conf:5: Ignoring invalid line: `text /var/opkg-li
sts&#039;
 * opkg_install_cmd: Cannot install package /overlay.</code></pre></div><p>if anyone can help...</p><p>Thanks...</p>											<p class="post-edited">(Last edited by <strong>zordlyon</strong> on 12 Dec 2011, 00:45)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p151077">
				<div class="post-metadata">
					<div class="post-num">Post #39</div>
					<div class="post-author">zordlyon</div>
					<div class="post-datetime">
						13 Dec 2011, 17:55					</div>
				</div>
				<div class="post-content content">
					<p>Success!...thanks to alll...</p><p>The project...<br /><a href="http://www.youtube.com/watch?v=AJ55DoFTHGY&amp;feature=youtu.be">http://www.youtube.com/watch?v=AJ55DoFT … e=youtu.be</a></p><p>Thanks..</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p151232">
				<div class="post-metadata">
					<div class="post-num">Post #40</div>
					<div class="post-author">zzz2002</div>
					<div class="post-datetime">
						15 Dec 2011, 11:09					</div>
				</div>
				<div class="post-content content">
					<p>At the top of each post there is a header - date and time on left, sequence number of the post in thread on right. <br />#18 - scroll back to post #18 in this thread.<br />Took me a minute to tumble to what fyi was saying, as I had not really looked at the layout of the postings. You learn something new every day.</p>											<p class="post-edited">(Last edited by <strong>zzz2002</strong> on 15 Dec 2011, 11:12)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p156639">
				<div class="post-metadata">
					<div class="post-num">Post #41</div>
					<div class="post-author">berih</div>
					<div class="post-datetime">
						8 Feb 2012, 01:32					</div>
				</div>
				<div class="post-content content">
					<p>Or the way I do it:</p><p>1) setup a local web server in your LAN (subnet)</p><p>2) put the package repository in there</p><p>3) change /etc/opkg.conf on the router to point to your local package repository</p><p>4) install packages as you do normally with: opkg update; opkg install foobar</p><p>Thank you but i have some errors as exemple :</p><p>Collected errors:<br /> * satisfy_dependencies_for: Cannot satisfy the following dependencies for ebtables:<br /> *&nbsp; &nbsp; &nbsp; kmod-ebtables *<br /> * opkg_install_cmd: Cannot install package ebtables.<br />root@OpenWrt:~# opkg install 63.ipk<br />Collected errors:<br /> * wfopen: 63.ipk: No such file or directory.<br /> * pkg_init_from_file: Failed to extract control file from 63.ipk.<br />root@OpenWrt:~# opkg install luci5.ipk<br />Collected errors:<br /> * wfopen: luci5.ipk: No such file or directory.<br /> * pkg_init_from_file: Failed to extract control file from luci5.ipk.<br />root@OpenWrt:~# opkg install fconfig.ipk<br />Collected errors:<br /> * wfopen: fconfig.ipk: No such file or directory.<br /> * pkg_init_from_file: Failed to extract control file from fconfig.ipk.<br />root@OpenWrt:~#</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p158284">
				<div class="post-metadata">
					<div class="post-num">Post #42</div>
					<div class="post-author">otherchance</div>
					<div class="post-datetime">
						22 Feb 2012, 06:46					</div>
				</div>
				<div class="post-content content">
					<p>I have checked and it doesn&#039;t seem to be a caching issue as I have implemented both the cache_control and randomstr solution to make sure each request is unique. I&#039;ve included the code below for getting the data and decoding the JSON string. Anyone have any ideas?<br /><a href="http://www.jobsvilli.com/internet-new-media-jobs-31.html">internet jobs in pakistan</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p158290">
				<div class="post-metadata">
					<div class="post-num">Post #43</div>
					<div class="post-author">jemijem</div>
					<div class="post-datetime">
						22 Feb 2012, 08:23					</div>
				</div>
				<div class="post-content content">
					<p>You can get the help from this site also.. ie openwrt... <br />There are also so many informations available on many sites in the Internet so you can visit for this.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p266752">
				<div class="post-metadata">
					<div class="post-num">Post #44</div>
					<div class="post-author">charlie_slh</div>
					<div class="post-datetime">
						24 Feb 2015, 16:29					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>fyi wrote:</cite><blockquote><p>Install &quot;<a href="http://www.nginx.org">nginx</a>&quot; as a <a href="http://en.wikipedia.org/wiki/Reverse_proxy">Reverse Proxy Server</a> on a local host @192.168.1.2.<br /></p><div class="quotebox"><blockquote><p><span class="postimg"><img src="http://upload.wikimedia.org/wikipedia/commons/thumb/6/67/Reverse_proxy_h2g2bob.svg/280px-Reverse_proxy_h2g2bob.svg.png" alt="http://upload.wikimedia.org/wikipedia/commons/thumb/6/67/Reverse_proxy_h2g2bob.svg/280px-Reverse_proxy_h2g2bob.svg.png" /></span><br />A reverse proxy taking requests from the Internet and forwarding them to servers in an internal network. Those making requests connect to the proxy and may not be aware of the internal network.</p></blockquote></div><p>Modify ./nginx/conf/nginx.conf,<br /></p><div class="codebox"><pre><code>server {
    listen    80;
    server_name    localhost;
#    location / {
#        root    html;
#        index    index.html index.htm;
#    }
    location / {
        proxy_pass    http://downloads.openwrt.org/;
        proxy_redirect    default;
    }
}</code></pre></div><p>and start nginx. Start a browser and visit <a href="http://192.168.1.2">http://192.168.1.2</a> or <a href="http://127.0.0.1">http://127.0.0.1</a> to see if it works.</p><p>Reference: <a href="http://wiki.nginx.org/ProxyNagios">ProxyNagios</a></p><p>On OpenWrt,<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# uci add luci_hosts host
cfg02fe63
root@OpenWrt:~# uci set luci_hosts.@host[-1].hostname=downloads.openwrt.org
root@OpenWrt:~# uci set luci_hosts.@host[-1].ipaddr=192.168.1.2
root@OpenWrt:~# uci export luci_hosts
package &#039;luci_hosts&#039;

config &#039;host&#039;
        option &#039;hostname&#039; &#039;downloads.openwrt.org&#039;
        option &#039;ipaddr&#039; &#039;192.168.1.2&#039;

root@OpenWrt:~# /etc/init.d/luci_hosts restart
root@OpenWrt:~# ping -c 1 downloads.openwrt.org
PING downloads.openwrt.org (192.168.1.2): 56 data bytes
64 bytes from 192.168.1.2: seq=0 ttl=64 time=1.662 ms

--- downloads.openwrt.org ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 1.662/1.662/1.662 ms
root@OpenWrt:~# cat /etc/opkg.conf
src/gz snapshots http://downloads.openwrt.org/kamikaze/8.09.2/atheros/packages
dest root /
dest ram /tmp
lists_dir ext /var/opkg-lists
option overlay_root /jffs
root@OpenWrt:~# opkg update
Downloading http://downloads.openwrt.org/kamikaze/8.09.2/atheros/packages/Packages.gz
Connecting to downloads.openwrt.org (192.168.1.2:80)
Packages.gz          100% |*******************************|   142k 00:00:00 ETA
Inflating http://downloads.openwrt.org/kamikaze/8.09.2/atheros/packages/Packages.gz
Updated list of available packages in /var/opkg-lists/snapshots
root@OpenWrt:~# opkg install mjpg-streamer
Installing mjpg-streamer (r68-2) to root...
Downloading http://downloads.openwrt.org/kamikaze/8.09.2/atheros/packages/mjpg-streamer_r68-2_mips.ipk
Connecting to downloads.openwrt.org (192.168.1.2:80)
mjpg-streamer_r68-2_ 100% |*******************************|   111k 00:00:00 ETA
Installing libpthread (0.9.29-14.3) to root...
Downloading http://downloads.openwrt.org/kamikaze/8.09.2/atheros/packages/libpthread_0.9.29-14.3_mips.ipk
Connecting to downloads.openwrt.org (192.168.1.2:80)
libpthread_0.9.29-14 100% |*******************************| 19212  00:00:00 ETA
Installing libjpeg (6b-1) to root...
Downloading http://downloads.openwrt.org/kamikaze/8.09.2/atheros/packages/libjpeg_6b-1_mips.ipk
Connecting to downloads.openwrt.org (192.168.1.2:80)
libjpeg_6b-1_mips.ip 100% |*******************************| 57891  00:00:00 ETA
Configuring libjpeg
Configuring libpthread
Configuring mjpg-streamer</code></pre></div><p>To revert luci_hosts configuration,<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# uci revert luci_hosts</code></pre></div><p>In this way, you don&#039;t have to worry about <strong>package dependence</strong>.</p><p><strong>Edit:</strong><br />There&#039;s no need to alter LAN gateway. The &quot;ping&quot; after &quot;luci_hosts restart&quot; had proved it.</p></blockquote></div><p>Using Kamikaze 8.09.2 everything works up until opkg update which says:<br /></p><div class="codebox"><pre><code>Downloading http://downloads.openwrt.org/kamikaze/8.09.2/brcm47xx/packages/Packages.gz
Connecting to downloads.openwrt.org (127.0.0.1:80)
wget: server returned error: HTTP/1.0 404 Not Found
Collected errors:
 * opkg_download: ERROR: Command failed with return value 1: `wget --passive-ftp    -P /tmp/opkg-mzggPl http://downloads.openwrt.org/kamikaze/8.09.2/brcm47xx/packages/Packages.gz&#039;</code></pre></div><p>I can ping downloads.openwrt.org okay:<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# ping -c 1 downloads.openwrt.org
PING downloads.openwrt.org (127.0.0.1): 56 data bytes
64 bytes from 127.0.0.1: seq=0 ttl=64 time=1.054 ms

--- downloads.openwrt.org ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 1.054/1.054/1.054 ms</code></pre></div><p>Sorry if bumping old topics is frowned on.</p>											<p class="post-edited">(Last edited by <strong>charlie_slh</strong> on 24 Feb 2015, 19:22)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 2 of 2</div><nav><ul><li><a href="viewtopic.php%3Fid=32664&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>