<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Cant connect to VPN</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 30 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p362285">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">johanrd</div>
					<div class="post-datetime">
						19 Jul 2017, 14:42					</div>
				</div>
				<div class="post-content content">
					<p>Hi all,</p><p>I&#039;ve got some issues with openvpn/strongswan.</p><p>I have created a CA/server/mobileconfig using Arokhs script.</p><p>When I try to connect the VPN from my iphone I get the following log entries but its not connecting.</p><div class="codebox"><pre><code>Wed Jul 19 13:27:09 2017 daemon.info : 03[NET] received packet: from 192.168.1.68[500] to 192.168.1.93[500]
Wed Jul 19 13:27:09 2017 daemon.info : 03[NET] waiting for data on sockets
Wed Jul 19 13:27:09 2017 daemon.info : 10[NET] received packet: from 192.168.1.68[500] to 192.168.1.93[500] (432 bytes)
Wed Jul 19 13:27:09 2017 daemon.info : 10[ENC] parsed IKE_SA_INIT request 0 [ SA KE No N(REDIR_SUP) N(NATD_S_IP) N(NATD_D_IP) N(FRAG_SUP) ]
Wed Jul 19 13:27:09 2017 daemon.info : 10[CFG] looking for an ike config for 192.168.1.93...192.168.1.68
Wed Jul 19 13:27:09 2017 daemon.info : 10[CFG]   candidate: %any...%any, prio 28
Wed Jul 19 13:27:09 2017 daemon.info : 10[CFG] found matching ike config: %any...%any with prio 28
Wed Jul 19 13:27:09 2017 daemon.info : 10[IKE] 192.168.1.68 is initiating an IKE_SA
Wed Jul 19 13:27:09 2017 authpriv.info : 10[IKE] 192.168.1.68 is initiating an IKE_SA
Wed Jul 19 13:27:09 2017 daemon.info : 10[IKE] IKE_SA (unnamed)[1] state change: CREATED =&gt; CONNECTING
Wed Jul 19 13:27:09 2017 daemon.info : 10[CFG] selecting proposal:
Wed Jul 19 13:27:09 2017 daemon.info : 10[CFG]   no acceptable PSEUDO_RANDOM_FUNCTION found
Wed Jul 19 13:27:09 2017 daemon.info : 10[CFG] selecting proposal:
Wed Jul 19 13:27:09 2017 daemon.info : 10[CFG]   proposal matches
Wed Jul 19 13:27:09 2017 daemon.info : 10[CFG] received proposals: IKE:AES_CBC_128/HMAC_SHA1_96/PRF_HMAC_SHA1/MODP_2048
Wed Jul 19 13:27:09 2017 daemon.info : 10[CFG] configured proposals: IKE:AES_CBC_128/HMAC_SHA2_256_128/PRF_HMAC_SHA2_256/CURVE_25519, IKE:AES_CBC_128/AES_CBC_192/AES_CBC_256/3DES_CBC/HMAC_SHA2_256_128/HMAC_SHA2_384_192/HMAC_SHA2_512_256/HMAC_MD5_96/HMAC_SHA1_96/PRF_HMAC_SHA2_256/PRF_HMAC_SHA2_384/PRF_HMAC_SHA2_512/PRF_HMAC_MD5/PRF_HMAC_SHA1/ECP_256/ECP_384/ECP_521/ECP_256_BP/ECP_384_BP/ECP_512_BP/MODP_3072/MODP_4096/MODP_8192/MODP_2048/MODP_1024, IKE:AES_GCM_16_128/AES_GCM_16_192/AES_GCM_16_256/AES_GCM_12_Wed Jul 19 13:27:09 2017 daemon.info : 10[CFG] selected proposal: IKE:AES_CBC_128/HMAC_SHA1_96/PRF_HMAC_SHA1/MODP_2048
Wed Jul 19 13:27:10 2017 daemon.info : 10[IKE] sending cert request for &quot;C=CA, O=192.168.1.93, CN=192.168.1.93 Root CA&quot;
Wed Jul 19 13:27:10 2017 daemon.info : 10[IKE] sending cert request for &quot;CN=OpenWrt CA&quot;
Wed Jul 19 13:27:10 2017 daemon.info : 10[ENC] generating IKE_SA_INIT response 0 [ SA KE No N(NATD_S_IP) N(NATD_D_IP) CERTREQ N(FRAG_SUP) N(MULT_AUTH) ]
Wed Jul 19 13:27:10 2017 daemon.info : 10[NET] sending packet: from 192.168.1.93[500] to 192.168.1.68[500] (493 bytes)
Wed Jul 19 13:27:10 2017 daemon.info : 04[NET] sending packet: from 192.168.1.93[500] to 192.168.1.68[500]
Wed Jul 19 13:27:10 2017 daemon.info : 03[NET] received packet: from 192.168.1.68[4500] to 192.168.1.93[4500]
Wed Jul 19 13:27:10 2017 daemon.info : 03[NET] waiting for data on sockets
Wed Jul 19 13:27:10 2017 daemon.info : 03[NET] received packet: from 192.168.1.68[4500] to 192.168.1.93[4500]
Wed Jul 19 13:27:10 2017 daemon.info : 03[NET] waiting for data on sockets
Wed Jul 19 13:27:10 2017 daemon.info : 11[NET] received packet: from 192.168.1.68[4500] to 192.168.1.93[4500] (544 bytes)
Wed Jul 19 13:27:10 2017 daemon.info : 11[ENC] parsed IKE_AUTH request 1 [ EF(1/2) ]
Wed Jul 19 13:27:10 2017 daemon.info : 11[ENC] received fragment #1 of 2, waiting for complete IKE message
Wed Jul 19 13:27:10 2017 daemon.info : 11[NET] received packet: from 192.168.1.68[4500] to 192.168.1.93[4500] (512 bytes)
Wed Jul 19 13:27:10 2017 daemon.info : 11[ENC] parsed IKE_AUTH request 1 [ EF(2/2) ]
Wed Jul 19 13:27:10 2017 daemon.info : 11[ENC] received fragment #2 of 2, reassembling fragmented IKE message
Wed Jul 19 13:27:10 2017 daemon.info : 11[ENC] unknown attribute type (25)
Wed Jul 19 13:27:10 2017 daemon.info : 11[ENC] parsed IKE_AUTH request 1 [ IDi N(INIT_CONTACT) N(MOBIKE_SUP) IDr AUTH CERT CPRQ(ADDR DHCP DNS MASK ADDR6 DHCP6 DNS6 (25)) N(ESP_TFC_PAD_N) N(NON_FIRST_FRAG) SA TSi TSr ]
Wed Jul 19 13:27:10 2017 daemon.info : 11[IKE] received end entity cert &quot;CN=johan1&quot;
Wed Jul 19 13:27:10 2017 daemon.info : 11[CFG] looking for peer configs matching 192.168.1.93[192.168.1.93]...192.168.1.68[johan1]
Wed Jul 19 13:27:10 2017 daemon.info : 11[CFG]   candidate &quot;johan1&quot;, match: 20/1/28 (me/other/ike)
Wed Jul 19 13:27:10 2017 daemon.info : 11[CFG] selected peer config &#039;johan1&#039;
Wed Jul 19 13:27:10 2017 daemon.info : 11[CFG]   using certificate &quot;CN=johan1&quot;
Wed Jul 19 13:27:10 2017 daemon.info : 11[CFG]   certificate &quot;CN=johan1&quot; key: 1024 bit RSA
Wed Jul 19 13:27:10 2017 daemon.info : 11[CFG]   using trusted ca certificate &quot;CN=OpenWrt CA&quot;
Wed Jul 19 13:27:10 2017 daemon.info : 11[CFG]   certificate &quot;CN=OpenWrt CA&quot; key: 1024 bit RSA
Wed Jul 19 13:27:10 2017 daemon.info : 11[CFG]   reached self-signed root ca with a path length of 0
Wed Jul 19 13:27:10 2017 daemon.info : 11[IKE] authentication of &#039;johan1&#039; with RSA signature successful
Wed Jul 19 13:27:10 2017 daemon.info : 11[CFG] constraint requires EAP_TLS, but EAP_NAK was used
Wed Jul 19 13:27:10 2017 daemon.info : 11[CFG] selected peer config &#039;johan1&#039; inacceptable: non-matching authentication done
Wed Jul 19 13:27:10 2017 daemon.info : 11[CFG] no alternative config found
Wed Jul 19 13:27:10 2017 daemon.info : 11[IKE] processing INTERNAL_IP4_ADDRESS attribute
Wed Jul 19 13:27:10 2017 daemon.info : 11[IKE] processing INTERNAL_IP4_DHCP attribute
Wed Jul 19 13:27:10 2017 daemon.info : 11[IKE] processing INTERNAL_IP4_DNS attribute
Wed Jul 19 13:27:10 2017 daemon.info : 11[IKE] processing INTERNAL_IP4_NETMASK attribute
Wed Jul 19 13:27:10 2017 daemon.info : 11[IKE] processing INTERNAL_IP6_ADDRESS attribute
Wed Jul 19 13:27:10 2017 daemon.info : 11[IKE] processing INTERNAL_IP6_DHCP attribute
Wed Jul 19 13:27:10 2017 daemon.info : 11[IKE] processing INTERNAL_IP6_DNS attribute
Wed Jul 19 13:27:10 2017 daemon.info : 11[IKE] processing (25) attribute
Wed Jul 19 13:27:10 2017 daemon.info : 11[IKE] received ESP_TFC_PADDING_NOT_SUPPORTED, not using ESPv3 TFC padding
Wed Jul 19 13:27:10 2017 daemon.info : 11[IKE] peer supports MOBIKE
Wed Jul 19 13:27:10 2017 daemon.info : 11[ENC] generating IKE_AUTH response 1 [ N(AUTH_FAILED) ]
Wed Jul 19 13:27:10 2017 daemon.info : 11[NET] sending packet: from 192.168.1.93[4500] to 192.168.1.68[4500] (76 bytes)
Wed Jul 19 13:27:10 2017 daemon.info : 04[NET] sending packet: from 192.168.1.93[4500] to 192.168.1.68[4500]
Wed Jul 19 13:27:10 2017 daemon.info : 11[IKE] IKE_SA johan1[1] state change: CONNECTING =&gt; DESTROYING</code></pre></div><p>IPSEC.CONF<br /></p><div class="codebox"><pre><code>config setup
        # strictcrlpolicy=yes
        # uniqueids = no
        charondebug=&quot;cfg 2, dmn 2, ike 2, net 2&quot;

# Add connections here.

conn johan1
    keyexchange=ikev2
    esp=aes128gcm16-ecp256,aes256gcm16-ecp384,aes128-sha256-ecp256,aes256-sha384-ecp384,aes128-sha256-modp2048,aes128-sha1-modp2048,aes256-sha384-modp4096,aes256-sha256-modp4096,aes256-sha1-modp4096,ae$
    dpdaction=clear
    dpddelay=300s
    ExtendedAuthEnabled=0
    rekey=no
    leftsendcert=always
    leftauth=pubkey
    leftfirewall=yes
    leftid=192.168.1.93
    leftsubnet=0.0.0.0/0
    leftcert=/etc/CA/serverCert.pem
    right=%any
    rightdns=8.8.8.8,8.8.4.4
    rightsourceip=10.66.0.1/24
    rightauth=eap-tls
    rightsendcert=yes
    auto=add</code></pre></div><p>This is all setup on the lan.</p><p>Internet (where my iPhone has an IP) [192.168.1.*]-&gt; router with OpenVPN(172.16.1.*) [wan ip: 192.168.1.93].</p><p>Any idea why this is not connecting?</p>											<p class="post-edited">(Last edited by <strong>johanrd</strong> on 19 Jul 2017, 14:47)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p362309">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">slh</div>
					<div class="post-datetime">
						19 Jul 2017, 23:02					</div>
				</div>
				<div class="post-content content">
					<p>Remove the esp= line for testing, so it can fall back to its defaults.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p362321">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">johanrd</div>
					<div class="post-datetime">
						20 Jul 2017, 11:14					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for the reply. Still getting the same error unfortunately.</p><div class="codebox"><pre><code>Thu Jul 20 10:10:42 2017 daemon.info : 03[NET] received packet: from 192.168.1.68[500] to 192.168.1.93[500]
Thu Jul 20 10:10:42 2017 daemon.info : 03[NET] waiting for data on sockets
Thu Jul 20 10:10:42 2017 daemon.info : 07[NET] received packet: from 192.168.1.68[500] to 192.168.1.93[500] (432 bytes)
Thu Jul 20 10:10:42 2017 daemon.info : 07[ENC] parsed IKE_SA_INIT request 0 [ SA KE No N(REDIR_SUP) N(NATD_S_IP) N(NATD_D_IP) N(FRAG_SUP) ]
Thu Jul 20 10:10:42 2017 daemon.info : 07[CFG] looking for an ike config for 192.168.1.93...192.168.1.68
Thu Jul 20 10:10:42 2017 daemon.info : 07[CFG]   candidate: %any...%any, prio 28
Thu Jul 20 10:10:42 2017 daemon.info : 07[CFG] found matching ike config: %any...%any with prio 28
Thu Jul 20 10:10:42 2017 daemon.info : 07[IKE] 192.168.1.68 is initiating an IKE_SA
Thu Jul 20 10:10:42 2017 authpriv.info : 07[IKE] 192.168.1.68 is initiating an IKE_SA
Thu Jul 20 10:10:42 2017 daemon.info : 07[IKE] IKE_SA (unnamed)[1] state change: CREATED =&gt; CONNECTING
Thu Jul 20 10:10:42 2017 daemon.info : 07[CFG] selecting proposal:
Thu Jul 20 10:10:42 2017 daemon.info : 07[CFG]   no acceptable PSEUDO_RANDOM_FUNCTION found
Thu Jul 20 10:10:42 2017 daemon.info : 07[CFG] selecting proposal:
Thu Jul 20 10:10:42 2017 daemon.info : 07[CFG]   proposal matches
Thu Jul 20 10:10:42 2017 daemon.info : 07[CFG] received proposals: IKE:AES_CBC_128/HMAC_SHA1_96/PRF_HMAC_SHA1/MODP_2048
Thu Jul 20 10:10:42 2017 daemon.info : 07[CFG] configured proposals: IKE:AES_CBC_128/HMAC_SHA2_256_128/PRF_HMAC_SHA2_256/CURVE_25519, IKE:AES_CBC_128/AES_CBC_192/AES_CBC_256/3DES_CBC/HMAC_SHA2_256_128/HMAC_SHA2_384_192/HMAC_SHA2_512_256/HMAC_MD5_96/HMAC_SHA1_96/PRF_HMAC_SHA2_256/PRF_HMAC_SHA2_384/PRF_HMAC_SHA2_512/PRF_HMAC_MD5/PRF_HMAC_SHA1/ECP_256/ECP_384/ECP_521/ECP_256_BP/ECP_384_BP/ECP_512_BP/MODP_3072/MODP_4096/MODP_8192/MODP_2048/MODP_1024, IKE:AES_GCM_16_128/AES_GCM_16_192/AES_GCM_16_256/AES_GCM_12_Thu Jul 20 10:10:42 2017 daemon.info : 07[CFG] selected proposal: IKE:AES_CBC_128/HMAC_SHA1_96/PRF_HMAC_SHA1/MODP_2048
Thu Jul 20 10:10:42 2017 daemon.info : 07[IKE] sending cert request for &quot;C=CA, O=192.168.1.93, CN=192.168.1.93 Root CA&quot;
Thu Jul 20 10:10:42 2017 daemon.info : 07[IKE] sending cert request for &quot;CN=OpenWrt CA&quot;
Thu Jul 20 10:10:42 2017 daemon.info : 07[ENC] generating IKE_SA_INIT response 0 [ SA KE No N(NATD_S_IP) N(NATD_D_IP) CERTREQ N(FRAG_SUP) N(MULT_AUTH) ]
Thu Jul 20 10:10:42 2017 daemon.info : 07[NET] sending packet: from 192.168.1.93[500] to 192.168.1.68[500] (493 bytes)
Thu Jul 20 10:10:42 2017 daemon.info : 04[NET] sending packet: from 192.168.1.93[500] to 192.168.1.68[500]
Thu Jul 20 10:10:42 2017 daemon.info : 03[NET] received packet: from 192.168.1.68[4500] to 192.168.1.93[4500]
Thu Jul 20 10:10:42 2017 daemon.info : 03[NET] waiting for data on sockets
Thu Jul 20 10:10:42 2017 daemon.info : 03[NET] received packet: from 192.168.1.68[4500] to 192.168.1.93[4500]
Thu Jul 20 10:10:42 2017 daemon.info : 03[NET] waiting for data on sockets
Thu Jul 20 10:10:42 2017 daemon.info : 08[NET] received packet: from 192.168.1.68[4500] to 192.168.1.93[4500] (544 bytes)
Thu Jul 20 10:10:42 2017 daemon.info : 08[ENC] parsed IKE_AUTH request 1 [ EF(1/2) ]
Thu Jul 20 10:10:42 2017 daemon.info : 08[ENC] received fragment #1 of 2, waiting for complete IKE message
Thu Jul 20 10:10:42 2017 daemon.info : 08[NET] received packet: from 192.168.1.68[4500] to 192.168.1.93[4500] (512 bytes)
Thu Jul 20 10:10:42 2017 daemon.info : 08[ENC] parsed IKE_AUTH request 1 [ EF(2/2) ]
Thu Jul 20 10:10:42 2017 daemon.info : 08[ENC] received fragment #2 of 2, reassembling fragmented IKE message
Thu Jul 20 10:10:42 2017 daemon.info : 08[ENC] unknown attribute type (25)
Thu Jul 20 10:10:42 2017 daemon.info : 08[ENC] parsed IKE_AUTH request 1 [ IDi N(INIT_CONTACT) N(MOBIKE_SUP) IDr AUTH CERT CPRQ(ADDR DHCP DNS MASK ADDR6 DHCP6 DNS6 (25)) N(ESP_TFC_PAD_N) N(NON_FIRST_FRAG) SA TSi TSr ]
Thu Jul 20 10:10:42 2017 daemon.info : 08[IKE] received end entity cert &quot;CN=johan1&quot;
Thu Jul 20 10:10:42 2017 daemon.info : 08[CFG] looking for peer configs matching 192.168.1.93[192.168.1.93]...192.168.1.68[johan1]
Thu Jul 20 10:10:42 2017 daemon.info : 08[CFG]   candidate &quot;johan1&quot;, match: 20/1/28 (me/other/ike)
Thu Jul 20 10:10:42 2017 daemon.info : 08[CFG] selected peer config &#039;johan1&#039;
Thu Jul 20 10:10:42 2017 daemon.info : 08[CFG]   using certificate &quot;CN=johan1&quot;
Thu Jul 20 10:10:42 2017 daemon.info : 08[CFG]   certificate &quot;CN=johan1&quot; key: 1024 bit RSA
Thu Jul 20 10:10:42 2017 daemon.info : 08[CFG]   using trusted ca certificate &quot;CN=OpenWrt CA&quot;
Thu Jul 20 10:10:42 2017 daemon.info : 08[CFG]   certificate &quot;CN=OpenWrt CA&quot; key: 1024 bit RSA
Thu Jul 20 10:10:42 2017 daemon.info : 08[CFG]   reached self-signed root ca with a path length of 0
Thu Jul 20 10:10:42 2017 daemon.info : 08[IKE] authentication of &#039;johan1&#039; with RSA signature successful
Thu Jul 20 10:10:42 2017 daemon.info : 08[CFG] constraint requires EAP_TLS, but EAP_NAK was used
Thu Jul 20 10:10:42 2017 daemon.info : 08[CFG] selected peer config &#039;johan1&#039; inacceptable: non-matching authentication done
Thu Jul 20 10:10:42 2017 daemon.info : 08[CFG] no alternative config found
Thu Jul 20 10:10:42 2017 daemon.info : 08[IKE] processing INTERNAL_IP4_ADDRESS attribute
Thu Jul 20 10:10:42 2017 daemon.info : 08[IKE] processing INTERNAL_IP4_DHCP attribute
Thu Jul 20 10:10:42 2017 daemon.info : 08[IKE] processing INTERNAL_IP4_DNS attribute
Thu Jul 20 10:10:42 2017 daemon.info : 08[IKE] processing INTERNAL_IP4_NETMASK attribute
Thu Jul 20 10:10:42 2017 daemon.info : 08[IKE] processing INTERNAL_IP6_ADDRESS attribute
Thu Jul 20 10:10:42 2017 daemon.info : 08[IKE] processing INTERNAL_IP6_DHCP attribute
Thu Jul 20 10:10:42 2017 daemon.info : 08[IKE] processing INTERNAL_IP6_DNS attribute
Thu Jul 20 10:10:42 2017 daemon.info : 08[IKE] processing (25) attribute
Thu Jul 20 10:10:42 2017 daemon.info : 08[IKE] received ESP_TFC_PADDING_NOT_SUPPORTED, not using ESPv3 TFC padding
Thu Jul 20 10:10:42 2017 daemon.info : 08[IKE] peer supports MOBIKE
Thu Jul 20 10:10:42 2017 daemon.info : 08[ENC] generating IKE_AUTH response 1 [ N(AUTH_FAILED) ]
Thu Jul 20 10:10:42 2017 daemon.info : 08[NET] sending packet: from 192.168.1.93[4500] to 192.168.1.68[4500] (76 bytes)
Thu Jul 20 10:10:42 2017 daemon.info : 04[NET] sending packet: from 192.168.1.93[4500] to 192.168.1.68[4500]
Thu Jul 20 10:10:42 2017 daemon.info : 08[IKE] IKE_SA johan1[1] state change: CONNECTING =&gt; DESTROYING</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p362568">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">johanrd</div>
					<div class="post-datetime">
						24 Jul 2017, 22:36					</div>
				</div>
				<div class="post-content content">
					<p>Ok, so I think I&#039;ve gotten further, but I&#039;m still being thrown out straight away.</p><br /><p>My ipsec.conf is now:<br /></p><div class="codebox"><pre><code>config setup

conn %default
 keyexchange=ikev2

conn roadwarrior
 left=%any
 leftauth=pubkey
 leftcert=/etc/CA/serverCert.pem
 leftid=myddnsentry.ddns.net
 leftsubnet=0.0.0.0/0,::/0
 right=%any
 rightsourceip=10.0.1.0/24
 auto=add</code></pre></div><p>And here is the log:<br /></p><div class="codebox"><pre><code>Mon Jul 24 21:31:12 2017 daemon.info : 12[NET] received packet: from a.a.a.a[24073] to x.x.x.x[500] (432 bytes)
Mon Jul 24 21:31:12 2017 daemon.info : 12[ENC] parsed IKE_SA_INIT request 0 [ SA KE No N(REDIR_SUP) N(NATD_S_IP) N(NATD_D_IP) N(FRAG_SUP) ]
Mon Jul 24 21:31:12 2017 daemon.info : 12[IKE] a.a.a.a is initiating an IKE_SA
Mon Jul 24 21:31:12 2017 authpriv.info : 12[IKE] a.a.a.a is initiating an IKE_SA
Mon Jul 24 21:31:13 2017 daemon.info : 12[IKE] remote host is behind NAT
Mon Jul 24 21:31:13 2017 daemon.info : 12[IKE] sending cert request for &quot;CN=OpenWrt CA&quot;
Mon Jul 24 21:31:13 2017 daemon.info : 12[ENC] generating IKE_SA_INIT response 0 [ SA KE No N(NATD_S_IP) N(NATD_D_IP) CERTREQ N(FRAG_SUP) N(MULT_AUTH) ]
Mon Jul 24 21:31:13 2017 daemon.info : 12[NET] sending packet: from x.x.x.x[500] to a.a.a.a[24073] (473 bytes)
Mon Jul 24 21:31:13 2017 daemon.info : 13[NET] received packet: from a.a.a.a[12623] to x.x.x.x[4500] (544 bytes)
Mon Jul 24 21:31:13 2017 daemon.info : 13[ENC] parsed IKE_AUTH request 1 [ EF(1/2) ]
Mon Jul 24 21:31:13 2017 daemon.info : 13[ENC] received fragment #1 of 2, waiting for complete IKE message
Mon Jul 24 21:31:13 2017 daemon.info : 14[NET] received packet: from a.a.a.a[12623] to x.x.x.x[4500] (512 bytes)
Mon Jul 24 21:31:13 2017 daemon.info : 14[ENC] parsed IKE_AUTH request 1 [ EF(2/2) ]
Mon Jul 24 21:31:13 2017 daemon.info : 14[ENC] received fragment #2 of 2, reassembling fragmented IKE message
Mon Jul 24 21:31:13 2017 daemon.info : 14[ENC] unknown attribute type (25)
Mon Jul 24 21:31:13 2017 daemon.info : 14[ENC] parsed IKE_AUTH request 1 [ IDi N(INIT_CONTACT) N(MOBIKE_SUP) IDr AUTH CERT CPRQ(ADDR DHCP DNS MASK ADDR6 DHCP6 DNS6 (25)) N(ESP_TFC_PAD_N) N(NON_FIRST_FRAG) SA TSi TSr ]
Mon Jul 24 21:31:13 2017 daemon.info : 14[IKE] received end entity cert &quot;CN=johan&quot;
Mon Jul 24 21:31:13 2017 daemon.info : 14[CFG] looking for peer configs matching x.x.x.x[myddnsentry.ddns.net]...a.a.a.a[johan]
Mon Jul 24 21:31:13 2017 daemon.info : 14[CFG] selected peer config &#039;roadwarrior&#039;
Mon Jul 24 21:31:13 2017 daemon.info : 14[CFG]   using certificate &quot;CN=johan&quot;
Mon Jul 24 21:31:13 2017 daemon.info : 14[CFG]   using trusted ca certificate &quot;CN=OpenWrt CA&quot;
Mon Jul 24 21:31:13 2017 daemon.info : 14[CFG]   reached self-signed root ca with a path length of 0
Mon Jul 24 21:31:13 2017 daemon.info : 14[IKE] authentication of &#039;johan&#039; with RSA signature successful
Mon Jul 24 21:31:13 2017 daemon.info : 14[IKE] received ESP_TFC_PADDING_NOT_SUPPORTED, not using ESPv3 TFC padding
Mon Jul 24 21:31:13 2017 daemon.info : 14[IKE] peer supports MOBIKE
Mon Jul 24 21:31:13 2017 daemon.info : 14[IKE] authentication of &#039;myddnsentry.ddns.net&#039; (myself) with RSA signature successful
Mon Jul 24 21:31:13 2017 daemon.info : 14[IKE] destroying duplicate IKE_SA for peer &#039;johan&#039;, received INITIAL_CONTACT
Mon Jul 24 21:31:13 2017 daemon.info : 14[CFG] lease 10.0.1.1 by &#039;johan&#039; went offline
Mon Jul 24 21:31:13 2017 daemon.info : 14[IKE] IKE_SA roadwarrior[2] established between x.x.x.x[myddnsentry.ddns.net]...a.a.a.a[johan]
Mon Jul 24 21:31:13 2017 authpriv.info : 14[IKE] IKE_SA roadwarrior[2] established between x.x.x.x[myddnsentry.ddns.net]...a.a.a.a[johan]
Mon Jul 24 21:31:13 2017 daemon.info : 14[IKE] scheduling reauthentication in 9960s
Mon Jul 24 21:31:13 2017 daemon.info : 14[IKE] maximum IKE_SA lifetime 10500s
Mon Jul 24 21:31:13 2017 daemon.info : 14[IKE] peer requested virtual IP %any
Mon Jul 24 21:31:13 2017 daemon.info : 14[CFG] reassigning offline lease to &#039;johan&#039;
Mon Jul 24 21:31:13 2017 daemon.info : 14[IKE] assigning virtual IP 10.0.1.1 to peer &#039;johan&#039;
Mon Jul 24 21:31:13 2017 daemon.info : 14[IKE] peer requested virtual IP %any6
Mon Jul 24 21:31:13 2017 daemon.info : 14[IKE] no virtual IP found for %any6 requested by &#039;johan&#039;
Mon Jul 24 21:31:13 2017 daemon.info : 14[IKE] CHILD_SA roadwarrior{2} established with SPIs c6b498d8_i 054a4029_o and TS 0.0.0.0/0 ::/0 === 10.0.1.1/32
Mon Jul 24 21:31:13 2017 authpriv.info : 14[IKE] CHILD_SA roadwarrior{2} established with SPIs c6b498d8_i 054a4029_o and TS 0.0.0.0/0 ::/0 === 10.0.1.1/32
Mon Jul 24 21:31:13 2017 daemon.info : 14[ENC] generating IKE_AUTH response 1 [ IDr AUTH CPRP(ADDR) SA TSi TSr N(AUTH_LFT) N(MOBIKE_SUP) N(ADD_4_ADDR) N(ADD_4_ADDR) N(ADD_6_ADDR) ]
Mon Jul 24 21:31:13 2017 daemon.info : 14[NET] sending packet: from x.x.x.x[4500] to a.a.a.a[12623] (444 bytes)</code></pre></div><p>x.x.x.x is my external IP<br />myddnsentry.ddns.net is not my real ddns entry<br />a.a.a.a is my phones ip (not on wifi)</p><br /><p>Any suggestions?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>