<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> USB not working on Asus 520gu with kernel 2.6</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 27 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p80394">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">celejar</div>
					<div class="post-datetime">
						26 Jan 2009, 04:43					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>The 520gu is a Broadcom BCM5354 based unit with USB support.&nbsp; With a 2.4 kernel, USB works:</p><div class="codebox"><pre><code>root@OpenWrt:/# dmesg | grep -i usb
usb.c: registered new driver usbdevfs
usb.c: registered new driver hub
SB USB20H init
SB USB20H resetting
USB20H fcr: 0x64
USB20H shim cr: 0x8f7
usb-ohci.c: USB OHCI at membase 0xb8003000, IRQ 6
usb-ohci.c: usb-00:03.0, PCI device 14e4:471a
usb.c: new USB bus registered, assigned bus number 1
hub.c: USB hub found
uhci.c: USB Universal Host Controller Interface driver v1.1</code></pre></div><p>[It needs OHCI; this build has UHCI also just for testing.]</p><p>With 2.6, the drivers load, but they don&#039;t find the hardware:</p><div class="codebox"><pre><code>root@OpenWrt#dmesg | egrep (USB|usb)
ssb: Core 3 found: USB 2.0 Host (cc 0x819, rev 0x02, vendor 0x4243)
usbcore: registered new interface driver usbfs
usbcore: registered new interface driver hub
usbcore: registered new device driver usb
ohci_hcd: 2006 August 04 USB 1.1 &#039;Open&#039; Host Controller (OHCI) Driver</code></pre></div><p>Does anyone know what this is all about?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p80424">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">yaadgiri</div>
					<div class="post-datetime">
						26 Jan 2009, 16:27					</div>
				</div>
				<div class="post-content content">
					<p>you may try to apply the patch and see<br /><a href="https://lab.openwireless.ch/trac/browser/firmware/freifunk/trunk/ff-ng/freifunk-openwrt.patch?rev=638">https://lab.openwireless.ch/trac/browse … ch?rev=638</a><br />cheers</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p80646">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">celejar</div>
					<div class="post-datetime">
						29 Jan 2009, 06:59					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>yaadgiri wrote:</cite><blockquote><p>you may try to apply the patch and see<br /><a href="https://lab.openwireless.ch/trac/browser/firmware/freifunk/trunk/ff-ng/freifunk-openwrt.patch?rev=638">https://lab.openwireless.ch/trac/browse … ch?rev=638</a><br />cheers</p></blockquote></div><p>Thanks, but it doesn&#039;t apply to my bleeding edge tree.&nbsp; Against what should I be applying this?&nbsp; Can you explain a bit more what this does?&nbsp; It looks like mostly just a bunch of changes to .config; what is supposed to affect USB support?</p>											<p class="post-edited">(Last edited by <strong>celejar</strong> on 29 Jan 2009, 07:00)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p81254">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">slx</div>
					<div class="post-datetime">
						6 Feb 2009, 23:05					</div>
				</div>
				<div class="post-content content">
					<p>Hi<br />I have similar problem with other hardware ( Siemens SE505 v2 - BCM4712).&nbsp; I tried&nbsp; 7.09, 8.09rc2 and newest snapshot.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p81266">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">RussellK</div>
					<div class="post-datetime">
						7 Feb 2009, 05:01					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m having exactly the same problem here with an Asus WL500G</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p81269">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">ymhee_bcex</div>
					<div class="post-datetime">
						7 Feb 2009, 06:55					</div>
				</div>
				<div class="post-content content">
					<p>There&#039;s got to be more than that, because I have no problem with Asus WL500gP. I described the steps here: <a href="http://www.rabinovich.org/drupal/node/86">http://www.rabinovich.org/drupal/node/86</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p81271">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">RussellK</div>
					<div class="post-datetime">
						7 Feb 2009, 07:04					</div>
				</div>
				<div class="post-content content">
					<p>Well, I spent about an hour this morning trying to get 8.09_RC2 brcm47xx to see the USB port with no success. However 8.09_RC2 brcm-2.4 works fine. Note I&#039;m referring to a WL500G, not a WL500GP.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p83704">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">slx</div>
					<div class="post-datetime">
						11 Mar 2009, 21:57					</div>
				</div>
				<div class="post-content content">
					<p>I found a solution for my problem. This is answer: <a href="https://dev.openwrt.org/ticket/2437">https://dev.openwrt.org/ticket/2437</a><br />I built kamikaze 8.09 2.6 kernel with option CONFIG_USB_OHCI_HCD_SSB=y and my usb card reader started working. <br /></p><div class="codebox"><pre><code> 
ohci_hcd: 2006 August 04 USB 1.1 &#039;Open&#039; Host Controller (OHCI) Driver
ohci_hcd ssb0:3: SSB OHCI Controller
ohci_hcd ssb0:3: new USB bus registered, assigned bus number 1
ohci_hcd ssb0:3: irq 6, io mem 0x18004000
usb usb1: configuration #1 chosen from 1 choice
hub 1-0:1.0: USB hub found
hub 1-0:1.0: 2 ports detected
usb 1-2: new low speed USB device using ohci_hcd and address 2
usb 1-2: device descriptor read/64, error -62
Initializing USB Mass Storage driver...
usb 1-2: device descriptor read/64, error -62
usb 1-2: new low speed USB device using ohci_hcd and address 3
usb 1-2: device descriptor read/64, error -62
usb 1-2: device descriptor read/64, error -62
usb 1-2: new low speed USB device using ohci_hcd and address 4
usb 1-2: device not accepting address 4, error -62
usb 1-2: new low speed USB device using ohci_hcd and address 5
usb 1-2: device not accepting address 5, error -62
hub 1-0:1.0: unable to enumerate USB device on port 2
usbcore: registered new interface driver usb-storage
USB Mass Storage support registered.</code></pre></div><p>This should work for WL500g too.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p83820">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">routerWhacker</div>
					<div class="post-datetime">
						13 Mar 2009, 19:56					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>slx wrote:</cite><blockquote><p>I found a solution for my problem. This is answer: <a href="https://dev.openwrt.org/ticket/2437">https://dev.openwrt.org/ticket/2437</a><br />I built kamikaze 8.09 2.6 kernel with option CONFIG_USB_OHCI_HCD_SSB=y and my usb card reader started working. <br /></p><div class="codebox"><pre><code> 
ohci_hcd: 2006 August 04 USB 1.1 &#039;Open&#039; Host Controller (OHCI) Driver
ohci_hcd ssb0:3: SSB OHCI Controller
ohci_hcd ssb0:3: new USB bus registered, assigned bus number 1
ohci_hcd ssb0:3: irq 6, io mem 0x18004000
usb usb1: configuration #1 chosen from 1 choice
hub 1-0:1.0: USB hub found
hub 1-0:1.0: 2 ports detected
usb 1-2: new low speed USB device using ohci_hcd and address 2
usb 1-2: device descriptor read/64, error -62
Initializing USB Mass Storage driver...
usb 1-2: device descriptor read/64, error -62
usb 1-2: new low speed USB device using ohci_hcd and address 3
usb 1-2: device descriptor read/64, error -62
usb 1-2: device descriptor read/64, error -62
usb 1-2: new low speed USB device using ohci_hcd and address 4
usb 1-2: device not accepting address 4, error -62
usb 1-2: new low speed USB device using ohci_hcd and address 5
usb 1-2: device not accepting address 5, error -62
hub 1-0:1.0: unable to enumerate USB device on port 2
usbcore: registered new interface driver usb-storage
USB Mass Storage support registered.</code></pre></div><p>This should work for WL500g too.</p></blockquote></div><p>slx, you&#039;re running on WL-520gU?<br />IIRC, the WL500g does not use the builtin usb interface; ie. it use a separate chip for the hub</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p83830">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">slx</div>
					<div class="post-datetime">
						13 Mar 2009, 23:29					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>routerWhacker wrote:</cite><blockquote><p>slx, you&#039;re running on WL-520gU?</p></blockquote></div><p>No, i don&#039;t have any Asus unit.<br /></p><div class="quotebox"><blockquote><p>IIRC, the WL500g does not use the builtin usb interface; ie. it use a separate chip for the hub</p></blockquote></div><p>I was not sure about it and i searched for some info. Look at the photo: <a href="http://files.wl500g.info/asus/wl500g/img/rev2.40/HPIM1736.JPG">http://files.wl500g.info/asus/wl500g/im … IM1736.JPG</a> <br />there is no separate USB chip.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p83831">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">routerWhacker</div>
					<div class="post-datetime">
						14 Mar 2009, 00:14					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>slx wrote:</cite><blockquote><div class="quotebox"><cite>routerWhacker wrote:</cite><blockquote><p>slx, you&#039;re running on WL-520gU?</p></blockquote></div><p>No, i don&#039;t have any Asus unit.<br /></p><div class="quotebox"><blockquote><p>IIRC, the WL500g does not use the builtin usb interface; ie. it use a separate chip for the hub</p></blockquote></div><p>I was not sure about it and i searched for some info. Look at the photo: <a href="http://files.wl500g.info/asus/wl500g/img/rev2.40/HPIM1736.JPG">http://files.wl500g.info/asus/wl500g/im … IM1736.JPG</a> <br />there is no separate USB chip.</p></blockquote></div><p>slx, thanks for the info</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>