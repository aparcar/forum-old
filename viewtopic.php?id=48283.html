<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> DNS doesn&#039;t work after connected to OpenVPN.</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 15 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p222025">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">jbcdidgosir</div>
					<div class="post-datetime">
						8 Jan 2014, 04:36					</div>
				</div>
				<div class="post-content content">
					<p>I use openwrt on ZTE H618B router. Config VPN client and Tinyproxy to break the Internet blockage in the company. It works perfectly in my company. My friend also asked me to give him a same router to use in his company for the same purpose. So I configed a new router with the same configuration, just LAN network from default to 10.0.0.1/24 to avoid conflict(his local network is 192.168.3.X, so 192.168.1.X is suspected to exists). Proxy changed to 170.45.67.2, so route command (route add -new 170.0.0.0 netmask 255.0.0.0 gw 192.168.1.1) in his router.</p><p>Now his router can connect to my VPN server. But he still couldn&#039;t access to any website. After puttying his router, I found that it is because the DNS didn&#039;t work in his router. Router responded &#039;bad address...&#039; for pinging all the web sites. But it&#039;s OK if I ping an IP address. So it is obviously that the problem of DNS.</p><p>But I&#039;m sure that DNS works OK at initialization. Because my VPN server is a domain, not an IP address. So router must be able to resolve my VPN domain before connecting the VPN. The problem is: DNS doesn&#039;t work after connected to VPN.</p><p>Puttying in his router, I can ping all the intranet including company&#039;s DNS server(170.32.45.98). Open /tmp/resolv.conf or /tmp/resolv.conf.auto, I can see &quot;nameserver 170.32.45.98&quot;. That seems correct. Progress &quot;dnsmasq&quot; still exists after running &quot;ps&quot;. It still doesn&#039;t work even running &quot;/ect/init.d/dnsmasq restart&quot;</p><p>Anyone knows the reason? Thanks!</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>