<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> ipsec connection to LANCOM router</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 10 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p18294">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">ALuedtke</div>
					<div class="post-datetime">
						4 Jan 2006, 13:54					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m trying now for several days to establish a vpn connection between openWRT WR RC4 on a Linksys WRT54GS V4 and a LANCOM 1711. But so far I have no luck. I was able to connect to our company gateway (LANCOM) with an IPcop 1.4.10 box. I took the ipsec configuration from IPcop and removed the parts from ipsec.conf that were not allowed in openWRT. In addition, I had to add a line with &quot;version 2.0&quot;. </p><p>I&#039;ve tried in the past days all possible parameter settings I could think of, but I didn&#039;t succeed. So I ask you to point me in the right direction.</p><p>I see that the connection comes up to STATE_MAIN_I4 but stucks then because it waits for &quot;phase 1 is done, looking for phase 1 to unpend&quot; but this does never happen. Is there an ipsec settings that I can turn on in order to make it more LANCOM compatible?</p><p>Thanks in advance</p><p>Andreas</p><p>My ipsec.conf looks as follows:<br /></p><div class="quotebox"><blockquote><p>version&nbsp; &nbsp; 2.0&nbsp; &nbsp; # conforms to second version of ipsec.conf specification</p><p>config setup<br />&nbsp; &nbsp; plutodebug=&quot;control&quot;<br />&nbsp; &nbsp; uniqueids=yes<br />&nbsp; &nbsp; virtual_private=%v4:10.0.0.0/8,%v4:172.16.0.0/12,%v4:192.168.0.0/16,%v4:!10.7.7.0/255.255.255.0,%v4:!10.11.12.0/255.255.255.0</p><p>conn COMPANY<br />&nbsp; &nbsp; left=my.dyndns.net<br />&nbsp; &nbsp; leftnexthop=%defaultroute<br />&nbsp; &nbsp; leftsubnet=10.7.7.0/255.255.255.0<br />&nbsp; &nbsp; right=123.45.67.89<br />&nbsp; &nbsp; rightsubnet=10.11.12.0/255.255.255.0<br />&nbsp; &nbsp; rightnexthop=%defaultroute<br />&nbsp; &nbsp; ike=aes128-md5-modp1024,aes128-sha-modp1024<br />&nbsp; &nbsp; esp=aes128-md5,aes128-sha1<br />&nbsp; &nbsp; ikelifetime=1h<br />&nbsp; &nbsp; keylife=8h<br />&nbsp; &nbsp; dpddelay=60<br />&nbsp; &nbsp; dpdtimeout=120<br />&nbsp; &nbsp; dpdaction=hold<br />&nbsp; &nbsp; pfs=yes<br />&nbsp; &nbsp; authby=secret<br />&nbsp; &nbsp; auto=start</p><p>#Disable Opportunistic Encryption<br />include /etc/ipsec.d/examples/no_oe.conf</p></blockquote></div><p>When I start the connection with &quot;ipsec setup --start&quot;, I see the following results via logread (some lines may be missing. I merged the log together from multiple &quot;logread &gt; /tmp/logN.txt&quot; commands):<br /></p><div class="quotebox"><blockquote><p>Jan&nbsp; 4 12:25:34 (none) daemon.err ipsec_setup: KLIPS ipsec0 on ppp0 84.140.241.216/255.255.255.255 pointopoint 217.0.116.103 <br />Jan&nbsp; 4 12:25:36 (none) authpriv.err ipsec__plutorun: Starting Pluto subsystem...<br />Jan&nbsp; 4 12:25:36 (none) daemon.err ipsec_setup: ...Openswan IPsec started<br />Jan&nbsp; 4 12:25:37 (none) daemon.err ipsec_setup: Starting Openswan IPsec 2.4.4...<br />Jan&nbsp; 4 12:25:37 (none) kern.warn pluto[15082]: Starting Pluto (Openswan Version 2.4.4 X.509-1.5.4 PLUTO_SENDS_VENDORID PLUTO_USES_KEYRR; Vendor ID OEz}FFFfgr_e)<br />Jan&nbsp; 4 12:25:37 (none) kern.warn pluto[15082]: Setting NAT-Traversal port-4500 floating to off<br />Jan&nbsp; 4 12:25:37 (none) kern.warn pluto[15082]:&nbsp; &nbsp; port floating activation criteria nat_t=0/port_fload=1<br />Jan&nbsp; 4 12:25:37 (none) kern.warn pluto[15082]:&nbsp; &nbsp;including NAT-Traversal patch (Version 0.6c) [disabled]<br />Jan&nbsp; 4 12:25:37 (none) kern.debug pluto[15082]: | opening /dev/urandom<br />Jan&nbsp; 4 12:25:37 (none) kern.debug pluto[15082]: | inserting event EVENT_REINIT_SECRET, timeout in 3600 seconds<br />Jan&nbsp; 4 12:25:37 (none) kern.debug pluto[15082]: | inserting event EVENT_PENDING_PHASE2, timeout in 120 seconds<br />Jan&nbsp; 4 12:25:37 (none) kern.warn pluto[15082]: ike_alg_register_enc(): Activating OAKLEY_AES_CBC: Ok (ret=0)<br />Jan&nbsp; 4 12:25:37 (none) kern.warn pluto[15082]: starting up 1 cryptographic helpers<br />Jan&nbsp; 4 12:25:37 (none) kern.warn pluto[15082]: started helper pid=15084 (fd:6)<br />Jan&nbsp; 4 12:25:37 (none) kern.warn pluto[15082]: Using KLIPS IPsec interface code on 2.4.30<br />Jan&nbsp; 4 12:25:37 (none) kern.debug pluto[15084]: | opening /dev/urandom<br />Jan&nbsp; 4 12:25:37 (none) kern.debug pluto[15082]: | inserting event EVENT_SHUNT_SCAN, timeout in 120 seconds<br />Jan&nbsp; 4 12:25:37 (none) kern.warn pluto[15082]: Changing to directory &#039;/etc/ipsec.d/cacerts&#039;<br />Jan&nbsp; 4 12:25:37 (none) kern.warn pluto[15082]: Changing to directory &#039;/etc/ipsec.d/aacerts&#039;<br />Jan&nbsp; 4 12:25:37 (none) kern.warn pluto[15082]: Changing to directory &#039;/etc/ipsec.d/ocspcerts&#039;<br />Jan&nbsp; 4 12:25:37 (none) kern.warn pluto[15082]: Changing to directory &#039;/etc/ipsec.d/crls&#039;<br />Jan&nbsp; 4 12:25:37 (none) kern.warn pluto[15082]:&nbsp; &nbsp;Warning: empty directory<br />Jan&nbsp; 4 12:25:37 (none) kern.debug pluto[15082]: | inserting event EVENT_LOG_DAILY, timeout in 41663 seconds<br />Jan&nbsp; 4 12:25:37 (none) kern.debug pluto[15082]: | next event EVENT_SHUNT_SCAN in 120 seconds<br />Jan&nbsp; 4 12:25:37 (none) kern.debug pluto[15084]: ! helper 0 waiting on fd: 7<br />Jan&nbsp; 4 12:25:42 (none) kern.debug pluto[15082]: |&nbsp; <br />Jan&nbsp; 4 12:25:42 (none) kern.debug pluto[15082]: | *received whack message<br />Jan&nbsp; 4 12:25:42 (none) kern.debug pluto[15082]: | Added new connection PTHHFW with policy PSK+ENCRYPT+TUNNEL+PFS<br />Jan&nbsp; 4 12:25:42 (none) kern.debug pluto[15082]: | from whack: got --esp=aes128-md5,aes128-sha1<br />Jan&nbsp; 4 12:25:42 (none) kern.debug pluto[15082]: | esp string values: 12_128-1, 12_128-2, flags=-strict<br />Jan&nbsp; 4 12:25:42 (none) kern.debug pluto[15082]: | from whack: got --ike=aes128-md5-modp1024,aes128-sha-modp1024<br />Jan&nbsp; 4 12:25:42 (none) kern.debug pluto[15082]: | ike string values: 7_128-1-2, 7_128-2-2, flags=-strict<br />Jan&nbsp; 4 12:25:42 (none) kern.debug pluto[15082]: | counting wild cards for (none) is 15<br />Jan&nbsp; 4 12:25:42 (none) kern.debug pluto[15082]: | counting wild cards for (none) is 15<br />Jan&nbsp; 4 12:25:42 (none) kern.debug pluto[15082]: | alg_info_addref() alg_info-&gt;ref_cnt=1<br />Jan&nbsp; 4 12:25:42 (none) kern.debug pluto[15082]: | alg_info_addref() alg_info-&gt;ref_cnt=1<br />Jan&nbsp; 4 12:25:42 (none) kern.debug pluto[15082]: | alg_info_addref() alg_info-&gt;ref_cnt=2<br />Jan&nbsp; 4 12:25:42 (none) kern.debug pluto[15082]: | alg_info_addref() alg_info-&gt;ref_cnt=2<br />Jan&nbsp; 4 12:25:42 (none) kern.warn pluto[15082]: added connection description &quot;COMPANY&quot;<br />Jan&nbsp; 4 12:25:42 (none) kern.debug pluto[15082]: | 10.7.7.0/24===84.140.241.216---217.0.116.103...217.0.116.103---123.45.67.89===10.11.12.0/24<br />Jan&nbsp; 4 12:25:42 (none) kern.debug pluto[15082]: | ike_life: 3600s; ipsec_life: 28800s; rekey_margin: 540s; rekey_fuzz: 100%; keyingtries: 0; policy: PSK+ENCRYPT+TUNNEL+PFS<br />Jan&nbsp; 4 12:25:42 (none) kern.debug pluto[15082]: | next event EVENT_SHUNT_SCAN in 115 seconds<br />Jan&nbsp; 4 12:25:44 (none) kern.debug pluto[15082]: | best_match 0&gt;6 best=0x1001ecf0 (line=1)<br />Jan&nbsp; 4 12:25:44 (none) kern.debug pluto[15082]: | concluding with best_match=6 best=0x1001ecf0 (lineno=1)<br />Jan&nbsp; 4 12:25:44 (none) kern.debug pluto[15082]: | 0: w-&gt;pcw_dead: 0 w-&gt;pcw_work: 0 cnt: 1<br />Jan&nbsp; 4 12:25:44 (none) kern.debug pluto[15082]: | asking helper 0 to do build_kenonce op on seq: 1<br />Jan&nbsp; 4 12:25:44 (none) kern.debug pluto[15082]: | inserting event EVENT_CRYPTO_FAILED, timeout in 300 seconds for #1<br />Jan&nbsp; 4 12:25:44 (none) kern.debug pluto[15082]: | complete state transition with STF_SUSPEND<br />Jan&nbsp; 4 12:25:44 (none) kern.debug pluto[15082]: | next event EVENT_SHUNT_SCAN in 113 seconds<br />Jan&nbsp; 4 12:25:44 (none) kern.debug pluto[15084]: ! helper -1 doing build_kenonce op id: 1<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | processing connection COMPANY<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | ICOOKIE:&nbsp; 29 91 a5 2c&nbsp; eb e6 6b 1c<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | RCOOKIE:&nbsp; 00 00 00 00&nbsp; 00 00 00 00<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | peer:&nbsp; d9 5b 2f 41<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | state hash entry 31<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | ICOOKIE:&nbsp; 29 91 a5 2c&nbsp; eb e6 6b 1c<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | RCOOKIE:&nbsp; e4 ba e5 89&nbsp; 80 55 26 05<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | peer:&nbsp; d9 5b 2f 41<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | state hash entry 5<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | complete state transition with STF_OK<br />Jan&nbsp; 4 12:25:45 (none) kern.warn pluto[15082]: &quot;COMPANY&quot; #1: transition from state STATE_MAIN_I1 to state STATE_MAIN_I2<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | sending reply packet to 123.45.67.89:500 (from port=500)<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | sending 180 bytes for STATE_MAIN_I1 through ppp0:500 to 123.45.67.89:500:<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | inserting event EVENT_RETRANSMIT, timeout in 10 seconds for #1<br />Jan&nbsp; 4 12:25:45 (none) kern.warn pluto[15082]: &quot;COMPANY&quot; #1: STATE_MAIN_I2: sent MI2, expecting MR2<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | modecfg pull: noquirk policy:push not-client<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | phase 1 is done, looking for phase 1 to unpend<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | next event EVENT_RETRANSMIT in 10 seconds for #1<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: |&nbsp; <br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | *received 180 bytes from 123.45.67.89:500 on ppp0 (port=500)<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: |&nbsp; processing packet with exchange type=ISAKMP_XCHG_IDPROT (2)<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | ICOOKIE:&nbsp; 29 91 a5 2c&nbsp; eb e6 6b 1c<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | RCOOKIE:&nbsp; e4 ba e5 89&nbsp; 80 55 26 05<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | peer:&nbsp; d9 5b 2f 41<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | state hash entry 5<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | peer and cookies match on #1, provided msgid 00000000 vs 00000000<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | state object #1 found, in STATE_MAIN_I2<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | processing connection COMPANY<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | thinking about whether to send my certificate:<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: |&nbsp; &nbsp;I have RSA key: OAKLEY_PRESHARED_KEY cert.type: CERT_NONE <br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: |&nbsp; &nbsp;sendcert: CERT_ALWAYSSEND and I did not get a certificate request <br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: |&nbsp; &nbsp;so do not send cert.<br />Jan&nbsp; 4 12:25:45 (none) kern.warn pluto[15082]: &quot;COMPANY&quot; #1: I did not send a certificate because I do not have one.<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: |&nbsp; I am not sending a certificate request<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | started looking for secret for 84.140.241.216-&gt;123.45.67.89 of kind PPK_PSK<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | actually looking for secret for 84.140.241.216-&gt;123.45.67.89 of kind PPK_PSK<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | 1: compared PSK 123.45.67.89 to 84.140.241.216 / 123.45.67.89 -&gt; 2<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | 2: compared PSK 84.140.241.216 to 84.140.241.216 / 123.45.67.89 -&gt; 6<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | best_match 0&gt;6 best=0x1001ecf0 (line=1)<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | concluding with best_match=6 best=0x1001ecf0 (lineno=1)<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | complete state transition with STF_OK<br />Jan&nbsp; 4 12:25:45 (none) kern.warn pluto[15082]: &quot;COMPANY&quot; #1: transition from state STATE_MAIN_I2 to state STATE_MAIN_I3<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | sending reply packet to 123.45.67.89:500 (from port=500)<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | sending 60 bytes for STATE_MAIN_I2 through ppp0:500 to 123.45.67.89:500:<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | inserting event EVENT_RETRANSMIT, timeout in 10 seconds for #1<br />Jan&nbsp; 4 12:25:45 (none) kern.warn pluto[15082]: &quot;COMPANY&quot; #1: STATE_MAIN_I3: sent MI3, expecting MR3<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | modecfg pull: noquirk policy:push not-client<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | phase 1 is done, looking for phase 1 to unpend<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | next event EVENT_RETRANSMIT in 10 seconds for #1<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: |&nbsp; <br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | *received 60 bytes from 123.45.67.89:500 on ppp0 (port=500)<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: |&nbsp; processing packet with exchange type=ISAKMP_XCHG_IDPROT (2)<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | ICOOKIE:&nbsp; 29 91 a5 2c&nbsp; eb e6 6b 1c<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | RCOOKIE:&nbsp; e4 ba e5 89&nbsp; 80 55 26 05<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | peer:&nbsp; d9 5b 2f 41<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | state hash entry 5<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | peer and cookies match on #1, provided msgid 00000000 vs 00000000<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | state object #1 found, in STATE_MAIN_I3<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | processing connection COMPANY<br />Jan&nbsp; 4 12:25:45 (none) kern.warn pluto[15082]: &quot;COMPANY&quot; #1: Main mode peer ID is ID_IPV4_ADDR: &#039;123.45.67.89&#039;<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | complete state transition with STF_OK<br />Jan&nbsp; 4 12:25:45 (none) kern.warn pluto[15082]: &quot;COMPANY&quot; #1: transition from state STATE_MAIN_I3 to state STATE_MAIN_I4<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | inserting event EVENT_SA_REPLACE, timeout in 2633 seconds for #1<br />Jan&nbsp; 4 12:25:45 (none) kern.warn pluto[15082]: &quot;COMPANY&quot; #1: STATE_MAIN_I4: ISAKMP SA established {auth=OAKLEY_PRESHARED_KEY cipher=aes_128 prf=oakley_md5 group=modp1024}<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | ICOOKIE:&nbsp; 29 91 a5 2c&nbsp; eb e6 6b 1c<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | RCOOKIE:&nbsp; e4 ba e5 89&nbsp; 80 55 26 05<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | peer:&nbsp; d9 5b 2f 41<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | state hash entry 5<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | peer and cookies match on #1, provided msgid 00000000 vs 00000000<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | state object #1 found, in STATE_MAIN_I4<br />Jan&nbsp; 4 12:25:45 (none) kern.warn pluto[15082]: &quot;COMPANY&quot; #1: Dead Peer Detection (RFC 3706): enabled<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | state: 1 requesting event none to be deleted by dpd.c:160<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | inserting event EVENT_DPD, timeout in 60 seconds for #1<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | modecfg pull: noquirk policy:push not-client<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | phase 1 is done, looking for phase 1 to unpend<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | unqueuing pending Quick Mode with 123.45.67.89 &quot;COMPANY&quot;<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | duplicating state object #1<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | creating state object #2 at 0x1001fd98<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | processing connection COMPANY<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | ICOOKIE:&nbsp; 29 91 a5 2c&nbsp; eb e6 6b 1c<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | RCOOKIE:&nbsp; e4 ba e5 89&nbsp; 80 55 26 05<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | peer:&nbsp; d9 5b 2f 41<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | state hash entry 5<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | inserting event EVENT_SO_DISCARD, timeout in 0 seconds for #2<br />Jan&nbsp; 4 12:25:45 (none) kern.warn pluto[15082]: &quot;COMPANY&quot; #2: initiating Quick Mode PSK+ENCRYPT+TUNNEL+PFS+UP {using isakmp#1}<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | 0: w-&gt;pcw_dead: 0 w-&gt;pcw_work: 0 cnt: 1<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | asking helper 0 to do build_kenonce op on seq: 2<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | inserting event EVENT_CRYPTO_FAILED, timeout in 300 seconds for #2<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | next event EVENT_DPD in 60 seconds for #1<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15084]: ! helper -1 doing build_kenonce op id: 2<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | processing connection COMPANY<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | kernel_alg_db_new() will return p_new-&gt;protoid=3, p_new-&gt;trans_cnt=2<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | kernel_alg_db_new()&nbsp; &nbsp; &nbsp;trans[0]: transid=12, attr_cnt=2, attrs[0].type=5, attrs[0].val=1<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | kernel_alg_db_new()&nbsp; &nbsp; &nbsp;trans[1]: transid=12, attr_cnt=2, attrs[0].type=5, attrs[0].val=2<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | returning new proposal from esp_info<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | generate SPI:&nbsp; 03 27 8f f5<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | sending 332 bytes for quick_outI1 through ppp0:500 to 123.45.67.89:500:<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | inserting event EVENT_RETRANSMIT, timeout in 10 seconds for #2<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | next event EVENT_RETRANSMIT in 10 seconds for #2<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: |&nbsp; <br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | *received 300 bytes from 123.45.67.89:500 on ppp0 (port=500)<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: |&nbsp; processing packet with exchange type=ISAKMP_XCHG_QUICK (32)<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | ICOOKIE:&nbsp; 29 91 a5 2c&nbsp; eb e6 6b 1c<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | RCOOKIE:&nbsp; e4 ba e5 89&nbsp; 80 55 26 05<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | peer:&nbsp; d9 5b 2f 41<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | state hash entry 5<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | peer and cookies match on #2, provided msgid 75a52bb2 vs 75a52bb2<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | state object #2 found, in STATE_QUICK_I1<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | processing connection COMPANY<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | started looking for secret for 84.140.241.216-&gt;123.45.67.89 of kind PPK_PSK<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | actually looking for secret for 84.140.241.216-&gt;123.45.67.89 of kind PPK_PSK<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | 1: compared PSK 123.45.67.89 to 84.140.241.216 / 123.45.67.89 -&gt; 2<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | 2: compared PSK 84.140.241.216 to 84.140.241.216 / 123.45.67.89 -&gt; 6<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | best_match 0&gt;6 best=0x1001ecf0 (line=1)<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | concluding with best_match=6 best=0x1001ecf0 (lineno=1)<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | our client is subnet 10.7.7.0/24<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | our client protocol/port is 0/0<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | peer client is subnet 10.11.12.0/24<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | peer client protocol/port is 0/0<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | install_ipsec_sa() for #2: inbound and outbound<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | route owner of &quot;COMPANY&quot; prospective erouted: self; eroute owner: self<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | could_route called for COMPANY (kind=CK_PERMANENT)<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | add inbound eroute 10.11.12.0/24:0 --0-&gt; 10.7.7.0/24:0 =&gt; tun.1001@84.140.241.216 (raw_eroute)<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | sr for #2: prospective erouted<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | route owner of &quot;COMPANY&quot; prospective erouted: self; eroute owner: self<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | eroute_connection replace eroute 10.7.7.0/24:0 --0-&gt; 10.11.12.0/24:0 =&gt; tun.1002@123.45.67.89 (raw_eroute)<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | command executing up-client<br />Jan&nbsp; 4 12:25:45 (none) kern.debug pluto[15082]: | executing up-client: 2&gt;&amp;1 PLUTO_VERSION=&#039;1.1&#039; PLUTO_VERB=&#039;up-client&#039; PLUTO_CONNECTION=&#039;PTHHFW&#039; PLUTO_NEXT_HOP=&#039;217.0.116.103&#039; PLUTO_INTERFACE=&#039;ipsec0&#039; PLUTO_ME=&#039;84.140.241.216&#039; PLUTO_MY_ID=&#039;84.140.241.216&#039; PLUTO_MY_CLIENT=&#039;10.7.7.0/24&#039; PLUTO_MY_CLIENT_NET=&#039;10.7.7.0&#039; PLUTO_MY_CLIENT_MASK=&#039;255.255.255.0&#039; PLUTO_MY_PORT=&#039;0&#039; PLUTO_MY_PROTOCOL=&#039;0&#039; PLUTO_PEER=&#039;123.45.67.89&#039; PLUTO_PEER_ID=&#039;123.45.67.89&#039; PLUTO_PEER_CLIENT=&#039;10.11.12.0/24&#039; PLUTO_PEER_CLIENT_NET=&#039;10.11.12.0&#039; PLUTO_PEER_CLIENT_MASK=&#039;255.255.255.0&#039; PLUTO_PEER_PORT=&#039;0&#039; PLUTO_PEER_PROTOCOL=&#039;0&#039; PLUTO_PEER_CA=&#039;&#039; PLUTO_CONN_POLICY=&#039;PSK+ENCRYPT+TUNNEL+PFS+UP&#039;&nbsp; &nbsp;ipsec _updown<br />Jan&nbsp; 4 12:25:46 (none) kern.debug pluto[15082]: | route_and_eroute: firewall_notified: true<br />Jan&nbsp; 4 12:25:46 (none) kern.debug pluto[15082]: | route_and_eroute: instance &quot;COMPANY&quot;, setting eroute_owner {spd=0x1001d320,sr=0x1001d320} to #2 (was #0) (newest_ipsec_sa=#0)<br />Jan&nbsp; 4 12:25:46 (none) kern.debug pluto[15082]: | ICOOKIE:&nbsp; 29 91 a5 2c&nbsp; eb e6 6b 1c<br />Jan&nbsp; 4 12:25:46 (none) kern.debug pluto[15082]: | RCOOKIE:&nbsp; e4 ba e5 89&nbsp; 80 55 26 05<br />Jan&nbsp; 4 12:25:46 (none) kern.debug pluto[15082]: | peer:&nbsp; d9 5b 2f 41<br />Jan&nbsp; 4 12:25:46 (none) kern.debug pluto[15082]: | state hash entry 5<br />Jan&nbsp; 4 12:25:46 (none) kern.debug pluto[15082]: | peer and cookies match on #2, provided msgid 00000000 vs 75a52bb2<br />Jan&nbsp; 4 12:25:46 (none) kern.debug pluto[15082]: | peer and cookies match on #1, provided msgid 00000000 vs 00000000<br />Jan&nbsp; 4 12:25:46 (none) kern.debug pluto[15082]: | state object #1 found, in STATE_MAIN_I4<br />Jan&nbsp; 4 12:25:46 (none) kern.warn pluto[15082]: &quot;COMPANY&quot; #2: Dead Peer Detection (RFC 3706): enabled<br />Jan&nbsp; 4 12:25:46 (none) kern.debug pluto[15082]: | state: 2 requesting event none to be deleted by dpd.c:160<br />Jan&nbsp; 4 12:25:46 (none) kern.debug pluto[15082]: | inserting event EVENT_DPD, timeout in 60 seconds for #2<br />Jan&nbsp; 4 12:25:46 (none) kern.debug pluto[15082]: | state: 1 requesting event EVENT_DPD to be deleted by dpd.c:172<br />Jan&nbsp; 4 12:25:46 (none) kern.debug pluto[15082]: | complete state transition with STF_OK<br />Jan&nbsp; 4 12:25:46 (none) kern.warn pluto[15082]: &quot;COMPANY&quot; #2: transition from state STATE_QUICK_I1 to state STATE_QUICK_I2<br />Jan&nbsp; 4 12:25:46 (none) kern.debug pluto[15082]: | sending reply packet to 123.45.67.89:500 (from port=500)<br />Jan&nbsp; 4 12:25:46 (none) kern.debug pluto[15082]: | sending 60 bytes for STATE_QUICK_I1 through ppp0:500 to 123.45.67.89:500:<br />Jan&nbsp; 4 12:25:46 (none) kern.debug pluto[15082]: | inserting event EVENT_SA_REPLACE, timeout in 27956 seconds for #2<br />Jan&nbsp; 4 12:25:46 (none) kern.warn pluto[15082]: &quot;COMPANY&quot; #2: STATE_QUICK_I2: sent QI2, IPsec SA established {ESP=&gt;0x0d8554c5 &lt;0x03278ff5 xfrm=AES_128-HMAC_MD5 NATD=none DPD=enabled}<br />Jan&nbsp; 4 12:25:46 (none) kern.debug pluto[15082]: | modecfg pull: noquirk policy:push not-client<br />Jan&nbsp; 4 12:25:46 (none) kern.debug pluto[15082]: | phase 1 is done, looking for phase 1 to unpend<br />Jan&nbsp; 4 12:25:46 (none) kern.debug pluto[15082]: | next event EVENT_DPD in 60 seconds for #2</p></blockquote></div>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>