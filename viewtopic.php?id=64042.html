<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> DHCPDISCOVER/DHCPOFFER from WAN interface of internal routers</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 29 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p318772">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">wjcarpenter</div>
					<div class="post-datetime">
						8 Apr 2016, 20:16					</div>
				</div>
				<div class="post-content content">
					<p>Let me preface my question by saying up front that there are various things about configuring bridging and slaving and so on that I am a little shaky on, so perhaps this question will seem kind of dumb to those who know all about it.</p><p>Mainly to cover my entire house with strong wifi, I have a couple of internal routers scattered about. All of the internal routers talk directly over a wired connection to the single router that acts as a gateway to my ISP. But for the sake of this question, you can just pretend there is that gateway router and one internal router. dnsmasq is disabled on the internal router, and all DHCP is served by the gateway router. The routers are Netgear WNDR3800 running OpenWrt Barrier Breaker 14.07 / LuCI Trunk (0.12+svn-r10530) .</p><p>Every few seconds, my gateway router was getting DHCPDISCOVER requests from the internal router. The gateway router responded with DHCPOFFER, but the expected DHCPREQUEST was not seen. The usual cause of this is that the internal router is not receiving the DHCPOFFER response from the gateway router.</p><p>Because I had the MAC addresses involved, I was able to figure out that the requests originated from the WAN interface on the internal router. It was configured as a DHCP client, but it has been operating for months without receiving an IP address, with no ill effects that I can see (other than the repeated DHCP traffic itself). I have the same firewall rules on the WAN interfaces of the gateway and internal router, and the gateway router does receive an DHCP address from my ISP. In a nutshell, I have the internal router mostly configured as if it thinks my gateway router is an ISP (though that&#039;s not completely true since I can ping from a device on any router to any device on any other router).</p><p>I worked around this problem by assigning a static IP address to the WAN interface of the internal router. Yay, the logging stopped. But, as a matter of curiosity, I&#039;d like to figure out what was going on with that DHCP stuff on that WAN interface.</p><p>Anybody have any ideas? I can provide any config details as needed, either from LuCI or from the command line.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p318779">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">eduperez</div>
					<div class="post-datetime">
						8 Apr 2016, 21:21					</div>
				</div>
				<div class="post-content content">
					<p>I guess the firewall in your internal router is blocking the DHCPOFFER packets. As it is an internal router, with no direct internet connection, the firewall rules can be more relaxed than those on the external router.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>