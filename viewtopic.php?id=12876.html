<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> usb stick &amp; hotplug</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 31 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p57130">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">thomasw</div>
					<div class="post-datetime">
						6 Oct 2007, 21:09					</div>
				</div>
				<div class="post-content content">
					<p>I managed to mount my usb stick manually on my Kamikaze 7.09 box, but I&#039;d like it to be mounted automatically when plugging it in and rebooting the router. </p><p>I made the file /etc/hotplug.d/usb/10-usb-storage executable</p><p>Is there anything else that I&#039;m missing?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p57275">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">thomasw</div>
					<div class="post-datetime">
						10 Oct 2007, 00:21					</div>
				</div>
				<div class="post-content content">
					<p>hm, any ideas?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p57276">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">forum2006</div>
					<div class="post-datetime">
						10 Oct 2007, 00:24					</div>
				</div>
				<div class="post-content content">
					<p>Well. I&#039;ve built my own Kamikaze 7.09 with fstab and swap support backported from trunk. This way it&#039;s easy to mount a USB pen drive/HDD or the IDE HDD in the WL-700g Encore.</p><p>Backports:<br />- <a href="https://dev.openwrt.org/changeset/8916">https://dev.openwrt.org/changeset/8916</a><br />- <a href="https://dev.openwrt.org/changeset/8947">https://dev.openwrt.org/changeset/8947</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p57277">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">thomasw</div>
					<div class="post-datetime">
						10 Oct 2007, 00:35					</div>
				</div>
				<div class="post-content content">
					<p>well what about hotplugging though? I don&#039;t need it for swap, I just don&#039;t want to mount it manually all the time</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p57281">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">alexsamad</div>
					<div class="post-datetime">
						10 Oct 2007, 02:48					</div>
				</div>
				<div class="post-content content">
					<p>I thought this was part of 7.09. I recently built a trunk version and plugged in a usb stick and it mounted it /mnt/usb......</p><p>what does dmesg or logread say when you put the stick in ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p57286">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">thomasw</div>
					<div class="post-datetime">
						10 Oct 2007, 04:28					</div>
				</div>
				<div class="post-content content">
					<p>Here is the output of logread when I plug it in:<br /></p><div class="quotebox"><blockquote><p>Oct&nbsp; 9 19:25:16 OpenWrt authpriv.info dropbear[568]: Child connection from 10.1.1.190:2153<br />Oct&nbsp; 9 19:25:21 OpenWrt authpriv.notice dropbear[568]: password auth succeeded for &#039;root&#039; from 10.1.1.190:2153<br />Oct&nbsp; 9 19:25:32 OpenWrt cron.warn crond[509]: time disparity of 4088245 minutes detected<br />Oct&nbsp; 9 19:25:48 OpenWrt user.info kernel: hub.c: new USB device 01:03.2-2, assigned address 2<br />Oct&nbsp; 9 19:25:48 OpenWrt user.info kernel: scsi0 : SCSI emulation for USB Mass Storage devices<br />Oct&nbsp; 9 19:25:48 OpenWrt user.warn kernel:&nbsp; &nbsp;Vendor:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Model: USB Flash Memory&nbsp; Rev: 5.00<br />Oct&nbsp; 9 19:25:48 OpenWrt user.warn kernel:&nbsp; &nbsp;Type:&nbsp; &nbsp;Direct-Access&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ANSI SCSI revision: 02<br />Oct&nbsp; 9 19:25:48 OpenWrt user.warn kernel: Attached scsi removable disk sda at scsi0, channel 0, id 0, lun 0<br />Oct&nbsp; 9 19:25:50 OpenWrt user.warn kernel: SCSI device sda: 4028416 512-byte hdwr sectors (2063 MB)<br />Oct&nbsp; 9 19:25:50 OpenWrt user.warn kernel: sda: Write Protect is off<br />Oct&nbsp; 9 19:25:50 OpenWrt user.info kernel: Partition check:<br />Oct&nbsp; 9 19:25:50 OpenWrt user.info kernel:&nbsp; p1<br />Oct&nbsp; 9 19:25:50 OpenWrt user.debug kernel: WARNING: USB Mass Storage data integrity not assured<br />Oct&nbsp; 9 19:25:50 OpenWrt user.debug kernel: USB Mass Storage device found at 2<br />Oct&nbsp; 9 19:25:50 OpenWrt user.notice root: usb device is mass storage<br />Oct&nbsp; 9 19:25:50 OpenWrt user.notice root: waiting on usb drive 0 ...<br />Oct&nbsp; 9 19:25:51 OpenWrt user.notice root: waiting on usb drive 1 ...<br />Oct&nbsp; 9 19:25:52 OpenWrt user.notice root: waiting on usb drive 2 ...<br />Oct&nbsp; 9 19:25:53 OpenWrt user.notice root: waiting on usb drive 3 ...<br />Oct&nbsp; 9 19:25:54 OpenWrt user.notice root: waiting on usb drive 4 ...<br />Oct&nbsp; 9 19:25:55 OpenWrt user.notice root: waiting on usb drive 5 ...<br />Oct&nbsp; 9 19:25:56 OpenWrt user.notice root: waiting on usb drive 6 ...<br />Oct&nbsp; 9 19:25:57 OpenWrt user.notice root: waiting on usb drive 7 ...<br />Oct&nbsp; 9 19:25:58 OpenWrt user.notice root: waiting on usb drive 8 ...<br />Oct&nbsp; 9 19:25:59 OpenWrt user.notice root: waiting on usb drive 9 ...<br />Oct&nbsp; 9 19:26:00 OpenWrt user.notice root: waiting on usb drive 10 ...</p></blockquote></div><p>and here is what dmesg says:<br /></p><div class="quotebox"><blockquote><p>...<br />usb.c: registered new driver usbdevfs<br />usb.c: registered new driver hub<br />eth0.1: add 01:00:5e:00:00:01 mcast address to master interface<br />PCI: Setting latency timer of device 01:02.0 to 64<br />PCI: Enabling device 01:02.0 (0004 -&gt; 0006)<br />wl0: Broadcom BCM4318 802.11 Wireless Controller 4.80.53.0<br />CSLIP: code copyright 1989 Regents of the University of California<br />PPP generic driver version 2.4.2<br />PCI: Setting latency timer of device 00:03.0 to 64<br />usb-ohci.c: USB OHCI at membase 0xb8003000, IRQ 6<br />usb-ohci.c: usb-00:03.0, PCI device 14e4:4715<br />usb.c: new USB bus registered, assigned bus number 1<br />hub.c: USB hub found<br />hub.c: 2 ports detected<br />uhci.c: USB Universal Host Controller Interface driver v1.1<br />PCI: Enabling device 01:03.0 (0000 -&gt; 0001)<br />uhci.c: USB UHCI at I/O 0x100, IRQ 2<br />usb.c: new USB bus registered, assigned bus number 2<br />hub.c: USB hub found<br />hub.c: 2 ports detected<br />PCI: Enabling device 01:03.1 (0000 -&gt; 0001)<br />uhci.c: USB UHCI at I/O 0x120, IRQ 2<br />usb.c: new USB bus registered, assigned bus number 3<br />hub.c: USB hub found<br />hub.c: 2 ports detected<br />usb-uhci.c: $Revision: 1.275 $ time 08:58:50 Sep 29 2007<br />usb-uhci.c: High bandwidth mode enabled<br />usb-uhci.c: v1.275:USB Universal Host Controller Interface driver<br />PCI: Enabling device 01:03.2 (0000 -&gt; 0002)<br />ehci_hcd 01:03.2: PCI device 1106:3104<br />ehci_hcd 01:03.2: irq 2, pci mem c01d1000<br />usb.c: new USB bus registered, assigned bus number 4<br />EHCI: Enabling VIA 6212 workarounds<br />ehci_hcd 01:03.2: USB 2.0 enabled, EHCI 1.00, driver 2003-Dec-29/2.4<br />hub.c: USB hub found<br />hub.c: 4 ports detected<br />SCSI subsystem driver Revision: 1.00<br />Initializing USB Mass Storage driver...<br />usb.c: registered new driver usb-storage<br />USB Mass Storage support registered.<br />device wl0 entered promiscuous mode<br />wl0: attempt to add interface with same source address.<br />br-lan: port 2(wl0) entering learning state<br />br-lan: port 2(wl0) entering forwarding state<br />br-lan: topology change detected, propagating<br />hub.c: new USB device 01:03.2-2, assigned address 2<br />scsi0 : SCSI emulation for USB Mass Storage devices<br />&nbsp; Vendor:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Model: USB Flash Memory&nbsp; Rev: 5.00<br />&nbsp; Type:&nbsp; &nbsp;Direct-Access&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ANSI SCSI revision: 02<br />Attached scsi removable disk sda at scsi0, channel 0, id 0, lun 0<br />SCSI device sda: 4028416 512-byte hdwr sectors (2063 MB)<br />sda: Write Protect is off<br />Partition check:<br /> /dev/scsi/host0/bus0/target0/lun0: p1<br />WARNING: USB Mass Storage data integrity not assured<br />USB Mass Storage device found at 2</p></blockquote></div><p>There&#039;s no /dev/sdaXXX though. Mounting the stick using /dev/scsi/host0/bus0/target0/lun0/part1 works however (except that I have to mount it manually all the time)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p57559">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">alexsamad</div>
					<div class="post-datetime">
						16 Oct 2007, 04:48					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>thomasw wrote:</cite><blockquote><p>Here is the output of logread when I plug it in:<br /></p><div class="quotebox"><blockquote><p>/dev/scsi/host0/bus0/target0/lun0: p1<br />WARNING: USB Mass Storage data integrity not assured<br />USB Mass Storage device found at 2</p></blockquote></div><p>There&#039;s no /dev/sdaXXX though. Mounting the stick using /dev/scsi/host0/bus0/target0/lun0/part1 works however (except that I have to mount it manually all the time)</p></blockquote></div><p>/dev/scsi/host0/bus0/target0/lun0: p1 - that is where its at, your not using 2.6</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>