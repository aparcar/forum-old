<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> How to place the kernel in rootfs? Which fs is best for CF cards?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 16 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p228757">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">R1D2</div>
					<div class="post-datetime">
						29 Mar 2014, 19:02					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>I use an Alix2 board and would like to modify the <em>sysupgrade</em> so that one can upgrade the kernel and the rootfs image or tarball on an already partitioned CF card with any (probably user-defined) partition layout (e.g. Debian on sda4). Currently I use a firmware image without the GRUB part which I manually copy over the &quot;inactive&quot; partition of two rootfs partitions (sda2 and sda3) in alternating order and the separate <em>vmlinuz</em> file to the boot partition (sda1).</p><p>Next is to replace the GRUB bootloader in the MBR by SYSLINUX, because the latter should be able to continue boot of another alternative rootfs partition if the &quot;active&quot; partition becomes corrupted by a faulty upgrade image. Therefore I would like to place the <em>vmlinuz</em> kernel onto the rootfs itself instead of in the first disk partition sda1. This way I would have only one image and one partition to update.</p><p>Is there a way to modify the image generation process so that <em>vmlinuz</em> is placed into the rootfs image? I looked at the Makefile already, but I still wonder wether such a configuration is selectable. Otherwise I would have to define a common firmware image layout like for example <em>OpenMesh</em> does to include the kernel and the rootfs in only one file presented to <em>sysupgrade</em>.</p><p>BTW: The documentation recommends the ext4fs for Alix2. Has this fs any advantages over squashfs? I like the way a squashfs can be reset to factory defaults using the readonly partition. Are there any dis-advantages using squashfs (since the documentation recommends using ext4fs)?</p><p>Thanks in adavance for any thoughts you might have!</p>											<p class="post-edited">(Last edited by <strong>R1D2</strong> on 29 Mar 2014, 19:05)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>