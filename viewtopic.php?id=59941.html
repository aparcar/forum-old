<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> how to setup IPTV with 2 vlans</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 23 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p293684">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Tokhtar</div>
					<div class="post-datetime">
						27 Sep 2015, 19:10					</div>
				</div>
				<div class="post-content content">
					<p>HI!<br />Please, help me!<br />How IPTV settings for openwrt cc</p><p>Provider settings:<br />pppoe vlan 200<br />ip-phone vlan 100<br />IPTV vlan 11(provider DHCP Server)<br />IPTV vlan 10 (only igmp v2)</p><p>Work settings for tp-link:</p><p>IGMP Proxy: Enable<br />Mode: 802.1Q Tag VLAN<br />VLAN TAG for Internet Service: Enable<br />Internet VLAN ID: 200<br />Internet VLAN Pri: 0<br />IP-phone VLAN ID: 100<br />IP-phone VLAN Pri: 0<br />IPTV VLAN ID: 11<br />IPTV VLAN Pri: 4<br />Enable Multicast VLAN<br />Multicast VLAN ID for IPTV: 10<br />Multicast VLAN Pri for IPTV: 4<br />LAN1 Mode: IP-phone<br />LAN2 Mode: Internet<br />LAN3 Mode: Internet<br />LAN4 Mode: IPTV<br />add png files<br /><a href="https://cloud.mail.ru/public/EXbX/q1P85kjPH">https://cloud.mail.ru/public/EXbX/q1P85kjPH</a></p><p>802.1Q Tag VLAN Help</p><p>You can configure the VLAN parameters for different application on this page.</p><p>&nbsp; &nbsp; VLAN TAG for Internet Service - Config the function according to your ISP, otherwise the Internet could not be accessed. If &quot;Disable&quot; is selected, the other options would be invalid.<br />&nbsp; &nbsp; Internet VLAN ID - Enter the VLAN ID for internet access, which is provided by your ISP. Only the correct VLAN ID can make internet access successfully.<br />&nbsp; &nbsp; Internet VLAN Pri - Select the priority of Internet VLAN. Keep it as default unless necessary.<br />&nbsp; &nbsp; IP-phone VLAN ID - Enter the VLAN ID for IP-phone access, which is provided by your ISP. Only the correct VLAN ID can make IP-phone service successfully.<br />&nbsp; &nbsp; IP-phone VLAN Pri - Select the priority of IP-phone VLAN. Keep it as default unless necessary.<br />&nbsp; &nbsp; IPTV VLAN ID - Enter the VLAN ID for IPTV access, which is provided by your ISP. Only the correct VLAN ID can make IPTV access successfully.<br />&nbsp; &nbsp; IPTV VLAN Pri - Select the priority of IPTV VLAN. Keep it as default unless necessary.<br />&nbsp; &nbsp; Enable Multicast VLAN - If your ISP provides special or separate Multicast VLAN for IPTV, please enable Multicast VLAN for IPTV and type correct VLAN.<br />&nbsp; &nbsp; Multicast VLAN ID for IPTV - Enter the Multicast VLAN ID for IPTV, which is provided by you ISP. Only the correct VLAN ID can make IPTV access successfully.<br />&nbsp; &nbsp; Multicast VLAN Pri for IPTV - Select the priority of Multicast VLAN for IPTV. Keep it as default unless necessary.<br />&nbsp; &nbsp; LAN1~4 Mode - LAN1~4 can be worked on 3 modes. When it worked on Internet mode, you can use it to access Internet and manage the router; and when it worked on IPTV or IP-Phone mode, you can connect the STB or VOIP device to the LAN port and get the service. </p><p>Click the Save button to save your configuration.</p><p>tcpdump -i eth0.10<br />08:56:15.109073 IP ***.**.36.**.1234 &gt; 224.222.222.42.1234: UDP, length 1316<br />08:56:15.112573 IP ***.**.36.**.1234 &gt; 224.222.222.42.1234: UDP, length 1316<br />08:56:15.117913 IP ***.**.36.**.1234 &gt; 224.222.222.42.1234: UDP, length 1316</p><p>tcpdump -i eth0.11<br />tcpdump: verbose output suppressed, use -v or -vv for full protocol decode<br />listening on eth0.11, link-type EN10MB (Ethernet), capture size 65535 bytes<br />08:36:19.996520 IP 192.168.132.43 &gt; 224.222.222.28: igmp v2 report 224.222.222.28<br />08:36:21.138400 STP 802.1d, Config, Flags [none], bridge-id 8010.**:**:**:* , length 42<br />08:36:23.145458 STP 802.1d, Config, Flags [none], bridge-id 8010.**:**:**:* , length 42<br />08:36:25.148397 STP 802.1d, Config, Flags [none], bridge-id 8010.**:**:**:* , length 42<br />08:36:26.616676 IP 192.168.132.43 &gt; 224.222.222.1: igmp v2 report 224.222.222.1<br />08:36:27.153676 STP 802.1d, Config, Flags [none], bridge-id 8010.**:**:**:* , length 42<br />08:36:29.158574 STP 802.1d, Config, Flags [none], bridge-id 8010.**:**:**:* , length 42<br />08:36:30.427533 IP6 fe80::****:****:****:**** &gt; ff02::1: HBH ICMP6, multicast listener querymax resp delay: 10000 addr: ::, length 24<br />08:36:31.165973 STP 802.1d, Config, Flags [none], bridge-id 8010.**:**:**:* , length 42<br />08:36:32.066732 IP 192.168.132.43 &gt; 224.222.222.1: igmp v2 report 224.222.222.1<br />08:36:32.586732 IP 192.168.132.43 &gt; 224.222.222.1: igmp v2 report 224.222.222.1<br />08:36:33.169732 STP 802.1d, Config, Flags [none], bridge-id 8010.**:**:**:* , length 42<br />08:36:35.172550 STP 802.1d, Config, Flags [none], bridge-id 8010.**:**:**:* , length 42</p><p>config interface &#039;loopback&#039;<br />&nbsp; &nbsp; option ifname &#039;lo&#039;<br />&nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; option ipaddr &#039;127.0.0.1&#039;<br />&nbsp; &nbsp; option netmask &#039;255.0.0.0&#039;</p><p>config globals &#039;globals&#039;<br />&nbsp; &nbsp; option ula_prefix &#039;fd97:1338:245f::/48&#039;</p><p>config interface &#039;lan&#039;<br />&nbsp; &nbsp; option ifname &#039;eth0.1&#039;<br />&nbsp; &nbsp; option force_link &#039;1&#039;<br />&nbsp; &nbsp; option macaddr &#039;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#039;<br />&nbsp; &nbsp; option type &#039;bridge&#039;<br />&nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; option ipaddr &#039;192.168.1.1&#039;<br />&nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;<br />&nbsp; &nbsp; option ip6assign &#039;60&#039;</p><p>config interface &#039;wan&#039;<br />&nbsp; &nbsp; option ifname &#039;eth0.2&#039;<br />&nbsp; &nbsp; option force_link &#039;1&#039;<br />&nbsp; &nbsp; option macaddr &#039;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#039;<br />&nbsp; &nbsp; option proto &#039;dhcp&#039;</p><p>config interface &#039;wan6&#039;<br />&nbsp; &nbsp; option ifname &#039;eth0.2&#039;<br />&nbsp; &nbsp; option proto &#039;dhcpv6&#039;</p><p>config switch<br />&nbsp; &nbsp; option name &#039;switch0&#039;<br />&nbsp; &nbsp; option reset &#039;1&#039;<br />&nbsp; &nbsp; option enable_vlan &#039;1&#039;</p><p>config switch_vlan<br />&nbsp; &nbsp; option device &#039;switch0&#039;<br />&nbsp; &nbsp; option vlan &#039;1&#039;<br />&nbsp; &nbsp; option vid &#039;1&#039;<br />&nbsp; &nbsp; option ports &#039;1 2 3 6t&#039;</p><p>config switch_vlan<br />&nbsp; &nbsp; option device &#039;switch0&#039;<br />&nbsp; &nbsp; option vlan &#039;2&#039;<br />&nbsp; &nbsp; option ports &#039;0 6t&#039;<br />&nbsp; &nbsp; option vid &#039;2&#039;</p><p>config switch_vlan<br />&nbsp; &nbsp; option device &#039;switch0&#039;<br />&nbsp; &nbsp; option vlan &#039;3&#039;<br />&nbsp; &nbsp; option vid &#039;10&#039;<br />&nbsp; &nbsp; option ports &#039;0t 6t&#039;</p><p>config switch_vlan<br />&nbsp; &nbsp; option device &#039;switch0&#039;<br />&nbsp; &nbsp; option vlan &#039;4&#039;<br />&nbsp; &nbsp; option vid &#039;11&#039;<br />&nbsp; &nbsp; option ports &#039;0t 4 6t&#039;</p><p>config switch_vlan<br />&nbsp; &nbsp; option device &#039;switch0&#039;<br />&nbsp; &nbsp; option vlan &#039;5&#039;<br />&nbsp; &nbsp; option ports &#039;0t 6t&#039;<br />&nbsp; &nbsp; option vid &#039;200&#039;</p><p>config interface &#039;mcast&#039;<br />&nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; option ifname &#039;eth0.10&#039;<br />&nbsp; &nbsp; option ipaddr &#039;1.1.1.1&#039;<br />&nbsp; &nbsp; option netmask &#039;255.255.255.255&#039;<br />&nbsp; &nbsp; option broadcast &#039;1.255.255.255&#039;</p><p>config interface &#039;ucast&#039;<br />&nbsp; &nbsp; option ifname &#039;eth0.11&#039;<br />&nbsp; &nbsp; option _orig_ifname &#039;eth0.11&#039;<br />&nbsp; &nbsp; option _orig_bridge &#039;false&#039;<br />&nbsp; &nbsp; option proto &#039;dhcp&#039;</p><p>config switch_port<br />&nbsp; &nbsp; option port &#039;4&#039;<br />&nbsp; &nbsp; option pvid &#039;11&#039;</p>											<p class="post-edited">(Last edited by <strong>Tokhtar</strong> on 27 Sep 2015, 19:43)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>