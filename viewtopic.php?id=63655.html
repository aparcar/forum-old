<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> OpenWRT+USB phone+VoIP. Is it possible?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 5 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p316541">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">uqbar</div>
					<div class="post-datetime">
						24 Mar 2016, 22:30					</div>
				</div>
				<div class="post-content content">
					<p>I have a TP-Link WDR4900 running 15.05.1.<br />I also have a <a href="http://www.plantronics.com/us/product/calisto-240">Plantronics Calisto P240</a> USB handset.<br />I would like to configure the OpenWRT box with VoIP and this USB handset in order to use my SIP account without my PC being turned on. Not a full blown PBX, just a SIP client.<br />I haven&#039;t been able to find any relevant information. I am not even sure this is doable to any extent.<br />Is there anyone here willing to share his/her experience, if any?</p><p>Thanks in advance.</p>											<p class="post-edited">(Last edited by <strong>uqbar</strong> on 24 Mar 2016, 22:31)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p316587">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">bolvan</div>
					<div class="post-datetime">
						25 Mar 2016, 08:09					</div>
				</div>
				<div class="post-content content">
					<p>What you need first is to understand how handset communicates with PC.<br />What kind of USB device it is.<br />It can be proprietary device driven by windows drivers and proprietary software with most likely no linux support.<br />Try plugging it to linux box and run &quot;usb-devices&quot;. see if any driver attached.</p>											<p class="post-edited">(Last edited by <strong>bolvan</strong> on 25 Mar 2016, 08:13)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p316588">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">uqbar</div>
					<div class="post-datetime">
						25 Mar 2016, 08:22					</div>
				</div>
				<div class="post-content content">
					<p>It&#039;s not and RNDIS.<br />Looks more like an USB audio device to my Linux PC:<br /></p><div class="codebox"><pre><code>[  500.078945] usb 3-7: new full-speed USB device number 6 using xhci_hcd
[  515.438433] usb 3-7: new full-speed USB device number 7 using xhci_hcd
[  515.603978] usb 3-7: New USB device found, idVendor=047f, idProduct=ae11
[  515.603980] usb 3-7: New USB device strings: Mfr=1, Product=2, SerialNumber=3
[  515.603982] usb 3-7: Product: Plantronics Calisto P240
[  515.603984] usb 3-7: Manufacturer: Plantronics
[  515.603985] usb 3-7: SerialNumber: AE01072013010Y0000000000000XXXXX
[  515.642497] input: Plantronics Plantronics Calisto P240 as /devices/pci0000:00/0000:00:14.0/usb3/3-7/3-7:1.3/0003:047F:AE11.0004/input/input16
[  515.682719] usbcore: registered new interface driver snd-usb-audio
[  515.693567] plantronics 0003:047F:AE11.0004: input,hiddev0,hidraw3: USB HID v1.00 Device [Plantronics Plantronics Calisto P240] on usb-0000:00:14.0-7/input3</code></pre></div><p>This is what I get from usb-devices:<br /></p><div class="codebox"><pre><code>T:  Bus=03 Lev=01 Prnt=01 Port=06 Cnt=05 Dev#=  7 Spd=12  MxCh= 0
D:  Ver= 2.00 Cls=00(&gt;ifc ) Sub=00 Prot=00 MxPS=64 #Cfgs=  1
P:  Vendor=047f ProdID=ae11 Rev=04.40
S:  Manufacturer=Plantronics
S:  Product=Plantronics Calisto P240
S:  SerialNumber=AE01072013010Y0000000000000XXXXX
C:  #Ifs= 4 Cfg#= 1 Atr=80 MxPwr=400mA
I:  If#= 0 Alt= 0 #EPs= 0 Cls=01(audio) Sub=01 Prot=00 Driver=snd-usb-audio
I:  If#= 1 Alt= 0 #EPs= 0 Cls=01(audio) Sub=02 Prot=00 Driver=snd-usb-audio
I:  If#= 2 Alt= 0 #EPs= 0 Cls=01(audio) Sub=02 Prot=00 Driver=snd-usb-audio
I:  If#= 3 Alt= 0 #EPs= 1 Cls=03(HID  ) Sub=00 Prot=00 Driver=usbhid</code></pre></div><p>So it&#039;s a usbhid (the display?) and three audio channels (microphone, speaker and ringer?)</p>											<p class="post-edited">(Last edited by <strong>uqbar</strong> on 25 Mar 2016, 08:29)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p316589">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">uqbar</div>
					<div class="post-datetime">
						25 Mar 2016, 08:40					</div>
				</div>
				<div class="post-content content">
					<p>I think I undesrtood that the SIP part should/could be done by baresip which is already in the OpenWRT repos.<br />What I really miss is the system part with the drivers like usb-audio.<br />These are the modules loaded in the box once I plug the device:<br /></p><div class="codebox"><pre><code>snd                    47558 10 snd_usb_audio
snd_hwdep               5418  1 snd_usb_audio
snd_pcm                65814  2 snd_usb_audio
snd_usb_audio          95854  0 
snd_usbmidi_lib        16069  1 snd_usb_audio
usbcore               123840 18 snd_usb_audio</code></pre></div><p>and this is what the kernel log says:<br /></p><div class="codebox"><pre><code>[54503.845367] usb 1-1.1: new full-speed USB device number 10 using fsl-ehci
[54504.165355] usb 1-1.1: new full-speed USB device number 11 using fsl-ehci</code></pre></div><p>But I don&#039;t really know what more, as there seems to be very few details about Calisto P240.</p>											<p class="post-edited">(Last edited by <strong>uqbar</strong> on 25 Mar 2016, 08:49)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p316592">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">bolvan</div>
					<div class="post-datetime">
						25 Mar 2016, 09:09					</div>
				</div>
				<div class="post-content content">
					<p>USB headphone consists of the following parts</p><p>1) Audio in (mic), audio out (phone) - can be served by alsa and usb-audio kmod<br />2) Keyboard. Can be served with usb-hid<br />3) Display. Have no idea how it works.</p><p>For all of that software is required. Device does not implement internal voip logic, its just combined peripherals&nbsp; to be driven by software. May be freeswitch will help. It has many plugins and extendable with LUA scripts. Search for &quot;freeswitch softphone&quot;.<br />Programming will be required, it will not be just configuration task. Freeswitch does not seem to support keyboard, although it supports sound cards. Its server application, not client. Client functions are separate thing.</p>											<p class="post-edited">(Last edited by <strong>bolvan</strong> on 25 Mar 2016, 09:23)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p316598">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">uqbar</div>
					<div class="post-datetime">
						25 Mar 2016, 09:52					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>bolvan wrote:</cite><blockquote><p>USB headphone consists of the following parts</p><p>1) Audio in (mic), audio out (phone) - can be served by alsa and usb-audio kmod<br />2) Keyboard. Can be served with usb-hid<br />3) Display. Have no idea how it works.</p></blockquote></div><p>We&#039;re on the same boat so far.<br />I think the display is either managed by the phone itself or it is part of the HID interface.<br /></p><div class="quotebox"><cite>bolvan wrote:</cite><blockquote><p>For all of that software is required. Device does not implement internal voip logic, its just combined peripherals&nbsp; to be driven by software. May be freeswitch will help. It has many plugins and extendable with LUA scripts. Search for &quot;freeswitch softphone&quot;.<br />Programming will be required, it will not be just configuration task. Freeswitch does not seem to support keyboard, although it supports sound cards. Its server application, not client. Client functions are separate thing.</p></blockquote></div><p>I thought I needed a SIP client program, not a server. In the end I won&#039;t be a PBX but a SIP endpoint.<br />But I could be wrong. I&#039;ll make some tests and tries later.<br />Any other hint here?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p316616">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">bolvan</div>
					<div class="post-datetime">
						25 Mar 2016, 12:59					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>uqbar wrote:</cite><blockquote><p>I thought I needed a SIP client program, not a server. In the end I won&#039;t be a PBX but a SIP endpoint.<br />But I could be wrong. I&#039;ll make some tests and tries later.<br />Any other hint here?</p></blockquote></div><p>I&#039;m not expert in telephony programs. But i know freeswitch is very flexible and it can be possible to use its engine for nonstandard applications. I can be wrong since i&#039;ve never done that, i only used it as a simple server.<br />There are console sip clients. The hardest part would be control them with non-standard input device.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>