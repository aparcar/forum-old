<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> 6rd and ipv6-support</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 13 Jul 2015 and 30 Apr 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 3 of 12</div><nav><ul><li><a href="viewtopic.php%3Fid=40853&amp;p=1.html">1</a></li><li><a href="viewtopic.php%3Fid=40853&amp;p=2.html">2</a></li><li class="pagination-current"><span>3</span></li><li><a href="viewtopic.php%3Fid=40853&amp;p=4.html">4</a></li><li><a href="viewtopic.php%3Fid=40853&amp;p=5.html">5</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=40853&amp;p=12.html">12</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p186322">
				<div class="post-metadata">
					<div class="post-num">Post #51</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						17 Dec 2012, 23:12					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nbd wrote:</cite><blockquote><p>On the rev that fails, please show me the output of &#039;ifstatus sixxs&#039;</p></blockquote></div><div class="codebox"><pre><code> BARRIER BREAKER (Bleeding Edge, r34739)
...
root@OpenWrt:~# ifstatus sixxs
{
        &quot;up&quot;: false,
        &quot;pending&quot;: true,
        &quot;available&quot;: true,
        &quot;autostart&quot;: true,
        &quot;proto&quot;: &quot;6in4&quot;,
        &quot;data&quot;: {

        },
        &quot;errors&quot;: [
                {
                        &quot;subsystem&quot;: &quot;6in4&quot;,
                        &quot;code&quot;: &quot;NO_WAN_LINK&quot;
                }
        ]
}</code></pre></div><p>also LAN shows empty for ipv6 adress:<br/></p><div class="codebox"><pre><code>root@OpenWrt:~# ifstatus lan
{
        &quot;up&quot;: true,
        &quot;pending&quot;: false,
        &quot;available&quot;: true,
        &quot;autostart&quot;: true,
        &quot;uptime&quot;: 188,
        &quot;l3_device&quot;: &quot;br-lan&quot;,
        &quot;proto&quot;: &quot;static&quot;,
        &quot;device&quot;: &quot;br-lan&quot;,
        &quot;metric&quot;: 0,
        &quot;ipv4-address&quot;: [
                {
                        &quot;address&quot;: &quot;192.168.1.1&quot;,
                        &quot;mask&quot;: 24
                }
        ],
        &quot;ipv6-address&quot;: [

        ],</code></pre></div>											<p class="post-edited">(Last edited by <strong>hnyman</strong> on 18 Dec 2012, 22:11)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186365">
				<div class="post-metadata">
					<div class="post-num">Post #52</div>
					<div class="post-author">lucapost</div>
					<div class="post-datetime">
						18 Dec 2012, 12:01					</div>
				</div>
				<div class="post-content content">
					<p>similar problem here, with 6in4 and hurricane:</p><div class="codebox"><pre><code> BARRIER BREAKER (Bleeding Edge, r34744)
 -----------------------------------------------------
  * 1/2 oz Galliano         Pour all ingredients into
  * 4 oz cold Coffee        an irish coffee mug filled
  * 1 1/2 oz Dark Rum       with crushed ice. Stir.
  * 2 tsp. Creme de Cacao
 -----------------------------------------------------
root@kozlic:~# 
root@kozlic:~# ifstatus henet
{
    &quot;up&quot;: false,
    &quot;pending&quot;: true,
    &quot;available&quot;: true,
    &quot;autostart&quot;: true,
    &quot;proto&quot;: &quot;6in4&quot;,
    &quot;data&quot;: {
        
    },
    &quot;errors&quot;: [
        {
            &quot;subsystem&quot;: &quot;6in4&quot;,
            &quot;code&quot;: &quot;NO_WAN_LINK&quot;
        }
    ]
}</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186367">
				<div class="post-metadata">
					<div class="post-num">Post #53</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						18 Dec 2012, 12:40					</div>
				</div>
				<div class="post-content content">
					<p>As fas as I was able to diagnose, that &quot;NO_WAN_LINK&quot; is coming from the 6in4 script, which fails to find the normal ipv4 wan address.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186372">
				<div class="post-metadata">
					<div class="post-num">Post #54</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						18 Dec 2012, 13:37					</div>
				</div>
				<div class="post-content content">
					<p>Try this patch:<br/></p><div class="codebox"><pre><code>diff --git a/package/network/ipv6/6in4/files/6in4.sh b/package/network/ipv6/6in4/files/6in4.sh
index 651d7b9..bb36ded 100755
--- a/package/network/ipv6/6in4/files/6in4.sh
+++ b/package/network/ipv6/6in4/files/6in4.sh
@@ -26,6 +26,8 @@ proto_6in4_setup() {
        ( proto_add_host_dependency &quot;$cfg&quot; 0.0.0.0 )
 
        [ -z &quot;$ipaddr&quot; ] &amp;&amp; {
+               network_flush_cache
+
                local wanif
                if ! network_find_wan wanif || ! network_get_ipaddr ipaddr &quot;$wanif&quot;; then
                        proto_notify_error &quot;$cfg&quot; &quot;NO_WAN_LINK&quot;</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186375">
				<div class="post-metadata">
					<div class="post-num">Post #55</div>
					<div class="post-author">lucapost</div>
					<div class="post-datetime">
						18 Dec 2012, 14:06					</div>
				</div>
				<div class="post-content content">
					<p>no results with 6in4.sh suggested <a href="http://dpaste.com/847876/">http://dpaste.com/847876/</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186379">
				<div class="post-metadata">
					<div class="post-num">Post #56</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						18 Dec 2012, 15:11					</div>
				</div>
				<div class="post-content content">
					<p>Should be fixed with <a href="https://dev.openwrt.org/changeset/34746">https://dev.openwrt.org/changeset/34746</a> (<a href="http://nbd.name/gitweb.cgi?p=luci2/libubox.git;a=commitdiff;h=4d0a00c82c77a9395c992841237e2c06c4606a5e">http://nbd.name/gitweb.cgi?p=luci2/libu … 06c4606a5e</a>)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186386">
				<div class="post-metadata">
					<div class="post-num">Post #57</div>
					<div class="post-author">lucapost</div>
					<div class="post-datetime">
						18 Dec 2012, 15:53					</div>
				</div>
				<div class="post-content content">
					<p>fixed! thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186413">
				<div class="post-metadata">
					<div class="post-num">Post #58</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						18 Dec 2012, 22:10					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>hnyman wrote:</cite><blockquote><p>IPv6 functionality seems to be broken for me with r34739. Worked ok with yesterday&#039;s r34715.</p></blockquote></div><p>The fix mentioned by Jow works for me, too. So, this bug was caused by the libubox library, not the ipv6-support module.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p187265">
				<div class="post-metadata">
					<div class="post-num">Post #59</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						28 Dec 2012, 20:30					</div>
				</div>
				<div class="post-content content">
					<p>One question about r34908: <a href="https://dev.openwrt.org/changeset/34908">https://dev.openwrt.org/changeset/34908</a></p><p>It looks like there is a new option &quot;site_border&quot;.<br/>Wiki says that the default is 0: <a href="http://wiki.openwrt.org/doc/uci/network6#options">http://wiki.openwrt.org/doc/uci/network6#options</a><br/>but default config file sets it to 1: <a href="https://dev.openwrt.org/browser/trunk/package/network/ipv6/ipv6-support/files/network6.config">https://dev.openwrt.org/browser/trunk/package/network/ipv6/ipv6-support/files/network6.config</a></p><p>Which is right?</p><p>The same discrepancy goes actually also for &quot;peerdns&quot; and &quot;prefix_fallback&quot;, as the default config file sets values differing from the supposed default values. Is that intentional?</p><p>I understand that the underlying scripts use &quot;no action defaults&quot;, but it might then be documented better in the wiki that what are the suggested values and why the default config file sets those values.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p187313">
				<div class="post-metadata">
					<div class="post-num">Post #60</div>
					<div class="post-author">CyrusFF</div>
					<div class="post-datetime">
						29 Dec 2012, 12:16					</div>
				</div>
				<div class="post-content content">
					<p>OK fixed this for peerdns and site_border as it is more consistent for the default to be 1 as one would expect that they are useful in most cases.</p><p>For prefix_fallback I will leave it as is for now as the prefix_fallback can cause some surprises if you don&#039;t know about it and it is not mentioned in the config file.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p187341">
				<div class="post-metadata">
					<div class="post-num">Post #61</div>
					<div class="post-author">KarlHegbloom</div>
					<div class="post-datetime">
						29 Dec 2012, 20:43					</div>
				</div>
				<div class="post-content content">
					<p>I have Comcast cable Internet in Salt Lake City, UT. There appears to be native ipv6 support. When I use the ISC dhcp6c (IIRC) on Openwrt, I get a /64, but when I use the odhcp6c it gives me a /128. Any ideas?</p><p>I tried several dhcp6 clients, and one gave the /64, but the rest give the /128.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p187342">
				<div class="post-metadata">
					<div class="post-num">Post #62</div>
					<div class="post-author">KarlHegbloom</div>
					<div class="post-datetime">
						29 Dec 2012, 20:47					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m also having trouble getting ipv6-support to set up ipv6 on anything other than wan and lan. I also have a dmz and a hot network, and want ipv6 on them. When I attempt to enable it, none of the interfaces get ipv6 addresses. What could I be doing wrong? What&#039;s the right way to set this up?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p187343">
				<div class="post-metadata">
					<div class="post-num">Post #63</div>
					<div class="post-author">CyrusFF</div>
					<div class="post-datetime">
						29 Dec 2012, 20:48					</div>
				</div>
				<div class="post-content content">
					<p>interesting. can you try setting<br/>option request_prefix 64<br/>in the wan section of network6</p><p>also if you still have the isc dhcp at hand a pcap using tcpdump or so would help.</p><p><strong>edit</strong><br/>regarding your address problem. have you added sections in network6 (similar to lan with mode router) for your other interfaces?</p>											<p class="post-edited">(Last edited by <strong>CyrusFF</strong> on 29 Dec 2012, 20:52)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p187344">
				<div class="post-metadata">
					<div class="post-num">Post #64</div>
					<div class="post-author">KarlHegbloom</div>
					<div class="post-datetime">
						29 Dec 2012, 20:50					</div>
				</div>
				<div class="post-content content">
					<p>Ok. Today I have my 3 year old with me, and he wants to play. :-)&nbsp; Later this evening, or perhaps not until Sunday or Monday... I&#039;ll use opkg to install the other dhcp6 client and tcpdump, then write you a report.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p187345">
				<div class="post-metadata">
					<div class="post-num">Post #65</div>
					<div class="post-author">CyrusFF</div>
					<div class="post-datetime">
						29 Dec 2012, 20:51					</div>
				</div>
				<div class="post-content content">
					<p>thank you very much</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p187354">
				<div class="post-metadata">
					<div class="post-num">Post #66</div>
					<div class="post-author">KarlHegbloom</div>
					<div class="post-datetime">
						30 Dec 2012, 01:07					</div>
				</div>
				<div class="post-content content">
					<p>I ran the &#039;odhcp6c&#039; by hand from the command line, using the same<br/>arguments as I saw it running with when it was started for me by the<br/>system. Here&#039;s the output:</p><p>root@gw:~# /usr/sbin/odhcp6c -s/lib/ipv6/dhcpv6.sh -P64 eth0<br/>odhcp6c[16571]: Sending SOLICIT (timeout 4294967295s)<br/>odhcp6c[16571]: Got a valid reply after 38ms<br/>odhcp6c[16571]: Got a valid reply after 95ms<br/>odhcp6c[16571]: Sending REQUEST (timeout 4294967295s)<br/>odhcp6c[16571]: Got a valid reply after 38ms<br/>odhcp6c[16571]: assigning address 2001:558:6008:18:1c3a:2a5b:1fd3:9438/128 for iface 2: Success<br/>odhcp6c[16571]: State for eth0 changed to bound<br/>odhcp6c[16571]: Sending &lt;POLL&gt; (timeout 86400s)<br/>sh: missing ]<br/>/lib/ipv6/dhcpv6.sh: line 33: bound: not found</p><br/><p>Here&#039;s the tcpdump command and output from that:</p><p>tcpdump -i eth0 -n -l -vv &#039;(ip6 net fe80::/10 &amp;&amp; udp &amp;&amp; portrange 546-547)&#039;</p><p>15:48:57.821012 IP6 (hlim 1, next-header UDP (17) payload length: 128) fe80::215:6dff:fec5:c200.546 &gt; ff02::1:2.547: [udp sum ok] dhcp6 solicit (xid=1f0c78 (elapsed-time 0) (option-request DNS-server DNS-search-list) (client-ID hwaddr type 1 00156dc5c200) (reconfigure-accept) (Client-FQDN) (IA_NA IAID:1 T1:0 T2:0) (IA_PD IAID:1 T1:0 T2:0) (IA_PD-prefix ::/64 pltime:0 vltime:0))<br/>15:48:57.857194 IP6 (hlim 64, next-header UDP (17) payload length: 178) fe80::201:5cff:fe22:5d01.547 &gt; fe80::215:6dff:fec5:c200.546: [udp sum ok] dhcp6 advertise (xid=1f0c78 (client-ID hwaddr type 1 00156dc5c200) (server-ID hwaddr/time type 1 time 390983873 14feb5d5b44d) (IA_NA IAID:1 T1:172800 T2:276480 (IA_ADDR 2001:558:6008:18:1c3a:2a5b:1fd3:9438 pltime:345600 vltime:345600)[|dhcp6ext]) (IA_PD IAID:1 T1:172800 T2:276480 (IA_PD-prefix 2601:7:6c00:48::/64 pltime:345600 vltime:345600) (reconfigure-accept) (preference 255)[|dhcp6ext]) (reconfigure-accept) (preference 255) (DNS-server 2001:558:feed::2 2001:558:feed::1))<br/>15:48:57.914642 IP6 (hlim 64, next-header UDP (17) payload length: 178) fe80::201:5cff:fe22:5d01.547 &gt; fe80::215:6dff:fec5:c200.546: [udp sum ok] dhcp6 advertise (xid=1f0c78 (client-ID hwaddr type 1 00156dc5c200) (server-ID hwaddr/time type 1 time 390983871 14feb5d5aa6c) (IA_NA IAID:1 T1:172800 T2:276480 (IA_ADDR 2001:558:6008:18:893e:d0f:d887:850 pltime:345600 vltime:345600)[|dhcp6ext]) (IA_PD IAID:1 T1:172800 T2:276480 (IA_PD-prefix 2601:7:6c40:14::/64 pltime:345600 vltime:345600) (reconfigure-accept) (preference 0)[|dhcp6ext]) (reconfigure-accept) (preference 0) (DNS-server 2001:558:feed::2 2001:558:feed::1))<br/>15:48:58.759181 IP6 (hlim 1, next-header UDP (17) payload length: 142) fe80::215:6dff:fec5:c200.546 &gt; ff02::1:2.547: [udp sum ok] dhcp6 request (xid=e88c22 (elapsed-time 0) (option-request DNS-server DNS-search-list) (client-ID hwaddr type 1 00156dc5c200) (server-ID hwaddr/time type 1 time 390983873 14feb5d5b44d) (Client-FQDN) (IA_NA IAID:1 T1:0 T2:0) (IA_PD IAID:1 T1:0 T2:0) (IA_PD-prefix ::/64 pltime:0 vltime:0))<br/>15:48:58.795692 IP6 (hlim 64, next-header UDP (17) payload length: 169) fe80::201:5cff:fe22:5d01.547 &gt; fe80::215:6dff:fec5:c200.546: [udp sum ok] dhcp6 reply (xid=e88c22 (client-ID hwaddr type 1 00156dc5c200) (server-ID hwaddr/time type 1 time 390983873 14feb5d5b44d) (IA_NA IAID:1 T1:172800 T2:276480 (IA_ADDR 2001:558:6008:18:1c3a:2a5b:1fd3:9438 pltime:345600 vltime:345600)[|dhcp6ext]) (IA_PD IAID:1 T1:172799 T2:276479 (IA_PD-prefix 2601:7:6c00:48::/64 pltime:345599 vltime:345599)[|dhcp6ext]) (DNS-server 2001:558:feed::2 2001:558:feed::1))</p><p>... and the result:</p><p>ip -6 addr show dev eth0</p><p>2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qlen 5<br/>&nbsp; &nbsp; inet6 2001:558:6008:18:1c3a:2a5b:1fd3:9438/128 scope global dynamic <br/>&nbsp; &nbsp; &nbsp; &nbsp;valid_lft 345569sec preferred_lft 345569sec<br/>&nbsp; &nbsp; inet6 fe80::215:6dff:fec5:c200/64 scope link <br/>&nbsp; &nbsp; &nbsp; &nbsp;valid_lft forever preferred_lft forever</p><br/><p>After killing that, and running &quot;/etc/init.d/dhclient6 start&quot; to<br/>launch the ISC dhclient, using the defaults straight from it&#039;s freshly<br/>installed package:</p><p>tcpdump -i eth0 -n -l -vv &#039;(ip6 net fe80::/10 &amp;&amp; udp &amp;&amp; portrange 546-547)&#039;</p><p>tcpdump: listening on eth0, link-type EN10MB (Ethernet), capture size 65535 bytes<br/>16:05:13.553193 IP6 (hlim 1, next-header UDP (17) payload length: 62) fe80::215:6dff:fec5:c200.546 &gt; ff02::1:2.547: [udp sum ok] dhcp6 solicit (xid=5f36e6 (client-ID hwaddr/time type 1 time 410137513 00156dc5c200) (option-request DNS-server DNS-search-list opt_54) (elapsed-time 0) (IA_NA IAID:1841676800 T1:3600 T2:5400))<br/>16:05:14.644950 IP6 (hlim 1, next-header UDP (17) payload length: 62) fe80::215:6dff:fec5:c200.546 &gt; ff02::1:2.547: [udp sum ok] dhcp6 solicit (xid=5f36e6 (client-ID hwaddr/time type 1 time 410137513 00156dc5c200) (option-request DNS-server DNS-search-list opt_54) (elapsed-time 109) (IA_NA IAID:1841676800 T1:3600 T2:5400))<br/>16:05:16.907833 IP6 (hlim 1, next-header UDP (17) payload length: 62) fe80::215:6dff:fec5:c200.546 &gt; ff02::1:2.547: [udp sum ok] dhcp6 solicit (xid=5f36e6 (client-ID hwaddr/time type 1 time 410137513 00156dc5c200) (option-request DNS-server DNS-search-list opt_54) (elapsed-time 335) (IA_NA IAID:1841676800 T1:3600 T2:5400))<br/>16:05:16.949593 IP6 (hlim 64, next-header UDP (17) payload length: 133) fe80::201:5cff:fe22:5d01.547 &gt; fe80::215:6dff:fec5:c200.546: [udp sum ok] dhcp6 advertise (xid=5f36e6 (client-ID hwaddr/time type 1 time 410137513 00156dc5c200) (server-ID hwaddr/time type 1 time 390983873 14feb5d5b44d) (IA_NA IAID:1841676800 T1:172800 T2:276480 (IA_ADDR 2001:558:6008:18:4dc4:a4c4:239e:9cfd pltime:345600 vltime:345600) (preference 255)[|dhcp6ext]) (preference 255) (DNS-server 2001:558:feed::2 2001:558:feed::1))<br/>16:05:16.951789 IP6 (hlim 1, next-header UDP (17) payload length: 108) fe80::215:6dff:fec5:c200.546 &gt; ff02::1:2.547: [udp sum ok] dhcp6 request (xid=5b1da7 (client-ID hwaddr/time type 1 time 410137513 00156dc5c200) (server-ID hwaddr/time type 1 time 390983873 14feb5d5b44d) (option-request DNS-server DNS-search-list opt_54) (elapsed-time 0) (IA_NA IAID:1841676800 T1:3600 T2:5400 (IA_ADDR 2001:558:6008:18:4dc4:a4c4:239e:9cfd pltime:7200 vltime:7500) (opt_0) (opt_0) (opt_0)))<br/>16:05:17.000436 IP6 (hlim 64, next-header UDP (17) payload length: 128) fe80::201:5cff:fe22:5d01.547 &gt; fe80::215:6dff:fec5:c200.546: [udp sum ok] dhcp6 reply (xid=5b1da7 (client-ID hwaddr/time type 1 time 410137513 00156dc5c200) (server-ID hwaddr/time type 1 time 390983873 14feb5d5b44d) (IA_NA IAID:1841676800 T1:172800 T2:276480 (IA_ADDR 2001:558:6008:18:4dc4:a4c4:239e:9cfd pltime:345600 vltime:345600)[|dhcp6ext]) (DNS-server 2001:558:feed::2 2001:558:feed::1))</p><p>ip -6 addr show dev eth0</p><p>2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qlen 5<br/>&nbsp; &nbsp; inet6 2001:558:6008:18:46b:d462:a467:c5e9/64 scope global <br/>&nbsp; &nbsp; &nbsp; &nbsp;valid_lft forever preferred_lft forever<br/>&nbsp; &nbsp; inet6 fe80::215:6dff:fec5:c200/64 scope link <br/>&nbsp; &nbsp; &nbsp; &nbsp;valid_lft forever preferred_lft forever</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p187360">
				<div class="post-metadata">
					<div class="post-num">Post #67</div>
					<div class="post-author">KarlHegbloom</div>
					<div class="post-datetime">
						30 Dec 2012, 04:33					</div>
				</div>
				<div class="post-content content">
					<p>This patch clears up that error message, but does not provide me with a /64 on wan.</p><p>Index: package/network/ipv6/ipv6-support/files/dhcpv6.sh<br/>===================================================================<br/>--- package/network/ipv6/ipv6-support/files/dhcpv6.sh&nbsp; &nbsp; (revision 34933)<br/>+++ package/network/ipv6/ipv6-support/files/dhcpv6.sh&nbsp; &nbsp; (working copy)<br/>@@ -30,7 +30,7 @@</p> <br/><p> # Operations in case of success<br/>-[ &quot;$state&quot; == &quot;timeout&quot; || &quot;$state&quot; == &quot;unbound&quot; ] &amp;&amp; exit 0<br/>+[ &quot;$state&quot; == &quot;timeout&quot; ] || [ &quot;$state&quot; == &quot;unbound&quot; ] &amp;&amp; exit 0</p><p> local peerdns<br/> config_get_bool peerdns &quot;$network&quot; peerdns 1</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p187362">
				<div class="post-metadata">
					<div class="post-num">Post #68</div>
					<div class="post-author">KarlHegbloom</div>
					<div class="post-datetime">
						30 Dec 2012, 05:23					</div>
				</div>
				<div class="post-content content">
					<p>For what it&#039;s worth, I get 10/10 almost instantly when I visit <a href="http://ipv6.test-ipv6.com/.">http://ipv6.test-ipv6.com/.</a> My workstation and laptop, when connected via br-lan, get ula addresses. The address shown at that test page is the external address of my OpenWRT router. The br-lan interface itself has both a ula and global ipv6 address with a /64 prefix, but that&#039;s not being propagated to the workstation.</p><p>EDIT: I was incorrect. Apparently it takes a little longer for the ipv6 address to be assigned... Now I&#039;m seeing that my workstation indeed has a global /64 address in the same subnet as the global address assigned to the br-lan interface on the router. But, the wan interface on the router does not have an address in the same subnet. Is that normal? (I&#039;ve not yet finished reading a book on the subject, sorry. I&#039;ll try to get in a chapter a day.)</p>											<p class="post-edited">(Last edited by <strong>KarlHegbloom</strong> on 30 Dec 2012, 18:54)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p187373">
				<div class="post-metadata">
					<div class="post-num">Post #69</div>
					<div class="post-author">CyrusFF</div>
					<div class="post-datetime">
						30 Dec 2012, 10:56					</div>
				</div>
				<div class="post-content content">
					<p>That is interesting. Thanks for the dumps.<br/>It seems that with ISC dhcp you do not really get a /64 prefix. It just requests a regular address (like a client) and adds it with a /64-prefix instead of a /128. I&#039;m not sure whether this is correct or now, however the address you get is not the prefix you could use. To acquire prefixes it needs to send an IA_PD option and receive prefixes in that.</p><p>odhcp6c logs look fine. It gets a prefix (IA_PD option) and hopefully tries to distribute it. Do you by chance have more than one interface with mode=router in network6? If yes, maybe try requesting a bigger prefix (e.g. request_prefix 60 instead of 64).</p><p>However as you said that br-lan has both a ULA and global prefix with odhcp6c, correct? In that case it should advertise both prefixes. Are you sure that your clients only get a ULA-adress? ULA-traffic should not be routed through the wan-interface and I don&#039;t see how you could pass the ipv6 test otherwise.</p><p>I will test native DHCPv6 stuff etc. when I&#039;m back home in 2 days or so.<br/>Thanks for finding the typo in dhcpv6.sh, however I don&#039;t think it has any effect in your scenario.</p>											<p class="post-edited">(Last edited by <strong>CyrusFF</strong> on 30 Dec 2012, 10:56)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188836">
				<div class="post-metadata">
					<div class="post-num">Post #70</div>
					<div class="post-author">erictooth</div>
					<div class="post-datetime">
						14 Jan 2013, 03:44					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m only getting a /128 from Comcast too. When I was using wide-dhcpv6-client before I was getting a /128 on WAN and a /64 on LAN, and everything was working great. I&#039;m using the suggested &quot;native&quot; configuration for ipv6-support, and I&#039;ve tried everything but I can&#039;t seem to get it to work. Can anybody give me some tips if they&#039;ve gotten their ipv6-support config to work with Comcast?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188837">
				<div class="post-metadata">
					<div class="post-num">Post #71</div>
					<div class="post-author">mikma</div>
					<div class="post-datetime">
						14 Jan 2013, 04:18					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>CyrusFF wrote:</cite><blockquote><p>That is interesting. Thanks for the dumps.<br/>It seems that with ISC dhcp you do not really get a /64 prefix. It just requests a regular address (like a client) and adds it with a /64-prefix instead of a /128.</p></blockquote></div><p>Prefix lengths for regular client addresses are announced via RA and not DHCPV6 I think.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188853">
				<div class="post-metadata">
					<div class="post-num">Post #72</div>
					<div class="post-author">CyrusFF</div>
					<div class="post-datetime">
						14 Jan 2013, 09:21					</div>
				</div>
				<div class="post-content content">
					<p>@mikma: yes but there was a confusion of an individual address and a prefix.<br/>@erictooth: can you give some details? how did you configure wide? are there any prefix-related messages in the log?<br/>how did you configure network6? did you try to set request_prefix to a distinct value (e.g. 64)?</p>											<p class="post-edited">(Last edited by <strong>CyrusFF</strong> on 14 Jan 2013, 09:36)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188928">
				<div class="post-metadata">
					<div class="post-num">Post #73</div>
					<div class="post-author">erictooth</div>
					<div class="post-datetime">
						14 Jan 2013, 20:39					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>CyrusFF wrote:</cite><blockquote><p>@erictooth: can you give some details? how did you configure wide? are there any prefix-related messages in the log? how did you configure network6? did you try to set request_prefix to a distinct value (e.g. 64)?</p></blockquote></div><br/><p><strong>network6</strong> — <em>ipv6-support, not working, &quot;standard&quot; native ipv6 config according to wiki on ipv6-support. WAN interface gets a /128 starting with 2001, LAN gets nothing.</em><br/></p><div class="codebox"><pre><code>config interface &#039;wan&#039;
    option mode &#039;dhcpv6&#039;
    option request_prefix &#039;auto&#039;     # I also tried 64
    option prefix_fallback &#039;relay&#039;

config interface &#039;lan&#039;
    option mode &#039;router&#039;
    option advertise_prefix &#039;64&#039;
    option relay_master &#039;wan&#039;</code></pre></div><br/><p><strong>dhcp6c</strong> — <em>wide-dhcpv6-client, working. WAN gets a /128 starting with 2001 and LAN gets a /64 starting with 2601.</em><br/></p><div class="codebox"><pre><code>config &#039;dhcp6c&#039; &#039;basic&#039;
    option &#039;enabled&#039; &#039;1&#039;
    option &#039;interface&#039; &#039;wan&#039;
    option &#039;dns&#039; &#039;dnsmasq&#039;
    option &#039;debug&#039; &#039;0&#039;

    option &#039;pd&#039; &#039;1&#039;                    # Prefix Delegation
    option &#039;na&#039; &#039;1&#039;                    # Non-Temporary Address — must be &#039;1&#039; for Comcast
    option &#039;rapid_commit&#039; &#039;1&#039;            # Rapid Commit

config &#039;interface&#039; &#039;lan&#039;
    option &#039;enabled&#039; &#039;1&#039;
    option &#039;sla_id&#039; &#039;1&#039;
    option &#039;sla_len&#039; &#039;0&#039;</code></pre></div><p>I won&#039;t be able to go through the logs until later today but I&#039;ll post whatever I find.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p189005">
				<div class="post-metadata">
					<div class="post-num">Post #74</div>
					<div class="post-author">CyrusFF</div>
					<div class="post-datetime">
						15 Jan 2013, 16:03					</div>
				</div>
				<div class="post-content content">
					<p>I just commited some major changes for IPv6-support. This is the final native integration now. I don&#039;t expect the configuration to break any more only some more things might be added later on.</p><p>Configuration is now much easier. You only need to configure /etc/config/network now, there is no network6 any more. Everything should feel more integrated now.</p><p>I updated the examples on <a href="http://wiki.openwrt.org/doc/uci/network6">http://wiki.openwrt.org/doc/uci/network6</a></p><p>For configuration details see:<br/>Static: <a href="http://wiki.openwrt.org/doc/uci/network#protocol.static">http://wiki.openwrt.org/doc/uci/network#protocol.static</a><br/>DHCPv6: <a href="http://wiki.openwrt.org/doc/uci/network#protocol.dhcpv6">http://wiki.openwrt.org/doc/uci/network#protocol.dhcpv6</a><br/>etc.</p><p>Prefix distribution and relaying: <a href="http://wiki.openwrt.org/doc/uci/6relayd">http://wiki.openwrt.org/doc/uci/6relayd</a><br/>(The old way of configuring 6relayd directly should still work).</p><p>Other Changes:<br/>* 6distributed and network6 are now gone.<br/>* IPv6 prefix-related configuration is now handled by /etc/config/network (netifd)<br/>* RD, DHCPv6 server &amp; RD, DHCPv6 and NDP relaying support (as well as the fallback-handling) is now handled in /etc/config/6relayd</p><br/><p>If you want to use radvd or dnsmasq-dhcpv6 (&gt;=2.66) for your configuration then you can configure them accordingly (for dnsmasq this might need you to add some more init-logic).</p>											<p class="post-edited">(Last edited by <strong>CyrusFF</strong> on 15 Jan 2013, 16:22)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p189157">
				<div class="post-metadata">
					<div class="post-num">Post #75</div>
					<div class="post-author">CyrusFF</div>
					<div class="post-datetime">
						17 Jan 2013, 10:35					</div>
				</div>
				<div class="post-content content">
					<p>FYI: I just pushed some fixes for DHCPv6 over PPP.</p><p>* select the correct interface when doing DHCPv6 over PPP<br/>* fix &quot;ICMPv6: RA: ndisc_router_discovery failed to add default route&quot;-issue<br/>* fix dhcpv6 client using all-zero MAC over PPP interfaces</p><p>I tested this with a local pppoe-testserver so it should now hopefully work as expected.<br/>It should now not be necessary to use radvd or wide-dhcpv6-client for prefix delegation to work correctly.</p>									</div>
			</article>

			
		
						<div class="notice">
				<p>Sorry, posts 76 to 75 are missing from our archive.</p>
			</div>
		
		
	
	<div class="pagination"><div class="pagination-number">Page 3 of 12</div><nav><ul><li><a href="viewtopic.php%3Fid=40853&amp;p=1.html">1</a></li><li><a href="viewtopic.php%3Fid=40853&amp;p=2.html">2</a></li><li class="pagination-current"><span>3</span></li><li><a href="viewtopic.php%3Fid=40853&amp;p=4.html">4</a></li><li><a href="viewtopic.php%3Fid=40853&amp;p=5.html">5</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=40853&amp;p=12.html">12</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>