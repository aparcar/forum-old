<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> openvpn help.</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 29 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p77780">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">superman911</div>
					<div class="post-datetime">
						8 Dec 2008, 23:45					</div>
				</div>
				<div class="post-content content">
					<p>Hi there</p><p>This is the errors I am getting...</p><p>Mon Dec&nbsp; 8 23:44:46 2008: IMPORTANT: OpenVPN&#039;s default port number is now 1194<br />Mon Dec&nbsp; 8 23:44:46 2008: WARNING: No server certificate verification method has been enabled.&nbsp; See <a href="http://openvpn.net/howto.html#mitm">http://openvpn.net/howto.html#mitm</a> for more info.<br />Mon Dec&nbsp; 8 23:44:46 2008: LZO compression initialized<br />Mon Dec&nbsp; 8 23:44:46 2008: Attempting to establish TCP connection with ***.***.***.***:1194<br />Mon Dec&nbsp; 8 23:44:47 2008: TCP connection established with ***.***.***.***:1194<br />Mon Dec&nbsp; 8 23:44:47 2008: TCPv4_CLIENT link local: [undef]<br />Mon Dec&nbsp; 8 23:44:47 2008: TCPv4_CLIENT link remote: ***.***.***.***:1194<br />Mon Dec&nbsp; 8 23:45:16 2008: WARNING: &#039;link-mtu&#039; is used inconsistently<br />Mon Dec&nbsp; 8 23:45:16 2008: WARNING: &#039;cipher&#039; is used inconsistently<br />Mon Dec&nbsp; 8 23:45:16 2008: [computeassist] Peer Connection Initiated with ***.***.***.***:1194<br />Mon Dec&nbsp; 8 23:45:19 2008: Options error: Unrecognized option or missing parameter(s) in [PUSH-OPTIONS]:4: topology (2.0.9)<br />Mon Dec&nbsp; 8 23:45:19 2008: gw 192.168.0.1<br />Mon Dec&nbsp; 8 23:45:19 2008: TUN/TAP device /dev/tun0 opened<br />Mon Dec&nbsp; 8 23:45:19 2008: /sbin/ifconfig tun0 delete<br />Mon Dec&nbsp; 8 23:45:19 2008: NOTE: Tried to delete pre-existing tun/tap instance -- No Problem if failure<br />Mon Dec&nbsp; 8 23:45:19 2008: /sbin/ifconfig tun0 10.8.0.6 10.8.0.5 mtu 1500 netmask 255.255.255.255 up<br />Mon Dec&nbsp; 8 23:45:19 2008: /Applications/Viscosity.app/Contents/Resources/dnsup.py tun0 1500 1560 10.8.0.6 10.8.0.5 init<br />Mon Dec&nbsp; 8 23:45:19 2008: Initialization Sequence Completed<br />Mon Dec&nbsp; 8 23:45:21 2008: Connection reset<br />Mon Dec&nbsp; 8 23:45:21 2008: SIGUSR1[soft<br />Mon Dec&nbsp; 8 23:45:21 2008: IMPORTANT: OpenVPN&#039;s default port number is now 1194<br />Mon Dec&nbsp; 8 23:45:21 2008: WARNING: No server certificate verification method has been enabled.&nbsp; See <a href="http://openvpn.net/howto.html#mitm">http://openvpn.net/howto.html#mitm</a> for more info.<br />Mon Dec&nbsp; 8 23:45:21 2008: Re-using SSL/TLS context<br />Mon Dec&nbsp; 8 23:45:21 2008: LZO compression initialized<br />Mon Dec&nbsp; 8 23:45:21 2008: Attempting to establish TCP connection with ***.***.***.***:1194<br />Mon Dec&nbsp; 8 23:45:22 2008: TCP connection established with ***.***.***.***:1194<br />Mon Dec&nbsp; 8 23:45:22 2008: TCPv4_CLIENT link local: [undef]<br />Mon Dec&nbsp; 8 23:45:22 2008: TCPv4_CLIENT link remote: ***.***.***.***:1194</p><p>Server.conf</p><p>port 1194<br />proto tcp<br />dev tun<br />ca keys/ca.crt<br />cert keys/computeassist.crt<br />key keys/computeassist.key<br />dh keys/dh1024.pem<br />server 10.8.0.0 255.255.255.0<br />push &quot;dhcp-option DNS 192.168.1.11&quot;<br />ifconfig-pool-persist ipp.txt<br />push &quot;redirect-gateway&quot;<br />keepalive 10 120<br />comp-lzo<br />persist-key<br />persist-tun<br />status server-tcp.log<br />verb 3<br />~&nbsp; &nbsp; &nbsp; &nbsp; </p><p>Client.conf</p><p>client<br />dev-node LVVPN<br />proto tcp<br />dev tun<br />remote ***.***.***.*** 1194<br />persist-key<br />persist-tun<br />ca ca.crt<br />cert client1.crt<br />key client1.key<br />cipher AES-128-CBC<br />comp-lzo<br />verb 3<br />mute 20</p><p>Please could someone tell me what I am doing wrong....</p><p>Many thanks<br />Superman</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p77781">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						8 Dec 2008, 23:53					</div>
				</div>
				<div class="post-content content">
					<p>Hi.</p><p>Looks like the connection was established correctly but then shut down because ping probes could not reach the vpn server via vpn.<br />Maybe traffic via tun0 is not allowed?</p><p>~ JoW</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p77782">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">vincentfox</div>
					<div class="post-datetime">
						9 Dec 2008, 00:02					</div>
				</div>
				<div class="post-content content">
					<p>Iptables are your most likely problem</p><p>Why are you specifying the cipher on the client?</p><p>By the way I recommend UDP for OpenVPN.<br />TCP is too much overhead IMO.</p><p>Also I usually do:<br />dev tun1</p><p>That way I know my OpenVPN tunnel is on a specific<br />interface not &quot;first open&quot; so when I do iptables rules<br />I can specify tun1 as in &quot;iptables (blah) -i tun1 (blah)&quot;</p><p>Would help if you crank up the verbosity higher than<br />just 3 and run it in foreground for debugging.</p><p>Your gateway address of 192.168.0.1 seems curious.<br />Is there a NAT involved here on top of everything else?<br />As in is the OpenVPN server behind a NAT not running<br />on the router itself?&nbsp; I always run my OpenVPN server<br />directly on the router so it has port 1194 UDP on the WAN<br />port so it&#039;s a direct path.&nbsp; If you are transiting across a NAT I am<br />not really up on that I just recall back from IPSec days it REALLY<br />didn&#039;t like NAT traversal so I got in habit of avoiding it. <br />I have run OpenVPN clients on system behind NAT that<br />does seem to work fine though.</p>											<p class="post-edited">(Last edited by <strong>vincentfox</strong> on 9 Dec 2008, 00:45)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p77804">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">superman911</div>
					<div class="post-datetime">
						9 Dec 2008, 09:28					</div>
				</div>
				<div class="post-content content">
					<p>Hi there, thanks guys, sounds like you guys know what your talking about!</p><p>If possible could some one point me the the right direction with iptables, as I am clueless when it comes to Iptalbes..<br />I had a look at this link, and added the iptables rules.<br /><a href="http://ubuntuforums.org/archive/index.php/t-801207.html">http://ubuntuforums.org/archive/index.php/t-801207.html</a></p><p>But it still not working...</p><p>thanks for the Help</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p77809">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						9 Dec 2008, 10:44					</div>
				</div>
				<div class="post-content content">
					<p>Hi.</p><p>If you use 8.09rc1, you can follow this steps to open then firewall:<br /><a href="http://luci.freifunk-halle.net/UserDocs/OpenVPN#Preparethefirewall">http://luci.freifunk-halle.net/UserDocs â€¦ hefirewall</a></p><p>~ JoW</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p77833">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">vincentfox</div>
					<div class="post-datetime">
						9 Dec 2008, 17:46					</div>
				</div>
				<div class="post-content content">
					<p>You still haven&#039;t explained architecture.&nbsp; Where/what is server?&nbsp; Where/what is client?</p><p>Easy firewall hole in Kamikaze:</p><p>uci add firewall rule<br />uci set firewall.@rule[-1].src=wan<br />uci set firewall.@rule[-1].target=ACCEPT<br />uci set firewall.@rule[-1].proto=udp<br />uci set firewall.@rule[-1].dest_port=1194<br />uci commit</p><p>Or add same by edit /etc/config/firewall:</p><p>config &#039;rule&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;src&#039; &#039;wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;target&#039; &#039;ACCEPT&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;proto&#039; &#039;udp&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;dest_port&#039; &#039;1194&#039;</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>