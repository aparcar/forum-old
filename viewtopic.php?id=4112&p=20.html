<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> A qos script that really works!</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 1 Apr 2018 and 30 Apr 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 20 of 20</div><nav><ul><li><a href="viewtopic.php%3Fid=4112&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=4112&amp;p=18.html">18</a></li><li><a href="viewtopic.php%3Fid=4112&amp;p=19.html">19</a></li><li class="pagination-current"><span>20</span></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p53247">
				<div class="post-metadata">
					<div class="post-num">Post #476</div>
					<div class="post-author">loguser</div>
					<div class="post-datetime">
						1 Aug 2007, 23:57					</div>
				</div>
				<div class="post-content content">
					<p>i have problem installed 1.05 on kamikaze 7.07. i know this is listed for white russian but the error is</p><p>Nothing to be done<br />An error ocurred, return value: 1.<br />Collected errors:<br />ERROR: Cannot satisfy the following dependencies for qos-re:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;kmod-imq</p><p>I installed the list of packages you listed in the first page but it still gives this error and there is no package by kmod-imq.&nbsp; Thanks for any info.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p53267">
				<div class="post-metadata">
					<div class="post-num">Post #477</div>
					<div class="post-author">rudy</div>
					<div class="post-datetime">
						2 Aug 2007, 13:00					</div>
				</div>
				<div class="post-content content">
					<p>Unfortunately, I have not had time to check compatibility of qos-re w/ Kamikaze. At some point I will, as I plan on moving to Kamikaze myself, even though White Russian is rock solid and does not necessarily require any upgrades. Short term, I suggest you stick with White Russion for best QoS performance.</p><div class="quotebox"><cite>loguser wrote:</cite><blockquote><p>i have problem installed 1.05 on kamikaze 7.07. i know this is listed for white russian but the error is</p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p53699">
				<div class="post-metadata">
					<div class="post-num">Post #478</div>
					<div class="post-author">JayBob</div>
					<div class="post-datetime">
						10 Aug 2007, 21:41					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>loguser wrote:</cite><blockquote><p>i have problem installed 1.05 on kamikaze 7.07. i know this is listed for white russian but the error is</p><p>Nothing to be done<br />An error ocurred, return value: 1.<br />Collected errors:<br />ERROR: Cannot satisfy the following dependencies for qos-re:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;kmod-imq</p><p>I installed the list of packages you listed in the first page but it still gives this error and there is no package by kmod-imq.&nbsp; Thanks for any info.</p></blockquote></div><p>I think that this should be the package kmod-ipt-imq in kamikaze 7.07</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p54310">
				<div class="post-metadata">
					<div class="post-num">Post #479</div>
					<div class="post-author">ega2002</div>
					<div class="post-datetime">
						21 Aug 2007, 14:52					</div>
				</div>
				<div class="post-content content">
					<p>First of all, I&#039;d like o say that I&#039;m using this script in one of my OpenWrt boxes (Asus wl500gx). It has static Internet connection on its WAN interface (vlan1) and everything works fine (thanks, <strong>rudy</strong>)!.</p><p>Now I need to set it up on another box which connects to Internet through ppp. I want to maintain QoS on ppp0, but the specific situation is that ppp0 is not the WAN interface (again WAN is vlan1), and ppp connection is performed manually upon demand.</p><p>The problem is that I can&#039;t get it working. Installation of the script goes smoothly, then qos.conf is edited to specify the desired QOS_IF=ppp0, and finally the script is started by qos-start. The output of qos-stat shows that everything is up and running. &quot;Iptables -L -v -t mangle&quot; command shows that rules are created correctly. But when I look through /proc/net/ip_conntrack, I see that the connections from LAN client PCs to Internet through ppp0 interface are not properly marked according to my preferences, as it is on my first box. It shows mark=0 for all connections as if they are local.</p><p>I&#039;ve double read all this topic but have no clue. Am I missing something? Any help will be greatly appreciated.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p57031">
				<div class="post-metadata">
					<div class="post-num">Post #480</div>
					<div class="post-author">welcomb</div>
					<div class="post-datetime">
						4 Oct 2007, 18:46					</div>
				</div>
				<div class="post-content content">
					<p>Hi I&#039;m thinking of using this qos script on kamikaze 7.09. I was using the Wondershaper script on Oleg before I decided to switch to Kamikaze.</p><p>I just want to have qos over the egress (upload) and leave the ingress alone. This is because my download bandwidth is outrageously huge and seldom max out. Using a large value for the ingress seemed to throttle the download speed, no matter what large value i set. I think it&#039;s because of the overhead. That being, how to I disable ingress traffic control in this script?</p><p>Secondly, I wish to add another class which is extremely throttled (about 1KB). Then I want to filter packets to certain destination ports to this very throttled class. This is to prevent some games from playing smoothly to discourage playing. However I only want to do this during certain hours of the day. What I have before is a cron script that add and remove a tc filter. Again how do I do this with your script?</p><p>From what I&#039;ve heard, this script seems good. So I&#039;m hesitant to run a wondershaper script if I can. Thanks.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p57078">
				<div class="post-metadata">
					<div class="post-num">Post #481</div>
					<div class="post-author">durandal</div>
					<div class="post-datetime">
						5 Oct 2007, 18:16					</div>
				</div>
				<div class="post-content content">
					<p>is the pkg mirrored anywhere? having trouble getting at it</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p57087">
				<div class="post-metadata">
					<div class="post-num">Post #482</div>
					<div class="post-author">welcomb</div>
					<div class="post-datetime">
						5 Oct 2007, 21:01					</div>
				</div>
				<div class="post-content content">
					<p>Ok after reading through the scripts, I think I have the answer to my question.</p><p>Disabling ingress is just a simple setting in the config. *kicks myself for not seeing that.</p><p>I think it&#039;s safe for me to just add another class like this<br /></p><div class="codebox"><pre><code>tc class add dev $QOS_IF parent 1:1 classid 1:50 htb rate 5kbit burst $(($BURST_U*1)) cburst $(($BURST_U*1)) prio 5 mtu $MTU
tc qdisc add dev $QOS_IF parent 1:50 sfq quantum $MTU perturb 10
tc filter add dev $QOS_IF parent 1: prio 5 protocol ip handle 5 fw flowid 1:50</code></pre></div><p>Then introduce another category to mark the packets easily enough.</p><p>But now I&#039;ve got a few other questions. Since I&#039;m running Kamikaze 7.09, I can&#039;t install the package. So I&#039;ve decided to do it manually, but I&#039;m not very familiar with the filesystem. Do I just place this script in /etc/hotplug/iface/ and the &quot;config&quot; file in /etc/qos.conf ? Think I might have to write something in /etc/init.d as well yah?</p><p>Another question. Why do you create a class 1:30 but never use it?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p57272">
				<div class="post-metadata">
					<div class="post-num">Post #483</div>
					<div class="post-author">rushabht</div>
					<div class="post-datetime">
						9 Oct 2007, 22:48					</div>
				</div>
				<div class="post-content content">
					<p>Hey guys need some help here, i have been using the script but it dosent seem to be very effective with the latest tomato firmware. Currently my connection speed is 60 KBps download, and there is nothing like upload speed by my isp back here in india <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" />. My upload speeds and download speeds are the same unfortunately, which means that when im not uploading anything i get 60 KBps download speed and when im not downloading anything i get 60 KBps upload speeds. So then what values should i put in the upload and download speeds in the script and in the qos section in tomato ? Because i have tinkered around with quite a lot of different settings with the scipt to no avail. Any help here would be greatful!</p>											<p class="post-edited">(Last edited by <strong>rushabht</strong> on 10 Oct 2007, 13:25)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p57344">
				<div class="post-metadata">
					<div class="post-num">Post #484</div>
					<div class="post-author">zp1107</div>
					<div class="post-datetime">
						11 Oct 2007, 08:05					</div>
				</div>
				<div class="post-content content">
					<p>GOOD!</p><p>---------------------------<br />&#039;AyRecovery&#039;-allows your computer to restore to a previous healthy state after a system crashï¼Œ</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p57993">
				<div class="post-metadata">
					<div class="post-num">Post #485</div>
					<div class="post-author">rdmitry</div>
					<div class="post-datetime">
						24 Oct 2007, 17:45					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>welcomb wrote:</cite><blockquote><p>Hi I&#039;m thinking of using this qos script on kamikaze 7.09. I was using the Wondershaper script on Oleg before I decided to switch to Kamikaze.</p><p>I just want to have qos over the egress (upload) and leave the ingress alone. This is because my download bandwidth is outrageously huge and seldom max out. Using a large value for the ingress seemed to throttle the download speed, no matter what large value i set. I think it&#039;s because of the overhead. That being, how to I disable ingress traffic control in this script?</p><p>Secondly, I wish to add another class which is extremely throttled (about 1KB). Then I want to filter packets to certain destination ports to this very throttled class. This is to prevent some games from playing smoothly to discourage playing. However I only want to do this during certain hours of the day. What I have before is a cron script that add and remove a tc filter. Again how do I do this with your script?</p><p>From what I&#039;ve heard, this script seems good. So I&#039;m hesitant to run a wondershaper script if I can. Thanks.</p></blockquote></div><p>Hi,</p><p>I&#039;ve recently rebuilt qos-re-hfsc to include support for Kamikaze and to split hosts in qos.conf to external and internal parts (wan and lan). The only problem I found is that during boot process this script should be started manually by qos-start command. After that it starts correctly every time wan interface goes down and up.<br />you can download this script from <a href="ftp://dima-spb.dontexist.net/qos-re-hfsc_1.05_all-kamikaze-7.09.ipk">ftp://dima-spb.dontexist.net/qos-re-hfs … e-7.09.ipk</a> and the same for White Russian from <a href="ftp://dima-spb.dontexist.net/qos-re-hfsc_1.05_all.ipk">ftp://dima-spb.dontexist.net/qos-re-hfsc_1.05_all.ipk</a></p><br /><p>Hope it&#039;ll help, </p><p>Best Regards, Dmitry</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p58196">
				<div class="post-metadata">
					<div class="post-num">Post #486</div>
					<div class="post-author">welcomb</div>
					<div class="post-datetime">
						29 Oct 2007, 15:52					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>rdmitry wrote:</cite><blockquote><p>Hi,</p><p>I&#039;ve recently rebuilt qos-re-hfsc to include support for Kamikaze and to split hosts in qos.conf to external and internal parts (wan and lan). The only problem I found is that during boot process this script should be started manually by qos-start command. After that it starts correctly every time wan interface goes down and up.<br />you can download this script from <a href="ftp://dima-spb.dontexist.net/qos-re-hfsc_1.05_all-kamikaze-7.09.ipk">ftp://dima-spb.dontexist.net/qos-re-hfs … e-7.09.ipk</a> and the same for White Russian from <a href="ftp://dima-spb.dontexist.net/qos-re-hfsc_1.05_all.ipk">ftp://dima-spb.dontexist.net/qos-re-hfsc_1.05_all.ipk</a></p><br /><p>Hope it&#039;ll help, </p><p>Best Regards, Dmitry</p></blockquote></div><p>I&#039;ve actually reconfigured the script so that it works for Kamikaze. I don&#039;t think Kamikaze hotplug interface is the same as White Russian. What I did was to edit /etc/hotplug.d/iface/20-qos to restart the qos service when the wan interface goes up, as such:<br /></p><div class="codebox"><pre><code>#!/bin/sh
[ &quot;$ACTION&quot; = &quot;ifup&quot; -a &quot;#INTERFACE&quot; = &quot;wan&quot; ] &amp;&amp; /etc/init.d/qos enabled &amp;&amp; /etc/init.d/qos restart</code></pre></div><p>And to get it to initialise on boot, I created a file /etc/init.d/qos with the contents of the script, as such:<br /></p><div class="codebox"><pre><code>#!/bin/sh /etc/rc.common
START=99

# qos-script v1.05

## Please modify user configuration in /etc/qos.conf
## To start QoS without reboot, use &quot;/etc/init.d/qos restart&quot;

start () {

# User configuration
[ -f /etc/qos.conf ] &amp;&amp; . /etc/qos.conf

# If no interface defined, use WAN interface
[ &quot;$QOS_IF&quot; ] || QOS_IF=&quot;eth0&quot;

echo &quot;Starting QoS...&quot;

  # Length of burst buffers in ms (must be larger than kernel jiffy of 10ms)
  DBURST_D=10
  DBURST_U=10

...
*** Rest if the script goes on here ***
...

}

stop () {

# Deactivate QoS

iptables -t mangle -F
iptables -t mangle -X

sed -n &#039;s/ *\(.*\):.*/\1/p&#039; /proc/net/dev | while read INTERFACE; do
  tc qdisc del dev $INTERFACE root &gt;&amp;- 2&gt;&amp;-
done

ip link set imq0 down

}</code></pre></div><p>What I did was basically translate the script into a init service in Kamikaze. The start function is the main script, while the stop function is mainly the qos-stop. You have to run &quot;/etc/init.d/qos enable&quot; for the first time and it&#039;ll auto start every boot and restart every time the interface goes up. Run &quot;/etc/init.d/qos help&quot; for more information.</p><p>Unfortunately I have no idea how to package it into a nice package. Maybe you could do that for the benefit of others?</p>											<p class="post-edited">(Last edited by <strong>welcomb</strong> on 29 Oct 2007, 15:55)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p58572">
				<div class="post-metadata">
					<div class="post-num">Post #487</div>
					<div class="post-author">loguser</div>
					<div class="post-datetime">
						6 Nov 2007, 18:46					</div>
				</div>
				<div class="post-content content">
					<p>I am sometimes having problem with voip with qos-re...&nbsp; Can someone point me into guaranteeing full bandwidth for voip?&nbsp; I already set the highist priorities but from checking <a href="http://myspeed.visualware.com/voip/">http://myspeed.visualware.com/voip/</a> my jitter is always below standard quality.&nbsp; I have more than enough bandwidth to support g711u but i still get periodic broken conversations.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p58856">
				<div class="post-metadata">
					<div class="post-num">Post #488</div>
					<div class="post-author">dario</div>
					<div class="post-datetime">
						12 Nov 2007, 17:21					</div>
				</div>
				<div class="post-content content">
					<p>hello, i need help because i have a problem. I have a WRT54GL v1.1 and i installed&nbsp; openwrt-wrt54g-squashfs.bin, but now i want to install the qos package and i can&#039;t. i and trying to install the package qos-scripts_0.9.1-1_mipsel.ipk </p><p>thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p58865">
				<div class="post-metadata">
					<div class="post-num">Post #489</div>
					<div class="post-author">gimpel</div>
					<div class="post-datetime">
						12 Nov 2007, 19:15					</div>
				</div>
				<div class="post-content content">
					<p>dario,<br />it should be as easy as<br /></p><div class="codebox"><pre><code>ipkg update
ipkg install qos-scripts</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p58934">
				<div class="post-metadata">
					<div class="post-num">Post #490</div>
					<div class="post-author">dario</div>
					<div class="post-datetime">
						13 Nov 2007, 21:51					</div>
				</div>
				<div class="post-content content">
					<p>thank you gimpel !!!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p59000">
				<div class="post-metadata">
					<div class="post-num">Post #491</div>
					<div class="post-author">loguser</div>
					<div class="post-datetime">
						15 Nov 2007, 04:11					</div>
				</div>
				<div class="post-content content">
					<p>can someone tell me if they have l7 working with qos-re.&nbsp; I changed the priority to have l7 first because I noticed that the tcp/udp priority was catching everything.&nbsp; However even changing l7 first it still will not handle anything like sip,rstp,nntp, etc.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p59271">
				<div class="post-metadata">
					<div class="post-num">Post #492</div>
					<div class="post-author">johnnytaco</div>
					<div class="post-datetime">
						20 Nov 2007, 12:54					</div>
				</div>
				<div class="post-content content">
					<p>The link above <a href="ftp://dima-spb.dontexist.net/qos-re-hfsc_1.05_all-kamikaze-7.09.ipk">ftp://dima-spb.dontexist.net/qos-re-hfs … e-7.09.ipk</a> isn&#039;t working - does anyone else have a working version of Rudy&#039;s QoS scripts that work for kamikaze, or a way to make the original package work? It worked great in whiterussian, and I don&#039;t really want to change to qos-scripts now if I don&#039;t have to. That and I&#039;ve spent so much time tinkering with kamikaze, I don&#039;t want to revert back.. <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>Thanks in advance!<br />jt</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p59344">
				<div class="post-metadata">
					<div class="post-num">Post #493</div>
					<div class="post-author">gimpel</div>
					<div class="post-datetime">
						22 Nov 2007, 10:55					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>johnnytaco wrote:</cite><blockquote><p>The link above <a href="ftp://dima-spb.dontexist.net/qos-re-hfsc_1.05_all-kamikaze-7.09.ipk">ftp://dima-spb.dontexist.net/qos-re-hfs … e-7.09.ipk</a> isn&#039;t working - does anyone else have a working version of Rudy&#039;s QoS scripts that work for kamikaze, or a way to make the original package work?</p></blockquote></div><p>What&#039;s wrong with qos-scripts from the standard kamikaze repo?<br />It works just fine out-of-the-box here.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p59368">
				<div class="post-metadata">
					<div class="post-num">Post #494</div>
					<div class="post-author">johnnytaco</div>
					<div class="post-datetime">
						22 Nov 2007, 17:50					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve got that running but I&#039;ve been using Rudy&#039;s for so long, I just trust them... Would like to have the choice and test both of them.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p59382">
				<div class="post-metadata">
					<div class="post-num">Post #495</div>
					<div class="post-author">gimpel</div>
					<div class="post-datetime">
						22 Nov 2007, 21:03					</div>
				</div>
				<div class="post-content content">
					<p>Then just untar the ipk of rudy&#039;s and copy stuff over manually. Of course you need the modules etc too.</p>											<p class="post-edited">(Last edited by <strong>gimpel</strong> on 22 Nov 2007, 21:03)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p59518">
				<div class="post-metadata">
					<div class="post-num">Post #496</div>
					<div class="post-author">rdmitry</div>
					<div class="post-datetime">
						25 Nov 2007, 22:37					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>johnnytaco wrote:</cite><blockquote><p>The link above <a href="ftp://dima-spb.dontexist.net/qos-re-hfsc_1.05_all-kamikaze-7.09.ipk">ftp://dima-spb.dontexist.net/qos-re-hfs … e-7.09.ipk</a> isn&#039;t working - does anyone else have a working version of Rudy&#039;s QoS scripts that work for kamikaze, or a way to make the original package work? It worked great in whiterussian, and I don&#039;t really want to change to qos-scripts now if I don&#039;t have to. That and I&#039;ve spent so much time tinkering with kamikaze, I don&#039;t want to revert back.. <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>Thanks in advance!<br />jt</p></blockquote></div><p>There was some problems with my ftp server. I fixed them and hopefully, now and on it is working</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p59836">
				<div class="post-metadata">
					<div class="post-num">Post #497</div>
					<div class="post-author">nuno.bett</div>
					<div class="post-datetime">
						1 Dec 2007, 22:58					</div>
				</div>
				<div class="post-content content">
					<p>Hello everyone <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>I&#039;m quite new to openWrt and even more to this QOS script.</p><p>A few days ago, I updated my WL-500G to Kamikaze 7.09, but only this weekend i&#039;ve had the opportunity to try and configure QoS on it, so it can handle VOIP+P2P+regular web usage.</p><p>I tried to read as much as I could from this thread, but couldn&#039;t read it all. </p><p>Fortunately there is so much information, but i couldn&#039;t find a post with simple instructions to get this going on Kamikaze 7.09.</p><p>For what I&#039;ve read i tried to do the following:</p><p>1. ipkg -d usb install <a href="ftp://dima-spb.dontexist.net/qos-re-hfsc_1.05_all-kamikaze-7.09.ipk">ftp://dima-spb.dontexist.net/qos-re-hfs … e-7.09.ipk</a><br />&nbsp; &nbsp; -&nbsp; got the following error but i think it installed<br />&nbsp; &nbsp; Configuring qos-re-hfsc<br />&nbsp; &nbsp; postinst script returned status 1<br />&nbsp; &nbsp; ERROR: qos-re-hfsc.postinst returned 1</p><p>2. create file 20-qos under /etc/hotplug.d/iface with code<br />#!/bin/sh<br />[ &quot;$ACTION&quot; = &quot;ifup&quot; -a &quot;#INTERFACE&quot; = &quot;wan&quot; ] &amp;&amp; /etc/init.d/qos enabled &amp;&amp; /etc/init.d/qos restart</p><p>3. create file qos under /etd/init.d with those changes mentioned by welcomb on 2007-10-29 14:52:55 but can&#039;t remember which file content i put in ...<br />*** Rest if the script goes on here ***<br />...</p><p>Nevertheless, when i try to run /etc/init.d/qos start I get (i tried to make sure that i had all packages installed):<br />Starting QoS...<br />SIOCGIFFLAGS: No such device<br />sh: 0: unknown operand<br />sh: 0: unknown operand<br />iptables v1.3.7: Unknown arg `--todev&#039;<br />Try `iptables -h&#039; or &#039;iptables --help&#039; for more information.<br />iptables v1.3.7: Unknown arg `--todev&#039;<br />Try `iptables -h&#039; or &#039;iptables --help&#039; for more information.<br />iptables v1.3.7: Unknown arg `--restore-mark&#039;<br />Try `iptables -h&#039; or &#039;iptables --help&#039; for more information.<br />iptables v1.3.7: Unknown arg `--save-mark&#039;<br />Try `iptables -h&#039; or &#039;iptables --help&#039; for more information.<br />iptables v1.3.7: Couldn&#039;t load match `length&#039;:File not found</p><p>Try `iptables -h&#039; or &#039;iptables --help&#039; for more information.</p><p>So i would kindly ask if someone can write in a few lines, which packages i should install and which content should the following files have: <br />/etc/init.d/qos<br />/etc/hotplug.d/iface/20-qos<br />/etc/qos.conf</p><p>because all these files have been changing allong the whole thread and I don&#039;t know where I can find a final example without having to make all those changes...</p><p>p.s. at the moment I don&#039;t have any /etc/qos.conf (should I need one?) and my installation procedure might not make any sense... but after 20 pages I&#039;m completely confused.</p><p>Thanks, </p><p>Nuno Bettencourt</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p59997">
				<div class="post-metadata">
					<div class="post-num">Post #498</div>
					<div class="post-author">nuno.bett</div>
					<div class="post-datetime">
						5 Dec 2007, 15:26					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nuno.bett wrote:</cite><blockquote><p>Hello everyone <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>I&#039;m quite new to openWrt and even more to this QOS script.</p><p>A few days ago, I updated my WL-500G to Kamikaze 7.09, but only this weekend i&#039;ve had the opportunity to try and configure QoS on it, so it can handle VOIP+P2P+regular web usage.</p><p>I tried to read as much as I could from this thread, but couldn&#039;t read it all. </p><p>Fortunately there is so much information, but i couldn&#039;t find a post with simple instructions to get this going on Kamikaze 7.09.</p><p>For what I&#039;ve read i tried to do the following:</p><p>1. ipkg -d usb install <a href="ftp://dima-spb.dontexist.net/qos-re-hfsc_1.05_all-kamikaze-7.09.ipk">ftp://dima-spb.dontexist.net/qos-re-hfs … e-7.09.ipk</a><br />&nbsp; &nbsp; -&nbsp; got the following error but i think it installed<br />&nbsp; &nbsp; Configuring qos-re-hfsc<br />&nbsp; &nbsp; postinst script returned status 1<br />&nbsp; &nbsp; ERROR: qos-re-hfsc.postinst returned 1</p><p>2. create file 20-qos under /etc/hotplug.d/iface with code<br />#!/bin/sh<br />[ &quot;$ACTION&quot; = &quot;ifup&quot; -a &quot;#INTERFACE&quot; = &quot;wan&quot; ] &amp;&amp; /etc/init.d/qos enabled &amp;&amp; /etc/init.d/qos restart</p><p>3. create file qos under /etd/init.d with those changes mentioned by welcomb on 2007-10-29 14:52:55 but can&#039;t remember which file content i put in ...<br />*** Rest if the script goes on here ***<br />...</p><p>Nevertheless, when i try to run /etc/init.d/qos start I get (i tried to make sure that i had all packages installed):<br />Starting QoS...<br />SIOCGIFFLAGS: No such device<br />sh: 0: unknown operand<br />sh: 0: unknown operand<br />iptables v1.3.7: Unknown arg `--todev&#039;<br />Try `iptables -h&#039; or &#039;iptables --help&#039; for more information.<br />iptables v1.3.7: Unknown arg `--todev&#039;<br />Try `iptables -h&#039; or &#039;iptables --help&#039; for more information.<br />iptables v1.3.7: Unknown arg `--restore-mark&#039;<br />Try `iptables -h&#039; or &#039;iptables --help&#039; for more information.<br />iptables v1.3.7: Unknown arg `--save-mark&#039;<br />Try `iptables -h&#039; or &#039;iptables --help&#039; for more information.<br />iptables v1.3.7: Couldn&#039;t load match `length&#039;:File not found</p><p>Try `iptables -h&#039; or &#039;iptables --help&#039; for more information.</p><p>So i would kindly ask if someone can write in a few lines, which packages i should install and which content should the following files have: <br />/etc/init.d/qos<br />/etc/hotplug.d/iface/20-qos<br />/etc/qos.conf</p><p>because all these files have been changing allong the whole thread and I don&#039;t know where I can find a final example without having to make all those changes...</p><p>p.s. at the moment I don&#039;t have any /etc/qos.conf (should I need one?) and my installation procedure might not make any sense... but after 20 pages I&#039;m completely confused.</p><p>Thanks, </p><p>Nuno Bettencourt</p></blockquote></div><p>hello again <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>forget everything I said before... I managed to set up this qos-scritps. Seems like the problem was that I installed the ipkg on another destination rather than root and nothing seemed to work. After installing qos-scripts package from <a href="ftp://dima-spb.dontexist.net/qos-re-hfsc_1.05_all-kamikaze-7.09.ipk">ftp://dima-spb.dontexist.net/qos-re-hfs … e-7.09.ipk</a> to root, almost everything got to work, my ingress status is not working...</p><br /><p>INGRESS STATUS<br />Cannot find device &quot;imq0&quot;</p><p>My router is a WL-500g and I still had a bridge between lan and WIFI, which i have already split. I have iptables-mod-imq - 1.3.7-1 and kmod-ipt-imq - 2.4.34-brcm-1 modules installed but insmod for imq keeps failing. Any ideas why I can&#039;t have my Intermediate Queuing Device up &amp; running?</p>											<p class="post-edited">(Last edited by <strong>nuno.bett</strong> on 5 Dec 2007, 15:26)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p60375">
				<div class="post-metadata">
					<div class="post-num">Post #499</div>
					<div class="post-author">adr</div>
					<div class="post-datetime">
						13 Dec 2007, 15:37					</div>
				</div>
				<div class="post-content content">
					<p>Has anyone encountered weird &quot;pauses&quot; in their net connection with this script? I tried installing it yesterday, and while it seems to work very well, I now get frequent periods where all inbound/outbound internet traffic seems to stop for roughly 30-40 seconds, then it starts working normally again. What can be causing this? It&#039;s extremely annoying when it happens while I&#039;m playing a game <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p60511">
				<div class="post-metadata">
					<div class="post-num">Post #500</div>
					<div class="post-author">dario</div>
					<div class="post-datetime">
						16 Dec 2007, 20:40					</div>
				</div>
				<div class="post-content content">
					<p>hello,</p><p>I have installed the qos package in my linksys, i would like to get some help because i don&#039;t know how to modificate this package, so could you please tell me if there is any command by console? or Do I have to open the package in linux, change the code and re install it again? </p><p>please help me, thanks</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 20 of 20</div><nav><ul><li><a href="viewtopic.php%3Fid=4112&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=4112&amp;p=18.html">18</a></li><li><a href="viewtopic.php%3Fid=4112&amp;p=19.html">19</a></li><li class="pagination-current"><span>20</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0.001 -->

</body>
</html>