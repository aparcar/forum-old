<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> sam&#039;s firmware collections for TP-Link WR703N</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 6 Feb 2018 and 1 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 2 of 12</div><nav><ul><li><a href="viewtopic.php%3Fid=33387&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li><li><a href="viewtopic.php%3Fid=33387&amp;p=3.html">3</a></li><li><a href="viewtopic.php%3Fid=33387&amp;p=4.html">4</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=33387&amp;p=12.html">12</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p150967">
				<div class="post-metadata">
					<div class="post-num">Post #26</div>
					<div class="post-author">s7mx1</div>
					<div class="post-datetime">
						12 Dec 2011, 13:48					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Lennong wrote:</cite><blockquote><p>I&#039;ve finally got some time for testing your config. It should be doable to rip out OpenVPN and throw in PPP instead. When you say downgrade the mac80211 package, how do I do that?</p></blockquote></div><p>In the current root directory of your openwrt do<br /></p><div class="codebox"><pre><code>svn update -r 28294 package/mac80211</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150969">
				<div class="post-metadata">
					<div class="post-num">Post #27</div>
					<div class="post-author">Lennong</div>
					<div class="post-datetime">
						12 Dec 2011, 14:14					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>s7mx1 wrote:</cite><blockquote><div class="quotebox"><cite>Lennong wrote:</cite><blockquote><p>I&#039;ve finally got some time for testing your config. It should be doable to rip out OpenVPN and throw in PPP instead. When you say downgrade the mac80211 package, how do I do that?</p></blockquote></div><p>In the current root directory of your openwrt do<br /></p><div class="codebox"><pre><code>svn update -r 28294 package/mac80211</code></pre></div></blockquote></div><p>Sweet! Thanks! I assume that applying the patches is simply run &quot;patch -p00.wr703n.patch&quot; from your pulled down openwrt-nas directory?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150970">
				<div class="post-metadata">
					<div class="post-num">Post #28</div>
					<div class="post-author">s7mx1</div>
					<div class="post-datetime">
						12 Dec 2011, 14:18					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Generalenthu wrote:</cite><blockquote><p>Really nice to see you dotting the i&#039;s and crossing the t&#039;s. I ordered my unit mid last week and is yet to be shipped. On a related note, is there enough flash memory to include mpd in the firmware. All my music is on a nas which could be mounted on boot along with a remote mpd database. This may be impractical though.</p><p>To me the obvious alternative is to just run pulseaudio making it discoverable. I guess it could be connected to mpd running elsewhere. Anyways, I am a linux n00b; pardon me if it sounds ignorant.</p><p>I am planning to use a USB soundcard plugged into wr703n and connect it to aux in an ipod dock. Ideally would like to be able to draw power for wr703n from ipod male connector, but am not finding suitable cables.</p><p>Anyways, this setup should give Sonos a serious run for its money!</p></blockquote></div><p>@Generalenthu </p><p>Unfortunately there is no space left for me to squeeze mpd inside unless you don&#039;t want the web gui <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" />. This can be done but it involves building openwrt from source code.</p><p>You have other options apart from squeezing mpd inside WR703N:<br />1) get/build a mpd with pulseaudio support for your nas. This is probably the best solution if you can get it done.<br />2) get another WR703N and install mpd on it with nfs/cifs support so you can mount your music collection. Only if you know how to build openwrt from source and patch things if necessary. This the next cheapest solution and the running electricity bill is among the lowest.<br />3) get raspi when its out next year and install mpd on it and mount your music collection via nfs/cifs. However you need to wait till at least January next year. It costs $13 more than WR703N. <br />4) Any x86 machines with mpd running on it. Probably the easiest to set up but consumes too much electricity and not good if you want to run 24/7.</p><p>We can probably live without auto discovery (takes precious space) as I have setup the dhcp host name and you can use name like openwrt-pulseaudio instead of ip address to access WR703N.</p><p>Not sure about the ipod dock as I have never used any apple&#039;s products. In theory you can mod a cable for that purpose.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150971">
				<div class="post-metadata">
					<div class="post-num">Post #29</div>
					<div class="post-author">s7mx1</div>
					<div class="post-datetime">
						12 Dec 2011, 14:19					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Lennong wrote:</cite><blockquote><div class="quotebox"><cite>s7mx1 wrote:</cite><blockquote><div class="quotebox"><cite>Lennong wrote:</cite><blockquote><p>I&#039;ve finally got some time for testing your config. It should be doable to rip out OpenVPN and throw in PPP instead. When you say downgrade the mac80211 package, how do I do that?</p></blockquote></div><p>In the current root directory of your openwrt do<br /></p><div class="codebox"><pre><code>svn update -r 28294 package/mac80211</code></pre></div></blockquote></div><p>Sweet! Thanks! I assume that applying the patches is simply run &quot;patch -p00.wr703n.patch&quot; from your pulled down openwrt-nas directory?</p></blockquote></div><p>patchs can be done that way (assume you copied them over to the root folder of openwrt first)<br /></p><div class="codebox"><pre><code>for file in 00*.patch ; do 
patch -p0 &lt; $file
done</code></pre></div><p>You can refer to the wiki page here <a href="http://code.google.com/p/xbox-remote/wiki/WR841NDV5Firmware">http://code.google.com/p/xbox-remote/wi … V5Firmware</a>. Not exactly the same but you should provide some good information.</p>											<p class="post-edited">(Last edited by <strong>s7mx1</strong> on 12 Dec 2011, 14:23)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150972">
				<div class="post-metadata">
					<div class="post-num">Post #30</div>
					<div class="post-author">Lennong</div>
					<div class="post-datetime">
						12 Dec 2011, 14:21					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>s7mx1 wrote:</cite><blockquote><div class="quotebox"><cite>Lennong wrote:</cite><blockquote><div class="quotebox"><cite>s7mx1 wrote:</cite><blockquote><p>In the current root directory of your openwrt do<br /></p><div class="codebox"><pre><code>svn update -r 28294 package/mac80211</code></pre></div></blockquote></div><p>Sweet! Thanks! I assume that applying the patches is simply run &quot;patch -p00.wr703n.patch&quot; from your pulled down openwrt-nas directory?</p></blockquote></div><p>patchs can be done that way (assume you copied them over to the root folder of openwrt first)<br /></p><div class="codebox"><pre><code>for file in 00*.patch ; do 
patch -p0 &lt; $file
done</code></pre></div></blockquote></div><p>Excellent! Thanks! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150973">
				<div class="post-metadata">
					<div class="post-num">Post #31</div>
					<div class="post-author">s7mx1</div>
					<div class="post-datetime">
						12 Dec 2011, 14:24					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Lennong wrote:</cite><blockquote><div class="quotebox"><cite>s7mx1 wrote:</cite><blockquote><div class="quotebox"><cite>Lennong wrote:</cite><blockquote><p>Sweet! Thanks! I assume that applying the patches is simply run &quot;patch -p00.wr703n.patch&quot; from your pulled down openwrt-nas directory?</p></blockquote></div><p>patchs can be done that way (assume you copied them over to the root folder of openwrt first)<br /></p><div class="codebox"><pre><code>for file in 00*.patch ; do 
patch -p0 &lt; $file
done</code></pre></div></blockquote></div><p>Excellent! Thanks! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></blockquote></div><p>Just updated the last post regarding a wiki reference. Hope it will help.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p151001">
				<div class="post-metadata">
					<div class="post-num">Post #32</div>
					<div class="post-author">Generalenthu</div>
					<div class="post-datetime">
						12 Dec 2011, 20:22					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>s7mx1 wrote:</cite><blockquote><p>@Generalenthu </p><p>Unfortunately there is no space left for me to squeeze mpd inside unless you don&#039;t want the web gui <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" />. This can be done but it involves building openwrt from source code.</p><p>You have other options apart from squeezing mpd inside WR703N:<br />1) get/build a mpd with pulseaudio support for your nas. This is probably the best solution if you can get it done.<br />2) get another WR703N and install mpd on it with nfs/cifs support so you can mount your music collection. Only if you know how to build openwrt from source and patch things if necessary. This the next cheapest solution and the running electricity bill is among the lowest.<br />3) get raspi when its out next year and install mpd on it and mount your music collection via nfs/cifs. However you need to wait till at least January next year. It costs $13 more than WR703N. <br />4) Any x86 machines with mpd running on it. Probably the easiest to set up but consumes too much electricity and not good if you want to run 24/7.</p><p>We can probably live without auto discovery (takes precious space) as I have setup the dhcp host name and you can use name like openwrt-pulseaudio instead of ip address to access WR703N.</p><p>Not sure about the ipod dock as I have never used any apple&#039;s products. In theory you can mod a cable for that purpose.</p></blockquote></div><p>I am now setup like #4 with an old laptop and hate it. </p><p>I am pretty much assuming your pulseaudio firmware supports wifi. Tell me if I am way off base there. I don’t have a lot of confidence on the WR703N wifi chipset and have a feeling pulseaudio streaming would be glitchy as I have a weak signal where I need the speakers. Also there is the issue of network saturation with raw audio streaming.</p><p>So it looks like a choice between mpd + alsa (if it is small enough) where it would be a stand alone wifi player _or_ a pulseaudio player with probably choppy music, but networked and in sync with my main wired speakers.&nbsp; </p><p>Am a little worried about tinkering with my nas (raid) as it is my main repository for all the important docs and backups. </p><p>The other alternative is running mpd + pulseaudio on 2 Raspberries pi, one replacing my current x86 setup and another with wifi card and remote speakers. So raspi vs WR703N, raspi is more expensive by $13 +&nbsp; wificard, but looks like it will give me the ability to switch between standalone mode and synchronized mode. I am raring to try pulseaudio on WR703N first in any case.</p><p>Finally my speaker cabling and WR703N powering plan is best expained by this product. Not splurging 30 bucks for a cable though.</p><p><a href="http://www.cablejive.com/products/dockBossplus.html">http://www.cablejive.com/products/dockBossplus.html</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p151019">
				<div class="post-metadata">
					<div class="post-num">Post #33</div>
					<div class="post-author">s7mx1</div>
					<div class="post-datetime">
						12 Dec 2011, 22:17					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Generalenthu wrote:</cite><blockquote><p>I am now setup like #4 with an old laptop and hate it. </p><p>I am pretty much assuming your pulseaudio firmware supports wifi. Tell me if I am way off base there. I don’t have a lot of confidence on the WR703N wifi chipset and have a feeling pulseaudio streaming would be glitchy as I have a weak signal where I need the speakers. Also there is the issue of network saturation with raw audio streaming.</p><p>So it looks like a choice between mpd + alsa (if it is small enough) where it would be a stand alone wifi player _or_ a pulseaudio player with probably choppy music, but networked and in sync with my main wired speakers.&nbsp; </p><p>Am a little worried about tinkering with my nas (raid) as it is my main repository for all the important docs and backups. </p><p>The other alternative is running mpd + pulseaudio on 2 Raspberries pi, one replacing my current x86 setup and another with wifi card and remote speakers. So raspi vs WR703N, raspi is more expensive by $13 +&nbsp; wificard, but looks like it will give me the ability to switch between standalone mode and synchronized mode. I am raring to try pulseaudio on WR703N first in any case.</p><p>Finally my speaker cabling and WR703N powering plan is best expained by this product. Not splurging 30 bucks for a cable though.</p><p><a href="http://www.cablejive.com/products/dockBossplus.html">http://www.cablejive.com/products/dockBossplus.html</a></p></blockquote></div><p>The main application of the pulseaudio firmware will be streaming over wifi otherwise what&#039;s the fun <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /> </p><p>The wifi chip inside WR703N is quite good and it&#039;s only being let down by the wifi antenna printed on the PCB. You need to adjust the position of WR703N to get the best reception. If you have some old wifi router lying around you can rip the antenna and solder it on WR703N which should give a boot to the wifi performance. I have seen other people installed SMA&nbsp; (detachable) antenna on WR703N. </p><p>If you have a weak wifi coverage I would suggest investing a bit on the external wifi antenna on either WR703N or the usb wifi dongle that goes with pi. I believe you should expect similar wifi performance between WR703N and any usb wifi dongle without external antenna. If that doesn&#039;t help you can always get a wifi range extender or even powerline.</p><p>Streaming raw stereo audio actually does not require a lot bandwidth. It will need around 180KB/s for stereo 48KHz raw audio streaming ( airplay or pulseaudio). What&#039;s more important is latency. The playback may become choppy when you have latency pikes on your wifi network.</p><p>With a strong wifi network I can get constant smooth streaming playback out of the usb speakers attached to WR703N. When watching TV shows I don&#039;t notice any out of sync between video and audio which is remarkable (the audio is being streamed from another wifi client on the same network).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p151037">
				<div class="post-metadata">
					<div class="post-num">Post #34</div>
					<div class="post-author">maurer</div>
					<div class="post-datetime">
						13 Dec 2011, 07:43					</div>
				</div>
				<div class="post-content content">
					<p>@Generalenthu - where can you buy raspberry pi?<br />703n is already here <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p151038">
				<div class="post-metadata">
					<div class="post-num">Post #35</div>
					<div class="post-author">umggc</div>
					<div class="post-datetime">
						13 Dec 2011, 07:48					</div>
				</div>
				<div class="post-content content">
					<p>Hello. Sorry if I missed the information somewhere. Is it true that the nas build can only function as AP? If so, would it be possible to trade the openvpn module for a router/gateway? <br />Thanks.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p151039">
				<div class="post-metadata">
					<div class="post-num">Post #36</div>
					<div class="post-author">Generalenthu</div>
					<div class="post-datetime">
						13 Dec 2011, 07:56					</div>
				</div>
				<div class="post-content content">
					<p>@s7mx1</p><p>Nice release. The re-sampling discussion and the relay usage was cool. Looks like My 703n is not shipped yet. Damn you volumerates.</p><div class="quotebox"><cite>maurer wrote:</cite><blockquote><p>@Generalenthu - where can you buy raspberry pi?<br />703n is already here <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></blockquote></div><p>@maurer<br />True. Its become Ras-Pie-in-the-sky</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p151045">
				<div class="post-metadata">
					<div class="post-num">Post #37</div>
					<div class="post-author">Lennong</div>
					<div class="post-datetime">
						13 Dec 2011, 10:37					</div>
				</div>
				<div class="post-content content">
					<p>The pulseaudio looks really nice! Dang, I can&#039;t even reproduce your NAS build even with patches and .config from you. I get tons of errors or builds that miss packages, very strange. Still, nice builds and fun to try out. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p151073">
				<div class="post-metadata">
					<div class="post-num">Post #38</div>
					<div class="post-author">s7mx1</div>
					<div class="post-datetime">
						13 Dec 2011, 17:27					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>umggc wrote:</cite><blockquote><p>Hello. Sorry if I missed the information somewhere. Is it true that the nas build can only function as AP? If so, would it be possible to trade the openvpn module for a router/gateway? <br />Thanks.</p></blockquote></div><p>@umggc<br />What exactly do you want to achieve with router/gateway?</p><p>The current nas firmware will use the ethernet port on WR730N as the wan port and any wifi clients can access internet via the wan port if it&#039;s connected upstream (i.e. connected to your home gateway).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p151075">
				<div class="post-metadata">
					<div class="post-num">Post #39</div>
					<div class="post-author">s7mx1</div>
					<div class="post-datetime">
						13 Dec 2011, 17:31					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Lennong wrote:</cite><blockquote><p>The pulseaudio looks really nice! Dang, I can&#039;t even reproduce your NAS build even with patches and .config from you. I get tons of errors or builds that miss packages, very strange. Still, nice builds and fun to try out. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></blockquote></div><p>@Lennong<br />If all patches are applied fine. You should clean the openwrt root directory by<br /></p><div class="codebox"><pre><code>make -j2 clean</code></pre></div><p>then build it again by<br /></p><div class="codebox"><pre><code>make -j2</code></pre></div><p>If you encountered any errors then compile it in verbose mode<br /></p><div class="codebox"><pre><code>make V=99</code></pre></div><p>and post the output to pastebin and send me the link.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p151109">
				<div class="post-metadata">
					<div class="post-num">Post #40</div>
					<div class="post-author">s7mx1</div>
					<div class="post-datetime">
						14 Dec 2011, 00:19					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>s7mx1 wrote:</cite><blockquote><div class="quotebox"><cite>umggc wrote:</cite><blockquote><p>Hello. Sorry if I missed the information somewhere. Is it true that the nas build can only function as AP? If so, would it be possible to trade the openvpn module for a router/gateway? <br />Thanks.</p></blockquote></div><p>@umggc<br />What exactly do you want to achieve with router/gateway?</p><p>The current nas firmware will use the ethernet port on WR730N as the wan port and any wifi clients can access internet via the wan port if it&#039;s connected upstream (i.e. connected to your home gateway).</p></blockquote></div><p>@umggc</p><p>Just noticed that the firewall script does not have execution permission. I will fix it in the next release. Meanwhile you can fix it by running the following command<br /></p><div class="codebox"><pre><code>chmod +x /etc/init.d/firewall
/etc/init.d/firewall start</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p151114">
				<div class="post-metadata">
					<div class="post-num">Post #41</div>
					<div class="post-author">Lennong</div>
					<div class="post-datetime">
						14 Dec 2011, 03:44					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>s7mx1 wrote:</cite><blockquote><div class="quotebox"><cite>Lennong wrote:</cite><blockquote><p>The pulseaudio looks really nice! Dang, I can&#039;t even reproduce your NAS build even with patches and .config from you. I get tons of errors or builds that miss packages, very strange. Still, nice builds and fun to try out. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></blockquote></div><p>@Lennong<br />If all patches are applied fine. You should clean the openwrt root directory by<br /></p><div class="codebox"><pre><code>make -j2 clean</code></pre></div><p>then build it again by<br /></p><div class="codebox"><pre><code>make -j2</code></pre></div><p>If you encountered any errors then compile it in verbose mode<br /></p><div class="codebox"><pre><code>make V=99</code></pre></div><p>and post the output to pastebin and send me the link.</p></blockquote></div><p>Output from patching:<br /><a href="http://pastebin.com/7QEhV4iK">http://pastebin.com/7QEhV4iK</a></p><p>Output from build:<br /><a href="http://pastebin.com/FQiT81ps">http://pastebin.com/FQiT81ps</a></p><p>First build I did resulted in a image that was bootable but with a few packages and functions missing..could not change password and not login via SSH. Second build as shown in pastebin went through in web UI for upgrade, but resulted in a non-reachable router. It boots and goes via flashing state to steady light, so I assume it gets through uboot properly. Will solder the UART today anyway and see whats going on.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p151121">
				<div class="post-metadata">
					<div class="post-num">Post #42</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						14 Dec 2011, 06:32					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>s7mx1 wrote:</cite><blockquote><p>Unfortunately there is no space left for me to squeeze mpd inside unless you don&#039;t want the web gui <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" />. This can be done but it involves building openwrt from source code.</p></blockquote></div><p>I&#039;ve heard that the U-Boot (128 Kbytes) within TP-LINK routers only supports <strong>gzip</strong> compression. That&#039;s why the size of kernel is much bigger than the <strong>lzma</strong> compressed one. If you want to squeeze 300-400 Kbytes from kernel, you can copy the source code of lzma compression routine from Linksys/D-Link GPL code and merge it with TP-LINK&#039;s code and compile U-Boot. There&#039;s a great chance that you can still keep U-Boot within 128 KBytes. The next step is to adjust the mtd partitions in OpenWrt and there you have at least extra 300 KBytes for the application.</p><p>Good luck.</p><p><a href="http://www.tplink.com/en/support/GPL/">GPL Code Center - Welcome to TP-LINK</a> - TL-MR3020v1 or TL-WR740Nv4</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p151150">
				<div class="post-metadata">
					<div class="post-num">Post #43</div>
					<div class="post-author">s7mx1</div>
					<div class="post-datetime">
						14 Dec 2011, 15:15					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Lennong wrote:</cite><blockquote><div class="quotebox"><cite>s7mx1 wrote:</cite><blockquote><div class="quotebox"><cite>Lennong wrote:</cite><blockquote><p>The pulseaudio looks really nice! Dang, I can&#039;t even reproduce your NAS build even with patches and .config from you. I get tons of errors or builds that miss packages, very strange. Still, nice builds and fun to try out. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></blockquote></div><p>@Lennong<br />If all patches are applied fine. You should clean the openwrt root directory by<br /></p><div class="codebox"><pre><code>make -j2 clean</code></pre></div><p>then build it again by<br /></p><div class="codebox"><pre><code>make -j2</code></pre></div><p>If you encountered any errors then compile it in verbose mode<br /></p><div class="codebox"><pre><code>make V=99</code></pre></div><p>and post the output to pastebin and send me the link.</p></blockquote></div><p>Output from patching:<br /><a href="http://pastebin.com/7QEhV4iK">http://pastebin.com/7QEhV4iK</a></p><p>Output from build:<br /><a href="http://pastebin.com/FQiT81ps">http://pastebin.com/FQiT81ps</a></p><p>First build I did resulted in a image that was bootable but with a few packages and functions missing..could not change password and not login via SSH. Second build as shown in pastebin went through in web UI for upgrade, but resulted in a non-reachable router. It boots and goes via flashing state to steady light, so I assume it gets through uboot properly. Will solder the UART today anyway and see whats going on.</p></blockquote></div><p>@Lennong</p><p>I did mention that my patches have only been&nbsp; tested for revision 28854. I would suggest start from fresh. To check out revision 28854 of openwrt do<br /></p><div class="codebox"><pre><code>svn co -r 28854 svn://svn.openwrt.org/openwrt/trunk openwrt-trunk
cd openwrt-trunk
./scripts/feeds update -a
./scripts/feeds install -a
svn update -r 28294 package/mac80211
svn update -r 28602 feeds/packages
svn update -r 4986 feeds/xwrt
svn co https://xbox-remote.googlecode.com/svn/trunk/embeded-system/openwrt/nas/trunk-28854 trunk-28854
cp trunk-28854/config-nas .config
for file in trunk-28854/patches/00.*.patch ; do patch -p0 &lt; $file ; done
grep /etc/init.d/ trunk-28854/patches/00*.patch | grep Index | awk &#039;{print $2}&#039; | xargs chmod +x
grep &quot;\.sh&quot; trunk-28854/patches/00.*.patch | grep Index | awk &#039;{print $2}&#039; | xargs chmod +x
make -j2</code></pre></div><p>which should sort everything out for you. Please make sure the image produced by the above build works fine for you before carry on your own modifications.</p>											<p class="post-edited">(Last edited by <strong>s7mx1</strong> on 14 Dec 2011, 15:23)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p151151">
				<div class="post-metadata">
					<div class="post-num">Post #44</div>
					<div class="post-author">s7mx1</div>
					<div class="post-datetime">
						14 Dec 2011, 15:19					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>fyi wrote:</cite><blockquote><div class="quotebox"><cite>s7mx1 wrote:</cite><blockquote><p>Unfortunately there is no space left for me to squeeze mpd inside unless you don&#039;t want the web gui <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" />. This can be done but it involves building openwrt from source code.</p></blockquote></div><p>I&#039;ve heard that the U-Boot (128 Kbytes) within TP-LINK routers only supports <strong>gzip</strong> compression. That&#039;s why the size of kernel is much bigger than the <strong>lzma</strong> compressed one. If you want to squeeze 300-400 Kbytes from kernel, you can copy the source code of lzma compression routine from Linksys/D-Link GPL code and merge it with TP-LINK&#039;s code and compile U-Boot. There&#039;s a great chance that you can still keep U-Boot within 128 KBytes. The next step is to adjust the mtd partitions in OpenWrt and there you have at least extra 300 KBytes for the application.</p><p>Good luck.</p><p><a href="http://www.tplink.com/en/support/GPL/">GPL Code Center - Welcome to TP-LINK</a> - TL-MR3020v1 or TL-WR740Nv4</p></blockquote></div><p>I would rather remove gui in order to gain more than 1MB space which is less risky. There are other options available like usb disk or network file system to dramatically increase the available disk space.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p151247">
				<div class="post-metadata">
					<div class="post-num">Post #45</div>
					<div class="post-author">umggc</div>
					<div class="post-datetime">
						15 Dec 2011, 14:51					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>s7mx1 wrote:</cite><blockquote><div class="quotebox"><cite>umggc wrote:</cite><blockquote><p>Hello. Sorry if I missed the information somewhere. Is it true that the nas build can only function as AP? If so, would it be possible to trade the openvpn module for a router/gateway? <br />Thanks.</p></blockquote></div><p>@umggc<br />What exactly do you want to achieve with router/gateway?</p><p>The current nas firmware will use the ethernet port on WR730N as the wan port and any wifi clients can access internet via the wan port if it&#039;s connected upstream (i.e. connected to your home gateway).</p></blockquote></div><p>@s7mx1,</p><p>I guess I misunderstood your description of the build. I thought it was stripped off stuff like DHCP server and can only be used as purely an AP in conjunction with another router/gateway (inferred from your photo). </p><p>Thanks for the good work!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p151249">
				<div class="post-metadata">
					<div class="post-num">Post #46</div>
					<div class="post-author">s7mx1</div>
					<div class="post-datetime">
						15 Dec 2011, 14:59					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>umggc wrote:</cite><blockquote><div class="quotebox"><cite>s7mx1 wrote:</cite><blockquote><div class="quotebox"><cite>umggc wrote:</cite><blockquote><p>Hello. Sorry if I missed the information somewhere. Is it true that the nas build can only function as AP? If so, would it be possible to trade the openvpn module for a router/gateway? <br />Thanks.</p></blockquote></div><p>@umggc<br />What exactly do you want to achieve with router/gateway?</p><p>The current nas firmware will use the ethernet port on WR730N as the wan port and any wifi clients can access internet via the wan port if it&#039;s connected upstream (i.e. connected to your home gateway).</p></blockquote></div><p>@s7mx1,</p><p>I guess I misunderstood your description of the build. I thought it was stripped off stuff like DHCP server and can only be used as purely an AP in conjunction with another router/gateway (inferred from your photo). </p><p>Thanks for the good work!</p></blockquote></div><p>DHCP and iptables are critical parts and I will never remove them <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />. I am working on a more easy network setup via web gui so you don&#039;t have to mess around with various configuration files which is prone to problems by un-experienced openwrt users. In fact this is probably the no.1 reason for unreachable WR703N.</p><p>I will try to release them this weekends. Stay tuned.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p151627">
				<div class="post-metadata">
					<div class="post-num">Post #47</div>
					<div class="post-author">tosslee</div>
					<div class="post-datetime">
						20 Dec 2011, 17:30					</div>
				</div>
				<div class="post-content content">
					<p>@s7mx1<br />I flashed your PulseAudio firmware on 703n,but I have some problems.<br />When I pulg my Logitech sound card,the 703n cannot identify my sound card.<br />On your firmware I cannot find /dev/dsp and /dev/audio.<br />But on another trunk firmware after I okpg install kmod-usb-audio I can find that,and the madplay also can play mp3 file. <br />here is my error message.Could you help me with that?</p><p>root@OpenWrt-PulseAudio:~# pulseaudio -vv<br />W: [pulseaudio] main.c: This program is not intended to be run as root (unless --system is specified).<br />D: [pulseaudio] core-rtclock.c: Timer slack is set to 50 us.<br />D: [pulseaudio] core-util.c: setpriority() worked.<br />I: [pulseaudio] core-util.c: Successfully gained nice level -11.<br />I: [pulseaudio] main.c: This is PulseAudio 1.1<br />D: [pulseaudio] main.c: Compilation host: mips-openwrt-linux-gnu<br />D: [pulseaudio] main.c: Compilation CFLAGS: -Os -pipe -mips32r2 -mtune=mips32r2 -fno-caller-saves -fhonour-copts -msoft-float -I/media/HardDisk3/openwrt-trunk-staging-pulseaudio/staging_dir/target-mips_r2_uClibc-0.9.32/usr/lib/libiconv-stub/include -I/media/HardDisk3/openwrt-trunk-staging-pulseaudio/staging_dir/target-mips_r2_uClibc-0.9.32/usr/lib/libintl-stub/include -std=gnu99&nbsp; -Wall -W -Wextra -Wno-long-long -Wvla -Wno-overlength-strings -Wunsafe-loop-optimizations -Wundef -Wformat=2 -Wlogical-op -Wsign-compare -Wformat-security -Wmissing-include-dirs -Wformat-nonliteral -Wpointer-arith -Winit-self -Wdeclaration-after-statement -Wfloat-equal -Wmissing-prototypes -Wredundant-decls -Wmissing-declarations -Wmissing-noreturn -Wshadow -Wendif-labels -Wcast-align -Wstrict-aliasing -Wwrite-strings -Wno-unused-parameter -ffast-math -Wp,-D_FORTIFY_SOURCE=2 -fno-common -fdiagnostics-show-option<br />D: [pulseaudio] main.c: Running on host: Linux mips 2.6.39.4 #34 Mon Dec 12 15:04:51 GMT 2011<br />D: [pulseaudio] main.c: Found 1 CPUs.<br />I: [pulseaudio] main.c: Page size is 4096 bytes<br />D: [pulseaudio] main.c: Compiled with Valgrind support: no<br />D: [pulseaudio] main.c: Running in valgrind mode: no<br />D: [pulseaudio] main.c: Running in VM: no<br />D: [pulseaudio] main.c: Optimized build: yes<br />D: [pulseaudio] main.c: All asserts enabled.<br />I: [pulseaudio] main.c: Machine ID is OpenWrt-PulseAudio.<br />I: [pulseaudio] main.c: Using runtime directory /tmp/.pulse/OpenWrt-PulseAudio-runtime.<br />I: [pulseaudio] main.c: Using state directory /tmp/.pulse.<br />I: [pulseaudio] main.c: Using modules directory /usr/lib/pulse-1.1/modules.<br />I: [pulseaudio] main.c: Running in system mode: no<br />I: [pulseaudio] main.c: Fresh high-resolution timers available! Bon appetit!<br />D: [pulseaudio] memblock.c: Using shared memory pool with 1024 slots of size 4.0 KiB each, total size is 4.0 MiB, maximum usable slot size is 4056<br />I: [pulseaudio] module-device-restore.c: Successfully opened database file &#039;/tmp/.pulse/OpenWrt-PulseAudio-device-volumes&#039;.<br />I: [pulseaudio] module.c: Loaded &quot;module-device-restore&quot; (index: #0; argument: &quot;&quot;).<br />I: [pulseaudio] module-stream-restore.c: Successfully opened database file &#039;/tmp/.pulse/OpenWrt-PulseAudio-stream-volumes&#039;.<br />I: [pulseaudio] module.c: Loaded &quot;module-stream-restore&quot; (index: #1; argument: &quot;&quot;).<br />E: [pulseaudio] module.c: Failed to open module &quot;module-card-restore&quot;: file not found<br />E: [pulseaudio] main.c: Module load failed.<br />E: [pulseaudio] main.c: Failed to initialize daemon.<br />I: [pulseaudio] module.c: Unloading &quot;module-device-restore&quot; (index: #0).<br />I: [pulseaudio] module.c: Unloaded &quot;module-device-restore&quot; (index: #0).<br />D: [pulseaudio] core-subscribe.c: Dropped redundant event due to remove event.<br />I: [pulseaudio] module.c: Unloading &quot;module-stream-restore&quot; (index: #1).<br />I: [pulseaudio] module.c: Unloaded &quot;module-stream-restore&quot; (index: #1).<br />D: [pulseaudio] core-subscribe.c: Dropped redundant event due to remove event.<br />I: [pulseaudio] main.c: Daemon terminated.</p><br /><p>BTW I am not good at English,sorry for my bad English...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p151629">
				<div class="post-metadata">
					<div class="post-num">Post #48</div>
					<div class="post-author">s7mx1</div>
					<div class="post-datetime">
						20 Dec 2011, 17:40					</div>
				</div>
				<div class="post-content content">
					<p>@tosslee</p><p>What&#039;s the model number of the Logitech sound card? </p><br /><p>I will need the result of the dmesg on both devices. If the 703N recognises the sound card you can find it in<br /></p><div class="codebox"><pre><code>/proc/asound/cards</code></pre></div><p>You can also found out what usb devices are attached from the web gui here <a href="http://openwrt-pulseaudio/cgi-bin/webif/status-usb.sh">http://openwrt-pulseaudio/cgi-bin/webif/status-usb.sh</a></p><p>By the way the alsa module is not loaded by pulseaudio directly. This is handled by the pulse-monitor script to support plug &amp; play. Therefore you need to make sure its running. In the new firmware (hopefully to be released soon) it will be handled by hotplug event which is more efficient.</p><br /><div class="quotebox"><cite>tosslee wrote:</cite><blockquote><p>@s7mx1<br />I flashed your PulseAudio firmware on 703n,but I have some problems.<br />When I pulg my Logitech sound card,the 703n cannot identify my sound card.<br />On your firmware I cannot find /dev/dsp and /dev/audio.<br />But on another trunk firmware after I okpg install kmod-usb-audio I can find that,and the madplay also can play mp3 file. <br />here is my error message.Could you help me with that?</p></blockquote></div>											<p class="post-edited">(Last edited by <strong>s7mx1</strong> on 20 Dec 2011, 17:55)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p151687">
				<div class="post-metadata">
					<div class="post-num">Post #49</div>
					<div class="post-author">tosslee</div>
					<div class="post-datetime">
						21 Dec 2011, 11:40					</div>
				</div>
				<div class="post-content content">
					<p>@s7mx1<br />uh,actually I can find my sound card in<br /></p><div class="codebox"><pre><code>/proc/asound/cards</code></pre></div><p>.</p><p>And from the web gui I can got the usb msg.<br /></p><div class="quotebox"><blockquote><p>Bus&nbsp; &nbsp; Device&nbsp; &nbsp; Product&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Manufacturer&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;VendorID:ProdID&nbsp; &nbsp; USB version&nbsp; &nbsp; Speed<br />01&nbsp; &nbsp; 1&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Atheros&nbsp; AR91xx built-in EHCI controller&nbsp; &nbsp; Linux 2.6.39.4 ehci_hcd&nbsp; &nbsp; 1d6b:0002&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2.00&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;480 Mbps<br />01&nbsp; &nbsp; 2&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Logitech USB Headset&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;SCEA Inc. &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;046d:0a0b&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1.10&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;12 Mbps</p></blockquote></div><p>I could not understand how the pulse-monitor scirpt work.It seems not running under 703n.<br />Unfortunately I am a linux newer,I only have a fedora15 Live on VMware.<br />I follow the <a href="http://wiki.openwrt.org/doc/howto/pulseaudio">http://wiki.openwrt.org/doc/howto/pulseaudio</a>&nbsp; &nbsp;When I entered &quot;pacmd load-module module-tunnel-sink server=openwrt-pulseaudio&quot;,there is no response- -</p><p>What I need to do is stream audio from Win7 to wr703n.From now on I can config the pulseaudio(win32 version) correctly ,use mpd&amp;mpc play mp3 file.<br />But stream audio I haven&#039;t got a clue yet...</p>											<p class="post-edited">(Last edited by <strong>tosslee</strong> on 21 Dec 2011, 11:59)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p151696">
				<div class="post-metadata">
					<div class="post-num">Post #50</div>
					<div class="post-author">s7mx1</div>
					<div class="post-datetime">
						21 Dec 2011, 14:02					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>tosslee wrote:</cite><blockquote><p>@s7mx1<br />uh,actually I can find my sound card in<br /></p><div class="codebox"><pre><code>/proc/asound/cards</code></pre></div><p>.</p><p>And from the web gui I can got the usb msg.<br /></p><div class="quotebox"><blockquote><p>Bus&nbsp; &nbsp; Device&nbsp; &nbsp; Product&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Manufacturer&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;VendorID:ProdID&nbsp; &nbsp; USB version&nbsp; &nbsp; Speed<br />01&nbsp; &nbsp; 1&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Atheros&nbsp; AR91xx built-in EHCI controller&nbsp; &nbsp; Linux 2.6.39.4 ehci_hcd&nbsp; &nbsp; 1d6b:0002&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2.00&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;480 Mbps<br />01&nbsp; &nbsp; 2&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Logitech USB Headset&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;SCEA Inc. &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;046d:0a0b&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1.10&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;12 Mbps</p></blockquote></div><p>I could not understand how the pulse-monitor scirpt work.It seems not running under 703n.<br />Unfortunately I am a linux newer,I only have a fedora15 Live on VMware.<br />I follow the <a href="http://wiki.openwrt.org/doc/howto/pulseaudio">http://wiki.openwrt.org/doc/howto/pulseaudio</a>&nbsp; &nbsp;When I entered &quot;pacmd load-module module-tunnel-sink server=openwrt-pulseaudio&quot;,there is no response- -</p><p>What I need to do is stream audio from Win7 to wr703n.From now on I can config the pulseaudio(win32 version) correctly ,use mpd&amp;mpc play mp3 file.<br />But stream audio I haven&#039;t got a clue yet...</p></blockquote></div><p>@tosslee</p><p>Sorry to inform you incorrectly. Having been messing my head with multi wan support, aka multipath routing, I was not looking the release properly. </p><p>If you flashed my latest firmware openwrt-pulseaudio-28854-1212-tl-wr703n-v1-squashfs-factory.bin then the loading/unloading pulseaudio alsa module is handled by hotplug script already. The pulse-monitor is obsoleted in that release.</p><p>You should not run pulseaudio by hand as it will start automatically on boot or when the usb soundcard is plugged in.</p><p>What I would suggest is flash the latest firmware if you have not done so. Reboot WR703N with usb sound card attached and paste the output of logread from console. Run the&nbsp; pacmd on your windows box again and check the output of logread from WR703N and you should notice more entries from pulseaudio. Otherwise it could be something to do with your windows firewall or windows pulseaudio server.</p><p>I promise in the next release that you will have a special pulseaudio status page on web gui like this<br /><span class="postimg"><img src="http://xbox-remote.googlecode.com/files/pulse-status-01.png" alt="http://xbox-remote.googlecode.com/files/pulse-status-01.png" /></span><br />and this<br /><span class="postimg"><img src="http://xbox-remote.googlecode.com/files/pulse-status-02.png" alt="http://xbox-remote.googlecode.com/files/pulse-status-02.png" /></span><br />which will make life a lot easier.</p>											<p class="post-edited">(Last edited by <strong>s7mx1</strong> on 21 Dec 2011, 14:08)</p>
									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 2 of 12</div><nav><ul><li><a href="viewtopic.php%3Fid=33387&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li><li><a href="viewtopic.php%3Fid=33387&amp;p=3.html">3</a></li><li><a href="viewtopic.php%3Fid=33387&amp;p=4.html">4</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=33387&amp;p=12.html">12</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>