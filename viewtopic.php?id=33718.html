<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Missing Network Config</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 2 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p152122">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">garyc</div>
					<div class="post-datetime">
						26 Dec 2011, 19:31					</div>
				</div>
				<div class="post-content content">
					<p>Hi</p><p>I am hoping that someone may be able to point me in the right direction.</p><p>I have just attempted to install backfire onto a MikroTik RB411AR by following this howto:</p><p><a href="http://blog.vodkamelone.de/archives/148-Installing-OpenWrt-on-a-Microtik-Routerboard-RB433.html">http://blog.vodkamelone.de/archives/148 … RB433.html</a></p><p>and</p><p><a href="http://wiki.openwrt.org/oldwiki/openwrtdocs/hardware/mikrotik/rb100">http://wiki.openwrt.org/oldwiki/openwrt … otik/rb100</a></p><p>All seemed to be going ok. The ramdisk worked ok and I installed the flash using the method described in the first howto.</p><p>Router has rebooted ok but for some reason I cannot find the /etc/config/network file. Below are the start up logs:</p><div class="codebox"><pre><code>RouterBOOT booter 2.29

RouterBoard 411AR

CPU frequency: 300 MHz
  Memory size:  64 MB

Press any key within 2 seconds to enter setup..
loading kernel from nand... OK
setting up elf image... OK
jumping to kernel code
Linux version 2.6.32.27 (gary@whitetip) (gcc version 4.3.3 (GCC) ) #2 Mon Dec 26 16:01:28 GMT 2011
bootconsole [early0] enabled
CPU revision is: 00019374 (MIPS 24Kc)
Atheros AR7130 rev 2, CPU:300.000 MHz, AHB:150.000 MHz, DDR:300.000 MHz
Determined physical RAM map:
 memory: 04000000 @ 00000000 (usable)
User-defined physical RAM map:
 memory: 04000000 @ 00000000 (usable)
Initrd not found or empty - disabling initrd
Zone PFN ranges:
  Normal   0x00000000 -&gt; 0x00004000
Movable zone start PFN for each node
early_node_map[1] active PFN ranges
    0: 0x00000000 -&gt; 0x00004000
Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 16256
Kernel command line: rootfstype=squashfs,yaffs,jffs2 noinitrd console=ttyS0,115200 console=ttyS0,115200 gpio=4031 HZ=150000000 mem=64M kmac=00:0C:42:B5:8B:54 board=411 boot=1 mlc=2
PID hash table entries: 256 (order: -2, 1024 bytes)
Dentry cache hash table entries: 8192 (order: 3, 32768 bytes)
Inode-cache hash table entries: 4096 (order: 2, 16384 bytes)
Primary instruction cache 64kB, VIPT, 4-way, linesize 32 bytes.
Primary data cache 32kB, 4-way, VIPT, cache aliases, linesize 32 bytes
Writing ErrCtl register=0006fcf0
Readback ErrCtl register=0006fcf0
Memory: 61800k/65536k available (2045k kernel code, 3664k reserved, 405k data, 148k init, 0k highmem)
SLUB: Genslabs=7, HWalign=32, Order=0-3, MinObjects=0, CPUs=1, Nodes=1
Hierarchical RCU implementation.
NR_IRQS:56
Calibrating delay loop... 199.88 BogoMIPS (lpj=999424)
Mount-cache hash table entries: 512
NET: Registered protocol family 16
MIPS: machine is MikroTik RouterBOARD 411/A/AH
registering PCI controller with io_map_base unset
bio: create slab &lt;bio-0&gt; at 0
pci 0000:00:00.0: PME# supported from D0 D1 D2 D3hot
pci 0000:00:00.0: PME# disabled
PCI: mapping irq 50 to pin1@0000:00:11.0
Switching to clocksource MIPS
NET: Registered protocol family 2
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 2048 (order: 2, 16384 bytes)
TCP bind hash table entries: 2048 (order: 1, 8192 bytes)
TCP: Hash tables configured (established 2048 bind 2048)
TCP reno registered
NET: Registered protocol family 1
squashfs: version 4.0 (2009/01/31) Phillip Lougher
Registering mini_fo version $Id$
JFFS2 version 2.2. (NAND) (SUMMARY)  Â© 2001-2006 Red Hat, Inc.
yaffs Dec 26 2011 15:50:50 Installing.
msgmni has been set to 120
io scheduler noop registered
io scheduler deadline registered (default)
Serial: 8250/16550 driver, 1 ports, IRQ sharing disabled
serial8250.0: ttyS0 at MMIO 0x18020000 (irq = 11) is a 16550A
console [ttyS0] enabled, bootconsole disabled
console [ttyS0] enabled, bootconsole disabled
NAND flash driver for RouterBoard 4xx series version 0.1.10
NAND SPI clock 25000 kHz (AHB 150000 kHz / 6)
FLASH SPI clock 25000 kHz (AHB 150000 kHz / 6)
NAND device: Manufacturer ID: 0xec, Chip ID: 0x76 (Samsung NAND 64MiB 3,3V 8-bit)
Scanning device for bad blocks
Bad eraseblock 256 at 0x000000400000
Bad eraseblock 2173 at 0x0000021f4000
Creating 3 MTD partitions on &quot;NAND 64MiB 3,3V 8-bit&quot;:
0x000000000000-0x000000040000 : &quot;booter&quot;
0x000000040000-0x000000600000 : &quot;kernel&quot;
0x000000600000-0x000004000000 : &quot;rootfs&quot;
mtd: partition &quot;rootfs&quot; set to be root filesystem
split_squashfs: error occured while reading from &quot;NAND 64MiB 3,3V 8-bit&quot;
Atheros AR71xx SPI Controller driver version 0.2.4
ag71xx_mdio: probed
eth0: Atheros AG71xx at 0xb9000000, irq 4
Atheros AR71xPPP generic driver version 2.4.2
ip_tables: (C) 2000-2006 Netfilter Core Team
NET: Registered protocol family 24
ehci_hcd: USB 2.0 &#039;Enhanced&#039; Host Controller (EHCI) Driver
nf_conntrack version 0.5.0 (969 buckets, 3876 max)
ohci_hcd: USB 1.1 &#039;Open&#039; Host Controller (OHCI) Driver



BusyBox v1.15.3 (2011-12-26 15:35:07 GMT) built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 Backfire (10.03.1, r29608) ------------------------
  * 1/3 shot Kahlua    In a shot glass, layer Kahlua
  * 1/3 shot Bailey&#039;s  on the bottom, then Bailey&#039;s,
  * 1/3 shot Vodka     then Vodka.
 ---------------------------------------------------
root@OpenWrt:/# ifconfig
root@OpenWrt:/# ls /etc/config
dhcp      dropbear  firewall  system    uhttpd
root@OpenWrt:/#</code></pre></div><p>I can see that there is an error relating to squashfs but I am not sure what this is inferring or if it is related.</p><p>Any help would be much appreciated.</p><p>Thanks</p><p>Gary</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p152152">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">garyc</div>
					<div class="post-datetime">
						27 Dec 2011, 10:56					</div>
				</div>
				<div class="post-content content">
					<p>OK - so I have got further by:</p><p>1. Formatting the NAND<br />2. Using the current trunk<br />3. Using the wget2nand method</p><p>I now get eth0 up and running but I cannot see any sign of the on board wireless card.</p><p>I have read the wireless howto: <a href="http://wiki.openwrt.org/doc/howto/wireless.essentials">http://wiki.openwrt.org/doc/howto/wireless.essentials</a> and confirmed that kmod-ath9k is installed.</p><p>Running </p><div class="codebox"><pre><code>wifi detect</code></pre></div><p>returns nothing.</p><p>I&#039;m really struggling now so any input would be welcomed.</p><p>Thanks</p><p>Gary</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p152156">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Orca</div>
					<div class="post-datetime">
						27 Dec 2011, 12:30					</div>
				</div>
				<div class="post-content content">
					<p>1. Do you<br />a) just want to get this working, or do you <br />b) claim there is some bug in OpenWrt for the mikrotik and want to help solve it?</p><p>a) Try it manually using the <a href="http://wiki.openwrt.org/doc/howto/wireless.utilities">wireless utilities</a>. What do iwconfig and iw say?<br />b) Maybe you made a mistake at the installation, maybe there is some bug, I dunno. Is your board fully supported in stable?<br />Wiki only says: WIP&nbsp; (http://wiki.openwrt.org/toh/start?s[]=mikrotik#mikrotik). Could be interesting to try trunk and see, if the same occurs.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p152158">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">shahbaz</div>
					<div class="post-datetime">
						27 Dec 2011, 12:54					</div>
				</div>
				<div class="post-content content">
					<p>my router was also giving the same problem but there was a file in /etc/config named wifi i have one line and it worked.</p><p>previously in ifconfig command was giving only local loop</p><p>after doung this it worked.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p152160">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">garyc</div>
					<div class="post-datetime">
						27 Dec 2011, 13:17					</div>
				</div>
				<div class="post-content content">
					<p>Hi</p><p>Thanks for the replies.</p><p>Orca:</p><p>I guess I just want to get this working but the problem is I cannot tell if this is owing to a mistake on my part or a bug.</p><p>Both iwconfig and iw simply return nothing as if the wlan interfaces don&#039;t exist and I cannot see from the documentation how one would add them manually. </p><p>I have just tried the precompiled version from the trunk using the ar71xx version (the chip on the board is an ar7130) but this stalled with a kernel panic.</p><p>Shahbaz:</p><p>Not sure I understand. I was expecting a file called wireless in /etc/config. Did you manually create this &quot;wifi&quot; file?</p><p>Thanks</p><p>Gary</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p152161">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Orca</div>
					<div class="post-datetime">
						27 Dec 2011, 13:23					</div>
				</div>
				<div class="post-content content">
					<p>I hope you do not mind me asking, but the <a href="http://routerboard.com/RB411">http://routerboard.com/RB411</a> does not have an integrated WNIC, though on the picture it looks like it would have one: You do have a WNIC, right?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p152183">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">garyc</div>
					<div class="post-datetime">
						27 Dec 2011, 19:34					</div>
				</div>
				<div class="post-content content">
					<p>Don&#039;t mind in the slightest! Appreciate you even taking the time to check to be honest.</p><p>The actual board is the RB411AR <a href="http://routerboard.com/RB411AR">http://routerboard.com/RB411AR</a></p><p>My apologies for not being specific enough in my original post.</p><p>Gary</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p152184">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">garyc</div>
					<div class="post-datetime">
						27 Dec 2011, 20:48					</div>
				</div>
				<div class="post-content content">
					<p>Oh joy! I have found the error of my ways and the wireless is now working.</p><p>I realised that the kmod-ath9k drivers are incorrect for this board as the wireless card is actually an AR5212 and therefore needs the kmod-ath5k drivers.</p><p>For reference, using the latest trunk I built the image using the following options:</p><p>Target System: Atheros AR71xx/AR7240/AR913x/AR934x<br />Subtarget: Devices with NAND flash (mostly Mikrotik)<br />Target Profile: Default Profile (No WiFi)</p><p>I then went into Kernel Modules --&gt; Wireless Drivers and selected that the kmod-ath5k be built in.</p><p>Prior to this I was using the selecting &quot;Atheros WiFi (madwifi)&quot; option for the Target Profile which was then using the kmod-ath9k drivers.</p><p>Following this, everything appears to be working!</p><p>Gary</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>