<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Out of memory crash??</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 5 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p56346">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">alasondro</div>
					<div class="post-datetime">
						24 Sep 2007, 03:01					</div>
				</div>
				<div class="post-content content">
					<p>I am running kamikaze 7.07 on an RB532a and i get the following errors after one or two days of uptime</p><div class="codebox"><pre><code>eth0: no memory, dropping rx packet.
eth0: no memory, dropping rx packet.
eth0: no memory, dropping rx packet.
printk: 2930 messages suppressed.
crond invoked oom-killer: gfp_mask=0x201d0, order=0, oomkilladj=0
Call Trace:[&lt;8010875c&gt;][&lt;8010875c&gt;][&lt;8014f7bc&gt;][&lt;80151474&gt;][&lt;8015145c&gt;][&lt;80217b38&gt;][&lt;801a4a94&gt;][&lt;8014ddd4&gt;][&lt;802181f8&gt;][&lt;801a4a94&gt;][&lt;80253218&gt;][&lt;80253320&gt;][&lt;801e3bc0&gt;][&lt;8024fc10&gt;][&lt;801d55f0&gt;][&lt;80304e04&gt;][&lt;801d586c&gt;][&lt;801d2930&gt;][&lt;80210108&gt;][&lt;801d2bac&gt;][&lt;801d3104&gt;][&lt;8014afec&gt;][&lt;80154024&gt;][&lt;80154008&gt;][&lt;8011cca0&gt;][&lt;8014b344&gt;][&lt;8014b304&gt;][&lt;8014e418&gt;][&lt;801755e8&gt;][&lt;8015d378&gt;][&lt;8013d900&gt;][&lt;8010c5c0&gt;][&lt;803063e8&gt;][&lt;8013dd50&gt;][&lt;8013d6e0&gt;][&lt;80102640&gt;][&lt;8010a960&gt;]
Mem-info:
DMA per-cpu:
CPU    0: Hot: hi:   18, btch:   3 usd:   3   Cold: hi:    6, btch:   1 usd:   0
Active:1175 inactive:0 dirty:0 writeback:0 unstable:0
free:95 slab:13492 mapped:2 pagetables:67 bounce:0
DMA free:380kB min:1016kB low:1268kB high:1524kB active:4700kB inactive:0kB present:65024kB pages_scanned:277636 all_unreclaimable? yes
lowmem_reserve[]:&lt;3&gt;eth0: no memory, dropping rx packet.
0 0
DMA: 1*4kB 1*8kB 1*16kB 1*32kB 1*64kB 0*128kB 1*256kB 0*512kB 0*1024kB 0*2048kB 0*4096kB = 380kB
Swap cache: add 0, delete 0, find 0/0, race 0+0
Free swap  = 0kB
Total swap = 0kB
Free swap:            0kB
16383 pages of RAM
0 pages of HIGHMEM
1027 reserved pages
37 pages shared
0 pages swap cached
eth0: no memory, dropping rx packet.
eth0: no memory, dropping rx packet.
eth0: no memory, dropping rx packet.
eth0: no memory, dropping rx packet.
eth0: no memory, dropping rx packet.
eth0: no memory, dropping rx packet.
eth0: no memory, dropping rx packet.
eth0: no memory, dropping rx packet.
eth0: no memory, dropping rx packet.
eth0: no memory, dropping rx packet.
eth0: no memory, dropping rx packet.
eth0: no memory, dropping rx packet.
printk: 2944 messages suppressed.
ospfd invoked oom-killer: gfp_mask=0x201d2, order=0, oomkilladj=0
Call race:[&lt;8010875c&gt;][&lt;8010875c&gt;][&lt;8014f7bc&gt;][&lt;80151474&gt;][&lt;8015145c&gt;][&lt;80153f10&gt;][&lt;8014e418&gt;][&lt;8015d378&gt;][&lt;8010c5c0&gt;][&lt;802638d8&gt;][&lt;80147908&gt;][&lt;80102640&gt;][&lt;801027b4&gt;]
Mem-info:
DMA per-cpu:
CPU    0: Hot: hi:   18, btch:   3 usd:   3   Cold: hi:    6, btch:   1 usd:   0
Active:1175 inactive:0 dirty:0 writeback:0 unstable:0
free:95 slab:13492 mapped:2 pagetables:67 bounce:0
DMA free:380kB min:1016kB low:1268kB high:1524kB active:4700kB inactive:0kB present:65024kB pages_scanned:283592 all_unreclaimable? yes
lowmem_reserve[]: 0 0
DMA: 1*4kB 1*8kB 1*16kB 1*32kB 1*64kB 0*128kB 1*256kB 0*512kB 0*1024kB 0*2048kB 0*4096kB = 380kB
Swap cache: add 0, delete 0, find 0/0, race 0+0
Free swap  = 0kB
Total swap = 0kB
Free swap:            0kB
16383 pages of RAM
0 pages of HIGHMEM
1027 reserved pages
37 pages shared
0 pages swap cached</code></pre></div><p>I am guessing this is memory related but i cannot find the source of the problem. I have noticed, although not quite sure,&nbsp; that this problem occurs with high traffic (30Mbits when the above error happened). The ps output is as follows</p><div class="codebox"><pre><code>root@turing:/# ps
  PID  Uid     VmSize Stat Command
    1 root        392 S   init       
    2 root            SWN [ksoftirqd/0]
    3 root            SW&lt; [events/0]
    4 root            SW&lt; [khelper]
    5 root            SW&lt; [kthread]
   19 root            SW&lt; [kblockd/0]
   36 root            SW  [pdflush]
   37 root            SW  [pdflush]
   38 root            SW&lt; [kswapd0]
   39 root            SW&lt; [aio/0]
   57 root            SW  [mtdblockd]
  164 root            SWN [jffs2_gcd_mtd0]
  171 root        404 S   logger -s -p 6 -t 
  173 root        492 S   /bin/ash --login
  180 root        352 S   syslogd -C16
  183 root        280 S   klogd
  191 root        264 S   /sbin/hotplug2 --override --persistent --max-children
  910 root        328 S   crond -c /etc/crontabs
  914 root        336 S   /usr/sbin/dropbear -s -p 22
1002 root       1588 S   snmpd -Lf /dev/null -p /var/run/snmpd.pid
1015 nobody      388 S   dnsmasq -F 10.27.228.4,10.27.228.13,255.255.255.240,1
1030 quagga      904 S   /usr/sbin/zebra -d
1035 quagga     1104 S   /usr/sbin/ospfd -d
1040 quagga     2712 S   /usr/sbin/bgpd -d
1045 root        364 S   /usr/sbin/watchquagga -d -z -T 60 -R /usr/sbin/quagga
1079 root        544 S   /usr/sbin/pppd plugin rp-pppoe.so mtu 1500 mru 1500 n
1173 root        384 R   ps</code></pre></div><p>Any ideas?</p>											<p class="post-edited">(Last edited by <strong>alasondro</strong> on 24 Sep 2007, 03:02)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p56428">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">alasondro</div>
					<div class="post-datetime">
						25 Sep 2007, 03:04					</div>
				</div>
				<div class="post-content content">
					<p>Just for future reference...<br />I am starting to think that the proble has something to do with the &quot;qos-scripts &quot; package and specifically with the imq device. Since I disabled it everything seems to run smoothly....</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p56444">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">jnaeff</div>
					<div class="post-datetime">
						25 Sep 2007, 11:17					</div>
				</div>
				<div class="post-content content">
					<p>I have exactly the same problem. Do you know where the memory leak exits ? And how to solve it with the imq device ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p56449">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">alasondro</div>
					<div class="post-datetime">
						25 Sep 2007, 12:37					</div>
				</div>
				<div class="post-content content">
					<p>No unfortunately i dont have the knowledge to pinpoint the problem...All I did is stop the qos-scripts from running and the remove the imq module...Someone told me that the imq device is buggy when doing both ingress and egress traffic shaping at the same time but i dont have the time to verify now...</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>