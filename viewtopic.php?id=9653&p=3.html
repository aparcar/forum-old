<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Optimized version of mmc.c</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 5 Jun 2014 and 7 Mar 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 3 of 7</div><nav><ul><li><a href="viewtopic.php%3Fid=9653&amp;p=1.html">1</a></li><li><a href="viewtopic.php%3Fid=9653&amp;p=2.html">2</a></li><li class="pagination-current"><span>3</span></li><li><a href="viewtopic.php%3Fid=9653&amp;p=4.html">4</a></li><li><a href="viewtopic.php%3Fid=9653&amp;p=5.html">5</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=9653&amp;p=7.html">7</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p45266">
				<div class="post-metadata">
					<div class="post-num">Post #51</div>
					<div class="post-author">shadsec</div>
					<div class="post-datetime">
						26 Mar 2007, 23:59					</div>
				</div>
				<div class="post-content content">
					<p>Hi Cyril!</p><div class="quotebox"><cite>Cyril wrote:</cite><blockquote><p>For the news:<br/>Here is the source of a 1.3.5 version that searches at runtime for GPIO addresses specific to each router.<br/>Would you please test it and report me if it crashes like the 1.3.4 ?<br/>If not, please output the dmesg and I will finalize the version for tomorrow.<br/><a href="http://programmingstuff.free.fr/files/openwrt/whiterussian/mmc/1_3_5/src/">source of 1.3.5 work</a><br/>Cyril</p></blockquote></div><p>Great! I hurried to test it and it loaded with no compaints!</p><p>After the last tests i have the wiring a bit messed, I am going right now to rework it, but the food thing is that it loaded, and this is the output:</p><p>[INFO] mmc_init: GPIO input addr: b8007060<br/>[INFO] mmc_init: GPIO output addr: b8007064<br/>[INFO] mmc_init: GPIO output enable addr: b8007068<br/>[INFO] mmc_hardware_init: initializing GPIOs<br/>[INFO] mmc_card_init: the period of a 380KHz frequency lasts 218 CPU cycles<br/>[INFO] mmc_card_init: powering card on. sending 80 CLK<br/>[INFO] mmc_card_init: 80 CLK sent in 18778 CPU cycles<br/>[INFO] mmc_card_init: resetting card (CMD0)<br/>[FATAL] mmc_card_init: invalid response from card: ff found, waiting for 01<br/>[INFO] mmc_card_init: the period of a 380KHz frequency lasts 218 CPU cycles<br/>[INFO] mmc_card_init: powering card on. sending 80 CLK<br/>[INFO] mmc_card_init: 80 CLK sent in 18646 CPU cycles<br/>[INFO] mmc_card_init: resetting card (CMD0)<br/>[FATAL] mmc_card_init: invalid response from card: ff found, waiting for 01<br/>[ERROR] mmc_init: got an error calling mmc_card_init: 01<br/>[ERROR] mmc_check_media: change detected but was not able to initialize new card: ffffffff</p><br/><p>AGAIN: My wiring is wrong at this time, just wanted to check if it was loading. I rework wiring and test again <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile"/></p><p>Thanks!!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45268">
				<div class="post-metadata">
					<div class="post-num">Post #52</div>
					<div class="post-author">Cyril</div>
					<div class="post-datetime">
						27 Mar 2007, 00:19					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for your quick reply.</p><p>So, we have found GPIO registers.</p><p>You can rewire your SD card but It shouldn&#039;t work as this version lacks specificities you spotted out :<br/>1&lt;&lt;24 and reverting output. Maybe you can try to hack it?</p><p>Anyway I will do it ASAP.</p><p>See ya.</p><p>[EDIT]<br/>Question:</p><p>Yours: [INFO] mmc_card_init: the period of a 380KHz frequency lasts 218 CPU cycles<br/>Mine : [INFO] mmc_card_init: the period of a 380KHz frequency lasts 628 CPU cycles</p><p>What is the clock speed of your CPU ? It smells like a problem in my calculations ...</p>											<p class="post-edited">(Last edited by <strong>Cyril</strong> on 27 Mar 2007, 09:58)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45270">
				<div class="post-metadata">
					<div class="post-num">Post #53</div>
					<div class="post-author">shadsec</div>
					<div class="post-datetime">
						27 Mar 2007, 00:42					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Cyril wrote:</cite><blockquote><p>You can rewire your SD card but It shouldn&#039;t work as this version lacks specificities you spotted out :<br/>1&lt;&lt;24 and reverting output. Maybe you can try to hack it?</p><p>Yours: [INFO] mmc_card_init: the period of a 380KHz frequency lasts 218 CPU cycles<br/>Mine : [INFO] mmc_card_init: the period of a 380KHz frequency lasts 628 CPU cycles</p><p>What is the clock speed of your CPU ? It smells like a problem in my calculations ...</p></blockquote></div><p>I dont think i will be able to do the modification, at least not without lots of time and tests since I am not even sure to understand the differences. I can check with gpio utility which is the default polarity for each gpio. But I dont yet understand how this works. I know very little C, and for sure not structs nor bit maskings (dont even tell me about pointers <img src="https://forum.openwrt.org/img/smilies/tongue.png" width="15" height="15" alt="tongue"/> ). Anyway, if there is anything It is on my hand to try just tell me and I will do my best. I really would love to finally have SD card working on my old router <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile"/></p><p>I dont think there is anything wrong in your calculations as v1.0 has a 125MHZ CPU:</p><p>system type&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: Broadcom BCM947XX<br/>processor&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: 0<br/>cpu model&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: BCM4710 V0.0<br/>BogoMIPS&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : 82.94<br/>wait instruction&nbsp; &nbsp; &nbsp; &nbsp; : no<br/>microsecond timers&nbsp; &nbsp; &nbsp; : yes<br/>tlb_entries&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: 32<br/>extra interrupt vector&nbsp; : no<br/>hardware watchpoint&nbsp; &nbsp; &nbsp;: no<br/>VCED exceptions&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: not available<br/>VCEI exceptions&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: not available</p><p>It is the original model with the wireless card in a minipci socket.</p><p>Mmm, now that I reread.... I assume your router is a 200mhz one, I dont know why such big difference in cpu cycles... </p><p>Is there anything more i can test?</p><p>Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45585">
				<div class="post-metadata">
					<div class="post-num">Post #54</div>
					<div class="post-author">jnjn</div>
					<div class="post-datetime">
						31 Mar 2007, 08:35					</div>
				</div>
				<div class="post-content content">
					<p>er, is there anything new on the great new driver these days?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45586">
				<div class="post-metadata">
					<div class="post-num">Post #55</div>
					<div class="post-author">GoldServe</div>
					<div class="post-datetime">
						31 Mar 2007, 08:36					</div>
				</div>
				<div class="post-content content">
					<p>The only thing that would fancy me would be a kernel 2.6 driver :weeps:</p><p>Good work on this BTW...hope we can port it soon and get optimized speeds!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45647">
				<div class="post-metadata">
					<div class="post-num">Post #56</div>
					<div class="post-author">jnjn</div>
					<div class="post-datetime">
						1 Apr 2007, 13:41					</div>
				</div>
				<div class="post-content content">
					<p>does kernel 2.6 fit to run on a broadcom router with 16MB ram?</p>											<p class="post-edited">(Last edited by <strong>jnjn</strong> on 1 Apr 2007, 13:43)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45660">
				<div class="post-metadata">
					<div class="post-num">Post #57</div>
					<div class="post-author">GoldServe</div>
					<div class="post-datetime">
						1 Apr 2007, 18:25					</div>
				</div>
				<div class="post-content content">
					<p>jnjn,</p><p>Yes it does but the broadcom platform isn&#039;t too interesting for kamikaze with kernel 2.6. Mainly the wireless drivers are for 2.4 .</p><p>However, there are many atheros and new platforms supported in kamikaze with madwifi. Cheers!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45984">
				<div class="post-metadata">
					<div class="post-num">Post #58</div>
					<div class="post-author">alej00d</div>
					<div class="post-datetime">
						7 Apr 2007, 04:36					</div>
				</div>
				<div class="post-content content">
					<p>Hi Cyril, thanks for you work on this crucial driver for us people looking for affordable ways of having a little server :)</p><p>I tried 1.3.4 it didnt load the card </p><p>1.3.3 got me further.</p><p>im trying to get the things up manually so after boot i do a:<br/>echo &quot;0x9c&quot; &gt; /proc/diag/gpiomask<br/>(the dmz led of my wrt54gl starts blinking)</p><p>then insmod mmc (1.3):<br/>[INFO] mmc_hardware_init: initializing GPIOs<br/>[INFO] mmc_card_init: powering card on. sending 80 CLK<br/>[INFO] mmc_card_init: resetting card (CMD0)<br/>[INFO] mmc_card_init: doing initialization loop<br/>[ERROR] mmc_card_init: card not successfully inited after 30000 tries.<br/>[INFO] mmc_card_init: powering card on. sending 80 CLK<br/>[INFO] mmc_card_init: resetting card (CMD0)<br/>[INFO] mmc_card_init: doing initialization loop<br/>[ERROR] mmc_card_init: card not successfully inited after 30000 tries.<br/>[ERROR] mmc_init: got an error calling mmc_card_init: 02<br/>[ERROR] mmc_check_media: change detected but was not able to initialize new card: ffffffff</p><p>i have tried with &gt;30000 tries and the command just stays in the loading loop forever.</p><p>it is a 2gig SD card labeled Trascend. im using rc9 white russian.</p><p>i have manage to load the card with this driver: <a href="http://www.halbundhalb.net/mmc/mmc.co">http://www.halbundhalb.net/mmc/mmc.co</a></p><p>it recognizes the card and mounts it as vfat, i manage to copy filez to it but after 2 o3 minutes things just dissapear from the dir in /mnt/sd/ or it just blocks the whole systema allowing only pings to it.</p><p>oke, please let me know if i can provide more info and do advice on how to be sure that cabling is fine or similar basic things that might be stopping the mod from working well.</p><p>tx!<br/>/a</p>											<p class="post-edited">(Last edited by <strong>alej00d</strong> on 7 Apr 2007, 04:38)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45997">
				<div class="post-metadata">
					<div class="post-num">Post #59</div>
					<div class="post-author">lospiratos</div>
					<div class="post-datetime">
						7 Apr 2007, 10:33					</div>
				</div>
				<div class="post-content content">
					<p>Please, can somebody port this driver to the 2.6 kernel?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46395">
				<div class="post-metadata">
					<div class="post-num">Post #60</div>
					<div class="post-author">lospiratos</div>
					<div class="post-datetime">
						13 Apr 2007, 22:15					</div>
				</div>
				<div class="post-content content">
					<p>Are you realy sure you are writing on such high speed? I think you have a buffer with your ram memory!<br/>Just do the test with a big file and see what happens then...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46398">
				<div class="post-metadata">
					<div class="post-num">Post #61</div>
					<div class="post-author">Cyril</div>
					<div class="post-datetime">
						13 Apr 2007, 22:50					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>lospiratos wrote:</cite><blockquote><p>Are you realy sure you are writing on such high speed? I think you have a buffer with your ram memory!<br/>Just do the test with a big file and see what happens then...</p></blockquote></div><p>Man, I am a programmer. I am doing programming every day - this my job.<br/>Please don&#039;t give me advices like this.<br/>My test was done with a 32MB file with &quot;syncing&quot; the filesystem.</p><p>Bye.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46407">
				<div class="post-metadata">
					<div class="post-num">Post #62</div>
					<div class="post-author">lospiratos</div>
					<div class="post-datetime">
						14 Apr 2007, 01:12					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m sorry, do you have plans to port the driver to the 2.6 kernel?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46450">
				<div class="post-metadata">
					<div class="post-num">Post #63</div>
					<div class="post-author">Kevin</div>
					<div class="post-datetime">
						15 Apr 2007, 05:58					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jnjn wrote:</cite><blockquote><p>does kernel 2.6 fit to run on a broadcom router with 16MB ram?</p></blockquote></div><p>yes, linux 2.6 can easily work on 16mb ram</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46531">
				<div class="post-metadata">
					<div class="post-num">Post #64</div>
					<div class="post-author">fabifri</div>
					<div class="post-datetime">
						16 Apr 2007, 16:13					</div>
				</div>
				<div class="post-content content">
					<p>hi @ all</p><p>i am in trouble with my mmc-card inside the router. today, i soldered an mmc-card into my wrt54gl. i soldered the cables from the wrt-mainboard directly to my 8MB mmc card. (8MB is enough for me, i need it only for something to try).</p><p>i am using your optimized mmc.o. first, all is going on to work properly, but now it doesn&#039;t recognise the partitions on the card. first i had the /dev/mmc/disc0/part1 device, then i tried to format the card with mkfs.ext2, but the router freezed while formatting (why this?)...<br/>i made a reboot of the wrt(power chord in and out), and now it does not recognize any partitions on the card, i have the following error:</p><div class="codebox"><pre><code> 
[INFO] mmc_hardware_init: initializing GPIOs
[INFO] mmc_card_init: powering card on. sending 80 CLK
[INFO] mmc_card_init: resetting card (CMD0)
[INFO] mmc_card_init: doing initialization loop
[INFO] mmc_card_init: card inited successfully in 4 tries (0 seconds 70598 usec).
[INFO] mmc_init: MMC/SD Card ID:
06 00 00 33 32 4d 20 20 20 01 19 c0 cf 03 96 d9
Manufacturer : 32M   , cardUID = 3cfc019
[INFO] mmc_card_config: size = 31360, hardsectsize = 512, sectors = 62720
[WARN] mmc_init: hd_sizes=31360, hd[0].nr_sects=62720
[INFO] mmc_card_init: set_blocklen (CMD16) succeeded !
Partition check:
 mmca:[ERROR] mmc_request: read error: 03</code></pre></div><p>i have to repartitioning the mmc-card maybe, but i can not put it into my card-reader, because the wires are soldered directly from the wrt on the card....</p><p>is there any possibility to solve that problem ? when there is no possibility i need to unsolder the wires from the mmc-card, to repartition it with the help of my PC</p><p>(and sorry for my not so good english <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink"/> - and a big &quot;thanks&quot; to the &quot;OpenWrt&quot;-Team and the &quot;DD-WRT&quot;-Team) , i am an autrian)</p><p>tranks<br/>fabian f.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46566">
				<div class="post-metadata">
					<div class="post-num">Post #65</div>
					<div class="post-author">jnjn</div>
					<div class="post-datetime">
						17 Apr 2007, 11:46					</div>
				</div>
				<div class="post-content content">
					<p>maybe you can do it with the router?<br/>and, i guess you may try the old driver to see if it makes any change first.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46587">
				<div class="post-metadata">
					<div class="post-num">Post #66</div>
					<div class="post-author">fabifri</div>
					<div class="post-datetime">
						17 Apr 2007, 19:26					</div>
				</div>
				<div class="post-content content">
					<p>with the old driver i have the same issue...</p><p>i have also checked the wires, nothing wrong.</p><p>i also think that this is a software problem. hardware is recognized, but only &quot;/dev/mmc/disc0/disc&quot;-device-node is there. &quot;/dev/mmc/disc0/part1&quot; is missing there...</p><p>greets<br/>fabian f.</p>											<p class="post-edited">(Last edited by <strong>fabifri</strong> on 17 Apr 2007, 19:26)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46653">
				<div class="post-metadata">
					<div class="post-num">Post #67</div>
					<div class="post-author">jnjn</div>
					<div class="post-datetime">
						18 Apr 2007, 19:41					</div>
				</div>
				<div class="post-content content">
					<p>i have a piece of broken card, which the parameters can be read, but cannot read/write data.<br/>however, you can try to partition the card with the router. maybe you can try that linux fdisk utility?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46717">
				<div class="post-metadata">
					<div class="post-num">Post #68</div>
					<div class="post-author">fabifri</div>
					<div class="post-datetime">
						19 Apr 2007, 10:42					</div>
				</div>
				<div class="post-content content">
					<p>this was my first idea, after i realised that the card was broken. but i need an fdisk packet for whiterussian...</p><p>i habve xwrt, backports and official packets, but there is no fdisk.</p><p>i will try to unsolder the card, and partition it with my ubuntu linux. i hope this works.</p><p>greets fabi</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p47146">
				<div class="post-metadata">
					<div class="post-num">Post #69</div>
					<div class="post-author">michelinok76</div>
					<div class="post-datetime">
						25 Apr 2007, 20:43					</div>
				</div>
				<div class="post-content content">
					<p>After doing the mmc mod (gpio2), isn&#039;t possible to turn on/off the cisco button? (or maybe modify the mmc code to use only orange led and leave the white led for general uses). I&#039;ve also noticed that i have only power and wlan in /proc/diag/led&nbsp; &nbsp;didn&#039;t remember.</p><p>Any info?</p>											<p class="post-edited">(Last edited by <strong>michelinok76</strong> on 25 Apr 2007, 20:45)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p47366">
				<div class="post-metadata">
					<div class="post-num">Post #70</div>
					<div class="post-author">migube</div>
					<div class="post-datetime">
						29 Apr 2007, 22:55					</div>
				</div>
				<div class="post-content content">
					<p>Salut Cyril,</p><p>just tried version 1.3.4 with an EMTEC (basf) 2Gb &amp; and Panasonic 16Mb, and I get the following message on my wrt54G v2 GPIO5.</p><br/><p>[INFO] mmc_hardware_init: initializing GPIOs<br/>[INFO] mmc_card_init: the period of a 380KHz frequency lasts 524 CPU cycles<br/>[INFO] mmc_card_init: powering card on. sending 80 CLK<br/>[INFO] mmc_card_init: 80 CLK sent in 43511 CPU cycles<br/>[INFO] mmc_card_init: resetting card (CMD0)<br/>[FATAL] mmc_card_init: invalid response from card: ff found, waiting for 01<br/>[INFO] mmc_card_init: the period of a 380KHz frequency lasts 524 CPU cycles<br/>[INFO] mmc_card_init: powering card on. sending 80 CLK<br/>[INFO] mmc_card_init: 80 CLK sent in 43160 CPU cycles<br/>[INFO] mmc_card_init: resetting card (CMD0)<br/>[FATAL] mmc_card_init: invalid response from card: ff found, waiting for 01<br/>[ERROR] mmc_init: got an error calling mmc_card_init: 01<br/>[ERROR] mmc_check_media: change detected but was not able to initialize new card: ffffffff</p><br/><p>using the original old GPIO5 works with the 16 mb card (not 2gb...) from <a href="http://www.frontiernet.net/~beakmyn/openwrt/mmc/GPIO5/Old">http://www.frontiernet.net/~beakmyn/openwrt/mmc/GPIO5/Old</a></p><p>Any ideas?</p><p>=&gt;Edit: Now I even don&#039;t get the 16 Mb card workign with this driver... wondering how I did it!? <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad"/></p><p>=&gt;Edit: The issue was with the floppy SD connector, which doesn&#039;t work well when I push the card till the end =&gt; connection issue.</p><br/><p>Merci!<br/>migube</p><br/><p>[INFO] mmc_hardware_init: initializing GPIOs<br/>[INFO] mmc_card_init: the period of a 380KHz frequency lasts 524 CPU cycles<br/>[INFO] mmc_card_init: powering card on. sending 80 CLK<br/>[INFO] mmc_card_init: 80 CLK sent in 43509 CPU cycles<br/>[INFO] mmc_card_init: resetting card (CMD0)<br/>[INFO] mmc_card_init: doing initialization loop<br/>[INFO] mmc_card_init: card inited successfully in 2207 tries (67457319 CPU cycles).<br/>[INFO] mmc_init: MMC/SD Card ID:<br/>27 50 48 53 44 30 32 47 20 b0 00 47 da 00 73 ad [INFO] Manufacturer ID&nbsp; &nbsp;: 27<br/>[INFO] OEM/Application ID: PH<br/>[INFO] Product name&nbsp; &nbsp; &nbsp; : SD02G<br/>[INFO] Product revision&nbsp; : 2.0<br/>[INFO] Product SN&nbsp; &nbsp; &nbsp; &nbsp; : b00047da<br/>[INFO] Product Date&nbsp; &nbsp; &nbsp; : 2007-3<br/>[INFO] mmc_card_config: size = 1992704, hardsectsize = 1024, sectors = 1992704<br/>[WARN] mmc_init: hd_sizes=1992704, hd[0].nr_sects=3985408<br/>[INFO] mmc_card_init: set_blocklen (CMD16) succeeded !<br/>Partition check:<br/> mmca: p1</p><p>=&gt;edit:<br/>I have the same issue with soft reboot as noticed by others. All lights are on &amp; power&amp;dmz blink. I have to swtich off power to reaccess it.</p><p>Any idea on how to solve this?</p><p>thx!</p>											<p class="post-edited">(Last edited by <strong>migube</strong> on 1 May 2007, 23:01)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p48018">
				<div class="post-metadata">
					<div class="post-num">Post #71</div>
					<div class="post-author">xtrem57</div>
					<div class="post-datetime">
						8 May 2007, 11:18					</div>
				</div>
				<div class="post-content content">
					<p>Hi!!</p><p>I have done the &quot;hack&quot; in order to havean SDCard on my WRT54GL v1.1 (to install Proxy, and content filtering system on it)<br/>So I solder as explain here:<br/><a href="http://www.the-mesh.org/tiki-index.php?page=LinksysSDCard">http://www.the-mesh.org/tiki-index.php?page=LinksysSDCard</a></p><p>I download the mmc.o module a place it in /lib/modules/2.4.30/<br/>Reboot my LinkSys, and got some error in dmesg</p><div class="quotebox"><blockquote><p>[INFO] mmc_hardware_init: initializing GPIOs<br/>[INFO] mmc_card_init: the period of a 380KHz frequency lasts 524 CPU cycles<br/>[INFO] mmc_card_init: powering card on. sending 80 CLK<br/>[INFO] mmc_card_init: 80 CLK sent in 44145 CPU cycles<br/>[INFO] mmc_card_init: resetting card (CMD0)<br/>[FATAL] mmc_card_init: invalid response from card: ff found, waiting for 01<br/>[INFO] mmc_card_init: the period of a 380KHz frequency lasts 524 CPU cycles<br/>[INFO] mmc_card_init: powering card on. sending 80 CLK<br/>[INFO] mmc_card_init: 80 CLK sent in 43763 CPU cycles<br/>[INFO] mmc_card_init: resetting card (CMD0)<br/>[FATAL] mmc_card_init: invalid response from card: ff found, waiting for 01<br/>[ERROR] mmc_init: got an error calling mmc_card_init: 01<br/>[ERROR] mmc_check_media: change detected but was not able to initialize new card : ffffffff</p></blockquote></div><p>Tried GPIO2 and GPIO5 modules, nothing change (Which one will I use ?)<br/>I have a 512Mo Integral SDcard</p><p>Thanks in advance</p><p>Gauthier from France</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p48026">
				<div class="post-metadata">
					<div class="post-num">Post #72</div>
					<div class="post-author">abraXxl</div>
					<div class="post-datetime">
						8 May 2007, 12:29					</div>
				</div>
				<div class="post-content content">
					<p>Hi !</p><div class="quotebox"><cite>migube wrote:</cite><blockquote><p>=&gt;Edit: The issue was with the floppy SD connector, which doesn&#039;t work well when I push the card till the end =&gt; connection issue.</p></blockquote></div><p>The same problem i have had. I solved it by cutting a 1mm thick line and stick it in the floppy connector. Now I am not abel to insert the card too deep.</p><div class="quotebox"><cite>migube wrote:</cite><blockquote><p>=&gt;edit:<br/>I have the same issue with soft reboot as noticed by others. All lights are on &amp; power&amp;dmz blink. I have to swtich off power to reaccess it.</p><p>Any idea on how to solve this?</p></blockquote></div><p>As I stated before, it has something to do how the safe mode is enabled in white russian (don&#039;t know if the problem exists in kamikaze).</p><p>When you insert the mmc.o you have to to set the gpiomask so that router is not looping it&#039;s self due to button hotplug request by diag.o directed to hotplug helper.</p><p>When you reboot after using mmc.o the gpiomask is reset. Hotplug events are&nbsp; issued, because the mmc card seems to be still active. /etc/preinit so thinks the reset button or something else was pressed an goes in to failsafe.</p><p>If you do a soft reboot and unplug the card, shortly after issuing the reboot this will not happen. </p><p>So if anyhow the driver will make the card quiet (disable it) before reboot, this problem is solved.</p><p>cya</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p48040">
				<div class="post-metadata">
					<div class="post-num">Post #73</div>
					<div class="post-author">xtrem57</div>
					<div class="post-datetime">
						8 May 2007, 15:12					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>Yep it was the problem!<br/>I solder directly on the SDCard and it finally works <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink"/></p><p>Now I will try to install some package on it <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink"/></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p48089">
				<div class="post-metadata">
					<div class="post-num">Post #74</div>
					<div class="post-author">migube</div>
					<div class="post-datetime">
						9 May 2007, 13:34					</div>
				</div>
				<div class="post-content content">
					<p>thanks abraXxl,</p><p>Cyril stp, <br/>any way of disabling the card in the driver when the system reboots, or rmmod mmc ?</p><p>thx</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p48466">
				<div class="post-metadata">
					<div class="post-num">Post #75</div>
					<div class="post-author">$@m</div>
					<div class="post-datetime">
						15 May 2007, 14:16					</div>
				</div>
				<div class="post-content content">
					<p>hie</p><p>Can we hope to have a driver in future for 8 or 16Go SDcard ?</p>									</div>
			</article>

			
		
						<div class="notice">
				<p>Sorry, posts 76 to 75 are missing from our archive.</p>
			</div>
		
		
	
	<div class="pagination"><div class="pagination-number">Page 3 of 7</div><nav><ul><li><a href="viewtopic.php%3Fid=9653&amp;p=1.html">1</a></li><li><a href="viewtopic.php%3Fid=9653&amp;p=2.html">2</a></li><li class="pagination-current"><span>3</span></li><li><a href="viewtopic.php%3Fid=9653&amp;p=4.html">4</a></li><li><a href="viewtopic.php%3Fid=9653&amp;p=5.html">5</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=9653&amp;p=7.html">7</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0.001 -->

</body>
</html>