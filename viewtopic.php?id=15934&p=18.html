<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Is this router based on the infineon danube?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 1 Oct 2014 and 1 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 18 of 40</div><nav><ul><li><a href="viewtopic.php%3Fid=15934&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=15934&amp;p=16.html">16</a></li><li><a href="viewtopic.php%3Fid=15934&amp;p=17.html">17</a></li><li class="pagination-current"><span>18</span></li><li><a href="viewtopic.php%3Fid=15934&amp;p=19.html">19</a></li><li><a href="viewtopic.php%3Fid=15934&amp;p=20.html">20</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=15934&amp;p=40.html">40</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p138880">
				<div class="post-metadata">
					<div class="post-num">Post #426</div>
					<div class="post-author">pippolippi</div>
					<div class="post-datetime">
						10 Jul 2011, 14:06					</div>
				</div>
				<div class="post-content content">
					<p>Are you telling me that you have a buspirate but you don&#039;t have a small phillips screwdriver and a small, flat-head, one?<br />Tsk, tsk <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /><br />As per the arv7518, it has a different switch (supported), double the flash (8M instead of 4) and a different wifi chip (ar9223, badly supported with my patches, badly here meaning that performance is atrocious).<br />Everything else is the same (basically the SoC, which is the danube), though the led mapping is probably different.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p138907">
				<div class="post-metadata">
					<div class="post-num">Post #427</div>
					<div class="post-author">rvalles</div>
					<div class="post-datetime">
						11 Jul 2011, 01:54					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>pippolippi wrote:</cite><blockquote><p>Are you telling me that you have a buspirate but you don&#039;t have a small phillips screwdriver and a small, flat-head, one?<br />Tsk, tsk <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /><br />As per the arv7518, it has a different switch (supported), double the flash (8M instead of 4) and a different wifi chip (ar9223, badly supported with my patches, badly here meaning that performance is atrocious).<br />Everything else is the same (basically the SoC, which is the danube), though the led mapping is probably different.</p></blockquote></div><p>FWIW, I recovered that screwdriver, got the case open, connected into the serial. I&#039;m seeing the boot menus and stuff. I&#039;ve also flashed a test image from this forum on the device using the standard website, so now I have uboot chainloaded from brnload, which in turn loads some old image of openwrt. Nice.<br />I&#039;ll play with it a little more and then go sleep. I do work tomorrow <img src="https://forum.openwrt.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" />.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p138989">
				<div class="post-metadata">
					<div class="post-num">Post #428</div>
					<div class="post-author">rvalles</div>
					<div class="post-datetime">
						12 Jul 2011, 20:35					</div>
				</div>
				<div class="post-content content">
					<p>Spent some time playing this xmodem/brnboot/ubootfromngp&#039;stestimage</p><p>ATM using the test image from ngp.<br />I&#039;ve managed to flash some stuff with xmodem from brnboot and with tftp + era + cp.b on u-boot. Think I have the gist of it.</p><p>Now, I&#039;m trying to move on to more interesting stuff. It seems brnboot doesn&#039;t like loading anything from flash that isn&#039;t prepared for it with whatever obfuscation procedure, and I don&#039;t even care: I just wanna ged rid of it and place u-boot there instead.</p><p>So I went and built my own u-boot from openwrt svn, as u-boot git doesn&#039;t seem to have configs for arv4518 (remember upstream!!! Is it even worth it for openwrt to have a fork of u-boot? <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /> ) . As a start, the ram version since we know it works. Problem is it just hangs, both loaded from brnboot or from u-boot itself. The image name is &quot;uboot-lantiq-arv4518PW_ramboot&quot;.</p><div class="quotebox"><blockquote><p>ARV4518 =&gt; setenv ipaddr 192.168.0.10<br />ARV4518 =&gt; setenv serverip 192.168.0.2&nbsp; <br />ARV4518 =&gt; tftp 0xa0040000 u-boot.bin<br />Using lq_cpe_eth device<br />TFTP from server 192.168.0.2; our IP address is 192.168.0.10<br />Filename &#039;u-boot.bin&#039;.<br />Load address: 0xa0040000<br />Loading: #########<br />done<br />Bytes transferred = 131072 (20000 hex)<br />ARV4518 =&gt; go 0xa0040000<br />## Starting application at 0xA0040000 ...</p></blockquote></div><p>It just freezes like that. Using 0x80002000 is about as bad. Also tried uploading via XMODEM with brnboot and jumping to the address, for both addresses. It freezes all the same.</p><p>Pointers?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p138990">
				<div class="post-metadata">
					<div class="post-num">Post #429</div>
					<div class="post-author">rvalles</div>
					<div class="post-datetime">
						12 Jul 2011, 20:42					</div>
				</div>
				<div class="post-content content">
					<p>However, the uboot-lantiq-arv4518PW_brnboot one works when loaded to memory and jumped to from uboot. Why would the ramdisk one not work and this one do? Did I get it wrong, about which of these has which purpose? I&#039;m very confused. I&#039;m afraid to flash the real one and then see myself trying that boot-from-UART rescue procedure...<br /></p><div class="quotebox"><blockquote><p>[DANUBE Boot]:y</p><p>Go to Memory Address: (default:0x80002000) : 0x<br />Jump to address 0x80002000 ...</p><br /><p>U-Boot 2010.03 (Jul 12 2011 - 17:03:19)</p><p>Board: ARV4518PW<br />SoC: Danube/Twinpass/Vinax-VE V1.3, DDR Speed 166 MHz, CPU Speed 333 MHz<br />DRAM:&nbsp; 64 MB<br />Flash:&nbsp; 4 MB<br />*** Warning - bad CRC, using default environment</p><p>Net:&nbsp; &nbsp;<br />searching for rtl8306 switch ... found<br />lq_cpe_eth<br />Hit any key to stop autoboot:&nbsp; 0 <br />ARV4518 =&gt;</p></blockquote></div><p>Pointers are welcome.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p138992">
				<div class="post-metadata">
					<div class="post-num">Post #430</div>
					<div class="post-author">pippolippi</div>
					<div class="post-datetime">
						12 Jul 2011, 20:49					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>rvalles wrote:</cite><blockquote><p>Pointers?</p></blockquote></div><p>The various u-boot targets: <a href="https://forum.openwrt.org/viewtopic.php?pid=120175#p120175">https://forum.openwrt.org/viewtopic.php … 75#p120175</a></p><p>Steps to replace brnboot with u-boot: <a href="https://forum.openwrt.org/viewtopic.php?pid=121424#p121424">https://forum.openwrt.org/viewtopic.php … 24#p121424</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p138993">
				<div class="post-metadata">
					<div class="post-num">Post #431</div>
					<div class="post-author">rvalles</div>
					<div class="post-datetime">
						12 Jul 2011, 21:31					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>pippolippi wrote:</cite><blockquote><div class="quotebox"><cite>rvalles wrote:</cite><blockquote><p>Pointers?</p></blockquote></div><p>The various u-boot targets: <a href="https://forum.openwrt.org/viewtopic.php?pid=120175#p120175">https://forum.openwrt.org/viewtopic.php … 75#p120175</a></p><p>Steps to replace brnboot with u-boot: <a href="https://forum.openwrt.org/viewtopic.php?pid=121424#p121424">https://forum.openwrt.org/viewtopic.php … 24#p121424</a></p></blockquote></div><p>Yes, I was looking at those. I guess I just misunderstood the ramdisk one (I still don&#039;t understand why it doesn&#039;t work anyway. It&#039;s supposed to be the one to copy on ram and jump to, so wtf). &quot;Second stage&quot; brnboot works as I was commenting. I&#039;m a bit afraid to flash the real one at the bootloader area but it *should* work.<br />Did flash openwrt at the firmware area like this:<br /></p><div class="codebox"><pre><code>ARV4518 =&gt;  setenv ipaddr 192.168.0.10
ARV4518 =&gt; setenv serverip 192.168.0.2
ARV4518 =&gt; tftp openwrt.img
Using lq_cpe_eth device
TFTP from server 192.168.0.2; our IP address is 192.168.0.10
Filename &#039;openwrt.img&#039;.
Load address: 0x80100000
Loading: #################################################################
         #################################################################
         #################################################################
         #################################
done
Bytes transferred = 3342340 (330004 hex)
ARV4518 =&gt; era  0xB0030000+0x330004
erase - erase FLASH memory

ARV4518 =&gt;   era  0xB0030000 +0x330004

.................................................... done
Erased 52 sectors
ARV4518 =&gt;  cp.b 0x80100000 0xB0030000 0x330004
Copy to Flash... 9....8....7....6....5....4....3....2....1....done</code></pre></div><p>Did flash openwrt at what linux considers the linux area of the flash like this: cp.b 0x80100000 0xB0020000 0x330004<br />The image I flashed is a openwrt-lantiq-xway-ARV4518PW-jffs2-64k.image I built myself. u-boot loaded from brnboot seems to boot it fine <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />Notice the following:<br /></p><div class="quotebox"><blockquote><p>Creating 4 MTD partitions on &quot;ltq_nor&quot;:<br />0x00000000000000000020000 : &quot;uboot&quot;<br />0x000000020000-0x000000030000 : &quot;uboot_env&quot;<br />0x000000030000-0x0000003f0000 : &quot;linux&quot;<br />Creating 2 MTD partitions on &quot;ltq_nor&quot;:<br />0x000000030000-0x000000120000 : &quot;kernel&quot;<br />0x000000120000-0x0000003f0000 : &quot;rootfs&quot;<br />mtd: partition &quot;rootfs&quot; set to be root filesystem<br />split_squashfs: no squashfs found in &quot;ltq_nor&quot;<br />0x0000003f0000-0x000000400000 : &quot;board_config&quot;</p></blockquote></div><p>The interesting thing here is that in openwrt&#039;s built uboot defaults, printenv is like this:<br /></p><div class="quotebox"><blockquote><p>ARV4518 =&gt; printenv<br />bootcmd=run flash_flash<br />bootdelay=2<br />baudrate=115200<br />loads_echo=<br />ipaddr=192.168.1.1<br />serverip=192.168.1.101<br />rootpath=&quot;/export&quot;<br />gatewayip=192.168.1.254<br />netmask=255.255.255.0<br />ram_addr=0x80500000</p><p>flashargs=setenv bootargs rootfstype=squashfs,jffs2<br />nfsargs=setenv bootargs root=/dev/nfs rw nfsroot=${serverip}:${rootpath} <br />addip=setenv bootargs ${bootargs} ip=${ipaddr}:${serverip}:${gatewayip}:${netmask}:${hostname}:${netdev}:off<br />addmisc=setenv bootargs ${bootargs} init=/etc/preinit console=ttyS1,115200 ethaddr=${ethaddr} ${mtdparts}<br />flash_flash=run flashargs addip addmisc;bootm ${kernel_addr}<br />flash_nfs=run nfsargs addip addmisc;bootm ${kernel_addr}<br />net_flash=run load_kernel flashargs addip addmisc;bootm ${ram_addr}<br />net_nfs=run load_kernel nfsargs addip addmisc;bootm ${ram_addr}<br />load_kernel=tftp ${ram_addr} ${tftppath}openwrt-ifxmips-uImage<br />update_uboot=tftp 0x80500000 ${tftppath}u-boot-ARV4518PW.bin;era 0xb0000000 +${filesize};cp.b 0x80500000 0xb0000000 ${filesize}<br />update_openwrt=tftp ${ram_addr} ${tftppath}ARV4518PW-squashfs.image;era ${kernel_addr} +${filesize};cp.b ${ram_addr} ${kernel_addr} ${filesize}<br />stdin=serial<br />stdout=serial<br />stderr=serial<br />ethaddr=00:22:2d:3e:84:60<br />ethact=lq_cpe_eth<br />ver=U-Boot 2010.03 (Jul 12 2011 - 17:03:19)<br />bootargs=rootfstype=squashfs,jffs2 ip=192.168.1.1:192.168.1.101:192.168.1.254:255.255.255.0:::off init=/etc/preinit console=ttyS1,115200 ethaddr=00:22:2d:3e:84:60</p><p>Environment size: 1432/65532 bytes</p></blockquote></div><p>Which is nonsense for me. Why would kernel_addr=0xb0020000 if openwrt image&#039;s linux considers this same address to be uboot_env? (which made me flash it twice. At first I flashed it to 0xb0020000 going by kernel_addr on uboot and since it was safe per brnboot-obtained knowledge of the flash layout, then got the &quot;can&#039;t find uImage&quot; problem and saw linux&#039;s opinion on flash layout on the logs). Likely this is because it&#039;s the u-boot brnboot version, rather than the flashable one.</p><p>Anyway, things seem under control now and I&#039;m pretty happy about it <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />.</p><p>Tomorrow I might make the effort and write some documentation for the device on the wiki. I had to do a lot of documentation digging and guesswork to get here, which I consider criminal. Only one person should ever need to do so and then he should write proper documentation for those that come next!.</p><p>Gonna flash the real u-boot on the bootloader area now. Let&#039;s hope that goes well <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" />.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p138994">
				<div class="post-metadata">
					<div class="post-num">Post #432</div>
					<div class="post-author">rvalles</div>
					<div class="post-datetime">
						12 Jul 2011, 21:37					</div>
				</div>
				<div class="post-content content">
					<p>uh-oh. That&#039;s not so easy.<br /></p><div class="codebox"><pre><code>33055837   64 -rw-r--r--   1 rvalles  rvalles     65536 jul 12 17:03 ./uboot-lantiq-arv4518PW_flash/u-boot-bootstrap.bin
33055618  128 -rw-r--r--   1 rvalles  rvalles    131072 jul 12 17:03 ./uboot-lantiq-arv4518PW_brnboot/u-boot.bin
33055839  248 -rw-r--r--   1 rvalles  rvalles    250299 jul 12 17:04 ./uboot-lantiq-arv4518PW_ramboot/u-boot.asc
33055621  128 -rw-r--r--   1 rvalles  rvalles    131072 jul 12 17:04 ./uboot-lantiq-arv4518PW_ramboot/u-boot.bin</code></pre></div><p>Just what is this u-boot-bootstrap.bin? Why is it not 128KB? Where&#039;s my flashable u-boot? <img src="https://forum.openwrt.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p138997">
				<div class="post-metadata">
					<div class="post-num">Post #433</div>
					<div class="post-author">pippolippi</div>
					<div class="post-datetime">
						12 Jul 2011, 22:22					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>rvalles wrote:</cite><blockquote><p>Just what is this u-boot-bootstrap.bin? Why is it not 128KB? Where&#039;s my flashable u-boot? <img src="https://forum.openwrt.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /></p></blockquote></div><p>No idea, I just built it and I got the same <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /><br />Keep in mind that the posts I pointed you to were made at a time when arv4518 patches weren&#039;t in openwrt, so at the time I built u-boot with ngp&#039;s patches plus mine (for the arv7518). What got merged later maybe is different.</p><p>Edit: there&#039;s an u-boot.bin in the build dir, trunk/build_dir/linux-lantiq_xway/u-boot-2010.03/arv4518PW_flash, don&#039;t know the difference between the plain version and the bootstrap one.</p><p>Edit2: this is from a checkout previous to the latest rename (TPTB enjoy renaming this platform more than fixing issues) so the path may be different now.</p>											<p class="post-edited">(Last edited by <strong>pippolippi</strong> on 12 Jul 2011, 22:31)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p138999">
				<div class="post-metadata">
					<div class="post-num">Post #434</div>
					<div class="post-author">rvalles</div>
					<div class="post-datetime">
						12 Jul 2011, 22:34					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>pippolippi wrote:</cite><blockquote><div class="quotebox"><cite>rvalles wrote:</cite><blockquote><p>Just what is this u-boot-bootstrap.bin? Why is it not 128KB? Where&#039;s my flashable u-boot? <img src="https://forum.openwrt.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /></p></blockquote></div><p>No idea, I just built it and I got the same <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /><br />Keep in mind that the posts I pointed you to were made at a time when arv4518 patches weren&#039;t in openwrt, so at the time I built u-boot with ngp&#039;s patches plus mine (for the arv7518). What got merged later maybe is different.</p><p>Edit: there&#039;s an u-boot.bin in the build dir, trunk/build_dir/linux-lantiq_xway/u-boot-2010.03/arv4518PW_flash, don&#039;t know the difference between the plain version and the bootstrap one.</p><p>Edit2: this is from a checkout previous to the latest rename (TPTB enjoy renaming this platform more than fixing issues) so the path may be different now.</p></blockquote></div><p>Yeah.<br />-rwxr-xr-x&nbsp; 1 rvalles rvalles 115944 12 jul 17:03 u-boot.bin<br />Gonna try and flash that now. Fingers crossed. I&#039;ll use uboot to flash it, as tftp feels more reliable than the xmodem thingy. If it doesn&#039;t work, it&#039;ll be time to have fun with the UART boot.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p139000">
				<div class="post-metadata">
					<div class="post-num">Post #435</div>
					<div class="post-author">pippolippi</div>
					<div class="post-datetime">
						12 Jul 2011, 22:36					</div>
				</div>
				<div class="post-content content">
					<p>Wait a moment and read here:<br /><a href="http://www.mail-archive.com/u-boot@lists.denx.de/msg43737.html">http://www.mail-archive.com/u-boot@list … 43737.html</a><br />maybe the u-boot-bootstrap.bin is the real thing.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p139001">
				<div class="post-metadata">
					<div class="post-num">Post #436</div>
					<div class="post-author">rvalles</div>
					<div class="post-datetime">
						12 Jul 2011, 23:00					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>pippolippi wrote:</cite><blockquote><p>Wait a moment and read here:<br /><a href="http://www.mail-archive.com/u-boot@lists.denx.de/msg43737.html">http://www.mail-archive.com/u-boot@list … 43737.html</a><br />maybe the u-boot-bootstrap.bin is the real thing.</p></blockquote></div><p>Yep. I&#039;m hoping the other image would have worked (by initialising the ram himself, I guess?). The bootstrap one definitely did.<br /></p><div class="codebox"><pre><code>ROM VER: 1.0.3
CFG 01
Read EEPROMX
 X


U-Boot 2010.03 (Jul 12 2011 - 17:03:36)

Board: ARV4518PW
SoC: Danube/Twinpass/Vinax-VE V1.3, DDR Speed 166 MHz, CPU Speed 333 MHz
DRAM:  64 MB
Flash:  4 MB
*** Warning - bad CRC, using default environment

Net:   
searching for rtl8306 switch ... found
lq_cpe_eth
Hit any key to stop autoboot:  0 
ARV4518 =&gt;  
ARV4518 =&gt; printenv
bootcmd=run flash_flash
bootdelay=2
baudrate=115200
loads_echo=
ipaddr=192.168.1.1
serverip=192.168.1.101
rootpath=&quot;/export&quot;
gatewayip=192.168.1.254
netmask=255.255.255.0
ram_addr=0x80500000
kernel_addr=0xb0020000
flashargs=setenv bootargs rootfstype=squashfs,jffs2
nfsargs=setenv bootargs root=/dev/nfs rw nfsroot=${serverip}:${rootpath} 
addip=setenv bootargs ${bootargs} ip=${ipaddr}:${serverip}:${gatewayip}:${netmask}:${hostname}:${netdev}:off
addmisc=setenv bootargs ${bootargs} init=/etc/preinit console=ttyS1,115200 ethaddr=${ethaddr} ${mtdparts}
flash_flash=run flashargs addip addmisc;bootm ${kernel_addr}
flash_nfs=run nfsargs addip addmisc;bootm ${kernel_addr}
net_flash=run load_kernel flashargs addip addmisc;bootm ${ram_addr}
net_nfs=run load_kernel nfsargs addip addmisc;bootm ${ram_addr}
load_kernel=tftp ${ram_addr} ${tftppath}openwrt-ifxmips-uImage
update_uboot=tftp 0x80500000 ${tftppath}u-boot-ARV4518PW.bin;era 0xb0000000 +${filesize};cp.b 0x80500000 0xb0000000 ${filesize}
update_openwrt=tftp ${ram_addr} ${tftppath}ARV4518PW-squashfs.image;era ${kernel_addr} +${filesize};cp.b ${ram_addr} ${kernel_addr} ${filesize}
stdin=serial
stdout=serial
stderr=serial
ethaddr=00:22:2d:3e:84:60
ethact=lq_cpe_eth
ver=U-Boot 2010.03 (Jul 12 2011 - 17:03:36)

Environment size: 1269/65532 bytes
ARV4518 =&gt; saveenv
Saving Environment to Flash...
Un-Protected 1 sectors
Erasing Flash...
. done
Erased 1 sectors
Writing to Flash... 9....8....7....6....5....4....3....2....1....done
Protected 1 sectors
ARV4518 =&gt; md 0xb0010000
b0010000: edb22872 626f6f74 636d643d 72756e20    ..(rbootcmd=run 
b0010010: 666c6173 685f666c 61736800 626f6f74    flash_flash.boot
b0010020: 64656c61 793d3200 62617564 72617465    delay=2.baudrate
b0010030: 3d313135 32303000 6c6f6164 735f6563    =115200.loads_ec
b0010040: 686f3d00 69706164 64723d31 39322e31    ho=.ipaddr=192.1
b0010050: 36382e31 2e310073 65727665 7269703d    68.1.1.serverip=
b0010060: 3139322e 3136382e 312e3130 3100726f    192.168.1.101.ro
b0010070: 6f747061 74683d22 2f657870 6f727422    otpath=&quot;/export&quot;
b0010080: 00676174 65776179 69703d31 39322e31    .gatewayip=192.1
b0010090: 36382e31 2e323534 006e6574 6d61736b    68.1.254.netmask
b00100a0: 3d323535 2e323535 2e323535 2e300072    =255.255.255.0.r
b00100b0: 616d5f61 6464723d 30783830 35303030    am_addr=0x805000
b00100c0: 3030006b 65726e65 6c5f6164 64723d30    00.kernel_addr=0
b00100d0: 78623030 32303030 3000666c 61736861    xb0020000.flasha
b00100e0: 7267733d 73657465 6e762062 6f6f7461    rgs=setenv boota
b00100f0: 72677320 726f6f74 66737479 70653d73    rgs rootfstype=s</code></pre></div><p>And I guess it uses 64KB from 0xb0010000 to hold the config. Now I suppose I could flash openwrt on 0xb0020000. However, I&#039;m guessing the openwrt kernel will still look at 0xb0030000 instead, thinking that u-boot is 128KB + 64KB config. Gonna explore openwrt&#039;s menuconfig to see if I can find a way to convince it of otherwise.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p139002">
				<div class="post-metadata">
					<div class="post-num">Post #437</div>
					<div class="post-author">pippolippi</div>
					<div class="post-datetime">
						12 Jul 2011, 23:07					</div>
				</div>
				<div class="post-content content">
					<p>I think you could change the flash layout in mach-arv45xx.c (static struct mtd_partition arv45xx_partitions[] ) but I think it&#039;s possible to pass the real flash layout from u-boot as a kernel parameter. Not really sure about it though.</p>											<p class="post-edited">(Last edited by <strong>pippolippi</strong> on 13 Jul 2011, 00:22)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p139004">
				<div class="post-metadata">
					<div class="post-num">Post #438</div>
					<div class="post-author">rvalles</div>
					<div class="post-datetime">
						12 Jul 2011, 23:10					</div>
				</div>
				<div class="post-content content">
					<p>And I can&#039;t seem to find that in the menuconfig. Grepped around for 30000 without much success either.</p><p>I&#039;m tired and I work tomorrow, so I&#039;ll be going to sleep. If you happen to know how to tell the kernel where the uImage is so that it can find the subpartitions, poke me.</p><p>Tomorrow I&#039;ll put some docs on the wiki. For what it&#039;s worth, I have a few notes on my local wiki already. I&#039;m hoping they&#039;ll be of use to somebody.</p><p>Also, these board configs really need to find their way to u-boot&#039;s git.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p139010">
				<div class="post-metadata">
					<div class="post-num">Post #439</div>
					<div class="post-author">pippolippi</div>
					<div class="post-datetime">
						13 Jul 2011, 00:18					</div>
				</div>
				<div class="post-content content">
					<p>No, not in menuconfig, but changing the layout of the flash in the source I told you (mach-arv45xx.c).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p139026">
				<div class="post-metadata">
					<div class="post-num">Post #440</div>
					<div class="post-author">rvalles</div>
					<div class="post-datetime">
						13 Jul 2011, 06:14					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>pippolippi wrote:</cite><blockquote><p>No, not in menuconfig, but changing the layout of the flash in the source I told you (mach-arv45xx.c).</p></blockquote></div><p>Bleh, I was so tired I never noticed that post while I was writing the other. Thanks a lot.</p>											<p class="post-edited">(Last edited by <strong>rvalles</strong> on 13 Jul 2011, 06:17)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p139072">
				<div class="post-metadata">
					<div class="post-num">Post #441</div>
					<div class="post-author">rvalles</div>
					<div class="post-datetime">
						13 Jul 2011, 20:55					</div>
				</div>
				<div class="post-content content">
					<div class="codebox"><pre><code>static struct mtd_partition arv45xx_partitions[] =
{
        {
                .name   = &quot;uboot&quot;,
                .offset = 0x0,
                .size   = 0x10000,
        },
        {
                .name   = &quot;uboot_env&quot;,
                .offset = 0x10000,
                .size   = 0x10000,
        },
        {
                .name   = &quot;linux&quot;,
                .offset = 0x20000,
                .size   = 0x3d0000,
        },
        {
                .name   = &quot;board_config&quot;,
                .offset = 0x3f0000,
                .size   = 0x10000,
        },
};</code></pre></div><p>And things are fine, openwrt is happy and spacey <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" />.</p><p>If I destroy board_config, system hangs when trying to init the wireless chip, so I guess there&#039;s some relevant firmware stored there or sth. It&#039;s good I made a backup before testing.</p><p>Wrote some env macros to flash stuff from tftp on u-boot. So convenient!</p>											<p class="post-edited">(Last edited by <strong>rvalles</strong> on 13 Jul 2011, 20:57)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p139074">
				<div class="post-metadata">
					<div class="post-num">Post #442</div>
					<div class="post-author">pippolippi</div>
					<div class="post-datetime">
						13 Jul 2011, 21:42					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>rvalles wrote:</cite><blockquote><p>If I destroy board_config, system hangs when trying to init the wireless chip, so I guess there&#039;s some relevant firmware stored there or sth. It&#039;s good I made a backup before testing.</p></blockquote></div><p>Yes, it&#039;s good: that&#039;s where the calibration data, as well as the system mac, resides, and (supposedly) each individual router has its own.</p><div class="quotebox"><blockquote><p>Wrote some env macros to flash stuff from tftp on u-boot. So convenient!</p></blockquote></div><p>Another &quot;trick&quot; is that the image has a built-in kernel command line, and ignores the command line from u-boot.<br />To avoid that, edit the Makefile in the image subdirectory, and remove the leading dash from &quot;xway_cmdline&quot;, i.e, from<br /></p><div class="codebox"><pre><code>xway_cmdline=-console=ttyLTQ1,115200 rootfstype=squashfs,jffs2</code></pre></div><p>to<br /></p><div class="codebox"><pre><code>xway_cmdline=console=ttyLTQ1,115200 rootfstype=squashfs,jffs2</code></pre></div><p>Another &quot;brilliant&quot; idea that took me an afternoon to find, wondering why oh why my carefully crafted command line parameters weren&#039;t working <img src="https://forum.openwrt.org/img/smilies/mad.png" width="15" height="15" alt="mad" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p139077">
				<div class="post-metadata">
					<div class="post-num">Post #443</div>
					<div class="post-author">rvalles</div>
					<div class="post-datetime">
						13 Jul 2011, 22:28					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>pippolippi wrote:</cite><blockquote><div class="quotebox"><cite>rvalles wrote:</cite><blockquote><p>If I destroy board_config, system hangs when trying to init the wireless chip, so I guess there&#039;s some relevant firmware stored there or sth. It&#039;s good I made a backup before testing.</p></blockquote></div><p>Yes, it&#039;s good: that&#039;s where the calibration data, as well as the system mac, resides, and (supposedly) each individual router has its own.</p><div class="quotebox"><blockquote><p>Wrote some env macros to flash stuff from tftp on u-boot. So convenient!</p></blockquote></div><p>Another &quot;trick&quot; is that the image has a built-in kernel command line, and ignores the command line from u-boot.<br />To avoid that, edit the Makefile in the image subdirectory, and remove the leading dash from &quot;xway_cmdline&quot;, i.e, from<br /></p><div class="codebox"><pre><code>xway_cmdline=-console=ttyLTQ1,115200 rootfstype=squashfs,jffs2</code></pre></div><p>to<br /></p><div class="codebox"><pre><code>xway_cmdline=console=ttyLTQ1,115200 rootfstype=squashfs,jffs2</code></pre></div><p>Another &quot;brilliant&quot; idea that took me an afternoon to find, wondering why oh why my carefully crafted command line parameters weren&#039;t working <img src="https://forum.openwrt.org/img/smilies/mad.png" width="15" height="15" alt="mad" /></p></blockquote></div><p>Good to know. I&#039;ll go to sleep now (have to wake up for work...) and guess I&#039;ll copyedit my localwiki page about the router into openwrt&#039;s wiki tomorrow.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p139139">
				<div class="post-metadata">
					<div class="post-num">Post #444</div>
					<div class="post-author">rvalles</div>
					<div class="post-datetime">
						14 Jul 2011, 20:30					</div>
				</div>
				<div class="post-content content">
					<p>Created a wiki entry for it:<br /><a href="http://wiki.openwrt.org/toh/arv4518pw">http://wiki.openwrt.org/toh/arv4518pw</a></p><p>And added to the hardware / work in progress list as astoria - arv4518.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p139147">
				<div class="post-metadata">
					<div class="post-num">Post #445</div>
					<div class="post-author">dp79</div>
					<div class="post-datetime">
						14 Jul 2011, 23:12					</div>
				</div>
				<div class="post-content content">
					<p>All,</p><p>Thanks a lot for all your efforts on this hardware. I&#039;m trying to follow this thread by reading it frequently and hoping that once I will be able to flash mine with a working image. As I see we have reached a milestone, many thanks for all the contributors on that.<br />I see that there are new ARV4518PW images in the trunk section, and now we have a tutorial on how to flash uboot. How far are we from the stage where we will be able to flash a working image with uboot to the device?</p><p>dp79</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p139153">
				<div class="post-metadata">
					<div class="post-num">Post #446</div>
					<div class="post-author">rvalles</div>
					<div class="post-datetime">
						15 Jul 2011, 00:33					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dp79 wrote:</cite><blockquote><p>All,</p><p>Thanks a lot for all your efforts on this hardware. I&#039;m trying to follow this thread by reading it frequently and hoping that once I will be able to flash mine with a working image. As I see we have reached a milestone, many thanks for all the contributors on that.<br />I see that there are new ARV4518PW images in the trunk section, and now we have a tutorial on how to flash uboot. How far are we from the stage where we will be able to flash a working image with uboot to the device?</p><p>dp79</p></blockquote></div><p>You can already, and it&#039;s working to some decent degree. It&#039;s just maybe a little harder than necessary for non-devs. If you&#039;re adventurous, you could manage with the wiki page I just created and skimming through the thread.</p>											<p class="post-edited">(Last edited by <strong>rvalles</strong> on 15 Jul 2011, 00:33)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p139180">
				<div class="post-metadata">
					<div class="post-num">Post #447</div>
					<div class="post-author">dp79</div>
					<div class="post-datetime">
						15 Jul 2011, 14:04					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I think I will give it a try, I just need some clarifications. I see you&#039;ve created a list of the from to memory addresses for each mtd blocks. So how do I delete (or overwrite) the old brn boot loader? I have an usb 3.3V serial programmer cabel and lets say I &#039;ve aleady soldered it to the appropriate pins. What&#039;s next? I assume, I just need an app for serial communication and erase the bootloader part of the flash and write the new one. Or should I repartition the Flah using the memory addresses you&#039;ve posted on your wiki and then write the bootloader to 0x0 - 0x10000? Once I can get uboot on, I think I will be able to get the flash on by myself. So let&#039;s say I have the serial connection estabilished with the device....Could you give me the list of commands I need to run and the name of the app for the serial comm?</p><p>Many thanks ahead!</p><p>&nbsp; &nbsp; dp79</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p139194">
				<div class="post-metadata">
					<div class="post-num">Post #448</div>
					<div class="post-author">rvalles</div>
					<div class="post-datetime">
						15 Jul 2011, 19:38					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dp79 wrote:</cite><blockquote><p>Hi,</p><p>I think I will give it a try, I just need some clarifications. I see you&#039;ve created a list of the from to memory addresses for each mtd blocks. So how do I delete (or overwrite) the old brn boot loader? I have an usb 3.3V serial programmer cabel and lets say I &#039;ve aleady soldered it to the appropriate pins. What&#039;s next? I assume, I just need an app for serial communication and erase the bootloader part of the flash and write the new one. Or should I repartition the Flah using the memory addresses you&#039;ve posted on your wiki and then write the bootloader to 0x0 - 0x10000? Once I can get uboot on, I think I will be able to get the flash on by myself. So let&#039;s say I have the serial connection estabilished with the device....Could you give me the list of commands I need to run and the name of the app for the serial comm?</p><p>Many thanks ahead!</p><p>&nbsp; &nbsp; dp79</p></blockquote></div><p>Did update the wiki a little. About &quot;how to&quot;, first of all make a backup of everything. Ideally, write down the original flash layout somewhere, and backup your flash by sections, on separate files. Then backup those files, just in case. Secondly, use brnboot to load u-boot (the image that&#039;s for brnboot) from uart into ram via xmodem and then to jump to it.</p><p>Once in u-boot, assuming it works fine as it should, you&#039;d use printenv/setenv to set network config to something that suits your needs, tftp to download the burnable 64KB u-boot into ram, then crc32 to make sure what you have is correct.</p><p>Following that is the dangerous part: protect off all, erase, cp.b. Read u-boot documentation for details on how to do it.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p139196">
				<div class="post-metadata">
					<div class="post-num">Post #449</div>
					<div class="post-author">pippolippi</div>
					<div class="post-datetime">
						15 Jul 2011, 19:58					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>rvalles wrote:</cite><blockquote><p>Did update the wiki a little. About &quot;how to&quot;, first of all make a backup of everything. Ideally, write down the original flash layout somewhere, and backup your flash by sections, on separate files.</p></blockquote></div><p>Using, e.g., <a href="http://code.google.com/p/brndumper/">brndumper</a></p><div class="quotebox"><cite>rvalles wrote:</cite><blockquote><p>Then backup those files, just in case. Secondly, use brnboot to load u-boot (the image that&#039;s for brnboot) from uart into ram via xmodem and then to jump to it.</p></blockquote></div><p>IIRC brnboot-uboot is hardcoded to work at a specific ram address, 0x80200000?</p><div class="quotebox"><cite>rvalles wrote:</cite><blockquote><p>Once in u-boot, assuming it works fine as it should, you&#039;d use printenv/setenv to set network config to something that suits your needs, tftp to download the burnable 64KB u-boot into ram, then crc32 to make sure what you have is correct.</p><p>Following that is the dangerous part: protect off all, erase, cp.b.</p></blockquote></div><p>To the address where the original bootloader was (0xB0000000).</p><div class="quotebox"><cite>rvalles wrote:</cite><blockquote><p>Read u-boot documentation for details on how to do it.</p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p139366">
				<div class="post-metadata">
					<div class="post-num">Post #450</div>
					<div class="post-author">esplinter</div>
					<div class="post-datetime">
						18 Jul 2011, 17:19					</div>
				</div>
				<div class="post-content content">
					<p>hi,</p><p>I have a SMC7908A (from ya.com) and I have seen some image files for this device have been published with the latest RC5 but after reading the wiki entry it´s not clear for me how to test this image files.</p><p>Is safe to try this images without a serial console cable attached to the device? Could I flash the image file named &quot;openwrt-lantiq-danube-ARV4518PW-squashfs.image&quot; using the original web interface to get a openwrt working? Or maybe I should flash using tftp? (haven´t seen anything tftp flashing in the wiki)</p><p>Or maybe I should be patient and wait for a stable release ready for final user? <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>many thanks for any help.</p>									</div>
			</article>

			
		
						<div class="notice">
				<p>Sorry, posts 451 to 450 are missing from our archive.</p>
			</div>
		
		
	
	<div class="pagination"><div class="pagination-number">Page 18 of 40</div><nav><ul><li><a href="viewtopic.php%3Fid=15934&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=15934&amp;p=16.html">16</a></li><li><a href="viewtopic.php%3Fid=15934&amp;p=17.html">17</a></li><li class="pagination-current"><span>18</span></li><li><a href="viewtopic.php%3Fid=15934&amp;p=19.html">19</a></li><li><a href="viewtopic.php%3Fid=15934&amp;p=20.html">20</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=15934&amp;p=40.html">40</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0.001 -->

</body>
</html>