<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Custom x86 Image (NO LONGER MAINTAINED)</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 6 Sep 2015 and 6 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 17</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=35887&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=35887&amp;p=3.html">3</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=35887&amp;p=17.html">17</a></li></ul></nav></div>
			
		
		
			<article class="post" id="p162783">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						1 Apr 2012, 00:16					</div>
				</div>
				<div class="post-content content">
					<p><strong>Due to the real world and lack of free time this project is defunct. Sources / releases will remain mirrored for the time being.</strong></p><p>I have put together a custom x86 image for machines that boast a bit more power than the standard ALIX / Soekris / similar platforms.&nbsp; I have tweaked the base x86 kernel to include SMP up to 4Gb ram support, btrfs support and a few other niceties that can be used with more powerful cpu / ram combinations.&nbsp; The primary goal was to be able to fully utilize my Atom 1.8ghz dual core processor and 2Gb ram with a solid filesystem (ext4 + journal / btrfs).&nbsp; Another goal was to replace pfSense as my router&#039;s distribution which I have been using due to nut and newer zabbix packages.&nbsp; I have added 3 custom packages to the OpenWRT including nut, ca-certificates and a more recent version of zabbix.</p><p>Full details can be found on the project page and the image can be downloaded from the download page (both linked below).&nbsp; I am new to the OpenWRT build process so there are some outstanding cleanup items left to address.&nbsp; Please let me know what you think.</p><p><strong>Project Page/Sources/Tracker:</strong> <a href="https://bitbucket.org/nuskunetworks/nnopenwrt">https://bitbucket.org/nuskunetworks/nnopenwrt</a><br /><strong>Version:</strong> 2014-03-09 -- r64cee057a24a93167009126dbd35c86e486d5dc1<br /><strong>Primary mirror:</strong> <a href="https://nusku.net/openwrt/">https://nusku.net/openwrt/</a><br /><strong>Secondary mirror:</strong> <a href="https://nuskunetworks.box.com/s/9a4248d4f94a59ee1201">https://nuskunetworks.box.com/s/9a4248d4f94a59ee1201</a></p><p><strong>Changelog</strong><br /></p><div class="codebox"><pre><code>Resync with upstream
Updated to include PAM 1.1.3 from Debian
Enabled PAM by default
Added usb-ip kernel packages (per forum request)
Added ppp RFC 4638 patch (per forum request)
Packaged yubico-c and yubico-client
Enabled curl package
Enabled nmap packages (per forum request)
Enabled iperf packages (per forum request)
Enabled ncat packages (per forum request)
Enabled ndiff package (per forum request)
Enabled nping package (per forum request)</code></pre></div>											<p class="post-edited">(Last edited by <strong>mcrosson</strong> on 16 Jul 2014, 06:55)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p163125">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">janptak</div>
					<div class="post-datetime">
						3 Apr 2012, 08:34					</div>
				</div>
				<div class="post-content content">
					<p>Huh, great idea!</p><p>For now I have fully configured openwrt on wdnr3700 router but lately I was looking for expanding its capabilities by changing platform to x86. Ive found quite nice foxconn 3500 nettop - it has wifi, 1Gb lan, 4 usb etc. Ill try to install Your image to see if its working.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p163151">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						3 Apr 2012, 15:20					</div>
				</div>
				<div class="post-content content">
					<p>Do you plan on using a USB wired network adapter or USB WiFi adapter with the WNDR3700 replacement?&nbsp; I am not sure, but I may have omitted the USB networking drivers from my build.&nbsp; I will double check and include the USB networking drivers if you think you may need them.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p166902">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						9 May 2012, 20:13					</div>
				</div>
				<div class="post-content content">
					<p>I will definitely be needing them at least in the short term.</p><p>I&#039;m planning to run this on my Atom D525 with the ultimate goal of updating to a more suitable board and case later (one where I can actually use a second ethernet card rather than USB which I will need for now).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p166903">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						9 May 2012, 20:16					</div>
				</div>
				<div class="post-content content">
					<p>I am working on getting an updated build going that will include various USB network drivers (wifi / wired) as packages.&nbsp; Unfortunately I have been having troubles getting a clean build from the trunk.&nbsp; Hopefully I will meet with success soon.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p166920">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						9 May 2012, 22:47					</div>
				</div>
				<div class="post-content content">
					<p>For reference, I am thinking of using this <a href="http://www.mini-box.com/I-O-shield-and-riser-card-for-DN2800MT">http://www.mini-box.com/I-O-shield-and- … r-DN2800MT</a> as that should allow me to put in a 5Ghz WiFi card, 2.4Ghz WiFi card and a second ethernet card. (although fat chance of me getting a 5Ghz card with the right regulatory domain flashed on it)</p><p>It sucks that all the Atom boards with dual gigabit ethernet built-in cost about three to four times the price.&nbsp; But I BADLY need to get away from the crappy Realtek 8111E ethernet chipset, it just doesn&#039;t work right in Linux.&nbsp; Its fine unless the link goes down, then its impossible to get the link back up without a full power cycle.&nbsp; Not a very good bug to have on a router.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p166922">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						9 May 2012, 23:12					</div>
				</div>
				<div class="post-content content">
					<p>That is the motherboard I was considering upgrading to from my current Atom board.&nbsp; I ended up going with a PCI to MiniPCI adapter for the second wifi controller since I can get enough bandwidth out of the PCI bus for a 2x2 wireless card and a DSL WAN connection.&nbsp; </p><p>One issue I ran into recently was the Atheros 9220 MiniPCI card I just purchased does not want to work in host ap mode at all.&nbsp; My pre-existing Ath 9382 (mini-pci express) works fine though.&nbsp; It looks like the drivers may be the issue.&nbsp; I am working on this item as part of my updated build.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p167027">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						10 May 2012, 23:08					</div>
				</div>
				<div class="post-content content">
					<p>I ordered the Intel DN2800MT today.&nbsp; Might not have if I wasn&#039;t having such huge problems with the Realtek ethernet not coming up properly on boot and failing outright if the link drops - which obviously might happen if the modem reboots.</p><p>I&#039;m torn between just sticking Mageia on it or your build of OpenWRT.&nbsp; The issue is the power management supposedly only works optimally in the very latest kernel versions and I am thinking its almost guaranteed I will end up putting a lot of server junk on it with it being mostly overkill for router hardware.&nbsp; No point having a second server running 24/7 if I can move everything over onto a single box and that is likely easier with a full distro.&nbsp; I might even keep Xorg on it in which case I HAVE to use kernel 3.3+ as the GPU is not supporting on anything older.</p><p>Of course there are big pros for OpenWRT too.&nbsp; The main one being it would be a quick and painless process to copy over the configuration from my Buffalo.&nbsp; The second one being its optimised for remote configuration via the web browser, I&#039;m not sure of anything remotely comparable for a normal distro, although I suppose it could be a project for me to write my own GUI in PHP for it.</p><p>My biggest bugbear is trying to understand iptables though.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p167031">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						10 May 2012, 23:46					</div>
				</div>
				<div class="post-content content">
					<p>I would shy away from my OpenWRT build if you are going to be doing general server stuff like Apache / PHP / MySQL and the like.&nbsp; I am focused on the router end of the spectrum.&nbsp; </p><p>I do know that the DN2800MT would make a great router or a light weight server machine.&nbsp; I am using a dual-core 2.0ghz atom board as a server along with a 1.6ghz atom for my router.&nbsp; The only &quot;problem&quot; I&#039;ve had is the atom can be a little slow when PostgreSQL has to process a large, complex query.</p><p>Also do not forget about potentially running LuCI from within a full distribution.&nbsp; I looked at doing that initially but decided building OpenWRT would be easier given I know nothing of Lua, but I know how to build a Linux box from scratch thanks to using Gentoo all these years.</p>											<p class="post-edited">(Last edited by <strong>mcrosson</strong> on 10 May 2012, 23:48)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p167531">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						16 May 2012, 23:43					</div>
				</div>
				<div class="post-content content">
					<p>I have just published an updated version that is built on r31743 of SVN.&nbsp; This includes a number of updated packages.&nbsp; I have yet to figure out a good way to upgrade all of the packages in-place.&nbsp; For now the standard re-install the image from scratch method is the recommended upgrade path for this build.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p167806">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						21 May 2012, 01:31					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m stuck between a rock and a hard place, because I&#039;m going to need to patch my kernel or rethink things.&nbsp; </p><p>I really wanted to move my Intranet onto the router so that I do not have the current cumbersome configuration of the server probing the router for stats, which in turn probes the modem.&nbsp; Its hard keeping everything working nicely when any of the three gets rebooted as no matter how hard I try to catch the monitoring scripts hanging, I can&#039;t seem to prevent it.</p><p>I really was hoping not to have to stray from distro provided packages but I now realise that if I want to use IMQ, I have no choice.&nbsp; In their infinite wisdom the Linux kernel maintainers feel IMQ should not be implemented at kernel level so it seems its only obtainable by patching the kernel source and compiling your own.&nbsp; Despite the fact its impossible to achieve the same functionality in user space.</p><p>There really does seem to be some bloody mindedness when it comes to the kernel stuff, this is not the first I have run into problems getting things supported in a stock kernel.</p><p>No wonder its always been so hard to find routers supporting QoS.&nbsp; The thing is, QoS was one big reason for me to switch to an Atom as I wasn&#039;t convinced a MIPS CPU could comfortably handle QoS for a 100Mbit WAN connection.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p167872">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						21 May 2012, 23:03					</div>
				</div>
				<div class="post-content content">
					<p>I moved to an Atom for QoS myself.&nbsp; I turned on Layer 7 inspection and it definitely took more than the standard MIPS / Geode equipment to keep up.&nbsp; I stuck to the stock kernel QoS and the standard Layer 7 tools to achieve the QoS setup I wanted.&nbsp; I am not familiar with IMQ but if it is a set of kernel patches, you could go with a distro that lets you build your own kernel.&nbsp; I know Gentoo and Arch are a bit better about 3rd party kernel patch sets than most.&nbsp; Both are pretty competent distributions as well.&nbsp; Might be worth looking into for the setup you described.</p><p>You could potentially bring LuCI into Gentoo or Arch as well which would give you easier management of the routing functionality.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p167874">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						21 May 2012, 23:09					</div>
				</div>
				<div class="post-content content">
					<p>To make LuCI work on a normal distro you would need to rewrite the entire userland of the target distro to act like OpenWrt or rewrite the entire UI to cope with at least a dozen different config formats, init script flavors and distro management systems; either way - it would be be too complex to bother and far exceed the required effort to patch IMQ into OpenWrt.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p169473">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">doogie</div>
					<div class="post-datetime">
						9 Jun 2012, 00:31					</div>
				</div>
				<div class="post-content content">
					<p>Wanted to say &quot;thanks&quot; for this - I&#039;m watching closely, as OpenWrt definitely has the best wlan support I can find, and my feeble attempts to compile a better kernel for x86 have completely failed. Looking to replace my RSPro board soon with Atom (already have a DN2800MT here, in fact).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p169474">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">doogie</div>
					<div class="post-datetime">
						9 Jun 2012, 00:58					</div>
				</div>
				<div class="post-content content">
					<p>Got the DN2800MT up on the bench and it does boot! Haven&#039;t done much else with it, but --</p><p>Intel DN2800MT<br />SparkLAN WPEA-127N (Atheros AR9380) in the full-height miniPCIe slot<br />Intel Gigabit CT card in the PCIe x1 slot<br />Booting from 4GB USB flash drive</p><p>If you&#039;re interested, I put the kernel log here, <a href="https://www.atomicmonkey.org/nnopenwrt/dn2800mt-kernel-log.txt">https://www.atomicmonkey.org/nnopenwrt/ … el-log.txt</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p169475">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						9 Jun 2012, 01:05					</div>
				</div>
				<div class="post-content content">
					<p>My point is the QoS package for OpenWRT does EXACTLY what I want, prioritising by port.&nbsp; But I cannot for the life of me figure out if that is one of the things possible WITHOUT IMQ, as OpenWRT on my router IS using IMQ.</p><p>After reading up some more this seems to be a &quot;snag&quot; with trunk, its missing IMQ support yet official releases include it.</p><p>I&#039;m not having much luck with Mageia though (its a complete mess if you don&#039;t want a desktop, hostapd compiled without support for 802.11n being one example) so I&#039;m still looking at alternatives which brings me back to this project.</p><p>I mean sure I could compile fixes in manually, but that is not something you want to be doing on a router.&nbsp; You want to be able to install the latest security fixes with minimal risk of screwing things up because its the single most important part of the network.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p169493">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						9 Jun 2012, 11:14					</div>
				</div>
				<div class="post-content content">
					<p>Doogie: I&#039;m glad to see you got it booted.&nbsp; And thank you very much for the kernel log.&nbsp; It looks nearly identical to the kernel output I get on my configuration.&nbsp; I am running an Atom Mount Olive board with a SparkLAN.&nbsp; I have been successful in getting my SparkLAN setup as an access point in both 2.4ghz and 5ghz configurations.</p><p>I noticed there appears to be an oops / notice about the db.txt file linked in the wireless registry.&nbsp; I am aware of the &quot;problem&quot; and am working on solving it currently.&nbsp; It should not prevent the SparkLAN card from working in HostAP mode.&nbsp; Also, there are a few messages about module versions which I also receive.&nbsp; I believe this is related to me having some kernel modules selected in the OpenWRT main configuration which will install modules on top of what I have setup with a custom kernel.&nbsp; I am still working on understanding fully how the custom kernel stuff works and hopefully will have those notices taken care of soon.</p><p>I hope to have an updated build that addresses some of these points and others soon.&nbsp; I am waiting on a development board to arrive so I can do my testing on non-live equipment.&nbsp; My Fiancee was not pleased the last time I applied a test build to the live router at home....</p><p>Something that may not be immediately obvious in the build is that I set it up to work with btrfs root filesystems.&nbsp; I am currently using btrfs for my root filesystem so I can better manage the upgrade&nbsp; process.&nbsp; I discovered that OpenWRT&#039;s version of opkg will not update certain packages such as the kernel which prevents an in-place upgrade similar to what apt-get dist-upgrade on Debian does.&nbsp; The only way I found to upgrade the x86 builds of OpenWRT was to re-dd the disk image on top of the live install after running a backup or copying the rootfs.tar.gz image on top of the the live filesystem which can cause problems.&nbsp; Due to this I switched over to btrfs from ext4 so I could use the snapshot feature to do an in-place upgrade without losing my installed packages and configuration.&nbsp; I plan on writing a python program to automate the process and when it is complete I will be including it in the build.&nbsp; In the interim, I can post my btrfs based upgrade process if you are interested.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p169498">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						9 Jun 2012, 11:31					</div>
				</div>
				<div class="post-content content">
					<p>Alex: I had a similar issue that you are in terms of the alternatives to OpenWRT.&nbsp; They were half baked, poorly supported, designed for very light weight equipment such as the RouterBoard or designed for very high end equipment with Intel i7&#039;s, lots of ram and the like.&nbsp; I always seemed to come back to OpenWRT&#039;s x86 build despite it not fully utilizing my Atom hardware.&nbsp; I started this project so I could use OpenWRT and the advanced features of my Atom hardware such as &gt;128Mb ram, multiple cores and &quot;lots&quot; of expansion.&nbsp; I also want to smooth out some of the rough edges of the distribution on x86 as well.&nbsp; Things like upgrades, more features on packages (snort comes to mind) and additional packages such as ca-certificates from Debian (this is part of my build now).</p><br /><p>I am currently maintaining some patches and custom packages for my build of OpenWRT.&nbsp; If you have the patches and general information on enabling IMQ on the OpenWRT trunk and appropriate packages I can work on including them in my build.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p169531">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						9 Jun 2012, 17:52					</div>
				</div>
				<div class="post-content content">
					<p>The official patches are at <a href="http://www.linuximq.net">http://www.linuximq.net</a>/ but I would think though you need to know specifically how OpenWRT apply those patches so as to package them up so the dependencies pull in correctly.</p><p>opkg whatdepends kmod-ipt-imq<br />Root set:<br />&nbsp; kmod-ipt-imq<br />What depends on root set<br />&nbsp; &nbsp; &nbsp; &nbsp; iptables-mod-imq 1.4.6-3.1&nbsp; &nbsp; &nbsp; depends on kmod-ipt-imq<br />&nbsp; &nbsp; &nbsp; &nbsp; qos-scripts 1.2.1-3.2&nbsp; &nbsp;depends on iptables-mod-imq</p><p>opkg whatdepends qos-scripts<br />Root set:<br />&nbsp; qos-scripts<br />What depends on root set<br />&nbsp; &nbsp; &nbsp; &nbsp; luci-app-qos 0.10.0-1&nbsp; &nbsp;depends on qos-scripts</p><p>Other packages I want to use are mysql-server and mplayer.&nbsp; I am happy to compile those myself though if you can give me a tips on how to do so. (although I&#039;m betting its quicker to do it yourself than try to explain how)&nbsp; Oh and Java so I can run serviio on there.</p><p>That said, I would think its possible to use the standard x86 packages for none-kernel stuff?&nbsp; You would just be missing any SMP optimisations which I believe mplayer is still a strictly single-threaded app anyway due to it primarily being optimised to use the CPU cache for video decoding (I just want it to play audio files).</p><p>So you can see why I was trying to use a full distro, my usage falls just a little outside the realm of a typical router although OpenWRT itself has packages for all the above I believe apart from Java, which I would think is not too hard to get going as you just use the standard x86 version?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p169766">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						11 Jun 2012, 21:29					</div>
				</div>
				<div class="post-content content">
					<p>Alex: I will take a look at integrating the IMQ patches into the build.&nbsp; It may take me awhile as my time these days is very limited.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p170087">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						15 Jun 2012, 20:19					</div>
				</div>
				<div class="post-content content">
					<p>Is it possible to install your custom image on a USB stick in a read/write/bootable fashion?&nbsp; I see various instructions for getting OpenWRT on a USB stick but none of them seem particularly clear about or address using an ext4 partition for it.</p><p>I am thinking that would be the most quick and painless way to test it without overwriting the existing Mageia installation on the SSD.</p><p>That way I can also more easily test OpenWRT alongside different full distros and quickly fall back onto OpenWRT if everything goes wrong.&nbsp; Its just so hard trying to custom build a router like this because obviously you need a working router in the meantime but also to be able to test it as you go.&nbsp; Fortunately, I currently have several static IPs so I use this as a secondary router, but this will not be the case soon so testing will be problematic.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p170102">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						16 Jun 2012, 01:13					</div>
				</div>
				<div class="post-content content">
					<p>You can download the openwrt-x86-generic-rootfs-ext4.img.gz file for creating a USB stick that boots my build of OpenWRT.&nbsp; The img files contains a boot partition and ext4 root filesystem.&nbsp; From finnix / another distro you can easily run &quot;zcat &lt;img.gz&gt; | sudo dd of=/dev/sdusb bs=4M&quot; to write it out to the USB stick.</p><p>Note that I have built a custom kernel so you can boot OpenWRT off USB / IDE / SATA reliably.&nbsp; I had problems with sata and usb boot on the vanilla x86 OpenWRT images.</p><p>Also, bear in mind that the &quot;upgrade&quot; procedure for x86 OpenWRT is to re-write a new disk image.&nbsp; They have patched opkg so it will not upgrade some packages (ie. kernel).&nbsp; I am working on a process that will use btrfs snapshots to provider a better upgrade path than the default.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p170138">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						16 Jun 2012, 17:03					</div>
				</div>
				<div class="post-content content">
					<p>Not having much luck so far, generic-rootfs doesn&#039;t boot, generic-combined does but fails to find the root fs.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p170154">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						16 Jun 2012, 19:55					</div>
				</div>
				<div class="post-content content">
					<p>You are right: the generic-combined is the image necessary for booting.&nbsp; Sorry about that, I transposed the filenames I was looking at.</p><p>For your boot issue it is due to the grub.cfg, /etc/fstab or /etc/config/fstab file and the way OpenWRT uses the device node for mounting instead of label or UUID.&nbsp; It is likely the grub file causing the problem since OpenWRT does not appear to have a root filesystem entry in either fstab file that I see.&nbsp; </p><p>You can update the grub config from another Linux distro and the general steps for updating it are</p><p>1. Boot finnix / Ubuntu / Knoppix / other<br />2. mkdir /tmp/openwrt_boot<br />3. mount /dev/[sdx]1 # Where [sdx] is the OpenWRT drive and the 1 is the boot partition.<br />&nbsp; &nbsp; # The boot partition is contained in the combined image file<br />4. blkid | grep /dev/[sdx]1 # Replace [sdx] as you did in the above step<br />&nbsp; &nbsp; # This will give you the label / uuid / type of filesystem for the boot filesystem<br />5. [favorite_editor] /tmp/openwrt_boot/boot/grub/menu.lst<br />6. Change the &quot;root=/dev/sda2&quot; portion of the kernel lines to be similar to the following:<br />&nbsp; &nbsp; root=UUID=4e65d229-1bec-47e8-8807-2223513645b4 # The bits after UUID= should be changed to reflect the uuid you found<br />7. Reboot into OpenWRT</p><br /><br /><p>If this procedure does not fix booting OpenWRT let me know and if possible the error message you get after Grub attempts to boot.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p170189">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						17 Jun 2012, 18:37					</div>
				</div>
				<div class="post-content content">
					<p>I couldn&#039;t get it to boot using LABEL or UUID, only /dev/sdb2 would work.&nbsp; Support missing in the kernel maybe?</p><p>It also keeps auto mounting the /dev/sda3 partition for some odd reason, even though the USB stick is /dev/sdb.</p><p>Its annoying as I don&#039;t want /dev/sda mounting unless I can put the &quot;discard&quot; flag on there, or it will muck up the SSD garbage collection.</p><p>I&#039;m also puzzled why its showing 4 WiFi radios when there are only two cards in there.&nbsp; It seems to be picking up the dual a+g(n) support then duplicating them as g/n only cards.&nbsp; The duplicates do not work even if the first two are disabled though, probably due to the fact it seems to have fabricated the MAC addresses of the duplicates.</p>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 1 of 17</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=35887&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=35887&amp;p=3.html">3</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=35887&amp;p=17.html">17</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>