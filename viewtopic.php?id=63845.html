<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Unbound DNSMASQ from resolv.conf.auto</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 21 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p317665">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">taobaoDog</div>
					<div class="post-datetime">
						1 Apr 2016, 12:03					</div>
				</div>
				<div class="post-content content">
					<p>Hello all!</p><p>I need help how correct to configure dnsmasq not using resolv.conf.auto but setting own dns servers.<br />OpenVPN comes up and dns servers, that are pushed by VPN server, are not applied. <br />So for this purpose i want to set the dns servers direct to /etc/config/dhcp and unbind dnsmasq from resolv.conf.auto</p><p>/etc/config/dhcp</p><div class="codebox"><pre><code>config dnsmasq
        option domainneeded &#039;1&#039;
        option boguspriv &#039;1&#039;
        option filterwin2k &#039;0&#039;
        option localise_queries &#039;1&#039;
        option rebind_protection &#039;1&#039;
        option rebind_localhost &#039;1&#039;
        option local &#039;/wan/&#039;
        option domain &#039;wan&#039;
        option interface &#039;wan&#039;
        option expandhosts &#039;1&#039;
        option nonegcache &#039;0&#039;
        option authoritative &#039;1&#039;
        option readethers &#039;1&#039;
        option leasefile &#039;/tmp/dhcp.leases&#039;
        option port &#039;53&#039;
        option noresolv &#039;1&#039;
        list server &#039;98.158.112.60&#039;
        list server &#039;98.158.112.14&#039;</code></pre></div><p>then i restart dnsmasq and get <br /></p><div class="codebox"><pre><code>Fri Apr  1 04:39:05 2016 daemon.info dnsmasq[14333]: exiting on receipt of SIGTERM
Fri Apr  1 04:39:05 2016 daemon.info dnsmasq[14493]: started, version 2.73 cachesize 150
Fri Apr  1 04:39:05 2016 daemon.info dnsmasq[14493]: compile time options: IPv6 GNU-getopt no-DBus no-i18n no-IDN DHCP no-DHCPv6 no-Lua TFTP no-conntrack no-ipset no-auth no-DNSSEC loop-detect inotify
Fri Apr  1 04:39:05 2016 daemon.info dnsmasq[14493]: using nameserver 98.158.112.14#53
Fri Apr  1 04:39:05 2016 daemon.info dnsmasq[14493]: using nameserver 98.158.112.60#53
Fri Apr  1 04:39:05 2016 daemon.info dnsmasq[14493]: using local addresses only for domain wan
Fri Apr  1 04:39:05 2016 daemon.info dnsmasq[14493]: read /etc/hosts - 1 addresses
Fri Apr  1 04:39:05 2016 daemon.info dnsmasq[14493]: read /tmp/hosts/dhcp - 0 addresses</code></pre></div><p>But it seems not working.</p><p>Removing dns from /etc/config/network wan section gives nothing. </p><p><em>I have routed device running 15.05 OpenWrt with one WAN port. (LAN 192.168.0.5)<br />All hosts (LAN 192.168.0.XXX) forwarded to it must get services from it (vpn, dns, proxy ... etc)</em></p><p>I will be very thankful to any help!</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>