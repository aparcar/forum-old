<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> OpenWRT SVN for AR7 incompatible with a Linksys PAP2v2</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 23 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p69668">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						16 Jun 2008, 16:32					</div>
				</div>
				<div class="post-content content">
					<p>I compiled asterisk-1.4.21 on my OpenWRT SVN trunk for AR7 platform. Just for testing purposes, I copied the asterisk binary file compiled for AR7 platform to my Linksys PAP2v2 (also an AR7 platform) and it gives me the following error when I executed this asterisk binary for AR7 platform:<br /></p><div class="codebox"><pre><code># /var/tmp/asterisk 
/var/tmp/asterisk: 8: Syntax error: &quot;(&quot; unexpected</code></pre></div><p>How can I fix this?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p69677">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Wodin</div>
					<div class="post-datetime">
						16 Jun 2008, 19:58					</div>
				</div>
				<div class="post-content content">
					<p>Compile uClibc for the MIPS-I target and do the same for asterisk.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p69766">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						18 Jun 2008, 14:52					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Wodin wrote:</cite><blockquote><p>Compile uClibc for the MIPS-I target and do the same for asterisk.</p></blockquote></div><p>Can you please help me on how to do this? I could not find this option through <em>make menuconfig</em>.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p69791">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Wodin</div>
					<div class="post-datetime">
						18 Jun 2008, 20:33					</div>
				</div>
				<div class="post-content content">
					<p>I do not believe there is an option to do that through the OpenWrt build system. I did it before by compiling uclibc manually. In the menuconfig for uclibc there is an option to specify the target. Then when you compile asterisk you will probably have to edit the Makefile to specify the right gcc option. I can&#039;t remember the exact option.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p69801">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						19 Jun 2008, 00:18					</div>
				</div>
				<div class="post-content content">
					<p>IC your point and you are right that under the uClibc <em>make menuconfig</em>, there is an option to choose MIPS-I. I think this can be specified this through the main <em>make menuconfig</em>.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p69904">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">KillaB</div>
					<div class="post-datetime">
						21 Jun 2008, 08:09					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Wodin wrote:</cite><blockquote><p>I do not believe there is an option to do that through the OpenWrt build system. I did it before by compiling uclibc manually. In the menuconfig for uclibc there is an option to specify the target.</p></blockquote></div><p>Can the uClibc target not be set in the OpenWrt build system?<br />I have no clue personally, but would love to help test Asterisk on an RTP300 or PAP2v2.</p><p>The options I see in the OpenWrt build system are as follows:<br /></p><div class="quotebox"><blockquote><p>Advanced configuration options (for developers) ---&gt;<br />&nbsp; &nbsp; Toolchain Options ---&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; Enable an extra toolchain target architecture ---&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Extra architecture name</p></blockquote></div><div class="quotebox"><blockquote><p>Advanced configuration options (for developers) ---&gt;<br />&nbsp; &nbsp; &nbsp;Toolchain Options ---&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(-Os -pipe -mips32 -mtune=mips32 -funut-at-a-time) Target Optimizations</p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p69924">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">Wodin</div>
					<div class="post-datetime">
						22 Jun 2008, 05:04					</div>
				</div>
				<div class="post-content content">
					<p>That looks useful for the asterisk bit. Not sure about the uclibc bit. I don&#039;t know how the kamikaze build system interacts with the uclibc build system if at all. I am not near a kamikaze checkout at the moment. Anyway I think mazilo is trying to run it on the default firmware. Building for mips-I should not be necessary on openwrt.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p69932">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						22 Jun 2008, 17:12					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Wodin wrote:</cite><blockquote><p>That looks useful for the asterisk bit. Not sure about the uclibc bit. I don&#039;t know how the kamikaze build system interacts with the uclibc build system if at all.</p></blockquote></div><p>I compiled OpenWRT SV source for both MIPS-I and default (MIPS32). Their respective uClibc libraries are shown below to reflect their architectures:<br /></p><div class="codebox"><pre><code>libuClibc++-0.2.2.so: ELF 32-bit LSB shared object, MIPS, MIPS-I version 1 (SYSV), corrupted section header size
libuClibc++-0.2.2.so: ELF 32-bit MSB shared object, MIPS, version 1 (SYSV), corrupted section header size</code></pre></div><p>The compiled binary files also reflect to MIPS-I architecture.</p><div class="quotebox"><blockquote><p>Anyway I think mazilo is trying to run it on the default firmware.</p></blockquote></div><p>You are definitely right. I need to put asterisk on a Linksys WRTP54G/RTP300/PAP2v2 and/or a TI AR7 based VoIP device that mostly based on MIPS-I.</p><p>OT, does anyone here know what are the benefits of MIPS32 over MIPS-I? I know most TI AR7 based VoIP devices are based on a MIPS-I architecture. If OpenWRT is going to support any of these TI AR7 based VoIP devices, i.e. WRTP54G, why change to a MIPS32 architecture while the original firmware still runs on a MIPS-I architecture? If we stick with the same MIPS-I architecture, there is a chance we can still re-use the existing Linux kernel drivers for its FXS ports as well as the G729 binary CoDec.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p69940">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">Wodin</div>
					<div class="post-datetime">
						22 Jun 2008, 23:27					</div>
				</div>
				<div class="post-content content">
					<p>Not sure why you compiled the MIPS32 version as big endian, but the MIPS-I version looks right, I think.</p><p>(I thought we were talking about uClibc, not uClibc++, though <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>As for why OpenWrt doesn&#039;t compile for MIPS-I by default, I suppose it&#039;s because OpenWrt is supposed to be a Free and standalone distribution.&nbsp; Not a modified Linksys/whatever distribution.&nbsp; Since the hardware supports the MIPS32 instruction set, why not support it?&nbsp; Do you compile for i386 on your desktop? <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" />&nbsp; That&#039;s just my guess, though.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p69944">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						23 Jun 2008, 02:02					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Wodin wrote:</cite><blockquote><p>Not sure why you compiled the MIPS32 version as big endian, but the MIPS-I version looks right, I think.</p></blockquote></div><p>For MIPS32, I just used the default settings from OpenWRT SVN.</p><div class="quotebox"><blockquote><p>(I thought we were talking about uClibc, not uClibc++, though <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p></blockquote></div><p>You are right and we were talking about uClibc. I just quoted the wrong ones. Sorry about this.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>