<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> WRT1900 openwrt strange dns issue</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 8 Apr 2018 and 16 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 2 of 2</div><nav><ul><li><a href="viewtopic.php%3Fid=67757&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p339437">
				<div class="post-metadata">
					<div class="post-num">Post #26</div>
					<div class="post-author">alirz</div>
					<div class="post-datetime">
						28 Sep 2016, 03:56					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>davidc502 wrote:</cite><blockquote><p>If you could ssh into the router, run the following command</p><p>#passwd root</p><p>Then make a new password.</p></blockquote></div><br /><p>Thanks. I know i sound like a noob but im actually not. Quite familiar with linux.<br />I cant ssh unless i setup a password via luci. Telnet doesnt work, i guess its disabled.</p><p>I flashed my original openwrt build and factory reset it, i get the same issue with not being able to set password. If i restore my backup then the password comes back obviously from the backup.<br />However im trying to not restore my backup instead want to setup the router as brand new. But thats where my problem is.<br />Im cursing at this thing right now like never before <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>i know its over kill but does a USB TTL connection allow me change the password from console?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p339439">
				<div class="post-metadata">
					<div class="post-num">Post #27</div>
					<div class="post-author">alirz</div>
					<div class="post-datetime">
						28 Sep 2016, 04:00					</div>
				</div>
				<div class="post-content content">
					<p>Another new find.<br />With the default DNS server being my ISP&#039;s dns, my DDNS hostname resolves to an old WAN IP i used to have.<br />If i change the router to use google&#039;s DNS, the ddns resolves to the correct IP.</p><p>Is it possible that the ISP DNS has a cache where it believes my DDNS still has the old IP?</p><p>I guess i can test by connecting a computer directly to my modem and doing the lookup.</p>											<p class="post-edited">(Last edited by <strong>alirz</strong> on 28 Sep 2016, 04:13)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p339440">
				<div class="post-metadata">
					<div class="post-num">Post #28</div>
					<div class="post-author">Villeneuve</div>
					<div class="post-datetime">
						28 Sep 2016, 04:11					</div>
				</div>
				<div class="post-content content">
					<p>Re: Restoring the backup you don&#039;t want. You could do that, get in and run firstboot, to set back to defaults. Everything should be clean me thinks.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p339441">
				<div class="post-metadata">
					<div class="post-num">Post #29</div>
					<div class="post-author">alirz</div>
					<div class="post-datetime">
						28 Sep 2016, 04:13					</div>
				</div>
				<div class="post-content content">
					<p>Update: hooking up a computer directly to the mode and doing a lookup returns the correct ip. Keep in mind this is on an old openwrt build from like January of this year.<br />I have NOT been able to test DDNS host nslookup on a recent openwrt build</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p339444">
				<div class="post-metadata">
					<div class="post-num">Post #30</div>
					<div class="post-author">alirz</div>
					<div class="post-datetime">
						28 Sep 2016, 04:22					</div>
				</div>
				<div class="post-content content">
					<p>another question just for curiosity</p><p>when i do a nslookup why is the router not returning the first 2 lines with the correct info:</p><br /><p>root@OpenWrt:/home/ali# nslookup mydomain.changeip.org<br />Server:&nbsp; &nbsp; (null)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;---------------<br />Address 1: ::1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;---------------<br />Address 2: 127.0.0.1 localhost</p><p>Name:&nbsp; &nbsp; &nbsp; mydomain.changeip.org<br />Address 1: X.X.X.X.X modemcable0X.X-X-XX.mc.videotron.ca</p>											<p class="post-edited">(Last edited by <strong>alirz</strong> on 28 Sep 2016, 04:22)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p339451">
				<div class="post-metadata">
					<div class="post-num">Post #31</div>
					<div class="post-author">alirz</div>
					<div class="post-datetime">
						28 Sep 2016, 04:52					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Villeneuve wrote:</cite><blockquote><p>Re: Restoring the backup you don&#039;t want. You could do that, get in and run firstboot, to set back to defaults. Everything should be clean me thinks.</p></blockquote></div><p>Won&#039;t that reset the luci login password thus I&#039;ll run into the same issue where luci won&#039;t let me set a password</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p339456">
				<div class="post-metadata">
					<div class="post-num">Post #32</div>
					<div class="post-author">davidc502</div>
					<div class="post-datetime">
						28 Sep 2016, 05:55					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>alirz wrote:</cite><blockquote><p>another question just for curiosity</p><p>when i do a nslookup why is the router not returning the first 2 lines with the correct info:</p><br /><p>root@OpenWrt:/home/ali# nslookup mydomain.changeip.org<br />Server:&nbsp; &nbsp; (null)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;---------------<br />Address 1: ::1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;---------------<br />Address 2: 127.0.0.1 localhost</p><p>Name:&nbsp; &nbsp; &nbsp; mydomain.changeip.org<br />Address 1: X.X.X.X.X modemcable0X.X-X-XX.mc.videotron.ca</p></blockquote></div><p>I&#039;m not sure why Server line is null, but the second returned address is IPv6 equivalent to 127.0.0.1.</p><p>If you want to do a quick test, do the following.</p><p>nslookup is in the /usr/bin directory.</p><br /><p>1. Rename nslookup&nbsp; to nslookup.old&nbsp; &nbsp;example: &quot;mv nslookup nslookup.old&quot;</p><p>2. Create a new nslookup script.</p><p>vi /usr/bin/nslookup and add the following line (minus quotes) and save.</p><p>&quot;/bin/busybox nslookup $1 localhost&quot;</p><p>3. Then make the file executable .... example &quot;chmod 777 nslookup&quot;</p><p>4. Then try to run the nslookup command again, and see if you get a different result.</p><br /><p>If there isn&#039;t a difference or ddns still doesn&#039;t work, delete the new nslookup and rename the nslookup.old back to nslookup.</p>											<p class="post-edited">(Last edited by <strong>davidc502</strong> on 28 Sep 2016, 05:56)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p339457">
				<div class="post-metadata">
					<div class="post-num">Post #33</div>
					<div class="post-author">Villeneuve</div>
					<div class="post-datetime">
						28 Sep 2016, 06:15					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>alirz wrote:</cite><blockquote><p>I cant ssh unless i setup a password via luci. Telnet doesnt work, i guess its disabled.</p></blockquote></div><p>Maybe I&#039;m missing something, i.e. you are setting a default password ootb in your build. The default behaviour allows you to ssh in with no password, and yes telnet was removed / disabled when ssh was made the default. You should be able to then set a password and scp over your ssh public keys from whatever ssh client. As far as the no luci password config... new image time?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p339458">
				<div class="post-metadata">
					<div class="post-num">Post #34</div>
					<div class="post-author">nitroshift</div>
					<div class="post-datetime">
						28 Sep 2016, 07:14					</div>
				</div>
				<div class="post-content content">
					<p>@alirz</p><p>I cannot reproduce the issue, so my hunch is going to be a bad build.</p><p>nitroshift</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p339562">
				<div class="post-metadata">
					<div class="post-num">Post #35</div>
					<div class="post-author">alirz</div>
					<div class="post-datetime">
						28 Sep 2016, 20:27					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>davidc502 wrote:</cite><blockquote><div class="quotebox"><cite>alirz wrote:</cite><blockquote><p>another question just for curiosity</p><p>when i do a nslookup why is the router not returning the first 2 lines with the correct info:</p><br /><p>root@OpenWrt:/home/ali# nslookup mydomain.changeip.org<br />Server:&nbsp; &nbsp; (null)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;---------------<br />Address 1: ::1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;---------------<br />Address 2: 127.0.0.1 localhost</p><p>Name:&nbsp; &nbsp; &nbsp; mydomain.changeip.org<br />Address 1: X.X.X.X.X modemcable0X.X-X-XX.mc.videotron.ca</p></blockquote></div><p>I&#039;m not sure why Server line is null, but the second returned address is IPv6 equivalent to 127.0.0.1.</p><p>If you want to do a quick test, do the following.</p><p>nslookup is in the /usr/bin directory.</p><br /><p>1. Rename nslookup&nbsp; to nslookup.old&nbsp; &nbsp;example: &quot;mv nslookup nslookup.old&quot;</p><p>2. Create a new nslookup script.</p><p>vi /usr/bin/nslookup and add the following line (minus quotes) and save.</p><p>&quot;/bin/busybox nslookup $1 localhost&quot;</p><p>3. Then make the file executable .... example &quot;chmod 777 nslookup&quot;</p><p>4. Then try to run the nslookup command again, and see if you get a different result.</p><br /><p>If there isn&#039;t a difference or ddns still doesn&#039;t work, delete the new nslookup and rename the nslookup.old back to nslookup.</p></blockquote></div><p>Thanks what was a good pointer. While i didnt try your method yet i did find out that i get different result depending on if i just run nslookup vs specifying the busybox path when running nslookup.</p><br /><p>root@OpenWrt:/etc/config# which nslookup<br />/usr/bin/nslookup</p><p>root@OpenWrt:/etc/config# /usr/bin/nslookup mydomain.changeip.org<br />Server:&nbsp; &nbsp; (null)<br />Address 1: ::1 localhost<br />Address 2: 127.0.0.1 localhost</p><p>Name:&nbsp; &nbsp; &nbsp; mydomain.changeip.org<br />Address 1: 66.131.XX.XX modemcable0XX.XX-131-66.mc.videotron.ca&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;----- CORRECT WAN IP</p><br /><br /><br /><p>root@OpenWrt:/etc/config# /bin/busybox nslookup mydomain.changeip.org<br />Server:&nbsp; &nbsp; (null)<br />Address 1: ::1<br />Address 2: 127.0.0.1 localhost</p><p>Name:&nbsp; &nbsp; &nbsp; mydomain.changeip.org<br />Address 1: 173.176.XX.XX modemcable0XX.XX-176-173.mc.videotron.ca&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;------ WRONG WAN IP</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p339571">
				<div class="post-metadata">
					<div class="post-num">Post #36</div>
					<div class="post-author">kirkgbr</div>
					<div class="post-datetime">
						28 Sep 2016, 21:50					</div>
				</div>
				<div class="post-content content">
					<p>nslookup is so deprecated it&#039;s ridiculous.&nbsp; Not sure why they haven&#039;t just yanked it for good.&nbsp; &quot;dig&quot; is so much better.</p><div class="codebox"><pre><code>opkg install bind-dig</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p339575">
				<div class="post-metadata">
					<div class="post-num">Post #37</div>
					<div class="post-author">alirz</div>
					<div class="post-datetime">
						28 Sep 2016, 22:34					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>kirkgbr wrote:</cite><blockquote><p>nslookup is so deprecated it&#039;s ridiculous.&nbsp; Not sure why they haven&#039;t just yanked it for good.&nbsp; &quot;dig&quot; is so much better.</p><div class="codebox"><pre><code>opkg install bind-dig</code></pre></div></blockquote></div><p>i installed that but some files seem to be missing:</p><p>dig mydomain.changeip.org<br />Error loading shared library libdns.so.169: No such file or directory (needed by /usr/bin/dig)<br />Error loading shared library libisc.so.106: No such file or directory (needed by /usr/bin/dig)<br />Error relocating /usr/bin/dig: isc__app_isrunning: symbol not found</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p339579">
				<div class="post-metadata">
					<div class="post-num">Post #38</div>
					<div class="post-author">kirkgbr</div>
					<div class="post-datetime">
						28 Sep 2016, 22:55					</div>
				</div>
				<div class="post-content content">
					<p>Did it install without any errors?</p><div class="codebox"><pre><code>root@routi:~# opkg install bind-dig
Installing bind-dig (9.9.9-P3-1) to root...
Downloading http://downloads.lede-project.org/snapshots/packages/arm_cortex-a9_vfpv3/packages/bind-dig_9.9.9-P3-1_arm_cortex-a9_vfpv3.ipk.
Installing bind-libs (9.9.9-P3-1) to root...
Downloading http://downloads.lede-project.org/snapshots/packages/arm_cortex-a9_vfpv3/packages/bind-libs_9.9.9-P3-1_arm_cortex-a9_vfpv3.ipk.
Installing libopenssl (1.0.2j-1) to root...
Downloading http://downloads.lede-project.org/snapshots/packages/arm_cortex-a9_vfpv3/base/libopenssl_1.0.2j-1_arm_cortex-a9_vfpv3.ipk.
Configuring libopenssl.
Configuring bind-libs.
Configuring bind-dig.

root@routi:~# dig +short yahoo.com.
98.138.253.109
98.139.183.24
206.190.36.45</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p339594">
				<div class="post-metadata">
					<div class="post-num">Post #39</div>
					<div class="post-author">alirz</div>
					<div class="post-datetime">
						29 Sep 2016, 00:26					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>kirkgbr wrote:</cite><blockquote><p>Did it install without any errors?</p><div class="codebox"><pre><code>root@routi:~# opkg install bind-dig
Installing bind-dig (9.9.9-P3-1) to root...
Downloading http://downloads.lede-project.org/snapshots/packages/arm_cortex-a9_vfpv3/packages/bind-dig_9.9.9-P3-1_arm_cortex-a9_vfpv3.ipk.
Installing bind-libs (9.9.9-P3-1) to root...
Downloading http://downloads.lede-project.org/snapshots/packages/arm_cortex-a9_vfpv3/packages/bind-libs_9.9.9-P3-1_arm_cortex-a9_vfpv3.ipk.
Installing libopenssl (1.0.2j-1) to root...
Downloading http://downloads.lede-project.org/snapshots/packages/arm_cortex-a9_vfpv3/base/libopenssl_1.0.2j-1_arm_cortex-a9_vfpv3.ipk.
Configuring libopenssl.
Configuring bind-libs.
Configuring bind-dig.

root@routi:~# dig +short yahoo.com.
98.138.253.109
98.139.183.24
206.190.36.45</code></pre></div></blockquote></div><p>Yup no errors</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p339596">
				<div class="post-metadata">
					<div class="post-num">Post #40</div>
					<div class="post-author">alirz</div>
					<div class="post-datetime">
						29 Sep 2016, 00:34					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nitroshift wrote:</cite><blockquote><p>@alirz</p><p>I cannot reproduce the issue, so my hunch is going to be a bad build.</p><p>nitroshift</p></blockquote></div><p>I built a new image few minutes ago, installed it WITHOUT KEEP SETTINGS. after reboot I&#039;m at luci, I can get in but still not able to change password.<br />No ssh access as password is not set.<br />Telnet to port 23 is refused.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p339597">
				<div class="post-metadata">
					<div class="post-num">Post #41</div>
					<div class="post-author">Villeneuve</div>
					<div class="post-datetime">
						29 Sep 2016, 01:04					</div>
				</div>
				<div class="post-content content">
					<p>This is a new image, you ssh to the device and it asks you for a password? Do you have anything in the files/ directory in your build tree?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p339598">
				<div class="post-metadata">
					<div class="post-num">Post #42</div>
					<div class="post-author">alirz</div>
					<div class="post-datetime">
						29 Sep 2016, 01:04					</div>
				</div>
				<div class="post-content content">
					<p>i think this i found a bug. </p><p>My self built image has OPEN SSH included and not DROPBEAR. it looks like that drop bear allows password less login for the first time. However openssh does not.</p><p>So when i install my new image and try to set a password for Luci, which in reality is setting a root password on the router in the back and because openssh doesnt allow password less login even for the first time, Luci fails to set a password. Thus at that point there is no way for ssh access to the router. Unless you uninstall openssh, install dropbear, login to ssh without a password and set a root password.<br />i think this is a Openssh bug.</p>											<p class="post-edited">(Last edited by <strong>alirz</strong> on 29 Sep 2016, 01:06)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p339599">
				<div class="post-metadata">
					<div class="post-num">Post #43</div>
					<div class="post-author">Villeneuve</div>
					<div class="post-datetime">
						29 Sep 2016, 01:06					</div>
				</div>
				<div class="post-content content">
					<p>If that is true than can you add your public key under the /files directory so they are part of your build. Whereever openssh keeps it <em>authorized-keys</em>.</p><p>Edit: another option maybe <a href="https://wiki.openwrt.org/doc/uci#uci-defaults">uci-defaults</a> to assign default passwords.</p>											<p class="post-edited">(Last edited by <strong>Villeneuve</strong> on 29 Sep 2016, 01:33)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p339613">
				<div class="post-metadata">
					<div class="post-num">Post #44</div>
					<div class="post-author">davidc502</div>
					<div class="post-datetime">
						29 Sep 2016, 04:38					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>alirz wrote:</cite><blockquote><div class="quotebox"><cite>davidc502 wrote:</cite><blockquote><div class="quotebox"><cite>alirz wrote:</cite><blockquote><p>another question just for curiosity</p><p>when i do a nslookup why is the router not returning the first 2 lines with the correct info:</p><br /><p>root@OpenWrt:/home/ali# nslookup mydomain.changeip.org<br />Server:&nbsp; &nbsp; (null)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;---------------<br />Address 1: ::1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;---------------<br />Address 2: 127.0.0.1 localhost</p><p>Name:&nbsp; &nbsp; &nbsp; mydomain.changeip.org<br />Address 1: X.X.X.X.X modemcable0X.X-X-XX.mc.videotron.ca</p></blockquote></div><p>I&#039;m not sure why Server line is null, but the second returned address is IPv6 equivalent to 127.0.0.1.</p><p>If you want to do a quick test, do the following.</p><p>nslookup is in the /usr/bin directory.</p><br /><p>1. Rename nslookup&nbsp; to nslookup.old&nbsp; &nbsp;example: &quot;mv nslookup nslookup.old&quot;</p><p>2. Create a new nslookup script.</p><p>vi /usr/bin/nslookup and add the following line (minus quotes) and save.</p><p>&quot;/bin/busybox nslookup $1 localhost&quot;</p><p>3. Then make the file executable .... example &quot;chmod 777 nslookup&quot;</p><p>4. Then try to run the nslookup command again, and see if you get a different result.</p><br /><p>If there isn&#039;t a difference or ddns still doesn&#039;t work, delete the new nslookup and rename the nslookup.old back to nslookup.</p></blockquote></div><p>Thanks what was a good pointer. While i didnt try your method yet i did find out that i get different result depending on if i just run nslookup vs specifying the busybox path when running nslookup.</p><br /><p>root@OpenWrt:/etc/config# which nslookup<br />/usr/bin/nslookup</p><p>root@OpenWrt:/etc/config# /usr/bin/nslookup mydomain.changeip.org<br />Server:&nbsp; &nbsp; (null)<br />Address 1: ::1 localhost<br />Address 2: 127.0.0.1 localhost</p><p>Name:&nbsp; &nbsp; &nbsp; mydomain.changeip.org<br />Address 1: 66.131.XX.XX modemcable0XX.XX-131-66.mc.videotron.ca&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;----- CORRECT WAN IP</p><br /><br /><br /><p>root@OpenWrt:/etc/config# /bin/busybox nslookup mydomain.changeip.org<br />Server:&nbsp; &nbsp; (null)<br />Address 1: ::1<br />Address 2: 127.0.0.1 localhost</p><p>Name:&nbsp; &nbsp; &nbsp; mydomain.changeip.org<br />Address 1: 173.176.XX.XX modemcable0XX.XX-176-173.mc.videotron.ca&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;------ WRONG WAN IP</p></blockquote></div><p>appears OpenWrt if affected by this bug as well. I did put in a fix for LEDE, but I don&#039;t know how many realize there is an issue with OpenWrt. With fixes no longer being worked, I don&#039;t know what they are to do.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p339639">
				<div class="post-metadata">
					<div class="post-num">Post #45</div>
					<div class="post-author">sera</div>
					<div class="post-datetime">
						29 Sep 2016, 11:53					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Villeneuve wrote:</cite><blockquote><p>If that is true than can you add your public key under the /files directory so they are part of your build. Whereever openssh keeps it <em>authorized-keys</em>.</p><p>Edit: another option maybe <a href="https://wiki.openwrt.org/doc/uci#uci-defaults">uci-defaults</a> to assign default passwords.</p></blockquote></div><p>Baking in a public key is the way to go, password based logins are disabled for root by default as well. If it really needs to be a password you won&#039;t get around changing /etc/sshd_config.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p339672">
				<div class="post-metadata">
					<div class="post-num">Post #46</div>
					<div class="post-author">alirz</div>
					<div class="post-datetime">
						29 Sep 2016, 16:07					</div>
				</div>
				<div class="post-content content">
					<p>@ Sera, thanks, i understand that. Part of my problem is that even when i&#039;ve gone ahead and setup a root password via ssh and can use that as a login for LUCI. Luci still wont let me set/change my password.<br />I looked at Luci&#039;s code on git hub and from what i see the only reason i would be getting the&nbsp; &quot;unknown error password no changed&quot; error would be if i was not typing the password twice correctly to confirm it. but that is not the case.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p339676">
				<div class="post-metadata">
					<div class="post-num">Post #47</div>
					<div class="post-author">kirkgbr</div>
					<div class="post-datetime">
						29 Sep 2016, 16:45					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>alirz wrote:</cite><blockquote><p>@ Sera, thanks, i understand that. Part of my problem is that even when i&#039;ve gone ahead and setup a root password via ssh and can use that as a login for LUCI. Luci still wont let me set/change my password.<br />I looked at Luci&#039;s code on git hub and from what i see the only reason i would be getting the&nbsp; &quot;unknown error password no changed&quot; error would be if i was not typing the password twice correctly to confirm it. but that is not the case.</p></blockquote></div><p>What version are you building?&nbsp; Just this morning I created a new build(LEDE trunk) excluding dropbear and included openssh.&nbsp; Since openssh disables root logins by default I was unable to login via ssh at first(as expected).&nbsp; However, since my build includes &lt;buildroot&gt;/files/etc/passwd and shadow, I was able to login to the gui with no problem and even change password once logged in.&nbsp; And, since I have serial console, I was also able to modify the /etc/ssh/sshd_config to allow root logins.&nbsp; </p><p>Also, as an added bonus, I have created another build and included &lt;buildroot&gt;/files/etc/ssh/sshd_config with the following entries.</p><div class="codebox"><pre><code>PermitRootLogin yes
PermitEmptyPasswords yes  &lt;I highly discourage this but just testing</code></pre></div><p>with this build I was able to hit the gui, login without a password and change it.&nbsp; And if I don&#039;t change the password via gui and using only ssh I was also presented with this at first ssh login:</p><div class="codebox"><pre><code>WARNING: Your password has expired.
You must change your password now and login again!
Changing password for root
New password: 
Retype password: 
passwd: password for root changed by root</code></pre></div><p>I am currently trying Openwrt trunk build to verify the same but to be honest, I will likely stick with LEDE for now anyway.</p>											<p class="post-edited">(Last edited by <strong>kirkgbr</strong> on 29 Sep 2016, 16:47)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p339688">
				<div class="post-metadata">
					<div class="post-num">Post #48</div>
					<div class="post-author">alirz</div>
					<div class="post-datetime">
						29 Sep 2016, 17:27					</div>
				</div>
				<div class="post-content content">
					<p>sure. however i just dont get why luci wont let me change the password</p><p>UPDATE: i notice that the system log reports whenever i attempt to change the password via luci</p><p>Thu Sep 29 10:31:52 2016 daemon.err uhttpd[1487]: sh: write error: Broken pipe</p><p>Im currently running: OpenWrt Designated Driver 49936 / LuCI Master (git-16.271.33274-ddb98f1)</p><p>could i be missing some module for Luci?</p>											<p class="post-edited">(Last edited by <strong>alirz</strong> on 29 Sep 2016, 17:37)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 2 of 2</div><nav><ul><li><a href="viewtopic.php%3Fid=67757&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>