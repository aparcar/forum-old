<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> HAProxy + OpenWRT for subdomain name level access of servers?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 14 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p359520">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">newgeo</div>
					<div class="post-datetime">
						1 Jun 2017, 01:50					</div>
				</div>
				<div class="post-content content">
					<p>I wish to use HAProxy to connect to my home network&#039;s various web-servers via subdomains from the internet.</p><p>I&#039;ve tried to write this post numerous times but the spam policy here won&#039;t let me post it claiming &quot;Too more links in message. Allowed 0 links. Reduce number of links and post it again.&quot;</p><p>So instead, here is my question posted on PASTEBIN (a real link which apparently the forum will permit??)</p><p>pastebin.com/b3c6PL8W</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p359568">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">newgeo</div>
					<div class="post-datetime">
						1 Jun 2017, 18:02					</div>
				</div>
				<div class="post-content content">
					<p>I now have this working and want to share my solution for others.</p><p>I think this is something a lot of people are looking for - let me know if you run into trouble.</p><p>In the config file example you will see there are several domain names configured to point to various LAN ip addresses/ports.</p><p>I had to move LuCl listen port to 80 because only one can bind at a time and haproxy is being bound to 80</p><p>Each of these endpoints are completely URL/Port independent and you should be able to add as many as you need/like</p><p>I also configured port 443 for SSL so all communication between the outside client and the HAProxy can be encrypted which is nice.&nbsp; I&#039;ll work next on getting certbot or similar working with this as my current cert is self-signed.&nbsp; If you have any experience with this part please feel free to share.</p><p>haproxy cfg is in paste below</p><p>pastebin.com/UWKs5yCy</p>											<p class="post-edited">(Last edited by <strong>newgeo</strong> on 1 Jun 2017, 18:05)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p366793">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">denics</div>
					<div class="post-datetime">
						16 Oct 2017, 16:18					</div>
				</div>
				<div class="post-content content">
					<p>Hi @newgeo,<br />what is your router model? I am interested in this same configuration, thanks for sharing. How did you implement SSL? HAproxy comes without SSL support.</p><p>Denis</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p366808">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">newgeo</div>
					<div class="post-datetime">
						16 Oct 2017, 18:44					</div>
				</div>
				<div class="post-content content">
					<p>Hello @denics</p><p>I don&#039;t believe I needed to do anything special except for what is in the config but would be willing to try to answer any more direct questions you might have.</p><p>haproxy -v yielded:<br /></p><div class="codebox"><pre><code>HA-Proxy version 1.5.14-patch04 2015/07/02
Copyright 2000-2015 Willy Tarreau &lt;willy@haproxy.org&gt;</code></pre></div><p>Router is Asus RT-N16</p><p>OpenWrt is CHAOS CALMER (15.05, r46767)</p>											<p class="post-edited">(Last edited by <strong>newgeo</strong> on 16 Oct 2017, 18:46)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>