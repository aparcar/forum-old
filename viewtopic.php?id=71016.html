<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> TP-Link Archer C7 v2 + CC 15.05 - high cpu load.</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 26 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p358997">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">gandi21</div>
					<div class="post-datetime">
						25 May 2017, 11:38					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>I have TP-Link Archer C7 v2 and OpenWrt Chaos Calmer 15.05 / LuCI (git-15.248.30277-3836b45) <br />I experienced high cpu load.<br />It looks like most cpu time gets netifd and odhcpd<br />Besides that router works quite well.</p><div class="codebox"><pre><code>root@OpenWrt:~# uptime
 10:24:05 up 54 min,  load average: 5.02, 3.81, 3.01</code></pre></div><div class="codebox"><pre><code>Mem: 48684K used, 77520K free, 804K shrd, 2484K buff, 11984K cached
CPU:  74% usr  24% sys   0% nic   0% idle   0% io   0% irq   0% sirq
Load average: 5.04 3.94 3.09 6/52 32738
  PID  PPID USER     STAT   VSZ %VSZ %CPU COMMAND
  976     1 root     S     1584   1%   4% /sbin/netifd
 1013     1 root     S     1172   1%   3% /usr/sbin/odhcpd
  326     2 root     SW       0   0%   1% [kworker/0:2]
  479     1 root     S      900   1%   0% /sbin/ubusd
 1258     1 root     S     4068   3%   0% /usr/sbin/openvpn --syslog openvpn(cu
    1     0 root     S     1408   1%   0% /sbin/procd
32394 30913 root     R     1364   1%   0% top
32734 32720 root     R     1964   2%   0% fw3 -q network wan6
 1572     1 root     S     1660   1%   0% /usr/sbin/hostapd -P /var/run/wifi-ph
 1684     1 root     S     1648   1%   0% /usr/sbin/hostapd -P /var/run/wifi-ph
 1117     1 root     S     1576   1%   0% /usr/sbin/uxxxxd -f -h /xxx -r OpenWr
942     1 root     S     1532   1%   0% /sbin/rpcd
 2309     1 root     S     1500   1%   0% {dynamic_dns_upd} /bin/sh /usr/lib/dd
32720  1378 root     S     1480   1%   0% {dhcpv6.script} /bin/sh /lib/netifd/d
32733   976 root     S     1396   1%   0% {hotplug-call} /bin/sh /sbin/hotplug-
32738 32733 root     R     1396   1%   0% {hotplug-call} /bin/sh /sbin/hotplug-
32737  1378 root     R     1388   1%   0% {dhcpv6.script} /bin/sh /lib/netifd/d
 3053     1 root     S     1364   1%   0% {mwan3track} /bin/sh /usr/sbin/mwan3t
 1933     1 root     S     1364   1%   0% {mwan3track} /bin/sh /usr/sbin/mwan3t
 1537     1 root     S     1364   1%   0% /usr/sbin/ntpd -n -S /usr/sbin/ntpd-h</code></pre></div><div class="codebox"><pre><code> root@OpenWrt:~# ps -w
  PID USER       VSZ STAT COMMAND
    1 root      1408 S    /sbin/procd
    2 root         0 SW   [kthreadd]
    3 root         0 SW   [ksoftirqd/0]
    5 root         0 SW&lt;  [kworker/0:0H]
    6 root         0 SW   [kworker/u2:0]
    7 root         0 SW&lt;  [khelper]
   33 root         0 SW&lt;  [writeback]
   68 root         0 SW&lt;  [bioset]
   71 root         0 SW&lt;  [kblockd]
   73 root         0 SW   [kswapd0]
   75 root         0 SW   [fsnotify_mark]
   77 root         0 SW   [spi0]
  306 root         0 SW&lt;  [deferwq]
  307 root         0 SW   [kworker/u2:2]
  326 root         0 SW   [kworker/0:2]
  400 root         0 SWN  [jffs2_gcd_mtd3]
  479 root       900 S    /sbin/ubusd
  533 root       772 S    /sbin/askfirst /bin/ash --login
  695 root         0 SW&lt;  [ipv6_addrconf]
  734 root         0 SW&lt;  [cfg80211]
  744 root         0 SW&lt;  [ath10k_wq]
  931 root      1048 S    /sbin/logd -S 16
  932 root      1208 S    /sbin/logread -f -r 192.168.1.106 514 -p /var/run/logread.2.pid -u
  942 root      1532 S    /sbin/rpcd
  976 root      1584 S    /sbin/netifd
 1013 root      1172 S    /usr/sbin/odhcpd
 1032 root      1364 S    /usr/sbin/crond -f -c /etc/crontabs -l 8
 1035 root         0 SW   [kworker/0:3]
 1060 root      1152 S    /usr/sbin/dropbear -F -P /var/run/dropbear.1.pid -p 22 -K 300
 1117 root      1576 S    /usr/sbin/uxxxxd -f -h /xxx -r OpenWrt -x /cgi-bin -u /ubus -t 60 -T 30 -k 20 -A 1 -n 3 -N 100 -p 0.0.0.0
 1258 root      4068 R    /usr/sbin/openvpn --syslog openvpn(custom_config) --status /var/run/openvpn.custom_config.status --cd /et
 1378 root       800 S    odhcp6c -s /lib/netifd/dhcpv6.script -P0 -t120 eth0
 1384 root      1360 S    udhcpc -p /var/run/udhcpc-eth2.pid -s /lib/netifd/dhcp.script -f -t 0 -i eth2 -C
 1537 root      1364 S    /usr/sbin/ntpd -n -S /usr/sbin/ntpd-hotplug -p 0.pl.pool.ntp.org -p 1.pl.pool.ntp.org -p 2.pl.pool.ntp.or
 1572 root      1660 S    /usr/sbin/hostapd -P /var/run/wifi-phy1.pid -B /var/run/hostapd-phy1.conf
 1684 root      1648 S    /usr/sbin/hostapd -P /var/run/wifi-phy0.pid -B /var/run/hostapd-phy0.conf
 1700 root       828 S    /usr/sbin/edge -r -a 192.168.20.1 -s 255.255.255.0 -c xxxxxxxx -k xxxxxxxxxx -l xxxxxxxxxxx:62535
 1726 nobody     944 S    /usr/sbin/dnsmasq -C /var/etc/dnsmasq.conf -k -x /var/run/dnsmasq/dnsmasq.pid
 1802 root      1352 S    sleep 10
 1933 root      1364 S    {mwan3track} /bin/sh /usr/sbin/mwan3track wan br-wan 2 1 2 10 3 8 208.67.220.220 208.67.222.222 8.8.8.8 8
 1936 root      1352 S    sleep 10
 1998 root      1472 R    {dhcpv6.script} /bin/sh /lib/netifd/dhcpv6.script eth0 ra-updated
 2003 root      1360 R    ps -w
 2309 root      1500 S    {dynamic_dns_upd} /bin/sh /usr/lib/ddns/dynamic_dns_updater.sh myddns 0
 3053 root      1364 S    {mwan3track} /bin/sh /usr/sbin/mwan3track wan2 eth2 1 1 2 10 3 8 208.67.220.220 208.67.222.222 8.8.8.8 8.
16426 root      1352 S    sleep 300
30143 root      1220 R    /usr/sbin/dropbear -F -P /var/run/dropbear.1.pid -p 22 -K 300
30913 root      1364 S    -ash</code></pre></div>											<p class="post-edited">(Last edited by <strong>gandi21</strong> on 25 May 2017, 11:56)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p359035">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">gandi21</div>
					<div class="post-datetime">
						25 May 2017, 23:13					</div>
				</div>
				<div class="post-content content">
					<p>Ok, i managed to lower cpu utilization by disabling ipv6 built in fuctionality (not using it) on every interface. And disabling ipv6 dhcp on lan.</p><div class="codebox"><pre><code>root@OpenWrt:~# uptime
 22:13:16 up 12:43,  load average: 0.00, 0.11, 0.88</code></pre></div>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>