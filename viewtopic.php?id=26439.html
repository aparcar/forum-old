<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> failsafe</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 26 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=26439&amp;p=2.html">2</a></li></ul></nav></div>
			
		
		
			<article class="post" id="p116521">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">ch</div>
					<div class="post-datetime">
						5 Sep 2010, 17:26					</div>
				</div>
				<div class="post-content content">
					<p>i have a tp link 841nd and i was playing around with it ion the luci pages and now i cant connect to it. i tries to restart it by holding down the restart button when it was powering on but i cant telnet to it ()using a static ip).</p><p>any ideas on how to get it working again or should i throw it ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p116523">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">mrii</div>
					<div class="post-datetime">
						5 Sep 2010, 17:32					</div>
				</div>
				<div class="post-content content">
					<p>no need to throw it in the trash.</p><p>you probably set up something stupid in luci - either changed the ip adress or locked yourself out with the firewall.</p><p>i would try to obtain an ip adress via dhcp and see what you end with. if this doesnt work, there are lots of ways to get it to work again. reflashing while it starts the bootloader, going to failsafe mode or a serial cable - in worst case you can even shorten (and erase) the flash chip.</p><p>order i would suggest:<br />- test if you get an ip via dhcp<br />- check what kind of bootloader that device has, and flash it while booting (differes from router to router)<br />- attach a serial cable and fix the problem there<br />- only in worst case: erase the flash chip (and so the firmware) by shortening some pins (also differes from router to router)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p116525">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">mrii</div>
					<div class="post-datetime">
						5 Sep 2010, 17:34					</div>
				</div>
				<div class="post-content content">
					<p>another thought: &quot;i cannot connect to it&quot; - does it mean you cannot connect to luci only? perhaps the ssh is still open and you can fix all problems with a shell - would be the most easy way. does the router reply to pings on the old address ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p116526">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">ch</div>
					<div class="post-datetime">
						5 Sep 2010, 17:53					</div>
				</div>
				<div class="post-content content">
					<p>i cant connect via ssh , telnet it doesnt respond to ping.<br />if i start wireshark i can see one UDP packet sayin press button to enter failsafe mode now. i press it bu then i cant connect or anything (to 192.168.1.1)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p116527">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">ch</div>
					<div class="post-datetime">
						5 Sep 2010, 18:10					</div>
				</div>
				<div class="post-content content">
					<p>the router sends out DHCP discover transaction from 0.0.0.0 to 255.255.255.255 (it has the MAC of eth0) after it sends out the UDP packet</p>											<p class="post-edited">(Last edited by <strong>ch</strong> on 5 Sep 2010, 18:11)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p116530">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">mrii</div>
					<div class="post-datetime">
						5 Sep 2010, 19:08					</div>
				</div>
				<div class="post-content content">
					<p>hmm, if it sends a dhcp discover, it is requesting an ip via dhcp. why not give it what it asks for and put another dhcp server to your lan. it then should accept the given ip and be available for ssh/luci again.</p><p>are you sure you are connected to a lan port and not to a wan port? in my luci i cannot set the local lan-ip to dhcp.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p116531">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">ch</div>
					<div class="post-datetime">
						5 Sep 2010, 19:35					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>mrii wrote:</cite><blockquote><p>hmm, if it sends a dhcp discover, it is requesting an ip via dhcp. why not give it what it asks for and put another dhcp server to your lan. it then should accept the given ip and be available for ssh/luci again.</p></blockquote></div><p>how would i do this exactly (connecting to a pc or to a router ? and then what ? ) </p><br /><br /><div class="quotebox"><cite>mrii wrote:</cite><blockquote><p>are you sure you are connected to a lan port and not to a wan port? in my luci i cannot set the local lan-ip to dhcp.</p></blockquote></div><p>Yeah deffers</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p116544">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">mrii</div>
					<div class="post-datetime">
						6 Sep 2010, 01:58					</div>
				</div>
				<div class="post-content content">
					<p>if you dont have a 2nd router to act as dhcp server, there are also dhcp-servers for windows which should hand out an ip. since its not for final use but only for debugging, i guess any dhcp will do (windows, linux, another router even without openwrt)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p116545">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">ch</div>
					<div class="post-datetime">
						6 Sep 2010, 02:02					</div>
				</div>
				<div class="post-content content">
					<p>i can get DHCP doscover on the TP link (from 0.0.0.0 to 255.255.255.255 ) and i can see a DHCP offer from my computer to the TP link (192.168.2.100 to 192.168.2.10) but his goes on forever and nothing happens.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p116561">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">hackz</div>
					<div class="post-datetime">
						6 Sep 2010, 12:43					</div>
				</div>
				<div class="post-content content">
					<p>@ch</p><p>configure LAN interface :</p><p>ip: 192.168.1.2<br />sub: 255.255.255.0<br />gate: 192.168.1.1<br />dns: 192.168.1.1</p><p>connect PC (lan-interface) to router</p><p>rung ping -t 192.168.1.1 </p><p>Unplug power of router wait 2sek, plug in power again. </p><p>look ping, is there a moment where the router was retourning the ping?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p116567">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">ch</div>
					<div class="post-datetime">
						6 Sep 2010, 15:53					</div>
				</div>
				<div class="post-content content">
					<p>when you say configure the LAN interface do you mean the DHCP server ? All i did was configure wicd to have the aforementioned settings.</p><p>i think ping -t if for windows machines , im using ubuntu 9.10</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p116596">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						7 Sep 2010, 11:06					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>ch wrote:</cite><blockquote><p>if i start wireshark i can see one UDP packet sayin press button to enter failsafe mode now. i press it bu then i cant connect or anything (to 192.168.1.1)</p></blockquote></div><p>Did you press the &quot;QSS&quot; button?</p><p><a href="http://wiki.openwrt.org/toh/tp-link/tl-wr1043nd#failsafe.mode">TP-Link TL-WR1043ND - OpenWrt Wiki</a> - Failsafe mode</p><p>If not working, your best chance is to get a serial cable.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p116603">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">ch</div>
					<div class="post-datetime">
						7 Sep 2010, 13:01					</div>
				</div>
				<div class="post-content content">
					<p>yes i did. if i press QSS then the sys light flashes quickly (as oppossed to constatnly on but i cant telnet or ssh into it )</p><p>ALso i really dont want to use a seriel cable i donkt know how and cant find good documentation for a beginner to electronics</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p116618">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						7 Sep 2010, 17:03					</div>
				</div>
				<div class="post-content content">
					<p>OK. I tested the Failsafe mode on a La Fonera+. As soon as I saw the UDP packet sent from 192.168.1.1, I pressed the Reset button and fired up a telnet session to it and I could get the root shell. What&#039;s the source address you saw?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p116755">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">ch</div>
					<div class="post-datetime">
						9 Sep 2010, 17:29					</div>
				</div>
				<div class="post-content content">
					<p>what i see using wireshark is this</p><br /><p>when the router starts up i get his packet </p><p>000&nbsp; ff ff ff ff ff ff 00 23&nbsp; cd 18 0e 98 08 00 45 00&nbsp; &nbsp;.......# ......E.<br />0010&nbsp; 04 05 00 00 40 00 40 11&nbsp; b2 97 c0 a8 01 01 c0 a8&nbsp; &nbsp;....@.@. ........<br />0020&nbsp; 01 ff ca a2 13 37 03 f1&nbsp; 0c 5c de ad 50 6c 65 61&nbsp; &nbsp;.....7.. .\..Plea<br />0030&nbsp; 73 65 20 70 72 65 73 73&nbsp; 20 62 75 74 74 6f 6e 20&nbsp; &nbsp;se press&nbsp; button <br />0040&nbsp; 6e 6f 77 20 74 6f 20 65&nbsp; 6e 74 65 72 20 66 61 69&nbsp; &nbsp;now to e nter fai<br />0050&nbsp; 6c 73 61 66 65 00 00 00&nbsp; 00 00 00 00 00 00 00 00&nbsp; &nbsp;lsafe... ........</p><p>so i press QSS and then this is what happens</p><p>1st packet this is from the router , the TP LINK to the computer</p><p>Ethernet II, Src: Tp-LinkT_18:0e:98 (00:23:cd:18:0e:98), Dst: Broadcast (ff:ff:ff:ff:ff:ff)<br />Internet Protocol, Src: 0.0.0.0 (0.0.0.0), Dst: 255.255.255.255 (255.255.255.255)</p><p>and from the computer shich is acting as a DHCP server is this </p><br /><p>Ethernet II, Src: Giga-Byt_75:28:95 (6c:f0:49:75:28:95), Dst: Tp-LinkT_18:0e:98 (00:23:cd:18:0e:98)<br />Internet Protocol, Src: 192.168.1.2 (192.168.1.2), Dst: 192.168.1.1 (192.168.1.1)</p><p>and then the first packet again <br />followed by the second packet followed by the first packet etc</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p116769">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">NiQ</div>
					<div class="post-datetime">
						9 Sep 2010, 19:23					</div>
				</div>
				<div class="post-content content">
					<p>ch -<br />Set your computer&#039;s IP address to 192.168.1.2 (or any other address in the 192.168.1.0/24 subnet that doesn&#039;t conflict with another device), restart your router. As soon as you receive the UDP packet that says &quot;Please press button now to enter failsafe&quot;, press a button on your router, then wait a couple of minutes and try to telnet (not SSH) your router by typing &quot;telnet 192.168.1.1&quot;.<br />Good luck.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p116808">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						10 Sep 2010, 10:26					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>ch wrote:</cite><blockquote><p>000&nbsp; ff ff ff ff ff ff 00 23&nbsp; cd 18 0e 98 08 00 45 00&nbsp; &nbsp;.......# ......E.<br />0010&nbsp; 04 05 00 00 40 00 40 11&nbsp; b2 97 <strong>c0 a8 01 01</strong> c0 a8&nbsp; &nbsp;....@.@. ........<br />0020&nbsp; 01 ff ca a2 13 37 03 f1&nbsp; 0c 5c de ad 50 6c 65 61&nbsp; &nbsp;.....7.. .\..Plea<br />0030&nbsp; 73 65 20 70 72 65 73 73&nbsp; 20 62 75 74 74 6f 6e 20&nbsp; &nbsp;se press&nbsp; button <br />0040&nbsp; 6e 6f 77 20 74 6f 20 65&nbsp; 6e 74 65 72 20 66 61 69&nbsp; &nbsp;now to e nter fai<br />0050&nbsp; 6c 73 61 66 65 00 00 00&nbsp; 00 00 00 00 00 00 00 00&nbsp; &nbsp;lsafe... ........</p><p>so i press QSS and then this is what happens</p><p>1st packet this is from the router , the TP LINK to the computer</p><p>Ethernet II, Src: Tp-LinkT_18:0e:98 (00:23:cd:18:0e:98), Dst: Broadcast (ff:ff:ff:ff:ff:ff)<br />Internet Protocol, Src: 0.0.0.0 (0.0.0.0), Dst: 255.255.255.255 (255.255.255.255)</p></blockquote></div><p>The router&#039;s ip is already 192.168.1.1 which is &quot;<strong>c0 a8 01 01</strong>.&quot; It doesn&#039;t make sense that the router will send DHCP query after you press Reset/QSS unless the button doesn&#039;t work and you connect to wan and not lan.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p120946">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">rumburak</div>
					<div class="post-datetime">
						12 Nov 2010, 23:43					</div>
				</div>
				<div class="post-content content">
					<p>hello <br />I&#039;m having a similar issue with the wrt841nd<br />I&#039;ve been playing with the settings and now .. guess what, the router does not answer to ping to the default address 192.168.1.1</p><p>After entering failsafe mode and providing a DHCP server on the PC (from iptools) , with wireshak i can see the router acknowledging its address :</p><p>ARP who has 192.168.1.1 ? tell 192.168.1.10<br />ARP 192.168.1.1 is at 00:cccccc</p><p>However , ping does not work.</p><p>Any ideas ?<br />Thank you in advance</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p120971">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						13 Nov 2010, 08:58					</div>
				</div>
				<div class="post-content content">
					<p>What&#039;s the hardware version of your TL-WR841ND?<br />What&#039;s the ip address of the pc?<br />Is there any device other than router and pc connected to the network?</p><p>There&#039;s no need to setup DHCP server and you should avoid setting ip address 192.168.1.1 to pc.</p><p>Keep your network configuration as simple as possible. Just connect the router to your pc or laptop. Nothing else. Run WireShark and you should be able to received the FailSafe udp packet.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p120976">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">rumburak</div>
					<div class="post-datetime">
						13 Nov 2010, 11:13					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for your reply</p><div class="quotebox"><cite>fyi wrote:</cite><blockquote><p>What&#039;s the hardware version of your TL-WR841ND?</p></blockquote></div><p>It&#039;s a V3<br /></p><div class="quotebox"><cite>fyi wrote:</cite><blockquote><p>What&#039;s the ip address of the pc?</p></blockquote></div><p>For PC i assign static IP address, 192.168.1.10<br /></p><div class="quotebox"><cite>fyi wrote:</cite><blockquote><p>Is there any device other than router and pc connected to the network?</p></blockquote></div><p>No other device</p><div class="quotebox"><cite>fyi wrote:</cite><blockquote><p>There&#039;s no need to setup DHCP server and you should avoid setting ip address 192.168.1.1 to pc.</p></blockquote></div><p>192.168.1.1 has not been assigned to PC</p><div class="quotebox"><cite>fyi wrote:</cite><blockquote><p>Keep your network configuration as simple as possible. Just connect the router to your pc or laptop. Nothing else. Run WireShark and you should be able to received the FailSafe udp packet.</p></blockquote></div><p>As soon as i see the failsafe UDP packet i push the QSS button to enter failsafe, right ? <br />Once, several times, does it matter ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p120980">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						13 Nov 2010, 13:09					</div>
				</div>
				<div class="post-content content">
					<p>As soon as you see the failsafe UDP packet, immediately push and hold the Reset button till you see another udp packet indicating entering FailSafe mode.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p121033">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">rumburak</div>
					<div class="post-datetime">
						13 Nov 2010, 21:02					</div>
				</div>
				<div class="post-content content">
					<p>Not working, no reaction pressing either reset or QSS buttons, no other UDP packet from the router</p><p>About the first UDP packet: wireshark reports it as &quot;bad udp length value 1009 (..)&quot; but this i uderstand is a wireshark problem reporting a non-problem.</p><p>I&#039;ll try again tomorrow and detail wireshark traces.</p><p>Thanks again</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p121288">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">rumburak</div>
					<div class="post-datetime">
						16 Nov 2010, 21:07					</div>
				</div>
				<div class="post-content content">
					<p>Well, nothing; can&#039;t get to failsafe mode.<br />(is this explainable .. ?)</p><p>What&#039;s next, serial/jtag flashing ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p121292">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						16 Nov 2010, 21:58					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>rumburak wrote:</cite><blockquote><p>Well, nothing; can&#039;t get to failsafe mode.<br />(is this explainable .. ?)</p><p>What&#039;s next, serial/jtag flashing ?</p></blockquote></div><p>Are you still seeing the broadcast udp packet?</p><p>Get a USB to TTL RS232 serial cable.</p><p><a href="https://forum.openwrt.org/viewtopic.php?pid=118756#p118756">OpenWrt / ASUS RT-N15 serial console</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p121541">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">rumburak</div>
					<div class="post-datetime">
						20 Nov 2010, 13:13					</div>
				</div>
				<div class="post-content content">
					<p>Yes, there is the initial broadcast UDP msg saying Push the button now to enter failsafe.<br />But no other message from the router afterwards.</p><p>[later edit removed images]</p>											<p class="post-edited">(Last edited by <strong>rumburak</strong> on 23 Nov 2010, 20:58)</p>
									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=26439&amp;p=2.html">2</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>