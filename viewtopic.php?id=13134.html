<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Kamiakze Firmware &gt; 4MB</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 14 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p57988">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Oconnor</div>
					<div class="post-datetime">
						24 Oct 2007, 14:29					</div>
				</div>
				<div class="post-content content">
					<p>Hi, I&#039;m trying to compile Kamikaze 7.09 but I get an error that the Image is too large. I guess everytime the squashfs file is bigger as 4MB. I want to install the firmware to an Asus wl-500gP which has 8 MB flash.<br />I&#039;m getting following error:<br /></p><div class="quotebox"><blockquote><p>Creating little endian 3.0 filesystem on /home/oconnor/Desktop/kamikaze_7.09/build_mipsel/linux-2.6-brcm47xx/root.squashfs, block size 65536.</p><p>Little endian filesystem, data block size 65536, compressed data, compressed metadata, compressed fragments<br />Filesystem size 5056.67 Kbytes (4.94 Mbytes)<br />&nbsp; &nbsp; &nbsp; &nbsp; 29.32% of uncompressed filesystem size (17243.97 Kbytes)<br />Inode table size 7068 bytes (6.90 Kbytes)<br />&nbsp; &nbsp; &nbsp; &nbsp; 27.46% of uncompressed inode table size (25742 bytes)<br />Directory table size 7027 bytes (6.86 Kbytes)<br />&nbsp; &nbsp; &nbsp; &nbsp; 57.53% of uncompressed directory table size (12214 bytes)<br />Number of duplicate files found 0<br />Number of inodes 779<br />Number of files 500<br />Number of fragments 41<br />Number of symbolic links&nbsp; 206<br />Number of device nodes 0<br />Number of fifo nodes 0<br />Number of socket nodes 0<br />Number of directories 73<br />Number of uids 1<br />&nbsp; &nbsp; &nbsp; &nbsp; root (0)<br />Number of gids 0<br />/home/oconnor/Desktop/kamikaze_7.09/staging_dir_mipsel/bin/trx -o /home/oconnor/Desktop/kamikaze_7.09/bin/openwrt-brcm47xx-2.6-squashfs.trx -f /home/oconnor/Desktop/kamikaze_7.09/build_mipsel/linux-2.6-brcm47xx/loader.gz -f /home/oconnor/Desktop/kamikaze_7.09/build_mipsel/linux-2.6-brcm47xx/vmlinux.lzma -a 1024 -f /home/oconnor/Desktop/kamikaze_7.09/build_mipsel/linux-2.6-brcm47xx/root.squashfs -a 0x10000 -A /home/oconnor/Desktop/kamikaze_7.09/build_mipsel/linux-2.6-brcm47xx/fs_mark<br />mjn3&#039;s trx replacement - v0.81.1<br />fread failure or file &quot;/home/oconnor/Desktop/kamikaze_7.09/build_mipsel/linux-2.6-brcm47xx/root.squashfs&quot; too large<br />make[3]: *** [install] Error 1<br />make[3]: Leaving directory `/home/oconnor/Desktop/kamikaze_7.09/target/linux/brcm-2.4/image&#039;<br />make[2]: *** [image_install] Error 2<br />make[2]: Leaving directory `/home/oconnor/Desktop/kamikaze_7.09/target&#039;<br />make[1]: *** [target/install] Error 2<br />make[1]: Leaving directory `/home/oconnor/Desktop/kamikaze_7.09&#039;<br />make: *** [world] Fehler 2</p></blockquote></div><p>What can I do to build an larger Image?</p>											<p class="post-edited">(Last edited by <strong>Oconnor</strong> on 24 Oct 2007, 14:46)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p58195">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Oconnor</div>
					<div class="post-datetime">
						29 Oct 2007, 15:05					</div>
				</div>
				<div class="post-content content">
					<p>If the </p><div class="quotebox"><blockquote><p>Little endian filesystem, data block size 65536, compressed data, compressed metadata, compressed fragments Filesystem size</p></blockquote></div><p>is lager then 4,88 Mbytes. I&#039;m getting following error </p><div class="quotebox"><blockquote><p>fread failure or file &quot;/home/oconnor/Desktop/kamikaze_7.09/build_mipsel/linux-2.6-brcm47xx/root.squashfs&quot; too large</p></blockquote></div><p>I openned a ticket <a href="https://dev.openwrt.org/ticket/2626">https://dev.openwrt.org/ticket/2626</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p58201">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">basmevissen</div>
					<div class="post-datetime">
						29 Oct 2007, 19:03					</div>
				</div>
				<div class="post-content content">
					<p>As a work-around, you might select a jffs2 image type. With the 8MB of flash, you can easely do that.</p>											<p class="post-edited">(Last edited by <strong>basmevissen</strong> on 29 Oct 2007, 19:04)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p58243">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Oconnor</div>
					<div class="post-datetime">
						30 Oct 2007, 12:31					</div>
				</div>
				<div class="post-content content">
					<p>Same Error with jffs </p><div class="quotebox"><blockquote><p>fread failure or file &quot;/home/oconnor/Desktop/kamikaze_7.09/build_mipsel/linux-2.6-brcm47xx/root.jffs2-64k&quot; too large</p></blockquote></div><p>and I think jffs2 is not compressed. So the Image gets a lot bigger as 8 MB.</p>											<p class="post-edited">(Last edited by <strong>Oconnor</strong> on 30 Oct 2007, 12:34)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p58247">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">basmevissen</div>
					<div class="post-datetime">
						30 Oct 2007, 12:49					</div>
				</div>
				<div class="post-content content">
					<p>Ah, horror. The filesystem is 17MB!! What&#039;s all in there?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p58249">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Oconnor</div>
					<div class="post-datetime">
						30 Oct 2007, 13:07					</div>
				</div>
				<div class="post-content content">
					<p>I installed Sftp, Openvpn, eatherwake, hostapd, tcpdump, ntpclient, webif, a lot of usb stuff, php5, lighttpd, sqlite and samba. The squashfs file is about 4.75 MB and the jffs file would be 16,7 MB. All of packages are working and running but i also want to install screen, ntfs-3g, curl, spca for webcam and maybe amule and torrent. I have an USB Stick and could install all packages there, but I like to have it working without USB. Because if I update may router I have to install all packages again at the USB stick.<br />I have running a blog and a forum at the router with sqlite as database. And also have samba running for sharing some files in my lan, sftp to get acces to the files from the internet. And a minipci Atheros Card for wlan. I&#039;m experimenting with a webcam and want to have a downloadmanager running at the router.<br />Where can I change the file System Limit of 17 MB at jffs? Or the Limit of 4,78 MB at squashfs filesystem?</p>											<p class="post-edited">(Last edited by <strong>Oconnor</strong> on 30 Oct 2007, 13:42)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p58352">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">basmevissen</div>
					<div class="post-datetime">
						1 Nov 2007, 13:03					</div>
				</div>
				<div class="post-content content">
					<p>Ah, een complete server in a router :-) <br />The jffs2 file system has no limit AFAIK. But the flash is only 8MB, so 17MB won&#039;t fit.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p58356">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">Oconnor</div>
					<div class="post-datetime">
						1 Nov 2007, 15:40					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>basmevissen wrote:</cite><blockquote><p>Ah, een complete server in a router :-) <br />The jffs2 file system has no limit AFAIK. But the flash is only 8MB, so 17MB won&#039;t fit.</p></blockquote></div><p>There must be a limit! Or why do I get </p><div class="quotebox"><blockquote><p>fread failure or file &quot;/home/oconnor/Desktop/kamikaze_7.09/build_mipsel/linux-2.6-brcm47xx/root.jffs2-64k&quot; too large</p></blockquote></div><p>then I try to compile my Image. I do not need to Install the Image on a flash, I could install the Image to an usb-stick. And the Kernel on the flash loads that Image. Or I could install a Image at a larger flash. But there must be a limit for jffs2 (around 17MB) and squashfs (around 4.88MB). So what part of the code generates that output </p><div class="quotebox"><blockquote><p>fread failure or file &quot;/home/oconnor/Desktop/kamikaze_7.09/build_mipsel/linux-2.6-brcm47xx/root.jffs2-64k&quot; too large</p></blockquote></div><p>and checks if it is too large?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p63173">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">Oconnor</div>
					<div class="post-datetime">
						10 Feb 2008, 19:24					</div>
				</div>
				<div class="post-content content">
					<p>Hi, I found out that in the file &quot;.../trunk/config.in&quot; is written </p><div class="quotebox"><blockquote><p>source &quot;target/linux/*/image/Config.in&quot;</p><p>&nbsp; &nbsp; config TARGET_ROOTFS_FSPART<br />&nbsp; &nbsp; &nbsp; &nbsp; int &quot;Filesystem part size (in MB)&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; depends X86_GRUB_IMAGES || TARGET_ROOTFS_EXT2FS || TARGET_rb532 || TARGET_olpc<br />&nbsp; &nbsp; &nbsp; &nbsp; default 16<br />&nbsp; &nbsp; &nbsp; &nbsp; help<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Allows you to change the filesystem partition size</p></blockquote></div><p>So I guess that the limit of the squafs is at 16 MB. If I change in that config file the 16 to 26 and I recompile my Image, I still have the limit at 16 MB. So there must be an other Limit of the filesystemsize. Where can I find that?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p63224">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">Oconnor</div>
					<div class="post-datetime">
						11 Feb 2008, 18:07					</div>
				</div>
				<div class="post-content content">
					<p>The file &quot;.../trunk/staging_dir/host/bin/trx&quot; genrates the output &quot; fread failure or file &quot;.../linux-2.6-brcm47xx/root.squashfs&quot; too large. But that file is already a binary file. So I can&#039;t change any values. What file generates the file &quot;.../trunk/staging_dir/host/bin/trx&quot; ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p63225">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">Oconnor</div>
					<div class="post-datetime">
						11 Feb 2008, 18:25					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>basmevissen wrote:</cite><blockquote><p>Ah, een complete server in a router :-) <br />The jffs2 file system has no limit AFAIK. But the flash is only 8MB, so 17MB won&#039;t fit.</p></blockquote></div><p>You are right that a 17 MB jffs file system won&#039;t fit into a flash that only has 8MB. But I don&#039;t want to install the jffs system of 17MB I want to install the squashfs filesystem. The squashfs filesystem is the same as the jffs filesystem. Except that the squashfs filesystem is the compressed jffs. And compressed means that 17 MB jffs is about 5MB squashfs. And the 5 MB will fit into a 8 MB flash! But because of that error I can&#039;t compile larger images that will fit into the flash. So how can I compile larger images?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p63254">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">Oconnor</div>
					<div class="post-datetime">
						11 Feb 2008, 23:58					</div>
				</div>
				<div class="post-content content">
					<p>I got it. I changed the value TRX_MAX_LEN in the file &quot;.../trunk/tools/firmware-utils/src/trx.c&quot; in line 63 &quot;#define TRX_MAX_LEN&nbsp; &nbsp; 0x5A0000&quot; to a somthing higher value and then it worked <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />!</p><p>edit:<br />Or does it have any reason to limit the squashfs filesystem to 5898240 bytes (0x5A0000) or better said to 5,9MB. Can I now have problems after flashing my router with an larger image? If I just not reach the 8MB flash size Limit? Why does someone limited the squashfs filesystem to 5.9MB?</p>											<p class="post-edited">(Last edited by <strong>Oconnor</strong> on 12 Feb 2008, 00:26)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p64059">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">TDFKAOlli</div>
					<div class="post-datetime">
						26 Feb 2008, 00:47					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>thanks a lot, that also helped my build problems. Same thing I think, image was to large. I&#039;m trying it out for SimpleShare network drive and want to turn it into an IMAP server.</p><p>It looks to me that trx tool can get a separate parameter to allow bigger sizes (using -m). Probably this is something with should be configurable in the menuconfig (max size of image for trx tool). Or maybe it is configurable, but I couldn&#039;t find it ?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>