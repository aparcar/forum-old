<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> New Broadcom BCM63xx codebase with GPL&#039;d Ethernet and USB support</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 8 Feb 2018 and 7 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 8 of 30</div><nav><ul><li><a href="viewtopic.php%3Fid=17370&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=17370&amp;p=6.html">6</a></li><li><a href="viewtopic.php%3Fid=17370&amp;p=7.html">7</a></li><li class="pagination-current"><span>8</span></li><li><a href="viewtopic.php%3Fid=17370&amp;p=9.html">9</a></li><li><a href="viewtopic.php%3Fid=17370&amp;p=10.html">10</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=17370&amp;p=30.html">30</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p79045">
				<div class="post-metadata">
					<div class="post-num">Post #176</div>
					<div class="post-author">AndreyPopov</div>
					<div class="post-datetime">
						5 Jan 2009, 22:03					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jmike72 wrote:</cite><blockquote><div class="quotebox"><cite>t3l3m4k0 wrote:</cite><blockquote><p>* Version, i think, you must load is openwrt-96348GW-10-squashfs-cfe.bin</p></blockquote></div><p>That was the first verrsion I&#039;ve tryed to upload as &quot;96348GW-10&quot; was something I&#039;ve seen in the original firmware source code from Asus. Anyway, it&#039;s impossible for now to upload any of them as I don&#039;t have a serial console. I hope that the support for this router can advance a bit more and soon we can have a nice openwrt firmware on it.</p><p>Mike</p></blockquote></div><p>for ASUS WL-600G you can use <strong>ASUS Firmware Restoration Utility</strong> amd <em>Firmware restoration mode</em> to upload any different from ASUS trx file.<br />ASUS WL-600G NOT use tftp to accept file, when ASUS WL-600G in Firmware restoration mode you can access it by <a href="http://192.168.1.1">http://192.168.1.1</a> where you can see restoration page.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p79139">
				<div class="post-metadata">
					<div class="post-num">Post #177</div>
					<div class="post-author">LinuxInside</div>
					<div class="post-datetime">
						7 Jan 2009, 01:19					</div>
				</div>
				<div class="post-content content">
					<p>Yep, succeeded in creating OpenWRT firmware for the Davolink DV2020 / DV201AMR router</p><p>Here&#039;s the dmesg:</p><div class="codebox"><pre><code>*** Image flash done *** !
Successful.
Resetting board...Ã¿

CFE version 1.0.37-0.6 for BCM96348 (32bit,SP,BE)
Build Date: 2005-03-31 17:08:34 (root@ylinux)
DV-201AMR Boot ROM version: 1.6
H/W version: 02

Initializing Arena.
Initializing Devices.
Flash ID - 0xc2(0), 0x227e(1), 0x2210(e), 0x2200(f)
flash - size:8388608, nsect:135, base:0xbf800000
Checking running image.....
Running image good. Comparing running image to backup.....
Backup image is different from running image. Copying running to backup(2424832).....
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
Image copied to running.(2424832)
CPU type 0x29107: 256MHz, Bus: 128MHz, Ref: 32MHz

Total memory used by CFE:  0x80401000 - 0x80523330 (1188656)
Initialized Data:          0x8041B5C0 - 0x8041CCC0 (5888)
BSS Area:                  0x8041CCC0 - 0x80421330 (18032)
Local Heap:                0x80421330 - 0x80521330 (1048576)
Stack Area:                0x80521330 - 0x80523330 (8192)
Text (code) segment:       0x80401000 - 0x8041B5BC (107964)
Boot area (physical):      0x00524000 - 0x00564000
Relocation Factor:         I:00000000 - D:00000000

Board IP address                : 192.168.1.1:ffffff00  
Host IP address                 : 192.168.1.100  
Gateway IP address              :   
Run from flash/host (f/h)       : f  
Default host run file name      : vmlinux  
Default host flash file name    : bcm963xx_fs_kernel  
Boot delay (0-9 seconds)        : 1  
Board Id Name                   : DV201AMR  
Psi size in KB                  : 24
Number of MAC Addresses (1-32)  : 11  
Base MAC Address                : 00:15:f2:69:af:7e  
Ethernet PHY Type               : Internal
Memory size in MB               : 16

*** Press any key to stop auto run (1 seconds) ***
Auto run second count down: 110
Code Address: 0x80010000, Entry Address: 0x80010000
Decompression OK!
Entry at 0x80010000
Closing network.
Starting program at 0x80010000
Linux version 2.6.27.10 (root@fx41) (gcc version 4.1.2) #6 Tue Jan 6 22:27:18 CET 2009
Detected Broadcom 0x6348 CPU revision a2
CPU frequency is 256000000 MHz
16MB of RAM installed
board_bcm963xx: CFE version: 1.0.37-0.6
console [early0] enabled
CPU revision is: 00029107 (Broadcom BCM6348)
board_bcm963xx: board name: DV201AMR
Determined physical RAM map:
 memory: 01000000 @ 00000000 (usable)
Initrd not found or empty - disabling initrd
Zone PFN ranges:
  Normal   0x00000000 -&gt; 0x00001000
Movable zone start PFN for each node
early_node_map[1] active PFN ranges
    0: 0x00000000 -&gt; 0x00001000
Built 1 zonelists in Zone order, mobility grouping off.  Total pages: 4064
Kernel command line: root=/dev/mtdblock2 rootfstype=squashfs,jffs2 init=/etc/preinit noinitrd console=ttyS0,115200
Primary instruction cache 16kB, VIPT, 2-way, linesize 16 bytes.
Primary data cache 8kB, 2-way, VIPT, no aliases, linesize 16 bytes
PID hash table entries: 64 (order: 6, 256 bytes)
Dentry cache hash table entries: 2048 (order: 1, 8192 bytes)
Inode-cache hash table entries: 1024 (order: 0, 4096 bytes)
Memory: 13720k/16384k available (1867k kernel code, 2664k reserved, 321k data, 120k init, 0k highmem)
Calibrating delay loop... 254.97 BogoMIPS (lpj=509952)
Mount-cache hash table entries: 512
net_namespace: 592 bytes
NET: Registered protocol family 16
registering 37 GPIOs
registering PCI controller with io_map_base unset
pci 0000:00:01.0: PME# supported from D0 D1 D2 D3hot D3cold
pci 0000:00:01.0: PME# disabled
bus: 00 index 0 io port: [8000000, 800ffff]
bus: 00 index 1 mmio: [30000000, 37ffffff]
NET: Registered protocol family 2
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 512 (order: 0, 4096 bytes)
TCP bind hash table entries: 512 (order: -1, 2048 bytes)
TCP: Hash tables configured (established 512 bind 512)
TCP reno registered
NET: Registered protocol family 1
audit: initializing netlink socket (disabled)
type=2000 audit(0.286:1): initialized
squashfs: version 3.0 (2006/03/15) Phillip Lougher
Registering mini_fo version $Id$
JFFS2 version 2.2. (NAND) (SUMMARY)  Ã‚Â© 2001-2006 Red Hat, Inc.
msgmni has been set to 26
io scheduler noop registered
io scheduler cfq registered (default)
bcm63xx_uart.0: ttyS0 at MMIO 0xfffe0300 (irq = 10) is a bcm63xx_uart
console handover: boot [early0] -&gt; real [ttyS0]
bcm63xx_enet MII bus: probed
bcm963xx_flash: 0x00400000 at 0x1fc00000
bcm963xx: Found 1 x16 devices at 0x0 in 16-bit bank
NOR chip too large to fit in mapping. Attempting to cope...
 Amd/Fujitsu Extended Query Table at 0x0040
number of CFI chips: 1
cfi_cmdset_0002: Disabling erase-suspend-program due to code brokenness.
Reducing visibility of 8192KiB chip to 4096KiB
bcm963xx_flash: CFE found at 0x0
bcm963xx: found firmware OpenWrt for 6348.
Creating 4 MTD partitions on &quot;bcm963xx&quot;:
0x00000000-0x00010000 : &quot;CFE&quot;
0x0001010c-0x000d0000 : &quot;kernel&quot;
mtd: partition &quot;kernel&quot; doesn&#039;t start on an erase block boundary -- force read-only
0x000d0000-0x00260000 : &quot;rootfs&quot;
mtd: partition &quot;rootfs&quot; set to be root filesystem
mtd: partition &quot;rootfs_data&quot; created automatically, ofs=260000, len=0 
0x00260000-0x00400000 : &quot;rootfs_data&quot;
0x003f0000-0x00400000 : &quot;nvram&quot;
TCP bic registered
NET: Registered protocol family 17
VFS: Mounted root (squashfs filesystem) readonly.
Freeing unused kernel memory: 120k freed
Please be patient, while OpenWrt loads ...
Algorithmics/MIPS FPU Emulator v1.5
- preinit -
Press CTRL-C for failsafe
switching to jffs2
jffs2_scan_eraseblock(): End of filesystem marker found at 0xe0000
jffs2_build_filesystem(): unlocking the mtd device... done.
jffs2_build_filesystem(): erasing all blocks after the end marker... done.
mini_fo: using base directory: /
mini_fo: using storage directory: /jffs
- init -

Please press Enter to activate this console. bcm63xx_enet bcm63xx_enet.0: attached PHY at address 1 [Broadcom BCM63XX (1)]
bcm63xx_enet bcm63xx_enet.0: attached PHY at address 1 [Broadcom BCM63XX (1)]
eth1: link forced UP - 100/full - flow control off/off
device eth1 entered promiscuous mode
br-lan: topology change detected, propagating
br-lan: port 1(eth1) entering forwarding state
cfg80211: Using static regulatory domain info
cfg80211: Regulatory domain: US
    (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp)
    (2402000 KHz - 2472000 KHz @ 40000 KHz), (600 mBi, 2700 mBm)
    (5170000 KHz - 5190000 KHz @ 40000 KHz), (600 mBi, 2300 mBm)
    (5190000 KHz - 5210000 KHz @ 40000 KHz), (600 mBi, 2300 mBm)
    (5210000 KHz - 5230000 KHz @ 40000 KHz), (600 mBi, 2300 mBm)
    (5230000 KHz - 5330000 KHz @ 40000 KHz), (600 mBi, 2300 mBm)
    (5735000 KHz - 5835000 KHz @ 40000 KHz), (600 mBi, 3000 mBm)
cfg80211: Calling CRDA for country: US
br-lan: port 1(eth1) entering disabled state
br-lan: topology change detected, propagating
br-lan: port 1(eth1) entering forwarding state
PCI: Enabling device 0000:00:01.0 (0000 -&gt; 0002)
b43-phy0: Broadcom 4306 WLAN found
Broadcom 43xx driver loaded [ Features: PL, Firmware-ID: FW13 ]
PPP generic driver version 2.4.2
ip_tables: (C) 2000-2006 Netfilter Core Team
nf_conntrack version 0.5.0 (1024 buckets, 4096 max)
CONFIG_NF_CT_ACCT is deprecated and will be removed soon. Plase use
nf_conntrack.acct=1 kernel paramater, acct=1 nf_conntrack module option or
sysctl net.netfilter.nf_conntrack_acct=1 to enable it.

BusyBox v1.11.3 (2009-01-02 02:58:37 CET) built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 KAMIKAZE (bleeding edge, r13799) -------------------
  * 10 oz Vodka       Shake well with ice and strain
  * 10 oz Triple sec  mixture into 10 shot glasses.
  * 10 oz lime juice  Salute!
 ---------------------------------------------------
root@OpenWrt:/# df
Filesystem           1k-blocks      Used Available Use% Mounted on
rootfs                    1600      1600         0 100% /
/dev/root                 1600      1600         0 100% /rom
tmpfs                     6920        40      6880   1% /tmp
tmpfs                      512         0       512   0% /dev
/dev/mtdblock3            1664       252      1412  15% /jffs
mini_fo:/jffs             1600      1600         0 100% /</code></pre></div><p>There where a few problems with the CFE version it was running:<br />- It expects the rootfs direcly after the BCM tag, so it starts at xxxx100<br />- At startup the firmware image is checksummed, so we can&#039;t use a rw file systems as part of the firmware image. </p><p>In order to fix:<br />- Did some changes to<br />&nbsp; bcm_tag.h<br />&nbsp; board_bcm963xx.c<br />&nbsp; bcm963xx-flash.c<br />&nbsp; target/linux/brcm63xx/image/Makefile<br />- Created a custom bcmImageBuilder that will create bootable images.<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </p><p>If someone is interested I can send in a patch (edit: <a href="https://dev.openwrt.org/ticket/4433">Patch</a>)</p>											<p class="post-edited">(Last edited by <strong>LinuxInside</strong> on 8 Jan 2009, 21:27)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p79198">
				<div class="post-metadata">
					<div class="post-num">Post #178</div>
					<div class="post-author">florian_</div>
					<div class="post-datetime">
						7 Jan 2009, 19:17					</div>
				</div>
				<div class="post-content content">
					<p>Yes, please post the patches.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p79259">
				<div class="post-metadata">
					<div class="post-num">Post #179</div>
					<div class="post-author">RoundSparrow</div>
					<div class="post-datetime">
						8 Jan 2009, 05:57					</div>
				</div>
				<div class="post-content content">
					<p>are you guys with hostapd + b43 still having high CPU usage softirq issues?&nbsp; the ath9k driver is seeing the same problems.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p79375">
				<div class="post-metadata">
					<div class="post-num">Post #180</div>
					<div class="post-author">allexey</div>
					<div class="post-datetime">
						9 Jan 2009, 21:43					</div>
				</div>
				<div class="post-content content">
					<p>I have measured with iperf lan performance, and i have received&nbsp; 30Mb/s&nbsp; and softirq about 98%. I have also tried wireless, but performance was very low.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p79377">
				<div class="post-metadata">
					<div class="post-num">Post #181</div>
					<div class="post-author">t3l3m4k0</div>
					<div class="post-datetime">
						9 Jan 2009, 22:03					</div>
				</div>
				<div class="post-content content">
					<p>@ RoundSparrow<br />i don&#039;t use wifi, b43 pci card of my router is out.</p><p>@ Linuxinside<br />i test your perl script, i used command line like this:<br /> $ ./BrcmImage.pl -k vmlinux.lzma.cfe -r root.squashfs -c 6348 -b 96348GW-11 -i 1 -v<br /> $ kernel at 0xbfec951d length 0xbb94f(768335)<br /> $ rootfs at 0xbfc10100 length 0x2b941d(2855965)<br />router load firmware from web page, but at startup it hangs.<br />your script first load rootfs and them kernel, and openwrt don&#039;t like this order.<br />How i do use it?</p><p>Thnx for your greath work.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p79395">
				<div class="post-metadata">
					<div class="post-num">Post #182</div>
					<div class="post-author">LinuxInside</div>
					<div class="post-datetime">
						10 Jan 2009, 02:45					</div>
				</div>
				<div class="post-content content">
					<p>You&#039;ll heve to add -t (prefix load, entry, len to the kernel)<br />Also use -p this will align the root fs, and place it behind the kernel (you will have to install the patch<br />to&nbsp; bcm963xx-flash.c thoug)</p><p>./BrcmImage.pl -t -p -k vmlinux.lzma.cfe -r root.squashfs -c 6348 -b 96348GW-11 -i 1</p><p>Let me know if this helps...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p79409">
				<div class="post-metadata">
					<div class="post-num">Post #183</div>
					<div class="post-author">bluegeek</div>
					<div class="post-datetime">
						10 Jan 2009, 13:59					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>t3l3m4k0 wrote:</cite><blockquote><p>router load firmware from web page, but at startup it hangs.</p></blockquote></div><p>So, we can upload the compiled SVN firmware using the web interface but then you have to debrick it? What router are you using? </p><p>Also I&#039;ve seen it was added support for the Thomson/Inventel Livebox [1] router. Does anybody tried the firmware in this router?</p><p>Thanks and keep the good work!<br />-- blue</p><p>[1] <a href="https://dev.openwrt.org/changeset/13616">https://dev.openwrt.org/changeset/13616</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p79425">
				<div class="post-metadata">
					<div class="post-num">Post #184</div>
					<div class="post-author">t3l3m4k0</div>
					<div class="post-datetime">
						10 Jan 2009, 19:27					</div>
				</div>
				<div class="post-content content">
					<p>@ Linuxinside<br />I&#039;m using Comtrend 536 Router, (bcm6348 CPU, 6348GW-11 board)<br />With your patches of<br />* bcm963xx-flash.c<br />* bcm_tag.h<br />and your script<br />* brcmImage.pl<br />executed as:<br />$ ./brcmImage.pl -t -p -k vmlinux.lzma.cfe -r root.squashfs -c 6348 -b 96348GW-11 -i 1</p><p>it works like a charm!!!!</p><p>i see you have created a global partition named &quot;Linux&quot;, i think this will be useful when it become implemented for upgrade/reflash router from Luci.</p><p>congratulations, good work!!!</p><p>@ bluegeek,<br />1.- I&#039;m using a Comtrend 536 Router, (bcm6348 CPU, 6348GW-11 board).<br />2.- Linuxinside mods seems to work fine, i can send firmware via web page.<br />3.- If you put OpenWrt firmware, there is not yet implemented upgrade firmware from Luci ( openwrt web admin tool). When you must to reflash your router you need a serial port/console.<br />4.- I think Florian is working on Livebox routers (it uses reedboot, not CFE), at this moment i don&#039;t know&nbsp; how to put OpenWRT, maybe via serial ?, JTAG? .... . Perhaps Florian can give some ligth.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p79461">
				<div class="post-metadata">
					<div class="post-num">Post #185</div>
					<div class="post-author">bluegeek</div>
					<div class="post-datetime">
						11 Jan 2009, 12:39					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>t3l3m4k0 wrote:</cite><blockquote><p>3.- If you put OpenWrt firmware, there is not yet implemented upgrade firmware from Luci ( openwrt web admin tool). When you must to reflash your router you need a serial port/console.</p></blockquote></div><p>Maybe you can use TFTP for upgrading to another firmware after installing OpenWrt. Have you tried?<br /></p><div class="quotebox"><cite>t3l3m4k0 wrote:</cite><blockquote><p>4.- I think Florian is working on Livebox routers (it uses reedboot, not CFE), at this moment i don&#039;t know&nbsp; how to put OpenWRT, maybe via serial ?, JTAG? .... . Perhaps Florian can give some ligth.</p></blockquote></div><p>It seems you can use TFTP for installing another firmware if you first patch the RedBoot loader [1] but I haven&#039;t tryed yet. Also I have compiled the last SVN OpenWrt for Livebox and it seems only builds the kernel not the firmware image.</p><p>[1] <a href="http://www.dbzoo.com/wiki/livebox/livebox#replacing_the_redboot_loader">http://www.dbzoo.com/wiki/livebox/liveb … oot_loader</a><br />fcp -v redboot_blueg5.6-patched /dev/mtd0<br />(redboot patched form: <a href="http://darkfader.net/livebox)">http://darkfader.net/livebox)</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p79479">
				<div class="post-metadata">
					<div class="post-num">Post #186</div>
					<div class="post-author">t3l3m4k0</div>
					<div class="post-datetime">
						11 Jan 2009, 18:47					</div>
				</div>
				<div class="post-content content">
					<p>@ bluegeek,<br />tftp already works.<br />Also if you create&nbsp; platform.sh script in /lib/upgrade ,with this:<br />root@openwrt:/# cat /lib/upgrade/platform.sh<br />---------------------------------------------------------------------------------<br />PART_NAME=Linux</p><p>platform_check_image() {<br />&nbsp; &nbsp; [ &quot;$ARGC&quot; -gt 1 ] &amp;&amp; return 1</p><p>&nbsp; &nbsp; case &quot;$(get_magic_word &quot;$1&quot;)&quot; in<br />&nbsp; &nbsp; &nbsp; &nbsp; # 6348GW-11 boards<br />&nbsp; &nbsp; &nbsp; &nbsp; 3600) return 0;;<br />&nbsp; &nbsp; &nbsp; &nbsp; *)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo &quot;Invalid image type. Please use only apropiate files&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return 1<br />&nbsp; &nbsp; &nbsp; &nbsp; ;;<br />&nbsp; &nbsp; esac<br />}<br />-----------------------------------------------------------------------------------<br />and if you put &quot;firmware&quot; file, for example in /tmp , system command:<br /> sysupgrade /tmp/firmware<br />also works.</p><br /><p>about Livebox, i don&#039;t know. ???</p><p>regards</p>											<p class="post-edited">(Last edited by <strong>t3l3m4k0</strong> on 11 Jan 2009, 18:48)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p79642">
				<div class="post-metadata">
					<div class="post-num">Post #187</div>
					<div class="post-author">florian_</div>
					<div class="post-datetime">
						14 Jan 2009, 22:33					</div>
				</div>
				<div class="post-content content">
					<p>I got both Livebox and BCM6348GW board, I have little time to test again LinuxInsides&#039;s modification but they should be fine now.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p79649">
				<div class="post-metadata">
					<div class="post-num">Post #188</div>
					<div class="post-author">t3l3m4k0</div>
					<div class="post-datetime">
						15 Jan 2009, 01:03					</div>
				</div>
				<div class="post-content content">
					<p>last mod, in ticket, from Linuxinside don&#039;t work for me.<br />regards</p>											<p class="post-edited">(Last edited by <strong>t3l3m4k0</strong> on 15 Jan 2009, 01:03)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p79659">
				<div class="post-metadata">
					<div class="post-num">Post #189</div>
					<div class="post-author">LinuxInside</div>
					<div class="post-datetime">
						15 Jan 2009, 09:47					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>t3l3m4k0 wrote:</cite><blockquote><p>last mod, in ticket, from Linuxinside don&#039;t work for me.</p></blockquote></div><p>Thanks for testing it. Can you add a dmesg to the ticket?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p79680">
				<div class="post-metadata">
					<div class="post-num">Post #190</div>
					<div class="post-author">t3l3m4k0</div>
					<div class="post-datetime">
						15 Jan 2009, 22:53					</div>
				</div>
				<div class="post-content content">
					<p>@ LinuxInside,<br />First of all thnx to you.<br />this is the log when i put firmware r 13034, with your last patches.<br /></p><div class="codebox"><pre><code>=~=~=~=~=~=~=~=~=~=~=~= PuTTY log 2009.01.15 21:28:07 =~=~=~=~=~=~=~=~=~=~=~=


CFE version 1.0.37-0.8 for BCM96348 (32bit,SP,BE)
Build Date: Â¥|  2Â¤Ã« 14 14:18:59 CST 2008 (root@Yau)
Copyright (C) 2000,2001,2002,2003 Broadcom Corporation.

Initializing Arena.
Initializing Devices.
CPU type 0x29107: 256MHz, Bus: 128MHz, Ref: 32MHz

Total memory used by CFE:  0x80401000 - 0x80524880 (1194112)
Initialized Data:          0x8041C810 - 0x8041E210 (6656)
BSS Area:                  0x8041E210 - 0x80422880 (18032)
Local Heap:                0x80422880 - 0x80522880 (1048576)
Stack Area:                0x80522880 - 0x80524880 (8192)
Text (code) segment:       0x80401000 - 0x8041C804 (112644)
Boot area (physical):      0x00525000 - 0x00565000
Relocation Factor:         I:00000000 - D:00000000

Board IP address                : 192.168.1.19:ffffff00  
Host IP address                 : 192.168.1.21  
Gateway IP address              : 192.168.1.1  
Run from flash/host (f/h)       : f  
Default host run file name      : vmlinux  
Default host flash file name    : r13370.bin  
Boot delay (0-9 seconds)        : 1  
Board Id Name                   : 96348GW-11  
Psi size in KB                  : 24
Number of MAC Addresses (1-32)  : 11  
Base MAC Address                : 00:11:00:11:00:11  
Ethernet PHY Type               : Internal
Memory size in MB               : 16

*** Press any key to stop auto run (1 seconds) ***
Auto run second count down: 111
CFE&gt; 
web info: Waiting for connection on socket 0.[J

CFE&gt; 
CFE&gt; 
web info: Waiting for connection on socket 1.[J

CFE&gt; 
web info: Waiting for connection on socket 0.[J

CFE&gt; 
web info: Waiting for connection on socket 1.[J

CFE&gt; 
web info: Waiting for connection on socket 0.[J

CFE&gt; 
web info: Upload 2956130 bytes, Broadcom image format.[J

CFE&gt; 
Flashing root file system and kernel: ..............................................

.
*** Image flash done *** !
Resetting board...

CFE version 1.0.37-0.8 for BCM96348 (32bit,SP,BE)
Build Date: Â¥|  2Â¤Ã« 14 14:18:59 CST 2008 (root@Yau)
Copyright (C) 2000,2001,2002,2003 Broadcom Corporation.

Initializing Arena.
Initializing Devices.
CPU type 0x29107: 256MHz, Bus: 128MHz, Ref: 32MHz

Total memory used by CFE:  0x80401000 - 0x80524880 (1194112)
Initialized Data:          0x8041C810 - 0x8041E210 (6656)
BSS Area:                  0x8041E210 - 0x80422880 (18032)
Local Heap:                0x80422880 - 0x80522880 (1048576)
Stack Area:                0x80522880 - 0x80524880 (8192)
Text (code) segment:       0x80401000 - 0x8041C804 (112644)
Boot area (physical):      0x00525000 - 0x00565000
Relocation Factor:         I:00000000 - D:00000000

Board IP address                : 192.168.1.19:ffffff00  
Host IP address                 : 192.168.1.21  
Gateway IP address              : 192.168.1.1  
Run from flash/host (f/h)       : f  
Default host run file name      : vmlinux  
Default host flash file name    : r13370.bin  
Boot delay (0-9 seconds)        : 1  
Board Id Name                   : 96348GW-11  
Psi size in KB                  : 24
Number of MAC Addresses (1-32)  : 11  
Base MAC Address                : 00:30:da:59:18:86  
Ethernet PHY Type               : Internal
Memory size in MB               : 16

*** Press any key to stop auto run (1 seconds) ***
Auto run second count down: 110
GPIOio_PIN_HIGH is Off
Code Address: 0x80010000, Entry Address: 0x80010000
Decompression OK!
Entry at 0x80010000
Closing network.
Starting program at 0x80010000
Linux version 2.6.27.10 (HTPC@localhost.localdomain) (gcc version 4.1.2) #6 Wed Jan 14 11:06:32 CET 2009
Detected Broadcom 0x6348 CPU revision a2
CPU frequency is 256000000 MHz
16MB of RAM installed
board_bcm963xx: CFE version: 1.0.37-0.8
console [early0] enabled
CPU revision is: 00029107 (Broadcom BCM6348)
board_bcm963xx: board name: 96348GW-11
Determined physical RAM map:
 memory: 01000000 @ 00000000 (usable)
Initrd not found or empty - disabling initrd
Zone PFN ranges:
  Normal   0x00000000 -&gt; 0x00001000
Movable zone start PFN for each node
early_node_map[1] active PFN ranges
    0: 0x00000000 -&gt; 0x00001000
Built 1 zonelists in Zone order, mobility grouping off.  Total pages: 4064
Kernel command line: root=/dev/mtdblock2 rootfstype=squashfs,jffs2 init=/etc/preinit noinitrd console=ttyS0,115200
Primary instruction cache 16kB, VIPT, 2-way, linesize 16 bytes.
Primary data cache 8kB, 2-way, VIPT, no aliases, linesize 16 bytes
PID hash table entries: 64 (order: 6, 256 bytes)
Dentry cache hash table entries: 2048 (order: 1, 8192 bytes)
Inode-cache hash table entries: 1024 (order: 0, 4096 bytes)
Memory: 13712k/16384k available (1870k kernel code, 2672k reserved, 327k data, 120k init, 0k highmem)
Calibrating delay loop... 255.48 BogoMIPS (lpj=510976)
Mount-cache hash table entries: 512
net_namespace: 592 bytes
NET: Registered protocol family 16
registering 37 GPIOs
registering PCI controller with io_map_base unset
bus: 00 index 0 io port: [8000000, 800ffff]
bus: 00 index 1 mmio: [30000000, 37ffffff]
NET: Registered protocol family 2
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 512 (order: 0, 4096 bytes)
TCP bind hash table entries: 512 (order: -1, 2048 bytes)
TCP: Hash tables configured (established 512 bind 512)
TCP reno registered
NET: Registered protocol family 1
audit: initializing netlink socket (disabled)
type=2000 audit(0.269:1): initialized
squashfs: version 3.0 (2006/03/15) Phillip Lougher
Registering mini_fo version $Id$
JFFS2 version 2.2. (NAND) (SUMMARY)  Ã‚Â© 2001-2006 Red Hat, Inc.
msgmni has been set to 26
io scheduler noop registered
io scheduler cfq registered (default)
bcm63xx_uart.0: ttyS0 at MMIO 0xfffe0300 (irq = 10) is a bcm63xx_uart
console handover: boot [early0] -&gt; real [ttyS0]
bcm63xx_enet MII bus: probed
bcm963xx_flash: 0x00400000 at 0x1fc00000
bcm963xx: Found 1 x16 devices at 0x0 in 16-bit bank
 Amd/Fujitsu Extended Query Table at 0x0040
number of CFI chips: 1
cfi_cmdset_0002: Disabling erase-suspend-program due to code brokenness.
bcm963xx_flash: Read Signature value of CFE1CFE1
bcm963xx_flash: CFE bootloader detected
bcm963xx_flash: CFE boot tag found with version 6 and board type 96348GW-11.
bcm963xx_flash: Partition 0 is CFE offset 0 and length 10000
bcm963xx_flash: Partition 1 is kernel offset 1010c and length 2d1a56
bcm963xx_flash: Partition 2 is rootfs offset 10100 and length 10000c
bcm963xx_flash: Partition 3 is nvram offset 3f0000 and length 10000
Creating 4 MTD partitions on &quot;bcm963xx&quot;:
0x00000000-0x00010000 : &quot;CFE&quot;
0x0001010c-0x002e1b62 : &quot;kernel&quot;
mtd: partition &quot;kernel&quot; doesn&#039;t start on an erase block boundary -- force read-only
0x00010100-0x0011010c : &quot;rootfs&quot;
mtd: partition &quot;rootfs&quot; doesn&#039;t start on an erase block boundary -- force read-only
mtd: partition &quot;rootfs&quot; set to be root filesystem
split_squashfs: no squashfs found in &quot;bcm963xx&quot;
0x003f0000-0x00400000 : &quot;nvram&quot;
TCP bic registered
NET: Registered protocol family 17
jffs2: Flash size not aligned to erasesize, reducing to 1024KiB
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00000000: 0x674f instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00000004: 0x000b instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00000008: 0x0022 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0000000c: 0x8001 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00000010: 0x8001 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00000014: 0x000b instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00000018: 0x5d00 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00000020: 0x0833 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00000024: 0xfd76 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00000028: 0x0848 instead
Further such events for this erase block will not be printed
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00010000: 0x5021 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00010004: 0xd898 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00010008: 0xbdf9 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0001000c: 0x44f7 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00010010: 0x11ff instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00010014: 0x00b5 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00010018: 0x4b5c instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0001001c: 0x31a3 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00010020: 0x09c2 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00010024: 0x991a instead
Further such events for this erase block will not be printed
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00020000: 0xaee4 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00020004: 0x9fd6 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00020008: 0xe837 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0002000c: 0xcb2e instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00020010: 0x9793 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00020014: 0xcd5a instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00020018: 0x6679 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0002001c: 0x8e75 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00020020: 0x2908 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00020024: 0x61b7 instead
Further such events for this erase block will not be printed
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00030000: 0xb7b8 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00030004: 0x9ce7 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00030008: 0x0ee9 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0003000c: 0x4e4d instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00030010: 0x13a4 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00030014: 0x442a instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00030018: 0x68d2 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0003001c: 0x1c08 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00030020: 0xb072 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00030024: 0x032e instead
Further such events for this erase block will not be printed
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00040000: 0x9804 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00040004: 0xc9a4 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00040008: 0x56ce instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0004000c: 0x1b2a instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00040010: 0xb6bd instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00040014: 0x7523 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00040018: 0x1817 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0004001c: 0x751b instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00040020: 0xd98f instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00040024: 0x72cc instead
Further such events for this erase block will not be printed
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00050000: 0x32a6 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00050004: 0x902f instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00050008: 0xa667 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0005000c: 0x7872 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00050010: 0xf045 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00050014: 0x910b instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00050018: 0xee86 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0005001c: 0x8a22 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00050020: 0xf92c instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00050024: 0x4c87 instead
Further such events for this erase block will not be printed
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00060000: 0xeb7e instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00060004: 0x5d6c instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00060008: 0x00a6 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0006000c: 0xfaa3 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00060010: 0x960c instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00060014: 0xa5f9 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00060018: 0x5d7a instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0006001c: 0x3543 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00060020: 0x372e instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00060024: 0x4c55 instead
Further such events for this erase block will not be printed
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00070000: 0xf317 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00070004: 0xd3dc instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00070008: 0x8913 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0007000c: 0x7016 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00070010: 0x5ddf instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00070014: 0xc112 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00070018: 0x8546 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0007001c: 0xd746 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00070020: 0xd7e1 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00070024: 0xa95c instead
Further such events for this erase block will not be printed
Old JFFS2 bitmask found at 0x00073e8c
You cannot use older JFFS2 filesystems with newer kernels
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00080000: 0xfd79 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00080004: 0xcedd instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00080008: 0x0836 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0008000c: 0x8553 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00080010: 0x0caa instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00080014: 0xe7ba instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00080018: 0x9fa5 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0008001c: 0x71ff instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00080020: 0x4a80 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00080024: 0x35d0 instead
Further such events for this erase block will not be printed
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00090000: 0x35ee instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00090004: 0xbc49 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00090008: 0xe65d instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0009000c: 0xb159 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00090010: 0xd6c5 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00090014: 0xcb2b instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00090018: 0x9ac0 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0009001c: 0xc781 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00090020: 0x5db8 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00090024: 0xceaf instead
Further such events for this erase block will not be printed
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000a0000: 0xcbcb instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000a0004: 0x8e80 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000a0008: 0x3b47 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000a000c: 0x5e5d instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000a0010: 0x3026 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000a0014: 0x1b2d instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000a0018: 0xa54e instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000a001c: 0xca96 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000a0020: 0x4531 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000a0024: 0x1580 instead
Further such events for this erase block will not be printed
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000b0000: 0x60fa instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000b0004: 0xbcfd instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000b0008: 0x849e instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000b000c: 0x742f instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000b0010: 0x4858 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000b0014: 0x6186 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000b0018: 0xa3e8 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000b001c: 0xd0f2 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000b0020: 0x4bc2 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000b0024: 0x6d50 instead
Further such events for this erase block will not be printed
Empty flash at 0x000bbdc4 ends at 0x000bff00
Empty flash at 0x000bff70 ends at 0x000bff74
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000c0000: 0xbb4c instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000c0004: 0x5652 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000c0008: 0xf82b instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000c000c: 0x60a9 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000c0010: 0x880a instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000c0014: 0xc342 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000c0018: 0x87d5 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000c001c: 0x2ac0 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000c0020: 0xce09 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000c0024: 0xfd52 instead
Further such events for this erase block will not be printed
Old JFFS2 bitmask found at 0x000c4230
You cannot use older JFFS2 filesystems with newer kernels
Old JFFS2 bitmask found at 0x000ca924
You cannot use older JFFS2 filesystems with newer kernels
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000d0000: 0x3085 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000d0004: 0x0f93 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000d0008: 0x5016 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000d000c: 0x47a2 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000d0010: 0x2304 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000d0014: 0x2c6a instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000d0018: 0x7bab instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000d001c: 0xb510 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000d0020: 0x0769 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000d0024: 0x2874 instead
Further such events for this erase block will not be printed
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000e0000: 0x9a2e instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000e0004: 0x0189 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000e0008: 0xb8ea instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000e000c: 0x5f2b instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000e0010: 0x8855 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000e0014: 0x7829 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000e0018: 0x68d3 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000e001c: 0xd7b8 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000e0020: 0x2b62 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000e0024: 0x3834 instead
Further such events for this erase block will not be printed
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000f0000: 0xe3a6 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000f0004: 0x45d8 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000f0008: 0xa9c4 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000f000c: 0xf47c instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000f0010: 0xc77a instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000f0014: 0xc75c instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000f0018: 0xe5bf instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000f001c: 0x319c instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000f0020: 0xf005 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000f0024: 0x4663 instead
Further such events for this erase block will not be printed
Cowardly refusing to erase blocks on filesystem with no valid JFFS2 nodes
empty_blocks 0, bad_blocks 0, c-&gt;nr_blocks 16
VFS: Cannot open root device &quot;mtdblock2&quot; or unknown-block(31,2)
Please append a correct &quot;root=&quot; boot option; here are the available partitions:
1f00         64 mtdblock0 (driver?)
1f01       2886 mtdblock1 (driver?)
1f02       1024 mtdblock2 (driver?)
1f03         64 mtdblock3 (driver?)
Kernel panic - not syncing: VFS: Unable to mount root fs on unknown-block(31,2)</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p79756">
				<div class="post-metadata">
					<div class="post-num">Post #191</div>
					<div class="post-author">LinuxInside</div>
					<div class="post-datetime">
						17 Jan 2009, 07:58					</div>
				</div>
				<div class="post-content content">
					<p>These messages belong to the old bcm963xx_flash driver.</p><div class="codebox"><pre><code>bcm963xx_flash: Read Signature value of CFE1CFE1
bcm963xx_flash: CFE bootloader detected
bcm963xx_flash: CFE boot tag found with version 6 and board type 96348GW-11.
bcm963xx_flash: Partition 0 is CFE offset 0 and length 10000
bcm963xx_flash: Partition 1 is kernel offset 1010c and length 2d1a56
bcm963xx_flash: Partition 2 is rootfs offset 10100 and length 10000c
bcm963xx_flash: Partition 3 is nvram offset 3f0000 and length 10000</code></pre></div><p>Are you sure you applied the patches?</p><p>I suspect you probably used an unpatched kernel?</p><p>Can you verify?</p>											<p class="post-edited">(Last edited by <strong>LinuxInside</strong> on 17 Jan 2009, 07:59)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p79769">
				<div class="post-metadata">
					<div class="post-num">Post #192</div>
					<div class="post-author">t3l3m4k0</div>
					<div class="post-datetime">
						17 Jan 2009, 15:41					</div>
				</div>
				<div class="post-content content">
					<p>@ LinuxInside,<br />Sorry,<br />supose i made some mistake, you are rigth (in your patch nvram partition is disabled and there is a new Linux partition). I tried it another time, last time i tried it so fast...<br />It seems there is a problem with rootfs-data partition, it is not erased and it holds previous values.<br />Last version i made a pivot_root on a usb drive and after flash it with your patch it tried also do a pivot_root other time (you ca see it in log).<br />This is firmware update log:<br /></p><div class="codebox"><pre><code>CFE version 1.0.37-0.8 for BCM96348 (32bit,SP,BE)
Build Date: Â¥|  2Â¤Ã« 14 14:18:59 CST 2008 (root@Yau)
Copyright (C) 2000,2001,2002,2003 Broadcom Corporation.

Initializing Arena.
Initializing Devices.
CPU type 0x29107: 256MHz, Bus: 128MHz, Ref: 32MHz

Total memory used by CFE:  0x80401000 - 0x80524880 (1194112)
Initialized Data:          0x8041C810 - 0x8041E210 (6656)
BSS Area:                  0x8041E210 - 0x80422880 (18032)
Local Heap:                0x80422880 - 0x80522880 (1048576)
Stack Area:                0x80522880 - 0x80524880 (8192)
Text (code) segment:       0x80401000 - 0x8041C804 (112644)
Boot area (physical):      0x00525000 - 0x00565000
Relocation Factor:         I:00000000 - D:00000000

Board IP address                : 192.168.1.19:ffffff00  
Host IP address                 : 192.168.1.21  
Gateway IP address              : 192.168.1.1  
Run from flash/host (f/h)       : f  
Default host run file name      : vmlinux  
Default host flash file name    : r13370.bin  
Boot delay (0-9 seconds)        : 1  
Board Id Name                   : 96348GW-11  
Psi size in KB                  : 24
Number of MAC Addresses (1-32)  : 11  
Base MAC Address                : 00:30:da:59:18:86  
Ethernet PHY Type               : Internal
Memory size in MB               : 16

*** Press any key to stop auto run (1 seconds) ***
Auto run second count down: 111
CFE&gt; 
web info: Waiting for connection on socket 0.[J

CFE&gt;  
web info: Waiting for connection on socket 1.[J

CFE&gt;  
web info: Waiting for connection on socket 0.[J

CFE&gt;  
web info: Waiting for connection on socket 1.[J

CFE&gt;  
web info: Waiting for connection on socket 0.[J

CFE&gt;  
web info: Upload 2956247 bytes, Broadcom image format.[J

CFE&gt;  
Flashing root file system and kernel: ..............................................

.
*** Image flash done *** !
Resetting board...

CFE version 1.0.37-0.8 for BCM96348 (32bit,SP,BE)
Build Date: Â¥|  2Â¤Ã« 14 14:18:59 CST 2008 (root@Yau)
Copyright (C) 2000,2001,2002,2003 Broadcom Corporation.

Initializing Arena.
Initializing Devices.
CPU type 0x29107: 256MHz, Bus: 128MHz, Ref: 32MHz

Total memory used by CFE:  0x80401000 - 0x80524880 (1194112)
Initialized Data:          0x8041C810 - 0x8041E210 (6656)
BSS Area:                  0x8041E210 - 0x80422880 (18032)
Local Heap:                0x80422880 - 0x80522880 (1048576)
Stack Area:                0x80522880 - 0x80524880 (8192)
Text (code) segment:       0x80401000 - 0x8041C804 (112644)
Boot area (physical):      0x00525000 - 0x00565000
Relocation Factor:         I:00000000 - D:00000000

Board IP address                : 192.168.1.19:ffffff00  
Host IP address                 : 192.168.1.21  
Gateway IP address              : 192.168.1.1  
Run from flash/host (f/h)       : f  
Default host run file name      : vmlinux  
Default host flash file name    : r13370.bin  
Boot delay (0-9 seconds)        : 1  
Board Id Name                   : 96348GW-11  
Psi size in KB                  : 24
Number of MAC Addresses (1-32)  : 11  
Base MAC Address                : 00:30:da:59:18:86  
Ethernet PHY Type               : Internal
Memory size in MB               : 16

*** Press any key to stop auto run (1 seconds) ***
Auto run second count down: 110
GPIOio_PIN_HIGH is Off
Code Address: 0x80010000, Entry Address: 0x80010000
Decompression OK!
Entry at 0x80010000
Closing network.
Starting program at 0x80010000
Linux version 2.6.27.11 (HTPC@localhost.localdomain) (gcc version 4.1.2) #2 Sat Jan 17 14:05:19 CET 2009
Detected Broadcom 0x6348 CPU revision a2
CPU frequency is 256000000 MHz
16MB of RAM installed
board_bcm963xx: CFE version: 1.0.37-0.8
console [early0] enabled
CPU revision is: 00029107 (Broadcom BCM6348)
board_bcm963xx: board name: 96348GW-11
Determined physical RAM map:
 memory: 01000000 @ 00000000 (usable)
Initrd not found or empty - disabling initrd
Zone PFN ranges:
  Normal   0x00000000 -&gt; 0x00001000
Movable zone start PFN for each node
early_node_map[1] active PFN ranges
    0: 0x00000000 -&gt; 0x00001000
Built 1 zonelists in Zone order, mobility grouping off.  Total pages: 4064
Kernel command line: root=/dev/mtdblock2 rootfstype=squashfs,jffs2 init=/etc/preinit noinitrd console=ttyS0,115200
Primary instruction cache 16kB, VIPT, 2-way, linesize 16 bytes.
Primary data cache 8kB, 2-way, VIPT, no aliases, linesize 16 bytes
PID hash table entries: 64 (order: 6, 256 bytes)
Dentry cache hash table entries: 2048 (order: 1, 8192 bytes)
Inode-cache hash table entries: 1024 (order: 0, 4096 bytes)
Memory: 13712k/16384k available (1870k kernel code, 2672k reserved, 326k data, 120k init, 0k highmem)
Calibrating delay loop... 255.48 BogoMIPS (lpj=510976)
Mount-cache hash table entries: 512
net_namespace: 592 bytes
NET: Registered protocol family 16
registering 37 GPIOs
registering PCI controller with io_map_base unset
bus: 00 index 0 io port: [8000000, 800ffff]
bus: 00 index 1 mmio: [30000000, 37ffffff]
NET: Registered protocol family 2
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 512 (order: 0, 4096 bytes)
TCP bind hash table entries: 512 (order: -1, 2048 bytes)
TCP: Hash tables configured (established 512 bind 512)
TCP reno registered
NET: Registered protocol family 1
audit: initializing netlink socket (disabled)
type=2000 audit(0.269:1): initialized
squashfs: version 3.0 (2006/03/15) Phillip Lougher
Registering mini_fo version $Id$
JFFS2 version 2.2. (NAND) (SUMMARY)  Ã‚Â© 2001-2006 Red Hat, Inc.
msgmni has been set to 26
io scheduler noop registered
io scheduler cfq registered (default)
bcm63xx_uart.0: ttyS0 at MMIO 0xfffe0300 (irq = 10) is a bcm63xx_uart
console handover: boot [early0] -&gt; real [ttyS0]
bcm63xx_enet MII bus: probed
bcm963xx_flash: 0x00400000 at 0x1fc00000
bcm963xx: Found 1 x16 devices at 0x0 in 16-bit bank
 Amd/Fujitsu Extended Query Table at 0x0040
number of CFI chips: 1
cfi_cmdset_0002: Disabling erase-suspend-program due to code brokenness.
bcm963xx_flash: CFE found at 0x0
bcm963xx: found firmware 96348GW-11 for 6348.
Creating 4 MTD partitions on &quot;bcm963xx&quot;:
0x00000000-0x00010000 : &quot;CFE&quot;
0x0001010c-0x000d0000 : &quot;kernel&quot;
mtd: partition &quot;kernel&quot; doesn&#039;t start on an erase block boundary -- force read-only
0x000d0000-0x002f0000 : &quot;rootfs&quot;
mtd: partition &quot;rootfs&quot; set to be root filesystem
mtd: partition &quot;rootfs_data&quot; created automatically, ofs=2F0000, len=0 
0x002f0000-0x00400000 : &quot;rootfs_data&quot;
0x00010000-0x00400000 : &quot;Linux&quot;
TCP bic registered
NET: Registered protocol family 17
VFS: Mounted root (squashfs filesystem) readonly.
Freeing unused kernel memory: 120k freed
Please be patient, while OpenWrt loads ...
Algorithmics/MIPS FPU Emulator v1.5
- preinit -
Press CTRL-C for failsafe
switching to jffs2
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00000000: 0x4662 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00000004: 0xefb0 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00000008: 0x0c97 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0000000c: 0x28f5 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00000010: 0xf526 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00000014: 0x7f50 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00000018: 0x7567 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0000001c: 0xf6c1 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00000020: 0xdf39 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00000024: 0xcd0b instead
Further such events for this erase block will not be printed
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00010000: 0xde2b instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00010004: 0x04fd instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00010008: 0x1d33 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0001000c: 0x5057 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00010010: 0x9378 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00010014: 0xa790 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00010018: 0x2bd5 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0001001c: 0xa3eb instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00010020: 0x660e instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00010024: 0x08db instead
Further such events for this erase block will not be printed
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00020000: 0x2b10 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00020004: 0x82b1 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00020008: 0x61fa instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0002000c: 0xc1be instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00020010: 0xba2a instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00020014: 0x57a1 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00020018: 0xe242 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0002001c: 0x6c6b instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00020020: 0x1d02 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00020024: 0x8596 instead
Further such events for this erase block will not be printed
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00030000: 0x731a instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00030004: 0x7cec instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00030008: 0x54c4 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0003000c: 0x7cc6 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00030010: 0x1384 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00030014: 0x5c04 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00030018: 0xb200 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0003001c: 0x6795 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00030020: 0xb472 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00030024: 0x4c3f instead
Further such events for this erase block will not be printed
Old JFFS2 bitmask found at 0x00031c6c
You cannot use older JFFS2 filesystems with newer kernels
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00040000: 0xac5c instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00040004: 0xfdd7 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00040008: 0x9d31 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0004000c: 0x9df3 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00040010: 0x46a9 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00040014: 0xd89b instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00040018: 0x7fdd instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0004001c: 0xd115 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00040020: 0x7319 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00040024: 0xcdba instead
Further such events for this erase block will not be printed
Old JFFS2 bitmask found at 0x00040040
You cannot use older JFFS2 filesystems with newer kernels
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00050000: 0x896c instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00050004: 0x337a instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00050008: 0xf33b instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0005000c: 0x079b instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00050010: 0xb800 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00050014: 0x3c97 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00050018: 0xee4f instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0005001c: 0x86e4 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00050020: 0x8546 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00050024: 0xcc99 instead
Further such events for this erase block will not be printed
mini_fo: using base directory: /
mini_fo: using storage directory: /jffs
- init -
pivotroot?
usbcore: registered new interface driver usbfs
usbcore: registered new interface driver hub
usbcore: registered new device driver usb
bcm63xx_ohci bcm63xx_ohci.0: BCM63XX integrated OHCI controller
bcm63xx_ohci bcm63xx_ohci.0: new USB bus registered, assigned bus number 1
bcm63xx_ohci bcm63xx_ohci.0: irq 20, io mem 0xfffe1b00
usb usb1: configuration #1 chosen from 1 choice
hub 1-0:1.0: USB hub found
hub 1-0:1.0: 2 ports detected
usb 1-1: new full speed USB device using bcm63xx_ohci and address 2
SCSI subsystem initialized
usb 1-1: configuration #1 chosen from 1 choice
hub 1-1:1.0: USB hub found
hub 1-1:1.0: 4 ports detected
Driver &#039;sd&#039; needs updating - please use bus_type methods
Initializing USB Mass Storage driver...
usbcore: registered new interface driver usb-storage
USB Mass Storage support registered.
Filesystem                Size      Used Available Use% Mounted on
rootfs                    2.1M      2.1M         0 100% /
/dev/root                 2.1M      2.1M         0 100% /rom
tmpfs                     6.8M         0      6.8M   0% /tmp
tmpfs                   512.0k         0    512.0k   0% /dev
/dev/mtdblock3            1.1M    232.0k    856.0k  21% /jffs
mini_fo:/jffs             2.1M      2.1M         0 100% /

Please press Enter to activate this console. bcm63xx_enet bcm63xx_enet.0: attached PHY at address 1 [Broadcom BCM63XX (1)]
bcm63xx_enet bcm63xx_enet.0: attached PHY at address 1 [Broadcom BCM63XX (1)]
eth1: link forced UP - 100/full - flow control off/off
device eth1 entered promiscuous mode
br-lan: topology change detected, propagating
br-lan: port 1(eth1) entering forwarding state
br-lan: port 1(eth1) entering disabled state
br-lan: topology change detected, propagating
br-lan: port 1(eth1) entering forwarding state
cfg80211: Using static regulatory domain info
cfg80211: Regulatory domain: US
    (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp)
    (2402000 KHz - 2472000 KHz @ 40000 KHz), (600 mBi, 2700 mBm)
    (5170000 KHz - 5190000 KHz @ 40000 KHz), (600 mBi, 2300 mBm)
    (5190000 KHz - 5210000 KHz @ 40000 KHz), (600 mBi, 2300 mBm)
    (5210000 KHz - 5230000 KHz @ 40000 KHz), (600 mBi, 2300 mBm)
    (5230000 KHz - 5330000 KHz @ 40000 KHz), (600 mBi, 2300 mBm)
    (5735000 KHz - 5835000 KHz @ 40000 KHz), (600 mBi, 3000 mBm)
cfg80211: Calling CRDA for country: US
PPP generic driver version 2.4.2
ip_tables: (C) 2000-2006 Netfilter Core Team
nf_conntrack version 0.5.0 (1024 buckets, 4096 max)
CONFIG_NF_CT_ACCT is deprecated and will be removed soon. Plase use
nf_conntrack.acct=1 kernel paramater, acct=1 nf_conntrack module option or
sysctl net.netfilter.nf_conntrack_acct=1 to enable it.
usbcore: registered new interface driver usblp



BusyBox v1.11.3 (2009-01-08 12:55:09 CET) built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 KAMIKAZE (bleeding edge, r14066) -------------------
  * 10 oz Vodka       Shake well with ice and strain
  * 10 oz Triple sec  mixture into 10 shot glasses.
  * 10 oz lime juice  Salute!
 ---------------------------------------------------
root@OpenWrt:/# rebooy t
root@OpenWrt:/# Restarting system.
triggering watchdog soft-reset...</code></pre></div><p>Thanks for your work.</p>											<p class="post-edited">(Last edited by <strong>t3l3m4k0</strong> on 17 Jan 2009, 15:44)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p79772">
				<div class="post-metadata">
					<div class="post-num">Post #193</div>
					<div class="post-author">LinuxInside</div>
					<div class="post-datetime">
						17 Jan 2009, 16:21					</div>
				</div>
				<div class="post-content content">
					<p>Ok so this happens:<br />1. partitions are created fine, all nicely aligned.<br />2. Rootfs is correctly mounted.<br />3. Rootfs_data is created nicely.</p><p>Ok I am guessing here (so i may be wrong)...</p><p>First jffs2 looks to see if there&#039;s a mountable partition on rootfs_data, which it can&#039;t find because there&#039;s garbage of the previous install.</p><p>Then JFFS2 decides that it should probably create an empty partition and searches for 0xdeadc0de<br />tags which of course also don&#039;t exist.</p><p>The problem is we cant just add them to the image because the CFE checks the CRC of the image.</p><p>The best work around I see is to create the jffs2 image by hand on the rootfs_data partition, then after reboot you should be fine.</p><p>Thanks for testing! Can you try this?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p79773">
				<div class="post-metadata">
					<div class="post-num">Post #194</div>
					<div class="post-author">t3l3m4k0</div>
					<div class="post-datetime">
						17 Jan 2009, 17:24					</div>
				</div>
				<div class="post-content content">
					<div class="codebox"><pre><code>The best work around I see is to create the jffs2 image by hand on the rootfs_data partition, then after reboot you should be fine.</code></pre></div><p>i&#039;m lost, how i must create jffs2 image?. I must erase mtd3 partition?</p><p>maybe in last log is not clear but after first reboot (reboot in log was typed from me), no more &quot;jffs2_scan_eraseblock()&quot; messages. Router seems to work fine, but whit previous /jffs partition.</p>											<p class="post-edited">(Last edited by <strong>t3l3m4k0</strong> on 17 Jan 2009, 17:28)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p79774">
				<div class="post-metadata">
					<div class="post-num">Post #195</div>
					<div class="post-author">florian_</div>
					<div class="post-datetime">
						17 Jan 2009, 17:32					</div>
				</div>
				<div class="post-content content">
					<p>The rootfs_data partition is created automatically from the free space between rootfs and the next partition, see target/linux/generic-2.6/patches-2.6.27/065-rootfs_split.patch</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p79776">
				<div class="post-metadata">
					<div class="post-num">Post #196</div>
					<div class="post-author">t3l3m4k0</div>
					<div class="post-datetime">
						17 Jan 2009, 18:17					</div>
				</div>
				<div class="post-content content">
					<p>@ florian_<br />Free space for rootfs_data is that i have in my mind. I understand, from LinuxInside post, after flashed router i must do something with jffs partition. What?</p><p>By the other hand, partitions seems to be build fine, but rootfs_data not was erased.<br /></p><div class="codebox"><pre><code>root@OpenWrt:/# logread | grep notice
Jan  8 12:22:00 OpenWrt user.notice kernel: klogd started: BusyBox v1.11.3 (2009-01-08 12:55:09 CET)
Jan  8 12:22:00 OpenWrt user.notice kernel: Linux version 2.6.27.11 (HTPC@localhost.localdomain) (gcc version 4.1.2) #2 Sat Jan 17 14:05:19 CET 2009
Jan  8 12:22:00 OpenWrt user.notice kernel: Kernel command line: root=/dev/mtdblock2 rootfstype=squashfs,jffs2 init=/etc/preinit noinitrd console=ttyS0,115200
Jan  8 12:22:00 OpenWrt user.notice kernel: type=2000 audit(0.269:1): initialized
Jan  8 12:22:00 OpenWrt user.notice kernel: number of CFI chips: 1
Jan  8 12:22:00 OpenWrt user.notice kernel: cfi_cmdset_0002: Disabling erase-suspend-program due to code brokenness.
Jan  8 12:22:00 OpenWrt user.notice kernel: Creating 4 MTD partitions on &quot;bcm963xx&quot;:
Jan  8 12:22:00 OpenWrt user.notice kernel: 0x00000000-0x00010000 : &quot;CFE&quot;
Jan  8 12:22:00 OpenWrt user.notice kernel: 0x0001010c-0x000d0000 : &quot;kernel&quot;
Jan  8 12:22:00 OpenWrt user.notice kernel: 0x000d0000-0x002f0000 : &quot;rootfs&quot;
Jan  8 12:22:00 OpenWrt user.notice kernel: mtd: partition &quot;rootfs&quot; set to be root filesystem
Jan  8 12:22:00 OpenWrt user.notice kernel: 0x002f0000-0x00400000 : &quot;rootfs_data&quot;
Jan  8 12:22:00 OpenWrt user.notice kernel: 0x00010000-0x00400000 : &quot;Linux&quot;
Jan  8 12:22:08 OpenWrt user.notice kernel: SCSI subsystem initialized
root@OpenWrt:/# cat /proc/partitions
major minor  #blocks  name

  31     0         64 mtdblock0
  31     1        767 mtdblock1
  31     2       2176 mtdblock2
  31     3       1088 mtdblock3
  31     4       4032 mtdblock4
root@OpenWrt:/# cat /proc/mtd
dev:    size   erasesize  name
mtd0: 00010000 00008000 &quot;CFE&quot;
mtd1: 000bfef4 00010000 &quot;kernel&quot;
mtd2: 00220000 00010000 &quot;rootfs&quot;
mtd3: 00110000 00010000 &quot;rootfs_data&quot;
mtd4: 003f0000 00010000 &quot;Linux&quot;
root@OpenWrt:/#</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p79781">
				<div class="post-metadata">
					<div class="post-num">Post #197</div>
					<div class="post-author">t3l3m4k0</div>
					<div class="post-datetime">
						17 Jan 2009, 18:45					</div>
				</div>
				<div class="post-content content">
					<p>i erased /jffs and it seems to have a fresh system.</p><div class="codebox"><pre><code>root@OpenWrt:/# mtd -r  erase /dev/mtd3
Unlocking /dev/mtd3 ...
Erasing /dev/mtd3 ...
Rebooting ...</code></pre></div>											<p class="post-edited">(Last edited by <strong>t3l3m4k0</strong> on 17 Jan 2009, 18:46)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p79785">
				<div class="post-metadata">
					<div class="post-num">Post #198</div>
					<div class="post-author">LinuxInside</div>
					<div class="post-datetime">
						17 Jan 2009, 19:45					</div>
				</div>
				<div class="post-content content">
					<p>@t3l3m4k0: </p><p>Good work!</p><p>So after the erase and the reboot, jffs2 cleaned the rootfs_data partition and started a new fresh partition? I hope I understand this correctly <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />)</p><br /><p>@florian:<br />Is it ok to include the patches now? Next thing I would like to work on is to add generic support for devices with bigger flash, so we can use the lower 4Meg on devices which support it. Hopefully solving the </p><div class="quotebox"><blockquote><p>Reducing visibility of 8192KiB chip to 4096KiB</p></blockquote></div><p>Also I have noticed that wireless is not working. I have tried with a b43 card and with the ipw2100 card from an old laptop. But both hit GP failures while trying to initialize PCI. But this one is more complicated and may be a bit beyond my skills...</p>											<p class="post-edited">(Last edited by <strong>LinuxInside</strong> on 17 Jan 2009, 19:46)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p79791">
				<div class="post-metadata">
					<div class="post-num">Post #199</div>
					<div class="post-author">t3l3m4k0</div>
					<div class="post-datetime">
						17 Jan 2009, 22:06					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>LinuxInside wrote:</cite><blockquote><p>So after the erase and the reboot, jffs2 cleaned the rootfs_data partition and started a new fresh partition? I hope I understand this correctly <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />)</p></blockquote></div><p>as my knowledge goes, i think yes.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p79959">
				<div class="post-metadata">
					<div class="post-num">Post #200</div>
					<div class="post-author">bmork</div>
					<div class="post-datetime">
						20 Jan 2009, 11:28					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>t3l3m4k0 wrote:</cite><blockquote><p>@ LinuxInside,<br /></p><div class="codebox"><pre><code>Linux version 2.6.27.11 (HTPC@localhost.localdomain) (gcc version 4.1.2) #2 Sat Jan 17 14:05:19 CET 2009
Detected Broadcom 0x6348 CPU revision a2
CPU frequency is 256000000 MHz</code></pre></div></blockquote></div><p>Wow!&nbsp; That&#039;s a really fast CPU <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><br /><p>BjÃ¸rn</p>									</div>
			</article>

			
		
						<div class="notice">
				<p>Sorry, posts 201 to 200 are missing from our archive.</p>
			</div>
		
		
	
	<div class="pagination"><div class="pagination-number">Page 8 of 30</div><nav><ul><li><a href="viewtopic.php%3Fid=17370&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=17370&amp;p=6.html">6</a></li><li><a href="viewtopic.php%3Fid=17370&amp;p=7.html">7</a></li><li class="pagination-current"><span>8</span></li><li><a href="viewtopic.php%3Fid=17370&amp;p=9.html">9</a></li><li><a href="viewtopic.php%3Fid=17370&amp;p=10.html">10</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=17370&amp;p=30.html">30</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0.001 -->

</body>
</html>