<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> ssh tunneling over bridge</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 14 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p47799">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">elpha</div>
					<div class="post-datetime">
						5 May 2007, 20:41					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve successfully flashed my WRT54GL 1.1 to OpenWrt and I&#039;ve got a bridge (wl0_mode=sta) set up to a communal AP. What I would like to do is tunnel all of my traffic, to make sure the other people using the AP can&#039;t sniff my traffic. I have a server at a remote facility running openssh which I can connect to, and from there the internet at large.</p><p>My question is, how do I use the ssh command in OpenWrt to tunnel ALL traffic from the router to the remote server?</p><p>Diagram:<br /><span class="postimg"><img src="http://img211.imageshack.us/img211/1772/openwrtbridgesshtunnelwk0.jpg" alt="http://img211.imageshack.us/img211/1772/openwrtbridgesshtunnelwk0.jpg" /></span></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p47815">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">clearchris</div>
					<div class="post-datetime">
						6 May 2007, 01:23					</div>
				</div>
				<div class="post-content content">
					<p>Your question isn&#039;t 100% clear to me.</p><p>Do you want to have all of your subnet able to access the ssh tunnel?&nbsp; Is &quot;my subnet&quot; trusted?</p><p>So, I&#039;ll make some assumptions and tell you what I think you need to do at a high level.</p><p>1.)&nbsp; You are going to have to tweak &quot;my server&quot; sshd configuration to allow non local forwarding.<br />2.)&nbsp; Set up your router to automatically connect ssh to &quot;my server&quot; and have ssh act as a socks proxy.<br />&nbsp; You will need to use something like this:<br />ssh -D 8080 user@myserver<br />&nbsp; Since ssh doesn&#039;t allow command line passwords, you will need to set up an &quot;identity file&quot; on your &quot;router&quot; and set it up as trusted on &quot;my server&quot;.<br />3.)&nbsp; Your clients should use socks compatible software that points to &quot;bind_address&quot; on the specified port.<br />4.)&nbsp; If you want to be paranoid, you can set up a filter in your firewall config to block traffic from &quot;my subnet&quot; that doesn&#039;t use the proxy and attempts to directly use the internet.</p><p>I&#039;m not aware of any way that you can set this up as a transparent VPN type setup.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p47818">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">elpha</div>
					<div class="post-datetime">
						6 May 2007, 01:35					</div>
				</div>
				<div class="post-content content">
					<p>perfect! that&#039;s exactly what I was after.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p47832">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">vincentfox</div>
					<div class="post-datetime">
						6 May 2007, 07:52					</div>
				</div>
				<div class="post-content content">
					<p>I would have gone an entirely different route. Probably setup a routed AP-client mode, so my local WRT unit is picking up signal and treating that like a WAN connection. So all local traffic is a separate NAT nework.</p><p>Then use OpenVPN to establish a tunnel to the remote server.&nbsp; This depends on you having admin access on the other end to setup OpenVPN, and the knowledge to run it.&nbsp; Not by my standards terribly difficult, as I have done setups very similar to what I describe.&nbsp; I am using OpenVPN now to link remote sites.&nbsp; But not something I can really write a howto on either.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p47926">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">clearchris</div>
					<div class="post-datetime">
						7 May 2007, 00:07					</div>
				</div>
				<div class="post-content content">
					<p>OpenVPN is probably a better solution.&nbsp; I haven&#039;t ever set that up before, so I can&#039;t give you any tips.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>