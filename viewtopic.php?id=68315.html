<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Sometimes Wi-Fi devices can&#039;t reach internet</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 7 Feb 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p342449">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">alexeys</div>
					<div class="post-datetime">
						29 Oct 2016, 16:29					</div>
				</div>
				<div class="post-content content">
					<p>Hi, I have wrt1200ac running OpenWrt Chaos Calmer 15.05.1 and I&#039;m experiencing very strange issue. Oftentimes, when a laptop connects over wifi, I can reach router but not the internet. If that happens, I need to disconnect / reconnect to wifi or sometimes even reboot the router before laptop can reach the internet. This issue is affecting several laptops in my house so I don&#039;t think it&#039;s a device issue. Any help or suggestions will be appreciated.</p><p>Here&#039;s example of pings as I connect &amp; disconnect my Macbook from SSID. You can see that 2 pings passed successfully and then pings stop. Meanwhile, pings to my router work just fine. It seems as almost something causes router to stop routing traffic. </p><p>icmp_seq 133 (in pings to 8.8.8.8) and icmp_seq 214 (in pings to 192.168.1.1) should line up.</p><br /><div class="codebox"><pre><code>Request timeout for icmp_seq 133
ping: sendto: No route to host
Request timeout for icmp_seq 134
ping: sendto: No route to host
Request timeout for icmp_seq 135
ping: sendto: No route to host
Request timeout for icmp_seq 136
Request timeout for icmp_seq 137
64 bytes from 8.8.8.8: icmp_seq=138 ttl=57 time=123.969 ms
64 bytes from 8.8.8.8: icmp_seq=139 ttl=57 time=159.101 ms
Request timeout for icmp_seq 140
Request timeout for icmp_seq 141
Request timeout for icmp_seq 142
Request timeout for icmp_seq 143
Request timeout for icmp_seq 144
Request timeout for icmp_seq 145
Request timeout for icmp_seq 146
Request timeout for icmp_seq 147
Request timeout for icmp_seq 148
Request timeout for icmp_seq 149
ping: sendto: No route to host
Request timeout for icmp_seq 150
ping: sendto: No route to host
Request timeout for icmp_seq 151
ping: sendto: No route to host
Request timeout for icmp_seq 152
ping: sendto: No route to host
Request timeout for icmp_seq 153
ping: sendto: No route to host
Request timeout for icmp_seq 154
Request timeout for icmp_seq 155
64 bytes from 8.8.8.8: icmp_seq=156 ttl=57 time=16.332 ms
64 bytes from 8.8.8.8: icmp_seq=157 ttl=57 time=16.286 ms
64 bytes from 8.8.8.8: icmp_seq=158 ttl=57 time=18.590 ms
64 bytes from 8.8.8.8: icmp_seq=159 ttl=57 time=14.273 ms
64 bytes from 8.8.8.8: icmp_seq=160 ttl=57 time=96.581 ms
64 bytes from 8.8.8.8: icmp_seq=161 ttl=57 time=57.873 ms
64 bytes from 8.8.8.8: icmp_seq=162 ttl=57 time=18.254 ms
64 bytes from 8.8.8.8: icmp_seq=163 ttl=57 time=15.712 ms
64 bytes from 8.8.8.8: icmp_seq=164 ttl=57 time=11.780 ms
64 bytes from 8.8.8.8: icmp_seq=165 ttl=57 time=13.777 ms</code></pre></div><br /><br /><div class="codebox"><pre><code>Request timeout for icmp_seq 214
ping: sendto: No route to host
Request timeout for icmp_seq 215
ping: sendto: No route to host
Request timeout for icmp_seq 216
ping: sendto: No route to host
Request timeout for icmp_seq 217
Request timeout for icmp_seq 218
64 bytes from 192.168.1.1: icmp_seq=219 ttl=64 time=0.930 ms
64 bytes from 192.168.1.1: icmp_seq=220 ttl=64 time=55.222 ms
Request timeout for icmp_seq 221
Request timeout for icmp_seq 222
Request timeout for icmp_seq 223
64 bytes from 192.168.1.1: icmp_seq=224 ttl=64 time=1.410 ms
64 bytes from 192.168.1.1: icmp_seq=188 ttl=64 time=37177.862 ms
Request timeout for icmp_seq 226
64 bytes from 192.168.1.1: icmp_seq=227 ttl=64 time=1.583 ms
64 bytes from 192.168.1.1: icmp_seq=228 ttl=64 time=1.635 ms
64 bytes from 192.168.1.1: icmp_seq=229 ttl=64 time=104.115 ms
64 bytes from 192.168.1.1: icmp_seq=230 ttl=64 time=130.623 ms
64 bytes from 192.168.1.1: icmp_seq=231 ttl=64 time=130.364 ms
ping: sendto: No route to host
ping: sendto: No route to host
Request timeout for icmp_seq 232
ping: sendto: No route to host
Request timeout for icmp_seq 233
ping: sendto: No route to host
Request timeout for icmp_seq 234
ping: sendto: No route to host
Request timeout for icmp_seq 235
Request timeout for icmp_seq 236
64 bytes from 192.168.1.1: icmp_seq=237 ttl=64 time=1.471 ms
64 bytes from 192.168.1.1: icmp_seq=238 ttl=64 time=1.921 ms
64 bytes from 192.168.1.1: icmp_seq=239 ttl=64 time=2.267 ms
64 bytes from 192.168.1.1: icmp_seq=240 ttl=64 time=46.027 ms
64 bytes from 192.168.1.1: icmp_seq=241 ttl=64 time=125.782 ms
64 bytes from 192.168.1.1: icmp_seq=242 ttl=64 time=87.588 ms
64 bytes from 192.168.1.1: icmp_seq=243 ttl=64 time=45.082 ms
64 bytes from 192.168.1.1: icmp_seq=244 ttl=64 time=1.582 ms
64 bytes from 192.168.1.1: icmp_seq=245 ttl=64 time=1.320 ms</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p342453">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">bolvan</div>
					<div class="post-datetime">
						29 Oct 2016, 17:36					</div>
				</div>
				<div class="post-content content">
					<p>Both logs demonstrate bad connection and packet loss. Have you checked signal strength ?<br />iwinfo wlan0 assoclist</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p342482">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">alexeys</div>
					<div class="post-datetime">
						30 Oct 2016, 02:12					</div>
				</div>
				<div class="post-content content">
					<p>I don&#039;t have &quot;iwinfo&quot;. How can I get it installed? </p><p>But I don&#039;t think it was signal strength. I was close to the router at that time. I had wifi disconnected, then I got connected to wifi, 2 pings went through for 8.8.8.8 and then pings stopped, for 192.168.1.1 I got few pings, few timeouts, then pings resumed. Since 8.8.8.8 won&#039;t ping, I had to disconnect from wifi again. That&#039;s when timeouts started. I connected again and both pings started running as expected so I stopped them. If I wouldn&#039;t disconnect wifi when 8.8.8.8 won&#039;t ping, I&#039;d keep on getting sold pings for 192.168.1.1.</p><p>I&#039;ll try capturing more pings once problem presents itself again. Today it&#039;s been working fine again.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p342501">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">bolvan</div>
					<div class="post-datetime">
						30 Oct 2016, 08:57					</div>
				</div>
				<div class="post-content content">
					<p>Have you checked if your neighbors use the same channel ?<br />They can be heavy downloading something and noise the air.<br />Also if you&#039;re on HT40 mode move to HT20</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p342678">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">alexeys</div>
					<div class="post-datetime">
						1 Nov 2016, 07:02					</div>
				</div>
				<div class="post-content content">
					<p>Looks like it&#039;s routing issue with Comcast. Although very strange because I never seen this happening before installing OpenWrt. I ran traceroute when 8.8.8.8 won&#039;t ping and trace goes outside of my local network. Is it possible that this is a NAT issue?</p><div class="quotebox"><blockquote><p>traceroute to 8.8.8.8 (8.8.8.8), 64 hops max, 52 byte packets<br /> 1&nbsp; openwrt (192.168.1.1)&nbsp; 2.583 ms&nbsp; 0.971 ms&nbsp; 1.386 ms<br /> 2&nbsp; 96.120.90.49 (96.120.90.49)&nbsp; 37.277 ms&nbsp; 38.351 ms&nbsp; 39.849 ms<br /> 3&nbsp; te-0-7-0-16-sur04.oakland.ca.sfba.comcast.net (68.86.142.141)&nbsp; 39.783 ms&nbsp; 39.795 ms&nbsp; 39.848 ms<br /> 4&nbsp; be-314-ar01.hayward.ca.sfba.comcast.net (162.151.79.97)&nbsp; 40.183 ms&nbsp; 39.770 ms&nbsp; 39.799 ms<br /> 5&nbsp; hu-0-0-0-1-ar01.santaclara.ca.sfba.comcast.net (68.85.57.145)&nbsp; 39.878 ms<br />&nbsp; &nbsp; hu-0-0-0-0-ar01.santaclara.ca.sfba.comcast.net (68.85.154.249)&nbsp; 40.234 ms<br />&nbsp; &nbsp; hu-0-0-0-1-ar01.santaclara.ca.sfba.comcast.net (68.85.57.145)&nbsp; 39.609 ms<br /> 6&nbsp; * * *<br /> 7&nbsp; * hu-0-13-0-0-pe02.529bryant.ca.ibone.comcast.net (68.86.86.94)&nbsp; 32.117 ms<br />&nbsp; &nbsp; hu-0-11-0-0-pe02.529bryant.ca.ibone.comcast.net (68.86.86.70)&nbsp; 39.854 ms<br /> 8&nbsp; * * *<br /> 9&nbsp; * * *<br />10&nbsp; * * *<br />11&nbsp; * * *<br />12&nbsp; * * *</p></blockquote></div><p>Here&#039;s trace taken from OpenWrt&#039;s Diagnostics interface from LuCI.</p><div class="codebox"><pre><code>traceroute to 8.8.8.8 (8.8.8.8), 30 hops max, 38 byte packets
 1  96.120.90.49  8.950 ms
 2  68.86.142.141  9.483 ms
 3  162.151.79.97  9.065 ms
 4  68.85.57.145  11.272 ms
 5  68.86.90.93  12.904 ms
 6  68.86.86.70  11.191 ms
 7  23.30.206.102  11.731 ms
 8  108.170.242.241  11.480 ms
 9  216.239.49.99  11.028 ms
10  8.8.8.8  11.930 ms</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p345024">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Exeleration-G</div>
					<div class="post-datetime">
						27 Nov 2016, 17:12					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m having the exact same problem. Using OpenWrt Chaos Calmer 15.05 on a TP-Link Archer C20i, set up as a Dumb AP. I&#039;m not really sure about the cause, but I have the feeling that downloading lots of data may induce this problem.</p><p>For instance, I had this problem a minute ago when updating my packages on a fresh Ubuntu install. What&#039;s really strange is that downloading the updated packages kept going on, but downloading any Internet page with Firefox failed. Of course, I could still reach my router&#039;s IP address.</p><p>Just posting this to see if there&#039;s anything common to our problems.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p345027">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">dl12345</div>
					<div class="post-datetime">
						27 Nov 2016, 17:31					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Exeleration-G wrote:</cite><blockquote><p>I&#039;m having the exact same problem. Using OpenWrt Chaos Calmer 15.05 on a TP-Link Archer C20i, set up as a Dumb AP. I&#039;m not really sure about the cause, but I have the feeling that downloading lots of data may induce this problem.</p><p>For instance, I had this problem a minute ago when updating my packages on a fresh Ubuntu install. What&#039;s really strange is that downloading the updated packages kept going on, but downloading any Internet page with Firefox failed. Of course, I could still reach my router&#039;s IP address.</p><p>Just posting this to see if there&#039;s anything common to our problems.</p></blockquote></div><p>Yours sounds like a DNS related issue if existing downloads keep going</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p345031">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">Exeleration-G</div>
					<div class="post-datetime">
						27 Nov 2016, 17:49					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dl12345 wrote:</cite><blockquote><p>Yours sounds like a DNS related issue if existing downloads keep going</p></blockquote></div><p>Thanks, that may be it. I&#039;m setting up Ubuntu to use OpenDNS&#039;s servers as static DNS servers. I will let you know if the problem still happens afterwards.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p345035">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">bolvan</div>
					<div class="post-datetime">
						27 Nov 2016, 18:36					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Exeleration-G wrote:</cite><blockquote><p>I&#039;m not really sure about the cause, but I have the feeling that downloading lots of data may induce this problem.</p></blockquote></div><p>If routers cpu is loaded 100% in kernel mode by heavy network activity then in non-preemptible (default) kernel all users processes hang. This results in losing wifi connectivity, dhcp, dns, luci, ssh.<br />One of the mandatory checks is cpu load.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p345038">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">Exeleration-G</div>
					<div class="post-datetime">
						27 Nov 2016, 18:50					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>bolvan wrote:</cite><blockquote><p>If routers cpu is loaded 100% in kernel mode by heavy network activity then in non-preemptible (default) kernel all users processes hang. This results in losing wifi connectivity, dhcp, dns, luci, ssh.<br />One of the mandatory checks is cpu load.</p></blockquote></div><p>Alright, now I understand the connection with the heavy downloading. Is it possible to restrict the kernel&#039;s CPU usage?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p345049">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">bolvan</div>
					<div class="post-datetime">
						27 Nov 2016, 19:50					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Exeleration-G wrote:</cite><blockquote><p>Alright, now I understand the connection with the heavy downloading. Is it possible to restrict the kernel&#039;s CPU usage?</p></blockquote></div><p>No need to restrict. Need to change task scheduler strategy so it gives quantums to user processes. Recompile with <a href="https://en.wikipedia.org/wiki/Kernel_preemption">kernel preemption</a>.<br />If you cant then the only possibility is limiting bandwidth with shaper.</p>											<p class="post-edited">(Last edited by <strong>bolvan</strong> on 27 Nov 2016, 19:53)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>