<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Problem to connect through WiFi</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 25 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p135788">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						22 May 2011, 17:00					</div>
				</div>
				<div class="post-content content">
					<p>I am hoping some of you who are experts in setting up a WiFi connection through a STA mode to another WiFi router will be able to help me out.</p><p>As shown in <a href="https://forum.openwrt.org/viewtopic.php?id=27355">here</a>, I finally managed to configure an <a href="http://wiki.openwrt.org/toh/d-link/dir-600">FR-54RTR Fry&#039;s Electronics NAT/Firewall router (a.k.a DLink DIR-600 Rev. A1)</a> to connect to an apartment WiFi as a client using STA mode. Due to recently upgrades, I reflashed this router with a newly built OpenWRT firmware (openwrt-ar71xx-generic-fr-54rtr-squashfs-factory.bin) r26968 and now it no longer works. So, I brought back the router and tried to connect it to my own WiFi router to no avail with a default SSID. The router configurations are as follows. </p><p>1. /etc/config/network<br /></p><div class="codebox"><pre><code>config interface loopback
        option  ifname          lo
        option  proto           static
        option  ipaddr          127.0.0.1
        option  netmask         255.0.0.0

config interface lan
        option  ifname          eth0
        option  type            bridge
        option  proto           static
        option  netmask         255.255.255.0
        option  ipaddr          192.168.11.1

config &#039;route&#039;
        option  interface       lan
        option  gateway         &#039;192.168.11.15&#039;
        option  target          &#039;192.168.15.0&#039;
        option  netmask         &#039;255.255.255.0&#039;

config interface wan
        option  ifname          eth1
        option  proto           dhcp

config switch eth0
        option  enable_vlan     1

config switch_vlan
        option  device          eth0
        option  vlan            1
        option  ports           &#039;0 1 2 3 4&#039;

config interface wwan
        option  proto           dhcp
        option  dns             8.8.8.8</code></pre></div><p>2. /etc/config/wireless<br /></p><div class="codebox"><pre><code>config wifi-device radio0
        option  type            mac80211
        option  channel         11
        option  macaddr         00:26:5a:f4:61:83
        option  hwmode          11ng
        option  htmode          HT20
        list    ht_capab        SHORT-GI-40
        list    ht_capab        TX-STBC
        list    ht_capab        RX-STBC1
        list    ht_capab        DSSS_CCK-40
        option  disabled        0
        option  txpower         27
        option  country         US

config wifi-iface sta
        option  network         wwan
        option  encryption      none
        option  device          radio0
        option  mode            sta
        option  ssid            default</code></pre></div><p>3. /etc/config/firewall<br /></p><div class="codebox"><pre><code>config  defaults
        option  syn_flood       1
        option  input           ACCEPT
        option  output          ACCEPT
        option  forward         REJECT
config  zone
        option  name            lan
        option  network         lan
        option  input           ACCEPT
        option  output          ACCEPT
        option  forward         ACCEPT

config  zone
        option  name            wan
        option  network         wan
        option  input           ACCEPT
        option  output          ACCEPT
        option  forward         ACCEPT
        option  masq            1
        option  mtu_fix         1
config  forwarding
        option  src             lan
        option  dest            wan

#
# We need to accept udp packets on port 68,
# see https://dev.openwrt.org/ticket/4108
#
config  rule
        option  src             wan
        option  proto           udp
        option  dest_port       68
        option  target          ACCEPT
        option  family          ipv4

#
# Allow ping
#
config  rule
        option  src             wan
        option  proto           icmp
        option  icmp_type       echo-request
        option  target          ACCEPT

#
# include a file with users custom iptables rules
#
config  include
        option  path            /etc/firewall.user</code></pre></div><p>It won&#039;t connect to a another WiFi router and here is the screen dump when I executed <em>/etc/init.d/network restart</em>:</p><div class="codebox"><pre><code>root@Noone:~# /etc/init.d/network restart
Received SIGTERM
Entering released state
Received SIGTERM
Entering released state
0.openwrt.pool.ntp.org: Unknown host
1.openwrt.pool.ntp.org: Unknown host
2.openwrt.pool.ntp.org: Unknown host
3.openwrt.pool.ntp.org: Unknown host
killall: ntpclient: no process killed
udhcpc (v1.18.4) started
udhcpc (v1.18.4) started
Sending discover...
udhcpc: bind: No such device
root@Noone:~# udhcpc (v1.18.4) started
Sending discover...
Sending discover...
Sending discover...
Sending discover...
Sending discover...</code></pre></div><p><em>logread</em> dumped the following:</p><div class="codebox"><pre><code>Mar 26 23:35:33 Noone daemon.warn dnsmasq[1837]: failed to access /tmp/resolv.conf.auto: No such file or directory
Mar 26 23:35:34 Noone user.info firewall: removing lan (br-lan) from zone lan
Mar 26 23:35:35 Noone kern.info kernel: br-lan: port 1(eth0) entering forwarding state
Mar 26 23:35:35 Noone kern.info kernel: eth0: link down
Mar 26 23:35:35 Noone kern.info kernel: device eth0 left promiscuous mode
Mar 26 23:35:35 Noone kern.info kernel: br-lan: port 1(eth0) entering disabled state
Mar 26 23:35:37 Noone user.notice ifup: Enabling Router Solicitations on loopback (lo)
Mar 26 23:35:37 Noone daemon.warn dnsmasq[1837]: failed to access /tmp/resolv.conf.auto: No such file or directory
Mar 26 23:35:37 Noone user.notice root: stopping ntpclient
Mar 26 23:35:37 Noone user.notice rdate: No usable time server for loopback found
Mar 26 23:35:38 Noone kern.info kernel: ADDRCONF(NETDEV_UP): eth0: link is not ready
Mar 26 23:35:38 Noone kern.info kernel: eth0: link down
Mar 26 23:35:38 Noone kern.info kernel: ADDRCONF(NETDEV_UP): eth0: link is not ready
Mar 26 23:35:38 Noone kern.info kernel: device eth0 entered promiscuous mode
Mar 26 23:35:38 Noone kern.info kernel: eth0: link up (1000Mbps/Full duplex)
Mar 26 23:35:38 Noone kern.info kernel: ADDRCONF(NETDEV_CHANGE): eth0: link becomes ready
Mar 26 23:35:38 Noone kern.info kernel: br-lan: port 1(eth0) entering forwarding state
Mar 26 23:35:38 Noone kern.info kernel: br-lan: port 1(eth0) entering forwarding state
Mar 26 23:35:38 Noone kern.info kernel: ADDRCONF(NETDEV_UP): eth1: link is not ready
Mar 26 23:35:38 Noone kern.info kernel: ADDRCONF(NETDEV_UP): eth1: link is not ready
Mar 26 23:35:39 Noone kern.info kernel: ADDRCONF(NETDEV_UP): wlan0: link is not ready
Mar 26 23:35:40 Noone kern.info kernel: ADDRCONF(NETDEV_UP): wlan0: link is not ready
Mar 26 23:35:40 Noone kern.debug kernel: wlan0: direct probe to 00:e0:98:15:40:82 (try 1/3)
Mar 26 23:35:40 Noone kern.debug kernel: wlan0: direct probe to 00:e0:98:15:40:82 (try 2/3)

Mar 26 23:35:41 Noone kern.debug kernel: wlan0: direct probe to 00:e0:98:15:40:82 (try 3/3)
Mar 26 23:35:41 Noone kern.debug kernel: wlan0: direct probe to 00:e0:98:15:40:82 timed out
Mar 26 23:35:41 Noone user.notice ifup: Enabling Router Solicitations on lan (br-lan)
Mar 26 23:35:42 Noone kern.info kernel: ADDRCONF(NETDEV_UP): wlan0: link is not ready
Mar 26 23:35:43 Noone user.info firewall: adding lan (br-lan) to zone lan
Mar 26 23:35:44 Noone user.notice rdate: No usable time server for lan found
Mar 26 23:35:44 Noone kern.debug kernel: wlan0: direct probe to 00:e0:98:15:40:82 (try 1/3)
Mar 26 23:35:45 Noone kern.debug kernel: wlan0: direct probe to 00:e0:98:15:40:82 (try 2/3)
Mar 26 23:35:45 Noone kern.debug kernel: wlan0: direct probe to 00:e0:98:15:40:82 (try 3/3)
Mar 26 23:35:45 Noone kern.debug kernel: wlan0: direct probe to 00:e0:98:15:40:82 timed out
Mar 26 23:35:50 Noone kern.debug kernel: wlan0: direct probe to 00:e0:98:15:40:82 (try 1/3)
Mar 26 23:35:50 Noone kern.debug kernel: wlan0: direct probe to 00:e0:98:15:40:82 (try 2/3)
Mar 26 23:35:51 Noone kern.debug kernel: wlan0: direct probe to 00:e0:98:15:40:82 (try 3/3)
Mar 26 23:35:51 Noone kern.debug kernel: wlan0: direct probe to 00:e0:98:15:40:82 timed out
Mar 26 23:35:56 Noone kern.debug kernel: wlan0: direct probe to 00:e0:98:15:40:82 (try 1/3)
Mar 26 23:35:56 Noone kern.debug kernel: wlan0: direct probe to 00:e0:98:15:40:82 (try 2/3)
Mar 26 23:35:56 Noone kern.debug kernel: wlan0: direct probe to 00:e0:98:15:40:82 (try 3/3)
Mar 26 23:35:57 Noone kern.debug kernel: wlan0: direct probe to 00:e0:98:15:40:82 timed out
Mar 26 23:36:11 Noone kern.debug kernel: wlan0: direct probe to 00:e0:98:15:40:82 (try 1/3)
Mar 26 23:36:11 Noone kern.debug kernel: wlan0: direct probe to 00:e0:98:15:40:82 (try 2/3)
Mar 26 23:36:11 Noone kern.debug kernel: wlan0: direct probe to 00:e0:98:15:40:82 (try 3/3)
Mar 26 23:36:11 Noone kern.debug kernel: wlan0: direct probe to 00:e0:98:15:40:82 timed out</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p135803">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">yawlhoo</div>
					<div class="post-datetime">
						22 May 2011, 22:29					</div>
				</div>
				<div class="post-content content">
					<p>Looking at your config I notice two things: you have set the power &quot;option&nbsp; txpower&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;27&quot;, and you are using DHCP.&nbsp; </p><p>If I were in your shoes, I would comment out the power line, try to connect; then set a static address on the device, try to connect.</p><p>Admittedly both just a fiddle, but maybe you will learn something?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p135843">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						23 May 2011, 13:33					</div>
				</div>
				<div class="post-content content">
					<p>Where do you define &quot;zone wwan&quot; in firewall?</p><p>BTW, it&#039;s impossible for FR-54RTR to achieve 27dBm (500mW). Please set it to 20dBm (100mW) or 17dBm (50mW).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p135854">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						23 May 2011, 18:23					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>fyi wrote:</cite><blockquote><p>Where do you define &quot;zone wwan&quot; in firewall?</p><p>BTW, it&#039;s impossible for FR-54RTR to achieve 27dBm (500mW). Please set it to 20dBm (100mW) or 17dBm (50mW).</p></blockquote></div><p>I just sent you a PM.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p135858">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						23 May 2011, 19:24					</div>
				</div>
				<div class="post-content content">
					<p>You should refer to &quot;<a href="http://wiki.openwrt.org/doc/recipes/routedclient#using.masquerade">Routed Client - OpenWrt Wiki</a> - Using MASQUERADE&quot;.</p><p>1. /etc/config/network<br /></p><div class="codebox"><pre><code>config interface loopback
        option  ifname          lo
        option  proto           static
        option  ipaddr          127.0.0.1
        option  netmask         255.0.0.0

config interface lan
        option  ifname          &#039;eth0 eth1&#039;
        option  type            bridge
        option  proto           static
        option  netmask         255.255.255.0
        option  ipaddr          192.168.11.1

config &#039;route&#039;
        option  interface       lan
        option  gateway         &#039;192.168.11.15&#039;
        option  target          &#039;192.168.15.0&#039;
        option  netmask         &#039;255.255.255.0&#039;

config interface wan
        option  proto           dhcp

config switch eth0
        option  enable_vlan     1

config switch_vlan
        option  device          eth0
        option  vlan            1
        option  ports           &#039;0 1 2 3 4&#039;</code></pre></div><p>2. /etc/config/wireless<br /></p><div class="codebox"><pre><code>config wifi-device radio0
        option  type            mac80211
        option  channel         11
        option  macaddr         00:26:5a:f4:61:83
        option  hwmode          11ng
        option  htmode          HT20
        list    ht_capab        SHORT-GI-40
        list    ht_capab        TX-STBC
        list    ht_capab        RX-STBC1
        list    ht_capab        DSSS_CCK-40
        option  disabled        0
        option  txpower         20
        option  country         US

config wifi-iface sta
        option  network         wan
        option  encryption      none
        option  device          radio0
        option  mode            sta
        option  ssid            default

config wifi-iface ap
        option  network         lan
        option  encryption      psk2
        option  key         your_key
        option  device          radio0
        option  mode            ap
        option  ssid            repeater</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p135917">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						24 May 2011, 20:43					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>fyi wrote:</cite><blockquote><p>You should refer to &quot;<a href="http://wiki.openwrt.org/doc/recipes/routedclient#using.masquerade">Routed Client - OpenWrt Wiki</a> - Using MASQUERADE&quot;.</p></blockquote></div><p>I haven&#039;t done the MASQUERADE as you mentioned in the above link, yet. Nevertheless, I followed your suggestions for the /etc/config/network and /etc/config/wireless files and my FR-54RTR device is still having problem to connect to my other WiFi device with a default SSID. I don&#039;t suppose this has something to do with masquerade and/or firewall or does it?</p><p>Here is some excerpts from the output of <em>ifconfig</em> and <em>logread</em>:</p><p>1. ifconfig<br /></p><div class="codebox"><pre><code>root@Noone:~# ifconfig
br-lan    Link encap:Ethernet  HWaddr 00:26:5A:F4:61:83
          inet addr:192.168.11.1  Bcast:192.168.11.255  Mask:255.255.255.0
          inet6 addr: fe80::226:5aff:fef4:6183/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:3896 errors:0 dropped:0 overruns:0 frame:0
          TX packets:3545 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:285095 (278.4 KiB)  TX bytes:460197 (449.4 KiB)

eth0      Link encap:Ethernet  HWaddr 00:26:5A:F4:61:83
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:3901 errors:0 dropped:0 overruns:0 frame:0
          TX packets:3597 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:339939 (331.9 KiB)  TX bytes:463629 (452.7 KiB)
          Interrupt:5

eth1      Link encap:Ethernet  HWaddr 00:26:5A:F4:61:82
          UP BROADCAST MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
          Interrupt:4

ifb0      Link encap:Ethernet  HWaddr E2:D3:87:89:0D:61
          inet6 addr: fe80::e0d3:87ff:fe89:d61/64 Scope:Link
          UP BROADCAST RUNNING NOARP  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:5
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:60 errors:0 dropped:0 overruns:0 frame:0
          TX packets:60 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:4686 (4.5 KiB)  TX bytes:4686 (4.5 KiB)

mon.wlan0 Link encap:UNSPEC  HWaddr 00-26-5A-F4-61-83-00-47-00-00-00-00-00-00-00-00
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:28217 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:3209412 (3.0 MiB)  TX bytes:0 (0.0 B)

wlan0     Link encap:Ethernet  HWaddr 00:26:5A:F4:61:82
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:83 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 B)  TX bytes:7198 (7.0 KiB)

wlan1     Link encap:Ethernet  HWaddr 06:26:5A:F4:61:82
          UP BROADCAST MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:5
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)</code></pre></div><p>2. logread<br /></p><div class="codebox"><pre><code>root@Noone:~# logread
Mar 26 23:32:16 Noone kern.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 timed out
Mar 26 23:32:21 Noone kern.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 (try 1/3)
Mar 26 23:32:22 Noone kern.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 (try 2/3)
Mar 26 23:32:22 Noone kern.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 (try 3/3)
Mar 26 23:32:22 Noone kern.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 timed out
Mar 26 23:32:27 Noone kern.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 (try 1/3)
Mar 26 23:32:27 Noone kern.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 (try 2/3)
Mar 26 23:32:28 Noone kern.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 (try 3/3)
Mar 26 23:32:28 Noone kern.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 timed out
Mar 26 23:32:33 Noone kern.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 (try 1/3)
Mar 26 23:32:33 Noone kern.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 (try 2/3)
Mar 26 23:32:33 Noone kern.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 (try 3/3)
Mar 26 23:32:34 Noone kern.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 timed out
Mar 26 23:32:39 Noone kern.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 (try 1/3)
Mar 26 23:32:39 Noone kern.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 (try 2/3)
Mar 26 23:32:39 Noone kern.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 (try 3/3)
Mar 26 23:32:39 Noone kern.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 timed out
Mar 26 23:32:45 Noone kern.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 (try 1/3)
Mar 26 23:32:45 Noone kern.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 (try 2/3)
Mar 26 23:32:45 Noone kern.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 (try 3/3)
Mar 26 23:32:45 Noone kern.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 timed out</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p135922">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						24 May 2011, 21:51					</div>
				</div>
				<div class="post-content content">
					<p>Upgrade to Backfire 10.03.1-rc4 or RC5-testing in trunk.<br />Run &quot;iwlist wlan1 scan&quot; several times and show me the output of the last one.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p135975">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						25 May 2011, 16:52					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>fyi wrote:</cite><blockquote><p>Upgrade to Backfire 10.03.1-rc4 or RC5-testing in trunk.<br />Run &quot;iwlist wlan1 scan&quot; several times and show me the output of the last one.</p></blockquote></div><p>I compiled/built my own OpenWRT from SVN tree with the r27001 (if that matters). Anyway, here is the output from <em>iwlist wlan1 scan</em>:<br /></p><div class="codebox"><pre><code>wlan1     Scan completed :
          Cell 01 - Address: 00:E0:98:15:40:82
                    Channel:11
                    Frequency:2.462 GHz (Channel 11)
                    Quality=22/70  Signal level=-88 dBm
                    Encryption key:off
                    ESSID:&quot;default&quot;
                    Bit Rates:1 Mb/s; 2 Mb/s; 5.5 Mb/s; 11 Mb/s
                    Mode:Master
                    Extra:tsf=0000011fc402f17f
                    Extra: Last beacon: 90ms ago
                    IE: Unknown: 000764656661756C74
                    IE: Unknown: 010482848B96
                    IE: Unknown: 03010B
                    IE: Unknown: 0406010200000000
                    IE: Unknown: 05060001000037AF
                    IE: Unknown: 0032080C1218243048606C00000000000000000000000000000000000000000000000000000000000000000000
          Cell 02 - Address: 2E:25:B3:95:C2:E9
                    Channel:6
                    Frequency:2.437 GHz (Channel 6)
                    Quality=34/70  Signal level=-76 dBm
                    Encryption key:off
                    ESSID:&quot;hpsetup&quot;
                    Bit Rates:1 Mb/s; 2 Mb/s; 5.5 Mb/s; 11 Mb/s
                    Mode:Ad-Hoc
                    Extra:tsf=000003ee94baa170
                    Extra: Last beacon: 1710ms ago
                    IE: Unknown: 000768707365747570
                    IE: Unknown: 010482848B96
                    IE: Unknown: 030106
                    IE: Unknown: 06020000</code></pre></div><p>BTW, in my previous post, did you notice the output from <em>ifconfig</em> had an entry called <strong>mon.wlan0</strong>? I believe it got created when I used LuCI GUI to change the WiFi mode to monitor in the older version of firmware and I just don&#039;t know how to remove it (even after a reset and/or firmware upgrades).</p><p>OTOH, the default settings in <em>forwarding</em> section of /etc/config/firewall shows as follows:<br /></p><div class="codebox"><pre><code>        option &#039;src&#039;        &#039;lan&#039;
        option &#039;dest&#039;       &#039;wan&#039;</code></pre></div><p>While on the &quot;<a href="http://wiki.openwrt.org/doc/recipes/routedclient#using.masquerade">Routed Client - OpenWrt Wiki</a> - Using MASQUERADE&quot;, the src/dest vs. lan/wan are switched as shown below:<br /></p><div class="codebox"><pre><code>        option &#039;src&#039;        &#039;wan&#039;
        option &#039;dest&#039;       &#039;lan&#039;</code></pre></div><p>I don&#039;t know if that matters; however, I have changed the default settings in <em>forwarding</em> section of /etc/config/firewall to reflect the above and my FR-54RTR still won&#039;t connect.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p135979">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						25 May 2011, 18:02					</div>
				</div>
				<div class="post-content content">
					<p>Run &quot;iwconfig&quot;.<br /></p><div class="quotebox"><cite>mazilo wrote:</cite><blockquote><div class="quotebox"><cite>fyi wrote:</cite><blockquote><p>Upgrade to Backfire 10.03.1-rc4 or RC5-testing in trunk.<br />Run &quot;iwlist wlan1 scan&quot; several times and show me the output of the last one.</p></blockquote></div><p>I compiled/built my own OpenWRT from SVN tree with the r27001 (if that matters).</p></blockquote></div><p>Install Backfire 10.03.1-rc4 and make it work. Later you can take your time to debug your own build.<br /></p><div class="quotebox"><cite>mazilo wrote:</cite><blockquote><p>I don&#039;t know if that matters; however, I have changed the default settings in <em>forwarding</em> section of /etc/config/firewall to reflect the above and my FR-54RTR still won&#039;t connect.</p></blockquote></div><p>You referred to &quot;Using routing&quot;.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p135985">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						25 May 2011, 19:53					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>fyi wrote:</cite><blockquote><p>Run &quot;iwconfig&quot;.</p></blockquote></div><p>Here is the output from <em>iwconfig</em> (after downgraded to backfire 10.03.1-rc4):<br /></p><div class="codebox"><pre><code>root@OpenWrt:/# iwconfig
lo        no wireless extensions.

eth0      no wireless extensions.

eth1      no wireless extensions.

br-lan    no wireless extensions.

wlan0     IEEE 802.11bgn  Mode:Master  Frequency:2.462 GHz  Tx-Power=20 dBm   
          RTS thr:off   Fragment thr:off
          Power Management:on
          
wlan1     IEEE 802.11bgn  ESSID:off/any  
          Mode:Managed  Access Point: Not-Associated   Tx-Power=20 dBm   
          RTS thr:off   Fragment thr:off
          Encryption key:off
          Power Management:off
          
mon.wlan0  IEEE 802.11bgn  Mode:Monitor  Tx-Power=20 dBm   
          RTS thr:off   Fragment thr:off
          Power Management:off</code></pre></div><div class="quotebox"><cite>fyi wrote:</cite><blockquote><p>Install Backfire 10.03.1-rc4 and make it work. Later you can take your time to debug your own build.</p></blockquote></div><p>OK. I downgraded to backfire 10.03-rc4 as shown below and it still won&#039;t connect even after I reconfigured using your suggestion above.<br /></p><div class="codebox"><pre><code>[mazilo@Mi:/opt/openwrt-svn-trunk 18%] ~ telnet 192.168.1.1
Trying 192.168.1.1...
Connected to 192.168.1.1.
Escape character is &#039;^]&#039;.
 === IMPORTANT ============================
  Use &#039;passwd&#039; to set your login password
  this will disable telnet and enable SSH
 ------------------------------------------


BusyBox v1.15.3 (2010-11-11 22:22:00 PST) built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 Backfire (10.03.1-rc4, r24045) --------------------
  * 1/3 shot Kahlua    In a shot glass, layer Kahlua 
  * 1/3 shot Bailey&#039;s  on the bottom, then Bailey&#039;s, 
  * 1/3 shot Vodka     then Vodka.
 ---------------------------------------------------
root@OpenWrt:/# ifconfig
br-lan    Link encap:Ethernet  HWaddr 00:26:5A:F4:61:83
          inet addr:192.168.1.1  Bcast:192.168.1.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:178 errors:0 dropped:0 overruns:0 frame:0
          TX packets:132 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:10826 (10.5 KiB)  TX bytes:14029 (13.7 KiB)

eth0      Link encap:Ethernet  HWaddr 00:26:5A:F4:61:83
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:182 errors:0 dropped:0 overruns:0 frame:0
          TX packets:133 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:13625 (13.3 KiB)  TX bytes:15072 (14.7 KiB)
          Interrupt:5 

eth1      Link encap:Ethernet  HWaddr 00:26:5A:F4:61:82
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:1 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:402 (402.0 B)
          Interrupt:4 

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

mon.wlan0 Link encap:UNSPEC  HWaddr 00-26-5A-F4-61-83-00-00-00-00-00-00-00-00-00-00  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:16 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:2881 (2.8 KiB)  TX bytes:0 (0.0 B)

wlan0     Link encap:Ethernet  HWaddr 00:26:5A:F4:61:82
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:1 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:420 (420.0 B)

wlan1     Link encap:Ethernet  HWaddr 06:26:5A:F4:61:82
          UP BROADCAST MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

root@OpenWrt:/# logread
Nov 19 19:30:07 OpenWrt user.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 (try 1)
Nov 19 19:30:08 OpenWrt user.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 (try 2)
Nov 19 19:30:08 OpenWrt user.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 (try 3)
Nov 19 19:30:08 OpenWrt user.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 timed out
Nov 19 19:30:16 OpenWrt user.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 (try 1)
Nov 19 19:30:16 OpenWrt user.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 (try 2)
Nov 19 19:30:16 OpenWrt user.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 (try 3)
Nov 19 19:30:16 OpenWrt user.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 timed out</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p136000">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						25 May 2011, 23:48					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>mazilo wrote:</cite><blockquote><div class="codebox"><pre><code>wlan1     IEEE 802.11bgn  ESSID:off/any</code></pre></div></blockquote></div><div class="quotebox"><cite>mazilo wrote:</cite><blockquote><div class="codebox"><pre><code>root@OpenWrt:/# logread
Nov 19 19:30:07 OpenWrt user.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 (try 1)
Nov 19 19:30:08 OpenWrt user.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 (try 2)
Nov 19 19:30:08 OpenWrt user.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 (try 3)
Nov 19 19:30:08 OpenWrt user.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 timed out</code></pre></div></blockquote></div><p><a href="http://www.mail-archive.com/ath9k-devel@lists.ath9k.org/msg05489.html">Re: [ath9k-devel] AR9280 issue @ 2.4 GHZ</a></p><p>I can&#039;t figure out why the ap didn&#039;t respond. Please run &quot;wifi down&quot; and then modify,<br /></p><div class="codebox"><pre><code>config wifi-device radio0
        option  type            mac80211
        option  channel         11
        option  macaddr         00:26:5a:f4:61:83
        option  hwmode          11b
        option  htmode          HT20
        option  disabled        0
        option  txpower         20</code></pre></div><p>Now run &quot;wifi up ; iwlist wlan1 scan ; iwconfig wlan1 ; cat /var/run/wpa_supplicant-wlan1.conf&quot;.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p136037">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						26 May 2011, 15:20					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>fyi wrote:</cite><blockquote><p>I can&#039;t figure out why the ap didn&#039;t respond. Please run &quot;wifi down&quot; and then modify,<br /></p><div class="codebox"><pre><code>config wifi-device radio0
        option  type            mac80211
        option  channel         11
        option  macaddr         00:26:5a:f4:61:83
        option  hwmode          11b
        option  htmode          HT20
        option  disabled        0
        option  txpower         20</code></pre></div><p>Now run &quot;wifi up ; iwlist wlan1 scan ; iwconfig wlan1 ; cat /var/run/wpa_supplicant-wlan1.conf&quot;.</p></blockquote></div><p>I did the above and <em>logread</em> still dumped the same messages as shown below:<br /></p><div class="codebox"><pre><code>root@OpenWrt:/# iwlist wlan1 scan
wlan1     Scan completed :
          Cell 01 - Address: 00:E0:98:15:40:82
                    Channel:11
                    Frequency:2.462 GHz (Channel 11)
                    Quality=20/70  Signal level=-90 dBm  
                    Encryption key:off
                    ESSID:&quot;default&quot;
                    Bit Rates:1 Mb/s; 2 Mb/s; 5.5 Mb/s; 11 Mb/s
                    Mode:Master
                    Extra:tsf=00000132c88c417f
                    Extra: Last beacon: 70ms ago
                    IE: Unknown: 000764656661756C74
                    IE: Unknown: 010482848B96
                    IE: Unknown: 03010B
                    IE: Unknown: 0406000200000000
                    IE: Unknown: 05060001000037AF
                    IE: Unknown: 0032080C1218243048606C00000000000000000000000000000000000000000000000000000000000000000000

root@OpenWrt:/#  iwconfig wlan1
wlan1     IEEE 802.11bgn  ESSID:off/any  
          Mode:Managed  Access Point: Not-Associated   Tx-Power=20 dBm   
          RTS thr:off   Fragment thr:off
          Encryption key:off
          Power Management:off
          
root@OpenWrt:/# cat /var/run/wpa_supplicant-wlan1.conf
ctrl_interface=/var/run/wpa_supplicant-wlan1
network={
    scan_ssid=1
    ssid=&quot;default&quot;
    
    key_mgmt=NONE
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
}

root@OpenWrt:/# logread
Nov 19 19:36:07 OpenWrt user.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 timed out
Nov 19 19:36:19 OpenWrt user.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 (try 1)
Nov 19 19:36:20 OpenWrt user.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 (try 2)
Nov 19 19:36:20 OpenWrt user.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 (try 3)
Nov 19 19:36:20 OpenWrt user.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 timed out
Nov 19 19:36:50 OpenWrt user.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 (try 1)
Nov 19 19:36:51 OpenWrt user.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 (try 2)
Nov 19 19:36:51 OpenWrt user.debug kernel: wlan1: direct probe to 00:e0:98:15:40:82 (try 3)</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p136043">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						26 May 2011, 16:42					</div>
				</div>
				<div class="post-content content">
					<p>I have run out of ideas. Maybe you should open a ticket because not just you having this ath9k sta mode problem and got omitted.</p><p><a href="https://dev.openwrt.org/ticket/7385">#7385 (Missing module for ath9k_htc) – OpenWrt</a> (comment 11)</p><p>Do you have other OpenWrt supported routers? Fonera?</p>											<p class="post-edited">(Last edited by <strong>fyi</strong> on 26 May 2011, 17:26)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p136491">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						3 Jun 2011, 17:52					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>fyi wrote:</cite><blockquote><p>I have run out of ideas. Maybe you should open a ticket because not just you having this ath9k sta mode problem and got omitted.</p></blockquote></div><p>At least we tried. Anyway, after I upgraded to SVN r27096, my FR-54RTR can connect and gets assigned with a private IP Address. Computers connected behind this FR-54RTR can now connect to Internet, but is very slow even though the connection speed is about 2Mbps.</p><div class="quotebox"><blockquote><p>Do you have other OpenWrt supported routers? Fonera?</p></blockquote></div><p>Yes and I do have some FON2100 units laying around. I flashed it with the newly compiled firmware and it works too, but the performance is too sluggish that it becomes unusable.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p136517">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						4 Jun 2011, 11:51					</div>
				</div>
				<div class="post-content content">
					<p>How far is the apartment WiFi from you? Since you can only reach 2Mbps, I&#039;d suggest setting the radio to 11g.</p><p>I still run Kamikaze 8.09.2 on my FON2201. I&#039;m satisfied with the performance and the maximum txpower 18 dBm is not so bad either.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>