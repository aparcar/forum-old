<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> ntop on OpenWRT?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 5 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p276740">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">fenris</div>
					<div class="post-datetime">
						19 May 2015, 13:26					</div>
				</div>
				<div class="post-content content">
					<p>Has anyone tried getting ntop to run successfully on OpenWRT, or would it be too heavy?</p><p>I&#039;m running it on my desktop machine, but it would be much nicer to have it on the router, and monitor the traffic there, as it provides a lot of useful stats and information.</p><p>Before starting to mess with building my own package, I just wanted to ask if someone else has already though of or tried this, or if it would slow the router (an Archer C5 in my case) to a crawl.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p276749">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">richbhanover</div>
					<div class="post-datetime">
						19 May 2015, 14:49					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>fenris wrote:</cite><blockquote><p>Has anyone tried getting ntop to run successfully on OpenWRT, or would it be too heavy?</p><p>I&#039;m running it on my desktop machine, but it would be much nicer to have it on the router, and monitor the traffic there, as it provides a lot of useful stats and information.</p><p>Before starting to mess with building my own package, I just wanted to ask if someone else has already though of or tried this, or if it would slow the router (an Archer C5 in my case) to a crawl.</p></blockquote></div><p>It&#039;s certainly true that ntop would give you a ton of interesting info about what&#039;s happening on your network - who&#039;s sending traffic to whom, how much they&#039;re sending, who&#039;s hogging your WAN link, etc.</p><p>My glib answer is to go for it. The Archer C5 has a pretty capable CPU, it has plenty of RAM, and the amount of traffic (at your home?) will likely be pretty moderate. (Besides - what else does your router have to do except make you happy? :-)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p276756">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">fenris</div>
					<div class="post-datetime">
						19 May 2015, 15:22					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>richbhanover wrote:</cite><blockquote><p>It&#039;s certainly true that ntop would give you a ton of interesting info about what&#039;s happening on your network - who&#039;s sending traffic to whom, how much they&#039;re sending, who&#039;s hogging your WAN link, etc.</p><p>My glib answer is to go for it. The Archer C5 has a pretty capable CPU, it has plenty of RAM, and the amount of traffic (at your home?) will likely be pretty moderate. (Besides - what else does your router have to do except make you happy? :-)</p></blockquote></div><p>Yes, it would be helpful to have it on the router. It would be a great way to get info on rogue apps on my Android devices who communicate with the outside, for instance. The statistics are also quite thorough.</p><p>What I&#039;m a bit concerned about is that I&#039;m intending to set up QoS, and probably also OpenVPN or StrongSwan. Together with ntop, this might be too much on a 50/10 link. Has anyone got any thoughts on this?</p><p>Also, if I *am* going to get ntop going on the router, it might not be too much extra work to just make a package for OpenWRT, so that others can easily use it also. I assume there is info on the wiki on how to do this. Frankly, I was a little surprised that there isn&#039;t already a package available since it seems it could obviously be useful, and assumed that was because it might be too heavy or have too many dependencies. Would there be any interest in getting a package for OpenWRT for anyone else, or would few/nobody be able to use it?</p><p>I do agree that the router is there to make me happy <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> It&#039;s just that there is obviously a limit as to how much it can reasonably do, and it is hard to know how much of a load ntop would place on the router based on the load it places on my desktop machines.</p><p>Thoughts/advice/input?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p276798">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						19 May 2015, 23:47					</div>
				</div>
				<div class="post-content content">
					<p>One alternative is to run softflowd on the router and send the data to ntop running on an external server.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p276856">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">richbhanover</div>
					<div class="post-datetime">
						20 May 2015, 15:53					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>arokh wrote:</cite><blockquote><p>One alternative is to run softflowd on the router and send the data to ntop running on an external server.</p></blockquote></div><p>Yes, there are a number of NetFlow exporters: softflowd, nprobe, fprobe that could send the traffic summaries to a NetFlow collector. (OP was asking whether to set up ntop as a NetFlow collector running on OpenWrt itself...)</p><p>But... I see both two &quot;netflow collector&quot; packages that are already in BB: </p><p>- flow-tools (<a href="https://code.google.com/p/flow-tools/">https://code.google.com/p/flow-tools/</a>) <br />- pmacctd (<a href="http://www.pmacct.net/">http://www.pmacct.net/</a>) </p><p>Are either of these working/valuable/maintained?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p276867">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						20 May 2015, 16:40					</div>
				</div>
				<div class="post-content content">
					<p>The way I&#039;m reading it he wants to run it on the router in order to see traffic from his Android devices as well (running it on his desktop doesn&#039;t allow that). Of course you could do that, but it would require packaging ntop for OpenWrt. Good luck with getting all the dependencies on there.</p><p>He&#039;s asking for advice/thoughts, and I&#039;d say running a NetFlow collector on the router is all he needs. He&#039;s already got ntop on his desktop, just feed it data from the router and voila. softflowd is already packaged and available in the repos.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p276976">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">fenris</div>
					<div class="post-datetime">
						21 May 2015, 09:28					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>arokh wrote:</cite><blockquote><p>The way I&#039;m reading it he wants to run it on the router in order to see traffic from his Android devices as well (running it on his desktop doesn&#039;t allow that). Of course you could do that, but it would require packaging ntop for OpenWrt. Good luck with getting all the dependencies on there.</p><p>He&#039;s asking for advice/thoughts, and I&#039;d say running a NetFlow collector on the router is all he needs. He&#039;s already got ntop on his desktop, just feed it data from the router and voila. softflowd is already packaged and available in the repos.</p></blockquote></div><p>Yeah, I&#039;m starting to think getting the dependencies on the router is going to be too much of a hassle. I tried to set up softflowd to collect data for ntop running on the desktop, but haven&#039;t gotten them working together yet. Will try again later today.</p><p>It is probably the best way to do it, though, and I really appreciate the suggestion - I wasn&#039;t aware of it.</p><p>Thanks again.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p277279">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">fenris</div>
					<div class="post-datetime">
						23 May 2015, 12:37					</div>
				</div>
				<div class="post-content content">
					<p>This is odd.</p><p>I&#039;ve managed to set up softflowd to collect data for ntop, but it seems ntop only gets a small fraction of the relevant data. There are no errors, so I would guess softflowd simply doesn&#039;t collect everything it should. Here&#039;s my config:</p><p>root@router:/etc/config# cat softflowd <br />config softflowd<br />&nbsp; &nbsp; option enabled&nbsp; &nbsp; &nbsp; &nbsp; &#039;1&#039;<br />&nbsp; &nbsp; option interface&nbsp; &nbsp; &nbsp; &#039;br-lan&#039;<br />&nbsp; &nbsp; option pcap_file&nbsp; &nbsp; &nbsp; &#039;&#039;<br />&nbsp; &nbsp; option timeout&nbsp; &nbsp; &nbsp; &nbsp; &#039;&#039;<br />&nbsp; &nbsp; option max_flows&nbsp; &nbsp; &nbsp; &#039;8192&#039;<br />&nbsp; &nbsp; option host_port&nbsp; &nbsp; &nbsp; &#039;192.168.0.105:2055&#039;<br />&nbsp; &nbsp; option pid_file&nbsp; &nbsp; &nbsp; &nbsp;&#039;/var/run/softflowd.pid&#039;<br />&nbsp; &nbsp; option control_socket &#039;/var/run/softflowd.ctl&#039;<br />&nbsp; &nbsp; option export_version &#039;5&#039;<br />&nbsp; &nbsp; option hoplimit&nbsp; &nbsp; &nbsp; &nbsp;&#039;&#039;<br />&nbsp; &nbsp; option tracking_level &#039;full&#039;<br />&nbsp; &nbsp; option track_ipv6&nbsp; &nbsp; &nbsp;&#039;1&#039;<br />&nbsp; &nbsp; option sampling_rate&nbsp; &#039;100&#039;</p><p>Is there anything obvious I&#039;m missing? Sometimes it&#039;s a real shame that man pages aren&#039;t installed <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> I&#039;ve read the online docs, though, and can&#039;t see anything obvious.</p><p>Also, what&#039;s the difference between NetFlow and sFlow? Should I try something like hsflowd instead, and set up the sFlow plugin in ntop to collect from that?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p281065">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						23 Jun 2015, 04:04					</div>
				</div>
				<div class="post-content content">
					<p>I had the same issue, searched for an alternative and found ipcad in oldpackages. It compiles and runs fine, except there is no UCI and init script.</p><p>Here&#039;s my ipcad.conf:</p><div class="codebox"><pre><code>interface &quot;br-lan&quot;;
netflow export destination 1.2.3.4 2055;</code></pre></div><p>Run it like this: ipcad -c /path/to/ipad.conf -d</p><p>It works great I can see all the flows in ntop.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>