<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> HG658c - capturing a firmware update?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 6 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p228445">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">dmcdonnell</div>
					<div class="post-datetime">
						26 Mar 2014, 01:06					</div>
				</div>
				<div class="post-content content">
					<p>I have a Vodafone branded HG658c which will update it&#039;s firmware when exposed to the internet, as it runs an tr-069 daemon. Normally the update would happen when it is plugged into an xDSL line. I would like to use a wired connection to my openwrt router to expose it to the net and capture all traffic on, say, LAN1, to USB storage. Post update, I want to use wireshark to examine the exchange.</p><p>How do I capture all traffic on LAN1?</p><p>TIA,</p><p>Dermot</p>											<p class="post-edited">(Last edited by <strong>dmcdonnell</strong> on 27 Mar 2014, 18:16)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228475">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">danitool</div>
					<div class="post-datetime">
						26 Mar 2014, 12:51					</div>
				</div>
				<div class="post-content content">
					<p>For sniffing the exchange you need to make a man in the middle, but at the dsl port. You may need some kind of media converter.</p><p>Esample<br /><a href="http://lab.algasystems.net/2012/01/amtec-elsagdatamag-argo-5595-take-3/">http://lab.algasystems.net/2012/01/amte … 95-take-3/</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228489">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						26 Mar 2014, 14:33					</div>
				</div>
				<div class="post-content content">
					<p>Hopefully, the traffics are not encrypted.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228605">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">dmcdonnell</div>
					<div class="post-datetime">
						27 Mar 2014, 18:16					</div>
				</div>
				<div class="post-content content">
					<p>Hi Dani &amp; Mazilo,</p><p>I got a boot log by making a serial connection, you can find it here, <a href="http://pastebin.com/YxkiEtZn">http://pastebin.com/YxkiEtZn</a></p><p>My plan to capture the firmware update is not to use xDSL but to connect the HG658c to my Openwrt Router, an HG556a, via ethernet cable. I need to be able to capture the traffic on LAN1 ethernet port.</p><p>I realise it will likely be encrypted, but you never know until you check <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>											<p class="post-edited">(Last edited by <strong>dmcdonnell</strong> on 28 Mar 2014, 15:58)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228707">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">dmcdonnell</div>
					<div class="post-datetime">
						28 Mar 2014, 19:21					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>danitool wrote:</cite><blockquote><p>For sniffing the exchange you need to make a man in the middle, but at the dsl port. You may need some kind of media converter.</p><p>Esample<br /><a href="http://lab.algasystems.net/2012/01/amtec-elsagdatamag-argo-5595-take-3/">http://lab.algasystems.net/2012/01/amte … 95-take-3/</a></p></blockquote></div><p>Dani,</p><p>Thank you very much for the link. Very interesting indeed.</p><p>I am looking at tcpdump to do the capture on the HG556a. Hopefully the HG658c will update its firmware once the TR-069 daemon can see the Vodafone server. I will report back. The HG658c is available for €20 in the second hand market here in Ireland.</p><p>Regards,</p><p>Dermot</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228756">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">dmcdonnell</div>
					<div class="post-datetime">
						29 Mar 2014, 19:01					</div>
				</div>
				<div class="post-content content">
					<p>I captured a Vodafone firmware update on the HG658c. I used telnet to access the cli on my OpenWrt r40296 router, an HG556a, and set tcpdump to capture all eth0 traffic.</p><p>tcpdump -nnvvXSs0 -w&nbsp; /mnt/usb/HG658c_update_bin</p><p>I used a cat5 cable to connect Lan1on the HG556a to the red WAN port on the HG658c. Within 20mins, the firmware on the HG658c had updated from:</p><p>Product type &nbsp; &nbsp; HG658c <br />Device &nbsp; &nbsp; &nbsp; &nbsp; IDF83DFF-Q8Y7NA9382600371<br />Hardware version&nbsp; &nbsp; HG658BZV VER.A<br />Software version&nbsp; &nbsp; V100R001C172B211<br />Batch number&nbsp; &nbsp; BC172P0.211.A2pv6F037g.d24b1<br />MAC Address&nbsp; &nbsp; 00:66:4B:32:CE:08 <br />System up time&nbsp; &nbsp; 0 days 0 hours 1 minutes 43 seconds</p><p>to</p><p>Product type &nbsp; &nbsp; HG658c<br />Device ID &nbsp; &nbsp; F83DFF-Q8Y7NA9382600371<br />Hardware version &nbsp; &nbsp; HG658BZV VER.A<br />Software version &nbsp; &nbsp; V100R001C172B214<br />Batch number &nbsp; &nbsp; BC172P0.214.A2pv6F038m.d24b1<br />MAC Address &nbsp; &nbsp; 00:66:4B:32:CE:08&nbsp; <br />System up time &nbsp; &nbsp; 0 days 4 hours 34 minutes 48 seconds</p><p>The update was managed by the TR069 daemon on the HG658c. The firmware file appears to be encrypted. You can see the entire, and very interesting, transaction by downloading the capture file and using tcpdump, or your favourite tool, to view it. (15.5MB, tcp &amp; udp packets only) at <a href="http://www.4shared.com/file/0nXSilrSba/hg658c_firmware_update_tcpdump.html">http://www.4shared.com/file/0nXSilrSba/ … pdump.html</a></p><p>New boot log: <a href="http://pastebin.com/1JaF3dPr">http://pastebin.com/1JaF3dPr</a></p>											<p class="post-edited">(Last edited by <strong>dmcdonnell</strong> on 29 Mar 2014, 19:24)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228763">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						29 Mar 2014, 20:02					</div>
				</div>
				<div class="post-content content">
					<p>I don&#039;t know if this inexpensive <a href="http://www.aliexpress.com/item/Free-shipping-New-Mini-Usb-Blaster-Cable-For-CPLD-FPGA-NIOS-JTAG-Altera-Programmer-in-stock/806527241.html">USB Blaster</a> will help you or not, but it is currently on sale for less than US$6 with free S/H to US and some other countries from China. It should work with <a href="http://www.flashrom.org/Flashrom">flashrom</a> and perhaps also <a href="http://openocd.sourceforge.net">OpenOCD</a>.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p283194">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">serdar980</div>
					<div class="post-datetime">
						12 Jul 2015, 11:07					</div>
				</div>
				<div class="post-content content">
					<p>I am a customer of Vodafone Turkey. I received my HG658C a few days ago. I looked on the net for a new firmware. I updated it to this: <a href="https://community.vodafone.ie/t5/Technical-Support/Huawei-HG658c-Software-Update/td-p/147717">https://community.vodafone.ie/t5/Techni … d-p/147717</a></p><p>1) My modem was no locking feature. Now a lot of options are locked.<br />2) It was Turkish. Now it is english. (not important)<br />3) Now its firmware cannot be updated.<br />4) I have not original firmware also.<br />5) You are talking about FLASHING. I don&#039;t know how to do it.<br />6) (worst:) I FEEL LIKE AN IDIOT.</p><p>WHAT CAN I DO?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p284548">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">KHAN85</div>
					<div class="post-datetime">
						22 Jul 2015, 23:54					</div>
				</div>
				<div class="post-content content">
					<p>If you need to capture any traffic of any router, just put another router with OpenWRT in the middle between router to capture traffic and internet connection. Use brctl to make a bridge between two eth interfaces of the router in the middle and use tcpdump to capture the traffic.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>