<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Netgear EVG2000 (Yes, but needs b53 switch detection)</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 30 Mar 2018 and 22 Apr 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 4 of 4</div><nav><ul><li><a href="viewtopic.php%3Fid=63950&amp;p=1.html">1</a></li><li><a href="viewtopic.php%3Fid=63950&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=63950&amp;p=3.html">3</a></li><li class="pagination-current"><span>4</span></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p322194">
				<div class="post-metadata">
					<div class="post-num">Post #76</div>
					<div class="post-author">Xotic750</div>
					<div class="post-datetime">
						2 May 2016, 14:46					</div>
				</div>
				<div class="post-content content">
					<p>I have been revisiting the <span class="bbu">kmod-brcm-wl</span> driver to see if I could get it to function. It fails</p><div class="codebox"><pre><code>wl0: 5.10.56.27 driver failed with code 11</code></pre></div><p>The <a href="https://wireless.wiki.kernel.org/en/users/Drivers/b43">b43 driver page</a> suggests that <em>14e4:4322</em> is supported by b43 and wl driver.</p><p>From searching around it seems that the driver is failing to find/load a SPROM, there is no hardware SPROM on this unit and for the b43 driver we loaded a fallback in the dts file. I thought that fallback would work for the wl driver too, but apparently not. So, the question is how to load a SPROM for the wl driver? If needed I have the .bin from factory.</p><p>Update: looking through the factory source, it puts <span class="bbu">bcm4322_map.bin</span> in <em>/etc/wlan/</em> (<em>/lib/firmware/</em> has also been tried)but is that the same on OpenWRT with the wl driver?</p><p>Update: The following document suggests that it is not supported but may work. <a href="http://www.broadcom.com/docs/linux_sta/README_6.30.223.271.txt">http://www.broadcom.com/docs/linux_sta/ … 23.271.txt</a></p><div class="quotebox"><blockquote><p>SUPPORTED DEVICES<br />-----------------<br />The cards with the following PCI Device IDs are supported with this driver.<br />Both Broadcom and and Dell product names are described.&nbsp; &nbsp;Cards not listed<br />here may also work.</p><p>&nbsp; &nbsp;&nbsp; &nbsp; BRCM&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;PCI&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;PCI&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;Dell<br />&nbsp; &nbsp;&nbsp; &nbsp;Product Name&nbsp; &nbsp;&nbsp; &nbsp;Vendor ID&nbsp; &nbsp; Device ID&nbsp; &nbsp; Product ID<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -------------&nbsp; &nbsp;&nbsp; ----------&nbsp; &nbsp; ---------&nbsp; &nbsp;&nbsp; &nbsp; -----------<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4311 2.4 Ghz&nbsp; &nbsp;&nbsp; &nbsp; &nbsp;0x14e4&nbsp; &nbsp; 0x4311&nbsp; &nbsp; &nbsp; Dell 1390<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4311 Dualband&nbsp; &nbsp;&nbsp; &nbsp; &nbsp;0x14e4&nbsp; &nbsp; 0x4312&nbsp; &nbsp; &nbsp; Dell 1490<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4311 5 Ghz&nbsp; &nbsp;&nbsp; &nbsp; &nbsp;0x14e4&nbsp; &nbsp; &nbsp; &nbsp; 0x4313&nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4312 2.4 Ghz&nbsp; &nbsp;&nbsp; &nbsp; &nbsp;0x14e4&nbsp; &nbsp; 0x4315&nbsp; &nbsp; &nbsp; Dell 1395<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4313 2.4 Ghz&nbsp; &nbsp;&nbsp; &nbsp; &nbsp;0x14e4&nbsp; &nbsp; 0x4727 &nbsp; &nbsp; &nbsp; &nbsp; Dell 1501/1504<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4321 Dualband&nbsp; &nbsp;&nbsp; &nbsp; &nbsp;0x14e4&nbsp; &nbsp; 0x4328&nbsp; &nbsp; &nbsp; Dell 1505<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4321 Dualband&nbsp; &nbsp;&nbsp; &nbsp; &nbsp;0x14e4&nbsp; &nbsp; 0x4328&nbsp; &nbsp; &nbsp; Dell 1500<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4321 2.4 Ghz&nbsp; &nbsp;&nbsp; &nbsp; &nbsp;0x14e4&nbsp; &nbsp; 0x4329&nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4321 5 Ghz&nbsp; &nbsp; &nbsp; &nbsp; 0x14e4&nbsp; &nbsp; 0x432a&nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4322 &nbsp; &nbsp; Dualband&nbsp; &nbsp; 0x14e4&nbsp; &nbsp; 0x432b&nbsp; &nbsp; &nbsp; Dell 1510<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4322 2.4 Ghz&nbsp; &nbsp; &nbsp; 0x14e4 &nbsp; &nbsp; 0x432c&nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4322 5 Ghz&nbsp; &nbsp; &nbsp; &nbsp; 0x14e4 &nbsp; &nbsp; 0x432d&nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 43142 2.4 Ghz&nbsp; &nbsp; &nbsp;0x14e4&nbsp; &nbsp; 0x4365<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 43224 Dualband&nbsp; &nbsp; 0x14e4&nbsp; &nbsp; 0x4353&nbsp; &nbsp; &nbsp; Dell 1520<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 43225 2.4 Ghz&nbsp; &nbsp; &nbsp;0x14e4&nbsp; &nbsp; 0x4357&nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 43227 2.4 Ghz&nbsp; &nbsp; &nbsp;0x14e4&nbsp; &nbsp; 0x4358<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 43228 Dualband&nbsp; &nbsp; 0x14e4&nbsp; &nbsp; 0x4359&nbsp; &nbsp; &nbsp; Dell 1530/1540<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4331&nbsp; Dualband&nbsp; &nbsp; 0x14e4&nbsp; &nbsp; 0x4331<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4360&nbsp; Dualband&nbsp; &nbsp; 0x14e4&nbsp; &nbsp; 0x43a0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4352&nbsp; Dualband&nbsp; &nbsp; 0x14e4&nbsp; &nbsp; 0x43a0</p></blockquote></div>											<p class="post-edited">(Last edited by <strong>Xotic750</strong> on 6 May 2016, 02:58)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p322235">
				<div class="post-metadata">
					<div class="post-num">Post #77</div>
					<div class="post-author">Xotic750</div>
					<div class="post-datetime">
						2 May 2016, 19:11					</div>
				</div>
				<div class="post-content content">
					<p>I have now managed to compile the original v2.2.0.12 (not the latest version v2.2.1.64) factory firmware and have enable <em>telnetd</em> by adding an entry in <em>inittab</em></p><div class="codebox"><pre><code>::once:/usr/sbin/telnetd</code></pre></div><p>And I am now able to <em>telnet</em> into the device with original firmware. I don&#039;t know if this helps with information, but here is some info that has not been available before</p><p><strong>dmesg</strong><br /></p><div class="codebox"><pre><code># dmesg
Linux version 2.6.21.5 (graham@graham-laptop-vm1) (gcc version 4.2.3) #1 Mon May 2 17:10:30 CEST 2016
Parallel flash device: name AM29LV320MT, id 0x2201, size 16384KB
96369PVG prom init
CPU revision is: 0002a031
Determined physical RAM map:
 memory: 03f00000 @ 00000000 (usable)
On node 0 totalpages: 16128
  DMA zone: 32 pages used for memmap
  DMA zone: 0 pages reserved
  DMA zone: 4064 pages, LIFO batch:0
  Normal zone: 94 pages used for memmap
  Normal zone: 11938 pages, LIFO batch:1
Built 1 zonelists.  Total pages: 16002
Kernel command line: root=31:0 ro noinitrd console=ttyS0,115200
brcm mips: enabling icache and dcache...
Primary instruction cache 64kB, physically tagged, 4-way, linesize 16 bytes.
Primary data cache 32kB, 2-way, linesize 16 bytes.
Synthesized TLB refill handler (21 instructions).
Synthesized TLB load handler fastpath (33 instructions).
Synthesized TLB store handler fastpath (33 instructions).
Synthesized TLB modify handler fastpath (32 instructions).
PID hash table entries: 256 (order: 8, 1024 bytes)
Using 200.000 MHz high precision timer.
Dentry cache hash table entries: 8192 (order: 3, 32768 bytes)
Inode-cache hash table entries: 4096 (order: 2, 16384 bytes)
Allocating memory for DSP module core and initialization code
Allocated DSP module memory - CORE=0x8108c700 SIZE=868272, INIT=0x0 SIZE=0
Memory: 60372k/64512k available (2103k kernel code, 4124k reserved, 332k data, 96k init, 0k highmem)
KLOB Pool 1 Initialized: 1048576 bytes &lt;0x80300000 ... 0x80400000&gt;
Calibrating delay loop... 398.33 BogoMIPS (lpj=199168)
Mount-cache hash table entries: 512
NET: Registered protocol family 16
Total Flash size: 16384K with 128 sectors
File system address: 0xb8020100
registering PCI controller with io_map_base unset
SCSI subsystem initialized
usbcore: registered new interface driver usbfs
usbcore: registered new interface driver hub
usbcore: registered new device driver usb
BLOG v1.0 Initialized
Time: MIPS clocksource has been installed.
NET: Registered protocol family 2
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 2048 (order: 2, 16384 bytes)
TCP bind hash table entries: 2048 (order: 1, 8192 bytes)
TCP: Hash tables configured (established 2048 bind 2048)
TCP reno registered
squashfs: version 3.2-r2 (2007/01/15) Phillip Lougher
squashfs: LZMA suppport for slax.org by jro
fuse init (API version 7.8)
io scheduler noop registered (default)
PPP generic driver version 2.4.2
NET: Registered protocol family 24
physmap platform flash device: 01000000 at b8000000
physmap-flash.0: Found 1 x16 devices at 0x0 in 16-bit bank
 Amd/Fujitsu Extended Query Table at 0x0040
physmap-flash.0: CFI does not contain boot bank location. Assuming top.
number of CFI chips: 1
cfi_cmdset_0002: Disabling erase-suspend-program due to code brokenness.
cmdlinepart partition parsing not available
RedBoot partition parsing not available
Using physmap partition information
Creating 8 MTD partitions on &quot;physmap-flash.0&quot;:
0x00020100-0x00f60000 : &quot;rootfs&quot;
mtd: partition &quot;rootfs&quot; doesn&#039;t start on an erase block boundary -- force read-only
0x00020000-0x00f60000 : &quot;fw_upgrade&quot;
0x00f60000-0x00f80000 : &quot;T_Meter1&quot;
0x00f80000-0x00fa0000 : &quot;T_Meter2&quot;
0x00fa0000-0x00fc0000 : &quot;POT&quot;
0x00fc0000-0x00fe0000 : &quot;board_data&quot;
0x00fe0000-0x01000000 : &quot;nvram&quot;
0x00000000-0x01000000 : &quot;whole_flash&quot;
PCI: Enabling device 0000:00:0a.0 (0000 -&gt; 0002)
PCI: Setting latency timer of device 0000:00:0a.0 to 64
ehci_hcd 0000:00:0a.0: EHCI Host Controller
ehci_hcd 0000:00:0a.0: new USB bus registered, assigned bus number 1
ehci_hcd 0000:00:0a.0: irq 15, io mem 0x10001500
ehci_hcd 0000:00:0a.0: USB f.f started, EHCI 1.00, driver 10 Dec 2004
usb usb1: configuration #1 chosen from 1 choice
hub 1-0:1.0: USB hub found
hub 1-0:1.0: 2 ports detected
ohci_hcd: 2006 August 04 USB 1.1 &#039;Open&#039; Host Controller (OHCI) Driver
PCI: Enabling device 0000:00:09.0 (0000 -&gt; 0002)
PCI: Setting latency timer of device 0000:00:09.0 to 64
ohci_hcd 0000:00:09.0: OHCI Host Controller
ohci_hcd 0000:00:09.0: new USB bus registered, assigned bus number 2
ohci_hcd 0000:00:09.0: irq 13, io mem 0x10001600
usb usb2: configuration #1 chosen from 1 choice
hub 2-0:1.0: USB hub found
hub 2-0:1.0: 2 ports detected
usbcore: registered new interface driver usblp
drivers/usb/class/usblp.c: v0.13: USB Printer Device Class driver
Initializing USB Mass Storage driver...
usbcore: registered new interface driver usb-storage
USB Mass Storage support registered.
brcmboard: brcm_board_init entry

===&gt;brcm_board_init: GPIO-&gt;GPIOBaseMode=0x32b01

===&gt;brcm_board_init: GPIO-&gt;GPIOMode=0x1f0000
Serial: BCM63XX driver $Revision: 3.00 $
ttyS0 at MMIO 0xb0000100 (irq = 10) is a BCM63XX
ttyS1 at MMIO 0xb0000120 (irq = 11) is a BCM63XX
netem: version 1.2
u32 classifier
Netfilter messages via NETLINK v0.30.
nf_conntrack version 0.5.0 (504 buckets, 4032 max)
TCP cubic registered
NET: Registered protocol family 1
NET: Registered protocol family 17
NET: Registered protocol family 15
802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;
All bugs added by David S. Miller &lt;davem@redhat.com&gt;
VFS: Mounted root (squashfs filesystem) readonly.
Freeing unused kernel memory: 96k freed
pktflow: module license &#039;Proprietary&#039; taints kernel.
Broadcom Packet Flow Cache learning via BLOG enabled.
Created Proc FS /procfs/fcache
Constructed Broadcom Packet Flow Cache v0.1 Feb 26 2009 13:53:46
Broadcom Packet CMF (Experimental) Char Driver v0.1 Feb 26 2009 13:53:45 Registered&lt;232&gt;
Broadcom Packet CMF (Experimental) [6369-B2] v0.1 Feb 26 2009 13:53:45 Loaded
Broadcom BCMPROCFS v1.0 initialized
Broadcom BCM6369B2 Ethernet Network Device v0.1 May 31 2010 11:17:00
KLOB extended to 2 pools
KLOB extended to 3 pools
KLOB extended to 4 pools
dgasp: kerSysRegisterDyingGaspHandler: bcmsw registered 
Broadcom Packet CMF (Experimental) SWC RESET.
Broadcom Packet CMF (Experimental) SWC INITIALIZED.
KLOB extended to 5 pools
KLOB extended to 6 pools
KLOB extended to 7 pools
KLOB extended to 8 pools
Broadcom Packet CMF (Experimental) Forwarder Net Device 0 v0.1 Feb 26 2009 13:53:46 Registered
Broadcom Packet CMF (Experimental) Forwarder Net Device 1 v0.1 Feb 26 2009 13:53:46 Registered
Broadcom Packet CMF (Experimental) ENABLED.
eth0: MAC Address: A0:21:B7:77:4C:AF
eth1: MAC Address: A0:21:B7:77:4C:AF
eth2: MAC Address: A0:21:B7:77:4C:AF
eth3: MAC Address: A0:21:B7:77:4C:AF
eth4: MAC Address: A0:21:B7:77:4C:AF
eth5: MAC Address: A0:21:B7:77:4C:AF
PCI: Enabling device 0000:00:01.0 (0000 -&gt; 0002)
PCI: Setting latency timer of device 0000:00:01.0 to 64
wl: srom not detected, using main memory mapped srom info (wombo board)
wl0: wlc_attach: MAC addr from system pool. id:0x776c0000
wl0: MAC Address: A0:21:B7:77:4C:B0
wl0: Broadcom BCM4322 802.11 Wireless Controller 5.10.120.0.cpe4.402.0
dgasp: kerSysRegisterDyingGaspHandler: wl0 registered 
DSP Driver: DSP init stub
Endpoint: endpoint_init entry
BOS: Enter bosInit 
Enter bosAppInit 
Exit bosAppInit 
BOS: Exit bosInit 
Endpoint: endpoint_init COMPLETED
Broadcom Packet Flow Cache learning via BLOG disabled.
Broadcom Packet Flow Cache learning via BLOG disabled.
device eth1 entered promiscuous mode
device eth2 entered promiscuous mode
device eth3 entered promiscuous mode
device eth4 entered promiscuous mode
device wl0 entered promiscuous mode
gpio_drv_ioctl: wps_led_state = 0x1
gpio_drv_ioctl: lan_led_state = 0x1
gpio_drv_ioctl: usb_led_state = 0x0
br0: port 5(wl0) entering learning state
br0: topology change detected, propagating
br0: port 5(wl0) entering forwarding state
log = user [192.168.0.2] try to log in web</code></pre></div><p><strong>Commands in the path</strong><br /></p><div class="codebox"><pre><code># 
\[                  expr                mknod               sip_version 
acos_init           false               mlabel              sleep 
acos_service        fgrep               mmd                 start_wan 
automount           ftpc                mmount              stop_wan 
bcmupnp             ftpget              mmove               swresetd 
bd                  gpio                mount               sysinfo 
bftpd               grep                mount.ntfs-3g       syslogd 
brctl               gunzip              mpartition          tc 
burnboardid         gzip                mrd                 telnetd 
burnethermac        heartbeat           mren                telnetenabled 
burnkey             hotplug             msh                 test 
burnpin             httpd               mshowfat            testMode 
burnrf              httpsd.pem          mtools              tftp 
burnsn              ifcfg               mtoolstest          tftpd 
busybox             ifconfig            mtype               timesync 
ca.pem              igmp                mzip                top 
cat                 init                nas                 true 
cert                insmod              nas4not             tty 
chmod               ip                  nslookup            ubdcmd 
cli                 iptables            ntfs-3g             udhcpd 
cmf                 kill                ntpclient           umount 
cmfctl              killall             nvramUpdate         upnpd 
cp                  klogd               outputimage         uptime 
cwmpCPE             lld2d               param               vconfig 
date                ln                  ping                version 
ddnsd               logger              pot                 voipDiag 
df                  logread             pppd                wandetect 
dhcpc               ls                  ps                  wanled 
dhcpd               lsmod               pwd                 wget 
diagnostic          mattrib             read_bd             wget_d 
dmesg               mbadblocks          reboot              wl 
dnsRedirectReplyd   mcat                reset_no_reboot     wlanconfigd 
dnsmasq             mcd                 ripd                wlctl 
dnsproxy            mclasserase         rm                  wps_ap 
eapd                mcopy               rmmod               wps_enr 
ebtables            mdel                route               wps_monitor 
echo                mdeltree            routef              wpsd 
egrep               mdir                routel              zcat 
email               mdu                 rtmon               zebra 
ensip               mformat             rtpr 
epi_ttcp            minfo               sendarp 
ethctl              mkdir               sh </code></pre></div><p><strong>version</strong><br /></p><div class="codebox"><pre><code># version 
Release version : Netgear Voice Gateway EVG2000
                  U12H154T00/V2.2.0.12/2.2.12
           Time : May 31 2010 10:53:05</code></pre></div><p><strong>lsmod</strong><br /></p><div class="codebox"><pre><code># lsmod
Module                  Size  Used by
ubdPktPrcs 3152 0 - Live 0xc0011000 (P)
acos_nat 331856 0 - Live 0xc00ca000 (P)
endpointdd 1581392 0 - Live 0xc02a2000 (P)
dspdd 868272 1 endpointdd, Live 0x8108c700 (P)
wl 1018080 0 - Live 0xc01a8000 (P)
bcm_enet 28816 0 - Live 0xc0055000 (P)
bcmprocfs 15440 0 - Live 0xc0021000 (P)
pktcmf 101232 1 bcm_enet, Live 0xc003b000 (P)
pktflow 30832 1 pktcmf, Live 0xc0018000 (P)</code></pre></div><p><strong>ifconfig</strong><br /></p><div class="codebox"><pre><code># ifconfig
bcmsw           Link encap:Ethernet  HWaddr A0:21:B7:77:4C:AF  
                UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
                RX packets:137 errors:0 dropped:0 overruns:0 frame:0
                TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
                collisions:0 txqueuelen:1000 
                RX bytes:15118 (14.7 KiB)  TX bytes:0 (0.0 B)
                Interrupt:40 Base address:0x6a00 

br0             Link encap:Ethernet  HWaddr A0:21:B7:77:4C:AF  
                inet addr:192.168.0.1  Bcast:192.168.0.255  Mask:255.255.255.0
                UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
                RX packets:5890 errors:0 dropped:0 overruns:0 frame:0
                TX packets:2245 errors:0 dropped:0 overruns:0 carrier:0
                collisions:0 txqueuelen:0 
                RX bytes:378263 (369.3 KiB)  TX bytes:285204 (278.5 KiB)

eth5            Link encap:Ethernet  HWaddr A0:21:B7:77:4C:AF  
                UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
                RX packets:137 errors:0 dropped:0 overruns:0 frame:0
                TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
                collisions:0 txqueuelen:1000 
                RX bytes:15118 (14.7 KiB)  TX bytes:0 (0.0 B)
                

lo              Link encap:Local Loopback  
                inet addr:127.0.0.1  Mask:255.0.0.0
                UP LOOPBACK RUNNING  MTU:16436  Metric:1
                RX packets:15 errors:0 dropped:0 overruns:0 frame:0
                TX packets:15 errors:0 dropped:0 overruns:0 carrier:0
                collisions:0 txqueuelen:0 
                RX bytes:2430 (2.3 KiB)  TX bytes:2430 (2.3 KiB)

pktcmf_sar_sw   Link encap:UNSPEC  HWaddr FE-FF-FF-FF-FF-FF-FF-FF-00-00-00-00-00-00-00-00  
                UP NOTRAILERS RUNNING NOARP  MTU:0  Metric:1
                RX packets:0 errors:0 dropped:0 overruns:0 frame:0
                TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
                collisions:0 txqueuelen:0 
                RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
                Interrupt:50 Base address:0x5220 

pktcmf_sw_sar   Link encap:UNSPEC  HWaddr FE-FF-FF-FF-FF-FF-FF-FF-00-00-00-00-00-00-00-00  
                UP NOTRAILERS RUNNING NOARP  MTU:0  Metric:1
                RX packets:0 errors:0 dropped:0 overruns:0 frame:0
                TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
                collisions:0 txqueuelen:0 
                RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
                Interrupt:42 Base address:0x6a40 

wl0             Link encap:Ethernet  HWaddr A0:21:B7:77:4C:AF  
                UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
                RX packets:5873 errors:0 dropped:0 overruns:0 frame:2901
                TX packets:2370 errors:0 dropped:0 overruns:0 carrier:0
                collisions:0 txqueuelen:0 
                RX bytes:458946 (448.1 KiB)  TX bytes:324026 (316.4 KiB)
                Interrupt:21</code></pre></div><p><strong>wl</strong><br /></p><div class="codebox"><pre><code># wl cmds
a_rate            cac_delts         nvram_get         scan              
a_mrate           cac_delts_ea      noise             scancache_clear   
ap                cac_tslist        nphy_test_tssi    spect             
atten             cac_tslist_ea     nphy_test_tssi_offs scanresults     
ampdu_activate_test cac_tspec       nphy_rssiant      status            
ampdu_tid         cac_tspec_ea      nvotpw            scansuppress      
ampdu_retry_limit_tid chanim_state  nrate             suprates          
ampdu_rr_retry_limit_tid chanim_mode nphy_antsel      scan_channel_time 
ampdu_send_addba  down              out               scan_unassoc_time 
ampdu_send_delba  dump              otpw              scan_home_time    
ampdu_clear_dump  dfs_channel_forced otpdump          scan_passive_time 
antdiv            dpt_deny          otpstat           scan_nprobes      
addwep            dpt_endpoint      obss_scan_params  ssid              
authorize         dpt_pmk           obss_coex_action  shortslot         
auth              dpt_fname         PM                shortslot_override 
assoc             dpt_list          promisc           shortslot_restrict 
autocountry_default deauthorize     powerindex        scb_timeout       
assoclist         deauthenticate    phyreg            slowtimer         
arpoe             disassoc          pcieserdesreg     sta_info          
arp_ol            dfs_status        plcphdr           staname           
arp_peerage       dtim              phytype           sample_collect    
arp_table_clear   del_ie            primary_key       send_nulldata     
arp_hostip        delta_stats_interval perm_etheraddr srchmem           
arp_hostip_clear  delta_stats       passive           seq_start         
arp_stats         diag              prb_resp_timeout  seq_stop          
arp_stats_clear   eap               phylist           seq_delay         
authe_sta_list    evm               pktcnt            seq_error_index   
autho_sta_list    eventing          protection_control scblist          
assoc_pref        event_msgs        phy_rssi_ant      tssi              
add_ie            eap_restrict      pwr_percent       txpwr             
assoc_info        frag              pmkid_info        txpwr1            
autochannel       fqacurcy          phy_rxiqest       txpathpwr         
abminrate         fasttimer         pkteng_start      txpwrlimit        
ap_isolate        frameburst        pkteng_stop       txant             
apname            freqtrack         pkteng_stats      tsc               
antgain           fem               phytable          tkip_countermeasures 
assoclistinfo     gpioout           pavars            txinstpwr         
assertlog         gmode             povars            toe               
assert_bypass     gmode_protection  pkt_filter_add    toe_ol            
bg_rate           gmode_protection_control pkt_filter_clear_stats toe_stats 
bg_mrate          gmode_protection_override pkt_filter_enable toe_stats_clear 
bssid             glacialtimer      pkt_filter_list   txfifo_sz         
bssmax            HCI_cmd           pkt_filter_mode   txmcsset          
band              infra             pkt_filter_delete up                
bands             iscan_s           pkt_filter_stats  ucflags           
bi                iscan_c           quiet             ucantdiv          
bcmerrorstr       iscanresults      restart           upgrade           
bss               ignore_bcns       reboot            ver               
btc_params        isup              radio             wrvar             
btc_flags         interference      rdvar             wake              
bmac_reboot       interference_override revinfo       wepstatus         
cmds              join              rts               wsec_test         
clk               join_pref         rate              wsec_restrict     
ciswrite          keys              radioreg          wsec              
cisdump           keep_alive        rateparam         wpa_auth          
cis_source        lrl               rmwep             wpa_cap           
cisconvert        lazywds           regulatory        wds               
customvar1        longtrain         rateset           wet               
cwmin             legacy_erp        roam_trigger      wds_remote_mac    
cwmax             lifetime          roam_delta        wds_wpa_role_old  
channel           list_ie           roam_scan_period  wds_wpa_role      
cur_mcsset        lpphy_papdepstbl  rssi              wme               
chanspecs         lpphy_txiqcc      radar             wme_ac            
chanspec          lpphy_txlocc      radarargs         wme_apsd          
cur_etheraddr     led               radarargs40       wme_apsd_sta      
chanlist          ledbh             radarthrs         wme_dp            
channels          led_blink_sync    rm_req            wme_counters      
channels_in_country msglevel        rm_rep            wme_clear_counters 
curpower          monitor           reinit            wme_tx_params     
channel_qa        mrate             rand              wme_maxbw_params  
channel_qa_start  macreg            reset_d11cnts     wowl              
country           mac               rifs              wowl_bcn_loss     
crsuprs           macmode           rifs_advert       wowl_pattern      
csa               measure_req       reassoc           wowl_wakeind      
constraint        malloc_dump       rxmcsset          wowl_status       
cap               mimo_txbw         srclear           wowl_pkt          
chan_info         maxpower          srdump            wme_apsd_trigger  
counters          mimo_ss_stf       srwrite           wme_autotrigger   
csscantimer       nvram_source      srcrc             
closed            nvram_dump        srl               
closednet         nvset             shmem             
cac_addts         nvget             set_pmk </code></pre></div><br /><p>Update: I have a new factory firmware build now, from a different telco, I&#039;m using the OPTUS build v3.3.0.58. This version has not been messed with as much as the TELE2 build, and is pretty standard NetGear except for minor things like region set as Austrailia. I added telnetd on port 8022, now if there is only something to be found that gives more clue to the switch detection? One thing that I see is an 2nd tty port that is not detected/configured in the OpenWRT build, any significance? You can clearly see the 53115 being detected in these logs.</p><div class="codebox"><pre><code># dmesg
2 pages used for memmap
  DMA zone: 0 pages reserved
  DMA zone: 4064 pages, LIFO batch:0
  Normal zone: 94 pages used for memmap
  Normal zone: 11938 pages, LIFO batch:1
Built 1 zonelists.  Total pages: 16002
Kernel command line: root=31:0 ro noinitrd console=ttyS0,115200
brcm mips: enabling icache and dcache...
Primary instruction cache 64kB, physically tagged, 4-way, linesize 16 bytes.
Primary data cache 32kB, 2-way, linesize 16 bytes.
Synthesized TLB refill handler (21 instructions).
Synthesized TLB load handler fastpath (33 instructions).
Synthesized TLB store handler fastpath (33 instructions).
Synthesized TLB modify handler fastpath (32 instructions).
PID hash table entries: 256 (order: 8, 1024 bytes)
Using 200.000 MHz high precision timer.
Dentry cache hash table entries: 8192 (order: 3, 32768 bytes)
Inode-cache hash table entries: 4096 (order: 2, 16384 bytes)
Allocating memory for DSP module core and initialization code
Allocated DSP module memory - CORE=0x8108c700 SIZE=951472, INIT=0x0 SIZE=0
Memory: 60172k/64512k available (2109k kernel code, 4324k reserved, 446k data, 92k init, 0k highmem)
KLOB Pool 1 Initialized: 1048576 bytes &lt;0x80300000 ... 0x80400000&gt;
Calibrating delay loop... 398.33 BogoMIPS (lpj=199168)
Mount-cache hash table entries: 512
NET: Registered protocol family 16
Total Flash size: 16384K with 128 sectors
File system address: 0xb8020100
registering PCI controller with io_map_base unset
SCSI subsystem initialized
usbcore: registered new interface driver usbfs
usbcore: registered new interface driver hub
usbcore: registered new device driver usb
BLOG v1.0 Initialized
Time: MIPS clocksource has been installed.
NET: Registered protocol family 2
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 2048 (order: 2, 16384 bytes)
TCP bind hash table entries: 2048 (order: 1, 8192 bytes)
TCP: Hash tables configured (established 2048 bind 2048)
TCP reno registered
squashfs: version 3.2-r2 (2007/01/15) Phillip Lougher
squashfs: LZMA suppport for slax.org by jro
fuse init (API version 7.8)
io scheduler noop registered (default)
PPP generic driver version 2.4.2
NET: Registered protocol family 24
physmap platform flash device: 01000000 at b8000000
physmap-flash.0: Found 1 x16 devices at 0x0 in 16-bit bank
 Amd/Fujitsu Extended Query Table at 0x0040
physmap-flash.0: CFI does not contain boot bank location. Assuming top.
number of CFI chips: 1
cfi_cmdset_0002: Disabling erase-suspend-program due to code brokenness.
cmdlinepart partition parsing not available
RedBoot partition parsing not available
Using physmap partition information
Creating 8 MTD partitions on &quot;physmap-flash.0&quot;:
0x00020100-0x00f60000 : &quot;rootfs&quot;
mtd: partition &quot;rootfs&quot; doesn&#039;t start on an erase block boundary -- force read-only
0x00020000-0x00f60000 : &quot;fw_upgrade&quot;
0x00f60000-0x00f80000 : &quot;T_Meter1&quot;
0x00f80000-0x00fa0000 : &quot;T_Meter2&quot;
0x00fa0000-0x00fc0000 : &quot;POT&quot;
0x00fc0000-0x00fe0000 : &quot;board_data&quot;
0x00fe0000-0x01000000 : &quot;nvram&quot;
0x00000000-0x01000000 : &quot;whole_flash&quot;
PCI: Enabling device 0000:00:0a.0 (0000 -&gt; 0002)
PCI: Setting latency timer of device 0000:00:0a.0 to 64
ehci_hcd 0000:00:0a.0: EHCI Host Controller
ehci_hcd 0000:00:0a.0: new USB bus registered, assigned bus number 1
ehci_hcd 0000:00:0a.0: irq 15, io mem 0x10001500
ehci_hcd 0000:00:0a.0: USB f.f started, EHCI 1.00, driver 10 Dec 2004
usb usb1: configuration #1 chosen from 1 choice
hub 1-0:1.0: USB hub found
hub 1-0:1.0: 2 ports detected
ohci_hcd: 2006 August 04 USB 1.1 &#039;Open&#039; Host Controller (OHCI) Driver
PCI: Enabling device 0000:00:09.0 (0000 -&gt; 0002)
PCI: Setting latency timer of device 0000:00:09.0 to 64
ohci_hcd 0000:00:09.0: OHCI Host Controller
ohci_hcd 0000:00:09.0: new USB bus registered, assigned bus number 2
ohci_hcd 0000:00:09.0: irq 13, io mem 0x10001600
usb usb2: configuration #1 chosen from 1 choice
hub 2-0:1.0: USB hub found
hub 2-0:1.0: 2 ports detected
usbcore: registered new interface driver usblp
drivers/usb/class/usblp.c: v0.13: USB Printer Device Class driver
Initializing USB Mass Storage driver...
usbcore: registered new interface driver usb-storage
USB Mass Storage support registered.
brcmboard: brcm_board_init entry

===&gt;brcm_board_init: GPIO-&gt;GPIOBaseMode=0x32b01

===&gt;brcm_board_init: GPIO-&gt;GPIOMode=0x1f0000
Serial: BCM63XX driver $Revision: 3.00 $
ttyS0 at MMIO 0xb0000100 (irq = 10) is a BCM63XX
ttyS1 at MMIO 0xb0000120 (irq = 11) is a BCM63XX
netem: version 1.2
u32 classifier
Netfilter messages via NETLINK v0.30.
nf_conntrack version 0.5.0 (504 buckets, 4032 max)
TCP cubic registered
NET: Registered protocol family 1
NET: Registered protocol family 17
NET: Registered protocol family 15
802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;
All bugs added by David S. Miller &lt;davem@redhat.com&gt;
VFS: Mounted root (squashfs filesystem) readonly.
Freeing unused kernel memory: 92k freed
pktflow: module license &#039;Proprietary&#039; taints kernel.
Broadcom Packet Flow Cache learning via BLOG enabled.
Created Proc FS /procfs/fcache
Constructed Broadcom Packet Flow Cache v0.1 Apr  6 2010 12:31:42
Broadcom Packet CMF (Experimental) Char Driver v0.1 Apr  6 2010 12:31:41 Registered&lt;232&gt;
Broadcom Packet CMF (Experimental) [6369-B2] v0.1 Apr  6 2010 12:31:41 Loaded
Broadcom BCMPROCFS v1.0 initialized
Broadcom BCM6369B2 Ethernet Network Device v0.1 Sep 25 2012 17:25:27
ethsw: found bcm53115!
ethsw_mdio_wreg: timeout!
dgasp: kerSysRegisterDyingGaspHandler: bcmsw registered 
Broadcom Packet CMF (Experimental) SWC RESET.
Broadcom Packet CMF (Experimental) SWC INITIALIZED.
KLOB extended to 2 pools
KLOB extended to 3 pools
KLOB extended to 4 pools
KLOB extended to 5 pools
KLOB extended to 6 pools
KLOB extended to 7 pools
KLOB extended to 8 pools
Broadcom Packet CMF (Experimental) Forwarder Net Device 0 v0.1 Apr  6 2010 12:31:42 Registered
Broadcom Packet CMF (Experimental) Forwarder Net Device 1 v0.1 Apr  6 2010 12:31:42 Registered
Broadcom Packet CMF (Experimental) ENABLED.
eth0: MAC Address: A0:21:B7:77:4C:AF
eth1: MAC Address: A0:21:B7:77:4C:AF
eth2: MAC Address: A0:21:B7:77:4C:AF
eth3: MAC Address: A0:21:B7:77:4C:AF
eth4: MAC Address: A0:21:B7:77:4C:AF
eth5: MAC Address: A0:21:B7:77:4C:AF
eth0 Link DOWN.
eth1 Link DOWN.
eth2 Link DOWN.
eth3 Link DOWN.
eth4 Link DOWN.
PCI: Enabling device 0000:00:01.0 (0000 -&gt; 0002)
PCI: Setting latency timer of device 0000:00:01.0 to 64
wl: srom not detected, using main memory mapped srom info (wombo board)
wl0: wlc_attach: MAC addr from system pool. id:0x776c0000
wl0: MAC Address: A0:21:B7:77:4C:B0
wl0: Broadcom BCM4322 802.11 Wireless Controller 5.10.120.0.cpe4.402.0
dgasp: kerSysRegisterDyingGaspHandler: wl0 registered 
DSP Driver: DSP init stub
Endpoint: endpoint_init entry
BOS: Enter bosInit 
Enter bosAppInit 
Exit bosAppInit 
BOS: Exit bosInit 
Endpoint: endpoint_init COMPLETED
eth4 Link UP 100 mbps full duplex 
Set eth0 wan port 1Set eth0 wan port 1&lt;2&gt;eth4 Link DOWN.
eth4 Link UP 100 mbps full duplex 
Broadcom Packet Flow Cache learning via BLOG disabled.
Broadcom Packet Flow Cache learning via BLOG disabled.
device eth1 entered promiscuous mode
device eth2 entered promiscuous mode
device eth3 entered promiscuous mode
device eth4 entered promiscuous mode
device wl0 entered promiscuous mode
br0: port 4(eth4) entering learning state
br0: topology change detected, propagating
br0: port 4(eth4) entering forwarding state
gpio_drv_ioctl: wps_led_state = 0x1
gpio_drv_ioctl: lan_led_state = 0x1
gpio_drv_ioctl: usb_led_state = 0x0
br0: port 5(wl0) entering learning state
br0: topology change detected, propagating
br0: port 5(wl0) entering forwarding state
log = user [192.168.0.254] try to log in web</code></pre></div>											<p class="post-edited">(Last edited by <strong>Xotic750</strong> on 3 May 2016, 02:19)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p322377">
				<div class="post-metadata">
					<div class="post-num">Post #78</div>
					<div class="post-author">Xotic750</div>
					<div class="post-datetime">
						3 May 2016, 15:45					</div>
				</div>
				<div class="post-content content">
					<p>In the factory firmware <em>dmesg</em> it shows a second uart, so I decided to enable it just for the hell of it. Added <span class="bbu">.has_uart1 = 1</span> to the config and it was detected fine, <a href="https://wiki.openwrt.org/_media/media/netgear/evg2000/evg2000_pcb_top.png">it looks like there is a 2nd set of connections on the board</a>. Otherwise, not much use.</p><div class="codebox"><pre><code>[    0.428073] bcm63xx_uart.0: ttyS0 at MMIO 0xb0000100 (irq = 10, base_baud = 1562500) is a bcm63xx_uart
[    0.437690] console [ttyS0] enabled
[    0.444820] bootconsole [early0] disabled
[    0.453481] bcm63xx_uart.1: ttyS1 at MMIO 0xb0000120 (irq = 11, base_baud = 1562500) is a bcm63xx_uart</code></pre></div><p>I also tried the <a href="https://wiki.openwrt.org/doc/hardware/soc/soc.broadcom.bcm47xx#broadcom-wl">kmod_brcm_wl</a> driver again, this time I extracted the <em>.bin</em> and <em>nvram</em> files from the factory source and <a href="https://wiki.openwrt.org/doc/howto/build#custom_files">added them into the build,</a> <span class="bbu">/etc/wlan</span> as this seem to be where they go from reading about the <span class="bbu">broadcom_wl</span> driver. Still fails.</p><div class="codebox"><pre><code>[   10.694281] wl: module license &#039;unspecified&#039; taints kernel.
[   10.699995] Disabling lock debugging due to kernel taint
[   10.767444] SSB/BCMA glue driver successfully attached
[   10.788007] wl0: 5.10.56.27 driver failed with code 11
[   10.793396] Memory leak of bytes 36</code></pre></div><p>It should support this device from the documents, but still can&#039;t figure out what I&#039;m doing wrong. Running 4.1.20 kernel</p><div class="quotebox"><blockquote><p>1. They do a quick check to see if an SPROM exists. Starting at the ssb address<br />+ 4 * 1024, a total of 12 words (16 bit) are read. If any of them are not 0 and<br />not 0xFFFF, then a flag for the presence of an SPROM is set. These reads are<br />done using a routine named bcmjtag_read(). I have not found it yet.</p><p>2. If the flag above is not set, then they read the SPROM data from a file that<br />named /etc/wlan/bcmXXXX.bin, where XXXX is the chipid.</p></blockquote></div><p><a href="http://comments.gmane.org/gmane.linux.drivers.bcm54xx.devel/9804">http://comments.gmane.org/gmane.linux.d … devel/9804</a></p><p>Installed packages<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# opkg list-installed
base-files - 168-r49293
block-mount - 2016-04-25-89847de58a17dacedab36ef07ec4c12ef8c0e84a
busybox - 1.24.2-1
dnsmasq - 2.75-7
dropbear - 2015.71-3
e2fsprogs - 1.42.12-1
fdisk - 2.28-1
firewall - 2016-01-29
fstools - 2016-04-25-89847de58a17dacedab36ef07ec4c12ef8c0e84a
hd-idle - 1.04-1
hostapd-common - 2016-01-15-2
ip6tables - 1.4.21-2
iptables - 1.4.21-2
iwinfo - 2016-01-25-e4aca3910dff532ed878d0ceaf1ab6e8ad7719bf
jshn - 2016-02-26-5326ce1046425154ab715387949728cfb09f4083
jsonfilter - 2014-06-19-cdc760c58077f44fc40adbbe41e1556a67c1b9a9
kernel - 4.1.20-1-7260f9f004fbc2ae1292c70d1694f474
kmod-brcm-wl - 4.1.20+5.10.56.27.3-8
kmod-crypto-hash - 4.1.20-1
kmod-fs-ext4 - 4.1.20-1
kmod-gpio-button-hotplug - 4.1.20-2
kmod-ip6tables - 4.1.20-1
kmod-ipt-conntrack - 4.1.20-1
kmod-ipt-core - 4.1.20-1
kmod-ipt-nat - 4.1.20-1
kmod-ledtrig-usbdev - 4.1.20-1
kmod-lib-crc-ccitt - 4.1.20-1
kmod-lib-crc16 - 4.1.20-1
kmod-nf-conntrack - 4.1.20-1
kmod-nf-conntrack6 - 4.1.20-1
kmod-nf-ipt - 4.1.20-1
kmod-nf-ipt6 - 4.1.20-1
kmod-nf-nat - 4.1.20-1
kmod-nls-base - 4.1.20-1
kmod-ppp - 4.1.20-1
kmod-pppoe - 4.1.20-1
kmod-pppox - 4.1.20-1
kmod-scsi-core - 4.1.20-1
kmod-slhc - 4.1.20-1
kmod-usb-core - 4.1.20-1
kmod-usb-ohci - 4.1.20-1
kmod-usb-storage - 4.1.20-1
kmod-usb-storage-extras - 4.1.20-1
kmod-usb2 - 4.1.20-1
libblkid - 2.28-1
libblobmsg-json - 2016-02-26-5326ce1046425154ab715387949728cfb09f4083
libbz2 - 1.0.6-2
libc - 1.1.14-1
libexif - 0.6.21-1
libext2fs - 1.42.12-1
libfdisk - 2.28-1
libffmpeg-mini - 2.7.6-1
libflac - 1.3.1-3
libgcc - 5.3.0-1
libid3tag - 0.15.1b-4
libip4tc - 1.4.21-2
libip6tc - 1.4.21-2
libiwinfo - 2016-01-25-e4aca3910dff532ed878d0ceaf1ab6e8ad7719bf
libiwinfo-lua - 2016-01-25-e4aca3910dff532ed878d0ceaf1ab6e8ad7719bf
libjpeg - 9a-1
libjson-c - 0.12-1
libjson-script - 2016-02-26-5326ce1046425154ab715387949728cfb09f4083
libkmod - 20-1
liblua - 5.1.5-1
libncurses - 5.9-3
libnl-tiny - 0.1-5
libogg - 1.3.2-2
libpthread - 1.1.14-1
librt - 1.1.14-1
libsmartcols - 2.28-1
libsqlite3 - 3120200-1
libubox - 2016-02-26-5326ce1046425154ab715387949728cfb09f4083
libubus - 2016-01-26-619f3a160de4f417226b69039538882787b3811c
libubus-lua - 2016-01-26-619f3a160de4f417226b69039538882787b3811c
libuci - 2016-02-02.1-1
libuci-lua - 2016-02-02.1-1
libuclient - 2016-01-28-2e0918c7e0612449024caaaa8d44fb2d7a33f5f3
libusb-1.0 - 1.0.20-1
libuuid - 2.28-1
libvorbis - 1.3.5-1
libxtables - 1.4.21-2
logd - 2016-03-07-fd4bb41ee7ab136d25609c2a917beea5d52b723b
lua - 5.1.5-1
luci - git-16.123.28887-219e52e-1
luci-app-firewall - git-16.123.28887-219e52e-1
luci-app-hd-idle - git-16.123.28887-219e52e-1
luci-app-minidlna - git-16.123.28887-219e52e-1
luci-app-samba - git-16.123.28887-219e52e-1
luci-base - git-16.123.28887-219e52e-1
luci-lib-ip - git-16.123.28887-219e52e-1
luci-lib-jsonc - git-16.123.28887-219e52e-1
luci-lib-nixio - git-16.123.28887-219e52e-1
luci-mod-admin-full - git-16.123.28887-219e52e-1
luci-proto-ipv6 - git-16.123.28887-219e52e-1
luci-proto-ppp - git-16.123.28887-219e52e-1
luci-theme-bootstrap - git-16.123.28887-219e52e-1
minidlna - 1.1.5-1
mtd - 21
nas - 5.10.56.27.3-8
netifd - 2016-03-04-da687c2689f7ff2af1dccc9a428806dd15c3d554
odhcp6c - 2015-09-04-dc186d6d2b0dd4ad23ca5fc69c00e81f796ff6d9
odhcpd - 2015-11-19-01d3f9d64486ac1daa144848944e877e7f0cb762
opkg - 9c97d5ecd795709c8584e972bfdf3aee3a5b846d-12
pciutils - 3.4.1-3
ppp - 2.4.7-9
ppp-mod-pppoe - 2.4.7-9
procd - 2016-03-09-b12bb150ed38a4409bef5127c77b060ee616b860
rpcd - 2016-04-13-73aea9b8b621a1ce034bc6ee00c9d058a40c8a3d
samba36-server - 3.6.25-5
screen - 4.3.1-1
swconfig - 10
terminfo - 5.9-3
ubox - 2016-03-07-fd4bb41ee7ab136d25609c2a917beea5d52b723b
ubus - 2016-01-26-619f3a160de4f417226b69039538882787b3811c
ubusd - 2016-01-26-619f3a160de4f417226b69039538882787b3811c
uci - 2016-02-02.1-1
uclient-fetch - 2016-01-28-2e0918c7e0612449024caaaa8d44fb2d7a33f5f3
uhttpd - 2015-11-08-fe01ef3f52adae9da38ef47926cd50974af5d6b7
uhttpd-mod-ubus - 2015-11-08-fe01ef3f52adae9da38ef47926cd50974af5d6b7
usbutils - 007-3
usign - 2015-05-08-cf8dcdb8a4e874c77f3e9a8e9b643e8c17b19131
wireless-tools - 29-5
wlc - 5.10.56.27.3-8
wpad-mini - 2016-01-15-2
zlib - 1.2.8-1</code></pre></div><p>The .bin and nvram are in place<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# ls -l /etc/wlan/
-rwxrwxr-x    1 root     root           128 May  3 09:59 bcm4318_map.bin
-rwxrwxr-x    1 root     root           448 May  3 09:59 bcm4321_map.bin
-rwxrwxr-x    1 root     root           448 May  3 09:59 bcm43222_map.bin
-rwxrwxr-x    1 root     root           448 May  3 09:59 bcm4322_map.bin
-rwxrwxr-x    1 root     root            89 May  3 09:59 nvram_params
root@OpenWrt:~# cat /etc/wlan/nvram_params 
ID=pci/0/1/
#pa0b0
47=15a9
#pa0b1
48=fab2
#pa0b2
49=fe99

ID=pci/0/2/
#pa0maxpwr
52=384c</code></pre></div><p>An lsmod to check what is loaded<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# lsmod
crc16                   1015  1 ext4
crc_ccitt               1019  1 ppp_async
crypto_hash             9474  2 ext4
ehci_hcd               40492  1 ehci_platform
ehci_platform           3872  0 
ext4                  350783  0 
gpio_button_hotplug     6032  0 
ip6_tables              9921  3 ip6table_raw
ip6t_REJECT             1008  2 
ip6table_filter          624  1 
ip6table_mangle         1120  0 
ip6table_raw             592  0 
ip_tables              10109  4 iptable_nat
ipt_MASQUERADE           672  1 
ipt_REJECT               912  2 
iptable_filter           688  1 
iptable_mangle           928  0 
iptable_nat              752  1 
iptable_raw              656  0 
jbd2                   54434  1 ext4
ledtrig_usbdev          2128  0 
mbcache                 7229  1 ext4
nf_conntrack           53841  9 nf_nat_ipv4
nf_conntrack_ipv4       4736 11 
nf_conntrack_ipv6       5104  6 
nf_conntrack_rtcache    2432  0 
nf_defrag_ipv4           806  1 nf_conntrack_ipv4
nf_defrag_ipv6         13207  1 nf_conntrack_ipv6
nf_log_common           2399  2 nf_log_ipv4
nf_log_ipv4             3200  0 
nf_log_ipv6             3360  0 
nf_nat                  9387  4 nf_nat_ipv4
nf_nat_ipv4             3601  1 iptable_nat
nf_nat_masquerade_ipv4    1388  1 ipt_MASQUERADE
nf_nat_redirect          971  1 xt_REDIRECT
nf_reject_ipv4          2051  1 ipt_REJECT
nf_reject_ipv6          2440  1 ip6t_REJECT
nls_base                5296  1 usbcore
ohci_hcd               30031  1 ohci_platform
ohci_platform           3296  0 
ppp_async               6656  0 
ppp_generic            20530  3 pppoe
pppoe                   8144  0 
pppox                   1338  1 pppoe
scsi_mod               87550  3 ums_cypress
sd_mod                 23696  0 
slhc                    4299  1 ppp_generic
ums_alauda              8384  0 
ums_cypress             2288  0 
ums_datafab             4480  0 
ums_freecom             2016  0 
ums_isd200              5136  0 
ums_jumpshot            3552  0 
ums_karma               1520  0 
ums_sddr09              8784  0 
ums_sddr55              4768  0 
ums_usbat               7136  0 
usb_common              1756  1 usbcore
usb_storage            38799 10 ums_usbat
usbcore               122652 16 ums_usbat
wl                   1509584  0 
wl_glue                 2383  1 wl
x_tables               11301 26 ipt_REJECT
xt_CT                   2512  0 
xt_LOG                   768  0 
xt_REDIRECT              672  0 
xt_TCPMSS               2640  0 
xt_comment               496 60 
xt_conntrack            2208 16 
xt_id                    496113 
xt_limit                1056 20 
xt_mac                   624  0 
xt_mark                  672  0 
xt_multiport            1136  0 
xt_nat                  1152  0 
xt_state                 704  0 
xt_tcpudp               1728  8 
xt_time                 1632  0</code></pre></div><p>Additional notes: I have also tested flashing the unit from the factory firmware GUI upgrade page using the OpenWRT <em>factory.chk</em> that is generated by the build, and it successfully flashes the unit.</p><p>Other things still to be tested: the <em>reset</em> and <em>WPS</em> buttons.</p><p>Future: the unit has 2 POT sockets and supports VOIP, not even on the radar just now and no idea what the state of it is in OWRT.</p><p>Update: I also tried removing all the fallback configuration in case that was the issue, but no change.</p><p>(Possibly related: <a href="https://dev.openwrt.org/ticket/10917#no1)">https://dev.openwrt.org/ticket/10917#no1)</a></p>											<p class="post-edited">(Last edited by <strong>Xotic750</strong> on 6 May 2016, 15:49)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p322694">
				<div class="post-metadata">
					<div class="post-num">Post #79</div>
					<div class="post-author">Xotic750</div>
					<div class="post-datetime">
						5 May 2016, 23:53					</div>
				</div>
				<div class="post-content content">
					<p>Could the following be a lead to why the switch is not found?</p><div class="codebox"><pre><code>[    0.165558] registering PCI controller with io_map_base unset
[    0.196241] PCI host bridge to bus 0000:00
[    0.200483] pci_bus 0000:00: root bus resource [mem 0x30000000-0x37ffffff]
[    0.207685] pci_bus 0000:00: root bus resource [io  0x8000000-0x800ffff]
[    0.214551] pci_bus 0000:00: root bus resource [??? 0x00000000 flags 0x0]
[    0.221536] pci_bus 0000:00: No busn resource found for root bus, will use [bus 00-ff]
[    0.229740] pci 0000:00:01.0: [14e4:4322] type 00 class 0x028000
[    0.230803] pci 0000:00:01.0: reg 0x10: [mem 0x00000000-0x00003fff]
[    0.237449] pci_bus 0000:00: busn_res: [bus 00-ff] end is updated to 00
[    0.237524] pci 0000:00:01.0: BAR 0: assigned [mem 0x30000000-0x30003fff]
[    0.247361] Switched to clocksource MIPS
[    0.253867] PCI: Enabling device 0000:00:01.0 (0000 -&gt; 0002)</code></pre></div><p>I read some other posts (mails) where similar logs were provided and they were either unable to find ethernet or switch on PCI(e), architectures were not related to this unit (Xilinx and arm I believe it was).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p323107">
				<div class="post-metadata">
					<div class="post-num">Post #80</div>
					<div class="post-author">Xotic750</div>
					<div class="post-datetime">
						9 May 2016, 14:48					</div>
				</div>
				<div class="post-content content">
					<p>I bumped the kernel to v4.4.9, it compiled and is running fine, it hasn&#039;t helped with detecting the switch though (but I&#039;m out of knowledge and ideas).</p><p><span class="postimg"><img src="http://s32.postimg.org/6ucw3u6kl/Screenshot_from_2016_05_09_13_48_44.png" alt="http://s32.postimg.org/6ucw3u6kl/Screenshot_from_2016_05_09_13_48_44.png" /></span></p>											<p class="post-edited">(Last edited by <strong>Xotic750</strong> on 9 May 2016, 14:49)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p323109">
				<div class="post-metadata">
					<div class="post-num">Post #81</div>
					<div class="post-author">danitool</div>
					<div class="post-datetime">
						9 May 2016, 14:59					</div>
				</div>
				<div class="post-content content">
					<p>For solving the switch issue you should review the bcm63xx_enet driver and figure out how it is glued to the b53 switch driver, and then make proper changes to make it work with MDIO. </p><p>Since MDIO works quite fine with old boards (bcm6358 and older) it may give you some clues about how to solve the problem. That was the reason of attempting to define .has_enet0/1, because this what old boards use, and I think they detect the switch through this parameter.</p><p>BTW I don&#039;t know if any low level code is missing for making MDIO work in bcm6368. AFAICS, probably not.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p323110">
				<div class="post-metadata">
					<div class="post-num">Post #82</div>
					<div class="post-author">Xotic750</div>
					<div class="post-datetime">
						9 May 2016, 15:05					</div>
				</div>
				<div class="post-content content">
					<p>Thanks, I had another play with <em>.has_enet0/1</em> and didn&#039;t have any further success, just a locked up device with the red power light. I&#039;ve been looking at <em>bcm63xx_enet</em> among others, but my understanding is so low that the code is mind-boggling, I will continue to digest. And still no serial cable delivered, which is frustrating to say the least. The unit is working as a nice DLNA server for the kids though, so they are happy. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>											<p class="post-edited">(Last edited by <strong>Xotic750</strong> on 9 May 2016, 15:06)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p323169">
				<div class="post-metadata">
					<div class="post-num">Post #83</div>
					<div class="post-author">Xotic750</div>
					<div class="post-datetime">
						10 May 2016, 01:46					</div>
				</div>
				<div class="post-content content">
					<p>I was just thinking that I would take a look at the <em>reset</em> and <em>WPS</em> button to see if they work/do anything by default. I was looking through the logs and I saw the following.<br /></p><div class="codebox"><pre><code>[    4.500602] gpio-keys-polled gpio-keys-polled: unable to claim gpio 500, err=-16
[    4.508355] gpio-keys-polled: probe of gpio-keys-polled failed with error -16</code></pre></div><p>Configuration problem? Code problem?</p><p>I haven&#039;t actually tested the buttons yet to see if anything happens, and a search hasn&#039;t revealed an exact match of the log extracts above.</p><p>Some references to wiring up the buttons: <br /><a href="https://wiki.openwrt.org/doc/hardware/soc/soc.broadcom.bcm63xx#gpios">https://wiki.openwrt.org/doc/hardware/s … 63xx#gpios</a><br /><a href="https://wiki.openwrt.org/doc/howto/hardware.button">https://wiki.openwrt.org/doc/howto/hardware.button</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p323217">
				<div class="post-metadata">
					<div class="post-num">Post #84</div>
					<div class="post-author">Xotic750</div>
					<div class="post-datetime">
						10 May 2016, 14:33					</div>
				</div>
				<div class="post-content content">
					<p>Nearly 4 weeks, but my serial cable has finally arrived from Malaysia. I only ordered a single strip of header pins, but they&#039;ve sent me a bag full. Well, plenty of spares. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Now to fire up the soldering iron, going to practice on another old and bricked router first. But at last may be able to find out what is going on when setting <em>.has_enet</em></p><p><span class="postimg"><img src="http://s32.postimg.org/n7fzfpe51/IMG_20160510_132834.jpg" alt="http://s32.postimg.org/n7fzfpe51/IMG_20160510_132834.jpg" /></span></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p323235">
				<div class="post-metadata">
					<div class="post-num">Post #85</div>
					<div class="post-author">Xotic750</div>
					<div class="post-datetime">
						10 May 2016, 17:30					</div>
				</div>
				<div class="post-content content">
					<p>Well, I&#039;m not going to be making a living from soldering in header pins, that&#039;s for sure. The TX and RX pins went through no problem, but I can not get a pin through the GND. So, it&#039;s just tagged onto the board the best that I can do it. However,</p><div class="codebox"><pre><code>EVG2000 Boot Code V1.0.6
CFE version 1.0.37-102.6 for BCM96368 (32bit,SP,BE)
Build Date: Fri Sep 25 11:21:49 CST 2009 (eric@dev3)
Copyright (C) 2000-2008 Broadcom Corporation.

Parallel flash device: name AM29LV320MT, id 0x2201, size 16384KB
CPU type 0x2A031: 400MHz, Bus: 160MHz, Ref: 64MHz
CPU running TP0
Total memory: 67108864 bytes (64MB)
Boot Address 0xb8000000


Board IP address                  : 192.168.1.1:ffffff00  
Host IP address                   : 192.168.1.10  
Gateway IP address                :   
Run from flash/host (f/h)         : f  
Default host run file name        : vmlinux  
Default host flash file name      : bcm963xx_fs_kernel  
Boot delay (0-9 seconds)          : 1  
Board Id (0-4)                    : 96369PVG  
Number of MAC Addresses (1-32)    : 11  
Base MAC Address                  : a0:21:b7:77:4c:af  
PSI Size (1-64) KBytes            : 24  
Main Thread Number [0|1]          : 0  
GPON Serial Number                : &quot;BRCM12345678&quot;  
GPON Password                     : &quot;0000000000&quot;  

*** Press any key to stop auto run (1 seconds) ***
Auto run second count down: 1
web info: Waiting for connection on socket 0.
CFE&gt; </code></pre></div><p>so no more shorting TX and RX and I&#039;m in. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Update: a full boot log</p><div class="codebox"><pre><code>EVG2000 Boot Code V1.0.6
CFE version 1.0.37-102.6 for BCM96368 (32bit,SP,BE)
Build Date: Fri Sep 25 11:21:49 CST 2009 (eric@dev3)
Copyright (C) 2000-2008 Broadcom Corporation.

Parallel flash device: name AM29LV320MT, id 0x2201, size 16384KB
CPU type 0x2A031: 400MHz, Bus: 160MHz, Ref: 64MHz
CPU running TP0
Total memory: 67108864 bytes (64MB)
Boot Address 0xb8000000


Board IP address                  : 192.168.1.1:ffffff00  
Host IP address                   : 192.168.1.10  
Gateway IP address                :   
Run from flash/host (f/h)         : f  
Default host run file name        : vmlinux  
Default host flash file name      : bcm963xx_fs_kernel  
Boot delay (0-9 seconds)          : 1  
Board Id (0-4)                    : 96369PVG  
Number of MAC Addresses (1-32)    : 11  
Base MAC Address                  : a0:21:b7:77:4c:af  
PSI Size (1-64) KBytes            : 24  
Main Thread Number [0|1]          : 0  
GPON Serial Number                : &quot;BRCM12345678&quot;  
GPON Password                     : &quot;0000000000&quot;  

*** Press any key to stop auto run (1 seconds) ***
Auto run second count down: 0
Booting from only image (0xb8020000) ...
Code Address: 0x80A00000, Entry Address: 0x80a00000
LZMA: Prossible old LZMA format, trying to decompress..
Decompression OK!
Entry at 0x80a00000
Closing network.
Disabling Switch ports.
Flushing Receive Buffers...
0 buffers found.
Closing DMA Channels.
Starting program at 0x80a00000
[    0.000000] Linux version 4.4.9 (graham@tyr) (gcc version 5.3.0 (OpenWrt GCC 5.3.0 r49293) ) #2 SMP Tue May 10 11:40:02 UTC 2016
[    0.000000] Detected Broadcom 0x6369 CPU revision b2
[    0.000000] CPU frequency is 400 MHz
[    0.000000] 64MB of RAM installed
[    0.000000] board_bcm963xx: Boot address 0xb8000000
[    0.000000] board_bcm963xx: CFE version: 1.0.37-102.6
[    0.000000] bootconsole [early0] enabled
[    0.000000] CPU0 revision is: 0002a031 (Broadcom BMIPS4350)
[    0.000000] board: board name: 96369PVG
[    0.000000] MIPS: machine is Netgear EVG2000
[    0.000000] Determined physical RAM map:
[    0.000000]  memory: 04000000 @ 00000000 (usable)
[    0.000000] Initrd not found or empty - disabling initrd
[    0.000000] Zone ranges:
[    0.000000]   Normal   [mem 0x0000000000000000-0x0000000003ffffff]
[    0.000000] Movable zone start for each node
[    0.000000] Early memory node ranges
[    0.000000]   node   0: [mem 0x0000000000000000-0x0000000003ffffff]
[    0.000000] Initmem setup node 0 [mem 0x0000000000000000-0x0000000003ffffff]
[    0.000000] Primary instruction cache 64kB, VIPT, 4-way, linesize 16 bytes.
[    0.000000] Primary data cache 32kB, 2-way, VIPT, cache aliases, linesize 16 bytes
[    0.000000] PERCPU: Embedded 9 pages/cpu @81086000 s8016 r8192 d20656 u36864
[    0.000000] Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 16256
[    0.000000] Kernel command line:  root=/dev/mtdblock2 rootfstype=squashfs,jffs2 noinitrd console=ttyS0,115200
[    0.000000] PID hash table entries: 256 (order: -2, 1024 bytes)
[    0.000000] Dentry cache hash table entries: 8192 (order: 3, 32768 bytes)
[    0.000000] Inode-cache hash table entries: 4096 (order: 2, 16384 bytes)
[    0.000000] Memory: 59144K/65536K available (3218K kernel code, 150K rwdata, 760K rodata, 1304K init, 207K bss, 6392K reserved, 0K cma-reserved)
[    0.000000] SLUB: HWalign=16, Order=0-3, MinObjects=0, CPUs=2, Nodes=1
[    0.000000] Hierarchical RCU implementation.
[    0.000000] NR_IRQS:256
[    0.000000] clocksource: MIPS: mask: 0xffffffff max_cycles: 0xffffffff, max_idle_ns: 9556302233 ns
[    0.000014] sched_clock: 32 bits at 200MHz, resolution 5ns, wraps every 10737418237ns
[    0.008112] Calibrating delay loop... 397.82 BogoMIPS (lpj=795648)
[    0.042767] pid_max: default: 32768 minimum: 301
[    0.047765] Mount-cache hash table entries: 1024 (order: 0, 4096 bytes)
[    0.054544] Mountpoint-cache hash table entries: 1024 (order: 0, 4096 bytes)
[    0.067513] SMP: Booting CPU1...
[   16.849566] Primary instruction cache 64kB, VIPT, 4-way, linesize 16 bytes.
[   16.849582] Primary data cache 32kB, 2-way, VIPT, cache aliases, linesize 16 bytes
[   16.849910] CPU1 revision is: 0002a031 (Broadcom BMIPS4350)
[    0.119714] Synchronize counters for CPU 1: done.
[    0.119719] SMP: CPU1 is running
[    0.119917] Brought up 2 CPUs
[    0.128983] clocksource: jiffies: mask: 0xffffffff max_cycles: 0xffffffff, max_idle_ns: 7645041785100000 ns
[    0.131345] NET: Registered protocol family 16
[    0.156559] registering PCI controller with io_map_base unset
[    0.180064] PCI host bridge to bus 0000:00
[    0.184444] pci_bus 0000:00: root bus resource [mem 0x30000000-0x37ffffff]
[    0.191547] pci_bus 0000:00: root bus resource [io  0x8000000-0x800ffff]
[    0.198440] pci_bus 0000:00: root bus resource [??? 0x00000000 flags 0x0]
[    0.205450] pci_bus 0000:00: No busn resource found for root bus, will use [bus 00-ff]
[    0.221455] pci 0000:00:01.0: BAR 0: assigned [mem 0x30000000-0x30003fff]
[    0.231495] clocksource: Switched to clocksource MIPS
[    0.239727] PCI: Enabling device 0000:00:01.0 (0000 -&gt; 0002)
[    0.268546] ssb: Found chip with id 0x4322, rev 0x01 and package 0x09
[    0.322342] ssb: Sonics Silicon Backplane found on PCI device 0000:00:01.0
[    0.330156] NET: Registered protocol family 2
[    0.335979] TCP established hash table entries: 1024 (order: 0, 4096 bytes)
[    0.343200] TCP bind hash table entries: 1024 (order: 1, 8192 bytes)
[    0.349755] TCP: Hash tables configured (established 1024 bind 1024)
[    0.356518] UDP hash table entries: 256 (order: 1, 8192 bytes)
[    0.362553] UDP-Lite hash table entries: 256 (order: 1, 8192 bytes)
[    0.369425] NET: Registered protocol family 1
[    0.376257] futex hash table entries: 512 (order: 1, 8192 bytes)
[    0.401839] squashfs: version 4.0 (2009/01/31) Phillip Lougher
[    0.407927] jffs2: version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006 Red Hat, Inc.
[    0.421705] io scheduler noop registered
[    0.425810] io scheduler deadline registered (default)
�[    0.443015] console [ttyS0] enabled MMIO 0xb0000100 (irq = 10, base_baud = 1562500) is a bcm63xx_uart
[    0.443015] console [ttyS0] enabled
[    0.450151] bootconsole [early0] disabled
[    0.450151] bootconsole [early0] disabled
[    0.459522] bcm63xx-rng bcm63xx-rng: registered RNG driver
[    0.466792] 18000000.nor: Found 1 x16 devices at 0x0 in 16-bit bank. Manufacturer ID 0x0000c2 Chip ID 0x00227e
[    0.477153] Amd/Fujitsu Extended Query Table at 0x0040
[    0.482433]   Amd/Fujitsu Extended Query version 1.3.
[    0.487593] number of CFI chips: 1
[    0.491385] bcm63xxpart: CFE boot tag found with version 6 and board type 96369PVG
[    0.499261] 6 bcm63xxpart partitions found on MTD device 18000000.nor
[    0.505857] Creating 6 MTD partitions on &quot;18000000.nor&quot;:
[    0.511321] 0x000000000000-0x000000020000 : &quot;CFE&quot;
[    0.518687] 0x000000020100-0x0000001715bc : &quot;kernel&quot;
[    0.526248] 0x0000001715bc-0x000000f60000 : &quot;rootfs&quot;
[    0.533890] mtd: device 2 (rootfs) set to be root filesystem
[    0.539786] 1 squashfs-split partitions found on MTD device rootfs
[    0.546154] 0x0000009a0000-0x000000f60000 : &quot;rootfs_data&quot;
[    0.554026] 0x000000020000-0x000000f60000 : &quot;linux&quot;
[    0.561845] 0x000000f60000-0x000000fe0000 : &quot;board_data&quot;
[    0.569830] 0x000000fe0000-0x000001000000 : &quot;nvram&quot;
[    0.578876] bcm63xx-spi bcm6358-spi: at [mem 0xb0000800-0xb0000f0b flags 0x200] (irq 9, FIFOs size 542)
[    0.627611] bcm63xx-wdt bcm63xx-wdt:  started, timer margin: 30 sec
[    0.640865] NET: Registered protocol family 10
[    0.647741] NET: Registered protocol family 17
[    0.652417] bridge: automatic filtering via arp/ip/ip6tables has been deprecated. Update your scripts to load br_netfilter if you need this.
[    0.665418] 8021q: 802.1Q VLAN Support v1.8
[    0.679377] VFS: Mounted root (squashfs filesystem) readonly on device 31:2.
[    0.694564] Freeing unused kernel memory: 1304K (8041a000 - 80560000)
[    2.138994] init: Console is alive
[    2.142849] init: - watchdog -
[    4.475749] usbcore: registered new interface driver usbfs
[    4.481566] usbcore: registered new interface driver hub
[    4.487205] usbcore: registered new device driver usb
[    4.531008] gpio-keys-polled gpio-keys-polled: unable to claim gpio 500, err=-16
[    4.538668] gpio-keys-polled: probe of gpio-keys-polled failed with error -16
[    4.558368] SCSI subsystem initialized
[    4.570254] ehci_hcd: USB 2.0 &#039;Enhanced&#039; Host Controller (EHCI) Driver
[    4.578512] ehci-platform: EHCI generic platform driver
[    4.687490] ehci-platform ehci-platform: EHCI Host Controller
[    4.693442] ehci-platform ehci-platform: new USB bus registered, assigned bus number 1
[    4.701834] ehci-platform ehci-platform: irq 15, io mem 0xb0001500
[    4.719464] ehci-platform ehci-platform: USB 2.0 started, EHCI 1.00, overcurrent ignored
[    4.729220] hub 1-0:1.0: USB hub found
[    4.733201] hub 1-0:1.0: 2 ports detected
[    4.742401] ohci_hcd: USB 1.1 &#039;Open&#039; Host Controller (OHCI) Driver
[    4.750320] ohci-platform: OHCI generic platform driver
[    4.755878] ohci-platform ohci-platform: Generic Platform OHCI controller
[    4.762891] ohci-platform ohci-platform: new USB bus registered, assigned bus number 2
[    4.771141] ohci-platform ohci-platform: irq 13, io mem 0xb0001600
[    4.837075] hub 2-0:1.0: USB hub found
[    4.841030] hub 2-0:1.0: 2 ports detected
[    4.851859] usbcore: registered new interface driver usb-storage
[    4.862569] init: - preinit -
Press the [f] key and hit [enter] to enter failsafe mode
Press the [1], [2], [3] or [4] key and hit [enter] to select the debug level
[    8.814419] mount_root: loading kmods from internal overlay
[    9.173447] jffs2: notice: (372) jffs2_build_xattr_subsystem: complete building xattr subsystem, 0 of xdatum (0 unchecked, 0 orphan) and 0 of xref (0 dead, 0 orphan) found.
[    9.189973] block: attempting to load /tmp/jffs_cfg/upper/etc/config/fstab
[    9.200088] block: extroot: not configured
[    9.258662] jffs2: notice: (369) jffs2_build_xattr_subsystem: complete building xattr subsystem, 0 of xdatum (0 unchecked, 0 orphan) and 0 of xref (0 dead, 0 orphan) found.
[    9.386941] block: attempting to load /tmp/jffs_cfg/upper/etc/config/fstab
[    9.396579] block: extroot: not configured
[    9.412638] mount_root: switching to jffs2 overlay
ifconfig: SIOCGIFFLAGS: No such device
[    9.448754] procd: - early -
[    9.451949] procd: - watchdog -
[    9.912920] random: nonblocking pool is initialized
[   10.251089] procd: - ubus -
[   10.308633] procd: - init -
Please press Enter to activate this console.
[   11.760006] RPC: Registered named UNIX socket transport module.
[   11.766132] RPC: Registered udp transport module.
[   11.770939] RPC: Registered tcp transport module.
[   11.775774] RPC: Registered tcp NFSv4.1 backchannel transport module.
[   11.832547] Installing knfsd (copyright (C) 1996 okir@monad.swb.de).
[   11.846612] ip6_tables: (C) 2000-2006 Netfilter Core Team
[   11.867876] Netfilter messages via NETLINK v0.30.
[   11.877674] ip_set: protocol 6
[   11.937522] Loading modules backported from Linux version v4.4-rc5-1913-gc8fdf68
[   11.945172] Backport generated by backports.git backports-20151218-0-g2f58d9d
[   11.957443] ip_tables: (C) 2000-2006 Netfilter Core Team
[   11.984013] nf_conntrack version 0.5.0 (944 buckets, 3776 max)
[   12.099377] xt_time: kernel timezone is -0000
[   12.226742] PPP generic driver version 2.4.2
[   12.234418] NET: Registered protocol family 24
[   12.279698] b43-phy0: Broadcom 4322 WLAN found (core revision 16)
[   12.315475] b43-phy0: Found PHY: Analog 8, Type 4 (N), Revision 4
[   12.321765] b43-phy0: Found Radio: Manuf 0x17F, ID 0x2056, Revision 3, Version 0
[   12.341290] Broadcom 43xx driver loaded [ Features: PNL ]
[   19.507687] device eth0 entered promiscuous mode
[   19.540117] IPv6: ADDRCONF(NETDEV_UP): br-lan: link is not ready
[   20.590103] br-lan: port 1(eth0) entered forwarding state
[   20.595798] br-lan: port 1(eth0) entered forwarding state
[   20.604911] IPv6: ADDRCONF(NETDEV_CHANGE): br-lan: link becomes ready
[   22.323126] b43-phy0: Loading firmware version 666.2 (2011-02-23 01:15:07)
[   22.481769] IPv6: ADDRCONF(NETDEV_UP): wlan0: link is not ready
[   22.599531] br-lan: port 1(eth0) entered forwarding state
[   23.939776] svc: failed to register lockdv1 RPC service (errno 124).
[   24.514781] device wlan0 entered promiscuous mode
[   25.336773] wlan0: authenticate with 00:26:f2:ed:f5:77
[   25.355915] wlan0: send auth to 00:26:f2:ed:f5:77 (try 1/3)
[   25.365908] wlan0: authenticated
[   25.371616] wlan0: associate with 00:26:f2:ed:f5:77 (try 1/3)
[   25.381543] wlan0: RX AssocResp from 00:26:f2:ed:f5:77 (capab=0x431 status=0 aid=6)
[   25.389947] wlan0: associated
[   25.393381] IPv6: ADDRCONF(NETDEV_CHANGE): wlan0: link becomes ready
[   25.444987] br-lan: port 2(wlan0) entered forwarding state
[   25.450752] br-lan: port 2(wlan0) entered forwarding state
[   27.451430] br-lan: port 2(wlan0) entered forwarding state</code></pre></div>											<p class="post-edited">(Last edited by <strong>Xotic750</strong> on 10 May 2016, 17:36)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p323261">
				<div class="post-metadata">
					<div class="post-num">Post #86</div>
					<div class="post-author">Xotic750</div>
					<div class="post-datetime">
						10 May 2016, 21:42					</div>
				</div>
				<div class="post-content content">
					<p>Have revisited the configuration now that I have the serial cable to play with the <em>.has_enet</em> settings.</p><div class="codebox"><pre><code>    .has_enet0                      = 1,
    .enet0 = {
        .has_phy                = 1,
        .use_internal_phy       = 1,
    },
[    0.603705] bcm63xx_enet bcm63xx_enet.0: unable to register mdio bus
[    0.610447] bcm63xx_enet: probe of bcm63xx_enet.0 failed with error -5</code></pre></div><div class="codebox"><pre><code>    .has_enet0                      = 1,
    .enet0 = {
        .has_phy                = 1,
        .use_internal_phy       = 0,
    },
[    0.602676] bcm63xx_enet bcm63xx_enet.0: unable to register mdio bus
[    0.609414] bcm63xx_enet: probe of bcm63xx_enet.0 failed with error -5</code></pre></div><div class="codebox"><pre><code>    .has_enet0                      = 1,
    .enet0 = {
        .has_phy                = 1,
        .phy_id            = 0,
    },
[    0.603819] bcm63xx_enet bcm63xx_enet.0: unable to register mdio bus
[    0.610559] bcm63xx_enet: probe of bcm63xx_enet.0 failed with error -5</code></pre></div><p>&nbsp; <br /></p><div class="codebox"><pre><code>    .has_enet0                      = 1,
    .enet0 = {
        .has_phy                = 1,
        .phy_id            = 1,
    },
[    0.602599] bcm63xx_enet bcm63xx_enet.0: unable to register mdio bus
[    0.609338] bcm63xx_enet: probe of bcm63xx_enet.0 failed with error -5</code></pre></div><div class="codebox"><pre><code>    .has_enet1                      = 1,
    .enet1 = {
        .has_phy                = 1,
        .use_internal_phy       = 1,
    },
nothing logged</code></pre></div><p>Now, when I was using kernel v4.1.20/23 some of these setting would cause the device to lock up with the power LED red. I am now using kernel v4.4.9 and the lockup doesn&#039;t happen, which is somewhat better I suppose.</p><p>Like when I tested with danitool, the mdio detection/registration appears to be a/the problem.</p><div class="codebox"><pre><code>bcm63xx_enet bcm63xx_enet.0: unable to register mdio bus</code></pre></div><p>Which is in <em>bcm63xx_enet.c</em></p><div class="codebox"><pre><code>        ret = mdiobus_register(bus);
        if (ret) {
            dev_err(&amp;pdev-&gt;dev, &quot;unable to register mdio bus\n&quot;);
            goto out_free_mdio;
        }</code></pre></div><p>But I haven&#039;t found <em>mdiobus_register</em> yet, editor is searching now. Found in <em>mdio_bus.c</em></p><p>The code that actually get executed is <em>__mdiobus_register</em>, seems to be some kind of overload function. It gets as far as the following code, and ends up <em>goto error</em></p><div class="codebox"><pre><code>    for (i = 0; i &lt; PHY_MAX_ADDR; i++) {
        if ((bus-&gt;phy_mask &amp; (1 &lt;&lt; i)) == 0) {
            struct phy_device *phydev;

            phydev = mdiobus_scan(bus, i);
            if (IS_ERR(phydev)) {
                err = PTR_ERR(phydev);
                goto error;
            }
        }
    }</code></pre></div><div class="codebox"><pre><code>error:
    while (--i &gt;= 0) {
        struct phy_device *phydev = bus-&gt;phy_map[i];
        if (phydev) {
            phy_device_remove(phydev);
            phy_device_free(phydev);
        }
    }
    device_del(&amp;bus-&gt;dev);
    return err;
}</code></pre></div><p>Haven&#039;t found <em>IS_ERROR</em> code yet. Found <em>err.h</em>, which basically looks like it&#039;s just a value comparator. Now <em>PTR_ERR</em>, looking. Seems to be a cast to <em>long</em>.</p><p>Added some logging to the above code.</p><div class="codebox"><pre><code>[    0.579031] bcm63xx-spi bcm6358-spi: at [mem 0xb0000800-0xb0000f0b flags 0x200] (irq 9, FIFOs size 542)
[    0.591750] libphy: bus-&gt;name: bcm63xx_enet MII bus
[    0.596945] libphy: PHY_MAX_ADDR: 32
[    0.600595] libphy: i: 0
[    0.603182] libphy: i: 1
[    0.609522] libphy: mdiobus_read: -1
[    0.613142] libphy: get_phy_id: phy_reg MII_PHYSID1: -1
[    0.618518] libphy: get_phy_device: 1, -5, 0  /*addr, r, phy_id*/
[    0.622906] libphy: mdiobus_scan: 1, -5
[    0.626848] libphy: phydev: -5
[    0.629984] libphy: err: -5
[    0.632976] bcm63xx_enet bcm63xx_enet.0: unable to register mdio bus
[    0.639679] bcm63xx_enet: probe of bcm63xx_enet.0 failed with error -5
[    0.679371] bcm63xx-wdt bcm63xx-wdt:  started, timer margin: 30 sec</code></pre></div><p>No nearer to knowing what the error code means or anything.</p><p><em>err:5</em> is <em>EIO</em> from <em>errno.h</em></p><div class="codebox"><pre><code> #define EIO              5      /* I/O error */</code></pre></div><p>from <em>mmi.h</em></p><div class="codebox"><pre><code>/* Generic MII registers. */
#define MII_PHYSID1        0x02    /* PHYS ID 1                   */
#define MII_PHYSID2        0x03    /* PHYS ID 2                   */</code></pre></div><p>from <em>mdio_bus.c</em></p><div class="codebox"><pre><code>/**
 * mdiobus_read - Convenience function for reading a given MII mgmt register
 * @bus: the mii_bus struct
 * @addr: the phy address
 * @regnum: register number to read
 *
 * NOTE: MUST NOT be called from interrupt context,
 * because the bus read/write functions may wait for an interrupt
 * to conclude the operation.
 */
int mdiobus_read(struct mii_bus *bus, int addr, u32 regnum)
{
    int retval;

    BUG_ON(in_interrupt());

    mutex_lock(&amp;bus-&gt;mdio_lock);
    retval = bus-&gt;read(bus, addr, regnum);
    mutex_unlock(&amp;bus-&gt;mdio_lock);

    pr_info(&quot;mdiobus_read: %d\n&quot;, retval);
    return retval;
}</code></pre></div><p>Are the correct values being passed to <em>bus-&gt;read</em>, and what does it do? Why does it return -1 and what does that mean?</p>											<p class="post-edited">(Last edited by <strong>Xotic750</strong> on 11 May 2016, 05:01)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p323361">
				<div class="post-metadata">
					<div class="post-num">Post #87</div>
					<div class="post-author">Xotic750</div>
					<div class="post-datetime">
						11 May 2016, 15:17					</div>
				</div>
				<div class="post-content content">
					<p>So I&#039;ve got somewhere and nowhere.</p><p>I noticed some code in <em>mdio_bus.c</em>, it&#039;s path never gets followed as it is set to hard <em>false</em>.</p><div class="codebox"><pre><code>struct phy_device *mdiobus_scan(struct mii_bus *bus, int addr)
{
    struct phy_device *phydev;
    struct mdio_board_entry *be;
    int err;

    phydev = get_phy_device(bus, addr, false);</code></pre></div><p><a href="https://www.linux-mips.org/archives/linux-mips/2012-05/msg00312.html">A quote from a patch back in 2012</a></p><div class="quotebox"><blockquote><p>The IEEE802.3 clause 45 MDIO bus protocol allows for directly<br />addressing PHY registers using a 21 bit address, and is used by many<br />10G Ethernet PHYS.&nbsp; Already existing is the ability of MDIO bus<br />drivers to use clause 45, with the MII_ADDR_C45 flag.</p></blockquote></div><p>No idea where this <em>MII_ADDR_C45</em> flag is that it mentions, in a <em>.config</em> perhaps? Anyway, I thought I&#039;d evexute the path and set it to <em>true</em>.</p><div class="codebox"><pre><code>    phydev = get_phy_device(bus, addr, true);</code></pre></div><p>In <em>board_bcm63xx.</em>c I set the config</p><div class="codebox"><pre><code>    .has_enet0            = 1,
    .enet0 = {
        .has_phy        = 1,
        .use_internal_phy    = 1,
    },</code></pre></div><p>It compiled, and I flashed the unit. To my surprise, I saw a complete bus scan without the error 5.</p><div class="codebox"><pre><code>[    0.579938] bcm63xx-spi bcm6358-spi: at [mem 0xb0000800-0xb0000f0b flags 0x200] (irq 9, FIFOs size 542)
[    0.594703] libphy: bcm63xx_enet MII bus: probed
[    0.599590] bcm63xx_enet bcm63xx_enet.0: attached PHY at address 1 [Generic 10G PHY]</code></pre></div><p>The downside was the kernel panic.</p><div class="codebox"><pre><code>[    0.579938] bcm63xx-spi bcm6358-spi: at [mem 0xb0000800-0xb0000f0b flags 0x200] (irq 9, FIFOs size 542)
[    0.594703] libphy: bcm63xx_enet MII bus: probed
[    0.599590] bcm63xx_enet bcm63xx_enet.0: attached PHY at address 1 [Generic 10G PHY]
[    0.607579] CPU 1 Unable to handle kernel paging request at virtual address 00008bb4, epc == 80028350, ra == 80010448
[    0.618473] Oops[#1]:
[    0.620785] CPU: 1 PID: 1 Comm: swapper/0 Not tainted 4.4.9 #3
[    0.626785] task: 83830000 ti: 83826000 task.ti: 83826000
[    0.632333] $ 0   : 00000000 10008b00 10008b03 ffff00ff
[    0.637708] $ 4   : 00008b00 803be74c 80220000 00000000
[    0.643083] $ 8   : 10008b01 1000001e 656e6572 69632031
[    0.648459] $12   : 726d0044 0000001a 00000000 45564943
[    0.653835] $16   : 839cb800 00008b00 00000000 80405fb0
[    0.659211] $20   : 80405fa0 80400000 839cbc20 000003e9
[    0.664588] $24   : 00000003 802138f0                  
[    0.669963] $28   : 83826000 83827b38 804060bc 80010448
[    0.675340] Hi    : 00000000
[    0.678297] Lo    : 00000000
[    0.681271] epc   : 80028350 do_ade+0x28/0x488
[    0.685833] ra    : 80010448 ret_from_irq+0x0/0x4
[    0.690662] Status: 10008b03 KERNEL EXL IE 
[    0.694965] Cause : 00800008 (ExcCode 02)
[    0.699085] BadVA : 00008bb4
[    0.702044] PrId  : 0002a031 (Broadcom BMIPS4350)
[    0.706878] Modules linked in:
[    0.710024] Process swapper/0 (pid: 1, threadinfo=83826000, task=83830000, tls=00000000)
[    0.718347] Stack : 00000000 10008b01 83826000 83827b68 839cb800 80221e1c 00000000 80405fb0
          80405fa0 80400000 00000210 00000000 83827c20 803be74c 80220000 00000000
          10008b01 1000001e 656e6572 69632031 726d0044 0000001a 00000000 45564943
          839cb800 83a31600 00000000 80405fb0 80405fa0 80400000 839cbc20 000003e9
          00000003 802138f0 00000000 45564943 83826000 83827bf0 804060bc 80010420
          ...
[    0.754904] Call Trace:
[    0.757424] [&lt;80028350&gt;] do_ade+0x28/0x488
[    0.761629] 
[    0.763146] 
Code: afb20018  afb00010  00808821 &lt;8e2200b4&gt; 8c8400ac  10820102  8e2300a0  30620018  24040010 
[    0.773440] ---[ end trace 24dc91b92d532273 ]---
[    0.780089] Kernel panic - not syncing: Attempted to kill init! exitcode=0x0000000b
[    0.780089] 
[    0.791046] ---[ end Kernel panic - not syncing: Attempted to kill init! exitcode=0x0000000b
[    0.791046] </code></pre></div><p>What to do now? I really need some input at this point.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p323730">
				<div class="post-metadata">
					<div class="post-num">Post #88</div>
					<div class="post-author">Xotic750</div>
					<div class="post-datetime">
						13 May 2016, 22:00					</div>
				</div>
				<div class="post-content content">
					<p>Have also submitted a patch to LEDE <a href="http://patchwork.ozlabs.org/patch/622106/">http://patchwork.ozlabs.org/patch/622106/</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p327269">
				<div class="post-metadata">
					<div class="post-num">Post #89</div>
					<div class="post-author">not2stressed</div>
					<div class="post-datetime">
						5 Jun 2016, 14:34					</div>
				</div>
				<div class="post-content content">
					<p>Hi Xotic750,<br />Greetings from Australia!<br />I&#039;ve got one of these routers which is &quot;Telstra&quot; branded and I would also love to run OpenWrt on it.&nbsp; I just stumbled across your efforts whilst looking to see if OpenWrt was available for it so I&#039;d just like to say thanks for your work and to encourage you to keep going ... :-)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p327271">
				<div class="post-metadata">
					<div class="post-num">Post #90</div>
					<div class="post-author">Xotic750</div>
					<div class="post-datetime">
						5 Jun 2016, 14:56					</div>
				</div>
				<div class="post-content content">
					<p>Hi not2stressed.<br />Greetings from Sweden!<br />The submission has been accepted by LEDE (not OpenWRT yet) and should be making its way into the trunk soon. As far as getting the switch to work, I feel certain that it can be done but I am at an impasse and will need assistance from someone with greater knowledge than me.</p><p>The latest news about the switch <a href="http://lists.infradead.org/pipermail/lede-dev/2016-June/001157.html">http://lists.infradead.org/pipermail/le … 01157.html</a></p>											<p class="post-edited">(Last edited by <strong>Xotic750</strong> on 5 Jun 2016, 16:54)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p327561">
				<div class="post-metadata">
					<div class="post-num">Post #91</div>
					<div class="post-author">Xotic750</div>
					<div class="post-datetime">
						7 Jun 2016, 21:06					</div>
				</div>
				<div class="post-content content">
					<p>The patches are now in <a href="https://git.lede-project.org/?p=source.git;a=commit;h=532c3f3218ef97a12e7a178207031e4feac593ff">LEDE trunk</a> and <a href="https://downloads.lede-project.org/snapshots/targets/brcm63xx/smp/">snapshots are available</a>.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p364089">
				<div class="post-metadata">
					<div class="post-num">Post #92</div>
					<div class="post-author">marsics80</div>
					<div class="post-datetime">
						21 Aug 2017, 18:34					</div>
				</div>
				<div class="post-content content">
					<p>Hello!</p><p>I update my router, the following image: --&gt; lede project download page................. /releases/17.01.2/targets/brcm63xx/smp/lede-17.01.2-brcm63xx-smp-EVG2000-squashfs-factory.chk</p><p>But it say:</p><p>&quot;DSL Router Software Upgrade</p><p>Image uploading failed. The selected file contains an illegal image. </p><p>[back]&quot;</p><p>What the problem?</p><p>Sorry my bad English.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 4 of 4</div><nav><ul><li><a href="viewtopic.php%3Fid=63950&amp;p=1.html">1</a></li><li><a href="viewtopic.php%3Fid=63950&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=63950&amp;p=3.html">3</a></li><li class="pagination-current"><span>4</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>