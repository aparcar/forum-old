<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> HAME MPR-A1 - Small and cheap router with built-in battery</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 12 May 2015 and 2 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 4 of 28</div><nav><ul><li><a href="viewtopic.php%3Fid=37002&amp;p=1.html">1</a></li><li><a href="viewtopic.php%3Fid=37002&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=37002&amp;p=3.html">3</a></li><li class="pagination-current"><span>4</span></li><li><a href="viewtopic.php%3Fid=37002&amp;p=5.html">5</a></li><li><a href="viewtopic.php%3Fid=37002&amp;p=6.html">6</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=37002&amp;p=28.html">28</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p186766">
				<div class="post-metadata">
					<div class="post-num">Post #76</div>
					<div class="post-author">lizby</div>
					<div class="post-datetime">
						23 Dec 2012, 00:46					</div>
				</div>
				<div class="post-content content">
					<p>swatfa--The gpios are useful when you want to use the device as a &quot;little computer&quot; as opposed to as a router.&nbsp; The market may be somewhat limited.&nbsp; Even just bringing out the serial console and i2c to a header (or .1 inch through-holes) would be helpful.&nbsp; With gpios you can control external devices--robots, vehicles, furnaces, any number of things.</p><p>A second usb port would have many uses (webcam + usb 3g).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186768">
				<div class="post-metadata">
					<div class="post-num">Post #77</div>
					<div class="post-author">swatfa</div>
					<div class="post-datetime">
						23 Dec 2012, 01:33					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>lizby wrote:</cite><blockquote><p>swatfa--The gpios are useful when you want to use the device as a &quot;little computer&quot; as opposed to as a router.&nbsp; The market may be somewhat limited.&nbsp; Even just bringing out the serial console and i2c to a header (or .1 inch through-holes) would be helpful.&nbsp; With gpios you can control external devices--robots, vehicles, furnaces, any number of things.</p><p>A second usb port would have many uses (webcam + usb 3g).</p></blockquote></div><p>As far as i know the device already has gpios. I will try to see if i can get the factory to add more to the pcb.</p><p>But unfortunatly an extra usb will not be possible for now. I might include a mini usb hub as an accessory with the device for the webcam plus 3g</p><p>The gpio configuration you posted earlier is it feasible in your opinion for this device? Or is there a simpler configuration you can advise on? So i can try to present it to the factory to see if they can include it</p>											<p class="post-edited">(Last edited by <strong>swatfa</strong> on 23 Dec 2012, 01:48)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186792">
				<div class="post-metadata">
					<div class="post-num">Post #78</div>
					<div class="post-author">Squonk</div>
					<div class="post-datetime">
						23 Dec 2012, 12:03					</div>
				</div>
				<div class="post-content content">
					<p>First of all, the HAME MPR-A1 (and clones) and the TP-Link TL-WR703N (and related TL-MR3020/TL-MR3040/TL-MR11U) are 2 different devices, with 2 different chips: the HAME is using a Ralink RT5350F chip, and the TP-Links an Atheros AR9331 chip.</p><p>Its is true however that both chips feature a 384 or 400MHz MIPS24kc, built-in 5x Ethernet switch, USB 2.0 Host and 802.1n Wifi and a set of peripherals, and thus play in the same category as low-cost integrated chip for portable, battery-operated routers.</p><p>Please also remember that although these chips contain a lot of pins, their purpose is clearly not for real-time, microcontroller-like operation as could be an AVR chip (used in Arduino boards), so their capacities in this domain are rather limited: because of Linux multi-tasking scheduling, don&#039;t expect controlling a hardware process with &lt; 10 ms accuracy, meaning only very slow control is possible.</p><p>That said, and speaking about the HAME MPR-A1 from this thread, referring to the <a href="http://www.tracermcc.ru/foto/bender/RT3050_5x_V2.0_081408_0902.pdf">RT3050F preliminary datasheet</a> (the RT3050F looks very similar to the RT5350F), this chip contains the following devices:<br /></p><ul><li><p>Clock/Timer/Reset/PLL Block</p></li><li><p>MIPS 24KEc (284 MHz) 32 KB Instruction Cache / 16 KB Data Cache CPU</p></li><li><p>802.11n 2T2R 2.4 GHz RF</p></li><li><p>802.11n 2T2R MAC BBP (Base Band Processor)</p></li><li><p>5-Port Fast&nbsp; Ethernet Switch</p></li><li><p>8/16 bit NOR or 8 bit NAND Parallel Flash Controller (not used in HAME MPR-A1)</p></li><li><p>16/32 bit SDRAM Controller (used in 16 bit mode in HAME MPR-A1)</p></li><li><p>1x Full UART</p></li><li><p>1x Lite UART (used as console in HAME MPR-A1)</p></li><li><p>1x USB 2.0 OTG Controller + PHY</p></li><li><p>1x I2C Interface</p></li><li><p>1x I2S Audio Interface</p></li><li><p>1x SPI Interface (used for Flash in HAME MPR-A1)</p></li><li><p>1x PCM Codec Interface</p></li><li><p>Up to 52 GPIOs</p></li></ul><p>The <strong>52 GPIOs</strong> sound like a lot, but as they are actually sharing the chip pins with the other functions (multiplexing), there aren&#039;t so many that are really available.</p><p>Not counting that some of the GPIOs are already used to perform some onboard function:<br /></p><ul><li><p>GPIO0 - Reset Button</p></li><li><p>GPIO7 - USB Power</p></li><li><p>GPIO12 - USB Root Hub Power</p></li><li><p>GPIO13 - Unknown, but seems to be used in bootloader, maybe USB overcurrent input?</p></li><li><p>GPIO17 - Red Power LED</p></li><li><p>GPIO20 - Blue System LED</p></li></ul><p>Looking at at the &quot;1.3 Pin Sharing Scheme&quot; section on page 17&nbsp; of the RT3050F datasheet, and given that the RGMII_GPIO_MODE, SDRAM_GPIO_MODE and MDIO_GPIO_MODE are not available for the RT3050F (and probably too for the RT5350F),&nbsp; and that the SPI_GPIO_MODE is not available because the HAME MPR-A1 uses SPI Flash memory:<br /></p><ol class="decimal"><li><p>JTAG_GPIO_MODE is set during normal operation, as GPIO17 is used for the Red Power LED and GPIO20 for the Blue System LED, thus GPIO18/GPIO19/GPIO21 are also available, but no JTAG</p></li><li><p>TXD2 (GPIO15) and RXD2 (GPIO16) are already used by the console</p></li><li><p>as GPIO7 and GPIO12 are already used for the USB, Full UART, PCM and I2S interfaces are not available <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /> So, GPIO8 (TXD) and GPIO10 (RXD) cannot be used as a second Lite UART, but GPIO8/GPIO9/GPIO10/GPIO11 and GPIO14 seem to be available as simple GPIOs</p></li><li><p>GPIO1 (I2C_SD) and GPIO2 (I2C_SCLK) are available</p></li></ol><p>So, there is a total of 12 available GPIOs (including the console UART which is already available on pads under the battery), but no second UART, PCM, I2S or second USB interfaces. These signals (plus some additional GND, +5V, +3.3V power pins) could be brought out to a dual row 0.1&quot; unmounted SMT header on the battery side of the PCB (like the existing UART), but not to a through-hole header because of the lack of space on the PCB.</p><p>Of course, this would require additional routing for the signals listed in the numbered list above, but it doesn&#039;t add anything to the BOM cost...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186793">
				<div class="post-metadata">
					<div class="post-num">Post #79</div>
					<div class="post-author">swatfa</div>
					<div class="post-datetime">
						23 Dec 2012, 12:21					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Squonk wrote:</cite><blockquote><p>First of all, the HAME MPR-A1 (and clones) and the TP-Link TL-WR703N (and related TL-MR3020/TL-MR3040/TL-MR11U) are 2 different devices, with 2 different chips: the HAME is using a Ralink RT5350F chip, and the TP-Links an Atheros AR9331 chip.</p><p>Its is true however that both chips feature a 384 or 400MHz MIPS24kc, built-in 5x Ethernet switch, USB 2.0 Host and 802.1n Wifi and a set of peripherals, and thus play in the same category as low-cost integrated chip for portable, battery-operated routers.</p><p>Please also remember that although these chips contain a lot of pins, their purpose is clearly not for real-time, microcontroller-like operation as could be an AVR chip (used in Arduino boards), so their capacities in this domain are rather limited: because of Linux multi-tasking scheduling, don&#039;t expect controlling a hardware process with &lt; 10 ms accuracy, meaning only very slow control is possible.</p><p>That said, and speaking about the HAME MPR-A1 from this thread, referring to the <a href="http://www.tracermcc.ru/foto/bender/RT3050_5x_V2.0_081408_0902.pdf">RT3050F preliminary datasheet</a> (the RT3050F looks very similar to the RT5350F), this chip contains the following devices:<br /></p><ul><li><p>Clock/Timer/Reset/PLL Block</p></li><li><p>MIPS 24KEc (284 MHz) 32 KB Instruction Cache / 16 KB Data Cache CPU</p></li><li><p>802.11n 2T2R 2.4 GHz RF</p></li><li><p>802.11n 2T2R MAC BBP (Base Band Processor)</p></li><li><p>5-Port Fast&nbsp; Ethernet Switch</p></li><li><p>8/16 bit NOR or 8 bit NAND Parallel Flash Controller (not used in HAME MPR-A1)</p></li><li><p>16/32 bit SDRAM Controller (used in 16 bit mode in HAME MPR-A1)</p></li><li><p>1x Full UART</p></li><li><p>1x Lite UART (used as console in HAME MPR-A1)</p></li><li><p>1x USB 2.0 OTG Controller + PHY</p></li><li><p>1x I2C Interface</p></li><li><p>1x I2S Audio Interface</p></li><li><p>1x SPI Interface (used for Flash in HAME MPR-A1)</p></li><li><p>1x PCM Codec Interface</p></li><li><p>Up to 52 GPIOs</p></li></ul><p>The <strong>52 GPIOs</strong> sound like a lot, but as they are actually sharing the chip pins with the other functions (multiplexing), there aren&#039;t so many that are really available.</p><p>Not counting that some of the GPIOs are already used to perform some onboard function:<br /></p><ul><li><p>GPIO0 - Reset Button</p></li><li><p>GPIO7 - USB Power</p></li><li><p>GPIO12 - USB Root Hub Power</p></li><li><p>GPIO13 - Unknown, but seems to be used in bootloader, maybe USB overcurrent input?</p></li><li><p>GPIO17 - Red Power LED</p></li><li><p>GPIO20 - Blue System LED</p></li></ul><p>Looking at at the &quot;1.3 Pin Sharing Scheme&quot; section on page 17&nbsp; of the RT3050F datasheet, and given that the RGMII_GPIO_MODE, SDRAM_GPIO_MODE and MDIO_GPIO_MODE are not available for the RT3050F (and probably too for the RT5350F),&nbsp; and that the SPI_GPIO_MODE is not available because the HAME MPR-A1 uses SPI Flash memory:<br /></p><ol class="decimal"><li><p>JTAG_GPIO_MODE is set during normal operation, as GPIO17 is used for the Red Power LED and GPIO20 for the Blue System LED, thus GPIO18/GPIO19/GPIO21 are also available, but no JTAG</p></li><li><p>TXD2 (GPIO15) and RXD2 (GPIO16) are already used by the console</p></li><li><p>as GPIO7 and GPIO12 are already used for the USB, Full UART, PCM and I2S interfaces are not available <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /> So, GPIO8 (TXD) and GPIO10 (RXD) cannot be used as a second Lite UART, but GPIO8/GPIO9/GPIO10/GPIO11 and GPIO14 seem to be available as simple GPIOs</p></li><li><p>GPIO1 (I2C_SD) and GPIO2 (I2C_SCLK) are available</p></li></ol><p>So, there is a total of 12 available GPIOs (including the console UART which is already available on pads under the battery), but no second UART, PCM, I2S or second USB interfaces. These signals (plus some additional GND, +5V, +3.3V power pins) could be brought out to a dual row 0.1&quot; unmounted SMT header on the battery side of the PCB (like the existing UART), but not to a through-hole header because of the lack of space on the PCB.</p><p>Of course, this would require additional routing for the signals listed in the numbered list above, but it doesn&#039;t add anything to the BOM cost...</p></blockquote></div><p>Thanks for the detailed information. I will be sure to pass it on to the factory.<br />Would it be possible to have a configuration list similar to something like this:<br /> 1 = 3V3&nbsp; &nbsp; 2 = 5V<br />&nbsp; 3 = GPIO0&nbsp; 4 = GPIO4<br />&nbsp; 5 = GPIO1&nbsp; 6 = GND<br />&nbsp; 7 = GPIO2&nbsp; 8 = TX<br />&nbsp; 9 = GPIO3&nbsp; 10= RX<br /> 11 = GND&nbsp; &nbsp; 12= GND<br /> 13 = i2cSCL 14= TX2<br /> 15 = i2cSDA 16= RX2</p><p>So that i can give it to the factory? Ideally as you mentioned if its something that does not increase the BOM and just requires some minor changes on the PCB that would be great to keep my overheads down.</p><p>One more thing. You mentioned that the chip is not designed for realtime microcontroller functionality. With this in mind, would there be any benefit in the changes that you are recommending?</p><p>Thanks</p>											<p class="post-edited">(Last edited by <strong>swatfa</strong> on 23 Dec 2012, 12:27)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186799">
				<div class="post-metadata">
					<div class="post-num">Post #80</div>
					<div class="post-author">Squonk</div>
					<div class="post-datetime">
						23 Dec 2012, 13:00					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>swatfa wrote:</cite><blockquote><p>Thanks for the detailed information. I will be sure to pass it on to the factory.<br />Would it be possible to have a configuration list similar to something like this:<br /> 1 = 3V3&nbsp; &nbsp; &nbsp; 2 = 5V<br /> 3 = GPIO0&nbsp; &nbsp;4 = GPIO4<br /> 5 = GPIO1&nbsp; &nbsp;6 = GND<br /> 7 = GPIO2&nbsp; &nbsp;8 = TX<br /> 9 = GPIO3&nbsp; &nbsp;10= RX<br />11 = GND&nbsp; &nbsp; &nbsp; 12= GND<br />13 = i2cSCL 14= TX2<br />15 = i2cSDA&nbsp; &nbsp;16= RX2</p><p>So that i can give it to the factory? Ideally as you mentioned if its something that does not increase the BOM and just requires some minor changes on the PCB that would be great to keep my overheads down.</p></blockquote></div><p>Having a dual-row 0.1&quot; SMT header is important, but I don&#039;t think that a specific header pinout is, just make sure to provide a GND pin close to RXD2/TXD2 and I2C_SCLK/I2C_SD for convenience as a ground reference, plus +5V and +3.3V power supply.</p><p>Hre is my suggestion:<br /></p><div class="codebox"><pre><code> 1 = 3V3              2 = 5V
 3 = GPIO11           4 = GPIO14
 5 = GPIO10           6 = GPIO18
 7 = GPIO9            8 = GPIO19
 9 = GPIO8            10= GPIO21
11 = GND              12= GND
13 = I2C_SCLK (GPIO2) 14= TXD2 (GPIO15)
15 = I2C_SD (GPIO1)   16= RXD2 (GPIO16)</code></pre></div><div class="quotebox"><cite>swatfa wrote:</cite><blockquote><p>One more thing. You mentioned that the chip is not designed for realtime microcontroller functionality. With this in mind, would there be any benefit in the changes that you are recommending?</p></blockquote></div><p>Yes, it is definitely useful for low-speed real-world control and communication with external microcontrollers that are able to provide this higher-speed control, opening the device to a lot of hacking applications.</p><p><strong><span class="bbu">EDIT:</span></strong><br />As a 2x10 0.1&quot; SMT R/A is a very common header, maybe something like this would be almost perfect:<br /></p><div class="codebox"><pre><code> 1 = 3V3               2 = 5V
 3 = GPIO11            4 = GPIO14
 5 = GPIO10            6 = GPIO18
 7 = GND               8 = GND
 9 = GPIO9            10 = GPIO19
11 = GPIO8            12 = GPIO21
13 = GND              14 = GND
15 = I2C_SCLK (GPIO2) 16 = TXD2 (GPIO15)
17 = I2C_SD (GPIO1)   18 = RXD2 (GPIO16)
19 = 3V3              20 = 5V</code></pre></div>											<p class="post-edited">(Last edited by <strong>Squonk</strong> on 23 Dec 2012, 13:09)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186801">
				<div class="post-metadata">
					<div class="post-num">Post #81</div>
					<div class="post-author">swatfa</div>
					<div class="post-datetime">
						23 Dec 2012, 13:13					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Squonk wrote:</cite><blockquote><p>EDIT:<br />As a 2x10 0.1&quot; SMT R/A is a very common header, maybe something like this would be almost perfect:</p></blockquote></div><p>Thats excellent. Thanks. I will pass it on to the factory</p>											<p class="post-edited">(Last edited by <strong>swatfa</strong> on 23 Dec 2012, 13:14)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186802">
				<div class="post-metadata">
					<div class="post-num">Post #82</div>
					<div class="post-author">Squonk</div>
					<div class="post-datetime">
						23 Dec 2012, 13:16					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>swatfa wrote:</cite><blockquote><div class="quotebox"><cite>Squonk wrote:</cite><blockquote><p>EDIT:<br />As a 2x10 0.1&quot; SMT R/A is a very common header, maybe something like this would be almost perfect:</p></blockquote></div><p>Thats excellent. Thanks. I will pass it on to the factory</p></blockquote></div><p>Good luck, ask them for a non-mounted 2x10 SMT 0.1&quot; pitch R/A header to replace the existing UART pads on the PCB bottom <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>											<p class="post-edited">(Last edited by <strong>Squonk</strong> on 23 Dec 2012, 13:21)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186830">
				<div class="post-metadata">
					<div class="post-num">Post #83</div>
					<div class="post-author">lizby</div>
					<div class="post-datetime">
						23 Dec 2012, 17:34					</div>
				</div>
				<div class="post-content content">
					<p>Squonk--thank you for that detailed analysis of the GPIO usage in the reference design.&nbsp; Of course, by modifying the design, other GPIOs could be used for USB Power and USB Root Hub Power (since they only need to be on/off), thus freeing those pins for the full UART.</p><p>But to minimize board redesign, your suggestion of running only the currently available GPIOs to SMT header pads is probably easiest.&nbsp; While linux is not good for demanding real-time control, there are many uses for slower-acting devices, such as home automation.</p><p>Too bad about no chance for 2nd usb.&nbsp; 12 available GPIOs could make for a 16-pin header similar to the one I suggested.&nbsp; The one I laid out would have the advantage of partialy replicating that of the raspberry pi, but really, any layout routed to a header would be a big step forward.&nbsp; Here is my wish list.<br /></p><div class="codebox"><pre><code>  1 = 3V3            2 = 5V
  3 = i2cSCLK/GPIO2  4 = GPIO??
  5 = i2cSDA/GPIO1   6 = GND
  7 = GND            8 = TX
  9 = GPIO??        10 = RX
 11 = GPIO??        12 = GND
 13 = GPIO??        14 = GPIO??
 15 = GPIO??        16 = GPIO??</code></pre></div><p>If this is too many pins, it could be reduced to 10 pins with GND on pin 7 replaced with a GPIO, or even 8 pins if RX were moved to pin 7.</p>											<p class="post-edited">(Last edited by <strong>lizby</strong> on 23 Dec 2012, 17:46)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186831">
				<div class="post-metadata">
					<div class="post-num">Post #84</div>
					<div class="post-author">lizby</div>
					<div class="post-datetime">
						23 Dec 2012, 17:38					</div>
				</div>
				<div class="post-content content">
					<p>Squonk&#039;s 20-pin header would be ideal, but if something smaller is required, be sure to include the i2c pins.&nbsp; 8 pins appears to me to be the minimum to give you console and control of remote devices with GPIO or I2C.&nbsp; </p><p>Some Arduino and Pic and Picaxe microcontrollers support I2C slave communications, which could give about all the real-time control you could want, subject to commands from the master linux device.</p>											<p class="post-edited">(Last edited by <strong>lizby</strong> on 23 Dec 2012, 17:56)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186836">
				<div class="post-metadata">
					<div class="post-num">Post #85</div>
					<div class="post-author">swatfa</div>
					<div class="post-datetime">
						23 Dec 2012, 19:28					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for all the feedback. I will try to push Squonks layout to the factory to see if its feasible. If its not too feasible, i will try to push through a smaller layout keeping in mind the i2c pins. I dont forsee any problems. It should be ok as long as it doesnt involve any major hardware mods.</p><p>Regarding a second USB. This will certainly be in the works for a possible second or third model release after this one. But not for this release since it would involve a complete redesign of the casing and pcb which is not in the works for the time being</p>											<p class="post-edited">(Last edited by <strong>swatfa</strong> on 23 Dec 2012, 19:32)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186837">
				<div class="post-metadata">
					<div class="post-num">Post #86</div>
					<div class="post-author">lizby</div>
					<div class="post-datetime">
						23 Dec 2012, 19:59					</div>
				</div>
				<div class="post-content content">
					<p>swatfa--that sounds good.</p><p>On the Raspberry Pi, the I2C pins have the required pull-ups on the board.&nbsp; &nbsp;That would be optimal on your board, but if not available could be worked around.</p>											<p class="post-edited">(Last edited by <strong>lizby</strong> on 23 Dec 2012, 20:04)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186841">
				<div class="post-metadata">
					<div class="post-num">Post #87</div>
					<div class="post-author">Squonk</div>
					<div class="post-datetime">
						23 Dec 2012, 20:25					</div>
				</div>
				<div class="post-content content">
					<p>Here is a set of clean patches for creating a working firmware for the HAME MPR-A1(should also work on most of the clones) from latest trunk:<br /></p><ul><li><p><a href="http://pastebin.com/9SVHfva3">patch to add PM26LQ032 Flash support from p1vo</a></p></li><li><p><a href="http://pastebin.com/5cerkhUB">patch to add RT3550 WLAN support from 123serge123 and Heffer</a></p></li><li><p><a href="http://pastebin.com/jESjc2nH">patch to add HAME MPR-A1 support from arpunk, arteq, Heffer, p1vo and myself</a></p></li></ul><h5>Compiling</h5><p>Just checkout latest trunk (revision 34872 as of this writing) in a directory of your choice and apply the patches:<br /></p><div class="codebox"><pre><code>mkdir whatever
cd whatever
svn co svn://svn.openwrt.org/openwrt/trunk
cd trunk
patch -p0 &lt; path/to/dowloaded/patches/openwrt_add_pm26lq032_flash_support.txt
patch -p0 &lt; path/to/dowloaded/patches/openwrt_add_rt3550_wlan_support.txt
patch -p0 &lt; path/to/dowloaded/patches/openwrt_hame_mpr-a1_patch.txt
make menuconfig</code></pre></div><p>Select:<br /></p><ul><li><p>Target System: <strong>(Ralink RT288x/RT3xxx)</strong></p></li><li><p>Subtarget: <strong>(RT305x based boards)</strong></p></li><li><p>Target Profile: <strong>(HAME MPR-A1)</strong></p></li></ul><p>Then select all the packages you want to include , save and exit.</p><p>then:<br /></p><div class="codebox"><pre><code>make -j n</code></pre></div><p>...where &quot;n&quot; is the number of CPU + 1.</p><p>After a time that depends on your processing power (may take hours!), you should get a&nbsp; firmware image named &quot;<em>openwrt-ramips-rt305x-mpr-a1-squashfs-sysupgrade.bin</em>&quot; in the &quot;<em>bin/ramips</em>&quot; directory and all corresponding packages in the &quot;<em>packages</em>&quot; subdirectory.<br /></p><h5>Flashing</h5><p>I didn&#039;t tried using the flashing tool built in the original firmware&#039;s webadmin.</p><p>I used a TTL UART to USB converter (Nokia CA42 cable clone), connected like this:<br /><span class="postimg"><img src="http://imageshack.us/a/img821/9373/mprl8pcbbottom.png" alt="http://imageshack.us/a/img821/9373/mprl8pcbbottom.png" /></span></p><p>You will need an Ethernet cable between your Linux PC and the device.</p><p>On the Linux PC side, you will need a terminal emulator (&quot;sudo minicom&quot; or &quot;screen&quot;) and use a setup with 57600 bps, 8 bits, 1 stop bit, no parity, no hardware/software flow control and a tftp server running. In the following, it is assumed that you copied the &quot;<em>openwrt-ramips-rt305x-mpr-a1-squashfs-sysupgrade.bin</em>&quot; in the &quot;<em>bin/ramips</em>&quot; file at the root of the tftp server, generally &quot;<em>/tftpboot</em>&quot;.</p><p>Power on the device, and be readdy to type in &quot;2&quot; asap:<br /></p><div class="codebox"><pre><code>U-Boot 1.1.7 (Dec 13 2011 - 13:49:42)                                           
                                                                                
Board: Ralink APSoC DRAM:  16 MB                                                
relocate_code Pointer at: 80fb4000                                              
******************************                                                  
Software System Reset Occurred                                                  
******************************                                                  
spi_wait_nsec: 42                                                               
spi device id: ef 40 16 0 0 (40160000)                                          
find flash: W25Q32BV                                                            
raspi_read: from:30000 len:1000                                                 
.raspi_read: from:30000 len:1000                                                
.============================================                                   
Ralink UBoot Version: 3.6.0.0                                                   
--------------------------------------------                                    
ASIC 5350_MP (Port5&lt;-&gt;None)                                                     
DRAM_CONF_FROM: Boot-Strapping                                                  
DRAM_TYPE: SDRAM                                                                
DRAM_SIZE: 128 Mbits                                                            
DRAM_WIDTH: 16 bits                                                             
DRAM_TOTAL_WIDTH: 16 bits                                                       
TOTAL_MEMORY_SIZE: 16 MBytes                                                    
Flash component: SPI Flash                                                      
Date:Dec 13 2011  Time:13:49:42                                                 
============================================                                    
icache: sets:256, ways:4, linesz:32 ,total:32768                                
dcache: sets:128, ways:4, linesz:32 ,total:16384                                
                                                                                
 ##### The CPU freq = 360 MHZ ####                                              
 estimate memory size =16 Mbytes                                                
raspi_read: from:40028 len:6                                                    
.                                                                               
raspi_read: from:0 len:30004                                                    
....*************Is_update = 0 plat = 1**************                           
                                                                                
Please choose the operation:                                                    
   1: Load system code to SDRAM via TFTP.                                       
   2: Load system code then write to Flash via TFTP.                            
   3: Boot system code via Flash (default).                                     
   4: Entr boot command line interface.                                         
   7: Load Boot Loader code then write to Flash via Serial.                     
   9: Load Boot Loader code then write to Flash via TFTP.                       
                                                                                
You choosed 2                                                                   
                                                                                
 0                                                                              
                                                                                
2: System Load Linux Kernel then write to Flash via TFTP.                       
 Warning!! Erase Linux in Flash then burn new one. Are you sure?(Y/N)</code></pre></div><p>Type &quot;y&quot;, then enter the correct IPaddresses for the device and your PC, and the name of the firmware file:<br /></p><div class="codebox"><pre><code> Please Input new ones /or Ctrl-C to discard
        Input device IP (192.168.1.1) ==:192.168.1.1
        Input server IP (192.168.1.2) ==:192.168.1.2
        Input Linux Kernel filename (openwrt-ramips-rt305x-mpr-a1-squashfs-sysupgrade.bin) ==:openwrt-ramips-rt305x-mpr-a1-squashfs-sysupgrade.bin</code></pre></div><p>You should see the flashing taking place, followed by the normal OpenWrt boot sequence:<br /></p><div class="codebox"><pre><code> netboot_common, argc= 3 

 NetTxPacket = 0x80FE6AC0 

 KSEG1ADDR(NetTxPacket) = 0xA0FE6AC0 

 NetLoop,call eth_halt ! 

 NetLoop,call eth_init ! 
Trying Eth0 (10/100-M)

 Waitting for RX_DMA_BUSY status Start... done


 Header Payload scatter function is Disable !! 

 ETH_STATE_ACTIVE!! 
Using Eth0 (10/100-M) device
TFTP from server 192.168.1.2; our IP address is 192.168.1.1
Filename &#039;openwrt-ramips-rt305x-mpr-a1-squashfs-sysupgrade.bin&#039;.

 TIMEOUT_COUNT=10,Load address: 0x80100000
Loading: Got ARP REPLY, set server/gtwy eth addr (00:1d:09:d7:4c:49)
Got it
#################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         ##################
done
Bytes transferred = 2752516 (2a0004 hex)
NetBootFileXferSize= 002a0004
raspi_erase_write: offs:50000, count:2a0004
raspi_erase: offs:50000 len:2a0000
..........................................
raspi_write: to:50000 len:2a0000 
..........................................
raspi_read: from:50000 len:10000 
.raspi_read: from:60000 len:10000 
.raspi_read: from:70000 len:10000 
.raspi_read: from:80000 len:10000 
.raspi_read: from:90000 len:10000 
.raspi_read: from:a0000 len:10000 
.raspi_read: from:b0000 len:10000 
.raspi_read: from:c0000 len:10000 
.raspi_read: from:d0000 len:10000 
.raspi_read: from:e0000 len:10000 
.raspi_read: from:f0000 len:10000 
.raspi_read: from:100000 len:10000 
.raspi_read: from:110000 len:10000 
.raspi_read: from:120000 len:10000 
.raspi_read: from:130000 len:10000 
.raspi_read: from:140000 len:10000 
.raspi_read: from:150000 len:10000 
.raspi_read: from:160000 len:10000 
.raspi_read: from:170000 len:10000 
.raspi_read: from:180000 len:10000 
.raspi_read: from:190000 len:10000 
.raspi_read: from:1a0000 len:10000 
.raspi_read: from:1b0000 len:10000 
.raspi_read: from:1c0000 len:10000 
.raspi_read: from:1d0000 len:10000 
.raspi_read: from:1e0000 len:10000 
.raspi_read: from:1f0000 len:10000 
.raspi_read: from:200000 len:10000 
.raspi_read: from:210000 len:10000 
.raspi_read: from:220000 len:10000 
.raspi_read: from:230000 len:10000 
.raspi_read: from:240000 len:10000 
.raspi_read: from:250000 len:10000 
.raspi_read: from:260000 len:10000 
.raspi_read: from:270000 len:10000 
.raspi_read: from:280000 len:10000 
.raspi_read: from:290000 len:10000 
.raspi_read: from:2a0000 len:10000 
.raspi_read: from:2b0000 len:10000 
.raspi_read: from:2c0000 len:10000 
.raspi_read: from:2d0000 len:10000 
.raspi_read: from:2e0000 len:10000 
.raspi_read: from:2f0000 len:10000 
.raspi_erase: offs:2f0000 len:10000
.
raspi_write: to:2f0000 len:10000 
.
raspi_read: from:2f0000 len:10000 
.Done!
## Booting image at bc050000 ...
raspi_read: from:50000 len:40 
.   Image Name:   MIPS OpenWrt Linux-3.6.11
   Created:      2012-12-23  14:28:32 UTC
   Image Type:   MIPS Linux Kernel Image (lzma compressed)
   Data Size:    838219 Bytes = 818.6 kB
   Load Address: 80000000
   Entry Point:  80000000
raspi_read: from:50040 len:cca4b 
.............   Verifying Checksum ... OK
   Uncompressing Kernel Image ... OK
No initrd
## Transferring control to Linux (at address 80000000) ...
## Giving linux memsize in MB, 16

Starting kernel ...

[    0.000000] Linux version 3.6.11 (mstempin@Mikeul) (gcc version 4.6.4 20121106 (prerelease) (Linaro GCC 4.6-2012.11) ) #1 Sun Dec 23 15:28:25 CET 2012
[    0.000000] bootconsole [early0] enabled
[    0.000000] CPU revision is: 0001964c (MIPS 24KEc)
[    0.000000] Ralink RT5350 id:1 rev:3 running at 360.00 MHz
[    0.000000] Determined physical RAM map:
[    0.000000]  memory: 01000000 @ 00000000 (usable)
[    0.000000] Initrd not found or empty - disabling initrd
[    0.000000] Zone ranges:
[    0.000000]   Normal   [mem 0x00000000-0x00ffffff]
[    0.000000] Movable zone start for each node
[    0.000000] Early memory node ranges
[    0.000000]   node   0: [mem 0x00000000-0x00ffffff]
[    0.000000] Primary instruction cache 32kB, VIPT, 4-way, linesize 32 bytes.
[    0.000000] Primary data cache 16kB, 4-way, VIPT, no aliases, linesize 32 bytes
[    0.000000] Built 1 zonelists in Zone order, mobility grouping off.  Total pages: 4064
[    0.000000] Kernel command line:  board=MPR-A1 console=ttyS1,57600 mtdparts=spi0.0:192k(u-boot)ro,64k(u-boot-env)ro,64k(factory)ro,896k(kernel),2880k(rootfs),3776k@0x50000(firmware) 2
[    0.000000] PID hash table entries: 64 (order: -4, 256 bytes)
[    0.000000] Dentry cache hash table entries: 2048 (order: 1, 8192 bytes)
[    0.000000] Inode-cache hash table entries: 1024 (order: 0, 4096 bytes)
[    0.000000] __ex_table already sorted, skipping sort
[    0.000000] Writing ErrCtl register=00005680
[    0.000000] Readback ErrCtl register=00005680
[    0.000000] Memory: 13576k/16384k available (1931k kernel code, 2808k reserved, 312k data, 176k init, 0k highmem)
[    0.000000] SLUB: Genslabs=9, HWalign=32, Order=0-3, MinObjects=0, CPUs=1, Nodes=1
[    0.000000] NR_IRQS:48
[    0.000000] console [ttyS1] enabled, bootconsole disabled
[    0.000000] console [ttyS1] enabled, bootconsole disabled
[    0.010000] Calibrating delay loop... 239.61 BogoMIPS (lpj=1198080)
[    0.080000] pid_max: default: 32768 minimum: 301
[    0.080000] Mount-cache hash table entries: 512
[    0.090000] NET: Registered protocol family 16
[    0.100000] MIPS: machine is HAME MPR-A1
[    0.130000] bio: create slab &lt;bio-0&gt; at 0
[    0.140000] Switching to clocksource MIPS
[    0.150000] NET: Registered protocol family 2
[    0.160000] TCP established hash table entries: 512 (order: 0, 4096 bytes)
[    0.180000] TCP bind hash table entries: 512 (order: -1, 2048 bytes)
[    0.190000] TCP: Hash tables configured (established 512 bind 512)
[    0.200000] TCP: reno registered
[    0.210000] UDP hash table entries: 256 (order: 0, 4096 bytes)
[    0.220000] UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
[    0.230000] NET: Registered protocol family 1
[    0.280000] squashfs: version 4.0 (2009/01/31) Phillip Lougher
[    0.290000] jffs2: version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006 Red Hat, Inc.
[    0.320000] msgmni has been set to 26
[    0.320000] io scheduler noop registered
[    0.330000] io scheduler deadline registered (default)
[    0.340000] Serial: 8250/16550 driver, 2 ports, IRQ sharing disabled
[    0.360000] serial8250: ttyS0 at MMIO 0x10000500 (irq = 13) is a 16550A
[    0.370000] serial8250: ttyS1 at MMIO 0x10000c00 (irq = 20) is a 16550A
[    0.390000] ramips-spi ramips-spi.0: master is unqueued, this is deprecated
[    0.410000] m25p80 spi0.0: found w25q32, expected pm25lq032
[    0.420000] m25p80 spi0.0: w25q32 (4096 Kbytes)
[    0.430000] 6 cmdlinepart partitions found on MTD device spi0.0
[    0.440000] Creating 6 MTD partitions on &quot;spi0.0&quot;:
[    0.450000] 0x000000000000-0x000000030000 : &quot;u-boot&quot;
[    0.460000] 0x000000030000-0x000000040000 : &quot;u-boot-env&quot;
[    0.480000] 0x000000040000-0x000000050000 : &quot;factory&quot;
[    0.490000] 0x000000050000-0x000000130000 : &quot;kernel&quot;
[    0.500000] 0x000000130000-0x000000400000 : &quot;rootfs&quot;
[    0.520000] mtd: partition &quot;rootfs&quot; set to be root filesystem
[    0.530000] mtd: partition &quot;rootfs_data&quot; created automatically, ofs=2F0000, len=110000 
[    0.540000] 0x0000002f0000-0x000000400000 : &quot;rootfs_data&quot;
[    0.560000] 0x000000050000-0x000000400000 : &quot;firmware&quot;
[    0.580000] ramips-wdt ramips-wdt: timeout value must be 0 &lt; timeout &lt;= 35, using 35
[    0.600000] TCP: cubic registered
[    0.610000] NET: Registered protocol family 17
[    0.620000] 8021q: 802.1Q VLAN Support v1.8
[    0.650000] VFS: Mounted root (squashfs filesystem) readonly on device 31:4.
[    0.660000] Freeing unused kernel memory: 176k freed
[    5.120000] input: gpio-keys-polled as /devices/platform/gpio-keys-polled/input/input0
[    5.260000] Button Hotplug driver version 0.4.1
- preinit -
Press the [f] key and hit [enter] to enter failsafe mode
- regular preinit -
jffs2 not ready yet; using ramdisk
- init -

Please press Enter to activate this console. [   11.080000] Compat-drivers backport release: compat-drivers-2012-12-04
[   11.090000] Backport based on wireless-testing.git master-2012-12-06
[   11.100000] compat.git: wireless-testing.git
[   11.150000] cfg80211: Calling CRDA to update world regulatory domain
[   11.160000] cfg80211: World regulatory domain updated:
[   11.180000] cfg80211:   (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp)
[   11.190000] cfg80211:   (2402000 KHz - 2472000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
[   11.210000] cfg80211:   (2457000 KHz - 2482000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
[   11.220000] cfg80211:   (2474000 KHz - 2494000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
[   11.240000] cfg80211:   (5170000 KHz - 5250000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
[   11.250000] cfg80211:   (5735000 KHz - 5835000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
[   11.910000] SCSI subsystem initialized
[   12.330000] usbcore: registered new interface driver usbfs
[   12.340000] usbcore: registered new interface driver hub
[   12.350000] usbcore: registered new device driver usb
[   14.890000] PPP generic driver version 2.4.2
[   15.310000] ip_tables: (C) 2000-2006 Netfilter Core Team
[   15.580000] NET: Registered protocol family 24
[   15.760000] ehci_hcd: USB 2.0 &#039;Enhanced&#039; Host Controller (EHCI) Driver
[   16.770000] ehci-platform ehci-platform: Generic Platform EHCI Controller
[   16.780000] ehci-platform ehci-platform: new USB bus registered, assigned bus number 1
[   16.830000] ehci-platform ehci-platform: irq 26, io mem 0x101c0000
[   16.860000] ehci-platform ehci-platform: USB 2.0 started, EHCI 1.00
[   16.870000] hub 1-0:1.0: USB hub found
[   16.880000] hub 1-0:1.0: 1 port detected
[   17.030000] nf_conntrack version 0.5.0 (214 buckets, 856 max)
[   17.760000] ohci_hcd: USB 1.1 &#039;Open&#039; Host Controller (OHCI) Driver
[   17.770000] ohci-platform ohci-platform: Generic Platform OHCI Controller
[   17.780000] ohci-platform ohci-platform: new USB bus registered, assigned bus number 2
[   17.800000] ohci-platform ohci-platform: irq 26, io mem 0x101c1000
[   17.870000] hub 2-0:1.0: USB hub found
[   17.880000] hub 2-0:1.0: 1 port detected
[   18.040000] usbcore: registered new interface driver cdc_acm
[   18.050000] cdc_acm: USB Abstract Control Model driver for USB modems and ISDN adapters
[   18.210000] usbcore: registered new interface driver usbserial
[   18.230000] usbcore: registered new interface driver usbserial_generic
[   18.240000] USB Serial support registered for generic
[   18.250000] usbserial: USB Serial Driver core
[   18.300000] Initializing USB Mass Storage driver...
[   18.310000] usbcore: registered new interface driver usb-storage
[   18.320000] USB Mass Storage support registered.
[   18.460000] usbcore: registered new interface driver ums-alauda
[   18.490000] usbcore: registered new interface driver ums-cypress
[   18.530000] usbcore: registered new interface driver ums-datafab
[   18.560000] usbcore: registered new interface driver ums-freecom
[   18.600000] usbcore: registered new interface driver ums-isd200
[   18.630000] usbcore: registered new interface driver ums-jumpshot
[   18.660000] usbcore: registered new interface driver ums-karma
[   18.690000] usbcore: registered new interface driver ums-sddr09
[   18.730000] usbcore: registered new interface driver ums-sddr55
[   18.760000] usbcore: registered new interface driver ums-usbat
[   18.930000] usbcore: registered new interface driver ftdi_sio
[   18.950000] USB Serial support registered for FTDI USB Serial Device
[   18.960000] ftdi_sio: v1.6.0:USB FTDI Serial Converters Driver
[   26.900000] device eth0.1 entered promiscuous mode
[   26.910000] device eth0 entered promiscuous mode
[   26.950000] br-lan: port 1(eth0.1) entered forwarding state
[   26.960000] br-lan: port 1(eth0.1) entered forwarding state
[   26.990000] ramips-wdt: timeout value 60 must be 0 &lt; timeout &lt;= 35, using 35
[   28.960000] br-lan: port 1(eth0.1) entered forwarding state
[   49.040000] jffs2_scan_eraseblock(): End of filesystem marker found at 0x0
[   49.060000] jffs2_build_filesystem(): unlocking the mtd device... done.
[   49.070000] jffs2_build_filesystem(): erasing all blocks after the end marker... done.
[   56.410000] jffs2: notice: (1279) jffs2_build_xattr_subsystem: complete building xattr subsystem, 0 of xdatum (0 unchecked, 0 orphan) and 0 of xref (0 dead, 0 orphan) found.



BusyBox v1.19.4 (2012-12-23 15:19:00 CET) built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 -----------------------------------------------------
 BARRIER BREAKER (Bleeding Edge, r34872)
 -----------------------------------------------------
  * 1/2 oz Galliano         Pour all ingredients into
  * 4 oz cold Coffee        an irish coffee mug filled
  * 1 1/2 oz Dark Rum       with crushed ice. Stir.
  * 2 tsp. Creme de Cacao
 -----------------------------------------------------
root@OpenWrt:/# (Type return to get this prompt)</code></pre></div><h5>Tests</h5><p>I have an MPR-L8 (HAME MPR-A1 clone) board with 4MB Flash and 16 MB SDRAM, purchased <a href="http://www.geekbuying.com/item/3-In-1-3G-150Mbps-Mobile-Wireless-Roster-Router-Broadband-Power-WIFI-Hotspot-Mini-AP-Triple-307247.html">here</a> for $19.</p><p>I used a Linkduino board (Arduino Leonardo-compatible board) requiring kmod-cdc-acm VCOM driver, and a SanDisk Cruzer Fit 16 GB formatted as VFAT.</p><p>Here are the results of the tests I did perform:<br /></p><ul><li><p>Boot is ok, except for 2 small warnings regarding &quot;<em>ramips-wdt</em>&quot; watchdog =&gt; not important</p></li><li><p>Ethernet switch is working: eth0 + eth0.1 + eth0.2 + ping working to/from my PC</p></li><li><p>WiFi is working: when enabled in &quot;<em>/etc/config/wireless</em>&quot; + &quot;<em>wifi up</em>&quot;, I can connect to the &quot;<strong>OpenWrt</strong>&quot; AP and to the router from my PC using &quot;telnet&quot;</p></li><li><p>Red LED is working: blinks slowly during failsafe entry test until system is ready, then on: can be controlled via led-trigger-*</p></li><li><p>Blue LED is working: controlled via led-trigger-netdev on WiFi by default</p></li><li><p>Reset button is working with button hotplug: check by uncommenting the event in &quot;<em>/etc/hotplug2.rules</em>&quot; and creating an executable script &quot;logger $BUTTON $ACTION&quot; in &quot;<em>/etc/hotplug.d/button/buttons</em>&quot; and checking with &quot;<em>logread -f</em>&quot;</p></li><li><p>Failsafe is working, both by &quot;<em>f + enter</em>&quot; on the console or by pressing the reset switch when the red LED starts blinking during boot, then tried to &quot;<em>wget</em>&quot; the firmware from my PC and flash it =&gt; ok</p></li><li><p>unlike the TL-WR703N, the Arduino board attached to the USB host port as a CDC-ACM VCOM device is working flawlessly for hours without problem, displaying an Arduino-generated counter every second using &quot;<em>microcom -s 57600 /dev/ttyACM0</em>&quot;</p></li><li><p>USB power and root hub power can be controlled by &quot;<em>/sys/class/gpio/gpio7/value</em>&quot; and &quot;<em>/sys/class/gpio/gpio12/value</em>&quot; respectively, causing the Arduino board to power on/off and the root hub to show connect/disconnect events in the logs</p></li><li><p>USB mass storage is working too, I was able to mount a VFAT-formatted 16GB USB disk and browse it</p></li></ul><h5>Remaining Problems</h5><p>The 16 MB SDRAM seems very limitating: depending on previous operations, I have seen some serious slowdowns while mounting the USB disk for example, or when turning on WiFi. No crash, but sitting at the prompt for up to minutes <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>I din&#039;t even tried to run LuCI!</p><p>However, the system seems stable as I experienced no crash or kernel oops.</p><p>Merry Christmas <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></p>											<p class="post-edited">(Last edited by <strong>Squonk</strong> on 23 Dec 2012, 20:27)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186853">
				<div class="post-metadata">
					<div class="post-num">Post #88</div>
					<div class="post-author">lizby</div>
					<div class="post-datetime">
						23 Dec 2012, 21:48					</div>
				</div>
				<div class="post-content content">
					<p>Squonk--That&#039;s a very encouraging result--and thanks for the detailed guide.</p><p>swatfa--what flash and ram size do you anticipate?&nbsp; As Squonk indicated, 16mb ram can be limiting, and 8mb flash as opposed to 4 would be preferable.&nbsp; 8 mb flash and 32mb ram would be adequate for many &quot;little computer&quot; purposes, and, as I understand, the cost difference for the greater capacity is not large.</p>											<p class="post-edited">(Last edited by <strong>lizby</strong> on 23 Dec 2012, 21:49)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186854">
				<div class="post-metadata">
					<div class="post-num">Post #89</div>
					<div class="post-author">swatfa</div>
					<div class="post-datetime">
						23 Dec 2012, 21:51					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>lizby wrote:</cite><blockquote><p>Squonk--That&#039;s a very encouraging result--and thanks for the detailed guide.</p><p>swatfa--what flash and ram size do you anticipate?&nbsp; As Squonk indicated, 16mb ram can be limiting, and 8mb flash as opposed to 4 would be preferable.&nbsp; 8 mb flash and 32mb ram would be adequate for many &quot;little computer&quot; purposes, and, as I understand, the cost difference for the greater capacity is not large.</p></blockquote></div><p>Our devices come with 8mb flash and 32mb ram</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186856">
				<div class="post-metadata">
					<div class="post-num">Post #90</div>
					<div class="post-author">swatfa</div>
					<div class="post-datetime">
						23 Dec 2012, 22:05					</div>
				</div>
				<div class="post-content content">
					<p>Also can people please advise on what would be the best packages to add to the openwrt Trunk on the device?</p><p>I was thinking the following;<br />- Shairport (for airplay streaming from Iphone)<br />- Opencloud or some form of cloud service (connect usb and share files on the web)<br />- OpenVPN client<br />- Webcam support<br />- internet radio<br />- Luci<br />- ip6<br />- 3G</p><p>Now due to limitations of the 8mb flash. Im assuming only some of thoose packages can be loaded and the rest would have to be on a usb stick maybe. Or perhaps the 8mb might be sufficient. I would have to check with the developer im working with</p><p>Can anyone advise on my package selections? Any additions or removals?<br />Just trying to get an idea of what packages would be popular.</p>											<p class="post-edited">(Last edited by <strong>swatfa</strong> on 23 Dec 2012, 22:17)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186861">
				<div class="post-metadata">
					<div class="post-num">Post #91</div>
					<div class="post-author">lizby</div>
					<div class="post-datetime">
						23 Dec 2012, 22:39					</div>
				</div>
				<div class="post-content content">
					<p>By webcam support do you mean mjpg-streamer?</p><p>For serial, picocom kmod-usb-serial kmod-usb-serial-pl2303 kmod-usb-serial-cp210x kmod-usb-serial-ch341 kmod-usb-serial-ftdi coreutils-stty (coreutils-stty can be omitted if &quot;stty&quot; is checked in busybox)</p><p>For scp transfer of files, openssh-sftp-server</p><p>All that is needed for usb storage, vfat, ext2, ext3, fdisk, usbutils</p><p>For editing, nano</p><p>For easy emailing, ssmtp</p><p>gpio support.</p><p>i2c support:&nbsp; kmod-i2c-core i2c-tools </p><p>I don&#039;t know the size of the programs you intend to include, but the above will fit in 4mb with the exception of nano and i2c (I&#039;ve never had an openwrt device which easily supported i2c).</p><p>Of course, people can roll their own.&nbsp; If you base your firmware on a release, rather than trunk, people can install additional programs with opkg--with trunk, incompatibilities may develop over time, expecially as libraries evolve).</p>											<p class="post-edited">(Last edited by <strong>lizby</strong> on 23 Dec 2012, 22:56)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186863">
				<div class="post-metadata">
					<div class="post-num">Post #92</div>
					<div class="post-author">swatfa</div>
					<div class="post-datetime">
						23 Dec 2012, 22:53					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>lizby wrote:</cite><blockquote><p>Of course, people can roll their own.&nbsp; If you base your firmware on a release, rather than trunk, people can add additional programs with opkg.</p></blockquote></div><p>Yes mjpg streamer</p><p>At this stage we have only been successful in compiling the trunk to work with our device. There is no indicator at this stage whether or not a release edition firmware will be compiled successfully or not before our launch date. It may have to be a case of compiling each package separatly. I will have to confirm with the developer im working with if there is any possibility of a release firmware</p>											<p class="post-edited">(Last edited by <strong>swatfa</strong> on 23 Dec 2012, 22:59)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186956">
				<div class="post-metadata">
					<div class="post-num">Post #93</div>
					<div class="post-author">swatfa</div>
					<div class="post-datetime">
						25 Dec 2012, 10:10					</div>
				</div>
				<div class="post-content content">
					<p>Regarding a second USB port. One option that may be possible is to replace the usb port with two micro usb ports ( not including the power micro usb on the side). </p><p>This is the only solution to get two usb ports with the limited space without a major redesign of the pcb or casing. Would this be useful? This would mean using a micro usb to normal usb converter when connecting devices so it might be a nuisance. I will try in the meantime to see if the factory can think of a way to squeeze two normal usb ports but it might be unlikely</p><p>or alternatively i can offer a usb hub as an accessory. something like this:<br /><a href="http://cdn-static.zdnet.com/i/story/60/19/001448/drbott-t3-usb-hub.jpg">http://cdn-static.zdnet.com/i/story/60/ … sb-hub.jpg</a></p>											<p class="post-edited">(Last edited by <strong>swatfa</strong> on 25 Dec 2012, 10:16)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186967">
				<div class="post-metadata">
					<div class="post-num">Post #94</div>
					<div class="post-author">Squonk</div>
					<div class="post-datetime">
						25 Dec 2012, 14:43					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>swatfa wrote:</cite><blockquote><p>Regarding a second USB port. One option that may be possible is to replace the usb port with two micro usb ports ( not including the power micro usb on the side). </p><p>This is the only solution to get two usb ports with the limited space without a major redesign of the pcb or casing. Would this be useful? This would mean using a micro usb to normal usb converter when connecting devices so it might be a nuisance. I will try in the meantime to see if the factory can think of a way to squeeze two normal usb ports but it might be unlikely</p><p>or alternatively i can offer a usb hub as an accessory. something like this:<br /><a href="http://cdn-static.zdnet.com/i/story/60/19/001448/drbott-t3-usb-hub.jpg">http://cdn-static.zdnet.com/i/story/60/ … sb-hub.jpg</a></p></blockquote></div><p>AFAIK, the RT5350 SoC features only a single USB port.</p><p>Adding more USB ports would require adding an USB hub chip onboard, or an external USB hub.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186969">
				<div class="post-metadata">
					<div class="post-num">Post #95</div>
					<div class="post-author">swatfa</div>
					<div class="post-datetime">
						25 Dec 2012, 15:15					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Squonk wrote:</cite><blockquote><div class="quotebox"><cite>swatfa wrote:</cite><blockquote><p>Regarding a second USB port. One option that may be possible is to replace the usb port with two micro usb ports ( not including the power micro usb on the side). </p><p>This is the only solution to get two usb ports with the limited space without a major redesign of the pcb or casing. Would this be useful? This would mean using a micro usb to normal usb converter when connecting devices so it might be a nuisance. I will try in the meantime to see if the factory can think of a way to squeeze two normal usb ports but it might be unlikely</p><p>or alternatively i can offer a usb hub as an accessory. something like this:<br /><a href="http://cdn-static.zdnet.com/i/story/60/19/001448/drbott-t3-usb-hub.jpg">http://cdn-static.zdnet.com/i/story/60/ … sb-hub.jpg</a></p></blockquote></div><p>AFAIK, the RT5350 SoC features only a single USB port.</p><p>Adding more USB ports would require adding an USB hub chip onboard, or an external USB hub.</p></blockquote></div><p>In that case i think a small external usb hub as an accessory is the easiest option<br />Ive also forwarded the gpios layout you suggested to the factory. Will let you know if its possible or not once i get feedback from them</p>											<p class="post-edited">(Last edited by <strong>swatfa</strong> on 25 Dec 2012, 15:16)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186979">
				<div class="post-metadata">
					<div class="post-num">Post #96</div>
					<div class="post-author">lizby</div>
					<div class="post-datetime">
						25 Dec 2012, 19:14					</div>
				</div>
				<div class="post-content content">
					<p>That T3Hub is the right form factor, but the only one I found on ebay was outrageously expensive--$30US.</p><p>At 2-3$ it would be good.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186986">
				<div class="post-metadata">
					<div class="post-num">Post #97</div>
					<div class="post-author">Squonk</div>
					<div class="post-datetime">
						25 Dec 2012, 20:22					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>lizby wrote:</cite><blockquote><p>That T3Hub is the right form factor, but the only one I found on ebay was outrageously expensive--$30US.</p><p>At 2-3$ it would be good.</p></blockquote></div><p>If 2 downstream ports <strong>+ microSD card</strong> is enough for your needs, you may be interested in this one:<br /><span class="postimg"><img src="http://www.pearl.de/images/large/px5294_2_2.jpg" alt="http://www.pearl.de/images/large/px5294_2_2.jpg" /></span></p><p>Available from <a href="http://www.pearl.fr/peripheriques/hubs-usb/hubs/mini-hub-2-ports-usb-2_0-avec-lecteur-de-cartes_PX5294.html">here</a> (in French) or <a href="http://www.pearl.de/a-PX5294-1133.shtml">here</a> (in German), and probably from more places too.</p>											<p class="post-edited">(Last edited by <strong>Squonk</strong> on 25 Dec 2012, 20:24)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186990">
				<div class="post-metadata">
					<div class="post-num">Post #98</div>
					<div class="post-author">lizby</div>
					<div class="post-datetime">
						25 Dec 2012, 20:40					</div>
				</div>
				<div class="post-content content">
					<p>Thanks, Squonk, two ports would be fine, but price is too high, and shipping to Canada would be even higher.&nbsp; I just ordered two more of these:&nbsp; <a href="http://www.ebay.com/itm/280960565116?ssPageName=STRK:MEWNX:IT&amp;_trksid=p3984.m1497.l2649">http://www.ebay.com/itm/280960565116?ss … 1497.l2649</a></p><p>The form factor is not as good, but for $1.55, shipped, I can live with it.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186994">
				<div class="post-metadata">
					<div class="post-num">Post #99</div>
					<div class="post-author">swatfa</div>
					<div class="post-datetime">
						25 Dec 2012, 21:07					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Squonk wrote:</cite><blockquote><div class="quotebox"><cite>lizby wrote:</cite><blockquote><p>That T3Hub is the right form factor, but the only one I found on ebay was outrageously expensive--$30US.</p><p>At 2-3$ it would be good.</p></blockquote></div><p>If 2 downstream ports <strong>+ microSD card</strong> is enough for your needs, you may be interested in this one:<br /><span class="postimg"><img src="http://www.pearl.de/images/large/px5294_2_2.jpg" alt="http://www.pearl.de/images/large/px5294_2_2.jpg" /></span></p><p>Available from <a href="http://www.pearl.fr/peripheriques/hubs-usb/hubs/mini-hub-2-ports-usb-2_0-avec-lecteur-de-cartes_PX5294.html">here</a> (in French) or <a href="http://www.pearl.de/a-PX5294-1133.shtml">here</a> (in German), and probably from more places too.</p></blockquote></div><p>Thanks Squonk. Thats actually quite perfect. <br />Not sure whether or not the SD card would be recognized in Openwrt. <br />Nonetheless the form factor and size would be ideal. I will try to contact the supplier and see if they can allocate for bulk orders</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186998">
				<div class="post-metadata">
					<div class="post-num">Post #100</div>
					<div class="post-author">Squonk</div>
					<div class="post-datetime">
						25 Dec 2012, 21:43					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>swatfa wrote:</cite><blockquote><p>Thanks Squonk. Thats actually quite perfect. <br />Not sure whether or not the SD card would be recognized in Openwrt, no specific driver is required.<br />Nonetheless the form factor and size would be ideal. I will try to contact the supplier and see if they can allocate for bulk orders</p></blockquote></div><p>There is no problem having the SDCard recognized by OpenWrt: it is just seen as an USB disk.</p><p>However, it is no longer available from the original manufacturer (DeLock from TW), but there are many clones built around the same Alcor Micro&#039;s AU6350 USB hub + SDCard reader combo chip that I would also recommend for having this functionality built-in.</p>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 4 of 28</div><nav><ul><li><a href="viewtopic.php%3Fid=37002&amp;p=1.html">1</a></li><li><a href="viewtopic.php%3Fid=37002&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=37002&amp;p=3.html">3</a></li><li class="pagination-current"><span>4</span></li><li><a href="viewtopic.php%3Fid=37002&amp;p=5.html">5</a></li><li><a href="viewtopic.php%3Fid=37002&amp;p=6.html">6</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=37002&amp;p=28.html">28</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0.001 -->

</body>
</html>