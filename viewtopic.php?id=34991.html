<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Possible VLAN Configuration</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 14 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p158621">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Mandrake981</div>
					<div class="post-datetime">
						25 Feb 2012, 00:55					</div>
				</div>
				<div class="post-content content">
					<p>Hi guys,</p><p>I am wondering if it&#039;s possible to split out hosts in a VLAN by MAC address - all of them would be on wireless. I&#039;d just basically like to be able to split some hosts off from the rest - so that the hosts on one VLAN can see each other, and the hosts on the other VLAN can see each other, but no-one from one VLAN can see anyone on the other VLAN and vice versa. Unfortunately, they are all on wireless, so I haven&#039;t found a lot of info on doing this kind of thing. If anyone has any insight, please feel free to share.</p><p>Thanks,<br />Randall.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p158637">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						25 Feb 2012, 11:05					</div>
				</div>
				<div class="post-content content">
					<p>The easiest way is to separate them by different SSIDs. And, BTW, MAC addresses are not reliable and can be modified.</p><p><a href="https://forum.openwrt.org/viewtopic.php?id=33248">OpenWrt / SSID with multip VLAN&#039;s</a><br /><a href="http://translate.google.com/translate?sl=auto&amp;tl=en&amp;u=http://rpc.one.pl/index.php/lista-artykulow/34-openwrt/82-dynamiclvlan-w-openwrt-z-wykorzystaniem-hostapd">Dynamic VLANs using hostapd OpenWrt</a> by rpc<br /></p><div class="quotebox"><cite>rpc wrote:</cite><blockquote><p>Dynamic VLAN is a configuration that enables us to authorize the user and automatically assigned to a defined network for the VLAN. This results in complete isolation and control of the various working groups such as the company.</p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p158668">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Mandrake981</div>
					<div class="post-datetime">
						25 Feb 2012, 17:55					</div>
				</div>
				<div class="post-content content">
					<p>Ah, OK, that makes sense. So I&#039;d still need to set up a separate VLAN, but then assign that to the new SSID? If that&#039;s the case, then that sounds reasonable. I guess that essentially, it&#039;d be the same thing as a &quot;guest&quot; access... I hadn&#039;t even thought about it that way.</p><p>As far as the MAC address being able to be duped, I don&#039;t think that&#039;s an issue. It&#039;s family - and I know they don&#039;t know how to change it. I just want to limit what they have access to, as things like printers aren&#039;t cheap to keep ink in. It&#039;s not a problem right now, but with these items not even showing up on their network, it won&#039;t be an issue whatsoever!</p><p>Thanks for the info... It&#039;s much appreciated.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p158669">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Mandrake981</div>
					<div class="post-datetime">
						25 Feb 2012, 17:56					</div>
				</div>
				<div class="post-content content">
					<p>Ah, posted too quick. I didn&#039;t pay attention to the links - just your post. Sorry.</p><p>Thank you for the links. I am following them now :-)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p158681">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						25 Feb 2012, 20:35					</div>
				</div>
				<div class="post-content content">
					<p><a href="http://wiki.openwrt.org/doc/recipes/guest-wlan">Configure a guest WLAN - OpenWrt Wiki</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p158683">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Mandrake981</div>
					<div class="post-datetime">
						25 Feb 2012, 20:38					</div>
				</div>
				<div class="post-content content">
					<p>Great, thank you. I am actually looking into the Radius setup that allows separate VLAN&#039;s - that&#039;s a perfect solution and seems easy enough to implement. I am in the process of setting it up right now, so I&#039;ll know soon how we&#039;re going to fare.</p><p>Thanks again for the links and info. You&#039;ve helped a lot.</p><p>Randall</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p159162">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">ashkanull</div>
					<div class="post-datetime">
						1 Mar 2012, 00:07					</div>
				</div>
				<div class="post-content content">
					<p>apply this patch to your vlan_init.c and hostapd.sh referring to&nbsp; <a href="http://patchwork.openwrt.org/patch/1257/">[OpenWrt-Devel,1/2] hostapd dynamic vlans</a> and&nbsp; <a href="http://patchwork.openwrt.org/patch/1261/">[OpenWrt-Devel,3/3] hostapd dynamic vlans</a> <br /></p><div class="quotebox"><cite>/packages/hostapd/patches/800-dynamic_vlan.patch wrote:</cite><blockquote><p>Index: hostapd-20111103/src/ap/vlan_init.c<br />===================================================================<br />--- hostapd-20111103.orig/src/ap/vlan_init.c&nbsp; &nbsp; 2011-12-04 14:52:34.927944410 -0800<br />+++ hostapd-20111103/src/ap/vlan_init.c&nbsp; &nbsp; 2011-12-04 14:56:13.895944447 -0800<br />@@ -403,8 +403,8 @@</p><p> &nbsp; &nbsp; /* Determine if a suitable vlan device already exists. */</p><p>-&nbsp; &nbsp; os_snprintf(if_request.device1, sizeof(if_request.device1), &quot;vlan%d&quot;,<br />-&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;vid);<br />+&nbsp; &nbsp; os_snprintf(if_request.device1, sizeof(if_request.device1), &quot;%s.%d&quot;,<br />+&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;if_name, vid);</p><p> &nbsp; &nbsp; if_request.cmd = _GET_VLAN_VID_CMD;</p><p>@@ -487,7 +487,7 @@<br /> &nbsp; &nbsp; while (vlan) {<br /> &nbsp; &nbsp; &nbsp; &nbsp; if (os_strcmp(ifname, vlan-&gt;ifname) == 0) {</p><p>-&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; os_snprintf(br_name, sizeof(br_name), &quot;brvlan%d&quot;,<br />+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; os_snprintf(br_name, sizeof(br_name), &quot;br-vlan%d&quot;,<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;vlan-&gt;vlan_id);</p><p> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!br_addbr(br_name))<br />@@ -501,7 +501,7 @@<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; vlan-&gt;clean |= DVLAN_CLEAN_VLAN;</p><p> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; os_snprintf(vlan_ifname, sizeof(vlan_ifname),<br />-&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;&quot;vlan%d&quot;, vlan-&gt;vlan_id);<br />+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;&quot;%s.%d&quot;, tagged_interface, vlan-&gt;vlan_id);</p><p> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!br_addif(br_name, vlan_ifname))<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; vlan-&gt;clean |= DVLAN_CLEAN_VLAN_PORT;<br />@@ -534,7 +534,7 @@</p><p> &nbsp; &nbsp; while (vlan) {<br /> &nbsp; &nbsp; &nbsp; &nbsp; if (os_strcmp(ifname, vlan-&gt;ifname) == 0) {<br />-&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; os_snprintf(br_name, sizeof(br_name), &quot;brvlan%d&quot;,<br />+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; os_snprintf(br_name, sizeof(br_name), &quot;br-vlan%d&quot;,<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;vlan-&gt;vlan_id);</p><p> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (vlan-&gt;clean &amp; DVLAN_CLEAN_WLAN_PORT)<br />@@ -542,7 +542,7 @@</p><p> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (tagged_interface) {<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; os_snprintf(vlan_ifname, sizeof(vlan_ifname),<br />-&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;&quot;vlan%d&quot;, vlan-&gt;vlan_id);<br />+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;&quot;%s.%d&quot;, tagged_interface, vlan-&gt;vlan_id);<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (vlan-&gt;clean &amp; DVLAN_CLEAN_VLAN_PORT)<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; br_delif(br_name, vlan_ifname);<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ifconfig_down(vlan_ifname);<br />@@ -682,7 +682,7 @@<br /> &nbsp; &nbsp; if (priv == NULL)<br /> &nbsp; &nbsp; &nbsp; &nbsp; return NULL;</p><p>-&nbsp; &nbsp; vlan_set_name_type(VLAN_NAME_TYPE_PLUS_VID_NO_PAD);<br />+&nbsp; &nbsp; vlan_set_name_type(VLAN_NAME_TYPE_RAW_PLUS_VID_NO_PAD);</p><p> &nbsp; &nbsp; priv-&gt;s = socket(PF_NETLINK, SOCK_RAW, NETLINK_ROUTE);<br /> &nbsp; &nbsp; if (priv-&gt;s &lt; 0) {</p></blockquote></div>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>