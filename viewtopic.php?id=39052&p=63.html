<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> mwan3; multi-wan policy routing (general topic)</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 22 May 2013 and 6 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 63 of 65</div><nav><ul><li><a href="viewtopic.php%3Fid=39052&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=39052&amp;p=61.html">61</a></li><li><a href="viewtopic.php%3Fid=39052&amp;p=62.html">62</a></li><li class="pagination-current"><span>63</span></li><li><a href="viewtopic.php%3Fid=39052&amp;p=64.html">64</a></li><li><a href="viewtopic.php%3Fid=39052&amp;p=65.html">65</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p316413">
				<div class="post-metadata">
					<div class="post-num">Post #1551</div>
					<div class="post-author">cpalm</div>
					<div class="post-datetime">
						24 Mar 2016, 01:26					</div>
				</div>
				<div class="post-content content">
					<p>Dear Forum-Experts,</p><p>I want to make use of mwan3 to simply offer IP services via openvpn. I upgraded from individual scripts on Attitude Adjustment to mwan3 on Chaos Calmer (TP-Link WDR4300). But unfortunately all I see is that all my traffic simply goes out via the gateway with the lowest metric.</p><p>Here is what I&#039;m trying to achieve:<br />Openwrt is behind an internet router and is getting a private IP. It uses this to establish a connection to an OpenVPN Internet provider where I get a small subnet of public IP&#039;s. My clients (and servers) should stick with their private IP&#039;s. But if services are accessed from outside then my hope was that via the conntrack mechanism the answer goes out via the route it came in (via conntrack).<br />Also I tried to set fixed rules but it seems they also have no effect.</p><p>Interfaces are up and I can selectively ping to the outside world with each one. Also mwan3 (v 1.6.2) shows no errors or warnings. My specialty is that I don&#039;t have WAN interfaces since the router serves in the same subnet as the public internet router. I&#039;m using the LAN interface for getting an internal IP and also for establishing then OpenVPN connection.</p><p>Can anybody please help me? I&#039;ve invested so many hours without solving this, that I&#039;m now so desparate that I would even pay some bucks for help...</p><p>Thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p316420">
				<div class="post-metadata">
					<div class="post-num">Post #1552</div>
					<div class="post-author">rafareino</div>
					<div class="post-datetime">
						24 Mar 2016, 02:36					</div>
				</div>
				<div class="post-content content">
					<p>Hi guys,</p><p>I am using mwan3 to set a failover between my two ISPs, one of which is a <strong>fixed landline</strong> broadband connection, but it is not that reliable; the second one is a 4g <strong>mobile connection</strong> (in a external modem plugged thru ether), but it has a low data limit.</p><p>However, when I access facebook, twitter and whatsapp (except voip) thru this interface, <strong>this data do not count against my data usage</strong> at all.</p><p>I need save this mobile connection data only to use when my first ISP is out of service.</p><p>My idea:<br />I will put <strong>all my facebook/whatsapp use in this mobile interface</strong>, and save the other connection bandwidth to other services, to accomplish that I enabled the &#039;dns to syslog&#039; and grepped all the requests into a text file, them summarized this file into a list to configure a ipset like that:</p><div class="codebox"><pre><code>ipset=/facebook.com/facebook.net/fbcdn-creative-a.akamaihd.net/fbcdn-dragon-a.akamaihd.net/fbcdn-photos-a-a.akamaihd.net/fbcdn-photos-b-a.akamaihd.net/fbcdn-photos-c-a.akamaihd.net/fbcdn-photos-d-a.akamaihd.net/fbcdn-photos-e-a.akamaihd.net/fbcdn-photos-f-a.akamaihd.net/fbcdn-photos-g-a.akamaihd.net/fbcdn-photos-h-a.akamaihd.net/fbcdn-profile-a.akamaihd.net/fbcdn-sphotos-a-a.akamaihd.net/fbcdn-sphotos-b-a.akamaihd.net/fbcdn-sphotos-c-a.akamaihd.net/fbcdn-sphotos-d-a.akamaihd.net/fbcdn-sphotos-e-a.akamaihd.net/fbcdn-sphotos-f-a.akamaihd.net/fbcdn-sphotos-g-a.akamaihd.net/fbcdn-sphotos-h-a.akamaihd.net/fbcdn-video-a-a.akamaihd.net/fbcdn-video-b-a.akamaihd.net/fbcdn-video-c-a.akamaihd.net/fbcdn-video-d-a.akamaihd.net/fbcdn-video-e-a.akamaihd.net/fbcdn-video-f-a.akamaihd.net/fbcdn-video-g-a.akamaihd.net/fbcdn-video-h-a.akamaihd.net/fbcdn-video-i-a.akamaihd.net/fbcdn-video-j-a.akamaihd.net/fbcdn-video-k-a.akamaihd.net/fbcdn-video-l-a.akamaihd.net/fbcdn-video-m-a.akamaihd.net/fbcdn-video-n-a.akamaihd.net/fbcdn-video-o-a.akamaihd.net/fbcdn-video-p-a.akamaihd.net/fbcdn-vthumb-a.akamaihd.net/fbcdn.net/fbexternal-a.akamaihd.net/fbstatic-a.akamaihd.net/facebook</code></pre></div><p>Yeah, I got 47 dns entries, but it won&#039;t work, my dnsmasq fails miserably to start and my client connections can&#039;t get a valid IP anymore.</p><p>So what is the maximum number of domains I could add to a single ipset hash?</p><p>The right way to get above this limit is dividing the list into a few ipsets (fb1, fb2, fb3 and so on) and replicate it in mwan3 rules?</p><p>Is there any way I could grab <strong>fbstatic*</strong> and/or <strong>fbcdn*</strong> instead of <strong>*.facebook.com</strong>?</p><p>Do you know if it is secure to get <strong>akamaihd.net</strong>? I mean it is a cdn provider, and it could provide storage to a lot of other services. How could I select only true facebook trafic to this interface?</p>											<p class="post-edited">(Last edited by <strong>rafareino</strong> on 24 Mar 2016, 02:38)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p316794">
				<div class="post-metadata">
					<div class="post-num">Post #1553</div>
					<div class="post-author">bufooo132</div>
					<div class="post-datetime">
						26 Mar 2016, 13:02					</div>
				</div>
				<div class="post-content content">
					<p>Hello guys,</p><p>I would like to use mwan3 to load balance between 2 ISPs (DSL and WIFI provider). WIFI provider is connected to the WAN physical interface and it is port 4 in vswitch, interface is called eth1. DSL provider is connected to the PORT4 physical interface and it is port 0 in vswitch, interface is called eth0.2. I named this interface wan2 and I have assigned it to the same FW rules as wan. </p><p>I&#039;m connected to both ISPs with static addresses wan2: 192.168.2.2 and wan 10.78.4.152.</p><p>My problem is that wan2 is always offline and I don&#039;t know why. The IP I&#039;m using is 100% valid because when I test it my laptop I can connect to the Internet.</p><p>I&#039;m providing you with output of troubleshooting page bellow.</p><p>Any hint would be very helpful.</p><p>Thanks Bufo</p><p>UPDATE #1 my vlan2 is wrongly configured. I can&#039;t ping its default GW 192.168.2.1. I think the interface eth0.2 is badly configured or my router LINKSYS WRT-160NL doesn&#039;t support it.<br /></p><div class="codebox"><pre><code>Software versions : 

OpenWrt - OpenWrt Chaos Calmer 15.05
LuCI - git-15.248.30277-3836b45

mwan3 - 1.6-2
mwan3-luci - 1.4-3

Output of &quot;cat /etc/config/mwan3&quot; : 

config interface &#039;wan&#039;
    option enabled &#039;1&#039;
    option reliability &#039;2&#039;
    option count &#039;1&#039;
    option timeout &#039;2&#039;
    option interval &#039;5&#039;
    option down &#039;3&#039;
    option up &#039;8&#039;
    list track_ip &#039;8.8.8.8&#039;
    list track_ip &#039;8.8.4.4&#039;

config interface &#039;wan2&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option timeout &#039;2&#039;
    option interval &#039;5&#039;
    option down &#039;3&#039;
    option up &#039;8&#039;
    option enabled &#039;1&#039;
    list track_ip &#039;8.8.8.8&#039;
    list track_ip &#039;8.8.4.4&#039;

config member &#039;wan_m1_w3&#039;
    option interface &#039;wan&#039;
    option metric &#039;1&#039;
    option weight &#039;3&#039;

config member &#039;wan_m2_w3&#039;
    option interface &#039;wan&#039;
    option metric &#039;2&#039;
    option weight &#039;3&#039;

config member &#039;wan2_m1_w2&#039;
    option interface &#039;wan2&#039;
    option metric &#039;1&#039;
    option weight &#039;2&#039;

config member &#039;wan2_m2_w2&#039;
    option interface &#039;wan2&#039;
    option metric &#039;2&#039;
    option weight &#039;2&#039;

config policy &#039;wan_only&#039;
    list use_member &#039;wan_m1_w3&#039;

config policy &#039;wan2_only&#039;
    list use_member &#039;wan2_m1_w2&#039;

config policy &#039;balanced&#039;
    list use_member &#039;wan_m1_w3&#039;
    list use_member &#039;wan2_m1_w2&#039;

config policy &#039;wan_wan2&#039;
    list use_member &#039;wan_m1_w3&#039;
    list use_member &#039;wan2_m2_w2&#039;

config policy &#039;wan2_wan&#039;
    list use_member &#039;wan_m2_w3&#039;
    list use_member &#039;wan2_m1_w2&#039;

config rule &#039;youtube&#039;
    option sticky &#039;1&#039;
    option ipset &#039;youtube&#039;
    option dest_port &#039;80,443&#039;
    option proto &#039;tcp&#039;
    option use_policy &#039;balanced&#039;

config rule &#039;https&#039;
    option sticky &#039;1&#039;
    option dest_port &#039;443&#039;
    option proto &#039;tcp&#039;
    option use_policy &#039;balanced&#039;

config rule &#039;default_rule&#039;
    option dest_ip &#039;0.0.0.0/0&#039;
    option use_policy &#039;balanced&#039;

Output of &quot;cat /etc/config/network&quot; : 

config interface &#039;loopback&#039;
    option ifname &#039;lo&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;127.0.0.1&#039;
    option netmask &#039;255.0.0.0&#039;

config globals &#039;globals&#039;
    option ula_prefix &#039;fd93:c8ca:ca56::/48&#039;

config interface &#039;lan&#039;
    option ifname &#039;eth0&#039;
    option force_link &#039;1&#039;
    option type &#039;bridge&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;192.168.1.1&#039;
    option netmask &#039;255.255.255.0&#039;
    option delegate &#039;0&#039;
    option dns &#039;8.8.8.8 8.8.4.4&#039;

config interface &#039;wan&#039;
    option ifname &#039;eth1&#039;
    option _orig_ifname &#039;eth1&#039;
    option _orig_bridge &#039;false&#039;
    option proto &#039;static&#039;
    option delegate &#039;0&#039;
    option ipaddr &#039;10.78.4.152&#039;
    option netmask &#039;255.255.0.0&#039;
    option gateway &#039;10.78.255.10&#039;
    option broadcast &#039;10.78.255.255&#039;
    option dns &#039;8.8.8.8 8.8.4.4&#039;
    option metric &#039;10&#039;

config switch
    option name &#039;switch0&#039;
    option reset &#039;1&#039;
    option enable_vlan &#039;1&#039;

config switch_vlan
    option device &#039;switch0&#039;
    option vlan &#039;1&#039;
    option vid &#039;1&#039;
    option ports &#039;4 5t&#039;

config switch_vlan
    option device &#039;switch0&#039;
    option vlan &#039;2&#039;
    option vid &#039;2&#039;
    option ports &#039;0 5t&#039;

config interface &#039;wan2&#039;
    option proto &#039;static&#039;
    option ifname &#039;eth0.2&#039;
    option ipaddr &#039;192.168.2.2&#039;
    option netmask &#039;255.255.255.0&#039;
    option gateway &#039;192.168.2.1&#039;
    option dns &#039;8.8.8.8 8.8.4.4&#039;
    option delegate &#039;0&#039;
    option metric &#039;20&#039;

Output of &quot;ifconfig&quot; : 

br-lan    Link encap:Ethernet  HWaddr 00:01:36:22:7E:F1  
          inet addr:192.168.1.1  Bcast:192.168.1.255  Mask:255.255.255.0
          inet6 addr: fe80::201:36ff:fe22:7ef1/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:13935 errors:0 dropped:4 overruns:0 frame:0
          TX packets:12985 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:5822629 (5.5 MiB)  TX bytes:6847588 (6.5 MiB)

eth0      Link encap:Ethernet  HWaddr 00:01:36:22:7E:F1  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:1031 errors:0 dropped:4 overruns:0 frame:0
          TX packets:1357 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:120255 (117.4 KiB)  TX bytes:211988 (207.0 KiB)
          Interrupt:4 

eth0.2    Link encap:Ethernet  HWaddr 00:01:36:22:7E:F1  
          inet addr:192.168.2.2  Bcast:192.168.2.255  Mask:255.255.255.0
          inet6 addr: fe80::201:36ff:fe22:7ef1/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:382 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:0 (0.0 B)  TX bytes:16488 (16.1 KiB)

eth1      Link encap:Ethernet  HWaddr 00:01:36:22:7E:F2  
          inet addr:10.78.4.152  Bcast:10.78.255.255  Mask:255.255.0.0
          inet6 addr: fe80::201:36ff:fe22:7ef2/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:12991 errors:0 dropped:17 overruns:0 frame:0
          TX packets:12226 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:6042861 (5.7 MiB)  TX bytes:5827385 (5.5 MiB)
          Interrupt:5 

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:337 errors:0 dropped:0 overruns:0 frame:0
          TX packets:337 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:23279 (22.7 KiB)  TX bytes:23279 (22.7 KiB)

wlan0     Link encap:Ethernet  HWaddr 00:01:36:22:7E:F1  
          inet6 addr: fe80::201:36ff:fe22:7ef1/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:13567 errors:0 dropped:0 overruns:0 frame:0
          TX packets:13346 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:6034402 (5.7 MiB)  TX bytes:7117549 (6.7 MiB)

Output of &quot;route -n&quot; : 

Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
0.0.0.0         10.78.255.10    0.0.0.0         UG    10     0        0 eth1
0.0.0.0         192.168.2.1     0.0.0.0         UG    20     0        0 eth0.2
10.78.0.0       0.0.0.0         255.255.0.0     U     10     0        0 eth1
192.168.1.0     0.0.0.0         255.255.255.0   U     0      0        0 br-lan
192.168.2.0     0.0.0.0         255.255.255.0   U     20     0        0 eth0.2

Output of &quot;ip rule show&quot; : 

0:    from all lookup 128 
1:    from all lookup local 
1001:    from all iif eth1 lookup main 
1002:    from all iif eth0.2 lookup main 
2001:    from all fwmark 0x100/0xff00 lookup 1 
2002:    from all fwmark 0x200/0xff00 lookup 2 
2253:    from all fwmark 0xfd00/0xff00 blackhole
2254:    from all fwmark 0xfe00/0xff00 unreachable
32766:    from all lookup main 
32767:    from all lookup default

Output of &quot;ip route list table 1-250&quot; : 

1
default via 10.78.255.10 dev eth1 
2
default via 192.168.2.1 dev eth0.2

Firewall default output policy (must be ACCEPT) : 

ACCEPT

Output of &quot;iptables -L -t mangle -v -n&quot; : 

Chain PREROUTING (policy ACCEPT 300 packets, 132K bytes)
 pkts bytes target     prot opt in     out     source               destination         
  367  152K mwan3_hook  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
  300  132K fwmark     all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain INPUT (policy ACCEPT 85 packets, 7620 bytes)
 pkts bytes target     prot opt in     out     source               destination         

Chain FORWARD (policy ACCEPT 214 packets, 124K bytes)
 pkts bytes target     prot opt in     out     source               destination         
  214  124K mssfix     all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain OUTPUT (policy ACCEPT 133 packets, 37011 bytes)
 pkts bytes target     prot opt in     out     source               destination         
  145 37771 mwan3_hook  all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain POSTROUTING (policy ACCEPT 347 packets, 161K bytes)
 pkts bytes target     prot opt in     out     source               destination         

Chain fwmark (1 references)
 pkts bytes target     prot opt in     out     source               destination         

Chain mssfix (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    3   180 TCPMSS     tcp  --  *      eth1    0.0.0.0/0            0.0.0.0/0            tcp flags:0x06/0x02 /* wan (mtu_fix) */ TCPMSS clamp to PMTU
   13   720 TCPMSS     tcp  --  *      eth0.2  0.0.0.0/0            0.0.0.0/0            tcp flags:0x06/0x02 /* wan2 (mtu_fix) */ TCPMSS clamp to PMTU

Chain mwan3_connected (2 references)
 pkts bytes target     prot opt in     out     source               destination         
  151 18648 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            match-set mwan3_connected dst MARK or 0xff00

Chain mwan3_hook (2 references)
 pkts bytes target     prot opt in     out     source               destination         
  512  190K CONNMARK   all  --  *      *       0.0.0.0/0            0.0.0.0/0            CONNMARK restore mask 0xff00
   38  2181 mwan3_ifaces  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00
   35  1897 mwan3_connected  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00
   29  1468 mwan3_track  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00
   13   956 mwan3_rules  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00
  512  190K CONNMARK   all  --  *      *       0.0.0.0/0            0.0.0.0/0            CONNMARK save mask 0xff00
  343  153K mwan3_connected  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match ! 0xff00/0xff00

Chain mwan3_iface_wan (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    3   284 MARK       all  --  eth1   *       0.0.0.0/0            0.0.0.0/0            match-set mwan3_connected src mark match 0x0/0xff00 /* default */ MARK or 0xff00
    0     0 MARK       all  --  eth1   *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* wan */ MARK xset 0x100/0xff00

Chain mwan3_iface_wan2 (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MARK       all  --  eth0.2 *       0.0.0.0/0            0.0.0.0/0            match-set mwan3_connected src mark match 0x0/0xff00 /* default */ MARK or 0xff00
    0     0 MARK       all  --  eth0.2 *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* wan2 */ MARK xset 0x200/0xff00

Chain mwan3_ifaces (1 references)
 pkts bytes target     prot opt in     out     source               destination         
   38  2181 mwan3_iface_wan  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00
   33  1833 mwan3_iface_wan2  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00

Chain mwan3_policy_balanced (3 references)
 pkts bytes target     prot opt in     out     source               destination         
    4   350 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 statistic mode random probability 0.39999999991 /* wan2 2 5 */ MARK xset 0x200/0xff00
    6   442 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* wan 3 3 */ MARK xset 0x100/0xff00

Chain mwan3_policy_wan2_only (0 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* wan2 2 2 */ MARK xset 0x200/0xff00

Chain mwan3_policy_wan2_wan (0 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* wan2 2 2 */ MARK xset 0x200/0xff00

Chain mwan3_policy_wan_only (0 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* wan 3 3 */ MARK xset 0x100/0xff00

Chain mwan3_policy_wan_wan2 (0 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* wan 3 3 */ MARK xset 0x100/0xff00

Chain mwan3_rule_https (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    5   276 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 MARK xset 0x200/0xff00
    2   112 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            ! match-set mwan3_sticky_https src,src MARK and 0xffff00ff
    2   112 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 MARK xset 0x100/0xff00
    2   112 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            ! match-set mwan3_sticky_https src,src MARK and 0xffff00ff
    2   112 mwan3_policy_balanced  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00
    5   276 SET        all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match ! 0xfc00/0xfc00 del-set mwan3_sticky_https src,src
    5   276 SET        all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match ! 0xfc00/0xfc00 add-set mwan3_sticky_https src,src

Chain mwan3_rule_youtube (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 MARK xset 0x200/0xff00
    0     0 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            ! match-set mwan3_sticky_youtube src,src MARK and 0xffff00ff
    0     0 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 MARK xset 0x100/0xff00
    0     0 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            ! match-set mwan3_sticky_youtube src,src MARK and 0xffff00ff
    0     0 mwan3_policy_balanced  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00
    0     0 SET        all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match ! 0xfc00/0xfc00 del-set mwan3_sticky_youtube src,src
    0     0 SET        all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match ! 0xfc00/0xfc00 add-set mwan3_sticky_youtube src,src

Chain mwan3_rules (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 mwan3_rule_youtube  tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            match-set youtube dst multiport sports 0:65535 multiport dports 80,443 mark match 0x0/0xff00 /* youtube */
    5   276 mwan3_rule_https  tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            multiport sports 0:65535 multiport dports 443 mark match 0x0/0xff00 /* https */
    8   680 mwan3_policy_balanced  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* default_rule */

Chain mwan3_track (1 references)
 pkts bytes target     prot opt in     out     source               destination         
   16   512 MARK       icmp --  *      *       0.0.0.0/0            0.0.0.0/0            match-set mwan3_track_wan dst icmptype 8 length 32 MARK or 0xff00
   14   448 MARK       icmp --  *      *       0.0.0.0/0            0.0.0.0/0            match-set mwan3_track_wan2 dst icmptype 8 length 32 MARK or 0xff00</code></pre></div>											<p class="post-edited">(Last edited by <strong>bufooo132</strong> on 26 Mar 2016, 18:05)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p318809">
				<div class="post-metadata">
					<div class="post-num">Post #1554</div>
					<div class="post-author">muronghan</div>
					<div class="post-datetime">
						9 Apr 2016, 04:55					</div>
				</div>
				<div class="post-content content">
					<p>mwan3 1.6.3 is perfect! However, run 2.0.2 on Trunk. Found the same configuration on 1.6.3 had different performance (I set ipset for 6,000 net and use ipset as a selection, some of them took un-expected routes). Is there any further development plan for mwan3 on Trunk, or wait until official DD is released?</p>											<p class="post-edited">(Last edited by <strong>muronghan</strong> on 9 Apr 2016, 06:23)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p319350">
				<div class="post-metadata">
					<div class="post-num">Post #1555</div>
					<div class="post-author">Jaska</div>
					<div class="post-datetime">
						12 Apr 2016, 20:02					</div>
				</div>
				<div class="post-content content">
					<p>Hi, does anyone else have problems with youtube not using the correct route? For some reason youtube uses my default route wan1 rather then load balancing it on wan2 and wan3, only way to force it to use wan2 or wan3 is to shutdown the wan1 connection, after that the video loads after 5-10 seconds and start playing. Twitch and other video streaming sites work just fine, is there something hardcoded for youtube on mwan3?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p319427">
				<div class="post-metadata">
					<div class="post-num">Post #1556</div>
					<div class="post-author">muronghan</div>
					<div class="post-datetime">
						13 Apr 2016, 06:22					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Jaska wrote:</cite><blockquote><p>Hi, does anyone else have problems with youtube not using the correct route? For some reason youtube uses my default route wan1 rather then load balancing it on wan2 and wan3, only way to force it to use wan2 or wan3 is to shutdown the wan1 connection, after that the video loads after 5-10 seconds and start playing. Twitch and other video streaming sites work just fine, is there something hardcoded for youtube on mwan3?</p></blockquote></div><p>Do you use ipset as the screening condition to force youtube.com to go thru wan2 or wan3? And what is the version of mwan3 currently installed?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p319492">
				<div class="post-metadata">
					<div class="post-num">Post #1557</div>
					<div class="post-author">Jaska</div>
					<div class="post-datetime">
						13 Apr 2016, 17:40					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>muronghan wrote:</cite><blockquote><p>Do you use ipset as the screening condition to force youtube.com to go thru wan2 or wan3? And what is the version of mwan3 currently installed?</p></blockquote></div><p>I balance everything on ports 80,443. Using ipset makes no difference, I only use ipset to filter some sites that do not work correctly with load balancing (Session gets reset or log out etc.) I have strong feeling that somehow my wan1 ISP cache servers are responsible for overriding my route, thus forcing it to use wan1 instead of wan2&amp;wan3.</p><p>Currently using mwan3 - 1.6-2<br />Chaos Calmer</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p320785">
				<div class="post-metadata">
					<div class="post-num">Post #1558</div>
					<div class="post-author">dktn</div>
					<div class="post-datetime">
						22 Apr 2016, 05:36					</div>
				</div>
				<div class="post-content content">
					<p>Hi everybody<br />I used mwan3 with wan (wired) and wan2(repeater from wifi). I check &quot; mwan3 status was okay&quot;.<br />On my router i had some SSID as AP and a repeater wifi(sta). If there is wifi for router then router work ok, if wifi lost and router can not broadcat wifi(led wifi turn on but search nothing)<br />Then i have to remove repeater wifi then router boradcat wifi as nomal.<br />Does router can not find wifi as a wan2 then this happen?<br />Is there the way make router broad wifi even no wifi for router joint<br />For example:<br />wireless file:<br />config wifi-device &#039;radio0&#039;<br />&nbsp; &nbsp; option type &#039;mac80211&#039;<br />&nbsp; &nbsp; option hwmode &#039;11g&#039;<br />&nbsp; &nbsp; option path &#039;platform/ar933x_wmac&#039;<br />&nbsp; &nbsp; option htmode &#039;HT20&#039;<br />&nbsp; &nbsp; option disabled &#039;0&#039;<br />&nbsp; &nbsp; option country &#039;US&#039;<br />&nbsp; &nbsp; option channel &#039;1&#039;<br />&nbsp; &nbsp; option txpower &#039;18&#039;</p><p>config wifi-iface<br />&nbsp; &nbsp; option device &#039;radio0&#039;<br />&nbsp; &nbsp; option mode &#039;ap&#039;<br />&nbsp; &nbsp; option encryption &#039;none&#039;<br />&nbsp; &nbsp; option ssid &#039;QW&#039;<br />&nbsp; &nbsp; option network &#039;QW&#039;</p><p><strong> config wifi-iface<br />&nbsp; &nbsp; option network &#039;wan2&#039;<br />&nbsp; &nbsp; option ssid &#039;ensure&#039;<br />&nbsp; &nbsp; option encryption &#039;psk2&#039;<br />&nbsp; &nbsp; option device &#039;radio0&#039;<br />&nbsp; &nbsp; option mode &#039;sta&#039;<br />&nbsp; &nbsp; option bssid &#039;C4:6E:1F:A1:1C:EC&#039;<br />&nbsp; &nbsp; option key &#039;7536912345@02s&#039;</strong><br />then:<br />If ssid &quot;ensure&quot; not present (no wifi name &quot;ensure&quot;)<br />router start with no wifi(search nothing).<br />to wifi apear i have to have turn on wifi has name &quot;ensure&quot; or have wireless file like tthis:<br />config wifi-device &#039;radio0&#039;<br />&nbsp; &nbsp; option type &#039;mac80211&#039;<br />&nbsp; &nbsp; option hwmode &#039;11g&#039;<br />&nbsp; &nbsp; option path &#039;platform/ar933x_wmac&#039;<br />&nbsp; &nbsp; option htmode &#039;HT20&#039;<br />&nbsp; &nbsp; option disabled &#039;0&#039;<br />&nbsp; &nbsp; option country &#039;US&#039;<br />&nbsp; &nbsp; option channel &#039;1&#039;<br />&nbsp; &nbsp; option txpower &#039;18&#039;</p><p>config wifi-iface<br />&nbsp; &nbsp; option device &#039;radio0&#039;<br />&nbsp; &nbsp; option mode &#039;ap&#039;<br />&nbsp; &nbsp; option encryption &#039;none&#039;<br />&nbsp; &nbsp; option ssid &#039;QW&#039;<br />&nbsp; &nbsp; option network &#039;QW&#039;</p>											<p class="post-edited">(Last edited by <strong>dktn</strong> on 22 Apr 2016, 16:47)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p322981">
				<div class="post-metadata">
					<div class="post-num">Post #1559</div>
					<div class="post-author">bobptz</div>
					<div class="post-datetime">
						8 May 2016, 17:30					</div>
				</div>
				<div class="post-content content">
					<p>Hi</p><p>Could you tell me how to find out the local network IP of my two modems?&nbsp; The openwrt router has IP: <a href="http://192.168.1.1">http://192.168.1.1</a>.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p323692">
				<div class="post-metadata">
					<div class="post-num">Post #1560</div>
					<div class="post-author">anarchy99</div>
					<div class="post-datetime">
						13 May 2016, 16:03					</div>
				</div>
				<div class="post-content content">
					<p>mwan diagnostics:</p><p>ping -c 3 -W 2 -I l2tp-l2tp 10.10.10.1</p><p>PING 10.10.10.1 (10.10.10.1): 56 data bytes</p><p>--- 10.10.10.1 ping statistics ---<br />3 packets transmitted, 0 packets received, 100% packet loss</p><p>but if i run ping -c 3 -W 2 10.10.10.1from console then i get replies from 10.10.10.1</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324379">
				<div class="post-metadata">
					<div class="post-num">Post #1561</div>
					<div class="post-author">schnecki</div>
					<div class="post-datetime">
						17 May 2016, 22:13					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I&#039;m stuggling with the setup for my openvpn connection. I want all IP addresses with 192.168.1.128 and higher to use the VPN connection, and all below to use my normal ISP. </p><p>So I setup an interface for the vpn and a firewall zone. Still even tough I can ping through the tun0 interface created by the openvpn connection, I am unable to send data through it. Do you have any ideas for me?</p><div class="codebox"><pre><code>root@OpenWrt:~# ping -I tun0 www.google.com
PING www.google.com (217.175.200.123): 56 data bytes
64 bytes from 217.175.200.123: seq=0 ttl=53 time=92.861 ms
64 bytes from 217.175.200.123: seq=1 ttl=53 time=115.204 ms
64 bytes from 217.175.200.123: seq=2 ttl=53 time=90.738 ms
64 bytes from 217.175.200.123: seq=3 ttl=53 time=97.583 ms
64 bytes from 217.175.200.123: seq=4 ttl=53 time=86.359 ms
^C
--- www.google.com ping statistics ---
5 packets transmitted, 5 packets received, 0% packet loss
round-trip min/avg/max = 86.359/96.549/115.204 ms</code></pre></div><div class="codebox"><pre><code>root@OpenWrt:~# route
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
default         192.168.8.1     0.0.0.0         UG    0      0        0 eth0
default         172.16.32.1     0.0.0.0         UG    20     0        0 tun0
172.16.32.0     *               255.255.240.0   U     0      0        0 tun0
192.168.1.0     *               255.255.255.240 U     10     0        0 br-lan
192.168.1.128   *               255.255.255.240 U     20     0        0 br-vpn_2
192.168.8.0     *               255.255.255.0   U     0      0        0 eth0
192.168.8.1     *               255.255.255.255 UH    0      0        0 eth0</code></pre></div><div class="codebox"><pre><code>root@OpenWrt:~# cat /etc/config/mwan3 

config multiwan &#039;config&#039;
    option default_route &#039;wan&#039;
    option enabled &#039;1&#039;

config interface &#039;wan&#039;       
        option enabled &#039;1&#039;     
        list track_ip &#039;8.8.4.4&#039;       
        list track_ip &#039;8.8.8.8&#039;       
        list track_ip &#039;208.67.222.222&#039;
        list track_ip &#039;208.67.220.220&#039;
        option reliability &#039;2&#039;
        option count &#039;1&#039;   
        option timeout &#039;2&#039; 
        option interval &#039;5&#039;
        option down &#039;3&#039;
        option up &#039;8&#039; 

config interface &#039;wan6&#039;       
        option enabled &#039;1&#039;     
        list track_ip &#039;8.8.4.4&#039;       
        list track_ip &#039;8.8.8.8&#039;       
        list track_ip &#039;208.67.222.222&#039;
        list track_ip &#039;208.67.220.220&#039;
        option reliability &#039;2&#039;
        option count &#039;1&#039;   
        option timeout &#039;2&#039; 
        option interval &#039;5&#039;
        option down &#039;3&#039;
        option up &#039;8&#039; 

config interface &#039;vpn_2&#039;
    option enabled &#039;1&#039;
    list track_ip &#039;8.8.4.4&#039;
    list track_ip &#039;8.8.8.8&#039;
    list track_ip &#039;208.67.222.222&#039;
    list track_ip &#039;208.67.220.220&#039;
    option reliability &#039;2&#039;
    option count &#039;1&#039;
    option timeout &#039;2&#039;
    option interval &#039;5&#039;
    option down &#039;3&#039;
    option dns &#039;8.8.8.8 8.8.4.4&#039;
    option up &#039;8&#039;

config member &#039;wanm&#039;
    option interface &#039;wan&#039;
    option metric &#039;10&#039;
    option weight &#039;1&#039;

config member &#039;wan6m&#039;
    option interface &#039;wan6&#039;
    option metric &#039;10&#039;
    option weight &#039;1&#039;

config member &#039;vpn_2m&#039;
    option interface &#039;vpn_2&#039;
    option metric &#039;20&#039;
    option weight &#039;3&#039;

config policy &#039;vpn_only&#039;
    list use_member &#039;vpn_2m&#039;

config policy &#039;novpn_only&#039;
    list use_member &#039;wanm&#039;
    list use_member &#039;wan6m&#039;

config rule &#039;vpn_rule2&#039;
    option src_ip &#039;192.168.1.128/28&#039;
    option use_policy &#039;vpn_only&#039;

config rule &#039;novpn_rule&#039;
    option src_ip &#039;192.168.1.1/28&#039;
    option use_policy &#039;novpn_only&#039;

config rule &#039;default_vpn&#039;
    option dest_ip &#039;0.0.0.0/0&#039;
    option use_policy &#039;vpn_only&#039;

config rule &#039;default_rule&#039;
    option dest_ip &#039;0.0.0.0/0&#039;
    option use_policy &#039;novpn_only&#039;</code></pre></div><p>Do I need these two last default rules? I don&#039;t or?</p><div class="codebox"><pre><code>root@OpenWrt:~# cat /etc/config/network 

config interface &#039;loopback&#039;
    option ifname &#039;lo&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;127.0.0.1&#039;
    option netmask &#039;255.0.0.0&#039;

config globals &#039;globals&#039;
    option ula_prefix &#039;fd19:0eef:8ebd::/48&#039;

config interface &#039;lan&#039;
    option force_link &#039;1&#039;
    option type &#039;bridge&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;192.168.1.1&#039;
    option ip6assign &#039;60&#039;
    option _orig_ifname &#039;eth1 wlan0 wlan1-1&#039;
    option _orig_bridge &#039;true&#039;
    option metric &#039;10&#039;
    option dns &#039;8.8.8.8&#039;
    option ifname &#039;eth1&#039;
    option netmask &#039;255.255.255.240&#039;

config interface &#039;wan&#039;
    option ifname &#039;eth0&#039;
    option proto &#039;dhcp&#039;

config interface &#039;wan6&#039;
    option ifname &#039;eth0&#039;
    option proto &#039;dhcpv6&#039;

config switch
    option name &#039;switch0&#039;
    option reset &#039;1&#039;
    option enable_vlan &#039;1&#039;

config switch_vlan
    option device &#039;switch0&#039;
    option vlan &#039;1&#039;
    option ports &#039;0 2 3 4 5&#039;

config switch_vlan
    option device &#039;switch0&#039;
    option vlan &#039;2&#039;
    option ports &#039;1 6&#039;

config interface &#039;vpn_2&#039;
    option _orig_ifname &#039;wlan1&#039;
    option _orig_bridge &#039;false&#039;
    option proto &#039;static&#039;
    option type &#039;bridge&#039;
    option ipaddr &#039;192.168.1.128&#039;
    option metric &#039;20&#039;
    option macaddr &#039;60:E3:27:2F:9E:45&#039;
    option dns &#039;8.8.8.8&#039;
    option netmask &#039;255.255.255.240&#039;</code></pre></div><div class="codebox"><pre><code>root@OpenWrt:~# cat /etc/config/firewall 

config defaults
    option syn_flood &#039;1&#039;
    option input &#039;ACCEPT&#039;
    option output &#039;ACCEPT&#039;
    option forward &#039;REJECT&#039;

config zone
    option name &#039;lan&#039;
    option input &#039;ACCEPT&#039;
    option output &#039;ACCEPT&#039;
    option forward &#039;ACCEPT&#039;
    option network &#039;lan vpn_5 novpn_2 novpn_5&#039;

config zone
    option name &#039;wan&#039;
    option input &#039;REJECT&#039;
    option output &#039;ACCEPT&#039;
    option masq &#039;1&#039;
    option mtu_fix &#039;1&#039;
    option network &#039;wan wan6&#039;
    option forward &#039;REJECT&#039;

config forwarding
    option src &#039;lan&#039;
    option dest &#039;wan&#039;

config rule
    option name &#039;Allow-DHCP-Renew&#039;
    option src &#039;wan&#039;
    option proto &#039;udp&#039;
    option dest_port &#039;68&#039;
    option target &#039;ACCEPT&#039;
    option family &#039;ipv4&#039;

config rule
    option name &#039;Allow-Ping&#039;
    option src &#039;wan&#039;
    option proto &#039;icmp&#039;
    option icmp_type &#039;echo-request&#039;
    option family &#039;ipv4&#039;
    option target &#039;ACCEPT&#039;

config rule
    option name &#039;Allow-IGMP&#039;
    option src &#039;wan&#039;
    option proto &#039;igmp&#039;
    option family &#039;ipv4&#039;
    option target &#039;ACCEPT&#039;

config rule
    option name &#039;Allow-DHCPv6&#039;
    option src &#039;wan&#039;
    option proto &#039;udp&#039;
    option src_ip &#039;fe80::/10&#039;
    option src_port &#039;547&#039;
    option dest_ip &#039;fe80::/10&#039;
    option dest_port &#039;546&#039;
    option family &#039;ipv6&#039;
    option target &#039;ACCEPT&#039;

config rule
    option name &#039;Allow-MLD&#039;
    option src &#039;wan&#039;
    option proto &#039;icmp&#039;
    option src_ip &#039;fe80::/10&#039;
    list icmp_type &#039;130/0&#039;
    list icmp_type &#039;131/0&#039;
    list icmp_type &#039;132/0&#039;
    list icmp_type &#039;143/0&#039;
    option family &#039;ipv6&#039;
    option target &#039;ACCEPT&#039;

config rule
    option name &#039;Allow-ICMPv6-Input&#039;
    option src &#039;wan&#039;
    option proto &#039;icmp&#039;
    list icmp_type &#039;echo-request&#039;
    list icmp_type &#039;echo-reply&#039;
    list icmp_type &#039;destination-unreachable&#039;
    list icmp_type &#039;packet-too-big&#039;
    list icmp_type &#039;time-exceeded&#039;
    list icmp_type &#039;bad-header&#039;
    list icmp_type &#039;unknown-header-type&#039;
    list icmp_type &#039;router-solicitation&#039;
    list icmp_type &#039;neighbour-solicitation&#039;
    list icmp_type &#039;router-advertisement&#039;
    list icmp_type &#039;neighbour-advertisement&#039;
    option limit &#039;1000/sec&#039;
    option family &#039;ipv6&#039;
    option target &#039;ACCEPT&#039;

config rule
    option name &#039;Allow-ICMPv6-Forward&#039;
    option src &#039;wan&#039;
    option dest &#039;*&#039;
    option proto &#039;icmp&#039;
    list icmp_type &#039;echo-request&#039;
    list icmp_type &#039;echo-reply&#039;
    list icmp_type &#039;destination-unreachable&#039;
    list icmp_type &#039;packet-too-big&#039;
    list icmp_type &#039;time-exceeded&#039;
    list icmp_type &#039;bad-header&#039;
    list icmp_type &#039;unknown-header-type&#039;
    option limit &#039;1000/sec&#039;
    option family &#039;ipv6&#039;
    option target &#039;ACCEPT&#039;

config include
    option path &#039;/etc/firewall.user&#039;

config rule
    option src &#039;wan&#039;
    option dest &#039;lan&#039;
    option proto &#039;esp&#039;
    option target &#039;ACCEPT&#039;

config rule
    option src &#039;wan&#039;
    option dest &#039;lan&#039;
    option dest_port &#039;500&#039;
    option proto &#039;udp&#039;
    option target &#039;ACCEPT&#039;

config zone
    option name &#039;vpn_zone&#039;
    option masq &#039;1&#039;
    option output &#039;ACCEPT&#039;
    option input &#039;ACCEPT&#039;
    option forward &#039;ACCEPT&#039;
    option network &#039;vpn_2&#039;

config forwarding
    option dest &#039;lan&#039;
    option src &#039;vpn_zone&#039;

config forwarding
    option dest &#039;vpn_zone&#039;
    option src &#039;lan&#039;</code></pre></div><br /><p>I can connect to the vpn_2 interface, however I&#039;m unable to browse the web, as the traffic seems not to be routed through. I just don&#039;t get why <img src="https://forum.openwrt.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /> </p><p>I also tried to forward the packages via iptables custom rules.<br /></p><div class="codebox"><pre><code>iptables -I FORWARD -i br-lan -o tun0 -j REJECT
iptables -I FORWARD -s 192.168.1.128/28 -o tun0 -j ACCEPT
iptables -t nat -I POSTROUTING -o tun0  -j MASQUERADE</code></pre></div><p>Without success. Can someone give me hint there pls?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324539">
				<div class="post-metadata">
					<div class="post-num">Post #1562</div>
					<div class="post-author">suriefkasev</div>
					<div class="post-datetime">
						18 May 2016, 14:50					</div>
				</div>
				<div class="post-content content">
					<p>Hi Everyone,<br />I have openwrt router with mwan3 and openvpn</p><p>My LAN IP 194.176.77.xx and with openvn I can reach network 192.176.77.xx<br />but my problem is I have to redirect all traffic destination to 192.168.32.8 through gateway 192.176.77.245<br />anyone can help how to do that??<br />on iptables or use port forwarding or something else??<br />thank you for helping <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p326006">
				<div class="post-metadata">
					<div class="post-num">Post #1563</div>
					<div class="post-author">marco_silva85</div>
					<div class="post-datetime">
						26 May 2016, 21:48					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>marco_silva85 wrote:</cite><blockquote><p>Hi Adze, first thanks for developing mwan3.<br />I have installed it (1.6-2) on my TL-WR842ND which has two service providers: wan and wan2 each capable of 8Mbps. I am also in control of both of these providers (they also run openwrt). <strong>Network metric</strong> is set to 10 and 20 respectivelly, and mwan3 is working with both, I tested with ping on each interface, checking that I have two different public IPs (refreshing a http page) and also by unplugging (fail test).</p><p>The problem: Balancing policy (60%,40%) or my weightFair (50%,50%) only send traffic mostly to just one wan, the other remains underused, and I can only flow traffic up to 8Mbps instead of double - I&#039;ve tested with bittorrent. I did check that yes, both wan members of balancing policies have the same mwan3 metric of 1 (although <strong>network</strong> metric is 10 and 20).</p><p>Here are my configurations:<br /><a href="http://imgur.com/a/9G5UR">http://imgur.com/a/9G5UR</a><br />Results of the traffic distribution are in the last two images, captured from inside my service providers.</p><p>mwan3 configuration file:<br /><a href="http://pastebin.com/raw/8hTeU5c1">http://pastebin.com/raw/8hTeU5c1</a></p><p>TL-WR842ND<br />Thanks</p></blockquote></div><p><strong>An update</strong>: more testing came to the same results: OpenWRT CC 15.05.1 with the TL-WR842ND, and also in a TL-WDR3600, one of the most popular here in the forums.</p><p>Some strange issue is going on. Still need to try in trunk / Lede and with mwan3 version 2.0, but really feels like there&#039;s something wrong with mwan3 1.6, and that it&#039;s not just me, most of the people using mwan3 may have this results and aren&#039;t even aware.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p329188">
				<div class="post-metadata">
					<div class="post-num">Post #1564</div>
					<div class="post-author">GShlomi77</div>
					<div class="post-datetime">
						20 Jun 2016, 19:57					</div>
				</div>
				<div class="post-content content">
					<p>Hi.<br />Just finished configuring mwan3 on my 1043nd v2, using a cable and a pppoe vdsl connections as wan &amp; wan2.<br />I&#039;ve thought about maybe using the Hotplug Script to force a ddns update when a fail-over occurs, but have no idea where to start.<br />Any help will be appreciated.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p330042">
				<div class="post-metadata">
					<div class="post-num">Post #1565</div>
					<div class="post-author">johnnyrampage</div>
					<div class="post-datetime">
						28 Jun 2016, 17:32					</div>
				</div>
				<div class="post-content content">
					<p>Hi there, i have broken my brain with this issue. I have a router TPLINK842 (White with 2 removable antenas). My configuration is:</p><p>1) WLAN (Default)<br />2) Guest (A wireless lan with firewall configuration that denied packages to the default WLAN)<br />3) WAN1 (The default WAN port of my router connected to a cable modem-bridged)<br />4) WAN2 (Its a vlan one of the ports switch of the router that connected to other router with OpenWRT connected as client to the router of my Neighbour).</p><p>The connection runs perfectly when in LOAD BALANCE have 2 conection (WAN1 and WAN2) run in GREEN COLOR, but when i down de wan2 (Via the second router run in client modem connected to my Neighbour) i cant go out via WAN1 and not recognice any DNS so i have a DNS issue here.</p><p>So in Load Balance. Wan1 is green, wan2 is red i test:</p><p>1) PING <a href="http://www.google.com.ar">www.google.com.ar</a> (In my laptop) i cant reach.<br />2) PING <a href="http://www.google.com.ar">www.google.com.ar</a> (In router via ssh) i cant reach that inform BAD ADDRESS.</p><p>But i edit /etc/resolv.conf i see 2 configuration I add 8.8.8.8 and 8.8.4.4 and i test:</p><p>1) PING <a href="http://www.google.com.ar">www.google.com.ar</a> (In my laptop) i cant reach.<br />2) PING <a href="http://www.google.com.ar">www.google.com.ar</a> (In router via ssh) i reach any IP</p><p>But i still have this problem. SO in BALANCE MODE works great, but when i use to FAILOVER its doesnt work i cant get DNS.</p><p>Can you help me?.</p><p>----</p><p>I think a solve this issue setting Google DNS manually. I will post my configuration. Thanks you <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>											<p class="post-edited">(Last edited by <strong>johnnyrampage</strong> on 29 Jun 2016, 17:08)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p330474">
				<div class="post-metadata">
					<div class="post-num">Post #1566</div>
					<div class="post-author">ErwinH</div>
					<div class="post-datetime">
						4 Jul 2016, 16:48					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m trying to load balance certain sites (facebook, windows update, etc) over a slower (unlimited) 3G internet connection, to save space on my limited 4G data plan. But somehow I can&#039;t get ipset to work in combination with mwan3. What am I missing.</p><p>I added the following line to /etc/dnsmasq.conf<br /></p><div class="codebox"><pre><code>ipset=/whatsmyip.org/whatismyipaddress.com/wan2 </code></pre></div><p>And this is on top of my mwan3.conf<br /></p><div class="codebox"><pre><code>config rule &#039;wan2&#039;
    option proto &#039;all&#039;
    option sticky &#039;0&#039;
    option use_policy &#039;wan2_only&#039;
    option ipset &#039;wan2&#039;</code></pre></div><p>If I add a IP-range to the rules it works flawless.</p><p>Hope someone can enlighten me in what I&#039;m doing wrong.</p>											<p class="post-edited">(Last edited by <strong>ErwinH</strong> on 4 Jul 2016, 16:48)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p332154">
				<div class="post-metadata">
					<div class="post-num">Post #1567</div>
					<div class="post-author">sevenseas</div>
					<div class="post-datetime">
						19 Jul 2016, 12:15					</div>
				</div>
				<div class="post-content content">
					<p>Hi, i am trying to use this between wan and 3g modem.When i manually removing interfaces with ifup / ifdown everything works. But if i remove wan cable its not working. Interfaces wont update but output of &quot;mwan status&quot; command Is updated as it should. Is this a problem of hotplug. Should i use a daemon like ifplugd ?</p>											<p class="post-edited">(Last edited by <strong>sevenseas</strong> on 19 Jul 2016, 12:18)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p332224">
				<div class="post-metadata">
					<div class="post-num">Post #1568</div>
					<div class="post-author">remlei</div>
					<div class="post-datetime">
						20 Jul 2016, 01:44					</div>
				</div>
				<div class="post-content content">
					<p>^ this is more like a openwrt flaw in general, if you go to switches, you can see that if you can see each port status if its either plugged or unplugged and their speeds. of course hotplug event doesnt trigger anything when it regard to switch activities, something like it was always up all the time, although if I use a USB Ethernet adapter or PCI/PCIe ethernet card, hotplug and even the kernel knows that you plugged and unplugged a cable.</p><p>This is why there&#039;s a thing called tracking, if it fails to ping the tracking ip&#039;s, then it will make the interface down.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p332936">
				<div class="post-metadata">
					<div class="post-num">Post #1569</div>
					<div class="post-author">sevenseas</div>
					<div class="post-datetime">
						29 Jul 2016, 16:34					</div>
				</div>
				<div class="post-content content">
					<p>I have one more question.&nbsp; With the following configuration<br /></p><div class="codebox"><pre><code>root@Sevenseas:/etc# route -n
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
0.0.0.0         10.1.1.254      0.0.0.0         UG    10     0        0 br-wan
0.0.0.0         10.46.36.177    0.0.0.0         UG    20     0        0 3g-ppp
10.1.1.0        0.0.0.0         255.255.255.0   U     10     0        0 br-wan
192.168.1.0     0.0.0.0         255.255.255.0   U     0      0        0 br-lan</code></pre></div><br /><br /><div class="codebox"><pre><code>config policy &#039;wan_over_ppp&#039;
        list use_member &#039;wan1_m1_w1&#039;
        list use_member &#039;wan2_m10_w1&#039;

config policy &#039;ppp_over_wan&#039;
        list use_member &#039;wan2_m1_w1&#039;
        list use_member &#039;wan1_m10_w1&#039;

config rule &#039;default_rule&#039;
        option use_policy &#039;wan_over_ppp&#039;</code></pre></div><p>This works as expected. But when change default rule &quot;ppp_over_wan&quot; and restart mwan3 , the communication is still goes over wan interface. But again mwan3 status outputs the expected results.</p><br /><div class="codebox"><pre><code>Active ipv4 user rules:
    0     0 - ppp_before_wan  all  --  *      *       0.0.0.0/0            0.0.0.0/0</code></pre></div><br /><p>It only start working after i change the metrics of both wan and ppp interfaces in network configuration and restart both of these interfaces. </p><p>Is this how it suppose to work or multiwan should organize these things on its own, without manually modifying network configuration etc ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333382">
				<div class="post-metadata">
					<div class="post-num">Post #1570</div>
					<div class="post-author">Jaska</div>
					<div class="post-datetime">
						5 Aug 2016, 21:01					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>ErwinH wrote:</cite><blockquote><p>I&#039;m trying to load balance certain sites (facebook, windows update, etc) over a slower (unlimited) 3G internet connection, to save space on my limited 4G data plan. But somehow I can&#039;t get ipset to work in combination with mwan3. What am I missing.</p><p>I added the following line to /etc/dnsmasq.conf<br /></p><div class="codebox"><pre><code>ipset=/whatsmyip.org/whatismyipaddress.com/wan2 </code></pre></div><p>And this is on top of my mwan3.conf<br /></p><div class="codebox"><pre><code>config rule &#039;wan2&#039;
    option proto &#039;all&#039;
    option sticky &#039;0&#039;
    option use_policy &#039;wan2_only&#039;
    option ipset &#039;wan2&#039;</code></pre></div><p>If I add a IP-range to the rules it works flawless.</p><p>Hope someone can enlighten me in what I&#039;m doing wrong.</p></blockquote></div><p>First of all that is the &quot;default&quot; rule that overrides every other rule below it.<br />You should add ipset to dnsmasq.conf &quot;ipset=/facebook.com/windowsupdate.microsoft.com/special&quot; or just microsoft.com to catch all subdomains.<br />Then add it above the default rule<br /></p><div class="codebox"><pre><code>config rule &#039;3G_unlimited&#039;
    option proto &#039;tcp&#039;
    option sticky &#039;0&#039;
    option dest_port &#039;80,443,8530,8531&#039;
    option use_policy &#039;wan2_only&#039;
    option ipset &#039;special&#039;

config rule &#039;default_rule&#039;
    option dest_ip &#039;0.0.0.0/0&#039;
    option proto &#039;all&#039;
    option sticky &#039;0&#039;
    option use_policy &#039;wan_only&#039;</code></pre></div><p>Other way to go is just add wan2 as default route and add any other special sites you want to use 4G_limited with, into ipset and make rule as example on above config rule &#039;3GUnlimited&#039;, <strong><em>ps. ports &quot;8530,8531&quot; are special ones that windows update uses.</em></strong></p><p>ALSO AS A SIDENOTE. ipset is not compiled into dnsmasq as default. You need to compile the firmware yourself and add dnsmasq-full from base system/dnsmasq-full and remove the dnsmasq. You&#039;ll get errors in System log about this after starting dnsmasq if it&#039;s not compiled into it (also it will crash and stop working.)</p><p>E: also you need to restart dnsmasq every time you change the ipsets.</p>											<p class="post-edited">(Last edited by <strong>Jaska</strong> on 5 Aug 2016, 21:05)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333463">
				<div class="post-metadata">
					<div class="post-num">Post #1571</div>
					<div class="post-author">Savy0405</div>
					<div class="post-datetime">
						6 Aug 2016, 17:07					</div>
				</div>
				<div class="post-content content">
					<p>Hi All,</p><p>I am new to mwan3 feature and using mwan3 version 1.6. I was trying to configure mwan3 with two wans in equal load balanced mode. Following are my configuration details,</p><p>1. Added two WAN connections under multiwan<br />2. Assigned same metric(1) to both the wans<br />3. Assigned same weight(1) to both the wans</p><p>In system, &quot;mwan3 status&quot; shows both the wans as online and sharing 50% of the load.</p><p>By reading through the forum I understand that mwan3 works based on sessions. From that I am in an impression that if I start two wget sessions from lan host pc, 2 wget session should go through two different wan interfaces as each sharing 50% of the load. Is my assumption valid?</p><p>Following are my observation while testing with wget sessions:<br />1. With only two wget sessions, not everytime both the wans are being used. Though &quot;mwan3 status&quot; showing wans as online at the point of testing.<br />2. If I keep on starting wget sessions on the LAN pc I can see that some is going through one wan and some other through the other wan.</p><p>From above two observations, my impression is load balancing is working but it is not always 50% for me.</p><p>Now regarding this following are my questions,<br />1. The weight based load balancing is noticable for small amount sessions (e.g. only 2 wget session for the above example)?<br /> Or this will be noticiable only if sufficient amount of sessions has been ran? (As I saw that mwan3 is using xt_statistics in random probability mode for load balancing).<br />2. For the very first wget session how is it selecting the wan through which the traffic should go? Is this random?</p><p>I will highly grateful if any one can give any idea on this topic.</p><p>Thanks in advance.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333781">
				<div class="post-metadata">
					<div class="post-num">Post #1572</div>
					<div class="post-author">code.compile.link</div>
					<div class="post-datetime">
						9 Aug 2016, 13:47					</div>
				</div>
				<div class="post-content content">
					<p>I have been using mwan3 version 1.5-10 for a while now, one problem that it I find consistently happening is </p><br /><p>That every time my first wan interface goes down, while interface wan2 is up </p><p>The clients see DNS errors and are not able to resolve domain names,</p><p>Even though they can ping specific internet IPS which are going through wan2 as expected.</p><p>The DNS request still try to resolve the IP via first wan even if it is down, this should go though wan2 because wan2 is the only online interface, but it is not happening..</p><p>In the Dnsmasq I have specified 8.8.8.8 and 8.8.4.4 as forwardings but the issue is consistently reproducible. I am not sure perhaps this is resolved in new version of mwan3 but on my router I have OpenWrt Barrier Breaker 14.07 which only allows for the mwan 1.5-10</p>											<p class="post-edited">(Last edited by <strong>code.compile.link</strong> on 9 Aug 2016, 13:54)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333865">
				<div class="post-metadata">
					<div class="post-num">Post #1573</div>
					<div class="post-author">benja1475</div>
					<div class="post-datetime">
						10 Aug 2016, 04:41					</div>
				</div>
				<div class="post-content content">
					<p>Hi Im new here but long user of openwrt and mwan3... I have some question about mwan3, I configure mwan3 on my TP-Link TL-WDR4300 v1 with OpenWrt Barrier Breaker 14.07 / LuCI Trunk (0.12+svn-r10530) using 3 fiber line @ 20mbps each, i load balance it 33% each link. doing bandwidth test, I get nearly 60mbps, but recently I upgraded the 3 fiber lines to 100mbps each, so I&#039;m expecting to get 300mbps during bandwidth test, but sadly i only get 100mbps, I cant go beyond 100mbps, I test the link individually directly to my compute and I can get 100mbps for each fiber line... upon checking the realtime graph on my openwrt the traffic graph for each link is @ 33mbps or less, maybe because of the load balance value of 33%. I wonder why before when my link is&nbsp; @ 20mbps each, I can utilize the full bandwidth of each 20mbps fiber, while now that I&#039;m @ 100mbps, I only get 33% of the 100mbps of each link. It seems that mwan3 is really limited to 100mbps, Please help how I can utilize all my 3 100mbps lnk, thank you...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p335426">
				<div class="post-metadata">
					<div class="post-num">Post #1574</div>
					<div class="post-author">arfett</div>
					<div class="post-datetime">
						22 Aug 2016, 04:33					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>code.compile.link wrote:</cite><blockquote><p>I have been using mwan3 version 1.5-10 for a while now, one problem that it I find consistently happening is </p><br /><p>That every time my first wan interface goes down, while interface wan2 is up </p><p>The clients see DNS errors and are not able to resolve domain names,</p><p>Even though they can ping specific internet IPS which are going through wan2 as expected.</p><p>The DNS request still try to resolve the IP via first wan even if it is down, this should go though wan2 because wan2 is the only online interface, but it is not happening..</p><p>In the Dnsmasq I have specified 8.8.8.8 and 8.8.4.4 as forwardings but the issue is consistently reproducible. I am not sure perhaps this is resolved in new version of mwan3 but on my router I have OpenWrt Barrier Breaker 14.07 which only allows for the mwan 1.5-10</p></blockquote></div><p>Old versions of mwan3 are mostly unsupported by Adze or myself.</p><p>Adze mentioned many months ago he&#039;d be working with me at some point to update mwan3 and the GUI to better support IPv6. Not sure if he&#039;s still planning on doing that or not.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p337470">
				<div class="post-metadata">
					<div class="post-num">Post #1575</div>
					<div class="post-author">darkstar91</div>
					<div class="post-datetime">
						7 Sep 2016, 06:30					</div>
				</div>
				<div class="post-content content">
					<p>Can anyone help me, i have two wans and two vlans..i want that the vlan1 use the internet connection of wan1 and vlan2 use the internet connection of wan2<br />and i want no load balancer</p><p>like this:<br />(vlan1 in my case PRIVAT) get (100% of the wan1 internet connection)<br />(vlan2 in my case GEASTE) get (100% of the wan2 internet connection)</p><p>but always vlan1 is working, on vlan2 is written always no Internet Connection, anyone can find the error?</p><br /><p>Software versions</p><p>OpenWrt - OpenWrt Chaos Calmer 15.05.1<br />LuCI - git-15.363.78009-956be55<br />mwan3 - 1.6-2<br />mwan3-luci - 1.4-3</p><p>/etc/config/mwan3</p><div class="codebox"><pre><code>config interface &#039;wan1&#039;
    option enabled &#039;1&#039;
    list track_ip &#039;8.8.8.8&#039;
    list track_ip &#039;8.8.4.4&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option timeout &#039;2&#039;
    option interval &#039;5&#039;
    option down &#039;3&#039;
    option up &#039;8&#039;

config interface &#039;wan2&#039;
    option enabled &#039;1&#039;
    list track_ip &#039;8.8.8.8&#039;
    list track_ip &#039;8.8.4.4&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option timeout &#039;2&#039;
    option interval &#039;5&#039;
    option down &#039;3&#039;
    option up &#039;8&#039;

config member &#039;wan1_m10_w1&#039;
    option interface &#039;wan1&#039;
    option metric &#039;10&#039;
    option weight &#039;1&#039;

config member &#039;wan2_m20_w1&#039;
    option interface &#039;wan2&#039;
    option weight &#039;1&#039;
    option metric &#039;20&#039;

config policy &#039;wan1_only&#039;
    list use_member &#039;wan1_m10_w1&#039;
    option last_resort &#039;default&#039;

config policy &#039;wan2_only&#039;
    list use_member &#039;wan2_m20_w1&#039;
    option last_resort &#039;default&#039;

config rule &#039;PRIVAT&#039;
    option dest_ip &#039;0.0.0.0/0&#039;
    option use_policy &#039;wan1_only&#039;

config rule &#039;GEASTE&#039;
    option dest_ip &#039;0.0.0.0/0&#039;
    option use_policy &#039;wan2_only&#039;</code></pre></div><p>/etc/config/network<br /></p><div class="codebox"><pre><code>config interface &#039;loopback&#039;
    option ifname &#039;lo&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;127.0.0.1&#039;
    option netmask &#039;255.0.0.0&#039;

config interface &#039;lan&#039;
    option ifname &#039;eth0.1&#039;
    option type &#039;bridge&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;192.168.1.1&#039;
    option netmask &#039;255.255.255.0&#039;

config interface &#039;wan1&#039;
    option ifname &#039;eth0.2&#039;
    option proto &#039;pppoe&#039;
    option peerdns &#039;0&#039;
    option dns &#039;8.8.8.8 8.8.4.4&#039;
    USERNAME HIDDEN
    PASSWORD HIDDEN
    option metric &#039;10&#039;

config interface &#039;wan2&#039;
    option proto &#039;pppoe&#039;
    option ifname &#039;eth0.3&#039;
    option peerdns &#039;0&#039;
    option dns &#039;8.8.8.8 8.8.4.4&#039;
    USERNAME HIDDEN
    PASSWORD HIDDEN
    option metric &#039;20&#039;

config switch
    option reset &#039;1&#039;
    option enable_vlan &#039;1&#039;
    option enable_vlan4k &#039;1&#039;
    option name &#039;switch0&#039;

config switch_vlan
    option vlan &#039;1&#039;
    option ports &#039;0t 3 4 5t&#039;
    option device &#039;switch0&#039;

config switch_vlan
    option vlan &#039;2&#039;
    option ports &#039;1 5t&#039;
    option device &#039;switch0&#039;

config switch_vlan
    option vlan &#039;3&#039;
    option ports &#039;2 5t&#039;
    option device &#039;switch0&#039;

config switch_vlan
    option vlan &#039;22&#039;
    option ports &#039;0t 5t&#039;
    option device &#039;switch0&#039;

config switch_vlan
    option vlan &#039;23&#039;
    option ports &#039;0t 5t&#039;
    option device &#039;switch0&#039;

config interface &#039;PRIVAT&#039;
    option proto &#039;static&#039;
    option ifname &#039;eth0.22&#039;
    option ipaddr &#039;192.168.22.1&#039;
    option netmask &#039;255.255.255.0&#039;

config interface &#039;GAESTE&#039;
    option proto &#039;static&#039;
    option ifname &#039;eth0.23&#039;
    option ipaddr &#039;192.168.23.1&#039;
    option netmask &#039;255.255.255.0&#039;</code></pre></div><p>/etc/config/firewall<br /></p><div class="codebox"><pre><code>config rule
    option name &#039;Allow-DHCP-Renew WAN1&#039;
    option src &#039;wan1&#039;
    option proto &#039;udp&#039;
    option dest_port &#039;68&#039;
    option target &#039;ACCEPT&#039;
    option family &#039;ipv4&#039;

config rule
    option name &#039;Allow-Ping WAN1&#039;
    option src &#039;wan1&#039;
    option proto &#039;icmp&#039;
    option icmp_type &#039;echo-request&#039;
    option family &#039;ipv4&#039;
    option target &#039;ACCEPT&#039;

config rule
    option name &#039;Allow-DHCPv6 WAN1&#039;
    option src &#039;wan1&#039;
    option proto &#039;udp&#039;
    option src_ip &#039;fe80::/10&#039;
    option src_port &#039;547&#039;
    option dest_ip &#039;fe80::/10&#039;
    option dest_port &#039;546&#039;
    option family &#039;ipv6&#039;
    option target &#039;ACCEPT&#039;

config rule
    option name &#039;Allow-ICMPv6-Input WAN1&#039;
    option src &#039;wan1&#039;
    option proto &#039;icmp&#039;
    list icmp_type &#039;echo-request&#039;
    list icmp_type &#039;echo-reply&#039;
    list icmp_type &#039;destination-unreachable&#039;
    list icmp_type &#039;packet-too-big&#039;
    list icmp_type &#039;time-exceeded&#039;
    list icmp_type &#039;bad-header&#039;
    list icmp_type &#039;unknown-header-type&#039;
    list icmp_type &#039;router-solicitation&#039;
    list icmp_type &#039;neighbour-solicitation&#039;
    list icmp_type &#039;router-advertisement&#039;
    list icmp_type &#039;neighbour-advertisement&#039;
    option limit &#039;1000/sec&#039;
    option family &#039;ipv6&#039;
    option target &#039;ACCEPT&#039;

config rule
    option name &#039;Allow-ICMPv6-Forward WAN1&#039;
    option src &#039;wan1&#039;
    option dest &#039;*&#039;
    option proto &#039;icmp&#039;
    list icmp_type &#039;echo-request&#039;
    list icmp_type &#039;echo-reply&#039;
    list icmp_type &#039;destination-unreachable&#039;
    list icmp_type &#039;packet-too-big&#039;
    list icmp_type &#039;time-exceeded&#039;
    list icmp_type &#039;bad-header&#039;
    list icmp_type &#039;unknown-header-type&#039;
    option limit &#039;1000/sec&#039;
    option family &#039;ipv6&#039;
    option target &#039;ACCEPT&#039;

config rule
    option name &#039;Allow-DHCP-Renew WAN2&#039;
    option src &#039;wan2&#039;
    option proto &#039;udp&#039;
    option dest_port &#039;68&#039;
    option target &#039;ACCEPT&#039;
    option family &#039;ipv4&#039;

config rule
    option name &#039;Allow-Ping WAN2&#039;
    option src &#039;wan2&#039;
    option proto &#039;icmp&#039;
    option icmp_type &#039;echo-request&#039;
    option family &#039;ipv4&#039;
    option target &#039;ACCEPT&#039;

config rule
    option name &#039;Allow-DHCPv6 WAN2&#039;
    option src &#039;wan2&#039;
    option proto &#039;udp&#039;
    option src_ip &#039;fe80::/10&#039;
    option src_port &#039;547&#039;
    option dest_ip &#039;fe80::/10&#039;
    option dest_port &#039;546&#039;
    option family &#039;ipv6&#039;
    option target &#039;ACCEPT&#039;

config rule
    option name &#039;Allow-ICMPv6-Input WAN2&#039;
    option src &#039;wan2&#039;
    option proto &#039;icmp&#039;
    list icmp_type &#039;echo-request&#039;
    list icmp_type &#039;echo-reply&#039;
    list icmp_type &#039;destination-unreachable&#039;
    list icmp_type &#039;packet-too-big&#039;
    list icmp_type &#039;time-exceeded&#039;
    list icmp_type &#039;bad-header&#039;
    list icmp_type &#039;unknown-header-type&#039;
    list icmp_type &#039;router-solicitation&#039;
    list icmp_type &#039;neighbour-solicitation&#039;
    list icmp_type &#039;router-advertisement&#039;
    list icmp_type &#039;neighbour-advertisement&#039;
    option limit &#039;1000/sec&#039;
    option family &#039;ipv6&#039;
    option target &#039;ACCEPT&#039;

config rule
    option name &#039;Allow-ICMPv6-Forward WAN2&#039;
    option src &#039;wan2&#039;
    option dest &#039;*&#039;
    option proto &#039;icmp&#039;
    list icmp_type &#039;echo-request&#039;
    list icmp_type &#039;echo-reply&#039;
    list icmp_type &#039;destination-unreachable&#039;
    list icmp_type &#039;packet-too-big&#039;
    list icmp_type &#039;time-exceeded&#039;
    list icmp_type &#039;bad-header&#039;
    list icmp_type &#039;unknown-header-type&#039;
    option limit &#039;1000/sec&#039;
    option family &#039;ipv6&#039;
    option target &#039;ACCEPT&#039;

config rule
    option target &#039;ACCEPT&#039;
    option proto &#039;udp&#039;
    option dest_port &#039;67-68&#039;
    option src &#039;GAESTE&#039;
    option name &#039;Allow-DHCP-Renew GAESTE&#039;

config rule
    option target &#039;ACCEPT&#039;
    option proto &#039;tcp udp&#039;
    option src &#039;GAESTE&#039;
    option dest_port &#039;53&#039;
    option name &#039;Allow-DNS GAESTE&#039;

config redirect
    option target &#039;DNAT&#039;
    option proto &#039;tcp&#039;
    option dest_ip &#039;192.168.1.1&#039;
    option dest_port &#039;80&#039;
    option src_dport &#039;81&#039;
    option dest &#039;lan&#039;
    option name &#039;Firewall&#039;
    option src &#039;wan2&#039;

config redirect
    option target &#039;DNAT&#039;
    option proto &#039;tcp&#039;
    option src_dport &#039;21&#039;
    option dest_port &#039;21&#039;
    option dest &#039;PRIVAT&#039;
    option name &#039;DM800 Ftp&#039;
    option dest_ip &#039;192.168.22.31&#039;
    option src &#039;wan2&#039;

config defaults
    option syn_flood &#039;1&#039;
    option output &#039;ACCEPT&#039;
    option input &#039;REJECT&#039;
    option forward &#039;REJECT&#039;

config include
    option path &#039;/etc/firewall.user&#039;

config zone
    option name &#039;lan&#039;
    option network &#039;lan&#039;
    option input &#039;ACCEPT&#039;
    option output &#039;ACCEPT&#039;
    option forward &#039;REJECT&#039;

config zone
    option output &#039;ACCEPT&#039;
    option forward &#039;REJECT&#039;
    option masq &#039;1&#039;
    option mtu_fix &#039;1&#039;
    option input &#039;REJECT&#039;
    option name &#039;wan1&#039;
    option network &#039;wan1&#039;

config zone
    option input &#039;REJECT&#039;
    option forward &#039;REJECT&#039;
    option output &#039;ACCEPT&#039;
    option name &#039;wan2&#039;
    option masq &#039;1&#039;
    option mtu_fix &#039;1&#039;
    option network &#039;wan2&#039;

config zone
    option name &#039;PRIVAT&#039;
    option output &#039;ACCEPT&#039;
    option network &#039;PRIVAT&#039;
    option input &#039;ACCEPT&#039;
    option forward &#039;REJECT&#039;

config zone
    option name &#039;GAESTE&#039;
    option output &#039;ACCEPT&#039;
    option forward &#039;REJECT&#039;
    option input &#039;REJECT&#039;
    option network &#039;GAESTE&#039;

config forwarding
    option dest &#039;wan1&#039;
    option src &#039;lan&#039;

config forwarding
    option dest &#039;wan1&#039;
    option src &#039;PRIVAT&#039;

config forwarding
    option dest &#039;wan2&#039;
    option src &#039;GAESTE&#039;</code></pre></div><p>root@Firewall:~# ifconfig<br /></p><div class="codebox"><pre><code>br-lan    Link encap:Ethernet  HWaddr 10:FE:ED:7F:37:7C
          inet addr:192.168.1.1  Bcast:192.168.1.255  Mask:255.255.255.0
          inet6 addr: fe80::12fe:edff:fe7f:377c/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:236 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:0 (0.0 B)  TX bytes:20688 (20.2 KiB)

eth0      Link encap:Ethernet  HWaddr 10:FE:ED:7F:37:7C
          inet6 addr: fe80::12fe:edff:fe7f:377c/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:325528 errors:0 dropped:0 overruns:0 frame:0
          TX packets:327680 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:208410255 (198.7 MiB)  TX bytes:210109019 (200.3 MiB)
          Interrupt:4

eth0.1    Link encap:Ethernet  HWaddr 10:FE:ED:7F:37:7C
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:161 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:0 (0.0 B)  TX bytes:11158 (10.8 KiB)

eth0.2    Link encap:Ethernet  HWaddr 10:FE:ED:7F:37:7C
          inet6 addr: fe80::12fe:edff:fe7f:377c/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:155802 errors:0 dropped:0 overruns:0 frame:0
          TX packets:149266 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:122885687 (117.1 MiB)  TX bytes:80980174 (77.2 MiB)

eth0.22   Link encap:Ethernet  HWaddr 10:FE:ED:7F:37:7C
          inet addr:192.168.22.1  Bcast:192.168.22.255  Mask:255.255.255.0
          inet6 addr: fe80::12fe:edff:fe7f:377c/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:140441 errors:0 dropped:0 overruns:0 frame:0
          TX packets:149511 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:78052309 (74.4 MiB)  TX bytes:126308813 (120.4 MiB)

eth0.23   Link encap:Ethernet  HWaddr 10:FE:ED:7F:37:7C
          inet addr:192.168.23.1  Bcast:192.168.23.255  Mask:255.255.255.0
          inet6 addr: fe80::12fe:edff:fe7f:377c/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:15716 errors:0 dropped:0 overruns:0 frame:0
          TX packets:15578 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:982362 (959.3 KiB)  TX bytes:1006674 (983.0 KiB)

eth0.3    Link encap:Ethernet  HWaddr 10:FE:ED:7F:37:7C
          inet6 addr: fe80::12fe:edff:fe7f:377c/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:536 errors:0 dropped:0 overruns:0 frame:0
          TX packets:517 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:25170 (24.5 KiB)  TX bytes:19794 (19.3 KiB)

lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:38 errors:0 dropped:0 overruns:0 frame:0
          TX packets:38 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:3335 (3.2 KiB)  TX bytes:3335 (3.2 KiB)

pppoe-wan1 Link encap:Point-to-Point Protocol
          inet addr:95.237.108.36  P-t-P:192.168.100.1  Mask:255.255.255.255
          UP POINTOPOINT RUNNING NOARP MULTICAST  MTU:1492  Metric:1
          RX packets:146232 errors:0 dropped:0 overruns:0 frame:0
          TX packets:139741 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:3
          RX bytes:121177546 (115.5 MiB)  TX bytes:77619534 (74.0 MiB)

pppoe-wan2 Link encap:Point-to-Point Protocol
          inet addr:88.149.166.191  P-t-P:81.174.0.21  Mask:255.255.255.255
          UP POINTOPOINT RUNNING NOARP MULTICAST  MTU:1492  Metric:1
          RX packets:158 errors:0 dropped:0 overruns:0 frame:0
          TX packets:151 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:3
          RX bytes:5662 (5.5 KiB)  TX bytes:4922 (4.8 KiB)</code></pre></div><p>root@Firewall:~# route -n<br /></p><div class="codebox"><pre><code>Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
0.0.0.0         192.168.100.1   0.0.0.0         UG    10     0        0 pppoe-wan1
0.0.0.0         81.174.0.21     0.0.0.0         UG    20     0        0 pppoe-wan2
81.174.0.21     0.0.0.0         255.255.255.255 UH    0      0        0 pppoe-wan2
192.168.1.0     0.0.0.0         255.255.255.0   U     0      0        0 br-lan
192.168.22.0    0.0.0.0         255.255.255.0   U     0      0        0 eth0.22
192.168.23.0    0.0.0.0         255.255.255.0   U     0      0        0 eth0.23
192.168.100.1   0.0.0.0         255.255.255.255 UH    0      0        0 pppoe-wan1</code></pre></div><p>MWAN Detailed Status<br /></p><div class="codebox"><pre><code>Interface status:
 interface wan1 is online (tracking active)
 interface wan2 is online (tracking active)

Policy wan1_only:
 wan1 (100%)

Policy wan2_only:
 wan2 (100%)

Known networks:
 127.0.0.0/8
 127.255.255.255
 127.0.0.1
 192.168.23.0
 192.168.1.1
 88.149.166.191
 224.0.0.0/3
 192.168.22.255
 192.168.100.1
 192.168.23.255
 192.168.22.0
 81.174.0.21
 192.168.1.0
 95.237.108.36
 192.168.1.0/24
 192.168.23.0/24
 192.168.1.255
 192.168.23.1
 192.168.22.1
 192.168.22.0/24
 127.0.0.0

Active rules:
   83  5106 - wan1_only  all  --  *      *       0.0.0.0/0            0.0.0.0/0            
    0     0 - wan2_only  all  --  *      *       0.0.0.0/0            0.0.0.0/0</code></pre></div>											<p class="post-edited">(Last edited by <strong>darkstar91</strong> on 8 Sep 2016, 07:04)</p>
									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 63 of 65</div><nav><ul><li><a href="viewtopic.php%3Fid=39052&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=39052&amp;p=61.html">61</a></li><li><a href="viewtopic.php%3Fid=39052&amp;p=62.html">62</a></li><li class="pagination-current"><span>63</span></li><li><a href="viewtopic.php%3Fid=39052&amp;p=64.html">64</a></li><li><a href="viewtopic.php%3Fid=39052&amp;p=65.html">65</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0.001 -->

</body>
</html>