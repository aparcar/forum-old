<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Route all traffic via VPN - OpenVPN on AA 12.09</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 20 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p218487">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">wrtg_spain</div>
					<div class="post-datetime">
						26 Nov 2013, 02:26					</div>
				</div>
				<div class="post-content content">
					<p>I have a TP-Link TL-WR703N running&nbsp; ATTITUDE ADJUSTMENT 12.09. I am able to connect to my VPN using the following command:</p><p>openvpn --config vpnconfig.ovpn</p><p>This works and if I do a &quot;wget <a href="http://whatismyip.com">http://whatismyip.com</a>&quot; I get my VPN&#039;s IP, but when I connect to my router via WiFi and try to use the internet it times out. From what I understand I need to configre my router to route all traffic from clients to tun0, but I have tried a number of guides and none have worked.</p><p>Can anyone link me a guide that will work with my hardware &amp; version, or give me any advice on the best (easiest) way to do this?</p><p>Thank you.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p218710">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">wrtg_spain</div>
					<div class="post-datetime">
						27 Nov 2013, 23:31					</div>
				</div>
				<div class="post-content content">
					<p>Bump. Anyone got any ideas?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p218712">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">TrYp.MyNe</div>
					<div class="post-datetime">
						27 Nov 2013, 23:47					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;d check to make sure that your routing table is routing traffic from the VPN to your WAN, and vice versa.&nbsp; Are you running wget from SSH to your router or from your machine (linux?)?&nbsp; Someone more educated on this could help a bit more, but those are my thoughts</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p218718">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">BURR</div>
					<div class="post-datetime">
						28 Nov 2013, 00:52					</div>
				</div>
				<div class="post-content content">
					<p>You should really test your VPN from an outside network, ie. 4G.</p><p>But this <a href="http://www.frogiswrong.com/blog/articles/8/openvpn-on-openwrt-a-little-more-detail/">Tutorial</a>&nbsp; is just what you are looking for.</p><p>You need this line in your config:</p><div class="codebox"><pre><code>option &#039;push&#039; &#039;redirect-gateway def1&#039;</code></pre></div>											<p class="post-edited">(Last edited by <strong>BURR</strong> on 28 Nov 2013, 00:53)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p218789">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">wrtg_spain</div>
					<div class="post-datetime">
						28 Nov 2013, 18:41					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for the help guys, but I think I wasn&#039;t clear on what I wanted to do.</p><p>I want to run an OpenVPN client (not a server) on my router and have it connect to an OpenVPN server on the internet, and route all traffic from devices connecting to the web on my network via the VPN.</p><p>So it would go like this:</p><p>My Device &gt; Router &gt; VPN Server &gt; Internet</p><p>I am able to get my router to connect to the VPN server and it works correctly, but it will not route any traffic from other devices via the VPN. I have read a number of guides on how to do this setup but they confuse me and I have not had any success with this last step. From what I understand I need to configure my router so that it forwards all traffic from my network to the internet via tun0 (which is my OpenVPN client).</p>											<p class="post-edited">(Last edited by <strong>wrtg_spain</strong> on 28 Nov 2013, 18:44)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p218910">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">BURR</div>
					<div class="post-datetime">
						1 Dec 2013, 00:25					</div>
				</div>
				<div class="post-content content">
					<p>Did you read this?</p><p><a href="http://wiki.openwrt.org/doc/howto/vpn.client.openvpn.tap">http://wiki.openwrt.org/doc/howto/vpn.c â€¦ penvpn.tap</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p218975">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">oguzhane</div>
					<div class="post-datetime">
						1 Dec 2013, 19:43					</div>
				</div>
				<div class="post-content content">
					<p>There are a couple of ways to do this depending on your required use case.</p><p>First,&nbsp; what kind of tunnel do you have to the VPN server?&nbsp; tun (routed)&nbsp; or tap (bridged?)&nbsp; Most likely tun, but just check your config for the option &quot;dev&quot; </p><p>Secondly, do you want all traffic across all wifi clients and wired clients to go through the vpn interface, or some subset?</p><p>Some subset could be:<br />&nbsp; - All Wifi leaving wired alone.<br />&nbsp; - A secondary SSID, leaving current SSID and wired alone<br />&nbsp; - All wired leaving wireless alone<br />&nbsp; - Certain wired ports only</p><p>Or some combination</p><p>What you&#039;ll end up doing is basically create a new network out of the&nbsp; tun/tap interface and then bridging the various LAN segments to it.&nbsp; <br />&nbsp; -</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>