<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Creating package for Linksys upnp binary</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 31 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p12442">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">kaldek</div>
					<div class="post-datetime">
						21 Sep 2005, 06:04					</div>
				</div>
				<div class="post-content content">
					<p>Hi folks,</p><p>I&#039;ve started writing a upnp guide in the wiki documents for OpenWRT.&nbsp; I now need to create an .ipk package for the upnp daemon so I can help folks get that easily installed onto their router.&nbsp; I understand there is already a package created by yani for the Linux-IGD upnp daemon, but personally I don&#039;t like the implementation compared to the simplicity of the Linksys one and would like to offer an alternative.</p><p>Ok, so now a couple of questions:</p><p>1. Since the source code is provided with the GPL tarball from Linksys, does this not need to go into the &quot;non-free&quot; package directory.<br />2. Once the package is complete (and tested properly) can we add it to the package database so that &quot;ipkg install upnp&quot; will just work?<br />3. Is anyone willing to provide a little assistance to a skilled, yet inexperience package n00b like me to get the package built.</p><p>If you&#039;re worried about my abilities in case you decide to help me, I can tell you that I&#039;m technically highly skilled and work in IT security.&nbsp; I just haven&#039;t done any coding for, well, years.&nbsp; So if you give me a little nudge in the right direction, I will probably put back a lot more than you need to put in.</p><p>Thanks folks,</p><p>Kaldek</p>											<p class="post-edited">(Last edited by <strong>kaldek</strong> on 21 Sep 2005, 06:40)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p12446">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">wbx</div>
					<div class="post-datetime">
						21 Sep 2005, 08:05					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>kaldek wrote:</cite><blockquote><p>Hi folks,</p><p>I&#039;ve started writing a upnp guide in the wiki documents for OpenWRT.</p></blockquote></div><p>I have seen this, nice.</p><div class="quotebox"><cite>kaldek wrote:</cite><blockquote><p>I now need to create an .ipk package for the upnp daemon so I can help folks get that easily installed onto their router.&nbsp; I understand there is already a package created by yani for the Linux-IGD upnp daemon, but personally I don&#039;t like the implementation compared to the simplicity of the Linksys one and would like to offer an alternative.</p><p>Ok, so now a couple of questions:</p><p>1. Since the source code is provided with the GPL tarball from Linksys, does this not need to go into the &quot;non-free&quot; package directory.</p></blockquote></div><p>Exactly. It has a &quot;AS-IS&quot; license statement on top of the files I have checked. So take all files, make a directory upnp-0.1 and put a tgz anywhere online.</p><div class="quotebox"><cite>kaldek wrote:</cite><blockquote><p>2. Once the package is complete (and tested properly) can we add it to the package database so that &quot;ipkg install upnp&quot; will just work?</p></blockquote></div><p>May be. Make a package and send it to the developer mailinglist: openwrt-devel@openwrt.org</p><br /><div class="quotebox"><cite>kaldek wrote:</cite><blockquote><p>3. Is anyone willing to provide a little assistance to a skilled, yet inexperience package n00b like me to get the package built.</p></blockquote></div><p>We have some documentation you should read. It is a really simple task, no need to know any programming skills.<br /><a href="http://downloads.openwrt.org/docs/buildroot-documentation.html">http://downloads.openwrt.org/docs/build â€¦ ation.html</a><br /><a href="http://wiki.openwrt.org/BuildingPackagesHowTo">http://wiki.openwrt.org/BuildingPackagesHowTo</a></p><div class="quotebox"><cite>kaldek wrote:</cite><blockquote><p>If you&#039;re worried about my abilities in case you decide to help me, I can tell you that I&#039;m technically highly skilled and work in IT security.&nbsp; I just haven&#039;t done any coding for, well, years.&nbsp; So if you give me a little nudge in the right direction, I will probably put back a lot more than you need to put in.</p><p>Thanks folks,</p><p>Kaldek</p></blockquote></div><p>cheers wbx</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p12451">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">kaldek</div>
					<div class="post-datetime">
						21 Sep 2005, 08:46					</div>
				</div>
				<div class="post-content content">
					<p>Thanks wbx, I&#039;ve downloaded the SDK and I&#039;m now on my way.&nbsp; Looks to be a heap of fun, only problem is trying to make myself do actual &quot;work&quot; during business hours rather than toying with OpenWRT (and to a lesser extent, OpenSlug).</p><p>Results are a&#039;comin&#039;,</p><p>Kaldek</p><p>P.S. Sorry about not doing enough digging and finding the Package Build HOWTO before posting for assistance. :-/</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p12494">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">tanguy15</div>
					<div class="post-datetime">
						21 Sep 2005, 22:13					</div>
				</div>
				<div class="post-content content">
					<p>Thank you for the wiki kaldek, very well written.</p><p>I tried the &quot;Linksys&quot; version some time ago, but using the Linksys libshared.so made the wifi unavailable. </p><p>Regards,</p><p>Tanguy</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p12498">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">kaldek</div>
					<div class="post-datetime">
						22 Sep 2005, 03:28					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>tanguy15 wrote:</cite><blockquote><p>I tried the &quot;Linksys&quot; version some time ago, but using the Linksys libshared.so made the wifi unavailable.</p></blockquote></div><p>It did?&nbsp; Hmmm, it didn&#039;t affect my wi-fi at all, so that&#039;s odd.&nbsp; What release were you using at the time?&nbsp; I&#039;ve had the following combinations:</p><p>Whiterussian RC1 - nas 0.9 and upnp from firmware 4.00.7<br />Whiterussian RC2 - nas 0.9 and upnp from firmware 4.00.7<br />Whiterussian RC2 - nas 3.9 and upnp from firmware 4.00.7</p><p>All of those combinations above have worked.&nbsp; Is it possible that your upnp binary was from an older firmware release?&nbsp; This is important, because I may need to add this as a disclaimer in the wiki.&nbsp; upnp also needs to install a replacement libshared.so and libnetconf.so.</p><p><strong>EDIT:</strong> I&#039;ve just checked the files list for the nas-3.9 package, and it does not contain either libnetconf.so or libshared.so.&nbsp; libnetconf.so is not included in WhiteRussian (and is therefore not the problem), but I don&#039;t know if the nas binary or the wireless driver needs libshared.so.&nbsp; nas may well use libshared.so because it&#039;s included in the OpenWRT firmware and therefore not included in the package files.</p><p>It might well be that you need the right versions of libshared.so in order to support both nas and upnp.</p><p>Can anyone provide a fairly accurate idea of which programs aside from upnp make use of libshared.so?&nbsp; If not I&#039;ll have to dig this out of the source code I suppose.</p><p>Kaldek</p>											<p class="post-edited">(Last edited by <strong>kaldek</strong> on 22 Sep 2005, 03:46)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p12519">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">kaldek</div>
					<div class="post-datetime">
						22 Sep 2005, 13:30					</div>
				</div>
				<div class="post-content content">
					<p>Well folks, I have built the package.&nbsp; I didn&#039;t use any of the SDK in the end, because I basically already had the binaries and everything else needed.&nbsp; I didn&#039;t need to actually compile anything, so I just rolled my own IPK file based on the info I sniffed out here: <a href="http://www.uk-dave.com/tutorials/zaurus/ipkg.php">http://www.uk-dave.com/tutorials/zaurus/ipkg.php</a></p><p>I&#039;ll see how the masses like the package before I do anything silly like submit it to the package tree.&nbsp; I think I&#039;ll also pull out the latest binary from firmware 4.20.07 and see if it&#039;s any different.</p><p>Kalde</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p12520">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">wbx</div>
					<div class="post-datetime">
						22 Sep 2005, 13:32					</div>
				</div>
				<div class="post-content content">
					<p>uh. :[</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p12522">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">olli</div>
					<div class="post-datetime">
						22 Sep 2005, 13:35					</div>
				</div>
				<div class="post-content content">
					<p>I think it&#039;s time to add a section to the BuildingPackagesHowto for programs that have nothing to compile (scripts only or binary only).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p12524">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">kaldek</div>
					<div class="post-datetime">
						22 Sep 2005, 13:47					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>wbx wrote:</cite><blockquote><p>uh. :[</p></blockquote></div><p>Is that a bad &quot;uh&quot; or a good &quot;uh&quot;?&nbsp; </p><p>Seriously, I would have compiled the Linksys source code....if I had any idea what the heck I was doing.&nbsp; My compile experience is limited to typing &quot;emerge &lt;package&gt;&quot; in Gentoo.&nbsp; It&#039;s one of the major items on my list of things to learn.&nbsp; </p><p>Trust me, if I could teach myself how to grab source code from anywhere and compile it into binary files, I&#039;d be bouncing off the walls with joy.&nbsp; Right now though I am unfortunately still much more of a tool user than a tool builder.&nbsp; Or perhaps just a tool.</p><p>Kaldek</p>											<p class="post-edited">(Last edited by <strong>kaldek</strong> on 22 Sep 2005, 13:49)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p12565">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">tanguy15</div>
					<div class="post-datetime">
						22 Sep 2005, 23:04					</div>
				</div>
				<div class="post-content content">
					<p>Kaldek,</p><p>The libshared.so is provided by the nvram package. I used the Whiterussian RC2 and the binaries from the latest Lynksys release (I don&#039;t remember exactly which one, some time in August)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p12577">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">kaldek</div>
					<div class="post-datetime">
						23 Sep 2005, 01:23					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>tanguy15 wrote:</cite><blockquote><p>Kaldek,</p><p>The libshared.so is provided by the nvram package. I used the Whiterussian RC2 and the binaries from the latest Lynksys release (I don&#039;t remember exactly which one, some time in August)</p></blockquote></div><p>OK, I just downloaded the nvram package and did some comparisons.&nbsp; Whilst the nvram &quot;package&quot; is not installed in Whiterussian, all the files from that package are installed in the base OpenWRT firmware image (makes sense since you need it).&nbsp; The libshared.so file in the nvram package is identical to the one included with OpenWRT.&nbsp; So that&#039;s our baseline for upnp.</p><p>Adding my upnp package replaces libshared.so with the version from the Linksys 4.00.7 firmware.&nbsp; This libshared.so library works with both upnp and Whiterussian RC2 firmware.&nbsp; So, I think we can safely say that we&#039;re unlikely to see any conflicts with the nvram package.</p><p>Unfortunately, it still doesn&#039;t answer our problems about wi-fi breaking in your instance.&nbsp; I suppose it&#039;s so long ago now that you wouldn&#039;t be able to dig up information on what broke - the bad thing about that is that we now have a doubt.&nbsp; I hate doubt when you can&#039;t use proof to remove it. <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>Kaldek</p>											<p class="post-edited">(Last edited by <strong>kaldek</strong> on 23 Sep 2005, 07:42)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p12594">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">tanguy15</div>
					<div class="post-datetime">
						23 Sep 2005, 10:04					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m going to give it another try tonight with my 54GS and Whiterussian RC3. Keep you informed.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p12613">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">kaldek</div>
					<div class="post-datetime">
						23 Sep 2005, 17:32					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>tanguy15 wrote:</cite><blockquote><p>I&#039;m going to give it another try tonight with my 54GS and Whiterussian RC3. Keep you informed.</p></blockquote></div><p>Yeah I need to really upgrade to RC3, too.&nbsp; I&#039;ve got a busy weekend now though, so I may not get a chance to do it.&nbsp; Maybe Saturday night, if my wife doesn&#039;t need the Internet badly. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Kaldek</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p12620">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">tanguy15</div>
					<div class="post-datetime">
						23 Sep 2005, 22:25					</div>
				</div>
				<div class="post-content content">
					<p>I do confirm that the wifi doesn&#039;t work with the libshared.so extracted from WRT54GSV2.0_3.37.6_US and Whiterussian RC3.</p><p>By the way, the method explained in the FAQ to extract the binaries doesn&#039;t work with the latest firmwares, because it&#039;s not possible to grep &#039;Comp&#039; anymore. Any suggestion for a new way to extract the files ?</p><p>Cheers,</p><p>Tanguy</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p12628">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">kaldek</div>
					<div class="post-datetime">
						24 Sep 2005, 03:13					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>tanguy15 wrote:</cite><blockquote><p>I do confirm that the wifi doesn&#039;t work with the libshared.so extracted from WRT54GSV2.0_3.37.6_US and Whiterussian RC3.</p></blockquote></div><p>Alright, I&#039;ve updated the uPnP wiki page to say that wifi might break.&nbsp; However, that libshared.so you&#039;re using is ANCIENT.&nbsp; Please go and download &amp; install my IPK package for upnp and tell me if that works, because I have extracted a much newer binary from a *much* newer firmware.</p><div class="quotebox"><cite>tanguy15 wrote:</cite><blockquote><p>By the way, the method explained in the FAQ to extract the binaries doesn&#039;t work with the latest firmwares, because it&#039;s not possible to grep &#039;Comp&#039; anymore. Any suggestion for a new way to extract the files ?</p></blockquote></div><p>See this thread: <a href="http://forum.openwrt.org/viewtopic.php?id=1884">http://forum.openwrt.org/viewtopic.php?id=1884</a></p><p>Kaldek</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p12656">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">tanguy15</div>
					<div class="post-datetime">
						24 Sep 2005, 15:26					</div>
				</div>
				<div class="post-content content">
					<p>Kaldek,</p><p>I tried your package, and ....it works now for the wifi. Well done and thank you.</p><p>I followed the procedure to extract the binaries, but unfortunately, my Ubuntu Hoary doesn&#039;t support squashfs.</p><p>Tanguy</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p12722">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">kaldek</div>
					<div class="post-datetime">
						25 Sep 2005, 13:26					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>tanguy15 wrote:</cite><blockquote><p>Kaldek,<br />I tried your package, and ....it works now for the wifi. Well done and thank you.<br />Tanguy</p></blockquote></div><p>No - thank you!&nbsp; It&#039;s good that we track these bugs down. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />&nbsp; I&#039;ve installed RC3 now, and discovered that the nvram package is included in OpenWRT by default.&nbsp; Because of that, my install must use the &quot;-force-overwrite&quot; option when installing upnp onto RC3.&nbsp; The document now reflects this.</p><p>Also I have extracted the latest binary from firmware 4.20.07.&nbsp; I&#039;ve tested this on RC3 and it works - it&#039;s available here: <a href="http://members.optusnet.com.au/edwardluck/openwrt/packages/upnp-linksys_4.20.7_mipsel.ipk">http://members.optusnet.com.au/edwardlu â€¦ mipsel.ipk</a></p><p>Cheers,</p><p>Kaldek</p>											<p class="post-edited">(Last edited by <strong>kaldek</strong> on 25 Sep 2005, 14:53)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p12980">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">wbx</div>
					<div class="post-datetime">
						29 Sep 2005, 00:24					</div>
				</div>
				<div class="post-content content">
					<p>does upnp need a newer version of libshared.so?</p><p>May be we can update this in CVS HEAD.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p12993">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">kaldek</div>
					<div class="post-datetime">
						29 Sep 2005, 02:17					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>wbx wrote:</cite><blockquote><p>does upnp need a newer version of libshared.so?</p><p>May be we can update this in CVS HEAD.</p></blockquote></div><p>Yeah, it needs the libshared.so from the newer Linksys firmware.&nbsp; I&#039;m currently using the latest one from 4.20.07 (for the WRT54G).&nbsp; Based on the MD5 hashes calculated, the libshared.so image is still changing from revision to revision.&nbsp; I haven&#039;t tried running a comparison of the source code between them of course.</p><p>I suppose the decision on whether or not to include it in Whiterussian depends on the expected penetration of folks running upnp, and the possible ramifications of the continuous use of my Linksys binary version.&nbsp; If it won&#039;t hurt other applications, perhaps it is just best to include the newer version in Whiterussian.&nbsp; At least that way any problems may cause with other apps will probably be found earlier.</p><p>Kaldek</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>