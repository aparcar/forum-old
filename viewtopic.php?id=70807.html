<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Monitor mode - tcpdump in OpenWRT in VirtualBox hosted on windows 10</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 30 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p357706">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">randomguy123</div>
					<div class="post-datetime">
						3 May 2017, 16:20					</div>
				</div>
				<div class="post-content content">
					<p>Hi All.<br />I wanted to have OpenWRT guest on a windows 10 host in VirtualBox. We are using the current editions of VirtualBox – with 5.022 and the additional extension, installed. – see virtualbox website.</p><br /><p>I set up the virtual box as above. And after setting up the first part of the networking, I did the following, from the above link, and successfully got the internet to start working on the OpenWRT. <br />Enable Internet access through VirtualBox&#039;s NAT gateway<br />•&nbsp; &nbsp; In file /etc/config/network do the following<br /> …….some commands…&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p>Now, I would like to attach a USB wifi network adapter and put it into monitor mode, to run tcpdump in Openwrt. <br />Thus, we need an adapter which has monitor mode functionality – which I have, and it runs monitor mode perfectly when I access it through a pure Ubuntu system (without using virtual box)</p><p> I have the following adapters. – Ralink – Edimax , TP Link W725, and Ralink 2. All of them support monitor mode and have been tested as supporting monitor mode and running tcpdump in Ubuntu. </p><p>My quest is to have them running in Openwrt guest OS, in Windows 10 host OS. </p><p>All of the USB network adapters are being detected by the virtualbox, but none of them are being correctly associated with the guest operating system. i.e none of them have a TICK MARK, when you go to the DEVICES menu on the top of the virtualbox window. </p><p>Consequently, I am unable to get wlan0 (or some such) when I check IFCONFIG in Openwrt guest OS.</p><p>My PC doesn’t have USB 3, it has USB 2.0 – I tried that, I also tried USB 1.1 , since my laptop was made in 2007! </p><p> Some references:</p><br /><p>1.<br />^^^ USB devices work on host and get into monitor mode, when I start Ubuntu (my system is dual boot Ubuntu and Windows 8) </p><p>2.</p><br /><p>^ I have the done the following </p><p>A. Ensure that your host computer is using the original, Microsoft USB drivers:</p><p>&nbsp; &nbsp; 1. Right-click (My) Computer and click Manage.<br />&nbsp; &nbsp; 2. In the left pane of the Computer Management window, select Device Manager.<br />&nbsp; &nbsp; 3. Expand Universal Serial Bus Controllers.<br />&nbsp; &nbsp; 4. Right-click USB Root Hub and click Properties.<br />&nbsp; &nbsp; 5. On the Driver tab, click Roll Back Driver.</p><br /><br /><p>** My PC is an Intel Dual core. The other PCs where this is supposed to be working is also Intel Atom. </p><br /><p>•&nbsp; &nbsp; Do note that I have enabled successively, 1 , then when 1 didn’t work, 2, 3, and all 4 adapters attached to the virtualbox (Openwrt)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p358146">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">randomguy123</div>
					<div class="post-datetime">
						10 May 2017, 13:39					</div>
				</div>
				<div class="post-content content">
					<p>Update:</p><p>I am able to get the Mediatek 802.11 Ralink dongle to attach to the OpenWRT in bridged network adapter mode. But it still needs to be able to be turned down (ifconfig br-lan down) - this command works. </p><p>what does not work is sudo iwconfig br-lan mode monitor and then sudo ifconfig br-lan up and then </p><p>tcpdump ----it is not installed inside the custom build of openwrt that I have utilized in virtual box</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p358147">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">mk24</div>
					<div class="post-datetime">
						10 May 2017, 14:09					</div>
				</div>
				<div class="post-content content">
					<p>Create a monitor mode interface in /etc/config/wireless</p><div class="codebox"><pre><code>config wifi-iface
    option device radio0
    option ifname mon0
    option mode monitor</code></pre></div><p>Then if you run iw dev it should show you have a mon0 device.&nbsp; Attach to it directly for monitoring.</p><p>Since you need not use the wifi device for communication, you should only create the monitor interface on it, no STAs or APs.</p>											<p class="post-edited">(Last edited by <strong>mk24</strong> on 10 May 2017, 16:11)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>