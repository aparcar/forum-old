<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Latest version and procedure for D-Link DSL-504T</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 11 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p109262">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">narcisgarcia</div>
					<div class="post-datetime">
						17 May 2010, 20:24					</div>
				</div>
				<div class="post-content content">
					<p>Hello, I&#039;m newbie with OpenWRT.<br />I&#039;m looking for the way to install the OpenWRT firmware to this router model, but the information organisation in the openwrt.org web puts me this a little difficult to find the tutorial and the binary I need.</p><p>In different &quot;supported hardware&quot; lists I&#039;ve found the 504T model (with external links), but in other pages found a tutorial for a (compatible?) 524T model:<br /><a href="http://wiki.openwrt.org/toh/d-link/dsl-524t">http://wiki.openwrt.org/toh/d-link/dsl-524t</a></p><p>For AR7 chipset I find OpenWRT v10.03<br /><a href="http://downloads.openwrt.org/backfire/10.03/ar7/">http://downloads.openwrt.org/backfire/10.03/ar7/</a></p><p>And also OpenWRT v8.09.2<br /><a href="http://downloads.openwrt.org/kamikaze/8.09.2/ar7/">http://downloads.openwrt.org/kamikaze/8.09.2/ar7/</a></p><p>..but there I don&#039;t see any file with words &quot;dlink&quot; or &quot;504t&quot;.<br />Which one I need to choose?</p><p>Thanks.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p109314">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">narcisgarcia</div>
					<div class="post-datetime">
						18 May 2010, 16:02					</div>
				</div>
				<div class="post-content content">
					<p>These are the forum threads I&#039;ve found about D-Link DSL-504T:<br /><a href="https://forum.openwrt.org/viewtopic.php?id=5141">https://forum.openwrt.org/viewtopic.php?id=5141</a> (compiling)<br /><a href="https://forum.openwrt.org/viewtopic.php?id=18799">https://forum.openwrt.org/viewtopic.php?id=18799</a> (catching ADAM2)<br /><a href="https://forum.openwrt.org/viewtopic.php?id=18166">https://forum.openwrt.org/viewtopic.php?id=18166</a> (compiling and reflashing)<br /><a href="https://forum.openwrt.org/viewtopic.php?id=21678">https://forum.openwrt.org/viewtopic.php?id=21678</a> (old binaries)<br /><a href="https://forum.openwrt.org/viewtopic.php?pid=106709">https://forum.openwrt.org/viewtopic.php?pid=106709</a> (compiling)</p><p>Wiki page found for other similar model (D-Link DSL-502T):<br /><a href="http://wiki.openwrt.org/oldwiki/openwrtdocs/hardware/d_link/dsl_502t">http://wiki.openwrt.org/oldwiki/openwrt … k/dsl_502t</a></p><p>Other:<br /><a href="http://ziofork.altervista.org/appunti/openwrt_su_d-link_dsl-504t">http://ziofork.altervista.org/appunti/o … k_dsl-504t</a> (compiling from SVN)</p><p>And a question: can I just flash a file taken from this directory?:<br /><a href="http://downloads.openwrt.org/backfire/10.03/ar7/">http://downloads.openwrt.org/backfire/10.03/ar7/</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p109386">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">ath</div>
					<div class="post-datetime">
						19 May 2010, 10:22					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>narcisgarcia wrote:</cite><blockquote><p>I&#039;m looking for the way to install the OpenWRT firmware to this router model, but the information organisation in the openwrt.org web puts me this a little difficult to find the tutorial and the binary I need.</p></blockquote></div><p>Unfortunately the pages transferred from the old wiki are full of old informations and outdated bugs and procedures. We&#039;re in the process of creating new pages for the new table of hardware, but the testers for these routers are rare.</p><p>To the best of my knowledge, it should be pretty similar to the 524T. Just keep a copy the original firmware (and the original partitioning layout) at hand if anything goes wrong.</p><div class="quotebox"><cite>narcisgarcia wrote:</cite><blockquote><p>And a question: can I just flash a file taken from this directory?:<br /><a href="http://downloads.openwrt.org/backfire/10.03/ar7/">http://downloads.openwrt.org/backfire/10.03/ar7/</a></p></blockquote></div><p>The generic AR7 squashfs should work. You&#039;ll need to set the new partitions before flashing, though. It&#039;s a little tricky but the 524T guide should be useful.</p><p>Let us know how it goes, the other DSL-5xx pages need updates for the recent releases. It would be great to create a unified guide to the 5xx family in the wiki, but I don&#039;t have other routers to test except for my 524.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p109431">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">narcisgarcia</div>
					<div class="post-datetime">
						19 May 2010, 19:09					</div>
				</div>
				<div class="post-content content">
					<p>At this moment I&#039;m handling 3 routers of this model (504T), and have more around.</p><p>One note:<br />- On some factory firmware versions, the telnet login is &quot;root&quot; instead of the web login.</p><p>And one question:<br />I&#039;ve found my_ipaddress&nbsp; &nbsp; 10.8.8.8 , but it doesn&#039;t respond to ping setting the computer to 10.8.8.1 with any of these masks:<br />255.0.0.0<br />255.255.0.0<br />255.255.255.0<br />(with the last one I&#039;ve also tried to connect FTP unsuccessful)</p><p>What am I doing wrong?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p109444">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">narcisgarcia</div>
					<div class="post-datetime">
						19 May 2010, 21:53					</div>
				</div>
				<div class="post-content content">
					<p>Ok, I&#039;ve found that is needed to connect with FTP client only in the first seconds of router boot.<br />It seems that if you try to login with FTP, then the router doesn&#039;t start all the firmware (the status led remains off and the ADAM2 FTP server waits login), and if you want normal operation then the router must be restarted again.</p><p>Other informations detected for (some?) 504T:</p><p>- The username and password can be lowcase (adam2 adam2)<br />- in GNU/Linux the lftp tool is the one to manage right the remote commands and responses:<br /></p><div class="codebox"><pre><code>lftp ftp://adam2:adam2@10.8.8.8</code></pre></div><p>After this, I pick the information for the 5 partitions:<br /></p><div class="quotebox"><blockquote><p>mtd0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x900a0000,0x903f0000&nbsp; &nbsp;<br />mtd1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x90010000,0x900a0000&nbsp; &nbsp;<br />mtd2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x90000000,0x90010000&nbsp; &nbsp;<br />mtd3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x903f0000,0x90400000&nbsp; &nbsp;<br />mtd4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; environment variable not set.</p></blockquote></div><p>Which match with ZioFork tutorial.<br />One problem to transfer the new firmware is that when changing of FTP client (bye &quot;lftp&quot; and enter &quot;ftp&quot;), ADAM2 server doesn&#039;t accept a second FTP client connection. I needed to reboot the router to have FTP access again, and I&#039;ve run again the two last commands:<br /></p><div class="codebox"><pre><code>quote &quot;SETENV modulation MMODE&quot;
quote &quot;SETENV autoload 1&quot;
quote &quot;SETENV mtd4,0x90010000,0x903f0000&quot;</code></pre></div><p>But I&#039;m at this point: the new firmware image isn&#039;t transferred entirely for me. At the first try I&#039;ve transferred 2.4MiB (of the total 2.6MiB), and at all the next tries only 16KiB are transferred. Here the log of each try:<br /></p><div class="quotebox"><blockquote><p>$ ftp 10.8.8.8<br />Connected to 10.8.8.8.<br />220 ADAM2 FTP Server ready.<br />Name (10.8.8.8:narcisg): adam2<br />331 Password required for adam2.<br />Password:<br />230 User adam2 successfully logged in.<br />Remote system type is UNIX.<br />ftp&gt; quote &quot;SETENV modulation MMODE&quot;<br />200 SETENV command successful<br />ftp&gt; quote &quot;SETENV autoload 1&quot;<br />200 SETENV command successful<br />ftp&gt; quote &quot;SETENV mtd4,0x90010000,0x903f0000&quot;<br />200 SETENV command successful<br />ftp&gt; quote &quot;MEDIA FLSH&quot;<br />200 Media set to FLSH.<br />ftp&gt; bin<br />200 Type set to I.<br />ftp&gt; debug<br />Debugging on (debug=1).<br />ftp&gt; hash<br />Hash mark printing on (1024 bytes/hash mark).<br />ftp&gt; put &quot;openwrt-ar7-squashfs.bin&quot; &quot;OpenWRT mtd4&quot;<br />local: openwrt-ar7-squashfs.bin remote: OpenWRT mtd4<br />ftp: setsockopt (ignored): Permission denied<br />---&gt; PORT 10,8,8,1,229,152<br />200 Port command successful.<br />---&gt; STOR OpenWRT mtd4<br />150 Opening BINARY mode data connection for file transfer.<br />########</p></blockquote></div><p>ADAM2 is still accessible with the flashing procedure, but in normal boot the status led doesn&#039;t bright again.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p109456">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">ath</div>
					<div class="post-datetime">
						20 May 2010, 00:06					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>narcisgarcia wrote:</cite><blockquote><p>At this moment I&#039;m handling 3 routers of this model (504T), and have more around.</p></blockquote></div><p>Great to hear. AR7 devices are becoming difficult to find nowadays, that&#039;s a shame as they work almost perfectly with OpenWrt. I wonder what I&#039;ll do once I won&#039;t find them anymore on eBay <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><div class="quotebox"><cite>narcisgarcia wrote:</cite><blockquote><p>Other informations detected for (some?) 504T:</p></blockquote></div><p>Thanks, I&#039;ll take a look at updating the wiki pages. As for lftp/ftp, I&#039;ve noticed that ADAM2 seems picky about the client it&#039;s talking to. I&#039;ve had the most luck with netkit-ftp (with the root workaround described below).</p><div class="quotebox"><cite>narcisgarcia wrote:</cite><blockquote><p>But I&#039;m at this point: the new firmware image isn&#039;t transferred entirely for me. At the first try I&#039;ve transferred 2.4MiB (of the total 2.6MiB), and at all the next tries only 16KiB are transferred.<br />...<br />ftp: setsockopt (ignored): Permission denied</p></blockquote></div><p>Are you using a (somewhat) recent Linux kernel? I&#039;ve noticed a similar behaviour - the connection slows down considerably and seems to be stuck. Older kernels and OSes aren&#039;t affected. It has something to do with retransmission timeouts, but I haven&#039;t been able to track it down.</p><p>Try running the ftp client as root to avoid the &quot;Permission denied&quot; error, that way it should pick different timeouts and work better.</p>											<p class="post-edited">(Last edited by <strong>ath</strong> on 20 May 2010, 00:19)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p109490">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">narcisgarcia</div>
					<div class="post-datetime">
						20 May 2010, 14:02					</div>
				</div>
				<div class="post-content content">
					<p>Successful.<br />I was using Ubuntu GNU/Linux 9.10 (kernel 2.6.31-21) and I&#039;ve run this command before any FTP action:<br /></p><div class="codebox"><pre><code>sudo -i</code></pre></div><p>This has solved the transmission issue. Used the default &quot;ftp&quot; command line tool. After the transmission, sent this command with the FTP client:<br /></p><div class="codebox"><pre><code>quote &quot;REBOOT&quot;</code></pre></div><p>...and after several seconds the router has &quot;status&quot; led blinking. LuCI web interface available in <a href="http://192.168.1.1">http://192.168.1.1</a>/ and default login reached with user &quot;root&quot; and password &quot;admin&quot;. I see the router with OpenWRT listens SSH, but unknown username&amp;password to login.</p><p>One small-big pending question I see for tutorial: the procedure to backup the previous firmware before all the process.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p109546">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">ath</div>
					<div class="post-datetime">
						21 May 2010, 00:08					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>narcisgarcia wrote:</cite><blockquote><p>Successful.</p></blockquote></div><p>That&#039;s great! I&#039;ll update the 504T page later this week, then. Did you manage to connect it to an ADSL line? (I don&#039;t remember exactly but the DSL driver probably isn&#039;t included in the default AR7 images).</p><div class="quotebox"><cite>narcisgarcia wrote:</cite><blockquote><p>I see the router with OpenWRT listens SSH, but unknown username&amp;password to login.</p></blockquote></div><p>You&#039;ll probably need to login with telnet for the first time and then change the password for root to enable SSH access.</p><div class="quotebox"><cite>narcisgarcia wrote:</cite><blockquote><p>One small-big pending question I see for tutorial: the procedure to backup the previous firmware before all the process.</p></blockquote></div><p>I haven&#039;t tried, but it might be possible to backup the original firmware using the RETR ftp command at the ADAM2 prompt, in the same way the STOR command is used to reflash the unit.</p>											<p class="post-edited">(Last edited by <strong>ath</strong> on 21 May 2010, 00:09)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p109574">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">narcisgarcia</div>
					<div class="post-datetime">
						21 May 2010, 12:14					</div>
				</div>
				<div class="post-content content">
					<p>About SSH access: (this) LuCI doesn&#039;t respond to telnet.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110488">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">narcisgarcia</div>
					<div class="post-datetime">
						3 Jun 2010, 18:36					</div>
				</div>
				<div class="post-content content">
					<p>Firmware restore procedure in spanish:<br /><a href="http://www.adslzone.net/postt11770.html">http://www.adslzone.net/postt11770.html</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p116571">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">gcb</div>
					<div class="post-datetime">
						6 Sep 2010, 18:40					</div>
				</div>
				<div class="post-content content">
					<p>Hi folks,</p><p>&nbsp; &nbsp; Thank you for this discussion -- under the advice from their ISP, someone I know flashed their 504T to the latest available dlink firmware to overcome some issue, and of course they did what&#039;s always possible to do for the uninitiated -- they downloaded &amp; flashed the firmware from a rev C (GenII) 504T into a rev A model and effectively lobotomized the thing. Thanks to information here and some more pearls of wisdom from <a href="http://mcmcc.bat.ru/dlinkt/FW_dsl-xxxt_README.eng.txt">http://mcmcc.bat.ru/dlinkt/FW_dsl-xxxt_README.eng.txt</a> I&#039;ve been able to get the 504T conscious again using the openwrt-ar7-squashfs.bin image.<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Kudos to all!</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>