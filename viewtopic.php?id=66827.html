<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> 3G usb modems internet over an wifi router</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 24 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p334424">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">ashishbhogesara</div>
					<div class="post-datetime">
						14 Aug 2016, 09:32					</div>
				</div>
				<div class="post-content content">
					<p>Hello,<br />I have an 3G usb modem Dlink DWP-157 i want to use its internet through my wifi router I have a TP tl-wr740n v5 &amp; tl-mr3220 v2(although it has a usb port it does not support this usb dongle) please advice me how can i achieve this</p><p>Thank you</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p334860">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">MBS</div>
					<div class="post-datetime">
						18 Aug 2016, 00:11					</div>
				</div>
				<div class="post-content content">
					<p>Start with this: <a href="https://wiki.openwrt.org/doc/recipes/3gdongle">https://wiki.openwrt.org/doc/recipes/3gdongle</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p363398">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">mankomal</div>
					<div class="post-datetime">
						9 Aug 2017, 10:30					</div>
				</div>
				<div class="post-content content">
					<p>hello ahishbhigesara</p><p>Were you able to find a solution for this ?<br />I am looking for same combination</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p363441">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">lukasgl</div>
					<div class="post-datetime">
						10 Aug 2017, 00:08					</div>
				</div>
				<div class="post-content content">
					<p>Did you install OpenWrt on TL-MR3220? According to specs it has USB port. 4MB flash is not much but should do. I assume that DWP-157 uses RAS so it might work.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p363456">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">mankomal</div>
					<div class="post-datetime">
						10 Aug 2017, 08:51					</div>
				</div>
				<div class="post-content content">
					<p>yes so I did install OpenWrt but there is nothing on interface to configure so just wondering if need to do something extra for this to work</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p363464">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">lukasgl</div>
					<div class="post-datetime">
						10 Aug 2017, 12:01					</div>
				</div>
				<div class="post-content content">
					<p>Try this steps:</p><p>1. Plug modem to USB port.<br />2 .Connect to router using SSH.<br />3. Execute following commands to install packages.<br /></p><div class="codebox"><pre><code># opkg update
# opkg install kmod-usb-core kmod-usb2 usb-modeswitch libusb-1.0
# opkg install chat comgt kmod-usb-serial kmod-usb-serial-option</code></pre></div><p>Check modem if LED started blinking.<br />4. Write commands to configure 3G connection.<br /><strong>You have to set your APN, user name, password and SIM card PIN number. If there is no PIN/uname/password, just omit this lines. Wrong PIN may lock card!</strong></p><div class="codebox"><pre><code># uci del network.wan
# uci set network.wan=interface
# uci set network.wan.proto=3g
# uci set network.wan.device=/dev/ttyUSB0
# uci set network.wan.pincode=1234
# uci set network.wan.apn=apn_name
# uci set network.wan.username=user_name
# uci set network.wan.password=password
# uci commit network
# reboot</code></pre></div><p>After reboot router should establish connection.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p363849">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">TracieDLeon</div>
					<div class="post-datetime">
						17 Aug 2017, 06:56					</div>
				</div>
				<div class="post-content content">
					<p>lukasgl&#039;s instruction worked for me. You should try it.<br />Thank you, lukasgl</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p373850">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">ashish_chugh</div>
					<div class="post-datetime">
						16 Mar 2018, 09:12					</div>
				</div>
				<div class="post-content content">
					<p>Hi lukasgl,</p><p>I am using combination of TP-LINK router(Model: TL-MR3020) with OpenWrt firmware (Firmware Version: Barrier Breaker 14.07) and D-Link 3G usb modem (Model:&nbsp; DWP-157) to access internet via the WiFi created by router.<br />I followed all the steps mentioned in your post but when I plug the usb modem in the router, the router is unable to mount it (that means no /dev/ttyUSB is created ).</p><p>Following are the dmesg logs when D-Link dongle is connected:<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# dmesg
[176664.480000] usb 1-1: new high-speed USB device number 10 using ehci-platform
[176664.640000] usb-storage 1-1:1.0: USB Mass Storage device detected
[176664.640000] scsi11 : usb-storage 1-1:1.0
[176665.650000] scsi 11:0:0:0: CD-ROM            HSPA USB SCSI CD-ROM      6225 PQ: 0 ANSI: 0 CCS</code></pre></div><p>But when I use the Huawei usb modem(Model:E3531) in place of D-Link, it gets mounted in few seconds and I can also access internet. <br />Following are the dmesg logs when Huawei dongle is connected:<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# dmesg
[177273.110000] usb 1-1: new high-speed USB device number 13 using ehci-platform
[177273.350000] usb-storage 1-1:1.0: USB Mass Storage device detected
[177273.350000] scsi15 : usb-storage 1-1:1.0
[177273.820000] usb 1-1: USB disconnect, device number 13
[177275.170000] usb 1-1: new high-speed USB device number 14 using ehci-platform
[177275.390000] option 1-1:1.0: GSM modem (1-port) converter detected
[177275.390000] usb 1-1: GSM modem (1-port) converter now attached to ttyUSB0
[177275.410000] option 1-1:1.2: GSM modem (1-port) converter detected
[177275.410000] usb 1-1: GSM modem (1-port) converter now attached to ttyUSB1
[177275.420000] option 1-1:1.3: GSM modem (1-port) converter detected
[177275.440000] usb 1-1: GSM modem (1-port) converter now attached to ttyUSB2
[177275.440000] usb-storage 1-1:1.4: USB Mass Storage device detected
[177275.460000] scsi16 : usb-storage 1-1:1.4
[177275.460000] usb-storage 1-1:1.5: USB Mass Storage device detected
[177275.480000] scsi17 : usb-storage 1-1:1.5
[177276.190000] option1 ttyUSB0: option_instat_callback: error -2
[177276.460000] scsi 16:0:0:0: CD-ROM            HUAWEI   Mass Storage     2.31 PQ: 0 ANSI: 2
[177276.480000] scsi 17:0:0:0: Direct-Access     HUAWEI   TF CARD Storage  2.31 PQ: 0 ANSI: 2
[177276.500000] sd 17:0:0:0: [sda] Attached SCSI removable disk</code></pre></div><br /><p>Please help me in resolving this issue.</p><p>Thank you,<br />Ashish Chugh</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>