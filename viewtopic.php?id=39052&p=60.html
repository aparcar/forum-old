<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> mwan3; multi-wan policy routing (general topic)</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 22 May 2013 and 6 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 60 of 65</div><nav><ul><li><a href="viewtopic.php%3Fid=39052&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=39052&amp;p=58.html">58</a></li><li><a href="viewtopic.php%3Fid=39052&amp;p=59.html">59</a></li><li class="pagination-current"><span>60</span></li><li><a href="viewtopic.php%3Fid=39052&amp;p=61.html">61</a></li><li><a href="viewtopic.php%3Fid=39052&amp;p=62.html">62</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=39052&amp;p=65.html">65</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p304497">
				<div class="post-metadata">
					<div class="post-num">Post #1476</div>
					<div class="post-author">wacke</div>
					<div class="post-datetime">
						21 Dec 2015, 16:25					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Adze wrote:</cite><blockquote><p>Hi wacke,</p><p>As off version 2.0.1 you need to create the ipset yourself, before it is added to the rules. This is done because i had recieved issues about user created ipsets not working correctly, as mwan3 created them with other parameters. I decided that if you wish to use an ipset set in your rules, you should create the set yourself beforehand.</p></blockquote></div><p>Thank you for your reply.I really need the mwan3 work with the ipset,it is the esaiest way to get through gfw with vpn.I&#039;ll get back the mwan3 to 1.6.3 version.Thank you for your works,it&#039;s amazing!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p304624">
				<div class="post-metadata">
					<div class="post-num">Post #1477</div>
					<div class="post-author">phineasmax</div>
					<div class="post-datetime">
						22 Dec 2015, 16:25					</div>
				</div>
				<div class="post-content content">
					<p>Hello. I&#039;m having a problem with mwan3.<br />I have 2 WAN, 1 is WAN port, 1 is Wireless WAN. I&#039;m using mwan3 default config.<br />In MWAN Detailed Status, Policy balanced is only have 1 wan. WAN2 is missing in policy balanced. I need 2 wan in policy balanced (60/40). Could you help me?<br />My MWAN Detailed Status<br /></p><div class="codebox"><pre><code>Interface status:
Interface wan is online (tracking active)
Interface wan2 is online (tracking active)

Policy balanced:
 wan (100%)

Policy wan2_only:
 wan2 (100%)

Policy wan2_wan:
 wan2 (100%)

Policy wan_only:
 wan (100%)

Policy wan_wan2:
 wan (100%)

Known networks:
destination        policy             hits     
-----------------------------------------------
127.0.0.0/8        default            0        
224.0.0.0/3        default            81       
192.168.1.0/24     default            195      
192.168.2.0/24     default            1606     
192.168.254.0/24   default            4777     
127.0.0.0          default            0        
127.0.0.0/8        default            0        
127.0.0.1          default            0        
127.255.255.255    default            0        
192.168.1.0        default            0        
192.168.1.2        default            176      
192.168.1.255      default            17       
192.168.2.0        default            0        
192.168.2.1        default            515      
192.168.2.255      default            0        
192.168.254.0      default            0        
192.168.254.241    default            4777     
192.168.254.255    default            0        

Active rules:
source             destination        proto  src-port      dest-port     policy          hits     
--------------------------------------------------------------------------------------------------
0.0.0.0/0.0.0.1    0.0.0.0/0          tcp    0:65535       443           wan_wan2        403      
0.0.0.1/0.0.0.1    0.0.0.0/0          tcp    0:65535       443           wan2_wan        0        
0.0.0.0/0          0.0.0.0/0          all                                wan_wan2        10344
 </code></pre></div><p>And MWAN config:<br /></p><div class="codebox"><pre><code>config rule &#039;sticky_even&#039;
    option src_ip &#039;0.0.0.0/0.0.0.1&#039;
    option dest_port &#039;443&#039;
    option proto &#039;tcp&#039;
    option use_policy &#039;wan_wan2&#039;

config rule &#039;sticky_odd&#039;
    option src_ip &#039;0.0.0.1/0.0.0.1&#039;
    option dest_port &#039;443&#039;
    option proto &#039;tcp&#039;
    option use_policy &#039;wan2_wan&#039;

config policy &#039;wan2_wan&#039;
    list use_member &#039;wan_m2_w3&#039;
    list use_member &#039;wan2_m1_w2&#039;

config policy &#039;balanced&#039;
    list use_member &#039;wan_m1_w3&#039;
    list use_member &#039;wan2_m1_w2&#039;

config policy &#039;wan2_only&#039;
    list use_member &#039;wan2_m1_w2&#039;

config policy &#039;wan_wan2&#039;
    list use_member &#039;wan_m1_w3&#039;
    list use_member &#039;wan2_m2_w2&#039;

config policy &#039;wan_only&#039;
    list use_member &#039;wan_m1_w3&#039;

config interface &#039;wan&#039;
    option enabled &#039;1&#039;
    option count &#039;1&#039;
    option timeout &#039;2&#039;
    option interval &#039;5&#039;
    option down &#039;3&#039;
    option up &#039;8&#039;
    list track_ip &#039;8.8.8.8&#039;
    list track_ip &#039;208.67.220.220&#039;
    option reliability &#039;1&#039;

config interface &#039;wan2&#039;
    list track_ip &#039;8.8.8.8&#039;
    list track_ip &#039;208.67.220.220&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option timeout &#039;2&#039;
    option interval &#039;5&#039;
    option down &#039;3&#039;
    option up &#039;8&#039;
    option enabled &#039;1&#039;

config member &#039;wan_m1_w3&#039;
        option interface &#039;wan&#039;
        option metric &#039;1&#039;
        option weight &#039;3&#039;

config member &#039;wan_m2_w3&#039;
        option interface &#039;wan&#039;
        option metric &#039;2&#039;
        option weight &#039;3&#039;

config member &#039;wan2_m1_w2&#039;
        option interface &#039;wan2&#039;
        option metric &#039;1&#039;
        option weight &#039;2&#039;

config member &#039;wan2_m2_w2&#039;
        option interface &#039;wan2&#039;
        option metric &#039;2&#039;
        option weight &#039;2&#039;

config policy &#039;wan_only&#039;
        list use_member &#039;wan_m1_w3&#039;

config policy &#039;wan2_only&#039;
        list use_member &#039;wan2_m1_w2&#039;

config policy &#039;balanced&#039;
        list use_member &#039;wan_m1_w3&#039;
        list use_member &#039;wan2_m1_w2&#039;

config policy &#039;wan_wan2&#039;
        list use_member &#039;wan_m1_w3&#039;
        list use_member &#039;wan2_m2_w2&#039;

config policy &#039;wan2_wan&#039;
        list use_member &#039;wan_m2_w3&#039;
        list use_member &#039;wan2_m1_w2&#039;

config rule &#039;default_rule&#039;
        option dest_ip &#039;0.0.0.0/0&#039;
        option use_policy &#039;wan_wan2&#039;</code></pre></div><p>Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p304626">
				<div class="post-metadata">
					<div class="post-num">Post #1478</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						22 Dec 2015, 16:33					</div>
				</div>
				<div class="post-content content">
					<p>Hi phineasmax,</p><br /><p>Your mwan3 config has some duplicate policy statements. For example the policy balanced is defined twice. Please cleanup your config and try again.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p304706">
				<div class="post-metadata">
					<div class="post-num">Post #1479</div>
					<div class="post-author">phineasmax</div>
					<div class="post-datetime">
						23 Dec 2015, 03:37					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Adze wrote:</cite><blockquote><p>Hi phineasmax,</p><br /><p>Your mwan3 config has some duplicate policy statements. For example the policy balanced is defined twice. Please cleanup your config and try again.</p></blockquote></div><p>Thanks Adze! It&#039;s works!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p304723">
				<div class="post-metadata">
					<div class="post-num">Post #1480</div>
					<div class="post-author">muronghan</div>
					<div class="post-datetime">
						23 Dec 2015, 06:03					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>wacke wrote:</cite><blockquote><div class="quotebox"><cite>Adze wrote:</cite><blockquote><p>Hi wacke,</p><p>As off version 2.0.1 you need to create the ipset yourself, before it is added to the rules. This is done because i had recieved issues about user created ipsets not working correctly, as mwan3 created them with other parameters. I decided that if you wish to use an ipset set in your rules, you should create the set yourself beforehand.</p></blockquote></div><p>Thank you for your reply.I really need the mwan3 work with the ipset,it is the esaiest way to get through gfw with vpn.I&#039;ll get back the mwan3 to 1.6.3 version.Thank you for your works,it&#039;s amazing!</p></blockquote></div><p>Hi Wache, do you deploy shadowsocks in your openwrt router? Can shadowsocks co-exist with mwan3? I found when I turn mwan3 on, shadowsocks stoped, while shadowsocks on mwan would not work.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p304799">
				<div class="post-metadata">
					<div class="post-num">Post #1481</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						23 Dec 2015, 16:57					</div>
				</div>
				<div class="post-content content">
					<p>Hi muronghan,</p><p>Mayby it is the same problem as with privoxy? <a href="https://wiki.openwrt.org/doc/howto/mwan3#privoxy_transparent_http_proxy">https://wiki.openwrt.org/doc/howto/mwan … http_proxy</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p304893">
				<div class="post-metadata">
					<div class="post-num">Post #1482</div>
					<div class="post-author">muronghan</div>
					<div class="post-datetime">
						24 Dec 2015, 09:45					</div>
				</div>
				<div class="post-content content">
					<p>Hi, Adze, I think Shadowsocks might be something like transparent proxy. Please refer to <a href="https://github.com/shadowsocks/shadowsocks-libev/blob/master/README.md#advanced-usage.">https://github.com/shadowsocks/shadowso … ced-usage.</a> esp. for &quot;Advanced usage&quot; part. </p><p>I do not have too much knowledge about Shadowsocks. It seems to nominate a local port e.g. 1080 to listen. And to avoid DNS pollution, e.g. <a href="http://www.google.com">www.google.com</a> is blocked., set &quot;server=/google.com/127.0.0.1#5300(or any other port)&quot; in /etc/dnsmasq.conf. Using UDP forwarding port 5300 thru ss-tunnel towards 8.8.8.8. etc.</p><p>In my country, VPN almost dies due to the censorship (only a few works at windows client using cheating technologies). Shadowsocks is now the most popular weapon for freedom. Although the author was arrested a few months ago and released after promising to cease this project, luckily still some brave people continue its development and maintenance. Adze, I know you hate censorship so please do help here. I read the wiki about the fix of transparent proxy on mwan3 but still have no further idea so I need you advice.</p><p>Taking this opportunity, I wish you a Merry Christmas and a Happy New Year!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p304895">
				<div class="post-metadata">
					<div class="post-num">Post #1483</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						24 Dec 2015, 10:38					</div>
				</div>
				<div class="post-content content">
					<p>Hi muronghan,</p><p>Looking at the link you posted, i think it is possible, but it requires some changes in config of mwan3 as well in shadowsocks. Maybe you could try it and report back?</p><p>Iptables mangle table is handled before nat table. So in layman&#039;s terms mwan3 comes before shadowsocks. So we have to tell mwan3 which traffic to load-balance and which traffic you wish to have tunneled by shadowsocks. Traffic with policy default will be handled by shadowsocks.</p><p>The Mwan3 config would look something like this:<br /></p><div class="codebox"><pre><code>#Create a rule that traffic from router itself can be loadbalanced by a user defined policy.
config &#039;rule&#039; &#039;rule1&#039;
    option &#039;src_ip&#039; &#039;10.0.2.1&#039;
    option &#039;dest_ip&#039; &#039;0.0.0.0/0&#039;
    option &#039;use_policy&#039; &#039;loadbalanced&#039;

#Create a rule that all other traffic should NOT be handled by mwan3 (use policy default) as shadowsocks will then pick this up.
config &#039;rule&#039; &#039;rule2&#039;
    option &#039;dest_ip&#039; &#039;0.0.0.0/0&#039;
    option &#039;use_policy&#039; &#039;default&#039;</code></pre></div><p>And the Shadowsocks something like this (only changed the fwmark part, rest is default as copied form their site):<br /></p><div class="codebox"><pre><code># Create new chain
root@Wrt:~# iptables -t nat -N SHADOWSOCKS
root@Wrt:~# iptables -t mangle -N SHADOWSOCKS

# Ignore your shadowsocks server&#039;s addresses. It&#039;s very IMPORTANT, just be careful.
root@Wrt:~# iptables -t nat -A SHADOWSOCKS -d 123.123.123.123 -j RETURN

# Ignore LANs and any other addresses you&#039;d like to bypass the proxy
root@Wrt:~# iptables -t nat -A SHADOWSOCKS -d 0.0.0.0/8 -j RETURN
root@Wrt:~# iptables -t nat -A SHADOWSOCKS -d 10.0.0.0/8 -j RETURN
root@Wrt:~# iptables -t nat -A SHADOWSOCKS -d 127.0.0.0/8 -j RETURN
root@Wrt:~# iptables -t nat -A SHADOWSOCKS -d 169.254.0.0/16 -j RETURN
root@Wrt:~# iptables -t nat -A SHADOWSOCKS -d 172.16.0.0/12 -j RETURN
root@Wrt:~# iptables -t nat -A SHADOWSOCKS -d 192.168.0.0/16 -j RETURN
root@Wrt:~# iptables -t nat -A SHADOWSOCKS -d 224.0.0.0/4 -j RETURN
root@Wrt:~# iptables -t nat -A SHADOWSOCKS -d 240.0.0.0/4 -j RETURN

# Anything else should be redirected to shadowsocks&#039;s local port
root@Wrt:~# iptables -t nat -A SHADOWSOCKS -p tcp -j REDIRECT --to-ports 12345

# Add any UDP rules (use fwmark 0x010000 to avoid conflict with mwan3 or QoS)
root@Wrt:~# ip rule add fwmark 0x010000/0x010000 table 10000
root@Wrt:~# ip route add local 0.0.0.0/0 dev lo table 10000
root@Wrt:~# iptables -t mangle -A SHADOWSOCKS -p udp --dport 53 -j TPROXY --on-port 12345 --tproxy-mark 0x010000/0x010000

# Apply the rules
root@Wrt:~# iptables -t nat -A PREROUTING -p tcp -j SHADOWSOCKS
root@Wrt:~# iptables -t mangle -A PREROUTING -j SHADOWSOCKS

# Start the shadowsocks-redir
root@Wrt:~# ss-redir -u -c /etc/config/shadowsocks.json -f /var/run/shadowsocks.pid</code></pre></div><p>As to see if shadowserver works at all with mwan3 running, try first with only rule 2 (policy default) enabled. If this works add more mwan3 rules. Good luck!</p>											<p class="post-edited">(Last edited by <strong>Adze</strong> on 24 Dec 2015, 10:40)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p304996">
				<div class="post-metadata">
					<div class="post-num">Post #1484</div>
					<div class="post-author">bobptz</div>
					<div class="post-datetime">
						25 Dec 2015, 16:58					</div>
				</div>
				<div class="post-content content">
					<p>What exactly is the interface &quot;gateway metric&quot;?</p><p>The only thing I found are recommendations that wan should default to value 10, wan2 to 20, wan3 to 30 etc. </p><p>Does it matter if I set them to 5, 15, 25 or 0,1,2 respectively?&nbsp; Is it just a unique id number?&nbsp; Does it carry some weight value and wan1 with gateway metric of 10 is preferred over wan2 with gateway metric 20?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p305009">
				<div class="post-metadata">
					<div class="post-num">Post #1485</div>
					<div class="post-author">arfett</div>
					<div class="post-datetime">
						25 Dec 2015, 18:57					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>bobptz wrote:</cite><blockquote><p>What exactly is the interface &quot;gateway metric&quot;?</p><p>The only thing I found are recommendations that wan should default to value 10, wan2 to 20, wan3 to 30 etc. </p><p>Does it matter if I set them to 5, 15, 25 or 0,1,2 respectively?&nbsp; Is it just a unique id number?&nbsp; Does it carry some weight value and wan1 with gateway metric of 10 is preferred over wan2 with gateway metric 20?</p></blockquote></div><p>Yes it is just to make the interfaces unique to mwan3.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p305010">
				<div class="post-metadata">
					<div class="post-num">Post #1486</div>
					<div class="post-author">bobptz</div>
					<div class="post-datetime">
						25 Dec 2015, 19:24					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>arfett wrote:</cite><blockquote><p>Yes it is just to make the interfaces unique to mwan3.</p></blockquote></div><p>Thank you for your answer.</p><p>So I could setup 3-4 wan interfaces with the same name, but different &quot;gateway metric&quot;?&nbsp; And mwan3 would work?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p305034">
				<div class="post-metadata">
					<div class="post-num">Post #1487</div>
					<div class="post-author">arfett</div>
					<div class="post-datetime">
						26 Dec 2015, 02:22					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>bobptz wrote:</cite><blockquote><div class="quotebox"><cite>arfett wrote:</cite><blockquote><p>Yes it is just to make the interfaces unique to mwan3.</p></blockquote></div><p>Thank you for your answer.</p><p>So I could setup 3-4 wan interfaces with the same name, but different &quot;gateway metric&quot;?&nbsp; And mwan3 would work?</p></blockquote></div><p>They can&#039;t have the same name with or without mwan3.</p>											<p class="post-edited">(Last edited by <strong>arfett</strong> on 26 Dec 2015, 02:22)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p305141">
				<div class="post-metadata">
					<div class="post-num">Post #1488</div>
					<div class="post-author">wacke</div>
					<div class="post-datetime">
						27 Dec 2015, 05:20					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>muronghan wrote:</cite><blockquote><div class="quotebox"><cite>wacke wrote:</cite><blockquote><div class="quotebox"><cite>Adze wrote:</cite><blockquote><p>Hi wacke,</p><p>As off version 2.0.1 you need to create the ipset yourself, before it is added to the rules. This is done because i had recieved issues about user created ipsets not working correctly, as mwan3 created them with other parameters. I decided that if you wish to use an ipset set in your rules, you should create the set yourself beforehand.</p></blockquote></div><p>Thank you for your reply.I really need the mwan3 work with the ipset,it is the esaiest way to get through gfw with vpn.I&#039;ll get back the mwan3 to 1.6.3 version.Thank you for your works,it&#039;s amazing!</p></blockquote></div><p>Hi Wache, do you deploy shadowsocks in your openwrt router? Can shadowsocks co-exist with mwan3? I found when I turn mwan3 on, shadowsocks stoped, while shadowsocks on mwan would not work.</p></blockquote></div><p>I&#039;m using shadowvpn not shadowsocks,mabe shadowsocks using ipset(conflicted with mwan3)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p305158">
				<div class="post-metadata">
					<div class="post-num">Post #1489</div>
					<div class="post-author">bobptz</div>
					<div class="post-datetime">
						27 Dec 2015, 12:40					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>arfett wrote:</cite><blockquote><p>Yes it is just to make the interfaces unique to mwan3.</p></blockquote></div><p>Why then the manual (<a href="https://wiki.openwrt.org/doc/howto/mwan3">https://wiki.openwrt.org/doc/howto/mwan3</a>) stresses that the primary wan should have the lowest value?<br />&quot;...This metric will only have an effect on the default routing table...<br />The default (primary) WAN interface should have the <strong>lowest metric</strong> (e.g. 10) and each additional WAN interface a higher metric (e.g. 20, 30, etc.). Values are not important, but should always be unique.&quot;</p><p>So I think that the wan with the lowest metric is preferred, through the rules in the default routing table (although my knowledge is limited and I do not know how the routing table works).</p>											<p class="post-edited">(Last edited by <strong>bobptz</strong> on 27 Dec 2015, 12:57)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p305264">
				<div class="post-metadata">
					<div class="post-num">Post #1490</div>
					<div class="post-author">sharkys</div>
					<div class="post-datetime">
						28 Dec 2015, 11:20					</div>
				</div>
				<div class="post-content content">
					<p>Guys,<br />any idea what to do if mwan3 do not print any output on Command line (two days old trunk), I mean totally nothing...<br />I decided to update 4/5 months old trunk and it don&#039;t work now, if anyone can point out potential issue, would be great.<br />Not posting config, currently not at the router.</p><p>Thank you.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p305266">
				<div class="post-metadata">
					<div class="post-num">Post #1491</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						28 Dec 2015, 11:34					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>sharkys wrote:</cite><blockquote><p>Guys,<br />any idea what to do if mwan3 do not print any output on Command line (two days old trunk), I mean totally nothing...<br />I decided to update 4/5 months old trunk and it don&#039;t work now, if anyone can point out potential issue, would be great.<br />Not posting config, currently not at the router.</p></blockquote></div><p>Hi sharkys,</p><p>Please try this:</p><p><a href="https://forum.openwrt.org/viewtopic.php?pid=301445#p301445">https://forum.openwrt.org/viewtopic.php … 45#p301445</a><br /><a href="https://forum.openwrt.org/viewtopic.php?pid=301506#p301506">https://forum.openwrt.org/viewtopic.php … 06#p301506</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p305272">
				<div class="post-metadata">
					<div class="post-num">Post #1492</div>
					<div class="post-author">sharkys</div>
					<div class="post-datetime">
						28 Dec 2015, 12:31					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Adze wrote:</cite><blockquote><div class="quotebox"><cite>sharkys wrote:</cite><blockquote><p>Guys,<br />any idea what to do if mwan3 do not print any output on Command line (two days old trunk), I mean totally nothing...<br />I decided to update 4/5 months old trunk and it don&#039;t work now, if anyone can point out potential issue, would be great.<br />Not posting config, currently not at the router.</p></blockquote></div><p>Hi sharkys,</p><p>Please try this:</p><p><a href="https://forum.openwrt.org/viewtopic.php?pid=301445#p301445">https://forum.openwrt.org/viewtopic.php … 45#p301445</a><br /><a href="https://forum.openwrt.org/viewtopic.php?pid=301506#p301506">https://forum.openwrt.org/viewtopic.php … 06#p301506</a></p></blockquote></div><p>Thank you @Adze, really appreciate such quick help, didn&#039;t expect that.</p><p>I did :<br />mwan3 status<br />echo $?</p><p>And got code 7 - because I don&#039;t have ip6tables compiled in the trunk...didn&#039;t know it is mandatory pre-requisite.</p><p>Thank you.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p305274">
				<div class="post-metadata">
					<div class="post-num">Post #1493</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						28 Dec 2015, 12:49					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>sharkys wrote:</cite><blockquote><p>And got code 7 - because I don&#039;t have ip6tables compiled in the trunk...didn&#039;t know it is mandatory pre-requisite.</p></blockquote></div><p>It&#039;s sort of a bug, as ip6tables should not be mandatory. Without though it will generate a lot of errors atm. I will update mwan3 in the near future, with a more intelligent way of checking if ip6tables is available.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p305308">
				<div class="post-metadata">
					<div class="post-num">Post #1494</div>
					<div class="post-author">bobptz</div>
					<div class="post-datetime">
						28 Dec 2015, 21:11					</div>
				</div>
				<div class="post-content content">
					<p>I want to create a rule (work-rule) that will give top priority to a specific pc (let&#039;s name it work-pc) in the LAN.&nbsp; For this purpose I assigned it a static IP (ie 192.168.1.5).&nbsp; I assigned to this rule (very high in the rules table) with some policies with low metric and high weight values and source address 192.168.1.5.</p><p>Is this a correct setup?</p><p>My worry is that all other rules lower will be ignored.&nbsp; Like the HTTPS, if I put this lower, then I will be kicked out from https sites, right?&nbsp; So what is the correct way to do this?&nbsp; </p><p>I could put work-rule lower than the https rule.&nbsp; But I also want my work-pc to have higher precedence over other pcs when visiting https sites.</p><p>So how do I do this?</p><br /><br /><p>PS: for some strange reason my pc behaves today as if no rules exist.&nbsp; Like I disabled a specific sticky forum rule, but the forum does not kick me out today, as it did 2 days ago, before I did the rule.&nbsp; </p><p>Is there a way to see where the traffic goes, what rule is used etc?&nbsp; Is wireshark the only way to investigate network traffic?</p>											<p class="post-edited">(Last edited by <strong>bobptz</strong> on 28 Dec 2015, 22:26)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p305317">
				<div class="post-metadata">
					<div class="post-num">Post #1495</div>
					<div class="post-author">bobptz</div>
					<div class="post-datetime">
						28 Dec 2015, 23:14					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>bobptz wrote:</cite><blockquote><p>PS: for some strange reason my pc behaves today as if no rules exist.&nbsp; Like I disabled a specific sticky forum rule, but the forum does not kick me out today, as it did 2 days ago, before I did the rule.</p></blockquote></div><p>I found out what caused this erratic behaviour.&nbsp; SQM-scripts (for QoS).</p><p>Somehow sqm-scripts FIXES things and I can browse forums and edit posts without the need for sticky rules (which force the same wan to be used on the same forum session).&nbsp; When I disabled SQM, I had to bring back the mwan3 rules, or the forums would kick me off.</p><p>Now I need to find someone who knows both SQM and MWAN3, to explain this.</p>											<p class="post-edited">(Last edited by <strong>bobptz</strong> on 28 Dec 2015, 23:15)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p305361">
				<div class="post-metadata">
					<div class="post-num">Post #1496</div>
					<div class="post-author">muronghan</div>
					<div class="post-datetime">
						29 Dec 2015, 03:51					</div>
				</div>
				<div class="post-content content">
					<p>Hi Adze, I just tried to change the fwmark value in some files of shadowsocks to your instruction, but there was no luck so far. If you are still interested in this problem, I could pm you some configuration files for further debugging.</p><p>I purchased a VPS (Virtual Private Server) so I could setup OpenVPN server on VPS in parallel. Currently I have two ISP physical lines and I could treat openvpn client as the third one on the openwrt router, thanks to mwan3. I searched how-to under this thread. There are quite some discussions however, I am still confused.</p><p>Should I add the following in /etc/config/network:</p><p>&nbsp; &nbsp; config interface &#039;VPN&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;tun0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option defaultroute &#039;1&#039;</p><p>&nbsp; &nbsp; config &#039;route&#039; &#039;default_VPN&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;interface&#039; &#039;VPN&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;target&#039; &#039;0.0.0.0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;netmask&#039; &#039;0.0.0.0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;gateway&#039; &#039;172.20.24.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;metric&#039; &#039;30&#039;</p><p>And then add the following in /etc/config/openvpn.conf ?</p><p>&nbsp; &nbsp; &nbsp; &nbsp; route-nopull<br />&nbsp; &nbsp; &nbsp; &nbsp; route 0.0.0.0 0.0.0.0 172.20.24.1 30</p>											<p class="post-edited">(Last edited by <strong>muronghan</strong> on 29 Dec 2015, 04:12)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p305365">
				<div class="post-metadata">
					<div class="post-num">Post #1497</div>
					<div class="post-author">axishero</div>
					<div class="post-datetime">
						29 Dec 2015, 06:28					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>kpv wrote:</cite><blockquote><p>I happened to come across this old discussion at Mikrotik&#039;s forum <a href="http://forum.mikrotik.com/viewtopic.php?f=2&amp;t=53657">http://forum.mikrotik.com/viewtopic.php?f=2&amp;t=53657</a> which raised several questions:</p><p>2) Can we use ipset in conjunction with mwan3?</p><p>e.g. one could put all his ISP-A IP networks in an ipset and then policy-route VoIP traffic to that ISP-A&#039;s SIP server via that same ISP-A&#039;s wan.</p><p>Or one could use ipset-dns to policy-route certain domain wirldcards e.g. <a href="https://forum.openwrt.org/viewtopic.php?pid=207497#p207497">https://forum.openwrt.org/viewtopic.php … 97#p207497</a> or not balance certain domains.</p></blockquote></div><p>Is this function added now?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p305438">
				<div class="post-metadata">
					<div class="post-num">Post #1498</div>
					<div class="post-author">moeller0</div>
					<div class="post-datetime">
						29 Dec 2015, 20:47					</div>
				</div>
				<div class="post-content content">
					<p>Hi Bobptz,</p><div class="quotebox"><cite>bobptz wrote:</cite><blockquote><div class="quotebox"><cite>bobptz wrote:</cite><blockquote><p>PS: for some strange reason my pc behaves today as if no rules exist.&nbsp; Like I disabled a specific sticky forum rule, but the forum does not kick me out today, as it did 2 days ago, before I did the rule.</p></blockquote></div><p>I found out what caused this erratic behaviour.&nbsp; SQM-scripts (for QoS).</p><p>Somehow sqm-scripts FIXES things</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; Let me assure you SQM does not FIX anything here; most likely you see an unwanted interaction between the two packages, I believe both strive to be transparent to others... It might be related to the sequence of the interfaces (did you set-up mwan3 on both eth0.3 and pppoe-wan?) or the iptables mark bits bot packages use. SQM switched to a iptables mask of &quot;0xff&quot; which might not be enough to not step on mwan3&#039;s feet... <br /></p><div class="quotebox"><cite>bobptz wrote:</cite><blockquote><p>and I can browse forums and edit posts without the need for sticky rules (which force the same wan to be used on the same forum session).&nbsp; When I disabled SQM, I had to bring back the mwan3 rules, or the forums would kick me off.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; Since whatever is happening does not seem to be intentional, I would not recommend to rely on this &quot;side-effect&quot; of sqm-scripts, but, as long as that works as well, keep the rules in place (I assume those rules are recommended by mwan3, and do work even with sqm-scriptis in place and that without sqm-scripts the rules are required).<br /></p><div class="quotebox"><cite>bobptz wrote:</cite><blockquote><p>Now I need to find someone who knows both SQM and MWAN3, to explain this.</p></blockquote></div><p>I have the strange feeling that you (at least currently) are the person at the intersection of mwan3 and sqm-scripts, so I will wait for the explaining you will (hopefully) come up with <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" />. I am curious about the root cause, but I only have one link available (and only one router running pitifully obsolete cerowrt) so I will not be able/willing to help here, but good luck nevertheless.</p><p>Best Regards<br />&nbsp; &nbsp; &nbsp; &nbsp; M.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p305441">
				<div class="post-metadata">
					<div class="post-num">Post #1499</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						29 Dec 2015, 20:55					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>axishero wrote:</cite><blockquote><div class="quotebox"><cite>kpv wrote:</cite><blockquote><p>I happened to come across this old discussion at Mikrotik&#039;s forum <a href="http://forum.mikrotik.com/viewtopic.php?f=2&amp;t=53657">http://forum.mikrotik.com/viewtopic.php?f=2&amp;t=53657</a> which raised several questions:</p><p>2) Can we use ipset in conjunction with mwan3?</p><p>e.g. one could put all his ISP-A IP networks in an ipset and then policy-route VoIP traffic to that ISP-A&#039;s SIP server via that same ISP-A&#039;s wan.</p><p>Or one could use ipset-dns to policy-route certain domain wirldcards e.g. <a href="https://forum.openwrt.org/viewtopic.php?pid=207497#p207497">https://forum.openwrt.org/viewtopic.php … 97#p207497</a> or not balance certain domains.</p></blockquote></div><p>Is this function added now?</p></blockquote></div><p>Yes</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p305443">
				<div class="post-metadata">
					<div class="post-num">Post #1500</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						29 Dec 2015, 20:57					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>muronghan wrote:</cite><blockquote><p>Hi Adze, I just tried to change the fwmark value in some files of shadowsocks to your instruction, but there was no luck so far. If you are still interested in this problem, I could pm you some configuration files for further debugging.</p></blockquote></div><p>I will try and see if i can find some time to help you with shadowsocks. But i&#039;m rather busy the next couple of coming days.. You are on the right track i guess.</p>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 60 of 65</div><nav><ul><li><a href="viewtopic.php%3Fid=39052&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=39052&amp;p=58.html">58</a></li><li><a href="viewtopic.php%3Fid=39052&amp;p=59.html">59</a></li><li class="pagination-current"><span>60</span></li><li><a href="viewtopic.php%3Fid=39052&amp;p=61.html">61</a></li><li><a href="viewtopic.php%3Fid=39052&amp;p=62.html">62</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=39052&amp;p=65.html">65</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0.001 -->

</body>
</html>