<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Routing stops working when changing WAN mac</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 5 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p124442">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">fluxus</div>
					<div class="post-datetime">
						3 Jan 2011, 22:46					</div>
				</div>
				<div class="post-content content">
					<p>Hello,<br />i tried to change my wan mac address by adding &quot;option macaddr xx:xx:xx:xx:xx:xx&quot;&nbsp; to &quot;wan&quot; block in /etc/config/network.<br />after typing &quot;if up&quot; to adopt the changes(same on reboot) none of the clients can access the internet, i can still login to the router and ping google.com and other sites.<br />So the router can access the internet, clients canÂ´t.(wlan and wired)<br />router is an asus wl 500 gp v1 running Backfire (10.03, r20728).<br />short dmesg output:<br /></p><div class="codebox"><pre><code>...
USB Mass Storage support registered.
device wl0 entered promiscuous mode
wl0: attempt to add interface with same source address.
br-lan: port 2(wl0) entering learning state
br-lan: port 2(wl0) entering forwarding state
br-lan: topology change detected, propagating
br-lan: port 2(wl0) entering disabled state
br-lan: port 1(eth0.0) entering disabled state
eth0.0: del 01:00:5e:00:00:01 mcast address from vlan interface
eth0.0: del 01:00:5e:00:00:01 mcast address from master interface
br-lan: port 2(wl0) entering disabled state
device wl0 left promiscuous mode
br-lan: port 1(eth0.0) entering disabled state
device eth0.0 left promiscuous mode
eth0.1: del 01:00:5e:00:00:01 mcast address from vlan interface
eth0.1: del 01:00:5e:00:00:01 mcast address from master interface
eth0.0: dev_set_promiscuity(master, -1)
device eth0 left promiscuous mode
eth0.0: add 01:00:5e:00:00:01 mcast address to master interface
eth0.0: del 01:00:5e:00:00:01 mcast address from vlan interface
eth0.0: del 01:00:5e:00:00:01 mcast address from master interface
eth0.0: add 01:00:5e:00:00:01 mcast address to master interface
eth0.0: dev_set_promiscuity(master, 1)
device eth0 entered promiscuous mode
device eth0.0 entered promiscuous mode
br-lan: port 1(eth0.0) entering learning state
br-lan: port 1(eth0.0) entering forwarding state
br-lan: topology change detected, propagating
device wl0 entered promiscuous mode
wl0: attempt to add interface with same source address.
br-lan: port 2(wl0) entering learning state
br-lan: port 2(wl0) entering forwarding state
br-lan: topology change detected, propagating
eth0.1: add 01:00:5e:00:00:01 mcast address to master interface
eth0.1: del 01:00:5e:00:00:01 mcast address from vlan interface
eth0.1: del 01:00:5e:00:00:01 mcast address from master interface
eth0.1: add 01:00:5e:00:00:01 mcast address to master interface
eth0.1: del 01:00:5e:00:00:01 mcast address from vlan interface
eth0.1: del 01:00:5e:00:00:01 mcast address from master interface
eth0.1: Setting MAC address to  xx xx xx xx xx xx.
eth0.1: add 01:00:5e:00:00:01 mcast address to master interface
br-lan: port 2(wl0) entering disabled state
br-lan: port 2(wl0) entering disabled state
device wl0 left promiscuous mode
device wl0 entered promiscuous mode
wl0: attempt to add interface with same source address.
br-lan: port 2(wl0) entering learning state
br-lan: port 2(wl0) entering forwarding state
br-lan: topology change detected, propagating
root@OpenWrt:~#</code></pre></div><p>Also tried adding the macaddr option to the other interfaces so they all have the same mac(they do when macaddr option not set) but this isnt working either... (eth0.0 isnt changing mac, checked using ifconfig)<br />anyone knows how to fix this problem?</p><p>-fluxus</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>