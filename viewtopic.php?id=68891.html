<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Configure DNS server that only OpenWRT router can use</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 4 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p346243">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">mrcutts</div>
					<div class="post-datetime">
						10 Dec 2016, 15:08					</div>
				</div>
				<div class="post-content content">
					<p>Hi, </p><p>Is there a way to configure a DNS server that only the OpenWRT router uses?</p><p> I don&#039;t want any of the devices connecting to the router to be able to use the DNS server. The devices are configured using DHCP and the primary DNS server is the OpenWRT router IP. I have then configured the router to use my own DNS servers so i have complete control over name resolution. But i&#039;d like to have a 3rd DNS server (e.g. Google&#039;s public 8.8.8.8) that only the OpenWRT router can use for name resolution if my 2 DNS servers are unavailable </p><p>Thanks for your help</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p346251">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">jea101</div>
					<div class="post-datetime">
						10 Dec 2016, 15:49					</div>
				</div>
				<div class="post-content content">
					<p>You need to set DHCP option 6 (for DHCP clients)</p><p>Network<br />Interfaces<br />LAN (unless using a different interface)<br />Edit<br />DHCP server<br />Advanced settings<br />DHCP options<br />6,xxx.yyy.zzz.1,xxx.yyy.zzz.2</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p346254">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">ulmwind</div>
					<div class="post-datetime">
						10 Dec 2016, 17:02					</div>
				</div>
				<div class="post-content content">
					<p>Yes, it is option to provide specific DNS for LAN clients.<br /></p><div class="codebox"><pre><code>config dhcp &#039;lan&#039;                                
        option interface &#039;lan&#039;                   
        option start &#039;100&#039;                       
        option limit &#039;150&#039;                       
        option leasetime &#039;12h&#039;                   
        option dhcpv6 &#039;server&#039;                   
        option ra &#039;server&#039;                       
        list dhcp_option &#039;6,8.8.8.8,8.8.4.4&#039; </code></pre></div><p>But your clients will be able to use manual DNS, you should block the port 53 in firewall to disable DNS queries, if you want.</p>											<p class="post-edited">(Last edited by <strong>ulmwind</strong> on 10 Dec 2016, 17:03)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p348892">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">mrcutts</div>
					<div class="post-datetime">
						9 Jan 2017, 22:09					</div>
				</div>
				<div class="post-content content">
					<p>If i block 53 in the firewall it&#039;s going to block all DNS traffic including the DNS servers i want to work. How do i exclude my DNS servers from being blocked?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p348986">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">stangri</div>
					<div class="post-datetime">
						10 Jan 2017, 21:25					</div>
				</div>
				<div class="post-content content">
					<p>You can hijack dns requests from connected devices and direct them to your router&#039;s dnsmasq.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p349325">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">mrcutts</div>
					<div class="post-datetime">
						15 Jan 2017, 15:19					</div>
				</div>
				<div class="post-content content">
					<p>Is it possible to configure OpenWRT so that DDNS uses a public DNS server like 8.8.8.8 to resolve and all other DNS queries are resolved by my DNS servers only?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>