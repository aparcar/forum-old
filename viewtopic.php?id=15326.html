<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> can&#039;t connect to VPN through openwrt</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 17 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p66954">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">nhwisp_gs</div>
					<div class="post-datetime">
						16 Apr 2008, 06:08					</div>
				</div>
				<div class="post-content content">
					<p>I am trying to connect a VPN through my wrt54gl (KAMIKAZE (7.07))<br />I am NOT trying to use the router for the VPN.&nbsp; A windows PC -&gt; wrt54gl -&gt; remote VPN router.</p><p>I have found in the forum&nbsp; &nbsp; &quot;ipkg install kmod-ipt-nat-pptp&nbsp; (older version should use &#039;kmod-ipt-nat-extra&#039; instead)&quot;,&nbsp; but I can&#039;t find any package like that for kamikaze.&nbsp; </p><p>root@OpenWrt:~# ipkg list | grep ipt-nat<br /><span style="color: blue">kmod-ipt-nat - 2.4.34-brcm-1 - Modules for extra NAT targets<br />kmod-ipt-nathelper - 2.4.34-brcm-1 - Default Conntrack and NAT helpers<br />kmod-ipt-nathelper-extra - 2.4.34-brcm-1 - Extra Conntrack and NAT helpers<br /></span><br />root@OpenWrt:~# ipkg list | grep pptp<br /><span style="color: blue">pptp - 1.6.0-3 - PPTP client<br />pptpd - 1.3.0-1 - PopTop pptp server<br /></span><br />some of a tcpdump is listed here...<br />--- WAN interface&nbsp; &nbsp;#tcpdump -i eth0.1<br /><span style="color: blue">21:22:04.904677 IP vpnSrvr.1723 &gt; myWanIP.4652: P 213:229(16) ack 349 win 8452: pptp CTRL_MSGTYPE=ECHORQ ID(1)<br />21:22:04.906170 IP myWanIP.4652 &gt; vpnSrvr.1723: P 349:369(20) ack 229 win 65307: pptp CTRL_MSGTYPE=ECHORP ID(1) RESULT_CODE(1) ERR_CODE(0)<br />21:22:05.474433 IP vpnSrvr.1723 &gt; myWanIP.4652: . ack 369 win 8432<br />21:22:05.995021 IP vpnSrvr &gt; myWanIP: GREv1, call 49152, seq 4, length 25: LCP, Conf-Request (0x01), id 4, length 11<br />21:22:05.995697 IP myWanIP &gt; vpnSrvr: ICMP myWanIP protocol 47 unreachable, length 53<br />21:22:08.995231 IP vpnSrvr &gt; myWanIP: GREv1, call 49152, seq 5, length 25: LCP, Conf-Request (0x01), id 5, length 11<br />21:22:08.995917 IP myWanIP &gt; vpnSrvr: ICMP myWanIP protocol 47 unreachable, length 53<br />21:22:11.995208 IP vpnSrvr &gt; myWanIP: GREv1, call 49152, seq 6, length 25: LCP, Conf-Request (0x01), id 6, length 11<br />21:22:11.995878 IP myWanIP &gt; vpnSrvr: ICMP myWanIP protocol 47 unreachable, length 53<br />21:22:14.996110 IP vpnSrvr &gt; myWanIP: GREv1, call 49152, seq 7, length 25: LCP, Conf-Request (0x01), id 7, length 11<br />21:22:14.996787 IP myWanIP &gt; vpnSrvr: ICMP myWanIP protocol 47 unreachable, length 53</span><br />--- LAN interface&nbsp; &nbsp;#tcpdump -i eth0.0<br /><span style="color: blue">21:22:04.905141 IP vpnSrvr.1723 &gt; 192.168.10.2.4652: P 213:229(16) ack 349 win 8452: pptp CTRL_MSGTYPE=ECHORQ ID(1)<br />21:22:04.905711 IP 192.168.10.2.4652 &gt; vpnSrvr.1723: P 349:369(20) ack 229 win 65307: pptp CTRL_MSGTYPE=ECHORP ID(1) RESULT_CODE(1) ERR_CODE(0)<br />21:22:05.474856 IP vpnSrvr.1723 &gt; 192.168.10.2.4652: . ack 369 win 8432<br />21:22:06.258683 IP 192.168.10.2 &gt; vpnSrvr: GREv1, call 54349, seq 3, length 37: LCP, Conf-Request (0x01), id 3, length 23<br />21:22:10.258767 IP 192.168.10.2 &gt; vpnSrvr: GREv1, call 54349, seq 4, length 37: LCP, Conf-Request (0x01), id 4, length 23<br />21:22:14.258852 IP 192.168.10.2 &gt; vpnSrvr: GREv1, call 54349, seq 5, length 37: LCP, Conf-Request (0x01), id 5, length 23</span></p><p>I have tried various iptables rules, but nothing seems to work.</p><p>Is there some other package for kamikaze which does what &quot;kmod-ipt-nat-pptp&quot; did?</p><p>Thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p66959">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">KanjiMonster</div>
					<div class="post-datetime">
						16 Apr 2008, 10:36					</div>
				</div>
				<div class="post-content content">
					<p>Try installing the &quot;kmod-gre&quot; package, that should help.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p66983">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">nhwisp_gs</div>
					<div class="post-datetime">
						16 Apr 2008, 20:29					</div>
				</div>
				<div class="post-content content">
					<p>OK - that seems to have helped.</p><p>now my problem is - I can only make 1 connection at a time<br /><span style="color: blue">well, it seems to be more like I can make a connection if no other connection entry exists in /proc/net/ip_conntrack</span></p><p>any idea of what the kamikaze equivalent of <span style="color: blue">ipkg install kmod-ipt-nat-extra </span> is?</p><p>Thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p66984">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">KanjiMonster</div>
					<div class="post-datetime">
						16 Apr 2008, 20:51					</div>
				</div>
				<div class="post-content content">
					<p>From looking at my installed packages&#039; names, I would guess kmod-ipt-nat<em>helper</em>-extra.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p66985">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">nhwisp_gs</div>
					<div class="post-datetime">
						16 Apr 2008, 21:45					</div>
				</div>
				<div class="post-content content">
					<p>That works !!&nbsp; &nbsp; &nbsp;(almost)</p><p>When I disconnect the VPN tunnel, the router reboots.</p><p>Any ideas?</p><p>Thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p66990">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">KanjiMonster</div>
					<div class="post-datetime">
						16 Apr 2008, 23:03					</div>
				</div>
				<div class="post-content content">
					<p>Yeah, known problem of the 2.4 kernel. Only solution is using a 2.6 kernel, but that most probably means unusable wifi (although there seem to be a few who successfully use the b43 driver).<br />So you have the choice between wireless and no crashes.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p66993">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">nhwisp_gs</div>
					<div class="post-datetime">
						16 Apr 2008, 23:21					</div>
				</div>
				<div class="post-content content">
					<p>Thanks.</p><p>I guess I will live with the crashes for now.&nbsp; Maybe I will go back to the single VPN tunnel.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>