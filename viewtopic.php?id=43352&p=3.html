<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> [Howto](AAP) Automated Wifi network change if the current fails</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 1 Sep 2014 and 5 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 3 of 5</div><nav><ul><li><a href="viewtopic.php%3Fid=43352&amp;p=1.html">1</a></li><li><a href="viewtopic.php%3Fid=43352&amp;p=2.html">2</a></li><li class="pagination-current"><span>3</span></li><li><a href="viewtopic.php%3Fid=43352&amp;p=4.html">4</a></li><li><a href="viewtopic.php%3Fid=43352&amp;p=5.html">5</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p289524">
				<div class="post-metadata">
					<div class="post-num">Post #51</div>
					<div class="post-author">cabsandy</div>
					<div class="post-datetime">
						28 Aug 2015, 12:13					</div>
				</div>
				<div class="post-content content">
					<p>Not sure if this is still active but....<br />I&#039;m looking for a script I can drop on a N600 OpenWRT box that scans, and then connects, to multiple SSID&#039;s in a round robin fashion. So AP1,AP2,AP3 etc etc.I &quot;own&quot; the AP&#039;s, each SSID is unique, and I have the passwords/keys. Its simply to check that<br />a) the SSID is still broadcasting<br />b) when connected to the SSID, there is a route out to the Internet (so ping 8.8.8.8)</p><p>I&#039;m not 100% that this script will do it, or maybe it just needs a tweak (rather than me re-inventing the wheel). Could some good soul advise?</p><p>cheers</p><p>cabs</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p290432">
				<div class="post-metadata">
					<div class="post-num">Post #52</div>
					<div class="post-author">dabyd64</div>
					<div class="post-datetime">
						4 Sep 2015, 00:48					</div>
				</div>
				<div class="post-content content">
					<p>Yes, it could be tweaked to do that, but why?<br />It&#039;s much better by trying them only if the connection fails.<br />Doing so when it&#039;s working makes no sense, it will be constantly dropping the connecting, everytime it connects and checks the APs.</p><p>If you just want to use that box as a watchdog instead giving internet to other devices, and want to do something like logging the faults or rebooting the unresponsive APs, then yes, it makes sense.</p>											<p class="post-edited">(Last edited by <strong>dabyd64</strong> on 4 Sep 2015, 00:50)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p290435">
				<div class="post-metadata">
					<div class="post-num">Post #53</div>
					<div class="post-author">cabsandy</div>
					<div class="post-datetime">
						4 Sep 2015, 00:53					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dabyd64 wrote:</cite><blockquote><p>Yes, it could be tweaked to do that, but why?<br />It&#039;s much better by trying them only if the connection fails.<br />Doing so when it&#039;s working makes no sense, it will be constantly dropping the connecting, everytime it connects and checks the APs</p></blockquote></div><br /><p>Maybe I didn&#039;t explain it as well as I should :-) This box is simply a monitor OPENWRT box, its not there to provide access to clients. So it runs silently in the background , &quot;seeing&quot; all the proper AP&#039;s. As th AP&#039;s are remote to me, I&#039;d like this box to simply go round all those other ones, connect to each unique SSID, get an IP, ping, and repeat-whilsT writing to syslogs the results</p><p>Cheers</p><p>cabs</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p290439">
				<div class="post-metadata">
					<div class="post-num">Post #54</div>
					<div class="post-author">dabyd64</div>
					<div class="post-datetime">
						4 Sep 2015, 01:04					</div>
				</div>
				<div class="post-content content">
					<p>Yes, that can be done.<br />So, let&#039;s say that you only want it to constantly scan and log the status to the syslog, and then you remotely connect by SSH to that box from time to time to check how it&#039;s been going?<br />You want to log only the failing APs?<br />Also, it be saved to a text file on the flash, as the syslog is lost after a reboot.<br />It will use very little space, unless the APs fail constantly and you never delete the file.<br />It may also stress a bit the flash endurance, but I think it would only fail after few years.<br />Just tell me and I&#039;ll kindly help on this, if I know how to do so!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p290446">
				<div class="post-metadata">
					<div class="post-num">Post #55</div>
					<div class="post-author">cabsandy</div>
					<div class="post-datetime">
						4 Sep 2015, 01:28					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dabyd64 wrote:</cite><blockquote><p>Yes, that can be done.<br />So, let&#039;s say that you only want it to constantly scan and log the status to the syslog, and then you remotely connect by SSH to that box from time to time to check how it&#039;s been going?<br />You want to log only the failing APs?<br />Also, it be saved to a text file on the flash, as the syslog is lost after a reboot.<br />It will use very little space, unless the APs fail constantly and you never delete the file.<br />It may also stress a bit the flash endurance, but I think it would only fail after few years.<br />Just tell me and I&#039;ll kindly help on this, if I know how to do so!</p></blockquote></div><p>The box has an 8GB flash drive mounted as ext4,it performs as root, and additional storage <a href="http://en.code-bude.net/2013/02/16/how-to-increase-storage-on-tp-link-wr703n-with-extroot/">http://en.code-bude.net/2013/02/16/how- â€¦ h-extroot/</a> So loads of space! :-)<br />Yep-say, run a scan of ALL knowsn SSID&#039;s every 30 minutes,connect, get IP via DHCP, ping 8.8.8.8-and move on.Write to syslog-and then SSH in, now and again, to see how its going. Would prefer to see the successful AND unsuccessful attempts, just so I know its working!</p><p>cheers mucho</p><p>cabs</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p290451">
				<div class="post-metadata">
					<div class="post-num">Post #56</div>
					<div class="post-author">dabyd64</div>
					<div class="post-datetime">
						4 Sep 2015, 01:55					</div>
				</div>
				<div class="post-content content">
					<p>Okay, but, the box should only have internet from the wifi side, otherwise it will may ping 8.8.8.8 from lan side.<br />Also, how will you connect by SSH if the box is scanning?(I guess you&#039;ll have to wait a bit when this happens, until it finishes)<br />Do you have a default wifi network to set when it&#039;s not performing the scan?</p>											<p class="post-edited">(Last edited by <strong>dabyd64</strong> on 4 Sep 2015, 01:56)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p290460">
				<div class="post-metadata">
					<div class="post-num">Post #57</div>
					<div class="post-author">dabyd64</div>
					<div class="post-datetime">
						4 Sep 2015, 03:46					</div>
				</div>
				<div class="post-content content">
					<p>This is an early work but it works well.<br /><a href="https://dl.dropboxusercontent.com/u/23958662/ApScan_v0.1.zip"><strong>ApScan v.01</strong></a><br />This the output, from a real test:</p><p><strong><em>logread | grep ApScan</em></strong><br /></p><div class="codebox"><pre><code>Sun Feb 23 03:55:17 2014 user.notice root: ApScan: Scanning started
Sun Feb 23 03:55:18 2014 user.notice root: ApScan: Network Wifi_8a65 not found
Sun Feb 23 03:55:41 2014 user.notice root: ApScan: Network Cofee found, but ping failed
Sun Feb 23 03:56:08 2014 user.notice root: ApScan: Network MyWifi OK
Sun Feb 23 03:56:08 2014 user.notice root: ApScan: End of Wlan scan</code></pre></div><p>However, you still need to tell me what to do when the scan ends,and how are you going to setup the internet connection when it isn&#039;t scanning.</p><p>I see that your native language could be Spanish? That&#039;s mine too, so if it&#039;s better for you to explain in Spanish it will be okay, but I prefer english, because here there&#039;s a lot of non-hispanic people.<br />Regards</p>											<p class="post-edited">(Last edited by <strong>dabyd64</strong> on 4 Sep 2015, 04:02)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p290477">
				<div class="post-metadata">
					<div class="post-num">Post #58</div>
					<div class="post-author">cabsandy</div>
					<div class="post-datetime">
						4 Sep 2015, 09:03					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dabyd64 wrote:</cite><blockquote><p>This is an early work but it works well.<br /><a href="https://dl.dropboxusercontent.com/u/23958662/ApScan_v0.1.zip"><strong>ApScan v.01</strong></a><br />This the output, from a real test:</p><p><strong><em>logread | grep ApScan</em></strong><br /></p><div class="codebox"><pre><code>Sun Feb 23 03:55:17 2014 user.notice root: ApScan: Scanning started
Sun Feb 23 03:55:18 2014 user.notice root: ApScan: Network Wifi_8a65 not found
Sun Feb 23 03:55:41 2014 user.notice root: ApScan: Network Cofee found, but ping failed
Sun Feb 23 03:56:08 2014 user.notice root: ApScan: Network MyWifi OK
Sun Feb 23 03:56:08 2014 user.notice root: ApScan: End of Wlan scan</code></pre></div><p>However, you still need to tell me what to do when the scan ends,and how are you going to setup the internet connection when it isn&#039;t scanning.<br />I see that your native language could be Spanish? That&#039;s mine too, so if it&#039;s better for you to explain in Spanish it will be okay, but I prefer english, because here there&#039;s a lot of non-hispanic people.<br />Regards</p></blockquote></div><p>Lol-I&#039;m Scottish, not Spanish-so English is fine :-)</p><p>So its a N600 OpenWRT-your right-the &quot;main&quot; WAN connection is through a cable modem via Ethernet/wired-the N600 receives a public IP on its WAN side. The N600 is dual radio, so both I would like to be able to connect to known AP&#039;s in its radio range. I can see how when it connects, it may use the wired WAN side for the ping-but one of the curious things I have seen before, is that when you have dual WAN connectivity (so wired and wireless-to a secondary AP), the device always seems to pick the wireless (wlan0) as the default route! Not sure why but I suppose putting something like </p><div class="codebox"><pre><code> curl ipecho.net/plain </code></pre></div><p> in the script, would let you know what WAN connection is being used?</p><p>For when the scan ends, would a sleep function, or just running it as a cronjob not do the trick?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p290494">
				<div class="post-metadata">
					<div class="post-num">Post #59</div>
					<div class="post-author">dabyd64</div>
					<div class="post-datetime">
						4 Sep 2015, 15:57					</div>
				</div>
				<div class="post-content content">
					<p>Oh, it&#039;s fine then <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />,<br />The script runs as daemon at system startup, it sleeps during the specified waiting time.<br />I guess the easiest way would be to disable the wired wan during the&nbsp; scan.<br />The dual band could make it harder, do you want to scan both 2.4 and 5GHz bands?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p290504">
				<div class="post-metadata">
					<div class="post-num">Post #60</div>
					<div class="post-author">cabsandy</div>
					<div class="post-datetime">
						4 Sep 2015, 16:41					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dabyd64 wrote:</cite><blockquote><p>Oh, it&#039;s fine then <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />,<br />The script runs as daemon at system startup, it sleeps during the specified waiting time.<br />I guess the easiest way would be to disable the wired wan during the&nbsp; scan.<br />The dual band could make it harder, do you want to scan both 2.4 and 5GHz bands?</p></blockquote></div><p>In terms of both bands, then it would be a nice to have, but not essential. So disable the eth0 during the scan, and then bring it back up on completion?-cool!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p290552">
				<div class="post-metadata">
					<div class="post-num">Post #61</div>
					<div class="post-author">dabyd64</div>
					<div class="post-datetime">
						5 Sep 2015, 01:40					</div>
				</div>
				<div class="post-content content">
					<p>There may be better ways, but for the typical half-brained chimp like me it&#039;s the fastest and easiest way <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /><br />What do we do with WiFi after the scan? Keep it disabled?<br />Please put the contents of<br />/etc/config/network<br />/etc/config/firewall<br />/etc/config/wireless</p>											<p class="post-edited">(Last edited by <strong>dabyd64</strong> on 5 Sep 2015, 01:41)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p293027">
				<div class="post-metadata">
					<div class="post-num">Post #62</div>
					<div class="post-author">cabsandy</div>
					<div class="post-datetime">
						23 Sep 2015, 01:22					</div>
				</div>
				<div class="post-content content">
					<p>Sorry and apologies for not getting back to the thread-been mad busy at work, and not had a chance to try it out. It looks good, and keeps it simple.Discovered if the device under test, if in AP mode, runs the script, it will change the SSID to the last one successfully scanned-so am going to get a few dedicated units. Going to try it out on some small TP-703&#039;s, and see how they cope.</p><p>But looking good so far :-)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p293039">
				<div class="post-metadata">
					<div class="post-num">Post #63</div>
					<div class="post-author">dabyd64</div>
					<div class="post-datetime">
						23 Sep 2015, 02:36					</div>
				</div>
				<div class="post-content content">
					<p>Hi, yeah I was already thinking on 2016! <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /><br />It won&#039;t work in AP mode, wifi must be configured in client mode to scan and connect!</p><p>What do we do with wifi when the device is not scanning? AP mode? Connect to a trusted wifi ? Disable wifi?<br />And what about dual band? It will be harder but it can be done. The WR703N is 2.4G only, so we can forget about it.</p><p>I need to know the device exactly, depending on it, the wifi interface may be called different, and has to be changed on the script.<br />Think on it, put it clear over the paper, and we&#039;ll end in a hurry!<br />Cheers</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p293073">
				<div class="post-metadata">
					<div class="post-num">Post #64</div>
					<div class="post-author">cabsandy</div>
					<div class="post-datetime">
						23 Sep 2015, 09:19					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dabyd64 wrote:</cite><blockquote><p>Hi, yeah I was already thinking on 2016! <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /><br />It won&#039;t work in AP mode, wifi must be configured in client mode to scan and connect!</p><p>What do we do with wifi when the device is not scanning? AP mode? Connect to a trusted wifi ? Disable wifi?<br />And what about dual band? It will be harder but it can be done. The WR703N is 2.4G only, so we can forget about it.</p><p>I need to know the device exactly, depending on it, the wifi interface may be called different, and has to be changed on the script.<br />Think on it, put it clear over the paper, and we&#039;ll end in a hurry!<br />Cheers</p></blockquote></div><p>So the main unit is a TP-Link TL-WDR3600 v1 -simultaneous dual band. wlan0 for the 2.4Ghz, wlan1 for the 5Ghz<br />If it can be done, then once the scan is finished, the device comes back out of client mode, and back into AP mode, using the original SSID before the scan started (this would be a bonus as I can take the unit &quot;offline&quot; for the period of the scan, and dont have to put in a seperate one).<br />I&#039;ll still use the original version of the script for the TP-703, as it is a handy little device, and can run for days on battery back up :-)</p><p>cheers my man</p><p>cabs</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p294839">
				<div class="post-metadata">
					<div class="post-num">Post #65</div>
					<div class="post-author">ewpro98</div>
					<div class="post-datetime">
						5 Oct 2015, 23:07					</div>
				</div>
				<div class="post-content content">
					<p>Been looking for something like this. Tried it with a WNDR3700v1 and could not get it to work. I have used DD-WRT, but I am new to OpenWRT. I used dabyd64&#039;s instructions right after the OpenWRT flash. Does it require more config than that? It seems to loop and find the ssids, but never successfully connects to one. Which routers has this been verified on? Thanks in advance if anyone listening.</p>											<p class="post-edited">(Last edited by <strong>ewpro98</strong> on 5 Oct 2015, 23:45)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p294994">
				<div class="post-metadata">
					<div class="post-num">Post #66</div>
					<div class="post-author">dabyd64</div>
					<div class="post-datetime">
						6 Oct 2015, 22:22					</div>
				</div>
				<div class="post-content content">
					<p>You need to enable wireless first, and then configure it as client.</p><p>Edit /etc/config/wireless with &quot;vi&quot; (vi /etc/config/wireless). If you need more help, check <a href="http://www.howtogeek.com/102468/a-beginners-guide-to-editing-text-files-with-vi/"><strong>THIS</strong></a></p><p>Change&nbsp; &nbsp; &quot; option disabled &#039;1&#039; &quot;<br />to&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot; option disabled &#039;0&#039; &quot;</p><br /><p>Also, make sure that this two options are set like this<br /> </p><div class="codebox"><pre><code>config wifi-iface
    ..
    option device &#039;radio0&#039;
    ..
    option mode &#039;sta&#039;            &lt;---------- 
    option network &#039;wan&#039;       &lt;----------</code></pre></div><p>Reboot and should work now</p><p>@cabsandy<br />I&#039;ve been lot of busy lately, I hope to finish it soon!</p>											<p class="post-edited">(Last edited by <strong>dabyd64</strong> on 6 Oct 2015, 22:30)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p295179">
				<div class="post-metadata">
					<div class="post-num">Post #67</div>
					<div class="post-author">RangerZ</div>
					<div class="post-datetime">
						7 Oct 2015, 23:43					</div>
				</div>
				<div class="post-content content">
					<p>Back to the original design please....</p><p>I am dealing with the Portable/Travel router issue of lost WWAN connection leads the WLAN to be come unavailable.&nbsp; I have found a few other options which either rely on a button or just kill the WWAN on every boot (see below).&nbsp; This looks like a much better solution as if I understand every time it boots it will scan my list of connection and continue until it finds one.&nbsp; </p><p>Will this make the WLAN available even if it can not connect to a AP?</p><p>I do not understand the random mac issue can you please explain why I want or may not want to set this?&nbsp; Do i need to load something for this function?</p><p>Has this been tried on CC RC or final?</p><p>What are the known good or bad chipsets?&nbsp; I have a TooToo TM02 =&gt; Ralink RT5350F</p><p>Reference posts for other solutions<br />Button Event - relies on knowledge of the devices button functionality<br /><a href="https://forum.openwrt.org/viewtopic.php?pid=188725#p188725">https://forum.openwrt.org/viewtopic.php â€¦ 25#p188725</a><br /><a href="https://forum.openwrt.org/viewtopic.php?pid=262622#p262622">https://forum.openwrt.org/viewtopic.php â€¦ 22#p262622</a><br />Kill WWAN on Reboot<br /><a href="https://forum.openwrt.org/viewtopic.php?pid=272018#p272018">https://forum.openwrt.org/viewtopic.php â€¦ 18#p272018</a><br /><a href="https://forum.openwrt.org/viewtopic.php?pid=278230#p278230">https://forum.openwrt.org/viewtopic.php â€¦ 30#p278230</a></p>											<p class="post-edited">(Last edited by <strong>RangerZ</strong> on 7 Oct 2015, 23:44)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p296847">
				<div class="post-metadata">
					<div class="post-num">Post #68</div>
					<div class="post-author">dabyd64</div>
					<div class="post-datetime">
						21 Oct 2015, 01:26					</div>
				</div>
				<div class="post-content content">
					<p>The random mac was a request from a user, some people connect to a public hotspot that limit the time or data, so a random mac will overrun this limit. In home use it&#039;s useless.</p><p>About the AP wlan going down if the client mode wlan, aka &quot;wwan&quot;,&nbsp; it&#039;s a limitation of that mode (repeater, also called ap+sta mode), and nothing can be done to fix that.</p><p>The only way is to mod the script, so in case that all networks were checked and none could be reached, disable the client network and just enable the AP, then it&#039;ll keep the wlan, although without internet connection</p>											<p class="post-edited">(Last edited by <strong>dabyd64</strong> on 21 Oct 2015, 04:34)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p296857">
				<div class="post-metadata">
					<div class="post-num">Post #69</div>
					<div class="post-author">dabyd64</div>
					<div class="post-datetime">
						21 Oct 2015, 04:04					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>cabsandy wrote:</cite><blockquote><p>So the main unit is a TP-Link TL-WDR3600 v1 -simultaneous dual band. wlan0 for the 2.4Ghz, wlan1 for the 5Ghz<br />If it can be done, then once the scan is finished, the device comes back out of client mode, and back into AP mode, using the original SSID before the scan started (this would be a bonus as I can take the unit &quot;offline&quot; for the period of the scan, and dont have to put in a seperate one).<br />I&#039;ll still use the original version of the script for the TP-703, as it is a handy little device, and can run for days on battery back up :-)</p><p>cheers my man</p><p>cabs</p></blockquote></div><p>OK man! I&#039;ve finished it, really sorry for the long time, I&#039;ve been working too hard on that damn computer shop, lots of troubles, so you can imagine that when I came home I wanted to do rest and don&#039;t even think on computers!<br />Here you have!<br /><a href="https://dl.dropboxusercontent.com/u/23958662/ApScan_v1.0.zip"><strong>ApScan v1.0</strong></a><br />It&#039;s working perfect on my WDR4900, both bands.<br />It disables wireless APs and wired WAN before testing, makes the test, the it restores the default wireless and wan settings.<br />You can set everything on the config file.<br />This was the output of my test (<strong>logread | grep ApScan</strong>)<br /></p><div class="codebox"><pre><code>Wed Oct 21 00:31:06 2015 user.notice root: ApScan:         Starting
Wed Oct 21 00:31:23 2015 user.notice root: ApScan  (2.4G)  Network HOME_2G OK
Wed Oct 21 00:31:34 2015 user.notice root: ApScan  (2.4G)  Network wifi33 found, but ping failed
Wed Oct 21 00:31:34 2015 user.notice root: ApScan  (2.4G)  Network whatever_2G not found
Wed Oct 21 00:31:51 2015 user.notice root: ApScan  (5G)    Network HOME_5G OK
Wed Oct 21 00:31:51 2015 user.notice root: ApScan  (5G)    Network wifi55 found, but ping failed
Wed Oct 21 00:31:51 2015 user.notice root: ApScan  (5G)    Network whatever_5G not found
Wed Oct 21 00:31:53 2015 user.notice root: ApScan:         Finished</code></pre></div><p>It looks pretty good. Let me know how it went <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /><br />Cheers</p>											<p class="post-edited">(Last edited by <strong>dabyd64</strong> on 21 Oct 2015, 04:38)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p297346">
				<div class="post-metadata">
					<div class="post-num">Post #70</div>
					<div class="post-author">cabsandy</div>
					<div class="post-datetime">
						25 Oct 2015, 11:03					</div>
				</div>
				<div class="post-content content">
					<p>Hell there</p><p>Been playing with this-could I ask for some things to be considered?</p><p>wlan0 on here looks to be 5G-is it possible for wlan0 to be the 2.4G radio and wlan1 for 5G radio-as this is how Openwrt sees it on my device?<br />I know this shouldn&#039;t make a difference on a dual radio device but I was trying it on a single (2.4g) device, and couldn&#039;t work out why I was getting errors :-)<br />Which leads me to my 2nd ask-is it possible to make the latest script (v1.0) have the option to use it on a single and/or dual radio? This way, I can use the same script on a &quot;working&quot; AP, regardless if its single or dual. When I started out on this, a standalone device looked the way ahead, but as you adapted the script to take a working AP &quot;down&quot;, and then back &quot;up&quot; , it got me thinking i could run this as a cronjob on a working device, and run it at 4am in the morning (or maybe twice a day), thereby not interfering with many customers?</p><p>Thoughts?</p><p>cheers</p><p>cabs</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p297352">
				<div class="post-metadata">
					<div class="post-num">Post #71</div>
					<div class="post-author">dabyd64</div>
					<div class="post-datetime">
						25 Oct 2015, 13:13					</div>
				</div>
				<div class="post-content content">
					<p>No problem chaging that. I thought it would be the same as my wdr4900.<br />About the cronjob, it&#039;s easier that the current method, easy fix.<br />About the dual/single band compatibility, not that easy.<br />First, usually Broadcom and Ralink chipset give too many headaches, so this will be Atheros only...<br />Second, WiFi devices can have different names, ex.: wlan0 ath0 wlan1..I have to investigate how to detect this.<br />Let me check it out,<br />Cheers</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p297415">
				<div class="post-metadata">
					<div class="post-num">Post #72</div>
					<div class="post-author">cabsandy</div>
					<div class="post-datetime">
						25 Oct 2015, 22:23					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dabyd64 wrote:</cite><blockquote><p>No problem chaging that. I thought it would be the same as my wdr4900.<br />About the cronjob, it&#039;s easier that the current method, easy fix.<br />About the dual/single band compatibility, not that easy.<br />First, usually Broadcom and Ralink chipset give too many headaches, so this will be Atheros only...<br />Second, WiFi devices can have different names, ex.: wlan0 ath0 wlan1..I have to investigate how to detect this.<br />Let me check it out,<br />Cheers</p></blockquote></div><p>Thanks for that-I think the 3600 is Ralink-I think! Dont give yourself too much hassle, can always go back to a standalone unit! :-)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p297566">
				<div class="post-metadata">
					<div class="post-num">Post #73</div>
					<div class="post-author">dabyd64</div>
					<div class="post-datetime">
						27 Oct 2015, 02:45					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>cabsandy wrote:</cite><blockquote><div class="quotebox"><cite>dabyd64 wrote:</cite><blockquote><p>No problem chaging that. I thought it would be the same as my wdr4900.<br />About the cronjob, it&#039;s easier that the current method, easy fix.<br />About the dual/single band compatibility, not that easy.<br />First, usually Broadcom and Ralink chipset give too many headaches, so this will be Atheros only...<br />Second, WiFi devices can have different names, ex.: wlan0 ath0 wlan1..I have to investigate how to detect this.<br />Let me check it out,<br />Cheers</p></blockquote></div><p>Thanks for that-I think the 3600 is Ralink-I think! Dont give yourself too much hassle, can always go back to a standalone unit! :-)</p></blockquote></div><br /><p>Nope, it has Atheros AR9344! <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /><br /><a href="http://wiki.openwrt.org/toh/tp-link/tl-wdr3600">http://wiki.openwrt.org/toh/tp-link/tl-wdr3600</a></p><p>Ok, I&#039;ve done it different.<br />Just &quot;config&quot; and &quot;ApScan.sh&quot;. Edit the config file and run ApScan.sh everytime you want to perform a scan, from cronjob or any other method you want to use.</p><p>I gave up on trying to detect the device, it probably would cause problems and give a lot of work.<br />So, different scripts for 2.4G only and dual band.<br />For 2.4G only devices, wlan0 is used.<br />For dual band WDR3600, wlan0 for 2.4G and wlan1 for 5G.<br />For dual band WDR4900, wlan1 for 2.4G and wlan0 for 5G.</p><p><a href="https://dl.dropboxusercontent.com/u/23958662/ApScan_v1.0b.zip"><strong>ApScan 1.0b</strong></a></p><p>Regards <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>											<p class="post-edited">(Last edited by <strong>dabyd64</strong> on 29 Oct 2015, 16:33)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p298720">
				<div class="post-metadata">
					<div class="post-num">Post #74</div>
					<div class="post-author">phantnang</div>
					<div class="post-datetime">
						5 Nov 2015, 17:27					</div>
				</div>
				<div class="post-content content">
					<p>hi @dabyd64...very thank for your works, it&#039;s work well!<br />but i want to auto connect SSID1 again if it up, Suppose SSID1 is best connecting!</p>											<p class="post-edited">(Last edited by <strong>phantnang</strong> on 5 Nov 2015, 17:28)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p298727">
				<div class="post-metadata">
					<div class="post-num">Post #75</div>
					<div class="post-author">dabyd64</div>
					<div class="post-datetime">
						5 Nov 2015, 18:21					</div>
				</div>
				<div class="post-content content">
					<p>Reboot and it will check again, or mod the script as you like.<br />It won&#039;t check the wifi while being connected because it will break internet everytime.<br />It only checks when it fails, then if WiFi1 is found it will connected to it.</p>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 3 of 5</div><nav><ul><li><a href="viewtopic.php%3Fid=43352&amp;p=1.html">1</a></li><li><a href="viewtopic.php%3Fid=43352&amp;p=2.html">2</a></li><li class="pagination-current"><span>3</span></li><li><a href="viewtopic.php%3Fid=43352&amp;p=4.html">4</a></li><li><a href="viewtopic.php%3Fid=43352&amp;p=5.html">5</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>