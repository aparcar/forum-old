<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> [Howto](AAP) Automated Wifi network change if the current fails</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 1 Sep 2014 and 5 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 2 of 5</div><nav><ul><li><a href="viewtopic.php%3Fid=43352&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li><li><a href="viewtopic.php%3Fid=43352&amp;p=3.html">3</a></li><li><a href="viewtopic.php%3Fid=43352&amp;p=4.html">4</a></li><li><a href="viewtopic.php%3Fid=43352&amp;p=5.html">5</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p211411">
				<div class="post-metadata">
					<div class="post-num">Post #26</div>
					<div class="post-author">Averell</div>
					<div class="post-datetime">
						2 Sep 2013, 08:15					</div>
				</div>
				<div class="post-content content">
					<p>Hi dabyd64,</p><p>Could you please help tell me the reason you created the new scan0 interface? Why didn&#039;t you use wlan0 to scan?</p><p>BTW, I think that the file /etc/init.d/wifiMgr missed &quot; /etc/rc.common&quot; in the first line.</p><p>Thanks and regards,<br/>Averell</p>											<p class="post-edited">(Last edited by <strong>Averell</strong> on 3 Sep 2013, 05:17)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p211486">
				<div class="post-metadata">
					<div class="post-num">Post #27</div>
					<div class="post-author">eeff11</div>
					<div class="post-datetime">
						3 Sep 2013, 10:15					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Averell wrote:</cite><blockquote><p>Hi dabyd64,</p><p>Could you please help tell me the reason you created the new scan0 interface? Why didn&#039;t you use wlan0 to scan?</p><p>BTW, I think that the file /etc/init.d/wifiMgr missed &quot; /etc/rc.common&quot; in the first line.</p><p>Thanks and regards,<br/>Averell</p></blockquote></div><br/><p>Hi,Averell,</p><p>I added #!/bin/sh /etc/rc.common as you informed.</p><p>yes, now the script seems working, but errors as follows:</p><div class="codebox"><pre><code>root@OpenWrt:~# /etc/init.d/wifiMgr restart
root@OpenWrt:~# Current MAC : 11:22:33:44:55:66 (unknown)
ERROR: Can&#039;t change MAC : interface up or not permission :Device or resource busy
ping: bad address &#039;yahoo.com&#039;
killall : hostpad: no process killed
command failed: Device or resource busy (-16)
command failed: not found
Successfully initialized wpa_supplicant
ping: bad address &#039;yahoo.com&#039;
sleep: invalid number &#039;net=&#039;
command failed: Device or resource busy (-16)
command failed: not found
Successfully initialized wpa_supplicant
ping: bad address &#039;yahoo.com&#039;
sleep: invalid number &#039;net=&#039;
command failed: Device or resource busy (-16)
command failed: not found
Successfully initialized wpa_supplicant
ping: bad address &#039;yahoo.com&#039;
sleep: invalid number &#039;net=&#039;</code></pre></div><p>And on the webgui, it shows it tries to connet to the white list, but failed at each one?</p><p>Where possibly should I check?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p211587">
				<div class="post-metadata">
					<div class="post-num">Post #28</div>
					<div class="post-author">dabyd64</div>
					<div class="post-datetime">
						4 Sep 2013, 16:30					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>eeff11 wrote:</cite><blockquote><p>Hi, dabyd64,</p><p>1. why there is no rc.common in&nbsp; /etc/wifiMgr.sh?<br/>2. if there should be a space after c in &quot;net=$(ping google.es -c5 |grep &quot;time=&quot;)&quot;? changed to &quot;net=$(ping yahoo.com -c 5 |grep &quot;time=&quot;) and another same line too.</p><p>Can you put an example of PSK2 encryption? all I can see is:<br/>1 wep<br/>2 wep with shared key<br/>3 wpa-psk<br/>4 wpa2-psk<br/>5 wpa-psk/wpa2-psk mixed mode</p><p>what for these 5 accordingly? Sorry, maybe too basic.</p><p>Can you show me your major configs? </p><p>Thanks so much.</p></blockquote></div><p>Check this: <a href="http://wiki.openwrt.org/doc/uci/wireless#configuring.encryption">http://wiki.openwrt.org/doc/uci/wireless#configuring.encryption</a><br/>Look at &quot;WPA Modes&quot;.</p><p>Maybe you copied something wrong. If you copied / edited using windows, usually it won&#039;t work.<br/>I uploaded the files here: <a href="https://dl.dropboxusercontent.com/u/23958662/wifiMgr.zip">https://dl.dropboxusercontent.com/u/23958662/wifiMgr.zip</a><br/>Just follow the Readme.txt</p><p>My wireless config:<br/></p><div class="codebox"><pre><code>config wifi-device &#039;radio0&#039;
        option type &#039;mac80211&#039;
        option path &#039;pci0000:00/0000:00:00.0&#039;
        list ht_capab &#039;SHORT-GI-40&#039;
        list ht_capab &#039;TX-STBC&#039;
        list ht_capab &#039;RX-STBC1&#039;
        list ht_capab &#039;DSSS_CCK-40&#039;
        option country &#039;BO&#039;
        option txpower &#039;17&#039;
        option hwmode &#039;11ng&#039;
        option htmode &#039;HT20&#039;
        option channel &#039;2&#039;

config wifi-iface
        option short_preamble &#039;1&#039;
        option device &#039;radio0&#039;
        option network &#039;wwan&#039;
        option mode &#039;sta&#039;
        option encryption &#039;psk2&#039;
        option key &#039;2sss3sd305s&#039;
        option ssid wifi1&#039;&#039;</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p211588">
				<div class="post-metadata">
					<div class="post-num">Post #29</div>
					<div class="post-author">dabyd64</div>
					<div class="post-datetime">
						4 Sep 2013, 16:34					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Averell wrote:</cite><blockquote><p>Hi dabyd64,</p><p>Could you please help tell me the reason you created the new scan0 interface? Why didn&#039;t you use wlan0 to scan?</p><p>BTW, I think that the file /etc/init.d/wifiMgr missed &quot; /etc/rc.common&quot; in the first line.</p><p>Thanks and regards,<br/>Averell</p></blockquote></div><p>I found problems when the wlan0 interface was disconected, sometimes it would hang!<br/>Disabling it, creating scan0 and then enabling wlan0 again after scanning worked perfectly in all the tests I made.</p><p><em><span class="bbu">About rc.common..well, it&#039;s working without it. So I didn&#039;t add it <img src="https://forum.openwrt.org/img/smilies/tongue.png" width="15" height="15" alt="tongue"/></span></em><br/>Edit: It was there, but the file I copied in that moment didn&#039;t had it. My bad!</p><p>eeff11, it looks that you copied something wrong. This errors makes no sense. It just does &quot;sleep 30&quot;<br/></p><div class="codebox"><pre><code>sleep: invalid number &#039;net=&#039;</code></pre></div>											<p class="post-edited">(Last edited by <strong>dabyd64</strong> on 16 Oct 2013, 01:27)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p211821">
				<div class="post-metadata">
					<div class="post-num">Post #30</div>
					<div class="post-author">Averell</div>
					<div class="post-datetime">
						7 Sep 2013, 09:04					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dabyd64 wrote:</cite><blockquote><div class="quotebox"><cite>Averell wrote:</cite><blockquote><p>Hi dabyd64,</p><p>Could you please help tell me the reason you created the new scan0 interface? Why didn&#039;t you use wlan0 to scan?</p><p>BTW, I think that the file /etc/init.d/wifiMgr missed &quot; /etc/rc.common&quot; in the first line.</p><p>Thanks and regards,<br/>Averell</p></blockquote></div><p>I found problems when the wlan0 interface was disconected, sometimes it would hang!<br/>Disabling it, creating scan0 and then enabling wlan0 again after scanning worked perfectly in all the tests I made.</p><p>About rc.common..well, it&#039;s working without it. So I didn&#039;t add it <img src="https://forum.openwrt.org/img/smilies/tongue.png" width="15" height="15" alt="tongue"/></p></blockquote></div><p>having /etc/rc.common would help enabling the script. I think you must have had that line once, then you enabled the script, never disable the script after that, and removed that line. Otherwise, how can you have that wifiMgr started up automatically?<br/>I prefer a standardized init script (putting wifiMgr.sh into /usr/bin/ instead of /etc/:<br/></p><div class="codebox"><pre><code>#!/bin/sh /etc/rc.common

START=99
APP=wifiMgr.sh
PID_FILE=/var/run/$APP.pid

start() {
        start-stop-daemon -S -x $APP -p $PID_FILE -m -b
}

stop() {
        start-stop-daemon -K -n $APP -p $PID_FILE -s TERM
        rm -rf $PID_FILE
}</code></pre></div>											<p class="post-edited">(Last edited by <strong>Averell</strong> on 7 Sep 2013, 10:11)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p211949">
				<div class="post-metadata">
					<div class="post-num">Post #31</div>
					<div class="post-author">dabyd64</div>
					<div class="post-datetime">
						9 Sep 2013, 16:09					</div>
				</div>
				<div class="post-content content">
					<p>who knows, maybe you&#039;re right! I&#039;ll add that line then!</p><p><strong>****edit***</strong><br/>It was already there! I may have copied it wrong when I did the post. It exists on the downloadable file...<br/>I edited and changed wifiMgr as you posted. Now it&#039;s a lot better! Also edited the locations to /usr/bin<br/>As I said, my knowledge about linux is pretty poor. But not in Windows! (I&#039;m ready for my public execution after saying this <img src="https://forum.openwrt.org/img/smilies/lol.png" width="15" height="15" alt="lol"/>)</p><p>Updated the downloadable zip file <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile"/></p>											<p class="post-edited">(Last edited by <strong>dabyd64</strong> on 9 Sep 2013, 16:50)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p212230">
				<div class="post-metadata">
					<div class="post-num">Post #32</div>
					<div class="post-author">dabyd64</div>
					<div class="post-datetime">
						13 Sep 2013, 03:25					</div>
				</div>
				<div class="post-content content">
					<p>Some nice updates there. Your feedback is very appreciated <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile"/></p>											<p class="post-edited">(Last edited by <strong>dabyd64</strong> on 13 Sep 2013, 03:25)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p213871">
				<div class="post-metadata">
					<div class="post-num">Post #33</div>
					<div class="post-author">eeff11</div>
					<div class="post-datetime">
						4 Oct 2013, 08:43					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dabyd64 wrote:</cite><blockquote><p>Some nice updates there. Your feedback is very appreciated <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile"/></p></blockquote></div><p>Yes, thanks so much, dabyd64,</p><p>with your extensive help, it now WORKS as each boot connnecting to the one as in the wlist, #1, #2, etc.</p><p>The remaining problem,is the bssid. If using the luci web to MANUALLY repeat a essid,&quot;join the network&quot; actually, cat etc/config/wireless, there is a <br/>&quot;option bssid xx:xx:xx:xx:xx:xx&quot;, what are really the difficulties if define the variant &quot;bssid&quot;, and say put the variant &quot;bssid&quot; in the script like &quot; uci set wireless.@wifi-iface[0].bssid=&quot;$bssid&quot;.</p><p>This bssid is that I am repeating the free city wifi, they got several same essids, but different bssid, in UBNT airos, you can &quot;LOCK&quot; a bssid when repeating as a client in it&#039;s web config interface.But really no idea in Openwrt, too many &quot;inside tricks&quot;. <span class="postimg"><img src="http://wiki.ubnt.com/images/b/b2/Airos_link_station_wds.png" alt="http://wiki.ubnt.com/images/b/b2/Airos_link_station_wds.png"/></span></p><p>Other issue is how to use the AA 12.09 macchanger.ipk, seached a lot, seems no one ever got success,either before the wlan0 is up or after.Since the free city wifi has a 12 hour connection limit per mac, so I need a random wwan mac each boot of the router.AAP v3 can do it perfectly.</p><p>One last serious problem is that: does the script writes to the flash each time it tried a new ap on the wlist,write to the etc/config/wireless, doesn&#039;t it? This is SERIOUS, &#039;cause the NOR flash has a limited life, though claimed to be 100,000 times rewriteable, SERIOULY DOUBT THAT. NO STRANGELY ENOUGH,SAMSUNG&#039;S NAND FLASH develop algorithms for bad blocks.If some block is damaged for frequent write, the whole router is dead. The AAP seems to do this by writes in the RAM, /tmp....</p><p>When you have time,pls check here , 7,8,9,10 floor,<a href="https://forum.openwrt.org/viewtopic.php?pid=94025#p94025">https://forum.openwrt.org/viewtopic.php?pid=94025#p94025</a><br/>Each script shall minimize the write to the flash as little as possible.<br/>Lux has did a goog job, No. 4 of <a href="https://forum.openwrt.org/viewtopic.php?pid=119392#p119392">https://forum.openwrt.org/viewtopic.php?pid=119392#p119392</a></p><p>Except for that, this script is REALLY TWO THUMBS up, can replace AAP v3, as that only supports madwifi, not ath9k!</p><p>Thanks.</p>											<p class="post-edited">(Last edited by <strong>eeff11</strong> on 4 Oct 2013, 11:53)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p214255">
				<div class="post-metadata">
					<div class="post-num">Post #34</div>
					<div class="post-author">dabyd64</div>
					<div class="post-datetime">
						8 Oct 2013, 01:58					</div>
				</div>
				<div class="post-content content">
					<p>Hi,<br/>The script executes UCI commands. It doesn&#039;t manage directly any file but his &quot;config&quot;.<br/>So, whatever it does I guess that yes, it writes to Flash.<br/>But remember that each cell can be erased &gt;100K times. The filesystem prevents you to always modify the same sector, so when you make any change, the data in the current sector is not modified, but copied to another different sector.<br/>In most cases, each sector is sized in 64KBytes, having only ~300KB free, means 5 sectors. That is 500K writes!<br/>You have to modify the file 500 times a day for 3 years! By the way, I never heard anyone having killed it&#039;s router&#039;s&nbsp; flash!<br/>NAND has millions of sectors, it&#039;s normal that some fail. But serial flash has only 4, 8, 16MB, they don&#039;t have replacement sectors and they are not designed to allow fails, so probably you will have to replace the flash chip .</p><p>I&#039;ve just updated the script.<br/>Inside the config file, set the variable <strong>randMac</strong> to &quot;1&quot; to make the script to set a random mac on each boot. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile"/></p><p>Thanks to google and a clever guy I found a nice way to generate it without needing to install any openwrt package:<br/></p><div class="codebox"><pre><code> mac=(dd if=/dev/urandom bs=1024 count=1 2&gt;/dev/null|md5sum|sed &#039;s/^\(..\)\(..\)\(..\)\(..\)\(..\)\(..\).*$/\1:\2:\3:\4:\5:\6/&#039;)</code></pre></div><br/><p>I still have to find how to know when a BSSID and SSID are from the same network, and how to detect a network that has the same SSID but different BSSID.</p>											<p class="post-edited">(Last edited by <strong>dabyd64</strong> on 8 Oct 2013, 02:10)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p214260">
				<div class="post-metadata">
					<div class="post-num">Post #35</div>
					<div class="post-author">eeff11</div>
					<div class="post-datetime">
						8 Oct 2013, 05:26					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dabyd64 wrote:</cite><blockquote><p>Hi,<br/>The script executes UCI commands. It doesn&#039;t manage directly any file but his &quot;config&quot;.<br/>So, whatever it does I guess that yes, it writes to Flash.<br/>But remember that each cell can be erased &gt;100K times. The filesystem prevents you to always modify the same sector, so when you make any change, the data in the current sector is not modified, but copied to another different sector.<br/>In most cases, each sector is sized in 64KBytes, having only ~300KB free, means 5 sectors. That is 500K writes!<br/>You have to modify the file 500 times a day for 3 years! By the way, I never heard anyone having killed it&#039;s router&#039;s&nbsp; flash!<br/>NAND has millions of sectors, it&#039;s normal that some fail. But serial flash has only 4, 8, 16MB, they don&#039;t have replacement sectors and they are not designed to allow fails, so probably you will have to replace the flash chip .</p><p>I&#039;ve just updated the script.<br/>Inside the config file, set the variable <strong>randMac</strong> to &quot;1&quot; to make the script to set a random mac on each boot. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile"/></p><p>Thanks to google and a clever guy I found a nice way to generate it without needing to install any openwrt package:<br/></p><div class="codebox"><pre><code> mac=(dd if=/dev/urandom bs=1024 count=1 2&gt;/dev/null|md5sum|sed &#039;s/^\(..\)\(..\)\(..\)\(..\)\(..\)\(..\).*$/\1:\2:\3:\4:\5:\6/&#039;)</code></pre></div><br/><p>I still have to find how to know when a BSSID and SSID are from the same network, and how to detect a network that has the same SSID but different BSSID.</p></blockquote></div><p>You&#039;re clever too and most important, you&#039;re resourceful and so helpful.</p><p>I will report after test.</p><p>I found that AAP v3 use bssid to identify a wifi, maybe that helps you a little.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p214353">
				<div class="post-metadata">
					<div class="post-num">Post #36</div>
					<div class="post-author">eeff11</div>
					<div class="post-datetime">
						9 Oct 2013, 05:57					</div>
				</div>
				<div class="post-content content">
					<p>Hi, dabyd64,</p><p>the random mac worked when changed the script and rebooted, it still worked,two random MacS.</p><p>But today, when I powered on the router, the mac still is the orginal one, random mac didn&#039;t work. When I rebooted, it remains the same, and I rebooted for the third time, the random Mac works. Strange.</p><p>I am still testing.</p><p>And I notice there is some change in the main loop NetChange, but basically the change is almost doing the same thing as the last version.Why the change? The connection seems to drop more frequently than the last version, maybe today&#039;s radio disturbance around me is worse, irrelevant to the script.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p214532">
				<div class="post-metadata">
					<div class="post-num">Post #37</div>
					<div class="post-author">eeff11</div>
					<div class="post-datetime">
						11 Oct 2013, 07:13					</div>
				</div>
				<div class="post-content content">
					<p>tested 2 days, some time boot, a random Mac, sometime, it&#039;s the orginal&nbsp; &nbsp;Mac, flashed all again with wiping all settings, set up from Zero, same strange thing, sometime random, sometime the original Mac, strange, looked into the script, seems correct, really no idea.</p><p>another issue I asked help in another post in general discussion. AA 12.09 locked to US regdomain, which makes no sense since the stock firmware from Tp-Link can make use of channel 12,13.AA 12.09 makes the &quot;openwrt&quot; not so open.Really have to compile again with &quot;option force....&quot;?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p214556">
				<div class="post-metadata">
					<div class="post-num">Post #38</div>
					<div class="post-author">FriedZombie</div>
					<div class="post-datetime">
						11 Oct 2013, 14:26					</div>
				</div>
				<div class="post-content content">
					<p>Some macaddresses give issues, set the first octet of the mac address fixed to a value.</p>											<p class="post-edited">(Last edited by <strong>FriedZombie</strong> on 11 Oct 2013, 14:26)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p214612">
				<div class="post-metadata">
					<div class="post-num">Post #39</div>
					<div class="post-author">eeff11</div>
					<div class="post-datetime">
						12 Oct 2013, 05:32					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>FriedZombie wrote:</cite><blockquote><p>Some macaddresses give issues, set the first octet of the mac address fixed to a value.</p></blockquote></div><p>hi, except that set the first octet fixed, better solution? The first octet value fixed makes the random mac function less meaningful.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p214632">
				<div class="post-metadata">
					<div class="post-num">Post #40</div>
					<div class="post-author">FriedZombie</div>
					<div class="post-datetime">
						12 Oct 2013, 16:41					</div>
				</div>
				<div class="post-content content">
					<p>well a better solution would be to disallow a mac to start with 00 or 01<br/><a href="https://www.iana.org/assignments/ethernet-numbers/ethernet-numbers.xhtml">https://www.iana.org/assignments/ethernet-numbers/ethernet-numbers.xhtml</a></p>											<p class="post-edited">(Last edited by <strong>FriedZombie</strong> on 12 Oct 2013, 16:44)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p214636">
				<div class="post-metadata">
					<div class="post-num">Post #41</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						12 Oct 2013, 16:48					</div>
				</div>
				<div class="post-content content">
					<p>Any mac with bit 0 (broadcast) unset and bit 1 (locally administered) set is a valid mac.<br/>So performing binary ((n &amp; 0x7F) | 0x02) on the first byte will always yield a good usable address.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p214898">
				<div class="post-metadata">
					<div class="post-num">Post #42</div>
					<div class="post-author">dabyd64</div>
					<div class="post-datetime">
						16 Oct 2013, 01:10					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>eeff11 wrote:</cite><blockquote><p>[...]Really have to compile again with &quot;option force....&quot;?</p></blockquote></div><p>Yes. I don&#039;t understand that, it&#039;s something like &quot;you must compile your own to enable illegal channels on US&quot;</p><div class="quotebox"><cite>FriedZombie wrote:</cite><blockquote><p>Some macaddresses give issues, set the first octet of the mac address fixed to a value.</p></blockquote></div><div class="quotebox"><cite>jow wrote:</cite><blockquote><p>Any mac with bit 0 (broadcast) unset and bit 1 (locally administered) set is a valid mac.<br/>So performing binary ((n &amp; 0x7F) | 0x02) on the first byte will always yield a good usable address.</p></blockquote></div><p>So, better to force what bytes to what value?<br/>Some time ago I had problems with router when the first byte was not 00, ex. 93:22:15:ec:5d:47<br/>But none if it was 00:xx:xx:xx:xx:xx</p><p>Forcing the mac to be xx:xx:xx:xx:xx:02 would work always?</p><p>I have updated the script, all the generated MAC addresses will be 00:xx:xx:xx:xx:02. Let me know if it works now <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink"/></p>											<p class="post-edited">(Last edited by <strong>dabyd64</strong> on 16 Oct 2013, 01:22)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p215147">
				<div class="post-metadata">
					<div class="post-num">Post #43</div>
					<div class="post-author">vitaliy_86</div>
					<div class="post-datetime">
						19 Oct 2013, 08:37					</div>
				</div>
				<div class="post-content content">
					<p>It is interesting to add to the script to connect to open access points as well as an automatic search through a password reaver</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p224461">
				<div class="post-metadata">
					<div class="post-num">Post #44</div>
					<div class="post-author">m79b01</div>
					<div class="post-datetime">
						3 Feb 2014, 20:14					</div>
				</div>
				<div class="post-content content">
					<p>Wondering if this could work on dd-wrt? I have autoap working on my dd however only accepts open connections.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p225172">
				<div class="post-metadata">
					<div class="post-num">Post #45</div>
					<div class="post-author">s3cr3t3d</div>
					<div class="post-datetime">
						12 Feb 2014, 22:12					</div>
				</div>
				<div class="post-content content">
					<p>Hi dabyd64,</p><p>I try to install your script but i got this error:<br/>root@OpenWrt:~# /etc/init.d/wifiMgr restart<br/><span style="color: #FF0000">no wifiMgr.sh found; none killed</span><br/>root@OpenWrt:~# cd /usr/bin/<br/>root@OpenWrt:/usr/bin# ls<br/>[&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;cut&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ivstools&nbsp; &nbsp; &nbsp; &nbsp; passwd&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; test<br/>[[&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dbclient&nbsp; &nbsp; &nbsp; &nbsp; jshn&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pgrep&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;time<br/>aircrack-ng&nbsp; &nbsp; &nbsp;dirname&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;killall&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;printf&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; top<br/>airdecap-ng&nbsp; &nbsp; &nbsp;dropbearkey&nbsp; &nbsp; &nbsp;kstats&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; readlink&nbsp; &nbsp; &nbsp; &nbsp; tr<br/>airdecloak-ng&nbsp; &nbsp;du&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; less&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; reaver&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; traceroute<br/>arping&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; env&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;logger&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; reset&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;uniq<br/>awk&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;expr&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lua&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;scp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;uptime<br/>basename&nbsp; &nbsp; &nbsp; &nbsp; find&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; luci-bwc&nbsp; &nbsp; &nbsp; &nbsp; seq&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;wash<br/>buddy-ng&nbsp; &nbsp; &nbsp; &nbsp; free&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; makeivs-ng&nbsp; &nbsp; &nbsp; sort&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; wc<br/>bunzip2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;haserl&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; md5sum&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ssh&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;wget<br/>bzcat&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;head&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mkfifo&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; strings&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;which<br/>clear&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;hexdump&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;nc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tail&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; wifiMgr.sh<br/>cmp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;hostid&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nslookup&nbsp; &nbsp; &nbsp; &nbsp; tee&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;xargs<br/>crontab&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;id&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; packetforge-ng&nbsp; telnet&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; yes<br/>root@OpenWrt:/usr/bin#</p><p>In the wifiMgr file use the default option.<br/>APP=/usr/bin/wifiMgr.sh</p><p>Could you help me?</p><p>Thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p226117">
				<div class="post-metadata">
					<div class="post-num">Post #46</div>
					<div class="post-author">dabyd64</div>
					<div class="post-datetime">
						24 Feb 2014, 00:12					</div>
				</div>
				<div class="post-content content">
					<p>Did you set the correct permissions with chmod?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235370">
				<div class="post-metadata">
					<div class="post-num">Post #47</div>
					<div class="post-author">forumninja</div>
					<div class="post-datetime">
						2 Jun 2014, 00:36					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dabyd64 wrote:</cite><blockquote><div class="quotebox"><cite>jow wrote:</cite><blockquote><p>Any mac with bit 0 (broadcast) unset and bit 1 (locally administered) set is a valid mac.<br/>So performing binary ((n &amp; 0x7F) | 0x02) on the first byte will always yield a good usable address.</p></blockquote></div><p>Forcing the mac to be xx:xx:xx:xx:xx:02 would work always?</p><p>I have updated the script, all the generated MAC addresses will be 00:xx:xx:xx:xx:02.</p></blockquote></div><p>Actually should be first octet, so force 02:xx:xx:xx:xx:xx. I think you are having problems if you set the broadcast bit (e.g. 97:xx:xx:xx:xx:xx would be a problem because it will be a multicast/broadcast address)</p><p><a href="https://en.wikipedia.org/wiki/MAC_address#Address_details">https://en.wikipedia.org/wiki/MAC_address#Address_details</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235381">
				<div class="post-metadata">
					<div class="post-num">Post #48</div>
					<div class="post-author">dabyd64</div>
					<div class="post-datetime">
						2 Jun 2014, 02:25					</div>
				</div>
				<div class="post-content content">
					<p>Well, almost all computers/devices start with 00:xx:xx:xx:xx:xx:xx so its a bit confusing...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235557">
				<div class="post-metadata">
					<div class="post-num">Post #49</div>
					<div class="post-author">s3cr3t3d</div>
					<div class="post-datetime">
						3 Jun 2014, 22:19					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dabyd64 wrote:</cite><blockquote><p>Did you set the correct permissions with chmod?</p></blockquote></div><br/><p>Hi Dadyd64,</p><p>Yes. I&#039;ve set.</p><p>I&#039;ve installed another router and i have same error message.</p><p>Could you <a href="https://dl.dropboxusercontent.com/u/23958662/wifiMgr.zip">https://dl.dropboxusercontent.com/u/23958662/wifiMgr.zip</a> download the file and try to set again with your router?</p><p>My openwrt version: Attitude Adjustment 12.09</p><p>Thx</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235563">
				<div class="post-metadata">
					<div class="post-num">Post #50</div>
					<div class="post-author">dabyd64</div>
					<div class="post-datetime">
						3 Jun 2014, 22:44					</div>
				</div>
				<div class="post-content content">
					<p>Something has gone wrong, that is not the latest version of the script???<br/>I&#039;ll check it right now.</p><p>*EDIT*</p><p>Yes, at some point I uploaded a wrong file, it was dated of 9-9-2013 while the latest and final version was done on 16-9-2013.<br/>But part of the files did belong to the latest version, so I guess that I mixed the files somehow.<br/>I have fixed it, the link is still the same.<br/>Please delete all the related files before trying the latest version<br/>Sorry for the mistake! <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad"/></p>											<p class="post-edited">(Last edited by <strong>dabyd64</strong> on 3 Jun 2014, 23:33)</p>
									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 2 of 5</div><nav><ul><li><a href="viewtopic.php%3Fid=43352&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li><li><a href="viewtopic.php%3Fid=43352&amp;p=3.html">3</a></li><li><a href="viewtopic.php%3Fid=43352&amp;p=4.html">4</a></li><li><a href="viewtopic.php%3Fid=43352&amp;p=5.html">5</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0.001 -->

</body>
</html>