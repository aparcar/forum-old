<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> iptables limit module</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 23 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p2443">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">zibadun</div>
					<div class="post-datetime">
						5 Oct 2004, 20:38					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m trying to use the iptables with limit module (a scipt generated by fwbuilder) and having a problem.&nbsp; The example of the error is:<br />[code]iptables -A RULE_10&nbsp; &nbsp;-m limit --limit 2/second -j LOG&nbsp; --log-level info --log-prefix &quot;RULE 10 -- REJECT &quot; </p><p>iptables v1.2.9: Couldn&#039;t load match `limit&#039;:File not found<br />[/code]<br />If I take out &#039;-m limit --limit 2/second&#039; the rule works.&nbsp; I have loaded the ipt_limit and the qos modules (sch_tbf, etc).</p><p>Also I have loaded the ipt_CLASSIFY module and it doesn&#039;t seem to enable using the CLASSIFY target.&nbsp; So it seems like iptables ignores any ipt modules.&nbsp; Is there something simple I&#039;m missing.&nbsp; I would appreciate any help.</p><p>regards,</p><p>[/code]</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p2444">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Nico</div>
					<div class="post-datetime">
						5 Oct 2004, 21:34					</div>
				</div>
				<div class="post-content content">
					<p>hi zibadun,</p><p>there&#039;s only a subset of iptables extensions compiled in by default, you can see which ones in <strong>buildroot/sources/iptables-openwrt-extensions.patch</strong> :</p><div class="codebox"><pre><code>+PF_EXT_SLIB:=icmp iprange mark multiport standard state tcp udp DNAT LOG MARK MASQUERADE REDIRECT REJECT SNAT TCPMSS</code></pre></div><p>the one missing is <strong>limit</strong> (aka /usr/lib/iptables/ipt_limit.so)</p><p>You have 2 solutions here :<strong> Â· </strong> add <strong>limit</strong> to the PF_EXT_SLIB variable in the patch mentionned above<br /><strong> Â· </strong> rebuilt a full iptables, with all extensions enabled</p><p>--<br />Nico</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p2447">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">zibadun</div>
					<div class="post-datetime">
						6 Oct 2004, 03:17					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><p>hi zibadun,</p><p>(aka /usr/lib/iptables/ipt_limit.so)</p></blockquote></div><p>Nico thank you!&nbsp; I did not realize that the iptables extension is required in addition to the kernel module.&nbsp; As soom as I copied ipt_limit.so and did insmod ipt_limit everything worked like a charm.&nbsp; I got the CLASSIFY working the same way.&nbsp; Thanks again</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p4566">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">mrverbose</div>
					<div class="post-datetime">
						12 Feb 2005, 02:33					</div>
				</div>
				<div class="post-content content">
					<p>I have compiled all iptables libs that were available from the buildroot. I have uploaded them, so if you do not like to compile them yourself, feel free to use these ones:</p><p><a href="http://openwrt.modulotech.de/pub/iptables-1.2.11/extensions/index.html">http://openwrt.modulotech.de/pub/iptabl … index.html</a></p><p>mrverbose</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p10846">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">joseangel</div>
					<div class="post-datetime">
						16 Aug 2005, 14:23					</div>
				</div>
				<div class="post-content content">
					<p>Aren&#039;t those extra modules automagically loaded when needed? I have all iptables packages installed and can make it work if I add the ipt_limit module to /etc/modules (prefer that instead of manually insmod after every reboot), but I read on iptables docs that the -m option is capable of loading modules when needed. Why is it not loading the ipt_limit module on its own? Is there an option I must set to let it find the modules?</p><p>Also fwbuilder generated rules.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p10848">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Vincent Bernat</div>
					<div class="post-datetime">
						16 Aug 2005, 14:43					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>joseangel wrote:</cite><blockquote><p>Aren&#039;t those extra modules automagically loaded when needed? I have all iptables packages installed and can make it work if I add the ipt_limit module to /etc/modules (prefer that instead of manually insmod after every reboot), but I read on iptables docs that the -m option is capable of loading modules when needed. Why is it not loading the ipt_limit module on its own? Is there an option I must set to let it find the modules?</p></blockquote></div><p>I think that when the doc states that iptables loads modules, it is the modules of iptables, not the modules of netfilter. These modules are in /lib/iptables.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p10850">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">joseangel</div>
					<div class="post-datetime">
						16 Aug 2005, 15:06					</div>
				</div>
				<div class="post-content content">
					<p>Thank you. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45920">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">at</div>
					<div class="post-datetime">
						5 Apr 2007, 22:37					</div>
				</div>
				<div class="post-content content">
					<p>It seems that I am missing ipt_limit.o module and I am a little confused.</p><p>Kernel modules supporting all other iptables modules come in the corresponding packages. For example, iptables-mod-ipopt package contains TOS iptables module, and kmod-ipt-ipopt package contains the corresponding ipt_tos.o.</p><p>&#039;limit&#039; iptables module is contained in iptables package:<br /></p><div class="codebox"><pre><code># ipkg search /usr/lib/iptables/libipt_limit.so
iptables - 1.3.3-2 - /usr/lib/iptables/libipt_limit.so

# ipkg search /lib/modules/2.4.30/ipt_tos.o
kmod-ipt-ipopt - 2.4.30-brcm-5 - /lib/modules/2.4.30/ipt_tos.o</code></pre></div><p>&#039;iptables&#039; package contains also other iptables modules, for example &#039;state&#039;:<br /></p><div class="codebox"><pre><code># ipkg files iptables
Package iptables (1.3.3-2) is installed on root and has the following files:
/usr/lib/iptables/libipt_mark.so
/usr/lib/iptables/libipt_udp.so
/usr/lib/iptables/libipt_multiport.so
/usr/sbin/iptables
/usr/lib/iptables/libipt_limit.so
/usr/lib/iptables/libipt_state.so
...</code></pre></div><p>There is no equivalent ipt_state.o kernel module, yet &#039;state&#039; iptables target works. Is it compiled into the kernel?</p><p>But iptables &#039;limit&#039; does not work. And it is one of the basic iptables modules.</p><p>Should there be ipt_limit.o kernel module?</p><p><strong>What package is it in?</strong></p><p>(By the way, the URL referenced in one of the postings above doesn&#039;t work.)</p><p>Thank you</p>											<p class="post-edited">(Last edited by <strong>at</strong> on 5 Apr 2007, 22:43)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>