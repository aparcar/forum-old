<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Fon 2100 Reset button and Init for Serial Console?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 20 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p99025">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">DeusExMachina</div>
					<div class="post-datetime">
						19 Dec 2009, 19:32					</div>
				</div>
				<div class="post-content content">
					<p>Hi ppl,</p><p>I&#039;m working on a project of creating an Fon 2100 Kismet Server with GPS logger.<br />For that, I did already give the Fon an Serial as well as an TTL Console with Phantompower for the GPS, as well as an SD-Card Mod.</p><p>But I ran into some problems and would need your help.</p><p>Biggest idea is I want to use the reset button to toggle the serial console of the fonera to &quot;GPS Modus&quot; or &quot;Serial Console Modus&quot;.</p><p>GPS Modus should be following:<br />- no attached console<br />- 4800 baud</p><p>Serial Modus:<br />- ttyS0 with login / ash console to work on the fon in case of an emergency / lock out<br />- 9600 baud</p><br /><p>My first idea is following to change from one mode to the other.<br />I boot with following /etc/inittab:<br />::sysinit:/etc/init.d/rcS S boot<br />::shutdown:/etc/init.d/rcS K stop<br />tts/0::askfirst:/bin/ash --login<br />#ttyS0::askfirst:/bin/ash --login<br />#tty1::askfirst:/bin/ash --login<br />(thats the &quot;gps&quot; one)</p><p>i created two other inttabs<br />inittab.nc (no console)<br />::sysinit:/etc/init.d/rcS S boot<br />::shutdown:/etc/init.d/rcS K stop<br />#tts/0::askfirst:/bin/ash --login<br />#ttyS0::askfirst:/bin/ash --login<br />tty1::askfirst:/bin/ash --login<br />stty -F /dev/ttyS0 4800</p><br /><p>inttab.co (console)<br />::sysinit:/etc/init.d/rcS S boot<br />::shutdown:/etc/init.d/rcS K stop<br />tts/0::askfirst:/bin/ash --login<br />ttyS0::askfirst:/bin/ash --login<br />tty1::askfirst:/bin/ash --login<br />stty -F /dev/ttyS0 9600</p><br /><p>to swap the mode i simply do following<br />cp /etc/inttab.co /etc/inittab<br />init -q</p><p>with that i get into &quot;console mode&quot;</p><br /><p>cp /etc/inttab.nc /etc/inittab<br />init -q<br />this starts &quot;no console / gps mode&quot;<br />problem is: the console on the serial port just doesn&#039;T close!</p><p>i would need to enter &quot;exit&quot; on the serial console myself - i just can&#039;T close it!<br />even doin&#039; stuff like echo &quot;exit&quot; &gt;&gt; /dev/ttyS0 doesn&#039;t work at all...</p><br /><p>My questions<br />a) anyone got an idea how to close the serial console on the serial port without manual action<br />b) anyone got an better idea how to solve my problem at all because that here is really quick &#039;n dirty<br />c) how do i use the reset button on the fonera to switch between both modes?<br />i saw an /etc/config/system file that usses the reset button. but on the fon2100 it looks like the reset button doesn&#039;T work at all - i can press it all the time and time worths defined there - nothing happens.</p><br /><p>thank you very much!!!</p><p>deusex</p><p>EDIT: The Serial Port Speed change in the inttab does NOT work T_T&#039;... any ideas on that?</p>											<p class="post-edited">(Last edited by <strong>DeusExMachina</strong> on 19 Dec 2009, 19:58)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p99085">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">DeusExMachina</div>
					<div class="post-datetime">
						21 Dec 2009, 19:08					</div>
				</div>
				<div class="post-content content">
					<p>ok, in the meantime i got around the problem of changing the serial port speed.<br />but the other 3 problems are still there. any ideas?<br />thanks</p><p>deusex</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>