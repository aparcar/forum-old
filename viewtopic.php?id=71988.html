<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> ipv6: bridged wan-lan vs non-bridged wan-lan performance vs ipv4 nat</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 23 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p365011">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">kyzhk</div>
					<div class="post-datetime">
						6 Sep 2017, 05:55					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I did some performance test with ipv6 using an old router. Here&#039;s some result from iperf:</p><p>ipv6 over bridged wan - lan (bridged, full sirq) </p><div class="codebox"><pre><code>    Accepted connection from fe80::4d5:5a31:4769:eb39, port 49843
    [ 5] local fe80::3d70:2aa5:2ab7:3a92 port 5201 connected to fe80::4d5:5a31:4769:eb39 port 49844
    [ ID] Interval Transfer Bandwidth
    [ 5] 0.00-1.00 sec 104 MBytes 873 Mbits/sec
    [ 5] 1.00-2.00 sec 111 MBytes 928 Mbits/sec
    [ 5] 2.00-3.00 sec 110 MBytes 920 Mbits/sec
    [ 5] 3.00-4.00 sec 111 MBytes 928 Mbits/sec
    [ 5] 4.00-5.00 sec 110 MBytes 922 Mbits/sec
    [ 5] 5.00-6.00 sec 110 MBytes 924 Mbits/sec
    [ 5] 6.00-7.00 sec 110 MBytes 921 Mbits/sec
    [ 5] 7.00-8.00 sec 111 MBytes 928 Mbits/sec
    [ 5] 8.00-9.00 sec 110 MBytes 921 Mbits/sec
    [ 5] 9.00-10.00 sec 109 MBytes 918 Mbits/sec
    [ 5] 10.00-10.05 sec 5.49 MBytes 924 Mbits/sec</code></pre></div><p>ipv6 over wan - lan (not bridged, full sirq). This is roughly the same as ipv4 over wan-lan with NAT.</p><p> </p><div class="codebox"><pre><code>   Accepted connection from 2001:db80::1, port 49928
    [ 5] local 2001:db80:1::3a92 port 5201 connected to 2001:db80::1 port 49929
    [ ID] Interval Transfer Bandwidth
    [ 5] 0.00-1.00 sec 26.0 MBytes 218 Mbits/sec
    [ 5] 1.00-2.00 sec 27.5 MBytes 230 Mbits/sec
    [ 5] 2.00-3.00 sec 27.6 MBytes 232 Mbits/sec
    [ 5] 3.00-4.00 sec 27.4 MBytes 230 Mbits/sec
    [ 5] 4.00-5.00 sec 27.6 MBytes 231 Mbits/sec
    [ 5] 5.00-6.00 sec 27.4 MBytes 230 Mbits/sec
    [ 5] 6.00-7.00 sec 27.6 MBytes 231 Mbits/sec
    [ 5] 7.00-8.00 sec 27.3 MBytes 229 Mbits/sec
    [ 5] 8.00-9.00 sec 27.5 MBytes 231 Mbits/sec
    [ 5] 9.00-10.00 sec 27.3 MBytes 229 Mbits/sec
    [ 5] 10.00-10.06 sec 1.78 MBytes 232 Mbits/sec</code></pre></div><p>There is no NAT at play here - I&#039;ve also tried disabling firewall which made little difference to the iperf result.</p><p>Question: What linux stack is involved in a non-bridged wan-lan interface over bridged wan-lan interface? Given that there&#039;s no work needed for NAT (among other things that ipv6 stops doing compared to ipv4, which in principal should be less demanding of the hardware processing power), why is it still as slow as the ipv4 + nat performance? Is there a way enable bridged wan-lan performance over ipv6?</p><p>side note: I am pretty sure in the bridged wan-lan configuration, data were still flowing through the cpu as can be seen in the full sirq. When both iperf server and client are connected to lan, the cpu has no usage indicating everything were offloaded to hardware switch chip before the traffic even hits the cpu.</p>											<p class="post-edited">(Last edited by <strong>kyzhk</strong> on 6 Sep 2017, 06:06)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>