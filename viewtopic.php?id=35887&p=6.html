<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Custom x86 Image (NO LONGER MAINTAINED)</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 6 Sep 2015 and 6 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 6 of 17</div><nav><ul><li><a href="viewtopic.php%3Fid=35887&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=35887&amp;p=4.html">4</a></li><li><a href="viewtopic.php%3Fid=35887&amp;p=5.html">5</a></li><li class="pagination-current"><span>6</span></li><li><a href="viewtopic.php%3Fid=35887&amp;p=7.html">7</a></li><li><a href="viewtopic.php%3Fid=35887&amp;p=8.html">8</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=35887&amp;p=17.html">17</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p177373">
				<div class="post-metadata">
					<div class="post-num">Post #126</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						8 Sep 2012, 07:38					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Alex Atkin UK wrote:</cite><blockquote><p>Well once its working I do not plan to manually update unless its absolutely essential, its too much hassle.</p><p>Hopefully it will get on your nerves enough too so you get the automatic updater written. <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p></blockquote></div><p>It is already on my nerves <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" />&nbsp; Has been since release 3 or 4 when I moved my machine over to btrfs and figured out how to do an in-place upgrade.</p><br /><p>I actually just ran through the process again this evening.&nbsp; Decided it was time to upgrade my live version now that the QoS stuff and a number of other items were taken care of with your help.&nbsp; Managed to figure out why my one wifi card was having troubles: PCI riser card jumpers were wrong and won&#039;t allow some card combinations.&nbsp; Took 4 hours of fiddling to get wifi online but only 20 minutes to upgrade <img src="https://forum.openwrt.org/img/smilies/tongue.png" width="15" height="15" alt="tongue" />.&nbsp; I will be situating my router over the next few days and a bi-weekly automated build going.&nbsp; Once those two things are complete I&#039;m planning on starting in on the in-place upgrade work.&nbsp; You&#039;ll want to keep an eye on the thread for updated builds though.&nbsp; There may be some fixes if I find any broken items (uhttpd + ssl seems broken but I&#039;m not 100% sure).</p><p>If you&#039;re interested below are links to some pics I took of my setup.&nbsp; The only difference is I ended up having to swap the NIC in the picture for a Soekris lan1602 card (the one in the pic won&#039;t work with the wifi adapter.</p><p><a href="https://www.dropbox.com/s/9bz3q9m1ttefdh2/CameraZOOM-20120907220232009-1347071710355..jpg">https://www.dropbox.com/s/9bz3q9m1ttefd … 10355..jpg</a></p><p><a href="https://www.dropbox.com/s/y0s6lcellvw5d6r/CameraZOOM-20120907222317573-1347071690894..jpg">https://www.dropbox.com/s/y0s6lcellvw5d … 90894..jpg</a></p><p><a href="https://www.dropbox.com/s/dvy469p0rgdl340/CameraZOOM-20120907222556123-1347071700915..jpg">https://www.dropbox.com/s/dvy469p0rgdl3 … 00915..jpg</a></p><p><a href="https://www.dropbox.com/s/b2kjmps6xmt92sz/CameraZOOM-20120907222954921-1347071679659..jpg">https://www.dropbox.com/s/b2kjmps6xmt92 … 79659..jpg</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p177467">
				<div class="post-metadata">
					<div class="post-num">Post #127</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						8 Sep 2012, 19:04					</div>
				</div>
				<div class="post-content content">
					<p>Very interesting.</p><p>I was originally going to have two WiFi cards in my box too but as I would need to replace the Buffalo router with a 4 or 8 port switch, it made more sense to just keep using the Buffallo as a switch and WiFi AP.&nbsp; Plus it means I can always revert to using it as a router if I have any problems with the Atom box.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p177625">
				<div class="post-metadata">
					<div class="post-num">Post #128</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						10 Sep 2012, 14:54					</div>
				</div>
				<div class="post-content content">
					<p>I have done some more testing with the latest build and not having a lot of luck with it.</p><p>Firstly, PPPoE isn&#039;t working correctly.</p><p>The Buffalo calls:<br />/usr/sbin/pppd plugin rp-pppoe.so mtu 1492 mru 1492 persist usepeerdns defaultroute replacedefaultroute user USERNAME password PASSWORD ipparam wanifname pppoe-wan nodetach nic-eth1</p><p>Your build calls:<br />/usr/sbin/pppd nodetach ipparam wanifname pppoe-wan nodefaultroute persist maxfail 1 user USERNAME password PASSWORD ip-up-script /lib/netifd/ppp-up ipv6-up-script /lib/netifd/ppp-up ip-down-script /lib/netifd/ppp-down ipv6-down-script /lib/netifd/ppp-down mtu 1492 mru 1492 plugin rp-pppoe.so nic-eth1</p><p>Notice the &quot;nodefaultroute&quot;, no wonder I couldn&#039;t get routing working.&nbsp; However its puzzling as that option is NOT ticked in LuCI or set in /etc/config/network.&nbsp; I&#039;m also puzzled why its calling ipv6 up/down scripts when &quot;Enable IPv6 negotiation on the PPP link&quot; is unticked.</p><p>However this build also seems to have real issues with the on board LAN adapter too.&nbsp; </p><p>I noticed even after passing that power management disabling line I mentioned before, pings still fluctuated between 0.3 and 5ms.&nbsp; I&#039;m not sure what to do about that to be honest as that parameter always fixed all latency issues before.&nbsp; I&#039;m starting to wonder if I should consider the board defective and contact Intel about getting it replaced.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p177638">
				<div class="post-metadata">
					<div class="post-num">Post #129</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						10 Sep 2012, 17:01					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Alex Atkin UK wrote:</cite><blockquote><p>I have done some more testing with the latest build and not having a lot of luck with it.</p></blockquote></div><p>Bummer, I upgraded to the latest build this weekend and I&#039;ve been having good success once I figured out the issue with my riser card. </p><div class="quotebox"><cite>Alex Atkin UK wrote:</cite><blockquote><p>Firstly, PPPoE isn&#039;t working correctly.</p><p>The Buffalo calls:<br />/usr/sbin/pppd plugin rp-pppoe.so mtu 1492 mru 1492 persist usepeerdns defaultroute replacedefaultroute user USERNAME password PASSWORD ipparam wanifname pppoe-wan nodetach nic-eth1</p><p>Your build calls:<br />/usr/sbin/pppd nodetach ipparam wanifname pppoe-wan nodefaultroute persist maxfail 1 user USERNAME password PASSWORD ip-up-script /lib/netifd/ppp-up ipv6-up-script /lib/netifd/ppp-up ip-down-script /lib/netifd/ppp-down ipv6-down-script /lib/netifd/ppp-down mtu 1492 mru 1492 plugin rp-pppoe.so nic-eth1</p><p>Notice the &quot;nodefaultroute&quot;, no wonder I couldn&#039;t get routing working.&nbsp; However its puzzling as that option is NOT ticked in LuCI or set in /etc/config/network.&nbsp; I&#039;m also puzzled why its calling ipv6 up/down scripts when &quot;Enable IPv6 negotiation on the PPP link&quot; is unticked.</p></blockquote></div><p>Odd, my PPPoE stuff is working properly.&nbsp; I know it took a minute to come up the first time but it has been stable since then.&nbsp; Can you try re-using the buffalo config?&nbsp; When I did my upgrade I copied everything in /etc/config over from the previous install.</p><br /><div class="quotebox"><cite>Alex Atkin UK wrote:</cite><blockquote><p>However this build also seems to have real issues with the on board LAN adapter too.&nbsp; </p><p>I noticed even after passing that power management disabling line I mentioned before, pings still fluctuated between 0.3 and 5ms.&nbsp; I&#039;m not sure what to do about that to be honest as that parameter always fixed all latency issues before.&nbsp; I&#039;m starting to wonder if I should consider the board defective and contact Intel about getting it replaced.</p></blockquote></div><p>I have no idea what would cause this.&nbsp; If the on-board adapter works fine with other distro&#039;s I&#039;d say it&#039;s something in the kernel, not the board.</p><br /><p>I do have my auto-build stuff mostly complete.&nbsp; If it helps a new build will be uploaded within the next few days (I&#039;ll be reporting back when it is online).&nbsp; I plan on having the build bot run on the 1st and 15th of each month.&nbsp; If it helps you out, I can run more frequent builds and hopefully things will get stable for you.&nbsp; I am building the trunk so some things may not be 100%.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p177644">
				<div class="post-metadata">
					<div class="post-num">Post #130</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						10 Sep 2012, 18:04					</div>
				</div>
				<div class="post-content content">
					<p>New build is online: <a href="https://nusku.net/openwrt/r195de16164051e2793dbcc68a371f90e6ecdeb70/">https://nusku.net/openwrt/r195de1616405 … e6ecdeb70/</a></p><p>I have a build bot running now that will build on the 1st and 15th of each month and auto-publish.&nbsp; I am working on an update in place program, will post back when that is complete as well.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p177737">
				<div class="post-metadata">
					<div class="post-num">Post #131</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						11 Sep 2012, 09:22					</div>
				</div>
				<div class="post-content content">
					<p>Strange, seems its not likely to be that PPPoE command line as I finally got a PPPoE test server up and it connects to that instantly including setting up the routing.</p><p>The bigger problem is neither Intel card will keep the link up when connected to my modem, not just the on-board. <img src="https://forum.openwrt.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p177791">
				<div class="post-metadata">
					<div class="post-num">Post #132</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						11 Sep 2012, 16:24					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Alex Atkin UK wrote:</cite><blockquote><p>Strange, seems its not likely to be that PPPoE command line as I finally got a PPPoE test server up and it connects to that instantly including setting up the routing.</p><p>The bigger problem is neither Intel card will keep the link up when connected to my modem, not just the on-board. <img src="https://forum.openwrt.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /></p></blockquote></div><p>I&#039;m glad to hear PPPoE looks to be working.&nbsp; Bummer on the Intel cards.&nbsp; I just checked the kernel config and it doesn&#039;t look like there is anything special set for the Intel cards beyond &quot;enable driver&quot;.&nbsp; Could it be the linux 3.3 kernel being problematic for the cards?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p177856">
				<div class="post-metadata">
					<div class="post-num">Post #133</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						11 Sep 2012, 23:59					</div>
				</div>
				<div class="post-content content">
					<p>That is definitely an aspect to it, as it worked without issue on Mandriva 2011 which had a 2.6 kernel, I think the problem appeared in a later 2.6 version though.&nbsp; But there has been plenty of commits since and I even tried compiling the latest version from Intels source which didn&#039;t fix it, very puzzling.</p><p>I just installed Windows 7 on it to see how that reacts and its fine, at least with the stock driver that comes with SP1, not tried seeing if it breaks if I use a newer driver.&nbsp; Pinging it from my Linux machine its getting 0.2 to 0.6ms response, none of the 4ms spikes I was getting when it was running OpenWRT.&nbsp; All the hardware assists seemed to be on too, which stomps on the theory that its one of those causing problems.</p><p>Its frustrating as IF anyone fixes this, they don&#039;t seem to have mentioned it online.&nbsp; Plenty of people who had this and other problems with this LAN chipset on their servers, no fixes that I can find.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p177859">
				<div class="post-metadata">
					<div class="post-num">Post #134</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						12 Sep 2012, 00:35					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Alex Atkin UK wrote:</cite><blockquote><p>Pinging it from my Linux machine its getting 0.2 to 0.6ms response, none of the 4ms spikes I was getting when it was running OpenWRT.&nbsp; All the hardware assists seemed to be on too, which stomps on the theory that its one of those causing problems.</p></blockquote></div><p>Is the 4ms response time ultimately an issue?&nbsp; I would think you could get away with a 4ms response time while the driver situation gets figured out.</p><p>If not, does your box have any pciE or pci expansion?&nbsp; You could go with a multi-port pciE or pci card in the interim while the on-board stuff is broken.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p177865">
				<div class="post-metadata">
					<div class="post-num">Post #135</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						12 Sep 2012, 03:03					</div>
				</div>
				<div class="post-content content">
					<p>If it was JUST 4ms all the time, perhaps, but 4ms jitter could really mess up online gaming.&nbsp; Although obviously the bigger issue is that I can&#039;t even get the link to stay up when plugged into the modem.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p177866">
				<div class="post-metadata">
					<div class="post-num">Post #136</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						12 Sep 2012, 03:10					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Alex Atkin UK wrote:</cite><blockquote><p>If it was JUST 4ms all the time, perhaps, but 4ms jitter could really mess up online gaming.&nbsp; Although obviously the bigger issue is that I can&#039;t even get the link to stay up when plugged into the modem.</p></blockquote></div><p>Gotcha, I don&#039;t do any online gaming so I wouldn&#039;t be affected by a constant 4ms delay.&nbsp; I&#039;ve heard 4ms can really mess up any kind of gaming.&nbsp; I would imagine if there is jitter that would make it infintely worse.</p><p>If it helps uname -a returns &quot;Linux beriberi 3.3.8 #14 SMP Thu Sep 6 12:10:55 EDT 2012 i686 GNU/Linux&quot; on my install of r59e9c735c2ef86a73584c421eddae047c39f76a7.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p177870">
				<div class="post-metadata">
					<div class="post-num">Post #137</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						12 Sep 2012, 04:15					</div>
				</div>
				<div class="post-content content">
					<p>Upgraded to latest build, grrrrrr:<br /></p><div class="codebox"><pre><code>64 bytes from 10.0.0.2: icmp_req=1 ttl=64 time=0.590 ms
64 bytes from 10.0.0.2: icmp_req=2 ttl=64 time=0.461 ms
64 bytes from 10.0.0.2: icmp_req=3 ttl=64 time=0.432 ms
64 bytes from 10.0.0.2: icmp_req=4 ttl=64 time=0.451 ms
64 bytes from 10.0.0.2: icmp_req=5 ttl=64 time=4.37 ms
64 bytes from 10.0.0.2: icmp_req=6 ttl=64 time=3.37 ms
64 bytes from 10.0.0.2: icmp_req=7 ttl=64 time=2.30 ms
64 bytes from 10.0.0.2: icmp_req=8 ttl=64 time=0.812 ms
64 bytes from 10.0.0.2: icmp_req=9 ttl=64 time=2.70 ms
64 bytes from 10.0.0.2: icmp_req=10 ttl=64 time=0.476 ms
64 bytes from 10.0.0.2: icmp_req=11 ttl=64 time=2.15 ms
64 bytes from 10.0.0.2: icmp_req=12 ttl=64 time=1.15 ms
64 bytes from 10.0.0.2: icmp_req=13 ttl=64 time=3.83 ms
64 bytes from 10.0.0.2: icmp_req=14 ttl=64 time=1.26 ms
64 bytes from 10.0.0.2: icmp_req=15 ttl=64 time=0.514 ms
64 bytes from 10.0.0.2: icmp_req=16 ttl=64 time=4.10 ms
64 bytes from 10.0.0.2: icmp_req=17 ttl=64 time=3.18 ms
64 bytes from 10.0.0.2: icmp_req=18 ttl=64 time=1.77 ms
64 bytes from 10.0.0.2: icmp_req=19 ttl=64 time=0.382 ms</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p177871">
				<div class="post-metadata">
					<div class="post-num">Post #138</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						12 Sep 2012, 04:21					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Alex Atkin UK wrote:</cite><blockquote><p>Upgraded to latest build, grrrrrr:<br /></p><div class="codebox"><pre><code>64 bytes from 10.0.0.2: icmp_req=1 ttl=64 time=0.590 ms
64 bytes from 10.0.0.2: icmp_req=2 ttl=64 time=0.461 ms
64 bytes from 10.0.0.2: icmp_req=3 ttl=64 time=0.432 ms
64 bytes from 10.0.0.2: icmp_req=4 ttl=64 time=0.451 ms
64 bytes from 10.0.0.2: icmp_req=5 ttl=64 time=4.37 ms
............
64 bytes from 10.0.0.2: icmp_req=17 ttl=64 time=3.18 ms
64 bytes from 10.0.0.2: icmp_req=18 ttl=64 time=1.77 ms
64 bytes from 10.0.0.2: icmp_req=19 ttl=64 time=0.382 ms</code></pre></div></blockquote></div><p>Interseting.&nbsp; I get a consistent .1-.2ms response time from my server to router on the wired lan.&nbsp; Having said that my 5ghz wifi connection yoyo&#039;s between 10ms and 65ms.&nbsp; Are you doing this over wifi or wired?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p177874">
				<div class="post-metadata">
					<div class="post-num">Post #139</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						12 Sep 2012, 04:43					</div>
				</div>
				<div class="post-content content">
					<p>Wired.&nbsp; Latency over wireless is FAR more stable - but they are only a couple of feet apart right now:<br /></p><div class="codebox"><pre><code>64 bytes from 192.168.1.111: seq=0 ttl=128 time=1.458 ms
64 bytes from 192.168.1.111: seq=1 ttl=128 time=1.195 ms
64 bytes from 192.168.1.111: seq=2 ttl=128 time=1.273 ms
64 bytes from 192.168.1.111: seq=3 ttl=128 time=1.100 ms
64 bytes from 192.168.1.111: seq=4 ttl=128 time=1.551 ms
64 bytes from 192.168.1.111: seq=5 ttl=128 time=1.248 ms
64 bytes from 192.168.1.111: seq=6 ttl=128 time=1.237 ms
64 bytes from 192.168.1.111: seq=7 ttl=128 time=1.273 ms
64 bytes from 192.168.1.111: seq=8 ttl=128 time=1.185 ms
64 bytes from 192.168.1.111: seq=9 ttl=128 time=1.247 ms
64 bytes from 192.168.1.111: seq=10 ttl=128 time=1.257 ms
64 bytes from 192.168.1.111: seq=11 ttl=128 time=1.249 ms
64 bytes from 192.168.1.111: seq=12 ttl=128 time=1.207 ms
64 bytes from 192.168.1.111: seq=13 ttl=128 time=1.421 ms
64 bytes from 192.168.1.111: seq=14 ttl=128 time=1.105 ms
64 bytes from 192.168.1.111: seq=15 ttl=128 time=1.239 ms</code></pre></div><p>Then again the WiFi card in the router is IDENTICAL to the one in my laptop so should work perfectly together.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p177875">
				<div class="post-metadata">
					<div class="post-num">Post #140</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						12 Sep 2012, 04:53					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Alex Atkin UK wrote:</cite><blockquote><p>Wired.&nbsp; Latency over wireless is FAR more stable - but they are only a couple of feet apart right now:<br /></p><div class="codebox"><pre><code>64 bytes from 192.168.1.111: seq=0 ttl=128 time=1.458 ms
64 bytes from 192.168.1.111: seq=1 ttl=128 time=1.195 ms
64 bytes from 192.168.1.111: seq=2 ttl=128 time=1.273 ms
64 bytes from 192.168.1.111: seq=15 ttl=128 time=1.239 ms</code></pre></div><p>Then again the WiFi card in the router is IDENTICAL to the one in my laptop so should work perfectly together.</p></blockquote></div><p>Seems like you and I have inverted problems.&nbsp; Though I have a feeling my WiFi issues are due to being able to see &gt;32 access points from my couch at all times...</p><p>What is your plan going forward if I may ask?&nbsp; If there is something I can do with the build I&#039;m willing to run an updated one with the necessary tweaks and work with you to get it nailed down 100% for your intel card(s).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p177884">
				<div class="post-metadata">
					<div class="post-num">Post #141</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						12 Sep 2012, 08:06					</div>
				</div>
				<div class="post-content content">
					<p>Been looking at the <a href="http://downloadcenter.intel.com/Detail_Desc.aspx?agr=Y&amp;DwnldID=15817&amp;ProdId=3023&amp;lang=eng&amp;OSVersion=Linux*&amp;DownloadType=Drivers">latest drivers</a> on the Intel site.</p><p>First step is probably to try using those as-is.&nbsp; Failing that, the following may be relevant to my situation:<br /></p><div class="codebox"><pre><code>TROUBLESHOOTING: Some systems have trouble supporting MSI and/or MSI-X 
interrupts.  If you believe your system needs to disable this style of 
interrupt, the driver can be built and installed with the command:

     # make CFLAGS_EXTRA=-DDISABLE_PCI_MSI install</code></pre></div><p>It would probably be useful to include ethtool in the build too so I can try forcing 100-BASE-T and see if that forces the link to stay up.</p><p>Incidentally, is there some way I can clone your OpenWRT build environment so I can try fiddling with the configuration myself?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p177950">
				<div class="post-metadata">
					<div class="post-num">Post #142</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						12 Sep 2012, 17:02					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Alex Atkin UK wrote:</cite><blockquote><p># make CFLAGS_EXTRA=-DDISABLE_PCI_MSI install</p></blockquote></div><p>I&#039;ll poke through the kernel config, maybe there is an option for turning off PCI_MSI support, if so I&#039;ll run an updated build.</p><div class="quotebox"><cite>Alex Atkin UK wrote:</cite><blockquote><p>It would probably be useful to include ethtool in the build too so I can try forcing 100-BASE-T and see if that forces the link to stay up.</p></blockquote></div><p>I&#039;ll build a package file and add it to the list of packages to include.&nbsp; [s]I likely won&#039;t include it in the default install but it will be available as a package going forward.[/s]</p><p><strong>Edit:</strong> I just added ethtool as part of the base build. I&#039;ll post a link once the package is built.&nbsp; Once I have ethtool taken care of I&#039;ll be looking at the kernel&#039;s PCI_MSI support.</p><div class="quotebox"><cite>Alex Atkin UK wrote:</cite><blockquote><p>Incidentally, is there some way I can clone your OpenWRT build environment so I can try fiddling with the configuration myself?</p></blockquote></div><p>Yep, see the below process for re-creating my environment. </p><div class="codebox"><pre><code># Check out the wiki and install the build deps and setup a fresh checkout of the sources
#     NOTE: I switched to git for managing my OpenWRT source tree and I have written some helper scripts that make building MUCH easier.  You want to do a checkout using git (see the bottom of the trac page that has repo links).
# Go to https://bitbucket.org/mcrosson/nnopenwrt and clone the project into a directory that is not the OpenWRT sources
cp /path/to/nnopenwrt/feeds.conf /path/to/openwrt/src/  # Setup the feed (package manager) config to include my package files
cd /path/to/openwrt/src
editor feeds.conf
    # Update the location of the nusku feed to be /path/to/nnopenwrt/feed
./scripts/feeds update -a  # Ensure the packages are up to date
for package in `cat /path/to/nnopenwrt/openwrt_packages`; do ./script/feeds install -p nusku $package; done
    # Install various packages and ensure you get what you need.  You&#039;ll see errors fly by when running this.  Ignore them.
cd /path/to/nnopenwrt
./bin/build.sh /path/to/openwrt/src/ /path/to/output/dir
    # This is a wrapper script I wrote that will run through a full build including any pre-patching that is necessary.  I use this with Jenkins to run my builds.</code></pre></div>											<p class="post-edited">(Last edited by <strong>mcrosson</strong> on 12 Sep 2012, 17:11)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p177951">
				<div class="post-metadata">
					<div class="post-num">Post #143</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						12 Sep 2012, 17:07					</div>
				</div>
				<div class="post-content content">
					<p>I forgot to mention in my previous post: If you run &quot;make menuconfig&quot; and update the main OpenWRT config at all, you&#039;ll need to manually update the config file to disable the serial console.&nbsp; The config file is .config, if you do a search for &quot;ttyS0&quot;, you&#039;ll find the two lines in question.</p><p>Also, the bitbucket project page has the issue tracker setup for tracking items that we have discussed and other things I&#039;ve noticed while working on my builds.&nbsp; Feel free to add if you find anything.</p>											<p class="post-edited">(Last edited by <strong>mcrosson</strong> on 12 Sep 2012, 17:08)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p177955">
				<div class="post-metadata">
					<div class="post-num">Post #144</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						12 Sep 2012, 17:55					</div>
				</div>
				<div class="post-content content">
					<p>Ethtool packaging is done.&nbsp; Link: <a href="http://dl.dropbox.com/u/23765633/openwrt/ethtool_3.4.1-1_x86.ipk">http://dl.dropbox.com/u/23765633/openwr … -1_x86.ipk</a></p><p>You can pull the ipk right onto the router and install with: opkg install /path/to/ipk</p><p>Future builds will include ethtool as part of the base install.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p177957">
				<div class="post-metadata">
					<div class="post-num">Post #145</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						12 Sep 2012, 18:04					</div>
				</div>
				<div class="post-content content">
					<p>@Alex: I looked closer at your findings with MSI and MSI-X and both are enabled in my kernel.&nbsp; It looks like I should be able to build the kernel with that option disabled.</p><p>I am running an updated build and I&#039;ll publish for your testing as soon as it&#039;s complete.&nbsp; I made a couple small kernel tweaks including the disable of MSI and MSI-X.</p><br /><p>The bitbucket project site includes my changes from today, including the kernel changes.&nbsp; I normally commit every change I make and push as I go along so others can see what is going on more easily.</p>											<p class="post-edited">(Last edited by <strong>mcrosson</strong> on 12 Sep 2012, 18:06)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p177972">
				<div class="post-metadata">
					<div class="post-num">Post #146</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						12 Sep 2012, 21:15					</div>
				</div>
				<div class="post-content content">
					<p>@Alex: New build is online, this time without MSI interrupts.&nbsp; Given your driver instructions showed to compile without the MSI interrupts I think this should be equivalent.&nbsp; Let me know what the results are.</p><p><a href="https://nuskunetworks.box.com/s/qc7e6sx07xdkaj43gn1v">https://nuskunetworks.box.com/s/qc7e6sx07xdkaj43gn1v</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p177973">
				<div class="post-metadata">
					<div class="post-num">Post #147</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						12 Sep 2012, 21:27					</div>
				</div>
				<div class="post-content content">
					<p>It will be interesting to see if it causes any performance drop as I presume with classic interrupts it will use more CPU power.&nbsp; </p><p>I think its plausible the new interrupts weren&#039;t working right as I noticed routing speed capping at 70Mbit when testing to my local PPPoE server yet it wasn&#039;t maxing the CPU.&nbsp; Although the PPPoE server is also an Atom so it could have been maxing out that end, was going to test using my i5 as the server, will try the new build first.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p177974">
				<div class="post-metadata">
					<div class="post-num">Post #148</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						12 Sep 2012, 21:31					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Alex Atkin UK wrote:</cite><blockquote><p>It will be interesting to see if it causes any performance drop as I presume with classic interrupts it will use more CPU power.&nbsp; </p><p>I think its plausible the new interrupts weren&#039;t working right as I noticed routing speed capping at 70Mbit when testing to my local PPPoE server yet it wasn&#039;t maxing the CPU.&nbsp; Although the PPPoE server is also an Atom so it could have been maxing out that end, was going to test using my i5 as the server, will try the new build first.</p></blockquote></div><p>I am not sure what the real difference is between classic interrupts and the new style.&nbsp; I am also curious if it has any impact on my inability to use a gigE adapter in my PCI riser with the WiFi adapter.</p><p>I also have a full build uploading right now.&nbsp; If the test build works for you, pull the latest from <a href="https://nusku.net/openwrt">https://nusku.net/openwrt</a> It has the same kernel changes as the experimental build, it&#039;s just a release based off my release tree.&nbsp; I plan on migrating to a build without the MSI stuff once the upgrade in place tool is done.&nbsp; I&#039;ve started looking into the bits I&#039;ll need to write the program and hopefully I&#039;ll have it done within the next few weeks.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178005">
				<div class="post-metadata">
					<div class="post-num">Post #149</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						13 Sep 2012, 01:46					</div>
				</div>
				<div class="post-content content">
					<p>The test built certainly seems to have fixed the latency problem, although that power management hack I used seems to still make a very slightly improvement even on top of the interrupt fix.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178006">
				<div class="post-metadata">
					<div class="post-num">Post #150</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						13 Sep 2012, 01:50					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Alex Atkin UK wrote:</cite><blockquote><p>The test built certainly seems to have fixed the latency problem, although that power management hack I used seems to still make a very slightly improvement even on top of the interrupt fix.</p></blockquote></div><p>Does this mean you have a stable line on the Intel cards?</p>									</div>
			</article>

			
		
						<div class="notice">
				<p>Sorry, posts 151 to 150 are missing from our archive.</p>
			</div>
		
		
	
	<div class="pagination"><div class="pagination-number">Page 6 of 17</div><nav><ul><li><a href="viewtopic.php%3Fid=35887&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=35887&amp;p=4.html">4</a></li><li><a href="viewtopic.php%3Fid=35887&amp;p=5.html">5</a></li><li class="pagination-current"><span>6</span></li><li><a href="viewtopic.php%3Fid=35887&amp;p=7.html">7</a></li><li><a href="viewtopic.php%3Fid=35887&amp;p=8.html">8</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=35887&amp;p=17.html">17</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>