<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> AR7 port - how do I get ADSL working?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 22 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p85025">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Drone</div>
					<div class="post-datetime">
						2 Apr 2009, 16:29					</div>
				</div>
				<div class="post-content content">
					<p>I played a bit with Ti AR7 port on D-Link 504T device.</p><p>While basically it boots and works, I got the following issue: ADSL lamp blinks quickly and it appears there is at least attempts to establish DSL link? But I see no boot log or dmesg records anyhow related to ADSL nor I can see any interface related to ADSL, etc. How can I use DSL connection with AR7 port? Are there something special required to get it working? Any hints? Technically I need PPPoA, I do have proper VPI and VCI numbers and login and password but where to I have to supply all this? Are there some documentation describing this?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p85041">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">KillaB</div>
					<div class="post-datetime">
						2 Apr 2009, 20:18					</div>
				</div>
				<div class="post-content content">
					<p>Please see this thread.<br /><a href="http://forum.openwrt.org/viewtopic.php?id=17161">http://forum.openwrt.org/viewtopic.php?id=17161</a></p><p>Don&#039;t forget to install the sangam atm driver for your region (AnnexA for North America, etc.).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p90225">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Drone</div>
					<div class="post-datetime">
						22 Jun 2009, 17:10					</div>
				</div>
				<div class="post-content content">
					<p>Very useful, thanks!</p><p>I have to admit that requirement to install something usually implies there is network is up and running. How can I install something if network is not operable? That&#039;s just like old pkunzip.zip joke - you need to download something for networking device over network while usually it is AR7 device who provides access to network and network is down if device can&#039;t provide access to network! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />. So, all needed packages SHOULD pre-exist in constructed firmware image - BEFORE I&#039;m going to flash firmware.</p><p>As far as I know, in recent Kamikaze there is at least added ADSL Annex A firmware. I hope PPPoE and PPPoA also added - haven&#039;t tried myself recent Kamikaze yet since I had enough headache with recovery of AR7 device when it has turned out that I can&#039;t get network up and running with OpenWRT and device has been a &quot;gateway&quot; so I had no choice but to restore stock firmware to get network up and running.</p><p>Let&#039;s say is a bit PITA with their stupid ADAM2 boot loader (it had some compatibility issues so TFTP upload was aborted at the middle, etc). All this actually discourages testing Kamikaze on AR7 pretty much (I had 2 days of headache and internet downtime after attempt to test OpenWRT on my AR7 device).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p90232">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">ath</div>
					<div class="post-datetime">
						22 Jun 2009, 18:58					</div>
				</div>
				<div class="post-content content">
					<p>Once you get it running it works really well, at least on my DSL-524t, i haven&#039;t seen a crash in months.<br />Building from source is a good way to include the necessary drivers, if you have the time and disk space.</p><p>Anyway, keeping another working modem around is very useful when playing with an AR7 <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p90238">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">AraKs</div>
					<div class="post-datetime">
						22 Jun 2009, 20:05					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;d like to install openwrt on my Dlink DSL-524T, but i found that the information on the old wiki a little confusing.</p><p>Have you some tips on how to upload the firmware on the router?<br />Building the firmware is not a problem.</p><p>Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p90252">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Drone</div>
					<div class="post-datetime">
						22 Jun 2009, 22:59					</div>
				</div>
				<div class="post-content content">
					<p>&gt; Anyway, keeping another working modem around is very useful when playing with an AR7 wink<br />I&#039;m noticed this. And uhm, I should &quot;type&quot; these word in stone. Because when I had to fallback to original firmware (thanks to missing stuff), it has turned out ADAM2 had some compatibility issues with my OS (Ubuntu) on IP layer so TFTP upload rather looked like a Russian Roulette. Where I have to hit Zero sector, nothing more, nothing less. TFTP upload to ADAM2 usually stopped in the middle with high chances and only way to go was to &quot;win&quot; on this &quot;roulette&quot; (one try from 30 or so succeeded after all, uploading ALL data, he-he <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" />). Should I admit I hate this [bugged] ADAM2 stuff?</p>											<p class="post-edited">(Last edited by <strong>Drone</strong> on 22 Jun 2009, 23:01)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p90259">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">ath</div>
					<div class="post-datetime">
						23 Jun 2009, 01:35					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>AraKs wrote:</cite><blockquote><p>I&#039;d like to install openwrt on my Dlink DSL-524T, but i found that the information on the old wiki a little confusing.</p><p>Have you some tips on how to upload the firmware on the router?</p></blockquote></div><p>They are confusing, but the chances of bricking the router are pretty low (as long as you don&#039;t touch anything regarding the mtd2 partition with the bootloader)</p><p>1) find out the ADAM2 IP setting (mine was at 5.8.8.8 by default, you can login via telnet with the factory firmware and take a look in &quot;/proc/ticfg/env&quot; for &quot;my_ipaddress&quot;)<br />2) reboot and use FTP to connect to the ADAM2 FTP server<br />&nbsp; &nbsp; follow the instructions at <a href="http://oldwiki.openwrt.org/OpenWrtDocs(2f)Hardware(2f)D(2d)Link(2f)DSL(2d)524T.html">http://oldwiki.openwrt.org/OpenWrtDocs( â€¦ )524T.html</a> under &quot;Flashing the new firmware&quot;, &quot;so... edit adam2&quot;<br />&nbsp; &nbsp; don&#039;t worry about calculating the partition values by hand, the ones shown in that guide should be ok. Don&#039;t touch anything that has &quot;mtd2&quot; in the name, though.</p><p>It will take a while to reflash it, it might seem stuck just after the &quot;put&quot; command before the trasnfer starts, just keep waiting for a few minutes. Note that there are strange interations between the bootloader and recent Linux kernels, so if the flashing procedure takes a really long time just keep retrying or try with a different OS.</p><p>Buona fortuna <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><br /><br /><div class="quotebox"><cite>Drone wrote:</cite><blockquote><p>it has turned out ADAM2 had some compatibility issues with my OS (Ubuntu) on IP layer so TFTP upload rather looked like a Russian Roulette.<br />[...]<br />Should I admit I hate this [bugged] ADAM2 stuff?</p></blockquote></div><p>I&#039;ve found that running ftp as root increases the chances considerably... it looks like ADAM2 has some TCP retransmission issues, but running FTP as root allows it to change some socket options that shorten the timeouts (don&#039;t ask me how, though...)</p>											<p class="post-edited">(Last edited by <strong>ath</strong> on 23 Jun 2009, 01:36)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p91221">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">AraKs</div>
					<div class="post-datetime">
						11 Jul 2009, 18:00					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>ath wrote:</cite><blockquote><p>Buona fortuna <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p></blockquote></div><p>It&#039;s been tricky repartitoining the mtd with adam2 but i was very &quot;fortunato&quot;, and everything works now. I&#039;ve got trunk r16776 running on Dlink DSL-524T.<br />This modem always used to be hot, but when i opened it i found that both the cpu and the switch were the hottest chip i&#039;ve ever touched... Dlink, a couple of heatsink are too expensive?!</p><p>Anyway, the DSL line syncs but i&#039;ve no ppp0 interface or anything like that... what i&#039;m missing?</p><p>This is my ifconfig output:<br /></p><div class="codebox"><pre><code>root@DSL-524T:~# ifconfig
br-lan    Link encap:Ethernet  HWaddr 00:17:9A:B7:92:D6  
          inet addr:192.168.2.1  Bcast:192.168.2.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  MThis is etric:1
          RX packets:347 errors:0 dropped:0 overruns:0 frame:0
          TX packets:234 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:27793 (27.1 KiB)  TX bytes:23129 (22.5 KiB)

eth0      Link encap:Ethernet  HWaddr 00:17:9A:B7:92:D6  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:1041 errors:0 dropped:0 overruns:0 frame:0
          TX packets:698 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:80652 (78.7 KiB)  TX bytes:61456 (60.0 KiB)
          Interrupt:41 

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:74 errors:0 dropped:0 overruns:0 frame:0
          TX packets:74 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:4954 (4.8 KiB)  TX bytes:4954 (4.8 KiB)</code></pre></div><p>dmesg:<br /></p><div class="codebox"><pre><code>...
registered device TI Avalanche SAR
Sangam detected
requesting firmware image &quot;ar0700xx.bin&quot;
firmware: requesting ar0700xx.bin
avsar firmware released
tn7dsl_set_modulation : Setting mode to 0xffff
Creating new root folder avalanche in the proc for the driver stats 
Texas Instruments ATM driver: version:[7.03.01.00]
DSL in Sync
...</code></pre></div><div class="codebox"><pre><code>root@DSL-524T:~# cat /proc/net/dev
Inter-|   Receive                                                |  Transmit
 face |bytes    packets errs drop fifo frame compressed multicast|bytes    packets errs drop fifo colls carrier compressed
    lo:    8218     122    0    0    0     0          0         0     8218     122    0    0    0     0       0          0
  eth0:  208072    2510    0    0    0     0          0         0   289935    1972    0    0    0     0       0          0
  eth1:       0       0    0    0    0     0          0         0        0       0    0    0    0     0       0          0
br-lan:   37575     534    0    0    0     0          0        23    78673     437    0    0    0     0       0          0</code></pre></div><p>I tried to configure the wan interface with pppoa, but i don&#039;t know what to put under &quot;ifname&quot; option...<br />I hope it&#039;s some stupid thing i&#039;m missing... and what eth1 is???</p><p>ath, thanks for the tips...<br />Bye</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p91225">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">AraKs</div>
					<div class="post-datetime">
						11 Jul 2009, 19:03					</div>
				</div>
				<div class="post-content content">
					<p>I got it working with PPPoE and encapsulation LLC, using this config file:</p><div class="codebox"><pre><code>root@DSL-524T:~# cat /etc/config/network 

config &#039;interface&#039; &#039;loopback&#039;
    option &#039;ifname&#039; &#039;lo&#039;
    option &#039;proto&#039; &#039;static&#039;
    option &#039;ipaddr&#039; &#039;127.0.0.1&#039;
    option &#039;netmask&#039; &#039;255.0.0.0&#039;

config &#039;interface&#039; &#039;lan&#039;
    option &#039;type&#039; &#039;bridge&#039;
    option &#039;ifname&#039; &#039;eth0&#039;
    option &#039;proto&#039; &#039;static&#039;
    option &#039;netmask&#039; &#039;255.255.255.0&#039;
    option &#039;nat&#039; &#039;1&#039;
    option &#039;ipaddr&#039; &#039;192.168.2.1&#039;
    option &#039;macaddr&#039; &#039;&#039;
    option &#039;ip6addr&#039; &#039;&#039;
    option &#039;gateway&#039; &#039;&#039;
    option &#039;ip6gw&#039; &#039;&#039;
    option &#039;dns&#039; &#039;&#039;

config atm-bridge
    option unit     0
    option encaps   llc
    option vpi      8
    option vci      35
                                
config interface wan
    option ifname   nas0
    option proto    pppoe
    option username aliceadsl
    option password aliceadsl</code></pre></div><p>Should work for all the ADSL lines of Telecom Italia.</p><p>Mattia</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p91227">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">AraKs</div>
					<div class="post-datetime">
						11 Jul 2009, 19:27					</div>
				</div>
				<div class="post-content content">
					<p>To automatically start the internet connection at boot, modify the /etc/init.d/network script as it&#039;s done in the patch attached to this ticket:<br /><a href="https://dev.openwrt.org/ticket/2781">https://dev.openwrt.org/ticket/2781</a><br /><a href="https://dev.openwrt.org/attachment/ticket/2781/01-ifup-wan-on-boot.patch">https://dev.openwrt.org/attachment/tick â€¦ boot.patch</a></p><p>Now the router is fully functional <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p91282">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">ath</div>
					<div class="post-datetime">
						12 Jul 2009, 23:32					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>AraKs wrote:</cite><blockquote><p>This modem always used to be hot, but when i opened it i found that both the cpu and the switch were the hottest chip i&#039;ve ever touched... Dlink, a couple of heatsink are too expensive?!</p></blockquote></div><p>Pretty much every AR7-based D-Link modem runs hot, but there is probably some variance between different chips. My old 524t used to run at acceptable temperatures, but the new one I&#039;m using now runs way hotter. Same model, same revision.</p><div class="quotebox"><cite>AraKs wrote:</cite><blockquote><p>ath, thanks for the tips...<br />Bye</p></blockquote></div><p>You&#039;re welcome... nice to see another 524 running OpenWrt <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><div class="quotebox"><cite>AraKs wrote:</cite><blockquote><p>To automatically start the internet connection at boot, modify the /etc/init.d/network script as it&#039;s done in the patch attached to this ticket:<br /><a href="https://dev.openwrt.org/ticket/2781">https://dev.openwrt.org/ticket/2781</a><br /><a href="https://dev.openwrt.org/attachment/ticket/2781/01-ifup-wan-on-boot.patch">https://dev.openwrt.org/attachment/tick â€¦ boot.patch</a></p></blockquote></div><p>Nice one, hoping to see it included soon. I used a dirty hack instead <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p91283">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">AraKs</div>
					<div class="post-datetime">
						12 Jul 2009, 23:41					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>ath wrote:</cite><blockquote><p>Pretty much every AR7-based D-Link modem runs hot, but there is probably some variance between different chips. My old 524t used to run at acceptable temperatures, but the new one I&#039;m using now runs way hotter. Same model, same revision.</p></blockquote></div><p>I applied a small heatsink over the CPU... i hope it will help... you can find some pictures in my post:<br /><a href="http://www.aracne.name/linnotes/2009/07/openwrt-su-d-link-dsl-524t/">http://www.aracne.name/linnotes/2009/07 â€¦ -dsl-524t/</a></p>											<p class="post-edited">(Last edited by <strong>AraKs</strong> on 15 Mar 2010, 21:52)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>