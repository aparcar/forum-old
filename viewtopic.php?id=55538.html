<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> WLAN0-&gt;VPN and WLAN0-1-&gt;WAN is it possible?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 27 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p263942">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">drix</div>
					<div class="post-datetime">
						3 Feb 2015, 07:06					</div>
				</div>
				<div class="post-content content">
					<p>Good day everyone, I have a good news. Today Im totaly connect my wr703n to the VPN (PPTP). And seems that VPN works fine. But, I would like to use 1 wireless connection as VPN connection, and another 1 as standart connection thru the internet provider.<br />You can look closer and see what is in firewall zones<br /><a href="http://www.image-share.com/upload/2842/78.jpg">http://www.image-share.com/upload/2842/78.jpg</a></p><p>I think you can understand now, what I want.<br />What way I should go to resolve that problem? Should I use IP tables, or maybe there is another way to resolve that problem?<br />Regards, Andrew.</p>											<p class="post-edited">(Last edited by <strong>drix</strong> on 7 Feb 2015, 14:45)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p263944">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">kh_tsang</div>
					<div class="post-datetime">
						3 Feb 2015, 07:26					</div>
				</div>
				<div class="post-content content">
					<p><a href="http://wiki.openwrt.org/doc/networking/routing">http://wiki.openwrt.org/doc/networking/routing</a></p><p>Try to see this page.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p263945">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">drix</div>
					<div class="post-datetime">
						3 Feb 2015, 07:50					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>kh_tsang wrote:</cite><blockquote><p><a href="http://wiki.openwrt.org/doc/networking/routing">http://wiki.openwrt.org/doc/networking/routing</a></p><p>Try to see this page.</p></blockquote></div><p>Thanks for your answer. I have already read that article, it is good idea to do that way. But, I think there mus be another way, isn&#039;t it?<br />Ofcourse will try to use iproute2 <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />Regards, Andrew.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p263946">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">kh_tsang</div>
					<div class="post-datetime">
						3 Feb 2015, 07:53					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>drix wrote:</cite><blockquote><div class="quotebox"><cite>kh_tsang wrote:</cite><blockquote><p><a href="http://wiki.openwrt.org/doc/networking/routing">http://wiki.openwrt.org/doc/networking/routing</a></p><p>Try to see this page.</p></blockquote></div><p>Thanks for your answer. I have already read that article, it is good idea to do that way. But, I think there mus be another way, isn&#039;t it?<br />Ofcourse will try to use iproute2 <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />Regards, Andrew.</p></blockquote></div><p>Example configuration:<br />ip route add default from 192.168.10.0/24 dev vpn</p><p>But you have to do it every time the vpn reconnects.</p>											<p class="post-edited">(Last edited by <strong>kh_tsang</strong> on 3 Feb 2015, 07:53)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p263948">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">drix</div>
					<div class="post-datetime">
						3 Feb 2015, 08:09					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>kh_tsang wrote:</cite><blockquote><div class="quotebox"><cite>drix wrote:</cite><blockquote><div class="quotebox"><cite>kh_tsang wrote:</cite><blockquote><p><a href="http://wiki.openwrt.org/doc/networking/routing">http://wiki.openwrt.org/doc/networking/routing</a></p><p>Try to see this page.</p></blockquote></div><p>Thanks for your answer. I have already read that article, it is good idea to do that way. But, I think there mus be another way, isn&#039;t it?<br />Ofcourse will try to use iproute2 <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />Regards, Andrew.</p></blockquote></div><p>Example configuration:<br />ip route add default from 192.168.10.0/24 dev vpn</p><p>But you have to do it every time the vpn reconnects.</p></blockquote></div><p>I found article about shorewall, I see it first time, but they told that it is nice instrument to work with IP tables, is it true, can I use it for my task?<br />It is a pitty, but I don&#039;t see vpn in iproute2, I should add it manualy in config file?</p>											<p class="post-edited">(Last edited by <strong>drix</strong> on 3 Feb 2015, 08:27)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p263950">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">kh_tsang</div>
					<div class="post-datetime">
						3 Feb 2015, 08:20					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>drix wrote:</cite><blockquote><div class="quotebox"><cite>kh_tsang wrote:</cite><blockquote><div class="quotebox"><cite>drix wrote:</cite><blockquote><p>Thanks for your answer. I have already read that article, it is good idea to do that way. But, I think there mus be another way, isn&#039;t it?<br />Ofcourse will try to use iproute2 <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />Regards, Andrew.</p></blockquote></div><p>Example configuration:<br />ip route add default from 192.168.10.0/24 dev vpn</p><p>But you have to do it every time the vpn reconnects.</p></blockquote></div><p>I found article about shorewall, I see it first time, but they told that it is nice instrument to work with IP tables, is it true, can I use it for my task?</p></blockquote></div><p>Can you show the iptables command that you are using?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p263951">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">kh_tsang</div>
					<div class="post-datetime">
						3 Feb 2015, 08:24					</div>
				</div>
				<div class="post-content content">
					<p><a href="http://wiki.openwrt.org/doc/uci/multiwan">http://wiki.openwrt.org/doc/uci/multiwan</a></p><p>I don&#039;t know if using multiwan will work and use firewall forwarding rule to restrict access to a specific wan.</p>											<p class="post-edited">(Last edited by <strong>kh_tsang</strong> on 3 Feb 2015, 08:25)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p263952">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">kh_tsang</div>
					<div class="post-datetime">
						3 Feb 2015, 08:31					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>drix wrote:</cite><blockquote><div class="quotebox"><cite>kh_tsang wrote:</cite><blockquote><div class="quotebox"><cite>drix wrote:</cite><blockquote><p>Thanks for your answer. I have already read that article, it is good idea to do that way. But, I think there mus be another way, isn&#039;t it?<br />Ofcourse will try to use iproute2 <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />Regards, Andrew.</p></blockquote></div><p>Example configuration:<br />ip route add default from 192.168.10.0/24 dev vpn</p><p>But you have to do it every time the vpn reconnects.</p></blockquote></div><p>I found article about shorewall, I see it first time, but they told that it is nice instrument to work with IP tables, is it true, can I use it for my task?<br />It is a pitty, but I don&#039;t see vpn in iproute2, I should add it manualy in config file?</p></blockquote></div><p>The word &quot;vpn&quot; should be replaced with your vpn device. You may look it up by running ifconfig.<br />The 192.168.10.0/24 should be replaced with your target ip subnet/prefix.</p>											<p class="post-edited">(Last edited by <strong>kh_tsang</strong> on 3 Feb 2015, 08:32)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p263953">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">drix</div>
					<div class="post-datetime">
						3 Feb 2015, 08:32					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>kh_tsang wrote:</cite><blockquote><p><a href="http://wiki.openwrt.org/doc/uci/multiwan">http://wiki.openwrt.org/doc/uci/multiwan</a></p><p>I don&#039;t know if using multiwan will work and use firewall forwarding rule to restrict access to a specific wan.</p></blockquote></div><p>Is the PPTP vpn WAN too? I have problems with iproute2, don&#039;t understand, in article about iproute2 I see </p><p>#<br /># reserved values<br />#<br />255&nbsp; local<br />254&nbsp; main<br />253&nbsp; default<br />10&nbsp; &nbsp;vpn<br />0&nbsp; &nbsp; unspec<br />#<br /># local<br />#<br />#1&nbsp; &nbsp;inr.ruhelp</p><p>but in my default file, there is no vpn.</p><p>#<br /># reserved values<br />#<br />255&nbsp; &nbsp; local<br />254&nbsp; &nbsp; main<br />253&nbsp; &nbsp; default<br />0&nbsp; &nbsp; unspec<br />#<br /># local<br />#<br />#1&nbsp; &nbsp; inr.ruhep</p><p>If I add it manualy, will it work fine?</p>											<p class="post-edited">(Last edited by <strong>drix</strong> on 3 Feb 2015, 08:32)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p263954">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">drix</div>
					<div class="post-datetime">
						3 Feb 2015, 08:36					</div>
				</div>
				<div class="post-content content">
					<p>root@OpenWrt:~# ifconfig<br />eth0&nbsp; &nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 8C:21:**********<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:**********&nbsp; Bcast:**********&nbsp; Mask:255.255.255.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: ********************* Scope:Link<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:49278 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:28519 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:33525165 (31.9 MiB)&nbsp; TX bytes:3594237 (3.4 MiB)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Interrupt:4</p><p>lo&nbsp; &nbsp; &nbsp; &nbsp; Link encap:Local Loopback<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:127.0.0.1&nbsp; Mask:255.0.0.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: ::1/128 Scope:Host<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP LOOPBACK RUNNING&nbsp; MTU:65536&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:43 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:43 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:3852 (3.7 KiB)&nbsp; TX bytes:3852 (3.7 KiB)</p><p>pptp&nbsp; &nbsp;Link encap:Point-to-Point Protocol<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:*******&nbsp; P-t-P:******&nbsp; Mask:255.255.255.255<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP POINTOPOINT RUNNING NOARP MULTICAST&nbsp; MTU:1400&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:27122 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:17171 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:3<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:27234790 (25.9 MiB)&nbsp; TX bytes:1691098 (1.6 MiB)</p><p>wlan0&nbsp; &nbsp; &nbsp;Link encap:Ethernet&nbsp; HWaddr 8C:21:**********<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:18.17.0.1&nbsp; Bcast:18.17.0.255&nbsp; Mask:255.255.255.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: fd98:a7a2:8db3::1/60 Scope:Global<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: fe80::8e21:aff:feee:f450/64 Scope:Link<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:24625 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:35530 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:3255267 (3.1 MiB)&nbsp; TX bytes:31125729 (29.6 MiB)</p><p>wlan0-1&nbsp; &nbsp;Link encap:Ethernet&nbsp; HWaddr 8E:21:************<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:192.168.2.1&nbsp; Bcast:192.168.2.255&nbsp; Mask:255.255.255.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: fe80::8c21:aff:feee:f450/64 Scope:Link<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:2964 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:3013 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:396228 (386.9 KiB)&nbsp; TX bytes:457763 (447.0 KiB)</p><p>call it pptp?</p>											<p class="post-edited">(Last edited by <strong>drix</strong> on 3 Feb 2015, 08:43)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p263956">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">kh_tsang</div>
					<div class="post-datetime">
						3 Feb 2015, 08:39					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>drix wrote:</cite><blockquote><div class="quotebox"><cite>kh_tsang wrote:</cite><blockquote><p><a href="http://wiki.openwrt.org/doc/uci/multiwan">http://wiki.openwrt.org/doc/uci/multiwan</a></p><p>I don&#039;t know if using multiwan will work and use firewall forwarding rule to restrict access to a specific wan.</p></blockquote></div><p>Is the PPTP vpn WAN too? I have problems with iproute2, don&#039;t understand, in article about iproute2 I see </p><p>#<br /># reserved values<br />#<br />255&nbsp; local<br />254&nbsp; main<br />253&nbsp; default<br />10&nbsp; &nbsp;vpn<br />0&nbsp; &nbsp; unspec<br />#<br /># local<br />#<br />#1&nbsp; &nbsp;inr.ruhelp</p><p>but in my default file, there is no vpn.</p><p>#<br /># reserved values<br />#<br />255&nbsp; &nbsp; local<br />254&nbsp; &nbsp; main<br />253&nbsp; &nbsp; default<br />0&nbsp; &nbsp; unspec<br />#<br /># local<br />#<br />#1&nbsp; &nbsp; inr.ruhep</p><p>If I add it manualy, will it work fine?</p></blockquote></div><p>I think it would be better for you to add a new routing table with command line.</p><p>for example</p><p>ip rule add from 192.168.10.0/24 table 20<br />ip route add default dev pptp table 20</p><p>But I never tested it before so I may miss some commands.</p>											<p class="post-edited">(Last edited by <strong>kh_tsang</strong> on 3 Feb 2015, 08:44)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p263957">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">kh_tsang</div>
					<div class="post-datetime">
						3 Feb 2015, 08:54					</div>
				</div>
				<div class="post-content content">
					<p>Try this to see if it works.</p><p>ip rule add from 18.17.0.0/24 table 20<br />ip route add 18.17.0.0/24 dev wlan0-1 table 20<br />ip route add default dev pptp table 20</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p263959">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">drix</div>
					<div class="post-datetime">
						3 Feb 2015, 09:12					</div>
				</div>
				<div class="post-content content">
					<p>all broken, internet connection is online, but I can&#039;t connect to router via SSH or web. I think there is an error in second line, maybe there must be wlan0, Im reading articles about routing, I see there new sings for me, most of all, Im understaning now how they works, approximately. Can you describe, what means last number in line?<br />thanks a lot.</p>											<p class="post-edited">(Last edited by <strong>drix</strong> on 3 Feb 2015, 09:22)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p263962">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">kh_tsang</div>
					<div class="post-datetime">
						3 Feb 2015, 09:21					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>drix wrote:</cite><blockquote><p>all broken, internet connection is online, but I can&#039;t connect to router via SSH or web. I think there is an error in second line, Im reading articles about routing, I see there new sings for me, most of all, Im understaning now how they works, approximately. Can you describe, what means last number in line?<br />thanks a lot.</p></blockquote></div><p>I made a mistake, should be</p><p>ip rule add from 18.17.0.0/24 table 20<br />ip route add 18.17.0.0/24 dev wlan0 table 20<br />ip route add default dev pptp table 20</p><p>I assum you are using 18.17.0.0/24 to connect through the vpn.</p><p>The second line should be wlan0, not wlan0-1</p><p>If you are using 192.168.2.0/24 to access through the vpn, use the following commands instead.</p><p>ip rule add from 192.168.2.0/24 table 20<br />ip route add 192.168.2.0/24 dev wlan0-1 table 20<br />ip route add default dev pptp table 20</p><p>The 20 refers to the routing table.</p><p>Note that the table is not permanent, you need to enter it every reboot/reconnect/changing network configuration in web control panel/restart of the network module.</p>											<p class="post-edited">(Last edited by <strong>kh_tsang</strong> on 3 Feb 2015, 09:26)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p263963">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">drix</div>
					<div class="post-datetime">
						3 Feb 2015, 09:27					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>kh_tsang wrote:</cite><blockquote><div class="quotebox"><cite>drix wrote:</cite><blockquote><p>all broken, internet connection is online, but I can&#039;t connect to router via SSH or web. I think there is an error in second line, Im reading articles about routing, I see there new sings for me, most of all, Im understaning now how they works, approximately. Can you describe, what means last number in line?<br />thanks a lot.</p></blockquote></div><p>I made a mistake, should be</p><p>ip rule add from 18.17.0.0/24 table 20<br />ip route add 18.17.0.0/24 dev wlan0 table 20<br />ip route add default dev pptp table 20</p><p>I assum you are using 18.17.0.0/24 to connect through the vpn.</p><p>The second line should be wlan0, not wlan0-1</p><p>If you are using 192.168.2.0/24 to access through the vpn, use the following commands instead.</p><p>ip rule add from 192.168.2.0/24 table 20<br />ip route add 192.168.2.0/24 dev wlan0-1 table 20<br />ip route add default dev pptp table 20</p></blockquote></div><p>Access to vpn (pptp) works fine, and if it works, I think better do not touch it, but I cant connect to the internet via wlan0-1, when vpn (pptp) is up, I would like to use it (wlan0-1) with WAN interface (eth0) to coonect to the internet directly. that interface should work without vpn (pptp). Im trying to understand how to make it <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>											<p class="post-edited">(Last edited by <strong>drix</strong> on 3 Feb 2015, 09:28)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p263964">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">kh_tsang</div>
					<div class="post-datetime">
						3 Feb 2015, 09:33					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>drix wrote:</cite><blockquote><div class="quotebox"><cite>kh_tsang wrote:</cite><blockquote><div class="quotebox"><cite>drix wrote:</cite><blockquote><p>all broken, internet connection is online, but I can&#039;t connect to router via SSH or web. I think there is an error in second line, Im reading articles about routing, I see there new sings for me, most of all, Im understaning now how they works, approximately. Can you describe, what means last number in line?<br />thanks a lot.</p></blockquote></div><p>I made a mistake, should be</p><p>ip rule add from 18.17.0.0/24 table 20<br />ip route add 18.17.0.0/24 dev wlan0 table 20<br />ip route add default dev pptp table 20</p><p>I assum you are using 18.17.0.0/24 to connect through the vpn.</p><p>The second line should be wlan0, not wlan0-1</p><p>If you are using 192.168.2.0/24 to access through the vpn, use the following commands instead.</p><p>ip rule add from 192.168.2.0/24 table 20<br />ip route add 192.168.2.0/24 dev wlan0-1 table 20<br />ip route add default dev pptp table 20</p></blockquote></div><p>Access to vpn (pptp) works fine, and if it works, I think better do not touch it, but I cant connect to the internet via wlan0-1, when vpn (pptp) is up, I would like to use it (wlan0-1) with WAN interface (eth0) to coonect to the internet directly. that interface should work without vpn (pptp). Im trying to understand how to make it <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></blockquote></div><p>Do you have a fixed IP or fixed gateway address on the vpn?<br />If yes, you can try the following.</p><p>//flush the routing table first<br />ip route flush table 20<br />//Then add the following<br />ip rule add from 192.168.2.0/24 table 20<br />ip route add 192.168.2.0/24 dev wlan0-1 table 20<br />ip route add default via &lt;Gateway IP&gt; dev pptp table 20</p><p>Your Gateway IP is shown at P-t-P in the information of pptp.</p><p>pptp&nbsp; &nbsp;Link encap:Point-to-Point Protocol<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:*******&nbsp; P-t-P:******&nbsp; Mask:255.255.255.255<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP POINTOPOINT RUNNING NOARP MULTICAST&nbsp; MTU:1400&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:27122 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:17171 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:3<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:27234790 (25.9 MiB)&nbsp; TX bytes:1691098 (1.6 MiB)</p>											<p class="post-edited">(Last edited by <strong>kh_tsang</strong> on 3 Feb 2015, 09:36)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264450">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">drix</div>
					<div class="post-datetime">
						7 Feb 2015, 04:16					</div>
				</div>
				<div class="post-content content">
					<p>And if it is not static? %)</p><p>you told me to add this way <br />ip route add default via &lt;Gateway IP&gt; dev pptp table 20.</p><p>But I think the right way is <br />ip route add default via &lt;Gateway IP&gt; dev eth0 table 20</p><p>but it is still not working, I can ping all devices in my network, but still there is no internet connection on wlan0-1 <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>maybe something wrong with ACCEPT/REJECT in firewall options?</p>											<p class="post-edited">(Last edited by <strong>drix</strong> on 7 Feb 2015, 05:40)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>