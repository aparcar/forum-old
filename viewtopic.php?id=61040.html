<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Wireless connection between OpenWRT and RouterOS</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 14 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p300580">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">fsjunior</div>
					<div class="post-datetime">
						20 Nov 2015, 16:36					</div>
				</div>
				<div class="post-content content">
					<p>Hi guys,</p><p>I&#039;m trying to get a Gateworks Cambria (with OpenWRT) to connect with a Routerboard 133 via wireless. I configurated the RB 133&nbsp; (5.26 RouterOS) in ap bridge mode and the Cambria as client via Luci.</p><p>The Cambria connects to RB133. But a strange thing happens: If I configure the wireless to use the same bridge of the ethernet ports in cambria, there is a lot of error messages and it constantly disconnects.</p><div class="quotebox"><blockquote><p>00:01:13 wireless,info wlan1: data from unknown device XX:XX:XX:XX:XX:XX, sent deauth <br />00:01:13 wireless,info wlan1: data from unknown device XX:XX:XX:XX:XX:XX, sent deauth <br />00:01:13 wireless,info wlan1: data from unknown device XX:XX:XX:XX:XX:XX, sent deauth <br />00:01:13 wireless,info wlan1: data from unknown device XX:XX:XX:XX:XX:XX, sent deauth <br />00:01:13 wireless,info wlan1: data from unknown device YY:YY:YY:YY:YY:YY, sent deauth <br />00:01:13 wireless,info wlan1: data from unknown device YY:YY:YY:YY:YY:YY, sent deauth <br />00:01:13 wireless,info wlan1: data from unknown device YY:YY:YY:YY:YY:YY, sent deauth <br />00:01:13 wireless,info wlan1: data from unknown device YY:YY:YY:YY:YY:YY, sent deauth <br />00:01:14 wireless,info AA:BB:BB:BB:BB:BB@wlan1: reassociating <br />00:01:14 wireless,info AA:BB:BB:BB:BB:BB@wlan1: disconnected, ok <br />00:01:14 wireless,info AA:BB:BB:BB:BB:BB@wlan1: connected <br />00:01:14 wireless,info wlan1: data from unknown device ZZ:ZZ:ZZ:ZZ:ZZ:ZZ, sent deauth <br />00:01:14 wireless,info wlan1: data from unknown device ZZ:ZZ:ZZ:ZZ:ZZ:ZZ, sent deauth <br />00:01:14 wireless,info wlan1: data from unknown device ZZ:ZZ:ZZ:ZZ:ZZ:ZZ, sent deauth <br />00:01:14 wireless,info wlan1: data from unknown device ZZ:ZZ:ZZ:ZZ:ZZ:ZZ, sent deauth <br />00:01:14 wireless,info AA:BB:BB:BB:BB:BB@wlan1: reassociating <br />00:01:14 wireless,info AA:BB:BB:BB:BB:BB@wlan1: disconnected, ok <br />00:01:14 wireless,info AA:BB:BB:BB:BB:BB@wlan1: connected <br />00:01:14 wireless,info wlan1: data from unknown device XX:XX:XX:XX:XX:XX, sent deauth <br />00:01:14 wireless,info wlan1: data from unknown device XX:XX:XX:XX:XX:XX, sent deauth <br />00:01:14 wireless,info wlan1: data from unknown device XX:XX:XX:XX:XX:XX, sent deauth <br />00:01:14 wireless,info wlan1: data from unknown device WW:WW:WW:WW:WW:WW, sent deauth <br />00:01:14 wireless,info wlan1: data from unknown device WW:WW:WW:WW:WW:WW, sent deauth <br />00:01:14 wireless,info wlan1: data from unknown device WW:WW:WW:WW:WW:WW, sent deauth <br />00:01:14 wireless,info wlan1: data from unknown device WW:WW:WW:WW:WW:WW, sent deauth <br />00:01:14 wireless,info AA:BB:BB:BB:BB:BB@wlan1: reassociating <br />00:01:14 wireless,info AA:BB:BB:BB:BB:BB@wlan1: disconnected, ok <br />00:01:14 wireless,info AA:BB:BB:BB:BB:BB@wlan1: connected <br />00:01:14 wireless,info wlan1: data from unknown device XX:XX:XX:XX:XX:XX, sent deauth <br />00:01:14 wireless,info wlan1: data from unknown device XX:XX:XX:XX:XX:XX, sent deauth <br />00:01:14 wireless,info wlan1: data from unknown device XX:XX:XX:XX:XX:XX, sent deauth <br />00:01:14 wireless,info wlan1: data from unknown device XX:XX:XX:XX:XX:XX, sent deauth <br />00:01:14 wireless,info wlan1: data from unknown device XX:XX:XX:XX:XX:XX, sent deauth <br />00:01:14 wireless,info wlan1: data from unknown device XX:XX:XX:XX:XX:XX, sent deauth <br />00:01:14 wireless,info wlan1: data from unknown device XX:XX:XX:XX:XX:XX, sent deauth <br />00:01:14 wireless,info wlan1: data from unknown device XX:XX:XX:XX:XX:XX, sent deauth <br />00:01:15 wireless,info AA:BB:BB:BB:BB:BB@wlan1: reassociating <br />00:01:15 wireless,info AA:BB:BB:BB:BB:BB@wlan1: disconnected, ok <br />00:01:15 wireless,info AA:BB:BB:BB:BB:BB@wlan1: connected <br />00:01:15 wireless,info wlan1: data from unknown device XX:XX:XX:XX:XX:XX, sent deauth <br />00:01:15 wireless,info wlan1: data from unknown device XX:XX:XX:XX:XX:XX, sent deauth <br />00:01:15 wireless,info wlan1: data from unknown device XX:XX:XX:XX:XX:XX, sent deauth <br />00:01:15 wireless,info wlan1: data from unknown device XX:XX:XX:XX:XX:XX, sent deauth</p></blockquote></div><p>Note that there is different Mac addresses. I found that these mac are mac from ethernets in my network! I think that Cambria is trying to forward (via the bridge interface) the data from ethernet to wireless but for some reason the routeros is refusing to receive.</p><p>If I disconnect cambria from my ethernet network, the connection becomes &quot;stable&quot; (as there is no packet from other sources being transmitted).</p><p>Here the configuration of the routeros:</p><div class="codebox"><pre><code>[admin@MikroTik] &gt; interface wireless print detail
Flags: X - disabled, R - running 
 0  R name=&quot;wlan1&quot; mtu=1500 mac-address=00:30:1A:46:19:59 arp=enabled interface-type=Atheros AR5413 mode=bridge ssid=&quot;cambria&quot; frequency=2422 band=2ghz-b channel-width=20mhz scan-list=default wireless-protocol=any antenna-mode=ant-a wds-mode=disabled 
      wds-default-bridge=bridge1 wds-ignore-ssid=no bridge-mode=enabled default-authentication=yes default-forwarding=yes default-ap-tx-limit=0 default-client-tx-limit=0 hide-ssid=no security-profile=default compression=no 
[admin@MikroTik] </code></pre></div><p>From openwrt:<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# cat /etc/config/wireless 

config &#039;wifi-device&#039; &#039;radio1&#039;
    option &#039;type&#039; &#039;atheros&#039;
    option &#039;macaddr&#039; &#039;00:30:1a:46:12:2c&#039;
    option &#039;diversity&#039; &#039;0&#039;
    option &#039;txantenna&#039; &#039;1&#039;
    option &#039;rxantenna&#039; &#039;1&#039;
    option &#039;disabled&#039; &#039;0&#039;
    option &#039;chanbw&#039; &#039;10&#039;
    option &#039;channel&#039; &#039;3&#039;
    option &#039;txpower&#039; &#039;0&#039;

config &#039;wifi-iface&#039;
    option &#039;encryption&#039; &#039;none&#039;
    option &#039;device&#039; &#039;radio1&#039;
    option &#039;ssid&#039; &#039;cambria&#039;
    option &#039;mode&#039; &#039;sta&#039;
    option &#039;network&#039; &#039;lan&#039;

root@OpenWrt:~# </code></pre></div><p>My objective is to connect Cambria and RB 133 via wireless in a bridge mode, as a ethernet LAN, where every packet from ethernet from RB or&nbsp; will be retransmitted to cambria and vice versa. </p><p>So, I have some questions: </p><p>There is a know incompatibility with openwrt/cambria with routeros/routerboard?</p><p>Also, if not, someone have a hint of how can I configure both wireless? Maybe, there is a way to enable a &quot;promiscuous&quot; mode in routerboard? I don&#039;t understand very well the 802.11, but maybe a way to set the wireless from OpenWRT to use the mac address from card instead of ethernet devices?</p><p>Regards,</p><p>PS. I don&#039;t know if this is important, but I use DL915 card from doodlelabs.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p301987">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">fsjunior</div>
					<div class="post-datetime">
						1 Dec 2015, 19:38					</div>
				</div>
				<div class="post-content content">
					<p>I made some progress configuring both Cambria and RB.</p><p>I realized what I did wrong in the first place: I must create another interface to wireless connection. If I bridge ethernet and wireless, the data packets from ethernet will be forwarded &quot;as is&quot; to wireless, with wrong MAC Address.</p><p>So, nice! I made a connection between both and the connection becomes stable.</p><p>Also, I configurated an IP in wlan from RB 133 (running as AP) and set a static IP to wwan interface in Cambria. So, now I have another problem:</p><p>I can ping the IP in RouterOS/RB from cambria, but from RB I cannot find the cambria IP.</p><p>Let me explain with this incredible good looking diagram:</p><p>[X]---[AP]-(&nbsp; &nbsp; &nbsp;)-[STA]---[Y]</p><br /><p>AP is the RB 133 and STA is Cambria client. They&#039;re connected via wifi. I can make STA ping AP and X. If I configure relayd in cambria, I can make even Y ping AP and X.</p><p>See:</p><div class="codebox"><pre><code>root@OpenWrt:~# ping -I br-wwan 192.168.0.130
PING 192.168.0.130 (192.168.0.130): 56 data bytes
64 bytes from 192.168.0.130: seq=0 ttl=64 time=2.382 ms
64 bytes from 192.168.0.130: seq=1 ttl=64 time=1.654 ms
^C
--- 192.168.0.130 ping statistics ---
2 packets transmitted, 2 packets received, 0% packet loss
round-trip min/avg/max = 1.654/2.018/2.382 ms
root@OpenWrt:~# </code></pre></div><p>But I cannot make X or AP ping STA or Y:</p><p><span class="postimg"><img src="http://i.imgur.com/IEdNsyP.jpg" alt="http://i.imgur.com/IEdNsyP.jpg" /></span></p><br /><p>I looked everywhere but I cannot figure what is happening. </p><p>Someone can help me?</p>											<p class="post-edited">(Last edited by <strong>fsjunior</strong> on 1 Dec 2015, 19:39)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>