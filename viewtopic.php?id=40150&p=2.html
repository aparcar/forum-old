<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> WL-351 adding USB port(WIP) - OpenWRT on a Sitecom WL-351(WIP)</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 4 Mar 2018 and 8 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 2 of 2</div><nav><ul><li><a href="viewtopic.php%3Fid=40150&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p299117">
				<div class="post-metadata">
					<div class="post-num">Post #26</div>
					<div class="post-author">jackorobot</div>
					<div class="post-datetime">
						9 Nov 2015, 15:32					</div>
				</div>
				<div class="post-content content">
					<p>Does nobody have an asnwer?<br />I would really like to have it working again.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p299710">
				<div class="post-metadata">
					<div class="post-num">Post #27</div>
					<div class="post-author">reynard80</div>
					<div class="post-datetime">
						14 Nov 2015, 10:58					</div>
				</div>
				<div class="post-content content">
					<p>I managed to get OpenWRT working. But how can I flash the stock firmware back? (the Apps and Kernel dlf files?)</p>											<p class="post-edited">(Last edited by <strong>reynard80</strong> on 14 Nov 2015, 11:43)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p299723">
				<div class="post-metadata">
					<div class="post-num">Post #28</div>
					<div class="post-author">Timeless</div>
					<div class="post-datetime">
						14 Nov 2015, 14:19					</div>
				</div>
				<div class="post-content content">
					<p>Its been a long time since I&#039;ve worked on this unit. And since it does not have a accessible USB host interface I lost intrest in this device. Maybe I can find some time to compile a working image with the right network configuration later.</p><p>And about flashing the old firmware back then you need to take a look in the Engenius firmware. If you flash that one you can use their recovery path to flash the sitecom firmware again. You need to change some binary data in the firmware so that the Engenious firmware accepts a Sitecom image. There are some topics which you can find using google. See this <a href="http://www.dd-wrt.com/phpBB2/viewtopic.php?p=672912">link</a></p>											<p class="post-edited">(Last edited by <strong>Timeless</strong> on 14 Nov 2015, 14:23)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p299935">
				<div class="post-metadata">
					<div class="post-num">Post #29</div>
					<div class="post-author">reynard80</div>
					<div class="post-datetime">
						15 Nov 2015, 21:35					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Timeless wrote:</cite><blockquote><p>And about flashing the old firmware back then you need to take a look in the Engenius firmware. If you flash that one you can use their recovery path to flash the sitecom firmware again. You need to change some binary data in the firmware so that the Engenious firmware accepts a Sitecom image. There are some topics which you can find using google. See this <a href="http://www.dd-wrt.com/phpBB2/viewtopic.php?p=672912">link</a></p></blockquote></div><p>Thanks! I read about the Engenius firmware, but those are also two DLF&#039;s. How can I flash these? Do you perhaps have link as well?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p310846">
				<div class="post-metadata">
					<div class="post-num">Post #30</div>
					<div class="post-author">jan.saris</div>
					<div class="post-datetime">
						9 Feb 2016, 18:40					</div>
				</div>
				<div class="post-content content">
					<p>I have spended couple of hours on the 15.05 version but without succes.<br />I have installed a fresh 12.09 image. <br />Installed the 4 packets by hand and used the config of langerak post #9 and now it is working :-)</p><p>I don&#039;t know why 15.05 is not working. It looks like the communication between openwrt and the rtl8366rb is not working correctly. It can read statusses but sending information from openwrt to the device doesn&#039;t work.</p><p>I will use version 12.09 for now.</p><div class="quotebox"><cite>jackorobot wrote:</cite><blockquote><div class="quotebox"><cite>wuxeon wrote:</cite><blockquote><p>the same as you. the openwrt couldn&#039;t work on wl-351 except 12.09. <br />also 14.07,15.05 and trunk couldn&#039;t work .and i have installed and loaded the driver(4 ipk files:swconfig rtl8366rb and then) ,the wl351 could recogize the switch 1 as rtl8366rb,and it could work in the router .</p><p>when i get in wl 351 with ssh, it shows the right status when the cable pluged to the port. <br />i will post the img later.sorry,my english is poor.</p></blockquote></div><p>Thanks for the reply.<br />As far as I understood I tried all you said.<br />I used 15.05, 14.07 and 12.09.<br />With all of those the rt305x switch was found without needing to update the module.<br />But even after installing all modules concerning the rtl8366 it still did not find the device.<br />I can access wireless no problem, but the switching part is still not working.<br />The WAN connection is also not working.</p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p310852">
				<div class="post-metadata">
					<div class="post-num">Post #31</div>
					<div class="post-author">Timeless</div>
					<div class="post-datetime">
						9 Feb 2016, 19:02					</div>
				</div>
				<div class="post-content content">
					<p>I recently build 4 images. 12.09 with and without ipv6 (both with USB) and 15.05 with and without USB(because potential lack of space). All include the rtl8366 kernel module. I will post the results when I find the time.</p><p>I like to get 15.05 working because of the native ipv6 support. But time will tell.</p><p>Offtopic: great to see that there are still people interested in this device.</p>											<p class="post-edited">(Last edited by <strong>Timeless</strong> on 9 Feb 2016, 19:05)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p310921">
				<div class="post-metadata">
					<div class="post-num">Post #32</div>
					<div class="post-author">jan.saris</div>
					<div class="post-datetime">
						10 Feb 2016, 17:27					</div>
				</div>
				<div class="post-content content">
					<p>Nice @Timeless<br />I played around yesterday and got it working for now.<br />I still have one problem. I didn&#039;t succeed to move the WAN port. If I leave it at port 4 everything works. OpenWRT will obtain a valid IP-Adress from the DHCP server. <br />But if I move the port in the /etc/config/network to a different port and replug the cable to that new port it won&#039;t work.<br />I see in the OpenWRT uci that a cable is plugged in, but the DHCP request is never send.<br />When I use udhcpc at command line I see that it tries to send 3 requests and that it won&#039;t get a response (it hangs after 3 requests). The other end (my second router) doesn&#039;t log any DHCP request. If I move everything back to port 4 it works and udhcpc also gives results.....</p><p>Strange, behaviour... But at version 12.09 at least 1 port work as WAN port. In 15.05 I couldn&#039;t get any port to act as WAN port.</p><p>@Timeless: I&#039;m curious if you get the WAN port working in 15.05</p>											<p class="post-edited">(Last edited by <strong>jan.saris</strong> on 10 Feb 2016, 17:28)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p310922">
				<div class="post-metadata">
					<div class="post-num">Post #33</div>
					<div class="post-author">Timeless</div>
					<div class="post-datetime">
						10 Feb 2016, 17:36					</div>
				</div>
				<div class="post-content content">
					<p>Ah thats still strange. You&#039;re saying that you&#039;re unable to get the wan port working in 12.09? I remembered from my previous 12.09 experiment that all the ports were working.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p310965">
				<div class="post-metadata">
					<div class="post-num">Post #34</div>
					<div class="post-author">Timeless</div>
					<div class="post-datetime">
						10 Feb 2016, 23:55					</div>
				</div>
				<div class="post-content content">
					<p><strong>[UPDATE]</strong></p><p>Ok... I tried 15.05 today. and the results are both positive and negative. With the switch package installed by default I was able to get both the switches detected by default. Also when I change the network configuration and reboot the device I noticed that all the switch LEDs light up for a second during boot. This also happends during a /etc/init.d/network restart.</p><p>Last time I checked BB this LED blinking thing wasn&#039;t happening. So this is a good sign.<br />But after applying the possible &#039;right?&#039; VLAN configuration I&#039;m still unable to get an IP adress on any of the LAN or WAN ports. but I can see that the router tries to send packages on eth0.1 and eth0.2 according to IFCONFIG, but still receives non in return. But when I check swconfig it does receive packages when I enter the swconfig dev switch1 list command. but no packages are leaving the switch itself. I only see IfINOctets in this log.</p><p><strong>[INFO]</strong><br />I also noticed another topic: <a href="https://forum.openwrt.org/post.php?tid=59499&amp;qid=291625">link</a><br />Where I found this post:</p><div class="quotebox"><cite>moroboshi wrote:</cite><blockquote><p>Patch needed to get the WL-351 image to work again:</p><div class="codebox"><pre><code>[PATCH] Fix up switch settings for Sitecom WL-351 v1 002

Pinmux for rgmii needs to be set to rgmii, not gpio.
Hide the ESW switch on boot (using new rgmii esw devicetree attribute).
Also add a Sitecom-specific profile, since the image needs to include
the rtl8366 kernel driver.

Signed-off-by: Tobias Diedrich &lt;ranma+openwrt@tdiedrich.de&gt;
---
 target/linux/ramips/dts/WL-351.dts                     |  7 ++++++-
 .../files/drivers/net/ethernet/ralink/esw_rt3052.c     | 13 +++++++++++++
 target/linux/ramips/image/Makefile                     |  1 -
 target/linux/ramips/rt305x/profiles/sitecom.mk         | 18 ++++++++++++++++++
 4 files changed, 37 insertions(+), 2 deletions(-)
 create mode 100644 target/linux/ramips/rt305x/profiles/sitecom.mk

diff --git a/target/linux/ramips/dts/WL-351.dts b/target/linux/ramips/dts/WL-351.dts
index 81c963b..89c1ae5 100644
--- a/target/linux/ramips/dts/WL-351.dts
+++ b/target/linux/ramips/dts/WL-351.dts
@@ -9,9 +9,13 @@
     pinctrl {
         state_default: pinctrl0 {
             gpio {
-                ralink,group = &quot;spi&quot;, &quot;i2c&quot;, &quot;jtag&quot;, &quot;rgmii&quot;, &quot;mdio&quot;, &quot;uartf&quot;;
+                ralink,group = &quot;spi&quot;, &quot;i2c&quot;, &quot;jtag&quot;, &quot;mdio&quot;, &quot;uartf&quot;;
                 ralink,function = &quot;gpio&quot;;
             };
+            rgmii {
+                ralink,group = &quot;rgmii&quot;;
+                ralink,function = &quot;rgmii&quot;;
+            };
         };
     };
 
@@ -53,6 +57,7 @@
     };
 
     esw@10110000 {
+        ralink,rgmii = &lt;1&gt;;
         ralink,portmap = &lt;0x3f&gt;;
         ralink,fct2 = &lt;0x0002500c&gt;;
         /*
diff --git a/target/linux/ramips/files/drivers/net/ethernet/ralink/esw_rt3052.c b/target/linux/ramips/files/drivers/net/ethernet/ralink/esw_rt3052.c
index 55d5729..1f89838 100644
--- a/target/linux/ramips/files/drivers/net/ethernet/ralink/esw_rt3052.c
+++ b/target/linux/ramips/files/drivers/net/ethernet/ralink/esw_rt3052.c
@@ -1454,6 +1454,19 @@ static int esw_probe(struct platform_device *pdev)
 
     esw_hw_init(esw);
 
+    reg_init = of_get_property(np, &quot;ralink,rgmii&quot;, NULL);
+    if (reg_init &amp;&amp; be32_to_cpu(*reg_init) == 1) {
+        /*
+         * External switch connected to RGMII interface.
+         * Unregister the switch device after initialization.
+         */
+        err = -ENODEV;
+        dev_err(&amp;pdev-&gt;dev, &quot;RGMII mode, not exporting switch device.\n&quot;);
+        unregister_switch(&amp;esw-&gt;swdev);
+        platform_set_drvdata(pdev, NULL);
+        goto unmap_base;
+    }
+
     esw_w32(esw, RT305X_ESW_PORT_ST_CHG, RT305X_ESW_REG_ISR);
     esw_w32(esw, ~RT305X_ESW_PORT_ST_CHG, RT305X_ESW_REG_IMR);
     request_irq(esw-&gt;irq, esw_interrupt, 0, &quot;esw&quot;, esw);
diff --git a/target/linux/ramips/image/Makefile b/target/linux/ramips/image/Makefile
index 776920b..65fd9a4 100644
--- a/target/linux/ramips/image/Makefile
+++ b/target/linux/ramips/image/Makefile
@@ -764,7 +764,6 @@ define Image/Build/Profile/Default
     $(call Image/Build/Profile/WL_330N,$(1))
     $(call Image/Build/Profile/WL_330N3G,$(1))
     $(call Image/Build/Profile/WL341V3,$(1))
-    $(call Image/Build/Profile/WL-351,$(1))
     $(call Image/Build/Profile/WNCE2001,$(1))
     $(call Image/Build/Profile/WR512-3GN,$(1))
     $(call Image/Build/Profile/WR6202,$(1))
diff --git a/target/linux/ramips/rt305x/profiles/sitecom.mk b/target/linux/ramips/rt305x/profiles/sitecom.mk
new file mode 100644
index 0000000..16d9fef
--- /dev/null
+++ b/target/linux/ramips/rt305x/profiles/sitecom.mk
@@ -0,0 +1,18 @@
+#
+# Copyright (C) 2012 OpenWrt.org
+#
+# This is free software, licensed under the GNU General Public License v2.
+# See /LICENSE for more information.
+#
+
+define Profile/WL-351
+    NAME:=Sitecom WL-351 v1
+    PACKAGES:=\
+        kmod-switch-rtl8366rb kmod-swconfig swconfig
+endef
+
+define Profile/WL-351/Description
+    Package set for Sitecom WL-351 v1
+endef
+
+$(eval $(call Profile,WL-351))
-- 
2.1.4</code></pre></div></blockquote></div><p>This seems to indicate that there is something wrong with the switch communication after all. But I have no idea if this patch is already included in the current CC or TRUNK.</p><div class="quotebox"><cite>tormod wrote:</cite><blockquote><div class="quotebox"><cite>Timeless wrote:</cite><blockquote><p>About the patch mentioned above. Is that one already applied in the new CC release?</p></blockquote></div><p>AFAICS the patch has not been applied anywhere. It sits in the bug tracker <a href="https://dev.openwrt.org/ticket/17475">https://dev.openwrt.org/ticket/17475</a> but probably needs to be posted to the development list. I will ask the author.</p></blockquote></div><p>Reading this post does indication that it is not. But some time has past so there is a chance that it is not accurate anymore.<br />this is the bug report: <a href="https://dev.openwrt.org/ticket/17475">link</a> which indicates that it is working on the 15.05 tree.</p><p><strong>[FUTURE WORK]</strong><br />I will upload my binary of CC15.05 so anyone can give it a try. And also find a way to try the above mentioned patch and see if that makes a difference. </p><p>This is my current /etc/config/network configuration. Maybe there is something wrong because it still does not work?</p><div class="codebox"><pre><code>config interface &#039;loopback&#039;
        option ifname &#039;lo&#039;
        option proto &#039;static&#039;
        option ipaddr &#039;127.0.0.1&#039;
        option netmask &#039;255.0.0.0&#039;

config globals &#039;globals&#039;
        option ula_prefix &#039;[ADRES]&#039;

config interface &#039;lan&#039;
        option ifname &#039;eth0.1&#039;
        option force_link &#039;1&#039;
        option macaddr &#039;11:22:33:44:55:66&#039;
        option type &#039;bridge&#039;
        option proto &#039;static&#039;
        option ipaddr &#039;192.168.1.1&#039;
        option netmask &#039;255.255.255.0&#039;
        option ip6assign &#039;60&#039;

config interface &#039;wan&#039;
        option ifname &#039;eth0.2&#039;
        option force_link &#039;1&#039;
        option macaddr &#039;00:11:22:33:44:55&#039;
        option proto &#039;dhcp&#039;

config interface &#039;wan6&#039;
        option ifname &#039;eth0.2&#039;
        option proto &#039;dhcpv6&#039;

config switch
        option name &#039;switch1&#039;
        option reset &#039;1&#039;
        option enable_vlan &#039;1&#039;
        option mirror_source_port &#039;0&#039;
        option mirror_monitor_port &#039;0&#039;
        option enable_vlan4k &#039;1&#039;

config switch_vlan
        option device &#039;switch1&#039;
        option vlan &#039;1&#039;
        option ports &#039;0 1 2 3 5t&#039;

config switch_vlan
        option device &#039;switch1&#039;
        option vlan &#039;2&#039;
        option ports &#039;4 5t&#039;

config switch
        option name &#039;switch0&#039;
        option reset &#039;1&#039;
        option enable_vlan &#039;1&#039;

config switch_vlan
        option device &#039;switch0&#039;
        option vlan &#039;1&#039;
        option ports &#039;5t 6t&#039;

config switch_vlan
        option device &#039;switch0&#039;
        option vlan &#039;2&#039;
        option ports &#039;5t 6t&#039;</code></pre></div>											<p class="post-edited">(Last edited by <strong>Timeless</strong> on 11 Feb 2016, 22:24)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p311015">
				<div class="post-metadata">
					<div class="post-num">Post #35</div>
					<div class="post-author">jan.saris</div>
					<div class="post-datetime">
						11 Feb 2016, 10:52					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Timeless wrote:</cite><blockquote><p>Ah thats still strange. You&#039;re saying that you&#039;re unable to get the wan port working in 12.09? I remembered from my previous 12.09 experiment that all the ports were working.</p></blockquote></div><p>It works, but only the wan port works (the blue one). When I change the config to use a different port as wan port, (one of the yellow one&#039;s) than I don&#039;t get a ip (the same issue you have with CC)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p311016">
				<div class="post-metadata">
					<div class="post-num">Post #36</div>
					<div class="post-author">jan.saris</div>
					<div class="post-datetime">
						11 Feb 2016, 10:56					</div>
				</div>
				<div class="post-content content">
					<p>Nice work!<br />I&#039;m busy this weekend, but maybe next week I will give the Imagebuilder a try. (I&#039;m a total noob at this front, because I&#039;m a C# developer, but my college knows how to merge and build C code).</p>											<p class="post-edited">(Last edited by <strong>jan.saris</strong> on 1 Mar 2016, 11:41)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p311029">
				<div class="post-metadata">
					<div class="post-num">Post #37</div>
					<div class="post-author">tmo26</div>
					<div class="post-datetime">
						11 Feb 2016, 13:21					</div>
				</div>
				<div class="post-content content">
					<p>@jan.saris: Please do not quote the complete message you are replying to, but reduce the quoting to the minimum part required for understanding your reply.</p><p>Hint: You can also Edit your messages after sending.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p311078">
				<div class="post-metadata">
					<div class="post-num">Post #38</div>
					<div class="post-author">Timeless</div>
					<div class="post-datetime">
						11 Feb 2016, 22:21					</div>
				</div>
				<div class="post-content content">
					<p><strong>[CURRENT STATUS]</strong><br />Ok great news! after applying the mentioned patch (with some small changes to merge it with the newest source) I was able to get the WL-351 and switch working in 15.05. </p><p>This time the default networking configuration also works <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> which means that the binary works out of the box without the need of installing any additional packages or configuration.</p><p><strong>[FUTURE WORK]</strong></p><p>I&#039;m still trying to get the USB pinout on this device. And this is what I know so far:<br />According to <a href="https://dl.dropboxusercontent.com/u/13519734/WL-351/RT3050_5x_V2.0_081408_0902.pdf">this documentation</a> I found the following pinout definition<strong>(<em>Click on the picture for a better view on the pinout itself</em>)</strong>:<br /><a href="https://dl.dropboxusercontent.com/u/13519734/WL-351/RT3052F%20-%20PINOUT.PNG"><span class="postimg"><img src="https://dl.dropboxusercontent.com/u/13519734/WL-351/RT3052F%20-%20USB%20OTG.PNG" alt="https://dl.dropboxusercontent.com/u/13519734/WL-351/RT3052F%20-%20USB%20OTG.PNG" /></span></a></p><p>And I removed the heatsink from a WL-368 v1.001 which is basically a WL-351 with 2 antenna&#039;s(and 2.4ghz boostcircuits) instead of 3. which I had laying around for development <em>(it does run the WL-351 image without any problem)</em>. And without the heatsink I could get a better view on the RT3052F.</p><p><strong>Here are pictures of what I saw:</strong> (<em>Click on the pictures for a larger version</em>)<br /><a href="https://dl.dropboxusercontent.com/u/13519734/WL-351/WL-368_PCB_large.jpg"><span class="postimg"><img src="https://dl.dropboxusercontent.com/u/13519734/WL-351/WL-368_PCB_small.jpg" alt="https://dl.dropboxusercontent.com/u/13519734/WL-351/WL-368_PCB_small.jpg" /></span></a></p><p><strong>Close-ups:</strong> (<em>best I could with a magnifying glass:)</em> )<br /><a href="https://dl.dropboxusercontent.com/u/13519734/WL-351/WL-368_PCB_2_large.jpg"><span class="postimg"><img src="https://dl.dropboxusercontent.com/u/13519734/WL-351/WL-368_PCB_2_small.jpg" alt="https://dl.dropboxusercontent.com/u/13519734/WL-351/WL-368_PCB_2_small.jpg" /></span></a><br /><a href="https://dl.dropboxusercontent.com/u/13519734/WL-351/WL-368_PCB_3_large.jpg"><span class="postimg"><img src="https://dl.dropboxusercontent.com/u/13519734/WL-351/WL-368_PCB_3_small.jpg" alt="https://dl.dropboxusercontent.com/u/13519734/WL-351/WL-368_PCB_3_small.jpg" /></span></a></p><p>And now I have to find a way to see if the USB traces are actually connected and if the traces are accessible at the sides of the CPU itself. <strong>Does someone have an idea how to proceed?</strong></p><p><strong>[NOTES]</strong><br />here is a link of a polish topic of someone that was also working on a RT3052F and desoldered the chip: <a href="https://translate.google.com/translate?hl=nl&amp;sl=auto&amp;tl=en&amp;u=https%3A%2F%2Fopenlinksys.info%2Fforum%2Fviewthread.php%3Fforum_id%3D61%26thread_id%3D9758">link</a></p>											<p class="post-edited">(Last edited by <strong>Timeless</strong> on 14 Feb 2016, 16:25)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p313183">
				<div class="post-metadata">
					<div class="post-num">Post #39</div>
					<div class="post-author">jan.saris</div>
					<div class="post-datetime">
						1 Mar 2016, 11:46					</div>
				</div>
				<div class="post-content content">
					<p>@Timeless: So WAN - LAN works now on your 15.05 build? And the WAN gets an IP from the DHCP server?<br />Sorry, I was offline for a couple of weeks, because I became a dad and my focus went to something else ;-)</p><p>12.09 is running perfect for me at the moment. I only wanted to be able to get IPTV streams on my local network and OpenWRT 12.09 did the trick for me.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p318006">
				<div class="post-metadata">
					<div class="post-num">Post #40</div>
					<div class="post-author">FSmith</div>
					<div class="post-datetime">
						3 Apr 2016, 19:33					</div>
				</div>
				<div class="post-content content">
					<p>Timeless, could you upload the working 15.05 image? I have tried to patch the firmware myself a while ago, but could not find all needed files. I must admit I&#039;m not really used to Linux.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p318278">
				<div class="post-metadata">
					<div class="post-num">Post #41</div>
					<div class="post-author">Timeless</div>
					<div class="post-datetime">
						5 Apr 2016, 18:18					</div>
				</div>
				<div class="post-content content">
					<p>@jan.saris, ah no problem. Congratulations <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />.</p><p>@FSmith, yeah sure. I have my image build without PPPOE, PPP but with Collectd, Luci Statistics and nano. Is that ok for you or do you want the precompiled image builder so you can make your own?</p><p>@both, yes I recently build a 15.05.1 image and it still works perfectly. all the 5 switch ports are functioning</p>											<p class="post-edited">(Last edited by <strong>Timeless</strong> on 5 Apr 2016, 18:19)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p318285">
				<div class="post-metadata">
					<div class="post-num">Post #42</div>
					<div class="post-author">FSmith</div>
					<div class="post-datetime">
						5 Apr 2016, 18:55					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Timeless wrote:</cite><blockquote><p>@FSmith, yeah sure. I have my image build without PPPOE, PPP but with Collectd, Luci Statistics and nano. Is that ok for you or do you want the precompiled image builder so you can make your own?</p></blockquote></div><p>A complete build would be great <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p318298">
				<div class="post-metadata">
					<div class="post-num">Post #43</div>
					<div class="post-author">Timeless</div>
					<div class="post-datetime">
						5 Apr 2016, 20:06					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>FSmith wrote:</cite><blockquote><p>A complete build would be great <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></blockquote></div><p>Sorry but that does not aswer my question. What is your defenition of a complete build?</p>											<p class="post-edited">(Last edited by <strong>Timeless</strong> on 5 Apr 2016, 20:06)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p318300">
				<div class="post-metadata">
					<div class="post-num">Post #44</div>
					<div class="post-author">FSmith</div>
					<div class="post-datetime">
						5 Apr 2016, 20:18					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Timeless wrote:</cite><blockquote><div class="quotebox"><cite>FSmith wrote:</cite><blockquote><p>A complete build would be great <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></blockquote></div><p>Sorry but that does not aswer my question. What is your defenition of a complete build?</p></blockquote></div><p>Sorry, I meant the image ready to be flashed in the router.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p318304">
				<div class="post-metadata">
					<div class="post-num">Post #45</div>
					<div class="post-author">Timeless</div>
					<div class="post-datetime">
						5 Apr 2016, 20:33					</div>
				</div>
				<div class="post-content content">
					<p>Ah ok. But you don&#039;t need anything specific? Like PPP or PPPOE. My current images has +/-104KB free space. For normal use and settings this should be enough. But don&#039;t expect that you can install large packages.</p><p>If thats ok then I will upload my image</p>											<p class="post-edited">(Last edited by <strong>Timeless</strong> on 5 Apr 2016, 20:56)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p318329">
				<div class="post-metadata">
					<div class="post-num">Post #46</div>
					<div class="post-author">FSmith</div>
					<div class="post-datetime">
						5 Apr 2016, 23:15					</div>
				</div>
				<div class="post-content content">
					<p>It will do just fine, thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p318511">
				<div class="post-metadata">
					<div class="post-num">Post #47</div>
					<div class="post-author">Timeless</div>
					<div class="post-datetime">
						7 Apr 2016, 10:47					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>Ok, <a href="https://www.dropbox.com/s/a1dsulszrw8r10u/WL-351_with_collectd.zip?dl=0">here is a link</a> where you can download my build. Let me know how it works out for you <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>Ps. In the target.mk you will find which additional packages are included in this build.</p><p>Regards,</p>											<p class="post-edited">(Last edited by <strong>Timeless</strong> on 7 Apr 2016, 10:48)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p318603">
				<div class="post-metadata">
					<div class="post-num">Post #48</div>
					<div class="post-author">FSmith</div>
					<div class="post-datetime">
						7 Apr 2016, 23:37					</div>
				</div>
				<div class="post-content content">
					<p>Timeless, Thank you, now my switch is working again! Just enabled the wireless, and after a reboot I had a working&nbsp; internet connection trouch a patch cable. Awesome!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p318611">
				<div class="post-metadata">
					<div class="post-num">Post #49</div>
					<div class="post-author">Timeless</div>
					<div class="post-datetime">
						8 Apr 2016, 00:08					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>No problem. Great to know that it worked!</p><p>Regards</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324684">
				<div class="post-metadata">
					<div class="post-num">Post #50</div>
					<div class="post-author">Timeless</div>
					<div class="post-datetime">
						19 May 2016, 02:42					</div>
				</div>
				<div class="post-content content">
					<p>Ok since trunk switched the ralink drivers the earlier provided patch does not work anymore. I manually changed the following files:</p><div class="codebox"><pre><code>/target/linux/ramips/dts/WL-351.dts
/target/linux/ramips/image/Makefile [MOVED]--&gt; /target/linux/ramips/image/RT305x.mk
new file target/linux/ramips/rt305x/profiles/sitecom.mk</code></pre></div><p>And since the esw_rt3052.c files is not present anymore I changed the following file:<br /></p><div class="codebox"><pre><code>build_dir/target-mipsel_24kec+dsp_musl-1.1.14/linux-ramips_rt305x/linux-4.4.7/drivers/net/ethernet/mediatek/esw_rt3050.c</code></pre></div><p>which is only there after the pre-compile steps. </p><p>But after flashing the file to my WL-351 this is the resulting swconfig output:<br /></p><div class="codebox"><pre><code>root@OpenWrt:/# swconfig list
Found: switch0 - rtl8366rb</code></pre></div><p>Which is correct according the the patch and also my previous 15.05.1 build</p><p>The error are also on 15.05.1 after aplying the patch. But the patch fixes the networking issue on 15.05.1 but not on DD.<br /><em>But for some reason during boot I still receive:<br />[&nbsp; &nbsp; 4.153317] dwc2 101c0000.otg: Overcurrent change detected<br />[&nbsp; &nbsp; 4.330182] dwc2 101c0000.otg: Overcurrent change detected<br /><strong>Failed to connect to the switch. Use the &quot;list&quot; command to see which switches are available.<br />Failed to connect to the switch. Use the &quot;list&quot; command to see which switches are available.</strong></em><br /><em><strong>Failed to connect to</strong>[&nbsp; &nbsp; 4.977982] 8021q: adding VLAN 0 to HW filter on device eth0<br /> <strong>the switch. Use the &quot;list&quot; command to see which switches are available.</strong><br />[&nbsp; &nbsp; 5.019517] random: procd urandom read with 9 bits of entropy available</em></p><p><em>I made the errors bold and let the rest also visable because this is how it appears in the console. The Failed errors are not in syslog.</em></p><p><span class="bbu"><strong>So right now I&#039;m quite stuck. I can ping between clients on the switch(with the patch. cannot ping without patch) but I cannot reach the router or WAN.</strong></span></p>											<p class="post-edited">(Last edited by <strong>Timeless</strong> on 19 May 2016, 03:13)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 2 of 2</div><nav><ul><li><a href="viewtopic.php%3Fid=40150&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>