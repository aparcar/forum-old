<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Build for WNDR3700/WNDR3800</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 9 Jul 2013 and 6 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 14 of 63</div><nav><ul><li><a href="viewtopic.php%3Fid=28392&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=28392&amp;p=12.html">12</a></li><li><a href="viewtopic.php%3Fid=28392&amp;p=13.html">13</a></li><li class="pagination-current"><span>14</span></li><li><a href="viewtopic.php%3Fid=28392&amp;p=15.html">15</a></li><li><a href="viewtopic.php%3Fid=28392&amp;p=16.html">16</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=28392&amp;p=63.html">63</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p184869">
				<div class="post-metadata">
					<div class="post-num">Post #326</div>
					<div class="post-author">CyrusFF</div>
					<div class="post-datetime">
						1 Dec 2012, 12:02					</div>
				</div>
				<div class="post-content content">
					<div class="codebox"><pre><code>I again commented that manual LAN interafce ip6addr and rebooted. Results were interesting:
It works, but instead of having a random address, the router has now ::1 set automagically as the main address. Intentional? Additionally there is now the ULA address fd...</code></pre></div><p>Yes that is how its supposed to work. The lan automatically gets assigned the ::1 address (if you have a look in the log and grep for 6distributed you can see when and how the address distribution takes place). If you don&#039;t like the additional ula prefix just remove the &quot;option ula_prefix ...&quot; etc. than you won&#039;t get one. The ULA is mainly for local use, especially in cases when no public prefix is available and you don&#039;t want to or cannot use the link-local addresses for communication of local IPv6 devices.</p><p>Also just did a quick test with a 6in4 and it seemed to distrbute the static_prefix accordingly so I guess your problems were related to conflicting scripts or settings or so.</p><p>If you find anything else unusual please let me know. </p><br/><div class="codebox"><pre><code>I compiled a new firmware (with vanilla dnsmasq) and flashed it while preserving settings. After the reboot the router&#039;s LAN interface has now both the manually set ::1 and automatically set addresses:
br-lan    Link encap:Ethernet  HWaddr 76:44:xxx
          inet addr:192.168.1.1  Bcast:192.168.1.255  Mask:255.255.255.0
          inet6 addr: fe80::7444:1ff:fe8d:a3e7/64 Scope:Link
          inet6 addr: 2001:xxxxx:abcd:7444:1ff:fe8d:a3e7/64 Scope:Global
          inet6 addr: 2001:xxxxx:abcd::1/64 Scope:Global</code></pre></div><p>Ok what has happened here is this. You set the ::1 statically and the RD-server distribute it via RA-Messages. However the interface (br-lan) was also configured to accept RA-messages (/proc/sys/net/ipv6/conf/br-lan/accept_ra set to 2) so it basically assigned a random address based on its own RD-announcement and thus got two addresses. Normally the accept_ra shouldn&#039;t be 2 for br-lan, maybe also some confliucting scripts or a minor bug in the new logic.</p>											<p class="post-edited">(Last edited by <strong>CyrusFF</strong> on 1 Dec 2012, 12:05)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p184878">
				<div class="post-metadata">
					<div class="post-num">Post #327</div>
					<div class="post-author">Manani</div>
					<div class="post-datetime">
						1 Dec 2012, 14:42					</div>
				</div>
				<div class="post-content content">
					<p>Hello,<br/>This is a very interesting development, big thank you for that.<br/></p><div class="quotebox"><cite>CyrusFF wrote:</cite><blockquote><p>If you have a native IPv6 connection but the upstream router doesn&#039;t support prefix delegation wan and lan are automatically put in relay mode (when not otherwise configured) meaning RD-, DHCPv6 and NDP are proxied so that both interfaces operate in the same /64.</p></blockquote></div><p>I am in this case, with FREE TELECOM, French ISP that offers 6rd.</p><p>Here is my network6:<br/></p><div class="codebox"><pre><code>config interface &#039;wan&#039;
    option mode &#039;static&#039;
    option request_prefix &#039;auto&#039;
    option prefix_fallback &#039;relay&#039;
    option peerdns &#039;1&#039;
    list static_prefix &#039;2a01:e34:xxxx:xxxx::/64&#039;
    option ula_prefix &#039;fdd9:a5a0:f1f0::/48&#039;

config interface &#039;lan&#039;
    option mode &#039;downstream&#039;
    option advertise_prefix &#039;64&#039;
    option relay_master &#039;wan&#039;

config interface &#039;6in4&#039;
    option mode &#039;static&#039;
    list static_prefix &#039;2a01:e34:xxxx:xxx::/64</code></pre></div><p>Here is my 6relayd:<br/></p><div class="codebox"><pre><code>config relay
    option network    &#039;wan lan&#039;
    option rd    &#039;relay&#039;
    option dhcpv6    &#039;relay&#039;
    option ndp    &#039;relay&#039;</code></pre></div><p>I get perfectly IPv6 allocations on the LAN<br/></p><div class="codebox"><pre><code>Adresse IPv6: 2a01:e34:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx(préféré)
Adresse IPv6 temporaire: 2a01:e34:xxxx:xxxx:yyyy:yyyy:yyyy:yyyy(préféré)

Serveurs DNS: 2a01:e34:xxxx:xxxx::1
              192.168.1.1</code></pre></div><p>But IPv6 tests still fail (<a href="http://test-ipv6.com/">http://test-ipv6.com/</a>)</p><p>Do you find a mistake in my settings?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p184881">
				<div class="post-metadata">
					<div class="post-num">Post #328</div>
					<div class="post-author">CyrusFF</div>
					<div class="post-datetime">
						1 Dec 2012, 15:12					</div>
				</div>
				<div class="post-content content">
					<p>Let&#039;s continue here: <a href="https://forum.openwrt.org/viewtopic.php?pid=184880#p184880">https://forum.openwrt.org/viewtopic.php?pid=184880#p184880</a><br/>don&#039;t want to hijack this thread.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p184885">
				<div class="post-metadata">
					<div class="post-num">Post #329</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						1 Dec 2012, 15:37					</div>
				</div>
				<div class="post-content content">
					<p>I added my 6in4 tunnel configuration to the wiki article as an example.<br/><a href="http://wiki.openwrt.org/doc/uci/network6#configuration.examples">http://wiki.openwrt.org/doc/uci/network6#configuration.examples</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p184966">
				<div class="post-metadata">
					<div class="post-num">Post #330</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						2 Dec 2012, 13:56					</div>
				</div>
				<div class="post-content content">
					<p>I got a strange error with my newest 34435 build after a &quot;make clean&quot;: 6distributed complains at boot that &quot;Failed to connect to ubus&quot;. That seems to come from: <a href="https://github.com/sbyx/6distributed/blob/master/src/6distributed.c#L507">https://github.com/sbyx/6distributed/blob/master/src/6distributed.c#L507</a></p><p>The consequence is that there is no ipv6 connectivity for LAN. WAN pings from the router console pass the tunnel ok.</p><p>Strange, as there were no .config changes from 34432, which works ok. I tried with blank default settings etc., but no help. I reverted back to 34432 and I am currently doing a new build. </p><p>ipv6-support related items from system log with the erroneous 34435:<br/></p><div class="codebox"><pre><code>Dec  2 12:00:06 OpenWrt daemon.err 6distributed: Failed to connect to ubus
Dec  2 12:00:18 OpenWrt daemon.notice odhcp6c[1866]: Sending SOLICIT (timeout 4294967295s)</code></pre></div><p>Succesful operation with 34432:<br/></p><div class="codebox"><pre><code>Dec  1 14:00:10 OpenWrt daemon.notice 6distributed: Invoked newiface for lan with desired prefix length 64
Dec  1 14:00:17 OpenWrt daemon.notice odhcp6c[1800]: Sending SOLICIT (timeout 4294967295s)
Dec  1 14:00:21 OpenWrt daemon.notice 6distributed: newprefix for sixxs (2001:xxxxxxx:ABCD::/64)
Dec  1 14:00:21 OpenWrt daemon.notice 6distributed: assigning address 2001:xxxxxxx:abcd::1/64 for iface br-lan: Success</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p184967">
				<div class="post-metadata">
					<div class="post-num">Post #331</div>
					<div class="post-author">CyrusFF</div>
					<div class="post-datetime">
						2 Dec 2012, 14:10					</div>
				</div>
				<div class="post-content content">
					<p>Looks like a race-condition. Thanks for reporting. I will make an update to the IPv6-functionality early next week.<br/>Upcoming changes so far:<br/>* 6distributed will retry to connect when ubus is not yet up.<br/>* upstream-mode will be renamed to &quot;dhcpv6&quot; (the old name will still work)<br/>* downstream-mode will be renamed to &quot;router&quot; (the old name will still work)<br/>* a new mode &quot;relay&quot; will be added</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p184968">
				<div class="post-metadata">
					<div class="post-num">Post #332</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						2 Dec 2012, 14:21					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>CyrusFF wrote:</cite><blockquote><p>Looks like a race-condition. Thanks for reporting. I will make an update to the IPv6-functionality early next week.<br/>Upcoming changes so far:<br/>* 6distributed will retry to connect when ubus is not yet up.</p></blockquote></div><p>I see that you already made a patch: <br/><a href="https://github.com/sbyx/6distributed/commit/d779c1d5999191df32b97d36c5f3c483457e16fa">https://github.com/sbyx/6distributed/commit/d779c1d5999191df32b97d36c5f3c483457e16fa</a></p><p>If I understand correctly, it will now wait 100 seconds and try then again. 100 seconds sounds a bit long to me. I would expect some 10-20 seconds to be enough. Could it be a TCP/IP style &quot;doubling retry interval&quot;? First 10 seconds, then 20, 40, 80 and so on (until maybe some ceiling).</p><p>I am currently making a build with your patch included.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p184970">
				<div class="post-metadata">
					<div class="post-num">Post #333</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						2 Dec 2012, 14:29					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>hnyman wrote:</cite><blockquote><p>If I understand correctly, it will now wait 100 seconds and try then again.</p></blockquote></div><p>usleep() takes microseconds, so it actually waits 0.1 seconds between each retry.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p184972">
				<div class="post-metadata">
					<div class="post-num">Post #334</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						2 Dec 2012, 14:43					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jow wrote:</cite><blockquote><div class="quotebox"><cite>hnyman wrote:</cite><blockquote><p>If I understand correctly, it will now wait 100 seconds and try then again.</p></blockquote></div><p>usleep() takes microseconds, so it actually waits 0.1 seconds between each retry.</p></blockquote></div><p>My bad :-(</p><br/><p>EDIT: <br/>The build r34440 includes the fix above.<br/><a href="http://koti.welho.com/hnyman1/Openwrt/trunk-r34440-2012-12-02/">http://koti.welho.com/hnyman1/Openwrt/trunk-r34440-2012-12-02/</a></p>											<p class="post-edited">(Last edited by <strong>hnyman</strong> on 2 Dec 2012, 14:48)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p184997">
				<div class="post-metadata">
					<div class="post-num">Post #335</div>
					<div class="post-author">Manani</div>
					<div class="post-datetime">
						2 Dec 2012, 19:32					</div>
				</div>
				<div class="post-content content">
					<p>All goes well for me with the first build without RADVD (r34440).<br/>Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p185132">
				<div class="post-metadata">
					<div class="post-num">Post #336</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						3 Dec 2012, 22:02					</div>
				</div>
				<div class="post-content content">
					<p>- r34469: build with just the ipv6-support, radvd has been dropped</p><p>Today&#039;s changes for the ipv6-support package seem to work ok for me. I am able to switch from a Sixxs 6in4 tunnel to a Henet tunnel with Luci just by stopping one interface&nbsp; and connecting the other. The distributed prefix changes automatically and my PC got the new one quickly, just like it should ;-)</p><p>EDIT: <br/>For those, who have already tried configuring the new ipv6-support options, please note that the name of some of the options changed with r34466 <a href="https://dev.openwrt.org/changeset/34466">https://dev.openwrt.org/changeset/34466</a>. Also the documentation (wiki article &amp; model /etc/config/network6 in the package has been changed.</p><p>Although the old options work for now, it is quite possible that support for them will go away at some point, as the original version of the package never got adopted very widely. I have already changed my own config to follow the new format. </p><p>My current config is below. (In /etc/config/network the Sixxs tunnel 6in4 interface is set to start at boot, while the henet tunnel requires manual action, but both can be defined in the same network6 config file.)<br/></p><div class="codebox"><pre><code>root@OpenWrt:/etc/config# cat network6
config interface &#039;lan&#039;
        option mode &#039;router&#039;
        option advertise_prefix &#039;64&#039;

config interface &#039;sixxs&#039;
        option mode &#039;static&#039;
        list static_prefix &#039;2001:xxxx:xxxx::/48&#039;

config interface &#039;henet&#039;
        option mode &#039;static&#039;
        list static_prefix &#039;2001:xxxx:xxxx:xxxx::/64&#039;</code></pre></div>											<p class="post-edited">(Last edited by <strong>hnyman</strong> on 3 Dec 2012, 23:33)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p185343">
				<div class="post-metadata">
					<div class="post-num">Post #337</div>
					<div class="post-author">Manani</div>
					<div class="post-datetime">
						6 Dec 2012, 00:23					</div>
				</div>
				<div class="post-content content">
					<p>Hello Hnyman<br/>I stated my observations on the <a href="https://forum.openwrt.org/viewtopic.php?id=40853">6rd topic</a>.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p185418">
				<div class="post-metadata">
					<div class="post-num">Post #338</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						6 Dec 2012, 20:56					</div>
				</div>
				<div class="post-content content">
					<p>Like explained earlier (<a href="https://forum.openwrt.org/viewtopic.php?pid=142896#p142896">https://forum.openwrt.org/viewtopic.php?pid=142896#p142896</a>) I store the settings in an encrypted file embedded in the firmware, from which file I can then extract the few files with my settings. As I am building both the Attitude Adjustment with radvd and the trunk with ipv6-support, I looked for settings that would work in both firmwares and would support both of the ipv6 config styles. Additionally, I have both Sixxs and Henet 6in4 tunnels, of which sixxs is on by default while henet is disabled. </p><p>After some research I figured the following config which works both for ipv6-support and for radvd. Otherwise it was rather easy, but the final piece in the puzzle was that the new ipv6-support package sets the LAN interface &quot;accept_ra&quot; automatically, while with radvd that needs to be set manually if LAN interface pick the ipv6 address from radvd.</p><p>Note that henet interface has auto=0 to disable it and henet-related radvd has ignore=1. I can toggle the tunnels easily. With ipv6-support I just stop the sixxs tunnel interface and start henet tunnel. With radvd config I need to switch the radvd ignores and then stop/start the tunnel interfaces.</p><p>EDIT: Edited in Jan 2013 to reflect the elimination of network6 config file after r35174</p><p>/etc/config/network<br/></p><div class="codebox"><pre><code>config &#039;interface&#039; &#039;lan&#039;
        option &#039;ifname&#039; &#039;eth0.1&#039;
        option &#039;type&#039; &#039;bridge&#039;
        option &#039;proto&#039; &#039;static&#039;
        option &#039;ipaddr&#039; &#039;192.168.1.1&#039;
        option &#039;netmask&#039; &#039;255.255.255.0&#039;
        option accept_ra &#039;1&#039;
        option &#039;ip6assign&#039; &#039;64&#039;
...
config &#039;interface&#039; &#039;sixxs&#039;
        option &#039;proto&#039; &#039;6in4&#039;
        option &#039;mtu&#039; &#039;1424&#039;
        option &#039;ttl&#039; &#039;64&#039;
        option &#039;peeraddr&#039; &#039;62.78.96.38&#039;
        option &#039;ip6addr&#039; &#039;2001:db8:7777:8888::2/64&#039;
        option &#039;ip6prefix&#039; &#039;2001:db8:2222:baba::/64&#039;

config &#039;interface&#039; &#039;henet&#039;
        option &#039;proto&#039; &#039;6in4&#039;
        option &#039;mtu&#039; &#039;1424&#039;
        option &#039;ttl&#039; &#039;64&#039;
        option &#039;peeraddr&#039; &#039;216.66.80.90&#039;
        option &#039;ip6addr&#039; &#039;2001:db8:5555:6666::2/64&#039;
        option &#039;ip6prefix&#039; &#039;2001:db8:3333:4444::/64&#039;
        option &#039;tunnelid&#039; &#039;123456&#039;
        option &#039;username&#039; &#039;tb1234567890.12345678&#039;
        option &#039;password&#039; &#039;passwored&#039;
        option &#039;auto&#039; &#039;0&#039;</code></pre></div><p>/etc/config/radvd<br/></p><div class="codebox"><pre><code>config &#039;interface&#039;
        option &#039;interface&#039; &#039;lan&#039;
        option &#039;AdvSendAdvert&#039; &#039;1&#039;
        option &#039;AdvManagedFlag&#039; &#039;0&#039;
        option &#039;AdvOtherConfigFlag&#039; &#039;0&#039;
        list &#039;client&#039; &#039;&#039;
        option &#039;ignore&#039; &#039;0&#039;

config &#039;prefix&#039;
        option &#039;interface&#039; &#039;lan&#039;
        option &#039;AdvOnLink&#039; &#039;1&#039;
        option &#039;AdvAutonomous&#039; &#039;1&#039;
        option &#039;ignore&#039; &#039;0&#039;
        list prefix &#039;2001:db8:2222:baba::/64&#039;

config &#039;prefix&#039;
        option &#039;interface&#039; &#039;lan&#039;
        option &#039;AdvOnLink&#039; &#039;1&#039;
        option &#039;AdvAutonomous&#039; &#039;1&#039;
        option &#039;ignore&#039; &#039;1&#039;
        list prefix &#039;2001:db8:3333:4444::/64&#039;

config &#039;route&#039;
        option &#039;interface&#039; &#039;lan&#039;
        list &#039;prefix&#039; &#039;&#039;
        option &#039;ignore&#039; &#039;1&#039;

config &#039;rdnss&#039;
        option &#039;interface&#039; &#039;lan&#039;
        list &#039;addr&#039; &#039;&#039;
        option &#039;ignore&#039; &#039;1&#039;

config &#039;dnssl&#039;
        option &#039;interface&#039; &#039;lan&#039;
        list &#039;suffix&#039; &#039;&#039;
        option &#039;ignore&#039; &#039;1&#039;</code></pre></div><p>/etc/config/firewall<br/></p><div class="codebox"><pre><code>config &#039;zone&#039;
        option &#039;name&#039; &#039;wan&#039;
        option &#039;network&#039; &#039;wan sixxs henet&#039;
        option &#039;input&#039; &#039;REJECT&#039;
        option &#039;output&#039; &#039;ACCEPT&#039;
        option &#039;forward&#039; &#039;REJECT&#039;
        option &#039;masq&#039; &#039;1&#039;
        option &#039;mtu_fix&#039; &#039;1&#039;
...
config &#039;rule&#039;
        option &#039;target&#039; &#039;ACCEPT&#039;
        option &#039;_name&#039; &#039;SixXS IPv6&#039;
        option &#039;src&#039; &#039;wan&#039;
        option &#039;src_ip&#039; &#039;62.78.96.38&#039;
        option &#039;proto&#039; &#039;41&#039;

config &#039;rule&#039;
        option &#039;target&#039; &#039;ACCEPT&#039;
        option &#039;_name&#039; &#039;HEnet IPv6&#039;
        option &#039;src&#039; &#039;wan&#039;
        option &#039;src_ip&#039; &#039;216.66.80.90&#039;
        option &#039;proto&#039; &#039;41&#039;</code></pre></div><p>Additionally, my settings extract script now resets the wireless MAC after putting the /etc/config/wireless in place by reading the MAC from the art/caldata area in flash, which enables me to use the same files for all my three routers (3700, 3700v2 and 3800). The wireless MAC is the only router-specific thing in all the Openwrt settings I have...<br/></p><div class="codebox"><pre><code>#!/bin/sh
cp -f $1 /tmp/HNsettings.cpt
if [ &quot;$?&quot; -eq 0 ] ; then
  ccdecrypt -vf /tmp/HNsettings.cpt
  if [ &quot;$?&quot; -eq 0 ] ; then
    tar -xzv -f /tmp/HNsettings -C /etc
  fi
fi

# Almost the same settings can be used for all my three routers
# Use hardware id to set wireless MAC address and Ipv6 segment
local name
[ -f /tmp/sysinfo/model ] &amp;&amp; name=$(cat /tmp/sysinfo/model)
radio0=`dd if=/dev/mtdblock5 bs=1 skip=0 count=6 2&gt;/dev/null \
  | hexdump -v -e &#039;5/1 &quot;%02x:&quot; 1/1 &quot;%02x&quot; &#039;`
radio1=`dd if=/dev/mtdblock5 bs=1 skip=12 count=6 2&gt;/dev/null \
  | hexdump -v -e &#039;5/1 &quot;%02x:&quot; 1/1 &quot;%02x&quot; &#039;`
echo -e &quot;------\nSet wireless MACs for $name&quot;
echo -e &quot;2.4 Ghz radio: $radio0\n5   GHz radio: $radio1&quot;
uci set wireless.radio0.macaddr=$radio0
uci set wireless.radio1.macaddr=$radio1
uci commit wireless</code></pre></div>											<p class="post-edited">(Last edited by <strong>hnyman</strong> on 23 Jan 2013, 19:53)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p185424">
				<div class="post-metadata">
					<div class="post-num">Post #339</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						6 Dec 2012, 21:46					</div>
				</div>
				<div class="post-content content">
					<p>You don&#039;t even need to deal with the mac addresses, there is always the option to use &quot;option phy phy0&quot; for 2.4GHz and &quot;option phy phy1&quot; for 5GHz, instead of the &quot;option macaddr&quot; setting.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p185425">
				<div class="post-metadata">
					<div class="post-num">Post #340</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						6 Dec 2012, 22:04					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jow wrote:</cite><blockquote><p>You don&#039;t even need to deal with the mac addresses, there is always the option to use &quot;option phy phy0&quot; for 2.4GHz and &quot;option phy phy1&quot; for 5GHz, instead of the &quot;option macaddr&quot; setting.</p></blockquote></div><p>Thanks for info. I tested and you are right, it works. </p><p>If there is a wrong macaddr MAC in a wifi-device section, that radio will not work, and a new wifi-device section (radio2) might be created at boot. But with that &quot;option phy phy0&quot; it seems to work just fine. Looks like the MAC address is then not added to the /etc/config/wireless at all. Great!</p><p>And it is even documented in the wiki rather clearly since Nov2011: <a href="http://wiki.openwrt.org/doc/uci/wireless#wifi.devices">http://wiki.openwrt.org/doc/uci/wireless#wifi.devices</a>. Too bad that I haven&#039;t read that section closely enough after that addition :-(</p>											<p class="post-edited">(Last edited by <strong>hnyman</strong> on 6 Dec 2012, 22:15)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p185460">
				<div class="post-metadata">
					<div class="post-num">Post #341</div>
					<div class="post-author">CyrusFF</div>
					<div class="post-datetime">
						7 Dec 2012, 09:57					</div>
				</div>
				<div class="post-content content">
					<p>fyi <a href="https://dev.openwrt.org/changeset/34542">https://dev.openwrt.org/changeset/34542</a> and <a href="http://wiki.openwrt.org/doc/uci/network6">http://wiki.openwrt.org/doc/uci/network6</a> (examples)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p185461">
				<div class="post-metadata">
					<div class="post-num">Post #342</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						7 Dec 2012, 10:02					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>CyrusFF wrote:</cite><blockquote><p>fyi <a href="https://dev.openwrt.org/changeset/34542">https://dev.openwrt.org/changeset/34542</a> and <a href="http://wiki.openwrt.org/doc/uci/network6">http://wiki.openwrt.org/doc/uci/network6</a> (examples)</p></blockquote></div><p>Yep. I built that already yesterday. Works ok for me.</p>											<p class="post-edited">(Last edited by <strong>hnyman</strong> on 7 Dec 2012, 17:55)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p185629">
				<div class="post-metadata">
					<div class="post-num">Post #343</div>
					<div class="post-author">Manani</div>
					<div class="post-datetime">
						9 Dec 2012, 18:11					</div>
				</div>
				<div class="post-content content">
					<p>Can I replace openwrt.org with ipv6.google.com as the default test site?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p185630">
				<div class="post-metadata">
					<div class="post-num">Post #344</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						9 Dec 2012, 18:20					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Manani wrote:</cite><blockquote><p>Can I replace openwrt.org with ipv6.google.com as the default test site?</p></blockquote></div><p>You mean in the Network /diagnostics page? Sure.<br/>The page is in /usr/lib/lua/luci/view/admin_network/diagnostics.htm in a live Openwrt system.<br/>Edit it (lines 83, 94 etc.).</p><p>(source in <a href="http://luci.subsignal.org/trac/browser/luci/trunk/modules/admin-full/luasrc/view/admin_network/diagnostics.htm">http://luci.subsignal.org/trac/browser/ … ostics.htm</a> )</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p185633">
				<div class="post-metadata">
					<div class="post-num">Post #345</div>
					<div class="post-author">Manani</div>
					<div class="post-datetime">
						9 Dec 2012, 18:37					</div>
				</div>
				<div class="post-content content">
					<p>Works fine! Thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p185634">
				<div class="post-metadata">
					<div class="post-num">Post #346</div>
					<div class="post-author">raz123</div>
					<div class="post-datetime">
						9 Dec 2012, 18:39					</div>
				</div>
				<div class="post-content content">
					<p>hnyman,</p><p>Does your latest build use Codel for the QoS management?</p><p>If so, how does it fare with torrents?<br/>Any dropped packets/connections?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p185635">
				<div class="post-metadata">
					<div class="post-num">Post #347</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						9 Dec 2012, 18:43					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>raz123 wrote:</cite><blockquote><p>Does your latest build use Codel for the QoS management?<br/>If so, how does it fare with torrents??<br/>Any dropped packets/connections?</p></blockquote></div><p>Yes. Openwrt QoS module uses Codel by default at the moment.<br/>Very well.<br/>There are naturally some dropped packets. That is the idea...<br/></p><div class="codebox"><pre><code>tc -s -d qdisc show
...
qdisc fq_codel 400: dev eth1 parent 1:40 limit 10240p flows 1024 quantum 1514 target 5.0ms interval 100.0ms ecn
 Sent 2264898252 bytes 2294849 pkt (dropped 6884, overlimits 0 requeues 0)</code></pre></div>											<p class="post-edited">(Last edited by <strong>hnyman</strong> on 9 Dec 2012, 18:59)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p185642">
				<div class="post-metadata">
					<div class="post-num">Post #348</div>
					<div class="post-author">Manani</div>
					<div class="post-datetime">
						9 Dec 2012, 21:53					</div>
				</div>
				<div class="post-content content">
					<p>Hello Hnyman, we overcame the 6rd.<br/>I stated my observations on the <a href="https://forum.openwrt.org/viewtopic.php?pid=185641#p185641">6rd topic</a>.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p185644">
				<div class="post-metadata">
					<div class="post-num">Post #349</div>
					<div class="post-author">tt</div>
					<div class="post-datetime">
						9 Dec 2012, 22:04					</div>
				</div>
				<div class="post-content content">
					<p>Where exactly does the ula_prefix setting derive from in LuCI? After upgrading and configuring with a totally fresh setup, I see the network6 config switch from &quot;auto&quot; to a specific value. This is a slave router with no connection on the WAN port, but I am surprised to see LuCI make this change.</p><div class="codebox"><pre><code>===== network6 =====
--- /tmp/network6.default
+++ /tmp/network6.current
@@ -1,7 +1,7 @@
 package network6
 
 config global &#039;global&#039;
-       option ula_prefix &#039;auto&#039;
+       option ula_prefix &#039;fde0:3d5c:179::/48&#039;
 
 config interface &#039;wan&#039;
        option mode &#039;dhcpv6&#039;</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p185645">
				<div class="post-metadata">
					<div class="post-num">Post #350</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						9 Dec 2012, 22:10					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>tt wrote:</cite><blockquote><p>Where exactly does the ula_prefix setting derive from in LuCI? After upgrading and configuring with a totally fresh setup, I see the network6 config switch from &quot;auto&quot; to a specific value.</p></blockquote></div><p>ipv6-support script stores the randomly generated value after the first usage:<br/><a href="https://dev.openwrt.org/browser/trunk/package/network/ipv6/ipv6-support/files/support.sh#L361">https://dev.openwrt.org/browser/trunk/package/network/ipv6/ipv6-support/files/support.sh#L361</a></p>											<p class="post-edited">(Last edited by <strong>hnyman</strong> on 9 Dec 2012, 22:13)</p>
									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 14 of 63</div><nav><ul><li><a href="viewtopic.php%3Fid=28392&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=28392&amp;p=12.html">12</a></li><li><a href="viewtopic.php%3Fid=28392&amp;p=13.html">13</a></li><li class="pagination-current"><span>14</span></li><li><a href="viewtopic.php%3Fid=28392&amp;p=15.html">15</a></li><li><a href="viewtopic.php%3Fid=28392&amp;p=16.html">16</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=28392&amp;p=63.html">63</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0.001 -->

</body>
</html>