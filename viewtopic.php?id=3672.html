<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> connecting two openwrt routers</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 9 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p17170">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">nrg</div>
					<div class="post-datetime">
						14 Dec 2005, 01:29					</div>
				</div>
				<div class="post-content content">
					<p>Hello</p><p>I have two routers and I want to connect them in following way:<br />1. First router is set up in client mode and it&#039;s sharing the internet connection interfaces are separated and everything is working ok, there is dhcp enabled.<br />2. second one I want to connect to the first one by ethernet and use it as access point for my pocketpc. </p><p>Now my question: how to set up the second one to use dhcp from first router and not use it&#039;s own, I wan&#039;t it act for wired and wireless equipment just as simple switch which nvram variables I need to change from it&#039;s default and what else I need to do.</p><p>Sorry for my bad english and thanx in advance</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p17171">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Jannes</div>
					<div class="post-datetime">
						14 Dec 2005, 02:15					</div>
				</div>
				<div class="post-content content">
					<p>Disable the DHCP server on the second one (I think the best way to do that is in /etc/dnsmasq.conf , maybe remove dhcp-authoritative or something).</p><p>Put the LAN interface itself on dhcp ( nvram set lan_proto=dhcp ) or on a static IP within the subnet of the first box.</p><p>Connect both boxes on their LAN connections.</p><p>If I&#039;m not mistaken, that should do it.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p17175">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">nrg</div>
					<div class="post-datetime">
						14 Dec 2005, 08:16					</div>
				</div>
				<div class="post-content content">
					<p>Thank you for your answer Jannes, I don&#039;t need to make any changes to WAN interface and routing table?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p17176">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">dl</div>
					<div class="post-datetime">
						14 Dec 2005, 08:41					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nrg wrote:</cite><blockquote><p>I don&#039;t need to make any changes to WAN interface and routing table?</p></blockquote></div><p>Unless you broke the bridge, routing shouldn&#039;t be required. Is it not working? AFA the wan interface, either don&#039;t use it or move the port to the lan vlanXports.</p><p>- DL</p>											<p class="post-edited">(Last edited by <strong>dl</strong> on 14 Dec 2005, 08:58)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p17182">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">nrg</div>
					<div class="post-datetime">
						14 Dec 2005, 11:46					</div>
				</div>
				<div class="post-content content">
					<p>dl I&#039;ll try to do it when I back home and let you know if it works <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> Thank you.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p17227">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">nrg</div>
					<div class="post-datetime">
						14 Dec 2005, 23:05					</div>
				</div>
				<div class="post-content content">
					<p>Hello everything is workin as you said, thank you for your help <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> unfortunatelly I need to make change in my config because I didn&#039;t thought that after doing switch from router I won&#039;t be able to connect to it :-D so now I have to brake the bridge, turn on dhcp again and lern a lot about routing and networks...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p17228">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">dl</div>
					<div class="post-datetime">
						14 Dec 2005, 23:16					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nrg wrote:</cite><blockquote><p>Hello everything is workin as you said, thank you for your help <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> unfortunatelly I need to make change in my config because I didn&#039;t thought that after doing switch from router I won&#039;t be able to connect to it :-D so now I have to brake the bridge, turn on dhcp again and lern a lot about routing and networks...</p></blockquote></div><p>If all you need is management access, just change the lan_proto from dhcp to static and assign an ip in the same subnet but out of the range of the dhcp pool being handed out by the other router.</p><p>- DL</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p17229">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">mbm</div>
					<div class="post-datetime">
						14 Dec 2005, 23:22					</div>
				</div>
				<div class="post-content content">
					<p>Just a hint - due to the way linksys handles lna_proto, we&#039;ve forced lan_proto to be static ... to set&nbsp; lan_proto=dhcp you&#039;ll need to comment out the override in /etc/nvram.overrides</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p17231">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">nrg</div>
					<div class="post-datetime">
						15 Dec 2005, 01:38					</div>
				</div>
				<div class="post-content content">
					<p>DL thank you once more, now I have everything as I wanted <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>MBM thanks for hint, now it&#039;s set up as static anyway so I don&#039;t need to add comment in nvram.overrides</p><p>If you are so good in resolving problems I have just one more... And it&#039;s connected with my first router working in client mode. I needed to write starting script to automaticly connect to access point because sometimes it wasn&#039;t connecting. Script is very simple and it gives command &#039;wl join ssid&#039; when there is no ping from access point. I was serching for the problem for over a month trying many options but unfortunatelly I&#039;m still with this problem. Could you guide me what can it be or where I have to check cause I&#039;m allmost giving up. Could it be a B mode network problem? Access point which I&#039;m connected to is using B mode.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p17232">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">dl</div>
					<div class="post-datetime">
						15 Dec 2005, 02:28					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nrg wrote:</cite><blockquote><p>If you are so good in resolving problems I have just one more...</p></blockquote></div><p>... actually Jannes supplied everything you needed <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><div class="quotebox"><blockquote><p>And it&#039;s connected with my first router working in client mode. I needed to write starting script to automaticly connect to access point because sometimes it wasn&#039;t connecting. Script is very simple and it gives command &#039;wl join ssid&#039;</p></blockquote></div><p>B mode should not be an issue. My clients automatically associate without need of startup script. Check the following:<br />- AP must be open, broadcasting SSID<br />- wl0_ssid must be set on client</p><p>My clients didn&#039;t automatically associate at first either - I had to change some settings to get it to work. I don&#039;t remember exactly what I did or even whether it was on the AP or client, but it -may- have been when I set up wifi_ interface on the client.</p><p>- DL</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p17237">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">nrg</div>
					<div class="post-datetime">
						15 Dec 2005, 09:38					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dl wrote:</cite><blockquote><p>- AP must be open, broadcasting SSID<br />- wl0_ssid must be set on client</p></blockquote></div><p>those conditions are fulfilled</p><div class="quotebox"><cite>dl wrote:</cite><blockquote><p>My clients didn&#039;t automatically associate at first either - I had to change some settings to get it to work. I don&#039;t remember exactly what I did or even whether it was on the AP or client, but it -may- have been when I set up wifi_ interface on the client.</p><p>- DL</p></blockquote></div><p>I set everything as it&#039;s written in docs but there is solution with changing WAN interface to eth1 so probably it causing all problems according to mine impression and your assupmtion that it changed after setting up wifi_ interface. I&#039;ll try to do the same but here again my lack of knowlage in routing and linux generally is a little problem :)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p17244">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">dl</div>
					<div class="post-datetime">
						15 Dec 2005, 10:53					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nrg wrote:</cite><blockquote><p>I&#039;ll try to do the same but here again my lack of knowlage in routing and linux generally is a little problem <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></blockquote></div><p>Setting up wifi_ via nvram vars shouldn&#039;t require any changes in routing assuming you set wifi_ifname to eth1. But setting this up seems to invoke some wl stuff that doesn&#039;t happen otherwise - or perhaps it&#039;s a timeing/sequence issue.</p><p>- DL</p>											<p class="post-edited">(Last edited by <strong>dl</strong> on 15 Dec 2005, 10:53)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>