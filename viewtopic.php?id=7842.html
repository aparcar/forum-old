<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> kernel panic when loading bcm43xx driver</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 12 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p35945">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">mangoo</div>
					<div class="post-datetime">
						24 Oct 2006, 00:06					</div>
				</div>
				<div class="post-content content">
					<p>When I load the bcm43xx module on ASUS WL-500g deluxe, the kernel panics (kamikaze as of 2006-10-18):</p><p>bcm43xx driver<br />bcm43xx: Chip ID 0x5365, rev 0x1<br />bcm43xx: Number of cores: 0<br />bcm43xx: Core 0: ID 0x800, rev 0x5, vendor 0x4243, enabled<br />bcm43xx: Error: No 80211 core found!<br />PCI: Fixing up device 0000:01:03.0<br />Data bus error, epc == c00e99f0, ra == c00e99d8<br />Oops[#1]:<br />Cpu 0<br />$ 0&nbsp; &nbsp;: 00000000 1000dc00 00000000 c00a4000<br />$ 4&nbsp; &nbsp;: c00a4000 00000004 0c080083 00080080<br />$ 8&nbsp; &nbsp;: 00000007 00000080 00000004 802c0000<br />$12&nbsp; &nbsp;: 802c0000 00000001 7fb04934 203a726f<br />$16&nbsp; &nbsp;: 00000000 00000000 00002000 81ac8c28<br />$20&nbsp; &nbsp;: 81ac8000 00000000 c00a1000 80280000<br />$24&nbsp; &nbsp;: 00000000 801b3dec<br />$28&nbsp; &nbsp;: 813cc000 813cdd10 810b1400 c00e99d8<br />Hi&nbsp; &nbsp; : 000180ff<br />Lo&nbsp; &nbsp; : f74e3800<br />epc&nbsp; &nbsp;: c00e99f0&nbsp; &nbsp; &nbsp;Not tainted<br />ra&nbsp; &nbsp; : c00e99d8 Status: 1000dc03&nbsp; &nbsp; KERNEL EXL IE<br />Cause : 0000841c<br />PrId&nbsp; : 00029007<br />Modules linked in: bcm43xx ipt_ULOG ipt_recent tun ohci_hcd uhci_hcd ieee80211softmac ieee80211 ieee80211_crypt<br />Process modprobe (pid: 1287, threadinfo=813cc000, task=803cac00)<br />Stack : 7fb04934 203a726f 00000400 810b1400 81ac8c28 810b1448 c0100010 00000000<br />&nbsp; &nbsp; &nbsp; &nbsp; c00a1000 80280000 81ac8d56 81ac8d5c 810b1448 c00ebb50 81ac8000 00000000<br />&nbsp; &nbsp; &nbsp; &nbsp; 81ac8c28 810b1448 c010bc68 00000000 c00a1000 80280000 000003bc c00ebd0c<br />&nbsp; &nbsp; &nbsp; &nbsp; 00000000 81854000 7fb04920 00000001 8011de58 203a726f 810b1400 c010b810<br />&nbsp; &nbsp; &nbsp; &nbsp; ffffffed c010b83c 8011df3c 8011df00 8011de28 80280000 00000000 801b3dec<br />&nbsp; &nbsp; &nbsp; &nbsp; ...<br />Call Trace: [&lt;c0100010&gt;]&nbsp; [&lt;c00ebb50&gt;]&nbsp; [&lt;c00ebd0c&gt;]&nbsp; [&lt;8011de58&gt;]&nbsp; [&lt;8011df3c&gt;]&nbsp; [&lt;8011df00&gt;]&nbsp; [&lt;8011de28&gt;]&nbsp; [&lt;801b3dec&gt;]&nbsp; [&lt;801389ec&gt;]</p><p>Code: 8e630014&nbsp; 8e620120&nbsp; 00622021 &lt;8c820ffc&gt; 3043fff0&nbsp; 0002bc02&nbsp; 3055000f&nbsp; 0003a102&nbsp; 24020800<br />Data bus error, epc == 80189984, ra == 801765dc<br />Oops[#2]:<br />Cpu 0<br />$ 0&nbsp; &nbsp;: 00000000 1000d801 ffffffff c0050010<br />$ 4&nbsp; &nbsp;: 8113ea00 813cdb60 813cdb60 00000040<br />$ 8&nbsp; &nbsp;: 2634e240 386d4a80 2634e240 00000700<br />$12&nbsp; &nbsp;: 802c0000 802bfaa0 802bfa90 80279a20<br />$16&nbsp; &nbsp;: 8113ea00 00000000 8113ead0 00000002<br />$20&nbsp; &nbsp;: 813cdb60 00000000 813cdb60 80280000<br />$24&nbsp; &nbsp;: 00000001 00000007<br />$28&nbsp; &nbsp;: 813cc000 813cd9f0 810b1400 801765dc<br />Hi&nbsp; &nbsp; : 00000007<br />Lo&nbsp; &nbsp; : 00000004<br />epc&nbsp; &nbsp;: 80189984&nbsp; &nbsp; &nbsp;Not tainted<br />ra&nbsp; &nbsp; : 801765dc Status: 1000d803&nbsp; &nbsp; KERNEL EXL IE<br />Cause : 0000041c<br />PrId&nbsp; : 00029007<br />Modules linked in: bcm43xx ipt_ULOG ipt_recent tun ohci_hcd uhci_hcd ieee80211softmac ieee80211 ieee80211_crypt<br />Process modprobe (pid: 1287, threadinfo=813cc000, task=803cac00)<br />Stack : 813cdba0 81e0f2e0 8189f6f0 802d0000 00000001 00000000 00000001 00000000<br />&nbsp; &nbsp; &nbsp; &nbsp; 8113ead0 00000002 813cda18 813cda18 00000000 802c0000 00000020 00000000<br />&nbsp; &nbsp; &nbsp; &nbsp; 00000020 802c0000 802c0000 802c0000 81f4de00 04000000 00000001 00000002<br />&nbsp; &nbsp; &nbsp; &nbsp; 813cdb08 00000000 802bf7dc 00000002 38343163 31303030 813cda68 813cda68<br />&nbsp; &nbsp; &nbsp; &nbsp; 00000000 802c0000 c1c912b6 00000000 00000000 802c0000 802c0000 802c0000<br />&nbsp; &nbsp; &nbsp; &nbsp; ...<br />Call Trace: [&lt;801765dc&gt;]&nbsp; [&lt;8004d56c&gt;]&nbsp; [&lt;800333ec&gt;]&nbsp; [&lt;8004d684&gt;]&nbsp; [&lt;800334d0&gt;]&nbsp; [&lt;8000aa6c&gt;]&nbsp; [&lt;8000aa74&gt;]&nbsp; [&lt;8002d868&gt;]&nbsp; [&lt;80001ea4&gt;]</p><p>Code: 8e430004&nbsp; 2402ffff&nbsp; 00a0b021 &lt;8c700004&gt; 1602000c&nbsp; 32100037&nbsp; 8c820000&nbsp; 8c4500dc&nbsp; 10a00003<br />Kernel panic - not syncing: Aiee, killing interrupt handler!</p><br /><p>It loads fine during the boot though, the panic is when I remove the driver and insert it again:</p><p>ieee80211: 802.11 data/management/control stack, git-1.1.7<br />ieee80211: Copyright (C) 2004-2005 Intel Corporation &lt;jketreno@linux.intel.com&gt;<br />bcm43xx driver<br />PCI: Enabling device 0000:00:00.0 (0000 -&gt; 0002)<br />bcm43xx: Chip ID 0x5365, rev 0x1<br />bcm43xx: Number of cores: 0<br />bcm43xx: Core 0: ID 0x800, rev 0x5, vendor 0x4243, enabled<br />bcm43xx: Error: No 80211 core found!<br />PCI: Enabling device 0000:01:03.0 (0000 -&gt; 0002)<br />PCI: Fixing up device 0000:01:03.0<br />bcm43xx: Chip ID 0x4306, rev 0x3<br />bcm43xx: Number of cores: 5<br />bcm43xx: Core 0: ID 0x800, rev 0x4, vendor 0x4243, enabled<br />bcm43xx: Core 1: ID 0x812, rev 0x5, vendor 0x4243, disabled<br />bcm43xx: Core 2: ID 0x80d, rev 0x2, vendor 0x4243, enabled<br />bcm43xx: Core 3: ID 0x807, rev 0x2, vendor 0x4243, disabled<br />bcm43xx: Core 4: ID 0x804, rev 0x9, vendor 0x4243, enabled<br />bcm43xx: PHY connected<br />bcm43xx: Detected PHY: Version: 2, Type 2, Revision 2<br />bcm43xx: Detected Radio: ID: 2205017f (Manuf: 17f Ver: 2050 Rev: 2)<br />bcm43xx: Radio turned off<br />bcm43xx: Radio turned off</p><p>Any clues?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p36427">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">floe</div>
					<div class="post-datetime">
						2 Nov 2006, 10:25					</div>
				</div>
				<div class="post-content content">
					<p>I have a similar error: bcm43xx is built into the kernel and during boot, the core is detected correctly:<br /></p><div class="codebox"><pre><code>&lt;6&gt;bcm43xx driver
&lt;4&gt;PCI: Enabling device 0000:01:02.0 (0000 -&gt; 0002)
&lt;4&gt;PCI: Fixing up device 0000:01:02.0
&lt;7&gt;PCI: Setting latency timer of device 0000:01:02.0 to 64
&lt;6&gt;bcm43xx: Chip ID 0x4306, rev 0x3
&lt;6&gt;bcm43xx: Number of cores: 5
&lt;6&gt;bcm43xx: Core 0: ID 0x800, rev 0x4, vendor 0x4243, enabled
&lt;6&gt;bcm43xx: Core 1: ID 0x812, rev 0x5, vendor 0x4243, disabled
&lt;6&gt;bcm43xx: Core 2: ID 0x80d, rev 0x2, vendor 0x4243, enabled
&lt;6&gt;bcm43xx: Core 3: ID 0x807, rev 0x2, vendor 0x4243, disabled
&lt;6&gt;bcm43xx: Core 4: ID 0x804, rev 0x9, vendor 0x4243, enabled
&lt;6&gt;bcm43xx: PHY connected
&lt;6&gt;bcm43xx: Detected PHY: Version: 2, Type 2, Revision 2
&lt;6&gt;bcm43xx: Detected Radio: ID: 2205017f (Manuf: 17f Ver: 2050 Rev: 2)
&lt;6&gt;bcm43xx: Radio turned off
&lt;6&gt;bcm43xx: Radio turned off</code></pre></div><p>However, as soon as I tried &quot;ifconfig eth2 up&quot;, the ifconfig process hung and dmesg produced:<br /></p><div class="codebox"><pre><code>&lt;1&gt;Data bus error, epc == 8012c654, ra == 8012f67c
&lt;4&gt;Oops[#1]:
&lt;4&gt;Cpu 0
&lt;4&gt;$ 0   : 00000000 1000f000 00000001 00010003
&lt;4&gt;$ 4   : 00010000 00000000 0c040083 00040080
&lt;4&gt;$ 8   : 00000009 00000080 00000004 00000000
&lt;4&gt;$12   : 00401043 00705aac 00000001 00000010
&lt;4&gt;$16   : 8037c000 8037cc28 00000000 00000000
&lt;4&gt;$20   : 00000000 8037cd5c 80290000 00008914
&lt;4&gt;$24   : 00000000 80220000                  
&lt;4&gt;$28   : 80afc000 80afdd78 7ff63c68 8012f67c
&lt;4&gt;Hi    : 0029dfff
&lt;4&gt;Lo    : bcfd4527
&lt;4&gt;epc   : 8012c654     Not tainted
&lt;4&gt;ra    : 8012f67c Status: 1000f003    KERNEL EXL IE 
&lt;4&gt;Cause : 0000001c
&lt;4&gt;PrId  : 00024000
&lt;4&gt;Modules linked in: videodev v4l2_common usb_storage sd_mod scsi_mod usblp ohci_hcd vfat fat ext3 jbd ext2 nls_utf8 nl
s_iso8859_15 nls_iso8859_1 nls_cp850 nls_cp437 usbcore nls_base
&lt;4&gt;Process ifconfig (pid: 1203, threadinfo=80afc000, task=80ef2030)
&lt;4&gt;Stack : 000200d2 80ef2030 8028a394 80ef2030 8000925c 00000010 00000002 80055484
&lt;4&gt;        80abe000 802fff20 8030f7c0 80f121e4 8037c000 00000000 80290000 00000000
&lt;4&gt;        80afde30 00000000 00000000 8017d214 10383433 1000001e 2aaad47c 2abd9fc4
&lt;4&gt;        8037c000 00001002 00001043 8017f38c 80018d5c 00000000 8028a360 8083de34
&lt;4&gt;        ffffff82 00000000 80afde20 8037c000 801d3e78 801d3ce8 00008913 00000000
&lt;4&gt;        ...
&lt;4&gt;Call Trace: [&lt;8000925c&gt;]  [&lt;80055484&gt;]  [&lt;8017d214&gt;]  [&lt;8017f38c&gt;]  [&lt;80018d5c&gt;]  [&lt;801d3e78&gt;]  [&lt;801d3ce8&gt;]  [&lt;8017fdb4&gt;]  [&lt;801d56ac&gt;]  [&lt;801702fc&gt;]  [&lt;80170318&gt;]  [&lt;8008ef50&gt;]  [&lt;8008f2a8&gt;]  [&lt;800334d0&gt;]  [&lt;8008f320&gt;]  [&lt;80012bc0&gt;]  [&lt;80012bc0&gt;] 
&lt;4&gt;
&lt;4&gt;Code: 3c040001  34830003  00451021 &lt;8c420f98&gt; 00431024  00441026  03e00008  2c420001  27bdffe8 
&lt;1&gt;Data bus error, epc == 80150f7c, ra == 80151dcc
&lt;4&gt;Oops[#2]:
&lt;4&gt;Cpu 0
&lt;4&gt;$ 0   : 00000000 1000f001 00000080 ffffffff
&lt;4&gt;$ 4   : 00000107 802e8180 00000040 00000088
&lt;4&gt;$ 8   : 00000000 00000000 00000000 00000001
&lt;4&gt;$12   : 80e9ec90 00000006 80e9ed94 00000000
&lt;4&gt;$16   : 802e8180 00001388 802e80e8 802e8180
&lt;4&gt;$20   : 802e80e8 8036dec0 00000040 00000088
&lt;4&gt;$24   : 00000000 801510e4                  
&lt;4&gt;$28   : 8036c000 8036de30 80290000 80151dcc
&lt;4&gt;Hi    : 00000028
&lt;4&gt;Lo    : d4fdc480
&lt;4&gt;epc   : 80150f7c     Not tainted
&lt;4&gt;ra    : 80151dcc Status: 1000f003    KERNEL EXL IE 
&lt;4&gt;Cause : 0000001c
&lt;4&gt;PrId  : 00024000
&lt;4&gt;Modules linked in: videodev v4l2_common usb_storage sd_mod scsi_mod usblp ohci_hcd vfat fat ext3 jbd ext2 nls_utf8 nl
s_iso8859_15 nls_iso8859_1 nls_cp850 nls_cp437 usbcore nls_base
&lt;4&gt;Process kblockd/0 (pid: 6, threadinfo=8036c000, task=80360810)
&lt;4&gt;Stack : 802e8180 00000000 80c0eaf4 8038c880 802e80e8 800e50d4 802e8180 0000024b
&lt;4&gt;        80c0fee8 8038c880 802e80e8 ffffffff 00000000 00000000 00000000 8015033c
&lt;4&gt;        1000c000 00000000 00000000 00000001 00001388 80c25690 00000000 00000000
&lt;4&gt;        80027998 00000000 00000000 00000000 00000000 00000000 80c0eaf4 1000f001
&lt;4&gt;        800e7df4 8033be70 fffffffc 00000000 1000c000 1000c001 8032b580 1000f001
&lt;4&gt;        ...
&lt;4&gt;Call Trace: [&lt;800e50d4&gt;]  [&lt;8015033c&gt;]  [&lt;80027998&gt;]  [&lt;800e7df4&gt;]  [&lt;800e7e8c&gt;]  [&lt;800400dc&gt;]  [&lt;800402a0&gt;]  [&lt;80027930&gt;]  [&lt;8021a7f4&gt;]  [&lt;80040168&gt;]  [&lt;80044aa0&gt;]  [&lt;8000b1cc&gt;]  [&lt;8000b1bc&gt;] 
&lt;4&gt;
&lt;4&gt;Code: 3c028022  8c420550  00441021 &lt;90420000&gt; 03e00008  304200ff  3c028022  8c420550  00441021</code></pre></div><p>Looks to me like it&#039;s basically the same error. On my router with rev. 5373, though, this didn&#039;t produce a kernel panic, just the oops above. Unfortunately, now all ifconfig/iwconfig calls hang and can&#039;t be terminated.</p><p>The really weird thing is that I already had the bcm43xx driver up and running with an earlier revision around 4700 or so.. However, at that point, I wasn&#039;t yet using the IDE controller, which shares an IRQ with the wireless controller. I just noticed that in my case, the two oopses occured in separate processes, namely ifconfig and kblockd. This might be an indicator that there&#039;s really some kind of interrupt sharing issue.</p><p>Can you do a cat /proc/interrupts and lspci, just for comparision?</p><p>Florian</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p36431">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">mangoo</div>
					<div class="post-datetime">
						2 Nov 2006, 13:06					</div>
				</div>
				<div class="post-content content">
					<p># lspci -vvv<br />00:00.0 FLASH memory: Broadcom Corporation Sentry5 Chipcommon I/O Controller (rev 01)<br />&nbsp; &nbsp; &nbsp; &nbsp; Control: I/O- Mem+ BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-<br />&nbsp; &nbsp; &nbsp; &nbsp; Status: Cap- 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR-<br />&nbsp; &nbsp; &nbsp; &nbsp; Interrupt: pin ? routed to IRQ 3<br />&nbsp; &nbsp; &nbsp; &nbsp; Region 0: Memory at 18000000 (32-bit, non-prefetchable) [size=4K]<br />&nbsp; &nbsp; &nbsp; &nbsp; [virtual] Expansion ROM at 18007000 [disabled] [size=2K]</p><p>00:01.0 Ethernet controller: Broadcom Corporation Sentry5 Ethernet Controller (rev 01)<br />&nbsp; &nbsp; &nbsp; &nbsp; Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-<br />&nbsp; &nbsp; &nbsp; &nbsp; Status: Cap- 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR-<br />&nbsp; &nbsp; &nbsp; &nbsp; Latency: 64<br />&nbsp; &nbsp; &nbsp; &nbsp; Interrupt: pin A routed to IRQ 4<br />&nbsp; &nbsp; &nbsp; &nbsp; Region 0: Memory at 18001000 (32-bit, non-prefetchable) [size=4K]<br />&nbsp; &nbsp; &nbsp; &nbsp; [virtual] Expansion ROM at 18007800 [disabled] [size=2K]</p><p>00:02.0 Network and computing encryption device: Broadcom Corporation Sentry5 Crypto Accelerator (rev 01)<br />&nbsp; &nbsp; &nbsp; &nbsp; Control: I/O- Mem- BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-<br />&nbsp; &nbsp; &nbsp; &nbsp; Status: Cap- 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR-<br />&nbsp; &nbsp; &nbsp; &nbsp; Interrupt: pin B routed to IRQ 5<br />&nbsp; &nbsp; &nbsp; &nbsp; Region 0: Memory at 18002000 (32-bit, non-prefetchable) [disabled] [size=4K]<br />&nbsp; &nbsp; &nbsp; &nbsp; [virtual] Expansion ROM at 18008000 [disabled] [size=2K]</p><p>00:03.0 USB Controller: Broadcom Corporation Sentry5 USB Controller (rev 01) (prog-if 10 [OHCI])<br />&nbsp; &nbsp; &nbsp; &nbsp; Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-<br />&nbsp; &nbsp; &nbsp; &nbsp; Status: Cap- 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR-<br />&nbsp; &nbsp; &nbsp; &nbsp; Latency: 64<br />&nbsp; &nbsp; &nbsp; &nbsp; Interrupt: pin C routed to IRQ 6<br />&nbsp; &nbsp; &nbsp; &nbsp; Region 0: Memory at 18003000 (32-bit, non-prefetchable) [size=4K]<br />&nbsp; &nbsp; &nbsp; &nbsp; [virtual] Expansion ROM at 18008800 [disabled] [size=2K]</p><p>00:04.0 MIPS: Broadcom Corporation Sentry5 PCI Bridge (rev 01)<br />&nbsp; &nbsp; &nbsp; &nbsp; Control: I/O- Mem- BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-<br />&nbsp; &nbsp; &nbsp; &nbsp; Status: Cap- 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR-<br />&nbsp; &nbsp; &nbsp; &nbsp; Interrupt: pin D routed to IRQ 2<br />&nbsp; &nbsp; &nbsp; &nbsp; Region 0: Memory at 18004000 (32-bit, non-prefetchable) [disabled] [size=4K]<br />&nbsp; &nbsp; &nbsp; &nbsp; [virtual] Expansion ROM at 18009000 [disabled] [size=2K]</p><p>00:05.0 MIPS: Broadcom Corporation BCM3302 Sentry5 MIPS32 CPU (rev 01)<br />&nbsp; &nbsp; &nbsp; &nbsp; Control: I/O- Mem- BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-<br />&nbsp; &nbsp; &nbsp; &nbsp; Status: Cap- 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR-<br />&nbsp; &nbsp; &nbsp; &nbsp; Interrupt: pin E routed to IRQ 2<br />&nbsp; &nbsp; &nbsp; &nbsp; Region 0: Memory at 18005000 (32-bit, non-prefetchable) [disabled] [size=4K]<br />&nbsp; &nbsp; &nbsp; &nbsp; [virtual] Expansion ROM at 18009800 [disabled] [size=2K]</p><p>00:06.0 RAM memory: Broadcom Corporation Sentry5 DDR/SDR RAM Controller (rev 01)<br />&nbsp; &nbsp; &nbsp; &nbsp; Control: I/O- Mem- BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-<br />&nbsp; &nbsp; &nbsp; &nbsp; Status: Cap- 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR-<br />&nbsp; &nbsp; &nbsp; &nbsp; Interrupt: pin ? routed to IRQ 3<br />&nbsp; &nbsp; &nbsp; &nbsp; Region 0: Memory at 18006000 (32-bit, non-prefetchable) [disabled] [size=4K]<br />&nbsp; &nbsp; &nbsp; &nbsp; [virtual] Expansion ROM at 1800a000 [disabled] [size=2K]</p><p>01:00.0 Host bridge: Broadcom Corporation BCM5365P Sentry5 Host Bridge<br />&nbsp; &nbsp; &nbsp; &nbsp; Subsystem: Broadcom Corporation BCM5365P Sentry5 Host Bridge<br />&nbsp; &nbsp; &nbsp; &nbsp; Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-<br />&nbsp; &nbsp; &nbsp; &nbsp; Status: Cap- 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort+ &gt;SERR- &lt;PERR-<br />&nbsp; &nbsp; &nbsp; &nbsp; Latency: 64<br />&nbsp; &nbsp; &nbsp; &nbsp; Interrupt: pin A routed to IRQ 2<br />&nbsp; &nbsp; &nbsp; &nbsp; Region 1: Memory at &lt;unassigned&gt; (32-bit, prefetchable)</p><p>01:02.0 USB Controller: VIA Technologies, Inc. VT82xxxxx UHCI USB 1.1 Controller (rev 61) (prog-if 00 [UHCI])<br />&nbsp; &nbsp; &nbsp; &nbsp; Subsystem: VIA Technologies, Inc. VT82xxxxx UHCI USB 1.1 Controller<br />&nbsp; &nbsp; &nbsp; &nbsp; Control: I/O+ Mem- BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-<br />&nbsp; &nbsp; &nbsp; &nbsp; Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=medium &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR-<br />&nbsp; &nbsp; &nbsp; &nbsp; Latency: 22<br />&nbsp; &nbsp; &nbsp; &nbsp; Interrupt: pin A routed to IRQ 2<br />&nbsp; &nbsp; &nbsp; &nbsp; Region 4: I/O ports at 0100 [size=32]<br />&nbsp; &nbsp; &nbsp; &nbsp; Capabilities: [80] Power Management version 2<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Flags: PMEClk+ DSI- D1+ D2+ AuxCurrent=0mA PME(D0+,D1+,D2+,D3hot+,D3cold-)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Status: D0 PME-Enable- DSel=0 DScale=0 PME-</p><p>01:02.1 USB Controller: VIA Technologies, Inc. VT82xxxxx UHCI USB 1.1 Controller (rev 61) (prog-if 00 [UHCI])<br />&nbsp; &nbsp; &nbsp; &nbsp; Subsystem: VIA Technologies, Inc. VT82xxxxx UHCI USB 1.1 Controller<br />&nbsp; &nbsp; &nbsp; &nbsp; Control: I/O+ Mem- BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-<br />&nbsp; &nbsp; &nbsp; &nbsp; Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=medium &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR-<br />&nbsp; &nbsp; &nbsp; &nbsp; Latency: 22<br />&nbsp; &nbsp; &nbsp; &nbsp; Interrupt: pin B routed to IRQ 2<br />&nbsp; &nbsp; &nbsp; &nbsp; Region 4: I/O ports at 0120 [size=32]<br />&nbsp; &nbsp; &nbsp; &nbsp; Capabilities: [80] Power Management version 2<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Flags: PMEClk+ DSI- D1+ D2+ AuxCurrent=0mA PME(D0+,D1+,D2+,D3hot+,D3cold-)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Status: D0 PME-Enable- DSel=0 DScale=0 PME-</p><p>01:02.2 USB Controller: VIA Technologies, Inc. USB 2.0 (rev 63) (prog-if 20 [EHCI])<br />&nbsp; &nbsp; &nbsp; &nbsp; Subsystem: VIA Technologies, Inc. USB 2.0<br />&nbsp; &nbsp; &nbsp; &nbsp; Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV+ VGASnoop- ParErr- Stepping- SERR- FastB2B-<br />&nbsp; &nbsp; &nbsp; &nbsp; Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=medium &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR-<br />&nbsp; &nbsp; &nbsp; &nbsp; Latency: 22, Cache Line Size: 32 bytes<br />&nbsp; &nbsp; &nbsp; &nbsp; Interrupt: pin C routed to IRQ 2<br />&nbsp; &nbsp; &nbsp; &nbsp; Region 0: Memory at 40000000 (32-bit, non-prefetchable) [size=256]<br />&nbsp; &nbsp; &nbsp; &nbsp; Capabilities: [80] Power Management version 2<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Flags: PMEClk+ DSI- D1+ D2+ AuxCurrent=0mA PME(D0+,D1+,D2+,D3hot+,D3cold-)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Status: D0 PME-Enable- DSel=0 DScale=0 PME-</p><p>01:03.0 Network controller: Broadcom Corporation BCM4306 802.11b/g Wireless LAN Controller (rev 03)<br />&nbsp; &nbsp; &nbsp; &nbsp; Subsystem: Broadcom Corporation Unknown device 120f<br />&nbsp; &nbsp; &nbsp; &nbsp; Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-<br />&nbsp; &nbsp; &nbsp; &nbsp; Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR-<br />&nbsp; &nbsp; &nbsp; &nbsp; Latency: 64<br />&nbsp; &nbsp; &nbsp; &nbsp; Interrupt: pin A routed to IRQ 2<br />&nbsp; &nbsp; &nbsp; &nbsp; Region 0: Memory at 40002000 (32-bit, non-prefetchable) [size=8K]<br />&nbsp; &nbsp; &nbsp; &nbsp; Capabilities: [40] Power Management version 2<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Flags: PMEClk- DSI- D1+ D2+ AuxCurrent=375mA PME(D0+,D1+,D2+,D3hot+,D3cold+)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Status: D0 PME-Enable- DSel=0 DScale=2 PME-</p><p># cat /proc/interrupts<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CPU0<br />&nbsp; 2:&nbsp; &nbsp;92317031&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MIPS&nbsp; ehci_hcd:usb1, uhci_hcd:usb2, uhci_hcd:usb3<br />&nbsp; 3:&nbsp; &nbsp; &nbsp; &nbsp; 233&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MIPS&nbsp; serial<br />&nbsp; 4:&nbsp; &nbsp; 1135128&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MIPS&nbsp; eth0<br />&nbsp; 6:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MIPS&nbsp; ohci_hcd:usb4<br />&nbsp; 7:&nbsp; &nbsp;57251982&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MIPS&nbsp; timer</p><p>ERR:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0</p><p># ifconfig eth1 up<br />Segmentation fault</p><p>And it&#039;s a kernel panic (revision 5371).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p36461">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">floe</div>
					<div class="post-datetime">
						2 Nov 2006, 20:59					</div>
				</div>
				<div class="post-content content">
					<p>I opened a ticket: <a href="https://dev.openwrt.org/ticket/901">https://dev.openwrt.org/ticket/901</a><br />On your router, the wireless device shares IRQ 2 with the USB controller, so it might be an IRQ sharing issue as well. On my router, the block device had crashed, too, so this also fits the picture. I&#039;ll try a kernel without IDE next, in your case temporarily disabling the USB stuff might help or at least give more clues.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p36462">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">mangoo</div>
					<div class="post-datetime">
						2 Nov 2006, 21:14					</div>
				</div>
				<div class="post-content content">
					<p>I boot from a USB-stick, so disabling it is not an option <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p36463">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">floe</div>
					<div class="post-datetime">
						2 Nov 2006, 21:16					</div>
				</div>
				<div class="post-content content">
					<p>Update: I added a ksymoops output to the ticket. Maybe you could do the same..</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p36464">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">mangoo</div>
					<div class="post-datetime">
						2 Nov 2006, 21:29					</div>
				</div>
				<div class="post-content content">
					<p>ksymoops on a 2.6 kernel?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p36466">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">floe</div>
					<div class="post-datetime">
						2 Nov 2006, 22:05					</div>
				</div>
				<div class="post-content content">
					<p>Yes, it&#039;s just not part of the kernel anymore, it&#039;s a separate package - the distro of your build system will most likely have it ready (Gentoo had, in my case).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p36469">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">mangoo</div>
					<div class="post-datetime">
						2 Nov 2006, 23:13					</div>
				</div>
				<div class="post-content content">
					<p>Indeed, here&#039;s some learning from Documentation/Changes:</p><p>Ksymoops<br />--------</p><p>If the unthinkable happens and your kernel oopses, you may need the<br />ksymoops tool to decode it, but in most cases you don&#039;t.<br />In the 2.6 kernel it is generally preferred to build the kernel with<br />CONFIG_KALLSYMS so that it produces readable dumps that can be used as-is<br />(this also produces better output than ksymoops).<br />If for some reason your kernel is not build with CONFIG_KALLSYMS and<br />you have no way to rebuild and reproduce the Oops with that option, then<br />you can still decode that Oops with ksymoops.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p36470">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">floe</div>
					<div class="post-datetime">
						2 Nov 2006, 23:33					</div>
				</div>
				<div class="post-content content">
					<p>Aah.. all right, thanks for the hint. Will remember that for the next kernel I build..</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p36472">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">floe</div>
					<div class="post-datetime">
						3 Nov 2006, 00:54					</div>
				</div>
				<div class="post-content content">
					<p>I tried a new kernel without IDE and with CONFIG_KALLSYMS. Oops again.. here&#039;s the output:</p><div class="codebox"><pre><code>&lt;1&gt;Data bus error, epc == 8012d834, ra == 8013085c
&lt;4&gt;Oops[#1]:
&lt;4&gt;Cpu 0
&lt;4&gt;$ 0   : 00000000 1000b000 00000001 00010003
&lt;4&gt;$ 4   : 00010000 00000000 0c040083 00040080
&lt;4&gt;$ 8   : 00000009 00000080 00000004 00000000
&lt;4&gt;$12   : 00401043 00705aac 00000001 00000010
&lt;4&gt;$16   : 80396000 80396c28 00000000 00000000
&lt;4&gt;$20   : 00000000 80396d5c 802b0000 00008914
&lt;4&gt;$24   : 00000000 80220000                  
&lt;4&gt;$28   : 80e9c000 80e9dd78 7fd57c68 8013085c
&lt;4&gt;Hi    : 0029dfff
&lt;4&gt;Lo    : bcfd4527
&lt;4&gt;epc   : 8012d834 bcm43xx_core_enabled+0x14/0x28     Not tainted
&lt;4&gt;ra    : 8013085c bcm43xx_init_board+0x19c/0xedc
&lt;4&gt;Status: 1000b003    KERNEL EXL IE 
&lt;4&gt;Cause : 0000001c
&lt;4&gt;PrId  : 00024000
&lt;4&gt;Modules linked in: videodev v4l2_common usb_storage sd_mod scsi_mod usblp ohci_hcd vfat fat ext3 jbd ext2 nls_utf8 nl
s_iso8859_15 nls_iso8859_1 nls_cp850 nls_cp437 usbcore nls_base
&lt;4&gt;Process ifconfig (pid: 721, threadinfo=80e9c000, task=80c14420)
&lt;4&gt;Stack : 000200d2 80c14420 802a4214 80c14420 8000927c 00000010 00000002 800565d4
&lt;4&gt;        80ad0000 8031a260 80329a00 80e7e1e4 80396000 00000000 802b0000 00000000
&lt;4&gt;        80e9de30 00000000 00000000 8017d0f4 10353832 1000001e 8003d9dc fffffff0
&lt;4&gt;        80396000 00001002 00001043 8017f26c 80018d5c 00000000 802a41e0 80e7990c
&lt;4&gt;        ffffff82 00000000 80e9de20 80396000 801d3d58 801d3bc8 00008913 00000000
&lt;4&gt;        ...
&lt;4&gt;Call Trace:
&lt;4&gt; [&lt;8000927c&gt;] ret_from_irq+0x0/0x10
&lt;4&gt; [&lt;800565d4&gt;] __alloc_pages+0x60/0x2e8
&lt;4&gt; [&lt;8017d0f4&gt;] dev_open+0xd8/0x1c0
&lt;4&gt; [&lt;8003d9dc&gt;] sys_setuid+0x0/0x118
&lt;4&gt; [&lt;8017f26c&gt;] dev_change_flags+0x74/0x154
&lt;4&gt; [&lt;80018d5c&gt;] r4k_flush_icache_page+0x28/0x34
&lt;4&gt; [&lt;801d3d58&gt;] devinet_ioctl+0x2fc/0x884
&lt;4&gt; [&lt;801d3bc8&gt;] devinet_ioctl+0x16c/0x884
&lt;4&gt; [&lt;8017fc94&gt;] dev_ioctl+0x380/0x600
&lt;4&gt; [&lt;801d558c&gt;] inet_ioctl+0xc8/0xfc
&lt;4&gt; [&lt;801701dc&gt;] sock_ioctl+0x220/0x264
&lt;4&gt; [&lt;801701f8&gt;] sock_ioctl+0x23c/0x264
&lt;4&gt; [&lt;800900a0&gt;] do_ioctl+0x30/0x78
&lt;4&gt; [&lt;8016f2fc&gt;] sock_alloc_fd+0x28/0x60
&lt;4&gt; [&lt;800903f8&gt;] vfs_ioctl+0x310/0x338
&lt;4&gt; [&lt;8016f4fc&gt;] sock_map_fd+0x30/0x78
&lt;4&gt; [&lt;8017096c&gt;] sock_create+0x10/0x1c
&lt;4&gt; [&lt;80090470&gt;] sys_ioctl+0x50/0x90
&lt;4&gt; [&lt;80012d00&gt;] stack_done+0x20/0x3c
&lt;4&gt; [&lt;80012d00&gt;] stack_done+0x20/0x3c
&lt;4&gt;
&lt;4&gt;
&lt;4&gt;Code: 3c040001  34830003  00451021 &lt;8c420f98&gt; 00431024  00441026  03e00008  2c420001  27bdffe8</code></pre></div><p>So it seems that my previous assumption about IRQ sharing wasn&#039;t correct.. this time, bcm43xx should have had the interrupt all by itself.</p><p>Now I&#039;m going to get some sleep <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> Hope you (or somebody else) can get something useful out of this.</p><p>Good night everybody,<br />Florian</p>											<p class="post-edited">(Last edited by <strong>floe</strong> on 3 Nov 2006, 01:10)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p36781">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">MMCM</div>
					<div class="post-datetime">
						8 Nov 2006, 12:42					</div>
				</div>
				<div class="post-content content">
					<p>Any progress with this problem?<br />I tried bcm43xx on my WL-500gx yesterday, and had the same effect :-(</p><p>Did anybody try the 2.6.18 kernel with updated bcm43xx code?<br />See <a href="http://forum.openwrt.org/viewtopic.php?id=7010">http://forum.openwrt.org/viewtopic.php?id=7010</a> <br /><a href="https://dev.openwrt.org/ticket/893">https://dev.openwrt.org/ticket/893</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p37648">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">MMCM</div>
					<div class="post-datetime">
						23 Nov 2006, 01:30					</div>
				</div>
				<div class="post-content content">
					<p>Update: First (and last?) tests with 2.6.18</p><p>see <a href="http://forum.openwrt.org/viewtopic.php?pid=37643#p37643">http://forum.openwrt.org/viewtopic.php?pid=37643#p37643</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p38033">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">floe</div>
					<div class="post-datetime">
						29 Nov 2006, 18:52					</div>
				</div>
				<div class="post-content content">
					<p>*bump*</p><p>From the ticket: </p><div class="quotebox"><cite>florian wrote:</cite><blockquote><p>We will wait for the new SSB code that will be pushed later.</p></blockquote></div><p>Just curious if there are any new developments on the SSB stuff..</p><p>Floe</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>