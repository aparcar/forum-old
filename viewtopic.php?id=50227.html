<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> D-Link DWR-161 battery powered portable router</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 3 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p230901">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">richms</div>
					<div class="post-datetime">
						21 Apr 2014, 14:35					</div>
				</div>
				<div class="post-content content">
					<p>I got one of these because they are on clearance.</p><p>Its a small battery powered single RJ45 device,</p><p>Easily accessable and labeled serial console, here is the output on boot up.</p><div class="codebox"><pre><code>                                                                                
                                                                                
CDM530AM_002 Jboot B483                                                         
JRecovery Version R1.2 2011/10/06 18:03                                         
SPI FLASH: EN25Q64 8M                                                           
CSID 6E20-&gt;6E21                                                                 
................                                                                
Starting kernel @80000000...                                                    
                                                                                
LINUX started...                                                                
                                                                                
 THIS IS ASIC                                                                   
Linux version 2.6.21 (chad@localhost.localdomain) (gcc version 3.4.2) #1 Fri Apr
 13 09:42:17 CST 2012                                                           
                                                                                
 The CPU feqenuce set to 360 MHz                                                
CPU revision is: 0001964c                                                       
Determined physical RAM map:                                                    
 memory: 02000000 @ 00000000 (usable)                                           
Built 1 zonelists.  Total pages: 8128                                           
Kernel command line: console=ttyS1,57600n8 root=/dev/mtdblock3                  
Primary instruction cache 32kB, physically tagged, 4-way, linesize 32 bytes.    
Primary data cache 16kB, 4-way, linesize 32 bytes.                              
Synthesized TLB refill handler (20 instructions).                               
Synthesized TLB load handler fastpath (32 instructions).                        
Synthesized TLB store handler fastpath (32 instructions).                       
Synthesized TLB modify handler fastpath (31 instructions).                      
Cache parity protection disabled                                                
cause = c0808074, status = 11000000                                             
PID hash table entries: 128 (order: 7, 512 bytes)                               
calculating r4koff... 0015f900(1440000)                                         
CPU frequency 360.00 MHz                                                        
Using 180.000 MHz high precision timer.                                         
Console: colour dummy device 80x25                                              
Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)                   
Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)                     
Memory: 29396k/32768k available (2284k kernel code, 3372k reserved, 559k data, 1
20k init, 0k highmem)                                                           
Mount-cache hash table entries: 512                                             
NET: Registered protocol family 16                                              
SCSI subsystem initialized                                                      
usbcore: registered new interface driver usbfs                                  
usbcore: registered new interface driver hub                                    
usbcore: registered new device driver usb                                       
NET: Registered protocol family 2                                               
Time: MIPS clocksource has been installed.                                      
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)                  
TCP established hash table entries: 1024 (order: 1, 8192 bytes)                 
TCP bind hash table entries: 1024 (order: 0, 4096 bytes)                        
TCP: Hash tables configured (established 1024 bind 1024)                        
TCP reno registered                                                             
RT3xxx EHCI/OHCI init.                                                          
squashfs: version 3.2-r2 (2007/01/15) Phillip Lougher                           
squashfs: LZMA suppport for slax.org by jro                                     
io scheduler noop registered (default)                                          
                                                                                
------------------GPIO--------------------------                                
 GPIOMODE:2df                                                                   
SLIC INTR ==&gt; gpio 1                                                            
Ralink gpio driver initialized                                                  
HDLC line discipline: version $Revision: 1.1.1.1 $, maxframe=4096               
N_HDLC line discipline registered.                                              
Serial: 8250/16550 driver $Revision: 1.7 $ 4 ports, IRQ sharing disabled        
serial8250: ttyS0 at I/O 0xb0000500 (irq = 37) is a 16550A                      
serial8250: ttyS1 at I/O 0xb0000c00 (irq = 12) is a 16550A                      
loop: loaded (max 8 devices)                                                    
rdm_major = 254                                                                 
net_speed proc file Create                                                      
MAC_ADRH -- : 0x00000000                                                        
MAC_ADRL -- : 0x00000000                                                        
                                                                                
eth2 mii.o query= phy_id:0, address:1 retval:7849                               
Ralink APSoC Ethernet Driver Initilization. v2.0  256 rx/tx descriptors allocate
d, mtu = 1500!                                                                  
MAC_ADRH -- : 0x0000000c                                                        
MAC_ADRL -- : 0x432880bd                                                        
PROC INIT OK!                                                                   
=== 0xB0100004 = 00000000                                                       
Insmod eth_ping skb_diy module.                                                 
driver loaded                                                                   
PPP generic driver version 2.4.2                                                
PPP Deflate Compression module registered                                       
PPP BSD Compression module registered                                           
MPPE/MPPC encryption/compression module registered                              
NET: Registered protocol family 24                                              
block2mtd: version $Revision: 1.1.1.1 $                                         
deice id : 1c 30 17 1c 30 (30171c30)                                            
EN25Q64(1c 30171c30) (8192 Kbytes)                                              
mtd .name = raspi, .size = 0x00800000 (8M) .erasesize = 0x00001000 (4K) .numeras
eregions = 0                                                                    
Creating 6 MTD partitions on &quot;raspi&quot;:                                           
0x00000000-0x00800000 : &quot;Whole&quot;                                                 
0x00000000-0x00010000 : &quot;Bootloader&quot;                                            
0x00010000-0x00150000 : &quot;Kernel&quot;                                                
0x00150000-0x00710000 : &quot;RootFS&quot;                                                
0x00710010-0x007f0000 : &quot;UI&quot;                                                    
mtd: partition &quot;UI&quot; doesn&#039;t start on an erase block boundary -- force read-only 
0x007f0000-0x00800000 : &quot;Config&quot;                                                
rt3xxx-ehci rt3xxx-ehci: Ralink EHCI Host Controller                            
rt3xxx-ehci rt3xxx-ehci: new USB bus registered, assigned bus number 1          
rt3xxx-ehci rt3xxx-ehci: irq 18, io mem 0x101c0000                              
rt3xxx-ehci rt3xxx-ehci: USB 0.0 started, EHCI 1.00, driver 10 Dec 2004         
usb usb1: configuration #1 chosen from 1 choice                                 
hub 1-0:1.0: USB hub found                                                      
hub 1-0:1.0: 1 port detected                                                    
rt3xxx-ohci rt3xxx-ohci: RT3xxx OHCI Controller                                 
rt3xxx-ohci rt3xxx-ohci: new USB bus registered, assigned bus number 2          
rt3xxx-ohci rt3xxx-ohci: irq 18, io mem 0x101c1000                              
usb usb2: configuration #1 chosen from 1 choice                                 
hub 2-0:1.0: USB hub found                                                      
hub 2-0:1.0: 1 port detected                                                    
u32 classifier                                                                  
Netfilter messages via NETLINK v0.30.                                           
nf_conntrack version 0.5.0 (256 buckets, 2048 max)                              
Register conntrack protocol helper for ESP...                                   
IPv4 over IPv4 tunneling driver                                                 
GRE over IPv4 tunneling driver                                                  
Init IP_nat_proto_esp register.                                                 
ip_tables: (C) 2000-2006 Netfilter Core Team, Type=Restricted Cone              
arp_tables: (C) 2002 David S. Miller                                            
TCP cubic registered                                                            
NET: Registered protocol family 1                                               
NET: Registered protocol family 17                                              
802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;                   
All bugs added by David S. Miller &lt;davem@redhat.com&gt;                            
VFS: Mounted root (squashfs filesystem) readonly.                               
Freeing unused kernel memory: 120k freed                                        
Algorithmics/MIPS FPU Emulator v1.5                                             
Inter-|   Receive                                                |  Transmit    
 face |bytes    packets errs drop fifo frame compressed multicast|bytes    packe
ts errs drop fifo colls carrier compressed                                      
  eth2:       0       0    0    0    0     0          0         0        0      
 0    0    0    0     0       0          0                                      
    lo:       0       0    0    0    0     0          0         0        0      
 0    0    0    0     0       0          0                                      
 tunl0:       0       0    0    0    0     0          0         0        0      
 0    0    0    0     0       0          0                                      
  gre0:       0       0    0    0    0     0          0         0        0      
 0    0    0    0     0       0          0                                      
switch reg write offse                                                          
phy_tx_ring = 0x01c7a000, tx_ring = 0xa1c7a000                                  
                                                                                
phy_rx_ring0 = 0x01c7b000, rx_ring0 = 0xa1c7b000                                
t=168, value=17                                                                 
 flash_open: flash_fd=3                                                         
Mount D Section.                                                                
mount: /dev/mtdblock4 is write-protected, mounting read-only                    
 flash_open: flash_fd=9                                                         
phy 0, reg 0, val 0x3900                                                        
Set: phy[0].reg[0] = 3900                                                       
phy 0, reg 0, val 0x3900                                                        
Set: phy[0].reg[0] = 3900                                                       
Set gpio_range = gpio2300, dir = 8c0300                                         
switch register base addr to system register 0xb0000000                         
write offset 0x60, value 0x4042dd                                               
switch reg write offset=168, value=17                                           
switch register base addr to 0xb0181000                                         
write offset 0x2c, value 0xc500000                                              
switch register base addr to system register 0xb0000000                         
switch reg write offset=14, value=405555                                        
switch reg write offset=50, value=2001                                          
switch reg write offset=98, value=7f3f                                          
switch reg write offset=e4, value=3f                                            
switch reg write offset=40, value=1002                                          
switch reg write offset=44, value=1001                                          
switch reg write offset=48, value=1001                                          
switch reg write offset=70, value=ffff417e                                      
phy 1, reg 0, val 0x3900                                                        
Set: phy[1].reg[0] = 3900                                                       
phy 2, reg 0, val 0x3900                                                        
Set: phy[2].reg[0] = 3900                                                       
phy 3, reg 0, val 0x3900                                                        
Set: phy[3].reg[0] = 3900                                                       
phy 4, reg 0, val 0x3900                                                        
Set: phy[4].reg[0] = 3900                                                       
phy 0, reg 0, val 0x3100                                                        
Set: phy[0].reg[0] = 3100                                                       
phy 0, reg 0, val 0x3100                                                        
Set: phy[0].reg[0] = 3100                                                       
eth2.2: Setting MAC address to  84 c9 b2 e1 12 66.                              
device eth2 entered promiscuous mode                                            
VLAN (eth2.2):  Setting underlying device (eth2) to promiscious mode.           
                                                                                
eth2 mii.o query= phy_id:1, address:4 retval:5e1                                
                                                                                
eth2 mii.o query= phy_id:1, address:0 retval:3900                               
                                                                                
eth2 mii.o query= phy_id:1, address:5 retval:0                                  
eth2.2: dev_set_promiscuity(master, 1)                                          
device eth2.2 entered promiscuous mode                                          
Init handler: lan                                                               
br0: port 1(eth2.2) entering learning state                                     
Init handler: dhcpsrv                                                           
Init handler: stp                                                               
Init handler: reset_btn                                                         
Init handler: watchdog                                                          
Init handler: wlanap                                                            
br0: topology change detected, propagating                                      
br0: port 1(eth2.2) entering forwarding state                                   
rt2860v2_ap: module license &#039;unspecified&#039; taints kernel.                        
Length of MAC:6                                                                 
 mac:84:c9:b2:e1:12:66:                                                         
----                                                                            
                                                                                
                                                                                
=== pAd = c0077000, size = 802656 ===                                           
                                                                                
&lt;-- RTMPAllocAdapterBlock, Status=0                                             
RX DESC a18ec000  size = 2048                                                   
&lt;-- RTMPAllocTxRxRingMemory, Status=0                                           
2a:55:44:e4:05:1a:cb:eb:01:93:83:88:b2:c3:4f:8f:                                
50:b2:65:62:c1:a3:cb:f9:52:8e:b0:b1:79:c9:b6:97:                                
                                                                                
1. Phy Mode = 9                                                                 
2. Phy Mode = 9                                                                 
3. Phy Mode = 9                                                                 
MCS Set = ff 00 00 00 01                                                        
Main bssid = 84:c9:b2:e1:12:66                                                  
&lt;==== rt28xx_init, Status=0                                                     
0x1300 = 00064380                                                               
device ra0 entered promiscuous mode                                             
br0: port 2(ra0) entering learning state                                        
Ralink DOT1X daemon, version = &#039;2.4.0.0&#039;                                        
prefix_name = &#039;ra, argv[1] = (null)&#039;                                            
=== rtdox1 link failed: Success                                                 
=== rtdox1 002 link succesful: Success                                          
killall: check_status: no process killed                                        
br0: topology change detected, propagating                                      
br0: port 2(ra0) entering forwarding state                                      
ra0       ledstart:                                                             
Init handler: wan                                                               
Init handler: ondemand                                                          
Init handler: wibro                                                             
Init handler: nat                                                               
==== NAT START (WAN:ALL Func:ALL) ====                                          
wscd: SSDP UDP PORT = 1900                                                      
==== Reset ICMP Timeout ====                                                    
Init handler: dnsrelay                                                          
Init handler: time                                                              
timezone:-720                                                                   
dsttime:0                                                                       
Init handler: schedule                                                          
Init handler: telnet                                                            
Init handler: wps_btn                                                           
Init handler: ddns                                                              
Init handler: routing                                                           
Init handler: autobak                                                           
Init handler: keepalive                                                         
Init handler: upnp                                                              
Init handler: pptp                                                              
Init handler: l2tp                                                              
Init handler: failover                                                          
Init handler: igmp                                                              
Init handler: pwr_saving                                                        
Init handler: rbydom                                                            
Init handler: rbyip                                                             
Init handler: qos                                                               
Init handler: snmp                                                              
Init handler: spap                                                              
Init handler: ftp_alg                                                           
Init handler: sip_alg                                                           
Init handler: bty_led                                                           
Init handler: ate                                                               
Init handler: wps_status                                                        
Init handler: reboot                                                            
sh: lltd-action: not found                                                      
/usr/bin/telnetd-action: Starting telnetd...                                    
                                                                                
 flash_open: flash_fd=7                                                         
 flash_open: flash_fd=7                                                         
/usr/bin/telnetd-action start ok                                                
 flash_open: flash_fd=7                                                         
# switch register base addr to system register 0xb0000000                       
write offset 0x48, value 0x10010001                                             
Ralink APSoC Hardware Watchdog Timer                                            
Started WatchDog Timer. LoadVlaue: 18300 sysclk: 120000000 TIMEOUT: 30          
                                                                                
#                                                                               
#                                                                               
#                                                                               
#                                                                               
#                                                                               
#                                                                               
# ls                                                                            
bin   dev   etc   lib   mtd   proc  ram   root  sbin  sys   tmp   usr   var     
#  ls -l                                                                        
drwxr-xr-x    2 root     root          560 Apr 13  2012 bin                     
drwxr-xr-x    5 root     root         6767 Apr 13  2012 dev                     
lrwxrwxrwx    1 root     root            7 Apr 13  2012 etc -&gt; ram/etc          
drwxr-xr-x    5 root     root          713 Apr 13  2012 lib                     
drwxr-xr-x    2 root     root            3 Apr 13  2012 mtd                     
dr-xr-xr-x   56 root     root            0 Jan  1  2000 proc                    
drwxrwxrwt    6 root     root          120 Jan  1 12:00 ram                     
drwxr-xr-x    2 root     root            3 Apr 13  2012 root                    
drwxr-xr-x    2 root     root          189 Apr 13  2012 sbin                    
drwxr-xr-x   10 root     root            0 Jan  1  2000 sys                     
lrwxrwxrwx    1 root     root            7 Apr 13  2012 tmp -&gt; ram/tmp          
drwxr-xr-x    9 root     root           71 Apr 13  2012 usr                     
lrwxrwxrwx    1 root     root            7 Apr 13  2012 var -&gt; ram/var          
# uname -a                                                                      
Linux RT305XL 2.6.21 #1 Fri Apr 13 09:42:17 CST 2012 mips unknown               
#       </code></pre></div><p>Ralink RT5350F and an Etrontech EM63A165TS-6G on one side of the board, unreadable 8 pin what looks like a eeprom on the other side, and a whole heap of small passives and things that look related to battery management.</p><p>So, my question is, what build to put on this thing firstly, and is there anything else I should get from the console of the stock firmware before I flash it to help get things like the 3 LEDs and the USB port working nicely?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>