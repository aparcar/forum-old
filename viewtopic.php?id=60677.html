<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> CC QoS/SQM</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 29 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p298259">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">jonybat</div>
					<div class="post-datetime">
						1 Nov 2015, 20:46					</div>
				</div>
				<div class="post-content content">
					<p>Hi all</p><p>I have been using OpenWRT for about half a year now and i have been really happy with it.</p><p>I have a TP-Link TL-WDR3600 v1 connected to the ISP&#039;s 3P gateway, that has a 100/10Mb FTTH connection (real measurable speeds of around 110/11Mb). Everything in my house connects to the TP-Link, including a VoIP server. </p><p>I have been using qos-scripts (plus luci-app-qos) with the interface section download and upload speeds set to 100000/10000 kbps respectively and the voip ports set to express. I would get measured speeds close to those set in the qos and would not get any jitter or packet loss to the voip server, even when pushing the bandwidth to the maximum (for example during a speed test)</p><p>I have recently upgraded to Chaos Calmer, and now the measurable download speed is of around 50/60Mb. The upload speed does not seem to have been affected, nor the voip server connection. I also experience some heavy latency when accessing web pages if there is a download ongoing. If i disable qos, everything gets back to normal.</p><p>For the last couple of days i have been reading about qos, sqm and all that, both here in the forum and openwrt&#039;s wiki, and i can&#039;t seem to able to reach a conclusion.</p><p>I&#039;ve followed this in one of the attempts: <a href="http://wiki.openwrt.org/doc/howto/sqm">http://wiki.openwrt.org/doc/howto/sqm</a><br />The best i could get was measurable speeds close to those without any kind of traffic control, but the packet loss/jitter/bufferbloat were all over the top.</p><p>I also read about some other way of controlling traffic with tc and netfilter/iptables, but im not sure how that relates to what i&#039;ve already tried and if that is still recommended. Also, i don&#039;t want to experiment much with things im not familiar with because im providing the voip server as a service.</p><p>Now the questions...</p><p>- Did anything really change from BB to CC that might have affected the behavior of qos-scripts?</p><p>- Can sqm really replace qos in the case that i&#039;ve described, or it only serves as a way to prevent overflowing the the internet line with more packets than it can handle?</p><p>- What could i do then to get the same behavior i had in BB (without downgrading)?</p><p>Thank you in advance</p>											<p class="post-edited">(Last edited by <strong>jonybat</strong> on 2 Nov 2015, 00:20)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p298472">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">moeller0</div>
					<div class="post-datetime">
						3 Nov 2015, 10:54					</div>
				</div>
				<div class="post-content content">
					<p>Hi jonybat,</p><div class="quotebox"><cite>jonybat wrote:</cite><blockquote><p>Hi all</p><p>I have been using OpenWRT for about half a year now and i have been really happy with it.</p><p>I have a TP-Link TL-WDR3600 v1 connected to the ISP&#039;s 3P gateway, that has a 100/10Mb FTTH connection (real measurable speeds of around 110/11Mb). Everything in my house connects to the TP-Link, including a VoIP server. </p><p>I have been using qos-scripts (plus luci-app-qos) with the interface section download and upload speeds set to 100000/10000 kbps respectively and the voip ports set to express. I would get measured speeds close to those set in the qos and would not get any jitter or packet loss to the voip server, even when pushing the bandwidth to the maximum (for example during a speed test)</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; I would be quite amazed, if the wdr3600 would be able to push the 110 Mbps combined traffic under BB, typically we see HTB, the shaper qos-scripts use to top out at around 60 to 70 Mbps combined traffic, so that looks weird. I could be that your are just very lucky.<br /></p><div class="quotebox"><cite>jonybat wrote:</cite><blockquote><p>I have recently upgraded to Chaos Calmer, and now the measurable download speed is of around 50/60Mb. The upload speed does not seem to have been affected, nor the voip server connection.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; This looks more like what I would expect...<br /></p><div class="quotebox"><cite>jonybat wrote:</cite><blockquote><p>I also experience some heavy latency when accessing web pages if there is a download ongoing. If i disable qos, everything gets back to normal.</p><p>For the last couple of days i have been reading about qos, sqm and all that, both here in the forum and openwrt&#039;s wiki, and i can&#039;t seem to able to reach a conclusion.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; Best thing to do is just test and compare them.<br /></p><div class="quotebox"><cite>jonybat wrote:</cite><blockquote><p>I&#039;ve followed this in one of the attempts: <a href="http://wiki.openwrt.org/doc/howto/sqm">http://wiki.openwrt.org/doc/howto/sqm</a><br />The best i could get was measurable speeds close to those without any kind of traffic control, but the packet loss/jitter/bufferbloat were all over the top.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; So packetloss will increase if you use any shaper as the signal used to tell a sender to slow down is dropping packets (if you enable explicit congestion notification ECN on your computers and your traffic talk to ECN enabled server, then the signal is first not dropping a packet, but marking it in a way that sender and receiver will notice and slow down, then qos or sqm will not increase the packetloss). Jitter shouldn&#039;t increase though. How do you measure jitter and bufferbloat exactly? Also this is with just using qos or also with sqm? What happens if you set the shaper at say 30Mbps for ingress and 10 Mbps for egress, still bad buffering? The wdr3600 moves all packets through its switch which also might be over buffered and if the CPU does not process packets in time the switch will queue insane amounts of packets, so this test tries to see how things perform if the CPU will be able to process the packets easily...<br /></p><div class="quotebox"><cite>jonybat wrote:</cite><blockquote><p>I also read about some other way of controlling traffic with tc and netfilter/iptables, but im not sure how that relates to what i&#039;ve already tried and if that is still recommended. Also, i don&#039;t want to experiment much with things im not familiar with because im providing the voip server as a service.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; qos-scripts and sqm-scripts basically are ready-made scripts that leverage tc and net filter/iptables so even if you want to roll your own, it is worthwhile to look into those scripts first, there might be some ideas in there that are worth cloning. <br /></p><div class="quotebox"><cite>jonybat wrote:</cite><blockquote><p>Now the questions...</p><p>- Did anything really change from BB to CC that might have affected the behavior of qos-scripts?</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;I believe that the linux kernel used in CC got rid of a &quot;routing&quot; cache that the BB kernel still had, which at least for some of the intermediate development releases of CC caused a lower packet forwarding performance. I am not sure to what degree the CC release ameliorated this situation. (The kernel folks argue that the cache was a bad idea and easily exploitable so removed it even though it reduced best-case forwarding performance a bit, if I recall correctly.)<br /></p><div class="quotebox"><cite>jonybat wrote:</cite><blockquote><p>- Can sqm really replace qos in the case that i&#039;ve described, or it only serves as a way to prevent overflowing the the internet line with more packets than it can handle?</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; To quote Dr. Seuss: “Try them, try them, and you may! Try them and you may, I say.” (Green Eggs and Ham), sqm-scripts aim to solve your problem, just test them and see how they perform, but note that up until now sqm and qos scripts both use the same techniques (HTB and fq_codel) and will most likely top out at similar shaper bandwidths.<br /></p><div class="quotebox"><cite>jonybat wrote:</cite><blockquote><p>- What could i do then to get the same behavior i had in BB (without downgrading)?</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; Get a faster router? I believe the wdr3600 might just not be powerful enough for a 100/10 line. I have similar issues with my wndr3700v2 except the wan port is not run through a switch and so the failure mode is more benign, latency stays sane, I just do not reach the specified bandwidth... No idea which router to recommend currently, the archer c7 ae cheap and popular, but I believe fall a bit short for you 110Mbps goalpost, and the linksys WRT1900AC/WRT1200AC/WRT1900ACv2/WRT1900ACS can shape at the speeds you want, but might still have issues with their wireless (or they might not, I did not follow that 333+ pages thread closely).<br /></p><div class="quotebox"><cite>jonybat wrote:</cite><blockquote><p>Thank you in advance</p></blockquote></div><p>Best Regards<br />&nbsp; &nbsp; &nbsp; &nbsp; M.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p298488">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">jonybat</div>
					<div class="post-datetime">
						3 Nov 2015, 14:53					</div>
				</div>
				<div class="post-content content">
					<p>Hi moeller,</p><p>First of all, thank you the extensive reply.</p><div class="quotebox"><cite>moeller0 wrote:</cite><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; I would be quite amazed, if the wdr3600 would be able to push the 110 Mbps combined traffic under BB, typically we see HTB, the shaper qos-scripts use to top out at around 60 to 70 Mbps combined traffic, so that looks weird. I could be that your are just very lucky.</p></blockquote></div><p>Was not 110Mb, but close to 100Mb still. What i remember testing back then was that setting the downstream setting in the qos closer to the real measurable speed (~113/115Mb) would not improve almost anything, and would increase the upstream latency and packet loss during peak usage.</p><p>These are the most recent tests i have:</p><p>Without qos:<br /><a href="http://www.speedtest.net/my-result/4664866406">http://www.speedtest.net/my-result/4664866406</a></p><p>With qos set to 100000/11000:<br /><a href="http://www.speedtest.net/my-result/4664891413">http://www.speedtest.net/my-result/4664891413</a></p><div class="quotebox"><cite>moeller0 wrote:</cite><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; So packetloss will increase if you use any shaper as the signal used to tell a sender to slow down is dropping packets (if you enable explicit congestion notification ECN on your computers and your traffic talk to ECN enabled server, then the signal is first not dropping a packet, but marking it in a way that sender and receiver will notice and slow down, then qos or sqm will not increase the packetloss). Jitter shouldn&#039;t increase though. How do you measure jitter and bufferbloat exactly? Also this is with just using qos or also with sqm? What happens if you set the shaper at say 30Mbps for ingress and 10 Mbps for egress, still bad buffering? The wdr3600 moves all packets through its switch which also might be over buffered and if the CPU does not process packets in time the switch will queue insane amounts of packets, so this test tries to see how things perform if the CPU will be able to process the packets easily...</p></blockquote></div><p>Okay, but what if i want to shape/limit all traffic except specific ports, or just limit traffic on specific ports/protocols? From my basic understanding of this, it should only cause delay (and possibly packet loss) on the selected traffic, at the cost of cpu cycles obviously, because all packets need to be checked and tagged accordingly.</p><p>I measured the jitter and packet loss from my voip server&#039;s real time statistics (and comparing with the results from http tests from dslreports.com/speedtest and pingtest.net) while stressing the connection with either a speedtest or a torrent download.<br />From what i understand, bufferbloat in practical terms manifests itself as jitter.</p><p>I ran a couple of tests with qos only, then some tests with sqm only (disabled and stopped qos) and then both sqm and qos just as a last resort attempt.</p><div class="quotebox"><cite>moeller0 wrote:</cite><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;qos-scripts and sqm-scripts basically are ready-made scripts that leverage tc and net filter/iptables so even if you want to roll your own, it is worthwhile to look into those scripts first, there might be some ideas in there that are worth cloning.</p></blockquote></div><p>Yea, thats what i thought.</p><div class="quotebox"><cite>moeller0 wrote:</cite><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;I believe that the linux kernel used in CC got rid of a &quot;routing&quot; cache that the BB kernel still had, which at least for some of the intermediate development releases of CC caused a lower packet forwarding performance. I am not sure to what degree the CC release ameliorated this situation. (The kernel folks argue that the cache was a bad idea and easily exploitable so removed it even though it reduced best-case forwarding performance a bit, if I recall correctly.)</p></blockquote></div><p>This might have been it then. So, i assume that this method increases the peak CPU utilization and consequently some jitter as a trade off for a lower delay (and those eventual vulnerabilities), right? I will read more about this.</p><div class="quotebox"><cite>moeller0 wrote:</cite><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; To quote Dr. Seuss: “Try them, try them, and you may! Try them and you may, I say.” (Green Eggs and Ham), sqm-scripts aim to solve your problem, just test them and see how they perform, but note that up until now sqm and qos scripts both use the same techniques (HTB and fq_codel) and will most likely top out at similar shaper bandwidths.</p></blockquote></div><p>I understand that both use the same techniques, but the question was if both methods (qos vs sqm) affect the traffic the same way, ie affecting all traffic instead of only selected ports/protocols.</p><p>I will try it again more extensively this weekend, just wanted to be more enlightened on the subject.</p><div class="quotebox"><cite>moeller0 wrote:</cite><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; Get a faster router? I believe the wdr3600 might just not be powerful enough for a 100/10 line. I have similar issues with my wndr3700v2 except the wan port is not run through a switch and so the failure mode is more benign, latency stays sane, I just do not reach the specified bandwidth... No idea which router to recommend currently, the archer c7 ae cheap and popular, but I believe fall a bit short for you 110Mbps goalpost, and the linksys WRT1900AC/WRT1200AC/WRT1900ACv2/WRT1900ACS can shape at the speeds you want, but might still have issues with their wireless (or they might not, I did not follow that 333+ pages thread closely).</p></blockquote></div><p>The issue is not important enough for me to go out buying another router. Everything still works, and its not everyday that i top out the download speed. I am aware that i can&#039;t ask for much out of it (it only cost me like 40€ after all) but still curious, because it used to be almost perfect, and now its slightly worse. </p><p>And yea, i read it last time like 2 weeks ago and that was still the case of the (in)famous WRT1900AC</p><p>Thank you very much again.</p><p>Best regards <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p298501">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">moeller0</div>
					<div class="post-datetime">
						3 Nov 2015, 16:28					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jonybat wrote:</cite><blockquote><p>Hi moeller,</p><p>First of all, thank you the extensive reply.</p><div class="quotebox"><cite>moeller0 wrote:</cite><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; I would be quite amazed, if the wdr3600 would be able to push the 110 Mbps combined traffic under BB, typically we see HTB, the shaper qos-scripts use to top out at around 60 to 70 Mbps combined traffic, so that looks weird. I could be that your are just very lucky.</p></blockquote></div><p>Was not 110Mb, but close to 100Mb still. What i remember testing back then was that setting the downstream setting in the qos closer to the real measurable speed (~113/115Mb) would not improve almost anything, and would increase the upstream latency and packet loss during peak usage.</p><p>These are the most recent tests i have:</p><p>Without qos:<br /><a href="http://www.speedtest.net/my-result/4664866406">http://www.speedtest.net/my-result/4664866406</a></p><p>With qos set to 100000/11000:<br /><a href="http://www.speedtest.net/my-result/4664891413">http://www.speedtest.net/my-result/4664891413</a></p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; I would recommend to use the speedtest from <a href="http://www.dslreports.com/speedtest">http://www.dslreports.com/speedtest</a> that allows to measure RTT under load, exactly what you expect to stay nicely low if bufferbloat is well-controled the speedtest.net servers only give the RTT without load... if you register with DSLReports for free you can actually change the settings for the speedtest, I recommend to select at least the check box labeled &quot;Hi-Res BufferBloat:&quot; to get a better understanding of your bufferbloat. Or if the servers can not saturate your link run a &quot;ping -c 100 static.com&quot; concurrently to your speedtest.net tests and look at the maximum ping RTTs.<br /></p><div class="quotebox"><cite>jonybat wrote:</cite><blockquote><br /><div class="quotebox"><cite>moeller0 wrote:</cite><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; So packetloss will increase if you use any shaper as the signal used to tell a sender to slow down is dropping packets (if you enable explicit congestion notification ECN on your computers and your traffic talk to ECN enabled server, then the signal is first not dropping a packet, but marking it in a way that sender and receiver will notice and slow down, then qos or sqm will not increase the packetloss). Jitter shouldn&#039;t increase though. How do you measure jitter and bufferbloat exactly? Also this is with just using qos or also with sqm? What happens if you set the shaper at say 30Mbps for ingress and 10 Mbps for egress, still bad buffering? The wdr3600 moves all packets through its switch which also might be over buffered and if the CPU does not process packets in time the switch will queue insane amounts of packets, so this test tries to see how things perform if the CPU will be able to process the packets easily...</p></blockquote></div><p>Okay, but what if i want to shape/limit all traffic except specific ports, or just limit traffic on specific ports/protocols? From my basic understanding of this, it should only cause delay (and possibly packet loss) on the selected traffic, at the cost of cpu cycles obviously, because all packets need to be checked and tagged accordingly.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; I believe that if you do not shape all your traffic you effectively shape none. If the exempted traffic class, plus the restricted classes generate traffic in excess of your real bandwidth your modem&#039;s and your ISP&#039;s upstream queues will fill up, causing the typical bufferbloat phenomenon of increased latency under load. So you need to shape your total traffic below the link speed (on the upload you have tighter control and can often shape at a very high percentage of the link rate even up to 100%, und the download side you need to shape more aggressively otherwise the upstream queues will fill up anyways).<br /></p><div class="quotebox"><cite>jonybat wrote:</cite><blockquote><p>I measured the jitter and packet loss from my voip server&#039;s real time statistics (and comparing with the results from http tests from dslreports.com/speedtest and pingtest.net) while stressing the connection with either a speedtest or a torrent download.<br />From what i understand, bufferbloat in practical terms manifests itself as jitter.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; What is the total bandwidth of your VoIP server inbound and outbound? fq_codel tries to prioritize sparse traffic by default, but maybe you push too many VoIP packets for it to be classified as sparse?<br /></p><div class="quotebox"><cite>jonybat wrote:</cite><blockquote><p>I ran a couple of tests with qos only, then some tests with sqm only (disabled and stopped qos) and then both sqm and qos just as a last resort attempt.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; Ah, on the same interface qos and sqm are mutually exclusive, even though we do not enforce this, but it certainly is not recommended...<br /></p><div class="quotebox"><cite>jonybat wrote:</cite><blockquote><br /><div class="quotebox"><cite>moeller0 wrote:</cite><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;qos-scripts and sqm-scripts basically are ready-made scripts that leverage tc and net filter/iptables so even if you want to roll your own, it is worthwhile to look into those scripts first, there might be some ideas in there that are worth cloning.</p></blockquote></div><p>Yea, thats what i thought.</p><div class="quotebox"><cite>moeller0 wrote:</cite><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;I believe that the linux kernel used in CC got rid of a &quot;routing&quot; cache that the BB kernel still had, which at least for some of the intermediate development releases of CC caused a lower packet forwarding performance. I am not sure to what degree the CC release ameliorated this situation. (The kernel folks argue that the cache was a bad idea and easily exploitable so removed it even though it reduced best-case forwarding performance a bit, if I recall correctly.)</p></blockquote></div><p>This might have been it then. So, i assume that this method increases the peak CPU utilization and consequently some jitter as a trade off for a lower delay (and those eventual vulnerabilities), right? I will read more about this.</p><div class="quotebox"><cite>moeller0 wrote:</cite><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; To quote Dr. Seuss: “Try them, try them, and you may! Try them and you may, I say.” (Green Eggs and Ham), sqm-scripts aim to solve your problem, just test them and see how they perform, but note that up until now sqm and qos scripts both use the same techniques (HTB and fq_codel) and will most likely top out at similar shaper bandwidths.</p></blockquote></div><p>I understand that both use the same techniques, but the question was if both methods (qos vs sqm) affect the traffic the same way, ie affecting all traffic instead of only selected ports/protocols.</p><p>I will try it again more extensively this weekend, just wanted to be more enlightened on the subject.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; Ah, okay there they are different, qos has an easy GUI for pushing stuff into different priority tiers, sqm does not, it however will look at a packets DSCP bits to decide in which tier to put a packet. Please note that this only holds for simple.qos, simplest.qos is a single band shaper. Also this typically will work well for egress packets, but for ingress you would need to trust all intermediate networks to keep your remote hosts DSCP bits intact, nit something you can usually rely on. But sqm-scripts will allow you to use ingress DSCP bits if you trust your upstreams, just look at the GUI. <br /></p><div class="quotebox"><cite>jonybat wrote:</cite><blockquote><div class="quotebox"><cite>moeller0 wrote:</cite><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; Get a faster router? I believe the wdr3600 might just not be powerful enough for a 100/10 line. I have similar issues with my wndr3700v2 except the wan port is not run through a switch and so the failure mode is more benign, latency stays sane, I just do not reach the specified bandwidth... No idea which router to recommend currently, the archer c7 ae cheap and popular, but I believe fall a bit short for you 110Mbps goalpost, and the linksys WRT1900AC/WRT1200AC/WRT1900ACv2/WRT1900ACS can shape at the speeds you want, but might still have issues with their wireless (or they might not, I did not follow that 333+ pages thread closely).</p></blockquote></div><p>The issue is not important enough for me to go out buying another router. Everything still works, and its not everyday that i top out the download speed. I am aware that i can&#039;t ask for much out of it (it only cost me like 40€ after all) but still curious, because it used to be almost perfect, and now its slightly worse.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; Now, if I could ask a small favor? Could you test sqm&#039;s performance if you set the shaper to say 50/10 Mbps, just to see how much the switch messes up the jitter?<br /></p><div class="quotebox"><cite>jonybat wrote:</cite><blockquote><p>And yea, i read it last time like 2 weeks ago and that was still the case of the (in)famous WRT1900AC</p><p>Thank you very much again.</p><p>Best regards <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p298543">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">jonybat</div>
					<div class="post-datetime">
						3 Nov 2015, 21:49					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>moeller0 wrote:</cite><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; I would recommend to use the speedtest from <a href="http://www.dslreports.com/speedtest">http://www.dslreports.com/speedtest</a> that allows to measure RTT under load, exactly what you expect to stay nicely low if bufferbloat is well-controled the speedtest.net servers only give the RTT without load... if you register with DSLReports for free you can actually change the settings for the speedtest, I recommend to select at least the check box labeled &quot;Hi-Res BufferBloat:&quot; to get a better understanding of your bufferbloat. Or if the servers can not saturate your link run a &quot;ping -c 100 static.com&quot; concurrently to your speedtest.net tests and look at the maximum ping RTTs.</p></blockquote></div><p>Thanks, I&#039;ll do that next time i run the tests.</p><div class="quotebox"><cite>moeller0 wrote:</cite><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; I believe that if you do not shape all your traffic you effectively shape none. If the exempted traffic class, plus the restricted classes generate traffic in excess of your real bandwidth your modem&#039;s and your ISP&#039;s upstream queues will fill up, causing the typical bufferbloat phenomenon of increased latency under load. So you need to shape your total traffic below the link speed (on the upload you have tighter control and can often shape at a very high percentage of the link rate even up to 100%, und the download side you need to shape more aggressively otherwise the upstream queues will fill up anyways).</p></blockquote></div><p>Right, thats why in the qos configuration it is needed to configure the interface section. I guess i need to read some more about this, because that queue logic is still not clear in my head.</p><div class="quotebox"><cite>moeller0 wrote:</cite><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; What is the total bandwidth of your VoIP server inbound and outbound? fq_codel tries to prioritize sparse traffic by default, but maybe you push too many VoIP packets for it to be classified as sparse?</p></blockquote></div><div class="quotebox"><cite>moeller0 wrote:</cite><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; Ah, okay there they are different, qos has an easy GUI for pushing stuff into different priority tiers, sqm does not, it however will look at a packets DSCP bits to decide in which tier to put a packet. Please note that this only holds for simple.qos, simplest.qos is a single band shaper. Also this typically will work well for egress packets, but for ingress you would need to trust all intermediate networks to keep your remote hosts DSCP bits intact, nit something you can usually rely on. But sqm-scripts will allow you to use ingress DSCP bits if you trust your upstreams, just look at the GUI.</p></blockquote></div><p>I should have mentioned this before, but the voip server is not a typical SIP server. It is a proprietary solution (teamspeak), with a proprietary protocol that does not comply with QoS/DSCP. So, i guess that if i were to rely solely on sqm i would need some kind of iptables rule to tag packets based on the voip server ports, to have the same effect that of qos with the traffic classes.</p><div class="quotebox"><cite>moeller0 wrote:</cite><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; Ah, on the same interface qos and sqm are mutually exclusive, even though we do not enforce this, but it certainly is not recommended...</p></blockquote></div><p>Yea, i figured that out when i was reading about it. I just gave it a go to see what would happen, and the feeling is that sqm has precedence over qos.</p><div class="quotebox"><cite>moeller0 wrote:</cite><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; Now, if I could ask a small favor? Could you test sqm&#039;s performance if you set the shaper to say 50/10 Mbps, just to see how much the switch messes up the jitter?</p></blockquote></div><p>I will get back to you on this, most likely on the weekend. I dont want to do these kind of tests during prime time <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Regards,<br />Jonybat</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p298549">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">moeller0</div>
					<div class="post-datetime">
						3 Nov 2015, 22:30					</div>
				</div>
				<div class="post-content content">
					<p>Hi jonybat,</p><div class="quotebox"><cite>jonybat wrote:</cite><blockquote><div class="quotebox"><cite>moeller0 wrote:</cite><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; I would recommend to use the speedtest from <a href="http://www.dslreports.com/speedtest">http://www.dslreports.com/speedtest</a> that allows to measure RTT under load, exactly what you expect to stay nicely low if bufferbloat is well-controled the speedtest.net servers only give the RTT without load... if you register with DSLReports for free you can actually change the settings for the speedtest, I recommend to select at least the check box labeled &quot;Hi-Res BufferBloat:&quot; to get a better understanding of your bufferbloat. Or if the servers can not saturate your link run a &quot;ping -c 100 static.com&quot; concurrently to your speedtest.net tests and look at the maximum ping RTTs.</p></blockquote></div><p>Thanks, I&#039;ll do that next time i run the tests.</p><div class="quotebox"><cite>moeller0 wrote:</cite><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; I believe that if you do not shape all your traffic you effectively shape none. If the exempted traffic class, plus the restricted classes generate traffic in excess of your real bandwidth your modem&#039;s and your ISP&#039;s upstream queues will fill up, causing the typical bufferbloat phenomenon of increased latency under load. So you need to shape your total traffic below the link speed (on the upload you have tighter control and can often shape at a very high percentage of the link rate even up to 100%, und the download side you need to shape more aggressively otherwise the upstream queues will fill up anyways).</p></blockquote></div><p>Right, thats why in the qos configuration it is needed to configure the interface section. I guess i need to read some more about this, because that queue logic is still not clear in my head.</p><div class="quotebox"><cite>moeller0 wrote:</cite><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; What is the total bandwidth of your VoIP server inbound and outbound? fq_codel tries to prioritize sparse traffic by default, but maybe you push too many VoIP packets for it to be classified as sparse?</p></blockquote></div><div class="quotebox"><cite>moeller0 wrote:</cite><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; Ah, okay there they are different, qos has an easy GUI for pushing stuff into different priority tiers, sqm does not, it however will look at a packets DSCP bits to decide in which tier to put a packet. Please note that this only holds for simple.qos, simplest.qos is a single band shaper. Also this typically will work well for egress packets, but for ingress you would need to trust all intermediate networks to keep your remote hosts DSCP bits intact, nit something you can usually rely on. But sqm-scripts will allow you to use ingress DSCP bits if you trust your upstreams, just look at the GUI.</p></blockquote></div><p>I should have mentioned this before, but the voip server is not a typical SIP server. It is a proprietary solution (teamspeak), with a proprietary protocol that does not comply with QoS/DSCP. So, i guess that if i were to rely solely on sqm i would need some kind of iptables rule to tag packets based on the voip server ports, to have the same effect that of qos with the traffic classes.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; So either you have the application set the DSCP makings, or the computer hosting that service or worst case the router. If the traffic is sparse enough though fq_codel should try to boost it compared to bulk flows though, it will not work to well against multiple starting tcp flows in the same priority tier, so using DSCP markings probably is a good idea. If you need to do this in the router it might get a bit tricky as on the wan interface you (at least partly) see the post NAT addresses...<br /></p><div class="quotebox"><cite>jonybat wrote:</cite><blockquote><div class="quotebox"><cite>moeller0 wrote:</cite><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; Ah, on the same interface qos and sqm are mutually exclusive, even though we do not enforce this, but it certainly is not recommended...</p></blockquote></div><p>Yea, i figured that out when i was reading about it. I just gave it a go to see what would happen, and the feeling is that sqm has precedence over qos.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; I think I recall both start out with cleaning up the interface you activate them on, so this might explain why the later one survives... (iunder hotplug sqm comes after qos, so this might be the reason why only sqm survives...)<br /></p><div class="quotebox"><cite>jonybat wrote:</cite><blockquote><div class="quotebox"><cite>moeller0 wrote:</cite><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; Now, if I could ask a small favor? Could you test sqm&#039;s performance if you set the shaper to say 50/10 Mbps, just to see how much the switch messes up the jitter?</p></blockquote></div><p>I will get back to you on this, most likely on the weekend. I dont want to do these kind of tests during prime time <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Regards,<br />Jonybat</p></blockquote></div><p>Oh, please take your time, it is just rare to find someone with such an interesting setup, that getting a bit of data that might help improve sqm-scripts is worth a short wait <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>Best Regards<br />&nbsp; &nbsp; &nbsp; &nbsp;M.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p298976">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">jonybat</div>
					<div class="post-datetime">
						8 Nov 2015, 12:57					</div>
				</div>
				<div class="post-content content">
					<p>Ok, now that i had the time to control the environment of the tests, i see that my initial impressions were not accurate. It might just have been a bad couple of tests, or something else causing the problem. Everything seems to be working just fine with QoS, so my issue is resolved.</p><p>Anyway, here are the tests as promised:</p><h5>No QoS</h5><p>Increased connection latency by ~200ms and packet loss by 10% to 15% (and increasing), around 60% CPU usage on downstream test<br /><a href="http://www.dslreports.com/speedtest/1884726">http://www.dslreports.com/speedtest/1884726</a><br /><a href="http://www.dslreports.com/speedtest/1884781">http://www.dslreports.com/speedtest/1884781</a></p><p><a href="http://www.speedtest.net/my-result/4814419900">http://www.speedtest.net/my-result/4814419900</a><br /><a href="http://www.speedtest.net/my-result/4814439678">http://www.speedtest.net/my-result/4814439678</a></p><br /><h5>QoS to 100000/11500, VoIP ports set to express</h5><p>No noticeable increase in connection latency, jitter or packet loss, CPU usage of 90%+ on downstream test<br /><a href="http://www.dslreports.com/speedtest/1884758">http://www.dslreports.com/speedtest/1884758</a><br /><a href="http://www.dslreports.com/speedtest/1884765">http://www.dslreports.com/speedtest/1884765</a></p><p><a href="http://www.speedtest.net/my-result/4814424297">http://www.speedtest.net/my-result/4814424297</a><br /><a href="http://www.speedtest.net/my-result/4814435227">http://www.speedtest.net/my-result/4814435227</a></p><br /><p>Setting SQM to eth0 100000/11500 caps both download and upload to ~10Mb, inverting the upload and download values gives the same result. Setting the same thing to eth0.1 makes the router freeze. Worked on eth0.2 after restarting the process</p><br /><h5>SQM to 100000/11500, simple.qos</h5><p>Same results as with the QoS enabled, except that the CPU was constantly at 100%<br /><a href="http://www.dslreports.com/speedtest/1884839">http://www.dslreports.com/speedtest/1884839</a></p><p><a href="http://www.speedtest.net/my-result/4814476926">http://www.speedtest.net/my-result/4814476926</a></p><br /><h5>SQM to 100000/11500, simplest.qos</h5><p>Same as before, with a CPU usage comparable with the QoS enabled runs<br /><a href="http://www.dslreports.com/speedtest/1884859">http://www.dslreports.com/speedtest/1884859</a></p><p><a href="http://www.speedtest.net/my-result/4814486447">http://www.speedtest.net/my-result/4814486447</a></p><br /><h5>SQM to 50000/11500, simple.qos</h5><p>Same results again, bw shaping working as expected, CPU usage on downstream test of around 60%<br /><a href="http://www.dslreports.com/speedtest/1884890">http://www.dslreports.com/speedtest/1884890</a></p><p><a href="http://www.speedtest.net/my-result/4814505295">http://www.speedtest.net/my-result/4814505295</a></p><br /><p>piece_of_cake.qos, layer_cake.qos and nxt_routed_hsfc.qos do not seem to work out of the box</p><br /><h5>QoS tests again</h5><p><a href="http://www.dslreports.com/speedtest/1884906">http://www.dslreports.com/speedtest/1884906</a></p><p><a href="http://www.speedtest.net/my-result/4814515826">http://www.speedtest.net/my-result/4814515826</a></p><br /><p>If you need more information, please ask <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>Best regards,<br />Jonybat</p>											<p class="post-edited">(Last edited by <strong>jonybat</strong> on 8 Nov 2015, 12:59)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p298982">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">moeller0</div>
					<div class="post-datetime">
						8 Nov 2015, 13:59					</div>
				</div>
				<div class="post-content content">
					<p>Hi jonybat,</p><p>thanks a lot for your persistence and performing all these tests.</p><div class="quotebox"><cite>jonybat wrote:</cite><blockquote><p>Ok, now that i had the time to control the environment of the tests, i see that my initial impressions were not accurate. It might just have been a bad couple of tests, or something else causing the problem. Everything seems to be working just fine with QoS, so my issue is resolved.</p><p>Anyway, here are the tests as promised:</p><h5>No QoS</h5><p>Increased connection latency by ~200ms and packet loss by 10% to 15% (and increasing), around 60% CPU usage on downstream test<br /><a href="http://www.dslreports.com/speedtest/1884726">http://www.dslreports.com/speedtest/1884726</a><br /><a href="http://www.dslreports.com/speedtest/1884781">http://www.dslreports.com/speedtest/1884781</a></p><p><a href="http://www.speedtest.net/my-result/4814419900">http://www.speedtest.net/my-result/4814419900</a><br /><a href="http://www.speedtest.net/my-result/4814439678">http://www.speedtest.net/my-result/4814439678</a></p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; I would say, bandwidth is great, but latency under load painful. I also want to note that the dslreports test is so much nicher/more informative than the speedtest.net one. I really hope that speedtest/ookla will up their game soon and also offer a latency under load measurement. (Ideally both dslreports and speedtest would also offer a bidirectional test, with concurrent instead of sequential up- and downloads).<br /></p><div class="quotebox"><cite>jonybat wrote:</cite><blockquote><h5>QoS to 100000/11500, VoIP ports set to express</h5><p>No noticeable increase in connection latency, jitter or packet loss, CPU usage of 90%+ on downstream test<br /><a href="http://www.dslreports.com/speedtest/1884758">http://www.dslreports.com/speedtest/1884758</a><br /><a href="http://www.dslreports.com/speedtest/1884765">http://www.dslreports.com/speedtest/1884765</a></p><p><a href="http://www.speedtest.net/my-result/4814424297">http://www.speedtest.net/my-result/4814424297</a><br /><a href="http://www.speedtest.net/my-result/4814435227">http://www.speedtest.net/my-result/4814435227</a></p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The latency increase under load, especially for the download direction is a bit large for my taste (from ~60ms idle to 120ms under load, I would probably shape the downstream more aggressively to say 90000), but certainly something one can live with.<br /></p><div class="quotebox"><cite>jonybat wrote:</cite><blockquote><br /><p>Setting SQM to eth0 100000/11500 caps both download and upload to ~10Mb, inverting the upload and download values gives the same result. Setting the same thing to eth0.1 makes the router freeze. Worked on eth0.2 after restarting the process</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Something went wrong there, but interesting that a restart (of the router?) fixed the problem. I note that having both sqm and qos active without a reboot in between is probably under tested and sqm does not really give a reasonable information whether the initialization succeeded or whether it stopped in the middle...<br /></p><div class="quotebox"><cite>jonybat wrote:</cite><blockquote><h5>SQM to 100000/11500, simple.qos</h5><p>Same results as with the QoS enabled, except that the CPU was constantly at 100%<br /><a href="http://www.dslreports.com/speedtest/1884839">http://www.dslreports.com/speedtest/1884839</a></p><p><a href="http://www.speedtest.net/my-result/4814476926">http://www.speedtest.net/my-result/4814476926</a></p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;I beg to differ, latency under load is much better confined than in the qos-scripts tests, this is how I believe it should be <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /><br /></p><div class="quotebox"><cite>jonybat wrote:</cite><blockquote><h5>SQM to 100000/11500, simplest.qos</h5><p>Same as before, with a CPU usage comparable with the QoS enabled runs<br /><a href="http://www.dslreports.com/speedtest/1884859">http://www.dslreports.com/speedtest/1884859</a></p><p><a href="http://www.speedtest.net/my-result/4814486447">http://www.speedtest.net/my-result/4814486447</a></p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;And that also looks great.<br /></p><div class="quotebox"><cite>jonybat wrote:</cite><blockquote><h5>SQM to 50000/11500, simple.qos</h5><p>Same results again, bw shaping working as expected, CPU usage on downstream test of around 60%<br /><a href="http://www.dslreports.com/speedtest/1884890">http://www.dslreports.com/speedtest/1884890</a></p><p><a href="http://www.speedtest.net/my-result/4814505295">http://www.speedtest.net/my-result/4814505295</a></p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Nice latency unde load again.<br /></p><div class="quotebox"><cite>jonybat wrote:</cite><blockquote><p>piece_of_cake.qos, layer_cake.qos and nxt_routed_hsfc.qos do not seem to work out of the box</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This is partly expected, piece_of_cake and layer_cake require the cake qdisc, which is not yet in openwrt (because it is still under heavy development); nxt_routed_hsfc also has some requirements that might not be fulfilled by a normal openwrt build.<br /></p><div class="quotebox"><cite>jonybat wrote:</cite><blockquote><h5>QoS tests again</h5><p><a href="http://www.dslreports.com/speedtest/1884906">http://www.dslreports.com/speedtest/1884906</a></p><p><a href="http://www.speedtest.net/my-result/4814515826">http://www.speedtest.net/my-result/4814515826</a></p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;This looks almost as nice as the sqm-scripts tests, so there seems to be quite some variability in your tests (which might show congestion upstream of your link, so something you will have to live with...)<br /></p><div class="quotebox"><cite>jonybat wrote:</cite><blockquote><p>If you need more information, please ask <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>Best regards,<br />Jonybat</p></blockquote></div><p>Thanks again for the thorough testing. I am quite happy that things seem to work at your end, just as they are expected to <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" />.</p><p>Best Regards<br />&nbsp; &nbsp; &nbsp; &nbsp; M.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p298993">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">jonybat</div>
					<div class="post-datetime">
						8 Nov 2015, 15:17					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>moeller0 wrote:</cite><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; I would say, bandwidth is great, but latency under load painful. I also want to note that the dslreports test is so much nicher/more informative than the speedtest.net one. I really hope that speedtest/ookla will up their game soon and also offer a latency under load measurement. (Ideally both dslreports and speedtest would also offer a bidirectional test, with concurrent instead of sequential up- and downloads).</p></blockquote></div><p>I am aware. I just provided those tests as a baseline, without any kind of shaping.</p><div class="quotebox"><cite>moeller0 wrote:</cite><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The latency increase under load, especially for the download direction is a bit large for my taste (from ~60ms idle to 120ms under load, I would probably shape the downstream more aggressively to say 90000), but certainly something one can live with.</p></blockquote></div><p>Im usually more worried about the upstream, so this is not a big deal to me. I gave it a go anyway:<br /><a href="http://www.dslreports.com/speedtest/1885365">http://www.dslreports.com/speedtest/1885365</a></p><p>And the 100000/11500 again:<br /><a href="http://www.dslreports.com/speedtest/1885382">http://www.dslreports.com/speedtest/1885382</a></p><p>It all seems pretty much the same to me. I think that the small difference in latency falls within the margin of error.</p><div class="quotebox"><cite>moeller0 wrote:</cite><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Something went wrong there, but interesting that a restart (of the router?) fixed the problem. I note that having both sqm and qos active without a reboot in between is probably under tested and sqm does not really give a reasonable information whether the initialization succeeded or whether it stopped in the middle...</p></blockquote></div><p>I disabled and stopped qos before installing sqm &gt; set sqm to eth0 &gt; test &gt; set it to eth0.1 &gt; froze &gt; rebooted router &gt; set it to eth0 &gt; test &gt; set it to eth0.2 &gt; failed test &gt; reboot sqm process/service &gt; test ok.</p><div class="quotebox"><cite>moeller0 wrote:</cite><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;I beg to differ, latency under load is much better confined than in the qos-scripts tests, this is how I believe it should be <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p></blockquote></div><p>The comments i wrote about the tests were solely based on what i saw from the router and voip server real time statistics, not the results of the tests. I should have mentioned it</p><p>Regards,<br />Jonybat</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p299035">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">moeller0</div>
					<div class="post-datetime">
						8 Nov 2015, 19:50					</div>
				</div>
				<div class="post-content content">
					<p>Hi jonybat,</p><div class="quotebox"><cite>jonybat wrote:</cite><blockquote><div class="quotebox"><cite>moeller0 wrote:</cite><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; I would say, bandwidth is great, but latency under load painful. I also want to note that the dslreports test is so much nicher/more informative than the speedtest.net one. I really hope that speedtest/ookla will up their game soon and also offer a latency under load measurement. (Ideally both dslreports and speedtest would also offer a bidirectional test, with concurrent instead of sequential up- and downloads).</p></blockquote></div><p>I am aware. I just provided those tests as a baseline, without any kind of shaping.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; Oh, sorry, since you collected the data, I just wanted to describe the issue for people stumbling over the thread and so that we have a baseline. The comment about the speed tests mainly is for the same crowd; I should have made that clearer.<br /></p><div class="quotebox"><cite>jonybat wrote:</cite><blockquote><div class="quotebox"><cite>moeller0 wrote:</cite><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;The latency increase under load, especially for the download direction is a bit large for my taste (from ~60ms idle to 120ms under load, I would probably shape the downstream more aggressively to say 90000), but certainly something one can live with.</p></blockquote></div><p>Im usually more worried about the upstream, so this is not a big deal to me. I gave it a go anyway:<br /><a href="http://www.dslreports.com/speedtest/1885365">http://www.dslreports.com/speedtest/1885365</a></p><p>And the 100000/11500 again:<br /><a href="http://www.dslreports.com/speedtest/1885382">http://www.dslreports.com/speedtest/1885382</a></p><p>It all seems pretty much the same to me. I think that the small difference in latency falls within the margin of error.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; I guess I agree.<br /></p><div class="quotebox"><cite>jonybat wrote:</cite><blockquote><div class="quotebox"><cite>moeller0 wrote:</cite><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Something went wrong there, but interesting that a restart (of the router?) fixed the problem. I note that having both sqm and qos active without a reboot in between is probably under tested and sqm does not really give a reasonable information whether the initialization succeeded or whether it stopped in the middle...</p></blockquote></div><p>I disabled and stopped qos before installing sqm &gt; set sqm to eth0 &gt; test &gt; set it to eth0.1 &gt; froze &gt; rebooted router &gt; set it to eth0 &gt; test &gt; set it to eth0.2 &gt; failed test &gt; reboot sqm process/service &gt; test ok.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; Now I am confused, what is the correct interface in your case? But if it works then all is good...<br /></p><div class="quotebox"><cite>jonybat wrote:</cite><blockquote><div class="quotebox"><cite>moeller0 wrote:</cite><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;I beg to differ, latency under load is much better confined than in the qos-scripts tests, this is how I believe it should be <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p></blockquote></div><p>The comments i wrote about the tests were solely based on what i saw from the router and voip server real time statistics, not the results of the tests. I should have mentioned it</p><p>Regards,<br />Jonybat</p></blockquote></div><p>ah, then disregard my observations, measuring the relevant parameters directly at the relevant application is way better then taking a ping RTT as proxy. I am quite happy about the fact that both qos and sqm seem to work well on your link. It is a bit sad that sqm especially does not give enough feed-back to figure out whether it is operational. That is on my TODO list now...</p><p>Best Regards<br />&nbsp; &nbsp; &nbsp; &nbsp; M.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p299059">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">jonybat</div>
					<div class="post-datetime">
						8 Nov 2015, 23:23					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>moeller0 wrote:</cite><blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; Now I am confused, what is the correct interface in your case? But if it works then all is good...</p></blockquote></div><p>The correct interface would be the wan interface, which is eth0.2 in my case, afaik.</p><div class="quotebox"><cite>moeller0 wrote:</cite><blockquote><p>ah, then disregard my observations, measuring the relevant parameters directly at the relevant application is way better then taking a ping RTT as proxy. I am quite happy about the fact that both qos and sqm seem to work well on your link. It is a bit sad that sqm especially does not give enough feed-back to figure out whether it is operational. That is on my TODO list now...</p></blockquote></div><p>You and me both, at least for now <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Thank you for all your help.</p><p>Best regards,<br />Jonybat</p>											<p class="post-edited">(Last edited by <strong>jonybat</strong> on 9 Nov 2015, 01:20)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p301626">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">hobbit_ayla</div>
					<div class="post-datetime">
						29 Nov 2015, 12:34					</div>
				</div>
				<div class="post-content content">
					<p>Hi</p><p>Am ai a little lost here. If I understand correctly the SQM help to have a more smooth connection when you have multiple different connections to Internet.<br />I have a WDR3600 with BB and when I make test with it with SQM enable a disable I have big differences on speed to worst in same cases.</p><p>I have a 200/20 fiber connection with Vodafone and the tests where made with 95% of the speed.</p><p>If I use SpeedTest I have 170Mb with SQM disable and 90 with SQM enable.<br />however, with DSLReports I have 65 with SQM disable and 90 with SQM enable.</p><p>Seems that speed with one download is worst with SQM.</p><p>Should be like this?</p><p>Thanks for you help</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p301683">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">moeller0</div>
					<div class="post-datetime">
						29 Nov 2015, 19:04					</div>
				</div>
				<div class="post-content content">
					<p>Hi hobbit_ayla,</p><div class="quotebox"><cite>hobbit_ayla wrote:</cite><blockquote><p>Hi</p><p>Am ai a little lost here. If I understand correctly the SQM help to have a more smooth connection when you have multiple different connections to Internet.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; Not the typical way to describe it; sqm should help to keep latency on your link low even when you are saturating the link...<br /></p><div class="quotebox"><cite>hobbit_ayla wrote:</cite><blockquote><p>I have a WDR3600 with BB and when I make test with it with SQM enable a disable I have big differences on speed to worst in same cases.</p><p>I have a 200/20 fiber connection with Vodafone and the tests where made with 95% of the speed.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; I do not really want to disappoint you, but the WDR3600 simply is not powerful enough to allow the use of a shaper on such a link. Typically I would assume that sqm will top out around 70-80 Mbps combined download and upload, so for your link you either need to stop using sqm-scripts or accept that you will barely be able to use half of your link&#039;s capacity...<br /></p><div class="quotebox"><cite>hobbit_ayla wrote:</cite><blockquote><p>If I use SpeedTest I have 170Mb with SQM disable and 90 with SQM enable.<br />however, with DSLReports I have 65 with SQM disable and 90 with SQM enable.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; So as stated above the wdr3600 simply is not fast enough to be used as a decent router at a link like yours...<br /></p><div class="quotebox"><cite>hobbit_ayla wrote:</cite><blockquote><p>Seems that speed with one download is worst with SQM.</p><p>Should be like this?</p><p>Thanks for you help</p></blockquote></div><p>No, it should not be like this, but unfortunately, there are only two rap options, either buy newer stronger hardware for your router, or accept that you leave half your link idle all the time...<br />&nbsp; &nbsp; &nbsp; &nbsp; There a basically two options for better hardware, either use a router with hardware-accelerated network processing (though these often only work with the proprietary firmware that comes with the router, you would need to say goodbye to openwrt, but the ubiquity network edge router lite or edge router X might work for you) or get something with a CPU fast enough to handle the required processing at your link speeds (besides x86 based machines with 2 NICs the jury is still out which device might be able to work well enough, though the linksys wrt1200ac, and wrt1900acv2 or wrt1900acs seem like decent candidates).</p><p>Best Regards<br />&nbsp; &nbsp; &nbsp; &nbsp; M.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p301884">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">hobbit_ayla</div>
					<div class="post-datetime">
						1 Dec 2015, 01:03					</div>
				</div>
				<div class="post-content content">
					<p>Hi:</p><p>Thanks for you replay. </p><p>So, after some reading, if I understand this is more with control the stream speed to avoid the latency that could exist on circuit. That could will give a lower speed but a more constant transmission rate.</p><p>Regarding the rest, Ok, I have a not so powerful router <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> and so for me, that mainly use browser surfing and email I think it&#039;s best use the full speed than lose half of it. At two weeks ago I still have a ADSL with 14Mb, perhaps there could help in some way.<br />I take a inspection on the above Linksys router but they are a little expensive just for this. </p><p>Thanks again for your help</p><p>CGR</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p312044">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">FurryNutz</div>
					<div class="post-datetime">
						18 Feb 2016, 21:45					</div>
				</div>
				<div class="post-content content">
					<p>Hello OpenWRT community. <br />I maybe new to this forum however not new to routers and other forums. </p><p>So after I was able to get some time and with discussion on a different forum about using OpenWRT, I decided to give it a try. I have loaded code that I found from this link here for the model router in question:<br /><a href="https://wiki.openwrt.org/toh/d-link/dgl-5500">https://wiki.openwrt.org/toh/d-link/dgl-5500</a></p><p>After getting that installed I was directed to install the SQM install package and after a bump with that, that was successfully installed. </p><p>So reviewing the wiki on Basic SQM set up, I attempted to configure what I believe is either ETH0 or ETH0.2 which looking at the live status on the interfaces on this particular router, it shows LAN and WAN and WAN6. Under WAN it lists ETH0.2 Uptime is graduating as well and data is being reported there. Data is being reported on WAN6 however the up time is not progressing. <br />Am I using the correct WAN or ETH interface? Using ETH0 didn&#039;t seem to do anything and not sure if expected behaviors of SQM and configuring the interfaces is correct. <br />Do I need to configure LAN and WAN? </p><br /><p>I set up SQM per the wiki and just using default settings. I did run a couple of speed tests on both speedtest.net and dslreports. I let UP and Down link speeds for 100/3 instead of 85% initially to see what results I would get. All was ok on both sites and actually saw 114Mb here and there, however dslreports bufferbloat got F and D for results. I noticed that the Up speed the BB gas gauge was displaying 600-800+ms during the test runs which ended in bad grades. Download tests were mostly green and low and around 10-20ms. I&#039;d like to get better grades if possible for BB.</p><p>So I changed the UP and Down link speeds in SQM to 85Mb and 2Mb prospectively. Saved settings and rebooted and I believe to ensure the settings saved and enabled, I always reboot the router. I ran tests again and both speedtest and dslreports both reported around 100mb and 2.8mb speeds. Maybe I presume that setting a lower speed rate would results in seeing lower speed test results or I&#039;m not fully understanding of the behavior of the SQM settings and actual speed results and what should be seen. Please let me know what I should expect to see after changing speeds, if any. </p><p>I noticed that if I set 1Mb on the Up and 85Mb on the Down, that for some reason my PC loss connection to the router and lost it&#039;s IP address. After setting SQM back to max 100/3 and rebooting, the PC and all other devices started working again. So I presume there was a configuration issue here. </p><p>I left SQM at default settings last nite and played BO3 last nite and over all gaming was ok. Ping times in the game were always between 60ms and 100ms. I wasn&#039;t hosting and was playing with others. I&#039;d like to know if there maybe some direction on setting up SQM for gaming for optimal performance. I know that there is a lot to deal with in all of this. I&#039;m the only one using the internet at night when I game so I&#039;m wonder does SQM could be set to max values or do I still need to set 85% of each speed link since the xbox is the only thing using bandwidth. I may have my laptop next to me for some quick info however nothing else is going on during gaming. Thoughts and ideas? </p><p>I found that 2.4Ghz features are viewable on the router however 5Ghz configuration is missing. Is there something I missed here to get 5Ghz wifi? Ya, I know the 5500 does have the greatest WiFi however it supports both radios. I have wifi disabled on it currently and using a 2ndary wired in AP that has better wifi abilities. </p><p>If someone can review this and please give a step by step instruction on things to do and check first, I&#039;d appreciated greatly. </p><p>Over all the router seems to be working well with OpenWRT and i&#039;m interested to see if it can be a good alternative for users of the 5500 for gaming if possible. </p><p>Thank you for your time.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p312053">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">moeller0</div>
					<div class="post-datetime">
						18 Feb 2016, 22:47					</div>
				</div>
				<div class="post-content content">
					<p>Hi FurryNutz,</p><p>I believe this might have justified a new post <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><div class="quotebox"><cite>FurryNutz wrote:</cite><blockquote><p>Hello OpenWRT community. <br />I maybe new to this forum however not new to routers and other forums. </p><p>So after I was able to get some time and with discussion on a different forum about using OpenWRT, I decided to give it a try. I have loaded code that I found from this link here for the model router in question:<br /><a href="https://wiki.openwrt.org/toh/d-link/dgl-5500">https://wiki.openwrt.org/toh/d-link/dgl-5500</a></p><p>After getting that installed I was directed to install the SQM install package and after a bump with that, that was successfully installed. </p><p>So reviewing the wiki on Basic SQM set up, I attempted to configure what I believe is either ETH0 or ETH0.2 which looking at the live status on the interfaces on this particular router, it shows LAN and WAN and WAN6. Under WAN it lists ETH0.2 Uptime is graduating as well and data is being reported there. Data is being reported on WAN6 however the up time is not progressing. <br />Am I using the correct WAN or ETH interface? Using ETH0 didn&#039;t seem to do anything and not sure if expected behaviors of SQM and configuring the interfaces is correct. <br />Do I need to configure LAN and WAN?</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; You should pick the same interface as is used by WAN, at least typically, so eth0.2 sounds about right.<br /></p><div class="quotebox"><cite>FurryNutz wrote:</cite><blockquote><p>I set up SQM per the wiki and just using default settings. I did run a couple of speed tests on both speedtest.net and dslreports. I let UP and Down link speeds for 100/3 instead of 85% initially to see what results I would get. All was ok on both sites and actually saw 114Mb here and there, however dslreports bufferbloat got F and D for results. I noticed that the Up speed the BB gas gauge was displaying 600-800+ms during the test runs which ended in bad grades. Download tests were mostly green and low and around 10-20ms. I&#039;d like to get better grades if possible for BB.</p><p>So I changed the UP and Down link speeds in SQM to 85Mb and 2Mb prospectively. Saved settings and rebooted and I believe to ensure the settings saved and enabled, I always reboot the router.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; Rebooting is not required for sqm-scripts, but please post the result of &quot;tc -d qdisc&quot; from immediately after booting and the output from then running &quot;/etc/init.d/sqm stop ; tc -d qdisc ; /etc/init.d/sqm start ; tc -d qdisc ; cat /etc/config/sqm&quot;&nbsp; &nbsp; &nbsp; &nbsp; <br /></p><div class="quotebox"><cite>FurryNutz wrote:</cite><blockquote><br /><br /><p>I ran tests again and both speedtest and dslreports both reported around 100mb and 2.8mb speeds.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; For set rates of 85 and 2 these results are wrong, so something seems off.&nbsp; &nbsp; &nbsp; &nbsp;<br /></p><div class="quotebox"><cite>FurryNutz wrote:</cite><blockquote><p>Maybe I presume that setting a lower speed rate would results in seeing lower speed test results or I&#039;m not fully understanding of the behavior of the SQM settings and actual speed results and what should be seen. Please let me know what I should expect to see after changing speeds, if any.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; No, your assumption is correct, I would assume that something is not working right. You might want to follow the instructions on README.md on <a href="https://github.com/tohojo/sqm-scripts">https://github.com/tohojo/sqm-scripts</a> to get the most recent sqm-scripts version to rule out running into already fixed bugs....<br /></p><div class="quotebox"><cite>FurryNutz wrote:</cite><blockquote><p>I noticed that if I set 1Mb on the Up and 85Mb on the Down, that for some reason my PC loss connection to the router and lost it&#039;s IP address. After setting SQM back to max 100/3 and rebooting, the PC and all other devices started working again. So I presume there was a configuration issue here.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; This is also weird, while 1/85 should be slow it also should work, please note that sqm expects the bandwidth in kbps, so enter 1000 for 1Mbps (I am sure you did it right, I just want to cross all ts and dot all is here).<br /></p><div class="quotebox"><cite>FurryNutz wrote:</cite><blockquote><p>I left SQM at default settings last nite and played BO3 last nite and over all gaming was ok. Ping times in the game were always between 60ms and 100ms.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; Is that the normal range without sqm and without network load?<br /></p><div class="quotebox"><cite>FurryNutz wrote:</cite><blockquote><p>I wasn&#039;t hosting and was playing with others. I&#039;d like to know if there maybe some direction on setting up SQM for gaming for optimal performance. I know that there is a lot to deal with in all of this. I&#039;m the only one using the internet at night when I game so I&#039;m wonder does SQM could be set to max values or do I still need to set 85% of each speed link since the xbox is the only thing using bandwidth. I may have my laptop next to me for some quick info however nothing else is going on during gaming. Thoughts and ideas?</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; Well if your network is not saturated/loaded than sqm is not going to give any advantage, so at best it is going to be neutral for your night sessions; it really comes into play once congestion occurrs, then it will show big advantages. So a better test might be playing while causing a big load (several up and downloads /speedtest) on other machines in the network. Note I do not recommend the additional load for your normal gaming sessions just for testing/measuring <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /><br /></p><div class="quotebox"><cite>FurryNutz wrote:</cite><blockquote><p>I found that 2.4Ghz features are viewable on the router however 5Ghz configuration is missing. Is there something I missed here to get 5Ghz wifi? Ya, I know the 5500 does have the greatest WiFi however it supports both radios. I have wifi disabled on it currently and using a 2ndary wired in AP that has better wifi abilities.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; No idea here, I guess you need to drag in the ath10k experts, potentially in a new thread with a better name/topic?</p><p>Best Regards<br />&nbsp; &nbsp; &nbsp; &nbsp; M.</p><div class="quotebox"><cite>FurryNutz wrote:</cite><blockquote><p>If someone can review this and please give a step by step instruction on things to do and check first, I&#039;d appreciated greatly. </p><p>Over all the router seems to be working well with OpenWRT and i&#039;m interested to see if it can be a good alternative for users of the 5500 for gaming if possible. </p><p>Thank you for your time.</p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p312056">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">FurryNutz</div>
					<div class="post-datetime">
						18 Feb 2016, 23:29					</div>
				</div>
				<div class="post-content content">
					<p>M, Thank you for all the feedback. Wheew. </p><p>Ya I wasn&#039;t sure if I should start a new thread or not. Figured this would be ok since it&#039;s similar topic. I can if needed. </p><p>I install the most recent code at the time and that was Jan 31st time frame. Would this be up to date for SQM packages or will I still need to update them? </p><p>Since I&#039;m a single user at night, do you think I need to enable SQM at all and just leave it disabled? I guess since xbox is the only thing doing any bandwidth, sounds like SQM can be disabled. </p><p>One thought, would SQM be an advantage to have enabled for systems with two or more game consoles going at the same time? </p><p>Regarding captures, I&#039;ll try to post these as soon as I can. </p><p>I&#039;ll run some tests with it enabled and disabled to check bufferbloat and pings while gaming. I presume this is a variable with SQM? I may connect PC and xbox direct to ISP modem and check pings there too. </p><p>Is there a recommended forum to post about the 5Ghz radio support? General Discussions ok? </p><p>Thank you for all feedback and your time.</p>											<p class="post-edited">(Last edited by <strong>FurryNutz</strong> on 18 Feb 2016, 23:31)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p312083">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">FurryNutz</div>
					<div class="post-datetime">
						19 Feb 2016, 02:55					</div>
				</div>
				<div class="post-content content">
					<p>Ok, I disabled SQM for now. Got A+ for BB:<br /><span class="postimg"><img src="http://www.dslreports.com/speedtest/3079559.png" alt="http://www.dslreports.com/speedtest/3079559.png" /></span></p><p>Ping test: 0% loss latency 39.0ms 100% Grade<br />JItter:<br />18/2/2016 5:51:53PM calculating grade<br />18/2/2016 5:52:16PM grade A+<br />18/2/2016 5:52:46PM grade A+<br />18/2/2016 5:53:16PM grade A+<br />Location&nbsp; &nbsp; IP&nbsp; &nbsp; Min&nbsp; &nbsp; +PDV<br />NSW, AUS&nbsp; &nbsp; 54.153.204.70&nbsp; &nbsp; 203&nbsp; &nbsp; +3.9ms&nbsp; &nbsp; <br />SP, Brazil&nbsp; &nbsp; 54.94.200.74&nbsp; &nbsp; 213&nbsp; &nbsp; +5.9ms&nbsp; &nbsp; <br />ON, Canada&nbsp; &nbsp; 206.248.155.54&nbsp; &nbsp; 93&nbsp; &nbsp; +3.8ms&nbsp; &nbsp; <br />QC, Canada&nbsp; &nbsp; 198.50.134.193&nbsp; &nbsp; 99&nbsp; &nbsp; +3ms&nbsp; &nbsp; <br />Germany, EU&nbsp; &nbsp; 52.29.186.221&nbsp; &nbsp; 164&nbsp; &nbsp; +4.6ms&nbsp; &nbsp; <br />Ireland, EU&nbsp; &nbsp; 54.154.207.39&nbsp; &nbsp; 157&nbsp; &nbsp; +4ms&nbsp; &nbsp; <br />London, UK&nbsp; &nbsp; 88.80.191.58&nbsp; &nbsp; 144&nbsp; &nbsp; +4.1ms&nbsp; &nbsp; <br />Tokyo, Japan&nbsp; &nbsp; 54.65.9.39&nbsp; &nbsp; 151&nbsp; &nbsp; +4.1ms&nbsp; &nbsp; <br />Davao, Philippines&nbsp; &nbsp; 202.137.115.7&nbsp; &nbsp; 253&nbsp; &nbsp; +4.7ms&nbsp; &nbsp; <br />San Juan, PR&nbsp; &nbsp; 209.91.216.173&nbsp; &nbsp; 136&nbsp; &nbsp; +3.3ms&nbsp; &nbsp; <br />Singapore&nbsp; &nbsp; 54.169.160.227&nbsp; &nbsp; 221&nbsp; &nbsp; +3.7ms&nbsp; &nbsp; <br />Taiwan&nbsp; &nbsp; 104.155.201.41&nbsp; &nbsp; 140&nbsp; &nbsp; +4.4ms&nbsp; &nbsp; <br />CA, USA&nbsp; &nbsp; 64.140.161.58&nbsp; &nbsp; 47&nbsp; &nbsp; +5.8ms&nbsp; &nbsp; <br />CO, USA&nbsp; &nbsp; 72.5.102.138&nbsp; &nbsp; 65&nbsp; &nbsp; +4.4ms&nbsp; &nbsp; <br />DC, USA&nbsp; &nbsp; 65.79.226.210&nbsp; &nbsp; 88&nbsp; &nbsp; +5.1ms&nbsp; &nbsp; <br />DE, USA&nbsp; &nbsp; 162.151.17.198&nbsp; &nbsp; 91&nbsp; &nbsp; +3.7ms&nbsp; &nbsp; <br />GA, USA&nbsp; &nbsp; 24.72.224.10&nbsp; &nbsp; 93&nbsp; &nbsp; +3.7ms&nbsp; &nbsp; <br />IA, USA&nbsp; &nbsp; 104.154.69.141&nbsp; &nbsp; 65&nbsp; &nbsp; +5.5ms&nbsp; &nbsp; <br />IL, USA&nbsp; &nbsp; 162.248.92.123&nbsp; &nbsp; 64&nbsp; &nbsp; +3ms&nbsp; &nbsp; <br />MI, USA&nbsp; &nbsp; 72.52.179.213&nbsp; &nbsp; 77&nbsp; &nbsp; +6.7ms&nbsp; &nbsp; <br />NC, USA&nbsp; &nbsp; 192.254.79.130&nbsp; &nbsp; 94&nbsp; &nbsp; +3.8ms&nbsp; &nbsp; <br />NY, USA&nbsp; &nbsp; 162.248.95.144&nbsp; &nbsp; 79&nbsp; &nbsp; +2.4ms&nbsp; &nbsp; <br />OR, USA&nbsp; &nbsp; 68.85.243.66&nbsp; &nbsp; 26&nbsp; &nbsp; +4.5ms&nbsp; &nbsp; <br />SEA, USA&nbsp; &nbsp; 66.150.164.232&nbsp; &nbsp; 22&nbsp; &nbsp; +3.9ms&nbsp; &nbsp; <br />TN, USA&nbsp; &nbsp; 63.135.176.24&nbsp; &nbsp; 97&nbsp; &nbsp; +3.3ms&nbsp; &nbsp; <br />TX, USA&nbsp; &nbsp; 104.153.106.185&nbsp; &nbsp; 82&nbsp; &nbsp; +5.9ms&nbsp; &nbsp; </p><br /><p>I&#039;ll so some playing around with as time goes on. I&#039;ll play Xbox this evening and check pings while SQM is disabled.</p>											<p class="post-edited">(Last edited by <strong>FurryNutz</strong> on 19 Feb 2016, 03:15)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p312112">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">moeller0</div>
					<div class="post-datetime">
						19 Feb 2016, 11:11					</div>
				</div>
				<div class="post-content content">
					<p>Hi FurryNutz,</p><div class="quotebox"><cite>FurryNutz wrote:</cite><blockquote><p>M, Thank you for all the feedback. Wheew. </p><p>Ya I wasn&#039;t sure if I should start a new thread or not. Figured this would be ok since it&#039;s similar topic. I can if needed.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; I really do not care, but you might attract more responders by starting a new thread...<br /></p><div class="quotebox"><cite>FurryNutz wrote:</cite><blockquote><p>I install the most recent code at the time and that was Jan 31st time frame. Would this be up to date for SQM packages or will I still need to update them?</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; This depends, did you manually install sqm as described on <a href="https://github.com/tohojo/sqm-scripts">https://github.com/tohojo/sqm-scripts</a> or did you just install the packet available in the openwrt repository? In any way there have been recent changes to sqm that make installation of the most recent version probably worthwhile.<br /></p><div class="quotebox"><cite>FurryNutz wrote:</cite><blockquote><p>Since I&#039;m a single user at night, do you think I need to enable SQM at all and just leave it disabled? I guess since xbox is the only thing doing any bandwidth, sounds like SQM can be disabled.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; In theory sqm-scripts will not cause a noticeable latency-regression versus no sqm-scripts when the network is idle (and you can always disable sqm-scripts if you want to test that hypothesis). Sqm requires that you throttle your connection (especially your downstream) a bit as it meeds control over the connections bottleneck to do its thing, so there is a smallish bandwidth sacrifice, but if your network is not loaded you will not use all bandwidth by definition, so you should not notice. The moment your network gets saturated latency under load will increase sharply, unless you have counter-measures like sqm-scripts installed and enabled. So in short smq-scripts should not hurt with no load, but should help a lot under load. So I would just keep it enabled all the time (as a matter of fact I actually do that).<br /></p><div class="quotebox"><cite>FurryNutz wrote:</cite><blockquote><p>One thought, would SQM be an advantage to have enabled for systems with two or more game consoles going at the same time?</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp;The relevant question is not so much number of connected machines, but rather loading of the network, idle to light load: sqm-scripts should not change a thing, saturating load sqm-scripts will keep the latency (for sparse flows) under control at the cost of a small percentage of peak bandwidth. If all you need is bandwidth you might want to run without sqm if you care about latency you will want it enabled. Note even simple web-browsing is latency sensitive, I guess &quot;only&quot; long term bulk data transfer of large volumes (FTP, bit-torrent) does not care about latency too much.<br /></p><div class="quotebox"><cite>FurryNutz wrote:</cite><blockquote><p>Regarding captures, I&#039;ll try to post these as soon as I can. </p><p>I&#039;ll run some tests with it enabled and disabled to check bufferbloat and pings while gaming. I presume this is a variable with SQM?</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; Not wuite sure what you mean with &quot;variable with SQM&quot; here, could you elaborate, please?<br /></p><div class="quotebox"><cite>FurryNutz wrote:</cite><blockquote><p>I may connect PC and xbox direct to ISP modem and check pings there too.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp;Ah great.<br /></p><div class="quotebox"><cite>FurryNutz wrote:</cite><blockquote><p>Is there a recommended forum to post about the 5Ghz radio support? General Discussions ok? </p><p>Thank you for all feedback and your time.</p></blockquote></div><p>Not sure about the radio issue, I guess I would try General Discussions, I believe having a new thread with a descriptive topic might attract more experts that discussing this at the end of a nominally unrelated thread that was warmed up <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>Best Regards<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;M.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p312113">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">moeller0</div>
					<div class="post-datetime">
						19 Feb 2016, 11:15					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>FurryNutz wrote:</cite><blockquote><p>Ok, I disabled SQM for now. Got A+ for BB:<br /><span class="postimg"><img src="http://www.dslreports.com/speedtest/3079559.png" alt="http://www.dslreports.com/speedtest/3079559.png" /></span></p><p>Ping test: 0% loss latency 39.0ms 100% Grade<br />JItter:<br />18/2/2016 5:51:53PM calculating grade<br />18/2/2016 5:52:16PM grade A+<br />18/2/2016 5:52:46PM grade A+<br />18/2/2016 5:53:16PM grade A+<br />Location&nbsp; &nbsp; IP&nbsp; &nbsp; Min&nbsp; &nbsp; +PDV<br />NSW, AUS&nbsp; &nbsp; 54.153.204.70&nbsp; &nbsp; 203&nbsp; &nbsp; +3.9ms&nbsp; &nbsp; <br />SP, Brazil&nbsp; &nbsp; 54.94.200.74&nbsp; &nbsp; 213&nbsp; &nbsp; +5.9ms&nbsp; &nbsp; <br />ON, Canada&nbsp; &nbsp; 206.248.155.54&nbsp; &nbsp; 93&nbsp; &nbsp; +3.8ms&nbsp; &nbsp; <br />QC, Canada&nbsp; &nbsp; 198.50.134.193&nbsp; &nbsp; 99&nbsp; &nbsp; +3ms&nbsp; &nbsp; <br />Germany, EU&nbsp; &nbsp; 52.29.186.221&nbsp; &nbsp; 164&nbsp; &nbsp; +4.6ms&nbsp; &nbsp; <br />Ireland, EU&nbsp; &nbsp; 54.154.207.39&nbsp; &nbsp; 157&nbsp; &nbsp; +4ms&nbsp; &nbsp; <br />London, UK&nbsp; &nbsp; 88.80.191.58&nbsp; &nbsp; 144&nbsp; &nbsp; +4.1ms&nbsp; &nbsp; <br />Tokyo, Japan&nbsp; &nbsp; 54.65.9.39&nbsp; &nbsp; 151&nbsp; &nbsp; +4.1ms&nbsp; &nbsp; <br />Davao, Philippines&nbsp; &nbsp; 202.137.115.7&nbsp; &nbsp; 253&nbsp; &nbsp; +4.7ms&nbsp; &nbsp; <br />San Juan, PR&nbsp; &nbsp; 209.91.216.173&nbsp; &nbsp; 136&nbsp; &nbsp; +3.3ms&nbsp; &nbsp; <br />Singapore&nbsp; &nbsp; 54.169.160.227&nbsp; &nbsp; 221&nbsp; &nbsp; +3.7ms&nbsp; &nbsp; <br />Taiwan&nbsp; &nbsp; 104.155.201.41&nbsp; &nbsp; 140&nbsp; &nbsp; +4.4ms&nbsp; &nbsp; <br />CA, USA&nbsp; &nbsp; 64.140.161.58&nbsp; &nbsp; 47&nbsp; &nbsp; +5.8ms&nbsp; &nbsp; <br />CO, USA&nbsp; &nbsp; 72.5.102.138&nbsp; &nbsp; 65&nbsp; &nbsp; +4.4ms&nbsp; &nbsp; <br />DC, USA&nbsp; &nbsp; 65.79.226.210&nbsp; &nbsp; 88&nbsp; &nbsp; +5.1ms&nbsp; &nbsp; <br />DE, USA&nbsp; &nbsp; 162.151.17.198&nbsp; &nbsp; 91&nbsp; &nbsp; +3.7ms&nbsp; &nbsp; <br />GA, USA&nbsp; &nbsp; 24.72.224.10&nbsp; &nbsp; 93&nbsp; &nbsp; +3.7ms&nbsp; &nbsp; <br />IA, USA&nbsp; &nbsp; 104.154.69.141&nbsp; &nbsp; 65&nbsp; &nbsp; +5.5ms&nbsp; &nbsp; <br />IL, USA&nbsp; &nbsp; 162.248.92.123&nbsp; &nbsp; 64&nbsp; &nbsp; +3ms&nbsp; &nbsp; <br />MI, USA&nbsp; &nbsp; 72.52.179.213&nbsp; &nbsp; 77&nbsp; &nbsp; +6.7ms&nbsp; &nbsp; <br />NC, USA&nbsp; &nbsp; 192.254.79.130&nbsp; &nbsp; 94&nbsp; &nbsp; +3.8ms&nbsp; &nbsp; <br />NY, USA&nbsp; &nbsp; 162.248.95.144&nbsp; &nbsp; 79&nbsp; &nbsp; +2.4ms&nbsp; &nbsp; <br />OR, USA&nbsp; &nbsp; 68.85.243.66&nbsp; &nbsp; 26&nbsp; &nbsp; +4.5ms&nbsp; &nbsp; <br />SEA, USA&nbsp; &nbsp; 66.150.164.232&nbsp; &nbsp; 22&nbsp; &nbsp; +3.9ms&nbsp; &nbsp; <br />TN, USA&nbsp; &nbsp; 63.135.176.24&nbsp; &nbsp; 97&nbsp; &nbsp; +3.3ms&nbsp; &nbsp; <br />TX, USA&nbsp; &nbsp; 104.153.106.185&nbsp; &nbsp; 82&nbsp; &nbsp; +5.9ms&nbsp; &nbsp; </p><br /><p>I&#039;ll so some playing around with as time goes on. I&#039;ll play Xbox this evening and check pings while SQM is disabled.</p></blockquote></div><p>For dslreports I always recommend to get a free registration, as that allows to configure the speedtest in meaningfull ways:<br />1) you can select high resolution buffer bloat testing (you might have noted that you can click on the idle Downloading, and Uploading links under the three plots at the extended results page to see the RTTs of the individual latency probes).<br />2) select a decent number of streams for up- and downstream, I typically use 16 per direction, you really want to be avble to saturate the link to see the buffer bloat worst case.</p><p>Best Regards<br />&nbsp; &nbsp; &nbsp; &nbsp; M.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p312159">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">FurryNutz</div>
					<div class="post-datetime">
						19 Feb 2016, 19:11					</div>
				</div>
				<div class="post-content content">
					<p>Awesome, ya i have been a member of DR for a while now. </p><p>I saw that if I clicked on the gear wheel that I found more configurations. <br />The results I posted are from using HD BB and enkrypted pay load method. </p><p>I played BO3 last nite with SQM disabled and gaming was good. I believe thought that I need to get my other teammates networking into some coordination as I notice if I gamed alone or with just one or two others, in game pings were good to average, 30-60s. After we had a full team, my pings went up to low 100s and my signal bars went to yellow. Of course I believe some of this is due to what BO3 does behind the scenes which maybe a factor. </p><p>Overall happy with the code though.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>