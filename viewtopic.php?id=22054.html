<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Transparent bridge</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 8 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p95414">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						6 Oct 2009, 06:20					</div>
				</div>
				<div class="post-content content">
					<p>I just recovered my Netgear WGT634U and have flashed it with a newly built OpenWRT firmware. My WGT634U device doesn&#039;t have a WiFi card and that&#039;s just fine with me. I would like to attach the WAN port on this device to one of the LAN ports on my main WRT54GS v3 NAT/Firewall router as a transparent bridge. This way all the devices attached to the LAN ports on my WGT634U device will be under the same subnet as the devices attached to the LAN ports on my WRT54GS v3 main router and be able to talk to each others. Can anyone please help?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p95421">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						6 Oct 2009, 09:29					</div>
				</div>
				<div class="post-content content">
					<p>Transparent client bridges are neither officially supported nor recommended. Use WDS for that kind of setup.</p><p>You can make it work somehow if you create a custom build with ebtables enabled and some arp-nat rules to do layer 2 nat.</p><br /><p>~ JoW</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p95433">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">normunds</div>
					<div class="post-datetime">
						6 Oct 2009, 11:26					</div>
				</div>
				<div class="post-content content">
					<p>hi,<br />looks like the first answer tht ebt can do&nbsp; sta bridging. Can you plz tell me which arpnat. The one in ebtables&nbsp; in snat or the patch arpnat used by other ppl like willi ubnt etc (as arpnat patch only works&nbsp; with 2.6.23 kernel)</p><p>regards<br />norms</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p95441">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">crisman</div>
					<div class="post-datetime">
						6 Oct 2009, 14:13					</div>
				</div>
				<div class="post-content content">
					<p>mazilo have not a wifi card, so wds is not the answer. Just create one vlan including all ports, disable wan part in network config and disable dhcp. Assign one ip for the wgt634u on the lan side outside dhcp range of your primary router. You&#039;re done.</p><p>Regards</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p95445">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						6 Oct 2009, 14:26					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>crisman wrote:</cite><blockquote><p>mazilo have not a wifi card, so wds is not the answer.</p></blockquote></div><p>Indeed. Didn&#039;t pay attention - sorry.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p95662">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						10 Oct 2009, 08:07					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>crisman wrote:</cite><blockquote><p>mazilo have not a wifi card, so wds is not the answer.</p></blockquote></div><p>You are right. Even using <em>ebtables</em> approach isn&#039;t an option for me because my WGT634U runs on a stripped-down OpenWRT firmware that has no WiFi and NAT/Firewall facilities.</p><div class="quotebox"><blockquote><p>Just create one vlan including all ports, disable wan part in network config and disable dhcp. Assign one ip for the wgt634u on the lan side outside dhcp range of your primary router. You&#039;re done.</p></blockquote></div><p>Many thanks to you. I tried your suggestion and it works as you said. The best part is now my WGT634U boots up with plenty of RAM to run asterisk or freeswitch. <em>free</em> utility shows my WGT634U system uses about 6,180KB of RAM after I SSHed into my WGT634U system as shown below:<br /></p><div class="codebox"><pre><code>BusyBox v1.14.4 (2009-10-21 09:03:56 EDT) built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 KAMIKAZE (bleeding edge, r18193) ------------------
  * 10 oz Vodka       Shake well with ice and strain
  * 10 oz Triple sec  mixture into 10 shot glasses.
  * 10 oz lime juice  Salute!
 ---------------------------------------------------
root@WGT634U:~# free
              total         used         free       shared      buffers
  Mem:        29260         6032        23228            0          156
 Swap:            0            0            0
Total:        29260         6032        23228
root@WGT634U:~#</code></pre></div><p>In case if anyone is interested, here is the <em>/etc/config/network</em> file on my WGT634U:<br /></p><div class="codebox"><pre><code>#### VLAN configuration
config switch eth0
        option vlan0    &quot;0 1 2 3 4 5*&quot;


#### Loopback configuration
config interface loopback
        option ifname   &quot;lo&quot;
        option proto    static
        option ipaddr   127.0.0.1
        option netmask  255.0.0.0


#### LAN configuration
config interface lan
        option ifname   &quot;eth0.0&quot;
        option proto    static
        option ipaddr   192.168.1.6     &lt;==== Static IP Address for my WGT634U
        option  gateway 192.168.1.1
        option  dns     192.168.1.1
        option netmask  255.255.255.0</code></pre></div><p>Below is a minimal list of packages installed to turn my WGT634U into a transparent switch with a USB2.0 port to support an external USB2.0 mass storage with and/or without a HUB + USB2.0 printer server:<br /></p><div class="codebox"><pre><code>base-files - 33-r18113 - 
bridge - 1.4-1 - 
busybox - 1.14.4-1 - 
curl - 7.19.6-1 - 
ddns-scripts - 1.0.0-4 - 
dropbear - 0.52-3 - 
e2fsprogs - 1.41.9-1 - 
hotplug2 - 1.0-beta-1 - 
kernel - 2.6.30.8-1 - 
kmod-diag - 2.6.30.8-5 - 
kmod-loop - 2.6.30.8-1 - 
kmod-switch - 2.6.30.8-2 - 
kmod-usb2 - 2.6.30.8-1 - 
libblkid - 1.41.9-1 - 
libc - 0.9.30.1-33 - 
libcurl - 7.19.6-1 - 
libext2fs - 1.41.9-1 - 
libgcc - 4.3.3+cs-33 - 
liblua - 5.1.4-5 - 
libncurses - 5.7-1 - 
libopenssl - 0.9.8k-2 - 
libpthread - 0.9.30.1-33 - 
librt - 0.9.30.1-33 - 
libuci - 0.7.5-1 - 
libuci-lua - 0.7.5-1 - 
libuuid - 1.41.9-1 - 
lua - 5.1.4-5 - 
minicom - 2.3-1 - 
mtd - 10 - 
ntpclient - 2007_365-2 - 
nvram - 5 - 
opkg - 215-2 - 
p910nd - 0.93-1 - 
screen - 4.0.3-1 - 
uci - 0.7.5-1 - 
ucitrigger - 0.7.5-1 - 
udevtrigger - 106-1 - 
zlib - 1.2.3-5 -</code></pre></div><p><em>lsmod</em> dump is shown as follows:<br /></p><div class="codebox"><pre><code>Module                  Size  Used by    Not tainted
ehci_hcd               31920  0 
loop                   10384  0 
switch_robo             3824  0 
switch_core             5120  1 switch_robo
diag                    7312  0</code></pre></div>											<p class="post-edited">(Last edited by <strong>mazilo</strong> on 28 Oct 2009, 04:26)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>