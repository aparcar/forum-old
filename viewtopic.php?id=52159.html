<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Need assistance with setup</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 10 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p243616">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">PJ_DnB</div>
					<div class="post-datetime">
						12 Aug 2014, 15:10					</div>
				</div>
				<div class="post-content content">
					<p>Hey everyone,</p><p>I&#039;m having problems setting up my router. When I try opkg update I get a wget returned 1 error. I researched this error and it seems I have setup my dns wrong so if anyone can help me out that would be great. Also what should I put at option ipaddr?</p><div class="quotebox"><blockquote><p>root@OpenWrt:/# vi /etc/config/network</p><p>config interface &#039;loopback&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;lo&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;127.0.0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.0.0.0&#039;</p><p>config globals &#039;globals&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ula_prefix &#039;fdd3:0b0a:d329::/48&#039;</p><p>config interface &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option type &#039;bridge&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;192.168.1.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ip6assign &#039;60&#039;<br />option gateway &#039;192.168.0.1&#039;<br />option dns &#039;195.130.131.132&#039;</p><p>config interface &#039;wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;dhcp&#039;</p></blockquote></div><div class="quotebox"><blockquote><p>root@OpenWrt:/# ifconfig<br />br-lan&nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 10:FE:ED:C2:25:C0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:192.168.1.1&nbsp; Bcast:192.168.1.255&nbsp; Mask:255.255.255.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: fdd3:b0a:d329::1/60 Scope:Global<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: fe80::12fe:edff:fec2:25c0/64 Scope:Link<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:7127 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:7871 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:2120589 (2.0 MiB)&nbsp; TX bytes:5111655 (4.8 MiB)</p><p>eth0&nbsp; &nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 10:FE:ED:C2:25:C1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:192.168.0.193&nbsp; Bcast:192.168.0.255&nbsp; Mask:255.255.255.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: fe80::12fe:edff:fec2:25c1/64 Scope:Link<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:13791 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:6987 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:6752674 (6.4 MiB)&nbsp; TX bytes:2246276 (2.1 MiB)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Interrupt:4</p><p>eth1&nbsp; &nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 10:FE:ED:C2:25:C0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:9044 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:8800 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:2542274 (2.4 MiB)&nbsp; TX bytes:5386385 (5.1 MiB)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Interrupt:5</p><p>lo&nbsp; &nbsp; &nbsp; &nbsp; Link encap:Local Loopback<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:127.0.0.1&nbsp; Mask:255.0.0.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: ::1/128 Scope:Host<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP LOOPBACK RUNNING&nbsp; MTU:65536&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:22 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:22 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:1596 (1.5 KiB)&nbsp; TX bytes:1596 (1.5 KiB)</p></blockquote></div>											<p class="post-edited">(Last edited by <strong>PJ_DnB</strong> on 12 Aug 2014, 15:14)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p243632">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">hvandrie</div>
					<div class="post-datetime">
						12 Aug 2014, 16:59					</div>
				</div>
				<div class="post-content content">
					<p>In your setup, you&#039;re still utilizing routing. Assuming you still want to route with NAT translation, the following is required to make things work:</p><p>First, remove the lines for the lan interface:<br />option gateway &#039;192.168.0.1&#039;<br />option dns &#039;195.130.131.132&#039;</p><p>Restart either network (/etc/init.d/network reload&nbsp; or /etc/init.d/network restart) or reboot the device.</p><p>Your lan interface which is connected to physical port eth1 is NOT connected to your other modem/router which has access to the internet. So, that&#039;s why your setup will never work.</p><p>As your wan interface is binded to eth0, it&#039;s ip address is is provided by dhcp (intet addr:192.168.0.193)<br />In the dhcp request it did, it most probably received the gateway and dns 192.168.0.1.</p><p>It also then automatically and dynamically creates the default route in the routing table so all traffic flows to 192.168.0.1 already.</p><br /><p>In case you want to make a dumb switch/wireless access point, so no routing and just one network, your setup is different:</p><br /><p>config interface &#039;loopback&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;lo&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;127.0.0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.0.0.0&#039;</p><p>config globals &#039;globals&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ula_prefix &#039;fdd3:0b0a:d329::/48&#039;</p><p>config interface &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth0 eth1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option type &#039;bridge&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;192.168.0.2&#039;&nbsp; # &lt;-- assuming here this ip address is still available!<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;<br />&nbsp; &nbsp; option gateway &#039;192.168.0.1&#039;<br />&nbsp; &nbsp; option dns &#039;192.168.0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ip6assign &#039;60&#039;</p><p># you may remove entire wan interface definition below<br />#config interface &#039;wan&#039;<br />#&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth0&#039;<br />#&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;dhcp&#039;&nbsp; </p><br /><br /><p>Good luck</p>											<p class="post-edited">(Last edited by <strong>hvandrie</strong> on 12 Aug 2014, 17:05)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>