<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Kernel Panic - Chillispot + Tinyproxy (iptables problem)</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 4 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p142810">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">pspmann</div>
					<div class="post-datetime">
						3 Sep 2011, 21:11					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>I&#039;m using openwrt trunk with Netgear DG834GT (r28148). I installed chillispot and all works fine. <br />I want to use a proxy behind wireless traffic to limit warez, erotic ...<br />I installed tinyproxy which listen on 8888 and now i want to forward traffic from port 80 to port 8888.</p><p>I use this rule :&nbsp; </p><div class="codebox"><pre><code>iptables -t nat -A PREROUTING -i tun0 -p tcp -m tcp --dport 80 -j REDIRECT --to-ports 8888</code></pre></div><p>But when i try to connect to wifi of the router with chillispot =&gt; Kernel Panic. If i don&#039;t use iptables rule, no kernel panic.</p><p>My crash log :</p><div class="codebox"><pre><code>CPU 0 Unable to handle kernel paging request at virtual address 00000088, epc == 80e8c734, ra == 8
0e9b0b0
Oops[#1]:
Cpu 0
$ 0   : 00000000 10008400 000022b8 c0a80501
$ 4   : 00000000 80afbab8 00000001 00000003
$ 8   : 00000000 00000000 00000000 00000000
$12   : 00500002 00000040 00000000 c0a80502
$16   : 80db5800 80dce304 80d5d000 8055c3a0
$20   : 80e3ae80 00000000 8091d780 80db58a0
$24   : 00000000 80e95290                  
$28   : 80afa000 80afba08 802ebc64 80e9b0b0
Hi    : 00000000
Lo    : 00000000
epc   : 80e8c734 0x80e8c734
    Tainted: P           
ra    : 80e9b0b0 0x80e9b0b0
Status: 10008403    KERNEL EXL IE 
Cause : 00800008
BadVA : 00000088
PrId  : 00029107 (Broadcom BMIPS3300)
Modules linked in: gpio_buttons ath_pci ath_hal(P) xt_ipp2p nf_nat_irc nf_conntrack_irc nf_nat_ftp nf_conntrack_ftp x
t_string xt_layer7 xt_quota xt_pkttype xt_physdev xt_owner compat_xtables ipt_REDIRECT ipt_NETMAP ipt_MASQUERADE ipta
ble_nat nf_nat xt_conntrack xt_NOTRACK iptable_raw xt_state nf_conntrack_ipv4 nf_defrag_ipv4 nf_conntrack pppoe pppox
 ipt_REJECT xt_TCPMSS ipt_LOG xt_comment xt_multiport xt_mac xt_limit iptable_mangle iptable_filter ip_tables xt_tcpu
dp x_tables tun ppp_async ppp_generic slhc button_hotplug ts_fsm ts_bm ts_kmp input_polldev crc_ccitt input_core swit
ch_adm switch_robo switch_core
Process chilli (pid: 1137, threadinfo=80afa000, task=80f05988, tls=2b8722d0)
Stack : 00000000 00000000 00000000 0000000b 00000000 00000000 00000000 00000000
        0000000b 8021c004 80478000 805f35d0 805f35d0 802c0000 8055c3a0 804c5968
        80586340 80585ce4 e0b70002 d043dede 00000000 00000000 00000001 a05e5c40
        0000001b 80e51bc8 8091d794 00007530 00000000 80e966b4 00000006 00000000
        00000000 8009fcd0 00000001 80db5800 80dce304 80d5d000 8055c3a0 80e9b0b0
        ...
Call Trace:[&lt;8021c004&gt;] 0x8021c004
[&lt;80586340&gt;] 0x80586340
[&lt;80585ce4&gt;] 0x80585ce4
[&lt;80e966b4&gt;] 0x80e966b4
[&lt;8009fcd0&gt;] 0x8009fcd0
[&lt;80e9b0b0&gt;] 0x80e9b0b0
[&lt;800a0518&gt;] 0x800a0518
[&lt;80dcc7a0&gt;] 0x80dcc7a0
[&lt;80e9588c&gt;] 0x80e9588c
[&lt;80ea40c0&gt;] 0x80ea40c0
[&lt;80ea42b0&gt;] 0x80ea42b0
[&lt;80ea445c&gt;] 0x80ea445c
[&lt;801bfac0&gt;] 0x801bfac0
[&lt;801b9128&gt;] 0x801b9128
[&lt;801bfac0&gt;] 0x801bfac0
[&lt;801bfac0&gt;] 0x801bfac0
[&lt;801b921c&gt;] 0x801b921c
[&lt;801bfac0&gt;] 0x801bfac0
[&lt;801c04d8&gt;] 0x801c04d8
[&lt;80599f80&gt;] 0x80599f80
[&lt;801bfac0&gt;] 0x801bfac0
[&lt;8019b2a8&gt;] 0x8019b2a8
[&lt;8002c048&gt;] 0x8002c048
[&lt;8019b3d0&gt;] 0x8019b3d0
[&lt;80194b10&gt;] 0x80194b10
[&lt;8019b820&gt;] 0x8019b820
[&lt;8002bde4&gt;] 0x8002bde4
[&lt;801885e4&gt;] 0x801885e4
[&lt;8002c048&gt;] 0x8002c048
[&lt;8019bf40&gt;] 0x8019bf40
[&lt;80e2d600&gt;] 0x80e2d600
[&lt;8008f574&gt;] 0x8008f574
[&lt;800fa7d0&gt;] 0x800fa7d0
[&lt;8008fdd8&gt;] 0x8008fdd8
[&lt;800900c8&gt;] 0x800900c8
[&lt;8002b120&gt;] 0x8002b120
[&lt;8018a878&gt;] 0x8018a878
[&lt;80019d90&gt;] 0x80019d90


Code: afb0008c  afbf009c  afb30098 &lt;8c820088&gt; 00808021  00a08821  00c09021  10400003  00001821 
Kernel panic - not syncing: Fatal exception in interrupt
Rebooting in 3 seconds..
triggering watchdog soft-reset...</code></pre></div><p>lsmod :</p><div class="codebox"><pre><code>gpio_buttons            1872  0 
ath_pci               291040  0 
ath_hal               296192  2 ath_pci
xt_ipp2p                6848  3 
nf_nat_irc               784  0 
nf_conntrack_irc        2496  1 nf_nat_irc
nf_nat_ftp               976  0 
nf_conntrack_ftp        4416  1 nf_nat_ftp
xt_string                688  0 
xt_layer7               8960  0 
xt_quota                 672  0 
xt_pkttype               544  0 
xt_physdev              1280  0 
xt_owner                 608  0 
compat_xtables          1520  1 xt_ipp2p
ipt_REDIRECT             592  0 
ipt_NETMAP               592  0 
ipt_MASQUERADE           944  1 
iptable_nat             2128  1 
nf_nat                  9968  6 nf_nat_irc,nf_nat_ftp,ipt_REDIRECT,ipt_NETMAP,ipt_MASQUERADE,iptable_nat
xt_conntrack            2096  0 
xt_NOTRACK               480  1 
iptable_raw              560  1 
xt_state                 624  1 
nf_conntrack_ipv4       3856  4 iptable_nat,nf_nat
nf_defrag_ipv4           624  1 nf_conntrack_ipv4
nf_conntrack           36752 12 nf_nat_irc,nf_conntrack_irc,nf_nat_ftp,nf_conntrack_ftp,xt_layer7,ipt_MASQUERADE,ipta
ble_nat,nf_nat,xt_conntrack,xt_NOTRACK,xt_state,nf_conntrack_ipv4
pppoe                   7344  0 
pppox                   1152  1 pppoe
ipt_REJECT              1712  1 
xt_TCPMSS               1936  0 
ipt_LOG                 5856  0 
xt_comment               416  0 
xt_multiport            1104  0 
xt_mac                   544  0 
xt_limit                 944  0 
iptable_mangle           816  0 
iptable_filter           624  1 
ip_tables               8992  4 iptable_nat,iptable_raw,iptable_mangle,iptable_filter
xt_tcpudp               1584  2 
x_tables               10112 27 xt_ipp2p,xt_string,xt_layer7,xt_quota,xt_pkttype,xt_physdev,xt_owner,compat_xtables,i
pt_REDIRECT,ipt_NETMAP,ipt_MASQUERADE,iptable_nat,xt_conntrack,xt_NOTRACK,iptable_raw,xt_state,ipt_REJECT,xt_TCPMSS,i
pt_LOG,xt_comment,xt_multiport,xt_mac,xt_limit,iptable_mangle,iptable_filter,ip_tables,xt_tcpudp
tun                    11760  2 
ppp_async               6128  0 
ppp_generic            18560  3 pppoe,pppox,ppp_async
slhc                    4000  1 ppp_generic
button_hotplug          2656  0 
ts_fsm                  2496  0 
ts_bm                   1360  0 
ts_kmp                  1296  0 
input_polldev           2032  1 gpio_buttons
crc_ccitt                944  1 ppp_async
input_core             20432  3 gpio_buttons,button_hotplug,input_polldev
switch_adm              3168  0 
switch_robo             4016  0 
switch_core             4832  2 switch_adm,switch_robo</code></pre></div><p>Thank you</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>