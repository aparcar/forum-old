<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Custom x86 Image (NO LONGER MAINTAINED)</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 6 Sep 2015 and 6 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 8 of 17</div><nav><ul><li><a href="viewtopic.php%3Fid=35887&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=35887&amp;p=6.html">6</a></li><li><a href="viewtopic.php%3Fid=35887&amp;p=7.html">7</a></li><li class="pagination-current"><span>8</span></li><li><a href="viewtopic.php%3Fid=35887&amp;p=9.html">9</a></li><li><a href="viewtopic.php%3Fid=35887&amp;p=10.html">10</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=35887&amp;p=17.html">17</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p178343">
				<div class="post-metadata">
					<div class="post-num">Post #176</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						16 Sep 2012, 08:19					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Alex Atkin UK wrote:</cite><blockquote><p>I thought that at first but on reading up, maxfail is just how many times pppd should try to connect before dying and holdoff is how long to wait after a failure before retrying.</p><p>Seems to me neither of those things should cause it to hang if it genuinely dropped the connection.</p></blockquote></div><p>That is good.&nbsp; Things are looking up for the PPPoE side of your equation.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178344">
				<div class="post-metadata">
					<div class="post-num">Post #177</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						16 Sep 2012, 08:28					</div>
				</div>
				<div class="post-content content">
					<p>Just rebooted the router, it came back up fine.</p><p>Other than testing how well QoS works (or not), everything seems fine.</p><p>As I suspected, everything on the web feels snappier now.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178345">
				<div class="post-metadata">
					<div class="post-num">Post #178</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						16 Sep 2012, 08:31					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Alex Atkin UK wrote:</cite><blockquote><p>Just rebooted the router, it came back up fine.</p><p>Other than testing how well QoS works (or not), everything seems fine.</p><p>As I suspected, everything on the web feels snappier now.</p></blockquote></div><p>That is amazing news!&nbsp; Do you have WiFi setup with the build as well?&nbsp; I&#039;m having troubles with my 2.4ghz adapter failing to work after a period of time.&nbsp; I am going to be trying out the experimental build that lacks ACPI and any real power management to see if it fixes my problem.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178346">
				<div class="post-metadata">
					<div class="post-num">Post #179</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						16 Sep 2012, 08:40					</div>
				</div>
				<div class="post-content content">
					<p>Sure, WiFi has worked all along but as its only for my laptop (although when I replace my phone next year that will support 5Ghz too) its not a top priority anyway.</p><p>Most of the network will still run off WiFi from the Buffalo as it does an excellent job of handling 2.4Ghz clients and needs to stay on the network anyway so I have enough ethernet ports for everything.</p><p>I really wish I could have gotten a PCIe x1 card with a switch built-in, I know PCI cards existed that did that, but they cost about 3x the price of the whole box itself as they are very rare- lol.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178347">
				<div class="post-metadata">
					<div class="post-num">Post #180</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						16 Sep 2012, 08:42					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Alex Atkin UK wrote:</cite><blockquote><p>Sure, WiFi has worked all along but as its only for my laptop its not a top priority anyway.</p><p>Most of the network will still run off WiFi from the Buffalo as it does an excellent job of handling 2.4Ghz clients and needs to stay on the network anyway so I have enough ethernet ports for everything.</p><p>I really wish I could have gotten a PCIe x1 card with a switch built-in, I know PCI cards existed that did that, but they cost about 3x the price of the whole box itself as they are very rare- lol.</p></blockquote></div><p>I can appreciate that... If you do anything 2.4ghz on the box let me know.&nbsp; I&#039;m curious if you have similar issues to what I have.&nbsp; I&#039;m also a little irritated that it took so much shuffling of my jumpers to get it to where it is now.&nbsp; You did mention power management stuff affecting WiFi so I want to ensure that ACPI and anything else is disabled.&nbsp; Hopefully an updated kernel will do the trick for me.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178349">
				<div class="post-metadata">
					<div class="post-num">Post #181</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						16 Sep 2012, 09:03					</div>
				</div>
				<div class="post-content content">
					<p>Well all seems well here.&nbsp; Downloading off Usenet at max speed while watching Netflix on PS3, flawlessly.&nbsp; This is with IFB which I can only assume is working based on these results, but its a little confusing as I do not see any QoS marks in /proc/net/ip_conntrack.<br /><a href="http://csdprojects.co.uk/OpenWRT/Atom.png">http://csdprojects.co.uk/OpenWRT/Atom.png</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178352">
				<div class="post-metadata">
					<div class="post-num">Post #182</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						16 Sep 2012, 09:53					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Alex Atkin UK wrote:</cite><blockquote><p>Well all seems well here.&nbsp; Downloading off Usenet at max speed while watching Netflix on PS3, flawlessly.&nbsp; This is with IFB which I can only assume is working based on these results, but its a little confusing as I do not see any QoS marks in /proc/net/ip_conntrack.<br /><a href="http://csdprojects.co.uk/OpenWRT/Atom.png">http://csdprojects.co.uk/OpenWRT/Atom.png</a></p></blockquote></div><p>I am seeing weird crashes with collectd on my install.&nbsp; Might be related?&nbsp; I&#039;m glad the IFB stuff is working.&nbsp; Let me know if you think I can drop the IMQ stuff.&nbsp; I&#039;m planning on sticking with whatever OpenWRT uses by default.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178357">
				<div class="post-metadata">
					<div class="post-num">Post #183</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						16 Sep 2012, 10:31					</div>
				</div>
				<div class="post-content content">
					<p>Semi-bad news: The sysupgrade tool takes an image file and likely will do something of a &quot;scorched earth&quot; upgrade.&nbsp; Because of this I will be starting on an upgrade in place tool that is meant to replace the standard sysupgrade process.&nbsp; The tool will be designed to work with ext[3|4] and btrfs.&nbsp; In the case of btrfs I will set it up to include support for snapshots.</p><p>Good news!&nbsp; My Jenkins instance looks like it is back to building correctly.&nbsp; It is setup to auto-build and publish on the 1st and 15th of each month.&nbsp; It is setup to run against the main openwrt trunk and my stable branch.&nbsp; Keep an eye out for auto-builds.&nbsp; They will likely go online before I have a chance to update the thread with the pertinent information.</p><p>I will also run builds mid-cycle depending on what changes make it into the stable branch on bitbucket (ie. the update in place tool goes live).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178358">
				<div class="post-metadata">
					<div class="post-num">Post #184</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						16 Sep 2012, 10:47					</div>
				</div>
				<div class="post-content content">
					<p>Collectd I believe has crashed on every build so far, certainly the test builds.</p><p>I&#039;m a little bothered at the idea that I cannot see IFB doing its work in /proc/net/ip_conntrack as I am used to monitoring that to see how its prioritising traffic and to see which things need tweaking for a better priority.&nbsp; So I may yet still switch back to IMQ and would certainly prefer if we can keep support for both, as long as it doesn&#039;t hurt.</p><p>I think I need to find out who is working on the OpenWRT QoS support and find out what IFB can and cannot do, to know for certain if its sufficient.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178439">
				<div class="post-metadata">
					<div class="post-num">Post #185</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						17 Sep 2012, 02:58					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Alex Atkin UK wrote:</cite><blockquote><p>Collectd I believe has crashed on every build so far, certainly the test builds.</p><p>I&#039;m a little bothered at the idea that I cannot see IFB doing its work in /proc/net/ip_conntrack as I am used to monitoring that to see how its prioritising traffic and to see which things need tweaking for a better priority.&nbsp; So I may yet still switch back to IMQ and would certainly prefer if we can keep support for both, as long as it doesn&#039;t hurt.</p><p>I think I need to find out who is working on the OpenWRT QoS support and find out what IFB can and cannot do, to know for certain if its sufficient.</p></blockquote></div><p>IMQ should be safe to leave in.&nbsp; I won&#039;t make any changes.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178491">
				<div class="post-metadata">
					<div class="post-num">Post #186</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						17 Sep 2012, 14:31					</div>
				</div>
				<div class="post-content content">
					<p>Good to know.&nbsp; As long as it doesn&#039;t break IFB its the most logical choice really.&nbsp; Its not like we need to worry about the IMQ module taking up precious RAM, like you would on ARM/MIPS.</p><p>Presumably OpenWRT do not change the kernel all that often so its not going to be a pain patching it all the time?</p><p>Still running on the test build btw, haven&#039;t stress tested WiFi (I don&#039;t think its going to really be possible with just one WiFi device) but otherwise its not shown any problems so far.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178508">
				<div class="post-metadata">
					<div class="post-num">Post #187</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						17 Sep 2012, 16:43					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Alex Atkin UK wrote:</cite><blockquote><p>Good to know.&nbsp; As long as it doesn&#039;t break IFB its the most logical choice really.&nbsp; Its not like we need to worry about the IMQ module taking up precious RAM, like you would on ARM/MIPS.</p><p>Presumably OpenWRT do not change the kernel all that often so its not going to be a pain patching it all the time?</p></blockquote></div><p>They&#039;ve not changed it since I started tracking things closely at least 4 months ago.&nbsp; I&#039;m not really worried about it.&nbsp; As long as there are good patches from the IMQ guys, we should be fine.</p><div class="quotebox"><cite>Alex Atkin UK wrote:</cite><blockquote><p>Still running on the test build btw, haven&#039;t stress tested WiFi (I don&#039;t think its going to really be possible with just one WiFi device) but otherwise its not shown any problems so far.</p></blockquote></div><p>My wi-fi drops no matter what, it can sit idle for 12 hours and die or it can die under load after 5 minutes.&nbsp; Normally it lasts 8-12 hours before it stops working.&nbsp; I can still see the access point, but no traffic flows.&nbsp; I think it relates to the jumper setting dance I had to do in order to get it to get even that far.&nbsp; I didn&#039;t get a chance to fiddle with it this weekend so hopefully this coming weekend I&#039;ll be able to figure it out.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178660">
				<div class="post-metadata">
					<div class="post-num">Post #188</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						18 Sep 2012, 20:51					</div>
				</div>
				<div class="post-content content">
					<p>Had my first pppd hang, modem resynced and pppd didn&#039;t shut down.&nbsp; I had to manually kill pppd on the router.</p><p>I have changed <strong>maxfail 0</strong> to <strong>maxfail 10</strong>, hopefully that will stop it hanging in the future.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178661">
				<div class="post-metadata">
					<div class="post-num">Post #189</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						18 Sep 2012, 20:54					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Alex Atkin UK wrote:</cite><blockquote><p>Had my first pppd hang, modem resynced and pppd didn&#039;t shut down.&nbsp; I had to manually kill pppd on the router.</p><p>I have changed <strong>maxfail 0</strong> to <strong>maxfail 10</strong>, hopefully that will stop it hanging in the future.</p></blockquote></div><p>How is everything else working now that the MSI interrupts have been disabled?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178697">
				<div class="post-metadata">
					<div class="post-num">Post #190</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						19 Sep 2012, 05:52					</div>
				</div>
				<div class="post-content content">
					<p>Latency is excellent, I haven&#039;t had to put that freaky dma hack on with this build.&nbsp; Pinging my ISPs router at the other end of the PPP link is pretty amazing:<br /></p><div class="codebox"><pre><code>PING 1x5.255.2x6.252 (1x5.255.2x6.252): 56 data bytes
64 bytes from 1x5.255.2x6.252: seq=0 ttl=64 time=4.206 ms
64 bytes from 1x5.255.2x6.252: seq=1 ttl=64 time=3.905 ms
64 bytes from 1x5.255.2x6.252: seq=2 ttl=64 time=4.012 ms
64 bytes from 1x5.255.2x6.252: seq=3 ttl=64 time=3.938 ms
64 bytes from 1x5.255.2x6.252: seq=4 ttl=64 time=8.007 ms
64 bytes from 1x5.255.2x6.252: seq=5 ttl=64 time=3.875 ms
64 bytes from 1x5.255.2x6.252: seq=6 ttl=64 time=4.100 ms
64 bytes from 1x5.255.2x6.252: seq=7 ttl=64 time=4.013 ms
64 bytes from 1x5.255.2x6.252: seq=8 ttl=64 time=3.890 ms
64 bytes from 1x5.255.2x6.252: seq=9 ttl=64 time=4.120 ms</code></pre></div><p>I did discover that I was right, IFB wasn&#039;t working.&nbsp; Looks like <a href="https://dev.openwrt.org/ticket/9620">this bug</a> still hasn&#039;t been patched in trunk, I have made the change myself now and it does seem to be apply the connection mark.&nbsp; </p><p>Lord knows why Netflix still worked perfectly with QoS none-functional though, I guess part of the reason it struggled must have been the old router being overloaded?</p><p>The download graphs are much more smooth on the Atom, on the Buffalo it was very bursty in nature with constant peaks whereas it maintains a more constant data stream now.&nbsp; It seems to have had a notable improvement on downloads off Xbox Live and PSN, although neither get anywhere near even 1/3 of my connection speed.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178755">
				<div class="post-metadata">
					<div class="post-num">Post #191</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						19 Sep 2012, 16:58					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Alex Atkin UK wrote:</cite><blockquote><p>Latency is excellent, I haven&#039;t had to put that freaky dma hack on with this build.&nbsp; Pinging my ISPs router at the other end of the PPP link is pretty amazing</p></blockquote></div><p>I&#039;m glad to hear it.&nbsp; </p><br /><div class="quotebox"><cite>Alex Atkin UK wrote:</cite><blockquote><p>I did discover that I was right, IFB wasn&#039;t working.&nbsp; Looks like <a href="https://dev.openwrt.org/ticket/9620">this bug</a> still hasn&#039;t been patched in trunk, I have made the change myself now and it does seem to be apply the connection mark.</p></blockquote></div><p>I&#039;ve created a ticket for this item <a href="https://bitbucket.org/mcrosson/nnopenwrt/issue/18/fix-qos-scripts-known-issue">here</a> and I&#039;ll be applying it to my sources soon.&nbsp; Probably after I get my router back to stable.</p><div class="quotebox"><cite>Alex Atkin UK wrote:</cite><blockquote><p>Lord knows why Netflix still worked perfectly with QoS none-functional though, I guess part of the reason it struggled must have been the old router being overloaded?</p><p>The download graphs are much more smooth on the Atom, on the Buffalo it was very bursty in nature with constant peaks whereas it maintains a more constant data stream now.&nbsp; It seems to have had a notable improvement on downloads off Xbox Live and PSN, although neither get anywhere near even 1/3 of my connection speed.</p></blockquote></div><p>This could very well be to the buffalo having trouble keeping up.&nbsp; I moved over to the Atom because I was seeing utilization spikes on my original netgear box I put into service.&nbsp; I all but gave up on anything &lt;1Ghz and 256Mb ram for my router a few years ago [more?] now.&nbsp; I had nothing but problems with the micro / embedded platforms like the Soekris and ALIX too.&nbsp; They never seemed to be able to really keep up with my usage.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178757">
				<div class="post-metadata">
					<div class="post-num">Post #192</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						19 Sep 2012, 17:25					</div>
				</div>
				<div class="post-content content">
					<p>The qos-scripts patch above wasn&#039;t applied for a reason. Quote from nbd:<br /></p><div class="quotebox"><blockquote><p>there&#039;s a limitation in ifb where it cannot run the per-packet netfilter rules before ingress shaping<br />that patch works around it by saving the connmark based on the result of per-packet rules, but that&#039;s not acceptable<br />it messes up conntrack vs per-packet rule handling</p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178767">
				<div class="post-metadata">
					<div class="post-num">Post #193</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						19 Sep 2012, 18:21					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jow wrote:</cite><blockquote><p>The qos-scripts patch above wasn&#039;t applied for a reason. Quote from nbd:<br /></p><div class="quotebox"><blockquote><p>there&#039;s a limitation in ifb where it cannot run the per-packet netfilter rules before ingress shaping<br />that patch works around it by saving the connmark based on the result of per-packet rules, but that&#039;s not acceptable<br />it messes up conntrack vs per-packet rule handling</p></blockquote></div></blockquote></div><p>@Alex: I&#039;m not as familiar with the QoS stuff, I&#039;m going to put this on hold given jow&#039;s comments.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178769">
				<div class="post-metadata">
					<div class="post-num">Post #194</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						19 Sep 2012, 18:29					</div>
				</div>
				<div class="post-content content">
					<p>Isn&#039;t that EXACTLY the limitation that the developers of IMQ use as their argument for why IFB is insufficient?</p><p>So knowing that, why is OpenWRT migrating to IFB at all?&nbsp; It seems like it wasn&#039;t fully thought through.</p><p>I guess its good we have IMQ support in this build after all.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178770">
				<div class="post-metadata">
					<div class="post-num">Post #195</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						19 Sep 2012, 18:40					</div>
				</div>
				<div class="post-content content">
					<p>OpenWrt migrated to IFB because keeping IMQ working for bleeding edge kernels was a huge pain in the ass. It might be seemingly simple right now because the kernel does not change but that is only because we&#039;re in the middle of preparing the release.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178771">
				<div class="post-metadata">
					<div class="post-num">Post #196</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						19 Sep 2012, 18:45					</div>
				</div>
				<div class="post-content content">
					<p>Understandable, except if IFB reduces the flexibility of the QoS implementation in OpenWRT its a HUGE step backwards IMO.</p><p>Or am I wrong and IFB can support 99% of use cases that IMQ can?</p><p>I have been trying to get my head around this for weeks as you can see on this thread, to use IFB or IMQ, that is the question.</p><p>I would rather stick with whatever OpenWRT has as standard for ease of building for the op, but if its a choice between an implementation that works and one that doesn&#039;t - its pretty obvious which to choose then.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178775">
				<div class="post-metadata">
					<div class="post-num">Post #197</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						19 Sep 2012, 19:27					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Alex Atkin UK wrote:</cite><blockquote><p>Understandable, except if IFB reduces the flexibility of the QoS implementation in OpenWRT its a HUGE step backwards IMO.</p><p>Or am I wrong and IFB can support 99% of use cases that IMQ can?</p></blockquote></div><p>There are also major concerns with time and management.&nbsp; If the dev&#039;s were spending too much time with getting IMQ working on a given kernel then it makes more sense to drop IMQ in favor of IFB.&nbsp; Release management is a tricky business and sometimes you have to fallback if the time investment grows too great.&nbsp; From what jow posted this sounds like one of those cases.</p><div class="quotebox"><cite>Alex Atkin UK wrote:</cite><blockquote><p>I have been trying to get my head around this for weeks as you can see on this thread, to use IFB or IMQ, that is the question.</p></blockquote></div><p>It looks like IFB is a bit newer and not quite as robust as the IMQ solution.&nbsp; If you read through the IMQ site and other write-ups it looks like this is similar to the zfs vs btrfs arguments.&nbsp; Both systems have their place and sometimes you&#039;ll need the one that&#039;s been around longer.</p><p>If my analogy is off base / wrong, please correct me and I&#039;ll update my post.</p><div class="quotebox"><cite>Alex Atkin UK wrote:</cite><blockquote><p>I would rather stick with whatever OpenWRT has as standard for ease of building for the op, but if its a choice between an implementation that works and one that doesn&#039;t - its pretty obvious which to choose then.</p></blockquote></div><p>Ease of building isn&#039;t a concern of mine at the moment.&nbsp; I&#039;ve done enough work building distro&#039;s from sources where I&#039;m not worried.&nbsp; My worry is that the Atom boards and other equipment I am targeting is properly utilized first and foremost.&nbsp; After that I want to make sure my needs and the needs of users are met.&nbsp; I started with OpenWRT because it is the best Linux Router distribution out there.&nbsp; It is also being actively maintained and has a good community.</p><p>The great part about a community is we can do things that fall outside of the core scope of the project.&nbsp; Like building OpenWRT for equipment that is well outside of their base target (Atom / C7 / XEON / Whatever).&nbsp; We can also take a closer look at setting up IMQ as a secondary package that is installable, but not on by default.&nbsp; This way the default matches documentation but if you need to deviate, you can.&nbsp; I already setup IMQ as a set of packages and the core can sit side by side with IFB.&nbsp; The trick would be the QoS scripts package.&nbsp; In order to finish off IMQ support, we will need to update the backfire QoS scripts package and set it up so you can have the IFB *or* IMQ version installed.&nbsp; Once we have an updated QoS scripts package we will likely be good to go, if not we play around with it and make it work in the end.</p><p>Keep in mind there is also a very large package change coming down the line.&nbsp; We may end up filling in gaps by default even if there was no IFB / IMQ discussion.&nbsp; I plan on keeping an eye on the package shuffle and hopefully I can step up and volunteer as maintainer of some.&nbsp; Either way I expect to get stuck working on updating some packages as needs arise.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178795">
				<div class="post-metadata">
					<div class="post-num">Post #198</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						20 Sep 2012, 01:01					</div>
				</div>
				<div class="post-content content">
					<p>The problem is that as I understand it from the documentation about IFB, the developer specifically said that IFB will NEVER work at the netfilter layer, as that was the whole reason for not putting IMQ in the kernel in the first place.<br />So IFB will never be a complete replacement for IMQ which means OpenWRT will have downgraded their QoS implementation.&nbsp; </p><p>Seeing as one of the top reasons for me using custom firmware is for QoS functionality, that&#039;s a pretty huge problem IMO.&nbsp; Granted, as long your Atom build works well I have no reason to go back to a pre-built MIPS router, but it still means OpenWRT loses some value as a firmware replacement.</p><p>As for an IMQ package, the only thing I did was take the following files from backfire and slap them onto your trunk build:</p><p>/usr/bin/qos-start<br />/usr/bin/qos-stop<br />/usr/bin/qos-stat<br />/usr/lib/qos/generate.sh<br />/usr/lib/qos/tcrules.awk</p><p>That seems to be all there is to it.&nbsp; Thanks to LuCI the configuration carries over without any changes.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178797">
				<div class="post-metadata">
					<div class="post-num">Post #199</div>
					<div class="post-author">mcrosson</div>
					<div class="post-datetime">
						20 Sep 2012, 01:16					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Alex Atkin UK wrote:</cite><blockquote><p>The problem is that as I understand it from the documentation about IFB, the developer specifically said that IFB will NEVER work at the netfilter layer, as that was the whole reason for not putting IMQ in the kernel in the first place.<br />So IFB will never be a complete replacement for IMQ which means OpenWRT will have downgraded their QoS implementation.&nbsp; </p><p>Seeing as one of the top reasons for me using custom firmware is for QoS functionality, that&#039;s a pretty huge problem IMO.&nbsp; Granted, as long your Atom build works well I have no reason to go back to a pre-built MIPS router, but it still means OpenWRT loses some value as a firmware replacement.</p><p>As for an IMQ package, the only thing I did was take the following files from backfire and slap them onto your trunk build:</p><p>/usr/bin/qos-start<br />/usr/bin/qos-stop<br />/usr/bin/qos-stat<br />/usr/lib/qos/generate.sh<br />/usr/lib/qos/tcrules.awk</p><p>That seems to be all there is to it.&nbsp; Thanks to LuCI the configuration carries over without any changes.</p></blockquote></div><p>I&#039;ll take a look.&nbsp; I was thinking of grabbing the backfire sources and using that as a base for a new qos-scripts-imq package.&nbsp; I want to properly package the necessary bits so it is easier for everyone that wants to change over to IMQ.</p><p>Edit: Ticket for tracking is <a href="https://bitbucket.org/mcrosson/nnopenwrt/issue/19/qos-scripts-package-for-imq">here</a></p>											<p class="post-edited">(Last edited by <strong>mcrosson</strong> on 20 Sep 2012, 01:17)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178798">
				<div class="post-metadata">
					<div class="post-num">Post #200</div>
					<div class="post-author">Alex Atkin UK</div>
					<div class="post-datetime">
						20 Sep 2012, 01:25					</div>
				</div>
				<div class="post-content content">
					<p>The only other thing I aware of is the kernel module, which so far I haven&#039;t seen any issues with keeping them both on there as default as which QoS scripts you are using determines which module is actually loaded.</p><p>I just switched from IFB to IMQ right now on my router without rebooting, it doesn&#039;t seem to have caused any issues that I can see.&nbsp; I just made sure I ran qos-stop before overwriting the scripts with the IMQ versions, then qos-start.</p>									</div>
			</article>

			
		
						<div class="notice">
				<p>Sorry, posts 201 to 200 are missing from our archive.</p>
			</div>
		
		
	
	<div class="pagination"><div class="pagination-number">Page 8 of 17</div><nav><ul><li><a href="viewtopic.php%3Fid=35887&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=35887&amp;p=6.html">6</a></li><li><a href="viewtopic.php%3Fid=35887&amp;p=7.html">7</a></li><li class="pagination-current"><span>8</span></li><li><a href="viewtopic.php%3Fid=35887&amp;p=9.html">9</a></li><li><a href="viewtopic.php%3Fid=35887&amp;p=10.html">10</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=35887&amp;p=17.html">17</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>