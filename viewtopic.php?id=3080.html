<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> packet jam when openwrt has br0 configed on same subnet</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 27 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p14502">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">JasonStraight</div>
					<div class="post-datetime">
						29 Oct 2005, 16:48					</div>
				</div>
				<div class="post-content content">
					<p>This one has me stumped:</p><p>Scenario:<br />openwrt rc3<br />linksys is _CLIENT_ to wireless network - not the AP<br />Mode: Repeater<br />br0: inet addr:192.168.37.120&nbsp; Bcast:192.168.37.255&nbsp; Mask:255.255.255.0<br />- all other config is standard other than being setup as repeater -<br />My laptop on wired side: ath0 64.x.37.120 ath0:1 192.168.37.250</p><br /><p>The network the wrt is bridging for is _NOT_ 192.168.37.x normally. That&#039;s just what I have setup so that I can get at it but it doesn&#039;t need to be accessible from the internet.</p><p>Problem: (note arping needs -b)<br />If I ssh to 64.x.37.1 (which is on the wireless side of the wrt) and arping my lappy on the 64 net everything is happy.</p><p>If I arping my lappy&#039;s 192 addy it hangs, it doesn&#039;t lose packets, but it just stops for a while, then spits out everything at one time like it&#039;s buffering then flushing the buffer.</p><p>I know this is happening at the wrt, I&#039;ve verified with tcpdump. I can arping my 64 addy fine, but arping the 192 addy stutters. I&#039;ve switched the network on the wrt to 64 and the problem reverses itself. So I know it&#039;s got something to do with the br0 being configured to the same subnet as the traffic it&#039;s trying to pass along. The arp replies make it to the wrt but it waits for some period of time before sending a bunch of buffered arp replies out eth1.</p><p>The first time I tried this I setup the wrt with a real IP the first time and had all kinds of problems with traffic &quot;clogging-up&quot;.</p><p>Anyone have any ideas? We are a WISP (Wireless Internet Service Provider) and basically have a boner over the idea of having client radios with so many features, but we will sometimes need the ability to use real world IP#&#039;s on them, which is going to cause problems for the client who is on the other side of them with the same subnet.</p><p>Thanks.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p14505">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">JasonStraight</div>
					<div class="post-datetime">
						29 Oct 2005, 17:20					</div>
				</div>
				<div class="post-content content">
					<p>More clues:</p><p>running tcpdump on wrt sees the packets from wireless side reaching the wrt, but never going out vlan0 when it&#039;s hanging up. What I just dont&#039; get is how can X ping -&gt; wrt -&gt; Y work, but Y -&gt; wrt -&gt; X have problems? As far as the wrt is concerned it&#039;s still just a packet marked with x destination. The only thing I can think of is that the wrt is getting confused which interface 192.168.37.250 is on (wired), and when 250 is pinging 1, the wrt is seeing those packets which is updating the bridge table and therefore reminding the wrt there 250 really is.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>