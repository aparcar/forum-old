<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Storage Administration Tool</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 16 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p151188">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">dir2cas</div>
					<div class="post-datetime">
						14 Dec 2011, 22:08					</div>
				</div>
				<div class="post-content content">
					<p>Hello All,</p><p>This Topic is an extension to my <a href="https://forum.openwrt.org/viewtopic.php?id=31295">Samba user administration script</a>. However, since the concept is a little changed, I decided to start a new thread.</p><p><strong>Introduction</strong>:<br />In fact this is almost the same bash script but much more functional and featured, so I call it a tool. Its purpose is to simplify and facilitate the user administrations related actions for storage and file services like Samba and FTP.<br />As we know we have no useradd/adduser, etc on an out of the box OpenWrt install, we should build them in busybox and build the firmware again. Well, it is not much of a hard work, but even then we have to take care for user&#039;s directoried, permissions, configurations and so on....</p><p>The purpose of the tool (named &quot;storageadm.sh&quot;) is to give us the ability to predefine several common services settings and after them control them with a stiil-not restricted flexibility. Here I have included two major storage services:<br /><strong>storageadm.sh</strong>:<br /><span style="color: blue">1) Samba file Server<br />2) Vsftpd FTP Server</span></p><p><strong>Packages required</strong>:<br />- bash (highly recommended)<br />- samba3<br />- vsftpd<br />- modules and packages needed to get your storage hw running - look <a href="http://wiki.openwrt.org/doc/howto/usb.storage">here</a> and <a href="http://wiki.openwrt.org/doc/howto/extroot">here</a></p><p><strong>Comments</strong>:<br />My OpenWrt box is currently running a custom build of&nbsp; Backfire (10.03.1-RC6, r29275) on TP-Link TL-WR1043ND, but the script is designed to be as much universal as possible, so you simply need to edit several self-explanatory variables at the beginning and feel free to use it. In general, variables defined by other variables does not need the be changes, but only the plain text ones. Of course, since it is a simple text, you may feel free to modify and alter it towards your personal needs.<br />It is currenlt configured for a sample directory structure, that you may see in <a href="https://forum.openwrt.org/viewtopic.php?id=31295">Samba user administration script</a>. It could be changed anytime. </p><p>- The main idea is tha we have a global Samba administrator that is owner of the whole share dir and that every user has its own directory and rw permissions only for it. <br />- Samba user&#039;s dir is also user&#039;s FTP directory.<br />- The script checks if a user exists on the system when trying to add or remove it. When you try to add a user for FTP service the script firstly configures it for Samba, thus creating user&#039;s entries and directories and implementing the correct user group and home dir. <br />- You may change the password of an existing user by running the add (-a for samba) and (-f for FTP) option again.<br />- When trying to remove an existing user, a warning prompt is displayed.<br />- FTP configuration is automatically generated by the tool creating a backup of the old configuration. You can also change the vsftpd configuration after that. <br />- Security options are enabled - the idea is to keep everything simple, flexible and secure.</p><p>I hope a web front end coulb be also written (php based) in order to make it a little more friendly to use, in spite that I particularly like the CLI style.</p><p><strong>Get it running</strong>:<br />Here is the script itself. The bash package is highly recommended!<br /><strong><span style="color: blue">Copy -&gt; Paste -&gt; Save as &quot;storageadm.sh&quot; somewhere on your router -&gt; make it executable (chmod +x storageadm.sh) -&gt; run <em>./storageadm.sh -h </em>for usage notes.</span></strong></p><div class="codebox"><pre><code>#!/bin/sh
#
# Version v1.8
# Script for Creating new Samba user and configuring parameters.
# Developed by dir2cas &lt;kalin.t.ivanov@gmail.com&gt;
#
# Additional features for vsftpd FTP server is implemented, 
# allowing local samba users to have FTP access to their home directories.
#
# Required packages: samba3, vsftpd
# Recommended packages: bash

#SCRIPTNAME=&quot;${0}&quot;
OPTION=&quot;$1&quot;
USER=&quot;$2&quot;
SCRIPTNAME=&quot;storageadm.sh&quot;

################ SCRIPT CONFIGURATION ################ 
#Defining variables:
SAMBA_ADMIN=&quot;admin&quot;
SAMBA_GROUP=&quot;smbusers&quot;

SAMBA_SHARE_DIR=&quot;/mnt/storage/SHARE&quot;
SAMBA_USER_DIR=&quot;${SAMBA_SHARE_DIR}/users/${USER}&quot;
#SAMBA_HOME=&quot;/var&quot;
SAMBA_HOME_ADMIN=&quot;${SAMBA_SHARE_DIR}&quot;
SAMBA_HOME=&quot;${SAMBA_USER_DIR}&quot;
SAMBA_SHELL=&quot;/bin/false&quot;
SAMBA_GROUP_ID=&quot;1001&quot;
SAMBA_USER_ID_START=&quot;1001&quot;

FTP_ENABLE=&quot;1&quot;                 # Set to &quot;1&quot; to enable the FTP service
VSFTPD_CONF=&quot;/etc/vsftpd.conf&quot;
FTP_SECURE_LOGIN_FILE=&quot;/etc/vsftpd.users&quot;
FTP_LISTEN_ADDR=&quot;192.168.1.1&quot;        # Leave blank to listen on all addresses/interfaces
FTP_LISTEN_PORT=&quot;21&quot;            # If in standalone mode, this is the port listen on for incoming FTP connections (default=21)
FTP_BANDWIDTH=&quot;8000&quot;             # Maximum data transfer rate in kbps
FTP_BANNER=&quot;Welcome to Kanzownet-Sofia FTP service.&quot;     # Your FTP server welcome message
FTP_MAX_CLIENTS=&quot;15&quot;             # Maximum number of clients that may be connected
FTP_MAX_CONN_IP=&quot;2&quot;            # Maximum connections per IP
FTP_MAX_LOGIN_FAILS=&quot;3&quot;         # After this many login failures, the session is killed (default=3)
FTP_IDLE_TIMEOUT=&quot;120&quot;            # Timeout in seconds - the maximum time a remote client may spend between FTP activity
#######################################################

Usage() {
# Define the help/warning message:
echo -e &quot;\tUsage: ${SCRIPTNAME} [OPTION] &lt;samba/ftp username&gt;\n\t-a - add user to the File Server (changes password if exists)\n\t-f - add user to vsftpd\n\t-d - remove user from Samba and FTP\n\t-s - display storage services status\n\t-h, --help - show this menu&quot;
}


UserCheck() {
# This function returns &quot;0&quot; if the user is already configured on the system and &quot;1&quot; if it is not
local USER=&quot;$1&quot;
user_check=$(grep -e &quot;${USER}&quot; /etc/passwd | grep &quot;${SAMBA_GROUP}&quot; | cut -d: -f1)
if [ &quot;${user_check}&quot; = &quot;${USER}&quot; ]; then     #true(1) - the user exists; false(0) - the user does not exist
    #Exists
    return &quot;0&quot;
else
    #Does NOT exist
    return &quot;1&quot;
fi
}


VsftpdCheck() {
# This function returns &quot;0&quot; if vsftpd is OK and &quot;1&quot; if it is not
if [ &quot;${FTP_ENABLE}&quot; -ne &quot;1&quot; ]; then     
    echo -e &quot;Option ${OPTION} cannot be used\nFTP service option is disabled\nPlease set FTP_ENABLE=&quot;1&quot; in the script config section\nbut first verify that vsftpd package is installed -&gt; $ opkg list_installed | grep vsftpd\n&quot;
    return 1
else
    hash vsftpd &gt; /dev/null 2&gt;&amp;1
    if [ $? -ne 0 ]; then
        echo -e &quot;###WARNING###\nvsftpd not found&quot;
        echo -e &quot;Probably it is not installed on the system\nPlease, verify that vsftpd package is installed -&gt; $ opkg list_installed | grep vsftpd and install it&quot;
        logger -t ${SCRIPTNAME} &quot;vsftpd not found, probably it is not installed&quot;
        return 1
    else
        #Check if vsftpd has a configuration file
        if [ ! -f ${VSFTPD_CONF} ]; then
            echo -e &quot;${VSFTPD_CONF}: does not exist as valid file argument\nProbably vsftpd is not installed\n&quot;
            logger -t ${SCRIPTNAME} &quot;${VSFTPD_CONF}: does not exist&quot;
            return 1
        elif [ ! -r ${VSFTPD_CONF} ]; then
            echo -e &quot;${VSFTPD_CONF}: can not be read\n&quot;
            logger -t ${SCRIPTNAME} &quot;${VSFTPD_CONF}: can not be read&quot;
            return 1
        fi    
    fi    
fi

#If all above is passed without any return error code, assuming that vsftpd is OK
return 0
}


StorageStat() {
#Displaying Storage Services status
local VAR
echo -e &quot;\nSAMBA\n---------------------------------------------------\n  USER:GROUP\t\tHOME DIR:&quot;
for VAR in $(cat /etc/samba/smbpasswd | cut -d: -f1); do 
    echo -e &quot;$(echo ${VAR}):$(cat /etc/passwd | grep -e ${VAR} | cut -d: -f5) --&gt;\t$(cat /etc/passwd | grep -e ${VAR} | cut -d: -f6)&quot;
done
echo -e &quot;\n---------------------------------------------------\nSamba Share Folder is --&gt; ${SAMBA_SHARE_DIR}\nSamba Global Administrator is --&gt; ${SAMBA_ADMIN} (uid=$(uid=$(grep -e &quot;${SAMBA_ADMIN}&quot; /etc/passwd | cut -d: -f3); if [ -z ${uid} ]; then uid=&quot;N/A&quot;; fi; echo &quot;${uid}&quot;))\nSamba User&#039;s group is set to --&gt; ${SAMBA_GROUP} (gid=$(gid=$(grep -e &quot;${SAMBA_GROUP}&quot; /etc/group | cut -d: -f3); if [ -z ${gid} ]; then gid=&quot;N/A&quot;; fi; echo &quot;${gid}&quot;))&quot;

#Check for vsftpd secure login file:
if [ ! -f ${FTP_SECURE_LOGIN_FILE} ]; then
    #echo -e &quot;${FTP_SECURE_LOGIN_FILE}: does not exist yet\ncreating...\n&quot;
    logger -t ${SCRIPTNAME} &quot;${FTP_SECURE_LOGIN_FILE}: does not exist, probably no users are configured for FTP&quot;
    echo -e &quot;\nFTP (vsftpd)\n---------------------------------------------------\n  USER:GROUP\t\tFTP DIR:&quot;
    echo -e &quot;STILL NO FTP ENABLED USERS&quot;
    if [ -z &quot;$(grep -e &quot;${SCRIPTNAME}&quot; ${VSFTPD_CONF})&quot; ]; then 
        echo -e &quot;\n---------------------------------------------------\nSTILL NO FTP CONFIGURATION&quot;
    else
        echo -e &quot;\n---------------------------------------------------\nFTP Server Bandwidth Limit is --&gt; ${FTP_BANDWIDTH}kbps ($(( (${FTP_BANDWIDTH} / 8) * 1024 )))Bytes/s\nFTP Server is listening on --&gt; ${FTP_LISTEN_ADDR}\nFTP Server is currently available on port --&gt; ${FTP_LISTEN_PORT}\nFTP Server Maximum Simultaneous Clients --&gt; ${FTP_MAX_CLIENTS}\n&quot;
    fi
else 
    echo -e &quot;\nFTP (vsftpd)\n---------------------------------------------------\n  USER:GROUP\t\tFTP DIR:&quot;
    for VAR in $(cat ${FTP_SECURE_LOGIN_FILE} | awk &#039;{print $1}&#039;); do 
        echo -e &quot;$(echo ${VAR}):$(cat /etc/passwd | grep -e ${VAR} | cut -d: -f5) --&gt;\t$(cat /etc/passwd | grep -e ${VAR} | cut -d: -f6)&quot;
    done
    if [ -z ${FTP_LISTEN_ADDR} ]; then FTP_LISTEN_ADDR=&quot;All Interfaces&quot;; fi
    echo -e &quot;\n---------------------------------------------------\nFTP Server Bandwidth Limit is --&gt; ${FTP_BANDWIDTH}kbps ($(( (${FTP_BANDWIDTH} / 8) * 1024 )))Bytes/s\nFTP Server is listening on --&gt; ${FTP_LISTEN_ADDR}\nFTP Server is currently available on port --&gt; ${FTP_LISTEN_PORT}\nFTP Server Maximum Simultaneous Clients --&gt; ${FTP_MAX_CLIENTS}\n&quot;
fi
}


SambaPassword() {
#Configuring the Samba passwd for the specified user
echo -ne &quot;Please, enter SMB password for the new user ${USER}:\n&quot;
read password
clear
sleep 1
${SAMBA_PASSWD} ${USER} ${password}
/etc/init.d/samba restart &gt;&amp;- 2&gt;&amp;-
echo -e &quot;\tSamba password set\n&quot; 

unset password
sleep 1
}


AddUser() {

if [ ! -d &quot;${SAMBA_SHARE_DIR}&quot; ]; then
    #echo &quot;Directory does not exist&quot;
    echo &quot;Creating directory&quot;
    mkdir -p ${SAMBA_SHARE_DIR}
    #Setting the permission for the main share directory
    chown -R ${SAMBA_ADMIN}:${SAMBA_GROUP} ${SAMBA_SHARE_DIR}
    chmod -R u=rwx,g=rx,o= ${SAMBA_SHARE_DIR}
fi

# Creating the user entries:
SAMBA_ADMIN_ENTRY=&quot;${SAMBA_ADMIN}:*:${SAMBA_USER_ID_START}:${SAMBA_GROUP_ID}:${SAMBA_GROUP}:${SAMBA_HOME_ADMIN}:${SAMBA_SHELL}&quot;
SAMBA_GROUP_ENTRY=&quot;${SAMBA_GROUP}:x:${SAMBA_GROUP_ID}:&quot;

#Creating the new Samba group if it does not exist
grep -e &quot;${SAMBA_GROUP_ENTRY}&quot; /etc/group &gt;/dev/null || echo &quot;${SAMBA_GROUP_ENTRY}&quot; &gt;&gt; /etc/group

#Creating the Samba administrator account if it does not exist
#grep -e &quot;${SAMBA_ADMIN_ENTRY}&quot; /etc/passwd &gt;/dev/null || echo &quot;${SAMBA_ADMIN_ENTRY}&quot; &gt;&gt; /etc/passwd
UserCheck ${SAMBA_ADMIN}
if [ $? -eq 1 ]; then     # 1 will be returned by UserCheck function showing that the admin is not set on the system
    #Create the Samba administrator (smbadmin user), because it does not exist
    echo -e &quot;Creating the Samba global administrator\n&quot;
    echo &quot;${SAMBA_ADMIN_ENTRY}&quot; &gt;&gt; /etc/passwd
    echo -ne &quot;Please, enter password for the Samba global administrator ${SAMBA_ADMIN}:\n&quot;
    read password
    clear
    sleep 1
    ${SAMBA_PASSWD} ${SAMBA_ADMIN} ${password}
    unset password 
    #Setting the permission for the main share directory
    chown -R ${SAMBA_ADMIN}:${SAMBA_GROUP} ${SAMBA_SHARE_DIR}
    chmod -R u=rwx,g=rx,o= ${SAMBA_SHARE_DIR}
fi

#Check if the user is already a valid Samba user
UserCheck ${USER}
if [ $? -eq 0 ]; then
    echo -e &quot;###WARNING###\nUser ${USER} is already present as valid Samba user&quot;
    echo -e &quot;\nOnly Samba password change will be executed&quot;
    sleep 1
    # Call the function to set the new samba user password
    SambaPassword
    exit 0
fi

#Creating the new Samba username and user on the server itself if it does not exist
#Status message:
echo -e &quot;\nConfiguring user ${USER}...\n&quot;

SAMBA_USER_ID=$(grep -e &quot;${SAMBA_GROUP}&quot; /etc/passwd | tail -n1 | cut -d: -f3)
let &quot;SAMBA_USER_ID += 1&quot;
SAMBA_USER_ENTRY=&quot;${USER}:*:${SAMBA_USER_ID}:${SAMBA_GROUP_ID}:${SAMBA_GROUP}:${SAMBA_HOME}:${SAMBA_SHELL}&quot;
grep -e &quot;${SAMBA_USER_ENTRY}&quot; /etc/passwd &gt;/dev/null || echo &quot;${SAMBA_USER_ENTRY}&quot; &gt;&gt; /etc/passwd

#Configuring the new user directory
mkdir -p ${SAMBA_USER_DIR}
mkdir -p ${SAMBA_USER_DIR}/Private
touch ${SAMBA_USER_DIR}/.profile
chown -R ${USER}:${SAMBA_GROUP} ${SAMBA_USER_DIR}

#Set the user permissions
chmod -R u=rwx,g=rx,o= ${SAMBA_USER_DIR}

#Prohibit access to the particular user&#039;s private folder
chmod u=rwx,go= ${SAMBA_USER_DIR}/Private
#chmod -R u=rw,go= ${SAMBA_USER_DIR}/Private/

sleep 3
# Call the function to set the new samba user password
SambaPassword

}


VsftpdAdd() {
# This function might add a Samba user to the vsftpd and grand access to the user&#039;s home dir

#Check if FTP service is enabled and if vsftpd is present on the system
VsftpdCheck
if [ $? -eq 1 ]; then
    #vsftpd error detected, exiting
    exit 1
fi

#Check if the new user is already a valid Samba user
UserCheck ${USER}
if [ $? -eq 1 ]; then
    echo -e &quot;###WARNING###\nUser ${USER} is NOT a valid Samba user&quot;
    echo -e &quot;\nWe are going to configure it for Samba first&quot;
    sleep 1
    AddUser
    echo -e &quot;\nSamba configuration done, proceeding to FTP service&quot;
fi

#Check for vsftpd secure login file:
if [ ! -f ${FTP_SECURE_LOGIN_FILE} ]; then
    echo -e &quot;${FTP_SECURE_LOGIN_FILE}: does not exist yet\ncreating...\n&quot;
    logger -t ${SCRIPTNAME} &quot;${FTP_SECURE_LOGIN_FILE}: does not exist, creating...&quot;
    touch ${FTP_SECURE_LOGIN_FILE}
    chmod u=rw,go= ${FTP_SECURE_LOGIN_FILE}
fi

#Checking if vsftpd has already been configured
sleep 1
vsftpd_check=$(grep -e &quot;${SCRIPTNAME}&quot; ${VSFTPD_CONF})
if [ -z &quot;${vsftpd_check}&quot; ]; then     # -n the argument is non empty, -z the argument is empty
    # Backing up the if there is some old configuration first
    cp ${VSFTPD_CONF} ${VSFTPD_CONF}.backup &gt; /dev/null 2&gt;&amp;1
    # Evaluate the FTP server bandwidth in Byte/s to be ready for the config file
    FTP_BANDWIDTH_BYTES=$(( (${FTP_BANDWIDTH} / 8) * 1024 ))
    # Writing the FTP server configuration (vsftpd)
    echo -e &quot;# ${VSFTPD_CONF} -- a config file for vsftpd\n###generated by ${SCRIPTNAME}\nbackground=YES\nlisten=YES\nlisten_address=${FTP_LISTEN_ADDR}\nlisten_port=${FTP_LISTEN_PORT}\nanonymous_enable=NO\nlocal_enable=YES\nwrite_enable=YES\n#chroot_list_enable=YES\n#chroot_list_file=${FTP_SECURE_LOGIN_FILE}\nchroot_local_user=YES\nuserlist_enable=YES\nuserlist_file=${FTP_SECURE_LOGIN_FILE}\nuserlist_deny=NO\nlocal_umask=027\ncheck_shell=NO\nftpd_banner=${FTP_BANNER}\nlocal_max_rate=${FTP_BANDWIDTH_BYTES} # Maximum data transfer rate in bytes per second\nmax_clients=${FTP_MAX_CLIENTS}         # Maximum number of clients that may be connected\nmax_per_ip=${FTP_MAX_CONN_IP}           # Maximum connections per IP\nmax_login_fails=${FTP_MAX_LOGIN_FAILS}\nidle_session_timeout=${FTP_IDLE_TIMEOUT}\nuse_localtime=YES\nsession_support=NO&quot; &gt; ${VSFTPD_CONF}
fi

echo -ne &quot;Please, enter FTP password for the new user ${USER}:\n&quot;
passwd ${USER}

#Check if the last command is successfull
while [ $? -eq 1 ]
do
    echo -ne &quot;\nIncorrect! Try again&quot;
    echo -ne &quot;\nPlease, enter FTP password for the new user ${USER}:\n&quot;
    passwd ${USER}    
done

sleep 1
#Configure the new user for FTP secure login:
grep -e &quot;${USER}&quot; ${FTP_SECURE_LOGIN_FILE} &gt;/dev/null || echo &quot;${USER}&quot; &gt;&gt; ${FTP_SECURE_LOGIN_FILE}
sleep 1
# Remove the pseudo copy of /etc/passwd
rm -f /etc/passwd- &gt; /dev/null 2&gt;&amp;1
# Restart the FTP service
/etc/init.d/vsftpd stop &gt;&amp;- 2&gt;&amp;-
sleep 1
/etc/init.d/vsftpd start &gt;&amp;- 2&gt;&amp;-
echo -e &quot;FTP password set\n&quot;

echo Finished
sleep 1

}


DelUser() {
#This function might remove all of the user files and directories as well as the user from the server itself for both Samba and FTP (if both are configured)

#First check if the new user is already a valid Samba user
UserCheck ${USER}
if [ $? -eq 1 ]; then
    echo -e &quot;###WARNING###\nUser ${USER} is NOT a valid Samba user&quot;
    echo -e &quot;\nProbably it does not exist on the system yet&quot;
    exit 1
fi

# Check if the user data should be deleted and warn that all data would be removed
echo -e &quot;\n### WARNING ###\nThis will remove all user data on the system for the user ${USER}\nincluding its files on the storage disk\n&quot;
while :
do
    echo -e &quot;Proceed? (yes/no)&quot;
    read answer
    
    case &quot;${answer}&quot; in
        [Yy]* )
            echo -e &quot;\nThe user and its data will be deleted&quot;
            unset answer
            break
           ;;
        [Nn]* )
            echo -e &quot;\nRefused\n&quot;
            unset answer
            exit 0
           ;;
        * )
            echo -e &quot;\nWrong answer, try again\n&quot;
            unset answer
           ;;
    esac
done        

sleep 1
rm -R -f ${SAMBA_USER_DIR}
#Status message:
echo -e &quot;Removing user ${USER}...\n&quot;
sleep 1
#sed -i &#039;/&#039;&quot;${USER}&quot;&#039;/ d&#039; /etc/samba/smbpasswd
${SAMBA_PASSWD} -del ${USER} &gt;&amp;- 2&gt;&amp;-
sed -i &#039;/&#039;&quot;${USER}&quot;&#039;/ d&#039; /etc/passwd &gt; /dev/null 2&gt;&amp;1
sed -i &#039;/&#039;&quot;${USER}&quot;&#039;/ d&#039; ${FTP_SECURE_LOGIN_FILE} &gt; /dev/null 2&gt;&amp;1
rm -f /etc/passwd- &gt; /dev/null 2&gt;&amp;1
sleep 1
# Services restart
/etc/init.d/samba restart &gt;&amp;- 2&gt;&amp;-
/etc/init.d/vsftpd stop &gt;&amp;- 2&gt;&amp;-
sleep 1
/etc/init.d/vsftpd start &gt;&amp;- 2&gt;&amp;-

echo Finished
sleep 1

exit 0
}


#################################################################################################
#MAIN
OPTION=&quot;$1&quot;
USER=&quot;$2&quot;

#Initialize script parameters and usage
if [ &quot;$#&quot; -ne &quot;2&quot; ] || [ &quot;${OPTION}&quot; = &quot;-h&quot; ] || [ &quot;${OPTION}&quot; = &quot;--help&quot; ] || [ &quot;${OPTION}&quot; = &quot;help&quot; ]; then
    if [ &quot;${OPTION}&quot; != &quot;-s&quot; ]; then
        Usage
        exit 0
    fi
fi

################# SCRIPT INTERNAL CHECK ###############
# Commands
SAMBA_PASSWD=&quot;$(which smbpasswd)&quot;

# Check if needed commands and tools are present on the system:
if [ ! -x ${SAMBA_PASSWD} ]; then
    echo -e &quot;${SCRIPTNAME} Error: Samba is probably not present\nPlease verify that samba3 package is installed\n&quot;
    exit 1
fi
#######################################################

case ${OPTION} in
     &quot;-a&quot; )
        AddUser
        exit 0
       ;;
     &quot;-f&quot; )
        VsftpdAdd
        exit 0
           ;;
     &quot;-d&quot; )
        DelUser
           ;;
     &quot;-s&quot; )
        StorageStat | more
        exit 0
           ;;
     * )
        echo -e &quot;&lt;${OPTION}&gt; is invalid script option\n&quot;
        Usage
        exit 0
           ;;
esac</code></pre></div><p><strong>Updated to v1.4</strong><br /> - optimised script source<br /> - added check for user presnece on the system<br /> - stability improvements</p><p><strong>Updated to v1.5</strong><br /> - added several FTP (vsftpd) options to be predefined </p><p><strong>Updated to v1.6</strong><br /> - added support for the default /bin/sh Busybox shell (no more bash is required, but optional)<br /> - optimised script source</p><p><strong>Updated to v1.7</strong><br /> - added smbpasswd binary path check and correct usage<br /> - script code arrangement </p><p><strong><span style="color: #FF0000">Updated to v1.8</span></strong><br /> - added new option: samba and ftp services status display (-s option), see tool help<br /> - possibility to enable/disable ftp service functions of the tool from the script config section (in case you do not need ftp functionalities)<br /> - internal check for proper ftp service usage and configuration<br /> - optimised script source</p><p>Regards,<br />dir2cas</p>											<p class="post-edited">(Last edited by <strong>dir2cas</strong> on 10 Feb 2012, 03:15)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p151634">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">jefbohn</div>
					<div class="post-datetime">
						20 Dec 2011, 19:38					</div>
				</div>
				<div class="post-content content">
					<p>Thanx for this extension!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p152345">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">dir2cas</div>
					<div class="post-datetime">
						29 Dec 2011, 16:46					</div>
				</div>
				<div class="post-content content">
					<p>The first post would be edited accordingly, upon any changes and improvements of the tool. <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>Regards,<br />dir2cas</p>											<p class="post-edited">(Last edited by <strong>dir2cas</strong> on 13 Jan 2012, 13:37)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p152358">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">written_direcon</div>
					<div class="post-datetime">
						29 Dec 2011, 18:36					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dir2cas wrote:</cite><blockquote><p>- bash (highly recommended)</p></blockquote></div><p>The default shell in OpenWrt is sh from Busybox. You should make your script compatible for sh.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p153282">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">lizby</div>
					<div class="post-datetime">
						6 Jan 2012, 04:26					</div>
				</div>
				<div class="post-content content">
					<p>I made the script compatible with sh by removing the word &quot;function&quot; where it occurs.&nbsp; I successfully ran the script to create a user for samba and vsftp.&nbsp; I did /etc/init.d/vsftpd restart</p><p>Now I have a very newbie question.&nbsp; How do I access a directory on the drive via ftp?&nbsp; I&#039;m trying from windows Vista.&nbsp; I open windows explorer, and on the command line put &quot;ftp://192.168.2.93/&quot;&nbsp; I get &quot;windows cannot access the folder&quot;.&nbsp; I&#039;m clearly getting the system as set up by the script, because I get the banner which I set up in the script: &quot;Welcome to Omnibus FTP service&quot;.&nbsp; I&#039;m not getting a prompt to enter my username and password.</p><p>/etc/vsftpd.conf and /etc/vsftpd.users appear to be set up reasonably.&nbsp; There are directories for the two users I set up under \home.&nbsp; </p><p>This is on a WR1043, trunk as of today.&nbsp; I ask because I am ignorant of how to go about establishing a connection.</p><p>In a related question, how do I designate which directory on my usb drive is pointed to by the ftp connection for a user?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p153378">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">dir2cas</div>
					<div class="post-datetime">
						6 Jan 2012, 20:05					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>lizby wrote:</cite><blockquote><p>I made the script compatible with sh by removing the word &quot;function&quot; where it occurs.&nbsp; I successfully ran the script to create a user for samba and vsftp.&nbsp; I did /etc/init.d/vsftpd restart</p><p>Now I have a very newbie question.&nbsp; How do I access a directory on the drive via ftp?&nbsp; I&#039;m trying from windows Vista.&nbsp; I open windows explorer, and on the command line put &quot;ftp://192.168.2.93/&quot;&nbsp; I get &quot;windows cannot access the folder&quot;.&nbsp; I&#039;m clearly getting the system as set up by the script, because I get the banner which I set up in the script: &quot;Welcome to Omnibus FTP service&quot;.&nbsp; I&#039;m not getting a prompt to enter my username and password.</p><p>/etc/vsftpd.conf and /etc/vsftpd.users appear to be set up reasonably.&nbsp; There are directories for the two users I set up under \home.&nbsp; </p><p>This is on a WR1043, trunk as of today.&nbsp; I ask because I am ignorant of how to go about establishing a connection.</p><p>In a related question, how do I designate which directory on my usb drive is pointed to by the ftp connection for a user?</p></blockquote></div><p>Hi, indeed the script should be compatible with /bin/sh by removing the function keyword recognised by bash, I know that. I simply put bash on every openwrt image I use and did not tested fully the script functionality without bash. It is possible some constructions do not work correctly, that&#039;s why I did not spacify that. <br />Well, thanks for the remark now, I am going to test it fully with each of the options under the default sh and will update it in the new version.</p><p>In order to access the ftp server on your router, you may use an ftp client (CLI: $ftp - win/linux, or GUI like fileZila - windows). You can also access the ftp server via the web browser. After pointing to <a href="ftp://192.168.2.93">ftp://192.168.2.93</a> or <a href="ftp://192.168.2.93">ftp://192.168.2.93</a>:port_num if you have changed the default port of the server, you have to be prompted for user and password input, that&#039;s all,</p><p>Regarding the last question - I have setup the user&#039;s home directory to be the one accessible by the particular ftp user. So, the home directory is set to be the user&#039;s share direcotry that is created by samba. That is the reason why the script does not allow you to create a new user for FTP without creating it first on the samba server. The purpose is for security - each user is jailed in its user&#039;s directory on the samba server (t.e its home directory) and is not allowed to touch any other stuff on the system. <br />Look at the variables at the beginning:<br />SAMBA_SHARE_DIR=&quot;/mnt/storage/SHARE&quot;<br />SAMBA_USER_DIR=&quot;${SAMBA_SHARE_DIR}/users/${USER}&quot;<br />...<br />SAMBA_HOME=&quot;${SAMBA_USER_DIR}&quot;</p><p>this says that if your user is &quot;peter&quot; his home directory (also seen in /etc/passwd) will be:<br />/mnt/storage/SHARE/users/peter<br />So, it is recommended to mount your usb storage under, for expample $SAMBA_SHARE_DIR or on a higher directory level, it depends also on your samba share configuration. <br />My storage is mounted under /mnt/storage and I am running two samba shares over it that are also over two different disk partitions - the first one serves the whole /mnt/storage/, the other one is mounted /mnt/storage/SHARE/users. This prevents the users from eating up the whole storage. You may find this in the link that I gave in my first post pointing to the other thread I have created for this script before, </p><p>Well, we told that peter&#039;s home dir would be /mnt/storage/SHARE/users/peter.<br />This is the direcotry that will be accessed after logging in the FTP server with peter&#039;s credentials. This is also the directory where peter has rw access. However the whole SHARE dir is accessible by the user under samba, only user&#039;s home directory is accessible under the FTP service. Security purpose</p><p>We may also change the user to have access to the whole SHARE under the ftp service, but if you think it is needed, we have to change the configuration of the whole ftp server.</p>											<p class="post-edited">(Last edited by <strong>dir2cas</strong> on 6 Jan 2012, 20:14)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p153397">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">lizby</div>
					<div class="post-datetime">
						6 Jan 2012, 21:37					</div>
				</div>
				<div class="post-content content">
					<p>Thank you for your explanation--I&#039;m connected now.</p><p>Why I&#039;m connected now and was not before remains something of a mystery to me.&nbsp; I tried your suggestion in a web browser: <a href="ftp://192.168.2.93">ftp://192.168.2.93</a>&nbsp; That again failed and didn&#039;t prompt me for username and password.</p><p>I then tried Filezilla and connected with no problem.&nbsp; I went back to the browser and refreshed with no success.&nbsp; I then tried (in the browser) ftp://username@192.168.2.93.&nbsp; It replaced that with the plain address I had tried originally, <a href="ftp://192.168.2.93">ftp://192.168.2.93</a>, but asked me for username and password, and connected when I provided those.</p><p>So I went back to windows explorer and again tried <a href="ftp://192.168.2.93">ftp://192.168.2.93</a> and that failed with the message from the script.&nbsp; I tried ftp://username@192.168.2.93 (with a valid username), and it again stripped out &quot;username&quot; and prompted me for username and password, and connected successfully when I provided those.&nbsp; </p><p>Note:&nbsp; ftp://username:pw@192.168.2.93 in windows explorer does connect you directly (and strips out username:pw in the address line).</p><p>Thanks very much for your script.&nbsp; It certainly appears to have set up everything properly for ftp.&nbsp; I will try samba, but it may be several days before I get to that.</p>											<p class="post-edited">(Last edited by <strong>lizby</strong> on 6 Jan 2012, 21:45)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p153654">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">dir2cas</div>
					<div class="post-datetime">
						8 Jan 2012, 23:23					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for the feedback.<br />The new version is updated in the first post - support for /bin/sh confirmed and tested.</p><p>Regards,<br />dir2cas</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p153731">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">lizby</div>
					<div class="post-datetime">
						10 Jan 2012, 02:52					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for the update.</p><p>On my first pass, I didn&#039;t pay attention to the samba part, because I only wanted ftp. In backing up and rerunning, I notice that the samba passwords were not set up because /bin/smbpasswd doesn&#039;t exist.&nbsp; The program isn&#039;t on my system anywhere else, either.&nbsp; /etc/samba/smbpasswd exists, but only as an empty file.&nbsp; </p><p>Where does the executable smbpasswd come from?&nbsp; I did &quot;opkg install samba3&quot;--what else do I need?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p153778">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">dir2cas</div>
					<div class="post-datetime">
						11 Jan 2012, 00:25					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>lizby wrote:</cite><blockquote><p>Thanks for the update.</p><p>On my first pass, I didn&#039;t pay attention to the samba part, because I only wanted ftp. In backing up and rerunning, I notice that the samba passwords were not set up because /bin/smbpasswd doesn&#039;t exist.&nbsp; The program isn&#039;t on my system anywhere else, either.&nbsp; /etc/samba/smbpasswd exists, but only as an empty file.&nbsp; </p><p>Where does the executable smbpasswd come from?&nbsp; I did &quot;opkg install samba3&quot;--what else do I need?</p></blockquote></div><p>samba3 is enough - in the beginning of each of my scripts I put the packages that are required - taka a look at it.<br /></p><div class="codebox"><pre><code>root@Core-Sf:~# which smbpasswd
/bin/smbpasswd
root@Core-Sf:~# opkg list_installed | grep samba
samba3 - 3.0.24-8</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p153798">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">lizby</div>
					<div class="post-datetime">
						11 Jan 2012, 03:14					</div>
				</div>
				<div class="post-content content">
					<p>Ah:</p><p># which smbpasswd<br />/usr/sbin/smbpasswd</p><p>Don&#039;t know why I didn&#039;t locate it when I did a &quot;find&quot;.&nbsp; Updated now and reran.&nbsp; </p><p>The first time I did it I had not had my hard drive mounted on /mnt.&nbsp; After deleting the users and mounting on /mnt, I reran.</p><p>This time I get errors of this sort:</p><p>chown: /mnt/storage/SHARE/users/user99/Private: Operation not permitted<br />chown: /mnt/storage/SHARE/users/user99/Private: Operation not permitted<br />chown: /mnt/storage/SHARE/users/user99/.profile: Operation not permitted<br />chown: /mnt/storage/SHARE/users/user99: Operation not permitted<br />chown: /mnt/storage/SHARE/users/user99: Operation not permitted</p><p>I get the same thing if I enter the chown command directly (as I understand it):</p><p>root@tp93:~# chown -R user99:smbusers /mnt/storage/SHARE/users/user99</p><p>Any ideas?&nbsp; This is all new to me.</p><p>(I do have ftp access for retrieval, but not for storage.&nbsp; Permission on the user99 directory is drwxr-xr-x.)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p154074">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">dir2cas</div>
					<div class="post-datetime">
						13 Jan 2012, 14:06					</div>
				</div>
				<div class="post-content content">
					<p>Hello, smbpasswd issue should be fixed in the new version (1.7, see the first post).</p><p>All the permission settings are correctly applied, I have done several checks and tests. Please, check if you have your usb storage partitions correctly mounted. Also, in order to set permissions and ownership properly, you cannot use (v)fat (msdos), ntfs file systems. </p><p>And last, take a look at the following comands output:<br /></p><div class="codebox"><pre><code>root@Core-Sf:~# cat /etc/fstab
/dev/sda1    /overlay    ext4    rw,sync    0    0
/dev/sda5    /mnt/storage    ext4    rw,sync    0    0
/dev/sda6    /mnt/storage/SHARE/users    ext4    rw,sync    0    0
/dev/sda2    none    swap    sw    0    0
root@Core-Sf:~# ls -alh /mnt/storage/SHARE/users/
drwxr-x---    3 smbadmin smbusers     4.0K Jan 13 13:56 .
drwxr-x---    4 smbadmin smbusers     4.0K Nov  6 23:56 ..
drwxr-x---    4 share    smbusers     4.0K Dec 28 18:51 share
root@Core-Sf:~# ls -alh /mnt/storage/SHARE/users/share/
drwxr-x---    4 share    smbusers     4.0K Dec 28 18:51 .
drwxr-x---    3 smbadmin smbusers     4.0K Jan 13 13:56 ..
-rwxr-x---    1 share    smbusers        0 Jan  8 18:37 .profile
drwx------    2 share    smbusers     4.0K Dec 28 18:35 Private
drwxr-x---    2 share    smbusers     4.0K Dec 28 18:51 folder
-rwxr-x---    1 share    smbusers    78.5K Dec 28 18:51 graph.png
-rwxr-x---    1 share    smbusers    81.6K Dec 28 18:51 graph_download.png
root@Core-Sf:~# cat /etc/vsftpd.users 
share
root@Core-Sf:~# cat /etc/samba/smbpasswd
..........................</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p154233">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">lizby</div>
					<div class="post-datetime">
						15 Jan 2012, 04:12					</div>
				</div>
				<div class="post-content content">
					<p>Hmmm, no joy here.</p><p>I deleted the samba and ftp users, and the directories on the hard drive, excepting several not the in /storage path.&nbsp; I then did &quot;storageadm.sh -a user99&quot; and &quot;storageadm.sh -f user99&quot;.&nbsp; I again got the &quot;Operation not permitted&quot; message from chown.</p><p>&quot;cat /etc/fstab&quot; give me &quot;cat: can&#039;t open &#039;/etc/fstab&#039;: No such file or directory&quot;</p><p>root@tp93:~# ls -l /etc/fstab<br />lrwxrwxrwx&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 10 Jan&nbsp; 1 11:39 /etc/fstab -&gt; /tmp/fstab</p><p>root@tp93:~# ls -alh /mnt/storage/SHARE/users/<br />drwxr-xr-x&nbsp; &nbsp; 3 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp;32.0K Jan 14 20:52 .<br />drwxr-xr-x&nbsp; &nbsp; 3 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp;32.0K Jan 14 20:30 ..<br />drwxr-xr-x&nbsp; &nbsp; 3 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp;32.0K Jan 14 20:52 user99</p><p>root@tp93:~# ls -alh /mnt/storage/SHARE/users/user99<br />drwxr-xr-x&nbsp; &nbsp; 3 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp;32.0K Jan 14 20:52 .<br />drwxr-xr-x&nbsp; &nbsp; 3 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp;32.0K Jan 14 20:52 ..<br />-rwxr-xr-x&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 Jan 14 20:52 .profile<br />drwxr-xr-x&nbsp; &nbsp; 2 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp;32.0K Jan 14 20:52 Private</p><p>root@tp93:~# cat /etc/vsftpd.users<br />user99</p><p>Everything is owned by root.</p><p>Any ideas?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p154264">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">dir2cas</div>
					<div class="post-datetime">
						15 Jan 2012, 14:03					</div>
				</div>
				<div class="post-content content">
					<p>All this stuff is pointing that your external storage is not mounted correctly or it is not mounted at all.<br />Check your storage configuration in /etc/config/fstab. <br />Showing us&nbsp; &nbsp;df -h&nbsp; and mount -v will be also helpful.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p155021">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">dir2cas</div>
					<div class="post-datetime">
						22 Jan 2012, 18:37					</div>
				</div>
				<div class="post-content content">
					<p>I just added some new featured of my tool - see the changelog (first post) (version 1.8).<br />Regards,<br />dir2cas</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p155661">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">lizby</div>
					<div class="post-datetime">
						28 Jan 2012, 22:48					</div>
				</div>
				<div class="post-content content">
					<p>I had been explicitely mounting my drive.&nbsp; I followed the wiki to modify /etc/config/fstab so that the drive now mounts automatically on booting.&nbsp; I&#039;m still getting the &quot;chown&quot; error messages.&nbsp; Can this be because I am using a vfat drive?<br /></p><div class="codebox"><pre><code>~# df -h
Filesystem                Size      Used Available Use% Mounted on
rootfs                    5.5M      5.2M    284.0K  95% /
/dev/root                 1.5M      1.5M         0 100% /rom
tmpfs                    14.4M    196.0K     14.2M   1% /tmp
tmpfs                   512.0K         0    512.0K   0% /dev
/dev/mtdblock3            5.5M      5.2M    284.0K  95% /overlay
overlayfs:/overlay        5.5M      5.2M    284.0K  95% /
/dev/sda1               465.6G     24.5G    441.1G   5% /mnt</code></pre></div><div class="codebox"><pre><code>mount -v
rootfs on / type rootfs (rw)
/dev/root on /rom type squashfs (ro,relatime)
proc on /proc type proc (rw,noatime)
sysfs on /sys type sysfs (rw,noatime)
tmpfs on /tmp type tmpfs (rw,nosuid,nodev,noatime,size=14720k)
tmpfs on /dev type tmpfs (rw,noatime,size=512k,mode=755)
devpts on /dev/pts type devpts (rw,noatime,mode=600)
/dev/mtdblock3 on /overlay type jffs2 (rw,noatime)
overlayfs:/overlay on / type overlayfs (rw,relatime)
debugfs on /sys/kernel/debug type debugfs (rw,relatime)
/dev/sda1 on /mnt type vfat (rw,sync,relatime,fmask=0022,dmask=0022,codepage=cp437,iocharset=iso8859-1,shortname=mixed,errors=remount-ro)
none on /proc/bus/usb type usbfs (rw,relatime)</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p155738">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">dir2cas</div>
					<div class="post-datetime">
						29 Jan 2012, 17:00					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>lizby wrote:</cite><blockquote><p>I had been explicitely mounting my drive.&nbsp; I followed the wiki to modify /etc/config/fstab so that the drive now mounts automatically on booting.&nbsp; I&#039;m still getting the &quot;chown&quot; error messages.&nbsp; Can this be because I am using a vfat drive?</p></blockquote></div><p>Hi, this is exactly the reason. I am almost sure I have mentioned this somewhere in the above comments. Use a more native *IX file system, like ext2/3/4, btrfs, etc... Unfortunately jfs is not supported be OpenWrt otherwise this would be my decision.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p155757">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">lizby</div>
					<div class="post-datetime">
						29 Jan 2012, 20:00					</div>
				</div>
				<div class="post-content content">
					<p>I tried a 32gb usb drive as ext2 and a 640gb external usb hard drive as ext4, and both worked.&nbsp; I have successfully done ftp transfers with Filezilla.&nbsp; Thanks for your responses which got me this far.</p><p>I haven&#039;t tested the samba part yet because I don&#039;t know how to access it from a windows pc.&nbsp; Still researching.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p369582">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">weerma</div>
					<div class="post-datetime">
						14 Dec 2017, 13:07					</div>
				</div>
				<div class="post-content content">
					<p>Is this extension good to use in 2017?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p375556">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">dir2cas</div>
					<div class="post-datetime">
						13 Apr 2018, 01:17					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>weerma wrote:</cite><blockquote><p>Is this extension good to use in 2017?</p></blockquote></div><p>Hello, sorry for replying so late, but I am rarely entering the forum.</p><p>I have not tested it in newer versions, since I stopped using the router for such services (moved them to a NAS device). <br />However, it should not be a problem to give it a try.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>