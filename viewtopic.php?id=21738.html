<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> IP alias on briged interface.</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 21 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p94096">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">rony</div>
					<div class="post-datetime">
						11 Sep 2009, 12:32					</div>
				</div>
				<div class="post-content content">
					<p>Hi all,<br />I have configured networking: </p><p>/etc/config/network<br />config &#039;interface&#039; &#039;loopback&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ifname&#039; &#039;lo&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;proto&#039; &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ipaddr&#039; &#039;127.0.0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;netmask&#039; &#039;255.255.255.0&#039;</p><p>config &#039;interface&#039; &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ifname&#039; &#039;eth0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;type&#039; &#039;bridge&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;proto&#039; &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ipaddr&#039; &#039;192.168.10.60&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;netmask&#039; &#039;255.255.255.0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;gateway&#039; &#039;192.168.10.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;dns&#039; &#039;213.215.116.99&#039;</p><p>config &#039;alias&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;interface&#039; &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;proto&#039; &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ipaddr&#039; &#039;192.168.99.2&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;netmask&#039; &#039;255.255.255.0&#039;</p><p>config &#039;alias&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;interface&#039; &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;proto&#039; &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ipaddr&#039; &#039;192.168.199.2&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;netmask&#039; &#039;255.255.255.0&#039;</p><p>config &#039;interface&#039; &#039;wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ifname&#039; &#039; &#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;proto&#039; &#039;none&#039;</p><p>After start networking I have created and configgures eth0:1 interface with IP as interfave br-lan:1.<br />This is ifconfig:</p><p>br-lan&nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 00:D0:12:0F:E5:2A&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:192.168.10.60&nbsp; Bcast:192.168.10.255&nbsp; Mask:255.255.255.0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:407 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:226 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:27516 (26.8 KiB)&nbsp; TX bytes:29572 (28.8 KiB)</p><p>br-lan:1&nbsp; Link encap:Ethernet&nbsp; HWaddr 00:D0:12:0F:E5:2A<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:192.168.99.2&nbsp; Bcast:192.168.99.255&nbsp; Mask:255.255.255.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^<br />br-lan:2&nbsp; Link encap:Ethernet&nbsp; HWaddr 00:D0:12:0F:E5:2A<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:192.168.199.2&nbsp; Bcast:192.168.199.255&nbsp; Mask:255.255.255.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1</p><p>eth0&nbsp; &nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 00:D0:12:0F:E5:2A<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:5228 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:3195 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:100<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:534844 (522.3 KiB)&nbsp; TX bytes:522987 (510.7 KiB)</p><p>eth0:1&nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 00:D0:12:0F:E5:2A<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:192.168.99.2&nbsp; Bcast:192.168.99.255&nbsp; Mask:255.255.255.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^<br />lo&nbsp; &nbsp; &nbsp; &nbsp; Link encap:Local Loopback<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:127.0.0.1&nbsp; Mask:255.0.0.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP LOOPBACK RUNNING&nbsp; MTU:16436&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:56 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:56 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:4940 (4.8 KiB)&nbsp; TX bytes:4940 (4.8 KiB)</p><p>And route -n<br />Kernel IP routing table<br />Destination&nbsp; &nbsp; &nbsp;Gateway&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Genmask&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Flags&nbsp; Metric Ref&nbsp; &nbsp; Use Iface<br />192.168.199.0&nbsp; &nbsp;0.0.0.0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;255.255.255.0&nbsp; &nbsp; U&nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; 0 br-lan<br />192.168.99.0&nbsp; &nbsp; &nbsp;0.0.0.0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;255.255.255.0&nbsp; &nbsp; U&nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; 0 eth0<br />192.168.99.0&nbsp; &nbsp; &nbsp;0.0.0.0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;255.255.255.0&nbsp; &nbsp; U&nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; 0 br-lan<br />192.168.10.0&nbsp; &nbsp; &nbsp;0.0.0.0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;255.255.255.0&nbsp; &nbsp; U&nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; 0 br-lan<br />0.0.0.0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 192.168.10.1&nbsp; &nbsp; 0.0.0.0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UG&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; 0 br-lan</p><p>Why is it as?<br />An after, if this OK,&nbsp; why is not have br-lan:2 alias eth0:x to?<br />Where is problem in my config file?<br />Thank&#039;s for help.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p94104">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Dogge</div>
					<div class="post-datetime">
						11 Sep 2009, 15:50					</div>
				</div>
				<div class="post-content content">
					<p>Works for me but I use trunk. So no idea if this works as well in 8.09 branch...</p><p><strong>Network config (uci export network)</strong><br /></p><div class="codebox"><pre><code>package &#039;network&#039;

config &#039;switch&#039; &#039;eth0&#039;
        option &#039;vlan0&#039; &#039;1 2 3 4 5*&#039;
        option &#039;vlan1&#039; &#039;0 5&#039;

config &#039;interface&#039; &#039;loopback&#039;
        option &#039;ifname&#039; &#039;lo&#039;
        option &#039;proto&#039; &#039;static&#039;
        option &#039;ipaddr&#039; &#039;127.0.0.1&#039;
        option &#039;netmask&#039; &#039;255.0.0.0&#039;

config &#039;interface&#039; &#039;lan&#039;
        option &#039;type&#039; &#039;bridge&#039;
        option &#039;ifname&#039; &#039;eth0.0&#039;
        option &#039;proto&#039; &#039;static&#039;
        option &#039;netmask&#039; &#039;255.255.255.0&#039;
        option &#039;dns&#039; &#039;192.168.178.1&#039;
        option &#039;gateway&#039; &#039;192.168.178.1&#039;
        option &#039;ipaddr&#039; &#039;192.168.178.10&#039;

config &#039;interface&#039; &#039;wan&#039;
        option &#039;ifname&#039; &#039;eth0.1&#039;
        option &#039;proto&#039; &#039;dhcp&#039;

config &#039;alias&#039;
        option &#039;interface&#039; &#039;lan&#039;
        option &#039;proto&#039; &#039;static&#039;
        option &#039;ipaddr&#039; &#039;192.168.99.2&#039;
        option &#039;netmask&#039; &#039;255.255.255.0&#039;

config &#039;alias&#039;
        option &#039;interface&#039; &#039;lan&#039;
        option &#039;proto&#039; &#039;static&#039;
        option &#039;ipaddr&#039; &#039;192.168.199.2&#039;
        option &#039;netmask&#039; &#039;255.255.255.0&#039;</code></pre></div><p><strong>ifconfig</strong><br /></p><div class="codebox"><pre><code>root@OpenWrt:~# ifconfig 
br-lan    Link encap:Ethernet  HWaddr 00:1B:FC:6B:7C:A5  
          inet addr:192.168.178.10  Bcast:192.168.178.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:1138 errors:0 dropped:0 overruns:0 frame:0
          TX packets:90 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:67408 (65.8 KiB)  TX bytes:13859 (13.5 KiB)

br-lan:1  Link encap:Ethernet  HWaddr 00:1B:FC:6B:7C:A5  
          inet addr:192.168.99.2  Bcast:192.168.99.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1

br-lan:2  Link encap:Ethernet  HWaddr 00:1B:FC:6B:7C:A5  
          inet addr:192.168.199.2  Bcast:192.168.199.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1

eth0      Link encap:Ethernet  HWaddr 00:1B:FC:6B:7C:A5  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:5400 errors:0 dropped:0 overruns:0 frame:0
          TX packets:921 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:436504 (426.2 KiB)  TX bytes:144615 (141.2 KiB)
          Interrupt:4 

eth0.0    Link encap:Ethernet  HWaddr 00:1B:FC:6B:7C:A5  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:5273 errors:0 dropped:0 overruns:0 frame:0
          TX packets:835 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:332148 (324.3 KiB)  TX bytes:105467 (102.9 KiB)

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:55 errors:0 dropped:0 overruns:0 frame:0
          TX packets:55 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:4392 (4.2 KiB)  TX bytes:4392 (4.2 KiB)
root@OpenWrt:~#</code></pre></div><p>I just added two new anonymous alias sections to the network config and rebooted:<br /></p><div class="codebox"><pre><code>uci add network alias
uci set network.@alias[-1].interface=lan
uci set network.@alias[-1].proto=static
uci set network.@alias[-1].ipaddr=192.168.99.2
uci set network.@alias[-1].netmask=255.255.255.0

uci add network alias
uci set network.@alias[-1].interface=lan
uci set network.@alias[-1].proto=static
uci set network.@alias[-1].ipaddr=192.168.199.2
uci set network.@alias[-1].netmask=255.255.255.0

uci commit network
reboot</code></pre></div>											<p class="post-edited">(Last edited by <strong>Dogge</strong> on 11 Sep 2009, 16:06)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p94240">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">rony</div>
					<div class="post-datetime">
						14 Sep 2009, 11:25					</div>
				</div>
				<div class="post-content content">
					<p>Hi, </p><p>Your&#039;e&nbsp; way si working. But our config file is identical with your. I don&#039;t know, why is my config not working. I setting it with editor.</p><p>Thank&#039;s</p><p>Rony</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p94304">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">rony</div>
					<div class="post-datetime">
						15 Sep 2009, 10:37					</div>
				</div>
				<div class="post-content content">
					<p>Hi, </p><p>This not working if I only restart firewal&nbsp; and networking from opened ssh connection.<br />Alias</p><p>eth0:1&nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 00:D0:12:0F:E5:2A<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:192.168.99.2&nbsp; Bcast:192.168.99.255&nbsp; Mask:255.255.255.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1</p><p>is still configured and routes over eth0:1 too.</p><p>This OK only if I reboot router after /etc/config/network reconfiguring. Why? <br />THX</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>