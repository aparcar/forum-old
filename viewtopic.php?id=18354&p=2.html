<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> TP-Link TL-WR941N WR941ND - Atheros AP81 platform, USB port</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 13 Jun 2015 and 6 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 2 of 8</div><nav><ul><li><a href="viewtopic.php%3Fid=18354&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li><li><a href="viewtopic.php%3Fid=18354&amp;p=3.html">3</a></li><li><a href="viewtopic.php%3Fid=18354&amp;p=4.html">4</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=18354&amp;p=8.html">8</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p82888">
				<div class="post-metadata">
					<div class="post-num">Post #26</div>
					<div class="post-author">RoundSparrow</div>
					<div class="post-datetime">
						28 Feb 2009, 16:58					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>_bbb_ wrote:</cite><blockquote><p>Good point. I&#039;m in Sweden (EU country) though... The Swedish importer doesn&#039;t carry the exact Planex model that OpenWrt runs on. <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>Also, I don&#039;t really like the &quot;stand up router&quot; form factor. Is it possible to put the Planex down flat on its side? I mean does it have some sort of pads or something that makes is reasonable to place it flat?</p><p>How do you mean U-boot is healthy? Does it have U-boot recovery mode with reflash over http?</p><p>How well is OpenWrt working in the Planex? Is it as &quot;plug and play&quot; as the Trendnet TEW-632 or do I have to solder that serial port?</p><p>Is the wireless performance as good as the tp-link? I was really impressed with tp-link coverage/throughput (with original firmware)...</p></blockquote></div><p>Id&#039; say get what is locally available.&nbsp; Planex hasn&#039;t released GPL source download, they aren&#039;t perfect.&nbsp; It just depends how important the 8MB of flash and USB port is to you.&nbsp; The planex has vent holes on both flat sides, so you could lay it on one side... It seems slightly larger but I don&#039;t have them both in the same room to be certain.</p><p>TP-Link U-boot is difficult to work with.&nbsp; It gives you only one second to type in &quot;tp&quot; to intercept it, it has been modified in nonproductive ways.&nbsp; I don&#039;t think either one allow flashing over http like the Trendnet/D-Link do.&nbsp; If you had to recover flash, you would probably need to solder in serial and reflash from u-boot on either one.</p><p>The TP-Link and Planex share identical antenna sizes, connectors and ar9103 3x3 chip.&nbsp; That&#039;s part of why I emphasized that if it&#039;s an option for you, the 8MB flash and USB port is pretty attractive on the Planex.</p><p>Both the TP-Link and Planex can be flashed from their web GUI now without needing to add a serial port.&nbsp; As long as you don&#039;t get a bad flash or screw up your access to the router.&nbsp; Then a serial port would be required.</p><p>Nobody has detailed a MMC/SDHC mod for the AP81 yet... that would be nice with the smaller 4MB flash we are finding on most units.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p83148">
				<div class="post-metadata">
					<div class="post-num">Post #27</div>
					<div class="post-author">_bbb_</div>
					<div class="post-datetime">
						3 Mar 2009, 22:08					</div>
				</div>
				<div class="post-content content">
					<p>Oops. I got my WR941ND today and immediately built and flashed openwrt-trunk (r14745) image bin/openwrt-ar71xx-tl-wr941ndv2-squashfs.uni. Maybe I was a little too eager. Now I cannot even ping it (at 192.168.1.1). <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>I guess it&#039;s back to the soldering iron now... Good thing I ordered one of those too. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p83197">
				<div class="post-metadata">
					<div class="post-num">Post #28</div>
					<div class="post-author">RoundSparrow</div>
					<div class="post-datetime">
						4 Mar 2009, 12:15					</div>
				</div>
				<div class="post-content content">
					<p>I haven&#039;t flashed mine yet. juhosg has one (he is doing the development), wonder what happened?</p><p>make sure you work out how you are going to bridge those surface mount pads.&nbsp; It is too small to solder that one spot.&nbsp; I used liquid copper and a toothpick.&nbsp; You may want to read up on &quot;AMD Pencil Trick&quot;</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p83212">
				<div class="post-metadata">
					<div class="post-num">Post #29</div>
					<div class="post-author">juhosg</div>
					<div class="post-datetime">
						4 Mar 2009, 17:17					</div>
				</div>
				<div class="post-content content">
					<p>Hi,<br /></p><div class="quotebox"><cite>_bbb_ wrote:</cite><blockquote><p>Oops. I got my WR941ND today and immediately built and flashed openwrt-trunk (r14745) image bin/openwrt-ar71xx-tl-wr941ndv2-squashfs.uni. Maybe I was a little too eager. Now I cannot even ping it (at 192.168.1.1). <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p></blockquote></div><p>Weird, it is working for me.<br /></p><div class="codebox"><pre><code>...
handover: boot [early0] -&gt; real [ttyS0]
ag71xx_mdio: probed
eth0: Atheros AG71xx at 0xb9000000, irq 4
Atheros AR71xx SPI Controller driver version 0.2.2
m25p80 spi0.0: m25p32 (4096 Kbytes)
Searching for RedBoot partition table in spi0.0 at offset 0x3e0000
Searching for RedBoot partition table in spi0.0 at offset 0x3f0000
No RedBoot partition table detected in spi0.0
Creating 5 MTD partitions on &quot;spi0.0&quot;:
0x00000000-0x00020000 : &quot;u-boot&quot;
0x00020000-0x00140000 : &quot;kernel&quot;
0x00140000-0x003f0000 : &quot;rootfs&quot;
mtd: partition &quot;rootfs&quot; set to be root filesystem
mtd: partition &quot;rootfs_data&quot; created automatically, ofs=390000, len=60000
0x00390000-0x003f0000 : &quot;rootfs_data&quot;
0x003f0000-0x00400000 : &quot;art&quot;
0x00020000-0x003f0000 : &quot;firmware&quot;
Atheros AR71xx hardware watchdog driver version 0.1.0
TCP vegas registered
NET: Registered protocol family 17
Distributed Switch Architecture driver version 0.1
eth0: detected a Marvell 88E6060 switch
dsa slave smi: probed
802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;
All bugs added by David S. Miller &lt;davem@redhat.com&gt;
VFS: Mounted root (squashfs filesystem) readonly.
Freeing unused kernel memory: 132k freed
Please be patient, while OpenWrt loads ...
Algorithmics/MIPS FPU Emulator v1.5
- preinit -
Press CTRL-C for failsafe
jffs2 not ready yet; using ramdisk
mini_fo: using base directory: /
mini_fo: using storage directory: /tmp/root
- init -

Please press Enter to activate this console. eth0: link up (100Mbps/Full duplex)
eth0: link down
eth0: link up (100Mbps/Full duplex)
device lan1 entered promiscuous mode
device eth0 entered promiscuous mode
lan1: link up, 100 Mb/s, full duplex, flow control disabled
br-lan: topology change detected, propagating
br-lan: port 1(lan1) entering forwarding state
device lan2 entered promiscuous mode
device lan3 entered promiscuous mode
device lan4 entered promiscuous mode
br-lan: port 1(lan1) entering disabled state
br-lan: topology change detected, propagating
br-lan: port 1(lan1) entering forwarding state
cfg80211: Using static regulatory domain info
cfg80211: Regulatory domain: US
        (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp)
        (2402000 KHz - 2472000 KHz @ 40000 KHz), (600 mBi, 2700 mBm)
        (5170000 KHz - 5190000 KHz @ 40000 KHz), (600 mBi, 2300 mBm)
        (5190000 KHz - 5210000 KHz @ 40000 KHz), (600 mBi, 2300 mBm)
        (5210000 KHz - 5230000 KHz @ 40000 KHz), (600 mBi, 2300 mBm)
        (5230000 KHz - 5330000 KHz @ 40000 KHz), (600 mBi, 2300 mBm)
        (5735000 KHz - 5835000 KHz @ 40000 KHz), (600 mBi, 3000 mBm)
cfg80211: Calling CRDA for country: US
phy0: Atheros AR9100 MAC/BB Rev:0, AR2133 RF Rev:a1, mem=0xb80c0000, irq=2
cfg80211: Calling CRDA for country: US
PPP generic driver version 2.4.2
ip_tables: (C) 2000-2006 Netfilter Core Team
nf_conntrack version 0.5.0 (512 buckets, 2048 max)
Registered led device: tl-wr941nd:green:system
Registered led device: tl-wr941nd:red:qss
jffs2_scan_eraseblock(): End of filesystem marker found at 0x0
jffs2_build_filesystem(): unlocking the mtd device... done.
jffs2_build_filesystem(): erasing all blocks after the end marker... done.
mini_fo: using base directory: /
mini_fo: using storage directory: /jffs



BusyBox v1.11.3 (2009-02-23 16:20:30 CET) built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 KAMIKAZE (bleeding edge, r14746) -------------------
  * 10 oz Vodka       Shake well with ice and strain
  * 10 oz Triple sec  mixture into 10 shot glasses.
  * 10 oz lime juice  Salute!
 ---------------------------------------------------
root@OpenWrt:/#</code></pre></div><p>Some ideas:<br />Broken flashing process?<br />Different board version?<br />Did you try the WAN port accidentally?</p><p>Can you send your image to me?</p><div class="quotebox"><blockquote><p>I guess it&#039;s back to the soldering iron now... Good thing I ordered one of those too. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></blockquote></div><p>That was a good decision.</p><p>-Gabor</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p83246">
				<div class="post-metadata">
					<div class="post-num">Post #30</div>
					<div class="post-author">_bbb_</div>
					<div class="post-datetime">
						5 Mar 2009, 01:48					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>juhosg wrote:</cite><blockquote><p>Some ideas:<br />Broken flashing process?<br />Different board version?<br />Did you try the WAN port accidentally?</p></blockquote></div><p>It&#039;s a different board version. Mine says v2.2. I will upload some pictures tomorrow.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p83265">
				<div class="post-metadata">
					<div class="post-num">Post #31</div>
					<div class="post-author">_bbb_</div>
					<div class="post-datetime">
						5 Mar 2009, 15:12					</div>
				</div>
				<div class="post-content content">
					<p><span class="postimg"><img src="http://farm4.static.flickr.com/3579/3329978281_cb6c2cdeb7_b.jpg" alt="http://farm4.static.flickr.com/3579/3329978281_cb6c2cdeb7_b.jpg" /></span></p><p>Any ideas on how I can identify the serial pins? I have a knife and fork, screwdriver, multimeter and a soldering iron. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p83272">
				<div class="post-metadata">
					<div class="post-num">Post #32</div>
					<div class="post-author">juhosg</div>
					<div class="post-datetime">
						5 Mar 2009, 16:02					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>_bbb_ wrote:</cite><blockquote><p>Any ideas on how I can identify the serial pins? I have a knife and fork, screwdriver, multimeter and a soldering iron. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></blockquote></div><p><a href="http://wiki.openwrt.org/OpenWrtDocs/Customizing/Hardware/Serial_Console">1.7. Finding Serial Console</a> <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p83273">
				<div class="post-metadata">
					<div class="post-num">Post #33</div>
					<div class="post-author">RoundSparrow</div>
					<div class="post-datetime">
						5 Mar 2009, 16:21					</div>
				</div>
				<div class="post-content content">
					<p>That looks much more like the traditional AP81 serial port pin-out than the older TP-Link revision.&nbsp; pin 2 = RX, pin 3 = TX, pin 4 = Ground</p><br /><p>I can&#039;t make out clearly in the photo the surface mount pads below the serial port, but they can be a big issue.&nbsp; If any of those pads are missing connections and you can&#039;t get serial to work...&nbsp; The trick I did:</p><p>1) use a very small flat blade screwdriver and wiggle it on top of the exposed pads<br />2) set terminal to 115200<br />3) press the router WPS button over and over, as it will cause a console message to be sent.&nbsp; that way you don&#039;t have to keep turning the router off/on to get the boot message.</p><p>If output works while bridge the pads, then you gotta turn off the unit and figure out how to bridge permanently.</p>											<p class="post-edited">(Last edited by <strong>RoundSparrow</strong> on 5 Mar 2009, 16:23)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p83281">
				<div class="post-metadata">
					<div class="post-num">Post #34</div>
					<div class="post-author">_bbb_</div>
					<div class="post-datetime">
						5 Mar 2009, 19:35					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>juhosg wrote:</cite><blockquote><div class="quotebox"><cite>_bbb_ wrote:</cite><blockquote><p>Any ideas on how I can identify the serial pins? I have a knife and fork, screwdriver, multimeter and a soldering iron. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></blockquote></div><p><a href="http://wiki.openwrt.org/OpenWrtDocs/Customizing/Hardware/Serial_Console">1.7. Finding Serial Console</a> <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p></blockquote></div><p>Thanx! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> But I&#039;m just not cut out for this. I spent a few hours on it and I think I have a reasonable GUESS for the pin layout (see below) but I got nothing on serial. <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><div class="codebox"><pre><code>LAN4       LAN3        LAN2         LAN1

           P1
           RX*    TX    GND   VCC

              B1   B2  B3  B4



LAN1-4 = LAN ports for board orientation.

P1 = Mark &quot;P1&quot; on board.

B1-4 = Tiny &quot;bridges&quot; to control connectivity I think.

RX* - Possible RX pin? Multimeter detects change when B1 or B2 is closed. With no &quot;bridge&quot; connected seems to go to nowhere. Resembles an RX pin when B2 is connected.
TX - Possible TX pin?
GND - Fairly certain this is ground. Good connectivity to RF-shield.
VCC - Fairly certain this is VCC. Constant 3.3V to GND.</code></pre></div><p>Maybe it&#039;s bricked? How about that JTAG port...?</p><p>Ahh, I&#039;m in over my head again... I have another one sitting on my desk. Gabor, want to give it a try? <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p83282">
				<div class="post-metadata">
					<div class="post-num">Post #35</div>
					<div class="post-author">juhosg</div>
					<div class="post-datetime">
						5 Mar 2009, 19:48					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>_bbb_ wrote:</cite><blockquote><p>Thanx! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> But I&#039;m just not cut out for this. I spent a few hours on it and I think I have a reasonable GUESS for the pin layout (see below) but I got nothing on serial. <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p></blockquote></div><p>-EWRONGBAUDRATE?<br /></p><div class="quotebox"><blockquote><div class="codebox"><pre><code>LAN4       LAN3        LAN2         LAN1

           P1
           RX*    TX    GND   VCC

              B1   B2  B3  B4



LAN1-4 = LAN ports for board orientation.

P1 = Mark &quot;P1&quot; on board.

B1-4 = Tiny &quot;bridges&quot; to control connectivity I think.

RX* - Possible RX pin? Multimeter detects change when B1 or B2 is closed. With no &quot;bridge&quot; connected seems to go to nowhere. Resembles an RX pin when B2 is connected.
TX - Possible TX pin?
GND - Fairly certain this is ground. Good connectivity to RF-shield.
VCC - Fairly certain this is VCC. Constant 3.3V to GND.</code></pre></div><p>Maybe it&#039;s bricked? How about that JTAG port...?</p><p>Ahh, I&#039;m in over my head again... I have another one sitting on my desk. Gabor, want to give it a try? <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p></blockquote></div><p>You sent two devices to me already, so only in that case if you won&#039;t find it.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p83284">
				<div class="post-metadata">
					<div class="post-num">Post #36</div>
					<div class="post-author">RoundSparrow</div>
					<div class="post-datetime">
						5 Mar 2009, 20:05					</div>
				</div>
				<div class="post-content content">
					<p>Well one fundamental problem is we don&#039;t know the state of the router... we don&#039;t know how badly it is bricked.&nbsp; Perhaps the serial being sent for such a brief period it is difficult to bridge the pads and do cold boot at same time. Almost like you need a foot pedal power switch to turn on the router while doing the temporary bridge connections.&nbsp; This is what I had to do <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" />&nbsp; I must have had to boot my TP-Link 100 times.</p><p>&nbsp; Maybe you trying serial on the good working router you have - to figure out the serial - is the way to go? Just a suggestion.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p83287">
				<div class="post-metadata">
					<div class="post-num">Post #37</div>
					<div class="post-author">_bbb_</div>
					<div class="post-datetime">
						5 Mar 2009, 21:34					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><p>-EWRONGBAUDRATE?</p></blockquote></div><p>I tried both 9600 and 115200. But you do have a point RoundSparrow, it is difficult to attach everything in time to catch the U-Boot output (especially if kernel boot fails completely so there are no printouts). How long do you think I have with U-Boot before it goes into kernel?</p><p>I&#039;m just a little bit discuraged by all the uncertainty here. The thing could be completely bricked. I could be too slow. I could be wrong about TX/RX or even some other pin. There might be some other bridge i have to connect. And even if I get the serial to work I&#039;m not sure I can fix the build anyway... <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Do you see a big difference between the v2.0 and v2.2 layout? The v2.0 doesn&#039;t have the 4-pin serial in the same place does it? The place on the board where I&#039;m soldering doesn&#039;t exist on the v2.0 or am I just confused? I will try some soldering on the fresh board tomorrow. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p83302">
				<div class="post-metadata">
					<div class="post-num">Post #38</div>
					<div class="post-author">RoundSparrow</div>
					<div class="post-datetime">
						6 Mar 2009, 06:30					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>_bbb_ wrote:</cite><blockquote><div class="quotebox"><blockquote><p>-EWRONGBAUDRATE?</p></blockquote></div><p>Do you see a big difference between the v2.0 and v2.2 layout? The v2.0 doesn&#039;t have the 4-pin serial in the same place does it? The place on the board where I&#039;m soldering doesn&#039;t exist on the v2.0 or am I just confused? I will try some soldering on the fresh board tomorrow. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></blockquote></div><p>From the photo they clearly redid the serial port connection.&nbsp; With the tricks they play with baud rate and missing connection (the open surface mount pads).&nbsp; This is part of why I dislike the TP-Link, what is the purpose of this <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>I wasted like 6 hours on my first one of these, and I destroyed the tiny surface mount pad trying to solder the bridge.&nbsp; But I learned my lesson, a 60 watt soldering iron was also a club of a tool to use on this <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" />&nbsp; I&#039;ve now got my quality soldering iron and know the layout.</p><p>I suggest the working one, it will simplify you.&nbsp; At least if you can afford the time and risk.&nbsp; As there seems a lot of interest in this particular router with the good worldwide distribution.</p>											<p class="post-edited">(Last edited by <strong>RoundSparrow</strong> on 6 Mar 2009, 06:31)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p83315">
				<div class="post-metadata">
					<div class="post-num">Post #39</div>
					<div class="post-author">_bbb_</div>
					<div class="post-datetime">
						6 Mar 2009, 13:28					</div>
				</div>
				<div class="post-content content">
					<p>No luck. <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>Used your method RoundSparrow with 115200 baudrate and pressing the WPS button (labeled &quot;QSS&quot;, right?) to try both the above pin guess and TX/RX-swapped. I tried connecting both B1 and B2 for both pin guesses, but no usable output. Will the WPS button always print a line to serial, no mater how fast I press it (within reason)?</p><p>The best I could get was some garbage when I use the guess above and wiggle a screwdriver on B1:</p><div class="codebox"><pre><code>*** baud: 57600 ***
ï¿½ï¿½ï¿½ï¿½ï¿½
*** baud: 38400 ***
ï¿½ï¿½ï¿½ï¿½ï¿½{ï¿½
*** baud: 19200 ***
ï¿½ï¿½
*** baud: 9600 ***
ï¿½
 ï¿½`
       ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½pï¿½
*** baud: 4800 ***
ï¿½Jï¿½ï¿½ï¿½ï¿½P
             ï¿½ï¿½ï¿½ï¿½ï¿½0 ï¿½ï¿½hï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Pï¿½ï¿½
*** baud: 9600 ***

*** baud: 19200 ***

*** baud: 38400 ***

*** baud: 57600 ***

*** baud: 115200 ***

*** baud: 115200 ***
ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Dï¿½4ï¿½ï¿½ï¿½ï¿½ rï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½~ï¿½ï¿½ï¿½gwï¿½ï¿½ï¿½ï¿½ï¿½ï¿½&gt;ï¿½ï¿½&lt;ï¿½@ï¿½&lt;ï¿½?ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ ~ï¿½ï¿½ï¿½
                                                                              ï¿½)8ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½pï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ 
                                                                              ï¿½ï¿½ï¿½ï¿½:&gt;ï¿½ï¿½ï¿½ï¿½ï¿½{&gt;ï¿½ï¿½ï¿½ï¿½ï¿½&lt;ï¿½ï¿½ï¿½&gt;ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½/ï¿½8ï¿½vï¿½ï¿½@ï¿½ Ã¾ Ã¸Ã¡ 0@SÃ¸ Ã¿@Â€Ã¿      Ã¾   Ã°     â”‚ âŽ»Ã° ï¿½ â”‚Â€ Â€Ã¸ Â€   Ã¼Ã¼  Ã¾Ã¼ Ã¸ CÃ¾â—†       Ã° Ã¾  Ã¿           Âˆ  Ã¬           Â·Ã¿ â”¼Ã·Ã®Ã¾&gt;    Â·     ï¿½       â”‚ Â„ ï¿½ Â€Ã¸ Ã¼   Â€Ã¼       Ã±   @             Â€âŽ»â—†  Â†              Â€  Ã¾  Ã¿      Ã¿     Â€   Â±      Ã¾Ã¼Ã˜ @    8    ï¿½ ï¿½ Ã€    âŽ» Ã¿8Â€Ã°Ã¿ï¿½        Ã€        Ã‹ â—†Ã°Ã¼ Ãº Ã¾ &gt; ÃŸÃ¸â”‚  â—† â—†            Â€   Ã°Sï¿½ ï¿½Ã¾             Â€             Â€         Ã° 
                  Ã¼           Ã½Ã· Ã€ï¿½  Ã€                          ï¿½    Ã¼ Ã¾ Ã¾Ã€     Ã³Ã¸  .ï¿½ ï¿½  Ã¿   Â€Ã¿ 0&lt;   ï¿½ Ã€     Ã°Ã‘Ã¸Ã€</code></pre></div><p>It doesn&#039;t seem to have much to do with me pressing the button though, more a result of the wiggling screwdriver.</p><p>Wiggling on B2 seems to have no effect.</p><p>Any ideas?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p83321">
				<div class="post-metadata">
					<div class="post-num">Post #40</div>
					<div class="post-author">RoundSparrow</div>
					<div class="post-datetime">
						6 Mar 2009, 14:38					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>_bbb_ wrote:</cite><blockquote><p>No luck. <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>Used your method RoundSparrow with 115200 baudrate and pressing the WPS button (labeled &quot;QSS&quot;, right?) to try both the above pin guess and TX/RX-swapped. I tried connecting both B1 and B2 for both pin guesses, but no usable output. Will the WPS button always print a line to serial, no mater how fast I press it (within reason)?</p><p>The best I could get was some garbage when I use the guess above and wiggle a screwdriver on B1:</p><p>It doesn&#039;t seem to have much to do with me pressing the button though, more a result of the wiggling screwdriver.</p><p>Wiggling on B2 seems to have no effect.</p><p>Any ideas?</p></blockquote></div><p>Can you get a better photo of the serial port area and maybe even traces to the CPU from that serial port?&nbsp; Can you study the traces and see which ones seem to actually have connections (it might help to get the photo first, then study the photo on computer).</p><p>Lark is the user who figured out the original serial of the TP-Link.&nbsp; Maybe we should have him review what you tried (he has been on #OpenWRT-Devel IRC a few times). </p><p>Yes, my expreience is that after the system is booted - boot has settled own (45 seconds)... that each time you press QSS a short message (15 chars?) is sent to console.&nbsp; The rate should be 115,200 at this point (after linux boots, past u-boot).</p><p>Just so we are clear, you are using a 3.3v serial port converter to the host, right? The output I see looks like the noise I get when just make noise doing wiggles..&nbsp; &nbsp;I&#039;d focus the testing strictly on host TX (pressing QSS) and at 115200.&nbsp; Also suggest you reset your terminal software after too much garbage.&nbsp; I use a prolific rs232 to USB adapter, it helps if I unplug it from the host and replug it after a couple attempts... then go right to 115200 and cold boot router.... sometimes the chip gets in some screwed up state (I was just installing and testing one last night on another router, had to do this when I see the output you show).&nbsp; &nbsp;I personally use screen on Linux:&nbsp; &quot;screen /dev/ttyUSB0 115200&quot;</p>											<p class="post-edited">(Last edited by <strong>RoundSparrow</strong> on 6 Mar 2009, 14:43)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p83328">
				<div class="post-metadata">
					<div class="post-num">Post #41</div>
					<div class="post-author">_bbb_</div>
					<div class="post-datetime">
						6 Mar 2009, 16:21					</div>
				</div>
				<div class="post-content content">
					<p><span class="postimg"><img src="http://farm4.static.flickr.com/3401/3333293102_b8282111f8_b.jpg" alt="http://farm4.static.flickr.com/3401/3333293102_b8282111f8_b.jpg" /></span><br /><span class="postimg"><img src="http://farm4.static.flickr.com/3589/3333293194_eba9d9d9f5_o.jpg" alt="http://farm4.static.flickr.com/3589/3333293194_eba9d9d9f5_o.jpg" /></span></p><p>Would be great if we could get some help from Lark. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>I&#039;m using a Meraki serial adaptor and a linux machine with picocom. I test it on a Meraki Mini (to see that it works) at 115200 baud and then move it over to the TP-LINK. I&#039;ve also measured the VCC voltage on the Meraki Mini and it is the same as the TP-LINK, 3.3v. Should be ok, right?</p><p>EDIT: I have a high resolution image of most of the board that I can email if it helps (Flickr scales it down to some max size).</p>											<p class="post-edited">(Last edited by <strong>_bbb_</strong> on 6 Mar 2009, 16:23)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p83345">
				<div class="post-metadata">
					<div class="post-num">Post #42</div>
					<div class="post-author">RoundSparrow</div>
					<div class="post-datetime">
						6 Mar 2009, 19:26					</div>
				</div>
				<div class="post-content content">
					<p>Great picture!&nbsp; let&#039;s review the basics, only connect&nbsp; RX,TX,GND - no need to connect the power one (so only 3 wires).</p><p>The signal traces clearly go to pin #1 and pin #2 <br />It looks to me the pad below pin#1 needs bridged (R356).&nbsp; A resistor or something is installed on the trace to pin #2.&nbsp; My experience says that your pin #1 and pin #2 will be TX or RX.&nbsp; The GND should be easy to identify (Pin #3 or #4) with continuity test to the metal shield to your right (do this with power disconnected)</p><p>I think you are close.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p83380">
				<div class="post-metadata">
					<div class="post-num">Post #43</div>
					<div class="post-author">computersolutions</div>
					<div class="post-datetime">
						7 Mar 2009, 05:10					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m in China, and have a 2.3 version router.&nbsp; &nbsp;I&#039;ve been following this with interest (TPLink is one of the major vendors here in China router wise)</p><p>Does anyone have any interest in a photo of the internals?&nbsp; <br />I haven&#039;t taken mine apart yet, but will do if people are interested.</p><p>I haven&#039;t even gotten around to flashing it yet - assuming I follow RoundSparrow&#039;s instructions here <a href="http://forum.openwrt.org/viewtopic.php?id=18858">http://forum.openwrt.org/viewtopic.php?id=18858</a></p><p>Hopefully this isn&#039;t too OT for anyone.&nbsp; Thx!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p83396">
				<div class="post-metadata">
					<div class="post-num">Post #44</div>
					<div class="post-author">_bbb_</div>
					<div class="post-datetime">
						7 Mar 2009, 12:15					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>computersolutions wrote:</cite><blockquote><p>I&#039;m in China, and have a 2.3 version router.&nbsp; &nbsp;I&#039;ve been following this with interest (TPLink is one of the major vendors here in China router wise)</p><p>Does anyone have any interest in a photo of the internals?&nbsp; <br />I haven&#039;t taken mine apart yet, but will do if people are interested.</p><p>I haven&#039;t even gotten around to flashing it yet - assuming I follow RoundSparrow&#039;s instructions here <a href="http://forum.openwrt.org/viewtopic.php?id=18858">http://forum.openwrt.org/viewtopic.php?id=18858</a></p><p>Hopefully this isn&#039;t too OT for anyone.&nbsp; Thx!</p></blockquote></div><p>First of all: don&#039;t flash it yet! <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /> I flashed a v2.2 and it seems dead... Only board version that is (relatively) safe to flash is v2.0 AFAIK.</p><p>Would be very interesting to get a photo of the v2.3 board! If it is completely different again than we might even be wasting our time here (depending on how many v2.2:s there are).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p83399">
				<div class="post-metadata">
					<div class="post-num">Post #45</div>
					<div class="post-author">_bbb_</div>
					<div class="post-datetime">
						7 Mar 2009, 13:52					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>RoundSparrow wrote:</cite><blockquote><p>Great picture!&nbsp; let&#039;s review the basics, only connect&nbsp; RX,TX,GND - no need to connect the power one (so only 3 wires).</p><p>The signal traces clearly go to pin #1 and pin #2 <br />It looks to me the pad below pin#1 needs bridged (R356).&nbsp; A resistor or something is installed on the trace to pin #2.&nbsp; My experience says that your pin #1 and pin #2 will be TX or RX.&nbsp; The GND should be easy to identify (Pin #3 or #4) with continuity test to the metal shield to your right (do this with power disconnected)</p><p>I think you are close.</p></blockquote></div><p>I am fairly certain that Pin #3 = GND and Pin #4 = VCC. Signal goes to Pin #1 and Pin #2. Problem is I do not get any output from this setup, regardless of which pad I bridge and which pin I connect to TX/RX. <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>Possible sources of errors:</p><p>1) The Meraki Mini serial adaptor. One thing that bothers me is that the Mini has 3.3v on the RX pin. The WR941ND has 0v as I presume most other boards do.</p><p>2) The temproary pad briding with the wiggling screwdriver trick feels a bit unreliable. Is there some other trick? Should I pick one and bridge it permanently?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p83403">
				<div class="post-metadata">
					<div class="post-num">Post #46</div>
					<div class="post-author">RoundSparrow</div>
					<div class="post-datetime">
						7 Mar 2009, 18:55					</div>
				</div>
				<div class="post-content content">
					<p>Larkw may be on IRC #OpenWrt-Devel channel this weekend, can you join? we are on now.</p><p>My thoughts on your serial adapter, do you have another brand/model of router to test it on?&nbsp; For me, this boots my confidence that at least my host serial adapter is in order.</p><p>Lark studied your photos and says with confidence: P1 is RX, P2 is TX.&nbsp; R356 is all you should need to bridge.</p>											<p class="post-edited">(Last edited by <strong>RoundSparrow</strong> on 7 Mar 2009, 19:30)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p83417">
				<div class="post-metadata">
					<div class="post-num">Post #47</div>
					<div class="post-author">prisma</div>
					<div class="post-datetime">
						8 Mar 2009, 00:44					</div>
				</div>
				<div class="post-content content">
					<p>First of all thank you for the great work!</p><p>I have a revision 2.2 as well (Board revision 1.1). So i also bricked mine some days ago :-)</p><div class="quotebox"><blockquote><p>Lark studied your photos and says with confidence: P1 is RX, P2 is TX.&nbsp; R356 is all you should need to bridge.</p></blockquote></div><p>I can confirm this. I use a self soldered USB to TTL converter (FT232RL based). </p><p>I have two outputs:</p><p>Uboot (9600):</p><div class="codebox"><pre><code>U-Boot 1.1.4 (May  1 2008 - 19:25:20)

AP81 (ar7100) U-boot
DRAM:
sri
32 MB
id read 0x100000ff
flash size 8MB, sector count = 128
Flash:  8 MB
Using default environment

In:    serial
Out:   serial
Err:   serial
Net:   ag7100_enet_initialize...
No valid address in Flash. Using fixed address
eth0: 00:03:7f:09:0b:ad
eth0 up
eth0
Autobooting in 1 seconds, press &quot;tp&quot; to stop
## Booting image at bf020000 ...
   Uncompressing Kernel Image ... OK

Starting kernel ...

Linux version 2.6.28.7 (prisma@oimel) (gcc version 4.1.2) #1 Fri Feb 27 09:12:07 CET 2009
console [early0] enabled
CPU revision is: 00019374 (MIPS 24Kc)
Atheros AR9132 rev 1 (id:0xb5), CPU:400.000 MHz, AHB:100.000 MHz, DDR:400.000 MHz
Determined physical RAM map:
 memory: 02000000 @ 00000000 (usable)
Initrd not found or empty - disabling initrd
Zone PFN ranges:
  Normal   0x00000000 -&gt; 0x00002000
Movable zone start PFN for each node
early_node_map[1] active PFN ranges
    0: 0x00000000 -&gt; 0x00002000
Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 8128
Kernel command line: rootfstype=squashfs,yaffs,jffs2 noinitrd console=ttyS0,115200 init=/etc/preinit
Primary instruction cache 64kB, VIPT, 4-way, linesize 32 bytes.
Primary data cache 32kB, 4-way, VIPT, cache aliases, linesize 32 bytes
Writing ErrCtl register=00000000
Readback ErrCtl register=00000000
PID hash table entries: 128 (order: 7, 512 bytes)
Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
Memory: 29708k/32768k available (1818k kernel code, 3060k reserved, 332k data, 132k init, 0k highmem)
SLUB: Genslabs=6, HWalign=32, Order=0-3, MinObjects=0, CPUs=1, Nodes=1
Calibrating delay loop... 266.24 BogoMIPS (lpj=1331200)
Mount-cache hash table entries: 512
net_namespace: 480 bytes
NET: Registered protocol family 16
MIPS: machine is TP-LINK TL-WR941ND
NET: Registered protocol family 2
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 1024 (order: 1, 8192 bytes)
TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
TCP: Hash tables configured (established 1024 bind 1024)
TCP reno registered
NET: Registered protocol family 1
squashfs: version 3.0 (2006/03/15) Phillip Lougher
Registering mini_fo version $Id$
JFFS2 version 2.2. (NAND) (SUMMARY)  Â© 2001-2006 Red Hat, Inc.
yaffs Feb 27 2009 09:08:31 Installing.
msgmni has been set to 58
io scheduler noop registered
io scheduler deadline registered (default)
Serial: 8250/16550 driver1 ports, IRQ sharing disabled</code></pre></div><p>Kernel (115200):</p><div class="codebox"><pre><code>eth0: Atheros AG71xx at 0xb9000000, irq 4
Atheros AR71xx SPI Controller driver version 0.2.2
m25p80 spi0.0: unrecognized JEDEC id 898912
Atheros AR71xx hardware watchdog driver version 0.1.0
TCP vegas registered
NET: Registered protocol family 17
Distributed Switch Architecture driver version 0.1
eth0: detected a Marvell 88E6060 switch
dsa slave smi: probed
802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;
All bugs added by David S. Miller &lt;davem@redhat.com&gt;
VFS: Cannot open root device &quot;&lt;NULL&gt;&quot; or unknown-block(0,0)
Please append a correct &quot;root=&quot; boot option; here are the available partitions:
Kernel panic - not syncing: VFS: Unable to mount root fs on unknown-block(0,0)</code></pre></div><p>Maybe v2.2 (board 1.1) has a different flash chip (m25p80 spi0.0: unrecognized JEDEC id 898912)?<br />v2.2 has a Numonyx(INTEL) 320S33B chip...</p><p>BTW: I also had this strange output. That was when i used a self soldered COM TTL Adapter (MAX 323 based). I have no clue why this happend. some days later i bricked my serial port on my desktop :-(<br />So built an USB TTL Adapter based on <a href="http://dg7xo.de/selbstbau/usb2rs232.html">this</a> (modified for 3.3V)</p>											<p class="post-edited">(Last edited by <strong>prisma</strong> on 8 Mar 2009, 09:45)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p83432">
				<div class="post-metadata">
					<div class="post-num">Post #48</div>
					<div class="post-author">Elphidium</div>
					<div class="post-datetime">
						8 Mar 2009, 05:39					</div>
				</div>
				<div class="post-content content">
					<p>Hi, i brought one wr941nd, its v2.0 and i have some questions<br />1. can i upgrade a existing openwrt instalation on wr941nd ?<br />2. can i revert back to original firmware ?<br />3. someone have tryed usb modules with openwrt and wr941nd ?<br />I donÂ´t have a serial adapter and never worked with one so i being carefull.</p><p>Thanks for the great work !</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p83442">
				<div class="post-metadata">
					<div class="post-num">Post #49</div>
					<div class="post-author">_bbb_</div>
					<div class="post-datetime">
						8 Mar 2009, 13:49					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>prisma wrote:</cite><blockquote><p>Maybe v2.2 (board 1.1) has a different flash chip (m25p80 spi0.0: unrecognized JEDEC id 898912)?<br />v2.2 has a Numonyx(INTEL) 320S33B chip...</p><p>BTW: I also had this strange output. That was when i used a self soldered COM TTL Adapter (MAX 323 based). I have no clue why this happend. some days later i bricked my serial port on my desktop :-(<br />So built an USB TTL Adapter based on <a href="http://dg7xo.de/selbstbau/usb2rs232.html">this</a> (modified for 3.3V)</p></blockquote></div><p>That sounds like a very good reason! There should be hope for unbricking it then. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>BTW: I&#039;m still stuck on bridging the R356 pad. Soldering it is not easy and I can&#039;t find any of that liquid metal stuff. <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p83443">
				<div class="post-metadata">
					<div class="post-num">Post #50</div>
					<div class="post-author">RoundSparrow</div>
					<div class="post-datetime">
						8 Mar 2009, 13:58					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>_bbb_ wrote:</cite><blockquote><p>BTW: I&#039;m still stuck on bridging the R356 pad. Soldering it is not easy and I can&#039;t find any of that liquid metal stuff. <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p></blockquote></div><p>Pencil.&nbsp; <a href="http://www.motherboards.org/articles/guides/41_4.html">http://www.motherboards.org/articles/guides/41_4.html</a></p><p>BTW, this and several other reasons (such as u-boot mods, shared Ethernet interface for LAN and WAN) are why I put TP-Link near bottom of recommended AP81 routers.&nbsp; The good news is that they have excellent worldwide distribution... so worth the effort.</p>											<p class="post-edited">(Last edited by <strong>RoundSparrow</strong> on 8 Mar 2009, 14:35)</p>
									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 2 of 8</div><nav><ul><li><a href="viewtopic.php%3Fid=18354&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li><li><a href="viewtopic.php%3Fid=18354&amp;p=3.html">3</a></li><li><a href="viewtopic.php%3Fid=18354&amp;p=4.html">4</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=18354&amp;p=8.html">8</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>