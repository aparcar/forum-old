<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Siemens SX551</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 14 Apr 2018 and 5 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 3 of 4</div><nav><ul><li><a href="viewtopic.php%3Fid=33600&amp;p=1.html">1</a></li><li><a href="viewtopic.php%3Fid=33600&amp;p=2.html">2</a></li><li class="pagination-current"><span>3</span></li><li><a href="viewtopic.php%3Fid=33600&amp;p=4.html">4</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p162890">
				<div class="post-metadata">
					<div class="post-num">Post #51</div>
					<div class="post-author">Lekensteyn</div>
					<div class="post-datetime">
						1 Apr 2012, 16:38					</div>
				</div>
				<div class="post-content content">
					<p>I managed to run busybox <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> My messy notes.txt can be found on <a href="http://lekensteyn.nl/files/sx551/">http://lekensteyn.nl/files/sx551/</a> (everything is done on trunk fyi)<br />If you just want to try the build, use fw.bin. If it says that the initrd cannot be found on boot (e.g. after flashing), try turning the device off (serial needs to be detached as well). Wait for a second and put the serial in again. When you&#039;ve your console, turn the device on.</p><p>The kernel and busybox config is attached as well. I couldn&#039;t get networking working, TX bytes/packets stay 0, I can&#039;t ping or anything. When there is network activity from the main router however, the RX bytes/packets increase (for example, on arpscan).</p><p>So overall: pretty much success this weekend, no 1 April joke <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Busybox usage:<br /><a href="http://www.busybox.net/downloads/BusyBox.html">http://www.busybox.net/downloads/BusyBox.html</a></p>											<p class="post-edited">(Last edited by <strong>Lekensteyn</strong> on 1 Apr 2012, 16:41)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p163187">
				<div class="post-metadata">
					<div class="post-num">Post #52</div>
					<div class="post-author">Lekensteyn</div>
					<div class="post-datetime">
						3 Apr 2012, 23:01					</div>
				</div>
				<div class="post-content content">
					<p>Networking is ALSO working now, perhaps cpmac was conflicting with the mvswitch-thing driver. Anyway, I immediately continued with grabbing a 3.2 kernel source to see if things had improved. Started with &quot;make allnoconfig&quot;, I&#039;ve tried to get a kernel as small as possible (even no iptables). The resulting firmware package contains only busybox, a kernel, a few small configuration files and /init.<br />See the revised notes.txt <a href="http://lekensteyn.nl/files/sx551/">http://lekensteyn.nl/files/sx551/</a>, the blob is available in <a href="http://lekensteyn.nl/files/sx551/firmware/">http://lekensteyn.nl/files/sx551/firmware/</a></p><p>Happy hacking!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p163321">
				<div class="post-metadata">
					<div class="post-num">Post #53</div>
					<div class="post-author">Mijzelf</div>
					<div class="post-datetime">
						4 Apr 2012, 20:59					</div>
				</div>
				<div class="post-content content">
					<p>Nice! Works for me. </p><p>The sequence is not clear to me. Did the network work before or after you went to Linux 3.2?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p163325">
				<div class="post-metadata">
					<div class="post-num">Post #54</div>
					<div class="post-author">Lekensteyn</div>
					<div class="post-datetime">
						4 Apr 2012, 22:04					</div>
				</div>
				<div class="post-content content">
					<p>Networking did not work for me on 2.6.37.6 (openwrt patches applied; cpmac and mvswitch thingey compiled in). With 3.2 from kernel.org and some patches, it works. I still have issues with a larger initramfs (or even kernel?) though, even a 64KB larger initramfs (larger busybox+initscripts) resulted in a rootfs not found error. Either I have bad RAM/flash or addresses are wrongly mapped.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p163592">
				<div class="post-metadata">
					<div class="post-num">Post #55</div>
					<div class="post-author">Mijzelf</div>
					<div class="post-datetime">
						7 Apr 2012, 14:49					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Lekensteyn wrote:</cite><blockquote><p>I saw could not find the following file in my tree:<br /><a href="https://dev.openwrt.org/browser/trunk/target/linux/ar7/files/arch/mips/ar7/vlynq-pci.c?rev=9086">https://dev.openwrt.org/browser/trunk/t … c?rev=9086</a></p></blockquote></div><p>I&#039;ve found that code. It&#039;s in trunc/build_dir/linux-ar7/acx-mac80211-20111030/pci.c. <br />Reading <a href="http://comments.gmane.org/gmane.linux.drivers.acx100/1074">this</a> I think the code you found was to emulate a PCI bus for the PCI driver of certain wireless nic&#039;s and that code is moved to the nic driver instead.</p><p>I&#039;ve been searching for info on VLYNQ2PCI bridges. And I&#039;ve found that the acx miniPCI cards in some AR7 routers have some unused PCI pins mapped to the VLYNQ interface. That&#039;s why they work in any miniPCI slot, but you can&#039;t put another miniPCI card in that router, as PCI itself is not wired on the router. (BTW, another reason to beleive this box has a PCI bus. The wifi card isn&#039;t acx)<br />Further I found generic info on VLYNQ, stating how smart and brilliant (and proprietary) it is, and telling that it&#039;s possible to connect vlynq-USB, vlynq-OTG or vlync-PCI bridges.<br />And I found info about the SX553, telling <a href="http://www.webnmail.de/sx553wlandsl/">it has an TNETV100PZ VLYNQ2PCI bridge</a>. Just like our SX551. I don&#039;t think the 553 is actually different.</p><p>What I didn&#039;t find is a datasheet for the TNETV100PZ (lots of dead links from Chinese chip sellers), nor any source code for such a bridge. I also haven&#039;t found any evidence that such a bridge has been used on anything else than these Siemens boxes. </p><p>BTW, VLYNQ is also implemented on the arm omap and davinci SoC&#039;s.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p163640">
				<div class="post-metadata">
					<div class="post-num">Post #56</div>
					<div class="post-author">Mijzelf</div>
					<div class="post-datetime">
						7 Apr 2012, 22:28					</div>
				</div>
				<div class="post-content content">
					<div class="codebox"><pre><code>===========================================================
 TI ADSL AR7300 Loader 0.71.4 build Oct 18 2005 11:13:40
                 Broad Net Technology, INC.
===========================================================
ESS ES29LV160D bottom boot 16-bit mode found

Copying boot params.....DONE

Flash Checking  Passed.

Unzipping  web at 0x94f30000 ... [LZMA] done
Unzipping code at 0x94000000 ... [LZMA] done[    0.000000] Linux version 3.3.1 (Mijzelf@ubuntu) (gcc version 4.6.3 20120201 (prerelease) (Linaro GCC 4.6-2012.02) ) #8 Sat Apr 7 21:30:52 CEST 2012
[    0.000000] gpiochip_add: registered GPIOs 0 to 31 on device: ar7-gpio
[    0.000000] ar7-gpio: registered 32 GPIOs
[    0.000000] bootconsole [early0] enabled
[    0.000000] CPU revision is: 00018448 (MIPS 4KEc)
[    0.000000] TI AR7 (TNETD7300), ID: 0x0005, Revision: 0x26
[    0.000000] Determined physical RAM map:
[    0.000000]  memory: 02000000 @ 14000000 (usable)
[    0.000000] Initrd not found or empty - disabling initrd
[    0.000000] Zone PFN ranges:
[    0.000000]   Normal   0x00014000 -&gt; 0x00016000
[    0.000000] Movable zone start PFN for each node
[    0.000000] Early memory PFN ranges
[    0.000000]     0: 0x00014000 -&gt; 0x00016000
[    0.000000] Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 8128
[    0.000000] Kernel command line:  console=ttyS0,115200n8
[    0.000000] PID hash table entries: 128 (order: -3, 512 bytes)
[    0.000000] Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
[    0.000000] Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
[    0.000000] Primary instruction cache 16kB, VIPT, 4-way, linesize 16 bytes.
[    0.000000] Primary data cache 16kB, 4-way, VIPT, no aliases, linesize 16 bytes
[    0.000000] Memory: 27820k/32768k available (2388k kernel code, 4948k reserved, 517k data, 1616k init, 0k highmem)
[    0.000000] NR_IRQS:256
[    0.000000] Calibrating delay loop... 148.88 BogoMIPS (lpj=744448)
[    0.070000] pid_max: default: 32768 minimum: 301
[    0.070000] Mount-cache hash table entries: 512
[    0.090000] NET: Registered protocol family 16
[    0.100000] bio: create slab &lt;bio-0&gt; at 0
[    0.100000] Switching to clocksource MIPS
[    0.110000] NET: Registered protocol family 2
[    0.110000] IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
[    0.120000] TCP established hash table entries: 1024 (order: 1, 8192 bytes)
[    0.130000] TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
[    0.140000] TCP: Hash tables configured (established 1024 bind 1024)
[    0.140000] TCP reno registered
[    0.150000] UDP hash table entries: 256 (order: 0, 4096 bytes)
[    0.150000] UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
[    0.160000] NET: Registered protocol family 1
[    0.170000] RPC: Registered named UNIX socket transport module.
[    0.170000] RPC: Registered udp transport module.
[    0.180000] RPC: Registered tcp transport module.
[    0.180000] RPC: Registered tcp NFSv4.1 backchannel transport module.
[    0.500000] unable to add cpmac-high phy: -19
[    0.500000] unable to add cpmac-low phy: -19
[    0.510000] io scheduler noop registered
[    0.510000] io scheduler deadline registered (default)
[    0.520000] Serial: 8250/16550 driver, 2 ports, IRQ sharing disabled
[    0.530000] serial8250: ttyS0 at MMIO 0x8610e00 (irq = 15) is a AR7

&lt;snip about 600 empty lines&gt;

 [    2.160000] Freeing unused kernel memory: 1616k freed
- preinit -
Press the [f] key and hit [enter] to enter failsafe mode
f
- failsafe -


BusyBox v1.19.4 (2012-04-07 15:31:41 CEST) built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 ATTITUDE ADJUSTMENT (bleeding edge, r31158) ----------
  * 1/4 oz Vodka      Pour all ingredients into mixing
  * 1/4 oz Gin        tin with ice, strain into glass.
  * 1/4 oz Amaretto
  * 1/4 oz Triple sec
  * 1/4 oz Peach schnapps
  * 1/4 oz Sour mix
  * 1 splash Cranberry juice
 -----------------------------------------------------
root@(none):/# root@(none):/# ifconfig -a
lo        Link encap:Local Loopback  
          LOOPBACK  MTU:16436  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)</code></pre></div><p>There are a few strange things here. <br />- The kernel says it cannot find initrd, but runs openwrt userland from it. <br />- Directly after initializing the serial port I get about 600 empty lines (0x0A). Maybe I&#039;m also missing 600 loglines. At least the log of 75% of the Linux boottime is missing.<br />- There are no NIC&#039;s. When I&#039;ve time again I&#039;ll put my kernel .config next to Lekensteyn&#039;s one.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p163643">
				<div class="post-metadata">
					<div class="post-num">Post #57</div>
					<div class="post-author">Lekensteyn</div>
					<div class="post-datetime">
						7 Apr 2012, 23:07					</div>
				</div>
				<div class="post-content content">
					<p>That &quot;Initrd not found or empty - disabling initrd&quot; message comes from a different part of the kernel, the mips code to be precise. AFAIK, there are at least two ways to load a initial ramfs, using MIPS&#039; specific rd_start/rd_size/(bootloader?) options, and the embedded initramfs feature in newer kernels (which is what I&#039;m using).</p><p>About the serial issue, have you applied <a href="http://lekensteyn.nl/files/sx551/patches/500-serial_kludge-3.2.patch">http://lekensteyn.nl/files/sx551/patche … -3.2.patch</a>? Without it, words would be mixed in random order after &quot;serial8250: ttyS0 at ...&quot;.</p><p>For the NIC to work, be sure to enable cpmac. The DSA_MARVELL thing did not work for me (the device is not attempted to get probed).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p163698">
				<div class="post-metadata">
					<div class="post-num">Post #58</div>
					<div class="post-author">Mijzelf</div>
					<div class="post-datetime">
						8 Apr 2012, 15:33					</div>
				</div>
				<div class="post-content content">
					<p>Sorted the NIC. CONFIG_FIXED_PHY=y had to be set. For some reason the serial output now works normal too. A bit flaky.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p163702">
				<div class="post-metadata">
					<div class="post-num">Post #59</div>
					<div class="post-author">Lekensteyn</div>
					<div class="post-datetime">
						8 Apr 2012, 15:40					</div>
				</div>
				<div class="post-content content">
					<p>How large are your vmlinuz and initramfs files? How are you building the firmware image? Using my mkfirm2 script?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p163708">
				<div class="post-metadata">
					<div class="post-num">Post #60</div>
					<div class="post-author">Mijzelf</div>
					<div class="post-datetime">
						8 Apr 2012, 16:08					</div>
				</div>
				<div class="post-content content">
					<p>My vmlinux is 4320816 bytes, with build-in (lzma&#039;d) initramfs. According to du the initramfs is 1892k. The compressed vmlinux is 1413408 bytes.<br />And I&#039;m using an adapted version of <a href="http://ar7-firmware.berlios.de/doc/loader.html.en">mkfirm</a>.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p163709">
				<div class="post-metadata">
					<div class="post-num">Post #61</div>
					<div class="post-author">Lekensteyn</div>
					<div class="post-datetime">
						8 Apr 2012, 16:20					</div>
				</div>
				<div class="post-content content">
					<p>And it still boots properly? Weird, a vmlinux of 3092932 (with built-in initramfs) works fine, but a larger one causes errors (like root device not found). When I tried mkfirm from your link, the image created by it was larger with a bunch of useless 0xff bytes which is why I made this custom mkfirm2 script. What changes did you made to that file?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p163741">
				<div class="post-metadata">
					<div class="post-num">Post #62</div>
					<div class="post-author">Mijzelf</div>
					<div class="post-datetime">
						8 Apr 2012, 19:34					</div>
				</div>
				<div class="post-content content">
					<p>You can find my mkfirm <a href="http://www.mediafire.com/?766bl252t0j23">here</a>. The main difference is that I implemented a blocksize of 1k, instead of the 64k block of the original (I told you about the 4k boundary, but I remembered wrong. It was 1k). And I added partitionsizes and magic numbers for the SX551,&nbsp; SX553 and SE555.</p><p>But I don&#039;t think it has anything to do with your sizeproblem. I believe that the fimwarefile is only important to get it flashed. Once flashed, the bootloader will accept anything, as long as he can decompress it.<br />Maybe my version works because I used &#039;the openwrt way&#039;? (Don&#039;t know what that is. I just let openwrt create the whole thing for me.)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p163743">
				<div class="post-metadata">
					<div class="post-num">Post #63</div>
					<div class="post-author">Lekensteyn</div>
					<div class="post-datetime">
						8 Apr 2012, 19:48					</div>
				</div>
				<div class="post-content content">
					<p>Yep, I&#039;m using 1K for blocksize as well. Hopefully my flash chip is not broken. Can you try to boot a firmware image that fails to boot here due to size? If yes, I can mail it to you (or another method you prefer).</p><p>If you&#039;re pass the linux-ar7/vmlinux file to mkfirm, there is no difference. The &quot;OpenWRT&quot; way is applying some patches (not affecting me AFAIK), build it and generate firmware images (which I don&#039;t directly use). The linux-ar7/vmlinux file is a stripped version of linux-ar7/linux-X.Y.Z/vmlinux file.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p163744">
				<div class="post-metadata">
					<div class="post-num">Post #64</div>
					<div class="post-author">Mijzelf</div>
					<div class="post-datetime">
						8 Apr 2012, 20:15					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Lekensteyn wrote:</cite><blockquote><p>Can you try to boot a firmware image that fails to boot here due to size?</p></blockquote></div><p>Sure. Put it on your server. (And give me a MD5 sum, just to be sure)</p><div class="quotebox"><blockquote><p>The &quot;OpenWRT&quot; way is applying some patches (not affecting me AFAIK), build it and generate firmware images (which I don&#039;t directly use). The linux-ar7/vmlinux file is a stripped version of linux-ar7/linux-X.Y.Z/vmlinux file.</p></blockquote></div><p>It does something more. It also puts the initramfs inside the kernel.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p163748">
				<div class="post-metadata">
					<div class="post-num">Post #65</div>
					<div class="post-author">Lekensteyn</div>
					<div class="post-datetime">
						8 Apr 2012, 21:18					</div>
				</div>
				<div class="post-content content">
					<p><a href="http://lekensteyn.nl/files/sx551/firmware/sx551-linux-3.2.14-more1.fw.bin">http://lekensteyn.nl/files/sx551/firmwa … re1.fw.bin</a><br />MD5: a00b283efe4e100a29ab2e97a5d44b75<br />Size: 1338378 bytes<br />Boot log: <a href="http://lekensteyn.nl/files/sx551/logs/boot-linux-3.2.14-more1.txt">http://lekensteyn.nl/files/sx551/logs/b … -more1.txt</a></p><p>The initial ramfs is embedded into it as well (uncompressed though). Perhaps that makes the difference of failure?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p163757">
				<div class="post-metadata">
					<div class="post-num">Post #66</div>
					<div class="post-author">Mijzelf</div>
					<div class="post-datetime">
						8 Apr 2012, 22:06					</div>
				</div>
				<div class="post-content content">
					<p>My bootlog is identical to yours. So it&#039;s not your flash. <br /></p><div class="quotebox"><blockquote><p>The initial ramfs is embedded into it as well (uncompressed though)</p></blockquote></div><p>I thought my initramfs was uncompressed as well, but a look in the openwrt config shows it&#039;s lzma compressed. Don&#039;t know if it matters.</p><p>If you are interested, I uploaded my firmware to my mediafire folder. md5 b4e2bf09f702720e08db0548c34ac8eb</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p163766">
				<div class="post-metadata">
					<div class="post-num">Post #67</div>
					<div class="post-author">Lekensteyn</div>
					<div class="post-datetime">
						8 Apr 2012, 22:51					</div>
				</div>
				<div class="post-content content">
					<p>What a relief. Now I wonder what might have caused it. Perhaps the vmlinux image is uncompressed to a spot where it overlaps the initramfs uncompression space. What size is the file (vmlinux in particular?)? Can you mail it to me lekensteyn@gmail.com or provide a link?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p163818">
				<div class="post-metadata">
					<div class="post-num">Post #68</div>
					<div class="post-author">Mijzelf</div>
					<div class="post-datetime">
						9 Apr 2012, 12:34					</div>
				</div>
				<div class="post-content content">
					<p>I don&#039;t have a bare vmlinux. The output of the build is vmlinux with embedded initramfs.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p163823">
				<div class="post-metadata">
					<div class="post-num">Post #69</div>
					<div class="post-author">Lekensteyn</div>
					<div class="post-datetime">
						9 Apr 2012, 12:56					</div>
				</div>
				<div class="post-content content">
					<p>Yea, that&#039;s OK. Just the linux-ar7/linux-xxx/System.map would be fine as it contains the addresses I&#039;m looking for.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p163825">
				<div class="post-metadata">
					<div class="post-num">Post #70</div>
					<div class="post-author">Mijzelf</div>
					<div class="post-datetime">
						9 Apr 2012, 13:12					</div>
				</div>
				<div class="post-content content">
					<p>I uploaded System.map <a href="http://www.mediafire.com/?766bl252t0j23">here</a>.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p164468">
				<div class="post-metadata">
					<div class="post-num">Post #71</div>
					<div class="post-author">Mijzelf</div>
					<div class="post-datetime">
						14 Apr 2012, 12:42					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Lekensteyn wrote:</cite><blockquote><p>AFAIK, there are at least two ways to load a initial ramfs, using MIPS&#039; specific rd_start/rd_size/(bootloader?) options,</p></blockquote></div><p>That could be a way to use the psf partition to contain an initrd. Just hardcode the startaddress (0x94f30000) and endaddress in the kernel. Unfortutely the partition is just 249k, while my current initramfs is lzma compressed 478406 bytes. Would it be possible to combine the initramfs and initrd? Maybe initrd is available as /dev/ram, or something like that?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p164469">
				<div class="post-metadata">
					<div class="post-num">Post #72</div>
					<div class="post-author">Lekensteyn</div>
					<div class="post-datetime">
						14 Apr 2012, 12:52					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve noticed that you&#039;ve compressed all zeroes into a 1024 bytes PFS LZMA and am now trying to do the same. Furthermore, my instructions seem to miss one patch: change BOOT_ELF32 to BOOT_RAW in arch/mips/Kconfig under the AR7 target.</p><p>Initrd is a block device (includes the bloat of block devices like caching) where initramfs really runs in RAM. MIPS initrd seem to refer to initramfs too, not the block device thing.</p><p>Edit: tested with a smaller pfs, still fails with &quot;Kernel panic - not syncing: VFS: Unable to mount root fs on unknown-block(0,0)&quot;.</p><p>Can you share your kernel config?</p>											<p class="post-edited">(Last edited by <strong>Lekensteyn</strong> on 14 Apr 2012, 13:08)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p164471">
				<div class="post-metadata">
					<div class="post-num">Post #73</div>
					<div class="post-author">Mijzelf</div>
					<div class="post-datetime">
						14 Apr 2012, 13:26					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Lekensteyn wrote:</cite><blockquote><p>I&#039;ve noticed that you&#039;ve compressed all zeroes into a 1024 bytes PFS LZMA</p></blockquote></div><p>Yeah, I had to provide *something*. Did you ever observe that /dev/zero compresses marvellous? :-)<br /></p><div class="quotebox"><blockquote><p>Can you share your kernel config?</p></blockquote></div><p>I uploaded kernel .config <a href="http://www.mediafire.com/?766bl252t0j23">here</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p164473">
				<div class="post-metadata">
					<div class="post-num">Post #74</div>
					<div class="post-author">Lekensteyn</div>
					<div class="post-datetime">
						14 Apr 2012, 13:49					</div>
				</div>
				<div class="post-content content">
					<p>And the filesize is minimal <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /> Most of the file size comes from the padding.</p><p>I checked your .config against my config on 3.3.2 and it looks fine. I&#039;ve tried building 3.2.2 with three patches + one sed command applied, but it still fails.<br />Maybe it&#039;s because I&#039;m using a file list now where I was using a directory in the past as initramfs source. The usr/initramfs_data.cpio file is properly generated though.</p><p>Can you tell me more about your method of building? What patches have you applied against the 3.2.1 tree?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p164486">
				<div class="post-metadata">
					<div class="post-num">Post #75</div>
					<div class="post-author">Mijzelf</div>
					<div class="post-datetime">
						14 Apr 2012, 16:43					</div>
				</div>
				<div class="post-content content">
					<p>I didn&#039;t document it as good as I should. But this is it, as far as I remember:<br />* Download trunk<br />* Edit trunk/target/ar7/Makefile:<br />&nbsp; &nbsp; LINUX_VERSION:=3.3.1<br />* cd trunk<br />* run make defconfig<br />* run make menuconfig<br />&nbsp; &nbsp;disabled pretty everything (now I know uci and mtd are necessary)<br />&nbsp; &nbsp;in Target Images I enabled ramdisk.<br />* run make<br />* This errors out on applying the patch patches/generic/910-kobject_uevent.patch<br />* removed that patch from trunk/build_dir/linux-ar7/linux-3.3.1/patches/series<br />* applied your 2 patches manually, changed addresses, ...<br />* run make kernel_menuconfig<br />&nbsp; &nbsp;removed everything I don&#039;t need<br />* build make again.</p><p>That&#039;s it, I think.</p>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 3 of 4</div><nav><ul><li><a href="viewtopic.php%3Fid=33600&amp;p=1.html">1</a></li><li><a href="viewtopic.php%3Fid=33600&amp;p=2.html">2</a></li><li class="pagination-current"><span>3</span></li><li><a href="viewtopic.php%3Fid=33600&amp;p=4.html">4</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>