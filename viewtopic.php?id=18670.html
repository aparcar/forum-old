<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> VFS-Unable to mount rootfs</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 12 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p80659">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Powar</div>
					<div class="post-datetime">
						29 Jan 2009, 11:56					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>&nbsp; &nbsp;I m trying to bring up Kamikaze-RC1 on x86-Desktop PC. I have compiled it sucessfully and loaded the image onto USB stick(2GB) using the following command</p><p>&nbsp; dd if=openwrt-x86-ext2.image of=/dev/sdb</p><p>&nbsp; (the Important thing which I noted was that - the openwrt-x86-ext2.image is partitioning the USB stick into two partitions, one which has got /boot/grub/ folder which acts as the grub boot loader and the other drive its creating the Normal Linux Filesystem)</p><p>&nbsp; While compiling, in the buid &quot;Target Images&quot; option I have given the &quot;root partition on the target device &quot; filesystem directory to be /dev/sdb.</p><p>&nbsp; But once I am booting the USB(by changing the boot options in the BIOS to USB) I m getting this error:</p><p>&nbsp; &quot;Kernel Panic - Not syncing: VFS: unable to mount rootfs on unknown block(0,0)&quot;</p><p>&nbsp; More details wrt compilation procedure:<br /> 1)Enabled all the Kernel modules wrt to USB,VGA Console, SCSI Device support. Monitor support, Ethernet and WiFi support etc..</p><p>&nbsp; Any help is highly appreciated.</p><br /><p>thanks in advance,</p><p>Powar</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p80721">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Powar</div>
					<div class="post-datetime">
						30 Jan 2009, 06:54					</div>
				</div>
				<div class="post-content content">
					<p>Ok Now I m compiling the Kamikaze_RC2.</p><p>Saw in Kamikaze forums that the Kamikaze x86 build supports mainly the sokris board based on X86 Platform.</p><p>any how I m trying one again to boot up my X86 m/c</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p80728">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Powar</div>
					<div class="post-datetime">
						30 Jan 2009, 10:52					</div>
				</div>
				<div class="post-content content">
					<p>Even Kamikaze_RC2 has got the same set of problems, hmm still need to debug where exactly I a going wrong.</p><p>Tried these things for bringing up the X86 based m/c<br />1) configured root=LABEL=/ in grub<br />2) configured root=/dev/sdb2, this is what with which I have compiled and this is the default kernel option set at grub<br />3) even tried to load the vdi(virtual box image), this is also not comming up (OpenWrt Kamikaze_RC1 is comming up through VmWare).....<br />&nbsp; &nbsp; Any how I mastered the compilation procedure....</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p80987">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Powar</div>
					<div class="post-datetime">
						3 Feb 2009, 17:16					</div>
				</div>
				<div class="post-content content">
					<p>Hi All,<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &quot;I COULD DOWNLOAD KAMIKAZE ON A DESKTOP PC - X86 Machine&quot;. -- Really Its gorgeous.....</p><p>&nbsp; &nbsp; &nbsp; &nbsp;All the above said problems were because of SCSI HardDisk and SCSI USB Drives.</p><p>&nbsp; &nbsp; &nbsp; &nbsp;I think OPENWRT Guys need to take this scenario and try to patch it for next update.</p><p>&nbsp; &nbsp; &nbsp; &quot;ie booting using SCSI drives&quot;</p><p>&nbsp; &nbsp; &nbsp; &nbsp;I donot know how to raise this issue to OpenWRT guys - Could anybody please help me in this issue&quot;</p><p>&nbsp; &nbsp; &nbsp; And Thx to a lot of guys who have viewed my previous postings and also replied to my queries&quot;</p><p>&nbsp; &nbsp; &nbsp;Now I can really help You guys If U want me for porting into X86 based platforms.</p><p>Thx</p><p>Powar</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p81130">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">Powar</div>
					<div class="post-datetime">
						5 Feb 2009, 08:39					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>&nbsp; &nbsp;Can anybody give me the procedure as to how to set up a router functionality in OpenWRT.<br />&nbsp; <br />&nbsp; &nbsp;i.e What are the packages which we have install in OpenWRT etc..</p><p>Thanks in advance,</p><p>Regards<br />Powar</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p81653">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">doddel</div>
					<div class="post-datetime">
						11 Feb 2009, 20:28					</div>
				</div>
				<div class="post-content content">
					<p>Hi,<br />am struggling with exact same situation and kernel panic error message after booting from usb pen drive.<br />Have several unused Pentrium 4 notebook motherboards with mini-pci and 4 x usb2.0 and would like to turn them into fast routers using OpenWrt. <br />vmlinuz loads but then the panic starts.</p><p>What did you change in the settings before compilation to cure the problem ? You hint at a scsi issue but the details are unclear to me. </p><p>tnx<br />doddel</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p81694">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">Powar</div>
					<div class="post-datetime">
						12 Feb 2009, 07:04					</div>
				</div>
				<div class="post-content content">
					<p>Hi Doddel,</p><p>&nbsp; &nbsp; &nbsp; &nbsp;Just use the IDE (ATA) devices. This OpenWRT according to me cant be loaded onto SCSI Drives. </p><p>see this<br />&nbsp; &nbsp; &nbsp; &nbsp; <a href="http://www.adrc.com/ckr/hard_disk.html">http://www.adrc.com/ckr/hard_disk.html</a><br />&nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; you will get some info about different types of Hard Disks which we will be using unknowingly.</p><p>&nbsp; &nbsp; &nbsp; &nbsp; When you insert a Hard Drive or USB drive, the OS will install drivers for that Disk, What I could observe is that when we are inserting the USB drives, the OpenWRT is not able to load the necessary drivers, In a way the OpenWRT OS is not able to find that there is some disk which exists in your system.</p><p>&nbsp; &nbsp; &nbsp; &nbsp;So the best option is get a IDE device and then burn the image onto the IDE Drive(using dd if=xxx.image of=/dev/hda (here hdX will be comming when we insert a IDE hard disk)) and thats it, it will Format the hda disk and then load the kernel and the mount it.</p><p>&nbsp; &nbsp; &nbsp; &nbsp;If you are not able to mount it correctly change the grub options, thats it yours OS will start...</p><p>&nbsp; &nbsp; &nbsp; &nbsp;If you are not able to do this, send the log.</p><br /><br /><p>Bye<br />Powar</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p81711">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">doddel</div>
					<div class="post-datetime">
						12 Feb 2009, 11:50					</div>
				</div>
				<div class="post-content content">
					<p>Hi Powar, thanks for the explanation.</p><p>The result, using IDE and a real HDD, however defeats my intention to have an all solid-state passive system without HDD with moving parts and wear.<br />Of course could use a solid-state HDD. Will look into that.</p><p>Have been able to successfully load other linux distributions from the pen drivve, like puppy-linux and plop-linux.<br />Both however, after loading vmlinuz and a initrd.gz also spent some time on loading drivers before actually starting the OS.<br />I guess you are right that OpenWrt does not cater for the process needed to find the usb pen-drive hidden behind a scsi interface.</p><p>Just out of interest will look a bit further into how the other linux distributions accomplish this boot process from a usb pen-drive.<br />Perhaps this bootloader <a href="http://www.plop.at/en/bootmanager.html">http://www.plop.at/en/bootmanager.html</a>&nbsp; can provide OpenWrt with the environment to be able to boot.</p><p>rgds<br />doddel</p>											<p class="post-edited">(Last edited by <strong>doddel</strong> on 12 Feb 2009, 12:06)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p81723">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">Powar</div>
					<div class="post-datetime">
						12 Feb 2009, 14:19					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>&nbsp; &nbsp;please inform me if you could install the OpenWRT (in the mere future)&nbsp; onto a SCSI device like a Usb Pendrive. I tried it many times and faltered and did you try installing the OpenWRT onto a SATA Drive, if yes let me know.</p><p>And if possible give me the procedure as to how to raise a ticket and track the ticket in OpenWRT forum</p><br /><p>Thanks<br />Suresh K</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p81735">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">doddel</div>
					<div class="post-datetime">
						12 Feb 2009, 16:57					</div>
				</div>
				<div class="post-content content">
					<p>The last question about the ticket is is easy: <a href="https://dev.openwrt.org">https://dev.openwrt.org</a>/</p><p>Am currently looking into how puppy linux have solved the issue.&nbsp; They use an impressively long and complicated init script, after loading the kernel, to install everything but it is of course an extensive desktop version of linux. <br />The relevant part analyzes the pci bus and determines the need for uhci, ohci, ehci drivers, <br />loads usbcore, loads u/o/ehci-hcd as needed, loads usb-storage , mounts a usb file system, loads nls_cp437&nbsp; and nls_iso8859-1, and then waits for the usb storage devices to have registered before continuing .... They also have provisions for zip drives and legacy ide.<br />Will now look how OpenWrt goes about initializing usb. There are versions for units with usb, like the Asus500gP but there the boot doesn&#039;t happen from usb but from built-in flash so usb can be initialized later. I have the feeling that the trick is in forcing the relevant kernel modules to be loaded early on in the process so the physical access to the file system is ready when needed.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p81739">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">Powar</div>
					<div class="post-datetime">
						12 Feb 2009, 17:23					</div>
				</div>
				<div class="post-content content">
					<p>Hi doodle,</p><p>&nbsp; Now I am trying to setup wifi functionality, have got two Linksys WMP54G Cards, and I have set both these as AP&#039;s, n now I am not able to scan each other, It would be great if you have any pointers.</p><p>&nbsp; Any links also would be sufficient</p><p>Thx<br />Powar</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p81825">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">doddel</div>
					<div class="post-datetime">
						13 Feb 2009, 21:17					</div>
				</div>
				<div class="post-content content">
					<p>Just succeeded in booting OpenWrt from the USB pendrive on an ECS A928 desknote PC. (Pentium 4 system, ~2002, with VIA VT6202 usb2.0 controller and SiS 650/961 chipset)</p><p>There are actually no special tricks needed in terms of additions to OpenWrt but it is required to make changes to the kernel compilation settings.<br />The procedure:</p><p>A: OpenWrt compilation<br />1. Download and install a working openwrt compiler toolchain; mine is kamikaze trunk of Feb. 13 2009&nbsp; r14476.<br />2. Under make menuconfig of course select x86 and generic profile and whatever you want in terms of packages.<br />3. Do a &#039;make kernel_menuconfig&#039; and there activate relevant scsi and usb 1.0 / 2.0 / disk support to be permanent part of the kernel. Under scsi it is important to activate the asynchronous scsi feature (otherwise it tries to mount the file systems on the pen-drive before they have been identified to exist&nbsp; which results in kernel panic).</p><p>B: My PC and USB pen-drive specific stuff<br />1. what is on my 4 GB pen-drive is two partitions which when the PC runs with Fedora Core 10 Linux show as /dev/sdb4 (a bootable vfat partition 124 MB with syslinux files to which I added OpenWrt&#039;s renamed kernel vmlinuz)&nbsp; and /dev/sdb2 (ext2 partition with OpenWrt ext2 file system and files, the remaining 3.8 GB)<br />2. I partitioned the pen drive the above way using dd to copy an image onto it that contains master boot record, partition table, and partitions and stems from puppy linux; it makes the drive, although partitioned, also appear to be a zip-drive to older AMI BIOS systems (boot partition must be # 4), like mine; more modern PCs with USB boot option shouldn&#039;t need this tricky partitioning but mine doesn&#039;t boot unless it thinks it is an unpartitioned&nbsp; zip drive or superfloppy, even though the AMI bios talks about a USB RMD-FDD). <br />Notes:<br />* openwrt-x86-vmlinuz needs to be renamed to just vmlinuz (syslinux specific, not applicable to grub)<br />* my choice for syslinux bootloader was forced by the special boot image and partitioning my PC needs and happens to use syslinux. Normally with more recent PCs the images produced by the OpenWrt compilation, offering through menuconfig a choice between grub and lilo, should work fine.&nbsp; </p><p>Now it almost worked and showed signs of scsi and the presence of the usb pen drive but there turned out to be a naming convention issue. What shows under Fedora10 as sdb4 and sdb2, in the presence of also a harddisk sda, shows during OpenWrt boot as uba4 and uba2. So the filesystem to be mounted is the ext2 one with the OpenWrt file system on it and seen by the kernel as uba2. When the kernel doesn&#039;t find a mountable filesystem it will list the partitions it has found through the scsi/usb system and then panic; so you can edit the boot configuration file to make the kernel pick the right one next time.</p><p>My syslinux.cfg file now looks as follows:</p><p>default openwrt<br />label openwrt<br />kernel vmlinuz<br />append root=/dev/uba2 rootfstype=ext2 init=/etc/preinit&nbsp; noinitrd console=tty0 console=ttyS0,38400n8 reboot=bios</p><p>and then it boots, no HDD or CD/DVD drive present, just the pen-drive and RAM . Again impressed by the flexibility of OpenWrt !</p>											<p class="post-edited">(Last edited by <strong>doddel</strong> on 15 Feb 2009, 16:58)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p92795">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">MrUmunhum</div>
					<div class="post-datetime">
						18 Aug 2009, 05:47					</div>
				</div>
				<div class="post-content content">
					<p>How are you guys doing?&nbsp; Did you get it to work??</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>