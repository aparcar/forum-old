<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Somehow i have induced a kernel panic. don&#039;t know how to fix.</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 23 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p141876">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Catfish</div>
					<div class="post-datetime">
						22 Aug 2011, 16:03					</div>
				</div>
				<div class="post-content content">
					<p>Hi everybody,</p><p>I have some how managed to get my openwrt into a kernel panic. Here is what i did over the last few days:</p><p>reflashed firmware to backfire rc5<br />reinstalled all usb support packages required to get usb storage connected<br />reinstalled wifi drivers<br />(i kept all config files so no network setup required - it was working)<br />finally i got to the point where i wanted to make the wgt346u boot from usb storage.<br />the usb device was /dev/sda1 and is an empty formatted ext2 partition.<br />i followed the instructions for extroot in the wiki: <a href="http://wiki.openwrt.org/doc/howto/extroot#configuration">http://wiki.openwrt.org/doc/howto/extroot#configuration</a> and followed the settings for Old external overlay variant as this is the only method supported by backfire rc5 (afaik). My /etc/config/fstab settings were:<br /></p><div class="codebox"><pre><code>config mount
 option target /mnt # This is ignored once is_rootfs is set to 1 
 option device /dev/sda1
 option fstype ext2 
 option options rw,sync
 option enabled 1
 option enabled_fsck 0
 option is_rootfs 1</code></pre></div><p>For a while i was rebooting, trying to get it to mount as root. Then I noticed I needed to install the mount-extroot package. After doing this, I rebooted. Then the wgt346u wouldnt start up.</p><p>I connected to it via serial and found the kernal panic message:<br /></p><div class="quotebox"><blockquote><p>- preinit -<br />Press the [f] key and hit [enter] to enter failsafe mode<br />- regular preinit -<br />- merge overlay components -<br />Kernel panic - not syncing: Attempted to kill init!</p></blockquote></div><p>I can get into failsafe mode, and I followed instructions on the failsafe <a href="http://wiki.openwrt.org/doc/howto/generic.failsafe">http://wiki.openwrt.org/doc/howto/generic.failsafe</a> wiki page (ran &#039;mount_root&#039; to load the overlay) and edited /etc/config/fstab to not want to make /dev/sda1 the rootfs but the device still kernel panics when booting. Is there something else I must do in failsafe mode to revert my extroot adventures?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>