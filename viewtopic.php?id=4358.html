<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> New Package : Pure-ftpd 1.0.20 with all feature</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 24 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p20334">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">SeDkY</div>
					<div class="post-datetime">
						7 Feb 2006, 00:57					</div>
				</div>
				<div class="post-content content">
					<p>pure-ftpwho enabled, puredb enabled, all feature enabled <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Just tell me if its work and if some libs is needed</p><p>Go <a href="http://www.freefileupload.net/file.php?file=files/060206/1139266358/pure-ftpd_1.0.20-1_mipsel.ipk">http://www.freefileupload.net/file.php? â€¦ mipsel.ipk</a> at bottom of the page for download <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>Sorry for my language i am french.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p34234">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">VeNoM</div>
					<div class="post-datetime">
						21 Sep 2006, 21:28					</div>
				</div>
				<div class="post-content content">
					<p>Can you upload the file again ?<br />Thanks.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p34246">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">aorlinsk</div>
					<div class="post-datetime">
						22 Sep 2006, 00:55					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>If you need it, i have compiled it also. You can find a package here : <a href="http://aorlinsk2.free.fr/openwrt/">http://aorlinsk2.free.fr/openwrt/</a><br />You will have to install libelf before, since my package is not perfect and the dependencies are not configured...</p><p>In the package you have pure-ftpd and pure-pw, no ssl and funky features are compiled in.</p><p>If you wait the week-end you can even get the sources of the package.</p><p>Anael</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p34253">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">VeNoM</div>
					<div class="post-datetime">
						22 Sep 2006, 07:25					</div>
				</div>
				<div class="post-content content">
					<p>Ok, thank you.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p34255">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">VeNoM</div>
					<div class="post-datetime">
						22 Sep 2006, 10:17					</div>
				</div>
				<div class="post-content content">
					<p>I have installed a version from florian&#039;s alphacore and I can&#039;t get passive mode working ... At work I am behind a NAT so I have to use passive mode.</p><p>pure-ftpd starting options<br />OPTIONS=-&quot; -A -a 0 -c 10 -B -C 3 -D -E -f ftpd -H -I 5 -L 2000:8 -m 4 -p 65000:65100 -P xxx.xxx.xxx.xxx -S 10.0.0.1,30001 -U 133:022 -w -x -X -i -O clf:/opt/var/log/pureftpd.log -R -g /var/run/pure-ftpd.pid -k 95 -Z&quot;</p><p>iptables rules</p><p># pure-ftpd open on port 30001<br />iptables -t nat -A prerouting_rule -i $WAN -p tcp --dport 30001 -j DNAT --to-destination 10.0.0.1:30001<br />iptables -t filter -A input_rule -i $WAN -p TCP --dport 30001 -d 10.0.0.1 -j ACCEPT<br />iptables -t nat -A PREROUTING -i $WAN -p tcp --dport 65000:65100 -j DNAT --to-destination 10.0.0.1</p><p>any ideas ? thank you</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p35229">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">MMCM</div>
					<div class="post-datetime">
						11 Oct 2006, 12:38					</div>
				</div>
				<div class="post-content content">
					<p>Hi Anael!</p><p>I tried your package on a WGT634U running buildroot-ng R4927, and I have several problems with it using puredb authentication.</p><p>Generating pureftpd.passwd and converting it to .pdb is no problem, but:<br /># pure-pw list -f /etc/pure-ftpd/pureftpd.passwd<br />Unable to open the passwd file: No such file or directory</p><p>But<br /># pure-pw show username -f /etc/pure-ftpd/pureftpd.passwd<br />Works!</p><p>when I try to login with an ftp client:<br /><a href="ftp://ftp.info">ftp.info</a> pure-ftpd: (?@192.168.0.3) [INFO] New connection from 192.168.0.3<br /><a href="ftp://ftp.err">ftp.err</a> pure-ftpd: (?@192.168.0.3) [ERROR] Unable to read the indexed puredb file (or old format detected) - Try pure-pw mkdb</p><p>A similar configuration works on my opensuse 10.1.</p><p>best regards<br />Martin</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p35243">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">aorlinsk</div>
					<div class="post-datetime">
						11 Oct 2006, 17:10					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>MMCM wrote:</cite><blockquote><p>Hi Anael!</p><p>I tried your package on a WGT634U running buildroot-ng R4927, and I have several problems with it using puredb authentication.</p><p>Generating pureftpd.passwd and converting it to .pdb is no problem, but:<br /># pure-pw list -f /etc/pure-ftpd/pureftpd.passwd<br />Unable to open the passwd file: No such file or directory</p><p>But<br /># pure-pw show username -f /etc/pure-ftpd/pureftpd.passwd<br />Works!</p><p>when I try to login with an ftp client:<br /><a href="ftp://ftp.info">ftp.info</a> pure-ftpd: (?@192.168.0.3) [INFO] New connection from 192.168.0.3<br /><a href="ftp://ftp.err">ftp.err</a> pure-ftpd: (?@192.168.0.3) [ERROR] Unable to read the indexed puredb file (or old format detected) - Try pure-pw mkdb</p><p>A similar configuration works on my opensuse 10.1.</p><p>best regards<br />Martin</p></blockquote></div><p>You have to do pure-pw mkdb with input your pureftpd.passwd and output your pureftpd.db<br />This will &#039;compile&#039; your .passwd file into a .db file.<br />Then run pure-ftpd and give the .db file as your puredb file.</p><p>Anael</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p35247">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">MMCM</div>
					<div class="post-datetime">
						11 Oct 2006, 17:22					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>aorlinsk wrote:</cite><blockquote><p>You have to do pure-pw mkdb with input your pureftpd.passwd and output your pureftpd.db<br />This will &#039;compile&#039; your .passwd file into a .db file.<br />Then run pure-ftpd and give the .db file as your puredb file.</p><p>Anael</p></blockquote></div><p>Do you really think, I didn&#039;t do that? ;-)</p><p>The .db file is definitely there (I can see the accounts with hexdump -C), and I pass it&#039;s filename with the following options in S50pure-ftpd:<br /> </p><div class="quotebox"><blockquote><p>root@wgt634u:/etc/pure-ftpd# ls -l<br />-rw-------&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 103 Oct&nbsp; 9 21:15 pureftpd.passwd<br />-rw-------&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2169 Oct&nbsp; 9 21:46 pureftpd.pdb</p><p>root@wgt634u:/etc/init.d# cat S50pure-ftpd<br />#!/bin/sh /etc/rc.common<br /># Copyright (C) 2006 OpenWrt.org</p><p>BIN=pure-ftpd<br />DEFAULT=/etc/default/$BIN<br />LOG_D=/var/log/$BIN<br />RUN_D=/var/run<br />PID_F=$RUN_D/$BIN.pid<br />OPTIONS=&quot;-B -E -lpuredb:/etc/pure-ftpd/pureftpd.pdb -U 133:022 -g $PID_F&quot;<br />[ -f $DEFAULT ] &amp;&amp; . $DEFAULT</p><p>start() {<br />&nbsp; &nbsp; &nbsp; &nbsp; mkdir -p $LOG_D<br />&nbsp; &nbsp; &nbsp; &nbsp; mkdir -p $RUN_D<br />&nbsp; &nbsp; &nbsp; &nbsp; $BIN $OPTIONS<br />}</p><p>stop() {<br />&nbsp; &nbsp; &nbsp; &nbsp; [ -f $PID_F ] &amp;&amp; kill $(cat $PID_F)<br />}</p></blockquote></div><p>Anything wrong here?</p><p>And even, if there&#039;s something wrong with the .db file, it doesn&#039;t explain the following:</p><div class="quotebox"><blockquote><p># pure-pw list -f /etc/pure-ftpd/pureftpd.passwd<br />Unable to open the passwd file: No such file or directory</p></blockquote></div><p>Do you use puredb?</p><p>Any clues?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p35257">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">aorlinsk</div>
					<div class="post-datetime">
						11 Oct 2006, 21:11					</div>
				</div>
				<div class="post-content content">
					<div class="codebox"><pre><code>root@OpenWrt:/etc/pure-ftpd# ls -l
-rw-------    1 root     root         2154 Jan  1  2000 users.db
-rw-------    1 root     root           88 Jan  1  2000 users.pwfile


root@OpenWrt:/etc/init.d# more S55pureftpd
#!/bin/sh
pure-ftpd -A -B -c 10 -E -g /tmp/pure-ftpd.pid -I 5 -l puredb:/etc/pure-ftpd/users.db -u 1 -U 111:000 -y 3:10 -Z</code></pre></div><p>And this works, I mean you can connect to my FTP using the password defined in the users.db file and upload/download files without problem.</p><p>However, I also get <br /></p><div class="codebox"><pre><code>root@OpenWrt:/etc/pure-ftpd# pure-pw list -f users.pwfile
Unable to open the passwd file: No such file or directory
root@OpenWrt:/etc/pure-ftpd# pure-pw list -f users.db
Unable to open the passwd file: No such file or directory</code></pre></div><p>Maybe my build is wrong somewhere, my patches to get the compilation work were maybe a bit too hacky...</p><p>I&#039;ll try to post the makefile there tonight.</p><br /><p>Anael</p>											<p class="post-edited">(Last edited by <strong>aorlinsk</strong> on 11 Oct 2006, 21:13)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p35266">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">MMCM</div>
					<div class="post-datetime">
						11 Oct 2006, 22:58					</div>
				</div>
				<div class="post-content content">
					<p>Well, I tested pure-ftpd with exactly your options now, except for the different name of the db file and the pid file.<br />Still the same problem :-(<br />Recreating the db file doesn&#039;t help too...</p><p>Could you create a simple db file for me (one, that works on your system), for testing?<br />User test, password test, home = /tmp</p><p>What platform is your pure-ftpd running?<br />Mine is WGT634U with buildroot-ng R4927 2.6 kernel<br />Or does it require any other packages than libelf?</p><p>Martin</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p35318">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">aorlinsk</div>
					<div class="post-datetime">
						12 Oct 2006, 21:02					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>MMCM wrote:</cite><blockquote><p>Well, I tested pure-ftpd with exactly your options now, except for the different name of the db file and the pid file.<br />Still the same problem :-(<br />Recreating the db file doesn&#039;t help too...</p><p>Could you create a simple db file for me (one, that works on your system), for testing?<br />User test, password test, home = /tmp</p><p>What platform is your pure-ftpd running?<br />Mine is WGT634U with buildroot-ng R4927 2.6 kernel<br />Or does it require any other packages than libelf?</p><p>Martin</p></blockquote></div><p>Here is what I do :<br />Please note that my passwd and group file looks like this :<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# more /etc/passwd
root:ROOTPASSWORDHASH:0:0:root:/tmp:/bin/ash
nobody:*:65534:65534:nobody:/var:/bin/false
sshd:x:99:99:sshd:/var/empty/.sshd:/bin/false

root@OpenWrt:~# more /etc/group
root:x:0:
nogroup:x:65534:
sshd:x:99:</code></pre></div><p>So I make your test user with uid and gid 65534</p><div class="codebox"><pre><code>root@OpenWrt:~# rm test.pwfile
root@OpenWrt:~# pure-pw useradd test -f test.pwfile -u 65534 -g 65534 -d /tmp
Password: (test)
Enter it again: (test)
root@OpenWrt:~# more test.pwfile
test:$1$MhIDLrf0$2n26DEDQbaWTTQo.bLcZz0:65534:65534::/tmp/./::::::::::::
root@OpenWrt:~# pure-pw mkdb test.db -f test.pwfile
root@OpenWrt:~#</code></pre></div><p>you can grab the files at <a href="http://aorlinsk2.free.fr/openwrt/">http://aorlinsk2.free.fr/openwrt/</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p35362">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">MMCM</div>
					<div class="post-datetime">
						13 Oct 2006, 14:27					</div>
				</div>
				<div class="post-content content">
					<p>Anael, thanks a lot for your support!</p><p>I downloaded your file into my /etc/pure-ftpd directory and changed the command line of pure-ftpd to your test.db file.<br />But: still the same error.</p><p>Then I wanted to test if pure-ftpd worked with another authtype and enabled -lunix (/etc/passwd) before -lpuredb:<br />After doing that, I could login with the accounts in /etc/passwd AND puredb authentication suddenly worked too!<br />When I remove -lunix from the command line, puredb authentication returns the same error as before.</p><p>Additionally, regardless of which account I login with, I can&#039;t any see files on the ftp server, but I can CD to any directory within the account&#039;s root.<br />When I try to UPLOAD a file (with windows ftp or WS_FTP Pro) I get &quot;553 I can only retrieve regular files&quot;.<br />The file size on the ftp server is 0 bytes after that, with the correct owner.<br />After that, I can see exactly the uploaded 0 byte files from the ftp client, WS_FTP Pro reports it&#039;s type as &quot;link&quot;!<br />Existing files with the same owner and/or permissions are not displayed.<br />Deleting those 0 byte files from the ftp client works.</p><p>Strange, isn&#039;t it?</p><p>Remark: pure-ftpd on my opensuse 10.1 works as exected, and never displayed such errand behavior.</p><p>Do you use this package on white russian, kamikaze or buildroot-ng?<br />Maybe this could be the cause of those problems?</p><p>best regards<br />Martin</p>											<p class="post-edited">(Last edited by <strong>MMCM</strong> on 13 Oct 2006, 14:28)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p35363">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">aorlinsk</div>
					<div class="post-datetime">
						13 Oct 2006, 15:22					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>MMCM wrote:</cite><blockquote><p>Anael, thanks a lot for your support!</p><p>I downloaded your file into my /etc/pure-ftpd directory and changed the command line of pure-ftpd to your test.db file.<br />But: still the same error.</p><p>Then I wanted to test if pure-ftpd worked with another authtype and enabled -lunix (/etc/passwd) before -lpuredb:<br />After doing that, I could login with the accounts in /etc/passwd AND puredb authentication suddenly worked too!<br />When I remove -lunix from the command line, puredb authentication returns the same error as before.</p><p>Additionally, regardless of which account I login with, I can&#039;t any see files on the ftp server, but I can CD to any directory within the account&#039;s root.<br />When I try to UPLOAD a file (with windows ftp or WS_FTP Pro) I get &quot;553 I can only retrieve regular files&quot;.<br />The file size on the ftp server is 0 bytes after that, with the correct owner.<br />After that, I can see exactly the uploaded 0 byte files from the ftp client, WS_FTP Pro reports it&#039;s type as &quot;link&quot;!<br />Existing files with the same owner and/or permissions are not displayed.<br />Deleting those 0 byte files from the ftp client works.</p><p>Strange, isn&#039;t it?</p><p>Remark: pure-ftpd on my opensuse 10.1 works as exected, and never displayed such errand behavior.</p><p>Do you use this package on white russian, kamikaze or buildroot-ng?<br />Maybe this could be the cause of those problems?</p><p>best regards<br />Martin</p></blockquote></div><p>I use this package with whiterussian post-RC5 (a snapshot from about 1 month ago). I have put the source of the package on the website too (for whiterussian buildroot though). Maybe you can try to build it with the buildroot-ng by tweaking the makefile into the new format.</p><p>I don&#039;t know if you tried adding the nobody and nogroup in the /etc/passwd and /etc/group ? Maybe this could help also.</p><p>At least maybe my configure patch is a bit dirty (cross-compiling does not work else), this may explain some strange behaviour...</p><p>On my side everything works flawlessly, I own a WRTSL54GS and my ftp server maps to a 2gb usb key without problems.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p35377">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">MMCM</div>
					<div class="post-datetime">
						13 Oct 2006, 23:24					</div>
				</div>
				<div class="post-content content">
					<p>Anael, I followed your advice, and built my own package for buildroot-ng.<br />Although this I my first package ever, with your configure patch and the instructions on <a href="http://forum.openwrt.org/viewtopic.php?pid=31794">http://forum.openwrt.org/viewtopic.php?pid=31794</a> it was not that difficult to make it.<br />The Makefile for buildroot-ng looks a lot simpler than yours ;-)</p><p>And the result: My first tests showed no problems at all :-)</p><p>I will do further tests in the next days, and if everything is OK, I will post it so it can be included in the buildroot-ng tree.</p><p>Again, many thanks for your support.</p><p>Martin</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>