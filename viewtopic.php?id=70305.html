<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Huawei - can&#039;t connect after a while without hard reset</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 14 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p354710">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">yurtesen</div>
					<div class="post-datetime">
						21 Mar 2017, 09:56					</div>
				</div>
				<div class="post-content content">
					<p>I am using a huawei&nbsp; E3372 (megafon 4g+) stick in ncm/qmi mode. It works really great. But once in a while it stops working.</p><p>It sometimes loses connection and does not reconnect. I remedied the issue with the script at bottom of the wiki page <a href="https://wiki.openwrt.org/doc/recipes/ltedongle?s">https://wiki.openwrt.org/doc/recipes/ltedongle?s</a>[]=ncm&amp;s[]=network</p><p>But once in a while it gets locked completely. Even rebooting OpenWRT does not solve the issue. I have to go and physically remove and re-insert the device (btw do you know a way to simulate this remotely?)</p><p>The thing which bothers me is the &quot;input wrong password many times&quot; message. What in OpenWRT may be causing this? But this is not related to connectivity problem because I see it from the first moment I reboot the device.</p><p>Any ideas on what to look for or try when this happens again? Is there a way to reset the usb stick remotely? (tried at+cfun=1,0 and did not do anything but gave OK response).</p><p>After hard reset /dev/ttyUSB1 prints (I don&#039;t understand the RSSI change between failure condition and after removing putting back stick in same exact position)</p><div class="codebox"><pre><code>^RSSI:28
^HCSQ:&quot;LTE&quot;,64,55,166,22
^RSSI:27
^HCSQ:&quot;LTE&quot;,62,57,181,28</code></pre></div><br /><p>When it locks below are what I see in the logs: (I am not sure if these appear from time to time under normal operation also)</p><div class="codebox"><pre><code>Tue Mar 21 09:40:38 2017 kern.err kernel: [207642.735919] huawei_cdc_ncm 1-1.3.1:1.2 wwan0: kevent 12 may have been dropped
Tue Mar 21 09:40:38 2017 kern.err kernel: [207642.743970] huawei_cdc_ncm 1-1.3.1:1.2 wwan0: kevent 12 may have been dropped
Tue Mar 21 09:40:38 2017 kern.err kernel: [207642.751746] huawei_cdc_ncm 1-1.3.1:1.2 wwan0: kevent 12 may have been dropped
Tue Mar 21 09:40:38 2017 kern.err kernel: [207642.759564] huawei_cdc_ncm 1-1.3.1:1.2 wwan0: kevent 12 may have been dropped</code></pre></div><p>I use miniocom to check the operation of the modem:<br /></p><div class="codebox"><pre><code>/dev/ttyUSB0 - Normal, responding to AT commands
/dev/ttyUSB1 - Normal, responding to AT + periodically prints:
...
^RSSI:17
^HCSQ:&quot;LTE&quot;,43,50,156,30
^RSSI:15
^HCSQ:&quot;LTE&quot;,39,46,156,30
^RSSI:17
^HCSQ:&quot;LTE&quot;,42,48,161,30
^PLMNSELEINFO:0,4
^RSSI:99
^PLMNSELEINFO:1,1
^RSSI:99
^RSSI:16
^HCSQ:&quot;LTE&quot;,41,45,151,24
^RSSI:17
^HCSQ:&quot;LTE&quot;,42,48,161,28
^RSSI:19
^HCSQ:&quot;LTE&quot;,47,49,156,20
...
/dev/ttyUSB2 - Periodically prints
[084759596ms] U_ACM:(U_ERROR)acm_setup():acm ttyGS0 req21.22 v0003 i0003 l0
[084759608ms] U_ACM:(U_ERROR)acm_setup():acm ttyGS0 req21.22 v0003 i0003 l0

Input wrong password many times, please reboot device
[084772889ms] U_ACM:(U_ERROR)acm_setup():acm ttyGS0 req21.22 v0003 i0001 l0
[084773383ms] U_NCM:(U_TRACE)ncm_vendor_notify():ncm_vendor_notify cmd=0
[084773390ms] U_NCM:(U_TRACE)ncm_vendor_notify():notify is busy, sending connect notify in work
[084773399ms] U_ACM:(U_ERROR)acm_setup():acm ttyGS0 req21.22 v0000 i0001 l0
[084773406ms] U_NCM:(U_TRACE)ncm_notify_work():send notify 1 in work
[084776415ms] U_ACM:(U_ERROR)acm_setup():acm ttyGS0 req21.22 v0003 i0001 l0
[084776422ms] U_ACM:(U_ERROR)acm_setup():acm ttyGS0 req21.22 v0000 i0001 l0</code></pre></div>											<p class="post-edited">(Last edited by <strong>yurtesen</strong> on 21 Mar 2017, 10:01)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>