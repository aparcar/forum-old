<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Issues with WR-941ND</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 12 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p331807">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">senbyrs</div>
					<div class="post-datetime">
						16 Jul 2016, 08:29					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I&#039;ll start by saying that I&#039;m completely new to OpenWRT with very little experience in CLIs.</p><p>Yesterday I tried to get OpenWRT working on my TP-Link WR-941ND. Mine is a V5.0, so I used the file here: <a href="http://downloads.openwrt.org/snapshots/trunk/ar71xx/generic/openwrt-ar71xx-generic-tl-wr941nd-v5-squashfs-factory.bin">http://downloads.openwrt.org/snapshots/ â€¦ actory.bin</a>. After flashing I got stuck; I couldn&#039;t telnet/SSH into the router. </p><p>Today I tried setting up a static IP on the computer accessing the router and tried SSH. I finally gained access and hurriedly tried to install luci. This is what I got: </p><div class="codebox"><pre><code>root@OpenWrt:~# opkg install luci
Installing luci (git-16.190.47901-6be6904-1) to root...
Downloading http://downloads.openwrt.org/snapshots/trunk/ar71xx/generic/packages/luci/luci_git-16.190.47901-6be6904-1_all.ipk.
Installing uhttpd (2015-11-08-fe01ef3f52adae9da38ef47926cd50974af5d6b7) to root...
Downloading http://downloads.openwrt.org/snapshots/trunk/ar71xx/generic/packages/base/uhttpd_2015-11-08-fe01ef3f52adae9da38ef47926cd50974af5d6b7_ar71xx.ipk.
Installing uhttpd-mod-ubus (2015-11-08-fe01ef3f52adae9da38ef47926cd50974af5d6b7) to root...
Downloading http://downloads.openwrt.org/snapshots/trunk/ar71xx/generic/packages/base/uhttpd-mod-ubus_2015-11-08-fe01ef3f52adae9da38ef47926cd50974af5d6b7_ar71xx.ipk.
Installing luci-mod-admin-full (git-16.190.47901-6be6904-1) to root...
Downloading http://downloads.openwrt.org/snapshots/trunk/ar71xx/generic/packages/luci/luci-mod-admin-full_git-16.190.47901-6be6904-1_ar71xx.ipk.
Installing luci-base (git-16.190.47901-6be6904-1) to root...
Downloading http://downloads.openwrt.org/snapshots/trunk/ar71xx/generic/packages/luci/luci-base_git-16.190.47901-6be6904-1_ar71xx.ipk.
Configuring luci-mod-admin-full.
Configuring uhttpd.
ln: /etc/rc.d/S50uhttpd: No space left on device
Configuring uhttpd-mod-ubus.
uci: I/O error
//usr/lib/opkg/info/uhttpd-mod-ubus.postinst: .: line 130: can&#039;t open &#039;./00_uhttpd_ubus&#039;
Collected errors:
 * wfopen: /usr/lib/lua/luci/view/cbi/simpleform.htm: No space left on device.
 * wfopen: /usr/lib/lua/luci/view/cbi/tabcontainer.htm: No space left on device.
 * wfopen: /usr/lib/lua/luci/view/cbi/tabmenu.htm: No space left on device.
 * wfopen: /usr/lib/lua/luci/view/cbi/tblsection.htm: No space left on device.
 * wfopen: /usr/lib/lua/luci/view/cbi/tsection.htm: No space left on device.
 * wfopen: /usr/lib/lua/luci/view/cbi/tvalue.htm: No space left on device.
 * wfopen: /usr/lib/lua/luci/view/cbi/ucisection.htm: No space left on device.
 * wfopen: /usr/lib/lua/luci/view/cbi/upload.htm: No space left on device.
 * wfopen: /usr/lib/lua/luci/view/cbi/value.htm: No space left on device.
 * wfopen: /usr/lib/lua/luci/view/cbi/valuefooter.htm: No space left on device.
 * wfopen: /usr/lib/lua/luci/view/cbi/valueheader.htm: No space left on device.
 * wfopen: /usr/lib/lua/luci/view/csrftoken.htm: No space left on device.
 * wfopen: /usr/lib/lua/luci/view/error404.htm: No space left on device.
 * wfopen: /usr/lib/lua/luci/view/error500.htm: No space left on device.
 * wfopen: /usr/lib/lua/luci/view/footer.htm: No space left on device.
 * wfopen: /usr/lib/lua/luci/view/header.htm: No space left on device.
 * wfopen: /usr/lib/lua/luci/view/indexer.htm: No space left on device.
 * wfopen: /usr/lib/lua/luci/view/sysauth.htm: No space left on device.
 * extract_archive: Cannot make dir /usr/share/acl.d/: No space left on device.
 * wfopen: /usr/share/acl.d/luci-base.json: No such file or directory.
 * extract_archive: Cannot make dir /www/cgi-bin/: No space left on device.
 * wfopen: /www/cgi-bin/luci: No such file or directory.
 * wfopen: /www/index.html: No space left on device.
 * extract_archive: Cannot make dir /www/luci-static/resources/cbi/: No space left on device.
 * wfopen: /www/luci-static/resources/cbi/add.gif: No such file or directory.
 * wfopen: /www/luci-static/resources/cbi/apply.gif: No such file or directory.
 * wfopen: /www/luci-static/resources/cbi/arrow.gif: No such file or directory.
 * wfopen: /www/luci-static/resources/cbi/down.gif: No such file or directory.
 * wfopen: /www/luci-static/resources/cbi/download.gif: No such file or directory.
 * wfopen: /www/luci-static/resources/cbi/edit.gif: No such file or directory.
 * wfopen: /www/luci-static/resources/cbi/fieldadd.gif: No such file or directory.
 * wfopen: /www/luci-static/resources/cbi/file.gif: No such file or directory.
 * wfopen: /www/luci-static/resources/cbi/find.gif: No such file or directory.
 * wfopen: /www/luci-static/resources/cbi/folder.gif: No such file or directory.
 * wfopen: /www/luci-static/resources/cbi/help.gif: No such file or directory.
 * wfopen: /www/luci-static/resources/cbi/key.gif: No such file or directory.
 * wfopen: /www/luci-static/resources/cbi/link.gif: No such file or directory.
 * wfopen: /www/luci-static/resources/cbi/reload.gif: No such file or directory.
 * wfopen: /www/luci-static/resources/cbi/remove.gif: No such file or directory.
 * wfopen: /www/luci-static/resources/cbi/reset.gif: No such file or directory.
 * wfopen: /www/luci-static/resources/cbi/save.gif: No such file or directory.
 * wfopen: /www/luci-static/resources/cbi/up.gif: No such file or directory.
 * wfopen: /www/luci-static/resources/cbi/user.gif: No such file or directory.
 * wfopen: /www/luci-static/resources/cbi.js: No space left on device.
 * extract_archive: Cannot make dir /www/luci-static/resources/icons/: No space left on device.
 * wfopen: /www/luci-static/resources/icons/bridge.png: No such file or directory.
 * wfopen: /www/luci-static/resources/icons/bridge_disabled.png: No such file or directory.
 * wfopen: /www/luci-static/resources/icons/encryption.png: No such file or directory.
 * wfopen: /www/luci-static/resources/icons/encryption_disabled.png: No such file or directory.
 * wfopen: /www/luci-static/resources/icons/ethernet.png: No such file or directory.
 * wfopen: /www/luci-static/resources/icons/ethernet_disabled.png: No such file or directory.
 * wfopen: /www/luci-static/resources/icons/loading.gif: No such file or directory.
 * wfopen: /www/luci-static/resources/icons/port_down.png: No such file or directory.
 * wfopen: /www/luci-static/resources/icons/port_up.png: No such file or directory.
 * wfopen: /www/luci-static/resources/icons/signal-0-25.png: No such file or directory.
 * wfopen: /www/luci-static/resources/icons/signal-0.png: No such file or directory.
 * wfopen: /www/luci-static/resources/icons/signal-25-50.png: No such file or directory.
 * wfopen: /www/luci-static/resources/icons/signal-50-75.png: No such file or directory.
 * wfopen: /www/luci-static/resources/icons/signal-75-100.png: No such file or directory.
 * wfopen: /www/luci-static/resources/icons/signal-none.png: No such file or directory.
 * wfopen: /www/luci-static/resources/icons/switch.png: No such file or directory.
 * wfopen: /www/luci-static/resources/icons/switch_disabled.png: No such file or directory.
 * wfopen: /www/luci-static/resources/icons/tunnel.png: No such file or directory.
 * wfopen: /www/luci-static/resources/icons/tunnel_disabled.png: No such file or directory.
 * wfopen: /www/luci-static/resources/icons/vlan.png: No such file or directory.
 * wfopen: /www/luci-static/resources/icons/vlan_disabled.png: No such file or directory.
 * wfopen: /www/luci-static/resources/icons/wifi.png: No such file or directory.
 * wfopen: /www/luci-static/resources/icons/wifi_big.png: No such file or directory.
 * wfopen: /www/luci-static/resources/icons/wifi_big_disabled.png: No such file or directory.
 * wfopen: /www/luci-static/resources/icons/wifi_disabled.png: No such file or directory.
 * wfopen: /www/luci-static/resources/xhr.js: No space left on device.
 * pkg_write_filelist: Failed to open //usr/lib/opkg/info/luci-base.list: No space left on device.
 * opkg_install_pkg: Failed to extract data files for luci-base. Package debris may remain!
 * opkg_install_cmd: Cannot install package luci.</code></pre></div><p>-df h gives me this: </p><div class="codebox"><pre><code>root@OpenWrt:~# df -h
Filesystem                Size      Used Available Use% Mounted on
/dev/root                 2.0M      2.0M         0 100% /rom
tmpfs                    13.6M    616.0K     13.0M   4% /tmp
tmpfs                    13.6M     32.0K     13.6M   0% /tmp/root
tmpfs                   512.0K         0    512.0K   0% /dev
/dev/mtdblock3          576.0K    516.0K     60.0K  90% /overlay
overlayfs:/overlay      576.0K    516.0K     60.0K  90% /</code></pre></div><p>I tried erasing overlayfs without much luck, and at this point I&#039;m about to give up and just settle on the manufacture-provided firmware. I intended to use this page on OpenWRT: <a href="https://wiki.openwrt.org/toh/tp-link/tl-wr941nd">https://wiki.openwrt.org/toh/tp-link/tl-wr941nd</a>.<br /></p><div class="codebox"><pre><code>Revert to original firmware

Warning!
This section describes actions that might damage your device or firmware. Proceed with care!
You can download the original firmware from the TP-LINK support section and flash it without modification.

Only perform the dd action below if your original firmware has the word &quot;boot&quot; in it, for example, &quot;wr941nv4_en_3_9_17_up_boot(091118).bin&quot;. DO NOT dd your original firmware if it has no &quot;boot&quot; in its name, for example, &quot;wr941nv4_en_3_11_5_up(100427).bin&quot;, because if you do, you will brick your router ! This was confirmed by supertom64 in wr1043nd.
Cut first 0x20200 bytes from original firmware containing boot in the filename:
dd if=orig.bin of=tplink_boot.bin skip=257 bs=512
Flash via uboot or mtd, you cannot flash via WebGUI otherwise you will turn your router into brick.

First you need to get the firmware file onto your box. If you are able to connect to your OpenWrt console and you have your network configured properly, you can use wget or scp to copy the firmware binary into the /tmp folder.

To start flashing via mtd you have to call (wr.bin is the file containing the firmware you previously downloaded):

root@OpenWrt:/tmp# mtd -r write wr.bin firmware
Unlocking firmware ...

Writing from wr.bin to firmware ...
Rebooting ...
Terminated</code></pre></div><p>I&#039;m unsure as to how to do this at all, and I have a few questions.<br />1. The update file indeed includes the word <em>boot</em>, so does this mean I need to do that step? How do I go about doing so?<br />2. How do I get the firmware into the router? I am clueless on how to do this. <br />3. Once I do get the firmware on the router, is it just a matter of copy-pasting the command mentioned?</p><p>Thanks in advance!</p>											<p class="post-edited">(Last edited by <strong>senbyrs</strong> on 16 Jul 2016, 08:31)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p331822">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Max Hopper</div>
					<div class="post-datetime">
						16 Jul 2016, 12:25					</div>
				</div>
				<div class="post-content content">
					<p>1. The update file indeed includes the word boot, so does this mean I need to do that step? Yes.<br />1.a&nbsp; How do I go about doing so? Use your reading skills to find the instructions in the wiki post. <strong>HINT</strong>: <em>dd</em><br />N.B. - use <em>wr.bin</em> as the value of <em>of</em><br />2. How do I get the firmware into the router? I am clueless on how to do this. Use your reading skills to find the instructions in the wiki post. <strong>HINT</strong>: <em>wget</em><br />3. Once I do get the firmware on the router, is it just a matter of copy-pasting the command mentioned? Yes.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p331946">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">hojuruku</div>
					<div class="post-datetime">
						17 Jul 2016, 15:11					</div>
				</div>
				<div class="post-content content">
					<p>luci isn&#039;t going to fit, unless you try to build your own version with all the tricks, 512/1024k squashfs blocksize, mips16 ase. I had the same model, only a v3 and compile your own version. Squashfs with larger blocksize will squash more than 64k blocksize jffs2.</p><p>You got 8mb flash or 4? <br />Checked, yep 4.<br />Learn how to use the buildroot my friend.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p331949">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Max Hopper</div>
					<div class="post-datetime">
						17 Jul 2016, 15:43					</div>
				</div>
				<div class="post-content content">
					<p>Good advice. <a href="https://wiki.openwrt.org/doc/howto/obtain.firmware.generate">Better advice</a>. But the OPer is wishes to revert to TP-Link firmware.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>