<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> 5MHz channel width with ath5k works</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 25 Feb 2017.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p122834">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">yapoo</div>
					<div class="post-datetime">
						8 Dec 2010, 09:57					</div>
				</div>
				<div class="post-content content">
					<p>Hi.</p><p>I&#039;ve just tried 5MHz channel width with ath5k. It works.<br/>My environment is,</p><p>Latest trunk<br/>Gateworks avila GW2348-4<br/>ar5413 miniPCI</p><p>If you also try it (with self-responsibility), save this patch in ~/your/trunk/path/package/mac80211/patches and build it. </p><p>910-5mhz.patch<br/></p><div class="codebox"><pre><code>diff --git a/drivers/net/wireless/ath/ath5k/reset.c b/drivers/net/wireless/ath/ath5k/reset.c
index 7d8ef8d..a4fe0a0 100644
--- a/drivers/net/wireless/ath/ath5k/reset.c
+++ b/drivers/net/wireless/ath/ath5k/reset.c
@@ -950,6 +950,8 @@ int ath5k_hw_reset(struct ath5k_hw *ah, enum nl80211_iftype op_mode,
        freq = 0;
        mode = 0;

+       if (ah-&gt;ah_bwmode != AR5K_BWMODE_5MHZ)
+               ah-&gt;ah_bwmode = AR5K_BWMODE_5MHZ;
        /*
         * Sanity check for fast flag
         * Fast channel change only available</code></pre></div><p>This patch isn&#039;t the right way maybe. Anyway, it works.<br/>Let&#039;s expect skilled devs post beautiful patch. :-)</p><p>BTW, though I didn&#039;t try 10MHz and 40MHz width, it should work to change &quot;AR5K_BWMODE_5MHZ&quot; to &quot;AR5K_BWMODE_10MHZ&quot; or &quot;AR5K_BWMODE_40MHZ&quot;.</p><p>Good luck!</p><p>zukky</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p122836">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">yapoo</div>
					<div class="post-datetime">
						8 Dec 2010, 10:08					</div>
				</div>
				<div class="post-content content">
					<p>I forgot. mode is AP</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p122841">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">yapoo</div>
					<div class="post-datetime">
						8 Dec 2010, 10:59					</div>
				</div>
				<div class="post-content content">
					<p>I tried 10MHz and 40MHz width in addition.<br/>10MHz width is OK. Unfortunately 40MHz width shows only 20MHz on my spectram analyzer. It&#039;ll need some more modification.</p><p>bye</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p131840">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">lgentili</div>
					<div class="post-datetime">
						29 Mar 2011, 07:46					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m really interested to use my board in 5MHz (MiniPci AR5414A).</p><p>I&#039;ve tried to do your Hard-coded settings. but unfortunately, when I looked at the code, the reset.c file is different.</p><p>The latest backfire source code, is using the Linux kernel 2.6.32 and the ./drivers/net/wireless/ath/ath5k/reset.c is older and doesn&#039;t implement the half/quarter support.</p><p>I suspect that you have built only the ath5k from trunk. If that&#039;s the case, Please, could you make me the favor to post the steps to do it?</p><p>Thanks,</p><p>Leandro</p>											<p class="post-edited">(Last edited by <strong>lgentili</strong> on 29 Mar 2011, 07:47)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>