<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Cannot set more than 15 dBm Tx power on Bufallo WZR-HP-AG300H</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 27 Mar 2018 and 2 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=45260&amp;p=2.html">2</a></li></ul></nav></div>
			
		
		
			<article class="post" id="p207141">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">mastabog</div>
					<div class="post-datetime">
						14 Jul 2013, 23:46					</div>
				</div>
				<div class="post-content content">
					<p>I tried 12.09-rc1, 12.09-rc2 and the latest trunk from today. The Tx does not get set to more than 15 dBm regardless of any higher value. It does get set to lower values though just fine. I confirmed this also with a listening wifi device. I can see the received signal strength going down when setting something lower than 15 dBm, but doesn&#039;t go any higher than the RSSI level that was at 15 dBm when setting 20, 27 or 30 dBm.</p><p>Is this device capped in some way? the &quot;HP&quot; is supposed to mean High Power ... is the reported 15 dBm erroneous and it&#039;s actually higher?</p><p>On the 5 GHz channels, it goes up to 17 dBm while on the 2.4 channels, only up to 15 dBm ... both being below the maximum that it&#039;s supposed to go.</p><p>Setting 0 dBm results oin 3 dBm being actually set:</p><div class="codebox"><pre><code>root@OpenWrt:~# iw dev wlan0 set txpower fixed 0

root@OpenWrt:~# iwinfo wlan0 info
wlan0     ESSID: &quot;DELETED&quot;
          Access Point: 4C:E6:76:C2:5D:CC
          Mode: Master  Channel: 13 (2.472 GHz)
          Tx-Power: 3 dBm  Link Quality: 70/70
          Signal: -35 dBm  Noise: -94 dBm
          Bit Rate: 58.5 MBit/s
          Encryption: WPA2 PSK (TKIP, CCMP)
          Type: nl80211  HW Mode(s): 802.11bgn
          Hardware: 168C:0029 168C:A097 [Generic MAC80211]
          TX power offset: unknown
          Frequency offset: unknown
          Supports VAPs: yes</code></pre></div><p>Setting 20 dBm or anything higher results in 15 dBm being set:</p><div class="codebox"><pre><code>root@OpenWrt:~# iw dev wlan0 set txpower fixed 2000

root@OpenWrt:~# iwinfo wlan0 info
wlan0     ESSID: &quot;DELETED&quot;
          Access Point: 4C:E6:76:C2:5D:CC
          Mode: Master  Channel: 13 (2.472 GHz)
          Tx-Power: 15 dBm  Link Quality: 70/70
          Signal: -35 dBm  Noise: -93 dBm
          Bit Rate: 58.5 MBit/s
          Encryption: WPA2 PSK (TKIP, CCMP)
          Type: nl80211  HW Mode(s): 802.11bgn
          Hardware: 168C:0029 168C:A097 [Generic MAC80211]
          TX power offset: unknown
          Frequency offset: unknown
          Supports VAPs: yes</code></pre></div><p>I also tried <a href="http://luci.subsignal.org/~jow/reghack/">jow&#039;s hack</a> for allowing channel 12 and 13, and Tx powers up to 30 dBm for US reg. I tried various channels, including 12 and 13, and still the same problem.</p><p>This is the output of &quot;iw list&quot; -- with jow&#039;s hack applied, on 12.09-rc2:</p><div class="codebox"><pre><code>root@OpenWrt:~# iw list
Wiphy phy1
        Band 1:
                Capabilities: 0x11ce
                        HT20/HT40
                        SM Power Save disabled
                        RX HT40 SGI
                        TX STBC
                        RX STBC 1-stream
                        Max AMSDU length: 3839 bytes
                        DSSS/CCK HT40
                Maximum RX AMPDU length 65535 bytes (exponent: 0x003)
                Minimum RX AMPDU time spacing: 8 usec (0x06)
                HT TX/RX MCS rate indexes supported: 0-15
                Frequencies:
                        * 5180 MHz [36] (30.0 dBm)
                        * 5200 MHz [40] (30.0 dBm)
                        * 5220 MHz [44] (30.0 dBm)
                        * 5240 MHz [48] (30.0 dBm)
                        * 5260 MHz [52] (30.0 dBm)
                        * 5280 MHz [56] (30.0 dBm)
                        * 5300 MHz [60] (30.0 dBm)
                        * 5320 MHz [64] (30.0 dBm)
                        * 5500 MHz [100] (30.0 dBm)
                        * 5520 MHz [104] (30.0 dBm)
                        * 5540 MHz [108] (30.0 dBm)
                        * 5560 MHz [112] (30.0 dBm)
                        * 5580 MHz [116] (30.0 dBm)
                        * 5600 MHz [120] (30.0 dBm)
                        * 5620 MHz [124] (30.0 dBm)
                        * 5640 MHz [128] (30.0 dBm)
                        * 5660 MHz [132] (30.0 dBm)
                        * 5680 MHz [136] (30.0 dBm)
                        * 5700 MHz [140] (30.0 dBm)
                        * 5745 MHz [149] (30.0 dBm)
                        * 5765 MHz [153] (30.0 dBm)
                        * 5785 MHz [157] (30.0 dBm)
                        * 5805 MHz [161] (30.0 dBm)
                        * 5825 MHz [165] (30.0 dBm)
                Bitrates (non-HT):
                        * 6.0 Mbps
                        * 9.0 Mbps
                        * 12.0 Mbps
                        * 18.0 Mbps
                        * 24.0 Mbps
                        * 36.0 Mbps
                        * 48.0 Mbps
                        * 54.0 Mbps
        max # scan SSIDs: 4
        max scan IEs length: 2261 bytes
        Coverage class: 0 (up to 0m)
        Supported Ciphers:
                * WEP40 (00-0f-ac:1)
                * WEP104 (00-0f-ac:5)
                * TKIP (00-0f-ac:2)
                * CCMP (00-0f-ac:4)
                * CMAC (00-0f-ac:6)
        Available Antennas: TX 0x3 RX 0x3
        Configured Antennas: TX 0x3 RX 0x3
        Supported interface modes:
                 * IBSS
                 * managed
                 * AP
                 * AP/VLAN
                 * WDS
                 * monitor
                 * mesh point
                 * P2P-client
                 * P2P-GO
        software interface modes (can always be added):
                 * AP/VLAN
                 * monitor
        valid interface combinations:
                 * #{ managed, WDS, P2P-client } &lt;= 2048, #{ IBSS, AP, mesh point, P2P-GO } &lt;= 8,
                   total &lt;= 2048, #channels &lt;= 1
        Supported commands:
                 * new_interface
                 * set_interface
                 * new_key
                 * start_ap
                 * new_station
                 * new_mpath
                 * set_mesh_config
                 * set_bss
                 * authenticate
                 * associate
                 * deauthenticate
                 * disassociate
                 * join_ibss
                 * join_mesh
                 * remain_on_channel
                 * set_tx_bitrate_mask
                 * frame
                 * frame_wait_cancel
                 * set_wiphy_netns
                 * set_channel
                 * set_wds_peer
                 * tdls_mgmt
                 * tdls_oper
                 * probe_client
                 * set_noack_map
                 * register_beacons
                 * Unknown command (89)
                 * connect
                 * disconnect
        Supported TX frame types:
                 * IBSS: 0x00 0x10 0x20 0x30 0x40 0x50 0x60 0x70 0x80 0x90 0xa0 0xb0 0xc0 0xd0 0xe0 0xf0
                 * managed: 0x00 0x10 0x20 0x30 0x40 0x50 0x60 0x70 0x80 0x90 0xa0 0xb0 0xc0 0xd0 0xe0 0xf0
                 * AP: 0x00 0x10 0x20 0x30 0x40 0x50 0x60 0x70 0x80 0x90 0xa0 0xb0 0xc0 0xd0 0xe0 0xf0
                 * AP/VLAN: 0x00 0x10 0x20 0x30 0x40 0x50 0x60 0x70 0x80 0x90 0xa0 0xb0 0xc0 0xd0 0xe0 0xf0
                 * mesh point: 0x00 0x10 0x20 0x30 0x40 0x50 0x60 0x70 0x80 0x90 0xa0 0xb0 0xc0 0xd0 0xe0 0xf0
                 * P2P-client: 0x00 0x10 0x20 0x30 0x40 0x50 0x60 0x70 0x80 0x90 0xa0 0xb0 0xc0 0xd0 0xe0 0xf0
                 * P2P-GO: 0x00 0x10 0x20 0x30 0x40 0x50 0x60 0x70 0x80 0x90 0xa0 0xb0 0xc0 0xd0 0xe0 0xf0
                 * (null): 0x00 0x10 0x20 0x30 0x40 0x50 0x60 0x70 0x80 0x90 0xa0 0xb0 0xc0 0xd0 0xe0 0xf0
        Supported RX frame types:
                 * IBSS: 0xb0 0xc0 0xd0
                 * managed: 0x40 0xd0
                 * AP: 0x00 0x20 0x40 0xa0 0xb0 0xc0 0xd0
                 * AP/VLAN: 0x00 0x20 0x40 0xa0 0xb0 0xc0 0xd0
                 * mesh point: 0xb0 0xc0 0xd0
                 * P2P-client: 0x40 0xd0
                 * P2P-GO: 0x00 0x20 0x40 0xa0 0xb0 0xc0 0xd0
                 * (null): 0x40 0xd0
        Device supports RSN-IBSS.
        HT Capability overrides:
                 * MCS: ff ff ff ff ff ff ff ff ff ff
                 * maximum A-MSDU length
                 * supported channel width
                 * short GI for 40 MHz
                 * max A-MPDU length exponent
                 * min MPDU start spacing
        Device supports TX status socket option.
        Device supports HT-IBSS.
Wiphy phy0
        Band 1:
                Capabilities: 0x11ce
                        HT20/HT40
                        SM Power Save disabled
                        RX HT40 SGI
                        TX STBC
                        RX STBC 1-stream
                        Max AMSDU length: 3839 bytes
                        DSSS/CCK HT40
                Maximum RX AMPDU length 65535 bytes (exponent: 0x003)
                Minimum RX AMPDU time spacing: 8 usec (0x06)
                HT TX/RX MCS rate indexes supported: 0-15
                Frequencies:
                        * 2412 MHz [1] (30.0 dBm)
                        * 2417 MHz [2] (30.0 dBm)
                        * 2422 MHz [3] (30.0 dBm)
                        * 2427 MHz [4] (30.0 dBm)
                        * 2432 MHz [5] (30.0 dBm)
                        * 2437 MHz [6] (30.0 dBm)
                        * 2442 MHz [7] (30.0 dBm)
                        * 2447 MHz [8] (30.0 dBm)
                        * 2452 MHz [9] (30.0 dBm)
                        * 2457 MHz [10] (30.0 dBm)
                        * 2462 MHz [11] (30.0 dBm)
                        * 2467 MHz [12] (30.0 dBm)
                        * 2472 MHz [13] (30.0 dBm)
                        * 2484 MHz [14] (disabled)
                Bitrates (non-HT):
                        * 1.0 Mbps
                        * 2.0 Mbps (short preamble supported)
                        * 5.5 Mbps (short preamble supported)
                        * 11.0 Mbps (short preamble supported)
                        * 6.0 Mbps
                        * 9.0 Mbps
                        * 12.0 Mbps
                        * 18.0 Mbps
                        * 24.0 Mbps
                        * 36.0 Mbps
                        * 48.0 Mbps
                        * 54.0 Mbps
        max # scan SSIDs: 4
        max scan IEs length: 2257 bytes
        RTS threshold: 16
        Coverage class: 0 (up to 0m)
        Supported Ciphers:
                * WEP40 (00-0f-ac:1)
                * WEP104 (00-0f-ac:5)
                * TKIP (00-0f-ac:2)
                * CCMP (00-0f-ac:4)
                * CMAC (00-0f-ac:6)
        Available Antennas: TX 0x3 RX 0x3
        Configured Antennas: TX 0x3 RX 0x3
        Supported interface modes:
                 * IBSS
                 * managed
                 * AP
                 * AP/VLAN
                 * WDS
                 * monitor
                 * mesh point
                 * P2P-client
                 * P2P-GO
        software interface modes (can always be added):
                 * AP/VLAN
                 * monitor
        valid interface combinations:
                 * #{ managed, WDS, P2P-client } &lt;= 2048, #{ IBSS, AP, mesh point, P2P-GO } &lt;= 8,
                   total &lt;= 2048, #channels &lt;= 1
        Supported commands:
                 * new_interface
                 * set_interface
                 * new_key
                 * start_ap
                 * new_station
                 * new_mpath
                 * set_mesh_config
                 * set_bss
                 * authenticate
                 * associate
                 * deauthenticate
                 * disassociate
                 * join_ibss
                 * join_mesh
                 * remain_on_channel
                 * set_tx_bitrate_mask
                 * frame
                 * frame_wait_cancel
                 * set_wiphy_netns
                 * set_channel
                 * set_wds_peer
                 * tdls_mgmt
                 * tdls_oper
                 * probe_client
                 * set_noack_map
                 * register_beacons
                 * Unknown command (89)
                 * connect
                 * disconnect
        Supported TX frame types:
                 * IBSS: 0x00 0x10 0x20 0x30 0x40 0x50 0x60 0x70 0x80 0x90 0xa0 0xb0 0xc0 0xd0 0xe0 0xf0
                 * managed: 0x00 0x10 0x20 0x30 0x40 0x50 0x60 0x70 0x80 0x90 0xa0 0xb0 0xc0 0xd0 0xe0 0xf0
                 * AP: 0x00 0x10 0x20 0x30 0x40 0x50 0x60 0x70 0x80 0x90 0xa0 0xb0 0xc0 0xd0 0xe0 0xf0
                 * AP/VLAN: 0x00 0x10 0x20 0x30 0x40 0x50 0x60 0x70 0x80 0x90 0xa0 0xb0 0xc0 0xd0 0xe0 0xf0
                 * mesh point: 0x00 0x10 0x20 0x30 0x40 0x50 0x60 0x70 0x80 0x90 0xa0 0xb0 0xc0 0xd0 0xe0 0xf0
                 * P2P-client: 0x00 0x10 0x20 0x30 0x40 0x50 0x60 0x70 0x80 0x90 0xa0 0xb0 0xc0 0xd0 0xe0 0xf0
                 * P2P-GO: 0x00 0x10 0x20 0x30 0x40 0x50 0x60 0x70 0x80 0x90 0xa0 0xb0 0xc0 0xd0 0xe0 0xf0
                 * (null): 0x00 0x10 0x20 0x30 0x40 0x50 0x60 0x70 0x80 0x90 0xa0 0xb0 0xc0 0xd0 0xe0 0xf0
        Supported RX frame types:
                 * IBSS: 0xb0 0xc0 0xd0
                 * managed: 0x40 0xd0
                 * AP: 0x00 0x20 0x40 0xa0 0xb0 0xc0 0xd0
                 * AP/VLAN: 0x00 0x20 0x40 0xa0 0xb0 0xc0 0xd0
                 * mesh point: 0xb0 0xc0 0xd0
                 * P2P-client: 0x40 0xd0
                 * P2P-GO: 0x00 0x20 0x40 0xa0 0xb0 0xc0 0xd0
                 * (null): 0x40 0xd0
        Device supports RSN-IBSS.
        HT Capability overrides:
                 * MCS: ff ff ff ff ff ff ff ff ff ff
                 * maximum A-MSDU length
                 * supported channel width
                 * short GI for 40 MHz
                 * max A-MPDU length exponent
                 * min MPDU start spacing
        Device supports TX status socket option.
        Device supports HT-IBSS.</code></pre></div><p>Any clues?</p>											<p class="post-edited">(Last edited by <strong>mastabog</strong> on 14 Jul 2013, 23:51)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p207152">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">todd_richmond</div>
					<div class="post-datetime">
						15 Jul 2013, 03:10					</div>
				</div>
				<div class="post-content content">
					<p>Try changing channels (very upper end of the range&nbsp; for 5GHz). That will give you some improvement, but I still couldn&#039;t get mine beyond 20db for 2.4Ghz even with a similar but different regulatory hack. I finally ended up moving to a netgear wndr4300 with dd-wrt that definitely has better range</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p207156">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">mastabog</div>
					<div class="post-datetime">
						15 Jul 2013, 04:58					</div>
				</div>
				<div class="post-content content">
					<p>Actually, I discovered after i posted here that this is a known issue ... <a href="https://dev.openwrt.org/ticket/10113">https://dev.openwrt.org/ticket/10113</a></p><p>Others in there are also stuck at 15 dBm. I&#039;m surprised you got it up to 20 dBm ... are you sure about that? i.e. did it make a difference setting 15 or 20?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p209271">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Cypher</div>
					<div class="post-datetime">
						8 Aug 2013, 16:55					</div>
				</div>
				<div class="post-content content">
					<p>Same here, stuck at 15dBm for some reason.</p><p>I also tried jows hack, but it gave me an error.<br /></p><div class="codebox"><pre><code>./reghack.mips.elf /lib/modules/*/ath.ko
./reghack.mips.elf /lib/modules/*/cfg80211.ko</code></pre></div><p>The first line gave an error saying that the file is maybe already patched. I ignored that and also applied the second line, which ran without an error. Unfortunately still no success after a full reboot, still stuck at 15dBm.</p><p>Was this 15dBm-thing always there? I remember at the beginning of AG300H support I had 20dBm but I&#039;m not too sure anymore if thats real or just wishful thinking. <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p209275">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">kurczaq</div>
					<div class="post-datetime">
						8 Aug 2013, 18:01					</div>
				</div>
				<div class="post-content content">
					<p>Set your country code to Bolivia &quot;BO&quot; on the interface. Then add to /etc/rc.local this line:</p><p>iw reg set d0</p><p>gave me 20 dbm &amp; 27dbm on both interfaces that I have.</p><div class="codebox"><pre><code>root@OpenWrt:/usr/src/packages# iwinfo 

wlan0     ESSID: &quot;XXX&quot;
          Access Point: 64:70:02:XX:XX:XX
          Mode: Master  Channel: 1 (2.412 GHz)
          Tx-Power: 27 dBm  Link Quality: unknown/70
          Signal: unknown  Noise: -95 dBm
          Bit Rate: unknown
          Encryption: WPA2 PSK (CCMP)
          Type: nl80211  HW Mode(s): 802.11bgn
          Hardware: unknown [Generic MAC80211]
          TX power offset: unknown
          Frequency offset: unknown
          Supports VAPs: yes  PHY name: phy0

wlan1     ESSID: &quot;XXX&quot;
          Access Point: D8:5D:4C:XX:XX:XX
          Mode: Master  Channel: 11 (2.462 GHz)
          Tx-Power: 20 dBm  Link Quality: 45/70
          Signal: -64 dBm  Noise: unknown
          Bit Rate: 7.2 MBit/s
          Encryption: WPA2 PSK (CCMP)
          Type: nl80211  HW Mode(s): 802.11bgn
          Hardware: unknown [Generic MAC80211]
          TX power offset: unknown
          Frequency offset: unknown
          Supports VAPs: yes  PHY name: phy1</code></pre></div>											<p class="post-edited">(Last edited by <strong>kurczaq</strong> on 8 Aug 2013, 18:02)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p209277">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">mastabog</div>
					<div class="post-datetime">
						8 Aug 2013, 18:21					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>kurczaq wrote:</cite><blockquote><p>Set your country code to Bolivia &quot;BO&quot; on the interface. Then add to /etc/rc.local this line:</p><p>iw reg set d0</p><p>gave me 20 dbm &amp; 27dbm on both interfaces that I have.</p></blockquote></div><p>That&#039;s interesting, I&#039;ll try it later. Did you check to see if it actually makes any difference in the RSSI of a receiving device? Sometimes APs report higher Tx power but the radio doesn&#039;t transmit at a higher power. If you&#039;re using Android, you can check this with the Wifi Analyzer app (free).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p209286">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">naturelle</div>
					<div class="post-datetime">
						8 Aug 2013, 22:10					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>kurczaq wrote:</cite><blockquote><p>Set your country code to Bolivia &quot;BO&quot; on the interface. Then add to /etc/rc.local this line:</p><p>iw reg set d0</p><p>gave me 20 dbm &amp; 27dbm on both interfaces that I have.</p></blockquote></div><p>Does not work:</p><p>~# iw reg set d0<br />not a valid ISO/IEC 3166-1 alpha2<br />Special non-alpha2 usable entries:<br />&nbsp; &nbsp; 00&nbsp; &nbsp; World Regulatory domain</p><p>[...]<br />Tx-Power: 15 dBm&nbsp; Link Quality: 53/70<br />[...]<br />Tx-Power: 17 dBm&nbsp; Link Quality: unknown/70</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p209292">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">naturelle</div>
					<div class="post-datetime">
						8 Aug 2013, 22:51					</div>
				</div>
				<div class="post-content content">
					<p>Are these error-message ignoreable?</p><div class="codebox"><pre><code>root@station:/tmp# ./reghack.mips.elf /lib/modules/*/ath.ko
mmap(): Invalid argument
Memory mapping failed (missing fs support?), retrying from tmpfs
Patching @ 0x000001c4: ath_is_radar_freq() MIPS opcode in ath/regd.o
Patching @ 0x00000278: ath_is_radar_freq() MIPS opcode in ath/regd.o
Patching @ 0x000025dc: ath world regdomain with 5 rules in ath/regd.o
Patching @ 0x00002664: ath world regdomain with 4 rules in ath/regd.o
Patching @ 0x000026d4: ath world regdomain with 4 rules in ath/regd.o
Patching @ 0x00002744: ath world regdomain with 5 rules in ath/regd.o
root@station:/tmp# ./reghack.mips.elf /lib/modules/*/cfg80211.ko
mmap(): Invalid argument
Memory mapping failed (missing fs support?), retrying from tmpfs
Patching @ 0x00021ad8: core world6 regdomain in cfg80211/reg.o
Patching @ 0x000225a8: embedded 00 regdomain in cfg80211/regdb.o
Patching @ 0x00025278: embedded US regdomain in cfg80211/regdb.o</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p209301">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">kurczaq</div>
					<div class="post-datetime">
						9 Aug 2013, 00:02					</div>
				</div>
				<div class="post-content content">
					<p>so try instead</p><p> iw reg set 00</p><p>(but put into the rc.d script)</p>											<p class="post-edited">(Last edited by <strong>kurczaq</strong> on 9 Aug 2013, 00:04)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p209309">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">naturelle</div>
					<div class="post-datetime">
						9 Aug 2013, 01:11					</div>
				</div>
				<div class="post-content content">
					<p>That seems to work.<br />At the moment I am using Countrycode GB. That gives me 20dBm on 2.4GHz (channel 11) and (only) 20dBm on 5GHz (channel 48). Why I can&#039;t get the allowed 23dBm?</p><p>And: how to put iw reg set 00 into rc.local?<br />With the &quot;&amp;&quot; at the end or without?</p><p>Edit:<br />with or without &quot;&amp;&quot; - it does not work when setting into rc.local. How to get workable?</p>											<p class="post-edited">(Last edited by <strong>naturelle</strong> on 9 Aug 2013, 01:21)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p209340">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">Cypher</div>
					<div class="post-datetime">
						9 Aug 2013, 13:45					</div>
				</div>
				<div class="post-content content">
					<p>naturelle:<br /></p><div class="codebox"><pre><code>uci set wireless.radio0.country=00
uci set wireless.radio1.country=00
uci commit</code></pre></div><p>This will modify /etc/config/wireless, so that the country code &quot;00&quot; will be used for 2.4GHz (radio0) and 5 GHz (radio1).</p><p>But it looks like your problem is a different one than mine, because the country code change doesnt do anything for me. Still stuck at 15dBm even with GB or 00 country code.<br />I&#039;m interested what happens when mastabog tries GB or 00, since he seems to have a similar problem to mine where every &quot;solution&quot; so far just doesnt work at all.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p209350">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">naturelle</div>
					<div class="post-datetime">
						9 Aug 2013, 15:10					</div>
				</div>
				<div class="post-content content">
					<p>No. That does not do what we want. Editing /etc/config/wireless is easy, therefore their&#039;s no uci-command needed. And: setting country=00 in wireless-file does not get the power we want.<br />At the moment I only get a (legal in my country(!)) power of 20dBm on 2.4GHz when doing these steps manually:<br /></p><div class="codebox"><pre><code>iw reg set 00
/etc/init.d/network restart</code></pre></div><p>with theses lines in /etc/config/wireless:<br /></p><div class="codebox"><pre><code>config &#039;wifi-device&#039; &#039;radio0&#039;
        option &#039;txpower&#039; &#039;20&#039;
        option &#039;country&#039; &#039;GB&#039;

config &#039;wifi-device&#039; &#039;radio1&#039;
        option &#039;txpower&#039; &#039;20&#039;
        option &#039;country&#039; &#039;GB&#039;</code></pre></div><p><strong>But</strong> I got only 17dBm on 5GHz, where 27dBm are allowed.</p><p>So these steps do not work properly, and the onyl work manually.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p209358">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">mastabog</div>
					<div class="post-datetime">
						9 Aug 2013, 16:36					</div>
				</div>
				<div class="post-content content">
					<p>&quot;iw reg set d0&quot; does not work, it&#039;s rejected with an error &quot;not a valid ISO/IEC 3166-1 alpha2&quot; Setting the country to GB and iw reg set 00 actually reports that 20 dBm has been set.</p><p>But like I said previously, the device is <strong>NOT</strong> transmitting at 20 dBm. It is still transmitting at 15 dBm. I tested this by monitoring the RSSI of a receiver sitting next to it.</p><p>The test was simple. I set the power to 0 dBm, then kept increasing it. I could see the RSSI increasing up to 15 dBm. Setting 20 dBm did not make any difference from 15 dBm, even though it reports 20 dBm is set.</p><p>So for all of you who can see values bigger than 15 dBm, you may actually want to test that. My bet is that it&#039;s bollocks ...</p><p>Why doesn&#039;t OpenWRT get this right? It&#039;s been a problem for such a long time.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p209361">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">Cypher</div>
					<div class="post-datetime">
						9 Aug 2013, 18:01					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>naturelle wrote:</cite><blockquote><p>No. That does not do what we want. Editing /etc/config/wireless is easy, therefore their&#039;s no uci-command needed.</p></blockquote></div><p>Well, uci is the cleanest way to do it. <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><div class="quotebox"><cite>naturelle wrote:</cite><blockquote><p>And: setting country=00 in wireless-file does not get the power we want.</p></blockquote></div><p>Oh okay, I thought at first you meant you had GB and then wanted to completely change to 00. Now I understand it.</p><p>In that case you might want to use:<br /></p><div class="codebox"><pre><code>sleep 60 &amp;&amp; iw reg set 00 &amp;</code></pre></div><p>The &quot;&amp;&quot; makes those commands run in background instead of waiting for it to finish.</p><p>If you want the output from the iw-command you can use this:<br /></p><div class="codebox"><pre><code>sleep 60 &amp;&amp; iw reg set 00 &gt; /tmp/iw-output.log 2&gt;&amp;1 &amp;</code></pre></div><p>But I also don&#039;t think it&#039;s actually working at 20dBm. First setting to GB, then to 00? That looks too strange, its more like you found a bug there.<br />I trust mastabogs test as I can&#039;t really try it out myself right now and it seems plausible.</p><p>Does anybody of you have a AG300H which we could use for testing? I would use mine if it wasnt my main router with a lot stuff on it. <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /><br />Specifically I want to test an older trunk version from 2012. It was the first time I flashed my AG300H and I remember that it had the full 20 dBm. Maybe that was just a display-bug or something, or maybe I&#039;m completely wrong and mis-remembering.. But if it really was on 20dBm, then we could work from there and try to find out which changeset caused those 15dBm.<br />Unless someone has a better idea. <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>											<p class="post-edited">(Last edited by <strong>Cypher</strong> on 9 Aug 2013, 18:03)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p209366">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">naturelle</div>
					<div class="post-datetime">
						9 Aug 2013, 18:48					</div>
				</div>
				<div class="post-content content">
					<p>No. First setting to 00, than GB. For me it looked like an increase in power (on my Android-device with Wifi-analyzer, distance 2m without any wall), but I also think that these kind of measuring is too improper.</p><p>BTW: this is no Buffalo-problem, the same occurs on a DIR-825 here...</p>											<p class="post-edited">(Last edited by <strong>naturelle</strong> on 9 Aug 2013, 18:48)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p209399">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">mastabog</div>
					<div class="post-datetime">
						10 Aug 2013, 04:09					</div>
				</div>
				<div class="post-content content">
					<p>@naturelle: I have some doubts that it actually increased the Tx power. If you&#039;re using Wifi Analyzer on android, Set Wifi Analyzer to display in TIME GRAPH (not AP list or other modes) and then put your pone 10cm away from the router&#039;s antenna. Activate the settings option &quot;keep screen on&quot; and then don&#039;t touch it.</p><p>Now set the Tx power to 15 dBm and leave it like that for 30 seconds and don&#039;t move -- your movement affects the measurements (multipath fading). These 30 seconds will plot a line which has some ups and downs but you can tell its average value.</p><p>Then set 20 dBm and leave for 30 seconds. See if the average increases by 5 dB. My bet is that it won&#039;t.</p><p>p.s. I could take the router to the lab, open it and measure the Tx power on the board&#039;s connector with a spectrum analyzer. I&#039;m pretty sure there&#039;s no change. But maybe someone can just install DD-WRT or the stock firmware and see if that actually gets 20 dBm ...</p>											<p class="post-edited">(Last edited by <strong>mastabog</strong> on 10 Aug 2013, 04:13)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p209408">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						10 Aug 2013, 11:41					</div>
				</div>
				<div class="post-content content">
					<p>Or read the test reports from the FCC application, they will summarize all physical rf properties.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p209428">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">mastabog</div>
					<div class="post-datetime">
						10 Aug 2013, 16:23					</div>
				</div>
				<div class="post-content content">
					<p>There&#039;s also this: <a href="http://buffalo.lithium.com/t5/Wireless/WZR-HP-AG300H-Transmit-power/td-p/60842">http://buffalo.lithium.com/t5/Wireless/ … td-p/60842</a></p><p>8th post in there says that an svn trunk OpenWRT gave him 27 dBm (on 04-17-2011 01:46 PM). We could try one of those versions from that time maybe ...</p><p>@jow: the FCC won&#039;t be of much use really; if there was a f/w bug or limitation (as is apparently the cae with the default DD-WRT f/w it came with) then the FCC couldn&#039;t have seen any high Tx power either.</p>											<p class="post-edited">(Last edited by <strong>mastabog</strong> on 10 Aug 2013, 16:25)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p209432">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						10 Aug 2013, 17:00					</div>
				</div>
				<div class="post-content content">
					<p>Sorry, but I trust the FCC laboratory tests a lot more than some fantasy bullshit numbers like 27dBm.<br />People often fail to understand that those limits are pure theoretical regulatory limits as defined in the CRDA database.</p><p>Nothing in the entire mac80211 stack and associated utilities exposed the real hardware limits (as dictated in the eeprom), only ever the regulatory limit which is then silently clamped down by the driver.</p><p>Even if you find a version that is buggy enough to let you set &quot;27dBm&quot; its a pure display bug. You should stop wasting your time chasing fantasy power levels.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p209444">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">kurczaq</div>
					<div class="post-datetime">
						10 Aug 2013, 20:04					</div>
				</div>
				<div class="post-content content">
					<p>or get PicoStation HP or Bullet M2 HP from UBNT and you get real 28dBm TX power <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p209460">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">mastabog</div>
					<div class="post-datetime">
						10 Aug 2013, 22:44					</div>
				</div>
				<div class="post-content content">
					<p>I already have the nano and nano loco (and actually get 30 dBm with those).</p><p>@jow: what i meant was that the FCC tested using some f/w. If that f/w was buggy or had limitations then they wouldn&#039;t see anything past that anyway ... their tests may be trustworthy but they are irellevant to the current issue. </p><p>I also disagree with your &quot;fantasy&quot; statements. The EIRP and regulatory OFDM spectrum masks allow for up to 20 dBm in most countries, while this device is stuck at 15 dBm and I&#039;m pretty sure that&#039;s not a hardware problem.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p209471">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">kurczaq</div>
					<div class="post-datetime">
						11 Aug 2013, 07:06					</div>
				</div>
				<div class="post-content content">
					<p>15dBm may be the limit on txpower, if they take into account the antenna gain. EIRP:</p><p><a href="https://en.wikipedia.org/wiki/Equivalent_isotropically_radiated_power">https://en.wikipedia.org/wiki/Equivalen … ated_power</a></p><p><img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p209495">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">mastabog</div>
					<div class="post-datetime">
						11 Aug 2013, 16:47					</div>
				</div>
				<div class="post-content content">
					<p>I may have expressed myself wrongly. I was under the impression that this device was sold with higher Tx power caps than most, given the &quot;HP&quot; in the name and &quot;High Power&quot; in its advertisement. Antenna gain has little to do with caps (dipole omnis have negligible gain). The &quot;HP&quot; in the name and the high price of the device mean that it should have a high quality amp, which does a better job at not distorting the signal when the Tx power is increased for OFDM transmission ... with cheap amps the OFDM back-off is quite large, about 5dB, leaving about 15 dBm effective max Tx power so that the FCC is happy. If that&#039;s the case then shame on Buffallo but I tend to think it&#039;s not since all older &quot;HP&quot; devices I owned from them did allow 20+ dBm Tx power (measured).</p><p>I&#039;d like to hit the 27dBm that apparently this device is capable of. 17 or 20 dBm is still an improvement, but not that substantial considering that indoors you typically have 50-60+ dB loss.</p><p>EDIT: I accidentally clicked on &quot;Report&quot; on the previous post and typed in a reply. My apologies. Mods, please ignore that, I have nothing against the post contents.</p>											<p class="post-edited">(Last edited by <strong>mastabog</strong> on 11 Aug 2013, 17:17)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p209496">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">mastabog</div>
					<div class="post-datetime">
						11 Aug 2013, 17:15					</div>
				</div>
				<div class="post-content content">
					<p>Yes, I remembered correctly regarding the hardware caps. The FCC report states a Tx power of 935.7 mW on 2.4 GHz and 915.1 mW on 5 GHz. That is about 29.7 dBm and 29.6 dBm max Tx power respectively.</p><p>See the FCC report from Buffalo <a href="https://dl.dropbox.com/s/e75bjokncgniv7g/FDI-09101889-0_Test-Report-15C.pdf">here</a>, page 7, Section 3.1. Or from FCC <a href="https://apps.fcc.gov/oetcf/eas/reports/ViewExhibitReport.cfm?mode=Exhibits&amp;RequestTimeout=500&amp;calledFromFrame=Y&amp;application_id=398337&amp;fcc_id=FDI-09101889-0">here</a>, then click on Test Report 15C.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p209504">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">kurczaq</div>
					<div class="post-datetime">
						11 Aug 2013, 18:56					</div>
				</div>
				<div class="post-content content">
					<p>there is a version of WRT54G that allowed real 250 mW output power. I tested it with DD-WRT and there was no issue setting the power. They use same tools as openwrt (iw). Maybe you can try another firmware too, to check if this is a HW or SW limitation in your case. Then complain to Openwrt developers <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>											<p class="post-edited">(Last edited by <strong>kurczaq</strong> on 11 Aug 2013, 18:57)</p>
									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=45260&amp;p=2.html">2</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>