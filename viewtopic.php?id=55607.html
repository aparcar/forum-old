<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Logitech C170 + mjpg_streamer doesn&#039;t work</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 21 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p264330">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">px2</div>
					<div class="post-datetime">
						6 Feb 2015, 02:06					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>Everywhere where I can find information about this webcam it worked well, but I can&#039;t make it working.<br />mjpg_streamer all the time shouts about format:<br /></p><div class="codebox"><pre><code>root@cph4:~# /usr/bin/mjpg_streamer --input &quot;input_uvc.so --device /dev/video0 -r 1024x768&quot; --output &quot;output_http.so --port 8080 --www /www/webcam&quot;
MJPG Streamer Version: svn rev: exported
 i: Using V4L2 device.: /dev/video0
 i: Desired Resolution: 1024 x 768
 i: Frames Per Second.: not limited
 i: Format............: JPEG 
 i: TV-Norm...........: DEFAULT
Unable to set format: 1196444237 res: 1024x768
 Init v4L2 failed !! exit fatal 
 i: init_VideoIn failed</code></pre></div><p>I&#039;ve tried with -y, without, with -n, without and with other resolutions as well. No success.<br />V4L shows:<br /></p><div class="codebox"><pre><code>root@cph4:~# v4l2-ctl --all -d /dev/video0
Driver Info (not using libv4l2):
    Driver name   : uvcvideo
    Card type     : Webcam C170
    Bus info      : usb-ehci-platform.1-1
    Driver version: 3.10.49
    Capabilities  : 0x84000001
        Video Capture
        Streaming
        Device Capabilities
    Device Caps   : 0x04000001
        Video Capture
        Streaming
Priority: 2
Video input : 0 (Camera 1: ok)
Format Video Capture:
    Width/Height  : 1024/768
    Pixel Format  : &#039;MJPG&#039; 
    Field         : None
    Bytes per Line: 0
    Size Image    : 2359296
    Colorspace    : SRGB
Crop Capability Video Capture:
    Bounds      : Left 0, Top 0, Width 1024, Height 768
    Default     : Left 0, Top 0, Width 1024, Height 768
    Pixel Aspect: 1/1
Streaming Parameters Video Capture:
    Capabilities     : timeperframe
    Frames per second: 30.000 (30/1)
    Read buffers     : 0
                     brightness (int)    : min=-64 max=64 step=1 default=0 value=0
                       contrast (int)    : min=0 max=30 step=1 default=13 value=13
                     saturation (int)    : min=0 max=127 step=1 default=38 value=38
                            hue (int)    : min=-16000 max=16000 step=1 default=0 value=0
 white_balance_temperature_auto (bool)   : default=1 value=1
                          gamma (int)    : min=20 max=250 step=1 default=100 value=100
           power_line_frequency (menu)   : min=0 max=2 default=1 value=1
      white_balance_temperature (int)    : min=2800 max=6500 step=1 default=5000 value=5000 flags=inactive
                      sharpness (int)    : min=0 max=100 step=1 default=35 value=35
         backlight_compensation (int)    : min=0 max=1 step=1 default=0 value=0
                  exposure_auto (menu)   : min=0 max=3 default=3 value=3
              exposure_absolute (int)    : min=2 max=5000 step=1 default=312 value=333 flags=inactive
         exposure_auto_priority (bool)   : default=0 value=1
                   pan_absolute (int)    : min=-72000 max=72000 step=3600 default=0 value=0
                  tilt_absolute (int)    : min=-54000 max=54000 step=3600 default=0 value=0
                  zoom_absolute (int)    : min=1 max=2 step=1 default=1 value=1</code></pre></div><p>It supports MJPG so should work. <br />Other thing is why mjpeg_streamer shows JPEG instead og MJPEG in format?<br />Have anyone of you guys had any issues with this cam?</p>											<p class="post-edited">(Last edited by <strong>px2</strong> on 6 Feb 2015, 02:10)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264332">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">grayman4hire</div>
					<div class="post-datetime">
						6 Feb 2015, 03:17					</div>
				</div>
				<div class="post-content content">
					<p>&quot;Unable to set format: 1196444237 res: 1024x768&quot;</p><p>Have you tried a lower res? 640x320</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264333">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">px2</div>
					<div class="post-datetime">
						6 Feb 2015, 03:27					</div>
				</div>
				<div class="post-content content">
					<p>Yes, I did. I&#039;ve tried 640x480, 320x240 and 1280x720 (just in case) but I think not a res is an issue here. Device supports 1024x768 natively what v4l confirms.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264418">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">grayman4hire</div>
					<div class="post-datetime">
						6 Feb 2015, 20:19					</div>
				</div>
				<div class="post-content content">
					<p>What device are you using? What version of OpenWRT? What was your install process for mjpg_streamer? Did you compile it yourself or just using opkg?</p><p>I don&#039;t have the C170, but have the C270, C310 and C920. I&#039;ll give it a test this weekend to see if I can reproduce your issue.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264427">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">px2</div>
					<div class="post-datetime">
						6 Feb 2015, 22:56					</div>
				</div>
				<div class="post-content content">
					<p>grayman I use device which points to that webcam, run it from command line at now to debug, because starting as a service didn&#039;t work. <br />Installed:<br />OpenWrt Barrier Breaker (r43321)<br />root@cph4:~# opkg list-installed | egrep &quot;v4l|uvc|mjpg&quot;<br />kmod-video-uvc - 3.10.49-1<br />libv4l - 1.2.1-2<br />mjpg-streamer - r182-1<br />v4l-utils - 1.2.1-2<br />root@cph4:~# </p><p>I appreciate if you can make tests on yours.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264429">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">tmo26</div>
					<div class="post-datetime">
						6 Feb 2015, 23:09					</div>
				</div>
				<div class="post-content content">
					<p>post the output of</p><div class="codebox"><pre><code>lsusb
uvcdynctrl -f -d /dev/video0
v4l2-ctl -d /dev/video0 --list-formats
v4l2-ctl -d /dev/video0 --list-formats-ext</code></pre></div><p>Have you tried YUV instead of mjpg?</p><p>C170 is not listed at <a href="http://www.ideasonboard.org/uvc/">http://www.ideasonboard.org/uvc/</a><br />Is the C170 a UVC compliant webcam?</p><p>How do I find out whether my camera is a UVC device or not?<br />-&gt; <a href="http://www.ideasonboard.org/uvc/faq/">http://www.ideasonboard.org/uvc/faq/</a></p>											<p class="post-edited">(Last edited by <strong>tmo26</strong> on 6 Feb 2015, 23:35)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264442">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">px2</div>
					<div class="post-datetime">
						7 Feb 2015, 02:28					</div>
				</div>
				<div class="post-content content">
					<p>dmesg:<br /></p><div class="codebox"><pre><code>[ 1791.970000] usb 2-1: new high-speed USB device number 3 using ehci-platform
[ 1792.200000] uvcvideo: Found UVC 1.00 device Webcam C170 (046d:082b)
[ 1792.210000] input: Webcam C170 as /devices/platform/ehci-platform.1/usb2/2-1/2-1:1.0/input/input1</code></pre></div><p>lsusb:<br /></p><div class="codebox"><pre><code>root@cph4:~# lsusb
Bus 001 Device 002: ID 152d:2329 JMicron Technology Corp. / JMicron USA Technology Corp. JM20329 SATA Bridge
Bus 002 Device 003: ID 046d:082b Logitech, Inc. 
Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
Bus 002 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub</code></pre></div><p>uvcdynctrl:<br /></p><div class="codebox"><pre><code>root@cph4:~# uvcdynctrl -f -d /dev/video0
Listing available frame formats for device /dev/video0:
Pixel format: YUYV (YUV 4:2:2 (YUYV); MIME type: video/x-raw-yuv)
  Frame size: 640x480
    Frame rates: 30, 15
  Frame size: 352x288
    Frame rates: 30, 15
  Frame size: 320x240
    Frame rates: 30, 15
  Frame size: 176x144
    Frame rates: 30, 15
  Frame size: 160x120
    Frame rates: 30, 15
  Frame size: 544x288
    Frame rates: 30, 15
  Frame size: 432x240
    Frame rates: 30, 15
  Frame size: 320x176
    Frame rates: 30, 15
  Frame size: 640x360
    Frame rates: 30, 15
Pixel format: MJPG (MJPEG; MIME type: image/jpeg)
  Frame size: 640x480
    Frame rates: 30, 15
  Frame size: 352x288
    Frame rates: 30, 15
  Frame size: 320x240
    Frame rates: 30, 15
  Frame size: 176x144
    Frame rates: 30, 15
  Frame size: 160x120
    Frame rates: 30, 15
  Frame size: 544x288
    Frame rates: 30, 15
  Frame size: 432x240
    Frame rates: 30, 15
  Frame size: 320x176
    Frame rates: 30, 15
  Frame size: 640x360
    Frame rates: 30, 15
  Frame size: 800x480
    Frame rates: 30, 15
  Frame size: 1024x768
    Frame rates: 30, 15</code></pre></div><p>v4l2-ctl:<br /></p><div class="codebox"><pre><code>root@cph4:~# v4l2-ctl -d /dev/video0 --list-formats
ioctl: VIDIOC_ENUM_FMT
    Index       : 0
    Type        : Video Capture
    Pixel Format: &#039;YUYV&#039;
    Name        : YUV 4:2:2 (YUYV)

    Index       : 1
    Type        : Video Capture
    Pixel Format: &#039;MJPG&#039; (compressed)
    Name        : MJPEG

root@cph4:~# v4l2-ctl -d /dev/video0 --list-formats-ext
ioctl: VIDIOC_ENUM_FMT
    Index       : 0
    Type        : Video Capture
    Pixel Format: &#039;YUYV&#039;
    Name        : YUV 4:2:2 (YUYV)
        Size: Discrete 640x480
            Interval: Discrete 0.033s (30.000 fps)
            Interval: Discrete 0.067s (15.000 fps)
        Size: Discrete 352x288
            Interval: Discrete 0.033s (30.000 fps)
            Interval: Discrete 0.067s (15.000 fps)
        Size: Discrete 320x240
            Interval: Discrete 0.033s (30.000 fps)
            Interval: Discrete 0.067s (15.000 fps)
        Size: Discrete 176x144
            Interval: Discrete 0.033s (30.000 fps)
            Interval: Discrete 0.067s (15.000 fps)
        Size: Discrete 160x120
            Interval: Discrete 0.033s (30.000 fps)
            Interval: Discrete 0.067s (15.000 fps)
        Size: Discrete 544x288
            Interval: Discrete 0.033s (30.000 fps)
            Interval: Discrete 0.067s (15.000 fps)
        Size: Discrete 432x240
            Interval: Discrete 0.033s (30.000 fps)
            Interval: Discrete 0.067s (15.000 fps)
        Size: Discrete 320x176
            Interval: Discrete 0.033s (30.000 fps)
            Interval: Discrete 0.067s (15.000 fps)
        Size: Discrete 640x360
            Interval: Discrete 0.033s (30.000 fps)
            Interval: Discrete 0.067s (15.000 fps)

    Index       : 1
    Type        : Video Capture
    Pixel Format: &#039;MJPG&#039; (compressed)
    Name        : MJPEG
        Size: Discrete 640x480
            Interval: Discrete 0.033s (30.000 fps)
            Interval: Discrete 0.067s (15.000 fps)
        Size: Discrete 352x288
            Interval: Discrete 0.033s (30.000 fps)
            Interval: Discrete 0.067s (15.000 fps)
        Size: Discrete 320x240
            Interval: Discrete 0.033s (30.000 fps)
            Interval: Discrete 0.067s (15.000 fps)
        Size: Discrete 176x144
            Interval: Discrete 0.033s (30.000 fps)
            Interval: Discrete 0.067s (15.000 fps)
        Size: Discrete 160x120
            Interval: Discrete 0.033s (30.000 fps)
            Interval: Discrete 0.067s (15.000 fps)
        Size: Discrete 544x288
            Interval: Discrete 0.033s (30.000 fps)
            Interval: Discrete 0.067s (15.000 fps)
        Size: Discrete 432x240
            Interval: Discrete 0.033s (30.000 fps)
            Interval: Discrete 0.067s (15.000 fps)
        Size: Discrete 320x176
            Interval: Discrete 0.033s (30.000 fps)
            Interval: Discrete 0.067s (15.000 fps)
        Size: Discrete 640x360
            Interval: Discrete 0.033s (30.000 fps)
            Interval: Discrete 0.067s (15.000 fps)
        Size: Discrete 800x480
            Interval: Discrete 0.033s (30.000 fps)
            Interval: Discrete 0.067s (15.000 fps)
        Size: Discrete 1024x768
            Interval: Discrete 0.033s (30.000 fps)
            Interval: Discrete 0.067s (15.000 fps)</code></pre></div><p>Yes, I did try -y.<br /></p><div class="codebox"><pre><code>root@cph4:~# /usr/bin/mjpg_streamer --input &quot;input_uvc.so -y --device /dev/video0 -r 640x480&quot; --output &quot;output_http.so --port 8080 --www /www/webcam&quot;MJPG Streamer Version: svn rev: exported
 i: Using V4L2 device.: /dev/video0
 i: Desired Resolution: 640 x 480
 i: Frames Per Second.: not limited
 i: Format............: YUYV
 i: JPEG Quality......: 80
 i: TV-Norm...........: DEFAULT
Unable to set format: 1448695129 res: 640x480
 Init v4L2 failed !! exit fatal 
 i: init_VideoIn failed</code></pre></div><p>I was wondering that maybe cam just doesn&#039;t work itself but connected to my laptop with Mint works well with cheese and VLC media player as well.</p>											<p class="post-edited">(Last edited by <strong>px2</strong> on 7 Feb 2015, 02:30)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264463">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">hoatienii</div>
					<div class="post-datetime">
						7 Feb 2015, 06:35					</div>
				</div>
				<div class="post-content content">
					<p>My wc C170 work fine.<br /></p><div class="codebox"><pre><code>dmesg | grep C170
[    9.249951] usb 1-1.2.4.4: Product: Webcam C170
[    9.754070] uvcvideo: Found UVC 1.00 device Webcam C170 (046d:082b)
[    9.773784] input: Webcam C170 as /devices/platform/bcm2708_usb/usb1/1-1/1-1.2/1-1.2.4/1-1.2.4.4/1-1.2.4.4:1.0/input/input1</code></pre></div><p>i install:&nbsp; kmod-video-uvc, mjpg-streamer</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264598">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">px2</div>
					<div class="post-datetime">
						8 Feb 2015, 06:41					</div>
				</div>
				<div class="post-content content">
					<p>Thank you hoatienii but my doesn&#039;t.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264813">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">px2</div>
					<div class="post-datetime">
						9 Feb 2015, 21:28					</div>
				</div>
				<div class="post-content content">
					<p>Guys any ideas how to make it work?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264837">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">grayman4hire</div>
					<div class="post-datetime">
						10 Feb 2015, 00:38					</div>
				</div>
				<div class="post-content content">
					<p>I gave mjpg_streamer a test just now and had no issues getting to run on trunk (44330) using a C270 camera. The versions are not the same as yours so you might want to consider updating.</p><br /><div class="codebox"><pre><code> CHAOS CALMER (Bleeding Edge, r44330)
 -----------------------------------------------------
  * 1 1/2 oz Gin            Shake with a glassful
  * 1/4 oz Triple Sec       of broken ice and pour
  * 3/4 oz Lime Juice       unstrained into a goblet.
  * 1 1/2 oz Orange Juice
  * 1 tsp. Grenadine Syrup
 -----------------------------------------------------
root@OpenWrt:~# mjpg_streamer --input &quot;input_uvc.so --device /dev/video0 -r 1024
x768&quot; --output &quot;output_http.so --port 8080 --www /www/webcam&quot;
MJPG Streamer Version: svn rev: exported
 i: Using V4L2 device.: /dev/video0
 i: Desired Resolution: 1024 x 768
 i: Frames Per Second.: not limited
 i: Format............: JPEG
 i: TV-Norm...........: DEFAULT
i: The format asked unavailable, so the width 960 height 720
 o: www-folder-path...: /www/webcam/
 o: HTTP TCP port.....: 8080
 o: username:password.: disabled
 o: commands..........: enabled

root@OpenWrt:~# opkg list-installed | egrep &quot;v4l|uvc|mjpg&quot;
kmod-video-uvc - 3.14.32-1
mjpg-streamer - r182-4</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264841">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">tmo26</div>
					<div class="post-datetime">
						10 Feb 2015, 01:15					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>grayman4hire wrote:</cite><blockquote><p>I gave mjpg_streamer a test just now and had no issues getting to run on trunk (44330) using a C270 camera. The versions are not the same as yours so you might want to consider updating.</p></blockquote></div><p>First of all, the cam is not the same...</p><p>C270 != C170</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264845">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">grayman4hire</div>
					<div class="post-datetime">
						10 Feb 2015, 01:29					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>grayman4hire wrote:</cite><blockquote><p>I don&#039;t have the C170, but have the C270, C310 and C920. I&#039;ll give it a test this weekend to see if I can reproduce your issue.</p></blockquote></div><p>I never said the camera was the same <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264847">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">leeandy</div>
					<div class="post-datetime">
						10 Feb 2015, 01:32					</div>
				</div>
				<div class="post-content content">
					<p>I have same @tmo26 issue. Pls see ticket: <a href="https://dev.openwrt.org/ticket/18953">https://dev.openwrt.org/ticket/18953</a></p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>