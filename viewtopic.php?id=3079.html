<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> RX Bytes reset its self?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 5 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p14498">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Pulseammo</div>
					<div class="post-datetime">
						29 Oct 2005, 15:11					</div>
				</div>
				<div class="post-content content">
					<p>Hello, I was wondering if anyone might know anything about a problem ive just noticed with the downstream byte count resetting to 0. I wrote myself a little perl CGI script which would show me my bandwidth usages on my router, however when I checked it tonight I noticed that the RX Bytes (from ifconfig output) had been reset to zero, the previous downstream byte count was about 3gigs and the uptime had been about 11days, I hadn&#039;t reboot the router either.</p><p>Is the RX Bytes supposed to reset to 0 on an interface once it reaches a certain amount? I dont think it changed IP and theres no log of it talking to my ISP or anything like that for a new IP.</p><p>Can anyone help shed some light on this please?</p><p>(The error is definately the RX bytes resetting and not in the perl script since I checked with ifconfig).</p><p>Thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p14500">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Netzfetz</div>
					<div class="post-datetime">
						29 Oct 2005, 15:53					</div>
				</div>
				<div class="post-content content">
					<p>Funny, I did the same the day before yesterday (using php, not perl) <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />But no, I haven&#039;t seen a reset so far. But maybe that&#039;s because I automatically reboot the router after 24h, so I never get to exceeding 3gigs.</p><p>Has TX been resetted too (if not would be very strange...)?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p14501">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Void Main</div>
					<div class="post-datetime">
						29 Oct 2005, 16:19					</div>
				</div>
				<div class="post-content content">
					<p>That&#039;s normal because the size of the variables for those counters only allow up to 4GB. I have high traffic systems that reset several times a day. Normally it doesn&#039;t reallly matter though because what you do in your program is check if the &quot;current&quot; value is less than the &quot;previous&quot; value and if it is add 4G to it then subtract the&nbsp; &quot;previous&quot; value from that which will give you an accurate count of bytes from the previous check to the current check. This assumes you check more often than your counters roll over.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p14507">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Pulseammo</div>
					<div class="post-datetime">
						29 Oct 2005, 18:36					</div>
				</div>
				<div class="post-content content">
					<p>Thanks void main, that helps me a bit,&nbsp; I was just confused why it had reset. Ill go about adding something to help log it better as per your suggestion through a cron tab so that it doesnt get missed and re-gerenerate normall through the cgi when the stats page gets a hit. I shouldn&#039;t have too much problems though as 4gigs down over 11 days isnt too high usage.</p><p>Netzfetz, my TX bytes had not reset because it was only around about 1gig.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p14510">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">Pulseammo</div>
					<div class="post-datetime">
						29 Oct 2005, 21:05					</div>
				</div>
				<div class="post-content content">
					<p>Hhhmm, while on the subject of cgi stats scripts, have either of you found a way to find out what the current link utilisation is on vlan1?</p><p>I know its possibly to read the stats output for TC which will give a break down per class but has anyone found a way for current downstream utilisation?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p14528">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Void Main</div>
					<div class="post-datetime">
						30 Oct 2005, 04:59					</div>
				</div>
				<div class="post-content content">
					<p>I don&#039;t think I understand your question. You&#039;re not talking about something like this are you?<br /><a href="http://voidmain.is-a-geek.net/cacti/graph.php?local_graph_id=16&amp;rra_id=all">http://voidmain.is-a-geek.net/cacti/gra â€¦ rra_id=all</a></p><p><span class="postimg"><img src="http://voidmain.is-a-geek.net/cacti/graph_image.php?local_graph_id=16&amp;rra_id=1" alt="http://voidmain.is-a-geek.net/cacti/graph_image.php?local_graph_id=16&amp;amp;rra_id=1" /></span></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p14554">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">Pulseammo</div>
					<div class="post-datetime">
						30 Oct 2005, 17:33					</div>
				</div>
				<div class="post-content content">
					<p>Hiya again <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />, its slightly like that.</p><p>You see down at the bottom where it says &quot;Inbound Current: 31.55 k&quot;</p><p>Thats what i&#039;m trying to find out where I can read that value, Ive searched around /proc/net and also in ifconfig but I dont seem to be able to find the reading anywhere.</p><p>Also Im not using graphs, Im just using purely textual output through my perl script which generates a web page and logs bandwidth to a file in the ram (which should only generate 1line a month all going well (hence no graph as im not really interested in when the bandwidth was used, just how much). The &quot;current&quot; reading would be handy to add though.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p14555">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">Void Main</div>
					<div class="post-datetime">
						30 Oct 2005, 17:44					</div>
				</div>
				<div class="post-content content">
					<p>Here&#039;s how I get inbound for vlan1:<br /></p><div class="codebox"><pre><code>snmpget -v 1 -c public 192.168.1.1 .1.3.6.1.2.1.2.2.1.10.6</code></pre></div><p>To make sure vlan1 is index 6 you can check your interface indexes with:</p><div class="codebox"><pre><code>snmpwalk -v 1 -c public 192.168.1.1 .1.3.6.1.2.1.2.2.1.2</code></pre></div><p>If you wanted it get it directly without using snmp you could:</p><div class="codebox"><pre><code># ifconfig vlan1 | grep &quot;RX bytes&quot; | cut -f2 -d: | cut -f1 -d&#039; &#039;</code></pre></div><p>Or </p><div class="codebox"><pre><code># grep &quot;vlan1:&quot; /proc/net/dev | cut -f2 -d: | cut -f1 -d&#039; &#039;</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p14559">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">Pulseammo</div>
					<div class="post-datetime">
						30 Oct 2005, 19:46					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><p>ifconfig vlan1 | grep &quot;RX bytes&quot; | cut -f2 -d: | cut -f1 -d&#039; &#039;</p></blockquote></div><p>I don&#039;t think im being too clear on what I want . . .</p><p>That is the code I currently use in order to get how many bytes have been transfered overall (plus modifications for when it resets to zero). But I&#039;m trying to see how much of my link is being used at any one point. For instance my full link capacity is 2Megabits per second downstream, so say for instance I&#039;m doing a download and its only going at 1Megabit /s I&#039;m wanting to find out from the router what it thinks the current link utilisation is.</p><p>For instance if PC 1 is downloading at 1Megabit /s and PC 2 is downloading at 0.5Megabits /s then the current utilisation is 1.5Mbps, Im trying to find out where I can obtain this number from the router in order to put it onto my stats page.</p><p>Someone told me it might not be possible unless I used something like IPTraf, but that program doesnt look too friendly for writing a CGI script in order to query it, I was also hoping to do it without adding anything extra.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p14564">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">Void Main</div>
					<div class="post-datetime">
						30 Oct 2005, 22:27					</div>
				</div>
				<div class="post-content content">
					<p>You are perfectly clear on what you want and the places I mention are where you get the information. You can&#039;t just grab the RX bytes once though, you have to grab it twice and figure the difference over the amount of time between the two checks. That&#039;s exactly how the graph I mentioned before does it. It polls every 5 minutes and figures the difference. xMb/s is by definition 2 variables (&quot;x amount of data&quot;/&quot;y time period&quot;). It sounds like your code is nearly complete. You just have to calculate the difference between the two RX byte captures and the time between the two captures and that will give you the rate. Divide by the number of seconds to get you the bytes/sec. Iptraf would do the same thing to calculate data rate. It might do the calculation every 1 second (or less) though, but there is no reason you can&#039;t calculate that often if you want to be able to see what your data rate is over a very small time period. That&#039;s completely up to you. There is no magical variable under /proc (that I am aware of) that shows current data rate. Mainly because there is no need for it.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p14569">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">Pulseammo</div>
					<div class="post-datetime">
						31 Oct 2005, 01:02					</div>
				</div>
				<div class="post-content content">
					<p>Aaahh, of course. Yes that makes perfect sense and its quite easy to do <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />. Thank you.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>