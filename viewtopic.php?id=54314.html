<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> How to restore firmware MR3020 via UART?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 23 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p256010">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Yov</div>
					<div class="post-datetime">
						30 Nov 2014, 10:58					</div>
				</div>
				<div class="post-content content">
					<p>Hello!</p><p>How to restore MR3020 router firmware via UART, if the update fails?</p><p>I create own firmware, but it was non-working.<br />Having connected on UART, I obtain such data:</p><div class="codebox"><pre><code>ЌЉЌЉХВппф ±®±®ґзеІёгёіґµ ЁКхо ±° І°±ґ  ±·єµ·єґі©ЌЉЌЉБР±І± Ёбт№іі°© ХвппфЌЉЌЉДТБНє  іІ НВЌЉмед фхтойоз по жпт ±у®®®ЌЉйд тебд °ш±°°°°°жжЌЉжмбуи уйъе ґ±№ґі°ґ¬ уегфпт гпхоф Ѕ ¶ґЌЉЖмбуиє  ґ НВЌЉХуйоз дежбхмф еоцйтпонеофЌЉЌЉЙоє    уетйбмЌЉПхфє   уетйбмЌЉЕттє   уетйбмЌЉОефє   бз·Іґ°ЯеоефЯйойфйбмйъе®®®ЌЉОп цбмйд бддтеуу йо Жмбуи® Хуйоз жйшед бддтеууЌЉОп цбмйд бддтеуу йо Жмбуи® Хуйоз жйшед бддтеууЌЉє гжз± °шµ гжзІ °ш·±±ґЌЉефи°є °°є°іє·жє°№є°вєбдЌЉбз·Іґ°ЯрищЯуефхр ЌЉефи° хрЌЉє гжз± °шж гжзІ °ш·І±ґЌЉефи±є °°є°іє·жє°№є°вєбдЌЉбфитуІ¶ЯтезЯйойфЯмбоЌЉБФИТУІ¶є теуеффйоз уІ¶ЌЉБФИТУІ¶є уІ¶ теуеф дпоеЌЉбз·Іґ°ЯрищЯуефхр ЌЉефи± хрЌЉефи°¬ ефи±ЌЉбхфп хрдбфе жйтнчбтеє йуЯбхфпЯхрмпбдЯжйтнчбте Ѕ °ЎЌЉБхфпвппфйоз йо ± уегподуЌЉЈЈ Вппфйоз йнбзе бф №ж°І°°°° ®®®ЌЉ   Хогпнртеууйоз Летоем Йнбзе ®®® ПЛЌЉЌЉУфбтфйоз летоем ®®®ЌЉЌЉЫ    °®°°°°°°Э Мйохш цетуйпо і®±°®ґ№ ЁхуетАгпнр© Ёзгг цетуйпо ґ®ё®і ЁПреоЧтфЇМйобтп ЗГГ ґ®ёІ°±ґ®°ґ тґііІ±© © Ј± Фих Опц І· І±єµієІ± ЩЕЛФ І°±ґЌЉЫ    °®°°°°°°Э вппфгпоупме Ыебтмщ°Э еобвмедЌЉЫ    °®°°°°°°Э ГРХ тецйуйпо йує °°°±№і·ґ ЁНЙРУ ІґЛг©ЌЉЫ    °®°°°°°°Э УпГє Бфиетпу БТ№іі° тец ±ЌЉЫ    °®°°°°°°Э Гмпглує ГРХєґ°°®°°°НИъ¬ ДДТєґ°°®°°°НИъ¬ БИВєІ°°®°°°НИъ¬ ТежєІµ®°°°НИъЌЉЫ    °®°°°°°°Э Дефетнйоед рищуйгбм ТБН нбрєЌЉЫ    °®°°°°°°Э  ненптщє °І°°°°°° А °°°°°°°° Ёхубвме©ЌЉЫ    °®°°°°°°Э Йойфтд опф жпход пт енрфщ  дйубвмйоз йойфтдЌЉЫ    °®°°°°°°Э Ъпое тбозеуєЌЉЫ    °®°°°°°°Э   Оптнбм   Ынен °ш°°°°°°°°°ш°±жжжжжжЭЌЉЫ    °®°°°°°°Э Нпцбвме ъпое уфбтф жпт ебги опдеЌЉЫ    °®°°°°°°Э Ебтмщ ненптщ опде тбозеуЌЉЫ    °®°°°°°°Э   опде   °є Ынен °ш°°°°°°°°°ш°±жжжжжжЭЌЉЫ    °®°°°°°°Э Ртйнбтщ йоуфтхгфйпо гбгие ¶ґлВ¬ ЦЙРФ¬ ґчбщ¬ мйоеуйъе іІ вщфеу®ЌЉЫ    °®°°°°°°Э Ртйнбтщ дбфб гбгие іІлВ¬ ґчбщ¬ ЦЙРФ¬ гбгие бмйбуеу¬ мйоеуйъе іІ вщфеуЌЉЫ    °®°°°°°°Э Вхймф ± ъпоемйуфу йо Ъпое птдет¬ нпвймйфщ зтпхрйоз по®  Фпфбм рбзеує ё±ІёЌЉЫ    °®°°°°°°Э Летоем гпннбод мйоеє  впбтдЅФМНТі°І° гпоупмеЅффщБФИ°¬±±µІ°° тппфжуфщреЅусхбуижу¬кжжуІ опйойфтдЌЉЫ    °®°°°°°°Э рЙД ибуи фбвме еофтйеує ±Іё Ёптдетє і¬ µ±І вщфеу©ЌЉЫ    °®°°°°°°Э Деофтщ гбгие ибуи фбвме еофтйеує ґ°№¶ Ёптдетє І¬ ±¶іёґ вщфеу©ЌЉЫ    °®°°°°°°Э Йопдегбгие ибуи фбвме еофтйеує І°ґё Ёптдетє ±¬ ё±№І вщфеу©ЌЉЫ    °®°°°°°°Э Чтйфйоз ЕттГфм тезйуфетЅ°°°°°°°°ЌЉЫ    °®°°°°°°Э Тебдвбгл ЕттГфм тезйуфетЅ°°°°°°°°ЌЉЫ    °®°°°°°°Э Ненптщє І№І¶°лЇіІ·¶ёл бцбймбвме Ё±№І·л летоем гпде¬ іµ°ёл теуетцед¬ ґ·°л дбфб¬ ІІґл йойф¬ °л ийзинен©ЌЉЫ    °®°°°°°°Э УМХВє ИЧбмйзоЅіІ¬ ПтдетЅ°і¬ НйоПвкегфуЅ°¬ ГРХуЅ±¬ ОпдеуЅ±ЌЉЫ    °®°°°°°°Э ОТЯЙТСУєµ±ЌЉЫ    °®°°°°°°Э Гбмйвтбфйоз дембщ мппр®®® І¶µ®ґІ ВпзпНЙРУ ЁмркЅ±іІ·±°ґ©ЌЉЫ    °®°ё°°°°Э рйдЯнбшє дежбхмфє іІ·¶ё нйойнхнє і°±ЌЉЫ    °®°ё°°°°Э Нпхофгбгие ибуи фбвме еофтйеує µ±ІЌЉЫ    °®°№°°°°Э ОЕФє Тезйуфетед ртпфпгпм жбнймщ ±¶ЌЉЫ    °®°№°°°°Э НЙРУє нбгийое йу ФРМЙОЛ ФМНТі°І°ЌЉЫ    °®іµ°°°°Э вйпє гтебфе умбв јвйп°ѕ бф °ЌЉЫ    °®іµ°°°°Э Учйфгийоз фп гмпглупхтге НЙРУЌЉЫ    °®і¶°°°°Э ОЕФє Тезйуфетед ртпфпгпм жбнймщ ІЌЉЫ    °®і¶°°°°Э ФГР еуфбвмйуиед ибуи фбвме еофтйеує µ±І Ёптдетє °¬ ґ°№¶ вщфеу©ЌЉЫ    °®і·°°°°Э ФГР вйод ибуи фбвме еофтйеує µ±І Ёптдетє ±¬ І°ґё вщфеу©ЌЉЫ    °®і·°°°°Э ФГРє Ибуи фбвмеу гпожйзхтед Ёеуфбвмйуиед µ±І вйод µ±І©ЌЉЫ    °®іё°°°°Э ФГРє теоп тезйуфетедЌЉЫ    °®іё°°°°Э ХДР ибуи фбвме еофтйеує Іµ¶ Ёптдетє °¬ ґ°№¶ вщфеу©ЌЉЫ    °®і№°°°°Э ХДРМйфе ибуи фбвме еофтйеує Іµ¶ Ёптдетє °¬ ґ°№¶ вщфеу©ЌЉЫ    °®ґ°°°°°Э ОЕФє Тезйуфетед ртпфпгпм жбнймщ ±ЌЉЫ    °®ґІ°°°°Э усхбуижує цетуйпо ґ®° ЁІ°°№Ї°±Їі±© Рийммйр мпхзиетЌЉЫ    °®ґІ°°°°Э кжжуІє цетуйпо І®І ЁОБОД© ЁУХННБТЩ© ЁМЪНБ© ЁТФЙНЕ© ЁГНПДЕЯРТЙПТЙФЩ© Ёг© І°°±І°°¶ Тед Ибф¬ Йог®ЌЉЫ    °®ґі°°°°Э нузной ибу веео уеф фп µ·ЌЉЫ    °®ґґ°°°°Э йп угиедхмет оппр тезйуфетедЌЉЫ    °®ґґ°°°°Э йп угиедхмет дебдмйое тезйуфетед Ёдежбхмф©ЌЉЫ    °®ґµ°°°°Э Уетйбмє ёІµ°Ї±¶µµ° дтйцет¬ ± рптфу¬ ЙТС уибтйоз дйубвмедЌЉЫ    °®ґµ°°°°Э бт№іішхбтфє ффщБФИ° бф ННЙП °ш±ё°І°°°° Ёйтс Ѕ ±±© йу б БR933X UART
[    0.460000] console [ttyATH0] enabled, bootconsole disabled
[    0.460000] console [ttyATH0] enabled, bootconsole disabled
[    0.480000] libphy: ag71xx_mdio: probed
[    1.030000] ag71xx ag71xx.0: connected to PHY at ag71xx-mdio.1:04 [uid=004dd041, driver=Generic PHY]
[    1.040000] eth0: Atheros AG71xx at 0xb9000000, irq 4, mode:MII
[    1.040000] TCP: cubic registered
[    1.050000] NET: Registered protocol family 17
[    1.050000] VFS: Cannot open root device &quot;(null)&quot; or unknown-block(0,0): error -6
[    1.060000] Please append a correct &quot;root=&quot; boot option; here are the available partitions:
[    1.070000] Kernel panic - not syncing: VFS: Unable to mount root fs on unknown-block(0,0)</code></pre></div><p>Questions:<br />1. What it is possible to make not to program flash chip?<br />2. Why the first lines of the data obtained on UART, are unreadable?<br />3. ISP, is the interface of intra scheme programming. Whether it is possible to program flash chip in the scheme?<br />4. There is any way to debug a ready firmware in the emulator?</p><p>Thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p256038">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">mk24</div>
					<div class="post-datetime">
						30 Nov 2014, 17:50					</div>
				</div>
				<div class="post-content content">
					<p>Try different baud rates.&nbsp; The important stuff you that you need to work with the bootloader is in the garbled part that you received at the wrong baud rate.&nbsp; Try 57600, 38400, 19200, or even 9600.&nbsp; After each change, reset the router and see if the bootloader messages come in clearly.</p><p>The kernel has changed the baud rate while it boots up, which is why it suddenly becomes clear.&nbsp; But by that point it is too late.&nbsp; You do know now that the kernel is going to crash due to lack of a rootfs.&nbsp; You need to interrupt the boot and use the bootloader to build a partition table, flash the rootfs and/or set up the kernel command line to point to the proper rootfs.&nbsp; Or you are using the wrong kernel for your hardware model.</p>											<p class="post-edited">(Last edited by <strong>mk24</strong> on 30 Nov 2014, 17:56)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p256044">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Yov</div>
					<div class="post-datetime">
						30 Nov 2014, 19:19					</div>
				</div>
				<div class="post-content content">
					<p>I tested speeds from 9600 to 256000 baud, but couldn&#039;t obtain correct data <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p256057">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">metai</div>
					<div class="post-datetime">
						30 Nov 2014, 21:35					</div>
				</div>
				<div class="post-content content">
					<p>I had a similar problem when trying to use the FT232 of a (perma-reset) Arduino to connect to the UART of a Pogoplug B04, a CP2102 based adapter worked just fine. May be an issue with your USB-to-TTL chip.</p>											<p class="post-edited">(Last edited by <strong>metai</strong> on 30 Nov 2014, 21:38)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p256059">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">Yov</div>
					<div class="post-datetime">
						30 Nov 2014, 22:19					</div>
				</div>
				<div class="post-content content">
					<p>I don&#039;t know. I have only a converter on MAX3232 for COM ports.<br />What it is possible to try to make in my case?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>