<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Samba Problems with Windows Client</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 30 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p19288">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">helmut</div>
					<div class="post-datetime">
						18 Jan 2006, 22:06					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I have an Asus WL-500g Deluxe which I want to use as a fileserver, attached with a USB Disk.<br />I installed the Samba packages exactly how described in the HowTo (http://wiki.openwrt.org/SambaHowto?high ? 28howto%29), getting the packages direct from the internet (ipkg install <a href="http://downloads.openwrt.org/people/nic">http://downloads.openwrt.org/people/nic</a> ? mipsel.ipk).</p><p>Samba works fine for my Mac Client (iBook MacOS 10.4) and a Suse 10.x Client without any additional attentions. Only my two Windows XP Pro Clients trigger the following errormessage in the logread:</p><p>kern.err smbd[11661]: Invalid packet length! (65600 bytes).</p><p>As one of the two machine is also the Suse Machine (dual boot) I exclude problems regarding to the network hardware (network card, lines, additional router).</p><p>It seem to me, that the windows client sends blocks which are too big (64k boundary?). I am not sure, wether that is a problem from Windows or the Samba implementation. I hope I can get a configuration parameter, to size up the buffer or some changes in the Windows registry to avoid sending big blocks.</p><p>As the fileserver is the only purpos of my router, solving that problem is very important to me. Thanks for all answers (except chuck away the windows clients).</p><p>Regards,</p><br /><br /><p>Helmut</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p20214">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">helmut</div>
					<div class="post-datetime">
						5 Feb 2006, 20:42					</div>
				</div>
				<div class="post-content content">
					<p>Does anyone sucessfully run XP clients especially XP Pro?</p><p>Regards, </p><br /><p>Helmut</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p21783">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Voice</div>
					<div class="post-datetime">
						1 Mar 2006, 01:56					</div>
				</div>
				<div class="post-content content">
					<p>Hi, I have exactly same problem :-(. On Oleg&#039;s firmware was everything OK.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p21796">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">macsat</div>
					<div class="post-datetime">
						1 Mar 2006, 08:05					</div>
				</div>
				<div class="post-content content">
					<p>I have no problems at all with samba and windows clients. I have used both XP Pro and XP Home.</p><p>I am also using Linux and XBMC (XboxMediaCenter) for clients against my samba server running on an ASUS WL-500G Deluxe.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p21800">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">nrg</div>
					<div class="post-datetime">
						1 Mar 2006, 09:02					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m using wl-hdd with preRC5 and I also didn&#039;t have problems with XP Pro but have question about smbpasswd. How can I make shared folder for different users with own passwords? I was reading tutorial about samba, changed config in smb.conf, and it says I need to add users to system first since OpenWrt is one user system and there is no adduser, I managed to add it manually in /etc/passwd with settings from nobody so my added users have following settings nrg:*:65534:65534:nrg:/var:/bin/false and NRG:*:65534:65534:NRG:/var:/bin/false after that smbpasswd went fine and the samba password for both users nrg and NRG ware added. Unfortunatelly it doesn&#039;t work <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /> Do you have any clue what might be the problem?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p21801">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">flyashi</div>
					<div class="post-datetime">
						1 Mar 2006, 09:05					</div>
				</div>
				<div class="post-content content">
					<p>nrg: if you really want, you can compile in useradd in the busybox config. That&#039;s probably the wrong way to go about it, though. It may be the only way. I dunno. But make sure you have a</p><p>server = SERVERNAME</p><p>line.</p><p> - Yasha</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p21870">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">helmut</div>
					<div class="post-datetime">
						2 Mar 2006, 04:50					</div>
				</div>
				<div class="post-content content">
					<p>Hi Macsat,</p><p>I am wondering about that. Did you need some special configuration to make it work. I tried a lot of various parms, but without sucess.</p><p>Because this is only a write problem: did you really write big files from the XP-client? With small files I also had no problems. In some times Windows didn&#039;t know, that write went wrong. So I made a compare and the files were different in many blocks (most of target-file were null-bytes).</p><br /><p>Regards</p><p>Helmut</p>											<p class="post-edited">(Last edited by <strong>helmut</strong> on 2 Mar 2006, 05:11)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p21871">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">helmut</div>
					<div class="post-datetime">
						2 Mar 2006, 04:56					</div>
				</div>
				<div class="post-content content">
					<p>Hi Nrg,</p><p>I didn&#039;t try that, but in windows the userids are not case sensitive so that could be the reason.</p><p>Regards</p><p>Helmut</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p21877">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">macsat</div>
					<div class="post-datetime">
						2 Mar 2006, 10:18					</div>
				</div>
				<div class="post-content content">
					<p>helmutn, I dont think I really have written large files with windows lately - only with my linux box.</p><p>I will try to write a large file with windows later today.</p><p>What do you regard a BIG file ?</p><p>I used the configuration described on my page in the samba tutorial.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p21880">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">nrg</div>
					<div class="post-datetime">
						2 Mar 2006, 11:31					</div>
				</div>
				<div class="post-content content">
					<p>Hello Helmut,</p><p>I&#039;m aware of it, and I set up two accounts nrg and NRG on router. According to some samba tutorial it prevents the problems with windows, I don&#039;t know if adding users to system in passwd the way I did is ok... What do you think?</p><p>regards<br />nrg</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p21958">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">helmut</div>
					<div class="post-datetime">
						3 Mar 2006, 04:41					</div>
				</div>
				<div class="post-content content">
					<p>Hi Macsat,</p><p>I had the problem with MP3 files, so writing a few megs should show the error.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p21959">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">helmut</div>
					<div class="post-datetime">
						3 Mar 2006, 04:57					</div>
				</div>
				<div class="post-content content">
					<p>Hi nrg!</p><p>I think the answer to your problem should be a linux answer, not a samba one.</p><p>You should create a group in /etc/groups and assign the users to that group. Change the group assignment (chgrp) of the shared directory. Create the Samba share and all users should have access to it. I did that and it worked. But because of my windows-write-problem I have no expirience about writing the files (be aware of the rights - sticky bit in the directory).</p><p>I hope that helps you.</p><p>Regards </p><br /><p>Helmut</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p22210">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">TheEagle</div>
					<div class="post-datetime">
						6 Mar 2006, 17:39					</div>
				</div>
				<div class="post-content content">
					<p>helmut, do you have any news one this? Getting the same error here ( Invalid packet length! (65600 bytes).<br /> )... just freshly installed samba (happens both on 2.0x and 3.0x versions). I&#039;m connecting from a WinXP SP2 machine.</p><p>EDIT: ok I think I should read the log more carefully ... it doesn&#039;t happen now on the 3.0x version I got from here <a href="http://www2.wpkg.org/openwrt/">http://www2.wpkg.org/openwrt/</a></p><p>Maybe this helps you too.</p>											<p class="post-edited">(Last edited by <strong>TheEagle</strong> on 6 Mar 2006, 18:20)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p22223">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">netddos</div>
					<div class="post-datetime">
						6 Mar 2006, 20:10					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>TheEagle wrote:</cite><blockquote><p>helmut, do you have any news one this? Getting the same error here ( Invalid packet length! (65600 bytes).<br /> )... just freshly installed samba (happens both on 2.0x and 3.0x versions). I&#039;m connecting from a WinXP SP2 machine.</p><p>EDIT: ok I think I should read the log more carefully ... it doesn&#039;t happen now on the 3.0x version I got from here <a href="http://www2.wpkg.org/openwrt/">http://www2.wpkg.org/openwrt/</a></p><p>Maybe this helps you too.</p></blockquote></div><p>how long did it take you to install samba 3? mine just hangs at &quot;Installing Samba 3 to root&quot;</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p22224">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">olli</div>
					<div class="post-datetime">
						6 Mar 2006, 20:14					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>helmut wrote:</cite><blockquote><p>Samba works fine for my Mac Client (iBook MacOS 10.4) and a Suse 10.x Client without any additional attentions. Only my two Windows XP Pro Clients trigger the following errormessage in the logread:</p><div class="codebox"><pre><code>kern.err smbd[11661]: Invalid packet length! (65600 bytes).</code></pre></div></blockquote></div><p>Please try the Samba package from [link removed] (the package is for White Russian pre-rc5).</p><p>Report here if it works for you.</p>											<p class="post-edited">(Last edited by <strong>olli</strong> on 6 Mar 2006, 23:52)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p22228">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">macsat</div>
					<div class="post-datetime">
						6 Mar 2006, 21:40					</div>
				</div>
				<div class="post-content content">
					<p>Working perfectly Olli - except your link ;-) <br />(it only points to : http:///)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p22239">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">olli</div>
					<div class="post-datetime">
						6 Mar 2006, 23:46					</div>
				</div>
				<div class="post-content content">
					<p>Fixed in <a href="https://dev.openwrt.org/changeset/3321">changeset:3321</a>.</p><p>You have to build your own binary from Subversion (my download link from above is removed).</p>											<p class="post-edited">(Last edited by <strong>olli</strong> on 6 Mar 2006, 23:51)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p22285">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">TheEagle</div>
					<div class="post-datetime">
						7 Mar 2006, 16:21					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>netddos wrote:</cite><blockquote><div class="quotebox"><cite>TheEagle wrote:</cite><blockquote><p>helmut, do you have any news one this? Getting the same error here ( Invalid packet length! (65600 bytes).<br /> )... just freshly installed samba (happens both on 2.0x and 3.0x versions). I&#039;m connecting from a WinXP SP2 machine.</p><p>EDIT: ok I think I should read the log more carefully ... it doesn&#039;t happen now on the 3.0x version I got from here <a href="http://www2.wpkg.org/openwrt/">http://www2.wpkg.org/openwrt/</a></p><p>Maybe this helps you too.</p></blockquote></div><p>how long did it take you to install samba 3? mine just hangs at &quot;Installing Samba 3 to root&quot;</p></blockquote></div><p>Think your problem is it is simply to big to install to &quot;root&quot; ... I installed to /opt (my external USB disk) ... don&#039;t remember how long it took, but wasn&#039;t too long.</p><p>But if a fix is there for version 2, I&#039;ll switch back. v3 is eating up a lot of resources.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p22396">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">TheEagle</div>
					<div class="post-datetime">
						9 Mar 2006, 01:21					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>olli wrote:</cite><blockquote><p>Fixed in <a href="https://dev.openwrt.org/changeset/3321">changeset:3321</a>.</p><p>You have to build your own binary from Subversion (my download link from above is removed).</p></blockquote></div><p>Thanks a lot. Works like a charme now ... at first I was a bit disappointed you didn&#039;t provide the download link, but I used the chance to &quot;build&quot; (compile) my first package ever using the SDK&nbsp; (used a colinux-debian for it).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p22397">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">netddos</div>
					<div class="post-datetime">
						9 Mar 2006, 01:53					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>TheEagle wrote:</cite><blockquote><div class="quotebox"><cite>olli wrote:</cite><blockquote><p>Fixed in <a href="https://dev.openwrt.org/changeset/3321">changeset:3321</a>.</p><p>You have to build your own binary from Subversion (my download link from above is removed).</p></blockquote></div><p>Thanks a lot. Works like a charme now ... at first I was a bit disappointed you didn&#039;t provide the download link, but I used the chance to &quot;build&quot; (compile) my first package ever using the SDK&nbsp; (used a colinux-debian for it).</p></blockquote></div><p>how did you get your samba 3 install?</p><p>mine is keep saying :no space left</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p22414">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">macsat</div>
					<div class="post-datetime">
						9 Mar 2006, 08:52					</div>
				</div>
				<div class="post-content content">
					<p>netddos - you need to install to another place than root (you need to put it on some external storage device like a USB disk, SD Card, Samba mount, NFS mount or so on!)......check out my page on how to install packages to /opt&nbsp; &nbsp;:</p><p><a href="http://www.macsat.com/macsat/content/view/16/30/">http://www.macsat.com/macsat/content/view/16/30/</a></p><p>You could also try to just go for the 2.x version that Olli fixed, if you dont have any specific need for 3.x.</p><p>The binary can be downloaded from my page as well:<br /><a href="http://www.macsat.com/macsat/component/option,com_remository/Itemid,44/func,fileinfo/id,9/">http://www.macsat.com/macsat/component/ … info/id,9/</a></p><p>Thanks to Olli for the fix, and the binary.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p22506">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">netddos</div>
					<div class="post-datetime">
						10 Mar 2006, 02:15					</div>
				</div>
				<div class="post-content content">
					<p>thanks i&#039;ll try it out.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p22857">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">helmut</div>
					<div class="post-datetime">
						15 Mar 2006, 04:24					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>olli wrote:</cite><blockquote><p>Fixed in <a href="https://dev.openwrt.org/changeset/3321">changeset:3321</a>.</p><p>You have to build your own binary from Subversion (my download link from above is removed).</p></blockquote></div><p>I tried it out and it works for me too. Thanks a lot.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p43840">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">superbear</div>
					<div class="post-datetime">
						7 Mar 2007, 00:37					</div>
				</div>
				<div class="post-content content">
					<p>i installed this version to my opt dir:<br /><a href="http://www2.wpkg.org/openwrt/samba_3.0.21b_mipsel.ipk">http://www2.wpkg.org/openwrt/samba_3.0.21b_mipsel.ipk</a></p><p>but everytime i want to start samba there&#039;s an error saying this:<br /></p><div class="codebox"><pre><code>root@WRT54GSDEV:/etc/samba$ smbd -FS
smbd version 3.0.21b started.
Copyright Andrew Tridgell and the Samba Team 1992-2006
Unable to connect to CUPS server localhost - Connection refused
Unable to connect to CUPS server localhost - Connection refused
Failed to open group mapping database
failed to initialize group mapping
Failed to open account policy database
Failed to open account policy database
Failed to open account policy database
Failed to open account policy database
Failed to open account policy database
Failed to open account policy database</code></pre></div><p>Is there an tutorial on how to build my own samba package?<br />i would also like to have smbadduser support!</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>