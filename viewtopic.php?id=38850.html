<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Can&#039;t get USB Printer to work on TL-WR1042ND</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 1 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p175576">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">knuddel</div>
					<div class="post-datetime">
						23 Aug 2012, 08:33					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>I installed stable Backfire 10.03.1 on my TL-WR1042ND, everything is working fine, except of my printer. I followed the wiki howto, checked if every USB packages were installed, but the printer does not work. A cat test.txt &gt; /dev/lp0 does nothing, no error, no output, no activity on the printer. Here&#039;s my dmesg when plugging in my printer, which is a Brother MFC-250C (it&#039;s a USB 2.0 printer):</p><p>usb 1-1.3: new full speed USB device using ar71xx-ehci and address 5<br />usb 1-1.3: configuration #1 chosen from 1 choice<br />usblp0: USB Bidirectional printer dev 5 if 0 alt 0 proto 2 vid 0x04F9 pid 0x01FE<br />scsi1 : SCSI emulation for USB Mass Storage devices<br />usb-storage: device found at 5<br />usb-storage: waiting for device to settle before scanning<br />scsi 1:0:0:0: Direct-Access&nbsp; &nbsp; &nbsp;Brother&nbsp; MFC-250C&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1.00 PQ: 0 ANSI: 2<br />usb-storage: device scan complete<br />sd 1:0:0:0: [sda] Attached SCSI removable disk</p><p>Here&#039;s an lsmod output:<br />Module&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Size&nbsp; Used by&nbsp; &nbsp; Not tainted<br />ftdi_sio&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;29712&nbsp; 1<br />usb_storage&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 32720&nbsp; 0<br />usbserial&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 24352&nbsp; 3 ftdi_sio<br />usblp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8512&nbsp; 0<br />uhci_hcd&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;17728&nbsp; 0<br />ohci_hcd&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;16912&nbsp; 0<br />nf_nat_tftp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 432&nbsp; 0<br />nf_conntrack_tftp&nbsp; &nbsp; &nbsp; &nbsp;2400&nbsp; 1 nf_nat_tftp<br />nf_nat_irc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;816&nbsp; 0<br />nf_conntrack_irc&nbsp; &nbsp; &nbsp; &nbsp; 2512&nbsp; 1 nf_nat_irc<br />nf_nat_ftp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1328&nbsp; 0<br />nf_conntrack_ftp&nbsp; &nbsp; &nbsp; &nbsp; 4640&nbsp; 1 nf_nat_ftp<br />ipt_MASQUERADE&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;992&nbsp; 1<br />iptable_nat&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2768&nbsp; 1<br />nf_nat&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;10912&nbsp; 5 nf_nat_tftp,nf_nat_irc,nf_nat_ftp,ipt_MASQUERADE,iptable_nat<br />xt_NOTRACK&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;544&nbsp; 0<br />iptable_raw&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 656&nbsp; 1<br />xt_state&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;768&nbsp; 6<br />nf_conntrack_ipv4&nbsp; &nbsp; &nbsp; &nbsp;7920&nbsp; 9 iptable_nat,nf_nat<br />nf_defrag_ipv4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;624&nbsp; 1 nf_conntrack_ipv4<br />nf_conntrack&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;38848 12 nf_nat_tftp,nf_conntrack_tftp,nf_nat_irc,nf_conntrack_irc,nf_nat_ftp,nf_conntrack_ftp,ipt_MASQUERADE,iptable_nat,nf_nat,xt_NOTRACK,xt_state,nf_conntrack_ipv4<br />ehci_hcd&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;31456&nbsp; 0<br />sd_mod&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;21696&nbsp; 0<br />ipt_REJECT&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1680&nbsp; 2<br />xt_TCPMSS&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2560&nbsp; 1<br />ipt_LOG&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4176&nbsp; 0<br />xt_comment&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;464&nbsp; 0<br />xt_multiport&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1792&nbsp; 0<br />xt_mac&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;576&nbsp; 0<br />xt_limit&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1008&nbsp; 1<br />iptable_mangle&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;992&nbsp; 1<br />iptable_filter&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;768&nbsp; 1<br />ip_tables&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8544&nbsp; 4 iptable_nat,iptable_raw,iptable_mangle,iptable_filter<br />xt_tcpudp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1760&nbsp; 8<br />x_tables&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 9296 13 ipt_MASQUERADE,iptable_nat,xt_NOTRACK,xt_state,ipt_REJECT,xt_TCPMSS,ipt_LOG,xt_comment,xt_multiport,xt_mac,xt_limit,ip_tables,xt_tcpudp<br />ppp_async&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;6400&nbsp; 0<br />ath9k&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 86656&nbsp; 0<br />ath9k_common&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1200&nbsp; 1 ath9k<br />ath9k_hw&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 338384&nbsp; 2 ath9k,ath9k_common<br />ath&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 14160&nbsp; 3 ath9k,ath9k_common,ath9k_hw<br />mac80211&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 229696&nbsp; 1 ath9k<br />usbcore&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 97616&nbsp; 8 ftdi_sio,usb_storage,usbserial,usblp,uhci_hcd,ohci_hcd,ehci_hcd<br />scsi_mod&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;68272&nbsp; 2 usb_storage,sd_mod<br />nls_base&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4800&nbsp; 1 usbcore<br />crc_ccitt&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 976&nbsp; 1 ppp_async<br />cfg80211&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 139760&nbsp; 3 ath9k,ath,mac80211<br />pppoe&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8304&nbsp; 2<br />pppox&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1216&nbsp; 1 pppoe<br />ppp_generic&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 18864&nbsp; 7 ppp_async,pppoe,pppox<br />slhc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4160&nbsp; 1 ppp_generic<br />compat&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;16496&nbsp; 3 ath9k,mac80211,cfg80211<br />arc4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;816&nbsp; 2<br />aes_generic&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 30256&nbsp; 4<br />deflate&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1360&nbsp; 0<br />ecb&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1328&nbsp; 0<br />cbc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2016&nbsp; 0<br />leds_gpio&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1456&nbsp; 0<br />button_hotplug&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2576&nbsp; 0<br />gpio_buttons&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2128&nbsp; 0<br />input_polldev&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1360&nbsp; 1 gpio_buttons<br />input_core&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;17056&nbsp; 4 button_hotplug,gpio_buttons,input_polldev</p><p>ls -lFs /dev/lp0<br />4 -rw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 722 Aug 23 08:24 /dev/lp0</p><p>Any advice or help would be very appreciated what I should do to test out why it&#039;s not working. Thanks a lot.</p>											<p class="post-edited">(Last edited by <strong>knuddel</strong> on 23 Aug 2012, 09:30)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p175596">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">epek</div>
					<div class="post-datetime">
						23 Aug 2012, 11:44					</div>
				</div>
				<div class="post-content content">
					<p>Hello!</p><p>1. As you posted, the device is at usblp0, not lp0. The output of ls shows, that lp0 is not a link.<br />2. I guess, that the MFC-250C is a GDI-Printer, but I can&#039;t tell for sure from the specifications from the brother homepage. So the &quot;cat&quot; into lp0 or usblp0 will not show the wanted effects.<br />3. You will probably want to try p910nd and luci-app-p910nd in combination with the correct printer driver.</p><p>Regards<br />epek</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p175599">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">knuddel</div>
					<div class="post-datetime">
						23 Aug 2012, 12:08					</div>
				</div>
				<div class="post-content content">
					<p>But /dev/lp0 appears when I plug in the printer, somewhere in the changelogs (<a href="https://dev.openwrt.org/ticket/3233">here</a> ... &quot;It depends on the kernel version: 2.6.x: /dev/lp&lt;n&gt; 2.4.x: /dev/usb/lp&lt;n&gt;&quot;) it says they changed the link from /dev/usb/lp0 to /dev/lp0, whatever reason for. I have already installed p910nd, that doesnt do any favor though, because the printer has to work at first. What&#039;s a GDI printer? So how do I get it to work, what drivers, where should I get AR71xx compiled drivers for that printer from... Shouldnt usblp handle it alone?</p>											<p class="post-edited">(Last edited by <strong>knuddel</strong> on 23 Aug 2012, 12:14)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p175684">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">knuddel</div>
					<div class="post-datetime">
						24 Aug 2012, 10:55					</div>
				</div>
				<div class="post-content content">
					<p>bump...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176003">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">epek</div>
					<div class="post-datetime">
						28 Aug 2012, 01:20					</div>
				</div>
				<div class="post-content content">
					<p>The specification¹ of your printer does not tell, what emulations it is capable of.<br />A GDI Printer is describen on wikipedia² as a printer that does not use hardware for print preprocessing. Instead, the driver will render it. (that&#039;s probably why a simple cat &quot;x&quot; &gt;/dev/lp0 won&#039;t work as expected.)<br />What you may want to do is just forwarding the USB-protocol data with usbip, but up to my current knowledge, that will only work well on linux, despite there is a driver for Windows³ too.<br />Since 910nd (4) does also just passes data through, it should also work, but the driver needs to be installed on the client machine (not the router itself). Printing from the router itself won&#039;t work, I guess for the same reasons as (2). I am probably wrong.<br />To be sure about the correct device check dmesg | grep lp.</p><p>On Windows you may install the driver for a local printer and install a generic network card afterwards (see driver/port settings). That should do the trick.</p><p>1: <a href="http://welcome.solutions.brother.com/bsc/public_s/id/us/us/en/colormfc/mfc250c_all/spec/index.html">http://welcome.solutions.brother.com/bs … index.html</a><br />2: <a href="http://en.wikipedia.org/wiki/Gdi_printer#GDI_printers">http://en.wikipedia.org/wiki/Gdi_printer#GDI_printers</a><br />3: <a href="http://usbip.sourceforge.net">http://usbip.sourceforge.net</a>/<br />4: <a href="http://p910nd.sourceforge.net">http://p910nd.sourceforge.net</a>/</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p338125">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">braian87b</div>
					<div class="post-datetime">
						13 Sep 2016, 06:03					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>knuddel wrote:</cite><blockquote><p>Hello,</p><p>I installed stable Backfire 10.03.1 on my TL-WR1042ND, everything is working fine...</p></blockquote></div><p>Do you really be able to install OpenWrt on TL-WR1042ND?? or you mean TL-WR1043ND ??</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p363044">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">GBRR</div>
					<div class="post-datetime">
						2 Aug 2017, 11:22					</div>
				</div>
				<div class="post-content content">
					<p>same question, I need to verify also.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>