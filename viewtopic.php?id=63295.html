<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Problems setting fixed rate mask on .11n</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 8 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p314374">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">psalazar</div>
					<div class="post-datetime">
						11 Mar 2016, 13:36					</div>
				</div>
				<div class="post-content content">
					<p>Hi all,</p><p>Could anyone please help me? I&#039;m having problems while trying to set a fixed MCS index on .11n.<br />After applying the bitrate mask on both AP and Client I noticed that the bitrate values (especially the tx bitrate) were frequently changing. I&#039;m performing some tests to evaluate the performance of a network and I really need this values to be static all the way.<br />I also noticed that there were some kernel warnings after I applied the bitrate mask to the 2.4 GHz interface. From Dmesg:<br /></p><div class="codebox"><pre><code>[  163.640000] ------------[ cut here ]------------
[  163.650000] WARNING: CPU: 0 PID: 1354 at /home/buildbot/slave-local/ar71xx_generic/build/build_dir/target-mips_34kc_uClibc-0.9.33.2/linux-ar71xx_generic/compat-wireless-2015-03-09/net/mac80211/rate.c:249 0x87194328 [mac80211@87180000+0x58810]()
[  163.670000] Modules linked in: pppoe ppp_async iptable_nat ath9k pppox ppp_generic nf_nat_ipv4 nf_conntrack_ipv6 nf_conntrack_ipv4 ipt_REJECT ipt_MASQUERADE ath9k_common xt_time xt_tcpudp xt_state xt_nat xt_multiport xt_mark xt_mac xt_limit xt_id xt_conntrack xt_comment xt_TCPMSS xt_REDIRECT xt_LOG xt_CT slhc nf_reject_ipv4 nf_nat_masquerade_ipv4 nf_nat_ftp nf_nat nf_log_ipv4 nf_defrag_ipv6 nf_defrag_ipv4 nf_conntrack_rtcache nf_conntrack_ftp nf_conntrack iptable_raw iptable_mangle iptable_filter ip_tables crc_ccitt ath9k_hw ath10k_pci ath10k_core ath mac80211 cfg80211 compat ledtrig_usbdev ip6t_REJECT nf_reject_ipv6 nf_log_ipv6 nf_log_common ip6table_raw ip6table_mangle ip6table_filter ip6_tables x_tables tun ipv6 arc4 crypto_blkcipher ehci_platform ehci_hcd gpio_button_hotplug usbcore nls_base usb_common
[  163.740000] CPU: 0 PID: 1354 Comm: wifix-dr_mips Not tainted 3.18.20 #1
[  163.750000] Stack : 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  163.750000]       00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  163.750000]       00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  163.750000]       00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  163.750000]       00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  163.750000]       ...
[  163.790000] Call Trace:[&lt;80070c54&gt;] 0x80070c54
[  163.790000] [&lt;80070c54&gt;] 0x80070c54
[  163.790000] [&lt;87194328&gt;] 0x87194328 [mac80211@87180000+0x58810]
[  163.800000] [&lt;800800c4&gt;] 0x800800c4
[  163.800000] [&lt;87194328&gt;] 0x87194328 [mac80211@87180000+0x58810]
[  163.810000] [&lt;8008017c&gt;] 0x8008017c
[  163.810000] [&lt;800ab5d0&gt;] 0x800ab5d0
[  163.820000] [&lt;87194328&gt;] 0x87194328 [mac80211@87180000+0x58810]
[  163.820000] [&lt;87194654&gt;] 0x87194654 [mac80211@87180000+0x58810]
[  163.830000] [&lt;871c973c&gt;] 0x871c973c [mac80211@87180000+0x58810]
[  163.840000] [&lt;87195068&gt;] 0x87195068 [mac80211@87180000+0x58810]
[  163.840000] [&lt;871a5610&gt;] 0x871a5610 [mac80211@87180000+0x58810]
[  163.850000] [&lt;871a5a78&gt;] 0x871a5a78 [mac80211@87180000+0x58810]
[  163.850000] [&lt;871a5af0&gt;] 0x871a5af0 [mac80211@87180000+0x58810]
[  163.860000] [&lt;80233980&gt;] 0x80233980
[  163.860000] [&lt;87360668&gt;] 0x87360668 [ath9k@87360000+0x146f0]
[  163.870000] [&lt;80082cb4&gt;] 0x80082cb4
[  163.870000] [&lt;800a59d8&gt;] 0x800a59d8
[  163.880000] [&lt;800825c4&gt;] 0x800825c4
[  163.880000] [&lt;800a5a78&gt;] 0x800a5a78
[  163.880000] [&lt;8006a10c&gt;] 0x8006a10c
[  163.890000] [&lt;80060830&gt;] 0x80060830
[  163.890000] [&lt;80082930&gt;] 0x80082930
[  163.890000] [&lt;80060830&gt;] 0x80060830
[  163.900000] [&lt;8022c064&gt;] 0x8022c064
[  163.900000] [&lt;80064f4c&gt;] 0x80064f4c
[  163.900000] [&lt;8022c170&gt;] 0x8022c170
[  163.910000] [&lt;8010b6a8&gt;] 0x8010b6a8
[  163.910000] [&lt;8022c064&gt;] 0x8022c064
[  163.910000] [&lt;8010b158&gt;] 0x8010b158
[  163.920000] [&lt;800b1940&gt;] 0x800b1940
[  163.920000] [&lt;871a0f18&gt;] 0x871a0f18 [mac80211@87180000+0x58810]
[  163.930000] [&lt;80099294&gt;] 0x80099294
[  163.930000] [&lt;870f0448&gt;] 0x870f0448 [nf_conntrack@870f0000+0xaf00]
[  163.940000] [&lt;8009eafc&gt;] 0x8009eafc
[  163.940000] [&lt;80233944&gt;] 0x80233944
[  163.940000] [&lt;8028b140&gt;] 0x8028b140
[  163.950000] [&lt;870f254c&gt;] 0x870f254c [nf_conntrack@870f0000+0xaf00]
[  163.950000] [&lt;873802c0&gt;] 0x873802c0 [ip_tables@87380000+0x23f0]
[  163.960000] [&lt;80233944&gt;] 0x80233944
[  163.960000] [&lt;80233980&gt;] 0x80233980
[  163.970000] [&lt;8028b878&gt;] 0x8028b878
[  163.970000] [&lt;80293930&gt;] 0x80293930
[  163.970000] [&lt;80232cc4&gt;] 0x80232cc4
[  163.980000] [&lt;80232c8c&gt;] 0x80232c8c
[  163.980000] [&lt;80273364&gt;] 0x80273364
[  163.990000] [&lt;8023aab4&gt;] 0x8023aab4
[  163.990000] [&lt;802730dc&gt;] 0x802730dc
[  163.990000] [&lt;80295e60&gt;] 0x80295e60
[  164.000000] [&lt;8026d53c&gt;] 0x8026d53c
[  164.000000] [&lt;80273238&gt;] 0x80273238
[  164.000000] [&lt;802738d8&gt;] 0x802738d8
[  164.010000] [&lt;80273364&gt;] 0x80273364
[  164.010000] [&lt;800f6928&gt;] 0x800f6928
[  164.010000] [&lt;8024238c&gt;] 0x8024238c
[  164.020000] [&lt;8009661c&gt;] 0x8009661c
[  164.020000] [&lt;802426c0&gt;] 0x802426c0
[  164.020000] [&lt;8010bafc&gt;] 0x8010bafc
[  164.030000] [&lt;87363aa4&gt;] 0x87363aa4 [ath9k@87360000+0x146f0]
[  164.030000] [&lt;800a4d50&gt;] 0x800a4d50
[  164.040000] [&lt;8736056c&gt;] 0x8736056c [ath9k@87360000+0x146f0]
[  164.040000] [&lt;80082cb4&gt;] 0x80082cb4
[  164.050000] [&lt;8010bd2c&gt;] 0x8010bd2c
[  164.050000] [&lt;800aa47c&gt;] 0x800aa47c
[  164.050000] [&lt;80062b5c&gt;] 0x80062b5c
[  164.060000] 
[  164.060000] ---[ end trace 53f03831093d19c7 ]---</code></pre></div><p>Command used to apply the bitrate mask on the 2.4 GHz interface:<br /></p><div class="codebox"><pre><code>iw dev wlan1 set bitrates
iw dev wlan1 set bitrates legacy-2.4 ht-mcs-2.4 9 sgi-2.4 </code></pre></div><p>Wireless configuration files for the 2.4 GHz interface<br /></p><div class="codebox"><pre><code>config wifi-device &#039;radio1&#039;
        option type &#039;mac80211&#039;
        option hwmode &#039;11g&#039;
        option path &#039;platform/qca955x_wmac&#039;
        option htmode &#039;HT40&#039;
        option disabled &#039;0&#039;

config wifi-iface
        option device &#039;radio1&#039;
        option network &#039;wifi1&#039;
        option mode &#039;ap&#039;
        option ssid &#039;tests&#039;
        option encryption &#039;psk2+tkip+ccmp&#039;
        option key &#039;0123456789&#039;</code></pre></div><p>The router is a TP-LINK archer c5 v1.2 and I am running OpenWrt CHAOS CALMER (15.05, r46767)<br />I have already searched for this problem but could not find any help. Has anyone experienced anything like this in the past?</p><p>Best Regards,<br />Pedro</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>