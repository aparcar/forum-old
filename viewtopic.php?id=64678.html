<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> How to compile with gcc inside OpenWRT</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 16 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p322767">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">OpenUser</div>
					<div class="post-datetime">
						6 May 2016, 18:37					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I have a &quot;Linksys WRT1200AC&quot; router running &quot;CC 15.05.1&quot; and after installing &quot;gcc_4.8.3-1_mvebu.ipk&quot; and all other required packages I&#039;ve tried to compile a C source file (something easy, similar to &quot;hello world&quot;) with the command:<br /></p><div class="codebox"><pre><code>#gcc mysource.c -o myprogram
#chmod +x myprogram

#./myprogram
myprogram: line 1: syntax error: unexpected word (expecting &quot;)&quot;)</code></pre></div><p>The compiler gives me no errors or warnings, but the program can&#039;t be started.<br />It&#039;s like installing a .ipk package from a different arch to your router.<br />So I think that gcc is compiling my source for a different CPU/Arch.<br />This is the cpu type: &quot;Marvell Armada 38X dual-core @ 1.33 GHz (88F6820-A0 C133)&quot;<br /></p><div class="codebox"><pre><code># uname -a
Linux OW 3.18.23 #1 SMP Sun Jan 31 12:53:24 CET 2016 armv7l GNU/Linux

# grep &#039;model name&#039; /proc/cpuinfo
model name      : ARMv7 Processor rev 1 (v7l)
model name      : ARMv7 Processor rev 1 (v7l)</code></pre></div><p>What is the correct command line to compile my sources inside openwrt with the right CPU/Arch option?<br />I&#039;ve tried with different &quot;-march/-mcpu&quot; but no success.</p><p>This is with verbose on:<br /></p><div class="codebox"><pre><code># gcc -v mysource.c -o mysource
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/usr/lib/gcc/arm-openwrt-linux-uclibcgnueabi/4.8.3/lto-wrapper
Target: arm-openwrt-linux-uclibcgnueabi
Configured with: /home/buildbot/slave-local/mvebu_generic/build/build_dir/target-arm_cortex-a9+vfpv3_uClibc-0.9.33.2_eabi/gcc-4.8.3/configure --target=arm-openwrt-linux --host=arm-openwrt-linux --build=x86_64-linux-gnu --program-prefix= --program-suffix= --prefix=/usr --exec-prefix=/usr --bindir=/usr/bin --sbindir=/usr/sbin --libexecdir=/usr/lib --sysconfdir=/etc --datadir=/usr/share --localstatedir=/var --mandir=/usr/man --infodir=/usr/info --disable-nls --build=x86_64-linux-gnu --host=arm-openwrt-linux-uclibcgnueabi --target=arm-openwrt-linux-uclibcgnueabi --enable-languages=c,c++ --with-bugurl=https://dev.openwrt.org/ --with-pkgversion=&#039;OpenWrt GCC 4.8.3&#039; --enable-shared --disable-__cxa_atexit --enable-target-optspace --with-gnu-ld --disable-nls --disable-libmudflap --disable-multilib --disable-libgomp --disable-libquadmath --disable-libssp --disable-decimal-float --disable-libstdcxx-pch --with-host-libstdcxx=-lstdc++ --prefix=/usr --libexecdir=/usr/lib --with-float=soft
Thread model: posix
gcc version 4.8.3 (OpenWrt GCC 4.8.3)
COLLECT_GCC_OPTIONS=&#039;-v&#039; &#039;-o&#039; &#039;mysource&#039; &#039;-mfloat-abi=soft&#039; &#039;-mtls-dialect=gnu&#039;
 /usr/lib/gcc/arm-openwrt-linux-uclibcgnueabi/4.8.3/cc1 -quiet -v -imultilib . -imultiarch arm-linux-gnueabi mysource.c -quiet -dumpbase mysource.c -mfloat-abi=soft -mtls-dialect=gnu -auxbase mysource -version -o /tmp/ccojawQz.s
GNU C (OpenWrt GCC 4.8.3) version 4.8.3 (arm-openwrt-linux-uclibcgnueabi)
        compiled by GNU C version 4.8.3, GMP version 4.3.2, MPFR version 2.4.2, MPC version 0.8.1
GGC heuristics: --param ggc-min-expand=30 --param ggc-min-heapsize=4096
ignoring nonexistent directory &quot;/usr/local/include/arm-linux-gnueabi&quot;
ignoring nonexistent directory &quot;/usr/local/include&quot;
ignoring nonexistent directory &quot;/usr/lib/gcc/arm-openwrt-linux-uclibcgnueabi/4.8.3/../../../../arm-openwrt-linux-uclibcgnueabi/include&quot;
ignoring nonexistent directory &quot;/usr/include/arm-linux-gnueabi&quot;
#include &quot;...&quot; search starts here:
#include &lt;...&gt; search starts here:
 /usr/lib/gcc/arm-openwrt-linux-uclibcgnueabi/4.8.3/include
 /usr/lib/gcc/arm-openwrt-linux-uclibcgnueabi/4.8.3/include-fixed
 /usr/include
End of search list.
GNU C (OpenWrt GCC 4.8.3) version 4.8.3 (arm-openwrt-linux-uclibcgnueabi)
        compiled by GNU C version 4.8.3, GMP version 4.3.2, MPFR version 2.4.2, MPC version 0.8.1
GGC heuristics: --param ggc-min-expand=30 --param ggc-min-heapsize=4096
Compiler executable checksum: 15d26b4bf239f8c7940849d852232ad6
COLLECT_GCC_OPTIONS=&#039;-v&#039; &#039;-o&#039; &#039;mysource&#039; &#039;-mfloat-abi=soft&#039; &#039;-mtls-dialect=gnu&#039;
 as -v -mfloat-abi=soft -meabi=5 -o /tmp/ccCYm2i5.o /tmp/ccojawQz.s
GNU assembler version 2.24 (arm-openwrt-linux-uclibcgnueabi) using BFD version (GNU Binutils) 2.24
COMPILER_PATH=/usr/lib/gcc/arm-openwrt-linux-uclibcgnueabi/4.8.3/:/usr/lib/gcc/arm-openwrt-linux-uclibcgnueabi/4.8.3/:/usr/lib/gcc/arm-openwrt-linux-uclibcgnueabi/:/usr/lib/gcc/arm-openwrt-linux-uclibcgnueabi/4.8.3/:/usr/lib/gcc/arm-openwrt-linux-uclibcgnueabi/
LIBRARY_PATH=/usr/lib/gcc/arm-openwrt-linux-uclibcgnueabi/4.8.3/:/usr/lib/gcc/arm-openwrt-linux-uclibcgnueabi/4.8.3/../../../:/lib/:/usr/lib/
COLLECT_GCC_OPTIONS=&#039;-v&#039; &#039;-o&#039; &#039;mysource&#039; &#039;-mfloat-abi=soft&#039; &#039;-mtls-dialect=gnu&#039;
 /usr/lib/gcc/arm-openwrt-linux-uclibcgnueabi/4.8.3/collect2 --eh-frame-hdr -dynamic-linker /lib/ld-uClibc.so.0 -X -m armelf_linux_eabi -o mysource /usr/lib/gcc/arm-openwrt-linux-uclibcgnueabi/4.8.3/crt1.o /usr/lib/gcc/arm-openwrt-linux-uclibcgnueabi/4.8.3/crti.o /usr/lib/gcc/arm-openwrt-linux-uclibcgnueabi/4.8.3/crtbegin.o -L/usr/lib/gcc/arm-openwrt-linux-uclibcgnueabi/4.8.3 -L/usr/lib/gcc/arm-openwrt-linux-uclibcgnueabi/4.8.3/../../.. /tmp/ccCYm2i5.o -lgcc_s -lc -lgcc_s /usr/lib/gcc/arm-openwrt-linux-uclibcgnueabi/4.8.3/crtend.o /usr/lib/gcc/arm-openwrt-linux-uclibcgnueabi/4.8.3/crtn.o</code></pre></div>											<p class="post-edited">(Last edited by <strong>OpenUser</strong> on 6 May 2016, 18:39)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p322779">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Max Hopper</div>
					<div class="post-datetime">
						6 May 2016, 19:31					</div>
				</div>
				<div class="post-content content">
					<p>The topic is not relevant to OpenWrt. Start <a href="https://stackoverflow.com/">here</a>.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p322783">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">OpenUser</div>
					<div class="post-datetime">
						6 May 2016, 19:53					</div>
				</div>
				<div class="post-content content">
					<p>But this is a OW package.<br />I&#039;ll probably ask the maintainer: Christian Beier</p><div class="quotebox"><blockquote><p># opkg info gcc<br />Package: gcc<br />Version: 4.8.3-1<br />Depends: libc, binutils, libstdcpp<br />Status: install user installed<br />Section: devel<br />Architecture: mvebu<br />Maintainer: Christian Beier &lt;cb[a_t]shoutrlabs.com&gt;<br />MD5Sum: e945fe1b5a2265263ad76ad1c859282e<br />Size: 20123737<br />Filename: gcc_4.8.3-1_mvebu.ipk<br />Source: feeds/packages/devel/gcc<br />Description: build a native toolchain for compiling on target<br />Installed-Time: 1462466890</p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p322800">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Max Hopper</div>
					<div class="post-datetime">
						6 May 2016, 22:24					</div>
				</div>
				<div class="post-content content">
					<p>Kaspersky A/V runs on Windoze. For issues with the package does one contact M$?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324990">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">OpenUser</div>
					<div class="post-datetime">
						20 May 2016, 18:08					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Max Hopper wrote:</cite><blockquote><p>The topic is not relevant to OpenWrt. Start <a href="https://stackoverflow.com/">here</a>.</p></blockquote></div><p>Max I&#039;ve followed your advice and post my question on&nbsp; <a href="https://stackoverflow.com/questions/37239569/how-to-compile-with-gcc-inside-openwrt">stackoverflow</a> and after few days of &quot;nothing&quot; I found the answer be myself...</p><br /><p>This is the way it was working for me.<br /></p><div class="quotebox"><blockquote><p>gcc -mabi=aapcs-linux mysource.c -o myprogram</p></blockquote></div>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>