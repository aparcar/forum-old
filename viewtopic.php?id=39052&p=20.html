<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> mwan3; multi-wan policy routing (general topic)</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 22 May 2013 and 6 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 20 of 65</div><nav><ul><li><a href="viewtopic.php%3Fid=39052&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=39052&amp;p=18.html">18</a></li><li><a href="viewtopic.php%3Fid=39052&amp;p=19.html">19</a></li><li class="pagination-current"><span>20</span></li><li><a href="viewtopic.php%3Fid=39052&amp;p=21.html">21</a></li><li><a href="viewtopic.php%3Fid=39052&amp;p=22.html">22</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=39052&amp;p=65.html">65</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p212039">
				<div class="post-metadata">
					<div class="post-num">Post #476</div>
					<div class="post-author">Ramesh_P</div>
					<div class="post-datetime">
						10 Sep 2013, 18:36					</div>
				</div>
				<div class="post-content content">
					<p>Hi Adze,</p><br /><p>Yes now its seems to be working, after disabling multi wan package.</p><p>and also in MWAN3 Multi-wan page(gui)&nbsp; i could see both interfaces are online.</p><p>I&#039;m very much new to this please help to complete this task.</p><p>now tell me how to test wheather mwan3 is working or not </p><p>Test case:(need test case)<br />=======</p><p>fail over:&nbsp; ????<br />-----------</p><p>load balancing : ????<br />-------------------</p><p>Here trouble shouting commands results.</p><p>root@OpenWrt:/# ping -c 1 -I nas0 <a href="http://www.google.com">www.google.com</a><br />PING <a href="http://www.google.com">www.google.com</a> (74.125.128.99): 56 data bytes<br />64 bytes from 74.125.128.99: seq=0 ttl=44 time=132.718 ms</p><p>--- <a href="http://www.google.com">www.google.com</a> ping statistics ---<br />1 packets transmitted, 1 packets received, 0% packet loss<br />round-trip min/avg/max = 132.718/132.718/132.718 ms<br />root@OpenWrt:/# ping -c 1 -I nas1 <a href="http://www.google.com">www.google.com</a><br />PING <a href="http://www.google.com">www.google.com</a> (74.125.128.105): 56 data bytes<br />64 bytes from 74.125.128.105: seq=0 ttl=44 time=172.723 ms</p><p>--- <a href="http://www.google.com">www.google.com</a> ping statistics ---<br />1 packets transmitted, 1 packets received, 0% packet loss<br />round-trip min/avg/max = 172.723/172.723/172.723 ms</p><p>#############<br />route<br />#############</p><p>root@OpenWrt:/# route -n<br />Kernel IP routing table<br />Destination&nbsp; &nbsp; &nbsp;Gateway&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Genmask&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Flags Metric Ref&nbsp; &nbsp; Use Iface<br />0.0.0.0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;200.200.59.1&nbsp; &nbsp; 0.0.0.0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;UG&nbsp; &nbsp; 10&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; 0 nas0<br />0.0.0.0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;200.200.60.1&nbsp; &nbsp; 0.0.0.0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;UG&nbsp; &nbsp; 20&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; 0 nas1<br />192.168.1.0&nbsp; &nbsp; &nbsp;0.0.0.0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;255.255.255.0&nbsp; &nbsp;U&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; 0 br-lan<br />200.200.59.0&nbsp; &nbsp; 0.0.0.0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;255.255.255.0&nbsp; &nbsp;U&nbsp; &nbsp; &nbsp;10&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; 0 nas0<br />200.200.60.0&nbsp; &nbsp; 0.0.0.0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;255.255.255.0&nbsp; &nbsp;U&nbsp; &nbsp; &nbsp;20&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; 0 nas1</p><p>############<br />ip rule show<br />############</p><p>root@OpenWrt:/# ip rule show<br />0:&nbsp; &nbsp; &nbsp; from all lookup local<br />1001:&nbsp; &nbsp;from all fwmark 0x100/0xff00 lookup 1001<br />1002:&nbsp; &nbsp;from all fwmark 0x200/0xff00 lookup 1002<br />1016:&nbsp; &nbsp;from all fwmark 0x1000/0xff00 lookup 1016<br />1017:&nbsp; &nbsp;from all fwmark 0x1100/0xff00 lookup 1017<br />1018:&nbsp; &nbsp;from all fwmark 0x1200/0xff00 lookup 1018<br />1019:&nbsp; &nbsp;from all fwmark 0x1300/0xff00 lookup 1019<br />1020:&nbsp; &nbsp;from all fwmark 0x1400/0xff00 lookup 1020<br />32766:&nbsp; from all lookup main<br />32767:&nbsp; from all lookup default</p><p>root@OpenWrt:/# ip route list table 1001<br />default via 200.200.59.1 dev nas0</p><p>root@OpenWrt:/# ip route list table 1002<br />default via 200.200.60.1 dev nas1</p><p>root@OpenWrt:/# ip route list table 1016<br />default via 200.200.59.1 dev nas0&nbsp; metric 1</p><p>root@OpenWrt:/# ip route list table 1017<br />default via 200.200.60.1 dev nas1&nbsp; metric 1</p><p>root@OpenWrt:/# ip route list table 1018<br />default&nbsp; metric 1<br />&nbsp; &nbsp; &nbsp; &nbsp; nexthop via 200.200.60.1&nbsp; dev nas1 weight 2<br />&nbsp; &nbsp; &nbsp; &nbsp; nexthop via 200.200.59.1&nbsp; dev nas0 weight 3</p><p>root@OpenWrt:/# ip route list table 1019<br />default via 200.200.59.1 dev nas0&nbsp; metric 1<br />default via 200.200.60.1 dev nas1&nbsp; metric 2</p><p>root@OpenWrt:/# ip route list table 1020<br />default via 200.200.60.1 dev nas1&nbsp; metric 1<br />default via 200.200.59.1 dev nas0&nbsp; metric 2</p><p>##############<br />iptable rules<br />##############</p><br /><p>root@OpenWrt:/# iptables -L mwan3_pre -t mangle -v -n<br />Chain mwan3_pre (2 references)<br /> pkts bytes target&nbsp; &nbsp; &nbsp;prot opt in&nbsp; &nbsp; &nbsp;out&nbsp; &nbsp; &nbsp;source&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;destination<br /> 4069&nbsp; 509K CONNMARK&nbsp; &nbsp;all&nbsp; --&nbsp; *&nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CONNMARK restore mask 0xff00<br />&nbsp; &nbsp;82&nbsp; 6888 MARK&nbsp; &nbsp; &nbsp; &nbsp;all&nbsp; --&nbsp; nas1&nbsp; &nbsp;*&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MARK xset 0x8200/0xff00<br />&nbsp; 187 15352 MARK&nbsp; &nbsp; &nbsp; &nbsp;all&nbsp; --&nbsp; nas0&nbsp; &nbsp;*&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MARK xset 0x8100/0xff00<br /> 1008 72183 mwan3_default&nbsp; all&nbsp; --&nbsp; *&nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mark match 0x0/0xff00<br />&nbsp; 298 24599 mwan3_interfaces&nbsp; all&nbsp; --&nbsp; *&nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mark match 0x0/0xff00<br />&nbsp; &nbsp;13&nbsp; 1227 mwan3_rules&nbsp; all&nbsp; --&nbsp; *&nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mark match 0x0/0xff00</p><p>root@OpenWrt:/# iptables -L mwan3_post -t mangle -v -n<br />Chain mwan3_post (2 references)<br /> pkts bytes target&nbsp; &nbsp; &nbsp;prot opt in&nbsp; &nbsp; &nbsp;out&nbsp; &nbsp; &nbsp;source&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;destination<br />&nbsp; &nbsp;86&nbsp; 7224 MARK&nbsp; &nbsp; &nbsp; &nbsp;all&nbsp; --&nbsp; *&nbsp; &nbsp; &nbsp; nas1&nbsp; &nbsp; 0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mark match ! 0x7f00/0xff00 MARK xset 0x200/0xff00<br />&nbsp; 207 16780 MARK&nbsp; &nbsp; &nbsp; &nbsp;all&nbsp; --&nbsp; *&nbsp; &nbsp; &nbsp; nas0&nbsp; &nbsp; 0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mark match ! 0x7f00/0xff00 MARK xset 0x100/0xff00<br />&nbsp; 305 25204 MARK&nbsp; &nbsp; &nbsp; &nbsp;all&nbsp; --&nbsp; *&nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mark match 0x8000/0x8000 MARK and 0xffff7fff<br /> 4363&nbsp; 544K CONNMARK&nbsp; &nbsp;all&nbsp; --&nbsp; *&nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CONNMARK save mask 0xff00</p><p>root@OpenWrt:/# iptables -L mwan3_default -t mangle -v -n<br />Chain mwan3_default (1 references)<br /> pkts bytes target&nbsp; &nbsp; &nbsp;prot opt in&nbsp; &nbsp; &nbsp;out&nbsp; &nbsp; &nbsp;source&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;destination<br />&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp;0 MARK&nbsp; &nbsp; &nbsp; &nbsp;all&nbsp; --&nbsp; *&nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 224.0.0.0/3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mark match 0x0/0xff00 MARK xset 0x7f00/0xff00<br />&nbsp; &nbsp; 4&nbsp; &nbsp;240 MARK&nbsp; &nbsp; &nbsp; &nbsp;all&nbsp; --&nbsp; *&nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 127.0.0.0/8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mark match 0x0/0xff00 MARK xset 0x7f00/0xff00<br />&nbsp; 514 30736 MARK&nbsp; &nbsp; &nbsp; &nbsp;all&nbsp; --&nbsp; *&nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 192.168.1.0/24&nbsp; &nbsp; &nbsp; &nbsp;mark match 0x0/0xff00 MARK xset 0x7f00/0xff00<br />&nbsp; 134 11256 MARK&nbsp; &nbsp; &nbsp; &nbsp;all&nbsp; --&nbsp; *&nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 200.200.59.0/24&nbsp; &nbsp; &nbsp; mark match 0x0/0xff00 MARK xset 0x7f00/0xff00<br />&nbsp; &nbsp;87&nbsp; 7308 MARK&nbsp; &nbsp; &nbsp; &nbsp;all&nbsp; --&nbsp; *&nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 200.200.60.0/24&nbsp; &nbsp; &nbsp; mark match 0x0/0xff00 MARK xset 0x7f00/0xff00</p><p>root@OpenWrt:/# iptables -L mwan3_rules -t mangle -v -n<br />Chain mwan3_rules (1 references)<br /> pkts bytes target&nbsp; &nbsp; &nbsp;prot opt in&nbsp; &nbsp; &nbsp;out&nbsp; &nbsp; &nbsp;source&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;destination<br />&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp;0 MARK&nbsp; &nbsp; &nbsp; &nbsp;tcp&nbsp; --&nbsp; *&nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;192.168.21.0/24&nbsp; &nbsp; &nbsp; 0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; multiport sports 0:65535 multiport dports 563 mark match 0x0/0xff00 MARK xset 0x1100/0xf<br />f00<br />&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp;0 MARK&nbsp; &nbsp; &nbsp; &nbsp;tcp&nbsp; --&nbsp; *&nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;192.168.21.0/24&nbsp; &nbsp; &nbsp; 0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; multiport sports 0:65535 multiport dports 995 mark match 0x0/0xff00 MARK xset 0x1000/0xf<br />f00<br />&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp;0 MARK&nbsp; &nbsp; &nbsp; &nbsp;tcp&nbsp; --&nbsp; *&nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 88.154.0.0/16&nbsp; &nbsp; &nbsp; &nbsp; multiport sports 0:65535 multiport dports 1024:65535 mark match 0x0/0xff00 statistic mod<br />e random probability 0.60000000009 MARK xset 0x100/0xff00<br />&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp;0 MARK&nbsp; &nbsp; &nbsp; &nbsp;tcp&nbsp; --&nbsp; *&nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 88.154.0.0/16&nbsp; &nbsp; &nbsp; &nbsp; multiport sports 0:65535 multiport dports 1024:65535 mark match 0x0/0xff00 statistic mod<br />e random probability 0.99999999953 MARK xset 0x200/0xff00<br />&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp;0 MARK&nbsp; &nbsp; &nbsp; &nbsp;tcp&nbsp; --&nbsp; *&nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 77.11.41.0/24&nbsp; &nbsp; &nbsp; &nbsp; multiport sports 0:65535 multiport dports 1024:65535 mark match 0x0/0xff00 MARK xset 0x1<br />300/0xff00<br />&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp;0 MARK&nbsp; &nbsp; &nbsp; &nbsp;udp&nbsp; --&nbsp; *&nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 112.136.0.0/16&nbsp; &nbsp; &nbsp; &nbsp;multiport sports 0:65535 multiport dports 5352 mark match 0x0/0xff00 MARK xset 0x1400/0x<br />ff00<br />&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp;0 MARK&nbsp; &nbsp; &nbsp; &nbsp;all&nbsp; --&nbsp; *&nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mark match 0x0/0xff00 MARK xset 0x1200/0xff00</p><br /><br /><p>thanks in advance.</p>											<p class="post-edited">(Last edited by <strong>Ramesh_P</strong> on 10 Sep 2013, 18:37)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p212042">
				<div class="post-metadata">
					<div class="post-num">Post #477</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						10 Sep 2013, 19:30					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Ramesh_P wrote:</cite><blockquote><p>I&#039;m very much new to this please help to complete this task. Now tell me how to test wheather mwan3 is working or not.</p></blockquote></div><br /><p>Please take some time and read through this topic and the wiki. It has a lot of info on this.</p><p>Thnx</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p212229">
				<div class="post-metadata">
					<div class="post-num">Post #478</div>
					<div class="post-author">n_dandanov</div>
					<div class="post-datetime">
						13 Sep 2013, 02:50					</div>
				</div>
				<div class="post-content content">
					<p>Hello, Adze,</p><p>Sorry for my late response. Once again, thank You a lot for all the support!<br />Currently I&#039;m using openDNS service in order to avoid the mentioned issue.<br />However, wouldn&#039;t adding a DNS server &quot;binding&quot; option to the mwan package be a good idea? When there&#039;s an event and we&#039;re about to route traffic through one of the interfaces, we would also change the DNS configuration file to use the DNS servers provided by the ISP, connected to that same interface. Or perhaps changes should be made obly when a link goes down?</p><p>Best regards,<br />Nickolay</p><div class="quotebox"><cite>Adze wrote:</cite><blockquote><p>Just a small note on dns and mwan3. If you use the dns servers from your isp, it is very common that resolving fails if you try it with a wan interface (source ip address) that is not from that specific provider. I recommend to use opendns or google&#039;s dns service as they work from any ip address. It is not an mwan3 issue.</p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p212589">
				<div class="post-metadata">
					<div class="post-num">Post #479</div>
					<div class="post-author">Thomymaster</div>
					<div class="post-datetime">
						17 Sep 2013, 11:12					</div>
				</div>
				<div class="post-content content">
					<p>Another question, is the loopback trick (in rc.local) still needed in the current build to load-balance traffic coming from the router itself?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p212595">
				<div class="post-metadata">
					<div class="post-num">Post #480</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						17 Sep 2013, 12:24					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Thomymaster wrote:</cite><blockquote><p>Another question, is the loopback trick (in rc.local) still needed in the current build to load-balance traffic coming from the router itself?</p></blockquote></div><p>Short answer is no...</p><p>You can now use the reroute interface option to also load-balance traffic originating from the wan interface itself. However, the source ip adres of a packet originating from the router itself will be the ip address of the interface with the lowest metric default route in the main routing table. If that packet is load-balanced and leaves another wan interface it then gets natted.</p><p>If you wish to use an alternative source ip address (eg. loopback), you still need the loopback trick.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p212672">
				<div class="post-metadata">
					<div class="post-num">Post #481</div>
					<div class="post-author">Thomymaster</div>
					<div class="post-datetime">
						18 Sep 2013, 10:49					</div>
				</div>
				<div class="post-content content">
					<p>Sorry Adze but i don&#039;t unterstand properly.</p><p>I have interface &#039;wan&#039; with a interface metric of 20 and interface &#039;wwan&#039; with a interface metric of 10. <br />Or are you talkin about the metric in the mwan3 config?</p><div class="codebox"><pre><code>config rule &#039;default&#039;
        option proto &#039;all&#039;
        option use_policy &#039;wan_pri_wwan_sec&#039;
        option dest_ip &#039;0.0.0.0/0&#039;

config interface &#039;wan&#039;
        option enabled &#039;1&#039;
        option reliability &#039;1&#039;
        option count &#039;1&#039;
        option timeout &#039;2&#039;
        option interval &#039;5&#039;
        option down &#039;3&#039;
        option up &#039;3&#039;
        list track_ip &#039;173.194.69.94&#039;
        list track_ip &#039;8.8.8.8&#039;

config interface &#039;wwan&#039;
        option enabled &#039;1&#039;
        option reliability &#039;1&#039;
        option count &#039;1&#039;
        option timeout &#039;2&#039;
        option interval &#039;5&#039;
        option down &#039;3&#039;
        option up &#039;3&#039;
        list track_ip &#039;173.194.69.94&#039;
        list track_ip &#039;8.8.8.8&#039;

config member &#039;wwan_m1_w1&#039;
        option interface &#039;wwan&#039;
        option metric &#039;1&#039;
        option weight &#039;1&#039;

config member &#039;wwan_m2_w1&#039;
        option interface &#039;wwan&#039;
        option metric &#039;2&#039;
        option weight &#039;1&#039;

config policy &#039;wan_pri_wwan_sec&#039;
        list use_member &#039;wan_m1_w1&#039;
        list use_member &#039;wwan_m2_w1&#039;

config member &#039;wan_m2_w1&#039;
        option interface &#039;wan&#039;
        option metric &#039;2&#039;
        option weight &#039;1&#039;

config member &#039;wan_m1_w1&#039;
        option interface &#039;wan&#039;
        option metric &#039;1&#039;
        option weight &#039;1&#039;</code></pre></div><p>This config should be used for failover from wan to wwan which works.</p><p>So what do you mean with:</p><p>&quot;However, the source ip adres of a packet originating from the router itself will be the ip address of the interface with the lowest metric default route in the main routing table. If that packet is load-balanced and leaves another wan interface it then gets natted.&quot;</p><p>So traffic from my subnet is load-balanced normally and has the source IP of the wan interface as well as router traffic. When the router switches to wwan, the normal traffic has the source IP of the wwan interface, but router traffic still has the source IP of the wan interface but leaves the router through the wwan interface?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p212733">
				<div class="post-metadata">
					<div class="post-num">Post #482</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						19 Sep 2013, 00:13					</div>
				</div>
				<div class="post-content content">
					<p>Hi Thomymaster,</p><br /><p>Let me try to explain with an example. Imagine we have a router with two wan interfaces (wan1 and wan2) with ip addresses 1.1.1.1 and 2.2.2.2. These are configured in the network config with metrics 10 and 20. Now we want to telnet to 3.3.3.3 from the router.</p><p>Before a packet can be routed, it first has to be created. We know the destination address, but we don&#039;t know the source yet. The kernel determines it based on the main routing table.</p><p>In our example wan1 has the lowest metric default gateway, so the source ip address is set to 1.1.1.1. If you were to set the default gateway with the loopback trick, the source ip address of the created packets will then be the ip address you gave it. This is very important for creating mwan3 rules, as this address is used as the src-ip value. Now the packet is routed using the custom mwan3 rules and routes.</p><p>So what does the option reroute do?</p><p>A newly router originated packet with an ip address of a wan interface, is per default always routed out that interface. If you set the reroute option to &quot;1&quot;, mwan3 will also load-balance that packet based on the rules.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p212746">
				<div class="post-metadata">
					<div class="post-num">Post #483</div>
					<div class="post-author">garretwcox</div>
					<div class="post-datetime">
						19 Sep 2013, 08:44					</div>
				</div>
				<div class="post-content content">
					<p>Hi everyone, I&#039;m having a very strange issue.<br />Load balancing, failover, all seems to work marvelously from within and behind the mwan3 test router. (AWESOME work by the way). However, the router cannot ping or be pinged by other clients in the wan subnet besides the gateway.</p><p>Here&#039;s my layout:<br />Gateway to the internet:10.0.77.1</p><p>Desktop: 10.0.77.2</p><p>Mwan3 test router: <br />WAN1: 10.0.77.3<br />USBWAN: 192.168.32.10<br />LAN: 192.168.1.1</p><p>Laptop: 192.168.1.2</p><p>The ONLY issue I have is when I ping the mwan3 router from the deskop, I get no replies.<br />When I ping the desktop from the mwan3 router.. I get EXACTLY ONE reply, then no more. Crazy huh! I&#039;ve never seen that before!</p><p>Even more crazy..EVERYTHING ELSE WORKS.<br />The Laptop behind the mwan3 router can ping everyone.<br />The mwan3 router can ping the gateway! The gateway can ping the mwan3 router!</p><p>Now, I know what you are thinking: same thing I was: the problem is the desktop!<br />Nope....I actually have several machines, running several different OSes, in the 10.0.77.0/24 subnet, and they all show the exact same symptoms.<br />Furthermore, I can make the issue go away by simply setting &quot;Enabled&quot; to &quot;no&quot; in the mwan3 interfaces config for wan1.</p><p>I&#039;ve already tested this with and without reroute enabled on both interfaces.</p><p>does anyone have any ideas? Here&#039;s the info from the troubleshooting page:<br /></p><div class="codebox"><pre><code>Software versions : 

OpenWrt - OpenWrt Attitude Adjustment 12.09 (r36088)
mwan3 - 1.2-17
luci-app-mwan3 - 1.1-13

Firewall default output policy (must be ACCEPT) : 

ACCEPT

Output of &quot;ip route show&quot; : 

default via 192.168.32.2 dev eth2  proto static 
default via 10.0.77.1 dev eth1  proto static  metric 10 
10.0.77.0/24 dev eth1  proto static  scope link  metric 10 
192.168.1.0/24 dev br-lan  proto kernel  scope link  src 192.168.1.1 
192.168.32.0/24 dev eth2  proto kernel  scope link  src 192.168.32.10

Output of &quot;ip rule show&quot; : 

0:    from all lookup local 
1001:    from all fwmark 0x100/0xff00 lookup 1001 
1002:    from all fwmark 0x200/0xff00 lookup 1002 
1016:    from all fwmark 0x1000/0xff00 lookup 1016 
1017:    from all fwmark 0x1100/0xff00 lookup 1017 
1018:    from all fwmark 0x1200/0xff00 lookup 1018 
1019:    from all fwmark 0x1300/0xff00 lookup 1019 
1020:    from all fwmark 0x1400/0xff00 lookup 1020 
32766:    from all lookup main 
32767:    from all lookup default

Output of &quot;ip route list table 1001-1099&quot; (1001-1015 = interface tables, 1016-1099 = policy tables) : 

1001
default via 10.0.77.1 dev eth1 
1002
default via 192.168.32.2 dev eth2 
1016
default via 10.0.77.1 dev eth1  metric 1 
1017
default via 192.168.32.2 dev eth2  metric 1 
1018
default  metric 1 
    nexthop via 192.168.32.2  dev eth2 weight 2
    nexthop via 10.0.77.1  dev eth1 weight 3
1019
default via 10.0.77.1 dev eth1  metric 1 
default via 192.168.32.2 dev eth2  metric 2 
1020
default via 192.168.32.2 dev eth2  metric 1 
default via 10.0.77.1 dev eth1  metric 2

Output of &quot;iptables -L -t mangle -v -n | awk &#039;/mwan3/&#039; RS=&quot; : 

Chain PREROUTING (policy ACCEPT 3794 packets, 644K bytes)
 pkts bytes target     prot opt in     out     source               destination         
 3947  695K mwan3_pre  all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain INPUT (policy ACCEPT 2705 packets, 287K bytes)
 pkts bytes target     prot opt in     out     source               destination         
 2779  296K mwan3_post  all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain OUTPUT (policy ACCEPT 2540 packets, 581K bytes)
 pkts bytes target     prot opt in     out     source               destination         
 2599  585K mwan3_pre  all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain POSTROUTING (policy ACCEPT 3002 packets, 719K bytes)
 pkts bytes target     prot opt in     out     source               destination         
 3126  761K mwan3_post  all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain mwan3_default (1 references)
 pkts bytes target     prot opt in     out     source               destination         
  114  6161 MARK       all  --  *      *       0.0.0.0/0            224.0.0.0/3         mark match 0x0/0xff00 MARK xset 0x7f00/0xff00 
    0     0 MARK       all  --  *      *       0.0.0.0/0            127.0.0.0/8         mark match 0x0/0xff00 MARK xset 0x7f00/0xff00 
    0     0 MARK       all  --  *      *       0.0.0.0/0            10.0.77.0/24        mark match 0x0/0xff00 MARK xset 0x7f00/0xff00 
  161  9132 MARK       all  --  *      *       0.0.0.0/0            192.168.1.0/24      mark match 0x0/0xff00 MARK xset 0x7f00/0xff00 
    0     0 MARK       all  --  *      *       0.0.0.0/0            192.168.32.0/24     mark match 0x0/0xff00 MARK xset 0x7f00/0xff00 

Chain mwan3_post (2 references)
 pkts bytes target     prot opt in     out     source               destination         
  585 45312 MARK       all  --  *      eth2    0.0.0.0/0            0.0.0.0/0           mark match !0x7f00/0xff00 MARK xset 0x200/0xff00 
 1062  143K MARK       all  --  *      eth1    0.0.0.0/0            0.0.0.0/0           mark match !0x7f00/0xff00 MARK xset 0x100/0xff00 
 1807  240K MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0           mark match 0x8000/0x8000 MARK and 0xffff7fff 
 5905 1058K CONNMARK   all  --  *      *       0.0.0.0/0            0.0.0.0/0           CONNMARK save mask 0xff00 

Chain mwan3_pre (2 references)
 pkts bytes target     prot opt in     out     source               destination         
 6546 1280K CONNMARK   all  --  *      *       0.0.0.0/0            0.0.0.0/0           CONNMARK restore mask 0xff00 
  714 93234 MARK       all  --  eth2   *       0.0.0.0/0            0.0.0.0/0           MARK xset 0x8200/0xff00 
 1613  361K MARK       all  --  eth1   *       0.0.0.0/0            0.0.0.0/0           MARK xset 0x8100/0xff00 
 1373  109K mwan3_default  all  --  *      *       0.0.0.0/0            0.0.0.0/0           mark match 0x0/0xff00 
 1078 91538 mwan3_wan  all  --  *      *       0.0.0.0/0            0.0.0.0/0           mark match 0x0/0xff00 
 1078 91538 mwan3_rules  all  --  *      *       0.0.0.0/0            0.0.0.0/0           mark match 0x0/0xff00 

Chain mwan3_rules (1 references)
 pkts bytes target     prot opt in     out     source               destination         
 1058 89122 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0           mark match 0x0/0xff00 MARK xset 0x1300/0xff00 

Chain mwan3_wan (1 references)
 pkts bytes target     prot opt in     out     source               destination

Output of &quot;ifconfig&quot; : 

br-lan    Link encap:Ethernet  HWaddr 76:44:01:93:57:DB  
          inet addr:192.168.1.1  Bcast:192.168.1.255  Mask:255.255.255.0
          inet6 addr: fe80::7444:1ff:fe93:57db/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:6912 errors:0 dropped:0 overruns:0 frame:0
          TX packets:6468 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:1244701 (1.1 MiB)  TX bytes:3710324 (3.5 MiB)

eth0      Link encap:Ethernet  HWaddr 76:44:01:93:57:DB  
          inet6 addr: fe80::7444:1ff:fe93:57db/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:7066 errors:0 dropped:6 overruns:23 frame:0
          TX packets:6461 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:1385466 (1.3 MiB)  TX bytes:3735767 (3.5 MiB)
          Interrupt:4 

eth0.1    Link encap:Ethernet  HWaddr 76:44:01:93:57:DB  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:7026 errors:0 dropped:0 overruns:0 frame:0
          TX packets:6452 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:1254158 (1.1 MiB)  TX bytes:3708228 (3.5 MiB)

eth1      Link encap:Ethernet  HWaddr 74:44:01:93:57:DC  
          inet addr:10.0.77.3  Bcast:10.0.77.255  Mask:255.255.255.0
          inet6 addr: fe80::7644:1ff:fe93:57dc/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:9160 errors:0 dropped:0 overruns:0 frame:0
          TX packets:4931 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:3484445 (3.3 MiB)  TX bytes:986477 (963.3 KiB)
          Interrupt:5 

eth2      Link encap:Ethernet  HWaddr D0:57:85:74:9F:1E  
          inet addr:192.168.32.10  Bcast:192.168.32.255  Mask:255.255.255.0
          inet6 addr: 2600:1005:b10a:a5c6:d257:85ff:fe74:9f1e/64 Scope:Global
          inet6 addr: fe80::d257:85ff:fe74:9f1e/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:1849 errors:0 dropped:0 overruns:0 frame:0
          TX packets:1523 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:236730 (231.1 KiB)  TX bytes:157509 (153.8 KiB)

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:34 errors:0 dropped:0 overruns:0 frame:0
          TX packets:34 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:3469 (3.3 KiB)  TX bytes:3469 (3.3 KiB)

Output of &quot;cat /etc/config/mwan3&quot; : 

config interface &#039;wan1&#039;
    option reliability &#039;2&#039;
    option count &#039;1&#039;
    option timeout &#039;2&#039;
    option interval &#039;5&#039;
    option down &#039;3&#039;
    option up &#039;8&#039;
    list track_ip &#039;8.8.8.8&#039;
    list track_ip &#039;4.2.2.3&#039;
    list track_ip &#039;208.67.222.222&#039;
    option reroute &#039;1&#039;
    option enabled &#039;1&#039;

config interface &#039;usbwan&#039;
    option enabled &#039;1&#039;
    option count &#039;1&#039;
    option timeout &#039;2&#039;
    option interval &#039;5&#039;
    option down &#039;3&#039;
    option up &#039;8&#039;
    option reliability &#039;2&#039;
    option reroute &#039;1&#039;
    list track_ip &#039;8.8.4.4&#039;
    list track_ip &#039;4.2.2.4&#039;
    list track_ip &#039;208.67.220.220&#039;

config member &#039;wan1_m1_w3&#039;
    option interface &#039;wan1&#039;
    option metric &#039;1&#039;
    option weight &#039;3&#039;

config member &#039;wan1_m2_w3&#039;
    option interface &#039;wan1&#039;
    option metric &#039;2&#039;
    option weight &#039;3&#039;

config member &#039;wan2_m1_w2&#039;
    option interface &#039;usbwan&#039;
    option metric &#039;1&#039;
    option weight &#039;2&#039;

config member &#039;wan2_m2_w2&#039;
    option interface &#039;usbwan&#039;
    option metric &#039;2&#039;
    option weight &#039;2&#039;

config policy &#039;wan1_only&#039;
    list use_member &#039;wan1_m1_w3&#039;

config policy &#039;wan2_only&#039;
    list use_member &#039;wan2_m1_w2&#039;

config policy &#039;wan1_wan2_loadbalanced&#039;
    list use_member &#039;wan1_m1_w3&#039;
    list use_member &#039;wan2_m1_w2&#039;

config policy &#039;wan1_pri_wan2_sec&#039;
    list use_member &#039;wan1_m1_w3&#039;
    list use_member &#039;wan2_m2_w2&#039;

config policy &#039;wan2_pri_wan1_sec&#039;
    list use_member &#039;wan1_m2_w3&#039;
    list use_member &#039;wan2_m1_w2&#039;

config rule &#039;rule6&#039;
    option dest_ip &#039;0.0.0.0/0&#039;
    option proto &#039;all&#039;
    option use_policy &#039;wan1_pri_wan2_sec&#039;

Output of &quot;cat /etc/config/network&quot; : 

config interface &#039;loopback&#039;
    option ifname &#039;lo&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;127.0.0.1&#039;
    option netmask &#039;255.0.0.0&#039;

config interface &#039;lan&#039;
    option ifname &#039;eth0.1&#039;
    option type &#039;bridge&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;192.168.1.1&#039;
    option netmask &#039;255.255.255.0&#039;

config interface &#039;wan1&#039;
    option ifname &#039;eth1&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;10.0.77.3&#039;
    option netmask &#039;255.255.255.0&#039;
    option gateway &#039;10.0.77.1&#039;
    option dns &#039;8.8.8.8&#039;
    option metric &#039;10&#039;

config switch
    option name &#039;rtl8366s&#039;
    option reset &#039;1&#039;
    option enable_vlan &#039;1&#039;
    option blinkrate &#039;2&#039;

config switch_vlan
    option device &#039;rtl8366s&#039;
    option vlan &#039;1&#039;
    option ports &#039;0 1 2 3 5t&#039;

config switch_port
    option device &#039;rtl8366s&#039;
    option port &#039;1&#039;
    option led &#039;6&#039;

config switch_port
    option device &#039;rtl8366s&#039;
    option port &#039;2&#039;
    option led &#039;9&#039;

config switch_port
    option device &#039;rtl8366s&#039;
    option port &#039;5&#039;
    option led &#039;2&#039;

config interface &#039;usbwan&#039;
    option ifname &#039;eth2&#039;
    option _orig_ifname &#039;eth2&#039;
    option _orig_bridge &#039;false&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;192.168.32.10&#039;
    option netmask &#039;255.255.255.0&#039;
    option gateway &#039;192.168.32.2&#039;
    option dns &#039;8.8.4.4&#039;
    option accept_ra &#039;1&#039;</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p212753">
				<div class="post-metadata">
					<div class="post-num">Post #484</div>
					<div class="post-author">Thomymaster</div>
					<div class="post-datetime">
						19 Sep 2013, 10:30					</div>
				</div>
				<div class="post-content content">
					<p>OK so if i get this correctly, then i just have to set reroute to 1 and the router generated traffic (i.e. dns and ddns updates) is routed via mwan3.</p><p>wan: 10.0.0.1<br />wwan: 10.0.1.1</p><p>So normally the source IP of the packets are 10.0.0.1 and when the wan line goes down, they are rewritten to 10.0.1.1 as they go out over the wwan interface. Or is the source IP still 10.0.0.1 and they are NATed via wwan?</p><p>Is that right? <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><br /><p>Cheers Thomy</p>											<p class="post-edited">(Last edited by <strong>Thomymaster</strong> on 19 Sep 2013, 10:32)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p212765">
				<div class="post-metadata">
					<div class="post-num">Post #485</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						19 Sep 2013, 13:02					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Thomymaster wrote:</cite><blockquote><p>OK so if i get this correctly, then i just have to set reroute to 1 and the router generated traffic (i.e. dns and ddns updates) is routed via mwan3.</p><p>wan: 10.0.0.1<br />wwan: 10.0.1.1</p><p>So normally the source IP of the packets are 10.0.0.1 and when the wan line goes down, they are rewritten to 10.0.1.1 as they go out over the wwan interface. Or is the source IP still 10.0.0.1 and they are NATed via wwan?</p><p>Is that right? <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><br /><p>Cheers Thomy</p></blockquote></div><p>The source IP is still 10.0.0.1 and they are indeed NATted via wwan.</p>											<p class="post-edited">(Last edited by <strong>Adze</strong> on 19 Sep 2013, 13:02)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p212766">
				<div class="post-metadata">
					<div class="post-num">Post #486</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						19 Sep 2013, 13:06					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>garretwcox wrote:</cite><blockquote><p>The ONLY issue I have is when I ping the mwan3 router from the deskop, I get no replies.<br />When I ping the desktop from the mwan3 router.. I get EXACTLY ONE reply, then no more. Crazy huh! I&#039;ve never seen that before!</p></blockquote></div><p>I will have to test this myself. It should work and your config looks ok-ish. You&#039;re only lacking a metric for your usbwan interface in your network config.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p212832">
				<div class="post-metadata">
					<div class="post-num">Post #487</div>
					<div class="post-author">garretwcox</div>
					<div class="post-datetime">
						20 Sep 2013, 04:55					</div>
				</div>
				<div class="post-content content">
					<p>Oh yeah, I had one, but I guess I lost it when I swapped usbwan from dchp to static while testing out different configs</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p212836">
				<div class="post-metadata">
					<div class="post-num">Post #488</div>
					<div class="post-author">garretwcox</div>
					<div class="post-datetime">
						20 Sep 2013, 08:48					</div>
				</div>
				<div class="post-content content">
					<p>Okay, more details:<br />1. I was wrong about the laptop behind the mwan3 router being okay: I was just doing a single ping to test at first. It&#039;s actually exhibiting the same symptoms as pinging directly from the mwan3 router: 1 ping, then no more.</p><p>2. tracert from the desktop to the mwan3 router goes directly to 10.0.77.3<br />HOWEVER tracert from the laptop behind the mwan3 router (192.168.1.2) to the desktop (10.0.77.2) goes:<br />192.168.1.1 (okay, that makes sense, that&#039;s the mwan3 router)<br />10.0.77.1 (wtf!? why is it going to the gateway for an address in the same subnet as wan1?)<br />10.0.77.2</p><p>So...for shits and giggles, I got on the gateway (10.0.77.1) and set the LAN firewall zone to accept forward. Lo and behold...I can ping both ways again. This confirms that pings coming from the mwan3 router (10.0.77.3) think they have to hit the gateway (10.0.77.1) to get to the the 10.0.77.0/24 subnet. Everything else in 10.0.77.0/24 knows it can ping 10.0.77.3 directly, but they weren&#039;t getting the return pings since 10.0.77.3 was trying to route them through 10.0.77.1 and the firewall wasn&#039;t routing them. </p><p>Just as a third confirmation, all I have to do is to disable wan1 in the mwan3 config, and sure enough, a tracert from the laptop goes:<br />192.168.1.1<br />10.0.77.2</p><p>So....what in the world is causing the gateway to route this way? When I look at the routes under the mwan3 troubleshooting page or the status-&gt;routes page, everything looks correct: in fact, they look the same whether wan1 is enabled in mwan3 or not.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p213080">
				<div class="post-metadata">
					<div class="post-num">Post #489</div>
					<div class="post-author">dir2cas</div>
					<div class="post-datetime">
						24 Sep 2013, 17:11					</div>
				</div>
				<div class="post-content content">
					<p>Hello Adze, I had a view on your project for a long time and came out with my own customized multiwan solution taking some of the main features of mwan2/3. However, my solution is limited to tracking/operation only with 2 WAN interface and is based on my particular setup, which makes it quite uncompetitive and far behind mwan3 functionality.</p><p>However, one of the main advantages of my solution is the email notification ability and the correction of /tmp/resolv.conf.auto file (removing/adding the relevant DNS servers according to the WAN interfaces that are&nbsp; currently up and running).</p><p>I think, it will be nice to have an email notification working as an optional feature in mwan3.<br />Here is a sample configuration used in my script to send email notifications. It is based on ssmtp (very thin mail user agent). The main idea is that my code generates the whole configuration needed, does a backup of the original configuration and makes a custom conf. file, because ssmtp may operate with multiple configuration files at the same time. thus allowing to have multiple send/notification prifiles etc.</p><p>I am posting a short snippet of my code, including the variables, defined in the beginning, the email notify function and a sample call of the function.<br /></p><div class="codebox"><pre><code># DEFINING VARIABLES
# Init start
START=99
SCRIPTNAME=&quot;mwan3&quot;
LOG_MESSAGE=&quot;/tmp/${SCRIPTNAME}.msg&quot;

# Email client settings (needed only if EMAIL_NOTIFY=&quot;1&quot;):
HOSTNAME=&quot;hostname&quot;
EMAIL_NOTIFY=&quot;1&quot; # Enable (1) / Disable (0) email notification on failover actions
EMAIL_CLIENT=&quot;ssmtp&quot; # The MUA (Mail user agent)
EMAIL_CLIENT_CONF=&quot;/etc/ssmtp/ssmtp_mwan3.conf&quot; # Where the configuration of the mail clients resides in
EMAIL_USER=&quot;myuser@gmail.com&quot; # The actual email account that is sending the email
EMAIL_PASSWD=&quot;mypassword&quot;   # your email account password
SMTP_SERVER=&quot;smtp.gmail.com&quot; # Outgoing mail server
DST_PORT=&quot;465&quot; # Destiantion port used by the mail client (smtp port is 25 by default, without encryption)
EMAIL_DOMAIN=&quot;gmail.com&quot; # Domain of the mail server
EMAIL_CLIENT_TLS=&quot;YES&quot;     # &quot;YES&quot; or &quot;NO&quot; are valid options
EMAIL_SUBJECT=&quot;MY Network WAN status change&quot; # Subject of the email message
# List of Email notification recipients
EMAIL_TO=&quot;user1@domain1.com user2@domain2.com&quot;
EMAIL_SIGNATURE=&quot;Best Regards, OpenWrt&quot;

########################################
# THE EMAIL FUNCTION ITSELF GENERATING THE CONFIGURATION OF THE EMAIL CLIENT AND SENDING THE ACTUAL MESSAGE USING
# THE PREDEFINED VARIABLES THAT COULD BE ALSO GET FROM AN EXTERNAL CONF FILE
EmailNotify() {
# Check if the MUA is installed
if [ ! -x &quot;${EMAIL_CLIENT}&quot; ]; then logger -s -t ${SCRIPTNAME} &quot;Warning: Email client ${EMAIL_CLIENT} is not installed or configured on the system&quot;; return 2; fi

# Checking if the Email client has already been configured for our account
sleep 1
#LOG_MESSAGE=&quot;${@}&quot;
grep -e &quot;${SCRIPTNAME}&quot; ${EMAIL_CLIENT_CONF} &amp;&gt; /dev/null || {
    # Backing up if there is some old configuration first
    cp ${EMAIL_CLIENT_CONF} ${EMAIL_CLIENT_CONF}.backup &gt; /dev/null 2&gt;&amp;1
    # Writing the Email Client configuration (SSMTP)
    echo -e &quot;# ${EMAIL_CLIENT_CONF} -- a configuration file for sSMTP sendmail.\n###generated by ${SCRIPTNAME}\nroot=${EMAIL_USER}\nmailhub=${SMTP_SERVER}:${DST_PORT}\nrewriteDomain=${EMAIL_DOMAIN}\nhostname=${HOSTNAME}\nFromLineOverride=YES\nUseTLS=${EMAIL_CLIENT_TLS}\nAuthUser=${EMAIL_USER}\nAuthPass=${EMAIL_PASSWD}&quot; &gt; ${EMAIL_CLIENT_CONF}
    }

# Composing the Email message and pipe it to the smtp client in order to be sent
sleep 1
echo -e &quot;From: &lt;${EMAIL_USER}&gt;\nSubject: ${EMAIL_SUBJECT}\n\n${HOSTNAME} alert notification message.\n$(cat &quot;${LOG_MESSAGE}&quot;)\n\n${EMAIL_SIGNATURE}&quot; | $(which $(echo &quot;${EMAIL_CLIENT}&quot;)) -C ${EMAIL_CLIENT_CONF} ${EMAIL_TO}
sleep 1
logger -s -t ${SCRIPTNAME} &quot;Sending email alert notification to $(echo &quot;${EMAIL_TO}&quot;|sed &quot;s/ /,/g&quot;)&quot;
unset EMAIL_PASSWD
unset LOG_MESSAGE
rm -f ${LOG_MESSAGE} &amp;&gt; /dev/null
}

########################################
# SAMPLE CALL OF EMAIL FUNCTION
if [ &quot;${EMAIL_NOTIFY}&quot; -eq &quot;1&quot; ]; then echo -e &quot;Sending email notification to a list of predefined recipients&quot;; sleep 10; EmailNotify &quot;${LOG_MESSAGE}&quot;; fi</code></pre></div><p>Here is an example of how those variables could be placed in the mwan3 configuration file (/etc/config/mwan3). As I am not using the openwrt internal functions (like config_get, etc), I think that you will have no troubles if you like to integrate this function in your code.<br /></p><div class="codebox"><pre><code>config &#039;email_notify&#039; &#039;gmail&#039;
    option &#039;enabled&#039; &#039;1&#039;  # Enable (1) / Disable (0) email notification on failover actions
    option &#039;hostname&#039; &#039;myhostname&#039; 
    option &#039;client&#039; &#039;ssmtp&#039;  # The MUA (Mail user agent)
    option &#039;client_conf&#039; &#039;/etc/ssmtp/ssmtp_mwan3.conf&#039;  # Where the configuration of the mail clients resides in
    option &#039;user&#039; &#039;myuser@gmail.com&#039;   # The actual email account that is sending the email
    option &#039;passwd&#039; &#039;mypassword&#039;         # your email account password
    option &#039;smtp_server&#039; &#039;smtp.gmail.com&#039;  # Outgoing mail server
    option &#039;dst_port&#039; &#039;465&#039; # Destiantion port used by the mail client (smtp port is 25 by default, without encryption)
    option &#039;email_domain&#039; &#039;gmail.com&#039;  # Domain of the mail server
    option &#039;use_tls&#039; &#039;YES&#039;  # &quot;YES&quot; or &quot;NO&quot; are valid options according to ssmpt configuration
    option &#039;email_subject&#039; &#039;MY Network WAN status change&#039; # Subject of the email message
    option &#039;email_signature&#039; &#039;Best Regards, OpenWrt&#039; # Optional Signature message
    list &#039;email_to&#039; &#039;user1@domain1.com user2@domain2.com&#039;  # List of Email notification recipients</code></pre></div><p>The main idea is to have all the messages that you want to be sent, to be initially placed in a common variable (I am using a temp file in /tmp, RAM memory) after each mwan3track iteration (t.e track of all wan links), in order to have all the information after the relevant mwan3track provess. </p><p>ex.)<br />1) NO Trigger event (no link status change since the last track)<br /> -&gt;no log messages -&gt; NO email notification<br />2) Trigger event (one or more of the tracked links have changed its status)<br /> -&gt; relevant log messages to syslog and tmp message file -&gt; email notification</p><p>Without exploring your code in details, probably the best places to call the email notification is in the mwan3track script file. If you find this useful, I will be glad to contribute to your project. If successful, luci integration of the new config section should not be a problem for the developers.</p>											<p class="post-edited">(Last edited by <strong>dir2cas</strong> on 24 Sep 2013, 17:14)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p213081">
				<div class="post-metadata">
					<div class="post-num">Post #490</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						24 Sep 2013, 17:24					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dir2cas wrote:</cite><blockquote><p>Without exploring your code in details, probably the best places to call the email notification is in the mwan3track script file. If you find this useful, I will be glad to contribute to your project. If successful, luci integration of the new config section should not be a problem for the developers.</p></blockquote></div><p>Thank you for the nice work. Mwan3 works with hotplug scripts. When an interface goes up or down a hotplug iface event is triggered. This means that all files in the /etc/hotplug.d/iface folder are run. You can place your custom email notification script there and it will start everytime an interface goes up or down... Imho there is no need to add it to mwan3.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p213082">
				<div class="post-metadata">
					<div class="post-num">Post #491</div>
					<div class="post-author">dir2cas</div>
					<div class="post-datetime">
						24 Sep 2013, 18:05					</div>
				</div>
				<div class="post-content content">
					<p>Yeah, You are absolutely right, I know that mwan3 is hotplug driven. The main idea behind integrating the email function in mwan3 is to parse some information that can be generated by mwan3 checks to the email function. It could be like e plug-in to mwan3 and could be enabled optionaly.</p><p>I think that the major of the work is to translate the configuration section in order to use the openwrt internal configuration functions. This will allow us to place all the configuration in /etc/config/mwan3 or another conf file. </p><p>The other part of the code should be easily integrated. I also could alter the code in order to replect the new variables names. </p><p>However, do you plan to add such functionality to mwan3?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p213137">
				<div class="post-metadata">
					<div class="post-num">Post #492</div>
					<div class="post-author">Thomymaster</div>
					<div class="post-datetime">
						25 Sep 2013, 14:48					</div>
				</div>
				<div class="post-content content">
					<p>This would be very nice <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p213304">
				<div class="post-metadata">
					<div class="post-num">Post #493</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						27 Sep 2013, 16:23					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>garretwcox wrote:</cite><blockquote><p>Hi everyone, I&#039;m having a very strange issue.<br />Load balancing, failover, all seems to work marvelously from within and behind the mwan3 test router. (AWESOME work by the way). However, the router cannot ping or be pinged by other clients in the wan subnet besides the gateway.</p></blockquote></div><p>Sorry for the late reply. I now have a test setup and can reproduce your problem. I can ping hosts form the router directly connected to wan interfaces, but hosts can&#039;t ping the router. I will address this problem in the next version. Expect it within a couple of days...</p><p>Thnx</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p213333">
				<div class="post-metadata">
					<div class="post-num">Post #494</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						27 Sep 2013, 23:15					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>garretwcox wrote:</cite><blockquote><p>Hi everyone, I&#039;m having a very strange issue.<br />Load balancing, failover, all seems to work marvelously from within and behind the mwan3 test router. (AWESOME work by the way). However, the router cannot ping or be pinged by other clients in the wan subnet besides the gateway.</p></blockquote></div><p>This problem is fixed in version 1.2-19. Thanks for noticing!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p213336">
				<div class="post-metadata">
					<div class="post-num">Post #495</div>
					<div class="post-author">Bluse-Blue</div>
					<div class="post-datetime">
						28 Sep 2013, 00:21					</div>
				</div>
				<div class="post-content content">
					<p>Hi all,</p><p>I do not get mwan3 to work as I expected and I would ask you for some troubleshooting help.</p><p><strong>Goal:</strong> assign fixed wan interfaces to specific INTRANET source networks <br />&nbsp; (e.g. from 10.11.0.0/16 -&gt; wan2, from 10.12.0.0/16 -&gt;wan3)</p><p>-Openwrt trunk v 38237<br /><strong>-network setup:</strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;______MWAN3 Router_______<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br /> dsl-gw1 (10.13.1.102/29) &lt;---&gt; \&nbsp; wan2 (10.13.1.101/29)&nbsp; &nbsp; &nbsp; &nbsp; |<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br /> dsl-gw2 (10.13.1.202/29) &lt;-----&gt;| wan3 (10.13.1.201/29)&nbsp; &nbsp; &nbsp; |<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<br /> dsl-gw3 (10.13.1.122/29) &lt;-----&gt;| wan4 (10.13.1.121/29)&nbsp; &nbsp; &nbsp; |&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;________plain Router________<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br /> dsl-gw4 (10.13.1.222/29) &lt;---&gt;/&nbsp; wan5 (10.13.1.221/29)&nbsp; &nbsp; &nbsp; &nbsp; |&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;10.10.10.20/8 WAN&nbsp; | &lt;----&gt; INTRANET<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(10.0.0.0/8)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (10.10.20.2/24) LAN |&lt;------&gt;| LAN (10.10.20.1/24)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|_________________________|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |_________________________|</p><p><strong>network config:</strong><br /></p><div class="codebox"><pre><code>root@mwan3_router:~# cat /etc/config/network 

config interface &#039;loopback&#039;
    option ifname &#039;lo&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;127.0.0.1&#039;
    option netmask &#039;255.0.0.0&#039;

config interface &#039;lan&#039;
    option ifname &#039;eth0.1&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;10.10.20.2&#039;
    option netmask &#039;255.255.255.0&#039;
    option dns    &#039;8.8.8.8&#039;
    option metric &#039;1&#039;

config interface &#039;wan2&#039;
    option ifname &#039;eth0.2&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;10.13.1.101&#039;
    option netmask &#039;255.255.255.248&#039;
    option gateway &#039;10.13.1.102&#039;
    option metric &#039;2&#039;
    
config interface &#039;wan3&#039;
    option ifname &#039;eth0.3&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;10.13.1.201&#039;
    option netmask &#039;255.255.255.248&#039;
    option gateway &#039;10.13.1.202&#039;
    option metric &#039;3&#039;

config interface &#039;wan4&#039;
    option ifname &#039;eth0.4&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;10.13.1.121&#039;
    option netmask &#039;255.255.255.248&#039;
    option gateway &#039;10.13.1.122&#039;
    option metric &#039;4&#039;

config interface &#039;wan5&#039;
    option ifname &#039;eth0.5&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;10.13.1.221&#039;
    option netmask &#039;255.255.255.248&#039;
    option gateway &#039;10.13.1.222&#039;
    option metric &#039;5&#039;

config switch
    option name &#039;switch0&#039;
    option reset &#039;1&#039;
    option enable_vlan &#039;1&#039;

config switch_vlan
    option device &#039;switch0&#039;
    option vlan &#039;1&#039;
    option ports &#039;0t 1&#039;

config switch_vlan
    option device &#039;switch0&#039;
    option vlan &#039;2&#039;
    option ports &#039;0t 2&#039;

config switch_vlan
    option device &#039;switch0&#039;
    option vlan &#039;3&#039;
    option ports &#039;0t 3&#039;

config switch_vlan
    option device &#039;switch0&#039;
    option vlan &#039;4&#039;
    option ports &#039;0t 4&#039;

config switch_vlan
    option device &#039;switch0&#039;
    option vlan &#039;5&#039;
    option ports &#039;0t 5&#039;

config route &#039;intranet&#039;
    option interface &#039;lan&#039;
    option target &#039;10.0.0.0&#039;
    option netmask &#039;255.0.0.0&#039;
    option gateway &#039;10.10.20.1&#039;</code></pre></div><p><strong>mwan3 configuration:</strong><br /></p><div class="codebox"><pre><code>root@mwan3 router:~# cat /etc/config/mwan3 

config interface &#039;wan2&#039;
    list track_ip &#039;8.8.8.8&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option timeout &#039;2&#039;
    option interval &#039;5&#039;
    option down &#039;3&#039;
    option reroute &#039;0&#039;
    option up &#039;5&#039;
    option enabled &#039;0&#039;

config interface &#039;wan3&#039;
    list track_ip &#039;8.8.4.4&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option timeout &#039;2&#039;
    option interval &#039;5&#039;
    option down &#039;3&#039;
    option up &#039;5&#039;
    option reroute &#039;0&#039;
    option enabled &#039;0&#039;

config interface &#039;wan4&#039;
    list track_ip &#039;8.8.8.8&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option timeout &#039;2&#039;
    option interval &#039;5&#039;
    option down &#039;3&#039;
    option up &#039;5&#039;
    option reroute &#039;0&#039;
    option enabled &#039;0&#039;

config interface &#039;wan5&#039;
    list track_ip &#039;8.8.4.4&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option timeout &#039;2&#039;
    option interval &#039;5&#039;
    option down &#039;3&#039;
    option up &#039;5&#039;
    option reroute &#039;0&#039;
    option enabled &#039;0&#039;

config member &#039;wan2_m1&#039;
    option interface &#039;wan2&#039;
    option metric &#039;1&#039;
    option weight &#039;1&#039;

config member &#039;wan3_m1&#039;
    option interface &#039;wan3&#039;
    option metric &#039;1&#039;
    option weight &#039;1&#039;

config member &#039;wan4_m1&#039;
    option interface &#039;wan4&#039;
    option metric &#039;1&#039;
    option weight &#039;1&#039;

config member &#039;wan5_m1&#039;
    option interface &#039;wan5&#039;
    option metric &#039;1&#039;
    option weight &#039;1&#039;

config policy &#039;wan2_only&#039;
    list use_member &#039;wan2_m1&#039;

config policy &#039;wan3_only&#039;
    list use_member &#039;wan3_m1&#039;

config policy &#039;wan4_only&#039;
    list use_member &#039;wan4_m1&#039;

config policy &#039;wan5_only&#039;
    list use_member &#039;wan5_m1&#039;

config rule &#039;to_dsl-gw1&#039;
    option src_ip &#039;10.0.0.0/8&#039;
    option dest_ip &#039;10.13.1.102&#039;
    option proto &#039;all&#039;
    option use_policy &#039;wan2_only&#039;

config rule &#039;to_dsl-gw2&#039;
    option src_ip &#039;10.0.0.0/8&#039;
    option dest_ip &#039;10.13.1.202&#039;
    option proto &#039;all&#039;
    option use_policy &#039;wan3_only&#039;

config rule &#039;to_dsl-gw3&#039;
    option src_ip &#039;10.0.0.0/8&#039;
    option dest_ip &#039;10.13.1.122&#039;
    option proto &#039;all&#039;
    option use_policy &#039;wan4_only&#039;

config rule &#039;to_dsl-gw4&#039;
    option src_ip &#039;10.0.0.0/8&#039;
    option dest_ip &#039;10.13.1.222&#039;
    option proto &#039;all&#039;
    option use_policy &#039;wan5_only&#039;

config rule &#039;from_intranet_1&#039;
    option src_ip &#039;10.11.0.0/16&#039;
    option proto &#039;all&#039;
    option use_policy &#039;wan2_only&#039;

config rule &#039;from_intranet_2&#039;
    option src_ip &#039;10.12.0.0/16&#039;
    option proto &#039;all&#039;
    option use_policy &#039;wan3_only&#039;

config rule &#039;from_intranet_3&#039;
    option src_ip &#039;10.13.0.0/16&#039;
    option proto &#039;all&#039;
    option use_policy &#039;wan4_only&#039;

config rule &#039;from_intranet_rest&#039;
    option proto &#039;all&#039;
    option use_policy &#039;wan5_only&#039;
    option src_ip &#039;10.0.0.0/8&#039;</code></pre></div><p><strong>What is the problem ?</strong><br />-hosts from INTRANET do not use their assigned WAN interface, but rather got loadbalanced round robin accross all WANs<br />-as long as wman3 is active, any ssh session from INTRANET to any dsl-gwXY is very unresponsive, like 3 sec delay, 3sec ok, 3sec delay....</p><p><strong>troubleshooting so far:</strong><br /></p><ul><li><p>from mwan3 router each wanXY can be used to ping google.de</p></li><li><p>dmesg shows is susspiciouse entry: <em>kmod: dependency not loaded nf_conntrack_amanda</em></p></li><li><p>traffic generated on the mwan3 router uses always wan2</p></li><li><p>routing tables (all 8) look sufficient</p></li></ul><p>What should I check to find the problem of the unwanted loadbalancing ?</p><p>Thx Bluse</p>											<p class="post-edited">(Last edited by <strong>Bluse-Blue</strong> on 28 Sep 2013, 00:22)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p213339">
				<div class="post-metadata">
					<div class="post-num">Post #496</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						28 Sep 2013, 01:17					</div>
				</div>
				<div class="post-content content">
					<p>Hi Bluse,</p><p>I see two mistakes in your config:</p><p>1. You have to set the option enabled to &#039;1&#039; on each interface. (but that should probably be on purpose..)<br />2. You need a rule for the intranet, telling the router to use the default routing table for intranet. Place this on top of all your other rules.</p><div class="codebox"><pre><code>config rule &#039;to_intranet&#039;
    option dest_ip &#039;10.0.0.0/8&#039;
    option proto &#039;all&#039;
    option use_policy &#039;default&#039;</code></pre></div><p>Also, you can leave out all the &quot;to_dsl-gw*&quot; rules. They have no function. If it still doesn&#039;t work, please post your &quot;iptables -L -t mangle -v -n&quot; output.</p><br /><p>Thnx</p>											<p class="post-edited">(Last edited by <strong>Adze</strong> on 28 Sep 2013, 01:25)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p213358">
				<div class="post-metadata">
					<div class="post-num">Post #497</div>
					<div class="post-author">Bluse-Blue</div>
					<div class="post-datetime">
						28 Sep 2013, 10:53					</div>
				</div>
				<div class="post-content content">
					<p>Hi Adze,</p><p>Thx for helping out here. I have added the intranet rule on top of all others.<br />But still the gateway assignment does not work as specified and ssh session from intranet to the gateway nodes are unrrsponsive.</p><p>here is the output of: &quot;iptables -L -t mangle -v -n&quot;</p><div class="codebox"><pre><code>root@Kihei_gw:~# iptables -L -t mangle -v -n
Chain PREROUTING (policy ACCEPT 25807 packets, 12M bytes)
 pkts bytes target     prot opt in     out     source               destination         
31510   14M mwan3_pre  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
26089   12M fwmark     all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain INPUT (policy ACCEPT 499 packets, 51974 bytes)
 pkts bytes target     prot opt in     out     source               destination         
  646 67748 mwan3_post  all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain FORWARD (policy ACCEPT 25302 packets, 12M bytes)
 pkts bytes target     prot opt in     out     source               destination         
25569   12M mssfix     all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain OUTPUT (policy ACCEPT 509 packets, 88142 bytes)
 pkts bytes target     prot opt in     out     source               destination         
  657  111K mwan3_pre  all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain POSTROUTING (policy ACCEPT 25811 packets, 12M bytes)
 pkts bytes target     prot opt in     out     source               destination         
31458   14M mwan3_post  all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain fwmark (1 references)
 pkts bytes target     prot opt in     out     source               destination         

Chain mssfix (1 references)
 pkts bytes target     prot opt in     out     source               destination         

Chain mwan3_default (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MARK       all  --  *      *       0.0.0.0/0            224.0.0.0/3          mark match 0x0/0xff00 MARK xset 0x7f00/0xff00
    1    60 MARK       all  --  *      *       0.0.0.0/0            127.0.0.0/8          mark match 0x0/0xff00 MARK xset 0x7f00/0xff00
  153 20545 MARK       all  --  *      *       0.0.0.0/0            10.0.0.0/8           mark match 0x0/0xff00 MARK xset 0x7f00/0xff00
    0     0 MARK       all  --  *      *       0.0.0.0/0            10.10.20.0/24        mark match 0x0/0xff00 MARK xset 0x7f00/0xff00
    0     0 MARK       all  --  *      *       0.0.0.0/0            10.13.1.96/29        mark match 0x0/0xff00 MARK xset 0x7f00/0xff00
    0     0 MARK       all  --  *      *       0.0.0.0/0            10.13.1.120/29       mark match 0x0/0xff00 MARK xset 0x7f00/0xff00
    0     0 MARK       all  --  *      *       0.0.0.0/0            10.13.1.200/29       mark match 0x0/0xff00 MARK xset 0x7f00/0xff00
    0     0 MARK       all  --  *      *       0.0.0.0/0            10.13.1.216/29       mark match 0x0/0xff00 MARK xset 0x7f00/0xff00

Chain mwan3_interfaces (1 references)
 pkts bytes target     prot opt in     out     source               destination         
  407 92367 mwan3_wan5  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
  251 17388 mwan3_wan4  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
  237 16445 mwan3_wan3  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
  196 13851 mwan3_wan2  all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain mwan3_post (2 references)
 pkts bytes target     prot opt in     out     source               destination         
 2596  585K MARK       all  --  *      eth0.2  0.0.0.0/0            0.0.0.0/0            mark match ! 0x7f00/0xff00 MARK xset 0x100/0xff00
  894  179K MARK       all  --  *      eth0.3  0.0.0.0/0            0.0.0.0/0            mark match ! 0x7f00/0xff00 MARK xset 0x200/0xff00
  554 88902 MARK       all  --  *      eth0.4  0.0.0.0/0            0.0.0.0/0            mark match ! 0x7f00/0xff00 MARK xset 0x300/0xff00
12268 2022K MARK       all  --  *      eth0.5  0.0.0.0/0            0.0.0.0/0            mark match ! 0x7f00/0xff00 MARK xset 0x400/0xff00
14592   11M MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x8000/0x8000 MARK and 0xffff7fff
32104   14M CONNMARK   all  --  *      *       0.0.0.0/0            0.0.0.0/0            CONNMARK save mask 0xff00

Chain mwan3_pre (2 references)
 pkts bytes target     prot opt in     out     source               destination         
32167   14M CONNMARK   all  --  *      *       0.0.0.0/0            0.0.0.0/0            CONNMARK restore mask 0xff00
 1959  667K MARK       all  --  eth0.2 *       0.0.0.0/0            0.0.0.0/0            MARK xset 0x8100/0xff00
  714  259K MARK       all  --  eth0.3 *       0.0.0.0/0            0.0.0.0/0            MARK xset 0x8200/0xff00
  348 76139 MARK       all  --  eth0.4 *       0.0.0.0/0            0.0.0.0/0            MARK xset 0x8300/0xff00
11678   10M MARK       all  --  eth0.5 *       0.0.0.0/0            0.0.0.0/0            MARK xset 0x8400/0xff00
  692  149K mwan3_default  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00
  467  118K mwan3_interfaces  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00
  266  104K mwan3_rules  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00

Chain mwan3_rules (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MARK       all  --  *      *       0.0.0.0/0            10.0.0.0/8           mark match 0x0/0xff00 MARK xset 0x7f00/0xff00
    0     0 MARK       all  --  *      *       10.11.0.0/19         0.0.0.0/0            mark match 0x0/0xff00 MARK xset 0x1100/0xff00
    1    40 MARK       all  --  *      *       10.11.0.0/16         0.0.0.0/0            mark match 0x0/0xff00 MARK xset 0x1200/0xff00
    0     0 MARK       all  --  *      *       10.12.0.0/16         0.0.0.0/0            mark match 0x0/0xff00 MARK xset 0x1300/0xff00
    0     0 MARK       all  --  *      *       10.0.0.0/8           0.0.0.0/0            mark match 0x0/0xff00 MARK xset 0x1000/0xff00

Chain mwan3_wan2 (1 references)
 pkts bytes target     prot opt in     out     source               destination         
  152 10199 MARK       all  --  *      *       10.13.1.101          0.0.0.0/0            MARK xset 0x100/0xff00

Chain mwan3_wan3 (1 references)
 pkts bytes target     prot opt in     out     source               destination         
   16  1344 MARK       all  --  *      *       10.13.1.201          0.0.0.0/0            MARK xset 0x200/0xff00

Chain mwan3_wan4 (1 references)
 pkts bytes target     prot opt in     out     source               destination         
   16  1344 MARK       all  --  *      *       10.13.1.121          0.0.0.0/0            MARK xset 0x300/0xff00

Chain mwan3_wan5 (1 references)
 pkts bytes target     prot opt in     out     source               destination         
   17  1428 MARK       all  --  *      *       10.13.1.221          0.0.0.0/0            MARK xset 0x400/0xff00

Chain qos_Default (0 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 CONNMARK   all  --  *      *       0.0.0.0/0            0.0.0.0/0            CONNMARK restore mask 0xff
    0     0 qos_Default_ct  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff
    0     0 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x1/0xff length 400:65535 MARK and 0xffffff00
    0     0 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x2/0xff length 800:65535 MARK and 0xffffff00
    0     0 MARK       udp  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff length 0:500 MARK xset 0x2/0xff
    0     0 MARK       icmp --  *      *       0.0.0.0/0            0.0.0.0/0            MARK xset 0x1/0xff
    0     0 MARK       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff tcp spts:1024:65535 dpts:1024:65535 MARK xset 0x4/0xff
    0     0 MARK       udp  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff udp spts:1024:65535 dpts:1024:65535 MARK xset 0x4/0xff
    0     0 MARK       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            length 0:128 mark match ! 0x4/0xff tcp flags:0x3F/0x02 MARK xset 0x1/0xff
    0     0 MARK       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            length 0:128 mark match ! 0x4/0xff tcp flags:0x3F/0x10 MARK xset 0x1/0xff

Chain qos_Default_ct (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MARK       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff tcp multiport ports 22,53 MARK xset 0x1/0xff
    0     0 MARK       udp  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff udp multiport ports 22,53 MARK xset 0x1/0xff
    0     0 MARK       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff tcp multiport ports 20,21,25,80,110,443,993,995 MARK xset 0x3/0xff
    0     0 MARK       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff tcp multiport ports 5190 MARK xset 0x2/0xff
    0     0 MARK       udp  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff udp multiport ports 5190 MARK xset 0x2/0xff
    0     0 CONNMARK   all  --  *      *       0.0.0.0/0            0.0.0.0/0            CONNMARK save mask 0xff</code></pre></div><p>I am not sure where it got mixed up.</p><p>Greetings Bluse</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p213359">
				<div class="post-metadata">
					<div class="post-num">Post #498</div>
					<div class="post-author">Bluse-Blue</div>
					<div class="post-datetime">
						28 Sep 2013, 11:00					</div>
				</div>
				<div class="post-content content">
					<p>the updated mwan3 config is (I disabled the interfaces as it does not work till now):</p><div class="codebox"><pre><code>config interface &#039;wan2&#039;
    list track_ip &#039;8.8.8.8&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option timeout &#039;2&#039;
    option interval &#039;5&#039;
    option down &#039;3&#039;
    option reroute &#039;0&#039;
    option up &#039;5&#039;
    option enabled &#039;0&#039;

config interface &#039;wan3&#039;
    list track_ip &#039;8.8.4.4&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option timeout &#039;2&#039;
    option interval &#039;5&#039;
    option down &#039;3&#039;
    option up &#039;5&#039;
    option reroute &#039;0&#039;
    option enabled &#039;0&#039;

config interface &#039;wan4&#039;
    list track_ip &#039;8.8.8.8&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option timeout &#039;2&#039;
    option interval &#039;5&#039;
    option down &#039;3&#039;
    option up &#039;5&#039;
    option reroute &#039;0&#039;
    option enabled &#039;0&#039;

config interface &#039;wan5&#039;
    list track_ip &#039;8.8.4.4&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option timeout &#039;2&#039;
    option interval &#039;5&#039;
    option down &#039;3&#039;
    option up &#039;5&#039;
    option reroute &#039;0&#039;
    option enabled &#039;0&#039;

config member &#039;wan2_m1&#039;
    option interface &#039;wan2&#039;
    option metric &#039;1&#039;
    option weight &#039;1&#039;

config member &#039;wan3_m1&#039;
    option interface &#039;wan3&#039;
    option metric &#039;1&#039;
    option weight &#039;1&#039;

config member &#039;wan4_m1&#039;
    option interface &#039;wan4&#039;
    option metric &#039;1&#039;
    option weight &#039;1&#039;

config member &#039;wan5_m1&#039;
    option interface &#039;wan5&#039;
    option metric &#039;1&#039;
    option weight &#039;1&#039;

config policy &#039;wan2_only&#039;
    list use_member &#039;wan2_m1&#039;

config policy &#039;wan3_only&#039;
    list use_member &#039;wan3_m1&#039;

config policy &#039;wan4_only&#039;
    list use_member &#039;wan4_m1&#039;

config policy &#039;wan5_only&#039;
    list use_member &#039;wan5_m1&#039;

config policy &#039;all_loadbalanced&#039;
    list use_member &#039;wan2_m1&#039;
    list use_member &#039;wan3_m1&#039;
    list use_member &#039;wan4_m1&#039;
    list use_member &#039;wan5_m1&#039;

#rule to Freifunk intranet
config rule &#039;to_intranet&#039;
    option dest_ip &#039;10.0.0.0/8&#039;
    option proto &#039;all&#039;
    option use_policy &#039;default&#039;
            
config rule &#039;from_urli_1&#039;
    option src_ip &#039;10.11.0.0/19&#039;
    option proto &#039;all&#039;
    option use_policy &#039;wan3_only&#039;

config rule &#039;from_urli_2&#039;
    option src_ip &#039;10.11.0.0/16&#039;
    option proto &#039;all&#039;
    option use_policy &#039;wan4_only&#039;

config rule &#039;from_klett&#039;
    option src_ip &#039;10.12.0.0/16&#039;
    option proto &#039;all&#039;
    option use_policy &#039;wan5_only&#039;

config rule &#039;from_sundi&#039;
    option proto &#039;all&#039;
    option use_policy &#039;wan2_only&#039;
    option src_ip &#039;10.0.0.0/8&#039;</code></pre></div><p>Greetings Bluse</p>											<p class="post-edited">(Last edited by <strong>Bluse-Blue</strong> on 28 Sep 2013, 11:01)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p213375">
				<div class="post-metadata">
					<div class="post-num">Post #499</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						28 Sep 2013, 15:20					</div>
				</div>
				<div class="post-content content">
					<p>Hi Bluse,</p><br /><p>Your config looks fine and so does the output of iptables. I need some more info for troubleshouting. While mwan3 is enabled and while you are trying to connect to a gateway, could you post the output of:</p><p>ip rule<br />ip route list table main<br />ip route list table 1001<br />ip route list table 1002<br />ip route list table 1003<br />ip route list table 1004<br />ip route list table 1016<br />ip route list table 1017<br />ip route list table 1018<br />ip route list table 1019<br />ip route list table 1020<br />cat /proc/net/nf_conntrack</p><br /><p>Thnx</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p213405">
				<div class="post-metadata">
					<div class="post-num">Post #500</div>
					<div class="post-author">Bluse-Blue</div>
					<div class="post-datetime">
						28 Sep 2013, 23:26					</div>
				</div>
				<div class="post-content content">
					<p>Hi Adzel,</p><p>Another test confirmed the unresponsive ssh session from intranet to one of the gatway machines through the mwan3 router. A ping from one of the gateway machines to an intranet machine shows a lot of packet losses:</p><div class="codebox"><pre><code>[root@galaxy ~]# ping 10.10.10.4
PING 10.10.10.4 (10.10.10.4): 56 data bytes
64 bytes from 10.10.10.4: icmp_seq=2 ttl=62 time=2.349 ms
64 bytes from 10.10.10.4: icmp_seq=10 ttl=62 time=2.016 ms
64 bytes from 10.10.10.4: icmp_seq=19 ttl=62 time=1.813 ms
64 bytes from 10.10.10.4: icmp_seq=21 ttl=62 time=2.071 ms</code></pre></div><p>But back to your requested command output to get the throubleshooting a step forward.</p><p><strong>ip rule</strong><br /></p><div class="codebox"><pre><code>root@Kirchheilingen_gw:~# ip rule
0:    from all lookup local 
1001:    from all fwmark 0x100/0xff00 lookup 1001 
1002:    from all fwmark 0x200/0xff00 lookup 1002 
1003:    from all fwmark 0x300/0xff00 lookup 1003 
1004:    from all fwmark 0x400/0xff00 lookup 1004 
1016:    from all fwmark 0x1000/0xff00 lookup 1016 
1017:    from all fwmark 0x1100/0xff00 lookup 1017 
1018:    from all fwmark 0x1200/0xff00 lookup 1018 
1019:    from all fwmark 0x1300/0xff00 lookup 1019 
32766:    from all lookup main 
32767:    from all lookup default </code></pre></div><p><strong>ip route list table main</strong><br /></p><div class="codebox"><pre><code>root@Kirchheilingen_gw:~# ip route list table main
default via 10.13.1.102 dev eth0.2  proto static  metric 2 
default via 10.13.1.202 dev eth0.3  proto static  metric 3 
default via 10.13.1.122 dev eth0.4  proto static  metric 4 
default via 10.13.1.222 dev eth0.5  proto static  metric 5 
10.0.0.0/8 via 10.10.20.1 dev eth0.1  proto static  metric 1 
10.10.20.0/24 dev eth0.1  proto static  scope link  metric 1 
10.13.1.96/29 dev eth0.2  proto static  scope link  metric 2 
10.13.1.120/29 dev eth0.4  proto static  scope link  metric 4 
10.13.1.200/29 dev eth0.3  proto static  scope link  metric 3 
10.13.1.216/29 dev eth0.5  proto static  scope link  metric 5 </code></pre></div><p><strong>ip route list table XY</strong><br /></p><div class="codebox"><pre><code>root@Kirchheilingen_gw:~# ip route list table 1001
default via 10.13.1.102 dev eth0.2 
root@Kirchheilingen_gw:~# ip route list table 1002
default via 10.13.1.202 dev eth0.3 
root@Kirchheilingen_gw:~# ip route list table 1003
default via 10.13.1.122 dev eth0.4 
root@Kirchheilingen_gw:~# ip route list table 1004
default via 10.13.1.222 dev eth0.5 
root@Kirchheilingen_gw:~# ip route list table 1016
default via 10.13.1.102 dev eth0.2  metric 1 
root@Kirchheilingen_gw:~# ip route list table 1017
default via 10.13.1.202 dev eth0.3  metric 1 
root@Kirchheilingen_gw:~# ip route list table 1018
default via 10.13.1.122 dev eth0.4  metric 1 
root@Kirchheilingen_gw:~# ip route list table 1019
default via 10.13.1.222 dev eth0.5  metric 1 </code></pre></div><p>Table 1020 is not present.</p><br /><p><strong>cat /proc/net/nf_conntrack</strong><br /></p><div class="codebox"><pre><code>root@Kirchheilingen_gw:~# cat /proc/net/nf_conntrack
ipv4     2 udp      17 25 src=10.13.1.101 dst=8.8.8.8 sport=64317 dport=53 packets=1 bytes=66 [UNREPLIED] src=8.8.8.8 dst=10.13.1.101 sport=53 dport=64317 packets=0 bytes=0 mark=256 use=2
ipv4     2 udp      17 36 src=10.13.1.101 dst=8.8.8.8 sport=51039 dport=53 packets=1 bytes=69 [UNREPLIED] src=8.8.8.8 dst=10.13.1.101 sport=53 dport=51039 packets=0 bytes=0 mark=256 use=2
ipv4     2 udp      17 23 src=10.10.20.2 dst=10.11.10.33 sport=53 dport=40405 packets=1 bytes=265 [UNREPLIED] src=10.11.10.33 dst=10.10.20.2 sport=40405 dport=53 packets=0 bytes=0 mark=32512 use=2
ipv4     2 udp      17 31 src=10.10.20.2 dst=10.10.10.39 sport=53 dport=53688 packets=1 bytes=142 [UNREPLIED] src=10.10.10.39 dst=10.10.20.2 sport=53688 dport=53 packets=0 bytes=0 mark=32512 use=2
ipv4     2 udp      17 22 src=10.13.1.101 dst=8.8.8.8 sport=21961 dport=53 packets=1 bytes=62 [UNREPLIED] src=8.8.8.8 dst=10.13.1.101 sport=53 dport=21961 packets=0 bytes=0 mark=256 use=2
ipv4     2 icmp     1 25 src=10.13.1.201 dst=8.8.4.4 type=8 code=0 id=5369 packets=1 bytes=84 [UNREPLIED] src=8.8.4.4 dst=10.13.1.201 type=0 code=0 id=5369 packets=0 bytes=0 mark=512 use=2
ipv4     2 tcp      6 2772 ESTABLISHED src=10.10.4.5 dst=10.13.1.222 sport=45866 dport=444 packets=4 bytes=588 src=10.13.1.222 dst=10.10.4.5 sport=444 dport=45866 packets=4 bytes=785 [ASSURED] mark=0 use=2
ipv4     2 udp      17 36 src=10.10.20.2 dst=10.100.10.12 sport=53 dport=27646 packets=1 bytes=85 [UNREPLIED] src=10.100.10.12 dst=10.10.20.2 sport=27646 dport=53 packets=0 bytes=0 mark=32512 use=2
ipv4     2 icmp     1 14 src=10.13.1.121 dst=8.8.8.8 type=8 code=0 id=5351 packets=1 bytes=84 [UNREPLIED] src=8.8.8.8 dst=10.13.1.121 type=0 code=0 id=5351 packets=0 bytes=0 mark=768 use=2
ipv4     2 icmp     1 6 src=10.13.1.101 dst=8.8.8.8 type=8 code=0 id=5339 packets=1 bytes=84 [UNREPLIED] src=8.8.8.8 dst=10.13.1.101 type=0 code=0 id=5339 packets=0 bytes=0 mark=256 use=2
ipv4     2 tcp      6 2801 ESTABLISHED src=10.12.6.117 dst=80.239.194.134 sport=51426 dport=80 packets=1 bytes=52 src=80.239.194.134 dst=10.12.6.117 sport=80 dport=51426 packets=6 bytes=8952 [ASSURED] mark=1024 use=2
ipv4     2 udp      17 38 src=10.10.20.2 dst=10.100.10.12 sport=53 dport=48841 packets=1 bytes=78 [UNREPLIED] src=10.100.10.12 dst=10.10.20.2 sport=48841 dport=53 packets=0 bytes=0 mark=32512 use=2
ipv4     2 tcp      6 2823 ESTABLISHED src=10.13.1.222 dst=10.10.4.5 sport=444 dport=45934 packets=3 bytes=725 src=10.10.4.5 dst=10.13.1.222 sport=45934 dport=444 packets=2 bytes=578 [ASSURED] mark=1024 use=2
ipv4     2 icmp     1 21 src=10.13.1.101 dst=8.8.8.8 type=8 code=0 id=5363 packets=1 bytes=84 [UNREPLIED] src=8.8.8.8 dst=10.13.1.101 type=0 code=0 id=5363 packets=0 bytes=0 mark=256 use=2
ipv4     2 tcp      6 2823 ESTABLISHED src=212.162.25.34 dst=10.12.6.117 sport=80 dport=51415 packets=2 bytes=2984 src=10.12.6.117 dst=212.162.25.34 sport=51415 dport=80 packets=2 bytes=120 [ASSURED] mark=1024 use=2
ipv4     2 icmp     1 18 src=10.13.1.221 dst=8.8.4.4 type=8 code=0 id=5357 packets=1 bytes=84 [UNREPLIED] src=8.8.4.4 dst=10.13.1.221 type=0 code=0 id=5357 packets=0 bytes=0 mark=1024 use=2
ipv4     2 tcp      6 2762 ESTABLISHED src=10.10.2.241 dst=111.221.77.154 sport=50420 dport=80 packets=3 bytes=167 src=111.221.77.154 dst=10.10.2.241 sport=80 dport=50420 packets=2 bytes=92 [ASSURED] mark=0 use=2
ipv4     2 udp      17 22 src=10.10.20.2 dst=10.11.10.33 sport=53 dport=7835 packets=1 bytes=260 [UNREPLIED] src=10.11.10.33 dst=10.10.20.2 sport=7835 dport=53 packets=0 bytes=0 mark=32512 use=2
ipv4     2 icmp     1 1 src=10.13.1.101 dst=8.8.8.8 type=8 code=0 id=5331 packets=1 bytes=84 [UNREPLIED] src=8.8.8.8 dst=10.13.1.101 type=0 code=0 id=5331 packets=0 bytes=0 mark=256 use=2
ipv4     2 udp      17 31 src=10.13.1.101 dst=8.8.8.8 sport=41822 dport=53 packets=1 bytes=62 [UNREPLIED] src=8.8.8.8 dst=10.13.1.101 sport=53 dport=41822 packets=0 bytes=0 mark=256 use=2
ipv4     2 udp      17 36 src=10.13.1.101 dst=8.8.8.8 sport=10217 dport=53 packets=1 bytes=60 [UNREPLIED] src=8.8.8.8 dst=10.13.1.101 sport=53 dport=10217 packets=0 bytes=0 mark=256 use=2
ipv4     2 udp      17 16 src=10.13.1.101 dst=8.8.8.8 sport=32652 dport=53 packets=1 bytes=63 [UNREPLIED] src=8.8.8.8 dst=10.13.1.101 sport=53 dport=32652 packets=0 bytes=0 mark=256 use=2
ipv4     2 tcp      6 2762 ESTABLISHED src=10.11.21.140 dst=77.234.40.66 sport=52939 dport=80 packets=3 bytes=359 src=77.234.40.66 dst=10.11.21.140 sport=80 dport=52939 packets=2 bytes=88 [ASSURED] mark=0 use=2
ipv4     2 udp      17 29 src=10.13.1.101 dst=8.8.8.8 sport=43028 dport=53 packets=1 bytes=70 [UNREPLIED] src=8.8.8.8 dst=10.13.1.101 sport=53 dport=43028 packets=0 bytes=0 mark=256 use=2
ipv4     2 udp      17 30 src=10.10.20.2 dst=10.10.10.39 sport=53 dport=57959 packets=1 bytes=139 [UNREPLIED] src=10.10.10.39 dst=10.10.20.2 sport=57959 dport=53 packets=0 bytes=0 mark=32512 use=2
ipv4     2 udp      17 30 src=10.10.20.2 dst=10.10.10.39 sport=53 dport=13516 packets=1 bytes=75 [UNREPLIED] src=10.10.10.39 dst=10.10.20.2 sport=13516 dport=53 packets=0 bytes=0 mark=32512 use=2
ipv4     2 icmp     1 5 src=10.13.1.201 dst=8.8.4.4 type=8 code=0 id=5337 packets=1 bytes=84 [UNREPLIED] src=8.8.4.4 dst=10.13.1.201 type=0 code=0 id=5337 packets=0 bytes=0 mark=512 use=2
ipv4     2 udp      17 16 src=10.10.20.2 dst=10.11.10.53 sport=53 dport=2512 packets=1 bytes=120 [UNREPLIED] src=10.11.10.53 dst=10.10.20.2 sport=2512 dport=53 packets=0 bytes=0 mark=32512 use=2
ipv4     2 tcp      6 2762 ESTABLISHED src=10.10.21.116 dst=77.234.45.55 sport=49676 dport=80 packets=3 bytes=387 src=77.234.45.55 dst=10.10.21.116 sport=80 dport=49676 packets=2 bytes=92 [ASSURED] mark=0 use=2
ipv4     2 udp      17 56 src=10.13.1.101 dst=8.8.8.8 sport=34909 dport=53 packets=1 bytes=74 [UNREPLIED] src=8.8.8.8 dst=10.13.1.101 sport=53 dport=34909 packets=0 bytes=0 mark=256 use=2
ipv4     2 udp      17 38 src=10.13.1.101 dst=8.8.8.8 sport=20152 dport=53 packets=1 bytes=62 [UNREPLIED] src=8.8.8.8 dst=10.13.1.101 sport=53 dport=20152 packets=0 bytes=0 mark=256 use=2
ipv4     2 udp      17 57 src=10.10.20.2 dst=10.10.10.39 sport=53 dport=60532 packets=1 bytes=264 [UNREPLIED] src=10.10.10.39 dst=10.10.20.2 sport=60532 dport=53 packets=0 bytes=0 mark=32512 use=2
ipv4     2 tcp      6 2814 ESTABLISHED src=157.56.192.175 dst=10.10.2.215 sport=443 dport=50731 packets=1 bytes=1267 src=10.10.2.215 dst=157.56.192.175 sport=50731 dport=443 packets=1 bytes=52 mark=1024 use=2
ipv4     2 icmp     1 26 src=10.13.1.101 dst=8.8.8.8 type=8 code=0 id=5371 packets=1 bytes=84 [UNREPLIED] src=8.8.8.8 dst=10.13.1.101 type=0 code=0 id=5371 packets=0 bytes=0 mark=256 use=2
ipv4     2 icmp     1 11 src=10.13.1.101 dst=8.8.8.8 type=8 code=0 id=5347 packets=1 bytes=84 [UNREPLIED] src=8.8.8.8 dst=10.13.1.101 type=0 code=0 id=5347 packets=0 bytes=0 mark=256 use=2
ipv4     2 icmp     1 15 src=10.13.1.201 dst=8.8.4.4 type=8 code=0 id=5353 packets=1 bytes=84 [UNREPLIED] src=8.8.4.4 dst=10.13.1.201 type=0 code=0 id=5353 packets=0 bytes=0 mark=512 use=2
ipv4     2 icmp     1 20 src=10.13.1.201 dst=8.8.4.4 type=8 code=0 id=5361 packets=1 bytes=84 [UNREPLIED] src=8.8.4.4 dst=10.13.1.201 type=0 code=0 id=5361 packets=0 bytes=0 mark=512 use=2
ipv4     2 icmp     1 29 src=10.13.1.121 dst=8.8.8.8 type=8 code=0 id=5377 packets=1 bytes=84 [UNREPLIED] src=8.8.8.8 dst=10.13.1.121 type=0 code=0 id=5377 packets=0 bytes=0 mark=768 use=2
ipv4     2 icmp     1 13 src=10.13.1.221 dst=8.8.4.4 type=8 code=0 id=5349 packets=1 bytes=84 [UNREPLIED] src=8.8.4.4 dst=10.13.1.221 type=0 code=0 id=5349 packets=0 bytes=0 mark=1024 use=2
ipv4     2 tcp      6 2762 ESTABLISHED src=10.10.4.5 dst=10.13.1.222 sport=45863 dport=444 packets=3 bytes=536 src=10.13.1.222 dst=10.10.4.5 sport=444 dport=45863 packets=2 bytes=112 [ASSURED] mark=0 use=2
ipv4     2 icmp     1 28 src=10.13.1.221 dst=8.8.4.4 type=8 code=0 id=5375 packets=1 bytes=84 [UNREPLIED] src=8.8.4.4 dst=10.13.1.221 type=0 code=0 id=5375 packets=0 bytes=0 mark=1024 use=2
ipv4     2 udp      17 39 src=10.13.1.101 dst=8.8.8.8 sport=60692 dport=53 packets=1 bytes=63 [UNREPLIED] src=8.8.8.8 dst=10.13.1.101 sport=53 dport=60692 packets=0 bytes=0 mark=256 use=2
ipv4     2 tcp      6 2762 ESTABLISHED src=10.12.6.117 dst=213.199.179.153 sport=51397 dport=40002 packets=4 bytes=238 src=213.199.179.153 dst=10.12.6.117 sport=40002 dport=51397 packets=3 bytes=231 [ASSURED] mark=0 use=2
ipv4     2 udp      17 25 src=10.13.1.101 dst=142.54.181.202 sport=44806 dport=123 packets=1 bytes=76 [UNREPLIED] src=142.54.181.202 dst=10.13.1.101 sport=123 dport=44806 packets=0 bytes=0 mark=256 use=2
ipv4     2 icmp     1 0 src=10.13.1.201 dst=8.8.4.4 type=8 code=0 id=5329 packets=1 bytes=84 [UNREPLIED] src=8.8.4.4 dst=10.13.1.201 type=0 code=0 id=5329 packets=0 bytes=0 mark=512 use=2
ipv4     2 udp      17 36 src=10.10.20.2 dst=10.100.10.12 sport=53 dport=63413 packets=1 bytes=76 [UNREPLIED] src=10.100.10.12 dst=10.10.20.2 sport=63413 dport=53 packets=0 bytes=0 mark=32512 use=2
ipv4     2 tcp      6 2824 ESTABLISHED src=10.13.1.202 dst=10.10.4.5 sport=444 dport=59872 packets=1 bytes=64 [UNREPLIED] src=10.10.4.5 dst=10.13.1.202 sport=59872 dport=444 packets=0 bytes=0 mark=512 use=2
ipv4     2 udp      17 57 src=10.13.1.101 dst=8.8.8.8 sport=5066 dport=53 packets=1 bytes=62 [UNREPLIED] src=8.8.8.8 dst=10.13.1.101 sport=53 dport=5066 packets=0 bytes=0 mark=256 use=2
ipv4     2 tcp      6 2762 ESTABLISHED src=10.10.100.253 dst=91.190.216.63 sport=37418 dport=12350 packets=3 bytes=260 src=91.190.216.63 dst=10.10.100.253 sport=12350 dport=37418 packets=1 bytes=60 [ASSURED] mark=0 use=2
ipv4     2 icmp     1 3 src=10.13.1.221 dst=8.8.4.4 type=8 code=0 id=5333 packets=1 bytes=84 [UNREPLIED] src=8.8.4.4 dst=10.13.1.221 type=0 code=0 id=5333 packets=0 bytes=0 mark=1024 use=2
ipv4     2 udp      17 19 src=10.13.1.101 dst=199.7.177.206 sport=32845 dport=123 packets=1 bytes=76 [UNREPLIED] src=199.7.177.206 dst=10.13.1.101 sport=123 dport=32845 packets=0 bytes=0 mark=256 use=2
ipv4     2 udp      17 57 src=10.10.20.2 dst=10.10.10.39 sport=53 dport=17455 packets=1 bytes=109 [UNREPLIED] src=10.10.10.39 dst=10.10.20.2 sport=17455 dport=53 packets=0 bytes=0 mark=32512 use=2
ipv4     2 tcp      6 2762 ESTABLISHED src=10.10.100.253 dst=91.190.216.63 sport=34080 dport=80 packets=3 bytes=169 src=91.190.216.63 dst=10.10.100.253 sport=80 dport=34080 packets=2 bytes=112 [ASSURED] mark=0 use=2
ipv4     2 udp      17 25 src=10.13.1.101 dst=91.206.8.36 sport=54045 dport=123 packets=1 bytes=76 [UNREPLIED] src=91.206.8.36 dst=10.13.1.101 sport=123 dport=54045 packets=0 bytes=0 mark=256 use=2
ipv4     2 udp      17 23 src=10.13.1.101 dst=8.8.8.8 sport=46901 dport=53 packets=1 bytes=65 [UNREPLIED] src=8.8.8.8 dst=10.13.1.101 sport=53 dport=46901 packets=0 bytes=0 mark=256 use=2
ipv4     2 icmp     1 24 src=10.13.1.121 dst=8.8.8.8 type=8 code=0 id=5367 packets=1 bytes=84 [UNREPLIED] src=8.8.8.8 dst=10.13.1.121 type=0 code=0 id=5367 packets=0 bytes=0 mark=768 use=2
ipv4     2 udp      17 39 src=10.13.1.101 dst=8.8.8.8 sport=30279 dport=53 packets=1 bytes=57 [UNREPLIED] src=8.8.8.8 dst=10.13.1.101 sport=53 dport=30279 packets=0 bytes=0 mark=256 use=2
ipv4     2 udp      17 39 src=10.13.1.101 dst=8.8.8.8 sport=53864 dport=53 packets=1 bytes=60 [UNREPLIED] src=8.8.8.8 dst=10.13.1.101 sport=53 dport=53864 packets=0 bytes=0 mark=256 use=2
ipv4     2 udp      17 25 src=10.13.1.101 dst=8.8.8.8 sport=41098 dport=53 packets=1 bytes=71 [UNREPLIED] src=8.8.8.8 dst=10.13.1.101 sport=53 dport=41098 packets=0 bytes=0 mark=256 use=2
ipv4     2 icmp     1 4 src=10.13.1.121 dst=8.8.8.8 type=8 code=0 id=5335 packets=1 bytes=84 [UNREPLIED] src=8.8.8.8 dst=10.13.1.121 type=0 code=0 id=5335 packets=0 bytes=0 mark=768 use=2
ipv4     2 udp      17 24 src=10.13.1.101 dst=8.8.8.8 sport=12528 dport=53 packets=1 bytes=60 [UNREPLIED] src=8.8.8.8 dst=10.13.1.101 sport=53 dport=12528 packets=0 bytes=0 mark=256 use=2
ipv4     2 udp      17 30 src=10.10.20.2 dst=10.100.10.12 sport=53 dport=51679 packets=1 bytes=178 [UNREPLIED] src=10.100.10.12 dst=10.10.20.2 sport=51679 dport=53 packets=0 bytes=0 mark=32512 use=2
ipv4     2 udp      17 30 src=10.13.1.101 dst=8.8.8.8 sport=15003 dport=53 packets=1 bytes=66 [UNREPLIED] src=8.8.8.8 dst=10.13.1.101 sport=53 dport=15003 packets=0 bytes=0 mark=256 use=2
ipv4     2 tcp      6 2814 ESTABLISHED src=10.11.21.140 dst=46.33.72.59 sport=52940 dport=80 packets=4 bytes=160 [UNREPLIED] src=46.33.72.59 dst=10.11.21.140 sport=80 dport=52940 packets=0 bytes=0 mark=512 use=2
ipv4     2 tcp      6 2780 ESTABLISHED src=173.194.69.94 dst=10.10.39.177 sport=80 dport=46477 packets=2 bytes=2293 src=10.10.39.177 dst=173.194.69.94 sport=46477 dport=80 packets=1 bytes=64 [ASSURED] mark=1024 use=2
ipv4     2 icmp     1 9 src=10.13.1.121 dst=8.8.8.8 type=8 code=0 id=5343 packets=1 bytes=84 [UNREPLIED] src=8.8.8.8 dst=10.13.1.121 type=0 code=0 id=5343 packets=0 bytes=0 mark=768 use=2
ipv4     2 tcp      6 3599 ESTABLISHED src=10.10.20.2 dst=10.10.4.229 sport=22 dport=59967 packets=282 bytes=68674 [UNREPLIED] src=10.10.4.229 dst=10.10.20.2 sport=59967 dport=22 packets=0 bytes=0 mark=32512 use=2
ipv4     2 icmp     1 23 src=10.13.1.221 dst=8.8.4.4 type=8 code=0 id=5365 packets=1 bytes=84 [UNREPLIED] src=8.8.4.4 dst=10.13.1.221 type=0 code=0 id=5365 packets=0 bytes=0 mark=1024 use=2
ipv4     2 tcp      6 2801 ESTABLISHED src=10.12.6.117 dst=77.67.60.154 sport=51423 dport=80 packets=5 bytes=212 src=77.67.60.154 dst=10.12.6.117 sport=80 dport=51423 packets=5 bytes=7460 [ASSURED] mark=1024 use=2
ipv4     2 icmp     1 16 src=10.13.1.101 dst=8.8.8.8 type=8 code=0 id=5355 packets=1 bytes=84 [UNREPLIED] src=8.8.8.8 dst=10.13.1.101 type=0 code=0 id=5355 packets=0 bytes=0 mark=256 use=2
ipv4     2 tcp      6 2803 ESTABLISHED src=10.12.6.117 dst=213.199.179.153 sport=51429 dport=40002 packets=1 bytes=107 [UNREPLIED] src=213.199.179.153 dst=10.12.6.117 sport=40002 dport=51429 packets=0 bytes=0 mark=1024 use=2
ipv4     2 udp      17 25 src=10.10.20.2 dst=10.10.10.39 sport=53 dport=35191 packets=1 bytes=117 [UNREPLIED] src=10.10.10.39 dst=10.10.20.2 sport=35191 dport=53 packets=0 bytes=0 mark=32512 use=2
ipv4     2 icmp     1 10 src=10.13.1.201 dst=8.8.4.4 type=8 code=0 id=5345 packets=1 bytes=84 [UNREPLIED] src=8.8.4.4 dst=10.13.1.201 type=0 code=0 id=5345 packets=0 bytes=0 mark=512 use=2
ipv4     2 udp      17 25 src=10.10.20.2 dst=10.10.10.39 sport=53 dport=20355 packets=1 bytes=236 [UNREPLIED] src=10.10.10.39 dst=10.10.20.2 sport=20355 dport=53 packets=0 bytes=0 mark=32512 use=2
ipv4     2 udp      17 39 src=10.10.20.2 dst=10.100.10.12 sport=53 dport=38356 packets=1 bytes=90 [UNREPLIED] src=10.100.10.12 dst=10.10.20.2 sport=38356 dport=53 packets=0 bytes=0 mark=32512 use=2
ipv4     2 udp      17 40 src=10.10.20.2 dst=10.100.10.12 sport=53 dport=9135 packets=1 bytes=157 [UNREPLIED] src=10.100.10.12 dst=10.10.20.2 sport=9135 dport=53 packets=0 bytes=0 mark=32512 use=2
ipv4     2 udp      17 30 src=10.13.1.101 dst=8.8.8.8 sport=20503 dport=53 packets=1 bytes=59 [UNREPLIED] src=8.8.8.8 dst=10.13.1.101 sport=53 dport=20503 packets=0 bytes=0 mark=256 use=2
ipv4     2 udp      17 39 src=10.10.20.2 dst=10.100.10.12 sport=53 dport=14443 packets=1 bytes=151 [UNREPLIED] src=10.100.10.12 dst=10.10.20.2 sport=14443 dport=53 packets=0 bytes=0 mark=32512 use=2
ipv4     2 udp      17 24 src=10.10.20.2 dst=10.11.10.24 sport=53 dport=10523 packets=1 bytes=76 [UNREPLIED] src=10.11.10.24 dst=10.10.20.2 sport=10523 dport=53 packets=0 bytes=0 mark=32512 use=2
ipv4     2 icmp     1 19 src=10.13.1.121 dst=8.8.8.8 type=8 code=0 id=5359 packets=1 bytes=84 [UNREPLIED] src=8.8.8.8 dst=10.13.1.121 type=0 code=0 id=5359 packets=0 bytes=0 mark=768 use=2
ipv4     2 udp      17 29 src=10.10.20.2 dst=10.10.10.39 sport=53 dport=58034 packets=1 bytes=86 [UNREPLIED] src=10.10.10.39 dst=10.10.20.2 sport=58034 dport=53 packets=0 bytes=0 mark=32512 use=2
ipv4     2 icmp     1 8 src=10.13.1.221 dst=8.8.4.4 type=8 code=0 id=5341 packets=1 bytes=84 [UNREPLIED] src=8.8.4.4 dst=10.13.1.221 type=0 code=0 id=5341 packets=0 bytes=0 mark=1024 use=2
ipv4     2 tcp      6 2824 ESTABLISHED src=10.13.1.122 dst=10.10.4.5 sport=444 dport=42459 packets=1 bytes=64 [UNREPLIED] src=10.10.4.5 dst=10.13.1.122 sport=42459 dport=444 packets=0 bytes=0 mark=768 use=2
ipv4     2 udp      17 30 src=10.13.1.101 dst=8.8.8.8 sport=31685 dport=53 packets=1 bytes=59 [UNREPLIED] src=8.8.8.8 dst=10.13.1.101 sport=53 dport=31685 packets=0 bytes=0 mark=256 use=2
ipv4     2 tcp      6 2795 ESTABLISHED src=10.10.4.5 dst=10.13.1.202 sport=59861 dport=444 packets=3 bytes=587 src=10.13.1.202 dst=10.10.4.5 sport=444 dport=59861 packets=3 bytes=301 [ASSURED] mark=512 use=2</code></pre></div><p>Greetings Bluse</p>									</div>
			</article>

			
		
						<div class="notice">
				<p>Sorry, posts 501 to 500 are missing from our archive.</p>
			</div>
		
		
	
	<div class="pagination"><div class="pagination-number">Page 20 of 65</div><nav><ul><li><a href="viewtopic.php%3Fid=39052&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=39052&amp;p=18.html">18</a></li><li><a href="viewtopic.php%3Fid=39052&amp;p=19.html">19</a></li><li class="pagination-current"><span>20</span></li><li><a href="viewtopic.php%3Fid=39052&amp;p=21.html">21</a></li><li><a href="viewtopic.php%3Fid=39052&amp;p=22.html">22</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=39052&amp;p=65.html">65</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0.001 -->

</body>
</html>