<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> mwan3; multi-wan policy routing (general topic)</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 22 May 2013 and 6 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 46 of 65</div><nav><ul><li><a href="viewtopic.php%3Fid=39052&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=39052&amp;p=44.html">44</a></li><li><a href="viewtopic.php%3Fid=39052&amp;p=45.html">45</a></li><li class="pagination-current"><span>46</span></li><li><a href="viewtopic.php%3Fid=39052&amp;p=47.html">47</a></li><li><a href="viewtopic.php%3Fid=39052&amp;p=48.html">48</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=39052&amp;p=65.html">65</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p263808">
				<div class="post-metadata">
					<div class="post-num">Post #1126</div>
					<div class="post-author">arfett</div>
					<div class="post-datetime">
						2 Feb 2015, 08:05					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>noko wrote:</cite><blockquote><p>Thank you. It&#039;s truly miniupnpd hotplug script issues. </p><p>Actually this string:<br /></p><div class="codebox"><pre><code>if [ ! /etc/init.d/miniupnpd enabled ]</code></pre></div><p>How can I submit a bug report about this package?</p></blockquote></div><p><a href="https://github.com/openwrt/packages/issues">https://github.com/openwrt/packages/issues</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p263940">
				<div class="post-metadata">
					<div class="post-num">Post #1127</div>
					<div class="post-author">wacke</div>
					<div class="post-datetime">
						3 Feb 2015, 06:21					</div>
				</div>
				<div class="post-content content">
					<p>hi,all<br />I have some problems with using mwan3.my mwan3 have upated to the latest version,but not all rules worked.<br />my mwan3 config:<br /></p><div class="codebox"><pre><code>config rule &#039;IPv6&#039;
    option dest_ip &#039;216.218.221.6&#039;
    option proto &#039;all&#039;
    option use_policy &#039;wan2_only&#039;

config rule &#039;HOMEServer_IPv6&#039;
    option dest_ip &#039;tb.ipv6.sparqnet.net&#039;
    option proto &#039;all&#039;
    option use_policy &#039;wan3_only&#039;

config rule &#039;VPS1&#039;
    option proto &#039;all&#039;
    option use_policy &#039;wan6_only&#039;
    option dest_ip &#039;106.185.35.124&#039;

config rule &#039;HDRoad&#039;
    option dest_ip &#039;hdrote.org&#039;
    option dest_port &#039;80,443&#039;
    option proto &#039;tcp&#039;
    option use_policy &#039;wan5_only&#039;

config rule &#039;m_team&#039;
    option dest_port &#039;80,443&#039;
    option proto &#039;tcp&#039;
    option use_policy &#039;wan5_only&#039;
    option dest_ip &#039;tp.m-team.cc&#039;

config rule &#039;XiaoMi&#039;
    option proto &#039;all&#039;
    option use_policy &#039;xiaomi_lb&#039;
    option src_ip &#039;192.168.1.10,192.168.1.11,192.168.1.244&#039;

config rule &#039;youku&#039;
    option dest_ip &#039;*.youku.com&#039;
    option proto &#039;all&#039;
    option use_policy &#039;xiaomi_lb&#039;

config rule &#039;iqiyi&#039;
    option dest_ip &#039;*.iqiyi.com&#039;
    option proto &#039;all&#039;
    option use_policy &#039;xiaomi_lb&#039;

config rule &#039;tudou&#039;
    option dest_ip &#039;*.tudou.com&#039;
    option proto &#039;all&#039;
    option use_policy &#039;xiaomi_lb&#039;

config rule &#039;QQ&#039;
    option dest_ip &#039;*.qq.com&#039;
    option proto &#039;all&#039;
    option use_policy &#039;wan2_only&#039;

config rule &#039;DNS&#039;
    option dest_ip &#039;114.114.114.114,114.114.115.115,1.2.4.8&#039;
    option use_policy &#039;wan11_only&#039;
    option proto &#039;all&#039;

config rule &#039;ip138&#039;
    option dest_ip &#039;ip138.com&#039;
    option proto &#039;all&#039;
    option use_policy &#039;wan11_only&#039;

config rule &#039;WEB&#039;
    option use_policy &#039;wan11_only&#039;
    option dest_port &#039;22,25,80,110,143,443,465,587,993,995,8000&#039;
    option proto &#039;tcp&#039;

config rule &#039;loadbalance&#039;
    option use_policy &#039;loadbalanced&#039;
    option proto &#039;all&#039;
    option equalize &#039;1&#039;

config policy &#039;wan1_only&#039;
    list use_member &#039;wan1_m1_w2&#039;

config policy &#039;wan2_only&#039;
    list use_member &#039;wan2_m1_w2&#039;

config policy &#039;wan3_only&#039;
    list use_member &#039;wan3_m1_w2&#039;

config policy &#039;wan4_only&#039;
    list use_member &#039;wan4_m1_w2&#039;

config policy &#039;wan5_only&#039;
    list use_member &#039;wan5_m1_w2&#039;

config policy &#039;wan6_only&#039;
    list use_member &#039;wan6_m1_w2&#039;

config policy &#039;wan7_only&#039;
    list use_member &#039;wan7_m1_w2&#039;

config policy &#039;wan8_only&#039;
    list use_member &#039;wan8_m1_w2&#039;

config policy &#039;wan9_only&#039;
    list use_member &#039;wan9_m1_w2&#039;

config policy &#039;wan10_only&#039;
    list use_member &#039;wan10_m1_w2&#039;

config policy &#039;wan11_only&#039;
    list use_member &#039;wan11_m1_w1&#039;

config policy &#039;xiaomi_lb&#039;
    list use_member &#039;wan7_m1_w2&#039;
    list use_member &#039;wan8_m1_w2&#039;
    list use_member &#039;wan9_m1_w2&#039;
    list use_member &#039;wan10_m1_w2&#039;

config policy &#039;loadbalanced&#039;
    list use_member &#039;wan1_m1_w2&#039;
    list use_member &#039;wan2_m1_w2&#039;
    list use_member &#039;wan3_m1_w2&#039;
    list use_member &#039;wan4_m1_w2&#039;
    list use_member &#039;wan5_m1_w2&#039;
    list use_member &#039;wan6_m1_w2&#039;
    list use_member &#039;wan7_m1_w2&#039;
    list use_member &#039;wan8_m1_w2&#039;
    list use_member &#039;wan9_m1_w2&#039;
    list use_member &#039;wan10_m1_w2&#039;

config interface &#039;wan1&#039;
    option enabled &#039;1&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option down &#039;3&#039;
    option up &#039;3&#039;
    option timeout &#039;3&#039;
    list track_ip &#039;114.114.114.114&#039;
    list track_ip &#039;114.114.115.115&#039;
    option interval &#039;3600&#039;

config interface &#039;wan2&#039;
    option enabled &#039;1&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option down &#039;3&#039;
    option up &#039;3&#039;
    option timeout &#039;3&#039;
    list track_ip &#039;114.114.114.114&#039;
    list track_ip &#039;114.114.115.115&#039;
    option interval &#039;3600&#039;

config interface &#039;wan3&#039;
    option enabled &#039;1&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option down &#039;3&#039;
    option up &#039;3&#039;
    option timeout &#039;3&#039;
    list track_ip &#039;114.114.114.114&#039;
    list track_ip &#039;114.114.115.115&#039;
    option interval &#039;3600&#039;

config interface &#039;wan4&#039;
    option enabled &#039;1&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option down &#039;3&#039;
    option up &#039;3&#039;
    option timeout &#039;3&#039;
    list track_ip &#039;114.114.114.114&#039;
    list track_ip &#039;114.114.115.115&#039;
    option interval &#039;3600&#039;

config interface &#039;wan5&#039;
    option enabled &#039;1&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option down &#039;3&#039;
    option up &#039;3&#039;
    option timeout &#039;3&#039;
    list track_ip &#039;114.114.114.114&#039;
    list track_ip &#039;114.114.115.115&#039;
    option interval &#039;3600&#039;

config interface &#039;wan6&#039;
    option enabled &#039;1&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option down &#039;3&#039;
    option up &#039;3&#039;
    option timeout &#039;3&#039;
    list track_ip &#039;114.114.114.114&#039;
    list track_ip &#039;114.114.115.115&#039;
    option interval &#039;3600&#039;

config interface &#039;wan7&#039;
    option enabled &#039;1&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option down &#039;3&#039;
    option up &#039;3&#039;
    option timeout &#039;3&#039;
    list track_ip &#039;114.114.114.114&#039;
    list track_ip &#039;114.114.115.115&#039;
    option interval &#039;3600&#039;

config interface &#039;wan8&#039;
    option enabled &#039;1&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option down &#039;3&#039;
    option up &#039;3&#039;
    option timeout &#039;3&#039;
    list track_ip &#039;114.114.114.114&#039;
    list track_ip &#039;114.114.115.115&#039;
    option interval &#039;3600&#039;

config interface &#039;wan9&#039;
    option enabled &#039;1&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option down &#039;3&#039;
    option up &#039;3&#039;
    option timeout &#039;3&#039;
    list track_ip &#039;114.114.114.114&#039;
    list track_ip &#039;114.114.115.115&#039;
    option interval &#039;3600&#039;

config interface &#039;wan10&#039;
    option enabled &#039;1&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option down &#039;3&#039;
    option up &#039;3&#039;
    option timeout &#039;3&#039;
    list track_ip &#039;114.114.114.114&#039;
    list track_ip &#039;114.114.115.115&#039;
    option interval &#039;3600&#039;

config interface &#039;wan11&#039;
    option enabled &#039;1&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option down &#039;3&#039;
    option up &#039;3&#039;
    option timeout &#039;3&#039;
    list track_ip &#039;114.114.114.114&#039;
    list track_ip &#039;114.114.115.115&#039;
    option interval &#039;3600&#039;

config member &#039;wan1_m1_w2&#039;
    option metric &#039;1&#039;
    option interface &#039;wan1&#039;
    option weight &#039;2&#039;

config member &#039;wan2_m1_w2&#039;
    option interface &#039;wan2&#039;
    option metric &#039;1&#039;
    option weight &#039;2&#039;

config member &#039;wan3_m1_w2&#039;
    option interface &#039;wan3&#039;
    option metric &#039;1&#039;
    option weight &#039;2&#039;

config member &#039;wan4_m1_w2&#039;
    option interface &#039;wan4&#039;
    option metric &#039;1&#039;
    option weight &#039;2&#039;

config member &#039;wan5_m1_w2&#039;
    option interface &#039;wan5&#039;
    option metric &#039;1&#039;
    option weight &#039;2&#039;

config member &#039;wan6_m1_w2&#039;
    option interface &#039;wan6&#039;
    option metric &#039;1&#039;
    option weight &#039;2&#039;

config member &#039;wan7_m1_w2&#039;
    option interface &#039;wan6&#039;
    option metric &#039;1&#039;
    option weight &#039;2&#039;

config member &#039;wan8_m1_w2&#039;
    option interface &#039;wan6&#039;
    option metric &#039;1&#039;
    option weight &#039;2&#039;

config member &#039;wan9_m1_w2&#039;
    option interface &#039;wan6&#039;
    option metric &#039;1&#039;
    option weight &#039;2&#039;

config member &#039;wan10_m1_w2&#039;
    option interface &#039;wan6&#039;
    option metric &#039;1&#039;
    option weight &#039;2&#039;

config member &#039;wan11_m1_w1&#039;
    option interface &#039;wan6&#039;
    option metric &#039;1&#039;
    option weight &#039;2&#039;</code></pre></div><p>my network config:<br /></p><div class="codebox"><pre><code>config interface &#039;loopback&#039;
    option ifname &#039;lo&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;127.0.0.1&#039;
    option netmask &#039;255.0.0.0&#039;

config interface &#039;lan&#039;
    option type &#039;bridge&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;192.168.1.1&#039;
    option netmask &#039;255.255.255.0&#039;
    option _orig_ifname &#039;eth0&#039;
    option _orig_bridge &#039;true&#039;
    option ifname &#039;eth0 eth1&#039;
    option stp &#039;1&#039;
    option ip6assign &#039;64&#039;

config globals &#039;globals&#039;
    option ula_prefix &#039;2001:470:fbde:1::/64&#039;

config interface &#039;wan1&#039;
    option _orig_ifname &#039;eth3&#039;
    option _orig_bridge &#039;true&#039;
    option proto &#039;pppoe&#039;
    option ifname &#039;eth3&#039;
    option username &#039;13601508872&#039;
    option password &#039;881025&#039;
    option metric &#039;1&#039;

config interface &#039;wan2&#039;
    option _orig_ifname &#039;eth3&#039;
    option _orig_bridge &#039;true&#039;
    option proto &#039;pppoe&#039;
    option ifname &#039;eth3&#039;
    option username &#039;13601508872&#039;
    option password &#039;881025&#039;
    option metric &#039;2&#039;

config interface &#039;wan3&#039;
    option _orig_ifname &#039;eth3&#039;
    option _orig_bridge &#039;true&#039;
    option proto &#039;pppoe&#039;
    option ifname &#039;eth3&#039;
    option username &#039;13601508872&#039;
    option password &#039;881025&#039;
    option metric &#039;3&#039;

config interface &#039;wan4&#039;
    option proto &#039;pppoe&#039;
    option ifname &#039;eth3&#039;
    option username &#039;13601508872&#039;
    option password &#039;881025&#039;
    option metric &#039;4&#039;

config interface &#039;wan5&#039;
    option _orig_ifname &#039;eth3&#039;
    option _orig_bridge &#039;true&#039;
    option proto &#039;pppoe&#039;
    option ifname &#039;eth3&#039;
    option username &#039;13601508872&#039;
    option password &#039;881025&#039;
    option metric &#039;5&#039;

config interface &#039;wan6&#039;
    option _orig_ifname &#039;eth3&#039;
    option _orig_bridge &#039;true&#039;
    option proto &#039;pppoe&#039;
    option ifname &#039;eth3&#039;
    option username &#039;13601508872&#039;
    option password &#039;881025&#039;
    option metric &#039;6&#039;

config interface &#039;wan7&#039;
    option _orig_ifname &#039;eth3&#039;
    option _orig_bridge &#039;true&#039;
    option proto &#039;pppoe&#039;
    option ifname &#039;eth3&#039;
    option username &#039;13601508872&#039;
    option password &#039;881025&#039;
    option metric &#039;7&#039;

config interface &#039;wan8&#039;
    option _orig_ifname &#039;eth3&#039;
    option _orig_bridge &#039;true&#039;
    option proto &#039;pppoe&#039;
    option ifname &#039;eth3&#039;
    option username &#039;13601508872&#039;
    option password &#039;881025&#039;
    option metric &#039;8&#039;

config interface &#039;wan9&#039;
    option _orig_ifname &#039;eth3&#039;
    option _orig_bridge &#039;true&#039;
    option proto &#039;pppoe&#039;
    option ifname &#039;eth3&#039;
    option username &#039;13601508872&#039;
    option password &#039;881025&#039;
    option metric &#039;9&#039;

config interface &#039;wan10&#039;
    option _orig_ifname &#039;eth3&#039;
    option _orig_bridge &#039;true&#039;
    option proto &#039;pppoe&#039;
    option ifname &#039;eth3&#039;
    option username &#039;13601508872&#039;
    option password &#039;881025&#039;
    option metric &#039;10&#039;

config interface &#039;wan11&#039;
    option proto &#039;pppoe&#039;
    option ifname &#039;eth2&#039;
    option username &#039;051915753643&#039;
    option password &#039;963852&#039;
    option metric &#039;11&#039;

config interface &#039;wan12&#039;
    option proto &#039;6in4&#039;
    option peeraddr &#039;216.218.221.6&#039;
    option ip6addr &#039;2001:470:18:978::2/64&#039;
    option ip6prefix &#039;2001:470:fbde::/48&#039;
    option metric &#039;12&#039;
    option mtu &#039;1480&#039;</code></pre></div><p>eg:I config a rule to get &quot;tcp 22,25,80,110,143,443,465,587,993,995,8000&quot; to &quot;wan11&quot;,but it just not work.<br />&nbsp; &nbsp;<br />run &quot;mwan3 status&quot; got this:<br /></p><div class="codebox"><pre><code>root@HOME-Router:~# mwan3 status
Interface status:
Interface wan1 is online (tracking active)
Interface wan2 is online (tracking active)
Interface wan3 is online (tracking active)
Interface wan4 is online (tracking active)
Interface wan5 is online (tracking active)
Interface wan6 is online (tracking active)
Interface wan7 is online (tracking active)
Interface wan8 is online (tracking active)
Interface wan9 is online (tracking active)
Interface wan10 is online (tracking active)
Interface wan11 is online (tracking active)

Policy loadbalanced:
/usr/sbin/mwan3: line 1: arithmetic syntax error</code></pre></div><p>run &quot;mwan3 policies&quot; got this:<br /></p><div class="codebox"><pre><code>/usr/sbin/mwan3: line 212: arithmetic syntax error</code></pre></div><p>run &quot;mwan3 rules&quot; result<br /></p><div class="codebox"><pre><code>root@HOME-Router:~# mwan3 rules
Known networks:
destination        policy             hits     
-----------------------------------------------
127.0.0.0/8        default            515      
224.0.0.0/3        default            549      
112.21.150.1       default            0        
112.21.150.1       default            0        
112.21.153.1       default            0        
114.228.32.1       default            0        
183.213.154.1      default            0        
183.213.154.1      default            0        
192.168.1.0/24     default            7549     
192.168.1.0/24     default            7549     
223.66.36.1        default            0        
223.66.36.1        default            0        
223.66.70.1        default            0        
223.66.70.1        default            0        
223.66.93.1        default            0        
112.21.150.3       default            8342     
112.21.150.249     default            5292     
112.21.153.173     default            1719     
114.228.43.139     default            3315     
127.0.0.0          default            0        
127.0.0.0/8        default            515      
127.0.0.1          default            515      
127.255.255.255    default            0        
183.213.155.163    default            8966     
183.213.155.202    default            1337     
192.168.1.0        default            0        
192.168.1.0        default            0        
192.168.1.1        default            6956     
192.168.1.4        default            0        
192.168.1.255      default            286      
192.168.1.255      default            286      
223.66.37.127      default            120K     
223.66.37.180      default            1705K    
223.66.70.249      default            1498     
223.66.71.145      default            1235     
223.66.93.126      default            607K     

Active rules:
source             destination        proto  src-port      dest-port     policy          hits     
--------------------------------------------------------------------------------------------------
0.0.0.0/0          216.218.221.6      all                                wan2_only       7        
0.0.0.0/0          61.66.254.3        all                                wan3_only       0        
0.0.0.0/0          106.185.35.124     all                                wan6_only       0        
0.0.0.0/0          107.182.170.243    tcp    0:65535       80,443        wan5_only       207      
192.168.1.10       0.0.0.0/0          all                                xiaomi_lb       1124     
192.168.1.11       0.0.0.0/0          all                                xiaomi_lb       0        
192.168.1.244      0.0.0.0/0          all                                xiaomi_lb       0        
0.0.0.0/0          114.114.114.114    all                                wan11_only      6742     
0.0.0.0/0          114.114.115.115    all                                wan11_only      1251     
0.0.0.0/0          1.2.4.8            all                                wan11_only      856      
0.0.0.0/0          211.142.22.26      all                                wan11_only      0        
0.0.0.0/0          211.142.22.25      all                                wan11_only      7        
0.0.0.0/0          211.142.22.24      all                                wan11_only      0        
0.0.0.0/0          0.0.0.0/0          tcp    0:65535       22,25,80,110,143,443,465,587,993,995,8000wan11_only      2558     
0.0.0.0/0          0.0.0.0/0          all                                loadbalanced    7519     </code></pre></div><p>Is there anynoe can figure this out?Thank you.</p>											<p class="post-edited">(Last edited by <strong>wacke</strong> on 3 Feb 2015, 06:28)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p263980">
				<div class="post-metadata">
					<div class="post-num">Post #1128</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						3 Feb 2015, 11:47					</div>
				</div>
				<div class="post-content content">
					<p>Hi wacke,</p><br /><p>Two things strike me. One is an error in your config:</p><div class="codebox"><pre><code>config member &#039;wan11_m1_w1&#039;
    option interface &#039;wan6&#039;
    option metric &#039;1&#039;
    option weight &#039;2&#039;</code></pre></div><p>I believe the interface is incorrect. But this does not explain the erros you get when running &quot;mwan3 status&quot; command. I will look into this. Could you please post &quot;iptables -L -t mangle -v -n&quot; outcome? Thank you!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264003">
				<div class="post-metadata">
					<div class="post-num">Post #1129</div>
					<div class="post-author">wacke</div>
					<div class="post-datetime">
						3 Feb 2015, 14:22					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Adze wrote:</cite><blockquote><p>Hi wacke,</p><br /><p>Two things strike me. One is an error in your config:</p><div class="codebox"><pre><code>config member &#039;wan11_m1_w1&#039;
    option interface &#039;wan6&#039;
    option metric &#039;1&#039;
    option weight &#039;2&#039;</code></pre></div><p>I believe the interface is incorrect. But this does not explain the erros you get when running &quot;mwan3 status&quot; command. I will look into this. Could you please post &quot;iptables -L -t mangle -v -n&quot; outcome? Thank you!</p></blockquote></div><br /><p>Hi,adze<br />Thank you for your reply,here is the &quot;iptables -L -t mangle -v -n&quot; out put.<br /></p><div class="codebox"><pre><code>root@HOME-Router:~# iptables -L -t mangle -v -n
Chain PREROUTING (policy ACCEPT 13M packets, 13G bytes)
 pkts bytes target     prot opt in     out     source               destination         
  13M   13G mwan3_hook  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
  13M   13G fwmark     all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain INPUT (policy ACCEPT 145K packets, 17M bytes)
 pkts bytes target     prot opt in     out     source               destination         

Chain FORWARD (policy ACCEPT 13M packets, 13G bytes)
 pkts bytes target     prot opt in     out     source               destination         
  13M   13G mssfix     all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain OUTPUT (policy ACCEPT 209K packets, 46M bytes)
 pkts bytes target     prot opt in     out     source               destination         
 209K   46M mwan3_hook  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
 209K   46M mwan3_output_hook  all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain POSTROUTING (policy ACCEPT 13M packets, 13G bytes)
 pkts bytes target     prot opt in     out     source               destination                                                                                
7128K 5910M bw_egress  all  --  *      br-lan  0.0.0.0/0            0.0.0.0/0                                                                                  
                                                                                                                                                               
Chain bw_egress (1 references)                                                                                                                                 
 pkts bytes target     prot opt in     out     source               destination                                                                                
                                                                                                                                                               
Chain fwmark (1 references)                                                                                                                                    
 pkts bytes target     prot opt in     out     source               destination                                                                                
                                                                                                                                                               
Chain mssfix (1 references)                                                                                                                                    
 pkts bytes target     prot opt in     out     source               destination                                                                                
 1475 87520 TCPMSS     tcp  --  *      pppoe-wan1  0.0.0.0/0            0.0.0.0/0            tcp flags:0x06/0x02 /* wan (mtu_fix) */ TCPMSS clamp to PMTU      
 1324 78836 TCPMSS     tcp  --  *      pppoe-wan2  0.0.0.0/0            0.0.0.0/0            tcp flags:0x06/0x02 /* wan (mtu_fix) */ TCPMSS clamp to PMTU      
 5932  321K TCPMSS     tcp  --  *      pppoe-wan3  0.0.0.0/0            0.0.0.0/0            tcp flags:0x06/0x02 /* wan (mtu_fix) */ TCPMSS clamp to PMTU      
 1357 80588 TCPMSS     tcp  --  *      pppoe-wan4  0.0.0.0/0            0.0.0.0/0            tcp flags:0x06/0x02 /* wan (mtu_fix) */ TCPMSS clamp to PMTU      
 2525  145K TCPMSS     tcp  --  *      pppoe-wan5  0.0.0.0/0            0.0.0.0/0            tcp flags:0x06/0x02 /* wan (mtu_fix) */ TCPMSS clamp to PMTU      
19951 1153K TCPMSS     tcp  --  *      pppoe-wan6  0.0.0.0/0            0.0.0.0/0            tcp flags:0x06/0x02 /* wan (mtu_fix) */ TCPMSS clamp to PMTU      
   86  4156 TCPMSS     tcp  --  *      pppoe-wan7  0.0.0.0/0            0.0.0.0/0            tcp flags:0x06/0x02 /* wan (mtu_fix) */ TCPMSS clamp to PMTU      
   62  2908 TCPMSS     tcp  --  *      pppoe-wan8  0.0.0.0/0            0.0.0.0/0            tcp flags:0x06/0x02 /* wan (mtu_fix) */ TCPMSS clamp to PMTU
   32  1536 TCPMSS     tcp  --  *      pppoe-wan9  0.0.0.0/0            0.0.0.0/0            tcp flags:0x06/0x02 /* wan (mtu_fix) */ TCPMSS clamp to PMTU
   88  4232 TCPMSS     tcp  --  *      pppoe-wan10  0.0.0.0/0            0.0.0.0/0            tcp flags:0x06/0x02 /* wan (mtu_fix) */ TCPMSS clamp to PMTU
   61  2828 TCPMSS     tcp  --  *      pppoe-wan11  0.0.0.0/0            0.0.0.0/0            tcp flags:0x06/0x02 /* wan (mtu_fix) */ TCPMSS clamp to PMTU
    0     0 TCPMSS     tcp  --  *      6in4-wan12  0.0.0.0/0            0.0.0.0/0            tcp flags:0x06/0x02 /* wan (mtu_fix) */ TCPMSS clamp to PMTU

Chain mwan3_connected (2 references)
 pkts bytes target     prot opt in     out     source               destination         
  756 48289 MARK       all  --  *      *       0.0.0.0/0            127.0.0.0/8          MARK or 0xff00
 1012  247K MARK       all  --  *      *       0.0.0.0/0            224.0.0.0/3          MARK or 0xff00
    0     0 MARK       all  --  *      *       0.0.0.0/0            112.21.150.1         MARK or 0xff00
    0     0 MARK       all  --  *      *       0.0.0.0/0            112.21.150.1         MARK or 0xff00
    0     0 MARK       all  --  *      *       0.0.0.0/0            112.21.153.1         MARK or 0xff00
    0     0 MARK       all  --  *      *       0.0.0.0/0            114.228.32.1         MARK or 0xff00
    0     0 MARK       all  --  *      *       0.0.0.0/0            183.213.154.1        MARK or 0xff00
    0     0 MARK       all  --  *      *       0.0.0.0/0            183.213.154.1        MARK or 0xff00
13825 1089K MARK       all  --  *      *       0.0.0.0/0            192.168.1.0/24       MARK or 0xff00
13825 1089K MARK       all  --  *      *       0.0.0.0/0            192.168.1.0/24       MARK or 0xff00
    0     0 MARK       all  --  *      *       0.0.0.0/0            223.66.36.1          MARK or 0xff00
    0     0 MARK       all  --  *      *       0.0.0.0/0            223.66.36.1          MARK or 0xff00
    0     0 MARK       all  --  *      *       0.0.0.0/0            223.66.70.1          MARK or 0xff00
    0     0 MARK       all  --  *      *       0.0.0.0/0            223.66.70.1          MARK or 0xff00
    0     0 MARK       all  --  *      *       0.0.0.0/0            223.66.93.1          MARK or 0xff00
13985 3900K MARK       all  --  *      *       0.0.0.0/0            112.21.150.3         MARK or 0xff00
 9974 5085K MARK       all  --  *      *       0.0.0.0/0            112.21.150.249       MARK or 0xff00
 3035  138K MARK       all  --  *      *       0.0.0.0/0            112.21.153.173       MARK or 0xff00
 5289  231K MARK       all  --  *      *       0.0.0.0/0            114.228.43.139       MARK or 0xff00
    0     0 MARK       all  --  *      *       0.0.0.0/0            127.0.0.0            MARK or 0xff00
  756 48289 MARK       all  --  *      *       0.0.0.0/0            127.0.0.0/8          MARK or 0xff00
  756 48289 MARK       all  --  *      *       0.0.0.0/0            127.0.0.1            MARK or 0xff00
    0     0 MARK       all  --  *      *       0.0.0.0/0            127.255.255.255      MARK or 0xff00
12175 2655K MARK       all  --  *      *       0.0.0.0/0            183.213.155.163      MARK or 0xff00
 2225  102K MARK       all  --  *      *       0.0.0.0/0            183.213.155.202      MARK or 0xff00
    0     0 MARK       all  --  *      *       0.0.0.0/0            192.168.1.0          MARK or 0xff00
    0     0 MARK       all  --  *      *       0.0.0.0/0            192.168.1.0          MARK or 0xff00
12846  813K MARK       all  --  *      *       0.0.0.0/0            192.168.1.1          MARK or 0xff00
    0     0 MARK       all  --  *      *       0.0.0.0/0            192.168.1.4          MARK or 0xff00
  460 71647 MARK       all  --  *      *       0.0.0.0/0            192.168.1.255        MARK or 0xff00
  460 71647 MARK       all  --  *      *       0.0.0.0/0            192.168.1.255        MARK or 0xff00
 320K  138M MARK       all  --  *      *       0.0.0.0/0            223.66.37.127        MARK or 0xff00
1710K   83M MARK       all  --  *      *       0.0.0.0/0            223.66.37.180        MARK or 0xff00
 2522  111K MARK       all  --  *      *       0.0.0.0/0            223.66.70.249        MARK or 0xff00
 2057 90790 MARK       all  --  *      *       0.0.0.0/0            223.66.71.145        MARK or 0xff00
4722K 5323M MARK       all  --  *      *       0.0.0.0/0            223.66.93.126        MARK or 0xff00

Chain mwan3_hook (2 references)
 pkts bytes target     prot opt in     out     source               destination         
  13M   13G CONNMARK   all  --  *      *       0.0.0.0/0            0.0.0.0/0            CONNMARK restore mask 0xff00
99556 6265K mwan3_ifaces  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00
50706 3444K mwan3_connected  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00
35077 2149K mwan3_rules  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00
  13M   13G CONNMARK   all  --  *      *       0.0.0.0/0            0.0.0.0/0            CONNMARK save mask 0xff00
  13M   13G mwan3_connected  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match ! 0xff00/0xff00

Chain mwan3_iface_wan1 (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MARK       all  --  pppoe-wan1 *       112.21.150.1         0.0.0.0/0            mark match 0x0/0xff00 /* default */ MARK or 0xff00
 8081  476K MARK       all  --  pppoe-wan1 *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* wan1 */ MARK xset 0x100/0xff00

Chain mwan3_iface_wan10 (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MARK       all  --  pppoe-wan10 *       112.21.153.1         0.0.0.0/0            mark match 0x0/0xff00 /* default */ MARK or 0xff00
 2792  127K MARK       all  --  pppoe-wan10 *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* wan10 */ MARK xset 0xa00/0xff00

Chain mwan3_iface_wan11 (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MARK       all  --  pppoe-wan11 *       114.228.32.1         0.0.0.0/0            mark match 0x0/0xff00 /* default */ MARK or 0xff00
 5036  220K MARK       all  --  pppoe-wan11 *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* wan11 */ MARK xset 0xb00/0xff00

Chain mwan3_iface_wan2 (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MARK       all  --  pppoe-wan2 *       183.213.154.1        0.0.0.0/0            mark match 0x0/0xff00 /* default */ MARK or 0xff00
 2065 91425 MARK       all  --  pppoe-wan2 *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* wan2 */ MARK xset 0x200/0xff00

Chain mwan3_iface_wan3 (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MARK       all  --  pppoe-wan3 *       223.66.36.1          0.0.0.0/0            mark match 0x0/0xff00 /* default */ MARK or 0xff00
 5998  305K MARK       all  --  pppoe-wan3 *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* wan3 */ MARK xset 0x300/0xff00

Chain mwan3_iface_wan4 (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MARK       all  --  pppoe-wan4 *       112.21.150.1         0.0.0.0/0            mark match 0x0/0xff00 /* default */ MARK or 0xff00
 3201  179K MARK       all  --  pppoe-wan4 *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* wan4 */ MARK xset 0x400/0xff00

Chain mwan3_iface_wan5 (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MARK       all  --  pppoe-wan5 *       223.66.36.1          0.0.0.0/0            mark match 0x0/0xff00 /* default */ MARK or 0xff00
 2589  123K MARK       all  --  pppoe-wan5 *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* wan5 */ MARK xset 0x500/0xff00

Chain mwan3_iface_wan6 (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MARK       all  --  pppoe-wan6 *       223.66.93.1          0.0.0.0/0            mark match 0x0/0xff00 /* default */ MARK or 0xff00
12688 1014K MARK       all  --  pppoe-wan6 *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* wan6 */ MARK xset 0x600/0xff00

Chain mwan3_iface_wan7 (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MARK       all  --  pppoe-wan7 *       223.66.70.1          0.0.0.0/0            mark match 0x0/0xff00 /* default */ MARK or 0xff00
 2374  104K MARK       all  --  pppoe-wan7 *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* wan7 */ MARK xset 0x700/0xff00

Chain mwan3_iface_wan8 (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MARK       all  --  pppoe-wan8 *       223.66.70.1          0.0.0.0/0            mark match 0x0/0xff00 /* default */ MARK or 0xff00
 1896 83430 MARK       all  --  pppoe-wan8 *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* wan8 */ MARK xset 0x800/0xff00

Chain mwan3_iface_wan9 (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MARK       all  --  pppoe-wan9 *       183.213.154.1        0.0.0.0/0            mark match 0x0/0xff00 /* default */ MARK or 0xff00
 2130 97998 MARK       all  --  pppoe-wan9 *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* wan9 */ MARK xset 0x900/0xff00

Chain mwan3_ifaces (1 references)
 pkts bytes target     prot opt in     out     source               destination         
99556 6265K mwan3_iface_wan1  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00
91397 5784K mwan3_iface_wan2  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00
89299 5690K mwan3_iface_wan3  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00
83269 5383K mwan3_iface_wan4  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00
80033 5201K mwan3_iface_wan5  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00
77412 5076K mwan3_iface_wan6  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00
64702 4061K mwan3_iface_wan7  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00
62301 3954K mwan3_iface_wan8  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00
60382 3869K mwan3_iface_wan9  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00
58204 3768K mwan3_iface_wan10  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00
55369 3638K mwan3_iface_wan11  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00

Chain mwan3_output_hook (1 references)
 pkts bytes target     prot opt in     out     source               destination         
  462 14784 mwan3_track_wan1  icmp --  *      *       0.0.0.0/0            0.0.0.0/0            icmptype 8 length 32
  460 14720 mwan3_track_wan2  icmp --  *      *       0.0.0.0/0            0.0.0.0/0            icmptype 8 length 32
  458 14656 mwan3_track_wan3  icmp --  *      *       0.0.0.0/0            0.0.0.0/0            icmptype 8 length 32
  456 14592 mwan3_track_wan4  icmp --  *      *       0.0.0.0/0            0.0.0.0/0            icmptype 8 length 32
  454 14528 mwan3_track_wan5  icmp --  *      *       0.0.0.0/0            0.0.0.0/0            icmptype 8 length 32
  452 14464 mwan3_track_wan6  icmp --  *      *       0.0.0.0/0            0.0.0.0/0            icmptype 8 length 32
  450 14400 mwan3_track_wan7  icmp --  *      *       0.0.0.0/0            0.0.0.0/0            icmptype 8 length 32
  448 14336 mwan3_track_wan8  icmp --  *      *       0.0.0.0/0            0.0.0.0/0            icmptype 8 length 32
  446 14272 mwan3_track_wan9  icmp --  *      *       0.0.0.0/0            0.0.0.0/0            icmptype 8 length 32
  444 14208 mwan3_track_wan10  icmp --  *      *       0.0.0.0/0            0.0.0.0/0            icmptype 8 length 32
  442 14144 mwan3_track_wan11  icmp --  *      *       0.0.0.0/0            0.0.0.0/0            icmptype 8 length 32

Chain mwan3_policy_loadbalanced (1 references)
 pkts bytes target     prot opt in     out     source               destination         
 1262 73848 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 statistic mode random probability 0.10000000009 /* wan6 2 20 */ MARK xset 0x600/0xff00
 1218 73327 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 statistic mode random probability 0.11100000003 /* wan6 2 18 */ MARK xset 0x600/0xff00
 1244 73578 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 statistic mode random probability 0.12500000000 /* wan6 2 16 */ MARK xset 0x600/0xff00
 1290 76778 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 statistic mode random probability 0.14199999999 /* wan6 2 14 */ MARK xset 0x600/0xff00
 1247 73253 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 statistic mode random probability 0.16600000020 /* wan6 2 12 */ MARK xset 0x600/0xff00
 1269 74373 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 statistic mode random probability 0.20000000019 /* wan5 2 10 */ MARK xset 0x500/0xff00
 1202 70581 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 statistic mode random probability 0.25000000000 /* wan4 2 8 */ MARK xset 0x400/0xff00
 1270 74974 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 statistic mode random probability 0.33300000010 /* wan3 2 6 */ MARK xset 0x300/0xff00
 1239 73471 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 statistic mode random probability 0.50000000000 /* wan2 2 4 */ MARK xset 0x200/0xff00
 1211 70844 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* wan1 2 2 */ MARK xset 0x100/0xff00

Chain mwan3_policy_wan10_only (0 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* wan6 2 2 */ MARK xset 0x600/0xff00

Chain mwan3_policy_wan11_only (7 references)
 pkts bytes target     prot opt in     out     source               destination         
20050 1227K MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* wan6 2 2 */ MARK xset 0x600/0xff00

Chain mwan3_policy_wan1_only (0 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* unreachable */ MARK xset 0xfe00/0xff00

Chain mwan3_policy_wan2_only (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    9   890 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* wan2 2 2 */ MARK xset 0x200/0xff00

Chain mwan3_policy_wan3_only (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* wan3 2 2 */ MARK xset 0x300/0xff00

Chain mwan3_policy_wan4_only (0 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* wan4 2 2 */ MARK xset 0x400/0xff00

Chain mwan3_policy_wan5_only (1 references)
 pkts bytes target     prot opt in     out     source               destination         
  313 22811 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* wan5 2 2 */ MARK xset 0x500/0xff00

Chain mwan3_policy_wan6_only (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* wan6 2 2 */ MARK xset 0x600/0xff00

Chain mwan3_policy_wan7_only (0 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* wan6 2 2 */ MARK xset 0x600/0xff00

Chain mwan3_policy_wan8_only (0 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* wan6 2 2 */ MARK xset 0x600/0xff00

Chain mwan3_policy_wan9_only (0 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* wan6 2 2 */ MARK xset 0x600/0xff00

Chain mwan3_policy_xiaomi_lb (3 references)
 pkts bytes target     prot opt in     out     source               destination         
  506 37003 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 statistic mode random probability 0.25000000000 /* wan6 2 8 */ MARK xset 0x600/0xff00
  517 38104 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 statistic mode random probability 0.33300000010 /* wan6 2 6 */ MARK xset 0x600/0xff00
  493 37123 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 statistic mode random probability 0.50000000000 /* wan6 2 4 */ MARK xset 0x600/0xff00
  514 34735 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* wan6 2 2 */ MARK xset 0x600/0xff00

Chain mwan3_rules (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    9   890 mwan3_policy_wan2_only  all  --  *      *       0.0.0.0/0            216.218.221.6        mark match 0x0/0xff00 /* IPv6 */
    0     0 mwan3_policy_wan3_only  all  --  *      *       0.0.0.0/0            61.66.254.3          mark match 0x0/0xff00 /* HOMEServer_IPv6 */
    0     0 mwan3_policy_wan6_only  all  --  *      *       0.0.0.0/0            106.185.35.124       mark match 0x0/0xff00 /* VPS1 */
  313 22811 mwan3_policy_wan5_only  tcp  --  *      *       0.0.0.0/0            107.182.170.243      multiport sports 0:65535 multiport dports 80,443 mark match 0x0/0xff00 /* m_team */
 2030  147K mwan3_policy_xiaomi_lb  all  --  *      *       192.168.1.10         0.0.0.0/0            mark match 0x0/0xff00 /* XiaoMi */
    0     0 mwan3_policy_xiaomi_lb  all  --  *      *       192.168.1.11         0.0.0.0/0            mark match 0x0/0xff00 /* XiaoMi */
    0     0 mwan3_policy_xiaomi_lb  all  --  *      *       192.168.1.244        0.0.0.0/0            mark match 0x0/0xff00 /* XiaoMi */
11902  740K mwan3_policy_wan11_only  all  --  *      *       0.0.0.0/0            114.114.114.114      mark match 0x0/0xff00 /* DNS */
 2008  119K mwan3_policy_wan11_only  all  --  *      *       0.0.0.0/0            114.114.115.115      mark match 0x0/0xff00 /* DNS */
 1819  114K mwan3_policy_wan11_only  all  --  *      *       0.0.0.0/0            1.2.4.8              mark match 0x0/0xff00 /* DNS */
    0     0 mwan3_policy_wan11_only  all  --  *      *       0.0.0.0/0            211.142.22.26        mark match 0x0/0xff00 /* ip138 */
    7   420 mwan3_policy_wan11_only  all  --  *      *       0.0.0.0/0            211.142.22.25        mark match 0x0/0xff00 /* ip138 */
    0     0 mwan3_policy_wan11_only  all  --  *      *       0.0.0.0/0            211.142.22.24        mark match 0x0/0xff00 /* ip138 */
 4314  254K mwan3_policy_wan11_only  tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            multiport sports 0:65535 multiport dports 22,25,80,110,143,443,465,587,993,995,8000 mark match 0x0/0xff00 /* WEB */
12452  735K mwan3_policy_loadbalanced  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* loadbalance */

Chain mwan3_track_wan1 (1 references)
 pkts bytes target     prot opt in     out     source               destination         
  231  7392 MARK       all  --  *      *       0.0.0.0/0            114.114.115.115      MARK or 0xff00
  231  7392 MARK       all  --  *      *       0.0.0.0/0            114.114.114.114      MARK or 0xff00

Chain mwan3_track_wan10 (1 references)
 pkts bytes target     prot opt in     out     source               destination         
  222  7104 MARK       all  --  *      *       0.0.0.0/0            114.114.115.115      MARK or 0xff00
  222  7104 MARK       all  --  *      *       0.0.0.0/0            114.114.114.114      MARK or 0xff00

Chain mwan3_track_wan11 (1 references)
 pkts bytes target     prot opt in     out     source               destination         
  221  7072 MARK       all  --  *      *       0.0.0.0/0            114.114.115.115      MARK or 0xff00
  221  7072 MARK       all  --  *      *       0.0.0.0/0            114.114.114.114      MARK or 0xff00

Chain mwan3_track_wan2 (1 references)
 pkts bytes target     prot opt in     out     source               destination         
  230  7360 MARK       all  --  *      *       0.0.0.0/0            114.114.115.115      MARK or 0xff00
  230  7360 MARK       all  --  *      *       0.0.0.0/0            114.114.114.114      MARK or 0xff00

Chain mwan3_track_wan3 (1 references)
 pkts bytes target     prot opt in     out     source               destination         
  229  7328 MARK       all  --  *      *       0.0.0.0/0            114.114.115.115      MARK or 0xff00
  229  7328 MARK       all  --  *      *       0.0.0.0/0            114.114.114.114      MARK or 0xff00

Chain mwan3_track_wan4 (1 references)
 pkts bytes target     prot opt in     out     source               destination         
  228  7296 MARK       all  --  *      *       0.0.0.0/0            114.114.115.115      MARK or 0xff00
  228  7296 MARK       all  --  *      *       0.0.0.0/0            114.114.114.114      MARK or 0xff00

Chain mwan3_track_wan5 (1 references)
 pkts bytes target     prot opt in     out     source               destination         
  227  7264 MARK       all  --  *      *       0.0.0.0/0            114.114.115.115      MARK or 0xff00
  227  7264 MARK       all  --  *      *       0.0.0.0/0            114.114.114.114      MARK or 0xff00

Chain mwan3_track_wan6 (1 references)
 pkts bytes target     prot opt in     out     source               destination         
  226  7232 MARK       all  --  *      *       0.0.0.0/0            114.114.115.115      MARK or 0xff00
  226  7232 MARK       all  --  *      *       0.0.0.0/0            114.114.114.114      MARK or 0xff00

Chain mwan3_track_wan7 (1 references)
 pkts bytes target     prot opt in     out     source               destination         
  225  7200 MARK       all  --  *      *       0.0.0.0/0            114.114.115.115      MARK or 0xff00
  225  7200 MARK       all  --  *      *       0.0.0.0/0            114.114.114.114      MARK or 0xff00

Chain mwan3_track_wan8 (1 references)
 pkts bytes target     prot opt in     out     source               destination         
  224  7168 MARK       all  --  *      *       0.0.0.0/0            114.114.115.115      MARK or 0xff00
  224  7168 MARK       all  --  *      *       0.0.0.0/0            114.114.114.114      MARK or 0xff00

Chain mwan3_track_wan9 (1 references)
 pkts bytes target     prot opt in     out     source               destination         
  223  7136 MARK       all  --  *      *       0.0.0.0/0            114.114.115.115      MARK or 0xff00
  223  7136 MARK       all  --  *      *       0.0.0.0/0            114.114.114.114      MARK or 0xff00</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264005">
				<div class="post-metadata">
					<div class="post-num">Post #1130</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						3 Feb 2015, 14:34					</div>
				</div>
				<div class="post-content content">
					<p>Hi wacke,</p><br /><p>A look at your iptables output suggests that mwan3 is working ok. It&#039;s only the status script that has a bug. I will fix this. Thank you for reporting.</p><p>If you fix your config (correct all the members with the correct interface) you will be good to go.</p><br /><p>Thnx again, Adze.</p>											<p class="post-edited">(Last edited by <strong>Adze</strong> on 3 Feb 2015, 14:39)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264008">
				<div class="post-metadata">
					<div class="post-num">Post #1131</div>
					<div class="post-author">wacke</div>
					<div class="post-datetime">
						3 Feb 2015, 14:56					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Adze wrote:</cite><blockquote><p>Hi wacke,</p><br /><p>A look at your iptables output suggests that mwan3 is working ok. It&#039;s only the status script that has a bug. I will fix this. Thank you for reporting.</p><p>If you fix your config (correct all the members with the correct interface) you will be good to go.</p><br /><p>Thnx again, Adze.</p></blockquote></div><p>After modify the config file,it got back to normal.Thanks a lot!!!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264408">
				<div class="post-metadata">
					<div class="post-num">Post #1132</div>
					<div class="post-author">jwajer</div>
					<div class="post-datetime">
						6 Feb 2015, 19:01					</div>
				</div>
				<div class="post-content content">
					<p>I have an issue. Openwrt Barrier Breaker 14.07/Luci trunk 0.12. Luci-app-mwan3 1.3-5, mwan3 1.5-9, wdr4300. Mwan3 is configured and running. The only issue is that under system, startup the mwan3 is missing. I have tried reinstalling mwan3 several times using the web gui and command line. I did one a while back that had Luci-app-mwan3 1.3-4, mwan3 1.4-24 and it showed up in that one. I had no errors during install. How can I fix this?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264410">
				<div class="post-metadata">
					<div class="post-num">Post #1133</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						6 Feb 2015, 19:03					</div>
				</div>
				<div class="post-content content">
					<p>What do you mean by &quot;system startup&quot;? Mwan3 is a hotplug event driven script and is not a process. Therefor i recently removed it from /etc/init.d/.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264411">
				<div class="post-metadata">
					<div class="post-num">Post #1134</div>
					<div class="post-author">arfett</div>
					<div class="post-datetime">
						6 Feb 2015, 19:10					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jwajer wrote:</cite><blockquote><p>I have an issue. Openwrt Barrier Breaker 14.07/Luci trunk 0.12. Luci-app-mwan3 1.3-5, mwan3 1.5-9, wdr4300. Mwan3 is configured and running. The only issue is that under system, startup the mwan3 is missing. I have tried reinstalling mwan3 several times using the web gui and command line. I did one a while back that had Luci-app-mwan3 1.3-4, mwan3 1.4-24 and it showed up in that one. I had no errors during install. How can I fix this?</p></blockquote></div><p>It won&#039;t show up there. Mwan3 is not a service running in the background and does not and never has run at startup and was never configurable from the startup applications page. Mwan3 is triggered on interface hogplug events. The /etc/init.d/mwan3 is now removed and the misleading entry on the startup page removed.</p>											<p class="post-edited">(Last edited by <strong>arfett</strong> on 6 Feb 2015, 19:12)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264413">
				<div class="post-metadata">
					<div class="post-num">Post #1135</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						6 Feb 2015, 19:13					</div>
				</div>
				<div class="post-content content">
					<p>Works as designed. I removed it from the system startup process list somewhere in version 1.5. You can still stop it from the luci-app-mwan3 page or issue &quot;mwan3 stop&quot; at terminal. If you wish that mwan3 does not start when a wan interface comes up, disable all your interfaces in the config.</p><p>edit: What Arfett says.. (wasn&#039;t paying attention) <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>											<p class="post-edited">(Last edited by <strong>Adze</strong> on 6 Feb 2015, 19:17)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264415">
				<div class="post-metadata">
					<div class="post-num">Post #1136</div>
					<div class="post-author">jwajer</div>
					<div class="post-datetime">
						6 Feb 2015, 19:30					</div>
				</div>
				<div class="post-content content">
					<p>I am new to this and just learning. We used to have a guy who was heavy into this and started us moving from m0n0wall to Openwrt. Unfortunately for us he left and went to another country and now stopped replying to our emails with questions. So now I am trying to get answers on my own. So Thanks to everyone who replied. <br />Adze... Remember I am new and may ask some stupid questions. When you wrote &quot; You can still stop it from the luci-app-mwan3 page&quot; were you referring to Network then Load Balancing?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264416">
				<div class="post-metadata">
					<div class="post-num">Post #1137</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						6 Feb 2015, 19:36					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jwajer wrote:</cite><blockquote><p>When you wrote &quot; You can still stop it from the luci-app-mwan3 page&quot; were you referring to Network then Load Balancing?</p></blockquote></div><p>If you issue the &quot;mwan3&quot; stop command or (and i maybe mistaken here) push the mwan3 stop button on the webpage, mwan3 will delete all rules and routes created by mwan3. Normal routing will continue, but no load-balancing is done.</p>											<p class="post-edited">(Last edited by <strong>Adze</strong> on 6 Feb 2015, 19:37)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264606">
				<div class="post-metadata">
					<div class="post-num">Post #1138</div>
					<div class="post-author">phineasmax</div>
					<div class="post-datetime">
						8 Feb 2015, 10:27					</div>
				</div>
				<div class="post-content content">
					<p>Hello!<br />i&#039;m using mwan3 and i have 2 wan: WAN1 and WAN2.<br />I want WAN2 to be my primary link, if it goes down, test if WAN1 is up and switch to WAN1 if WAN2 comes back online, switch back to WAN2.<br />But it aIways using WAN1 as primary link. I don&#039;t know how to fix it. Can you help me?</p>											<p class="post-edited">(Last edited by <strong>phineasmax</strong> on 9 Feb 2015, 01:31)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264862">
				<div class="post-metadata">
					<div class="post-num">Post #1139</div>
					<div class="post-author">arfett</div>
					<div class="post-datetime">
						10 Feb 2015, 05:49					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>phineasmax wrote:</cite><blockquote><p>Hello!<br />i&#039;m using mwan3 and i have 2 wan: WAN1 and WAN2.<br />I want WAN2 to be my primary link, if it goes down, test if WAN1 is up and switch to WAN1 if WAN2 comes back online, switch back to WAN2.<br />But it aIways using WAN1 as primary link. I don&#039;t know how to fix it. Can you help me?</p></blockquote></div><p><a href="http://wiki.openwrt.org/doc/howto/mwan3">http://wiki.openwrt.org/doc/howto/mwan3</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264977">
				<div class="post-metadata">
					<div class="post-num">Post #1140</div>
					<div class="post-author">kpv</div>
					<div class="post-datetime">
						10 Feb 2015, 20:19					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>wacke wrote:</cite><blockquote><p>hi,all<br />I have some problems with using mwan3.my mwan3 have upated to the latest version,but not all rules worked.<br />...</p><p>my network config:<br /></p><div class="codebox"><pre><code>config interface &#039;wan1&#039;
    option _orig_ifname &#039;eth3&#039;
    option _orig_bridge &#039;true&#039;
    option proto &#039;pppoe&#039;
    option ifname &#039;eth3&#039;
    option username &#039;13601508872&#039;
    option password &#039;881025&#039;
    option metric &#039;1&#039;

config interface &#039;wan2&#039;
    option _orig_ifname &#039;eth3&#039;
    option _orig_bridge &#039;true&#039;
    option proto &#039;pppoe&#039;
    option ifname &#039;eth3&#039;
    option username &#039;13601508872&#039;
    option password &#039;881025&#039;
    option metric &#039;2&#039;

config interface &#039;wan3&#039;
    option _orig_ifname &#039;eth3&#039;
    option _orig_bridge &#039;true&#039;
    option proto &#039;pppoe&#039;
    option ifname &#039;eth3&#039;
    option username &#039;13601508872&#039;
    option password &#039;881025&#039;
    option metric &#039;3&#039;

config interface &#039;wan4&#039;
    option proto &#039;pppoe&#039;
    option ifname &#039;eth3&#039;
    option username &#039;13601508872&#039;
    option password &#039;881025&#039;
    option metric &#039;4&#039;

config interface &#039;wan5&#039;
    option _orig_ifname &#039;eth3&#039;
    option _orig_bridge &#039;true&#039;
    option proto &#039;pppoe&#039;
    option ifname &#039;eth3&#039;
    option username &#039;13601508872&#039;
    option password &#039;881025&#039;
    option metric &#039;5&#039;

config interface &#039;wan6&#039;
    option _orig_ifname &#039;eth3&#039;
    option _orig_bridge &#039;true&#039;
    option proto &#039;pppoe&#039;
    option ifname &#039;eth3&#039;
    option username &#039;13601508872&#039;
    option password &#039;881025&#039;
    option metric &#039;6&#039;

config interface &#039;wan7&#039;
    option _orig_ifname &#039;eth3&#039;
    option _orig_bridge &#039;true&#039;
    option proto &#039;pppoe&#039;
    option ifname &#039;eth3&#039;
    option username &#039;13601508872&#039;
    option password &#039;881025&#039;
    option metric &#039;7&#039;

config interface &#039;wan8&#039;
    option _orig_ifname &#039;eth3&#039;
    option _orig_bridge &#039;true&#039;
    option proto &#039;pppoe&#039;
    option ifname &#039;eth3&#039;
    option username &#039;13601508872&#039;
    option password &#039;881025&#039;
    option metric &#039;8&#039;

config interface &#039;wan9&#039;
    option _orig_ifname &#039;eth3&#039;
    option _orig_bridge &#039;true&#039;
    option proto &#039;pppoe&#039;
    option ifname &#039;eth3&#039;
    option username &#039;13601508872&#039;
    option password &#039;881025&#039;
    option metric &#039;9&#039;

config interface &#039;wan10&#039;
    option _orig_ifname &#039;eth3&#039;
    option _orig_bridge &#039;true&#039;
    option proto &#039;pppoe&#039;
    option ifname &#039;eth3&#039;
    option username &#039;13601508872&#039;
    option password &#039;881025&#039;
    option metric &#039;10&#039;</code></pre></div></blockquote></div><p>Hi,</p><p>Could you please give more info about your configuration? How is it possible to run a dozen PPPoE WANs over the same interface (eth3) ?</p><p>I would have imagined that the way to configure that many WANs would be to define a VLAN for each WAN on OpenWrt, and then trunk all WANs over a single physical interface and finally &quot;expand&quot; the WANs again to individual ports on a managed switch, on which all the ISP modems would be physically connected.</p><p>What am I missing here?</p><p>TIA.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264978">
				<div class="post-metadata">
					<div class="post-num">Post #1141</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						10 Feb 2015, 20:28					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>kpv wrote:</cite><blockquote><p>I would have imagined that the way to configure that many WANs would be to define a VLAN for each WAN on OpenWrt, and then trunk all WANs over a single physical interface and finally &quot;expand&quot; the WANs again to individual ports on a managed switch, on which all the ISP modems would be physically connected.</p></blockquote></div><p>There is technically no problem to have multiple ppp sessions over one physical link. The ISP does exactly that, but then on the other side, termination end-user connections. All the ppp sessions however have the same end points.</p>											<p class="post-edited">(Last edited by <strong>Adze</strong> on 10 Feb 2015, 20:28)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264982">
				<div class="post-metadata">
					<div class="post-num">Post #1142</div>
					<div class="post-author">kpv</div>
					<div class="post-datetime">
						10 Feb 2015, 20:49					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Adze wrote:</cite><blockquote><div class="quotebox"><cite>kpv wrote:</cite><blockquote><p>I would have imagined that the way to configure that many WANs would be to define a VLAN for each WAN on OpenWrt, and then trunk all WANs over a single physical interface and finally &quot;expand&quot; the WANs again to individual ports on a managed switch, on which all the ISP modems would be physically connected.</p></blockquote></div><p>There is technically no problem to have multiple ppp sessions over one physical link. The ISP does exactly that, but then on the other side, termination end-user connections. All the ppp sessions however have the same end points.</p></blockquote></div><p>Let me re-phrase my question:</p><p>In the typical xDSL ISP + OpenWrt scenario, we put the ISP modem/router in bridge mode and initiate the PPPoE session from OpenWrt.</p><p>How can we do it with e.g. 10 xDSL connections (say 5 from ISP-A and anoher 5 from ISP-B)? AFAIK the easiest way would be to trunk them over a single physical Ethernet port (assuming I don&#039;t want to put 10 physical ports on my OpenWrt router) and then expand them with a managed switch, to which the ISP modems would be physically connected.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264991">
				<div class="post-metadata">
					<div class="post-num">Post #1143</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						10 Feb 2015, 21:45					</div>
				</div>
				<div class="post-content content">
					<p>If you use multiple physical modems, then you indeed need multiple physical interfaces or as you suggested a managed switch and trunk it to your openwrt router. If you use one modem and your ISP allows for multiple concurrent ppp session, then you can use wacke&#039;s method.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p265074">
				<div class="post-metadata">
					<div class="post-num">Post #1144</div>
					<div class="post-author">wacke</div>
					<div class="post-datetime">
						11 Feb 2015, 07:52					</div>
				</div>
				<div class="post-content content">
					<p>Hi,adze<br />Me again,last few days when i use the mwan3,if there is some wans down,and all my internet connection is just down,until all the wans goes up...<br />my mwan3 config:<br /></p><div class="codebox"><pre><code>config rule &#039;IPv6&#039;
    option dest_ip &#039;216.218.221.6&#039;
    option proto &#039;all&#039;
    option use_policy &#039;wan2_only&#039;

config rule &#039;HOMEServer_IPv6&#039;
    option dest_ip &#039;tb.ipv6.sparqnet.net&#039;
    option proto &#039;all&#039;
    option use_policy &#039;wan3_only&#039;

config rule &#039;HDRoad&#039;
    option dest_port &#039;80,443&#039;
    option proto &#039;tcp&#039;
    option use_policy &#039;wan5_only&#039;
    option dest_ip &#039;hdroute.org&#039;

config rule &#039;m_team&#039;
    option dest_port &#039;80,443&#039;
    option proto &#039;tcp&#039;
    option use_policy &#039;wan5_only&#039;
    option dest_ip &#039;tp.m-team.cc&#039;

config rule &#039;CCFbits&#039;
    option dest_port &#039;80,443&#039;
    option proto &#039;tcp&#039;
    option use_policy &#039;wan5_only&#039;
    option dest_ip &#039;tracker.ccfbits.org&#039;

config rule &#039;DNS0&#039;
    option use_policy &#039;wan1_only&#039;
    option proto &#039;all&#039;
    option dest_ip &#039;114.114.114.114&#039;

config rule &#039;DNS1&#039;
    option use_policy &#039;wan1_only&#039;
    option proto &#039;all&#039;
    option dest_ip &#039;114.114.115.115&#039;

config rule &#039;DNS2&#039;
    option use_policy &#039;wan1_only&#039;
    option proto &#039;all&#039;
    option dest_ip &#039;1.2.4.8&#039;

config rule &#039;XiaoMi&#039;
    option proto &#039;all&#039;
    option use_policy &#039;xiaomi_lb&#039;
    option src_ip &#039;192.168.1.10,192.168.1.11,192.168.1.244&#039;

config rule &#039;QQ&#039;
    option dest_ip &#039;*.qq.com&#039;
    option proto &#039;all&#039;
    option use_policy &#039;wan2_only&#039;

config rule &#039;WEB&#039;
    option use_policy &#039;wan1_only&#039;
    option dest_port &#039;22,25,80,110,143,443,465,587,993,995,8000&#039;
    option proto &#039;tcp&#039;

config rule &#039;loadbalance&#039;
    option use_policy &#039;loadbalanced&#039;
    option proto &#039;all&#039;
    option equalize &#039;1&#039;

config policy &#039;wan1_only&#039;
    list use_member &#039;wan1_m1_w3&#039;

config policy &#039;wan1_wan2&#039;
    option last_resort &#039;unreachable&#039;
    list use_member &#039;wan1_m1_w3&#039;
    list use_member &#039;wan2_m1_w2&#039;

config policy &#039;wan2_only&#039;
    list use_member &#039;wan2_m1_w2&#039;

config policy &#039;wan3_only&#039;
    list use_member &#039;wan3_m1_w2&#039;

config policy &#039;wan4_only&#039;
    list use_member &#039;wan4_m1_w2&#039;

config policy &#039;wan5_only&#039;
    list use_member &#039;wan5_m1_w2&#039;

config policy &#039;wan6_only&#039;
    list use_member &#039;wan6_m1_w2&#039;

config policy &#039;wan7_only&#039;
    list use_member &#039;wan7_m1_w2&#039;

config policy &#039;wan8_only&#039;
    list use_member &#039;wan8_m1_w2&#039;

config policy &#039;wan9_only&#039;
    list use_member &#039;wan9_m1_w2&#039;

config policy &#039;wan10_only&#039;
    list use_member &#039;wan10_m1_w2&#039;

config policy &#039;wan11_only&#039;
    list use_member &#039;wan11_m1_w2&#039;

config policy &#039;xiaomi_lb&#039;
    list use_member &#039;wan7_m1_w2&#039;
    list use_member &#039;wan8_m1_w2&#039;
    list use_member &#039;wan9_m1_w2&#039;
    list use_member &#039;wan10_m1_w2&#039;
    list use_member &#039;wan11_m1_w2&#039;

config policy &#039;loadbalanced&#039;
    list use_member &#039;wan2_m1_w2&#039;
    list use_member &#039;wan3_m1_w2&#039;
    list use_member &#039;wan4_m1_w2&#039;
    list use_member &#039;wan5_m1_w2&#039;
    list use_member &#039;wan6_m1_w2&#039;
    list use_member &#039;wan7_m1_w2&#039;
    list use_member &#039;wan8_m1_w2&#039;
    list use_member &#039;wan9_m1_w2&#039;
    list use_member &#039;wan10_m1_w2&#039;
    list use_member &#039;wan11_m1_w2&#039;

config interface &#039;wan1&#039;
    option enabled &#039;1&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option down &#039;3&#039;
    option up &#039;3&#039;
    option timeout &#039;3&#039;
    list track_ip &#039;114.114.114.114&#039;
    list track_ip &#039;114.114.115.115&#039;
    option interval &#039;600&#039;

config interface &#039;wan2&#039;
    option enabled &#039;1&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option down &#039;3&#039;
    option up &#039;3&#039;
    option timeout &#039;3&#039;
    list track_ip &#039;114.114.114.114&#039;
    list track_ip &#039;114.114.115.115&#039;
    option interval &#039;600&#039;

config interface &#039;wan3&#039;
    option enabled &#039;1&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option down &#039;3&#039;
    option up &#039;3&#039;
    option timeout &#039;3&#039;
    list track_ip &#039;114.114.114.114&#039;
    list track_ip &#039;114.114.115.115&#039;
    option interval &#039;600&#039;

config interface &#039;wan4&#039;
    option enabled &#039;1&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option down &#039;3&#039;
    option up &#039;3&#039;
    option timeout &#039;3&#039;
    list track_ip &#039;114.114.114.114&#039;
    list track_ip &#039;114.114.115.115&#039;
    option interval &#039;600&#039;

config interface &#039;wan5&#039;
    option enabled &#039;1&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option down &#039;3&#039;
    option up &#039;3&#039;
    option timeout &#039;3&#039;
    list track_ip &#039;114.114.114.114&#039;
    list track_ip &#039;114.114.115.115&#039;
    option interval &#039;600&#039;

config interface &#039;wan6&#039;
    option enabled &#039;1&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option down &#039;3&#039;
    option up &#039;3&#039;
    option timeout &#039;3&#039;
    list track_ip &#039;114.114.114.114&#039;
    list track_ip &#039;114.114.115.115&#039;
    option interval &#039;600&#039;

config interface &#039;wan7&#039;
    option enabled &#039;1&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option down &#039;3&#039;
    option up &#039;3&#039;
    option timeout &#039;3&#039;
    list track_ip &#039;114.114.114.114&#039;
    list track_ip &#039;114.114.115.115&#039;
    option interval &#039;600&#039;

config interface &#039;wan8&#039;
    option enabled &#039;1&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option down &#039;3&#039;
    option up &#039;3&#039;
    option timeout &#039;3&#039;
    list track_ip &#039;114.114.114.114&#039;
    list track_ip &#039;114.114.115.115&#039;
    option interval &#039;600&#039;

config interface &#039;wan9&#039;
    option enabled &#039;1&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option down &#039;3&#039;
    option up &#039;3&#039;
    option timeout &#039;3&#039;
    list track_ip &#039;114.114.114.114&#039;
    list track_ip &#039;114.114.115.115&#039;
    option interval &#039;600&#039;

config interface &#039;wan10&#039;
    option enabled &#039;1&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option down &#039;3&#039;
    option up &#039;3&#039;
    option timeout &#039;3&#039;
    list track_ip &#039;114.114.114.114&#039;
    list track_ip &#039;114.114.115.115&#039;
    option interval &#039;600&#039;

config interface &#039;wan11&#039;
    option enabled &#039;1&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option down &#039;3&#039;
    option up &#039;3&#039;
    option timeout &#039;3&#039;
    list track_ip &#039;114.114.114.114&#039;
    list track_ip &#039;114.114.115.115&#039;
    option interval &#039;600&#039;

config member &#039;wan1_m1_w3&#039;
    option metric &#039;1&#039;
    option interface &#039;wan1&#039;
    option weight &#039;3&#039;

config member &#039;wan2_m1_w2&#039;
    option interface &#039;wan2&#039;
    option metric &#039;1&#039;
    option weight &#039;2&#039;

config member &#039;wan3_m1_w2&#039;
    option interface &#039;wan3&#039;
    option metric &#039;1&#039;
    option weight &#039;2&#039;

config member &#039;wan4_m1_w2&#039;
    option interface &#039;wan4&#039;
    option metric &#039;1&#039;
    option weight &#039;2&#039;

config member &#039;wan5_m1_w2&#039;
    option interface &#039;wan5&#039;
    option metric &#039;1&#039;
    option weight &#039;2&#039;

config member &#039;wan6_m1_w2&#039;
    option interface &#039;wan6&#039;
    option metric &#039;1&#039;
    option weight &#039;2&#039;

config member &#039;wan7_m1_w2&#039;
    option interface &#039;wan7&#039;
    option metric &#039;1&#039;
    option weight &#039;2&#039;

config member &#039;wan8_m1_w2&#039;
    option interface &#039;wan8&#039;
    option metric &#039;1&#039;
    option weight &#039;2&#039;

config member &#039;wan9_m1_w2&#039;
    option interface &#039;wan9&#039;
    option metric &#039;1&#039;
    option weight &#039;2&#039;

config member &#039;wan10_m1_w2&#039;
    option interface &#039;wan10&#039;
    option metric &#039;1&#039;
    option weight &#039;2&#039;

config member &#039;wan11_m1_w2&#039;
    option interface &#039;wan11&#039;
    option metric &#039;1&#039;
    option weight &#039;2&#039;</code></pre></div><p>and all wans up status:<br /></p><div class="codebox"><pre><code>root@HOME-Router:/etc/config# mwan3 status
Interface status:
Interface wan1 is online (tracking active)
Interface wan2 is online (tracking active)
Interface wan3 is online (tracking active)
Interface wan4 is online (tracking active)
Interface wan5 is online (tracking active)
Interface wan6 is online (tracking active)
Interface wan7 is online (tracking active)
Interface wan8 is online (tracking active)
Interface wan9 is online (tracking active)
Interface wan10 is online (tracking active)
Interface wan11 is online (tracking active)

Policy loadbalanced:
 wan11 (10%)
 wan10 (10%)
 wan9 (10%)
 wan8 (10%)
 wan7 (10%)
 wan6 (10%)
 wan5 (10%)
 wan4 (10%)
 wan3 (10%)
 wan2 (10%)

Policy wan10_only:
 wan10 (100%)

Policy wan11_only:
 wan11 (100%)

Policy wan1_only:
 wan1 (100%)

Policy wan1_wan2:
 wan2 (40%)
 wan1 (60%)

Policy wan2_only:
 wan2 (100%)

Policy wan3_only:
 wan3 (100%)

Policy wan4_only:
 wan4 (100%)

Policy wan5_only:
 wan5 (100%)

Policy wan6_only:
 wan6 (100%)

Policy wan7_only:
 wan7 (100%)

Policy wan8_only:
 wan8 (100%)

Policy wan9_only:
 wan9 (100%)

Policy xiaomi_lb:
 wan11 (20%)
 wan10 (20%)
 wan9 (20%)
 wan8 (20%)
 wan7 (20%)

Known networks:
destination        policy             hits     
-----------------------------------------------
127.0.0.0/8        default            51       
224.0.0.0/3        default            176      
10.7.0.0/24        default            0        
112.1.86.1         default            0        
112.3.84.1         default            0        
112.21.156.1       default            0        
112.21.156.1       default            0        
183.208.176.1      default            0        
183.213.154.1      default            0        
192.168.1.0/24     default            1178     
192.168.100.0/24   default            0        
222.188.197.1      default            0        
223.66.36.1        default            0        
223.66.70.1        default            0        
223.66.93.1        default            0        
223.66.93.1        default            0        
10.7.0.0           default            0        
10.7.0.2           default            0        
10.7.0.255         default            0        
112.1.86.13        default            1064     
112.3.87.164       default            861      
112.21.156.174     default            474      
112.21.156.216     default            393      
127.0.0.0          default            0        
127.0.0.0/8        default            51       
127.0.0.1          default            51       
127.255.255.255    default            0        
183.208.178.14     default            512      
183.213.154.219    default            2218     
192.168.1.0        default            0        
192.168.1.1        default            1087     
192.168.1.255      default            29       
192.168.100.0      default            0        
192.168.100.2      default            0        
192.168.100.255    default            0        
222.188.197.189    default            8036     
223.66.37.224      default            195K     
223.66.70.199      default            979      
223.66.93.152      default            540      
223.66.93.155      default            885      

Active rules:
source             destination        proto  src-port      dest-port     policy          hits     
--------------------------------------------------------------------------------------------------
0.0.0.0/0          216.218.221.6      all                                wan2_only       0        
0.0.0.0/0          104.28.18.105      tcp    0:65535       80,443        wan5_only       4        
0.0.0.0/0          104.28.19.105      tcp    0:65535       80,443        wan5_only       0        
0.0.0.0/0          114.114.114.114    all                                wan1_only       1160     
0.0.0.0/0          114.114.115.115    all                                wan1_only       196      
0.0.0.0/0          1.2.4.8            all                                wan1_only       108      
192.168.1.10       0.0.0.0/0          all                                xiaomi_lb       205      
192.168.1.11       0.0.0.0/0          all                                xiaomi_lb       0        
192.168.1.244      0.0.0.0/0          all                                xiaomi_lb       0        
0.0.0.0/0          0.0.0.0/0          tcp    0:65535       22,25,80,110,143,443,465,587,993,995,8000wan1_only       425      
0.0.0.0/0          0.0.0.0/0          all                                loadbalanced    232 </code></pre></div><p>if there is one wan down,the status<br /></p><div class="codebox"><pre><code>root@HOME-Router:~# mwan3 status
Interface status:
Interface wan1 is online (tracking active)
Interface wan2 is online (tracking active)
Interface wan3 is online (tracking active)
Interface wan4 is online (tracking active)
Interface wan5 is online (tracking active)
Interface wan6 is online (tracking active)
Interface wan7 is online (tracking active)
Interface wan8 is online (tracking active)
Interface wan9 is online (tracking active)
Interface wan10 is online (tracking active)
Interface wan11 is online (tracking active)

Policy loadbalanced:
 wan11 (10%)
 wan10 (10%)
 wan9 (10%)
 wan8 (10%)
 wan7 (10%)
 wan6 (10%)
 wan5 (10%)
 wan4 (10%)
 wan3 (10%)
 wan2 (10%)

Policy wan10_only:
 wan10 (100%)

Policy wan11_only:
 wan11 (100%)

Policy wan1_only:
 wan1 (100%)

Policy wan1_wan2:
 wan2 (40%)
 wan1 (60%)

Policy wan2_only:
 wan2 (100%)

Policy wan3_only:
 wan3 (100%)

Policy wan4_only:
 wan4 (100%)

Policy wan5_only:
 wan5 (100%)

Policy wan6_only:
 wan6 (100%)

Policy wan7_only:
 wan7 (100%)

Policy wan8_only:
 wan8 (100%)

Policy wan9_only:
 wan9 (100%)

Policy xiaomi_lb:
 wan11 (20%)
 wan10 (20%)
 wan9 (20%)
 wan8 (20%)
 wan7 (20%)

Known networks:
destination        policy             hits     
-----------------------------------------------
127.0.0.0/8        default            6        
224.0.0.0/3        default            16       
10.7.0.0/24        default            0        
112.3.84.1         default            0        
112.21.156.1       default            0        
112.21.156.1       default            0        
183.208.176.1      default            0        
183.213.154.1      default            0        
192.168.1.0/24     default            55       
192.168.100.0/24   default            0        
222.188.197.1      default            0        
223.66.36.1        default            0        
223.66.70.1        default            0        
223.66.93.1        default            0        
223.66.93.1        default            0        
10.7.0.0           default            0        
10.7.0.2           default            0        
10.7.0.255         default            0        
112.3.87.164       default            24       
112.21.156.174     default            7        
112.21.156.216     default            6        
127.0.0.0          default            0        
127.0.0.0/8        default            6        
127.0.0.1          default            6        
127.255.255.255    default            0        
183.208.178.14     default            1        
183.213.154.219    default            175      
192.168.1.0        default            0        
192.168.1.1        default            53       
192.168.1.255      default            0        
192.168.100.0      default            0        
192.168.100.2      default            0        
192.168.100.255    default            0        
222.188.197.189    default            57       
223.66.37.224      default            1375     
223.66.70.199      default            24       
223.66.93.152      default            1        
223.66.93.155      default            62       

Active rules:
source             destination        proto  src-port      dest-port     policy          hits     
--------------------------------------------------------------------------------------------------
0.0.0.0/0          216.218.221.6      all                                wan2_only       0 </code></pre></div><p>It seems that mwan3 take a long time (sometimes more than 3 minutes) to get all the rules active,is that normal?</p><p>I&#039;m using openwrt x86_64 with my own compiled version(atom525+openwrt latest trunk+x86_64 3.18.6 kernel+eglibc 2.19).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p265079">
				<div class="post-metadata">
					<div class="post-num">Post #1145</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						11 Feb 2015, 09:29					</div>
				</div>
				<div class="post-content content">
					<p>Hi wacke,</p><p>Your option interval is set to 600 and option down is set to 3. This results in that when a wan goes down it will take at least 1800 seconds and at most 2400 seconds before failover takes place. In the meantime all traffic is routed over wan interface(s) that don&#039;t work. The output you posted shows all interfaces online..</p><p>Each interface can take up to 10 sec during mwan3 restart depending on hardware. With 12 wan interfaces i would not be surprised that it took over 2 min.</p>											<p class="post-edited">(Last edited by <strong>Adze</strong> on 11 Feb 2015, 09:31)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p265088">
				<div class="post-metadata">
					<div class="post-num">Post #1146</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						11 Feb 2015, 10:04					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>anarchy99 wrote:</cite><blockquote><p>I&#039;ve set 3 l2tp connections mapped to a different VAP/eth interfaces, all seems to work fine except in case when any of the tunnels goes down the traffic that&#039;s already been initiated is not blackholed but it continues directly to internet through my ISP connection.</p></blockquote></div><p>Yes, works as designed. Maybe this is not the best design. I will think about this. Rerouting traffic of an established tcp session to another wan interface is not desirable when e.g. using nat. Sending traffic from an established connection to blackhole is atm considered as rerouting. Maybe you could work around this by creating some firewall rules?</p><div class="quotebox"><cite>anarchy99 wrote:</cite><blockquote><p>Is there a way to make internet access available through my main wan connection only from a specific VAP interface and disabled completely from all other interfaces?</p></blockquote></div><p>Yes, use firewalling. Mwan3 is not a firewall.</p>											<p class="post-edited">(Last edited by <strong>Adze</strong> on 11 Feb 2015, 10:08)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p265091">
				<div class="post-metadata">
					<div class="post-num">Post #1147</div>
					<div class="post-author">wacke</div>
					<div class="post-datetime">
						11 Feb 2015, 10:43					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Adze wrote:</cite><blockquote><p>Hi wacke,</p><p>Your option interval is set to 600 and option down is set to 3. This results in that when a wan goes down it will take at least 1800 seconds and at most 2400 seconds before failover takes place. In the meantime all traffic is routed over wan interface(s) that don&#039;t work. The output you posted shows all interfaces online..</p><p>Each interface can take up to 10 sec during mwan3 restart depending on hardware. With 12 wan interfaces i would not be surprised that it took over 2 min.</p></blockquote></div><p>Hi Adze,<br />Thanks for your reply,as i posted mwan3 config,i have a rule that&nbsp; all the http,https traffic was configured to through wan1,but if there is a wan goes down(not wan1),the http,https rule won&#039;t active until the wan goes up(the wan is up but mwan3 still shows down,and take a long time to shows up )...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p265095">
				<div class="post-metadata">
					<div class="post-num">Post #1148</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						11 Feb 2015, 11:05					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>wacke wrote:</cite><blockquote><p>i have a rule that all the http,https traffic was configured to through wan1</p></blockquote></div><p>I don&#039;t see that rule in your output...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p265103">
				<div class="post-metadata">
					<div class="post-num">Post #1149</div>
					<div class="post-author">wacke</div>
					<div class="post-datetime">
						11 Feb 2015, 11:53					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Adze wrote:</cite><blockquote><div class="quotebox"><cite>wacke wrote:</cite><blockquote><p>i have a rule that all the http,https traffic was configured to through wan1</p></blockquote></div><p>I don&#039;t see that rule in your output...</p></blockquote></div><div class="codebox"><pre><code>config rule &#039;WEB&#039;
    option use_policy &#039;wan1_only&#039;
    option dest_port &#039;22,25,80,110,143,443,465,587,993,995,8000&#039;
    option proto &#039;tcp&#039;</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p265165">
				<div class="post-metadata">
					<div class="post-num">Post #1150</div>
					<div class="post-author">arfett</div>
					<div class="post-datetime">
						11 Feb 2015, 20:37					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>wacke wrote:</cite><blockquote><div class="quotebox"><cite>Adze wrote:</cite><blockquote><p>Hi wacke,</p><p>Your option interval is set to 600 and option down is set to 3. This results in that when a wan goes down it will take at least 1800 seconds and at most 2400 seconds before failover takes place. In the meantime all traffic is routed over wan interface(s) that don&#039;t work. The output you posted shows all interfaces online..</p><p>Each interface can take up to 10 sec during mwan3 restart depending on hardware. With 12 wan interfaces i would not be surprised that it took over 2 min.</p></blockquote></div><p>Hi Adze,<br />Thanks for your reply,as i posted mwan3 config,i have a rule that&nbsp; all the http,https traffic was configured to through wan1,but if there is a wan goes down(not wan1),the http,https rule won&#039;t active until the wan goes up(the wan is up but mwan3 still shows down,and take a long time to shows up )...</p></blockquote></div><p>What would help us is to see the iptables information during the failed state.</p>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 46 of 65</div><nav><ul><li><a href="viewtopic.php%3Fid=39052&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=39052&amp;p=44.html">44</a></li><li><a href="viewtopic.php%3Fid=39052&amp;p=45.html">45</a></li><li class="pagination-current"><span>46</span></li><li><a href="viewtopic.php%3Fid=39052&amp;p=47.html">47</a></li><li><a href="viewtopic.php%3Fid=39052&amp;p=48.html">48</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=39052&amp;p=65.html">65</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0.001 -->

</body>
</html>