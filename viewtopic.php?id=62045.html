<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> log connections like shown in LuCi realtime graphs</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 29 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p306876">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">alexth</div>
					<div class="post-datetime">
						9 Jan 2016, 18:48					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>Thanks to all developers for this great software, I am using openwrt for some time now!</p><br /><p>I would like to create an overview of my connections in a logfile per client, basically like the information shown in LuCi realtime graphs under &quot;connections&quot;.&nbsp; This would be just origin / destination IP, type of connections, and maybe resolved domainnames etc.</p><p>My question: <br />- Is this information logged, and can it be accesed ? <br />- If not, what tool is used by LuCi to create the information ?<br />- Is there some other way / place to access the information so I can create my own log or overview ?</p><p>I realise I can use a variety of tools to create the wanted logs. However, those require additional tools or packages to be installed. Since LuCi alreade reports the wanted information, it seems easier to somehow use the same info or tools.</p><p>Thanks for any hints !</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p306879">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						9 Jan 2016, 19:02					</div>
				</div>
				<div class="post-content content">
					<p>Luci takes the data in real-time from kernel&#039;s connection tracking table, which you can read as the file /proc/net/nf_conntrack</p><p>Luci does not use/create any actual log for that.</p><p>In my example there a few TCP connections with 7200-7430 seconds of remaining lifetime<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# cat /proc/net/nf_conntrack | grep tcp

ipv4     2 tcp      6 40 TIME_WAIT src=192.168.1.180 dst=78.24.191.177 sport=52563 dport=443 packets=25 bytes=5233 src=78.24.191.177 dst=87.100.186.127 sport=443 dport=52563 packets=28 bytes=10204 [ASSURED] mark=0 use=2
ipv4     2 tcp      6 7430 ESTABLISHED src=192.168.1.180 dst=46.228.135.116 sport=52574 dport=80 packets=5 bytes=988 src=46.228.135.116 dst=87.100.186.127 sport=80 dport=52574 packets=4 bytes=934 [ASSURED] mark=0 use=2
ipv4     2 tcp      6 7217 ESTABLISHED src=192.168.1.245 dst=23.54.12.8 sport=50040 dport=80 packets=4 bytes=446 src=23.54.12.8 dst=87.100.186.127 sport=80 dport=50040 packets=3 bytes=369 [ASSURED] mark=0 use=2
ipv4     2 tcp      6 7413 ESTABLISHED src=192.168.1.180 dst=108.160.162.101 sport=51455 dport=443 packets=97 bytes=37473 src=108.160.162.101 dst=87.100.186.127 sport=443 dport=51455 packets=189 bytes=41347 [ASSURED] mark=0 use=2</code></pre></div><p>You should probably check the tools on this page:<br /><a href="https://wiki.openwrt.org/doc/howto/bwmon">https://wiki.openwrt.org/doc/howto/bwmon</a></p>											<p class="post-edited">(Last edited by <strong>hnyman</strong> on 9 Jan 2016, 19:07)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p306931">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">alexth</div>
					<div class="post-datetime">
						9 Jan 2016, 23:49					</div>
				</div>
				<div class="post-content content">
					<p>Hi hnyman,</p><p>Thanks for your reply! <br />This is very useful .&nbsp; I will try to use this to create a summary of the connections from this. <br />The wanted information is there , now i just need to grep / uniquefy / etc this to get a summary instead of all the details :-) </p><p>I will also look further at bwmon, maybe this already solves ( part of) my needs.</p><p>Alex.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>