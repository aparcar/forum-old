<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Command line equivalent of LuCI flash firmware?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 24 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p109268">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">zorxd</div>
					<div class="post-datetime">
						17 May 2010, 21:17					</div>
				</div>
				<div class="post-content content">
					<p>Hi<br />I know there is the sysupgrade command to upgrade the firmware, but it does not save all my config files.<br />From the LuCI interface, there is an option to flash a firmware and save all my config files. Is there a simple command line equivalent? I found the &quot;luci-flash&quot; command but, from what I understand, it doesn&#039;t parse the &quot;flash_keep&quot; section of /etc/config/luci by itself so I would need to specify one by one the files that I want to keep.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p109989">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">zorxd</div>
					<div class="post-datetime">
						27 May 2010, 21:59					</div>
				</div>
				<div class="post-content content">
					<p>anyone?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p109995">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Dogge</div>
					<div class="post-datetime">
						27 May 2010, 22:53					</div>
				</div>
				<div class="post-content content">
					<p>noone...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110007">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Athan</div>
					<div class="post-datetime">
						28 May 2010, 00:42					</div>
				</div>
				<div class="post-content content">
					<p>First you have to upload firmware in router&#039;s filesystem (or some remote URL) and then use the sysupgrade command which by default keeps all config files intact.</p><div class="codebox"><pre><code>sysupgrade [options] &lt;image file or URL&gt;
Options:
        -d &lt;delay&gt;   add a delay before rebooting
        -f &lt;config&gt;  restore configuration from .tar.gz (file or url)
        -i           interactive mode
        -n           do not save configuration over reflash
        -q           less verbose
        -v           more verbose</code></pre></div><p>I hope it helps!</p>											<p class="post-edited">(Last edited by <strong>Athan</strong> on 28 May 2010, 00:44)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110008">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">zorxd</div>
					<div class="post-datetime">
						28 May 2010, 00:43					</div>
				</div>
				<div class="post-content content">
					<p>the sysupgrade command do not keep config files such as those in /etc/asterisk and /etc/openvpn</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110009">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Athan</div>
					<div class="post-datetime">
						28 May 2010, 00:48					</div>
				</div>
				<div class="post-content content">
					<p>Sysupgrade keeps the necessary OpenWRT-core configuration files, not those related to optional and third party add-ons. However it&#039;s very easy to backup all those files on a mounted USB stick before upgrading firmware.</p>											<p class="post-edited">(Last edited by <strong>Athan</strong> on 28 May 2010, 00:49)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110010">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">zorxd</div>
					<div class="post-datetime">
						28 May 2010, 00:53					</div>
				</div>
				<div class="post-content content">
					<p>Well it kind of defeats the purpous of my question but thanks anyways. I will stick to LuCI for firmware upgrades.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110013">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">LinkZ</div>
					<div class="post-datetime">
						28 May 2010, 01:03					</div>
				</div>
				<div class="post-content content">
					<p>There is a UCI command where you can export (backup) your configuration files (e.g. to a USB jump drive or network share).&nbsp; Then you can import (restore) your configuration after flashing.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>