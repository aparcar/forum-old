<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Howto to match vlan-tags with iptables ?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 11 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p3787">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Knuffi</div>
					<div class="post-datetime">
						8 Jan 2005, 12:18					</div>
				</div>
				<div class="post-content content">
					<p>In my mind it should be possible to define some kind of matching/accounting rule with iptables which interpret the different vlan-tag every packet got when it arrives at one of the switch-ports. <br />So it would be possible to detect which amount of traffic each port generates on the wan-port. This would be very nice and i would like to include it to my project described in <a href="http://www.openwrt.org/forum/viewtopic.php?t=813">http://www.openwrt.org/forum/viewtopic.php?t=813</a></p><p>For now i only have a solution matching/accounting this traffic on the different ip&#039;s. But i would like to have a more general solution, which works out of the box on every openwrt-installation.</p><p>Can anybody give me a hint in the right direction if and how this can be realized with iptables ? I think iptables needs a special target for vlan-tags then.</p><p>Regards<br />Christian Rost</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p3788">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">thyeh</div>
					<div class="post-datetime">
						8 Jan 2005, 12:29					</div>
				</div>
				<div class="post-content content">
					<p>vlan tags are not visible to iptables (in some sense) but you can use it this way: Assume vlan1 is with tag 1 and vlan2 is with tag 2, then you just match the input interface with -i vlan1 when you want to match packets with tag 1.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p3789">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">mbm</div>
					<div class="post-datetime">
						8 Jan 2005, 12:35					</div>
				</div>
				<div class="post-content content">
					<p>Vlan tags are visble on the actual ethernet interface, eth0.</p><p>If I can make a suggestion - The switch itself actually has counters; admcfg is capable of displaying information about the traffic on a per-port basis.</p><p>(Note however that admcfg is overdue for a rewrite and has many issues.)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p3791">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Knuffi</div>
					<div class="post-datetime">
						8 Jan 2005, 13:05					</div>
				</div>
				<div class="post-content content">
					<p>mbm: I already use admcfg, but i want to know how much traffic each port produces on the wan-interface. admcfg counts too much <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p3835">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">Shining</div>
					<div class="post-datetime">
						10 Jan 2005, 16:48					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><p>(Note however that admcfg is overdue for a rewrite and has many issues.)</p></blockquote></div><p>Any hints on details?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p4008">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">manugarg</div>
					<div class="post-datetime">
						19 Jan 2005, 19:47					</div>
				</div>
				<div class="post-content content">
					<p>IMHO, vlan tags are not important here. You want to go one level down i.e. to identify different ports on one vlan. For that you&#039;ll have do something something inside et0 driver for the switch. </p><p>cheers,<br />Manu<br />---------<br />Manu Garg<br /><a href="http://manugarg.freezope.org">http://manugarg.freezope.org</a><br />&quot;Wake up! Free Yourself.&quot;</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>