<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> coreutils--error: cannot run test program while cross compiling</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 18 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p109896">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">feelnow</div>
					<div class="post-datetime">
						26 May 2010, 10:32					</div>
				</div>
				<div class="post-content content">
					<p>hi all,</p><p>I need the su command and try to compilling coreutils,<br />will somebody help me to solve the following problem by cross compiling? <br />Thanks a lot!</p><p>The error message:</p><div class="codebox"><pre><code>checking for stdlib.h... (cached) yes
checking for GNU libc compatible malloc... (cached) yes
checking whether mbrtowc and mbstate_t are properly declared... (cached) yes
checking for a traditional japanese locale... ja_JP
checking for a transitional chinese locale... zh_CN.GB18030
checking for a french Unicode locale... fr_FR.UTF-8
checking whether mbrtowc handles incomplete characters... (cached) yes
checking whether mbrtowc works as well as mbtowc... configure: error: in `/vint/backfire/build_dir/target-i386_glibc-2.6.1/coreutils-7.2&#039;:
configure: error: cannot run test program while cross compiling
See `config.log&#039; for more details.
make[2]: *** [/vint/backfire/build_dir/target-i386_glibc-2.6.1/coreutils-7.2/.configured_] Error 1
make[2]: Leaving directory `/vint/backfire/package/coreutils&#039;
make[1]: *** [package/coreutils/compile] Error 2
make[1]: Leaving directory `/vint/backfire&#039;
make: *** [package/coreutils/compile] Error 2</code></pre></div>											<p class="post-edited">(Last edited by <strong>feelnow</strong> on 26 May 2010, 10:34)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p109902">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						26 May 2010, 13:10					</div>
				</div>
				<div class="post-content content">
					<p>Paste /vint/backfire/build_dir/target-i386_glibc-2.6.1/coreutils-7.2/config.log</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p109904">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">feelnow</div>
					<div class="post-datetime">
						26 May 2010, 13:25					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jow wrote:</cite><blockquote><p>Paste /vint/backfire/build_dir/target-i386_glibc-2.6.1/coreutils-7.2/config.log</p></blockquote></div><p>*****&nbsp; Posts cannot be longer that 65535 characters (64 KB).*****</p><p>full log:<br /><strong><a href="http://abcec.com/config.log.txt">http://abcec.com/config.log.txt</a></strong></p><div class="codebox"><pre><code>configure:11556: checking for a transitional chinese locale
configure:11614: i486-openwrt-linux-gnu-gcc -std=gnu99 -o conftest -O2 -pipe -march=i486 -funit-at-a-time -fhonour-copts  -I/vint/backfire/staging_dir/target-i386_glibc-2.6.1/usr/include -I/vint/backfire/staging_dir/target-i386_glibc-2.6.1/include -I/vint/backfire/staging_dir/toolchain-i386_gcc-4.1.2_glibc-2.6.1/usr/include -I/vint/backfire/staging_dir/toolchain-i386_gcc-4.1.2_glibc-2.6.1/include  -L/vint/backfire/staging_dir/target-i386_glibc-2.6.1/usr/lib -L/vint/backfire/staging_dir/target-i386_glibc-2.6.1/lib -L/vint/backfire/staging_dir/toolchain-i386_gcc-4.1.2_glibc-2.6.1/usr/lib -L/vint/backfire/staging_dir/toolchain-i386_gcc-4.1.2_glibc-2.6.1/lib  conftest.c  &gt;&amp;5
configure:11617: $? = 0
configure:11643: result: zh_CN.GB18030
configure:11650: checking for a french Unicode locale
configure:11710: i486-openwrt-linux-gnu-gcc -std=gnu99 -o conftest -O2 -pipe -march=i486 -funit-at-a-time -fhonour-copts  -I/vint/backfire/staging_dir/target-i386_glibc-2.6.1/usr/include -I/vint/backfire/staging_dir/target-i386_glibc-2.6.1/include -I/vint/backfire/staging_dir/toolchain-i386_gcc-4.1.2_glibc-2.6.1/usr/include -I/vint/backfire/staging_dir/toolchain-i386_gcc-4.1.2_glibc-2.6.1/include  -L/vint/backfire/staging_dir/target-i386_glibc-2.6.1/usr/lib -L/vint/backfire/staging_dir/target-i386_glibc-2.6.1/lib -L/vint/backfire/staging_dir/toolchain-i386_gcc-4.1.2_glibc-2.6.1/usr/lib -L/vint/backfire/staging_dir/toolchain-i386_gcc-4.1.2_glibc-2.6.1/lib  conftest.c  &gt;&amp;5
configure:11713: $? = 0
configure:11740: result: fr_FR.UTF-8
configure:11759: checking whether mbrtowc handles incomplete characters
configure:11812: result: yes
configure:11818: checking whether mbrtowc works as well as mbtowc
configure:11832: error: in `/vint/backfire/build_dir/target-i386_glibc-2.6.1/coreutils-7.2&#039;:
configure:11835: error: cannot run test program while cross compiling
See `config.log&#039; for more details.

## ---------------- ##
## Cache variables. ##
## ---------------- ##

ac_cv_build=x86_64-redhat-linux-gnu
ac_cv_c_bigendian=no
ac_cv_c_compiler_gnu=yes
ac_cv_c_gettext_without_libintl=yes
ac_cv_c_inline=inline
ac_cv_c_littleendian=yes
ac_cv_c_long_double=no
ac_cv_c_restrict=__restrict
ac_cv_conv_longlong_to_float=yes
ac_cv_env_CC_set=set
ac_cv_env_CC_value=i486-openwrt-linux-gnu-gcc</code></pre></div>											<p class="post-edited">(Last edited by <strong>feelnow</strong> on 6 Jun 2010, 18:52)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110684">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">feelnow</div>
					<div class="post-datetime">
						7 Jun 2010, 12:59					</div>
				</div>
				<div class="post-content content">
					<p>rebuild openwrt r21696 from SVN trunk,still error:<br /><strong>eglibc</strong><br /></p><div class="codebox"><pre><code>checking whether mbrtowc handles incomplete characters... (cached) yes
checking whether mbrtowc works as well as mbtowc... configure: error: in `/vint/firewall/build_dir/target-i386_eglibc-2.8/coreutils-7.2&#039;:
configure: error: cannot run test program while cross compiling
See `config.log&#039; for more details.
make[3]: *** [/vint/firewall/build_dir/target-i386_eglibc-2.8/coreutils-7.2/.configured_] Error 1
make[3]: Leaving directory `/vint/firewall/feeds/packages/utils/coreutils&#039;
make[2]: *** [package/feeds/packages/coreutils/compile] Error 2
make[2]: Leaving directory `/vint/firewall&#039;
make[1]: *** [/vint/firewall/staging_dir/target-i386_eglibc-2.8/stamp/.package_compile] Error 2
make[1]: Leaving directory `/vint/firewall&#039;
make: *** [world] Error 2</code></pre></div><p>---------<br /></p><div class="codebox"><pre><code>configure:11759: checking whether mbrtowc handles incomplete characters
configure:11812: result: yes
configure:11818: checking whether mbrtowc works as well as mbtowc
configure:11832: error: in `/vint/firewall/build_dir/target-i386_eglibc-2.8/coreutils-7.2&#039;:
configure:11835: error: cannot run test program while cross compiling
See `config.log&#039; for more details.</code></pre></div>											<p class="post-edited">(Last edited by <strong>feelnow</strong> on 7 Jun 2010, 13:00)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110687">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						7 Jun 2010, 13:15					</div>
				</div>
				<div class="post-content content">
					<p>Try passing &quot;gl_cv_func_mbrtowc_sanitycheck=yes&quot; in CONFIGURE_VARS</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110691">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">feelnow</div>
					<div class="post-datetime">
						7 Jun 2010, 13:47					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jow wrote:</cite><blockquote><p>Try passing &quot;gl_cv_func_mbrtowc_sanitycheck=yes&quot; in CONFIGURE_VARS</p></blockquote></div><div class="codebox"><pre><code>checking whether mbrtowc handles incomplete characters... (cached) yes
checking whether mbrtowc works as well as mbtowc... (cached) yes
checking whether mbrtowc handles a NULL string argument... configure: error: in `/vint/firewall/build_dir/target-i386_eglibc-2.8/coreutils-7.2&#039;:
configure: error: cannot run test program while cross compiling
See `config.log&#039; for more details.
make[2]: *** [/vint/firewall/build_dir/target-i386_eglibc-2.8/coreutils-7.2/.configured_] Error 1
make[2]: Leaving directory `/vint/firewall/feeds/packages/utils/coreutils&#039;
make[1]: *** [package/feeds/packages/coreutils/compile] Error 2
make[1]: Leaving directory `/vint/firewall&#039;
make: *** [package/feeds/packages/coreutils/compile] Error 2</code></pre></div><p><strong>trying:</strong></p><div class="codebox"><pre><code>gl_cv_func_mbrtowc_nul_retval=yes
gl_cv_func_mbrtowc_null_arg=yes</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110692">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">feelnow</div>
					<div class="post-datetime">
						7 Jun 2010, 13:49					</div>
				</div>
				<div class="post-content content">
					<p>mbrtowc&nbsp; test ok,but.....<br /></p><div class="codebox"><pre><code>checking whether mbrtowc handles incomplete characters... (cached) yes
checking whether mbrtowc works as well as mbtowc... (cached) yes
checking whether mbrtowc handles a NULL string argument... (cached) yes
checking whether mbrtowc has a correct return value... (cached) yes
checking whether mbrtowc returns 0 when parsing a NUL character... (cached) yes
checking whether memrchr is declared... yes</code></pre></div><p>----------------<br /></p><div class="codebox"><pre><code>checking whether btowc(EOF) is correct... configure: error: in `/vint/firewall/build_dir/target-i386_eglibc-2.8/coreutils-7.2&#039;:
configure: error: cannot run test program while cross compiling
See `config.log&#039; for more details.
make[2]: *** [/vint/firewall/build_dir/target-i386_eglibc-2.8/coreutils-7.2/.configured_] Error 1
make[2]: Leaving directory `/vint/firewall/feeds/packages/utils/coreutils&#039;
make[1]: *** [package/feeds/packages/coreutils/compile] Error 2
make[1]: Leaving directory `/vint/firewall&#039;
make: *** [package/feeds/packages/coreutils/compile] Error 2</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110693">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">feelnow</div>
					<div class="post-datetime">
						7 Jun 2010, 14:01					</div>
				</div>
				<div class="post-content content">
					<p>Jow,many thanks for your help.</p><p>change coreutils &quot;CONFIGURE_VARS&quot; in Makefile to:<br /><strong>(build successful)</strong><br /></p><div class="codebox"><pre><code>CONFIGURE_VARS += \
        gl_cv_func_mbrtowc_incomplete_state=yes \
        gl_cv_func_mbrtowc_retval=yes \
        gl_cv_func_wcrtomb_retval=yes \
        gl_cv_func_mbrtowc_sanitycheck=yes \
        gl_cv_func_mbrtowc_nul_retval=yes \
        gl_cv_func_mbrtowc_null_arg=yes \
        gl_cv_func_btowc_eof=yes \
        gl_cv_func_wctob_works=yes</code></pre></div><div class="codebox"><pre><code>cp -fpR /vint/firewall/staging_dir/target-i386_eglibc-2.8/root-x86/tmp-coreutils-yes/. /vint/firewall/staging_dir/target-i386_eglibc-2.8/root-x86/
rm -rf /vint/firewall/staging_dir/target-i386_eglibc-2.8/root-x86/tmp-coreutils-yes
touch /vint/firewall/staging_dir/target-i386_eglibc-2.8/root-x86/stamp/.coreutils-yes_installed
make[2]: Leaving directory `/vint/firewall/feeds/packages/utils/coreutils&#039;
make[1]: Leaving directory `/vint/firewall&#039;</code></pre></div>											<p class="post-edited">(Last edited by <strong>feelnow</strong> on 7 Jun 2010, 14:02)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>