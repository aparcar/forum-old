<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Siemens SE505 v2 and SE515 for the OpenWRT project</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 5 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p10972">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">hph</div>
					<div class="post-datetime">
						18 Aug 2005, 12:09					</div>
				</div>
				<div class="post-content content">
					<p>I am willing to provide a Siemens SE505 v2 and a SE515 for the OpenWRT project. Who would be the best person to give it to?</p><p>Cheers,<br />Heinz Peter</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p10994">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Kaloz</div>
					<div class="post-datetime">
						19 Aug 2005, 01:16					</div>
				</div>
				<div class="post-content content">
					<p>I would be happy to get them supported, but IMHO nbd and wbx are happy to accept donations, too. They live closer to You, so shipping would be a bit less. Anyway, if they don&#039;t appear here, I&#039;m happy to work on those as well.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p11070">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">hph</div>
					<div class="post-datetime">
						20 Aug 2005, 22:56					</div>
				</div>
				<div class="post-content content">
					<p>Okay ... I decided to hand over the se505 to nbd right now. The se515 will follow when the AR7 port is done ... not to distract yer precious ingeniousity from the current running projects ;-)</p><p>Cheers,<br />HP</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p11097">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Kaloz</div>
					<div class="post-datetime">
						21 Aug 2005, 15:06					</div>
				</div>
				<div class="post-content content">
					<p>AFAIK the 515 is based on the Broadcom 6345 CPU, so the AR7 port won&#039;t help You with it <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p11098">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">nbd</div>
					<div class="post-datetime">
						21 Aug 2005, 15:07					</div>
				</div>
				<div class="post-content content">
					<p>I think he meant that he doesn&#039;t want to send me the unit yet, so we don&#039;t get distracted from the AR7 port <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p11100">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Kaloz</div>
					<div class="post-datetime">
						21 Aug 2005, 15:10					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m not working on AR7 <img src="https://forum.openwrt.org/img/smilies/tongue.png" width="15" height="15" alt="tongue" /> Anyway, just wanted to note this.. BTW, the <a href="http://brcm6345-linux.sourceforge.net/">http://brcm6345-linux.sourceforge.net/</a> project seems to be dead for quite some time now <img src="https://forum.openwrt.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p11110">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">hph</div>
					<div class="post-datetime">
						21 Aug 2005, 19:51					</div>
				</div>
				<div class="post-content content">
					<p>Yeah right. As written in <a href="http://openwrt.org/forum/viewtopic.php?id=2212">http://openwrt.org/forum/viewtopic.php?id=2212</a> the 1054 is basically the same as the se515 but the Siemens has a switch. I was very active in that Broadcom stuff but I stopped everything in march since there was no real progress anymore. I think the future would be a consolidation with the OpenWRT project. I simply can&#039;t do that lowlevel stuff, that&#039;s the reason for my offer ...</p><p>HP</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p11114">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">Kaloz</div>
					<div class="post-datetime">
						21 Aug 2005, 20:37					</div>
				</div>
				<div class="post-content content">
					<p>Well, as I wrote, You offered the donation, You have to choose, who gets it <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> Anyway, scream if You need my addess <img src="https://forum.openwrt.org/img/smilies/tongue.png" width="15" height="15" alt="tongue" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p11560">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">wbx</div>
					<div class="post-datetime">
						31 Aug 2005, 12:24					</div>
				</div>
				<div class="post-content content">
					<p>hi, </p><p>i actually working on Netgear WGT634U so that i do not need SE515. Source code for SE515 seems to be very ugly, so that I think <br />i&#039;ll be investing more time into AR7 after finishing Netgear support.</p><p>So give it to Kaloz :}</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p12427">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">Keksdosenmann</div>
					<div class="post-datetime">
						21 Sep 2005, 01:06					</div>
				</div>
				<div class="post-content content">
					<p>Is someone out there how start a BRC963xx-Projekt on OpenWRT? The last <a href="http://brcm6345-linux.sourceforge.net">http://brcm6345-linux.sourceforge.net</a>/ is died in 2004. ... But it can be allways usefull to run OpenWRT on a DSL-Modem Brcm Mip. </p><br /><p>Keks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p12445">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">Kaloz</div>
					<div class="post-datetime">
						21 Sep 2005, 07:43					</div>
				</div>
				<div class="post-content content">
					<p>We don&#039;t have hardware to work on <img src="https://forum.openwrt.org/img/smilies/roll.png" width="15" height="15" alt="roll" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p12458">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">Keksdosenmann</div>
					<div class="post-datetime">
						21 Sep 2005, 11:01					</div>
				</div>
				<div class="post-content content">
					<p>The bcr6345 is also available in T-Sinus 1054, the Source with a Development Toolbox you can dowload at <a href="http://www.telekom.de/dtag/downloads/b/bcm963xx_2.14L.02DT_consumer_release.tar.gz">http://www.telekom.de/dtag/downloads/b/ â€¦ ase.tar.gz</a> . You can build your own bin&#039;s. Check this out!</p>											<p class="post-edited">(Last edited by <strong>Keksdosenmann</strong> on 21 Sep 2005, 11:01)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p23168">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">hph</div>
					<div class="post-datetime">
						19 Mar 2006, 18:39					</div>
				</div>
				<div class="post-content content">
					<p>Well, it&#039;s done. The SE505 went to nbd a while ago and now a SE515 should be knocking at Kaloz door!</p><br /><p>HP</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p27475">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">gnuisnotunix</div>
					<div class="post-datetime">
						19 May 2006, 02:00					</div>
				</div>
				<div class="post-content content">
					<p>Kaloz, are you working on the SE515? I was just curious about the status of this port :-P</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p27481">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">Kaloz</div>
					<div class="post-datetime">
						19 May 2006, 04:36					</div>
				</div>
				<div class="post-content content">
					<p>If I have something usable, it will appear in te repository.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p33715">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">hph</div>
					<div class="post-datetime">
						12 Sep 2006, 14:30					</div>
				</div>
				<div class="post-content content">
					<p>Well, quite some time passed. Anything done in this space? Or have I wasted two routers here?</p><p>Kind regards,<br />Heinz Peter</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p39482">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">hph</div>
					<div class="post-datetime">
						22 Dec 2006, 18:17					</div>
				</div>
				<div class="post-content content">
					<p>Another three months have passed. I can I help somewhere? My se515 is still ready for testing.</p><p>Kind regards,<br />Heinz Peter</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p39533">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">Grimson</div>
					<div class="post-datetime">
						24 Dec 2006, 12:25					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>hph wrote:</cite><blockquote><p>Or have I wasted two routers here?</p></blockquote></div><p>Given that the new diag driver doesn&#039;t even know the SE505 V2 (tested in RC6 and the current svn branch) I would say you wasted that one <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" />.</p>											<p class="post-edited">(Last edited by <strong>Grimson</strong> on 24 Dec 2006, 12:31)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p39657">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">Timo Beil</div>
					<div class="post-datetime">
						27 Dec 2006, 21:07					</div>
				</div>
				<div class="post-content content">
					<p>I have a SE505V2 patch for diag.c, which adds an override for the (defunct) hardware detection (i.e. you can set the index to the hardware property table using a NVRAM entry). Using it, you&#039;ll get control of the LEDs through /proc/diag/leds/... </p><p>Only one thing doesn&#039;t work as expected: as soon as diag.c takes over, the WWW LED won&#039;t be controlled by the WLAN driver any longer (that&#039;s OK). However, the WLAN driver won&#039;t use the WLAN LED either... </p><p>In my opinion, testing a universal hardware detection is very difficult, since there are many criteria (CFE / PMON, hardware identification strings my or may not exist, possibly unknown models etc). However, if the hardware can&#039;t be detected in a reliable way, using an override is a good option (using a hardware identification code, not an index to the hardware table). Alternatively a NVRAM variable with a character string describing the hardware features could be used... </p><p>BTW: you&#039;ll get full support for the reset button by desoldering C365 from the PCB (failsafe mode and running&nbsp; scripts in /etc/hotplug.d/button) - the SE505 wiki page has been updated ( <a href="http://wiki.openwrt.org/OpenWrtDocs/Hardware/Siemens/SE505">http://wiki.openwrt.org/OpenWrtDocs/Har â€¦ mens/SE505</a> ).</p><p>Cheers<br />/T</p><p>The patch is here:&nbsp; <a href="http://pastebin.ca/292838">http://pastebin.ca/292838</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p39703">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">Timo Beil</div>
					<div class="post-datetime">
						28 Dec 2006, 17:47					</div>
				</div>
				<div class="post-content content">
					<p>I worked on the diag.c code a bit - with the patch below you&#039;ll get control over the hardware detection, and you&#039;ll get optional user defined hardware settings.</p><p>Be warned: using the wrong hardware settings can crash your router, and you may have to use serial console or &quot;reset to factory settings&quot; to fix it! On the other hand, tempering with sdram_init is more likely to bring you into trouble. Not to mention the buggy hardware detection in RC5 :-)</p><p>The following nvram variables can be used:</p><p>1) User hardware definition with configuration strings:<br />nvram_buttons=button_string<br />nvram_leds=leds_string</p><div class="codebox"><pre><code># diag module hardware definition for SE505V2
nvram set nvram_buttons=reset-7
nvram set nvram_leds=power-5-0,wlan-3-0,dmz-0-0
nvram commit</code></pre></div><p>This option is very nice for hardware mods: you can define more buttons or LEDs or redefine LED or button names if you like. I don&#039;t have to tell you, that you can crash the router with a wrong configuration string! </p><p>2) Hard override ( make sure you know the right hardware index number for your version of diag.c. ):</p><p>nvram_enum=/enum index from diag.c/</p><div class="codebox"><pre><code># diag module hardware detection override for SE505V2
nvram set nvram_enum=22
nvram commit</code></pre></div><p>The priority of the settins is as follows:<br />1: user defined settins<br />2: hardware override<br />3: hardware auto detect</p><div class="codebox"><pre><code>--- diag.c.ori  2006-12-26 13:51:53.000000000 +0100
+++ diag.c      2006-12-28 13:30:52.000000000 +0100
@@ -88,6 +88,9 @@

        /* Trendware */
        TEW411BRPP,
+
+       /* end marker */
+        THE_END,
 };

 static struct platform_t __init platforms[] = {
@@ -334,7 +337,7 @@
        [SE505V2] = {
                .name           = &quot;Siemens SE505 V2&quot;,
                .buttons        = {
-                       /* No usable buttons */
+                       { .name = &quot;reset&quot;,      .gpio = 1 &lt;&lt; 7 },
                },
                .leds           = {
                        { .name = &quot;power&quot;,      .gpio = 1 &lt;&lt; 5, .polarity = REVERSE },
@@ -536,6 +539,57 @@
        return NULL;
 }

+// example configuration strings for SE505V2
+// nvram set diag_buttons=reset-7
+// nvram set diag_leds=power-5-0,dmz-0-0,wlan-3-0
+
+
+#define C_MAX_DIAG_CONFIG   80
+static char diag_user_str[C_MAX_DIAG_CONFIG] = &quot;&quot;;
+static char diag_buttons_str[C_MAX_DIAG_CONFIG] = &quot;&quot;;
+static char diag_leds_str[C_MAX_DIAG_CONFIG] = &quot;&quot;;
+
+static struct platform_t __init *platform_user(struct platform_t *pMyPlatform)
+{
+    char * item_name = NULL;
+    unsigned int uiCntB=0, uiCntL=0;
+
+    strncpy(diag_buttons_str, getvar(&quot;diag_buttons&quot;), C_MAX_DIAG_CONFIG);
+    item_name = strtok(diag_buttons_str, &quot;,-&quot;);
+
+    while ( item_name &amp;&amp; (uiCntB &lt; MAX_GPIO) )
+    {
+        pMyPlatform-&gt;buttons[uiCntB].name  = item_name;
+        pMyPlatform-&gt;buttons[uiCntB].gpio  = 1 &lt;&lt; simple_strtoul( strtok(NULL, &quot;,-&quot;), NULL, 0);
+        item_name = strtok(NULL, &quot;,-&quot;);
+        uiCntB++;
+    }
+
+    strncpy(diag_leds_str, getvar(&quot;diag_leds&quot;), C_MAX_DIAG_CONFIG);
+    item_name = strtok(diag_leds_str, &quot;,-&quot;);
+
+    while ( item_name &amp;&amp; (uiCntL &lt; MAX_GPIO) )
+    {
+        pMyPlatform-&gt;leds[uiCntL].name     = item_name;
+        pMyPlatform-&gt;leds[uiCntL].gpio     = 1 &lt;&lt; simple_strtoul( strtok(NULL, &quot;,-&quot;), NULL, 0);
+        pMyPlatform-&gt;leds[uiCntL].polarity = simple_strtoul( strtok(NULL, &quot;,-&quot;), NULL, 0);
+        item_name = strtok(NULL, &quot;,-&quot;);
+        uiCntL++;
+    }
+
+    if ( uiCntB || uiCntL )
+    {
+        sprintf( diag_user_str, &quot;User defined (%u buttons, %u leds)&quot;, uiCntB, uiCntL);
+        pMyPlatform-&gt;name = diag_user_str;
+        return pMyPlatform;
+    }
+    else
+    {
+        return NULL;
+    }
+}
+
+
 static void set_irqenable(int enabled)
 {
        unsigned int coreidx;
@@ -855,14 +909,37 @@
        static struct proc_dir_entry *p;
        static struct platform_t *detected;

+       memset(&amp;platform, 0,  sizeof(struct platform_t));
+
        detected = platform_detect();
        if (!detected) {
                printk(MODULE_NAME &quot;: Router model not detected.\n&quot;);
+       }
+        else {
+               printk(MODULE_NAME &quot;: Detected &#039;%s&#039;\n&quot;, detected-&gt;name);
+       }
+
+        if (strlen(getvar(&quot;diag_enum&quot;)))
+        {
+                unsigned long ulDiagEnum = simple_strtoul(getvar(&quot;diag_enum&quot;), NULL, 0);
+                if ( ulDiagEnum &gt;=0 &amp;&amp; ulDiagEnum &lt; THE_END )
+                {
+                        detected = &amp;platforms[ulDiagEnum];
+                        printk(MODULE_NAME &quot;: Override: %s.\n&quot;, detected-&gt;name);
+                }
+        }
+
+       if ( !platform_user(&amp;platform) ) {
+               if (!detected) {
                return -ENODEV;
        }
+               else {
        memcpy(&amp;platform, detected, sizeof(struct platform_t));
-
-       printk(MODULE_NAME &quot;: Detected &#039;%s&#039;\n&quot;, platform.name);
+               }
+       }
+       else {
+               printk(MODULE_NAME &quot;: %s\n&quot;, platform.name);
+       }

        if (!(diag = proc_mkdir(&quot;diag&quot;, NULL))) {
                printk(MODULE_NAME &quot;: proc_mkdir on /proc/diag failed\n&quot;);</code></pre></div>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>