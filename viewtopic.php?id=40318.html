<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> cross compile libftdi</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 23 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p182344">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">tregub</div>
					<div class="post-datetime">
						4 Nov 2012, 20:10					</div>
				</div>
				<div class="post-content content">
					<p>please help. (sorry for my english)</p><p>I try to compile helloworld code from this guide: <a href="http://gargoyle-router.com/old-openwrt-coding.html">http://gargoyle-router.com/old-openwrt-coding.html</a><br />it&#039;s compiled and i can run it on my tp-link mr3020 (attitude_adjustment)</p><p>Ok. now i want compile sample code from <a href="http://www.intra2net.com/en/developer/libftdi/documentation/">http://www.intra2net.com/en/developer/l … mentation/</a><br />i take code from this page and insert it into helloworld.c and run make. In this case code does not compile with next error:</p><p>&quot; undefined reference to &#039;ftdi_usb_close&#039; &quot; (this is function from ftdI.h)</p><p>so my question is <br />Why compiler cannot find and include &quot;ftdi.h&quot; but can find and include &quot;stdio.h&quot; if they locate in one folder (/usr/include/)?</p><p>and </p><p>HOW i can get success? (step by step)</p><p>p.s. i also try use -MD key for generate *.d file with paths to header file and include this *.d file to makefile.</p><br /><p>Thanks</p>											<p class="post-edited">(Last edited by <strong>tregub</strong> on 4 Nov 2012, 20:33)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p182347">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">written_direcon</div>
					<div class="post-datetime">
						4 Nov 2012, 20:17					</div>
				</div>
				<div class="post-content content">
					<p>You have the source code from libftdi?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p182352">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">tregub</div>
					<div class="post-datetime">
						4 Nov 2012, 20:22					</div>
				</div>
				<div class="post-content content">
					<p>yes, i take source code from this page <a href="http://www.intra2net.com/en/developer/libftdi/documentation/">http://www.intra2net.com/en/developer/l … mentation/</a></p><br /><p>i use <a href="http://downloads.openwrt.org/attitude_adjustment/12.09-beta/ar71xx/generic/OpenWrt-SDK-ar71xx-for-linux-i486-gcc-4.6-linaro_uClibc-0.9.33.2.tar.bz2">http://downloads.openwrt.org/attitude_a … .2.tar.bz2</a></p>											<p class="post-edited">(Last edited by <strong>tregub</strong> on 4 Nov 2012, 20:26)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p182357">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						4 Nov 2012, 21:02					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>tregub wrote:</cite><blockquote><p>so my question is <br />Why compiler cannot find and include &quot;ftdi.h&quot; but can find and include &quot;stdio.h&quot; if they locate in one folder (/usr/include/)?</p></blockquote></div><p>AFAIK, /usr/include is your host system include directory. OpenWRT include directory is under $(STAGING_DIR)/usr/include.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p182428">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">tregub</div>
					<div class="post-datetime">
						5 Nov 2012, 12:22					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>mazilo wrote:</cite><blockquote><p>AFAIK, /usr/include is your host system include directory. OpenWRT include directory is under $(STAGING_DIR)/usr/include.</p></blockquote></div><p>i try put file ftdi.h into $(STAGING_DIR)/usr/include but it does not solve my problem</p><p>i do next steps:</p><p>1. install debian on virtualbox<br />2. install libftdi <br />3. download and unpack <a href="http://downloads.openwrt.org/attitude_adjustment/12.09-beta/ar71xx/generic/OpenWrt-SDK-ar71xx-for-linux-i486-gcc-4.6-linaro_uClibc-0.9.33.2.tar.bz2">http://downloads.openwrt.org/attitude_a … .2.tar.bz2</a></p><p>4. create folder &quot;helloworld&quot; in OpenWrt-SDK-ar71xx-for-linux-i486-gcc-4.6-linaro_uClibc-0.9.33.2/package</p><p>5. create folder &quot;src&quot; in OpenWrt-SDK-ar71xx-for-linux-i486-gcc-4.6-linaro_uClibc-0.9.33.2/package</p><p>6. create file helloworld.c in OpenWrt-SDK-ar71xx-for-linux-i486-gcc-4.6-linaro_uClibc-0.9.33.2/package/src <br /></p><div class="codebox"><pre><code>#include &lt;stdio.h&gt;
#include &lt;ftdi.h&gt;

int main(void)
{
    int ret;
    struct ftdi_context ftdic;
    if (ftdi_init(&amp;ftdic) &lt; 0)
    {
        fprintf(stderr, &quot;ftdi_init failed\n&quot;);
        return EXIT_FAILURE;
    }

    if ((ret = ftdi_usb_open(&amp;ftdic, 0x0403, 0x6001)) &lt; 0)
    {
        fprintf(stderr, &quot;unable to open ftdi device: %d (%s)\n&quot;, ret, ftdi_get_error_string(&amp;ftdic));
        return EXIT_FAILURE;
    }

    // Read out FTDIChip-ID of R type chips
    if (ftdic.type == TYPE_R)
    {
        unsigned int chipid;
        printf(&quot;ftdi_read_chipid: %d\n&quot;, ftdi_read_chipid(&amp;ftdic, &amp;chipid));
        printf(&quot;FTDI chipid: %X\n&quot;, chipid);
    }

    if ((ret = ftdi_usb_close(&amp;ftdic)) &lt; 0)
    {
        fprintf(stderr, &quot;unable to close ftdi device: %d (%s)\n&quot;, ret, ftdi_get_error_string(&amp;ftdic));
        return EXIT_FAILURE;
    }

    ftdi_deinit(&amp;ftdic);

    return EXIT_SUCCESS;
}</code></pre></div><p>7. create Makefile in OpenWrt-SDK-ar71xx-for-linux-i486-gcc-4.6-linaro_uClibc-0.9.33.2/package/src<br /></p><div class="codebox"><pre><code>helloworld: helloworld.o
    $(CC) $(LDFLAGS) helloworld.o -o helloworld
helloworld.o: helloworld.c
    $(CC) $(CFLAGS) -c helloworld.c

clean:
    rm *.o helloworld</code></pre></div><p>8. create Makefile in OpenWrt-SDK-ar71xx-for-linux-i486-gcc-4.6-linaro_uClibc-0.9.33.2/package<br /></p><div class="codebox"><pre><code>include $(TOPDIR)/rules.mk

PKG_NAME:=helloworld
PKG_RELEASE:=1

PKG_BUILD_DIR := $(BUILD_DIR)/$(PKG_NAME)

include $(INCLUDE_DIR)/package.mk

define Package/helloworld
    SECTION:=utils
    CATEGORY:=Utilities
    TITLE:=Helloworld -- prints a snarky message
endef

define Build/Prepare
    mkdir -p $(PKG_BUILD_DIR)
    $(CP) ./src/* $(PKG_BUILD_DIR)/
endef

define Package/helloworld/install
    $(INSTALL_DIR) $(1)/bin
    $(INSTALL_BIN) $(PKG_BUILD_DIR)/helloworld $(1)/bin/
endef

$(eval $(call BuildPackage,helloworld))</code></pre></div><p>8. go to OpenWrt-SDK-ar71xx-for-linux-i486-gcc-4.6-linaro_uClibc-0.9.33.2 directory (cd /home/tregub/Downloads/OpenWrt-SDK-ar71xx-for-linux-i486-gcc-4.6-linaro_uClibc-0.9.33.2)</p><p>9. do &quot;make V=s&quot;</p><p>10.&nbsp; undefined reference to &#039;ftdi_usb_close&#039;<br />undefined reference to &#039;ftdi_deinit&#039; etc<br />collect2: ld returned 1 exit status</p><br /><p>Whats wrong?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p182479">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						5 Nov 2012, 20:56					</div>
				</div>
				<div class="post-content content">
					<p>R U aware of and/or have you tried to compile the <em>feeds/packages/libs/libftdi</em> package from OpenWRT SVN trunk?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>