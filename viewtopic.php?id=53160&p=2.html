<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Configuration problem for IPv6 on Barrier Breaker behind a Freebox</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 3 Apr 2018 and 22 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 2 of 2</div><nav><ul><li><a href="viewtopic.php%3Fid=53160&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p287495">
				<div class="post-metadata">
					<div class="post-num">Post #26</div>
					<div class="post-author">Manani</div>
					<div class="post-datetime">
						13 Aug 2015, 21:12					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>gnutella wrote:</cite><blockquote><p>C&#039;est OpenWRT le routeur et NON la Freebox.<br />En fait, chacun fait son travail ...</p></blockquote></div><p>C&#039;est tentant de répondre dans la langue de la Freebox <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Salut Gnutella,<br />Content de savoir que d&#039;autres personnes comme vous s&#039;acharnent sur le sujet. J&#039;avais baissé les bras.</p><p>De ce que j&#039;ai pu apprendre, même en bridge la Freebox reste le routeur en IPv6. Y a-t-il évolution chez Free?</p><p>A un moment l&#039;IPv6 a fonctionné parfaitement chez moi en mode relay. Je ne comprends toujours ce qui est à l&#039;origine de de la régression, Free ou OpenWRT?</p><p>Bien cordialement</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p287500">
				<div class="post-metadata">
					<div class="post-num">Post #27</div>
					<div class="post-author">gnutella</div>
					<div class="post-datetime">
						13 Aug 2015, 22:02					</div>
				</div>
				<div class="post-content content">
					<p>Je pense que les difficultés rencontrées viennent du peu d&#039;informations disponibles. </p><p>Par exemple, il me semble que le NextHop n&#039;est disponible que sur la Freebox v6 et la Freebox Android.</p><p>Il m&#039;a fallu lire tous les posts concernant la Freebox et OpenWRT pour finalement en venir à la conclusion que c&#039;était possible, et même assez facile. On a perdu du temps en s&#039;acharnant sur les protocoles de diffusion des adresses publiques, alors qu&#039;avec le NextHop, on n&#039;en a pas besoin. La configuration d&#039;utilise ni RADVD, ni NDP.</p><p>La nouvelle documentation d&#039;OpenWRT ipv6 est très bien faite:<br /><a href="http://wiki.openwrt.org/doc/uci/network6">http://wiki.openwrt.org/doc/uci/network6</a></p><p>Je vais créer une page sur le wiki d&#039;OpenWRT concernant la Freebox.</p>											<p class="post-edited">(Last edited by <strong>gnutella</strong> on 13 Aug 2015, 22:09)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p287503">
				<div class="post-metadata">
					<div class="post-num">Post #28</div>
					<div class="post-author">dClauzel</div>
					<div class="post-datetime">
						13 Aug 2015, 22:46					</div>
				</div>
				<div class="post-content content">
					<p>Personnellement, j’ai la fibre avec une Freebox Ô (F-OPTO2A O-SR), donc il faudra s’assurer que la solution trouvée fonctionne aussi chez-moi <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p287508">
				<div class="post-metadata">
					<div class="post-num">Post #29</div>
					<div class="post-author">gnutella</div>
					<div class="post-datetime">
						13 Aug 2015, 23:11					</div>
				</div>
				<div class="post-content content">
					<p>Super, mon domicile secondaire a été fibré il y a 2 semaines, la connexion arrive en décembre 2015.<br />J&#039;ai flingué tous mes hébergement OVH et Online, j&#039;ai réellement besoin de l&#039;Ipv6.</p><p>J&#039;ai créé cette page wiki : <a href="http://wiki.openwrt.org/doc/howto/freebox">http://wiki.openwrt.org/doc/howto/freebox</a><br />Je publie ma configuration, essayez d&#039;améliorer la page, on a trop galéré, il faut mutualiser les connaissances et si nécessaire demander de l&#039;aide au developer network de Free.fr</p><p>La connexion a l&#039;air stable, elle tient depuis presque 24 heures sans problème de routage.</p>											<p class="post-edited">(Last edited by <strong>gnutella</strong> on 13 Aug 2015, 23:33)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p287511">
				<div class="post-metadata">
					<div class="post-num">Post #30</div>
					<div class="post-author">gnutella</div>
					<div class="post-datetime">
						13 Aug 2015, 23:33					</div>
				</div>
				<div class="post-content content">
					<p>La mise en page laisse à désirer, je terminerai demain ... trop crevé.<br />Les blocs code cassent tout. Si vous savez comment réparer cela, ce serait bien ...<br />Cela doit être du XML et il faut probablement utiliser une notation spécifique.</p><p>dClauzel, tu as réussi à configurer en statique ? en DHCP ?</p>											<p class="post-edited">(Last edited by <strong>gnutella</strong> on 13 Aug 2015, 23:34)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p287514">
				<div class="post-metadata">
					<div class="post-num">Post #31</div>
					<div class="post-author">dClauzel</div>
					<div class="post-datetime">
						13 Aug 2015, 23:54					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>gnutella wrote:</cite><blockquote><p>La mise en page laisse à désirer, je terminerai demain ... trop crevé.<br />Les blocs code cassent tout. Si vous savez comment réparer cela, ce serait bien ...<br />Cela doit être du XML et il faut probablement utiliser une notation spécifique.</p></blockquote></div><p>Je viens de faire un nettoyage <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><div class="quotebox"><blockquote><p>dClauzel, tu as réussi à configurer en statique ? en DHCP ?</p></blockquote></div><p>Non, je ne refais pas d’essais tant que CC n’est pas sorti officiellement; je n’ai pas le temps de jouer avec des beta ou des RC.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p287559">
				<div class="post-metadata">
					<div class="post-num">Post #32</div>
					<div class="post-author">gnutella</div>
					<div class="post-datetime">
						14 Aug 2015, 10:02					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dClauzel wrote:</cite><blockquote><p>Non, je ne refais pas d’essais tant que CC n’est pas sorti officiellement; je n’ai pas le temps de jouer avec des beta ou des RC.</p></blockquote></div><p>La configuration NextHop est compatibles avec toute version d&#039;OpenWRT supportant IPv6. La Freebox reçoit la délégation d&#039;adresses IPv6, mais elle ne connait pas la fin du réseau (qui est en NextHop). Elle passe la connexion au routeur OpenWRT qui finit le travail de routage en bout de chaîne. C&#039;est d&#039;ailleurs une belle solution technique, car les machines sur le réseau local peuvent être n&#039;importe où dans la classe /64, ce qui est une belle solution en terme de sécurité.</p><p>Je vais reprendre le wiki pour expliquer cela en détail, puis je me concentrerai sur la configuration DHCP. Il n&#039;y a pas de raison que cela ne fonctionne pas en DHCP.</p>											<p class="post-edited">(Last edited by <strong>gnutella</strong> on 14 Aug 2015, 10:03)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p287562">
				<div class="post-metadata">
					<div class="post-num">Post #33</div>
					<div class="post-author">dClauzel</div>
					<div class="post-datetime">
						14 Aug 2015, 11:31					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>gnutella wrote:</cite><blockquote><div class="quotebox"><cite>dClauzel wrote:</cite><blockquote><p>Non, je ne refais pas d’essais tant que CC n’est pas sorti officiellement; je n’ai pas le temps de jouer avec des beta ou des RC.</p></blockquote></div><p>La configuration NextHop est compatibles avec toute version d&#039;OpenWRT supportant IPv6. La Freebox reçoit la délégation d&#039;adresses IPv6, mais elle ne connait pas la fin du réseau (qui est en NextHop). Elle passe la connexion au routeur OpenWRT qui finit le travail de routage en bout de chaîne. C&#039;est d&#039;ailleurs une belle solution technique, car les machines sur le réseau local peuvent être n&#039;importe où dans la classe /64, ce qui est une belle solution en terme de sécurité.</p></blockquote></div><p>OK, compris.</p><p>Une question que je me pose aussi est de savoir si on peut relier directement le convertisseur optique au routeur — et donc lui faire jouer également le rôle de passerelle. À moins que la Freebox Ô soit nécessaire pour faire de l’authentification ou autre sur le réseau de Free?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p287576">
				<div class="post-metadata">
					<div class="post-num">Post #34</div>
					<div class="post-author">gnutella</div>
					<div class="post-datetime">
						14 Aug 2015, 13:40					</div>
				</div>
				<div class="post-content content">
					<p>Intéressant.</p><p>J&#039;ai déjà discuté avec un client (une société), qui pour des questions de sécurité avait acheté un modem ADSL, l&#039;avait connecté à une machine Debian et s&#039;était ensuite connecté directement au réseau Free. Mais j&#039;ignore s&#039;il avait connecté une Freebox derrière son modem ... A mon avis, si la sécurité est l&#039;objectif ultime, cela m&#039;étonnerait. Je crois même qu&#039;il a rendu sa Freebox.</p><p>Dans ton cas, encore faut-il disposer d&#039;une carte fibre optique. J&#039;ignore tout concernant les protocoles utilisés par Free. C&#039;est réellement une problématique différente que le NextHop.</p><p>Si tu veux mon avis, la Freebox a été auditée par l&#039;ANSI. C&#039;est un matériel bien connu, très sécurisé. Si tu veux augmenter le niveau de sécurité, tu peux la faire fonctionner en mode bridge.</p><p>L&#039;utilisation d&#039;OpenWRT en tant que routeur et filtrage est déjà une excellente solution. Tu peux disposer des machines sur un /128, pratiquement inaccessibles, à condition d&#039;activer les extensions de sécurité, qui dédoublent les adresses ipv6 (une en entrée, l&#039;autre en sortie) et les assignent de manière aléatoire.</p><p>Tout ceci n&#039;est possible qu&#039;avec le NextHop, une option incontournable.<br />Par exemple, tu peux planquer une machine de backup sur ton réseau IPv6 et faire en sorte que lorsque ta machine discute avec l&#039;extérieur (par exemple pour une mise à jour), elle utilise une adresse IPv6 aléatoire, ce qui rend beaucoup plus complexe une attaque, car personne à par toi et le routeur OpenWRT ne connaît l&#039;adresse IPv6 du serveur.</p>											<p class="post-edited">(Last edited by <strong>gnutella</strong> on 14 Aug 2015, 13:43)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p287578">
				<div class="post-metadata">
					<div class="post-num">Post #35</div>
					<div class="post-author">dClauzel</div>
					<div class="post-datetime">
						14 Aug 2015, 13:48					</div>
				</div>
				<div class="post-content content">
					<p>Le convertisseur optique sort en ethernet pour rejoindre la Freebox Ô (passerelle), qui relie le routeur à internet.</p><p>S’il y a moyen de supprimer la Freebox pour mettre directement le routeur-passerelle derrière le convertisseur optique, ça m’intéresse.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p287600">
				<div class="post-metadata">
					<div class="post-num">Post #36</div>
					<div class="post-author">yanfox</div>
					<div class="post-datetime">
						14 Aug 2015, 16:38					</div>
				</div>
				<div class="post-content content">
					<p>Salut,</p><p>Ravi que ce topic rebouge... dans la langue Freeboxienne qui plus est ^^</p><p>Concernant le next-hop en v5/ipv6 je pense que c&#039;est foutu... la v6 et la 4k/Android possèdent le freebox OS et font l&#039;objet de toutes les attentions, je doute que la v5/alicebox obtienne une mise à jour pour activer cette option... mais qui sait... <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>J&#039;ai ouvert un ticket pour la v5... <a href="http://dev.freebox.fr/bugs/task/18518">http://dev.freebox.fr/bugs/task/18518</a></p><p>Ca doit fonctionner avec un modem classique je pense, mais je perds l&#039;usage de la téléphonie et de la tv du coup...</p>											<p class="post-edited">(Last edited by <strong>yanfox</strong> on 14 Aug 2015, 16:45)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p287675">
				<div class="post-metadata">
					<div class="post-num">Post #37</div>
					<div class="post-author">gnutella</div>
					<div class="post-datetime">
						15 Aug 2015, 11:25					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dClauzel wrote:</cite><blockquote><p>S’il y a moyen de supprimer la Freebox pour mettre directement le routeur-passerelle derrière le convertisseur optique, ça m’intéresse.</p></blockquote></div><p>Intéressant. Mais je préfère considérer que la Freebox fait partie d&#039;un réseau public IPv6 non-filtré et qu&#039;OpenWRT est en fin de réseau pour assurer le filtrage ipV6. La question ultime est de savoir si OpenWRT est réellement sécurisé, j&#039;en doute vu le nombre de patchs kernel qui sont appliqués à tout moment. Si tu veux une solution réellement sécurisée : 1) passe en mode bridge (tu perds la télé et tout le reste) et install un Linux ou un FreeBSD (Debian nue par exemple), avec un noyau compilé statiquement (facile sous Debian, il suffit de recompiler par une seule commande) et le patch GrSEC. L&#039;ANSSI a publié des documents à ce sujet sur leur site, il me semble qu&#039;il s&#039;agit du &quot;guide survie Linux&quot;</p><div class="quotebox"><cite>dClauzel wrote:</cite><blockquote><p>Concernant le next-hop en v5/ipv6 je pense que c&#039;est foutu... la v6 et la 4k/Android possèdent le freebox OS et font l&#039;objet de toutes les attentions, je doute que la v5/alicebox obtienne une mise à jour pour activer cette option... mais qui sait... smile..</p></blockquote></div><br /><p>A la campagne, j&#039;avais une v5 et je suis passé à la v6 pour avoir la fibre et pingo. On ne pourra pas rester longtemps avec la v6. Note qu&#039;il est théoriquement possible de faire de la délégation avec la v5, il suffit que Free publie ses specs.</p>											<p class="post-edited">(Last edited by <strong>gnutella</strong> on 15 Aug 2015, 11:29)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p287678">
				<div class="post-metadata">
					<div class="post-num">Post #38</div>
					<div class="post-author">Manani</div>
					<div class="post-datetime">
						15 Aug 2015, 12:15					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>gnutella wrote:</cite><blockquote><p> ... passe en mode bridge (tu perds la télé et tout le reste) ...</p></blockquote></div><p>Non, en bridge on ne perd rien si on crée un Vlan100. Dans le cas particulier de la Freebox HD(v5) on perd le dLNA car cette box ne sait pas faire le DHCP, ce n&#039;est pas le cas avec la v6.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p287681">
				<div class="post-metadata">
					<div class="post-num">Post #39</div>
					<div class="post-author">gnutella</div>
					<div class="post-datetime">
						15 Aug 2015, 12:48					</div>
				</div>
				<div class="post-content content">
					<p>Je bloque sur la configuration DHCP des clients, car j&#039;aimerais utiliser DNSmasq pour diffuser en local ip + gateway aux clients en fonction de leur adresse MAC. Vous savez faire cela dans DNSmasq ?</p><p><a href="http://wiki.openwrt.org/doc/howto/freebox#dns_local">http://wiki.openwrt.org/doc/howto/freebox#dns_local</a></p>											<p class="post-edited">(Last edited by <strong>gnutella</strong> on 15 Aug 2015, 12:48)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p287740">
				<div class="post-metadata">
					<div class="post-num">Post #40</div>
					<div class="post-author">gnutella</div>
					<div class="post-datetime">
						15 Aug 2015, 23:48					</div>
				</div>
				<div class="post-content content">
					<p>J&#039;ai revu la documentation et fait le tour de la configuration statique et de la configuration stateless, qui fonctionnent. Par contre, je bloque toujours sur la configration stateful : <a href="http://wiki.openwrt.org/doc/howto/freebox">http://wiki.openwrt.org/doc/howto/freebox</a>. Je voudrais utiliser uniquement les outils présents dans la version Staging d&#039;OpenWRT.</p><p>Est-ce que l&#039;un d&#039;entre-vous arrive à configurer en stateful ?</p>											<p class="post-edited">(Last edited by <strong>gnutella</strong> on 15 Aug 2015, 23:50)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p287822">
				<div class="post-metadata">
					<div class="post-num">Post #41</div>
					<div class="post-author">b.bo</div>
					<div class="post-datetime">
						16 Aug 2015, 19:49					</div>
				</div>
				<div class="post-content content">
					<p>Bonjour,</p><p>Je suis désolé de m&#039;incruster ici, je veux juste adresser un message à Gnutella.</p><p>@gnutella tu avais répondu le 12/08 sur mon fil en me disant que tu avais exactement la même configuration (<a href="https://forum.openwrt.org/viewtopic.php?id=56932">https://forum.openwrt.org/viewtopic.php?id=56932</a>). Le temps que je trouve un moment et que je me pose dessus et que j&#039;essaie de voir la configuration, tu avais déjà supprimé ton post. Autais-tu la gentillesse de poster de nouveau ton message sur mon sujet? N&#039;ayant pas reçu de message depuis que j&#039;ai posé mon sujet, le bôitier est resté dans sa boite :-/</p><p>Sincèrement désolé pour &quot;l&#039;incrust&quot;.</p>											<p class="post-edited">(Last edited by <strong>b.bo</strong> on 16 Aug 2015, 19:50)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p287959">
				<div class="post-metadata">
					<div class="post-num">Post #42</div>
					<div class="post-author">gnutella</div>
					<div class="post-datetime">
						17 Aug 2015, 19:57					</div>
				</div>
				<div class="post-content content">
					<p>Il n&#039;y a pas de quoi, je t&#039;ai répondu dans le fil.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p288046">
				<div class="post-metadata">
					<div class="post-num">Post #43</div>
					<div class="post-author">gnutella</div>
					<div class="post-datetime">
						18 Aug 2015, 12:12					</div>
				</div>
				<div class="post-content content">
					<p>Une nouvelle mouture de <a href="http://wiki.openwrt.org/doc/howto/freebox">http://wiki.openwrt.org/doc/howto/freebox</a> est disponible :<br />protocole stateless, stateful et adresse ipv6 fixe.</p><p>Il subsiste quelques problèmes soulevés par la documentation : adresses stateless et stateful cohexistent.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p288078">
				<div class="post-metadata">
					<div class="post-num">Post #44</div>
					<div class="post-author">dClauzel</div>
					<div class="post-datetime">
						18 Aug 2015, 16:53					</div>
				</div>
				<div class="post-content content">
					<p>Tiens, au fait. Et pour les nouvelles Freebox mini/4k/etc, ça se passe comment l’IPv6 ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p288232">
				<div class="post-metadata">
					<div class="post-num">Post #45</div>
					<div class="post-author">yanfox</div>
					<div class="post-datetime">
						19 Aug 2015, 11:14					</div>
				</div>
				<div class="post-content content">
					<p>@dClauzel exactement de la meme façon que pour la v6. Elles partagent le même OS pour la partie &quot;server&quot;.</p><p>Comme je le craignais, nous a la confirmation pour la V5/Crystal/Alicebox, vieux matériel pauvre en mémoire, il n&#039;est pas prévu d&#039;implémenter le next-hop dessus.</p><p>Quand au moyen de faire passer le flux ipv6... nous n&#039;avons pas de réponse.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p288241">
				<div class="post-metadata">
					<div class="post-num">Post #46</div>
					<div class="post-author">gnutella</div>
					<div class="post-datetime">
						19 Aug 2015, 12:05					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dClauzel wrote:</cite><blockquote><p>Tiens, au fait. Et pour les nouvelles Freebox mini/4k/etc, ça se passe comment l’IPv6 ?</p></blockquote></div><p>D&#039;accord avec Yanfox :<br /><a href="http://wiki.openwrt.org/doc/howto/freebox#modeles_freebox">http://wiki.openwrt.org/doc/howto/freeb … es_freebox</a></p><p>Personnellement, j&#039;ai mis à jour ma Freebox crystal vers une Freebox Révolution. Je ne suis pas encore prêt pour la Freebox mini-4K, car j&#039;ignore dans quelle mesure cette box est bien sécurisée. Utiliser Android me paraît un choix lourd de conséquences. J&#039;imagine que l&#039;ANSSI travaille avec Illiad à sécuriser le bousin, en tout cas, je préfère attendre. Si je devais utiliser la 4K, ce serait dans une configuration bien isolée. Et c&#039;est bien pour cela qu&#039;on a besoin d&#039;OpenWRT, mais je vous laisse défricher.</p><p>Pour les personnes intéressées, j&#039;ai relevé une to-do list :<br /><a href="http://wiki.openwrt.org/doc/howto/freebox?&amp;#to-do_list">http://wiki.openwrt.org/doc/howto/freeb … to-do_list</a></p><p>On est clairement, tout proche du but ...</p>											<p class="post-edited">(Last edited by <strong>gnutella</strong> on 19 Aug 2015, 12:15)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p288355">
				<div class="post-metadata">
					<div class="post-num">Post #47</div>
					<div class="post-author">yanfox</div>
					<div class="post-datetime">
						19 Aug 2015, 22:18					</div>
				</div>
				<div class="post-content content">
					<p>Si je ne dis pas de bêtises, avant Barrier Breaker ça fonctionnait mais depuis qu&#039;ODHCPD a été mis en place... plus rien <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p288524">
				<div class="post-metadata">
					<div class="post-num">Post #48</div>
					<div class="post-author">Manani</div>
					<div class="post-datetime">
						20 Aug 2015, 19:45					</div>
				</div>
				<div class="post-content content">
					<p>Salut Gnutella,</p><p>Pour configurer wan et wan sur eth0.2 plutôt que eth1 comme indiqué dans la <a href="http://wiki.openwrt.org/_detail/inbox/netgear/wndr3700-c.png?id=toh%3Anetgear%3Awndr3700">conception du routeur</a>?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p289167">
				<div class="post-metadata">
					<div class="post-num">Post #49</div>
					<div class="post-author">Manani</div>
					<div class="post-datetime">
						25 Aug 2015, 19:22					</div>
				</div>
				<div class="post-content content">
					<p>J&#039;ai le même IPv6 public sur les trois interfaces wan, wan6 et lan; est-ce normal?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p294367">
				<div class="post-metadata">
					<div class="post-num">Post #50</div>
					<div class="post-author">pdm</div>
					<div class="post-datetime">
						2 Oct 2015, 22:53					</div>
				</div>
				<div class="post-content content">
					<p>Hi,<br />I made the test to configure ipv6 on my router behind a Freebox Mini server (one that offers prefix delegation) using the most as possible the luci http interface and the simplification brought by ophcpd. Not that I am reluctant to use the shell and uci, but I based my approach on the following principles:<br />- reading <a href="http://wiki.openwrt.org/doc/uci/network6,">http://wiki.openwrt.org/doc/uci/network6,</a> it seems that the native IPV6 implementation in OpenWrt is well designed and fitted by default to most situations (so why not behind a Freebox?). Moreover, <a href="http://wiki.openwrt.org/doc/uci/network6">http://wiki.openwrt.org/doc/uci/network6</a> describes the settings for the most common situations (why not just follow?),<br />- luci GUI offers the default options that can be used for the most common settings (as usual for a GUI).<br />I propose to share my experience. However I am too lazy for screen shots, so that requires some reading. One more word: I am sorry it is in English (and probably bad English) although a part of the thread is already in French, but I feel very deeply uncomfortable to express myself in another language than English in an international forum (this is a strictly personal feeling and I do not blame anyone here for using French).<br />All that is mentioned below is related to the ipv6 configuration only. In practice, I had to open a shell twice on the router (to collect a local link address and to display the route table). Besides, I had to add two routes (with the luci interface) to complement the settings for cases not covered by the default configuration (thus deviating a little to the &quot;all by default and simple&quot; principle). My router is an Archer C7 v2.0, I do not think it matters a lot since I only reference the wan6 and lan interfaces (already defined by default when opening the luci interface).</p><p>Freebox --&gt;[wan6----------lan]--&gt;clients<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [OpenWrt router]</p><p>As you may already know, Free offers network delegation and this can be done thru the Freebox interface. Actually Free offers a 2a01:e35:xxxx:xxxx:/61 that can be delegated in separate subnetworks. The first one will not be delegated as we reserve it to the Freebox itself for the router stateless configuration. The Freebox address is 2a01:e35:xxxx:xxx0::1.<br />In the ipv6 menu of the Freebox interface, we define the prefixes and nexthops:<br />1st subnet:&nbsp; prefix=&#039;2a01:e35:xxxx:xxx0:/64&#039; nexthop= left empty. <br />2nd subnet: prefix=&#039;2a01:e35:xxxx:xxx1:/64&#039; nexthop=&#039;wan6 local link adress&#039; (open a shell on the OpenWrt router and explore the ifconfig command output). We need the wan6 local link address not the lan address since the Freebox will have to know to which interface it has to pass the packets towards the delegated subnet. The lan local link address is unknown to the Freebox. There is a small inaccuracy in <a href="http://wiki.openwrt.org/doc/howto/freebox.">http://wiki.openwrt.org/doc/howto/freebox.</a> It implicitely recommends to collect the LAN local link address. With the router given as example, all local link addresses seem to be the same, so it works by chance.<br />Other subnets: not needed here</p><p>Freebox-------------&gt;[wan6||-----lan]---&gt;clients<br />&nbsp; 2a01:e35:xxxx:xxx0:/64&nbsp; &nbsp; &nbsp; &nbsp; 2a01:e35:xxxx:xxx1:/64</p><p>That&#039;s all for the Freebox.</p><p>On the router, we will now configure wan6, lan, make test connectivity and add the missing pieces. That makes three short steps.<br />1 - Wan6 configuration<br />1.1 - open&nbsp; &#039;general setup&#039; tab<br />By default DHCPV6 is proposed as default proto. We leave it selected (the Freebox offers only SLAAC but odhcpd handles it).<br />&nbsp; &nbsp; - &#039;Request IPv6-address=try&#039;<br />&nbsp; &nbsp; - &#039;Request IPv6-prefix of length=automatic&#039; (it actually picks up a /64)<br />1.2 - open &#039;advanced settings&#039; tab<br />No need to modify the default selection (all boxes should be selected), just add:<br />&nbsp; &nbsp; - &#039;Custom delegated IPv6-prefix=2a01:e35:xxxx:xxx1:/64&#039;<br />1.3 - Restart the wan6 interface, normally it should receive a global scope address (based on its hw mac address because of the stateless configuration)</p><p>2 - Lan configuration<br />2.1 - open &#039;general setup&#039; tab<br />&nbsp; &nbsp; - &#039;IPv6 assignment length=64&#039;<br />2.2 - open &#039;ipv6 settings&#039; tab<br />&nbsp; &nbsp; - &#039;Router Advertisement-Service=server mode&#039;<br />&nbsp; &nbsp; - &#039;DHCPv6-Service=disabled&#039;<br />&nbsp; &nbsp; - &#039;NDP-Proxy=disabled&#039;<br />&nbsp; &nbsp; - &#039;Always announce default router&#039;: selected<br />I do not give the details here, what matters is that each client obtains at least one ipv6 address (scope global). Possibilities offered by these options are well and extensively detailed here <a href="http://wiki.openwrt.org/doc/howto/freebox.">http://wiki.openwrt.org/doc/howto/freebox.</a><br />2.2 - Restart the Lan interface, it receives the 2a01:e35:xxxx:xxx1::1/64 global scope address </p><p>3 - Connectivity and final adjustment<br />Connect the clients. They should receive a global scope address with a 2a01:e35:xxxx:xxx1:/64 prefix. From the clients &quot;ping6 ipv6.google.com&quot; will answer that the host is unreachable. That is the sign that some route rules are missing.<br />To see what is going on, I had to access the router&#039;shell a second time. Running &#039; ip -6 route list table main&#039; reveals that here is no route for 2a01:e35:xxxx:xxx1:/64 subnet. Besides the default route address (gateway for the outside) is the Freebox local link address. To my opinion, this is not unexpected that OpenWrt does not add a route for the local net behind the lan interface: one could split the delegated network to more than one lan interface. I did not test, but I guess that it should work correctly if a value was given to ip6hint (in our example, the mask would have to be shifted through ip6assign). Indeed in such case, there would be a clear relationship between the interface and the subnet and no doubt about the routing. As for the missing default gateway on wan6, my guess is that it is related to the Freebox itself that only offers SLAAC and does not announce the gateway address. </p><p>However, we can add static routes directly from the luci interface.<br />Open the &#039;network-&gt;static route&#039; panel and for the ipv6 add the two following routes:<br />interface wan6&nbsp; / target ::0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/ gateway&nbsp; 2a01:e35:xxxx:xxx0::1<br />interface lan&nbsp; &nbsp; &nbsp; / target&nbsp; 2a01:e35:xxxx:xxx1:/64 </p><p>From the clients &quot;ping6 ipv6.google.com&quot; is now successful and test-ipv6.com gives a 10/10.</p><p>Hope it can help.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 2 of 2</div><nav><ul><li><a href="viewtopic.php%3Fid=53160&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>