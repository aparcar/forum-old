<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> TP-Link MR3420v1 16M flash /64M Memory hardware mod with uboot bin</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 4 Apr 2018 and 5 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 4 of 5</div><nav><ul><li><a href="viewtopic.php%3Fid=32512&amp;p=1.html">1</a></li><li><a href="viewtopic.php%3Fid=32512&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=32512&amp;p=3.html">3</a></li><li class="pagination-current"><span>4</span></li><li><a href="viewtopic.php%3Fid=32512&amp;p=5.html">5</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p181221">
				<div class="post-metadata">
					<div class="post-num">Post #76</div>
					<div class="post-author">MBS</div>
					<div class="post-datetime">
						22 Oct 2012, 20:47					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>sosw wrote:</cite><blockquote><p> I have done ram mod but flash<br />size is still same so I must do </p><p><a href="https://forum.openwrt.org/viewtopic.php?id=32512">https://forum.openwrt.org/viewtopic.php?id=32512</a></p><p>trick?</p></blockquote></div><p>Firmware modification is just needed when the flash is changed. The RAM mod works with original firmware.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p197255">
				<div class="post-metadata">
					<div class="post-num">Post #77</div>
					<div class="post-author">openmakersdaily</div>
					<div class="post-datetime">
						4 Apr 2013, 21:54					</div>
				</div>
				<div class="post-content content">
					<p>I also want to update uboot. I bought an original wr703n and a 64M+8M kit from ebay, and I just soldered the 8M flash.</p><p>This flash is preprogrammed with openwrt, it comes with a 4MB uboot, and a 8M image.</p><p>However, the strange part is that the rootfs partition is stuck right after the kernel, so it does not lie on a sector boundary. I&#039;m in the process of building a correct image from openwrt trunk sources.</p><p>I want to use uboot+tftp for that, so I need a 8MB enabled uboot.</p><p>I just tried to compile the uboot from tplink gpl package and I can confirm that the output directory is not $HOME/images/ap99 but ../images/ap99 relative to the &quot;build&quot; directory that holds Makefile.ap99.</p><p>Can someone tell me if the following is ok:</p><p>-start the 8MB openwrt <br />-use mtd write to update the 128k uboot partition from what I&#039;ve just compiled<br />-reboot<br />-that should work as before</p><p>-apply changes tp<br />*trunk/tools/firmware-utils/src/mktplinkfw.c <br />*target/linux/ar71xx/files/arch/mips/ar71xx/mach-tl-mr3x20.c</p><p>-rebuild openwrt for wr703</p><p>-update firmware from uboot. Can someone confirm which image is the correct one? factory, sysupgrade, unfortunately I have no idea what these words means. I could check the file size, but a confirmation would be nice.</p><p>-in case something goes wrong, I will be able to recover by soldering back the original flash and using the CS trick in uboot to reprogram the bricked flash.</p><p>edit: ok, found it here: <a href="https://forum.openwrt.org/viewtopic.php?id=34572">https://forum.openwrt.org/viewtopic.php?id=34572</a><br /> a factory image is one built for the bootloader flasher or stock software flasher<br /> a sysupgrade image (previously named trx image) is designed to be flashed from within openwrt itself</p><p>So, to flash from uboot, I need the factory image. I believe that a sysupgrade would not set the partitions limit properly.</p><p>best regards</p>											<p class="post-edited">(Last edited by <strong>openmakersdaily</strong> on 4 Apr 2013, 22:02)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p197258">
				<div class="post-metadata">
					<div class="post-num">Post #78</div>
					<div class="post-author">pepe2k</div>
					<div class="post-datetime">
						4 Apr 2013, 22:19					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>openmakersdaily wrote:</cite><blockquote><p>I also want to update uboot. I bought an original wr703n and a 64M+8M kit from ebay, and I just soldered the 8M flash.</p><p>This flash is preprogrammed with openwrt, it comes with a 4MB uboot, and a 8M image.</p><p>However, the strange part is that the rootfs partition is stuck right after the kernel, so it does not lie on a sector boundary. I&#039;m in the process of building a correct image from openwrt trunk sources.</p><p>I want to use uboot+tftp for that, so I need a 8MB enabled uboot.</p><p>I just tried to compile the uboot from tplink gpl package and I can confirm that the output directory is not $HOME/images/ap99 but ../images/ap99 relative to the &quot;build&quot; directory that holds Makefile.ap99.</p></blockquote></div><p>You should compile AP121 for TL-WR703N, not AP99.</p><div class="quotebox"><cite>openmakersdaily wrote:</cite><blockquote><p>Can someone tell me if the following is ok:</p><p>-start the 8MB openwrt <br />-use mtd write to update the 128k uboot partition from what I&#039;ve just compiled<br />-reboot<br />-that should work as before</p></blockquote></div><p>You don&#039;t need to compile OpenWrt for bigger flash chips. You can use factory images for original flash size chips.<br />And, in 703N U-Boot doesn&#039;t occupy 128 KiB! It occupies up to 64 KiB and in next 64 KiB there is MAC address and model number. Please, refer to this flash layout:</p><p><span class="postimg"><img src="http://www.tech-blog.pl/wordpress/wp-content/uploads/2013/03/tl-mr3020_flash_layout.gif" alt="http://www.tech-blog.pl/wordpress/wp-content/uploads/2013/03/tl-mr3020_flash_layout.gif" /></span></p><p>If you want, you can use my U-Boot version for this model:<br /><a href="https://forum.openwrt.org/viewtopic.php?id=43237">https://forum.openwrt.org/viewtopic.php?id=43237</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p197264">
				<div class="post-metadata">
					<div class="post-num">Post #79</div>
					<div class="post-author">twinclouds</div>
					<div class="post-datetime">
						4 Apr 2013, 23:06					</div>
				</div>
				<div class="post-content content">
					<p>The only reason you might need larger 8M Openwrt is if you are really tight on flash rom.&nbsp; The precompiled squashfs uses less rom space than jffs.&nbsp; Otherwise, you can use 4M one and just install new packages.&nbsp; I don&#039;t know if it has already been discussed.&nbsp; You don&#039;t need 8M uboot either.&nbsp; You can first flash the 4M image to the 4M uboot and then do an upgrade to an 8M factory image.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p197316">
				<div class="post-metadata">
					<div class="post-num">Post #80</div>
					<div class="post-author">openmakersdaily</div>
					<div class="post-datetime">
						5 Apr 2013, 09:21					</div>
				</div>
				<div class="post-content content">
					<p>hello, thanks pepe for the proposal but no, the goal is educative, I want to learn how to compile uboot from the darn official sources, and I don&#039;t need some http server code built in uboot. I know how to use tftp.</p><p>I have a 8MB flash, so it has to be initialized with a 8MB uboot, or I won&#039;t be able to update the firmware from uboot the very day I&#039;ll need to do that.</p><p>I followed instructions from here, which is using ap99, and I don&#039;t get why my uboot is bigger than 64k.<br /><a href="https://forum.openwrt.org/viewtopic.php?id=32512">https://forum.openwrt.org/viewtopic.php?id=32512</a><br />are these instructions wrong? The guy seemed to have some success with that.<br />I used the toolchain from the downloaded tplink package.</p><p>what is ap99? what is ap121? I downloaded these sources from tplink website, they are from device TL-MR3420 V1, which is not even a WR-703 nor an ap99.</p><p>is this AP121 configuration available in the sources where I downloaded the ap99 code?<br />I don&#039;t want to play around with random uboot images, because messing that means that I&#039;ll have to desolder the flash again.</p><p>All of this is NOT clear, at least for a beginner <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> The public information I found is not consistent, I had to gather everything around to get something working.</p><p>I am also not happy that my router&#039;s 8MB flash was so strangely done that:</p><p>[&nbsp; &nbsp; 0.490000] m25p80 spi0.0: found mx25l6405d, expected m25p80<br />[&nbsp; &nbsp; 0.500000] m25p80 spi0.0: mx25l6405d (8192 Kbytes)<br />[&nbsp; &nbsp; 0.500000] 5 tp-link partitions found on MTD device spi0.0<br />[&nbsp; &nbsp; 0.510000] Creating 5 MTD partitions on &quot;spi0.0&quot;:<br />[&nbsp; &nbsp; 0.510000] 0x000000000000-0x000000020000 : &quot;u-boot&quot;<br />[&nbsp; &nbsp; 0.520000] 0x000000020000-0x00000011f428 : &quot;kernel&quot;<br />[&nbsp; &nbsp; 0.520000] mtd: partition &quot;kernel&quot; must either start or end on erase block boundary or be smaller than an erase block -- forcing read-only<br />[&nbsp; &nbsp; 0.540000] 0x00000011f428-0x0000007f0000 : &quot;rootfs&quot;<br />[&nbsp; &nbsp; 0.540000] mtd: partition &quot;rootfs&quot; must either start or end on erase block boundary or be smaller than an erase block -- forcing read-only<br />[&nbsp; &nbsp; 0.550000] mtd: partition &quot;rootfs&quot; set to be root filesystem<br />[&nbsp; &nbsp; 0.560000] mtd: partition &quot;rootfs_data&quot; created automatically, ofs=2B0000, len=540000<br />[&nbsp; &nbsp; 0.570000] 0x0000002b0000-0x0000007f0000 : &quot;rootfs_data&quot;<br />[&nbsp; &nbsp; 0.570000] 0x0000007f0000-0x000000800000 : &quot;art&quot;<br />[&nbsp; &nbsp; 0.580000] 0x000000020000-0x0000007f0000 : &quot;firmware&quot;</p><p>so I have to change partition boundaries to something normal, which, I believe, sysupgrade will not be able to do. At least it didn&#039;t when I upgraded the original firmware to the one available in download.openwrt.org.</p><p>I&#039;m also not ok with official openwrt images for this device, because I don&#039;t care about the router feature, all I want is an embedded linux box. I was not able to find native gcc packages for this device, so I also want to build my personnalized openwrt image.<br />I have big programs on an external usb stick via opkg, with an ext3 partition and swap space.</p><p>Any idea?</p>											<p class="post-edited">(Last edited by <strong>openmakersdaily</strong> on 5 Apr 2013, 09:24)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p197330">
				<div class="post-metadata">
					<div class="post-num">Post #81</div>
					<div class="post-author">pepe2k</div>
					<div class="post-datetime">
						5 Apr 2013, 12:12					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>openmakersdaily wrote:</cite><blockquote><p>I have a 8MB flash, so it has to be initialized with a 8MB uboot, or I won&#039;t be able to update the firmware from uboot the very day I&#039;ll need to do that.</p></blockquote></div><p>The 4 MiB U-Boot version won&#039;t allow you to do any operation on flash above 4 MiB. But official factory images won&#039;t be bigger than 4 MiB - 192 KiB (64 KiB U-Boot, 64 KiB with MAC and model number, 64 KiB with ART) because the original flash chip in 703N is 4 MiB.</p><div class="quotebox"><cite>openmakersdaily wrote:</cite><blockquote><p>I followed instructions from here, which is using ap99, and I don&#039;t get why my uboot is bigger than 64k.<br /><a href="https://forum.openwrt.org/viewtopic.php?id=32512">https://forum.openwrt.org/viewtopic.php?id=32512</a><br />are these instructions wrong? The guy seemed to have some success with that.<br />I used the toolchain from the downloaded tplink package.</p><p>what is ap99? what is ap121? I downloaded these sources from tplink website, they are from device TL-MR3420 V1, which is not even a WR-703 nor an ap99.</p><p>is this AP121 configuration available in the sources where I downloaded the ap99 code?</p></blockquote></div><p>You should start with this package: <a href="http://www.tp-link.com/resources/gpl/150Router.rar">http://www.tp-link.com/resources/gpl/150Router.rar</a> (you can find it here: <a href="http://www.tp-link.com/en/support/gpl/?categoryid=547">http://www.tp-link.com/en/support/gpl/?categoryid=547</a>). It contains sources for &quot;3G routers&quot; from TP-Link, including TL-WR703N/TL-MR3020/TL-MR3040/TL-MR11U...</p><p>AP121 is the name of board type in U-Boot sources. It&#039;s the same hardware like ALFA Hornet-UB (<a href="http://wikidevi.com/wiki/ALFA_Network_Hornet-UB">http://wikidevi.com/wiki/ALFA_Network_Hornet-UB</a>). AP99 is another board, with different hardware. I told that compiled U-Boot version for AP121 is up to 64 KiB, I don&#039;t know how big could/should be the version for AP99.</p><div class="quotebox"><cite>openmakersdaily wrote:</cite><blockquote><p>I don&#039;t want to play around with random uboot images, because messing that means that I&#039;ll have to desolder the flash again.</p></blockquote></div><p>Without external programmer and SOP/SOIC adapter don&#039;t even try to compile your own version of U-Boot. During my work at U-Boot I was using 703N with desoldered flash chip (I bought SOIC adapter couple of days after this picture):</p><p><span class="postimg"><img src="http://www.tech-blog.pl/wordpress/wp-content/uploads/2012/04/wr703n_flash_change.jpg" alt="http://www.tech-blog.pl/wordpress/wp-content/uploads/2012/04/wr703n_flash_change.jpg" /></span></p><div class="quotebox"><cite>openmakersdaily wrote:</cite><blockquote><p>I am also not happy that my router&#039;s 8MB flash was so strangely done that:</p><p>[...]</p></blockquote></div><p>And what is wrong here?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p201340">
				<div class="post-metadata">
					<div class="post-num">Post #82</div>
					<div class="post-author">gentong</div>
					<div class="post-datetime">
						10 May 2013, 10:12					</div>
				</div>
				<div class="post-content content">
					<p>hi.. just modified tplinkfw.c from backfire source code, so my 1043ND can work with 16MB flash.<br />and compiled again, but why i cannot see the firmware bin file on /openwrt/backfire/bin/ar71xx folder ? i found this error when executing make:</p><p>make[3]: [/home/hendry/openwrt/backfire/bin/ar71xx/OpenWrt-ImageBuilder-ar71xx-for-Linux-i686.tar.bz2] Error 1 (ignored)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p204500">
				<div class="post-metadata">
					<div class="post-num">Post #83</div>
					<div class="post-author">fjorger</div>
					<div class="post-datetime">
						13 Jun 2013, 13:13					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>pupie wrote:</cite><blockquote><p>Hi everyone,</p><p>I have done 16M Flash and 64M RAM hardware modification for TP-LINK TL-MR3420 and compiled a version openwrt for it. Everything works good as of now..</p><p>Original Hardware:<br />ar7241+ar9287 / 4M flash&nbsp; /32M RAM /USB2.0. What we need to do is replcing its flash/memory chip and flash openwrt to unleash its potential.</p><br /><p>Part one: find a proper chip:<br />1. You need to check the flash chip data sheet, it shall be 64k size per sector since this is defined in uboot. <br />Working Serial Flash chip:<br />8M: MX25L6405<br />16M: MX25L12805, S25FL128PIF</p><p>Memroy:<br />66 Pin,16bit DDR400 64M chip, you may desolder one from your old memory bar such as Hynix HY5DU121622DTP-D43 got find a suitable chip.</p><br /><p>Part two: Compile uboot to support 8M/16M serial flash chip:<br />1. Download source code from tp-link gpl site: <a href="http://www.tp-link.com/support/todownload.asp?url=%2FGPL%2Fmr3420%5F3220v1%2Etar%2Egz">http://www.tp-link.com/support/todownlo … 2Etar%2Egz</a><br />2. Extract the package, goto mr3420_3220v1/ap99/boot/u-boot/include/configs/ap99.h to modify the source code as following, be ware that&nbsp; #define FLASH_SIZE 16 is the definition for your flash size, change it to 8 if you use a 8M chip.</p><br /><div class="codebox"><pre><code>/*
 * This file contains the configuration parameters for the pb93 board.</code></pre></div><p>3. Got build directory:<br />mv Makefile Makefile.bak<br />mv Makefile.ap99 Makefile<br />mkdir /home/YourUserName/images/ap99<br />make BOARD_TYPE=ap99 uboot</p><p>then you will have a u-boot.bin in /home/YouUserName/images/ap99.</p><p>4. Since the u-boot.bin shall be 128k in length. Use WinHEX or other hexadecimal editor to create a empty project, in my instance I user Winhex, use replace function to fill all bytes with FF and paste the u-boot.bin(Ctrl+A select all, Ctrl+B to write from 0x000000) to the template from the begining so that you got a 128k u-boot with FF appended.</p><p>5. Check the back of you router box, write down your MAC and PIN, write the mac and pin to your uboot.bin:<br />MAC 6 bytes from 0x1FC00 <br />PIN 8 bytes from 0x1FE00</p><p>Now the u-boot is ready and save it for furture usage.</p></blockquote></div><br /><p>Hi pupie,</p><p>First let me thank you for the great tutorial <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>Just one small doubt about the MAC and PIN injection into the &quot;uboot.bin&quot; file;</p><p>Do we need to calculate some kind of CRC Check SUM? Or it isn&#039;t needed at all?</p><p>Thanks in advance,</p><p>Best Regards,</p><p>fjorger.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p207665">
				<div class="post-metadata">
					<div class="post-num">Post #84</div>
					<div class="post-author">FullOpen</div>
					<div class="post-datetime">
						21 Jul 2013, 09:56					</div>
				</div>
				<div class="post-content content">
					<p>anyone met this problem: cpu/mips/start.o: In function `reset&#039;:(.text+0x4b4): undefined reference to `_GLOBAL_OFFSET_TABLE_&#039;<br />when compile tp-link&#039;s 150router ap121 uboot for 8M flash?<br />&nbsp; &nbsp; &nbsp; &nbsp;Why make cannot find `_GLOBAL_OFFSET_TABLE_&#039; when last step:linking? below is my command:<br />1. export FLASH_SIZE=8<br />2. make ap121_config<br />3. make or make all<br />&nbsp; &nbsp; &nbsp; then compiling is OK,but when linking ,error produced .<br />&nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp;Any suggestion or solution to solve this problem is appreciated,thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p211638">
				<div class="post-metadata">
					<div class="post-num">Post #85</div>
					<div class="post-author">eeff11</div>
					<div class="post-datetime">
						5 Sep 2013, 13:15					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>fjorger wrote:</cite><blockquote><div class="quotebox"><cite>pupie wrote:</cite><blockquote><p>Hi everyone,</p><p>I have done 16M Flash and 64M RAM hardware modification for TP-LINK TL-MR3420 and compiled a version openwrt for it. Everything works good as of now..</p><p>Original Hardware:<br />ar7241+ar9287 / 4M flash&nbsp; /32M RAM /USB2.0. What we need to do is replcing its flash/memory chip and flash openwrt to unleash its potential.</p><br /><p>Part one: find a proper chip:<br />1. You need to check the flash chip data sheet, it shall be 64k size per sector since this is defined in uboot. <br />Working Serial Flash chip:<br />8M: MX25L6405<br />16M: MX25L12805, S25FL128PIF</p><p>Memroy:<br />66 Pin,16bit DDR400 64M chip, you may desolder one from your old memory bar such as Hynix HY5DU121622DTP-D43 got find a suitable chip.</p><br /><p>Part two: Compile uboot to support 8M/16M serial flash chip:<br />1. Download source code from tp-link gpl site: <a href="http://www.tp-link.com/support/todownload.asp?url=%2FGPL%2Fmr3420%5F3220v1%2Etar%2Egz">http://www.tp-link.com/support/todownlo … 2Etar%2Egz</a><br />2. Extract the package, goto mr3420_3220v1/ap99/boot/u-boot/include/configs/ap99.h to modify the source code as following, be ware that&nbsp; #define FLASH_SIZE 16 is the definition for your flash size, change it to 8 if you use a 8M chip.</p><br /><div class="codebox"><pre><code>/*
 * This file contains the configuration parameters for the pb93 board.</code></pre></div><p>3. Got build directory:<br />mv Makefile Makefile.bak<br />mv Makefile.ap99 Makefile<br />mkdir /home/YourUserName/images/ap99<br />make BOARD_TYPE=ap99 uboot</p><p>then you will have a u-boot.bin in /home/YouUserName/images/ap99.</p><p>4. Since the u-boot.bin shall be 128k in length. Use WinHEX or other hexadecimal editor to create a empty project, in my instance I user Winhex, use replace function to fill all bytes with FF and paste the u-boot.bin(Ctrl+A select all, Ctrl+B to write from 0x000000) to the template from the begining so that you got a 128k u-boot with FF appended.</p><p>5. Check the back of you router box, write down your MAC and PIN, write the mac and pin to your uboot.bin:<br />MAC 6 bytes from 0x1FC00 <br />PIN 8 bytes from 0x1FE00</p><p>Now the u-boot is ready and save it for furture usage.</p></blockquote></div><br /><p>Hi pupie,</p><p>First let me thank you for the great tutorial <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>Just one small doubt about the MAC and PIN injection into the &quot;uboot.bin&quot; file;</p><p>Do we need to calculate some kind of CRC Check SUM? Or it isn&#039;t needed at all?</p><p>Thanks in advance,</p><p>Best Regards,</p><p>fjorger.</p></blockquote></div><p>important question. Shall change MAC and pin using hex?<br />Maybe CRC check sum is a must.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p211968">
				<div class="post-metadata">
					<div class="post-num">Post #86</div>
					<div class="post-author">saturn-b</div>
					<div class="post-datetime">
						9 Sep 2013, 20:38					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>eeff11 wrote:</cite><blockquote><p>important question. Shall change MAC and pin using hex?<br />Maybe CRC check sum is a must.</p></blockquote></div><p>Just edit PIN and MAC with hex editor</p><p>There is no need to do CRC check sum.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p212160">
				<div class="post-metadata">
					<div class="post-num">Post #87</div>
					<div class="post-author">HondaRulez</div>
					<div class="post-datetime">
						12 Sep 2013, 11:27					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>FullOpen wrote:</cite><blockquote><p>anyone met this problem: cpu/mips/start.o: In function `reset&#039;:(.text+0x4b4): undefined reference to `_GLOBAL_OFFSET_TABLE_&#039;<br />when compile tp-link&#039;s 150router ap121 uboot for 8M flash?<br />&nbsp; &nbsp; &nbsp; &nbsp;Why make cannot find `_GLOBAL_OFFSET_TABLE_&#039; when last step:linking? below is my command:<br />1. export FLASH_SIZE=8<br />2. make ap121_config<br />3. make or make all<br />&nbsp; &nbsp; &nbsp; then compiling is OK,but when linking ,error produced .<br />&nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp;Any suggestion or solution to solve this problem is appreciated,thanks!</p></blockquote></div><p>Hi</p><p>Any idea, or solved ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p214865">
				<div class="post-metadata">
					<div class="post-num">Post #88</div>
					<div class="post-author">alphasparc</div>
					<div class="post-datetime">
						15 Oct 2013, 18:00					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>pupie wrote:</cite><blockquote><p>2013-July-11 udpate: ATTENTION: THIS SECTION 2.2 IS OBSOLETED.&nbsp; </p><p>The trunk code has been changed after this tutorial. as discussion in below reply, new probe function can automatically detect and adjust partion size so that you don&#039;t need to do anythings. this change affects 12.09 and latest trunk.</p><p>////////////////////////////////////keep below codes only for reference, please goto&nbsp; next step.<br />target/linux/ar71xx/files/arch/mips/ar71xx/mach-tl-mr3x20.c</p></blockquote></div><p>Does this means that there is no need to modify the partition offsets anymore?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p214866">
				<div class="post-metadata">
					<div class="post-num">Post #89</div>
					<div class="post-author">pepe2k</div>
					<div class="post-datetime">
						15 Oct 2013, 18:04					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>alphasparc wrote:</cite><blockquote><div class="quotebox"><cite>pupie wrote:</cite><blockquote><p>2013-July-11 udpate: ATTENTION: THIS SECTION 2.2 IS OBSOLETED.&nbsp; </p><p>The trunk code has been changed after this tutorial. as discussion in below reply, new probe function can automatically detect and adjust partion size so that you don&#039;t need to do anythings. this change affects 12.09 and latest trunk.</p><p>////////////////////////////////////keep below codes only for reference, please goto&nbsp; next step.<br />target/linux/ar71xx/files/arch/mips/ar71xx/mach-tl-mr3x20.c</p></blockquote></div><p>Does this means that there is no need to modify the partition offsets anymore?</p></blockquote></div><p>Yes <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> All you need to do, is just to put &quot;uboot&quot; partition at the beginning and &quot;art&quot; partition at the end of FLASH. And of course, firmware image at 0x20000 offset.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p244542">
				<div class="post-metadata">
					<div class="post-num">Post #90</div>
					<div class="post-author">JohnV</div>
					<div class="post-datetime">
						21 Aug 2014, 20:37					</div>
				</div>
				<div class="post-content content">
					<p>Thank you for posting this information.</p><p>I have a board that is modelled after MR3220V1.&nbsp; The board has 8M flash installled.&nbsp; I received the board with a working version of OpenWRT installed onto it (attitude_adjustment).&nbsp; All works OK.</p><br /><p>I have now compiled a custom version of OpenWRT (barrier_breaker branch, latest).</p><p>I changed these 2 files:<br />/target/linux/ar71xx/image/Makefile<br />/tools/firmware-utils/src/mktplinkfw.c</p><p>Both to reflect an 8M image.&nbsp; The image compiles fine, and builds a 8M factory.bin, and a 3.6M sysupgrade.</p><p>I have tried to install both the factory and sysupgrade from the default firmware I received, and both cause the WiFi to no longer work. </p><p>This is the log from working firmware:<br />[&nbsp; &nbsp;13.820000] ath: EEPROM regdomain: 0x65<br />[&nbsp; &nbsp;13.820000] ath: EEPROM indicates we should expect a direct regpair map<br />[&nbsp; &nbsp;13.820000] ath: Country alpha2 being used: 00<br />[&nbsp; &nbsp;13.820000] ath: Regpair used: 0x65</p><br /><p>This is the log from non-working firmware:<br />[&nbsp; &nbsp;14.570000] PCI: Enabling device 0000:00:00.0 (0000 -&gt; 0002)<br />[&nbsp; &nbsp;14.580000] ath: phy0: Bad EEPROM checksum 0x0 or revision 0x000f<br />[&nbsp; &nbsp;14.580000] ath: phy0: Unable to initialize hardware; initialization status: -22<br />[&nbsp; &nbsp;14.590000] ath9k 0000:00:00.0: Failed to initialize device<br />[&nbsp; &nbsp;14.600000] ath9k: probe of 0000:00:00.0 failed with error -22</p><p>From what I read, it would seem there is an issue with the ART partition, however I have compared a backup from the working firmware, to what exists after a sysupgrade, and the are the same, as I would expect.</p><p>Any suggestions on what is causing this.</p><br /><p>More logs:</p><p>From working firmware:<br />[&nbsp; &nbsp; 0.770000] 0x000000000000-0x000000020000 : &quot;u-boot&quot;<br />[&nbsp; &nbsp; 0.780000] 0x000000020000-0x00000010f400 : &quot;kernel&quot;<br />[&nbsp; &nbsp; 0.780000] mtd: partition &quot;kernel&quot; must either start or end on erase block boundary or be smaller than an erase block -- forcing read-only<br />[&nbsp; &nbsp; 0.800000] 0x00000010f400-0x0000007f0000 : &quot;rootfs&quot;<br />[&nbsp; &nbsp; 0.800000] mtd: partition &quot;rootfs&quot; must either start or end on erase block boundary or be smaller than an erase block -- forcing read-only<br />[&nbsp; &nbsp; 0.820000] mtd: partition &quot;rootfs&quot; set to be root filesystem<br />[&nbsp; &nbsp; 0.820000] mtd: partition &quot;rootfs_data&quot; created automatically, ofs=450000, len=3A0000 <br />[&nbsp; &nbsp; 0.830000] 0x000000450000-0x0000007f0000 : &quot;rootfs_data&quot;<br />[&nbsp; &nbsp; 0.840000] 0x0000007f0000-0x000000800000 : &quot;art&quot;<br />[&nbsp; &nbsp; 0.840000] 0x000000020000-0x0000007f0000 : &quot;firmware&quot;</p><br /><p>From non-working:<br />[&nbsp; &nbsp; 0.780000] 0x000000000000-0x000000020000 : &quot;u-boot&quot;<br />[&nbsp; &nbsp; 0.790000] 0x000000020000-0x000000133e00 : &quot;kernel&quot;<br />[&nbsp; &nbsp; 0.790000] mtd: partition &quot;kernel&quot; must either start or end on erase block boundary or be smaller than an erase block -- forcing read-only<br />[&nbsp; &nbsp; 0.810000] 0x000000133e00-0x0000007f0000 : &quot;rootfs&quot;<br />[&nbsp; &nbsp; 0.810000] mtd: partition &quot;rootfs&quot; must either start or end on erase block boundary or be smaller than an erase block -- forcing read-only<br />[&nbsp; &nbsp; 0.830000] mtd: device 2 (rootfs) set to be root filesystem<br />[&nbsp; &nbsp; 0.830000] 1 squashfs-split partitions found on MTD device rootfs<br />[&nbsp; &nbsp; 0.840000] 0x000000390000-0x0000007f0000 : &quot;rootfs_data&quot;<br />[&nbsp; &nbsp; 0.850000] 0x0000007f0000-0x000000800000 : &quot;art&quot;<br />[&nbsp; &nbsp; 0.850000] 0x000000020000-0x0000007f0000 : &quot;firmware&quot;</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p244569">
				<div class="post-metadata">
					<div class="post-num">Post #91</div>
					<div class="post-author">JohnV</div>
					<div class="post-datetime">
						22 Aug 2014, 04:19					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for the help.</p><p>In what location should I check the MAC address?&nbsp; In the firmware image or in a config in OpenWRT?</p><p>I assumed since an image was already present, upgrading with a sysupgrade would not break anything, but it seems to have.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p244679">
				<div class="post-metadata">
					<div class="post-num">Post #92</div>
					<div class="post-author">JohnV</div>
					<div class="post-datetime">
						23 Aug 2014, 20:16					</div>
				</div>
				<div class="post-content content">
					<p>There is no MAC set in either of the configs.</p><p>Here is the config from the working firmware (AA):</p><p>config wifi-device&nbsp; radio0<br />&nbsp; &nbsp; option type&nbsp; &nbsp; &nbsp;mac80211<br />&nbsp; &nbsp; option channel&nbsp; 11<br />&nbsp; &nbsp; option hwmode&nbsp; &nbsp; 11ng<br />&nbsp; &nbsp; option path&nbsp; &nbsp; &#039;pci0000:00/0000:00:00.0&#039;<br />&nbsp; &nbsp; option htmode&nbsp; &nbsp; HT20<br />&nbsp; &nbsp; list ht_capab&nbsp; &nbsp; SHORT-GI-40<br />&nbsp; &nbsp; list ht_capab&nbsp; &nbsp; TX-STBC<br />&nbsp; &nbsp; list ht_capab&nbsp; &nbsp; RX-STBC1<br />&nbsp; &nbsp; list ht_capab&nbsp; &nbsp; DSSS_CCK-40<br />&nbsp; &nbsp; # REMOVE THIS LINE TO ENABLE WIFI:<br />&nbsp; &nbsp; #option disabled 1</p><p>config wifi-iface<br />&nbsp; &nbsp; option device&nbsp; &nbsp;radio0<br />&nbsp; &nbsp; option network&nbsp; lan<br />&nbsp; &nbsp; option mode&nbsp; &nbsp; &nbsp;ap<br />&nbsp; &nbsp; option ssid&nbsp; &nbsp; &nbsp;Cell_Wireless<br />&nbsp; &nbsp; option encryption none</p><br /><p>Here is the config from the non-working firmware (BB)</p><br /><p>config wifi-device &#039;radio0&#039;<br />&nbsp; &nbsp; option type &#039;mac80211&#039;<br />&nbsp; &nbsp; option channel &#039;11&#039;<br />&nbsp; &nbsp; option hwmode &#039;11ng&#039;<br />&nbsp; &nbsp; option path &#039;pci0000:00/0000:00:00.0&#039;<br />&nbsp; &nbsp; list ht_capab &#039;SHORT-GI-40&#039;<br />&nbsp; &nbsp; list ht_capab &#039;TX-STBC&#039;<br />&nbsp; &nbsp; list ht_capab &#039;RX-STBC1&#039;<br />&nbsp; &nbsp; list ht_capab &#039;DSSS_CCK-40&#039;<br />&nbsp; &nbsp; option txpower &#039;16&#039;<br />&nbsp; &nbsp; option distance &#039;400&#039;<br />&nbsp; &nbsp; option htmode &#039;HT20&#039;<br />&nbsp; &nbsp; option country &#039;US&#039;</p><p>config wifi-iface<br />&nbsp; &nbsp; option device &#039;radio0&#039;<br />&nbsp; &nbsp; option network &#039;lan&#039;<br />&nbsp; &nbsp; option mode &#039;ap&#039;<br />&nbsp; &nbsp; option ssid &#039;Wireless<br />&nbsp; &nbsp; option encryption &#039;psk2+ccmp&#039;<br />&nbsp; &nbsp; option key &#039;Wireless&#039;</p><br /><p>I will try to flash the ART parition back from the working version.&nbsp; I have no problem re-flashing the working firmware, this always results in WiFi working again, so this implies to me that the ART partition is OK in general....</p><p>Could is be something with BB causing this issue?&nbsp; Unlikely though.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p244865">
				<div class="post-metadata">
					<div class="post-num">Post #93</div>
					<div class="post-author">JohnV</div>
					<div class="post-datetime">
						25 Aug 2014, 20:20					</div>
				</div>
				<div class="post-content content">
					<p>I only see the MAC in Luci from the working firmware:&nbsp; &nbsp;90:4C:E5:49:C9:8B.</p><p>The non-working firmware does not show it.</p><p>Here is kernel log from working firmware:</p><p>[&nbsp; &nbsp; 0.000000] Linux version 3.3.8 (david@ubunt) (gcc version 4.6.3 20120201 (prerelease) (Linaro GCC 4.6-2012.02) ) #5 Wed Jul 23 21:35:29 CST 2014<br />[&nbsp; &nbsp; 0.000000] MyLoader: sysp=82408001, boardp=21453249, parts=a06c2a17<br />[&nbsp; &nbsp; 0.000000] bootconsole [early0] enabled<br />[&nbsp; &nbsp; 0.000000] CPU revision is: 00019374 (MIPS 24Kc)<br />[&nbsp; &nbsp; 0.000000] SoC: Atheros AR7241 rev 1<br />[&nbsp; &nbsp; 0.000000] Clocks: CPU:400.000MHz, DDR:400.000MHz, AHB:200.000MHz, Ref:5.000MHz<br />[&nbsp; &nbsp; 0.000000] Determined physical RAM map:<br />[&nbsp; &nbsp; 0.000000]&nbsp; memory: 04000000 @ 00000000 (usable)<br />[&nbsp; &nbsp; 0.000000] Initrd not found or empty - disabling initrd<br />[&nbsp; &nbsp; 0.000000] Zone PFN ranges:<br />[&nbsp; &nbsp; 0.000000]&nbsp; &nbsp;Normal&nbsp; &nbsp;0x00000000 -&gt; 0x00004000<br />[&nbsp; &nbsp; 0.000000] Movable zone start PFN for each node<br />[&nbsp; &nbsp; 0.000000] Early memory PFN ranges<br />[&nbsp; &nbsp; 0.000000]&nbsp; &nbsp; &nbsp;0: 0x00000000 -&gt; 0x00004000<br />[&nbsp; &nbsp; 0.000000] On node 0 totalpages: 16384<br />[&nbsp; &nbsp; 0.000000] free_area_init_node: node 0, pgdat 802f6a60, node_mem_map 81000000<br />[&nbsp; &nbsp; 0.000000]&nbsp; &nbsp;Normal zone: 128 pages used for memmap<br />[&nbsp; &nbsp; 0.000000]&nbsp; &nbsp;Normal zone: 0 pages reserved<br />[&nbsp; &nbsp; 0.000000]&nbsp; &nbsp;Normal zone: 16256 pages, LIFO batch:3<br />[&nbsp; &nbsp; 0.000000] pcpu-alloc: s0 r0 d32768 u32768 alloc=1*32768<br />[&nbsp; &nbsp; 0.000000] pcpu-alloc: [0] 0 <br />[&nbsp; &nbsp; 0.000000] Built 1 zonelists in Zone order, mobility grouping on.&nbsp; Total pages: 16256<br />[&nbsp; &nbsp; 0.000000] Kernel command line:&nbsp; board=TL-MR3220 console=ttyS0,115200 rootfstype=squashfs,jffs2 noinitrd<br />[&nbsp; &nbsp; 0.000000] PID hash table entries: 256 (order: -2, 1024 bytes)<br />[&nbsp; &nbsp; 0.000000] Dentry cache hash table entries: 8192 (order: 3, 32768 bytes)<br />[&nbsp; &nbsp; 0.000000] Inode-cache hash table entries: 4096 (order: 2, 16384 bytes)<br />[&nbsp; &nbsp; 0.000000] Primary instruction cache 64kB, VIPT, 4-way, linesize 32 bytes.<br />[&nbsp; &nbsp; 0.000000] Primary data cache 32kB, 4-way, VIPT, cache aliases, linesize 32 bytes<br />[&nbsp; &nbsp; 0.000000] Writing ErrCtl register=00000000<br />[&nbsp; &nbsp; 0.000000] Readback ErrCtl register=00000000<br />[&nbsp; &nbsp; 0.000000] Memory: 61464k/65536k available (2222k kernel code, 4072k reserved, 430k data, 212k init, 0k highmem)<br />[&nbsp; &nbsp; 0.000000] SLUB: Genslabs=9, HWalign=32, Order=0-3, MinObjects=0, CPUs=1, Nodes=1<br />[&nbsp; &nbsp; 0.000000] NR_IRQS:51<br />[&nbsp; &nbsp; 0.000000] Calibrating delay loop... 265.42 BogoMIPS (lpj=1327104)<br />[&nbsp; &nbsp; 0.080000] pid_max: default: 32768 minimum: 301<br />[&nbsp; &nbsp; 0.080000] Mount-cache hash table entries: 512<br />[&nbsp; &nbsp; 0.090000] NET: Registered protocol family 16<br />[&nbsp; &nbsp; 0.090000] gpiochip_add: registered GPIOs 0 to 17 on device: ath79<br />[&nbsp; &nbsp; 0.100000] MIPS: machine is CELL_ROUTER-V2<br />[&nbsp; &nbsp; 0.530000] registering PCI controller with io_map_base unset<br />[&nbsp; &nbsp; 0.550000] bio: create slab &lt;bio-0&gt; at 0<br />[&nbsp; &nbsp; 0.550000] usbcore: registered new interface driver usbfs<br />[&nbsp; &nbsp; 0.560000] usbcore: registered new interface driver hub<br />[&nbsp; &nbsp; 0.560000] usbcore: registered new device driver usb<br />[&nbsp; &nbsp; 0.570000] PCI host bridge to bus 0000:00<br />[&nbsp; &nbsp; 0.570000] pci_bus 0000:00: root bus resource [mem 0x10000000-0x13ffffff]<br />[&nbsp; &nbsp; 0.580000] pci_bus 0000:00: root bus resource [io&nbsp; 0x0000]<br />[&nbsp; &nbsp; 0.580000] pci 0000:00:00.0: [168c:002a] type 0 class 0x000280<br />[&nbsp; &nbsp; 0.580000] pci 0000:00:00.0: reg 10: [mem 0x10000000-0x1000ffff 64bit]<br />[&nbsp; &nbsp; 0.580000] pci 0000:00:00.0: supports D1<br />[&nbsp; &nbsp; 0.580000] pci 0000:00:00.0: PME# supported from D0 D1 D3hot<br />[&nbsp; &nbsp; 0.580000] pci 0000:00:00.0: BAR 0: assigned [mem 0x10000000-0x1000ffff 64bit]<br />[&nbsp; &nbsp; 0.590000] pci 0000:00:00.0: using irq 40 for pin 1<br />[&nbsp; &nbsp; 0.590000] Switching to clocksource MIPS<br />[&nbsp; &nbsp; 0.600000] NET: Registered protocol family 2<br />[&nbsp; &nbsp; 0.600000] IP route cache hash table entries: 1024 (order: 0, 4096 bytes)<br />[&nbsp; &nbsp; 0.610000] TCP established hash table entries: 2048 (order: 2, 16384 bytes)<br />[&nbsp; &nbsp; 0.620000] TCP bind hash table entries: 2048 (order: 1, 8192 bytes)<br />[&nbsp; &nbsp; 0.620000] TCP: Hash tables configured (established 2048 bind 2048)<br />[&nbsp; &nbsp; 0.630000] TCP reno registered<br />[&nbsp; &nbsp; 0.630000] UDP hash table entries: 256 (order: 0, 4096 bytes)<br />[&nbsp; &nbsp; 0.640000] UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)<br />[&nbsp; &nbsp; 0.650000] NET: Registered protocol family 1<br />[&nbsp; &nbsp; 0.650000] PCI: CLS 0 bytes, default 32<br />[&nbsp; &nbsp; 0.670000] squashfs: version 4.0 (2009/01/31) Phillip Lougher<br />[&nbsp; &nbsp; 0.670000] JFFS2 version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006 Red Hat, Inc.<br />[&nbsp; &nbsp; 0.690000] msgmni has been set to 120<br />[&nbsp; &nbsp; 0.690000] io scheduler noop registered<br />[&nbsp; &nbsp; 0.690000] io scheduler deadline registered (default)<br />[&nbsp; &nbsp; 0.700000] Serial: 8250/16550 driver, 1 ports, IRQ sharing disabled<br />[&nbsp; &nbsp; 0.730000] serial8250.0: ttyS0 at MMIO 0x18020000 (irq = 11) is a 16550A<br />[&nbsp; &nbsp; 0.730000] console [ttyS0] enabled, bootconsole disabled<br />[&nbsp; &nbsp; 0.750000] m25p80 spi0.0: found s25sl064a, expected m25p80<br />[&nbsp; &nbsp; 0.750000] m25p80 spi0.0: s25sl064a (8192 Kbytes)<br />[&nbsp; &nbsp; 0.760000] 5 tp-link partitions found on MTD device spi0.0<br />[&nbsp; &nbsp; 0.760000] Creating 5 MTD partitions on &quot;spi0.0&quot;:<br />[&nbsp; &nbsp; 0.770000] 0x000000000000-0x000000020000 : &quot;u-boot&quot;<br />[&nbsp; &nbsp; 0.780000] 0x000000020000-0x00000010f400 : &quot;kernel&quot;<br />[&nbsp; &nbsp; 0.780000] mtd: partition &quot;kernel&quot; must either start or end on erase block boundary or be smaller than an erase block -- forcing read-only<br />[&nbsp; &nbsp; 0.800000] 0x00000010f400-0x0000007f0000 : &quot;rootfs&quot;<br />[&nbsp; &nbsp; 0.800000] mtd: partition &quot;rootfs&quot; must either start or end on erase block boundary or be smaller than an erase block -- forcing read-only<br />[&nbsp; &nbsp; 0.820000] mtd: partition &quot;rootfs&quot; set to be root filesystem<br />[&nbsp; &nbsp; 0.820000] mtd: partition &quot;rootfs_data&quot; created automatically, ofs=450000, len=3A0000 <br />[&nbsp; &nbsp; 0.830000] 0x000000450000-0x0000007f0000 : &quot;rootfs_data&quot;<br />[&nbsp; &nbsp; 0.840000] 0x0000007f0000-0x000000800000 : &quot;art&quot;<br />[&nbsp; &nbsp; 0.840000] 0x000000020000-0x0000007f0000 : &quot;firmware&quot;<br />[&nbsp; &nbsp; 0.870000] ag71xx_mdio: probed<br />[&nbsp; &nbsp; 0.870000] eth0: Atheros AG71xx at 0xba000000, irq 5<br />[&nbsp; &nbsp; 1.430000] eth0: Found an AR7240/AR9330 built-in switch<br />[&nbsp; &nbsp; 2.460000] eth1: Atheros AG71xx at 0xb9000000, irq 4<br />[&nbsp; &nbsp; 3.010000] ag71xx ag71xx.0: eth1: connected to PHY at ag71xx-mdio.1:04 [uid=004dd041, driver=Generic PHY]<br />[&nbsp; &nbsp; 3.020000] ohci_hcd: USB 1.1 &#039;Open&#039; Host Controller (OHCI) Driver<br />[&nbsp; &nbsp; 3.030000] TCP cubic registered<br />[&nbsp; &nbsp; 3.030000] NET: Registered protocol family 17<br />[&nbsp; &nbsp; 3.040000] 8021q: 802.1Q VLAN Support v1.8<br />[&nbsp; &nbsp; 3.050000] VFS: Mounted root (squashfs filesystem) readonly on device 31:2.<br />[&nbsp; &nbsp; 3.060000] Freeing unused kernel memory: 212k freed<br />[&nbsp; &nbsp; 6.380000] Registered led device: tp-link:green:system<br />[&nbsp; &nbsp; 6.380000] Registered led device: tp-link:green:qss<br />[&nbsp; &nbsp; 6.380000] Registered led device: tp-link:green:3g<br />[&nbsp; &nbsp; 7.350000] eth0: link up (1000Mbps/Full duplex)<br />[&nbsp; &nbsp; 9.690000] JFFS2 notice: (425) jffs2_build_xattr_subsystem: complete building xattr subsystem, 1 of xdatum (0 unchecked, 0 orphan) and 13 of xref (0 dead, 0 orphan) found.<br />[&nbsp; &nbsp; 9.810000] eth0: link down<br />[&nbsp; &nbsp;12.150000] Loading modules backported from Linux version master-2014-05-22-0-gf2032ea<br />[&nbsp; &nbsp;12.160000] Backport generated by backports.git backports-20140320-37-g5c33da0<br />[&nbsp; &nbsp;12.340000] cfg80211: Calling CRDA to update world regulatory domain<br />[&nbsp; &nbsp;12.340000] cfg80211: World regulatory domain updated:<br />[&nbsp; &nbsp;12.350000] cfg80211:&nbsp; DFS Master region: unset<br />[&nbsp; &nbsp;12.350000] cfg80211:&nbsp; &nbsp;(start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp), (dfs_cac_time)<br />[&nbsp; &nbsp;12.360000] cfg80211:&nbsp; &nbsp;(2402000 KHz - 2472000 KHz @ 40000 KHz), (N/A, 2000 mBm), (N/A)<br />[&nbsp; &nbsp;12.370000] cfg80211:&nbsp; &nbsp;(2457000 KHz - 2482000 KHz @ 40000 KHz), (N/A, 2000 mBm), (N/A)<br />[&nbsp; &nbsp;12.380000] cfg80211:&nbsp; &nbsp;(2474000 KHz - 2494000 KHz @ 20000 KHz), (N/A, 2000 mBm), (N/A)<br />[&nbsp; &nbsp;12.390000] cfg80211:&nbsp; &nbsp;(5170000 KHz - 5250000 KHz @ 80000 KHz), (N/A, 2000 mBm), (N/A)<br />[&nbsp; &nbsp;12.390000] cfg80211:&nbsp; &nbsp;(5735000 KHz - 5835000 KHz @ 80000 KHz), (N/A, 2000 mBm), (N/A)<br />[&nbsp; &nbsp;12.400000] cfg80211:&nbsp; &nbsp;(57240000 KHz - 63720000 KHz @ 2160000 KHz), (N/A, 0 mBm), (N/A)<br />[&nbsp; &nbsp;12.750000] SCSI subsystem initialized<br />[&nbsp; &nbsp;13.840000] ath: EEPROM regdomain: 0x65<br />[&nbsp; &nbsp;13.840000] ath: EEPROM indicates we should expect a direct regpair map<br />[&nbsp; &nbsp;13.840000] ath: Country alpha2 being used: 00<br />[&nbsp; &nbsp;13.840000] ath: Regpair used: 0x65<br />[&nbsp; &nbsp;13.860000] ieee80211 phy0: Selected rate control algorithm &#039;minstrel_ht&#039;<br />[&nbsp; &nbsp;13.860000] Registered led device: ath9k-phy0<br />[&nbsp; &nbsp;13.860000] ieee80211 phy0: Atheros AR9280 Rev:2 mem=0xb0000000, irq=40<br />[&nbsp; &nbsp;13.880000] button_hotplug: Unknown symbol input_register_handle (err 0)<br />[&nbsp; &nbsp;13.890000] button_hotplug: Unknown symbol input_open_device (err 0)<br />[&nbsp; &nbsp;13.900000] button_hotplug: Unknown symbol input_close_device (err 0)<br />[&nbsp; &nbsp;13.900000] button_hotplug: Unknown symbol input_unregister_handler (err 0)<br />[&nbsp; &nbsp;13.910000] button_hotplug: Unknown symbol input_register_handler (err 0)<br />[&nbsp; &nbsp;13.920000] button_hotplug: Unknown symbol input_unregister_handle (err 0)<br />[&nbsp; &nbsp;14.050000] PPP generic driver version 2.4.2<br />[&nbsp; &nbsp;14.160000] tun: Universal TUN/TAP device driver, 1.6<br />[&nbsp; &nbsp;14.160000] tun: (C) 1999-2004 Max Krasnyansky &lt;maxk@qualcomm.com&gt;<br />[&nbsp; &nbsp;14.280000] PPP MPPE Compression module registered<br />[&nbsp; &nbsp;14.300000] L2TP core driver, V2.0<br />[&nbsp; &nbsp;14.310000] L2TP netlink interface<br />[&nbsp; &nbsp;14.440000] GRE over IPv4 demultiplexor driver<br />[&nbsp; &nbsp;14.460000] GRE over IPv4 tunneling driver<br />[&nbsp; &nbsp;14.620000] ip_tables: (C) 2000-2006 Netfilter Core Team<br />[&nbsp; &nbsp;14.790000] NET: Registered protocol family 24<br />[&nbsp; &nbsp;14.910000] ehci_hcd: USB 2.0 &#039;Enhanced&#039; Host Controller (EHCI) Driver<br />[&nbsp; &nbsp;14.920000] Warning! ehci_hcd should always be loaded before uhci_hcd and ohci_hcd, not after<br />[&nbsp; &nbsp;14.930000] ehci-platform ehci-platform: Generic Platform EHCI Controller<br />[&nbsp; &nbsp;14.930000] ehci-platform ehci-platform: new USB bus registered, assigned bus number 1<br />[&nbsp; &nbsp;14.970000] ehci-platform ehci-platform: irq 3, io mem 0x1b000000<br />[&nbsp; &nbsp;14.990000] ehci-platform ehci-platform: USB 2.0 started, EHCI 1.00<br />[&nbsp; &nbsp;14.990000] hub 1-0:1.0: USB hub found<br />[&nbsp; &nbsp;15.000000] hub 1-0:1.0: 1 port detected<br />[&nbsp; &nbsp;15.110000] nf_conntrack version 0.5.0 (963 buckets, 3852 max)<br />[&nbsp; &nbsp;15.500000] usb 1-1: new high-speed USB device number 2 using ehci-platform<br />[&nbsp; &nbsp;15.600000] PPPoL2TP kernel driver, V2.0<br />[&nbsp; &nbsp;15.620000] PPTP driver version 0.8.5<br />[&nbsp; &nbsp;16.140000] xt_time: kernel timezone is -0000<br />[&nbsp; &nbsp;16.450000] uhci_hcd: USB Universal Host Controller Interface driver<br />[&nbsp; &nbsp;16.600000] usbcore: registered new interface driver cdc_acm<br />[&nbsp; &nbsp;16.610000] cdc_acm: USB Abstract Control Model driver for USB modems and ISDN adapters<br />[&nbsp; &nbsp;16.650000] usbcore: registered new interface driver usbserial<br />[&nbsp; &nbsp;16.660000] USB Serial support registered for generic<br />[&nbsp; &nbsp;16.670000] usbcore: registered new interface driver usbserial_generic<br />[&nbsp; &nbsp;16.670000] usbserial: USB Serial Driver core<br />[&nbsp; &nbsp;16.700000] Initializing USB Mass Storage driver...<br />[&nbsp; &nbsp;16.710000] usbcore: registered new interface driver usb-storage<br />[&nbsp; &nbsp;16.710000] USB Mass Storage support registered.<br />[&nbsp; &nbsp;16.740000] usbcore: registered new interface driver ums-alauda<br />[&nbsp; &nbsp;16.760000] usbcore: registered new interface driver ums-cypress<br />[&nbsp; &nbsp;16.780000] usbcore: registered new interface driver ums-datafab<br />[&nbsp; &nbsp;16.800000] usbcore: registered new interface driver ums-freecom<br />[&nbsp; &nbsp;16.820000] usbcore: registered new interface driver ums-isd200<br />[&nbsp; &nbsp;16.850000] usbcore: registered new interface driver ums-jumpshot<br />[&nbsp; &nbsp;16.870000] usbcore: registered new interface driver ums-karma<br />[&nbsp; &nbsp;16.890000] usbcore: registered new interface driver ums-sddr09<br />[&nbsp; &nbsp;16.910000] usbcore: registered new interface driver ums-sddr55<br />[&nbsp; &nbsp;16.930000] usbcore: registered new interface driver ums-usbat<br />[&nbsp; &nbsp;17.060000] usbcore: registered new interface driver cdc_ether<br />[&nbsp; &nbsp;17.270000] USB Serial support registered for GSM modem (1-port)<br />[&nbsp; &nbsp;17.270000] option 1-1:1.0: GSM modem (1-port) converter detected<br />[&nbsp; &nbsp;17.280000] usb 1-1: GSM modem (1-port) converter now attached to ttyUSB0<br />[&nbsp; &nbsp;17.290000] option 1-1:1.1: GSM modem (1-port) converter detected<br />[&nbsp; &nbsp;17.290000] usb 1-1: GSM modem (1-port) converter now attached to ttyUSB1<br />[&nbsp; &nbsp;17.300000] option 1-1:1.2: GSM modem (1-port) converter detected<br />[&nbsp; &nbsp;17.310000] usb 1-1: GSM modem (1-port) converter now attached to ttyUSB2<br />[&nbsp; &nbsp;17.310000] option 1-1:1.3: GSM modem (1-port) converter detected<br />[&nbsp; &nbsp;17.320000] usb 1-1: GSM modem (1-port) converter now attached to ttyUSB3<br />[&nbsp; &nbsp;17.330000] usbcore: registered new interface driver option<br />[&nbsp; &nbsp;17.330000] option: v0.7.2:USB Driver for GSM modems<br />[&nbsp; &nbsp;17.450000] USB Serial support registered for Qualcomm USB modem<br />[&nbsp; &nbsp;17.460000] usbcore: registered new interface driver qcserial<br />[&nbsp; &nbsp;17.560000] USB Serial support registered for Sierra USB modem<br />[&nbsp; &nbsp;17.560000] usbcore: registered new interface driver sierra<br />[&nbsp; &nbsp;17.570000] sierra: v.1.7.16:USB Driver for Sierra Wireless USB modems<br />[&nbsp; &nbsp;25.090000] device eth0 entered promiscuous mode<br />[&nbsp; &nbsp;25.730000] eth0: link up (1000Mbps/Full duplex)<br />[&nbsp; &nbsp;25.730000] br-lan: port 1(eth0) entered forwarding state<br />[&nbsp; &nbsp;25.740000] br-lan: port 1(eth0) entered forwarding state<br />[&nbsp; &nbsp;27.740000] br-lan: port 1(eth0) entered forwarding state<br />[&nbsp; &nbsp;30.660000] device wlan0 entered promiscuous mode<br />[&nbsp; &nbsp;30.810000] br-lan: port 2(wlan0) entered forwarding state<br />[&nbsp; &nbsp;30.810000] br-lan: port 2(wlan0) entered forwarding state<br />[&nbsp; &nbsp;32.810000] br-lan: port 2(wlan0) entered forwarding state</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p244867">
				<div class="post-metadata">
					<div class="post-num">Post #94</div>
					<div class="post-author">JohnV</div>
					<div class="post-datetime">
						25 Aug 2014, 20:24					</div>
				</div>
				<div class="post-content content">
					<p>Here is Kernel log from non-working firmware.&nbsp; Thank you for your help! </p><br /><p>[&nbsp; &nbsp; 0.000000] Linux version 3.10.49 (mark@mark-VirtualBox) (gcc version 4.8.3 (OpenWrt/Linaro GCC 4.8-2014.04 r371) ) #51 Sun Aug 24 16:30:01 TAHT 2014<br />[&nbsp; &nbsp; 0.000000] MyLoader: sysp=82408001, boardp=21452248, parts=a06c2a17<br />[&nbsp; &nbsp; 0.000000] bootconsole [early0] enabled<br />[&nbsp; &nbsp; 0.000000] CPU revision is: 00019374 (MIPS 24Kc)<br />[&nbsp; &nbsp; 0.000000] SoC: Atheros AR7241 rev 1<br />[&nbsp; &nbsp; 0.000000] Clocks: CPU:400.000MHz, DDR:400.000MHz, AHB:200.000MHz, Ref:5.000MHz<br />[&nbsp; &nbsp; 0.000000] Determined physical RAM map:<br />[&nbsp; &nbsp; 0.000000]&nbsp; memory: 04000000 @ 00000000 (usable)<br />[&nbsp; &nbsp; 0.000000] Initrd not found or empty - disabling initrd<br />[&nbsp; &nbsp; 0.000000] Zone ranges:<br />[&nbsp; &nbsp; 0.000000]&nbsp; &nbsp;Normal&nbsp; &nbsp;[mem 0x00000000-0x03ffffff]<br />[&nbsp; &nbsp; 0.000000] Movable zone start for each node<br />[&nbsp; &nbsp; 0.000000] Early memory node ranges<br />[&nbsp; &nbsp; 0.000000]&nbsp; &nbsp;node&nbsp; &nbsp;0: [mem 0x00000000-0x03ffffff]<br />[&nbsp; &nbsp; 0.000000] On node 0 totalpages: 16384<br />[&nbsp; &nbsp; 0.000000] free_area_init_node: node 0, pgdat 8033e9b0, node_mem_map 81000000<br />[&nbsp; &nbsp; 0.000000]&nbsp; &nbsp;Normal zone: 128 pages used for memmap<br />[&nbsp; &nbsp; 0.000000]&nbsp; &nbsp;Normal zone: 0 pages reserved<br />[&nbsp; &nbsp; 0.000000]&nbsp; &nbsp;Normal zone: 16384 pages, LIFO batch:3<br />[&nbsp; &nbsp; 0.000000] Primary instruction cache 64kB, VIPT, 4-way, linesize 32 bytes.<br />[&nbsp; &nbsp; 0.000000] Primary data cache 32kB, 4-way, VIPT, cache aliases, linesize 32 bytes<br />[&nbsp; &nbsp; 0.000000] pcpu-alloc: s0 r0 d32768 u32768 alloc=1*32768<br />[&nbsp; &nbsp; 0.000000] pcpu-alloc: [0] 0 <br />[&nbsp; &nbsp; 0.000000] Built 1 zonelists in Zone order, mobility grouping on.&nbsp; Total pages: 16256<br />[&nbsp; &nbsp; 0.000000] Kernel command line:&nbsp; board=TL-MR3220 console=ttyS0,115200 rootfstype=squashfs,jffs2 noinitrd<br />[&nbsp; &nbsp; 0.000000] PID hash table entries: 256 (order: -2, 1024 bytes)<br />[&nbsp; &nbsp; 0.000000] Dentry cache hash table entries: 8192 (order: 3, 32768 bytes)<br />[&nbsp; &nbsp; 0.000000] Inode-cache hash table entries: 4096 (order: 2, 16384 bytes)<br />[&nbsp; &nbsp; 0.000000] Writing ErrCtl register=00000000<br />[&nbsp; &nbsp; 0.000000] Readback ErrCtl register=00000000<br />[&nbsp; &nbsp; 0.000000] Memory: 61080k/65536k available (2384k kernel code, 4456k reserved, 644k data, 232k init, 0k highmem)<br />[&nbsp; &nbsp; 0.000000] SLUB: HWalign=32, Order=0-3, MinObjects=0, CPUs=1, Nodes=1<br />[&nbsp; &nbsp; 0.000000] NR_IRQS:51<br />[&nbsp; &nbsp; 0.080000] Calibrating delay loop... 265.42 BogoMIPS (lpj=1327104)<br />[&nbsp; &nbsp; 0.080000] pid_max: default: 32768 minimum: 301<br />[&nbsp; &nbsp; 0.080000] Mount-cache hash table entries: 512<br />[&nbsp; &nbsp; 0.090000] NET: Registered protocol family 16<br />[&nbsp; &nbsp; 0.100000] MIPS: machine is TP-LINK TL-MR3220<br />[&nbsp; &nbsp; 0.500000] registering PCI controller with io_map_base unset<br />[&nbsp; &nbsp; 0.550000] bio: create slab &lt;bio-0&gt; at 0<br />[&nbsp; &nbsp; 0.550000] usbcore: registered new interface driver usbfs<br />[&nbsp; &nbsp; 0.560000] usbcore: registered new interface driver hub<br />[&nbsp; &nbsp; 0.560000] usbcore: registered new device driver usb<br />[&nbsp; &nbsp; 0.570000] PCI host bridge to bus 0000:00<br />[&nbsp; &nbsp; 0.570000] pci_bus 0000:00: root bus resource [mem 0x10000000-0x13ffffff]<br />[&nbsp; &nbsp; 0.580000] pci_bus 0000:00: root bus resource [io&nbsp; 0x0000]<br />[&nbsp; &nbsp; 0.580000] pci_bus 0000:00: No busn resource found for root bus, will use [bus 00-ff]<br />[&nbsp; &nbsp; 0.590000] pci 0000:00:00.0: [168c:002a] type 00 class 0x028000<br />[&nbsp; &nbsp; 0.590000] pci 0000:00:00.0: fixup device configuration<br />[&nbsp; &nbsp; 0.590000] pci 0000:00:00.0: reg 10: [mem 0x10000000-0x1000ffff 64bit]<br />[&nbsp; &nbsp; 0.590000] pci 0000:00:00.0: supports D1<br />[&nbsp; &nbsp; 0.590000] pci 0000:00:00.0: PME# supported from D0 D1 D3hot<br />[&nbsp; &nbsp; 0.590000] pci_bus 0000:00: busn_res: [bus 00-ff] end is updated to 00<br />[&nbsp; &nbsp; 0.590000] pci 0000:00:00.0: BAR 0: assigned [mem 0x10000000-0x1000ffff 64bit]<br />[&nbsp; &nbsp; 0.600000] pci 0000:00:00.0: using irq 40 for pin 1<br />[&nbsp; &nbsp; 0.600000] Switching to clocksource MIPS<br />[&nbsp; &nbsp; 0.610000] NET: Registered protocol family 2<br />[&nbsp; &nbsp; 0.610000] TCP established hash table entries: 512 (order: 0, 4096 bytes)<br />[&nbsp; &nbsp; 0.620000] TCP bind hash table entries: 512 (order: -1, 2048 bytes)<br />[&nbsp; &nbsp; 0.630000] TCP: Hash tables configured (established 512 bind 512)<br />[&nbsp; &nbsp; 0.630000] TCP: reno registered<br />[&nbsp; &nbsp; 0.640000] UDP hash table entries: 256 (order: 0, 4096 bytes)<br />[&nbsp; &nbsp; 0.640000] UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)<br />[&nbsp; &nbsp; 0.650000] NET: Registered protocol family 1<br />[&nbsp; &nbsp; 0.650000] PCI: CLS 0 bytes, default 32<br />[&nbsp; &nbsp; 0.670000] squashfs: version 4.0 (2009/01/31) Phillip Lougher<br />[&nbsp; &nbsp; 0.680000] jffs2: version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006 Red Hat, Inc.<br />[&nbsp; &nbsp; 0.690000] msgmni has been set to 119<br />[&nbsp; &nbsp; 0.690000] io scheduler noop registered<br />[&nbsp; &nbsp; 0.700000] io scheduler deadline registered (default)<br />[&nbsp; &nbsp; 0.700000] Serial: 8250/16550 driver, 1 ports, IRQ sharing disabled<br />[&nbsp; &nbsp; 0.730000] serial8250.0: ttyS0 at MMIO 0x18020000 (irq = 11) is a 16550A<br />[&nbsp; &nbsp; 0.740000] console [ttyS0] enabled, bootconsole disabled<br />[&nbsp; &nbsp; 0.750000] ath79-spi ath79-spi: master is unqueued, this is deprecated<br />[&nbsp; &nbsp; 0.760000] m25p80 spi0.0: found s25sl064a, expected m25p80<br />[&nbsp; &nbsp; 0.770000] m25p80 spi0.0: s25sl064a (8192 Kbytes)<br />[&nbsp; &nbsp; 0.770000] 5 tp-link partitions found on MTD device spi0.0<br />[&nbsp; &nbsp; 0.780000] Creating 5 MTD partitions on &quot;spi0.0&quot;:<br />[&nbsp; &nbsp; 0.780000] 0x000000000000-0x000000020000 : &quot;u-boot&quot;<br />[&nbsp; &nbsp; 0.790000] 0x000000020000-0x000000133e00 : &quot;kernel&quot;<br />[&nbsp; &nbsp; 0.790000] mtd: partition &quot;kernel&quot; must either start or end on erase block boundary or be smaller than an erase block -- forcing read-only<br />[&nbsp; &nbsp; 0.810000] 0x000000133e00-0x0000007f0000 : &quot;rootfs&quot;<br />[&nbsp; &nbsp; 0.810000] mtd: partition &quot;rootfs&quot; must either start or end on erase block boundary or be smaller than an erase block -- forcing read-only<br />[&nbsp; &nbsp; 0.830000] mtd: device 2 (rootfs) set to be root filesystem<br />[&nbsp; &nbsp; 0.830000] 1 squashfs-split partitions found on MTD device rootfs<br />[&nbsp; &nbsp; 0.840000] 0x0000003a0000-0x0000007f0000 : &quot;rootfs_data&quot;<br />[&nbsp; &nbsp; 0.850000] 0x0000007f0000-0x000000800000 : &quot;art&quot;<br />[&nbsp; &nbsp; 0.850000] 0x000000020000-0x0000007f0000 : &quot;firmware&quot;<br />[&nbsp; &nbsp; 0.880000] libphy: ag71xx_mdio: probed<br />[&nbsp; &nbsp; 1.430000] ag71xx-mdio.1: Found an AR7240/AR9330 built-in switch<br />[&nbsp; &nbsp; 2.470000] eth0: Atheros AG71xx at 0xba000000, irq 5, mode:GMII<br />[&nbsp; &nbsp; 3.020000] ag71xx ag71xx.0: connected to PHY at ag71xx-mdio.1:04 [uid=004dd041, driver=Generic PHY]<br />[&nbsp; &nbsp; 3.030000] eth1: Atheros AG71xx at 0xb9000000, irq 4, mode:MII<br />[&nbsp; &nbsp; 3.040000] usbcore: registered new interface driver cdc_ether<br />[&nbsp; &nbsp; 3.050000] usbcore: registered new interface driver rndis_host<br />[&nbsp; &nbsp; 3.050000] usbcore: registered new interface driver sierra_net<br />[&nbsp; &nbsp; 3.060000] usbcore: registered new interface driver cdc_ncm<br />[&nbsp; &nbsp; 3.060000] usbcore: registered new interface driver qmi_wwan<br />[&nbsp; &nbsp; 3.070000] usbcore: registered new interface driver cdc_wdm<br />[&nbsp; &nbsp; 3.080000] TCP: cubic registered<br />[&nbsp; &nbsp; 3.080000] NET: Registered protocol family 17<br />[&nbsp; &nbsp; 3.090000] 8021q: 802.1Q VLAN Support v1.8<br />[&nbsp; &nbsp; 3.100000] VFS: Mounted root (squashfs filesystem) readonly on device 31:2.<br />[&nbsp; &nbsp; 3.110000] Freeing unused kernel memory: 232K (80356000 - 80390000)<br />[&nbsp; &nbsp; 5.910000] ehci_hcd: USB 2.0 &#039;Enhanced&#039; Host Controller (EHCI) Driver<br />[&nbsp; &nbsp; 5.910000] ehci-platform: EHCI generic platform driver<br />[&nbsp; &nbsp; 5.920000] ehci-platform ehci-platform: EHCI Host Controller<br />[&nbsp; &nbsp; 5.930000] ehci-platform ehci-platform: new USB bus registered, assigned bus number 1<br />[&nbsp; &nbsp; 5.940000] ehci-platform ehci-platform: irq 3, io mem 0x1b000000<br />[&nbsp; &nbsp; 5.960000] ehci-platform ehci-platform: USB 2.0 started, EHCI 1.00<br />[&nbsp; &nbsp; 5.960000] hub 1-0:1.0: USB hub found<br />[&nbsp; &nbsp; 5.970000] hub 1-0:1.0: 1 port detected<br />[&nbsp; &nbsp; 5.970000] ohci_hcd: USB 1.1 &#039;Open&#039; Host Controller (OHCI) Driver<br />[&nbsp; &nbsp; 5.980000] uhci_hcd: USB Universal Host Controller Interface driver<br />[&nbsp; &nbsp; 6.380000] usb 1-1: new high-speed USB device number 2 using ehci-platform<br />[&nbsp; &nbsp; 6.830000] qmi_wwan 1-1:1.1: cdc-wdm0: USB WDM device<br />[&nbsp; &nbsp; 6.850000] qmi_wwan 1-1:1.1 wwan0: register &#039;qmi_wwan&#039; at usb-ehci-platform-1, WWAN/QMI device, d2:7c:5d:4c:2a:a8<br />[&nbsp; &nbsp;11.190000] jffs2: notice: (343) jffs2_build_xattr_subsystem: complete building xattr subsystem, 1 of xdatum (0 unchecked, 0 orphan) and 20 of xref (0 dead, 2 orphan) found.<br />[&nbsp; &nbsp;13.830000] NET: Registered protocol family 10<br />[&nbsp; &nbsp;13.870000] nf_conntrack version 0.5.0 (958 buckets, 3832 max)<br />[&nbsp; &nbsp;13.890000] ip6_tables: (C) 2000-2006 Netfilter Core Team<br />[&nbsp; &nbsp;13.940000] u32 classifier<br />[&nbsp; &nbsp;13.940000]&nbsp; &nbsp; &nbsp;input device check on<br />[&nbsp; &nbsp;13.950000]&nbsp; &nbsp; &nbsp;Actions configured<br />[&nbsp; &nbsp;13.960000] Mirror/redirect action on<br />[&nbsp; &nbsp;13.980000] usbcore: registered new interface driver cdc_acm<br />[&nbsp; &nbsp;13.980000] cdc_acm: USB Abstract Control Model driver for USB modems and ISDN adapters<br />[&nbsp; &nbsp;14.000000] Loading modules backported from Linux version master-2014-05-22-0-gf2032ea<br />[&nbsp; &nbsp;14.000000] Backport generated by backports.git backports-20140320-37-g5c33da0<br />[&nbsp; &nbsp;14.020000] ip_tables: (C) 2000-2006 Netfilter Core Team<br />[&nbsp; &nbsp;14.090000] usbcore: registered new interface driver usbserial<br />[&nbsp; &nbsp;14.090000] usbcore: registered new interface driver usbserial_generic<br />[&nbsp; &nbsp;14.120000] usbserial: USB Serial support registered for generic<br />[&nbsp; &nbsp;14.190000] xt_time: kernel timezone is -0000<br />[&nbsp; &nbsp;14.270000] cfg80211: Calling CRDA to update world regulatory domain<br />[&nbsp; &nbsp;14.290000] cfg80211: World regulatory domain updated:<br />[&nbsp; &nbsp;14.290000] cfg80211:&nbsp; DFS Master region: unset<br />[&nbsp; &nbsp;14.290000] cfg80211:&nbsp; &nbsp;(start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp), (dfs_cac_time)<br />[&nbsp; &nbsp;14.300000] cfg80211:&nbsp; &nbsp;(2402000 KHz - 2472000 KHz @ 40000 KHz), (N/A, 2000 mBm), (N/A)<br />[&nbsp; &nbsp;14.310000] cfg80211:&nbsp; &nbsp;(2457000 KHz - 2482000 KHz @ 40000 KHz), (N/A, 2000 mBm), (N/A)<br />[&nbsp; &nbsp;14.320000] cfg80211:&nbsp; &nbsp;(2474000 KHz - 2494000 KHz @ 20000 KHz), (N/A, 2000 mBm), (N/A)<br />[&nbsp; &nbsp;14.330000] cfg80211:&nbsp; &nbsp;(5170000 KHz - 5250000 KHz @ 160000 KHz), (N/A, 2000 mBm), (N/A)<br />[&nbsp; &nbsp;14.340000] cfg80211:&nbsp; &nbsp;(5250000 KHz - 5330000 KHz @ 160000 KHz), (N/A, 2000 mBm), (0 s)<br />[&nbsp; &nbsp;14.350000] cfg80211:&nbsp; &nbsp;(5490000 KHz - 5730000 KHz @ 160000 KHz), (N/A, 2000 mBm), (0 s)<br />[&nbsp; &nbsp;14.350000] cfg80211:&nbsp; &nbsp;(5735000 KHz - 5835000 KHz @ 80000 KHz), (N/A, 2000 mBm), (N/A)<br />[&nbsp; &nbsp;14.360000] cfg80211:&nbsp; &nbsp;(57240000 KHz - 63720000 KHz @ 2160000 KHz), (N/A, 0 mBm), (N/A)<br />[&nbsp; &nbsp;14.410000] PPP generic driver version 2.4.2<br />[&nbsp; &nbsp;14.410000] NET: Registered protocol family 24<br />[&nbsp; &nbsp;14.420000] usbcore: registered new interface driver sierra<br />[&nbsp; &nbsp;14.430000] usbserial: USB Serial support registered for Sierra USB modem<br />[&nbsp; &nbsp;14.470000] usbcore: registered new interface driver option<br />[&nbsp; &nbsp;14.480000] usbserial: USB Serial support registered for GSM modem (1-port)<br />[&nbsp; &nbsp;14.490000] option 1-1:1.0: GSM modem (1-port) converter detected<br />[&nbsp; &nbsp;14.500000] usb 1-1: GSM modem (1-port) converter now attached to ttyUSB0<br />[&nbsp; &nbsp;14.500000] option 1-1:1.2: GSM modem (1-port) converter detected<br />[&nbsp; &nbsp;14.510000] usb 1-1: GSM modem (1-port) converter now attached to ttyUSB1<br />[&nbsp; &nbsp;14.520000] option 1-1:1.3: GSM modem (1-port) converter detected<br />[&nbsp; &nbsp;14.540000] usb 1-1: GSM modem (1-port) converter now attached to ttyUSB2<br />[&nbsp; &nbsp;14.560000] usbcore: registered new interface driver qcserial<br />[&nbsp; &nbsp;14.560000] usbserial: USB Serial support registered for Qualcomm USB modem<br />[&nbsp; &nbsp;14.600000] PCI: Enabling device 0000:00:00.0 (0000 -&gt; 0002)<br />[&nbsp; &nbsp;14.610000] ath: phy0: Bad EEPROM checksum 0x0 or revision 0x000f<br />[&nbsp; &nbsp;14.610000] ath: phy0: Unable to initialize hardware; initialization status: -22<br />[&nbsp; &nbsp;14.620000] ath9k 0000:00:00.0: Failed to initialize device<br />[&nbsp; &nbsp;14.630000] ath9k: probe of 0000:00:00.0 failed with error -22<br />[&nbsp; &nbsp;23.030000] IPv6: ADDRCONF(NETDEV_UP): eth1: link is not ready<br />[&nbsp; &nbsp;23.050000] device eth1 entered promiscuous mode<br />[&nbsp; &nbsp;23.050000] br-lan: port 1(eth1) entered forwarding state<br />[&nbsp; &nbsp;23.060000] br-lan: port 1(eth1) entered forwarding state<br />[&nbsp; &nbsp;24.130000] IPv6: ADDRCONF(NETDEV_UP): eth0: link is not ready<br />[&nbsp; &nbsp;24.140000] br-lan: port 1(eth1) entered disabled state<br />[&nbsp; &nbsp;25.820000] eth1: link up (100Mbps/Full duplex)<br />[&nbsp; &nbsp;25.820000] br-lan: port 1(eth1) entered forwarding state<br />[&nbsp; &nbsp;25.830000] br-lan: port 1(eth1) entered forwarding state<br />[&nbsp; &nbsp;25.830000] IPv6: ADDRCONF(NETDEV_CHANGE): eth1: link becomes ready<br />[&nbsp; &nbsp;27.830000] br-lan: port 1(eth1) entered forwarding state</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p244915">
				<div class="post-metadata">
					<div class="post-num">Post #95</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						26 Aug 2014, 07:41					</div>
				</div>
				<div class="post-content content">
					<p>have you tried a standard official image of both AA and BB?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p245024">
				<div class="post-metadata">
					<div class="post-num">Post #96</div>
					<div class="post-author">JohnV</div>
					<div class="post-datetime">
						26 Aug 2014, 23:10					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>anarchy99 wrote:</cite><blockquote><p>if you flash image using mtd command to firmware partition and don&#039;t mess with other partitions <br />then it&#039;s something with barrier breaker. take a look at here: <a href="https://dev.openwrt.org/ticket/14234">https://dev.openwrt.org/ticket/14234</a></p></blockquote></div><p>I just want to be clear before I try this, as I can&#039;t afford to brick the router right now:</p><p>1) Install working firmware, confirm WiFi is working.<br />2) Build a BB firmware.<br />3) Transfer the BB firmware (sysupgrade) to the router.<br />4) Run:&nbsp; mtd -r write sysupgrade.bin firmware</p><p>I will try this once I get an OK here and report the results back.</p><br /><br /><p>I have not tried the standard builds for AA or BB as the router is not a true MR3220, but based on it.&nbsp; I was/am concerned that trying the standard firmware will brick something, but if that is not possible, let me know and I can try. The MR3220 builds are for 4meg router, the router I am using is 8meg, so I assumed I should not try the standard firmwares or it might take me a step backwards in getting by 8meg build to work correctly.</p>											<p class="post-edited">(Last edited by <strong>JohnV</strong> on 26 Aug 2014, 23:13)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p245029">
				<div class="post-metadata">
					<div class="post-num">Post #97</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						26 Aug 2014, 23:50					</div>
				</div>
				<div class="post-content content">
					<p>I assumed you had serial access!<br />If that&#039;s the case, you can try official images without problem imho.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p245227">
				<div class="post-metadata">
					<div class="post-num">Post #98</div>
					<div class="post-author">JohnV</div>
					<div class="post-datetime">
						28 Aug 2014, 23:43					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>anarchy99 wrote:</cite><blockquote><p>if you flash image using mtd command to firmware partition and don&#039;t mess with other partitions then it&#039;s something with barrier breaker. take a look at here: <a href="https://dev.openwrt.org/ticket/14234">https://dev.openwrt.org/ticket/14234</a></p></blockquote></div><p>I used mtd to flash &quot;firmware&quot;, still no luck.</p><p>Is there a chance the working firmware I have has been reconfigured in some way as to make it incompatible with standard OpenWRT builds?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p245230">
				<div class="post-metadata">
					<div class="post-num">Post #99</div>
					<div class="post-author">JohnV</div>
					<div class="post-datetime">
						28 Aug 2014, 23:47					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nebbia88 wrote:</cite><blockquote><p>I assumed you had serial access!<br />If that&#039;s the case, you can try official images without problem imho.</p></blockquote></div><p>I am waiting for the pin information from the manufacturer, so at the moment, I do not have serial access,.</p><p>I will wait for that so at least I can get into the router again if the firmware causes issues.&nbsp; </p><p>Reading this thread though, it is unclear if all will be OK if I go from a 4meg image (assuming that works ok) to an 8meg image I am building.&nbsp; Also, what will happen if I go from the working 8meg image, back to a 4meg image.</p><p>The issue is I cannot manually create images for each router, as we will be putting our firmware on 100&#039;s of these units, so I need some relatively easy way to get our firmware installed correctly.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p246814">
				<div class="post-metadata">
					<div class="post-num">Post #100</div>
					<div class="post-author">JohnV</div>
					<div class="post-datetime">
						12 Sep 2014, 06:01					</div>
				</div>
				<div class="post-content content">
					<p>I now have serial access, and here is the U-boot and printenv info.</p><p>Is it &quot;normal&quot; the ART partition would say 1792k in here?&nbsp; This is the log when I have the working AA firmware installed....</p><br /><br /><br /><p>U-Boot 1.1.8 (Jul 31 2011 - 10:00:00)</p><p>AP99 (ar7241) U-boot &lt;phantasm131@gmail.com&gt;<br />DRAM:<br />sri<br />ar7240_ddr_initial_config(133): virian ddr1 init<br />#### TAP VALUE 1 = 0xf, 2 = 0x10 [0x0: 0x1f]<br />64 MB<br />id read 0x100000ff<br />sector count = 128<br />Flash:&nbsp; 8 MB<br />Using default environment</p><p>In:&nbsp; &nbsp; serial<br />Out:&nbsp; &nbsp;serial<br />Err:&nbsp; &nbsp;serial<br />Net:&nbsp; &nbsp;ag7240_enet_initialize...<br />No valid address in Flash. Using fixed address<br />No valid address in Flash. Using fixed address<br />Virian MDC CFG Value ==&gt; 4<br />: cfg1 0xf cfg2 0x7014<br />eth0: 00:03:7f:09:0b:ad<br />eth0 up<br />Virian MDC CFG Value ==&gt; 4<br />: cfg1 0xf cfg2 0x7214<br />eth1: 00:03:7f:09:0b:ad<br />ATHRS26: resetting s26<br />ATHRS26: s26 reset done<br />eth1 up<br />eth0, eth1<br />Hit any key to stop autoboot:&nbsp; 0<br />Atheros&gt; printenv<br />bootargs=console=ttyS0,115200 root=31:02 rootfstype=jffs2 init=/sbin/init mtdparts=ar7240-nor0:256k(u-boot),64k(u-boot-env),5120k(rootfs),896k(uImage),64k(NVRAM),1792k(ART)<br />bootcmd=bootm 0x9f020000<br />bootdelay=3<br />baudrate=115200<br />ethaddr=0x00:0xaa:0xbb:0xcc:0xdd:0xee<br />ipaddr=192.168.1.10<br />serverip=192.168.1.18<br />stdin=serial<br />stdout=serial<br />stderr=serial<br />ethact=eth0</p><p>Environment size: 359/65532 bytes</p>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 4 of 5</div><nav><ul><li><a href="viewtopic.php%3Fid=32512&amp;p=1.html">1</a></li><li><a href="viewtopic.php%3Fid=32512&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=32512&amp;p=3.html">3</a></li><li class="pagination-current"><span>4</span></li><li><a href="viewtopic.php%3Fid=32512&amp;p=5.html">5</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0.001 -->

</body>
</html>