<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> luci-app-ddns / ddns-scripts : I&#039;m working on enhancements</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 23 Mar 2018 and 4 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 6</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=50908&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=50908&amp;p=3.html">3</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=50908&amp;p=6.html">6</a></li></ul></nav></div>
			
		
		
			<article class="post" id="p235338">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">chris5560</div>
					<div class="post-datetime">
						1 Jun 2014, 17:23					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I&#039;m currently working on the enhancement of the existing ddns-scripts and luci-app.</p><p>My current ideas:</p><p><strong>- IPv6 Support</strong><br />Some german providers offers only changing prefixes to private clients<br />I&#039;m personal using ipv4 with 6to4 tunnel, so I need it too.<br />Some providers like dyndns.org or spdns.de offer the update for IPv4 and IPv6</p><p><strong>- Proxy-Support</strong><br />I&#039;ve seen requests that there are some situtaions where it make sense to use a proxy for http/https request when updating</p><p><strong>- DNS-Server Support</strong><br />I&#039;ve seen requests that if using URL to detect current &quot;external&quot; IP it might by nessesary to ask a differnt DNS in state of using the systems default</p><p><strong>- allow force_interval = 0</strong><br />I&#039;ve seen requests that want to run the updater script only once (not as deamon).<br />i.e. run it via cron</p><p><strong>- Start/Stop script</strong><br />/etc/init.d/ddns stop will kill all update-scripts but<br />/etc/init.d/ddns start will start nothing<br />only possible to start again via restarting the affected interface</p><p><strong>- hotplug script </strong><br />the existing hotplug script ignores if ddns service is disabled<br />via /etc/init.d/ddns enable or disable</p><p><strong>- scripts in general</strong><br />extension for the above listed<br />do not update if interface address could not be detect because netifd has not finished setting ipadresses<br />verify if send update was recognised by the internet<br />don&#039;t start deamon if critical errors exists (possible you set &quot;wan&quot; to detect IPv6 but there is none because it&#039;s on &quot;wan6&quot;)</p><p><strong>- luci-app-ddns</strong><br />- split into &quot;Overview&quot; and &quot;Details&quot; page (like luci-app-openvpn and others)<br />- extensions for the listed above<br />- setting if using HTTP or HTTPS including ca-certificate directory or file&nbsp; or &quot;IGNORE&quot; if you want to run https but not want to verifing servers certificate&nbsp; &nbsp;(I know that&#039;s unsecure)<br />- setting for logging to syslog<br />- setting &quot;monitor&quot; network (uci option &quot;interface&quot;) because currently only &quot;wan&quot; is supported but it could be any other<br />- restart ddns service if &quot;save + apply&quot; to reflect changes</p><p><strong>- general</strong><br />- the existing uci options will be untouched<br />- the existing services file will be untouched there will be a &quot;services_ipv6&quot; only for IPv6<br />- new scripts will work with old uci config (without IPv6 support)<br />- new luci-app will work with old uci config and old scripts (without IPv6 support and other extensions to the scripts)</p><p>Anything missing<br />who could support me in testing before</p><p>discussions welcome</p><p>chris5560</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235785">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">mattbunce</div>
					<div class="post-datetime">
						5 Jun 2014, 22:36					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;d love to see many of these enhancements, one more thing I&#039;d throw into the mix is update stats on the LuCI configuration page itself, for example:<br /></p><div class="quotebox"><blockquote><p><strong>Current IP:</strong> <span class="bbu">49.212.153.21</span><br /><strong>Last check:</strong> IP address for <span class="bbu">myhost.ddns.org</span> was <span class="bbu">49.212.153.21</span> at <span class="bbu">20:25</span> on <span class="bbu">05/06/2014</span><br /><strong>Last update:</strong> We tried to set the IP address to <span class="bbu">49.212.153.21</span> at <span class="bbu">10:15</span> on <span class="bbu">04/06/2014</span><br /><strong>Last output:</strong> <span class="bbu">Success</span></p></blockquote></div><p>This would allow a simple method of verifying DDNS is working without having to log to syslog (but great to have it as a config option for people who are experiencing problems when configuring DDNS).</p><p>I have been looking at how to store the relevant values in /tmp and read them back using the LUCI app, but I have no idea how to read simple strings from the filesystem and add them to a LUCI page.</p><p>M</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235841">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">chris5560</div>
					<div class="post-datetime">
						6 Jun 2014, 11:52					</div>
				</div>
				<div class="post-content content">
					<p>the script on router<br />/usr/lib/ddns/dynamic_dns_updater.sh<br />located in build env at trunk/feeds/packages/net/ddns-scripts/files/...<br />writes systems uptime into a file /var/run/dynamic_dns/$service_id.update<br />starting line 265 ff<br />this could be changed into current date or you only display time since last update and time left until next update</p><p>I found a good sample on how to read content of a file into luci cbi in luci-app-openvpn<br />/usr/lib/lua/luci/model/cbi/openvpn.lua<br />build env at trunk/feeds/luci/applications/luci-openvpn/luasrc/model/cbi<br />starting line 75 ff<br />it also calls a shell command and verifies it&#039;s output</p><p>chris5560</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p240460">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">chris5560</div>
					<div class="post-datetime">
						16 Jul 2014, 21:53					</div>
				</div>
				<div class="post-content content">
					<p>Ready for community testing !<br />hopefully without errors ;-)</p><p>I create a ticket <br /><a href="https://dev.openwrt.org/ticket/17139">https://dev.openwrt.org/ticket/17139</a> <br />with a zip-file attached with all needed files and <br />README_FIRST, CHANGES and HOWTO included.</p><p>Tested by myself on 10.03.1, 12.09 and 14.07-rc1 base-builds downloaded from openwrt download page on WNDR3800 and VirtualBox x86 hardware.</p><p>LuCI application will use existing app-ddns language files which are currently incomplete or might have errors.<br />The next step from my side will be to correct german translation and building patch files for openwrt build system.</p><p>feedback welcome !</p><p>Enjoy<br />chris5560</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p240522">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">zloop</div>
					<div class="post-datetime">
						17 Jul 2014, 08:26					</div>
				</div>
				<div class="post-content content">
					<p>First: Thanks for working on these changes chris - it&#039;s very much appreciated.</p><p>However: please post your changes to the mailing list as a patch series.<br />To get your code accepted you have to &quot;sign off&quot; on it too.<br />Then all OpenWrt users could enjoy your improvements and not only those that build their own images.</p><p>Almost all enhancement tickets on the bugtracker are closed with <br />&quot;please read <a href="https://dev.openwrt.org/wiki/SubmittingPatches">https://dev.openwrt.org/wiki/SubmittingPatches</a> &quot;<br />It&#039;s very likely it will happen to your ticket too</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p241101">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">billmc</div>
					<div class="post-datetime">
						22 Jul 2014, 20:38					</div>
				</div>
				<div class="post-content content">
					<p>Chris,</p><p>I need to say Thank You, Thank You, Thank You.</p><p>This functionality is something I desperately needed.&nbsp; My ISP is Hughes.&nbsp; It is satellite based.&nbsp; They no longer offer a public IPv4 address, everything runs through their NAT.&nbsp; They do however, offer native IPv6.&nbsp; The only downside to their implementation to the IPv6 I&#039;ve found so far, is that the prefix changes.&nbsp; They also run all their http(s) traffic through a proxy.&nbsp; Going to sites that read back the IP of the system connecting to them, reports the address of the proxy, rather than my host.&nbsp; This feature can be disabled in the Hughes modem, but will be reenabled upon a restart of the modem.&nbsp; I needed something that would update the IPv6 address when it changed.</p><p>My Address Source IPv6 selection is Network and my Network IPv6 selection is wan6.</p><p>I am running arokh&#039;s r41683 trunk build on a WNDR3700v2.&nbsp; I followed your instructions in your HOWTO for the 14.07-rc1 build.&nbsp; Although I found a couple of typos in your instructions, I made it through and now it seems to work.</p><p>I first tested this with dnsexit.com.&nbsp; It appeared as if some errors were encountered.&nbsp; Their website, and the entry in the services file, show updating a XX.XX.XX.XX address.&nbsp; Your script would not update the record.&nbsp; In your HOWTO, you mention there may be a different link to update IPv6.&nbsp; I sent an email to dnsexit.com, describing my inability to update my IPv6 address and asking them if they had a separate link for IPv6.&nbsp; Their answer to me was:</p><p>&quot; IPv6 no need to get updated dynamically.</p><p>Jack<br />DNS Exit&quot;</p><p>So based upon their response, I assume they don&#039;t support automated updating of an IPv6 address (I was able to do it manually via their website).</p><p>I then established an account with Hurricane Electric (<a href="https://dns.he.net">https://dns.he.net</a>).&nbsp; Copying the entry for he.net from the services file and putting it into the services_ipv6 file, I am now able to update my address.</p><p>At this point, my prefix has not changed.&nbsp; For testing purposes, I have manually made an address change in the HE nameservers, then waited to see what would happen.&nbsp; So far, it doesn&#039;t appear that my address gets updated, when the script is running and the address in the nameserver is different than my address.&nbsp; However, if I reboot the router, it will go and change the address in the nameserver.</p><p>After a reboot, logread shows &quot;user.notice ddns-scripts[1846]: myddns: Update successful - RegisteredIP:&quot; followed by my current interface address.&nbsp; executing an nslookup, shows that the address has changed in the nameserver.&nbsp; Without a reboot, logread shows &quot;user.notice ddns-scripts[1846]: myddns: Running IP check ...&quot;.<br />nslookup confirms that an update has not taken place.</p><p>I don&#039;t understand why the address does not get updated, when the nameserver holds an address that is different than my address without a reboot.</p><p>Unfortunately for me, I&#039;m not skilled in reading or writing scripts, so on my own, I can&#039;t seem to figure out what is happening.</p><p>Once again, thank you for this.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p241112">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">chris5560</div>
					<div class="post-datetime">
						22 Jul 2014, 22:23					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for your feedback.</p><p>During my test I used spdns.de as DDNS provider and interface wan6 and URL using <a href="http://checkipv6.dyndns.com">http://checkipv6.dyndns.com</a> to detect my current IP.<br />It takes up to 4 minutes until nslookup using resolver1.opendns.com sees my new address.<br />DNS caches !?</p><p>Did you see any error/retrys in syslog ?</p><p>try to start the script from console<br />&gt; cd /usr/lib/ddns<br />&gt; ./dnamic_dns_updater.sh myddns 1<br />myddns = your service configuration name<br />1 = show verbose logging</p><p>running on console with verbose logging you get much more output.<br />all steps the script is running including output of wget/curl sending the update.<br />please try to find out what happen in detail.</p><p>If the script detects, that CurrentIP (on the interface) is different from nslookup (RegisteredIP) it will send an update.<br />After 60 seconds (hardcoded) it will recheck nslookup<br />if still different it retrys to update after 60 seconds (default)<br />/etc/config/ddns parameters:<br />&nbsp; &nbsp; retry_count&nbsp; &nbsp; number of retrys&nbsp; &nbsp; (default &quot;5&quot; if not given)<br />&nbsp; &nbsp; retry_interval and retry_unit&nbsp; &nbsp; (&quot;60&quot; &quot;seconds&quot; if not given)</p><p>running on console with errors the scripts finishes automatically after retry_count (5 retrys)<br />if everything goes ok (hopefully after retry) you need to break the script with [STRG]+C</p><p>try <a href="http://checkipv6.dyndns.com">http://checkipv6.dyndns.com</a> in your browser that&#039;s the IPv6 seen by the world for your browsers box (or the WEB-Proxy outside address you are using)<br />try: wget <a href="http://checkipv6.dyndns.com">http://checkipv6.dyndns.com</a> on routers console. You will see your address seen from the network, possibly proxys outside address if there is a proxy configured either on your router or somewhere at your ISP.</p><p>Are you using the LuCI interface ? <br />Did you also install my modifications to luci-app-ddns ? (It&#039;s not required by the scripts)<br />What is showing &quot;Next Update&quot; on &quot;Status&quot;-&quot;Overview&quot; at DynamicDNS ?</p><p>Thanks for you help to find out what is going wrong.</p>											<p class="post-edited">(Last edited by <strong>chris5560</strong> on 22 Jul 2014, 23:30)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p241123">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">billmc</div>
					<div class="post-datetime">
						23 Jul 2014, 02:13					</div>
				</div>
				<div class="post-content content">
					<p>Chris,<br />I did install the stuff for the Luci interface.&nbsp; While the script is running, you will see a button labeled stop with a red octagon icon.&nbsp; If the program is not running, the button will be labeled start with a green icon.&nbsp; I noticed that for the instant of time the script wakes up and checks the address, it will change from a red stop to a green start.&nbsp; To the left of the button, below the column labeled Process ID Next Update, it displays PID: with the process id number, below that it shows a count down of time remaining until the next forced update.</p><p>I killed the current running process.&nbsp; Then from the command line with my address equal to the address in the nameserver, this is the output:</p><p>root@OpenWrt ddns# ./dynamic_dns_updater.sh myddns 1</p><p>&nbsp; &nbsp;update_prog: /usr/bin/wget -nv -O - -6 --no-check-certificate <br />&nbsp; &nbsp; update_url: https://[DOMAIN]:[PASSWORD]@dyn.dns.he.net/nic/update?hostname=[DOMAIN]&amp;myip=[IP]<br />force interval: 259200 seconds<br />check interval: 600 seconds<br />retry interval: 60 seconds<br /> retry counter: 5 times<br />old Process Id: <br />&nbsp; &nbsp;last update: 3 hours ago</p><p>Running IP check ...<br />&nbsp; &nbsp; &nbsp;system ip: 2001:XXXX:XXXX:XXXX:XXXX:XXXX:XXXX:f0fa<br /> registered ip: 2001:XXXX:XXXX:XXXX:XXXX:XXXX:XXXX:f0fa<br />update unnecessary<br />time since last update = 3 hours<br />the time is now Tue Jul 22 16:44:30 CDT 2014</p><p>Running IP check ...<br />&nbsp; &nbsp; &nbsp;system ip: 2001:XXXX:XXXX:XXXX:XXXX:XXXX:XXXX:f0fa<br /> registered ip: 2001:XXXX:XXXX:XXXX:XXXX:XXXX:XXXX:f0fa<br />update unnecessary<br />time since last update = 3 hours<br />the time is now Tue Jul 22 16:54:30 CDT 2014</p><p>I then went to the Hurricane Electric DNS website and changed the address of the AAAA listing.<br />Verifying that the update has been accepted using nslookup:</p><p>$ nslookup -type=aaaa ayankeeindixie.com ns1.he.net<br />Server:&nbsp; &nbsp; &nbsp; &nbsp; ns1.he.net<br />Address:&nbsp; &nbsp; 216.218.130.2#53</p><p>ayankeeindixie.com&nbsp; &nbsp; has AAAA address 2001:XXXX:XXXX:XXXX::41d</p><p>I ran the script again, this is the output<br />root@OpenWrt ddns# ./dynamic_dns_updater.sh myddns 1</p><p>&nbsp; &nbsp;update_prog: /usr/bin/wget -nv -O - -6 --no-check-certificate <br />&nbsp; &nbsp; update_url: https://[DOMAIN]:[PASSWORD]@dyn.dns.he.net/nic/update?hostname=[DOMAIN]&amp;myip=[IP]<br />force interval: 259200 seconds<br />check interval: 600 seconds<br />retry interval: 60 seconds<br /> retry counter: 5 times<br />old Process Id: <br />&nbsp; &nbsp;last update: 4 hours ago</p><p>Running IP check ...<br />&nbsp; &nbsp; &nbsp;system ip: 2001:XXXX:XXXX:XXXX:XXXX:XXXX:XXXX:f0fa<br /> registered ip: 2001:XXXX:XXXX:XXXX:XXXX:XXXX:XXXX:f0fa<br />update unnecessary<br />time since last update = 4 hours<br />the time is now Tue Jul 22 17:08:16 CDT 2014</p><p>This indicates to me one of two things, either it is not checking the address in the nameserver or it is using the address in dnsmasq instead of checking the Hurricane Electric nameserver.</p><br /><p>With my ISP&#039;s proxy enabled, this is the result of wget:<br />root@OpenWrt ddns# wget <a href="http://checkipv6.dyndns.com">http://checkipv6.dyndns.com</a><br />--2014-07-22 17:14:30--&nbsp; <a href="http://checkipv6.dyndns.com/">http://checkipv6.dyndns.com/</a><br />Resolving checkipv6.dyndns.com... 2600:2004:0:1::1<br />Connecting to checkipv6.dyndns.com|2600:2004:0:1::1|:80... connected.<br />HTTP request sent, awaiting response... 200 OK<br />Length: 129 [text/html]<br />Saving to: &#039;index.html&#039;</p><p>100%[============================================================&gt;] 129&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;--.-K/s&nbsp; &nbsp;in 0s&nbsp; &nbsp; &nbsp; </p><p>2014-07-22 17:14:32 (2.57 MB/s) - &#039;index.html&#039; saved [129/129]<br />root@OpenWrt ddns# cat index.html <br />&lt;html&gt;&lt;head&gt;&lt;title&gt;Current IP Check&lt;/title&gt;&lt;/head&gt;&lt;body&gt;Current IP Address: 2001:5b0:2d5a:ac50:280:aeff:fe3f:44b4&lt;/body&gt;&lt;/html&gt;</p><p>The address listed in the response is not the address of my machine, so I&#039;ll assume it is the address of the ISP&#039;s proxy.</p><p>If I disable the ISP&#039;s proxy and do it again, this is what I get:<br />root@OpenWrt ddns# wget <a href="http://checkipv6.dyndns.com">http://checkipv6.dyndns.com</a><br />--2014-07-22 17:19:50--&nbsp; <a href="http://checkipv6.dyndns.com/">http://checkipv6.dyndns.com/</a><br />Resolving checkipv6.dyndns.com... 2600:200d:0:1::1<br />Connecting to checkipv6.dyndns.com|2600:200d:0:1::1|:80... connected.<br />HTTP request sent, awaiting response... 200 OK<br />Length: 130 [text/html]<br />Saving to: &#039;index.html&#039;</p><p>100%[============================================================&gt;] 130&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;--.-K/s&nbsp; &nbsp;in 0s&nbsp; &nbsp; &nbsp; </p><p>2014-07-22 17:19:52 (2.60 MB/s) - &#039;index.html&#039; saved [130/130]</p><p>root@OpenWrt ddns# cat index.html <br />&lt;html&gt;&lt;head&gt;&lt;title&gt;Current IP Check&lt;/title&gt;&lt;/head&gt;&lt;body&gt;Current IP Address: 2001:XXXX:XXXX:XXXX:XXXX:XXXX:XXXX:f0fa&lt;/body&gt;&lt;/html&gt;</p><p>This second response, with the proxy disabled, shows the correct address of my machine.&nbsp; This is the type of behavior, that I spent several days with the ISP confirming, is what the ISP considers to be correct.</p><p>One problem I had with dnsexit.com, was that if an attempt to update the record was received without a &quot;proper&quot; address, they substituted they address of the connection, which in my case was the proxy.&nbsp; So anything that uses http(s) in one form or another, to compare the address that is being sent with the address of the sender, will never be correct (they&#039;ll see the proxy) and I can&#039;t use it.</p><p>And, as I said, if I reboot the router, it will go to the Hurricane Electric Nameserver, and correctly update the AAAA record with the address equal to the address of wan6.</p><p>Oh, one last thing I tried.&nbsp; From the Luci interface, I unchecked the enable check-box and saved and applied that setting.&nbsp; Then I rebooted the router.&nbsp; When it came back up, from the Luci interface, I checked the enable check-box and again, saved and apply.</p><p>Then I went to the console window and ran it again, this is the output:<br />root@OpenWrt ddns# ./dynamic_dns_updater.sh myddns 1</p><p>&nbsp; &nbsp;update_prog: /usr/bin/wget -nv -O - -6 --no-check-certificate <br />&nbsp; &nbsp; update_url: https://[DOMAIN]:[PASSWORD]@dyn.dns.he.net/nic/update?hostname=[DOMAIN]&amp;myip=[IP]<br />force interval: 259200 seconds<br />check interval: 600 seconds<br />retry interval: 60 seconds<br /> retry counter: 5 times<br />&nbsp; &nbsp;last update: 144 hours ago</p><p>Running IP check ...<br />&nbsp; &nbsp; &nbsp;system ip: 2001:XXXX:XXXX:XXXX:XXXX:XXXX:f0fa<br /> registered ip: 2001:XXXX:XXXX:XXXX:XXXX:XXXX:f0fa<br />update necessary, performing update ...<br />update command: /usr/bin/wget -nv -O - -6 --no-check-certificate&nbsp; <a href="https://ayankeeindixie.com">https://ayankeeindixie.com</a>:mypassword@dyn.dns.he.net/nic/update?hostname=ayankeeindixie.com&amp;myip=2001:XXXX:XXXX:XXXX:XXXX:XXXX:f0fa</p><p>Update failed (4):<br />Unable to establish SSL connection.<br />retry #1 in 60 seconds - CurrentIP: 2001:XXXX:XXXX:XXXX:XXXX:XXXX:f0fa - RegisteredIP: 2001:XXXX:XXXX:XXXX:XXXX:XXXX:f0fa</p><p>Running IP check ...<br />&nbsp; &nbsp; &nbsp;system ip: 2001:XXXX:XXXX:XXXX:XXXX:XXXX:f0fa<br /> registered ip: 2001:XXXX:XXXX:XXXX:XXXX:XXXX:f0fa<br />update necessary, performing update ...<br />update command: /usr/bin/wget -nv -O - -6 --no-check-certificate&nbsp; <a href="https://ayankeeindixie.com">https://ayankeeindixie.com</a>:mypassword@dyn.dns.he.net/nic/update?hostname=ayankeeindixie.com&amp;myip=2001:XXXX:XXXX:XXXX:XXXX:XXXX:f0fa</p><p>Verify IP update in 60 seconds ...</p><p>Registered IP: 2001:XXXX:XXXX:XXXX:XXXX:XXXX:f0fa<br />Update Output:<br />WARNING: cannot verify dyn.dns.he.net&#039;s certificate, issued by &#039;/C=US/ST=CA/L=Fremont/O=Hurricane Electric/OU=Secure Services/CN=dyn.dns.he.net/emailAddress=dnsadmin@he.net&#039;:<br />&nbsp; Self-signed certificate encountered.<br />WARNING: cannot verify dyn.dns.he.net&#039;s certificate, issued by &#039;/C=US/ST=CA/L=Fremont/O=Hurricane Electric/OU=Secure Services/CN=dyn.dns.he.net/emailAddress=dnsadmin@he.net&#039;:<br />&nbsp; Self-signed certificate encountered.<br />good 2001:XXXX:XXXX:XXXX:XXXX:XXXX:f0fa2014-07-22 17:48:28 URL:https://ayankeeindixie.com:mypassword@dyn.dns.he.net/nic/update?hostname=ayankeeindixie.com&amp;myip=2001:XXXX:XXXX:XXXX:XXXX:XXXX:f0fa [43/43] -&gt; &quot;-&quot; [1]<br />update complete, time is: Tue Jul 22 17:49:28 CDT 2014</p><p>You can see that the first time it runs, after a reboot, it correctly updates the address.&nbsp; (Yes I do have use https enabled, with the IGNORE option.)</p><p>I hope this is the info you were looking for and I hope it helps.</p><p>Edited to say<br />I just reread your questions again.&nbsp; The information above about Luci was from the Services Dynamic DNS page.&nbsp; I missed the part about the Overview page.</p><p>On the Overview page, from left to right:&nbsp; Configuration shows myddns; Next Update shows time counting down until the next forced update; Domain shows the domain name I have entered; Registered IP shows the address of my wan6 interface; Network shows IPv6/wan6.</p>											<p class="post-edited">(Last edited by <strong>billmc</strong> on 23 Jul 2014, 02:35)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p241129">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">billmc</div>
					<div class="post-datetime">
						23 Jul 2014, 03:03					</div>
				</div>
				<div class="post-content content">
					<p>After rebooting the router and starting the script from the command line, I let it run awhile.&nbsp; This is the output.&nbsp; Note, I did not change the address in the HE nameserver.</p><br /><p>root@OpenWrt ddns# ./dynamic_dns_updater.sh myddns 1</p><p>&nbsp; &nbsp;update_prog: /usr/bin/wget -nv -O - -6 --no-check-certificate <br />&nbsp; &nbsp; update_url: https://[DOMAIN]:[PASSWORD]@dyn.dns.he.net/nic/update?hostname=[DOMAIN]&amp;myip=[IP]<br />force interval: 259200 seconds<br />check interval: 600 seconds<br />retry interval: 60 seconds<br /> retry counter: 5 times<br />&nbsp; &nbsp;last update: 144 hours ago</p><p>Running IP check ...<br />&nbsp; &nbsp; &nbsp;system ip: 2001:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:f0fa<br /> registered ip: 2001:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:f0fa<br />update necessary, performing update ...<br />update command: /usr/bin/wget -nv -O - -6 --no-check-certificate&nbsp; <a href="https://ayankeeindixie.com">https://ayankeeindixie.com</a>:flv75zsg@dyn.dns.he.net/nic/update?hostname=ayankeeindixie.com&amp;myip=2001:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:f0fa</p><p>Update failed (4):<br />Unable to establish SSL connection.<br />retry #1 in 60 seconds - CurrentIP: 2001:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:f0fa - RegisteredIP: 2001:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:f0fa</p><p>Running IP check ...<br />&nbsp; &nbsp; &nbsp;system ip: 2001:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:f0fa<br /> registered ip: 2001:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:f0fa<br />update necessary, performing update ...<br />update command: /usr/bin/wget -nv -O - -6 --no-check-certificate&nbsp; <a href="https://ayankeeindixie.com">https://ayankeeindixie.com</a>:flv75zsg@dyn.dns.he.net/nic/update?hostname=ayankeeindixie.com&amp;myip=2001:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:f0fa</p><p>Verify IP update in 60 seconds ...</p><p>Registered IP: 2001:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:f0fa<br />Update Output:<br />WARNING: cannot verify dyn.dns.he.net&#039;s certificate, issued by &#039;/C=US/ST=CA/L=Fremont/O=Hurricane Electric/OU=Secure Services/CN=dyn.dns.he.net/emailAddress=dnsadmin@he.net&#039;:<br />&nbsp; Self-signed certificate encountered.<br />WARNING: cannot verify dyn.dns.he.net&#039;s certificate, issued by &#039;/C=US/ST=CA/L=Fremont/O=Hurricane Electric/OU=Secure Services/CN=dyn.dns.he.net/emailAddress=dnsadmin@he.net&#039;:<br />&nbsp; Self-signed certificate encountered.<br />good 2001:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:f0fa2014-07-22 17:48:28 URL:https://ayankeeindixie.com:flv75zsg@dyn.dns.he.net/nic/update?hostname=ayankeeindixie.com&amp;myip=2001:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:f0fa [43/43] -&gt; &quot;-&quot; [1]<br />update complete, time is: Tue Jul 22 17:49:28 CDT 2014</p><br /><p>Running IP check ...<br />&nbsp; &nbsp; &nbsp;system ip: 2001:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:f0fa<br /> registered ip: 2001:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:f0fa<br />update unnecessary<br />time since last update = 0 hours<br />the time is now Tue Jul 22 17:59:28 CDT 2014</p><p>Running IP check ...<br />&nbsp; &nbsp; &nbsp;system ip: 2001:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:f0fa<br /> registered ip: 2001:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:f0fa<br />update unnecessary<br />time since last update = 0 hours<br />the time is now Tue Jul 22 18:09:29 CDT 2014</p><p>Running IP check ...<br />&nbsp; &nbsp; &nbsp;system ip: 2001:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:f0fa<br /> registered ip: 2001:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:f0fa<br />update unnecessary<br />time since last update = 0 hours<br />the time is now Tue Jul 22 18:19:29 CDT 2014</p><p>Running IP check ...<br />&nbsp; &nbsp; &nbsp;system ip: 2001:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:f0fa<br /> registered ip: 2001:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:f0fa<br />update unnecessary<br />time since last update = 0 hours<br />the time is now Tue Jul 22 18:29:29 CDT 2014</p><p>Running IP check ...<br />&nbsp; &nbsp; &nbsp;system ip: 2001:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:f0fa<br /> registered ip: 2001:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:f0fa<br />update unnecessary<br />time since last update = 0 hours<br />the time is now Tue Jul 22 18:39:29 CDT 2014</p><p>Running IP check ...<br />&nbsp; &nbsp; &nbsp;system ip: 2001:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:f0fa<br /> registered ip: 2001:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:f0fa<br />update unnecessary<br />time since last update = 1 hours<br />the time is now Tue Jul 22 18:49:29 CDT 2014</p><p>Running IP check ...<br />&nbsp; &nbsp; &nbsp;system ip: 2001:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:f0fa<br /> registered ip: 2001:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:f0fa<br />update unnecessary<br />time since last update = 1 hours<br />the time is now Tue Jul 22 18:59:29 CDT 2014</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p241217">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">chris5560</div>
					<div class="post-datetime">
						23 Jul 2014, 21:49					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>there are still some things I did not understand:<br />- Where did your local wan6 interface get it&#039;s address from (DHCP or static) ?<br />&nbsp; &nbsp; - I never see a change on it inside your post<br />- What is your IPv6 inside LuCI Status-Overview-IPv6 WAN Status ?<br />- Did local addr change, if you change the record at he.net ?<br />&nbsp; &nbsp; - it not looks like !</p><p>Looking on the outputs you send, everything looks fine.<br />Your local address on the interface is detected as ..:f0fa<br />Your address in the internet is also detected as ..:f0fa (except he.net where you change by hand)<br />so there is no update needed.</p><p>try to use an independend public DNS-Server in your settings like<br />&nbsp; &nbsp; google-public-dns-a.google.com<br />&nbsp; &nbsp; google-public-dns-b.google.com</p><p>After reboot an update is forced because update time is stored inside local file after successful update <br />&nbsp; &nbsp; /var/run/dynamic_dns/$SERVICE_ID.update.<br />Because /var linked to /tmp by default and mounted to tmpfs (Memory) this file is lost on reboot.</p><p>By the way: you should change your password at he.net because you publish it with your postings inside the update string.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p241251">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">billmc</div>
					<div class="post-datetime">
						24 Jul 2014, 06:31					</div>
				</div>
				<div class="post-content content">
					<p>Chris,</p><p>- Where did your local wan6 interface get it&#039;s address from (DHCP or static) ?<br />My local wan6 address.&nbsp; My ISP does not use DHCPv6, but they do issue a /61 prefix.&nbsp; In Luci, these are my settings for wan6:<br />Protocol - DHCPv6 client; Request IPv6-address - try; Request IPv6-prefix of length - automatic</p><p>So where does my address come from?&nbsp; I&#039;m not sure, I would guess its SLACC because DHCP is not offered.</p><p>- I never see a change on it inside your post<br />My local address never did change.&nbsp; I manually changed the address on the HE server.&nbsp; I&#039;ve made the assumption, which might be wrong, that the address in the nameserver would be compared to the address of the interface.&nbsp; If they did not match, then an update would be initiated.&nbsp; Its easier for me to change the address on the nameserver, so that&#039;s what I did.</p><br /><p>- What is your IPv6 inside LuCI Status-Overview-IPv6 WAN Status?<br />The IPv6 address displayed in the Status Overview equals the address that is displayed under Network Interfaces which equals the address returned by ifstatus wan6 which equals the address displayed by the update script.</p><p>- Did local addr change, if you change the record at he.net ?<br />&nbsp; &nbsp; - it not looks like !<br />The local address never changed.&nbsp; With a reboot, the address at the HE server would be changed to match the local address.</p><p>Thanks for the reminder about the password, I remembered to filter it in the first post, but forgot to do it in the second.</p><br /><br /><p>Let me ask you a question.&nbsp; As I said I&#039;m not good with scripting, but you do have good comments, so at least I could understand what was suppose to happen.<br />$dns_server, where does this value come from?&nbsp; The only place I can see where it might be defined is #config_get dns_server&nbsp; &nbsp; $SERVICE_ID&nbsp; &nbsp; dns_server&nbsp; &nbsp; ### NEW ###.</p><p>I ask because of my assumption of the local address being compared to the HE nameserver.&nbsp; I had the domain name specified in the local dnsmasq.&nbsp; I think I may have also had it to be set as authoritative.</p><p>Below, the system ip does not match the registered ip; but the system ip does match the ip contained in the nameserver.&nbsp; So I guess maybe a better question would be, Where does the Registered IP come from?</p><p>I have since set dnsmasq to the default setting.&nbsp; Today my address is different from the posts yesterday (router has been rebooted numerous times and re-flashed).&nbsp; For this post, I ran nslookup on my laptop, while at the same time started the update script on the router.&nbsp; Here are the results:</p><p>(in this case it picked up the local address, so I assume it was answered by dnsmasq.&nbsp; dnsmasq configured as default.)<br /># nslookup<br />&gt; set q=any<br />&gt; ayankeeindixie.com<br />Server:&nbsp; &nbsp; &nbsp; &nbsp; 2001:xxxx:xxxx:7d8::1<br />Address:&nbsp; &nbsp; 2001:xxxx:xxxx:7d8::1#53</p><p>Non-authoritative answer:<br />ayankeeindixie.com<br />&nbsp; &nbsp; origin = ns1.he.net<br />&nbsp; &nbsp; mail addr = hostmaster.he.net<br />&nbsp; &nbsp; serial = 2014072301<br />&nbsp; &nbsp; refresh = 10800<br />&nbsp; &nbsp; retry = 1800<br />&nbsp; &nbsp; expire = 604800<br />&nbsp; &nbsp; minimum = 86400<br />ayankeeindixie.com&nbsp; &nbsp; has AAAA address 2001:xxxx:xxxx:7d0:xxxx:xxxx:xxxx:f0fa<br />ayankeeindixie.com&nbsp; &nbsp; nameserver = ns1.he.net.<br />ayankeeindixie.com&nbsp; &nbsp; nameserver = ns2.he.net.<br />ayankeeindixie.com&nbsp; &nbsp; nameserver = ns3.he.net.<br />ayankeeindixie.com&nbsp; &nbsp; nameserver = ns4.he.net.<br />ayankeeindixie.com&nbsp; &nbsp; nameserver = ns5.he.net.</p><p>Authoritative answers can be found from:<br />ayankeeindixie.com&nbsp; &nbsp; nameserver = ns5.he.net.<br />ayankeeindixie.com&nbsp; &nbsp; nameserver = ns1.he.net.<br />ayankeeindixie.com&nbsp; &nbsp; nameserver = ns2.he.net.<br />ayankeeindixie.com&nbsp; &nbsp; nameserver = ns3.he.net.<br />ayankeeindixie.com&nbsp; &nbsp; nameserver = ns4.he.net.<br />ns1.he.net&nbsp; &nbsp; internet address = 216.218.130.2<br />ns2.he.net&nbsp; &nbsp; internet address = 216.218.131.2<br />ns2.he.net&nbsp; &nbsp; has AAAA address 2001:470:200::2<br />ns3.he.net&nbsp; &nbsp; internet address = 216.218.132.2<br />ns3.he.net&nbsp; &nbsp; has AAAA address 2001:470:300::2<br />ns4.he.net&nbsp; &nbsp; internet address = 216.66.1.2<br />ns4.he.net&nbsp; &nbsp; has AAAA address 2001:470:400::2<br />ns5.he.net&nbsp; &nbsp; internet address = 216.66.80.18<br />ns5.he.net&nbsp; &nbsp; has AAAA address 2001:470:500::2</p><br /><p>root@OpenWrt ddns# date;./dynamic_dns_updater.sh myddns 1<br />Wed Jul 23 21:47:34 CDT 2014</p><p>&nbsp; &nbsp;update_prog: /usr/bin/wget -nv -O - -6 --no-check-certificate <br />&nbsp; &nbsp; update_url: https://[DOMAIN]:[PASSWORD]@dyn.dns.he.net/nic/update?hostname=[DOMAIN]&amp;myip=[IP]<br />force interval: 259200 seconds<br />check interval: 600 seconds<br />retry interval: 60 seconds<br /> retry counter: 5 times<br />old Process Id: <br />&nbsp; &nbsp;last update: 144 hours ago</p><p>Running IP check ...<br />&nbsp; &nbsp; &nbsp;system ip: 2001:xxxx:xxxx:7d0:xxxx:xxxx:xxxx:f0fa<br /> registered ip: 2001:xxxx:xxxx:3560:xxxx:xxxx:xxxx:f0fa<br />update necessary, performing update ...<br />update command: /usr/bin/wget -nv -O - -6 --no-check-certificate&nbsp; <a href="https://ayankeeindixie.com">https://ayankeeindixie.com</a>:mypassword@dyn.dns.he.net/nic/update?hostname=ayankeeindixie.com&amp;myip=2001:xxxx:xxxx:7d0:xxxx:xxxx:xxxx:f0fa</p><p>Verify IP update in 60 seconds ...<br />Update failed (0):<br />WARNING: cannot verify dyn.dns.he.net&#039;s certificate, issued by &#039;/C=US/ST=CA/L=Fremont/O=Hurricane Electric/OU=Secure Services/CN=dyn.dns.he.net/emailAddress=dnsadmin@he.net&#039;:<br />&nbsp; Self-signed certificate encountered.<br />WARNING: cannot verify dyn.dns.he.net&#039;s certificate, issued by &#039;/C=US/ST=CA/L=Fremont/O=Hurricane Electric/OU=Secure Services/CN=dyn.dns.he.net/emailAddress=dnsadmin@he.net&#039;:<br />&nbsp; Self-signed certificate encountered.<br />nochg 2001:xxxx:xxxx:7d0:xxxx:xxxx:xxxx:f0fa2014-07-23 21:48:01 URL:https://ayankeeindixie.com:mypassword@dyn.dns.he.net/nic/update?hostname=ayankeeindixie.com&amp;myip=2001:xxxx:xxxx:7d0:xxxx:xxxx:xxxx:f0fa [43/43] -&gt; &quot;-&quot; [2]<br />retry #1 in 60 seconds - CurrentIP: 2001:xxxx:xxxx:7d0:xxxx:xxxx:xxxx:f0fa - RegisteredIP: 2001:xxxx:xxxx:3560:xxxx:xxxx:xxxx:f0fa</p><p>Running IP check ...<br />&nbsp; &nbsp; &nbsp;system ip: 2001:xxxx:xxxx:7d0:xxxx:xxxx:xxxx:f0fa<br /> registered ip: 2001:xxxx:xxxx:3560:xxxx:xxxx:xxxx:f0fa<br />update necessary, performing update ...<br />update command: /usr/bin/wget -nv -O - -6 --no-check-certificate&nbsp; <a href="https://ayankeeindixie.com">https://ayankeeindixie.com</a>:mypassword@dyn.dns.he.net/nic/update?hostname=ayankeeindixie.com&amp;myip=2001:xxxx:xxxx:7d0:xxxx:xxxx:xxxx:f0fa</p><p>Verify IP update in 60 seconds ...<br />Update failed (0):<br />WARNING: cannot verify dyn.dns.he.net&#039;s certificate, issued by &#039;/C=US/ST=CA/L=Fremont/O=Hurricane Electric/OU=Secure Services/CN=dyn.dns.he.net/emailAddress=dnsadmin@he.net&#039;:<br />&nbsp; Self-signed certificate encountered.<br />WARNING: cannot verify dyn.dns.he.net&#039;s certificate, issued by &#039;/C=US/ST=CA/L=Fremont/O=Hurricane Electric/OU=Secure Services/CN=dyn.dns.he.net/emailAddress=dnsadmin@he.net&#039;:<br />&nbsp; Self-signed certificate encountered.<br />nochg 2001:xxxx:xxxx:7d0:xxxx:xxxx:xxxx:f0fa2014-07-23 21:50:48 URL:https://ayankeeindixie.com:mypassword@dyn.dns.he.net/nic/update?hostname=ayankeeindixie.com&amp;myip=2001:xxxx:xxxx:7d0:xxxx:xxxx:xxxx:f0fa [43/43] -&gt; &quot;-&quot; [1]<br />retry #2 in 60 seconds - CurrentIP: 2001:xxxx:xxxx:7d0:xxxx:xxxx:xxxx:f0fa - RegisteredIP: 2001:xxxx:xxxx:3560:xxxx:xxxx:xxxx:f0fa</p><p>Running IP check ...<br />&nbsp; &nbsp; &nbsp;system ip: 2001:xxxx:xxxx:7d0:xxxx:xxxx:xxxx:f0fa<br /> registered ip: 2001:xxxx:xxxx:3560:xxxx:xxxx:xxxx:f0fa<br />update necessary, performing update ...<br />update command: /usr/bin/wget -nv -O - -6 --no-check-certificate&nbsp; <a href="https://ayankeeindixie.com">https://ayankeeindixie.com</a>:mypassword@dyn.dns.he.net/nic/update?hostname=ayankeeindixie.com&amp;myip=2001:xxxx:xxxx:7d0:xxxx:xxxx:xxxx:f0fa</p><p>Verify IP update in 60 seconds ...<br />Update failed (0):<br />WARNING: cannot verify dyn.dns.he.net&#039;s certificate, issued by &#039;/C=US/ST=CA/L=Fremont/O=Hurricane Electric/OU=Secure Services/CN=dyn.dns.he.net/emailAddress=dnsadmin@he.net&#039;:<br />&nbsp; Self-signed certificate encountered.<br />WARNING: cannot verify dyn.dns.he.net&#039;s certificate, issued by &#039;/C=US/ST=CA/L=Fremont/O=Hurricane Electric/OU=Secure Services/CN=dyn.dns.he.net/emailAddress=dnsadmin@he.net&#039;:<br />&nbsp; Self-signed certificate encountered.<br />nochg 2001:xxxx:xxxx:7d0:xxxx:xxxx:xxxx:f0fa2014-07-23 21:53:35 URL:https://ayankeeindixie.com:mypassword@dyn.dns.he.net/nic/update?hostname=ayankeeindixie.com&amp;myip=2001:xxxx:xxxx:7d0:xxxx:xxxx:xxxx:f0fa [43/43] -&gt; &quot;-&quot; [1]<br />retry #3 in 60 seconds - CurrentIP: 2001:xxxx:xxxx:7d0:xxxx:xxxx:xxxx:f0fa - RegisteredIP: 2001:xxxx:xxxx:3560:c63d5:c7ff:fe97:f0fa</p><p>Running IP check ...<br />&nbsp; &nbsp; &nbsp;system ip: 2001:xxxx:xxxx:7d0:xxxx:xxxx:xxxx:f0fa<br /> registered ip: 2001:xxxx:xxxx:3560:xxxx:xxxx:xxxx:f0fa<br />update necessary, performing update ...<br />update command: /usr/bin/wget -nv -O - -6 --no-check-certificate&nbsp; <a href="https://ayankeeindixie.com">https://ayankeeindixie.com</a>:mypassword@dyn.dns.he.net/nic/update?hostname=ayankeeindixie.com&amp;myip=2001:xxxx:xxxx:7d0:xxxx:xxxx:xxxx:f0fa</p><p>Verify IP update in 60 seconds ...<br />Update failed (0):<br />WARNING: cannot verify dyn.dns.he.net&#039;s certificate, issued by &#039;/C=US/ST=CA/L=Fremont/O=Hurricane Electric/OU=Secure Services/CN=dyn.dns.he.net/emailAddress=dnsadmin@he.net&#039;:<br />&nbsp; Self-signed certificate encountered.<br />WARNING: cannot verify dyn.dns.he.net&#039;s certificate, issued by &#039;/C=US/ST=CA/L=Fremont/O=Hurricane Electric/OU=Secure Services/CN=dyn.dns.he.net/emailAddress=dnsadmin@he.net&#039;:<br />&nbsp; Self-signed certificate encountered.<br />nochg 2001:xxxx:xxxx:7d0:xxxx:xxxx:xxxx:f0fa2014-07-23 21:56:24 URL:https://ayankeeindixie.com:mypassword@dyn.dns.he.net/nic/update?hostname=ayankeeindixie.com&amp;myip=2001:xxxx:xxxx:7d0:xxxx:xxxx:xxxx:f0fa [43/43] -&gt; &quot;-&quot; [3]<br />retry #4 in 60 seconds - CurrentIP: 2001:xxxx:xxxx:7d0:xxxx:xxxx:xxxx:f0fa - RegisteredIP: 2001:xxxx:xxxx:3560:xxxx:xxxx:xxxx:f0fa</p><p>Running IP check ...<br />&nbsp; &nbsp; &nbsp;system ip: 2001:b0:2d5a:7d0:xxxx:xxxx:xxxx:f0fa<br /> registered ip: 2001:xxxx:xxxx:3560:xxxx:xxxx:xxxx:f0fa<br />update necessary, performing update ...<br />update command: /usr/bin/wget -nv -O - -6 --no-check-certificate&nbsp; <a href="https://ayankeeindixie.com">https://ayankeeindixie.com</a>:mypassword@dyn.dns.he.net/nic/update?hostname=ayankeeindixie.com&amp;myip=2001:xxxx:xxxx:7d0:xxxx:xxxx:xxxx:f0fa</p><p>Verify IP update in 60 seconds ...<br />Update failed (0):<br />WARNING: cannot verify dyn.dns.he.net&#039;s certificate, issued by &#039;/C=US/ST=CA/L=Fremont/O=Hurricane Electric/OU=Secure Services/CN=dyn.dns.he.net/emailAddress=dnsadmin@he.net&#039;:<br />&nbsp; Self-signed certificate encountered.<br />WARNING: cannot verify dyn.dns.he.net&#039;s certificate, issued by &#039;/C=US/ST=CA/L=Fremont/O=Hurricane Electric/OU=Secure Services/CN=dyn.dns.he.net/emailAddress=dnsadmin@he.net&#039;:<br />&nbsp; Self-signed certificate encountered.<br />nochg 2001:xxxx:xxxx:7d0:xxxx:xxxx:xxxx:f0fa2014-07-23 21:59:12 URL:https://ayankeeindixie.com:mypassword@dyn.dns.he.net/nic/update?hostname=ayankeeindixie.com&amp;myip=2001:xxxx:xxxx:7d0:xxxx:xxxx:xxxx:f0fa [43/43] -&gt; &quot;-&quot; [1]<br />retry #5 in 60 seconds - CurrentIP: 2001:xxxx:xxxx:7d0:xxxx:xxxx:xxxx:f0fa - RegisteredIP: 2001:xxxx:xxxx:3560:xxxx:xxxx:xxxx:f0fa</p><p>Running IP check ...<br />&nbsp; &nbsp; &nbsp;system ip: 2001:xxxx:xxxx:7d0:xxxx:xxxx:xxxx:f0fa<br /> registered ip: 2001:xxxx:xxxx:3560:xxxx:xxxx:xxxx:f0fa<br />update necessary, performing update ...<br />update command: /usr/bin/wget -nv -O - -6 --no-check-certificate&nbsp; <a href="https://ayankeeindixie.com">https://ayankeeindixie.com</a>:mypassword@dyn.dns.he.net/nic/update?hostname=ayankeeindixie.com&amp;myip=2001:xxxx:xxxx:7d0:xxxx:xxxx:xxxx:f0fa</p><p>Verify IP update in 60 seconds ...<br />CRITICAL ERROR - Update Error (0) - CurrentIP: 2001:xxxx:xxxx:7d0:xxxx:xxxx:xxxx:f0fa - RegisteredIP: 2001:xxxx:xxxx:3560:xxxx:xxxx:xxxx:f0fa - EXITING<br />root@OpenWrt ddns#</p><p>The reason this update is failing is because the Registered IP is not changing.&nbsp; The IP address of the wan6 interface equals the address that is in the HE nameservers.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p241267">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">chris5560</div>
					<div class="post-datetime">
						24 Jul 2014, 10:15					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>the new parameter dns_server in /etc/config/ddns which can be set via LuCI interface<br />is read by the script and used when trying to detect the registered IP<br />&nbsp; &nbsp; REGISTERED_IP=$(nslookup $domain $dns_server 2&gt;/dev/null | .......<br />It defines the DNS server to use for nslookup instead the one defined as default on the local system.</p><p>I think the first thing to check is (without scripts) what happen if you change by hand your ip at he.net<br />- how long does it take, until &quot;nslookup ayankeeindixie.com google-public-dns-a.google.com&quot; shows &quot;new&quot; address?<br />- are there any entrys inside he.net&#039;s error logs?<br />&nbsp; &nbsp; many ddns provider block updates, if there are send more then &quot;x&quot; updates in interval &quot;y&quot; </p><p>You can try to change your ip without script by &quot;wget&quot; as you see in verbose_log (update command):<br /> &gt;/usr/bin/wget -nv -O - -6 --no-check-certificate <a href="https://ayankeeindixie.com">https://ayankeeindixie.com</a>:mypassword@dyn.dns.he.net/nic/update?hostname=ayankeeindixie.com&amp;myip=2001:xxxx:xxxx:7d0:xxxx:xxxx:xxxx:f0fa<br />All in one line without space between ...he.net/nic/update...</p><p>Normally he.net should accept any IPv6 address you like to send.<br />In theory he.net should accept i.e. Google&#039;s IPv6 address, because nothing goes wrong in the net.<br />The only thing happen is that anybody trying to connect to ayankeeindixie.com will go to Googles Servers.<br />So please check if he.net accept updates via wget to the IPv6 you like.<br />Check the time how long it takes until the rest of internet shows the changes.</p><p>You could run wget on the console of you router an monitor changes inside LuCI-System-Overview-DynamicDNS.<br />RegisteredIP is reread every 5 seconds with the same nslookup and $dns_server as the script does,<br />no matter if ddns-service is enabled or script is running.<br />- stop and disable ddns (so a change on interfacce or config could not start script)<br />&nbsp; &nbsp; &gt;/etc/init.d/ddns stop<br />&nbsp; &nbsp; &gt;/etc/init.d/ddns disable<br />&nbsp; &nbsp; or via LuCI System-Startup<br />- kill all dynamic_ddns_updater scripts (there should be none after stopping ddns)<br />- setup the a dns_server of your choice inside LuCI config and save/apply (no script should start because service disabled)<br />- check if &quot;wget ...&quot; will change your registered IP to the one you send and how long does it take.</p><p>Good Luck</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p241318">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">billmc</div>
					<div class="post-datetime">
						24 Jul 2014, 19:11					</div>
				</div>
				<div class="post-content content">
					<p>Chris,</p><p>It is 11:40 as I begin to write this.&nbsp; I have thunderstorms moving in.&nbsp; One of the downsides of satellite based ISP is that it is affected by weather, causing loss of service.&nbsp; I&#039;ll post more information when I can.</p><p>I have made a mistake.&nbsp; I chose use secure http, when I was not able to update my address (I don&#039;t think I had that selected when the address did update).&nbsp; I do not know how to incorporate into the services_ipv6 file the directions from Hurricane Electric&#039;s website.&nbsp; <a href="https://dns.he.net/">https://dns.he.net/</a>&nbsp; The following comes from their site.</p><p>If you want to tell me what I should have in the services_ipv6 file for using https, I&#039;ll add that in.</p><p>HE states that their web UI is very basic for the moment.&nbsp; I don&#039;t know how to access their error logs, or if it is even possible to do that.<br />----------------------------------------------------------------------------------------------------------------------------------------------<br />Dynamic DNS Support</p><p>&nbsp; &nbsp; We&#039;ve added Dynamic DNS support!<br />&nbsp; &nbsp; We&#039;re working on smoothing out how it&#039;s represented in the UI and writing something that resembles documentation, but thought we&#039;d push out what we have so it can get a little use. It&#039;s a pretty basic implementation and should work well for most applications. It works with &#039;ddclient&#039; (or dyndns compatible clients), and with any of the command line examples. We&#039;ll update this page when the documentation is ready. (we&#039;re hoping to have it written soon...). If you have any feedback on this new feature, please send them along to &lt;dnsadmin@he.net&gt;</p><br /><p>Here are a few examples to get you started (manual testing)</p><p>http://[your domain name]:[your password]@dyn.dns.he.net/nic/update?hostname=[your domain name]</p><p>Autodetect my IPv4/IPv6 address:<br />% curl -4 &quot;http://dyn.example.com:password@dyn.dns.he.net/nic/update?hostname=dyn.example.com&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />% curl -6 &quot;http://dyn.example.com:password@dyn.dns.he.net/nic/update?hostname=dyn.example.com&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </p><p>Specify my IPv4/IPv6 address:<br />% curl &quot;http://dyn.example.com:password@dyn.dns.he.net/nic/update?hostname=dyn.example.com&amp;myip=192.168.0.1&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />% curl &quot;http://dyn.example.com:password@dyn.dns.he.net/nic/update?hostname=dyn.example.com&amp;myip=2001:db8:beef:cafe::1&quot;</p><br /><p>Here are a couple more examples that allow sending the password in the URL</p><p>Note: The username is also the hostname. The password is sent using &#039;password=&#039;. This skips HTTP basic auth.</p><p>Authentication and Updating using GET<br />% curl &quot;<a href="https://dyn.dns.he.net/nic/update?hostname=dyn.example.com&amp;password=password&amp;myip=192.168.0.1">https://dyn.dns.he.net/nic/update?hostn … 92.168.0.1</a>&quot;<br />% curl &quot;<a href="https://dyn.dns.he.net/nic/update?hostname=dyn.example.com&amp;password=password&amp;myip=2001:db8:beef:cafe::1">https://dyn.dns.he.net/nic/update?hostn … ef:cafe::1</a>&quot;</p><p>Authentication and Updating using a POST<br />% curl &quot;<a href="https://dyn.dns.he.net/nic/update">https://dyn.dns.he.net/nic/update</a>&quot; -d &quot;hostname=dyn.example.com&quot; -d &quot;password=password&quot; -d &quot;myip=192.168.0.1&quot;<br />% curl &quot;<a href="https://dyn.dns.he.net/nic/update">https://dyn.dns.he.net/nic/update</a>&quot; -d &quot;hostname=dyn.example.com&quot; -d &quot;password=password&quot; -d &quot;myip=2001:db8:beef:cafe::1&quot;</p><p>----------------------------------------------------------------------------------------------------------------------------------------------</p><p>Also, I could not find, in LuCI, the entry for dns_server.&nbsp; I think I may be introducing to many variables by using a Community Release.&nbsp; I have only the one router.&nbsp; I intend to flash the router with 14.07-rc1, so we will be working with the same software.&nbsp; I think this will eliminate other possible variables.&nbsp; Once the script has been determined to work, I can switch back to the Community Release and try again.</p><p>As I mentioned before, I&#039;m not good with scripts, but this is what I&#039;ve put together to quickly reload your information.&nbsp; Maybe you can validate it, to ensure I&#039;ve correctly followed your installation instructions.</p><p>----------------------------------------------------------------------------------------------------------------------<br />#! /bin/sh</p><p>mkdir -p /etc/config<br />mkdir -p /etc/hotplug.d/iface<br />mkdir -p /etc/uci-defaults<br />mkdir -p /usr/lib/ddns<br />mkdir -p /usr/lib/lua/luci/controller<br />mkdir -p /usr/lib/lua/luci/model/cbi/ddns<br />mkdir -p /usr/lib/lua/luci/view/admin_status/index<br />mkdir -p /usr/lib/lua/luci/view/ddns</p><p>cp etc+config-14.07-RC1/* /etc/config/<br />cp etc+hotplug.d+iface/* /etc/hotplug.d/iface/<br />cp etc+uci-defaults/* /etc/uci-defaults/<br />cp usr+lib+ddns/* /usr/lib/ddns/<br />cp usr+lib+ddns+14.07-RC1/* /usr/lib/ddns/<br />cp usr+lib+lua+luci+controller/* /usr/lib/lua/luci/controller/<br />cp usr+lib+lua+luci+model+cbi+ddns/* /usr/lib/lua/luci/model/cbi/ddns/<br />cp usr+lib+lua+luci+view+admin_status+index/* /usr/lib/lua/luci/view/admin_status/index/<br />cp usr+lib+lua+luci+view+ddns/* /usr/lib/lua/luci/view/ddns/</p><p>chmod 775 /usr/lib/ddns/*.sh<br />chmod 775 /etc/init.d/ddns<br />chmod 775 /etc/uci-defaults/luci-ddns</p><p>rm -r /tmp/luci-indexcache /tmp/luci-modulecache/*</p><p>/etc/uci-defaults/luci-ddns</p><p>opkg update<br />opkg install curl wget</p><p>------------------------------------------------------------------------------------------------------<br />I realize that in some cases I&#039;m creating directories that are already there, but I didn&#039;t think it would cause any damage.</p><br /><p>I was trying to follow your instructions from the last post, and I was having trouble.&nbsp; Possibly because of weather, possibly because of using a different build, and most likely because I did something wrong.&nbsp; Thus the reason for switching to a build that you used.</p><p>I&#039;ll let you know what happens.<br />Bill</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p241331">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">chris5560</div>
					<div class="post-datetime">
						24 Jul 2014, 21:24					</div>
				</div>
				<div class="post-content content">
					<p>Hi Bill,</p><p>I tested my LuCI and script modifications with 10.03.1, 12.09 and 14.07-rc1 images downloaded from downloads.openwrt.org, <br />so it should work with your current version if it is 10.03.1 or above.<br />No need to reflash !! &quot;(never) touch your running system&quot; if you only have ONE.</p><p>The setting for dns_server can only be reached in your settings, <br />if you edit /etc/config/ddns files putting in:<br />&nbsp; &nbsp; option dns_server &quot;dns.server.you.like&quot; or &quot;ip.address.you.like&quot;<br />Single or double quoted please see the other options listed in the file.</p><p>Opps. Thanks for testing ! I found a bug inside my LuCI file not showing DNS server to you.<br />If you want to fix yourself, delete the following two lines in /usr/lib/lua/luci/model/cbi/ddns/detail.lua<br />&nbsp; &nbsp; dns:depends(&quot;ipv4_source&quot;, &quot;web&quot;)&nbsp; &nbsp; -- IPv4<br />&nbsp; &nbsp; dns:depends(&quot;ipv6_source&quot;, &quot;web&quot;)&nbsp; &nbsp; -- or IPv6<br />or comment out with 2 -- at the beginning of the line<br />at line 587 and 588. After modify you need to <br />&gt;rm -r /tmp/luci-indexcache /tmp/luci-modulecache/*<br />to clear LuCI cashes.</p><p>The syntax of services_ipv6 is the same as in services file.<br />So you could copy the 2 lines for &quot;# Hurricane Electric Dynamic DNS&quot; into services_ipv6.<br />All entrys are setup with &quot;http://...&quot;. The change to &quot;https://...&quot; is done in the scripts (sed), if use_https enabled.</p><p>Because I googled some entrys saying that various services offer different update-urls for IPv4 and IPv6 I decided to create service_ipv6 file.<br />I don&#039;t know, if HE uses the same url for IPv4 and IPv6 updates.<br />Please verify for HE.</p><p>If you login to your HE account, there should be something like an update history or error log.<br />Check if HE blocks if there are to many updates in a given time.<br />I&#039;m using selfhost.de and spdns.de and they offer an update history showing sucess and errors and<br />selfhost.de blocks on to many updates also written in update history as error.</p><p>A word about your &quot;install script&quot;, it looks ok.<br />You need to install only one: curl or wget. <br />The script (and I) prefere wget because curl (libcurl) is compiled without proxy support in current trunk and 14.07-rc1.</p><p>Christian</p>											<p class="post-edited">(Last edited by <strong>chris5560</strong> on 24 Jul 2014, 21:29)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p241339">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">billmc</div>
					<div class="post-datetime">
						24 Jul 2014, 22:43					</div>
				</div>
				<div class="post-content content">
					<p>Chris,<br />I did find one problem with my script, I failed to copy the /etc/init.d/ddns file.&nbsp; I&#039;ve since corrected the script.</p><p>I&#039;m not really afraid of reflashing the router.&nbsp; I&#039;ve been doing it quit a bit over the past couple of weeks.&nbsp; I had already reflashed by the time I saw your last post.&nbsp; Because you say the script prefers wget, I will flash again to arokh&#039;s build.&nbsp; I receive this error when trying to install wget into the rc1 build.</p><p>BusyBox v1.22.1 (2014-07-11 02:34:04 CEST) built-in shell (ash)<br />Enter &#039;help&#039; for a list of built-in commands.</p><p>&nbsp; _______&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;________&nbsp; &nbsp; &nbsp; &nbsp; __<br /> |&nbsp; &nbsp; &nbsp; &nbsp;|.-----.-----.-----.|&nbsp; |&nbsp; |&nbsp; |.----.|&nbsp; |_<br /> |&nbsp; &nbsp;-&nbsp; &nbsp;||&nbsp; _&nbsp; |&nbsp; -__|&nbsp; &nbsp; &nbsp;||&nbsp; |&nbsp; |&nbsp; ||&nbsp; &nbsp;_||&nbsp; &nbsp;_|<br /> |_______||&nbsp; &nbsp;__|_____|__|__||________||__|&nbsp; |____|<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |__| W I R E L E S S&nbsp; &nbsp;F R E E D O M<br /> -----------------------------------------------------<br /> BARRIER BREAKER (14.07-rc1, r41580)<br /> -----------------------------------------------------<br />&nbsp; * 1/2 oz Galliano&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Pour all ingredients into<br />&nbsp; * 4 oz cold Coffee&nbsp; &nbsp; &nbsp; &nbsp; an irish coffee mug filled<br />&nbsp; * 1 1/2 oz Dark Rum&nbsp; &nbsp; &nbsp; &nbsp;with crushed ice. Stir.<br />&nbsp; * 2 tsp. Creme de Cacao<br /> -----------------------------------------------------<br />root@OpenWrt:~# uname -a<br />Linux OpenWrt 3.10.44 #3 Sat Jul 12 16:42:11 CEST 2014 mips GNU/Linux<br />root@OpenWrt:~# opkg update<br />Downloading <a href="http://downloads.openwrt.org/barrier_breaker/14.07-rc1/ar71xx/generic/packages/Packages.gz.">http://downloads.openwrt.org/barrier_br … ckages.gz.</a><br />Updated list of available packages in /var/opkg-lists/barrier_breaker.<br />root@OpenWrt:~# opkg install wget<br />Unknown package &#039;wget&#039;.<br />Collected errors:<br /> * opkg_install_cmd: Cannot install package wget.</p><p>oot@OpenWrt:/usr/lib/ddns# opkg search *wget*<br />base-files - 155-r41580<br />busybox - 1.22.1-2</p><p>From the Services page in LuCi:<br />cURL is installed, but libcurl was compiled without proxy support.<br />You should install GNU Wget or replace libcurl.<br />cURL/libcurl in OpenWrt is compiled without proxy support by default. </p><p>The script chooses to use curl, so I assume that<br />root@OpenWrt:/usr/lib/ddns# which wget<br />/usr/bin/wget<br />is not the GNU wget version.</p><p>I did not have this installation isuue with arokh&#039;s build.&nbsp; Ttrying your suggested manual commands without wget, doesn&#039;t work to well.</p><p>I did make the changes to the detail.lua file.&nbsp; Once I did that, under the advance settings tab of the DDNS configuration, I now have a box to be able to change from the default dns server.</p><p>I&#039;m still not sure what the default dns server is though.&nbsp; When I do an nslookup from either the google server or the HE server, they both show the correct address, while using the &quot;default&quot; server, the Registered IP is wrong.</p><p>I added 8.8.8.8 to the box on the advanced tab.&nbsp; When I run the script, it still shows a different registered ip.&nbsp; I also tried adding&nbsp; option dns_server &#039;google-public-dns-a.google.com&#039; to the /etc/config/ddns file manually and the registered ip still had not changed.</p><p>I need to go out this afternoon, I may not be able to get back to this until latter this evening.&nbsp; I&#039;m in the UTC-6 timezone, so I&#039;m not exactly sure how much of a time difference there is between us.</p><p>As they used to say in the military &quot;Standby to standby&quot;<br />Bill</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p241360">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">chris5560</div>
					<div class="post-datetime">
						25 Jul 2014, 01:27					</div>
				</div>
				<div class="post-content content">
					<p>Hi Bill,</p><p>I&#039;m sitting on UTC + 2 (German summertime) so 8 hours before.</p><p>I put the following entries into my ddns config file<br /></p><div class="codebox"><pre><code>config service &#039;test_nodns&#039;
        option enabled &#039;0&#039;
        option use_ipv6 &#039;1&#039;
        option domain &#039;ayankeeindixie.com&#039;
        option ip_source &#039;web&#039;
        option ip_url &#039;http://check.dyndns.com/&#039;
        option interface &#039;wan6&#039;
        option check_interval &#039;10&#039;
        option check_unit &#039;minutes&#039;
        option force_interval &#039;0&#039;
        option force_unit &#039;hours&#039;
        option retry_count &#039;1&#039;
        option retry_interval &#039;60&#039;
        option retry_unit &#039;seconds&#039;
        option use_syslog &#039;0&#039;
        option update_url &#039;http://ipv6.google.com&#039;

config service &#039;test_google&#039;
        option enabled &#039;0&#039;
        option use_ipv6 &#039;1&#039;
        option domain &#039;ayankeeindixie.com&#039;
        option ip_source &#039;web&#039;
        option ip_url &#039;http://checkipv6.dyndns.com/&#039;
        option interface &#039;wan6&#039;
        option dns_server &#039;google-public-dns-a.google.com&#039;
        option check_interval &#039;10&#039;
        option check_unit &#039;minutes&#039;
        option force_interval &#039;0&#039;
        option force_unit &#039;hours&#039;
        option retry_count &#039;1&#039;
        option retry_interval &#039;60&#039;
        option retry_unit &#039;seconds&#039;
        option use_syslog &#039;0&#039;
        option update_url &#039;http://ipv6.google.com&#039;

config service &#039;test_he&#039;
        option use_ipv6 &#039;1&#039;
        option domain &#039;ayankeeindixie.com&#039;
        option ip_source &#039;network&#039;
        option interface &#039;wan6&#039;
        option ip_network &#039;wan6&#039;
        option dns_server &#039;ns1.he.net&#039;
        option check_interval &#039;10&#039;
        option check_unit &#039;minutes&#039;
        option force_interval &#039;0&#039;
        option force_unit &#039;hours&#039;
        option retry_count &#039;1&#039;
        option retry_interval &#039;60&#039;
        option retry_unit &#039;seconds&#039;
        option use_syslog &#039;0&#039;
        option enabled &#039;0&#039;
        option update_url &#039;http://ipv6.google.com&#039;</code></pre></div><p>knowing that no update is possible.<br />Reason for this I want to check if there is a difference between LuCI Status, <br />RegisteredIP from script and from nslookup on the console or any to the router connected box.<br />There should be no difference or somthing goes wrong with nslookup.<br />The console commands:<br /></p><ul><li><p>nslookup ayankeeindixie.com</p></li><li><p>nslookup ayankeeindixie.com google-public-dns-a.google.com</p></li><li><p>nslookup ayankeeindixie.com ns1.he.net</p></li></ul><p>I test on my router and on my windows box connected all the same addresses.</p><p>From here you must continue yourself:<br />Set all option enable &#039;1&#039; by editing ddns config without LuCI and no (re)starting ddns.<br />Start the dynamic_dns_updater.sh from the console.<br />Have a look on RegisteredIP and CurrentIP output.<br />test_nodns&nbsp; should show RegisteredIP from above nslookup and<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; no CurrentIP and break with error &quot;could not detect current ip&quot; or something like that<br />test_google should show RegisteredIP from above nslookup and<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; hopefully CurrentIP is the same it is taken by the script with wget -O - <a href="http://checkipv6.dyndns.com/">http://checkipv6.dyndns.com/</a><br />test_he&nbsp; &nbsp;&nbsp; &nbsp; &nbsp;should show RegisteredIP from above nslookup and<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; and CurrentIP as currently configured on you wan6 interface (LuCI Status-Overview-IPv6 WAN Status)</p><p>Where is the difference ? If everything is fine here we could go the next steps.</p><p>For the curl/wget problem on 14.07.rc1 remove libcurl from LuCI System-Software it will also remove curl.<br />Download wget from trunk to your router (link for netgear wndr3700/wndr3800)<br />- <a href="http://downloads.openwrt.org/snapshots/trunk/ar71xx/packages/wget_1.15-1_ar71xx.ipk">http://downloads.openwrt.org/snapshots/ … ar71xx.ipk</a><br />change to download dir and type<br /></p><ul><li><p>rm -R /tmp/wget*</p></li><li><p>rm -R /var/log/wget*</p></li><li><p>rm -R /var/opkg-lists/*</p></li><li><p>opkg install ./wget_1.15-1_ar71xx.ipk</p></li></ul><p>Thanks for testing we need to test now step by step because I currently don&#039;t see where to look for the problem.</p><p>Christian</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p241394">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">billmc</div>
					<div class="post-datetime">
						25 Jul 2014, 07:01					</div>
				</div>
				<div class="post-content content">
					<p>Chris,</p><p>Below, you will see that all three nslookup run from the openwrt console, report the same address.&nbsp; This is the address that is current in the HE nameservers.&nbsp; This address always appears as the registered ip.&nbsp; This is the address my router had yesterday.&nbsp; It is not the current address of the router.&nbsp; Only the test_he correctly reports the current ip of the routers wan6.</p><p>Running nslookup from my Linux laptop, it querries dnsmasq on the router and can&#039;t find a listing.</p><p>I ran ifstatus wan6 so you could see the actual address.&nbsp; I think I know where the problem is.&nbsp; It has to do with either option ip_url or option update_url.&nbsp; Because option ip_url is not in all 3 test cases, I&#039;ll suspect it is option update_url.</p><p>Is this a case that is unique to Hughes or not, I can&#039;t say.&nbsp; But if you recall, I mentioned that Hughes sends all their http(s) traffic through a proxy.&nbsp; So asking any site via http for an address, will return the address of the proxy.&nbsp; I am going to disable the Hughes proxy and try running the three tests again.</p><p>root@OpenWrt ddns# nslookup ayankeeindixie.com<br />Server:&nbsp; &nbsp; 127.0.0.1<br />Address 1: 127.0.0.1 localhost</p><p>Name:&nbsp; &nbsp; &nbsp; ayankeeindixie.com<br />Address 1: 2001:5b0:2d5a:7d0:c63d:c7ff:fe97:f0fa<br />root@OpenWrt ddns# nslookup ayankeeindixie.com google-public-dns-a.google.com<br />Server:&nbsp; &nbsp; 8.8.8.8<br />Address 1: 8.8.8.8 google-public-dns-a.google.com</p><p>Name:&nbsp; &nbsp; &nbsp; ayankeeindixie.com<br />Address 1: 2001:5b0:2d5a:7d0:c63d:c7ff:fe97:f0fa<br />root@OpenWrt ddns# nslookup ayankeeindixie.com ns1.he.net<br />Server:&nbsp; &nbsp; 216.218.130.2<br />Address 1: 216.218.130.2 ns1.he.net</p><p>Name:&nbsp; &nbsp; &nbsp; ayankeeindixie.com<br />Address 1: 2001:5b0:2d5a:7d0:c63d:c7ff:fe97:f0fa<br />root@OpenWrt ddns# </p><br /><p>I&#039;m running Linux Mint Debian Edition (LMDE) on my laptop.&nbsp; It is supposed to be equvalent to Debian Testing.</p><p>bill@sligo:~$ nslookup ayankeeindixie.com<br />Server:&nbsp; &nbsp; &nbsp; &nbsp; 192.168.1.1<br />Address:&nbsp; &nbsp; 192.168.1.1#53</p><p>Non-authoritative answer:<br />*** Can&#039;t find ayankeeindixie.com: No answer</p><p>bill@sligo:~$ nslookup ayankeeindixie.com google-public-dns-a.google.com<br />Server:&nbsp; &nbsp; &nbsp; &nbsp; google-public-dns-a.google.com<br />Address:&nbsp; &nbsp; 8.8.8.8#53</p><p>Non-authoritative answer:<br />*** Can&#039;t find ayankeeindixie.com: No answer</p><p>bill@sligo:~$ nslookup ayankeeindixie.com ns1.he.net<br />Server:&nbsp; &nbsp; &nbsp; &nbsp; ns1.he.net<br />Address:&nbsp; &nbsp; 216.218.130.2#53</p><p>Non-authoritative answer:<br />*** Can&#039;t find ayankeeindixie.com: No answer</p><p>Extra step to verify my wan6 address</p><p>root@OpenWrt config# ifstatus wan6<br />{<br />&nbsp; &nbsp; &quot;up&quot;: true,<br />&nbsp; &nbsp; &quot;pending&quot;: false,<br />&nbsp; &nbsp; &quot;available&quot;: true,<br />&nbsp; &nbsp; &quot;autostart&quot;: true,<br />&nbsp; &nbsp; &quot;uptime&quot;: 20323,<br />&nbsp; &nbsp; &quot;l3_device&quot;: &quot;eth1&quot;,<br />&nbsp; &nbsp; &quot;proto&quot;: &quot;dhcpv6&quot;,<br />&nbsp; &nbsp; &quot;device&quot;: &quot;eth1&quot;,<br />&nbsp; &nbsp; &quot;updated&quot;: [<br />&nbsp; &nbsp; &nbsp; &nbsp; &quot;routes&quot;<br />&nbsp; &nbsp; ],<br />&nbsp; &nbsp; &quot;metric&quot;: 0,<br />&nbsp; &nbsp; &quot;delegation&quot;: true,<br />&nbsp; &nbsp; &quot;ipv4-address&quot;: [<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; ],<br />&nbsp; &nbsp; &quot;ipv6-address&quot;: [<br />&nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;address&quot;: &quot;2001:5b0:2d5a:f380:c63d:c7ff:fe97:f0fa&quot;,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;mask&quot;: 64,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;preferred&quot;: 13,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;valid&quot;: 283<br />&nbsp; &nbsp; &nbsp; &nbsp; },</p><p>I&#039;ve mv ddns to ddns.orig.<br />I&#039;ve copied your file into my /etc/config/ddns<br />I used vi to edit /etc/config/ddns to change option enabled &#039;1&#039; in all three sections.<br />I have not stopped, started, or otherwise ddns.</p><br /><p>root@OpenWrt ddns# ./dynamic_dns_updater.sh test_nodns 1</p><p>&nbsp; &nbsp;update_prog: /usr/bin/wget -nv -O - -6<br />&nbsp; &nbsp; update_url: <a href="http://ipv6.google.com">http://ipv6.google.com</a><br />force interval: 0 seconds<br />check interval: 600 seconds<br />retry interval: 60 seconds<br /> retry counter: 1 times<br />&nbsp; &nbsp;last update: 0 hours ago</p><p>Running IP check ...<br />&nbsp; &nbsp; &nbsp;system ip: 2001:5b0:2d5a:f380:280:aeff:fe3f:44b4<br /> registered ip: 2001:5b0:2d5a:7d0:c63d:c7ff:fe97:f0fa<br />update necessary, performing update ...<br />update command: /usr/bin/wget -nv -O - -6 <a href="http://ipv6.google.com">http://ipv6.google.com</a></p><p>Verify IP update in 60 seconds ...<br />Update failed (0):</p><p>retry #1 in 60 seconds - CurrentIP: 2001:5b0:2d5a:f380:280:aeff:fe3f:44b4 - RegisteredIP: 2001:5b0:2d5a:7d0:c63d:c7ff:fe97:f0fa<br />^C<br />root@OpenWrt ddns# </p><br /><p>Here is the Google Test<br />root@OpenWrt ddns# ./dynamic_dns_updater.sh test_google 1</p><p>&nbsp; &nbsp;update_prog: /usr/bin/wget -nv -O - -6<br />&nbsp; &nbsp; update_url: <a href="http://ipv6.google.com">http://ipv6.google.com</a><br />force interval: 0 seconds<br />check interval: 600 seconds<br />retry interval: 60 seconds<br /> retry counter: 1 times<br />&nbsp; &nbsp;last update: 0 hours ago</p><p>Running IP check ...<br />&nbsp; &nbsp; &nbsp;system ip: 2001:5b0:2d5a:f380:280:aeff:fe3f:44b4<br /> registered ip: 2001:5b0:2d5a:7d0:c63d:c7ff:fe97:f0fa<br />update necessary, performing update ...<br />update command: /usr/bin/wget -nv -O - -6 <a href="http://ipv6.google.com">http://ipv6.google.com</a></p><p>Verify IP update in 60 seconds ...<br />Update failed (0):</p><p>retry #1 in 60 seconds - CurrentIP: 2001:5b0:2d5a:f380:280:aeff:fe3f:44b4 - RegisteredIP: 2001:5b0:2d5a:7d0:c63d:c7ff:fe97:f0fa<br />^C<br />root@OpenWrt ddns# </p><br /><p>The test_he<br />root@OpenWrt ddns# ./dynamic_dns_updater.sh test_he 1</p><p>&nbsp; &nbsp;update_prog: /usr/bin/wget -nv -O - -6<br />&nbsp; &nbsp; update_url: <a href="http://ipv6.google.com">http://ipv6.google.com</a><br />force interval: 0 seconds<br />check interval: 600 seconds<br />retry interval: 60 seconds<br /> retry counter: 1 times<br />&nbsp; &nbsp;last update: 0 hours ago</p><p>Running IP check ...<br />&nbsp; &nbsp; &nbsp;system ip: 2001:5b0:2d5a:f380:c63d:c7ff:fe97:f0fa<br /> registered ip: 2001:5b0:2d5a:7d0:c63d:c7ff:fe97:f0fa<br />update necessary, performing update ...<br />update command: /usr/bin/wget -nv -O - -6 <a href="http://ipv6.google.com">http://ipv6.google.com</a></p><p>Verify IP update in 60 seconds ...<br />Update failed (0):</p><p>retry #1 in 60 seconds - CurrentIP: 2001:5b0:2d5a:f380:c63d:c7ff:fe97:f0fa - RegisteredIP: 2001:5b0:2d5a:7d0:c63d:c7ff:fe97:f0fa<br />^C<br />root@OpenWrt ddns# </p><p>################################################################################################################################<br />These are the results with the Hughes proxy disabled.</p><p>root@OpenWrt ddns# ./dynamic_dns_updater.sh test_nodns 1</p><p>&nbsp; &nbsp;update_prog: /usr/bin/wget -nv -O - -6<br />&nbsp; &nbsp; update_url: <a href="http://ipv6.google.com">http://ipv6.google.com</a><br />force interval: 0 seconds<br />check interval: 600 seconds<br />retry interval: 60 seconds<br /> retry counter: 1 times<br />old Process Id: <br />&nbsp; &nbsp;last update: 0 hours ago</p><p>Running IP check ...<br />&nbsp; &nbsp; &nbsp;system ip: 2001:5b0:2d5a:f380:c63d:c7ff:fe97:f0fa<br /> registered ip: 2001:5b0:2d5a:7d0:c63d:c7ff:fe97:f0fa<br />update necessary, performing update ...<br />update command: /usr/bin/wget -nv -O - -6 <a href="http://ipv6.google.com">http://ipv6.google.com</a></p><p>Verify IP update in 60 seconds ...<br />Update failed (0):</p><br /><br /><p>root@OpenWrt ddns# ./dynamic_dns_updater.sh test_google 1</p><p>&nbsp; &nbsp;update_prog: /usr/bin/wget -nv -O - -6<br />&nbsp; &nbsp; update_url: <a href="http://ipv6.google.com">http://ipv6.google.com</a><br />force interval: 0 seconds<br />check interval: 600 seconds<br />retry interval: 60 seconds<br /> retry counter: 1 times<br />old Process Id: <br />&nbsp; &nbsp;last update: 0 hours ago</p><p>Running IP check ...<br />&nbsp; &nbsp; &nbsp;system ip: 2001:5b0:2d5a:f380:c63d:c7ff:fe97:f0fa<br /> registered ip: 2001:5b0:2d5a:7d0:c63d:c7ff:fe97:f0fa<br />update necessary, performing update ...<br />update command: /usr/bin/wget -nv -O - -6 <a href="http://ipv6.google.com">http://ipv6.google.com</a></p><p>Verify IP update in 60 seconds ...<br />^C<br />root@OpenWrt ddns# </p><br /><br /><p>root@OpenWrt ddns# ./dynamic_dns_updater.sh test_he 1</p><p>&nbsp; &nbsp;update_prog: /usr/bin/wget -nv -O - -6<br />&nbsp; &nbsp; update_url: <a href="http://ipv6.google.com">http://ipv6.google.com</a><br />force interval: 0 seconds<br />check interval: 600 seconds<br />retry interval: 60 seconds<br /> retry counter: 1 times<br />old Process Id: <br />&nbsp; &nbsp;last update: 0 hours ago</p><p>Running IP check ...<br />&nbsp; &nbsp; &nbsp;system ip: 2001:5b0:2d5a:f380:c63d:c7ff:fe97:f0fa<br /> registered ip: 2001:5b0:2d5a:7d0:c63d:c7ff:fe97:f0fa<br />update necessary, performing update ...<br />update command: /usr/bin/wget -nv -O - -6 <a href="http://ipv6.google.com">http://ipv6.google.com</a></p><p>Verify IP update in 60 seconds ...<br />^C<br />root@OpenWrt ddns# </p><br /><p>With Hughes&#039; proxy server disabled, http(s) traffic does not pass through the proxy but instead bypasses the proxy.&nbsp; The result of this is the correct address of the router being reported as the system ip.</p><p>Hughes has the proxy configured on by default, and that setting can not be changed by the customer.&nbsp; The customer can turn the proxy off, but the next reboot will re-enable the proxy.&nbsp; This happens when Hughes pushes out a software update, or if I experience a power failure, or I manually reboot the router.&nbsp; Many people on the Hughes forum complain about this.&nbsp; There is also no way to know if the proxy has been re-enabled, unless you take the time and check yourself.</p><p>If other ISPs are using a similar feature, then other folks will have similar experiences.&nbsp; As I&#039;ve said, I&#039;m no good with scripting, so I don&#039;t know if this is possible.&nbsp; Couldn&#039;t you pull the address from the interface on the router, then compare that to the information contained in the nameserver, without using any kind of http protocol?&nbsp; In my case, I&#039;m using Hurricane Electric.&nbsp; I need to select the service I&#039;m using.&nbsp; If I know which service I&#039;m using, it seems to me, that I would know the name of the nameserver that goes along with that service.&nbsp; Afterall, I did have to establish a record in that nameserver.&nbsp; So if you provided a place for me to input the nameserver I use, you could perform an nslookup on that server, then compare the result with the address of the interface.&nbsp; Similar to what you have provided when the wan6 interface is selected as the address source.</p><p>I can&#039;t find, on Hurricane Electric&#039;s website, if they compare the address trying to be set, to the address of connection trying to make the change.&nbsp; dnsexit.com did this.&nbsp; From looking at the offerings Hurricane Electric has, I suspect they do not compare the two. </p><p>I would tend to think, that anyone attempting to use OpenWRT, then try to employ DDNS, would have enough knowledge to be aware of the need for the nameserver name.&nbsp; The folks that wouldn&#039;t know this, in all likelyhood, would either not be using OpenWRT or would not be using DDNS to begin with.</p><p>Over here, its called Daylight Savings Time rather than Summer Time, so its adjusted by an hour.&nbsp; Even though I&#039;m in the UTC-6 timezone, during Daylight Savings Time, its like being in UTC-5, so I guess we are 7 hours apart.&nbsp; I know Germany is east of Greenwich England, but I didn&#039;t know how far.&nbsp; I&#039;ll be going to bed soon, you&#039;re probably getting up soon.&nbsp; Here, its still today.&nbsp; But where you are at, looking at me, its yesterday.</p><p>Bill</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p241396">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">billmc</div>
					<div class="post-datetime">
						25 Jul 2014, 07:29					</div>
				</div>
				<div class="post-content content">
					<p>Hey, one more question.&nbsp; How did you put that scroll box into your post?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p241437">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">chris5560</div>
					<div class="post-datetime">
						25 Jul 2014, 14:44					</div>
				</div>
				<div class="post-content content">
					<p>Hi Bill,</p><p>for special effects in postings have a look at <a href="https://forum.openwrt.org/help.php?section=bbcode">https://forum.openwrt.org/help.php?section=bbcode</a><br />On the right side of the posting window there is: You may use: BBCode Images Smilies</p><p>Sorry I forgot: nslookup on Debian, LMDE, Ubuntu ... living in the past (no IPv6 support)<br />Don&#039;t know on other Distro&#039;s. There are other funny things in WS-Distro&#039;s (i.e. DHCP problems, DNS problems, IPv6 support....)<br />That&#039;s one reason why I still prefere Windows (but never Win 8).</p><p>Back to the problem.<br />What I read out of your listings: <br />1.) Registered IP (what the internet see) everything is fine in scripts, Luci, console and workstation (on my side)<br />2.) CurrentIP detected via wan6 works ok<br />3.) CurrentIP detected via <a href="http://checkipv6.dyndns.com">http://checkipv6.dyndns.com</a> works fine as long your providers proxy is disabled.<br />4.) The HE&#039;s url entry in /usr/lib/ddns/services is correct and can be used for IPv6 also (copy to services_ipv6)</p><p>So the next things to do:<br />You stated that you could set AAAA record at HE by hand.<br />Try to set your AAAA record at HE by hand to Google&#039;s IPv6 (ipv6.google.com) addr (without ddns scripts running)<br />Or use any other IPv6 addr you like.<br />Check how long it takes until the 3 test entrys in /etc/config/ddns show this address in LuCI status pages.<br />&quot;test_he&quot; should show quickly (I think inside 1 minute) because we use HE&#039;s dns server.<br />If not please check with HE why.</p><p>As long as we don&#039;t know how long it takes until the internet recognise the new address, it make no sence to continue.<br />And it has nothing to do with you providers proxy for the moment.</p><p>Good luck<br />Christian</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p241515">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">billmc</div>
					<div class="post-datetime">
						25 Jul 2014, 21:59					</div>
				</div>
				<div class="post-content content">
					<p>Chris,</p><p>If I understand what you want me to do correctly, this is what I&#039;ve done.</p><p>There are no ddns processes running.<br />root@OpenWrt config# ps | grep ddns<br />22417 root&nbsp; &nbsp; &nbsp; 1532 S&nbsp; &nbsp; grep ddns</p><p>This I copied from the Dynamic DDNS page in Luci.</p><p>Overview<br />Below is a list of configured DDNS configurations and their current state<br />Configuration&nbsp; &nbsp; Host / Domain<br />Registered IP&nbsp; &nbsp; Enabled&nbsp; &nbsp; Process ID<br />Next Update&nbsp; &nbsp; Start / Stop&nbsp; &nbsp;&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />test_nodns&nbsp; &nbsp; <br />ayankeeindixie.com<br />2001:5b0:2d5a:3820:c63d:c7ff:fe97:f0fa<br />run once<br />&nbsp; &nbsp; <br />test_google<br />ayankeeindixie.com<br />2001:5b0:2d5a:3820:c63d:c7ff:fe97:f0fa<br />run once<br />&nbsp; &nbsp; <br />test_he<br />ayankeeindixie.com<br />2001:5b0:2d5a:3820:c63d:c7ff:fe97:f0fa<br />run once</p><p>Each of those are reporting the Registered IP as being the current wan6 IP&nbsp; &nbsp; </p><p>root@OpenWrt config# ifstatus wan6<br />{<br />&nbsp; &nbsp; &quot;up&quot;: true,<br />&nbsp; &nbsp; &quot;pending&quot;: false,<br />&nbsp; &nbsp; &quot;available&quot;: true,<br />&nbsp; &nbsp; &quot;autostart&quot;: true,<br />&nbsp; &nbsp; &quot;uptime&quot;: 2469,<br />&nbsp; &nbsp; &quot;l3_device&quot;: &quot;eth1&quot;,<br />&nbsp; &nbsp; &quot;proto&quot;: &quot;dhcpv6&quot;,<br />&nbsp; &nbsp; &quot;device&quot;: &quot;eth1&quot;,<br />&nbsp; &nbsp; &quot;metric&quot;: 0,<br />&nbsp; &nbsp; &quot;delegation&quot;: true,<br />&nbsp; &nbsp; &quot;ipv4-address&quot;: [<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; ],<br />&nbsp; &nbsp; &quot;ipv6-address&quot;: [<br />&nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;address&quot;: &quot;2001:5b0:2d5a:3820:c63d:c7ff:fe97:f0fa&quot;,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;mask&quot;: 64,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;preferred&quot;: 10,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;valid&quot;: 280<br />&nbsp; &nbsp; &nbsp; &nbsp; },</p><br /><p>I looked up the address of ipv6.google.com<br />sligo bill # dig aaaa ipv6.google.com</p><p>; &lt;&lt;&gt;&gt; DiG 9.8.4-rpz2+rl005.12-P1 &lt;&lt;&gt;&gt; aaaa ipv6.google.com<br />;; global options: +cmd<br />;; Got answer:<br />;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 6805<br />;; flags: qr rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 4, ADDITIONAL: 4</p><p>;; QUESTION SECTION:<br />;ipv6.google.com.&nbsp; &nbsp; &nbsp; &nbsp; IN&nbsp; &nbsp; AAAA</p><p>;; ANSWER SECTION:<br />ipv6.google.com.&nbsp; &nbsp; 1200&nbsp; &nbsp; IN&nbsp; &nbsp; CNAME&nbsp; &nbsp; ipv6.l.google.com.<br />ipv6.l.google.com.&nbsp; &nbsp; 300&nbsp; &nbsp; IN&nbsp; &nbsp; AAAA&nbsp; &nbsp; 2607:f8b0:4007:802::1002</p><br /><br /><p>I made the change, by hand in the HE nameserver.&nbsp; The webpage reported that the address had been updated.&nbsp; Hurricane Electric&#039;s mailing address is in California.&nbsp; It looks like their servers are set to Pacific Time (UTC-8).&nbsp; I made the change at :05 minutes past the hour.</p><p>Raw AXFR output from ns1.he.net</p><p>; ayankeeindixie.com Dumped Fri Jul 25 10:05:17 2014<br />;<br />ayankeeindixie.com.&nbsp; &nbsp; 86400&nbsp; &nbsp; IN&nbsp; &nbsp; SOA&nbsp; &nbsp; ns1.he.net. hostmaster.he.net. (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2014072501&nbsp; &nbsp; ;serial<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 10800&nbsp; &nbsp; &nbsp; &nbsp; ;refresh<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1800&nbsp; &nbsp; &nbsp; &nbsp; ;retry<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 604800&nbsp; &nbsp; &nbsp; &nbsp; ;expire<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 86400&nbsp; &nbsp; )&nbsp; &nbsp; ;minimum<br />ayankeeindixie.com.&nbsp; &nbsp; 86400&nbsp; &nbsp; IN&nbsp; &nbsp; NS&nbsp; &nbsp; ns1.he.net.<br />ayankeeindixie.com.&nbsp; &nbsp; 86400&nbsp; &nbsp; IN&nbsp; &nbsp; NS&nbsp; &nbsp; ns2.he.net.<br />ayankeeindixie.com.&nbsp; &nbsp; 86400&nbsp; &nbsp; IN&nbsp; &nbsp; NS&nbsp; &nbsp; ns3.he.net.<br />ayankeeindixie.com.&nbsp; &nbsp; 86400&nbsp; &nbsp; IN&nbsp; &nbsp; NS&nbsp; &nbsp; ns4.he.net.<br />ayankeeindixie.com.&nbsp; &nbsp; 86400&nbsp; &nbsp; IN&nbsp; &nbsp; NS&nbsp; &nbsp; ns5.he.net.<br />ayankeeindixie.com.&nbsp; &nbsp; 300&nbsp; &nbsp; IN&nbsp; &nbsp; AAAA&nbsp; &nbsp; 2607:f8b0:4007:802::1002</p><br /><p>Running nslookup interactively on my laptop, shows the update has taken place.</p><p>sligo bill # nslookup<br />&gt; server ns1.he.net<br />Default server: ns1.he.net<br />Address: 216.218.130.2#53<br />&gt; set q=any<br />&gt; ayankeeindixie.com<br />Server:&nbsp; &nbsp; &nbsp; &nbsp; ns1.he.net<br />Address:&nbsp; &nbsp; 216.218.130.2#53</p><p>ayankeeindixie.com&nbsp; &nbsp; nameserver = ns3.he.net.<br />ayankeeindixie.com&nbsp; &nbsp; has AAAA address 2607:f8b0:4007:802::1002<br />ayankeeindixie.com&nbsp; &nbsp; nameserver = ns4.he.net.<br />ayankeeindixie.com<br />&nbsp; &nbsp; origin = ns1.he.net<br />&nbsp; &nbsp; mail addr = hostmaster.he.net<br />&nbsp; &nbsp; serial = 2014072501<br />&nbsp; &nbsp; refresh = 10800<br />&nbsp; &nbsp; retry = 1800<br />&nbsp; &nbsp; expire = 604800<br />&nbsp; &nbsp; minimum = 86400<br />ayankeeindixie.com&nbsp; &nbsp; nameserver = ns2.he.net.<br />ayankeeindixie.com&nbsp; &nbsp; nameserver = ns1.he.net.<br />ayankeeindixie.com&nbsp; &nbsp; nameserver = ns5.he.net.<br />&gt; </p><p>Running nslookup from a console window of the router</p><p>root@OpenWrt config# date;nslookup ayankeeindixie.com<br />Fri Jul 25 12:09:05 CDT 2014<br />Server:&nbsp; &nbsp; 127.0.0.1<br />Address 1: 127.0.0.1 localhost</p><p>Name:&nbsp; &nbsp; &nbsp; ayankeeindixie.com<br />Address 1: 2001:5b0:2d5a:3820:c63d:c7ff:fe97:f0fa ayankeeindixie.com<br />root@OpenWrt config# date;nslookup ayankeeindixie.com ns1.he.net<br />Fri Jul 25 12:09:24 CDT 2014<br />Server:&nbsp; &nbsp; 216.218.130.2<br />Address 1: 216.218.130.2 ns1.he.net</p><p>Name:&nbsp; &nbsp; &nbsp; ayankeeindixie.com<br />Address 1: 2001:5b0:2d5a:3820:c63d:c7ff:fe97:f0fa</p><br /><p>I&#039;ve allowed the router to sit while I watched it, waiting for a change in the status of the Registered IP shown in Luci.&nbsp; It has been over 1/2 hour and Luci shows no change.</p><p>(I&#039;m writing this response off-line.&nbsp; Weather is affecting my internet service, this is why you&#039;ll see a big difference in time stamps.)</p><p>My network connection has been out of service for over an hour.&nbsp; Once it was restored, it appears that the router is now seeing the change.&nbsp; Weather radar is showing the storms moving out of the area.&nbsp; Once the weather has cleared, I&#039;ll reboot the router, change the address again in the HE servers and wait to see how long, it takes the router to update.</p><p>root@OpenWrt config# date;nslookup ayankeeindixie.com ns2.he.net<br />Fri Jul 25 13:51:55 CDT 2014<br />Server:&nbsp; &nbsp; 216.218.131.2<br />Address 1: 216.218.131.2 ns2.he.net</p><p>Name:&nbsp; &nbsp; &nbsp; ayankeeindixie.com<br />Address 1: 2607:f8b0:4007:802::1002 lax17s01-in-x02.1e100.net<br />root@OpenWrt config# </p><p>Overview<br />Below is a list of configured DDNS configurations and their current state<br />Configuration&nbsp; &nbsp; Host / Domain<br />Registered IP&nbsp; &nbsp; Enabled&nbsp; &nbsp; Process ID<br />Next Update&nbsp; &nbsp; Start / Stop&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />test_nodns<br />ayankeeindixie.com<br />2001:5b0:2d5a:86c0:c63d:c7ff:fe97:f0fa<br />run once<br />&nbsp; &nbsp; <br />test_google<br />ayankeeindixie.com<br />2607:f8b0:4007:802::1002<br />run once<br />&nbsp; &nbsp; <br />test_he<br />ayankeeindixie.com<br />2607:f8b0:4007:802::1002<br />run once<br />&nbsp; &nbsp; <br />Bill</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p241536">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">billmc</div>
					<div class="post-datetime">
						26 Jul 2014, 00:31					</div>
				</div>
				<div class="post-content content">
					<p>Chris,</p><p>I seem to recall folks complaining on the Hughesnet forums, about slow access to web pages.&nbsp; The solution was to reboot the router, to clear its cache.&nbsp; I don&#039;t know if that affected the time it took to update or not.&nbsp; Also, I had restored a backup config file into the router this morning, this made dnsmasq authoratative again, with the wan6 address being assigned to the ayankeeindixie.com domain name.</p><p>I&#039;ve removed those settings from dnsmasq.&nbsp; The storms have cleared out.&nbsp; I&#039;m rebooting the Hughes modem and I&#039;m rebooting the OpenWRT router, and starting the tests again.</p><br /><p>Address changed at HE nameservers, new address fe80::2a</p><p>Raw AXFR output from ns1.he.net</p><p>; ayankeeindixie.com Dumped Fri Jul 25 13:28:35 2014<br />;<br />ayankeeindixie.com.&nbsp; &nbsp; 86400&nbsp; &nbsp; IN&nbsp; &nbsp; SOA&nbsp; &nbsp; ns1.he.net. hostmaster.he.net. (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2014072503&nbsp; &nbsp; ;serial<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 10800&nbsp; &nbsp; &nbsp; &nbsp; ;refresh<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1800&nbsp; &nbsp; &nbsp; &nbsp; ;retry<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 604800&nbsp; &nbsp; &nbsp; &nbsp; ;expire<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 86400&nbsp; &nbsp; )&nbsp; &nbsp; ;minimum<br />ayankeeindixie.com.&nbsp; &nbsp; 86400&nbsp; &nbsp; IN&nbsp; &nbsp; NS&nbsp; &nbsp; ns1.he.net.<br />ayankeeindixie.com.&nbsp; &nbsp; 86400&nbsp; &nbsp; IN&nbsp; &nbsp; NS&nbsp; &nbsp; ns2.he.net.<br />ayankeeindixie.com.&nbsp; &nbsp; 86400&nbsp; &nbsp; IN&nbsp; &nbsp; NS&nbsp; &nbsp; ns3.he.net.<br />ayankeeindixie.com.&nbsp; &nbsp; 86400&nbsp; &nbsp; IN&nbsp; &nbsp; NS&nbsp; &nbsp; ns4.he.net.<br />ayankeeindixie.com.&nbsp; &nbsp; 86400&nbsp; &nbsp; IN&nbsp; &nbsp; NS&nbsp; &nbsp; ns5.he.net.<br />ayankeeindixie.com.&nbsp; &nbsp; 300&nbsp; &nbsp; IN&nbsp; &nbsp; AAAA&nbsp; &nbsp; fe80::2a<br />&nbsp; &nbsp; </p><p>nslookup interactive on laptop shows the address updated.</p><p>sligo bill # nslookup<br />&gt; server ns1.he.net<br />Default server: ns1.he.net<br />Address: 216.218.130.2#53<br />&gt; set q=any<br />&gt; ayankeeindixie.com<br />Server:&nbsp; &nbsp; &nbsp; &nbsp; ns1.he.net<br />Address:&nbsp; &nbsp; 216.218.130.2#53</p><p>ayankeeindixie.com<br />&nbsp; &nbsp; origin = ns1.he.net<br />&nbsp; &nbsp; mail addr = hostmaster.he.net<br />&nbsp; &nbsp; serial = 2014072503<br />&nbsp; &nbsp; refresh = 10800<br />&nbsp; &nbsp; retry = 1800<br />&nbsp; &nbsp; expire = 604800<br />&nbsp; &nbsp; minimum = 86400<br />ayankeeindixie.com&nbsp; &nbsp; nameserver = ns2.he.net.<br />ayankeeindixie.com&nbsp; &nbsp; nameserver = ns5.he.net.<br />ayankeeindixie.com&nbsp; &nbsp; has AAAA address fe80::2a<br />ayankeeindixie.com&nbsp; &nbsp; nameserver = ns4.he.net.<br />ayankeeindixie.com&nbsp; &nbsp; nameserver = ns3.he.net.<br />ayankeeindixie.com&nbsp; &nbsp; nameserver = ns1.he.net.<br />&gt; </p><p>nslookup run on the router does not show the change yet.</p><p>root@OpenWrt ~# date;nslookup ayankeeindixie.com<br />Fri Jul 25 15:29:18 CDT 2014<br />Server:&nbsp; &nbsp; 127.0.0.1<br />Address 1: 127.0.0.1 localhost</p><p>Name:&nbsp; &nbsp; &nbsp; ayankeeindixie.com<br />Address 1: fe80::b6b5:2fff:fe92:862a<br />root@OpenWrt ~# date;nslookup ns1.he.net ayankeeindixie.com<br />Fri Jul 25 15:29:50 CDT 2014<br />Server:&nbsp; &nbsp; fe80::b6b5:2fff:fe92:862a<br />Address 1: fe80::b6b5:2fff:fe92:862a</p><p>nslookup: bad address &#039;ayankeeindixie.com&#039;</p><p>Dynamic DDNS page from Luci; does not show change yet.</p><p>Overview<br />Below is a list of configured DDNS configurations and their current state<br />Configuration&nbsp; &nbsp; Host / Domain<br />Registered IP&nbsp; &nbsp; Enabled&nbsp; &nbsp; Process ID<br />Next Update&nbsp; &nbsp; Start / Stop&nbsp; &nbsp;&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />test_nodns<br />ayankeeindixie.com<br />fe80::b6b5 2fff:fe92:862a<br />run once<br />&nbsp; &nbsp; <br />test_google<br />ayankeeindixie.com<br />fe80::b6b5 2fff:fe92:862a<br />run once<br />&nbsp; &nbsp; <br />test_he<br />ayankeeindixie.com<br />fe80::b6b5 2fff:fe92:862a<br />run once<br />&nbsp; &nbsp; <br /> -----------------------------------------------------<br />root@OpenWrt ~# date;nslookup ayankeeindixie.com<br />Fri Jul 25 16:18:12 CDT 2014<br />Server:&nbsp; &nbsp; 127.0.0.1<br />Address 1: 127.0.0.1 localhost</p><p>Name:&nbsp; &nbsp; &nbsp; ayankeeindixie.com<br />Address 1: fe80::b6b5:2fff:fe92:862a</p><br /><p>Its been almost 50 minutes.&nbsp; The addresses displayed in Luci have not changed.&nbsp; nslookup on the router is still pointing at the old address.</p><p>I&#039;m going to reboot the Hughes modem, once more.</p><br /><br /><p>During the Hughes reboot the Luci interface did not show an IP address.</p><p>Overview<br />Below is a list of configured DDNS configurations and their current state<br />Configuration&nbsp; &nbsp; Host / Domain<br />Registered IP&nbsp; &nbsp; Enabled&nbsp; &nbsp; Process ID<br />Next Update&nbsp; &nbsp; Start / Stop&nbsp; &nbsp;&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />test_nodns<br />no IP found<br />run once<br />&nbsp; &nbsp; <br />test_google<br />no IP found<br />run once<br />&nbsp; &nbsp; <br />test_he<br />no IP found<br />run once<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; </p><p>As soon as the Hughes modem came back on line, the Luci interface updated with the new address and nslookup from the router reported the new address.</p><br /><p>Overview<br />Below is a list of configured DDNS configurations and their current state<br />Configuration&nbsp; &nbsp; Host / Domain<br />Registered IP&nbsp; &nbsp; Enabled&nbsp; &nbsp; Process ID<br />Next Update&nbsp; &nbsp; Start / Stop&nbsp; &nbsp;&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />test_nodns<br />ayankeeindixie.com<br />fe80::2a<br />run once<br />&nbsp; &nbsp; <br />test_google<br />ayankeeindixie.com<br />fe80::2a<br />run once<br />&nbsp; &nbsp; <br />test_he<br />ayankeeindixie.com<br />fe80::2a<br />run once<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; <br />root@OpenWrt ~# date;nslookup ayankeeindixie.com<br />Fri Jul 25 16:18:12 CDT 2014<br />Server:&nbsp; &nbsp; 127.0.0.1<br />Address 1: 127.0.0.1 localhost</p><p>Name:&nbsp; &nbsp; &nbsp; ayankeeindixie.com<br />Address 1: fe80::b6b5:2fff:fe92:862a<br />root@OpenWrt ~# date;nslookup ayankeeindixie.com<br />Fri Jul 25 16:22:01 CDT 2014<br />Server:&nbsp; &nbsp; 127.0.0.1<br />Address 1: 127.0.0.1 localhost</p><p>Name:&nbsp; &nbsp; &nbsp; ayankeeindixie.com<br />Address 1: fe80::2a<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; <br />It looks like I need to find out how to point the router&#039;s dns (dnsmasq I assume) at nameservers other than the one catched in the Hughes modem.</p><p>Bill</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p241546">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">billmc</div>
					<div class="post-datetime">
						26 Jul 2014, 01:38					</div>
				</div>
				<div class="post-content content">
					<p>Chris,</p><p>I&#039;ve added these lines to the dnsmasq.conf file:</p><p>all-servers<br />server=85.159.112.212&nbsp; &nbsp; # ns2.he.net<br />server=8.8.8.8&nbsp; &nbsp; &nbsp; &nbsp; # google<br />server=2001:470:300::2&nbsp; &nbsp; # ns3.he.net</p><p>The all-servers switch is to make dnsmasq querry all available nameservers and use the first answer.&nbsp; Looking at my logfile, it seems to me that this is working, bypassing the nameserver in the Hughes modem.&nbsp; I&#039;ll try the tests one more time.</p><p>Raw AXFR output from ns1.he.net</p><p>; ayankeeindixie.com Dumped Fri Jul 25 15:18:36 2014<br />;<br />ayankeeindixie.com.&nbsp; &nbsp; 86400&nbsp; &nbsp; IN&nbsp; &nbsp; SOA&nbsp; &nbsp; ns1.he.net. hostmaster.he.net. (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2014072504&nbsp; &nbsp; ;serial<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 10800&nbsp; &nbsp; &nbsp; &nbsp; ;refresh<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1800&nbsp; &nbsp; &nbsp; &nbsp; ;retry<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 604800&nbsp; &nbsp; &nbsp; &nbsp; ;expire<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 86400&nbsp; &nbsp; )&nbsp; &nbsp; ;minimum<br />ayankeeindixie.com.&nbsp; &nbsp; 86400&nbsp; &nbsp; IN&nbsp; &nbsp; NS&nbsp; &nbsp; ns1.he.net.<br />ayankeeindixie.com.&nbsp; &nbsp; 86400&nbsp; &nbsp; IN&nbsp; &nbsp; NS&nbsp; &nbsp; ns2.he.net.<br />ayankeeindixie.com.&nbsp; &nbsp; 86400&nbsp; &nbsp; IN&nbsp; &nbsp; NS&nbsp; &nbsp; ns3.he.net.<br />ayankeeindixie.com.&nbsp; &nbsp; 86400&nbsp; &nbsp; IN&nbsp; &nbsp; NS&nbsp; &nbsp; ns4.he.net.<br />ayankeeindixie.com.&nbsp; &nbsp; 86400&nbsp; &nbsp; IN&nbsp; &nbsp; NS&nbsp; &nbsp; ns5.he.net.<br />ayankeeindixie.com.&nbsp; &nbsp; 300&nbsp; &nbsp; IN&nbsp; &nbsp; AAAA&nbsp; &nbsp; fe80::ffff:2a<br />&nbsp; &nbsp; </p><br /><p>bill@sligo:~$ nslookup<br />&gt; server ns1.he.net<br />Default server: ns1.he.net<br />Address: 216.218.130.2#53<br />&gt; set q=any<br />&gt; ayankeeindixie.com<br />Server:&nbsp; &nbsp; &nbsp; &nbsp; ns1.he.net<br />Address:&nbsp; &nbsp; 216.218.130.2#53</p><p>ayankeeindixie.com&nbsp; &nbsp; nameserver = ns3.he.net.<br />ayankeeindixie.com&nbsp; &nbsp; nameserver = ns5.he.net.<br />ayankeeindixie.com&nbsp; &nbsp; nameserver = ns1.he.net.<br />ayankeeindixie.com<br />&nbsp; &nbsp; origin = ns1.he.net<br />&nbsp; &nbsp; mail addr = hostmaster.he.net<br />&nbsp; &nbsp; serial = 2014072504<br />&nbsp; &nbsp; refresh = 10800<br />&nbsp; &nbsp; retry = 1800<br />&nbsp; &nbsp; expire = 604800<br />&nbsp; &nbsp; minimum = 86400<br />ayankeeindixie.com&nbsp; &nbsp; nameserver = ns4.he.net.<br />ayankeeindixie.com&nbsp; &nbsp; nameserver = ns2.he.net.<br />ayankeeindixie.com&nbsp; &nbsp; has AAAA address fe80::ffff:2a</p><p>Luci is not updating the Registered IP.</p><p>Here is a portion of my dnsmasq.log.&nbsp; It looks like ayankeeindixie.com is being saved in the cache of 127.0.0.1.</p><p>Jul 25 17:24:54 dnsmasq[1414]: query[A] ayankeeindixie.com from 127.0.0.1<br />Jul 25 17:24:54 dnsmasq[1414]: forwarded ayankeeindixie.com to 2001:470:300::2<br />Jul 25 17:24:54 dnsmasq[1414]: forwarded ayankeeindixie.com to 8.8.8.8<br />Jul 25 17:24:54 dnsmasq[1414]: forwarded ayankeeindixie.com to 85.159.112.212<br />Jul 25 17:24:54 dnsmasq[1414]: forwarded ayankeeindixie.com to 192.168.0.1<br />Jul 25 17:24:54 dnsmasq[1414]: forwarded ayankeeindixie.com to fd0d:edc3:e12a::1<br />Jul 25 17:24:54 dnsmasq[1414]: query[PTR] a.2.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.8.e.f.ip6.arpa from 127.0.0.1<br />Jul 25 17:24:54 dnsmasq[1414]: forwarded a.2.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.8.e.f.ip6.arpa to 2001:470:300::2<br />Jul 25 17:24:54 dnsmasq[1414]: forwarded a.2.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.8.e.f.ip6.arpa to 8.8.8.8<br />Jul 25 17:24:54 dnsmasq[1414]: forwarded a.2.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.8.e.f.ip6.arpa to 85.159.112.212<br />Jul 25 17:24:54 dnsmasq[1414]: forwarded a.2.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.8.e.f.ip6.arpa to 192.168.0.1<br />Jul 25 17:24:54 dnsmasq[1414]: forwarded a.2.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.8.e.f.ip6.arpa to fd0d:edc3:e12a::1<br />Jul 25 17:24:54 dnsmasq[1414]: query[PTR] a.2.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.8.e.f.ip6.arpa.lan from 127.0.0.1<br />Jul 25 17:24:54 dnsmasq[1414]: config a.2.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.8.e.f.ip6.arpa.lan is NXDOMAIN<br />Jul 25 17:24:55 dnsmasq[1414]: query[AAAA] ns1.he.net from 127.0.0.1<br />Jul 25 17:24:55 dnsmasq[1414]: forwarded ns1.he.net to 2001:470:300::2<br />Jul 25 17:24:55 dnsmasq[1414]: forwarded ns1.he.net to 8.8.8.8<br />Jul 25 17:24:55 dnsmasq[1414]: forwarded ns1.he.net to 85.159.112.212<br />Jul 25 17:24:55 dnsmasq[1414]: forwarded ns1.he.net to 192.168.0.1<br />Jul 25 17:24:55 dnsmasq[1414]: forwarded ns1.he.net to fd0d:edc3:e12a::1<br />Jul 25 17:24:55 dnsmasq[1414]: query[A] ns1.he.net from 127.0.0.1<br />Jul 25 17:24:55 dnsmasq[1414]: cached ns1.he.net is 216.218.130.2<br />Jul 25 17:24:55 dnsmasq[1414]: query[AAAA] google-public-dns-a.google.com from 127.0.0.1<br />Jul 25 17:24:55 dnsmasq[1414]: cached google-public-dns-a.google.com is 2001:4860:4860::8888<br />Jul 25 17:24:55 dnsmasq[1414]: query[A] google-public-dns-a.google.com from 127.0.0.1<br />Jul 25 17:24:55 dnsmasq[1414]: cached google-public-dns-a.google.com is 8.8.8.8<br />Jul 25 17:24:56 dnsmasq[1414]: query[AAAA] ayankeeindixie.com from 127.0.0.1<br />Jul 25 17:24:56 dnsmasq[1414]: cached ayankeeindixie.com is fe80::2a</p><br /><p>/etc/resolv.conf is a link to /tmp/resolv.conf, this file contains the entry nameserver 127.0.0.1</p><p>I don&#039;t know where the &quot;real&quot; file that /tmp/resolv.conf come from.&nbsp; Its my understanding that /tmp is erased on each reboot.&nbsp; If I can get the router to bypass the cached info in 127.0.0.1, I think we might see updates in Luci.</p><p>Bill</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p241547">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">chris5560</div>
					<div class="post-datetime">
						26 Jul 2014, 01:46					</div>
				</div>
				<div class="post-content content">
					<p>Hi Bill,<br />I just come home from a party and read your posting.<br />I want to give you a short feedback what my windows box can see.<br /></p><div class="codebox"><pre><code>Microsoft Windows [Version 6.1.7601]
Copyright (c) 2009 Microsoft Corporation. Alle Rechte vorbehalten.

C:\Users\christianb&gt;nslookup ayankeeindixie.com
Server:  CS09-Router.cshome.lan
Address:  fd43:5368:6f6d:6500::1

Name:    ayankeeindixie.com
Address:  fe80::ffff:2a


C:\Users\christianb&gt;nslookup ayankeeindixie.com google-public-dns-a.google.com
Server:  google-public-dns-a.google.com
Address:  8.8.8.8

Name:    ayankeeindixie.com
Address:  fe80::ffff:2a


C:\Users\christianb&gt;nslookup ayankeeindixie.com ns1.he.net
Server:  ns1.he.net
Address:  216.218.130.2

Name:    ayankeeindixie.com
Address:  fe80::ffff:2a


C:\Users\christianb&gt;time
Aktuelle Zeit:  0:41:36,11
Geben Sie die neue Zeit ein:
C:\Users\christianb&gt;date
Aktuelles Datum: 26.07.2014
Geben Sie das neue Datum ein: (TT-MM-JJ)
C:\Users\christianb&gt;</code></pre></div><p>I&#039;ll continue tomorrow to think about.</p><p>Christian</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p241606">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">chris5560</div>
					<div class="post-datetime">
						26 Jul 2014, 19:25					</div>
				</div>
				<div class="post-content content">
					<p>Hi Bill,</p><p>I wrote a little script dynamic_ddns_diaghelper.sh, which will be extended and part of release (if acceppted).<br /></p><div class="codebox"><pre><code>#!/bin/sh
#set -vx    # script-debugger

### Please uncomment the line with the NAMESERVER to use or edit on
### no spaces around &quot;=&quot; and don&#039;t forget double quotes around name or ip address
# NAMESERVER=&quot;&quot;                    # take the systems default
# NAMESERVER=&quot;localhost&quot;            # local machine
# NAMESERVER=&quot;resolver1.opendns.com&quot;        # opendns public dns
# NAMESERVER=&quot;google-public-dns-a.google.com&quot;    # Google public dns
# NAMESERVER=&quot;ordns.he.net&quot;            # Hurricane Electric public dns
# NAMESERVER=&quot;ns1.he.net&quot;            # not a public dns-server
NAMESERVER=&quot;palmnut-dns.exetel.com.au&quot;        # Australian DNS server

### Put here the data from your DDNS Provider (between double quotes)
DOMAIN=&quot;ayankeeindixie.com&quot;
USERNAME=&quot;&quot;
PASSWORD=&quot;&quot;
### IP to send to your provider - Valid IPv4 or IPv6 address
IP=&quot;&quot;    

# Hurricane Electric Dynamic DNS
URL=&quot;http://$DOMAIN:$PASSWORD@dyn.dns.he.net/nic/update?hostname=$DOMAIN&amp;myip=$IP&quot; 

# Securepoint Dynamic-DNS-Service    (http://www.spdns.de)
# URL=&quot;http://$USERNAME:$PASSWORD@update.spdns.de/nic/update?hostname=$DOMAIN&amp;myip=$IP&quot;

##### PLEASE NO CHANGES BLOW THIS LINE #########################################

IP_REGEX=&quot;[0-9]\{1,3\}\.[0-9]\{1,3\}\.[0-9]\{1,3\}\.[0-9]\{1,3\}&quot;
IPV4=$(echo $IP | grep -m 1 -o &quot;$IP_REGEX&quot;)
[ -z &quot;$IPV4&quot; ] &amp;&amp; IP_REGEX=&quot;\(\([0-9A-Fa-f]\{1,4\}:\)\{1,\}\)\(\([0-9A-Fa-f]\{1,4\}\)\{0,1\}\)\(\(:[0-9A-Fa-f]\{1,4\}\)\{1,\}\)&quot;

TIME=0
echo &quot;&quot;
/usr/bin/wget -q -O - &quot;$URL&quot; || {
    echo -e &quot;\n\tERROR updating your DDNS provider ! Check parameters !\n&quot;
    exit 1    # exit on error
}

echo -e &quot;\n\tWaiting for IP change of &#039;$DOMAIN&#039; on nameserver &#039;$NAMESERVER&#039;&quot;
START_IP=$(nslookup $DOMAIN $NAMESERVER) || {
    echo -e &quot;\n\tERROR in nslookup ! Please check error message !\n&quot;
    exit 1    # exit on error
}
START_IP=$(echo &quot;$START_IP&quot; | sed &#039;1,2d&#039; | grep -o &quot;Name:\|Address.*&quot; | grep -m 1 -o &quot;$IP_REGEX&quot;)

echo -e &quot;\tCurrentIP: $START_IP&quot;
[ -z $START_IP ] &amp;&amp; exit 1

STOP_IP=$START_IP
until [ &quot;$START_IP&quot; != &quot;$STOP_IP&quot; ]; do
    sleep 1
    STOP_IP=`nslookup $DOMAIN $NAMESERVER 2&gt;/dev/null | sed &#039;1,2d&#039; | grep -o &quot;Name:\|Address.*&quot; | grep -m 1 -o &quot;$IP_REGEX&quot;`
    TIME=$(( $TIME + 1 ))
    echo -n -e &quot;\b\b\b\b\b\t$TIME&quot;
done

echo -n -e &quot;\b\b\b\b\b&quot;
echo -e &quot;\t    NewIP: $STOP_IP&quot;
echo -e &quot;\t     Time: $TIME loops (1 second wait time)\n&quot;</code></pre></div><p>Attention:<br />No linebreak in line 31: [ -z &quot;$IPV4&quot; ] &amp;&amp; IP_REGEX=<br />No linebreak in line 53: STOP_IP=`nslookup ....</p><p>Functionality:<br />You set your account data at USER=&quot;&quot;, PASSWORD=&quot;&quot;, DOMAIN=&quot;&quot;<br />You set an NEW IPv4/IPv6 addr (of your choise) inside IP=&quot;&quot;<br />The script send the update to HE (NO HTTPS !!! no additional problems / works with BusyBox wget inside openwrt basebuild)<br />Reads current IP from network<br />Wait 1 second<br />Reread<br />loop until address changed</p><p>I checked with my provider spdns.de<br />It takes up to 190 loops/seconds with various NAMESERVER until change was seen on the network.<br />Luci shows update as soon the scripts finish.<br />I modified ddns config to use various dns_server for the same service and I see that Luci updates NOT on the same time.<br />Using Google&#039;s dns server I found out that the update is not constant after the first correct detection.<br />This might be a problem of multihomed servers not yet in sync, but after around 3 minutes it stabilize.</p><p>Using nslookup should not involve local dnsmasq if a NAMESERVER is given.<br />So no need to change resolve.conf.<br />ns??.he.net servers are not public, so I test the public one and all went good.<br />I think you should not use non-public servers.<br />I also disable cache and modify ttl settings of dnsmasq =&gt; no effect on nslookup from routers console.</p><p>Possibly your ISP routes dns/nslookup requests to other (there own) servers ?<br />(providing filters, familiy friendly, no &quot;sex&quot;, no &quot;crime&quot; and so on.)</p><p>Try<br />Christian</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p241616">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">billmc</div>
					<div class="post-datetime">
						26 Jul 2014, 22:07					</div>
				</div>
				<div class="post-content content">
					<p>Chris,</p><p>When you told me that it should not matter which version of OpenWRT I use and that your script prefered wget over curl; I flashed back to arokh&#039;s OpenWrt Barrier Breaker r41683 / LuCI Trunk (svn-r10459).&nbsp; All the results I sent yesterday were using this build.&nbsp; In addition to the changes to the dnsmasq.conf file I made yesterday, I also add in the -R switch so that dnsmasq would not look at the /etc/resolv.conf file.</p><p>Today, I&#039;ve copied your script.&nbsp; You did not provided specifics, so I copied it into /usr/lib/ddns.&nbsp; I chmod 755.</p><p>I killed any running ddns scripts that were running.&nbsp; I then logged into the HE website and changed the address of ayankeeindixie.com to 2001:4860:4860::8888, google&#039;s nameserver address.</p><p>From my laptop, I verified the change had taken effect</p><p>bill@sligo:~$ nslookup -type=aaaa ayankeeindixie.com<br />Server:&nbsp; &nbsp; &nbsp; &nbsp; 2001:5b0:2d5a:8fcc::1<br />Address:&nbsp; &nbsp; 2001:5b0:2d5a:8fcc::1#53</p><p>ayankeeindixie.com&nbsp; &nbsp; has AAAA address 2001:4860:4860::8888</p><p>I added my username and password to your script as indicated.&nbsp; I left the nameserver as you had set; palmnut-dns.exetel.com.au.</p><p>From a console window of the router:<br />root@OpenWrt ddns# ./dynamic_ddns_diaghelper.sh</p><br /><p>&nbsp; &nbsp; ERROR updating your DDNS provider ! Check parameters !</p><p>I did not not how long this took, but it was not immediate.<br />I then changed the nameserver to ns1.he.net and ran it again.</p><p>root@OpenWrt ddns# ./dynamic_ddns_diaghelper.sh</p><br /><p>&nbsp; &nbsp; ERROR updating your DDNS provider ! Check parameters !</p><p>I then decided to check the condition of my Hughes modem.&nbsp; The proxy server was enabled.&nbsp; I disabled the proxyserver and ran the script again, still with the ns1.he.net nameserver setting.&nbsp; This time</p><p>root@OpenWrt ddns# ./dynamic_ddns_diaghelper.sh</p><p>good 2001:5b0:2d5a:8fc0:c63d:c7ff:fe97:f0fa<br />&nbsp; &nbsp; Waiting for IP change of &#039;ayankeeindixie.com&#039; on nameserver &#039;ns1.he.net&#039;<br />&nbsp; &nbsp; CurrentIP: 2001:4860:4860::8888<br />&nbsp; &nbsp; &nbsp; &nbsp; 420</p><p>When the counter reached about 300, I checked the status of the HE nameserver, the change had been applied.&nbsp; I failed to note the time that I started the script, but I think it was less than 2 minutes when the change happened.<br />Raw AXFR output from ns1.he.net</p><p>; ayankeeindixie.com Dumped Sat Jul 26 11:27:48 2014<br />;<br />ayankeeindixie.com.&nbsp; &nbsp; 86400&nbsp; &nbsp; IN&nbsp; &nbsp; SOA&nbsp; &nbsp; ns1.he.net. hostmaster.he.net. (<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2014072601&nbsp; &nbsp; ;serial<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 10800&nbsp; &nbsp; &nbsp; &nbsp; ;refresh<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1800&nbsp; &nbsp; &nbsp; &nbsp; ;retry<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 604800&nbsp; &nbsp; &nbsp; &nbsp; ;expire<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 86400&nbsp; &nbsp; )&nbsp; &nbsp; ;minimum<br />ayankeeindixie.com.&nbsp; &nbsp; 86400&nbsp; &nbsp; IN&nbsp; &nbsp; NS&nbsp; &nbsp; ns1.he.net.<br />ayankeeindixie.com.&nbsp; &nbsp; 86400&nbsp; &nbsp; IN&nbsp; &nbsp; NS&nbsp; &nbsp; ns2.he.net.<br />ayankeeindixie.com.&nbsp; &nbsp; 86400&nbsp; &nbsp; IN&nbsp; &nbsp; NS&nbsp; &nbsp; ns3.he.net.<br />ayankeeindixie.com.&nbsp; &nbsp; 86400&nbsp; &nbsp; IN&nbsp; &nbsp; NS&nbsp; &nbsp; ns4.he.net.<br />ayankeeindixie.com.&nbsp; &nbsp; 86400&nbsp; &nbsp; IN&nbsp; &nbsp; NS&nbsp; &nbsp; ns5.he.net.<br />ayankeeindixie.com.&nbsp; &nbsp; 300&nbsp; &nbsp; IN&nbsp; &nbsp; AAAA&nbsp; &nbsp; 2001:5b0:2d5a:8fc0:c63d:c7ff:fe97:f0fa</p><p>however, the script kept counting and the Luci Overview has not reflected the change having taken place.</p><p>For some reason I don&#039;t understand, I lost communication with that console window, so I opened another, then killed the running script.&nbsp; At this time, Luci is still not reporting an update having happened.</p><p>Bill</p>									</div>
			</article>

			
		
						<div class="notice">
				<p>Sorry, posts 26 to 25 are missing from our archive.</p>
			</div>
		
		
	
	<div class="pagination"><div class="pagination-number">Page 1 of 6</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=50908&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=50908&amp;p=3.html">3</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=50908&amp;p=6.html">6</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0.001 -->

</body>
</html>