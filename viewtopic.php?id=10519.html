<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> New unofficial whiterussian firmware</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 31 Mar 2018 and 23 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=10519&amp;p=2.html">2</a></li></ul></nav></div>
			
		
		
			<article class="post" id="p47293">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">solca</div>
					<div class="post-datetime">
						27 Apr 2007, 23:34					</div>
				</div>
				<div class="post-content content">
					<p>Hi!</p><p>I build a new whiterussian firmware to fix a problem as discussed <a href="http://forum.openwrt.org/viewtopic.php?id=9700&amp;p=1">here</a> but some of you could find it useful for other situations, so I post it here for review and comment.</p><p><strong>Kamikaze have all this resolved plus is a lot better, this is just a bandage to whiterussian (which is obsolete), please if you can, use Kamikaze instead.</strong></p><p>Latest <a href="http://home.galileo.edu/~solca/openwrt/whiterussian.new.patch.bz2">source patch</a> (Version 5).</p><p>Version 5 - May/20/2007 - Changes:<br />Decouple netfilter (specially ip_conntrack) from the kernel to external loadable modules in kmod_iptables package.<br />Fix selects and depends for kmod_iptables.<br />Fix iptables list of builtin extensions.</p><p>Version 4 - May/20/2007 - Changes:<br />Resync with svn.<br />Revert back gcc, kernel, wlcompat, switch, iptables and squashfs versions in order to keep binary/source compatibility and minimum differences with upstream Whiterussian.<br />Port Kamikaze&#039;s bcm47xx arch to kernel 2.4.30 so latest wl driver works with this kernel.</p><p>Version 3 - May/4/2007 - Changes:<br />wl driver from 4.80.9.2 to 4.80.53.0<br />wificonf patched to recognize wl?_spect nvram variable, if not present disable spectrum management (802.11h &amp; 802.11d) at wifi setup.<br />netconsole dropped (instability with wl driver).</p><p>Version 2 - May/2/2007 - Changes:<br />Build fixes.<br />netconsole added.</p><p>Version 1 - April/25/2007 - Original changes to whiterussian (svn):<br />gcc from 3.4.4 to 3.4.6<br />kernel from 2.4.30 to 2.4.34.4<br />wl driver from 3.90.37.0 to packaged 4.80.9.2<br />wlcompat driver from kamikaze<br />diag driver from kamikaze<br />switch driver from kamikaze<br />iptables from 1.3.3 to 1.3.5<br />squashfs from 2.1r2 to 3.0</p>											<p class="post-edited">(Last edited by <strong>solca</strong> on 20 May 2007, 22:34)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p47506">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">acoul</div>
					<div class="post-datetime">
						2 May 2007, 11:48					</div>
				</div>
				<div class="post-content content">
					<p>Great work.&nbsp; Thank you.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p47672">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">vincentfox</div>
					<div class="post-datetime">
						4 May 2007, 06:17					</div>
				</div>
				<div class="post-content content">
					<p>I am baffled by why 802.11h is even present? From what I have read on Wikipedia it&#039;s an interference-avoidance addition to 802.11a, which makes no sense on an 802.11g radio.&nbsp; Anyhow, will try the firmware out on an in-house AP.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p47690">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">lc</div>
					<div class="post-datetime">
						4 May 2007, 13:51					</div>
				</div>
				<div class="post-content content">
					<p>Hi!</p><p>Good news: Seems the &quot;wl spect 0&quot; setting works! Great Job,&nbsp; Solca!!!!! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p47694">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">haye</div>
					<div class="post-datetime">
						4 May 2007, 15:22					</div>
				</div>
				<div class="post-content content">
					<p>This sounds good to me, thanks to everyone involved in this topic by hunting down the problem, building custom firmwares and testing them!</p><p>@devs:<br />Is it likely to get a new official White Russian release based on Solca&#039;s changes if further testing during the next days and weeks is successful?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p47698">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">booBot</div>
					<div class="post-datetime">
						4 May 2007, 16:01					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>solca wrote:</cite><blockquote><p>wl driver from 3.90.37.0 to 4.80.9.2</p></blockquote></div><p>Why not the <strong>4.80.53.0</strong>?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p47706">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">solca</div>
					<div class="post-datetime">
						4 May 2007, 18:53					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>vincentfox wrote:</cite><blockquote><p>I am baffled by why 802.11h is even present? From what I have read on Wikipedia it&#039;s an interference-avoidance addition to 802.11a, which makes no sense on an 802.11g radio.&nbsp; Anyhow, will try the firmware out on an in-house AP.</p></blockquote></div><p>Good question, just a guess: wl driver works for 802.11a and 802.11bg, just that the broadcom developers forgot to disable 802.11h (or 802.11d) when operating in 802.11bg environment, pretty sure it is a bug.</p><p>The question is: why just Intel cards seems affected?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p47708">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">solca</div>
					<div class="post-datetime">
						4 May 2007, 19:00					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>booBot wrote:</cite><blockquote><div class="quotebox"><cite>solca wrote:</cite><blockquote><p>wl driver from 3.90.37.0 to 4.80.9.2</p></blockquote></div><p>Why not the <strong>4.80.53.0</strong>?</p></blockquote></div><p>Because was a typo, initially I was targetting 4.80.53.0 and just change the version description, not the actual code to fetch it, as I was trying which ones were working versions the code remains in 4.80.9.2.</p><p>I&#039;m working in a new version which correctly will use 4.80.53.0 and will patch the wificonf source to disable 802.11h and 802.11d in startup so no special steps needs to be made to have a working WRT.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p47715">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">kebab</div>
					<div class="post-datetime">
						4 May 2007, 20:00					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m not sure whether this is related to solca&#039;s patch, or an issue related to the current Whiterussian SVN. I applied solca&#039;s patch to the latest SVN image and selected to build image maker. Everthing built fine, whiterussian images produced and image builder bzipped tar archive.</p><p>I installed the &quot;openwrt-brcm-2.4-squashfs.trx&quot; image (i.e. the one built during the SVN Whiterussian build process) onto a Buffalo WHR-G54S and it worked perfectly (Excellent work solca :-) ).</p><p>I then tested image builder and built the default firmware and a slightly customised image. When either of these images were installed on the Buffalo, the router would boot successfully the first time, but when I tried to reboot, it failed to boot and sat there with the red light flashing. When I reinstalled the original firmware image (i.e. the one built during the SVN Whiterussian build process), the router booted up fine and reboots fine.</p><p>I tried to reinstall the image builder firmware images (default firmware and a slightly customised image) and the reboot issue came back.</p><p>I tried the same images on a Belkin F5D7231-4P and the same problem occurred.</p><p>Could image builder have been broken, does anyone have any suggestions ?</p><p>Thanks.</p><p>* Just tried again with a new Buffalo WHR-G54S out of the box, same problem although I managed to reboot it 5 or 6 times before it died :-(</p><p>-----------</p><p>I&#039;ve just tried to apply the patch to Whiterussian-0.9 (i.e. not SVN) and get the follow error, it looks like the build process is looking for iptables-1.3.3 rather than the updated version 1.3.5. Can anyone suggest a fix ?</p><p> :191:1: warning: this is the location of the previous definition<br />extensions/libipt_connbytes.c: In function `parse&#039;:<br />extensions/libipt_connbytes.c:87: error: `IPT_CONNBYTES_WHAT_PKTS&#039; undeclared (first use in this function)<br />extensions/libipt_connbytes.c:87: error: (Each undeclared identifier is reported only once<br />extensions/libipt_connbytes.c:87: error: for each function it appears in.)<br />extensions/libipt_connbytes.c:89: error: `IPT_CONNBYTES_WHAT_BYTES&#039; undeclared (first use in this function)<br />extensions/libipt_connbytes.c:91: error: `IPT_CONNBYTES_WHAT_AVGPKT&#039; undeclared (first use in this function)<br />extensions/libipt_connbytes.c: In function `print_mode&#039;:<br />extensions/libipt_connbytes.c:114: error: `IPT_CONNBYTES_WHAT_PKTS&#039; undeclared (first use in this function)<br />extensions/libipt_connbytes.c:117: error: `IPT_CONNBYTES_WHAT_BYTES&#039; undeclared (first use in this function)<br />extensions/libipt_connbytes.c:120: error: `IPT_CONNBYTES_WHAT_AVGPKT&#039; undeclared (first use in this function)<br />make[3]: *** [extensions/libipt_connbytes_sh.o] Error 1<br />make[3]: Leaving directory `/home/kenw/newbuildwhiterussian/whiterussian-0.9/build_mipsel/iptables-1.3.3&#039;<br />make[2]: *** [/home/kenw/newbuildwhiterussian/whiterussian-0.9/build_mipsel/iptables-1.3.3/.built] Error 2<br />make[2]: Leaving directory `/home/kenw/newbuildwhiterussian/whiterussian-0.9/package/iptables&#039;<br />make[1]: *** [iptables-compile] Error 2<br />make[1]: Leaving directory `/home/kenw/newbuildwhiterussian/whiterussian-0.9/package&#039;<br />make: *** [package/compile] Error 2</p>											<p class="post-edited">(Last edited by <strong>kebab</strong> on 4 May 2007, 22:08)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p47723">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">liquid</div>
					<div class="post-datetime">
						4 May 2007, 22:31					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>kebab wrote:</cite><blockquote><p>I&#039;m not sure whether this is related to solca&#039;s patch, or an issue related to the current Whiterussian SVN. I applied solca&#039;s patch to the latest SVN image and selected to build image maker. Everthing built fine, whiterussian images produced and image builder bzipped tar archive.</p><p>I installed the &quot;openwrt-brcm-2.4-squashfs.trx&quot; image (i.e. the one built during the SVN Whiterussian build process) onto a Buffalo WHR-G54S and it worked perfectly (Excellent work solca :-) ).</p><p>I then tested image builder and built the default firmware and a slightly customised image. When either of these images were installed on the Buffalo, the router would boot successfully the first time, but when I tried to reboot, it failed to boot and sat there with the red light flashing. When I reinstalled the original firmware image (i.e. the one built during the SVN Whiterussian build process), the router booted up fine and reboots fine.</p><p>I tried to reinstall the image builder firmware images (default firmware and a slightly customised image) and the reboot issue came back.</p><p>I tried the same images on a Belkin F5D7231-4P and the same problem occurred.</p><p>Could image builder have been broken, does anyone have any suggestions ?</p><p>Thanks.</p><p>* Just tried again with a new Buffalo WHR-G54S out of the box, same problem although I managed to reboot it 5 or 6 times before it died :-(</p><p>-----------</p><p>I&#039;ve just tried to apply the patch to Whiterussian-0.9 (i.e. not SVN) and get the follow error, it looks like the build process is looking for iptables-1.3.3 rather than the updated version 1.3.5. Can anyone suggest a fix ?</p><p> :191:1: warning: this is the location of the previous definition<br />extensions/libipt_connbytes.c: In function `parse&#039;:<br />extensions/libipt_connbytes.c:87: error: `IPT_CONNBYTES_WHAT_PKTS&#039; undeclared (first use in this function)<br />extensions/libipt_connbytes.c:87: error: (Each undeclared identifier is reported only once<br />extensions/libipt_connbytes.c:87: error: for each function it appears in.)<br />extensions/libipt_connbytes.c:89: error: `IPT_CONNBYTES_WHAT_BYTES&#039; undeclared (first use in this function)<br />extensions/libipt_connbytes.c:91: error: `IPT_CONNBYTES_WHAT_AVGPKT&#039; undeclared (first use in this function)<br />extensions/libipt_connbytes.c: In function `print_mode&#039;:<br />extensions/libipt_connbytes.c:114: error: `IPT_CONNBYTES_WHAT_PKTS&#039; undeclared (first use in this function)<br />extensions/libipt_connbytes.c:117: error: `IPT_CONNBYTES_WHAT_BYTES&#039; undeclared (first use in this function)<br />extensions/libipt_connbytes.c:120: error: `IPT_CONNBYTES_WHAT_AVGPKT&#039; undeclared (first use in this function)<br />make[3]: *** [extensions/libipt_connbytes_sh.o] Error 1<br />make[3]: Leaving directory `/home/kenw/newbuildwhiterussian/whiterussian-0.9/build_mipsel/iptables-1.3.3&#039;<br />make[2]: *** [/home/kenw/newbuildwhiterussian/whiterussian-0.9/build_mipsel/iptables-1.3.3/.built] Error 2<br />make[2]: Leaving directory `/home/kenw/newbuildwhiterussian/whiterussian-0.9/package/iptables&#039;<br />make[1]: *** [iptables-compile] Error 2<br />make[1]: Leaving directory `/home/kenw/newbuildwhiterussian/whiterussian-0.9/package&#039;<br />make: *** [package/compile] Error 2</p></blockquote></div><p>do a make distclean and start over... that should resolve your issue (assuming your patch applied cleanly).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p47728">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">solca</div>
					<div class="post-datetime">
						4 May 2007, 22:59					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>liquid wrote:</cite><blockquote><p>do a make distclean and start over... that should resolve your issue (assuming your patch applied cleanly).</p></blockquote></div><p>liquid: do you still have a copy of my _first_original_ patch? I delete it and now have problems with the next iterations as I modified a lot of code for debugging the association issues <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>Edit: Found the problem, was netconsole module, I remove it (it help me a lot in the beginning).</p>											<p class="post-edited">(Last edited by <strong>solca</strong> on 5 May 2007, 01:22)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p47735">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">kebab</div>
					<div class="post-datetime">
						5 May 2007, 00:46					</div>
				</div>
				<div class="post-content content">
					<p>Thanks Liquid.</p><p>The patch applied cleanly, but unfortunately make distclean didn&#039;t help.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p47737">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">solca</div>
					<div class="post-datetime">
						5 May 2007, 01:24					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>kebab wrote:</cite><blockquote><p>Thanks Liquid.</p><p>The patch applied cleanly, but unfortunately make distclean didn&#039;t help.</p></blockquote></div><p>kebab could you please check if you still have problems with my <a href="http://forum.openwrt.org/viewtopic.php?pid=47293#p47293">latest patch</a>?&nbsp; Thank you.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p47764">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">kebab</div>
					<div class="post-datetime">
						5 May 2007, 13:46					</div>
				</div>
				<div class="post-content content">
					<p>Solca, I still have the same problem with the new patch.</p><p>/home/kenw/newbuildwhiterussian/whiterussian-0.9/staging_dir_mipsel/lib/gcc/mipsel-linux-uclibc/3.4.6/../../../../mipsel-linux-uclibc/sys-include/sys/cdefs.h:191:1: warning: this is the location of the previous definition<br />extensions/libipt_connbytes.c: In function `parse&#039;:<br />extensions/libipt_connbytes.c:87: error: `IPT_CONNBYTES_WHAT_PKTS&#039; undeclared (first use in this function)<br />extensions/libipt_connbytes.c:87: error: (Each undeclared identifier is reported only once<br />extensions/libipt_connbytes.c:87: error: for each function it appears in.)<br />extensions/libipt_connbytes.c:89: error: `IPT_CONNBYTES_WHAT_BYTES&#039; undeclared (first use in this function)<br />extensions/libipt_connbytes.c:91: error: `IPT_CONNBYTES_WHAT_AVGPKT&#039; undeclared (first use in this function)<br />extensions/libipt_connbytes.c: In function `print_mode&#039;:<br />extensions/libipt_connbytes.c:114: error: `IPT_CONNBYTES_WHAT_PKTS&#039; undeclared (first use in this function)<br />extensions/libipt_connbytes.c:117: error: `IPT_CONNBYTES_WHAT_BYTES&#039; undeclared (first use in this function)<br />extensions/libipt_connbytes.c:120: error: `IPT_CONNBYTES_WHAT_AVGPKT&#039; undeclared (first use in this function)<br />make[3]: *** [extensions/libipt_connbytes_sh.o] Error 1<br />make[3]: Leaving directory `/home/kenw/newbuildwhiterussian/whiterussian-0.9/build_mipsel/iptables-1.3.3&#039;<br />make[2]: *** [/home/kenw/newbuildwhiterussian/whiterussian-0.9/build_mipsel/iptables-1.3.3/.built] Error 2<br />make[2]: Leaving directory `/home/kenw/newbuildwhiterussian/whiterussian-0.9/package/iptables&#039;<br />make[1]: *** [iptables-compile] Error 2<br />make[1]: Leaving directory `/home/kenw/newbuildwhiterussian/whiterussian-0.9/package&#039;<br />make: *** [package/compile] Error 2</p><br /><p>Contents of the build directory /home/kenw/newbuildwhiterussian/whiterussian-0.9/build_mipsel</p><p>drwxr-xr-x&nbsp; &nbsp;4 root root&nbsp; &nbsp;4096 May&nbsp; 5 11:30 base-files<br />drwxr-xr-x&nbsp; &nbsp;7 2997 users&nbsp; 4096 May&nbsp; 5 11:30 bridge-utils-1.0.6<br />drwxr-xr-x&nbsp; 29 1000&nbsp; 1000&nbsp; 4096 May&nbsp; 5 11:35 busybox-1.00<br />drwxr-xr-x&nbsp; &nbsp;9 kenw users&nbsp; 4096 May&nbsp; 5 11:36 dnsmasq-2.35<br />drwx------&nbsp; &nbsp;7 1001&nbsp; 1001&nbsp; 4096 May&nbsp; 5 11:39 dropbear-0.48.1<br />drwxrwxrwx&nbsp; &nbsp;7 1000&nbsp; 1000&nbsp; 4096 May&nbsp; 5 11:39 haserl-0.8.0<br />drwxrwxrwx&nbsp; &nbsp;9&nbsp; 106 users 12288 May&nbsp; 5 11:42 ipkg-0.99.149<br />drwxr-sr-x&nbsp; &nbsp;3 1000&nbsp; 1000&nbsp; 4096 May&nbsp; 5 10:47 ipkg-utils-1.7<br />drwxr-xr-x&nbsp; &nbsp;9 1000&nbsp; 1000&nbsp; 4096 May&nbsp; 5 11:42 iptables-1.3.3<br />lrwxrwxrwx&nbsp; &nbsp;1 root root&nbsp; &nbsp; &nbsp;91 May&nbsp; 5 11:03 linux -&gt; /home/kenw/newbuildwhiterussian/whiterussian-0.9/build_mipsel/linux-2.4-brcm/linux-2.4.34.4<br />drwxr-xr-x&nbsp; 11 root root&nbsp; &nbsp;4096 May&nbsp; 5 11:29 linux-2.4-brcm<br />drwxr-xr-x&nbsp; &nbsp;3 root root&nbsp; &nbsp;4096 May&nbsp; 5 11:02 lzma<br />drwxr-xr-x&nbsp; &nbsp;3 root root&nbsp; &nbsp;4096 May&nbsp; 5 11:30 nvram<br />drwxr-xr-x&nbsp; 19 root&nbsp; &nbsp;502&nbsp; 4096 May&nbsp; 5 11:04 squashfs3.0<br />drwxr-xr-x&nbsp; &nbsp;2 root root&nbsp; &nbsp;4096 May&nbsp; 5 11:42 stamp<br />drwxr-xr-x&nbsp; &nbsp;2 root root&nbsp; &nbsp;4096 May&nbsp; 5 11:01 target-utils</p><p>iptables-1.3.3 directory exists, shouldn&#039;t this be iptables-1.3.5 ?</p><p>Thanks</p>											<p class="post-edited">(Last edited by <strong>kebab</strong> on 5 May 2007, 13:50)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p47807">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">solca</div>
					<div class="post-datetime">
						5 May 2007, 22:21					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>kebab wrote:</cite><blockquote><p>Solca, I still have the same problem with the new patch.</p><p>...</p><p>iptables-1.3.3 directory exists, shouldn&#039;t this be iptables-1.3.5 ?</p><p>Thanks</p></blockquote></div><p>You are trying to apply this patch to whiterussian-0.9 and it doesn&#039;t apply cleanly, patch is for whiterussian svn.<br />On the other side is trivial to fix, just check whiterussian-0.9/package/iptables/Makefile.rej and fix the Makefile.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p47810">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">kebab</div>
					<div class="post-datetime">
						5 May 2007, 22:47					</div>
				</div>
				<div class="post-content content">
					<p>Thanks solca...</p><p>The reason I am trying to apply your patch to Whiterussian-0.9, is because of boot up issues I had with images generated with image builder (see my posting Yesterday 19:00:59).</p><p>I&#039;ve just build a non-patched Whiterussian version from SVN, to see whether the boot issues are related to the current SVN or your patch.</p><p>Thanks again...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p47846">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">lc</div>
					<div class="post-datetime">
						6 May 2007, 14:39					</div>
				</div>
				<div class="post-content content">
					<p>Now that wireless runs rock-stable I bumped into another issue. In my previous posts I wrote that even though the reboots have disappeared, a few devices seemed to have crashed. I did more research and actually the devices did not crash - only the network became non-functional.</p><p>This occurs at locations with real heavy usage - therefore very seldom. I managed to save a log - here are the essential lines:</p><div class="codebox"><pre><code>May  6 12:31:06 wrt kern.err chillispot[703]: radius.c: 1269: 132 (No buffer space available) sendto() failed!
May  6 12:31:06 wrt kern.warn kernel: NET: 494 messages suppressed.
May  6 12:31:06 wrt kern.warn kernel: dst cache overflow</code></pre></div><p>Results of free:<br /></p><div class="codebox"><pre><code>              total         used         free       shared      buffers
  Mem:        14284        13512          772            0          412
 Swap:            0            0            0
Total:        14284        13512          772</code></pre></div><p>The dst cache very well explained here: <a href="http://www.mail-archive.com/netdev@vger.kernel.org/msg02107.html">http://www.mail-archive.com/netdev@vger … 02107.html</a> - it is a routing cache.&nbsp; When it overflows the device can&#039;t communicate anymore after a while.</p><p>According to /proc/sys/net/ipv4/route/max_size is 8192</p><p>I am not sure whether this is a problem or if the little WRT devices just reach their limits under extreme conditions. Also it might not be related to solca&#039;s version at all. In the past the devices simply rebooted before this cache could overflow.</p><p>EDIT: The number of entries given by &quot;ip route ls cache&quot; is normal when the cache overflows.</p><p>What is your opinion about it (should it be moved to a new thread?)?</p><p>lc</p>											<p class="post-edited">(Last edited by <strong>lc</strong> on 6 May 2007, 18:50)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p47919">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">solca</div>
					<div class="post-datetime">
						6 May 2007, 23:10					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>lc wrote:</cite><blockquote><div class="codebox"><pre><code>May  6 12:31:06 wrt kern.err chillispot[703]: radius.c: 1269: 132 (No buffer space available) sendto() failed!
May  6 12:31:06 wrt kern.warn kernel: NET: 494 messages suppressed.
May  6 12:31:06 wrt kern.warn kernel: dst cache overflow</code></pre></div></blockquote></div><p>Hi!</p><p>For me the &#039;dst cache overflow&#039; is a consequence of the &#039;No buffer space available&#039; when chillispot try to send data to your radius server.&nbsp; Something is eating your memory (and that can be normal just high usage/traffic relative to WRT potential).&nbsp; Maybe is time to put a big (more RAM) WRT in those locations or move chillispot to another box.&nbsp; The &#039;No buffer space available&#039; can be triggered by other factors, check&#039;em too, I bet your problem is low mem condition.</p><div class="quotebox"><cite>lc wrote:</cite><blockquote><p>What is your opinion about it (should it be moved to a new thread?)?</p></blockquote></div><p>Sure, is OT here.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p47937">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">netprince</div>
					<div class="post-datetime">
						7 May 2007, 04:56					</div>
				</div>
				<div class="post-content content">
					<p>Hey Solca, I built the firmware using your patch (v3) without problems.&nbsp; Its running fine.&nbsp; I&#039;m looking at the binarys provided by linksys (nas, wl, etc), but I&#039;m not sure what to do with wl_apsta and/or wl_apsta_mimo.</p><p><a href="http://downloads.openwrt.org/sources/broadcom-wl-4.80.9.2.tar.bz2">http://downloads.openwrt.org/sources/br … .2.tar.bz2</a></p><p>Do I need to replace wl.o or wlcompat.o with one of these?&nbsp; Or perhaps I should not use the new binaries at all?</p><p>By the way, great work!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p47939">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">solca</div>
					<div class="post-datetime">
						7 May 2007, 05:58					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>netprince wrote:</cite><blockquote><p>Hey Solca, I built the firmware using your patch (v3) without problems.&nbsp; Its running fine.&nbsp; I&#039;m looking at the binarys provided by linksys (nas, wl, etc), but I&#039;m not sure what to do with wl_apsta and/or wl_apsta_mimo.</p><p><a href="http://downloads.openwrt.org/sources/broadcom-wl-4.80.9.2.tar.bz2">http://downloads.openwrt.org/sources/br … .2.tar.bz2</a></p><p>Do I need to replace wl.o or wlcompat.o with one of these?&nbsp; Or perhaps I should not use the new binaries at all?</p><p>By the way, great work!</p></blockquote></div><p>You should use <a href="http://downloads.openwrt.org/sources/broadcom-wl-4.80.53.0.tar.bz2">http://downloads.openwrt.org/sources/br … .0.tar.bz2</a> instead.</p><p>wl_apsta.o and wl_apsta_mimo.o are object files needed to construct the propietary wl.o driver (MIMO is for the pre 802.11n devices) so you don&#039;t need to mess with them, my patch downloads the above file, extracts the object files and build the wl.o driver.&nbsp; You just need to copy the wl and nas binaries if you plan to use them.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p47951">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">davide125</div>
					<div class="post-datetime">
						7 May 2007, 11:50					</div>
				</div>
				<div class="post-content content">
					<p>Building from whiterussian SVN + solca patch (3rd revision) kmod-fuse build fails:<br /></p><div class="codebox"><pre><code>make[9]: Entering directory `/home/davide/openwrt/0.9-patched/whiterussian/openwrt/build_mipsel/linux-2.4-brcm/fuse-2.2.1/kernel&#039;
/home/davide/openwrt/0.9-patched/whiterussian/openwrt/staging_dir_mipsel/bin/mipsel-linux-uclibc-gcc -D__KERNEL__ -I/home/davide/openwrt/0.9-patched/whiterussian/openwrt/build_mipsel/linux-2.4-brcm/linux-2.4.34.4/include -Wall -Wstrict-prototypes -Wno-trigraphs -Os -fno-strict-aliasing -fno-common -fno-builtin-sprintf -fomit-frame-pointer   -funit-at-a-time -pipe  -fno-unit-at-a-time -DMODULE -DFUSE_VERSION=\&quot;2.2.1\&quot; -nostdinc -iwithprefix include -DKBUILD_BASENAME=dev  -c -o dev.o dev.c
{standard input}: Assembler messages:
{standard input}:242: Error: opcode not supported on this processor: mips1 (mips1) `ll $3,8($4)&#039;
{standard input}:244: Error: opcode not supported on this processor: mips1 (mips1) `sc $3,8($4)&#039;
{standard input}:268: Error: opcode not supported on this processor: mips1 (mips1) `ll $2,8($4)&#039;
{standard input}:270: Error: opcode not supported on this processor: mips1 (mips1) `sc $2,8($4)&#039;
{standard input}:354: Error: opcode not supported on this processor: mips1 (mips1) `ll $3,52($16)&#039;
{standard input}:356: Error: opcode not supported on this processor: mips1 (mips1) `sc $2,52($16)&#039;
{standard input}:359: Error: opcode not supported on this processor: mips1 (mips1) `sync &#039;
{standard input}:454: Error: opcode not supported on this processor: mips1 (mips1) `ll $3,52($16)&#039;
{standard input}:456: Error: opcode not supported on this processor: mips1 (mips1) `sc $2,52($16)&#039;
{standard input}:459: Error: opcode not supported on this processor: mips1 (mips1) `sync &#039;
{standard input}:631: Error: opcode not supported on this processor: mips1 (mips1) `ll $6,8($5)&#039;
{standard input}:633: Error: opcode not supported on this processor: mips1 (mips1) `sc $3,8($5)&#039;
{standard input}:636: Error: opcode not supported on this processor: mips1 (mips1) `sync &#039;
{standard input}:678: Error: opcode not supported on this processor: mips1 (mips1) `ll $2,8($5)&#039;
{standard input}:680: Error: opcode not supported on this processor: mips1 (mips1) `sc $3,8($5)&#039;
{standard input}:683: Error: opcode not supported on this processor: mips1 (mips1) `sync &#039;
{standard input}:822: Error: opcode not supported on this processor: mips1 (mips1) `ll $2,20($4)&#039;
{standard input}:824: Error: opcode not supported on this processor: mips1 (mips1) `sc $2,20($4)&#039;
make[9]: *** [dev.o] Error 1
make[9]: Leaving directory `/home/davide/openwrt/0.9-patched/whiterussian/openwrt/build_mipsel/linux-2.4-brcm/fuse-2.2.1/kernel&#039;
make[8]: *** [_mod_/home/davide/openwrt/0.9-patched/whiterussian/openwrt/build_mipsel/linux-2.4-brcm/fuse-2.2.1/kernel] Error 2
make[8]: Leaving directory `/home/davide/openwrt/0.9-patched/whiterussian/openwrt/build_mipsel/linux-2.4-brcm/linux-2.4.34.4&#039;
make[7]: *** [all-spec] Error 2
make[7]: Leaving directory `/home/davide/openwrt/0.9-patched/whiterussian/openwrt/build_mipsel/linux-2.4-brcm/fuse-2.2.1/kernel&#039;
make[6]: *** [all-recursive] Error 1
make[6]: Leaving directory `/home/davide/openwrt/0.9-patched/whiterussian/openwrt/build_mipsel/linux-2.4-brcm/fuse-2.2.1&#039;
make[5]: *** [/home/davide/openwrt/0.9-patched/whiterussian/openwrt/build_mipsel/linux-2.4-brcm/fuse-2.2.1/.built] Error 2
make[5]: Leaving directory `/home/davide/openwrt/0.9-patched/whiterussian/openwrt/target/linux/package/fuse&#039;
make[4]: *** [fuse-compile] Error 2
make[4]: Leaving directory `/home/davide/openwrt/0.9-patched/whiterussian/openwrt/target/linux/package&#039;
make[3]: *** [/home/davide/openwrt/0.9-patched/whiterussian/openwrt/build_mipsel/stamp/.linux-compile] Error 2
make[3]: Leaving directory `/home/davide/openwrt/0.9-patched/whiterussian/openwrt/target/linux/linux-2.4&#039;
make[2]: *** [2.4/brcm-compile] Error 2
make[2]: Leaving directory `/home/davide/openwrt/0.9-patched/whiterussian/openwrt/target/linux&#039;
make[1]: *** [linux-compile] Error 2
make[1]: Leaving directory `/home/davide/openwrt/0.9-patched/whiterussian/openwrt/target&#039;
make: *** [target/compile] Error 2</code></pre></div><p>There is a similar problem with shfs<br /></p><div class="codebox"><pre><code>make[9]: Entering directory `/home/davide/openwrt/0.9-patched/whiterussian/openwrt/build_mipsel/linux-2.4-brcm/linux-2.4.34.4&#039;
make -C  /home/davide/openwrt/0.9-patched/whiterussian/openwrt/build_mipsel/linux-2.4-brcm/shfs-0.35/shfs/Linux-2.4 CFLAGS=&quot;-D__KERNEL__ -I/home/davide/openwrt/0.9-patched/whiterussian/openwrt/build_mipsel/linux-2.4-brcm/linux-2.4.34.4/include -Wall -Wstrict-prototypes -Wno-trigraphs -Os -fno-strict-aliasing -fno-common -fno-builtin-sprintf -fomit-frame-pointer   -funit-at-a-time -pipe  -fno-unit-at-a-time -DMODULE&quot; MAKING_MODULES=1 modules
make[10]: Entering directory `/home/davide/openwrt/0.9-patched/whiterussian/openwrt/build_mipsel/linux-2.4-brcm/shfs-0.35/shfs/Linux-2.4&#039;
Makefile:52: warning: overriding commands for target `shfs.o&#039;
/home/davide/openwrt/0.9-patched/whiterussian/openwrt/build_mipsel/linux-2.4-brcm/linux-2.4.34.4/Rules.make:97: warning: ignoring old commands for target `shfs.o&#039;
/home/davide/openwrt/0.9-patched/whiterussian/openwrt/staging_dir_mipsel/bin/mipsel-linux-uclibc-gcc -D__KERNEL__ -I/home/davide/openwrt/0.9-patched/whiterussian/openwrt/build_mipsel/linux-2.4-brcm/linux-2.4.34.4/include -Wall -Wstrict-prototypes -Wno-trigraphs -Os -fno-strict-aliasing -fno-common -fno-builtin-sprintf -fomit-frame-pointer   -funit-at-a-time -pipe  -fno-unit-at-a-time -DMODULE  -nostdinc -iwithprefix include -DKBUILD_BASENAME=dcache  -c -o dcache.o dcache.c
{standard input}: Assembler messages:
{standard input}:165: Error: opcode not supported on this processor: mips1 (mips1) `ll $2,24($16)&#039;
{standard input}:167: Error: opcode not supported on this processor: mips1 (mips1) `sc $2,24($16)&#039;
{standard input}:554: Error: opcode not supported on this processor: mips1 (mips1) `ll $2,24($3)&#039;
{standard input}:556: Error: opcode not supported on this processor: mips1 (mips1) `sc $2,24($3)&#039;
make[10]: *** [dcache.o] Error 1
make[10]: Leaving directory `/home/davide/openwrt/0.9-patched/whiterussian/openwrt/build_mipsel/linux-2.4-brcm/shfs-0.35/shfs/Linux-2.4&#039;
make[9]: *** [_mod_/home/davide/openwrt/0.9-patched/whiterussian/openwrt/build_mipsel/linux-2.4-brcm/shfs-0.35/shfs/Linux-2.4] Error 2
make[9]: Leaving directory `/home/davide/openwrt/0.9-patched/whiterussian/openwrt/build_mipsel/linux-2.4-brcm/linux-2.4.34.4&#039;
make[8]: *** [all-y] Error 2
make[8]: Leaving directory `/home/davide/openwrt/0.9-patched/whiterussian/openwrt/build_mipsel/linux-2.4-brcm/shfs-0.35/shfs/Linux-2.4&#039;
make[7]: *** [all] Error 2
make[7]: Leaving directory `/home/davide/openwrt/0.9-patched/whiterussian/openwrt/build_mipsel/linux-2.4-brcm/shfs-0.35/shfs&#039;
make[6]: *** [module] Error 2
make[6]: Leaving directory `/home/davide/openwrt/0.9-patched/whiterussian/openwrt/build_mipsel/linux-2.4-brcm/shfs-0.35&#039;
make[5]: *** [/home/davide/openwrt/0.9-patched/whiterussian/openwrt/build_mipsel/linux-2.4-brcm/shfs-0.35/.built] Error 2
make[5]: Leaving directory `/home/davide/openwrt/0.9-patched/whiterussian/openwrt/target/linux/package/shfs&#039;
make[4]: *** [shfs-compile] Error 2
make[4]: Leaving directory `/home/davide/openwrt/0.9-patched/whiterussian/openwrt/target/linux/package&#039;
make[3]: *** [/home/davide/openwrt/0.9-patched/whiterussian/openwrt/build_mipsel/stamp/.linux-compile] Error 2
make[3]: Leaving directory `/home/davide/openwrt/0.9-patched/whiterussian/openwrt/target/linux/linux-2.4&#039;
make[2]: *** [2.4/brcm-compile] Error 2
make[2]: Leaving directory `/home/davide/openwrt/0.9-patched/whiterussian/openwrt/target/linux&#039;
make[1]: *** [linux-compile] Error 2
make[1]: Leaving directory `/home/davide/openwrt/0.9-patched/whiterussian/openwrt/target&#039;
make: *** [target/compile] Error 2</code></pre></div><p>Any ideas?</p><p>Davide</p>											<p class="post-edited">(Last edited by <strong>davide125</strong> on 7 May 2007, 12:09)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p47956">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">netprince</div>
					<div class="post-datetime">
						7 May 2007, 14:29					</div>
				</div>
				<div class="post-content content">
					<p>When I try to start nas, i get:</p><div class="codebox"><pre><code>/usr/sbin/nas: can&#039;t resolve symbol &#039;wl_iovar_set&#039;</code></pre></div><p>I also tried with and without the libbcmcrypto.so from the broadcom-wl-4.80.53.0</p><p>EDIT: looks like some functions may be missing from wl.c, here is the kamikaze version:</p><p><a href="https://dev.openwrt.org/browser/trunk/package/nvram/src/wl.c">https://dev.openwrt.org/browser/trunk/p … m/src/wl.c</a></p>											<p class="post-edited">(Last edited by <strong>netprince</strong> on 7 May 2007, 16:39)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p47966">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">netprince</div>
					<div class="post-datetime">
						7 May 2007, 18:36					</div>
				</div>
				<div class="post-content content">
					<p>I managed to get the new nas running with the following patches:</p><p><a href="http://www.psyc.vt.edu/openwrt/wl.c.patch">http://www.psyc.vt.edu/openwrt/wl.c.patch</a><br /><a href="http://www.psyc.vt.edu/openwrt/wlutils.h.patch">http://www.psyc.vt.edu/openwrt/wlutils.h.patch</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p47967">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">solca</div>
					<div class="post-datetime">
						7 May 2007, 18:49					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>davide125 wrote:</cite><blockquote><p>Building from whiterussian SVN + solca patch (3rd revision) kmod-fuse build fails:</p><p>...</p><p>Any ideas?</p><p>Davide</p></blockquote></div><p>I never test compiling fuse and shfs, will take a look and update the patch.&nbsp; Thanks.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p47969">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">solca</div>
					<div class="post-datetime">
						7 May 2007, 19:04					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>netprince wrote:</cite><blockquote><p>I managed to get the new nas running with the following patches:</p><p><a href="http://www.psyc.vt.edu/openwrt/wl.c.patch">http://www.psyc.vt.edu/openwrt/wl.c.patch</a><br /><a href="http://www.psyc.vt.edu/openwrt/wlutils.h.patch">http://www.psyc.vt.edu/openwrt/wlutils.h.patch</a></p></blockquote></div><p>What parameters do you run nas?</p><p>Here it just works, just copy wl and nas to /usr/sbin and libbcmcrypto.so to /usr/lib.</p>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=10519&amp;p=2.html">2</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>