<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> vlan over wireless bridge, openvpn? wds?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 14 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p235933">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">beemer</div>
					<div class="post-datetime">
						7 Jun 2014, 19:05					</div>
				</div>
				<div class="post-content content">
					<p>Hello all,<br />I own a couple whr-hp-g54s and I need to build a wireless bridge across the yard. I&#039;m using a couple of panel antennas to assure a good connection across the distance.&nbsp; I also would like to trunk a couple of vlans across the wifi bridge.</p><p>I have been reading on this for days.. and testing.. and slowly driving myself mad.</p><p>So...<br />1. I have seen conflicting reports of wds being able to transport vlan tags correctly, anyone know if it can or cannot definitively?<br />&nbsp; a. If it can, is there a way to prevent wds from accepting client activity? Basically, can AP services be shut off for end clients but maintain the bridge?<br />2. If wds can&#039;t work, is there a way to use something like openvpn to pass the traffic over the bridge?</p><p>Thanks for the help,<br />Matt</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235935">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">3zl</div>
					<div class="post-datetime">
						7 Jun 2014, 19:16					</div>
				</div>
				<div class="post-content content">
					<p>How about to use something like L2-mesh solving all your problems..</p><p>We do have very good results with &quot;batman-adv&quot; in same usecases.</p><p>Once its setup ( not really difficult ) it has much less problems as any WDS related solution.</p><p>regards<br />3zl</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235937">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">beemer</div>
					<div class="post-datetime">
						7 Jun 2014, 19:21					</div>
				</div>
				<div class="post-content content">
					<p>3zl, Thanks!</p><p>I&#039;ll look into that, but with my relatively old WAPs, I&#039;m wondering if it&#039;ll support that...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235940">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">3zl</div>
					<div class="post-datetime">
						7 Jun 2014, 19:34					</div>
				</div>
				<div class="post-content content">
					<p>if the CPWifi if capable of adhoc there is no problem</p><p>Still have quite old WRT54 running same mesh with all sorts of never hardware mixed with b/g/n</p><p>any questions left ? just ask</p><p>btw. i considered to write a basic howto about batman-adv setup<br />so we can walk through it here</p><p>regards</p><p>3zl</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235945">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">beemer</div>
					<div class="post-datetime">
						7 Jun 2014, 20:24					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve arrived at challenge number 1.</p><p>I&#039;m using the whr-hp-g54 as listed here <a href="http://wiki.openwrt.org/toh/buffalo/whr-hp-g54">whr-hp-g54</a><br />And it specifies Backfire (10.03.1), which I have installed.</p><p>The only meshing system available is batmand. I&#039;m not loving the idea of building my own packages, so what is the best way to go about using batman-adv?</p><p>Thanks,<br />Matt</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235948">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">3zl</div>
					<div class="post-datetime">
						7 Jun 2014, 20:54					</div>
				</div>
				<div class="post-content content">
					<p>as the device has 4/16MB i think you can use AA 12.09 if theres no LUCI involved and add batman-adv via <br />opkg update <br />opkg install kmod-batman-adv&nbsp; <br />using abt 120kb should suffice.</p><p>i will have a look abt default LUCI in AA and an image for your CPE</p><p>edit : not quite clear to me, but seems its LUC in the std build image</p><p>if you specify what you need , i can make an image with imagebuilder</p><br /><p>regards<br />3zl</p>											<p class="post-edited">(Last edited by <strong>3zl</strong> on 7 Jun 2014, 21:47)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235951">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">beemer</div>
					<div class="post-datetime">
						7 Jun 2014, 21:33					</div>
				</div>
				<div class="post-content content">
					<p>I killed luci and all it&#039;s dependancies and uhttpd, and I&#039;m cli only. Is that enough?</p><p>Thanks,<br />Matt</p>											<p class="post-edited">(Last edited by <strong>beemer</strong> on 7 Jun 2014, 21:33)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235953">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">3zl</div>
					<div class="post-datetime">
						7 Jun 2014, 21:50					</div>
				</div>
				<div class="post-content content">
					<p>what OWRT release installed at the moment ?</p><p>8.x would not work,has to be AA 12.09<br />BB (trunk) is too &quot;fat&quot; for the device</p><p>please report free<br />&nbsp; &nbsp;top -b -n1 &gt; top.log<br />&nbsp; &nbsp;cat /pro/meminfo<br />&nbsp; &nbsp;cat /proc/modules</p><p>regards<br />3zl</p>											<p class="post-edited">(Last edited by <strong>3zl</strong> on 7 Jun 2014, 21:53)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235959">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">beemer</div>
					<div class="post-datetime">
						7 Jun 2014, 22:51					</div>
				</div>
				<div class="post-content content">
					<p>I upgraded to 12.09, r36088 and removed the packages luci-* and uhttpd.</p><p>I then tried to install kmod-batman-adv and got a memory allocation error.</p><p>I&#039;ve included what you&#039;ve asked for below.<br />Please forgive the length.</p><p>Matt </p><div class="codebox"><pre><code>Mem: 10212K used, 2812K free, 0K shrd, 600K buff, 1760K cached
CPU:   7% usr  15% sys   0% nic  76% idle   0% io   0% irq   0% sirq
Load average: 0.00 0.01 0.05 1/34 961
  PID  PPID USER     STAT   VSZ %VSZ %CPU COMMAND
  961   948 root     R     1500  11%  15% top -b -n1
  488     1 root     S     1540  12%   0% /sbin/netifd
  471     1 root     S     1512  12%   0% /sbin/syslogd -l 8 -C16
    1     0 root     S     1508  12%   0% init
  948   947 root     S     1508  12%   0% -ash
  358     1 root     S     1508  12%   0% init
  573   488 root     S     1504  12%   0% udhcpc -p /var/run/udhcpc-eth0.1.pid -s /lib/netifd/dhcp.script -f -t 0 -i eth0.1 -C
  944     1 root     S     1504  12%   0% /usr/sbin/ntpd -n -p 0.openwrt.pool.ntp.org -p
  473     1 root     S     1496  11%   0% /sbin/klogd
  558     1 root     S     1492  11%   0% /sbin/watchdog -t 5 /dev/watchdog
  947   893 root     S     1224   9%   0% /usr/sbin/dropbear -P /var/run/dropbear.1.pid -p 192.168.50.48:22
  893     1 root     S     1156   9%   0% /usr/sbin/dropbear -P /var/run/dropbear.1.pid -p 192.168.50.48:22
  933     1 nobody   S      948   7%   0% /usr/sbin/dnsmasq -C /var/etc/dnsmasq.conf
  482     1 root     S      876   7%   0% /sbin/ubusd
  475     1 root     S      844   6%   0% /sbin/hotplug2 --override --persistent --set-rules-file /etc/hotplug2.rules --set-coldplug-cmd /sbin/udevtrigger --max-children 1
   87     2 root     SW       0   0%   0% [kswapd0]
  333     2 root     SWN      0   0%   0% [jffs2_gcd_mtd3]
  150     2 root     SW       0   0%   0% [kworker/0:1]
  129     2 root     SW       0   0%   0% [mtdblock2]
    3     2 root     SW       0   0%   0% [ksoftirqd/0]
    5     2 root     SW       0   0%   0% [kworker/u:0]
  139     2 root     SW       0   0%   0% [mtdblock4]
   45     2 root     SW       0   0%   0% [sync_supers]
   88     2 root     SW       0   0%   0% [fsnotify_mark]
  124     2 root     SW       0   0%   0% [mtdblock1]
   49     2 root     SW&lt;      0   0%   0% [kblockd]
    2     0 root     SW       0   0%   0% [kthreadd]
  134     2 root     SW       0   0%   0% [mtdblock3]
  119     2 root     SW       0   0%   0% [mtdblock0]
  496     2 root     SW       0   0%   0% [kworker/0:2]
    6     2 root     SW&lt;      0   0%   0% [khelper]
    7     2 root     SW       0   0%   0% [kworker/u:1]
  400     2 root     SW&lt;      0   0%   0% [cfg80211]
   47     2 root     SW       0   0%   0% [bdi-default]</code></pre></div><div class="codebox"><pre><code>MemTotal:        4039124 kB
MemFree:          174376 kB
MemAvailable:    1300448 kB
Buffers:          157344 kB
Cached:          1283680 kB
SwapCached:       118376 kB
Active:          2219184 kB
Inactive:        1404632 kB
Active(anon):    1590176 kB
Inactive(anon):   776084 kB
Active(file):     629008 kB
Inactive(file):   628548 kB
Unevictable:         120 kB
Mlocked:             120 kB
SwapTotal:       5767164 kB
SwapFree:        5133804 kB
Dirty:                60 kB
Writeback:             0 kB
AnonPages:       2161876 kB
Mapped:           159496 kB
Shmem:            183468 kB
Slab:             128960 kB
SReclaimable:      74900 kB
SUnreclaim:        54060 kB
KernelStack:        4152 kB
PageTables:        40472 kB
NFS_Unstable:          0 kB
Bounce:                0 kB
WritebackTmp:          0 kB
CommitLimit:     7786724 kB
Committed_AS:    5606060 kB
VmallocTotal:   34359738367 kB
VmallocUsed:      361760 kB
VmallocChunk:   34359321368 kB
HardwareCorrupted:     0 kB
AnonHugePages:         0 kB
HugePages_Total:       0
HugePages_Free:        0
HugePages_Rsvd:        0
HugePages_Surp:        0
Hugepagesize:       2048 kB
DirectMap4k:      113344 kB
DirectMap2M:     4071424 kB</code></pre></div><div class="codebox"><pre><code>8021q 28808 0 - Live 0xffffffffa07c6000
garp 14046 1 8021q, Live 0xffffffffa07b7000
mrp 18446 1 8021q, Live 0xffffffffa07c0000
usb_storage 56690 0 - Live 0xffffffffa07a8000
tcp_lp 12663 0 - Live 0xffffffffa0792000
ccm 17773 0 - Live 0xffffffffa07a2000
nls_utf8 12557 1 - Live 0xffffffffa0783000
isofs 39794 1 - Live 0xffffffffa0797000
hidp 23870 0 - Live 0xffffffffa078b000
fuse 86935 3 - Live 0xffffffffa076c000
ipt_MASQUERADE 12880 3 - Live 0xffffffffa0767000
xt_CHECKSUM 12549 1 - Live 0xffffffffa0762000
ip6t_rpfilter 12546 1 - Live 0xffffffffa0758000
ip6t_REJECT 12939 2 - Live 0xffffffffa075d000
tun 27153 1 - Live 0xffffffffa0750000
xt_conntrack 12760 12 - Live 0xffffffffa074b000
rfcomm 69064 6 - Live 0xffffffffa0739000
bnep 19624 2 - Live 0xffffffffa072f000
ebtable_nat 12807 0 - Live 0xffffffffa072a000
ebtable_broute 12731 0 - Live 0xffffffffa0701000
bridge 110783 1 ebtable_broute, Live 0xffffffffa06e4000
stp 12868 2 garp,bridge, Live 0xffffffffa06df000
llc 13941 3 garp,bridge,stp, Live 0xffffffffa06da000
ebtable_filter 12827 0 - Live 0xffffffffa06d5000
ebtables 30758 3 ebtable_nat,ebtable_broute,ebtable_filter, Live 0xffffffffa06c8000
ip6table_nat 13015 1 - Live 0xffffffffa06c3000
nf_conntrack_ipv6 18738 7 - Live 0xffffffffa06bd000
nf_defrag_ipv6 34712 1 nf_conntrack_ipv6, Live 0xffffffffa06af000
nf_nat_ipv6 13213 1 ip6table_nat, Live 0xffffffffa06aa000
ip6table_mangle 12700 1 - Live 0xffffffffa06a5000
ip6table_security 12710 1 - Live 0xffffffffa06a0000
ip6table_raw 12683 1 - Live 0xffffffffa069b000
ip6table_filter 12815 1 - Live 0xffffffffa0696000
ip6_tables 26808 5 ip6table_nat,ip6table_mangle,ip6table_security,ip6table_raw,ip6table_filter, Live 0xffffffffa068a000
iptable_nat 13011 1 - Live 0xffffffffa0685000
nf_conntrack_ipv4 14656 7 - Live 0xffffffffa0680000
nf_defrag_ipv4 12702 1 nf_conntrack_ipv4, Live 0xffffffffa0674000
nf_nat_ipv4 13199 1 iptable_nat, Live 0xffffffffa066f000
nf_nat 20973 5 ipt_MASQUERADE,ip6table_nat,nf_nat_ipv6,iptable_nat,nf_nat_ipv4, Live 0xffffffffa0679000
nf_conntrack 95080 9 ipt_MASQUERADE,xt_conntrack,ip6table_nat,nf_conntrack_ipv6,nf_nat_ipv6,iptable_nat,nf_conntrack_ipv4,nf_nat_ipv4,nf_nat, Live 0xffffffffa0656000
iptable_mangle 12695 1 - Live 0xffffffffa0513000
iptable_security 12705 1 - Live 0xffffffffa04f2000
iptable_raw 12678 1 - Live 0xffffffffa04fb000
coretemp 13475 0 - Live 0xffffffffa0500000
kvm_intel 143031 0 - Live 0xffffffffa0706000
kvm 460181 1 kvm_intel, Live 0xffffffffa05e4000
iTCO_wdt 13480 0 - Live 0xffffffffa050e000
iTCO_vendor_support 13419 1 iTCO_wdt, Live 0xffffffffa04df000
ppdev 17635 0 - Live 0xffffffffa04d9000
pl2303 19026 0 - Live 0xffffffffa0508000
arc4 12608 2 - Live 0xffffffffa043a000
iwl3945 104691 0 - Live 0xffffffffa04be000
iwlegacy 126610 1 iwl3945, Live 0xffffffffa05c4000
mac80211 624001 2 iwl3945,iwlegacy, Live 0xffffffffa052a000
microcode 44576 0 - Live 0xffffffffa04e6000
cfg80211 513095 3 iwl3945,iwlegacy,mac80211, Live 0xffffffffa043f000
serio_raw 13413 0 - Live 0xffffffffa0435000
i2c_i801 18135 0 - Live 0xffffffffa03a4000
snd_hda_codec_conexant 57482 1 - Live 0xffffffffa0425000
snd_hda_codec_generic 66943 1 snd_hda_codec_conexant, Live 0xffffffffa0413000
snd_hda_intel 52306 4 - Live 0xffffffffa051c000
btusb 28290 0 - Live 0xffffffffa039c000
bluetooth 408623 23 hidp,rfcomm,bnep,btusb, Live 0xffffffffa03ae000
6lowpan_iphc 18591 1 bluetooth, Live 0xffffffffa036a000
snd_hda_codec 129201 3 snd_hda_codec_conexant,snd_hda_codec_generic,snd_hda_intel, Live 0xffffffffa037b000
snd_hwdep 17650 1 snd_hda_codec, Live 0xffffffffa0371000
snd_seq 60752 0 - Live 0xffffffffa035a000
snd_seq_device 14136 1 snd_seq, Live 0xffffffffa033a000
snd_pcm 103489 2 snd_hda_intel,snd_hda_codec, Live 0xffffffffa033f000
lpc_ich 21080 0 - Live 0xffffffffa0333000
mfd_core 13182 1 lpc_ich, Live 0xffffffffa0288000
r592 17961 0 - Live 0xffffffffa031e000
memstick 16199 1 r592, Live 0xffffffffa026c000
sdhci_pci 23172 0 - Live 0xffffffffa02f8000
sdhci 38319 1 sdhci_pci, Live 0xffffffffa0328000
mmc_core 116661 2 sdhci_pci,sdhci, Live 0xffffffffa0300000
tg3 170441 0 - Live 0xffffffffa02cd000
ptp 18725 1 tg3, Live 0xffffffffa02c7000
pps_core 19130 1 ptp, Live 0xffffffffa02c1000
snd_timer 28698 2 snd_seq,snd_pcm, Live 0xffffffffa027f000
thinkpad_acpi 79032 1 - Live 0xffffffffa02ac000
snd 75490 20 snd_hda_codec_conexant,snd_hda_codec_generic,snd_hda_intel,snd_hda_codec,snd_hwdep,snd_seq,snd_seq_device,snd_pcm,snd_timer,thinkpad_acpi, Live 0xffffffffa0298000
soundcore 14491 1 snd, Live 0xffffffffa0194000
rfkill 21979 5 cfg80211,bluetooth,thinkpad_acpi, Live 0xffffffffa023e000
shpchp 37032 0 - Live 0xffffffffa028d000
parport_pc 28048 0 - Live 0xffffffffa0277000
tpm_tis 18471 0 - Live 0xffffffffa0271000
parport 40425 2 ppdev,parport_pc, Live 0xffffffffa0261000
tpm 35153 1 tpm_tis, Live 0xffffffffa0230000
acpi_cpufreq 19393 1 - Live 0xffffffffa018e000
nfsd 279056 13 - Live 0xffffffffa01ea000
auth_rpcgss 58761 1 nfsd, Live 0xffffffffa017e000
nfs_acl 12741 1 nfsd, Live 0xffffffffa0179000
lockd 93436 1 nfsd, Live 0xffffffffa0245000
sunrpc 278248 22 nfsd,auth_rpcgss,nfs_acl,lockd, Live 0xffffffffa01a5000
uinput 17672 0 - Live 0xffffffffa009b000
binfmt_misc 17431 1 - Live 0xffffffffa0173000
dm_crypt 23177 1 - Live 0xffffffffa0006000
firewire_ohci 44587 0 - Live 0xffffffffa0199000
i915 796218 3 - Live 0xffffffffa00af000
ata_generic 12910 0 - Live 0xffffffffa00aa000
pata_acpi 13038 0 - Live 0xffffffffa00a2000
firewire_core 62559 1 firewire_ohci, Live 0xffffffffa008a000
crc_itu_t 12613 1 firewire_core, Live 0xffffffffa0074000
yenta_socket 45123 0 - Live 0xffffffffa0067000
i2c_algo_bit 13257 1 i915, Live 0xffffffffa0018000
drm_kms_helper 50652 1 i915, Live 0xffffffffa007a000
drm 283747 4 i915,drm_kms_helper, Live 0xffffffffa001e000
i2c_core 38656 5 i2c_i801,i915,i2c_algo_bit,drm_kms_helper,drm, Live 0xffffffffa000d000
video 19261 1 i915, Live 0xffffffffa0000000</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235963">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">3zl</div>
					<div class="post-datetime">
						8 Jun 2014, 00:27					</div>
				</div>
				<div class="post-content content">
					<p>as anticipated - memory problem<br />as opkg itself needs SOME memroy, there is no room to dowload and install kmod-batman and dependencies (abt 120k)</p><p>i dont undertand however where all these modules come from :</p><p>video,usb,firewire.............</p><p>no wonder there is absolute no space left; maybe that comes with LUCI and all USB-drivers;does you model supports USB ?</p><p>AFAIK if you deinstall LUCI, it still remains in ROM and parts of it seemded to stay and been activated in RAM,</p><p>what exact imgage did you use for upgrade ? ( with -f ?)</p><p>i will look for an &quot;LUCI-free image without USB&quot; </p><p>will the WRT54GS image do for that router too ?</p><p>regards</p><p>3zl</p><p>(late night -&gt;bunk)</p>											<p class="post-edited">(Last edited by <strong>3zl</strong> on 8 Jun 2014, 00:37)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235966">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">beemer</div>
					<div class="post-datetime">
						8 Jun 2014, 01:09					</div>
				</div>
				<div class="post-content content">
					<p>3zl, thanks for all your help.</p><p>1. My system has no usb availability, visible or in the case, that I&#039;m aware of.<br />2. The installed image was:<br /> <a href="http://downloads.openwrt.org/attitude_adjustment/12.09/brcm47xx/generic/openwrt-brcm47xx-squashfs.trx">12.09: openwrt-brcm47xx-squashfs.trx</a><br />3.&nbsp; I don&#039;t know about how well the WRT54G will work (or not), but I have downloaded the Build system and am looking at that, I just need to get a handle on what I need and don&#039;t need. I just need to make sure that I don&#039;t foul up the base config too badly.</p><p>Thanks,<br />Matt</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235969">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">3zl</div>
					<div class="post-datetime">
						8 Jun 2014, 02:59					</div>
				</div>
				<div class="post-content content">
					<p>OK,&nbsp; tell me what your usecase is or what you must have for your application.<br />I did read though you wanted openssl, which I don&#039;t think will fit.<br />My builds run uhttpd,wget-nossl,iw,IP,dnsmasq,netcat,busybox basic tools,ssl,firewall,tc,minihostapd<br />Kmod-batman-adv,macvlan,clan,haserl(Web if),<br />Left out :<br />&nbsp; &nbsp;Ipv6,opkg,ppp,</p><p>Kernel option build with debug-fs, no deb symbols,Compiler optimization option</p><p>II&#039;ll have a complete list Sunday</p><p>Will also setup image builder for my wrt54 testing just out of curiosity</p><p>Cu</p><p>Regards<br />3zl<br />( scratched with pad )</p>											<p class="post-edited">(Last edited by <strong>3zl</strong> on 8 Jun 2014, 03:03)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235972">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">beemer</div>
					<div class="post-datetime">
						8 Jun 2014, 04:10					</div>
				</div>
				<div class="post-content content">
					<p>Okay! Use case:<br />These will form a simple bridge made by two identical units, and they need to pass vlan traffic.<br />The internet side device will be connected to a layer 2 switch.<br />The client side device will be connected to another (identical, but differently configured) WAP providing multiple ssids, each funnelling to a specific vlan.</p><p>Encryption of the wireless communications is a requirement.</p><p>Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235987">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">3zl</div>
					<div class="post-datetime">
						8 Jun 2014, 11:42					</div>
				</div>
				<div class="post-content content">
					<p>Confirming AA 12.09 running on WRT54GL with batman-adv 2012.3</p><p>free : 2048kb good for the job ( as in my old Fonera / DIR-300A )</p><p>Running test within the mesh now.</p><p>Although batman-adv 2012.3 is compatible until 2013.4 i will build &amp; test with lates stabile version batman-adv 2013.4.</p><p>As of encryption possibilities are :</p><p>1. build encrypted tunnel&nbsp; (openssl might be too &quot;fat&quot; - looking for alternatives)<br />2. encrypt adhoc wifi traffic ( working on this for the broadcom wifi )</p><p>regards<br />3zl</p>											<p class="post-edited">(Last edited by <strong>3zl</strong> on 8 Jun 2014, 13:34)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236012">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">beemer</div>
					<div class="post-datetime">
						8 Jun 2014, 18:11					</div>
				</div>
				<div class="post-content content">
					<p>Thanks! So, while you were asleep I built this:<br /></p><div class="codebox"><pre><code>make image PROFILE=Bcm4705-b43 PACKAGES=&quot;base-files libc libgcc busybox dropbear mtd uci hotplug2 netifd wpad-mini kmod-switch kmod-diag nvram iptables kmod-batman-adv&quot;</code></pre></div><p>I just haven&#039;t been brave enough to try it.<br />I&#039;m pretty sure that, for my use case, I don&#039;t need wpad-mini, either.<br />Again, all I need to do is switch packets, so long as the wifi transmission is encrypted (and I think that your second (2) idea makes more sense.)</p><p>Thanks,<br />Matt</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236018">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">3zl</div>
					<div class="post-datetime">
						8 Jun 2014, 19:16					</div>
				</div>
				<div class="post-content content">
					<p>Hi again ! btw whats your timezone then ?</p><p>Besides taking an earthquake and 2 thunderstorm killing my power id run the UPS and build some tests from scratch.</p><p>Flash into WRT54G i realized sysupgrade wouldnt work if the image is bigger than 3MB<br />So i flashed original software via tfd (gives mor space) and my build.</p><p>Please could you dig for same procedure reg. your CPE Model ?<br />Might be necessary doing something like this if all goes wrong.</p><p>Whats the size of your build ?<br />Did you check whats in there by default ( ppp ...a.s.o as i presume the packages in your PROFILE<br />are set by default. You can get rid of unwanted defaults adding &quot;minus-sign&quot; infront ofit .eg. &quot;-ppp&quot;<br />One of the bigger spacesavers is &quot;opkg&quot; and &quot;IPV6&quot;</p><p>To have a better control over the build i use the complete buildroot.<br />At the minute have included : wpad (instead of mpad-mini) , fastd ( lightweight vnp tunnel )<br />and other little goodies from busybox which not reating some memory<br />Image is now at 3.020MB which is not a problem to fit in the flash, but the RAM they eat once they are loaded.</p><p>Images abt 2.8(3.0)MB flash fine with sysupgrade and im testing the batman-adv integration into my mesh.<br />As of now AFAIK depending on the OWRT &amp; driver versions the adhoc-ancryption needs wpad ( &amp; | hostapd) which i will test on the 2 WRT54 devices .</p><p>German Freifunk impemented a mesh with &quot;fastd&quot; vpn tunnel, so thats an option too</p><p>I&#039;m quite shure openssl will not fit /work in this small machines of ours.</p><p>Feel free to flash you device and check rcovery procedures&nbsp; and report.<br />In case you want to try mine, let me know.<br />I can dropit in my Dopbox.</p><p>regards<br />3zl</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236019">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">beemer</div>
					<div class="post-datetime">
						8 Jun 2014, 19:40					</div>
				</div>
				<div class="post-content content">
					<p>Hello again!<br />I&#039;m in Florida, USA. I&#039;m in the northern portion of the state, so we too have some serious storm issues. Kind of a pain! They shut down the power a fair bit here, also.<br />I am currently eating what we call a Greek Salad! Thanks even more!</p><p>My build ended up at 2.9M according to ls.<br />Actually, that is what I had to do to flash this one. Basically set up tftp to wait on the unit (I set the timeout 60) and restore power on the unit.<br />It would seem this is harder to brick than some of the older hardware I&#039;ve played with...</p><p>So, I&#039;ve done my install, and it worked. But after looking over your post here, I&#039;ve found that I can trim it more by *correctly* using PACKAGES=&quot;&quot; with the minus symbol. I lopped it down to 2.4M.</p><p>And now I have to try and configure it...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236038">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">3zl</div>
					<div class="post-datetime">
						8 Jun 2014, 22:35					</div>
				</div>
				<div class="post-content content">
					<p>nice !</p><p>As i suppose you have the batman-adv ersion 2012-x which comes with Openwrt 12.09<br />you have to look out for the right configuration<br />&nbsp; &nbsp;<a href="http://www.open-mesh.org/projects/batman-adv/wiki/Batman-adv-openwrt-config">http://www.open-mesh.org/projects/batma … wrt-config</a></p><p>If you want the ethx interfaces L2 switched ,you add them in&nbsp; /config/batman-adv<br />to the interfaces section&nbsp; and don&#039;t bridge them in /config/network</p><p>The wifi-radio part must have all&nbsp; same BSSID. <br />The ESSID may be different to easier distinguish the router details in scanning.</p><p>Once the system is up check the log if adhoc interface is associated and up,<br />( ip scan wifix station dump)<br />bat0 interface is automatically generated and up<br />&quot;batctl o&quot; shows batman-originator stations connected</p><p>you can ping L2 with batctl p &lt;mac&gt; and some kind of tcpdump with &quot;batctl td bat0&quot;<br />to check actual traffic.</p><p>If all seems ok, you may ping ips&#039;s on L3 , provided you mesh-nodes have static ips in the same lan segment.</p><p>For dhcp server on one mesh-node and dhcp on the rest, you have to declare the mesh-node<br />with dhcp-server as &quot;batctl server&quot; , the others as &quot;batctl client&quot; or do so in the batman-config.</p><p>Id hope all things go well and at the end you do have true wireless L2 connections </p><p>I&#039;ll keep fingers crossed . <br />Just connected my very old WRT54 with the mesh-playground (12 nodes -35 users)</p><p>update :&nbsp; just managed to get the WRT54 (BCM43xx) meshing in IBBS RSN-PSK<br />&nbsp; seems its wpad needed&nbsp; instead of wpad-mini. <br />&nbsp; testing in g-mode also</p><p>regards<br />3zl</p>											<p class="post-edited">(Last edited by <strong>3zl</strong> on 9 Jun 2014, 17:02)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236042">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">sgn</div>
					<div class="post-datetime">
						8 Jun 2014, 23:18					</div>
				</div>
				<div class="post-content content">
					<p>You *could* also set up multiple SSIDs, one for each VID.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236045">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						8 Jun 2014, 23:26					</div>
				</div>
				<div class="post-content content">
					<p>you can have only one sta iface on a single radio...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236052">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">beemer</div>
					<div class="post-datetime">
						9 Jun 2014, 00:41					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for all the help 3zl. I really appreciate it.</p><p>So,&nbsp; I checked the version and it&#039;s 2012.3.0.<br />I&#039;m working on figuring out how the whole mesh mechanism works. I also need to figure out how prevent clients from getting access to the bridge.</p><div class="quotebox"><cite>sgn wrote:</cite><blockquote><p>You *could* also set up multiple SSIDs, one for each VID.</p></blockquote></div><p>I intend to do that, but on the end points. I need a point to point to carry the vlan traffic across the property first. </p><p>Thanks,<br />Matt</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236056">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">sgn</div>
					<div class="post-datetime">
						9 Jun 2014, 02:29					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nebbia88 wrote:</cite><blockquote><p>you can have only one sta iface on a single radio...</p></blockquote></div><p>You are right, of course; I did not consider the fact that I was using different radios.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236058">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">qasdfdsaq</div>
					<div class="post-datetime">
						9 Jun 2014, 03:52					</div>
				</div>
				<div class="post-content content">
					<p>WDS doesn&#039;t always count as a standard STA interface though. Under certain conditions you can have as many as ten WDS &lt;=&gt; WDS links between two APs (or between 10 APs)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236211">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">3zl</div>
					<div class="post-datetime">
						10 Jun 2014, 16:19					</div>
				</div>
				<div class="post-content content">
					<p>IBSS-RSN&nbsp; psk-encrypted ad-hoc interface on bmcr47xx legacy driver&nbsp; up and running</p><p>Connection via batman-adv mesh to atheros ath5k &amp;7k</p><p>Meshing with WRT54GL, Fonera 2100(ath),DIR-300A(ath),DIR300B(ralink),VM 86-USB TLWN321G(ath),<br />&nbsp; &nbsp; &nbsp; &nbsp;WR3020,NSLUG(dual USB WIFI) </p><p>TODO : <br />&nbsp; &nbsp; &nbsp; &nbsp;measure throughput of b/g/n connections<br />&nbsp; &nbsp; &nbsp; &nbsp;stability on mass traffic<br />&nbsp; &nbsp; &nbsp; &nbsp;batman-routing more than one gateway <br />&nbsp; &nbsp; &nbsp; &nbsp;L2 vs L3 interface<br />&nbsp; &nbsp; &nbsp; &nbsp;integrate vpn-tunnel (Freifunk fastd)</p><p>life dashboard of the &quot;mesh-playgound&quot; via PM</p><p>regards<br />3zl</p>											<p class="post-edited">(Last edited by <strong>3zl</strong> on 10 Jun 2014, 17:52)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p236259">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						10 Jun 2014, 23:09					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>qasdfdsaq wrote:</cite><blockquote><p>WDS doesn&#039;t always count as a standard STA interface though. Under certain conditions you can have as many as ten WDS &lt;=&gt; WDS links between two APs (or between 10 APs)</p></blockquote></div><p>under Openwrt?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>