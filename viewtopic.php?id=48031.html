<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> OpenWRT WAN Traffic Counter in LUCI</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 29 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p220955">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">aaronta</div>
					<div class="post-datetime">
						26 Dec 2013, 23:35					</div>
				</div>
				<div class="post-content content">
					<p>Just to be clear, I am not looking for a bandwidth monitor as such. </p><p>The best comparison I can draw, is the non-descript WAN traffic counter that DD-WRT has. It counts the overall traffic through the WAN interface and not much more.</p><p>It graphs it by day, showing a month at a time and only distinguishes between Upload and download traffic.</p><br /><p>I&#039;ve seen the solutions like bandwidthd etc, but that has it&#039;s own separate interface and is completely overkill for what I need.</p><p>Is there anything out there that integrates into LUCI?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p220966">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">golialive</div>
					<div class="post-datetime">
						27 Dec 2013, 01:38					</div>
				</div>
				<div class="post-content content">
					<p>Hey there.</p><p>I just instaled vnstat, which is integrated through luci-app-vnstat. </p><p>It has traffic views &quot;Summary display&quot;, &quot;Top 10 display&quot;, &quot;Hourly Traffic&quot;, &quot;Daily Traffic&quot; and &quot;Monthly Trafic&quot;.</p><p>The &quot;Daily Traffic&quot; is verry close to what dd-wrt has. The only difference between those (despite colors, but that&#039;s not the real issue on one hand and adjustable through configuration on the other) is the fact that dd-wrt uses kind of HTML bar diagram where the vnstat thingi just draws a png image. And the monthly stat of dd-wrt goes from left to right counting 1st to 31th where vnstat draws horizontal lines instead.<br />But the information being displayed is pretty much the same.</p><p>The main advantage of vnstat compared to what dd-wrt uses is the fact that I can select which interface should be monitored an drawn. Since I run a couple of tinc VPN tunnels and some vlans, I can have individual bandwidth and traffic graphs for each of them. The only tiny bug is that I cannot select the tinc vpn devices through LuCI, I need to adjust the /etc/configuration/vnstat file. But that&#039;s fine for me since you don&#039;t adjust your interfaces multiple times a day but usually do it only once.</p><p>Just remember to adjust your configuration in order to store traffic information to USB drive. Without adjustment, the vnstat data is stored to ramdrive only.</p><p>Regards,<br />Stephan.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p220968">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">aaronta</div>
					<div class="post-datetime">
						27 Dec 2013, 01:44					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>golialive wrote:</cite><blockquote><p>Hey there.</p><p>I just instaled vnstat, which is integrated through luci-app-vnstat. </p><p>It has traffic views &quot;Summary display&quot;, &quot;Top 10 display&quot;, &quot;Hourly Traffic&quot;, &quot;Daily Traffic&quot; and &quot;Monthly Trafic&quot;.</p><p>The &quot;Daily Traffic&quot; is verry close to what dd-wrt has. The only difference between those (despite colors, but that&#039;s not the real issue on one hand and adjustable through configuration on the other) is the fact that dd-wrt uses kind of HTML bar diagram where the vnstat thingi just draws a png image. And the monthly stat of dd-wrt goes from left to right counting 1st to 31th where vnstat draws horizontal lines instead.<br />But the information being displayed is pretty much the same.</p><p>The main advantage of vnstat compared to what dd-wrt uses is the fact that I can select which interface should be monitored an drawn. Since I run a couple of tinc VPN tunnels and some vlans, I can have individual bandwidth and traffic graphs for each of them. The only tiny bug is that I cannot select the tinc vpn devices through LuCI, I need to adjust the /etc/configuration/vnstat file. But that&#039;s fine for me since you don&#039;t adjust your interfaces multiple times a day but usually do it only once.</p><p>Just remember to adjust your configuration in order to store traffic information to USB drive. Without adjustment, the vnstat data is stored to ramdrive only.</p><p>Regards,<br />Stephan.</p></blockquote></div><p>Thanks mate, that&#039;s brilliant. I&#039;ve just looked at a couple of screenshots and looks to be what I&#039;m searching for.</p><p>Just another quick question, how much space does the information take up (in storage terms)? Is it stored in text files that are drawn into PNG&#039;s? </p><p>At the moment I don&#039;t have any external storage for my DD-WRT stats, but can add some if required.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p220971">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">golialive</div>
					<div class="post-datetime">
						27 Dec 2013, 02:08					</div>
				</div>
				<div class="post-content content">
					<p>Hy there</p><p>Actually I don&#039;t know. I just have it up and runnng for two days now, so I have absolutely now reliable number. Currently I have two distinct 2.7K files for each interface and the contents are binary.<br />I don&#039;t expect it to grow heavily, since the hourly counter only counts the last 24 hours, the daily counter only the last 31 days. I don&#039;t know if the monthly counter counts the last 12 months or all months until eternity. But having it growing a couple of bytes each year doesn&#039;t really matter I guess.</p><p>But nevertheless I would suggest to use an USB device for that because write operations are quite common. Would be a real pity if your routers internal storage dies just because it updates traffic statistics once a second. Cheap USB sticks go for 5â‚¬ (2GB), and every now and then you get one of those as a giveaway. Because setting up a new router just like your network needs it to be usually costs you several days (think about some routing stuff, maybe proxy, static DHCP rules, whatever), I wouldn&#039;t risk the death of my device just to save such a really cheap USB stick.</p><p>So, it&#039;s not about the storage amount. There I&#039;m quite sure the internal storage will suffice. It&#039;s more about not threaten the hardware more than necessary.</p><p>Regards,<br />Stephan.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p243892">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">rseiler</div>
					<div class="post-datetime">
						15 Aug 2014, 02:58					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m curious what size those files are now.</p><p>By default they&#039;re stored in /var/lib/vnstat, and /var is a symbolic link to /tmp, which if I&#039;m not mistaken is essentially a mounted RAM disk (tmpfs), so there&#039;s no problem with wear, right?&nbsp; Given a size of 61.8MB, if it&#039;s not RAM I don&#039;t know what it is (I do know my router has 128MB RAM overall and 16MB flash memory).</p><p>The updates are once every 30 mins by default in any case.</p><p>Absent USB, which I&#039;m trying to avoid involving (using a printer anyway), the problem might be resolved by nightly transferring the files to a Web server via cron. The wiki has something about that, but I haven&#039;t experimented with it yet. I&#039;d prefer simply writing them nightly to a non-volatile area, but wherever that may be (I haven&#039;t figured that out yet) it&#039;s likely too small.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p243925">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">golialive</div>
					<div class="post-datetime">
						15 Aug 2014, 12:09					</div>
				</div>
				<div class="post-content content">
					<p>The files are still 2.7K each even after 8 months now. Seems like vnstat provisioned the file completey by allocating all required space at once. </p><p>Let&#039;s quickly do the math here:<br />* Hourly shows the last 24 hours, one value per hour tx, one value per hour rx<br />* Daily shows the last 30 days, one value per day tx, one value per day rx<br />* Monthly shows the last 12 months, one value per month tx, one value per month rx</p><p>That&#039;s 132 distinct values, each being a plain number. Using 64bit ints each would give enough room for values up to 8EB (exabyte) for every covered year and every covered month and every covered day. And 132*64bit is still close to 1KB. </p><p>I have no clue about the actual numbers. Could be completely different in small details. But I really don&#039;t expect this file to grow *ever*. Whatever the real format is, I&#039;m pretty sure it&#039;s plenty.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>