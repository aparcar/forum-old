<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Support for Marvell 88F5xx81 based routers</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 18 Jan 2014 and 6 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 16 of 46</div><nav><ul><li><a href="viewtopic.php%3Fid=12358&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=12358&amp;p=14.html">14</a></li><li><a href="viewtopic.php%3Fid=12358&amp;p=15.html">15</a></li><li class="pagination-current"><span>16</span></li><li><a href="viewtopic.php%3Fid=12358&amp;p=17.html">17</a></li><li><a href="viewtopic.php%3Fid=12358&amp;p=18.html">18</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=12358&amp;p=46.html">46</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p92809">
				<div class="post-metadata">
					<div class="post-num">Post #376</div>
					<div class="post-author">dirkNL</div>
					<div class="post-datetime">
						18 Aug 2009, 13:30					</div>
				</div>
				<div class="post-content content">
					<p>maddes; unfortunately so, the Openwrt default rootfs is too small to be accepted on linksys firmware. So this &#039;padding&#039; with a clean rootfs and then reflashing seemed a good idea for inexperienced users. I&#039;ve also tried padding only the img file but then stock firmware just doesn&#039;t except it.</p><p>You can use the openwrt-wrt350nv2-squashfs.img, because the clean rootfs is just that rootfs.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p92928">
				<div class="post-metadata">
					<div class="post-num">Post #377</div>
					<div class="post-author">maddes.b</div>
					<div class="post-datetime">
						20 Aug 2009, 04:46					</div>
				</div>
				<div class="post-content content">
					<p>By looking at DirkNL&#039;s webupgrade builder, looking at &quot;source_code\src\uboot_wrt350n\board\mv88fxx81\sercomm\upgrade.h&quot; from the <a href="http://www.linksysbycisco.com/gpl">LinkSys GPL source</a> and analysing all available binaries, I think that I can create a rock solid solution for the webupgrade image, that should be worthy to be added to the kamikaze trunk. Expect more this weekend.</p><p>But I wanted to post how to get the flash image (wrt350n.bin) from an official Linksys release (here 2.0.19):<br />(This is also available as a <a href="http://ftp.maddes.net/hardware/WRT350Nv2/extract_firmware_wrt350nv2.sh">shell script</a>)<br /></p><div class="codebox"><pre><code># remove the first 512 bytes and the last byte (FF) from the official .img file to get the zip file
# for 2.0.17: dd if=&quot;WRT350Nv2-ETSI-2.00.17.img&quot; of=&quot;wrt350n.zip.tmp&quot; bs=512 skip=1
dd if=&quot;WRT350N-EU-ETSI-2.00.19.img&quot; of=&quot;wrt350n.zip.tmp&quot; bs=512 skip=1
ZIPSIZE=$(( `stat -c %s &quot;wrt350n.zip.tmp&quot;` - 1 ))
dd if=&quot;wrt350n.zip.tmp&quot; of=&quot;wrt350n.zip&quot; bs=${ZIPSIZE} count=1 &amp;&amp; rm &quot;wrt350n.zip.tmp&quot;

# unpack bin file (unzip from zip package keeps original date &amp; time)
unzip -o &quot;wrt350n.zip&quot;
# - or -
gunzip -c -S .zip &quot;wrt350n.zip&quot; &gt;&quot;wrt350n.bin&quot;</code></pre></div><p>And also how to extract the mtd images from wrt350n.bin:<br /></p><div class="codebox"><pre><code># extract uImage
ZIMGSIZE=0x`hexdump -v -e &#039;1/1 &quot;%02X&quot;&#039; -s 0x0000000C -n 4 &quot;wrt350n.bin&quot;`
dd if=&quot;wrt350n.bin&quot; of=&quot;uImage.bin&quot; bs=$(( 64 + ${ZIMGSIZE} )) count=1

# extract rootfs
KERNELMTDSIZE=0x001A0000
ROOTSIZE=0x`hexdump -v -e &#039;1/1 &quot;%02X&quot;&#039; -s $(( ${KERNELMTDSIZE} - 16 )) -n 4 &quot;wrt350n.bin&quot;`
dd if=&quot;wrt350n.bin&quot; of=&quot;wrt350n.bin.tmp&quot; bs=$(( ${KERNELMTDSIZE} )) skip=1
dd if=&quot;wrt350n.bin.tmp&quot; of=&quot;rootfs.bin&quot; bs=$(( ${ROOTSIZE} )) count=1

# extract u-boot
BOOTSIZE=0x`hexdump -v -e &#039;1/1 &quot;%02X&quot;&#039; -s 0x007BFFF0 -n 4 &quot;wrt350n.bin&quot;`
dd if=&quot;wrt350n.bin&quot; of=&quot;wrt350n.bin.tmp&quot; bs=$(( 0x007C0000 )) skip=1
dd if=&quot;wrt350n.bin.tmp&quot; of=&quot;u-boot.bin&quot; bs=$(( ${BOOTSIZE} )) count=1

# clean up
rm -f &quot;wrt350n.bin.tmp&quot;</code></pre></div><p>Very useful for testing and comparing.</p><p>P.S.:<br />On Debian hexdump is in the package bsdmainutils, which should always be present due to man-db for man pages.<br />If not available, either install the package or you can also try od from the core-utils package, but you have to get rid of the spaces <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /><br />od -v -A n -t x1 -j 0x0C -N 4 wrt350n.bin</p>											<p class="post-edited">(Last edited by <strong>maddes.b</strong> on 3 Apr 2010, 19:03)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93028">
				<div class="post-metadata">
					<div class="post-num">Post #378</div>
					<div class="post-author">maddes.b</div>
					<div class="post-datetime">
						22 Aug 2009, 16:34					</div>
				</div>
				<div class="post-content content">
					<p>Does anyone still have the download versions of WRT350Nv2 firmware 2.00.16 or older? (.15 - .10)<br />Please PM me or contact me via my webpage if you have one firmware download left.</p><p>Would be great to be able to analyse the past for the webupgrade too.</p><p>Maddes</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93066">
				<div class="post-metadata">
					<div class="post-num">Post #379</div>
					<div class="post-author">maddes.b</div>
					<div class="post-datetime">
						23 Aug 2009, 23:56					</div>
				</div>
				<div class="post-content content">
					<p><strong>Webupgrade is done for WRT350N v2.0!</strong></p><p>It is rock solid now without a second reboot.<br />Flash via the upgrade webpage of the stock firmware and after the next reset OpenWrt is running.</p><p>The trick is to get a zip file size which is big enough to pass the size check of the stock firmware.<br />Hence you had to use random data to keep the compression rate low and the file size big.<br />The random data will be erased when JFFS is formatted on the very first reboot.</p><p><a href="ftp://ftp.maddes.net/openwrt/trunk/orion/patches/webupgrade/">Get the latest webupgrade patches</a> and please review them, if you see any logical problems/gaps or missing documentation.<br />See post <a href="https://forum.openwrt.org/viewtopic.php?pid=82410#p82410">#300</a> how to compile it yourself.</p><p>It&#039;s great to be able to flash from stock to OpenWrt and back with ease.</p>											<p class="post-edited">(Last edited by <strong>maddes.b</strong> on 9 Apr 2010, 12:09)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93071">
				<div class="post-metadata">
					<div class="post-num">Post #380</div>
					<div class="post-author">maddes.b</div>
					<div class="post-datetime">
						24 Aug 2009, 01:01					</div>
				</div>
				<div class="post-content content">
					<p>@capibar and other WRT350N v2.1 owners:<br />#1<br />In which region is the v2.1 version sold? Where to get the firmware?<br />So non-v2.1 owners can have a look and maybe help getting webupgrade support done.<br />On the US homepage of Linksys only v1 firmware is available, on the european pages (UK, Germany) only v2 firmware is available.</p><p>#2<br />If you really want OpenWrt on your v2.1 router, then read the complete thread and see if you can get serial access to the board.<br />When serial access is established, get all informations possible:<br /> a) In U-Boot:<br />Restart your router and stop autoboot, then get all information possible (e.g printenv, etc.)<br /> b) Boot log:<br />Clear the terminal, restart your router, wait until it is completely booted then save the log to a file<br /> c) In Linux:<br />Hit enter to access the console, then get all information possible (e.g cat /proc/mtd, etc.)<br />Create images from the mtd partitions and put them on an attached USB stick or drive.<br />Post these images and burn them to a CD for safety reasons.</p><p>If CPU and MTD is similar to WRT350N v2.0 then you may try out the OpenWrt ramdisk build via tftpboot, if you have serial access.<br />Other you may dare to flash the v2.0 OpenWrt image.<br />But before you do this get yourself accustomed to tfpboot in U-Boot for flashing and, more important, recovery.</p>											<p class="post-edited">(Last edited by <strong>maddes.b</strong> on 27 Aug 2009, 14:42)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93103">
				<div class="post-metadata">
					<div class="post-num">Post #381</div>
					<div class="post-author">drizzt81</div>
					<div class="post-datetime">
						24 Aug 2009, 20:44					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>maddes.b wrote:</cite><blockquote><p><strong>Webupgrade is done for WRT350N v2.0!</strong></p><p>It is rock solid now without a second reboot.<br />Flash via the upgrade webpage of the stock firmware and after the next reset OpenWrt is running.</p><p>The trick is to get a zip file size which is big enough to pass the size check of the stock firmware.<br />Hence you had to use random data to keep the compression rate low and the file size big.<br />The random data will be erased when JFFS is formatted on the very first reboot.</p><p><a href="ftp://ftp.maddes.net/openwrt/kamikaze/orion/patches/webupgrade/">Get the latest webupgrade patches</a> and please review them, if you see any logical problems/gaps or missing documentation.<br /><span class="bbu">Do not forget</span> the patches from <a href="https://dev.openwrt.org/ticket/5719">#5719</a> (see post <a href="https://forum.openwrt.org/viewtopic.php?pid=92789#p92789">##376</a>).</p></blockquote></div><p>Hi Maddes,</p><p>thanks for all your hard work. When trying to apply the sysupgrade patch after applying the webupgrade patch, I get an error message:</p><div class="codebox"><pre><code>gwk@openwrtbuild:~/kamikaze-webtest$ patch -p0 &lt; ../maddes/orion_sysupgrade_image_makefile.patch
patching file target/linux/orion/image/Makefile
Hunk #1 FAILED at 48.
1 out of 1 hunk FAILED -- saving rejects to file target/linux/orion/image/Makefile.rej

gwk@openwrtbuild:~/kamikaze-webtest$ cat target/linux/orion/image/Makefile.rej
***************
*** 48,54 ****
  endef

  define Image/Build/Linksys
- # placeholder for the WRT350N v2
  endef

  define Image/Build/Freecom
--- 48,58 ----
  endef

  define Image/Build/Linksys
+       ( \
+               dd if=$(KDIR)/$(2)-uImage bs=1024k conv=sync; \
+               dd if=$(KDIR)/root.$(1) bs=128k conv=sync; \
+       ) &gt; $(BIN_DIR)/openwrt-$(2)-$(1).img
+ # ToDo: WRT350N v2 webupgrade image
  endef

  define Image/Build/Freecom</code></pre></div><p>When comparing the patch to the original file, it seems that the major changes are threefold:<br />1. usage of round parnthesis instead of squigly ones ( vs {<br />2. adjustment of bs argument for both dd operations<br />3. addition of parenthesis in 3 lines</p><p><strong>Is that all I need to adjust?</strong></p><p>Upon building, i am running into more errors:</p><div class="codebox"><pre><code>gwk@openwrtbuild:~/kamikaze-webtest$ make V=99
make[1]: Entering directory `/home/gwk/kamikaze-webtest&#039;
make[2]: Entering directory `/home/gwk/kamikaze-webtest&#039;
++ mkdir -p /home/gwk/kamikaze-webtest/staging_dir/target-arm_uClibc-0.9.30.1
++ cd /home/gwk/kamikaze-webtest/staging_dir/target-arm_uClibc-0.9.30.1
++ mkdir -p bin lib include stamp
mkdir -p /home/gwk/kamikaze-webtest/build_dir/target-arm_uClibc-0.9.30.1/stamp
touch /home/gwk/kamikaze-webtest/staging_dir/target-arm_uClibc-0.9.30.1/.prepared
++ mkdir -p /home/gwk/kamikaze-webtest/staging_dir/host
++ cd /home/gwk/kamikaze-webtest/staging_dir/host
++ mkdir -p bin lib include stamp

&lt;---- snip ----&gt;

gcc -O2 -I/home/gwk/kamikaze-webtest/staging_dir/host/include -c src/md5.c -o /home/gwk/kamikaze-webtest/build_dir/host/wrt350nv2-builder-2.0/md5.o
src/md5.c:513: error: redefinition of &#039;md5_process&#039;
src/md5.c:133: error: previous definition of &#039;md5_process&#039; was here
src/md5.c:694: error: redefinition of &#039;md5_init&#039;

&lt;---- snip similar errors for a bit ----&gt;

src/md5.c:362: error: previous definition of &#039;md5_finish&#039; was here
make[3]: *** [/home/gwk/kamikaze-webtest/build_dir/host/wrt350nv2-builder-2.0/.built] Error 1
make[3]: Leaving directory `/home/gwk/kamikaze-webtest/tools/wrt350nv2-builder&#039;
make[2]: *** [tools/wrt350nv2-builder/compile] Error 2
make[2]: Leaving directory `/home/gwk/kamikaze-webtest&#039;
make[1]: *** [/home/gwk/kamikaze-webtest/staging_dir/target-arm_uClibc-0.9.30.1/stamp/.tools_install_nnn] Error 2
make[1]: Leaving directory `/home/gwk/kamikaze-webtest&#039;
make: *** [world] Error 2
gwk@openwrtbuild:~/kamikaze-webtest$</code></pre></div><p>I would guess that this may be related to the patching issues I had earlier?</p><p>Cheers,</p><p>Greg</p>											<p class="post-edited">(Last edited by <strong>drizzt81</strong> on 24 Aug 2009, 21:11)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93105">
				<div class="post-metadata">
					<div class="post-num">Post #382</div>
					<div class="post-author">maddes.b</div>
					<div class="post-datetime">
						24 Aug 2009, 21:03					</div>
				</div>
				<div class="post-content content">
					<p>Oh, sorry for the inconvenience.<br />Just leave it out. The webupgrade patches already added everything that is needed to &quot;target/linux/orion/image/Makefile&quot;.<br />The webupgrade patches are newer than the sysupgrade patches.</p><p>For the compile error:<br />What trunk revision are you using?<br />Did you apply the pathes to a clean checkout or did you had a previous webupgrade installed?<br />Have you issued a &quot;make distclean&quot; before compiling?</p>											<p class="post-edited">(Last edited by <strong>maddes.b</strong> on 24 Aug 2009, 22:16)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93110">
				<div class="post-metadata">
					<div class="post-num">Post #383</div>
					<div class="post-author">drizzt81</div>
					<div class="post-datetime">
						24 Aug 2009, 22:42					</div>
				</div>
				<div class="post-content content">
					<p>quick update, I started from stratch in order to see if I could reproduce the complication error and was unable to. Here are my steps this far:</p><ul><li><p>Create a build environment (Debian Lenny x86 on VMWare Server) as described here: <a href="http://oldwiki.openwrt.org/OpenWrtDocs%282f%29Development%282f%29SetupBuildEnvironmentHowTo.html">http://oldwiki.openwrt.org/OpenWrtDocs% … HowTo.html</a></p></li><li><p>Download the latest sources: <a href="http://nuwiki.openwrt.org/doc/howto/buildroot">http://nuwiki.openwrt.org/doc/howto/buildroot</a></p></li><li><p>Download the Webupgrade patches from here: <a href="ftp://ftp.maddes.net/openwrt/kamikaze/orion/patches/webupgrade/">ftp://ftp.maddes.net/openwrt/kamikaze/o … ebupgrade/</a></p></li><li><p>Download the Sysupgrade MTD patch: <a href="https://dev.openwrt.org/raw-attachment/ticket/5719/orion_sysupgrade_mtd.patch">https://dev.openwrt.org/raw-attachment/ … _mtd.patch</a></p></li><li><p>Download the Sysupgrade Platform patch: <a href="https://dev.openwrt.org/raw-attachment/ticket/5719/orion_sysupgrade_platform_sh.patch">https://dev.openwrt.org/raw-attachment/ … m_sh.patch</a></p></li></ul><p>If someone wants to scriptify this, here are all the commands in order up to menuconfig:<br /></p><div class="codebox"><pre><code>patch -p0 &lt; ~/webupgrade.builder.v20.patch
patch -p0 &lt; ~/webupgrade.makefile_tools.r17357.patch
patch -p0 &lt; ~/webupgrade.makefile_wrt350nv2_image.r17357.patch</code></pre></div><div class="codebox"><pre><code>patch -p0 &lt; ../maddes/orion_sysupgrade_platform_sh.patch
patch -p0 &lt; ../maddes/orion_sysupgrade_mtd.patch</code></pre></div>											<p class="post-edited">(Last edited by <strong>drizzt81</strong> on 24 Aug 2009, 22:43)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93111">
				<div class="post-metadata">
					<div class="post-num">Post #384</div>
					<div class="post-author">drizzt81</div>
					<div class="post-datetime">
						24 Aug 2009, 22:44					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>maddes.b wrote:</cite><blockquote><p>Oh, sorry for the inconvenience.<br />Just leave it out. The webupgrade patches already added everything that is needed to &quot;target/linux/orion/image/Makefile&quot;.<br />The webupgrade patches are newer than the sysupgrade patches.</p><p>For the compile error:<br />What trunk revision are you using?<br />Did you apply the pathes to a clean checkout or did you had a previous webupgrade installed?<br />Have you issued a &quot;make distclean&quot; before compiling?</p></blockquote></div><p>Starting from stratch has fixed the compile error. Sorry for the inconvenience, apparently the patching messed something up along the way.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93112">
				<div class="post-metadata">
					<div class="post-num">Post #385</div>
					<div class="post-author">maddes.b</div>
					<div class="post-datetime">
						24 Aug 2009, 22:45					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m glad that a clean checkout (or make distclean) solved it.</p><p>You can also take the commands from <a href="http://ftp.maddes.net/openwrt//build_kernel_and_packages.txt">build_kernel_and_packages.txt</a>.<br />openwrt release-config is in file <a href="http://ftp.maddes.net/openwrt/orion-config-release">orion-config-release</a>, this is exactly the one used for official releases.<br />All on <a href="http://ftp.maddes.net/openwrt/">http://ftp.maddes.net/openwrt/</a></p><p><strong>WARNING!!! The images on the ftp space do not include any web interfaces, pure console only!!! Use at your own risk!!!</strong><br /><strong>This is ALL BETA!!! Newbies should wait for a stable release by the OpenWrt team!!!</strong><br />Read the complete thread (I mean it) to know the problems and issues.<br />Inform yourself how to setup OpenWrt <span class="bbu">before</span> you flash.<br />Linux experience is mandatory.<br />And have a fallback router available, or access to your neighbor&#039;s wlan, or know how to access the internet with your pc directly.</p>											<p class="post-edited">(Last edited by <strong>maddes.b</strong> on 3 Apr 2010, 19:06)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93114">
				<div class="post-metadata">
					<div class="post-num">Post #386</div>
					<div class="post-author">drizzt81</div>
					<div class="post-datetime">
						24 Aug 2009, 23:49					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>maddes.b wrote:</cite><blockquote><p>I&#039;m glad that a clean checkout (or make distclean) solved it.</p><p>You can also take the commands from <a href="ftp://ftp.maddes.net/openwrt/kamikaze/orion/build_kernel_and_packages.txt">build_kernel_and_packages.txt</a>.<br />openwrt release-config is in file <a href="ftp://ftp.maddes.net/openwrt/kamikaze/orion/orion-release-config">orion-release-config</a>, this is exactly the one used for official releases.<br />All on <a href="ftp://ftp.maddes.net/openwrt/kamikaze/orion/">ftp://ftp.maddes.net/openwrt/kamikaze/orion/</a></p></blockquote></div><p>I guess I could have just downloaded that image instead of going through all the trouble of creating a build environment... oh well, at least I learned something. Time to flash my little bugger.</p><p><strong>Update</strong></p><p>Flash with image from FTP failed, flash with my image worked, but no webinterface <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p>											<p class="post-edited">(Last edited by <strong>drizzt81</strong> on 25 Aug 2009, 00:35)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93119">
				<div class="post-metadata">
					<div class="post-num">Post #387</div>
					<div class="post-author">maddes.b</div>
					<div class="post-datetime">
						25 Aug 2009, 01:36					</div>
				</div>
				<div class="post-content content">
					<p>Checked with my local copy of &quot;openwrt-wrt350nv2-squashfs-webupgrade.all_ipv6.img&quot; and I could flash it with stock firmware 2.00.17 and 2.00.19.<br />So I downloaded from FTP, MD5 sum is correct and binary identical to my local copy.</p><p>I assume a corrupt download. Did you check the MD5sum?<br />Otherwise what stock firmware did you had before?</p><p>P.S.:<br />Splitted the downloaded webupgrade img and it is correctly filled up to 0x600000 - 1.</p>											<p class="post-edited">(Last edited by <strong>maddes.b</strong> on 25 Aug 2009, 01:48)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93121">
				<div class="post-metadata">
					<div class="post-num">Post #388</div>
					<div class="post-author">maddes.b</div>
					<div class="post-datetime">
						25 Aug 2009, 01:49					</div>
				</div>
				<div class="post-content content">
					<p>If you want a webinterface, install either <a href="http://www.x-wrt.org/">&quot;webif&quot;</a>, or &quot;luci-admin-full&quot; plus &quot;luci-admin-mini&quot; and &quot;luci-theme-openwrt&quot;<br /></p><div class="codebox"><pre><code>opkg update  # something often forgotten

opkg install &lt;package&gt;</code></pre></div><p>Of course you need to have an internet connection, check settings with:<br /></p><div class="codebox"><pre><code>uci show network.wan
uci show network.lan
uci show wireless</code></pre></div>											<p class="post-edited">(Last edited by <strong>maddes.b</strong> on 3 Apr 2010, 19:09)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93125">
				<div class="post-metadata">
					<div class="post-num">Post #389</div>
					<div class="post-author">drizzt81</div>
					<div class="post-datetime">
						25 Aug 2009, 02:39					</div>
				</div>
				<div class="post-content content">
					<p>I tried going back to stock via sysupgrade earlier, which apparently bricked the router (i/o error during upgrade). So I need to get serial access to it sometime soon - maybe by next week. Is there a cheaper Serial console alternative than your <a href="http://apple.clickandbuild.com/cnb/shop/ftdichip?productID=70&amp;op=catalogue-product_info-null&amp;prodCategoryID=47">cable</a>. I live in Germany, so anything within the EU would be great.</p>											<p class="post-edited">(Last edited by <strong>drizzt81</strong> on 26 Aug 2009, 11:42)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93137">
				<div class="post-metadata">
					<div class="post-num">Post #390</div>
					<div class="post-author">maddes.b</div>
					<div class="post-datetime">
						25 Aug 2009, 16:44					</div>
				</div>
				<div class="post-content content">
					<p>The erase error when using wrt350n.bin is normal, as the flash image is bigger than the mtd partition.<br />Updated <a href="https://forum.openwrt.org/viewtopic.php?pid=92789#p92789">post #376</a> accordingly.</p><p>@drizzt81: I live in Germany too, will mail you.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93144">
				<div class="post-metadata">
					<div class="post-num">Post #391</div>
					<div class="post-author">Spear</div>
					<div class="post-datetime">
						25 Aug 2009, 19:44					</div>
				</div>
				<div class="post-content content">
					<p>Just successfully flashed my 2.0 edition WRT350N with your webupgrade build, Maddes, thanks for the work, it really is appreciated.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93166">
				<div class="post-metadata">
					<div class="post-num">Post #392</div>
					<div class="post-author">Nilfred</div>
					<div class="post-datetime">
						26 Aug 2009, 03:37					</div>
				</div>
				<div class="post-content content">
					<p>@drizzt81: Use a cheap <a href="http://buffalo.nas-central.org/index.php/Use_a_Nokia_Serial_Cable_on_an_ARM9_Linkstation">Nokia CA-42 or DKU-5 clone cable</a>. Other non-USB-cellular cable may work too.<br />If you were lucky may own a FTDI cable, mine was a <a href="http://www.prolific.com.tw/eng/downloads.asp?ID=31">Prolific PL-2303</a><br />I din&#039;t even solder to the motherboard and work seamlessly.<br />In the event of need to answer the question: &quot;What is for?&quot; Say: &quot;Nokia 6020&quot; or <a href="http://europe.nokia.com/find-products/accessories/all-accessories/memory-cards-and-cables/cables/nokia-cable-ca-42/compatibility">pick your answer here</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93185">
				<div class="post-metadata">
					<div class="post-num">Post #393</div>
					<div class="post-author">drizzt81</div>
					<div class="post-datetime">
						26 Aug 2009, 15:39					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Nilfred wrote:</cite><blockquote><p>@drizzt81: Use a cheap <a href="http://buffalo.nas-central.org/index.php/Use_a_Nokia_Serial_Cable_on_an_ARM9_Linkstation">Nokia CA-42 or DKU-5 clone cable</a>. Other non-USB-cellular cable may work too.<br />If you were lucky may own a FTDI cable, mine was a <a href="http://www.prolific.com.tw/eng/downloads.asp?ID=31">Prolific PL-2303</a><br />I din&#039;t even solder to the motherboard and work seamlessly.<br />In the event of need to answer the question: &quot;What is for?&quot; Say: &quot;Nokia 6020&quot; or <a href="http://europe.nokia.com/find-products/accessories/all-accessories/memory-cards-and-cables/cables/nokia-cable-ca-42/compatibility">pick your answer here</a></p></blockquote></div><p>Thanks Nilfred, Maddes is nice enough to let me borrow his cable for a bit to debrick.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93244">
				<div class="post-metadata">
					<div class="post-num">Post #394</div>
					<div class="post-author">andrewm1973</div>
					<div class="post-datetime">
						27 Aug 2009, 13:16					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>maddes.b wrote:</cite><blockquote><p>In which region is the v2.1 version sold?</p></blockquote></div><p>Aus</p><div class="quotebox"><cite>maddes.b wrote:</cite><blockquote><p>Where to get the firmware?</p></blockquote></div><p>My v2.1 at least has 2.017 firmware (same as your v2.0 I think)</p><p>Internally it looks identical to photos of a v2.0 apart from the v2.1 has a 1/2 sized MiniPCI card</p><div class="quotebox"><cite>maddes.b wrote:</cite><blockquote><p>If CPU and MTD is similar to WRT350N v2.0 then you may dare to flash the v2.0 OpenWrt image.<br />But before you do this get yourself accustomed to tfpboot in U-Boot for flashing and, more important, recovery.</p></blockquote></div><p>Same CPU same RAM same ROM</p><p>I am just going to give the image of your FTP site a go.&nbsp; I suspect the only point of failure might be a different wireless card.&nbsp; If it doesnt work I will hook up a UART to it to try recover.</p><p>Wish me luck</p><p>Update:</p><p>The webupgrade file</p><p>openwrt-wrt350nv2-squashfs-webupgrade.all_ipv6.img</p><p>works a treat on AUS v2.1 and I can Telnet and SSH in.&nbsp; No WLAN though.</p>											<p class="post-edited">(Last edited by <strong>andrewm1973</strong> on 27 Aug 2009, 13:39)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93245">
				<div class="post-metadata">
					<div class="post-num">Post #395</div>
					<div class="post-author">maddes.b</div>
					<div class="post-datetime">
						27 Aug 2009, 14:40					</div>
				</div>
				<div class="post-content content">
					<p>Hi Andrew,</p><p>good to hear that your router is not bricked, and that the webupgrade works with v2.1 too.<br />So you need a different WLAN driver for the card.<br />If you can find out which one, then you may install if it is already in the trunk repository.<br />This also may speed up the inclusion of v2.1 builds into the trunk.</p><p>Couldn&#039;t find a v2.1 firmware release on the australian or new zealand support pages of Linksys, only a v1.</p><p>Did you create an image of the mtd partition from the stock firmware via serial access before flashing to OpenWrt?<br />If so, this would be great to compare against the 2.0.17 EU release.</p><p>It would also be interesting if you could flash back to stock 2.0.17 (as you mentioned) and see if you get WLAN back (or even try the last EU release 2.0.19).<br />But beware that this may brick your router, serial access needed for recovery.</p><p>Maddes</p>											<p class="post-edited">(Last edited by <strong>maddes.b</strong> on 27 Aug 2009, 21:17)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93261">
				<div class="post-metadata">
					<div class="post-num">Post #396</div>
					<div class="post-author">andrewm1973</div>
					<div class="post-datetime">
						27 Aug 2009, 23:31					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>maddes.b wrote:</cite><blockquote><p>Couldn&#039;t find a v2.1 firmware release on the australian or new zealand support pages of Linksys, only a v1.</p></blockquote></div><p>Yes - I believe linksys Aus are particularly useless.&nbsp; But seeing as it is 2.0.17 anyways I would assume its the same hardware apart from MiniPCI.</p><div class="quotebox"><cite>maddes.b wrote:</cite><blockquote><p>Did you create an image of the mtd partition from the stock firmware via serial access before flashing to OpenWrt?<br />If so, this would be great to compare against the 2.0.17 EU release.</p></blockquote></div><p>Me not so bright to know how to do that.&nbsp; If you can point me at a post number with colour by number instructions I will go buy a new V2.1 this weekend to do it for you.&nbsp; They are end of life here too but a local shop had 4 of them last week.</p><div class="quotebox"><cite>maddes.b wrote:</cite><blockquote><p>It would also be interesting if you could flash back to stock 2.0.17 (as you mentioned) and see if you get WLAN back (or even try the last EU release 2.0.19).<br />But beware that this may brick your router, serial access needed for recovery.</p></blockquote></div><p>I can recover with just UART and dont need JTAG?&nbsp; I am going to order an FT3232 to make a combined UART/JTAG adaptor to sit in the router.&nbsp; But thats going to be weeks off yet.</p><p>BTW - I could not install Luci from the main repository (openwrt.org).&nbsp; Failed on the &quot;luci-core postinst&quot; what ever that means.&nbsp; I did a first-boot and tried again - same problem.&nbsp; Gave up and installed webif.</p><p>So as far as V2.1 AUS goes.</p><p>Maddes web-install runs fine to update router.<br />Wireless does not work (maybe my dumb arse doing something wrong)<br />USB does not work (Definitly my dumb arse)<br />Luci does not work (probably something wrong in the package)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93300">
				<div class="post-metadata">
					<div class="post-num">Post #397</div>
					<div class="post-author">maddes.b</div>
					<div class="post-datetime">
						28 Aug 2009, 19:31					</div>
				</div>
				<div class="post-content content">
					<p>For USB support, see <a href="https://forum.openwrt.org/viewtopic.php?pid=90229#p90229">#351</a>, you need &quot;kmod-usb2&quot;, &quot;kmod-usb-core&quot; and &quot;kmod-nls-base&quot;.<br />To access storage via USB you need &quot;kmod-usb-storage&quot;.<br />Depending on the used filesystem you may need additional kmod packages (kmod-fs-xyz plus corresponding kmod-nls-abc).<br />Printers need other packages, and so on.</p><p>Luci gave me also errors on postinst, but I was still able to access it via browser. Personally I prefer <a href="http://www.x-wrt.org/">webif (X-Wrt)</a>.</p>											<p class="post-edited">(Last edited by <strong>maddes.b</strong> on 3 Apr 2010, 19:11)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93301">
				<div class="post-metadata">
					<div class="post-num">Post #398</div>
					<div class="post-author">maddes.b</div>
					<div class="post-datetime">
						28 Aug 2009, 19:58					</div>
				</div>
				<div class="post-content content">
					<p>To create an image of the original firmware you just need a serial access, see <a href="https://forum.openwrt.org/viewtopic.php?pid=60299#p60299">#5</a> (serial pin layout), <a href="https://forum.openwrt.org/viewtopic.php?pid=66943#p66943">#66</a> (link to opening the case, plus high res pic of router&#039;s inside).<br />Ground is soldered to the audio jack&#039;s ground, Vcc is not soldered, TX and RX go to audio jack&#039;s left/right channel (test if no signal, then switch).<br />I suggest to&nbsp; get serial access on your current router first, before buying a 2nd one.<br />If it works, you can get a 2nd one, create images of the original firmware and maybe return it to the dealer (so open it carefully).</p><p>With serial access you will see what is going on inside the router before Linux is even started.<br />The output will be similar to the one from <a href="https://forum.openwrt.org/viewtopic.php?pid=60299#p60299">#5</a>.<br />Note the &quot;Hit ENTER to stop autoboot&quot; message in line 46.<br />You have 3 seconds to stop the autoboot, this will give you access to the U-Boot system, which offers you to load a ramdisk image without flashing or even flash directly any image.<br />Please read the complete thread to find out U-Boot commands and more details (reading the complete thread is really recommended).</p><p>You can also ignore the message and start the original stock kernel.<br />When loaded hit enter to get a shell, where you can call all available Linux commands.<br />Add an USB drive/stick via the web interface of the stock firmware.<br />Then create images from the mtd partitions to the usb drive/stick via dd.</p><p>List of commands for U-Boot and Linux, so you can get all information in one go.<br />For the log you should set Putty&#039;s scrollback to 9999 lines or more under &quot;Window&quot; for the COM connection.<br /></p><div class="codebox"><pre><code>help
printenv
flinfo</code></pre></div><p>Then call &quot;boot&quot; to get to Linux<br /></p><div class="codebox"><pre><code>cat /proc/version
cat /proc/cpuinfo
cat /proc/bus/pci/devices
cat /proc/modules
ls -l /sys/class/net/*/device/driver/module
lspci
ifconfig
dmesg</code></pre></div><p>PM me if some command is missing.</p><p>To find out the PCI device check <a href="http://www.xml.com/ldd/chapter/book/ch15.html">here</a> (section &quot;PCI addressing&quot;)<br />PCI databases are <a href="http://www.pcidatabase.com/">here</a> and <a href="http://pciids.sourceforge.net/">here</a></p><p>&quot;cat /proc/bus/pci/devices&quot; for me results in &quot;0138&nbsp; <span style="color: blue">168c</span>0023 ...&quot; and vendor <a href="http://www.pcidatabase.com/search.php?vendor_search_str=168c">168c</a> (or <a href="http://pci-ids.ucw.cz/read/PC/168c">here</a>) is <a href="http://www.atheros.com/">Atheros</a>.</p><p>Creating images:<br /></p><div class="codebox"><pre><code>cat /proc/mtd  # to get the numbers (X)
dd if=/dev/mtdblockX of=/path/to/usb/mtdX.img</code></pre></div><p>By the way, after re-reading this thread I recognized that DirkNL has a v2.1 (see <a href="https://forum.openwrt.org/viewtopic.php?pid=67178#p67178">post #70</a>).<br />But this seems to be a different EU version (he&#039;s from the netherlands) with the old PCI WLAN card (quote from <a href="https://forum.openwrt.org/viewtopic.php?pid=67278#p67278">#73</a>: &quot;I couldn&#039;t see any difference between your photos and my WRT&quot;).<br />His v2.1EU logs are in post <a href="https://forum.openwrt.org/viewtopic.php?pid=67897#p67897">#78</a>.</p>											<p class="post-edited">(Last edited by <strong>maddes.b</strong> on 30 Aug 2009, 22:19)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93310">
				<div class="post-metadata">
					<div class="post-num">Post #399</div>
					<div class="post-author">andrewm1973</div>
					<div class="post-datetime">
						28 Aug 2009, 22:33					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>maddes.b wrote:</cite><blockquote><p>I suggest to&nbsp; get serial access on your current router first, before buying a 2nd one.<br />If it works, you can get a 2nd one, create images of the original firmware and maybe return it to the dealer (so open it carefully).</p></blockquote></div><p>I am pretty familiar with MAX[3]232s so I I should be right there.&nbsp; I dont mind spending an extra $140 on a second router.&nbsp; Hacking things like this is fun.&nbsp; My next challenge is going to be trying to understnd that thread on modifying U-Boot to up the RAM to 128M</p><div class="quotebox"><cite>maddes.b wrote:</cite><blockquote><p>When loaded hit enter to get a shell, where you can call all available Linux commands.<br />Add an USB drive/stick via the web interface of the stock firmware.<br />Then create images from the mtd partitions to the usb drive/stick via dd.</p></blockquote></div><p>Cool.&nbsp; Thats probably enough hint about the command.&nbsp; I will try &quot;Man DD&quot; and &quot;DD ?&quot; and look through this thread for parameters.</p><div class="quotebox"><cite>maddes.b wrote:</cite><blockquote><p>I will create a list of commands for U-Boot and Linux in this post on Sunday</p></blockquote></div><p>Champion - tnx.</p><div class="quotebox"><cite>maddes.b wrote:</cite><blockquote><p>For USB support, see #351, you need &quot;kmod-usb2&quot;.<br />To access storage via USB you need kmod-usb-storage.<br />Depending on the used filesystem you may need additional kmod packages (kmod-fs-xyz).<br />Printers need other packages, and so on.</p></blockquote></div><p>I have already read the entire 16 page thread (over a several month period) and remembered to do the kmod-usb-* installs.&nbsp; The USB hub and the thumb drive appear in the X-WRT USB tab.&nbsp; I just can&#039;t find the drive anywhere in where i would normally look for one under /mnt whatever in debian.</p><div class="quotebox"><cite>maddes.b wrote:</cite><blockquote><p>Luci gave me also errors on postinst, but I was still able to access it via browser. Personally I prefer webif (X-Wrt).</p></blockquote></div><p>OK - So I am not completely dumb <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93315">
				<div class="post-metadata">
					<div class="post-num">Post #400</div>
					<div class="post-author">domadm</div>
					<div class="post-datetime">
						29 Aug 2009, 00:05					</div>
				</div>
				<div class="post-content content">
					<p>Hi <br />I am the owner of WRT350N v2.0 and watching this tread for several months.<br />IFAIK there is a working OpenWRT code for WRT350N v2.0, so please anyone be so kind to explain to me how can I load it to my router together with X-Wrt?</p><p>I have no real knowledge how to get and compile it&#039;s code under Linux environment, as well as apply patches to it, so preferably a compiled binary for web upgrade, pls.</p><p>Thanks for your help.</p>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 16 of 46</div><nav><ul><li><a href="viewtopic.php%3Fid=12358&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=12358&amp;p=14.html">14</a></li><li><a href="viewtopic.php%3Fid=12358&amp;p=15.html">15</a></li><li class="pagination-current"><span>16</span></li><li><a href="viewtopic.php%3Fid=12358&amp;p=17.html">17</a></li><li><a href="viewtopic.php%3Fid=12358&amp;p=18.html">18</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=12358&amp;p=46.html">46</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0.001 -->

</body>
</html>