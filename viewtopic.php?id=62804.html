<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> OpenVPN + Freepbx (Asterisk)</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 26 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p311857">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">jomimota</div>
					<div class="post-datetime">
						17 Feb 2016, 19:21					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I have a problem with my openvpn and asterisk.<br />I have a openwrt (GL-AR150) with a openvpn client in a remote site (192.168.30.0) to connect a main office (192.168.0.0). In the remote I have a Cisco SPA112 (IP: 192.168.30.40) to connect to my FreePBX at main Office. All applications in the remote, work well, but in the voip extensions I have a problem with audio in. I can call out but the phone don&#039;t ring. I hear the other person, but the other person can&#039;t hear me.</p><p>The openvpn tunnel endpoints are 10.0.7.1 and 10.0.7.2.</p><p>My openvpn settings are:</p><p>config openvpn &#039;office&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option dev &#039;tun&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option verb &#039;3&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option comp_lzo &#039;yes&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;udp&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option remote &#039;host.pt 25001&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option persist_tun &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option persist_key &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option keepalive &#039;10 60&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option auth &#039;SHA1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option cipher &#039;AES-128-CBC&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option resolv_retry &#039;infinite&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifconfig &#039;10.0.7.2 10.0.7.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option enabled &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option secret &#039;/etc/openvpn/sec.secret&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ping_timer_rem &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option route &#039;192.168.0.0 255.255.255.0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option script_security &#039;2&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option up &#039;/etc/openvpn/up.sh&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option down &#039;/etc/openvpn/down.sh&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option up_restart &#039;1&#039;</p><p>A strange behavior in Freepbx (Asterisk) log:</p><p>Endpoint:&nbsp; 221/221&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Not in use&nbsp; &nbsp; 0 of inf<br />&nbsp; &nbsp; &nbsp;InAuth:&nbsp; 221-auth/221<br />&nbsp; &nbsp; &nbsp; &nbsp; Aor:&nbsp; 221&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1<br />&nbsp; &nbsp; &nbsp; Contact:&nbsp; 221/sip:221@10.0.7.2:5060 </p><p>The remote extension 221 in SPA112 is registered as sip:221@10.0.7.2:5060 and not as it should sip:221@192.168.30.40:5060. The Freepbx see the openvpn endpoint tunnel ip and not the SPA112 (192.168.30.40) as it should see ...</p><p>Any help please?</p><p>Thanks in Advance.</p><p>Jorge Mota</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>