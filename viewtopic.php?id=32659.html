<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> How to establish a VPN connection btw. openwrt Router with a Fritz!Box</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 23 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p146997">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">schnurzelat</div>
					<div class="post-datetime">
						29 Oct 2011, 19:32					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>at home i use a Fritzbox with Fritz VPN. With my Android Phone i use the VPNC Widget Client to connect to the Fritzbox.</p><p>While traveling i want to use a TP-Link TP-WR1043 with openwrt (trunk) as a wifi/3g/vpn client. Wifi client and 3G client works, but the openwrt vpnc client doesn&#039;t work. When i try to connect with openwrt vpnc it stops at stage 4.3 or 4.4. I tried the default FritzVPN and the Fritz-Iphone configuration. Both doesn&#039;t work.</p><p>Installing openwrt or openvpn on the Fritzbox is no option.</p><p>Has anyone a idea how to establish a ipsec-vpn connection? Maybe racoon?</p><p>greets <br />schnurzelat</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p146998">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Orca</div>
					<div class="post-datetime">
						29 Oct 2011, 19:40					</div>
				</div>
				<div class="post-content content">
					<p><a href="http://wiki.openwrt.org/doc/howto/vpn.overview">VPNs on OpenWrt</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p147028">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						30 Oct 2011, 10:46					</div>
				</div>
				<div class="post-content content">
					<p>I made a howto for setting up racoon/xl2tpd here:</p><p><a href="https://forum.openwrt.org/viewtopic.php?id=30982">https://forum.openwrt.org/viewtopic.php?id=30982</a></p><p>Orca, what&#039;s the point of linking to an article that doesn&#039;t answer his question?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p147481">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">schnurzelat</div>
					<div class="post-datetime">
						3 Nov 2011, 15:38					</div>
				</div>
				<div class="post-content content">
					<p>@arokh</p><p>Thanks for you answer! I already googled your thread, but i think you misunderstood me. I do not want to set up an ip sec server.</p><p>I want my openwrt router to connect to my home network as a ipsec client. At home i am using a avm fritzbox with fritz vpn.</p><p>Maybe you have an idea.</p><p>The link from ocra doesn&#039;t help at all. vpnc on openwrt does not work like the vpnc widget on my android phone. The openwrt router does not connect.</p><p>greeting <br />schnurzelat</p><br /><p>my vpnc log:<br /></p><div class="codebox"><pre><code>root@OpenWrt:/etc# vpnc

vpnc version 0.5.3

S1 init_sockaddr
 [2011-11-03 13:49:43]

S2 make_socket
 [2011-11-03 13:49:43]

S3 setup_tunnel
 [2011-11-03 13:49:43]
   using interface tun0

S4 do_phase1_am
 [2011-11-03 13:49:43]

S4.1 create_nonce
 [2011-11-03 13:49:43]

S4.2 dh setup
 [2011-11-03 13:49:43]

S4.3 AM packet_1
 [2011-11-03 13:49:43]

S4.4 AM_packet2
 [2011-11-03 13:49:44]
   (Xauth)
   (DPD)
vpnc: vpnc.c: 1164: lifetime_ike_process: Assertion `0&#039; failed.
Aborted
root@OpenWrt:/etc#</code></pre></div>											<p class="post-edited">(Last edited by <strong>schnurzelat</strong> on 3 Nov 2011, 15:50)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p147506">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">written_direcon</div>
					<div class="post-datetime">
						3 Nov 2011, 19:06					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>arokh wrote:</cite><blockquote><p>Orca, what&#039;s the point of linking to an article that doesn&#039;t answer his question?</p></blockquote></div><p>To increase his posts counter. LOL...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p147507">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">eleon216</div>
					<div class="post-datetime">
						3 Nov 2011, 19:27					</div>
				</div>
				<div class="post-content content">
					<p>start vpnc with --debug 3&nbsp; &nbsp;and maybe add --no-detach too and see if you get more infos. <br />vpnc should work on openwrt, I have a openwrt-box connecting with vpnc to an cisco asa5105 without any problems. I only had to add a custom reconnect-mechanism, because vpnc doesn&#039;t have one.</p>											<p class="post-edited">(Last edited by <strong>eleon216</strong> on 3 Nov 2011, 19:28)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p147558">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">schnurzelat</div>
					<div class="post-datetime">
						4 Nov 2011, 11:22					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for answering! </p><p>Here is my level 3 log:</p><div class="codebox"><pre><code>root@OpenWrt:~# vpnc --debug 3

vpnc version 0.5.3
   hex_test: 00010203

S1 init_sockaddr
 [2011-11-04 09:19:09]

S2 make_socket
 [2011-11-04 09:19:09]

S3 setup_tunnel
 [2011-11-04 09:19:09]
   using interface tun0

S4 do_phase1_am
 [2011-11-04 09:19:09]

S4.1 create_nonce
 [2011-11-04 09:19:09]
   i_cookie: aa749a3c 5de5e083
   i_nonce:
   c733a771 93e0569e e1292267 7b2ad61e 523b18c8

S4.2 dh setup
 [2011-11-04 09:19:09]
   dh_public:
   d6d92254 59cfb91a 3c82fa73 ac1393ab 39277aaf e6ac6204 cf21e3ee 24d7f7a4
   1056a7fd fc247bda 86ee25e5 aa3d039b 63e9b928 0c1fab4e a8a22714 23ed30d0
   1ee02a97 34560fcb 007cdd3b 3299f5c9 258a861e f3e30690 969681a9 a3d79d86
   a69e5dfa 08c8d36f 54de29ef 12652867 c8f0b0ca 459b5f59 cf652522 6b7c374b

S4.3 AM packet_1
 [2011-11-04 09:19:09]

 sending: ========================&gt;
   BEGIN_PARSE
   Recieved Packet Len: 1305
   i_cookie: aa749a3c 5de5e083
   r_cookie: 00000000 00000000
   payload: 01 (ISAKMP_PAYLOAD_SA)
   isakmp_version: 10
   exchange_type: 04 (ISAKMP_EXCHANGE_AGGRESSIVE)
   flags: 00
   message_id: 00000000
   len: 00000519

   PARSING PAYLOAD type: 01 (ISAKMP_PAYLOAD_SA)
   next_type: 04 (ISAKMP_PAYLOAD_KE)
   length: 0000
   sa.doi: 00000001 (ISAKMP_DOI_IPSEC)
   sa.situation: 00000001 (ISAKMP_IPSEC_SIT_IDENTITY_ONLY)

   PARSING PAYLOAD type: 02 (ISAKMP_PAYLOAD_P)
   next_type: 00 (ISAKMP_PAYLOAD_NONE)
   length: 0000
   p.number: 00
   p.prot_id: 01 (ISAKMP_IPSEC_PROTO_ISAKMP)
   p.spi_size: 00
   length: 18
   p.spi:

   PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)
   next_type: 03 (ISAKMP_PAYLOAD_T)
   length: 0000
   t.number: 00
   t.id: 01 (ISAKMP_IPSEC_KEY_IKE)
   t.attributes.type: 000e (IKE_ATTRIB_KEY_LENGTH)
   t.attributes.u.attr_16: 0100
   t.attributes.type: 0001 (IKE_ATTRIB_ENC)
   t.attributes.u.attr_16: 0007 (IKE_ENC_AES_CBC)
   t.attributes.type: 0002 (IKE_ATTRIB_HASH)
   t.attributes.u.attr_16: 0002 (IKE_HASH_SHA)
   t.attributes.type: 0004 (IKE_ATTRIB_GROUP_DESC)
   t.attributes.u.attr_16: 0002 (IKE_GROUP_MODP_1024)
   t.attributes.type: 0003 (IKE_ATTRIB_AUTH_METHOD)
   t.attributes.u.attr_16: fde9 (IKE_AUTH_XAUTHInitPreShared)
   t.attributes.type: 000b (IKE_ATTRIB_LIFE_TYPE)
   t.attributes.u.attr_16: 0001 (IKE_LIFE_TYPE_SECONDS)
   t.attributes.type: 000c (IKE_ATTRIB_LIFE_DURATION)
   t.attributes.u.lots.length: 0004
   t.attributes.u.lots.data: 0020c49b
   DONE PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)

   PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)
   next_type: 03 (ISAKMP_PAYLOAD_T)
   length: 0000
   t.number: 01
   t.id: 01 (ISAKMP_IPSEC_KEY_IKE)
   t.attributes.type: 000e (IKE_ATTRIB_KEY_LENGTH)
   t.attributes.u.attr_16: 0100
   t.attributes.type: 0001 (IKE_ATTRIB_ENC)
   t.attributes.u.attr_16: 0007 (IKE_ENC_AES_CBC)
   t.attributes.type: 0002 (IKE_ATTRIB_HASH)
   t.attributes.u.attr_16: 0001 (IKE_HASH_MD5)
   t.attributes.type: 0004 (IKE_ATTRIB_GROUP_DESC)
   t.attributes.u.attr_16: 0002 (IKE_GROUP_MODP_1024)
   t.attributes.type: 0003 (IKE_ATTRIB_AUTH_METHOD)
   t.attributes.u.attr_16: fde9 (IKE_AUTH_XAUTHInitPreShared)
   t.attributes.type: 000b (IKE_ATTRIB_LIFE_TYPE)
   t.attributes.u.attr_16: 0001 (IKE_LIFE_TYPE_SECONDS)
   t.attributes.type: 000c (IKE_ATTRIB_LIFE_DURATION)
   t.attributes.u.lots.length: 0004
   t.attributes.u.lots.data: 0020c49b
   DONE PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)

   PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)
   next_type: 03 (ISAKMP_PAYLOAD_T)
   length: 0000
   t.number: 02
   t.id: 01 (ISAKMP_IPSEC_KEY_IKE)
   t.attributes.type: 000e (IKE_ATTRIB_KEY_LENGTH)
   t.attributes.u.attr_16: 00c0
   t.attributes.type: 0001 (IKE_ATTRIB_ENC)
   t.attributes.u.attr_16: 0007 (IKE_ENC_AES_CBC)
   t.attributes.type: 0002 (IKE_ATTRIB_HASH)
   t.attributes.u.attr_16: 0002 (IKE_HASH_SHA)
   t.attributes.type: 0004 (IKE_ATTRIB_GROUP_DESC)
   t.attributes.u.attr_16: 0002 (IKE_GROUP_MODP_1024)
   t.attributes.type: 0003 (IKE_ATTRIB_AUTH_METHOD)
   t.attributes.u.attr_16: fde9 (IKE_AUTH_XAUTHInitPreShared)
   t.attributes.type: 000b (IKE_ATTRIB_LIFE_TYPE)
   t.attributes.u.attr_16: 0001 (IKE_LIFE_TYPE_SECONDS)
   t.attributes.type: 000c (IKE_ATTRIB_LIFE_DURATION)
   t.attributes.u.lots.length: 0004
   t.attributes.u.lots.data: 0020c49b
   DONE PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)

   PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)
   next_type: 03 (ISAKMP_PAYLOAD_T)
   length: 0000
   t.number: 03
   t.id: 01 (ISAKMP_IPSEC_KEY_IKE)
   t.attributes.type: 000e (IKE_ATTRIB_KEY_LENGTH)
   t.attributes.u.attr_16: 00c0
   t.attributes.type: 0001 (IKE_ATTRIB_ENC)
   t.attributes.u.attr_16: 0007 (IKE_ENC_AES_CBC)
   t.attributes.type: 0002 (IKE_ATTRIB_HASH)
   t.attributes.u.attr_16: 0001 (IKE_HASH_MD5)
   t.attributes.type: 0004 (IKE_ATTRIB_GROUP_DESC)
   t.attributes.u.attr_16: 0002 (IKE_GROUP_MODP_1024)
   t.attributes.type: 0003 (IKE_ATTRIB_AUTH_METHOD)
   t.attributes.u.attr_16: fde9 (IKE_AUTH_XAUTHInitPreShared)
   t.attributes.type: 000b (IKE_ATTRIB_LIFE_TYPE)
   t.attributes.u.attr_16: 0001 (IKE_LIFE_TYPE_SECONDS)
   t.attributes.type: 000c (IKE_ATTRIB_LIFE_DURATION)
   t.attributes.u.lots.length: 0004
   t.attributes.u.lots.data: 0020c49b
   DONE PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)

   PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)
   next_type: 03 (ISAKMP_PAYLOAD_T)
   length: 0000
   t.number: 04
   t.id: 01 (ISAKMP_IPSEC_KEY_IKE)
   t.attributes.type: 000e (IKE_ATTRIB_KEY_LENGTH)
   t.attributes.u.attr_16: 0080
   t.attributes.type: 0001 (IKE_ATTRIB_ENC)
   t.attributes.u.attr_16: 0007 (IKE_ENC_AES_CBC)
   t.attributes.type: 0002 (IKE_ATTRIB_HASH)
   t.attributes.u.attr_16: 0002 (IKE_HASH_SHA)
   t.attributes.type: 0004 (IKE_ATTRIB_GROUP_DESC)
   t.attributes.u.attr_16: 0002 (IKE_GROUP_MODP_1024)
   t.attributes.type: 0003 (IKE_ATTRIB_AUTH_METHOD)
   t.attributes.u.attr_16: fde9 (IKE_AUTH_XAUTHInitPreShared)
   t.attributes.type: 000b (IKE_ATTRIB_LIFE_TYPE)
   t.attributes.u.attr_16: 0001 (IKE_LIFE_TYPE_SECONDS)
   t.attributes.type: 000c (IKE_ATTRIB_LIFE_DURATION)
   t.attributes.u.lots.length: 0004
   t.attributes.u.lots.data: 0020c49b
   DONE PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)

   PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)
   next_type: 03 (ISAKMP_PAYLOAD_T)
   length: 0000
   t.number: 05
   t.id: 01 (ISAKMP_IPSEC_KEY_IKE)
   t.attributes.type: 000e (IKE_ATTRIB_KEY_LENGTH)
   t.attributes.u.attr_16: 0080
   t.attributes.type: 0001 (IKE_ATTRIB_ENC)
   t.attributes.u.attr_16: 0007 (IKE_ENC_AES_CBC)
   t.attributes.type: 0002 (IKE_ATTRIB_HASH)
   t.attributes.u.attr_16: 0001 (IKE_HASH_MD5)
   t.attributes.type: 0004 (IKE_ATTRIB_GROUP_DESC)
   t.attributes.u.attr_16: 0002 (IKE_GROUP_MODP_1024)
   t.attributes.type: 0003 (IKE_ATTRIB_AUTH_METHOD)
   t.attributes.u.attr_16: fde9 (IKE_AUTH_XAUTHInitPreShared)
   t.attributes.type: 000b (IKE_ATTRIB_LIFE_TYPE)
   t.attributes.u.attr_16: 0001 (IKE_LIFE_TYPE_SECONDS)
   t.attributes.type: 000c (IKE_ATTRIB_LIFE_DURATION)
   t.attributes.u.lots.length: 0004
   t.attributes.u.lots.data: 0020c49b
   DONE PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)

   PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)
   next_type: 03 (ISAKMP_PAYLOAD_T)
   length: 0000
   t.number: 06
   t.id: 01 (ISAKMP_IPSEC_KEY_IKE)
   t.attributes.type: 0001 (IKE_ATTRIB_ENC)
   t.attributes.u.attr_16: 0005 (IKE_ENC_3DES_CBC)
   t.attributes.type: 0002 (IKE_ATTRIB_HASH)
   t.attributes.u.attr_16: 0002 (IKE_HASH_SHA)
   t.attributes.type: 0004 (IKE_ATTRIB_GROUP_DESC)
   t.attributes.u.attr_16: 0002 (IKE_GROUP_MODP_1024)
   t.attributes.type: 0003 (IKE_ATTRIB_AUTH_METHOD)
   t.attributes.u.attr_16: fde9 (IKE_AUTH_XAUTHInitPreShared)
   t.attributes.type: 000b (IKE_ATTRIB_LIFE_TYPE)
   t.attributes.u.attr_16: 0001 (IKE_LIFE_TYPE_SECONDS)
   t.attributes.type: 000c (IKE_ATTRIB_LIFE_DURATION)
   t.attributes.u.lots.length: 0004
   t.attributes.u.lots.data: 0020c49b
   DONE PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)

   PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)
   next_type: 03 (ISAKMP_PAYLOAD_T)
   length: 0000
   t.number: 07
   t.id: 01 (ISAKMP_IPSEC_KEY_IKE)
   t.attributes.type: 0001 (IKE_ATTRIB_ENC)
   t.attributes.u.attr_16: 0005 (IKE_ENC_3DES_CBC)
   t.attributes.type: 0002 (IKE_ATTRIB_HASH)
   t.attributes.u.attr_16: 0001 (IKE_HASH_MD5)
   t.attributes.type: 0004 (IKE_ATTRIB_GROUP_DESC)
   t.attributes.u.attr_16: 0002 (IKE_GROUP_MODP_1024)
   t.attributes.type: 0003 (IKE_ATTRIB_AUTH_METHOD)
   t.attributes.u.attr_16: fde9 (IKE_AUTH_XAUTHInitPreShared)
   t.attributes.type: 000b (IKE_ATTRIB_LIFE_TYPE)
   t.attributes.u.attr_16: 0001 (IKE_LIFE_TYPE_SECONDS)
   t.attributes.type: 000c (IKE_ATTRIB_LIFE_DURATION)
   t.attributes.u.lots.length: 0004
   t.attributes.u.lots.data: 0020c49b
   DONE PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)

   PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)
   next_type: 03 (ISAKMP_PAYLOAD_T)
   length: 0000
   t.number: 08
   t.id: 01 (ISAKMP_IPSEC_KEY_IKE)
   t.attributes.type: 0001 (IKE_ATTRIB_ENC)
   t.attributes.u.attr_16: 0001 (IKE_ENC_DES_CBC)
   t.attributes.type: 0002 (IKE_ATTRIB_HASH)
   t.attributes.u.attr_16: 0002 (IKE_HASH_SHA)
   t.attributes.type: 0004 (IKE_ATTRIB_GROUP_DESC)
   t.attributes.u.attr_16: 0002 (IKE_GROUP_MODP_1024)
   t.attributes.type: 0003 (IKE_ATTRIB_AUTH_METHOD)
   t.attributes.u.attr_16: fde9 (IKE_AUTH_XAUTHInitPreShared)
   t.attributes.type: 000b (IKE_ATTRIB_LIFE_TYPE)
   t.attributes.u.attr_16: 0001 (IKE_LIFE_TYPE_SECONDS)
   t.attributes.type: 000c (IKE_ATTRIB_LIFE_DURATION)
   t.attributes.u.lots.length: 0004
   t.attributes.u.lots.data: 0020c49b
   DONE PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)

   PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)
   next_type: 03 (ISAKMP_PAYLOAD_T)
   length: 0000
   t.number: 09
   t.id: 01 (ISAKMP_IPSEC_KEY_IKE)
   t.attributes.type: 0001 (IKE_ATTRIB_ENC)
   t.attributes.u.attr_16: 0001 (IKE_ENC_DES_CBC)
   t.attributes.type: 0002 (IKE_ATTRIB_HASH)
   t.attributes.u.attr_16: 0001 (IKE_HASH_MD5)
   t.attributes.type: 0004 (IKE_ATTRIB_GROUP_DESC)
   t.attributes.u.attr_16: 0002 (IKE_GROUP_MODP_1024)
   t.attributes.type: 0003 (IKE_ATTRIB_AUTH_METHOD)
   t.attributes.u.attr_16: fde9 (IKE_AUTH_XAUTHInitPreShared)
   t.attributes.type: 000b (IKE_ATTRIB_LIFE_TYPE)
   t.attributes.u.attr_16: 0001 (IKE_LIFE_TYPE_SECONDS)
   t.attributes.type: 000c (IKE_ATTRIB_LIFE_DURATION)
   t.attributes.u.lots.length: 0004
   t.attributes.u.lots.data: 0020c49b
   DONE PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)

   PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)
   next_type: 03 (ISAKMP_PAYLOAD_T)
   length: 0000
   t.number: 0a
   t.id: 01 (ISAKMP_IPSEC_KEY_IKE)
   t.attributes.type: 0001 (IKE_ATTRIB_ENC)
   t.attributes.u.attr_16: 0000 (IKE_ENC_NO_CBC)
   t.attributes.type: 0002 (IKE_ATTRIB_HASH)
   t.attributes.u.attr_16: 0002 (IKE_HASH_SHA)
   t.attributes.type: 0004 (IKE_ATTRIB_GROUP_DESC)
   t.attributes.u.attr_16: 0002 (IKE_GROUP_MODP_1024)
   t.attributes.type: 0003 (IKE_ATTRIB_AUTH_METHOD)
   t.attributes.u.attr_16: fde9 (IKE_AUTH_XAUTHInitPreShared)
   t.attributes.type: 000b (IKE_ATTRIB_LIFE_TYPE)
   t.attributes.u.attr_16: 0001 (IKE_LIFE_TYPE_SECONDS)
   t.attributes.type: 000c (IKE_ATTRIB_LIFE_DURATION)
   t.attributes.u.lots.length: 0004
   t.attributes.u.lots.data: 0020c49b
   DONE PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)

   PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)
   next_type: 03 (ISAKMP_PAYLOAD_T)
   length: 0000
   t.number: 0b
   t.id: 01 (ISAKMP_IPSEC_KEY_IKE)
   t.attributes.type: 0001 (IKE_ATTRIB_ENC)
   t.attributes.u.attr_16: 0000 (IKE_ENC_NO_CBC)
   t.attributes.type: 0002 (IKE_ATTRIB_HASH)
   t.attributes.u.attr_16: 0001 (IKE_HASH_MD5)
   t.attributes.type: 0004 (IKE_ATTRIB_GROUP_DESC)
   t.attributes.u.attr_16: 0002 (IKE_GROUP_MODP_1024)
   t.attributes.type: 0003 (IKE_ATTRIB_AUTH_METHOD)
   t.attributes.u.attr_16: fde9 (IKE_AUTH_XAUTHInitPreShared)
   t.attributes.type: 000b (IKE_ATTRIB_LIFE_TYPE)
   t.attributes.u.attr_16: 0001 (IKE_LIFE_TYPE_SECONDS)
   t.attributes.type: 000c (IKE_ATTRIB_LIFE_DURATION)
   t.attributes.u.lots.length: 0004
   t.attributes.u.lots.data: 0020c49b
   DONE PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)

   PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)
   next_type: 03 (ISAKMP_PAYLOAD_T)
   length: 0000
   t.number: 0c
   t.id: 01 (ISAKMP_IPSEC_KEY_IKE)
   t.attributes.type: 000e (IKE_ATTRIB_KEY_LENGTH)
   t.attributes.u.attr_16: 0100
   t.attributes.type: 0001 (IKE_ATTRIB_ENC)
   t.attributes.u.attr_16: 0007 (IKE_ENC_AES_CBC)
   t.attributes.type: 0002 (IKE_ATTRIB_HASH)
   t.attributes.u.attr_16: 0002 (IKE_HASH_SHA)
   t.attributes.type: 0004 (IKE_ATTRIB_GROUP_DESC)
   t.attributes.u.attr_16: 0002 (IKE_GROUP_MODP_1024)
   t.attributes.type: 0003 (IKE_ATTRIB_AUTH_METHOD)
   t.attributes.u.attr_16: 0001 (IKE_AUTH_PRESHARED)
   t.attributes.type: 000b (IKE_ATTRIB_LIFE_TYPE)
   t.attributes.u.attr_16: 0001 (IKE_LIFE_TYPE_SECONDS)
   t.attributes.type: 000c (IKE_ATTRIB_LIFE_DURATION)
   t.attributes.u.lots.length: 0004
   t.attributes.u.lots.data: 0020c49b
   DONE PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)

   PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)
   next_type: 03 (ISAKMP_PAYLOAD_T)
   length: 0000
   t.number: 0d
   t.id: 01 (ISAKMP_IPSEC_KEY_IKE)
   t.attributes.type: 000e (IKE_ATTRIB_KEY_LENGTH)
   t.attributes.u.attr_16: 0100
   t.attributes.type: 0001 (IKE_ATTRIB_ENC)
   t.attributes.u.attr_16: 0007 (IKE_ENC_AES_CBC)
   t.attributes.type: 0002 (IKE_ATTRIB_HASH)
   t.attributes.u.attr_16: 0001 (IKE_HASH_MD5)
   t.attributes.type: 0004 (IKE_ATTRIB_GROUP_DESC)
   t.attributes.u.attr_16: 0002 (IKE_GROUP_MODP_1024)
   t.attributes.type: 0003 (IKE_ATTRIB_AUTH_METHOD)
   t.attributes.u.attr_16: 0001 (IKE_AUTH_PRESHARED)
   t.attributes.type: 000b (IKE_ATTRIB_LIFE_TYPE)
   t.attributes.u.attr_16: 0001 (IKE_LIFE_TYPE_SECONDS)
   t.attributes.type: 000c (IKE_ATTRIB_LIFE_DURATION)
   t.attributes.u.lots.length: 0004
   t.attributes.u.lots.data: 0020c49b
   DONE PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)

   PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)
   next_type: 03 (ISAKMP_PAYLOAD_T)
   length: 0000
   t.number: 0e
   t.id: 01 (ISAKMP_IPSEC_KEY_IKE)
   t.attributes.type: 000e (IKE_ATTRIB_KEY_LENGTH)
   t.attributes.u.attr_16: 00c0
   t.attributes.type: 0001 (IKE_ATTRIB_ENC)
   t.attributes.u.attr_16: 0007 (IKE_ENC_AES_CBC)
   t.attributes.type: 0002 (IKE_ATTRIB_HASH)
   t.attributes.u.attr_16: 0002 (IKE_HASH_SHA)
   t.attributes.type: 0004 (IKE_ATTRIB_GROUP_DESC)
   t.attributes.u.attr_16: 0002 (IKE_GROUP_MODP_1024)
   t.attributes.type: 0003 (IKE_ATTRIB_AUTH_METHOD)
   t.attributes.u.attr_16: 0001 (IKE_AUTH_PRESHARED)
   t.attributes.type: 000b (IKE_ATTRIB_LIFE_TYPE)
   t.attributes.u.attr_16: 0001 (IKE_LIFE_TYPE_SECONDS)
   t.attributes.type: 000c (IKE_ATTRIB_LIFE_DURATION)
   t.attributes.u.lots.length: 0004
   t.attributes.u.lots.data: 0020c49b
   DONE PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)

   PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)
   next_type: 03 (ISAKMP_PAYLOAD_T)
   length: 0000
   t.number: 0f
   t.id: 01 (ISAKMP_IPSEC_KEY_IKE)
   t.attributes.type: 000e (IKE_ATTRIB_KEY_LENGTH)
   t.attributes.u.attr_16: 00c0
   t.attributes.type: 0001 (IKE_ATTRIB_ENC)
   t.attributes.u.attr_16: 0007 (IKE_ENC_AES_CBC)
   t.attributes.type: 0002 (IKE_ATTRIB_HASH)
   t.attributes.u.attr_16: 0001 (IKE_HASH_MD5)
   t.attributes.type: 0004 (IKE_ATTRIB_GROUP_DESC)
   t.attributes.u.attr_16: 0002 (IKE_GROUP_MODP_1024)
   t.attributes.type: 0003 (IKE_ATTRIB_AUTH_METHOD)
   t.attributes.u.attr_16: 0001 (IKE_AUTH_PRESHARED)
   t.attributes.type: 000b (IKE_ATTRIB_LIFE_TYPE)
   t.attributes.u.attr_16: 0001 (IKE_LIFE_TYPE_SECONDS)
   t.attributes.type: 000c (IKE_ATTRIB_LIFE_DURATION)
   t.attributes.u.lots.length: 0004
   t.attributes.u.lots.data: 0020c49b
   DONE PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)

   PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)
   next_type: 03 (ISAKMP_PAYLOAD_T)
   length: 0000
   t.number: 10
   t.id: 01 (ISAKMP_IPSEC_KEY_IKE)
   t.attributes.type: 000e (IKE_ATTRIB_KEY_LENGTH)
   t.attributes.u.attr_16: 0080
   t.attributes.type: 0001 (IKE_ATTRIB_ENC)
   t.attributes.u.attr_16: 0007 (IKE_ENC_AES_CBC)
   t.attributes.type: 0002 (IKE_ATTRIB_HASH)
   t.attributes.u.attr_16: 0002 (IKE_HASH_SHA)
   t.attributes.type: 0004 (IKE_ATTRIB_GROUP_DESC)
   t.attributes.u.attr_16: 0002 (IKE_GROUP_MODP_1024)
   t.attributes.type: 0003 (IKE_ATTRIB_AUTH_METHOD)
   t.attributes.u.attr_16: 0001 (IKE_AUTH_PRESHARED)
   t.attributes.type: 000b (IKE_ATTRIB_LIFE_TYPE)
   t.attributes.u.attr_16: 0001 (IKE_LIFE_TYPE_SECONDS)
   t.attributes.type: 000c (IKE_ATTRIB_LIFE_DURATION)
   t.attributes.u.lots.length: 0004
   t.attributes.u.lots.data: 0020c49b
   DONE PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)

   PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)
   next_type: 03 (ISAKMP_PAYLOAD_T)
   length: 0000
   t.number: 11
   t.id: 01 (ISAKMP_IPSEC_KEY_IKE)
   t.attributes.type: 000e (IKE_ATTRIB_KEY_LENGTH)
   t.attributes.u.attr_16: 0080
   t.attributes.type: 0001 (IKE_ATTRIB_ENC)
   t.attributes.u.attr_16: 0007 (IKE_ENC_AES_CBC)
   t.attributes.type: 0002 (IKE_ATTRIB_HASH)
   t.attributes.u.attr_16: 0001 (IKE_HASH_MD5)
   t.attributes.type: 0004 (IKE_ATTRIB_GROUP_DESC)
   t.attributes.u.attr_16: 0002 (IKE_GROUP_MODP_1024)
   t.attributes.type: 0003 (IKE_ATTRIB_AUTH_METHOD)
   t.attributes.u.attr_16: 0001 (IKE_AUTH_PRESHARED)
   t.attributes.type: 000b (IKE_ATTRIB_LIFE_TYPE)
   t.attributes.u.attr_16: 0001 (IKE_LIFE_TYPE_SECONDS)
   t.attributes.type: 000c (IKE_ATTRIB_LIFE_DURATION)
   t.attributes.u.lots.length: 0004
   t.attributes.u.lots.data: 0020c49b
   DONE PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)

   PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)
   next_type: 03 (ISAKMP_PAYLOAD_T)
   length: 0000
   t.number: 12
   t.id: 01 (ISAKMP_IPSEC_KEY_IKE)
   t.attributes.type: 0001 (IKE_ATTRIB_ENC)
   t.attributes.u.attr_16: 0005 (IKE_ENC_3DES_CBC)
   t.attributes.type: 0002 (IKE_ATTRIB_HASH)
   t.attributes.u.attr_16: 0002 (IKE_HASH_SHA)
   t.attributes.type: 0004 (IKE_ATTRIB_GROUP_DESC)
   t.attributes.u.attr_16: 0002 (IKE_GROUP_MODP_1024)
   t.attributes.type: 0003 (IKE_ATTRIB_AUTH_METHOD)
   t.attributes.u.attr_16: 0001 (IKE_AUTH_PRESHARED)
   t.attributes.type: 000b (IKE_ATTRIB_LIFE_TYPE)
   t.attributes.u.attr_16: 0001 (IKE_LIFE_TYPE_SECONDS)
   t.attributes.type: 000c (IKE_ATTRIB_LIFE_DURATION)
   t.attributes.u.lots.length: 0004
   t.attributes.u.lots.data: 0020c49b
   DONE PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)

   PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)
   next_type: 03 (ISAKMP_PAYLOAD_T)
   length: 0000
   t.number: 13
   t.id: 01 (ISAKMP_IPSEC_KEY_IKE)
   t.attributes.type: 0001 (IKE_ATTRIB_ENC)
   t.attributes.u.attr_16: 0005 (IKE_ENC_3DES_CBC)
   t.attributes.type: 0002 (IKE_ATTRIB_HASH)
   t.attributes.u.attr_16: 0001 (IKE_HASH_MD5)
   t.attributes.type: 0004 (IKE_ATTRIB_GROUP_DESC)
   t.attributes.u.attr_16: 0002 (IKE_GROUP_MODP_1024)
   t.attributes.type: 0003 (IKE_ATTRIB_AUTH_METHOD)
   t.attributes.u.attr_16: 0001 (IKE_AUTH_PRESHARED)
   t.attributes.type: 000b (IKE_ATTRIB_LIFE_TYPE)
   t.attributes.u.attr_16: 0001 (IKE_LIFE_TYPE_SECONDS)
   t.attributes.type: 000c (IKE_ATTRIB_LIFE_DURATION)
   t.attributes.u.lots.length: 0004
   t.attributes.u.lots.data: 0020c49b
   DONE PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)

   PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)
   next_type: 03 (ISAKMP_PAYLOAD_T)
   length: 0000
   t.number: 14
   t.id: 01 (ISAKMP_IPSEC_KEY_IKE)
   t.attributes.type: 0001 (IKE_ATTRIB_ENC)
   t.attributes.u.attr_16: 0001 (IKE_ENC_DES_CBC)
   t.attributes.type: 0002 (IKE_ATTRIB_HASH)
   t.attributes.u.attr_16: 0002 (IKE_HASH_SHA)
   t.attributes.type: 0004 (IKE_ATTRIB_GROUP_DESC)
   t.attributes.u.attr_16: 0002 (IKE_GROUP_MODP_1024)
   t.attributes.type: 0003 (IKE_ATTRIB_AUTH_METHOD)
   t.attributes.u.attr_16: 0001 (IKE_AUTH_PRESHARED)
   t.attributes.type: 000b (IKE_ATTRIB_LIFE_TYPE)
   t.attributes.u.attr_16: 0001 (IKE_LIFE_TYPE_SECONDS)
   t.attributes.type: 000c (IKE_ATTRIB_LIFE_DURATION)
   t.attributes.u.lots.length: 0004
   t.attributes.u.lots.data: 0020c49b
   DONE PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)

   PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)
   next_type: 03 (ISAKMP_PAYLOAD_T)
   length: 0000
   t.number: 15
   t.id: 01 (ISAKMP_IPSEC_KEY_IKE)
   t.attributes.type: 0001 (IKE_ATTRIB_ENC)
   t.attributes.u.attr_16: 0001 (IKE_ENC_DES_CBC)
   t.attributes.type: 0002 (IKE_ATTRIB_HASH)
   t.attributes.u.attr_16: 0001 (IKE_HASH_MD5)
   t.attributes.type: 0004 (IKE_ATTRIB_GROUP_DESC)
   t.attributes.u.attr_16: 0002 (IKE_GROUP_MODP_1024)
   t.attributes.type: 0003 (IKE_ATTRIB_AUTH_METHOD)
   t.attributes.u.attr_16: 0001 (IKE_AUTH_PRESHARED)
   t.attributes.type: 000b (IKE_ATTRIB_LIFE_TYPE)
   t.attributes.u.attr_16: 0001 (IKE_LIFE_TYPE_SECONDS)
   t.attributes.type: 000c (IKE_ATTRIB_LIFE_DURATION)
   t.attributes.u.lots.length: 0004
   t.attributes.u.lots.data: 0020c49b
   DONE PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)

   PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)
   next_type: 03 (ISAKMP_PAYLOAD_T)
   length: 0000
   t.number: 16
   t.id: 01 (ISAKMP_IPSEC_KEY_IKE)
   t.attributes.type: 0001 (IKE_ATTRIB_ENC)
   t.attributes.u.attr_16: 0000 (IKE_ENC_NO_CBC)
   t.attributes.type: 0002 (IKE_ATTRIB_HASH)
   t.attributes.u.attr_16: 0002 (IKE_HASH_SHA)
   t.attributes.type: 0004 (IKE_ATTRIB_GROUP_DESC)
   t.attributes.u.attr_16: 0002 (IKE_GROUP_MODP_1024)
   t.attributes.type: 0003 (IKE_ATTRIB_AUTH_METHOD)
   t.attributes.u.attr_16: 0001 (IKE_AUTH_PRESHARED)
   t.attributes.type: 000b (IKE_ATTRIB_LIFE_TYPE)
   t.attributes.u.attr_16: 0001 (IKE_LIFE_TYPE_SECONDS)
   t.attributes.type: 000c (IKE_ATTRIB_LIFE_DURATION)
   t.attributes.u.lots.length: 0004
   t.attributes.u.lots.data: 0020c49b
   DONE PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)

   PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)
   next_type: 00 (ISAKMP_PAYLOAD_NONE)
   length: 0000
   t.number: 17
   t.id: 01 (ISAKMP_IPSEC_KEY_IKE)
   t.attributes.type: 0001 (IKE_ATTRIB_ENC)
   t.attributes.u.attr_16: 0000 (IKE_ENC_NO_CBC)
   t.attributes.type: 0002 (IKE_ATTRIB_HASH)
   t.attributes.u.attr_16: 0001 (IKE_HASH_MD5)
   t.attributes.type: 0004 (IKE_ATTRIB_GROUP_DESC)
   t.attributes.u.attr_16: 0002 (IKE_GROUP_MODP_1024)
   t.attributes.type: 0003 (IKE_ATTRIB_AUTH_METHOD)
   t.attributes.u.attr_16: 0001 (IKE_AUTH_PRESHARED)
   t.attributes.type: 000b (IKE_ATTRIB_LIFE_TYPE)
   t.attributes.u.attr_16: 0001 (IKE_LIFE_TYPE_SECONDS)
   t.attributes.type: 000c (IKE_ATTRIB_LIFE_DURATION)
   t.attributes.u.lots.length: 0004
   t.attributes.u.lots.data: 0020c49b
   DONE PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)

   PARSING PAYLOAD type: 00 (ISAKMP_PAYLOAD_NONE)
   DONE PARSING PAYLOAD type: 02 (ISAKMP_PAYLOAD_P)

   PARSING PAYLOAD type: 00 (ISAKMP_PAYLOAD_NONE)
   DONE PARSING PAYLOAD type: 01 (ISAKMP_PAYLOAD_SA)

   PARSING PAYLOAD type: 04 (ISAKMP_PAYLOAD_KE)
   next_type: 0a (ISAKMP_PAYLOAD_NONCE)
   length: 0000
   ke.data:
   d6d92254 59cfb91a 3c82fa73 ac1393ab 39277aaf e6ac6204 cf21e3ee 24d7f7a4
   1056a7fd fc247bda 86ee25e5 aa3d039b 63e9b928 0c1fab4e a8a22714 23ed30d0
   1ee02a97 34560fcb 007cdd3b 3299f5c9 258a861e f3e30690 969681a9 a3d79d86
   a69e5dfa 08c8d36f 54de29ef 12652867 c8f0b0ca 459b5f59 cf652522 6b7c374b
   DONE PARSING PAYLOAD type: 04 (ISAKMP_PAYLOAD_KE)

   PARSING PAYLOAD type: 0a (ISAKMP_PAYLOAD_NONCE)
   next_type: 05 (ISAKMP_PAYLOAD_ID)
   length: 0000
   ke.data:
   c733a771 93e0569e e1292267 7b2ad61e 523b18c8
   DONE PARSING PAYLOAD type: 0a (ISAKMP_PAYLOAD_NONCE)

   PARSING PAYLOAD type: 05 (ISAKMP_PAYLOAD_ID)
   next_type: 0d (ISAKMP_PAYLOAD_VID)
   length: 0000
   id.type: 0b (ISAKMP_IPSEC_ID_KEY_ID)
   id.protocol: 11
   id.port: 01f4
   id.data:
   636c6965 6e743240 7363686e 75727a65 6c30372e 686f7074 6f2e6f72 67
   DONE PARSING PAYLOAD type: 05 (ISAKMP_PAYLOAD_ID)

   PARSING PAYLOAD type: 0d (ISAKMP_PAYLOAD_VID)
   next_type: 0d (ISAKMP_PAYLOAD_VID)
   length: 0000
   ke.data: 09002689 dfd6b712
   (Xauth)
   DONE PARSING PAYLOAD type: 0d (ISAKMP_PAYLOAD_VID)

   PARSING PAYLOAD type: 0d (ISAKMP_PAYLOAD_VID)
   next_type: 0d (ISAKMP_PAYLOAD_VID)
   length: 0000
   ke.data: 12f5f28c 457168a9 702d9fe2 74cc0100
   (Cisco Unity)
   DONE PARSING PAYLOAD type: 0d (ISAKMP_PAYLOAD_VID)

   PARSING PAYLOAD type: 0d (ISAKMP_PAYLOAD_VID)
   next_type: 0d (ISAKMP_PAYLOAD_VID)
   length: 0000
   ke.data: 4a131c81 07035845 5c5728f2 0e95452f
   (Nat-T RFC)
   DONE PARSING PAYLOAD type: 0d (ISAKMP_PAYLOAD_VID)

   PARSING PAYLOAD type: 0d (ISAKMP_PAYLOAD_VID)
   next_type: 0d (ISAKMP_PAYLOAD_VID)
   length: 0000
   ke.data: 90cb8091 3ebb696e 086381b5 ec427b1f
   (Nat-T 02N)
   DONE PARSING PAYLOAD type: 0d (ISAKMP_PAYLOAD_VID)

   PARSING PAYLOAD type: 0d (ISAKMP_PAYLOAD_VID)
   next_type: 0d (ISAKMP_PAYLOAD_VID)
   length: 0000
   ke.data: cd604643 35df21f8 7cfdb2fc 68b6a448
   (Nat-T 02)
   DONE PARSING PAYLOAD type: 0d (ISAKMP_PAYLOAD_VID)

   PARSING PAYLOAD type: 0d (ISAKMP_PAYLOAD_VID)
   next_type: 0d (ISAKMP_PAYLOAD_VID)
   length: 0000
   ke.data: 16f6ca16 e4a4066d 83821a0f 0aeaa862
   (Nat-T 01)
   DONE PARSING PAYLOAD type: 0d (ISAKMP_PAYLOAD_VID)

   PARSING PAYLOAD type: 0d (ISAKMP_PAYLOAD_VID)
   next_type: 0d (ISAKMP_PAYLOAD_VID)
   length: 0000
   ke.data: 4485152d 18b6bbcd 0be8a846 9579ddcc
   (Nat-T 00)
   DONE PARSING PAYLOAD type: 0d (ISAKMP_PAYLOAD_VID)

   PARSING PAYLOAD type: 0d (ISAKMP_PAYLOAD_VID)
   next_type: 00 (ISAKMP_PAYLOAD_NONE)
   length: 0000
   ke.data: afcad713 68a1f1c9 6b8696fc 77570100
   (DPD)
   DONE PARSING PAYLOAD type: 0d (ISAKMP_PAYLOAD_VID)

   PARSING PAYLOAD type: 00 (ISAKMP_PAYLOAD_NONE)
   PARSE_OK


 receiving: &lt;========================
 [2011-11-04 09:19:10]

S4.4 AM_packet2
 [2011-11-04 09:19:10]
   BEGIN_PARSE
   Recieved Packet Len: 340
   i_cookie: aa749a3c 5de5e083
   r_cookie: a1ee487d 5b908741
   payload: 01 (ISAKMP_PAYLOAD_SA)
   isakmp_version: 10
   exchange_type: 04 (ISAKMP_EXCHANGE_AGGRESSIVE)
   flags: 00
   message_id: 00000000
   len: 00000154

   PARSING PAYLOAD type: 01 (ISAKMP_PAYLOAD_SA)
   next_type: 04 (ISAKMP_PAYLOAD_KE)
   length: 0000
   sa.doi: 00000001 (ISAKMP_DOI_IPSEC)
   sa.situation: 00000001 (ISAKMP_IPSEC_SIT_IDENTITY_ONLY)

   PARSING PAYLOAD type: 02 (ISAKMP_PAYLOAD_P)
   next_type: 00 (ISAKMP_PAYLOAD_NONE)
   length: 0000
   p.number: 01
   p.prot_id: 01 (ISAKMP_IPSEC_PROTO_ISAKMP)
   p.spi_size: 00
   length: 01
   p.spi:

   PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)
   next_type: 00 (ISAKMP_PAYLOAD_NONE)
   length: 0000
   t.number: 01
   t.id: 01 (ISAKMP_IPSEC_KEY_IKE)
   t.attributes.type: 0001 (IKE_ATTRIB_ENC)
   t.attributes.u.attr_16: 0007 (IKE_ENC_AES_CBC)
   t.attributes.type: 000e (IKE_ATTRIB_KEY_LENGTH)
   t.attributes.u.attr_16: 0100
   t.attributes.type: 0002 (IKE_ATTRIB_HASH)
   t.attributes.u.attr_16: 0002 (IKE_HASH_SHA)
   t.attributes.type: 0003 (IKE_ATTRIB_AUTH_METHOD)
   t.attributes.u.attr_16: fde9 (IKE_AUTH_XAUTHInitPreShared)
   t.attributes.type: 0004 (IKE_ATTRIB_GROUP_DESC)
   t.attributes.u.attr_16: 0002 (IKE_GROUP_MODP_1024)
   t.attributes.type: 000b (IKE_ATTRIB_LIFE_TYPE)
   t.attributes.u.attr_16: 0001 (IKE_LIFE_TYPE_SECONDS)
   t.attributes.type: 000c (IKE_ATTRIB_LIFE_DURATION)
   t.attributes.u.lots.length: 0000
   t.attributes.u.lots.data:
   DONE PARSING PAYLOAD type: 03 (ISAKMP_PAYLOAD_T)

   PARSING PAYLOAD type: 00 (ISAKMP_PAYLOAD_NONE)
   DONE PARSING PAYLOAD type: 02 (ISAKMP_PAYLOAD_P)

   PARSING PAYLOAD type: 00 (ISAKMP_PAYLOAD_NONE)
   DONE PARSING PAYLOAD type: 01 (ISAKMP_PAYLOAD_SA)

   PARSING PAYLOAD type: 04 (ISAKMP_PAYLOAD_KE)
   next_type: 0a (ISAKMP_PAYLOAD_NONCE)
   length: 0000
   ke.data:
   c50f43d5 6de1141c 539854a0 5ae54073 24f75516 ca5c0d57 6fd0af72 4cc80327
   e9635bfc c72b2b4e 7158a46c ef740f60 175bfe33 1bb80b97 89a9ce46 fff0703d
   dc6ee465 fa7ff165 42443ab9 41fb381c 45257ff8 b1348508 c0eed738 0bee836d
   a3e3dc53 4b75c953 222dbddc b124bd0f ff1ebc33 dce9ccba 8292f4ac 522b5eb1
   DONE PARSING PAYLOAD type: 04 (ISAKMP_PAYLOAD_KE)

   PARSING PAYLOAD type: 0a (ISAKMP_PAYLOAD_NONCE)
   next_type: 05 (ISAKMP_PAYLOAD_ID)
   length: 0000
   ke.data: 239f52c9 aee20e51 ce4a17a9 608f847e
   DONE PARSING PAYLOAD type: 0a (ISAKMP_PAYLOAD_NONCE)

   PARSING PAYLOAD type: 05 (ISAKMP_PAYLOAD_ID)
   next_type: 08 (ISAKMP_PAYLOAD_HASH)
   length: 0000
   id.type: 01 (ISAKMP_IPSEC_ID_IPV4_ADDR)
   id.protocol: 00
   id.port: 0000
   id.data: 5ddc204d
   DONE PARSING PAYLOAD type: 05 (ISAKMP_PAYLOAD_ID)

   PARSING PAYLOAD type: 08 (ISAKMP_PAYLOAD_HASH)
   next_type: 0b (ISAKMP_PAYLOAD_N)
   length: 0000
   ke.data:
   abe46b4b f436238d 64f8d107 746a903e eaf93c43
   DONE PARSING PAYLOAD type: 08 (ISAKMP_PAYLOAD_HASH)

   PARSING PAYLOAD type: 0b (ISAKMP_PAYLOAD_N)
   next_type: 0d (ISAKMP_PAYLOAD_VID)
   length: 0000
   n.doi: 00000001 (ISAKMP_DOI_IPSEC)
   n.protocol: 01 (ISAKMP_IPSEC_PROTO_ISAKMP)
   n.spi_length: 10
   n.type: 6000 (ISAKMP_N_IPSEC_RESPONDER_LIFETIME)
   n.spi: aa749a3c 5de5e083 a1ee487d 5b908741
   n.data: 800b0001 800c0e10
   t.attributes.type: 000b (IKE_ATTRIB_LIFE_TYPE)
   t.attributes.u.attr_16: 0001 (IKE_LIFE_TYPE_SECONDS)
   t.attributes.type: 000c (IKE_ATTRIB_LIFE_DURATION)
   t.attributes.u.attr_16: 0e10
   DONE PARSING PAYLOAD type: 0b (ISAKMP_PAYLOAD_N)

   PARSING PAYLOAD type: 0d (ISAKMP_PAYLOAD_VID)
   next_type: 0d (ISAKMP_PAYLOAD_VID)
   length: 0000
   ke.data: 09002689 dfd6b712
   (Xauth)
   DONE PARSING PAYLOAD type: 0d (ISAKMP_PAYLOAD_VID)

   PARSING PAYLOAD type: 0d (ISAKMP_PAYLOAD_VID)
   next_type: 00 (ISAKMP_PAYLOAD_NONE)
   length: 0000
   ke.data: afcad713 68a1f1c9 6b8696fc 77570100
   (DPD)
   DONE PARSING PAYLOAD type: 0d (ISAKMP_PAYLOAD_VID)

   PARSING PAYLOAD type: 00 (ISAKMP_PAYLOAD_NONE)
   PARSE_OK
vpnc: vpnc.c: 1164: lifetime_ike_process: Assertion `0&#039; failed.
Aborted
root@OpenWrt:~#</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p147560">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">Orca</div>
					<div class="post-datetime">
						4 Nov 2011, 11:23					</div>
				</div>
				<div class="post-content content">
					<p>If the vpnc from the oldwiki does not help, maybe somebody want to migrate it or write an entirely new one. :-O</p><p>Arokh, what&#039;s the point in writing howtos into a forum, where only the poster himself can modify/mend/update them, once they become outdated?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p147707">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">birnenschnitzel</div>
					<div class="post-datetime">
						5 Nov 2011, 20:09					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>maybe I&#039;m totally wrong but the following article should explain a solution to your situation in detail. OpenWrt-&gt;Central Site Gateway. <a href="http://wiki.openwrt.org/doc/howto/vpn.ipsec.site2site">http://wiki.openwrt.org/doc/howto/vpn.ipsec.site2site</a> </p><p>Best regards.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>