<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> showmacs option not available for the brctl command of the bridge</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 16 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p79407">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">davide_lenza</div>
					<div class="post-datetime">
						10 Jan 2009, 13:13					</div>
				</div>
				<div class="post-content content">
					<p>showmacs option not available for the brctl command of the bridge</p><p>I have downloaded the trunk 13899.</p><p>Any idea?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p79491">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">davide_lenza</div>
					<div class="post-datetime">
						11 Jan 2009, 21:38					</div>
				</div>
				<div class="post-content content">
					<p>Showmacs is not available with the brctl provided by the busybox<br />The brctl shuld be removed from the busybox and the brctl provided by the package &quot;bridge&quot; should be used<br />Davide</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p357503">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">vamsireddy.16</div>
					<div class="post-datetime">
						1 May 2017, 19:57					</div>
				</div>
				<div class="post-content content">
					<p>Hi</p><p>I used the bridge package available under network utilities in make menuconfig. brctl is not shwoing up. </p><p>brctl which is avaible in busybox is working as expected, the bridge is configured, but it doesn&#039;t forward any packets.</p><p>I am using the lastest OpenWrt verison with 4.4.14 linux kernel version. </p><p>Please see the brctl show result.</p><p>brctl show</p><p>bridge name&nbsp; &nbsp; &nbsp;bridge id&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;STP enabled&nbsp; &nbsp; &nbsp;interfaces<br />br-lan&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 7fff.0008a209f763&nbsp; &nbsp; &nbsp; &nbsp;no&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eth0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; wlan0</p><p>I can ping the br-lan from a host pc connected using an ethernet wire, but unable to ping eth0 and wlan0. </p><p>Please tell me how to reslove this issue.</p><p>I disabled the Firewall, still it didn&#039;t work as expected. </p><br /><p>Thanks<br />Vamsi</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p357505">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">mk24</div>
					<div class="post-datetime">
						1 May 2017, 20:26					</div>
				</div>
				<div class="post-content content">
					<p>&quot;Ping wlan0&quot; makes no sense.&nbsp; You would ping a device that is connected to wlan0.&nbsp; You should be able to do that from a device on Ethernet, from inside the router, or from another wifi device, because they&#039;re all bridged together.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p357509">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">vamsireddy.16</div>
					<div class="post-datetime">
						1 May 2017, 20:48					</div>
				</div>
				<div class="post-content content">
					<p>What I mean is a device connected to a wlan0 interface, but instead of going to that point, I want to do a basic testing to check the bridge configuration is working or not, so I tried to ping the eth0 interface from a host pc which is connected using an ethernet wire (interfaces are all in the same subnet). The PC couldn&#039;t able to reach to the eth0 interface, but it can reach the Br-lan interface. I hope you got it, what I am trying to do.</p><p>&nbsp; &nbsp; &nbsp; &nbsp; ethernet<br />PC ---------------&gt;OpenWrt(MinnowBoard turbot).<br />&nbsp; </p><p>ifconfig<br />br-lan&nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 00:08:A2:09:F7:63<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:192.168.3.1&nbsp; Bcast:192.168.3.255&nbsp; Mask:255.255.255.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: fda1:1333:71fb::1/60 Scope:Global<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: fe80::208:a2ff:fe09:f763/64 Scope:Link<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:1220 errors:0 dropped:72 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:101 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:95412 (93.1 KiB)&nbsp; TX bytes:11362 (11.0 KiB)</p><p>eth0&nbsp; &nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 00:08:A2:09:F7:63<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:192.168.3.10&nbsp; Bcast:192.168.3.255&nbsp; Mask:255.255.255.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING PROMISC MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:75582 errors:0 dropped:5 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:11269 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:9900135 (9.4 MiB)&nbsp; TX bytes:1543904 (1.4 MiB)</p><p>lo&nbsp; &nbsp; &nbsp; &nbsp; Link encap:Local Loopback<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:127.0.0.1&nbsp; Mask:255.0.0.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: ::1/128 Scope:Host<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP LOOPBACK RUNNING&nbsp; MTU:65536&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:118 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:118 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:11820 (11.5 KiB)&nbsp; TX bytes:11820 (11.5 KiB)</p><p>wlan0&nbsp; &nbsp; &nbsp;Link encap:Ethernet&nbsp; HWaddr 00:03:7F:87:86:69<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: fe80::203:7fff:fe87:8669/64 Scope:Link<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:1166 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:0 (0.0 B)&nbsp; TX bytes:127392 (124.4 KiB)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p357526">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">mk24</div>
					<div class="post-datetime">
						1 May 2017, 23:20					</div>
				</div>
				<div class="post-content content">
					<p>The interfaces that are in a bridge should <em>not</em> have their own IP addresses.&nbsp; The IP(s) are attached the br-lan itself. Anything that comes into br-lan will automatically go out eth0 or wlan0 or both depending on the internally collected MAC address table.&nbsp; It works a lot like an unmanaged Ethernet switch -- just turn it on there is no need to explicitly configure, it just works.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p357652">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">vamsireddy.16</div>
					<div class="post-datetime">
						2 May 2017, 22:25					</div>
				</div>
				<div class="post-content content">
					<p>Thank you for the reply <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />.<br />I know that we shouldn&#039;t assign IP addresses to the bridge interfaces, I only did that for testing. There is no point to do a ping test to the device connected to the wlan0 interface if the bridge fails to forward the packet from the wired interface to the internal bridge interface (In my case, from br-lan to eth0, I did ping from a host PC). <br />I know how a bridge or a switch works, the issue here is the bridge is not forwarding the packets, I know it will forward to one of the egress ports based on the rules&nbsp; (MAC or any other tables).&nbsp; The brctl utils doesn&#039;t have showmac option to cross verify the MAC address in tables collected based on ARP or using the other protocol, I am using the busy box brctl package. <br />The bridge is not working as expected, I want to know whether I have to do anything special in OpenWrt to make the bridge working.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p357653">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">mk24</div>
					<div class="post-datetime">
						2 May 2017, 22:36					</div>
				</div>
				<div class="post-content content">
					<p>You don&#039;t have to do anything special.&nbsp; &nbsp;The brctl show shows a regular bridge.&nbsp; The ifconfig status shows no data received on wlan0, perhaps there is a wifi configuration problem.</p><p>The only reference you should have to eth0 anywhere in your configs is to put it in the LAN bridge in /etc/config/network.<br /></p><div class="codebox"><pre><code>config interface &#039;lan&#039;
    option type &#039;bridge&#039;
    option ifname &#039;eth0&#039;
        option proto &#039;static&#039;
...</code></pre></div><p>Then in the /etc/config/wireless connect the AP to the lan as well<br /></p><div class="codebox"><pre><code>config wifi-iface
        option mode &#039;ap&#039;
        option device &#039;radio0&#039;
        option network &#039;lan&#039;
...</code></pre></div><p>The IP address you put in the lan config will apply to both eth0 and wlan0.&nbsp; The handle to a bridge is the br-lan device.&nbsp; </p><p>When &quot;slaves&quot; of a bridge, the hardware interfaces become mere media converters that take a packet and copy it over.&nbsp; They are no longer independent things that can have an IP address or respond to a ping.</p>											<p class="post-edited">(Last edited by <strong>mk24</strong> on 2 May 2017, 22:42)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p357747">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">cvmiller</div>
					<div class="post-datetime">
						4 May 2017, 04:14					</div>
				</div>
				<div class="post-content content">
					<p>If you want to see the MAC addresses on each port of the bridge (which is what showmacs does). Check out this shell function:</p><p><a href="https://pastebin.com/8JWX5ETx">https://pastebin.com/8JWX5ETx</a></p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>