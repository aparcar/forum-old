<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> How to turn off all LEDs on AR8327N switch (WDR3600/43x0, 1043NDv2)</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 21 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p222186">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">pepe2k</div>
					<div class="post-datetime">
						9 Jan 2014, 17:54					</div>
				</div>
				<div class="post-content content">
					<p>I made a solution:<br /><a href="https://gist.github.com/pepe2k/8327121">https://gist.github.com/pepe2k/8327121</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p222578">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">ramponis</div>
					<div class="post-datetime">
						13 Jan 2014, 16:14					</div>
				</div>
				<div class="post-content content">
					<p>Thank you pepe2k<br />Your patch is very usefull.<br />i will use it to turn-off all the leds before the night.<br />Then power them again in the morning.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p222582">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">pepe2k</div>
					<div class="post-datetime">
						13 Jan 2014, 16:36					</div>
				</div>
				<div class="post-content content">
					<p>It&#039;s nice to hear that someone found it useful! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p222659">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">eeff11</div>
					<div class="post-datetime">
						14 Jan 2014, 06:15					</div>
				</div>
				<div class="post-content content">
					<p>Good patch, pepe2k. Good work after UBOOT.</p><p>I wonder what can I do to turn off all the lights in a UBNT rocket m2 flashed with openwrt. Little info.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p222675">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">ramponis</div>
					<div class="post-datetime">
						14 Jan 2014, 11:03					</div>
				</div>
				<div class="post-content content">
					<p>Hi pepe2k,</p><p>I have applied you patch file to my r39211 sources<br />I have rebuilt swconfig utility.<br />Then i have upgraded the package in my WDR3600<br />But when i try the command:&nbsp; swconfig dev switch0 set disable_all_leds 1<br />i receive the error:</p><p>Unknown attribute &quot;disable_all_leds&quot;</p><p>What&#039;s wrong?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p222681">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">pepe2k</div>
					<div class="post-datetime">
						14 Jan 2014, 12:08					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>ramponis wrote:</cite><blockquote><p>Hi pepe2k,</p><p>I have applied you patch file to my r39211 sources<br />I have rebuilt swconfig utility.<br />Then i have upgraded the package in my WDR3600<br />But when i try the command:&nbsp; swconfig dev switch0 set disable_all_leds 1<br />i receive the error:</p><p>Unknown attribute &quot;disable_all_leds&quot;</p><p>What&#039;s wrong?</p></blockquote></div><p>You need to rebuild and upgrade whole image.<br />This functionality is inside AR8216 driver.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p222688">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">ramponis</div>
					<div class="post-datetime">
						14 Jan 2014, 13:45					</div>
				</div>
				<div class="post-content content">
					<p>Done, now it works!</p><p>Thank you</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p222697">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">ramponis</div>
					<div class="post-datetime">
						14 Jan 2014, 15:50					</div>
				</div>
				<div class="post-content content">
					<p>Hi pepe2k,</p><p>Your patch works good, but it turns off the ethernet leds.<br />I want ask you if it possible also to turn-off the other leds: wi-fi, power and system.<br />I would like to have ALL leds off during the night.</p><p>Thank you</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p222702">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">pepe2k</div>
					<div class="post-datetime">
						14 Jan 2014, 16:02					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>ramponis wrote:</cite><blockquote><p>Hi pepe2k,</p><p>Your patch works good, but it turns off the ethernet leds.</p></blockquote></div><p>Let me quote myself:</p><p>&quot;This patch adds an option in swconfig which allows to disable all leds in AR8327N switch [...]&quot;.</p><div class="quotebox"><cite>ramponis wrote:</cite><blockquote><p>I want ask you if it possible also to turn-off the other leds: wi-fi, power and system.<br />I would like to have ALL leds off during the night.</p></blockquote></div><p>In most cases (including TL-WDR3600), there is no way to turn off the power LED using software. It&#039;s connected directly to some of the power supply lines.</p><p>For other LEDs (Wi-Fi, system, etc.), use uncle Google or OpenWrt Wiki <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p222713">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">ramponis</div>
					<div class="post-datetime">
						14 Jan 2014, 16:55					</div>
				</div>
				<div class="post-content content">
					<p>Found solution:</p><p>This is my script:</p><div class="codebox"><pre><code>SwitchMode=$1 #on/off
if [ &quot;$SwitchMode&quot; == &quot;on&quot; ]; then
    logger leds turning on
    leds=&quot;0&quot;
    brightness=&quot;255&quot;
else
    logger leds turning off
    leds=&quot;1&quot;
    brightness=&quot;0&quot;
fi
swconfig dev switch0 set disable_all_leds $leds
echo $brightness &gt; /sys/class/leds/tp-link\:blue\:system/brightness
echo $brightness &gt; /sys/class/leds/tp-link:green:usb1/brightness
echo $brightness &gt; /sys/class/leds/tp-link:green:usb1/brightness
echo $brightness &gt; /sys/class/leds/tp-link:blue:wlan2g/brightness
echo $brightness &gt; /sys/class/leds/ath9k-phy1/brightness</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p222751">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">zloop</div>
					<div class="post-datetime">
						14 Jan 2014, 22:57					</div>
				</div>
				<div class="post-content content">
					<p>great patch - great work pepe2k! </p><p>I tested it on an TP-Link Archer C7 and it works (it has a 8327N switch, too)</p><p>one minor issue:<br />I get a warning about line 78 when I do &quot;git am &lt; (patch)&quot; <br />There seems to be a whitespace before the TAB <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>Is it possible to have the patch sent to the mailing list so it will be integrated into OpenWrt trunk please ? (basically sent the patch inline with a Sign-off , according to <a href="https://dev.openwrt.org/wiki/SubmittingPatches">https://dev.openwrt.org/wiki/SubmittingPatches</a> )</p><p>&quot;Night Mode&quot; / deactivate all LEDS would be nice to have in the UI <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p222753">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">pepe2k</div>
					<div class="post-datetime">
						14 Jan 2014, 23:13					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>zloop wrote:</cite><blockquote><p>one minor issue:<br />I get a warning about line 78 when I do &quot;git am &lt; (patch)&quot; <br />There seems to be a whitespace before the TAB <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p></blockquote></div><p>OK, thanks, i see it.</p><div class="quotebox"><cite>zloop wrote:</cite><blockquote><p>Is it possible to have the patch sent to the mailing list so it will be integrated into OpenWrt trunk please ? (basically sent the patch inline with a Sign-off , according to <a href="https://dev.openwrt.org/wiki/SubmittingPatches">https://dev.openwrt.org/wiki/SubmittingPatches</a> )</p><p>&quot;Night Mode&quot; / deactivate all LEDS would be nice to have in the UI <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></blockquote></div><p>I will correct it, add missing definitions (at this time, I&#039;m using magic values <img src="https://forum.openwrt.org/img/smilies/tongue.png" width="15" height="15" alt="tongue" />) and send it to the dev ml.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p222786">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">eeff11</div>
					<div class="post-datetime">
						15 Jan 2014, 08:21					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>ramponis wrote:</cite><blockquote><p>Found solution:</p><p>This is my script:</p><div class="codebox"><pre><code>SwitchMode=$1 #on/off
if [ &quot;$SwitchMode&quot; == &quot;on&quot; ]; then
    logger leds turning on
    leds=&quot;0&quot;
    brightness=&quot;255&quot;
else
    logger leds turning off
    leds=&quot;1&quot;
    brightness=&quot;0&quot;
fi
swconfig dev switch0 set disable_all_leds $leds
echo $brightness &gt; /sys/class/leds/tp-link\:blue\:system/brightness
echo $brightness &gt; /sys/class/leds/tp-link:green:usb1/brightness
echo $brightness &gt; /sys/class/leds/tp-link:green:usb1/brightness
echo $brightness &gt; /sys/class/leds/tp-link:blue:wlan2g/brightness
echo $brightness &gt; /sys/class/leds/ath9k-phy1/brightness</code></pre></div></blockquote></div><p>Can this script could be further improved by setting time, say 23:00-08:00, LEDs are off, 08:01-22:59, LEDs are on?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p222797">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">eximido</div>
					<div class="post-datetime">
						15 Jan 2014, 10:50					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>eeff11 wrote:</cite><blockquote><p>Can this script could be further improved by setting time, say 23:00-08:00, LEDs are off, 08:01-22:59, LEDs are on?</p></blockquote></div><p>Just add two crontab jobs to run this script with &quot;on&quot; argument at 08:00 and with &quot;off&quot; argument at 23:00.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p223299">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">pepe2k</div>
					<div class="post-datetime">
						20 Jan 2014, 23:06					</div>
				</div>
				<div class="post-content content">
					<p>Today couple of patches, related with LEDs in AR8327 switch, were added (take a look at this changeset: <a href="https://dev.openwrt.org/changeset/39338">https://dev.openwrt.org/changeset/39338</a>).</p><p>So, my solution isn&#039;t needed anymore, you may control all switch LEDs using /sys/class/leds/.<br />For example, to turn off WAN LED in WDR3600/4300:</p><div class="codebox"><pre><code>echo 0 &gt; /sys/class/leds/tp-link\:blue\:wan/brightness</code></pre></div><p>You can now even use those LEDs with various system events (using trigger option).</p><p>So, enjoy and give thanks to the developer/s! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p223345">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">eximido</div>
					<div class="post-datetime">
						21 Jan 2014, 09:10					</div>
				</div>
				<div class="post-content content">
					<p>Your patch is still needed for TP-Link WDR4900, for example.<br />Those patches in trunk include support for ar71xx-based devices, ppc85xx-based WDR4900 isn&#039;t included.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p223356">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">pepe2k</div>
					<div class="post-datetime">
						21 Jan 2014, 11:40					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>eximido wrote:</cite><blockquote><p>Your patch is still needed for TP-Link WDR4900, for example.<br />Those patches in trunk include support for ar71xx-based devices, ppc85xx-based WDR4900 isn&#039;t included.</p></blockquote></div><p>Yes, you&#039;re right.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p304183">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">don.nasco</div>
					<div class="post-datetime">
						19 Dec 2015, 00:34					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>pepe2k wrote:</cite><blockquote><div class="quotebox"><cite>eximido wrote:</cite><blockquote><p>Your patch is still needed for TP-Link WDR4900, for example.<br />Those patches in trunk include support for ar71xx-based devices, ppc85xx-based WDR4900 isn&#039;t included.</p></blockquote></div><p>Yes, you&#039;re right.</p></blockquote></div><p>As it was mentioned WDR4900 also has Atheros AR8327<br />root@client:~# dmesg | grep AR8327<br />[&nbsp; &nbsp; 1.352498] switch0: Atheros AR8327 rev. 2 switch registered on mdio@ffe24000</p><p>What is needed to port <a href="https://dev.openwrt.org/changeset/39338">https://dev.openwrt.org/changeset/39338</a> so WDR4900 can use it?<br />Thanks!</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>