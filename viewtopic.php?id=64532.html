<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> NetGear DGND3700 OpenVPN Inactivity timeout (--ping-restart)</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 21 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p321860">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">osara</div>
					<div class="post-datetime">
						29 Apr 2016, 22:05					</div>
				</div>
				<div class="post-content content">
					<p>Hello. I have problem with connect OpenVpn Client. Restart Open VPNclient for 10 sec.&nbsp; <br />____________________________________________________________________________________________<br />openvpn.log</p><p>Fri Apr 29 18:52:30 2016 OpenVPN 2.3.6 mips-openwrt-linux-gnu [SSL (PolarSSL)] [LZO] [EPOLL] [MH] [IPv6] built on Jul 24 2015<br />Fri Apr 29 18:52:30 2016 library versions: PolarSSL 1.3.11, LZO 2.08<br />Fri Apr 29 18:52:30 2016 WARNING: file &#039;/etc/openvpn/userpass.txt&#039; is group or others accessible<br />Fri Apr 29 18:52:30 2016 Socket Buffers: R=[87380-&gt;131072] S=[16384-&gt;131072]<br />Fri Apr 29 18:52:30 2016 Attempting to establish TCP connection with [AF_INET]212.53.40.182:1194 [nonblock]<br />Fri Apr 29 18:52:31 2016 TCP connection established with [AF_INET]212.53.40.182:1194<br />Fri Apr 29 18:52:31 2016 TCPv4_CLIENT link local: [undef]<br />Fri Apr 29 18:52:31 2016 TCPv4_CLIENT link remote: [AF_INET]212.53.40.182:1194<br />Fri Apr 29 18:52:31 2016 TLS: Initial packet from [AF_INET]212.53.40.182:1194, sid=788c8f2c 52cbda36<br />Fri Apr 29 18:52:31 2016 WARNING: this configuration may cache passwords in memory -- use the auth-nocache option to prevent this<br />Fri Apr 29 18:52:31 2016 VERIFY OK: depth=2, C=US, O=thawte, Inc., OU=Certification Services Division, OU=(c) 2006 thawte, Inc. - For authorized use only, CN=thawte Primary Root CA<br />Fri Apr 29 18:52:32 2016 VERIFY OK: depth=1, C=US, O=Thawte, Inc., CN=Thawte SSL CA<br />Fri Apr 29 18:52:32 2016 Validating certificate key usage<br />Fri Apr 29 18:52:32 2016 ++ Certificate has key usage&nbsp; 00a0, expects 00a0<br />Fri Apr 29 18:52:32 2016 VERIFY KU OK<br />Fri Apr 29 18:52:32 2016 Validating certificate extended key usage<br />Fri Apr 29 18:52:32 2016 ++ Certificate has EKU (str) TLS Web Server Authentication, expects TLS Web Server Authentication<br />Fri Apr 29 18:52:32 2016 VERIFY EKU OK<br />Fri Apr 29 18:52:32 2016 VERIFY OK: depth=0, C=CZ, ST=Karlavy Vary, L=Karlavy Vary, O=SIPNET eu s.r.o., OU=ISP, CN=*.sipnet.ru<br />Fri Apr 29 18:52:32 2016 Data Channel Encrypt: Cipher &#039;AES-128-CBC&#039; initialized with 128 bit key<br />Fri Apr 29 18:52:32 2016 Data Channel Encrypt: Using 160 bit message hash &#039;SHA1&#039; for HMAC authentication<br />Fri Apr 29 18:52:32 2016 Data Channel Decrypt: Cipher &#039;AES-128-CBC&#039; initialized with 128 bit key<br />Fri Apr 29 18:52:32 2016 Data Channel Decrypt: Using 160 bit message hash &#039;SHA1&#039; for HMAC authentication<br />Fri Apr 29 18:52:32 2016 Control Channel: TLSv1.0, cipher TLS-DHE-RSA-WITH-AES-256-CBC-SHA, 2048 bit RSA<br />Fri Apr 29 18:52:32 2016 [*.sipnet.ru] Peer Connection Initiated with [AF_INET]212.53.40.182:1194<br />Fri Apr 29 18:52:34 2016 SENT CONTROL [*.sipnet.ru]: &#039;PUSH_REQUEST&#039; (status=1)<br />Fri Apr 29 18:52:35 2016 PUSH: Received control message: &#039;PUSH_REPLY,ping 3,ping-restart 10,ifconfig 172.16.83.17 172.16.83.18,route 212.53.40.0 255.255.255.128 vpn_gateway&#039;<br />Fri Apr 29 18:52:35 2016 OPTIONS IMPORT: timers and/or timeouts modified<br />Fri Apr 29 18:52:35 2016 OPTIONS IMPORT: --ifconfig/up options modified<br />Fri Apr 29 18:52:35 2016 OPTIONS IMPORT: route options modified<br />Fri Apr 29 18:52:35 2016 TUN/TAP device tun0 opened<br />Fri Apr 29 18:52:35 2016 TUN/TAP TX queue length set to 100<br />Fri Apr 29 18:52:35 2016 do_ifconfig, tt-&gt;ipv6=0, tt-&gt;did_ifconfig_ipv6_setup=0<br />Fri Apr 29 18:52:35 2016 /sbin/ifconfig tun0 172.16.83.17 pointopoint 172.16.83.18 mtu 1500<br />Fri Apr 29 18:52:35 2016 /sbin/route add -net 212.53.40.0 netmask 255.255.255.128 gw 172.16.83.18<br />Fri Apr 29 18:52:35 2016 Initialization Sequence Completed<br /><strong>Fri Apr 29 18:52:45 2016 [*.sipnet.ru] Inactivity timeout (--ping-restart), restarting<br />Fri Apr 29 18:52:45 2016 SIGUSR1[soft,ping-restart] received, process restarting<br />Fri Apr 29 18:52:45 2016 Restart pause, 5 second(s)</strong><br />____________________________________________________________________________________________</p><p>openvpn.config</p><p>config openvpn &#039;VPN&#039;<br />&nbsp; &nbsp; option client &#039;1&#039;<br />&nbsp; &nbsp; option comp_lzo &#039;yes&#039;<br />&nbsp; &nbsp; option reneg_sec &#039;0&#039;<br />&nbsp; &nbsp; option verb &#039;3&#039;<br />&nbsp; &nbsp; option persist_key &#039;1&#039;<br />&nbsp; &nbsp; option nobind &#039;1&#039;<br />&nbsp; &nbsp; option remote_cert_tls &#039;server&#039;<br />&nbsp; &nbsp; option remote &#039;vpn.sipnet.ru&#039;<br />&nbsp; &nbsp; option auth_user_pass &#039;/etc/openvpn/userpass.txt&#039;<br />&nbsp; &nbsp; option dev &#039;tun&#039;<br />&nbsp; &nbsp; option cipher &#039;AES-128-CBC&#039;<br />&nbsp; &nbsp; option auth &#039;SHA1&#039;<br />&nbsp; &nbsp; option persist_tun &#039;1&#039;<br />&nbsp; &nbsp; option port &#039;1194&#039;<br />&nbsp; &nbsp; option log &#039;/var/log/openvpn.log&#039;<br />&nbsp; &nbsp; option log_append &#039;/var/log/openvpn.log&#039;<br />&nbsp; &nbsp; option ca &#039;/lib/uci/upload/cbid.openvpn.test.ca&#039;<br />&nbsp; &nbsp; option proto &#039;udp&#039;<br />&nbsp; &nbsp; option enabled &#039;1&#039;<br />____________________________________________________________________________________________</p><p>Firewall.config</p><br /><p>config defaults<br />&nbsp; &nbsp; option syn_flood &#039;1&#039;<br />&nbsp; &nbsp; option input &#039;ACCEPT&#039;<br />&nbsp; &nbsp; option output &#039;ACCEPT&#039;<br />&nbsp; &nbsp; option forward &#039;REJECT&#039;</p><p>config zone<br />&nbsp; &nbsp; option name &#039;lan&#039;<br />&nbsp; &nbsp; option input &#039;ACCEPT&#039;<br />&nbsp; &nbsp; option output &#039;ACCEPT&#039;<br />&nbsp; &nbsp; option forward &#039;ACCEPT&#039;<br />&nbsp; &nbsp; option network &#039;lan&#039;</p><p>config zone<br />&nbsp; &nbsp; option name &#039;wan&#039;<br />&nbsp; &nbsp; option input &#039;REJECT&#039;<br />&nbsp; &nbsp; option masq &#039;1&#039;<br />&nbsp; &nbsp; option mtu_fix &#039;1&#039;<br />&nbsp; &nbsp; option network &#039;VPN wan wan6&#039;<br />&nbsp; &nbsp; option forward &#039;REJECT&#039;<br />&nbsp; &nbsp; option output &#039;ACCEPT&#039;</p><p>config rule<br />&nbsp; &nbsp; option name &#039;Allow-DHCP-Renew&#039;<br />&nbsp; &nbsp; option src &#039;wan&#039;<br />&nbsp; &nbsp; option proto &#039;udp&#039;<br />&nbsp; &nbsp; option dest_port &#039;68&#039;<br />&nbsp; &nbsp; option target &#039;ACCEPT&#039;<br />&nbsp; &nbsp; option family &#039;ipv4&#039;</p><p>config rule<br />&nbsp; &nbsp; option name &#039;Allow-Ping&#039;<br />&nbsp; &nbsp; option src &#039;wan&#039;<br />&nbsp; &nbsp; option proto &#039;icmp&#039;<br />&nbsp; &nbsp; option icmp_type &#039;echo-request&#039;<br />&nbsp; &nbsp; option family &#039;ipv4&#039;<br />&nbsp; &nbsp; option target &#039;ACCEPT&#039;</p><p>config rule<br />&nbsp; &nbsp; option name &#039;Allow-IGMP&#039;<br />&nbsp; &nbsp; option src &#039;wan&#039;<br />&nbsp; &nbsp; option proto &#039;igmp&#039;<br />&nbsp; &nbsp; option family &#039;ipv4&#039;<br />&nbsp; &nbsp; option target &#039;ACCEPT&#039;</p><p>config rule<br />&nbsp; &nbsp; option name &#039;Allow-DHCPv6&#039;<br />&nbsp; &nbsp; option src &#039;wan&#039;<br />&nbsp; &nbsp; option proto &#039;udp&#039;<br />&nbsp; &nbsp; option src_ip &#039;fe80::/10&#039;<br />&nbsp; &nbsp; option src_port &#039;547&#039;<br />&nbsp; &nbsp; option dest_ip &#039;fe80::/10&#039;<br />&nbsp; &nbsp; option dest_port &#039;546&#039;<br />&nbsp; &nbsp; option family &#039;ipv6&#039;<br />&nbsp; &nbsp; option target &#039;ACCEPT&#039;</p><p>config rule<br />&nbsp; &nbsp; option name &#039;Allow-MLD&#039;<br />&nbsp; &nbsp; option src &#039;wan&#039;<br />&nbsp; &nbsp; option proto &#039;icmp&#039;<br />&nbsp; &nbsp; option src_ip &#039;fe80::/10&#039;<br />&nbsp; &nbsp; list icmp_type &#039;130/0&#039;<br />&nbsp; &nbsp; list icmp_type &#039;131/0&#039;<br />&nbsp; &nbsp; list icmp_type &#039;132/0&#039;<br />&nbsp; &nbsp; list icmp_type &#039;143/0&#039;<br />&nbsp; &nbsp; option family &#039;ipv6&#039;<br />&nbsp; &nbsp; option target &#039;ACCEPT&#039;</p><p>config rule<br />&nbsp; &nbsp; option name &#039;Allow-ICMPv6-Input&#039;<br />&nbsp; &nbsp; option src &#039;wan&#039;<br />&nbsp; &nbsp; option proto &#039;icmp&#039;<br />&nbsp; &nbsp; list icmp_type &#039;echo-request&#039;<br />&nbsp; &nbsp; list icmp_type &#039;echo-reply&#039;<br />&nbsp; &nbsp; list icmp_type &#039;destination-unreachable&#039;<br />&nbsp; &nbsp; list icmp_type &#039;packet-too-big&#039;<br />&nbsp; &nbsp; list icmp_type &#039;time-exceeded&#039;<br />&nbsp; &nbsp; list icmp_type &#039;bad-header&#039;<br />&nbsp; &nbsp; list icmp_type &#039;unknown-header-type&#039;<br />&nbsp; &nbsp; list icmp_type &#039;router-solicitation&#039;<br />&nbsp; &nbsp; list icmp_type &#039;neighbour-solicitation&#039;<br />&nbsp; &nbsp; list icmp_type &#039;router-advertisement&#039;<br />&nbsp; &nbsp; list icmp_type &#039;neighbour-advertisement&#039;<br />&nbsp; &nbsp; option limit &#039;1000/sec&#039;<br />&nbsp; &nbsp; option family &#039;ipv6&#039;<br />&nbsp; &nbsp; option target &#039;ACCEPT&#039;</p><p>config rule<br />&nbsp; &nbsp; option name &#039;Allow-ICMPv6-Forward&#039;<br />&nbsp; &nbsp; option src &#039;wan&#039;<br />&nbsp; &nbsp; option dest &#039;*&#039;<br />&nbsp; &nbsp; option proto &#039;icmp&#039;<br />&nbsp; &nbsp; list icmp_type &#039;echo-request&#039;<br />&nbsp; &nbsp; list icmp_type &#039;echo-reply&#039;<br />&nbsp; &nbsp; list icmp_type &#039;destination-unreachable&#039;<br />&nbsp; &nbsp; list icmp_type &#039;packet-too-big&#039;<br />&nbsp; &nbsp; list icmp_type &#039;time-exceeded&#039;<br />&nbsp; &nbsp; list icmp_type &#039;bad-header&#039;<br />&nbsp; &nbsp; list icmp_type &#039;unknown-header-type&#039;<br />&nbsp; &nbsp; option limit &#039;1000/sec&#039;<br />&nbsp; &nbsp; option family &#039;ipv6&#039;<br />&nbsp; &nbsp; option target &#039;ACCEPT&#039;</p><p>config include<br />&nbsp; &nbsp; option path &#039;/etc/firewall.user&#039;</p><p>config rule<br />&nbsp; &nbsp; option src &#039;wan&#039;<br />&nbsp; &nbsp; option dest &#039;lan&#039;<br />&nbsp; &nbsp; option proto &#039;esp&#039;<br />&nbsp; &nbsp; option target &#039;ACCEPT&#039;</p><p>config rule<br />&nbsp; &nbsp; option src &#039;wan&#039;<br />&nbsp; &nbsp; option dest &#039;lan&#039;<br />&nbsp; &nbsp; option dest_port &#039;500&#039;<br />&nbsp; &nbsp; option proto &#039;udp&#039;<br />&nbsp; &nbsp; option target &#039;ACCEPT&#039;</p><p>config forwarding<br />&nbsp; &nbsp; option dest &#039;wan&#039;<br />&nbsp; &nbsp; option src &#039;lan&#039;</p><p><em><strong>I understand that fails to ping the server, this is restarted. How do I resolve this problem?</strong></em></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p321917">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">osara</div>
					<div class="post-datetime">
						30 Apr 2016, 09:25					</div>
				</div>
				<div class="post-content content">
					<p>u</p>											<p class="post-edited">(Last edited by <strong>osara</strong> on 30 Apr 2016, 20:50)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p322741">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">osara</div>
					<div class="post-datetime">
						6 May 2016, 13:52					</div>
				</div>
				<div class="post-content content">
					<p>up</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>