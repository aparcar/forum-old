<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> I need help</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 14 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p97167">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">sangul</div>
					<div class="post-datetime">
						10 Nov 2009, 22:16					</div>
				</div>
				<div class="post-content content">
					<p>Hi,<br />i have a wrt54gs router and kamikaze 8.09 installed.<br />I have a problem with open vpn, if i want to connect to swissvpn it displays a error:</p><p>root@OpenWrt:~# openvpn --cd /etc/openvpn --config swissvpn.ovpn<br />Tue Nov 10 20:53:11 2009 OpenVPN 2.0.9 mipsel-linux [SSL] [LZO] built on Feb&nbsp; 2 2009<br />Enter Auth Username:swissvpntest<br />Enter Auth Password:<br />Tue Nov 10 20:53:18 2009 IMPORTANT: OpenVPN&#039;s default port number is now 1194, based on an official port number assignment by IANA.&nbsp; OpenVPN 2.0-beta16 and earlier used 5000 as the default port.<br />Tue Nov 10 20:53:18 2009 WARNING: No server certificate verification method has been enabled.&nbsp; See <a href="http://openvpn.net/howto.html#mitm">http://openvpn.net/howto.html#mitm</a> for more info.<br />Tue Nov 10 20:53:18 2009 Attempting to establish TCP connection with 80.254.79.87:443<br />Tue Nov 10 20:53:18 2009 TCP connection established with 80.254.79.87:443<br />Tue Nov 10 20:53:18 2009 TCPv4_CLIENT link local: [undef]<br />Tue Nov 10 20:53:18 2009 TCPv4_CLIENT link remote: 80.254.79.87:443<br />Tue Nov 10 20:53:20 2009 [server] Peer Connection Initiated with 80.254.79.87:443<br />Tue Nov 10 20:53:21 2009 Options error: unknown --redirect-gateway flag: bypass-dhcp<br />Tue Nov 10 20:53:21 2009 Options error: Unrecognized option or missing parameter(s) in [PUSH-OPTIONS]:5: topology (2.0.9)<br />Tue Nov 10 20:53:21 2009 Options error: Unrecognized option or missing parameter(s) in [PUSH-OPTIONS]:8: socket-flags (2.0.9)<br />Tue Nov 10 20:53:21 2009 WARNING: Since you are using --dev tun, the second argument to --ifconfig must be an IP address.&nbsp; You are using something (255.255.255.128) that looks more like a netmask. (silence this warning with --ifconfig-nowarn)<br />Tue Nov 10 20:53:21 2009 TUN/TAP device tun0 opened<br />Tue Nov 10 20:53:21 2009 /sbin/ifconfig tun0 80.254.76.136 pointopoint 255.255.255.128 mtu 1500<br />ifconfig: SIOCSIFDSTADDR: Invalid argument<br />Tue Nov 10 20:53:22 2009 Linux ifconfig failed: shell command exited with error status: 1<br />Tue Nov 10 20:53:22 2009 Exiting<br />root@OpenWrt:~#</p><p>if i do -ifconfig there is no tun/tap adpater availiable:</p><p>root@OpenWrt:~# ifconfig<br />br-lan&nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 00:13:10:27:E7:00<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:192.168.1.1&nbsp; Bcast:192.168.1.255&nbsp; Mask:255.255.255.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:2256 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:2375 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:310920 (303.6 KiB)&nbsp; TX bytes:1662308 (1.5 MiB)</p><p>eth0&nbsp; &nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 00:13:10:27:E7:00<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:5952 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:6180 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:2570959 (2.4 MiB)&nbsp; TX bytes:856380 (836.3 KiB)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Interrupt:5</p><p>eth0.0&nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 00:13:10:27:E7:00<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:559 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:0 (0.0 B)&nbsp; TX bytes:184103 (179.7 KiB)</p><p>eth0.1&nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 00:13:10:27:E7:00<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:5952 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:5621 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:2463823 (2.3 MiB)&nbsp; TX bytes:576697 (563.1 KiB)</p><p>lo&nbsp; &nbsp; &nbsp; &nbsp; Link encap:Local Loopback<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:127.0.0.1&nbsp; Mask:255.0.0.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP LOOPBACK RUNNING&nbsp; MTU:16436&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:49 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:49 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:3580 (3.4 KiB)&nbsp; TX bytes:3580 (3.4 KiB)</p><p>ppp0&nbsp; &nbsp; &nbsp; Link encap:Point-to-Point Protocol<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:217.233.175.24&nbsp; P-t-P:217.0.116.218&nbsp; Mask:255.255.255.255<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP POINTOPOINT RUNNING NOARP MULTICAST&nbsp; MTU:1492&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:2349 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:2132 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:3<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:1628601 (1.5 MiB)&nbsp; TX bytes:295572 (288.6 KiB)</p><p>wl0&nbsp; &nbsp; &nbsp; &nbsp;Link encap:Ethernet&nbsp; HWaddr 00:13:10:27:E7:02<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:4534 errors:0 dropped:0 overruns:0 frame:9479<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:5097 errors:1 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:672602 (656.8 KiB)&nbsp; TX bytes:2625965 (2.5 MiB)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Interrupt:4 Base address:0x1000</p><br /><p>What can i do to fix the problem?</p>											<p class="post-edited">(Last edited by <strong>sangul</strong> on 10 Nov 2009, 22:18)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p97185">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						11 Nov 2009, 01:30					</div>
				</div>
				<div class="post-content content">
					<p>I don&#039;t know what options are required for swissvpn but the error you see is caused by a faulty ifconfig setting. The reason is that you use a tun, not a tap interface but OpenVPN tries to configure a netmask on it. With tun interfaces you need to use ifconfig in the form &quot;local-address peer-address&quot; while &quot;local-address netmask&quot; is needed for tap interfaces. </p><p>Your client uses the netmask variant on the tun interface which is obviously wrong. I assume swissvpn pushes the ip settings to you so most likely the &quot;dev&quot; parameter in your local config is tun instead of tap.</p><p>~ JoW</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p97213">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">sangul</div>
					<div class="post-datetime">
						11 Nov 2009, 15:13					</div>
				</div>
				<div class="post-content content">
					<p>Hi, i have edited the following file: swissvpn.ovpn from dev tun to dev tap</p><p>dev tap<br />client<br />proto tcp-client<br />remote connect-openvpn.swissvpn.net 443<br />ca ca.crt<br />auth-user-pass<br />reneg-sec 86400<br />ns-cert-type server</p><p>now i get the following message:</p><p>root@OpenWrt:~# openvpn --cd /etc/openvpn --config swissvpn.ovpn<br />Wed Nov 11 20:37:20 2009 OpenVPN 2.0.9 mipsel-linux [SSL] [LZO] built on Sep&nbsp; 7 2009<br />Enter Auth Username:swissvpntest<br />Enter Auth Password:<br />Wed Nov 11 20:37:25 2009 IMPORTANT: OpenVPN&#039;s default port number is now 1194, based on an official port number assignment by IANA.&nbsp; OpenVPN 2.0-beta16 and earlier used 5000 as the default port.<br />Wed Nov 11 20:37:25 2009 Attempting to establish TCP connection with 80.254.79.87:443<br />Wed Nov 11 20:37:25 2009 TCP connection established with 80.254.79.87:443<br />Wed Nov 11 20:37:25 2009 TCPv4_CLIENT link local: [undef]<br />Wed Nov 11 20:37:25 2009 TCPv4_CLIENT link remote: 80.254.79.87:443<br />Wed Nov 11 20:37:27 2009 WARNING: &#039;dev-type&#039; is used inconsistently, local=&#039;dev-type tap&#039;, remote=&#039;dev-type tun&#039;<br />Wed Nov 11 20:37:27 2009 WARNING: &#039;link-mtu&#039; is used inconsistently, local=&#039;link-mtu 1575&#039;, remote=&#039;link-mtu 1543&#039;<br />Wed Nov 11 20:37:27 2009 WARNING: &#039;tun-mtu&#039; is used inconsistently, local=&#039;tun-mtu 1532&#039;, remote=&#039;tun-mtu 1500&#039;<br />Wed Nov 11 20:37:27 2009 [server] Peer Connection Initiated with 80.254.79.87:443<br />Wed Nov 11 20:37:28 2009 Options error: unknown --redirect-gateway flag: bypass-dhcp<br />Wed Nov 11 20:37:28 2009 Options error: Unrecognized option or missing parameter(s) in [PUSH-OPTIONS]:5: topology (2.0.9)<br />Wed Nov 11 20:37:28 2009 Options error: Unrecognized option or missing parameter(s) in [PUSH-OPTIONS]:8: socket-flags (2.0.9)<br />Wed Nov 11 20:37:28 2009 TUN/TAP device tap0 opened<br />Wed Nov 11 20:37:28 2009 /sbin/ifconfig tap0 80.254.76.249 netmask 255.255.255.128 mtu 1500 broadcast 80.254.76.255<br />Wed Nov 11 20:37:28 2009 Initialization Sequence Completed</p><p>After a few minutes i abroad it with strg+c then this message comes:</p><p>Wed Nov 11 21:03:32 2009 event_wait : Interrupted system call (code=4)<br />Wed Nov 11 21:03:32 2009 SIGINT[hard,] received, process exiting</p><br /><p>At&nbsp; &nbsp;&quot;Wed Nov 11 20:37:28 2009 Initialization Sequence Completed&quot; it doesen&#039;t continue and i have to abroad it with strg+c.</p><p>ifconfig:</p><p>tap0&nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 00:FF:88:F4:F4:7C<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:80.254.76.203&nbsp; Bcast:80.254.76.255&nbsp; Mask:255.255.255.128<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:0 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:100<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:0 (0.0 B)&nbsp; TX bytes:0 (0.0 B)</p><br /><br /><p>What should i do next?</p><p>to the file /etc/config/firewall i have add, like described here <a href="https://forum.perfect-privacy.com/showthread.php?t=1013">https://forum.perfect-privacy.com/showthread.php?t=1013</a>:</p><p>###<br /># OpenVPN rule - accepts incoming udp connections on wan interface at port 1194<br />###<br /># cisco acl equiv<br /># permit udp any any eq 1194<br /># ip access-group aclname in<br />###<br />config &#039;rule&#039;<br />option &#039;src&#039; &#039;wan&#039;<br />option &#039;target&#039; &#039;ACCEPT&#039;<br />option &#039;proto&#039; &#039;udp&#039;<br />option &#039;dest_port&#039; &#039;1194&#039; </p><br /><p>to the file /etc/firewall.user i have add:</p><p>iptables -I OUTPUT -o tun+ -j ACCEPT<br />iptables -I INPUT -i tun+ -m state --state ESTABLISHED,RELATED -j ACCEPT<br />iptables -I FORWARD -o tun+ -j ACCEPT<br />iptables -I FORWARD -i tun+ -m state --state ESTABLISHED,RELATED -j ACCEPT<br />iptables -t nat -I POSTROUTING -o tun+ -j MASQUERADE </p><br /><br /><p>here you can read a few infos about the swissvpn settings:&nbsp; <a href="http://www.swissvpn.net/index.php?cot=faq&amp;lang=en">http://www.swissvpn.net/index.php?cot=faq&amp;lang=en</a></p><p>please help me..</p>											<p class="post-edited">(Last edited by <strong>sangul</strong> on 11 Nov 2009, 23:27)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>