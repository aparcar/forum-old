<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Patched OpenSSL for Heartbleed vulnerability on Attitude Adjustment?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 6 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p229544">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">rfkrocktk</div>
					<div class="post-datetime">
						8 Apr 2014, 06:21					</div>
				</div>
				<div class="post-content content">
					<p>Can the packagers please package and update the repositories with a patched version of OpenSSL to address the Heartbleed vulnerability?</p><p>If you haven&#039;t heard about it, I hate to be the bearer of the most terrible news ever: <a href="http://heartbleed.com">http://heartbleed.com</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p229556">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">lkraav</div>
					<div class="post-datetime">
						8 Apr 2014, 11:19					</div>
				</div>
				<div class="post-content content">
					<p>I don&#039;t seem to have openssl installed, but I do have openvpn. Is AA openvpn built against a vulnerable openssl version?</p><p>root@gw:~# openvpn --version<br />OpenVPN 2.2.2 mips-openwrt-linux [SSL] [LZO2] [EPOLL] built on Mar 14 2013</p><p>This doesn&#039;t really say much.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p229583">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">schoenfeld</div>
					<div class="post-datetime">
						8 Apr 2014, 15:26					</div>
				</div>
				<div class="post-content content">
					<p>root@golden-gate:~# openssl version<br />OpenSSL 1.0.1c 10 May 2012</p><p>It should be affected. But maybe, the critical heartbeat-feature was disabled by one of the the patches.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p229601">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">rfkrocktk</div>
					<div class="post-datetime">
						8 Apr 2014, 19:59					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>lkraav wrote:</cite><blockquote><p>I don&#039;t seem to have openssl installed, but I do have openvpn. Is AA openvpn built against a vulnerable openssl version?</p><p>root@gw:~# openvpn --version<br />OpenVPN 2.2.2 mips-openwrt-linux [SSL] [LZO2] [EPOLL] built on Mar 14 2013</p><p>This doesn&#039;t really say much.</p></blockquote></div><p>I&#039;m not sure. Are you sure that you don&#039;t have OpenSSL installed? OpenSSL is shipped separately than its command-line tools in OpenWRT if I recall correctly. Search for a passage containing &quot;openssl&quot; and you should see one which is named something like &quot;openssl-tools&quot;. Install this and verify the version information.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p229602">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">rfkrocktk</div>
					<div class="post-datetime">
						8 Apr 2014, 20:00					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>schoenfeld wrote:</cite><blockquote><p>root@golden-gate:~# openssl version<br />OpenSSL 1.0.1c 10 May 2012</p><p>It should be affected. But maybe, the critical heartbeat-feature was disabled by one of the the patches.</p></blockquote></div><p>Well, we can only hope that it is <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /> The bug was leaked yesterday and I haven&#039;t seen any feedback from the OpenWRT team or seen a package update for OpenSSL on my router yet. I&#039;ve recompiled packages for OpenSSL in the past and I might have to do it again, but it would be great if packages could be rebuilt for Attitude Adjustment and shipped out to everyone, rather than just to me.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p229606">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						8 Apr 2014, 20:10					</div>
				</div>
				<div class="post-content content">
					<p>AA sources have been patched today, so if you now build AA packages, you get the patched version.<br /><a href="https://dev.openwrt.org/browser/branches/attitude_adjustment/package/openssl/Makefile">https://dev.openwrt.org/browser/branche … l/Makefile</a></p><p>Trunk: <a href="https://dev.openwrt.org/changeset/40421">https://dev.openwrt.org/changeset/40421</a><br />AA: <a href="https://dev.openwrt.org/changeset/40423">https://dev.openwrt.org/changeset/40423</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p229607">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">rfkrocktk</div>
					<div class="post-datetime">
						8 Apr 2014, 20:12					</div>
				</div>
				<div class="post-content content">
					<p>If I do </p><div class="codebox"><pre><code>opkg upgrade openssl</code></pre></div><p>Will I get the latest patch?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p229608">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						8 Apr 2014, 20:16					</div>
				</div>
				<div class="post-content content">
					<p>No. Binary repository still contains the old 2012/2013 version.</p>											<p class="post-edited">(Last edited by <strong>hnyman</strong> on 8 Apr 2014, 20:17)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p229610">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">obsy</div>
					<div class="post-datetime">
						8 Apr 2014, 20:38					</div>
				</div>
				<div class="post-content content">
					<p>For ar71xx try this: <a href="http://ecco.selfip.net/attitude_adjustment/ar71xx/packages/libopenssl_1.0.1g-1_ar71xx.ipk">http://ecco.selfip.net/attitude_adjustm … ar71xx.ipk</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p229611">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">rfkrocktk</div>
					<div class="post-datetime">
						8 Apr 2014, 20:51					</div>
				</div>
				<div class="post-content content">
					<p>When will the patch hit the binary repository?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p229614">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">Borromini</div>
					<div class="post-datetime">
						8 Apr 2014, 21:16					</div>
				</div>
				<div class="post-content content">
					<p>I don&#039;t think those get updated... They&#039;re a snapshot of the 12.09 release. But maybe they do issue an update for security issues like these; the AA branch has been marked 12.09.1 for a while.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p229622">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">rfkrocktk</div>
					<div class="post-datetime">
						8 Apr 2014, 21:55					</div>
				</div>
				<div class="post-content content">
					<p>Gotcha. I thought for sure that the repositories would be updated consistently with latest security patches.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p229633">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">thdyck</div>
					<div class="post-datetime">
						8 Apr 2014, 23:51					</div>
				</div>
				<div class="post-content content">
					<p>A note that OpenWrt 10.03.1 uses libopenssl 0.9.8r-1, so not vulnerable to the heartbleed SSL bug.</p><p># opkg info libopenssl<br />Package: libopenssl<br />Version: 0.9.8r-1<br />Depends: zlib<br />Provides:<br />Status: install ok installed<br />Architecture: ar71xx<br />Installed-Time: 1315497874</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p229643">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">rfkrocktk</div>
					<div class="post-datetime">
						9 Apr 2014, 01:12					</div>
				</div>
				<div class="post-content content">
					<p>Instructions can be found in this forum somewhere, but I found them here: <a href="http://www.taylorbyte.com/docs/wiki/openwrt/compiling">http://www.taylorbyte.com/docs/wiki/openwrt/compiling</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p229650">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">rfkrocktk</div>
					<div class="post-datetime">
						9 Apr 2014, 03:06					</div>
				</div>
				<div class="post-content content">
					<p>Please fork responses to that to a different thread so that this thread can focus on determining when OpenWRT will ship binary patches to OpenSSL to close the Heartbleed vulnerability.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p229657">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">yokem55</div>
					<div class="post-datetime">
						9 Apr 2014, 05:16					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>obsy wrote:</cite><blockquote><p>For ar71xx try this: <a href="http://ecco.selfip.net/attitude_adjustment/ar71xx/packages/libopenssl_1.0.1g-1_ar71xx.ipk">http://ecco.selfip.net/attitude_adjustm … ar71xx.ipk</a></p></blockquote></div><p>I&#039;m not normally one to use packages posted by random strangers on the internet, but in this case I think the alternative of waiting for an official update with a vulnerable OpenVPN implementation is worse. In any case this package seems to be working fine on my ar71xx device.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p229661">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">Cye3s</div>
					<div class="post-datetime">
						9 Apr 2014, 07:16					</div>
				</div>
				<div class="post-content content">
					<p>I installed libopenssl_1.0.1g from trunk, works fine on AA:<br /><a href="http://downloads.openwrt.org/snapshots/trunk/ar71xx/packages/libopenssl_1.0.1g-1_ar71xx.ipk">http://downloads.openwrt.org/snapshots/ … ar71xx.ipk</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p229699">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">thdyck</div>
					<div class="post-datetime">
						9 Apr 2014, 15:20					</div>
				</div>
				<div class="post-content content">
					<p>Trunk versions are also working for me with OpenVPN on the ar71xx platform.</p><div class="codebox"><pre><code># cd /tmp

(confirm vulnerable versions are present)
# opkg list | grep openssl
libopenssl - 1.0.1e-1
openssl-util - 1.0.1e-1

(download the trunk packages for ar71xx)
# wget http://downloads.openwrt.org/snapshots/trunk/ar71xx/packages/libopenssl_1.0.1g-1_ar71xx.ipk
# wget http://downloads.openwrt.org/snapshots/trunk/ar71xx/packages/openssl-util_1.0.1g-1_ar71xx.ipk

(install the new packages)
# opkg install libopenssl_1.0.1g-1_ar71xx.ipk
Upgrading libopenssl on root from 1.0.1e-1 to 1.0.1g-1...
Configuring libopenssl.

# opkg install openssl-util_1.0.1g-1_ar71xx.ipk
Upgrading openssl-util on root from 1.0.1e-1 to 1.0.1g-1...
Configuring openssl-util.

(confirm the new versions are present)
# opkg list | grep openssl
libopenssl - 1.0.1g-1
openssl-util - 1.0.1g-1

(reboot to ensure the new libraries are used by all programs)
# reboot</code></pre></div><p>Regards,<br />Tim Miller Dyck</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p229716">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">p2baron</div>
					<div class="post-datetime">
						9 Apr 2014, 17:56					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>lkraav wrote:</cite><blockquote><p>I don&#039;t seem to have openssl installed, but I do have openvpn. Is AA openvpn built against a vulnerable openssl version?</p><p>root@gw:~# openvpn --version<br />OpenVPN 2.2.2 mips-openwrt-linux [SSL] [LZO2] [EPOLL] built on Mar 14 2013</p><p>This doesn&#039;t really say much.</p></blockquote></div><p>I would like to know this as well. Openssl seem to be patched in AA but OpenVPN isn&#039;t.<br />The OpenVPN developers are releasing patches/upgraded versions to address this problem. So it seems that the OpenVPN software also has to be patched/recompiled.</p><p>More information on the OpenVPN forum: <a href="https://forums.openvpn.net/topic15526.html">https://forums.openvpn.net/topic15526.html</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p229725">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">yokem55</div>
					<div class="post-datetime">
						9 Apr 2014, 19:34					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>p2baron wrote:</cite><blockquote><p>I would like to know this as well. Openssl seem to be patched in AA but OpenVPN isn&#039;t.<br />The OpenVPN developers are releasing patches/upgraded versions to address this problem. So it seems that the OpenVPN software also has to be patched/recompiled.</p><p>More information on the OpenVPN forum: <a href="https://forums.openvpn.net/topic15526.html">https://forums.openvpn.net/topic15526.html</a></p></blockquote></div><p>On openwrt, OpenVPN is dynamically linked against the system provided libssl:</p><div class="codebox"><pre><code>root@OpenWrt:~# ldd /usr/sbin/openvpn 
    libssl.so.1.0.0 =&gt; /usr/lib/libssl.so.1.0.0 (0x771ed000)
    libcrypto.so.1.0.0 =&gt; /usr/lib/libcrypto.so.1.0.0 (0x770ad000)
    liblzo2.so.2 =&gt; /usr/lib/liblzo2.so.2 (0x77082000)
    libgcc_s.so.1 =&gt; /lib/libgcc_s.so.1 (0x7705f000)
    libc.so.0 =&gt; /lib/libc.so.0 (0x76ff3000)
    libdl.so.0 =&gt; /lib/libdl.so.0 (0x76fdf000)
    ld-uClibc.so.0 =&gt; /lib/ld-uClibc.so.0 (0x77246000)</code></pre></div><p>So, simply updating to the libopenssl_1.0.1g-1_ar71xx.ipk package and restarting openvpn (reboot if you really want to be sure) will make openvpn take the patch. Now, you&#039;ll still have to consider rekeying and reissuing certs but updating that package will stop the bleeding.</p>											<p class="post-edited">(Last edited by <strong>yokem55</strong> on 9 Apr 2014, 19:35)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p229727">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">rfkrocktk</div>
					<div class="post-datetime">
						9 Apr 2014, 19:48					</div>
				</div>
				<div class="post-content content">
					<p>Most <em>good</em> software will dynamically link to an external library and it pays off in situations like this. OpenVPN doesn&#039;t need to do anything to fix the Heartbleed vulnerability, once libssl is redistributed, the bug is fixed. </p><p>In addition to recreating my entire public/private key infrastructure, now I need to also recompile OpenSSL for my router <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>On a related note, why doesn&#039;t OpenWRT ship new&nbsp; versions of packages including security patches? I thought that the package management on OpenWRT was similar to other Linux distributions where security-related fixes were maintained but newer versions of software go in newer OS major versions.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p229732">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">ThatGuy</div>
					<div class="post-datetime">
						9 Apr 2014, 20:59					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>thdyck wrote:</cite><blockquote><div class="codebox"><pre><code>(confirm vulnerable versions are present)
# opkg list | grep openssl
libopenssl - 1.0.1e-1
openssl-util - 1.0.1e-1

...

(confirm the new versions are present)
# opkg list | grep openssl
libopenssl - 1.0.1g-1
openssl-util - 1.0.1g-1</code></pre></div></blockquote></div><p>Shouldn&#039;t that be list<strong>-installed</strong> (list <strong>installed</strong> packages, rather than <strong>available</strong> packages)?</p><div class="codebox"><pre><code>root@OpenWrt:~# opkg
opkg must have one sub-command argument
usage: opkg [options...] sub-command [arguments...]
where sub-command is one of:

...

Informational Commands:
        list                    List available packages
        list-installed          List installed packages</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p229762">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">drawz</div>
					<div class="post-datetime">
						10 Apr 2014, 03:09					</div>
				</div>
				<div class="post-content content">
					<p>Seems like a good time to release 12.09.1, which has a lot of other fixes included. At a minimum, adding the appropriate packages to the 12.09 repository seems like a good idea.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p229764">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">rfkrocktk</div>
					<div class="post-datetime">
						10 Apr 2014, 04:43					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>drawz wrote:</cite><blockquote><p>Seems like a good time to release 12.09.1, which has a lot of other fixes included. At a minimum, adding the appropriate packages to the 12.09 repository seems like a good idea.</p></blockquote></div><p>Agreed, this needs to happen immediately.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p229771">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">tapper</div>
					<div class="post-datetime">
						10 Apr 2014, 08:20					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>drawz wrote:</cite><blockquote><p>Seems like a good time to release 12.09.1, which has a lot of other fixes included. At a minimum, adding the appropriate packages to the 12.09 repository seems like a good idea.</p></blockquote></div><br /><p>I +1 this!</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>