<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Help Installing OpenWRT on 2Wire 2700HG-D</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 4 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p97626">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">tjm08</div>
					<div class="post-datetime">
						19 Nov 2009, 17:49					</div>
				</div>
				<div class="post-content content">
					<p>2Wire 2700HG-D </p><p>FCCID: PGR2W2700RD <br />Chipset: Atheros AR2413A <br />Flash: ST NAND128W3A2BN6 (16MB?) <br />Ram: NANYA NT5DS16M16CS-5T (64MB?) </p><p>Hidden manual firmware update page can be found at: <br />(GatewayIPaddress)\tech\update <br />Advanced Configuration settings can be found at: <br />(GatewayIPaddress)\mdc </p><p>Supported upgrade file formats are: <br />.bin <br />.imi <br />.2sp </p><p>OEM Kernel is either FreeBSD (from searching) <br />or Linux (Knopix?) (from 2wire source download) (file is KNP-Linux) </p><p>How would I install OpenWRT (and what files) on this Gateway?</p><p>Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p97811">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">tjm08</div>
					<div class="post-datetime">
						23 Nov 2009, 05:49					</div>
				</div>
				<div class="post-content content">
					<p>Some news - I have found out how to successfully write the flash to zeros. Fun. Now, I think that I need to JTAG the flash back to OpenWRt, or back to factory. FYI, the factory SBC recovery.2sp factory is a whopping 10.0 MB, as reported by Windows. This machine has a HUGE flash (This file sucessfully uploaded and converted my factory Quest firmware to factory SBC firmware.) I think that someone skilled could likely take a flash image, an Atheros OpenWRT kernel image, and place the OpenWRT image in place of the stock Linux Kernel. </p><p>I have a Red, Green, Red blink sequence on power on, after which two other LED&#039;s (DSL &amp; Internet) light to Red. I think this either means a.) bootloader intact, kernel zeros, or b.) flash entirely zeros. I do not have any ethernet ports, usb detection by pc, or ping that I can find. Probable brick. </p><p>Does any programers out there know if the OpenWRT kernel is chipset specific, or if this version is taylored to the specific chipset application? </p><p>As to a hacked binary image, I believe the trick is to locate the exact first bite of the updated kernel, and replace the kernel byte for byte with the appropriate binary OpenWRT kernel. The file has detailed text information regarding where scripts are, etc. </p><p>There is also a service connector on the front portion of the circuit board, with seven printed connectors. I believe that this is for manually servicing this board, but the key is finding which connector does what. I measure 1,2,3,4,5 6,7 as <br />-,-,+,+,+ -,- <br />connector #4 resets the power when connected to the case. Joy for anyone interested in trying to increase the functionality of this model of nearly retired dsl modem, or OpenWRT Software. I have found some of the factory firmware after extensive searching. Of course, any experimentors should either be extremely carefull, well equiped, or be willing to make (small, in my case) sacrifices. DO NOT EXPERIMENT WITH VITAL EQUIPMENT. </p><p>Thanks, and I hope someone will take up this model of hardware. I think that this could have promise.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p97822">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						23 Nov 2009, 15:36					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>tjm08 wrote:</cite><blockquote><p>Joy for anyone interested in trying to increase the functionality of this model of nearly retired dsl modem, or OpenWRT Software. I have found some of the factory firmware after extensive searching. Of course, any experimentors should either be extremely carefull, well equiped, or be willing to make (small, in my case) sacrifices. DO NOT EXPERIMENT WITH VITAL EQUIPMENT.</p></blockquote></div><p>Any plan to donate this device away for the cause of hacking?</p><div class="quotebox"><blockquote><p>I think that this could have promise.</p></blockquote></div><p>A device with plenty of Flash/RAM is definitely a good candidate for any open-source firmware, AFAIC.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p97862">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">tjm08</div>
					<div class="post-datetime">
						24 Nov 2009, 17:47					</div>
				</div>
				<div class="post-content content">
					<p>I need an introduction project, however, there should be a multitude of these things out there.&nbsp; I am in the USA, and Quest (a local broadband company) has been supplying thier customers with these.&nbsp; Power adapters die frequently, but mine (which I bought at a yard sale for $1.00 US) worked with another power adapter.&nbsp; I have seen around 3 on ebay when I looked, and it seems that they go for around $25.00 US.&nbsp; Many people don&#039;t like them for various reasons, and some get bricked by automated firmware updates (or people get really annoyed by the same, without the bricking.)&nbsp; Right now, I am trying to figure the pinouts on the J2 header for that board.&nbsp; On closer examination, there are pins on the other side of the PCB.&nbsp; Someone in the UK has figured out a method of getting more functionality and access to the firmware (I was never able to get a tftp response, among other things) by connecting two pins on the J2 header (which would cause a factory diagnostics boot).&nbsp; Google unlocking 2Wire 270x-xx for more detailed information.&nbsp; X is a wild card, as the article is written about the next model up, the 2701, if memory serves.&nbsp; I can supply my killer firmware version, but the best approach is to locate original firmware.&nbsp; I took the two large binary blocks, and replaced them and everything after them with a block of zeros.&nbsp; </p><p>As I now have a brick, it seems that I have (?) successfully erased the kernel.&nbsp; There were two blocks, with a sequence which I beleve to be the write comand, and I placed zeros after both.&nbsp; There does exist a boot wait, and I did have access to the UI after the &quot;upgrade&quot;, until I hard resseted.&nbsp; This allows for a possible test procedure to see if firmware is accepted, but I do not know how well the recovery flash after test flash would work as the router reboots prior to running the update procedure.&nbsp; I think it might just find a corrupted kernel at that point and the recovery flash would grind to a screeching halt.&nbsp; </p><p>Approaches for functional machines (as seems logical to me) would be:<br />1.)&nbsp; Hacked Firmware recovery/update with kernel portion replaced with opensource firmware<br />2.)&nbsp; Hacked USB Driver and/or firmware with read/write via USB, so that the flash is accessible in the sameway the USB flash drives are <br />3.)&nbsp; Programed Basic firmware with acceptable header that has a kernel that allows either <br />&nbsp; &nbsp; &nbsp; a.)&nbsp; TFTP Access<br />&nbsp; &nbsp; &nbsp; b.)&nbsp; USB Read/Write Access<br />&nbsp; &nbsp; &nbsp; c.)&nbsp; Erase rest of Flash</p><p>I would appreciate some pointers on this, as I am new to the whole hacking thing.&nbsp; I have some schooling with programming, and am willing to learn.&nbsp; DIY projects are very effective teaching tools, and I have open ears to what anyone has to say.&nbsp; I have been considering emailing the techsupport to try and obtain a pinout of the J2 header, but I suspect that that information might not be forthcoming.&nbsp; any ideas?</p>											<p class="post-edited">(Last edited by <strong>tjm08</strong> on 24 Nov 2009, 18:04)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p97863">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						24 Nov 2009, 18:08					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for all information you provided above. You definitely have done a lot of works on this device and I wish you will be able to debrick yours soon.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p97928">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">tjm08</div>
					<div class="post-datetime">
						26 Nov 2009, 07:58					</div>
				</div>
				<div class="post-content content">
					<p>I am working on building an interface cable to the pcb J2 Header.&nbsp; I thought part of an old-style floppy cable would work, but the pin widths are different.&nbsp; (the floppy pins are wider).&nbsp; It looks like I am going to have to take a 25pin header cable from an old AT PC (I have a huge supply of obsolete hardware) and a 25 pin female to 25 pin female cable.&nbsp; </p><p>I figure that if I <br />a.)&nbsp; locate the relevant pin defs for the 14 pin pcb edge connector<br />b.)&nbsp; find the corresponding pin defs for the 25 pin parallel port<br />c.)&nbsp; solder the individual wires from the 25 pin header to the correct pins of the PCB<br />d.)&nbsp; obtain a driver that will allow me to write bits to specific adresses,</p><p>then I have a JTAG-type interface that will work with a 2Wire 2700HG-D (and similar).&nbsp; </p><p>Yay.&nbsp; Any advice on how to find the pinouts?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p98038">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">tjm08</div>
					<div class="post-datetime">
						29 Nov 2009, 06:22					</div>
				</div>
				<div class="post-content content">
					<p>More Fun.&nbsp; After extensive examination of the circuit board and internet research, It seems that this DSL Modem/Gateway/Wireless Router uses a VLIW type Processor, of the TriMedia Family of NXP Processors, in addition to the 16MB Flash and the 64MB DDR SDRAM.&nbsp; It seems that this is an interesting beastie;&nbsp; I have been trying to review the OEM Flash binary for the write (and other) instructions and the binary kernel image.</p><p>Does anyone know if this type of CPU is supported by OpenWRT?&nbsp; Some of the DSL Forums indicate that this processor is similar to the MIPS type of CPU. </p><p>I am still having loads of fun.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p98388">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">tjm08</div>
					<div class="post-datetime">
						6 Dec 2009, 18:30					</div>
				</div>
				<div class="post-content content">
					<p>Some news.&nbsp; I have a tentative pinout.</p><p>J-1 Header&nbsp; Note:&nbsp; Even pins are on the top of the board, odd pins underneath <br />01 - 3.3V&nbsp; &nbsp;02 - GND (connected to 04 via trace; continuity to GND)&nbsp; &nbsp;<br />03 - 0.0V&nbsp; &nbsp;04 - GND (connected to 02 via trace; continuity to GND<br />Key<br />05 - 3.3V&nbsp; &nbsp;06 - 3.3V<br />07 - 3.3V&nbsp; &nbsp;08 - 3.3V (nSRST;&nbsp; causes system reset led pattern when shorted to ground)<br />09 - 3.3V&nbsp; &nbsp;10 - 3.3V (FTM) (Functional Test Mode;&nbsp; connected to pin 1 of J-1 Header, which is documented)<br />11 - N.C.&nbsp; &nbsp;12 - 0.0V<br />13 - N.C.&nbsp; &nbsp;14 - GND (continuity to GND)</p><p>J-2 Header<br />01 - 3.3V (FTM)&nbsp; 02 - GND&nbsp; (Documented for &quot;Functional Test Mode&quot;)</p><p>Found (tentative)<br />nSRST (optional JTAG, consistant with observed behavior)<br />To find:<br />nTRST (optional JTAG, possible; used for logic reset of JTAG chain)<br />TCK&nbsp; &nbsp; (essential JTAG; Test clock signal)<br />RTCK&nbsp; (optional JTAG, possible;&nbsp; used for adaptive clocking and higher data transfer)<br />TDI&nbsp; &nbsp; &nbsp;(essential JTAG; Test Data Input)<br />TDO&nbsp; &nbsp; (essential JTAG; Test Data Output)<br />I Believe that nTRST may be either pin #3 or pin #12, based on the procedure used by Smiggy.</p><p>Quoting from Smiggy, who documented his test method as follows on <br /><a href="http://forums.whirlpool.net.au/forum-replies-archive.cfm/808533.html">http://forums.whirlpool.net.au/forum-re … 08533.html</a></p><p>The method I used was fairly simple but laborious. </p><p>1. Measure the resistance of all pins to GND and 3.3V power supply. You need to measure under the electrolytic capacitors to determine which is the main 3.3v supply. Mark them carefully on a pinout graphic all your measurements. This is important to do a clean accurate test. Turn it on and measure all voltages. Mark them on your graphic. </p><p>2. The pins that have already been defined as putting the box into special boot mode. Mark those. </p><p>3. One pin will have high resistance to GRND and 3.3v. It is TDO, ie output which cannot be pulled up or down but floating. Mine showed 3Mohm.</p><p>4. One pin will be at either full supply potential 3.3v or 0v will be nTRST. (Assuming they have nTRST turned off. It was in mine.) It will more than likely have a different resistance than other pins. Mine was 5K to 3.3v 1.5K GND. It will, hence have much lower voltage to ground and be at or near 0v.</p><p>5. Hopefully you now have a bunch of pins next to each other, which are unknown. In my case 4,5 then 12,13,14 All measure 3.3v. All have 1k to 3.3v and 2k to GND. I traced pins 4, 5 to I2C serial eprom. So it won&#039;t be those. That leaves the 3 pins bunched together. 12,13,14 which makes sense. The rest is trial and error. Make up a grid and work through the combinations. TDI, TMS, TCK. start the JTAG software each time. I just used the hairy dairy maid one. When I hit the right combo all the LED&#039;s turned on indicating I had put the processor in a diagnostic mode.<br />Only one or perhaps two combinations will do that. So you now have the 4 JTAG pins plus NTRST defined. Or perhaps two possibles.</p><p>There is a procedure documented on JTAG finder, which is essentially a logic procedure where in all potential JTAG Pins are hooked up simultaneously.&nbsp; A data signal is sent to one pin at a time, and all of the other pins are observed for changes in logic state.&nbsp; more information can be found at:&nbsp; <a href="http://www.elinux.org/JTAG_Finder">http://www.elinux.org/JTAG_Finder</a></p><p>Given the tentative pinout that I have now, I think that I can build an unbuffered parallel interface with 8 connects on parallel pins 2-9 (data pins), and reserve pin 13 for TDO when found.&nbsp; Then I should be able to implement the finder method to narrow things down.&nbsp; After that, figure how to work with the TriMedia VLIW CPU and the NAND flash.&nbsp; The cable would be identical to the unbuffered cable described in the wiki, with the exception of using all eight of the data bus signals.</p><br /><p>Any thoughts on this method?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p118731">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">z80yyz</div>
					<div class="post-datetime">
						8 Oct 2010, 19:03					</div>
				</div>
				<div class="post-content content">
					<p>GPL source code is here: <a href="http://www.2wire.com/index.php?p=437">http://www.2wire.com/index.php?p=437</a></p><p>Might play with one that I just picked out of our condo re-use bin......</p><p>Gerrit</p>											<p class="post-edited">(Last edited by <strong>z80yyz</strong> on 8 Oct 2010, 19:04)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p155052">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">asbokid</div>
					<div class="post-datetime">
						22 Jan 2012, 23:42					</div>
				</div>
				<div class="post-content content">
					<p>The pinout for the dual row card edge connector found in the 2Wire routers is as follows:</p><p><span class="postimg"><img src="http://hackingbtbusinesshub.files.wordpress.com/2012/01/2wirecardedgepinout_400px.png" alt="http://hackingbtbusinesshub.files.wordpress.com/2012/01/2wirecardedgepinout_400px.png" /></span></p><p>There are now some development tools for the TriMedia core found in these routers. </p><p>A disassembler has been built for the TriMedia VLIW core, and there are utilities to re-build the boot ROM and JTAG tools to download object code to the core and to dump the NAND flash contents.</p><p>More info at:</p><p><a href="http://hackingbtbusinesshub.wordpress.com/2012/01/16/discovering-2wire-card-edge-pinout-for-jtag-i2c/">http://hackingbtbusinesshub.wordpress.c … -jtag-i2c/</a></p><p>P.S. Please contact if you have experience in reverse-engineering a flash file system, especially TrueFFS from m-Systems.&nbsp; &nbsp;The file system used in the 2Wire may be sitting on top of the Flash Translation Layer from TrueFFS and this needs to be understood.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p175205">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">diogoc</div>
					<div class="post-datetime">
						18 Aug 2012, 06:24					</div>
				</div>
				<div class="post-content content">
					<p>I have bricked my router<br />There are any possibility to recover it with JTAG?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p179945">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">asbokid</div>
					<div class="post-datetime">
						3 Oct 2012, 03:59					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>diogoc wrote:</cite><blockquote><p>I have bricked my router. There are any possibility to recover it with JTAG?</p></blockquote></div><p>Yes it is possible.</p><p>If it is one of the 2Wires with a card edge connector for JTAG then you will either need to solder wires to the card edge &#039;fingers&#039;,&nbsp; or find a suitable connector.&nbsp; They are available off-the-shelf but at a price, or else fashion one from a PCIe riser which has the same 1mm pitch as the edge connector.</p><p>Then you need to create a new boot ROM.&nbsp; The 2Wire modems normally boot from a 24Cxx series i2c serial EEPROM.&nbsp; To JTAG the device you use a different boot ROM. It contains the early stage bootscripts and the phase 1/2 bootloaders. Instead of booting from flash, the new boot ROM runs a JTAG monitor. </p><p>The JTAG monitor runs natively on the Trimedia (the CPU in the 2Wires) and accepts flash write instructions from a JTAG programmer on the PC. </p><p>It&#039;s not easy and requires several bits of kit - 24Cxx EEPROM programmer, 24C32 EEPROM on breakout board, 1mm pitch dual edge card connector, JTAG programmer and JTAG programming software.</p><p>cheers, a</p><p>P.S. The fact that the 2Wire router is bricked probably means that something is faulty.&nbsp; The NAND flash devices are more prone to fail with age, for example.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p180017">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">diogoc</div>
					<div class="post-datetime">
						4 Oct 2012, 00:01					</div>
				</div>
				<div class="post-content content">
					<p>my router is bricked because I updated it with a wrong firmware.</p><p>I have almost all of these tools. Can you help me with the steps to recover it?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>