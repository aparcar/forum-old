<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Netgear R7900</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 19 Apr 2018 and 4 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 2 of 2</div><nav><ul><li><a href="viewtopic.php%3Fid=64056&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p323932">
				<div class="post-metadata">
					<div class="post-num">Post #26</div>
					<div class="post-author">Zajec</div>
					<div class="post-datetime">
						15 May 2016, 09:30					</div>
				</div>
				<div class="post-content content">
					<p>Did OpenWrt refuse to flash original firmware?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324069">
				<div class="post-metadata">
					<div class="post-num">Post #27</div>
					<div class="post-author">neveroddoreven</div>
					<div class="post-datetime">
						16 May 2016, 06:34					</div>
				</div>
				<div class="post-content content">
					<p>It didn&#039;t, I was able to use CFE to flash the stock firmware.&nbsp; But after OpenWRT formatted its own JFFS2 in flash, the stock firmware was not happy later.&nbsp; It prints hundreds or thousands of lines complaining about the magic value of stock JFFS2 being wrong.&nbsp; This stalls the router from starting up too quickly, and its web portal just about stops responding for quite awhile.&nbsp; I gave up, came back a half hour later, and the stock web portal was eventually working.</p><p>I&#039;ve reflashed back to OpenWRT and am trying to get through wifi configuration using the terminal.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324075">
				<div class="post-metadata">
					<div class="post-num">Post #28</div>
					<div class="post-author">neveroddoreven</div>
					<div class="post-datetime">
						16 May 2016, 07:01					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m not able to use uci to set up wifi.&nbsp; Running &#039;wifi detect&#039; returns nothing.&nbsp; Do I need to manually install wifi drivers for the R7900 router?</p><p>I installed the trunk build with today&#039;s timestamp:<br />Kernel 4.4.7&nbsp; / OpenWrt Designated Driver r49377 / LuCI Master (git-16.135.27427-6415c04)</p><p>Let me know which dumps/logs to attach.&nbsp; I prefer privacy, so let me know which parts you need the most, otherwise I will redact or strip out lines that look like they contain unique info, MAC, serial etc.&nbsp; Get as technical as you like, I&#039;m a seasoned SDET in Linux, shell and DD-WRT jockeying, but new to OpenWRT.&nbsp; I&#039;m redacting syslog and kernel logs grabbed from luci and will post when I have the data ready.</p>											<p class="post-edited">(Last edited by <strong>neveroddoreven</strong> on 16 May 2016, 07:21)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324080">
				<div class="post-metadata">
					<div class="post-num">Post #29</div>
					<div class="post-author">Zajec</div>
					<div class="post-datetime">
						16 May 2016, 07:58					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>neveroddoreven wrote:</cite><blockquote><p>But after OpenWRT formatted its own JFFS2 in flash</p></blockquote></div><p>If you really had OpenWrt use JFFS2, you did something wrong. I&#039;ll just wait for the logs, I don&#039;t have my crystal ball.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324081">
				<div class="post-metadata">
					<div class="post-num">Post #30</div>
					<div class="post-author">neveroddoreven</div>
					<div class="post-datetime">
						16 May 2016, 08:32					</div>
				</div>
				<div class="post-content content">
					<p>System logs with kernel logs at top, a few UUID and MAC/IPV6 redacted, nothing else.<br /><a href="http://www.neveroddoreven.com/openwrt/R7900-system-log.txt">http://www.neveroddoreven.com/openwrt/R … em-log.txt</a></p><p>I didn&#039;t especially select anything or run commands that I believe involve JFFS2 on OpenWRT.&nbsp; It could be that my past attempts to install R8000 DD-WRT were what caused the JFFS2 issues.&nbsp; I wish I saved the stock image logs that printed the error.</p><p>EDIT:&nbsp; I found the log snippet below from elsewhere on the Internet, which is exactly what the stock image was printing to serial console (except the hex values were different).&nbsp; The first line repeats several dozen times with the address number incrementing by some offset each time, then the second line prints once.&nbsp; This kept going on for quite a number of seconds, I would just walk away after awhile and it would eventually stop.</p><p>159 [&nbsp; &nbsp; 3.010000] jffs2: jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00000030: 0xe039 instead <br />160 [&nbsp; &nbsp; 3.020000] jffs2: Further such events for this erase block will not be printed</p><p>EDIT2: it occurred to me that the stock Netgear firmware is looking for it&#039;s own magic JFFS2 byte sequence, not the DEADC0DE sequence set at the end-of-partition by OpenWRT. It seems that whatever/wherever it used to be, it got overwritten during OpenWRT installation, and reflashing back to stock didn&#039;t re-add it where it needs to be.</p>											<p class="post-edited">(Last edited by <strong>neveroddoreven</strong> on 18 May 2016, 09:01)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324963">
				<div class="post-metadata">
					<div class="post-num">Post #31</div>
					<div class="post-author">Zajec</div>
					<div class="post-datetime">
						20 May 2016, 15:50					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>neveroddoreven wrote:</cite><blockquote><p>System logs with kernel logs at top, a few UUID and MAC/IPV6 redacted, nothing else.<br /><a href="http://www.neveroddoreven.com/openwrt/R7900-system-log.txt">http://www.neveroddoreven.com/openwrt/R … em-log.txt</a></p></blockquote></div><p>This is the important part:</p><div class="codebox"><pre><code>Mon May 16 04:55:21 2016 kern.info kernel: [   12.467777] brcmfmac 0000:01:00.0: enabling device (0140 -&gt; 0142)
Mon May 16 04:55:21 2016 kern.warn kernel: [   12.791263] brcmfmac 0000:01:00.0: Direct firmware load for brcm/brcmfmac43602-pcie.txt failed with error -2
Mon May 16 04:55:21 2016 kern.warn kernel: [   12.801176] brcmfmac 0000:01:00.0: Falling back to user helper
Mon May 16 04:55:21 2016 kern.err kernel: [   12.842681] firmware brcm!brcmfmac43602-pcie.txt: firmware_loading_store: map pages failed
Mon May 16 04:55:21 2016 kern.err kernel: [   15.020119] brcmfmac: brcmf_msgbuf_query_dcmd: Timeout on response for query command
Mon May 16 04:55:21 2016 kern.err kernel: [   15.027891] brcmfmac: brcmf_c_preinit_dcmds: Retreiving cur_etheraddr failed, -5
Mon May 16 04:55:21 2016 kern.err kernel: [   15.035322] brcmfmac: brcmf_bus_start: failed: -5
Mon May 16 04:55:21 2016 kern.err kernel: [   15.040047] brcmfmac: brcmf_pcie_attach_bus: dongle is not responding
Mon May 16 04:55:21 2016 kern.info kernel: [   17.620229] pci 0001:00:00.0: enabling device (0140 -&gt; 0142)
Mon May 16 04:55:21 2016 kern.info kernel: [   17.625915] pci 0001:01:00.0: enabling device (0140 -&gt; 0142)
Mon May 16 04:55:21 2016 kern.info kernel: [   17.631623] pci 0001:02:01.0: enabling device (0140 -&gt; 0142)
Mon May 16 04:55:21 2016 kern.info kernel: [   17.637310] brcmfmac 0001:03:00.0: enabling device (0140 -&gt; 0142)
Mon May 16 04:55:21 2016 kern.warn kernel: [   17.791858] brcmfmac 0001:03:00.0: Direct firmware load for brcm/brcmfmac43602-pcie.txt failed with error -2
Mon May 16 04:55:21 2016 kern.warn kernel: [   17.801777] brcmfmac 0001:03:00.0: Falling back to user helper
Mon May 16 04:55:21 2016 kern.err kernel: [   17.814636] firmware brcm!brcmfmac43602-pcie.txt: firmware_loading_store: map pages failed
Mon May 16 04:55:21 2016 kern.err kernel: [   20.000118] brcmfmac: brcmf_msgbuf_query_dcmd: Timeout on response for query command
Mon May 16 04:55:21 2016 kern.err kernel: [   20.007894] brcmfmac: brcmf_c_preinit_dcmds: Retreiving cur_etheraddr failed, -5
Mon May 16 04:55:21 2016 kern.err kernel: [   20.015323] brcmfmac: brcmf_bus_start: failed: -5
Mon May 16 04:55:21 2016 kern.err kernel: [   20.020050] brcmfmac: brcmf_pcie_attach_bus: dongle is not responding
Mon May 16 04:55:21 2016 kern.info kernel: [   22.790196] pci 0001:02:02.0: enabling device (0140 -&gt; 0142)
Mon May 16 04:55:21 2016 kern.info kernel: [   22.795886] brcmfmac 0001:04:00.0: enabling device (0140 -&gt; 0142)
Mon May 16 04:55:21 2016 kern.warn kernel: [   22.951794] brcmfmac 0001:04:00.0: Direct firmware load for brcm/brcmfmac43602-pcie.txt failed with error -2
Mon May 16 04:55:21 2016 kern.warn kernel: [   22.961715] brcmfmac 0001:04:00.0: Falling back to user helper
Mon May 16 04:55:21 2016 kern.err kernel: [   22.974725] firmware brcm!brcmfmac43602-pcie.txt: firmware_loading_store: map pages failed
Mon May 16 04:55:21 2016 kern.err kernel: [   25.160120] brcmfmac: brcmf_msgbuf_query_dcmd: Timeout on response for query command
Mon May 16 04:55:21 2016 kern.err kernel: [   25.167893] brcmfmac: brcmf_c_preinit_dcmds: Retreiving cur_etheraddr failed, -5
Mon May 16 04:55:21 2016 kern.err kernel: [   25.175324] brcmfmac: brcmf_bus_start: failed: -5
Mon May 16 04:55:21 2016 kern.err kernel: [   25.180043] brcmfmac: brcmf_pcie_attach_bus: dongle is not responding</code></pre></div><p>Unfortunately 15.05.1 is missing following commit:<br /><a href="http://git.openwrt.org/?p=15.05/openwrt.git;a=commitdiff;h=2e7914da7d05a73b311198d789a306bb7d8bc729">http://git.openwrt.org/?p=15.05/openwrt … bb7d8bc729</a><br />r49173</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p325404">
				<div class="post-metadata">
					<div class="post-num">Post #32</div>
					<div class="post-author">neveroddoreven</div>
					<div class="post-datetime">
						23 May 2016, 07:25					</div>
				</div>
				<div class="post-content content">
					<p>I tried building the image with the patch you linked, but still no wifi.&nbsp; Can you help me get unstuck?&nbsp; What did I miss?&nbsp; Do I need a particular .config file?&nbsp; Here&#039;s what I did.</p><p># follow wiki instructions for building OpenWRT -- <a href="https://wiki.openwrt.org/doc/howto/buildroot.exigence">https://wiki.openwrt.org/doc/howto/buildroot.exigence</a><br /># install build toolchain packages on Ubuntu 14.04 LTS (I already had most of them)<br />git clone <a href="https://git.openwrt.org/openwrt.git">https://git.openwrt.org/openwrt.git</a><br />cd openwrt/<br />./scripts/feeds update -a<br />./scripts/feeds install -a<br />make menuconfig<br />## set the target system to Broadcom BCM47xx/53xx (ARM), save to .config, and don&#039;t change anything else<br />make<br />## install built chk image onto R7900, to just make sure the unmodifed trunk build is basically working<br />## same errors as before, wifi detect returns nothing<br />## now try applying the patches<br />make target/linux/update package/index V=s QUILT=1<br />make world<br />## install chk image onto R7900.. still no wlan working, same errors as before, wifi detect returns nothing<br />## opkg update/install luci, OpenWRT luci page shows its running Designated Driver build 49377<br />## maybe I got the wrong patches, try adding another directory<br />make target/linux/update target/linux/brcm47xx package/index V=s QUILT=1<br />make clean<br />make menuconfig<br />make world<br />## still not working, same errors</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p334648">
				<div class="post-metadata">
					<div class="post-num">Post #33</div>
					<div class="post-author">russjunk</div>
					<div class="post-datetime">
						16 Aug 2016, 00:33					</div>
				</div>
				<div class="post-content content">
					<p>Hi - I&#039;m wondering if you were successful in getting OpenWRT working on the R7900, or if you gave up?</p><p>Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p337050">
				<div class="post-metadata">
					<div class="post-num">Post #34</div>
					<div class="post-author">neveroddoreven</div>
					<div class="post-datetime">
						3 Sep 2016, 05:31					</div>
				</div>
				<div class="post-content content">
					<p>Designated Driver trunk build 49918 has a prebuilt R7900 chk image that is now working for me, as of 2-Sep-2016.<br /><a href="https://downloads.openwrt.org/snapshots/trunk/bcm53xx/generic/openwrt-bcm53xx-netgear-r7900-squashfs.chk">https://downloads.openwrt.org/snapshots … uashfs.chk</a></p><p>I suspect the problem was me.&nbsp; Specifically, in my having forcibly flashed an R8000 chk build back in 15.05 (dot-naught) before R7900 was supported.&nbsp; My settings, NVRAM, radios got partially hosed somehow.&nbsp; I was able to get it fully recovered and working in OpenWRT today like so.</p><p>0) You must be using a wired Ethernet cable to your PC, and auto DHCP to get your IP address from the router.</p><p>1) Flash the latest Netgear stock R7900-V1.0.1.4_10.0.12.chk build from their website.&nbsp; If you already flashed an OpenWRT build, be sure to uncheck &quot;keep settings&quot;.&nbsp; Wait a few minutes after the flash completes.</p><p>2) Release/renew your PC IP address (or re-plug your Ethernet cable) and visit 192.168.1.1. Wait for router to finish detecting its network environment.</p><p>3) In Netgear&#039;s new router wizard, tell the router you will configure Internet yourself.&nbsp; Log in with defaults of &quot;admin&quot; / &quot;password&quot;.&nbsp; Go to Advanced tab, click the Administration section on the left, then choose Backup Settings. Click Erase on the right and confirm your choice.&nbsp; Wait a few minutes.</p><p>4) Repeat steps 1 and 3 again to erase a second time.</p><p>5) Repeat step 1 only to erase a third time.&nbsp; While you are waiting this time for the router to erase/reboot, you should also power off your cable modem for ten second and power it back on, to ensure Netgear fully goes through their config from a clean state.</p><p>6) Walk through the Netgear genie configuration and pick the autoconfigure settings that are closest to your desired situation (don&#039;t use &quot;I&#039;ll do it myself&quot;).&nbsp; Once it gets to downloading Netgear software to your PC, just ignore the download and continue on, then skip the Netgear account creation part.&nbsp; You&#039;ll be misdirected to Netgear&#039;s own website.</p><p>7) Return to the router portal 192.168.1.1. Go to the Advanced tab.&nbsp; You need to write down the following for future reuse:<br />LAN Port MAC address<br />Internet Port MAC address (this is your WAN port)<br />2.4GHz channel, usually Auto<br />5GHz channel list, for example &quot;36 + 40 + 44(P) + 48&quot;<br />5GHz Second Radio channel list, for example &quot;149 + 153(P) + 157 + 161&quot;</p><p>8) Perform another router upgrade with the same latest Netgear stock R7900-V1.0.1.4_10.0.12.chk build.&nbsp; You don&#039;t need to factory erase the settings this time.</p><p>9) By now the router should be fully reverted to normal stock functionality.&nbsp; You can now flash to the latest trunk Designated Driver R7900 chk build.</p><p>10) After flashing OpenWRT, wait a few minutes, then unplug your cable modem for 10 seconds again, then replug.&nbsp; Wait awhile until you&#039;re sure the Internet is being provided to the router.</p><p>11) Follow these steps in the SSH terminal to enable the web interface:<br /></p><div class="codebox"><pre><code>passwd          (and set a new secure password)
opkg update     (stuff should download from Internet -- if not, wait awhile, press ctrl-C and try again)
opkg install luci
/etc/init.d/uhttpd start
/etc/init.d/uhttpd enable</code></pre></div><p>12) In your browser, open 192.168.1.1 and log in.&nbsp; Scroll down, you should see three Wireless interfaces radio0, radio1 and radio2.</p><p>13) Go to Network &gt; Interfaces.&nbsp; Click on the Edit button for LAN interface, then go to Advanced tab.&nbsp; In the &quot;Override MAC address&quot; field, paste the LAN MAC address that you copied from the stock Netgear settings.&nbsp; Click Save and Apply.&nbsp; Note it might take a few moments to take effect in the Interfaces list.</p><p>14) Repeat step 13 for the WAN interface, using the Internet (WAN) MAC address from stock Netgear.&nbsp; Go back to the Network &gt; Interfaces page, you&#039;ll see this change automatically also get applied to WAN6 interface.&nbsp; After the updated WAN MAC address is displaying, reboot your cable modem.</p><p>15) Verify you have working Internet after the cable modem finishes booting up.&nbsp; Go to System &gt; Backup and download a backup archive.&nbsp; Go to System &gt; Reboot and perform a reboot of the router only (don&#039;t touch the cable modem).</p><p>16) After the router reboots, check in Network &gt; Interfaces that your override MAC addresses are still there for LAN and WAN.&nbsp; Your Internet should continue working without needing any more cable modem reboots.</p><p>After this point, I tinkered around with the Network &gt; Wireless for quite some time and never got working WLAN using the GUI.&nbsp; I used the SSH terminal instead to configure WLAN and it works fine now.<br />Use vim in the SSH shell to edit /etc/config/wireless as follows.&nbsp; Maybe it&#039;s best to use the leftmost channel number from the Netgear stock channels you wrote down earlie in step 7.&nbsp; Radio0 must be &gt;148, and radio2 must be &lt;149.&nbsp; Save the file, then issue a reboot. Ta-da! Working 2.4 and dual-radio 5GHz WLAN.</p><div class="codebox"><pre><code>config wifi-device &#039;radio0&#039;
        option type &#039;mac80211&#039;
        option hwmode &#039;11a&#039;
        option path &#039;18000000.axi/bcma0:7/pci0000:00/0000:00:00.0/0000:01:00.0&#039;
        option txpower &#039;20&#039;
        option country &#039;00&#039;
        option channel &#039;149&#039;
        option htmode &#039;VHT80&#039;

config wifi-iface
        option device &#039;radio0&#039;
        option network &#039;lan&#039;
        option mode &#039;ap&#039;
        option key &#039;A stupid phrase that gets laughs&#039;
        option ssid &#039;My Witty SSID-5G&#039;
        option encryption &#039;psk2&#039;

config wifi-device &#039;radio1&#039;
        option type &#039;mac80211&#039;
        option path &#039;18000000.axi/bcma0:8/pci0001:00/0001:00:00.0/0001:01:00.0/0001:02:01.0/0001:03:00.0&#039;
        option hwmode &#039;11g&#039;
        option channel &#039;6&#039;
        option htmode &#039;HT20&#039;
        option txpower &#039;20&#039;
        option country &#039;00&#039;

config wifi-iface
        option device &#039;radio1&#039;
        option network &#039;lan&#039;
        option mode &#039;ap&#039;
        option key &#039;A stupid phrase that gets laughs&#039;
        option ssid &#039;My Witty SSID&#039;
        option encryption &#039;psk2&#039;

config wifi-device &#039;radio2&#039;
        option type &#039;mac80211&#039;
        option hwmode &#039;11a&#039;
        option path &#039;18000000.axi/bcma0:8/pci0001:00/0001:00:00.0/0001:01:00.0/0001:02:02.0/0001:04:00.0&#039;
        option htmode &#039;VHT80&#039;
        option txpower &#039;20&#039;
        option country &#039;00&#039;
        option channel &#039;36&#039;

config wifi-iface
        option device &#039;radio2&#039;
        option network &#039;lan&#039;
        option mode &#039;ap&#039;
        option ssid &#039;My Witty SSID-5G&#039;
        option encryption &#039;psk2&#039;
        option key &#039;A stupid phrase that gets laughs&#039;</code></pre></div>											<p class="post-edited">(Last edited by <strong>neveroddoreven</strong> on 24 Sep 2016, 02:46)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p337052">
				<div class="post-metadata">
					<div class="post-num">Post #35</div>
					<div class="post-author">neveroddoreven</div>
					<div class="post-datetime">
						3 Sep 2016, 07:07					</div>
				</div>
				<div class="post-content content">
					<p>The 2.4GHz isn&#039;t stable, especially after having added a second guest SSID to it.&nbsp; It keeps slipping into Client mode, even though it&#039;s marked to be the Master as an AP.</p><p>UPDATE:&nbsp; I&#039;ve got 2.4GHz running again.&nbsp; It turns out that, any time I use Luci web GUI to make any WLAN edits (even just disable/enable a radio), it overwrites the following two settings.&nbsp; I just have to change them back, reboot, and the 2.4GHz starts working again.</p><p>config wifi-device &#039;radio1&#039;<br />...<br />...<br />&nbsp; &nbsp; &nbsp; &nbsp; option channel &#039;6&#039;&nbsp; &lt;&lt;&lt; Luci overwrites this as &quot;(Auto)&quot; which breaks things<br />&nbsp; &nbsp; &nbsp; &nbsp; option hwmode &#039;11g&#039;&nbsp; &nbsp; &lt;&lt;&lt; Luci overwrites this as &quot;11a&quot; which breaks things</p>											<p class="post-edited">(Last edited by <strong>neveroddoreven</strong> on 3 Sep 2016, 08:18)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p352524">
				<div class="post-metadata">
					<div class="post-num">Post #36</div>
					<div class="post-author">lmasieri</div>
					<div class="post-datetime">
						20 Feb 2017, 21:56					</div>
				</div>
				<div class="post-content content">
					<p>Any update of where the development of the r7900 is at? Is it safe to install at this point?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p367768">
				<div class="post-metadata">
					<div class="post-num">Post #37</div>
					<div class="post-author">neveroddoreven</div>
					<div class="post-datetime">
						2 Nov 2017, 21:30					</div>
				</div>
				<div class="post-content content">
					<p>Necro-bump.&nbsp; I&#039;ve been using the R7900 version below since it was released and it&#039;s fairly stable.&nbsp; Every two to three months something happens that I don&#039;t bother troubleshooting -- I just reboot the cable modem and router together, and it starts working again.&nbsp; Usually this is when I have tons of heavy data WLAN traffic.&nbsp; Most of my traffic is over wired and working fine.</p><p>OpenWrt Designated Driver 49941 / LuCI Master (git-16.271.33274-ddb98f1)</p><p>Today I&#039;ve got some sort of switch or client problem in the house that causes a packet storm and then the router stops serving traffic.&nbsp; I will try updating to a new version.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p367828">
				<div class="post-metadata">
					<div class="post-num">Post #38</div>
					<div class="post-author">neveroddoreven</div>
					<div class="post-datetime">
						4 Nov 2017, 03:51					</div>
				</div>
				<div class="post-content content">
					<p>I took the plunge and updated to the trunk build on 2017-11-01, which includes the patch for the recently released KRACK WPA2 exploit.<br />OpenWrt Designated Driver 50129 / LuCI Master (git-16.271.33274-ddb98f1) </p><p>I just downloaded the R7900 build from here and used the LuCI web interface to upload the new image and perform the built-in sysupgrade.<br /><a href="https://downloads.openwrt.org/snapshots/trunk/bcm53xx/generic/">https://downloads.openwrt.org/snapshots … x/generic/</a></p><p>Things seem to be working fine but it&#039;s only been about ten minutes (-:</p><p>After the upgrade, I had to reinstall LuCI from the terminal, then reinstall the following packages that I was previously using, and reboot.&nbsp; Other than that, everything was where I left it, and the USB-based overlay filesystem continued working without skipping a beat.</p><p>opkg update<br />opkg install luci<br />opkg install block-mount kmod-fs-ext4 kmod-usb-storage-extras kmod-usb2 luci-app-openvpn luci-app-wol openvpn-easy-rsa openvpn-openssl sslh zile<br />reboot</p><br /><p>For those starting from scratch with R7900, you can just follow the same verbose instructions I wrote in post 34 above, and also the workaround adjustment in post 35 every time after using LuCI to adjust any WLAN settings.</p><p>If you see no further posts from me in the coming months, you may assume everything is working fine for me with no new issues besides a random reboot needed every few months after super-heavy WLAN data traffic (say, backing up many gigs of data wirelessly all at a time, which crashes the WLAN interfaces)</p><p>EDIT:&nbsp; I am using block-mount and fstab to automount USB stick ext4 partitions for overlay filesystem (to add space for logs and lots of opkg packages).&nbsp; After I finished the sysupgrade via LuCI, block mount was not working, and the extra /dev/sda2 data partition was not mounted, resulting in loss of some configs.&nbsp; I fixed this by doing:<br />opkg --force-reinstall install block-mount</p><p>This restored proper mounts using /etc/fstab and mounted my data partition.&nbsp; From there, I rebooted, then I used opkg to list-upgradable, then I used opkg to upgrade all the reported packages, followed by a reboot.&nbsp; LuCI stopped working after the upgrades, so I forced those to reinstall and that sorted things out:<br />opkg --force-reinstall install luci uhttpd uhttpd-mod-ubus luci-mod-admin-full luci-theme-bootstrap luci-app-firew<br />all luci-proto-ppp libiwinfo-lua</p>											<p class="post-edited">(Last edited by <strong>neveroddoreven</strong> on 4 Nov 2017, 19:00)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 2 of 2</div><nav><ul><li><a href="viewtopic.php%3Fid=64056&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>