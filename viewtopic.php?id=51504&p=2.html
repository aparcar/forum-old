<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> WNR1000v2: some success! (need advice on board-specific init)</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 16 Apr 2018 and 18 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 2 of 2</div><nav><ul><li><a href="viewtopic.php%3Fid=51504&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p265938">
				<div class="post-metadata">
					<div class="post-num">Post #26</div>
					<div class="post-author">SaltwaterC</div>
					<div class="post-datetime">
						17 Feb 2015, 18:31					</div>
				</div>
				<div class="post-content content">
					<p>I also used a Mac a few times (MBA + Apple USB Ethernet adapter), but I didn&#039;t get the transfer timeout. In fact, the only time when I had an issue was with Kali Linux using Wicd as network manager as it decided that the connection was lost (it wasn&#039;t) and it started to connect to my wireless instead. I got a corrupted firmware, but the device booted in failsafe mode and I could recover it easily.</p><p>I guess you could try disabling all the network interfaces except for the ethernet as the network manager may try to be a little bit more helpful than it should be. I don&#039;t think it&#039;s a firewall issue as the default from OS X only blocks incoming connections, but it wouldn&#039;t hurt to disable it for a flash.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p265942">
				<div class="post-metadata">
					<div class="post-num">Post #27</div>
					<div class="post-author">jlpapple</div>
					<div class="post-datetime">
						17 Feb 2015, 19:19					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for the quick reply. I&#039;ve had some limited success, with the router now accepting some data from the computer. However, partially through the process to send (or receive?) seems to timeout after it has sent &quot;block=13&quot;. See below.</p><p>Any other advice? Do I need to unlock the router via Telnet first? (As described in <a href="http://wiki.openwrt.org/toh/netgear/telnet.console)">http://wiki.openwrt.org/toh/netgear/telnet.console)</a></p><p>I will disable the other network interfaces on the Mac, just in case.</p><div class="codebox"><pre><code>tftp&gt; put /Users/jp/Downloads/openwrt-ar71xx-generic-wnr1000v2-vc-squashfs-factory.img 
sent WRQ &lt;file=/Users/jp/Downloads/openwrt-ar71xx-generic-wnr1000v2-vc-squashfs-factory.img, mode=octet&gt;
received ACK &lt;block=0&gt;
sent DATA &lt;block=1, 512 bytes&gt;
received ACK &lt;block=1&gt;
sent DATA &lt;block=2, 512 bytes&gt;
sent DATA &lt;block=2, 512 bytes&gt;
received ACK &lt;block=1&gt;
discarded 1 packets
sent DATA &lt;block=2, 512 bytes&gt;
sent DATA &lt;block=2, 512 bytes&gt;
received ACK &lt;block=2&gt;
sent DATA &lt;block=3, 512 bytes&gt;
received ACK &lt;block=3&gt;
sent DATA &lt;block=4, 512 bytes&gt;
received ACK &lt;block=4&gt;
sent DATA &lt;block=5, 512 bytes&gt;
received ACK &lt;block=5&gt;
sent DATA &lt;block=6, 512 bytes&gt;
received ACK &lt;block=6&gt;
sent DATA &lt;block=7, 512 bytes&gt;
received ACK &lt;block=7&gt;
sent DATA &lt;block=8, 512 bytes&gt;
received ACK &lt;block=8&gt;
sent DATA &lt;block=9, 512 bytes&gt;
received ACK &lt;block=9&gt;
sent DATA &lt;block=10, 512 bytes&gt;
received ACK &lt;block=10&gt;
sent DATA &lt;block=11, 512 bytes&gt;
received ACK &lt;block=11&gt;
sent DATA &lt;block=12, 512 bytes&gt;
received ACK &lt;block=12&gt;
sent DATA &lt;block=13, 512 bytes&gt;
received ACK &lt;block=12&gt;
sent DATA &lt;block=13, 512 bytes&gt;
sent DATA &lt;block=13, 512 bytes&gt;
sent DATA &lt;block=13, 512 bytes&gt;
sent DATA &lt;block=13, 512 bytes&gt;
sent DATA &lt;block=13, 512 bytes&gt;
Transfer timed out. </code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p265947">
				<div class="post-metadata">
					<div class="post-num">Post #28</div>
					<div class="post-author">jlpapple</div>
					<div class="post-datetime">
						17 Feb 2015, 20:38					</div>
				</div>
				<div class="post-content content">
					<p>FIXED!</p><p>I downgraded to Netgear Firmware WNR1000v2-VC-V1.0.0.3NA, then retried the tftp upload. Worked like a charm!</p><p>Note, the firmware that I had been running on the 1000v2-VC was WNR1000v2-VC-V1.1.2.56. If a user is also running this identical firmware, they may encounter the same tftp issues that I did.</p><p>Now running&nbsp; CHAOS CALMER (Bleeding Edge, r44455) on this WNR1000v2-VC.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p266685">
				<div class="post-metadata">
					<div class="post-num">Post #29</div>
					<div class="post-author">jlpapple</div>
					<div class="post-datetime">
						24 Feb 2015, 00:45					</div>
				</div>
				<div class="post-content content">
					<p>How do you incorproate your WNR1000V2 patch into Image Generator for OpenWRT? When I use Imager Generator currently there is no WNR1000V2 bin file created when using the &quot;Minimal&quot; profile.</p><p> I can compile it with no problem, but I&#039;d like to be able to use the Image Generator. Thanks</p>											<p class="post-edited">(Last edited by <strong>jlpapple</strong> on 24 Feb 2015, 00:49)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p266741">
				<div class="post-metadata">
					<div class="post-num">Post #30</div>
					<div class="post-author">SaltwaterC</div>
					<div class="post-datetime">
						24 Feb 2015, 14:20					</div>
				</div>
				<div class="post-content content">
					<p>TBH, I did&#039;t use the Image Generator. I simply used WNR2000v3/WNR612v2 as template for adding the devices and I simply assume that all the bits are in place. I&#039;ll need to see how it works, but I don&#039;t know when I&#039;m going to be able to do it.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p270335">
				<div class="post-metadata">
					<div class="post-num">Post #31</div>
					<div class="post-author">supertanker</div>
					<div class="post-datetime">
						29 Mar 2015, 01:00					</div>
				</div>
				<div class="post-content content">
					<p>Wow! Glad to see this thread perked up. Having real OpenWRT support might keep these devices out of the landfill. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>I&#039;m pretty happy with it. It&#039;s been running like a champ with my hacked up image since I last posted. I wish I had known enough to contribute a fully working patch when I got it running. Sadly, once I had time to work on the thing again, I couldn&#039;t find my img file or the buildroot I had used.</p><p>It did hiccup last week: I managed to trigger a bug similar to this one. <a href="https://dev.openwrt.org/ticket/6754">https://dev.openwrt.org/ticket/6754</a></p><p>I had a Minecraft server running on a machine behind the AP and I was spamming creepers. Apparently lots of small packets makes the radio furious. Although on a second thought, I SSH&#039;d into the thing to reset it, so obviously the radio was working...maybe the switch crashed then? I&#039;ll have to do more testing to find out. I distinctly remember getting the &quot;transmit queue&quot; error though.</p><p>Thanks for all your hard work SaltwaterC!</p>											<p class="post-edited">(Last edited by <strong>supertanker</strong> on 29 Mar 2015, 01:03)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p273260">
				<div class="post-metadata">
					<div class="post-num">Post #32</div>
					<div class="post-author">windows2000</div>
					<div class="post-datetime">
						21 Apr 2015, 12:51					</div>
				</div>
				<div class="post-content content">
					<p>Does the Wi-Fi work?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p273335">
				<div class="post-metadata">
					<div class="post-num">Post #33</div>
					<div class="post-author">J1mbo</div>
					<div class="post-datetime">
						21 Apr 2015, 22:46					</div>
				</div>
				<div class="post-content content">
					<p>Yes</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p278142">
				<div class="post-metadata">
					<div class="post-num">Post #34</div>
					<div class="post-author">gamax92</div>
					<div class="post-datetime">
						30 May 2015, 08:17					</div>
				</div>
				<div class="post-content content">
					<p>Apologies for bring up a semi dead thread, but wanted to share my findings:</p><div class="codebox"><pre><code>ar7240: (accessable via /sys/class/gpio)
[x] 0 = Internet LED (Amber) [Active low]
[x] 1 = Power LED (Amber) [Active low]
[ ] 2 = 
[ ] 3 = 
[ ] 4 = 
[ ] 5 = 
[x] 6 = Lan Port 1 (Amber) [Active low]
[x] 7 = Lan Port 2 (Amber) [Active low]
[x] 8 = Lan Port 3 (Amber) [Active low]
[ ] 9 = 
[ ] 10 = 
[x] 11 = Power LED (Green) [Active low]
[x] 12 = Lan Port 4 (Amber) [Active low]
[x] 13 = Lan Port 1 (Green) [Active low]
[x] 14 = Lan Port 2 (Green) [Active low]
[x] 15 = Lan Port 3 (Green) [Active low]
[x] 16 = Lan Port 4 (Green) [Active low]
[x] 17 = Internet LED (Green) [Active low]

ar9285: (accessable via /sys/kernel/debug/ieee80211/phy0/ath9k/(regidx=0x4048,regval))
bits 12 to 21 of regval are gpio 0 to 9
[ ] 0 = 
[x] 1 = Wireless LED [Active high]
[ ] 2 = 
[ ] 3 = 
[ ] 4 = 
[x] 5 = WPS LED [Active low]
[x] 6 = WPS Button [Pressed low]
[x] 7 = Reset Button [Pressed low]
[x] 8 = Wireless Toggle Button [Pressed low]
[ ] 9 = </code></pre></div><p>It seems the gpio available in /sys/devices/gpio does not cover everything, and some is available in the ath9k itself, boxes marked with x are confirmed. As you can probably guess I have one of these routers, the VC version, and I&#039;m willing to test specific stuff if wanted.</p><p>EDIT: After fiddling with 0x18040028 (GPIO_FUNCTION_1, 0x8040028 in ath9k&#039;s regidx file) I managed to get all of the LED&#039;s to turn on and be changeable, added all other LAN Port gpio&#039;s and Internet LED green gpio</p>											<p class="post-edited">(Last edited by <strong>gamax92</strong> on 30 May 2015, 09:17)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p280259">
				<div class="post-metadata">
					<div class="post-num">Post #35</div>
					<div class="post-author">SaltwaterC</div>
					<div class="post-datetime">
						16 Jun 2015, 11:26					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>gamax92 wrote:</cite><blockquote><p>Apologies for bring up a semi dead thread</p></blockquote></div><p>Nah, I can&#039;t say it&#039;s actually dead.</p><div class="quotebox"><cite>gamax92 wrote:</cite><blockquote><p>added all other LAN Port gpio&#039;s and Internet LED green gpio</p></blockquote></div><p>Thanks for the work you put in to reveal how GPIO actually works on these devices. By &quot;added&quot; you mean there&#039;s an actual patch for OpenWrt? If there&#039;s none, I could take a stab at this, but unfortunately the device is quite far away for the moment and I won&#039;t get my hands on my kit sooner than end of July.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p281454">
				<div class="post-metadata">
					<div class="post-num">Post #36</div>
					<div class="post-author">SillyBastard</div>
					<div class="post-datetime">
						26 Jun 2015, 12:22					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve been playing with this for a few hours now, and I finally figured out my issue. Thought I&#039;d post to help someone with the same issue. </p><p>I have two WNR1000v2 routers that I&#039;ve collected @ garage sales recently, and have been unable to do anything use with them until now. </p><p>I was trying to use tftp, as instructed in the gist here: <a href="https://gist.github.com/SaltwaterC/ef49c8a4df81c8896153">https://gist.github.com/SaltwaterC/ef49c8a4df81c8896153</a>&nbsp; with no success. From everything I can observe, what I have is a pair of WNR1000v2 routers, with no mention whatsoever of &quot;VC&quot;. The problem is that I let the auto check updater&nbsp; update them to version 1.2.2.73 (I think), and everything in the gist mentions v1.1.x.x... </p><p>what I would get was basically the same output as posted by jlpapple above. finally I found a post somewhere that mentioned doing a 30-30-30 reset, and then trying the tftp put operation. That would get me to uploading the firmware, but it would fail every time, with the green light blinking.. </p><p>I ended up googling a bit, and finding v1.2.2.56 of the firmware. I figured I&#039;d see if that would upload, and then figure out the difference between the two, and do some hacking... what I failed to notice (thank you a few trader joe&#039;s 9% beers) was tt v1.2.2.256 firmware had a &quot;VC&quot; in it.. but it worked.. </p><p>so... hoping that no fuzzy little kittens would actually die, I decided to try and tftp the &quot;-vc&quot; version of the firmware... and it worked! </p><p>I now have two working routers running barrier breaker. </p><p>hope this helps someone.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p286454">
				<div class="post-metadata">
					<div class="post-num">Post #37</div>
					<div class="post-author">shadowmaster63</div>
					<div class="post-datetime">
						5 Aug 2015, 21:03					</div>
				</div>
				<div class="post-content content">
					<div class="codebox"><pre><code>U-Boot 1.1.4 (Sep  3 2009 - 20:04:48)

WNR1000v2 (ar7240) U-boot dni7 V0.8
DRAM:  
sri
#### TAP VALUE 1 = 9, 2 = 9
32 MB
Top of RAM usable for U-Boot at: 82000000
Reserving 269k for U-Boot at: 81fbc000
Reserving 192k for malloc() at: 81f8c000
Reserving 44 Bytes for Board Info at: 81f8bfd4
Reserving 36 Bytes for Global Data at: 81f8bfb0
Reserving 128k for boot params() at: 81f6bfb0
Stack Pointer at: 81f6bf98
Now running in RAM - U-Boot at: 81fbc000
id read 0x100000ff
flash size 4194304, sector count = 64
Flash:  4 MB
In:    serial
Out:   serial
Err:   serial
Net:   ag7240_enet_initialize...
No valid address in Flash. Using fixed address
No valid address in Flash. Using fixed address
eth0: up
: cfg1 0xf cfg2 0x7214їH
eth1: up
ATHRS26: resetting s26
ATHRS26: s26 resэСЃdone</code></pre></div><p>and..... <br />Nothing happens... <br />why :(</p>											<p class="post-edited">(Last edited by <strong>shadowmaster63</strong> on 5 Aug 2015, 21:04)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p296035">
				<div class="post-metadata">
					<div class="post-num">Post #38</div>
					<div class="post-author">jenom</div>
					<div class="post-datetime">
						14 Oct 2015, 20:02					</div>
				</div>
				<div class="post-content content">
					<p>looks like boot failed before copuld:</p><p> Verifying Checksum ... OK<br />### SQUASHFS loading &#039;image/uImage&#039; to 0x80800000<br />### SQUASHFS load complete: 708303 bytes loaded to 0x80800000<br />## Booting image at 80800000 ...</p><p>so it can not read/load something called uImage.......missing / damaged<br />if you read this post from the beginning, that is a very bad news....</p>											<p class="post-edited">(Last edited by <strong>jenom</strong> on 14 Oct 2015, 20:16)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p296041">
				<div class="post-metadata">
					<div class="post-num">Post #39</div>
					<div class="post-author">jenom</div>
					<div class="post-datetime">
						14 Oct 2015, 20:31					</div>
				</div>
				<div class="post-content content">
					<p>I have also a WNR1000v2...trying to put OpenWrt...downloaded all available files &quot;openwrt-ar71xx-generic-wnr1000v2-&quot;<br />from &quot;latest&quot;+&quot;trunk&quot;+&quot;chaos_calm&quot;<br />Collected Netgears firmwares: 1.0.1.1+1.1.2.28+1.1.2.50+1.1.2.54<br />Upgrades from WebInterface failed with any combinations of the above files: rejected with BAD IMAGE message</p><p>Going to run Windoz &quot;TelnetEnable.exe&quot; later today, and try to do &quot;tptp&quot; transfer<br />Is the command&nbsp; &quot;tftp -i 192.168.1.1 PUT openwrt-xxxx.img&quot; ?</p><p>Noticed, that holding RESET button at boot does not change the color of PW light, so maybe no &quot;tftp &quot; at boot ?</p><p>Thanks</p>											<p class="post-edited">(Last edited by <strong>jenom</strong> on 14 Oct 2015, 20:33)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p296197">
				<div class="post-metadata">
					<div class="post-num">Post #40</div>
					<div class="post-author">J1mbo</div>
					<div class="post-datetime">
						16 Oct 2015, 00:17					</div>
				</div>
				<div class="post-content content">
					<p>I posted the full console output of the very similar WN604, here: <a href="https://forum.openwrt.org/viewtopic.php?id=55144">https://forum.openwrt.org/viewtopic.php?id=55144</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p349147">
				<div class="post-metadata">
					<div class="post-num">Post #41</div>
					<div class="post-author">pika28</div>
					<div class="post-datetime">
						12 Jan 2017, 17:28					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>I will start by apologizing if the answer has already been asked. I also apologize for the quality of my English. I am French and I use Google translation to understand you.</p><p>I retrieved a Netgear WNR1000v2 router. I tried to flasher it once. Photo of patience, I blocked this one.</p><p>I managed with the recovery tool to reset the latest firmware. Since then, I can not make new attempts. When I try to install the latest version of OpenWRT, the mistletoe tells me: &quot;your * .img file is not good.&quot;</p><p>Thank you for your help</p><p>Cédric</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p349209">
				<div class="post-metadata">
					<div class="post-num">Post #42</div>
					<div class="post-author">pika28</div>
					<div class="post-datetime">
						13 Jan 2017, 09:11					</div>
				</div>
				<div class="post-content content">
					<p>Up :-)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p349213">
				<div class="post-metadata">
					<div class="post-num">Post #43</div>
					<div class="post-author">pika28</div>
					<div class="post-datetime">
						13 Jan 2017, 11:10					</div>
				</div>
				<div class="post-content content">
					<p>hostingpics.net/viewer.php?id=202268Sanstitre1.jpg</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 2 of 2</div><nav><ul><li><a href="viewtopic.php%3Fid=51504&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>