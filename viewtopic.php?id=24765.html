<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> building Kamikaze!</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 1 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p109122">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">aztroboy</div>
					<div class="post-datetime">
						15 May 2010, 03:36					</div>
				</div>
				<div class="post-content content">
					<p>Hello! I&#039;ve downloaded Kamikaze from the svn repository. So I&#039;m ready to build it on CentOS. I&#039;m kinda newb on both.</p><p>Here&#039;s the catch: I&#039;m trying to build Kamikaze so that it would let me compile C files within the OS.</p><p>As far as I understand, I should run &quot;make menuconfig&quot; to display the options and include a compiler in the toolchain/list...</p><p>However, as soon as I do it, it prompts:</p><div class="codebox"><pre><code>Checking &#039;non-root&#039;... failed.

Build dependency: Please do not compile as root.

Prerequisite check failed. Use FORCE=1 to override.
make: *** [tmp/.prereq-build] Error 1</code></pre></div><p>Basically, two questions:</p><p>1) Do I need to run &quot;make menuconfig&quot; to select a C compiler? If I should, how can I fix this &quot;non-root&quot; problem?</p><p>2) If I just ran &quot;make&quot;, would it build Kamikaze with a C compiler?</p><br /><p>thanks in advance.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p109138">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">playdude</div>
					<div class="post-datetime">
						15 May 2010, 11:32					</div>
				</div>
				<div class="post-content content">
					<div class="codebox"><pre><code>Build dependency: Please do not compile as root.</code></pre></div><p>That&#039;s the hint. You need to run make menuconfig as a normal user, not root because it&#039;s very dangerous to do it as root.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p109171">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">aztroboy</div>
					<div class="post-datetime">
						16 May 2010, 07:19					</div>
				</div>
				<div class="post-content content">
					<p>hey! thanks for replying... I&#039;m going to give it a try again..</p><p>I&#039;ve also read that it&#039;s also possible to use the SDK to make some sort of cross-compiling to build&amp;run C files in OpenWRT.</p><p>Now, what would you recommend? Building my own Kamikaze firmware with the C compiler OR using an SDK in another linux box?</p><p>thanks again.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p109214">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">mohnkhan</div>
					<div class="post-datetime">
						17 May 2010, 08:05					</div>
				</div>
				<div class="post-content content">
					<p>1. I would recommend you to build your own backfire image and not kamikaze, because it the latest and the greatest.<br />2. use your machine to compile programs and put them in the router.&nbsp; (I can help you out with this)<br />&nbsp; you don&#039;t even need SDK to do this. just one simple trick will make you compile any C/C++&nbsp; program for the target router.<br /> with all the speed and benefits of a fast development box</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p109263">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">aztroboy</div>
					<div class="post-datetime">
						17 May 2010, 20:32					</div>
				</div>
				<div class="post-content content">
					<p>Hi mohnkhan! Basically, what I would like to do is to create a development enviroment (with or without the SDK as you said) so that I can create programs that could run on an WRT54GL router with Kamikaze.</p><p>Thank you for your help, can you please instruct me on how to start? I tried the &quot;tutorial&quot; on how to build by downloading the SDK with no success.</p><p>So what is that trick you say? <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><br /><p>thank you in advance</p><p>Edit: Oh by the way, I solved the problem of the thread: I created a user (different from root) and tried again: it worked! Still, I cant create a development enviroment to program a WRT54G router =/</p>											<p class="post-edited">(Last edited by <strong>aztroboy</strong> on 17 May 2010, 20:36)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p109289">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">mohnkhan</div>
					<div class="post-datetime">
						18 May 2010, 08:48					</div>
				</div>
				<div class="post-content content">
					<p>Well to build a program for the router you can follow one the steps,<br />1. std right way to build stuff and package it directly for the router using the make files.<br />&nbsp; [the way all the OpenWRT packages are built], building your image ready to install directly.<br />2. SDK route again a standard way. again using some make files and stuff.<br />3. Take short cut routes to achieve your goal.</p><p>let say you wish to compile helloworld.c and you wish to be as lazy as possible and achieve your goal of compiling this program for your target router.<br />1. have a svn copy of the openwrt on your development machine and build a sample image of the target router.<br />&nbsp; [I hope that this is already done on your machine.]<br />&nbsp; &nbsp;This step ensures that the compilers (cross compilers ) are correctly built on your Linux box.<br />2. Use the target cross compiler on your linux box and simple use it to compile your helloworld.c.&nbsp; Bingo you have a working program for your router.<br /> lets go through a example for this using my linux box.</p><br /><p> steps<br />1. svn checkout latest from bakfire/kamikaze/trunk.. your wish<br />2. make menuconfig to select your correct router profile. and build a dummy image which is not what you are interested in.<br />3. go to the staging directory of your build directory structure..<br /></p><div class="codebox"><pre><code>/home/mohnkhan/wrttrunk/trunk
[mohnkhan@localhost trunk]$ ls
bin          build_dir  dl    feeds               include  Makefile  README    scripts      target  toolchain
BSDmakefile  Config.in  docs  feeds.conf.default  LICENSE  package   rules.mk  staging_dir  tmp     tools
[mohnkhan@localhost trunk]$  cd /home/mohnkhan/wrttrunk/trunk/staging_dir/toolchain-mips_r2_gcc-4.3.3+cs_uClibc-0.9.30.1/usr/bin
[mohnkhan@localhost bin]$ pwd
/home/mohnkhan/wrttrunk/trunk/staging_dir/toolchain-mips_r2_gcc-4.3.3+cs_uClibc-0.9.30.1/usr/bin
[mohnkhan@localhost bin]$ ls
ldd                           mips-openwrt-linux-gcc-4.3.3  mips-openwrt-linux-readelf           mips-openwrt-linux-uclibc-cpp        mips-openwrt-linux-uclibc-objcopy
mips-openwrt-linux-addr2line  mips-openwrt-linux-gccbug     mips-openwrt-linux-size              mips-openwrt-linux-uclibc-g++        mips-openwrt-linux-uclibc-objdump
mips-openwrt-linux-ar         mips-openwrt-linux-gcov       mips-openwrt-linux-strings           mips-openwrt-linux-uclibc-gcc        mips-openwrt-linux-uclibc-ranlib
mips-openwrt-linux-as         mips-openwrt-linux-gprof      mips-openwrt-linux-strip             mips-openwrt-linux-uclibc-gcc-4.3.3  mips-openwrt-linux-uclibc-readelf
mips-openwrt-linux-c++        mips-openwrt-linux-ld         mips-openwrt-linux-uclibc-addr2line  mips-openwrt-linux-uclibc-gccbug     mips-openwrt-linux-uclibc-size
mips-openwrt-linux-c++filt    mips-openwrt-linux-nm         mips-openwrt-linux-uclibc-ar         mips-openwrt-linux-uclibc-gcov       mips-openwrt-linux-uclibc-strings
mips-openwrt-linux-cpp        mips-openwrt-linux-objcopy    mips-openwrt-linux-uclibc-as         mips-openwrt-linux-uclibc-gprof      mips-openwrt-linux-uclibc-strip
mips-openwrt-linux-g++        mips-openwrt-linux-objdump    mips-openwrt-linux-uclibc-c++        mips-openwrt-linux-uclibc-ld
mips-openwrt-linux-gcc        mips-openwrt-linux-ranlib     mips-openwrt-linux-uclibc-c++filt    mips-openwrt-linux-uclibc-nm
[mohnkhan@localhost bin]$ 
[mohnkhan@localhost bin]$ ./mips-openwrt-linux-gcc 
mips-openwrt-linux-gcc: no input files</code></pre></div><p>wow.. so this is the compiler.....</p><p>so i know the path of the compiler for my target router..<br />now lets say i want to compile helloworld.c on my desktop</p><div class="codebox"><pre><code>[mohnkhan@localhost bin]$ cd /home/mohnkhan/Desktop/
[mohnkhan@localhost Desktop]$ ls a.out
ls: cannot access a.out: No such file or directory
[mohnkhan@localhost Desktop]$ /home/mohnkhan/wrttrunk/trunk/staging_dir/toolchain-mips_r2_gcc-4.3.3+cs_uClibc-0.9.30.1/usr/bin/mips-openwrt-linux-gcc /home/mohnkhan/Desktop/helloworld.c
[mohnkhan@localhost Desktop]$ ls a.out
a.out
[mohnkhan@localhost Desktop]$ scp a.out root@192.168.1.1:/tmp/helloworld
root@192.168.1.1&#039;s password: 
a.out                                                                                                                                            100% 5733     5.6KB/s   00:00    
[mohnkhan@localhost Desktop]$ 
[mohnkhan@localhost Desktop]$ ssh root@192.168.1.1
root@192.168.1.1&#039;s password: 


BusyBox v1.15.3 (2010-05-02 15:37:22 IST) built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 Backfire (10.03, r21294) --------------------------
  * 1/3 shot Kahlua    In a shot glass, layer Kahlua 
  * 1/3 shot Bailey&#039;s  on the bottom, then Bailey&#039;s, 
  * 1/3 shot Vodka     then Vodka.
 ---------------------------------------------------
root@OpenWrt:~# cd /tmp/
root@OpenWrt:/tmp# ls helloworld 
helloworld
root@OpenWrt:/tmp# ls helloworld -l
-rwxr-xr-x    1 root     root         5733 May  2 23:21 helloworld
root@OpenWrt:/tmp# ./helloworld 
hello world; i succesfully cross compiled a programroot@OpenWrt:/tmp#</code></pre></div><p>I hope this helps.. this was a walk through as I would do for my router..</p><p>but if you are compiler a bigger package.. just to test it.., then <br />i would simply hack the make file and replace all instances of CC CCX etc, to my cross compilers path and run make<br />This saves a lot of time while testing and rebuilding software during development phase.</p><p>if you need more clarification don&#039;t hesitate to post back<br />Thanks</p>											<p class="post-edited">(Last edited by <strong>mohnkhan</strong> on 18 May 2010, 09:09)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p109375">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">aztroboy</div>
					<div class="post-datetime">
						19 May 2010, 06:44					</div>
				</div>
				<div class="post-content content">
					<p>WOW that just worked fine!</p><p>pretty awesome!! Thanks A LOT for the tip!! Very easy though... Now let me ask you: what&#039;s the super difference between using this method and using the buildroot?</p><p>you rock.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p109602">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">mohnkhan</div>
					<div class="post-datetime">
						21 May 2010, 19:08					</div>
				</div>
				<div class="post-content content">
					<p>Hi Aztroboy,<br /></p><div class="quotebox"><cite>aztroboy wrote:</cite><blockquote><p>WOW that just worked fine!</p><p>pretty awesome!! Thanks A LOT for the tip!! Very easy though... Now let me ask you: what&#039;s the super difference between using this method and using the buildroot?</p><p>you rock.</p></blockquote></div><p>well, some things to tell you, <br /> OpenWRT make normally is configured from the make menuconfig, we use&nbsp; stripping of symbols,<br /> and you can manually achieve the same too.... and nothing much of a difference.<br />this strip is present in the same directory. you can calling it manually and try on your executable you would see a small size difference.<br />bigger the program then bigger is the difference when you strip it of symbols.<br />we use symbols to help us in debugging files.</p><p> The real big pain in using build root is building dependencies .,etc especially the first time when you write a make file.<br /> and it takes more time to give you result if the program gave you the desired output.</p><div class="codebox"><pre><code>/* 
 * File:   main.cpp
 * Author: mohnkhan
 *
 * Created on May 21, 2010, 5:23 PM
 */
#include &lt;stdio.h&gt;


int main (int argc, char **argv)
{
    printf(&quot;Hellow world from mohnkhan&quot;);
    return 0;
}</code></pre></div><div class="codebox"><pre><code>[mohnkhan@localhost Desktop]$ /home/mohnkhan/wrttrunk/trunk/staging_dir/toolchain-mips_r2_gcc-4.3.3+cs_uClibc-0.9.30.1/usr/bin/mips-openwrt-linux-gcc /home/mohnkhan/Desktop/main.c 
[mohnkhan@localhost Desktop]$ cp a.out unstripped 
[mohnkhan@localhost Desktop]$ cp a.out stripped
[mohnkhan@localhost Desktop]$ /home/mohnkhan/wrttrunk/trunk/staging_dir/toolchain-mips_r2_gcc-4.3.3+cs_uClibc-0.9.30.1/usr/bin/mips-openwrt-linux-strip stripped 
[mohnkhan@localhost Desktop]$ ls -l unstripped stripped 
-rwxrwxr-x. 1 mohnkhan mohnkhan 3860 2010-05-21 21:36 stripped
-rwxrwxr-x. 1 mohnkhan mohnkhan 5695 2010-05-21 21:35 unstripped
[mohnkhan@localhost Desktop]$ 

[mohnkhan@localhost Desktop]$ scp  *ripped root@192.168.1.1:/tmp
root@192.168.1.1&#039;s password: 
stripped                                                                                                                                         100% 3860     3.8KB/s   00:00    
unstripped                                                                                                                                       100% 5695     5.6KB/s   00:00    
[mohnkhan@localhost Desktop]$ 
[mohnkhan@localhost Desktop]$ 
[mohnkhan@localhost Desktop]$ ssh root@192.168.1.1
root@192.168.1.1&#039;s password: 


BusyBox v1.15.3 (2010-05-02 15:37:22 IST) built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 Backfire (10.03, r21294) --------------------------
  * 1/3 shot Kahlua    In a shot glass, layer Kahlua 
  * 1/3 shot Bailey&#039;s  on the bottom, then Bailey&#039;s, 
  * 1/3 shot Vodka     then Vodka.
 ---------------------------------------------------
root@OpenWrt:~# cd /tmp/
root@OpenWrt:/tmp# ./stripped 
Hellow world from mohnkhanroot@OpenWrt:/tmp# 
root@OpenWrt:/tmp# ./unstripped 
Hellow world from mohnkhanroot@OpenWrt:/tmp#</code></pre></div>											<p class="post-edited">(Last edited by <strong>mohnkhan</strong> on 21 May 2010, 19:10)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>