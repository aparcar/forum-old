<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> hunting for the elusive jtag ti-ar7 ip8100 (pics)</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 3 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p105039">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">yopo</div>
					<div class="post-datetime">
						23 Mar 2010, 00:22					</div>
				</div>
				<div class="post-content content">
					<p>Hi! I have myself a console locked ti-ar7 device (Vtech ip8100) &amp; need to identify the correct jtag interface. The device has both the ti-ar7 &amp; an additional arm chip. I have read that the apparent partial jtag is for this secondary chip. There seem to be two serial console ports, but I am unable to (lack the training to) find the additional jtag. Please advise?</p><p><span class="postimg"><img src="http://img229.imageshack.us/img229/7749/voipback.jpg" alt="http://img229.imageshack.us/img229/7749/voipback.jpg" /></span></p><p><span class="postimg"><img src="http://img11.imageshack.us/img11/2378/voipfrona.jpg" alt="http://img11.imageshack.us/img11/2378/voipfrona.jpg" /></span></p><br /><p>Edit:<br />console unlock via ssh worked after a downgrade to firmware 11.1.0 , still would be nice to have jtag!</p>											<p class="post-edited">(Last edited by <strong>yopo</strong> on 23 Mar 2010, 01:01)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p105046">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">jal2</div>
					<div class="post-datetime">
						23 Mar 2010, 01:01					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>yopo wrote:</cite><blockquote><p>Hi! I have myself a console locked ti-ar7 device (Vtech ip8100) &amp; need to identify the correct jtag interface. The device has both the ti-ar7 &amp; an additional arm chip. I have read that the apparent partial jtag is for this secondary chip. There seem to be two serial console ports, but I am unable to (lack the training to) find the additional jtag. Please advise?</p></blockquote></div><p>Don&#039;t know which one is the &quot;partial jtag&quot; but I&#039;d guess the 2x10 pins in the second picture below the<br />TNET... IC is the JTAG for this chip. Maybe&nbsp; EJTAG standard 20 pin header? Try to find GND and Vcc pins with a multimeter.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p105047">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">yopo</div>
					<div class="post-datetime">
						23 Mar 2010, 01:03					</div>
				</div>
				<div class="post-content content">
					<p>that makes good sense! I didn&#039;t know there was a 20 pin ejtag, just thought they came in 14. Showing my ignorance I guess. Just below the ti-ar7 there is a 20 pin header. Will look for the pinout and check. Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p105049">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Void Main</div>
					<div class="post-datetime">
						23 Mar 2010, 01:26					</div>
				</div>
				<div class="post-content content">
					<p>Looks to me like the bottom left corner of the bottom pic if those labels say what I think they say (TDI, TDO, TCK, etc).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p105050">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">yopo</div>
					<div class="post-datetime">
						23 Mar 2010, 01:38					</div>
				</div>
				<div class="post-content content">
					<p>I read that was for the secondary arm chip for the voice module. <br /><span class="postimg"><img src="http://img87.imageshack.us/img87/7111/ip810020pin.jpg" alt="http://img87.imageshack.us/img87/7111/ip810020pin.jpg" /></span></p><p>here is what i got for the 20 pin header, it doesn&#039;t match jtag and i can&#039;t find the 20 pin e-jtag pinout.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p105053">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">beyondwind</div>
					<div class="post-datetime">
						23 Mar 2010, 04:14					</div>
				</div>
				<div class="post-content content">
					<p>Once I tried to JTAG the device too, but no success. <br />cound you give more details on how you managed to login in serial or ssh console?<br />I don&#039;t have the login account, neither can I downgrade the firmware from the web GUI. <br />thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p105056">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">yopo</div>
					<div class="post-datetime">
						23 Mar 2010, 04:39					</div>
				</div>
				<div class="post-content content">
					<p>cyt is floating around in the wild and for firmwares pre the 07 build, it modifies the firmware&#039;s temp provisioning with a dns and tftp server providing the ability for a user to upload an xml config either via tftp or cyt, but this is not permanent. The ssh interface can be accessed with the new admin pw. You must enable it in the newly available admin tab.</p><p> I&#039;ve read that it is possible to replace the env label for the cyt_private address with that of the bootloader making the /dev/mtd/7ro bootloader writable through ssh via dd, but I have yet to come to any success as it remains unwritable <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>The devices conform to wrtp54gs for the most part, or so i believe<br /><a href="http://wiki.openwrt.org/oldwiki/openwrtdocs/hardware/linksys/wrtp54g#bootcfg_a.bootcfg_b.bootcfg">http://wiki.openwrt.org/oldwiki/openwrt … _b.bootcfg</a></p><p><a href="http://text.broadbandreports.com/forum/remark,16514227~mode=text~days=120~start=680">http://text.broadbandreports.com/forum/ … ~start=680</a></p>											<p class="post-edited">(Last edited by <strong>yopo</strong> on 23 Mar 2010, 04:55)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p105065">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">jal2</div>
					<div class="post-datetime">
						23 Mar 2010, 09:54					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>yopo wrote:</cite><blockquote><p>here is what i got for the 20 pin header, it doesn&#039;t match jtag and i can&#039;t find the 20 pin e-jtag pinout.</p></blockquote></div><p>Look <a href="http://hri.sourceforge.net/tools/jtag_faq_org.html#_Toc63218717">here</a>. Check if the Vcc and ground pins match on your board.</p>											<p class="post-edited">(Last edited by <strong>jal2</strong> on 23 Mar 2010, 10:34)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p105068">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">jal2</div>
					<div class="post-datetime">
						23 Mar 2010, 10:21					</div>
				</div>
				<div class="post-content content">
					<p>If the SoC is a TNETV1060 (hard to read on your photo), you may find both the EJTAG of the MIPS core and the JTAG pins of the internal C55x DSP on the 20 pins and the standard layout won&#039;t apply :-(. Have a look into the <a href="http://focus.ti.com/pdfs/vf/bband/tnetv1060_datasheet.pdf">TNETV1060 datasheet</a>.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p105188">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">beyondwind</div>
					<div class="post-datetime">
						24 Mar 2010, 18:39					</div>
				</div>
				<div class="post-content content">
					<p>thanks, the datasheet is very helpful. I will try to scrape the cpu&#039;s jtag pin, will see whether I can map the 20 pin connector. </p><div class="quotebox"><cite>jal2 wrote:</cite><blockquote><p>If the SoC is a TNETV1060 (hard to read on your photo), you may find both the EJTAG of the MIPS core and the JTAG pins of the internal C55x DSP on the 20 pins and the standard layout won&#039;t apply :-(. Have a look into the <a href="http://focus.ti.com/pdfs/vf/bband/tnetv1060_datasheet.pdf">TNETV1060 datasheet</a>.</p></blockquote></div>											<p class="post-edited">(Last edited by <strong>beyondwind</strong> on 24 Mar 2010, 18:41)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p105335">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">jal2</div>
					<div class="post-datetime">
						27 Mar 2010, 00:10					</div>
				</div>
				<div class="post-content content">
					<p>Just came across a <a href="http://deadhacker.com/2010/02/03/jtag-enumeration/">hw tool</a> which may help to enumerate JTAG pins. I&#039;ll give it a try on a WNR2000, just ordered an Arduino @ 3.3V.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p105340">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">Void Main</div>
					<div class="post-datetime">
						27 Mar 2010, 00:59					</div>
				</div>
				<div class="post-content content">
					<p>Wow, thanks for the link! I actually have an arduino board and just happened to be doing some programming on it last night. Looks like I have another use for it. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p105365">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">jal2</div>
					<div class="post-datetime">
						27 Mar 2010, 14:39					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Void Main wrote:</cite><blockquote><p>Wow, thanks for the link! I actually have an arduino board and just happened to be doing some programming on it last night. Looks like I have another use for it. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></blockquote></div><p>Be careful with the TTL levels, most Arduinos are 5V and most targets are 3.3V. At least add<br />some resistors to limit the current.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p105590">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">yopo</div>
					<div class="post-datetime">
						30 Mar 2010, 11:57					</div>
				</div>
				<div class="post-content content">
					<p>Well, I bricked it by accident as I expected I might have during sleep deprivation:( I managed to get openwrt r20537 on to a second in hopes of installing a package that would let me modify my bootloader, as I was unable to trace those jtag pins... not enough experience. I can get to shell (only after many firmware flash attempts) but ethernet does not work, so it seems I am stuck. The wan comes up automatically, but can&#039;t talk. The mac id is trunticated... edit: I eventually got it working.</p><p>All the same Jal2, thanks for the datasheet. I hope someone can make use of it.</p><p>If anyone can offer some info regarding a means to enable ethernet communication on both ports (on the VLYNQ bus) to work or a means to get the dsp driver to play ball ( <a href="http://tinyurl.com/yc83qvm">http://tinyurl.com/yc83qvm</a> <a href="http://tinyurl.com/ybg4hk2">http://tinyurl.com/ybg4hk2</a> ), it would be much appreciated. It would be badass to some day get astrisk working on this box.</p>											<p class="post-edited">(Last edited by <strong>yopo</strong> on 1 Apr 2010, 18:30)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p105599">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">jal2</div>
					<div class="post-datetime">
						30 Mar 2010, 13:25					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>yopo wrote:</cite><blockquote><p>Well, I bricked it by accident as I expected I might have during sleep deprivation:( I managed to get openwrt r20537 on to a second in hopes of installing a package that would let me modify my bootloader, as I was unable to trace those jtag pins... not enough experience. I can get to shell (only after many firmware flash attempts) but ethernet does not work, so it seems I am stuck. The wan comes up automatically, but can&#039;t talk. The mac id is trunticated...<br />...</p></blockquote></div><p>I wouldn&#039;t call this a bricked router. Seems like the PSPBoot has built-in tftp (either server or client), couln&#039;t you use this to download<br />a new image (<a href="http://oldwiki.openwrt.org/OpenWrtDocs(2f)Customizing(2f)Firmware(2f)PSPBoot.html">http://oldwiki.openwrt.org/OpenWrtDocs( … PBoot.html</a>)? After you figured out what&#039;s wrong with the ethernet in your build.<br />BTW, you may include the lrz package and download a new firmware via serial (x/zmodem), althrough this takes some time. Flash on command line with sysupgrade afterwards.<br />How did you flash OpenWRT, in the GUI or in the bootloader?</p><p>I wouldn&#039;t try to replace the bootloader unless you know JTAG is working...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p105606">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">yopo</div>
					<div class="post-datetime">
						30 Mar 2010, 14:41					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jal2 wrote:</cite><blockquote><div class="quotebox"><cite>yopo wrote:</cite><blockquote><p>Well, I bricked it by accident as I expected I might have during sleep deprivation:( I managed to get openwrt r20537 on to a second in hopes of installing a package that would let me modify my bootloader, as I was unable to trace those jtag pins... not enough experience. I can get to shell (only after many firmware flash attempts) but ethernet does not work, so it seems I am stuck. The wan comes up automatically, but can&#039;t talk. The mac id is trunticated...<br />...</p></blockquote></div><p>I wouldn&#039;t call this a bricked router. Seems like the PSPBoot has built-in tftp (either server or client), couln&#039;t you use this to download<br />a new image (<a href="http://oldwiki.openwrt.org/OpenWrtDocs(2f)Customizing(2f)Firmware(2f)PSPBoot.html">http://oldwiki.openwrt.org/OpenWrtDocs( … PBoot.html</a>)? After you figured out what&#039;s wrong with the ethernet in your build.<br />BTW, you may include the lrz package and download a new firmware via serial (x/zmodem), althrough this takes some time. Flash on command line with sysupgrade afterwards.<br />How did you flash OpenWRT, in the GUI or in the bootloader?</p><p>I wouldn&#039;t try to replace the bootloader unless you know JTAG is working...</p></blockquote></div><p>Actually on the first i did brick it. I wiped out the bootloader partition. I can restore the old firmware on this other one in the manner you mention easily. I ended up separating the other board to look for the pinout trace to jtag. I&#039;ll upload the pics when this svn is done compiling.</p><p>Anyway, to follow up, here are the pics (fixed Jal2 -stupid&nbsp; time sensitive dynamic addys)</p><br /><p><a href="http://www.youshare.com/Guest/5ca9cad104dc5aee.JPG.html">http://www.youshare.com/Guest/5ca9cad104dc5aee.JPG.html</a></p><p><a href="http://www.youshare.com/Guest/36e24586f030695f.JPG.html">http://www.youshare.com/Guest/36e24586f030695f.JPG.html</a></p>											<p class="post-edited">(Last edited by <strong>yopo</strong> on 10 Apr 2010, 21:39)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p105738">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">jal2</div>
					<div class="post-datetime">
						31 Mar 2010, 22:54					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>yopo wrote:</cite><blockquote><p>Anyway, to follow up, here are the pics</p><p><a href="http://media1.youshare.com/uploads/01/Guest/36e24586f030695f.JPG?key=774c88f327a4308f12aba35af3f1ff94">http://media1.youshare.com/uploads/01/G … 5af3f1ff94</a><br />hi res original <a href="http://media1.youshare.com/DownloadOriginal~Guest~215555.html?key=774c88f327a4308f12aba35af3f1ff94">http://media1.youshare.com/DownloadOrig … 5af3f1ff94</a><br /><a href="http://media1.youshare.com/uploads/01/Guest/5ca9cad104dc5aee.JPG?key=774c88f327a4308f12aba35af3f1ff94">http://media1.youshare.com/uploads/01/G … 5af3f1ff94</a><br />hi res original <a href="http://media1.youshare.com/DownloadOriginal~Guest~215554.html?key=774c88f327a4308f12aba35af3f1ff94">http://media1.youshare.com/DownloadOrig … 5af3f1ff94</a></p></blockquote></div><p>First and third links give a &quot;forbidden&quot; error, second and forth a &quot;File not found&quot;.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p105933">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">beyondwind</div>
					<div class="post-datetime">
						3 Apr 2010, 07:40					</div>
				</div>
				<div class="post-content content">
					<p>After tracing through CPU pins from the datasheet, I managed to map the jtag pins:<br />pin 2 TRST<br />3: TCK<br />4: TDI<br />5:TDO<br />6: TMS<br />19: VCC</p><p>Short pin 2 (TRST) to Pin 19 VCC during jtag</p><p>Initially I did manage to probe the correct CPUID with tjtagv3, however, the flash chip mx29lv641 is not supported. I can&#039;t find the datasheet for mx29lv641, is there a way we can find out the sector arrangement for this flash chip? </p><p>Right now my board is hardware dead, maybe because I messed too much with the traces. I am wondering whether it is worth to buy another one from Ebay.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p106012">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">yopo</div>
					<div class="post-datetime">
						4 Apr 2010, 07:21					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>beyondwind wrote:</cite><blockquote><p>After tracing through CPU pins from the datasheet, I managed to map the jtag pins:<br />pin 2 TRST<br />3: TCK<br />4: TDI<br />5:TDO<br />6: TMS<br />19: VCC</p><p>Short pin 2 (TRST) to Pin 19 VCC during jtag</p><p>Initially I did manage to probe the correct CPUID with tjtagv3, however, the flash chip mx29lv641 is not supported. I can&#039;t find the datasheet for mx29lv641, is there a way we can find out the sector arrangement for this flash chip? </p><p>Right now my board is hardware dead, maybe because I messed too much with the traces. I am wondering whether it is worth to buy another one from Ebay.</p></blockquote></div><p>WOW, you are a champ! I can&#039;t wait to try it. Strangely my flash chips are labeled S29GL064M90TAIR7 (48 pin tsop). I found datasheets for both. I assume they are the same given their shared root id and since the pinouts appeared the same at a quick glance. </p><p>mx29lv641: <a href="http://cnc.ic-on-line.cn/IOL/datasheet/mx29lv64xml_1286720.pdf">http://cnc.ic-on-line.cn/IOL/datasheet/ … 286720.pdf</a><br />S29GL064M90TAIR7: <a href="http://www.datasheetarchive.com/pdf-datasheets/Datasheets-33/DSA-643890.pdf">http://www.datasheetarchive.com/pdf-dat … 643890.pdf</a></p><br /><p>Edit: just found this &quot;Try TJTAG 3.0 Rc1 with switch /f:85 (S29GL064M BotB)&quot;<br /><a href="http://tinyurl.com/ya75y96">http://tinyurl.com/ya75y96</a> -try that?</p><p>&quot;/fc:87 ............. Spansion S29GL064M BotB&nbsp; &nbsp; (8MB)&quot;<br />&quot;/fc:88 ............. Spansion S29GL064M TopB&nbsp; &nbsp; (8MB)&quot;<br /><a href="http://tinyurl.com/ygsq3ug">http://tinyurl.com/ygsq3ug</a> -try that?</p><br /><p>I am not sure if you would find it worth it, but given their capacity and their choice pricing (~$15-25 shipped), it may be worth it. One can obtain a linksys rtp300 for the same price or less. Amazon has been a good place to find such vonage gear lately: </p><p><a href="http://tinyurl.com/ydowhqm">http://tinyurl.com/ydowhqm</a><br /><a href="http://tinyurl.com/ybrwjkp">http://tinyurl.com/ybrwjkp</a> </p><p>I managed to stick kamikaze on the one live ip8100 the other day and it has been running an openvpn client since, barring intentional resets. There is a problem though, no switch support at the moment or support for the Legerity voice dsp (Le88221), though there is source says the wiki: </p><p><a href="http://tinyurl.com/yg8d8oy">http://tinyurl.com/yg8d8oy</a><br /><a href="http://tinyurl.com/ybg4hk2">http://tinyurl.com/ybg4hk2</a> -drivers?</p><p>datasheet: <br /><a href="http://tinyurl.com/ycam97a">http://tinyurl.com/ycam97a</a></p><p>Software support for a jtag would be great. Finally an easy way to wipe out those pesky read only env vars or even swap out the boot loader for something more comprehensive.</p><p>Edit: I connected the pins as you describe and got the bastard talking!<br />Time to play...<br /><span class="postimg"><img src="http://img194.imageshack.us/img194/1412/26407699.jpg" alt="http://img194.imageshack.us/img194/1412/26407699.jpg" /></span></p>											<p class="post-edited">(Last edited by <strong>yopo</strong> on 4 Apr 2010, 22:26)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p106248">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">yopo</div>
					<div class="post-datetime">
						7 Apr 2010, 01:16					</div>
				</div>
				<div class="post-content content">
					<p>jtag works, I&#039;ve tried </p><p>/fc:87 ............. Spansion S29GL064M BotB&nbsp; &nbsp; (8MB)<br />/fc:88 ............. Spansion S29GL064M TopB&nbsp; &nbsp; (8MB)</p><p>in tjtag3 and still can&#039;t get the damned thing to boot with my backup of pspboot...<br />I believe it is a BotB, but don&#039;t know...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p106250">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">jal2</div>
					<div class="post-datetime">
						7 Apr 2010, 02:12					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>yopo wrote:</cite><blockquote><p>jtag works, I&#039;ve tried </p><p>/fc:87 ............. Spansion S29GL064M BotB&nbsp; &nbsp; (8MB)<br />/fc:88 ............. Spansion S29GL064M TopB&nbsp; &nbsp; (8MB)</p><p>in tjtag3 and still can&#039;t get the damned thing to boot with my backup of pspboot...<br />I believe it is a BotB, but don&#039;t know...</p></blockquote></div><p>According to <a href="http://www.datasheetarchive.com/pdf-datasheets/Datasheets-33/DSA-643890.pdf">this datasheet</a> a S29GL064M90TAIR7 is a <strong>uniform sector</strong> flash (see page 23), i.e. 128 sector of equal size.<br />If tjtag doesn&#039;t provide it, you may try TopB, as this matches the uniform layout in the first sectors where the bootloader usually resides (for MIPS in a 32 Mbit flash).</p><p>BTW, couldn&#039;t you read the flash content after writing it and compare it with the original source?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p106254">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">yopo</div>
					<div class="post-datetime">
						7 Apr 2010, 03:48					</div>
				</div>
				<div class="post-content content">
					<p>uniform sector, I remember that, not knowing what it meant explicitly. Thanks Jal2.</p><p>I did read back the the written backup after writing with both fc ids and they both yielded the same files as the source, so I am kind of at a loss to understand what you mean. I requested backup from the same location I read to, 0xB0000000 &amp; 0x90000000 which are both supposed to be references to bootloader memory space start for ar7 devices, confirmed by the env vars on the second device that I have yet to jtag. I guess the only recourse is to find a jtag soft with support for this uniform sector r6/7 flash chip or diy.</p><p>This a good place to start maybe? </p><p>&quot;Software Changes When Migrating From Boot To Uniform&quot;<br /><a href="http://www.spansion.com/Support/AppNotes/migration_boot_uniform_an_e.pdf">http://www.spansion.com/Support/AppNote … m_an_e.pdf</a></p><p>Edit: I got luck looking through the source of tjtag and googled like mad finding a jtag tool which espouses support for the chip </p><p><a href="http://download.modem-help.co.uk/utilities/JTAG/Software/BrJTAG/v1-6r/brjtag16r.zip.php?showFile=brjtag.c">http://download.modem-help.co.uk/utilit … e=brjtag.c</a></p><p>trying it now</p>											<p class="post-edited">(Last edited by <strong>yopo</strong> on 7 Apr 2010, 06:35)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p106266">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">jal2</div>
					<div class="post-datetime">
						7 Apr 2010, 10:30					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>yopo wrote:</cite><blockquote><p>uniform sector, I remember that, not knowing what it meant explicitly. Thanks Jal2.</p><p>I did read back the the written backup after writing with both fc ids and they both yielded the same files as the source, so I am kind of at a loss to understand what you mean. I requested backup from the same location I read to, 0xB0000000 &amp; 0x90000000 which are both supposed to be references to bootloader memory space start for ar7 devices, confirmed by the env vars on the second device that I have yet to jtag. I guess the only recourse is to find a jtag soft with support for this uniform sector r6/7 flash chip or diy.</p></blockquote></div><p>Strange. I thought a MIPS bootloader would always be located at 0xbfc00000 (aka 0x1fc00000 physical), as this is the reset vector of a MIPS CPU.<br />AFAIR if you write to a flash which is uniform using a BotB scheme, you will erase the first sector more than once (because the sw handles it as several sectors), loosing all but the last part written.</p><p>I just see that your flash is a 64 MBit (took it for a 32 MBit before) i.e. it probably starts at 0x1f800000 and the bootloader resides in the middle where all three sector schemes (TopB, BotB and uniform) are the same.</p><p>It should be fairly easy to add a uniform sector S29GL064 to tjtag, but I guess your problem is something else. I&#039;ll have a look later.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p106268">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">jal2</div>
					<div class="post-datetime">
						7 Apr 2010, 10:45					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jal2 wrote:</cite><blockquote><p>It should be fairly easy to add a uniform sector S29GL064 to tjtag, but I guess your problem is something else. I&#039;ll have a look later.</p></blockquote></div><p>This patch should add support for S29GL064 uniform to tjtag 3.0.1. I&#039;d expect autodetect to work, so no need for &quot;/fc:XX&quot;:<br /></p><div class="codebox"><pre><code>diff -ur tjtag3-0-1/tjtag.c tjtag3-0-1.work/tjtag.c
--- tjtag3-0-1/tjtag.c    2009-08-30 21:19:26.000000000 +0200
+++ tjtag3-0-1.work/tjtag.c    2010-04-07 09:40:50.000000000 +0200
@@ -383,6 +383,7 @@
     { 0x017E, 0x1A01, size4MB, CMD_TYPE_AMD, &quot;Spansion S29GL032M TopB    (4MB)&quot;   ,63,size64K,     8,size8K,   0,0,        0,0        },
     { 0x017E, 0x1000, size8MB, CMD_TYPE_AMD, &quot;Spansion S29GL064M BotB    (8MB)&quot;   ,8,size8K,     127,size64K,   0,0,        0,0        },
     { 0x017E, 0x1001, size8MB, CMD_TYPE_AMD, &quot;Spansion S29GL064M TopB    (8MB)&quot;   ,127,size64K,     8,size8K,   0,0,        0,0        },
+    { 0x017E, 0x1301, size8MB, CMD_TYPE_AMD, &quot;Spansion S29GL064M U       (8MB)&quot;   ,128,size64K,     0,0,   0,0,        0,0        },
 
     { 0x017E, 0x2101, size16MB, CMD_TYPE_AMD, &quot;Spansion S29GL128P U      (16MB)&quot;   ,128,size128K,     0,0,   0,0,        0,0        },
     { 0x017E, 0x1200, size16MB, CMD_TYPE_AMD, &quot;Spansion S29GL128M U      (16MB)&quot;   ,128,size128K,   0,0,      0,0,        0,0         },</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p106337">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">yopo</div>
					<div class="post-datetime">
						8 Apr 2010, 07:12					</div>
				</div>
				<div class="post-content content">
					<p>Well, after recompiling the source of tjtag 3.01 with the addition of </p><div class="codebox"><pre><code>{ 0x017E, 0x1301, size8MB, CMD_TYPE_AMD, &quot;Spansion S29GL064M U       (8MB)&quot;   ,128,size64K,     0,0,   0,0,        0,0        },</code></pre></div><p>supplied by Jal2, allowing support of the uniform sector 8mb flash chip S29GL064M90TAIR7, using the laborious efforts of beyondwind&#039;s pinout hunting, I was successfully able to not only revive my bricked ip8100, but change the default envars of the original firmware, effectively allowing the permanent alteration of the default admin password, the original provisioning hash dir and crypt key! </p><br /><p>I can&#039;t begin to thank you both for your help. There is no way I could have done it without you!</p><p>...to reiterate for any others poor bastards playing with these ti-ar7 devices </p><p><span class="postimg"><img src="http://img52.imageshack.us/img52/6388/ip8100.png" alt="http://img52.imageshack.us/img52/6388/ip8100.png" /></span></p><p>(every doc I have read mentions the below bootloader addy as universal between them)</p><p>PSPBoot Name &nbsp; &nbsp;&nbsp; Start &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Size<br />BOOTLOADER &nbsp; &nbsp; 0x90000000 &nbsp; &nbsp; 0x90010000 &nbsp; &nbsp; 0x010000 (64K)<br />boot_env &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x90010000 &nbsp; &nbsp; 0x90020000 &nbsp; &nbsp; 0x010000 (64K)</p><div class="codebox"><pre><code>tjtag -backup:custom /window:90000000 /start:90000000 /length:20000 /nodma /silent</code></pre></div><p>Edit Envars with a good text editor to remove bs vonage defaults</p><p>CONSOLE_STATE&nbsp; &nbsp;unlocked<br />ADMIN_PWD ABW9wzpK6VV4Q (Admin)<br />CRYPT_KEY &quot;change&quot; (must be in hex and divisible by 2)<br />HASH_DIR &quot;change&quot;</p><p>Save and flash</p><div class="codebox"><pre><code>tjtag -flash:custom /window:90000000 /start:90000000 /length:20000 /nodma /silent</code></pre></div><p>make sure you use a pre 2007 firmware because the web interfaces for voip settings are broken intentionally (you may downgrade via tftp in the manner described below concerning reflashing old firmware)</p><p>finally, wipe out the config partitions for a &amp; b (ip8100) or the cyt private partition rtp300, moto vt2x42, pap2v2,wrtp54g) so defaults are custom or blank respectively (-refer to the oldwiki for exact addy space)</p><p>ip8100<br />CONFIG_A&nbsp; &nbsp; &nbsp; &nbsp; 0x90400000,0x90420000<br />CONFIG_B&nbsp; &nbsp; &nbsp; &nbsp; 0x90420000,0x90440000</p><div class="codebox"><pre><code>tjtag -erase:custom /window:90000000 /start:90400000 /length:40000 /nodma /silent</code></pre></div><p>Upon entering the web interface, under the provisioning tab enter <a href="http://127.0.0.1">http://127.0.0.1</a> as both the provisioning and firmware server to prevent provisioning errors, then fill in your details for the given service. Your device will only accept [abcd] + [0-9] as the auth user name per the closed ggsip app sadly, but any combination of those characters works at any practical length, though I am not sure the limit.</p><p>Openwrt via serial @3.3v 115200,n,8,1,hw </p><p>To install openwrt from pspboot so to yield access to all flash memory, create a new partition encompassing all of the memory following the bootenv addy, format it, set it active, and tftp your image. Connect your ethernet cable to wan (as you will not need to switch it later) using a static ip on the box with your tftp server, making sure first to set the router&#039;s ip to the same subnet so it can talk. Your vars may be already good, or different depending on whether you have adam2 or an earlier pspboot, so make sure first; at the pspboot prompt &quot;printenv&quot; will show you what you are working with. In addition &quot;printenv envlist&quot; will give you some alternate envs which have yet to be set.</p><div class="codebox"><pre><code>setenv MAC_PORT 2</code></pre></div><div class="codebox"><pre><code>setenv IPA 192.168.15.1</code></pre></div><div class="codebox"><pre><code>setenv SUBNET_MASK  255.255.255.0</code></pre></div><div class="codebox"><pre><code>setenv FULL 0x90020000,replace-with-end-addy-refer-to-openwrt-wiki</code></pre></div><div class="codebox"><pre><code>fmt FULL</code></pre></div><div class="codebox"><pre><code>setenv BOOTCFG m:f:&quot;FULL&quot;</code></pre></div><div class="codebox"><pre><code>tftp -i your-tftp-server-ip your-image FULL</code></pre></div><p>Only wan works, but it is good enough for you to run an openvpn server and icecast <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Since your bootvars will be maintained, flashing the old firmware is as simple as resetting one of the original partitions as active after formatting and tftping the original fw from the pspboot serial console.</p><p>e.g.<br /></p><div class="codebox"><pre><code>fmt IMAGE_A</code></pre></div><div class="codebox"><pre><code>tftp -i your-tftp-server-ip your-firmware IMAGE_A</code></pre></div><div class="codebox"><pre><code>setenv BOOTCFG m:f:&quot;IMAGE_A&quot;</code></pre></div><p>refer to if in doubt or in trouble:<br /><a href="http://tinyurl.com/yhsaqmf">http://tinyurl.com/yhsaqmf</a> oldwiki<br /><a href="http://tinyurl.com/yg8d8oy">http://tinyurl.com/yg8d8oy</a><br /><a href="http://tinyurl.com/yb5w5p8">http://tinyurl.com/yb5w5p8</a> pspboot guide</p><p>Thanks again guys!</p>											<p class="post-edited">(Last edited by <strong>yopo</strong> on 10 Apr 2010, 20:54)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>