<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Sophos UTM and OpenWrt</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 11 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p341893">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">JW0914</div>
					<div class="post-datetime">
						23 Oct 2016, 17:53					</div>
				</div>
				<div class="post-content content">
					<p>Moved from different thread</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p341894">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">JW0914</div>
					<div class="post-datetime">
						23 Oct 2016, 17:53					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>kirkgbr wrote:</cite><blockquote><div class="quotebox"><cite>JW0914 wrote:</cite><blockquote><div class="quotebox"><cite>kirkgbr wrote:</cite><blockquote><p>I&#039;ve actually considered that but trying to match hardware, chipsets, ... with what is supported in openwrt is a rather daunting task.&nbsp; At least for me <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p></blockquote></div><p>If building a custom router box, OpenWrt shouldn&#039;t be used as it would defeat the purpose of a custom router box. I personally recommend mini-ITX server boards with an Intel SOC [<em>J1900, C2550/C2750, C2558/C2758</em>] and no more than a TDP of 20W, utilizing ESXi as a base OS, then a router OS within a VM [<em>Sophos UTM is easily the best router OS out there for home users</em>]. <br /></p><ul><li><p>Server boards are preferred due to IPMI (<em>box should be headless</em>) and ESXi is meant to be managed via IP<br /></p><ul><li><p>ESXi allows one to fully utilize the quad or octa core CPU and the 16GB - 64GB RAM</p></li></ul></li><li><p>Sophos UTM (<em>as a <strong>S</strong>oftware <strong>A</strong>ppliance</em>) is free to home users</p></li></ul></blockquote></div><p>ESXi and vm&#039;s are bit much for a home router <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p></blockquote></div><p>For a consumer bought store router, yes... for a custom router box, no.&nbsp; </p><p>For example, the 3200 has a dual core 1.8gHz processor and 512MB of RAM, whereas my custom router box runs a A1SRi-2758F server board (<em>TDP 20w</em>], with an Octa Core 2.4gHz Atom C2758 &amp; 16GB ECC RAM. Unless you&#039;re running a fiber or SAS storage network, those will simply not be taken advantage of.&nbsp; Running ESXi [<em>or any VM base OS</em>] allows for the router OS [<em>Sophos UTM</em>] to be installed in a VM, all traffic being routed through it first, then one can take advantage of the hardware by running additional servers in VMs.</p><p>A router box should have a minimum of a quad core 2.0gHz CPU and 8GB ECC RAM due to the IPS, AntiVirus, Anti-Malware, and other features gained with a router OS like Sophos UTM.&nbsp; For ~$300, one can pickup an AsRock J1900D2Y, 8GB RAM, &amp; case, of which offers a massive performance gain over many enterprise routers, let alone consumer ones.</p>											<p class="post-edited">(Last edited by <strong>JW0914</strong> on 25 Oct 2016, 18:20)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p341895">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">JW0914</div>
					<div class="post-datetime">
						23 Oct 2016, 17:53					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>gsustek wrote:</cite><blockquote><p>@JW0914 keep it writing:-) it seems that this configuration suits more for small office than average family:-) But i like your HW/SW combo..</p></blockquote></div><p>Not at all... Router OSes offer far better security over that of consumer routers.&nbsp; The achilles heal of consumer routers is the hardware, as well as the limitations imposed by memory, RAM, and clock speed.&nbsp; Sophos UTM is the exact same OS that&#039;s licensed to corporations and utilized on their HAs (<strong>H</strong>ardware <strong>A</strong>ppliances), with the only limitation for home users being a 50 IP limit.&nbsp; Sophos UTM is meant to be the WAN facing router as it lacks certain capabilities for security reasons:<br /></p><ul><li><p>It cannot be configured as a VPN client, except if connecting to another UTM HA/SA</p></li><li><p>It cannot be configured as a NAS server for SAMBA, NFS, etc</p></li></ul><p>Sophos UTM as a Software Appliance is far more than just a Router OS... it&#039;s a comprehensive <strong>U</strong>nified <strong>T</strong>hreat <strong>M</strong>anagement OS, which combines a router with IPS [Intrusion Prevention System] via SNORT and other open source &amp; proprietary software, antivirus/anti-malware protection for all devices behind it (as well as endpoint software that is phenomenal at blocking attempted web exploits, of which is capable of being managed via the UTM itself or the endpoint PC), Outlook addin, auto scanning all email through two separate scanners prior to being delivered, 5 different VPN types (including HTML5), and a phenomenal web filtering capability.<br /></p><ul><li><p>A major benefit is VPN speed, with a massive performance gain when processing encryption over that of my ACS.</p></li></ul><div class="codebox"><pre><code>1st Line:   WRT1900ACS      DD [4.4.14-2016.09.26, r49936]
2nd Line:   A1SRi-2758F     Sophos UTM [8C 2.4gHz / 16GB ECC RAM / 128GB 850 Pro]

Doing sha256 for 3s on 16 size blocks: 1547137 sha256&#039;s in 3.00s
Doing sha256 for 3s on 16 size blocks: 2460459 sha256&#039;s in 3.00s
    Doing sha256 for 3s on 64 size blocks: 824553 sha256&#039;s in 3.00s
    Doing sha256 for 3s on 64 size blocks: 1366848 sha256&#039;s in 3.00s
Doing sha256 for 3s on 256 size blocks: 347862 sha256&#039;s in 2.99s
Doing sha256 for 3s on 256 size blocks: 574461 sha256&#039;s in 3.00s
    Doing sha256 for 3s on 1024 size blocks: 105168 sha256&#039;s in 3.00s
    Doing sha256 for 3s on 1024 size blocks: 174758 sha256&#039;s in 3.00s
Doing sha256 for 3s on 8192 size blocks: 13991 sha256&#039;s in 3.00s
Doing sha256 for 3s on 8192 size blocks: 23320 sha256&#039;s in 3.00s

Doing sha512 for 3s on 16 size blocks: 298170 sha512&#039;s in 2.99s
Doing sha512 for 3s on 16 size blocks: 827431 sha512&#039;s in 3.00s
    Doing sha512 for 3s on 64 size blocks: 298564 sha512&#039;s in 3.00s
    Doing sha512 for 3s on 64 size blocks: 825344 sha512&#039;s in 3.00s
Doing sha512 for 3s on 256 size blocks: 101479 sha512&#039;s in 2.99s
Doing sha512 for 3s on 256 size blocks: 294862 sha512&#039;s in 3.00s
    Doing sha512 for 3s on 1024 size blocks: 33985 sha512&#039;s in 3.00s
    Doing sha512 for 3s on 1024 size blocks: 100454 sha512&#039;s in 3.02s
Doing sha512 for 3s on 8192 size blocks: 4719 sha512&#039;s in 3.00s
Doing sha512 for 3s on 8192 size blocks: 14052 sha512&#039;s in 3.00s

Doing aes-128 cbc for 3s on 16 size blocks: 4414932 aes-128 cbc&#039;s in 2.99s
Doing aes-128 cbc for 3s on 16 size blocks: 7269637 aes-128 cbc&#039;s in 3.00s
    Doing aes-128 cbc for 3s on 64 size blocks: 1227616 aes-128 cbc&#039;s in 3.00s
    Doing aes-128 cbc for 3s on 64 size blocks: 2024555 aes-128 cbc&#039;s in 3.00s
Doing aes-128 cbc for 3s on 256 size blocks: 314664 aes-128 cbc&#039;s in 3.00s
Doing aes-128 cbc for 3s on 256 size blocks: 528872 aes-128 cbc&#039;s in 3.00s
    Doing aes-128 cbc for 3s on 1024 size blocks: 79158 aes-128 cbc&#039;s in 2.99s
    Doing aes-128 cbc for 3s on 1024 size blocks: 263410 aes-128 cbc&#039;s in 3.00s
Doing aes-128 cbc for 3s on 8192 size blocks: 9942 aes-128 cbc&#039;s in 3.00s
Doing aes-128 cbc for 3s on 8192 size blocks: 33206 aes-128 cbc&#039;s in 3.00s

Doing aes-192 cbc for 3s on 16 size blocks: 3916567 aes-192 cbc&#039;s in 2.99s
Doing aes-192 cbc for 3s on 16 size blocks: 6073333 aes-192 cbc&#039;s in 3.00s
    Doing aes-192 cbc for 3s on 64 size blocks: 1056818 aes-192 cbc&#039;s in 3.00s
    Doing aes-192 cbc for 3s on 64 size blocks: 1701665 aes-192 cbc&#039;s in 3.00s
Doing aes-192 cbc for 3s on 256 size blocks: 269232 aes-192 cbc&#039;s in 2.97s
Doing aes-192 cbc for 3s on 256 size blocks: 443045 aes-192 cbc&#039;s in 3.00s
    Doing aes-192 cbc for 3s on 1024 size blocks: 67603 aes-192 cbc&#039;s in 2.98s
    Doing aes-192 cbc for 3s on 1024 size blocks: 223402 aes-192 cbc&#039;s in 3.00s
Doing aes-192 cbc for 3s on 8192 size blocks: 8493 aes-192 cbc&#039;s in 2.99s
Doing aes-192 cbc for 3s on 8192 size blocks: 28117 aes-192 cbc&#039;s in 3.00s

Doing aes-256 cbc for 3s on 16 size blocks: 3434072 aes-256 cbc&#039;s in 3.00s
Doing aes-256 cbc for 3s on 16 size blocks: 5370533 aes-256 cbc&#039;s in 3.02s
    Doing aes-256 cbc for 3s on 64 size blocks: 930883 aes-256 cbc&#039;s in 3.00s
    Doing aes-256 cbc for 3s on 64 size blocks: 1460201 aes-256 cbc&#039;s in 3.00s
Doing aes-256 cbc for 3s on 256 size blocks: 236548 aes-256 cbc&#039;s in 3.00s
Doing aes-256 cbc for 3s on 256 size blocks: 379486 aes-256 cbc&#039;s in 3.00s
    Doing aes-256 cbc for 3s on 1024 size blocks: 59421 aes-256 cbc&#039;s in 2.98s
    Doing aes-256 cbc for 3s on 1024 size blocks: 193861 aes-256 cbc&#039;s in 3.00s
Doing aes-256 cbc for 3s on 8192 size blocks: 7528 aes-256 cbc&#039;s in 3.00s
Doing aes-256 cbc for 3s on 8192 size blocks: 24392 aes-256 cbc&#039;s in 3.00s

Doing 2048 bit private rsa&#039;s for 10s: 330 2048 bit private RSA&#039;s in 9.97s
Doing 2048 bit private rsa&#039;s for 10s: 370 2048 bit private RSA&#039;s in 10.02s
    Doing 2048 bit public rsa&#039;s for 10s: 13559 2048 bit public RSA&#039;s in 10.00s
    Doing 2048 bit public rsa&#039;s for 10s: 14011 2048 bit public RSA&#039;s in 10.00s
Doing 4096 bit private rsa&#039;s for 10s: 51 4096 bit private RSA&#039;s in 10.02s
Doing 4096 bit private rsa&#039;s for 10s: 57 4096 bit private RSA&#039;s in 10.18s
    Doing 4096 bit public rsa&#039;s for 10s: 3662 4096 bit public RSA&#039;s in 10.00s
    Doing 4096 bit public rsa&#039;s for 10s: 3764 4096 bit public RSA&#039;s in 10.00s

Doing 256 bit  ecdh&#039;s for 10s: 3230 256-bit ECDH ops in 9.90s
Doing 256 bit  ecdh&#039;s for 10s: 3253 256-bit ECDH ops in 10.00s
    Doing 384 bit  ecdh&#039;s for 10s: 1480 384-bit ECDH ops in 9.99s
    Doing 384 bit  ecdh&#039;s for 10s: 1215 384-bit ECDH ops in 10.00s
Doing 521 bit  ecdh&#039;s for 10s: 763 521-bit ECDH ops in 10.00s
Doing 521 bit  ecdh&#039;s for 10s: 505 521-bit ECDH ops in 10.02s

Doing 283 bit  ecdh&#039;s for 10s: 1003 283-bit ECDH ops in 9.99s
Doing 283 bit  ecdh&#039;s for 10s: 2782 283-bit ECDH ops in 10.00s
    Doing 409 bit  ecdh&#039;s for 10s: 429 409-bit ECDH ops in 10.02s
    Doing 409 bit  ecdh&#039;s for 10s: 1413 409-bit ECDH ops in 10.02s
Doing 571 bit  ecdh&#039;s for 10s: 182 571-bit ECDH ops in 10.00s
Doing 571 bit  ecdh&#039;s for 10s: 628 571-bit ECDH ops in 10.00s

Doing 283 bit  ecdh&#039;s for 10s: 897 283-bit ECDH ops in 10.00s
Doing 283 bit  ecdh&#039;s for 10s: 2543 283-bit ECDH ops in 10.00s
    Doing 409 bit  ecdh&#039;s for 10s: 374 409-bit ECDH ops in 10.02s
    Doing 409 bit  ecdh&#039;s for 10s: 1278 409-bit ECDH ops in 10.00s
Doing 571 bit  ecdh&#039;s for 10s: 159 571-bit ECDH ops in 10.02s
Doing 571 bit  ecdh&#039;s for 10s: 564 571-bit ECDH ops in 10.02s

OpenSSL 1.0.2j  26 Sep 2016

The &#039;numbers&#039; are in 1000s of bytes per second processed.
type             16 bytes     64 bytes    256 bytes   1024 bytes   8192 bytes

aes-128 cbc      23625.05k    26189.14k    26851.33k    27109.63k    27148.29k
aes-128 cbc      38771.40k    43190.51k    45130.41k    89910.61k    90674.52k
    aes-192 cbc      20958.22k    22545.45k    23206.53k    23230.02k    23269.12k
    aes-192 cbc      32391.11k    36302.19k    37806.51k    76254.55k    76778.15k
aes-256 cbc      18315.05k    19858.84k    20185.43k    20418.49k    20556.46k
aes-256 cbc      28453.15k    31150.95k    32382.81k    66171.22k    66606.42k

sha256            8251.40k    17590.46k    29783.50k    35897.34k    38204.76k
sha256           13122.45k    29159.42k    49020.67k    59650.73k    63679.15k
    sha512            1595.56k     6369.37k     8688.50k    11600.21k    12886.02k
    sha512            4412.97k    17607.34k    25161.56k    34061.22k    38371.33k

                  sign    verify    sign/s verify/s
rsa 2048 bits 0.030212s 0.000738s     33.1   1355.9
rsa 2048 bits 0.027081s 0.000714s     36.9   1401.1
    rsa 4096 bits 0.196471s 0.002731s      5.1    366.2
    rsa 4096 bits 0.178596s 0.002657s      5.6    376.4

                              op      op/s
 256 bit ecdh (nistp256)   0.0031s    326.3
 256 bit ecdh (nistp256)   0.0031s    325.3
    384 bit ecdh (nistp384)   0.0067s    148.1
    384 bit ecdh (nistp384)   0.0082s    121.5
 521 bit ecdh (nistp521)   0.0131s     76.3
 521 bit ecdh (nistp521)   0.0198s     50.4
 
 283 bit ecdh (nistk283)   0.0100s    100.4
 283 bit ecdh (nistk283)   0.0036s    278.2
    409 bit ecdh (nistk409)   0.0234s     42.8
    409 bit ecdh (nistk409)   0.0071s    141.0
 571 bit ecdh (nistk571)   0.0549s     18.2
 571 bit ecdh (nistk571)   0.0159s     62.8
 
 283 bit ecdh (nistb283)   0.0111s     89.7
 283 bit ecdh (nistb283)   0.0039s    254.3
    409 bit ecdh (nistb409)   0.0268s     37.3
    409 bit ecdh (nistb409)   0.0078s    127.8
 571 bit ecdh (nistb571)   0.0630s     15.9
 571 bit ecdh (nistb571)   0.0178s     56.3</code></pre></div><p>I&#039;ve always recommended anyone with children in the home to try Sophos UTM as their WAN facing router simply for it&#039;s web filtering capabilities, which can be ran in transparent mode, scanning all traffic, including SSL/TLS encrypted packets (it decrypts, scans, re-encrypts, then signs the packets with it&#039;s internal Proxy CA).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p341896">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">JW0914</div>
					<div class="post-datetime">
						23 Oct 2016, 17:54					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>mojolacerator wrote:</cite><blockquote><div class="quotebox"><cite>doITright wrote:</cite><blockquote><p>@JW0914</p><p>Do you have a wiki etc. on your custom router ideas/build?&nbsp; </p><p>Sounds very interesting .....</p><p>Cheers</p></blockquote></div><p>@JW0914</p><p>I would be interested as well. I have looked at doing this, but just don&#039;t have the time to pull all the info together.</p></blockquote></div><p>Sophos UTM is built upon an openSUSE base OS, so it will run on most hardware provided the hardware meets the minimum hardware reqs and has at least 2 ethernet ports.&nbsp; </p><p>As to hardware, I recommend mini-itx server boards with a dedicated IPMI port that are capable of passive cooling and have a TDP no higher than 24W, with a minimum of a quad core running 2.0gHz+, 8GB ECC RAM, and at least a 128GB SSD.&nbsp; There are other manufacturers besides AsRock and SuperMicro, however I&#039;m most familiar with them since I own server boards from each.&nbsp; ECC RAM is highly recommended and not all boards support it (Intel&#039;s J1900 does not, and J1900 boards will be the cheapest in the ~$175 range, with C2X50/C2X58 boards in the ~$275 - $375 range)</p><p>Sophos UTM can be run in a VM and I highly recommend one tests it in a VM prior to buying hardware for a build.&nbsp; There is a slight learning curve to Sophos UTM, and while the WebAdmin may appear overwhelming at first, it&#039;s laid out in a common sense way, making it easy to navigate.<br /></p><ul><li><p>CPU<br /></p><ul><li><p>SOCs<br /></p><ul><li><p>Intel <a href="http://ark.intel.com/products/78867/Intel-Celeron-Processor-J1900-2M-Cache-up-to-2_42-GHz">J1900</a></p></li><li><p>Intel <a href="http://ark.intel.com/products/77982/Intel-Atom-Processor-C2550-2M-Cache-2_40-GHz">C2550</a>/<a href="http://ark.intel.com/products/77987/Intel-Atom-Processor-C2750-4M-Cache-2_40-GHz">C2750</a></p></li><li><p>Intel <a href="http://ark.intel.com/products/77983/Intel-Atom-Processor-C2558-2M-Cache-2_40-GHz">C2558</a>/<a href="http://ark.intel.com/products/77988/Intel-Atom-Processor-C2758-4M-Cache-2_40-GHz?q=C2758">C2758</a></p></li></ul></li><li><p>Motherboards<br /></p><ul><li><p>non-ECC [NOT recommended]<br /></p><ul><li><p>AsRock <a href="http://www.asrockrack.com/general/productdetail.asp?Model=J1900D2Y#Specifications">J1900D2Y</a></p></li><li><p>SuperMicro <a href="http://www.supermicro.com/products/motherboard/celeron/X10/X10SBA.cfm">X10SBA</a>/<a href="http://www.supermicro.com/products/motherboard/celeron/X10/X10SBA-L.cfm">X10SBA-L</a></p></li></ul></li><li><p>ECC (C2550/C2750) (C2558/C2758)<br /></p><ul><li><p>AsRock <a href="http://www.asrockrack.com/general/productdetail.asp?Model=C2550D4I#Specifications">C2550D4I</a>/<a href="http://www.asrockrack.com/general/productdetail.asp?Model=C2750D4I#Specifications">C2750D4I</a><br /></p><ul><li><p>I&#039;d stay away from the C2750D4I for a router, as it&#039;s meant for a NAS (it&#039;s what I run in my SilverStone DS380 FreeNAS server)</p></li></ul></li><li><p>SuperMicro <a href="http://www.supermicro.com/products/motherboard/Atom/X10/A1SAi-2550F.cfm">A1SAi-2550F</a>/<a href="http://www.supermicro.com/products/motherboard/Atom/X10/A1SAi-2750F.cfm">A1SAi-2750F</a></p></li><li><p>SuperMicro <a href="http://www.supermicro.com/products/motherboard/atom/x10/a1sri-2558f.cfm">A1SRi-2558F</a>/<a href="http://www.supermicro.com/products/motherboard/atom/x10/a1sri-2758f.cfm">A1SRi-2758F</a></p></li></ul></li></ul></li></ul></li><li><p>Case<br /></p><ul><li><p><a href="https://www.inwin-style.com/en/gaming-chassis">In Win</a> <a href="https://www.inwin-style.com/en/gaming-chassis/Chopin">Chopin</a> (currently out of stock on Newegg, otherwise $90 USD)<br /></p><ul><li><p>Most smaller mini-ITX cases will be in the $50 - $100 range, with aesthetics varying wildly by manufacturer; however, I&#039;ve yet to come across a mini-ITX case that&#039;s designed better than the Chopin.&nbsp; In Win makes art out of their cases, so if you&#039;re looking for a phenomenal case, check them out.</p></li></ul></li><li><p>Wichever case one chooses, it should come with it&#039;s own power supply or a supply board.&nbsp; Many of the Atom SOC server boards can be powered either by ATX plugs from a power supply, or via a 12v DC jack on a power board.</p></li></ul></li><li><p>HDD<br /></p><ul><li><p>High end SSD such as Samsung;s 850 Pro 128GB drive (~$100, 10yr/300TBW warranty)</p></li></ul></li><li><p>Accessories<br /></p><ul><li><p>I highly recommend investing in <a href="http://www.silverstonetek.com/index.php?area=en">SilverStone</a> <a href="http://www.silverstonetek.com/product.php?pid=445&amp;area=en">CP11</a> SATA cables, as they will make one&#039;s life easier when routing through a mini-ITX case.&nbsp; At $10/cable on Newegg, they&#039;re 5x the price of regular SATA cables, but they&#039;re worth it due to their size and how they can be bent.&nbsp; <br /></p><ul><li><p>IIRC, SilverStone made these cables specifically for their NAS project with AsRock, with AsRock manufacturing their C2550D4I/C2750D4I server boards specifically for SilverStone&#039;s DS380 and vice versa for DIY NAS builders.</p></li><li><p>I personally prefer the 1st gen CP11&#039;s, which are blue, over that of the 2nd gens that are black.&nbsp; It seems like they switched shielding materials between the generations as I had repeated data corruption issues on 4 of the 6 black CP11&#039;s I had, whereas I haven&#039;t had a single issue with any of the 15 blue CP11&#039;s I use.</p></li></ul></li></ul></li><li><p>To download Sophos UTM, first create a <a href="https://myutm.sophos.com/">My UTM</a> user account to receive the free home user license, then register for a <a href="https://secure2.sophos.com/login.aspx">Sophos</a> account.&nbsp; For company and occupation, type &quot;Self&quot;.</p><p>Once you&#039;ve logged in, download the ISO under <a href="https://www.sophos.com/en-us/support/utm-downloads.aspx">Software Appliance</a>.</p><ul><li><p>There is a bug that was introduced a few months back that requires manual fixing.&nbsp; Once you&#039;ve installed/updated to 9.405+, you&#039;ll need to SSH in and perform the steps listed in <a href="https://community.sophos.com/products/unified-threat-management/f/hardware-installation-up2date-licensing/80641/sophos-utm-9-407-3-released/306734#306734">this</a> post to disable WAN MTU autodiscovery.</p></li></ul></li></ul>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p341897">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">JW0914</div>
					<div class="post-datetime">
						23 Oct 2016, 17:54					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>gsustek wrote:</cite><blockquote><p>@JW0914 great comprehensive description of your setup. I have few questions:<br />1. UTM can not be VPN or NAS server.Then you have this :&quot;A major benefit is VPN speed, with a massive performance....&quot; <br />2. can you elaborate more about &quot; 5 different VPN types (including HTML5)&quot; UTM feature<br />3, UTM is the first thing after your ISP as WAN connection/NAT/FW and other UTM specific features)? Then goes ACS? for what, what do you still miss on UTM beside VPN and NAS? if you need wifi you can put some PCI wifi card into server board and use openwrt for x86(if you want openwrt for your routing)<br />4. please answer is it possible the following setup: two VM machines on mini-ITX board, one is S UTM connected directly on WAN port,S UTM do his own job(web filtering, etc..)&nbsp; then fort forwarding from UTM firewall to the next VM with Openwrt(x86) where you put VPN and NAS server:-) It is AllinOne solution.<br />5. is there mini-itx board with SFP slot ? to eliminate ONT?</p></blockquote></div><ol class="decimal"><li><p>It cannot be configured as a VPN client [not server], as that poses a massive security risk to corporations and businesses.&nbsp; Sophos UTM for home users is the exact same OS that&#039;s licensed to businesses, simply without specific license features that would apply mainly to paid [business] licensees.&nbsp; To provide an idea of the sophistication of the OS, paid licenses for businesses start at the $600/yr range and go past $10k/yr.<br />.</p></li><li><p>VPN Types<br /></p><ul><li><p>Site-to-Site VPN Servers (<em>Router&nbsp; &lt;-&gt; Router</em>)<br /></p><ul><li><p>Amazon VPC</p></li><li><p>IPsec</p></li><li><p>SSL [OpenVPN]</p></li></ul></li><li><p>Remote Access (<em>Sophos UTM &lt;-&gt; Client</em>)<br /></p><ul><li><p>SSL [OpenVPN]</p></li><li><p>PPTP</p></li><li><p>L2TP over IPsec</p></li><li><p>IPsec</p></li><li><p>HTML5 VPN Portal</p></li><li><p>Cisco VPN Client</p></li></ul></li></ul></li><li><p>I run my network with Sophos UTM as the WAN facing router, with my ACS as a smart switch<br /></p><ul><li><p>5 LANs<br /></p><ul><li><p>eth0 &amp; eth1 bridged - Subnet .0/26 [ACS configured as the main DHCP server, with DHCP relay specified in Sophos, allowing for the ACS to serve as the DHCP &amp; DNS server, rather than Sophos, for the .0/26 subnet]</p></li><li><p>eth2 - Subnet .64/26 [Sophos configured as DHCP server, with this connected to my FreeNAS server to serve as dhcp &amp; DNS server to my jails]</p></li><li><p>eth3 - WAN</p></li><li><p>IPMI connected to ACS</p></li></ul></li><li><p>You can run OpenWrt as a VM, however it depends on what features of OpenWrt you want as many features and packages [menuconfig] are not available for OpenWrt&#039;s x86 crossover.</p></li></ul></li><li><p>That config would work</p></li><li><p>I have no experience with fiber, however I would imagine so. I&#039;d check newegg or board manufacturers&#039; website&#039;s directly.&nbsp; SuperMicro&#039;s website has the largest selection of enterprise server boards I&#039;ve seen</p></li></ol><p>If one chooses to use the web filtering capabilities of Sophos for children, it&#039;s highly recommended to setup MAC exceptions for devices adults use.&nbsp; Transparent web filtering will result with any device it&#039;s configured for being slowed to 30mbps [LAN side] due to the fact all packets are decrypted, scanned, re-encrypted, then signed by Sophos&#039; Proxy CA. If one has no need for web filtering, simply disable it altogether</p>											<p class="post-edited">(Last edited by <strong>JW0914</strong> on 25 Oct 2016, 18:27)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p341903">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">gsustek</div>
					<div class="post-datetime">
						23 Oct 2016, 18:35					</div>
				</div>
				<div class="post-content content">
					<p>question 1. repeated: A major benefit is VPN speed, with a massive performance....you mention that OpenVPN,is not possible in S UTM, but you post after that this: <br /></p><div class="codebox"><pre><code>    A major benefit is VPN speed, with a massive performance gain when processing encryption over that of my ACS.

1st Line:   WRT1900ACS      DD [4.4.14-2016.09.26, r49936]
2nd Line:   A1SRi-2758F     Sophos UTM [8C 2.4gHz / 16GB ECC RAM / 128GB 850 Pro]

Doing sha256 for 3s on 16 size blocks: 1547137 sha256&#039;s in 3.00s
Doing sha256 for 3s on 16 size blocks: 2460459 sha256&#039;s in 3.00s
    Doing sha256 for 3s on 64 size blocks: 824553 sha256&#039;s in 3.00s
    Doing sha256 for 3s on 64 size blocks: 1366848 sha256&#039;s in 3.00s
Doing sha256 for 3s on 256 size blocks: 347862 sha256&#039;s in 2.99s
Doing sha256 for 3s on 256 size blocks: 574461 sha256&#039;s in 3.00s</code></pre></div><p>why?</p><p>2. what do you do with those five types off VPN?&nbsp; UTM inspect them?&nbsp; <br />Especially this &quot;Remote Access (Sophos UTM &lt;-&gt; Client)&quot; this connection goes through UTM to openvpn server behind UTM?</p><p>3. openwrt for x86, i would never sad that there is less packages or features for that architecture !!! Why is that, you just compile packages for another architecture it should be the same as MIPS or ARM.</p><p>Regards,<br />Goran.</p>											<p class="post-edited">(Last edited by <strong>gsustek</strong> on 23 Oct 2016, 18:37)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p341904">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">JW0914</div>
					<div class="post-datetime">
						23 Oct 2016, 18:43					</div>
				</div>
				<div class="post-content content">
					<p>You&#039;re confusing two separate VPN states... Sophos UTM fully supports being a VPN server, but cannot be configured as a VPN <strong><span class="bbu">client</span></strong> <em>unless it&#039;s connecting via RED to another UTM box</em>.</p><p>VPN Server: UTM as the <em>server</em> with clients connecting to it <span style="color: #789600">&lt;&lt;&lt; possible</span><br />VPN Client: UTM as a <em>client</em>, connecting to another VPN server <span style="color: #AF0000">&lt;&lt;&lt; not possible</span></p><p>OpenWrt x86 does not have the same options/features and packages available to other architectures.&nbsp; You&#039;ll need to check out menuconfig for x86 side by side with menuconfig for an ARM processor such as the WRT series... you&#039;ll notice many options and packages are missing from menuconfig for the x86 architecture</p>											<p class="post-edited">(Last edited by <strong>JW0914</strong> on 23 Oct 2016, 18:45)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p341905">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">gsustek</div>
					<div class="post-datetime">
						23 Oct 2016, 18:54					</div>
				</div>
				<div class="post-content content">
					<p>thnx, i overlook your sentence: &quot;It cannot be configured as a VPN client, except if connecting to another UTM HA/SA&quot;</p><p>do you know the reason why is that way,regarding OpenWrt x86?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p341906">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">JW0914</div>
					<div class="post-datetime">
						23 Oct 2016, 19:01					</div>
				</div>
				<div class="post-content content">
					<p>not a clue.&nbsp; nitroshift or sera would be great people to ask, or hop on the OpenWrt IRC channel and ask =]</p>											<p class="post-edited">(Last edited by <strong>JW0914</strong> on 23 Oct 2016, 19:04)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p341907">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">JW0914</div>
					<div class="post-datetime">
						23 Oct 2016, 19:11					</div>
				</div>
				<div class="post-content content">
					<p><strong>@gsustek</strong>&nbsp; Depending on what you wanted an x86 OpenWrt build for, it would probably be more convenient to simply utilize FreeBSD VMs for SAMBA, NFS, Transmission, and other media type services available to OpenWrt.&nbsp; </p><p>FreeBSD is easily the best OS there is for servers, with loads of HowTos on the FreeBSD and FreeNAS forums.&nbsp; FreeNAS can be run in a VM, however it does so with mixed results and is not recommended by FreeNAS devs, albeit I can&#039;t remember if FreeNAS 10 [likely to be released in the coming months] changes this.</p>											<p class="post-edited">(Last edited by <strong>JW0914</strong> on 25 Oct 2016, 18:29)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p341909">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">gsustek</div>
					<div class="post-datetime">
						23 Oct 2016, 19:25					</div>
				</div>
				<div class="post-content content">
					<p>i also use mjpg-streamer, mini-dlna,ftp,samba,motion<br />so what do you use for NAS zfs?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p341911">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">augustus_meyer</div>
					<div class="post-datetime">
						23 Oct 2016, 19:59					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>JW0914 wrote:</cite><blockquote><p>Transparent web filtering will result with any device it&#039;s configured for being slowed to 30mbps [LAN side] due to the fact all packets are decrypted, scanned, re-encrypted, then signed by Sophos&#039; Proxy CA.</p></blockquote></div><p>Does this feature need installation of special certs on the client devices (as I do not know of any other method of filtering https-traffic. But still learning :-)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p341914">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">JW0914</div>
					<div class="post-datetime">
						23 Oct 2016, 20:36					</div>
				</div>
				<div class="post-content content">
					<p><strong>@gsustek</strong> All of those, or equivalencies, should be available on FreeBSD through the ports collection.&nbsp; ZFS should always be used as it&#039;s a self-healing file system that eradicates corruption.</p><br /><p><strong>@augustus_meyer</strong> Nope, Sophos auto creates it&#039;s own CAs.&nbsp; I would recommend creating your own CA, using it to create and sign all the certs you&#039;ll need for Sophos, then uploading all to Sophos as PCKS12 certs.</p><p>I created a pre-built <a href="https://github.com/JW0914/Wikis/blob/master/Scripts%2BConfigs/OpenSSL/OpenSSL.cnf">openssl.cnf</a> specifically for Sophos which can be found on <a href="https://JW0914.GitHub.io">my GitHub</a>.&nbsp; All commands &amp; info required start at line 546; however my OpenVPN wiki&#039;s <a href="https://wiki.openwrt.org/doc/howto/openvpn-streamlined-server-setup#encryption">Encryption section</a> will walk you through it step by step.</p><p>All certs, except the WebAdmin, must be issued by a CA, not an ICA; the WebAdmin can be issued by an ICA for a FQDN.&nbsp; Required certs are split into two categories, UTM OS certs and UTM User certs:<br /></p><ul><li><p><strong>UTM OS Certs</strong><br /></p><ul><li><p><em>IPsec VPN Server</em></p></li><li><p><em>Local x509 Self Cert</em></p></li><li><p><em>SSL VPN Server</em></p></li><li><p><em>WebAdmin</em></p></li></ul></li><li><p><strong>UTM User Certs</strong><br /></p><ul><li><p><em>Admin [required]</em></p></li><li><p><em>User1</em></p></li><li><p><em>User2</em></p></li><li><p><em>...and so on</em></p></li></ul></li><li><p><strong>Sophos will auto create a Client Authentication Certificate</strong><em> [IP of 1.2.3.4]</em></p></li></ul>											<p class="post-edited">(Last edited by <strong>JW0914</strong> on 23 Oct 2016, 23:28)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p341930">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">gsustek</div>
					<div class="post-datetime">
						23 Oct 2016, 22:57					</div>
				</div>
				<div class="post-content content">
					<p>i <br /></p><div class="quotebox"><cite>JW0914 wrote:</cite><blockquote><p><strong>@gsustek</strong> All of those, or equivalencies, should be available on FreeBSD through the ports collection.&nbsp; ZFS should always be used as it&#039;s a self-healing file system that eradicates corruption.</p></blockquote></div><p>i am fan of luci, is it available on freebsd? zfs i resource hungry, thats why is int suited for our routers..(with 512Mb of RAM)</p>											<p class="post-edited">(Last edited by <strong>gsustek</strong> on 23 Oct 2016, 22:57)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p341934">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">JW0914</div>
					<div class="post-datetime">
						23 Oct 2016, 23:28					</div>
				</div>
				<div class="post-content content">
					<p>I should have better articulated a few things =]</p><p>ZFS should be utilized if running a (or multiple) FreeBSD VM in lieu of OpenWrt for services not offered via OpenWrt&#039;s x86 build.</p><p>As to LuCI, I don&#039;t have a clue... you should be able to find out through google or via FreeBSD&#039;s forum</p>											<p class="post-edited">(Last edited by <strong>JW0914</strong> on 23 Oct 2016, 23:28)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p341938">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">JW0914</div>
					<div class="post-datetime">
						24 Oct 2016, 00:02					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>gsustek wrote:</cite><blockquote><p>thnx, i overlook your sentence: &quot;It cannot be configured as a VPN client, except if connecting to another UTM HA/SA&quot;</p><p>do you know the reason why is that way,regarding OpenWrt x86?</p></blockquote></div><p>It&#039;s a massive security risk to corporations.&nbsp; Sophos UTM, even with a free home user license, is the exact same OS that is licensed to their corporate customers.&nbsp; I assume Sophos&#039; reasons for offering it free for home use only is they&#039;re able to get a larger overall user base that provides a larger arena for testing, combined with the more people that use it, the more secure their corporate customers are. Since a single license for a year is something in the $600 range, with yearly licensing easily breaking the $10k/yr mark for most businesses, it&#039;s a huge win for home users.</p>											<p class="post-edited">(Last edited by <strong>JW0914</strong> on 24 Oct 2016, 00:05)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p341996">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">kirkgbr</div>
					<div class="post-datetime">
						24 Oct 2016, 18:38					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for the great info JW.&nbsp; I have downloaded Sophos UTM and now tinkering with it on a vm.&nbsp; Looks pretty cool.&nbsp; Your idea does spark my interest because I very much prefer having dedicated devices for different services.&nbsp; I&#039;m thinking something like an Apple Mac Mini might already have the all the required hardware in one small footprint.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p342205">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">JW0914</div>
					<div class="post-datetime">
						26 Oct 2016, 23:34					</div>
				</div>
				<div class="post-content content">
					<p>If anyone&#039;s interested, <a href="http://www.newegg.com/Product/Product.aspx?Item=N82E16813157614&amp;ignorebbr=1">Newegg</a> has the <a href="http://www.asrockrack.com/general/productdetail.asp?Model=J1900D2Y#Specifications">AsRock J1900D2Y</a> on sale for today only for $130 with promo code 102624HR08</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p342309">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">toyotabedzrock</div>
					<div class="post-datetime">
						28 Oct 2016, 03:41					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>JW0914 wrote:</cite><blockquote><p>If one chooses to use the web filtering capabilities of Sophos for children, it&#039;s highly recommended to setup MAC exceptions for devices adults use.</p></blockquote></div><p>The porn for me but not for thee idea. Also know as the irrational idea by parents that the child will not just work around your restrictions and not tell you.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p342310">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">JW0914</div>
					<div class="post-datetime">
						28 Oct 2016, 03:44					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>toyotabedzrock wrote:</cite><blockquote><div class="quotebox"><cite>JW0914 wrote:</cite><blockquote><p>If one chooses to use the web filtering capabilities of Sophos for children, it&#039;s highly recommended to setup MAC exceptions for devices adults use.</p></blockquote></div><p>The porn for me but not for thee idea. Also know as the irrational idea by parents that the child will not just work around your restrictions and not tell you.</p></blockquote></div><p>It&#039;s not possible to bypass the web filtering of Sophos if it&#039;s configured correctly... it&#039;s difficult enough trying to gain access to regular content, which is why if one doesn&#039;t need web filtering, they should simply leave it disabled.&nbsp; Web Filtering for an entire network and all devices on that network takes a few hours to fully configure and hours of troubleshooting when content is blocked that shouldn&#039;t be.&nbsp; For example, here&#039;s a screenshot of the rules needed just to stream Netflix with Web Filtering enabled: <a href="https://1drv.ms/i/s!Aqp3KD9IuSlugscWQNxego4ywwkAGA">https://1drv.ms/i/s!Aqp3KD9IuSlugscWQNxego4ywwkAGA</a></p><p>Sophos UTM isn&#039;t some obscure opensource OS... it&#039;s an investment in the 5+ figures for corporations and enterprises to protect their networks (that&#039;s just for SA licenses... HA purchases, and the required licenses for them, are far more expensive).</p><p>Most have never heard of Sophos because they only sell to businesses, however they were the 4th largest AntiVirus company in the world in 2011 (it&#039;s likely they&#039;re in the top 3 today after their acquisition of Astaro back in 2011), right behind Fortinet, SonicWall, and WatchGaurd at that point in time.&nbsp; Many retailers and banks utilize Sophos, especially for RED within their different branches and stores, allowing each remote Sophos SA/HA to have a secure tunnel back to HQ over which all data flows, thereby preventing any data from being exposed to the public internet.&nbsp; It&#039;s more than just a VPN however, as no traffic from remote UTMs [branches, stores] is ever given access to the public internet.&nbsp; Traffic would flow: </p><div class="codebox"><pre><code>Remote network on RED (all traffic) &gt;&gt; HQ UTM Intranet [internal network] &gt;&gt; HQ UTM VLAN &gt;&gt; Public WAN</code></pre></div><ul><li><p>Regardless of whether a corporation is utilizing Sophos, SonicWall, or another UTM solution, this is one of the reasons why there&#039;s a lag on retailers&#039; registers, such as Best Buy&#039;s, where the register acts as both a register and Intranet terminal.</p></li></ul>											<p class="post-edited">(Last edited by <strong>JW0914</strong> on 28 Oct 2016, 05:36)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>