<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Basic DHCP WAN Configuration Help</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 23 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p204703">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">earl-g</div>
					<div class="post-datetime">
						15 Jun 2013, 17:39					</div>
				</div>
				<div class="post-content content">
					<p>Hello all,<br />I have just successfully flashed my <a href="http://wiki.openwrt.org/toh/tp-link/tl-wr740n">TL-740Wn v4.23 </a> with Attitude Adjustment.<br />I, however, know little about networking and how to effectively troubleshoot the setup. </p><p>Using stock firmware, the wr740n would successfully connect to the Internet using DHCP.<br />Using lUCI With openwrt installed, the ethernet to the router is labelled green and has steadily increasing uptime. The WAN interface is red and has a 0 uptime. I use Comcast as my ISP and connect my router to a modem.</p><p>All traceroutes and pings fail with &#039;bad address openwrt.org&#039;<br />What configuration settings do I need to change to bring up the WAN interface? (I am assuming that &#039;bring up the WAN interface&#039; means connect to the Internet). I am also comfortable using the command line to assist whatever.<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# uci -P/var/state show network.state
uci: Entry not found
network.loopback=interface
network.loopback.ifname=lo
network.loopback.proto=static
network.loopback.ipaddr=127.0.0.1
network.loopback.netmask=255.0.0.0
network.loopback.up=1
network.loopback.connect_time=21
network.loopback.device=lo
network.lan=interface
network.lan.type=bridge
network.lan.proto=static
network.lan.ipaddr=192.168.1.1
network.lan.netmask=255.255.255.0
network.lan.up=1
network.lan.connect_time=18
network.lan.device=eth0
network.lan.ifname=br-lan
network.wan=interface
network.wan.proto=dhcp
network.wan._orig_ifname=eth1
network.wan._orig_bridge=false
network.wan.ifname=eth0.1
network.@switch[0]=switch
network.@switch[0].name=eth0
network.@switch[0].reset=1
network.@switch[0].enable_vlan=1
network.@switch_vlan[0]=switch_vlan
network.@switch_vlan[0].device=eth0
network.@switch_vlan[0].vlan=1
network.@switch_vlan[0].ports=0 1 2 3 4</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p204705">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">jeffjj</div>
					<div class="post-datetime">
						15 Jun 2013, 18:09					</div>
				</div>
				<div class="post-content content">
					<p>Check out this thread, i have a feeling our solution will help you as well.</p><p><a href="https://forum.openwrt.org/viewtopic.php?id=44697">https://forum.openwrt.org/viewtopic.php?id=44697</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p204708">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						15 Jun 2013, 18:55					</div>
				</div>
				<div class="post-content content">
					<p>OpenWrt might use a different mac address compared to the stock firmware, so before troubleshooting anything else first reset your cable modem and see if your OpenWrt is able to obtain a lease afterwards.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p204719">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">earl-g</div>
					<div class="post-datetime">
						15 Jun 2013, 20:22					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for the suggestions folks.<br />Jow, I did try reseting the Modem but that did not seem to affect it.<br />jeffjj, that thread looks promising I&#039;ll check it out.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p204728">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">earl-g</div>
					<div class="post-datetime">
						16 Jun 2013, 00:01					</div>
				</div>
				<div class="post-content content">
					<p>I have reset the modem a few times and do not notice the connection being made.<br />I am referencing the following threads,<br /><a href="https://forum.openwrt.org/viewtopic.php?pid=204436#p204436,">https://forum.openwrt.org/viewtopic.php â€¦ 6#p204436,</a> <br /><a href="https://forum.openwrt.org/viewtopic.php?id=44467">https://forum.openwrt.org/viewtopic.php?id=44467</a><br />I have followed hajj&#039;s steps <a href="https://forum.openwrt.org/viewtopic.php?pid=204436#p204436">3-6</a> but the WAN still does not change.</p><p>I am going to apply <a href="https://dev.openwrt.org/attachment/ticket/13581/dhcp.sh-none.2.patch">this dhcp.sh patch</a> and see if that will cause the WAN to be recognized.<br />Should my WAN MAC address match the router&#039;s LAN one? Or whould it be, as jeffjj <a href="https://forum.openwrt.org/viewtopic.php?pid=204404#p204404">suggested by +1</a>,&nbsp; the LAN address with the last digit in the rightmost hexadecimal increased by 1?</p><p>Or should it be the modem&#039;s MAC address?<br />As a side note, I am hotplugging my ethernet cable in my other wired router to make these posts. Could that cause issues with the modem binding to only 1 of the routers?<br /></p><h5> Update </h5><p>Thanks again jeffjj and jow. A combination of your suggestions have led me to a solution.<br />Solution Steps<br /></p><ol class="decimal"><li><p>I reset my router to ensure I had not misconfigured something. </p></li><li><p>I patched dhcp.sh with the above mentioned patch </p></li><li><p>I saved the settings and rebooted the router </p></li><li><p>I then reset my modem (pulled the power plug) </p></li><li><p>Jumped for joy at the sound of successful pings </p></li></ol><p>In my original WAN configuration, I had it set to vlan which I think blocked the WAN connection.<br />The patch presumably addressed my second question by appyling C7 as the last hexadecimal compared to C5 for my LAN interface.</p>											<p class="post-edited">(Last edited by <strong>earl-g</strong> on 16 Jun 2013, 00:50)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>