<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> TP-Link TL-WDR3600 switch</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 3 Apr 2018 and 20 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=48086&amp;p=2.html">2</a></li></ul></nav></div>
			
		
		
			<article class="post" id="p221239">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">jonm</div>
					<div class="post-datetime">
						30 Dec 2013, 13:52					</div>
				</div>
				<div class="post-content content">
					<p>Hello all,</p><p>I&#039;m trying to use OpenWrt on a TP-Link TL-WDR3600 version 1.4, but it&#039;s hardly usable.<br />I get packet losses resulting in very poor performance (transfers get stuck for a couple of seconds).<br /><strong>Stock firmware is working perfectly in every respect.</strong></p><p>In my setup, TP-Link is an AP. One of LAN cables goes to a DOCSIS router<br />Technicolor TC7200, another one to a PC.</p><p>Interestingly, this issue applies only to Internet traffic,<br />LAN traffic (going through WDR3600 and TC7200) is not affected.</p><p>OpenWrt version: from AA to latest trunk.</p><p>Has anyone any suggestion (apart from exchanging the DOCSIS device for different model)?<br />Thanks in advance.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p221508">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">kgoerbig</div>
					<div class="post-datetime">
						2 Jan 2014, 20:14					</div>
				</div>
				<div class="post-content content">
					<p>You mentioned LAN traffic isn&#039;t affected. According to TC7200 specs, it has built in WIFI. Odds are if WIFI is enabled on both OpenWRT and the TC7200, there may be WIFI interference.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p221514">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">jonm</div>
					<div class="post-datetime">
						2 Jan 2014, 23:22					</div>
				</div>
				<div class="post-content content">
					<p>It&#039;s not wifi. The problems begin right after flashing OpenWrt, with default config (wifi disabled).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p221516">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">kgoerbig</div>
					<div class="post-datetime">
						2 Jan 2014, 23:42					</div>
				</div>
				<div class="post-content content">
					<p>I have the TP-Link TL-WDR3600 as well running on OpenWRT Attitude (AA). BB (Breaking Barrier) revision I found to be buggy on this device. If you are running BB, you may consider flashing AA instead. </p><p>I also had issues when I first installed AA on the TP-Link TL-WDR3600 with the firewall. Once I uninstalled the firewall, and then reinstalled firewall again, and it re-wrtote a new firewall config, rebooted, everything worked flawless with WAN traffic.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p221543">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">jonm</div>
					<div class="post-datetime">
						3 Jan 2014, 11:38					</div>
				</div>
				<div class="post-content content">
					<p>Firewall has nothing to do here. I&#039;m having this issue even when WDR3600 is merely switching.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p221680">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">jonm</div>
					<div class="post-datetime">
						5 Jan 2014, 00:42					</div>
				</div>
				<div class="post-content content">
					<p>To illustrate this issue I did a little test.<br />HTTP download of a 16 MiB file from internet to a PC. Wired connection.</p><p>With stock firmware:<br /><span class="postimg"><img src="http://i.imgur.com/XTJXDvL.gif" alt="Download with stock" /></span></p><p>With OpenWrt latest trunk:<br /><span class="postimg"><img src="http://i.imgur.com/MGCGaHU.gif" alt="Download with OpenWrt" /></span></p><p>Cabling was exactly the same (all cables connected to LAN ports).<br />Network config the same.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p221681">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">zhadoom</div>
					<div class="post-datetime">
						5 Jan 2014, 00:52					</div>
				</div>
				<div class="post-content content">
					<p>Since LAN to LAN traffic is unaffected, the switch must be working OK.</p><p>Did you already tried to disable jumbo frames in PC LAN interface ? Atheros SOC doesn&#039;t support jumbo frames.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p221708">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">jonm</div>
					<div class="post-datetime">
						5 Jan 2014, 10:36					</div>
				</div>
				<div class="post-content content">
					<p>Jumbo frames are disabled all the time.</p><p>As I mentioned, all cables go to the LAN ports. WAN port is free. VLAN config is default.</p><p>So this IS the switch.</p><p>It appears that the traffic between devices in my apartment is unaffected.</p><p>The traffic traversing the NAT in cable modem/router is clearly affected.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p221714">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">zhadoom</div>
					<div class="post-datetime">
						5 Jan 2014, 13:33					</div>
				</div>
				<div class="post-content content">
					<p>Any QoS or shaping software installed in the router ?</p><p>Qo-scripts package relies on info about the internet link from the config file, where upload and download speeds are declared.</p>											<p class="post-edited">(Last edited by <strong>zhadoom</strong> on 5 Jan 2014, 13:36)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p221725">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">jonm</div>
					<div class="post-datetime">
						5 Jan 2014, 16:27					</div>
				</div>
				<div class="post-content content">
					<p>I have no QoS related software on WDR3600.</p><p>The cable modem/router doesn&#039;t use QoS, too.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p221763">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">jonm</div>
					<div class="post-datetime">
						5 Jan 2014, 23:42					</div>
				</div>
				<div class="post-content content">
					<p>After some research, I found the culprit.</p><p>Disabling IEEE 802.3az LPI solves the issue for the moment.</p><p>Currently, EEE_CTRL is not initialized at all (by default LPI is enabled for all ports).</p><p>Ideally, it would be configurable from userspace.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p221816">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">golialive</div>
					<div class="post-datetime">
						6 Jan 2014, 16:36					</div>
				</div>
				<div class="post-content content">
					<p>Hey Jonm.</p><p>Could you elaborate a bit what you did? Is this a config option for /etc/config/network? I tried to investigate about config options for the &quot;config switch&quot; and &quot;config switch_vlan&quot;, but the official documentation only covers very view settings.</p><p>Regards,<br />Stephan.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p221823">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">jonm</div>
					<div class="post-datetime">
						6 Jan 2014, 18:54					</div>
				</div>
				<div class="post-content content">
					<p>Hi Stephan,</p><p>Unfortunately, it&#039;s not configurable yet.</p><p>I added this to target/linux/generic/files/drivers/net/phy/ar8216.h:<br /></p><div class="codebox"><pre><code>#define AR8327_REG_EEE_CTRL        0x100</code></pre></div><p>and this to target/linux/generic/files/drivers/net/phy/ar8216.c:<br /></p><div class="codebox"><pre><code>        priv-&gt;write(priv, AR8327_REG_EEE_CTRL, 1&lt;&lt;12 | 1&lt;&lt;10 | 1&lt;&lt;8 | 1&lt;&lt;6 | 1&lt;&lt;4);</code></pre></div><p>inside ar8327_hw_config_pdata().</p><br /><p>Best wishes,<br />Jonm</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p221995">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">jonm</div>
					<div class="post-datetime">
						7 Jan 2014, 23:27					</div>
				</div>
				<div class="post-content content">
					<p>Or better disable it selectively for one port, e.g.:<br /></p><div class="codebox"><pre><code>        t = priv-&gt;read(priv, AR8327_REG_EEE_CTRL);
        t |= 1&lt;&lt;4;
        priv-&gt;write(priv, AR8327_REG_EEE_CTRL, t);</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p222007">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">golialive</div>
					<div class="post-datetime">
						8 Jan 2014, 00:15					</div>
				</div>
				<div class="post-content content">
					<p>Hey Jonm.</p><p>Thank you for your response.<br />I don&#039;t have any issues with that, so I most likely will not try this in the near future. But good to know that there is such a thing, and good to know that this is available through source code manipulation currently.</p><p>I don&#039;t know if adjusting the LPI selectively is really better. This results in having switch ports that appear completely equal in both, GUI and hadware behave differently. Who hasn&#039;t ever adjusted his wires because of furniture moving and didn&#039;t take notes which wire has to go where. When all switch ports are equal or if differences can be seen on the GUI tool, that&#039;s not a problem. But I usually don&#039;t store source code for several years.<br />Don&#039;t get me wrong, I do see why having this adjusted selctively sould be possible. But I dislike having such a configuration with no proper configuration interface (config files are good as well, of course).</p><p>Regards,<br />Stephan.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p222036">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">jonm</div>
					<div class="post-datetime">
						8 Jan 2014, 08:32					</div>
				</div>
				<div class="post-content content">
					<p>Energy Efficient Ethernet means cooler switch IC and lower energy bills, so I prefer to have it enabled wherever possible.</p><p>And maybe this issue is solvable by fine tuning AR8327N parameters instead of disabling the feature. However, as the issue manifests so rarely, I doubt any OpenWrt developer will ever do anything with it.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p222052">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">zloop</div>
					<div class="post-datetime">
						8 Jan 2014, 11:32					</div>
				</div>
				<div class="post-content content">
					<p>could you please provide the test script / commands that create those graphs ?</p><p>I might have seen Issues with EEE too or these might be bugs of client LAN chip (both Intel with EEE : 82574LM and 82579V)<br />atm I deactivated EEE on the Intel side</p><div class="quotebox"><blockquote><p>And maybe this issue is solvable by fine tuning AR8327N parameters instead of disabling the feature. However, as the issue manifests so rarely, I doubt any OpenWrt developer will ever do anything with it.</p></blockquote></div><p>jumbo frames on AR8327N were just enabled in december 2013 (<a href="https://dev.openwrt.org/changeset/39076">changeset 39076</a>) - EEE might take a short time ^^<br />If nobody reports to the mailing list/bug tracker the issue will not be widely known <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>I am willing to test with AR8327N (WDR3600, Archer C7) and AR8337N (sitecom wlr-8100) and some client HW with/without EEE to track down the bug</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p222064">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">jonm</div>
					<div class="post-datetime">
						8 Jan 2014, 12:14					</div>
				</div>
				<div class="post-content content">
					<p>These particular graphs were created by hand with qtiplot. Data were collected from ifconfig output every 250 ms. And transfer was performed with wget. But normally I observe the net behaviour with KDE Network Monitor Widget that sits on my desktop.</p><p>For me, these problems exist exclusively between WDR3600 and my cable modem.</p><p>It might be reported already: <a href="https://dev.openwrt.org/ticket/14597">#14597</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p222779">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">spitsw</div>
					<div class="post-datetime">
						15 Jan 2014, 05:09					</div>
				</div>
				<div class="post-content content">
					<p>I have a similar setup:</p><p>* WDR4300 v1.6 running BB trunk<br />* Default settings<br />* LAN port 1 connected a switch<br />* LAN as a DHCP client<br />* WAN port not connected</p><p>Internet access from the WDR4300 was woeful. Applied the changes posted by jonm and the problem was&nbsp; resolved.</p><p>I would love to see the patch applied to trunk.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p223587">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">vaggelis</div>
					<div class="post-datetime">
						24 Jan 2014, 02:27					</div>
				</div>
				<div class="post-content content">
					<p>Hi,i me too have problem with tp-link wdr3600 v1.4,running AA r33312.I can constandly&nbsp; see dropped packets in network interface.I have also problem with the wifi,it is stop working all the time and i have to restart the wireless in order to work.<br />So is there any solution in my problem?I want to have fix it so i have a stable system and then install packages...<br />Do i have to make a new image?What changes sould i do?<br />Thank you very much.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p223589">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">eeff11</div>
					<div class="post-datetime">
						24 Jan 2014, 03:31					</div>
				</div>
				<div class="post-content content">
					<p>It&#039;s the bug of AR8327 in openwrt.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p223608">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">vaggelis</div>
					<div class="post-datetime">
						24 Jan 2014, 11:41					</div>
				</div>
				<div class="post-content content">
					<p>So what should i do?Not about the switch issue about the wifi.The wifi is unstable.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p226777">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">mod77</div>
					<div class="post-datetime">
						4 Mar 2014, 12:29					</div>
				</div>
				<div class="post-content content">
					<p>Hello all,<br />i have the similiar issue.</p><p>can please anyone provide a patch file for me?</p><p>thank you.</p><p>mod77</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p226806">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">mod77</div>
					<div class="post-datetime">
						4 Mar 2014, 21:23					</div>
				</div>
				<div class="post-content content">
					<p>Just for Info:<br />As workaround i put an old 100Mbit Switch between the WDR3600 and Technicolor 7200.<br />Solved the Problem for me as an temporary solution.</p><p>But i`m still interested for an Openwrt Patch.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p226821">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">jonm</div>
					<div class="post-datetime">
						5 Mar 2014, 00:37					</div>
				</div>
				<div class="post-content content">
					<p><a href="https://drive.google.com/folderview?id=0B6Wxvjei-NbrcC16dWlLUDk4UEU&amp;usp=sharing">Here</a> I place a working patch and an image for 3600 (BB, r39770).</p>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=48086&amp;p=2.html">2</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>