<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> No space left on device during install of asterisk - 84.00 KB left</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 5 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p168303">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">linuxuser</div>
					<div class="post-datetime">
						28 May 2012, 00:29					</div>
				</div>
				<div class="post-content content">
					<p>I tried to install asterisk and then I got &quot;No space left on device&quot;</p><div class="quotebox"><blockquote><p>Installing asterisk18 (1.8.7.1-1) to root...<br />Downloading <a href="http://downloads.openwrt.org/backfire/10.03.1/ar71xx/packages/asterisk18_1.8.7.1-1_ar71xx.ipk">http://downloads.openwrt.org/backfire/1 … ar71xx.ipk</a>.<br />Installing libopenssl (0.9.8r-1) to root...<br />Downloading <a href="http://downloads.openwrt.org/backfire/10.03.1/ar71xx/packages/libopenssl_0.9.8r-1_ar71xx.ipk">http://downloads.openwrt.org/backfire/1 … ar71xx.ipk</a>.<br />Installing zlib (1.2.3-5) to root...<br />Downloading <a href="http://downloads.openwrt.org/backfire/10.03.1/ar71xx/packages/zlib_1.2.3-5_ar71xx.ipk">http://downloads.openwrt.org/backfire/1 … ar71xx.ipk</a>.<br />Installing libncurses (5.7-2) to root...<br />Downloading <a href="http://downloads.openwrt.org/backfire/10.03.1/ar71xx/packages/libncurses_5.7-2_ar71xx.ipk">http://downloads.openwrt.org/backfire/1 … ar71xx.ipk</a>.<br />Installing libpopt (1.7-5) to root...<br />Downloading <a href="http://downloads.openwrt.org/backfire/10.03.1/ar71xx/packages/libpopt_1.7-5_ar71xx.ipk">http://downloads.openwrt.org/backfire/1 … ar71xx.ipk</a>.<br />Installing libpthread (0.9.30.1-43.32) to root...<br />Downloading <a href="http://downloads.openwrt.org/backfire/10.03.1/ar71xx/packages/libpthread_0.9.30.1-43.32_ar71xx.ipk">http://downloads.openwrt.org/backfire/1 … ar71xx.ipk</a>.<br />Installing librt (0.9.30.1-43.32) to root...<br />Downloading <a href="http://downloads.openwrt.org/backfire/10.03.1/ar71xx/packages/librt_0.9.30.1-43.32_ar71xx.ipk">http://downloads.openwrt.org/backfire/1 … ar71xx.ipk</a>.<br />Configuring librt.<br />Configuring libpthread.<br />Configuring libncurses.<br />Configuring zlib.<br />Configuring libpopt.<br />Configuring libopenssl.<br />Collected errors:<br /> * copy_file_chunk: write: No space left on device.<br /> * pkg_write_filelist: Failed to open //usr/lib/opkg/info/asterisk18.list: No space left on device.<br /> * opkg_install_pkg: Failed to extract data files for asterisk18. Package debris may remain!<br /> * opkg_install_cmd: Cannot install package asterisk18.<br /> * opkg_conf_write_status_files: Can&#039;t open status file //usr/lib/opkg/status: No space left on device.<br /> * pkg_write_filelist: Failed to open //usr/lib/opkg/info/libpthread.list: No space left on device.<br /> * pkg_write_filelist: Failed to open //usr/lib/opkg/info/librt.list: No space left on device.<br /> * pkg_write_filelist: Failed to open //usr/lib/opkg/info/libncurses.list: No space left on device.<br /> * pkg_write_filelist: Failed to open //usr/lib/opkg/info/zlib.list: No space left on device.<br /> * pkg_write_filelist: Failed to open //usr/lib/opkg/info/libpopt.list: No space left on device.<br /> * pkg_write_filelist: Failed to open //usr/lib/opkg/info/libopenssl.list: No space left on device.</p></blockquote></div><p>When I look at the installed programs, I cannot find one of the above. So how can I remove unneeded files and get space back?</p><div class="quotebox"><blockquote><p>root@wr1043-openwrt-ap-wds:~# opkg list-installed<br />base-files - 43.32-r29592<br />busybox - 1.15.3-3.4<br />crda - 1.1.1-1<br />dnsmasq - 2.55-6.1<br />dropbear - 0.53.1-5<br />firewall - 2-34.8<br />hotplug2 - 1.0-beta-3<br />iptables - 1.4.6-3.1<br />iptables-mod-conntrack - 1.4.6-3.1<br />iptables-mod-nat - 1.4.6-3.1<br />iw - 0.9.22-2<br />kernel - 2.6.32.27-1<br />kmod-ath - 2.6.32.27+2011-11-15-1<br />kmod-ath9k - 2.6.32.27+2011-11-15-1<br />kmod-ath9k-common - 2.6.32.27+2011-11-15-1<br />kmod-button-hotplug - 2.6.32.27-1<br />kmod-cfg80211 - 2.6.32.27+2011-11-15-1<br />kmod-crc-ccitt - 2.6.32.27-1<br />kmod-crypto-aes - 2.6.32.27-1<br />kmod-crypto-arc4 - 2.6.32.27-1<br />kmod-crypto-core - 2.6.32.27-1<br />kmod-input-core - 2.6.32.27-1<br />kmod-input-gpio-buttons - 2.6.32.27-1<br />kmod-input-polldev - 2.6.32.27-1<br />kmod-ipt-conntrack - 2.6.32.27-1<br />kmod-ipt-core - 2.6.32.27-1<br />kmod-ipt-nat - 2.6.32.27-1<br />kmod-ipt-nathelper - 2.6.32.27-1<br />kmod-leds-gpio - 2.6.32.27-1<br />kmod-mac80211 - 2.6.32.27+2011-11-15-1<br />kmod-nls-base - 2.6.32.27-1<br />kmod-ppp - 2.6.32.27-1<br />kmod-pppoe - 2.6.32.27-1<br />kmod-usb-core - 2.6.32.27-1<br />kmod-usb-ohci - 2.6.32.27-1<br />kmod-usb2 - 2.6.32.27-1<br />libc - 0.9.30.1-43.32<br />libgcc - 4.3.3+cs-43.32<br />libip4tc - 1.4.6-3.1<br />libiwinfo - 18<br />libiwinfo-lua - 18<br />liblua - 5.1.4-7<br />libnl - 1.1-4<br />libnl-tiny - 0.1-1<br />libpcap - 1.0.0-2<br />libstdcpp - 4.3.3+cs-43.32<br />libuci - 12012009.7-4<br />libuci-lua - 12012009.7-4<br />libxtables - 1.4.6-3.1<br />lua - 5.1.4-7<br />luci - 0.10.0-1<br />luci-app-firewall - 0.10.0-1<br />luci-i18n-english - 0.10.0-1<br />luci-lib-core - 0.10.0-1<br />luci-lib-ipkg - 0.10.0-1<br />luci-lib-lmo - 0.10.0-1<br />luci-lib-nixio - 0.10.0-1<br />luci-lib-sys - 0.10.0-1<br />luci-lib-web - 0.10.0-1<br />luci-mod-admin-core - 0.10.0-1<br />luci-mod-admin-full - 0.10.0-1<br />luci-proto-core - 0.10.0-1<br />luci-proto-ppp - 0.10.0-1<br />luci-sgi-cgi - 0.10.0-1<br />luci-theme-base - 0.10.0-1<br />luci-theme-openwrt - 0.10.0-1<br />mtd - 13<br />nmap - 5.51-4<br />opkg - 576-2<br />ppp - 2.4.4-16.1<br />ppp-mod-pppoe - 2.4.4-16.1<br />swconfig - 9<br />uci - 12012009.7-4<br />udevtrigger - 106-1<br />uhttpd - 28<br />wireless-tools - 29-4<br />wpad-mini - 20111103-2</p></blockquote></div><p>I found files in /overlay/usr/lib. Can I simply delete them? Is there on opkg-option to remove files of an unfinished install savely?</p><div class="quotebox"><blockquote><p>root@wr1043-openwrt-ap-wds:~# ls -1&nbsp; /overlay/usr/lib/ <br />asterisk<br />libcrypto.so.0.9.8<br />libcurses.so<br />libform.so<br />libform.so.5<br />libform.so.5.7<br />libmenu.so<br />libmenu.so.5<br />libmenu.so.5.7<br />libncurses.so<br />libncurses.so.5<br />libncurses.so.5.7<br />libnl.so.1<br />libnl.so.1.1<br />libpanel.so<br />libpanel.so.5<br />libpanel.so.5.7<br />libpcap.so<br />libpcap.so.1.0<br />libpcap.so.1.0.0<br />libpopt.so.0<br />libpopt.so.0.0.0<br />libssl.so.0.9.8<br />libstdc++.so.6<br />libstdc++.so.6.0.10<br />libz.so<br />libz.so.1<br />libz.so.1.2.3<br />opkg</p><p>ls -1&nbsp; /overlay/usr/lib/asterisk/<br />modules</p></blockquote></div>											<p class="post-edited">(Last edited by <strong>linuxuser</strong> on 28 May 2012, 00:59)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p168350">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">mwarning</div>
					<div class="post-datetime">
						28 May 2012, 17:05					</div>
				</div>
				<div class="post-content content">
					<p>If your file system is squashfs (see the output of the &#039;mount&#039; command), then you can&#039;t delete specific files to free memory.<br />Search for &quot;While OPKG is&quot; here: <a href="http://wiki.openwrt.org/doc/techref/filesystems">http://wiki.openwrt.org/doc/techref/filesystems</a></p><p>But you can reset the file system (be it squashfs or jffs2) to remove all changes made since the firmware was applied.<br />See &quot;firstboot&quot; here <a href="http://wiki.openwrt.org/doc/howto/generic.failsafe">http://wiki.openwrt.org/doc/howto/generic.failsafe</a></p>											<p class="post-edited">(Last edited by <strong>mwarning</strong> on 28 May 2012, 17:09)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p168356">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">linuxuser</div>
					<div class="post-datetime">
						28 May 2012, 17:42					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><p>root@wr1043-openwrt-ap-wds:~# mount<br />rootfs on / type rootfs (rw)<br />/dev/root on /rom type squashfs (ro,relatime)<br />proc on /proc type proc (rw,relatime)<br />sysfs on /sys type sysfs (rw,relatime)<br />tmpfs on /tmp type tmpfs (rw,nosuid,nodev,relatime,size=14716k)<br />tmpfs on /dev type tmpfs (rw,relatime,size=512k,mode=755)<br />devpts on /dev/pts type devpts (rw,relatime,mode=600)<br />/dev/mtdblock3 on /overlay type jffs2 (rw,relatime)<br />mini_fo:/overlay on / type mini_fo (rw,relatime)<br />debugfs on /sys/kernel/debug type debugfs (rw,relatime)<br />none on /proc/bus/usb type usbfs (rw,relatime)<br />/dev/sda2 on /flashdrive type xfs (rw,sync,relatime,wsync,attr2,noquota)</p></blockquote></div><p>I removed all files and dirs in /overlay/usr/lib which I didn&#039;t see in another WR1043. Then there was a dir asterisk in /etc which I removed too. Till now everything seems to work. I don&#039;t know, if there are other places with lost files during the installation. The WebUI says now: Free space: 59% (2.76 MB)</p><p>I am searching for a howto to install programs on a flash drive. Till now I saw &quot;opkg --dest&quot; only. Especially I am interested to install asterisk.</p><div class="quotebox"><blockquote><p>root@wr1043-openwrt-ap-wds:~# df -h<br />Filesystem&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Size&nbsp; &nbsp; &nbsp; Used Available Use% Mounted on<br />/dev/root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1.9M&nbsp; &nbsp; &nbsp; 1.9M&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 100% /rom<br />tmpfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 14.4M&nbsp; &nbsp; &nbsp;64.0K&nbsp; &nbsp; &nbsp;14.3M&nbsp; &nbsp;0% /tmp<br />tmpfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;512.0K&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; 512.0K&nbsp; &nbsp;0% /dev<br />/dev/mtdblock3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4.7M&nbsp; &nbsp; &nbsp; 1.9M&nbsp; &nbsp; &nbsp; 2.8M&nbsp; 41% /overlay<br />mini_fo:/overlay&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1.9M&nbsp; &nbsp; &nbsp; 1.9M&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 100% /<br />/dev/sda2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 14.8G&nbsp; &nbsp; &nbsp; 4.2M&nbsp; &nbsp; &nbsp;14.8G&nbsp; &nbsp;0% /flashdrive</p></blockquote></div><div class="quotebox"><blockquote><p>root@wr1043-openwrt-ap-wds:~# free<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; total&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;used&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;free&nbsp; &nbsp; &nbsp; &nbsp;shared&nbsp; &nbsp; &nbsp; buffers<br />&nbsp; Mem:&nbsp; &nbsp; &nbsp; &nbsp; 29428&nbsp; &nbsp; &nbsp; &nbsp; 18228&nbsp; &nbsp; &nbsp; &nbsp; 11200&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1744<br /> Swap:&nbsp; &nbsp; &nbsp; &nbsp;128480&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp;128480<br />Total:&nbsp; &nbsp; &nbsp; &nbsp;157908&nbsp; &nbsp; &nbsp; &nbsp; 18228&nbsp; &nbsp; &nbsp; &nbsp;139680</p></blockquote></div>											<p class="post-edited">(Last edited by <strong>linuxuser</strong> on 28 May 2012, 17:45)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>