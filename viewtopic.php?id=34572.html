<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Sysupgrade - Newbie question</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 2 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p156709">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Cybmax</div>
					<div class="post-datetime">
						8 Feb 2012, 21:05					</div>
				</div>
				<div class="post-content content">
					<p>Im quite new to OpenWRT, but i have fiddled a wee bit with linux and ofc other variants of wifi firmware (dd-wrt and tomatousb)..</p><p>Now, i dont really understand the approach to &quot;sysupgrade&quot;, and what it really does. I know in eg. dd-wrt when you upgrade the image, everything will be replaced, and even tho its not recommended, your config will be preserved. This thing with &quot;sysupgrade&quot;, does it just flash &quot;over&quot; the current image like doing a fw upgrade in dd-wrt, or is it more like upgrading the kernel files, while keeping everything else?</p><p>Lets say i have installed a &quot;custom build&quot; by &quot;A&quot;. I remove some addons and stuff i dont need from his build. Then i figure id like to try out the custom build by &quot;B&quot;. He have set things up using a wee bit different addons and things, but some are the same.</p><p>What will happen during a sysupgrade?<br />Will :<br />A: I upgrade whatever kernel and main binaries that i am running when i do the sysupgrade?<br />B: Everything will be reinstalled, including the addons in the new image, and old addons and things i have added on my previous setup is gone?<br />C: I should really really just dont think about this, and just set everything up again after doing a upgrade?</p><p>If case C: above, should i then use the &quot;factory&quot; image, and not the sysupgrade one?</p><p>C</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p156713">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Orca</div>
					<div class="post-datetime">
						8 Feb 2012, 21:24					</div>
				</div>
				<div class="post-content content">
					<p>After you installed OpenWrt on your embedded hardware, you do not need to use the &quot;factory&quot;-images. You can do so, but there is no point.</p><p>Please find/extrapolate further information from the wiki: <a href="http://wiki.openwrt.org/doc/howto/generic.sysupgrade">OpenWrt Sysupgrade</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p156816">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Cybmax</div>
					<div class="post-datetime">
						9 Feb 2012, 18:09					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Orca wrote:</cite><blockquote><p>After you installed OpenWrt on your embedded hardware, you do not need to use the &quot;factory&quot;-images. You can do so, but there is no point.</p><p>Please find/extrapolate further information from the wiki: <a href="http://wiki.openwrt.org/doc/howto/generic.sysupgrade">OpenWrt Sysupgrade</a></p></blockquote></div><p>Well.. i have read the wiki, but it does not describe in detail what happens to my already installed addons, xept for :<br /></p><div class="quotebox"><blockquote><p>You cannot save installed binaries, you will have to install them again after sysupgrade</p></blockquote></div><p>The thing this tells me, is that i have to install all binaries again, and tbh thats quite a list i guess. How would i easily keep track of that?</p><p>It also does not tell me what happens if the image im sysupgrading to has a different setup of addons too.</p><p>From the <a href="http://wiki.openwrt.org/doc/techref/opkg">http://wiki.openwrt.org/doc/techref/opkg</a>, it sais :<br /></p><div class="quotebox"><blockquote><p>Upgrading packages is generally not recommended for most users, because a typical OpenWrt system stores the base system in a read-only SquashFS partition. And while the upgrade process works just fine, it uses far more space than a default installation as the base packages are duplicated in the base SquashFS partition and the user JFFS2 partition.<br />Thus, instead of upgrading, reflashing OpenWrt with a newer firmware image is recommended.</p></blockquote></div><p>Basically doing a &quot;working&quot; sysupgrade is not really recommended? Ie, after doing a sysupgrade and rebooting, i would believe from the info above that the luci web gui will NOT work (as it is not updated), and more or less, im not recommended to upgrade it either? <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Why am i being so stubborn and ask such useless questions you think.. Well, its cos one one hand i would like to use some recent patches that supposedly helps on the wifi disconnects on my WNDR3700v2, but on the other hand, i would also like to NOT have to set it all up again. I find the config and addons to be a wee bit &quot;too much&quot; sometimes <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> I got my hopes up reading about the sysupgrade function, and thought it would work similar to doing a &quot;apt-get upgrade&quot; in ubuntu <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>C</p><p>PS. I have managed to compile a &quot;working&quot; image for my DIR-600b2 test router, but there was so many compile options i must have missed something vital, cos i dont get a working luci, nor wpa2 config.. Anyone have some nice scripts for building a minimal setup with luci web gui, wireless tools, and the most basics?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p156902">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Orca</div>
					<div class="post-datetime">
						10 Feb 2012, 09:06					</div>
				</div>
				<div class="post-content content">
					<p>If the <a href="http://wiki.openwrt.org/doc/howto/generic.sysupgrade">OpenWrt sysupgrade howto</a> does not explain it, maybe the <a href="hhttp://wiki.openwrt.org/doc/techref/sysupgrade">OpenWrt sysupgrade technical reference</a> does (will one day...) In any case there is already a link to the browsable source files:</p><p><a href="https://dev.openwrt.org/browser/trunk/package/base-files/files/sbin/sysupgrade">https://dev.openwrt.org/browser/trunk/p â€¦ sysupgrade</a></p><p>Have a look at it, and find out what it does.</p><p>To &quot;keep track&quot; of all installed packages, I would use a simple list. After sysupgrade: opkg install &quot;list&quot;</p><p>sysupgrade will save ALL configfiles in config, but you can additionally name files to preserve.</p><p>Yes, newer package versions can have problems with config files written for older packages... sigh. If you do not want that, use OpenWrt <strong>stable</strong>, to get only security updates.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p159394">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">stitch626</div>
					<div class="post-datetime">
						3 Mar 2012, 02:01					</div>
				</div>
				<div class="post-content content">
					<p>Thanks, Cybmax &amp; Orca for asking &amp; addressing my question. I&#039;m still curious why &quot;factory&quot; is named what it is and why it&#039;s so much bigger than sysupgrade - sized to fit all the available flash? From the FAQ:<br /></p><div class="quotebox"><blockquote><p>What is the difference between the different image formats?</p><p>&nbsp; &nbsp; a factory image is one built for the bootloader flasher or stock software flasher<br />&nbsp; &nbsp; a sysupgrade image (previously named trx image) is designed to be flashed from within openwrt itself</p></blockquote></div><p>Cybmax, I had the same no-Luci issue in my first build. As you seem to have realized, the Luci package has to be installed after the flash update. Instructions are here: </p><p><a href="http://wiki.openwrt.org/doc/howto/luci.essentials">http://wiki.openwrt.org/doc/howto/luci.essentials</a></p><p>If you ever found a script that built an image including luci please point me to it - it seems odd that it&#039;s not part of the standard build.</p>											<p class="post-edited">(Last edited by <strong>stitch626</strong> on 3 Mar 2012, 02:44)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p159464">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Orca</div>
					<div class="post-datetime">
						3 Mar 2012, 15:54					</div>
				</div>
				<div class="post-content content">
					<p>Not everybody employing OpenWrt want&#039;s a WebUI!</p><p>To build OpenWrt yourself, start reading <a href="http://wiki.openwrt.org/about/toolchain">here</a>.</p><p>LuCI is a feed...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p159602">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">Weaving Hair</div>
					<div class="post-datetime">
						4 Mar 2012, 17:44					</div>
				</div>
				<div class="post-content content">
					<p>I dont really understand the approach to &quot;sysupgrade&quot;, and what it really does. I know in eg. dd-wrt when you upgrade the image, everything will be replaced, and even tho its not recommended, your config will be preserved</p><p><a href="http://www.focusbis.com.au/">integrated management system</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p159604">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">risa2000</div>
					<div class="post-datetime">
						4 Mar 2012, 18:00					</div>
				</div>
				<div class="post-content content">
					<p>I believe sysupgrade is meant for those who do not build image themselves, but would want to upgrade the firmware. Using sysupgrade, they might be able to do so without losing all configurations.<br />Those who build image themselves would prefer factory, because they can put all (updated) configuration files into new image and do not need to worry about &quot;updating&quot; them after firmware is written.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p198563">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">sombatsombat</div>
					<div class="post-datetime">
						16 Apr 2013, 19:46					</div>
				</div>
				<div class="post-content content">
					<p>From : <a href="http://wiki.openwrt.org/about/latest">http://wiki.openwrt.org/about/latest</a> </p><br /><p>Finally, decide which version you need:</p><p>If you are going to install via the normal OEM firmware upload, grab the file with &quot;factory&quot; in the name, e.g. openwrt-ar71xx-generic-wrt400n-jffs2-factory.bin</p><p>If you already have OpenWRT and you wish to upgrade while keeping your settings, use the file with &quot;sysupgrade&quot; in the name, e.g. openwrt-ar71xx-generic-wrt400n-jffs2-sysupgrade.bin</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p198586">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">dabyd64</div>
					<div class="post-datetime">
						17 Apr 2013, 00:10					</div>
				</div>
				<div class="post-content content">
					<p>The &quot;factory&quot; has the full flash layout, with the unused space set clear, thus erasing the area what will be &quot;rootfs_data&quot; , as it could have erratic data from the original firmware.<br />The &quot;sysupgrade&quot; has only the kernel+rootfs, and leaves &quot;rootfs_data&quot; intact, so you can upgrade openwrt witout losing data.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p198589">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">Borromini</div>
					<div class="post-datetime">
						17 Apr 2013, 00:20					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Cybmax wrote:</cite><blockquote><p>Lets say i have installed a &quot;custom build&quot; by &quot;A&quot;. I remove some addons and stuff i dont need from his build. Then i figure id like to try out the custom build by &quot;B&quot;. He have set things up using a wee bit different addons and things, but some are the same.</p></blockquote></div><p>Don&#039;t know if you have gotten around to that in the meantime, but you cannot remove stuff from builds (ie firmware images). The firmware image itself is read-only, the way OpenWrt stores settings and extra packages is by installing it onto the overlay. You can only remove packages you have installed separately; not stuff that was already built into the firmware.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p293167">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">erotavlas</div>
					<div class="post-datetime">
						23 Sep 2015, 18:22					</div>
				</div>
				<div class="post-content content">
					<p>Hi,<br />I have a Netgear DG834G with openWRT 12.09 installed. Since it very slow, I would like to downgrade to previous version 10.03.1. However, I cannot installed the firmware neither via GUI nor via sysupgrade. In particular, in the latter case I get the message &quot;Firmware upgrade is not implemented for this platform.&quot; when I use sysupgrade -v openwrt-10.03-ar7-generic-squashfs.bin. What could be the problem?<br />Thank you</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>