<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Has anyone actually got CUPs working with their router/printer?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 11 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p180890">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">mattie47</div>
					<div class="post-datetime">
						18 Oct 2012, 13:29					</div>
				</div>
				<div class="post-content content">
					<p>Feel like I&#039;m going out of my mind with how long I&#039;ve tried to get this working. </p><p>I&#039;ve spent quite a while googling this but sadly still can&#039;t get anything to print. </p><p>Devices:<br />-TPLink 1043ND<br />-Powered 10 port USB hub with 2gb flash drive (mounted as /usb, and some of it also as SWAP)<br />-Canon MX310<br />-Brother HL5240</p><p>I&#039;ve followed the tutorial on here: <a href="http://wiki.openwrt.org/doc/howto/cups.server">http://wiki.openwrt.org/doc/howto/cups.server</a> </p><p>and I believe I&#039;ve got all the required packages installed, and yes I have read the troubleshooting section (don&#039;t have kmod-usb-printer installed). </p><p>root@OpenWrt:~# opkg list-installed<br />base-files - 43.32-r29592<br />block-hotplug - 0.1.0-2.2<br />block-mount - 0.1.0-2.2<br />busybox - 1.15.3-3.4<br />crda - 1.1.1-1<br />cups - 1.4.4-1<br />cups-bjnp - 0.5.4-1<br />dnsmasq - 2.55-6.1<br />dropbear - 0.53.1-5<br />firewall - 2-34.8<br />hotplug2 - 1.0-beta-3<br />iptables - 1.4.6-3.1<br />iptables-mod-conntrack - 1.4.6-3.1<br />iptables-mod-nat - 1.4.6-3.1<br />iw - 0.9.22-2<br />kernel - 2.6.32.27-1<br />kmod-ath - 2.6.32.27+2011-11-15-1<br />kmod-ath9k - 2.6.32.27+2011-11-15-1<br />kmod-ath9k-common - 2.6.32.27+2011-11-15-1<br />kmod-button-hotplug - 2.6.32.27-1<br />kmod-cfg80211 - 2.6.32.27+2011-11-15-1<br />kmod-crc-ccitt - 2.6.32.27-1<br />kmod-crypto-aes - 2.6.32.27-1<br />kmod-crypto-arc4 - 2.6.32.27-1<br />kmod-crypto-core - 2.6.32.27-1<br />kmod-fs-ext3 - 2.6.32.27-1<br />kmod-fs-mbcache - 2.6.32.27-1<br />kmod-input-core - 2.6.32.27-1<br />kmod-input-gpio-buttons - 2.6.32.27-1<br />kmod-input-polldev - 2.6.32.27-1<br />kmod-ipt-conntrack - 2.6.32.27-1<br />kmod-ipt-core - 2.6.32.27-1<br />kmod-ipt-imq - 2.6.32.27-1<br />kmod-ipt-nat - 2.6.32.27-1<br />kmod-ipt-nathelper - 2.6.32.27-1<br />kmod-leds-gpio - 2.6.32.27-1<br />kmod-mac80211 - 2.6.32.27+2011-11-15-1<br />kmod-nls-base - 2.6.32.27-1<br />kmod-ppp - 2.6.32.27-1<br />kmod-pppoe - 2.6.32.27-1<br />kmod-sched - 2.6.32.27-1<br />kmod-scsi-core - 2.6.32.27-1<br />kmod-usb-core - 2.6.32.27-1<br />kmod-usb-ohci - 2.6.32.27-1<br />kmod-usb-storage - 2.6.32.27-1<br />kmod-usb2 - 2.6.32.27-1<br />libc - 0.9.30.1-43.32<br />libgcc - 4.3.3+cs-43.32<br />libip4tc - 1.4.6-3.1<br />libiwinfo - 18<br />libiwinfo-lua - 18<br />libjpeg - 6b-1<br />liblua - 5.1.4-7<br />libncurses - 5.7-2<br />libnl-tiny - 0.1-1<br />libopenssl - 0.9.8r-1<br />libpng - 1.2.46-1<br />libpthread - 0.9.30.1-43.32<br />librt - 0.9.30.1-43.32<br />libstdcpp - 4.3.3+cs-43.32<br />libuci - 12012009.7-4<br />libuci-lua - 12012009.7-4<br />libusb - 0.1.12-2<br />libxtables - 1.4.6-3.1<br />lua - 5.1.4-7<br />luci - 0.10.0-1<br />luci-app-firewall - 0.10.0-1<br />luci-i18n-english - 0.10.0-1<br />luci-lib-core - 0.10.0-1<br />luci-lib-ipkg - 0.10.0-1<br />luci-lib-lmo - 0.10.0-1<br />luci-lib-nixio - 0.10.0-1<br />luci-lib-sys - 0.10.0-1<br />luci-lib-web - 0.10.0-1<br />luci-mod-admin-core - 0.10.0-1<br />luci-mod-admin-full - 0.10.0-1<br />luci-proto-core - 0.10.0-1<br />luci-proto-ppp - 0.10.0-1<br />luci-sgi-cgi - 0.10.0-1<br />luci-theme-base - 0.10.0-1<br />luci-theme-openwrt - 0.10.0-1<br />mtd - 13<br />nano - 2.2.6-1<br />opkg - 576-2<br />p910nd - 0.95-1 &lt;---yes I know I should uninstall this if CUPs is installed, but it isn&#039;t running. I was going to try to get this to install and run rather than cups, but thought I&#039;d try asking for help on the forum here instead.<br />ppp - 2.4.4-16.1<br />ppp-mod-pppoe - 2.4.4-16.1<br />swconfig - 9<br />uci - 12012009.7-4<br />udevtrigger - 106-1<br />uhttpd - 28<br />wireless-tools - 29-4<br />wpad-mini - 20111103-2<br />zlib - 1.2.3-5<br />root@OpenWrt:~#</p><br /><p>Startup debug (yes there&#039;s some repairing stuff, probably because I tried plugging the brother directly into the router on previous run to see if I could get it to just print a blank page...no luck):<br />Oct 14 22:18:09 OpenWrt user.info kernel: usb 1-1.1: new high speed USB device using ar71xx-ehci and address 3<br />Oct 14 22:18:09 OpenWrt user.info kernel: usb 1-1.1: configuration #1 chosen from 1 choice<br />Oct 14 22:18:09 OpenWrt user.info kernel: hub 1-1.1:1.0: USB hub found<br />Oct 14 22:18:09 OpenWrt user.info kernel: hub 1-1.1:1.0: 4 ports detected<br />Oct 14 22:18:09 OpenWrt user.info kernel: usb 1-1.2: new high speed USB device using ar71xx-ehci and address 4<br />Oct 14 22:18:09 OpenWrt user.info kernel: usb 1-1.2: configuration #1 chosen from 1 choice<br />Oct 14 22:18:09 OpenWrt user.info kernel: IMQ driver loaded successfully.<br />Oct 14 22:18:09 OpenWrt user.info kernel: &nbsp; &nbsp; Hooking IMQ before NAT on PREROUTING.<br />Oct 14 22:18:09 OpenWrt user.info kernel: &nbsp; &nbsp; Hooking IMQ after NAT on POSTROUTING.<br />Oct 14 22:18:09 OpenWrt user.info kernel: usb 1-1.5: new high speed USB device using ar71xx-ehci and address 5<br />Oct 14 22:18:09 OpenWrt user.info kernel: ohci_hcd: USB 1.1 &#039;Open&#039; Host Controller (OHCI) Driver<br />Oct 14 22:18:10 OpenWrt user.info kernel: usb 1-1.5: configuration #1 chosen from 1 choice<br />Oct 14 22:18:10 OpenWrt user.info kernel: Initializing USB Mass Storage driver...<br />Oct 14 22:18:10 OpenWrt user.info kernel: usb 1-1.7: new high speed USB device using ar71xx-ehci and address 6<br />Oct 14 22:18:10 OpenWrt user.info kernel: scsi0 : SCSI emulation for USB Mass Storage devices<br />Oct 14 22:18:10 OpenWrt user.info kernel: usbcore: registered new interface driver usb-storage<br />Oct 14 22:18:10 OpenWrt user.info kernel: USB Mass Storage support registered.<br />Oct 14 22:18:10 OpenWrt user.debug kernel: usb-storage: device found at 5<br />Oct 14 22:18:10 OpenWrt user.debug kernel: usb-storage: waiting for device to settle before scanning<br />Oct 14 22:18:10 OpenWrt user.info kernel: usb 1-1.7: configuration #1 chosen from 1 choice<br />Oct 14 22:18:12 OpenWrt user.info kernel: cfg80211: Calling CRDA for country: NZ<br />Oct 14 22:18:13 OpenWrt user.info kernel: cfg80211: Regulatory domain changed to country: NZ<br />Oct 14 22:18:13 OpenWrt user.info kernel: cfg80211:&nbsp; &nbsp; &nbsp;(start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp)<br />Oct 14 22:18:13 OpenWrt user.info kernel: cfg80211:&nbsp; &nbsp; &nbsp;(2402000 KHz - 2482000 KHz @ 40000 KHz), (N/A, 3000 mBm)<br />Oct 14 22:18:13 OpenWrt user.info kernel: cfg80211:&nbsp; &nbsp; &nbsp;(5170000 KHz - 5250000 KHz @ 20000 KHz), (300 mBi, 2300 mBm)<br />Oct 14 22:18:13 OpenWrt user.info kernel: cfg80211:&nbsp; &nbsp; &nbsp;(5250000 KHz - 5330000 KHz @ 20000 KHz), (300 mBi, 2300 mBm)<br />Oct 14 22:18:13 OpenWrt user.info kernel: cfg80211:&nbsp; &nbsp; &nbsp;(5735000 KHz - 5835000 KHz @ 20000 KHz), (300 mBi, 3000 mBm)<br />Oct 14 22:18:14 OpenWrt user.info kernel: device wlan0 entered promiscuous mode<br />Oct 14 22:18:14 OpenWrt user.info kernel: br-lan: port 2(wlan0) entering forwarding state<br />Oct 14 22:18:15 OpenWrt user.notice kernel: scsi 0:0:0:0: Direct-Access&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;PMAP PQ: 0 ANSI: 0 CCS<br />Oct 14 22:18:15 OpenWrt user.notice kernel: sd 0:0:0:0: [sda] 4029440 512-byte logical blocks: (2.06 GB/1.92 GiB)<br />Oct 14 22:18:15 OpenWrt user.debug kernel: usb-storage: device scan complete<br />Oct 14 22:18:15 OpenWrt user.notice kernel: sd 0:0:0:0: [sda] Write Protect is off<br />Oct 14 22:18:15 OpenWrt user.debug kernel: sd 0:0:0:0: [sda] Mode Sense: 23 00 00 00<br />Oct 14 22:18:15 OpenWrt user.err kernel: sd 0:0:0:0: [sda] Assuming drive cache: write through<br />Oct 14 22:18:15 OpenWrt user.err kernel: sd 0:0:0:0: [sda] Assuming drive cache: write through<br />Oct 14 22:18:15 OpenWrt user.info kernel:&nbsp; sda: sda1 sda2<br />Oct 14 22:18:15 OpenWrt user.err kernel: sd 0:0:0:0: [sda] Assuming drive cache: write through<br />Oct 14 22:18:15 OpenWrt user.notice kernel: sd 0:0:0:0: [sda] Attached SCSI removable disk<br />Oct 14 22:18:16 OpenWrt user.info kernel: kjournald starting.&nbsp; Commit interval 5 seconds<br />Oct 14 22:18:16 OpenWrt user.info kernel: EXT3 FS on sda1, internal journal<br />Oct 14 22:18:16 OpenWrt user.info kernel: EXT3-fs: recovery complete.<br />Oct 14 22:18:16 OpenWrt user.info kernel: EXT3-fs: mounted filesystem with writeback data mode.<br />Oct 14 22:18:16 OpenWrt user.info kernel: Adding 126968k swap on /dev/sda2.&nbsp; Priority:-1 extents:1 across:126968k <br />Oct 14 22:18:17 OpenWrt user.info kernel: device wlan0 left promiscuous mode<br />Oct 14 22:18:17 OpenWrt user.info kernel: br-lan: port 2(wlan0) entering disabled state<br />Oct 14 22:18:17 OpenWrt user.info kernel: device wlan0 entered promiscuous mode<br />Oct 14 22:18:17 OpenWrt user.info kernel: br-lan: port 2(wlan0) entering forwarding state<br />Oct 14 22:18:18 OpenWrt daemon.info hostapd: wlan0: STA 04:46:65:fc:34:cc IEEE 802.11: authenticated<br />Oct 14 22:18:18 OpenWrt daemon.info hostapd: wlan0: STA 04:46:65:fc:34:cc IEEE 802.11: associated (aid 1)<br />Oct 14 22:18:18 OpenWrt user.info sysinit: Loading defaults<br />Oct 14 22:18:19 OpenWrt user.info sysinit: Loading synflood protection<br />Oct 14 22:18:19 OpenWrt user.info sysinit: Adding custom chains<br />Oct 14 22:18:19 OpenWrt user.info sysinit: Loading zones<br />Oct 14 22:18:20 OpenWrt user.info sysinit: Loading forwardings<br />Oct 14 22:18:20 OpenWrt user.info sysinit: Loading redirects<br />Oct 14 22:18:20 OpenWrt user.info sysinit: Loading rules<br />Oct 14 22:18:20 OpenWrt user.info sysinit: Loading includes<br />Oct 14 22:18:20 OpenWrt user.info sysinit: Optimizing conntrack<br />Oct 14 22:18:20 OpenWrt user.info sysinit: Loading interfaces<br />Oct 14 22:18:20 OpenWrt user.info firewall: adding lan (br-lan) to zone lan<br />Oct 14 22:18:22 OpenWrt daemon.info hostapd: wlan0: STA 04:46:65:fc:34:cc IEEE 802.11: authenticated<br />Oct 14 22:18:22 OpenWrt daemon.info hostapd: wlan0: STA 04:46:65:fc:34:cc IEEE 802.11: associated (aid 1)<br />Oct 14 22:18:22 OpenWrt daemon.info hostapd: wlan0: STA 04:46:65:fc:34:cc WPA: pairwise key handshake completed (RSN)<br />Oct 14 22:18:22 OpenWrt user.err syslog: Will not use User root (UID=0) as specified on line 26 for security reasons.&nbsp; You must use a non-privileged account instead.<br />Oct 14 22:18:22 OpenWrt user.err syslog: File or directory for &quot;TempDir /usb/cups/temp/&quot; on line 29 does not exist!<br />Oct 14 22:18:22 OpenWrt user.info syslog: Listening to :::631 (IPv6)<br />Oct 14 22:18:22 OpenWrt user.info syslog: Listening to 0.0.0.0:631 (IPv4)<br />Oct 14 22:18:22 OpenWrt user.warn syslog: &quot;AuthClass System&quot; is deprecated; consider using &quot;Require user @SYSTEM&quot; on line 44.<br />Oct 14 22:18:22 OpenWrt user.info syslog: Remote access is enabled.<br />Oct 14 22:18:22 OpenWrt user.debug syslog: Added auto ServerAlias OpenWrt<br />Oct 14 22:18:22 OpenWrt lpr.info cupsd[1416]: Loaded configuration file &quot;/etc/cups/cupsd.conf&quot;<br />Oct 14 22:18:22 OpenWrt lpr.notice cupsd[1416]: Group and SystemGroup cannot use the same groups!<br />Oct 14 22:18:22 OpenWrt lpr.info cupsd[1416]: Resetting Group to &quot;nobody&quot;...<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: Repairing access permissions of &quot;/usb/cups/&quot;<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: Repairing ownership of &quot;/var/cache/cups&quot;<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: Repairing access permissions of &quot;/var/cache/cups&quot;<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: Creating missing directory &quot;/var/cache/cups/rss&quot;<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: Repairing ownership of &quot;/var/cache/cups/rss&quot;<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: Repairing access permissions of &quot;/var/cache/cups/rss&quot;<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: Creating missing directory &quot;/var/run/cups&quot;<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: Repairing ownership of &quot;/var/run/cups&quot;<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: Repairing access permissions of &quot;/var/run/cups&quot;<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: Creating missing directory &quot;/var/run/cups/certs&quot;<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: Repairing ownership of &quot;/var/run/cups/certs&quot;<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: Repairing access permissions of &quot;/var/run/cups/certs&quot;<br />Oct 14 22:18:22 OpenWrt lpr.info cupsd[1416]: Using default TempDir of /usb/cups//tmp...<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: Creating missing directory &quot;/usb/cups//tmp&quot;<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: Repairing ownership of &quot;/usb/cups//tmp&quot;<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: Repairing access permissions of &quot;/usb/cups//tmp&quot;<br />Oct 14 22:18:22 OpenWrt lpr.info cupsd[1416]: Configured for up to 100 clients.<br />Oct 14 22:18:22 OpenWrt lpr.info cupsd[1416]: Allowing up to 100 client connections per host.<br />Oct 14 22:18:22 OpenWrt lpr.info cupsd[1416]: Creating CUPS default administrative policy:<br />Oct 14 22:18:22 OpenWrt lpr.info cupsd[1416]: &lt;Policy default&gt;<br />Oct 14 22:18:22 OpenWrt lpr.info cupsd[1416]: &lt;Limit Send-Document Send-URI Cancel-Job Hold-Job Release-Job Restart-Job Purge-Jobs Set-Job-Attributes Create-Job-Subscription Renew-Subscription Cancel-Subscription Get-Notifications Reprocess-Job Cancel-Current-Job Susp<br />Oct 14 22:18:22 OpenWrt lpr.info cupsd[1416]: Order Deny,Allow<br />Oct 14 22:18:22 OpenWrt lpr.info cupsd[1416]: Require user @OWNER @SYSTEM<br />Oct 14 22:18:22 OpenWrt lpr.info cupsd[1416]: &lt;/Limit&gt;<br />Oct 14 22:18:22 OpenWrt lpr.info cupsd[1416]: &lt;Limit Pause-Printer Resume-Printer Set-Printer-Attributes Enable-Printer Disable-Printer Pause-Printer-After-Current-Job Hold-New-Jobs Release-Held-New-Jobs Deactivate-Printer Activate-Printer Restart-Printer Shutdown-Pri<br />Oct 14 22:18:22 OpenWrt lpr.info cupsd[1416]: Order Deny,Allow<br />Oct 14 22:18:22 OpenWrt lpr.info cupsd[1416]: AuthType Default<br />Oct 14 22:18:22 OpenWrt lpr.info cupsd[1416]: Require user @SYSTEM<br />Oct 14 22:18:22 OpenWrt lpr.info cupsd[1416]: &lt;/Limit&gt;<br />Oct 14 22:18:22 OpenWrt lpr.info cupsd[1416]: &lt;Limit All&gt;<br />Oct 14 22:18:22 OpenWrt lpr.info cupsd[1416]: Order Deny,Allow<br />Oct 14 22:18:22 OpenWrt lpr.info cupsd[1416]: &lt;/Limit&gt;<br />Oct 14 22:18:22 OpenWrt lpr.info cupsd[1416]: &lt;/Policy&gt;<br />Oct 14 22:18:22 OpenWrt lpr.info cupsd[1416]: Full reload is required.<br />Oct 14 22:18:22 OpenWrt lpr.info cupsd[1416]: Loaded MIME database from &quot;/usr/share/cups/mime&quot; and &quot;/etc/cups&quot;: 35 types, 39 filters...<br />Oct 14 22:18:22 OpenWrt lpr.err cupsd[1416]: cupsdLoadBanners: Unable to open banner directory &quot;/usr/share/cups/banners&quot;: No such file or directory<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: Loading printer canon...<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: cupsdMarkDirty(P-----)<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: cupsdSetBusyState: Dirty files<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: load_ppd: Loading /etc/cups/ppd/canon.ppd...<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: cupsdRegisterPrinter(p=0x555c7740(canon))<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: Loading printer Laser...<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: cupsdMarkDirty(P-----)<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: load_ppd: Loading /etc/cups/ppd/Laser.ppd...<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: load_ppd: Saving /var/cache/cups/Laser.ipp2...<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: cupsdRegisterPrinter(p=0x555d3d40(Laser))<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: Loading printer LP...<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: cupsdMarkDirty(P-----)<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: load_ppd: Loading /etc/cups/ppd/LP.ppd...<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: cupsdRegisterPrinter(p=0x555d7e38(LP))<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: Loading printer USB...<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: cupsdMarkDirty(P-----)<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: load_ppd: Loading /etc/cups/ppd/USB.ppd...<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: cupsdRegisterPrinter(p=0x555e3590(USB))<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: Scanning /usb/cups/ for jobs...<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: [Job 7] Loading attributes...<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: [Job 7] Auto-typing document file &quot;/usb/cups//d00007-001&quot;...<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: [Job 8] Loading attributes...<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: [Job 8] Auto-typing document file &quot;/usb/cups//d00008-001&quot;...<br />Oct 14 22:18:22 OpenWrt lpr.info cupsd[1416]: Full reload complete.<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: cupsd_clean_files(path=&quot;/usb/cups//tmp&quot;, pattern=&quot;(null)&quot;)<br />Oct 14 22:18:22 OpenWrt lpr.info cupsd[1416]: Cleaning out old files in &quot;/usb/cups//tmp&quot;...<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: cupsd_clean_files(path=&quot;/var/cache/cups&quot;, pattern=&quot;*.ipp&quot;)<br />Oct 14 22:18:22 OpenWrt lpr.info cupsd[1416]: Cleaning out old files in &quot;/var/cache/cups&quot;...<br />Oct 14 22:18:22 OpenWrt lpr.err cupsd[1416]: Unable to open listen socket for address :::631 - Address family not supported by protocol.<br />Oct 14 22:18:22 OpenWrt lpr.info cupsd[1416]: Listening to 0.0.0.0:631 on fd 4...<br />Oct 14 22:18:22 OpenWrt lpr.info cupsd[1416]: Resuming new connection processing...<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: cupsdRegisterPrinter(p=0x555c7740(canon))<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: cupsdRegisterPrinter(p=0x555d3d40(Laser))<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: cupsdRegisterPrinter(p=0x555d7e38(LP))<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: cupsdRegisterPrinter(p=0x555e3590(USB))<br />Oct 14 22:18:22 OpenWrt lpr.debug cupsd[1416]: Discarding unused server-started event...<br />Oct 14 22:18:23 OpenWrt authpriv.info dropbear[1432]: Running in background<br />Oct 14 22:18:23 OpenWrt user.notice dnsmasq: DNS rebinding protection is active, will discard upstream RFC1918 responses!<br />Oct 14 22:18:23 OpenWrt user.notice dnsmasq: Allowing 127.0.0.0/8 responses<br />Oct 14 22:18:23 OpenWrt lpr.debug cupsd[1416]: Report: clients=0<br />Oct 14 22:18:23 OpenWrt lpr.debug cupsd[1416]: Report: jobs=2<br />Oct 14 22:18:23 OpenWrt lpr.debug cupsd[1416]: Report: jobs-active=2<br />Oct 14 22:18:23 OpenWrt lpr.debug cupsd[1416]: Report: printers=4<br />Oct 14 22:18:23 OpenWrt lpr.debug cupsd[1416]: Report: printers-implicit=0<br />Oct 14 22:18:23 OpenWrt lpr.debug cupsd[1416]: Report: stringpool-string-count=1566<br />Oct 14 22:18:23 OpenWrt lpr.debug cupsd[1416]: Report: stringpool-alloc-bytes=9136<br />Oct 14 22:18:23 OpenWrt lpr.debug cupsd[1416]: Report: stringpool-total-bytes=31280<br />Oct 14 22:18:23 OpenWrt daemon.info dnsmasq[1459]: started, version 2.55 cachesize 150<br />Oct 14 22:18:23 OpenWrt daemon.info dnsmasq[1459]: compile time options: IPv6 GNU-getopt no-DBus no-I18N DHCP TFTP<br />Oct 14 22:18:23 OpenWrt daemon.info dnsmasq[1459]: using local addresses only for domain lan<br />Oct 14 22:18:23 OpenWrt daemon.info dnsmasq[1459]: reading /tmp/resolv.conf.auto<br />Oct 14 22:18:23 OpenWrt daemon.info dnsmasq[1459]: using nameserver 192.168.0.100#53<br />Oct 14 22:18:23 OpenWrt daemon.info dnsmasq[1459]: using local addresses only for domain lan<br />Oct 14 22:18:23 OpenWrt daemon.info dnsmasq[1459]: read /etc/hosts - 1 addresses<br />Oct 14 22:18:24 OpenWrt user.info sysinit: setting up led WLAN<br />Oct 14 22:18:24 OpenWrt user.debug kernel: ar71xx-wdt: enabling watchdog timer<br />Oct 18 23:07:33 OpenWrt daemon.info hostapd: wlan0: STA 04:46:65:fc:34:cc WPA: group key handshake completed (RSN)<br />Oct 18 23:07:39 OpenWrt authpriv.info dropbear[1480]: Child connection from 192.168.0.25:55518<br />Oct 18 23:07:45 OpenWrt authpriv.notice dropbear[1480]: Password auth succeeded for &#039;root&#039; from 192.168.0.25:55518<br />Oct 18 23:07:51 OpenWrt lpr.err cupsd[1416]: Unable to backup printers.conf - No space left on device<br />Oct 18 23:07:51 OpenWrt lpr.info cupsd[1416]: Saving printers.conf...<br />Oct 18 23:07:51 OpenWrt lpr.debug cupsd[1416]: cupsdSetBusyState: Not busy<br />Oct 18 23:07:51 OpenWrt lpr.debug cupsd[1416]: [Job 7] Unloading...<br />Oct 18 23:07:51 OpenWrt lpr.debug cupsd[1416]: [Job 8] Unloading...<br />Oct 18 23:07:51 OpenWrt lpr.debug cupsd[1416]: Report: clients=0<br />Oct 18 23:07:51 OpenWrt lpr.debug cupsd[1416]: Report: jobs=2<br />Oct 18 23:07:51 OpenWrt lpr.debug cupsd[1416]: Report: jobs-active=2<br />Oct 18 23:07:51 OpenWrt lpr.debug cupsd[1416]: Report: printers=4<br />Oct 18 23:07:51 OpenWrt lpr.debug cupsd[1416]: Report: printers-implicit=0<br />Oct 18 23:07:51 OpenWrt lpr.debug cupsd[1416]: Report: stringpool-string-count=1496</p><br /><p>I can access cups fine on 192.168.0.1:631 and I believe I created the printers there correctly. </p><p>Also:</p><p>root@OpenWrt:~# /usr/lib/cups/backend/usb<br />DEBUG: list_devices<br />DEBUG: usb_find_busses=1<br />DEBUG: usb_find_devices=6<br />direct usb://Brother/HL-5240%20series?serial=H8J720309 &quot;Brother HL-5240 series&quot; &quot;Brother HL-5240 series&quot; &quot;MFG:Brother;CMD:PJL,PCL,PCLXL,POSTSCRIPT;MDL:HL-5240 series;CLS:PRINTER;&quot; &quot;&quot;<br />direct usb://Canon/MX310%20series?serial=406F4E&amp;interface=1 &quot;Canon MX310 series&quot; &quot;Canon MX310 series&quot; &quot;MFG:Canon;CMD:BJL,BJRaster3,BSCCe,PLI;SOJ:TXT01;MDL:MX310 series;CLS:PRINTER;DES:Canon MX310 series;VER:1.030;STA:10;HRI:EU;MSI:E3;&quot; &quot;&quot;<br />direct usb://Canon/MX310%20series%20FAX?serial=406F4E&amp;interface=2 &quot;Canon MX310 series FAX&quot; &quot;Canon MX310 series FAX&quot; &quot;MFG:Canon;CMD:MultiPASS 2.1;MDL:MX310 series FAX;CLS:PRINTER;DES:Canon MX310 series FAX;&quot; &quot;&quot;<br />root@OpenWrt:~#</p><p>Cups printer config:<br />root@OpenWrt:~# cat /etc/cups/printers.conf<br /># Printer configuration file for CUPS v1.4.4<br /># Written by cupsd on 2012-10-17 22:45<br /># DO NOT EDIT THIS FILE WHEN CUPSD IS RUNNING<br />&lt;Printer canon&gt;<br />Info canon<br />DeviceURI usb://Canon/MX310%20series?serial=406F4E&amp;interface=1<br />State Idle<br />StateTime 1350210838<br />Type 4<br />Accepting Yes<br />Shared Yes<br />JobSheets none none<br />QuotaPeriod 0<br />PageLimit 0<br />KLimit 0<br />OpPolicy default<br />ErrorPolicy stop-printer<br />&lt;/Printer&gt;<br />&lt;Printer Laser&gt;<br />Info Brother HL-5240<br />MakeModel Brother HL-5240 BR-Script3<br />DeviceURI usb://Brother/HL-5240%20series?serial=H8J720309<br />State Idle<br />StateTime 1350463757<br />Type 8433732<br />Filter application/vnd.cups-raw 0 -<br />Filter application/vnd.cups-command 0 commandtops<br />Filter application/vnd.cups-postscript 0 -<br />Accepting Yes<br />Shared Yes<br />JobSheets none none<br />QuotaPeriod 0<br />PageLimit 0<br />KLimit 0<br />OpPolicy default<br />ErrorPolicy stop-printer<br />&lt;/Printer&gt;<br />&lt;Printer LP&gt;<br />Info Parallel Port Printer<br />DeviceURI parallel:/dev/printers/0<br />State Stopped<br />StateMessage Unable to open print file &quot;/usb/cups/d00002-001&quot;: No such file or directory<br />StateTime 1350205817<br />Reason paused<br />Type 4<br />Accepting Yes<br />Shared Yes<br />JobSheets none none<br />QuotaPeriod 0<br />PageLimit 0<br />KLimit 0<br />OpPolicy default<br />ErrorPolicy stop-printer<br />&lt;/Printer&gt;<br />&lt;DefaultPrinter USB&gt;<br />Info USB Printer<br />DeviceURI usb:/dev/usb/lp0<br />State Idle<br />StateTime 1350211157<br />Type 4<br />Accepting Yes<br />Shared Yes<br />JobSheets none none<br />QuotaPeriod 0<br />PageLimit 0<br />KLimit 0<br />OpPolicy default<br />ErrorPolicy stop-printer<br />&lt;/Printer&gt;<br />root@OpenWrt:~#</p><p>root@OpenWrt:/etc/cups# cat cupsd.conf<br />....<br />AccessLog syslog<br />ErrorLog syslog<br />LogLevel debug<br />PageLog syslog<br />PreserveJobHistory No<br />PreserveJobFiles No<br />AutoPurgeJobs Yes<br />MaxJobs 25<br />MaxPrinterHistory 10<br />#Printcap /etc/printcap<br />#PrintcapFormat BSD<br />RequestRoot /usb/cups/<br />#RemoteRoot remroot<br />User root<br />Group root<br />RIPCache 512k<br />TempDir /usb/cups/temp/<br />Port 631<br />HostNameLookups Off<br />KeepAlive On<br />Browsing On<br />BrowseProtocols cups</p><p>&lt;Location /&gt;<br />Order Deny,Allow<br />Allow From 127.0.0.1<br />Allow From 192.168.0.0/24<br />&lt;/Location&gt;</p><p>&lt;Location /admin&gt;<br />AuthType Basic<br />AuthClass System<br />Order Allow,Deny<br />Allow From All<br />&lt;/Location&gt;</p><br /><br /><p>So when I try and print (tried from win 7 and linux mint) the job gets to CUPs, but goes &quot;STOPPED&quot; straight away. </p><p>This is the debug at the time:<br />Oct 18 23:15:56 OpenWrt lpr.debug cupsd[1416]: cupsdReadClient: 10 1.1 Restart-Job 1<br />Oct 18 23:15:56 OpenWrt lpr.debug cupsd[1416]: Restart-Job ipp://localhost/jobs/7<br />Oct 18 23:15:56 OpenWrt lpr.debug cupsd[1416]: cupsdIsAuthorized: requesting-user-name=&quot;guest&quot;<br />Oct 18 23:15:56 OpenWrt lpr.debug cupsd[1416]: Returning HTTP Unauthorized for Restart-Job (ipp://localhost/jobs/7) from localhost<br />Oct 18 23:15:56 OpenWrt lpr.info cupsd[1416]: REQUEST localhost - - &quot;POST /jobs HTTP/1.1&quot; 401 139 Restart-Job successful-ok<br />Oct 18 23:15:56 OpenWrt lpr.debug cupsd[1416]: cupsdSendHeader: 10 WWW-Authenticate: Basic realm=&quot;CUPS&quot;, trc=&quot;y&quot;<br />Oct 18 23:15:56 OpenWrt lpr.debug cupsd[1416]: PID 1552 (/usr/lib/cups/cgi-bin/jobs.cgi) exited with no errors.<br />Oct 18 23:15:56 OpenWrt lpr.debug cupsd[1416]: [CGI] cgi_passwd(prompt=&quot;Password for nobody on localhost? &quot;) called!<br />Oct 18 23:15:56 OpenWrt lpr.debug cupsd[1416]: cupsdReadClient: 10 WAITING Closing on EOF<br />Oct 18 23:15:56 OpenWrt lpr.debug cupsd[1416]: cupsdCloseClient: 10<br />Oct 18 23:15:56 OpenWrt lpr.debug cupsd[1416]: Script header: Status: 401<br />Oct 18 23:15:56 OpenWrt lpr.debug cupsd[1416]: cupsdSendHeader: 5 WWW-Authenticate: Basic realm=&quot;CUPS&quot;<br />Oct 18 23:15:56 OpenWrt lpr.debug cupsd[1416]: Script header: <br />Oct 18 23:15:56 OpenWrt lpr.debug cupsd[1416]: cupsdWriteClient: 5 Closing because Keep-Alive disabled<br />Oct 18 23:15:56 OpenWrt lpr.debug cupsd[1416]: cupsdCloseClient: 5<br />Oct 18 23:15:56 OpenWrt lpr.debug cupsd[1416]: cupsdSetBusyState: Not busy<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: cupsdAcceptClient: 5 from 192.168.0.25:631 (IPv4)<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: cupsdReadClient: 5 POST /jobs/ HTTP/1.1<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: cupsdSetBusyState: Active clients<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: cupsdAuthorize: Authorized as root using Basic<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] argv[0] = &quot;/usr/lib/cups/cgi-bin/jobs.cgi&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[0] = &quot;CUPS_CACHEDIR=/var/cache/cups&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[1] = &quot;CUPS_DATADIR=/usr/share/cups&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[2] = &quot;CUPS_DOCROOT=/usr/share/doc/cups&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[3] = &quot;CUPS_FONTPATH=/usr/share/cups/fonts&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[4] = &quot;CUPS_REQUESTROOT=/usb/cups/&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[5] = &quot;CUPS_SERVERBIN=/usr/lib/cups&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[6] = &quot;CUPS_SERVERROOT=/etc/cups&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[7] = &quot;CUPS_STATEDIR=/var/run/cups&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[8] = &quot;HOME=/usb/cups//tmp&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[9] = &quot;PATH=/usr/lib/cups/filter:/usr/bin:/usr/sbin:/bin:/usr/bin&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[10] = &quot;SERVER_ADMIN=root@OpenWrt&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[11] = &quot;SOFTWARE=CUPS/1.4.4&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[12] = &quot;TMPDIR=/usb/cups//tmp&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[13] = &quot;USER=root&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[14] = &quot;CUPS_SERVER=localhost&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[15] = &quot;CUPS_ENCRYPTION=IfRequested&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[16] = &quot;IPP_PORT=631&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[17] = &quot;CUPSD_AUTH_TYPE=Basic&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[18] = &quot;LANG=en_US.UTF8&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[19] = &quot;REDIRECT_STATUS=1&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[20] = &quot;GATEWAY_INTERFACE=CGI/1.1&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[21] = &quot;SERVER_NAME=192.168.0.1&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[22] = &quot;SERVER_PORT=631&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[23] = &quot;REMOTE_ADDR=192.168.0.25&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[24] = &quot;REMOTE_HOST=192.168.0.25&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[25] = &quot;SCRIPT_NAME=/jobs/&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[26] = &quot;SCRIPT_FILENAME=/usr/share/doc/cups/jobs/&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[27] = &quot;REMOTE_USER=root&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[28] = &quot;SERVER_PROTOCOL=HTTP/1.1&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[29] = &quot;HTTP_COOKIE=org.cups.sid=d818510f7d8fd911cd63338202014d96&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[30] = &quot;HTTP_USER_AGENT=Mozilla/5.0 (Windows NT 6.1; WOW64; rv:15.0) Gecko/20100101 Firefox/15.0.1&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[31] = &quot;HTTP_REFERER=http://192.168.0.1:631/printers/Laser&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[32] = &quot;REQUEST_METHOD=POST&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[33] = &quot;CONTENT_LENGTH=135&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[34] = &quot;CONTENT_TYPE=application/x-www-form-urlencoded&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] Started /usr/lib/cups/cgi-bin/jobs.cgi (PID 1555)<br />Oct 18 23:16:01 OpenWrt lpr.info cupsd[1416]: Started &quot;/usr/lib/cups/cgi-bin/jobs.cgi&quot; (pid=1555)<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: cupsdSendCommand: 5 file=11<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [CGI] org.cups.sid cookie is &quot;d818510f7d8fd911cd63338202014d96&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: cupsdAcceptClient: 10 from localhost:631 (IPv4)<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: cupsdReadClient: 10 POST /jobs HTTP/1.1<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: cupsdAuthorize: No authentication data provided.<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: cupsdReadClient: 10 1.1 Restart-Job 1<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: Restart-Job ipp://localhost/jobs/7<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: cupsdIsAuthorized: requesting-user-name=&quot;root&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: Discarding unused job-state-changed event...<br />Oct 18 23:16:01 OpenWrt lpr.info cupsd[1416]: [Job 7] Job restarted by user.<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: cupsdMarkDirty(----J-)<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: cupsdSetBusyState: Active clients and dirty files<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: cupsdMarkDirty(----J-)<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: cupsdSetBusyState: Active clients, printing jobs, and dirty files<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: Discarding unused printer-state-changed event...<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [Job 7] job-sheets=none,none<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [Job 7] argv[0]=&quot;Laser&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [Job 7] argv[1]=&quot;7&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [Job 7] argv[2]=&quot;Matt&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [Job 7] argv[3]=&quot;Test Page&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [Job 7] argv[4]=&quot;1&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [Job 7] argv[5]=&quot;job-uuid=urn:uuid:de0fef2e-d0c0-3119-49dd-e164a1a470c0 job-originating-host-name=192.168.0.25&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [Job 7] argv[6]=&quot;/usb/cups//d00007-001&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [Job 7] envp[0]=&quot;CUPS_CACHEDIR=/var/cache/cups&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [Job 7] envp[1]=&quot;CUPS_DATADIR=/usr/share/cups&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [Job 7] envp[2]=&quot;CUPS_DOCROOT=/usr/share/doc/cups&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [Job 7] envp[3]=&quot;CUPS_FONTPATH=/usr/share/cups/fonts&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [Job 7] envp[4]=&quot;CUPS_REQUESTROOT=/usb/cups/&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [Job 7] envp[5]=&quot;CUPS_SERVERBIN=/usr/lib/cups&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [Job 7] envp[6]=&quot;CUPS_SERVERROOT=/etc/cups&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [Job 7] envp[7]=&quot;CUPS_STATEDIR=/var/run/cups&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: [Job 7] envp[8]=&quot;HOME=/usb/cups//tmp&quot;<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: cupsdAcceptClient: 12 from 192.168.0.25:631 (IPv4)<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: cupsdReadClient: 10 WAITING Closing on EOF<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: cupsdCloseClient: 10<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: PID 1555 (/usr/lib/cups/cgi-bin/jobs.cgi) exited with no errors.<br />Oct 18 23:16:01 OpenWrt lpr.debug cupsd[1416]: cupsdSetBusyState: Dirty files<br />Oct 18 23:16:06 OpenWrt lpr.debug cupsd[1416]: cupsdReadClient: 5 GET /printers/ HTTP/1.1<br />Oct 18 23:16:06 OpenWrt lpr.debug cupsd[1416]: cupsdSetBusyState: Active clients and dirty files<br />Oct 18 23:16:06 OpenWrt lpr.debug cupsd[1416]: cupsdAuthorize: No authentication data provided.<br />Oct 18 23:16:06 OpenWrt lpr.debug cupsd[1416]: [CGI] argv[0] = &quot;/usr/lib/cups/cgi-bin/printers.cgi&quot;<br />Oct 18 23:16:06 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[0] = &quot;CUPS_CACHEDIR=/var/cache/cups&quot;<br />Oct 18 23:16:06 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[1] = &quot;CUPS_DATADIR=/usr/share/cups&quot;<br />Oct 18 23:16:06 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[2] = &quot;CUPS_DOCROOT=/usr/share/doc/cups&quot;<br />Oct 18 23:16:06 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[3] = &quot;CUPS_FONTPATH=/usr/share/cups/fonts&quot;<br />Oct 18 23:16:06 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[4] = &quot;CUPS_REQUESTROOT=/usb/cups/&quot;<br />Oct 18 23:16:06 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[5] = &quot;CUPS_SERVERBIN=/usr/lib/cups&quot;<br />Oct 18 23:16:06 OpenWrt lpr.debug cupsd[1416]: [CGI] envp[6] = &quot;CUPS_SERVERROOT=/etc/cups&quot;<br />Oct 18 23:16:06 OpenWrt lpr.debug cupsd[1416]: [CGI] org.cups.sid cookie is &quot;d818510f7d8fd911cd63338202014d96&quot;<br />Oct 18 23:16:06 OpenWrt lpr.debug cupsd[1416]: cupsdReadClient: 12 WAITING Closing on EOF<br />Oct 18 23:16:06 OpenWrt lpr.debug cupsd[1416]: cupsdCloseClient: 12<br />Oct 18 23:16:06 OpenWrt lpr.debug cupsd[1416]: cupsdAcceptClient: 12 from localhost:631 (IPv4)<br />Oct 18 23:16:06 OpenWrt lpr.debug cupsd[1416]: cupsdReadClient: 12 POST / HTTP/1.1<br />Oct 18 23:16:06 OpenWrt lpr.debug cupsd[1416]: cupsdAuthorize: No authentication data provided.<br />Oct 18 23:16:06 OpenWrt lpr.debug cupsd[1416]: cupsdReadClient: 12 1.1 CUPS-Get-Default 1<br />Oct 18 23:16:06 OpenWrt lpr.debug cupsd[1416]: CUPS-Get-Default<br />Oct 18 23:16:06 OpenWrt lpr.debug cupsd[1416]: Returning IPP successful-ok for CUPS-Get-Default (no URI) from localhost<br />Oct 18 23:16:06 OpenWrt lpr.debug cupsd[1416]: [CGI] show_all_printers(http=0x55564ef8, user=&quot;(null)&quot;)<br />Oct 18 23:16:06 OpenWrt lpr.debug cupsd[1416]: Script header: Content-Type: text/html;charset=utf-8<br />Oct 18 23:16:06 OpenWrt lpr.debug cupsd[1416]: Script header: <br />Oct 18 23:16:06 OpenWrt lpr.debug cupsd[1416]: cupsdReadClient: 12 POST / HTTP/1.1<br />Oct 18 23:16:06 OpenWrt lpr.debug cupsd[1416]: cupsdAuthorize: No authentication data provided.<br />Oct 18 23:16:06 OpenWrt lpr.debug cupsd[1416]: cupsdReadClient: 12 1.1 CUPS-Get-Printers 1<br />Oct 18 23:16:06 OpenWrt lpr.debug cupsd[1416]: CUPS-Get-Printers<br />Oct 18 23:16:06 OpenWrt lpr.debug cupsd[1416]: Returning IPP successful-ok for CUPS-Get-Printers (no URI) from localhost<br />Oct 18 23:16:06 OpenWrt lpr.debug cupsd[1416]: cupsdAcceptClient: 13 from 192.168.0.25:631 (IPv4)<br />Oct 18 23:16:06 OpenWrt lpr.debug cupsd[1416]: PID 1558 (/usr/lib/cups/cgi-bin/printers.cgi) exited with no errors.<br />Oct 18 23:16:06 OpenWrt lpr.debug cupsd[1416]: cupsdReadClient: 12 WAITING Closing on EOF<br />Oct 18 23:16:06 OpenWrt lpr.debug cupsd[1416]: cupsdCloseClient: 12<br />Oct 18 23:16:06 OpenWrt lpr.debug cupsd[1416]: cupsdSetBusyState: Dirty files<br />Oct 18 23:16:11 OpenWrt lpr.debug cupsd[1416]: cupsdReadClient: 13 WAITING Closing on EOF<br />Oct 18 23:16:11 OpenWrt lpr.debug cupsd[1416]: cupsdCloseClient: 13<br />Oct 18 23:16:11 OpenWrt lpr.debug cupsd[1416]: [Job 7] Unloading...<br />Oct 18 23:16:11 OpenWrt lpr.debug cupsd[1416]: [Job 8] Unloading...</p><p>So yeah, feel like I&#039;m going crazy, as I can see the router is detecting the printers (as above), but cups seems to be having issues talking to the printers?</p><br /><p>Sorry a lot of output, but hopefully someone is able to help me with this! I&#039;ve mainly stuck at it in hope I&#039;d get it working and could write up a better tutorial! </p><p>Otherwise will admit defeat and try out p910nd <img src="https://forum.openwrt.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /></p><p>extra:<br />I did manually add a driver for one of the printers (brother from memory, by wget the ppd file into the right cups directory).</p><p>- Also yes I should remove the default lp0 and usb printer configs from the cups printer config file, but no harm leaving them there for now...</p><p>Also probably not needed, but for extra:</p><p>root@OpenWrt:~# cd /dev<br />root@OpenWrt:/dev# ls -a -l<br />drwxr-xr-x&nbsp; &nbsp; 4 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 980 Oct 14 22:18 .<br />drwxr-xr-x&nbsp; &nbsp; 9 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 Jan&nbsp; 1&nbsp; 1970 ..<br />crw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp;189,&nbsp; &nbsp;1 Oct 14 22:18 1-1<br />crw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp;189,&nbsp; &nbsp;2 Oct 14 22:18 1-1.1<br />crw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp;189,&nbsp; &nbsp;3 Oct 14 22:18 1-1.2<br />crw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp;189,&nbsp; &nbsp;4 Oct 14 22:18 1-1.5<br />crw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp;189,&nbsp; &nbsp;5 Oct 14 22:18 1-1.7<br />crw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp;5,&nbsp; &nbsp;1 Jan&nbsp; 1&nbsp; 1970 console<br />crw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; 10,&nbsp; 63 Jan&nbsp; 1&nbsp; 1970 cpu_dma_latency<br />crw-rw-rw-&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp;1,&nbsp; &nbsp;7 Jan&nbsp; 1&nbsp; 1970 full<br />crw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp;1,&nbsp; 11 Jan&nbsp; 1&nbsp; 1970 kmsg<br />srw-rw-rw-&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 Oct 14 22:18 log<br />crw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp;1,&nbsp; &nbsp;1 Jan&nbsp; 1&nbsp; 1970 mem<br />crw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; 90,&nbsp; &nbsp;0 Jan&nbsp; 1&nbsp; 1970 mtd0<br />crw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; 90,&nbsp; &nbsp;1 Jan&nbsp; 1&nbsp; 1970 mtd0ro<br />crw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; 90,&nbsp; &nbsp;2 Jan&nbsp; 1&nbsp; 1970 mtd1<br />crw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; 90,&nbsp; &nbsp;3 Jan&nbsp; 1&nbsp; 1970 mtd1ro<br />crw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; 90,&nbsp; &nbsp;4 Jan&nbsp; 1&nbsp; 1970 mtd2<br />crw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; 90,&nbsp; &nbsp;5 Jan&nbsp; 1&nbsp; 1970 mtd2ro<br />crw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; 90,&nbsp; &nbsp;6 Jan&nbsp; 1&nbsp; 1970 mtd3<br />crw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; 90,&nbsp; &nbsp;7 Jan&nbsp; 1&nbsp; 1970 mtd3ro<br />crw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; 90,&nbsp; &nbsp;8 Jan&nbsp; 1&nbsp; 1970 mtd4<br />crw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; 90,&nbsp; &nbsp;9 Jan&nbsp; 1&nbsp; 1970 mtd4ro<br />crw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; 90,&nbsp; 10 Jan&nbsp; 1&nbsp; 1970 mtd5<br />crw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; 90,&nbsp; 11 Jan&nbsp; 1&nbsp; 1970 mtd5ro<br />brw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; 31,&nbsp; &nbsp;0 Jan&nbsp; 1&nbsp; 1970 mtdblock0<br />brw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; 31,&nbsp; &nbsp;1 Jan&nbsp; 1&nbsp; 1970 mtdblock1<br />brw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; 31,&nbsp; &nbsp;2 Jan&nbsp; 1&nbsp; 1970 mtdblock2<br />brw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; 31,&nbsp; &nbsp;3 Jan&nbsp; 1&nbsp; 1970 mtdblock3<br />brw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; 31,&nbsp; &nbsp;4 Jan&nbsp; 1&nbsp; 1970 mtdblock4<br />brw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; 31,&nbsp; &nbsp;5 Jan&nbsp; 1&nbsp; 1970 mtdblock5<br />crw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; 10,&nbsp; 62 Jan&nbsp; 1&nbsp; 1970 network_latency<br />crw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; 10,&nbsp; 61 Jan&nbsp; 1&nbsp; 1970 network_throughput<br />crw-rw-rw-&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp;1,&nbsp; &nbsp;3 Jan&nbsp; 1&nbsp; 1970 null<br />crw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp;1,&nbsp; &nbsp;4 Jan&nbsp; 1&nbsp; 1970 port<br />crw-------&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp;108,&nbsp; &nbsp;0 Oct 14 22:18 ppp<br />crw-rw-rw-&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp;5,&nbsp; &nbsp;2 Oct 18 23:22 ptmx<br />drwxr-xr-x&nbsp; &nbsp; 2 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 Jan&nbsp; 1&nbsp; 1970 pts<br />crw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp;1,&nbsp; &nbsp;8 Jan&nbsp; 1&nbsp; 1970 random<br />brw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp;8,&nbsp; &nbsp;0 Oct 14 22:18 sda<br />brw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp;8,&nbsp; &nbsp;1 Oct 14 22:18 sda1<br />brw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp;8,&nbsp; &nbsp;2 Oct 14 22:18 sda2<br />drwxr-xr-x&nbsp; &nbsp; 2 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;40 Jan&nbsp; 1&nbsp; 1970 shm<br />crw-rw-rw-&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp;5,&nbsp; &nbsp;0 Jan&nbsp; 1&nbsp; 1970 tty<br />crw-rw-rw-&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp;4,&nbsp; 64 Jan&nbsp; 1&nbsp; 1970 ttyS0<br />crw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp;1,&nbsp; &nbsp;9 Jan&nbsp; 1&nbsp; 1970 urandom<br />crw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp;189,&nbsp; &nbsp;0 Oct 14 22:18 usb1<br />crw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; 10, 130 Jan&nbsp; 1&nbsp; 1970 watchdog<br />crw-rw-rw-&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp;1,&nbsp; &nbsp;5 Jan&nbsp; 1&nbsp; 1970 zero</p><br /><p>Thanks!</p><p>Matt</p><p>-------------------------<br /><a href="http://mattie47.com">http://mattie47.com</a> <br />-------------------------</p>											<p class="post-edited">(Last edited by <strong>mattie47</strong> on 18 Oct 2012, 13:32)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p181176">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">mattie47</div>
					<div class="post-datetime">
						22 Oct 2012, 11:02					</div>
				</div>
				<div class="post-content content">
					<p>Wohooo!! I fixed it and got it working!&nbsp; I bit the bullet and did a fresh install using an unstable build. I&#039;ve written a complete guide how how to get cups working with OpenWrt and have posted it here: <a href="http://mattie47.com/getting-cups-working-on-openwrt/">http://mattie47.com/getting-cups-working-on-openwrt/</a> Hopefully this will be useful to someone who was in my position <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p181240">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">grayman4hire</div>
					<div class="post-datetime">
						23 Oct 2012, 00:20					</div>
				</div>
				<div class="post-content content">
					<p>Thanks mattie47 for documenting the steps.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>