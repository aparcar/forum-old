<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Compiling OpenWrt with ARPNAT Support</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 2 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p193555">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">omggo</div>
					<div class="post-datetime">
						1 Mar 2013, 13:35					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I&#039;m trying to use openwrt with ARPNAT and I&#039;m using this link as a reference:<br /><a href="http://projectgus.com/2010/03/wireless-client-bridging-with-openwrt/">http://projectgus.com/2010/03/wireless- … h-openwrt/</a> </p><p>I&#039;ve downloaded the gargoyle arpnat patch from here:<br /><a href="http://www.gargoyle-router.com/gargoyle/projects/gargoyle/repository/revisions/master/entry/patches-generic/04-arpnat.patch">http://www.gargoyle-router.com/gargoyle … pnat.patch</a></p><p>I applied it to the attitude adjustment branch and it completed successfully. Then I compiled openwrt with ebtables but it doesn&#039;t seem to be working with client_bridge=1.</p><p>Does anyone know why this is?</p>											<p class="post-edited">(Last edited by <strong>omggo</strong> on 1 Mar 2013, 13:35)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193662">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">omggo</div>
					<div class="post-datetime">
						3 Mar 2013, 08:02					</div>
				</div>
				<div class="post-content content">
					<p>bump</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p194294">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">omggo</div>
					<div class="post-datetime">
						9 Mar 2013, 06:20					</div>
				</div>
				<div class="post-content content">
					<p>bump</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p194295">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">omggo</div>
					<div class="post-datetime">
						9 Mar 2013, 06:22					</div>
				</div>
				<div class="post-content content">
					<p>bump</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p194298">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">vhrm</div>
					<div class="post-datetime">
						9 Mar 2013, 08:04					</div>
				</div>
				<div class="post-content content">
					<p>no idea.&nbsp; but perhaps some people would opine if you described a bit more what is and isn&#039;t working?</p><p>for example, is there an ebtables binary&nbsp; available on your router now ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p194346">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">omggo</div>
					<div class="post-datetime">
						9 Mar 2013, 16:34					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>vhrm wrote:</cite><blockquote><p>no idea.&nbsp; but perhaps some people would opine if you described a bit more what is and isn&#039;t working?</p><p>for example, is there an ebtables binary&nbsp; available on your router now ?</p></blockquote></div><p>sure</p><p>im not 100% sure what to be looking for but ebtables is installed and i bridge the wireless and ethernet adaper and set client_bridge to 1. after restarting the router the wireless stays down and wont bridge like when the patch is not installed.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p194383">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">vhrm</div>
					<div class="post-datetime">
						9 Mar 2013, 23:02					</div>
				</div>
				<div class="post-content content">
					<p>ok.&nbsp; Then follow some more debugging steps.&nbsp; &nbsp; </p><p> For example:</p><p>1) without any of this fancy arpnat (i.e. w/o client_bridge setting) can you get your device (what device is it, btw?) with the build you have installed connect to your wifi network ?</p><p>2) Once you get that working&nbsp; add back in the client_bridge&nbsp; setting, restart&nbsp; and follow some of the debugging conversation in the comments on that&nbsp; project gus page.&nbsp; (e.g. use&nbsp; &quot;ebtables -t nat -L&quot;&nbsp; to see if anything is listed there)</p><p>(i&#039;m not even clear how that gargoyle patch CAN apply cleanly (e.g. what&#039;s w/ the references to &quot;linux-2.6.30...&quot; ?)&nbsp; but i&#039;m not up on patch/diff syntax or this build system so that could all be fine)</p><br /><p>If arpnat rules are listed... see if they work.<br />If arpnat rules aren&#039;t listed then you&#039;ll have to start debugging the startup scripts to see why they didn&#039;t insert the rules they should have.</p><p>edit: and a (trunk) build i did a little while back doesn&#039;t have iwconfig (which is used in that script it seems)&nbsp; just iw.&nbsp; &nbsp;so you&#039;ll either have to install it or change the scripts to use iw to get its info.</p>											<p class="post-edited">(Last edited by <strong>vhrm</strong> on 10 Mar 2013, 00:17)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p194408">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">omggo</div>
					<div class="post-datetime">
						10 Mar 2013, 09:21					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>vhrm wrote:</cite><blockquote><p>ok.&nbsp; Then follow some more debugging steps.&nbsp; &nbsp; </p><p> For example:</p><p>1) without any of this fancy arpnat (i.e. w/o client_bridge setting) can you get your device (what device is it, btw?) with the build you have installed connect to your wifi network ?</p><p>2) Once you get that working&nbsp; add back in the client_bridge&nbsp; setting, restart&nbsp; and follow some of the debugging conversation in the comments on that&nbsp; project gus page.&nbsp; (e.g. use&nbsp; &quot;ebtables -t nat -L&quot;&nbsp; to see if anything is listed there)</p><p>(i&#039;m not even clear how that gargoyle patch CAN apply cleanly (e.g. what&#039;s w/ the references to &quot;linux-2.6.30...&quot; ?)&nbsp; but i&#039;m not up on patch/diff syntax or this build system so that could all be fine)</p><br /><p>If arpnat rules are listed... see if they work.<br />If arpnat rules aren&#039;t listed then you&#039;ll have to start debugging the startup scripts to see why they didn&#039;t insert the rules they should have.</p><p>edit: and a (trunk) build i did a little while back doesn&#039;t have iwconfig (which is used in that script it seems)&nbsp; just iw.&nbsp; &nbsp;so you&#039;ll either have to install it or change the scripts to use iw to get its info.</p></blockquote></div><p>thanks for your help. i really appreciate it.</p><p>I&#039;m currently re-compiling openwrt with &quot;wireless-tools&quot; which has iwconfig and with ebtables after applying all the patches in gargoyle&#039;s &quot;patches-generic&quot; folder.</p><p>this time i downloaded the source straight from gargoyle&#039;s website.</p><p>im compiling the attitude adjustment branch, not the trunk. my router is a dlink dir-615 and it connects fine to my wireless network and can get on the internet.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p194417">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">omggo</div>
					<div class="post-datetime">
						10 Mar 2013, 12:22					</div>
				</div>
				<div class="post-content content">
					<p>I got it working! it must&#039;ve been the wireless tools that it needed.</p>											<p class="post-edited">(Last edited by <strong>omggo</strong> on 10 Mar 2013, 12:43)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p194497">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">vhrm</div>
					<div class="post-datetime">
						10 Mar 2013, 23:38					</div>
				</div>
				<div class="post-content content">
					<p>cool!</p><p>enjoy your CPU bound transfer speeds :-)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p194550">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">omggo</div>
					<div class="post-datetime">
						11 Mar 2013, 13:45					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>vhrm wrote:</cite><blockquote><p>cool!</p><p>enjoy your CPU bound transfer speeds :-)</p></blockquote></div><p>thanks, at about a 15% speed loss, I can&#039;t complain <img src="https://forum.openwrt.org/img/smilies/tongue.png" width="15" height="15" alt="tongue" /></p>											<p class="post-edited">(Last edited by <strong>omggo</strong> on 11 Mar 2013, 14:14)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>