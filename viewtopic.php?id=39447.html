<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> ath5k driver and /proc/net/wireless problem</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 19 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p178548">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">theTimes</div>
					<div class="post-datetime">
						18 Sep 2012, 00:01					</div>
				</div>
				<div class="post-content content">
					<p>Hi all, </p><p>I am using a Winstron CM9 pci card. The Debian installation I have already has the ath5k driver included.&nbsp; I can scan for networks, I can run a routing protocol using my wireless interface. But most odd of all l cannot read any values for noise etc in proc/net/wireless.&nbsp; Please can somebody help me, this is really important for some research I am doing, and I am unfamiliar with wireless drivers and such. Here is some possibly useful info: </p><p>root@alix:/#iwconfig:</p><p>wlan0&nbsp; &nbsp; &nbsp;IEEE 802.11abg&nbsp; ESSID:off/any&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Mode:Managed&nbsp; Access Point: Not-Associated&nbsp; &nbsp;Tx-Power=27 dBm&nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Retry&nbsp; long limit:7&nbsp; &nbsp;RTS thr:off&nbsp; &nbsp;Fragment thr:off<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Encryption key:off<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Power Management:off</p><p>root@alix:/# lsmod | grep ath5k<br />ath5k&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;104054&nbsp; 0 <br />mac80211&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;123586&nbsp; 1 ath5k<br />ath&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;6018&nbsp; 1 ath5k<br />cfg80211&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;87649&nbsp; 3 ath5k,mac80211,ath<br />led_class&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1757&nbsp; 2 ath5k,leds_alix2</p><p>root@alix:/# rmmod ath5k<br />root@alix:/# modprobe ath5k</p><p>root@alix:/# dmesg | grep ath5k<br />[&nbsp; &nbsp; 5.899590] ath5k 0000:00:0e.0: registered as &#039;phy0&#039;<br />[&nbsp; &nbsp; 6.605270] ath5k phy0: Atheros AR5213A chip found (MAC: 0x59, PHY: 0x43)<br />[&nbsp; &nbsp; 6.605293] ath5k phy0: RF5112B multiband radio found (0x36)<br />[&nbsp; &nbsp;70.457768] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[&nbsp; 190.571310] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[&nbsp; 240.654582] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[&nbsp; 280.696805] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[&nbsp; 300.717677] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[&nbsp; 310.730066] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[&nbsp; 430.799351] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[&nbsp; 440.834405] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[&nbsp; 460.873448] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[&nbsp; 490.906862] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[&nbsp; 550.969354] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[&nbsp; 570.996731] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[&nbsp; 581.016862] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[&nbsp; 591.051895] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[&nbsp; 601.074434] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[&nbsp; 621.111996] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[&nbsp; 631.135547] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[&nbsp; 641.170391] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[&nbsp; 661.194475] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[&nbsp; 671.229370] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[&nbsp; 701.309504] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[&nbsp; 861.419543] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[&nbsp; 871.438197] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[&nbsp; 881.458356] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[&nbsp; 891.472016] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[&nbsp; 901.488987] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[&nbsp; 911.524219] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[&nbsp; 921.559547] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[&nbsp; 931.571386] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[&nbsp; 951.617490] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[&nbsp; 961.652548] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[ 1101.740528] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[ 1111.791957] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[ 1121.827019] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[ 1131.861962] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[ 1141.897110] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[ 1151.932035] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[ 1172.002120] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[ 1192.072164] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[ 1212.110627] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[ 1352.222763] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[ 1492.303573] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[ 1502.324672] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[ 2092.620994] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[ 2102.656044] ath5k phy0: noise floor calibration timeout (2412MHz)<br />[ 2201.327755] ath5k 0000:00:0e.0: registered as &#039;phy1&#039;<br />[ 2201.559523] ath5k phy1: Atheros AR5213A chip found (MAC: 0x59, PHY: 0x43)<br />[ 2201.559547] ath5k phy1: RF5112B multiband radio found (0x36)<br />[ 2282.080822] ath5k 0000:00:0e.0: registered as &#039;phy2&#039;<br />[ 2282.318218] ath5k phy2: Atheros AR5213A chip found (MAC: 0x59, PHY: 0x43)<br />[ 2282.318242] ath5k phy2: RF5112B multiband radio found (0x36)<br />[ 3408.949219] ath5k phy2: noise floor calibration timeout (2412MHz)<br />[ 3413.893682] ath5k phy2: noise floor calibration timeout (2412MHz)<br />[ 3444.634615] ath5k phy2: noise floor calibration timeout (2412MHz)<br />[ 3477.985099] ath5k phy2: noise floor calibration timeout (2412MHz)<br />[ 3533.728427] ath5k phy2: noise floor calibration timeout (2412MHz)<br />[ 3557.029475] ath5k phy2: noise floor calibration timeout (2412MHz)<br />[ 3578.114516] ath5k phy2: noise floor calibration timeout (2412MHz)<br />[ 3608.304465] ath5k phy2: noise floor calibration timeout (2412MHz)<br />[ 3663.381771] ath5k phy2: noise floor calibration timeout (2412MHz)<br />[ 3694.962985] ath5k phy2: noise floor calibration timeout (2412MHz)<br />[ 3712.537901] ath5k phy2: noise floor calibration timeout (2412MHz)<br />[ 3728.308226] ath5k phy2: noise floor calibration timeout (2412MHz)<br />[ 3760.473346] ath5k phy2: noise floor calibration timeout (2412MHz)<br />[ 3788.310010] ath5k phy2: noise floor calibration timeout (2412MHz)<br />[ 3804.028475] ath5k phy2: noise floor calibration timeout (2412MHz)<br />[ 3864.631677] ath5k phy2: noise floor calibration timeout (2412MHz)<br />[ 3908.362855] ath5k phy2: noise floor calibration timeout (2412MHz)<br />[ 3968.364736] ath5k phy2: noise floor calibration timeout (2412MHz)<br />[ 4344.255601] ath5k phy2: noise floor calibration timeout (2412MHz)<br />[ 4371.895858] ath5k phy2: noise floor calibration timeout (2412MHz)<br />[ 4404.628509] ath5k phy2: noise floor calibration timeout (2412MHz)<br />[ 4489.160613] ath5k 0000:00:0e.0: registered as &#039;phy3&#039;<br />[ 4489.397826] ath5k phy3: Atheros AR5213A chip found (MAC: 0x59, PHY: 0x43)<br />[ 4489.397851] ath5k phy3: RF5112B multiband radio found (0x36)</p><p>root@alix:/# lspci -vvv<br />00:0e.0 Ethernet controller: Atheros Communications Inc. Atheros AR5001X+ Wireless Network Adapter (rev 01)<br />&nbsp; &nbsp; Subsystem: Wistron NeWeb Corp. CM9 Wireless a/b/g MiniPCI Adapter<br />&nbsp; &nbsp; Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV+ VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx-<br />&nbsp; &nbsp; Status: Cap+ 66MHz- UDF- FastB2B+ ParErr- DEVSEL=medium &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx-<br />&nbsp; &nbsp; Latency: 168 (2500ns min, 7000ns max), Cache Line Size: 32 bytes<br />&nbsp; &nbsp; Interrupt: pin A routed to IRQ 11<br />&nbsp; &nbsp; Region 0: Memory at e0080000 (32-bit, non-prefetchable) [size=64K]<br />&nbsp; &nbsp; Capabilities: [44] Power Management version 2<br />&nbsp; &nbsp; &nbsp; &nbsp; Flags: PMEClk- DSI- D1- D2- AuxCurrent=375mA PME(D0-,D1-,D2-,D3hot-,D3cold-)<br />&nbsp; &nbsp; &nbsp; &nbsp; Status: D0 NoSoftRst- PME-Enable- DSel=0 DScale=2 PME-<br />&nbsp; &nbsp; Kernel driver in use: ath5k</p><br /><p>Please let me know if there is any more information that I can provide you with.</p><p>Thank you</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178549">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						18 Sep 2012, 00:05					</div>
				</div>
				<div class="post-content content">
					<p>The /proc/net/wireless file is a remainder of the legacy and deprecated wext api.<br />To obtain precise stats you have to use the Linux cfg80211 netlink api (or its userspace &quot;iw&quot; utility).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178551">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">theTimes</div>
					<div class="post-datetime">
						18 Sep 2012, 00:17					</div>
				</div>
				<div class="post-content content">
					<p>Hi jow, </p><p>that was an extremely helpful reply! Thanks I think I am on the right track now <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> </p><p>I imagine I could use the Linux cfg802111 netlink api for writing say, my own daemon to access these wireless statistics?</p><p>Regards</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178558">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						18 Sep 2012, 00:46					</div>
				</div>
				<div class="post-content content">
					<p>Yes, this is possible.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178574">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">theTimes</div>
					<div class="post-datetime">
						18 Sep 2012, 10:33					</div>
				</div>
				<div class="post-content content">
					<p>I tried the following command:</p><p>root@alix:~# iw dev wlan0 station dump</p><p>and it produced no output at all. I am not sure how to get my station&#039;s statistics using iw. Please can you let me know what I am possibly missing?</p><p>Thank you again!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178620">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						18 Sep 2012, 15:31					</div>
				</div>
				<div class="post-content content">
					<p>Maybe because no station is actually connected? Also note that this is an OpenWrt support channel, stuff told here might not work on Debian due to older hostapd / iw / libnl / compat-wireless used there.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178623">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">theTimes</div>
					<div class="post-datetime">
						18 Sep 2012, 15:51					</div>
				</div>
				<div class="post-content content">
					<p>Hi jow, </p><p>eventually it picked up other stations in the area. I then ran a routing protocol daemon (batmand), but I did notice that it gives me the station dump for stations reachable around me, but not any information about my own station. </p><p>The information below like noise and such , is what I want to find for my station.</p><p>Inter-| sta-|&nbsp; &nbsp;Quality&nbsp; &nbsp; &nbsp; &nbsp; |&nbsp; &nbsp;Discarded packets&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| Missed | WE<br /> face | tus | link level noise |&nbsp; nwid&nbsp; crypt&nbsp; &nbsp;frag&nbsp; retry&nbsp; &nbsp;misc | beacon | 22<br /> wlan0: 0000&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; 0</p><p>But I don&#039;t know how to find this kind of information, I was to use noise values for RSSI and such so I can formulate a very naive idea of interference.</p><p>I am busy combing thought the netlink api you mentioned above too.</p><p>Thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178624">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						18 Sep 2012, 16:05					</div>
				</div>
				<div class="post-content content">
					<p>Noise floor is reported by &quot;iw dev wlan0 survey dump&quot;. RSSI for own station is impossible to find out, thats a factum only your wireless peers know about.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178635">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">theTimes</div>
					<div class="post-datetime">
						18 Sep 2012, 17:15					</div>
				</div>
				<div class="post-content content">
					<p>Thanks jow, </p><p>this is interesting, it tells me that the operation survey dump is not supported:</p><p>command failed: Operation not supported (-95)</p><p>Would this mean I might need to get a newer version of ath5k ? Perhaps I should try ath9k...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178636">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">theTimes</div>
					<div class="post-datetime">
						18 Sep 2012, 17:21					</div>
				</div>
				<div class="post-content content">
					<p>Somehow I feel that this is the root of my problems: ath5k phy0: noise floor calibration timeout (2412MHz) - dmesg keeps out putting this.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178779">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">theTimes</div>
					<div class="post-datetime">
						19 Sep 2012, 20:15					</div>
				</div>
				<div class="post-content content">
					<p>If I am not mistaken, mac80211 support&nbsp; was phased out because apparently they thought it was useless.... yet they told,no-one about it, and furthermore did not remove commands that were now obsolete. </p><p>This is possibly why, iwspy and iw dev wlan0 survey dump return similar errors of &quot;not supported&quot;.</p><p>So my next question then is how do I get hold of these values? Do I get them from the driver...? or from the wireless card&#039;s registers? Can someone point me in the right direction please? <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Regards</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>