<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> sshd fails with &quot;Password has expired&quot;</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 4 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p150914">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">cptdondo</div>
					<div class="post-datetime">
						11 Dec 2011, 22:55					</div>
				</div>
				<div class="post-content content">
					<p>I just updated one of my OpenWRT aps to trunk.&nbsp; I can log in with telnet but as soon as I set a password I get:</p><p>User root password has expired (root forced) and the login is denied.</p><p>This would normally mean that the password has expiredin the /etc/shadow file but openwrt doesn&#039;t use shadow files... Can anyone clue me in as to why sshd is not working?&nbsp; It worked fine with backfire rc5.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150917">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						11 Dec 2011, 23:47					</div>
				</div>
				<div class="post-content content">
					<p>Trunk switched to shadow passwords, you need to redo your password files.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150921">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">cptdondo</div>
					<div class="post-datetime">
						11 Dec 2011, 23:59					</div>
				</div>
				<div class="post-content content">
					<p>That would explain it...&nbsp; I did a sysupgrade rather than reflash.&nbsp; Any way to do that?</p><p>passwd seems to just update /etc/passwd and not shadow.</p><p>I just tried a whole bunch of ways and it looks like passwd does not update shadow.....</p><p>OK, got it figured out.&nbsp; Trunk does not enable shadow password support in busybox by default.</p><p>Interesting... I have 2 boxes running trunk; one is BCM47XX and the other is Atheros AR9132.&nbsp; The broadcom one was built maybe a week or two ago and it works fine without shadow passwords.&nbsp; The atheros box was built today and it requires shadow.&nbsp; Playing on the bleeding edge.... :-)</p>											<p class="post-edited">(Last edited by <strong>cptdondo</strong> on 12 Dec 2011, 00:13)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150922">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">cptdondo</div>
					<div class="post-datetime">
						12 Dec 2011, 00:21					</div>
				</div>
				<div class="post-content content">
					<p>So that means that the clock on systems using shadow passwords will have to be set to something close to the current time.... If internet connection fails, and the clock cannot be set, then logins will fail due to expired passwords?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150923">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						12 Dec 2011, 00:23					</div>
				</div>
				<div class="post-content content">
					<p>It boils down to whether you built with an existing, old .config or whether you started from scratch. The switch to shadow passwords is one of those rare occasions where you have to hand-tune your .config, since the required busybox feature is not enforced but merely default.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>