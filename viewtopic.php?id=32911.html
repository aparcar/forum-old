<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Requirements for a router to run Luci+OpenVPN+QoS (short question)</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 28 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p148238">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Artem25</div>
					<div class="post-datetime">
						11 Nov 2011, 23:36					</div>
				</div>
				<div class="post-content content">
					<p>Hello everybody!<br />So here is my small question:</p><p>I would like to run Openwrt with a web-interface (Luci), QoS, and have an openVPN server for WAN connections (I have static IP from my provider).<br />I tried to install openvpn package on my DIR-300, but there is not enough space (Only 256kB left).<br />Do you have any suggestions - which router should I buy, or how much memory should it have to run OpenWRT with this desirable configuration?</p><p>Thanks in advance!<br />Artem</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p148244">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">F1aw</div>
					<div class="post-datetime">
						12 Nov 2011, 04:23					</div>
				</div>
				<div class="post-content content">
					<p>Try this page from the WIKI (<a href="http://wiki.openwrt.org/toh/start">http://wiki.openwrt.org/toh/start</a>). I do not recommend a router with less than 8mb flash. Of course you can use a router with only 4mb if it has a spare USB port with an external flash storage card used as EXTROOT (<a href="http://wiki.openwrt.org/doc/howto/extroot/extroot.theory">http://wiki.openwrt.org/doc/howto/extro â€¦ oot.theory</a>).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p148245">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						12 Nov 2011, 04:40					</div>
				</div>
				<div class="post-content content">
					<p>You should also contemplate to get a router with a built-in hardware for encryption, i.e. IPSEC co-processor on a Netgear <a href="http://wiki.openwrt.org/oldwiki/OpenWrtDocs/Hardware/Netgear/WGT634U">WGT634U</a>, to boost up encrypted VPN connections.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p148261">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						12 Nov 2011, 12:56					</div>
				</div>
				<div class="post-content content">
					<p>Try Kamikaze 8.09.2.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p148396">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">Artem25</div>
					<div class="post-datetime">
						13 Nov 2011, 22:56					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for replies!<br />Unfortunately, I did not find this Netgear router in Moscow.<br />I want to buy a second-hand router.</p><p>Can I buy a router with 8Mb flash or more, and with a fast processor (300MHz)? But without the encryption co-processor?<br />Because it is rather tricky to find it all in one time..</p><p>Thanks everybody for replies. I will also try to install Kamikaze, but I am not sure, I can compile it.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p148426">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						14 Nov 2011, 08:44					</div>
				</div>
				<div class="post-content content">
					<p><a href="http://downloads.openwrt.org/kamikaze/8.09.2/atheros/">http://downloads.openwrt.org/kamikaze/8.09.2/atheros/</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p148437">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">Artem25</div>
					<div class="post-datetime">
						14 Nov 2011, 11:54					</div>
				</div>
				<div class="post-content content">
					<p>Thank you very much!<br />I will try it soon.</p><p>Kind Regards,<br />Artem</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p148663">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">awm1</div>
					<div class="post-datetime">
						15 Nov 2011, 15:20					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>fyi wrote:</cite><blockquote><p><a href="http://downloads.openwrt.org/kamikaze/8.09.2/atheros/">http://downloads.openwrt.org/kamikaze/8.09.2/atheros/</a></p></blockquote></div><p>Why such an old release?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p148675">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">eleon216</div>
					<div class="post-datetime">
						15 Nov 2011, 17:16					</div>
				</div>
				<div class="post-content content">
					<p>the suggestion using the old release just because the basesystem of openwrt grew bigger ever release so it quite hard to fit all packages the OP needs in 4MB flash with backfire 10.3.1. But there may be a chance to achieve it with kamikaze. <br />But I wouldn&#039;t suggest this, I normally would suggest building your own image with everthing included, and if it&#039;s to big think about if luci is really mandatory. Openvpn and qos fits fine in 4MB but openvpn, qos and luci is getting tricky. </p><p>and I would like to comment the hardwarecrypto-advice. the wgt634u is only able to use the hardware-crypto-engine for DES, so forget this one. And you won&#039;t be happy with the wl-500g premium either (I tried this some time ago, I got it working, but as openvpn isn&#039;t running in kernelspace there is a lot of copying in ram, so I ended up with a slower encryption than with softwareencryption). And an half decent cpu (400Mhz) would be enough for at least 5Mbit/s, or even more.&nbsp; So only consider hardware-encryption, if you have a fast (and synchron) internetconnection and then get a some hardware-crypto-solution that&#039;s really working and not this broadcom-stuff.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p148677">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						15 Nov 2011, 17:21					</div>
				</div>
				<div class="post-content content">
					<p>Well for fun I just took the RC6 imagebuilder, built a standard image with LuCI, OpenVPN, qos-scripts minus pppoe and opkg and ended up with a 3.6MB combined image. Looks quite doable to me.</p><p>Edit: using the classic atheros target as the op asked for a dir-300 image</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p148699">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">Artem25</div>
					<div class="post-datetime">
						15 Nov 2011, 22:37					</div>
				</div>
				<div class="post-content content">
					<p>eleon216,<br />Thank you very much for your reply. You get in details, and this is really what I was asking about.<br />I am realy affraid of using a router without Luci, as I am not sure, that I can do all needed adjustments. Such as openvpn-server setup and even port-forwarding. I am not so good at iptables.. This is my shame.<br />And what about the speed of the Internet connection for computers inside LAN?<br />Now I have an access for each computer (2 computers) trough my router to the Internet. If I will run OpenVPN server to connect to this network with my laptop to the WAN port, will it reduce the speed of the Internet connection to this users inside existing LAN?</p><p>Thank you also with the advice regarding asus router. I was just about to buy it!!<br />Now I will think twice.<br />So, what is your advice then? If I am not able to use hardware-encruuption: should I just buy any router with a fast CPU and that will be enough? Assuming this logic, I need DIR-320 with 240MHz at least?</p><br /><p>jow,<br />could I kindly ask you to provide me with this pre-build image? The thing is, I allready tried two times to build it, and had a non-workable device. I asked another gue in the forum, he did it for me.. Or if I will not bother you - may I send you few PM during the compiling process?</p><p>Kind Regards<br />Artem</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p148716">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						16 Nov 2011, 05:41					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Artem25 wrote:</cite><blockquote><p>Thank you very much!<br />I will try it soon.</p></blockquote></div><p>So, did you or did you not? Did you run out of space installing OpenVPN over Kamikaze 8.09.2?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p148727">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">Artem25</div>
					<div class="post-datetime">
						16 Nov 2011, 10:44					</div>
				</div>
				<div class="post-content content">
					<p>Currently I am running this configuration:<br />Firmware Version&nbsp; &nbsp;&nbsp; OpenWrt Firmware Attitude Adjustment (r28185) / LuCI Trunk trunk+svn7466<br />Kernel Version&nbsp; &nbsp;&nbsp; &nbsp; 2.6.39.4</p><p>As the router is far away from me (100 km) I need to collect the information first, then decide what to do and then drive there and replace the firmware.</p><p>And I allready tryed to install openvpn, but it said, there is not enough memory.</p>											<p class="post-edited">(Last edited by <strong>Artem25</strong> on 16 Nov 2011, 11:27)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p148744">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">eleon216</div>
					<div class="post-datetime">
						16 Nov 2011, 15:28					</div>
				</div>
				<div class="post-content content">
					<p>Hi, </p><p>jow already tried it, and 3,6 MB look like it should be possible to fit all packages in a recent (trunk or backfire) image. It&#039;s still not much space left for something else because 320kB are used but the bootloader and stuff, but it should be possible, and I would recommend this option. <br />but you have to include everthing in the highly compressed readonly filessystem (squashfs), there is not enough flash to install it to the (less compressed) jffs2-partion afterwards. <br />You have to create your own image. you could build (compile) everthing <a href="http://wiki.openwrt.org/doc/howto/build">http://wiki.openwrt.org/doc/howto/build</a><br />or just create your own firmwareimage with precompiled packages with the image-builder <a href="http://wiki.openwrt.org/doc/howto/obtain.firmware.generate">http://wiki.openwrt.org/doc/howto/obtai â€¦ e.generate</a></p><p>so it should be possible to run this on your existing hardware. <br />You only have to consider new hardware is you experience preformance-issues. The 180MHz CPU of the DIR-300 is quite slow, and encryption is a quite cpu-intensive task so you shouldn&#039;t expect to run a 50MBit-VPN-connection. <br />But if you have an asychron internet-connection. e.g. in my case I have a ADSL line with 8Mbit download and 768kbit upload. And I use vpn to get files from my pc at home when I&#039;m somewhere else, and sometimes to encrypt my data when I&#039;m using insecure hotspots, so in all cases the upload-speed of my internet connection is limiting the speed of the vpn-connection and 768kbit/s is slow and this can handle every cpu. A faster cpu or a hardware-crypto wouldn&#039;t change anything. So you just have to figure out if the cpu would be the limiting factor, before you buy something with a faster cpu.</p>											<p class="post-edited">(Last edited by <strong>eleon216</strong> on 16 Nov 2011, 15:29)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p148746">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">Artem25</div>
					<div class="post-datetime">
						16 Nov 2011, 15:56					</div>
				</div>
				<div class="post-content content">
					<p>eleon216<br />Thank you for explanations.</p><p>Well, for the limiting factor - the speed of the connection I am not worried too much.<br />In Russia, far away from cities even, you can have a 20 Mbit download and upload for about 15 Euros in a month.</p><p>I will try to make my own build and try kamikazze too. But first I will find another router for this experiment.<br />So I will let you know how things get on.</p><p>Artem</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p148751">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">eleon216</div>
					<div class="post-datetime">
						16 Nov 2011, 16:37					</div>
				</div>
				<div class="post-content content">
					<p>it think there is a missunderstanding...</p><p>if you have a synchron 20Mbit/s connection you have to think about the speed of your router! <br />The cpu of the dir-300 cannot handle the encryption of a 20Mbit/s stream so you have to think about a fast cpu, or a hardware-crypto-acceleration. <br />it may be a little different with openvpn, but to get an impression what encryption/decryption-rate the cpus can handle: <br />I just run a scp from my pc to /dev/null of the router so it&#039;s going through an aes-encrypted ssh-connection (no hardware crypto acceleration). <br />I can copy to a asus wl-500g premium (broadcom mips-cpu 250MHz) with a rate of 1MByte/sec so I will not get more than 10Mbit/s if I am using it for a vpn-connection. <br />my wndr3700 (atheros-mips cpu 680Mhz) can handle 3MBytes/s so it will be able to run a vpn-connection up to 30Mbit/s. Your dir-300 (180MHz) will handle 5Mbit/s&nbsp; maybe 6-7Mbits/s but not more. So if you have an faster connection the cpu of the router will probably be a bottleneck.</p>											<p class="post-edited">(Last edited by <strong>eleon216</strong> on 16 Nov 2011, 16:38)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p148753">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						16 Nov 2011, 16:53					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Artem25 wrote:</cite><blockquote><p>Well, for the limiting factor - the speed of the connection I am not worried too much.<br />In Russia, far away from cities even, you can have a 20 Mbit download and upload for about 15 Euros in a month.</p><p>I will try to make my own build and try kamikazze too. But first I will find another router for this experiment.</p></blockquote></div><p>If you plan to find another router, you can dump the idea of Kamikaze because I don&#039;t think that DIR-300-A1 can handle 20Mbps download and upload, that is, 40Mbps, with QoS and multiple OpenVPN clients.</p><p>Personally I recommend TP-LINK TL-WR1043ND and Buffalo WZR-HP-G300NH. RouterBoard RB750GL and RB450G with RouterOS build-in can also meet your requirements.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p148754">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">Artem25</div>
					<div class="post-datetime">
						16 Nov 2011, 17:06					</div>
				</div>
				<div class="post-content content">
					<p>eleon216<br />Yes, I did understand you just from the previous message.<br />I read my reply now and realize, it was not a very clear reply. But I_do_understand everything you write, be sure please <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />Now I am searching trough second-hand stocks in Moscow and try to find something appropriate for around 10Euros. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p148755">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						16 Nov 2011, 17:28					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Artem25 wrote:</cite><blockquote><p>Now I am searching trough second-hand stocks in Moscow and try to find something appropriate for around 10Euros. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></blockquote></div><p>10Euros. Maybe you should consider TP-LINK TL-WR740N or TL-WR741ND with USB mod.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p149106">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						20 Nov 2011, 22:03					</div>
				</div>
				<div class="post-content content">
					<p><a href="http://www.dd-wrt.com/phpBB2/viewtopic.php?p=359506#359506">DD-WRT Forum :: View topic - DIR-300 - OpenVPN</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p150479">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">Artem25</div>
					<div class="post-datetime">
						6 Dec 2011, 17:58					</div>
				</div>
				<div class="post-content content">
					<p>Thanks everybody for discussion!<br />What I did, I&#039;ve made a paot-forwarding inside my network and connect to my pfSense computer.</p><p>That is how I&#039;ve solved my problem. In the nearest future I will make it inside an OpenWRT router, but now have not appropriate model.</p><p>Kind Regards,<br />Artem</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p173904">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">withfullforce</div>
					<div class="post-datetime">
						2 Aug 2012, 20:43					</div>
				</div>
				<div class="post-content content">
					<p>I have build a litte Image (r32934) for the DIR-300 B1 with Openvpn working (tun/tap and lzo)</p><p>The is no wireless, no webinterface, to get free space...</p><p>The Files it contains are:<br /></p><div class="codebox"><pre><code>base-files - 112-r32934
busybox - 1.19.4-2
dnsmasq - 2.62-1
dropbear - 2011.54-2
firewall - 2-53
hotplug2 - 1.0-beta-4
iptables - 1.4.10-4
jshn - 2012-07-08-cca2ed6c8cdb3555fea43ff63ba1c9905dd7a164
kernel - 3.3.8-1-0d08e76cba411ef7dbf49377257b628d
kmod-button-hotplug - 3.3.8-3
kmod-input-core - 3.3.8-1
kmod-input-gpio-keys-polled - 3.3.8-1
kmod-input-polldev - 3.3.8-1
kmod-ipt-conntrack - 3.3.8-1
kmod-ipt-core - 3.3.8-1
kmod-ipt-nat - 3.3.8-1
kmod-ipt-nathelper - 3.3.8-1
kmod-leds-gpio - 3.3.8-1
kmod-ledtrig-usbdev - 3.3.8-1
kmod-lib-crc-ccitt - 3.3.8-1
kmod-nls-base - 3.3.8-1
kmod-ppp - 3.3.8-1
kmod-pppoe - 3.3.8-1
kmod-pppox - 3.3.8-1
kmod-tun - 3.3.8-1
kmod-usb-core - 3.3.8-1
kmod-usb-rt305x-dwc_otg - 3.3.8-1
libblobmsg-json - 2012-07-08-cca2ed6c8cdb3555fea43ff63ba1c9905dd7a164
libc - 0.9.33.2-1
libgcc - 4.6-linaro-1
libip4tc - 1.4.10-4
libjson - 0.9-2
liblzo - 2.06-1
libnl-tiny - 0.1-3
libopenssl - 1.0.1c-1
libubox - 2012-07-08-cca2ed6c8cdb3555fea43ff63ba1c9905dd7a164
libubus - 2012-06-01-a62e2f8c15a65efb1a82404d8f31e3bfc1cbe7d9
libuci - 2012-03-28.1-1
libxtables - 1.4.10-4
maccalc - 1
mtd - 18
netifd - 2012-07-12-857874b2d4f92b800ecc12a5e52adeaf3855b101
openvpn - 2.2.2-2
opkg - 618-2
ppp - 2.4.5-6
ppp-mod-pppoe - 2.4.5-6
swconfig - 10
ubus - 2012-06-01-a62e2f8c15a65efb1a82404d8f31e3bfc1cbe7d9
ubusd - 2012-06-01-a62e2f8c15a65efb1a82404d8f31e3bfc1cbe7d9
uci - 2012-03-28.1-1
wpad-mini - 20120428-1
zlib - 1.2.7-1</code></pre></div><p>Maybe the are some Packages that could be also removed but i was not sure to get a working device after <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />It was only possible to flash it through the failsafe-mode.</p><p><a href="http://www.file-upload.net/download-4627570/openwrt-ramips-rt305x-dir-300-b1-squashfs-factory.bin.html/">dir300-b1-factory.bin</a><br /><a href="http://www.file-upload.net/download-4627658/openwrt-ramips-rt305x-dir-300-b1-squashfs-sysupgrade.bin.html/">dir300-b1-sysupgrade.bin</a></p><div class="codebox"><pre><code>root@OpenWrt:~# df
Filesystem           1K-blocks      Used Available Use% Mounted on
rootfs                    1152       212       940  18% /
/dev/root                 1792      1792         0 100% /rom
tmpfs                    15060        52     15008   0% /tmp
tmpfs                      512         0       512   0% /dev
/dev/mtdblock5            1152       212       940  18% /overlay
overlayfs:/overlay        1152       212       940  18% /</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p173919">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">Artem25</div>
					<div class="post-datetime">
						3 Aug 2012, 01:21					</div>
				</div>
				<div class="post-content content">
					<p>Thank you! If I will have an access to my router, may be I will try it! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p182931">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">phuque99</div>
					<div class="post-datetime">
						11 Nov 2012, 05:17					</div>
				</div>
				<div class="post-content content">
					<p>You could compile your own firmware, exclude Luci GUI and include OpenVPN. There should be just enough spare with bare minimum packages.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p183286">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">phuque99</div>
					<div class="post-datetime">
						15 Nov 2012, 05:32					</div>
				</div>
				<div class="post-content content">
					<p>Try reading this and you should checkout the attitude adjustment branch instead of trunk:<br /><a href="http://wiki.openwrt.org/doc/howto/buildroot.exigence">http://wiki.openwrt.org/doc/howto/buildroot.exigence</a></p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>