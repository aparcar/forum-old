<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> serial console just dies</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 18 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p16830">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">lulima</div>
					<div class="post-datetime">
						8 Dec 2005, 10:54					</div>
				</div>
				<div class="post-content content">
					<p>Hi guys, </p><p>I have a wrt54gs v1.1.&nbsp; and succesfully added a serial port (and yes the circuit works, wasn&#039;t my first max232 circuit ;-).<br />I also have a wrt54g for quite some time and played around with openwrt for more than 1.5 years now (sadly the wrt54g v1.1 has no serial capability).<br />But back to the wrt54gs (my backup unit).</p><p>Some weeks ago I flashed rc3 with squashfs on it (yes the correct way with mtd ...). But I never got it really working, poor wrt54gs was sitting there with power led blinking (couldn&#039;t even ping it!). <br />Tried to see something on the serial console -&gt; nothing (sometimes garbage, but yes the serial protocol seetings were correct, tried everything, believe me).</p><p>Grabbed a JTAG cable and backed up the whole FLASH. Then erased the NVRAM and the KERNEL via JTAG. <br />Reboot the router and surprise the serial console started working showing me the CFE bootloader messages. At the end it&nbsp; complained (as expected) about not finding a bootable image (quickly set boot_wait=on within CFE command line). But now I was able to tftp a new image on it. I used an rc3 jffs image (read in the forums something about squasfs not working sometimes on some models) and tftp worked and I was able to get shell via telnet/ssh as well as via the serial console. <br />Serial console was working - good ... so far.</p><p>In the meanwhile rc4 was out and I used an rc4 jffs image (I sticked to the jffs due to the success before with rc3) with the correct mtd command to update to the new version. <br />It was succesful and the router rebooted and I was able to login via telnet/ssh. Okay ...<br />But the f*$#%ing serial console is again gone - sometimes nothing, sometimes garbage, but nothing human readable. I need to have the serial console to log in case I screw up the network/switch settings since I have no failsafe mode with jffs (I don&#039;t trust myself sometimes).</p><p>Does anyone experienced the same behaviour? Are there any NVRAM settings affecting the serial console? <br />I am aging rapidly with this stupid issue.<br />Thanks for your help and comments!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p16868">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">lulima</div>
					<div class="post-datetime">
						9 Dec 2005, 00:38					</div>
				</div>
				<div class="post-content content">
					<p>Now I know how to restore the serial console:<br />Erasing the NVRAM via JTAG and it works only via JTAG (with &#039;mtd -r erase nvram&#039; the router starts up again, but without the serial console working).<br />Does anybody have clue why?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p16876">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Grimson</div>
					<div class="post-datetime">
						9 Dec 2005, 03:54					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>lulima wrote:</cite><blockquote><p>Erasing the NVRAM via JTAG and it works only via JTAG (with &#039;mtd -r erase nvram&#039; the router starts up again, but without the serial console working).<br />Does anybody have clue why?</p></blockquote></div><p><a href="http://forum.openwrt.org/viewtopic.php?id=3474">http://forum.openwrt.org/viewtopic.php?id=3474</a> Look at #8</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p16881">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">lulima</div>
					<div class="post-datetime">
						9 Dec 2005, 09:51					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Grimson wrote:</cite><blockquote><p><a href="http://forum.openwrt.org/viewtopic.php?id=3474">http://forum.openwrt.org/viewtopic.php?id=3474</a> Look at #8</p></blockquote></div><p>This is generally just not true. On some routers the bootloader creates a sane set of NVRAM during next start-up. So does mine.<br />I did not screw my router up. It works. I just cannot get the serial console to work sometimes. And point #8 says clearly&nbsp; &quot;... most devices ...&quot;.<br />I had the problem with the serial before I desperately tried the mtd command. BTW, having a JTAG cable forgives you almost every mistake you do with the flash</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>