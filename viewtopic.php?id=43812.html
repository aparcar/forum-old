<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> WBMR-HP-G300H - Usb performance</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 20 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p199846">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Jim3</div>
					<div class="post-datetime">
						27 Apr 2013, 15:45					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I have a WBMR-HP-G300H with a usb hard drive attached that I am using as a smb nas.</p><p>After much tinkering with smb config, mount options, and kernel block device settings, the best network I can get out of it with wired ethernet to a Windows 7 box is about 4.5MB write, and 3.5MB read to and from the nas.</p><p>When I run the hdparm benchmark, I get about 19MB on the device.</p><p>If I look at the cpu usage in top when transferring a large file to / from the nas, smbd if using about 75% and usb is using the remaining 25%.</p><p>I&#039;m wondering if I&#039;ve got something configured wrong somewhere and its causing the smbd process to stall / wait for the disc or network, or if I&#039;ve just reached the maximum possible for the cpu in the router?</p><p>Can anyone else with this router and similar setup share their nas network speeds?</p><p>I&#039;d like to compare and see how far off mine is.</p><p>Thanks</p><p>Jim</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p199859">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">peps1iko</div>
					<div class="post-datetime">
						27 Apr 2013, 19:33					</div>
				</div>
				<div class="post-content content">
					<p>Which file system did you use?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p199863">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Jim3</div>
					<div class="post-datetime">
						27 Apr 2013, 20:20					</div>
				</div>
				<div class="post-content content">
					<p>I used ext4.</p><p>I started off with it journalled, then turned off the journalling as I thought that might improve performance.</p><p>It didn&#039;t make any difference.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p199865">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">snk</div>
					<div class="post-datetime">
						27 Apr 2013, 21:16					</div>
				</div>
				<div class="post-content content">
					<p>Make sure you don&#039;t have &#039;sync&#039; in the mount options.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p199870">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">Jim3</div>
					<div class="post-datetime">
						27 Apr 2013, 22:52					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for replying, this is the mount settings I&#039;m using.</p><div class="codebox"><pre><code>mount -t ext4 -o rw,noatime,nodiratime,data=ordered,barrier=1,errors=remount-ro /dev/sda1 /mnt/sda1</code></pre></div><p>I just have it as a line in the bottom of /etc/rc.local at the moment.&nbsp; I don&#039;t think moving it into an fstab entry would make a difference would it?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>