<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> x86_64: APU2 hangs during boot</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 6 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p317799">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">dibdot</div>
					<div class="post-datetime">
						2 Apr 2016, 12:21					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>this week I&#039;ve received a brand new APU2 (2c4) board. I&#039;ve tested the latest snapshot trunk, CC 15.01 image and my own buildroot ... with all of them I can&#039;t boot (see snapshot bootlog below), every time the boot process stops at &quot;clocksource: Switched to clocksource tsc&quot;.&nbsp; Anyone else using such device or any ideas to solve this problem?</p><p>Thanks!</p><div class="codebox"><pre><code>PCEngines apu2
coreboot build 20160307
4080 MB ECC DRAM

SeaBIOS (version ?-20160307_153453-michael-desktop64)
Found mainboard PC Engines PCEngines apu2
[...]
[    0.000000] Linux version 4.4.6 (openwrt@openwrtbuild) (gcc version 5.3.0 (OpenWrt GCC 5.3.0 r49096) ) #1 SMP Fri Apr 1 14:11:26 UTC 2016
[    0.000000] Command line: BOOT_IMAGE=/boot/vmlinuz root=PARTUUID=85f77335-02 rootfstype=ext4 rootwait console=tty0 console=ttyS0,115200n8 noinitrd
[    0.000000] x86/fpu: xstate_offset[2]:  576, xstate_sizes[2]:  256
[    0.000000] x86/fpu: Supporting XSAVE feature 0x01: &#039;x87 floating point registers&#039;
[    0.000000] x86/fpu: Supporting XSAVE feature 0x02: &#039;SSE registers&#039;
[    0.000000] x86/fpu: Supporting XSAVE feature 0x04: &#039;AVX registers&#039;
[    0.000000] x86/fpu: Enabled xstate features 0x7, context size is 832 bytes, using &#039;standard&#039; format.
[    0.000000] x86/fpu: Using &#039;eager&#039; FPU context switches.
[    0.000000] e820: BIOS-provided physical RAM map:
[    0.000000] BIOS-e820: [mem 0x0000000000000000-0x000000000009f7ff] usable
[    0.000000] BIOS-e820: [mem 0x000000000009f800-0x000000000009ffff] reserved
[    0.000000] BIOS-e820: [mem 0x00000000000f0000-0x00000000000fffff] reserved
[    0.000000] BIOS-e820: [mem 0x0000000000100000-0x00000000dffadfff] usable
[    0.000000] BIOS-e820: [mem 0x00000000dffae000-0x00000000dfffffff] reserved
[    0.000000] BIOS-e820: [mem 0x00000000f8000000-0x00000000fbffffff] reserved
[    0.000000] BIOS-e820: [mem 0x0000000100000000-0x000000011effffff] usable
[    0.000000] NX (Execute Disable) protection: active
[    0.000000] e820: last_pfn = 0x11f000 max_arch_pfn = 0x400000000
[    0.000000] x86/PAT: Configuration [0-7]: WB  WC  UC- UC  WB  WC  UC- WT  
[    0.000000] e820: last_pfn = 0xdffae max_arch_pfn = 0x400000000
[    0.000000] found SMP MP-table at [mem 0x000f2f30-0x000f2f3f] mapped at [ffff8800000f2f30]
[    0.000000] Using GB pages for direct mapping
[...]
[    0.000000] clocksource: hpet: mask: 0xffffffff max_cycles: 0xffffffff, max_idle_ns: 133484873504 ns
[    0.000000] tsc: Fast TSC calibration using PIT
[    0.000000] tsc: Detected 998.146 MHz processor
[    0.000008] Calibrating delay loop (skipped), value calculated using timer frequency.. 1996.29 BogoMIPS (lpj=9981460)
[    0.010693] pid_max: default: 32768 minimum: 301
[    0.015332] ACPI: Core revision 20150930
[    0.035909] ACPI: 4 ACPI AML tables successfully acquired and loaded
[    0.042486] Mount-cache hash table entries: 8192 (order: 4, 65536 bytes)
[    0.049213] Mountpoint-cache hash table entries: 8192 (order: 4, 65536 bytes)
[    0.057072] CPU: Physical Processor ID: 0
[    0.061113] CPU: Processor Core ID: 0
[    0.064792] mce: CPU supports 6 MCE banks
[    0.068883] LVT offset 1 assigned for vector 0xf9
[    0.073641] Last level iTLB entries: 4KB 512, 2MB 8, 4MB 4
[    0.079151] Last level dTLB entries: 4KB 512, 2MB 256, 4MB 128, 1GB 0
[    0.085906] Freeing SMP alternatives memory: 20K (ffffffff816d8000 - ffffffff816dd000)
[    0.097192] ..TIMER: vector=0x30 apic1=0 pin1=2 apic2=0 pin2=0
[    0.320447] smpboot: CPU0: AMD GX-412TC SOC (family: 0x16, model: 0x30, stepping: 0x1)
[    0.328474] Performance Events: AMD PMU driver.
[    0.333071] ... version:                0
[    0.337099] ... bit width:              48
[    0.341234] ... generic registers:      4
[    0.345260] ... value mask:             0000ffffffffffff
[    0.350590] ... max period:             00007fffffffffff
[    0.355913] ... fixed-purpose events:   0
[    0.359961] ... event mask:             000000000000000f
[    0.366140] x86: Booting SMP configuration:
[    0.370336] .... node  #0, CPUs:      #1 #2 #3
[    0.383110] x86: Booted up 1 node, 4 CPUs
[    0.387358] smpboot: Total of 4 processors activated (7985.16 BogoMIPS)
[    0.396825] clocksource: jiffies: mask: 0xffffffff max_cycles: 0xffffffff, max_idle_ns: 19112604462750000 ns
[    0.407537] NET: Registered protocol family 16
[    0.440491] cpuidle: using governor ladder
[    0.444852] ACPI: bus type PCI registered
[    0.448919] PCI: Using configuration type 1 for base access
[    0.454515] PCI: Using configuration type 1 for extended access
[    0.491122] ACPI: Added _OSI(Module Device)
[    0.495342] ACPI: Added _OSI(Processor Device)
[    0.499810] ACPI: Added _OSI(3.0 _SCP Extensions)
[    0.504566] ACPI: Added _OSI(Processor Aggregator Device)
[    0.514491] ACPI: Executed 1 blocks of module-level executable AML code
[    0.533555] ACPI: Interpreter enabled
[    0.537300] ACPI: (supports S0 S5)
[    0.540725] ACPI: Using IOAPIC for interrupt routing
[    0.545744] PCI: Using host bridge windows from ACPI; if necessary, use &quot;pci=nocrs&quot; and report a bug
[    0.563572] ACPI: PCI Root Bridge [PCI0] (domain 0000 [bus 00-ff])
[    0.569779] acpi PNP0A08:00: _OSC: OS supports [ExtendedConfig Segments MSI]
[    0.577016] acpi PNP0A08:00: _OSC: not requesting OS control; OS requires [ExtendedConfig ASPM ClockPM MSI]
[    0.586929] acpi PNP0A08:00: host bridge window expanded to [io  0x0000-0x0cf7 window]; [io  0x03b0-0x03df window] ignored
[    0.598118] PCI host bridge to bus 0000:00
[    0.602275] pci_bus 0000:00: root bus resource [io  0x0000-0x0cf7 window]
[    0.609071] pci_bus 0000:00: root bus resource [io  0x0d00-0xffff window]
[    0.615879] pci_bus 0000:00: root bus resource [mem 0x000a0000-0x000bffff]
[    0.622768] pci_bus 0000:00: root bus resource [mem 0x000c0000-0x000dffff]
[    0.629684] pci_bus 0000:00: root bus resource [mem 0xe0000000-0xffffffff]
[    0.636573] pci_bus 0000:00: root bus resource [bus 00-ff]
[    0.645438] pci 0000:00:11.0: set SATA to AHCI mode
[    0.654442] pci 0000:00:02.2: PCI bridge to [bus 01]
[    0.660090] pci 0000:00:02.3: PCI bridge to [bus 02]
[    0.665768] pci 0000:00:02.4: PCI bridge to [bus 03]
[    0.671321] pci 0000:00:02.5: PCI bridge to [bus 04]
[    0.677062] ACPI: PCI Interrupt Link [INTA] (IRQs *3 5 7 10 11 12 15)
[    0.684059] ACPI: PCI Interrupt Link [INTB] (IRQs *3 5 7 10 11 12 15)
[    0.690999] ACPI: PCI Interrupt Link [INTC] (IRQs 3 *5 7 10 11 12 15)
[    0.697893] ACPI: PCI Interrupt Link [INTD] (IRQs 3 5 *7 10 11 12 15)
[    0.704904] ACPI: PCI Interrupt Link [INTE] (IRQs 3 5 7 10 *11 12 15)
[    0.711865] ACPI: PCI Interrupt Link [INTF] (IRQs 3 5 7 *10 11 12 15)
[    0.718810] ACPI: Enabled 4 GPEs in block 00 to 1F
[    0.724135] SCSI subsystem initialized
[    0.728073] ACPI: bus type USB registered
[    0.732227] usbcore: registered new interface driver usbfs
[    0.737789] usbcore: registered new interface driver hub
[    0.743207] usbcore: registered new device driver usb
[    0.748457] PCI: Using ACPI for IRQ routing
[    0.753555] hpet0: at MMIO 0xfed00000, IRQs 2, 8, 0
[    0.758568] hpet0: 3 comparators, 32-bit 14.318180 MHz counter
[    0.766567] clocksource: Switched to clocksource hpet
[    0.771977] pnp: PnP ACPI init
[    0.775452] system 00:00: [mem 0xfec10002-0xfec11001] has been reserved
[    0.782738] pnp: PnP ACPI: found 3 devices
[    0.794706] clocksource: acpi_pm: mask: 0xffffff max_cycles: 0xffffff, max_idle_ns: 2085701024 ns
[    0.803704] pci 0000:00:02.2: PCI bridge to [bus 01]
[    0.808696] pci 0000:00:02.2:   bridge window [io  0x1000-0x1fff]
[    0.814832] pci 0000:00:02.2:   bridge window [mem 0xfe500000-0xfe5fffff]
[    0.821698] pci 0000:00:02.3: PCI bridge to [bus 02]
[    0.826692] pci 0000:00:02.3:   bridge window [io  0x2000-0x2fff]
[    0.832831] pci 0000:00:02.3:   bridge window [mem 0xfe600000-0xfe6fffff]
[    0.839660] pci 0000:00:02.4: PCI bridge to [bus 03]
[    0.844677] pci 0000:00:02.4:   bridge window [io  0x3000-0x3fff]
[    0.850807] pci 0000:00:02.4:   bridge window [mem 0xfe700000-0xfe7fffff]
[    0.857682] pci 0000:00:02.5: PCI bridge to [bus 04]
[    0.862679] pci 0000:00:02.5:   bridge window [mem 0xfe200000-0xfe4fffff]
[    0.869676] NET: Registered protocol family 2
[    0.874514] TCP established hash table entries: 32768 (order: 6, 262144 bytes)
[    0.882048] TCP bind hash table entries: 32768 (order: 7, 524288 bytes)
[    0.889064] TCP: Hash tables configured (established 32768 bind 32768)
[    0.895750] UDP hash table entries: 2048 (order: 4, 65536 bytes)
[    0.901863] UDP-Lite hash table entries: 2048 (order: 4, 65536 bytes)
[    0.908560] NET: Registered protocol family 1
[    0.913578] PCI-DMA: Using software bounce buffering for IO (SWIOTLB)
[    0.920094] software IO TLB [mem 0xdbfae000-0xdffae000] (64MB) mapped at [ffff8800dbfae000-ffff8800dffadfff]
[    0.930168] perf: AMD NB counters detected
[    0.934278] perf: AMD L2I counters detected
[    0.938576] LVT offset 0 assigned for vector 0x400
[    0.943428] perf: AMD IBS detected (0x000000ff)
[    0.948670] futex hash table entries: 1024 (order: 4, 65536 bytes)
[    0.961803] squashfs: version 4.0 (2009/01/31) Phillip Lougher
[    0.967674] jffs2: version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006 Red Hat, Inc.
[    0.978395] Block layer SCSI generic (bsg) driver version 0.4 loaded (major 252)
[    0.985826] io scheduler noop registered
[    0.989794] io scheduler deadline registered (default)
[    0.996890] input: Power Button as /devices/LNXSYSTM:00/LNXSYBUS:00/PNP0C0C:00/input/input0
[    1.005272] ACPI: Power Button [PWRB]
[    1.009129] input: Power Button as /devices/LNXSYSTM:00/LNXPWRBN:00/input/input1
[    1.016578] ACPI: Power Button [PWRF]
[    1.021754] Serial: 8250/16550 driver, 16 ports, IRQ sharing enabled
[    1.049294] 00:02: ttyS0 at I/O 0x3f8 (irq = 4, base_baud = 115200) is a 16550A
[    1.077704] serial8250: ttyS1 at I/O 0x2f8 (irq = 3, base_baud = 115200) is a 16550A
[    1.087402] Non-volatile memory driver v1.3
[    1.092483] Guest personality initialized and is inactive
[    1.097986] VMCI host device registered (name=vmci, major=10, minor=63)
[    1.104604] Initialized host personality
[    1.108732] VMware PVSCSI driver - version 1.0.5.0-k
[    1.114331] ahci 0000:00:11.0: AHCI 0001.0300 32 slots 2 ports 6 Gbps 0x3 impl SATA mode
[    1.122495] ahci 0000:00:11.0: flags: 64bit ncq sntf ilck pm led clo pmp fbs pio slum part 
[    1.132443] scsi host0: ahci
[    1.135694] scsi host1: ahci
[    1.138768] ata1: SATA max UDMA/133 abar m1024@0xfea25000 port 0xfea25100 irq 19
[    1.146176] ata2: SATA max UDMA/133 abar m1024@0xfea25000 port 0xfea25180 irq 19
[    1.154114] VMware vmxnet3 virtual NIC driver - version 1.4.5.0-k-NAPI
[    1.160725] ehci_hcd: USB 2.0 &#039;Enhanced&#039; Host Controller (EHCI) Driver
[    1.167301] ehci-pci: EHCI PCI platform driver
[    1.172110] ehci-pci 0000:00:13.0: EHCI Host Controller
[    1.177421] ehci-pci 0000:00:13.0: new USB bus registered, assigned bus number 1
[    1.184873] ehci-pci 0000:00:13.0: applying AMD SB700/SB800/Hudson-2/3 EHCI dummy qh workaround
[    1.193605] ehci-pci 0000:00:13.0: debug port 2
[    1.198248] ehci-pci 0000:00:13.0: irq 18, io mem 0xfea25400
[    1.216658] ehci-pci 0000:00:13.0: USB 2.0 started, EHCI 1.00
[    1.222774] hub 1-0:1.0: USB hub found
[    1.226564] hub 1-0:1.0: 2 ports detected
[    1.230879] ehci-platform: EHCI generic platform driver
[    1.236151] ohci_hcd: USB 1.1 &#039;Open&#039; Host Controller (OHCI) Driver
[    1.242388] ohci-pci: OHCI PCI platform driver
[    1.246918] ohci-platform: OHCI generic platform driver
[    1.252210] uhci_hcd: USB Universal Host Controller Interface driver
[    1.258861] xhci_hcd 0000:00:10.0: xHCI Host Controller
[    1.264109] xhci_hcd 0000:00:10.0: new USB bus registered, assigned bus number 2
[    1.271785] xhci_hcd 0000:00:10.0: hcc params 0x014040c3 hci version 0x100 quirks 0x00000410
[    1.281183] hub 2-0:1.0: USB hub found
[    1.285005] hub 2-0:1.0: 2 ports detected
[    1.289305] xhci_hcd 0000:00:10.0: xHCI Host Controller
[    1.294547] xhci_hcd 0000:00:10.0: new USB bus registered, assigned bus number 3
[    1.302047] usb usb3: We don&#039;t know the algorithms for LPM for this host, disabling LPM.
[    1.310569] hub 3-0:1.0: USB hub found
[    1.314386] hub 3-0:1.0: 2 ports detected
[    1.318797] usbcore: registered new interface driver usb-storage
[    1.324958] i8042: PNP: No PS/2 controller found. Probing ports directly.
[    1.486581] ata1: SATA link down (SStatus 0 SControl 300)
[    1.492064] ata2: SATA link down (SStatus 0 SControl 300)
[    1.946639] tsc: Refined TSC clocksource calibration: 998.114 MHz
[    1.952757] clocksource: tsc: mask: 0xffffffffffffffff max_cycles: 0x1cc642e9cf1, max_idle_ns: 881590508309 ns
[    2.416766] i8042: No controller found
[    2.420676] rtc_cmos 00:01: RTC can wake from S4
[    2.425485] rtc_cmos 00:01: rtc core: registered rtc_cmos as rtc0
[    2.431633] rtc_cmos 00:01: alarms up to one day, 114 bytes nvram, hpet irqs
[    2.438822] hidraw: raw HID events driver (C) Jiri Kosina
[    2.444961] NET: Registered protocol family 10
[    2.450470] NET: Registered protocol family 17
[    2.454950] bridge: automatic filtering via arp/ip/ip6tables has been deprecated. Update your scripts to load br_netfilter if you need this.
[    2.467640] Bridge firewalling registered
[    2.471669] 8021q: 802.1Q VLAN Support v1.8
[    2.476066] NET: Registered protocol family 40
[    2.482424] rtc_cmos 00:01: setting system clock to 2016-03-07 01:08:44 UTC (1457312924)
[    2.491004] Waiting for root device PARTUUID=85f77335-02...
[    2.666609] usb 1-1: new high-speed USB device number 2 using ehci-pci
[    2.817417] hub 1-1:1.0: USB hub found
[    2.821578] hub 1-1:1.0: 4 ports detected
[    2.956667] clocksource: Switched to clocksource tsc</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p317814">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">bolvan</div>
					<div class="post-datetime">
						2 Apr 2016, 14:41					</div>
				</div>
				<div class="post-content content">
					<p>Try another linux to see if it works</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p317836">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">dibdot</div>
					<div class="post-datetime">
						2 Apr 2016, 17:51					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dibdot wrote:</cite><blockquote><p>Hi,</p><p>this week I&#039;ve received a brand new APU2 (2c4) board. I&#039;ve tested the latest snapshot trunk, CC 15.01 image and my own buildroot ... with all of them I can&#039;t boot (see snapshot bootlog below), every time the boot process stops at &quot;clocksource: Switched to clocksource tsc&quot;.&nbsp; Anyone else using such device or any ideas to solve this problem?</p></blockquote></div><p>Issue solved - seems to be a limitation of the current SDCard bios boot code. Booting via USB stick &amp; mSATA disk works fine. I&#039;ll file a ticket at pcengines support.</p>											<p class="post-edited">(Last edited by <strong>dibdot</strong> on 2 Apr 2016, 17:59)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p317863">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">RangerZ</div>
					<div class="post-datetime">
						2 Apr 2016, 22:22					</div>
				</div>
				<div class="post-content content">
					<p>Check to see which BIOS you have running.&nbsp; There was a recent fix for this.<br /><a href="http://pcengines.ch/apu2b4.htm">http://pcengines.ch/apu2b4.htm</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p317866">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">dibdot</div>
					<div class="post-datetime">
						2 Apr 2016, 22:32					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>RangerZ wrote:</cite><blockquote><p>Check to see which BIOS you have running.&nbsp; There was a recent fix for this.<br /><a href="http://pcengines.ch/apu2b4.htm">http://pcengines.ch/apu2b4.htm</a></p></blockquote></div><p>Thanks, but even with the latest bios release (160311) SD card boot is not working properly ...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p317869">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">RangerZ</div>
					<div class="post-datetime">
						2 Apr 2016, 22:41					</div>
				</div>
				<div class="post-content content">
					<p>SD boot was a problem early on and apparently not solved.&nbsp; Yes, post a ticket for them.&nbsp; </p><p>FWIW, you may not see it in writing, but they have suggested to me NOT to use SD cards in either this or the older APU due to wear issues.&nbsp; I think the small m-sata is cheap enough if you can afford the board.</p><p>Some other have been curious about the LEDs in both APUs (other posts).&nbsp; You may want to check into this too.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p317872">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">dibdot</div>
					<div class="post-datetime">
						2 Apr 2016, 22:45					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>RangerZ wrote:</cite><blockquote><p>Some other have been curious about the LEDs in both APUs (other posts).&nbsp; You may want to check into this too.</p></blockquote></div><p>I&#039;ve already integrated the led driver for apu2 in my openwrt buildroot today ... but it&#039;s not ready for prime time ... <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>