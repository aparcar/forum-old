<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> How to install mpd in NeufBox</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 23 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p155487">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">PAMPA</div>
					<div class="post-datetime">
						26 Jan 2012, 22:51					</div>
				</div>
				<div class="post-content content">
					<p>Hello everybody <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> I would like to install mpd in my router NB4 to listen some mp3 and webradio <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>First, i flashed with success my router with Openwrt (Backfire (10.03.1, r29592))<br />Second, i installed mpd and connected a USB sound.</p><p>But when i write mpd in openwrite terminal, i obtain:</p><div class="quotebox"><blockquote><p>root@OpenWrt:~# mpd<br />Failed to load database: Database corrupted<br />database: db file &quot;/root/.mpd/database&quot; is not a regular file</p></blockquote></div><p>I think i maked some mistakes because it doesn&#039;t work ! </p><p>When i write <strong>mpd --create_db</strong> , i obtain:<br /></p><div class="quotebox"><blockquote><p>root@OpenWrt:/# mpd --create_db</p><p>** (mpd:1097): CRITICAL **: option parsing failed: Unknown option --create_db</p></blockquote></div><p>Here, we can see my /etc/mpd.conf&nbsp; :</p><div class="codebox"><pre><code># An example configuration file for MPD
# See the mpd.conf man page for a more detailed description of each parameter.


# Files and directories #######################################################
#
# This setting controls the top directory which MPD will search to discover the
# available audio files and add them to the daemon&#039;s online database. This 
# setting defaults to the XDG directory, otherwise the music directory will be
# be disabled and audio files will only be accepted over ipc socket (using
# file:// protocol) or streaming files over an accepted protocol.
#
music_directory        &quot;/mnt&quot;
#
# This setting sets the MPD internal playlist directory. The purpose of this
# directory is storage for playlists created by MPD. The server will use 
# playlist files not created by the server but only if they are in the MPD
# format. This setting defaults to playlist saving being disabled.
#
playlist_directory        &quot;~/.mpd/playlists&quot;
#
# This setting sets the location of the MPD database. This file is used to
# load the database at server start up and store the database while the 
# server is not up. This setting defaults to disabled which will allow
# MPD to accept files over ipc socket (using file:// protocol) or streaming
# files over an accepted protocol.
#
db_file            &quot;~/.mpd/database&quot;
# 
# These settings are the locations for the daemon log files for the daemon.
# These logs are great for troubleshooting, depending on your log_level
# settings.
#
# The special value &quot;syslog&quot; makes MPD use the local syslog daemon. This
# setting defaults to logging to syslog, otherwise logging is disabled.
#
#log_file            &quot;~/.mpd/log&quot;
#
# This setting sets the location of the file which stores the process ID
# for use of mpd --kill and some init scripts. This setting is disabled by
# default and the pid file will not be stored.
#
pid_file            &quot;~/.mpd/pid&quot;
#
# This setting sets the location of the file which contains information about
# most variables to get MPD back into the same general shape it was in before
# it was brought down. This setting is disabled by default and the server 
# state will be reset on server start up.
#
state_file            &quot;~/.mpd/state&quot;
#
# The location of the sticker database.  This is a database which
# manages dynamic information attached to songs.
#
sticker_file            &quot;~/.mpd/sticker.sql&quot;
#
###############################################################################


# General music daemon options ################################################
#
# This setting specifies the user that MPD will run as. MPD should never run as
# root and you may use this setting to make MPD change its user ID after
# initialization. This setting is disabled by default and MPD is run as the
# current user.
#
user                &quot;root&quot;
#
# This setting specifies the group that MPD will run as. If not specified
# primary group of user specified with &quot;user&quot; setting will be used (if set).
# This is useful if MPD needs to be a member of group such as &quot;audio&quot; to
# have permission to use sound card.
#
#group                &quot;nogroup&quot;
#
# This setting sets the address for the daemon to listen on. Careful attention
# should be paid if this is assigned to anything other then the default, any.
# This setting can deny access to control of the daemon.
#
# For network
#bind_to_address        &quot;any&quot;
#
# And for Unix Socket
#bind_to_address        &quot;~/.mpd/socket&quot;
#
# This setting is the TCP port that is desired for the daemon to get assigned
# to.
#
#port                &quot;6600&quot;
#
# This setting controls the type of information which is logged. Available 
# setting arguments are &quot;default&quot;, &quot;secure&quot; or &quot;verbose&quot;. The &quot;verbose&quot; setting
# argument is recommended for troubleshooting, though can quickly stretch
# available resources on limited hardware storage.
#
#log_level            &quot;default&quot;
#
# If you have a problem with your MP3s ending abruptly it is recommended that 
# you set this argument to &quot;no&quot; to attempt to fix the problem. If this solves
# the problem, it is highly recommended to fix the MP3 files with vbrfix
# (available from &lt;http://www.willwap.co.uk/Programs/vbrfix.php&gt;), at which
# point gapless MP3 playback can be enabled.
#
#gapless_mp3_playback            &quot;yes&quot;
#
# This setting enables MPD to create playlists in a format usable by other
# music players.
#
#save_absolute_paths_in_playlists    &quot;no&quot;
#
# This setting defines a list of tag types that will be extracted during the 
# audio file discovery process. Optionally, &#039;comment&#039; can be added to this
# list.
#
#metadata_to_use    &quot;artist,album,title,track,name,genre,date,composer,performer,disc&quot;
#
# This setting enables automatic update of MPD&#039;s database when files in 
# music_directory are changed.
#
#auto_update    &quot;yes&quot;
#
# Limit the depth of the directories being watched, 0 means only watch
# the music directory itself.  There is no limit by default.
#
#auto_update_depth &quot;3&quot;
#
###############################################################################


# Symbolic link behavior ######################################################
#
# If this setting is set to &quot;yes&quot;, MPD will discover audio files by following 
# symbolic links outside of the configured music_directory.
#
#follow_outside_symlinks    &quot;yes&quot;
#
# If this setting is set to &quot;yes&quot;, MPD will discover audio files by following
# symbolic links inside of the configured music_directory.
#
#follow_inside_symlinks        &quot;yes&quot;
#
###############################################################################


# Zeroconf / Avahi Service Discovery ##########################################
#
# If this setting is set to &quot;yes&quot;, service information will be published with
# Zeroconf / Avahi.
#
#zeroconf_enabled        &quot;yes&quot;
#
# The argument to this setting will be the Zeroconf / Avahi unique name for
# this MPD server on the network.
#
#zeroconf_name            &quot;Music Player&quot;
#
###############################################################################


# Permissions #################################################################
#
# If this setting is set, MPD will require password authorization. The password
# can setting can be specified multiple times for different password profiles.
#
#password                        &quot;password@read,add,control,admin&quot;
#
# This setting specifies the permissions a user has who has not yet logged in. 
#
#default_permissions             &quot;read,add,control,admin&quot;
#
###############################################################################


# Input #######################################################################
#

input {
        plugin &quot;curl&quot;
#       proxy &quot;proxy.isp.com:8080&quot;
#       proxy_user &quot;user&quot;
#       proxy_password &quot;password&quot;
}

#
###############################################################################

# Audio Output ################################################################
#
# MPD supports various audio output types, as well as playing through multiple 
# audio outputs at the same time, through multiple audio_output settings 
# blocks. Setting this block is optional, though the server will only attempt
# autodetection for one sound card.
#
# See &lt;http://mpd.wikia.com/wiki/Configuration#Audio_Outputs&gt; for examples of 
# other audio outputs.
#
# An example of an ALSA output:
#
#audio_output {
#    type        &quot;alsa&quot;
#    name        &quot;My ALSA Device&quot;
##    device        &quot;hw:0,0&quot;    # optional
##    format        &quot;44100:16:2&quot;    # optional
##    mixer_type      &quot;hardware&quot;    # optional
##    mixer_device    &quot;default&quot;    # optional
##    mixer_control    &quot;PCM&quot;        # optional
##    mixer_index    &quot;0&quot;        # optional
#}
#
# An example of an OSS output:
#
audio_output {
    type        &quot;oss&quot;
    name        &quot;My OSS Device&quot;
    device        &quot;/dev/sound/dsp&quot;
    format        &quot;44100:16:2&quot;    # optional
    mixer_type      &quot;hardware&quot;    # optional
    mixer_device    &quot;/dev/mixer&quot;    # optional
    mixer_control    &quot;PCM&quot;        # optional
}
#
# An example of a shout output (for streaming to Icecast):
#
#audio_output {
#    type        &quot;shout&quot;
#    encoding    &quot;ogg&quot;            # optional
#    name        &quot;My Shout Stream&quot;
#    host        &quot;localhost&quot;
#    port        &quot;8000&quot;
#    mount        &quot;/mpd.ogg&quot;
#    password    &quot;hackme&quot;
#    quality        &quot;5.0&quot;
#    bitrate        &quot;128&quot;
#    format        &quot;44100:16:1&quot;
##    protocol    &quot;icecast2&quot;        # optional
##    user        &quot;source&quot;        # optional
##    description    &quot;My Stream Description&quot;    # optional
##    genre        &quot;jazz&quot;            # optional
##    public        &quot;no&quot;            # optional
##    timeout        &quot;2&quot;            # optional
##    mixer_type      &quot;software&quot;        # optional
#}
#
# An example of a recorder output:
#
#audio_output {
#    type        &quot;recorder&quot;
#    name        &quot;My recorder&quot;
#    encoder        &quot;vorbis&quot;        # optional, vorbis or lame
#    path        &quot;/var/lib/mpd/recorder/mpd.ogg&quot;
##    quality        &quot;5.0&quot;            # do not define if bitrate is defined
#    bitrate        &quot;128&quot;            # do not define if quality is defined
#    format        &quot;44100:16:1&quot;
#}
#
# An example of a httpd output (built-in HTTP streaming server):
#
#audio_output {
#    type        &quot;httpd&quot;
#    name        &quot;My HTTP Stream&quot;
#    encoder        &quot;vorbis&quot;        # optional, vorbis or lame
#    port        &quot;8000&quot;
#    bind_to_address    &quot;0.0.0.0&quot;        # optional, IPv4 or IPv6
##    quality        &quot;5.0&quot;            # do not define if bitrate is defined
#    bitrate        &quot;128&quot;            # do not define if quality is defined
#    format        &quot;44100:16:1&quot;
#    max_clients    &quot;0&quot;            # optional 0=no limit
#}
#
# An example of a pulseaudio output (streaming to a remote pulseaudio server)
#
#audio_output {
#    type        &quot;pulse&quot;
#    name        &quot;My Pulse Output&quot;
##    server        &quot;remote_server&quot;        # optional
##    sink        &quot;remote_server_sink&quot;    # optional
#}
#
## Example &quot;pipe&quot; output:
#
#audio_output {
#    type        &quot;pipe&quot;
#    name        &quot;my pipe&quot;
#    command        &quot;aplay -f cd 2&gt;/dev/null&quot;
## Or if you&#039;re want to use AudioCompress
#    command        &quot;AudioCompress -m | aplay -f cd 2&gt;/dev/null&quot;
## Or to send raw PCM stream through PCM:
#    command        &quot;nc example.org 8765&quot;
#    format        &quot;44100:16:2&quot;
#}
#
## An example of a null output (for no audio output):
#
#audio_output {
#    type        &quot;null&quot;
#    name        &quot;My Null Output&quot;
#    mixer_type      &quot;none&quot;            # optional
#}
#
# This setting will change all decoded audio to be converted to the specified
# format before being passed to the audio outputs. By default, this setting is
# disabled.
#
#audio_output_format        &quot;44100:16:2&quot;
#
# If MPD has been compiled with libsamplerate support, this setting specifies 
# the sample rate converter to use.  Possible values can be found in the 
# mpd.conf man page or the libsamplerate documentation. By default, this is
# setting is disabled.
#
#samplerate_converter        &quot;Fastest Sinc Interpolator&quot;
#
###############################################################################


# Normalization automatic volume adjustments ##################################
#
# This setting specifies the type of ReplayGain to use. This setting can have
# the argument &quot;off&quot;, &quot;album&quot; or &quot;track&quot;. See &lt;http://www.replaygain.org&gt;
# for more details. This setting is off by default.
#
#replaygain            &quot;album&quot;
#
# This setting sets the pre-amp used for files that have ReplayGain tags. By
# default this setting is disabled.
#
#replaygain_preamp        &quot;0&quot;
#
# This setting enables on-the-fly normalization volume adjustment. This will
# result in the volume of all playing audio to be adjusted so the output has 
# equal &quot;loudness&quot;. This setting is disabled by default.
#
#volume_normalization        &quot;no&quot;
#
###############################################################################


# MPD Internal Buffering ######################################################
#
# This setting adjusts the size of internal decoded audio buffering. Changing
# this may have undesired effects. Don&#039;t change this if you don&#039;t know what you
# are doing.
#
#audio_buffer_size        &quot;2048&quot;
#
# This setting controls the percentage of the buffer which is filled before 
# beginning to play. Increasing this reduces the chance of audio file skipping, 
# at the cost of increased time prior to audio playback.
#
#buffer_before_play        &quot;10%&quot;
#
###############################################################################


# Resource Limitations ########################################################
#
# These settings are various limitations to prevent MPD from using too many
# resources. Generally, these settings should be minimized to prevent security
# risks, depending on the operating resources.
#
#connection_timeout        &quot;60&quot;
#max_connections        &quot;10&quot;
#max_playlist_length        &quot;16384&quot;
#max_command_list_size        &quot;2048&quot;
#max_output_buffer_size        &quot;8192&quot;
#
###############################################################################


# Character Encoding ##########################################################
#
# If file or directory names do not display correctly for your locale then you 
# may need to modify this setting.
#
#filesystem_charset        &quot;UTF-8&quot;
#
# This setting controls the encoding that ID3v1 tags should be converted from.
#
#id3v1_encoding            &quot;ISO-8859-1&quot;
#
###############################################################################


# SIDPlay decoder #############################################################
#
# songlength_database:
#  Location of your songlengths file, as distributed with the HVSC.
#  The sidplay plugin checks this for matching MD5 fingerprints.
#  See http://www.c64.org/HVSC/DOCUMENTS/Songlengths.faq
#
# default_songlength:
#  This is the default playing time in seconds for songs not in the
#  songlength database, or in case you&#039;re not using a database.
#  A value of 0 means play indefinitely.
#
# filter:
#  Turns the SID filter emulation on or off.
#
#decoder {
#    plugin            &quot;sidplay&quot;
#    songlength_database    &quot;/media/C64Music/DOCUMENTS/Songlengths.txt&quot;
#    default_songlength    &quot;120&quot;
#    filter &quot;true&quot;
#}
#
###############################################################################</code></pre></div><p>Some information about my OpenWrite (df and ls /)</p><div class="codebox"><pre><code>root@OpenWrt:~# df
Filesystem           1K-blocks      Used Available Use% Mounted on
/dev/root                 1792      1792         0 100% /rom
tmpfs                    14836        48     14788   0% /tmp
tmpfs                      512         0       512   0% /dev
/dev/mtdblock3            5376      4856       520  90% /overlay
mini_fo:/overlay          1792      1792         0 100% /
/dev/sda1               980308    241688    688824  26% /mnt


root@OpenWrt:~# ls /
bin      etc      mnt      proc     root     sys      usr      www
dev      lib      overlay  rom      sbin     tmp      var</code></pre></div><p>Maybe if you have some idea or something to help me to configure mpd <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Thx a lot</p>											<p class="post-edited">(Last edited by <strong>PAMPA</strong> on 26 Jan 2012, 22:56)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>