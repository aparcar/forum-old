<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> openvpn problem on a wrt54gl with whiterussian</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 3 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p51842">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Virus_2</div>
					<div class="post-datetime">
						5 Jul 2007, 03:53					</div>
				</div>
				<div class="post-content content">
					<p>i have an openvpn server and 6 wrt54gl with as clients... <br />in unexpected periods (maybe after dsl connectivity errors some of the wrt54gl can&#039;t connect to server normaly)</p><p>in the status log the client appears as undef ..</p><p>UNDEF,85.73.12.216:2060,1222,24438,Thu Jul&nbsp; 5 11:49:18 2007</p><p>any ideas ??!?!</p><p>here is my client config<br />------------------------------------------------------------------------------------------------------------------------------------<br />client<br />dev tun<br />proto udp<br />remote toxryso.static.otenet.gr 1194<br />nobind<br />persist-key<br />persist-tun<br />mute-replay-warnings<br />ca /etc/ca.crt<br />cert /etc/client.crt<br />key /etc/client.key<br />comp-lzo<br />verb 3</p><p>my server config<br />------------------------------------------------------------------------------------------------------------------------------------<br />port 1194<br />proto udp<br />dev tun0<br />ca /usr/local/keys/ca.crt<br />cert /usr/local/keys/server.crt<br />key /usr/local/keys/server.key <br />dh /usr/local/keys/dh1024.pem<br />server 10.8.0.0 255.255.255.0<br />ifconfig-pool-persist /usr/local/keys/ipp.txt<br />push &quot;route 192.168.3.0 255.255.255.0&quot;<br />push &quot;route 10.8.1.0 255.255.255.0&quot;<br />push &quot;route 10.8.2.0 255.255.255.0&quot;<br />push &quot;route 10.8.3.0 255.255.255.0&quot;<br />push &quot;route 10.8.4.0 255.255.255.0&quot;<br />push &quot;route 10.8.5.0 255.255.255.0&quot;<br />push &quot;route 10.8.6.0 255.255.255.0&quot;<br />push &quot;route 10.8.7.0 255.255.255.0&quot;<br />push &quot;route 10.8.8.0 255.255.255.0&quot;<br />push &quot;route 10.8.9.0 255.255.255.0&quot;<br />push &quot;route 10.8.10.0 255.255.255.0&quot;<br />client-to-client<br />client-config-dir /etc/openvpn<br />route 10.8.1.0 255.255.255.0<br />route 10.8.2.0 255.255.255.0<br />route 10.8.3.0 255.255.255.0<br />route 10.8.4.0 255.255.255.0<br />route 10.8.5.0 255.255.255.0<br />route 10.8.6.0 255.255.255.0<br />route 10.8.7.0 255.255.255.0<br />route 10.8.8.0 255.255.255.0<br />route 10.8.9.0 255.255.255.0<br />route 10.8.10.0 255.255.255.0<br />keepalive 10 120<br />comp-lzo<br />persist-key<br />persist-tun<br />status /usr/local/keys/openvpn-status.log<br />log&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/usr/local/keys/log-openvpn.log<br />log-append&nbsp; /usr/local/keys/log-openvpn.log<br />verb 4 </p><br /><p>and my server&#039;s log file ......<br />--------------------------------------------------------------------------------------------------</p><p>Thu Jul&nbsp; 5 11:39:08 2007 us=147213 MULTI: multi_create_instance called<br />Thu Jul&nbsp; 5 11:39:08 2007 us=147469 85.73.12.216:2060 Re-using SSL/TLS context<br />Thu Jul&nbsp; 5 11:39:08 2007 us=147497 85.73.12.216:2060 LZO compression initialized<br />Thu Jul&nbsp; 5 11:39:08 2007 us=147615 85.73.12.216:2060 Control Channel MTU parms [ L:1542 D:138 EF:38 EB:0 ET:0 EL:0 ]<br />Thu Jul&nbsp; 5 11:39:08 2007 us=147642 85.73.12.216:2060 Data Channel MTU parms [ L:1542 D:1450 EF:42 EB:135 ET:0 EL:0 AF:3/1 ]<br />Thu Jul&nbsp; 5 11:39:08 2007 us=147699 85.73.12.216:2060 Local Options String: &#039;V4,dev-type tun,link-mtu 1542,tun-mtu 1500,proto UDPv4,comp-lzo,cipher BF-CBC,aut<br />h SHA1,keysize 128,key-method 2,tls-server&#039;<br />Thu Jul&nbsp; 5 11:39:08 2007 us=147717 85.73.12.216:2060 Expected Remote Options String: &#039;V4,dev-type tun,link-mtu 1542,tun-mtu 1500,proto UDPv4,comp-lzo,cipher <br />BF-CBC,auth SHA1,keysize 128,key-method 2,tls-client&#039;<br />Thu Jul&nbsp; 5 11:39:08 2007 us=147749 85.73.12.216:2060 Local Options hash (VER=V4): &#039;530fdded&#039;<br />Thu Jul&nbsp; 5 11:39:08 2007 us=147778 85.73.12.216:2060 Expected Remote Options hash (VER=V4): &#039;41690919&#039;<br />Thu Jul&nbsp; 5 11:39:08 2007 us=147818 85.73.12.216:2060 TLS: Initial packet from 85.73.12.216:2060, sid=988c5008 203a95a1<br />Thu Jul&nbsp; 5 11:39:10 2007 us=484091 85.73.12.216:2060 TLS: new session incoming connection from 85.73.12.216:2060<br />Thu Jul&nbsp; 5 11:39:12 2007 us=847799 85.73.12.216:2060 TLS: new session incoming connection from 85.73.12.216:2060<br />Thu Jul&nbsp; 5 11:40:09 2007 us=50022 85.73.12.216:2060 TLS Error: TLS key negotiation failed to occur within 60 seconds (check your network connectivity)<br />Thu Jul&nbsp; 5 11:40:09 2007 us=50060 85.73.12.216:2060 TLS Error: TLS handshake failed<br />Thu Jul&nbsp; 5 11:40:09 2007 us=50292 85.73.12.216:2060 SIGUSR1[soft,tls-error] received, client-instance restarting<br />Thu Jul&nbsp; 5 11:40:09 2007 us=131657 MULTI: multi_create_instance called<br />Thu Jul&nbsp; 5 11:40:09 2007 us=131911 85.73.12.216:2060 Re-using SSL/TLS context<br />Thu Jul&nbsp; 5 11:40:09 2007 us=131939 85.73.12.216:2060 LZO compression initialized<br />Thu Jul&nbsp; 5 11:40:09 2007 us=132056 85.73.12.216:2060 Control Channel MTU parms [ L:1542 D:138 EF:38 EB:0 ET:0 EL:0 ]</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p51844">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Cyberian75</div>
					<div class="post-datetime">
						5 Jul 2007, 06:10					</div>
				</div>
				<div class="post-content content">
					<p>There&#039;s no dh key on the client.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p51845">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">placebo</div>
					<div class="post-datetime">
						5 Jul 2007, 06:44					</div>
				</div>
				<div class="post-content content">
					<p>No ideas, but I have a question. Why do the logs show the connection is being made on port 2060 while the configuration files specify port 1194?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p51849">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Virus_2</div>
					<div class="post-datetime">
						5 Jul 2007, 10:00					</div>
				</div>
				<div class="post-content content">
					<p>Cyberian75 : in the openvpn how to there is no mentioning about any dh key on the client....</p><p>placebo .. there are many clients connected on the system .. each of them must use a different port i suppose ... ?</p><p>the only way to resolv the problem is to power off the client and then plug the power again ... :s</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p51853">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">placebo</div>
					<div class="post-datetime">
						5 Jul 2007, 10:53					</div>
				</div>
				<div class="post-content content">
					<p>Try checking the clock on the client when it can&#039;t connect. If it&#039;s not set correctly, the SSL certificate won&#039;t be considered valid, and the handshake will fail. If that&#039;s not it, try posting the log from the client side to see if we can find any clues there.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p51860">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Virus_2</div>
					<div class="post-datetime">
						5 Jul 2007, 11:33					</div>
				</div>
				<div class="post-content content">
					<p>time was ok the last time i check it ... i will come up with the log file from the client soon </p><p>thnks for the help!</p>											<p class="post-edited">(Last edited by <strong>Virus_2</strong> on 5 Jul 2007, 11:44)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>