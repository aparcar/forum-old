<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> usb-modeswitch</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 23 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p373703">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">balanga</div>
					<div class="post-datetime">
						13 Mar 2018, 12:45					</div>
				</div>
				<div class="post-content content">
					<p>I have installed usb-modeswitch but am unable to install usb-modeswitch-data.</p><p>How do I find out why?</p><p>The error msg just says &#039;Cannot install&#039;.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p373707">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">600cc</div>
					<div class="post-datetime">
						13 Mar 2018, 13:21					</div>
				</div>
				<div class="post-content content">
					<div class="codebox"><pre><code>opkg update
opkg list | grep usb-modeswitch</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p373708">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">600cc</div>
					<div class="post-datetime">
						13 Mar 2018, 13:23					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>https://openwrt.org/docs/guide-user/network/wan/wwan/3gdongle wrote:</cite><blockquote><p><strong>Note:</strong> as of r36812, usb-modeswitch package had been under major overhaul from ordinary draisberghof usb_modeswitch found in many linux distributions. <strong>usb-modeswitch-data is included in the package</strong>, with the new json format.</p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p373715">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">balanga</div>
					<div class="post-datetime">
						13 Mar 2018, 17:09					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>600cc wrote:</cite><blockquote><div class="codebox"><pre><code>opkg update
opkg list | grep usb-modeswitch</code></pre></div></blockquote></div><p>Just noticed....on Arch Linux it&#039;s called usb_modeswitch .... notice the subtle difference?</p><p>On my OpenWrt box it says</p><p>Package usb-modeswitch (2017-05-24-453da8e5-1) installed in root is up to date.</p><p>So am not sure about what usb-modeswitch-data is supposed to be...</p><p>On Arch Linux, all the Vid/Pids are in /usr/share/usb_modeswitch. I don&#039;t see an equivalent directory on OpenWrt.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p373717">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">600cc</div>
					<div class="post-datetime">
						13 Mar 2018, 17:36					</div>
				</div>
				<div class="post-content content">
					<p><a href="https://forum.openwrt.org/viewtopic.php?pid=373708#p373708">https://forum.openwrt.org/viewtopic.php … 08#p373708</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p373724">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">tmo26</div>
					<div class="post-datetime">
						13 Mar 2018, 18:23					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>balanga wrote:</cite><blockquote><p>So am not sure about what usb-modeswitch-data is supposed to be...</p></blockquote></div><p>This package doesn&#039;t exist any more (only usb-modeswitch available): <a href="https://openwrt.org/packages/table/start?dataflt%5BName_pkg-dependencies*~%5D=modeswitch">https://openwrt.org/packages/table/star … modeswitch</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p373732">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">balanga</div>
					<div class="post-datetime">
						13 Mar 2018, 19:58					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>600cc wrote:</cite><blockquote><div class="quotebox"><cite>https://openwrt.org/docs/guide-user/network/wan/wwan/3gdongle wrote:</cite><blockquote><p><strong>Note:</strong> as of r36812, usb-modeswitch package had been under major overhaul from ordinary draisberghof usb_modeswitch found in many linux distributions. <strong>usb-modeswitch-data is included in the package</strong>, with the new json format.</p></blockquote></div></blockquote></div><br /><p>I&#039;ve never come across the json format and don&#039;t really know what it is. </p><p>I did notice that /etc/usb-mode.json does contain various pairs of strings which must be Vid/Pid combinations, but I don&#039;t see 12d1:14dc...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p373733">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">balanga</div>
					<div class="post-datetime">
						13 Mar 2018, 20:06					</div>
				</div>
				<div class="post-content content">
					<p>Just re-read post <a href="https://forum.openwrt.org/viewtopic.php?pid=373053#p373053">https://forum.openwrt.org/viewtopic.php … 53#p373053</a> which shows that modeswitching has already taken place. the original Vid/Pid of 12d1:1f01 being present in /etc/usb-mode.json.</p><p>I guess the way modeswitching takes place is beginning to sink in finally, but is this action logged by the system anywhere?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p373735">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">600cc</div>
					<div class="post-datetime">
						13 Mar 2018, 20:27					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>balanga wrote:</cite><blockquote><p>Just re-read post <a href="https://forum.openwrt.org/viewtopic.php?pid=373053#p373053">https://forum.openwrt.org/viewtopic.php … 53#p373053</a> which shows that modeswitching has already taken place. the original Vid/Pid of 12d1:1f01 being present in /etc/usb-mode.json.</p><p>I guess the way modeswitching takes place is beginning to sink in finally, but is this action logged by the system anywhere?</p></blockquote></div><p>Yes. dmesg.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p373736">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">balanga</div>
					<div class="post-datetime">
						13 Mar 2018, 20:50					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>600cc wrote:</cite><blockquote><div class="quotebox"><cite>balanga wrote:</cite><blockquote><p>Just re-read post <a href="https://forum.openwrt.org/viewtopic.php?pid=373053#p373053">https://forum.openwrt.org/viewtopic.php … 53#p373053</a> which shows that modeswitching has already taken place. the original Vid/Pid of 12d1:1f01 being present in /etc/usb-mode.json.</p><p>I guess the way modeswitching takes place is beginning to sink in finally, but is this action logged by the system anywhere?</p></blockquote></div><p>Yes. dmesg.</p></blockquote></div><p>After re-inserting the modem dmesg shows:</p><p>USB Mass Storage device detected<br />Direct-Access HUAWEI&nbsp; TF&nbsp; CARD Storage&nbsp; &nbsp;2.31&nbsp; PQ:&nbsp; 0&nbsp; ANSI:&nbsp; 2<br />Attached SCSI removable disk</p><p>... nothing about usb-modeswitch or modem/network...</p>											<p class="post-edited">(Last edited by <strong>balanga</strong> on 13 Mar 2018, 20:51)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p373737">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">600cc</div>
					<div class="post-datetime">
						13 Mar 2018, 20:54					</div>
				</div>
				<div class="post-content content">
					<p>What&#039;s in /dev that wasn&#039;t there before?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p373738">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">balanga</div>
					<div class="post-datetime">
						13 Mar 2018, 21:26					</div>
				</div>
				<div class="post-content content">
					<p>After following <a href="https://openwrt.org/docs/guide-user/network/wan/wwan/ethernetoverusb_rndis">https://openwrt.org/docs/guide-user/net … rusb_rndis</a> I&#039;ve installed <br />kmod-usb-net-rndis and now dmesg includes</p><p>eth1: unregister &#039;cdc_ether&#039; usb-ehci-platform-1.1, CDC Ethernet Device</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p373739">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">balanga</div>
					<div class="post-datetime">
						13 Mar 2018, 21:34					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>600cc wrote:</cite><blockquote><p>What&#039;s in /dev that wasn&#039;t there before?</p></blockquote></div><p>Can&#039;t see anything, but didn&#039;t have a directory listing to compare....</p><p>What sort of thing should I be looking for?</p><p>I see -ptmx and +sda have recent timestamps. Never noticed them before.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p373741">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">600cc</div>
					<div class="post-datetime">
						13 Mar 2018, 22:44					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>balanga wrote:</cite><blockquote><p>Can&#039;t see anything, but didn&#039;t have a directory listing to compare....</p></blockquote></div><p>So take one. Grab the contents of /dev, then plug the device in, then grab the contents of /dev again.</p><br /><div class="quotebox"><cite>balanga wrote:</cite><blockquote><p>What sort of thing should I be looking for?</p></blockquote></div><p>Something that appears after you plug the device in, but isn&#039;t there when the device isn&#039;t plugged in.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p373799">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">balanga</div>
					<div class="post-datetime">
						15 Mar 2018, 11:20					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>600cc wrote:</cite><blockquote><div class="quotebox"><cite>balanga wrote:</cite><blockquote><p>Can&#039;t see anything, but didn&#039;t have a directory listing to compare....</p></blockquote></div><p>So take one. Grab the contents of /dev, then plug the device in, then grab the contents of /dev again.</p><br /><div class="quotebox"><cite>balanga wrote:</cite><blockquote><p>What sort of thing should I be looking for?</p></blockquote></div><p>Something that appears after you plug the device in, but isn&#039;t there when the device isn&#039;t plugged in.</p><p>The only thing I can spot is the creation of this entry under /dev - no idea what it is</p></blockquote></div><div class="codebox"><pre><code>brw-------    1 root     root        8,   0 Mar 15 09:14 sda</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p373824">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">600cc</div>
					<div class="post-datetime">
						16 Mar 2018, 00:27					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>balanga wrote:</cite><blockquote><p>The only thing I can spot is the creation of this entry under /dev - no idea what it is</p><div class="codebox"><pre><code>brw-------    1 root     root        8,   0 Mar 15 09:14 sda</code></pre></div></blockquote></div><p><a href="https://en.wikipedia.org/wiki/Device_file#Naming_conventions">https://en.wikipedia.org/wiki/Device_fi … onventions</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p373851">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">balanga</div>
					<div class="post-datetime">
						16 Mar 2018, 11:30					</div>
				</div>
				<div class="post-content content">
					<p>When I look ar the directory listing for /dev now, it seems obvious that sda refers to a storage device, ie my Huawei E3372 which is seen as an attached SCSI removable disk, so it looks like usb_modeswitch has not done what is expected.</p><p>BTW is &#039;blkid&#039; or &#039;lsblk&#039; not available on OpenWrt?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p373855">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">600cc</div>
					<div class="post-datetime">
						16 Mar 2018, 12:31					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>balanga wrote:</cite><blockquote><p>BTW is &#039;blkid&#039; or &#039;lsblk&#039; not available on OpenWrt?</p></blockquote></div><br /><div class="codebox"><pre><code>opkg update
opkg list | grep blkid
opkg list | grep lsblk</code></pre></div>											<p class="post-edited">(Last edited by <strong>600cc</strong> on 16 Mar 2018, 14:50)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p373880">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">balanga</div>
					<div class="post-datetime">
						16 Mar 2018, 19:48					</div>
				</div>
				<div class="post-content content">
					<p>Ok so now I run</p><p>root@LEDE:~# lsblk<br />NAME&nbsp; &nbsp; &nbsp; MAJ:MIN RM&nbsp; SIZE RO TYPE MOUNTPOINT<br />mtdblock0&nbsp; 31:0&nbsp; &nbsp; 0&nbsp; 128K&nbsp; 1 disk <br />mtdblock1&nbsp; 31:1&nbsp; &nbsp; 0&nbsp; 1.2M&nbsp; 1 disk <br />mtdblock2&nbsp; 31:2&nbsp; &nbsp; 0&nbsp; 6.6M&nbsp; 1 disk /rom<br />mtdblock3&nbsp; 31:3&nbsp; &nbsp; 0&nbsp; 4.4M&nbsp; 0 disk /overlay<br />mtdblock4&nbsp; 31:4&nbsp; &nbsp; 0&nbsp; &nbsp;64K&nbsp; 1 disk <br />mtdblock5&nbsp; 31:5&nbsp; &nbsp; 0&nbsp; 7.8M&nbsp; 0 disk </p><br /><p>So where is sda?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p373883">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">600cc</div>
					<div class="post-datetime">
						16 Mar 2018, 20:18					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>balanga wrote:</cite><blockquote><p>Ok so now I run</p><p>root@LEDE:~# lsblk<br />NAME&nbsp; &nbsp; &nbsp; MAJ:MIN RM&nbsp; SIZE RO TYPE MOUNTPOINT<br />mtdblock0&nbsp; 31:0&nbsp; &nbsp; 0&nbsp; 128K&nbsp; 1 disk <br />mtdblock1&nbsp; 31:1&nbsp; &nbsp; 0&nbsp; 1.2M&nbsp; 1 disk <br />mtdblock2&nbsp; 31:2&nbsp; &nbsp; 0&nbsp; 6.6M&nbsp; 1 disk /rom<br />mtdblock3&nbsp; 31:3&nbsp; &nbsp; 0&nbsp; 4.4M&nbsp; 0 disk /overlay<br />mtdblock4&nbsp; 31:4&nbsp; &nbsp; 0&nbsp; &nbsp;64K&nbsp; 1 disk <br />mtdblock5&nbsp; 31:5&nbsp; &nbsp; 0&nbsp; 7.8M&nbsp; 0 disk </p><br /><p>So where is sda?</p></blockquote></div><br /><p>Is /dev/sda attached to a mount point?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p373950">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">balanga</div>
					<div class="post-datetime">
						18 Mar 2018, 09:34					</div>
				</div>
				<div class="post-content content">
					<p>It seems like something isn&#039;t set up correctly... When I plug in a different Modem several /dev/ttyUSB* devices appear... With the E3372 it shows /dev/sda.</p><p>Seems like I&#039;m missing a step... Should usb-modeswitch initiate creation of a /dev/ttyUSB* device?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p373965">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">mk24</div>
					<div class="post-datetime">
						18 Mar 2018, 15:02					</div>
				</div>
				<div class="post-content content">
					<p>Usb-modeswitch attempts to turn off the storage mode in the device and restart it fully in modem mode.&nbsp; This may be necessary before the modem drivers can detect and attach to the modem mode.</p><p>Usually there is a way to change the non-volatile configuration in the modem to turn off storage mode &quot;permanently&quot;.&nbsp; This is preferable.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p373971">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">600cc</div>
					<div class="post-datetime">
						18 Mar 2018, 15:39					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>balanga wrote:</cite><blockquote><p>Should usb-modeswitch initiate creation of a /dev/ttyUSB* device?</p></blockquote></div><p>Depends.</p><p>Is it an E3372s, which behaves as a serial device?</p><p>Is it an E3372h, which behaves as an Ethernet device?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>