<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Unboxing of my new TL-MR3420.How to compile a 8M fireware from 4M?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 20 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p122697">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">axishero</div>
					<div class="post-datetime">
						6 Dec 2010, 07:54					</div>
				</div>
				<div class="post-content content">
					<p>I just bought a MR3420 router and here are my unboxing pics.<br /><a href="http://www.right.com.cn/forum/thread-42835-1-1.html">http://www.right.com.cn/forum/thread-42835-1-1.html</a><br />I flashed it with a 4M trunk fireware and it works fine.But 4MB is really not enough for installing apps.So I decide to replace 4MB flash with a 8MB one.Then questions arise:<br />1?Can I use a original 4MB u-boot to flash the new 8M flash in order to get the router bootup,or I must compile a u-boot for 8MB and how to?<br />2?I know that 4MB firmware can be written directly into 8MB one?but in this case?it can only recognize half of 8MB.To get fully use of 8M space?I must modify the 4MB firmware to support 8MB space.I&#039;ve heard that just change the offset of art&nbsp; from 0x3f0000 to 0x7f0000 then the firmware should recognize all 8MB space.(source below)<br /><a href="https://dev.openwrt.org/browser/trunk/target/linux/ar71xx/files/arch/mips/ar71xx/mach-tl-mr3420.c">https://dev.openwrt.org/browser/trunk/t … l-mr3420.c</a><br />Is there any quick solution to do this tiny change and compile a suitable .bin for 8M flash?<br />I am waiting someone wise to enlight me!</p>											<p class="post-edited">(Last edited by <strong>axishero</strong> on 6 Dec 2010, 07:55)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p122698">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">th0m4s</div>
					<div class="post-datetime">
						6 Dec 2010, 08:40					</div>
				</div>
				<div class="post-content content">
					<p>Usb extroot isn&#039;t enought ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p122701">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">axishero</div>
					<div class="post-datetime">
						6 Dec 2010, 10:05					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>th0m4s wrote:</cite><blockquote><p>Usb extroot isn&#039;t enought ?</p></blockquote></div><p>After installing Luci and usb drivers,it left me no space to install ext-fs support,so usb external can&#039;t use.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p122703">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">th0m4s</div>
					<div class="post-datetime">
						6 Dec 2010, 11:16					</div>
				</div>
				<div class="post-content content">
					<p>So instal Luci on extroot...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p122708">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">axishero</div>
					<div class="post-datetime">
						6 Dec 2010, 12:01					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>th0m4s wrote:</cite><blockquote><p>So instal Luci on extroot...</p></blockquote></div><p>In this case I should first remove luci.But I don&#039;t know the commands line to install luci into extroot,pls give some hints.<br />I am dying to see usb transfer rate of MR3420.</p>											<p class="post-edited">(Last edited by <strong>axishero</strong> on 6 Dec 2010, 12:02)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p122715">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">axishero</div>
					<div class="post-datetime">
						6 Dec 2010, 14:32					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>th0m4s wrote:</cite><blockquote><p>So instal Luci on extroot...</p></blockquote></div><p>I notice that block-extroot must be included in the image and cannot be installed later on with opkg.It&#039;s a bit complicated.Is there any other way to install big apps(like luci) into external storage?<br /><a href="http://wiki.openwrt.org/doc/howto/extroot">http://wiki.openwrt.org/doc/howto/extroot</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p123017">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">rolandk</div>
					<div class="post-datetime">
						11 Dec 2010, 00:15					</div>
				</div>
				<div class="post-content content">
					<p>how can openwrt be installed on MR3420 ?<br />can we just update it via the origincal tp-link web interface ?</p><p>what about if i have a problem? how to attach a serial console ?</p><p>would the same firmware image work with MR3220?</p><p>questins over questions -&nbsp; but any hints are welcome!</p><p>roland</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p123041">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">rolandk</div>
					<div class="post-datetime">
						11 Dec 2010, 14:27					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>axishero wrote:</cite><blockquote><div class="quotebox"><cite>th0m4s wrote:</cite><blockquote><p>So instal Luci on extroot...</p></blockquote></div><p>I notice that block-extroot must be included in the image and cannot be installed later on with opkg.It&#039;s a bit complicated.Is there any other way to install big apps(like luci) into external storage?<br /><a href="http://wiki.openwrt.org/doc/howto/extroot">http://wiki.openwrt.org/doc/howto/extroot</a></p></blockquote></div><p>i think it should be possible. did you try symlinking or bind-mount ( mount -o bind)&nbsp; the dir(s) where luci installs to?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p123070">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">DerMicha</div>
					<div class="post-datetime">
						12 Dec 2010, 01:04					</div>
				</div>
				<div class="post-content content">
					<p>I use an 2Gb Usb Stick for Swap and Extroot on this Device.<br />Just formating a 96mb Swap Partion (1) and a ext3 Partion (2) for extroot.</p><p>Flash the router with the <a href="http://downloads.openwrt.org/snapshots/trunk/ar71xx/openwrt-ar71xx-generic-tl-mr3420-v1-squashfs-factory.bin">http://downloads.openwrt.org/snapshots/ … actory.bin</a> file via gui in original firmware.</p><p>opkg update<br />opkg install kmod-usb-core kmod-usb-uhci kmod-usb-storage&nbsp; kmod-usb2&nbsp; kmod-fs-ext3 e2fsprogs</p><p>reboot</p><p>put the formatet stick into the router then,</p><p>mount /dev/sda2 /mnt<br />mkdir /tmp/root<br />mount -o bind / /tmp/root<br />cp /tmp/root/* /mnt -a<br />umount /tmp/root<br />umount /mnt</p><p>reboot</p><p>make /etc/config/fstab with this:</p><p>&nbsp; &nbsp; config &#039;global&#039; &#039;automount&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;from_fstab&#039; &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;anon_mount&#039; &#039;1&#039;</p><p>&nbsp; &nbsp; config &#039;global&#039; &#039;autoswap&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;from_fstab&#039; &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;anon_swap&#039; &#039;0&#039;</p><p>&nbsp; &nbsp; config &#039;mount&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;target&#039; &#039;&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;fstype&#039; &#039;ext3&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;options&#039; &#039;rw,sync&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;enabled_fsck&#039; &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;device&#039; &#039;/dev/sda2&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;enabled&#039; &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;is_rootfs&#039; &#039;1&#039;</p><p>&nbsp; &nbsp; config &#039;swap&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;device&#039; &#039;/dev/sda1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;enabled&#039; &#039;1&#039;</p><p>now:<br />opkg update<br />opkg install block-extroot</p><p>reboot</p><p>df -h shut be ~ 1.9Gb free on /overlay and free shows 96mb swap. :-)</p>											<p class="post-edited">(Last edited by <strong>DerMicha</strong> on 12 Dec 2010, 01:06)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p123968">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">shakle</div>
					<div class="post-datetime">
						26 Dec 2010, 21:28					</div>
				</div>
				<div class="post-content content">
					<p>has the tl-mr3420 v1.1 the same board of v1 ?? is it flashable or not?</p>											<p class="post-edited">(Last edited by <strong>shakle</strong> on 26 Dec 2010, 21:31)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p124075">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">Pakonan</div>
					<div class="post-datetime">
						28 Dec 2010, 13:46					</div>
				</div>
				<div class="post-content content">
					<p>ust installed openwrt in a tl-wr3420. After sucesfully doing this:</p><p>opkg update<br />opkg install kmod-usb-core kmod-usb-uhci kmod-usb-storage&nbsp; kmod-usb2&nbsp; kmod-fs-ext3 e2fsprogs</p><p>I am triyng to plug an external&nbsp; usb drive but I am getting these error in the syslog and I can not see /dev/sda:</p><p>Dec 28 11:38:10 PakoCasa user.warn kernel: sysctl net.netfilter.nf_conntrack_acct=1 to enable it.<br />Dec 28 11:38:10 PakoCasa user.warn kernel: ohci_hcd: Unknown symbol usb_hcd_platform_shutdown<br />Dec 28 11:38:10 PakoCasa user.warn kernel: ohci_hcd: Unknown symbol usb_hcd_pci_probe<br />Dec 28 11:38:10 PakoCasa user.warn kernel: ohci_hcd: Unknown symbol usb_hcd_unlink_urb_from_ep<br />Dec 28 11:38:10 PakoCasa user.warn kernel: ohci_hcd: Unknown symbol usb_disabled<br />Dec 28 11:38:10 PakoCasa user.warn kernel: ohci_hcd: Unknown symbol usb_hcd_check_unlink_urb<br />Dec 28 11:38:10 PakoCasa user.warn kernel: ohci_hcd: Unknown symbol usb_hcds_loaded<br />Dec 28 11:38:10 PakoCasa user.warn kernel: ohci_hcd: Unknown symbol usb_calc_bus_time<br />Dec 28 11:38:10 PakoCasa user.warn kernel: ohci_hcd: Unknown symbol usb_hcd_pci_shutdown<br />Dec 28 11:38:10 PakoCasa user.warn kernel: ohci_hcd: Unknown symbol usb_hcd_link_urb_to_ep<br />Dec 28 11:38:10 PakoCasa user.warn kernel: ohci_hcd: Unknown symbol usb_put_hcd<br />Dec 28 11:38:10 PakoCasa user.warn kernel: ohci_hcd: Unknown symbol usb_hcd_giveback_urb<br />Dec 28 11:38:10 PakoCasa user.warn kernel: ohci_hcd: Unknown symbol usb_hcd_poll_rh_status<br />Dec 28 11:38:10 PakoCasa user.warn kernel: ohci_hcd: Unknown symbol usb_create_hcd<br />Dec 28 11:38:10 PakoCasa user.warn kernel: ohci_hcd: Unknown symbol usb_hcd_pci_remove<br />Dec 28 11:38:10 PakoCasa user.warn kernel: ohci_hcd: Unknown symbol usb_remove_hcd<br />Dec 28 11:38:10 PakoCasa user.warn kernel: ohci_hcd: Unknown symbol usb_add_hcd</p><br /><p>What can i do to detect the usb?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p124077">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">rolandk</div>
					<div class="post-datetime">
						28 Dec 2010, 14:20					</div>
				</div>
				<div class="post-content content">
					<p>it looks that usbcore module is not loaded. afaik,&nbsp; ohci-hcd depends on usbcore module</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p124089">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">shakle</div>
					<div class="post-datetime">
						28 Dec 2010, 17:26					</div>
				</div>
				<div class="post-content content">
					<p>i formated my 16gb usb with sda1 ext3 and sda2 swap (100mb)..<br />configured fstab properly and<br />my df -h is </p><p>root@OpenWrt:~# df -h<br />Filesystem&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Size&nbsp; &nbsp; &nbsp; Used Available Use% Mounted on<br />/dev/root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1.5M&nbsp; &nbsp; &nbsp; 1.5M&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 100% /rom<br />tmpfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 14.4M&nbsp; &nbsp; &nbsp;60.0K&nbsp; &nbsp; &nbsp;14.4M&nbsp; &nbsp;0% /tmp<br />tmpfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;512.0K&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; 512.0K&nbsp; &nbsp;0% /dev<br />/dev/sda1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 14.7G&nbsp; &nbsp; 173.3M&nbsp; &nbsp; &nbsp;13.8G&nbsp; &nbsp;1% /overlay<br />mini_fo:/overlay&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1.5M&nbsp; &nbsp; &nbsp; 1.5M&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 100% /</p><p>is it ok? overlay is 1,5M 100% seems to be wrong...</p><p>also uhttpd doesn&#039;t work properly when router starting but only with</p><p>root@OpenWrt:~# uhttpd -p 80 -h /www<br />socket(): Address family not supported by protocol</p><p>Can anyone help me?</p><p>re: solved enabling uhttpd in service &gt;initscripts&nbsp; LOL<br />it works but error remains and I don&#039;t know if partitions are ok...</p>											<p class="post-edited">(Last edited by <strong>shakle</strong> on 28 Dec 2010, 20:46)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p124105">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">Pakonan</div>
					<div class="post-datetime">
						28 Dec 2010, 22:38					</div>
				</div>
				<div class="post-content content">
					<p>Thnaks Roland I will try it. For now I am busy with another problem. I can not make any configuration change in any file. If I try to edit and save a file like /etc/config/dhcp I get a message saying that I can not save it because &quot;No space left on device&quot;. I can see the same error in the kernel syslog during the boot up process<br />&quot;Dec 28 21:05:57 PakoCasa user.info kernel: device wlan0 left promiscuous mode<br />Dec 28 21:05:57 PakoCasa user.info kernel: br-lan: port 2(wlan0) entering disabled state<br />Dec 28 21:05:57 PakoCasa user.info kernel: device wlan0 entered promiscuous mode<br />Dec 28 21:05:57 PakoCasa user.info kernel: br-lan: port 2(wlan0) entering forwarding state<br />Dec 28 21:05:58 PakoCasa user.info sysinit: Loading defaults<br />Dec 28 21:05:58 PakoCasa user.info sysinit: Loading synflood protection<br />Dec 28 21:05:58 PakoCasa user.info sysinit: Adding custom chains<br />Dec 28 21:05:59 PakoCasa user.info sysinit: Loading zones<br />Dec 28 21:06:00 PakoCasa user.info sysinit: Loading forwardings<br />Dec 28 21:06:00 PakoCasa user.info sysinit: Loading redirects<br />Dec 28 21:06:00 PakoCasa user.info sysinit: Loading rules<br />Dec 28 21:06:00 PakoCasa user.info sysinit: Loading includes<br />Dec 28 21:06:00 PakoCasa user.info sysinit: Optimizing conntrack<br />Dec 28 21:06:00 PakoCasa user.info sysinit: Loading interfaces<br />Dec 28 21:06:00 PakoCasa user.info firewall: adding lan (br-lan) to zone lan<br />Dec 28 21:06:00 PakoCasa user.info firewall: adding wan (eth1) to zone wan<br />Dec 28 21:06:01 PakoCasa user.info sysinit: /etc/rc.common: line 78: can&#039;t create /etc/crontabs/root: No space left on device<br />Dec 28 21:06:01 PakoCasa user.info sysinit: # this file is generated from /etc/config/crontabs<br />&quot;<br /># df -h<br />Filesystem&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Size&nbsp; &nbsp; &nbsp; Used Available Use% Mounted on<br />/dev/root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1.8M&nbsp; &nbsp; &nbsp; 1.8M&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 100% /rom<br />tmpfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 14.4M&nbsp; &nbsp; &nbsp;68.0K&nbsp; &nbsp; &nbsp;14.4M&nbsp; &nbsp;0% /tmp<br />tmpfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;512.0K&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; 512.0K&nbsp; &nbsp;0% /dev<br />/dev/mtdblock3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 896.0K&nbsp; &nbsp; 864.0K&nbsp; &nbsp; &nbsp;32.0K&nbsp; 96% /overlay<br />mini_fo:/overlay&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1.8M&nbsp; &nbsp; &nbsp; 1.8M&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 100% /</p><p>I have tried to install again the factory.bin or the sysupgrade.bin but it does not work </p><p>&quot;sysupgrade <a href="http://downloads.openwrt.org/snapshots/trunk/ar71xx/openwrt-ar71xx-generic-tl-mr3420-v1-squashfs-sysupgrade.bin">http://downloads.openwrt.org/snapshots/ … pgrade.bin</a><br />Saving config files...<br />Switching to ramdisk...<br />Segmentation fault<br />Segmentation fault<br />/sbin/sysupgrade: line 134: busybox: not found<br />/sbin/sysupgrade: line 134: busybox: not found<br />/sbin/sysupgrade: line 134: busybox: not found<br />/sbin/sysupgrade: line 134: umount: not found<br />/sbin/sysupgrade: line 134: grep: not found<br />/sbin/sysupgrade: exec: line 134: /bin/busybox: not found&quot;</p><br /><br /><p>Any idea?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p124113">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">DerMicha</div>
					<div class="post-datetime">
						29 Dec 2010, 01:09					</div>
				</div>
				<div class="post-content content">
					<p>@ shakle<br />....and I don&#039;t know if partitions are ok...<br />/dev/sda1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 14.7G&nbsp; &nbsp; 173.3M&nbsp; &nbsp; &nbsp;13.8G&nbsp; &nbsp;1% /overlay</p><p>Yes. It`s right. The entry&nbsp; /dev/mtdblock3 &quot;root part&quot;&nbsp; is changed to /dev/sda1.</p><p>############</p><p> KAMIKAZE (bleeding edge, r24810) ------------------<br />&nbsp; * 10 oz Vodka&nbsp; &nbsp; &nbsp; &nbsp;Shake well with ice and strain<br />&nbsp; * 10 oz Triple sec&nbsp; mixture into 10 shot glasses.<br />&nbsp; * 10 oz lime juice&nbsp; Salute!<br /> ---------------------------------------------------<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * Bootet from USB*</p><p>root@router2:~# df -h<br />Filesystem&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Size&nbsp; &nbsp; &nbsp; Used Available Use% Mounted on<br />/dev/root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1.5M&nbsp; &nbsp; &nbsp; 1.5M&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 100% /rom<br />tmpfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 14.4M&nbsp; &nbsp; 312.0K&nbsp; &nbsp; &nbsp;14.1M&nbsp; &nbsp;2% /tmp<br />tmpfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;512.0K&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; 512.0K&nbsp; &nbsp;0% /dev<br />/dev/sda2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1.7G&nbsp; &nbsp; &nbsp;51.8M&nbsp; &nbsp; &nbsp; 1.6G&nbsp; &nbsp;3% /overlay<br />mini_fo:/overlay&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1.5M&nbsp; &nbsp; &nbsp; 1.5M&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 100% /<br />root@router2:~# free<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; total&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;used&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;free&nbsp; &nbsp; &nbsp; &nbsp;shared&nbsp; &nbsp; &nbsp; buffers<br />&nbsp; Mem:&nbsp; &nbsp; &nbsp; &nbsp; 29528&nbsp; &nbsp; &nbsp; &nbsp; 26696&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2832&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1416<br /> Swap:&nbsp; &nbsp; &nbsp; &nbsp; 96348&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; 96348<br />Total:&nbsp; &nbsp; &nbsp; &nbsp;125876&nbsp; &nbsp; &nbsp; &nbsp; 26696&nbsp; &nbsp; &nbsp; &nbsp; 99180<br />root@router2:~# mount<br />rootfs on / type rootfs (rw)<br />/dev/root on /rom type squashfs (ro,relatime)<br />proc on /proc type proc (rw,relatime)<br />sysfs on /sys type sysfs (rw,relatime)<br />tmpfs on /tmp type tmpfs (rw,nosuid,nodev,relatime)<br />tmpfs on /dev type tmpfs (rw,relatime,size=512k,mode=755)<br />devpts on /dev/pts type devpts (rw,relatime,mode=600)<br />/dev/sda2 on /overlay type ext3 (rw,sync,relatime,errors=continue,data=writeback)<br />mini_fo:/overlay on / type mini_fo (rw,relatime)<br />debugfs on /sys/kernel/debug type debugfs (rw,relatime)<br />none on /proc/bus/usb type usbfs (rw,relatime)<br />root@router2:~#</p>											<p class="post-edited">(Last edited by <strong>DerMicha</strong> on 29 Dec 2010, 01:20)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p124589">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">shakle</div>
					<div class="post-datetime">
						5 Jan 2011, 22:34					</div>
				</div>
				<div class="post-content content">
					<p>I have problem with my new autopowered hd usb2.0. When I plugin it in the router it doesn&#039;t start... I tryed with an powered hub but is the same thing..<br />How can i do?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p124603">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">Nilfred</div>
					<div class="post-datetime">
						6 Jan 2011, 02:17					</div>
				</div>
				<div class="post-content content">
					<p>Power source should be greater than power sink.<br />Check power requirements of your HD and thermodynamics <a href="http://en.wikipedia.org/wiki/Laws_of_thermodynamics#Second_law">1.0.1</a>.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p126923">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">Nilfred</div>
					<div class="post-datetime">
						30 Jan 2011, 23:32					</div>
				</div>
				<div class="post-content content">
					<p>Following <strong>DerMicha</strong> on <a href="https://forum.openwrt.org/viewtopic.php?pid=123070#p123070">#9</a> I managed to do btrfs with compress on a 512 MiB stick:</p><p>Using Gparted on /dev/sdc2 partition and format a 128 MiB swap and left the rest partitioned but unformatted. Then:<br /></p><div class="quotebox"><blockquote><p>sudo apt-get install btrfs-tools<br />sudo mkfs.btrfs -L btrfs /dev/sdc2<br />telnet 192.168.1.1</p></blockquote></div><p>Now connected to the router (at first making some room removing LuCI):<br /></p><div class="quotebox"><blockquote><p>opkg update<br />opkg remove luci luci-theme-openwrt luci-theme-base luci-app-initmgr luci-app-firewall luci-mod-admin-full luci-mod-admin-core luci-lib-web luci-lib-nixio luci-lib-sys luci-lib-core luci-sgi-cgi luci-lib-lmo luci-i18n-english luci-lib-ipkg libiwinfo<br />opkg install kmod-scsi-core kmod-usb-storage kmod-crypto-misc kmod-libcrc32c kmod-fs-btrfs<br />mount /dev/sda2 /mnt<br />cp /tmp/root/* /mnt -a<br />opkg install block-mount block-extroot</p></blockquote></div><p>At this point there is a default fstab config file. Note the disabled state.<br /></p><div class="quotebox"><cite>uci show fstab wrote:</cite><blockquote><p>fstab.automount=global<br />fstab.automount.from_fstab=1<br />fstab.automount.anon_mount=1<br />fstab.autoswap=global<br />fstab.autoswap.from_fstab=1<br />fstab.autoswap.anon_swap=0<br />fstab.@mount[0]=mount<br />fstab.@mount[0].target=/home<br />fstab.@mount[0].device=/dev/sda1<br />fstab.@mount[0].fstype=ext3<br />fstab.@mount[0].options=rw,sync<br />fstab.@mount[0].<strong>enabled=0</strong><br />fstab.@mount[0].enabled_fsck=0<br />fstab.@swap[0]=swap<br />fstab.@swap[0].device=/dev/sda2<br />fstab.@swap[0].<strong>enabled=0</strong></p></blockquote></div><p>This disabled state will be useful later, so I made a copy.<br /></p><div class="quotebox"><blockquote><p>cp /etc/config/fstab /etc/config/fstab-off<br />uci delete fstab.@mount[0].target<br />uci set fstab.@mount[0].device=/dev/sda2<br />uci set fstab.@mount[0].fstype=btrfs<br />uci set fstab.@mount[0].options=rw,sync,compress,ssd<br />uci set fstab.@mount[0].enabled=1<br />uci set fstab.@mount[0].is_rootfs=1<br />uci set fstab.@swap[0].device=/dev/sda1<br />uci set fstab.@swap[0].enabled=1<br />uci commit fstab<br />reboot</p></blockquote></div><p>Will lost conection, so connect again!<br /></p><div class="quotebox"><blockquote><p>telnet 192.168.1.1</p></blockquote></div><p>Now in the router is all done:<br /></p><div class="quotebox"><cite>df wrote:</cite><blockquote><p>Filesystem&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1K-blocks&nbsp; &nbsp; &nbsp; Used Available Use% Mounted on<br />/dev/root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1920&nbsp; &nbsp; &nbsp; 1920&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 100% /rom<br />tmpfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 14764&nbsp; &nbsp; &nbsp; &nbsp; 76&nbsp; &nbsp; &nbsp;14688&nbsp; &nbsp;1% /tmp<br />tmpfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 512&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp;512&nbsp; &nbsp;0% /dev<br />/dev/sda2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;369492&nbsp; &nbsp; &nbsp; 7416&nbsp; &nbsp; 362076&nbsp; &nbsp;2% /overlay<br />mini_fo:/overlay&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1920&nbsp; &nbsp; &nbsp; 1920&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 100% /</p></blockquote></div><p>To revert<br /></p><div class="quotebox"><blockquote><p>mount /dev/mtdblock3 /mnt -t jffs2<br />mv /mnt/etc/config/fstab /mnt/etc/config/fstab-on<br />mv /mnt/etc/config/fstab-off /mnt/etc/config/fstab<br />reboot</p></blockquote></div><p>If you didn&#039;t have fstab-off, there is still hope if you know how to use vi editor<br /></p><div class="quotebox"><blockquote><p>cp /mnt/etc/config/fstab /mnt/etc/config/fstab-on<br />vi /mnt/etc/config/fstab<br />reboot</p></blockquote></div><p>But, I have no swap. Someone know why?<br /></p><div class="quotebox"><cite>free wrote:</cite><blockquote><p>total&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;used&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;free&nbsp; &nbsp; &nbsp; &nbsp;shared&nbsp; &nbsp; &nbsp; buffers<br />&nbsp; Mem:&nbsp; &nbsp; &nbsp; &nbsp; 29528&nbsp; &nbsp; &nbsp; &nbsp; 22972&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;6556&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 688<br /> Swap:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />Total:&nbsp; &nbsp; &nbsp; &nbsp; 29528&nbsp; &nbsp; &nbsp; &nbsp; 22972&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;6556</p></blockquote></div><div class="quotebox"><cite>cat /etc/fstab wrote:</cite><blockquote><p>/dev/sda2&nbsp; &nbsp; &nbsp; &nbsp;/overlay&nbsp; &nbsp; &nbsp; &nbsp; btrfs&nbsp; &nbsp;rw,sync,compress,ssd&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp;0</p></blockquote></div><div class="quotebox"><cite>mount wrote:</cite><blockquote><p>rootfs on / type rootfs (rw)<br />/dev/root on /rom type squashfs (ro,relatime)<br />proc on /proc type proc (rw,relatime)<br />sysfs on /sys type sysfs (rw,relatime)<br />tmpfs on /tmp type tmpfs (rw,nosuid,nodev,relatime)<br />tmpfs on /dev type tmpfs (rw,relatime,size=512k,mode=755)<br />devpts on /dev/pts type devpts (rw,relatime,mode=600)<br />/dev/sda2 on /overlay type btrfs (rw,sync,relatime,compress,ssd,noacl)<br />mini_fo:/overlay on / type mini_fo (rw,relatime)<br />debugfs on /sys/kernel/debug type debugfs (rw,relatime)<br />none on /proc/bus/usb type usbfs (rw,relatime)</p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p137741">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						23 Jun 2011, 22:47					</div>
				</div>
				<div class="post-content content">
					<p><a href="https://forum.openwrt.org/viewtopic.php?id=28343">OpenWrt / TL-MR3420 flash modification</a></p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>