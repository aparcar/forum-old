<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> 8.09 on the WTG624U not saving</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 3 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p108156">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">newrouter</div>
					<div class="post-datetime">
						29 Apr 2010, 16:10					</div>
				</div>
				<div class="post-content content">
					<p>Hey guys,</p><p>Firstly thank you for the devs for such great work!</p><p>Setup:</p><p>Netgear WTG624U - 8.09 installed (downloaded it today so must be the new one!)</p><p>I have some funnies I would like some help with ***DISCLAMER*** I am trying to learn the commands for linux I am a windows user so please excuse the dumb questions.</p><p>1. I do some config i.e.<br />ifconfig br-lan up 192.168.0.25 netmask 255.255.255.0<br />Go to etc/resolve.config - change nameserver to 192.168.0.1 (use winscp to SCP to the box and change the file with its text editor)<br />route add default gw 192.168.0.1</p><p>What I am trying to make work (which it does) is I have another ADSL router which is the gateway for the internet this router (the netgear) is the one in my lounge for all my devices. So it&#039;s suppose to connect to the devices via LAN Ethernet ports and then also use via the WAN port the config above.</p><p>1.1 The WAN setup works, I can route out to the internet opkg update etc works ping google.com works. Happy.<br />1.2 If I reboot the router or if I turn power off and back on it loses all my settings or config I did above and defaults back to 192.168.1.1 and I have to do all these settings again. It also loses all the opkg Install &lt;Packages_I_Have_installed&gt;</p><p>1.2.1 Is there suppose to be some save or commit command I am suppose to use? When I was using 7.09 I use to do the same thing but it use to commit the settings and I never had to worry about doing this again. Everytime I reboot 8.09 I lose everything almost like it does a full reset of the Router.</p><p>Question: **Disclamer** sorry if its a dumb question ** what is the commit command or what am I doing wrong how do I get it to save the configs and installed packages permantly.</p><p>2.0 - Often when I do a opkg update, either via PUTTY or using hyperterminal (in windows) - I have a serial connection to the router, the router goes very slow on PUTTY it just aborts the opkg update command --- on serial terminal I see the following:</p><p># opkg invoked oom-killer: gfp_mask=0x1201d2, order=0, oomkilladj0<br />Call Trace:[&lt;8000911c&gt;][&lt;8000911c&gt;][&lt;800555f8&gt;][&lt;800558bc&gt;][&lt;8006194c&gt;][&lt;80055a]<br />Mem-info:<br />Normal per-cpu:<br />CPU 0: hi: 0, btch: 1 usd: 0<br />Active:3839 inactive:2496 dirty:0 writeback:0 unstable:0<br />free:180 slab:646 mapped:0 pagetables:72 bounce:0<br />Normal free:720kB min:720kB low:900kB high:1080kB active:15356kB inactive:9984ks<br />lowmem_reserve[]: 0 0<br />Normal: 0*4kB 0*8kB 1*16kB 0*32kB 1*64kB 1*128kB 0*256kB 1*512kB 0*1024kB 0*204B<br />3744 total pagecache pages<br />Swap cache: add 0, delete 0, find 0/0<br />Free swap = 0kB<br />Total swap = 0kB<br />Free swap: 0kB<br />8192 pages of RAM<br />0 pages of HIGHMEM<br />704 reserved pages<br />26 pages shared<br />0 pages swap cached<br />Out of memory: kill process 760 (dnsmasq) score 320 or a child<br />Killed process 760 (dnsmasq)<br />klogd invoked oom-killer: gfp_mask=0x1201d2, order=0, oomkilladj=0<br />Call Trace:[&lt;8000911c&gt;][&lt;8000911c&gt;][&lt;800555f8&gt;][&lt;800558bc&gt;][&lt;80204444&gt;][&lt;80203f]<br />Mem-info:<br />Normal per-cpu:<br />CPU 0: hi: 0, btch: 1 usd: 0<br />Active:3820 inactive:2497 dirty:0 writeback:0 unstable:0<br />free:180 slab:646 mapped:0 pagetables:69 bounce:0<br />Normal free:720kB min:720kB low:900kB high:1080kB active:15280kB inactive:9988ks<br />lowmem_reserve[]: 0 0<br />Normal: 0*4kB 0*8kB 1*16kB 0*32kB 1*64kB 1*128kB 0*256kB 1*512kB 0*1024kB 0*204B<br />3744 total pagecache pages<br />Swap cache: add 0, delete 0, find 0/0<br />Free swap = 0kB<br />Total swap = 0kB<br />Free swap: 0kB<br />8192 pages of RAM<br />0 pages of HIGHMEM<br />704 reserved pages<br />26 pages shared<br />0 pages swap cached<br />Out of memory: kill process 855 (opkg) score 164 or a child<br />Killed process 855 (opkg)</p><br /><p>If on PUTTY I try to do a opkg update (or any opkg command for that case) it just says Opkg KILLED. I actually have to reboot the dam router again --- which in turn resets all my settings (as per question 1)</p><p>HOWEVER - sometimes opkg update works and updates everything I would say the above senario happens 4 out of five times.</p><p>Question: why is it doing this, am I doing something wrong, does the router not support this?</p><br /><p>3.0 --- *** DISCLAMER*** again sorry I am not a Linux guru so I just don&#039;t know the commands***<br />I would like to setup this router this way:</p><p>Internet_ADSL_GATEWAY ---&gt; Ethernet &lt;---- Netgear (OpenWRT 8.09) ---&gt;WAN PORT&lt;--- ***** THIS WORKS (until I reboot the router <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" />)</p><p>On the LAN Ethernet and also the wireless if possible I would like to do the following:</p><p>LAN and Wireless (on Netgear OpenWRT) ---&gt; Have DHCP for any client connection with range 192.168.0.100 till 192.168.0.200 -- This is so that I know clients on 100 -&gt; 200 are in the lounge. </p><p>I would like these clients to be able to browse the internet using the setup I have on the WAN port i.e. forward all traffice from the LAN via the WAN port to gateway 192.168.0.1.</p><p>QUESTION: I really have tried and read as much as possible, don&#039;t want to use the GUI cause I am trying to Learn the cmd commands..... what would the commands look like to set the above up?</p><p>Thank you for your time and I would appreciate a response even if its just to one of my questions.</p><p>newbie</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p108160">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						29 Apr 2010, 16:30					</div>
				</div>
				<div class="post-content content">
					<p>You are supposed to edit /etc/config/network and its friends to make permanent settings to the router. Changes produced by manual ifconfig commands etc. are not persistent, they&#039;re gone after a reboot (by design).</p><p>As for the oom-killer error above, you cannot do much about it, this is opkg taking up too much space. A solution is to upgrade OpenWrt to 10.03, opkg is improved there.</p><p>~ Jow</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p108164">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">newrouter</div>
					<div class="post-datetime">
						29 Apr 2010, 16:35					</div>
				</div>
				<div class="post-content content">
					<p>thank you for the time you took to reply!</p><p>Ok and I thought I was SOOOO clever upgrading to 8.09 and there is already 10.09 wow, ok off to find it... <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> thank you again!</p><p>Question, I login as &#039;root&#039; if I try Config or /etc/.... I keep getting permissions issues. Someone told me if there is a &quot;#&quot; after &lt;username&gt;@&lt;routername&gt; i.e. root@myrouter# it means you not in config mode or something? Is that right and if so what is the command to go into config and always stay in config <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Thank you again</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p108166">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">newrouter</div>
					<div class="post-datetime">
						29 Apr 2010, 16:37					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jow wrote:</cite><blockquote><p>You are supposed to edit /etc/config/network and its friends to make permanent settings to the router. Changes produced by manual ifconfig commands etc. are not persistent, they&#039;re gone after a reboot (by design).</p><p>As for the oom-killer error above, you cannot do much about it, this is opkg taking up too much space. A solution is to upgrade OpenWrt to 10.03, opkg is improved there.</p><p>~ Jow</p></blockquote></div><p>Also I just checked: <a href="http://downloads.openwrt.org/kamikaze/">http://downloads.openwrt.org/kamikaze/</a> and there is no 10.03 dir, is it in a different place?</p><p>I just did a bunch of config and downloaded a bunch of apps using opkg, is there a way to preserve all this when flashing from 8.09 to 10.03?</p><p>Thank you again!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p108167">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						29 Apr 2010, 16:41					</div>
				</div>
				<div class="post-content content">
					<p>Stuff in /etc/config/ is plain text files, you cannot execute them, you have to edit them using a command line editor or the uci utility.</p><p>The default editor in OpenWrt is &quot;vi&quot;, e.g. use &quot;vi /etc/config/network&quot; to open the network configuration in the editor. Ask Google for the usage of &quot;vi&quot; it is quite different from usual editors. You could also install the alternative &quot;nano&quot; editor with &quot;opkg&quot;, it is a bit easier to use.</p><p>The hash mark (&quot;#&quot;) is just a part of the shell prompt, it has no syntactical meaning.</p><p>For general information on uci configuration files, see <a href="http://wiki.openwrt.org/doc/uci">http://wiki.openwrt.org/doc/uci</a> .</p><p>~ Jow</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p108170">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">newrouter</div>
					<div class="post-datetime">
						29 Apr 2010, 16:52					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jow wrote:</cite><blockquote><p>Stuff in /etc/config/ is plain text files, you cannot execute them, you have to edit them using a command line editor or the uci utility.</p><p>The default editor in OpenWrt is &quot;vi&quot;, e.g. use &quot;vi /etc/config/network&quot; to open the network configuration in the editor. Ask Google for the usage of &quot;vi&quot; it is quite different from usual editors. You could also install the alternative &quot;nano&quot; editor with &quot;opkg&quot;, it is a bit easier to use.</p><p>The hash mark (&quot;#&quot;) is just a part of the shell prompt, it has no syntactical meaning.</p><p>For general information on uci configuration files, see <a href="http://wiki.openwrt.org/doc/uci">http://wiki.openwrt.org/doc/uci</a> .</p><p>~ Jow</p></blockquote></div><p>Thank you Jow (once again!)</p><p>Ok here is what I did:<br />1. Downloaded 10.03 backfire which is file: openwrt-wgt634u-squashfs.bin 3mb odd<br />2. Went to web interface: system: flash firmware: pointed it to my file I downloaded (one above)<br />3. Clicked upload image button</p><p>I get an error: The uploaded image file does not contain a supported format. Make sure that you choose the generic image format for your platform.</p><p>Can one not upgrade from 8.09 directly to 10.03?</p><p>Thank you for your time</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p108171">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						29 Apr 2010, 16:56					</div>
				</div>
				<div class="post-content content">
					<p>Use the .trx (not .trx2!) file to upgrade the firmware.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p108172">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">newrouter</div>
					<div class="post-datetime">
						29 Apr 2010, 16:57					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jow wrote:</cite><blockquote><p>Use the .trx (not .trx2!) file to upgrade the firmware.</p></blockquote></div><p>um sorry Jow last stupidest question I don&#039;t understand what you mean by use the .trx file and not the .trx2 file isnt this a .bin file?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p108173">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">newrouter</div>
					<div class="post-datetime">
						29 Apr 2010, 17:00					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>newrouter wrote:</cite><blockquote><div class="quotebox"><cite>jow wrote:</cite><blockquote><p>Use the .trx (not .trx2!) file to upgrade the firmware.</p></blockquote></div><p>um sorry Jow last stupidest question I don&#039;t understand what you mean by use the .trx file and not the .trx2 file isnt this a .bin file?</p></blockquote></div><p>This is the location I am using (and downloading the version for WTG624U) <a href="http://downloads.openwrt.org/backfire/10.03/brcm47xx/">http://downloads.openwrt.org/backfire/10.03/brcm47xx/</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p108175">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						29 Apr 2010, 17:04					</div>
				</div>
				<div class="post-content content">
					<p><a href="http://downloads.openwrt.org/backfire/10.03/brcm47xx/openwrt-brcm47xx-squashfs.trx">http://downloads.openwrt.org/backfire/1 … uashfs.trx</a> &lt;- .trx file</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p108176">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">newrouter</div>
					<div class="post-datetime">
						29 Apr 2010, 17:05					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jow wrote:</cite><blockquote><p><a href="http://downloads.openwrt.org/backfire/10.03/brcm47xx/openwrt-brcm47xx-squashfs.trx">http://downloads.openwrt.org/backfire/1 … uashfs.trx</a> &lt;- .trx file</p></blockquote></div><p>Again thank you very much!!!<br />I will download this file and update my WTG624U with this file above THANK you!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p108181">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">newrouter</div>
					<div class="post-datetime">
						29 Apr 2010, 17:56					</div>
				</div>
				<div class="post-content content">
					<p>Ok clearly I did something wrong, updated to 10.03, first thing ran opkg&nbsp; update, it says it updated but when I do a opkg list I get every package with:</p><p> * pkg_hash_add_from_file: Package wireless-tools version 29-2 has no valid architecture, ignoring.<br /> * pkg_hash_add_from_file: Package wlc version 4.150.10.5.3-2 has no valid architecture, ignoring.<br /> * pkg_hash_add_from_file: Package zlib version 1.2.3-5 has no valid architecture, ignoring.</p><p>Do I need to delete or clear something?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p108183">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">newrouter</div>
					<div class="post-datetime">
						29 Apr 2010, 18:05					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>newrouter wrote:</cite><blockquote><p>Ok clearly I did something wrong, updated to 10.03, first thing ran opkg&nbsp; update, it says it updated but when I do a opkg list I get every package with:</p><p> * pkg_hash_add_from_file: Package wireless-tools version 29-2 has no valid architecture, ignoring.<br /> * pkg_hash_add_from_file: Package wlc version 4.150.10.5.3-2 has no valid architecture, ignoring.<br /> * pkg_hash_add_from_file: Package zlib version 1.2.3-5 has no valid architecture, ignoring.</p><p>Do I need to delete or clear something?</p></blockquote></div><p>Think I fixed it went to go look at opkg.config file and found that the location was pointing to 7.09 packages, found <a href="http://downloads.openwrt.org/backfire/10.03/brcm47xx/packages/">http://downloads.openwrt.org/backfire/1 … /packages/</a> changed the config file and saved, then re ran opkg update and it updated <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p108184">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">newrouter</div>
					<div class="post-datetime">
						29 Apr 2010, 18:11					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>newrouter wrote:</cite><blockquote><div class="quotebox"><cite>newrouter wrote:</cite><blockquote><p>Ok clearly I did something wrong, updated to 10.03, first thing ran opkg&nbsp; update, it says it updated but when I do a opkg list I get every package with:</p><p> * pkg_hash_add_from_file: Package wireless-tools version 29-2 has no valid architecture, ignoring.<br /> * pkg_hash_add_from_file: Package wlc version 4.150.10.5.3-2 has no valid architecture, ignoring.<br /> * pkg_hash_add_from_file: Package zlib version 1.2.3-5 has no valid architecture, ignoring.</p><p>Do I need to delete or clear something?</p></blockquote></div><p>Think I fixed it went to go look at opkg.config file and found that the location was pointing to 7.09 packages, found <a href="http://downloads.openwrt.org/backfire/10.03/brcm47xx/packages/">http://downloads.openwrt.org/backfire/1 … /packages/</a> changed the config file and saved, then re ran opkg update and it updated <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p></blockquote></div><p>Hit another issue when trying to install any package I would get a similar error for each package:<br />root@OpenWrt:~# opkg install zoneinfo-americas<br />Collected errors:<br /> * opkg_conf_init: Could not lock /var/lock/opkg.lock: Resource temporarily unavailable.<br />root@OpenWrt:~# opkg install zoneinfo-americas<br />Installing zoneinfo-africa (2009c-2) to root...<br />Collected errors:<br /> * verify_pkg_installable: Only have 0kb available on filesystem /, pkg zoneinfo-americasneeds 46<br /> * opkg_install_cmd: Cannot install package zoneinfo-americas.</p><br /><p>So I did some searching found this bug report: <a href="https://dev.openwrt.org/ticket/7088">https://dev.openwrt.org/ticket/7088</a> </p><p>Changed: from:: option overlay_root /jffs</p><p>TO:: option overlay_root /overlay</p><br /><p>And it worked....</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>