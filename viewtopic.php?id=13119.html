<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> USB controller not recongnized on Asus WL-500g with kernel 2.6.22</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 25 Jan 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p57939">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">knyihar</div>
					<div class="post-datetime">
						23 Oct 2007, 16:27					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I tried to install my Huawei E220 HSDPA USB modem on my Asus WL-500g (it is not the premium one) running Openwrt 7.09.</p><p>I tried to install the version shipped with kernel 2.6.22. I installed the following packages as well:</p><p>kmod-usb-ohci<br />kmod-usb-storage<br />kmod-usb-serial<br />pciutils<br />usbutils<br />chat<br />ppp</p><br /><p>But after installation nor Asus&#039; USB controller nor the USB modem was recognized by the system according to lscpi and lsusb. There were problems with recognition of other hardwares as well.</p><br /><p>-------------------------------------------------------------------------------------------------------------</p><p>root@OpenWrt:~# dmesg<br />Linux version 2.6.22 (nbd@ds10) (gcc version 4.1.2) #2 Sun Sep 30 20:38:47 CEST 2007<br />CPU revision is: 00024000<br />ssb: Core 0 found: SDRAM (cc 0x803, rev 0x00, vendor 0x4243)<br />ssb: Core 1 found: ILine 20 (cc 0x801, rev 0x00, vendor 0x4243)<br />ssb: Core 2 found: Fast Ethernet (cc 0x806, rev 0x00, vendor 0x4243)<br />ssb: Core 3 found: V90 (cc 0x807, rev 0x00, vendor 0x4243)<br />ssb: Core 4 found: USB 1.1 Hostdev (cc 0x808, rev 0x00, vendor 0x4243)<br />ssb: Core 5 found: PCI (cc 0x804, rev 0x00, vendor 0x4243)<br />ssb: Core 6 found: MIPS (cc 0x805, rev 0x00, vendor 0x4243)<br />ssb: Core 7 found: EXTIF (cc 0x811, rev 0x00, vendor 0x4243)<br />ssb: Core 8 found: Fast Ethernet (cc 0x806, rev 0x00, vendor 0x4243)<br />ssb: Initializing MIPS core...<br />ssb: set_irq: core 0x0806, irq 2 =&gt; 2<br />ssb: set_irq: core 0x0804, irq 4 =&gt; 3<br />ssb: set_irq: core 0x0806, irq 0 =&gt; 4<br />ssb: Sonics Silicon Backplane found at address 0x18000000<br />Determined physical RAM map:<br /> memory: 01000000 @ 00000000 (usable)<br />Initrd not found or empty - disabling initrd<br />On node 0 totalpages: 4096<br />&nbsp; Normal zone: 32 pages used for memmap<br />&nbsp; Normal zone: 0 pages reserved<br />&nbsp; Normal zone: 4064 pages, LIFO batch:0<br />Built 1 zonelists.&nbsp; Total pages: 4064<br />Kernel command line: root=/dev/mtdblock2 rootfstype=squashfs,jffs2 init=/etc/preinit noinitrd console=ttyS0,115200<br />Enabling BCM4710A0 cache workarounds.<br />Primary instruction cache 8kB, physically tagged, 2-way, linesize 16 bytes.<br />Primary data cache 4kB, 2-way, linesize 16 bytes.<br />Synthesized TLB refill handler (20 instructions).<br />Synthesized TLB load handler fastpath (32 instructions).<br />Synthesized TLB store handler fastpath (31 instructions).<br />Synthesized TLB modify handler fastpath (30 instructions).<br />PID hash table entries: 64 (order: 6, 256 bytes)<br />Using 62.400 MHz high precision timer.<br />Dentry cache hash table entries: 2048 (order: 1, 8192 bytes)<br />Inode-cache hash table entries: 1024 (order: 0, 4096 bytes)<br />Memory: 13628k/16384k available (2030k kernel code, 2756k reserved, 297k data, 120k init, 0k highmem)<br />Calibrating delay loop... 82.43 BogoMIPS (lpj=164864)<br />Mount-cache hash table entries: 512<br />NET: Registered protocol family 16<br />ssb: PCIcore in host mode found<br />registering PCI controller with io_map_base unset<br />PCI: fixing up bridge<br />PCI: Setting latency timer of device 0000:00:00.0 to 64<br />PCI: Fixing up device 0000:00:00.0<br />Time: MIPS clocksource has been installed.<br />NET: Registered protocol family 2<br />IP route cache hash table entries: 1024 (order: 0, 4096 bytes)<br />TCP established hash table entries: 512 (order: 0, 4096 bytes)<br />TCP bind hash table entries: 512 (order: -1, 2048 bytes)<br />TCP: Hash tables configured (established 512 bind 512)<br />TCP reno registered<br />squashfs: version 3.0 (2006/03/15) Phillip Lougher<br />Registering mini_fo version $Id$<br />JFFS2 version 2.2. (NAND) ÂŠ 2001-2006 Red Hat, Inc.<br />io scheduler noop registered<br />io scheduler deadline registered (default)<br />Serial: 8250/16550 driver $Revision: 1.90 $ 2 ports, IRQ sharing enabled<br />b44.c:v1.01 (Jun 16, 2006)<br />eth0: Broadcom 10/100BaseT Ethernet 00:0e:a6:9e:f8:99<br />eth1: Broadcom 10/100BaseT Ethernet 00:0e:a6:9e:f8:99<br />flash init: 0x1fc00000 0x00400000<br />Physically mapped flash: Found 1 x16 devices at 0x0 in 16-bit bank<br /> Amd/Fujitsu Extended Query Table at 0x0040<br />Physically mapped flash: Swapping erase regions for broken CFI table.<br />number of CFI chips: 1<br />cfi_cmdset_0002: Disabling erase-suspend-program due to code brokenness.<br />Flash device: 0x400000 at 0x1fc00000<br />bootloader size: 262144<br />Creating 4 MTD partitions on &quot;Physically mapped flash&quot;:<br />0x00000000-0x00040000 : &quot;cfe&quot;<br />0x00040000-0x003f0000 : &quot;linux&quot;<br />0x000f8000-0x003f0000 : &quot;rootfs&quot;<br />mtd: partition &quot;rootfs&quot; doesn&#039;t start on an erase block boundary -- force read-only<br />0x00200000-0x003f0000 : &quot;rootfs_data&quot;<br />0x003f0000-0x00400000 : &quot;nvram&quot;<br />nf_conntrack version 0.5.0 (128 buckets, 1024 max)<br />ip_tables: (C) 2000-2006 Netfilter Core Team<br />TCP vegas registered<br />NET: Registered protocol family 1<br />NET: Registered protocol family 17<br />802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;<br />All bugs added by David S. Miller &lt;davem@redhat.com&gt;<br />VFS: Mounted root (squashfs filesystem) readonly.<br />Freeing unused kernel memory: 120k freed<br />Warning: unable to open an initial console.<br />Algorithmics/MIPS FPU Emulator v1.5<br />diag: Detected &#039;ASUS WL-500g&#039;<br />b44: eth0: Link is up at 100 Mbps, full duplex.<br />b44: eth0: Flow control is off for TX and off for RX.<br />Probing device eth0: No Robo switch in managed mode found<br />Probing device eth1: [/data/release/brcm47xx-2.6/build_mipsel/linux-2.6-brcm47xx/kmod-switch/switch-robo.c:91] SIOCGETCPHYRD failed!<br />[/data/release/brcm47xx-2.6/build_mipsel/linux-2.6-brcm47xx/kmod-switch/switch-robo.c:91] SIOCGETCPHYRD failed!<br />No Robo switch in managed mode found<br />Probing device eth2: No such device<br />Probing device eth3: No such device<br />BFL_ENETADM not set in boardflags. Use force=1 to ignore.<br />mini_fo: using base directory: /<br />mini_fo: using storage directory: /jffs<br />device eth0 entered promiscuous mode<br />b44: eth0: Link is up at 100 Mbps, full duplex.<br />b44: eth0: Flow control is off for TX and off for RX.<br />br-lan: port 1(eth0) entering learning state<br />br-lan: topology change detected, propagating<br />br-lan: port 1(eth0) entering forwarding state<br />Probing device eth0: No Robo switch in managed mode found<br />Probing device eth1: Invalid phy address (0)<br />Probing device eth2: No such device<br />Probing device eth3: No such device<br />BFL_ENETADM not set in boardflags. Use force=1 to ignore.<br />b44: eth1: Link is up at 10 Mbps, half duplex.<br />b44: eth1: Flow control is off for TX and off for RX.<br />usbcore: registered new interface driver usbfs<br />usbcore: registered new interface driver hub<br />usbcore: registered new device driver usb<br />PPP generic driver version 2.4.2<br />wlan: 0.8.4.2 (svn r2568)<br />ath_hal: module license &#039;Proprietary&#039; taints kernel.<br />ath_hal: 0.9.30.13 (AR5210, AR5211, AR5212, AR5416, RF5111, RF5112, RF2413, RF5413, RF2133, REGOPS_FUNC)<br />ath_rate_minstrel: Minstrel automatic rate control algorithm 1.2 (svn r2568)<br />ath_rate_minstrel: look around rate set to 10%<br />ath_rate_minstrel: EWMA rolloff level set to 75%<br />ath_rate_minstrel: max segment size in the mrr set to 6000 us<br />wlan: mac acl policy registered<br />ath_pci: 0.9.4.5 (svn r2568)<br />ohci_hcd: 2006 August 04 USB 1.1 &#039;Open&#039; Host Controller (OHCI) Driver<br />root@OpenWrt:~#</p><p>root@OpenWrt:/# lspci<br />00:00.0 Host bridge: Broadcom Corporation BCM4710 Sentry5 PCI to SB Bridge (rev<br />01)<br />00:02.0 Network controller: Broadcom Corporation BCM4306 802.11b/g Wireless LAN<br />Controller (rev 03)<br />root@OpenWrt:/# lspci -v<br />00:00.0 Host bridge: Broadcom Corporation BCM4710 Sentry5 PCI to SB Bridge (rev<br />01)<br />&nbsp; &nbsp; &nbsp; &nbsp; Subsystem: Broadcom Corporation BCM4710 Sentry5 PCI to SB Bridge<br />&nbsp; &nbsp; &nbsp; &nbsp; Flags: bus master, fast devsel, latency 168, IRQ 5<br />&nbsp; &nbsp; &nbsp; &nbsp; Memory at &lt;unassigned&gt; (32-bit, prefetchable)</p><p>00:02.0 Network controller: Broadcom Corporation BCM4306 802.11b/g Wireless LAN<br />Controller (rev 03)<br />&nbsp; &nbsp; &nbsp; &nbsp; Subsystem: ASUSTeK Computer Inc. Unknown device 120f<br />&nbsp; &nbsp; &nbsp; &nbsp; Flags: fast devsel, IRQ 5<br />&nbsp; &nbsp; &nbsp; &nbsp; Memory at 40000000 (32-bit, non-prefetchable) [disabled] [size=8K]<br />&nbsp; &nbsp; &nbsp; &nbsp; Capabilities: [40] Power Management version 2</p><p>-------------------------------------------------------------------------------------------------------------</p><br /><p>Then I installed Openwrt 7.09 shipped with kernel 2.4.34.</p><p>It changed things a bit:</p><br /><p>-------------------------------------------------------------------------------------------------------------<br />root@OpenWrt:/# dmesg<br />CPU revision is: 00024000<br />Enabling BCM4710A0 cache workarounds.<br />Primary instruction cache 8kB, physically tagged, 2-way, linesize 16 bytes.<br />Primary data cache 4kB, 2-way, linesize 16 bytes.<br />Linux version 2.4.34 (nbd@ds10) (gcc version 3.4.6 (OpenWrt-2.0)) #3 Sun Sep 30<br />20:33:21 CEST 2007<br />Determined physical RAM map:<br /> memory: 01000000 @ 00000000 (usable)<br />On node 0 totalpages: 4096<br />zone(0): 4096 pages.<br />zone(1): 0 pages.<br />zone(2): 0 pages.<br />Kernel command line: root=/dev/mtdblock2 rootfstype=squashfs,jffs2 init=/etc/pre<br />init noinitrd console=ttyS0,115200<br />CPU: BCM4710 rev 0 at 125 MHz<br />Using 62.400 MHz high precision timer.<br />!unable to setup serial console!<br />Calibrating delay loop... 82.94 BogoMIPS<br />Memory: 14224k/16384k available (1462k kernel code, 2160k reserved, 100k data, 8<br />0k init, 0k highmem)<br />Dentry cache hash table entries: 2048 (order: 2, 16384 bytes)<br />Inode cache hash table entries: 1024 (order: 1, 8192 bytes)<br />Mount cache hash table entries: 512 (order: 0, 4096 bytes)<br />Buffer cache hash table entries: 1024 (order: 0, 4096 bytes)<br />Page-cache hash table entries: 4096 (order: 2, 16384 bytes)<br />Checking for &#039;wait&#039; instruction...&nbsp; unavailable.<br />POSIX conformance testing by UNIFIX<br />PCI: Initializing host<br />PCI: Fixing up bus 0<br />PCI: Fixing up bridge<br />PCI: Setting latency timer of device 01:00.0 to 64<br />PCI: Fixing up bus 1<br />Linux NET4.0 for Linux 2.4<br />Based upon Swansea University Computer Society NET3.039<br />Initializing RT netlink socket<br />Starting kswapd<br />Registering mini_fo version $Id$<br />devfs: v1.12c (20020818) Richard Gooch (rgooch@atnf.csiro.au)<br />devfs: boot_options: 0x1<br />JFFS2 version 2.1. (C) 2001 Red Hat, Inc., designed by Axis Communications AB.<br />squashfs: version 3.0 (2006/03/15) Phillip Lougher<br />pty: 256 Unix98 ptys configured<br />Serial driver version 5.05c (2001-07-08) with MANY_PORTS SHARE_IRQ SERIAL_PCI en<br />abled<br />b44.c:v0.93 (Mar, 2004)<br />PCI: Setting latency timer of device 00:02.0 to 64<br />eth0: Broadcom 47xx 10/100BaseT Ethernet 00:0e:a6:9e:f8:99<br />PCI: Setting latency timer of device 00:08.0 to 64<br />eth1: Broadcom 47xx 10/100BaseT Ethernet 00:0e:a6:9e:f8:99<br /> Amd/Fujitsu Extended Query Table v1.1 at 0x0040<br />Physically mapped flash: Swapping erase regions for broken CFI table.<br />number of CFI chips: 1<br />cfi_cmdset_0002: Disabling fast programming due to code brokenness.<br />Flash device: 0x400000 at 0x1fc00000<br />bootloader size: 262144<br />Physically mapped flash: Filesystem type: squashfs, size=0x121cc8<br />Creating 5 MTD partitions on &quot;Physically mapped flash&quot;:<br />0x00000000-0x00040000 : &quot;cfe&quot;<br />0x00040000-0x003f0000 : &quot;linux&quot;<br />0x000be400-0x001f0000 : &quot;rootfs&quot;<br />mtd: partition &quot;rootfs&quot; doesn&#039;t start on an erase block boundary -- force read-o<br />nly<br />0x003f0000-0x00400000 : &quot;nvram&quot;<br />0x001f0000-0x003f0000 : &quot;rootfs_data&quot;<br />sflash: chipcommon not found<br />Initializing Cryptographic API<br />NET4: Linux TCP/IP 1.0 for NET4.0<br />IP Protocols: ICMP, UDP, TCP, IGMP<br />IP: routing cache hash table of 512 buckets, 4Kbytes<br />TCP: Hash tables configured (established 1024 bind 2048)<br />ip_conntrack version 2.1 (5953 buckets, 5953 max) - 360 bytes per conntrack<br />ip_tables: (C) 2000-2002 Netfilter core team<br />NET4: Unix domain sockets 1.0/SMP for Linux NET4.0.<br />NET4: Ethernet Bridge 008 for NET4.0<br />802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;<br />All bugs added by David S. Miller &lt;davem@redhat.com&gt;<br />VFS: Mounted root (squashfs filesystem) readonly.<br />Mounted devfs on /dev<br />Freeing unused kernel memory: 80k freed<br />Warning: unable to open an initial console.<br />Algorithmics/MIPS FPU Emulator v1.5<br />diag: Detected &#039;ASUS WL-500g&#039;<br />b44: eth0: Link is up at 100 Mbps, full duplex.<br />b44: eth0: Flow control is off for TX and off for RX.<br />Probing device eth0: No Robo switch in managed mode found<br />Probing device eth1: No Robo switch in managed mode found<br />Probing device eth2: No such device<br />Probing device eth3: No such device<br />BFL_ENETADM not set in boardflags. Use force=1 to ignore.<br />mini_fo: using base directory: /<br />mini_fo: using storage directory: /jffs<br />jffs2.bbc: SIZE compression mode activated.<br />device eth0 entered promiscuous mode<br />b44: eth0: Link is up at 100 Mbps, full duplex.<br />b44: eth0: Flow control is off for TX and off for RX.<br />br-lan: port 1(eth0) entering learning state<br />br-lan: port 1(eth0) entering forwarding state<br />br-lan: topology change detected, propagating<br />b44: eth1: Link is up at 100 Mbps, full duplex.<br />b44: eth1: Flow control is off for TX and off for RX.<br />Probing device eth0: No Robo switch in managed mode found<br />Probing device eth1: No Robo switch in managed mode found<br />Probing device eth2: No such device<br />Probing device eth3: No such device<br />BFL_ENETADM not set in boardflags. Use force=1 to ignore.<br />usb.c: registered new driver usbdevfs<br />usb.c: registered new driver hub<br />PCI: Setting latency timer of device 01:02.0 to 64<br />PCI: Enabling device 01:02.0 (0004 -&gt; 0006)<br />wl0: Broadcom BCM4320 802.11 Wireless Controller 4.80.53.0<br />CSLIP: code copyright 1989 Regents of the University of California<br />PPP generic driver version 2.4.2<br />PCI: Setting latency timer of device 00:04.0 to 64<br />usb-ohci.c: USB OHCI at membase 0xb8004000, IRQ 2<br />usb-ohci.c: usb-00:04.0, PCI device 14e4:4715<br />usb.c: new USB bus registered, assigned bus number 1<br />hub.c: USB hub found<br />hub.c: 2 ports detected<br />usb.c: registered new driver serial<br />usbserial.c: USB Serial support registered for Generic<br />usbserial.c: USB Serial Driver core v1.4<br />SCSI subsystem driver Revision: 1.00<br />Initializing USB Mass Storage driver...<br />usb.c: registered new driver usb-storage<br />USB Mass Storage support registered.<br />hub.c: new USB device 00:04.0-1, assigned address 2<br />usbserial.c: Generic converter detected<br />usbserial.c: Generic converter now attached to ttyUSB0 (or usb/tts/0 for devfs)<br />root@OpenWrt:/#</p><p>root@OpenWrt:/# lspci<br />00:00.0 RAM memory: Broadcom Corporation Unknown device 0803<br />00:01.0 Ethernet controller: Broadcom Corporation BCM47xx Sentry5 iLine32 HomePN<br />A 2.0<br />00:02.0 Ethernet controller: Broadcom Corporation Sentry5 Ethernet Controller<br />00:03.0 Modem: Broadcom Corporation BCM47xx V.92 56k modem<br />00:04.0 USB Controller: Broadcom Corporation Sentry5 USB Controller<br />00:05.0 PCI bridge: Broadcom Corporation Sentry5 PCI Bridge<br />00:06.0 MIPS: Broadcom Corporation Sentry5 MIPS32 CPU<br />00:07.0 FLASH memory: Broadcom Corporation Sentry5 External Interface Core<br />00:08.0 Ethernet controller: Broadcom Corporation Sentry5 Ethernet Controller<br />01:00.0 Host bridge: Broadcom Corporation BCM4710 Sentry5 PCI to SB Bridge (rev<br />01)<br />01:02.0 Network controller: Broadcom Corporation BCM4306 802.11b/g Wireless LAN<br />Controller (rev 03)</p><p>root@OpenWrt:~# lsusb<br />Invalid product/subclass spec at line 2481<br />Invalid vendor spec at line 3907<br />Invalid vendor spec at line 3948<br />Bus 001 Device 001: ID 0000:0000<br />Bus 001 Device 002: ID 12d1:1003 Huawei Technologies Co., Ltd. E220 HSDPA Modem<br />-------------------------------------------------------------------------------------------------------------</p><p>later, after setting password and using ssh instead of telnet I get only:</p><p>-------------------------------------------------------------------------------------------------------------<br />root@OpenWrt:~# lsusb<br />Bus 001 Device 001: ID 0000:0000<br />Bus 001 Device 002: ID 12d1:1003<br />-------------------------------------------------------------------------------------------------------------</p><p>This is strange as well.</p><br /><p>My modem has been recognized and the driver has created the /dev/usb/tts/0 file.<br />I tried to communicate with my modem using minicom whitout success.</p><p>Do you have any idea how could I get my Huawei E220 USB modem working?<br />I tried several tutorials on the web.</p><p>Please advise.</p><p>Thanks a lot for your help in advance.</p><p>Regards, Gyorgy</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>