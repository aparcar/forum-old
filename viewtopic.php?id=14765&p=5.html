<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Atheros AR7100</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 30 Mar 2018 and 1 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 5 of 15</div><nav><ul><li><a href="viewtopic.php%3Fid=14765&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=14765&amp;p=3.html">3</a></li><li><a href="viewtopic.php%3Fid=14765&amp;p=4.html">4</a></li><li class="pagination-current"><span>5</span></li><li><a href="viewtopic.php%3Fid=14765&amp;p=6.html">6</a></li><li><a href="viewtopic.php%3Fid=14765&amp;p=7.html">7</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=14765&amp;p=15.html">15</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p70042">
				<div class="post-metadata">
					<div class="post-num">Post #101</div>
					<div class="post-author">BrainSlayer</div>
					<div class="post-datetime">
						25 Jun 2008, 12:07					</div>
				</div>
				<div class="post-content content">
					<p>yes, but you will notice bad performance in this way. a additional workaround is required</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p70043">
				<div class="post-metadata">
					<div class="post-num">Post #102</div>
					<div class="post-author">BrainSlayer</div>
					<div class="post-datetime">
						25 Jun 2008, 12:16					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>acoul wrote:</cite><blockquote><div class="quotebox"><cite>BrainSlayer wrote:</cite><blockquote><p>just my five cents. yes the rx dma bug in the ar7100 chipset is a well known bug, but i wrote a workaround for it. so i can get full performance out of it even if the cpu load is now higher. i&#039;m running it on a ubiquiti litestation x prototype (ar7100) and got full possible speed out of it. but the 300 mhz minimum clock is really required todo this. this bug does not affect 802.11n (ar5416,ar9060,ar9280) atheros chipsets. just ar5006 and older.<br />the bug is that the rx dma size must be used with 4 bytes length instead of 128. otherwise the bus will hang and crash the system. this increases cpu load for sure. atheros tried to cover this bug in the hal sourcecode, but the solution covered just 2 chipsets, but much more are affected.</p></blockquote></div><p>Hello BrainSlayer, do you have any further pointers with discussions about this bug?<br /></p><div class="quotebox"><cite>BrainSlayer wrote:</cite><blockquote><p>the new hal release i&#039;m preparing together with nbd does cover this issue. there will be a separate ar7100 hal in it</p></blockquote></div><p>I thought that the hal part is a closed binary code from Atheros who releases it every now and then and that madwifi.org along with the linux kernel developers are switching to the ath5k development which is the open source reverse engineer of the closed hal binary code.</p></blockquote></div><p>you can write me a email to s.gottschall@newmedia-net.de if you want to discuss it. and yes the hal is closed. but i have access to the hal sources directly from atheros and also good personal contacts to this company and i&#039;m working together with nbd since a long time (almost 2 years now), to make it better. we contribute also patches back to sam leffler. but we are close now for a own hal release (madwifi trunk compatible)<br />even if ath5k is a good solution for the madwifi developers or you, its not ready yet for me. alot of important features are missing and for my system i&#039;m happy that all is working now with great performance and extended featureset. i dont want to destroy this, by playing with new code. and in this way i also get the chance to implement always the latest chipset support, since atheros is only maintaining the hal officially (but they are working also on ath5k, but dont expect too much from it)</p><p>so in fact, everyone can get the hal sourcecode. you just need to get a source license under nda for it. its not that easy, but possible.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p70044">
				<div class="post-metadata">
					<div class="post-num">Post #103</div>
					<div class="post-author">BrainSlayer</div>
					<div class="post-datetime">
						25 Jun 2008, 12:20					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jal2 wrote:</cite><blockquote><div class="quotebox"><cite>BrainSlayer wrote:</cite><blockquote><p>the bug is that the rx dma size must be used with 4 bytes length instead of 128. otherwise the bus will hang and crash the system. this increases cpu load for sure.</p></blockquote></div><p>Thanks for giving more information on this issue.</p><p>Is this a bug in the PCI controller of the AR71xx? Does it affect DMA in both directions (CPU-&gt;PCI and PCI-&gt;CPU)?</p><p>Are there any implications for running other, non-Atheros, cards (RaLink, Prism54)?</p><p>@oceanyounger: Any plans on Atheros&#039; side for fixing it?</p></blockquote></div><p>it just affects RX and only ar5006 and older chipsets. i have not played with other cards right now. maybe i will run into the same problem. i dont know right now. maybe i play with it later. i&#039;m focused on atheros solutions</p><p>atheros told me that there are no plans for fixing it, since atheros designed it only for 802.11n cards originally and want to focus on these chipsets in future too. so as stupid it sounds, it seems like that atheros has no real reason for fixing it. <br />all 802.11n chipsets (ar5416,ar9001,ar9280) are not affected by this bug<br />but maybe i&#039;m wrong and atheros turns his mind and will release a third revision of the ar7100 (there are already 2) for older chipset support.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p70046">
				<div class="post-metadata">
					<div class="post-num">Post #104</div>
					<div class="post-author">bitbucket</div>
					<div class="post-datetime">
						25 Jun 2008, 13:03					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>BrainSlayer wrote:</cite><blockquote><p>yes, but you will notice bad performance in this way. a additional workaround is required</p></blockquote></div><p>You mean, that setting pci rx buf to 4B will not solve the problem ? Or there is another different workaround ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p70047">
				<div class="post-metadata">
					<div class="post-num">Post #105</div>
					<div class="post-author">jal2</div>
					<div class="post-datetime">
						25 Jun 2008, 13:17					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Brainslayer wrote:</cite><blockquote><p>atheros told me that there are no plans for fixing it, since atheros designed it only for 802.11n cards originally and want to focus on these chipsets in future too. so as stupid it sounds, it seems like that atheros has no real reason for fixing it.<br />all 802.11n chipsets (ar5416,ar9001,ar9280) are not affected by this bug</p></blockquote></div><p>Is this really a bug in the AR71xx or in the older Atheros chipsets? While AR9280 is PCIe (difficult to connect to an AR71xx) and AR9001 has the WLAN baseband integrated into the SoC, the AR5416 still has a PCI interface.</p><div class="quotebox"><cite>BrainSlayer wrote:</cite><blockquote><p>so in fact, everyone can get the hal sourcecode. you just need to get a source license under nda for it. its not that easy, but possible.</p></blockquote></div><p>I would guess that signing this NDA will prevent you from ever being able to contribute to ath5k.</p><p>I wonder which madwifi HAL Mikrotik is using in their RouterOS? AFAIK they currently support older Atheros chipset.</p><p>If Atheros is targeting the 802.11n router market only with the AR71xx, I&#039;d guess that it will disappear soon from their product list replaced by a two-chip solution (radio+bb/mac/cpu) based on the AR9132.</p><p>Maybe we should ask Mikrotik about guaranteed availability of the RB4xx and support for non-Atheros miniPCI cards?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p70050">
				<div class="post-metadata">
					<div class="post-num">Post #106</div>
					<div class="post-author">bitbucket</div>
					<div class="post-datetime">
						25 Jun 2008, 13:43					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jal2 wrote:</cite><blockquote><p>I wonder which madwifi HAL Mikrotik is using in their RouterOS? AFAIK they currently support older Atheros chipset.</p></blockquote></div><p>Mikrotik use their own driver, AFAIK, based on some old (end of 2003 year) sources of HAL. Or may be now they have signed NDA and get HAL sources.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p70051">
				<div class="post-metadata">
					<div class="post-num">Post #107</div>
					<div class="post-author">Slammer</div>
					<div class="post-datetime">
						25 Jun 2008, 13:55					</div>
				</div>
				<div class="post-content content">
					<p>Does the bug affect only wireless operation?<br />Is the RB411, without pci board installed, working normally (serial, ethernet, core system)?</p>											<p class="post-edited">(Last edited by <strong>Slammer</strong> on 25 Jun 2008, 13:58)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p70053">
				<div class="post-metadata">
					<div class="post-num">Post #108</div>
					<div class="post-author">bitbucket</div>
					<div class="post-datetime">
						25 Jun 2008, 15:02					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Slammer wrote:</cite><blockquote><p>Does the bug affect only wireless operation?</p></blockquote></div><p>All bugs in ath5k affect wireless operation. Bug with pci rx buffer size hangs system, bug in rx tasklet (crc32 at the tail of frame not stripped out) affect only some special ethernet protocols (not ip)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p70056">
				<div class="post-metadata">
					<div class="post-num">Post #109</div>
					<div class="post-author">Slammer</div>
					<div class="post-datetime">
						25 Jun 2008, 15:43					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>bitbucket wrote:</cite><blockquote><div class="quotebox"><cite>Slammer wrote:</cite><blockquote><p>Does the bug affect only wireless operation?</p></blockquote></div><p>All bugs in ath5k affect wireless operation. Bug with pci rx buffer size hangs system, bug in rx tasklet (crc32 at the tail of frame not stripped out) affect only some special ethernet protocols (not ip)</p></blockquote></div><p>So, is the source ready to support RB450 without problems? Maybe is time to include the sources, at least for RB450, in the SVN.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p70060">
				<div class="post-metadata">
					<div class="post-num">Post #110</div>
					<div class="post-author">bitbucket</div>
					<div class="post-datetime">
						25 Jun 2008, 15:58					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Slammer wrote:</cite><blockquote><p>So, is the source ready to support RB450 without problems? Maybe is time to include the sources, at least for RB450, in the SVN.</p></blockquote></div><p>I have only rb411.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p70079">
				<div class="post-metadata">
					<div class="post-num">Post #111</div>
					<div class="post-author">BrainSlayer</div>
					<div class="post-datetime">
						25 Jun 2008, 21:23					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>bitbucket wrote:</cite><blockquote><div class="quotebox"><cite>BrainSlayer wrote:</cite><blockquote><p>yes, but you will notice bad performance in this way. a additional workaround is required</p></blockquote></div><p>You mean, that setting pci rx buf to 4B will not solve the problem ? Or there is another different workaround ?</p></blockquote></div><p>its the initial workaround to get it to work. but another workaround is required to get performance. i cannot give you too much details without breaking the NDA i signed, but its a pretty simple workaround. just one line</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p70080">
				<div class="post-metadata">
					<div class="post-num">Post #112</div>
					<div class="post-author">BrainSlayer</div>
					<div class="post-datetime">
						25 Jun 2008, 21:32					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jal2 wrote:</cite><blockquote><div class="quotebox"><cite>Brainslayer wrote:</cite><blockquote><p>atheros told me that there are no plans for fixing it, since atheros designed it only for 802.11n cards originally and want to focus on these chipsets in future too. so as stupid it sounds, it seems like that atheros has no real reason for fixing it.<br />all 802.11n chipsets (ar5416,ar9001,ar9280) are not affected by this bug</p></blockquote></div><p>Is this really a bug in the AR71xx or in the older Atheros chipsets? While AR9280 is PCIe (difficult to connect to an AR71xx) and AR9001 has the WLAN baseband integrated into the SoC, the AR5416 still has a PCI interface.</p></blockquote></div><p>? AR9001 (AR9160 chipset)<br />is standard mac + rf combination. no soc<br />you can buy a very bad minipci from sparklan and the ubiquiti SR71A is based on it as well. but without saying too much, the mac has a bug too. we are currently trying todo a workaround in our hal<br />the follow up chipset ar9280 is a single chip (mac/rf) solution. nothing special. almost made for 2x2 and 1x1 mimo</p><p>you mean the ub91 usb variant which is soc, but this is completelly different</p><div class="quotebox"><blockquote><div class="quotebox"><cite>BrainSlayer wrote:</cite><blockquote><p>so in fact, everyone can get the hal sourcecode. you just need to get a source license under nda for it. its not that easy, but possible.</p></blockquote></div><p>I would guess that signing this NDA will prevent you from ever being able to contribute to ath5k.<br />not at all. there are still undocumented things in the atheros hal. if i find out such things without any document base, i can contribute it. </p><p>I wonder which madwifi HAL Mikrotik is using in their RouterOS? AFAIK they currently support older Atheros chipset.</p></blockquote></div><p>mikrotik doesnt use the hal or ar5k. as far as i know the driver is based on the atheros calibration tool sources. (nbd found this out)</p> <br /><p>If Atheros is targeting the 802.11n router market only with the AR71xx, I&#039;d guess that it will disappear soon from their product list replaced by a two-chip solution (radio+bb/mac/cpu) based on the AR9132.<br />the radio+bb/mac/cpu (ap81/ap82) is designed as low cost solution. the pb42/ar71xx has also audio interface, usb etc. <br />originally it was not designed as single minipci solution. the reference design has 2 minipci slots, usb, audio in and outputs and various other stuff and the ar71xx is faster. it can run up to 600 mhz <br /></p><div class="quotebox"><blockquote><p>Maybe we should ask Mikrotik about guaranteed availability of the RB4xx and support for non-Atheros miniPCI cards?</p></blockquote></div><p>maybe we should ask mikrotik about the gpl sources first<br />i will try to add support for wavesat wimax next time into the ar71xx. i hope it works. if not, i will find out how to get it to work</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p70083">
				<div class="post-metadata">
					<div class="post-num">Post #113</div>
					<div class="post-author">bitbucket</div>
					<div class="post-datetime">
						25 Jun 2008, 22:02					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>BrainSlayer wrote:</cite><blockquote><p>its the initial workaround to get it to work. but another workaround is required to get performance. i cannot give you too much details without breaking the NDA i signed, but its a pretty simple workaround. just one line</p></blockquote></div><p>Just one line in hal or kernel ? Because both cpu and wireless nic are made by atheros. If it is closed by nda, don&#039;t tell. Somebody sooner or later will found it.</p><p>I know one workaround to get performance: it is disabling the TXDONE interrupt. It helps on x86 hardware, but it needs to check how it will works on ar7130. Also, mikrotik&#039;s driver (and routeros) for atheros chipset consume all ar7130 CPU on high load.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p70103">
				<div class="post-metadata">
					<div class="post-num">Post #114</div>
					<div class="post-author">jal2</div>
					<div class="post-datetime">
						26 Jun 2008, 01:32					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>BrainSlayer wrote:</cite><blockquote><p>? AR9001 (AR9160 chipset)<br />is standard mac + rf combination. no soc</p></blockquote></div><p>True. I referred to the&nbsp; AR9001AP-2/3NX only, which contains an AR9132. Missed the AR9001AP-2/3NX2 with AR9160 on the Atheros page.</p><p>If the bug doesn&#039;t affect 802.11n chipsets, it can&#039;t be a simple bug in the PCI controller like &quot;no read burst triggered by a&nbsp; PCI card can have a length &gt; 4 byte&quot; unless these chipsets don&#039;t issue read bursts.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p70140">
				<div class="post-metadata">
					<div class="post-num">Post #115</div>
					<div class="post-author">BrainSlayer</div>
					<div class="post-datetime">
						27 Jun 2008, 04:59					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jal2 wrote:</cite><blockquote><div class="quotebox"><cite>BrainSlayer wrote:</cite><blockquote><p>? AR9001 (AR9160 chipset)<br />is standard mac + rf combination. no soc</p></blockquote></div><p>True. I referred to the&nbsp; AR9001AP-2/3NX only, which contains an AR9132. Missed the AR9001AP-2/3NX2 with AR9160 on the Atheros page.</p><p>If the bug doesn&#039;t affect 802.11n chipsets, it can&#039;t be a simple bug in the PCI controller like &quot;no read burst triggered by a&nbsp; PCI card can have a length &gt; 4 byte&quot; unless these chipsets don&#039;t issue read bursts.</p></blockquote></div><p>the strange thing is that the 802.11n chipsets are using the same rxburst mechanism. i really dont know the reason. i just know the result and how to get around</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p70141">
				<div class="post-metadata">
					<div class="post-num">Post #116</div>
					<div class="post-author">BrainSlayer</div>
					<div class="post-datetime">
						27 Jun 2008, 05:01					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>bitbucket wrote:</cite><blockquote><div class="quotebox"><cite>BrainSlayer wrote:</cite><blockquote><p>its the initial workaround to get it to work. but another workaround is required to get performance. i cannot give you too much details without breaking the NDA i signed, but its a pretty simple workaround. just one line</p></blockquote></div><p>Just one line in hal or kernel ? Because both cpu and wireless nic are made by atheros. If it is closed by nda, don&#039;t tell. Somebody sooner or later will found it.</p><p>I know one workaround to get performance: it is disabling the TXDONE interrupt. It helps on x86 hardware, but it needs to check how it will works on ar7130. Also, mikrotik&#039;s driver (and routeros) for atheros chipset consume all ar7130 CPU on high load.</p></blockquote></div><p>its a hal one liner. the kernel is not affected in any way </p><p>i compared routeros speed with my solution and mine was faster. about 60 mbit TCP in 802.11a turbo mode was possible without any issues. (usually some more with some tricks)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p70148">
				<div class="post-metadata">
					<div class="post-num">Post #117</div>
					<div class="post-author">bitbucket</div>
					<div class="post-datetime">
						27 Jun 2008, 12:46					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>BrainSlayer wrote:</cite><blockquote><p>its a hal one liner. the kernel is not affected in any way</p></blockquote></div><p>As always, atheros hide some special &#039;killer feature&#039; from us. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> We&#039;ll keep searching.</p><p>I think, that card can&#039;t transmit faster than it does when sending self looped TX descriptor with TXDONE IRQ event off. Also, adjusting some interframe timings (sifs, aifs, postbackoff) may boost performance, but not such much. </p><div class="quotebox"><cite>BrainSlayer wrote:</cite><blockquote><p>i compared routeros speed with my solution and mine was faster. about 60 mbit TCP in 802.11a turbo mode was possible without any issues. (usually some more with some tricks)</p></blockquote></div><p>At which platform ? ag7130 @ 300MHz with build in CPU ethernet IC ? <br />Because it is possible get 60Mbit in one way at 36Mbit trubo rate without compression. But I used faster cpu (x86).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p70158">
				<div class="post-metadata">
					<div class="post-num">Post #118</div>
					<div class="post-author">number6</div>
					<div class="post-datetime">
						27 Jun 2008, 19:01					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>bitbucket wrote:</cite><blockquote><div class="quotebox"><cite>qyx wrote:</cite><blockquote><p>after loading to rb411 there is only mess on serial terminal...</p></blockquote></div><p>may be serial console rate wrong ? <br />Check kernel&#039;s .config for right cmdline:<br />CONFIG_CMDLINE=&quot;board=411 HZ=300 console=ttyS0,115200&quot;</p></blockquote></div><p>I have successfully compiled a load for the RB450 but am also seeing only invalid data on the console port.&nbsp; My kernel command line is:</p><p>console=ttyS0,115200n81 board=450 HZ=300 rootfstype=squashfs,jffs2 init=/etc/preinit</p><p>The bootloader on the RB450 spits out the following so I&#039;m relatively confident that I have the HZ parameter right.</p><p>RouterBOOT booter 2.14&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />RouterBoard 450&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />CPU frequency: 300 MHz<br />&nbsp; Memory size:&nbsp; 32 MB</p><p>Any ideas on where to look next?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p70177">
				<div class="post-metadata">
					<div class="post-num">Post #119</div>
					<div class="post-author">acoul</div>
					<div class="post-datetime">
						27 Jun 2008, 21:08					</div>
				</div>
				<div class="post-content content">
					<p><a href="http://wifi.ozo.com/airo/mirror/ar7100/alex/">update</a>.&nbsp; I get the following error on the ethernet driver directory:<br /></p><div class="codebox"><pre><code>  CC      drivers/net/ag7100/ipPhy.o
drivers/net/ag7100/ipPhy.c:15:26: error: linux/config.h: No such file or directory
In file included from drivers/net/ag7100/ipPhy.c:21:
drivers/net/ag7100/ag7100_phy.h: In function &#039;ag7100_get_link_status&#039;:
drivers/net/ag7100/ag7100_phy.h:151: error: implicit declaration of function &#039;ip_phyIsUp&#039;
drivers/net/ag7100/ag7100_phy.h:152: error: implicit declaration of function &#039;ip_phyIsFullDuplex&#039;
drivers/net/ag7100/ag7100_phy.h:153: error: implicit declaration of function &#039;ip_phySpeed&#039;
drivers/net/ag7100/ipPhy.c:183:5: warning: &quot;DEBUG&quot; is not defined
drivers/net/ag7100/ipPhy.c: At top level:
drivers/net/ag7100/ipPhy.c:524: error: conflicting types for &#039;ip_phySpeed&#039;
drivers/net/ag7100/ag7100_phy.h:153: error: previous implicit declaration of &#039;ip_phySpeed&#039; was here
drivers/net/ag7100/ipPhy.c:565: warning: conflicting types for &#039;ip_phyIsUp&#039;
drivers/net/ag7100/ag7100_phy.h:151: warning: previous implicit declaration of &#039;ip_phyIsUp&#039; was here
drivers/net/ag7100/ipPhy.c: In function &#039;ip_phyIsUp&#039;:
drivers/net/ag7100/ipPhy.c:612: warning: &#039;return&#039; with a value, in function returning void
drivers/net/ag7100/ipPhy.c:629:5: warning: &quot;DEBUG&quot; is not defined
make[8]: *** [drivers/net/ag7100/ipPhy.o] Error 1</code></pre></div>											<p class="post-edited">(Last edited by <strong>acoul</strong> on 27 Jun 2008, 22:04)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p70183">
				<div class="post-metadata">
					<div class="post-num">Post #120</div>
					<div class="post-author">number6</div>
					<div class="post-datetime">
						27 Jun 2008, 22:18					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>acoul wrote:</cite><blockquote><p><a href="http://wifi.ozo.com/airo/mirror/ar7100/alex/">update</a>.&nbsp; I get the following error on the ethernet driver directory:<br /></p><div class="codebox"><pre><code>  CC      drivers/net/ag7100/ipPhy.o
drivers/net/ag7100/ipPhy.c:15:26: error: linux/config.h: No such file or directory
In file included from drivers/net/ag7100/ipPhy.c:21:
drivers/net/ag7100/ag7100_phy.h: In function &#039;ag7100_get_link_status&#039;:
drivers/net/ag7100/ag7100_phy.h:151: error: implicit declaration of function &#039;ip_phyIsUp&#039;
drivers/net/ag7100/ag7100_phy.h:152: error: implicit declaration of function &#039;ip_phyIsFullDuplex&#039;
drivers/net/ag7100/ag7100_phy.h:153: error: implicit declaration of function &#039;ip_phySpeed&#039;
drivers/net/ag7100/ipPhy.c:183:5: warning: &quot;DEBUG&quot; is not defined
drivers/net/ag7100/ipPhy.c: At top level:
drivers/net/ag7100/ipPhy.c:524: error: conflicting types for &#039;ip_phySpeed&#039;
drivers/net/ag7100/ag7100_phy.h:153: error: previous implicit declaration of &#039;ip_phySpeed&#039; was here
drivers/net/ag7100/ipPhy.c:565: warning: conflicting types for &#039;ip_phyIsUp&#039;
drivers/net/ag7100/ag7100_phy.h:151: warning: previous implicit declaration of &#039;ip_phyIsUp&#039; was here
drivers/net/ag7100/ipPhy.c: In function &#039;ip_phyIsUp&#039;:
drivers/net/ag7100/ipPhy.c:612: warning: &#039;return&#039; with a value, in function returning void
drivers/net/ag7100/ipPhy.c:629:5: warning: &quot;DEBUG&quot; is not defined
make[8]: *** [drivers/net/ag7100/ipPhy.o] Error 1</code></pre></div></blockquote></div><p>I&#039;ve gotten past this point.&nbsp; PM me with your e-mail address and I&#039;ll send you my ar7100 tarball.&nbsp; Mine compiles fine but has the console port problem I mentioned above.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p70188">
				<div class="post-metadata">
					<div class="post-num">Post #121</div>
					<div class="post-author">bitbucket</div>
					<div class="post-datetime">
						27 Jun 2008, 22:55					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>number6 wrote:</cite><blockquote><p>console=ttyS0,115200n81 board=450 HZ=300 rootfstype=squashfs,jffs2 init=/etc/preinit</p></blockquote></div><p>May be something wrong witch serial port clock settings. Which patch you used to make kernel for rb450 ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p70189">
				<div class="post-metadata">
					<div class="post-num">Post #122</div>
					<div class="post-author">bitbucket</div>
					<div class="post-datetime">
						27 Jun 2008, 23:02					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>acoul wrote:</cite><blockquote><p><a href="http://wifi.ozo.com/airo/mirror/ar7100/alex/">update</a>.&nbsp; I get the following error on the ethernet driver directory:</p></blockquote></div><p><a href="http://narod.ru/disk/1160646000/ag7100.tgz.html">http://narod.ru/disk/1160646000/ag7100.tgz.html</a> - working driver. Put it to ag7100 to drivers/net and *.h files to include/asm/mach-rb <br />(to download file enter digits on image and press green button)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p70191">
				<div class="post-metadata">
					<div class="post-num">Post #123</div>
					<div class="post-author">number6</div>
					<div class="post-datetime">
						27 Jun 2008, 23:38					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>bitbucket wrote:</cite><blockquote><div class="quotebox"><cite>number6 wrote:</cite><blockquote><p>console=ttyS0,115200n81 board=450 HZ=300 rootfstype=squashfs,jffs2 init=/etc/preinit</p></blockquote></div><p>May be something wrong witch serial port clock settings. Which patch you used to make kernel for rb450 ?</p></blockquote></div><p>I used acoul&#039;s 3rd tarball plus my own modifications to make it compile.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p70201">
				<div class="post-metadata">
					<div class="post-num">Post #124</div>
					<div class="post-author">qyx</div>
					<div class="post-datetime">
						28 Jun 2008, 02:59					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>bitbucket wrote:</cite><blockquote><div class="quotebox"><cite>number6 wrote:</cite><blockquote><p>console=ttyS0,115200n81 board=450 HZ=300 rootfstype=squashfs,jffs2 init=/etc/preinit</p></blockquote></div><p>May be something wrong witch serial port clock settings. Which patch you used to make kernel for rb450 ?</p></blockquote></div><p>i used the same sources as number6 (including modifications posted above), i tried all possible standard baudrates</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p70204">
				<div class="post-metadata">
					<div class="post-num">Post #125</div>
					<div class="post-author">acoul</div>
					<div class="post-datetime">
						28 Jun 2008, 10:42					</div>
				</div>
				<div class="post-content content">
					<p><a href="http://wifi.ozo.com/airo/mirror/ar7100/alex/">update</a>.</p><p>Good news: <br />* everything compiles fine<br />* successful login through telnet @ 192.168.1.1<br />* openwrt netboot image available</p><p>Bad news:<br />* no serial console (yet)<br />* network dies on ping with large packet size<br /></p><div class="codebox"><pre><code>ping -s 65507 192.168.1.1</code></pre></div><p>here is the dmesg:<br /></p><div class="codebox"><pre><code>Linux version 2.6.23.17 (alex@extreme) (gcc version 4.2.4) #1 Sat Jun 28 10:27:09 EEST 2008
CPU revision is: 00019374
Determined physical RAM map:
User-defined physical RAM map:
 memory: 02000000 @ 00000000 (usable)
Initrd not found or empty - disabling initrd
On node 0 totalpages: 8192
  Normal zone: 64 pages used for memmap
  Normal zone: 0 pages reserved
  Normal zone: 8128 pages, LIFO batch:0
  Movable zone: 0 pages used for memmap
Built 1 zonelists in Zone order.  Total pages: 8128
Kernel command line: console=ttyS0,115200 gpio=4031 mem=32M kmac=00:0C:42:19:CE:F9 board=411 boot=1
Primary instruction cache 64kB, physically tagged, 4-way, linesize 32 bytes.
Primary data cache 32kB, 4-way, linesize 32 bytes.
Synthesized TLB refill handler (20 instructions).
Synthesized TLB load handler fastpath (32 instructions).
Synthesized TLB store handler fastpath (32 instructions).
Synthesized TLB modify handler fastpath (31 instructions).
Cache parity protection disabled
PID hash table entries: 128 (order: 7, 512 bytes)
Using 150.000 MHz high precision timer.
console [ttyS0] enabled
Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
Memory: 28360k/32768k available (1902k kernel code, 4408k reserved, 281k data, 804k init, 0k highmem)
Calibrating delay loop... 199.47 BogoMIPS (lpj=997376)
Mount-cache hash table entries: 512
NET: Registered protocol family 16
registering PCI controller with io_map_base unset
Generic PHY: Registered new driver
NET: Registered protocol family 2
Time: MIPS clocksource has been installed.
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 1024 (order: 1, 8192 bytes)
TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
TCP: Hash tables configured (established 1024 bind 1024)
TCP reno registered
squashfs: version 3.0 (2006/03/15) Phillip Lougher
Registering mini_fo version $Id$
JFFS2 version 2.2. (NAND) (SUMMARY)  Î’Â© 2001-2006 Red Hat, Inc.
io scheduler noop registered
io scheduler deadline registered (default)
Serial: 8250/16550 driver $Revision: 1.90 $ 1 ports, IRQ sharing disabled
ICPlus IP175C: Registered new driver
Infineon ADM6996: Registered new driver
Marvell 88E6060: Registered new driver
AG7100: Length per segment 1536
AG7100: Max segments per packet 2
AG7100: Max tx descriptor count    256
AG7100: Max rx descriptor count    128
AG7100: fifo cfg 3 008001ff
AG7100CHH: Mac address for unit 0 &#039;00:0c:42:19:ce:f9&#039;
TCP vegas registered
NET: Registered protocol family 1
NET: Registered protocol family 17
802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;
All bugs added by David S. Miller &lt;davem@redhat.com&gt;
Freeing unused kernel memory: 804k freed
Algorithmics/MIPS FPU Emulator v1.5
ag7100_ring_alloc Allocated 3072 at 0x8106b000
ag7100_ring_alloc Allocated 1536 at 0x805dd000
AG7100: cfg1 0xf cfg2 0x7014
ksz_phy: autonegotiation does not completed
AG7100: unit 0 phy is up...GMii 100Mbps full duplex
AG7100: pll reg 0x18050010: 0x1099  AG7100: cfg_1: 0x1ff0000
AG7100: cfg_2: 0x3ff
AG7100: cfg_3: 0x8001ff
AG7100: cfg_4: 0xffff
AG7100: cfg_5: 0x7ffef
AG7100: done cfg2 0x7115 ifctl 0x10000 miictrl 0x10
Writing 4
ag7100_ring_free Freeing at 0x8106b000
ag7100_ring_free Freeing at 0x805dd000
ag7100_ring_alloc Allocated 3072 at 0x8106b000
ag7100_ring_alloc Allocated 1536 at 0x805dd000
AG7100: cfg1 0xf cfg2 0x7115
ksz_phy: autonegotiation is not supported
Writing 4
ag7100_ring_free Freeing at 0x8106b000
ag7100_ring_free Freeing at 0x805dd000
ag7100_ring_alloc Allocated 3072 at 0x8106b000
ag7100_ring_alloc Allocated 1536 at 0x805dd000
AG7100: cfg1 0xf cfg2 0x7115
ksz_phy: autonegotiation is not supported
Writing 4
AG7100: unit 0 phy is up...GMii 100Mbps full duplex
AG7100: pll reg 0x18050010: 0x1099  AG7100: cfg_1: 0x1ff0000
AG7100: cfg_2: 0x3ff
AG7100: cfg_3: 0x8001ff
AG7100: cfg_4: 0xffff
AG7100: cfg_5: 0x7ffef
AG7100: done cfg2 0x7115 ifctl 0x10000 miictrl 0x10</code></pre></div>											<p class="post-edited">(Last edited by <strong>acoul</strong> on 28 Jun 2008, 10:43)</p>
									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 5 of 15</div><nav><ul><li><a href="viewtopic.php%3Fid=14765&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=14765&amp;p=3.html">3</a></li><li><a href="viewtopic.php%3Fid=14765&amp;p=4.html">4</a></li><li class="pagination-current"><span>5</span></li><li><a href="viewtopic.php%3Fid=14765&amp;p=6.html">6</a></li><li><a href="viewtopic.php%3Fid=14765&amp;p=7.html">7</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=14765&amp;p=15.html">15</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>