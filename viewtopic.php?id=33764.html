<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Pure-ftpd uploadscript refuses to run (without errors, on backfire)</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 8 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p152392">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">shadowlion</div>
					<div class="post-datetime">
						30 Dec 2011, 03:54					</div>
				</div>
				<div class="post-content content">
					<p>Iâ€™m at the end of my rope with this problem</p><p>I&#039;m trying to get a pure-ftpd running with uploadscripts in a test environment.</p><p>I can get pure-ftpd to run normally with the exception of uploadscripts</p><p>Here is my setup:</p><p>*** Fresh install of 10.03.1-rc6 X86 in VMware, pure-ftpd install in the Web interface and setup basic network stuff and tested communications</p><p>*** UPDATE I have tried it on Kamikaze X86 8.09.2 and it Fails as well</p><p>*** edited /etc/passwd: </p><p>ftp:x:1001:2001:x:/tmp/ftp:/bin/ash</p><p>*** edited /etc/group:</p><p>ftp:x:2001:</p><p>passwd ftp</p><p>pure-pw useradd blah -u 1001 -g 2001-d /tmp/ftp</p><p>pure-pw mkdb</p><p>pure-pw show blah</p><p>*** looks good so far; pureftpd.pdb &amp; pureftpd.passwd are created</p><p>mkdir /tmp/ftp<br />crown 1001:2001 /tmp/ftp<br />chmod 775 /tmp/ftp</p><p>*** make simple script in /bin/blah.sh as follows:</p><p>touch /tmp/ftp/test</p><p>*** In theory this should make a file named &quot;test&quot; when a file is uploaded (i tried to make other stuff happen too but no luck)</p><p>chown 1001:2001 /bin/blah.sh<br />chmod 755 /bin/blah.sh</p><p>pure-ftpd -B -E -4 -l puredb:/etc/pureftpd.pdb -o -O clf:/var/log/pureftpd.log -s 192.168.190.134,21</p><p>*** test FTP login and it fails *BUT* this is normal behavior because when the -o is invoked pure-uploadscript must be started. SO....</p><p>pure-uploadscript -u 1001 -g 2001 -r /bin/blah.sh</p><p>*** test FTP login and it works! with correct user. Upload files successfully but no uploadscript action takes place.</p><p>*** no errors in syslog or /var/log/pureftpd.log just the normal stuff</p><p>*** it should be noted the the /tmp/run/pureftpd files are created normally (that i can tell) when pure-uploadscript is run</p><br /><p>Please help</p>											<p class="post-edited">(Last edited by <strong>shadowlion</strong> on 31 Dec 2011, 02:11)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p152478">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">shadowlion</div>
					<div class="post-datetime">
						30 Dec 2011, 21:27					</div>
				</div>
				<div class="post-content content">
					<p>No one can confirm or deny that uploadscripts work at all on any build?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p152492">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">shadowlion</div>
					<div class="post-datetime">
						31 Dec 2011, 04:03					</div>
				</div>
				<div class="post-content content">
					<p>wow.... 20 hours later</p><p>#! /bin/sh</p><p>is required at the start of the script</p><p>yep I&#039;m a noob</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>