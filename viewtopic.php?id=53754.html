<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> openvpn tun</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 21 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p252804">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">dhfffile</div>
					<div class="post-datetime">
						2 Nov 2014, 05:55					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>I could install openvpn-polarssl on Barrier Breaker, TL-WR841N router, free space approx. 130 kb.</p><p>So far so good. But it seems there is some trouble with the --&gt;tun&lt;-- interface. On the openwrt router, I followed the instructions for setting up tun0 network interface and firewall configuration and openvpn config in doc/howto/vpn.openvpn.txt -- except that I configured it for static key and point-to-point. After having failed to get it to work with windows client, I then tried it with a linux client (in this case raspberry pi arch linux) but got the same error (see below -- probably it has to do with &quot;write to TUN/TAP : Invalid argument (code=22)&quot;). I tried several config variations regarding comp-lzo etc.</p><p>However, it works fine with --&gt;tap&lt;-- interface.</p><p>Below, I demonstrate the problem with tun using the most simple case -- no encryption, command line argument passing, point-to-point. It always gives the same error.</p><br /><p>tun case (doesn&#039;t work):<br />-------------------------------</p><p>root@OpenWrt:~# openvpn --dev tun0 --port 1111 --ifconfig 10.8.8.1 10.8.8.2 --verb 6</p><p>[root@alarmpi ~]# openvpn --dev tun1 --remote 10.7.2.1 1111 --nobind --ifconfig 10.8.8.2 10.8.8.1 --verb 6</p><br /><br /><p>tap case (works fine):<br />----------------------------</p><p>root@OpenWrt:~# openvpn --dev tap2 --port 1111 --ifconfig 10.8.8.1 255.255.255.0 --verb 6</p><p>[root@alarmpi ~]# openvpn --dev tap1 --remote 10.7.2.1 1111 --nobind --ifconfig 10.8.8.2 255.255.255.0 --verb 6</p><p>works fine -- can ping each other through tunnel.</p><br /><p>Thanks in advance for help -- in the meantime I (personally) can live with ethernet bridging.</p><br /><br /><br /><p>below the log output of the tun-case that doesn&#039;t work:<br />========================================</p><p>on the openwrt router:<br />~~~~~~~~~~~~~~~</p><p>BusyBox v1.22.1 (2014-09-20 22:01:35 CEST) built-in shell (ash)<br />Enter &#039;help&#039; for a list of built-in commands.</p><p>&nbsp; _______&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;________&nbsp; &nbsp; &nbsp; &nbsp; __<br /> |&nbsp; &nbsp; &nbsp; &nbsp;|.-----.-----.-----.|&nbsp; |&nbsp; |&nbsp; |.----.|&nbsp; |_<br /> |&nbsp; &nbsp;-&nbsp; &nbsp;||&nbsp; _&nbsp; |&nbsp; -__|&nbsp; &nbsp; &nbsp;||&nbsp; |&nbsp; |&nbsp; ||&nbsp; &nbsp;_||&nbsp; &nbsp;_|<br /> |_______||&nbsp; &nbsp;__|_____|__|__||________||__|&nbsp; |____|<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |__| W I R E L E S S&nbsp; &nbsp;F R E E D O M<br /> -----------------------------------------------------<br /> BARRIER BREAKER (14.07, r42625)<br /> -----------------------------------------------------<br />&nbsp; * 1/2 oz Galliano&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Pour all ingredients into<br />&nbsp; * 4 oz cold Coffee&nbsp; &nbsp; &nbsp; &nbsp; an irish coffee mug filled<br />&nbsp; * 1 1/2 oz Dark Rum&nbsp; &nbsp; &nbsp; &nbsp;with crushed ice. Stir.<br />&nbsp; * 2 tsp. Creme de Cacao<br /> -----------------------------------------------------<br />root@OpenWrt:~# openvpn --dev tun0 --port 1111 --ifconfig 10.8.8.1 10.8.8.2 --verb 6<br />Sun Nov&nbsp; 2 03:23:35 2014 us=600329 OpenVPN 2.3.4 mips-openwrt-linux-gnu [SSL (PolarSSL)] [LZO] [EPOLL] [MH] [IPv6] built on Sep 20 2014<br />Sun Nov&nbsp; 2 03:23:35 2014 us=601925 library versions: PolarSSL 1.3.8, LZO 2.08<br />Sun Nov&nbsp; 2 03:23:35 2014 us=604218 ******* WARNING *******: all encryption and authentication features disabled -- all data will be tunnelled as cleartext<br />Sun Nov&nbsp; 2 03:23:35 2014 us=605920 Socket Buffers: R=[163840-&gt;131072] S=[163840-&gt;131072]<br />Sun Nov&nbsp; 2 03:23:35 2014 us=626409 TUN/TAP device tun0 opened<br />Sun Nov&nbsp; 2 03:23:35 2014 us=627805 TUN/TAP TX queue length set to 100<br />Sun Nov&nbsp; 2 03:23:35 2014 us=629856 do_ifconfig, tt-&gt;ipv6=0, tt-&gt;did_ifconfig_ipv6_setup=0<br />Sun Nov&nbsp; 2 03:23:35 2014 us=631342 /sbin/ifconfig tun0 10.8.8.1 pointopoint 10.8.8.2 mtu 1500<br />Sun Nov&nbsp; 2 03:23:35 2014 us=650978 Data Channel MTU parms [ L:1500 D:1450 EF:0 EB:4 ET:0 EL:0 ]<br />Sun Nov&nbsp; 2 03:23:35 2014 us=651272 UDPv4 link local (bound): [undef]<br />Sun Nov&nbsp; 2 03:23:35 2014 us=651421 UDPv4 link remote: [undef]<br />Sun Nov&nbsp; 2 03:26:48 2014 us=409979 UDPv4 READ [17] from [AF_INET]10.7.2.233:47475:&nbsp; DATA len=17<br />Sun Nov&nbsp; 2 03:26:48 2014 us=410444 Peer Connection Initiated with [AF_INET]10.7.2.233:47475<br />Sun Nov&nbsp; 2 03:26:48 2014 us=410636 Initialization Sequence Completed<br />Sun Nov&nbsp; 2 03:26:48 2014 us=410910 write to TUN/TAP : Invalid argument (code=22)<br />Sun Nov&nbsp; 2 03:26:58 2014 us=92894 UDPv4 READ [17] from [AF_INET]10.7.2.233:47475:&nbsp; DATA len=17<br />Sun Nov&nbsp; 2 03:26:58 2014 us=93370 write to TUN/TAP : Invalid argument (code=22)<br />Sun Nov&nbsp; 2 03:27:08 2014 us=443443 UDPv4 READ [17] from [AF_INET]10.7.2.233:47475:&nbsp; DATA len=17<br />Sun Nov&nbsp; 2 03:27:08 2014 us=443914 write to TUN/TAP : Invalid argument (code=22)<br />Sun Nov&nbsp; 2 03:27:18 2014 us=745222 UDPv4 READ [17] from [AF_INET]10.7.2.233:47475:&nbsp; DATA len=17<br />Sun Nov&nbsp; 2 03:27:18 2014 us=745695 write to TUN/TAP : Invalid argument (code=22)<br />^CSun Nov&nbsp; 2 03:27:29 2014 us=201774 event_wait : Interrupted system call (code=4)<br />Sun Nov&nbsp; 2 03:27:29 2014 us=202057 TCP/UDP: Closing socket<br />Sun Nov&nbsp; 2 03:27:29 2014 us=202409 Closing TUN/TAP interface<br />Sun Nov&nbsp; 2 03:27:29 2014 us=202599 /sbin/ifconfig tun0 0.0.0.0<br />Sun Nov&nbsp; 2 03:27:29 2014 us=223184 SIGINT[hard,] received, process exiting<br />root@OpenWrt:~#</p><br /><p>and on a linux machine (in this case raspberry pi arch linux):<br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p><p>[root@alarmpi ~]# openvpn --dev tun1 --remote 10.7.2.1 1111 --nobind --ifconfig 10.8.8.2 10.8.8.1 --verb 6<br />[...]<br />Sat Nov&nbsp; 1 21:26:38 2014 us=339160 OpenVPN 2.3.4 armv6l-unknown-linux-gnueabihf [SSL (OpenSSL)] [LZO] [EPOLL] [MH] [IPv6] built on Jul&nbsp; 1 2014<br />Sat Nov&nbsp; 1 21:26:38 2014 us=340271 library versions: OpenSSL 1.0.1i 6 Aug 2014, LZO 2.08<br />Sat Nov&nbsp; 1 21:26:38 2014 us=341409 ******* WARNING *******: all encryption and authentication features disabled -- all data will be tunnelled as cleartext<br />Sat Nov&nbsp; 1 21:26:38 2014 us=342680 Socket Buffers: R=[163840-&gt;131072] S=[163840-&gt;131072]<br />Sat Nov&nbsp; 1 21:26:38 2014 us=352381 TUN/TAP device tun1 opened<br />Sat Nov&nbsp; 1 21:26:38 2014 us=353415 TUN/TAP TX queue length set to 100<br />Sat Nov&nbsp; 1 21:26:38 2014 us=354440 do_ifconfig, tt-&gt;ipv6=0, tt-&gt;did_ifconfig_ipv6_setup=0<br />Sat Nov&nbsp; 1 21:26:38 2014 us=355693 /usr/bin/ip link set dev tun1 up mtu 1500<br />Sat Nov&nbsp; 1 21:26:38 2014 us=381153 /usr/bin/ip addr add dev tun1 local 10.8.8.2 peer 10.8.8.1<br />Sat Nov&nbsp; 1 21:26:38 2014 us=406921 Data Channel MTU parms [ L:1500 D:1450 EF:0 EB:4 ET:0 EL:0 ]<br />Sat Nov&nbsp; 1 21:26:38 2014 us=408102 Local Options String: &#039;V4,dev-type tun,link-mtu 1500,tun-mtu 1500,proto UDPv4,ifconfig 10.8.8.1 10.8.8.2&#039;<br />Sat Nov&nbsp; 1 21:26:38 2014 us=408981 Expected Remote Options String: &#039;V4,dev-type tun,link-mtu 1500,tun-mtu 1500,proto UDPv4,ifconfig 10.8.8.2 10.8.8.1&#039;<br />Sat Nov&nbsp; 1 21:26:38 2014 us=410419 Local Options hash (VER=V4): &#039;39044484&#039;<br />Sat Nov&nbsp; 1 21:26:38 2014 us=411726 Expected Remote Options hash (VER=V4): &#039;d66f3583&#039;<br />Sat Nov&nbsp; 1 21:26:38 2014 us=412636 UDPv4 link local: [undef]<br />Sat Nov&nbsp; 1 21:26:38 2014 us=413675 UDPv4 link remote: [AF_INET]10.7.2.1:1111<br />Sat Nov&nbsp; 1 21:26:48 2014 us=450853 UDPv4 WRITE [17] to [AF_INET]10.7.2.1:1111:&nbsp; DATA len=17<br />Sat Nov&nbsp; 1 21:26:58 2014 us=133986 UDPv4 WRITE [17] to [AF_INET]10.7.2.1:1111:&nbsp; DATA len=17<br />Sat Nov&nbsp; 1 21:27:08 2014 us=484646 UDPv4 WRITE [17] to [AF_INET]10.7.2.1:1111:&nbsp; DATA len=17<br />Sat Nov&nbsp; 1 21:27:18 2014 us=786505 UDPv4 WRITE [17] to [AF_INET]10.7.2.1:1111:&nbsp; DATA len=17<br />^CSat Nov&nbsp; 1 21:27:27 2014 us=796287 event_wait : Interrupted system call (code=4)<br />Sat Nov&nbsp; 1 21:27:27 2014 us=796647 TCP/UDP: Closing socket<br />Sat Nov&nbsp; 1 21:27:27 2014 us=797062 Closing TUN/TAP interface<br />Sat Nov&nbsp; 1 21:27:27 2014 us=797348 /usr/bin/ip addr del dev tun1 local 10.8.8.2 peer 10.8.8.1<br />Sat Nov&nbsp; 1 21:27:27 2014 us=849823 SIGINT[hard,] received, process exiting<br />[root@alarmpi ~]#</p><br /><br /><br /><p>logs on openwrt router:<br />~~~~~~~~~~~~~~~</p><p>System log:<br />-----------<br />-----------</p><p>Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 0.000000] Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 0.000000] Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 0.000000] Writing ErrCtl register=00000000<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 0.000000] Readback ErrCtl register=00000000<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 0.000000] Memory: 28588k/32768k available (2369k kernel code, 4180k reserved, 621k data, 272k init, 0k highmem)<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 0.000000] SLUB: HWalign=32, Order=0-3, MinObjects=0, CPUs=1, Nodes=1<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 0.000000] NR_IRQS:51<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 0.050000] Calibrating delay loop... 366.18 BogoMIPS (lpj=1830912)<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 0.060000] pid_max: default: 32768 minimum: 301<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 0.060000] Mount-cache hash table entries: 512<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 0.070000] NET: Registered protocol family 16<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 0.070000] MIPS: machine is TP-LINK TL-WR841N/ND v9<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 0.490000] bio: create slab &lt;bio-0&gt; at 0<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 0.500000] Switching to clocksource MIPS<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 0.500000] NET: Registered protocol family 2<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 0.510000] TCP established hash table entries: 512 (order: 0, 4096 bytes)<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 0.510000] TCP bind hash table entries: 512 (order: -1, 2048 bytes)<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 0.520000] TCP: Hash tables configured (established 512 bind 512)<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 0.520000] TCP: reno registered<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 0.530000] UDP hash table entries: 256 (order: 0, 4096 bytes)<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 0.530000] UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 0.540000] NET: Registered protocol family 1<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.debug kernel: [&nbsp; &nbsp; 0.540000] PCI: CLS 0 bytes, default 32<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 0.560000] squashfs: version 4.0 (2009/01/31) Phillip Lougher<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 0.570000] jffs2: version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006 Red Hat, Inc.<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 0.580000] msgmni has been set to 55<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 0.580000] io scheduler noop registered<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 0.580000] io scheduler deadline registered (default)<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 0.590000] Serial: 8250/16550 driver, 16 ports, IRQ sharing enabled<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 0.620000] serial8250.0: ttyS0 at MMIO 0x18020000 (irq = 11) is a 16550A<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 0.630000] console [ttyS0] enabled, bootconsole disabled<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 0.640000] ath79-spi ath79-spi: master is unqueued, this is deprecated<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.warn kernel: [&nbsp; &nbsp; 0.650000] m25p80 spi0.0: found s25sl032p, expected m25p80<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 0.660000] m25p80 spi0.0: s25sl032p (4096 Kbytes)<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.notice kernel: [&nbsp; &nbsp; 0.660000] 5 tp-link partitions found on MTD device spi0.0<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.notice kernel: [&nbsp; &nbsp; 0.670000] Creating 5 MTD partitions on &quot;spi0.0&quot;:<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.notice kernel: [&nbsp; &nbsp; 0.670000] 0x000000000000-0x000000020000 : &quot;u-boot&quot;<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.notice kernel: [&nbsp; &nbsp; 0.680000] 0x000000020000-0x00000012e660 : &quot;kernel&quot;<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.warn kernel: [&nbsp; &nbsp; 0.690000] mtd: partition &quot;kernel&quot; must either start or end on erase block boundary or be smaller than an erase block -- forcing read-only<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.notice kernel: [&nbsp; &nbsp; 0.700000] 0x00000012e660-0x0000003f0000 : &quot;rootfs&quot;<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.warn kernel: [&nbsp; &nbsp; 0.710000] mtd: partition &quot;rootfs&quot; must either start or end on erase block boundary or be smaller than an erase block -- forcing read-only<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.notice kernel: [&nbsp; &nbsp; 0.720000] mtd: device 2 (rootfs) set to be root filesystem<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.notice kernel: [&nbsp; &nbsp; 0.730000] 1 squashfs-split partitions found on MTD device rootfs<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.notice kernel: [&nbsp; &nbsp; 0.730000] 0x000000340000-0x0000003f0000 : &quot;rootfs_data&quot;<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.notice kernel: [&nbsp; &nbsp; 0.740000] 0x0000003f0000-0x000000400000 : &quot;art&quot;<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.notice kernel: [&nbsp; &nbsp; 0.750000] 0x000000020000-0x0000003f0000 : &quot;firmware&quot;<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 0.780000] libphy: ag71xx_mdio: probed<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 1.330000] ag71xx-mdio.1: Found an AR934X built-in switch<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 2.370000] eth0: Atheros AG71xx at 0xba000000, irq 5, mode:GMII<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 2.930000] ag71xx ag71xx.0: connected to PHY at ag71xx-mdio.1:04 [uid=004dd042, driver=Generic PHY]<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 2.940000] eth1: Atheros AG71xx at 0xb9000000, irq 4, mode:MII<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 2.950000] TCP: cubic registered<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 2.950000] NET: Registered protocol family 17<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.notice kernel: [&nbsp; &nbsp; 2.960000] Bridge firewalling registered<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 2.960000] 8021q: 802.1Q VLAN Support v1.8<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 2.970000] VFS: Mounted root (squashfs filesystem) readonly on device 31:2.<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 2.980000] Freeing unused kernel memory: 272K (8034c000 - 80390000)<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 7.130000] eth0: link up (1000Mbps/Full duplex)<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.notice kernel: [&nbsp; &nbsp; 9.860000] jffs2: notice: (322) jffs2_build_xattr_subsystem: complete building xattr subsystem, 1 of xdatum (1 unchecked, 0 orphan) and 16 of xref (0 dead, 2 orphan) found.<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp; 9.900000] eth0: link down<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp;11.460000] NET: Registered protocol family 10<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp;11.470000] tun: Universal TUN/TAP device driver, 1.6<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp;11.480000] tun: (C) 1999-2004 Max Krasnyansky &lt;maxk@qualcomm.com&gt;<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp;11.490000] nf_conntrack version 0.5.0 (450 buckets, 1800 max)<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp;11.500000] ip6_tables: (C) 2000-2006 Netfilter Core Team<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp;11.520000] Loading modules backported from Linux version master-2014-05-22-0-gf2032ea<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp;11.530000] Backport generated by backports.git backports-20140320-37-g5c33da0<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp;11.540000] ip_tables: (C) 2000-2006 Netfilter Core Team<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp;11.610000] xt_time: kernel timezone is -0000<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp;11.650000] cfg80211: Calling CRDA to update world regulatory domain<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp;11.650000] cfg80211: World regulatory domain updated:<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp;11.660000] cfg80211:&nbsp; DFS Master region: unset<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp;11.660000] cfg80211:&nbsp; &nbsp;(start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp), (dfs_cac_time)<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp;11.670000] cfg80211:&nbsp; &nbsp;(2402000 KHz - 2472000 KHz @ 40000 KHz), (N/A, 2000 mBm), (N/A)<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp;11.680000] cfg80211:&nbsp; &nbsp;(2457000 KHz - 2482000 KHz @ 40000 KHz), (N/A, 2000 mBm), (N/A)<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp;11.690000] cfg80211:&nbsp; &nbsp;(2474000 KHz - 2494000 KHz @ 20000 KHz), (N/A, 2000 mBm), (N/A)<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp;11.700000] cfg80211:&nbsp; &nbsp;(5170000 KHz - 5250000 KHz @ 160000 KHz), (N/A, 2000 mBm), (N/A)<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp;11.710000] cfg80211:&nbsp; &nbsp;(5250000 KHz - 5330000 KHz @ 160000 KHz), (N/A, 2000 mBm), (0 s)<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp;11.710000] cfg80211:&nbsp; &nbsp;(5490000 KHz - 5730000 KHz @ 160000 KHz), (N/A, 2000 mBm), (0 s)<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp;11.720000] cfg80211:&nbsp; &nbsp;(5735000 KHz - 5835000 KHz @ 80000 KHz), (N/A, 2000 mBm), (N/A)<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp;11.730000] cfg80211:&nbsp; &nbsp;(57240000 KHz - 63720000 KHz @ 2160000 KHz), (N/A, 0 mBm), (N/A)<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp;11.800000] PPP generic driver version 2.4.2<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp;11.800000] NET: Registered protocol family 24<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.debug kernel: [&nbsp; &nbsp;11.860000] ath: EEPROM regdomain: 0x0<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.debug kernel: [&nbsp; &nbsp;11.860000] ath: EEPROM indicates default country code should be used<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.debug kernel: [&nbsp; &nbsp;11.860000] ath: doing EEPROM country-&gt;regdmn map search<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.debug kernel: [&nbsp; &nbsp;11.860000] ath: country maps to regdmn code: 0x3a<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.debug kernel: [&nbsp; &nbsp;11.860000] ath: Country alpha2 being used: US<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.debug kernel: [&nbsp; &nbsp;11.860000] ath: Regpair used: 0x3a<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.debug kernel: [&nbsp; &nbsp;11.870000] ieee80211 phy0: Selected rate control algorithm &#039;minstrel_ht&#039;<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp;11.880000] cfg80211: Calling CRDA for country: US<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp;11.890000] ieee80211 phy0: Atheros AR9531 Rev:1 mem=0xb8100000, irq=2<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp;11.910000] cfg80211: Regulatory domain changed to country: US<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp;11.910000] cfg80211:&nbsp; DFS Master region: FCC<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp;11.920000] cfg80211:&nbsp; &nbsp;(start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp), (dfs_cac_time)<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp;11.930000] cfg80211:&nbsp; &nbsp;(2402000 KHz - 2472000 KHz @ 40000 KHz), (N/A, 3000 mBm), (N/A)<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp;11.930000] cfg80211:&nbsp; &nbsp;(5170000 KHz - 5250000 KHz @ 80000 KHz), (N/A, 1700 mBm), (N/A)<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp;11.940000] cfg80211:&nbsp; &nbsp;(5250000 KHz - 5330000 KHz @ 80000 KHz), (N/A, 2300 mBm), (0 s)<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp;11.950000] cfg80211:&nbsp; &nbsp;(5735000 KHz - 5835000 KHz @ 80000 KHz), (N/A, 3000 mBm), (N/A)<br />Sun Nov&nbsp; 2 03:04:26 2014 kern.info kernel: [&nbsp; &nbsp;11.960000] cfg80211:&nbsp; &nbsp;(57240000 KHz - 63720000 KHz @ 2160000 KHz), (N/A, 4000 mBm), (N/A)<br />Sun Nov&nbsp; 2 03:04:29 2014 user.emerg syslog: &#039;radio0&#039; is disabled<br />Sun Nov&nbsp; 2 03:04:29 2014 user.emerg syslog: &#039;radio0&#039; is disabled<br />Sun Nov&nbsp; 2 03:04:31 2014 authpriv.info dropbear[758]: Not backgrounding<br />Sun Nov&nbsp; 2 03:04:32 2014 user.emerg syslog: setting up led WAN<br />Sun Nov&nbsp; 2 03:04:32 2014 user.emerg syslog: setting up led LAN1<br />Sun Nov&nbsp; 2 03:04:32 2014 user.emerg syslog: setting up led LAN2<br />Sun Nov&nbsp; 2 03:04:32 2014 user.emerg syslog: setting up led LAN3<br />Sun Nov&nbsp; 2 03:04:32 2014 user.emerg syslog: setting up led LAN4<br />Sun Nov&nbsp; 2 03:04:32 2014 user.emerg syslog: setting up led WLAN<br />Sun Nov&nbsp; 2 03:04:33 2014 user.emerg syslog: - init complete -<br />Sun Nov&nbsp; 2 03:04:34 2014 kern.info kernel: [&nbsp; &nbsp;22.260000] IPv6: ADDRCONF(NETDEV_UP): eth0: link is not ready<br />Sun Nov&nbsp; 2 03:04:34 2014 kern.info kernel: [&nbsp; &nbsp;22.260000] device eth0 entered promiscuous mode<br />Sun Nov&nbsp; 2 03:04:35 2014 daemon.notice netifd: Interface &#039;lan&#039; is enabled<br />Sun Nov&nbsp; 2 03:04:35 2014 daemon.notice netifd: Interface &#039;lan&#039; is setting up now<br />Sun Nov&nbsp; 2 03:04:35 2014 kern.info kernel: [&nbsp; &nbsp;22.280000] IPv6: ADDRCONF(NETDEV_UP): br-lan: link is not ready<br />Sun Nov&nbsp; 2 03:04:35 2014 daemon.notice netifd: Interface &#039;lan&#039; is now up<br />Sun Nov&nbsp; 2 03:04:35 2014 kern.info kernel: [&nbsp; &nbsp;22.300000] device tap0 entered promiscuous mode<br />Sun Nov&nbsp; 2 03:04:35 2014 kern.info kernel: [&nbsp; &nbsp;22.300000] br-lan: port 2(tap0) entered forwarding state<br />Sun Nov&nbsp; 2 03:04:35 2014 kern.info kernel: [&nbsp; &nbsp;22.310000] br-lan: port 2(tap0) entered forwarding state<br />Sun Nov&nbsp; 2 03:04:35 2014 kern.info kernel: [&nbsp; &nbsp;22.320000] IPv6: ADDRCONF(NETDEV_CHANGE): br-lan: link becomes ready<br />Sun Nov&nbsp; 2 03:04:35 2014 kern.info kernel: [&nbsp; &nbsp;22.330000] IPv6: ADDRCONF(NETDEV_UP): eth1: link is not ready<br />Sun Nov&nbsp; 2 03:04:35 2014 daemon.notice netifd: Interface &#039;loopback&#039; is enabled<br />Sun Nov&nbsp; 2 03:04:35 2014 daemon.notice netifd: Interface &#039;loopback&#039; is setting up now<br />Sun Nov&nbsp; 2 03:04:35 2014 daemon.notice netifd: Interface &#039;loopback&#039; is now up<br />Sun Nov&nbsp; 2 03:04:35 2014 daemon.notice netifd: Interface &#039;wan&#039; is enabled<br />Sun Nov&nbsp; 2 03:04:35 2014 daemon.notice netifd: Network device &#039;tap0&#039; link is up<br />Sun Nov&nbsp; 2 03:04:35 2014 daemon.notice netifd: Bridge &#039;br-lan&#039; link is up<br />Sun Nov&nbsp; 2 03:04:35 2014 daemon.notice netifd: Interface &#039;lan&#039; has link connectivity<br />Sun Nov&nbsp; 2 03:04:35 2014 daemon.notice netifd: Network device &#039;lo&#039; link is up<br />Sun Nov&nbsp; 2 03:04:35 2014 daemon.notice netifd: Interface &#039;loopback&#039; has link connectivity<br />Sun Nov&nbsp; 2 03:04:35 2014 user.notice firewall: Reloading firewall due to ifup of lan (br-lan)<br />Sun Nov&nbsp; 2 03:04:35 2014 kern.info kernel: [&nbsp; &nbsp;22.860000] eth0: link up (1000Mbps/Full duplex)<br />Sun Nov&nbsp; 2 03:04:35 2014 kern.info kernel: [&nbsp; &nbsp;22.860000] br-lan: port 1(eth0) entered forwarding state<br />Sun Nov&nbsp; 2 03:04:35 2014 kern.info kernel: [&nbsp; &nbsp;22.870000] br-lan: port 1(eth0) entered forwarding state<br />Sun Nov&nbsp; 2 03:04:35 2014 kern.info kernel: [&nbsp; &nbsp;22.870000] IPv6: ADDRCONF(NETDEV_CHANGE): eth0: link becomes ready<br />Sun Nov&nbsp; 2 03:04:35 2014 daemon.notice netifd: Network device &#039;eth0&#039; link is up<br />Sun Nov&nbsp; 2 03:04:37 2014 kern.info kernel: [&nbsp; &nbsp;24.310000] br-lan: port 2(tap0) entered forwarding state<br />Sun Nov&nbsp; 2 03:04:37 2014 kern.info kernel: [&nbsp; &nbsp;24.870000] br-lan: port 1(eth0) entered forwarding state<br />Sun Nov&nbsp; 2 03:04:37 2014 kern.info kernel: [&nbsp; &nbsp;25.210000] eth1: link up (100Mbps/Full duplex)<br />Sun Nov&nbsp; 2 03:04:37 2014 kern.info kernel: [&nbsp; &nbsp;25.210000] IPv6: ADDRCONF(NETDEV_CHANGE): eth1: link becomes ready<br />Sun Nov&nbsp; 2 03:04:37 2014 daemon.notice netifd: Network device &#039;eth1&#039; link is up<br />Sun Nov&nbsp; 2 03:04:37 2014 daemon.notice netifd: Interface &#039;wan&#039; has link connectivity<br />Sun Nov&nbsp; 2 03:04:37 2014 daemon.notice netifd: Interface &#039;wan&#039; is setting up now<br />Sun Nov&nbsp; 2 03:04:38 2014 daemon.notice netifd: wan (917): udhcpc (v1.22.1) started<br />Sun Nov&nbsp; 2 03:04:38 2014 daemon.notice netifd: wan (917): Sending discover...<br />Sun Nov&nbsp; 2 03:04:38 2014 daemon.notice netifd: wan (917): Sending select for 10.7.1.10...<br />Sun Nov&nbsp; 2 03:04:38 2014 daemon.notice netifd: wan (917): Lease of 10.7.1.10 obtained, lease time 268435455<br />Sun Nov&nbsp; 2 03:04:38 2014 daemon.notice netifd: Interface &#039;wan6&#039; is enabled<br />Sun Nov&nbsp; 2 03:04:38 2014 daemon.notice netifd: Network alias &#039;eth1&#039; link is up<br />Sun Nov&nbsp; 2 03:04:38 2014 daemon.notice netifd: Interface &#039;wan6&#039; has link connectivity<br />Sun Nov&nbsp; 2 03:04:38 2014 daemon.notice netifd: Interface &#039;wan6&#039; is setting up now<br />Sun Nov&nbsp; 2 03:04:38 2014 daemon.notice netifd: Interface &#039;wan&#039; is now up<br />Sun Nov&nbsp; 2 03:04:38 2014 daemon.notice odhcp6c[931]: (re)starting transaction on eth1<br />Sun Nov&nbsp; 2 03:04:38 2014 daemon.notice odhcp6c[931]: Starting SOLICIT transaction (timeout 4294967295s, max rc 0)<br />Sun Nov&nbsp; 2 03:04:39 2014 daemon.info dnsmasq[948]: started, version 2.71 cachesize 150<br />Sun Nov&nbsp; 2 03:04:39 2014 daemon.info dnsmasq[948]: compile time options: IPv6 GNU-getopt no-DBus no-i18n no-IDN DHCP no-DHCPv6 no-Lua TFTP no-conntrack no-ipset no-auth no-DNSSEC<br />Sun Nov&nbsp; 2 03:04:39 2014 daemon.info dnsmasq-dhcp[948]: DHCP, IP range 10.7.2.100 -- 10.7.2.249, lease time 12h<br />Sun Nov&nbsp; 2 03:04:39 2014 daemon.info dnsmasq[948]: using local addresses only for domain lan<br />Sun Nov&nbsp; 2 03:04:39 2014 daemon.info dnsmasq[948]: reading /tmp/resolv.conf.auto<br />Sun Nov&nbsp; 2 03:04:39 2014 daemon.info dnsmasq[948]: using local addresses only for domain lan<br />Sun Nov&nbsp; 2 03:04:39 2014 daemon.info dnsmasq[948]: using nameserver 10.7.1.1#53<br />Sun Nov&nbsp; 2 03:04:39 2014 daemon.info dnsmasq[948]: read /etc/hosts - 1 addresses<br />Sun Nov&nbsp; 2 03:04:39 2014 daemon.info dnsmasq[948]: read /tmp/hosts/dhcp - 1 addresses<br />Sun Nov&nbsp; 2 03:04:39 2014 daemon.info dnsmasq-dhcp[948]: read /etc/ethers - 0 addresses<br />Sun Nov&nbsp; 2 03:04:39 2014 daemon.info dnsmasq[948]: exiting on receipt of SIGTERM<br />Sun Nov&nbsp; 2 03:04:39 2014 daemon.info dnsmasq[1002]: started, version 2.71 cachesize 150<br />Sun Nov&nbsp; 2 03:04:39 2014 daemon.info dnsmasq[1002]: compile time options: IPv6 GNU-getopt no-DBus no-i18n no-IDN DHCP no-DHCPv6 no-Lua TFTP no-conntrack no-ipset no-auth no-DNSSEC<br />Sun Nov&nbsp; 2 03:04:39 2014 daemon.info dnsmasq-dhcp[1002]: DHCP, IP range 10.7.2.100 -- 10.7.2.249, lease time 12h<br />Sun Nov&nbsp; 2 03:04:39 2014 daemon.info dnsmasq[1002]: using local addresses only for domain lan<br />Sun Nov&nbsp; 2 03:04:39 2014 daemon.info dnsmasq[1002]: reading /tmp/resolv.conf.auto<br />Sun Nov&nbsp; 2 03:04:39 2014 daemon.info dnsmasq[1002]: using local addresses only for domain lan<br />Sun Nov&nbsp; 2 03:04:39 2014 daemon.info dnsmasq[1002]: using nameserver 10.7.1.1#53<br />Sun Nov&nbsp; 2 03:04:39 2014 daemon.info dnsmasq[1002]: read /etc/hosts - 1 addresses<br />Sun Nov&nbsp; 2 03:04:39 2014 daemon.info dnsmasq[1002]: read /tmp/hosts/dhcp - 1 addresses<br />Sun Nov&nbsp; 2 03:04:39 2014 daemon.info dnsmasq-dhcp[1002]: read /etc/ethers - 0 addresses<br />Sun Nov&nbsp; 2 03:04:40 2014 user.notice firewall: Reloading firewall due to ifup of wan (eth1)<br />Sun Nov&nbsp; 2 03:04:40 2014 daemon.info dnsmasq-dhcp[1002]: DHCPDISCOVER(br-lan) b8:27:eb:a5:07:99<br />Sun Nov&nbsp; 2 03:04:40 2014 daemon.info dnsmasq-dhcp[1002]: DHCPOFFER(br-lan) 10.7.2.233 b8:27:eb:a5:07:99<br />Sun Nov&nbsp; 2 03:04:40 2014 daemon.info dnsmasq-dhcp[1002]: DHCPREQUEST(br-lan) 10.7.2.233 b8:27:eb:a5:07:99<br />Sun Nov&nbsp; 2 03:04:40 2014 daemon.info dnsmasq-dhcp[1002]: DHCPACK(br-lan) 10.7.2.233 b8:27:eb:a5:07:99 alarmpi<br />Sun Nov&nbsp; 2 03:17:53 2014 daemon.info dnsmasq-dhcp[1002]: DHCPREQUEST(br-lan) 10.7.2.102 00:ff:d1:d6:bf:2f<br />Sun Nov&nbsp; 2 03:17:53 2014 daemon.info dnsmasq-dhcp[1002]: DHCPACK(br-lan) 10.7.2.102 00:ff:d1:d6:bf:2f LAPTOP<br />Sun Nov&nbsp; 2 03:19:08 2014 daemon.info dnsmasq-dhcp[1002]: DHCPREQUEST(br-lan) 10.7.2.102 00:ff:d1:d6:bf:2f<br />Sun Nov&nbsp; 2 03:19:08 2014 daemon.info dnsmasq-dhcp[1002]: DHCPACK(br-lan) 10.7.2.102 00:ff:d1:d6:bf:2f LAPTOP<br />Sun Nov&nbsp; 2 03:21:27 2014 authpriv.info dropbear[1064]: Child connection from 10.7.2.102:1441<br />Sun Nov&nbsp; 2 03:21:43 2014 authpriv.notice dropbear[1064]: Password auth succeeded for &#039;root&#039; from 10.7.2.102:1441</p><br /><br /><p>Kernel log:<br />-----------<br />-----------</p><p>[&nbsp; &nbsp; 0.000000] Linux version 3.10.49 (bb@builder1) (gcc version 4.8.3 (OpenWrt/Linaro GCC 4.8-2014.04 r42625) ) #3 Wed Oct 1 14:00:51 CEST 2014<br />[&nbsp; &nbsp; 0.000000] MyLoader: sysp=ffffffff, boardp=7fffffff, parts=fffffff5<br />[&nbsp; &nbsp; 0.000000] bootconsole [early0] enabled<br />[&nbsp; &nbsp; 0.000000] CPU revision is: 00019374 (MIPS 24Kc)<br />[&nbsp; &nbsp; 0.000000] SoC: Qualcomm Atheros QCA9533 rev 1<br />[&nbsp; &nbsp; 0.000000] Clocks: CPU:550.000MHz, DDR:398.193MHz, AHB:199.096MHz, Ref:25.000MHz<br />[&nbsp; &nbsp; 0.000000] Determined physical RAM map:<br />[&nbsp; &nbsp; 0.000000]&nbsp; memory: 02000000 @ 00000000 (usable)<br />[&nbsp; &nbsp; 0.000000] Initrd not found or empty - disabling initrd<br />[&nbsp; &nbsp; 0.000000] Zone ranges:<br />[&nbsp; &nbsp; 0.000000]&nbsp; &nbsp;Normal&nbsp; &nbsp;[mem 0x00000000-0x01ffffff]<br />[&nbsp; &nbsp; 0.000000] Movable zone start for each node<br />[&nbsp; &nbsp; 0.000000] Early memory node ranges<br />[&nbsp; &nbsp; 0.000000]&nbsp; &nbsp;node&nbsp; &nbsp;0: [mem 0x00000000-0x01ffffff]<br />[&nbsp; &nbsp; 0.000000] On node 0 totalpages: 8192<br />[&nbsp; &nbsp; 0.000000] free_area_init_node: node 0, pgdat 80334b60, node_mem_map 81000000<br />[&nbsp; &nbsp; 0.000000]&nbsp; &nbsp;Normal zone: 64 pages used for memmap<br />[&nbsp; &nbsp; 0.000000]&nbsp; &nbsp;Normal zone: 0 pages reserved<br />[&nbsp; &nbsp; 0.000000]&nbsp; &nbsp;Normal zone: 8192 pages, LIFO batch:0<br />[&nbsp; &nbsp; 0.000000] Primary instruction cache 64kB, VIPT, 4-way, linesize 32 bytes.<br />[&nbsp; &nbsp; 0.000000] Primary data cache 32kB, 4-way, VIPT, cache aliases, linesize 32 bytes<br />[&nbsp; &nbsp; 0.000000] pcpu-alloc: s0 r0 d32768 u32768 alloc=1*32768<br />[&nbsp; &nbsp; 0.000000] pcpu-alloc: [0] 0<br />[&nbsp; &nbsp; 0.000000] Built 1 zonelists in Zone order, mobility grouping on.&nbsp; Total pages: 8128<br />[&nbsp; &nbsp; 0.000000] Kernel command line:&nbsp; board=TL-WR841N-v9 console=ttyS0,115200 rootfstype=squashfs,jffs2 noinitrd<br />[&nbsp; &nbsp; 0.000000] PID hash table entries: 128 (order: -3, 512 bytes)<br />[&nbsp; &nbsp; 0.000000] Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)<br />[&nbsp; &nbsp; 0.000000] Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)<br />[&nbsp; &nbsp; 0.000000] Writing ErrCtl register=00000000<br />[&nbsp; &nbsp; 0.000000] Readback ErrCtl register=00000000<br />[&nbsp; &nbsp; 0.000000] Memory: 28588k/32768k available (2369k kernel code, 4180k reserved, 621k data, 272k init, 0k highmem)<br />[&nbsp; &nbsp; 0.000000] SLUB: HWalign=32, Order=0-3, MinObjects=0, CPUs=1, Nodes=1<br />[&nbsp; &nbsp; 0.000000] NR_IRQS:51<br />[&nbsp; &nbsp; 0.050000] Calibrating delay loop... 366.18 BogoMIPS (lpj=1830912)<br />[&nbsp; &nbsp; 0.060000] pid_max: default: 32768 minimum: 301<br />[&nbsp; &nbsp; 0.060000] Mount-cache hash table entries: 512<br />[&nbsp; &nbsp; 0.070000] NET: Registered protocol family 16<br />[&nbsp; &nbsp; 0.070000] MIPS: machine is TP-LINK TL-WR841N/ND v9<br />[&nbsp; &nbsp; 0.490000] bio: create slab &lt;bio-0&gt; at 0<br />[&nbsp; &nbsp; 0.500000] Switching to clocksource MIPS<br />[&nbsp; &nbsp; 0.500000] NET: Registered protocol family 2<br />[&nbsp; &nbsp; 0.510000] TCP established hash table entries: 512 (order: 0, 4096 bytes)<br />[&nbsp; &nbsp; 0.510000] TCP bind hash table entries: 512 (order: -1, 2048 bytes)<br />[&nbsp; &nbsp; 0.520000] TCP: Hash tables configured (established 512 bind 512)<br />[&nbsp; &nbsp; 0.520000] TCP: reno registered<br />[&nbsp; &nbsp; 0.530000] UDP hash table entries: 256 (order: 0, 4096 bytes)<br />[&nbsp; &nbsp; 0.530000] UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)<br />[&nbsp; &nbsp; 0.540000] NET: Registered protocol family 1<br />[&nbsp; &nbsp; 0.540000] PCI: CLS 0 bytes, default 32<br />[&nbsp; &nbsp; 0.560000] squashfs: version 4.0 (2009/01/31) Phillip Lougher<br />[&nbsp; &nbsp; 0.570000] jffs2: version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006 Red Hat, Inc.<br />[&nbsp; &nbsp; 0.580000] msgmni has been set to 55<br />[&nbsp; &nbsp; 0.580000] io scheduler noop registered<br />[&nbsp; &nbsp; 0.580000] io scheduler deadline registered (default)<br />[&nbsp; &nbsp; 0.590000] Serial: 8250/16550 driver, 16 ports, IRQ sharing enabled<br />[&nbsp; &nbsp; 0.620000] serial8250.0: ttyS0 at MMIO 0x18020000 (irq = 11) is a 16550A<br />[&nbsp; &nbsp; 0.630000] console [ttyS0] enabled, bootconsole disabled<br />[&nbsp; &nbsp; 0.640000] ath79-spi ath79-spi: master is unqueued, this is deprecated<br />[&nbsp; &nbsp; 0.650000] m25p80 spi0.0: found s25sl032p, expected m25p80<br />[&nbsp; &nbsp; 0.660000] m25p80 spi0.0: s25sl032p (4096 Kbytes)<br />[&nbsp; &nbsp; 0.660000] 5 tp-link partitions found on MTD device spi0.0<br />[&nbsp; &nbsp; 0.670000] Creating 5 MTD partitions on &quot;spi0.0&quot;:<br />[&nbsp; &nbsp; 0.670000] 0x000000000000-0x000000020000 : &quot;u-boot&quot;<br />[&nbsp; &nbsp; 0.680000] 0x000000020000-0x00000012e660 : &quot;kernel&quot;<br />[&nbsp; &nbsp; 0.690000] mtd: partition &quot;kernel&quot; must either start or end on erase block boundary or be smaller than an erase block -- forcing read-only<br />[&nbsp; &nbsp; 0.700000] 0x00000012e660-0x0000003f0000 : &quot;rootfs&quot;<br />[&nbsp; &nbsp; 0.710000] mtd: partition &quot;rootfs&quot; must either start or end on erase block boundary or be smaller than an erase block -- forcing read-only<br />[&nbsp; &nbsp; 0.720000] mtd: device 2 (rootfs) set to be root filesystem<br />[&nbsp; &nbsp; 0.730000] 1 squashfs-split partitions found on MTD device rootfs<br />[&nbsp; &nbsp; 0.730000] 0x000000340000-0x0000003f0000 : &quot;rootfs_data&quot;<br />[&nbsp; &nbsp; 0.740000] 0x0000003f0000-0x000000400000 : &quot;art&quot;<br />[&nbsp; &nbsp; 0.750000] 0x000000020000-0x0000003f0000 : &quot;firmware&quot;<br />[&nbsp; &nbsp; 0.780000] libphy: ag71xx_mdio: probed<br />[&nbsp; &nbsp; 1.330000] ag71xx-mdio.1: Found an AR934X built-in switch<br />[&nbsp; &nbsp; 2.370000] eth0: Atheros AG71xx at 0xba000000, irq 5, mode:GMII<br />[&nbsp; &nbsp; 2.930000] ag71xx ag71xx.0: connected to PHY at ag71xx-mdio.1:04 [uid=004dd042, driver=Generic PHY]<br />[&nbsp; &nbsp; 2.940000] eth1: Atheros AG71xx at 0xb9000000, irq 4, mode:MII<br />[&nbsp; &nbsp; 2.950000] TCP: cubic registered<br />[&nbsp; &nbsp; 2.950000] NET: Registered protocol family 17<br />[&nbsp; &nbsp; 2.960000] Bridge firewalling registered<br />[&nbsp; &nbsp; 2.960000] 8021q: 802.1Q VLAN Support v1.8<br />[&nbsp; &nbsp; 2.970000] VFS: Mounted root (squashfs filesystem) readonly on device 31:2.<br />[&nbsp; &nbsp; 2.980000] Freeing unused kernel memory: 272K (8034c000 - 80390000)<br />[&nbsp; &nbsp; 7.130000] eth0: link up (1000Mbps/Full duplex)<br />[&nbsp; &nbsp; 9.860000] jffs2: notice: (322) jffs2_build_xattr_subsystem: complete building xattr subsystem, 1 of xdatum (1 unchecked, 0 orphan) and 16 of xref (0 dead, 2 orphan) found.<br />[&nbsp; &nbsp; 9.900000] eth0: link down<br />[&nbsp; &nbsp;11.460000] NET: Registered protocol family 10<br />[&nbsp; &nbsp;11.470000] tun: Universal TUN/TAP device driver, 1.6<br />[&nbsp; &nbsp;11.480000] tun: (C) 1999-2004 Max Krasnyansky &lt;maxk@qualcomm.com&gt;<br />[&nbsp; &nbsp;11.490000] nf_conntrack version 0.5.0 (450 buckets, 1800 max)<br />[&nbsp; &nbsp;11.500000] ip6_tables: (C) 2000-2006 Netfilter Core Team<br />[&nbsp; &nbsp;11.520000] Loading modules backported from Linux version master-2014-05-22-0-gf2032ea<br />[&nbsp; &nbsp;11.530000] Backport generated by backports.git backports-20140320-37-g5c33da0<br />[&nbsp; &nbsp;11.540000] ip_tables: (C) 2000-2006 Netfilter Core Team<br />[&nbsp; &nbsp;11.610000] xt_time: kernel timezone is -0000<br />[&nbsp; &nbsp;11.650000] cfg80211: Calling CRDA to update world regulatory domain<br />[&nbsp; &nbsp;11.650000] cfg80211: World regulatory domain updated:<br />[&nbsp; &nbsp;11.660000] cfg80211:&nbsp; DFS Master region: unset<br />[&nbsp; &nbsp;11.660000] cfg80211:&nbsp; &nbsp;(start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp), (dfs_cac_time)<br />[&nbsp; &nbsp;11.670000] cfg80211:&nbsp; &nbsp;(2402000 KHz - 2472000 KHz @ 40000 KHz), (N/A, 2000 mBm), (N/A)<br />[&nbsp; &nbsp;11.680000] cfg80211:&nbsp; &nbsp;(2457000 KHz - 2482000 KHz @ 40000 KHz), (N/A, 2000 mBm), (N/A)<br />[&nbsp; &nbsp;11.690000] cfg80211:&nbsp; &nbsp;(2474000 KHz - 2494000 KHz @ 20000 KHz), (N/A, 2000 mBm), (N/A)<br />[&nbsp; &nbsp;11.700000] cfg80211:&nbsp; &nbsp;(5170000 KHz - 5250000 KHz @ 160000 KHz), (N/A, 2000 mBm), (N/A)<br />[&nbsp; &nbsp;11.710000] cfg80211:&nbsp; &nbsp;(5250000 KHz - 5330000 KHz @ 160000 KHz), (N/A, 2000 mBm), (0 s)<br />[&nbsp; &nbsp;11.710000] cfg80211:&nbsp; &nbsp;(5490000 KHz - 5730000 KHz @ 160000 KHz), (N/A, 2000 mBm), (0 s)<br />[&nbsp; &nbsp;11.720000] cfg80211:&nbsp; &nbsp;(5735000 KHz - 5835000 KHz @ 80000 KHz), (N/A, 2000 mBm), (N/A)<br />[&nbsp; &nbsp;11.730000] cfg80211:&nbsp; &nbsp;(57240000 KHz - 63720000 KHz @ 2160000 KHz), (N/A, 0 mBm), (N/A)<br />[&nbsp; &nbsp;11.800000] PPP generic driver version 2.4.2<br />[&nbsp; &nbsp;11.800000] NET: Registered protocol family 24<br />[&nbsp; &nbsp;11.860000] ath: EEPROM regdomain: 0x0<br />[&nbsp; &nbsp;11.860000] ath: EEPROM indicates default country code should be used<br />[&nbsp; &nbsp;11.860000] ath: doing EEPROM country-&gt;regdmn map search<br />[&nbsp; &nbsp;11.860000] ath: country maps to regdmn code: 0x3a<br />[&nbsp; &nbsp;11.860000] ath: Country alpha2 being used: US<br />[&nbsp; &nbsp;11.860000] ath: Regpair used: 0x3a<br />[&nbsp; &nbsp;11.870000] ieee80211 phy0: Selected rate control algorithm &#039;minstrel_ht&#039;<br />[&nbsp; &nbsp;11.880000] cfg80211: Calling CRDA for country: US<br />[&nbsp; &nbsp;11.890000] ieee80211 phy0: Atheros AR9531 Rev:1 mem=0xb8100000, irq=2<br />[&nbsp; &nbsp;11.910000] cfg80211: Regulatory domain changed to country: US<br />[&nbsp; &nbsp;11.910000] cfg80211:&nbsp; DFS Master region: FCC<br />[&nbsp; &nbsp;11.920000] cfg80211:&nbsp; &nbsp;(start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp), (dfs_cac_time)<br />[&nbsp; &nbsp;11.930000] cfg80211:&nbsp; &nbsp;(2402000 KHz - 2472000 KHz @ 40000 KHz), (N/A, 3000 mBm), (N/A)<br />[&nbsp; &nbsp;11.930000] cfg80211:&nbsp; &nbsp;(5170000 KHz - 5250000 KHz @ 80000 KHz), (N/A, 1700 mBm), (N/A)<br />[&nbsp; &nbsp;11.940000] cfg80211:&nbsp; &nbsp;(5250000 KHz - 5330000 KHz @ 80000 KHz), (N/A, 2300 mBm), (0 s)<br />[&nbsp; &nbsp;11.950000] cfg80211:&nbsp; &nbsp;(5735000 KHz - 5835000 KHz @ 80000 KHz), (N/A, 3000 mBm), (N/A)<br />[&nbsp; &nbsp;11.960000] cfg80211:&nbsp; &nbsp;(57240000 KHz - 63720000 KHz @ 2160000 KHz), (N/A, 4000 mBm), (N/A)<br />[&nbsp; &nbsp;22.260000] IPv6: ADDRCONF(NETDEV_UP): eth0: link is not ready<br />[&nbsp; &nbsp;22.260000] device eth0 entered promiscuous mode<br />[&nbsp; &nbsp;22.280000] IPv6: ADDRCONF(NETDEV_UP): br-lan: link is not ready<br />[&nbsp; &nbsp;22.300000] device tap0 entered promiscuous mode<br />[&nbsp; &nbsp;22.300000] br-lan: port 2(tap0) entered forwarding state<br />[&nbsp; &nbsp;22.310000] br-lan: port 2(tap0) entered forwarding state<br />[&nbsp; &nbsp;22.320000] IPv6: ADDRCONF(NETDEV_CHANGE): br-lan: link becomes ready<br />[&nbsp; &nbsp;22.330000] IPv6: ADDRCONF(NETDEV_UP): eth1: link is not ready<br />[&nbsp; &nbsp;22.860000] eth0: link up (1000Mbps/Full duplex)<br />[&nbsp; &nbsp;22.860000] br-lan: port 1(eth0) entered forwarding state<br />[&nbsp; &nbsp;22.870000] br-lan: port 1(eth0) entered forwarding state<br />[&nbsp; &nbsp;22.870000] IPv6: ADDRCONF(NETDEV_CHANGE): eth0: link becomes ready<br />[&nbsp; &nbsp;24.310000] br-lan: port 2(tap0) entered forwarding state<br />[&nbsp; &nbsp;24.870000] br-lan: port 1(eth0) entered forwarding state<br />[&nbsp; &nbsp;25.210000] eth1: link up (100Mbps/Full duplex)<br />[&nbsp; &nbsp;25.210000] IPv6: ADDRCONF(NETDEV_CHANGE): eth1: link becomes ready</p><p>----------------------------------------<br />----------------------------------------</p>											<p class="post-edited">(Last edited by <strong>dhfffile</strong> on 2 Nov 2014, 06:07)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p252835">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">metai</div>
					<div class="post-datetime">
						2 Nov 2014, 14:21					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><p>Sun Nov&nbsp; 2 03:26:58 2014 us=93370 write to TUN/TAP : Invalid argument (code=22)</p></blockquote></div><p>I did run into the same problem after switching from AA to BB, and consequently to a newer OpenVPN version, which was a bit curious because I didn&#039;t change my OpenVPN config files (<em>native</em> config files no less).</p><p>I don&#039;t really remember what exactly was off for the LZO compression configuration. If memory serves right, the problem was that one side was doing LZO compression and the other wasn&#039;t, and the default behaviour (&quot;adaptive&quot; LZO compression) was not working quite right between OpenVPN 2.1, 2.2 and 2.3 servers/clients, but I may be misremembering that.</p><p>At any rate, the problem disappeared after explicitly setting &quot;lzo-comp&quot; (i.e. &quot;lzo-comp yes&quot;) in both server and client configurations. I&#039;d guess explicitly setting it to &quot;no&quot; on both sides would do, too.</p>											<p class="post-edited">(Last edited by <strong>metai</strong> on 2 Nov 2014, 17:58)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p252862">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">dhfffile</div>
					<div class="post-datetime">
						2 Nov 2014, 17:29					</div>
				</div>
				<div class="post-content content">
					<p>Hello metai,</p><p>thank you very much for the answer.</p><p>The problem seems to be really persistent ... in the test below you can see that LZO-compression was initialized on both the OpenWrt-router and the other Linux machine. Another test with LZ0 disabled on both machines gave the same result ...</p><p>Regards</p><br /><br /><p>root@OpenWrt:~# cat /tmp/openvpn.log<br />Sun Nov&nbsp; 2 14:58:26 2014 us=424358 OpenVPN 2.3.4 mips-openwrt-linux-gnu [SSL (PolarSSL)] [LZO] [EPOLL] [MH] [IPv6] built on Sep 20 2014<br />Sun Nov&nbsp; 2 14:58:26 2014 us=424710 library versions: PolarSSL 1.3.8, LZO 2.08<br />Sun Nov&nbsp; 2 14:58:26 2014 us=425262 ******* WARNING *******: all encryption and authentication features disabled -- all data will be tunnelled as cleartext<br />Sun Nov&nbsp; 2 14:58:26 2014 us=425496 LZO compression initialized<br />Sun Nov&nbsp; 2 14:58:26 2014 us=425902 Socket Buffers: R=[163840-&gt;131072] S=[163840-&gt;131072]<br />Sun Nov&nbsp; 2 14:58:26 2014 us=428573 TUN/TAP device tun2 opened<br />Sun Nov&nbsp; 2 14:58:26 2014 us=428860 TUN/TAP TX queue length set to 100<br />Sun Nov&nbsp; 2 14:58:26 2014 us=429053 do_ifconfig, tt-&gt;ipv6=0, tt-&gt;did_ifconfig_ipv6_setup=0<br />Sun Nov&nbsp; 2 14:58:26 2014 us=429401 /sbin/ifconfig tun2 10.8.8.1 pointopoint 10.8.8.2 mtu 1500<br />Sun Nov&nbsp; 2 14:58:26 2014 us=436299 Data Channel MTU parms [ L:1501 D:1450 EF:1 EB:135 ET:0 EL:0 AF:14/1 ]<br />Sun Nov&nbsp; 2 14:58:26 2014 us=436564 UDPv4 link local (bound): [undef]<br />Sun Nov&nbsp; 2 14:58:26 2014 us=436696 UDPv4 link remote: [undef]<br />Sun Nov&nbsp; 2 15:04:06 2014 us=882407 UDPv4 READ [18] from [AF_INET]10.4.1.145:48268:&nbsp; DATA len=18<br />Sun Nov&nbsp; 2 15:04:06 2014 us=883032 Peer Connection Initiated with [AF_INET]10.4.1.145:48268<br />Sun Nov&nbsp; 2 15:04:06 2014 us=883251 Initialization Sequence Completed<br />Sun Nov&nbsp; 2 15:04:06 2014 us=883519 write to TUN/TAP : Invalid argument (code=22)<br />Sun Nov&nbsp; 2 15:04:16 2014 us=991866 UDPv4 READ [18] from [AF_INET]10.4.1.145:48268:&nbsp; DATA len=18<br />Sun Nov&nbsp; 2 15:04:16 2014 us=992493 write to TUN/TAP : Invalid argument (code=22)<br />root@OpenWrt:~# cat /etc/config/openvpn</p><p>config openvpn &#039;myvpn&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option enabled &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option config &#039;/etc/openvpn/openvpntest.conf&#039;</p><p>root@OpenWrt:~# cat /etc/openvpn/openvpntest.conf<br />dev tun2<br />ifconfig 10.8.8.1 10.8.8.2<br />log /tmp/openvpn.log<br />verb 6<br />comp-lzo<br />root@OpenWrt:~# cat /etc/config/network</p><p>config interface &#039;loopback&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;lo&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;127.0.0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.0.0.0&#039;</p><p>config globals &#039;globals&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ula_prefix &#039;fdd4:d807:cf83::/48&#039;</p><p>config interface &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option force_link &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option type &#039;bridge&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ip6assign &#039;60&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option _orig_ifname &#039;eth0 radio0.network1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option _orig_bridge &#039;true&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth0 tap0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;10.4.1.2&#039;</p><p>config interface &#039;wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;dhcp&#039;</p><p>config interface &#039;wan6&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;@wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;dhcpv6&#039;</p><p>config switch<br />&nbsp; &nbsp; &nbsp; &nbsp; option name &#039;switch0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option reset &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option enable_vlan &#039;1&#039;</p><p>config switch_vlan<br />&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;switch0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option vlan &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ports &#039;0 1 2 3 4&#039;</p><p>config interface &#039;vpn0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option _orig_ifname &#039;tun2&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option _orig_bridge &#039;false&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;tun2&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;</p><p>root@OpenWrt:~# cat /etc/config/firewall</p><p>config defaults<br />&nbsp; &nbsp; &nbsp; &nbsp; option syn_flood &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option input &#039;ACCEPT&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option output &#039;ACCEPT&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option forward &#039;REJECT&#039;</p><p>config zone<br />&nbsp; &nbsp; &nbsp; &nbsp; option name &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; list network &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option input &#039;ACCEPT&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option output &#039;ACCEPT&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option forward &#039;ACCEPT&#039;</p><p>config zone<br />&nbsp; &nbsp; &nbsp; &nbsp; option name &#039;wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; list network &#039;wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; list network &#039;wan6&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option input &#039;REJECT&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option output &#039;ACCEPT&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option forward &#039;REJECT&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option masq &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option mtu_fix &#039;1&#039;</p><p>config forwarding<br />&nbsp; &nbsp; &nbsp; &nbsp; option src &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option dest &#039;wan&#039;</p><p>config rule<br />&nbsp; &nbsp; &nbsp; &nbsp; option name &#039;Allow-DHCP-Renew&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option src &#039;wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;udp&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option dest_port &#039;68&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option target &#039;ACCEPT&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option family &#039;ipv4&#039;</p><p>config rule<br />&nbsp; &nbsp; &nbsp; &nbsp; option name &#039;Allow-Ping&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option src &#039;wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;icmp&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option icmp_type &#039;echo-request&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option family &#039;ipv4&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option target &#039;ACCEPT&#039;</p><p>config rule<br />&nbsp; &nbsp; &nbsp; &nbsp; option name &#039;Allow-DHCPv6&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option src &#039;wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;udp&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option src_ip &#039;fe80::/10&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option src_port &#039;547&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option dest_ip &#039;fe80::/10&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option dest_port &#039;546&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option family &#039;ipv6&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option target &#039;ACCEPT&#039;</p><p>config rule<br />&nbsp; &nbsp; &nbsp; &nbsp; option name &#039;Allow-ICMPv6-Input&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option src &#039;wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;icmp&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type &#039;echo-request&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type &#039;echo-reply&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type &#039;destination-unreachable&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type &#039;packet-too-big&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type &#039;time-exceeded&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type &#039;bad-header&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type &#039;unknown-header-type&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type &#039;router-solicitation&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type &#039;neighbour-solicitation&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type &#039;router-advertisement&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type &#039;neighbour-advertisement&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option limit &#039;1000/sec&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option family &#039;ipv6&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option target &#039;ACCEPT&#039;</p><p>config rule<br />&nbsp; &nbsp; &nbsp; &nbsp; option name &#039;Allow-ICMPv6-Forward&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option src &#039;wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option dest &#039;*&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;icmp&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type &#039;echo-request&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type &#039;echo-reply&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type &#039;destination-unreachable&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type &#039;packet-too-big&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type &#039;time-exceeded&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type &#039;bad-header&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; list icmp_type &#039;unknown-header-type&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option limit &#039;1000/sec&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option family &#039;ipv6&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option target &#039;ACCEPT&#039;</p><p>config include<br />&nbsp; &nbsp; &nbsp; &nbsp; option path &#039;/etc/firewall.user&#039;</p><p>config rule<br />&nbsp; &nbsp; &nbsp; &nbsp; option name &#039;Allow-OpenVPN-Inbound&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option target &#039;ACCEPT&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option src &#039;*&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;udp&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option dest_port &#039;1194&#039;</p><p>config rule<br />&nbsp; &nbsp; &nbsp; &nbsp; option name &#039;Allow-SSH-Inbound&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option target &#039;ACCEPT&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option src &#039;*&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;tcp&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option dest_port &#039;22&#039;</p><p>config zone<br />&nbsp; &nbsp; &nbsp; &nbsp; option name &#039;vpn&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option input &#039;ACCEPT&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option forward &#039;ACCEPT&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option output &#039;ACCEPT&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option network &#039;vpn0&#039;</p><p>root@OpenWrt:~#</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p252863">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">dhfffile</div>
					<div class="post-datetime">
						2 Nov 2014, 17:30					</div>
				</div>
				<div class="post-content content">
					<p>[root@alarmpi ~]# openvpn --comp-lzo --dev tun2 --remote 10.4.1.2 1194 --nobind --ifconfig 10.8.8.2 10.8.8.1 --verb 6<br />[...]<br />Sun Nov&nbsp; 2 08:03:55 2014 us=911879&nbsp; &nbsp;lzo = 7<br />[...]<br />Sun Nov&nbsp; 2 08:03:56 2014 us=4651 OpenVPN 2.3.4 armv6l-unknown-linux-gnueabihf [SSL (OpenSSL)] [LZO] [EPOLL] [MH] [IPv6] built on Jul&nbsp; 1 2014<br />Sun Nov&nbsp; 2 08:03:56 2014 us=5076 library versions: OpenSSL 1.0.1i 6 Aug 2014, LZO 2.08<br />Sun Nov&nbsp; 2 08:03:56 2014 us=6733 ******* WARNING *******: all encryption and authentication features disabled -- all data will be tunnelled as cleartext<br />Sun Nov&nbsp; 2 08:03:56 2014 us=7774 LZO compression initialized<br />Sun Nov&nbsp; 2 08:03:56 2014 us=9091 Socket Buffers: R=[163840-&gt;131072] S=[163840-&gt;131072]<br />Sun Nov&nbsp; 2 08:03:56 2014 us=18526 TUN/TAP device tun2 opened<br />Sun Nov&nbsp; 2 08:03:56 2014 us=19773 TUN/TAP TX queue length set to 100<br />Sun Nov&nbsp; 2 08:03:56 2014 us=20969 do_ifconfig, tt-&gt;ipv6=0, tt-&gt;did_ifconfig_ipv6_setup=0<br />Sun Nov&nbsp; 2 08:03:56 2014 us=22590 /usr/bin/ip link set dev tun2 up mtu 1500<br />Sun Nov&nbsp; 2 08:03:56 2014 us=42097 /usr/bin/ip addr add dev tun2 local 10.8.8.2 peer 10.8.8.1<br />Sun Nov&nbsp; 2 08:03:56 2014 us=67004 Data Channel MTU parms [ L:1501 D:1450 EF:1 EB:135 ET:0 EL:0 AF:14/1 ]<br />Sun Nov&nbsp; 2 08:03:56 2014 us=68271 Local Options String: &#039;V4,dev-type tun,link-mtu 1501,tun-mtu 1500,proto UDPv4,ifconfig 10.8.8.1 10.8.8.2,comp-lzo&#039;<br />Sun Nov&nbsp; 2 08:03:56 2014 us=69375 Expected Remote Options String: &#039;V4,dev-type tun,link-mtu 1501,tun-mtu 1500,proto UDPv4,ifconfig 10.8.8.2 10.8.8.1,comp-lzo&#039;<br />Sun Nov&nbsp; 2 08:03:56 2014 us=70575 Local Options hash (VER=V4): &#039;47c97e90&#039;<br />Sun Nov&nbsp; 2 08:03:56 2014 us=74006 Expected Remote Options hash (VER=V4): &#039;d3bcff6b&#039;<br />Sun Nov&nbsp; 2 08:03:56 2014 us=75157 UDPv4 link local: [undef]<br />Sun Nov&nbsp; 2 08:03:56 2014 us=76855 UDPv4 link remote: [AF_INET]10.4.1.2:1194<br />Sun Nov&nbsp; 2 08:04:06 2014 us=965784 UDPv4 WRITE [18] to [AF_INET]10.4.1.2:1194:&nbsp; DATA len=18<br />Sun Nov&nbsp; 2 08:04:17 2014 us=75451 UDPv4 WRITE [18] to [AF_INET]10.4.1.2:1194:&nbsp; DATA len=18<br />Sun Nov&nbsp; 2 08:04:27 2014 us=187219 UDPv4 WRITE [18] to [AF_INET]10.4.1.2:1194:&nbsp; DATA len=18<br />^CSun Nov&nbsp; 2 08:04:27 2014 us=950961 event_wait : Interrupted system call (code=4)<br />Sun Nov&nbsp; 2 08:04:27 2014 us=951349 TCP/UDP: Closing socket<br />Sun Nov&nbsp; 2 08:04:27 2014 us=951963 Closing TUN/TAP interface<br />Sun Nov&nbsp; 2 08:04:27 2014 us=952279 /usr/bin/ip addr del dev tun2 local 10.8.8.2 peer 10.8.8.1<br />Sun Nov&nbsp; 2 08:04:27 2014 us=992313 SIGINT[hard,] received, process exiting<br />[root@alarmpi ~]#</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p252901">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">dhfffile</div>
					<div class="post-datetime">
						2 Nov 2014, 23:43					</div>
				</div>
				<div class="post-content content">
					<p>Also, peers (windows, linux) connecting to OpenWrt openvpn instance report (approx. two minutes after connection established) &quot;failed to obtain options consistency info from peer&quot; -- but tunnel works perfectly (only in case of tap device).</p><p>I wonder if this and the above tun problems (if they&#039;re not my mistake) are specific to PalarSSL build ...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p252902">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">metai</div>
					<div class="post-datetime">
						3 Nov 2014, 00:08					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m a bit at a loss. OpenVPN-PolarSSL works perfectly fine here, even with other clients running OpenVPN-OpenSSL (on an OpenWrt AA machine) and OpenVPN Windows ... Sorry that I can&#039;t help you any further. <img src="https://forum.openwrt.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p253012">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">dhfffile</div>
					<div class="post-datetime">
						3 Nov 2014, 23:34					</div>
				</div>
				<div class="post-content content">
					<p>Hello again,</p><p>it seems it all was partly my mistake, sorry. Something maybe didn&#039;t work because of firewall or it was just too late.</p><p>However, I still have (only seen with tun device) the</p><p>write to TUN/TAP : Invalid argument (code=22)</p><p>messages -- when lzo is configured consistently and ping is working.</p><p>Looking closer at the log file I see that these messages appear on OpenWrt router only during the first two minutes after connection of a peer, and exactly at the times when the peer repeatedly sends some none-tunneled packet. After the two minutes the peer stops sending these packets and reports that it &quot;failed to obtain options consistency info from peer&quot;. So it seems to me that these packets are requests for the options consistency info, and are (on the OpenWrt router) somehow misinterpreted as tunnel packets ... so, error when it tries to deliver them to tun device, and also no response to peer.</p><p>Regards</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>