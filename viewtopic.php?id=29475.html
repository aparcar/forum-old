<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> MPD refuses to index and play ogg/vorbis files</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 17 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p132612">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">benjou</div>
					<div class="post-datetime">
						10 Apr 2011, 01:43					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>This is my first post on this forum. I just flashed my planex router to install a soundcard and play music via mpd.<br />Everything went fine, I got it to work and mpd plays music, but only mp3s.</p><p>I have libvorbis, libvorbisidec and libogg installed on an usb drive, but I made symlinks to all the libraries in /usr/lib. Still mpd does not want to add ogg files to the library, and if a do install a file by entering it directly in the database, it won&#039;t play it.</p><p>I really don&#039;t know where to go from there...<br />Any idea?</p><p>Little update</p><p>When I give as a music directory a directory containing only ogg files, the indexing process does not detect anything</p><p>Here is the output on a Folder with three ogg files:<br /></p><div class="codebox"><pre><code>root@OpenWrt:/mnt/disk1/home# mpd mpd.conf -v --no-daemon --stdout
config: loading file mpd.conf
path: path_set_fs_charset: fs charset is: UTF-8
Failed to load database: Failed to open database file &quot;/opt/home/database&quot;: No such file or directory
disabling the last.fm playlist plugin because account is not configured
daemon: opening pid file
daemon: writing pid file
update: spawned thread for update job id 1
state_file: Loading state file /opt/home/state
state_file: failed to open /opt/home/state: No such file or directory
update: starting
database: removing empty directories from DB
database: sorting DB
database: writing DB
update: finished</code></pre></div><p>Here is the output on a folder with mp3 files:<br /></p><div class="codebox"><pre><code>root@OpenWrt:/mnt/disk1/home# mpd mpd.conf -v --no-daemon --stdout
config: loading file mpd.conf
path: path_set_fs_charset: fs charset is: UTF-8
Failed to load database: Failed to open database file &quot;/opt/home/database&quot;: No such file or directory
disabling the last.fm playlist plugin because account is not configured
daemon: opening pid file
daemon: writing pid file
update: spawned thread for update job id 1
state_file: Loading state file /opt/home/state
state_file: failed to open /opt/home/state: No such file or directory
update: starting
update: added /Supertramp - Breakfast in America - Breakfast in America.mp3
update: added /Pat Metheny - Secret Story - Always and Forever.mp3
update: added /John Scofield &amp; Pat Metheny - I Can See Your House From Here - No Matter What.mp3
update: added /Dave Holland - Prime Directive - Jugglers Parade.mp3
mad: detected LAME version 3.91 (&quot;LAME3.91 &quot;)
mad: LAME peak found: 0.000000
mad: encoder delay is 576, encoder padding is 1188
update: added /Nouvelle Vague - The Killing Moon.mp3
update: added /Thom Yorke - The Eraser - The Eraser.mp3
update: added /Dire Straits - Dire Straits - Sultans of Swing.mp3
update: added /Safri Duo - Episode II - Everything Epilogue.mp3
update: added /Steely Dan - Two Against Nature - Gaslighting Abbie.mp3
update: added /Pat Metheny Group - Offramp - Au Lait.mp3
update: added /Pat Metheny - Secret Story - The Truth Will Always Be.mp3
update: added /Pat Metheny Group - Quartet - As I Am.mp3

 etc. etc.

update: added /Suspended Variation II.mp3
mad: detected LAME version 3.97 (&quot;LAME3.97 &quot;)
mad: LAME peak found: 0.000000
mad: LAME track gain found: -0.300000
mad: encoder delay is 576, encoder padding is 1212
update: added /The First Touch.mp3
update: added /The Wizard&#039;s Song.mp3
update: added /Vignette.mp3
database: removing empty directories from DB
database: sorting DB
database: writing DB
update: finished</code></pre></div><p>My mpd should be able of ogg support since<br /></p><div class="codebox"><pre><code>root@OpenWrt:/mnt/disk1/home# mpd -V
mpd (MPD: Music Player Daemon) 0.16.1 

Copyright (C) 2003-2007 Warren Dukes &lt;warren.dukes@gmail.com&gt;
Copyright (C) 2008-2010 Max Kellermann &lt;max@duempel.org&gt;
This is free software; see the source for copying conditions.  There is NO
warranty; not even MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

Supported decoders:

[mad] mp3 mp2
[oggflac] ogg oga
[flac] flac
[audiofile] wav au aiff aif
[faad] aac

Supported outputs:

shout null fifo alsa httpd recorder 

Supported encoders:

null vorbis wave flac 

Supported protocols:

file:// http:// mms:// mmsh:// mmst:// mmsu://</code></pre></div><p>ANy idea?</p>											<p class="post-edited">(Last edited by <strong>benjou</strong> on 11 Apr 2011, 15:11)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p133511">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">benjou</div>
					<div class="post-datetime">
						19 Apr 2011, 22:58					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m bringing this topic up since it is the only issue that prevent my streaming sound system to be a killer. It kind of suck for a Linux-based solution not to play ogg files!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p133517">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">flux</div>
					<div class="post-datetime">
						20 Apr 2011, 00:30					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>benjou wrote:</cite><blockquote><p>I&#039;m bringing this topic up since it is the only issue that prevent my streaming sound system to be a killer. It kind of suck for a Linux-based solution not to play ogg files!</p></blockquote></div><p>works for me.<br /></p><div class="codebox"><pre><code>root@Alix:~# mpd --version
mpd (MPD: Music Player Daemon) 0.16.1 

Copyright (C) 2003-2007 Warren Dukes &lt;warren.dukes@gmail.com&gt;
Copyright (C) 2008-2010 Max Kellermann &lt;max@duempel.org&gt;
This is free software; see the source for copying conditions.  There is NO
warranty; not even MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

Supported decoders:

[mad] mp3 mp2
[oggflac] ogg oga
[flac] flac

Supported outputs:

null fifo oss httpd recorder 

Supported encoders:

null wave flac 

Supported protocols:

file:// http:// mms:// mmsh:// mmst:// mmsu://</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p133526">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">flux</div>
					<div class="post-datetime">
						20 Apr 2011, 01:33					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>flux wrote:</cite><blockquote><p>works for me.</p></blockquote></div><p>sorry, i was wrong. I&#039;ve just tested it and it actually doesn&#039;t work for me either. Ogg files aren&#039;t listed in the database. That&#039;s strange. I was pretty sure it worked for me! Maybe it was a newer version from the trunk that I&#039;ve tested some time age and got an imression that ogg files do work...</p>											<p class="post-edited">(Last edited by <strong>flux</strong> on 20 Apr 2011, 01:33)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p133543">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">benjou</div>
					<div class="post-datetime">
						20 Apr 2011, 10:26					</div>
				</div>
				<div class="post-content content">
					<p>Thanks! I feel less lonely.<br />I was worried that the problem stemmed from the fact that I have my libvorbis and libovorbisidec and libogg on an usb drive and that I had not made correct symlinks (although I&#039;m pretty sure I did...)<br />Probably a problem in the compilation of that package. Do you have any idea how to compile it? I&#039;m a beginner in Openwrt, though I have some experience with linux in general. Or do you know where I could get an alternative package?</p><p>Thanks again!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p133551">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">flux</div>
					<div class="post-datetime">
						20 Apr 2011, 12:02					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>benjou wrote:</cite><blockquote><p>Thanks! I feel less lonely.<br />I was worried that the problem stemmed from the fact that I have my libvorbis and libovorbisidec and libogg on an usb drive and that I had not made correct symlinks (although I&#039;m pretty sure I did...)<br />Probably a problem in the compilation of that package. Do you have any idea how to compile it? I&#039;m a beginner in Openwrt, though I have some experience with linux in general. Or do you know where I could get an alternative package?</p><p>Thanks again!</p></blockquote></div><p>well I suppose there is some problem with the 0.16.1 version of the mpd. Still think that ogg worked with the 0.15.8. They&#039;ve changed the db format in this new 0.16.1 version and it could be that they screwed something during this transition. Well to test you can compile the older version. <a href="https://dev.openwrt.org/changeset?old=26014%40packages%2Fsound%2Fmpd%2FMakefile&amp;new=26014%40packages%2Fsound%2Fmpd%2FMakefile">Here are the changes that were made to upgrade to 0.16.1</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p133566">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">benjou</div>
					<div class="post-datetime">
						20 Apr 2011, 15:18					</div>
				</div>
				<div class="post-content content">
					<p>Interestingly, they seem to have switched from liboggflac decoder to tremor decoder. This may have broken ogg reading. </p><p>I don&#039;t think that it&#039;s a db problem. The db is a flat text file, one can edit it manually and enter ogg files (which I did). The ogg files are then visible in your mpd client but mpd refuses to play them.</p><p>I&#039;ll have to give a try to compiling 0.15.8. Is there a tutorial how to compile and make packages under openwrt?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p133569">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">flux</div>
					<div class="post-datetime">
						20 Apr 2011, 15:33					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>benjou wrote:</cite><blockquote><p>I don&#039;t think that it&#039;s a db problem. The db is a flat text file, one can edit it manually and enter ogg files (which I did). The ogg files are then visible in your mpd client but mpd refuses to play them.</p></blockquote></div><p>yep, I didn&#039;t mean the db file itself but all the code behind that handles local files.<br />Ok, if you wanna try the older mpd version the easiest way would be to install it from the repositories for your hardware. Don&#039;t know what image you are using currently (trunk snapshot I suppose) but all backfire rc&#039;s (up to rc4) are compiled with the mpd 0.15.8. You can try to opkg the package and if it doesn&#039;t work then you indeed need to recompile the package yourself. Start reading from here then <a href="http://wiki.openwrt.org/doc/start#building">http://wiki.openwrt.org/doc/start#building</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p133592">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">benjou</div>
					<div class="post-datetime">
						20 Apr 2011, 18:38					</div>
				</div>
				<div class="post-content content">
					<p>Ok that&#039;s very odd. I uninstalled my version of mpd (from snapshot/trunk indeed) and downloaded either mpd_0.15.8-5_ar71xx.ipk, mpd_0.15.8-4_ar71xx.ipk, mpd_0.15.8-2_ar71xx.ipk or mpd_0.15.8-1_ar71xx.ipk from the various RCs of backfire, but whenever I try to install these, I get the 0.16.1 version see below:</p><div class="codebox"><pre><code>root@OpenWrt:/mnt/disk1/home# opkg install --force-downgrade -d usb mpd_0.15.8-4_ar71xx.ipk 
Installing mpd (0.15.8-4) to usb...
Configuring mpd.
Collected errors:
 * resolve_conffiles: Existing conffile /opt/etc/mpd.conf is different from the conffile in the new package. The new conffile will be placed at /opt/etc/mpd.conf-opkg.
root@OpenWrt:/mnt/disk1/home# mpd -V
mpd (MPD: Music Player Daemon) 0.16.1

Copyright (C) 2003-2007 Warren Dukes &lt;warren.dukes@gmail.com&gt;
Copyright (C) 2008-2010 Max Kellermann &lt;max@duempel.org&gt;
This is free software; see the source for copying conditions.  There is NO
warranty; not even MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

Supported decoders:

[mad] mp3 mp2
[oggflac] ogg oga
[flac] flac
[audiofile] wav au aiff aif
[faad] aac

Supported outputs:

shout null fifo alsa httpd recorder 

Supported encoders:

null vorbis wave flac 

Supported protocols:

file:// http:// mms:// mmsh:// mmst:// mmsu://</code></pre></div><p>It uses the right file, it says it install the right verion (0.15.8) but then I get the latest version (0.16). In one of these version can I play ogg files.<br />What am I doing wrong here?<br />Thanks for your help!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p133626">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">flux</div>
					<div class="post-datetime">
						21 Apr 2011, 01:09					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>benjou wrote:</cite><blockquote><p>Ok that&#039;s very odd. I uninstalled my version of mpd (from snapshot/trunk indeed) and downloaded either mpd_0.15.8-5_ar71xx.ipk, mpd_0.15.8-4_ar71xx.ipk, mpd_0.15.8-2_ar71xx.ipk or mpd_0.15.8-1_ar71xx.ipk from the various RCs of backfire, but whenever I try to install these, I get the 0.16.1 version see below:</p><div class="codebox"><pre><code>root@OpenWrt:/mnt/disk1/home# opkg install --force-downgrade -d usb mpd_0.15.8-4_ar71xx.ipk</code></pre></div></blockquote></div><p>I&#039;d delete the mpd completely first and then either edit the /etc/opkg.conf so it would point to the backfire (the very first line) and then would call (opkg update; opkg install mpd...). Or install it manually package by package but this would be very time consuming because mpd has lots of dependencies (I suppose around 10 additional packages needs to be downloaded and installed )</p><p>Still it is highly probable that the older version will not work because it was compiled for different kernel version and with different libs. So compiling it yourself would still be a better option.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p133664">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">benjou</div>
					<div class="post-datetime">
						21 Apr 2011, 13:01					</div>
				</div>
				<div class="post-content content">
					<p>Ok thanks for your help anyway. I&#039;ll try to learn how to compile things for my router.<br />Is there a place that I can file a bug report for the non working ogg in the present version of mpd?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p133669">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">flux</div>
					<div class="post-datetime">
						21 Apr 2011, 13:19					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>benjou wrote:</cite><blockquote><p>Ok thanks for your help anyway. I&#039;ll try to learn how to compile things for my router.<br />Is there a place that I can file a bug report for the non working ogg in the present version of mpd?</p></blockquote></div><p><a href="https://dev.openwrt.org/newticket">https://dev.openwrt.org/newticket</a></p><p>and you try to ask on the freenode.org #mpd irc channel</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p142685">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">stevo</div>
					<div class="post-datetime">
						1 Sep 2011, 10:50					</div>
				</div>
				<div class="post-content content">
					<p>Any news on this?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p146129">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">towolf</div>
					<div class="post-datetime">
						18 Oct 2011, 21:18					</div>
				</div>
				<div class="post-content content">
					<p>MPD should be updated. Here are my findings: <a href="https://dev.openwrt.org/ticket/9280#comment:3">https://dev.openwrt.org/ticket/9280#comment:3</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p157095">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">stanelie</div>
					<div class="post-datetime">
						12 Feb 2012, 07:30					</div>
				</div>
				<div class="post-content content">
					<p>Where can the new binary be found?</p><p>The <a href="http://downloads.openwrt.org/backfire/10.03.1/">http://downloads.openwrt.org/backfire/10.03.1/</a> directory still has the 0.16.1 binary...<br />I am looking for a WGT634U (brcm47xx) compatible binary.</p><p>Thanks!</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>