<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> WNDR3700v1 ISP TV and PPPoE Internet VLAN setup using LuCI</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 5 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p249647">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">bavan_ms</div>
					<div class="post-datetime">
						8 Oct 2014, 01:25					</div>
				</div>
				<div class="post-content content">
					<p>Dear members,</p><p>I&#039;m posting this topic to find some help in setting up a WNDR3700v1 with OpenWRT version Barrier Breaker 71xx - R42742_201401003. I&#039;m familiar with router and network settings but have little knowledge on VLAn configs by means of OpenWRT. My router is working properly after installing OpenWRT and I was able to configure it correctly to make a PPPoE standard public internet connection to my ISP provider. Now I want to add the TV part on it using VLANs but I&#039;am confused how to do this correctly by means of LuCI (not via telnet please as I have little to none Ubuntu/Linux command line knowledge).</p><p>Reason: I would be happy to replace the ISP modem/router with an identical setup by means of the WNDR3700 with OpenWRT as the ISP modem/router is very restricted to configure and even unstable. I&#039;m waiting for a new firmware to fix some serious bugs for several months now, without success, so it&#039;s time to change it by something better like WNDR3700 OpenWRT.</p><p>These are the settings I read on the ISP ADSL modem/router for the WAN part.</p><p>1) Internet using PPPoE<br />Status: Connected<br />PPP Enable<br />VLAN ID: 10<br />Protocol: PPP<br />IPv4 Address: 81.244.xx.xx<br />Subnet Mask: 255.255.255.255<br />Modem IPv6 Address: fe80::9e97:26ff:feb6:a52a<br />DNS Servers: 195.238.2.22, 195.238.2.21<br />NTP Servers: ntp.belbone.be&nbsp; &nbsp;81.244.255.72&nbsp; &nbsp;81.244.255.73&nbsp; &nbsp;195.238.16.48&nbsp; &nbsp;195.238.16.47&nbsp; </p><p>2) Video for the TV decoder<br />Status: Connected<br />VLAN ID: 30<br />Protocol: DHCP<br />IPv4 Address: 10.135.121.255<br />Subnet Mask: 255.255.0.0<br />Modem: 10.135.0.1&nbsp; <br />NTP Servers: ntp.belbone.be&nbsp; &nbsp;81.244.255.72&nbsp; &nbsp;81.244.255.73&nbsp; &nbsp;195.238.16.48&nbsp; &nbsp;195.238.16.47&nbsp; </p><p>As for the LAN part the Internet DHCP server is set from 192.168.0.1 to 192.168.0.63<br />The TV decoder gets and internal Ip address = 192.168.0.64<br />I have no acces to other settings like VLAN and firewall settings on the ISP modem/router (restricted user access).</p><p>I suppose the ISP modem is fully routed using trunking as I can connect the TV decoder to no matter which LAN port on the ISP router but do not know whether VLANs are set to tagged or untagged etc... I noticed that the public internet is on VLAN ID 10 and the TV decoder on VLAN 30. How the VLAN 30 is configured to connect via WAN DHCP I do not know (to little knowledge on this).</p><p>I have a basic OpenWRT setup on the WNDR3700 with PPPoE and WLAN guest access.<br />I have the typical 4 network interfaces LAN, WAN, WAN6 &amp; Visitor (WLAN Guest access).<br />VLANs are not configured yet and neither are the firewal and traffic rules to split internet traffic via VLAN ID 10 and TV/video via VLAN ID 30. How the TV/video part VLAN ID 30 retrieves an ISP IP via DHCP I do not understand (double WAN interface ?).<br />&nbsp; <br />OpenWRT Physical Interfaces <br />&nbsp; &nbsp; Ethernet Adapter: &quot;@wan&quot; (wan6)&nbsp; <br />&nbsp; &nbsp; Ethernet Switch: &quot;eth0&quot;&nbsp; <br />&nbsp; &nbsp; VLAN Interface: &quot;eth0.1&quot; (lan)&nbsp; <br />&nbsp; &nbsp; Ethernet Adapter: &quot;eth1&quot; (wan)&nbsp; <br />&nbsp; &nbsp; Ethernet Adapter: &quot;gretap0&quot;&nbsp; <br />&nbsp; &nbsp; Ethernet Adapter: &quot;ip6tnl0&quot;&nbsp; <br />&nbsp; &nbsp; Wireless Network: Master &quot;WiFi 2.4&quot; (lan)&nbsp; <br />&nbsp; &nbsp; Wireless Network: Master &quot;WiFi Guests&quot; (Visitor)&nbsp; <br />&nbsp; &nbsp; Wireless Network: Master &quot;WiFi 5.0&quot; (lan)</p><p>OpenWRT VLAN settings: VLANs on &quot;switch0&quot; (RTL8366S)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Port 0&nbsp; &nbsp; &nbsp; Port 1&nbsp; &nbsp; &nbsp; Port 2&nbsp; &nbsp; &nbsp; Port 3&nbsp; &nbsp; &nbsp;Port 4&nbsp; &nbsp; &nbsp;CPU<br />VLAN ID 1 untagged untagged untagged&nbsp; &nbsp; &nbsp; off&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; off&nbsp; &nbsp; &nbsp; tagged&nbsp; </p><br /><p>I hope this is enough info for someone with VLAN knowledge to find out what setup is used by the ISP modem/router for as well the VLAN as the WAN connectivity setup. Hopefullly this config can be replicated using LuCi&nbsp; to config OpenWRT VLAN settings for the WNDR3700.</p><p>A step by step guide using LuCI to create the necessary interfaces, firewall, traffic rules and VLAN settings to duplicate the ISP WAN/LAN VLAN config into OpenWRT would be very welcome.</p><p>If you need more info on this let me know. I&#039;ll do my best to find out what I can on the Original ISP modem/router.</p><p>Thanks in advance for the good advice and fantastic work done so far by developing OpenWRT.</p><p>Brgds.</p><br /><p>PS: Is there an easy way to include screenshots into posts (copy/paste image via BBcode)?</p>											<p class="post-edited">(Last edited by <strong>bavan_ms</strong> on 8 Oct 2014, 02:25)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p249781">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">bavan_ms</div>
					<div class="post-datetime">
						8 Oct 2014, 22:59					</div>
				</div>
				<div class="post-content content">
					<p>Hi again,</p><p>to make some progress in trying to find out what is needed to setup OpenWRT with VLANs to match my ISP modem,<br />can anyone explain the config setup of my ISP modem according to the following info?</p><p>On my ISP modem/router I see public internet (VLAN 10) and IPTV streaming (VLAN 30).</p><p>These are the settings I read on the ISP ADSL modem/router for the connectivity part.</p><p>1) Internet using PPPoE<br />VLAN ID: 10<br />IPv4 Address: 81.244.122.132<br />Subnet Mask: 255.255.255.255<br />Modem IPv6 Address: fe80::9e97:26ff:feb6:a52a<br />DNS Servers: 195.238.2.22, 195.238.2.21<br />NTP Servers: ntp.belbone.be&nbsp; &nbsp;81.244.255.72&nbsp; &nbsp;81.244.255.73&nbsp; &nbsp;195.238.16.48&nbsp; &nbsp;195.238.16.47&nbsp; </p><p>2) Video for the TV decoder<br />VLAN ID: 30<br />Protocol: DHCP<br />IPv4 Address: 10.135.121.255<br />Subnet Mask: 255.255.0.0<br />Modem: 10.135.0.1&nbsp; <br />NTP Servers: ntp.belbone.be&nbsp; &nbsp;81.244.255.72&nbsp; &nbsp;81.244.255.73&nbsp; &nbsp;195.238.16.48&nbsp; &nbsp;195.238.16.47&nbsp; </p><p>As for the LAN part the DHCP server is set from 192.168.0.1 to 192.168.0.63 for standard clients using VLAN 10.<br />The TV decoder gets and internal Ip address = 192.168.0.64 and is served by VLAN 30.</p><p>Would it be possible for someone to explain me what is used on the WAN side and how this links to the LAN part using VLANs?<br />I see that VLAN 10 is linked to public IP address 81.244.122.132 and VLAN 30 to IP address 10.135.121.255 (IPTV).</p><p>What does this means on interface level (WAN/LAN)? </p><p>Are there 2 WAN interfaces active which get their IP address from the ISP and bind them to VLAN 10 (PPPoE) &amp; VLAN 30 (DHCP) or am I wrong? How does this links into the VLAN settings? How does the TV decoder know it belongs to VLAN 30 (is this factory preconfigured)?</p><p>Once I understand this better and know what to look for as WAN/LAN interface setup to be configured in OpenWRT I can search other posts to learn how this is done by means of configuring physical interfaces towards VLANs (truncked/tagged/untagged).</p><p>PS: The TV decoder (VLAN 30) can be plugged in on any LAN port of the ISP modem router.</p><p>This would be very helpfull and would demistify a lot.</p><p>Thanks in advance for helping me out on this.</p><p>B.</p>											<p class="post-edited">(Last edited by <strong>bavan_ms</strong> on 8 Oct 2014, 23:04)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p249801">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">leeandy</div>
					<div class="post-datetime">
						9 Oct 2014, 02:29					</div>
				</div>
				<div class="post-content content">
					<p>Pls use any ssh program(eg:putty) login to router, run command below and copy/paste outputs:<br /></p><div class="codebox"><pre><code>cat /etc/config/network</code></pre></div><p>Maybe I can help you.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p250026">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">bavan_ms</div>
					<div class="post-datetime">
						10 Oct 2014, 18:22					</div>
				</div>
				<div class="post-content content">
					<p>Hi Ieeandy,</p><p>thanks for giving me some advice in this.</p><p>I can not login via SSH/Telnet port 22/23 on the ISP modem as it doesn&#039;t support terminal mode (tried both but modem does not respond). The only way I can access the ISP modem is via the web browser (HTML). As the access to the ISP modem is user restricted (no admin login possible) I&#039;ve listed what I could read out on the connectivity part.</p><p>This is a Technicolor ISP modem which is used for both public internet and video on demand.<br />Public internet via PPPoE on VLAN 10 and video IPTV via DHCP on VLAN 30.</p><p>I&#039;ve got the WNDR3700 OpenWRT working in basic config for the WAN PPPoE connectivity but don&#039;t know how to set up the second part for the WAN video connectivity. So far I haven&#039;t changed anything on the OpenWRT VLAN settings (basic setup) as I gues first thing to do is get the WAN video connectivity working to receive a WAN IP adrress in the range of 10.x.x.x (see details above posts).</p><p>What should I do to create an additional OpenWRT WAN physical interface for the video connectivity?<br />Once this works I can move on to the VLAN part to link VLAN 10 and VLAN 30 and set up traffic rules and firewall for the video part (still have to learn how).</p><p>Your feedback is much welcome.</p><p>Brgds.</p>											<p class="post-edited">(Last edited by <strong>bavan_ms</strong> on 10 Oct 2014, 18:24)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p250029">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">leeandy</div>
					<div class="post-datetime">
						10 Oct 2014, 18:39					</div>
				</div>
				<div class="post-content content">
					<p>I mean login to WNDR3700 router, not ISP router.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p250084">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">bavan_ms</div>
					<div class="post-datetime">
						11 Oct 2014, 02:13					</div>
				</div>
				<div class="post-content content">
					<p>This is the output on the WNDR3700 without connecting to the ISP (standalone).</p><p>config interface &#039;loopback&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;lo&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;127.0.0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.0.0.0&#039;</p><p>config globals &#039;globals&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ula_prefix &#039;fdf3:e54e:fbea::/48&#039;</p><p>config interface &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option force_link &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option type &#039;bridge&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ip6assign &#039;60&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;10.0.0.1&#039;</p><p>config interface &#039;wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;dhcp&#039;</p><p>config interface &#039;wan6&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;@wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;dhcpv6&#039;</p><p>config switch<br />&nbsp; &nbsp; &nbsp; &nbsp; option name &#039;switch0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option reset &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option enable_vlan &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option blinkrate &#039;2&#039;</p><p>config switch_vlan<br />&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;switch0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option vlan &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ports &#039;0 1 2 3 5t&#039;</p><p>config switch_port<br />&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;switch0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option port &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option led &#039;6&#039;</p><p>config switch_port<br />&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;switch0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option port &#039;2&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option led &#039;9&#039;</p><p>config switch_port<br />&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;switch0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option port &#039;5&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option led &#039;2&#039;</p>											<p class="post-edited">(Last edited by <strong>bavan_ms</strong> on 11 Oct 2014, 02:14)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p250086">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">leeandy</div>
					<div class="post-datetime">
						11 Oct 2014, 02:49					</div>
				</div>
				<div class="post-content content">
					<p>Ok, now modify /etc/config/network like this:<br /></p><div class="codebox"><pre><code>config interface &#039;loopback&#039;
        option ifname &#039;lo&#039;
        option proto &#039;static&#039;
        option ipaddr &#039;127.0.0.1&#039;
        option netmask &#039;255.0.0.0&#039;

config globals &#039;globals&#039;
        option ula_prefix &#039;fdf3:e54e:fbea::/48&#039;

config interface &#039;lan&#039;
        option ifname &#039;eth0.1&#039;
        option force_link &#039;1&#039;
        option type &#039;bridge&#039;
        option proto &#039;static&#039;
        option netmask &#039;255.255.255.0&#039;
        option ip6assign &#039;60&#039;
        option ipaddr &#039;10.0.0.1&#039;

config interface &#039;wan&#039;    ; this section for internet connection using vlan10
        option ifname &#039;eth1.10&#039;
        option proto &#039;dhcp&#039;

config interface &#039;wan_tvbox&#039;    ; section of tvbox using vlan30
        option ifname &#039;eth1.30 eth0.30&#039;
        option proto &#039;none&#039;
        option auto &#039;1&#039;
        option type &#039;bridge&#039;

config interface &#039;wan6&#039;
        option ifname &#039;@wan&#039;
        option proto &#039;dhcpv6&#039;

config switch
        option name &#039;switch0&#039;
        option reset &#039;1&#039;
        option enable_vlan &#039;1&#039;
        option blinkrate &#039;2&#039;
        option enable_vlan4k &#039;1&#039;

config switch_vlan
        option device &#039;switch0&#039;
        option vlan &#039;1&#039;
        option vid &#039;1&#039;
        option ports &#039;1 2 3 5t&#039;

config switch_vlan    ; this section will map vlan30 eth1.30 to port 4 for tvbox
        option device &#039;switch0&#039;
        option vlan &#039;2&#039;
        option vid &#039;30&#039;
        option ports &#039;0 5t&#039;

config switch_port
        option device &#039;switch0&#039;
        option port &#039;1&#039;
        option led &#039;6&#039;

config switch_port
        option device &#039;switch0&#039;
        option port &#039;2&#039;
        option led &#039;9&#039;

config switch_port
        option device &#039;switch0&#039;
        option port &#039;5&#039;
        option led &#039;2&#039;</code></pre></div><p>Reboot router. You need plug tvbox to port 4 netgear router, this port is dedicated for tvbox.<br />You can see here for more infos how to configure switch ports for vlans.<br /><a href="http://wiki.openwrt.org/toh/netgear/wndr3700">http://wiki.openwrt.org/toh/netgear/wndr3700</a></p>											<p class="post-edited">(Last edited by <strong>leeandy</strong> on 11 Oct 2014, 02:59)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p250129">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">Borromini</div>
					<div class="post-datetime">
						11 Oct 2014, 14:27					</div>
				</div>
				<div class="post-content content">
					<p>Bavan_ms, are you on Telenet by any chance?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p250136">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">bavan_ms</div>
					<div class="post-datetime">
						11 Oct 2014, 17:30					</div>
				</div>
				<div class="post-content content">
					<p>Noop, the other one with pinky colors.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p250138">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">bavan_ms</div>
					<div class="post-datetime">
						11 Oct 2014, 17:42					</div>
				</div>
				<div class="post-content content">
					<p>I made the modif as suggested by Ieeandy. Checked it line by line and everything looks fine. The VLANs are present.<br />So first thing to change was VLAN 1.10 to match the WAN PPPoE connection. I did that with the OpenWRT LuCI web interface.<br />Unfortunately I don&#039;t get a public WAN IP address. </p><p>When I change the WAN physical interface to eth1 instead of eth1.10 (VLAN) the PPPoE WAN connection works and I reveive a public IP address but that&#039;s not the intention.</p><p>Must I bridge something in the physical WAN interface setup so that Vlan10 can connect via PPPoE or am I doing something wrong?</p><p>Secondly the VLAN30 protocol setup for the wan_tvbox interface is set to unmanaged. Shouldn&#039;t that be DHCP to receive the ISP TV IP address? Tried it but no IPTV address from the ISP&nbsp; (10.x.x.x).</p><p>Here is the latest network config read out as suggested by Ieeandy (VLAN10 PPPoE not connecting).</p><br /><p>config interface &#039;loopback&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;lo&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;127.0.0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.0.0.0&#039;</p><p>config globals &#039;globals&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ula_prefix &#039;fdf3:e54e:fbea::/48&#039;</p><p>config interface &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option force_link &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option type &#039;bridge&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ip6assign &#039;60&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;10.0.0.1&#039;</p><p>config interface &#039;wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth1.10&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option _orig_ifname &#039;eth1.10&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option _orig_bridge &#039;false&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;pppoe&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option username &#039;username@ISP&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option password &#039;ISP_password&#039;</p><p>config interface &#039;wan_tvbox&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth1.30 eth0.30&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option type &#039;bridge&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option _orig_ifname &#039;eth0.30 eth1.30&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option _orig_bridge &#039;true&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;none&#039;</p><p>config interface &#039;wan6&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;@wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;dhcpv6&#039;</p><p>config switch<br />&nbsp; &nbsp; &nbsp; &nbsp; option name &#039;switch0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option reset &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option enable_vlan &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option blinkrate &#039;2&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option enable_vlan4k &#039;1&#039;</p><p>config switch_vlan<br />&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;switch0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option vlan &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option vid &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ports &#039;0 1 2 3 5t&#039;</p><p>config switch_vlan<br />&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;switch0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option vlan &#039;2&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option vid &#039;30&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ports &#039;0 5t&#039;</p><p>config switch_port<br />&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;switch0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option port &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option led &#039;6&#039;</p><p>config switch_port<br />&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;switch0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option port &#039;2&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option led &#039;9&#039;</p><p>config switch_port<br />&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;switch0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option port &#039;5&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option led &#039;2&#039;</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p250147">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">leeandy</div>
					<div class="post-datetime">
						11 Oct 2014, 19:15					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><p>config interface &#039;wan_tvbox&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth1.30 eth0.30&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option type &#039;bridge&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option _orig_ifname &#039;eth0.30 eth1.30&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option _orig_bridge &#039;true&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;none&#039;</p></blockquote></div><p>&#039;wan_tvbox&#039; set proto none (unmanaged) because this is just a vlan tagging from VID30 WAN port to LAN port4. tvbox have dhcp client will request itself. And you need &quot;option auto &#039;1&#039; &quot; to enable this bridge from boot.</p><div class="quotebox"><blockquote><p>config switch_vlan<br />&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;switch0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option vlan &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option vid &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ports &#039;0 1 2 3 5t&#039;</p></blockquote></div><p>Wrong config, pls change option ports &#039;0 1 2 3 5t&#039; to option ports &#039;1 2 3 5t&#039; that mean leave port4 is off on vlan1.</p><p>Let configure 3700&#039;router connect to internet, run follow command from router:<br /></p><div class="codebox"><pre><code>opkg update
opkg install kmod-8021q kmod-bridge nano</code></pre></div><p>maybe two this kmod package are required for vlan tagging. nano is a text editor program, u can run &quot;nano /etc/config/network&quot; directly on router.</p><p>I dont know how your isp cable to connect to netgear router, from fiber converter to WAN port netgear ? or from one of lan port isp router to wan port netgear ? Let direct connect from &quot;fiber converter/terminal cable&quot; to wan port 3700 router.</p>											<p class="post-edited">(Last edited by <strong>leeandy</strong> on 11 Oct 2014, 20:44)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p250265">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">bavan_ms</div>
					<div class="post-datetime">
						12 Oct 2014, 21:31					</div>
				</div>
				<div class="post-content content">
					<p>OK, Tx. I&#039;ll try this setup.</p><p>The WNDR3700 WAN port is connected to an ADSL modem which is bridged. In this way the WNDR3700 is directly bridged to the ISP and uses PPPoE for WAN connection to the ISP.</p><p>Note: The WNDR37000 PPPoE setup worked for many years, without using VLANs, but now I have to move to a VLAN setup since I&#039;ve upgraded to use ISP_TV (VLAN setup). In basic mode, without VLANs config, I can get my setup for OpenWRT to work properly on PPPoE when the physical interface for the WAN is set to eth1 PPPoE. VLAN 1.10 PPPoE doesn&#039;t work.</p><p>Can I install the additional packages without having a PPPoE session working? Are they prebuild in Barrier Breaker 71xx - R42742_201401003?</p><p>Probably I miss something and I&#039;m still learning (time ...time) but I don&#039;t give up so I can replace the ISP modem.<br />I&#039;ll try it later tomorrow.</p><p>Regards.</p>											<p class="post-edited">(Last edited by <strong>bavan_ms</strong> on 13 Oct 2014, 03:12)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p250299">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">leeandy</div>
					<div class="post-datetime">
						13 Oct 2014, 03:01					</div>
				</div>
				<div class="post-content content">
					<p>I think internet connection not using vlan. Pls confirm with your ISP.<br />Try direct connect isp cable to router, may be isp&#039;s modem not support vlan tag in bridge-mode.<br />See here same your problem: <a href="https://forum.openwrt.org/viewtopic.php?id=51066">https://forum.openwrt.org/viewtopic.php?id=51066</a></p>											<p class="post-edited">(Last edited by <strong>leeandy</strong> on 13 Oct 2014, 03:19)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p250301">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">bavan_ms</div>
					<div class="post-datetime">
						13 Oct 2014, 03:18					</div>
				</div>
				<div class="post-content content">
					<p>Ok I&#039;ll check again but I&#039;m pritty sure the ISP is using VLAN to seperate public internet from TV.</p><p>Without the TV decoder being attached to the original ISP modem I see the ISP modem has a public internet IP address on VLAN 10 = 81.x.x.x and WAN TV on VLAN 30 has an IP address = 10.x.x.x </p><p>That&#039;s what I read on the ISP modem WAN connection screen.<br />The ISP modem internal LAN is set to 192.168.x.x</p><p>Can I install the additional packages without having a PPPoE session working? Are they prebuild in Barrier Breaker 71xx - R42742_201401003?</p><p>I&#039;ll try to install the extra 2 packages tomorrow and see what this does on the PPPoE connection part for VLAN 10.</p><p>PS: I just wonder if I don&#039;t need additional traffic rules on the VLANs to get things working?</p><p>Thanks again.</p>											<p class="post-edited">(Last edited by <strong>bavan_ms</strong> on 13 Oct 2014, 03:23)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p250302">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">leeandy</div>
					<div class="post-datetime">
						13 Oct 2014, 03:29					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>bavan_ms wrote:</cite><blockquote><p>Can I install the additional packages without having a PPPoE session working? Are they prebuild in Barrier Breaker 71xx - R42742_201401003?</p></blockquote></div><p>Just set netgear same subnet isp modem/router, set LAN&#039;s gateway &amp; dns point to isp&#039;s modem/router.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p250399">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">bavan_ms</div>
					<div class="post-datetime">
						13 Oct 2014, 20:36					</div>
				</div>
				<div class="post-content content">
					<p>Hi, tried to install the additional packages but receive a download failure.</p><p>root@WNDR3700:~# opkg update<br />Downloading <a href="http://downloads.openwrt.org/snapshots/trunk/ar71xx/packages/Packages.gz.">http://downloads.openwrt.org/snapshots/ … ckages.gz.</a><br />wget: server returned error: HTTP/1.1 404 Not Found<br />Collected errors:<br /> * opkg_download: Failed to download <a href="http://downloads.openwrt.org/snapshots/trunk/ar71xx/packages/Packages.gz,">http://downloads.openwrt.org/snapshots/ … ckages.gz,</a> wget returned 1.</p><p>root@WNDR3700:~# opkg install kmod-8021q kmod-bridge nano<br />Package kmod-8021q (3.10.49-1) installed in root is up to date.<br />Unknown package &#039;kmod-bridge&#039;.<br />Unknown package &#039;nano&#039;.<br />Collected errors:<br /> * opkg_install_cmd: Cannot install package kmod-bridge.<br /> * opkg_install_cmd: Cannot install package nano.</p><br /><p>WNDR3700 is connected via PPPoE (basic setup without VLANs) and I can surf the internet (Google is working).<br />With my web browser I can access <a href="http://downloads.openwrt.org/snapshots/trunk/ar71xx/packages/packages/">http://downloads.openwrt.org/snapshots/ … /packages/</a> and see the Packages.gz file listed in the directory. </p><p>What am I doing wrong (sorry for being a Linux dummy)?</p>											<p class="post-edited">(Last edited by <strong>bavan_ms</strong> on 13 Oct 2014, 20:37)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p250411">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">bavan_ms</div>
					<div class="post-datetime">
						13 Oct 2014, 21:17					</div>
				</div>
				<div class="post-content content">
					<p>Following config works for PPPoE WAN connection on ADSL bridged modem.<br />WAN_TVBOX interface is not working, I only see TX traffic bot no RX traffic (=0).</p><br /><p>config interface &#039;loopback&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;lo&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;127.0.0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.0.0.0&#039;</p><p>config globals &#039;globals&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ula_prefix &#039;fdf3:e54e:fbea::/48&#039;</p><p>config interface &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option force_link &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option type &#039;bridge&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ip6assign &#039;60&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;10.0.0.1&#039;</p><p>config interface &#039;wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option _orig_ifname &#039;eth1.10&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option _orig_bridge &#039;false&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;pppoe&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option username &#039;username@SKYNET&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option password &#039;password@ISP&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth1&#039;</p><p>config interface &#039;wan_tvbox&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth1.30 eth0.30&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option type &#039;bridge&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option _orig_ifname &#039;eth0.30 eth1.30&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option _orig_bridge &#039;true&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;none&#039;</p><p>config interface &#039;wan6&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;@wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;dhcpv6&#039;</p><p>config switch<br />&nbsp; &nbsp; &nbsp; &nbsp; option name &#039;switch0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option reset &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option enable_vlan &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option blinkrate &#039;2&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option enable_vlan4k &#039;1&#039;</p><p>config switch_vlan<br />&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;switch0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option vlan &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option vid &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ports &#039;1 2 3 5t&#039;</p><p>config switch_vlan<br />&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;switch0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option vlan &#039;2&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option vid &#039;30&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ports &#039;0 5t&#039;</p><p>config switch_port<br />&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;switch0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option port &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option led &#039;6&#039;</p><p>config switch_port<br />&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;switch0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option port &#039;2&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option led &#039;9&#039;</p><p>config switch_port<br />&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;switch0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option port &#039;5&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option led &#039;2&#039;</p>											<p class="post-edited">(Last edited by <strong>bavan_ms</strong> on 13 Oct 2014, 21:18)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p250460">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">leeandy</div>
					<div class="post-datetime">
						14 Oct 2014, 03:25					</div>
				</div>
				<div class="post-content content">
					<p>Let upgrade to final BB 14.07. your router need kmod-bridge to work well.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p250587">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">bavan_ms</div>
					<div class="post-datetime">
						15 Oct 2014, 01:17					</div>
				</div>
				<div class="post-content content">
					<p>Hi Ieeandy,</p><p>I&#039;ve installed BB 14.07 from <a href="http://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/">http://downloads.openwrt.org/barrier_br … x/generic/</a><br />Seems the previous version 14.07 I was running was a custom build version and it didn&#039;t support the opk update cmd.</p><p>After installing BB final 14.07 and just to make sure I&#039;ve successfully installed the 2 packages and Nano editor is working.<br />&nbsp; &nbsp; opkg update<br />&nbsp; &nbsp; opkg install kmod-8021q kmod-bridge nano</p><p>I&#039;ve reconfigured the VLANs according your latest post. WAN PPPoE on eth1.10 is not connecting. IPTV on eth0.30 / 1.30 neither.<br />I&#039;ve seen on another post that for ADSL it could be, instead of VDSL, that I need to use PPPoATM to get things going.<br />Switching from PPPoE to PPPoATM in Open WRT gives me a warning that the PPPoATM package is not installed</p><p>I&#039;ve tried to install it via SSH terminal session but did not succeed (opkg install ppp-mod-pppoa didn&#039;t work).</p><p>What is the correct SSH Putty cmd to download and install PPPoATM?</p><p>Note: I&#039;ve checked with the helpdesk from the ISP what are the settings and protocols they use. They&#039;ve told me that the PPPoE/PPPoATM VLAN 10 session needs to be up and running before the IPTV VLAN 30 can get a DHCP address. Not sure wether it needs to be tagged or untagged. I hope all of this this make sense as I&#039;m out of my comfort zone and rely on their input and feedback (I had a very friendly helpdesk engineer who tried to explain it but I can not guarantee if this statement is correct).</p><p>This is the current config according your instructions (I hope it is correct) which doesn&#039;t connect via the VLANs (PPPoE &amp; IPTV).<br />I will give it another try onces I can get PPPoATM installed.<br />PS; I&#039;ve added a part for WLAN guest (Visitor) which is working properly.</p><br /><p>config interface &#039;loopback&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;lo&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;127.0.0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.0.0.0&#039;</p><p>config globals &#039;globals&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ula_prefix &#039;fda6:826c:2cba::/48&#039;</p><p>config interface &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option force_link &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option type &#039;bridge&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ip6assign &#039;60&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;10.0.0.1&#039;</p><p>config interface &#039;wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option _orig_ifname &#039;eth1.10&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option _orig_bridge &#039;false&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth1.10&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;pppoe&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option username &#039;username@ISP&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option password &#039;password@ISP&#039;</p><p>config interface &#039;wan_tvbox&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth1.30 eth0.30&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option type &#039;bridge&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option _orig_ifname &#039;eth0.30 eth1.30&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option _orig_bridge &#039;true&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;dhcp&#039;</p><p>config interface &#039;wan6&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;@wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;dhcpv6&#039;</p><p>config switch<br />&nbsp; &nbsp; &nbsp; &nbsp; option name &#039;switch0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option reset &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option enable_vlan &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option blinkrate &#039;2&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option enable_vlan4k &#039;1&#039;</p><p>config switch_vlan<br />&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;switch0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option vlan &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option vid &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ports &#039;1 2 3 5t&#039;</p><p>config switch_vlan<br />&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;switch0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option vlan &#039;2&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option vid &#039;30&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ports &#039;0 5t&#039;</p><p>config switch_port<br />&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;switch0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option port &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option led &#039;6&#039;</p><p>config switch_port<br />&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;switch0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option port &#039;2&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option led &#039;9&#039;</p><p>config switch_port<br />&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;switch0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option port &#039;5&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option led &#039;2&#039;</p><p>config interface &#039;Visitor&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option _orig_ifname &#039;wlan0-1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option _orig_bridge &#039;false&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;10.10.10.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;</p><br /><p>Following config gets my ISP PPPoE working but unfortunetaly IPTV VLAN 30 doesn&#039;t.<br />To get PPPoE working I&#039;ve changed the WAN connection to eth1 and according to the ISP helpdesk input set VLAN 30 on DHCP.<br />IPTV on VLAN 30 is still not working.</p><br /><p>config interface &#039;loopback&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;lo&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;127.0.0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.0.0.0&#039;</p><p>config globals &#039;globals&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ula_prefix &#039;fda6:826c:2cba::/48&#039;</p><p>config interface &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option force_link &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option type &#039;bridge&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ip6assign &#039;60&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;10.0.0.1&#039;</p><p>config interface &#039;wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option _orig_ifname &#039;eth1.10&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option _orig_bridge &#039;false&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;pppoe&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option username &#039;username@ISP&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option password &#039;password@ISP&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth1&#039;</p><p>config interface &#039;wan_tvbox&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth1.30 eth0.30&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option type &#039;bridge&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option _orig_ifname &#039;eth0.30 eth1.30&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option _orig_bridge &#039;true&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;dhcp&#039;</p><p>config interface &#039;wan6&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;@wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;dhcpv6&#039;</p><p>config switch<br />&nbsp; &nbsp; &nbsp; &nbsp; option name &#039;switch0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option reset &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option enable_vlan &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option blinkrate &#039;2&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option enable_vlan4k &#039;1&#039;</p><p>config switch_vlan<br />&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;switch0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option vlan &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option vid &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ports &#039;1 2 3 5t&#039;</p><p>config switch_vlan<br />&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;switch0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option vlan &#039;2&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option vid &#039;30&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ports &#039;0 5t&#039;</p><p>config switch_port<br />&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;switch0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option port &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option led &#039;6&#039;</p><p>config switch_port<br />&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;switch0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option port &#039;2&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option led &#039;9&#039;</p><p>config switch_port<br />&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;switch0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option port &#039;5&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option led &#039;2&#039;</p><p>config interface &#039;Visitor&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option _orig_ifname &#039;wlan0-1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option _orig_bridge &#039;false&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;10.10.10.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;</p><br /><p>Brgds.</p>											<p class="post-edited">(Last edited by <strong>bavan_ms</strong> on 15 Oct 2014, 01:53)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p250588">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">moeller0</div>
					<div class="post-datetime">
						15 Oct 2014, 01:50					</div>
				</div>
				<div class="post-content content">
					<p>Hi Bavan,</p><div class="quotebox"><cite>bavan_ms wrote:</cite><blockquote><p>Hi Ieeandy,</p><p>I&#039;ve installed BB 14.07 from <a href="http://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/">http://downloads.openwrt.org/barrier_br … x/generic/</a><br />Seems the previous version 14.07 I was running was a custom build version and it didn&#039;t support the opk update cmd.</p><p>After installing BB final 14.07 and just to make sure I&#039;ve successfully installed the 2 packages and Nano editor is working.<br />&nbsp; &nbsp; opkg update<br />&nbsp; &nbsp; opkg install kmod-8021q kmod-bridge nano</p><p>I&#039;ve reconfigured the VLANs according your latest post. WAN PPPoE on eth1.10 is not connecting. IPTV on eth0.30 / 1.30 neither.<br />I&#039;ve seen on another post that for ADSL it could be, instead of VDSL, that I need to use PPPoATM to get things going.<br />Switching from PPPoE to PPPoATM in Open WRT gives me a warning that the PPPoATM package is not installed</p><p>I&#039;ve tried to install it via SSH terminal session but did not succeed (opkg install ppp-mod-pppoa didn&#039;t work).</p><p>What is the correct SSH Putty cmd to download and install PPPoATM?</p><p>Note: I&#039;ve checked with the helpdesk from the ISP what are the settings and protocols they use. They&#039;ve told me that the PPPoE/PPPoATM VLAN 10 session needs to be up and running before the IPTV VLAN 30 can get a DHCP address. Not sure wether it needs to be tagged or untagged. I hope all of this this make sense as I&#039;m out of my comfort zone and rely on their input and feedback (I had a very friendly helpdesk engineer who tried to explain it but I can not guarantee if this statement is correct).</p><p>Brgds.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; PPPoATM will only work from your router if the router had a built in ADSL modem, it will not work if your modem is connected via ethernet to the router (caveat some modems can translate a PPtP connection from the router into a PPPoA connection to the ISP).</p><p>Best Regards<br />&nbsp; &nbsp; &nbsp; M.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p250589">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">bavan_ms</div>
					<div class="post-datetime">
						15 Oct 2014, 01:55					</div>
				</div>
				<div class="post-content content">
					<p>Sorry our mails just crossed. I&#039;ve updated my previous post.<br />Can you have a look again?</p><p>I would appreciate it if you could tell me how to install the PPPoATM package.<br />Just to give it it a try. Seen posts where people refer to it in a seperate router / modem bridge config.</p><p>ADSL modem is in bridged mode so the PPP is done on the WNDR3700 router.</p><p>I understand what you are saying about the modem setup but since I can get things running with VLANs &amp; IPTV I&#039;ll try whatever option is available to test whatever config could work Y/N.</p><p>And yes I&#039;m learning a lot out of it so thanks already for all your time and effort.</p><p>Tx.</p>											<p class="post-edited">(Last edited by <strong>bavan_ms</strong> on 15 Oct 2014, 02:45)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p250613">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">leeandy</div>
					<div class="post-datetime">
						15 Oct 2014, 06:38					</div>
				</div>
				<div class="post-content content">
					<p>Hi bavan.</p><p>Please post exactly your isp modem model.<br />Post screenshot WAN modem page, and screenshot of tvbox network page config.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p250635">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">moeller0</div>
					<div class="post-datetime">
						15 Oct 2014, 11:16					</div>
				</div>
				<div class="post-content content">
					<p>Hi Bavan_ms,</p><div class="quotebox"><cite>bavan_ms wrote:</cite><blockquote><p>Sorry our mails just crossed. I&#039;ve updated my previous post.<br />Can you have a look again?</p><p>I would appreciate it if you could tell me how to install the PPPoATM package.<br />Just to give it it a try. Seen posts where people refer to it in a seperate router / modem bridge config.</p><p>ADSL modem is in bridged mode so the PPP is done on the WNDR3700 router.</p><p>I understand what you are saying about the modem setup but since I can get things running with VLANs &amp; IPTV I&#039;ll try whatever option is available to test whatever config could work Y/N.</p><p>And yes I&#039;m learning a lot out of it so thanks already for all your time and effort.</p><p>Tx.</p></blockquote></div><br /><p>&nbsp; &nbsp; &nbsp;I am sorry to keep harping on it, but PPPoA on your WNDR3700 is not going to work, it really really needs to work directly on an ATM link, but you connect your wnder3700 via ethernet to your modem. Have a look at <a href="http://tools.ietf.org/html/rfc2364">http://tools.ietf.org/html/rfc2364</a> this. So it is immaterial whether you can install the pppoa opkg and kernel modules or not; if you need to use a pppoa client that has to run directly on your modem. And that might have a chance of working: un-bridge your DSL-modem, configure it to use PPPoA (or what your ISP defaults to) and then connect the wndr3700 to the modem&#039;s lan port; hopefully the modem also takes care of the vlans... Also did you have a look at IGMP (in addition to VLANs)? Some ISPs use multicast to transport IPTV streams.<br />&nbsp; &nbsp; Sorry to not be of more help but I have no personal experience with VLANs, but wanted to share what I know about pppoa&#039;s requirements (namely needs to run directly on the ATM link). Hope that helps....</p><p>Best Regards<br />&nbsp; &nbsp; &nbsp; M.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p250638">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">bavan_ms</div>
					<div class="post-datetime">
						15 Oct 2014, 11:32					</div>
				</div>
				<div class="post-content content">
					<p>Okidoki, that sounds a good idea. Instead of terminating the WAN session in the WNDR3700 I&#039;ll try to do it directly on the ADSL modem and see what that does to the VLANs on the WNDR3700. In this case the WNDR3700 wil be linked to the ADSL modem via DHCP.</p><p>Haven&#039;t thought about that so Tx for the tip.</p><p>Will be for this evening as I&#039;m away for the moment.</p><p>Brgds.</p>											<p class="post-edited">(Last edited by <strong>bavan_ms</strong> on 15 Oct 2014, 11:33)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p250664">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">bavan_ms</div>
					<div class="post-datetime">
						15 Oct 2014, 14:46					</div>
				</div>
				<div class="post-content content">
					<p>The ADSL modem I&#039;m using is an Eminent EM4202.</p><p>More info about this modem can befound on the supplier website<br /><a href="http://www.eminent-online.com/en/product/562/em4204-dsurf-adsl2-2--modem.html">http://www.eminent-online.com/en/produc … modem.html</a></p><p>Manual download URL<br /><a href="http://downloads.eminent-online.com/4204man.zip">http://downloads.eminent-online.com/4204man.zip</a></p><p>I was in the understanding that if I use the modem in bridge mode all WAN data traffic would be directly forwarded via its ethernet ports to the router behind it. In that way there shouldn&#039;t be any impact on the VLAN data routing from the ISP to the router behind it. I couldn&#039;t find much info on that in the manual so it&#039;s something I have to check in one way or another.<br />Question is how I can check that in bridged mode (VLAN data traffic Y/N)? I have no packet analyzer to put on the ISP line but maybe it can be done via the WNDR3700?</p><p>Note: In the end I hope the modem is not the blocking factor for VLAN data to pass through. If it does it would explain why the WNDR3700 VLAN config doesn&#039;t work.</p><p>This evening I&#039;ll be doing some testing with the modem terminating the WAN ISP connection (PPPoE/PPPoA) and putting the WNDR3700 behind it on ethernet DHCP. This to check if I can get the VLANs to work.</p><p>I&#039;ll keep my results posted.</p><p>PS: I&#039;m trying to copy screenshots in the posting but windows simple copy/paste doesn&#039;t work. How can I include screenshots?</p>											<p class="post-edited">(Last edited by <strong>bavan_ms</strong> on 15 Oct 2014, 14:48)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0.001 -->

</body>
</html>