<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> problem with hurricane electric</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 6 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p125367">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">calros</div>
					<div class="post-datetime">
						14 Jan 2011, 03:15					</div>
				</div>
				<div class="post-content content">
					<p>hi guys, it&#039;s been 3 days I&#039;m stuck on setting up hurricane electric ipv6 tunnel, I&#039;ve red tons of tutorials and everyone says pretty much the same thing, still I couldn&#039;t get to solve to access the ipv6 internet, for example, doing ping6 2a00:1450:8006::98 (an ip address from google, or any other for that matter), i never receive a reply.</p><p>I&#039;ve a kamikaze openwrt router (a fonera) on a nat behind a modem, this modem is pretty basic, it doesn&#039;t have an option to let protocol 41 pass, so I put the openwrt router as a dmz host. I tried many ways, here i list my configuration for 6 tunnel:</p><p>This is what I have installed in the router: </p><div class="codebox"><pre><code>root@OpenWrt:/# opkg list
6scripts - 0.1-1 - 
base-files-atheros - 14.3-r18961 - 
bridge - 1.4-1 - 
busybox - 1.11.2-2.2 - 
dnsmasq - 2.47-3.3 - 
dropbear - 0.51-2 - 
firewall - 1-1.2 - 
gpioctl - 1.0-1 - 
hostapd-mini - 0.6.6-1.1 - 
hotplug2 - 0.9+r102-2 - 
ip - 2.6.25-1 - 
ip6tables - 1.4.0-1 - 
iptables - 1.4.0-1 - 
iptables-mod-conntrack - 1.4.0-1 - 
iptables-mod-nat - 1.4.0-1 - 
kernel - 2.6.26.8-atheros-1 - 
kmod-ip6-tunnel - 2.6.26.8-atheros-1 - 
kmod-ip6tables - 2.6.26.8-atheros-1 - 
kmod-ipt-conntrack - 2.6.26.8-atheros-1 - 
kmod-ipt-core - 2.6.26.8-atheros-1 - 
kmod-ipt-nat - 2.6.26.8-atheros-1 - 
kmod-ipt-nathelper - 2.6.26.8-atheros-1 - 
kmod-iptunnel4 - 2.6.26.8-atheros-1 - 
kmod-iptunnel6 - 2.6.26.8-atheros-1 - 
kmod-ipv6 - 2.6.26.8-atheros-1 - 
kmod-madwifi - 2.6.26.8+r3314-atheros-2.3 - 
kmod-ppp - 2.6.26.8-atheros-1 - 
kmod-pppoe - 2.6.26.8-atheros-1 - 
kmod-sit - 2.6.26.8-atheros-1 - 
libgcc - 4.1.2-14.3 - 
liblua - 5.1.4-2 - 
libnl-tiny - 0.1-1 - 
libuci - 0.7.3-1 - 
libuci-lua - 0.7.3-1 - 
lua - 5.1.4-2 - 
luci-admin-core - 0.8.8-1 - 
luci-admin-full - 0.8.8-1 - 
luci-admin-mini - 0.8.8-1 - 
luci-cbi - 0.8.8-1 - 
luci-core - 0.8.8-1 - 
luci-http - 0.8.8-1 - 
luci-i18n-english - 0.8.8-1 - 
luci-ipkg - 0.8.8-1 - 
luci-sgi-cgi - 0.8.8-1 - 
luci-sys - 0.8.8-1 - 
luci-theme-base - 0.8.8-1 - 
luci-theme-openwrt - 0.8.8-1 - 
luci-uci - 0.8.8-1 - 
luci-uvl - 0.8.8-1 - 
luci-web - 0.8.8-1 - 
mtd - 8.2 - 
opkg - 4564-3.1 - 
ppp - 2.4.3-11.2 - 
ppp-mod-pppoe - 2.4.3-11.2 - 
radvd - 1.2-1.1 - 
swconfig - 1.2 - 
tcptraceroute6 - 0.5.1-1 - 
uci - 0.7.3-1 - 
uclibc - 0.9.29-14.3 - 
udevtrigger - 106-1.1 - 
wireless-tools - 29-2 -</code></pre></div><p>ipv6 works on the lan.</p><p>This is what my hurricane electric account looks like:</p><div class="codebox"><pre><code>IPv6 Tunnel Endpoints
Server IPv4 address:    216.66.80.98
Server IPv6 address:     2001:470:25:324::1/64
Client IPv4 address:     151.15.172.9
Client IPv6 address:     2001:470:25:324::2/64
Available DNS Resolvers
Anycasted IPv6 Caching Nameserver:    2001:470:20::2
Anycasted IPv4 Caching Nameserver:    74.82.42.42
Routed IPv6 Prefixes and rDNS Delegations
Routed /48:     Allocate /48
Routed /64:     2001:470:26:324::/64</code></pre></div><p>Hurricane electric doesn&#039;t give any error on reaching my public ip address with icmp.</p><p>this is my /etc/config/6tunnel:</p><div class="codebox"><pre><code>config &#039;6tunnel&#039;
        option &#039;tnlifname&#039; &#039;henet&#039;
        option &#039;remoteip4&#039; &#039;216.66.80.98&#039;
        option &#039;localip4&#039; &#039;192.168.1.2&#039; # not sure about putting the local address (because behind a nat) or the public one (because on a dmz)
#       option &#039;localip4&#039; &#039;151.15.72.9&#039; # I&#039;ve tried both configurations with no luck
        option &#039;localip6&#039; &#039;2001:470:25:324::2/64&#039;
        option &#039;prefix&#039; &#039;2001:470:26:324::2/64&#039;</code></pre></div><p>and this is route -A inet6:<br /></p><div class="codebox"><pre><code>root@OpenWrt:/# route -A inet6
Kernel IPv6 routing table
Destination                                 Next Hop                                Flags Metric Ref    Use Iface
2001:470:25:324::/64                        ::                                      U     256    0        0 henet   
2001:470:26:324::/64                        ::                                      U     256    0        0 br-lan  
2000::/3                                    ::                                      U     1024   0        0 henet   
fe80::/64                                   ::                                      U     256    0        0 eth0    
fe80::/64                                   ::                                      U     256    0        0 br-lan  
fe80::/64                                   ::                                      U     256    0        0 ath0    
fe80::/64                                   ::                                      U     256    0        0 henet   
::/0                                        ::                                      U     1024   0        0 br-lan  
::/0                                        ::                                      U     1024   0        0 henet   
::1/128                                     ::                                      U     0      0        1 lo      
2001:470:25:324::/128                       ::                                      U     0      0        1 lo      
2001:470:25:324::2/128                      ::                                      U     0      0        1 lo      
2001:470:26:324::/128                       ::                                      U     0      0        1 lo      
2001:470:26:324::2/128                      ::                                      U     0      0        1 lo      
fe80::/128                                  ::                                      U     0      0        1 lo      
fe80::/128                                  ::                                      U     0      0        1 lo      
fe80::/128                                  ::                                      U     0      0        1 lo      
fe80::c0a8:102/128                          ::                                      U     0      0        1 lo      
fe80::218:84ff:fe82:ab80/128                ::                                      U     0      0        1 lo      
fe80::218:84ff:fe82:ab81/128                ::                                      U     0      0        1 lo      
fe80::bce2:85ff:fe2d:b822/128               ::                                      U     0      0        1 lo      
ff00::/8                                    ::                                      U     256    0        0 eth0    
ff00::/8                                    ::                                      U     256    0        0 br-lan  
ff00::/8                                    ::                                      U     256    0        0 ath0    
ff00::/8                                    ::                                      U     256    0        0 henet

root@OpenWrt:/# ip tunnel show
sit0: ipv6/ip  remote any  local any  ttl 64  nopmtudisc
henet: ipv6/ip  remote 216.66.80.98  local 192.168.1.2  ttl 255</code></pre></div><p>this is the network file:<br /></p><div class="codebox"><pre><code>root@OpenWrt:/# cat /etc/config/network

config &#039;interface&#039; &#039;loopback&#039;
        option &#039;ifname&#039; &#039;lo&#039;
        option &#039;proto&#039; &#039;static&#039;
        option &#039;ipaddr&#039; &#039;127.0.0.1&#039;
        option &#039;netmask&#039; &#039;255.0.0.0&#039;

config &#039;interface&#039; &#039;lan&#039;
        option &#039;ifname&#039; &#039;eth0&#039;
        option &#039;type&#039; &#039;bridge&#039;
        option &#039;proto&#039; &#039;static&#039;
        option &#039;netmask&#039; &#039;255.255.255.0&#039;
        option &#039;ip6addr&#039; &#039;2001:470:26:324::2/64&#039; 
        option &#039;ipaddr&#039; &#039;192.168.1.2&#039;
        option &#039;defaultroute&#039; &#039;0&#039;
        option &#039;peerdns&#039; &#039;0&#039;
        option &#039;gateway&#039; &#039;192.168.1.254&#039;

config &#039;interface&#039; &#039;wan&#039;
        option &#039;ifname&#039; &#039; &#039;
        option &#039;proto&#039; &#039;none&#039;</code></pre></div><p>this is radvd, even if i thing it is not necessary to show for the problem i have:<br /></p><div class="codebox"><pre><code>root@OpenWrt:/# cat /etc/config/radvd 
config interface
        option interface        &#039;lan&#039;
        option AdvSendAdvert    1
        option AdvManagedFlag   0
        option AdvOtherConfigFlag 0
        option ignore           0

config prefix
        option interface        &#039;lan&#039;
        option prefix           &#039;2001:470:26:324::/64&#039; 
        option AdvOnLink        1
        option AdvAutonomous    1
        option AdvRouterAddr    0
        option ignore           0 

config rdnss
        option interface        &#039;lan&#039;
        option addr             &#039;&#039; # &#039;2001:470:26:324::/64&#039; 
        option ignore           0</code></pre></div><p>you might think that is a firewall problem, well, i put this line in my /etc/config/firewall &quot; accept:proto=41 &quot; but i noted that when starting the firewall it give a parse error for that line, so, to be sure, i disabled the firewall &quot;doing /etc/init.d/firewall stop&quot; and &quot;doing /etc/init.d/firewall disable&quot;.</p><p>No luck. Where could the problem possibly be? why i cannot get to the ipv6 internet? It seems so easy, but I&#039;m going insane.</p><p>thanks, calros</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125369">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">KillaB</div>
					<div class="post-datetime">
						14 Jan 2011, 04:07					</div>
				</div>
				<div class="post-content content">
					<p>Typo?</p><div class="quotebox"><blockquote><p>Client IPv4 address:&nbsp; &nbsp; &nbsp;151.15.172.9</p></blockquote></div><div class="quotebox"><blockquote><p>#&nbsp; &nbsp; &nbsp; &nbsp;option &#039;localip4&#039; &#039;151.15.72.9&#039;</p></blockquote></div><p>You definitely need to use your public v4 address in your config.<br />If that doesn&#039;t work, you might want to try upgrading to 10.03.1-rc4 or trunk and using 6in4 instead of 6scripts.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125371">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">calros</div>
					<div class="post-datetime">
						14 Jan 2011, 04:35					</div>
				</div>
				<div class="post-content content">
					<p>you have good eyes! yes, it was a typo this time, i corrected it but unfortunately it didn&#039;t resolve the problem (my ip from the isp is dynamic and during these days it changed a number of times), i&#039;ll probably upgrade the firmware as you suggest (current version is kamikaze/8.09.2) if there is no other ways, thanks</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>