<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Archer C5 loses config/packages on reboot and USB problem</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 13 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p273885">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">fenris</div>
					<div class="post-datetime">
						25 Apr 2015, 11:19					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m using Chaos Calmer r45560, and can set everything up, no problem. But every time I reboot, it reverts to a fresh install - no password set, no packages installed, etc.</p><p>root@router:~# df<br />Filesystem&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Size&nbsp; &nbsp; &nbsp; Used Available Use% Mounted on<br />rootfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;12.8M&nbsp; &nbsp; &nbsp; 8.7M&nbsp; &nbsp; &nbsp; 4.0M&nbsp; 69% /<br />/dev/root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2.0M&nbsp; &nbsp; &nbsp; 2.0M&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 100% /rom<br />tmpfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 61.5M&nbsp; &nbsp; &nbsp; 1.8M&nbsp; &nbsp; &nbsp;59.7M&nbsp; &nbsp;3% /tmp<br />tmpfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 61.5M&nbsp; &nbsp; &nbsp;32.0K&nbsp; &nbsp; &nbsp;61.5M&nbsp; &nbsp;0% /tmp/root<br />tmpfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;512.0K&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; 512.0K&nbsp; &nbsp;0% /dev<br />/dev/mtdblock3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;12.8M&nbsp; &nbsp; &nbsp; 8.7M&nbsp; &nbsp; &nbsp; 4.0M&nbsp; 69% /overlay<br />overlayfs:/overlay&nbsp; &nbsp; &nbsp; &nbsp;12.8M&nbsp; &nbsp; &nbsp; 8.7M&nbsp; &nbsp; &nbsp; 4.0M&nbsp; 69% /</p><p>Also, I can&#039;t get USB to work properly. When I plug in a flash drive the kernel sees it, but it doesn&#039;t add a device node for it, so I can&#039;t mount it.</p><p>root@router:~# opkg list-installed | grep usb<br />kmod-ledtrig-usbdev - 3.18.11-1<br />kmod-usb-core - 3.18.11-1<br />kmod-usb-ohci - 3.18.11-1<br />kmod-usb-storage - 3.18.11-1<br />kmod-usb-storage-extras - 3.18.11-1<br />kmod-usb-uhci - 3.18.11-1<br />kmod-usb2 - 3.18.11-1<br />libusb-1.0 - 1.0.19-1<br />usbreset - 4<br />usbutils - 007-1</p><p>Is there anything I&#039;m missing? I found nothing in the wiki.</p><p>Any ideas?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p273920">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">drawz</div>
					<div class="post-datetime">
						25 Apr 2015, 15:43					</div>
				</div>
				<div class="post-content content">
					<p>Sounds like you may have done the initial flash with a file labeled sysupgrade instead of factory, at least as far as the losing settings part. The factory file configures the partitions properly for OpenWrt. </p><p>Not sure about the USB bit.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p273924">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">fenris</div>
					<div class="post-datetime">
						25 Apr 2015, 16:08					</div>
				</div>
				<div class="post-content content">
					<p>I did the flash with the factory file, straight from the factory firmware. I am certain of this, because I did it twice, with reverting to the TP-Link factory firmware between each flash.</p><p>When I get the time, I can download it again, flash the TP-Link firmware and then flash the factory image a third time, just to see. For now, though, I just don&#039;t reboot <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Any other ideas on things I can check would be appreciated, since I would really like to avoid a reinstall.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p273989">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">drawz</div>
					<div class="post-datetime">
						26 Apr 2015, 05:28					</div>
				</div>
				<div class="post-content content">
					<p>You don&#039;t need to revert to factory to flash a &quot;factory&quot; openwrt file. The main difference is that the &quot;factory&quot; OpenWrt will configure/wipe the overlay partition (I think). You can flash this over an existing OpenWrt install just fine. In fact, I suggest you give it a try. Make sure you do not save your settings when flashing. </p><p>Also, are you using the squashfs build? Maybe just link to the file you are using?</p><p>Just for testing purposes, you could also try using BB 14.07 final.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p273994">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">fenris</div>
					<div class="post-datetime">
						26 Apr 2015, 09:11					</div>
				</div>
				<div class="post-content content">
					<p><a href="https://downloads.openwrt.org/snapshots/trunk/ar71xx/generic/openwrt-ar71xx-generic-archer-c5-squashfs-factory.bin">https://downloads.openwrt.org/snapshots â€¦ actory.bin</a></p><p>This is the file I flashed with. I know I didn&#039;t have to go back to the TP-Link firmware, I just did it to make doubly sure I had followed the instructions to the letter. So you think I should flash the factory image from the webui, not saving settings? BB final worked OK, I don&#039;t remember having any problems such as this one.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p274029">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">drawz</div>
					<div class="post-datetime">
						26 Apr 2015, 20:28					</div>
				</div>
				<div class="post-content content">
					<p>Could be a problem with the specific build you have. That&#039;s the risk with trunk. I&#039;d stick to Barrier Breaker or at least try an updated trunk. And yes, save yourself the trouble and risk of going back to stock.</p>											<p class="post-edited">(Last edited by <strong>drawz</strong> on 26 Apr 2015, 20:28)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>