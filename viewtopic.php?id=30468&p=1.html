<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> wzr-hp-ag300h progress</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 25 Aug 2016 and 5 Apr 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 4</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=30468&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=30468&amp;p=3.html">3</a></li><li><a href="viewtopic.php%3Fid=30468&amp;p=4.html">4</a></li></ul></nav></div>
			
		
		
			<article class="post" id="p137238">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">KingJL</div>
					<div class="post-datetime">
						15 Jun 2011, 17:49					</div>
				</div>
				<div class="post-content content">
					<p>Is anyone willing to report success/failure with OpenWrt on the wzr-hp-ag300h.&nbsp; I have OpenWrt loaded on my wzr-hp-g300nh and do a &#039;trunk&#039; build weekly to keep up to date, but I am holding back on moving my wzr-hp-ag300h to OpenWrt.&nbsp; The wzr-hp-ag300h is my main router, and I need some stability/reliability.&nbsp; I am willing to move there if and when both radios are working somewhat reliably.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p137251">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">surroundedbytrees</div>
					<div class="post-datetime">
						15 Jun 2011, 21:32					</div>
				</div>
				<div class="post-content content">
					<p>i installed the OpenWRT build here Monday.&nbsp; Seems to run solid so far, I&#039;ve yet to get the 5ghz channel working, but I don&#039;t have any devices to connect with so it&#039;s not an issue at the moment.</p><p>The wifi signal seems to be a little more stable then either the Buffalo FW or the DD_wrt one.&nbsp; Once I do some more reading I&#039;ll try a txpower set and see if indeed I can improve the lackluster range of the unit</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p137338">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">KingJL</div>
					<div class="post-datetime">
						17 Jun 2011, 02:32					</div>
				</div>
				<div class="post-content content">
					<p>Has anyone had success in using both radios on the wzr-hp-ag300h simultaneously?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p137804">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">dimitris</div>
					<div class="post-datetime">
						24 Jun 2011, 21:11					</div>
				</div>
				<div class="post-content content">
					<p>I have 5GHz devices to test against my AG300H, but I haven&#039;t been able to install openWRT.</p><p>The unit came with the OEM version of DD-WRT.&nbsp; I tried a firmware upgrade through its web iterface, using all combinations of squashfs/jff2 and factory/sysupgrade variants of trunk snapshots (dated 2011/06/23).&nbsp; In all cases the OEM upgrade process didn&#039;t seem to like the firmware image and failed.</p><p>I also tried the TFTP method (same trunk version), going by the instructions for the G300NH variant (<a href="http://wiki.openwrt.org/toh/buffalo/wzr-hp-g300h#installation">http://wiki.openwrt.org/toh/buffalo/wzr … stallation</a>) since there isn&#039;t anything in the wiki for the AG300H yet.&nbsp; Both with and without a switch between the machine running tftp, and with the ARP entry pre-entered in both cases, the TFTP client times out.</p><p>Does the AG300H, in OEM form, have the same TFTP function in its bootloader?&nbsp; Does it need some button pressed on power-up to become active?</p><p>How did you install openWRT on it?</p><p>Sorry about the thread creep.&nbsp; Hopefully I&#039;ll make it up by reporting back here with my dual-band results.&nbsp; I can afford some instability since the main router job is done, for the time being, by a WRT54GL - which tells you how long it&#039;s been since I&#039;ve done the TFTP thing.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p137811">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">dimitris</div>
					<div class="post-datetime">
						24 Jun 2011, 22:49					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dimitris wrote:</cite><blockquote><p>Does the AG300H, in OEM form, have the same TFTP function in its bootloader?&nbsp; Does it need some button pressed on power-up to become active?</p></blockquote></div><p>After a little more googling I found my answer at: <a href="http://forums.buffalotech.com/t5/Wireless/WZR-HP-AG300H-Transmit-power/td-p/60842/page/2">http://forums.buffalotech.com/t5/Wirele … 842/page/2</a></p><div class="quotebox"><blockquote><p>On all devices, the bootloader listens for HW address 02:aa:bb:cc:dd:20 with IP 192.168.11.1, so set that with &quot;arp -s 192.168.11.1 02:aa:bb:cc:dd:20&quot;.&nbsp; Also, the bootloader does not respond to pings.</p></blockquote></div><p>Note that MAC address is literal.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p137813">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">padams</div>
					<div class="post-datetime">
						25 Jun 2011, 00:17					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for posting that info - I&#039;m picking up a pair of these today to test OpenWRT / WING on.</p><p>I was also hopeing the dual band thing works out...</p><p>Paul</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p137817">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">dimitris</div>
					<div class="post-datetime">
						25 Jun 2011, 03:31					</div>
				</div>
				<div class="post-content content">
					<p>Looks like the second, 5GHz wireless device <a href="https://dev.openwrt.org/ticket/9608">isn&#039;t being enabled</a> on this router by the driver, yet.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p137943">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">dimitris</div>
					<div class="post-datetime">
						27 Jun 2011, 05:17					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dimitris wrote:</cite><blockquote><p>Looks like the second, 5GHz wireless device <a href="https://dev.openwrt.org/ticket/9608">isn&#039;t being enabled</a> on this router by the driver, yet.</p></blockquote></div><p>The bug above seems to have been fixed; posting this from a 5GHz client, router is running r27290.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p137994">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">aswin1980</div>
					<div class="post-datetime">
						27 Jun 2011, 20:42					</div>
				</div>
				<div class="post-content content">
					<p>Hi,<br /> i&#039;m having 2 buffalo g300nh routers. the first one was bought in India<br /> having the version number as b0 c0, the second one was bought in US having<br /> the version as A2 A0.</p><p> i have built the firmware from source (SVN Version 27291- built from<br /> scratch) with additional packages. i was able to upgrade the firmware<br /> using tftp on the router which was bought in India. however, the router<br /> which was bought in the US is not working after updating with g300nh<br /> firmware. the ethernet is defunct as i dont see any dhcp packet on lan/wan<br /> and the red light stays on.</p><p> Based on jow&#039;s input instead of g300nh firmware i used g301nh firmware on<br /> the US router. the ethernet started to work.</p><p> The only issue with g301 firmware is although the ethernet is working i<br /> dont see the green router icon flashing which is actually flashing in the<br /> router that was bought in India running g300 firmware.</p><p> Also, the red diag light is always On on the g301 firmware. i tried to<br /> change the status on the LED configuration, still no use.</p><p> Could you please let me know why the US router requires g301 firmware as<br /> opposed to g300 firmware. what is causing this issue.</p><p> Thanks,<br /> Aswin</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p138003">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">ichilton</div>
					<div class="post-datetime">
						27 Jun 2011, 21:52					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I believe that a new revision of the WZR-HP-G300NH came out with a revised ethernet chipset - the same one as in the G301.</p><p>I&#039;m guessing from your LED problem that there is either a bug in the code which isn&#039;t controlling them correctly, or the G301&#039;s LED&#039;s are different to the G300.</p><p>Ian</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p138014">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">padams</div>
					<div class="post-datetime">
						28 Jun 2011, 01:26					</div>
				</div>
				<div class="post-content content">
					<p>OK - I&#039;m struggling to get my WRT-HP-AG300H updated...</p><p>Downloaded the OpenWRT snapshot tftp firmware</p><p>Using an XP machine, network card set to 100MB full duplex, turned the firewall off, set to 192.168.11.2, ran the ARP static addition and used the MAC address of 02:aa:bb:cc:dd:20</p><p>Cannot seem to update via the web based DD-WRT menu - so...</p><p>1) plugged directly to the router, tftp from the command line - times out every time<br />2) plugged directly, tried using tftd32 - times out every time<br />3) plugged directly using another XP machine - times out every time<br />4) tried via a switch - times out every time...</p><br /><p>I&#039;m I meant to be editing the bin firmware file somehow???</p><p>Help welcome...</p><p>Paul</p>											<p class="post-edited">(Last edited by <strong>padams</strong> on 28 Jun 2011, 01:33)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p138015">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">dimitris</div>
					<div class="post-datetime">
						28 Jun 2011, 01:56					</div>
				</div>
				<div class="post-content content">
					<p>Have you tried not setting the ethernet interface to 100Mbps?&nbsp; I had left mine (Linux machine, but shouldn&#039;t make a difference) to its gigabit default, and once I took care of ARP for the bootloader-only MAC address TFTP worked.&nbsp; The ag300h has a gigabit interface/switch so &quot;downgrading&quot; to 100Mbps may no longer be a necessary step.</p>											<p class="post-edited">(Last edited by <strong>dimitris</strong> on 28 Jun 2011, 01:56)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p138017">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">padams</div>
					<div class="post-datetime">
						28 Jun 2011, 02:23					</div>
				</div>
				<div class="post-content content">
					<p>Thanks - tried - times out...</p><p>I&#039;ve got a CentOS machine at home - I think I&#039;ll try that.</p><p>Paul</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p138039">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">ichilton</div>
					<div class="post-datetime">
						28 Jun 2011, 10:13					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I had that same problem - just getting timeouts on tftp with my G300NH - was using an old Windows laptop.</p><p>Tried everything I could think of and couldn&#039;t get it going.</p><p>Someone suggested trying a switch in between which I didn&#039;t understand at first, but it worked first time - and I saw why....with the laptop into the router, Windows would show the port was disconnected when the power was off and then would take a bit of time to register the link when it came on so it must have been missing the tftp window.</p><p>I see you&#039;ve tried that, but it may be worth trying a different switch if you can, in case that was making any difference?</p><p>Ian</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p138084">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">padams</div>
					<div class="post-datetime">
						28 Jun 2011, 19:06					</div>
				</div>
				<div class="post-content content">
					<p>Thanks Ian - you posted before I had a chance to - that&#039;s exactly my findings as well.</p><p>A windows XP laptop directly connected - times out.</p><p>XP laptop connected via switch, (different switch then the one earlier in the day) - worked first time.</p><p>If it didn&#039;t work - I was then going to try CentOS.</p><p>Thanks guys</p><p>Paul</p>											<p class="post-edited">(Last edited by <strong>padams</strong> on 28 Jun 2011, 19:08)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p138085">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">ichilton</div>
					<div class="post-datetime">
						28 Jun 2011, 19:10					</div>
				</div>
				<div class="post-content content">
					<p>Cool - glad you got it going!</p><p>Ian</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p138092">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">dimitris</div>
					<div class="post-datetime">
						28 Jun 2011, 20:18					</div>
				</div>
				<div class="post-content content">
					<p>Paul: For future reference, can you post the type/speeds of the switches that did (not) work?</p><p>I wonder if the ethernet interfaces are somehow speed-locked when in &quot;bootloader state&quot;.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p138100">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">aswin1980</div>
					<div class="post-datetime">
						28 Jun 2011, 22:01					</div>
				</div>
				<div class="post-content content">
					<p>Ian,</p><p>how to check the g301 led are different. if so how to fix it</p><p>Thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p138101">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">ichilton</div>
					<div class="post-datetime">
						28 Jun 2011, 22:09					</div>
				</div>
				<div class="post-content content">
					<p>Not a clue - was only guessing!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p138104">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">padams</div>
					<div class="post-datetime">
						28 Jun 2011, 22:39					</div>
				</div>
				<div class="post-content content">
					<p>Cheap, new-ish, Cisco Linksys 5 port 10/100 &#039;Etherfast&#039; desktop switch - did not work.</p><p>Equally cheap, 5 year old, D-Link 8 port 10/100 desktop switch - worked.</p><p>The only difference I can tell is the age of the switches.&nbsp; Or my incompetence at getting the Buffalo updated...&nbsp; &nbsp;:-)</p><p>Paul</p>											<p class="post-edited">(Last edited by <strong>padams</strong> on 28 Jun 2011, 22:42)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p138108">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">KingJL</div>
					<div class="post-datetime">
						29 Jun 2011, 00:25					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>aswin1980 wrote:</cite><blockquote><p>Also, the red diag light is always On on the g301 firmware. i tried to<br />change the status on the LED configuration, still no use.</p></blockquote></div><p>To change&nbsp; the status of the red diag led, edit the file /etc/diag.sh.&nbsp; Change the led state for the &quot;done&#039; case from led_on to led_off, then reboot.&nbsp; The led will be off!<br />Regards,<br />J. L. King</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p138383">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">xabisoh</div>
					<div class="post-datetime">
						3 Jul 2011, 05:26					</div>
				</div>
				<div class="post-content content">
					<p>I am absolutely struggling to get openwrt on this thing, any help would be appreciated please!</p><p><strong>My Setup:</strong><br />I have one isolated machine with win server 2008 wired directly to the router (normal port, not internet port). No internet connection or lan of any kind outside of this one wire.</p><p>I have assigned the host machine the static ip of 192.168.11.2/255.255.255.0 ~ gateway &amp; dns: 192.168.11.1</p><p>The image I am trying to push is: /snapshots/trunk/ar71xx/openwrt-ar71xx-generic-wzr-hp-ag300h-squashfs-tftp.bin</p><p>I have setup a static ARP route to the routers &quot;lan&quot; MAC address<br /></p><div class="quotebox"><blockquote><p>arp -s 192.168.11.1 [MACADDRESS]</p></blockquote></div><p>I have also tried the hard coded mac above:<br /></p><div class="quotebox"><blockquote><p>arp -s 192.168.11.1 02-aa-bb-cc-dd-20</p></blockquote></div><p>My usual method of trying to push this thing is using:<br /></p><div class="quotebox"><blockquote><p>tftp -i 192.168.11.1 put openwrt-ar71xx-generic-wzr-hp-ag300h-squashfs-tftp.bin</p></blockquote></div><p>I have tried waiting at various times of the router booting up to execute the command: a couple seconds after plugging it in, before the router is even plugged in, after the blue pc icon flashes once, etc. Each ends in a time out.</p><p>I have no idea what else to do, other than use ssh from dd-wrt, which i would rather avoid because if I brick the router i am out of options. (not sure if I should use a factory or sysupgrade version for that method...)</p><p>I do not have a switch on hand to try the suggestion a few posts up.</p><p>So if anyone can share their success story I would be greatly appreciative!</p>											<p class="post-edited">(Last edited by <strong>xabisoh</strong> on 3 Jul 2011, 07:06)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p138407">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">dimitris</div>
					<div class="post-datetime">
						3 Jul 2011, 21:44					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>xabisoh wrote:</cite><blockquote><p>I do not have a switch on hand to try the suggestion a few posts up.</p></blockquote></div><p>Do you have / are you using another router right now?&nbsp; You could use its switch as long as there&#039;s no other 192.168.11.{1,2} host on it.&nbsp; Even better if its &quot;LAN&quot; is not on the 192.168.11.0/24 network at all.</p><p>Can you try to force the Windows ethernet driver to either 100Mbps or 1Gbps?&nbsp; That might shorten the time it takes to detect the link is up after the buffalo powers up its switch, perhaps enough to catch the bootloader&#039;s TFTP window.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p138409">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">ichilton</div>
					<div class="post-datetime">
						3 Jul 2011, 23:55					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><p>I do not have a switch on hand to try the suggestion a few posts up.<br />So if anyone can share their success story I would be greatly appreciative!</p></blockquote></div><p>Is there no way you can borrow one from somewhere?</p><p>I had the same problem - tried everything and couldn&#039;t get it to flash until I tried putting a switch inline and it worked first time.</p><p>Ian</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p138414">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">dimitris</div>
					<div class="post-datetime">
						4 Jul 2011, 05:54					</div>
				</div>
				<div class="post-content content">
					<p>Update:</p><p>- Sysupgrade <strong>seems</strong> to work with <a href="https://dev.openwrt.org/ticket/9650">a trivial patch</a> and the squashfs trunk snapshot.&nbsp; YMMV, please don&#039;t blame me if it bricks your router.&nbsp; I did get &quot;can&#039;t fixup TRX header&quot; errors while it ran, but after reboot all is normal, including the config files being preserved.</p><p>- I&#039;ve been using the 5GHz radio for a few days now.&nbsp; The main client has been a 802.11n device (android tablet) and so far the router/wifi stability has been perfect.</p><p>- Speed &quot;tests&quot;:&nbsp; The 5GHz band seems clear where I am.&nbsp; It is configured as follows:</p><div class="codebox"><pre><code>config wifi-device  radio1
        option type     mac80211
        option channel  36
        option macaddr xx:xx:xx:xx:xx:xx
        option hwmode   11na
        option htmode   HT20
        list ht_capab   SHORT-GI-40
        list ht_capab   TX-STBC
        list ht_capab   RX-STBC1
        list ht_capab   DSSS_CCK-40

config wifi-iface
        option device   radio1
        option network  lan
        option mode     ap
        option ssid     &lt;ssid&gt;
        option encryption psk2
        option key &lt;key&gt;</code></pre></div><p>The only &quot;speed tests&quot; I&#039;ve run are with a Lucid laptop very close (1m) to the router, with this wireless card:</p><div class="codebox"><pre><code>03:00.0 Network controller: Intel Corporation Wireless WiFi Link 5300</code></pre></div><p>Typical result:</p><div class="codebox"><pre><code>d@gaspode:~$ nttcp -u -T -l 1400 -n 40000 greebo
     Bytes  Real s   CPU s Real-MBit/s  CPU-MBit/s   Calls  Real-C/s   CPU-C/s
l 56000000    6.73    0.84     66.5421    533.3333   40003   5941.70   47622.6
1 56000000    6.75    0.16     66.3876   2799.8425   40001   5927.61  249992.2</code></pre></div><p>If someone has suggestions for more appropriate speed tests please reply here.</p>											<p class="post-edited">(Last edited by <strong>dimitris</strong> on 4 Jul 2011, 05:57)</p>
									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 1 of 4</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=30468&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=30468&amp;p=3.html">3</a></li><li><a href="viewtopic.php%3Fid=30468&amp;p=4.html">4</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>