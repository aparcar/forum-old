<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Quanta 1k6e and rndis_host problem</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 28 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p243889">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">iAnton</div>
					<div class="post-datetime">
						15 Aug 2014, 02:12					</div>
				</div>
				<div class="post-content content">
					<p>Hello.<br />I&#039;m trying to connect 4G modem Quanta 1k6e to my wl500g router with BARRIER BREAKER (14.07-rc2, r41815), but I have a trouble.<br />When I attach device in log happen:</p><p>Thu Aug 14 21:58:06 2014 kern.info kernel: [&nbsp; 161.580000] usb 2-2: new full-speed USB device number 5 using uhci_hcd<br />Thu Aug 14 21:58:07 2014 kern.info kernel: [&nbsp; 161.800000] rndis_host 2-2:1.0 eth1: register &#039;rndis_host&#039; at usb-0000:00:03.0-2, RNDIS device, 00:16:36:9c:4f:b5</p><br /><p>00:16:36:9c:4f:b5 - I get this mac on Windows machine, where my modem works fine.<br />Next in log:</p><p>Thu Aug 14 21:58:07 2014 daemon.notice netifd: Interface &#039;cdc&#039; is enabled<br />Thu Aug 14 21:58:07 2014 kern.info kernel: [&nbsp; 161.850000] usb-storage 2-2:1.2: USB Mass Storage device detected<br />Thu Aug 14 21:58:07 2014 kern.info kernel: [&nbsp; 161.850000] scsi5 : usb-storage 2-2:1.2<br />Thu Aug 14 21:58:07 2014 daemon.notice netifd: Network device &#039;eth1&#039; link is up<br />Thu Aug 14 21:58:07 2014 daemon.notice netifd: Interface &#039;cdc&#039; has link connectivity<br />Thu Aug 14 21:58:07 2014 daemon.notice netifd: Interface &#039;cdc&#039; is setting up now<br />Thu Aug 14 21:58:07 2014 kern.info kernel: [&nbsp; 162.040000] usb 2-2: USB disconnect, device number 5<br />Thu Aug 14 21:58:07 2014 kern.info kernel: [&nbsp; 162.040000] rndis_host 2-2:1.0 eth1: unregister &#039;rndis_host&#039; usb-0000:00:03.0-2, RNDIS device<br />Thu Aug 14 21:58:07 2014 daemon.notice netifd: Network device &#039;eth1&#039; link is down<br />Thu Aug 14 21:58:07 2014 daemon.notice netifd: Interface &#039;cdc&#039; has link connectivity loss<br />Thu Aug 14 21:58:07 2014 kern.info kernel: [&nbsp; 162.390000] usb 2-2: new full-speed USB device number 6 using uhci_hcd<br />Thu Aug 14 21:58:07 2014 daemon.notice netifd: Interface &#039;cdc&#039; is now down<br />Thu Aug 14 21:58:07 2014 kern.info kernel: [&nbsp; 162.620000] cdc_ether 2-2:1.0 eth1: register &#039;cdc_ether&#039; at usb-0000:00:03.0-2, CDC Ethernet Device, 00:16:36:51:54:57<br />Thu Aug 14 21:58:07 2014 daemon.notice netifd: Interface &#039;cdc&#039; is disabled<br />Thu Aug 14 21:58:07 2014 kern.info kernel: [&nbsp; 162.650000] usb-storage 2-2:1.2: USB Mass Storage device detected<br />Thu Aug 14 21:58:07 2014 daemon.notice netifd: Interface &#039;cdc&#039; is enabled<br />Thu Aug 14 21:58:07 2014 daemon.notice netifd: Network device &#039;eth1&#039; link is up<br />Thu Aug 14 21:58:07 2014 kern.info kernel: [&nbsp; 162.660000] scsi6 : usb-storage 2-2:1.2<br />Thu Aug 14 21:58:07 2014 daemon.notice netifd: Interface &#039;cdc&#039; has link connectivity<br />Thu Aug 14 21:58:07 2014 daemon.notice netifd: Interface &#039;cdc&#039; is setting up now<br />Thu Aug 14 21:58:07 2014 daemon.notice netifd: Network device &#039;eth1&#039; link is down<br />Thu Aug 14 21:58:07 2014 daemon.notice netifd: Interface &#039;cdc&#039; has link connectivity loss<br />Thu Aug 14 21:58:08 2014 daemon.notice netifd: cdc (1614): udhcpc (v1.22.1) started<br />Thu Aug 14 21:58:08 2014 kern.notice kernel: [&nbsp; 163.730000] scsi 6:0:0:0: Direct-Access&nbsp; &nbsp; &nbsp;Virtual&nbsp; Mass-Storage&nbsp; &nbsp; &nbsp;0000 PQ: 0 ANSI: 2<br />Thu Aug 14 21:58:09 2014 kern.notice kernel: [&nbsp; 163.800000] sd 6:0:0:0: Attached scsi generic sg2 type 0<br />Thu Aug 14 21:58:09 2014 kern.notice kernel: [&nbsp; 163.850000] sd 6:0:0:0: [sdb] Attached SCSI removable disk<br />Thu Aug 14 21:58:09 2014 daemon.notice netifd: cdc (1614): Sending discover...<br />Thu Aug 14 21:58:12 2014 daemon.notice netifd: cdc (1614): Sending discover...<br />Thu Aug 14 21:58:15 2014 daemon.notice netifd: cdc (1614): Sending discover...</p><p>After that I get cdc interface, but without assigned ip address. Even if I assign ip manually (192.168.225.38 - which one assign at windows machine) 192.168.225.1 (which assigned at WEB UI of modem as address of modem) doesn&#039;t reply.</p><p>I tried to successfully unbind cdc_ether (echo -n 2-2:1.0 &gt; /sys/bus/usb/drivers/cdc_ether/unbind) :</p><p>T:&nbsp; Bus=02 Lev=01 Prnt=01 Port=01 Cnt=02 Dev#=&nbsp; 6 Spd=12&nbsp; &nbsp;MxCh= 0<br />D:&nbsp; Ver= 2.00 Cls=02(comm.) Sub=06 Prot=00 MxPS=64 #Cfgs=&nbsp; 1<br />P:&nbsp; Vendor=0408 ProdID=ea45 Rev= 0.00<br />S:&nbsp; Manufacturer=QUANTA<br />S:&nbsp; Product=Mobile Broadband<br />S:&nbsp; SerialNumber=357264046968757<br />C:* #Ifs= 3 Cfg#= 1 Atr=80 MxPwr=500mA<br />I:* If#= 0 Alt= 0 #EPs= 1 Cls=02(comm.) Sub=06 Prot=00 Driver=(none)<br />E:&nbsp; Ad=83(I) Atr=03(Int.) MxPS=&nbsp; 16 Ivl=32ms<br />I:* If#= 1 Alt= 0 #EPs= 0 Cls=0a(data ) Sub=00 Prot=00 Driver=(none)<br />I:&nbsp; If#= 1 Alt= 1 #EPs= 2 Cls=0a(data ) Sub=00 Prot=00 Driver=(none)<br />E:&nbsp; Ad=81(I) Atr=02(Bulk) MxPS=&nbsp; 64 Ivl=0ms<br />E:&nbsp; Ad=01(O) Atr=02(Bulk) MxPS=&nbsp; 64 Ivl=0ms<br />I:* If#= 2 Alt= 0 #EPs= 2 Cls=08(stor.) Sub=06 Prot=50 Driver=usb-storage<br />E:&nbsp; Ad=82(I) Atr=02(Bulk) MxPS=&nbsp; &nbsp;8 Ivl=0ms<br />E:&nbsp; Ad=02(O) Atr=02(Bulk) MxPS=&nbsp; 64 Ivl=0ms</p><p>But when I try to bind rndis_host driver ( echo -n 2-2:1.0 &gt; /sys/bus/usb/drivers/rndis_host/b<br />ind ), I get an error: write error: No such device</p><p>Help me please to solve my problem.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p243912">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">JonnyM</div>
					<div class="post-datetime">
						15 Aug 2014, 09:36					</div>
				</div>
				<div class="post-content content">
					<p>Class 02 SubClass 06 is cdc_ether and not rndis_host so don&#039;t try to force the rndis_host driver onto the dongle.<br />You&#039;ll need to have the usbnet and the cdc_ether modules loaded and this will create either a usb0 device or a ethx device in the system (depends on which kernel version you are running.)&nbsp; <br />Do an ifconfig up on the created device and then pull a dhcp address from it.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p243942">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">iAnton</div>
					<div class="post-datetime">
						15 Aug 2014, 13:45					</div>
				</div>
				<div class="post-content content">
					<p>Thank you for reply.<br />Modules are loaded and it creates eth1, but doesn&#039;t discover ip.<br />Why does it get exactly same mac address, as on windows machine where everything works fine, when register &#039;rndis_host&#039;?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p243968">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">JonnyM</div>
					<div class="post-datetime">
						15 Aug 2014, 17:57					</div>
				</div>
				<div class="post-content content">
					<p>rndis is Windows proprietary and native ethernet protocol so the windows driver is nothing more than a converter between cdc_ether and rndis, obviously you can&#039;t use that driver in linux and you don&#039;t need it since linux speaks cdc_ether directly.<br />The mac address is programmed in the dongle and will of course be the same both for windows and linux.</p><p>Have you checked with ifconfig that it reports eth1 as up?<br />If you have the dhclient utility in the build then it will both bring up the interface and pull an ip address from it,<br />otherwise it is ifconfig eth1 up and check again with ifconfig that eth1 was brought up.<br />Then dhcpc -i eth1 or udhcpc -i eth1 depending on which dhcp client you have.<br />Check again with ifconfig to see that eth1 now has an ip address.</p>											<p class="post-edited">(Last edited by <strong>JonnyM</strong> on 15 Aug 2014, 17:57)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p243971">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">iAnton</div>
					<div class="post-datetime">
						15 Aug 2014, 18:15					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>JonnyM wrote:</cite><blockquote><p>Have you checked with ifconfig that it reports eth1 as up?</p></blockquote></div><p>eth1&nbsp; &nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 00:16:36:51:54:57<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:0 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:0 (0.0 B)&nbsp; TX bytes:0 (0.0 B)<br /></p><div class="quotebox"><cite>JonnyM wrote:</cite><blockquote><p>Then dhcpc -i eth1 or udhcpc -i eth1 depending on which dhcp client you have.<br />Check again with ifconfig to see that eth1 now has an ip address.</p></blockquote></div><p>root@OpenWrt:~# udhcpc -i eth1<br />udhcpc (v1.22.1) started<br />Sending discover...<br />Sending discover...<br />Sending discover...</p><p>And it endless...</p><p>I assign ip address to this interface manually, but modem doesn&#039;t response.</p><p>May be it needs qmi or ncm drivers, but how check it?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p243979">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">JonnyM</div>
					<div class="post-datetime">
						15 Aug 2014, 19:41					</div>
				</div>
				<div class="post-content content">
					<p>It is unlikely that it should be a cdc_ncm device for many reasons, they are mostly made by Huawei and do have Huaweis own&nbsp; interface attributes (Class/SubClass/Protocol). <br />It may be a qmi_wwan device, there are a few devices in the qmi_wwan driver with the 02/06/00 interface attributes, ie devices which advertise themself as cdc_ether devices but in reality are not. They are therefore blacklisted by their usb vid:pid in the cdc_ether driver and consequently whitelisted in qmi_wwan instead.</p><p>You can test by first rmmod cdc_ether so it doesn&#039;t interfere, then:<br />insmod (modprobe) qmi_wwan<br />echo &quot;vid pid&quot; &gt;/sys/bus/usb/drivers/qmi_wwan/new_id<br />insmod (modprobe) cdc_wdm</p><p>but you will need either libqmi or its light-weight variant uqmi or qmicli in order to see if the dongle speaks qmi.</p>											<p class="post-edited">(Last edited by <strong>JonnyM</strong> on 15 Aug 2014, 19:44)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p243986">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">iAnton</div>
					<div class="post-datetime">
						15 Aug 2014, 21:07					</div>
				</div>
				<div class="post-content content">
					<p>It&#039;s like cdc_ether:<br />T:&nbsp; Bus=02 Lev=01 Prnt=01 Port=01 Cnt=02 Dev#=&nbsp; 7 Spd=480&nbsp; MxCh= 0<br />D:&nbsp; Ver= 2.00 Cls=02(comm.) Sub=06 Prot=00 MxPS=64 #Cfgs=&nbsp; 1<br />P:&nbsp; Vendor=0408 ProdID=ea45 Rev= 0.00<br />S:&nbsp; Manufacturer=QUANTA<br />S:&nbsp; Product=Mobile Broadband<br />S:&nbsp; SerialNumber=357264046968757<br />C:* #Ifs= 3 Cfg#= 1 Atr=80 MxPwr=500mA<br />I:* If#= 0 Alt= 0 #EPs= 1 Cls=02(comm.) Sub=06 Prot=00 Driver=qmi_wwan<br />E:&nbsp; Ad=82(I) Atr=03(Int.) MxPS=&nbsp; 16 Ivl=32ms<br />I:&nbsp; If#= 1 Alt= 0 #EPs= 0 Cls=0a(data ) Sub=00 Prot=00 Driver=qmi_wwan<br />I:* If#= 1 Alt= 1 #EPs= 2 Cls=0a(data ) Sub=00 Prot=00 Driver=qmi_wwan<br />E:&nbsp; Ad=81(I) Atr=02(Bulk) MxPS= 512 Ivl=0ms<br />E:&nbsp; Ad=01(O) Atr=02(Bulk) MxPS= 512 Ivl=0ms<br />I:* If#= 2 Alt= 0 #EPs= 2 Cls=08(stor.) Sub=06 Prot=50 Driver=usb-storage<br />E:&nbsp; Ad=83(I) Atr=02(Bulk) MxPS= 512 Ivl=0ms<br />E:&nbsp; Ad=02(O) Atr=02(Bulk) MxPS= 512 Ivl=125us</p><p>Log:</p><p>qmi_wwan 2-2:1.0: cdc-wdm0: USB WDM device<br />Fri Aug 15 17:38:26 2014 kern.info kernel: [&nbsp; 488.420000] qmi_wwan 2-2:1.0 wwan1: register &#039;qmi_wwan&#039; at usb-0000:00:03.2-2, WWAN/QMI device, 00:16:36:51:54:57</p><p>Ifconfig:</p><p>wwan1&nbsp; &nbsp; &nbsp;Link encap:Ethernet&nbsp; HWaddr 00:16:36:51:54:57<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: fe80::216:36ff:fe51:5457/64 Scope:Link<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:0 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:0 (0.0 B)&nbsp; TX bytes:0 (0.0 B)</p><p>But there is one more wwan interface:</p><p>wwan0&nbsp; &nbsp; &nbsp;Link encap:Ethernet&nbsp; HWaddr 58:2C:80:13:92:63<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:0 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:0 (0.0 B)&nbsp; TX bytes:0 (0.0 B)</p><p>I don&#039;t know what is it, may be from another modem Huawei E3131, which I use for internet access.</p><p>root@OpenWrt:~# udhcpc wwan1<br />udhcpc (v1.22.1) started<br />Sending discover...<br />Sending discover...<br />Sending discover...<br />^C<br />root@OpenWrt:~# udhcpc wwan0<br />udhcpc (v1.22.1) started<br />Sending discover...<br />Sending discover...<br />Sending discover...</p><p>Led of modem permanently green, it&#039;s like on windows machine before installing drivers and when it in CD mode.<br />When it connected to win machine and discovered ip address it&#039;s flashing.<br />When I insert dongle to router it&#039;s flashing 2-3 times (I guess when it register like rndis) and after light permanently.</p><p>I found scripts for ubuntu on dongle in CD-mode, but don&#039;t see something interesting:</p><p>90-local.rules<br />ACTION==&quot;add&quot;, SUBSYSTEM==&quot;usb&quot;, ENV{DEVTYPE}==&quot;usb_device&quot;, ATTRS{idVendor}==&quot;0408&quot;, ATTRS{idProduct}==&quot;ea43&quot;, RUN+=&quot;/usr/local/bin/beeline_cdrom.sh&quot;<br />ACTION==&quot;add&quot;, SUBSYSTEM==&quot;usb&quot;, ENV{DEVTYPE}==&quot;usb_device&quot;, ATTRS{idVendor}==&quot;0408&quot;, ATTRS{idProduct}==&quot;ea45&quot;, RUN+=&quot;/usr/local/bin/beeline_hostless.sh&quot;</p><br /><p>beeline_cdrom.sh<br />#!/bin/bash<br />##<br />#<br /># Support ubuntu 10.04<br /># Support firefox<br />#<br />#</p><p>DEBUG_LOG=&quot;/var/log/beeline_cdrom_debug.txt&quot;<br />LOCK_FILE=&quot;/var/log/beeline_hostless.lock&quot;</p><p>if [ -e $DEBUG_LOG ]; then<br />&nbsp; sudo rm $DEBUG_LOG<br />fi</p><p>if [ -e $LOCK_FILE ]; then<br />&nbsp; sudo rm $LOCK_FILE<br />fi</p><p>case &quot;$1&quot; in<br />&nbsp; quick)<br />&nbsp; &nbsp; sudo /usr/local/bin/beeline_cdrom_bottom.sh 1 &amp;<br />&nbsp; &nbsp; ;;<br />&nbsp; *)<br />&nbsp; &nbsp; sudo /usr/local/bin/beeline_cdrom_bottom.sh 3 &amp;<br />&nbsp; &nbsp; ;;<br />esac</p><p>#fuser -m /media/iso </p><p>#ps -aux </p><p>#fuser -m -v -k /media/iso</p><p>#sudo umount /media/iso </p><p>exit</p><br /><br /><p>beeline_cdrom_bottom.sh<br />#!/bin/bash<br />##<br />#<br /># Support ubuntu 10.04<br /># Support firefox<br />#<br />#</p><p>DEBUG_LOG=&quot;/var/log/beeline_cdrom_debug.txt&quot;</p><p>sleep $1</p><p>#detect cdrom <br />for i in $(seq 0 10)<br />do</p><p>SCSI_SERIAL=`dmesg | tail | grep -r &quot;Virtual&nbsp; CD-ROM&quot; | cut -d &quot; &quot; -f 3`<br />CDROM_NOD=`dmesg | tail | grep -r &quot;$SCSI_SERIAL Attached scsi CD-ROM&quot; | cut -d &quot; &quot; -f 7`</p><p>if [ &quot;$SCSI_SERIAL&quot; = &quot;&quot; ]; then<br />&nbsp; echo &quot;SCSI_SERIAL is empty&quot; &gt;&gt; $DEBUG_LOG<br />&nbsp; sleep 2<br />else<br />&nbsp; echo &quot;SCSI_SERIAL is not empty&quot; &gt;&gt; $DEBUG_LOG<br />&nbsp; break<br />fi</p><p>done</p><p>dmesg | tail &gt;&gt; $DEBUG_LOG<br />echo &quot;$SCSI_SERIAL&quot; &gt;&gt; $DEBUG_LOG<br />echo &quot;$CDROM_NOD&quot; &gt;&gt; $DEBUG_LOG</p><p>#waiting for /dev/sr* <br />for i in $(seq 0 10)<br />do<br />&nbsp; sleep 2</p><p>if [ -e &quot;/dev/$CDROM_NOD&quot; ] &amp;&amp; [ &quot;$CDROM_NOD&quot; != &quot;&quot; ]; then<br />&nbsp; echo &quot;/dev/$CDROM_NOD exist&quot; &gt;&gt; $DEBUG_LOG<br />&nbsp; /usr/bin/eject $CDROM_NOD 2&gt;&gt; $DEBUG_LOG<br />&nbsp; exit<br />else<br />&nbsp; echo &quot;/dev/$CDROM_NOD not exist&quot; &gt;&gt; $DEBUG_LOG<br />fi</p><p>done<br />exit</p><br /><br /><p>beeline_hostless.sh<br />#!/bin/bash<br />#<br />#Support ubuntu, fedora<br />#web browser firefox, chrome</p><p>DEBUG_LOG=&quot;/var/log/beeline_hostless_debug.txt&quot;</p><p>if [ -e $DEBUG_LOG ]; then<br />&nbsp; sudo rm $DEBUG_LOG<br />fi</p><p>sudo /usr/local/bin/beeline_hostless_bottom.sh &amp;</p><p>exit</p><br /><br /><p>beeline_hostless_bottom.sh<br />#!/bin/bash<br />#<br />#Support ubuntu, fedora<br />#web browser firefox, chrome</p><p>DEBUG_LOG=&quot;/var/log/beeline_hostless_debug.txt&quot;<br />LOCK_FILE=&quot;/var/log/beeline_hostless.lock&quot;</p><p>DISPLAY=:0.0<br />export DISPLAY </p><p>if [ -e $LOCK_FILE ]; then<br />&nbsp; echo &quot;$0 is executing, exit&quot; &gt;&gt; $DEBUG_LOG<br />&nbsp; exit<br />else <br />&nbsp; echo 1 &gt; $LOCK_FILE<br />fi</p><p>sleep 6</p><p>for i in $(seq 0 15)<br />do</p><p>ECM_NOD=`dmesg | tail | grep -r &quot;cdc_ether&quot; | cut -d &quot; &quot; -f 2`<br />ECM_IP=`/sbin/ifconfig usb0 | grep &#039;inet addr:&#039; | cut -d: -f2 | awk &#039;{ print $1}&#039;`</p><p>ECM_CLASS_C_IP=`echo $ECM_IP | cut -c1-11`<br />echo &quot;ECM_NOD = $ECM_NOD&quot; &gt;&gt; $DEBUG_LOG<br />echo &quot;ECM_IP = $ECM_IP&quot; &gt;&gt; $DEBUG_LOG<br />echo &quot;ECM_CLASS_C_IP = $ECM_CLASS_C_IP&quot; &gt;&gt; $DEBUG_LOG</p><p>if [ &quot;$ECM_IP&quot; != &quot;&quot; ]; then<br />&nbsp; echo &quot;usb0 get IP &quot; &gt;&gt; $DEBUG_LOG<br />#&nbsp; exec /usr/bin/firefox -new-window <a href="http://192.168.225.1/">http://192.168.225.1/</a> &amp;<br />&nbsp; sleep 5<br />&nbsp; exec /usr/bin/firefox -new-window <a href="http://m.home/">http://m.home/</a> &amp;<br />&nbsp; rm $LOCK_FILE<br />&nbsp; exit<br />else<br />&nbsp; echo &quot;usb0 not exist&quot; &gt;&gt; $DEBUG_LOG<br />&nbsp; sleep 2<br />fi</p><br /><p>done</p><p>&nbsp; rm $LOCK_FILE</p><p>exit</p><br /><br /><p>readme.txt<br />Support ubuntu 10.04, 10.10</p><p>I&#039;m downloading Ubuntu to test dongle with it.</p><p>And one more interesting thing - when I use usb_switchmode, dongle register as cdc_ether immediately. When I don&#039;t use usb_switchmode and use sdparm -C eject /dev/sg2, dongle register as rndis_host, unregister and then register as cdc_ether.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p243988">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">JonnyM</div>
					<div class="post-datetime">
						15 Aug 2014, 22:27					</div>
				</div>
				<div class="post-content content">
					<p>There is lots of interesting info in the shell script like:</p><p>ECM_NOD=`dmesg | tail | grep -r &quot;cdc_ether&quot; | cut -d &quot; &quot; -f 2`<br />ECM_IP=`/sbin/ifconfig usb0 | grep &#039;inet addr:&#039; | cut -d: -f2 | awk &#039;{ print $1}&#039;`</p><p>cdc_ether does not have a standard for command protocol, there is often a built-in mini-router (NATing) with a simple web server, sometimes the webserver will not display a page in a browser but can accept cmds and can give status strings back.<br />You have that here:<br />#&nbsp; exec /usr/bin/firefox -new-window <a href="http://192.168.225.1/">http://192.168.225.1/</a> &amp;</p><p>there is also a built-in dhcp server and we can see the subnet there. It is gateway and web server ip and the built in dhcp server will handle out addresses in that subnet, often starting at .100.</p><p>So I think you can forget about qmi_wwan and concentrate on cdc_ether which the dongle also announce in the interface attributes.</p><p>This is most likely a ZTE manufactured device intended to be Win8 compatible, it will get some special probing under Win8 which will make it stay in RNDIS mode. It is a requirement for Win8 approval that 3G dongles should be driverless.<br />If it doesn&#039;t get that special Win8 probing (it is still unknown what that exactly is) within a certain time then it will auto switch into cdc_ether for Win7/XP and linux.</p><p>I&#039;m interested in getting a lsusb -v -d vid:pid&nbsp; when you have it running on a linux desktop.</p>											<p class="post-edited">(Last edited by <strong>JonnyM</strong> on 15 Aug 2014, 22:29)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p244031">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">iAnton</div>
					<div class="post-datetime">
						16 Aug 2014, 14:38					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>JonnyM wrote:</cite><blockquote><p>There is lots of interesting info in the shell script like:<br />I&#039;m interested in getting a lsusb -v -d vid:pid&nbsp; when you have it running on a linux desktop.</p></blockquote></div><p>On Ubuntu 14.04 lsusb:<br />Bus 005 Device 004: ID 0408:ea43 Quanta Computer, Inc. </p><p>And devices:</p><p>T:&nbsp; Bus=05 Lev=01 Prnt=01 Port=00 Cnt=01 Dev#=&nbsp; 5 Spd=480&nbsp; MxCh= 0<br />D:&nbsp; Ver= 2.00 Cls=02(comm.) Sub=06 Prot=00 MxPS=64 #Cfgs=&nbsp; 1<br />P:&nbsp; Vendor=0408 ProdID=ea45 Rev= 0.00<br />S:&nbsp; Manufacturer=QUANTA<br />S:&nbsp; Product=Mobile Broadband<br />S:&nbsp; SerialNumber=357264046968757<br />C:* #Ifs= 3 Cfg#= 1 Atr=80 MxPwr=500mA<br />I:* If#= 0 Alt= 0 #EPs= 1 Cls=02(comm.) Sub=06 Prot=00 Driver=cdc_ether<br />E:&nbsp; Ad=82(I) Atr=03(Int.) MxPS=&nbsp; 16 Ivl=32ms<br />I:&nbsp; If#= 1 Alt= 0 #EPs= 0 Cls=0a(data ) Sub=00 Prot=00 Driver=cdc_ether<br />I:* If#= 1 Alt= 1 #EPs= 2 Cls=0a(data ) Sub=00 Prot=00 Driver=cdc_ether<br />E:&nbsp; Ad=81(I) Atr=02(Bulk) MxPS= 512 Ivl=0ms<br />E:&nbsp; Ad=01(O) Atr=02(Bulk) MxPS= 512 Ivl=0ms<br />I:* If#= 2 Alt= 0 #EPs= 2 Cls=08(stor.) Sub=06 Prot=50 Driver=usb-storage<br />E:&nbsp; Ad=83(I) Atr=02(Bulk) MxPS= 512 Ivl=0ms<br />E:&nbsp; Ad=02(O) Atr=02(Bulk) MxPS= 512 Ivl=125us</p><p>Absolutely the same situation.<br />May be something wrong with modem firmware, because somebody writes that it work fine with Oleg&#039;s firmware for wl500g, and I tried it, but there is the same result.<br />I don&#039;t understand anything more.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p244079">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">JonnyM</div>
					<div class="post-datetime">
						17 Aug 2014, 12:47					</div>
				</div>
				<div class="post-content content">
					<p>So you were not able to get an ip address from the dongle in Ubuntu? The script relies on being able to connect to the dongles web server in order to bring the mobile connection up if I read it right.<br />Be aware the script uses usb0 as kernel device which is ok for Ubuntu 10 but probably not ok for Ubutu 14.</p><p>A cat of devices is only half of the info, lsusb -v -d 0408:ea45 would&nbsp; tell a bit more.</p><p>Do check the dongles usb id immediately after plugging it in with lsusb only, it starts in rndis mode and may have a different id for a short while. Do the full lsusb command (with - v -d) on that id directly after replugging the dongle again so that you catch the interface listing for it when it still is in rndis mode.<br />Then do the lsusb -v -d 0408:ea45 when it has switched over to cdc_ether mode.</p><p>I doubt this dongle works with Oleg&#039;a firmware, there is a similar one named 1K6 (without the e), yours is quite new while the other one has been on the market for over a year.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p315024">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">amudy17</div>
					<div class="post-datetime">
						16 Mar 2016, 00:24					</div>
				</div>
				<div class="post-content content">
					<p>please new update how to connect this modem to openwrt cause i have this problem too</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>