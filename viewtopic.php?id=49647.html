<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Access file on usb key</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 12 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p228126">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Jako</div>
					<div class="post-datetime">
						21 Mar 2014, 16:29					</div>
				</div>
				<div class="post-content content">
					<p>Hi !<br />I&#039;d like to access files which are on a usb key plugged in a WR703N (with openWRT). Do I have to install a webserver like uhttpd on my usb key, and access the files with their url ? I&#039;d like to do this with their url, is it possible ?<br />Thank you in advance.</p><p>Jako</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228127">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">nozombian</div>
					<div class="post-datetime">
						21 Mar 2014, 16:51					</div>
				</div>
				<div class="post-content content">
					<p>The best option would probably be to install samba, so you could map a network drive, but samba probably won&#039;t fit to 4MB flash I think, so the easiest method will be to install ftp server and access files via ftp, which you can map as a drive in windows too. Eko wrote a nice tutorial at <a href="http://eko.one.pl/?p=openwrt-ftp">http://eko.one.pl/?p=openwrt-ftp</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228128">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Jako</div>
					<div class="post-datetime">
						21 Mar 2014, 17:02					</div>
				</div>
				<div class="post-content content">
					<p>Thank you for your reply!<br />So I should install a ftp server on my key, and then I&#039;ll access my files with something like that: <a href="ftp://192.168.1.111/usb/file.bmp">ftp://192.168.1.111/usb/file.bmp</a> ?<br />The goal of this manipulation is to access a file with an android application that I did. Now I can download and display a picture with my app, and I&#039;ll like to do the same in local wifi, without internet.<br />Thank you again</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228130">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">nozombian</div>
					<div class="post-datetime">
						21 Mar 2014, 17:13					</div>
				</div>
				<div class="post-content content">
					<p>Yes, but you will install ftp daemon on openwrt box, not on the key <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /> Installing things on usb is possible too, if you need more flash than it is in the router, but it is more complex. Ftp works fine on every OS, android, iphone, windows, whatever.</p><p>You will have to make sure your usb is mounted. If you will use the key only with openwrt, I&#039;d recommend to format the key using ext4, because it is the fastest option, but openwrt can work with ntfs-3g or fat32 too.</p>											<p class="post-edited">(Last edited by <strong>nozombian</strong> on 21 Mar 2014, 17:14)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228131">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">Jako</div>
					<div class="post-datetime">
						21 Mar 2014, 17:16					</div>
				</div>
				<div class="post-content content">
					<p>Yes I just mounted the key in vfat, because I&#039;m using windows <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /><br />But it&#039;s ok, I could do it in ext4 too. I&#039;ll try this weekend to install the vsftpd on the openwrt box, and say to it that the share files are on the usb key.<br />Thank you, I&#039;ll answer here to give news <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228163">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">lizby</div>
					<div class="post-datetime">
						22 Mar 2014, 01:02					</div>
				</div>
				<div class="post-content content">
					<p>Depending on what you want to do you can also install uhttpd, put the files in /www (or mount the usb drive to or under /www), and retrieve them on another device with, for instance, wget.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228302">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">Jako</div>
					<div class="post-datetime">
						24 Mar 2014, 10:28					</div>
				</div>
				<div class="post-content content">
					<p>Hi, I just want to share files which are on usb key via their url. I want to access them with a link, ie <a href="http://192.168.1.111/usb/file.jpg.">http://192.168.1.111/usb/file.jpg.</a><br />Thank you for your replies ! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228387">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">Jako</div>
					<div class="post-datetime">
						25 Mar 2014, 13:05					</div>
				</div>
				<div class="post-content content">
					<p>I installed uhttpd, because it&#039;s enough for what I want to do.<br />I have a file on my usb key, which I mounted with mount -t vfat /dev/sda1 /mnt/usb<br />Now I would like to access this file from an Android application, via an url : is it possible ?<br />I don&#039;t know how to configure uhttpd or how to write the url to find the file. I tried many things, like <a href="http://192.168.1.111/mnt/usb/photo.jpg">http://192.168.1.111/mnt/usb/photo.jpg</a> (192.168.1.111 being the ip adress of my router, where is uhttpd installed).<br />Any ideas ? <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228388">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">tmo26</div>
					<div class="post-datetime">
						25 Mar 2014, 13:19					</div>
				</div>
				<div class="post-content content">
					<p>uhttpd configuration: <a href="http://wiki.openwrt.org/doc/uci/uhttpd">http://wiki.openwrt.org/doc/uci/uhttpd</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228395">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">lizby</div>
					<div class="post-datetime">
						25 Mar 2014, 14:47					</div>
				</div>
				<div class="post-content content">
					<p>Or </p><p>mount -t vfat /dev/sda1 /www</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228561">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">Jako</div>
					<div class="post-datetime">
						27 Mar 2014, 12:35					</div>
				</div>
				<div class="post-content content">
					<p>So, I did these things on my WR703N :</p><p>in /etc/config/uhttpd :</p><div class="codebox"><pre><code>config uhttpd &#039;usb&#039;
        option listen_http &#039;0.0.0.0:8080&#039;
        option home &#039;/mnt/usb&#039;</code></pre></div><p>With df -h we can see my usb key is mounted on /mnt/usb :</p><div class="codebox"><pre><code>Filesystem                Size      Used Available Use% Mounted on
rootfs                    1.0M    660.0K    364.0K  64% /
/dev/root                 2.0M      2.0M         0 100% /rom
tmpfs                    14.1M     64.0K     14.0M   0% /tmp
/dev/mtdblock3            1.0M    660.0K    364.0K  64% /overlay
overlayfs:/overlay        1.0M    660.0K    364.0K  64% /
tmpfs                   512.0K         0    512.0K   0% /dev
/dev/sda1                 7.5G      4.4M      7.5G   0% /mnt/usb</code></pre></div><p>Then I want to download axone.bmp which is on the key</p><div class="codebox"><pre><code>root@OpenWrt:~# ls /mnt/usb
axone.bmp  picture</code></pre></div><p>I have an android app which perfectly works for pictures on the Internet. But here, I tried with:</p><ul><li><p><a href="http://192.168.1.111:8080/axone.bmp">http://192.168.1.111:8080/axone.bmp</a></p></li><li><p><a href="http://192.168.1.111:8080/usb/axone.bmp">http://192.168.1.111:8080/usb/axone.bmp</a></p></li><li><p><a href="http://192.168.1.111:8080/mnt/usb/axone.bmp">http://192.168.1.111:8080/mnt/usb/axone.bmp</a></p></li></ul><p>edit: precision, my router adress is 192.168.1.111 (local wifi)</p><p>and no none of them works <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>I searched on english, german, polish or russian forums to find a solution, but I don&#039;t know if my configuration works, and if the url I use is correct.<br />Thank you if you could give me some advices !<br />Jako <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>											<p class="post-edited">(Last edited by <strong>Jako</strong> on 27 Mar 2014, 12:36)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228562">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">ioceanx7</div>
					<div class="post-datetime">
						27 Mar 2014, 12:54					</div>
				</div>
				<div class="post-content content">
					<p>挺好的！</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228580">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">lizby</div>
					<div class="post-datetime">
						27 Mar 2014, 16:06					</div>
				</div>
				<div class="post-content content">
					<p>Provide:</p><p>all of &quot;/etc/config/uhttpd&quot;</p><p>ls -l /mnt/usb</p><p>ps</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228582">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">Jako</div>
					<div class="post-datetime">
						27 Mar 2014, 16:21					</div>
				</div>
				<div class="post-content content">
					<p>Hi lizby, here are the lines:</p><div class="codebox"><pre><code>root@OpenWrt:~# cat /etc/config/uhttpd

config uhttpd &#039;main&#039;
        list listen_http &#039;0.0.0.0:80&#039;
        list listen_https &#039;0.0.0.0:443&#039;
        option home &#039;/www&#039;
        option rfc1918_filter &#039;1&#039;
        option max_requests &#039;3&#039;
        option max_connections &#039;100&#039;
        option cert &#039;/etc/uhttpd.crt&#039;
        option key &#039;/etc/uhttpd.key&#039;
        option cgi_prefix &#039;/cgi-bin&#039;
        option script_timeout &#039;60&#039;
        option network_timeout &#039;30&#039;
        option http_keepalive &#039;20&#039;
        option tcp_keepalive &#039;1&#039;

config cert &#039;px5g&#039;
        option days &#039;730&#039;
        option bits &#039;1024&#039;
        option country &#039;DE&#039;
        option state &#039;Berlin&#039;
        option location &#039;Berlin&#039;
        option commonname &#039;OpenWrt&#039;

config uhttpd &#039;usb&#039;
        option listen_http &#039;0.0.0.0:8080&#039;
        option home &#039;/mnt/usb&#039;</code></pre></div><div class="codebox"><pre><code>root@OpenWrt:~# ls -l /mnt/usb
-rwxr-xr-x    1 root     root       4519930 Mar 13 17:33 axone.bmp
drwxr-xr-x    2 root     root         32768 Mar 19 02:25 picture</code></pre></div><div class="codebox"><pre><code>root@OpenWrt:~# ps
  PID USER       VSZ STAT COMMAND
    1 root      1320 S    /sbin/procd
    2 root         0 SW   [kthreadd]
    3 root         0 SW   [ksoftirqd/0]
    4 root         0 SW   [kworker/0:0]
    5 root         0 SW&lt;  [kworker/0:0H]
    6 root         0 SW   [kworker/u2:0]
    7 root         0 SW&lt;  [khelper]
    8 root         0 SW   [kworker/u2:1]
   60 root         0 SW&lt;  [writeback]
   62 root         0 SW&lt;  [bioset]
   64 root         0 SW&lt;  [kblockd]
   90 root         0 SW   [kworker/0:1]
   95 root         0 SW   [kswapd0]
  142 root         0 SW   [fsnotify_mark]
  170 root         0 SW&lt;  [ath79-spi]
  246 root         0 SW&lt;  [deferwq]
  288 root         0 SW   [kworker/0:2]
  296 root         0 SW   [khubd]
  327 root         0 SWN  [jffs2_gcd_mtd3]
  383 root         0 SW   [kworker/u2:2]
  433 root       880 S    /sbin/ubusd
  434 root       772 S    /sbin/askfirst ttyATH0 /bin/ash --login
  626 root         0 SW&lt;  [cfg80211]
  715 root      1288 S    /sbin/logd -S 16
  746 root      1468 S    /sbin/netifd
  765 root      1152 S    /usr/sbin/odhcpd
  802 root      1100 S    /usr/sbin/dropbear -F -P /var/run/dropbear.1.pid -p
  913 root      1124 S    /usr/sbin/uhttpd -f -h /www -r OpenWrt -x /cgi-bin -
  914 root      1124 S    /usr/sbin/uhttpd -f -h /mnt/usb -r OpenWrt -n 3 -p 0
  984 root      1364 S    /usr/sbin/ntpd -n -p 0.openwrt.pool.ntp.org -p 1.ope
  995 root      1576 S    /usr/sbin/hostapd -P /var/run/wifi-phy0.pid -B /var/
 1054 root         0 SW   [scsi_eh_0]
 1055 root         0 SW   [usb-storage]
 1063 root         0 SW&lt;  [kworker/0:1H]
 1077 nobody     912 S    /usr/sbin/dnsmasq -C /var/etc/dnsmasq.conf -k
 1080 root         0 SW   [kworker/u2:3]
 1094 root      1164 S    /usr/sbin/dropbear -F -P /var/run/dropbear.1.pid -p
 1095 root      1368 S    -ash
 1109 root      1360 R    ps</code></pre></div><p>Thx for your help.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228610">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">lizby</div>
					<div class="post-datetime">
						27 Mar 2014, 19:24					</div>
				</div>
				<div class="post-content content">
					<p>I have not run multiple versions of uhttpd and don&#039;t know the ins and outs of that.&nbsp; If you put your files in /www can you access them? ( wget <a href="http://192.168.1.111/axone.bmp">http://192.168.1.111/axone.bmp</a> )</p><p>If you create a new directory, &quot;/www/usb&quot; and mount the usb drive there, can you access them? ( wget <a href="http://192.168.1.111/usb/axone.bmp">http://192.168.1.111/usb/axone.bmp</a> )</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228613">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">Jako</div>
					<div class="post-datetime">
						27 Mar 2014, 19:34					</div>
				</div>
				<div class="post-content content">
					<p>Hey lizby, I tested your solutions :</p><p>/www<br /></p><div class="codebox"><pre><code>root@OpenWrt:/# mount -t vfat /dev/sda1 /www
root@OpenWrt:/# cd /www
root@OpenWrt:/www# ls
axone.bmp  picture    www
root@OpenWrt:/www# wget http://192.168.1.111/axone.bmp
Connecting to 192.168.1.111 (192.168.1.111:80)
wget: too many redirections</code></pre></div><p>/www/usb<br /></p><div class="codebox"><pre><code>root@OpenWrt:/# mkdir /www/usb
root@OpenWrt:/# mount -t vfat /dev/sda1 /www/usb
root@OpenWrt:/# df
Filesystem           1K-blocks      Used Available Use% Mounted on
rootfs                    1024       660       364  64% /
/dev/root                 2048      2048         0 100% /rom
tmpfs                    14444        64     14380   0% /tmp
/dev/mtdblock3            1024       660       364  64% /overlay
overlayfs:/overlay        1024       660       364  64% /
tmpfs                      512         0       512   0% /dev
/dev/sda1              7862336     13376   7848960   0% /www/usb
root@OpenWrt:/# wget http://192.168.1.111/usb/axone.bmp
Connecting to 192.168.1.111 (192.168.1.111:80)
wget: too many redirections</code></pre></div><p>Is there something I am doing wrong ? <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>btw thank you very much for your help <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228628">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">lizby</div>
					<div class="post-datetime">
						27 Mar 2014, 23:05					</div>
				</div>
				<div class="post-content content">
					<p>&quot;Too many redirections&quot; is not an error message which I have encountered before.&nbsp; In searching, I found this: &quot;In http matters, this often happens if you have some misconfiguration that causes the machine to redirect to itself in an infinite loop&quot;.</p><p>I don&#039;t know that this would be the cause of this error, but I was suggesting that you do the &quot;wget&quot; from another device, for instance, from the command line on a Windows PC or a Linux box.</p><p>Post your /etc/config/network file.</p><p>What is the ip of your router?&nbsp; Of your Windows or Linux or Mac PC?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228663">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">Jako</div>
					<div class="post-datetime">
						28 Mar 2014, 10:25					</div>
				</div>
				<div class="post-content content">
					<div class="codebox"><pre><code>root@OpenWrt:~# cat /etc/config/network

config interface &#039;loopback&#039;
        option ifname &#039;lo&#039;
        option proto &#039;static&#039;
        option ipaddr &#039;127.0.0.1&#039;
        option netmask &#039;255.0.0.0&#039;

config globals &#039;globals&#039;
        option ula_prefix &#039;fd73:f79e:0565::/48&#039;

config interface &#039;lan&#039;
        option ifname &#039;eth0&#039;
        option type &#039;bridge&#039;
        option proto &#039;static&#039;
        option ipaddr &#039;192.168.1.111&#039;
        option netmask &#039;255.255.255.0&#039;
        option dns &#039;8.8.8.8&#039;
        option gateway &#039;192.168.1.254&#039;
        option ip6assign &#039;60&#039;</code></pre></div><p>My ip router is 192.168.1.111 and for my pc it&#039;s 192.168.1.221 in local.</p><p>edit:<br />I tried to add rules in /etc/config/firewall, e.g. to redirect all http traffic to the router, but I have the same error &quot;wget : too many redirections&quot;. And when I type the url of the file in my browser, I have and error too : ERR_TOO_MANY_REDIRECTS<br />I don&#039;t know if all my configuration (uhttpd, firewall...) is wrong or if I don&#039;t understand how to access the file on the key via url.<br />Thx for taking time to help me.</p>											<p class="post-edited">(Last edited by <strong>Jako</strong> on 28 Mar 2014, 12:38)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228972">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">Jako</div>
					<div class="post-datetime">
						1 Apr 2014, 17:41					</div>
				</div>
				<div class="post-content content">
					<p>Should I install Lua ? Or mini-httpd maybe (explanations here : <a href="http://www.corroy.org/blog/index.php/2013/02/08/269-retour-d-experience-sur-le-routeur-tp-link-wr703n)">http://www.corroy.org/blog/index.php/20 … nk-wr703n)</a> ? Or should I use a ftp-server instead ?<br />I tested all I can, and I can&#039;t access my files...</p>											<p class="post-edited">(Last edited by <strong>Jako</strong> on 1 Apr 2014, 18:10)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228985">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">tmo26</div>
					<div class="post-datetime">
						1 Apr 2014, 20:03					</div>
				</div>
				<div class="post-content content">
					<p>Why is gateway 192.168.1.254?<br />Shouldn&#039;t gateway be 192.168.1.111?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228986">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">Jako</div>
					<div class="post-datetime">
						1 Apr 2014, 20:28					</div>
				</div>
				<div class="post-content content">
					<p>Hmm it is the ip of my router, to access internet and download packages. I don&#039;t know if I have to change it.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228990">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">tmo26</div>
					<div class="post-datetime">
						1 Apr 2014, 22:10					</div>
				</div>
				<div class="post-content content">
					<p>Sorry, you&#039;re right, I misread your posting...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p228992">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">tmo26</div>
					<div class="post-datetime">
						1 Apr 2014, 22:45					</div>
				</div>
				<div class="post-content content">
					<p>After reading the whole thread again, I get the impression, that the firewall is involved.</p><p>Post your /etc/config/firewall</p><p>By the way: &quot;Have you tried switching it off and on again?&quot; ?-)<br />Have you restarted uhttpd in the meantime? or rebooted or powercycled the 192.168.1.111?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p229026">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">Jako</div>
					<div class="post-datetime">
						2 Apr 2014, 10:15					</div>
				</div>
				<div class="post-content content">
					<p>Hi tmo, yes I tried to restart the firewall or uhttpd many times after my changes. It didn&#039;t change anything.<br />Here is my /etc/config/firewall. I just added the last rule, to try to accept the traffic for the 8080 port.<br />Thanks for your help <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><div class="codebox"><pre><code>root@OpenWrt:~# cat /etc/config/firewall

config defaults
        option syn_flood &#039;1&#039;
        option input &#039;ACCEPT&#039;
        option output &#039;ACCEPT&#039;
        option forward &#039;REJECT&#039;

config zone
        option name &#039;lan&#039;
        list network &#039;lan&#039;
        option input &#039;ACCEPT&#039;
        option output &#039;ACCEPT&#039;
        option forward &#039;ACCEPT&#039;

config zone
        option name &#039;wan&#039;
        list network &#039;wan&#039;
        list network &#039;wan6&#039;
        option input &#039;REJECT&#039;
        option output &#039;ACCEPT&#039;
        option forward &#039;REJECT&#039;
        option masq &#039;1&#039;
        option mtu_fix &#039;1&#039;

config forwarding
        option src &#039;lan&#039;
        option dest &#039;wan&#039;

config rule
        option name &#039;Allow-DHCP-Renew&#039;
        option src &#039;wan&#039;
        option proto &#039;udp&#039;
        option dest_port &#039;68&#039;
        option target &#039;ACCEPT&#039;
        option family &#039;ipv4&#039;

config rule
        option name &#039;Allow-Ping&#039;
        option src &#039;wan&#039;
        option proto &#039;icmp&#039;
        option icmp_type &#039;echo-request&#039;
        option family &#039;ipv4&#039;
        option target &#039;ACCEPT&#039;

config rule
        option name &#039;Allow-DHCPv6&#039;
        option src &#039;wan&#039;
        option proto &#039;udp&#039;
        option src_ip &#039;fe80::/10&#039;
        option src_port &#039;547&#039;
        option dest_ip &#039;fe80::/10&#039;
        option dest_port &#039;546&#039;
        option family &#039;ipv6&#039;
        option target &#039;ACCEPT&#039;

config rule
        option name &#039;Allow-ICMPv6-Input&#039;
        option src &#039;wan&#039;
        option proto &#039;icmp&#039;
        list icmp_type &#039;echo-request&#039;
        list icmp_type &#039;echo-reply&#039;
        list icmp_type &#039;destination-unreachable&#039;
        list icmp_type &#039;packet-too-big&#039;
        list icmp_type &#039;time-exceeded&#039;
        list icmp_type &#039;bad-header&#039;
        list icmp_type &#039;unknown-header-type&#039;
        list icmp_type &#039;router-solicitation&#039;
        list icmp_type &#039;neighbour-solicitation&#039;
        list icmp_type &#039;router-advertisement&#039;
        list icmp_type &#039;neighbour-advertisement&#039;
        option limit &#039;1000/sec&#039;
        option family &#039;ipv6&#039;
        option target &#039;ACCEPT&#039;

config rule
        option name &#039;Allow-ICMPv6-Forward&#039;
        option src &#039;wan&#039;
        option dest &#039;*&#039;
        option proto &#039;icmp&#039;
        list icmp_type &#039;echo-request&#039;
        list icmp_type &#039;echo-reply&#039;
        list icmp_type &#039;destination-unreachable&#039;
        list icmp_type &#039;packet-too-big&#039;
        list icmp_type &#039;time-exceeded&#039;
        list icmp_type &#039;bad-header&#039;
        list icmp_type &#039;unknown-header-type&#039;
        option limit &#039;1000/sec&#039;
        option family &#039;ipv6&#039;
        option target &#039;ACCEPT&#039;

config include
        option path &#039;/etc/firewall.user&#039;

config rule
        option name &#039;usb&#039;
        option proto &#039;tcp&#039;
        option dest_port &#039;8080&#039;
        option src &#039;wan&#039;
        option target &#039;ACCEPT&#039;</code></pre></div><p>edit : Should it works just with uhttpd ? I didn&#039;t install Luci or Lua or things like that, I thought uhttpd could work separately.<br />Maybe my document root is wrong too ?<br />I&#039;ll try differents things this afternoon, like mini-httpd or vsftpd; These are different ways to access the file on the key.</p>											<p class="post-edited">(Last edited by <strong>Jako</strong> on 2 Apr 2014, 13:02)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p229106">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">Jako</div>
					<div class="post-datetime">
						3 Apr 2014, 11:38					</div>
				</div>
				<div class="post-content content">
					<p>Ok, so I decided to change the webserver, and tried mini_http. Now I can access my key from my computer ! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> My android app however doesn&#039;t seem to work with the local url (<a href="http://192.168.1.111/">http://192.168.1.111/</a>), although it worked with internet urls. But that&#039;s maybe a coding problem, the server problem access is solved !</p><p>For those interested, here is the link which helped me (french: <a href="http://www.corroy.org/blog/index.php/2013/02/08/269-retour-d-experience-sur-le-routeur-tp-link-wr703n)">http://www.corroy.org/blog/index.php/20 … nk-wr703n)</a><br />and the interesting part :</p><div class="codebox"><pre><code>Serveur HTTP : 

Installation : 
opkg update
opkg install mini-httpd

Modification du fichier de configuration pour utiliser la clé usb comme répertoire par défaut du serveur : 
Fichier : /etc/mini_httpd.conf
cgipat=cgi-bin/**|**.sh
dir=/usbdrive
nochroot
pidfile=/var/run/mini_httpd.pid
user=root
port=80

Lancement du serveur : 
/etc/init.d/mini_httpd enable
/etc/init.d/mini_httpd start</code></pre></div>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>