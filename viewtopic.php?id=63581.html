<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Can I clone a router by copying /overlay?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 28 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p316101">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Narrowband</div>
					<div class="post-datetime">
						22 Mar 2016, 14:36					</div>
				</div>
				<div class="post-content content">
					<p>Is it possible to clone a router to identical hardware by doing some kind of combination of &quot;tar&quot; and &quot;ssh&quot;&nbsp; on /overlay?</p><p>I&#039;m not afraid to work out the command - but I do not know how to <em>test</em> the router after the transfer.&nbsp; I do not know how tinkering directly with /overlay might affect some other part of the router.</p><p>I note that /overlay contains symbolic links, and I think that scp&nbsp; does not preserve links.&nbsp; I think that tar can be used to preserve the links.&nbsp; OpenWrt Chaos Control supports both tar and ssh.</p><p>I understand that there might be some cleanup required, for MAC addresses and hostnames and such - but can I use this method to do the brunt of the installation and configuration?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p316141">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">bolvan</div>
					<div class="post-datetime">
						22 Mar 2016, 18:37					</div>
				</div>
				<div class="post-content content">
					<p>If they were flashed with identical kernel+rootfs (say, image) then YES</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p316153">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">oneru</div>
					<div class="post-datetime">
						22 Mar 2016, 19:20					</div>
				</div>
				<div class="post-content content">
					<p>Depending on what all has been done to the device, just copying /etc/config might be sufficient.&nbsp; This is similar to what Luci does when you make a backup of settings.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p316156">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						22 Mar 2016, 19:33					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>oneru wrote:</cite><blockquote><p>Depending on what all has been done to the device, just copying /etc/config might be sufficient.&nbsp; This is similar to what Luci does when you make a backup of settings.</p></blockquote></div><p>Not quite. Depending on the installed packages, Luci backup (and sysupgrade) saves also other files (the files declared to be config files) from /etc and other places. The exact file list is showed in in Luci / System / Backup &amp; Flash / Configuration / Open list</p><p>But the installed binary packages are not included in that list, so other directories are needed, too, for a full clone of the router.</p><p>Personally I build the firmware with all the packages included and only backup a few files from /etc /etc/config and /etc/dropbear:<br /></p><div class="codebox"><pre><code>/etc/config/network /etc/config/wireless /etc/config/firewall /etc/config/dhcp /etc/config/sqm /etc/config/luci_statistics /etc/config/bcp38 /etc/vsftpd.conf /etc/aiccu.conf /etc/dropbear/authorized_keys /etc/config/vsftpd*</code></pre></div>											<p class="post-edited">(Last edited by <strong>hnyman</strong> on 22 Mar 2016, 19:34)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p316159">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">Narrowband</div>
					<div class="post-datetime">
						22 Mar 2016, 19:43					</div>
				</div>
				<div class="post-content content">
					<p>Thank you all for these ideas.</p><p>Is it silly for me to ask how to test the clone in some way other than &quot;Drop it in and boot it and see if it works?&quot;</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>