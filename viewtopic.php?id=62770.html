<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Failure to connect to upstream WiFi router</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 14 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p311588">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">d_ozenne</div>
					<div class="post-datetime">
						16 Feb 2016, 00:32					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m building a home automation device based around an Oolite board running OpenWRT. For the most part it is working great. I have connected it to several WiFi networks. But for some reason it will not connect to one particular network, and I can&#039;t figure out what makes this one different.</p><p>The upstream router is a TP-Link Archer C9 AC1900, with PSK2 security. My phone, my laptop, and other devices have no problem connecting to this network</p><p>I have several of these Oolite boards and they all behave the exact same way. To eliminate any possibility of my software or hardware being the problem, I tried it with an Oolite dev board running vanilla OpenWRT (latest 15.05) + LuCI. I use LuCI to scan for networks, find the target network, enter the passphrase, and Save/Apply.</p><p>This is typical of the console output when it is trying to connect:</p><p>[&nbsp; 350.280000] eth0: link down<br />[&nbsp; 350.280000] br-lan: port 1(eth0) entered disabled state<br />[&nbsp; 351.780000] eth0: link up (1000Mbps/Full duplex)<br />[&nbsp; 351.780000] br-lan: port 1(eth0) entered forwarding state<br />[&nbsp; 351.780000] br-lan: port 1(eth0) entered forwarding state<br />[&nbsp; 351.960000] IPv6: ADDRCONF(NETDEV_UP): wlan0: link is not ready<br />[&nbsp; 353.780000] br-lan: port 1(eth0) entered forwarding state<br />[&nbsp; 355.140000] wlan0: authenticate with 60:e3:27:ad:73:51<br />[&nbsp; 355.150000] wlan0: direct probe to 60:e3:27:ad:73:51 (try 1/3)<br />[&nbsp; 355.370000] wlan0: direct probe to 60:e3:27:ad:73:51 (try 2/3)<br />[&nbsp; 355.580000] wlan0: direct probe to 60:e3:27:ad:73:51 (try 3/3)<br />[&nbsp; 355.790000] wlan0: authentication with 60:e3:27:ad:73:51 timed out<br />[&nbsp; 356.580000] wlan0: authenticate with 60:e3:27:ad:73:51<br />[&nbsp; 356.590000] wlan0: send auth to 60:e3:27:ad:73:51 (try 1/3)<br />[&nbsp; 356.650000] wlan0: send auth to 60:e3:27:ad:73:51 (try 2/3)<br />[&nbsp; 356.740000] wlan0: send auth to 60:e3:27:ad:73:51 (try 3/3)<br />[&nbsp; 356.790000] wlan0: authentication with 60:e3:27:ad:73:51 timed out<br />[&nbsp; 361.350000] wlan0: authenticate with 60:e3:27:ad:73:51<br />[&nbsp; 361.360000] wlan0: send auth to 60:e3:27:ad:73:51 (try 1/3)<br />[&nbsp; 361.430000] wlan0: send auth to 60:e3:27:ad:73:51 (try 2/3)<br />[&nbsp; 361.520000] wlan0: send auth to 60:e3:27:ad:73:51 (try 3/3)<br />[&nbsp; 361.580000] wlan0: authentication with 60:e3:27:ad:73:51 timed out<br />[&nbsp; 363.280000] wlan0: authenticate with 60:e3:27:ad:73:51<br />[&nbsp; 363.290000] wlan0: direct probe to 60:e3:27:ad:73:51 (try 1/3)<br />[&nbsp; 363.510000] wlan0: direct probe to 60:e3:27:ad:73:51 (try 2/3)<br />[&nbsp; 363.720000] wlan0: direct probe to 60:e3:27:ad:73:51 (try 3/3)<br />[&nbsp; 363.930000] wlan0: authentication with 60:e3:27:ad:73:51 timed out<br />[&nbsp; 373.620000] wlan0: authenticate with 60:e3:27:ad:73:51<br />[&nbsp; 373.660000] wlan0: send auth to 60:e3:27:ad:73:51 (try 1/3)<br />[&nbsp; 373.730000] wlan0: send auth to 60:e3:27:ad:73:51 (try 2/3)<br />[&nbsp; 373.830000] wlan0: send auth to 60:e3:27:ad:73:51 (try 3/3)<br />[&nbsp; 373.930000] wlan0: authentication with 60:e3:27:ad:73:51 timed out<br />[&nbsp; 395.990000] wlan0: authenticate with 60:e3:27:ad:73:51<br />[&nbsp; 396.000000] wlan0: send auth to 60:e3:27:ad:73:51 (try 1/3)<br />[&nbsp; 396.010000] wlan0: authenticated<br />[&nbsp; 396.020000] wlan0: associate with 60:e3:27:ad:73:51 (try 1/3)<br />[&nbsp; 396.150000] wlan0: associate with 60:e3:27:ad:73:51 (try 2/3)<br />[&nbsp; 396.230000] wlan0: associate with 60:e3:27:ad:73:51 (try 3/3)<br />[&nbsp; 396.320000] wlan0: association with 60:e3:27:ad:73:51 timed out</p><p>At other times it seems to authenticate more reliably, but still never associates:</p><p>[&nbsp; 642.420000] wlan0: send auth to 60:e3:27:ad:73:51 (try 1/3)<br />[&nbsp; 642.430000] wlan0: authenticated<br />[&nbsp; 642.450000] wlan0: associate with 60:e3:27:ad:73:51 (try 1/3)<br />[&nbsp; 642.580000] wlan0: associate with 60:e3:27:ad:73:51 (try 2/3)<br />[&nbsp; 642.670000] wlan0: associate with 60:e3:27:ad:73:51 (try 3/3)<br />[&nbsp; 642.750000] wlan0: association with 60:e3:27:ad:73:51 timed out<br />[&nbsp; 643.540000] wlan0: authenticate with 60:e3:27:ad:73:51<br />[&nbsp; 643.550000] wlan0: send auth to 60:e3:27:ad:73:51 (try 1/3)<br />[&nbsp; 643.560000] wlan0: authenticated<br />[&nbsp; 643.570000] wlan0: associate with 60:e3:27:ad:73:51 (try 1/3)<br />[&nbsp; 643.740000] wlan0: associate with 60:e3:27:ad:73:51 (try 2/3)<br />[&nbsp; 643.830000] wlan0: associate with 60:e3:27:ad:73:51 (try 3/3)<br />[&nbsp; 643.890000] wlan0: association with 60:e3:27:ad:73:51 timed out<br />[&nbsp; 645.090000] wlan0: authenticate with 60:e3:27:ad:73:51<br />[&nbsp; 645.100000] wlan0: send auth to 60:e3:27:ad:73:51 (try 1/3)<br />[&nbsp; 645.110000] wlan0: authenticated<br />[&nbsp; 645.120000] wlan0: associate with 60:e3:27:ad:73:51 (try 1/3)<br />[&nbsp; 645.250000] wlan0: associate with 60:e3:27:ad:73:51 (try 2/3)<br />[&nbsp; 645.330000] wlan0: associate with 60:e3:27:ad:73:51 (try 3/3)<br />[&nbsp; 645.420000] wlan0: association with 60:e3:27:ad:73:51 timed out<br />[&nbsp; 647.120000] wlan0: authenticate with 60:e3:27:ad:73:51<br />[&nbsp; 647.130000] wlan0: send auth to 60:e3:27:ad:73:51 (try 1/3)<br />[&nbsp; 647.140000] wlan0: authenticated<br />[&nbsp; 647.150000] wlan0: associate with 60:e3:27:ad:73:51 (try 1/3)<br />[&nbsp; 647.300000] wlan0: associate with 60:e3:27:ad:73:51 (try 2/3)<br />[&nbsp; 647.410000] wlan0: associate with 60:e3:27:ad:73:51 (try 3/3)<br />[&nbsp; 647.510000] wlan0: association with 60:e3:27:ad:73:51 timed out</p><p>Obviously that&#039;s not much to go on. So what I&#039;m really wondering is how to get more information about what might be happening here.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p311605">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">d_ozenne</div>
					<div class="post-datetime">
						16 Feb 2016, 02:33					</div>
				</div>
				<div class="post-content content">
					<p>Poking around, I think what I should do is turn on the debug/verbose logging for the wpa_supplicant. My build is using wpad-mini. I updated my build config to have CONFIG_WPA_MSG_MIN_PRIORITY=0.</p><p>I can see the wpa_supplicant running:</p><p> 4862 root&nbsp; &nbsp; &nbsp; 1688 S&nbsp; &nbsp; /usr/sbin/wpa_supplicant -B -P /var/run/wpa_supplicant-wlan0.pid -D nl80211 -i wlan0 -c /var/run/wpa_supplicant-wlan0.conf -C /var/run/wpa_supplicant</p><p>It stops and starts if I do &quot;wifi down &amp;&amp; wifi&quot;. But what exactly starts it, and how can I change that command line to include the -dd option?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p311863">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Max Hopper</div>
					<div class="post-datetime">
						17 Feb 2016, 19:54					</div>
				</div>
				<div class="post-content content">
					<div class="codebox"><pre><code>find / -name wifi</code></pre></div>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>