<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> TLS error on Openvpn</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 28 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p340027">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">zhica</div>
					<div class="post-datetime">
						3 Oct 2016, 06:45					</div>
				</div>
				<div class="post-content content">
					<p>Hey, I followed the /howto/openvpn-streamlined-server-setup to setup a vpn server on CC</p><p>I have been playing around with different configs trying to get this to work for 6 hours and I keep getting the same error over and over again. Something is wrong with my TLS settings, config or certs. Can anyone help me figure this out?</p><p>TLS_ERROR: BIO read tls_read_plaintext error: error:1408A0C1:lib(20):func(138):reason(193)</p><br /><p>full log</p><div class="codebox"><pre><code>on Oct  3 11:18:36 2016 us=967983 OpenVPN 2.3.6 mips-openwrt-linux-gnu [SSL (OpenSSL)] [LZO] [EPOLL] [MH] [IPv6] built on Jan 31 2016
Mon Oct  3 11:18:36 2016 us=968220 library versions: OpenSSL 1.0.2g  1 Mar 2016, LZO 2.08
Mon Oct  3 11:18:39 2016 us=896370 Diffie-Hellman initialized with 2048 bit key
Mon Oct  3 11:18:40 2016 us=391592 TLS-Auth MTU parms [ L:24086 D:138 EF:38 EB:0 ET:0 EL:0 ]
Mon Oct  3 11:18:40 2016 us=391843 Socket Buffers: R=[163840-&gt;327680] S=[163840-&gt;327680]
Mon Oct  3 11:18:40 2016 us=401364 TUN/TAP device tun0 opened
Mon Oct  3 11:18:40 2016 us=401574 TUN/TAP TX queue length set to 100
Mon Oct  3 11:18:40 2016 us=401703 do_ifconfig, tt-&gt;ipv6=0, tt-&gt;did_ifconfig_ipv6_setup=0
Mon Oct  3 11:18:40 2016 us=401973 /sbin/ifconfig tun0 10.1.1.1 netmask 255.255.255.0 mtu 24000 broadcast 10.1.1.255
Mon Oct  3 11:18:40 2016 us=415310 Data Channel MTU parms [ L:24086 D:24086 EF:86 EB:135 ET:0 EL:0 AF:3/1 ]
Mon Oct  3 11:18:40 2016 us=416132 GID set to nogroup
Mon Oct  3 11:18:40 2016 us=416294 UID set to nobody
Mon Oct  3 11:18:40 2016 us=416409 UDPv4 link local (bound): [undef]
Mon Oct  3 11:18:40 2016 us=416510 UDPv4 link remote: [undef]
Mon Oct  3 11:18:40 2016 us=416617 MULTI: multi_init called, r=256 v=256
Mon Oct  3 11:18:40 2016 us=416890 IFCONFIG POOL: base=10.1.1.2 size=252, ipv6=0
Mon Oct  3 11:18:40 2016 us=417864 Initialization Sequence Completed
Mon Oct  3 11:41:25 2016 us=181570 MULTI: multi_create_instance called
Mon Oct  3 11:41:25 2016 us=182015 192.168.1.10:34122 Re-using SSL/TLS context
Mon Oct  3 11:41:25 2016 us=182209 192.168.1.10:34122 LZO compression initialized
Mon Oct  3 11:41:25 2016 us=185648 192.168.1.10:34122 Control Channel MTU parms [ L:24086 D:138 EF:38 EB:0 ET:0 EL:0 ]
Mon Oct  3 11:41:25 2016 us=185859 192.168.1.10:34122 Data Channel MTU parms [ L:24086 D:24086 EF:86 EB:135 ET:0 EL:0 AF:3/1 ]
Mon Oct  3 11:41:25 2016 us=186131 192.168.1.10:34122 UDPv4 READ [14] from [AF_INET]192.168.1.10:34122: P_CONTROL_HARD_RESET_CLIENT_V2 kid=0 [ ] pid=0 DATA len=0
Mon Oct  3 11:41:25 2016 us=186319 192.168.1.10:34122 TLS: Initial packet from [AF_INET]192.168.1.10:34122, sid=2e02edf1 cb76eaef
Mon Oct  3 11:41:25 2016 us=186566 192.168.1.10:34122 UDPv4 WRITE [26] to [AF_INET]192.168.1.10:34122: P_CONTROL_HARD_RESET_SERVER_V2 kid=0 [ 0 ] pid=0 DATA len=0
Mon Oct  3 11:41:25 2016 us=187752 192.168.1.10:34122 UDPv4 READ [22] from [AF_INET]192.168.1.10:34122: P_ACK_V1 kid=0 [ 0 ]
Mon Oct  3 11:41:25 2016 us=188183 192.168.1.10:34122 UDPv4 READ [275] from [AF_INET]192.168.1.10:34122: P_CONTROL_V1 kid=0 [ ] pid=1 DATA len=261
Mon Oct  3 11:41:25 2016 us=188929 192.168.1.10:34122 TLS_ERROR: BIO read tls_read_plaintext error: error:1408A0C1:lib(20):func(138):reason(193)
Mon Oct  3 11:41:25 2016 us=189100 192.168.1.10:34122 TLS Error: TLS object -&gt; incoming plaintext read error
Mon Oct  3 11:41:25 2016 us=189194 192.168.1.10:34122 TLS Error: TLS handshake failed
Mon Oct  3 11:41:25 2016 us=190773 192.168.1.10:34122 SIGUSR1[soft,tls-error] received, client-instance restarting</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p340048">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">bolvan</div>
					<div class="post-datetime">
						3 Oct 2016, 15:08					</div>
				</div>
				<div class="post-content content">
					<p>What works for me :</p><div class="codebox"><pre><code>option comp_lzo &#039;no&#039;
option cipher &#039;AES-128-CBC&#039;
option tls_cipher &#039;AES128+EECDH:AES128+EDH&#039;</code></pre></div><p>openvpn 2.3.10<br />openssl 1.0.2h</p><p>Certificate use RSA2048+sha256</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p340115">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">zhica</div>
					<div class="post-datetime">
						4 Oct 2016, 05:31					</div>
				</div>
				<div class="post-content content">
					<p>Thanks Bolvan,</p><p>1. I have changed the ciphers to 128 and I am now getting HMAC to work but it just seems to drop the connection immediately. </p><p>2. I have disabled lzo compression numerous times and confirmed via luci, but everytime I check the logs, I see lzo compression started. What is that about? </p><div class="codebox"><pre><code>Tue Oct  4 10:26:13 2016 us=55907 OpenVPN 2.3.6 mips-openwrt-linux-gnu [SSL (OpenSSL)] [LZO] [EPOLL] [MH] [IPv6] built on Jan 31 2016
Tue Oct  4 10:26:13 2016 us=56139 library versions: OpenSSL 1.0.2g  1 Mar 2016, LZO 2.08
Tue Oct  4 10:26:13 2016 us=234357 Diffie-Hellman initialized with 2048 bit key
Tue Oct  4 10:26:13 2016 us=728413 No valid translation found for TLS cipher &#039;AES128+EECDH&#039;
Tue Oct  4 10:26:13 2016 us=728660 No valid translation found for TLS cipher &#039;AES128+EDH&#039;
Tue Oct  4 10:26:13 2016 us=770461 Control Channel Authentication: using &#039;/etc/openvpn/keys/ta.key&#039; as a OpenVPN static key file
Tue Oct  4 10:26:13 2016 us=770696 Outgoing Control Channel Authentication: Using 256 bit message hash &#039;SHA256&#039; for HMAC authentication
Tue Oct  4 10:26:13 2016 us=770836 Incoming Control Channel Authentication: Using 256 bit message hash &#039;SHA256&#039; for HMAC authentication
Tue Oct  4 10:26:13 2016 us=771001 TLS-Auth MTU parms [ L:24072 D:180 EF:80 EB:0 ET:0 EL:0 ]
Tue Oct  4 10:26:13 2016 us=771185 Socket Buffers: R=[87380-&gt;327680] S=[16384-&gt;327680]
Tue Oct  4 10:26:13 2016 us=781002 TUN/TAP device tun0 opened
Tue Oct  4 10:26:13 2016 us=781208 TUN/TAP TX queue length set to 100
Tue Oct  4 10:26:13 2016 us=781336 do_ifconfig, tt-&gt;ipv6=0, tt-&gt;did_ifconfig_ipv6_setup=0
Tue Oct  4 10:26:13 2016 us=781604 /sbin/ifconfig tun0 10.1.1.1 netmask 255.255.255.0 mtu 24000 broadcast 10.1.1.255
Tue Oct  4 10:26:13 2016 us=794921 Data Channel MTU parms [ L:24072 D:24072 EF:72 EB:135 ET:0 EL:0 AF:3/1 ]
Tue Oct  4 10:26:13 2016 us=795681 GID set to nogroup
Tue Oct  4 10:26:13 2016 us=795841 UID set to nobody
Tue Oct  4 10:26:13 2016 us=796204 Listening for incoming TCP connection on [undef]
Tue Oct  4 10:26:13 2016 us=796405 TCPv4_SERVER link local (bound): [undef]
Tue Oct  4 10:26:13 2016 us=796523 TCPv4_SERVER link remote: [undef]
Tue Oct  4 10:26:13 2016 us=796631 MULTI: multi_init called, r=256 v=256
Tue Oct  4 10:26:13 2016 us=796895 IFCONFIG POOL: base=10.1.1.2 size=252, ipv6=0
Tue Oct  4 10:26:13 2016 us=797186 MULTI: TCP INIT maxclients=1024 maxevents=1028
Tue Oct  4 10:26:13 2016 us=798129 Initialization Sequence Completed
Tue Oct  4 10:26:45 2016 us=293670 MULTI: multi_create_instance called
Tue Oct  4 10:26:45 2016 us=294137 Re-using SSL/TLS context
Tue Oct  4 10:26:45 2016 us=294332 LZO compression initialized
Tue Oct  4 10:26:45 2016 us=297628 Control Channel MTU parms [ L:24072 D:180 EF:80 EB:0 ET:0 EL:0 ]
Tue Oct  4 10:26:45 2016 us=298599 Data Channel MTU parms [ L:24072 D:24072 EF:72 EB:135 ET:0 EL:0 AF:3/1 ]
Tue Oct  4 10:26:45 2016 us=299092 TCP connection established with [AF_INET]192.168.1.10:50072
Tue Oct  4 10:26:45 2016 us=299247 TCPv4_SERVER link local: [undef]
Tue Oct  4 10:26:45 2016 us=299365 TCPv4_SERVER link remote: [AF_INET]192.168.1.10:50072
Tue Oct  4 10:26:46 2016 us=294556 192.168.1.10:50072 TCPv4_SERVER READ [54] from [AF_INET]192.168.1.10:50072: P_CONTROL_HARD_RESET_CLIENT_V2 kid=0 pid=[ #1 ] [ ] pid=0 DATA len=0
Tue Oct  4 10:26:46 2016 us=294860 192.168.1.10:50072 TLS: Initial packet from [AF_INET]192.168.1.10:50072, sid=4f661cd3 49083426
Tue Oct  4 10:26:46 2016 us=295231 192.168.1.10:50072 TCPv4_SERVER WRITE [66] to [AF_INET]192.168.1.10:50072: P_CONTROL_HARD_RESET_SERVER_V2 kid=0 pid=[ #1 ] [ 0 ] pid=0 DATA len=0
Tue Oct  4 10:26:46 2016 us=296149 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #2 ] [ 0 ]
Tue Oct  4 10:26:46 2016 us=330466 192.168.1.10:50072 TCPv4_SERVER READ [315] from [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #3 ] [ ] pid=1 DATA len=261
Tue Oct  4 10:26:46 2016 us=928876 192.168.1.10:50072 TCPv4_SERVER WRITE [166] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #2 ] [ 1 ] pid=1 DATA len=100
Tue Oct  4 10:26:46 2016 us=929506 192.168.1.10:50072 TCPv4_SERVER WRITE [154] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #3 ] [ ] pid=2 DATA len=100
Tue Oct  4 10:26:46 2016 us=930622 192.168.1.10:50072 TCPv4_SERVER WRITE [154] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #4 ] [ ] pid=3 DATA len=100
Tue Oct  4 10:26:46 2016 us=931415 192.168.1.10:50072 TCPv4_SERVER WRITE [154] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #5 ] [ ] pid=4 DATA len=100
Tue Oct  4 10:26:46 2016 us=931984 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #4 ] [ 1 ]
Tue Oct  4 10:26:46 2016 us=932615 192.168.1.10:50072 TCPv4_SERVER WRITE [154] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #6 ] [ ] pid=5 DATA len=100
Tue Oct  4 10:26:46 2016 us=933122 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #5 ] [ 2 ]
Tue Oct  4 10:26:46 2016 us=933755 192.168.1.10:50072 TCPv4_SERVER WRITE [154] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #7 ] [ ] pid=6 DATA len=100
Tue Oct  4 10:26:46 2016 us=934270 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #6 ] [ 3 ]
Tue Oct  4 10:26:46 2016 us=934907 192.168.1.10:50072 TCPv4_SERVER WRITE [154] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #8 ] [ ] pid=7 DATA len=100
Tue Oct  4 10:26:46 2016 us=935468 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #7 ] [ 4 ]
Tue Oct  4 10:26:46 2016 us=936106 192.168.1.10:50072 TCPv4_SERVER WRITE [154] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #9 ] [ ] pid=8 DATA len=100
Tue Oct  4 10:26:46 2016 us=936617 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #8 ] [ 5 ]
Tue Oct  4 10:26:46 2016 us=937285 192.168.1.10:50072 TCPv4_SERVER WRITE [154] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #10 ] [ ] pid=9 DATA len=100
Tue Oct  4 10:26:46 2016 us=937803 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #9 ] [ 6 ]
Tue Oct  4 10:26:46 2016 us=938434 192.168.1.10:50072 TCPv4_SERVER WRITE [154] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #11 ] [ ] pid=10 DATA len=100
Tue Oct  4 10:26:46 2016 us=938994 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #10 ] [ 7 ]
Tue Oct  4 10:26:46 2016 us=939633 192.168.1.10:50072 TCPv4_SERVER WRITE [154] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #12 ] [ ] pid=11 DATA len=100
Tue Oct  4 10:26:46 2016 us=940207 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #11 ] [ 8 ]
Tue Oct  4 10:26:46 2016 us=940850 192.168.1.10:50072 TCPv4_SERVER WRITE [154] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #13 ] [ ] pid=12 DATA len=100
Tue Oct  4 10:26:46 2016 us=941361 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #12 ] [ 9 ]
Tue Oct  4 10:26:46 2016 us=941994 192.168.1.10:50072 TCPv4_SERVER WRITE [154] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #14 ] [ ] pid=13 DATA len=100
Tue Oct  4 10:26:46 2016 us=942555 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #13 ] [ 10 ]
Tue Oct  4 10:26:46 2016 us=943250 192.168.1.10:50072 TCPv4_SERVER WRITE [154] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #15 ] [ ] pid=14 DATA len=100
Tue Oct  4 10:26:46 2016 us=944067 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #14 ] [ 11 ]
Tue Oct  4 10:26:46 2016 us=944558 192.168.1.10:50072 TCPv4_SERVER WRITE [154] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #16 ] [ ] pid=15 DATA len=100
Tue Oct  4 10:26:46 2016 us=945064 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #15 ] [ 12 ]
Tue Oct  4 10:26:46 2016 us=945695 192.168.1.10:50072 TCPv4_SERVER WRITE [154] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #17 ] [ ] pid=16 DATA len=100
Tue Oct  4 10:26:46 2016 us=946251 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #16 ] [ 13 ]
Tue Oct  4 10:26:46 2016 us=946880 192.168.1.10:50072 TCPv4_SERVER WRITE [154] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #18 ] [ ] pid=17 DATA len=100
Tue Oct  4 10:26:46 2016 us=947423 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #17 ] [ 14 ]
Tue Oct  4 10:26:46 2016 us=948066 192.168.1.10:50072 TCPv4_SERVER WRITE [154] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #19 ] [ ] pid=18 DATA len=100
Tue Oct  4 10:26:46 2016 us=948583 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #18 ] [ 15 ]
Tue Oct  4 10:26:46 2016 us=949211 192.168.1.10:50072 TCPv4_SERVER WRITE [154] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #20 ] [ ] pid=19 DATA len=100
Tue Oct  4 10:26:46 2016 us=949871 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #19 ] [ 16 ]
Tue Oct  4 10:26:46 2016 us=950550 192.168.1.10:50072 TCPv4_SERVER WRITE [154] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #21 ] [ ] pid=20 DATA len=100
Tue Oct  4 10:26:46 2016 us=951066 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #20 ] [ 17 ]
Tue Oct  4 10:26:46 2016 us=951695 192.168.1.10:50072 TCPv4_SERVER WRITE [154] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #22 ] [ ] pid=21 DATA len=100
Tue Oct  4 10:26:46 2016 us=952216 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #21 ] [ 18 ]
Tue Oct  4 10:26:46 2016 us=952847 192.168.1.10:50072 TCPv4_SERVER WRITE [154] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #23 ] [ ] pid=22 DATA len=100
Tue Oct  4 10:26:46 2016 us=953405 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #22 ] [ 19 ]
Tue Oct  4 10:26:46 2016 us=954033 192.168.1.10:50072 TCPv4_SERVER WRITE [154] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #24 ] [ ] pid=23 DATA len=100
Tue Oct  4 10:26:46 2016 us=954553 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #23 ] [ 20 ]
Tue Oct  4 10:26:46 2016 us=955184 192.168.1.10:50072 TCPv4_SERVER WRITE [154] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #25 ] [ ] pid=24 DATA len=100
Tue Oct  4 10:26:46 2016 us=955727 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #24 ] [ 21 ]
Tue Oct  4 10:26:46 2016 us=956365 192.168.1.10:50072 TCPv4_SERVER WRITE [154] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #26 ] [ ] pid=25 DATA len=100
Tue Oct  4 10:26:46 2016 us=956928 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #25 ] [ 22 ]
Tue Oct  4 10:26:46 2016 us=957561 192.168.1.10:50072 TCPv4_SERVER WRITE [154] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #27 ] [ ] pid=26 DATA len=100
Tue Oct  4 10:26:46 2016 us=958074 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #26 ] [ 23 ]
Tue Oct  4 10:26:46 2016 us=958701 192.168.1.10:50072 TCPv4_SERVER WRITE [154] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #28 ] [ ] pid=27 DATA len=100
Tue Oct  4 10:26:46 2016 us=959223 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #27 ] [ 24 ]
Tue Oct  4 10:26:46 2016 us=959724 192.168.1.10:50072 TCPv4_SERVER WRITE [154] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #29 ] [ ] pid=28 DATA len=100
Tue Oct  4 10:26:46 2016 us=960140 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #28 ] [ 25 ]
Tue Oct  4 10:26:46 2016 us=961020 192.168.1.10:50072 TCPv4_SERVER WRITE [154] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #30 ] [ ] pid=29 DATA len=100
Tue Oct  4 10:26:46 2016 us=961539 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #29 ] [ 26 ]
Tue Oct  4 10:26:46 2016 us=962168 192.168.1.10:50072 TCPv4_SERVER WRITE [154] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #31 ] [ ] pid=30 DATA len=100
Tue Oct  4 10:26:46 2016 us=962750 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #30 ] [ 27 ]
Tue Oct  4 10:26:46 2016 us=963440 192.168.1.10:50072 TCPv4_SERVER WRITE [154] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #32 ] [ ] pid=31 DATA len=100
Tue Oct  4 10:26:46 2016 us=963942 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #31 ] [ 28 ]
Tue Oct  4 10:26:46 2016 us=964572 192.168.1.10:50072 TCPv4_SERVER WRITE [154] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #33 ] [ ] pid=32 DATA len=100
Tue Oct  4 10:26:46 2016 us=965085 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #32 ] [ 29 ]
Tue Oct  4 10:26:46 2016 us=965705 192.168.1.10:50072 TCPv4_SERVER WRITE [154] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #34 ] [ ] pid=33 DATA len=100
Tue Oct  4 10:26:46 2016 us=966255 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #33 ] [ 30 ]
Tue Oct  4 10:26:46 2016 us=966881 192.168.1.10:50072 TCPv4_SERVER WRITE [154] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #35 ] [ ] pid=34 DATA len=100
Tue Oct  4 10:26:46 2016 us=967396 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #34 ] [ 31 ]
Tue Oct  4 10:26:46 2016 us=968024 192.168.1.10:50072 TCPv4_SERVER WRITE [154] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #36 ] [ ] pid=35 DATA len=100
Tue Oct  4 10:26:46 2016 us=968573 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #35 ] [ 32 ]
Tue Oct  4 10:26:46 2016 us=969181 192.168.1.10:50072 TCPv4_SERVER WRITE [154] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #37 ] [ ] pid=36 DATA len=100
Tue Oct  4 10:26:46 2016 us=969828 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #36 ] [ 33 ]
Tue Oct  4 10:26:46 2016 us=970464 192.168.1.10:50072 TCPv4_SERVER WRITE [107] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #38 ] [ ] pid=37 DATA len=53
Tue Oct  4 10:26:46 2016 us=970972 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #37 ] [ 34 ]
Tue Oct  4 10:26:46 2016 us=971354 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #38 ] [ 35 ]
Tue Oct  4 10:26:46 2016 us=971751 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #39 ] [ 36 ]
Tue Oct  4 10:26:46 2016 us=982589 192.168.1.10:50072 TCPv4_SERVER READ [1156] from [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #40 ] [ 37 ] pid=2 DATA len=1090
Tue Oct  4 10:26:46 2016 us=983341 192.168.1.10:50072 TCPv4_SERVER WRITE [62] to [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #39 ] [ 2 ]
Tue Oct  4 10:26:46 2016 us=983872 192.168.1.10:50072 TCPv4_SERVER READ [1144] from [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #41 ] [ ] pid=3 DATA len=1090
Tue Oct  4 10:26:46 2016 us=984415 192.168.1.10:50072 TCPv4_SERVER WRITE [62] to [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #40 ] [ 3 ]
Tue Oct  4 10:26:46 2016 us=984827 192.168.1.10:50072 TCPv4_SERVER READ [1053] from [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #42 ] [ ] pid=4 DATA len=999
Tue Oct  4 10:26:46 2016 us=990003 192.168.1.10:50072 VERIFY OK: depth=1, C=HK, ST=HK, L=Kn, O=Classic-Side, OU=ICAZH, CN=ch, name=Zhu, emailAddress=b@b.com
Tue Oct  4 10:26:46 2016 us=995373 192.168.1.10:50072 Validating certificate key usage
Tue Oct  4 10:26:46 2016 us=995542 192.168.1.10:50072 ++ Certificate has key usage  0080, expects 0080
Tue Oct  4 10:26:46 2016 us=995637 192.168.1.10:50072 VERIFY KU OK
Tue Oct  4 10:26:46 2016 us=995757 192.168.1.10:50072 Validating certificate extended key usage
Tue Oct  4 10:26:46 2016 us=995876 192.168.1.10:50072 ++ Certificate has EKU (str) TLS Web Client Authentication, expects TLS Web Client Authentication
Tue Oct  4 10:26:46 2016 us=996008 192.168.1.10:50072 VERIFY EKU OK
Tue Oct  4 10:26:46 2016 us=996111 192.168.1.10:50072 VERIFY OK: depth=0, C=HK, ST=HK, L=Kn, O=Classic-Side, OU=ICAZH, CN=ch, name=Zhu, emailAddress=b@b.com
Tue Oct  4 10:26:47 2016 us=449121 192.168.1.10:50072 TCPv4_SERVER WRITE [125] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #41 ] [ 4 ] pid=38 DATA len=59
Tue Oct  4 10:26:47 2016 us=450310 192.168.1.10:50072 TCPv4_SERVER READ [444] from [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #43 ] [ 38 ] pid=5 DATA len=378
Tue Oct  4 10:26:47 2016 us=451936 192.168.1.10:50072 Data Channel Encrypt: Cipher &#039;AES-128-CBC&#039; initialized with 128 bit key
Tue Oct  4 10:26:47 2016 us=452134 192.168.1.10:50072 Data Channel Encrypt: Using 256 bit message hash &#039;SHA256&#039; for HMAC authentication
Tue Oct  4 10:26:47 2016 us=452260 192.168.1.10:50072 Data Channel Decrypt: Cipher &#039;AES-128-CBC&#039; initialized with 128 bit key
Tue Oct  4 10:26:47 2016 us=452393 192.168.1.10:50072 Data Channel Decrypt: Using 256 bit message hash &#039;SHA256&#039; for HMAC authentication
Tue Oct  4 10:26:47 2016 us=452855 192.168.1.10:50072 TCPv4_SERVER WRITE [166] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #42 ] [ 5 ] pid=39 DATA len=100
Tue Oct  4 10:26:47 2016 us=453387 192.168.1.10:50072 TCPv4_SERVER WRITE [108] to [AF_INET]192.168.1.10:50072: P_CONTROL_V1 kid=0 pid=[ #43 ] [ ] pid=40 DATA len=54
Tue Oct  4 10:26:47 2016 us=454022 192.168.1.10:50072 TCPv4_SERVER READ [62] from [AF_INET]192.168.1.10:50072: P_ACK_V1 kid=0 pid=[ #44 ] [ 39 ]
Tue Oct  4 10:26:47 2016 us=455007 192.168.1.10:50072 Connection reset, restarting [0]
Tue Oct  4 10:26:47 2016 us=455183 192.168.1.10:50072 SIGUSR1[soft,connection-reset] received, client-instance restarting
Tue Oct  4 10:26:47 2016 us=456355 TCP/UDP: Closing socket</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p340138">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">bolvan</div>
					<div class="post-datetime">
						4 Oct 2016, 11:38					</div>
				</div>
				<div class="post-content content">
					<p>looks like other end resets the connection. have logs from the other side ?</p><p>Here is my successful log :<br /></p><div class="codebox"><pre><code>Data Channel Encrypt: Cipher &#039;AES-128-CBC&#039; initialized with 128 bit key
Data Channel Encrypt: Using 160 bit message hash &#039;SHA1&#039; for HMAC authentication
Data Channel Decrypt: Cipher &#039;AES-128-CBC&#039; initialized with 128 bit key
Data Channel Decrypt: Using 160 bit message hash &#039;SHA1&#039; for HMAC authentication
Control Channel: TLSv1.2, cipher TLSv1/SSLv3 DHE-RSA-AES128-GCM-SHA256, 2048 bit RSA</code></pre></div><p>Your log stops after &quot;Data channel decrypt&quot;. After that should be some info about TLS, at that point client drops the connection, so I suppose something is wrong with TLS. May be client does not trust server cert or cannot support server&#039;s ciphers.</p>											<p class="post-edited">(Last edited by <strong>bolvan</strong> on 4 Oct 2016, 12:03)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>