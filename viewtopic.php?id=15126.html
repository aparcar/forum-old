<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Intel IXDPG425 Reference Board and NPE firmware</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 11 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p66123">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">antonello</div>
					<div class="post-datetime">
						1 Apr 2008, 14:50					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m OpenWRT newbie and trying to run<br />OpenWrt on Intel IXDGP425 reference board.</p><p>I made following steps:<br /><em><br />&nbsp; download kamikake 7.09<br />&nbsp; make menuconfig<br /></em><br />I select &quot;Intel XScale IXP4xx [2.6]&quot; as Target System, save and quit<br /><em><br />&nbsp; make<br /></em></p><p>After successfully compilation, I copied openwrt-ixp4xx-2.6-squashfs.img&nbsp; <br />and openwrt-ixp4xx-2.6-zImage to /tftpboot directory</p><p>In redboot version 2.04 console:<br /><em><br />&nbsp; fis init<br />&nbsp; load -r -v -b %{FREEMEMLO} openwrt-ixp4xx-2.6-zImage<br />&nbsp; fis create kernel<br />&nbsp; load -r -v -b %{FREEMEMLO} openwrt-ixp4xx-2.6-squashfs.img<br />&nbsp; fis create rootfs<br /></em></p><p>This is the output of console:<br /></p><div class="codebox"><pre><code>RedBoot&gt; fis load kernel
RedBoot&gt; exec
Using base address 0x00026c00 and length 0x000e8da0
Uncompressing Linux................................................................ done, booting the kernel.
Linux version 2.6.21.6 (antonello@AntoPC001) (gcc version 4.1.2) #1 Tue Apr 1 13:01:23 CEST 2008
CPU: XScale-IXP42x Family [690541c1] revision 1 (ARMv5TE), cr=000039ff
Machine: Intel IXDPG425
Memory policy: ECC disabled, Data cache writeback
CPU0: D VIVT undefined 5 cache
CPU0: I cache: 32768 bytes, associativity 32, 32 byte lines, 32 sets
CPU0: D cache: 32768 bytes, associativity 32, 32 byte lines, 32 sets
Built 1 zonelists.  Total pages: 8128
Kernel command line: root=/dev/mtdblock2 rootfstype=squashfs,jffs2 noinitrd console=ttyS0,115200 init=/etc/preinit
PID hash table entries: 128 (order: 7, 512 bytes)
Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
Memory: 32MB = 32MB total
Memory: 30424KB available (1800K code, 149K data, 72K init)
Mount-cache hash table entries: 512
CPU: Testing write buffer coherency: ok
NET: Registered protocol family 16
IXP4xx: Using 16MiB expansion bus window size
PCI: IXP4xx is host
PCI: IXP4xx Using direct access for memory space
PCI: bus0: Fast back to back transfers disabled
dmabounce: registered device 0000:00:0e.0 on pci bus
dmabounce: registered device 0000:00:0e.1 on pci bus
dmabounce: registered device 0000:00:0e.2 on pci bus
NET: Registered protocol family 2
Time: OSTS clocksource has been installed.
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 1024 (order: 1, 8192 bytes)
TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
TCP: Hash tables configured (established 1024 bind 1024)
TCP reno registered
NetWinder Floating Point Emulator V0.97 (double precision)
squashfs: version 3.0 (2006/03/15) Phillip Lougher
Registering mini_fo version $Id$
JFFS2 version 2.2. (NAND) (C) 2001-2006 Red Hat, Inc.
io scheduler noop registered
io scheduler deadline registered (default)
IXP4xx Watchdog Timer: heartbeat 60 sec
Serial: 8250/16550 driver $Revision: 1.90 $ 2 ports, IRQ sharing disabled
serial8250.0: ttyS0 at MMIO 0xc8000000 (irq = 15) is a XScale
IXP4XX Q Manager 0.2.1 initialized.
IXP4XX NPE driver Version 0.3.0 initialized
ixp4xx_crypto 0.0.1 registered successfully
IXP4XX-Flash.0: Found 1 x16 devices at 0x0 in 16-bit bank
 Intel/Sharp Extended Query Table at 0x0031
Using buffer write method
cfi_cmdset_0001: Erase suspend on write enabled
Searching for RedBoot partition table in IXP4XX-Flash.0 at offset 0xfe0000
6 RedBoot partitions found on MTD device IXP4XX-Flash.0
Creating 6 MTD partitions on &quot;IXP4XX-Flash.0&quot;:
0x00000000-0x00080000 : &quot;RedBoot&quot;
0x00080000-0x00180000 : &quot;kernel&quot;
0x00180000-0x002a0000 : &quot;rootfs&quot;
0x00280000-0x002a0000 : &quot;rootfs_data&quot;
0x002a0000-0x00fe0000 : &quot;unallocated&quot;
0x00fe0000-0x00fff000 : &quot;FIS directory&quot;
0x00fff000-0x01000000 : &quot;RedBoot config&quot;
i2c /dev entries driver
nf_conntrack version 0.5.0 (256 buckets, 2048 max)
ip_tables: (C) 2000-2006 Netfilter Core Team
TCP westwood registered
NET: Registered protocol family 1
NET: Registered protocol family 17
802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;
All bugs added by David S. Miller &lt;davem@redhat.com&gt;
XScale DSP coprocessor detected.
drivers/rtc/hctosys.c: unable to open rtc device (rtc0)
VFS: Mounted root (squashfs filesystem) readonly.
Freeing init memory: 72K
Warning: unable to open an initial console.
- preinit -
jffs2 not ready yet; using ramdisk
mini_fo: using base directory: /
mini_fo: using storage directory: /tmp/root
- init -
init started:  BusyBox v1.4.2 (2008-04-01 12:49:43 CEST) multi-call binary

Please press Enter to activate this console. PPP generic driver version 2.4.2
wlan: 0.8.4.2 (svn r2568)
ath_hal: module license &#039;Proprietary&#039; taints kernel.
ath_hal: 0.9.30.13 (AR5210, AR5211, AR5212, AR5416, RF5111, RF5112, RF2413, RF5413, RF2133, REGOPS_FUNC)
ath_rate_minstrel: Minstrel automatic rate control algorithm 1.2 (svn r2568)
ath_rate_minstrel: look around rate set to 10%
ath_rate_minstrel: EWMA rolloff level set to 75%
ath_rate_minstrel: max segment size in the mrr set to 6000 us
wlan: mac acl policy registered
ath_pci: 0.9.4.5 (svn r2568)
jffs2: Too few erase blocks (1)



BusyBox v1.4.2 (2008-04-01 12:49:43 CEST) Built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 KAMIKAZE (7.09) -----------------------------------
  * 10 oz Vodka       Shake well with ice and strain
  * 10 oz Triple sec  mixture into 10 shot glasses.
  * 10 oz lime juice  Salute!
 ---------------------------------------------------
root@OpenWrt:/#</code></pre></div><p>The problem is that the ethernet interfaces not woks.<br />In the console massage I can&#039;t see any message like:<br /><span style="color: red"><strong>&quot;npe: seraching for firmware&quot;</strong></span></p><p>Any suggestion?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p66127">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Kaloz</div>
					<div class="post-datetime">
						1 Apr 2008, 15:07					</div>
				</div>
				<div class="post-content content">
					<p>Use svn trunk <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p66133">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">antonello</div>
					<div class="post-datetime">
						1 Apr 2008, 17:02					</div>
				</div>
				<div class="post-content content">
					<p>I tried with trunk without success:<br /><em>&nbsp; svn co <a href="https://svn.openwrt.org/openwrt/trunk/">https://svn.openwrt.org/openwrt/trunk/</a> </em><br />To enable IXDPG425 platform support:<br /><em><br />cd build_dir/linux-ixp4xx_generic/linux-2.6.24.2/<br />make ARCH=arm<br /></em><br />added support for IXDPG425, quit and save<br /><em><br />cd -<br />make<br /></em></p><p>If I well understand, the NPE firmware image is stored in mtd partition.<br />Is correct? If yes how can I check it ?</p><p>The console output:<br /></p><div class="codebox"><pre><code>Trying NPE-B...success. Using NPE-B with PHY 5.
Ethernet eth0: MAC address 00:03:47:df:32:a8
IP: 192.168.1.89/255.255.255.0, Gateway: 192.168.1.1
Default server: 192.168.1.36

RedBoot(tm) bootstrap and debug environment [ROM]
Red Hat certified release, version 2.04 - built 15:36:33, Mar 21 2007

Platform: Intel IXDPG425 Network Gateway Reference (IXP42X 533MHz) BE
Copyright (C) 2000, 2001, 2002, 2003, 2004, 2007 Free Software Foundation, Inc.

RAM: 0x00000000-0x02000000, [0x00026910-0x01fc1000] available
FLASH: 0x50000000 - 0x51000000, 128 blocks of 0x00020000 bytes each.
== Executing boot script in 2.000 seconds - enter ^C to abort
RedBoot&gt; fis load kernel
RedBoot&gt; exec
Using base address 0x00026c00 and length 0x000f1c28
Uncompressing Linux.................................................................... done, booting the kernel.
Linux version 2.6.24.2 (antonello@AntoPC001) (gcc version 4.1.2) #2 Tue Apr 1 15:01:07 CEST 2008
CPU: XScale-IXP42x Family [690541c1] revision 1 (ARMv5TE), cr=000039ff
Machine: Intel IXDPG425
Memory policy: ECC disabled, Data cache writeback
CPU0: D VIVT undefined 5 cache
CPU0: I cache: 32768 bytes, associativity 32, 32 byte lines, 32 sets
CPU0: D cache: 32768 bytes, associativity 32, 32 byte lines, 32 sets
Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 8128
Kernel command line: root=/dev/mtdblock2 rootfstype=squashfs,jffs2 noinitrd console=ttyS0,115200 init=/etc/preinit
PID hash table entries: 128 (order: 7, 512 bytes)
Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
Memory: 32MB = 32MB total
Memory: 30320KB available (1844K code, 180K data, 96K init)
Mount-cache hash table entries: 512
CPU: Testing write buffer coherency: ok
net_namespace: 64 bytes
NET: Registered protocol family 16
IXP4xx: Using 16MiB expansion bus window size
PCI: IXP4xx is host
PCI: IXP4xx Using direct access for memory space
PCI: bus0: Fast back to back transfers disabled
dmabounce: registered device 0000:00:0e.0 on pci bus
dmabounce: registered device 0000:00:0e.1 on pci bus
dmabounce: registered device 0000:00:0e.2 on pci bus
NET: Registered protocol family 2
Time: OSTS clocksource has been installed.
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 1024 (order: 1, 8192 bytes)
TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
TCP: Hash tables configured (established 1024 bind 1024)
TCP reno registered
IXP4xx Queue Manager initialized.
squashfs: version 3.0 (2006/03/15) Phillip Lougher
Registering mini_fo version $Id$
JFFS2 version 2.2. (NAND) (SUMMARY)  Â© 2001-2006 Red Hat, Inc.
io scheduler noop registered
io scheduler deadline registered (default)
Serial: 8250/16550 driver $Revision: 1.90 $ 2 ports, IRQ sharing disabled
serial8250.0: ttyS0 at MMIO 0xc8000000 (irq = 15) is a XScale
console [ttyS0] enabled
IXP4XX-Flash.0: Found 1 x16 devices at 0x0 in 16-bit bank
 Intel/Sharp Extended Query Table at 0x0031
Using buffer write method
cfi_cmdset_0001: Erase suspend on write enabled
Searching for RedBoot partition table in IXP4XX-Flash.0 at offset 0xfe0000
5 RedBoot partitions found on MTD device IXP4XX-Flash.0
Creating 5 MTD partitions on &quot;IXP4XX-Flash.0&quot;:
0x00000000-0x00080000 : &quot;RedBoot&quot;
0x00080000-0x00180000 : &quot;kernel&quot;
0x00180000-0x002a0000 : &quot;rootfs&quot;
mtd: partition &quot;rootfs&quot; set to be root filesystem
mtd: partition &quot;rootfs_data&quot; created automatically, ofs=280000, len=20000 
0x00280000-0x002a0000 : &quot;rootfs_data&quot;
0x00fe0000-0x00fff000 : &quot;FIS directory&quot;
0x00fff000-0x01000000 : &quot;RedBoot config&quot;
i2c /dev entries driver
i2c-gpio: probe failed: -19
IXP4xx Watchdog Timer: heartbeat 60 sec
nf_conntrack version 0.5.0 (1024 buckets, 4096 max)
ip_tables: (C) 2000-2006 Netfilter Core Team
TCP westwood registered
NET: Registered protocol family 1
NET: Registered protocol family 17
Bridge firewalling registered
802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;
All bugs added by David S. Miller &lt;davem@redhat.com&gt;
XScale DSP coprocessor detected.
drivers/rtc/hctosys.c: unable to open rtc device (rtc0)
VFS: Mounted root (squashfs filesystem) readonly.
Freeing init memory: 96K
Please be patient, while OpenWrt loads ...
- preinit -
jffs2 not ready yet; using ramdisk
mini_fo: using base directory: /
mini_fo: using storage directory: /tmp/root
- init -

Please press Enter to activate this console. PPP generic driver version 2.4.2
wlan: trunk
ath_hal: module license &#039;Proprietary&#039; taints kernel.
ath_hal: 0.9.30.13 (AR5210, AR5211, AR5212, AR5416, RF5111, RF5112, RF2413, RF5413, RF2133, REGOPS_FUNC)
ath_rate_minstrel: Minstrel automatic rate control algorithm 1.2 (trunk)
ath_rate_minstrel: look around rate set to 10%
ath_rate_minstrel: EWMA rolloff level set to 75%
ath_rate_minstrel: max segment size in the mrr set to 6000 us
wlan: mac acl policy registered
ath_pci: trunk
jffs2: Too few erase blocks (1)



BusyBox v1.8.2 (2008-04-01 14:44:47 CEST) built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 KAMIKAZE (bleeding edge, r10696) -------------------
  * 10 oz Vodka       Shake well with ice and strain
  * 10 oz Triple sec  mixture into 10 shot glasses.
  * 10 oz lime juice  Salute!
 ---------------------------------------------------
root@OpenWrt:/# ls /lib/firmware
NPE-B  NPE-C
root@OpenWrt:/# cat /proc/mtd 
dev:    size   erasesize  name
mtd0: 00080000 00020000 &quot;RedBoot&quot;
mtd1: 00100000 00020000 &quot;kernel&quot;
mtd2: 00120000 00020000 &quot;rootfs&quot;
mtd3: 00020000 00020000 &quot;rootfs_data&quot;
mtd4: 0001f000 00020000 &quot;FIS directory&quot;
mtd5: 00001000 00020000 &quot;RedBoot config&quot;
root@OpenWrt:/# ifconfig eth0
ifconfig: eth0: error fetching interface information: Device not found
root@OpenWrt:/# ifconfig eth1
ifconfig: eth1: error fetching interface information: Device not found
root@OpenWrt:/#</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p66137">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Kaloz</div>
					<div class="post-datetime">
						1 Apr 2008, 18:16					</div>
				</div>
				<div class="post-content content">
					<p>Not anymore with trunk. But you seem to lack some platform info.. Can you paste here a factory dmesg?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p66138">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">antonello</div>
					<div class="post-datetime">
						1 Apr 2008, 18:25					</div>
				</div>
				<div class="post-content content">
					<p>I also enabled all DEBUG defines in:<br />&nbsp; build_dir/linux-ixp4xx_generic/linux-2.6.24.2/arch/arm/mach-ixp4xx/ixp4xx_npe.c<br />&nbsp; build_dir/linux-ixp4xx_generic/linux-2.6.24.2/arch/arm/mach-ixp4xx/ixp4xx_qmgr.c<br />&nbsp; build_dir/linux-ixp4xx_generic/linux-2.6.24.2/drivers/net/arm/ixp4xx_eth.c</p><div class="codebox"><pre><code>root@OpenWrt:/# uname -a
Linux OpenWrt 2.6.24.2 #3 Tue Apr 1 16:56:53 CEST 2008 armv5teb unknown
root@OpenWrt:/# 
root@OpenWrt:/# dmesg 
Linux version 2.6.24.2 (antonello@AntoPC001) (gcc version 4.1.2) #3 Tue Apr 1 16:56:53 CEST 2008
CPU: XScale-IXP42x Family [690541c1] revision 1 (ARMv5TE), cr=000039ff
Machine: Intel IXDPG425
Memory policy: ECC disabled, Data cache writeback
On node 0 totalpages: 8192
  DMA zone: 64 pages used for memmap
  DMA zone: 0 pages reserved
  DMA zone: 8128 pages, LIFO batch:0
  Normal zone: 0 pages used for memmap
  Movable zone: 0 pages used for memmap
CPU0: D VIVT undefined 5 cache
CPU0: I cache: 32768 bytes, associativity 32, 32 byte lines, 32 sets
CPU0: D cache: 32768 bytes, associativity 32, 32 byte lines, 32 sets
Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 8128
Kernel command line: root=/dev/mtdblock2 rootfstype=squashfs,jffs2 noinitrd console=ttyS0,115200 init=/etc/preinit
PID hash table entries: 128 (order: 7, 512 bytes)
Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
Memory: 32MB = 32MB total
Memory: 30312KB available (1852K code, 180K data, 96K init)
Calibrating delay loop... 532.48 BogoMIPS (lpj=2662400)
Mount-cache hash table entries: 512
CPU: Testing write buffer coherency: ok
net_namespace: 64 bytes
NET: Registered protocol family 16
IXP4xx: Using 16MiB expansion bus window size
PCI: IXP4xx is host
PCI: IXP4xx Using direct access for memory space
PCI: bus0: Fast back to back transfers disabled
dmabounce: registered device 0000:00:0e.0 on pci bus
dmabounce: registered device 0000:00:0e.1 on pci bus
dmabounce: registered device 0000:00:0e.2 on pci bus
NET: Registered protocol family 2
Time: OSTS clocksource has been installed.
Switched to high resolution mode on CPU 0
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 1024 (order: 1, 8192 bytes)
TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
TCP: Hash tables configured (established 1024 bind 1024)
TCP reno registered
IXP4xx Queue Manager initialized.
squashfs: version 3.0 (2006/03/15) Phillip Lougher
Registering mini_fo version $Id$
JFFS2 version 2.2. (NAND) (SUMMARY)  Â© 2001-2006 Red Hat, Inc.
io scheduler noop registered
io scheduler deadline registered (default)
Serial: 8250/16550 driver $Revision: 1.90 $ 2 ports, IRQ sharing disabled
serial8250.0: ttyS0 at MMIO 0xc8000000 (irq = 15) is a XScale
console [ttyS0] enabled
IXP4XX-Flash.0: Found 1 x16 devices at 0x0 in 16-bit bank
 Intel/Sharp Extended Query Table at 0x0031
Using buffer write method
cfi_cmdset_0001: Erase suspend on write enabled
erase region 0: offset=0x0,size=0x20000,blocks=128
Searching for RedBoot partition table in IXP4XX-Flash.0 at offset 0xfe0000
5 RedBoot partitions found on MTD device IXP4XX-Flash.0
Creating 5 MTD partitions on &quot;IXP4XX-Flash.0&quot;:
0x00000000-0x00080000 : &quot;RedBoot&quot;
0x00080000-0x00180000 : &quot;kernel&quot;
0x00180000-0x002a0000 : &quot;rootfs&quot;
mtd: partition &quot;rootfs&quot; set to be root filesystem
mtd: partition &quot;rootfs_data&quot; created automatically, ofs=280000, len=20000 
0x00280000-0x002a0000 : &quot;rootfs_data&quot;
0x00fe0000-0x00fff000 : &quot;FIS directory&quot;
0x00fff000-0x01000000 : &quot;RedBoot config&quot;
i2c /dev entries driver
i2c-gpio: probe failed: -19
IXP4xx Watchdog Timer: heartbeat 60 sec
nf_conntrack version 0.5.0 (1024 buckets, 4096 max)
ip_tables: (C) 2000-2006 Netfilter Core Team
TCP westwood registered
NET: Registered protocol family 1
NET: Registered protocol family 17
Bridge firewalling registered
802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;
All bugs added by David S. Miller &lt;davem@redhat.com&gt;
XScale DSP coprocessor detected.
drivers/rtc/hctosys.c: unable to open rtc device (rtc0)
VFS: Mounted root (squashfs filesystem) readonly.
Freeing init memory: 96K
Please be patient, while OpenWrt loads ...
mini_fo: using base directory: /
mini_fo: using storage directory: /tmp/root
PPP generic driver version 2.4.2
wlan: trunk
ath_hal: module license &#039;Proprietary&#039; taints kernel.
ath_hal: 0.9.30.13 (AR5210, AR5211, AR5212, AR5416, RF5111, RF5112, RF2413, RF5413, RF2133, REGOPS_FUNC)
ath_rate_minstrel: Minstrel automatic rate control algorithm 1.2 (trunk)
ath_rate_minstrel: look around rate set to 10%
ath_rate_minstrel: EWMA rolloff level set to 75%
ath_rate_minstrel: max segment size in the mrr set to 6000 us
wlan: mac acl policy registered
ath_pci: trunk
jffs2: Too few erase blocks (1)
root@OpenWrt:/#</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p66139">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Kaloz</div>
					<div class="post-datetime">
						1 Apr 2008, 18:27					</div>
				</div>
				<div class="post-content content">
					<p>I mean a dmesg from the reference firmware, which uses the intel access library.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p66141">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">antonello</div>
					<div class="post-datetime">
						1 Apr 2008, 18:38					</div>
				</div>
				<div class="post-content content">
					<p>Sorry,</p><p>the &quot;reference&quot; firmware that I use is from Montavista Pro 5.0<br />whit AccessLibrary 2.4 without crypto.</p><div class="codebox"><pre><code>uname -a
Linux (none) 2.6.18_pro500-ixdp42x-arm_xscale_be #53 PREEMPT Tue Feb 26 15:23:06 CET 2008 armv5teb unknown
# 
# dmesg
&lt;5&gt;Linux version 2.6.18_pro500-ixdp42x-arm_xscale_be (root@AntoPC001) (gcc version 4.2.0 (MontaVista 4.2.0-4.0.13.0704681 2007-12-22)) #53 PREEMPT Tue Feb 26 15:23:06 CET 2008
&lt;4&gt;CPU: XScale-IXP42x Family [690541c1] revision 1 (ARMv5TE), cr=000039ff
&lt;4&gt;Machine: Intel IXDPG425
&lt;4&gt;Memory policy: ECC disabled, Data cache writeback
&lt;7&gt;On node 0 totalpages: 8192
&lt;7&gt;  DMA zone: 8192 pages, LIFO batch:1
&lt;4&gt;CPU0: D VIVT undefined 5 cache
&lt;4&gt;CPU0: I cache: 32768 bytes, associativity 32, 32 byte lines, 32 sets
&lt;4&gt;CPU0: D cache: 32768 bytes, associativity 32, 32 byte lines, 32 sets
&lt;4&gt;Real-Time Preemption Support (C) 2004-2006 Ingo Molnar
&lt;4&gt;Built 1 zonelists.  Total pages: 8192
&lt;5&gt;Kernel command line: console=ttyS0,115200 root=/dev/ram rw
&lt;4&gt;WARNING: experimental RCU implementation.
&lt;4&gt;PID hash table entries: 256 (order: 8, 1024 bytes)
&lt;6&gt;Clock event device ixp4xx timer1 configured with caps set: 07
&lt;4&gt;Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
&lt;4&gt;Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
&lt;6&gt;Memory: 32MB = 32MB total
&lt;5&gt;Memory: 25988KB available (2112K code, 450K data, 3888K init)
&lt;7&gt;Calibrating delay loop... 532.48 BogoMIPS (lpj=2662400)
&lt;4&gt;Mount-cache hash table entries: 512
&lt;6&gt;CPU: Testing write buffer coherency: ok
&lt;6&gt;NET: Registered protocol family 16
&lt;4&gt;IXP4xx: Using 16MiB expansion bus window size
&lt;6&gt;NET: Registered protocol family 2
&lt;4&gt;IP route cache hash table entries: 256 (order: -2, 1024 bytes)
&lt;4&gt;TCP established hash table entries: 1024 (order: 3, 32768 bytes)
&lt;4&gt;TCP bind hash table entries: 512 (order: 1, 14336 bytes)
&lt;6&gt;TCP: Hash tables configured (established 1024 bind 512)
&lt;6&gt;TCP reno registered
&lt;4&gt;NetWinder Floating Point Emulator V0.97 (double precision)
&lt;6&gt;JFFS2 version 2.2. (NAND) (C) 2001-2006 Red Hat, Inc.
&lt;6&gt;io scheduler noop registered
&lt;6&gt;io scheduler anticipatory registered (default)
&lt;6&gt;io scheduler deadline registered
&lt;6&gt;io scheduler cfq registered
&lt;4&gt;IXP4xx Watchdog Timer: heartbeat 60 sec
&lt;6&gt;Serial: 8250/16550 driver $Revision: 1.90 $ 2 ports, IRQ sharing disabled
&lt;6&gt;serial8250.0: ttyS0 at MMIO map 0xc8000000 mem 0xffbeb003 (irq = 15) is a XScale
&lt;4&gt;RAMDISK driver initialized: 16 RAM disks of 10240K size 1024 blocksize
&lt;6&gt;loop: loaded (max 8 devices)
&lt;6&gt;i2c /dev entries driver
&lt;6&gt;Uniform Multi-Platform E-IDE driver Revision: 7.00alpha2
&lt;6&gt;ide: Assuming 50MHz system bus speed for PIO modes; override with idebus=xx
&lt;6&gt;mice: PS/2 mouse device common for all mice
&lt;6&gt;IPv4 over IPv4 tunneling driver
&lt;6&gt;TCP bic registered
&lt;6&gt;NET: Registered protocol family 1
&lt;6&gt;NET: Registered protocol family 8
&lt;6&gt;NET: Registered protocol family 20
&lt;6&gt;Time: OSTS clocksource has been installed.
&lt;3&gt;IP-Config: No network devices available.
&lt;6&gt;Freeing init memory: 3888K
&lt;4&gt;ixp400: module license &#039;unspecified&#039; taints kernel.
&lt;7&gt;ixp400: Module init.
&lt;4&gt;ixp400_eth: no version for &quot;ixQMgrInit&quot; found: kernel tainted.
&lt;6&gt;ixp400_eth: Initializing IXP400 NPE Ethernet driver software v. 1.7 
&lt;6&gt;ixp400_eth: CPU clock speed (approx) = 532 MHz
&lt;4&gt;[error] ixEthMiiPhyScan : unexpected Mii PHY ID 329070d0
&lt;6&gt;ixp400_eth: ixp0 is using NPEB and the PHY at address 5
&lt;6&gt;ixp400_eth: ixp1 is using NPEC and the PHY at address 4
&lt;4&gt;ixp400_eth: Use default MAC address 00:02:c1:05:08:01 for port 0
&lt;4&gt;ixp400_eth: Use default MAC address 00:02:c1:05:08:02 for port 1
# ifcon# ifconfig ixp0
ixp0      Link encap:Ethernet  HWaddr 00:02:C1:05:08:01  
          inet addr:192.168.1.88  Bcast:192.168.1.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:101 errors:0 dropped:0 overruns:0 frame:0
          TX packets:5 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:256 
          RX bytes:7626 (7.4 KiB)  TX bytes:378 (378.0 B)

#</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p66147">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">antonello</div>
					<div class="post-datetime">
						1 Apr 2008, 19:44					</div>
				</div>
				<div class="post-content content">
					<p>I see that for IXDPG425, so CONFIG_MACH_IXDPG425, in the<br />trunk/build_dir/linux-ixp4xx_generic/linux-2.6.24.2/arch/arm/mach-ixp4xx/Makefile<br />that file compiled is coyote-setup.c.<br />In this file there isn&#039;t anything about &quot;NPE&quot;.</p><p>Could this be the problem?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p66156">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">Kaloz</div>
					<div class="post-datetime">
						1 Apr 2008, 21:39					</div>
				</div>
				<div class="post-content content">
					<p>No.. I&#039;ll try to find time to give you a test image tomorrow, so we cna fix this issue <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p66391">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">schao</div>
					<div class="post-datetime">
						6 Apr 2008, 10:18					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>Is there any progress to this problem?&nbsp; Just curious since I&#039;m having a similar ethernet problem with my ixp4xx system.&nbsp; Thanks.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p66449">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">Kaloz</div>
					<div class="post-datetime">
						7 Apr 2008, 13:49					</div>
				</div>
				<div class="post-content content">
					<p>antonello: please try trunk, I&#039;ve commited the support code in r10756</p><p>schao: each different board needs different setup.. what platform are you working with?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p66497">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">antonello</div>
					<div class="post-datetime">
						8 Apr 2008, 09:47					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I tried latest trunk (r10759). In the bin directory now there is a specific kernel image for IXDPG425<br />board: openwrt-ixdpg425-zImage.<br />The MII PHY are successfully detected, but the MAC address is not setted.<br />I tried to set MAC address manually ad ethernet interface work fine.<br />I see also your patch to add IXDPG425 support.</p><p>[CODE]<br /><span style="color: blue"><br />+<br />Trying NPE-B...success. Using NPE-B with PHY 5.<br />Ethernet eth0: MAC address 00:03:47:df:32:a8<br />IP: 192.168.1.89/255.255.255.0, Gateway: 192.168.1.1<br />Default server: 192.168.1.36</p><p>RedBoot(tm) bootstrap and debug environment [ROM]<br />Red Hat certified release, version 2.04 - built 15:36:33, Mar 21 2007</p><p>Platform: Intel IXDPG425 Network Gateway Reference (IXP42X 533MHz) BE<br />Copyright (C) 2000, 2001, 2002, 2003, 2004, 2007 Free Software Foundation, Inc.</p><p>RAM: 0x00000000-0x02000000, [0x00026910-0x01fc1000] available<br />FLASH: 0x50000000 - 0x51000000, 128 blocks of 0x00020000 bytes each.<br />== Executing boot script in 2.000 seconds - enter ^C to abort<br />^C<br />RedBoot&gt; fconfig -l<br />Run script at boot: true<br />Boot script: <br />.. fis load kernel<br />.. exec</p><p>Boot script timeout (1000ms resolution): 2<br />Use BOOTP for network configuration: false<br />Gateway IP address: 192.168.1.1<br />Local IP address: 192.168.1.89<br />Local IP address mask: 255.255.255.0<br />Default server IP address: 192.168.1.36<br />Console baud rate: 115200<br />GDB connection port: 9000<br />Force console for special debug messages: false<br />Network debug at boot time: false<br />Default network device: npe_eth0<br />Network hardware address [MAC] for npe_eth0: 0x00:0x03:0x47:0xDF:0x32:0xA8<br />Network hardware address [MAC] for npe_eth1: 0x00:0x03:0x47:0xDF:0x32:0xAA<br />RedBoot&gt; fis load kernel<br />RedBoot&gt; exec<br />Using base address 0x00026c00 and length 0x000f1c74<br />Uncompressing Linux.................................................................... done, booting the kernel.<br /></span><br /><span style="color: green"><br />Linux version 2.6.24.2 (antonello@AntoPC001) (gcc version 4.1.2) #1 Mon Apr 7 16:58:14 CEST 2008<br />CPU: XScale-IXP42x Family [690541c1] revision 1 (ARMv5TE), cr=000039ff<br />Machine: Intel IXDPG425<br />Memory policy: ECC disabled, Data cache writeback<br />CPU0: D VIVT undefined 5 cache<br />CPU0: I cache: 32768 bytes, associativity 32, 32 byte lines, 32 sets<br />CPU0: D cache: 32768 bytes, associativity 32, 32 byte lines, 32 sets<br />Built 1 zonelists in Zone order, mobility grouping on.&nbsp; Total pages: 8128<br />Kernel command line: root=/dev/mtdblock2 rootfstype=squashfs,jffs2 noinitrd console=ttyS0,115200 init=/etc/preinit<br />PID hash table entries: 128 (order: 7, 512 bytes)<br />Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)<br />Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)<br />Memory: 32MB = 32MB total<br />Memory: 30320KB available (1844K code, 181K data, 96K init)<br />Mount-cache hash table entries: 512<br />CPU: Testing write buffer coherency: ok<br />net_namespace: 64 bytes<br />NET: Registered protocol family 16<br />IXP4xx: Using 16MiB expansion bus window size<br />PCI: IXP4xx is host<br />PCI: IXP4xx Using direct access for memory space<br />PCI: bus0: Fast back to back transfers disabled<br />dmabounce: registered device 0000:00:0e.0 on pci bus<br />dmabounce: registered device 0000:00:0e.1 on pci bus<br />dmabounce: registered device 0000:00:0e.2 on pci bus<br />NET: Registered protocol family 2<br />Time: OSTS clocksource has been installed.<br />IP route cache hash table entries: 1024 (order: 0, 4096 bytes)<br />TCP established hash table entries: 1024 (order: 1, 8192 bytes)<br />TCP bind hash table entries: 1024 (order: 0, 4096 bytes)<br />TCP: Hash tables configured (established 1024 bind 1024)<br />TCP reno registered<br />IXP4xx Queue Manager initialized.<br />squashfs: version 3.0 (2006/03/15) Phillip Lougher<br />Registering mini_fo version $Id$<br />JFFS2 version 2.2. (NAND) (SUMMARY)&nbsp; Â© 2001-2006 Red Hat, Inc.<br />io scheduler noop registered<br />io scheduler deadline registered (default)<br />Serial: 8250/16550 driver $Revision: 1.90 $ 2 ports, IRQ sharing disabled<br />serial8250.0: ttyS0 at MMIO 0xc8000000 (irq = 15) is a XScale<br />console [ttyS0] enabled<br />eth0: MII PHY 5 on NPE-B<br />eth1: MII PHY 4 on NPE-C<br />IXP4XX-Flash.0: Found 1 x16 devices at 0x0 in 16-bit bank<br /> Intel/Sharp Extended Query Table at 0x0031<br />Using buffer write method<br />cfi_cmdset_0001: Erase suspend on write enabled<br />Searching for RedBoot partition table in IXP4XX-Flash.0 at offset 0xfe0000<br />5 RedBoot partitions found on MTD device IXP4XX-Flash.0<br />Creating 5 MTD partitions on &quot;IXP4XX-Flash.0&quot;:<br />0x00000000-0x00080000 : &quot;RedBoot&quot;<br />0x00080000-0x00180000 : &quot;kernel&quot;<br />0x00180000-0x002a0000 : &quot;rootfs&quot;<br />mtd: partition &quot;rootfs&quot; set to be root filesystem<br />mtd: partition &quot;rootfs_data&quot; created automatically, ofs=280000, len=20000 <br />0x00280000-0x002a0000 : &quot;rootfs_data&quot;<br />0x00fe0000-0x00fff000 : &quot;FIS directory&quot;<br />0x00fff000-0x01000000 : &quot;RedBoot config&quot;<br />i2c /dev entries driver<br />i2c-gpio: probe failed: -19<br />IXP4xx Watchdog Timer: heartbeat 60 sec<br />nf_conntrack version 0.5.0 (1024 buckets, 4096 max)<br />ip_tables: (C) 2000-2006 Netfilter Core Team<br />TCP westwood registered<br />NET: Registered protocol family 1<br />NET: Registered protocol family 17<br />Bridge firewalling registered<br />802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;<br />All bugs added by David S. Miller &lt;davem@redhat.com&gt;<br />XScale DSP coprocessor detected.<br />drivers/rtc/hctosys.c: unable to open rtc device (rtc0)<br />VFS: Mounted root (squashfs filesystem) readonly.<br />Freeing init memory: 96K<br />Please be patient, while OpenWrt loads ...<br />- preinit -<br />jffs2 not ready yet; using ramdisk<br />mini_fo: using base directory: /<br />mini_fo: using storage directory: /tmp/root<br />- init -</p><p>Please press Enter to activate this console. PPP generic driver version 2.4.2<br />wlan: trunk<br />ath_hal: module license &#039;Proprietary&#039; taints kernel.<br />ath_hal: 0.9.30.13 (AR5210, AR5211, AR5212, AR5416, RF5111, RF5112, RF2413, RF5413, RF2133, REGOPS_FUNC)<br />ath_rate_minstrel: Minstrel automatic rate control algorithm 1.2 (trunk)<br />ath_rate_minstrel: look around rate set to 10%<br />ath_rate_minstrel: EWMA rolloff level set to 75%<br />ath_rate_minstrel: max segment size in the mrr set to 6000 us<br />wlan: mac acl policy registered<br />ath_pci: trunk<br />jffs2: Too few erase blocks (1)</p><br /><br /><p>BusyBox v1.8.2 (2008-04-07 16:46:37 CEST) built-in shell (ash)<br />Enter &#039;help&#039; for a list of built-in commands.</p><p>&nbsp; _______&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;________&nbsp; &nbsp; &nbsp; &nbsp; __<br /> |&nbsp; &nbsp; &nbsp; &nbsp;|.-----.-----.-----.|&nbsp; |&nbsp; |&nbsp; |.----.|&nbsp; |_<br /> |&nbsp; &nbsp;-&nbsp; &nbsp;||&nbsp; _&nbsp; |&nbsp; -__|&nbsp; &nbsp; &nbsp;||&nbsp; |&nbsp; |&nbsp; ||&nbsp; &nbsp;_||&nbsp; &nbsp;_|<br /> |_______||&nbsp; &nbsp;__|_____|__|__||________||__|&nbsp; |____|<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |__| W I R E L E S S&nbsp; &nbsp;F R E E D O M<br /> KAMIKAZE (bleeding edge, r10759) -------------------<br />&nbsp; * 10 oz Vodka&nbsp; &nbsp; &nbsp; &nbsp;Shake well with ice and strain<br />&nbsp; * 10 oz Triple sec&nbsp; mixture into 10 shot glasses.<br />&nbsp; * 10 oz lime juice&nbsp; Salute!<br /> ---------------------------------------------------<br />root@OpenWrt:/# ifconfig <br />lo&nbsp; &nbsp; &nbsp; &nbsp; Link encap:Local Loopback&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:127.0.0.1&nbsp; Mask:255.0.0.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP LOOPBACK RUNNING&nbsp; MTU:16436&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:0 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0 <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:0 (0.0 B)&nbsp; TX bytes:0 (0.0 B)</p><p>root@OpenWrt:/# ifconfig eth0<br />eth0&nbsp; &nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 00:00:00:00:00:00&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:192.168.1.1&nbsp; Bcast:192.168.1.255&nbsp; Mask:255.255.255.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BROADCAST MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:0 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:100 <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:0 (0.0 B)&nbsp; TX bytes:0 (0.0 B)</p><p>root@OpenWrt:/# ifconfig eth1<br />eth1&nbsp; &nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 00:00:00:00:00:00&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BROADCAST MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:0 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:100 <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:0 (0.0 B)&nbsp; TX bytes:0 (0.0 B)</p><p>root@OpenWrt:/# ifconfig eth0 down<br />root@OpenWrt:/# ifconfig eth0 hw ether 00:03:47:df:32:a8<br />root@OpenWrt:/# ifconfig eth0 192.168.1.188<br />NPE-B: firmware&#039;s license can be found in /usr/share/doc/LICENSE.IPL<br />NPE-B: firmware functionality 0x2, revision 0x2:1<br />eth0: link up, 100Mbps, full-duplex, lpa 0x05E1<br />root@OpenWrt:/# ifconfig&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />eth0&nbsp; &nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 00:03:47:DF:32:A8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:192.168.1.188&nbsp; Bcast:192.168.1.255&nbsp; Mask:255.255.255.0&nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:83 errors:0 dropped:0 overruns:0 frame:0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:6 errors:0 dropped:0 overruns:0 carrier:0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:100&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:6875 (6.7 KiB)&nbsp; TX bytes:476 (476.0 B)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />lo&nbsp; &nbsp; &nbsp; &nbsp; Link encap:Local Loopback&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:127.0.0.1&nbsp; Mask:255.0.0.0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP LOOPBACK RUNNING&nbsp; MTU:16436&nbsp; Metric:1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:0 errors:0 dropped:0 overruns:0 frame:0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:0 errors:0 dropped:0 overruns:0 carrier:0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:0 (0.0 B)&nbsp; TX bytes:0 (0.0 B)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />root@OpenWrt:/# ping 192.168.1.1<br />PING 192.168.1.1 (192.168.1.1): 56 data bytes<br />64 bytes from 192.168.1.1: seq=0 ttl=64 time=12.315 ms<br />64 bytes from 192.168.1.1: seq=1 ttl=64 time=1.389 ms<br />64 bytes from 192.168.1.1: seq=2 ttl=64 time=1.316 ms<br />64 bytes from 192.168.1.1: seq=3 ttl=64 time=1.413 ms</p><p>--- 192.168.1.1 ping statistics ---<br />4 packets transmitted, 4 packets received, 0% packet loss<br />round-trip min/avg/max = 1.316/4.108/12.315 ms<br />root@OpenWrt:/#<br /></span><br />[\CODE]</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p66519">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">Kaloz</div>
					<div class="post-datetime">
						8 Apr 2008, 19:02					</div>
				</div>
				<div class="post-content content">
					<p>Check the offset of the mac addresses in the flash. For the mac address set up you need a patch, something like how it&#039;s done for the nas100d in <a href="https://dev.openwrt.org/browser/trunk/target/linux/ixp4xx/patches-2.6.24/031-nslu2_nas100d_ethernet_support.patch">https://dev.openwrt.org/browser/trunk/t … port.patch</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p66561">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">antonello</div>
					<div class="post-datetime">
						9 Apr 2008, 15:19					</div>
				</div>
				<div class="post-content content">
					<p>I successfully patched file:<br /> <em>build_dir/linux-ixp4xx_generic/linux-2.6.24.2/arch/arm/mach-ixp4xx/coyote-setup.c</em></p><p>I&#039;m newbie, and I do not know how to create a patch file like:<br /> <em>target/linux/ixp4xx/patches-2.6.24/170-ixdpg425_mac_plat_info.patch</em></p><p>I think that it is better to improve the &quot;searching&quot; of MAC address in flash.<br />My idea is to search for strings <strong>&quot;npe_eth0_esa.&quot;</strong> and <strong>&quot;npe_eth1_esa.&quot;</strong><br />and get MAC address.<br />I can implement if it is a good idea.</p><p><strong>Console Output</strong><br /></p><div class="codebox"><pre><code>+
Trying NPE-B...success. Using NPE-B with PHY 5.
Ethernet eth0: MAC address 00:03:47:df:32:a8
IP: 192.168.1.89/255.255.255.0, Gateway: 192.168.1.1
Default server: 192.168.1.36

RedBoot(tm) bootstrap and debug environment [ROM]
Red Hat certified release, version 2.04 - built 15:36:33, Mar 21 2007

Platform: Intel IXDPG425 Network Gateway Reference (IXP42X 533MHz) BE
Copyright (C) 2000, 2001, 2002, 2003, 2004, 2007 Free Software Foundation, Inc.

RAM: 0x00000000-0x02000000, [0x00026910-0x01fc1000] available
FLASH: 0x50000000 - 0x51000000, 128 blocks of 0x00020000 bytes each.
== Executing boot script in 2.000 seconds - enter ^C to abort
^C
RedBoot&gt; fconfig -l
Run script at boot: true
Boot script: 
.. fis load kernel
.. exec

Boot script timeout (1000ms resolution): 2
Use BOOTP for network configuration: false
Gateway IP address: 192.168.1.1
Local IP address: 192.168.1.89
Local IP address mask: 255.255.255.0
Default server IP address: 192.168.1.36
Console baud rate: 115200
GDB connection port: 9000
Force console for special debug messages: false
Network debug at boot time: false
Default network device: npe_eth0
Network hardware address [MAC] for npe_eth0: 0x00:0x03:0x47:0xDF:0x32:0xA8
Network hardware address [MAC] for npe_eth1: 0x00:0x03:0x47:0xDF:0x32:0xAA
RedBoot&gt; fis list
Name              FLASH addr  Mem addr    Length      Entry point
RedBoot           0x50000000  0x50000000  0x00080000  0x00000000
kernel            0x50080000  0x00026C00  0x00100000  0x00026C00
rootfs            0x50180000  0x00026C00  0x00120000  0x00026C00
FIS directory     0x50FE0000  0x50FE0000  0x0001F000  0x00000000
RedBoot config    0x50FFF000  0x50FFF000  0x00001000  0x00000000

RedBoot&gt; x -b 0x50FFF400 -l 0x30
50FFF400: 6E 70 65 5F 65 74 68 30  5F 65 73 61 00 00 03 47  |npe_eth0_esa...G|
50FFF410: DF 32 A8 00 00 06 0D 01  00 6E 70 65 5F 65 74 68  |.2.......npe_eth|
50FFF420: 31 5F 65 73 61 00 00 03  47 DF 32 AA 00 00 00 00  |1_esa...G.2.....|
RedBoot&gt; x -b 0x50fff40d -l 0x6
50FFF40D: 00 03 47 DF 32 A8                                 |..G.2.          |
RedBoot&gt; x -b 0x50fff426 -l 0x6
50FFF426: 00 03 47 DF 32 AA                                 |..G.2.          |
RedBoot&gt; fis load kernel
RedBoot&gt; exec
Using base address 0x00026c00 and length 0x000f1ce8
Uncompressing Linux.................................................................... done, booting the kernel.
Linux version 2.6.24.2 (antonello@AntoPC001) (gcc version 4.1.2) #3 Wed Apr 9 13:36:21 CEST 2008
CPU: XScale-IXP42x Family [690541c1] revision 1 (ARMv5TE), cr=000039ff
Machine: Intel IXDPG425
Memory policy: ECC disabled, Data cache writeback
CPU0: D VIVT undefined 5 cache
CPU0: I cache: 32768 bytes, associativity 32, 32 byte lines, 32 sets
CPU0: D cache: 32768 bytes, associativity 32, 32 byte lines, 32 sets
Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 8128
Kernel command line: root=/dev/mtdblock2 rootfstype=squashfs,jffs2 noinitrd console=ttyS0,115200 init=/etc/preinit
PID hash table entries: 128 (order: 7, 512 bytes)
Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
Memory: 32MB = 32MB total
Memory: 30320KB available (1844K code, 181K data, 96K init)
Mount-cache hash table entries: 512
CPU: Testing write buffer coherency: ok
net_namespace: 64 bytes
NET: Registered protocol family 16
IXP4xx: Using 16MiB expansion bus window size
IXDPG425: Using MAC address 00:03:47:df:32:a8 for port 0
IXDPG425: Using MAC address 00:03:47:df:32:a8 for port 1
PCI: IXP4xx is host
PCI: IXP4xx Using direct access for memory space
PCI: bus0: Fast back to back transfers disabled
dmabounce: registered device 0000:00:0e.0 on pci bus
dmabounce: registered device 0000:00:0e.1 on pci bus
dmabounce: registered device 0000:00:0e.2 on pci bus
NET: Registered protocol family 2
Time: OSTS clocksource has been installed.
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 1024 (order: 1, 8192 bytes)
TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
TCP: Hash tables configured (established 1024 bind 1024)
TCP reno registered
IXP4xx Queue Manager initialized.
squashfs: version 3.0 (2006/03/15) Phillip Lougher
Registering mini_fo version $Id$
JFFS2 version 2.2. (NAND) (SUMMARY)  Â© 2001-2006 Red Hat, Inc.
io scheduler noop registered
io scheduler deadline registered (default)
Serial: 8250/16550 driver $Revision: 1.90 $ 2 ports, IRQ sharing disabled
serial8250.0: ttyS0 at MMIO 0xc8000000 (irq = 15) is a XScale
console [ttyS0] enabled
eth0: MII PHY 5 on NPE-B
eth1: MII PHY 4 on NPE-C
IXP4XX-Flash.0: Found 1 x16 devices at 0x0 in 16-bit bank
 Intel/Sharp Extended Query Table at 0x0031
Using buffer write method
cfi_cmdset_0001: Erase suspend on write enabled
Searching for RedBoot partition table in IXP4XX-Flash.0 at offset 0xfe0000
5 RedBoot partitions found on MTD device IXP4XX-Flash.0
Creating 5 MTD partitions on &quot;IXP4XX-Flash.0&quot;:
0x00000000-0x00080000 : &quot;RedBoot&quot;
0x00080000-0x00180000 : &quot;kernel&quot;
0x00180000-0x002a0000 : &quot;rootfs&quot;
mtd: partition &quot;rootfs&quot; set to be root filesystem
mtd: partition &quot;rootfs_data&quot; created automatically, ofs=280000, len=20000 
0x00280000-0x002a0000 : &quot;rootfs_data&quot;
0x00fe0000-0x00fff000 : &quot;FIS directory&quot;
0x00fff000-0x01000000 : &quot;RedBoot config&quot;
i2c /dev entries driver
i2c-gpio: probe failed: -19
IXP4xx Watchdog Timer: heartbeat 60 sec
nf_conntrack version 0.5.0 (1024 buckets, 4096 max)
ip_tables: (C) 2000-2006 Netfilter Core Team
TCP westwood registered
NET: Registered protocol family 1
NET: Registered protocol family 17
Bridge firewalling registered
802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;
All bugs added by David S. Miller &lt;davem@redhat.com&gt;
XScale DSP coprocessor detected.
drivers/rtc/hctosys.c: unable to open rtc device (rtc0)
VFS: Mounted root (squashfs filesystem) readonly.
Freeing init memory: 96K
Please be patient, while OpenWrt loads ...
- preinit -
jffs2 not ready yet; using ramdisk
mini_fo: using base directory: /
mini_fo: using storage directory: /tmp/root
- init -

Please press Enter to activate this console. NPE-B: firmware&#039;s license can be found in /usr/share/doc/LICENSE.IPL
NPE-B: firmware functionality 0x2, revision 0x2:1
eth0: link up, 100Mbps, full-duplex, lpa 0x05E1
PPP generic driver version 2.4.2
wlan: trunk
ath_hal: module license &#039;Proprietary&#039; taints kernel.
ath_hal: 0.9.30.13 (AR5210, AR5211, AR5212, AR5416, RF5111, RF5112, RF2413, RF5413, RF2133, REGOPS_FUNC)
ath_rate_minstrel: Minstrel automatic rate control algorithm 1.2 (trunk)
ath_rate_minstrel: look around rate set to 10%
ath_rate_minstrel: EWMA rolloff level set to 75%
ath_rate_minstrel: max segment size in the mrr set to 6000 us
wlan: mac acl policy registered
ath_pci: trunk
jffs2: Too few erase blocks (1)
 


BusyBox v1.8.2 (2008-04-07 16:46:37 CEST) built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 KAMIKAZE (bleeding edge, r10759) -------------------
  * 10 oz Vodka       Shake well with ice and strain
  * 10 oz Triple sec  mixture into 10 shot glasses.
  * 10 oz lime juice  Salute!
 ---------------------------------------------------
root@OpenWrt:/# ifconroot@OpenWrt:/# ifconfig 
eth0      Link encap:Ethernet  HWaddr 00:03:47:DF:32:A8  
          inet addr:192.168.1.1  Bcast:192.168.1.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:3 errors:0 dropped:0 overruns:0 frame:0
          TX packets:2 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:100 
          RX bytes:722 (722.0 B)  TX bytes:652 (652.0 B)

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

root@OpenWrt:/#</code></pre></div><p><strong>Patch File</strong><br /></p><div class="codebox"><pre><code>--- arch/arm/mach-ixp4xx/coyote-setup.c.orig    2008-04-09 13:14:34.000000000 +0200
+++ arch/arm/mach-ixp4xx/coyote-setup.c    2008-04-09 13:35:41.000000000 +0200
@@ -11,6 +11,7 @@
 #include &lt;linux/kernel.h&gt;
 #include &lt;linux/init.h&gt;
 #include &lt;linux/device.h&gt;
+#include &lt;linux/if_ether.h&gt;
 #include &lt;linux/serial.h&gt;
 #include &lt;linux/tty.h&gt;
 #include &lt;linux/serial_8250.h&gt;
@@ -24,6 +25,7 @@
 #include &lt;asm/mach-types.h&gt;
 #include &lt;asm/mach/arch.h&gt;
 #include &lt;asm/mach/flash.h&gt;
+#include &lt;asm/io.h&gt;
 
 static struct flash_platform_data coyote_flash_data = {
     .map_name    = &quot;cfi_probe&quot;,
@@ -108,6 +110,10 @@
 
 static void __init coyote_init(void)
 {
+    DECLARE_MAC_BUF(mac_buf);
+    uint8_t __iomem *f;
+    int i;
+
     ixp4xx_sys_init();
 
     coyote_flash_resource.start = IXP4XX_EXP_BUS_BASE(0);
@@ -124,6 +130,37 @@
     }
 
     platform_add_devices(coyote_devices, ARRAY_SIZE(coyote_devices));
+
+    /*
+     * Map in a portion of the flash and read the MAC address.
+     * Since it is stored in BE in the flash itself, we need to
+     * byteswap it if we&#039;re in LE mode.
+     */
+    f = ioremap(IXP4XX_EXP_BUS_BASE(0), 0x1000000);
+    if (f) {
+        for (i = 0; i &lt; 6; i++)
+#ifdef __ARMEB__
+        ixdpg425_plat_eth[0].hwaddr[i] = readb(f + 0xFFF40D + i);
+#else
+        ixdpg425_plat_eth[0].hwaddr[i] = readb(f + 0xFFF40D + (i^3));
+#endif
+        iounmap(f);
+    }
+    printk(KERN_INFO &quot;IXDPG425: Using MAC address %s for port 0\n&quot;,
+        print_mac(mac_buf, ixdpg425_plat_eth[0].hwaddr));
+
+    f = ioremap(IXP4XX_EXP_BUS_BASE(0), 0x1000000);
+    if (f) {
+        for (i = 0; i &lt; 6; i++)
+#ifdef __ARMEB__
+        ixdpg425_plat_eth[1].hwaddr[i] = readb(f + 0xFFF426 + i);
+#else
+        ixdpg425_plat_eth[1].hwaddr[i] = readb(f + 0xFFF426 + (i^3));
+#endif
+        iounmap(f);
+    }
+    printk(KERN_INFO &quot;IXDPG425: Using MAC address %s for port 1\n&quot;,
+        print_mac(mac_buf, ixdpg425_plat_eth[0].hwaddr));
 }
 
 #ifdef CONFIG_ARCH_ADI_COYOTE</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p66562">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">Kaloz</div>
					<div class="post-datetime">
						9 Apr 2008, 15:24					</div>
				</div>
				<div class="post-content content">
					<p>If you come up with a patch, I&#039;m happy to look into it.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p66691">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">antonello</div>
					<div class="post-datetime">
						11 Apr 2008, 13:51					</div>
				</div>
				<div class="post-content content">
					<p>I try to implement a string match, but the solution that I have implemented are very slow (7 sec).<br />The problem is that the flash is very large (16Mbytes).</p><p>Have you a method to suggest me?</p><p>Also, have you planned to release a new patch to fix MAC address problem for IXDPG425 board?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p66715">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">Kaloz</div>
					<div class="post-datetime">
						11 Apr 2008, 21:42					</div>
				</div>
				<div class="post-content content">
					<p>You only have to search in the redboot config location - that is a fix location per board. Regarding your current patch, I plan to add it to the rpo this weekend.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p66839">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">antonello</div>
					<div class="post-datetime">
						14 Apr 2008, 13:33					</div>
				</div>
				<div class="post-content content">
					<p>Hello Kaloz. Thank you for suggestion,</p><p>I implemented and test following patch.</p><p>I hope to be good <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><div class="codebox"><pre><code>--- arch/arm/mach-ixp4xx/coyote-setup.c.orig    2008-04-09 13:14:34.000000000 +0200
+++ arch/arm/mach-ixp4xx/coyote-setup.c    2008-04-14 12:21:03.000000000 +0200
@@ -11,6 +11,7 @@
 #include &lt;linux/kernel.h&gt;
 #include &lt;linux/init.h&gt;
 #include &lt;linux/device.h&gt;
+#include &lt;linux/if_ether.h&gt;
 #include &lt;linux/serial.h&gt;
 #include &lt;linux/tty.h&gt;
 #include &lt;linux/serial_8250.h&gt;
@@ -24,6 +25,7 @@
 #include &lt;asm/mach-types.h&gt;
 #include &lt;asm/mach/arch.h&gt;
 #include &lt;asm/mach/flash.h&gt;
+#include &lt;asm/io.h&gt;
 
 static struct flash_platform_data coyote_flash_data = {
     .map_name    = &quot;cfi_probe&quot;,
@@ -108,6 +110,10 @@
 
 static void __init coyote_init(void)
 {
+    DECLARE_MAC_BUF(mac_buf);
+    uint8_t __iomem *f;
+    int i,j;
+
     ixp4xx_sys_init();
 
     coyote_flash_resource.start = IXP4XX_EXP_BUS_BASE(0);
@@ -124,6 +130,42 @@
     }
 
     platform_add_devices(coyote_devices, ARRAY_SIZE(coyote_devices));
+
+    /*
+     * Map in a portion of the flash (RedBoot config partition)
+     * and try to search for &#039;npe_eth0_esa&#039; and &#039;npe_eth1_esa&#039;
+     * string and read the MAC address. 
+     * Since it is stored in BE in the flash itself, we need to
+     * byteswap it if we&#039;re in LE mode.
+     */
+    f = ioremap(0x50FFF000, 0x0001000);
+    if(f) {
+        for (j = 0; j &lt; 0x1000; j++) {
+            if(memcmp(f+j, &quot;npe_eth0_esa&quot;, 12) == 0) {
+                for (i = 0; i &lt; 6; i++)
+#ifdef __ARMEB__
+                ixdpg425_plat_eth[0].hwaddr[i] = readb(f+j + 0xd + i);
+#else
+                ixdpg425_plat_eth[0].hwaddr[i] = readb(f+j + 0xd + (i^3));
+#endif
+                printk(KERN_INFO &quot;IXDPG425: Using MAC address %s for port 0\n&quot;,
+                    print_mac(mac_buf, ixdpg425_plat_eth[0].hwaddr));
+            }
+            if(memcmp(f+j, &quot;npe_eth1_esa&quot;, 12) == 0) {
+                for (i = 0; i &lt; 6; i++)
+#ifdef __ARMEB__
+                ixdpg425_plat_eth[1].hwaddr[i] = readb(f+j + 0xd + i);
+#else
+                ixdpg425_plat_eth[1].hwaddr[i] = readb(f+j + 0xd + (i^3));
+#endif
+                printk(KERN_INFO &quot;IXDPG425: Using MAC address %s for port 1\n&quot;,
+                    print_mac(mac_buf, ixdpg425_plat_eth[1].hwaddr));
+            }
+        }
+        iounmap(f);
+    } else
+        printk(KERN_WARNING &quot;IXDPG425: read MAC address fail: unable to map flash\n&quot;);
+    
 }
 
 #ifdef CONFIG_ARCH_ADI_COYOTE</code></pre></div>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>