<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Is possible to connect with 2 AP simultaneously in Client Mode?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 20 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p256981">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">kokoliso</div>
					<div class="post-datetime">
						8 Dec 2014, 20:15					</div>
				</div>
				<div class="post-content content">
					<p>Hello.<br />I have a TP-Link TL-WDR3500 v1 with 2 radios and 2 antennas (dual router). I have one antenna with a dish pointing to an AP and another antenna pointing to other AP. Both have a good signal and I can connect with them fine one by one, but cannot connect to both of them at the same time. Only one of them gets signal and the other one gets 0%.<br />Both APs are on the same channel 6.<br />Should be possible to connect to both of them and get internet from the 2 APs at the same time?<br />Thanks :-)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p257309">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">kokoliso</div>
					<div class="post-datetime">
						11 Dec 2014, 02:23					</div>
				</div>
				<div class="post-content content">
					<p>Ok. Maybe is a stupid question, but I searched before and didn&#039;t find how to done it.<br />Just answer Yes or No, Please.<br />Thanks :-)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p257310">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">mk24</div>
					<div class="post-datetime">
						11 Dec 2014, 03:13					</div>
				</div>
				<div class="post-content content">
					<p>Do these two AP&#039;s ultimately lead to different public IP&#039;s on the Internet?&nbsp; </p><p>In that case you <em>can&#039;t</em>* really use them simultaneously like you might think of combining two water pipelines with a tee fitting.&nbsp; When for example someone goes to a web site (or even worse, starts watching a movie), the web server expects to send the whole page or movie back to the same IP that the request came from.&nbsp; You have a situation where either &quot;load balancing&quot; or &quot;failover&quot; applications are needed to direct a user to one at a time.</p><p>&quot;Load balancing&quot; -- Each session (i.e. loading a web page) goes to one or the other, the one that is less busy.<br />&quot;Failover&quot; -- Only one is used at a time for all traffic.&nbsp; If that one fails, the other one is used.&nbsp; If failure is frequent, the user will be disrupted, for example a page will load halfway and then time out and he will have to reload the whole page hoping that the other connection is up.</p><p>* so there&#039;s your yes or no answer, it is no.</p>											<p class="post-edited">(Last edited by <strong>mk24</strong> on 11 Dec 2014, 03:22)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p257312">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">kokoliso</div>
					<div class="post-datetime">
						11 Dec 2014, 03:34					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>mk24 wrote:</cite><blockquote><p>Do these two AP&#039;s ultimately lead to different public IP&#039;s on the Internet?</p></blockquote></div><p>Both APs have internet connection. But is possible both APs belong to the same ISP (WISP) although are different clients.</p><div class="quotebox"><cite>mk24 wrote:</cite><blockquote><p>In that case you <em>can&#039;t</em>* really use them simultaneously like you might think of combining two water pipelines with a tee fitting.&nbsp; When for example someone goes to a web site (or even worse, starts watching a movie), the web server expects to send the whole page or movie back to the same IP that the request came from.&nbsp; You have a situation where either &quot;load balancing&quot; or &quot;failover&quot; applications are needed to direct a user to one at a time.</p><p>&quot;Load balancing&quot; -- Each session (i.e. loading a web page) goes to one or the other, the one that is less busy.<br />&quot;Failover&quot; -- Only one is used at a time for all traffic.&nbsp; If that one fails, the other one is used.&nbsp; If failure is frequent, the user will be disrupted, for example a page will load halfway and then time out and he will have to reload the whole page hoping that the other connection is up.</p><p>* so there&#039;s your yes or no answer, it is no.</p></blockquote></div><p>Ok. Then, could be possible to be connected at the same time to both APs but I cannot use both to go out to internet?<br />Is possible to run this &quot;load balancing&quot; or &quot;failover&quot; applications on OpenWRT?</p><p>But when I try to connect to both APs at the same time, I only get signal from one of them. Although I can connect at each of them one by one.</p><p>Thanks :-)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p257313">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">mk24</div>
					<div class="post-datetime">
						11 Dec 2014, 03:40					</div>
				</div>
				<div class="post-content content">
					<p>The two radios are one that works only at 2.4 GHz and one only for 5 GHz.&nbsp; I think if you want two 2.4 GHz connections at once you will need two separate routers.</p><p>Check &quot;iw list&quot; and see what interface combinations are allowed by your hardware and driver.&nbsp; Often you can only have one managed interface active at once.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p257315">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">kokoliso</div>
					<div class="post-datetime">
						11 Dec 2014, 03:58					</div>
				</div>
				<div class="post-content content">
					<div class="codebox"><pre><code>root@OpenWrt:/# iw list
Wiphy phy1
        max # scan SSIDs: 4
        max scan IEs length: 2261 bytes
        Retry short limit: 7
        Retry long limit: 4
        Coverage class: 0 (up to 0m)
        Device supports AP-side u-APSD.
        Device supports T-DLS.
        Available Antennas: TX 0x3 RX 0x3
        Configured Antennas: TX 0x3 RX 0x3
        Supported interface modes:
                 * IBSS
                 * managed
                 * AP
                 * AP/VLAN
                 * WDS
                 * monitor
                 * mesh point
                 * P2P-client
                 * P2P-GO
        Band 2:
                Capabilities: 0x11ef
                        RX LDPC
                        HT20/HT40
                        SM Power Save disabled
                        RX HT20 SGI
                        RX HT40 SGI
                        TX STBC
                        RX STBC 1-stream
                        Max AMSDU length: 3839 bytes
                        DSSS/CCK HT40
                Maximum RX AMPDU length 65535 bytes (exponent: 0x003)
                Minimum RX AMPDU time spacing: 8 usec (0x06)
                HT TX/RX MCS rate indexes supported: 0-15
                Frequencies:
                        * 5180 MHz [36] (17.0 dBm)
                        * 5200 MHz [40] (17.0 dBm)
                        * 5220 MHz [44] (17.0 dBm)
                        * 5240 MHz [48] (17.0 dBm)
                        * 5260 MHz [52] (23.0 dBm) (no IR, radar detection)
                          DFS state: usable (for 765 sec)
                          DFS CAC time: 60000 ms
                        * 5280 MHz [56] (23.0 dBm) (no IR, radar detection)
                          DFS state: usable (for 765 sec)
                          DFS CAC time: 60000 ms
                        * 5300 MHz [60] (23.0 dBm) (no IR, radar detection)
                          DFS state: usable (for 765 sec)
                          DFS CAC time: 60000 ms
                        * 5320 MHz [64] (23.0 dBm) (no IR, radar detection)
                          DFS state: usable (for 765 sec)
                          DFS CAC time: 60000 ms
                        * 5500 MHz [100] (disabled)
                        * 5520 MHz [104] (disabled)
                        * 5540 MHz [108] (disabled)
                        * 5560 MHz [112] (disabled)
                        * 5580 MHz [116] (disabled)
                        * 5600 MHz [120] (disabled)
                        * 5620 MHz [124] (disabled)
                        * 5640 MHz [128] (disabled)
                        * 5660 MHz [132] (disabled)
                        * 5680 MHz [136] (disabled)
                        * 5700 MHz [140] (disabled)
                        * 5745 MHz [149] (30.0 dBm)
                        * 5765 MHz [153] (30.0 dBm)
                        * 5785 MHz [157] (30.0 dBm)
                        * 5805 MHz [161] (30.0 dBm)
                        * 5825 MHz [165] (30.0 dBm)
        valid interface combinations:
                 * #{ managed } &lt;= 2048, #{ AP, mesh point } &lt;= 8, #{ P2P-client, P2P-GO } &lt;= 1, #{ IBSS } &lt;= 1,
                   total &lt;= 2048, #channels &lt;= 1, STA/AP BI must match
                 * #{ WDS } &lt;= 2048,
                   total &lt;= 2048, #channels &lt;= 1, STA/AP BI must match
                 * #{ IBSS, AP, mesh point } &lt;= 1,
                   total &lt;= 1, #channels &lt;= 1, STA/AP BI must match, radar detect widths: { 20 MHz (no HT), 20 MHz }

        HT Capability overrides:
                 * MCS: ff ff ff ff ff ff ff ff ff ff
                 * maximum A-MSDU length
                 * supported channel width
                 * short GI for 40 MHz
                 * max A-MPDU length exponent
                 * min MPDU start spacing
Wiphy phy0
        max # scan SSIDs: 4
        max scan IEs length: 2257 bytes
        Retry short limit: 7
        Retry long limit: 4
        Coverage class: 6 (up to 2700m)
        Device supports AP-side u-APSD.
        Device supports T-DLS.
        Available Antennas: TX 0x3 RX 0x3
        Configured Antennas: TX 0x3 RX 0x3
        Supported interface modes:
                 * IBSS
                 * managed
                 * AP
                 * AP/VLAN
                 * WDS
                 * monitor
                 * mesh point
                 * P2P-client
                 * P2P-GO
        Band 1:
                Capabilities: 0x11ef
                        RX LDPC
                        HT20/HT40
                        SM Power Save disabled
                        RX HT20 SGI
                        RX HT40 SGI
                        TX STBC
                        RX STBC 1-stream
                        Max AMSDU length: 3839 bytes
                        DSSS/CCK HT40
                Maximum RX AMPDU length 65535 bytes (exponent: 0x003)
                Minimum RX AMPDU time spacing: 8 usec (0x06)
                HT TX/RX MCS rate indexes supported: 0-15
                Frequencies:
                        * 2412 MHz [1] (20.0 dBm)
                        * 2417 MHz [2] (20.0 dBm)
                        * 2422 MHz [3] (20.0 dBm)
                        * 2427 MHz [4] (20.0 dBm)
                        * 2432 MHz [5] (20.0 dBm)
                        * 2437 MHz [6] (20.0 dBm)
                        * 2442 MHz [7] (20.0 dBm)
                        * 2447 MHz [8] (20.0 dBm)
                        * 2452 MHz [9] (20.0 dBm)
                        * 2457 MHz [10] (20.0 dBm)
                        * 2462 MHz [11] (20.0 dBm)
                        * 2467 MHz [12] (disabled)
                        * 2472 MHz [13] (disabled)
                        * 2484 MHz [14] (disabled)
        valid interface combinations:
                 * #{ managed } &lt;= 2048, #{ AP, mesh point } &lt;= 8, #{ P2P-client, P2P-GO } &lt;= 1, #{ IBSS } &lt;= 1,
                   total &lt;= 2048, #channels &lt;= 1, STA/AP BI must match
                 * #{ WDS } &lt;= 2048,
                   total &lt;= 2048, #channels &lt;= 1, STA/AP BI must match
                 * #{ IBSS, AP, mesh point } &lt;= 1,
                   total &lt;= 1, #channels &lt;= 1, STA/AP BI must match, radar detect widths: { 20 MHz (no HT), 20 MHz }

        HT Capability overrides:
                 * MCS: ff ff ff ff ff ff ff ff ff ff
                 * maximum A-MSDU length
                 * supported channel width
                 * short GI for 40 MHz
                 * max A-MPDU length exponent
                 * min MPDU start spacing</code></pre></div><p>What about this? <a href="http://wiki.openwrt.org/doc/uci/multiwan">http://wiki.openwrt.org/doc/uci/multiwan</a></p><p>Thanks :-)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p257317">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">kokoliso</div>
					<div class="post-datetime">
						11 Dec 2014, 04:12					</div>
				</div>
				<div class="post-content content">
					<div class="codebox"><pre><code>        valid interface combinations:
                 * #{ managed } &lt;= 2048, #{ AP, mesh point } &lt;= 8, #{ P2P-client, P2P-GO } &lt;= 1, #{ IBSS } &lt;= 1,
                   total &lt;= 2048, #channels &lt;= 1, STA/AP BI must match</code></pre></div><p>Does it means that is possible?</p><p>MultiWan looks an interesting app, but if physically is not possible because there is only one radio, then MultiWan won&#039;t work.</p><p>Thanks :-)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p257318">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">mk24</div>
					<div class="post-datetime">
						11 Dec 2014, 05:02					</div>
				</div>
				<div class="post-content content">
					<p>It should be possible.&nbsp; You could test by setting up a couple of old routers locally (what? you don&#039;t have a box of old routers?) so you aren&#039;t dealing with weak signals.&nbsp; BI must match but nearly all AP&#039;s use the default BI of 100 (use iw dev wlanX scan to see the capabilities of the AP&#039;s).</p><p>It may have something to do with antenna selection and needing a different antenna for each AP.&nbsp; Possibly disable HT (g only mode in other words) so it isn&#039;t trying to MIMO.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p257351">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">kokoliso</div>
					<div class="post-datetime">
						11 Dec 2014, 14:22					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>mk24 wrote:</cite><blockquote><p>It should be possible.&nbsp; You could test by setting up a couple of old routers locally (what? you don&#039;t have a box of old routers?) so you aren&#039;t dealing with weak signals.</p></blockquote></div><p>Haha. I have only one old router that I am using with dd-wrt to provide WiFi at home. But, the WDR3500 connects with more than 45% of signal to the APs which I would like to use to provide me internet simultaneously.<br />The problem is that when I set up the first one, it works. But when I add the second one, only one of them get signals of 45% and the other one gets 0%. Both are attached to different interfaces: wwan1 and wwan2 both like DHCP Clients.</p><div class="quotebox"><cite>mk24 wrote:</cite><blockquote><p>BI must match but nearly all AP&#039;s use the default BI of 100 (use iw dev wlanX scan to see the capabilities of the AP&#039;s).</p></blockquote></div><p>What it means BI?</p><p>This are the two APs which I would like to connect simultaneously:<br /></p><div class="codebox"><pre><code>root@OpenWrt:/# iw dev wlan0 scan
BSS 64:70:02:97:9b:7c(on wlan0)
        TSF: 118888955924 usec (1d, 09:01:28)
        freq: 2437
        beacon interval: 100 TUs
        capability: ESS ShortPreamble ShortSlotTime (0x0421)
        signal: -82.00 dBm
        last seen: 0 ms ago
        Information elements from Probe Response frame:
        SSID: abcd123
        Supported rates: 1.0* 2.0* 5.5* 11.0* 6.0 12.0 24.0 36.0 
        DS Parameter set: channel 6
        ERP: Use_Protection
        Extended supported rates: 9.0 18.0 48.0 54.0 
BSS a0:f3:c1:33:ec:aa(on wlan0) -- associated
        TSF: 5787242972 usec (0d, 01:36:27)
        freq: 2437
        beacon interval: 100 TUs
        capability: ESS Privacy ShortPreamble ShortSlotTime (0x0431)
        signal: -80.00 dBm
        last seen: 0 ms ago
        Information elements from Probe Response frame:
        SSID: 123abcd
        Supported rates: 1.0* 2.0* 5.5* 11.0* 6.0 12.0 24.0 36.0 
        DS Parameter set: channel 6
        ERP: &lt;no flags&gt;
        Extended supported rates: 9.0 18.0 48.0 54.0 </code></pre></div><br /><div class="quotebox"><cite>mk24 wrote:</cite><blockquote><p>It may have something to do with antenna selection and needing a different antenna for each AP.&nbsp; Possibly disable HT (g only mode in other words) so it isn&#039;t trying to MIMO.</p></blockquote></div><p>I suspected that and disabled HT before to test them simultaneously.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p257370">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">mk24</div>
					<div class="post-datetime">
						11 Dec 2014, 16:32					</div>
				</div>
				<div class="post-content content">
					<p>BI is Beacon Interval, looks OK.&nbsp; You can leave HT off, the APs you are trying to use are not advertising any n capability, likely they are g-only hardware.</p>											<p class="post-edited">(Last edited by <strong>mk24</strong> on 11 Dec 2014, 18:39)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p257400">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">kokoliso</div>
					<div class="post-datetime">
						11 Dec 2014, 23:20					</div>
				</div>
				<div class="post-content content">
					<p>Then. I have a capable router, 2 APs in the same channel, the same mode (G) and with the same BI, one AP with WEP and the other one open.</p><p>This /etc/config/network:<br /></p><div class="codebox"><pre><code>config interface &#039;loopback&#039;
        option ifname &#039;lo&#039;   
        option proto &#039;static&#039;    
        option ipaddr &#039;127.0.0.1&#039; 
        option netmask &#039;255.0.0.0&#039;
                                  
config globals &#039;globals&#039;                       
        option ula_prefix &#039;fd60:8550:e8e4::/48&#039;
                                               
config interface &#039;lan&#039;       
        option force_link &#039;1&#039;
        option type &#039;bridge&#039; 
        option proto &#039;static&#039;      
        option ipaddr &#039;192.168.1.1&#039;   
        option netmask &#039;255.255.255.0&#039;
        option ip6assign &#039;60&#039;             
        option _orig_ifname &#039;eth0 wlan0-1&#039;
        option _orig_bridge &#039;true&#039;        
        option ifname &#039;eth0&#039;      
                            
config interface &#039;wan&#039;      
        option ifname &#039;eth1&#039;
        option proto &#039;dhcp&#039; 
                           
config switch                
        option name &#039;switch0&#039;
        option reset &#039;1&#039;      
        option enable_vlan &#039;1&#039;
                              
config switch_vlan             
        option device &#039;switch0&#039;
        option vlan &#039;1&#039;         
        option ports &#039;0 1 2 3 4&#039;
                                
config interface &#039;wwan&#039;    
        option proto &#039;dhcp&#039;
                           
config interface &#039;wwan2&#039;             
        option _orig_ifname &#039;wlan0-1&#039;
        option _orig_bridge &#039;false&#039;  
        option proto &#039;dhcp&#039;</code></pre></div><p>and this /etc/config/wireless<br /></p><div class="codebox"><pre><code>config wifi-device &#039;radio0&#039;
        option type &#039;mac80211&#039;
        option hwmode &#039;11g&#039;
        option path &#039;platform/ar934x_wmac&#039;
        option txpower &#039;20&#039;
        option country &#039;AR&#039;
        option channel &#039;6&#039;
        option bgscan &#039;0&#039;
        option distance &#039;2500&#039;
        option disabled &#039;0&#039;

config wifi-device &#039;radio1&#039;
        option type &#039;mac80211&#039;
        option channel &#039;36&#039;
        option hwmode &#039;11a&#039;
        option path &#039;pci0000:00/0000:00:00.0&#039;
        option htmode &#039;HT20&#039;
        option disabled &#039;1&#039;

config wifi-iface
        option network &#039;wwan&#039;
        option bssid &#039;A0:F3:C1:33:EC:AA&#039;
        option ssid &#039;123abcd&#039;
        option encryption &#039;wep-open&#039;
        option device &#039;radio0&#039;
        option mode &#039;sta&#039;
        option key1 &#039;XXXXX&#039;
        option key &#039;1&#039;

config wifi-iface
        option device &#039;radio0&#039;
        option mode &#039;sta&#039;
        option network &#039;wwan2&#039;
        option key &#039;1&#039;
        option ssid &#039;abcd123&#039;
        option bssid &#039;64:70:02:97:9B:7C&#039;
        option encryption &#039;none&#039;</code></pre></div><p>Why only I get signal from one of the APs and 0% of the other one when both are configured, but I get a good signal with any of them if only one is configured?</p><p>Another question is if will be possible to get out to internet through both of them. But shoudn&#039;t connect?</p><p>Thanks :-)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p257801">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">kokoliso</div>
					<div class="post-datetime">
						16 Dec 2014, 00:33					</div>
				</div>
				<div class="post-content content">
					<p>Still trying but I cannot get signal from both AP simultaneously.<br />Any idea?<br />Thanks :-)</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>