<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Trouble Booting Openwrt x86 and/or x64 on Qotom mini PC</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 24 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p341933">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">jax7778</div>
					<div class="post-datetime">
						23 Oct 2016, 23:09					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>I have been attempting to install openwrt x64 or x86 (64 prefered, I have 8GB of RAM) on a Qotom mini PC. <br />I originally purchased this to run pfsense on, and it installed fine, but gaming and pfsense do not agree. So I wanted to try Openwrt instead. </p><p>I installed using instructions I found&nbsp; on we.riseup. I cannot post links or I would link to it</p><p>It basically has me booting up on a linux distro live Cd (I used Lubuntu). Then used zcat to push the image to the disk. </p><p>When the machine boots, openwrt hangs at &quot;net: registered protocol family 24&quot;. Fail safe does the same. I have tried both the latest stable and the lastest trunk build, these failed at the same spot. </p><p>The Qotom PC has the following specs:</p><p>Onboard CPU:Intel Celeron Processor 3215U (2M Cache, 1.70 GHz, Broadwell) <br />Memory:SO-DIMMs Support DDR3L 1333/1600 MHz,1.35V 1 x DDR3 DIMM Memory Slot ,Max. Support up to 8GB Memory <br />Hard Disk:support SSD ( MSATA / SATA) - support HDD (2.5 inch SATA HDD ) <br />Onboard VGA:Intel HD Graphics <br />Onboard LAN:4 x Intel I211-AT- 10/100/1000 Controller <br />Audio Solution:Realtek ALC662 6-Channel HD Audio </p><p>Front-Panel Connectors <br />power on/off button <br />2 x USB 3.0 Ports <br />2 x USB 2.0 Ports <br />1 x HD Video Connector <br />1 x Serial port </p><p>Internal Connectors <br />1 x Minipcie port (for mSATA SSD) <br />1 x Minipcie port (for WIFI/BLUETOOT Module) <br />1 x DDR3L SO-DIMM Memory Slot <br />1 x SATA Port <br />1 x SATA power connector <br />1 x Automatically boot jumper </p><p>Back-Panel Connectors <br />1 xDV 12V DC input <br />HDD LED, Power LEDs <br />4 x Intel RJ-45 Ports <br />1 x Speak Out Connector <br />1 x Mic In Connector </p><p>I used a 64GB transcend msata drive, and an 8GB DDR3 Crucial RAM module.</p><p>I appreciate any help. What other information can I provide?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p342129">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">jax7778</div>
					<div class="post-datetime">
						26 Oct 2016, 02:18					</div>
				</div>
				<div class="post-content content">
					<p>Do you think I could get around this by building a custom image, is msata supported in Openwrt? I appreciate any help. Thanks in advance.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p342130">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">npkamen</div>
					<div class="post-datetime">
						26 Oct 2016, 02:57					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;d be working out why pfsense and gaming don&#039;t agree.&nbsp; IMO if you have that kind of hardware available I wouldn&#039;t be bothering with OpenWRT.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p342131">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">felipee07</div>
					<div class="post-datetime">
						26 Oct 2016, 03:22					</div>
				</div>
				<div class="post-content content">
					<p>you need post boot log.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p342135">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">jax7778</div>
					<div class="post-datetime">
						26 Oct 2016, 06:14					</div>
				</div>
				<div class="post-content content">
					<p>Felipee07<br />thanks, I would be happy to. </p><p>However, I am having some problems doing that, I have used the settings from here: </p><p>wiki.openwrt.org/doc/howto/log.essentials</p><p>and I am trying to write a log file to /var/log/messages/sys.log</p><p>but nothing ever gets written there, </p><p>it seems to delete the message after every boot. I am attempting to read the log file by booting into lubuntu so I can access the files on the system, and the Log folder is always not there, even when I create it myself and reboot.</p><p>npkamen: <br />I have done extensive troubleshooting with pfsense, over the course of a few months. I have reached out to the forums there, and found that there really is no way to get it working with multiple gaming consoles, and can connect back to each other and play together.&nbsp; </p><p>The Underlying problem is that pfsense is built on BSD packet filter, which is only able to create a symmetrical NAT. This type of NAT is completely unsupported by console gaming systems. I can resolve it for one of them by creating a static port mapping for my gaming sub net, however, this still has problems with machines communicating with each other.&nbsp; </p><p>I need a cone NAT, which simply cannot be created using packet filter (pf). This was confirmed by senior members at the forum. I could make it work perfectly for external connections, but I just cannot get it working so we can play in one party.&nbsp; &nbsp;All my setups include using upnp as well, and I have confirmed it is working, however because a symmetrical NAT creates one UDP connection per destination, not per port. It also only allows traffic back through those&nbsp; ports from destinations that those ports connected to, which will block xbox live traffic, since consoles try to communicate though the same ports that you originally connected to xbox live on. This happens regardless of your firewall rules, I have made the most open firewall rules imaginable, and it is still not able to make it thought the NAT, so it never makes to to the firewall.&nbsp; </p><p>I also have native ipv6, so I tried that, It didn&#039;t seem to work, then I went one step farther and disabled ipv4 traffic on my network. The xbox could connect to live, but the game said I had no internet connection. Then I found a post from a developer that stated that the game did not support ipv6, even though the system did. So that was out. (My roommates started saying that we needed to smash the &quot;pfchang box&quot; or whatever it was called.) </p><p>I also looked into getting Untangle, or Sophos. But those are even more enterprise oriented than pfsense, they do not have a upnp implementation at all. </p><p>I have seen posts here that indicate that openwrt uses a cone NAT, and since it is based on iptables, and iptables can create a cone NAT, I thought it would work better.</p>											<p class="post-edited">(Last edited by <strong>jax7778</strong> on 26 Oct 2016, 17:04)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p342220">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">dl12345</div>
					<div class="post-datetime">
						27 Oct 2016, 00:43					</div>
				</div>
				<div class="post-content content">
					<p>I think you should try and download the <a href="https://downloads.openwrt.org/chaos_calmer/15.05/x86/64/openwrt-15.05-x86-64-combined-ext4.img.gz">openwrt-15.05-x86-64-combined-ext4.img.gz</a> image and then just dd it to the disk. If it boots, then you can resize the rootfs afterwards quite easily (just use parted to delete the partition and recreate it with a larger size, although be sure to first convert the ext4 to an ext2, then resize partition, then use resize2fs to resize the filesystem, then add the journal with tune2fs to make it ext4 again).</p><p>This should eliminate whether your install procedure causes the problem or whether it&#039;s due to unsupported hardware.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p342221">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">dl12345</div>
					<div class="post-datetime">
						27 Oct 2016, 00:45					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>npkamen wrote:</cite><blockquote><p>I&#039;d be working out why pfsense and gaming don&#039;t agree.&nbsp; IMO if you have that kind of hardware available I wouldn&#039;t be bothering with OpenWRT.</p></blockquote></div><p>I have even more powerful hardware and still run openwrt. It&#039;s much more customizable, supports a wider range of hardware and has many, many more packages. I don&#039;t think pfsense lives up to its hype...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p342230">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">RangerZ</div>
					<div class="post-datetime">
						27 Oct 2016, 02:13					</div>
				</div>
				<div class="post-content content">
					<p>The problem is for anything in this class of hardware you need to be able to build it.&nbsp; OpenWrt is deliberately thin to fit on small flash\ram embedded platforms and one needs to load support for everything.</p><p>While pfSense may not work for this application, there are other open source distros like ipFire.&nbsp; They come with (most) all the drivers are a couple hundred MB which is trivial for even a small HDD or SSD.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p342257">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">dl12345</div>
					<div class="post-datetime">
						27 Oct 2016, 12:32					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>RangerZ wrote:</cite><blockquote><p>The problem is for anything in this class of hardware you need to be able to build it.&nbsp; OpenWrt is deliberately thin to fit on small flash\ram embedded platforms and one needs to load support for everything.</p><p>While pfSense may not work for this application, there are other open source distros like ipFire.&nbsp; They come with (most) all the drivers are a couple hundred MB which is trivial for even a small HDD or SSD.</p></blockquote></div><p>Agreed - I run a roll-my-own Openwrt that has kernel config changes more appropriate to a larger 64-bit system and use glibc. Definitely need to be able to build the system for this class of hardware. Never looked at ipfire....</p><p>Some of my bias is perhaps due to long familiarity with Openwrt and the fact that I can usually get it to do what I want it to do, so there are only marginal benefits to be gained by moving to another disto that are likely outweighed by the learning curve and reconfiguration time I&#039;d need to spend making the new system do what my Openwrt system does (hardware assist crypto, selective vpns - both openvpn and strongswan, netflow agent, remote logging into graylog, snort, decent QOS, RBL blacklists, modified bonding driver for aggregating two internet links, easy wireless configuration and VLANs, IPv6 that just works out of the box). And most of the time I edit firewall rules manually due to long experience with iptables, so a pretty iptables GUI is not much of a draw for me.</p><p>The only real gripe I have with Openwrt is way too much focus on adding new features and new kernel versions and almost no attention to the &quot;stable&quot; branch and accompanying patches, bug fixes etc. I need to watch out for and patch bugs myself (for example, the recent CVE-2016-5195). Trunk is usually so buggy and unstable that it requires constant updates, something that becomes onerous when running a heavily modified distro as frequent upstream changes need to be merged into the modified code. </p><p>Anyway, I suspect we&#039;re reaching the point of hijacking the OPs thread...:)</p><p>To the OP, just <a href="https://forum.openwrt.org/viewtopic.php?id=64603">noticed this thread</a> - maybe you want to give it a try. Looks impressive, although haven&#039;t tried it myself. With a 4.5 kernel it is likely to support many hardware configs out of the box.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p342276">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">jax7778</div>
					<div class="post-datetime">
						27 Oct 2016, 17:58					</div>
				</div>
				<div class="post-content content">
					<p>dl12345&nbsp; , That looks great! I will download and run that image and see how it goes. Thank you very much for your suggestion.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>