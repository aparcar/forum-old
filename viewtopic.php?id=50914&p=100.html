<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Optimized and feature rich trunk build for select routers</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 20 Aug 2014 and 5 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 100 of 155</div><nav><ul><li><a href="viewtopic.php%3Fid=50914&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=50914&amp;p=98.html">98</a></li><li><a href="viewtopic.php%3Fid=50914&amp;p=99.html">99</a></li><li class="pagination-current"><span>100</span></li><li><a href="viewtopic.php%3Fid=50914&amp;p=101.html">101</a></li><li><a href="viewtopic.php%3Fid=50914&amp;p=102.html">102</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=50914&amp;p=155.html">155</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p295572">
				<div class="post-metadata">
					<div class="post-num">Post #2476</div>
					<div class="post-author">written_direcon</div>
					<div class="post-datetime">
						10 Oct 2015, 22:43					</div>
				</div>
				<div class="post-content content">
					<p>@bole5: can you package your script and add it to openwrt packages at github?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p295593">
				<div class="post-metadata">
					<div class="post-num">Post #2477</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						11 Oct 2015, 03:28					</div>
				</div>
				<div class="post-content content">
					<p>Good idea, it&#039;s nice and simplistic <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>@carpenoctem</p><p>I&#039;ll have a look myself when I get the time, if there is an issue on a clean flash I will get it sorted <img src="https://forum.openwrt.org/img/smilies/tongue.png" width="15" height="15" alt="tongue" /></p>											<p class="post-edited">(Last edited by <strong>arokh</strong> on 11 Oct 2015, 03:31)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p295627">
				<div class="post-metadata">
					<div class="post-num">Post #2478</div>
					<div class="post-author">johanrd</div>
					<div class="post-datetime">
						11 Oct 2015, 15:17					</div>
				</div>
				<div class="post-content content">
					<p>Hey arokh,</p><p>you mentioned I think earlier that you had no way of determining which radio was 5GHz on C7, I&#039;ve made a crude script which you can use.</p><div class="quotebox"><blockquote><p>case $(iwinfo wlan0 info | grep &quot;5.180&quot; | wc -l) in<br />&nbsp; &nbsp;1*)<br />&nbsp; &nbsp; &nbsp;echo &quot;wlan0 is 5.18GHz&quot;<br />&nbsp; &nbsp;;;<br />&nbsp; &nbsp;*)<br />&nbsp; &nbsp; &nbsp;echo &quot;wlan0 is not 5.18GHz&quot;<br />&nbsp; &nbsp;;;<br />esac</p></blockquote></div><p>Obviously this only prints if the wlan0 is 5GHz and doesnt actually set the name accordingly.</p><p>Anyways, keep up the good work!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p295675">
				<div class="post-metadata">
					<div class="post-num">Post #2479</div>
					<div class="post-author">masta</div>
					<div class="post-datetime">
						11 Oct 2015, 21:20					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>johanrd wrote:</cite><blockquote><p>Hey arokh,</p><p>you mentioned I think earlier that you had no way of determining which radio was 5GHz on C7, I&#039;ve made a crude script which you can use.</p><div class="quotebox"><blockquote><p>case $(iwinfo wlan0 info | grep &quot;5.180&quot; | wc -l) in<br />&nbsp; &nbsp;1*)<br />&nbsp; &nbsp; &nbsp;echo &quot;wlan0 is 5.18GHz&quot;<br />&nbsp; &nbsp;;;<br />&nbsp; &nbsp;*)<br />&nbsp; &nbsp; &nbsp;echo &quot;wlan0 is not 5.18GHz&quot;<br />&nbsp; &nbsp;;;<br />esac</p></blockquote></div><p>Obviously this only prints if the wlan0 is 5GHz and doesnt actually set the name accordingly.</p><p>Anyways, keep up the good work!</p></blockquote></div><br /><p>Hi there.</p><p>What about &#039;iwinfo wlan0 freq&#039; ?? Provides more exact knowledge of the frequency.</p><div class="quotebox"><blockquote><p>iwinfo wlan0 freq | awk &#039;/\*/ {print $2,$3}&#039;</p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p295722">
				<div class="post-metadata">
					<div class="post-num">Post #2480</div>
					<div class="post-author">johanrd</div>
					<div class="post-datetime">
						12 Oct 2015, 07:36					</div>
				</div>
				<div class="post-content content">
					<p>Even better!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p295723">
				<div class="post-metadata">
					<div class="post-num">Post #2481</div>
					<div class="post-author">stangri</div>
					<div class="post-datetime">
						12 Oct 2015, 07:46					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>masta wrote:</cite><blockquote><p>Hi there.</p><p>What about &#039;iwinfo wlan0 freq&#039; ?? Provides more exact knowledge of the frequency.</p><div class="quotebox"><blockquote><p>iwinfo wlan0 freq | awk &#039;/\*/ {print $2,$3}&#039;</p></blockquote></div></blockquote></div><p>Thanks for this. Do you know if that would work in uci-defaults script?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p295726">
				<div class="post-metadata">
					<div class="post-num">Post #2482</div>
					<div class="post-author">johanrd</div>
					<div class="post-datetime">
						12 Oct 2015, 08:18					</div>
				</div>
				<div class="post-content content">
					<p>It should work fine, see my case statement. Instead of printing to screen you can issue a uci command.<br />Masta&#039;s iwinfo command is cleaner so use that.</p><p>You should be able to use a script like:<br /></p><div class="quotebox"><blockquote><p>#!/bin/sh</p><p>case $(iwinfo wlan0 freq | awk &#039;/\*/ {print $2,$3}&#039;) in<br />&nbsp; &nbsp;5.180*)<br />&nbsp; &nbsp; &nbsp;uci set wireless.@wifi-iface[0].ssid=&#039;Openwrt 5GHz&#039;<br />&nbsp; &nbsp; &nbsp;uci set wireless.@wifi-iface[1].ssid=&#039;Openwrt 2GHz&#039;<br />&nbsp; &nbsp; &nbsp;uci commit<br />&nbsp; &nbsp;;;<br />&nbsp; &nbsp;*)<br />&nbsp; &nbsp; &nbsp;uci set wireless.@wifi-iface[1].ssid=&#039;Openwrt 5GHz&#039;<br />&nbsp; &nbsp; &nbsp;uci set wireless.@wifi-iface[0].ssid=&#039;Openwrt 2GHz&#039;<br />&nbsp; &nbsp; &nbsp;uci commit<br />&nbsp; &nbsp;;;<br />esac</p></blockquote></div>											<p class="post-edited">(Last edited by <strong>johanrd</strong> on 12 Oct 2015, 09:21)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p295729">
				<div class="post-metadata">
					<div class="post-num">Post #2483</div>
					<div class="post-author">stangri</div>
					<div class="post-datetime">
						12 Oct 2015, 09:15					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>johanrd wrote:</cite><blockquote><p>It should work fine, see my case statement. Instead of printing to screen yiu can issue a uci command.<br />Masta&#039;s iwinfo command is cleaner so use that.</p></blockquote></div><p>Have you tried that in uci-defaults scripts? A lot of things outside of uci commands do not work there.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p295731">
				<div class="post-metadata">
					<div class="post-num">Post #2484</div>
					<div class="post-author">johanrd</div>
					<div class="post-datetime">
						12 Oct 2015, 09:23					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>stangri wrote:</cite><blockquote><p>Have you tried that in uci-defaults scripts? A lot of things outside of uci commands do not work there.</p></blockquote></div><p>No I havent yet, but something similar used to be in Arokh&#039;s script.<br />I have a uci script I run after I&#039;ve installed a new firmware, I&#039;ll add it there and will have a play tonight.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p295743">
				<div class="post-metadata">
					<div class="post-num">Post #2485</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						12 Oct 2015, 12:09					</div>
				</div>
				<div class="post-content content">
					<p>UCI defaults are run very early in the boot process. Anyways, it&#039;s not just about finding the 5GHz there is also routers with only one radio and even three radios. I&#039;d like to keep the build generic enough to build for other routers as well, and renaming the 5GHz isn&#039;t a huge deal <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p295745">
				<div class="post-metadata">
					<div class="post-num">Post #2486</div>
					<div class="post-author">johanrd</div>
					<div class="post-datetime">
						12 Oct 2015, 12:23					</div>
				</div>
				<div class="post-content content">
					<p>very true. Maybe more something for the post install script that at least I run, to set my own settings (dyndns, radios, dhcp etc).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p295765">
				<div class="post-metadata">
					<div class="post-num">Post #2487</div>
					<div class="post-author">stangri</div>
					<div class="post-datetime">
						12 Oct 2015, 14:54					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>arokh wrote:</cite><blockquote><p>UCI defaults are run very early in the boot process. Anyways, it&#039;s not just about finding the 5GHz there is also routers with only one radio and even three radios. I&#039;d like to keep the build generic enough to build for other routers as well, and renaming the 5GHz isn&#039;t a huge deal <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></blockquote></div><p>Completely understand, if you could help me figure out how to build my own image for personal consumption I&#039;d be much obliged tho.</p><p>I&#039;ve noticed the order of radios change depending on the firmware I&#039;m using (so between firmware-3 and firmware-4 it&#039;s completely reversed) so ideally I&#039;d like to build the uci-defaults script which will take that into account and dynamically find out radio capabilities.</p><p>If you have any suggestion on how can I do that I&#039;d be very grateful.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p295782">
				<div class="post-metadata">
					<div class="post-num">Post #2488</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						12 Oct 2015, 16:29					</div>
				</div>
				<div class="post-content content">
					<p>The buildroot is well documented and instructions for my source is on the first page. As for the radios you have suggestions on this very page.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p295839">
				<div class="post-metadata">
					<div class="post-num">Post #2489</div>
					<div class="post-author">fallconn</div>
					<div class="post-datetime">
						12 Oct 2015, 23:36					</div>
				</div>
				<div class="post-content content">
					<p>Hi @arokh,</p><p>Do you think it&#039;s worth to make a isolated vlan/network for IoT (you know, Smart TVs and all kind of insecure and very exploitable stuff) ? If so, I humbly would like to left this as a suggestion to your uci-defaults/99-arokh <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p295884">
				<div class="post-metadata">
					<div class="post-num">Post #2490</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						13 Oct 2015, 09:40					</div>
				</div>
				<div class="post-content content">
					<p>I don&#039;t think most people are that paranoid about their home network, including me.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p295962">
				<div class="post-metadata">
					<div class="post-num">Post #2491</div>
					<div class="post-author">stangri</div>
					<div class="post-datetime">
						14 Oct 2015, 03:27					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>arokh wrote:</cite><blockquote><p>The buildroot is well documented and instructions for my source is on the first page. As for the radios you have suggestions on this very page.</p></blockquote></div><p>Yeah, nothing that&#039;d work for uci-defaults tho. <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>Downloaded the gzip of the source files and I have a question. So you&#039;re running the pixelserv with uhttpd on 192.168.3.254:81 and I found the following in firewall.user:<br /></p><div class="codebox"><pre><code># Redirects HTTP traffic destined for adhosts to ourself on port 81 where we serve the transparent gif
iptables -w -t nat -A prerouting_rule -p tcp -d 192.168.3.254 --dport 80 -j REDIRECT --to-ports 81
# Make sure that traffic to the pixelserver does not get redirected to Tor
iptables -w -t nat -A prerouting_rule -p tcp -d 192.168.3.254 -j ACCEPT
# Reject anything else to the adhost
iptables -w -A forwarding_rule -d 192.168.3.254 -j REJECT</code></pre></div><p>Did I miss the network alias setup somewhere for that IP? Just these rules and pixelserv running on 192.168.3.254:81 doesn&#039;t seem to work for me -- if I just hit <a href="http://192.168.3.254">http://192.168.3.254</a> it just times out.</p><p>Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p295976">
				<div class="post-metadata">
					<div class="post-num">Post #2492</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						14 Oct 2015, 10:30					</div>
				</div>
				<div class="post-content content">
					<p>Try on a clean flash, it should work. 192.168.3.254 is a bogus address, look at the comment and the rule, it just redirects to itself, uhttpd listens on port 81.</p><p>EDIT: Works fine on clean flash.</p><p>@carpenoctem</p><p>Same for you, Tor SSID works great on clean flash. No problem with DNS lookups here with the Tor/VPN rule turned on. Make sure that your client isn&#039;t set to use an external DNS.</p>											<p class="post-edited">(Last edited by <strong>arokh</strong> on 14 Oct 2015, 23:59)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p296065">
				<div class="post-metadata">
					<div class="post-num">Post #2493</div>
					<div class="post-author">rafee</div>
					<div class="post-datetime">
						15 Oct 2015, 00:51					</div>
				</div>
				<div class="post-content content">
					<p>@arokh<br />I want you to note that the command to refresh the adblock bad hosts in root&#039;s crontab is not correct.<br />The right command, as per bole5 post, is:<br /></p><div class="codebox"><pre><code>/etc/init.d/adblock reload 2&gt;&amp;1 &gt;&gt; /tmp/adblock.log</code></pre></div><p>Thank you for all your work.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p296068">
				<div class="post-metadata">
					<div class="post-num">Post #2494</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						15 Oct 2015, 01:11					</div>
				</div>
				<div class="post-content content">
					<p>It&#039;s the same command, without redirection of stdin/stdout to a file.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p296080">
				<div class="post-metadata">
					<div class="post-num">Post #2495</div>
					<div class="post-author">stangri</div>
					<div class="post-datetime">
						15 Oct 2015, 03:56					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>arokh wrote:</cite><blockquote><p>Try on a clean flash, it should work. 192.168.3.254 is a bogus address, look at the comment and the rule, it just redirects to itself, uhttpd listens on port 81.</p></blockquote></div><p>Brainfart, forgot to restart dnsmasq -- everything is working just fine with those commands in firewall.user. <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p296092">
				<div class="post-metadata">
					<div class="post-num">Post #2496</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						15 Oct 2015, 08:33					</div>
				</div>
				<div class="post-content content">
					<p>Hitting <a href="http://192.168.3.254">http://192.168.3.254</a> should not time out even if dnsmasq is stopped. Use <a href="http://192.168.3.254/test.gif">http://192.168.3.254/test.gif</a> for a more visual confirmation.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p296098">
				<div class="post-metadata">
					<div class="post-num">Post #2497</div>
					<div class="post-author">rafee</div>
					<div class="post-datetime">
						15 Oct 2015, 09:42					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>arokh wrote:</cite><blockquote><p>It&#039;s the same command, without redirection of stdin/stdout to a file.</p></blockquote></div><p>I was not refering to the redirection, I know what is it.<br />I&#039;m refering to the parameter passed to adblock. In your crontab the command is<br /></p><div class="codebox"><pre><code>/etc/init.d/adblock refresh</code></pre></div><p>instead of the bole5&#039;s command<br /></p><div class="codebox"><pre><code>/etc/init.d/adblock reload</code></pre></div><p>I&#039;ve tried the command with parameter &quot;refresh&quot; directly in the shell and it does nothing giving me the list of possible parameters available.<br />All of those tests made after a fresh install.</p>											<p class="post-edited">(Last edited by <strong>rafee</strong> on 15 Oct 2015, 09:43)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p296099">
				<div class="post-metadata">
					<div class="post-num">Post #2498</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						15 Oct 2015, 10:34					</div>
				</div>
				<div class="post-content content">
					<p>Doh, you are right off course <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> rebuilding, thx</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p296115">
				<div class="post-metadata">
					<div class="post-num">Post #2499</div>
					<div class="post-author">stangri</div>
					<div class="post-datetime">
						15 Oct 2015, 12:39					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>arokh wrote:</cite><blockquote><p>Hitting <a href="http://192.168.3.254">http://192.168.3.254</a> should not time out even if dnsmasq is stopped. Use <a href="http://192.168.3.254/test.gif">http://192.168.3.254/test.gif</a> for a more visual confirmation.</p></blockquote></div><p>firewall that is. not my best day. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p296223">
				<div class="post-metadata">
					<div class="post-num">Post #2500</div>
					<div class="post-author">bmccoy11</div>
					<div class="post-datetime">
						16 Oct 2015, 06:30					</div>
				</div>
				<div class="post-content content">
					<p>The archer_cx folder didn&#039;t get r47187, did you forget to upload that? <img src="https://forum.openwrt.org/img/smilies/tongue.png" width="15" height="15" alt="tongue" /></p>									</div>
			</article>

			
		
						<div class="notice">
				<p>Sorry, posts 2501 to 2500 are missing from our archive.</p>
			</div>
		
		
	
	<div class="pagination"><div class="pagination-number">Page 100 of 155</div><nav><ul><li><a href="viewtopic.php%3Fid=50914&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=50914&amp;p=98.html">98</a></li><li><a href="viewtopic.php%3Fid=50914&amp;p=99.html">99</a></li><li class="pagination-current"><span>100</span></li><li><a href="viewtopic.php%3Fid=50914&amp;p=101.html">101</a></li><li><a href="viewtopic.php%3Fid=50914&amp;p=102.html">102</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=50914&amp;p=155.html">155</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0.001 -->

</body>
</html>