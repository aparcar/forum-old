<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> TL-WR740n v4.2 how to change WAN port</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 28 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p178195">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">tomaxsas</div>
					<div class="post-datetime">
						14 Sep 2012, 19:11					</div>
				</div>
				<div class="post-content content">
					<p>Hi there. I&#039;m new with Open-WRT. The reason i installed Open-WRT on this tp-link router is that it&#039;s WAN port is dead, and i need to replace it with one or the LAN ports. DD-WRT doesn&#039;t support VLAN&#039;s on atheros based routers. But Open-WRT does, yes? So as far i achieved to install latest trunk version, no GUI for know, because it cannot access the internet. So can anyone edit network file that let say LAN port number 4 would be WAN? i read documentation, but i&nbsp; cant do it, i tried to configure it, but worthless. So this is my network file:</p><p>config interface &#039;loopback&#039;<br />&nbsp; &nbsp; option ifname &#039;lo&#039;<br />&nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; option ipaddr &#039;127.0.0.1&#039;<br />&nbsp; &nbsp; option netmask &#039;255.0.0.0&#039;</p><p>config interface &#039;lan&#039;<br />&nbsp; &nbsp; option ifname &#039;eth0.1&#039;<br />&nbsp; &nbsp; option type &#039;bridge&#039;<br />&nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; option ipaddr &#039;192.168.1.1&#039;<br />&nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;</p><p>config interface &#039;wan&#039;<br />&nbsp; &nbsp; option ifname &#039;eth0.2&#039;<br />&nbsp; &nbsp; option proto &#039;dhcp&#039;</p><p>config switch<br />&nbsp; &nbsp; option name &#039;eth0&#039;<br />&nbsp; &nbsp; option reset &#039;1&#039;<br />&nbsp; &nbsp; option enable_vlan &#039;1&#039;</p><p>config switch_vlan<br />&nbsp; &nbsp; option device &#039;eth0&#039;<br />&nbsp; &nbsp; option vlan &#039;1&#039;<br />&nbsp; &nbsp; option ports &#039;0 1 2 3&#039;<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; <br />config switch_vlan<br />&nbsp; &nbsp; option device &#039;eth0&#039;<br />&nbsp; &nbsp; option vlan &#039;2&#039;<br />&nbsp; &nbsp; option ports &#039;4 5t&#039;</p><p>can anyone make it right?</p>											<p class="post-edited">(Last edited by <strong>tomaxsas</strong> on 14 Sep 2012, 19:12)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178405">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">tomaxsas</div>
					<div class="post-datetime">
						16 Sep 2012, 18:02					</div>
				</div>
				<div class="post-content content">
					<p>anyone?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178407">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						16 Sep 2012, 18:04					</div>
				</div>
				<div class="post-content content">
					<div class="codebox"><pre><code>config interface &#039;loopback&#039;
    option ifname &#039;lo&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;127.0.0.1&#039;
    option netmask &#039;255.0.0.0&#039;

config interface &#039;lan&#039;
    option ifname &#039;eth0.1&#039;
    option type &#039;bridge&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;192.168.1.1&#039;
    option netmask &#039;255.255.255.0&#039;

config interface &#039;wan&#039;
    option ifname &#039;eth0.2&#039;
    option proto &#039;dhcp&#039;

config switch
    option name &#039;eth0&#039;
    option reset &#039;1&#039;
    option enable_vlan &#039;1&#039;

config switch_vlan
    option device &#039;eth0&#039;
    option vlan &#039;1&#039;
    option ports &#039;0 1 2 3 5t&#039;
   
config switch_vlan
    option device &#039;eth0&#039;
    option vlan &#039;2&#039;
    option ports &#039;4 5t&#039;</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178413">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">tomaxsas</div>
					<div class="post-datetime">
						16 Sep 2012, 19:25					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jow wrote:</cite><blockquote><div class="codebox"><pre><code>config interface &#039;loopback&#039;
    option ifname &#039;lo&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;127.0.0.1&#039;
    option netmask &#039;255.0.0.0&#039;

config interface &#039;lan&#039;
    option ifname &#039;eth0.1&#039;
    option type &#039;bridge&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;192.168.1.1&#039;
    option netmask &#039;255.255.255.0&#039;

config interface &#039;wan&#039;
    option ifname &#039;eth0.2&#039;
    option proto &#039;dhcp&#039;

config switch
    option name &#039;eth0&#039;
    option reset &#039;1&#039;
    option enable_vlan &#039;1&#039;

config switch_vlan
    option device &#039;eth0&#039;
    option vlan &#039;1&#039;
    option ports &#039;0 1 2 3 5t&#039;
   
config switch_vlan
    option device &#039;eth0&#039;
    option vlan &#039;2&#039;
    option ports &#039;4 5t&#039;</code></pre></div></blockquote></div><p>i copied it, uploaded it via WinSCP, rebooted and nothing, i cannot access router, so i have to use failsafe to return to defaults. i read that this chip is switch capable, but i cant make it working</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178415">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						16 Sep 2012, 20:14					</div>
				</div>
				<div class="post-content content">
					<p>Maybe the CPU port is 0, not 5 on your model. Check with swconfig dev switch0 help (cpu @ x)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178424">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">tomaxsas</div>
					<div class="post-datetime">
						16 Sep 2012, 22:38					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jow wrote:</cite><blockquote><p>Maybe the CPU port is 0, not 5 on your model. Check with swconfig dev switch0 help (cpu @ x)</p></blockquote></div><p>yes, CPU @ 0 Now i tiried this:</p><p>config interface &#039;loopback&#039;<br />&nbsp; &nbsp; option ifname &#039;lo&#039;<br />&nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; option ipaddr &#039;127.0.0.1&#039;<br />&nbsp; &nbsp; option netmask &#039;255.0.0.0&#039;</p><p>config interface &#039;lan&#039;<br />&nbsp; &nbsp; option ifname &#039;eth0.1&#039;<br />&nbsp; &nbsp; option type &#039;bridge&#039;<br />&nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; option ipaddr &#039;192.168.1.1&#039;<br />&nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;</p><p>config interface &#039;wan&#039;<br />&nbsp; &nbsp; option ifname &#039;eth0.2&#039;<br />&nbsp; &nbsp; option proto &#039;dhcp&#039;</p><p>config switch<br />&nbsp; &nbsp; option name &#039;eth0&#039;<br />&nbsp; &nbsp; option reset &#039;1&#039;<br />&nbsp; &nbsp; option enable_vlan &#039;1&#039;</p><p>config switch_vlan<br />&nbsp; &nbsp; option device &#039;eth0&#039;<br />&nbsp; &nbsp; option vlan &#039;1&#039;<br />&nbsp; &nbsp; option ports &#039;0t 1 3 4 5&#039;<br />&nbsp; &nbsp;<br />config switch_vlan<br />&nbsp; &nbsp; option device &#039;eth0&#039;<br />&nbsp; &nbsp; option vlan &#039;2&#039;<br />&nbsp; &nbsp; option ports &#039;2 0t&#039;</p><p>but it doesnt worked</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178489">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">DerCaveman</div>
					<div class="post-datetime">
						17 Sep 2012, 14:18					</div>
				</div>
				<div class="post-content content">
					<p>If your router has no Auto-MDI-X the WAN port maybe &quot;crossed&quot;.<br />Maybe it works with a crossover cable?</p><p>HTH,<br />Heiko.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178659">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">tomaxsas</div>
					<div class="post-datetime">
						18 Sep 2012, 20:50					</div>
				</div>
				<div class="post-content content">
					<p>please help jow</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178897">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">tomaxsas</div>
					<div class="post-datetime">
						20 Sep 2012, 21:41					</div>
				</div>
				<div class="post-content content">
					<p>I managed to install latest version of Open-WRT via SSH, now i have Luci WEB GUI by default.But i still cant managed to configure one lan port into wan, and i start think that router is broken more than i think...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193792">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">tomaxsas</div>
					<div class="post-datetime">
						4 Mar 2013, 17:25					</div>
				</div>
				<div class="post-content content">
					<p>Hi, earlier this week i was unbricking my other router (wr741nd) and noticed a new version of openwrt is released. So i flashed new version on this router (WR740n V4.2) and crated new vLAN via GUI then changed WAN port to use newly created vlan, and&nbsp; it&#039;s working!!! <br />Steps are simple: create new vlan, disable one port on first vlan and change cpu to tagged, on second vlan change cpu to tagged and that port which is disabled in first vlan change to untagged, reboot router and it should work. Hope this would help someone.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p195648">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">dextructor</div>
					<div class="post-datetime">
						22 Mar 2013, 02:04					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>tomaxsas wrote:</cite><blockquote><p>Hi, earlier this week i was unbricking my other router (wr741nd) and noticed a new version of openwrt is released. So i flashed new version on this router (WR740n V4.2) and crated new vLAN via GUI then changed WAN port to use newly created vlan, and&nbsp; it&#039;s working!!! <br />Steps are simple: create new vlan, disable one port on first vlan and change cpu to tagged, on second vlan change cpu to tagged and that port which is disabled in first vlan change to untagged, reboot router and it should work. Hope this would help someone.</p></blockquote></div><br /><p>tomaxsas</p><p>Can you post an step by step with more details. I try but not every was clear to me. I&#039;m having the same problem. Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p210275">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">prviuredu</div>
					<div class="post-datetime">
						21 Aug 2013, 01:33					</div>
				</div>
				<div class="post-content content">
					<p>Thank you tomaxsas, confirmed success to substitute wan port to one of the LANs ports.<br />on TL-wrt740n v4.24 , it goes like this:<br />install openwrt , link <a href="http://wiki.openwrt.org/toh/tp-link/tl-wr740n">http://wiki.openwrt.org/toh/tp-link/tl-wr740n</a> ,&nbsp; find yours.<br />log to 192.168.1.1 , user root , password is empty. Dont set root password , if you wont to reset router.<br />go to &quot;network&quot; tab, under that &quot;swich&quot;. Check, if not,&nbsp; &quot;enable Vlan&quot;. <br />You will see what port is connected to computer &quot;100baseT&quot;, other should be empty. Insert internet cable in LAN port, and one icon will change to &quot;100baseT&quot; or something. That port set to off in first vlan. set cpu to taged. rest remain untaged.<br />Add second VLAN. set cpu on the second VLAN to taged, set same internet port (off in first vlan) to untaged, rest are off.<br />Save and Apply.</p><p>Go to &quot;Interface&quot; tab. On WAN network go to edit , find &quot;Physical Settings&quot; tab, change from ethernet(WAN) to VLAN interface (eth0.2)&nbsp; (decheck Ethernet, check Vlan...). Leave other settings as is. Save and apply.<br />Go to &quot;Interface&quot; tab. On LAN network go to edit , find &quot;Physical Settings&quot; tab, change from ethernet(LAN) to VLAN interface (eth0.1)&nbsp; (decheck Ethernet, check Vlan...). Leave other settings as is. Save and apply.</p><br /><p>READ this, what to do -if you do something wrong- to reset router :&nbsp; <a href="http://klseet.com/index.php/tl-wr1043nd-ver18/reset-failsafe-revert-to-factory">http://klseet.com/index.php/tl-wr1043nd … to-factory</a> , I do it many times <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>Go to system, then Reboot.&nbsp; &nbsp;</p><p>ps. in section system - led configuration , first led is &quot;WAN&quot;, change if you want, device to &quot;eth0.2&quot; to have visual on internet. (if you later forget what port you set to be WAN) </p><p>Thanx tomaxsas again, and be careful.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>