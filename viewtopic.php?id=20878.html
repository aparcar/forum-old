<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Boot directly from USB</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 16 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p90705">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">techie</div>
					<div class="post-datetime">
						1 Jul 2009, 10:48					</div>
				</div>
				<div class="post-content content">
					<p>Hi,<br />From USB storage HowTo, I realized that USB storage can be made as root filesystem. However, I am wondering if there is a way to boot directly from USB device just like what BIOS does on every PC nowsaday.<br />Thanks for advice.<br />David</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p90772">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">bifferos</div>
					<div class="post-datetime">
						2 Jul 2009, 15:52					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>techie wrote:</cite><blockquote><p>Hi,<br />From USB storage HowTo, I realized that USB storage can be made as root filesystem. However, I am wondering if there is a way to boot directly from USB device just like what BIOS does on every PC nowsaday.<br />Thanks for advice.<br />David</p></blockquote></div><p>There are basically two approaches to loading kernel direct from USB:<br />1) Add the functionality to your bootloader<br />2) Use a simple kernel image + initrd + Kexec, to find and execute a kernel from USB storage.</p><p>To do it &#039;just like what BIOS does on every PC nowsaday&#039; requires a PC BIOS with PC BIOS interrupts, and they&#039;ll be difficult to emulate on non-x86 routers, so the best bet is just make your BIOS understand one of the Linux supported file systems like ext2 and grab the kernel from some pre-determined place (e.g. /boot/bzImage).&nbsp; &nbsp;EXT2 reading code is arguably simpler than implementing your own BIOS.</p><p>cheers,<br />Biff.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p90779">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">yellowbug</div>
					<div class="post-datetime">
						2 Jul 2009, 18:47					</div>
				</div>
				<div class="post-content content">
					<p>i think there might be an other approach: Just resident the kernel+initrd in the internal flash but mount external usb-storage device as root partition.</p><p>But, i think, in both approaches, the router-box will not work independently any more -- boot process will rely on an external usb-storage device which looks not so reliable. some sophisticated scripts will be needed when exception occurred. That would be very tricky and dirty.</p><p>wish those be useful<br />Bug</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p90783">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">bifferos</div>
					<div class="post-datetime">
						2 Jul 2009, 19:25					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>yellowbug wrote:</cite><blockquote><p>i think there might be an other approach: Just resident the kernel+initrd in the internal flash but mount external usb-storage device as root partition.<br />Bug</p></blockquote></div><p>I believe that is exactly the situation that the OP was trying to avoid, hence his post.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93118">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">MrUmunhum</div>
					<div class="post-datetime">
						25 Aug 2009, 01:15					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>bifferos wrote:</cite><blockquote><div class="quotebox"><cite>techie wrote:</cite><blockquote><p>Hi,<br />From USB storage HowTo, I realized that USB storage can be made as root filesystem. However, I am wondering if there is a way to boot directly from USB device just like what BIOS does on every PC nowsaday.<br />Thanks for advice.<br />David</p></blockquote></div><p>There are basically two approaches to loading kernel direct from USB:<br />1) Add the functionality to your bootloader<br />2) Use a simple kernel image + initrd + Kexec, to find and execute a kernel from USB storage.</p><p>To do it &#039;just like what BIOS does on every PC nowsaday&#039; requires a PC BIOS with PC BIOS interrupts, and they&#039;ll be difficult to emulate on non-x86 routers, so the best bet is just make your BIOS understand one of the Linux supported file systems like ext2 and grab the kernel from some pre-determined place (e.g. /boot/bzImage).&nbsp; &nbsp;EXT2 reading code is arguably simpler than implementing your own BIOS.</p><p>cheers,<br />Biff.</p></blockquote></div><p>Where is the initrd file??&nbsp; How can I create one??</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p93382">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">richms</div>
					<div class="post-datetime">
						30 Aug 2009, 08:36					</div>
				</div>
				<div class="post-content content">
					<p>I would love a easy step by step on this so I can get my 520gc doing something useful.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p99515">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">scapi</div>
					<div class="post-datetime">
						29 Dec 2009, 22:40					</div>
				</div>
				<div class="post-content content">
					<p>I have made USB Mod into 520GC, tried DD-WRT, Oleg&#039;s Firmware, but I&#039;d like something more flexible, can someone help to make 520GC fully support OpenWRT,&nbsp; USB Boot with all needed extantions ?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>