<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> nvram package for 2.6 kernel?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 23 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p31010">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Jesster</div>
					<div class="post-datetime">
						24 Jul 2006, 19:35					</div>
				</div>
				<div class="post-content content">
					<p>I am trying to build a 2.6 kernel based image (mainly because of the ip_conntrack_sip support). I noticed that the nvram package depends on BR2_LINUX_2_4_BRCM. Is there some other package I need to be using to get nvram support on 2.6 ?</p><p>I didn&#039;t see any open tickets about this.</p><br /><p>Another possibility is to see if ip_conntrack_sip can be ported to 2.4.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p31056">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">jkusar</div>
					<div class="post-datetime">
						25 Jul 2006, 16:06					</div>
				</div>
				<div class="post-content content">
					<p>Just a thought.&nbsp; You might have better luck backporting what you need to 2.4 (or finding someone who has).&nbsp; Going from 2.4 to 2.6 for an entire platform is no small task.&nbsp; There&#039;s a lot of new packages that you would need instead of what&#039;s in openwrt.&nbsp; Not to mention the fact that, in general, 2.6 kernel images are MUCH larger than 2.4 ones.</p><p>I&#039;m not sure what that particular module that you&#039;re looking to 2.6 for does, but if it&#039;s related to iptables, I&#039;d imaging it could be ported to 2.4 since netfilter was in 2.4 as well.</p><p>--Jason</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p31057">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">mbm</div>
					<div class="post-datetime">
						25 Jul 2006, 16:24					</div>
				</div>
				<div class="post-content content">
					<p>The platforms running the 2.6 kernels aren&#039;t using nvram .. there&#039;s a /etc/config directory instead</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p31089">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Jesster</div>
					<div class="post-datetime">
						26 Jul 2006, 01:37					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>mbm wrote:</cite><blockquote><p>The platforms running the 2.6 kernels aren&#039;t using nvram .. there&#039;s a /etc/config directory instead</p></blockquote></div><p>ahh this I did not know. I&#039;ll need to load a 2.6 again to see how that works.</p><p>Can I set things like boot_wait within that directory? (I&#039;m running WRT54GL)</p><p>Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p31146">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">stephen</div>
					<div class="post-datetime">
						26 Jul 2006, 19:42					</div>
				</div>
				<div class="post-content content">
					<p>I suppose for CFE purposes there will still be *some* NVRAM entries (to identify boardrev and friends for example).<br />Only for the operation of the OS itself, newer releases will no longer rely on NVRAM... which means that boot_wait will still be there (in NVRAM).<br />Correct me if I&#039;m wrong.<br />BTW, it would be nice to know why this decision has been made: because NVRAM space is (too) limited (to 32K)? to spread flash wear?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p31203">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">florian_</div>
					<div class="post-datetime">
						28 Jul 2006, 14:46					</div>
				</div>
				<div class="post-content content">
					<p>Getting rid of nvram was decided when it came to extend openwrt to other devices and platforms that do not rely on the use of a nvram such as x86, au1000, ar7 ...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p33217">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">Anto</div>
					<div class="post-datetime">
						4 Sep 2006, 02:44					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>florian_ wrote:</cite><blockquote><p>Getting rid of nvram was decided when it came to extend openwrt to other devices and platforms that do not rely on the use of a nvram such as x86, au1000, ar7 ...</p></blockquote></div><p>Even I am using ASUS WL500GD, I think getting rid of nvram and using a config file is a very good idea. But why do we still have the flash mapping like this? </p><div class="codebox"><pre><code>0x00000000-0x00040000 : &quot;cfe&quot;
0x00040000-0x003f0000 : &quot;linux&quot;
0x000f0000-0x003f0000 : &quot;rootfs&quot;
0x003f0000-0x00400000 : &quot;nvram&quot;</code></pre></div><p>Wouldn&#039;t it better to use the space of &quot;nvram&quot; for &quot;rootfs&quot;?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p33235">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">wtzm</div>
					<div class="post-datetime">
						4 Sep 2006, 11:09					</div>
				</div>
				<div class="post-content content">
					<p>You can&#039;t use the nvram space to extend your root filesystem because the bootloader depends on some of the nvram variables.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p33603">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">keitsi</div>
					<div class="post-datetime">
						11 Sep 2006, 00:15					</div>
				</div>
				<div class="post-content content">
					<p>I understand the reasons beyond removing nvram support. However, I think there should be an nvram tool available for the latest OpenWrt&#039;s as well.</p><p>For example:<br />I&#039;m running on wrt54g with WAN port and 4 LAN ports, and I want to remap the vlans. Normally this is done by the bootloader using the nvram variables, right? Ok, even without nvram I could use robocfg or such to remap them at boot time. But then the 4 lan ports would be bridged for a few seconds when the router boots. I imagine that could cause trouble, such as 2 dhcp servers in same lan, or maybe OSPF hellos leaking out to wrong network...?</p><p>Is there/will there be an nvram tool, as a seperate package?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p34307">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">fabiand</div>
					<div class="post-datetime">
						23 Sep 2006, 15:29					</div>
				</div>
				<div class="post-content content">
					<p>Hey,</p><p>if you just want to read nvram you can try the following:<br /></p><div class="codebox"><pre><code># alias nvram_show=&quot;cat /dev/mtd/3 | egrep -i &quot;[[:alnum:]]+=&quot; | sort&quot;
or
# nvram_show() { cat /dev/mtd/3 | egrep -i &quot;[[:alnum:]]+=&quot; | sort ; } ;</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p34327">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">mbm</div>
					<div class="post-datetime">
						24 Sep 2006, 09:24					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>keitsi wrote:</cite><blockquote><p>I&#039;m running on wrt54g with WAN port and 4 LAN ports, and I want to remap the vlans. Normally this is done by the bootloader using the nvram variables, right?</p></blockquote></div><p>You can now change the vlan assignments using /etc/config/network.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p34345">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">wtzm</div>
					<div class="post-datetime">
						24 Sep 2006, 21:15					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>mbm wrote:</cite><blockquote><p>You can now change the vlan assignments using /etc/config/network.</p></blockquote></div><p>But these settings will only be used by the switch driver and the settings in nvram will be used until the switch driver is loaded. So I guess there&#039;s still a demand vor a nvram package.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p35324">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">h3sp4wn</div>
					<div class="post-datetime">
						12 Oct 2006, 23:26					</div>
				</div>
				<div class="post-content content">
					<p>maybe it is useful to have the nvram package available for the case where someone flashes 2.6 and wants to put boot wait on ?<br />(easy enough to manually edit .config and add it though I suppose)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p42093">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">Marek</div>
					<div class="post-datetime">
						5 Feb 2007, 19:35					</div>
				</div>
				<div class="post-content content">
					<p>Ok, there is no nvram anymore, but how can I enable 32MB of RAM in my ASUS WL-500gP??</p><p>BusyBox v1.4.1 (2007-02-04 21:27:39 CET) Built-in shell (ash)<br />Enter &#039;help&#039; for a list of built-in commands.</p><p>&nbsp; _______&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;________&nbsp; &nbsp; &nbsp; &nbsp; __<br /> |&nbsp; &nbsp; &nbsp; &nbsp;|.-----.-----.-----.|&nbsp; |&nbsp; |&nbsp; |.----.|&nbsp; |_<br /> |&nbsp; &nbsp;-&nbsp; &nbsp;||&nbsp; _&nbsp; |&nbsp; -__|&nbsp; &nbsp; &nbsp;||&nbsp; |&nbsp; |&nbsp; ||&nbsp; &nbsp;_||&nbsp; &nbsp;_|<br /> |_______||&nbsp; &nbsp;__|_____|__|__||________||__|&nbsp; |____|<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |__| W I R E L E S S&nbsp; &nbsp;F R E E D O M<br /> KAMIKAZE (bleeding edge, r6263) -------------------<br />&nbsp; * 10 oz Vodka&nbsp; &nbsp; &nbsp; &nbsp;Shake well with ice and strain<br />&nbsp; * 10 oz Triple sec&nbsp; mixture into 10 shot glasses.<br />&nbsp; * 10 oz lime juice&nbsp; Salute!<br /> ---------------------------------------------------<br />root@OpenWrt:~# free<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; total&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;used&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;free&nbsp; &nbsp; &nbsp; &nbsp;shared&nbsp; &nbsp; &nbsp; buffers<br />&nbsp; Mem:&nbsp; &nbsp; &nbsp; &nbsp; 13752&nbsp; &nbsp; &nbsp; &nbsp; 10092&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3660&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 216<br /> Swap:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />Total:&nbsp; &nbsp; &nbsp; &nbsp; 13752&nbsp; &nbsp; &nbsp; &nbsp; 10092&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3660<br />root@OpenWrt:~#</p><br /><p>EDIT: ofcourse I can flash ex. WR RC6 then edit proper nvrams and back to kamikaze but it isn&#039;t comfortable solution...</p>											<p class="post-edited">(Last edited by <strong>Marek</strong> on 6 Feb 2007, 10:07)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p42242">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">keitsi</div>
					<div class="post-datetime">
						7 Feb 2007, 23:30					</div>
				</div>
				<div class="post-content content">
					<p>Let&#039;s just make the nvram package available for installation via ipkg?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>