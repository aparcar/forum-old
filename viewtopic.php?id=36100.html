<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> TL-WR1043ND: WAN not connected (Cable Modem)</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 20 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p164053">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">kubuntus</div>
					<div class="post-datetime">
						10 Apr 2012, 22:56					</div>
				</div>
				<div class="post-content content">
					<p>Hi there,</p><p>Today, I flashed OpenWrt on my <a href="http://wiki.openwrt.org/toh/tp-link/tl-wr1043nd">http://wiki.openwrt.org/toh/tp-link/tl-wr1043nd</a>. And now, it looks like I am unable to configure the WAN interface correctly. In the &quot;Status&quot; page, it is marked as &quot;not connected&quot;.<br />The WAN status LED blinks the same speed as it did with the original firmware.</p><p>According to the hardware documetnation, the WAN port is eth0.0. So I reconfigured the physical sttings (originally it was set to eth0.2), but no success.<br />My internet connection is a cable modem. The provider is Kabel-BW (germany). I don&#039;t know the exact name of the used technology. But I can say it acts like a LAN connection: I can just plug the PC directly to the modem and it just works without any settings other than having a DHCP client.</p><p>These are my current settings:</p><p>Protocol&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[DHCP client]<br />Hostname to send when requesting DHCP&nbsp; &nbsp; &nbsp; [OpenWrt]</p><p>Bring up on boot&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[X]<br />Use broadcast flag&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[&nbsp; ]<br />Use default gateway&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[X]<br />Use DNS servers advertised by peer&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[X]<br />Use gateway metric&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[0]<br />Client ID to send when requesting DHCP&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; []<br />Vendor Class to send when requesting DHCP []<br />Override MAC address&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [some MAC address]<br />Override MTU&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [1500]</p><p>[X] creates a bridge over specified interface(s)<br />[&nbsp; ] Enable STP</p><p>Interface<br />[&nbsp; ] Ethernet Switch: &quot;eth0&quot;<br />[X] VLAN Interface: &quot;eth0.0&quot; (wan)<br />[&nbsp; ] VLAN Interface: &quot;eth0.1&quot; (lan)<br />[&nbsp; ] VLAN Interface: &quot;eth0.2&quot;<br />[&nbsp; ] Wireless Network: Master &quot;OpenWrt&quot; (lan)<br />[&nbsp; ] Custom Interface: []</p><p>What did I do wrong ?<br />HOWTO configure the TL-WR1043ND for cable modem ?</p><p>Thanks and Regards,<br />Markus</p>											<p class="post-edited">(Last edited by <strong>kubuntus</strong> on 10 Apr 2012, 23:13)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p164057">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						10 Apr 2012, 23:24					</div>
				</div>
				<div class="post-content content">
					<p>You need to reset your cable modem to make it accept the new router, simply plug its power cord for 30 seconds. No need to change anything on the OpenWrt default wan config.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p164072">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">kubuntus</div>
					<div class="post-datetime">
						11 Apr 2012, 01:54					</div>
				</div>
				<div class="post-content content">
					<p>It helps for a moment - but after rebooting the router, I need to reset the cable modem again.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p164167">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">j8soot</div>
					<div class="post-datetime">
						11 Apr 2012, 15:47					</div>
				</div>
				<div class="post-content content">
					<p>The WR1043ND WAN works fine with default OpenWRT settings. I suggest you reconfigure it back to the defaults.</p><p>A cable modem usually only accepts the first connection (it remembers the mac address) and only that connection will work so that is why the reboot is required when you plug in another device. This is likely why jow recommends reset your cable modem.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p164182">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">kubuntus</div>
					<div class="post-datetime">
						11 Apr 2012, 18:26					</div>
				</div>
				<div class="post-content content">
					<p>I have reset the router to default OpenWrt settings. The only changes (besides setting the password) I have made since then is two permanent leases and two hostnames for the internal DHCP.<br />And still, it works only until I reboot the router. Then I have to reset the cable modem again.<br />But the router&#039;s MAC address should not change upon reboot, right ?</p><p>I don&#039;t remember if I had to reset the cable modem when I first connected the router (with the original firmware). But I remember for sure that I could reboot the router as often as needed without having to reset the cable modem every time.</p><p>Fortunately, OpenWrt does not need as many reboots as the original firmware did. But the need of modem reset upon router reboot is very annoying.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p164322">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">j8soot</div>
					<div class="post-datetime">
						13 Apr 2012, 00:45					</div>
				</div>
				<div class="post-content content">
					<p>Rebooting the router shouldn&#039;t require the cable modem to be rebooted. It&#039;s strange that it is happening so perhaps the mac address is changing every reboot. Have you checked?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p164384">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">Orca</div>
					<div class="post-datetime">
						13 Apr 2012, 15:56					</div>
				</div>
				<div class="post-content content">
					<p>does your OpenWrt-powerd device recieve its DHCP-lease from the kablemodem?</p><p>Instead of rebooting the kabel-modem try:<br /></p><div class="codebox"><pre><code>/etc/init.d/network restart</code></pre></div><p>or try to manually get a new DHCP lease on the WAN-Port:&nbsp; </p><div class="codebox"><pre><code>udhcpc something</code></pre></div><p>see <a href="http://busybox.net/downloads/BusyBox.html">http://busybox.net/downloads/BusyBox.html</a> for command-line options.</p><p>Also, make sure you firewall does not block the DHCP protocol. That also means, you have to accept packets for destination 0.0.0.0 or 255.255.255.255 on port 68, I think.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p164409">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">kubuntus</div>
					<div class="post-datetime">
						13 Apr 2012, 19:03					</div>
				</div>
				<div class="post-content content">
					<p>For obvious reasons, I try to avoid rebooting the router as long as I can :-)</p><p>@j8soot:<br />At least, the current MAC is the same as that one on the sticker on the bottom side of the router&#039;s case. I haven&#039;t checked further so far.<br />BTW: I have seen the same MAC for the lan and the wan interface. Is that normal ? I always thought they should be different.</p><p>@Orca:<br />I&#039;ll try it on next router reboot.<br />The firewall settings are the default settings. I have just checked that DHCP is accepted:</p><p>Name Family&nbsp; &nbsp; &nbsp; Protocol Source&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Destination&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Action<br />-&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;IPv4 only&nbsp; UDP&nbsp; &nbsp; &nbsp; &nbsp;wan:0.0.0.0/0:* Device:0.0.0.0/0:68&nbsp; ACCEPT</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p164761">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">kubuntus</div>
					<div class="post-datetime">
						17 Apr 2012, 12:30					</div>
				</div>
				<div class="post-content content">
					<p>Today I had a router reboot, and this time I did not need to reset the cable modem ... strange but also good.<br />I&#039;ll get back when the need to reset the modem reappears.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p168027">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">asdf42</div>
					<div class="post-datetime">
						23 May 2012, 21:16					</div>
				</div>
				<div class="post-content content">
					<p>@kubunutus: I had exactly the same problem with my TL-WR1043ND. After some investigation I found out what is causing the problem: The WAN port and LAN ports are on the same switch. During the boot process it can happen for a few seconds that a packet which is sent from one PC is also broadcasted to the cable modem connected to the WAN port. If the router is rebooted, it can happen that a DHCP request sent from one client PC (because of the link going temporarily down) reaches the cable modem. Because of the mac filtering of the cable modem the router is then unable to get access.<br />See <a href="https://dev.openwrt.org/ticket/6819">https://dev.openwrt.org/ticket/6819</a> for details. I have configured my clients with static IPs until this problem is fixed.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>