<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> [howto] Failsafe mode with WhiteRussian RC6+</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 25 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p39387">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">forum2006</div>
					<div class="post-datetime">
						21 Dec 2006, 13:22					</div>
				</div>
				<div class="post-content content">
					<p><span class="bbu"><strong>Failsafe mode with WhiteRussian RC6+</strong></span></p><p>The new diag driver in RC6+ make it very easy to enter failsafe mode. You do not need the crappy recvudp program anymore.</p><p>1. boot into failsafe mode (confirmed to be working on a Asus WL-500g Deluxe router, should work the same way on any other Linksys (Broadcom) router)</p><p>&nbsp; &nbsp; - boot it, wait for the power LED to switch off<br />&nbsp; &nbsp; - then press any button a few times<br />&nbsp; &nbsp; - power LED goes fast-blinking (about 1 time per second)</p><p>2. set your PC you connected the router via LAN to 192.168.1.2 (gateway and DNS is not required)</p><p>3. you should be able telnet into the router at 192.168.1.1 now (telnet no username and no password)</p><p>NOTE: The root in failsafe mode is the SquashFS partition mounted in readonly mode. To switch to the normal writable root run &#039;mount_root&#039; and make any changes.</p><br /><br /><p><span class="bbu"><strong>What to do in failsafe mode?</strong></span></p><p>1. forgot/lost your password and you like to set a new one<br />&nbsp; &nbsp; passwd</p><p>2. forgot the routers IP address<br />&nbsp; &nbsp; nvram get lan_ipaddress</p><p>3. you accidentally run &#039;ipkg upgrade&#039; or filled up the flash by installing to big packages (clean the JFFS2 partition and start over)<br />&nbsp; &nbsp; mtd erase OpenWrt; reboot</p><br /><p>If you have more ideas reply here.</p>											<p class="post-edited">(Last edited by <strong>forum2006</strong> on 21 Dec 2006, 14:34)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p39390">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">forum2006</div>
					<div class="post-datetime">
						21 Dec 2006, 13:43					</div>
				</div>
				<div class="post-content content">
					<p>Open question:</p><p>Will I be able to fix wrong VLAN settings with failsafe mode? Or is still a serial console required to fix this?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p39405">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">docfear</div>
					<div class="post-datetime">
						21 Dec 2006, 16:45					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>forum2006 wrote:</cite><blockquote><p>Open question:</p><p>Will I be able to fix wrong VLAN settings with failsafe mode? Or is still a serial console required to fix this?</p></blockquote></div><p>yes you can with NVRAM</p><p>nvram set ....</p><p>doc</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p39412">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">candlerb</div>
					<div class="post-datetime">
						21 Dec 2006, 17:20					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>forum2006 wrote:</cite><blockquote><p>3. you accidentally run &#039;ipkg upgrade&#039; or filled up the flash by installing to big packages (clean the JFFS2 partition and start over)<br />&nbsp; &nbsp; mtd erase OpenWrt; reboot</p></blockquote></div><p>I thought the official way to do that was to type &#039;firstboot&#039; ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p41005">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">weebl</div>
					<div class="post-datetime">
						18 Jan 2007, 18:23					</div>
				</div>
				<div class="post-content content">
					<p>Getting this error when trying to reset the password, after i type passwd then the password twice: </p><p>root@(none):/# passwd<br />Changing password for root<br />Enter the new password (minimum of 5 characters)<br />Please use a combination of upper and lower case letters and numbers.<br />Enter new password:<br />Re-enter new password:<br />passwd: An error occurred updating the password file.</p><p>root@(none):/#</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p41006">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">forum2006</div>
					<div class="post-datetime">
						18 Jan 2007, 18:24					</div>
				</div>
				<div class="post-content content">
					<p>mount_root; passwd</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p41403">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">glenmo</div>
					<div class="post-datetime">
						24 Jan 2007, 07:11					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m running RC6 on a WRT54GL. I tried to upgrade from dd-wrt via the web interface but now I can&#039;t set the root password either in the webadmin or command line. I tried the &quot;mount_root&quot; command as above and got this response:</p><p>root@OpenWrt:/# df<br />Filesystem&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1k-blocks&nbsp; &nbsp; &nbsp; Used Available Use% Mounted on<br />/dev/root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 896&nbsp; &nbsp; &nbsp; &nbsp;896&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 100% /rom<br />none&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 7148&nbsp; &nbsp; &nbsp; &nbsp; 20&nbsp; &nbsp; &nbsp; 7128&nbsp; &nbsp;0% /tmp<br />/jffs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 896&nbsp; &nbsp; &nbsp; &nbsp;896&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 100% /</p><p>root@OpenWrt:/# mount_root; passwd<br />Unlocking linux ...<br />switching to jffs2<br />mount: Mounting /dev/mtdblock/4 on /jffs failed: Invalid argument<br />mount: Mounting /proc on /jffs/proc failed: No such file or directory<br />jffs2 not ready yet; using ramdisk</p><p>I&#039;ve reflashed with a fresh copy of OpenWRT but to no avail. I&#039;ve even reset the NVRAM. I can install the original Linksys firmware via tftp but not either dd-wrt (just hangs while copying) or OpenWRT (installs but can&#039;t set password).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p41405">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">mbm</div>
					<div class="post-datetime">
						24 Jan 2007, 07:47					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>glenmo wrote:</cite><blockquote><p>root@OpenWrt:/# mount_root; passwd<br />Unlocking linux ...<br />switching to jffs2<br />mount: Mounting /dev/mtdblock/4 on /jffs failed: Invalid argument<br />mount: Mounting /proc on /jffs/proc failed: No such file or directory<br />jffs2 not ready yet; using ramdisk</p></blockquote></div><p>These are normal messages and simply mean that firstboot hasn&#039;t been run (or hasn&#039;t been given a chance to finish) before. The actual process of formatting the flash is done in the background and a ramdisk is used as a temporary substitute until the flash is ready.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p41406">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">glenmo</div>
					<div class="post-datetime">
						24 Jan 2007, 08:16					</div>
				</div>
				<div class="post-content content">
					<p>Procedure has been (for WRT54GL) using RC6 squashfs bin file:</p><p>tftp -i 192.168.1.1 PUT openwrt-wrt54g-squashfs.bin</p><p>firmware install completes. System reboots OK. </p><p>I&#039;ve tried running firstboot many times but it just hangs with:</p><p># firstboot<br />Unlocking OpenWrt ...<br />Erasing OpenWrt ...<br />Could not erase MTD device: OpenWrt<br />mount: Mounting /dev/mtdblock/4 on /jffs failed: Invalid argument<br />creating directories... </p><p>Strange thing is if I go back to a jffs2 version of RC5 then it works ok. I can set the root password, change settings etc. but once I upgrade to RC6 it just won&#039;t let me change anything.</p>											<p class="post-edited">(Last edited by <strong>glenmo</strong> on 24 Jan 2007, 08:33)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p41479">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">Tyran</div>
					<div class="post-datetime">
						25 Jan 2007, 08:47					</div>
				</div>
				<div class="post-content content">
					<p>Hi,<br />how to get in failsafe from WAP54G v.1.0 ? </p><p>Have a wrong iptables config on my device <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /><br />so i can not enter sshd or httpd service...</p><p>only found an outdated HowTo in german:</p><p># buildroot/build_mipsel/busybox/miscutils/resetmon.c change: instead #define RESET (1&lt;&lt;6) it has to be #define RESET (1&lt;&lt;0).<br /># Than &quot;cd buildroot/build_mipsel/busybox&quot; and after that &quot;make clean&quot;</p><p>Any suggestions on how to get rid of this? already reflashed it with flash-pin trick -&gt; No effect...<br />also set the nvram to default (used FREDA firmware which includes telnetd service)..<br />but i can not delete the files on rom.. ;(</p><p>Tyran</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46962">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">mykhal</div>
					<div class="post-datetime">
						23 Apr 2007, 17:36					</div>
				</div>
				<div class="post-content content">
					<p>Thank much for the instruction. I think it would be helpful for others to add it to the WIKI, too (i was unable to register there). It took me very long time recovering my device from misconfiguration. According present info there, I was trying to enter the failsafe mode by pressing the reset button DURING the power on - power LED started blinking, so I realy thought I was in failsafe mode, but I wasn&#039;t (PWR led blinking cca 0.5 Hz, IP addres was not 192.168.1.1, but taken from NVRAM, telnet not running). Using this correct way, PRW LED is flashing faster (cca 6 Hz), IP 192.168.1.1 - real failsafe mode, telnet works. (Unfortunately, this way does not work for me every time.. second time I was unable to reach telnet.. it was successful in 2 of 7 cases, for now.)</p><p>(WL-500g deluxe)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p47509">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">julyus</div>
					<div class="post-datetime">
						2 May 2007, 12:43					</div>
				</div>
				<div class="post-content content">
					<p>Hello!<br />I have the following problem:<br />as I connect my Linksys WRT54GL v1.1 router to a power source, the power led keeps flashing, and there is doesn&#039;t want to boot up. I entered to failsafe mode, the DMZ led flashes as well, PC IP is 192.168.1.2, i can ping the router (192.168.1.1) from the PC, but no telnet, no ssh, no http available. How can I reset the firmware? I wish I could telnet to the router, but it doesn&#039;t answer. What to do now?</p><p>thanks,<br />julyus</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p47513">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">forum2006</div>
					<div class="post-datetime">
						2 May 2007, 12:56					</div>
				</div>
				<div class="post-content content">
					<p>With a serial console you have always access to the router...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p47615">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">julyus</div>
					<div class="post-datetime">
						3 May 2007, 17:49					</div>
				</div>
				<div class="post-content content">
					<p>yes, but I have no pc with serial port <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />but the problem has been solved with tftp now. thx for the response.</p>											<p class="post-edited">(Last edited by <strong>julyus</strong> on 3 May 2007, 17:52)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p47731">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">maznevh</div>
					<div class="post-datetime">
						4 May 2007, 23:31					</div>
				</div>
				<div class="post-content content">
					<p>Dear friends,<br />I definitely have had &quot;a full success&quot; upgrading my wireless router. Now it is useless piece of metal and plastic.<br />What I&#039;ve done :<br />1. Downloaded :linux_prep_wrt54g.bin, linux_upgrade_wrt54g.bin, dd-wrt.v23_micro_generic.bin and tftp.exe<br />2. Applied inux_prep_wrt54g.bin, linux_upgrade_wrt54g.bin<br />3. I used tftp.exe for applying&nbsp; dd-wrt.v23_micro_generic.bin<br />So I had a fully operational device up and running ...<br />4. Using the web based internal software I&#039;ve made a Firmware upgrade using openwrt-wrt54g-squashfs.bin file from your Newest section ...<br />Now I can rich my device on address 192.168.1.1 even using my web browser or telnetting but this is all.<br />command &quot;help&quot; in a telnet mode works, but I don&#039;t know how and what else commands I can use.<br />When I tried to choose whatever section from system console, device wants me to change password. When I tried to change the password device stopped to respond to web interface as well as to telnet, but I continue to have ping to 192.168.1.1...<br />I tried to use tftp.exe to upload other .bin file but probably tftp client on my router doesn&#039;t work too. How can I check it? How can get my router working again?</p><p>Please help me to recover my router !!!<br />I&#039;ll be very thankful if somebody can give me instructions what to do...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p48621">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">migube</div>
					<div class="post-datetime">
						17 May 2007, 15:44					</div>
				</div>
				<div class="post-content content">
					<p>hi guys,</p><p>when I&#039;m in failsafe mode how can I reboot to get back in normal mode?</p><p>a reboot gives me: register_vlan_device: ALREADY had VLAN registered</p><p>=&gt; EDIT this comes from&nbsp; ifdown wan<br />/etc/profiles<br />reboot() { ifdown wan 2&gt;&amp;1 &gt;/dev/null ; /sbin/reboot; }</p><p>root@(none):/# /sbin/reboot<br />root@(none):/#</p><p>doesn&#039;t do anything <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /> <br />Thanks</p>											<p class="post-edited">(Last edited by <strong>migube</strong> on 17 May 2007, 16:24)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p88027">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">mohnkhan</div>
					<div class="post-datetime">
						15 May 2009, 10:28					</div>
				</div>
				<div class="post-content content">
					<p>When you add a password it possibly disabled the telnet interface and enabled the SSH interface..<br />so you can try SSH to the routers ip</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p88029">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">candlerb</div>
					<div class="post-datetime">
						15 May 2009, 10:43					</div>
				</div>
				<div class="post-content content">
					<p>I don&#039;t know why you can&#039;t reboot. However if you&#039;re in failsafe mode, and you don&#039;t mind losing your customisations, you should be able to recover.</p><p>* you can wipe all your changes by typing &#039;firstboot&#039;, and then reboot or power cycle. This should take you back to the state when you first installed OpenWrt.</p><p>* or, you can use wget and mtd to write a completely new image.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p89805">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">danisaacs</div>
					<div class="post-datetime">
						13 Jun 2009, 01:32					</div>
				</div>
				<div class="post-content content">
					<p>I have a wrtg54gl, and when it powers on the power light never goes off, as described in the first step above.&nbsp; Don&#039;t notice anything happening when I hit the reset button.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p134864">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">mike brown</div>
					<div class="post-datetime">
						7 May 2011, 21:55					</div>
				</div>
				<div class="post-content content">
					<p>i have used to install my motherboard cd, but y mouth speaker is unable to use</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>