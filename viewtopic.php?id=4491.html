<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> openwrt pre-RC5: AP failure in bridge mode</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 22 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p21069">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">mykle</div>
					<div class="post-datetime">
						18 Feb 2006, 19:16					</div>
				</div>
				<div class="post-content content">
					<p>hi,</p><p>we&#039;ve been running whiterussion pre-rc5 for ten<br />days now, and while it solved our previous problem<br />(thanks!) it&#039;s also given us a new one.</p><p>specifically: the wireless access point seems to <br />disappear from the aether anywhere from 9<br />to 24 hours after a reboot. the wrt54g is still<br />running and i can ssh in from the wired interface,<br />but there&#039;s no ESSID announced on the wireless,<br />so the whole wireless network goes down.<br />rebooting solves the problem, so we&#039;ve been<br />doing that a lot. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>our configuration is: wrt54g v2, openwrt<br />whiterussion pre-RC5, running as a bridge<br />(not routing), using the default bridge between<br />the LAN ports and the WIFI interface.&nbsp; we&#039;re<br />hooked to an external 12db unipole antenna,<br />running at default power levels.</p><p>i&#039;ve been groping around the system looking<br />for clues ... i&#039;m not sure exactly how to diagnose this. <br />i tried bringing eth1 down and up, both with<br />ifconfig and ifdown/ifup; i tried &#039;wifi down; wifi up&#039;<br />(not sure if that&#039;s valid arguments for &#039;wifi&#039;)<br />and got lots of complaints about /var/run/wifi.pid<br />not existing but nothing else.&nbsp; (i never see that<br />file, even when the machine is working.)</p><p>i tried cleaning up my NVRAM with the nvram_clean<br />script, and reinstalled a pristine image of the<br />same firmware, but the problem remains.</p><p>basically, there&#039;s nothing in syslog, the interfaces<br />are listed as up ... software doesn&#039;t seem to <br />find a problem.&nbsp; /proc/net/wireless tells me the<br />same info whether the wireless is working or not.</p><p>i suppose it could be a hardware issue, but a warm<br />reboot always clears it up. is there a way to reinitialize<br />the wireless hardware without the reboot?</p><p>one thing i noticed in /proc/net/wl0 is that after<br />the last hang it showed 23 resets.&nbsp; is that normal?</p><p>any advice would be appreciated.&nbsp; included below<br />is my wireless config, in case that helps.</p><p>thanks,</p><p>-mykle-</p><p>--------------------</p><p>aa0=3<br />ag0=255<br />boardflags2=0<br />boardflags=0x0188<br />boardnum=42<br />boardrev=0x10<br />boardtype=0x0101<br />boot_ver=v2.3<br />boot_wait=on<br />ccode=0<br />cctl=0<br />clkfreq=200<br />dl_ram_addr=a0001000<br />et0macaddr=00:0F:66:2C:A7:A6<br />et0mdcport=0<br />et0phyaddr=30<br />gpio2=adm_eecs<br />gpio3=adm_eesk<br />gpio5=adm_eedi<br />gpio6=adm_rc<br />il0macaddr=00:0f:66:2c:a7:a8<br />lan_dns=23.23.23.253<br />lan_gateway=23.23.23.1<br />lan_ifname=br0<br />lan_ifnames=vlan0 eth1 eth2<br />lan_ipaddr=23.23.23.246<br />lan_netmask=255.255.255.0<br />lan_proto=static<br />language=en<br />os_flash_addr=bfc40000<br />os_ram_addr=80001000<br />pa0b0=0x170c<br />pa0b1=0xfa24<br />pa0b2=0xfe70<br />pa0itssit=62<br />pa0maxpwr=0x48<br />pmon_ver=CFE 3.51.21.0<br />scratch=a0180000<br />sdram_config=0x0032<br />sdram_init=0x0000<br />sdram_ncdl=0x11c<br />sdram_refresh=0x0000<br />sromrev=2<br />vlan0hwname=et0<br />vlan0ports=1 2 3 4 5*<br />vlan1hwname=et0<br />vlan1ports=0 5<br />wan_device=vlan1<br />wan_hostname=catbox2<br />wan_ifname=vlan1<br />wan_proto=none<br />watchdog=5000<br />wl0_akm=none<br />wl0_channel=8<br />wl0_closed=0<br />wl0_ifname=eth1<br />wl0_infra=1<br />wl0_mode=ap<br />wl0_radio=1<br />wl0_ssid=Moronic Cat Head<br />wl0_wep=disabled<br />wl0gpio2=0<br />wl0gpio3=0<br />wl0id=0x4320</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p21557">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">mykle</div>
					<div class="post-datetime">
						25 Feb 2006, 19:53					</div>
				</div>
				<div class="post-content content">
					<p>FYI, today i managed for the first time to restart the wireless without rebooting.<br />i&#039;m not quite sure what the exact steps were, but it was something like this:</p><p>ifdown eth0<br />iwconfig eth1 commit&nbsp; &nbsp;# returns an error ...<br />ifup eth0</p><p>it might also be that some twiddling of the iwconfig settings is necessary,<br />along with or instead of the commit command.&nbsp; all i know is, a simple<br />ifdown &amp; ifup doesn&#039;t fix it.</p><p>my theory is that maybe the ifup command triggers some hardware reset<br />if it notices that the wireless settings have been touched ... ?&nbsp; i&#039;d<br />like to know how to trigger that reset directly, and what exactly it&#039;s doing.</p><p>i don&#039;t know why &#039;iwconfig commit&#039; doesn&#039;t work; it returns a <br />cryptic error message, that the internet forums say could<br />mean either &quot;feature not implemented&quot; or &quot;syntax error&quot; ...</p><p>are there any other userspace tools, or entries in /proc,<br />to look at the state of the wireless chips and try to tackle<br />this bug?</p><p>-m-</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>