<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> OpenVPN server on ArcherC7, client connected but can&#039;t ping LAN hosts</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 27 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p357955">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">RadBrad87</div>
					<div class="post-datetime">
						7 May 2017, 09:09					</div>
				</div>
				<div class="post-content content">
					<p>I followed the beginner&#039;s OpenVPN guide on this site.</p><p>I am able to successfully establish a connection from my client (Android phone, cellular connection) to the OpenVPN server running on my Archer C7. I can ping my C7&#039;s IP, but I cannot ping any hosts on the LAN behind the C7.</p><p>Any idea how to debug this? Thanks in advance!</p><div class="codebox"><pre><code>root@c7main:~# cat /tmp/openvpn.log
Sat May  6 22:34:39 2017 OpenVPN 2.3.6 mips-openwrt-linux-gnu [SSL (OpenSSL)] [LZO] [EPOLL] [MH] [IPv6] built on Jan 31 2016
Sat May  6 22:34:39 2017 library versions: OpenSSL 1.0.2g  1 Mar 2016, LZO 2.08
Sat May  6 22:34:39 2017 Diffie-Hellman initialized with 2048 bit key
Sat May  6 22:34:39 2017 Socket Buffers: R=[163840-&gt;131072] S=[163840-&gt;131072]
Sat May  6 22:34:39 2017 TUN/TAP device tun0 opened
Sat May  6 22:34:39 2017 TUN/TAP TX queue length set to 100
Sat May  6 22:34:39 2017 do_ifconfig, tt-&gt;ipv6=0, tt-&gt;did_ifconfig_ipv6_setup=0
Sat May  6 22:34:39 2017 /sbin/ifconfig tun0 10.8.0.1 pointopoint 10.8.0.2 mtu 1500
Sat May  6 22:34:39 2017 /sbin/route add -net 10.8.0.0 netmask 255.255.255.0 gw 10.8.0.2
Sat May  6 22:34:39 2017 GID set to nogroup
Sat May  6 22:34:39 2017 UID set to nobody
Sat May  6 22:34:39 2017 UDPv4 link local (bound): [undef]
Sat May  6 22:34:39 2017 UDPv4 link remote: [undef]
Sat May  6 22:34:39 2017 MULTI: multi_init called, r=256 v=256
Sat May  6 22:34:39 2017 IFCONFIG POOL: base=10.8.0.4 size=62, ipv6=0
Sat May  6 22:34:39 2017 Initialization Sequence Completed
Sat May  6 22:35:58 2017 208.54.4.192:20887 TLS: Initial packet from [AF_INET]208.54.4.192:20887, sid=5b4b28c1 819058ea
Sat May  6 22:35:59 2017 208.54.4.192:20887 VERIFY OK: depth=1, C=US, ST=CA, L=SanDiego, O=RadBradInc, OU=Home, CN=RadBradInc CA, name=EasyRSA, emailAddress=bradpeddigrew@gmail.com
Sat May  6 22:35:59 2017 208.54.4.192:20887 VERIFY OK: depth=0, C=US, ST=CA, L=SanDiego, O=RadBradInc, OU=Home, CN=radbrad, name=EasyRSA, emailAddress=bradpeddigrew@gmail.com
Sat May  6 22:35:59 2017 208.54.4.192:20887 Data Channel Encrypt: Cipher &#039;BF-CBC&#039; initialized with 128 bit key
Sat May  6 22:35:59 2017 208.54.4.192:20887 Data Channel Encrypt: Using 160 bit message hash &#039;SHA1&#039; for HMAC authentication
Sat May  6 22:35:59 2017 208.54.4.192:20887 NOTE: --mute triggered...
Sat May  6 22:36:00 2017 208.54.4.192:20887 3 variation(s) on previous 5 message(s) suppressed by --mute
Sat May  6 22:36:00 2017 208.54.4.192:20887 [radbrad] Peer Connection Initiated with [AF_INET]208.54.4.192:20887
Sat May  6 22:36:00 2017 radbrad/208.54.4.192:20887 MULTI_sva: pool returned IPv4=10.8.0.6, IPv6=(Not enabled)
Sat May  6 22:36:00 2017 radbrad/208.54.4.192:20887 MULTI: Learn: 10.8.0.6 -&gt; radbrad/208.54.4.192:20887
Sat May  6 22:36:00 2017 radbrad/208.54.4.192:20887 MULTI: primary virtual IP for radbrad/208.54.4.192:20887: 10.8.0.6
Sat May  6 22:36:01 2017 radbrad/208.54.4.192:20887 PUSH: Received control message: &#039;PUSH_REQUEST&#039;
Sat May  6 22:36:01 2017 radbrad/208.54.4.192:20887 send_push_reply(): safe_cap=940
Sat May  6 22:36:01 2017 radbrad/208.54.4.192:20887 SENT CONTROL [radbrad]: &#039;PUSH_REPLY,comp-lzo yes,persist-key,persist-tun,topology subnet,route-gateway dhcp,route 10.10.1.0 255.255.255.0,route 10.8.0.0 255.255.255.0,topology net30,ping 10,ping-restart 120,ifconfig 10.8.0.6 10.8.0.5&#039; (status=1)
Sat May  6 22:46:46 2017 radbrad/208.54.4.192:20887 TLS: new session incoming connection from [AF_INET]208.54.4.192:20887
Sat May  6 22:46:47 2017 radbrad/208.54.4.192:20887 VERIFY OK: depth=1, C=US, ST=CA, L=SanDiego, O=RadBradInc, OU=Home, CN=RadBradInc CA, name=EasyRSA, emailAddress=bradpeddigrew@gmail.com
Sat May  6 22:46:47 2017 radbrad/208.54.4.192:20887 VERIFY OK: depth=0, C=US, ST=CA, L=SanDiego, O=RadBradInc, OU=Home, CN=radbrad, name=EasyRSA, emailAddress=bradpeddigrew@gmail.com
Sat May  6 22:46:48 2017 radbrad/208.54.4.192:20887 Data Channel Encrypt: Cipher &#039;BF-CBC&#039; initialized with 128 bit key
Sat May  6 22:46:48 2017 radbrad/208.54.4.192:20887 Data Channel Encrypt: Using 160 bit message hash &#039;SHA1&#039; for HMAC authentication
Sat May  6 22:46:48 2017 radbrad/208.54.4.192:20887 NOTE: --mute triggered...
Sat May  6 22:46:49 2017 radbrad/208.54.4.192:20887 5 variation(s) on previous 5 message(s) suppressed by --mute
Sat May  6 22:46:49 2017 radbrad/208.54.4.192:20887 PUSH: Received control message: &#039;PUSH_REQUEST&#039;
Sat May  6 22:46:49 2017 radbrad/208.54.4.192:20887 send_push_reply(): safe_cap=940
Sat May  6 22:46:49 2017 radbrad/208.54.4.192:20887 SENT CONTROL [radbrad]: &#039;PUSH_REPLY,comp-lzo yes,persist-key,persist-tun,topology subnet,route-gateway dhcp,route 10.10.1.0 255.255.255.0,route 10.8.0.0 255.255.255.0,topology net30,ping 10,ping-restart 120,ifconfig 10.8.0.6 10.8.0.5&#039; (status=1)
root@c7main:~#</code></pre></div><div class="codebox"><pre><code>root@c7main:~# cat /etc/config/network

config interface &#039;loopback&#039;
        option ifname &#039;lo&#039;
        option proto &#039;static&#039;
        option ipaddr &#039;127.0.0.1&#039;
        option netmask &#039;255.0.0.0&#039;

config globals &#039;globals&#039;
        option ula_prefix &#039;fd33:7a1a:afe5::/48&#039;

config interface &#039;lan&#039;
        option ifname &#039;eth1&#039;
        option force_link &#039;1&#039;
        option type &#039;bridge&#039;
        option proto &#039;static&#039;
        option netmask &#039;255.255.255.0&#039;
        option ip6assign &#039;60&#039;
        option ipaddr &#039;10.10.1.1&#039;

config interface &#039;wan&#039;
        option ifname &#039;eth0&#039;
        option proto &#039;dhcp&#039;

config interface &#039;wan6&#039;
        option ifname &#039;eth0&#039;
        option proto &#039;dhcpv6&#039;

config switch
        option name &#039;switch0&#039;
        option reset &#039;1&#039;
        option enable_vlan &#039;1&#039;

config switch_vlan
        option device &#039;switch0&#039;
        option vlan &#039;1&#039;
        option ports &#039;0 2 3 4 5&#039;

config switch_vlan
        option device &#039;switch0&#039;
        option vlan &#039;2&#039;
        option ports &#039;1 6&#039;

config interface &#039;tun0&#039;
        option proto &#039;none&#039;
        option ifname &#039;tun0&#039;

config interface &#039;vpn0&#039;
        option ifname &#039;tun0&#039;
        option proto &#039;none&#039;
        option auto &#039;1&#039;

root@c7main:~#</code></pre></div><div class="codebox"><pre><code>root@c7main:~# cat /etc/config/firewall

config defaults
        option syn_flood &#039;1&#039;
        option input &#039;ACCEPT&#039;
        option output &#039;ACCEPT&#039;
        option forward &#039;REJECT&#039;

config zone
        option name &#039;lan&#039;
        option input &#039;ACCEPT&#039;
        option output &#039;ACCEPT&#039;
        option forward &#039;ACCEPT&#039;
        option network &#039;lan&#039;

config zone
        option name &#039;wan&#039;
        option input &#039;REJECT&#039;
        option output &#039;ACCEPT&#039;
        option forward &#039;REJECT&#039;
        option masq &#039;1&#039;
        option mtu_fix &#039;1&#039;
        option network &#039;wan wan6 tun0&#039;

config forwarding
        option src &#039;lan&#039;
        option dest &#039;wan&#039;

config rule
        option name &#039;Allow-DHCP-Renew&#039;
        option src &#039;wan&#039;
        option proto &#039;udp&#039;
        option dest_port &#039;68&#039;
        option target &#039;ACCEPT&#039;
        option family &#039;ipv4&#039;

config rule
        option name &#039;Allow-Ping&#039;
        option src &#039;wan&#039;
        option proto &#039;icmp&#039;
        option icmp_type &#039;echo-request&#039;
        option family &#039;ipv4&#039;
        option target &#039;ACCEPT&#039;

config rule
        option name &#039;Allow-IGMP&#039;
        option src &#039;wan&#039;
        option proto &#039;igmp&#039;
        option family &#039;ipv4&#039;
        option target &#039;ACCEPT&#039;

config rule
        option name &#039;Allow-DHCPv6&#039;
        option src &#039;wan&#039;
        option proto &#039;udp&#039;
        option src_ip &#039;fe80::/10&#039;
        option src_port &#039;547&#039;
        option dest_ip &#039;fe80::/10&#039;
        option dest_port &#039;546&#039;
        option family &#039;ipv6&#039;
        option target &#039;ACCEPT&#039;

config rule
        option name &#039;Allow-MLD&#039;
        option src &#039;wan&#039;
        option proto &#039;icmp&#039;
        option src_ip &#039;fe80::/10&#039;
        list icmp_type &#039;130/0&#039;
        list icmp_type &#039;131/0&#039;
        list icmp_type &#039;132/0&#039;
        list icmp_type &#039;143/0&#039;
        option family &#039;ipv6&#039;
        option target &#039;ACCEPT&#039;

config rule
        option name &#039;Allow-ICMPv6-Input&#039;
        option src &#039;wan&#039;
        option proto &#039;icmp&#039;
        list icmp_type &#039;echo-request&#039;
        list icmp_type &#039;echo-reply&#039;
        list icmp_type &#039;destination-unreachable&#039;
        list icmp_type &#039;packet-too-big&#039;
        list icmp_type &#039;time-exceeded&#039;
        list icmp_type &#039;bad-header&#039;
        list icmp_type &#039;unknown-header-type&#039;
        list icmp_type &#039;router-solicitation&#039;
        list icmp_type &#039;neighbour-solicitation&#039;
        list icmp_type &#039;router-advertisement&#039;
        list icmp_type &#039;neighbour-advertisement&#039;
        option limit &#039;1000/sec&#039;
        option family &#039;ipv6&#039;
        option target &#039;ACCEPT&#039;

config rule
        option name &#039;Allow-ICMPv6-Forward&#039;
        option src &#039;wan&#039;
        option dest &#039;*&#039;
        option proto &#039;icmp&#039;
        list icmp_type &#039;echo-request&#039;
        list icmp_type &#039;echo-reply&#039;
        list icmp_type &#039;destination-unreachable&#039;
        list icmp_type &#039;packet-too-big&#039;
        list icmp_type &#039;time-exceeded&#039;
        list icmp_type &#039;bad-header&#039;
        list icmp_type &#039;unknown-header-type&#039;
        option limit &#039;1000/sec&#039;
        option family &#039;ipv6&#039;
        option target &#039;ACCEPT&#039;

config include
        option path &#039;/etc/firewall.user&#039;

config rule
        option src &#039;wan&#039;
        option dest &#039;lan&#039;
        option proto &#039;esp&#039;
        option target &#039;ACCEPT&#039;

config rule
        option src &#039;wan&#039;
        option dest &#039;lan&#039;
        option dest_port &#039;500&#039;
        option proto &#039;udp&#039;
        option target &#039;ACCEPT&#039;

config redirect
        option target &#039;DNAT&#039;
        option src &#039;wan&#039;
        option dest &#039;lan&#039;
        option proto &#039;tcp udp&#039;
        option src_dport &#039;56969&#039;
        option dest_port &#039;56969&#039;
        option dest_ip &#039;10.10.1.42&#039;
        option name &#039;qbit&#039;

config rule
        option name &#039;Allow-OpenVPN-Inbound&#039;
        option target &#039;ACCEPT&#039;
        option src &#039;wan&#039;
        option proto &#039;udp&#039;
        option dest_port &#039;1194&#039;

config zone
        option name &#039;vpn&#039;
        option input &#039;ACCEPT&#039;
        option output &#039;ACCEPT&#039;
        option masq &#039;1&#039;
        option network &#039;vpn0&#039;
        option forward &#039;REJECT&#039;

config redirect
        option target &#039;DNAT&#039;
        option src &#039;wan&#039;
        option proto &#039;udp&#039;
        option src_dport &#039;1194&#039;
        option dest_port &#039;1194&#039;
        option name &#039;radVPN&#039;
        option dest &#039;vpn&#039;
        option dest_ip &#039;10.8.0.1&#039;
        option enabled &#039;0&#039;

config rule
        option target &#039;ACCEPT&#039;
        option src &#039;*&#039;
        option dest_port &#039;1194&#039;
        option name &#039;radVPN1194&#039;
        option proto &#039;udp&#039;

config rule
        option target &#039;ACCEPT&#039;
        option proto &#039;tcp udp&#039;
        option name &#039;radVPN80&#039;
        option src &#039;*&#039;
        option dest_port &#039;80&#039;

config rule
        option target &#039;ACCEPT&#039;
        option proto &#039;tcp udp&#039;
        option name &#039;radVPN22&#039;
        option src &#039;*&#039;
        option dest_port &#039;22&#039;

config rule
        option enabled &#039;1&#039;
        option target &#039;ACCEPT&#039;
        option proto &#039;tcp udp&#039;
        option name &#039;radVPN24&#039;
        option src &#039;*&#039;
        option dest_port &#039;24&#039;

config forwarding
        option dest &#039;lan&#039;
        option src &#039;vpn&#039;

config forwarding
        option dest &#039;wan&#039;
        option src &#039;vpn&#039;

config forwarding
        option dest &#039;vpn&#039;
        option src &#039;lan&#039;</code></pre></div><div class="codebox"><pre><code>root@c7main:~# cat /etc/config/openvpn

config openvpn &#039;myvpn&#039;
        option enabled &#039;1&#039;
        option dev &#039;tun&#039;
        option port &#039;1194&#039;
        option proto &#039;udp&#039;
        option comp_lzo &#039;yes&#039;
        option status &#039;/var/log/openvpn_status.log&#039;
        option log &#039;/tmp/openvpn.log&#039;
        option verb &#039;3&#039;
        option mute &#039;5&#039;
        option keepalive &#039;10 120&#039;
        option persist_key &#039;1&#039;
        option persist_tun &#039;1&#039;
        option user &#039;nobody&#039;
        option group &#039;nogroup&#039;
        option ca &#039;/etc/easy-rsa/keys/ca.crt&#039;
        option cert &#039;/etc/easy-rsa/keys/c7.crt&#039;
        option key &#039;/etc/easy-rsa/keys/c7.key&#039;
        option dh &#039;/etc/easy-rsa/keys/dh2048.pem&#039;
        option mode &#039;server&#039;
        option tls_server &#039;1&#039;
        option server &#039;10.8.0.0 255.255.255.0&#039;
        option route_gateway &#039;dhcp&#039;
        option client_to_client &#039;1&#039;
        list push &#039;comp-lzo yes&#039;
        list push &#039;persist-key&#039;
        list push &#039;persist-tun&#039;
        #list push &#039;user nobody&#039;
        #list push &#039;user nogroup&#039;
        list push &#039;topology subnet&#039;
        list push &#039;route-gateway dhcp&#039;
        list push &#039;route 10.10.1.0 255.255.255.0&#039;
        #list push &#039;dhcp-option DNS 107.170.95.180&#039;
        #list push &#039;dhcp-option DNS 50.116.40.226&#039;
        option tun_ipv6 &#039;0&#039;

root@c7main:~#</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p358470">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">dnkru</div>
					<div class="post-datetime">
						16 May 2017, 16:03					</div>
				</div>
				<div class="post-content content">
					<p>what tells:<br />route -n<br />iptables -L -vn<br />iptables -t nat -L -vn<br />iptables -t mangle -L -vn<br />cat /proc/sys/net/ipv4/ip_forward<br />?</p>											<p class="post-edited">(Last edited by <strong>dnkru</strong> on 16 May 2017, 16:04)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p358858">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">RadBrad87</div>
					<div class="post-datetime">
						23 May 2017, 02:19					</div>
				</div>
				<div class="post-content content">
					<p>Sorry, took me a while to get back this project. Here&#039;s the output:</p><br /><div class="codebox"><pre><code>root@c7main:~# route -n
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
0.0.0.0         66.75.240.1     0.0.0.0         UG    0      0        0 eth0
10.8.0.0        10.8.0.2        255.255.255.0   UG    0      0        0 tun0
10.8.0.2        0.0.0.0         255.255.255.255 UH    0      0        0 tun0
10.10.1.0       0.0.0.0         255.255.255.0   U     0      0        0 br-lan
66.75.240.0     0.0.0.0         255.255.240.0   U     0      0        0 eth0
66.75.240.1     0.0.0.0         255.255.255.255 UH    0      0        0 eth0
root@c7main:~#</code></pre></div><br /><div class="codebox"><pre><code>root@c7main:~# iptables -L -vn
Chain INPUT (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination
 4972  478K delegate_input  all  --  *      *       0.0.0.0/0            0.0.0.0/0

Chain FORWARD (policy DROP 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination
1005K  857M delegate_forward  all  --  *      *       0.0.0.0/0            0.0.0.0/0

Chain OUTPUT (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination
 4431  798K delegate_output  all  --  *      *       0.0.0.0/0            0.0.0.0/0

Chain delegate_forward (1 references)
 pkts bytes target     prot opt in     out     source               destination
1005K  857M forwarding_rule  all  --  *      *       0.0.0.0/0            0.0.0.0/0            /* user chain for forwarding */
1005K  857M ACCEPT     all  --  *      *       0.0.0.0/0            0.0.0.0/0            ctstate RELATED,ESTABLISHED
  324 22738 zone_lan_forward  all  --  br-lan *       0.0.0.0/0            0.0.0.0/0
    0     0 zone_wan_forward  all  --  eth0   *       0.0.0.0/0            0.0.0.0/0
    2   168 zone_wan_forward  all  --  tun0   *       0.0.0.0/0            0.0.0.0/0
    0     0 zone_wan_forward  all  --  tun1   *       0.0.0.0/0            0.0.0.0/0
    2   168 zone_vpn_forward  all  --  tun0   *       0.0.0.0/0            0.0.0.0/0
    0     0 reject     all  --  *      *       0.0.0.0/0            0.0.0.0/0

Chain delegate_input (1 references)
 pkts bytes target     prot opt in     out     source               destination
  852 65848 ACCEPT     all  --  lo     *       0.0.0.0/0            0.0.0.0/0
 4120  412K input_rule  all  --  *      *       0.0.0.0/0            0.0.0.0/0            /* user chain for input */
 2565  274K ACCEPT     all  --  *      *       0.0.0.0/0            0.0.0.0/0            ctstate RELATED,ESTABLISHED
  395 20544 syn_flood  tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp flags:0x17/0x02
   26 16456 ACCEPT     icmp --  *      *       0.0.0.0/0            0.0.0.0/0            icmptype 8 /* Allow-Ping */
  758 60803 zone_lan_input  all  --  br-lan *       0.0.0.0/0            0.0.0.0/0
  771 60686 zone_wan_input  all  --  eth0   *       0.0.0.0/0            0.0.0.0/0
    0     0 zone_wan_input  all  --  tun0   *       0.0.0.0/0            0.0.0.0/0
    0     0 zone_wan_input  all  --  tun1   *       0.0.0.0/0            0.0.0.0/0
    0     0 zone_vpn_input  all  --  tun0   *       0.0.0.0/0            0.0.0.0/0

Chain delegate_output (1 references)
 pkts bytes target     prot opt in     out     source               destination
  852 65848 ACCEPT     all  --  *      lo      0.0.0.0/0            0.0.0.0/0
 3579  732K output_rule  all  --  *      *       0.0.0.0/0            0.0.0.0/0            /* user chain for output */
 3346  698K ACCEPT     all  --  *      *       0.0.0.0/0            0.0.0.0/0            ctstate RELATED,ESTABLISHED
   23  6984 zone_lan_output  all  --  *      br-lan  0.0.0.0/0            0.0.0.0/0
  210 27504 zone_wan_output  all  --  *      eth0    0.0.0.0/0            0.0.0.0/0
    0     0 zone_wan_output  all  --  *      tun0    0.0.0.0/0            0.0.0.0/0
    0     0 zone_wan_output  all  --  *      tun1    0.0.0.0/0            0.0.0.0/0
    0     0 zone_vpn_output  all  --  *      tun0    0.0.0.0/0            0.0.0.0/0

Chain forwarding_VPN_FW_rule (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain forwarding_lan_rule (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain forwarding_rule (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain forwarding_vpn_rule (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain forwarding_wan_rule (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain input_VPN_FW_rule (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain input_lan_rule (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain input_rule (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain input_vpn_rule (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain input_wan_rule (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain output_VPN_FW_rule (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain output_lan_rule (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain output_rule (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain output_vpn_rule (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain output_wan_rule (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain reject (7 references)
 pkts bytes target     prot opt in     out     source               destination
  410 21591 REJECT     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            reject-with tcp-reset
  356 38729 REJECT     all  --  *      *       0.0.0.0/0            0.0.0.0/0            reject-with icmp-port-unreachable

Chain syn_flood (1 references)
 pkts bytes target     prot opt in     out     source               destination
  395 20544 RETURN     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp flags:0x17/0x02 limit: avg 25/sec burst 50
    0     0 DROP       all  --  *      *       0.0.0.0/0            0.0.0.0/0

Chain zone_VPN_FW_dest_ACCEPT (2 references)
 pkts bytes target     prot opt in     out     source               destination

Chain zone_VPN_FW_dest_REJECT (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain zone_VPN_FW_forward (0 references)
 pkts bytes target     prot opt in     out     source               destination
    0     0 forwarding_VPN_FW_rule  all  --  *      *       0.0.0.0/0            0.0.0.0/0            /* user chain for forwarding */
    0     0 ACCEPT     all  --  *      *       0.0.0.0/0            0.0.0.0/0            ctstate DNAT /* Accept port forwards */
    0     0 zone_VPN_FW_dest_REJECT  all  --  *      *       0.0.0.0/0            0.0.0.0/0

Chain zone_VPN_FW_input (0 references)
 pkts bytes target     prot opt in     out     source               destination
    0     0 input_VPN_FW_rule  all  --  *      *       0.0.0.0/0            0.0.0.0/0            /* user chain for input */
    0     0 ACCEPT     all  --  *      *       0.0.0.0/0            0.0.0.0/0            ctstate DNAT /* Accept port redirections */
    0     0 zone_VPN_FW_src_REJECT  all  --  *      *       0.0.0.0/0            0.0.0.0/0

Chain zone_VPN_FW_output (0 references)
 pkts bytes target     prot opt in     out     source               destination
    0     0 output_VPN_FW_rule  all  --  *      *       0.0.0.0/0            0.0.0.0/0            /* user chain for output */
    0     0 zone_VPN_FW_dest_ACCEPT  all  --  *      *       0.0.0.0/0            0.0.0.0/0

Chain zone_VPN_FW_src_REJECT (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain zone_lan_dest_ACCEPT (5 references)
 pkts bytes target     prot opt in     out     source               destination
   25  7152 ACCEPT     all  --  *      br-lan  0.0.0.0/0            0.0.0.0/0

Chain zone_lan_forward (1 references)
 pkts bytes target     prot opt in     out     source               destination
  324 22738 forwarding_lan_rule  all  --  *      *       0.0.0.0/0            0.0.0.0/0            /* user chain for forwarding */
  324 22738 zone_vpn_dest_ACCEPT  all  --  *      *       0.0.0.0/0            0.0.0.0/0            /* forwarding lan -&gt; vpn */
  324 22738 zone_wan_dest_ACCEPT  all  --  *      *       0.0.0.0/0            0.0.0.0/0            /* forwarding lan -&gt; wan */
    0     0 zone_VPN_FW_dest_ACCEPT  all  --  *      *       0.0.0.0/0            0.0.0.0/0            /* forwarding lan -&gt; VPN_FW */
    0     0 ACCEPT     all  --  *      *       0.0.0.0/0            0.0.0.0/0            ctstate DNAT /* Accept port forwards */
    0     0 zone_lan_dest_ACCEPT  all  --  *      *       0.0.0.0/0            0.0.0.0/0

Chain zone_lan_input (1 references)
 pkts bytes target     prot opt in     out     source               destination
  758 60803 input_lan_rule  all  --  *      *       0.0.0.0/0            0.0.0.0/0            /* user chain for input */
    0     0 ACCEPT     all  --  *      *       0.0.0.0/0            0.0.0.0/0            ctstate DNAT /* Accept port redirections */
  758 60803 zone_lan_src_ACCEPT  all  --  *      *       0.0.0.0/0            0.0.0.0/0

Chain zone_lan_output (1 references)
 pkts bytes target     prot opt in     out     source               destination
   23  6984 output_lan_rule  all  --  *      *       0.0.0.0/0            0.0.0.0/0            /* user chain for output */
   23  6984 zone_lan_dest_ACCEPT  all  --  *      *       0.0.0.0/0            0.0.0.0/0

Chain zone_lan_src_ACCEPT (1 references)
 pkts bytes target     prot opt in     out     source               destination
  758 60803 ACCEPT     all  --  br-lan *       0.0.0.0/0            0.0.0.0/0

Chain zone_vpn_dest_ACCEPT (3 references)
 pkts bytes target     prot opt in     out     source               destination
    0     0 ACCEPT     all  --  *      tun0    0.0.0.0/0            0.0.0.0/0

Chain zone_vpn_forward (1 references)
 pkts bytes target     prot opt in     out     source               destination
    2   168 forwarding_vpn_rule  all  --  *      *       0.0.0.0/0            0.0.0.0/0            /* user chain for forwarding */
    2   168 zone_wan_dest_ACCEPT  all  --  *      *       0.0.0.0/0            0.0.0.0/0            /* forwarding vpn -&gt; wan */
    2   168 zone_lan_dest_ACCEPT  all  --  *      *       0.0.0.0/0            0.0.0.0/0            /* forwarding vpn -&gt; lan */
    0     0 ACCEPT     all  --  *      *       0.0.0.0/0            0.0.0.0/0            ctstate DNAT /* Accept port forwards */
    0     0 zone_vpn_dest_ACCEPT  all  --  *      *       0.0.0.0/0            0.0.0.0/0

Chain zone_vpn_input (1 references)
 pkts bytes target     prot opt in     out     source               destination
    0     0 input_vpn_rule  all  --  *      *       0.0.0.0/0            0.0.0.0/0            /* user chain for input */
    0     0 ACCEPT     all  --  *      *       0.0.0.0/0            0.0.0.0/0            ctstate DNAT /* Accept port redirections */
    0     0 zone_vpn_src_ACCEPT  all  --  *      *       0.0.0.0/0            0.0.0.0/0

Chain zone_vpn_output (1 references)
 pkts bytes target     prot opt in     out     source               destination
    0     0 output_vpn_rule  all  --  *      *       0.0.0.0/0            0.0.0.0/0            /* user chain for output */
    0     0 zone_vpn_dest_ACCEPT  all  --  *      *       0.0.0.0/0            0.0.0.0/0

Chain zone_vpn_src_ACCEPT (1 references)
 pkts bytes target     prot opt in     out     source               destination
    0     0 ACCEPT     all  --  tun0   *       0.0.0.0/0            0.0.0.0/0

Chain zone_wan_dest_ACCEPT (3 references)
 pkts bytes target     prot opt in     out     source               destination
  534 50242 ACCEPT     all  --  *      eth0    0.0.0.0/0            0.0.0.0/0
    0     0 ACCEPT     all  --  *      tun0    0.0.0.0/0            0.0.0.0/0
    0     0 ACCEPT     all  --  *      tun1    0.0.0.0/0            0.0.0.0/0

Chain zone_wan_dest_REJECT (1 references)
 pkts bytes target     prot opt in     out     source               destination
    0     0 reject     all  --  *      eth0    0.0.0.0/0            0.0.0.0/0
    0     0 reject     all  --  *      tun0    0.0.0.0/0            0.0.0.0/0
    0     0 reject     all  --  *      tun1    0.0.0.0/0            0.0.0.0/0

Chain zone_wan_forward (3 references)
 pkts bytes target     prot opt in     out     source               destination
    2   168 forwarding_wan_rule  all  --  *      *       0.0.0.0/0            0.0.0.0/0            /* user chain for forwarding */
    0     0 zone_lan_dest_ACCEPT  esp  --  *      *       0.0.0.0/0            0.0.0.0/0            /* @rule[7] */
    0     0 zone_lan_dest_ACCEPT  udp  --  *      *       0.0.0.0/0            0.0.0.0/0            udp dpt:500 /* @rule[8] */
    0     0 ACCEPT     all  --  *      *       0.0.0.0/0            0.0.0.0/0            ctstate DNAT /* Accept port forwards */
    2   168 zone_wan_dest_REJECT  all  --  *      *       0.0.0.0/0            0.0.0.0/0

Chain zone_wan_input (3 references)
 pkts bytes target     prot opt in     out     source               destination
  771 60686 input_wan_rule  all  --  *      *       0.0.0.0/0            0.0.0.0/0            /* user chain for input */
    0     0 ACCEPT     udp  --  *      *       0.0.0.0/0            0.0.0.0/0            udp dpt:68 /* Allow-DHCP-Renew */
    0     0 ACCEPT     2    --  *      *       0.0.0.0/0            0.0.0.0/0            /* Allow-IGMP */
    5   366 ACCEPT     udp  --  *      *       0.0.0.0/0            0.0.0.0/0            udp dpt:1194 /* Allow-OpenVPN-Inbound_2 */
    0     0 ACCEPT     all  --  *      *       0.0.0.0/0            0.0.0.0/0            ctstate DNAT /* Accept port redirections */
  766 60320 zone_wan_src_REJECT  all  --  *      *       0.0.0.0/0            0.0.0.0/0

Chain zone_wan_output (3 references)
 pkts bytes target     prot opt in     out     source               destination
  210 27504 output_wan_rule  all  --  *      *       0.0.0.0/0            0.0.0.0/0            /* user chain for output */
  210 27504 zone_wan_dest_ACCEPT  all  --  *      *       0.0.0.0/0            0.0.0.0/0

Chain zone_wan_src_REJECT (1 references)
 pkts bytes target     prot opt in     out     source               destination
  766 60320 reject     all  --  eth0   *       0.0.0.0/0            0.0.0.0/0
    0     0 reject     all  --  tun0   *       0.0.0.0/0            0.0.0.0/0
    0     0 reject     all  --  tun1   *       0.0.0.0/0            0.0.0.0/0
root@c7main:~#</code></pre></div><br /><div class="codebox"><pre><code>root@c7main:~# iptables -t nat -L -vn
Chain PREROUTING (policy ACCEPT 1242 packets, 129K bytes)
 pkts bytes target     prot opt in     out     source               destination
 1242  129K delegate_prerouting  all  --  *      *       0.0.0.0/0            0.0.0.0/0

Chain INPUT (policy ACCEPT 69 packets, 24490 bytes)
 pkts bytes target     prot opt in     out     source               destination

Chain OUTPUT (policy ACCEPT 777 packets, 53128 bytes)
 pkts bytes target     prot opt in     out     source               destination

Chain POSTROUTING (policy ACCEPT 568 packets, 38835 bytes)
 pkts bytes target     prot opt in     out     source               destination
 1428 84637 delegate_postrouting  all  --  *      *       0.0.0.0/0            0.0.0.0/0

Chain delegate_postrouting (1 references)
 pkts bytes target     prot opt in     out     source               destination
 1428 84637 postrouting_rule  all  --  *      *       0.0.0.0/0            0.0.0.0/0            /* user chain for postrouting */
    7  1248 zone_lan_postrouting  all  --  *      br-lan  0.0.0.0/0            0.0.0.0/0
  860 45802 zone_wan_postrouting  all  --  *      eth0    0.0.0.0/0            0.0.0.0/0
    0     0 zone_wan_postrouting  all  --  *      tun0    0.0.0.0/0            0.0.0.0/0
    0     0 zone_wan_postrouting  all  --  *      tun1    0.0.0.0/0            0.0.0.0/0
    0     0 zone_vpn_postrouting  all  --  *      tun0    0.0.0.0/0            0.0.0.0/0

Chain delegate_prerouting (1 references)
 pkts bytes target     prot opt in     out     source               destination
 1242  129K prerouting_rule  all  --  *      *       0.0.0.0/0            0.0.0.0/0            /* user chain for prerouting */
  421 62620 zone_lan_prerouting  all  --  br-lan *       0.0.0.0/0            0.0.0.0/0
  817 65907 zone_wan_prerouting  all  --  eth0   *       0.0.0.0/0            0.0.0.0/0
    4   336 zone_wan_prerouting  all  --  tun0   *       0.0.0.0/0            0.0.0.0/0
    0     0 zone_wan_prerouting  all  --  tun1   *       0.0.0.0/0            0.0.0.0/0
    4   336 zone_vpn_prerouting  all  --  tun0   *       0.0.0.0/0            0.0.0.0/0

Chain postrouting_VPN_FW_rule (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain postrouting_lan_rule (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain postrouting_rule (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain postrouting_vpn_rule (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain postrouting_wan_rule (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain prerouting_VPN_FW_rule (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain prerouting_lan_rule (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain prerouting_rule (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain prerouting_vpn_rule (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain prerouting_wan_rule (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain zone_VPN_FW_postrouting (0 references)
 pkts bytes target     prot opt in     out     source               destination
    0     0 postrouting_VPN_FW_rule  all  --  *      *       0.0.0.0/0            0.0.0.0/0            /* user chain for postrouting */
    0     0 MASQUERADE  all  --  *      *       0.0.0.0/0            0.0.0.0/0

Chain zone_VPN_FW_prerouting (0 references)
 pkts bytes target     prot opt in     out     source               destination
    0     0 prerouting_VPN_FW_rule  all  --  *      *       0.0.0.0/0            0.0.0.0/0            /* user chain for prerouting */

Chain zone_lan_postrouting (1 references)
 pkts bytes target     prot opt in     out     source               destination
    7  1248 postrouting_lan_rule  all  --  *      *       0.0.0.0/0            0.0.0.0/0            /* user chain for postrouting */
    0     0 SNAT       tcp  --  *      *       10.10.1.0/24         10.10.1.42           tcp dpt:56969 /* qbit (reflection) */ to:10.10.1.1
    0     0 SNAT       udp  --  *      *       10.10.1.0/24         10.10.1.42           udp dpt:56969 /* qbit (reflection) */ to:10.10.1.1

Chain zone_lan_prerouting (1 references)
 pkts bytes target     prot opt in     out     source               destination
  421 62620 prerouting_lan_rule  all  --  *      *       0.0.0.0/0            0.0.0.0/0            /* user chain for prerouting */
    0     0 DNAT       tcp  --  *      *       10.10.1.0/24         66.75.244.38         tcp dpt:56969 /* qbit (reflection) */ to:10.10.1.42:56969
    0     0 DNAT       udp  --  *      *       10.10.1.0/24         66.75.244.38         udp dpt:56969 /* qbit (reflection) */ to:10.10.1.42:56969

Chain zone_vpn_postrouting (1 references)
 pkts bytes target     prot opt in     out     source               destination
    0     0 postrouting_vpn_rule  all  --  *      *       0.0.0.0/0            0.0.0.0/0            /* user chain for postrouting */
    0     0 MASQUERADE  all  --  *      *       0.0.0.0/0            0.0.0.0/0

Chain zone_vpn_prerouting (1 references)
 pkts bytes target     prot opt in     out     source               destination
    4   336 prerouting_vpn_rule  all  --  *      *       0.0.0.0/0            0.0.0.0/0            /* user chain for prerouting */

Chain zone_wan_postrouting (3 references)
 pkts bytes target     prot opt in     out     source               destination
  860 45802 postrouting_wan_rule  all  --  *      *       0.0.0.0/0            0.0.0.0/0            /* user chain for postrouting */
  860 45802 MASQUERADE  all  --  *      *       0.0.0.0/0            0.0.0.0/0

Chain zone_wan_prerouting (3 references)
 pkts bytes target     prot opt in     out     source               destination
  821 66243 prerouting_wan_rule  all  --  *      *       0.0.0.0/0            0.0.0.0/0            /* user chain for prerouting */
    0     0 DNAT       tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            tcp dpt:56969 /* qbit */ to:10.10.1.42:56969
    0     0 DNAT       udp  --  *      *       0.0.0.0/0            0.0.0.0/0            udp dpt:56969 /* qbit */ to:10.10.1.42:56969
root@c7main:~#</code></pre></div><br /><br /><div class="codebox"><pre><code>root@c7main:~# iptables -t mangle -L -vn
Chain PREROUTING (policy ACCEPT 1091K packets, 925M bytes)
 pkts bytes target     prot opt in     out     source               destination
1091K  925M fwmark     all  --  *      *       0.0.0.0/0            0.0.0.0/0

Chain INPUT (policy ACCEPT 5375 packets, 513K bytes)
 pkts bytes target     prot opt in     out     source               destination

Chain FORWARD (policy ACCEPT 1085K packets, 924M bytes)
 pkts bytes target     prot opt in     out     source               destination
1085K  924M mssfix     all  --  *      *       0.0.0.0/0            0.0.0.0/0

Chain OUTPUT (policy ACCEPT 4836 packets, 880K bytes)
 pkts bytes target     prot opt in     out     source               destination

Chain POSTROUTING (policy ACCEPT 1090K packets, 925M bytes)
 pkts bytes target     prot opt in     out     source               destination

Chain fwmark (1 references)
 pkts bytes target     prot opt in     out     source               destination

Chain mssfix (1 references)
 pkts bytes target     prot opt in     out     source               destination
  110  5968 TCPMSS     tcp  --  *      eth0    0.0.0.0/0            0.0.0.0/0            tcp flags:0x06/0x02 /* wan (mtu_fix) */ TCPMSS clamp to PMTU
    0     0 TCPMSS     tcp  --  *      tun0    0.0.0.0/0            0.0.0.0/0            tcp flags:0x06/0x02 /* wan (mtu_fix) */ TCPMSS clamp to PMTU
    0     0 TCPMSS     tcp  --  *      tun1    0.0.0.0/0            0.0.0.0/0            tcp flags:0x06/0x02 /* wan (mtu_fix) */ TCPMSS clamp to PMTU
root@c7main:~#</code></pre></div><br /><div class="codebox"><pre><code>root@c7main:~# cat /proc/sys/net/ipv4/ip_forward
1</code></pre></div>											<p class="post-edited">(Last edited by <strong>RadBrad87</strong> on 23 May 2017, 04:38)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>