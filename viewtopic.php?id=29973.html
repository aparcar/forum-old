<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Special IP address failed to set up default gateway</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 24 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p135092">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">kennylam</div>
					<div class="post-datetime">
						11 May 2011, 17:36					</div>
				</div>
				<div class="post-content content">
					<p>I tired to obtain IP from internet connection by DHCP, however I got this message after &quot;/etc/init.d/network restart&#039; was executed.</p><p>root@TP-LINK:/# /etc/init.d/network restart</p><p>Sending discover...<br />Sending select for 1.36.242.52...<br />Lease of 1.36.242.52 obtained, lease time 1800<br />udhcpc: ifconfig wan 1.36.242.52 netmask 255.255.255.0 broadcast +<br />udhcpc: setting default routers: 1.36.243.254<br />route: SIOCADDRT: No such process<br />udhcpc: setting dns servers: 203.198.23.208 218.102.32.208</p><br /><p>The above hardware is TP-Link WR841-ND with PCCW 200Mbps Fiber in Hong Kong, however I tired OpenWRT X86 and Buffalo WZR-HP-G300NH result the same error message &#039;route: SIOCADDRT: No such process&#039;. All hardware are installed the trunk version of OpenWRT.<br />s<br />I wonder it is the problem of IP address, becoz I tired another connection from different ISP (HKBN, IP address allocated by DHCP as well) the problem doesn&#039;t exists.</p><p>I did tired to set a static IP address and gateway as&nbsp; 1.36.242.52/24 gw 1.36.243.254, the default route still didn&#039;t set up.</p>											<p class="post-edited">(Last edited by <strong>kennylam</strong> on 11 May 2011, 17:42)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p135095">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						11 May 2011, 18:45					</div>
				</div>
				<div class="post-content content">
					<p>The problem is not with the 1.0.0.0/24 range as such. The advertised gateway is outside of the 1.36.242.0/24 range. Can you make a pcap dump of the DHCP response? I wonder whether it contains CIDR options.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p135148">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">kennylam</div>
					<div class="post-datetime">
						12 May 2011, 19:55					</div>
				</div>
				<div class="post-content content">
					<p>here it is <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></p><p><a href="http://hotfile.com/dl/117593362/2647844/PCCW_DHCP.pcap.html">http://hotfile.com/dl/117593362/2647844 â€¦ .pcap.html</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p147100">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">macpaul</div>
					<div class="post-datetime">
						31 Oct 2011, 04:13					</div>
				</div>
				<div class="post-content content">
					<p>which truck version did you use? I&#039;ve got the same problem as you.<br />Kernel IP routing table<br />Destination&nbsp; &nbsp; &nbsp;Gateway&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Genmask&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Flags Metric Ref&nbsp; &nbsp; Use Iface<br />192.168.1.0&nbsp; &nbsp; &nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;255.255.255.0&nbsp; &nbsp;U&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; 0 br-lan<br />root@OpenWrt:/# route add default gw 10.0.2.3<br />route: SIOCADDRT: No such process</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p152771">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">aminc</div>
					<div class="post-datetime">
						2 Jan 2012, 20:22					</div>
				</div>
				<div class="post-content content">
					<p>I also have this problem with OpenWRT 10.03.1 on my TL-WR1043ND. Again, my advertised gateway is outside of the given subnet:</p><p>Address: 84.87.3.X<br />Subnet: 84.0.0.0/8<br />Gateway: 195.190.241.8</p><p>Has a workaround for this been found? The same setup is working fine with the TP-LINK firmware.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p152785">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						2 Jan 2012, 21:36					</div>
				</div>
				<div class="post-content content">
					<p>Edit your /usr/share/udhcpc/default.script as follows:</p><div class="codebox"><pre><code>--- package/base-files-network/files/usr/share/udhcpc/default.script    (revision 29632)
+++ package/base-files-network/files/usr/share/udhcpc/default.script    (working copy)
@@ -65,7 +65,8 @@
 
         local valid_gw=&quot;&quot;
         for i in $router ; do
-            route add default gw $i ${user_metric:+metric $user_metric} dev $interface
+            route add -host $i ${user_metric:+metric $user_metric} dev $interface
+            route add default gw $i ${user_metric:+metric $user_metric}
             valid_gw=&quot;${valid_gw:+$valid_gw|}$i&quot;
         done</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p153182">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">aminc</div>
					<div class="post-datetime">
						5 Jan 2012, 12:51					</div>
				</div>
				<div class="post-content content">
					<p>Thanks, that fixed the issue.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p181391">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">r25Al</div>
					<div class="post-datetime">
						24 Oct 2012, 16:06					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jow wrote:</cite><blockquote><p>Edit your /usr/share/udhcpc/default.script as follows:</p><div class="codebox"><pre><code>--- package/base-files-network/files/usr/share/udhcpc/default.script    (revision 29632)
+++ package/base-files-network/files/usr/share/udhcpc/default.script    (working copy)
@@ -65,7 +65,8 @@
 
         local valid_gw=&quot;&quot;
         for i in $router ; do
-            route add default gw $i ${user_metric:+metric $user_metric} dev $interface
+            route add -host $i ${user_metric:+metric $user_metric} dev $interface
+            route add default gw $i ${user_metric:+metric $user_metric}
             valid_gw=&quot;${valid_gw:+$valid_gw|}$i&quot;
         done</code></pre></div></blockquote></div><p>Is there a way to solve the problem for Attitude Adjustment 12.09-beta2 (r33883)?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>