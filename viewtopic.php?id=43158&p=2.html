<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> TP-LINK MR3040 v2 support</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 2 Apr 2018 and 19 Apr 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 2 of 4</div><nav><ul><li><a href="viewtopic.php%3Fid=43158&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li><li><a href="viewtopic.php%3Fid=43158&amp;p=3.html">3</a></li><li><a href="viewtopic.php%3Fid=43158&amp;p=4.html">4</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p202637">
				<div class="post-metadata">
					<div class="post-num">Post #26</div>
					<div class="post-author">fizaa1981</div>
					<div class="post-datetime">
						24 May 2013, 12:23					</div>
				</div>
				<div class="post-content content">
					<p>Mine too confirmed. Used the .bin provided by nebbia88 for flashing tplink mr3040 v 2 and it worked like a champ. good work nebbia88 .</p><p>downloaded from : <a href="https://www.dropbox.com/s/qwxj9jdspmf4gcj/openwrt-ar71xx-generic-tl-mr3040-v2-squashfs-factory.bin">https://www.dropbox.com/s/qwxj9jdspmf4g … actory.bin</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p205464">
				<div class="post-metadata">
					<div class="post-num">Post #27</div>
					<div class="post-author">soundsticks</div>
					<div class="post-datetime">
						24 Jun 2013, 04:57					</div>
				</div>
				<div class="post-content content">
					<p>I had already start the chillispot but I won&#039;t able to go router admin page.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p208364">
				<div class="post-metadata">
					<div class="post-num">Post #28</div>
					<div class="post-author">mwelters</div>
					<div class="post-datetime">
						28 Jul 2013, 19:18					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I wonder, who we can ask to add a menuconfig entry to make it available to everybody ?</p><p>Markus</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p211986">
				<div class="post-metadata">
					<div class="post-num">Post #29</div>
					<div class="post-author">ThatGuy</div>
					<div class="post-datetime">
						10 Sep 2013, 01:10					</div>
				</div>
				<div class="post-content content">
					<p>I just bought a MR3040 v2.1. What&#039;s needed in order to better support this router? Is there anything I can do to help? Do you need serial console output, and if so, how would I go about getting that?</p><p>Here are some hi-res pictures of my board:</p><p><a href="http://i43.tinypic.com/2py5ixc.jpg"><span class="postimg"><img src="http://i43.tinypic.com/2py5ixc.jpg" alt="http://i43.tinypic.com/2py5ixc.jpg" /></span></a></p><p><a href="http://i44.tinypic.com/t51ugn.jpg"><span class="postimg"><img src="http://i44.tinypic.com/t51ugn.jpg" alt="http://i44.tinypic.com/t51ugn.jpg" /></span></a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p212134">
				<div class="post-metadata">
					<div class="post-num">Post #30</div>
					<div class="post-author">ThatGuy</div>
					<div class="post-datetime">
						12 Sep 2013, 00:50					</div>
				</div>
				<div class="post-content content">
					<p>I was able to access BusyBox via the stock command line interface (located at <a href="http://192.168.0.1/userRpmNatDebugRpm26525557/linux_cmdline.html">http://192.168.0.1/userRpmNatDebugRpm26 … dline.html</a> - username/password is osteam/5up).</p><p>I found the following hardware info:</p><div class="codebox"><pre><code># cat /proc/version&amp;
Linux version 2.6.31--LSDK-9.2.0.312 (root@localhost.localdomain) (gcc version 4.3.3 (GCC) ) #45 Wed Oct 17 17:14:17 CST 2012</code></pre></div><div class="codebox"><pre><code># cat /proc/cpuinfo &amp;
system type        : Atheros AR9330 (Hornet)
processor        : 0
cpu model        : MIPS 24Kc V7.4
BogoMIPS        : 266.24
wait instruction    : yes
microsecond timers    : yes
tlb_entries        : 16
extra interrupt vector    : yes
hardware watchpoint    : yes, count: 4, address/irw mask: [0x0000, 0x0ff8, 0x0ff8, 0x0ffb]
ASEs implemented    : mips16
shadow register sets    : 1
core            : 0
VCED exceptions        : not available
VCEI exceptions        : not available</code></pre></div><div class="codebox"><pre><code># cat /proc/interrupts&amp;
           CPU0       
  2:     226967           dummy  wifi0
  3:          0            MIPS  ehci_hcd:usb1
  4:          0            MIPS  eth1
  5:      26826            MIPS  eth0
  6:          0            MIPS  cascade
  7:     886122            MIPS  timer
 18:          0     AR7240 MISC  cascade
 19:         48     AR7240 MISC  serial
 28:         37     AR7240 MISC  gmac link intr
 43:          0     AR7240 GPIO  RESTORE_FACTORY_DEFAULT
 53:          0     AR7240 GPIO  Watchdog Reset

ERR:          0</code></pre></div><div class="codebox"><pre><code># ls /proc
1              42             533            diskstats      pagetypeinfo
147            43             534            driver         partitions
150            44             535            execdomains    self
151            45             538            filesystems    simple_config
152            5              542            fs             slabinfo
155            505            549            interrupts     softirqs
156            506            572            iomem          stat
16             507            66             ioports        sys
162            508            8              irq            sysvipc
165            511            93             kallsyms       timer_list
168            512            ath_gmac_stat  kmsg           tty
2              515            athdebug       loadavg        uptime
25             516            athversion     locks          version
3              527            buddyinfo      meminfo        vmallocinfo
324            528            bus            misc           vmstat
361            529            cmdline        modules        zoneinfo
384            530            cpuinfo        mounts
385            531            crypto         mtd
4              532            devices        net</code></pre></div><div class="codebox"><pre><code># cat /proc/meminfo&amp;
MemTotal:          29992 kB
MemFree:           11060 kB
Buffers:            2236 kB
Cached:             6860 kB
SwapCached:            0 kB
Active:             4364 kB
Inactive:           6932 kB
Active(anon):       2200 kB
Inactive(anon):        0 kB
Active(file):       2164 kB
Inactive(file):     6932 kB
Unevictable:           0 kB
Mlocked:               0 kB
SwapTotal:             0 kB
SwapFree:              0 kB
Dirty:                 0 kB
Writeback:             0 kB
AnonPages:          2224 kB
Mapped:             1952 kB
Slab:               4908 kB
SReclaimable:        456 kB
SUnreclaim:         4452 kB
PageTables:          232 kB
NFS_Unstable:          0 kB
Bounce:                0 kB
WritebackTmp:          0 kB
CommitLimit:       14996 kB
Committed_AS:       5600 kB
VmallocTotal:    1048404 kB
VmallocUsed:        2116 kB
VmallocChunk:    1037128 kB</code></pre></div><div class="codebox"><pre><code># cat /proc/softirqs&amp;
                CPU0       
      HI:          0
   TIMER:     894576
  NET_TX:       1114
  NET_RX:      30910
   BLOCK:          0
 TASKLET:     194810
   SCHED:          0
 HRTIMER:          0
     RCU:      29923</code></pre></div><div class="codebox"><pre><code># cat /proc/devices&amp;
Character devices:
  1 mem
  4 ttyS
  5 /dev/tty
  5 /dev/console
  5 /dev/ptmx
 10 misc
 13 input
 21 sg
 77 AR7240_GPIOC
 90 mtd
108 ppp
128 ptm
136 pts
180 usb
189 usb_device
238 ar7240_gpio_chrdev
239 ar7240_flash_chrdev

Block devices:
259 blkext
  8 sd
 31 mtdblock
 65 sd
 66 sd
 67 sd
 68 sd
 69 sd
 70 sd
 71 sd
128 sd
129 sd
130 sd
131 sd
132 sd
133 sd
134 sd
135 sd</code></pre></div><div class="codebox"><pre><code># cat /proc/timer_list&amp;
Timer List Version: v0.4
HRTIMER_MAX_CLOCK_BASES: 2
now at 3623494191688 nsecs

cpu: 0
 clock 0:
  .base:       80247490
  .index:      0
  .resolution: 4000250 nsecs
  .get_time:   ktime_get_real
active timers:
 clock 1:
  .base:       802474b8
  .index:      1
  .resolution: 4000250 nsecs
  .get_time:   ktime_get
active timers:
 #0: &lt;80ddfea0&gt;, hrtimer_wakeup, S:01
 # expires at 3623587145038-3623587195038 nsecs [in 92953350 to 93003350 nsecs]
 #1: &lt;80ec3ea0&gt;, hrtimer_wakeup, S:01
 # expires at 3623592058218-3623592108218 nsecs [in 97866530 to 97916530 nsecs]
 #2: &lt;80dcfea0&gt;, hrtimer_wakeup, S:01
 # expires at 3623692053433-3623692103433 nsecs [in 197861745 to 197911745 nsecs]
 #3: &lt;81c63ea0&gt;, hrtimer_wakeup, S:01
 # expires at 3623692078218-3623692128218 nsecs [in 197886530 to 197936530 nsecs]
 #4: &lt;81c87ea0&gt;, hrtimer_wakeup, S:01
 # expires at 3623776060908-3623776110908 nsecs [in 281869220 to 281919220 nsecs]
 #5: &lt;81c89ea0&gt;, hrtimer_wakeup, S:01
 # expires at 3623776082598-3623776132598 nsecs [in 281890910 to 281940910 nsecs]
 #6: &lt;80eabea0&gt;, hrtimer_wakeup, S:01
 # expires at 3623776449078-3623776499078 nsecs [in 282257390 to 282307390 nsecs]
 #7: &lt;80dd7ea0&gt;, hrtimer_wakeup, S:01
 # expires at 3624452067673-3624452117673 nsecs [in 957875985 to 957925985 nsecs]
 #8: &lt;80eadea0&gt;, hrtimer_wakeup, S:01
 # expires at 3624452094108-3624452144108 nsecs [in 957902420 to 957952420 nsecs]
 #9: &lt;80e9fea0&gt;, hrtimer_wakeup, S:01
 # expires at 3624452139538-3624452189538 nsecs [in 957947850 to 957997850 nsecs]
 #10: &lt;80ec1ea0&gt;, hrtimer_wakeup, S:01
 # expires at 3624456056338-3624456106338 nsecs [in 961864650 to 961914650 nsecs]
 #11: &lt;81c29ad8&gt;, hrtimer_wakeup, S:01
 # expires at 3625300039373-3625302039369 nsecs [in 1805847685 to 1807847681 nsecs]
 #12: &lt;80c21ea0&gt;, hrtimer_wakeup, S:01
 # expires at 3625356006158-3625356056158 nsecs [in 1861814470 to 1861864470 nsecs]
 #13: &lt;80e89ea0&gt;, hrtimer_wakeup, S:01
 # expires at 3626220007808-3626220057808 nsecs [in 2725816120 to 2725866120 nsecs]
 #14: &lt;81c49ea0&gt;, hrtimer_wakeup, S:01
 # expires at 3629000002848-3629000052848 nsecs [in 5505811160 to 5505861160 nsecs]
 #15: &lt;80cdfa40&gt;, hrtimer_wakeup, S:01
 # expires at 3632620073878-3632630073853 nsecs [in 9125882190 to 9135882165 nsecs]
 #16: &lt;80edfa40&gt;, hrtimer_wakeup, S:01
 # expires at 3634616067468-3634646067446 nsecs [in 11121875780 to 11151875758 nsecs]
 #17: &lt;81c5fea0&gt;, hrtimer_wakeup, S:01
 # expires at 3678339169738-3678339219738 nsecs [in 54844978050 to 54845028050 nsecs]
 #18: &lt;81c6bea0&gt;, hrtimer_wakeup, S:01
 # expires at 3678680084893-3678680134893 nsecs [in 55185893205 to 55185943205 nsecs]
 #19: &lt;81c53a40&gt;, hrtimer_wakeup, S:01
 # expires at 7217260376833-7217260426833 nsecs [in 3593766185145 to 3593766235145 nsecs]


Tick Device: mode:     0
Per CPU device: 0
Clock Event Device: MIPS
 max_delta_ns:   2147483647
 min_delta_ns:   3840
 mult:           858993459
 shift:          32
 mode:           3
 next_event:     3623496000000 nsecs
 set_next_event: mips_next_event
 set_mode:       mips_set_clock_mode
 event_handler:  tick_handle_periodic</code></pre></div><div class="codebox"><pre><code># /sbin/lsmod
Module                  Size  Used by
umac 630496 0 - Live 0xc0a5e000
ath_dev 214688 1 umac, Live 0xc094a000 (P)
ath_rate_atheros 32512 1 ath_dev, Live 0xc08f3000 (P)
ath_hal 369264 2 umac,ath_dev, Live 0xc0886000 (P)
asf 9376 3 umac,ath_dev,ath_hal, Live 0xc080e000 (P)
adf 14512 3 umac,ath_dev,ath_hal, Live 0xc07ff000
nf_nat_rtsp 5328 0 - Live 0xc073d000
nf_conntrack_rtsp 7136 1 nf_nat_rtsp, Live 0xc0731000
nf_nat_h323 6720 0 - Live 0xc0720000
nf_nat_tftp 1280 0 - Live 0xc0715000
nf_conntrack_tftp 4192 1 nf_nat_tftp, Live 0xc070b000
nf_nat_ftp 2768 0 - Live 0xc0701000
nf_conntrack_ftp 7216 1 nf_nat_ftp, Live 0xc06f6000
nf_nat_pptp 2576 0 - Live 0xc06eb000
nf_conntrack_pptp 5904 1 nf_nat_pptp, Live 0xc06e0000
tp_domain 4352 0 - Live 0xc06c1000
athrs_gmac 54048 0 - Live 0xc02a3000
statistics 87056 0 - Live 0xc0273000
wlan_warn 2976 0 - Live 0xc0268000
pptp 10432 0 - Live 0xc025f000
pppol2tp 27760 0 - Live 0xc024d000
br_filter 1232 0 - Live 0xc023b000
ts_kmp 2208 1 - Live 0xc0232000
cls_fw 5088 0 - Live 0xc0227000
cls_basic 4944 0 - Live 0xc021b000
sch_sfq 6384 0 - Live 0xc020f000
sch_prio 5360 0 - Live 0xc0203000
sch_htb 18000 0 - Live 0xc01f4000
ipt_TRIGGER 3872 0 - Live 0xc01e5000
ipt_REJECT 2992 0 - Live 0xc01db000
ipt_REDIRECT 1520 0 - Live 0xc01d1000
ipt_MASQUERADE 2400 3 - Live 0xc01c8000
iptable_nat 4720 1 - Live 0xc01bd000
iptable_filter 2352 1 - Live 0xc01b2000
ip_tables 11824 2 iptable_nat,iptable_filter, Live 0xc01a6000
nf_nat_proto_gre 1984 1 nf_nat_pptp, Live 0xc0199000
nf_nat 15904 10 nf_nat_rtsp,nf_nat_h323,nf_nat_tftp,nf_nat_ftp,nf_nat_pptp,ipt_TRIGGER,ipt_REDIRECT,ipt_MASQUERADE,iptable_nat,nf_nat_proto_gre, Live 0xc018d000
nf_conntrack_ipv4 13184 9 iptable_nat,nf_nat, Live 0xc017c000
nf_defrag_ipv4 1648 1 nf_conntrack_ipv4, Live 0xc016e000
xt_state 1856 6 - Live 0xc0165000
xt_conntrack 4544 0 - Live 0xc015b000
nf_conntrack_h323 47328 1 nf_nat_h323, Live 0xc0146000
nf_conntrack_proto_gre 4976 1 nf_conntrack_pptp, Live 0xc012f000
nf_conntrack 59008 18 nf_nat_rtsp,nf_conntrack_rtsp,nf_nat_h323,nf_nat_tftp,nf_conntrack_tftp,nf_nat_ftp,nf_conntrack_ftp,nf_nat_pptp,nf_conntrack_pptp,ipt_TRIGGER,ipt_MASQUERADE,iptable_nat,nf_nat,nf_conntrack_ipv4,xt_state,xt_conntrack,nf_conntrack_h323,nf_conntrack_proto_gre, Live 0xc0116000
ipt_multiurl 1936 0 - Live 0xc00fa000
xt_time 2704 0 - Live 0xc00f1000
xt_string 2208 0 - Live 0xc00e7000
xt_multiport 2848 0 - Live 0xc00dd000
xt_mac 1376 0 - Live 0xc00d3000
xt_iprange 2128 0 - Live 0xc00ca000
xt_comment 1296 1 - Live 0xc00c1000
xt_TCPMSS 3264 1 - Live 0xc00b8000
xt_MARK 1888 0 - Live 0xc00ae000
xt_tcpudp 2784 14 - Live 0xc00a5000
x_tables 16480 19 wlan_warn,ipt_TRIGGER,ipt_REJECT,ipt_REDIRECT,ipt_MASQUERADE,iptable_nat,ip_tables,xt_state,xt_conntrack,ipt_multiurl,xt_time,xt_string,xt_multiport,xt_mac,xt_iprange,xt_comment,xt_TCPMSS,xt_MARK,xt_tcpudp, Live 0xc0097000</code></pre></div><div class="codebox"><pre><code># cat /proc/modules&amp;
umac 630496 0 - Live 0xc0a5e000
ath_dev 214688 1 umac, Live 0xc094a000 (P)
ath_rate_atheros 32512 1 ath_dev, Live 0xc08f3000 (P)
ath_hal 369264 2 umac,ath_dev, Live 0xc0886000 (P)
asf 9376 3 umac,ath_dev,ath_hal, Live 0xc080e000 (P)
adf 14512 3 umac,ath_dev,ath_hal, Live 0xc07ff000
nf_nat_rtsp 5328 0 - Live 0xc073d000
nf_conntrack_rtsp 7136 1 nf_nat_rtsp, Live 0xc0731000
nf_nat_h323 6720 0 - Live 0xc0720000
nf_nat_tftp 1280 0 - Live 0xc0715000
nf_conntrack_tftp 4192 1 nf_nat_tftp, Live 0xc070b000
nf_nat_ftp 2768 0 - Live 0xc0701000
nf_conntrack_ftp 7216 1 nf_nat_ftp, Live 0xc06f6000
nf_nat_pptp 2576 0 - Live 0xc06eb000
nf_conntrack_pptp 5904 1 nf_nat_pptp, Live 0xc06e0000
tp_domain 4352 0 - Live 0xc06c1000
athrs_gmac 54048 0 - Live 0xc02a3000
statistics 87056 0 - Live 0xc0273000
wlan_warn 2976 0 - Live 0xc0268000
pptp 10432 0 - Live 0xc025f000
pppol2tp 27760 0 - Live 0xc024d000
br_filter 1232 0 - Live 0xc023b000
ts_kmp 2208 1 - Live 0xc0232000
cls_fw 5088 0 - Live 0xc0227000
cls_basic 4944 0 - Live 0xc021b000
sch_sfq 6384 0 - Live 0xc020f000
sch_prio 5360 0 - Live 0xc0203000
sch_htb 18000 0 - Live 0xc01f4000
ipt_TRIGGER 3872 0 - Live 0xc01e5000
ipt_REJECT 2992 0 - Live 0xc01db000
ipt_REDIRECT 1520 0 - Live 0xc01d1000
ipt_MASQUERADE 2400 3 - Live 0xc01c8000
iptable_nat 4720 1 - Live 0xc01bd000
iptable_filter 2352 1 - Live 0xc01b2000
ip_tables 11824 2 iptable_nat,iptable_filter, Live 0xc01a6000
nf_nat_proto_gre 1984 1 nf_nat_pptp, Live 0xc0199000
nf_nat 15904 10 nf_nat_rtsp,nf_nat_h323,nf_nat_tftp,nf_nat_ftp,nf_nat_pptp,ipt_TRIGGER,ipt_REDIRECT,ipt_MASQUERADE,iptable_nat,nf_nat_proto_gre, Live 0xc018d000
nf_conntrack_ipv4 13184 9 iptable_nat,nf_nat, Live 0xc017c000
nf_defrag_ipv4 1648 1 nf_conntrack_ipv4, Live 0xc016e000
xt_state 1856 6 - Live 0xc0165000
xt_conntrack 4544 0 - Live 0xc015b000
nf_conntrack_h323 47328 1 nf_nat_h323, Live 0xc0146000
nf_conntrack_proto_gre 4976 1 nf_conntrack_pptp, Live 0xc012f000
nf_conntrack 59008 18 nf_nat_rtsp,nf_conntrack_rtsp,nf_nat_h323,nf_nat_tftp,nf_conntrack_tftp,nf_nat_ftp,nf_conntrack_ftp,nf_nat_pptp,nf_conntrack_pptp,ipt_TRIGGER,ipt_MASQUERADE,iptable_nat,nf_nat,nf_conntrack_ipv4,xt_state,xt_conntrack,nf_conntrack_h323,nf_conntrack_proto_gre, Live 0xc0116000
ipt_multiurl 1936 0 - Live 0xc00fa000
xt_time 2704 0 - Live 0xc00f1000
xt_string 2208 0 - Live 0xc00e7000
xt_multiport 2848 0 - Live 0xc00dd000
xt_mac 1376 0 - Live 0xc00d3000
xt_iprange 2128 0 - Live 0xc00ca000
xt_comment 1296 1 - Live 0xc00c1000
xt_TCPMSS 3264 1 - Live 0xc00b8000
xt_MARK 1888 0 - Live 0xc00ae000
xt_tcpudp 2784 14 - Live 0xc00a5000
x_tables 16480 19 wlan_warn,ipt_TRIGGER,ipt_REJECT,ipt_REDIRECT,ipt_MASQUERADE,iptable_nat,ip_tables,xt_state,xt_conntrack,ipt_multiurl,xt_time,xt_string,xt_multiport,xt_mac,xt_iprange,xt_comment,xt_TCPMSS,xt_MARK,xt_tcpudp, Live 0xc0097000</code></pre></div><div class="codebox"><pre><code># ls /dev
ar7100_flash_chrdev  ram0                 ttyS1
ar7100_gpio_chrdev   random               ttyS2
caldata              tty                  ttyUSB0
console              tty0                 ttyUSB1
dk0                  tty1                 ttyUSB10
kmem                 tty2                 ttyUSB11
mem                  ttyACM0              ttyUSB12
mtd0                 ttyACM1              ttyUSB13
mtdblock0            ttyACM10             ttyUSB14
mtdblock1            ttyACM11             ttyUSB15
mtdblock2            ttyACM12             ttyUSB2
mtdblock3            ttyACM13             ttyUSB3
mtdblock4            ttyACM14             ttyUSB4
mtdblock5            ttyACM15             ttyUSB5
mtdblock6            ttyACM2              ttyUSB6
mtdr0                ttyACM3              ttyUSB7
null                 ttyACM4              ttyUSB8
ppp                  ttyACM5              ttyUSB9
ptmx                 ttyACM6              ttyp0
pts                  ttyACM7              ttyp1
ptyp0                ttyACM8              ttyp2
ptyp1                ttyACM9              urandom
ptyp2                ttyS0                zero</code></pre></div><div class="codebox"><pre><code># /sbin/ifconfig
ath0      Link encap:Ethernet  HWaddr F8:1A:67:5B:D9:7C  
          UP BROADCAST RUNNING MULTICAST  MTU:2290  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:456 errors:0 dropped:2656 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:200184 (195.4 KiB)

br0       Link encap:Ethernet  HWaddr F8:1A:67:5B:D9:7C  
          inet addr:192.168.0.1  Bcast:192.168.0.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:22657 errors:0 dropped:0 overruns:0 frame:0
          TX packets:26997 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:2368073 (2.2 MiB)  TX bytes:19011533 (18.1 MiB)

eth0      Link encap:Ethernet  HWaddr F8:1A:67:5B:D9:7B  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:22683 errors:0 dropped:4 overruns:0 frame:0
          TX packets:29239 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:2779389 (2.6 MiB)  TX bytes:19273038 (18.3 MiB)

eth1      Link encap:Ethernet  HWaddr F8:1A:67:5B:D9:7D  
          UP BROADCAST MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:2004 errors:0 dropped:0 overruns:0 frame:0
          TX packets:2004 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:156312 (152.6 KiB)  TX bytes:156312 (152.6 KiB)

wifi0     Link encap:Ethernet  HWaddr F8:1A:67:5B:D9:7C  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:174 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
          Interrupt:2 Memory:b8100000-b811ffff </code></pre></div><div class="codebox"><pre><code># cat /proc/partitions&amp;
major minor  #blocks  name

  31        0        128 mtdblock0
  31        1       1024 mtdblock1
  31        2       2816 mtdblock2
  31        3         64 mtdblock3
  31        4         64 mtdblock4</code></pre></div><div class="codebox"><pre><code># cat /proc/diskstats&amp;
  31       0 mtdblock0 0 0 0 0 0 0 0 0 0 0 0
  31       1 mtdblock1 0 0 0 0 0 0 0 0 0 0 0
  31       2 mtdblock2 82 2127 4418 1028 0 0 0 0 0 1028 1028
  31       3 mtdblock3 0 0 0 0 0 0 0 0 0 0 0
  31       4 mtdblock4 1 0 8 0 0 0 0 0 0 0 0</code></pre></div><div class="codebox"><pre><code># df
Filesystem           1k-blocks      Used Available Use% Mounted on
/dev/mtdblock2            2688      2688         0 100% /</code></pre></div><div class="codebox"><pre><code># cat /proc/pagetypeinfo&amp;
Page block order: 10
Pages per block:  1024

Free pages count per migrate type at order       0      1      2      3      4      5      6      7      8      9     10 
Node    0, zone   Normal, type    Unmovable      3      2      2      0      1      1      1      1      0      0      0 
Node    0, zone   Normal, type  Reclaimable      0      1      1      1      0      0      0      1      1      1      0 
Node    0, zone   Normal, type      Movable      1      1      1      1      0      1      1      0      0      1      0 
Node    0, zone   Normal, type      Reserve      0      0      0      0      0      0      0      0      0      0      1 
Node    0, zone   Normal, type      Isolate      0      0      0      0      0      0      0      0      0      0      0 

Number of blocks type     Unmovable  Reclaimable      Movable      Reserve      Isolate 
Node 0, zone   Normal            2            1            4            1            0 </code></pre></div><div class="codebox"><pre><code># cat /proc/vmstat&amp;
nr_free_pages 2807
nr_inactive_anon 0
nr_active_anon 521
nr_inactive_file 1733
nr_active_file 541
nr_unevictable 0
nr_mlock 0
nr_anon_pages 527
nr_mapped 488
nr_file_pages 2274
nr_dirty 0
nr_writeback 0
nr_slab_reclaimable 114
nr_slab_unreclaimable 1108
nr_page_table_pages 52
nr_unstable 0
nr_bounce 0
nr_vmscan_write 0
nr_writeback_temp 0
pgpgin 2213
pgpgout 0
pswpin 0
pswpout 0
pgalloc_normal 75985
pgalloc_movable 0
pgfree 78792
pgactivate 542
pgdeactivate 0
pgfault 71708
pgmajfault 78
pgrefill_normal 0
pgrefill_movable 0
pgsteal_normal 0
pgsteal_movable 0
pgscan_kswapd_normal 0
pgscan_kswapd_movable 0
pgscan_direct_normal 0
pgscan_direct_movable 0
pginodesteal 0
slabs_scanned 0
kswapd_steal 0
kswapd_inodesteal 0
pageoutrun 0
allocstall 0
pgrotated 0
unevictable_pgs_culled 0
unevictable_pgs_scanned 0
unevictable_pgs_rescued 0
unevictable_pgs_mlocked 0
unevictable_pgs_munlocked 0
unevictable_pgs_cleared 0
unevictable_pgs_stranded 0
unevictable_pgs_mlockfreed 0</code></pre></div><div class="codebox"><pre><code># cat /proc/zoneinfo&amp;
Node 0, zone   Normal
  pages free     2771
        min      180
        low      225
        high     270
        scanned  0
        spanned  8192
        present  8128
    nr_free_pages 2771
    nr_inactive_anon 0
    nr_active_anon 550
    nr_inactive_file 1733
    nr_active_file 541
    nr_unevictable 0
    nr_mlock     0
    nr_anon_pages 556
    nr_mapped    488
    nr_file_pages 2274
    nr_dirty     0
    nr_writeback 0
    nr_slab_reclaimable 114
    nr_slab_unreclaimable 1107
    nr_page_table_pages 58
    nr_unstable  0
    nr_bounce    0
    nr_vmscan_write 0
    nr_writeback_temp 0
        protection: (0, 0)
  pagesets
    cpu: 0
              count: 0
              high:  0
              batch: 1
  all_unreclaimable: 0
  prev_priority:     12
  start_pfn:         0
  inactive_ratio:    1</code></pre></div>											<p class="post-edited">(Last edited by <strong>ThatGuy</strong> on 12 Sep 2013, 00:55)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p212167">
				<div class="post-metadata">
					<div class="post-num">Post #31</div>
					<div class="post-author">ThatGuy</div>
					<div class="post-datetime">
						12 Sep 2013, 13:43					</div>
				</div>
				<div class="post-content content">
					<p>Nailed it! <img src="https://forum.openwrt.org/img/smilies/cool.png" width="15" height="15" alt="cool" /><br />I managed to compile a working firmware image myself. Will submit a patch ASAP.</p><p>dmesg output after flashing OpenWrt:<br /></p><div class="codebox"><pre><code>BusyBox v1.19.4 (2013-09-12 12:14:34 CEST) built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 -----------------------------------------------------
 BARRIER BREAKER (Bleeding Edge, r37950)
 -----------------------------------------------------
  * 1/2 oz Galliano         Pour all ingredients into
  * 4 oz cold Coffee        an irish coffee mug filled
  * 1 1/2 oz Dark Rum       with crushed ice. Stir.
  * 2 tsp. Creme de Cacao
 -----------------------------------------------------
root@OpenWrt:~# dmesg
[    0.000000] Linux version 3.10.10 (thatguy@laptop) (gcc version 4.6.4 (OpenWrt/Linaro GCC 4.6-2013.05 r37950) ) #1 Thu Sep 12 12:19:46 CEST 2013
[    0.000000] MyLoader: sysp=fa89c804, boardp=69cd3b24, parts=31a09c82
[    0.000000] bootconsole [early0] enabled
[    0.000000] CPU revision is: 00019374 (MIPS 24Kc)
[    0.000000] SoC: Atheros AR9330 rev 1
[    0.000000] Clocks: CPU:400.000MHz, DDR:400.000MHz, AHB:200.000MHz, Ref:25.000MHz
[    0.000000] Determined physical RAM map:
[    0.000000]  memory: 02000000 @ 00000000 (usable)
[    0.000000] Initrd not found or empty - disabling initrd
[    0.000000] Zone ranges:
[    0.000000]   Normal   [mem 0x00000000-0x01ffffff]
[    0.000000] Movable zone start for each node
[    0.000000] Early memory node ranges
[    0.000000]   node   0: [mem 0x00000000-0x01ffffff]
[    0.000000] On node 0 totalpages: 8192
[    0.000000] free_area_init_node: node 0, pgdat 803029b0, node_mem_map 81000000
[    0.000000]   Normal zone: 64 pages used for memmap
[    0.000000]   Normal zone: 0 pages reserved
[    0.000000]   Normal zone: 8192 pages, LIFO batch:0
[    0.000000] Primary instruction cache 64kB, VIPT, 4-way, linesize 32 bytes.
[    0.000000] Primary data cache 32kB, 4-way, VIPT, cache aliases, linesize 32 bytes
[    0.000000] pcpu-alloc: s0 r0 d32768 u32768 alloc=1*32768
[    0.000000] pcpu-alloc: [0] 0 
[    0.000000] Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 8128
[    0.000000] Kernel command line:  board=TL-MR3040 console=ttyATH0,115200 rootfstype=squashfs,jffs2 noinitrd
[    0.000000] PID hash table entries: 128 (order: -3, 512 bytes)
[    0.000000] Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
[    0.000000] Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
[    0.000000] Writing ErrCtl register=00000000
[    0.000000] Readback ErrCtl register=00000000
[    0.000000] Memory: 28848k/32768k available (2193k kernel code, 3920k reserved, 591k data, 220k init, 0k highmem)
[    0.000000] SLUB: HWalign=32, Order=0-3, MinObjects=0, CPUs=1, Nodes=1
[    0.000000] NR_IRQS:51
[    0.080000] Calibrating delay loop... 265.42 BogoMIPS (lpj=1327104)
[    0.080000] pid_max: default: 32768 minimum: 301
[    0.080000] Mount-cache hash table entries: 512
[    0.090000] NET: Registered protocol family 16
[    0.100000] MIPS: machine is TP-LINK TL-MR3040
[    0.350000] bio: create slab &lt;bio-0&gt; at 0
[    0.360000] Switching to clocksource MIPS
[    0.360000] NET: Registered protocol family 2
[    0.370000] TCP established hash table entries: 512 (order: 0, 4096 bytes)
[    0.370000] TCP bind hash table entries: 512 (order: -1, 2048 bytes)
[    0.370000] TCP: Hash tables configured (established 512 bind 512)
[    0.380000] TCP: reno registered
[    0.380000] UDP hash table entries: 256 (order: 0, 4096 bytes)
[    0.390000] UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
[    0.400000] NET: Registered protocol family 1
[    0.400000] PCI: CLS 0 bytes, default 32
[    0.420000] squashfs: version 4.0 (2009/01/31) Phillip Lougher
[    0.420000] jffs2: version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006 Red Hat, Inc.
[    0.430000] msgmni has been set to 56
[    0.440000] io scheduler noop registered
[    0.440000] io scheduler deadline registered (default)
[    0.440000] Serial: 8250/16550 driver, 1 ports, IRQ sharing disabled
[    0.450000] ar933x-uart: ttyATH0 at MMIO 0x18020000 (irq = 11) is a AR933X UART
[    0.460000] console [ttyATH0] enabled, bootconsole disabled
[    0.470000] ath79-spi ath79-spi: master is unqueued, this is deprecated
[    0.480000] m25p80 spi0.0: found en25q32b, expected m25p80
[    0.480000] m25p80 spi0.0: en25q32b (4096 Kbytes)
[    0.490000] 5 tp-link partitions found on MTD device spi0.0
[    0.490000] Creating 5 MTD partitions on &quot;spi0.0&quot;:
[    0.500000] 0x000000000000-0x000000020000 : &quot;u-boot&quot;
[    0.500000] 0x000000020000-0x0000001186cc : &quot;kernel&quot;
[    0.510000] mtd: partition &quot;kernel&quot; must either start or end on erase block boundary or be smaller than an erase block -- forcing read-only
[    0.520000] 0x0000001186cc-0x0000003f0000 : &quot;rootfs&quot;
[    0.530000] mtd: partition &quot;rootfs&quot; must either start or end on erase block boundary or be smaller than an erase block -- forcing read-only
[    0.540000] mtd: partition &quot;rootfs&quot; set to be root filesystem
[    0.540000] mtd: partition &quot;rootfs_data&quot; created automatically, ofs=0x2d0000, len=0x120000
[    0.550000] 0x0000002d0000-0x0000003f0000 : &quot;rootfs_data&quot;
[    0.560000] 0x0000003f0000-0x000000400000 : &quot;art&quot;
[    0.560000] 0x000000020000-0x0000003f0000 : &quot;firmware&quot;
[    0.590000] libphy: ag71xx_mdio: probed
[    0.590000] eth0: Atheros AG71xx at 0xb9000000, irq 4, mode:MII
[    1.140000] ag71xx ag71xx.0 eth0: connected to PHY at ag71xx-mdio.1:04 [uid=004dd041, driver=Generic PHY]
[    1.150000] TCP: cubic registered
[    1.160000] NET: Registered protocol family 17
[    1.160000] 8021q: 802.1Q VLAN Support v1.8
[    1.170000] VFS: Mounted root (squashfs filesystem) readonly on device 31:2.
[    1.180000] Freeing unused kernel memory: 220K (80319000 - 80350000)
[    3.130000] usbcore: registered new interface driver usbfs
[    3.130000] usbcore: registered new interface driver hub
[    3.140000] usbcore: registered new device driver usb
[    3.370000] ehci_hcd: USB 2.0 &#039;Enhanced&#039; Host Controller (EHCI) Driver
[    3.370000] ehci-platform: EHCI generic platform driver
[    3.380000] ehci-platform ehci-platform: EHCI Host Controller
[    3.380000] ehci-platform ehci-platform: new USB bus registered, assigned bus number 1
[    3.390000] ehci-platform ehci-platform: irq 3, io mem 0x1b000000
[    3.420000] ehci-platform ehci-platform: USB 2.0 started, EHCI 1.00
[    3.420000] hub 1-0:1.0: USB hub found
[    3.420000] hub 1-0:1.0: 1 port detected
[    3.490000] ohci_hcd: USB 1.1 &#039;Open&#039; Host Controller (OHCI) Driver
[    6.190000] eth0: link up (100Mbps/Full duplex)
[    7.300000] eth0: link down
[    8.540000] Loading modules backported from Linux version master-2013-06-27-0-gdcfa6d5
[    8.550000] Backport generated by backports.git backports-20130617-4-ge3220f5
[    8.600000] cfg80211: Calling CRDA to update world regulatory domain
[    8.630000] cfg80211: World regulatory domain updated:
[    8.630000] cfg80211:   (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp)
[    8.640000] cfg80211:   (2402000 KHz - 2472000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
[    8.650000] cfg80211:   (2457000 KHz - 2482000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
[    8.650000] cfg80211:   (2474000 KHz - 2494000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
[    8.660000] cfg80211:   (5170000 KHz - 5250000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
[    8.670000] cfg80211:   (5735000 KHz - 5835000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
[    8.910000] NET: Registered protocol family 10
[    9.420000] ath: EEPROM regdomain: 0x0
[    9.420000] ath: EEPROM indicates default country code should be used
[    9.420000] ath: doing EEPROM country-&gt;regdmn map search
[    9.420000] ath: country maps to regdmn code: 0x3a
[    9.420000] ath: Country alpha2 being used: US
[    9.420000] ath: Regpair used: 0x3a
[    9.420000] ieee80211 phy0: Selected rate control algorithm &#039;minstrel_ht&#039;
[    9.430000] cfg80211: Calling CRDA for country: US
[    9.440000] cfg80211: Regulatory domain changed to country: US
[    9.440000] cfg80211:   (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp)
[    9.450000] cfg80211:   (2402000 KHz - 2472000 KHz @ 40000 KHz), (300 mBi, 2700 mBm)
[    9.460000] cfg80211:   (5170000 KHz - 5250000 KHz @ 40000 KHz), (300 mBi, 1700 mBm)
[    9.460000] cfg80211:   (5250000 KHz - 5330000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
[    9.470000] cfg80211:   (5490000 KHz - 5600000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
[    9.480000] cfg80211:   (5650000 KHz - 5710000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
[    9.490000] cfg80211:   (5735000 KHz - 5835000 KHz @ 40000 KHz), (300 mBi, 3000 mBm)
[    9.510000] ieee80211 phy0: Atheros AR9330 Rev:1 mem=0xb8100000, irq=2
[    9.630000] PPP generic driver version 2.4.2
[    9.890000] ip_tables: (C) 2000-2006 Netfilter Core Team
[    9.920000] xt_time: kernel timezone is -0000
[   10.080000] NET: Registered protocol family 24
[   10.090000] nf_conntrack version 0.5.0 (454 buckets, 1816 max)
[   10.460000] ip6_tables: (C) 2000-2006 Netfilter Core Team
[   15.730000] IPv6: ADDRCONF(NETDEV_UP): eth0: link is not ready
[   15.730000] device eth0 entered promiscuous mode
[   15.740000] IPv6: ADDRCONF(NETDEV_UP): br-lan: link is not ready
[   16.340000] eth0: link up (100Mbps/Full duplex)
[   16.340000] br-lan: port 1(eth0) entered forwarding state
[   16.350000] br-lan: port 1(eth0) entered forwarding state
[   16.350000] IPv6: ADDRCONF(NETDEV_CHANGE): eth0: link becomes ready
[   16.360000] IPv6: ADDRCONF(NETDEV_CHANGE): br-lan: link becomes ready
[   18.350000] br-lan: port 1(eth0) entered forwarding state
[   27.100000] jffs2_scan_eraseblock(): End of filesystem marker found at 0x0
[   27.120000] jffs2_build_filesystem(): unlocking the mtd device... done.
[   27.120000] jffs2_build_filesystem(): erasing all blocks after the end marker... done.
[   33.830000] jffs2: notice: (843) jffs2_build_xattr_subsystem: complete building xattr subsystem, 0 of xdatum (0 unchecked, 0 orphan) and 0 of xref (0 dead, 0 orphan) found.
[  112.350000] eth0: link down
[  112.350000] br-lan: port 1(eth0) entered disabled state
[  119.350000] eth0: link up (100Mbps/Full duplex)
[  119.350000] br-lan: port 1(eth0) entered forwarding state
[  119.360000] br-lan: port 1(eth0) entered forwarding state
[  121.360000] br-lan: port 1(eth0) entered forwarding state
[  143.350000] eth0: link down
[  143.350000] br-lan: port 1(eth0) entered disabled state
[  193.350000] eth0: link up (100Mbps/Full duplex)
[  193.350000] br-lan: port 1(eth0) entered forwarding state
[  193.360000] br-lan: port 1(eth0) entered forwarding state
[  195.360000] br-lan: port 1(eth0) entered forwarding state</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p212284">
				<div class="post-metadata">
					<div class="post-num">Post #32</div>
					<div class="post-author">ThatGuy</div>
					<div class="post-datetime">
						13 Sep 2013, 19:16					</div>
				</div>
				<div class="post-content content">
					<p>Support for MR3040 v2 added in <a href="https://dev.openwrt.org/changeset/37964">37964</a>.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p212288">
				<div class="post-metadata">
					<div class="post-num">Post #33</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						13 Sep 2013, 19:35					</div>
				</div>
				<div class="post-content content">
					<p>is the HW switch supported?</p><p><a href="https://forum.openwrt.org/viewtopic.php?pid=209683#p209683">https://forum.openwrt.org/viewtopic.php … 83#p209683</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p212307">
				<div class="post-metadata">
					<div class="post-num">Post #34</div>
					<div class="post-author">ThatGuy</div>
					<div class="post-datetime">
						14 Sep 2013, 00:38					</div>
				</div>
				<div class="post-content content">
					<p>Not yet, but I&#039;m working on it as we speak <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p212515">
				<div class="post-metadata">
					<div class="post-num">Post #35</div>
					<div class="post-author">phantom_83</div>
					<div class="post-datetime">
						16 Sep 2013, 17:53					</div>
				</div>
				<div class="post-content content">
					<p>hello! on the site of openwrt I read that is the firmware for version 2 of mr3040 is now also valid for version 2.1.<br />all true? could you tell me how can I kindly proceed to download and install?<br />thank you!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p212538">
				<div class="post-metadata">
					<div class="post-num">Post #36</div>
					<div class="post-author">ThatGuy</div>
					<div class="post-datetime">
						16 Sep 2013, 21:59					</div>
				</div>
				<div class="post-content content">
					<p>Yes, that&#039;s right. If you plan on flashing the firmware image via the OEM web interface, you should download the following snapshot image:<br /><a href="http://downloads.openwrt.org/snapshots/trunk/ar71xx/openwrt-ar71xx-generic-tl-mr3040-v2-squashfs-factory.bin">http://downloads.openwrt.org/snapshots/ … actory.bin</a></p><p>The snapshot images were just made available today, so that&#039;s probably the reason why you couldn&#039;t find them before.</p>											<p class="post-edited">(Last edited by <strong>ThatGuy</strong> on 17 Sep 2013, 00:50)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p212550">
				<div class="post-metadata">
					<div class="post-num">Post #37</div>
					<div class="post-author">ThatGuy</div>
					<div class="post-datetime">
						17 Sep 2013, 00:52					</div>
				</div>
				<div class="post-content content">
					<p>I just updated the wiki with v2 installation instructions (essentially the same as for v1):<br /><a href="http://wiki.openwrt.org/toh/tp-link/tl-mr3040#version.2.x">http://wiki.openwrt.org/toh/tp-link/tl- … ersion.2.x</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p213221">
				<div class="post-metadata">
					<div class="post-num">Post #38</div>
					<div class="post-author">aberson</div>
					<div class="post-datetime">
						26 Sep 2013, 20:38					</div>
				</div>
				<div class="post-content content">
					<p>Hi everyone</p><p>Has anybody gotten a 3G aircard working alongside Luci on this or similar router?&nbsp; I run out of space trying to install all the 3gdongle modules.&nbsp; I presume Luci is a space hog, but for my use-case I require some sort of web UI.&nbsp; Is there any way to free up some space elsewhere?</p><br /><br /><p>Here&#039;s some background:</p><p>Complete OpenWrt newbie.&nbsp; MR3040 stock firmware doesn&#039;t support my aircard (Sprint Franklin Wireless U301), so looked to OpenWrt.</p><p>Received my MR3040 v2.1 and thanks to everyone who contributed (especially nebbia88 and ThatGuy), got OpenWrt loaded using the image provided in this thread (and now on the wiki).&nbsp; Then I got through getting the device online (good notes here: <a href="https://forum.openwrt.org/viewtopic.php?id=38122)">https://forum.openwrt.org/viewtopic.php?id=38122)</a> so I could install Luci easily.</p><p>After a clean install plus Luci, the software page says I have ~180KB free space.&nbsp; At the time that opkg reports I am out of space, it&#039;s down to ~70KB.&nbsp; So I guess really I only had ~110KB free to start with (?).&nbsp; As I install each of the packages mentioned on the 3gdongle page (<a href="http://wiki.openwrt.org/doc/recipes/3gdongle#required.packages">http://wiki.openwrt.org/doc/recipes/3gd … d.packages</a>) it eventually runs out when trying to install usb-modeswitch.&nbsp; </p><p>It seems that those modules will need about 120KB free, so it *might* be within reach.</p><br /><p>Thanks!<br />Adam</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p213232">
				<div class="post-metadata">
					<div class="post-num">Post #39</div>
					<div class="post-author">ThatGuy</div>
					<div class="post-datetime">
						26 Sep 2013, 22:38					</div>
				</div>
				<div class="post-content content">
					<p>So stoked to hear that my contribution helped someone <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Anyway, maybe try leaving out usb-modeswitch-data? You could then just manually create a minimal set of files needed for your particular 3g dongle. You&#039;ll probably have to look through the <a href="http://www.draisberghof.de/usb_modeswitch/#usage">usb-modeswitch documentation</a> to find out which files to create, though. Also, looking at <a href="http://www.draisberghof.de/usb_modeswitch/device_reference.txt">http://www.draisberghof.de/usb_modeswit … erence.txt</a> it doesn&#039;t look like the U301 is supported at the moment, but it shouldn&#039;t be too hard to add support for it (take a look at <a href="http://www.draisberghof.de/usb_modeswitch/#contrib">http://www.draisberghof.de/usb_modeswitch/#contrib</a>). And don&#039;t forget to post the U310 device info for the usb_modeswitch developers at <a href="http://www.draisberghof.de/usb_modeswitch/bb/">http://www.draisberghof.de/usb_modeswitch/bb/</a> <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>By the way, I managed to get the hardware slide switch working. I submitted the patches a couple of days ago, so it should just be a matter of time before a developer commits them to trunk.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p213234">
				<div class="post-metadata">
					<div class="post-num">Post #40</div>
					<div class="post-author">ThatGuy</div>
					<div class="post-datetime">
						26 Sep 2013, 22:42					</div>
				</div>
				<div class="post-content content">
					<p>Scratch that, they already commited the changes:<br /><a href="https://dev.openwrt.org/changeset/38190">https://dev.openwrt.org/changeset/38190</a><br /><a href="https://dev.openwrt.org/changeset/38191">https://dev.openwrt.org/changeset/38191</a><br /><a href="https://dev.openwrt.org/changeset/38192">https://dev.openwrt.org/changeset/38192</a></p>											<p class="post-edited">(Last edited by <strong>ThatGuy</strong> on 26 Sep 2013, 22:46)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p213241">
				<div class="post-metadata">
					<div class="post-num">Post #41</div>
					<div class="post-author">aberson</div>
					<div class="post-datetime">
						26 Sep 2013, 23:43					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>ThatGuy wrote:</cite><blockquote><p>Also, looking at <a href="http://www.draisberghof.de/usb_modeswitch/device_reference.txt">http://www.draisberghof.de/usb_modeswit … erence.txt</a> it doesn&#039;t look like the U301 is supported at the moment</p></blockquote></div><p>Wow - some great links in there, thanks!&nbsp; Maybe I should just upgrade my aircard instead <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>After further searching, this particular aircard may not need modeswitch for 3G, it might only need it for 4G.&nbsp; Does OpenWrt support 4G?&nbsp; &nbsp;<a href="http://www.draisberghof.de/usb_modeswitch/bb/viewtopic.php?p=4017#p4017">http://www.draisberghof.de/usb_modeswit … 4017#p4017</a>&nbsp; &nbsp; (Even if it does need modeswitch, the U210 and U600 use the same code, so the U301 might also)</p><p>I&#039;m not sure the other 3gdongle stuff will fit without usbmodeswitch, but I&#039;ll give it a try.&nbsp; I was hoping for this router to support a wide range of devices without much effort, so leaving out usbmodeswitch might not be great for that goal - seems like there&#039;d be hundreds of models unavailable to me.&nbsp; TPLink&#039;s factory firmware only supports *11* devices from US carriers anyway, so if I can&#039;t get usbmodeswitch I might need to go for a higher end device like Pepwave and ebay this MR3040 if I can&#039;t return it.</p><br /><p>--</p><p>Will the hardware switch do anything by default?&nbsp; Or it would just be readable for customized uses like a GPIO?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p213245">
				<div class="post-metadata">
					<div class="post-num">Post #42</div>
					<div class="post-author">aberson</div>
					<div class="post-datetime">
						27 Sep 2013, 00:52					</div>
				</div>
				<div class="post-content content">
					<p>Looks like I&#039;m stuck;&nbsp; the kmod-usb-serial-* modules all refuse to install now b/c my kernel version doesn&#039;t match.&nbsp; The modules all seem to have been updated today.&nbsp; (sorry if I&#039;m just ignorant and this a common thing)</p><p>Does this mean I need to install this -sysupgrade file, which was just built 2 hours ago? <a href="http://downloads.openwrt.org/snapshots/trunk/ar71xx/openwrt-ar71xx-generic-tl-mr3040-v2-squashfs-sysupgrade.bin">http://downloads.openwrt.org/snapshots/ … pgrade.bin</a></p><p>(In general, I presume the -factory files get installed over the factory firmware and the -sysupgrade upgrade from previous openwrt versions?)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p213248">
				<div class="post-metadata">
					<div class="post-num">Post #43</div>
					<div class="post-author">ThatGuy</div>
					<div class="post-datetime">
						27 Sep 2013, 01:06					</div>
				</div>
				<div class="post-content content">
					<p>Don&#039;t buy a new dongle just yet, part of the fun is getting these things to work! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> In general, OpenWrt should support anything the Linux kernel supports.</p><p>You&#039;re right, if you&#039;re planning on supporting lots of different dongles, it wouldn&#039;t make sense not to install the usb-modeswitch-data package.</p><p>Yes, you have to install the new sysupgrade image for the kernel modules to work, but that only takes a couple minutes. Sysupgrade keeps your settings, but you&#039;ll have to reinstall any packages you&#039;ve installed.<br /><a href="http://wiki.openwrt.org/doc/howto/generic.sysupgrade#luci.web.upgrade.process">http://wiki.openwrt.org/doc/howto/gener … de.process</a></p><p>And you&#039;re right about the factory and sysupgrade image types.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p213251">
				<div class="post-metadata">
					<div class="post-num">Post #44</div>
					<div class="post-author">ThatGuy</div>
					<div class="post-datetime">
						27 Sep 2013, 01:21					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>aberson wrote:</cite><blockquote><p>Will the hardware switch do anything by default?&nbsp; Or it would just be readable for customized uses like a GPIO?</p></blockquote></div><p>It won&#039;t do anything by default. You&#039;ll have to create the file /etc/hotplug.d/button/buttons and then add whatever functionality you want.</p><p>See <a href="http://wiki.openwrt.org/doc/howto/hardware.button">http://wiki.openwrt.org/doc/howto/hardware.button</a> and <a href="https://forum.openwrt.org/viewtopic.php?id=42446">https://forum.openwrt.org/viewtopic.php?id=42446</a> for inspiration and instructions.</p><p><a href="http://wiki.openwrt.org/toh/tp-link/tl-mr3040#hardware.slide.switch.v2">http://wiki.openwrt.org/toh/tp-link/tl- … .switch.v2</a></p>											<p class="post-edited">(Last edited by <strong>ThatGuy</strong> on 27 Sep 2013, 11:10)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p213270">
				<div class="post-metadata">
					<div class="post-num">Post #45</div>
					<div class="post-author">aberson</div>
					<div class="post-datetime">
						27 Sep 2013, 08:08					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>ThatGuy wrote:</cite><blockquote><p>Don&#039;t buy a new dongle just yet, part of the fun is getting these things to work! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></blockquote></div><p>In general I agree, but for this particular application I need something less fidgety. </p><p>Good news though - I got the Sprint Franklin Wireless U301 3G dongle working with Luci!&nbsp; Speeds were ~0.8Mbps up/down.&nbsp; I should compare that to the native sprint software, but seems low.</p><br /><p>Here&#039;s how I did it: </p><p>After upgrading to the new kernel, I installed modules one by one in this order:&nbsp; chat, comgt, Kmod-usb-serial, Kmod-usb-serial-wwan, Kmod-usb-serial-option, luci-proto-3g.&nbsp; All of that combined only dropped my available space by 32KB.</p><p>At that point I was able to create a new 3g interface using /dev/ttyUSB1, disable my existing wan interface, and watch all the AT commands work via logread.&nbsp; I then tried adding &quot;+4gmode=1&quot; to the ATZ command in my evdo chat script, and while it did enable 4g mode (seemingly added another USB device per dmesg), I couldn&#039;t come up with the right command to actually connect when in 4G mode.</p><p>Moving back to 3G (+4gmode=0), I tried installing the usb-modeswitch stuff and this time it actually fit (another 72KB).&nbsp; Then I tried adding sdparm and that&#039;s where I ran out of space.&nbsp; I couldn&#039;t get 3G to connect at that point until I removed usb-modeswitch, etc.&nbsp; Maybe just coincidence or due to the leftover garbage from the failed install of sdparm still making me low on space.</p><p>Anyway, I am just documenting the above for anyone who might be helped by my experience.&nbsp; Given how fidgety this all is, especially that each carrier has different phone numbers, apn&#039;s, passwords, etc, I&#039;m probably going to attempt to flash stock firmware and reluctantly/sadly return or sell this cool little router (wish there was a way to reflash stock without opening and ttl serial).</p><br /><p>User forums are super valuable for stuff like this, and I&#039;m very grateful for the assistance!</p><p>Adam</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p213282">
				<div class="post-metadata">
					<div class="post-num">Post #46</div>
					<div class="post-author">ThatGuy</div>
					<div class="post-datetime">
						27 Sep 2013, 11:19					</div>
				</div>
				<div class="post-content content">
					<p>Oh, that&#039;s too bad... Maybe keep it and turn it into a PirateBox or a LibraryBox? <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p><a href="http://daviddarts.com/piratebox-diy-openwrt/">http://daviddarts.com/piratebox-diy-openwrt/</a><br /><a href="http://librarybox.us/">http://librarybox.us/</a></p><p>Mine&#039;s running LibraryBox at the moment.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p213399">
				<div class="post-metadata">
					<div class="post-num">Post #47</div>
					<div class="post-author">aberson</div>
					<div class="post-datetime">
						28 Sep 2013, 21:22					</div>
				</div>
				<div class="post-content content">
					<p>It&#039;s not on the wiki, and maybe people already knew this, but just to spread the word - it IS possible to re-flash factory firmware for the MR3040 via the mtd command on the SSH terminal.&nbsp; And likely the same for most of the other tp-links.&nbsp; You only need the serial console if you brick it.</p><p>BUT, the firmware downloaded from tp-link may need to have a bit chopped off before it will flash properly via mtd.&nbsp; Instructions here:&nbsp; <a href="https://forum.openwrt.org/viewtopic.php?pid=213398#p213398">https://forum.openwrt.org/viewtopic.php … 98#p213398</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p213409">
				<div class="post-metadata">
					<div class="post-num">Post #48</div>
					<div class="post-author">RogueDog</div>
					<div class="post-datetime">
						29 Sep 2013, 00:36					</div>
				</div>
				<div class="post-content content">
					<p>Thanks aberson! Been reading everything I can, but it scared me that I needed serial to return to factory. Glad you mentioned that.</p><p>Can any sysupgrade be flashed once you get OpenWRT installed? Like can I go from a Stable sysupgrade to a Trunk sysupgrade, and back again etc... to see what I like the most?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p213410">
				<div class="post-metadata">
					<div class="post-num">Post #49</div>
					<div class="post-author">aberson</div>
					<div class="post-datetime">
						29 Sep 2013, 00:56					</div>
				</div>
				<div class="post-content content">
					<p>You&#039;re very welcome!</p><div class="quotebox"><cite>RogueDog wrote:</cite><blockquote><p>Can any sysupgrade be flashed once you get OpenWRT installed? Like can I go from a Stable sysupgrade to a Trunk sysupgrade, and back again etc... to see what I like the most?</p></blockquote></div><p>Somebody with more experience than I have should answer that, but I know that I used mtd to flash from OpenWrt to DD-WRT, then back to OpenWrt, then back to factory, so AFAIK it should be possible to flash between different OpenWrt versions too.&nbsp; (Though you can do that from the LUCI web interface too)</p><p>For extra safety, upon first boot up with the new firmware you should login and reset defaults</p>											<p class="post-edited">(Last edited by <strong>aberson</strong> on 29 Sep 2013, 00:56)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p213450">
				<div class="post-metadata">
					<div class="post-num">Post #50</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						29 Sep 2013, 17:10					</div>
				</div>
				<div class="post-content content">
					<p>here is my build, from trunk r38248<br />it should include Luci and everything you need for 3G and usb storage, but there is a little space remaining (100KB)</p><p><a href="https://www.dropbox.com/s/qwxj9jdspmf4gcj/openwrt-ar71xx-generic-tl-mr3040-v2-squashfs-factory.bin">https://www.dropbox.com/s/qwxj9jdspmf4g … actory.bin</a><br /><a href="https://www.dropbox.com/s/s2ljgvf01h1kg2n/openwrt-ar71xx-generic-tl-mr3040-v2-squashfs-sysupgrade.bin">https://www.dropbox.com/s/s2ljgvf01h1kg … pgrade.bin</a></p><br /><p>it seems to work ok on my wr703n, let me know if you have any problem.</p><p>diff of packages included against trunk:</p><div class="codebox"><pre><code>chat
comgt
kmod-fs-ext4
kmod-lib-crc16
kmod-scsi-core
kmod-scsi-generic
kmod-usb-acm
kmod-usb-net
kmod-usb-net-cdc-ether
kmod-usb-serial
kmod-usb-serial-option
kmod-usb-serial-wwan
kmod-usb-storage
libblkid
libiwinfo
libiwinfo-lua
liblua
libpthread
librt
libubus-lua
libuci-lua
libusb-1.0
libuuid
lua
luci
luci-app-firewall
luci-i18n-english
luci-lib-core
luci-lib-ipkg
luci-lib-nixio
luci-lib-sys
luci-lib-web
luci-mod-admin-core
luci-mod-admin-full
luci-proto-3g
luci-proto-core
luci-proto-ppp
luci-proto-relay
luci-sgi-cgi
luci-theme-base
luci-theme-bootstrap
relayd
sdparm
swap-utils
uhttpd
uhttpd-mod-ubus
usb-modeswitch
wireless-tools</code></pre></div>											<p class="post-edited">(Last edited by <strong>nebbia88</strong> on 29 Sep 2013, 17:11)</p>
									</div>
			</article>

			
		
						<div class="notice">
				<p>Sorry, posts 51 to 50 are missing from our archive.</p>
			</div>
		
		
	
	<div class="pagination"><div class="pagination-number">Page 2 of 4</div><nav><ul><li><a href="viewtopic.php%3Fid=43158&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li><li><a href="viewtopic.php%3Fid=43158&amp;p=3.html">3</a></li><li><a href="viewtopic.php%3Fid=43158&amp;p=4.html">4</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>