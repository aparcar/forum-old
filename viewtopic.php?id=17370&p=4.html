<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> New Broadcom BCM63xx codebase with GPL&#039;d Ethernet and USB support</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 8 Feb 2018 and 7 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 4 of 30</div><nav><ul><li><a href="viewtopic.php%3Fid=17370&amp;p=1.html">1</a></li><li><a href="viewtopic.php%3Fid=17370&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=17370&amp;p=3.html">3</a></li><li class="pagination-current"><span>4</span></li><li><a href="viewtopic.php%3Fid=17370&amp;p=5.html">5</a></li><li><a href="viewtopic.php%3Fid=17370&amp;p=6.html">6</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=17370&amp;p=30.html">30</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p76596">
				<div class="post-metadata">
					<div class="post-num">Post #76</div>
					<div class="post-author">spirit</div>
					<div class="post-datetime">
						17 Nov 2008, 16:25					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>misteroX wrote:</cite><blockquote><p>For semplicity I want to make this jtag : Unbuffered Cable, Xilinx DLC5 Cable III</p><p>Do you know if I can use &quot;HairyDairyMaid_WRT54G_Debrick_Utility_v48.zip (wrt54.exe)&quot; to send CFE.bin into my router ?</p><p>If so which is the correct memory address to send CFE.BIN into DG834GT ?</p><br /><p>Many thanks in advice.<br />MisteroX</p></blockquote></div><p>I do not own a DG834GT, so I can only give you some hints.</p><p>HairyDairyMaid&#039;s debrick utility is written for little endian CPUs ...<br />But someone wrote a patch for the SE515 (BCM6345) to do a byte-swap before flashing.<br />Take a look at <a href="http://www.mcbachmann.de/projects/openwrt/jtag">http://www.mcbachmann.de/projects/openwrt/jtag</a></p><p>./wrt54g -flash:custom /start:1fc00000 /window:1fc00000 /length:10000 /nobreak /noreset</p><p>(rename the CFE.BIN to CUSTOM.BIN before flashing).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p76597">
				<div class="post-metadata">
					<div class="post-num">Post #77</div>
					<div class="post-author">misteroX</div>
					<div class="post-datetime">
						17 Nov 2008, 16:37					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>t3l3m4k0 wrote:</cite><blockquote><p>Unpowered/unbuffered JTAG used:<br />[url=http://img82.imageshack.us/my.php?image=convjtaggp7.jpg]</p></blockquote></div><p>Thanks for this.<br />I will make jtag and I will try.</p><p>Thanks<br />MisteroX</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p76598">
				<div class="post-metadata">
					<div class="post-num">Post #78</div>
					<div class="post-author">misteroX</div>
					<div class="post-datetime">
						17 Nov 2008, 16:39					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>spirit wrote:</cite><blockquote><div class="quotebox"><cite>misteroX wrote:</cite><blockquote><p>For semplicity I want to make this jtag : Unbuffered Cable, Xilinx DLC5 Cable III</p><p>Do you know if I can use &quot;HairyDairyMaid_WRT54G_Debrick_Utility_v48.zip (wrt54.exe)&quot; to send CFE.bin into my router ?</p><p>If so which is the correct memory address to send CFE.BIN into DG834GT ?</p><br /><p>Many thanks in advice.<br />MisteroX</p></blockquote></div><p>I do not own a DG834GT, so I can only give you some hints.</p><p>HairyDairyMaid&#039;s debrick utility is written for little endian CPUs ...<br />But someone wrote a patch for the SE515 (BCM6345) to do a byte-swap before flashing.<br />Take a look at <a href="http://www.mcbachmann.de/projects/openwrt/jtag">http://www.mcbachmann.de/projects/openwrt/jtag</a></p><p>./wrt54g -flash:custom /start:1fc00000 /window:1fc00000 /length:10000 /nobreak /noreset</p><p>(rename the CFE.BIN to CUSTOM.BIN before flashing).</p></blockquote></div><p>Thanks, I will try.</p><p>MisteroX</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p76602">
				<div class="post-metadata">
					<div class="post-num">Post #79</div>
					<div class="post-author">Zven</div>
					<div class="post-datetime">
						17 Nov 2008, 17:33					</div>
				</div>
				<div class="post-content content">
					<p>Hi.</p><div class="quotebox"><cite>lamaatje wrote:</cite><blockquote><p>I know what the cause is. The image build process is:<br />create compressed lzma.cfe kernel <br />create rootfs<br />merge kernel+rootfs and tag image<br />add zero&#039;s until image is 64k fold<br />add 0xdeadc0de<br />add zero&#039;s until image is 64k fold<br />add 0xdeadc0de</p><p>In the tagging process 3 CRC are calculated: kernel, rootfs and total<br />since the image is manipulated afterwards with dd, crc of total is not correct and image is no considered valid!</p></blockquote></div><p>Maybe it&#039;s another problem I encountered: at the moment the calculated CRCs are not fully compatible with every CFE. That means CRCs are calculated, but not correct, which is ignored by some versions. For the Siemens SE515 I created a patch [1] against the imagetag.c for OpenWrt rev. 12259 which fixes these issue but needs testing on other devices and newer revisions.</p><p>You can verify the generated image with the imginfo [2] tool, which also works with the original firmware (the checked file must be named &quot;firmware.bin&quot;).</p><p>Bye<br />&nbsp; Sven</p><p>[1] <a href="http://www.mcbachmann.de/projects/openwrt/openwrt-patches/rev_12259/">http://www.mcbachmann.de/projects/openw … rev_12259/</a><br />[2] <a href="http://www.mcbachmann.de/projects/openwrt/openwrt-patches/rev_12259/imginfo/">http://www.mcbachmann.de/projects/openw … 9/imginfo/</a></p>											<p class="post-edited">(Last edited by <strong>Zven</strong> on 17 Nov 2008, 17:34)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p76635">
				<div class="post-metadata">
					<div class="post-num">Post #80</div>
					<div class="post-author">t3l3m4k0</div>
					<div class="post-datetime">
						18 Nov 2008, 00:28					</div>
				</div>
				<div class="post-content content">
					<p>@Zven,<br />first test on 96348GW-11 board, but no works fine.<br />1.-image loads, seems to be fine, and writes flash memory<br />2.-when system reboot, CFE says image corrupted, bad descompression.</p><p>i will try like se515 board.<br />Thnx for your work</p><br /><p>also fails with values<br />&nbsp; &nbsp; if (!strcmp(&quot;96348GW-11&quot;, tag.boardid)) {<br />&nbsp; &nbsp; &nbsp; &nbsp; tag.headerver = 0x32;<br />&nbsp; &nbsp; &nbsp; &nbsp; tag.payloadcrc = htonl(crc);</p><p>how did you find last values?</p>											<p class="post-edited">(Last edited by <strong>t3l3m4k0</strong> on 18 Nov 2008, 00:52)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p76647">
				<div class="post-metadata">
					<div class="post-num">Post #81</div>
					<div class="post-author">frikimaster</div>
					<div class="post-datetime">
						18 Nov 2008, 04:22					</div>
				</div>
				<div class="post-content content">
					<p>Hi guys!</p><p>I have a &quot;Comtrend CT-536/1+&quot; (bcm6348).</p><p>After a bit of hacking I got a shell on the ct-536...</p><p>Here some info about cpu:<br /></p><div class="codebox"><pre><code># cat /proc/cpuinfo
system type             : 96348GW-11
processor               : 0
cpu model               : BCM6348 V0.7
BogoMIPS                : 255.59
wait instruction        : no
microsecond timers      : yes
tlb_entries             : 32
extra interrupt vector  : no
hardware watchpoint     : no
VCED exceptions         : not available
VCEI exceptions         : not available</code></pre></div><p>...and wireless device:</p><div class="codebox"><pre><code># wlctl revinfo
vendorid: 0x14e4
deviceid: 0x4318
radiorev: 0x82050000
chipnum: 0x4318
chiprev: 0x2
corerev: 0x9
boardid: 0x449
boardvendor: 0x14e4
boardrev: 0x46
driverrev: 0x35a0f00
ucoderev: 0x1220098
bus: 0x1</code></pre></div><p>I&#039;m trying to install kamikaze firmware on it, but I have only one adsl router and I don&#039;t wan&#039;t to brick it :-P</p><div class="codebox"><pre><code>svn co https://svn.openwrt.org/openwrt/trunk/
svn co https://svn.openwrt.org/openwrt/packages
cd ..
ln -s ../../packages/*/* .
cd ..
make menuconfig &lt;= Here I select BCM63xx and Broadcom wireless (any think else??)
make</code></pre></div><p>What&#039;s the next steep?<br />Will it works? (ok, i&#039;ll try any way)</p><p>Tnks!</p><p>PS: Sorry if the post is too large!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p76657">
				<div class="post-metadata">
					<div class="post-num">Post #82</div>
					<div class="post-author">spirit</div>
					<div class="post-datetime">
						18 Nov 2008, 10:03					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>frikimaster wrote:</cite><blockquote><p>I&#039;m trying to install kamikaze firmware on it, but I have only one adsl router and I don&#039;t wan&#039;t to brick it :-P</p></blockquote></div><p>The current codeset for the bcm63xx is still very limited ...<br />I.e. no support for WLAN and DSL so far.</p><p>So you better keep our hands off!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p76660">
				<div class="post-metadata">
					<div class="post-num">Post #83</div>
					<div class="post-author">frikimaster</div>
					<div class="post-datetime">
						18 Nov 2008, 10:35					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>spirit wrote:</cite><blockquote><div class="quotebox"><cite>frikimaster wrote:</cite><blockquote><p>I&#039;m trying to install kamikaze firmware on it, but I have only one adsl router and I don&#039;t wan&#039;t to brick it :-P</p></blockquote></div><p>The current codeset for the bcm63xx is still very limited ...<br />I.e. no support for WLAN and DSL so far.</p><p>So you better keep our hands off!</p></blockquote></div><p>OK! I&#039;ll wait. Tnks :-)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p76664">
				<div class="post-metadata">
					<div class="post-num">Post #84</div>
					<div class="post-author">Zven</div>
					<div class="post-datetime">
						18 Nov 2008, 13:03					</div>
				</div>
				<div class="post-content content">
					<p>Hi.</p><div class="quotebox"><cite>t3l3m4k0 wrote:</cite><blockquote><p>@Zven,<br />first test on 96348GW-11 board, but no works fine.<br />1.-image loads, seems to be fine, and writes flash memory<br />2.-when system reboot, CFE says image corrupted, bad descompression.</p><p>i will try like se515 board.<br />Thnx for your work</p><br /><p>also fails with values<br />&nbsp; &nbsp; if (!strcmp(&quot;96348GW-11&quot;, tag.boardid)) {<br />&nbsp; &nbsp; &nbsp; &nbsp; tag.headerver = 0x32;<br />&nbsp; &nbsp; &nbsp; &nbsp; tag.payloadcrc = htonl(crc);</p><p>how did you find last values?</p></blockquote></div><p>I created a walkthrough for the SE515, you can view it here [1] (I think you just used the &quot;f&quot; command in CFE instead of the &quot;flashimage&quot;). I got the header version from the original firmware. Just download the imginfo tool, rename the original firmware to firmware.bin and start it. The output should look like:</p><div class="quotebox"><blockquote><p>Tag Version: &#039;6&nbsp; &nbsp;&#039;<br />BCM Magic 1: &#039;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RTA770BW&#039;<br />BCM Magic 2: &#039;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RTA770BW&#039;<br />Chip ID&nbsp; &nbsp; : &#039;&nbsp; &nbsp; &nbsp; RTA770BW&#039;<br />Board ID&nbsp; &nbsp;: &#039;RTA770BW&nbsp; &nbsp; &nbsp; &nbsp; &#039;<br />Big Endian : &#039;1 &#039;<br />Image Len&nbsp; : &#039;3250334&#039;<br />CFE Addr&nbsp; &nbsp;: &#039;0xBFC00000&#039;<br />CFE Len&nbsp; &nbsp; : &#039;0xFB9C&#039;<br />RootFS Addr: &#039;0xBFC10100&#039;<br />RootFS Len : &#039;0x286000&#039;<br />Kernel Addr: &#039;0xBFE96100&#039;<br />Kernel Len : &#039;0x83D02&#039;<br />Dual Image : &#039;&nbsp; &#039;<br />Header Ver : &#039;50&#039;<br />Header CRC : &#039;D497AE7E&#039;<br />Image CRC&nbsp; : &#039;79F0B281&#039;<br />Payload CRC: &#039;3F18A22&#039;<br />Checking CRC32...<br />Header CRC : &#039;D497AE7E&#039;<br />Image CRC&nbsp; : &#039;79F0B281&#039;<br />Payload CRC: &#039;3F18A22&#039;</p></blockquote></div><p>Please note that the length and CRC values may differ from yours, because your firmware version may be another one. As you can see, the header version is 50, which means 0x32 in hex.</p><p>Bye<br />&nbsp; Sven</p><p>[1] <a href="http://www.mcbachmann.de/projects/openwrt/openwrt-patches/rev_12259/walkthrough.txt">http://www.mcbachmann.de/projects/openw … hrough.txt</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p76776">
				<div class="post-metadata">
					<div class="post-num">Post #85</div>
					<div class="post-author">Wilmer</div>
					<div class="post-datetime">
						20 Nov 2008, 02:15					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m glad to see open source drivers appearing for this platform. So far the closed source drivers were acceptable, but this weekend I got annoyed when I realised that with this closed source driver, netconsole won&#039;t work (and I can&#039;t get any serial connection either). :-(</p><p>Anyway, right now I bricked my router (DG834Gv4). I see I&#039;m not the only one with this problem though; misteroX, have you had any luck yet? Mine seems to be in a bad enough state that even restoring CFE via JTAG doesn&#039;t make it go. I just tried again after fully erasing all flash contents, even. Tomorrow I will try a *full* reflash over JTAG, it&#039;s too late to try that now. Has anyone else had the problem with this platform that suddenly the thing boots with fast blinking LEDs, and even upgrades using raw Ethernet frames don&#039;t work anymore?</p><p>Also, can I assume that the first 64 KBytes of a firmware image is indeed a suitable CFE.BIN? Or is it actually different? I have vague memories of someone mentioning that things like the router&#039;s MAC address are encoded in it, for example. Could this be the reason my router doesn&#039;t want to boot from it?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p76777">
				<div class="post-metadata">
					<div class="post-num">Post #86</div>
					<div class="post-author">Wodin</div>
					<div class="post-datetime">
						20 Nov 2008, 06:21					</div>
				</div>
				<div class="post-content content">
					<p>No, OpenWrt does not include CFE. In general you are not supposed to touch the boot loader. OpenWrt is just the kernel and root filesystem.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p76778">
				<div class="post-metadata">
					<div class="post-num">Post #87</div>
					<div class="post-author">kd8ikt</div>
					<div class="post-datetime">
						20 Nov 2008, 06:34					</div>
				</div>
				<div class="post-content content">
					<p>does this mean we can get netbsd on it?</p><br /><p>this is not the longest thread in the world, this is just a tribute</p>											<p class="post-edited">(Last edited by <strong>kd8ikt</strong> on 20 Nov 2008, 11:57)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p76782">
				<div class="post-metadata">
					<div class="post-num">Post #88</div>
					<div class="post-author">misteroX</div>
					<div class="post-datetime">
						20 Nov 2008, 10:21					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Wilmer wrote:</cite><blockquote><p>I&#039;m glad to see open source drivers appearing for this platform. So far the closed source drivers were acceptable, but this weekend I got annoyed when I realised that with this closed source driver, netconsole won&#039;t work (and I can&#039;t get any serial connection either). :-(</p><p>Anyway, right now I bricked my router (DG834Gv4). I see I&#039;m not the only one with this problem though; misteroX, have you had any luck yet? Mine seems to be in a bad enough state that even restoring CFE via JTAG doesn&#039;t make it go. I just tried again after fully erasing all flash contents, even. Tomorrow I will try a *full* reflash over JTAG, it&#039;s too late to try that now. Has anyone else had the problem with this platform that suddenly the thing boots with fast blinking LEDs, and even upgrades using raw Ethernet frames don&#039;t work anymore?</p><p>Also, can I assume that the first 64 KBytes of a firmware image is indeed a suitable CFE.BIN? Or is it actually different? I have vague memories of someone mentioning that things like the router&#039;s MAC address are encoded in it, for example. Could this be the reason my router doesn&#039;t want to boot from it?</p></blockquote></div><p>Hi Wilmer,<br />nowadays a do not ever made any try about jtag for my router.<br />You will wait until I will buy a some new components for jtag.</p><p>By<br />MisteroX</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p76785">
				<div class="post-metadata">
					<div class="post-num">Post #89</div>
					<div class="post-author">Wilmer</div>
					<div class="post-datetime">
						20 Nov 2008, 11:15					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Wodin wrote:</cite><blockquote><p>No, OpenWrt does not include CFE. In general you are not supposed to touch the boot loader. OpenWrt is just the kernel and root filesystem.</p></blockquote></div><p>Yes, most definitely. I wouldn&#039;t *want* it to touch CFE without a good reason. Still, my router somehow got itself into a very bad state (I blame the firmware flashing tool in the web interface) and it may be a corrupted CFE. I&#039;d be really glad if someone could give me his/her CFE that is known to work...</p><p>How portable is the CFE code? From device to device and router manufacturer to manufacturer, as long as it&#039;s the same CPU and flash chip?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p76788">
				<div class="post-metadata">
					<div class="post-num">Post #90</div>
					<div class="post-author">t3l3m4k0</div>
					<div class="post-datetime">
						20 Nov 2008, 11:53					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>sblanco wrote:</cite><blockquote><p>Hi!<br />Is it done on purpose that wireless bcm43xx drivers don&#039;t compile although selecting them in the configuration?</p><p>During the compilation, I get a warning saying that kmod-net-bcm43xx doesn&#039;t compile because it&#039;s not found in kernel config, as well the package it depends on, kmod-ieee80211-softmac</p><br /><div class="codebox"><pre><code>WARNING: kmod-ieee80211-softmac is not available in the kernel config
WARNING: kmod-net-bcm43xx is not available in the kernel config</code></pre></div><p>Bye!</p></blockquote></div><p>I don&#039;t know how to compile b43 from make menuconfig, i had compiled b43 driver from make kernek make_menuconfig.<br />i not had tested much how it works, because i don&#039;t use wifi, but i permormed scannig and it returned up to 13 cells.<br />Yo must supply b43 firmware to make it in order to run, like here says:<br /><a href="http://linuxwireless.org/en/users/Drivers/b43#devicefirmware">http://linuxwireless.org/en/users/Drive … cefirmware</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p76789">
				<div class="post-metadata">
					<div class="post-num">Post #91</div>
					<div class="post-author">t3l3m4k0</div>
					<div class="post-datetime">
						20 Nov 2008, 11:55					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Wilmer wrote:</cite><blockquote><div class="quotebox"><cite>Wodin wrote:</cite><blockquote><p>No, OpenWrt does not include CFE. In general you are not supposed to touch the boot loader. OpenWrt is just the kernel and root filesystem.</p></blockquote></div><p>Yes, most definitely. I wouldn&#039;t *want* it to touch CFE without a good reason. Still, my router somehow got itself into a very bad state (I blame the firmware flashing tool in the web interface) and it may be a corrupted CFE. I&#039;d be really glad if someone could give me his/her CFE that is known to work...</p><p>How portable is the CFE code? From device to device and router manufacturer to manufacturer, as long as it&#039;s the same CPU and flash chip?</p></blockquote></div><p>every board must have a personaliced CFE, but sometimes CFE from similar boards seems to run fine</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p76790">
				<div class="post-metadata">
					<div class="post-num">Post #92</div>
					<div class="post-author">t3l3m4k0</div>
					<div class="post-datetime">
						20 Nov 2008, 12:00					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Zven wrote:</cite><blockquote><p>Hi.</p><p>I created a walkthrough for the SE515, you can view it here [1] (I think you just used the &quot;f&quot; command in CFE instead of the &quot;flashimage&quot;). I got the header version from the original firmware. Just download the imginfo tool, rename the original firmware to firmware.bin and start it. The output should look like:</p><p>...</p></blockquote></div><p>thnks Zven,<br />Yes i tried to &quot;f&quot; command&quot; and web firmware loading, and it not works.<br />&quot;flasimage&quot; command woks and worked fine to me, but i tried it to test if it loads from web firmware loader, for those don&#039;t have a serial cable connected to router.</p><p>Saludos</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p76791">
				<div class="post-metadata">
					<div class="post-num">Post #93</div>
					<div class="post-author">Wilmer</div>
					<div class="post-datetime">
						20 Nov 2008, 12:03					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>t3l3m4k0 wrote:</cite><blockquote><p>every board must have a personaliced CFE, but sometimes CFE from similar boards seems to run fine</p></blockquote></div><p>Okay, that probably explains why my first attempt at fixing my router failed. If only I had a backup... I also just realised that the portability is probably also limited by the fact that many manufacturers map their flash space in different ways.</p><p>I noticed there are some tools that can personalize images, but they all assume there&#039;s some block of ASCII text in the middle of the image, which isn&#039;t there in any CFE image I have for my router. So I&#039;m assuming that either BCM6348-based routers don&#039;t encode some system information in the bootloader or at least don&#039;t do it in ASCII anymore.</p><p>I&#039;ll go and grep the image I have for known MAC addresses and see what happens. If anyone with a DG834Gv4 (or maybe GT) could give me a dump of his/her CFE.BIN I&#039;d be very very grateful...</p>											<p class="post-edited">(Last edited by <strong>Wilmer</strong> on 20 Nov 2008, 12:04)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p76792">
				<div class="post-metadata">
					<div class="post-num">Post #94</div>
					<div class="post-author">Wilmer</div>
					<div class="post-datetime">
						20 Nov 2008, 12:34					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Wilmer wrote:</cite><blockquote><p>I noticed there are some tools that can personalize images, but they all assume there&#039;s some block of ASCII text in the middle of the image, which isn&#039;t there in any CFE image I have for my router. So I&#039;m assuming that either BCM6348-based routers don&#039;t encode some system information in the bootloader or at least don&#039;t do it in ASCII anymore.</p></blockquote></div><p>Yes, looks like it&#039;s binary now. From a hexdump:</p><div class="codebox"><pre><code>00000680  00 00 00 00 39 36 33 34  38 57 33 00 00 00 00 00  |....96348W3.....|
00000690  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 02  |................|
000006a0  00 1f 33 85 e1 6a 00 00  12 47 65 4f 00 00 00 00  |..3..j...GeO....|
000006b0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|</code></pre></div><p>00:1f:33:85:e1:6a is my router&#039;s MAC address. Not sure what the 32-bit integer after it is, but it could be a checksum. I may have to recalculate that one to make my router boot again. I just tried flashing a CFE with just these 64 bytes copied over, but most likely I&#039;ll also have to recalculate my checksum.</p><p>Interestingly, I just noticed that the router does seem to respond to ARP requests. It still thinks its MAC address is FF:FF:FF:FF:FF:FF. TFTP doesn&#039;t work right now, most likely because of that MAC address.</p><p>I&#039;ll get this fixed, I&#039;m sure now. :-)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p76842">
				<div class="post-metadata">
					<div class="post-num">Post #95</div>
					<div class="post-author">Wilmer</div>
					<div class="post-datetime">
						21 Nov 2008, 10:28					</div>
				</div>
				<div class="post-content content">
					<p>FWIW, the full flash fixed my problem. Took five hours, but it saved me waiting for two weeks getting a replacement unit (if at all). :-)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p76955">
				<div class="post-metadata">
					<div class="post-num">Post #96</div>
					<div class="post-author">misteroX</div>
					<div class="post-datetime">
						23 Nov 2008, 23:41					</div>
				</div>
				<div class="post-content content">
					<p>Hi, I restored the original netgear cfe.bin in the dg834gt with jtag. At boot time i see this:</p><div class="quotebox"><blockquote><p>CFE version 1.0.37-5.11 for BCM96348 (32bit,SP,BE)<br />Build Date: Mon Dec 31 18:50:15 CST 2007 (root@localhost.localdomain)<br />Copyright (C) 2000,2001,2002,2003 Broadcom Corporation.</p><p>Initializing Arena.<br />Initializing Devices.<br />internal_open<br />bcm6348enet: init_emac<br />Use default boot line parameters: e=192.168.1.1:ffffff00 h=192.168.1.100 g= r=f f=vmlinux i=bcm963xx_fs_kernel d=1</p><p>** Image information not found. **</p><p>CPU type 0x29107: 256MHz, Bus: 128MHz, Ref: 32MHz</p><p>Total memory used by CFE:&nbsp; 0x80401000 - 0x8051CF70 (1163120)<br />Initialized Data:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x804189B0 - 0x80419910 (3936)<br />BSS Area:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x80419910 - 0x8041AF70 (5728)<br />Local Heap:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x8041AF70 - 0x8051AF70 (1048576)<br />Stack Area:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x8051AF70 - 0x8051CF70 (8192)<br />Text (code) segment:&nbsp; &nbsp; &nbsp; &nbsp;0x80401000 - 0x804189AC (96684)<br />Boot area (physical):&nbsp; &nbsp; &nbsp; 0x0051D000 - 0x0055D000<br />Relocation Factor:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;I:00000000 - D:00000000</p><p>*** 1 Board is not initialized properly ***</p><p>Asmod... press enter to stop<br />Press:&nbsp; &lt;enter&gt; to use current value<br />&nbsp; &nbsp; &nbsp; &nbsp; &#039;-&#039; to go previous parameter<br />&nbsp; &nbsp; &nbsp; &nbsp; &#039;.&#039; to clear the current value<br />&nbsp; &nbsp; &nbsp; &nbsp; &#039;x&#039; to exit this command</p><p>Board Id Name (0-7)<br />96348R&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-------- 0<br />96348LV&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -------- 1<br />96348GW&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -------- 2<br />96348GW-10&nbsp; &nbsp; &nbsp; &nbsp;-------- 3<br />96348GW-11&nbsp; &nbsp; &nbsp; &nbsp;-------- 4<br />96348SV&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -------- 5<br />96348GW-DualDSP&nbsp; -------- 6<br />BCMCUST_01&nbsp; &nbsp; &nbsp; &nbsp;-------- 7&nbsp; &nbsp; &nbsp;:&nbsp; 3</p><p>Number of MAC Addresses (1-32)&nbsp; :&nbsp; 0&nbsp; 1<br />Base MAC Address&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :&nbsp; my MacAddress<br />Asmod... press enter to stop</p></blockquote></div><p>Even after i have inserted the required parameters, at every boot i see this.</p><p>I&#039;m unable to send something via tftp.</p><p>what can it be? </p><p>Thanks<br />MisteroX</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p76959">
				<div class="post-metadata">
					<div class="post-num">Post #97</div>
					<div class="post-author">t3l3m4k0</div>
					<div class="post-datetime">
						24 Nov 2008, 01:14					</div>
				</div>
				<div class="post-content content">
					<p>1.- try with boards ID number 4 and 2, and more mac (try 11 macs)<br />2.- try with flashimage ip_tftp_server:name_firmware<br />3.- try other cfe</p><p>good luck</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p76977">
				<div class="post-metadata">
					<div class="post-num">Post #98</div>
					<div class="post-author">misteroX</div>
					<div class="post-datetime">
						24 Nov 2008, 11:15					</div>
				</div>
				<div class="post-content content">
					<p>Hi t3l3m4k0,<br />Can I use one of this cfe for dg834gt and which of them published on link below?&nbsp; <br /><a href="http://downloads.openwrt.org/people/inh/cfe/">http://downloads.openwrt.org/people/inh/cfe/</a></p><p>Can I recreate a new CFE following this guide?<br /><a href="http://wiki.openwrt.org/OpenWrtDocs/Customizing/Firmware/CFE">http://wiki.openwrt.org/OpenWrtDocs/Cus … rmware/CFE</a></p><p>Obviously inserting my board parameters and my MacAddres.</p><p>At the end I transform all of it in big endian and I Flash through the jtag.</p><p>Do you think it&#039;s possible ?</p><p>Thanks<br />Misterox</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p76979">
				<div class="post-metadata">
					<div class="post-num">Post #99</div>
					<div class="post-author">Wilmer</div>
					<div class="post-datetime">
						24 Nov 2008, 11:27					</div>
				</div>
				<div class="post-content content">
					<p>Those CFEs are all meant for older boards, for little-endiain CPUs with the settings all encoded in ASCII. Also note that they&#039;re 256KB big, while at least the CFE in my DG834Gv4 is only 64KBytes.</p><p>Look at a hexdump of your CFE image. I think around offset 680 there should be some settings/board information like in my post above. Unfortunately changing these is not that simple since there&#039;s a checksum that has to be correct.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p76984">
				<div class="post-metadata">
					<div class="post-num">Post #100</div>
					<div class="post-author">t3l3m4k0</div>
					<div class="post-datetime">
						24 Nov 2008, 12:38					</div>
				</div>
				<div class="post-content content">
					<p>As wilmer says, you cannot use this cfe, are so old for your board.</p><p>Have you tried with help command when boot stops. There is a command to setup mac, like this:<br /></p><div class="codebox"><pre><code>CFE version 1.0.37-0.8 for BCM96348 (32bit,SP,BE)
Build Date: Â¤@  2Â¤Ã« 20 18:37:34 CST 2006 (root@localhost.localdomain)
Copyright (C) 2000,2001,2002,2003 Broadcom Corporation.

Initializing Arena.
Initializing Devices.
CPU type 0x29107: 256MHz, Bus: 128MHz, Ref: 32MHz

Total memory used by CFE:  0x80401000 - 0x805246F0 (1193712)
Initialized Data:          0x8041C680 - 0x8041E080 (6656)
BSS Area:                  0x8041E080 - 0x804226F0 (18032)
Local Heap:                0x804226F0 - 0x805226F0 (1048576)
Stack Area:                0x805226F0 - 0x805246F0 (8192)
Text (code) segment:       0x80401000 - 0x8041C67C (112252)
Boot area (physical):      0x00525000 - 0x00565000
Relocation Factor:         I:00000000 - D:00000000

Board IP address                : 192.168.1.19:ffffff00
Host IP address                 : 192.168.1.21
Gateway IP address              : 192.168.1.1
Run from flash/host (f/h)       : f
Default host run file name      : vmlinux
Default host flash file name    : bcm963xx_fs_kernel
Boot delay (0-9 seconds)        : 3
Board Id Name                   : 96348GW-11
Psi size in KB                  : 24
Number of MAC Addresses (1-32)  : 11
Base MAC Address                : 11:22:33:44:55:66
Ethernet PHY Type               : Internal
Memory size in MB               : 16

*** Press any key to stop auto run (3 seconds) ***
Auto run second count down: 3
web info: Waiting for connection on socket 0.
CFE&gt;   help
Available commands:

asus                Write bootcode, mac, or rdom to flash
w                   Write the whole image start from beginning of the flash
e                   Erase [n]vram or [a]ll flash except bootrom
r                   Run program from flash image or from host depend on [f/h] flag
p                   Print boot line and board parameter info
c                   Change booline parameters
f                   Write image to the flash
i                   Erase persistent storage data
b                   Change board parameters
reset               Reset the board
flashimage          Flashes a compressed image after the bootloader.
help                Obtain help for CFE commands

For more information about a command, enter &#039;help command-name&#039;
*** bcm63xx_main.c command status = 0
CFE&gt;</code></pre></div>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 4 of 30</div><nav><ul><li><a href="viewtopic.php%3Fid=17370&amp;p=1.html">1</a></li><li><a href="viewtopic.php%3Fid=17370&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=17370&amp;p=3.html">3</a></li><li class="pagination-current"><span>4</span></li><li><a href="viewtopic.php%3Fid=17370&amp;p=5.html">5</a></li><li><a href="viewtopic.php%3Fid=17370&amp;p=6.html">6</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=17370&amp;p=30.html">30</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0.002 -->

</body>
</html>