<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> asterisk 1.8.10.1 hangs when resolving dns in register, trunk r32786</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 25 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p173279">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">arpena01</div>
					<div class="post-datetime">
						25 Jul 2012, 23:08					</div>
				</div>
				<div class="post-content content">
					<p>Hi there!</p><p>I found an issue when upgrading my DIR-825 to latest trunk. Asterisk failed to register to my voip provider, and no other UDP SIP phone would register with it. Also, asterisk cpu utilization went to 100%.<br />My sip.conf looked like this:<br /></p><div class="codebox"><pre><code>[general]
...
register =&gt; user:pass@voip-provider.com/number

[phone1]
type=friend
host=dynamic
...
[voip_provider]                                            
type=peer                                                       
host=voip-provider.com
...</code></pre></div><p>With strace I saw this repeating all the time:<br /></p><div class="codebox"><pre><code>1837  open(&quot;/etc/resolv.conf&quot;, O_RDONLY) = 11
1837  ioctl(11, SNDCTL_TMR_TIMEBASE or TCGETS, 0xb72180b4) = -1 ENOTTY (Inappropriate ioctl for device)
1837  read(11, &quot;search lan\nnameserver 127.0.0.1\n&quot;, 4096) = 32
1837  read(11, &quot;&quot;, 4096)                = 0
1837  close(11)                         = 0</code></pre></div><p>Changing the register line to:<br /></p><div class="codebox"><pre><code>egister =&gt; user:pass@ipaddress/number</code></pre></div><p>worked around the issue.<br />Interestingly, the peer connected without problems even with the dns name in the &#039;host=&#039; line, the problem is only with the &#039;register =&gt;&quot; line.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p173790">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Hisashi</div>
					<div class="post-datetime">
						1 Aug 2012, 05:42					</div>
				</div>
				<div class="post-content content">
					<p>Hello. same problem i have got. It&#039;s still&nbsp; the same.</p><p><a href="https://dev.openwrt.org/ticket/10974">https://dev.openwrt.org/ticket/10974</a></p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>