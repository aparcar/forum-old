<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Cannot get an ip address on a Buffalo WBR-G54 with Kamikaze 7.06</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 1 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p50919">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">lstep</div>
					<div class="post-datetime">
						20 Jun 2007, 22:37					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m trying to make kamikaze 7.06 work on my WBR-G54 router, but my DHCP server doesn&#039;t recognize Kamikaze&#039;s DHCPs requests!<br />I can flash it as I wish (on 192.168.11.1 when I unplug/plug the power supply). It works perfectly (it boots and the router has an ip address) with a witehrussian openwrt, dd-wrt and even the original Buffalo firmware.</p><p>It seems that kamikaze&#039;s policy is now to get its ip address from a DHCP server, but I couldn&#039;t find a DHCP server that &quot;sees&quot; the request. I&#039;m on Linux and tried different servers (even different machines), and the requests (DHCP DISCOVER, as seen with ethereal) are &quot;invisible&quot; to the server :-(<br />I&#039;m pretty sure the DHCP server is correctly configured.</p><p>It wouldn&#039;t be a problem if the failsafe mode would work with the WBR-G54, but that&#039;s not the case, so I don&#039;t have failsafe mode possibility. And there&#039;s no serial pin connectors on the WBR-G54 easily accessible (that doesn&#039;t require soldering).</p><p>Using tcpdump, I keep getting these requests, but absolutely no reply from anyone :-(</p><div class="codebox"><pre><code>21:14:22.981983 IP 0.0.0.0.68 &gt; 255.255.255.255.67: BOOTP/DHCP, Request from 00:90:4c:49:00:2a, length: 277</code></pre></div><p>Using tethereal, I can get the content/description of the DHCP DISCOVER packets sent by Kamikaze:<br /></p><div class="codebox"><pre><code>Frame 1 (323 bytes on wire, 323 bytes captured)
    Packet Length: 323 bytes
    Capture Length: 323 bytes
    [Protocols in frame: eth:vlan:ip:udp:bootp]
Ethernet II, Src: 00:90:4c:49:00:2a (00:90:4c:49:00:2a), Dst: ff:ff:ff:ff:ff:ff (ff:ff:ff:ff:ff:ff)
    Destination: ff:ff:ff:ff:ff:ff (ff:ff:ff:ff:ff:ff)
        Address: ff:ff:ff:ff:ff:ff (ff:ff:ff:ff:ff:ff)
        .... ...1 .... .... .... .... = Multicast: This is a MULTICAST frame
        .... ..1. .... .... .... .... = Locally Administrated Address: This is NOT a factory default address
    Source: 00:90:4c:49:00:2a (00:90:4c:49:00:2a)
        Address: 00:90:4c:49:00:2a (00:90:4c:49:00:2a)
        .... ...0 .... .... .... .... = Multicast: This is a UNICAST frame
        .... ..0. .... .... .... .... = Locally Administrated Address: This is a FACTORY DEFAULT address
    Type: 802.1Q Virtual LAN (0x8100)
802.1Q Virtual LAN
    000. .... .... .... = Priority: 0
    ...0 .... .... .... = CFI: 0
    .... 0000 0000 0001 = ID: 1
    Type: IP (0x0800)
Internet Protocol, Src: 0.0.0.0 (0.0.0.0), Dst: 255.255.255.255 (255.255.255.255)
    Version: 4
    Header length: 20 bytes
    Differentiated Services Field: 0x00 (DSCP 0x00: Default; ECN: 0x00)
        0000 00.. = Differentiated Services Codepoint: Default (0x00)
        .... ..0. = ECN-Capable Transport (ECT): 0
        .... ...0 = ECN-CE: 0
    Total Length: 305
    Identification: 0x0000 (0)
    Flags: 0x00
        0... = Reserved bit: Not set
        .0.. = Don&#039;t fragment: Not set
        ..0. = More fragments: Not set
    Fragment offset: 0
    Time to live: 64
    Protocol: UDP (0x11)
    Header checksum: 0x79bd [correct]
    Source: 0.0.0.0 (0.0.0.0)
    Destination: 255.255.255.255 (255.255.255.255)
User Datagram Protocol, Src Port: 68 (68), Dst Port: 67 (67)
    Source port: 68 (68)
    Destination port: 67 (67)
    Length: 285
    Checksum: 0x752c [correct]
Bootstrap Protocol
    Message type: Boot Request (1)
    Hardware type: Ethernet
    Hardware address length: 6
    Hops: 0
    Transaction ID: 0x79d6fb0d
    Seconds elapsed: 0
    Bootp flags: 0x0000 (Unicast)
        0... .... .... .... = Broadcast flag: Unicast
        .000 0000 0000 0000 = Reserved flags: 0x0000
    Client IP address: 0.0.0.0 (0.0.0.0)
    Your (client) IP address: 0.0.0.0 (0.0.0.0)
    Next server IP address: 0.0.0.0 (0.0.0.0)
    Relay agent IP address: 0.0.0.0 (0.0.0.0)
    Client MAC address: 00:90:4c:49:00:2a (00:90:4c:49:00:2a)
    Server host name not given
    Boot file name not given
    Magic cookie: (OK)
    Option: (t=53,l=1) DHCP Message Type = DHCP Discover
        Option: (53) DHCP Message Type
        Length: 1
        Value: 01
    Option: (t=61,l=7) Client identifier
        Option: (61) Client identifier
        Length: 7
        Value: 0100904C49002A
        Hardware type: Ethernet
        Client MAC address: 00:90:4c:49:00:2a (00:90:4c:49:00:2a)
    Option: (t=60,l=11) Vendor class identifier = &quot;udhcp 1.4.2&quot;
        Option: (60) Vendor class identifier
        Length: 11
        Value: 756468637020312E342E32
    Option: (t=55,l=9) Parameter Request List
        Option: (55) Parameter Request List
        Length: 9
        Value: 0103060C0F1C28292A
        1 = Subnet Mask
        3 = Router
        6 = Domain Name Server
        12 = Host Name
        15 = Domain Name
        28 = Broadcast Address
        40 = Network Information Service Domain
        41 = Network Information Service Servers
        42 = Network Time Protocol Servers
    End Option</code></pre></div><p>I don&#039;t see anything wrong with these packets. I don&#039;t understand why they&#039;re not taken into account by any DHCP server. The only &#039;noticeable&#039; thing, is that the packet has VLAN (1) information set (which I guess is normal, as the 4-ports hub on the WBR-G54 is set like this).</p><p>Does anybody see something strange that would explain why these DHCP requests are not seen? I don&#039;t know what I can try, I&#039;m totally stuck :-(</p><p>Thanks for any help,<br />Luc</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p51667">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">axelilly</div>
					<div class="post-datetime">
						2 Jul 2007, 17:54					</div>
				</div>
				<div class="post-content content">
					<p>Were you ever able to get this problem resolved?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p51681">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">mt6561</div>
					<div class="post-datetime">
						2 Jul 2007, 21:41					</div>
				</div>
				<div class="post-content content">
					<p>I setted up DHCP server on VLAN 1 (eth0.1), added BOOTP capability and it works! My WBR-G54 got IP, and I can ping it.</p><p>But - nothing more. All TCP and UDP ports are closed, and I can&#039;t change firmware. How can I debrick my device? Is there JTAG/RS323 cable pinouts?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p51698">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">lstep</div>
					<div class="post-datetime">
						3 Jul 2007, 01:56					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>mt6561 wrote:</cite><blockquote><p>I setted up DHCP server on VLAN 1 (eth0.1), added BOOTP capability and it works! My WBR-G54 got IP, and I can ping it.</p><p>But - nothing more. All TCP and UDP ports are closed, and I can&#039;t change firmware. How can I debrick my device? Is there JTAG/RS323 cable pinouts?</p></blockquote></div><p>How did you set a VLAN with a value 1 ? On Linux, vconfig can only create VLANs starting at 2.</p>											<p class="post-edited">(Last edited by <strong>lstep</strong> on 3 Jul 2007, 11:03)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p58305">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">gagravarr</div>
					<div class="post-datetime">
						31 Oct 2007, 14:10					</div>
				</div>
				<div class="post-content content">
					<p>I think it a vlan configuration issue in kamikaze</p><p>I&#039;ve managed to get into my WBR-G54, but only over wifi. What I did was download the source for Kamikaze 7.09, and build my own version of it. During the build process, once it had created &quot;build_mipsel/root/etc/&quot;, I copied in two files. One was a passwd file with the password set (so I could ssh in), the second was expanded uci defaults, which turned on the wifi.</p><p>Once I load that on via tftp, I can ssh into the WBR-G54 over wifi. However, I can&#039;t seem to get any of the wired stuff to work. Now I need to figure out what the vlan settings ought to be.</p><p>If anyone wants to play, you can download my trx file from <a href="http://gagravarr.org/misc/openwrt-kamikaze_7.09_WBR-G54-squashfs.trx">http://gagravarr.org/misc/openwrt-kamik … uashfs.trx</a> . It&#039;ll come up on 192.168.1.9, root password is &quot;password&quot;, with ssh enabled (but takes a little while to start). SSID is &quot;NEW_AP&quot;</p><p>Nick</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p58306">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">gagravarr</div>
					<div class="post-datetime">
						31 Oct 2007, 14:26					</div>
				</div>
				<div class="post-content content">
					<p>Now that I can log in over wifi, I followed these instructions to configure the networking:<br />&nbsp; <a href="http://wiki.openwrt.org/OpenWrtDocs/Hardware/Asus/WL500W">http://wiki.openwrt.org/OpenWrtDocs/Har … sus/WL500W</a></p><p>With those network/vlan settings, it all seems to work just fine <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p58308">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">gagravarr</div>
					<div class="post-datetime">
						31 Oct 2007, 14:50					</div>
				</div>
				<div class="post-content content">
					<p>New firmware at <a href="http://gagravarr.org/misc/openwrt-kamikaze_7.09_WBR-G54-squashfs.trx">http://gagravarr.org/misc/openwrt-kamik … uashfs.trx</a> - should configure the vlans properly, and come up on 192.168.1.9 with a root password of password</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>