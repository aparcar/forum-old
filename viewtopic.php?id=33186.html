<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Successfully build OpenWRT for WR512-3GN minirouter</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 17 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p149662">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Lennong</div>
					<div class="post-datetime">
						27 Nov 2011, 16:38					</div>
				</div>
				<div class="post-content content">
					<p>I just did my first successful build ever, and for the WR512-3GN minirouter with all the bells and whistles I needed. 4MB is not much to play with but the basic stuff is in there.<br />The LEDs are all working and so is the reset button, but not the mode button. No big deal, as long as I can reset it. This is what I&#039;ve thrown in there:<br />LuCI<br />MultiWAN with fall over<br />UMTS/3G<br />ProFTPD<br />USB storage<br />GPIO for MMC/SD (have a live set of unpopulated pads for it on the board) <br />DDNS<br />QoS<br />ExtRoot with &#039;ramdisk&#039; @16MB (I guess)<br />In all honesty I have not much clue on what I am doing, I simply dig around and use some logic to throw the stuff together. The &#039;ramdisk&#039; was more or less a surprise, my intention was to put the root on a usb stick. Now I see that I have &quot;Free space: 99% (14.64 MB)&quot; in the software tab without any disk connected to it, yayy. How do I make the ramdisk a tad smaller, some 5-8MB or so?</p><p>Software tab<br /><a href="http://imageshack.us/photo/my-images/406/software.jpg/"><span class="postimg"><img src="http://img406.imageshack.us/img406/1546/software.th.jpg" alt="http://img406.imageshack.us/img406/1546/software.th.jpg" /></span></a></p><p>Mount points<br /><a href="http://imageshack.us/photo/my-images/141/mountpoints.jpg/"><span class="postimg"><img src="http://img141.imageshack.us/img141/8039/mountpoints.th.jpg" alt="http://img141.imageshack.us/img141/8039/mountpoints.th.jpg" /></span></a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </p><p>My packages:<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# opkg list_installed
base-files - 98-r29337
base-files-network - 3
blkid - 1.41.12-2
block-mount - 0.2.0-7
busybox - 1.19.3-9
chat - 2.4.5-4
comgt - 0.32-9
crda - 1.1.1-1
ddns-scripts - 1.0.0-17
dnsmasq - 2.59-1
dropbear - 2011.54-1
firewall - 2-42
hotplug2 - 1.0-beta-4
ip - 2.6.39-1
iptables - 1.4.10-4
iptables-mod-conntrack - 1.4.10-4
iptables-mod-conntrack-extra - 1.4.10-4
iptables-mod-filter - 1.4.10-4
iptables-mod-ipopt - 1.4.10-4
iptables-mod-nat - 1.4.10-4
iw - 3.1-2
kernel - 2.6.39.4-1
kmod-block2mtd - 2.6.39.4-1
kmod-button-hotplug - 2.6.39.4-3
kmod-cfg80211 - 2.6.39.4+2011-11-15-1
kmod-crypto-aes - 2.6.39.4-1
kmod-crypto-arc4 - 2.6.39.4-1
kmod-crypto-core - 2.6.39.4-1
kmod-eeprom-93cx6 - 2.6.39.4-1
kmod-fs-ext4 - 2.6.39.4-1
kmod-gre - 2.6.39.4-1
kmod-ifb - 2.6.39.4-1
kmod-input-core - 2.6.39.4-1
kmod-input-gpio-buttons - 2.6.39.4-1
kmod-input-gpio-keys - 2.6.39.4-1
kmod-input-gpio-keys-polled - 2.6.39.4-1
kmod-input-polldev - 2.6.39.4-1
kmod-ipt-conntrack - 2.6.39.4-1
kmod-ipt-conntrack-extra - 2.6.39.4-1
kmod-ipt-core - 2.6.39.4-1
kmod-ipt-filter - 2.6.39.4-1
kmod-ipt-ipopt - 2.6.39.4-1
kmod-ipt-nat - 2.6.39.4-1
kmod-ipt-nathelper - 2.6.39.4-1
kmod-leds-gpio - 2.6.39.4-1
kmod-ledtrig-usbdev - 2.6.39.4-1
kmod-lib-crc-ccitt - 2.6.39.4-1
kmod-lib-crc-itu-t - 2.6.39.4-1
kmod-lib-crc16 - 2.6.39.4-1
kmod-lib-textsearch - 2.6.39.4-1
kmod-mac80211 - 2.6.39.4+2011-11-15-1
kmod-nls-base - 2.6.39.4-1
kmod-ppp - 2.6.39.4-1
kmod-pppoe - 2.6.39.4-1
kmod-rt2800-lib - 2.6.39.4+2011-11-15-1
kmod-rt2800-pci - 2.6.39.4+2011-11-15-1
kmod-rt2x00-lib - 2.6.39.4+2011-11-15-1
kmod-rt2x00-pci - 2.6.39.4+2011-11-15-1
kmod-rt2x00-soc - 2.6.39.4+2011-11-15-1
kmod-sched - 2.6.39.4-1
kmod-scsi-core - 2.6.39.4-1
kmod-usb-core - 2.6.39.4-1
kmod-usb-rt305x-dwc_otg - 2.6.39.4-1
kmod-usb-serial - 2.6.39.4-1
kmod-usb-serial-option - 2.6.39.4-1
kmod-usb-serial-wwan - 2.6.39.4-1
kmod-usb-storage - 2.6.39.4-1
libblkid - 1.41.12-2
libc - 0.9.32-98
libcom_err - 1.41.12-2
libext2fs - 1.41.12-2
libgcc - 4.5-linaro-98
libip4tc - 1.4.10-4
libiwinfo - 16
liblua - 5.1.4-8
libnl-tiny - 0.1-2
libpthread - 0.9.32-98
librt - 0.9.32-98
libuci - 2011-11-14.1-1
libuci-lua - 2011-11-14.1-1
libusb - 0.1.12-2
libusb-1.0 - 1.0.8-1
libuuid - 1.41.12-2
libxtables - 1.4.10-4
lua - 5.1.4-8
luci-app-ddns - trunk+svn7976-1
luci-app-firewall - trunk+svn7976-1
luci-app-multiwan - trunk+svn7976-1
luci-app-qos - trunk+svn7976-1
luci-i18n-english - trunk+svn7976-1
luci-lib-core - trunk+svn7976-1
luci-lib-ipkg - trunk+svn7976-1
luci-lib-lmo - trunk+svn7976-1
luci-lib-nixio - trunk+svn7976-1
luci-lib-sys - trunk+svn7976-1
luci-lib-web - trunk+svn7976-1
luci-mod-admin-core - trunk+svn7976-1
luci-mod-admin-full - trunk+svn7976-1
luci-proto-3g - trunk+svn7976-1
luci-proto-core - trunk+svn7976-1
luci-proto-ppp - trunk+svn7976-1
luci-proto-pptp - trunk+svn7976-1
luci-sgi-cgi - trunk+svn7976-1
luci-sgi-uhttpd - trunk+svn7976-1
luci-theme-base - trunk+svn7976-1
luci-theme-openwrt - trunk+svn7976-1
maccalc - 1
mtd - 17
multiwan - 1.0.19-1
opkg - 618-2
ppp - 2.4.5-4
ppp-mod-pppoe - 2.4.5-4
pptp - 1.7.1-4
qos-scripts - 1.2.1-6
resolveip - 1
swap-utils - 2.13.0.1-4
tc - 2.6.39-1
uci - 2011-11-14.1-1
uhttpd - 30
uhttpd-mod-lua - 30
usb-modeswitch - 1.2.0-2
usb-modeswitch-data - 20111023-1
usbutils - 004-1
wireless-tools - 29-4
wpad - 20111103-1
zlib - 1.2.5-1</code></pre></div><p>There is a thing that bugs me:<br />The line &quot;ramips-wdt: timeout value 60 must be 0 &lt; timeout &lt; 40&quot; message is bothers me a bit. Is this something I should consider look closer into?</p><p>The kernel log:<br /></p><div class="codebox"><pre><code>Linux version 2.6.39.4 (mr@mr-virtual-machine) (gcc version 4.5.4 20110808 (prerelease) (Linaro GCC 4.5-2011.08) ) #1 Sun Nov 27 15:19:22 WIT 2011
prom: fw_arg0=00000001, fw_arg1=01f5bfb0, fw_arg2=01f5c3b0, fw_arg3=00000000
env[0]: memsize=32
env[1]: initrd_start=0x00000000
env[2]: initrd_size=0x0
env[3]: flash_start=0xBF000000
env[4]: flash_size=0x400000
env[0]: memsize=32
env[1]: initrd_start=0x00000000
env[2]: initrd_size=0x0
env[3]: flash_start=0xBF000000
env[4]: flash_size=0x400000
bootconsole [early0] enabled
CPU revision is: 0001964c (MIPS 24Kc)
Ralink RT3350   id:1 rev:2 running at 320.00 MHz
Determined physical RAM map:
 memory: 02000000 @ 00000000 (usable)
Initrd not found or empty - disabling initrd
Zone PFN ranges:
  Normal   0x00000000 -&gt; 0x00002000
Movable zone start PFN for each node
early_node_map[1] active PFN ranges
    0: 0x00000000 -&gt; 0x00002000
On node 0 totalpages: 8192
free_area_init_node: node 0, pgdat 80221010, node_mem_map 81000000
  Normal zone: 64 pages used for memmap
  Normal zone: 0 pages reserved
  Normal zone: 8128 pages, LIFO batch:0
pcpu-alloc: s0 r0 d32768 u32768 alloc=1*32768
pcpu-alloc: [0] 0 
Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 8128
Kernel command line:  board=&quot;WR512-3GN&quot; mtdparts=physmap-flash.0:192k(u-boot)ro,64k(u-boot-env)ro,64k(factory)ro,832k(kernel),2944k(rootfs),3776k@0x50000(firmware) console=ttyS1,57600 rootfstype=squashfs,jffs2
PID hash table entries: 128 (order: -3, 512 bytes)
Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
Primary instruction cache 16kB, VIPT, 4-way, linesize 32 bytes.
Primary data cache 16kB, 4-way, VIPT, no aliases, linesize 32 bytes
Writing ErrCtl register=0006cf72
Readback ErrCtl register=0006cf72
Memory: 30008k/32768k available (1863k kernel code, 2760k reserved, 317k data, 152k init, 0k highmem)
SLUB: Genslabs=9, HWalign=32, Order=0-3, MinObjects=0, CPUs=1, Nodes=1
NR_IRQS:48
console [ttyS1] enabled, bootconsole disabled
Calibrating delay loop... 212.58 BogoMIPS (lpj=1062912)
pid_max: default: 32768 minimum: 301
Mount-cache hash table entries: 512
NET: Registered protocol family 16
MIPS: machine is WR512-3GN-like router
bio: create slab &lt;bio-0&gt; at 0
Switching to clocksource MIPS
NET: Registered protocol family 2
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 1024 (order: 1, 8192 bytes)
TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
TCP: Hash tables configured (established 1024 bind 1024)
TCP reno registered
UDP hash table entries: 256 (order: 0, 4096 bytes)
UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
NET: Registered protocol family 1
squashfs: version 4.0 (2009/01/31) Phillip Lougher
JFFS2 version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006 Red Hat, Inc.
msgmni has been set to 58
io scheduler noop registered
io scheduler deadline registered (default)
Serial: 8250/16550 driver, 2 ports, IRQ sharing disabled
serial8250: ttyS0 at MMIO 0x10000500 (irq = 13) is a 16550A
serial8250: ttyS1 at MMIO 0x10000c00 (irq = 20) is a 16550A
physmap platform flash device: 00800000 at bf000000
physmap-flash.0: Found 1 x16 devices at 0x0 in 16-bit bank. Manufacturer ID 0x0000c2 Chip ID 0x0022a8
physmap-flash.0: Found an alias at 0x400000 for the chip at 0x0
Amd/Fujitsu Extended Query Table at 0x0040
  Amd/Fujitsu Extended Query version 1.1.
number of CFI chips: 1
6 cmdlinepart partitions found on MTD device physmap-flash.0
Creating 6 MTD partitions on &quot;physmap-flash.0&quot;:
0x000000000000-0x000000030000 : &quot;u-boot&quot;
0x000000030000-0x000000040000 : &quot;u-boot-env&quot;
0x000000040000-0x000000050000 : &quot;factory&quot;
0x000000050000-0x000000120000 : &quot;kernel&quot;
0x000000120000-0x000000400000 : &quot;rootfs&quot;
mtd: partition &quot;rootfs&quot; set to be root filesystem
mtd: partition &quot;rootfs_data&quot; created automatically, ofs=3E0000, len=20000 
0x0000003e0000-0x000000400000 : &quot;rootfs_data&quot;
0x000000050000-0x000000400000 : &quot;firmware&quot;
ramips_eth: loaded
TCP westwood registered
NET: Registered protocol family 17
802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;
All bugs added by David S. Miller &lt;davem@redhat.com&gt;
VFS: Mounted root (squashfs filesystem) readonly on device 31:4.
Freeing unused kernel memory: 152k freed
input: gpio-buttons as /devices/platform/gpio-buttons/input/input0
ttyS1: 3 input overrun(s)
Button Hotplug driver version 0.4.1
Registered led device: wr512:green:3g
Registered led device: wr512:green:gateway
Registered led device: wr512:green:ap
Registered led device: wr512:green:wps
Registered led device: wr512:green:station
Compat-wireless backport release: compat-wireless-2011-11-08-1-g4ab9b62
Backport based on wireless-testing.git master-2011-11-15
ttyS1: 3 input overrun(s)
cfg80211: Calling CRDA to update world regulatory domain
cfg80211: World regulatory domain updated:
cfg80211:     (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp)
cfg80211:     (2402000 KHz - 2472000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (2457000 KHz - 2482000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (2474000 KHz - 2494000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (5170000 KHz - 5250000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (5735000 KHz - 5835000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
SCSI subsystem initialized
ttyS1: 11 input overrun(s)
usbcore: registered new interface driver usbfs
usbcore: registered new interface driver hub
usbcore: registered new device driver usb
ieee80211 phy0: Selected rate control algorithm &#039;minstrel_ht&#039;
Registered led device: rt2800pci-phy0::radio
Registered led device: rt2800pci-phy0::assoc
Registered led device: rt2800pci-phy0::quality
PPP generic driver version 2.4.2
ttyS1: 5 input overrun(s)
GRE over IPv4 demultiplexor driver
GRE over IPv4 tunneling driver
ip_tables: (C) 2000-2006 Netfilter Core Team
NET: Registered protocol family 24
ttyS1: 5 input overrun(s)
nf_conntrack version 0.5.0 (471 buckets, 1884 max)
xt_time: kernel timezone is -0000
ttyS1: 3 input overrun(s)
dwc_otg: version 2.72a 24-JUN-2008
dwc_otg: Core Release: 2.66a
dwc_otg: Periodic Transfer Interrupt Enhancement - disabled
dwc_otg: Multiprocessor Interrupt Enhancement - disabled
dwc_otg: Using DMA mode
dwc_otg: Device using Buffer DMA mode
dwc_otg dwc_otg.0: DWC OTG Controller
dwc_otg dwc_otg.0: new USB bus registered, assigned bus number 1
dwc_otg dwc_otg.0: irq 26, io mem 0x101c0000
dwc_otg: Init: Port Power? op_state=1
dwc_otg: Init: Power Port (0)
hub 1-0:1.0: USB hub found
hub 1-0:1.0: 1 port detected
ttyS1: 4 input overrun(s)
usbcore: registered new interface driver usbserial
USB Serial support registered for generic
usbcore: registered new interface driver usbserial_generic
usbserial: USB Serial Driver core
Initializing USB Mass Storage driver...
usbcore: registered new interface driver usb-storage
USB Mass Storage support registered.
USB Serial support registered for GSM modem (1-port)
usbcore: registered new interface driver option
option: v0.7.2:USB Driver for GSM modems
ttyS1: 19 input overrun(s)
device eth0.1 entered promiscuous mode
device eth0 entered promiscuous mode
ttyS1: 4 input overrun(s)
br-lan: port 1(eth0.1) entering forwarding state
br-lan: port 1(eth0.1) entering forwarding state
jffs2: Too few erase blocks (2)
ttyS1: 5 input overrun(s)
ramips-wdt: timeout value 60 must be 0 &lt; timeout &lt; 40
device wlan0 entered promiscuous mode
br-lan: port 2(wlan0) entering forwarding state
br-lan: port 2(wlan0) entering forwarding state
ttyS1: 3 input overrun(s)
device wlan0 left promiscuous mode
br-lan: port 2(wlan0) entering forwarding state
ttyS1: 4 input overrun(s)
device wlan0 entered promiscuous mode
br-lan: port 2(wlan0) entering forwarding state
br-lan: port 2(wlan0) entering forwarding state
br-lan: port 2(wlan0) entering forwarding state
br-lan: port 1(eth0.1) entering forwarding state
ttyS1: 6 input overrun(s)
device eth0 left promiscuous mode
device wlan0 left promiscuous mode
br-lan: port 2(wlan0) entering disabled state
device eth0.1 left promiscuous mode
br-lan: port 1(eth0.1) entering disabled state
device eth0.1 entered promiscuous mode
device eth0 entered promiscuous mode
ttyS1: 8 input overrun(s)
br-lan: port 1(eth0.1) entering forwarding state
br-lan: port 1(eth0.1) entering forwarding state
device wlan0 entered promiscuous mode
ttyS1: 5 input overrun(s)
br-lan: port 2(wlan0) entering forwarding state
br-lan: port 2(wlan0) entering forwarding state
device wlan0 left promiscuous mode
br-lan: port 2(wlan0) entering forwarding state
ttyS1: 4 input overrun(s)
device wlan0 entered promiscuous mode
br-lan: port 2(wlan0) entering forwarding state
br-lan: port 2(wlan0) entering forwarding state
br-lan: port 2(wlan0) entering forwarding state
br-lan: port 1(eth0.1) entering forwarding state
ttyS1: 6 input overrun(s)
device eth0 left promiscuous mode
device wlan0 left promiscuous mode
br-lan: port 2(wlan0) entering disabled state
device eth0.1 left promiscuous mode
br-lan: port 1(eth0.1) entering disabled state
device eth0.1 entered promiscuous mode
device eth0 entered promiscuous mode
ttyS1: 8 input overrun(s)
br-lan: port 1(eth0.1) entering forwarding state
br-lan: port 1(eth0.1) entering forwarding state
device wlan0 entered promiscuous mode
ttyS1: 5 input overrun(s)
br-lan: port 2(wlan0) entering forwarding state
br-lan: port 2(wlan0) entering forwarding state
device wlan0 left promiscuous mode
br-lan: port 2(wlan0) entering forwarding state
ttyS1: 4 input overrun(s)
device wlan0 entered promiscuous mode
br-lan: port 2(wlan0) entering forwarding state
br-lan: port 2(wlan0) entering forwarding state</code></pre></div>											<p class="post-edited">(Last edited by <strong>Lennong</strong> on 28 Nov 2011, 07:01)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p149700">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Lennong</div>
					<div class="post-datetime">
						28 Nov 2011, 06:49					</div>
				</div>
				<div class="post-content content">
					<p>1. From what I understand the IPV6 protocol do take quite a big chunk of space. Is there any way to remove it totally from the source? </p><p>2. It seems like LuCI is dependent on it, coz when i remove the support for IPV6 the LuCI configuration dissapears from the configmenu. Even worse, when I mark the support for IPV6 again the LuCI still doesn&#039;t show up... I have to make a distclean and pull the feeds again for LuCI to reappear. Bug possibly?</p><p>3. How can I edit the ramdisk size? I&#039;m stuck.</p><p>Thanks!</p>											<p class="post-edited">(Last edited by <strong>Lennong</strong> on 28 Nov 2011, 06:55)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>