<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> mounting samba share</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 30 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p15191">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">kenv</div>
					<div class="post-datetime">
						10 Nov 2005, 23:18					</div>
				</div>
				<div class="post-content content">
					<p>I installed the kmod-smbfs and cifs, samba modules but can&#039;t seem to mount the shares from linux box.&nbsp; I have another wrt54g running dd-wrt and it is able to mount it fine.&nbsp; 192.168.1.100 is my linux box.&nbsp; Basically when I mount with:</p><p>root@OpenWrt:/smb# insmod smbfs<br />Using /lib/modules/2.4.20/smbfs.o<br />insmod: unresolved symbol __up<br />insmod: unresolved symbol __down<br />insmod: unresolved symbol get_empty_inod</p><p>root@OpenWrt:/smb# mount -t smbfs //192.168.1.100/sharename /smb -o username=vnc,password=password<br />mount: Mounting //192.168.1.100/sharename on /smb failed: No such device</p><p>Or</p><p>root@OpenWrt:/smb# mount.cifs //192.168.1.100/sharename /smb -o user=vnc,pass=password&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />mount error 22 = Invalid argument<br />Refer to the mount.cifs(8) manual page (e.g.man mount.cifs)</p><p>Anyone have an idea what could be wrong?&nbsp; I need more disk space for running airodump.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p15193">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Rupan</div>
					<div class="post-datetime">
						10 Nov 2005, 23:28					</div>
				</div>
				<div class="post-content content">
					<p>Note the unresolved symbol messages.&nbsp; You&#039;re missing something you need in the kernel.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p15195">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">olli</div>
					<div class="post-datetime">
						10 Nov 2005, 23:35					</div>
				</div>
				<div class="post-content content">
					<p>Reboot your router and the required modules should get automatically loaded from the file in /etc/modules.d directory in a recent OpenWrt version.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p15201">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">kenv</div>
					<div class="post-datetime">
						11 Nov 2005, 00:04					</div>
				</div>
				<div class="post-content content">
					<p>I have RC3, and I did reboot it.&nbsp; As for the unresolved stuff, I don&#039;t know what to do to fix it.&nbsp; I basically flashed a WRT54G v4 with OpenWRT RC3, then installed the kmods, and tried to load it.&nbsp; What else could I be missing?&nbsp; Thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p15202">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">olli</div>
					<div class="post-datetime">
						11 Nov 2005, 00:07					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>kenv wrote:</cite><blockquote><p>root@OpenWrt:/smb# insmod smbfs<br />Using /lib/modules/<strong>2.4.20</strong>/smbfs.o<br />insmod: unresolved symbol __up<br />insmod: unresolved symbol __down<br />insmod: unresolved symbol get_empty_inod</p></blockquote></div><p>Hmm, something seems to be wrong with your kernel verion of 2.4.20 (showed bold in the quote). Maybe you are using some old kmod-* packages. OpenWrt RC3 is running a kernel at version 2.4.30.</p>											<p class="post-edited">(Last edited by <strong>olli_04</strong> on 11 Nov 2005, 00:07)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p15205">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Nico</div>
					<div class="post-datetime">
						11 Nov 2005, 00:41					</div>
				</div>
				<div class="post-content content">
					<p>You don&#039;t need kmod-smbfs, which is not an official supported kernel modules from WhiteRussian. The steps required to mounting a remote filesystem locally on your router are detailed in the Wiki :</p><p>&nbsp; <a href="http://wiki.openwrt.org/RemoteFileSystemHowTo">http://wiki.openwrt.org/RemoteFileSystemHowTo</a></p><p>Use cifs to access a remote Windows / Samba share.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p16682">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">Acerbaturix</div>
					<div class="post-datetime">
						6 Dec 2005, 01:44					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>I&#039;m having problemas to mount a samba filesyste. I installed &#039;kmod-cifs&#039; and &#039;cifsmount&#039;, but when I try to mount a samba share I get the same error </p><p>root@OpenWrt:~# mount -t cifs //192.168.1.3/data /tmp/probando/<br />mount: Mounting //192.168.1.3/data on /tmp/probando failed: Invalid argument</p><p>root@OpenWrt:~# /sbin/mount.cifs //192.168.1.3/data /tmp/probando/<br />Password:<br />mount error 22 = Invalid argument<br />Refer to the mount.cifs(8) manual page (e.g.man mount.cifs)</p><p>I&#039;m usin Linksys WRT54G v3.1 with OpenWRT WhiteRusian RC4</p><p>some help?</p>											<p class="post-edited">(Last edited by <strong>Acerbaturix</strong> on 6 Dec 2005, 01:49)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p16685">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">bani</div>
					<div class="post-datetime">
						6 Dec 2005, 05:51					</div>
				</div>
				<div class="post-content content">
					<p>afaict cifs in openwrt RC4 is completely broken.</p><p>i can mount from osx, fedora core 4 and w2k to a fedora core 4 samba server just fine, zero problems.</p><p>openwrt RC4 is completely unable to mount no matter what parameters are given, no difference if it is mount.cifs or mount -t cifs.</p><p>i gave up and used shfs instead.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p16701">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">Nico</div>
					<div class="post-datetime">
						6 Dec 2005, 15:03					</div>
				</div>
				<div class="post-content content">
					<p>bani,</p><p>did you follow the instructions in <a href="http://wiki.openwrt.org/RemoteFileSystemHowTo">http://wiki.openwrt.org/RemoteFileSystemHowTo</a> ?</p><p>Looking at what Acerbaturix wrote, it&#039;s clear he/she didn&#039;t follow the instructions here. Did you ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p16705">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">Acerbaturix</div>
					<div class="post-datetime">
						6 Dec 2005, 15:57					</div>
				</div>
				<div class="post-content content">
					<p>Nico,</p><p>Sorry, I forget to mention that, but I also tried with the instruccions of the RemoteFS HOWTO, the results were the same <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>I&#039;m missing something?</p><p>root@OpenWrt:~# mount -t cifs //192.168.1.3/data /tmp/probando -o unc=//192.168.1.3\\data,ip=192.168.1.3,user=pepe,pass=pepe,dom=GERVANET<br />mount: Mounting //192.168.1.3/data on /tmp/probando failed: Invalid argument</p><p>....<br />....</p><p>root@OpenWrt:~# mount -t cifs //logos/data /tmp/probando -o unc=//logos\\data,ip=192.168.1.3,user=pepe,pass=pepe,dom=GERVANET<br />mount: Mounting //logos/data on /tmp/probando failed: Invalid argument</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p16846">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">Acerbaturix</div>
					<div class="post-datetime">
						8 Dec 2005, 16:57					</div>
				</div>
				<div class="post-content content">
					<p>Somebody can help me, please?</p><p>My unique option is samba, because I want to mount a share from a Iomega Network Hard Drive, that only run samba...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p16847">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">Nico</div>
					<div class="post-datetime">
						8 Dec 2005, 17:01					</div>
				</div>
				<div class="post-content content">
					<p>can you post the last 10 lines of logread after running your mount command?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p16859">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">Acerbaturix</div>
					<div class="post-datetime">
						8 Dec 2005, 21:28					</div>
				</div>
				<div class="post-content content">
					<p>There only one line after the mount:</p><p>Jan&nbsp; 1 00:04:15 (none) kern.err kernel:&nbsp; CIFS VFS: cifs_mount failed w/return code = -5</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p20685">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">nekimali</div>
					<div class="post-datetime">
						11 Feb 2006, 23:15					</div>
				</div>
				<div class="post-content content">
					<p>so, after stumbling across the same problem, i tried various ways to make cifs work but with no success....</p><p>i&#039;m using rc4 official and it seems that the cifs.o is broken</p><p>here is the 10 lines of log nico requested.... (i got this debug after i changed /proc/fs/cifs/cifsFYI from 0 to 1)<br />---<br />Feb 11 22:05:07 (none) kern.debug kernel:&nbsp; connect.c: CIFS VFS: in cifs_mount as Xid: 27 with uid: 0<br />Feb 11 22:05:07 (none) kern.debug kernel:&nbsp; connect.c: Entering cifs_mount. Xid: 27 with: unc=//192.168.1.2\tcpdump,ip=192.168.1.2,pass=pass123,ver=1,user=user<br />Feb 11 22:05:07 (none) kern.debug kernel:&nbsp; connect.c: Username: user<br />Feb 11 22:05:07 (none) kern.debug kernel:&nbsp; connect.c: UNC: \\192.168.1.2\tcpdump ip: 192.168.1.2<br />Feb 11 22:05:07 (none) kern.debug kernel:&nbsp; connect.c: Socket created<br />Feb 11 22:05:07 (none) kern.debug kernel:&nbsp; connect.c: Demultiplex PID: 1112<br />Feb 11 22:05:07 (none) kern.debug kernel:&nbsp; connect.c: Existing smb sess not found<br />Feb 11 22:05:07 (none) kern.debug kernel:&nbsp; transport.c: For smb_command 114<br />Feb 11 22:05:07 (none) kern.debug kernel:&nbsp; transport.c: Sending smb of length 47<br />Feb 11 22:05:07 (none) kern.debug kernel:&nbsp; connect.c: Peek length rcvd: 0x24 beginning 0x6b)<br />Feb 11 22:05:07 (none) kern.debug kernel:&nbsp; connect.c:&nbsp; Mid 0x37 matched - waking up<br />Feb 11 22:05:07 (none) kern.debug kernel:&nbsp; connect.c: Security Mode: 0x3 Capabilities: 0xe3fd Time Zone: 65476<br />Feb 11 22:05:07 (none) kern.debug kernel:&nbsp; connect.c: In sesssetup<br />Feb 11 22:05:07 (none) kern.debug kernel:&nbsp; transport.c: For smb_command 115<br />Feb 11 22:05:07 (none) kern.debug kernel:&nbsp; transport.c: Sending smb of length 74<br />Feb 11 22:05:07 (none) kern.debug kernel:&nbsp; connect.c: Peek length rcvd: 0x24 beginning 0x27)<br />Feb 11 22:05:07 (none) kern.debug kernel:&nbsp; connect.c:&nbsp; Mid 0x38 matched - waking up<br />Feb 11 22:05:07 (none) kern.debug kernel:&nbsp; netmisc.c:&nbsp; !!Mapping smb error code 1 to POSIX err -5 !!<br />Feb 11 22:05:07 (none) kern.err kernel:&nbsp; CIFS VFS: Send error in SessSetup = -5<br />Feb 11 22:05:07 (none) kern.debug kernel:&nbsp; connect.c: No session or bad tcon<br />Feb 11 22:05:07 (none) kern.debug kernel:&nbsp; connect.c: CIFS VFS: leaving cifs_mount (xid = 27) rc = -5<br />Feb 11 22:05:07 (none) kern.err kernel:&nbsp; CIFS VFS: cifs_mount failed w/return code = -5<br />Feb 11 22:05:07 (none) kern.debug kernel:&nbsp; connect.c: Wait for exit from demultiplex thread<br />root@OpenWrt:/proc/fs/cifs#</p><br /><p>hope this helps solving the problem...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p20701">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">Habos</div>
					<div class="post-datetime">
						12 Feb 2006, 09:49					</div>
				</div>
				<div class="post-content content">
					<p>Hi</p><p>I&#039;m using pre-RC5 and mount.cifs works for me.</p><p>Using the following packages</p><p>kmod-cifs_2.4.30-brcm-3_mipsel.ipk <br />cifsmount_1.5-2_mipsel.ipk </p><p>the command was:</p><p>mount.cifs //192.168.1.2/vdr-ftp /tmp/mount/ -o user=xxx</p><p>and my log</p><div class="codebox"><pre><code>Feb 12 08:45:09 (none) kern.debug kernel:  connect.c: Entering cifs_mount. Xid: 737 with: unc=//192.168.1.2\vdr-ftp,ip=192.168.1.2,pass=xxx,ver=1,user=xxx
Feb 12 08:45:09 (none) kern.debug kernel:  connect.c: Username: xxx
Feb 12 08:45:09 (none) kern.debug kernel:  connect.c: UNC: \\192.168.1.2\vdr-ftp ip: 192.168.1.2
Feb 12 08:45:09 (none) kern.debug kernel:  connect.c: Socket created
Feb 12 08:45:09 (none) kern.debug kernel:  connect.c: Existing smb sess not found
Feb 12 08:45:09 (none) kern.debug kernel:  transport.c: For smb_command 114
Feb 12 08:45:09 (none) kern.debug kernel:  transport.c: Sending smb of length 47
Feb 12 08:45:09 (none) kern.debug kernel:  connect.c: Demultiplex PID: 796
Feb 12 08:45:09 (none) kern.debug kernel:  connect.c: Peek length rcvd: 0x24 beginning 0x85)
Feb 12 08:45:09 (none) kern.debug kernel:  connect.c:  Mid 0x20 matched - waking up
Feb 12 08:45:09 (none) kern.debug kernel:  connect.c: Security Mode: 0x3 Capabilities: 0xe3fd Time Zone: 65476
Feb 12 08:45:09 (none) kern.debug kernel:  connect.c: In sesssetup
Feb 12 08:45:09 (none) kern.debug kernel:  transport.c: For smb_command 115
Feb 12 08:45:09 (none) kern.debug kernel:  transport.c: Sending smb of length 196
Feb 12 08:45:09 (none) kern.debug kernel:  connect.c: Peek length rcvd: 0x24 beginning 0x95)
Feb 12 08:45:09 (none) kern.debug kernel:  connect.c:  Mid 0x21 matched - waking up
Feb 12 08:45:09 (none) kern.debug kernel:  connect.c: UID = 2048
Feb 12 08:45:09 (none) kern.debug kernel:  connect.c: CIFS Session Established successfully
Feb 12 08:45:09 (none) kern.debug kernel:  connect.c: file mode: 0x7f7  dir mode: 0x1ff
Feb 12 08:45:09 (none) kern.debug kernel:  transport.c: For smb_command 117
Feb 12 08:45:09 (none) kern.debug kernel:  transport.c: Sending smb of length 94
Feb 12 08:45:09 (none) kern.debug kernel:  connect.c: Peek length rcvd: 0x24 beginning 0x42)
Feb 12 08:45:09 (none) kern.debug kernel:  connect.c:  Mid 0x22 matched - waking up
Feb 12 08:45:09 (none) kern.debug kernel:  connect.c: Tcon flags: 0x1
Feb 12 08:45:09 (none) kern.debug kernel:  connect.c: CIFS Tcon rc = 0
Feb 12 08:45:09 (none) kern.debug kernel:  cifssmb.c: In QFSDeviceInfo
Feb 12 08:45:09 (none) kern.debug kernel:  transport.c: For smb_command 50
Feb 12 08:45:09 (none) kern.debug kernel:  transport.c: Sending smb of length 68
Feb 12 08:45:09 (none) kern.debug kernel:  connect.c: Peek length rcvd: 0x24 beginning 0x44)
Feb 12 08:45:09 (none) kern.debug kernel:  connect.c:  Mid 0x23 matched - waking up
Feb 12 08:45:09 (none) kern.debug kernel:  cifssmb.c: In QFSAttributeInfo
Feb 12 08:45:09 (none) kern.debug kernel:  transport.c: For smb_command 50
Feb 12 08:45:09 (none) kern.debug kernel:  transport.c: Sending smb of length 68
Feb 12 08:45:09 (none) kern.debug kernel:  connect.c: Peek length rcvd: 0x24 beginning 0x50)
Feb 12 08:45:09 (none) kern.debug kernel:  connect.c:  Mid 0x24 matched - waking up
Feb 12 08:45:09 (none) kern.debug kernel:  connect.c: CIFS VFS: leaving cifs_mount (xid = 737) rc = 0
Feb 12 08:45:09 (none) kern.debug kernel:  inode.c: CIFS VFS: in cifs_read_inode as Xid: 738 with uid: 0
Feb 12 08:45:09 (none) kern.debug kernel:  inode.c: Getting info on
Feb 12 08:45:09 (none) kern.debug kernel:  cifssmb.c: In QPathInfo path
Feb 12 08:45:09 (none) kern.debug kernel:  transport.c: For smb_command 50
Feb 12 08:45:09 (none) kern.debug kernel:  transport.c: Sending smb of length 74
Feb 12 08:45:09 (none) kern.debug kernel:  connect.c: Peek length rcvd: 0x24 beginning 0xbe)
Feb 12 08:45:09 (none) kern.debug kernel:  connect.c:  Mid 0x25 matched - waking up
Feb 12 08:45:09 (none) kern.debug kernel:  inode.c:  Old time 0
Feb 12 08:45:09 (none) kern.debug kernel:  inode.c:  New time 15455991
Feb 12 08:45:09 (none) kern.debug kernel:  inode.c:  Size 0 and blocks 0
Feb 12 08:45:09 (none) kern.debug kernel:  inode.c:  Directory inode</code></pre></div>											<p class="post-edited">(Last edited by <strong>Habos</strong> on 12 Feb 2006, 09:54)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p21049">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">irishjd</div>
					<div class="post-datetime">
						18 Feb 2006, 08:59					</div>
				</div>
				<div class="post-content content">
					<p>I too am having this problem. I read the wiki and all the posts, related to cifs, that I could find, but I have not had any luck with this. Here is the command that I am using:</p><p>root@OpenWrt:/# mount.cifs //192.168.1.100/linksys /mnt/winxp -o user=jon<br />Password:</p><p>Here is the error I get after a couple of minutes of inactivity:</p><p>mount error 22 = Invalid argument<br />Refer to the mount.cifs(8) manual page (e.g.man mount.cifs)</p><p>Here is the only log output that I receive:</p><p>02-18-2006&nbsp; &nbsp; 00:53:21&nbsp; &nbsp; Kernel.Error&nbsp; &nbsp; 192.168.1.1&nbsp; &nbsp; kernel:&nbsp; CIFS VFS: cifs_mount failed w/return code = -2</p><p>Any help would be appreciated,<br />Jon</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45411">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">OldSparky</div>
					<div class="post-datetime">
						28 Mar 2007, 18:21					</div>
				</div>
				<div class="post-content content">
					<p>Similar issue:</p><div class="codebox"><pre><code># mount.cifs  //192.168.2.20/wrt_home /home -o user=wrt
Password:
mount error 22 = Invalid argument
Refer to the mount.cifs(8) manual page (e.g.man mount.cifs)

# logread | tail -n2
Mar 28 17:16:50 (none) kern.err kernel:  CIFS VFS: No response buffer
Mar 28 17:16:50 (none) kern.err kernel:  CIFS VFS: cifs_mount failed w/return code = -147</code></pre></div><p>Are there a table of errors code?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45412">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">OldSparky</div>
					<div class="post-datetime">
						28 Mar 2007, 19:12					</div>
				</div>
				<div class="post-content content">
					<p>Solved. My samba server dropping connections from the WRG due a server misconfiguration.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>