<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Networkshares - Permission Denied</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 29 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p333248">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Garionion</div>
					<div class="post-datetime">
						4 Aug 2016, 19:03					</div>
				</div>
				<div class="post-content content">
					<p>Hi there,<br />I&#039;ve got a problem with the Samba Server on my Router Linksys WRT1900ACS.<br />With the stock-fw the sharing runs very well.<br />But with the&nbsp; OpenWrt Chaos Calmer 15.05.1&nbsp; &nbsp;image I am getting each time when I try to open the share folder a &#039;Permission denied&#039;.<br />The USB3-HDD (3TB/2.7TiB) is mounted correctly, I can access it via ssh (of course I don&#039;t mean SFTP) but not through the Windoof Explorer, so I tried Linux Mint - and -- same Problem.<br />I used this Howto to set up the sharing: <a href="https://wiki.openwrt.org/doc/recipes/usb-storage-samba-webinterface">*klick*</a></p><p>Can anyone help me to fix this?</p><p>Best regards,<br />matze <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333254">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">RangerZ</div>
					<div class="post-datetime">
						4 Aug 2016, 19:54					</div>
				</div>
				<div class="post-content content">
					<p>There are prerequisites of Basic USB support, USB Storage, Samba, and Samba How To (follow the links) which you should confirm you have also followed.&nbsp; If you did not create firewall rules or permissions you missed something.&nbsp; Probably want to see this if you have NTFS running:&nbsp; <a href="https://wiki.openwrt.org/doc/howto/writable_ntfs">https://wiki.openwrt.org/doc/howto/writable_ntfs</a></p><p>List the packages you installed for USB support including the file system and how your device is formatted.&nbsp; </p><p>NTFS has been reported to be slooow.&nbsp; If you expect this to be a NAS, with any file system, you will probably be disappointed.&nbsp; Search the forum for NAS.</p><p>I never got NTFS working and only now use USB devices on my travel routers, mostly for media streaming.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333256">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Garionion</div>
					<div class="post-datetime">
						4 Aug 2016, 20:16					</div>
				</div>
				<div class="post-content content">
					<p>oh, I&#039;ve forgotten to tell you, that I formatted the HDD with ext4.<br />Packages for USB-Support, that are installed on my Router:<br /></p><div class="codebox"><pre><code>-block-mount
-kmod-fs-ext4
-kmod-usb-core
-kmod-usb-storage
-kmod-usb2
-kmod-usb3
-luci-app-samba
-luci-i18n-samba-de
-samba36-server</code></pre></div><p>But I didn&#039;t create firewall rules, because I don&#039;t know which ...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333288">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">eduperez</div>
					<div class="post-datetime">
						5 Aug 2016, 00:02					</div>
				</div>
				<div class="post-content content">
					<p>This does not look like a firewall / mount problem, but a SAMBA misconfiguration; please post your configuration files here.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333303">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">ckm</div>
					<div class="post-datetime">
						5 Aug 2016, 01:49					</div>
				</div>
				<div class="post-content content">
					<p><a href="https://www.youtube.com/watch?v=u_ReoGE4Jb8">https://www.youtube.com/watch?v=u_ReoGE4Jb8</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333311">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">RangerZ</div>
					<div class="post-datetime">
						5 Aug 2016, 06:26					</div>
				</div>
				<div class="post-content content">
					<p>I also install either kmod-usb-ohci or kmod-usb-uhci depending on the hardware, but I think these are usb1.1 and that you may have it covered with kmod-usb-2.</p><p>The firewall rules are here <a href="http://wiki.openwrt.org/doc/howto/cifs.server">http://wiki.openwrt.org/doc/howto/cifs.server</a> </p><p>Like ed says, post your configs.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333439">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">Garionion</div>
					<div class="post-datetime">
						6 Aug 2016, 10:14					</div>
				</div>
				<div class="post-content content">
					<p>These are my Config-Files, I only edited them via LuCI:<br />/etc/config/samba<br /></p><div class="codebox"><pre><code>config samba
        option name &#039;OpenWrt&#039;
        option charset &#039;UTF-8&#039;
        option interface &#039;loopback lan&#039;
        option description &#039;OpenWrt&#039;
        option workgroup &#039;Workgroup&#039;
        option homes &#039;1&#039;

config sambashare
        option name &#039;Elements&#039;
        option path &#039;/mnt&#039;
        option read_only &#039;no&#039;
        option guest_ok &#039;yes&#039;</code></pre></div><p>/etc/samba/smb.conf.template<br /></p><div class="codebox"><pre><code>[global]
    netbios name = |NAME| 
    display charset = |CHARSET|
    interfaces = |INTERFACES|
    server string = |DESCRIPTION|
    unix charset = |CHARSET|
    workgroup = |WORKGROUP|
    browseable = yes
    deadtime = 30
    domain master = yes
    encrypt passwords = true
    enable core files = no
    guest account = nobody
    guest ok = yes
    invalid users = root
    local master = yes
    load printers = no
    map to guest = Bad User
    max protocol = SMB2
    min receivefile size = 16384
    null passwords = yes
    obey pam restrictions = yes
    os level = 20
    passdb backend = smbpasswd
    preferred master = yes
    printable = no
    security = user
    smb encrypt = disabled
    smb passwd file = /etc/samba/smbpasswd
    socket options = TCP_NODELAY IPTOS_LOWDELAY
    syslog = 2
    use sendfile = yes
    writeable = yes
    </code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333486">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">eduperez</div>
					<div class="post-datetime">
						6 Aug 2016, 20:56					</div>
				</div>
				<div class="post-content content">
					<p>Files seem ok... did you remember to create the &quot;guest&quot; account?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333488">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">Garionion</div>
					<div class="post-datetime">
						6 Aug 2016, 21:11					</div>
				</div>
				<div class="post-content content">
					<p>ok, I added the user &#039;guest&#039;. firstly to the system, then to samba.<br />I still get a Permission Denied.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333503">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">eduperez</div>
					<div class="post-datetime">
						7 Aug 2016, 00:23					</div>
				</div>
				<div class="post-content content">
					<p>When you try to connect, do you see anything in the logs at the router?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333516">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">RangerZ</div>
					<div class="post-datetime">
						7 Aug 2016, 01:50					</div>
				</div>
				<div class="post-content content">
					<p>Please also post your fstab file</p><p>I have the following lines for permissions in each section of my &quot;config sambashare&quot;<br />&nbsp; &nbsp; option create_mask &#039;0700&#039;<br />&nbsp; &nbsp; option dir_mask &#039;0700&#039;<br /><a href="https://wiki.openwrt.org/doc/uci/samba">https://wiki.openwrt.org/doc/uci/samba</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333519">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">mikemccartney</div>
					<div class="post-datetime">
						7 Aug 2016, 02:55					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m not sure this will help, but i had a similar problem with an ext4 drive connected to my WRT1200 running CC 15.05.1, got permission denied when i tried to do anything, nothing i did with Samba corrected the problem, so i disconnected the drive from my WRT1200 and connected it to my linux&nbsp; laptop and checked permissions, root was owner and had full permissions, root was group and and had access/read permission, so i changed owner to myself and group to myself with same permissions, hooked it back up to my WRT1200 and it worked fine.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333640">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">Garionion</div>
					<div class="post-datetime">
						8 Aug 2016, 13:43					</div>
				</div>
				<div class="post-content content">
					<p>Thanks, the permissions were the problem<br />==SOLVED==</p><p><img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>