<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Looking for way to quickly load 35 static leases on 15.05</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 21 Apr 2018 and 30 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=63029&amp;p=2.html">2</a></li></ul></nav></div>
			
		
		
			<article class="post" id="p312979">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">DonJuane</div>
					<div class="post-datetime">
						28 Feb 2016, 23:27					</div>
				</div>
				<div class="post-content content">
					<p>I am slowly switching my routers from dd-wrt to OpenWRT.&nbsp; &nbsp;With dd-wrt I could set 2 nvram variables using a script to load my 35 desired static leases permanently (or until the next major crash LOL).</p><p>Can I do this with OpenWRT?&nbsp; &nbsp;I can&#039;t seem to find a way to do it.&nbsp; Entering &quot;nvram show&quot; tells me that nvram is not available.&nbsp; &nbsp;Not looking to get too deep in this, just want a way to quickly reload my static release table when I have to reconfigure my router for any reason.</p><p>Thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p312986">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Max Hopper</div>
					<div class="post-datetime">
						28 Feb 2016, 23:57					</div>
				</div>
				<div class="post-content content">
					<p>Correct. NVRAM is passé.</p><p>Use <a href="https://wiki.openwrt.org/doc/uci">UCI</a>.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p312990">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">DonJuane</div>
					<div class="post-datetime">
						29 Feb 2016, 00:27					</div>
				</div>
				<div class="post-content content">
					<p>Looks like this is the way you do it.&nbsp; <a href="https://wiki.openwrt.org/doc/uci/dhcp">https://wiki.openwrt.org/doc/uci/dhcp</a> <br />(under Static Leases)</p><br /><p> I still will need to figure out a way to do it from a script or batch file methodology while calling out the action 35 times.&nbsp; &nbsp;Can this be done from the console or a batch file?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p312992">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">tmo26</div>
					<div class="post-datetime">
						29 Feb 2016, 00:40					</div>
				</div>
				<div class="post-content content">
					<p>see <a href="https://wiki.openwrt.org/doc/uci">https://wiki.openwrt.org/doc/uci</a></p><p>-&gt; search for &quot;batch&quot;</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p313017">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">DonJuane</div>
					<div class="post-datetime">
						29 Feb 2016, 06:33					</div>
				</div>
				<div class="post-content content">
					<p>Thanks ....</p><p>&quot;It&#039;s always something ...&quot;&nbsp; (they say)</p><p>batch: Executes a multi-line UCI script which is typically wrapped into a here document syntax.</p><p>If only we knew what a &quot;here&quot; (italics used for emphasis) document syntax was ;-)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p313021">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">DonJuane</div>
					<div class="post-datetime">
						29 Feb 2016, 07:29					</div>
				</div>
				<div class="post-content content">
					<p>Googling &quot;OpenWRT uci batch&quot; ............</p><p>(Just looking for a batch file to add multiple Static leases)</p><br /><p>----------------------------------<br /><a href="https://wiki.openwrt.org/doc/uci/dhcp">https://wiki.openwrt.org/doc/uci/dhcp</a></p><p>Static Leases</p><p>You can assign fixed IP addresses to hosts on your network, based on their MAC (hardware) address.</p><p>The configuration options in this section are used to construct a -G option for dnsmasq.</p><p>config host<br />&nbsp; &nbsp; &nbsp; &nbsp; option ip&nbsp; &nbsp; &nbsp; &nbsp;&#039;192.168.1.2&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option mac&nbsp; &nbsp; &nbsp; &#039;00:11:22:33:44:55&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option name&nbsp; &nbsp; &nbsp;&#039;mypc&#039;</p><p>-------------------<br /><a href="https://dev.openwrt.org/browser/trunk/package/base-files/files/lib/functions/uci-defaults.sh?rev=36278">https://dev.openwrt.org/browser/trunk/p … ?rev=36278</a></p><p>#!/bin/sh<br />2&nbsp; &nbsp; # Copyright (C) 2011 OpenWrt.org<br />3&nbsp; &nbsp; <br />4&nbsp; &nbsp; UCIDEF_LEDS_CHANGED=0<br />5&nbsp; &nbsp; <br />6&nbsp; &nbsp; ucidef_set_led_netdev() {<br />7&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;local cfg=&quot;led_$1&quot;<br />8&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;local name=$2<br />9&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;local sysfs=$3<br />10&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;local dev=$4<br />11&nbsp; &nbsp; <br />12&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;uci -q get system.$cfg &amp;&amp; return 0<br />13&nbsp; &nbsp; <br />14&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;uci batch &lt;&lt;EOF<br />15&nbsp; &nbsp; set system.$cfg=&#039;led&#039;<br />16&nbsp; &nbsp; set system.$cfg.name=&#039;$name&#039;<br />17&nbsp; &nbsp; set system.$cfg.sysfs=&#039;$sysfs&#039;<br />18&nbsp; &nbsp; set system.$cfg.trigger=&#039;netdev&#039;<br />19&nbsp; &nbsp; set system.$cfg.dev=&#039;$dev&#039;<br />20&nbsp; &nbsp; set system.$cfg.mode=&#039;link tx rx&#039;<br />21&nbsp; &nbsp; EOF<br />22&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;UCIDEF_LEDS_CHANGED=1<br />23&nbsp; &nbsp; }</p><p>-----------------------------<br /><a href="https://forum.openwrt.org/viewtopic.php?id=17398">https://forum.openwrt.org/viewtopic.php?id=17398</a></p><p>#!/bin/sh</p><p>uci batch &lt;&lt;-EOF<br />&nbsp; &nbsp;#..... other non relevant code removed </p><p>&nbsp; &nbsp; # Set a static leases<br />&nbsp; &nbsp; add luci_ethers static_lease<br />&nbsp; &nbsp; set luci_ethers.@static_lease[-1].macaddr=&#039;00:0c:29:f0:a5:5e&#039;<br />&nbsp; &nbsp; set luci_ethers.@static_lease[-1].ipaddr=&#039;192.168.1.222&#039;<br />&nbsp; &nbsp; commit luci_ethers</p><p>&nbsp; &nbsp; # Set a different IP address for LAN<br />&nbsp; &nbsp; set network.lan.ipaddr=192.168.0.1<br />&nbsp; &nbsp; commit network<br />EOF</p><p>-----------------</p><p>Having a tough time following any of this.&nbsp; &nbsp;If I could find an example that shows a script adding more than one static lease, then I could likely expand on it.&nbsp; The questions these references generate otherwise - which technique should I use, what&#039;s the [-1] for (e.g. is a second one added with a suffex of [-2] ???</p><p>Other drift on topic .....<br /><a href="https://dev.openwrt.org/ticket/10789">https://dev.openwrt.org/ticket/10789</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p313026">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">makro</div>
					<div class="post-datetime">
						29 Feb 2016, 08:52					</div>
				</div>
				<div class="post-content content">
					<p>I would create a shell script with a function to add one static lease, and just call the function for each lease (mostly because I haven&#039;t learned to use uci batch properly). Something along these lines (I can&#039;t test it at the moment, but you get the idea):</p><div class="codebox"><pre><code>#!/bin/sh

add_lease () {
    uci add dhcp host
    uci set dhcp.@host[-1].ip=&quot;$1&quot;
    uci set dhcp.@host[-1].mac=&quot;$2&quot;
    uci set dhcp.@host[-1].name=&quot;$3&quot;
}

add_lease &quot;192.168.1.32&quot; &quot;00:11:22:33:44:55&quot; &quot;MethLabDesktop&quot;
add_lease &quot;192.168.1.224&quot; &quot;66:77:88:99:AA.BB&quot; &quot;AVReceiver&quot;
add_lease &quot;192.168.10.3&quot; &quot;BB:AA:CC:33:22:87&quot; &quot;boink&quot;

# ... this goes on ...

# When done, save all the changes made
uci -q commit

exit 0</code></pre></div><p>There are of course a variety of possible improvements:<br /></p><ul><li><p>Use the section identifier returned by uci add, instead of just editing the last one added (@host[-1])</p></li><li><p>Validating input to add_lease</p></li><li><p>Checking that the lease was added as intended (uci get to see if it returns expected results)</p></li></ul><p>You asked what [-1] means, see <a href="https://wiki.openwrt.org/doc/uci#uci_paths">doc/uci#uci_paths</a>. In this script, it adds the ip, mac and name options to the <em>last added</em> host section. I assume that uci paths can refer to not yet committed sections, but as mentioned, it&#039;s not tested.</p><p>There are of course other ways to add the leases too instead of listing them out in the script itself. If you have them in a parsable file format, you could read one lease at a time from the file instead. But generating a number of lines with add_lease &quot;your&quot; &quot;config&quot; &quot;values&quot; shouldn&#039;t be to difficult in any language, so you can paste them into the script.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p313028">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">DonJuane</div>
					<div class="post-datetime">
						29 Feb 2016, 09:11					</div>
				</div>
				<div class="post-content content">
					<p>Thank you, I&#039;ll give it a whirl when I return home tomorrow.</p><p>Just out of curiosity, I wonder if this would be correct syntax <br />(saying this not knowing correct .sh syntax but being a highly uneducated guesser)</p><p>&nbsp; &nbsp; uci add dhcp host<br />&nbsp; &nbsp; uci set dhcp.@host[-1].ip=&quot;x.x.x.x&quot;<br />&nbsp; &nbsp; uci set dhcp.@host[-1].mac=&quot;a:b:c:d&quot;<br />&nbsp; &nbsp; uci set dhcp.@host[-1].name=&quot;rocky&quot;<br />&nbsp; &nbsp; uci add dhcp host<br />&nbsp; &nbsp; uci set dhcp.@host[-1].ip=&quot;y.y.y.y&quot;<br />&nbsp; &nbsp; uci set dhcp.@host[-1].mac=&quot;d:c:b:a&quot;<br />&nbsp; &nbsp; uci set dhcp.@host[-1].name=&quot;crunchy&quot;<br />&nbsp; &nbsp; uci add dhcp host<br />&nbsp; &nbsp; uci set dhcp.@host[-1].ip=&quot;z.z.z.z&quot;<br />&nbsp; &nbsp; uci set dhcp.@host[-1].mac=&quot;0:1:b:a&quot;<br />&nbsp; &nbsp; uci set dhcp.@host[-1].name=&quot;sketchy&quot;</p><p># ... this goes on ...</p><p># When done, save all the changes made<br />uci -q commit</p><p>exit 0</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p313029">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">DonJuane</div>
					<div class="post-datetime">
						29 Feb 2016, 09:22					</div>
				</div>
				<div class="post-content content">
					<p>Another point of curiosity (not to muddy the already zero viz) is about this DNSMasq feature. <a href="https://wiki.openwrt.org/doc/howto/dhcp.dnsmasq">https://wiki.openwrt.org/doc/howto/dhcp.dnsmasq</a></p><p>&nbsp; &nbsp;This wiki says it is included in OpenWRT.&nbsp; &nbsp;Not sure how it all ties together and not sure why static leases are mentioned with this occasionally while I have been researching.&nbsp; &nbsp;Perhaps only coincidence.&nbsp; </p><p>Regardless, it seems like a nice feature to have, a DNS cache.&nbsp; &nbsp;I would also like to add the feature someday, one that I have read about that installs a small webserver and reroutes all the ad site links to your webserver which returns a 1 byte gif to the browser.&nbsp; &nbsp; At this rate I&#039;ll be too old to remember what a router does by the time I figure all this out.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p313035">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">Max Hopper</div>
					<div class="post-datetime">
						29 Feb 2016, 10:32					</div>
				</div>
				<div class="post-content content">
					<p>Why is this question being <a href="https://forum.openwrt.org/viewtopic.php?id=56087">cross-posted</a>?</p><div class="quotebox"><cite>DonJuane wrote:</cite><blockquote><p><strong>Looking for way</strong> to quickly...<br />...my 35 <strong>desired</strong> static leases permanently... <br />Not looking to get too deep in this, <strong>just want</strong> a way...</p></blockquote></div><p>and then this -</p><div class="quotebox"><cite>DonJuane wrote:</cite><blockquote><p>If only we <em>[sic]</em> knew what a &quot;here&quot;... <a href="http://bfy.tw/4VJT">documentation</a></p></blockquote></div><div class="quotebox"><cite>DonJuane wrote:</cite><blockquote><p> I am not a developer or Linux expert...</p></blockquote></div><p>And I am not a requirements analyst <strong>but</strong> 35 static leases?!? Are these IP cameras? Or devices devoid of a DHCP client? And deployed over a <a href="https://en.wikipedia.org/wiki/Customer-premises_equipment">CPE</a>-grade device?</p><div class="quotebox"><cite>DonJaune wrote:</cite><blockquote><p>This wiki says it [DNSmasq] is included in OpenWRT.</p></blockquote></div><p>Are you doubting the veracity of the wiki? <strong>HINT</strong>: it does.</p><p>Returning to an amateur sleuthing role, the facts we have thus far indicate a knowledge gap and an admitted lack of (self) interest to rectify same.</p><p>Thus,</p><ul><li><p>Why 35 devices?</p></li><li><p>Why is a script [<a href="http://www.businesszone.co.uk/community-voice/blogs/businessnlpacademy/if-you-always-do-what-youve-always-done-youll-always-get">?</a>] preferable over directly configuring UCI?</p></li><li><p>Why employ a script <em>or</em> UCI configuration when OpenWrt directly supports additional DNSmasq directives?</p></li></ul><p>Ergo, <a href="http://www.thekelleys.org.uk/dnsmasq/docs/dnsmasq-man.html">DNSmasq</a> (self-help). <strong>HINT</strong>: &#039;--dhcp-host&#039;</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p313068">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">DonJuane</div>
					<div class="post-datetime">
						29 Feb 2016, 15:45					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Max Hopper wrote:</cite><blockquote><p>Why is this question being <a href="https://forum.openwrt.org/viewtopic.php?id=56087">cross-posted</a>?</p></blockquote></div><p>I didn&#039;t get an answer in the first one, don&#039;t have the authority to delete the original and I was hoping after searching for 8 hours, somewhat later asking here and not getting an answer in this thread, while even later finding another thread with the same subject matter of which I was wishing an answer would perhaps flag with the subscription the owners of the original post and inspire them to respond to me, since I can&#039;t seem to find a way to private message someone and because I assumed that not everyone monitors this forum on a daily basis.</p><div class="quotebox"><cite>Max Hopper wrote:</cite><blockquote><p> Returning to an amateur sleuthing role, the facts we have thus far indicate a knowledge gap and an admitted lack of (self) interest to rectify same.</p></blockquote></div><p>Since you don&#039;t know me, I&#039;ll assume you talk like this to strangers to relieve some inner pain in your life.&nbsp; &nbsp;My condolences for you.&nbsp; Personally,&nbsp; I&#039;m doing the best with what I&#039;ve got.&nbsp; &nbsp;Your mileage may vary.&nbsp; &nbsp;And in case you are genuinely interested I have a rather high level of self esteem, high enough to ignore such derogatory remarks received here and otherwise.&nbsp; </p><div class="quotebox"><cite>Max Hopper wrote:</cite><blockquote><p>ReThus,</p><ul><li><p>Why 35 devices?</p></li><li><p>Why is a script [<a href="http://www.businesszone.co.uk/community-voice/blogs/businessnlpacademy/if-you-always-do-what-youve-always-done-youll-always-get">?</a>] preferable over directly configuring UCI?</p></li><li><p>Why employ a script <em>or</em> UCI configuration when OpenWrt directly supports additional DNSmasq directives?</p></li></ul></blockquote></div><p>1) my answer is not relevant to need&nbsp; (I&#039;ve already been criticized for talking too much so why elaborate)<br />2) I don&#039;t follow you.&nbsp; &nbsp;I don&#039;t understand the contrived multiple bracketed &quot;language&quot; that has been adopted over the old style &#039;set variable = &quot;value&quot;&#039; syntax.&nbsp; &nbsp;Nothing personal to you or the master effort of OpenWRT.&nbsp; I just am not able to grasp it because it is foreign to me.&nbsp; &nbsp;<br />3) if I knew the answer to this question, I would like be a highly paid network engineer and not simply trying to add a few extra features to the family router</p><p>Hope this answers all of your questions and concerns and thanks to those who responded to mine.<br />Because something &quot;is written&quot; and perhaps by &quot;the highest authority of the land&quot;, it is not always true nor is it always understood.</p><div class="quotebox"><cite>Max Hopper wrote:</cite><blockquote><p>Ergo, <a href="http://www.thekelleys.org.uk/dnsmasq/docs/dnsmasq-man.html">DNSmasq</a> (self-help). <strong>HINT</strong>: &#039;--dhcp-host&#039;</p></blockquote></div><p>Again, back to the philosophy of just because something is printed does not always guarantee it always will be understood.&nbsp; &nbsp;Being more educated than someone else will create two schools of interest, one of a teacher who has a deep internal desire to and feels rewarded in educating a person of lesser knowledge and another school which will enjoy an elite status by condemning those of same.&nbsp; </p><p>And I close with a special thanks to all those who are teachers out there.</p>											<p class="post-edited">(Last edited by <strong>DonJuane</strong> on 29 Feb 2016, 15:53)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p313074">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						29 Feb 2016, 16:00					</div>
				</div>
				<div class="post-content content">
					<p>DonJuane, what is the input format of your 25 static leases?</p><p>In addition to uci, dnsmasq also supports the old /etc/ethers config which is a plaintext file with &quot;macaddr ipaddr&quot; pairs, one per row. You could simply write that file once and copy it to each router.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p313077">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">DonJuane</div>
					<div class="post-datetime">
						29 Feb 2016, 16:13					</div>
				</div>
				<div class="post-content content">
					<p>And speaking of philosophy, and where we all are in our level of education regarding networking, here are some more thoughts.&nbsp; &nbsp;I suppose OpenWRT is going to be encountering more and more growing pains in the future.&nbsp; There will be not only people like me, but many more who are migrating here as dd-wrt slows (or should I say &quot;bricks&quot;) down to the state it is in today and as Luci begins to make OpenWRT palatable for the &quot;less than expert in the field&quot;.&nbsp; </p><p>The dd-wrt software was perfect for the beginner to moderate, someone who could easily understand a concept such as the function of a simple DNS that brought name to number translation to the world of IP addresses, as well as the concept of caching that information in a buffer and making things speedier.&nbsp; &nbsp;So how does one obtain these features without pursuing a lengthy career (one which those who have long ago retired may have a desire to benefit from but no longer time to pursue), well I guess that is the eternal question.&nbsp; Some will make it hard for them and some will go the helpful and invest the pains-taking time to try to hand-hold and explain and some will intimidate in hopes of sending them on their merry way.&nbsp; &nbsp;But that&#039;s life ;-)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p313078">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">Max Hopper</div>
					<div class="post-datetime">
						29 Feb 2016, 16:33					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>DonJuane wrote:</cite><blockquote><p>&lt;rant&gt;<br />&lt;/rant&gt;</p></blockquote></div><p>For some inexplicable reason, a number of posters <span style="color: #cc8800">ass-u-me</span> that OpenWrt carries with its price, support.&nbsp; Indeed, it offers this venue for <strong>voluntary</strong> assistance, also for free.&nbsp; Why then are some insinuating that the product will fail to gain wider adoption sans a <strong>helpdesk</strong>?</p><p>Now, two posters, one being a Germany-based developer who is incredibly generous with his time, have requested information and offered answers albeit not on a <strong>handholding</strong> level.&nbsp; Where lies the responsibity to answer this topic?</p><p>&#039;dabbling&#039; in configuration of a system, via no less a script, on which one has admitted no knowledge of its operation, would to many seem unwise.</p><p>So, drop the fascination with hard-coding IP addresses and allow the built-in DNS service, which <strong>caches</strong> 150 URLs by default, to perform it&#039;s task.</p><p>BTW, dd-wrt includes an out-dated release of DNSmasq.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p313081">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">DonJuane</div>
					<div class="post-datetime">
						29 Feb 2016, 16:50					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jow wrote:</cite><blockquote><p>DonJuane, what is the input format of your 25 static leases?</p><p>In addition to uci, dnsmasq also supports the old /etc/ethers config which is a plaintext file with &quot;macaddr ipaddr&quot; pairs, one per row. You could simply write that file once and copy it to each router.</p></blockquote></div><p>I had to rush out of town and I don&#039;t have the exact syntax of the commands I was using, so I&#039;ll just go from memory.&nbsp; Just yesterday I lost my home OpenVPN server with a final fatal lockup of my dd-wrt powered Buffalo router, so I had to do something and quick.&nbsp; &nbsp;The lockups were frequent (and this my generated configuration scripts after constant restores).&nbsp; So because of this I decided to finally take the plunge and after investing the past 8 years or so in dd-wrt education, decided to forego that and attempt to get on board with OpenWRT because of the problems I am having everywhere with dd-wrt.&nbsp; Every version of the old firmware kept crashing my Buffalo router and because of that and other continuous problems with other routers I support, I just installed my first version of OpenWRT on the home router and I have not accomplished trying to get OpenVPN up on OpenWRT yet, so all my files servers are isolated at the moment and I cannot give you the exact syntax, but I wanted to go ahead and reply to you.....</p><p>Just from memory, I have some scripts in the format of <br />set static_leasenum=&quot;35&quot;<br />set static_leases = &quot;mac=ip=name= mac=ip=name mac=ip=name&quot;</p><p>I have a bunch of IP devices and various items that I access remotely and I have predefined Windows netbios sharing on my traveling laptop and having the exact IP address to VPN into my various devices and create a share, plus always knowing the IP address of the various Windows file shares and VOIP APN devices is invaluable when trying to access my home network remotely via a VPN.&nbsp; &nbsp;So that is why I lock in this subset of static IP addresses.</p><p>(Just call it blind hope that I believe after managing OpenVPN on dd-wrt, that I&#039;ll be successful installing and configuring it on OpenWRT soon)</p><p>Trying to speak in a language that makes sense from a user to an engineer perspective, let me say this.&nbsp; &nbsp; I like the concept of a cached DNS, I believe I had it working on dd-wrt but never was able to understand how to prove it was working.&nbsp; &nbsp;I would like to implement it again.&nbsp; &nbsp;Also from a very low level of understanding in my fresh attempt at understanding OpenWRT, I have discovered at lest two conflicting ways to add static leases to my machine, one that seems wrapped around a luci syntax and one that is somehow related to the DNSmasq feature, which I &quot;like the concept&quot; but know absolutely nothing about otherwise.&nbsp; </p><p>So in short:&nbsp; I would like ability to load in all my static IP leases with a script and use the DNSMasq feature, regardless of if it is related or not.&nbsp; Eventually it will be my goal to implement a method to load in all my configuration data via a script since I change out routers fairly often (stress testing at home and them moving to other family members or friends).&nbsp; Initially I am working on setting the static leases which I need first of all to ensure all my printers work, plus VOIP port forwards work and secondly to ensure I know what IP to access remotely via my (hopefully future) re-establishment of an OpenVPN server on my newly flashed OpenWRT router at my home.</p><p>THANKS!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p313083">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">DonJuane</div>
					<div class="post-datetime">
						29 Feb 2016, 17:00					</div>
				</div>
				<div class="post-content content">
					<p>Max:&nbsp; I don&#039;t call on developers for support, I call on curious knowledgeable users and people out there like me, who understand the rewards found in life of being kind, cheerful and helpful.&nbsp; &nbsp;I believe in the golden rule and &quot;pay it forward&quot;.&nbsp; &nbsp;It works for me well for these past many decades that I have struggled upon this big blue ball and I am quite happy with all the joy, energy, excitement, rewards and downright fun and pleasure that playing this crazy game has brought me.&nbsp; &nbsp;</p><p>Not sure why you picked me out of the crowd to come down on, but I hope you are having fun.&nbsp; It&#039;s always my desire to please, no matter what the intent.&nbsp; &nbsp;Enjoy life - have fun my friend.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p313087">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">Max Hopper</div>
					<div class="post-datetime">
						29 Feb 2016, 17:22					</div>
				</div>
				<div class="post-content content">
					<p><em>/etc/dnsmasq.conf</em> -</p><div class="codebox"><pre><code>dhcp-host=00:20:e0:3b:13:af,192.168.1.2,wap,infinite
...
dhcp-host=01:23:45:67:89:ab,192.168.1.36,zap,infinite</code></pre></div><div class="quotebox"><cite>Max Hopper wrote:</cite><blockquote><p><em>/etc/dnsmasq.conf</em>:<br />dhcp-host=00:A0:96:55:A5:85,192.168.2.250,Sony-Bravia,infinite</p></blockquote></div><div class="quotebox"><cite>LuCI wrote:</cite><blockquote><p>Active DHCP Leases<br />Hostname&nbsp; &nbsp; IPv4-Address&nbsp; &nbsp; &nbsp; &nbsp; MAC-Address&nbsp; &nbsp; &nbsp; &nbsp; Leasetime remaining<br />Sony-Bravia&nbsp; &nbsp; 192.168.2.250&nbsp; &nbsp; 00:a0:96:55:a5:85&nbsp; &nbsp; 11h 54m 22s</p></blockquote></div><p>- - - <em>or</em> - - -<br /></p><div class="quotebox"><cite>Max Hopper wrote:</cite><blockquote><p><em>/etc/config/dhcp</em>:<br />config host<br />&nbsp; &nbsp; option mac &#039;00:A0:96:55:A5:85&#039;<br />&nbsp; &nbsp; option name &#039;Sony-Bravia&#039;<br />&nbsp; &nbsp; option ip &#039;192.168.2.250&#039;</p></blockquote></div><div class="quotebox"><cite>LuCI wrote:</cite><blockquote><p>Active DHCP Leases<br />Hostname&nbsp; &nbsp; IPv4-Address&nbsp; &nbsp; &nbsp; &nbsp; MAC-Address&nbsp; &nbsp; &nbsp; &nbsp; Leasetime remaining<br />Sony-Bravia&nbsp; &nbsp; 192.168.2.250&nbsp; &nbsp; 00:a0:96:55:a5:85&nbsp; &nbsp; 11h 32m 45s</p></blockquote></div><p>HTH Chum</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p313100">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">makro</div>
					<div class="post-datetime">
						29 Feb 2016, 19:06					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>DonJuane wrote:</cite><blockquote><p>Just out of curiosity, I wonder if this would be correct syntax <br />(saying this not knowing correct .sh syntax but being a highly uneducated guesser)</p><p>&nbsp; &nbsp; uci add dhcp host<br />&nbsp; &nbsp; uci set dhcp.@host[-1].ip=&quot;x.x.x.x&quot;<br />&nbsp; &nbsp; uci set dhcp.@host[-1].mac=&quot;a:b:c:d&quot;<br />&nbsp; &nbsp; uci set dhcp.@host[-1].name=&quot;rocky&quot;<br />&nbsp; &nbsp; uci add dhcp host<br />&nbsp; &nbsp; uci set dhcp.@host[-1].ip=&quot;y.y.y.y&quot;<br />&nbsp; &nbsp; uci set dhcp.@host[-1].mac=&quot;d:c:b:a&quot;<br />&nbsp; &nbsp; uci set dhcp.@host[-1].name=&quot;crunchy&quot;<br />&nbsp; &nbsp; uci add dhcp host<br />&nbsp; &nbsp; uci set dhcp.@host[-1].ip=&quot;z.z.z.z&quot;<br />&nbsp; &nbsp; uci set dhcp.@host[-1].mac=&quot;0:1:b:a&quot;<br />&nbsp; &nbsp; uci set dhcp.@host[-1].name=&quot;sketchy&quot;</p></blockquote></div><p>Well yes, that is essentially the same, just with duplicating the uci calls instead of using a function. I tested my script, and it works as advertised. LuCI correctly identifies the static leases added by the script, which I take to mean it will work. On that topic, adding the leases to UCI (one way or another) is the only way the leases will show up in LuCI (I think), if that is of interest.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p313108">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">tmo26</div>
					<div class="post-datetime">
						29 Feb 2016, 19:47					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>DonJuane wrote:</cite><blockquote><p>Not sure why you picked me out of the crowd to come down on, but I hope you are having fun.</p></blockquote></div><p>Simply ignore people who seem to be rude for no reason.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p313175">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">Max Hopper</div>
					<div class="post-datetime">
						1 Mar 2016, 10:17					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>DonJuane wrote:</cite><blockquote><p>The dd-wrt software was perfect for the beginner to moderate, someone who could easily understand a concept such as the function of a simple DNS...<br />...after investing the past 8 years or so in dd-wrt education... [<em>and never learned that dd-wrt offers DNSmasq, Ed.</em>]<br />I have discovered [<em><strong>r</strong>eading <strong>t</strong>he <strong>f</strong>ine <strong>w</strong>iki is easier, Ed.</em>] at lest [<em>sic</em>] two conflicting ways to add static leases to my machine, one that seems wrapped [<em>wrapping, Ed.</em>] around a luci syntax [<em>Close. LuCI wraps UCI (its in the wiki), Ed.</em>]&nbsp; and one that is somehow related to the DNSmasq feature [<strong>HINT</strong>: OpenWrt implements DNS with DNSmasq.]</p></blockquote></div><p>Uh-huh.</p><div class="quotebox"><cite>DonJuane wrote:</cite><blockquote><p><strong>It works for me</strong> well for these past many decades... <strong>I have struggled</strong> ...</p></blockquote></div><p>An amusing technique, self-contradiction. Are you a (Republican) politician?</p><div class="quotebox"><cite>DonJuane wrote:</cite><blockquote><p>...with a final fatal lockup of my dd-wrt powered Buffalo router,...<br />The lockups were frequent...<br />because of the problems I am having everywhere with dd-wrt.&nbsp; Every version of the old firmware kept crashing my Buffalo router...</p></blockquote></div><p>Wow! Software, due to its age, fails? Quick! Someone ring NASA about their Voyager probes running programs written in 1975. Or do you write situation comedies?</p><p>To the point - if you insist on following this course then I recommend dropping the script with it&#039;s inherent syntax pitfalls and embracing <a href="https://forum.openwrt.org/viewtopic.php?pid=313087#p313087">a single line per device directive</a> in <em>/etc/dnsmasq.conf</em>, which is far simpler to edit.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p313178">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						1 Mar 2016, 10:44					</div>
				</div>
				<div class="post-content content">
					<p>Max Hopper, would you please stop this unnecessary personal attacks? Having a (heated) discussion on technical matters fine but please don&#039;t resort to ad hominem.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p313194">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">Max Hopper</div>
					<div class="post-datetime">
						1 Mar 2016, 13:37					</div>
				</div>
				<div class="post-content content">
					<p>@jow - Correct you are. Nothing motivates people to learn except self-interest. No more flames.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p313328">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">DonJuane</div>
					<div class="post-datetime">
						2 Mar 2016, 17:34					</div>
				</div>
				<div class="post-content content">
					<p>Somehow I got unsubscribed to this thread and missed all the recent comments (which may be a good thing).&nbsp; &nbsp;Thanks everyone for your support.&nbsp; I&#039;ll say to everyone I&#039;m here for the long haul, even out of the gate falling right into someone&#039;s breakdown, I intend to continue to survive, despite those who would desire otherwise.</p><p>I am excited about learning OpenWRT and the stability it will provide my &quot;router hacking habit&quot;.&nbsp; I&#039;ve been using non-factory firmwares since the first LinkSys boxes which were released with a Linux base&nbsp; (long before dd-wrt, Tomato, OpenWRT, etc) and in brief, I believe it has been the user interface on these being powerful enough which has meant that participation in this community hasn&#039;t required a huge preexisting knowledge base such as understanding Linux at the developer level. </p><p>And in fact, I think that is a great way to learn, begin with a GUI dashboard presentation and discover what&#039;s going on behind the curtain as we progress.&nbsp; &nbsp;The fact that OpenWRT is starting to move toward support for &quot;my community&quot; with the GUI, documentation and other improvements, well I am quite happy with that and to reiterate, genuinely excited.&nbsp; &nbsp;Thanks again to those with support.&nbsp; &nbsp;It is appreciated.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p313334">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">DonJuane</div>
					<div class="post-datetime">
						2 Mar 2016, 17:58					</div>
				</div>
				<div class="post-content content">
					<p>And while on this subject, I have to say I was really impressed with the OpenWRT build that I just received on a GLI.net GL-AR150.&nbsp; &nbsp; The firmware as shipped offered a highly simplified product-level presentation window to first select language and from there another simple menu to select the function you wanted, either the device would perform as Access Point, Client or mi-fi-style USB modem hotspot.&nbsp; &nbsp;Three simple choices with cutesie icons and easy to configure within minutes.&nbsp; &nbsp;</p><p>At the upper right of this simplified web page, there was the &quot;advanced tab&quot; which would take you the the full production OpenWRT luci inteface.&nbsp; (Luckily, communication between the two was coordinated.)&nbsp; &nbsp;</p><p>I liked the method they used - very impressive for a Chinese router distributor compared to others I have seen.&nbsp; &nbsp;OpenWRT presented in elementary, advanced and of course super advanced for beyond the GUI.&nbsp; &nbsp;Fits all needs.</p><p>******* While I kept the shipped release on one AR150 device, I have ordered others and chose to replace the distributed firmware with the OpenWRT port now being supplied as ROOter by ofmodemsandmen.com.&nbsp; &nbsp;The one major downside to the Chinese distribution version was support for only modems from China telcom which rendered their distribution as serving mostly the traveler with AP/Client/Repeater style needs.&nbsp; &nbsp;The ROOter support group has built a highly impressive list of supported USB modems to ride on top of the recent Chaos Calmer release of OpenWRT, which now makes this device a spectacular option for dropping in the suitcase as well as other small-platform implementations.</p>											<p class="post-edited">(Last edited by <strong>DonJuane</strong> on 2 Mar 2016, 18:12)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p313352">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">Max Hopper</div>
					<div class="post-datetime">
						2 Mar 2016, 20:56					</div>
				</div>
				<div class="post-content content">
					<p>Have I misunderstood and that <a href="http://forum.openwrt.org">this</a> is actually a blog?</p>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=63029&amp;p=2.html">2</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>