<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> ar9331&#039;s usb stability issue - [SOLVED]</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 23 Mar 2017 and 6 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 5 of 13</div><nav><ul><li><a href="viewtopic.php%3Fid=39956&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=39956&amp;p=3.html">3</a></li><li><a href="viewtopic.php%3Fid=39956&amp;p=4.html">4</a></li><li class="pagination-current"><span>5</span></li><li><a href="viewtopic.php%3Fid=39956&amp;p=6.html">6</a></li><li><a href="viewtopic.php%3Fid=39956&amp;p=7.html">7</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=39956&amp;p=13.html">13</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p185929">
				<div class="post-metadata">
					<div class="post-num">Post #101</div>
					<div class="post-author">lsoltero</div>
					<div class="post-datetime">
						13 Dec 2012, 16:10					</div>
				</div>
				<div class="post-content content">
					<p>hello all,</p><p>i just want to take a few minutes to sum up the facts... there is a lot of information here and for someone new to this it might be a bit overwhelming.</p><p>1. All AR9331 based routers suffer USB 1.1 to USB 2.0 interoperability problems.<br />2. when purchasing routers from a single vendor some routers fail immediately, some routers work perfectly, some routers work some of the time.&nbsp; For example, I have 11 alfa AP121U routers here 5 of them fail immediately 5 of them work perfectly and one of them works some of the time.<br />3. the problem is somehow related to WiFi.&nbsp; When you disable the WiFi the problem goes away.<br />4. The problem can be resolved in every single case by using a passive USB 2.0 hub<br />5. The problem only happens with USB bulk transfers.&nbsp; Isochronous transfers seem to be OK.<br />6. the problem is not a power supply issue<br />7. this is not related to the place of manufacture of the chipset (happens with both korean and taiwan made chips) or version.</p><br /><p>did i miss anything?</p><p>--luis</p>											<p class="post-edited">(Last edited by <strong>lsoltero</strong> on 13 Dec 2012, 16:26)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p185930">
				<div class="post-metadata">
					<div class="post-num">Post #102</div>
					<div class="post-author">Squonk</div>
					<div class="post-datetime">
						13 Dec 2012, 16:23					</div>
				</div>
				<div class="post-content content">
					<p>Good summary!</p><p>Adding a large capacitor across USB GND/VBUS does not help.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p187260">
				<div class="post-metadata">
					<div class="post-num">Post #103</div>
					<div class="post-author">snowyowlster</div>
					<div class="post-datetime">
						28 Dec 2012, 18:18					</div>
				</div>
				<div class="post-content content">
					<p>Page 255 of the datasheet talks about USBMode and the Stream Disable Mode. By default the&nbsp; Stream Disable Mode is inactive.&nbsp; It appears that if it is made active - then overruns/underruns of the latency FIFO are eliminated for low bandwidth systems. </p><p>May be worth trying to set that bit&nbsp; 4 to &quot;1&quot;. </p><p>Ashok</p><div class="quotebox"><cite>Squonk wrote:</cite><blockquote><p>Be careful, some parts of the datasheet (p 237) which seem to be generic tell about low/full speed hand-off, but in some other parts, it is explicitly told that there is no hand-off (pp 251-252).</p><p>It isn&#039;t the circuit design: this happens on several models from TP-Link and Alfa (at least...) which only have in common that they are AR9331-based.</p><p>From my experience with the TP-Link T-WR703N, the routing is clean with controlled length and impedance traces, no stub, and only ESD protection devices in the middle.</p><p>It is not related to the chip revision either, but results may vary largely from one chip to the other.</p><p>Also, if you turn off the wireless, you have no longer problems... Same if you insert a passive hub.</p><p>It looks like wireless radio interferes with the USB clock PLL in some way, only in full-speed mode...</p><p>Any idea?</p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188411">
				<div class="post-metadata">
					<div class="post-num">Post #104</div>
					<div class="post-author">rickysland</div>
					<div class="post-datetime">
						9 Jan 2013, 15:28					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>rickysland wrote:</cite><blockquote><p>Hello, I have do some information.<br />see this:https://dev.openwrt.org/ticket/12385#ticket<br />Sorry for my poor English.</p><p>The main test is: shutdown your wifi($wifi down)，useing Physics line connect, the problem gone...</p></blockquote></div><p>I insert a passive USB hub to test my sound card, and i found it&#039;s more terrible then insert it direct. So I don&#039;t thing insert&nbsp; a passive USB hub is a good idea to slove this.<br />I&#039;m sure my hub is usb 2.0 because it show:usb 1-1: new high-speed USB device number 4 using ehci-platform</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188413">
				<div class="post-metadata">
					<div class="post-num">Post #105</div>
					<div class="post-author">rickysland</div>
					<div class="post-datetime">
						9 Jan 2013, 15:30					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>rickysland wrote:</cite><blockquote><div class="quotebox"><cite>rickysland wrote:</cite><blockquote><p>Hello, I have do some information.<br />see this:https://dev.openwrt.org/ticket/12385#ticket<br />Sorry for my poor English.</p><p>The main test is: shutdown your wifi($wifi down)，useing Physics line connect, the problem gone...</p></blockquote></div><p>I insert a passive USB hub to test my sound card, and i found it&#039;s more terrible then insert it direct. So I don&#039;t thing insert&nbsp; a passive USB hub is a good idea to slove this.<br />I&#039;m sure my hub is usb 2.0 because it show:usb 1-1: new high-speed USB device number 4 using ehci-platform</p></blockquote></div><p>useing sound card is very easy to found the usb problem. The sound chuck.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188414">
				<div class="post-metadata">
					<div class="post-num">Post #106</div>
					<div class="post-author">lsoltero</div>
					<div class="post-datetime">
						9 Jan 2013, 15:33					</div>
				</div>
				<div class="post-content content">
					<p>interesting...</p><p>We use a inexpensive full speed USB sound card in our application through a USB 2.0 HUB on Alfa hornet board without issue.&nbsp; &nbsp;I have tested this on 10 different hornet based routers without issue.&nbsp; &nbsp;The sound card we used is based on the CMedia 109 chipset.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p190164">
				<div class="post-metadata">
					<div class="post-num">Post #107</div>
					<div class="post-author">hot-dog</div>
					<div class="post-datetime">
						28 Jan 2013, 00:54					</div>
				</div>
				<div class="post-content content">
					<p>I can confirm that TL-MR3220v2 is also vulnerable. </p><p>I&#039;ve tried using it with FT232RL, and it works for a while, and then fails. </p><p>Normally shielding of USB is connected through 1nF to ground, tried to connect it directly to GND, leave it floating but its not helping.</p><p>Are the AR9341 powerd routers also vulnerable (TL-MR3420v2)?</p>											<p class="post-edited">(Last edited by <strong>hot-dog</strong> on 28 Jan 2013, 01:04)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p190168">
				<div class="post-metadata">
					<div class="post-num">Post #108</div>
					<div class="post-author">Squonk</div>
					<div class="post-datetime">
						28 Jan 2013, 01:18					</div>
				</div>
				<div class="post-content content">
					<p>I may be a little bit pessimistic, but as the thread title suggests it: all AR9331-based routers may be affected, until someone finds a workaround.</p><p>I tested on Ralink RT5350-based Hame MPR-A1 routers without any problem using LS/FS/HS USB devices...</p>											<p class="post-edited">(Last edited by <strong>Squonk</strong> on 28 Jan 2013, 01:18)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p190171">
				<div class="post-metadata">
					<div class="post-num">Post #109</div>
					<div class="post-author">snowyowlster</div>
					<div class="post-datetime">
						28 Jan 2013, 01:34					</div>
				</div>
				<div class="post-content content">
					<p>A data sheet of the AR9331 was posted on the web and I pulled it down and there<br />was a section in the datasheet which indicated that if the USB Mode register bit<br /> is enabled then the performance with lower speed USB devices would improve.</p><p> I made the change in dev-usb.c found in<br />trunk/target/linux/ar71xx/files/arch/mips/ar71xx/dev-usb.c<br />using some of the other fixes therein for other platforms as a template.&nbsp; Also have to make a small edit to the include file (don&#039;t remember which one&nbsp; - but it is pretty obvious). </p><p>Sorry to say that it did not change anything (I did verify that my modified file was being used to build the new firmware) </p><p>If I get some time I will look through the datasheet more and try other tweaks. The datasheet is on a Chinese site and a link to it can be found on either this thread or a similar thread in this forum. It would help if others try some tweaks&nbsp; and see if the problem gets fixed.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p190196">
				<div class="post-metadata">
					<div class="post-num">Post #110</div>
					<div class="post-author">hot-dog</div>
					<div class="post-datetime">
						28 Jan 2013, 10:54					</div>
				</div>
				<div class="post-content content">
					<p>I recon , that since all ar9331 are vulnerable, and turning off wi-fi helps, then its an hardware silicon issue.</p><p>Can anyone confirme tha ar9341 routers are NOT vulnerable?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193459">
				<div class="post-metadata">
					<div class="post-num">Post #111</div>
					<div class="post-author">lsoltero</div>
					<div class="post-datetime">
						28 Feb 2013, 16:39					</div>
				</div>
				<div class="post-content content">
					<p>hello all,</p><p>finally got a response from Atheros on the AR9331 USB 1.1 issue.&nbsp; I quote</p><p>&quot;They don’t want to fix the problem regarding USB1.1 because USB2.0 is the mainstream now. Furthermore, USB3.0 becomes more and more popular. So, the USB Hub will be necessary&quot;</p><br /><p>So there you have it.</p><p>--luis</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193460">
				<div class="post-metadata">
					<div class="post-num">Post #112</div>
					<div class="post-author">robthebrew</div>
					<div class="post-datetime">
						28 Feb 2013, 16:43					</div>
				</div>
				<div class="post-content content">
					<p>looks like there is a market for a really small hub. Even a one-one hub that would just sit in the socket and sort the issue.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193823">
				<div class="post-metadata">
					<div class="post-num">Post #113</div>
					<div class="post-author">doiga</div>
					<div class="post-datetime">
						4 Mar 2013, 23:49					</div>
				</div>
				<div class="post-content content">
					<p>For me this issue is somehow relative with power supply, because right now I have a TL-MR3040 and with a passive hub (either 1.1 or 2.0) the router still reset!!! Although when I external power (5v adapter) the hub trought R188 it work´s perfectly with a webcam and USB hard disc, but also with the 1.1 hub connected to 2.0 hub that is connected to the router!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193829">
				<div class="post-metadata">
					<div class="post-num">Post #114</div>
					<div class="post-author">Squonk</div>
					<div class="post-datetime">
						5 Mar 2013, 00:09					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>doiga wrote:</cite><blockquote><p>For me this issue is somehow relative with power supply, because right now I have a TL-MR3040 and with a passive hub (either 1.1 or 2.0) the router still reset!!! Although when I external power (5v adapter) the hub trought R188 it work´s perfectly with a webcam and USB hard disc, but also with the 1.1 hub connected to 2.0 hub that is connected to the router!</p></blockquote></div><p>No, I tried with the same power supply and a lot more devices powered through a passive hub without problem, just remove the hub and attach one single FS device and it crashed from within a few minutes up to 1 hour.</p><p>I tried to add a large electrolytic capacitor across VUSB, to no avail.</p><p>I looked at the voltage on the USB bus using a good scope: not a single glitch.</p><p>Tried with a stabilized bench power supply: same problem.</p><p>If you turn off WiFi, no more problem.</p><p>But the issue is not the router resetting like you: it is just the USB is not working any more.</p><p>You may well have a power supply issue if you try to connect too many devices, as a USB host port is only able to deliver 0.5A after negotiation.</p><p>I don&#039;t know what is R188 on the MR3040, but if it is the overcurrent protection chip bypass resistor, you are playing with fire...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193830">
				<div class="post-metadata">
					<div class="post-num">Post #115</div>
					<div class="post-author">lsoltero</div>
					<div class="post-datetime">
						5 Mar 2013, 00:13					</div>
				</div>
				<div class="post-content content">
					<p>we have qty 55 TL-MR3040 routers here which have been extensively tested...&nbsp; For our application the routers will fail without the passive 2.0 hub running on either battery or with external power.&nbsp; So... its not a issue with power.&nbsp; &nbsp;What is interesting is that some routers fail immediately and some will run for a long time before they fail... but eventually the all fail.&nbsp; So... it seems to be a thesholding related problem.&nbsp; &nbsp;You turn the wifi off an every single one of the them work fine.&nbsp; Note that 1.1 hub will not fix the issue. It has to be a 2.0 hub.</p><p>Look in above and you will find a discussion that pretty much eliminates power as the problem.&nbsp; &nbsp;So there may be power related issues with your application and this router but I don&#039;t think they are related to the Atheros 9331 bug that is being discussed in this thread.</p><p>Besides Atheros has confirmed that there is a problem with the processors USB 1.1 implementation.</p><p>take care.</p><p>--luis</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193832">
				<div class="post-metadata">
					<div class="post-num">Post #116</div>
					<div class="post-author">lizby</div>
					<div class="post-datetime">
						5 Mar 2013, 01:55					</div>
				</div>
				<div class="post-content content">
					<p>&gt;It has to be a 2.0 hub.</p><p>For clarification, as Squonk has pointed out, the hub has to be not only 2.0, but &quot;high speed&quot; as reported in dmesg as opposed to &quot;full speed&quot;.&nbsp; I have bought a number of 2.0 hubs off of ebay which were advertised as &quot;high speed&quot;, but they were actually &quot;full speed&quot;, and still had the problem of serial usb halting.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193850">
				<div class="post-metadata">
					<div class="post-num">Post #117</div>
					<div class="post-author">nozombian</div>
					<div class="post-datetime">
						5 Mar 2013, 09:20					</div>
				</div>
				<div class="post-content content">
					<p>In a case I&#039;d ran into device with ar9331, can you please confirm, that the problem appears only with usb 1.x devices, but usb 2.0 and 3.0 devices are working fine? I&#039;m not going to use usb 1.1 at all.</p><p>Btw. is there some device list with ar9331? Many wiki pages do not mention the SoC, just the CPU, it would be better to avoid them completely. I&#039;d like to obtain wr842, but no SoC mentioned: <a href="http://wiki.openwrt.org/toh/tp-link/tl-mr3420">http://wiki.openwrt.org/toh/tp-link/tl-mr3420</a></p>											<p class="post-edited">(Last edited by <strong>nozombian</strong> on 5 Mar 2013, 09:42)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193856">
				<div class="post-metadata">
					<div class="post-num">Post #118</div>
					<div class="post-author">Squonk</div>
					<div class="post-datetime">
						5 Mar 2013, 10:16					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nozombian wrote:</cite><blockquote><p>In a case I&#039;d ran into device with ar9331, can you please confirm, that the problem appears only with usb 1.x devices, but usb 2.0 and 3.0 devices are working fine? I&#039;m not going to use usb 1.1 at all.</p></blockquote></div><p>See lizby&#039;s reply above: USB 1.1, 2.0 or 3.0 doesn&#039;t tell you at what speed the device is running!</p><p>AR9331 USB is not working at low-speed and has problems at full-speed, so USB 1.1 devices will not work reliably, but USB 2.0 or 3.0 may also experience problems if they run at these speeds.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193862">
				<div class="post-metadata">
					<div class="post-num">Post #119</div>
					<div class="post-author">nozombian</div>
					<div class="post-datetime">
						5 Mar 2013, 11:52					</div>
				</div>
				<div class="post-content content">
					<p>Thank you Squonk for clarification. That makes usb on ar9331 w/o hub pretty useless <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /> Announcing a list which devices contain this bug would be nice.</p>											<p class="post-edited">(Last edited by <strong>nozombian</strong> on 5 Mar 2013, 11:53)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193893">
				<div class="post-metadata">
					<div class="post-num">Post #120</div>
					<div class="post-author">doiga</div>
					<div class="post-datetime">
						5 Mar 2013, 18:11					</div>
				</div>
				<div class="post-content content">
					<p>Yes, by turning wifi off is one of the solutions!</p><br /><p>Facts, at least with my MR3040:</p><p>-&gt;With a <strong>passive hub 2.0 high-speed</strong> when I plug it just resets instantly, or during boot with wifi turning ON it resets!</p><p>-&gt;With a <strong>external power</strong> hub 1.0/2.0 even with wifi ON it work&#039;s perfectly (and for days);</p><p>Normal boot with external power hub 2.0 high speed<br /></p><div class="codebox"><pre><code>[    7.630000] SCSI subsystem initialized
[    7.810000] usbcore: registered new interface driver usbfs
[    7.810000] usbcore: registered new interface driver hub
[    7.820000] usbcore: registered new device driver usb
[    8.250000] ehci_hcd: USB 2.0 &#039;Enhanced&#039; Host Controller (EHCI) Driver
[    8.260000] ehci-platform: EHCI generic platform driver
[    8.270000] ehci-platform ehci-platform: EHCI Host Controller
[    8.270000] ehci-platform ehci-platform: new USB bus registered, assigned bus number 1
[    8.280000] ehci-platform ehci-platform: irq 3, io mem 0x1b000000
[    8.310000] ehci-platform ehci-platform: USB 2.0 started, EHCI 1.00
[    8.310000] hub 1-0:1.0: USB hub found
[    8.310000] hub 1-0:1.0: 1 port detected
[    8.410000] ohci_hcd: USB 1.1 &#039;Open&#039; Host Controller (OHCI) Driver
[    8.540000] uhci_hcd: USB Universal Host Controller Interface driver
[    8.560000] Initializing USB Mass Storage driver...
[    8.560000] usbcore: registered new interface driver usb-storage
[    8.570000] USB Mass Storage support registered.
[    8.660000] usb 1-1: new high-speed USB device number 2 using ehci-platform
[    8.810000] hub 1-1:1.0: USB hub found
[    8.810000] hub 1-1:1.0: 4 ports detected</code></pre></div><p>BTW what´s your settings for: channel, transmit power, mode, HT mode and country.</p>											<p class="post-edited">(Last edited by <strong>doiga</strong> on 6 Mar 2013, 17:05)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p194004">
				<div class="post-metadata">
					<div class="post-num">Post #121</div>
					<div class="post-author">tuwuhs</div>
					<div class="post-datetime">
						6 Mar 2013, 13:08					</div>
				</div>
				<div class="post-content content">
					<p>Hello all,<br />sorry for interrupting.<br />I tried several USB-to-serial converters, and mainly used PL2303-based converters.<br />Just want to confirm:<br />- Same issue on TL-MR3020, worked for some minutes then it hangs completely<br />- If WLAN is turned off, all works well<br />- Powered USB 1.0 hub does not help (so it is not a power issue)<br />- Unpowered USB 2.0 hub does not help either<br />- I got it working perfectly on TL-MR3420 (@hot-dog so I think it&#039;s not a problem with this model)</p><p>I&#039;ve posted in TL-MR3020 support thread (<a href="https://forum.openwrt.org/viewtopic.php?pid=159101#p159101">https://forum.openwrt.org/viewtopic.php … 01#p159101</a>)<br />I think it is safe to assume that this problem can only sometimes be solved using a hub (which still fails on me)</p>											<p class="post-edited">(Last edited by <strong>tuwuhs</strong> on 6 Mar 2013, 13:10)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p194005">
				<div class="post-metadata">
					<div class="post-num">Post #122</div>
					<div class="post-author">robthebrew</div>
					<div class="post-datetime">
						6 Mar 2013, 13:20					</div>
				</div>
				<div class="post-content content">
					<p>Is the usb2 hub definitely high speed (dmesg should confirm). Lots of &quot;usb2&quot; hubs on ebay are not.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p194021">
				<div class="post-metadata">
					<div class="post-num">Post #123</div>
					<div class="post-author">doiga</div>
					<div class="post-datetime">
						6 Mar 2013, 17:04					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>tuwuhs wrote:</cite><blockquote><p>...<br />- If WLAN is turned off, all works well<br />- Powered USB 1.0 hub does not help (so it is not a power issue)<br />- Unpowered USB 2.0 hub does not help either<br />...<br />I think it is safe to assume that this problem can only sometimes be solved using a hub (which still fails on me)</p></blockquote></div><p>Agree!<br />My unpowered (or passive) hub 2.0 HIGH-SPEED didn&#039;t solve the problem, makes the router reset! But external powered hub 2.0 HIGH-SPEED works great!<br />But if isn´t a power issue what else can it be?</p>											<p class="post-edited">(Last edited by <strong>doiga</strong> on 6 Mar 2013, 17:06)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p194030">
				<div class="post-metadata">
					<div class="post-num">Post #124</div>
					<div class="post-author">Squonk</div>
					<div class="post-datetime">
						6 Mar 2013, 18:00					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>doiga wrote:</cite><blockquote><div class="quotebox"><cite>tuwuhs wrote:</cite><blockquote><p>...<br />- If WLAN is turned off, all works well<br />- Powered USB 1.0 hub does not help (so it is not a power issue)<br />- Unpowered USB 2.0 hub does not help either<br />...<br />I think it is safe to assume that this problem can only sometimes be solved using a hub (which still fails on me)</p></blockquote></div><p>Agree!<br />My unpowered (or passive) hub 2.0 HIGH-SPEED didn&#039;t solve the problem, makes the router reset! But external powered hub 2.0 HIGH-SPEED works great!<br />But if isn´t a power issue what else can it be?</p></blockquote></div><p>It looks like you are hitting a power supply limit, and adding your external powered hub just solved the problem.</p><p>What else can it be? It looks like the WiFi radio is generating spurious RF emissions serious enough to unlock the USB clock PLL... It looks like it only affects critically USB full-speed synchronous transmissions causing USB to hang (NOT router reset), while USB full-speed isochronous (i.e. sound or video) may suffer some some bit loss (click/pops in sound stream and stripes in video) and keep on going.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p194494">
				<div class="post-metadata">
					<div class="post-num">Post #125</div>
					<div class="post-author">tuwuhs</div>
					<div class="post-datetime">
						10 Mar 2013, 23:16					</div>
				</div>
				<div class="post-content content">
					<p>@Squonk the &quot;spurious emissions&quot; theory sounds very reasonable to me. And I&#039;ve experienced the clicks in sound stream also. Too bad that we have this problem for such a nice router like TL-MR3020.<br />So... case closed, it is? <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 5 of 13</div><nav><ul><li><a href="viewtopic.php%3Fid=39956&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=39956&amp;p=3.html">3</a></li><li><a href="viewtopic.php%3Fid=39956&amp;p=4.html">4</a></li><li class="pagination-current"><span>5</span></li><li><a href="viewtopic.php%3Fid=39956&amp;p=6.html">6</a></li><li><a href="viewtopic.php%3Fid=39956&amp;p=7.html">7</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=39956&amp;p=13.html">13</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0.001 -->

</body>
</html>