<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Performance Question</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 4 Jun 2015.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p269289">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">jsmullikenca</div>
					<div class="post-datetime">
						20 Mar 2015, 07:27					</div>
				</div>
				<div class="post-content content">
					<p>Hello Folks, </p><p>&nbsp; I&#039;m using a pair of Asus RT-N13U B1 routers.&nbsp; The &quot;primary&quot; one connects directly to my cable modem, and serves as an AP, and DHCP server, so that the &quot;secondary&quot; one (about 30 ft. from the primary) is configured as a bridged repeater.&nbsp; I&#039;ve tried the original Asus firmware, DD-WRT and OpenWRT, to get this configuration working.&nbsp; The stock Asus firmware did the job, but the routers would lock up every couple of days.&nbsp; I then tried to go with DD-WRT, and was never able to get the bridged repeater function to work.&nbsp; DD-WRT was stable on the primary, and would connect to the stock Asus firmware on the secondary, giving me the R/B function, but again, it locked up frequently, and needed to be power cycled.&nbsp; </p><p>&nbsp; &nbsp;I now have OpenWRT (BB) running on both, and the R/B function is working, and DHCP requests are served to the PC that is wired to the secondary router, but I&#039;m still having trouble getting wirless clients to fully connect to the secondary.&nbsp; I can see that authentication of the psk2+tkip+aes is passing, but then times out due to &quot;inactivity&quot; (Android pad wireless client). </p><p>&nbsp; &nbsp;So, I will post my config files for review if anyone is interested.&nbsp; And if anyone has any ideas what might be wrong, I would be really interested to hear it. </p><p>&nbsp; &nbsp;What is most interesting to me, is that OpenWRT appears to be very stable, but the throughput between the routers is not what I had been getting.&nbsp; Here&#039;s the deal: </p><p>&nbsp; &nbsp;If I use the PC that is wired directly to the router that is wired directly to the cable modem, and run the Speed Test from speakeasy.net, it will consistently get 50-60Mbps download speed, and 5-6Mbps up.&nbsp; </p><p>&nbsp; &nbsp;If the &quot;primary&quot; router is running DD-WRT and the &quot;secondary&quot; is running OpenWRT bridged, the PC wired to the Secondary, will get 15-25Mbps throughput from the speed test.&nbsp; </p><p>&nbsp; &nbsp;When I changed the &quot;primary&quot; over to OpenWRT BB, and the &quot;secondary&quot; is also running OpenWRT BB, then the PC wired to the secondary only gets 10Mbps at best.&nbsp; Upload speeds are pretty consistent, regardless of firmware config.&nbsp; </p><p>&nbsp; &nbsp;So, is there any performance tuning kinds of things that I might be able to try to improve this?&nbsp; I&#039;m happy with the stability of OpenWRT, and having a stable bridge at least is a positive change, but losing all of that throughput hurts, particularly if your a FPS gamer as I am.&nbsp; :&gt;)&nbsp; </p><p>&nbsp; &nbsp;Here are my files:&nbsp; </p><p>[c0de]<br/>Primary Router<br/>/etc/config/network<br/>config interface &#039;loopback&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;lo&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;127.0.0.1&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.0.0.0&#039;</p><p>config globals &#039;globals&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option ula_prefix &#039;fdd6:a645:61d3::/48&#039;</p><p>config interface &#039;lan&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth0.1&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option force_link &#039;1&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option type &#039;bridge&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;192.168.1.1&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option ip6assign &#039;60&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option macaddr &#039;00:0c:43:41:46:32&#039;</p><p>config interface &#039;wan&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth0.2&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;dhcp&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option macaddr &#039;00:0c:43:41:46:33&#039;</p><p>config switch<br/>&nbsp; &nbsp; &nbsp; &nbsp; option name &#039;rt305x&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option reset &#039;1&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option enable_vlan &#039;1&#039;</p><p>config switch_vlan<br/>&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;rt305x&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option vlan &#039;1&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option ports &#039;0 1 2 3 5&nbsp; 6t&#039;</p><p>config switch_vlan<br/>&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;rt305x&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option vlan &#039;2&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option ports &#039;4&nbsp; 6t&#039;</p><p>/etc/config/wireless<br/>config wifi-device&nbsp; radio0<br/>&nbsp; &nbsp; &nbsp; &nbsp; option type&nbsp; &nbsp; &nbsp;mac80211<br/>&nbsp; &nbsp; &nbsp; &nbsp; option channel&nbsp; 11<br/>&nbsp; &nbsp; &nbsp; &nbsp; option hwmode&nbsp; &nbsp;11g<br/>&nbsp; &nbsp; &nbsp; &nbsp; option path&nbsp; &nbsp; &nbsp;&#039;10180000.wmac&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option htmode&nbsp; &nbsp;HT20<br/>&nbsp; &nbsp; &nbsp; &nbsp; option disabled 0</p><p>config wifi-iface<br/>&nbsp; &nbsp; &nbsp; &nbsp; option device&nbsp; &nbsp;radio0<br/>&nbsp; &nbsp; &nbsp; &nbsp; option network&nbsp; lan<br/>&nbsp; &nbsp; &nbsp; &nbsp; option mode&nbsp; &nbsp; &nbsp;ap<br/>&nbsp; &nbsp; &nbsp; &nbsp; option ssid&nbsp; &nbsp; &nbsp;dd-wrt<br/>&nbsp; &nbsp; &nbsp; &nbsp; option encryption &#039;psk2+tkip+aes&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option key &#039;BuzzOff!&#039;</p><p>/etc/config/dhcp<br/>config dnsmasq<br/>&nbsp; &nbsp; &nbsp; &nbsp; option domainneeded &#039;1&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option boguspriv &#039;1&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option filterwin2k &#039;0&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option localise_queries &#039;1&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option rebind_protection &#039;1&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option rebind_localhost &#039;1&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option local &#039;/lan/&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option domain &#039;lan&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option expandhosts &#039;1&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option nonegcache &#039;0&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option authoritative &#039;1&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option readethers &#039;1&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option leasefile &#039;/tmp/dhcp.leases&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option resolvfile &#039;/tmp/resolv.conf.auto&#039;</p><p>config dhcp &#039;lan&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option interface &#039;lan&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option start &#039;100&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option limit &#039;150&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option leasetime &#039;12h&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option dhcpv6 &#039;server&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option ra &#039;server&#039;</p><p>config dhcp &#039;wan&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option interface &#039;wan&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option ignore &#039;1&#039;</p><p>config odhcpd &#039;odhcpd&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option maindhcp &#039;0&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option leasefile &#039;/tmp/hosts/odhcpd&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option leasetrigger &#039;/usr/sbin/odhcpd-update&#039;</p><br/><p>Secondary Router<br/>/etc/config/network<br/>config interface &#039;loopback&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;lo&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;127.0.0.1&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.0.0.0&#039;</p><p>config globals &#039;globals&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option ula_prefix &#039;fd7f:7fb0:4b4d::/48&#039;</p><p>config interface &#039;lan&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth0.1&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option type &#039;bridge&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option force_link &#039;1&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option ip6assign &#039;60&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;192.168.1.33&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option gateway &#039;192.168.1.1&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option dns &#039;192.168.1.1&#039;</p><p>config interface &#039;wlan&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;192.168.1.99&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option gateway &#039;192.168.1.1&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;</p><p>config interface &#039;stabridge&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;relay&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option network &#039;lan wlan&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;192.168.1.99&#039;</p><p>config switch<br/>&nbsp; &nbsp; &nbsp; &nbsp; option name &#039;rt305x&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option reset &#039;1&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option enable_vlan &#039;1&#039;</p><p>config switch_vlan<br/>&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;rt305x&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option vlan &#039;1&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option ports &#039;0 1 2 3 5&nbsp; 6t&#039;</p><p>config switch_vlan<br/>&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;rt305x&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option vlan &#039;2&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option ports &#039;4&nbsp; 6t&#039;</p><br/><br/><p>/etc/config/wireless<br/>config wifi-device &#039;radio0&#039;<br/>&nbsp; &nbsp; option type &#039;mac80211&#039;<br/>&nbsp; &nbsp; option hwmode &#039;11g&#039;<br/>&nbsp; &nbsp; option channel &#039;11&#039;<br/>&nbsp; &nbsp; option htmode &#039;HT20&#039;<br/>&nbsp; &nbsp; option path &#039;10180000.wmac&#039;<br/>&nbsp; &nbsp; option disabled &#039;0&#039;</p><p>config wifi-iface<br/>&nbsp; &nbsp; option ssid &#039;dd-wrt&#039;<br/>&nbsp; &nbsp; option encryption &#039;psk2+tkip+aes&#039;<br/>&nbsp; &nbsp; option device &#039;radio0&#039;<br/>&nbsp; &nbsp; option mode &#039;sta&#039;<br/>&nbsp; &nbsp; option network &#039;wlan&#039;<br/>&nbsp; &nbsp; option key &#039;BuzzOff!&#039;</p><p>config wifi-iface<br/>&nbsp; &nbsp; option device &#039;radio0&#039;<br/>&nbsp; &nbsp; option mode &#039;ap&#039;<br/>&nbsp; &nbsp; option ssid &#039;openWRT&#039;<br/>&nbsp; &nbsp; option encryption &#039;psk2+tkip+aes&#039;<br/>&nbsp; &nbsp; option key &#039;BuzzOff!&#039;<br/>&nbsp; &nbsp; option network &#039;lan&#039;</p><br/><p>/etc/config/dhcp<br/>config dnsmasq<br/>&nbsp; &nbsp; &nbsp; &nbsp; option domainneeded &#039;1&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option boguspriv &#039;1&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option localise_queries &#039;1&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option rebind_protection &#039;1&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option rebind_localhost &#039;1&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option local &#039;/lan/&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option domain &#039;lan&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option expandhosts &#039;1&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option readethers &#039;1&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option leasefile &#039;/tmp/dhcp.leases&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option resolvfile &#039;/tmp/resolv.conf.auto&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option ignore &#039;1&#039;</p><p>config dhcp &#039;lan&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option interface &#039;lan&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option start &#039;100&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option limit &#039;150&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option leasetime &#039;12h&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option dhcpv6 &#039;server&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option ra &#039;server&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option ignore &#039;1&#039;</p><p>config dhcp &#039;wan&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option interface &#039;wan&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option ignore &#039;1&#039;</p><p>config odhcpd &#039;odhcpd&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option maindhcp &#039;0&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option leasefile &#039;/tmp/hosts/odhcpd&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option leasetrigger &#039;/usr/sbin/odhcpd-update&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option ignore &#039;1&#039;</p><p>[/c0de]</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>