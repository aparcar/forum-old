<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Wifitoggle on tp link tl wr842nd</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 21 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p202665">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">deventher</div>
					<div class="post-datetime">
						24 May 2013, 18:57					</div>
				</div>
				<div class="post-content content">
					<p>Hi community,</p><p>well admittedly I am a little ashamed to request your help, since the procedure is outlined quite often here <img src="https://forum.openwrt.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" />.<br />And to make things clear: I am a bloody newbie. Just got openwrt working on the 42nd.</p><p>I wanted to make use of the provided WLAN ON/OFF button, installed wifitoggle via putty and configured it like this:</p><br /><p>wifitoggle.@wifitoggle[0]=wifitoggle<br />wifitoggle.@wifitoggle[0].led_enable_trigger=timer<br />wifitoggle.@wifitoggle[0].persistent=1<br />wifitoggle.@wifitoggle[0].led_sysfs=tl-wr1043nd:green:qss<br />wifitoggle.@wifitoggle[0].led_enable_delayon=2000<br />wifitoggle.@wifitoggle[0].led_disable_default=1<br />wifitoggle.@wifitoggle[0].led_enable_delayoff=3000<br />wifitoggle.@wifitoggle[0].timer=0<br />wifitoggle.@wifitoggle[0].button=wps</p><br /><p>And I have already tried out the &quot;BTN_1&quot;. Still not working <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>Sorry for the inconveniences. I really really tried to solve it on my own! </p><p>greets</p>											<p class="post-edited">(Last edited by <strong>deventher</strong> on 24 May 2013, 18:58)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p202667">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						24 May 2013, 21:27					</div>
				</div>
				<div class="post-content content">
					<p>already read all this?</p><p> <a href="http://wiki.openwrt.org/doc/howto/hardware.button">http://wiki.openwrt.org/doc/howto/hardware.button</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p202668">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">deventher</div>
					<div class="post-datetime">
						24 May 2013, 21:42					</div>
				</div>
				<div class="post-content content">
					<p>Yes, of course I did. But as far as I know the &quot;wifitoggle&quot; is just a script, which does exactly the same thing automatically?!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p202669">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">deventher</div>
					<div class="post-datetime">
						24 May 2013, 21:49					</div>
				</div>
				<div class="post-content content">
					<p>Perhaps you are right. I should try it the hard way. <br />I was really relieved when I had discovered the script because as I have already said I am not thaaat advanced. </p><p>Okay this is going to be a long night <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p202671">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						24 May 2013, 22:28					</div>
				</div>
				<div class="post-content content">
					<p>come on it&#039;s really a 5 minutes job xD</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p202672">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">deventher</div>
					<div class="post-datetime">
						24 May 2013, 22:30					</div>
				</div>
				<div class="post-content content">
					<p>Well i am new to this maaan <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /><br />But yeah wasnt that bad as I have expected it to be ... well hopefully it will work</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p202673">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">deventher</div>
					<div class="post-datetime">
						24 May 2013, 22:49					</div>
				</div>
				<div class="post-content content">
					<p>Ok I obviously have a problem. It doesnt work -_- </p><p>-I am able to log the button (it is called &quot;reset&quot;)<br />-I created the &quot;00-button&quot; button script via &quot;vi&quot; and saved it succesfully -&gt;doublechecked!<br />-I created &quot;/usr/bin/wifionoff&quot; and pasted</p><p>#!/bin/sh<br />SW=$(uci -q get wireless.@wifi-device[0].disabled)<br />[ &quot;$SW&quot; == &quot;1&quot; ] &amp;&amp; uci set wireless.@wifi-device[0].disabled=0<br />[ &quot;$SW&quot; == &quot;1&quot; ] || uci set wireless.@wifi-device[0].disabled=1<br />wifi</p><p>-I ran the following stuff:</p><p>uci add system button&nbsp; &nbsp; <br />uci set system.@button[-1].button=reset<br />uci set system.@button[-1].action=released<br />uci set system.@button[-1].handler=&#039;/usr/bin/wifionoff&#039;<br />uci set system.@button[-1].min=0<br />uci set system.@button[-1].max=3<br />uci commit system </p><p>// reboot</p>											<p class="post-edited">(Last edited by <strong>deventher</strong> on 24 May 2013, 22:52)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p202674">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">deventher</div>
					<div class="post-datetime">
						24 May 2013, 22:50					</div>
				</div>
				<div class="post-content content">
					<p>my 00-button plain text:</p><p>#!/bin/sh<br />. /lib/functions.sh<br />do_button () {<br />&nbsp; &nbsp; &nbsp; &nbsp; local button<br />&nbsp; &nbsp; &nbsp; &nbsp; local action<br />&nbsp; &nbsp; &nbsp; &nbsp; local handler<br />&nbsp; &nbsp; &nbsp; &nbsp; local min<br />&nbsp; &nbsp; &nbsp; &nbsp; local max</p><p>&nbsp; &nbsp; &nbsp; &nbsp; config_get button $1 button<br />&nbsp; &nbsp; &nbsp; &nbsp; config_get action $1 action<br />&nbsp; &nbsp; &nbsp; &nbsp; config_get handler $1 handler<br />&nbsp; &nbsp; &nbsp; &nbsp; config_get min $1 min<br />&nbsp; &nbsp; &nbsp; &nbsp; config_get max $1 max</p><p>&nbsp; &nbsp; &nbsp; &nbsp; [ &quot;$ACTION&quot; = &quot;$action&quot; -a &quot;$BUTTON&quot; = &quot;$button&quot; -a -n &quot;$handler&quot; ] &amp;&amp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [ -z &quot;$min&quot; -o -z &quot;$max&quot; ] &amp;&amp; eval $handler<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [ -n &quot;$min&quot; -a -n &quot;$max&quot; ] &amp;&amp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [ $min -le $SEEN -a $max -ge $SEEN ] &amp;&amp; eval $handler<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />}</p><p>config_load system<br />config_foreach do_button button</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p202679">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						24 May 2013, 23:11					</div>
				</div>
				<div class="post-content content">
					<p>now that you know that is called reset have you corrected the wifitoggle config?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p202680">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">deventher</div>
					<div class="post-datetime">
						24 May 2013, 23:17					</div>
				</div>
				<div class="post-content content">
					<p>In the &quot;/usr/bin/wifionoff&quot; file? <br />I dont know what you are driving at <img src="https://forum.openwrt.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p202683">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						24 May 2013, 23:55					</div>
				</div>
				<div class="post-content content">
					<p>no i mean in your first post you were trying to use &quot;wps&quot; as button.. or btn_1</p><p>right?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p202684">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">deventher</div>
					<div class="post-datetime">
						25 May 2013, 00:14					</div>
				</div>
				<div class="post-content content">
					<p>no i changed it to &quot;reset&quot; ... mhh</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p202686">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">deventher</div>
					<div class="post-datetime">
						25 May 2013, 00:21					</div>
				</div>
				<div class="post-content content">
					<p>I also tried this:<br /><a href="https://forum.openwrt.org/viewtopic.php?id=33821">https://forum.openwrt.org/viewtopic.php?id=33821</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p202687">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						25 May 2013, 00:32					</div>
				</div>
				<div class="post-content content">
					<p>i&#039;m out of ideas <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /><br />are you using AA?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p202688">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">deventher</div>
					<div class="post-datetime">
						25 May 2013, 00:44					</div>
				</div>
				<div class="post-content content">
					<p>Yes. <br />I will have a closer look at things tomorrow. at present everything is quite confusing <img src="https://forum.openwrt.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /></p>											<p class="post-edited">(Last edited by <strong>deventher</strong> on 25 May 2013, 00:44)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p202693">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">deventher</div>
					<div class="post-datetime">
						25 May 2013, 01:06					</div>
				</div>
				<div class="post-content content">
					<p>uci set wifitoggle.@wifitoggle[0]=wifitoggle<br />uci set wifitoggle.@wifitoggle[0].led_enable_trigger=timer<br />uci set wifitoggle.@wifitoggle[0].persistent=1<br />uci set wifitoggle.@wifitoggle[0].button=reset<br />uci set wifitoggle.@wifitoggle[0].led_sysfs=tl-wr1043nd:green:qss<br />uci set wifitoggle.@wifitoggle[0].led_enable_delayon=2000<br />uci set wifitoggle.@wifitoggle[0].led_disable_default=1<br />uci set wifitoggle.@wifitoggle[0].led_enable_delayoff=3000<br />uci set wifitoggle.@wifitoggle[0].timer=0</p><br /><p>my &quot;wifitoggle&quot; config looks like this</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p202694">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">deventher</div>
					<div class="post-datetime">
						25 May 2013, 01:21					</div>
				</div>
				<div class="post-content content">
					<p>Yeah! It is working finally <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />I just turned the wlan several times on and off in the gui and suddenly ...</p><p>I don&#039;t know why but who cares <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" />.</p><p>Thanks mate for your support!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p202727">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">deventher</div>
					<div class="post-datetime">
						25 May 2013, 11:57					</div>
				</div>
				<div class="post-content content">
					<p>Ok one minor problem is left.<br />I am just able to toogle the wifi on or off if it (wifi) is already running.<br />I turned wifi off this night and could not enable it via the button <img src="https://forum.openwrt.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" />.</p><p>After i had enabled it via the gui it worked fine though.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p202741">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">deventher</div>
					<div class="post-datetime">
						25 May 2013, 13:57					</div>
				</div>
				<div class="post-content content">
					<p>I am not the only one who has this problem:</p><p><a href="https://dev.openwrt.org/ticket/9750">https://dev.openwrt.org/ticket/9750</a></p><p>especially the last post!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p202742">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						25 May 2013, 14:11					</div>
				</div>
				<div class="post-content content">
					<p>seems fixed from r35416, what revision r u using?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>