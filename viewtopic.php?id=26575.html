<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> backfire compile error with opkg-513</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 5 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p117218">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">chsharp@aol.com</div>
					<div class="post-datetime">
						15 Sep 2010, 17:35					</div>
				</div>
				<div class="post-content content">
					<p>In trying to compile with the latest source for backfire, I get an &quot;Undefined symbols&quot; error when building opkg-513.</p><p>--------------<br />make[3]: Entering directory `/Volumes/OpenWrt/backfire/package/opkg&#039;<br />make -C /Volumes/OpenWrt/backfire/build_dir/host/opkg-513 CC=&quot;gcc&quot; all<br />make[4]: Entering directory `/Volumes/OpenWrt/backfire/build_dir/host/opkg-513&#039;<br />Making all in libbb<br />Making all in libopkg<br />make[5]: Entering directory `/Volumes/OpenWrt/backfire/build_dir/host/opkg-513/libopkg&#039;<br />make[5]: Leaving directory `/Volumes/OpenWrt/backfire/build_dir/host/opkg-513/libopkg&#039;<br />Making all in src<br />Making all in tests<br />make[5]: Entering directory `/Volumes/OpenWrt/backfire/build_dir/host/opkg-513/tests&#039;<br />/bin/bash ../libtool --tag=CC --mode=link gcc -Wall -g -O3 -I../libopkg -O2 -I/Volumes/OpenWrt/backfire/staging_dir/host/include -static -L/Volumes/OpenWrt/backfire/staging_dir/host/lib -o libopkg_test libopkg_test.o ../libopkg/libopkg.a ../libbb/libbb.a --shave-mode=link<br />gcc -Wall -g -O3 -I../libopkg -O2 -I/Volumes/OpenWrt/backfire/staging_dir/host/include -o libopkg_test libopkg_test.o --shave-mode=link&nbsp; -L/Volumes/OpenWrt/backfire/staging_dir/host/lib ../libopkg/libopkg.a ../libbb/libbb.a&nbsp; <br />Undefined symbols:<br />&nbsp; &quot;_opkg_state_changed&quot;, referenced from:<br />&nbsp; &nbsp; &nbsp; _opkg_state_changed$non_lazy_ptr in libopkg.a(opkg_install.o)<br />&nbsp; &nbsp; &nbsp; _opkg_state_changed$non_lazy_ptr in libopkg.a(opkg_remove.o)<br />ld: symbol(s) not found<br />collect2: ld returned 1 exit status<br />make[5]: *** [libopkg_test] Error 1<br />make[5]: Leaving directory `/Volumes/OpenWrt/backfire/build_dir/host/opkg-513/tests&#039;<br />make[4]: *** [all-recursive] Error 1<br />make[4]: Leaving directory `/Volumes/OpenWrt/backfire/build_dir/host/opkg-513&#039;<br />make[3]: *** [/Volumes/OpenWrt/backfire/build_dir/host/opkg-513/.built] Error 2<br />make[3]: Leaving directory `/Volumes/OpenWrt/backfire/package/opkg&#039;<br />make[2]: *** [package/opkg/host/compile] Error 2<br />make[2]: Leaving directory `/Volumes/OpenWrt/backfire&#039;<br />make[1]: *** [/Volumes/OpenWrt/backfire/staging_dir/target-mipsel_uClibc-0.9.30.1/stamp/.package_compile] Error 2<br />make[1]: Leaving directory `/Volumes/OpenWrt/backfire&#039;<br />make: *** [world] Error 2</p><p>--------------------</p><p>The latest I was able to compile was opkg 513-2 and Backfire (10.03, r22391).<br />I don&#039;t recall any other changes.</p><p>Compiling on OS X 10.5.8.&nbsp; </p><p>Any suggestions appreciated.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p117221">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">oneru</div>
					<div class="post-datetime">
						15 Sep 2010, 17:45					</div>
				</div>
				<div class="post-content content">
					<p>try running &#039;make distclean&#039;, and then compiling as usual. (You may have to run the menuconfig again)</p><p>The builder reuses the toolchain each time you compile, and as the sources are changed, the toolchain occasionally needs to be rebuilt. </p><p>Not a guaranteed fix, but worth trying.<br />~Jonathan</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p117229">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						15 Sep 2010, 19:54					</div>
				</div>
				<div class="post-content content">
					<p>Thats odd, I thought I fixed this exact error a while ago.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p117594">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">chsharp@aol.com</div>
					<div class="post-datetime">
						21 Sep 2010, 01:49					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>oneru wrote:</cite><blockquote><p>try running &#039;make distclean&#039;, and then compiling as usual. (You may have to run the menuconfig again)</p><p>The builder reuses the toolchain each time you compile, and as the sources are changed, the toolchain occasionally needs to be rebuilt. </p><p>Not a guaranteed fix, but worth trying.<br />~Jonathan</p></blockquote></div><p>Great idea.&nbsp; Should&#039;ve tried that before posting.<br />Unfortunately, it didn&#039;t fix the problem.</p><p>I ended up deleting the backfire directory and starting with the last known good rev.&nbsp; I worked my way forward until I hit the first rev with the error.</p><p>The error first appears in r22971 of the backfire branch.&nbsp; r22970 compiles fine.</p><p>It looks like r22971 only includes Changeset 22948<br /><a href="https://dev.openwrt.org/changeset/22948">https://dev.openwrt.org/changeset/22948</a></p><p>It adds the following line to /package/base-files/Makefile <br />&nbsp; &nbsp;PKG_BUILD_DEPENDS:=opkg/host </p><p>The changeset comment says &quot;base-files: make build dependant on opkg/host&quot;</p><p>So it turns out the compile fails on base-files, not opkg as I thought originally.</p><p>So I guess now I have to figure out why adding this dependency fails on my system.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p117597">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">cpthowdy</div>
					<div class="post-datetime">
						21 Sep 2010, 02:51					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m getting the same compilation error on OS 10.6.4.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p117598">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						21 Sep 2010, 03:55					</div>
				</div>
				<div class="post-content content">
					<p>Turns out I forgot to merge the compile fix into backfire.<br />It should be resolved by <a href="https://dev.openwrt.org/changeset/23105">https://dev.openwrt.org/changeset/23105</a>.</p><p>Run &quot;make package/opkg/host/clean&quot;, &quot;svn up&quot; and &quot;make&quot; again.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p117600">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">chsharp@aol.com</div>
					<div class="post-datetime">
						21 Sep 2010, 04:38					</div>
				</div>
				<div class="post-content content">
					<p>I think I&#039;ve figured this one out, at least partially.</p><p>I found the following changeset on Google code for opkg to fix a problem compiling on OS X.</p><p><a href="http://code.google.com/p/opkg/source/detail?r=560">http://code.google.com/p/opkg/source/detail?r=560</a></p><p>I manually made these changes in the latest rev of backfire (r23104) and was able to build successfully.</p><p>I haven&#039;t tested it on the target yet.</p><p>We need to get the&nbsp; Google Code fixes pulled into Openwrt opkg.</p><p>I suppose this requires a bug report on backfire. :-)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p117608">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">chsharp@aol.com</div>
					<div class="post-datetime">
						21 Sep 2010, 10:16					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jow wrote:</cite><blockquote><p>Turns out I forgot to merge the compile fix into backfire.<br />It should be resolved by <a href="https://dev.openwrt.org/changeset/23105">https://dev.openwrt.org/changeset/23105</a>.</p><p>Run &quot;make package/opkg/host/clean&quot;, &quot;svn up&quot; and &quot;make&quot; again.</p></blockquote></div><p>Sorry, I sent my last post before reading this one. </p><p>I updated to 23105 and this problem did not reappear when I compiled.</p><p>Thanks.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p118200">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">icarus75</div>
					<div class="post-datetime">
						30 Sep 2010, 22:52					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m trying to compile the latest rev in the Backfire branch (23163) under Linux. The compilation repeatedly fails with this error message:<br /></p><div class="codebox"><pre><code>make[2]: *** No rule to make target `package/opkg/host/compile&#039;, needed by `package/base-files/compile&#039;.  Stop.</code></pre></div><p>Commenting out the </p><div class="codebox"><pre><code>PKG_BUILD_DEPENDS:=opkg/host</code></pre></div><p>line in package/base-files/Makefile solves the problem.</p><p>Cheers,<br />Bart.</p><p>Update 02/10/10: Just figured out I was using the backfire tag, not the branch. So please disregard the above remark.</p>											<p class="post-edited">(Last edited by <strong>icarus75</strong> on 2 Oct 2010, 16:01)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>