<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> D-Link DIR-300-B1 running r28963 - WPA1/2 Windows Client issues</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 24 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p148384">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">BdN3504</div>
					<div class="post-datetime">
						13 Nov 2011, 20:52					</div>
				</div>
				<div class="post-content content">
					<p>I successfully compiled r28963 yesterday using nothing but the presets provided by defconf for a dlink dir-300-b1 device. I have also successfully replaced the original firmware with openwrt. I am posting from a machine that is wired to the dir-300-b1 running openwrt. I have installed the luci-ssl packet using opkg and the luci-ddns packet with luci.<br />I&#039;ve got some issues with the wireless interface though:<br />I configured it from the luci web-interface. When setting the &#039;Encryption&#039; under &#039;Wireless Security&#039; to &#039;WPA2-PSK&#039; and the cipher to &#039;Force CCMP&#039;, I cannot connect to the dir-300-b1 at all from a client running Windows XP. The Client is an hp 530 Notebook and has a built-in Wireless Card by Broadcom which uses the BCM-43xx Driver which can be found here:<br /><a href="http://h20000.www2.hp.com/bizsupport/TechSupport/SoftwareIndex.jsp?lang=de&amp;cc=de&amp;prodNameId=3375995&amp;prodTypeId=321957&amp;prodSeriesId=3375953&amp;swLang=18&amp;taskId=135&amp;swEnvOID=1093">vendor-supportpage for hp 530</a><br />The client appears in the log file of the router with the following entry:<br /></p><div class="codebox"><pre><code>Nov 13 19:24:19 DIR-300 daemon.info hostapd: wlan0: STA 00:1a:73:64:d1:40 WPA: group key handshake completed (RSN)
Nov 13 19:27:22 DIR-300 daemon.info hostapd: wlan0: STA 00:1a:73:64:d1:40 IEEE 802.11: authenticated
Nov 13 19:27:22 DIR-300 daemon.info hostapd: wlan0: STA 00:1a:73:64:d1:40 IEEE 802.11: No WPA/RSN IE in associatio</code></pre></div><p>This happens, when I try to connect the client to my SSID which is WPA2-PSK. The funny thing about this is, that i am not asked for a passphrase, when I try to connect. Instead, Windows is giving out an error message which states, that the connection can&#039;t be established because the network&#039;s not within&nbsp; reach.</p><p>To rule out that the client is physically incapable of connecting to the wireless network, I booted it into Parted Magic 5.3. I started the wireless Interface without a problem and could connect to the router without a problem too. Here are the logs for the same client running Linux:<br /></p><div class="codebox"><pre><code>Nov 13 19:17:14 DIR-300 daemon.info hostapd: wlan0: STA 00:1a:73:64:d1:40 IEEE 802.11: authenticated
Nov 13 19:17:14 DIR-300 daemon.info hostapd: wlan0: STA 00:1a:73:64:d1:40 IEEE 802.11: associated (aid 1)
Nov 13 19:17:14 DIR-300 daemon.info hostapd: wlan0: STA 00:1a:73:64:d1:40 WPA: pairwise key handshake completed (RSN)
Nov 13 18:17:16 DIR-300 daemon.info dnsmasq-dhcp[1654]: DHCPDISCOVER(br-lan) 00:1a:73:64:d1:40
Nov 13 18:17:16 DIR-300 daemon.info dnsmasq-dhcp[1654]: DHCPOFFER(br-lan) 192.168.5.4 00:1a:73:64:d1:40
Nov 13 18:17:19 DIR-300 daemon.info dnsmasq-dhcp[1654]: DHCPDISCOVER(br-lan) 00:1a:73:64:d1:40
Nov 13 18:17:19 DIR-300 daemon.info dnsmasq-dhcp[1654]: DHCPOFFER(br-lan) 192.168.5.4 00:1a:73:64:d1:40
Nov 13 18:17:19 DIR-300 daemon.info dnsmasq-dhcp[1654]: DHCPREQUEST(br-lan) 192.168.5.4 00:1a:73:64:d1:40
Nov 13 18:17:19 DIR-300 daemon.info dnsmasq-dhcp[1654]: DHCPACK(br-lan) 192.168.5.4 00:1a:73:64:d1:40 dayrie-Wireless</code></pre></div><p>Here is the output of the command lshw -class network on that client running linux:<br /></p><div class="codebox"><pre><code>description: Network controller
       product: BCM4311 802.11b/g WLAN
       vendor: Broadcom Corporation
       physical id: 0
       bus info: pci@0000:10:00.0
       version: 01
       width: 32 bits
       clock: 33MHz
       capabilities: pm msi pciexpress bus_master cap_list
       configuration: driver=b43-pci-bridge latency=0
       resources: irq:10 memory:f0000000-f0003fff
  *-network DISABLED
       description: Ethernet interface
       product: 82562ET/EZ/GT/GZ - PRO/100 VE (LOM) Ethernet Controller Mobile
       vendor: Intel Corporation
       physical id: 8
       bus info: pci@0000:02:08.0
       logical name: eth0
       version: 01
       serial: 00:1b:38:2e:80:57
       size: 10MB/s
       capacity: 100MB/s
       width: 32 bits
       clock: 33MHz
       capabilities: pm bus_master cap_list ethernet physical tp mii 10bt 10bt-fd 100bt 100bt-fd autonegotiation
       configuration: autonegotiation=on broadcast=yes driver=e100 driverversion=3.5.24-k2-NAPI duplex=half firmware=N/A latency=64 link=no maxlatency=56 mingnt=8 multicast=yes port=MII speed=10MB/s
       resources: irq:11 memory:f0101000-f0101fff ioport:2000(size=64)
  *-network
       description: Wireless interface
       physical id: 1
       logical name: wlan0
       serial: 00:1a:73:64:d1:40
       capabilities: ethernet physical wireless
       configuration: broadcast=yes driver=b43 driverversion=2.6.35.3-pmagic firmware=N/A ip=192.168.5.4 link=yes multicast=yes wireless=IEEE 802.11bg</code></pre></div><p>Now, when I change the &#039;Encryption&#039; under &#039;Wireless Security&#039; to &#039;WPA-PSK/WPA2-PSK Mixed Mode&#039; and the cipher to &#039;auto&#039;, i can connect with the windows XP client:<br /></p><div class="codebox"><pre><code>Nov 13 19:38:30 DIR-300 daemon.info hostapd: wlan0: STA 00:1a:73:64:d1:40 IEEE 802.11: authenticated
Nov 13 19:38:30 DIR-300 daemon.info hostapd: wlan0: STA 00:1a:73:64:d1:40 IEEE 802.11: No WPA/RSN IE in association request
Nov 13 19:39:00 DIR-300 daemon.info hostapd: wlan0: STA 00:1a:73:64:d1:40 IEEE 802.11: authenticated
Nov 13 19:39:00 DIR-300 daemon.info hostapd: wlan0: STA 00:1a:73:64:d1:40 IEEE 802.11: associated (aid 1)
Nov 13 19:39:00 DIR-300 daemon.info hostapd: wlan0: STA 00:1a:73:64:d1:40 WPA: pairwise key handshake completed (WPA)
Nov 13 19:39:00 DIR-300 daemon.info hostapd: wlan0: STA 00:1a:73:64:d1:40 WPA: group key handshake completed (WPA)
Nov 13 18:39:01 DIR-300 daemon.info dnsmasq-dhcp[1654]: DHCPDISCOVER(br-lan) 00:1a:73:64:d1:40
Nov 13 18:39:01 DIR-300 daemon.info dnsmasq-dhcp[1654]: DHCPOFFER(br-lan) 192.168.5.4 00:1a:73:64:d1:40
Nov 13 18:39:05 DIR-300 daemon.info dnsmasq-dhcp[1654]: DHCPDISCOVER(br-lan) 00:1a:73:64:d1:40
Nov 13 18:39:05 DIR-300 daemon.info dnsmasq-dhcp[1654]: DHCPOFFER(br-lan) 192.168.5.4 00:1a:73:64:d1:40
Nov 13 18:39:05 DIR-300 daemon.info dnsmasq-dhcp[1654]: DHCPREQUEST(br-lan) 192.168.5.4 00:1a:73:64:d1:40
Nov 13 18:39:05 DIR-300 daemon.info dnsmasq-dhcp[1654]: DHCPACK(br-lan) 192.168.5.4 00:1a:73:64:d1:40 dayrie-Wireless
Nov 13 18:39:08 DIR-300 daemon.info dnsmasq-dhcp[1654]: DHCPINFORM(br-lan) 192.168.5.4 00:1a:73:64:d1:40
Nov 13 18:39:08 DIR-300 daemon.info dnsmasq-dhcp[1654]: DHCPACK(br-lan) 192.168.5.4 00:1a:73:64:d1:40 dayrie-Wireless
Nov 13 18:39:11 DIR-300 daemon.info dnsmasq-dhcp[1654]: DHCPINFORM(br-lan) 192.168.5.4 00:1a:73:64:d1:40
Nov 13 18:39:11 DIR-300 daemon.info dnsmasq-dhcp[1654]: DHCPACK(br-lan) 192.168.5.4 00:1a:73:64:d1:40 dayrie-Wireless
Nov 13 18:40:36 DIR-300 daemon.info dnsmasq-dhcp[1654]: DHCPDISCOVER(br-lan) 192.168.5.4 00:1a:73:64:d1:40
Nov 13 18:40:36 DIR-300 daemon.info dnsmasq-dhcp[1654]: DHCPOFFER(br-lan) 192.168.5.4 00:1a:73:64:d1:40
Nov 13 18:40:36 DIR-300 daemon.info dnsmasq-dhcp[1654]: DHCPREQUEST(br-lan) 192.168.5.4 00:1a:73:64:d1:40
Nov 13 18:40:36 DIR-300 daemon.info dnsmasq-dhcp[1654]: DHCPACK(br-lan) 192.168.5.4 00:1a:73:64:d1:40 dayrie-Wireless
Nov 13 18:40:39 DIR-300 daemon.info dnsmasq-dhcp[1654]: DHCPINFORM(br-lan) 192.168.5.4 00:1a:73:64:d1:40
Nov 13 18:40:39 DIR-300 daemon.info dnsmasq-dhcp[1654]: DHCPACK(br-lan) 192.168.5.4 00:1a:73:64:d1:40 dayrie-Wireless
Nov 13 18:40:42 DIR-300 daemon.info dnsmasq-dhcp[1654]: DHCPINFORM(br-lan) 192.168.5.4 00:1a:73:64:d1:40
Nov 13 18:40:42 DIR-300 daemon.info dnsmasq-dhcp[1654]: DHCPACK(br-lan) 192.168.5.4 00:1a:73:64:d1:40 dayrie-Wireless
Nov 13 19:41:07 DIR-300 daemon.info hostapd: wlan0: STA 00:1a:73:64:d1:40 IEEE 802.11: authenticated
Nov 13 19:41:07 DIR-300 daemon.info hostapd: wlan0: STA 00:1a:73:64:d1:40 IEEE 802.11: associated (aid 1)
Nov 13 19:41:07 DIR-300 daemon.info hostapd: wlan0: STA 00:1a:73:64:d1:40 WPA: pairwise key handshake completed (WPA)
Nov 13 18:41:07 DIR-300 daemon.info dnsmasq-dhcp[1654]: DHCPDISCOVER(br-lan) 192.168.5.4 00:1a:73:64:d1:40
Nov 13 18:41:07 DIR-300 daemon.info dnsmasq-dhcp[1654]: DHCPOFFER(br-lan) 192.168.5.4 00:1a:73:64:d1:40
Nov 13 19:41:07 DIR-300 daemon.info hostapd: wlan0: STA 00:1a:73:64:d1:40 WPA: group key handshake completed (WPA)
Nov 13 18:41:07 DIR-300 daemon.info dnsmasq-dhcp[1654]: DHCPREQUEST(br-lan) 192.168.5.4 00:1a:73:64:d1:40
Nov 13 18:41:07 DIR-300 daemon.info dnsmasq-dhcp[1654]: DHCPACK(br-lan) 192.168.5.4 00:1a:73:64:d1:40 dayrie-Wireless</code></pre></div><p>But this is still not working right, as you can see, the client repeatedly loses and immediately re-establishes the connection, keeping the dhcp server busy the whole time. This weird behaviour cannot be observed when the client is running linux, connecting to a wpa2-only network.<br />I guess this is a supid driver issue on windows xp, but i would really like to get this fixed.<br />So please tell me, if there is anything i can do to resolve this issue. As you can see from the download page of the vendor, the driver is already 3 years old. So I am hoping someone can give me a link to a newer driver for this particular broadcom device, which will resolve this issue.<br />Is there an implementation of the Linux driver for Windows?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p148436">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">kyokyowin</div>
					<div class="post-datetime">
						14 Nov 2011, 11:38					</div>
				</div>
				<div class="post-content content">
					<p>wireless device not support or password is wrong~</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p148503">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">BdN3504</div>
					<div class="post-datetime">
						14 Nov 2011, 23:35					</div>
				</div>
				<div class="post-content content">
					<p>Excuse me for pointing this out, but your answer is not helping me in any way. Please read the post carefully and try to answer the specific questions...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p148505">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						14 Nov 2011, 23:48					</div>
				</div>
				<div class="post-content content">
					<p>Try to lower the group rekey interval, maybe even disable group rekeying completely. Set &quot;option wpa_group_rekey 3600&quot; in the wifi-iface section.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p148507">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">BdN3504</div>
					<div class="post-datetime">
						15 Nov 2011, 00:23					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for the hint, will try that tomorrow!</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>