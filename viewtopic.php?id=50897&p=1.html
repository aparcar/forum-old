<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Tile/Tilera</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 15 Apr 2018 and 22 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 3</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=50897&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=50897&amp;p=3.html">3</a></li></ul></nav></div>
			
		
		
			<article class="post" id="p235259">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">efjgrub</div>
					<div class="post-datetime">
						31 May 2014, 20:19					</div>
				</div>
				<div class="post-content content">
					<p>Anyone have any experience with openwrt in architecture tile/tilera ?</p><p>Any target that i can use to test?</p><p>-<br />Edison</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235646">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">lain</div>
					<div class="post-datetime">
						4 Jun 2014, 18:43					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m also interested on install openwrt on tilera based hardware.<br />I try to install it on mikrotik ccr but with poor results since now.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235716">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">arni</div>
					<div class="post-datetime">
						5 Jun 2014, 10:39					</div>
				</div>
				<div class="post-content content">
					<p>Hi, </p><p>I&#039;m currently trying to make Mikrotik CCR boards to work with openwrt. For now I managed to compile rootfs and kernel, and even to pass it to bootleader via network. But I don&#039;t see any output in serial console. I&#039;ve been compiling vanilla 3.14.4 kernel (as vanilla 3.3.5 which is used by Mikrotik in ROS 6.12 gave constant compilation errors). </p><p>That&#039;s the only thing I get on serial console during network boot : <br />trying dhcp protocol... OK<br />resolved mac address 00:10:18:2D:CD:BB<br />Gateway: 192.168.88.254<br />transfer started .............................. transfer ok, time=0.32s<br />setting up elf image... OK<br />jumping to kernel code</p><p>Can anyone advise where the problem can be ? Any patches that are required there to work?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235721">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">lain</div>
					<div class="post-datetime">
						5 Jun 2014, 12:00					</div>
				</div>
				<div class="post-content content">
					<p>I suppose that the video device, specified during kernel compilation is wrong so the video output after the initial phase of boot will be redirected to something that we could not see.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235722">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">lain</div>
					<div class="post-datetime">
						5 Jun 2014, 12:01					</div>
				</div>
				<div class="post-content content">
					<p>Did you used &quot;console=ttyS0&quot; Arni ?</p>											<p class="post-edited">(Last edited by <strong>lain</strong> on 5 Jun 2014, 12:37)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235725">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">lain</div>
					<div class="post-datetime">
						5 Jun 2014, 12:41					</div>
				</div>
				<div class="post-content content">
					<p>I will be happy just to find a way to create the devel-login file on ccr to get root access.<br />Have you find a way to do that?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235727">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">efjgrub</div>
					<div class="post-datetime">
						5 Jun 2014, 13:12					</div>
				</div>
				<div class="post-content content">
					<p>If I want to try, what target should I use?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235728">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">lain</div>
					<div class="post-datetime">
						5 Jun 2014, 13:18					</div>
				</div>
				<div class="post-content content">
					<p>I hexdump a working kernel extracted from mikrotik npk. It boots from bootp on a ccr-1036-12G-4S but obviusly it start a &quot;normal&quot; mikrotik services....<br />With hexdump i see they use console=ttyS0,115200 (if I do not wrong)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235729">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">arni</div>
					<div class="post-datetime">
						5 Jun 2014, 13:52					</div>
				</div>
				<div class="post-content content">
					<p>Hi lain, </p><p>I&#039;ve done the same and i also can boot Mikrotik&#039;s kernel from their npk. I also included console=ttyS0,115200 as built-in command line (extracted same way as you did <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /> </p><p>anyways, it doesn&#039;t give any output on serial port. <br />Just a few minutes ago I managed to find a Mikrotik&#039;s patch for 3.3.5 kernel - so i&#039;m trying to compile it in various configurations<br />providing a link here as well, may be it will help to find more than I did - <a href="http://www.mikrotik.com/download/share/linux_3_3_5_patch.gz">http://www.mikrotik.com/download/share/ … 5_patch.gz</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235730">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">efjgrub</div>
					<div class="post-datetime">
						5 Jun 2014, 14:07					</div>
				</div>
				<div class="post-content content">
					<p>arni,</p><p>which toolchain you used to compile the kernel test? and the target?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235731">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">arni</div>
					<div class="post-datetime">
						5 Jun 2014, 14:11					</div>
				</div>
				<div class="post-content content">
					<p>efjgrub,</p><p>I&#039;ve used official tilera toolchain - <a href="http://www.tilera.com/scm/">http://www.tilera.com/scm/</a><br />target - tilegx-unknown-linux-gnu</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235749">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">efjgrub</div>
					<div class="post-datetime">
						5 Jun 2014, 16:40					</div>
				</div>
				<div class="post-content content">
					<p>Thanks Arni,</p><p>I&#039;m waiting for my CCR and soon also be able to help</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235751">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">lain</div>
					<div class="post-datetime">
						5 Jun 2014, 16:53					</div>
				</div>
				<div class="post-content content">
					<p>Nobody will be alone anymore ;-)<br />We will win against ccr/mikrotik. :-)</p><p>Seriusly....</p><p>We try a lot of way to hack ccr hardware. Another way we used is to create a &quot;forged&quot; npk<br />that create /etc/devel-login file but we can&#039;t find the algorithm used for hash calculation at the end of the<br />package.<br />You can read what we done at the end of this page:<br /><a href="http://kingcope.wordpress.com/2013/09/02/mikrotik-routeros-5-and-6-sshd-remote-preauth-heap-corruption/">http://kingcope.wordpress.com/2013/09/0 … orruption/</a></p>											<p class="post-edited">(Last edited by <strong>lain</strong> on 5 Jun 2014, 19:17)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p239551">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">lain</div>
					<div class="post-datetime">
						7 Jul 2014, 16:24					</div>
				</div>
				<div class="post-content content">
					<p>Any update from someone?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p245734">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">arni</div>
					<div class="post-datetime">
						2 Sep 2014, 13:26					</div>
				</div>
				<div class="post-content content">
					<p>Got some updates. I can boot custom kernel on CCR, but there is no simple way to make it bootable. <br />The problem i have now is that there is no a single network interface found in the kernel (there is no tilegx.c driver in the patch they provide). </p><p>Mikrotik support refuses to provide the tilegx.c file (which I think violates GPL), and without this file there is no way to do any networking on the box. I tried to port this file from 3.5, but it can&#039;t find any interfaces too. Seems Mikrotik has changed behaviour of the driver, but doesn&#039;t want to show what they did there <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p251582">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">thomasthomas</div>
					<div class="post-datetime">
						22 Oct 2014, 13:01					</div>
				</div>
				<div class="post-content content">
					<p>It would be interesting to see a step-by-step guide how to make the kernel bootable.<br />I have tried to compile the 3.3.5 kernel (from Mikrotik) or newer 3.15 one&#039;s using the Tilera toolchain without any luck getting console feedback.<br />Modifying kernel options around console, uart, ... don&#039;t seem to have any effect either.</p><p>So after weeks I am still stuck at my first problem, is the kernel is even booting? I would be very happy to see some dmesg output.</p><p>ps. I can provide multiple dev-CCR&#039;s, I have no intrest at all in RouterOS hacking/modifying it (just need small bare-metal linux on these devices).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p253980">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">thomasthomas</div>
					<div class="post-datetime">
						11 Nov 2014, 23:02					</div>
				</div>
				<div class="post-content content">
					<p>UPDATES:<br />I have my custom kernel running (based on 3.17.2), it has been a frustrating experience but I am very persistent if people think it cannot be done <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" />.</p><p>Some information:<br />- It looks like that Tilera run&#039;s some sort of hypervisor before you can run any kernel<br />- Tilera&#039;s hypervisor uses their own filesystem called hvfs, luckly it only has some very basic CRC check<br />- The size of our custom kernel is not a problem, it can be stripped and put in bzip2 format</p><p>The thing that still irritates me is that I needed to extract the hypervisor part out of the mikrotik software, it would be nice to get more native on the hardware (but that might depend on purchase of Tilera&#039;s MDE/ZOL).</p><p><strong><span class="bbu">Extracting the HV/ELF/HVFS parts:</span></strong><br />1) Get the mikrotik kernel (I not going to help you with this part).<br />2) dd bs=1 count=723238 if=../kernel of=part1<br />3) dd bs=1 skip=3082922 if=../kernel of=part3</p><p><strong><span class="bbu">Create your arch/tile environment:</span></strong><br />1) <a href="http://www.tilera.com/scm/tilegx-x86_64.tar.bz2">http://www.tilera.com/scm/tilegx-x86_64.tar.bz2</a><br />2) Create a file export.source (something like this):</p><p>PATH=$PATH:/:/home/thomas/TILE/tilegx-x86_64/bin<br />LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/home/thomas/TILE/tilegx-x86_64/lib:/home/thomas/TILE/tilegx-x86_64/tilegx-unknown-linux-gnu/lib/<br />TILERA_ROOT=&quot;/home/thomas/TILE/tilegx-x86_64&quot;</p><p>3) Activate it:<br />$ source export.source</p><p><strong><span class="bbu">Compile the new kernel:</span></strong><br />1) .config : <a href="http://pastebin.com/A5nz07Ne">http://pastebin.com/A5nz07Ne</a><br />2) make -j2 ARCH=tilegx CROSS_COMPILE=tilegx-unknown-linux-gnu- menuconfig<br />3) make -j2 ARCH=tilegx CROSS_COMPILE=tilegx-unknown-linux-gnu- vmlinux<br />4) strip it: ../../tilegx-x86_64/bin/tilegx-unknown-linux-gnu-strip vmlinux<br />5) compress it: bzip2 vmlinux (arch/tile has no (b)zImage concept as far I could see)</p><p><strong><span class="bbu">Bring everything together:</span></strong><br />1) cat part1 &gt; vmlinux <br />2) cat vmlinux.bz2 &gt;&gt; vmlinux<br />3) Include zero&#039;s, part3 needs to start at 3082922 (0x2F0AAA)<br />dd if=/dev/zero of=part2 bs=1 count=811217<br />cat part2 &gt;&gt; vmlinux<br />4) cat part3 &gt;&gt; vmlinux<br />5) check our size &amp; if readelf gives output <strong>without</strong> any error:<br />$ du -b vmlinux <br />3084096 &nbsp; &nbsp; vmlinux<br />$ readelf -a ./vmlinux</p><p><strong><span class="bbu">First boot:</span></strong><br />The first boot should fail with a CRC error of HVFS, looking like this:<br />(0,0) hv_panic: corrupt hvfs: computed CRC 0xd1d8dbae, trailer CRC 0x4b1d9ff0&nbsp; &nbsp;</p><p>Open your hexeditor and search for the trailer CRC: F0 9F 1D 4B (reverse of 0x 4B 1D 9F F0 within the panic) and replace with the computed CRC (same method: 0xd1d8dbae becomes AE DB D8 D1)</p><p><strong><span class="bbu">Second boot:</span></strong></p><p>Linux version 3.17.2 (thomas@desktop) (gcc version 4.4.6 (GCC) ) #1 SMP Tue Nov 11 21:07:52 CET 2014<br />16336MB memory available.<br />PERCPU: 1 64K pages/cpu @fffffff600000000 s9472 r8192 d47872<br />Built 2 zonelists in Zone order, mobility grouping on.&nbsp; Total pages: 261152</p><p><a href="http://pastebin.com/Zyuz7CjA">http://pastebin.com/Zyuz7CjA</a></p><br /><p>The next step is to include a cpio/xz based filesystem in the custom kernel, this way we can boot towards something like busybox and do more debugging.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p254074">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">thomasthomas</div>
					<div class="post-datetime">
						12 Nov 2014, 19:26					</div>
				</div>
				<div class="post-content content">
					<p><span class="bbu">Bit more automated logic:</span></p><p>part1: first ELF part of Mikrotik<br />part2.bz2: your new/custom kernel<br />part3: trailer hfvs/closing stuff</p><div class="quotebox"><blockquote><p>cat part1 &gt; vmlinux <br />sizepart1=`du -b part1 | awk {&#039;print $1&#039;}`</p><p>cat part2.bz2 &gt;&gt; vmlinux<br />sizepart2=`du -b part2-new.bz2 | awk {&#039;print $1&#039;}`</p><p>part1and2size=$((sizepart1 + sizepart2))<br />locationpart3=$((3082922))<br />tofill=$((locationpart3 - part1and2size))<br />echo &quot;Zero&#039;s to create: $tofill&quot;</p><p>rm part2.bz2-to-part3-zero &gt;/dev/null 2&gt;&amp;1<br />dd if=/dev/zero of=part2.bz2-to-part3-zero bs=1 count=$tofill &gt;/dev/null 2&gt;&amp;1<br />cat part2.bz2-to-part3-zero &gt;&gt; vmlinux</p><p>cat part3 &gt;&gt; vmlinux<br />readelf -a ./vmlinux</p></blockquote></div><p>We still need to find a way to automate the HVFS&#039;s CRC.</p><p>Seems that the network driver has some custom modifications done by Mikrotik:</p><div class="quotebox"><blockquote><p>$ strings tilegx.ko | grep CCR<br />CCR1036-12G-4S<br />CCR1016-12G<br />CCR1036-8G-2S+<br />CCR1009-10G<br />CCR1009-8G-1S-1S+<br />CCR1016-8G<br />CCR1016-8G-1S-1S+<br />CCR1016-12S-1S+<br />CCR1036-12S-1S+<br />CCR1009-8G-1S<br />CCR1072-1G-8S+<br />$ strings tilegx.ko | grep license<br />license=GPL<br />$ strings tilegx.ko | grep author<br />author=Tilera<br />$</p></blockquote></div><br /><p>This is the included kernel one:<br />linux-3.17.2$ grep -r Tilera ./drivers/net/ethernet/tile/tilegx.c <br /> * Copyright 2012 Tilera Corporation. All Rights Reserved.<br />MODULE_AUTHOR(&quot;Tilera Corporation&quot;);<br />&nbsp; &nbsp; pr_info(&quot;Tilera Network Driver\n&quot;);<br />linux-3.17.2$ grep -r CCR ./drivers/net/ethernet/tile/tilegx* <br />linux-3.17.2$ </p><p>But as all devices are included in the CPU (mPIPE/SGMII/XAUI/SerDes...):<br /><a href="http://www.tilera.com/sites/default/files/images/content/White_Paper_Architecture_and_Performance_TILE-Gx.pdf">http://www.tilera.com/sites/default/fil … ILE-Gx.pdf</a></p><p>We should at least see some traces of it, except if it&#039;s &#039;blocked&#039; in this special HV?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p254104">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">thomasthomas</div>
					<div class="post-datetime">
						12 Nov 2014, 23:17					</div>
				</div>
				<div class="post-content content">
					<p>Looking at the network driver issue:<br /><strong>./arch/tile/gxio/mpipe.c</strong> <br />&nbsp; &nbsp; &nbsp; &nbsp; rv = gxio_mpipe_info_enumerate_aux(context, idx, &amp;name, &amp;mac);</p><p>Gives back a value of -1116, it should be a positive integer when any device is found.</p><p><strong>./arch/tile/gxio/iorpc_mpipe_info.c</strong></p><div class="quotebox"><blockquote><p>int gxio_mpipe_info_enumerate_aux(gxio_mpipe_info_context_t *context,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unsigned int idx,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _gxio_mpipe_link_name_t *name,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _gxio_mpipe_link_mac_t *mac)<br />{<br />&nbsp; &nbsp; &nbsp; &nbsp; int __result;<br />&nbsp; &nbsp; &nbsp; &nbsp; struct enumerate_aux_param temp;<br />&nbsp; &nbsp; &nbsp; &nbsp; struct enumerate_aux_param *params = &amp;temp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; __result =<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>hv_dev_pread(context-&gt;fd, 0, (HV_VirtAddr) params, sizeof(*params),<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(((uint64_t)idx &lt;&lt; 32) |<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GXIO_MPIPE_INFO_OP_ENUMERATE_AUX));</strong><br />&nbsp; &nbsp; &nbsp; &nbsp; *name = params-&gt;name;<br />&nbsp; &nbsp; &nbsp; &nbsp; *mac = params-&gt;mac;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; return __result;</p></blockquote></div><p>Does calls to the hypervisor (hv_dev_pread())<br /></p><div class="quotebox"><blockquote><p>/** Read data from a hypervisor device synchronously.<br /> *<br /> *&nbsp; This service transfers data from a hypervisor device to a memory buffer.<br /> *&nbsp; When the service returns, the data has been written from the memory buffer,<br /> *&nbsp; and the buffer will not be further modified by the driver.<br /> *<br /> *&nbsp; No ordering is guaranteed between requests issued from different tiles.</p></blockquote></div>											<p class="post-edited">(Last edited by <strong>thomasthomas</strong> on 12 Nov 2014, 23:19)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p254332">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">iiffi</div>
					<div class="post-datetime">
						14 Nov 2014, 14:59					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I&#039;ve just started working on a new project and for that it would be really nice to have a standard linux (maybe optimised and with some tools) on a CCR.</p><p>as far as I understand what you&#039;ve done so far it looks really promising. But I&#039;m not that experienced in this sort of stuff but if there&#039;s anything I could help you with let me know.</p><p>For now I&#039;ll read more into it.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p255071">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">HoBoPanda</div>
					<div class="post-datetime">
						21 Nov 2014, 01:52					</div>
				</div>
				<div class="post-content content">
					<p>This looks promising. I will have to take home a CCR from my work and try it out. bare-metal linux box on one of these would be cool. Are you getting the kernel out of the npk?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p255411">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">thomasthomas</div>
					<div class="post-datetime">
						24 Nov 2014, 17:44					</div>
				</div>
				<div class="post-content content">
					<p>yes, following is now based on routeros 6.22 (vs 6.20 in my previous post).</p><div class="quotebox"><blockquote><p>$ dd bs=1 count=723238 if=kernel of=part1<br />$ dd bs=1 skip=3082891 if=kernel of=part3-bis</p></blockquote></div><p>lazy-kernel-compile-script (dont forget the export.source):<br /></p><div class="quotebox"><blockquote><p>linux-3.17.2$ cat ../run-compile.sh <br />#!/bin/sh<br />rm vmlinux.bz2 <br />make -j2 ARCH=tilegx CROSS_COMPILE=tilegx-unknown-linux-gnu- vmlinux<br />../../tilegx-x86_64/bin/tilegx-unknown-linux-gnu-strip vmlinux<br />bzip2 vmlinux<br />du vmlinux.bz2<br />cp vmlinux.bz2 ../part2-new.bz2 </p><p>linux-3.17.2$</p></blockquote></div><p>lazy-generate-image-script:<br /></p><div class="quotebox"><blockquote><p>$ cat generate-image.sh <br />#!/bin/sh<br />cat part1 &gt; vmlinux<br />sizepart1=`du -b part1 | awk {&#039;print $1&#039;}`<br />cat part2-new.bz2 &gt;&gt; vmlinux<br />sizepart2=`du -b part2-new.bz2 | awk {&#039;print $1&#039;}`<br />part1and2size=$((sizepart1 + sizepart2))</p><p>#locationpart3=$((3082922))<br />locationpart3=$((3082891))<br />tofill=$((locationpart3 - part1and2size))<br />echo $tofill</p><p>rm part2.bz2-to-part3-zero<br />dd if=/dev/zero of=part2.bz2-to-part3-zero bs=1 count=$tofill<br />cat part2.bz2-to-part3-zero &gt;&gt; vmlinux</p><p>cat part3-bis &gt;&gt; vmlinux<br />$</p></blockquote></div><p>Check the vmlinux with &#039;readelf -a&#039; if all is successful, boot your CCR, modify the CRC and reboot into your custom kernel.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p255927">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">piguasco</div>
					<div class="post-datetime">
						29 Nov 2014, 13:22					</div>
				</div>
				<div class="post-content content">
					<p>Hi thomasthomas and thanks for your posts!</p><p>However, I didn&#039;t get it: did you manage to get the MPIPE ethernet interfaces working on the CCR?<br />If not, I may be able to help in private, if you want to get in touch drop me a line at piguasco@gmail.com thanks <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p257986">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">elliotd123</div>
					<div class="post-datetime">
						17 Dec 2014, 19:34					</div>
				</div>
				<div class="post-content content">
					<p>Hi thomasthomas,<br />We are excited about the prospect of installing openwrt on CCR routers. Were you able to resolve the network driver issue?</p><p>Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p260716">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">thomasthomas</div>
					<div class="post-datetime">
						9 Jan 2015, 19:05					</div>
				</div>
				<div class="post-content content">
					<p>Hey all,</p><p>I did&#039;nt have time to work on this due to lots of travel and other stuff in the past month, I will restart my efforts in the coming days.<br />First goal would be to get some (very basic) linux, this gives a starting point for more research (instead of recompiling and modifying the kernel each time).<br />USB seems to be similar to networking (hv), trying to find other ways of bringing IP for NFS/diskless boot (like serial? internal second port is present).</p><p>I am not a programmer, my level of C is limited to breaking/echoing things. My hope is that as soon as I have a running shell other people can help fixing/making the required kernel code.</p><p>My overall goal would be to have a custom openvswitch-style poc device that has almost no limit in flow table entries compared to existing SDN switch hardware vendors. mPIPE potentially looks good in resolving performance issues you would have on x86 style of lab equipment.</p>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 1 of 3</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=50897&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=50897&amp;p=3.html">3</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>