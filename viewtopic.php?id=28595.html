<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> pppd does not automatically reconnect after enabling multilink</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 30 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p128036">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">zorxd</div>
					<div class="post-datetime">
						11 Feb 2011, 20:46					</div>
				</div>
				<div class="post-content content">
					<p>Hi<br />Before pppd worked well, reconnecting automatically after a few seconds in case of disconnect.<br />But I enabled the multilink option, and now it seems to fail to reconnect if I reboot my ADSL modem:</p><div class="quotebox"><blockquote><p>Plugin rp-pppoe.so loaded.<br />PADS: Service-Name: &#039;&#039;<br />PPP session is 3905<br />using channel 27<br />Starting negotiation on eth1<br />sent [LCP ConfReq id=0x1 &lt;mru 1492&gt; &lt;magic 0x78a0cbdb&gt; &lt;mrru 1492&gt; &lt;endpoint [MAC:00:26:f2:f1:d3:e3]&gt;]<br />rcvd [LCP ConfReq id=0x79 &lt;mru 1492&gt; &lt;auth pap&gt; &lt;magic 0x4b2a0c1c&gt;]<br />sent [LCP ConfAck id=0x79 &lt;mru 1492&gt; &lt;auth pap&gt; &lt;magic 0x4b2a0c1c&gt;]<br />rcvd [LCP ConfRej id=0x1 &lt;mrru 1492&gt; &lt;endpoint [MAC:00:26:f2:f1:d3:e3]&gt;]<br />sent [LCP ConfReq id=0x2 &lt;mru 1492&gt; &lt;magic 0x78a0cbdb&gt;]<br />rcvd [LCP ConfAck id=0x2 &lt;mru 1492&gt; &lt;magic 0x78a0cbdb&gt;]<br />sent [LCP EchoReq id=0x0 magic=0x78a0cbdb]<br />sent [PAP AuthReq id=0x1 user=&quot;username@realm2.acanac.net&quot; password=&lt;hidden&gt;]<br />rcvd [LCP EchoRep id=0x0 magic=0x4b2a0c1c]<br />rcvd [LCP ConfReq id=0x1 &lt;asyncmap 0x0&gt; &lt;auth pap&gt; &lt;magic 0x80fcd4e1&gt; &lt;mrru 1500&gt; &lt;endpoint [MAC:00:15:17:d6:a6:be]&gt;]<br />sent [LCP ConfReq id=0x3 &lt;mru 1492&gt; &lt;magic 0xf377aa67&gt; &lt;mrru 1492&gt; &lt;endpoint [MAC:00:26:f2:f1:d3:e3]&gt;]<br />sent [LCP ConfRej id=0x1 &lt;asyncmap 0x0&gt;]<br />rcvd [LCP ConfAck id=0x3 &lt;mru 1492&gt; &lt;magic 0xf377aa67&gt; &lt;mrru 1492&gt; &lt;endpoint [MAC:00:26:f2:f1:d3:e3]&gt;]<br />rcvd [LCP ConfReq id=0x2 &lt;auth pap&gt; &lt;magic 0x80fcd4e1&gt; &lt;mrru 1500&gt; &lt;endpoint [MAC:00:15:17:d6:a6:be]&gt;]<br />sent [LCP ConfAck id=0x2 &lt;auth pap&gt; &lt;magic 0x80fcd4e1&gt; &lt;mrru 1500&gt; &lt;endpoint [MAC:00:15:17:d6:a6:be]&gt;]<br />sent [LCP EchoReq id=0x0 magic=0xf377aa67]<br />sent [PAP AuthReq id=0x2 user=&quot;username@realm2.acanac.net&quot; password=&lt;hidden&gt;]<br />rcvd [LCP EchoReq id=0x0 magic=0x80fcd4e1]<br />sent [LCP EchoRep id=0x0 magic=0xf377aa67]<br />rcvd [LCP EchoRep id=0x0 magic=0x80fcd4e1]<br />rcvd [PAP AuthAck id=0x2 &quot;&quot;]<br />PAP authentication succeeded<br />peer from calling number 00:90:1A:A2:79:61 authorized<br />Renamed ppp0 to pppoe-wan<br />Using interface pppoe-wan<br />New bundle pppoe-wan created<br />sent [IPCP ConfReq id=0x1 &lt;addr 192.168.12.1&gt; &lt;ms-dns1 0.0.0.0&gt; &lt;ms-dns3 0.0.0.0&gt;]<br />rcvd [IPCP ConfReq id=0x1 &lt;addr 66.49.167.125&gt;]<br />sent [IPCP ConfAck id=0x1 &lt;addr 66.49.167.125&gt;]<br />rcvd [IPCP ConfNak id=0x1 &lt;addr 69.171.X.Y&gt; &lt;ms-dns1 67.55.0.11&gt; &lt;ms-dns3 66.49.220.95&gt;]<br />sent [IPCP ConfReq id=0x2 &lt;addr 69.171.X.Y&gt; &lt;ms-dns1 67.55.0.11&gt; &lt;ms-dns3 66.49.220.95&gt;]<br />rcvd [IPCP ConfAck id=0x2 &lt;addr 69.171.X.Y&gt; &lt;ms-dns1 67.55.0.11&gt; &lt;ms-dns3 66.49.220.95&gt;]<br />local&nbsp; IP address 69.171.X.Y<br />remote IP address 66.49.167.125<br />primary&nbsp; &nbsp;DNS address 67.55.0.11<br />secondary DNS address 66.49.220.95<br />Script /etc/ppp/ip-up started (pid 8810)<br />Script /etc/ppp/ip-up finished (pid 8810), status = 0x0<br />[I rebooted modem here]<br />No response to 5 echo-requests<br />Serial link appears to be disconnected.<br />sent [LCP TermReq id=0x4 &quot;Peer not responding&quot;]<br />sent [LCP TermReq id=0x5 &quot;Peer not responding&quot;]<br />Link terminated.<br />Last channel has disconnected<br />Connect time 1.4 minutes.<br />Sent 4269582 bytes, received 195181 bytes.<br />Script /etc/ppp/ip-down started (pid 9364)<br />Connection terminated.<br />Script /etc/ppp/ip-down finished (pid 9364), status = 0x1<br />Timeout waiting for PADO packets<br />Unable to complete PPPoE Discovery<br />Timeout waiting for PADO packets<br />Unable to complete PPPoE Discovery<br />PADS: Service-Name: &#039;&#039;<br />PPP session is 3921<br />using channel 28<br />Starting negotiation on eth1<br />sent [LCP ConfReq id=0x6 &lt;mru 1492&gt; &lt;magic 0x8d60700c&gt; &lt;mrru 1492&gt; &lt;endpoint [MAC:00:26:f2:f1:d3:e3]&gt;]<br />rcvd [LCP ConfReq id=0x9f &lt;mru 1492&gt; &lt;auth pap&gt; &lt;magic 0x6b70c4d9&gt;]<br />sent [LCP ConfAck id=0x9f &lt;mru 1492&gt; &lt;auth pap&gt; &lt;magic 0x6b70c4d9&gt;]<br />rcvd [LCP ConfRej id=0x6 &lt;mrru 1492&gt; &lt;endpoint [MAC:00:26:f2:f1:d3:e3]&gt;]<br />sent [LCP ConfReq id=0x7 &lt;mru 1492&gt; &lt;magic 0x8d60700c&gt;]<br />rcvd [LCP ConfAck id=0x7 &lt;mru 1492&gt; &lt;magic 0x8d60700c&gt;]<br />sent [LCP EchoReq id=0x0 magic=0x8d60700c]<br />rcvd [LCP EchoRep id=0x0 magic=0x6b70c4d9]<br />sent [LCP EchoReq id=0x1 magic=0x8d60700c]<br />rcvd [LCP EchoRep id=0x1 magic=0x6b70c4d9]<br />sent [LCP EchoReq id=0x2 magic=0x8d60700c]<br />rcvd [LCP EchoRep id=0x2 magic=0x6b70c4d9]<br />sent [LCP EchoReq id=0x3 magic=0x8d60700c]<br />rcvd [LCP EchoRep id=0x3 magic=0x6b70c4d9]<br />sent [LCP EchoReq id=0x4 magic=0x8d60700c]<br />rcvd [LCP EchoRep id=0x4 magic=0x6b70c4d9]<br />sent [LCP EchoReq id=0x5 magic=0x8d60700c]<br />rcvd [LCP EchoRep id=0x5 magic=0x6b70c4d9]<br />sent [LCP EchoReq id=0x6 magic=0x8d60700c]<br />rcvd [LCP EchoRep id=0x6 magic=0x6b70c4d9]<br />sent [LCP EchoReq id=0x7 magic=0x8d60700c]<br />rcvd [LCP EchoRep id=0x7 magic=0x6b70c4d9]<br />sent [LCP EchoReq id=0x8 magic=0x8d60700c]<br />rcvd [LCP EchoRep id=0x8 magic=0x6b70c4d9]<br />sent [LCP EchoReq id=0x9 magic=0x8d60700c]<br />rcvd [LCP EchoRep id=0x9 magic=0x6b70c4d9]<br />sent [LCP EchoReq id=0xa magic=0x8d60700c]<br />rcvd [LCP EchoRep id=0xa magic=0x6b70c4d9]<br />sent [LCP EchoReq id=0xb magic=0x8d60700c]<br />rcvd [LCP EchoRep id=0xb magic=0x6b70c4d9]<br />sent [LCP EchoReq id=0xc magic=0x8d60700c]<br />rcvd [LCP EchoRep id=0xc magic=0x6b70c4d9]<br />sent [LCP EchoReq id=0xd magic=0x8d60700c]<br />rcvd [LCP EchoRep id=0xd magic=0x6b70c4d9]<br />sent [LCP EchoReq id=0xe magic=0x8d60700c]<br />rcvd [LCP EchoRep id=0xe magic=0x6b70c4d9]<br />sent [LCP EchoReq id=0xf magic=0x8d60700c]<br />rcvd [LCP EchoRep id=0xf magic=0x6b70c4d9]<br />sent [LCP EchoReq id=0x10 magic=0x8d60700c]<br />rcvd [LCP EchoRep id=0x10 magic=0x6b70c4d9]<br />sent [LCP EchoReq id=0x11 magic=0x8d60700c]<br />rcvd [LCP EchoRep id=0x11 magic=0x6b70c4d9]<br />sent [LCP EchoReq id=0x12 magic=0x8d60700c]<br />rcvd [LCP EchoRep id=0x12 magic=0x6b70c4d9]<br />sent [LCP EchoReq id=0x13 magic=0x8d60700c]<br />rcvd [LCP EchoRep id=0x13 magic=0x6b70c4d9]<br />rcvd [LCP TermReq id=0xa0]<br />LCP terminated by peer<br />sent [LCP TermAck id=0xa0]<br />Link terminated.<br />Modem hangup</p></blockquote></div><p>And it just sits there forever after modem hangup. I need to restart pppd or reboot router to get internet working again. Is there a way to do this automatically?<br />I am using backfire r21803 on WNDR3700</p>											<p class="post-edited">(Last edited by <strong>zorxd</strong> on 11 Feb 2011, 20:48)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p128042">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">zorxd</div>
					<div class="post-datetime">
						11 Feb 2011, 21:53					</div>
				</div>
				<div class="post-content content">
					<p>I also noticed that some people had a similar problem with wireless broadband modems:<br /><a href="https://lists.openwrt.org/pipermail/openwrt-devel/2010-August/007832.html">https://lists.openwrt.org/pipermail/ope â€¦ 07832.html</a><br /><a href="https://forum.openwrt.org/viewtopic.php?pid=123286">https://forum.openwrt.org/viewtopic.php?pid=123286</a></p><p>In both case, pppd does not reconnect after a failure</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>