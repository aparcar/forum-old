<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Detect OpenWRT at compile time (conditional compilation)?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 28 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p156875">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">MS3FGX</div>
					<div class="post-datetime">
						10 Feb 2012, 04:33					</div>
				</div>
				<div class="post-content content">
					<p>I have a program which I&#039;ve written which builds and runs successfully under OpenWRT, but there are a few tweaks I would like to make when it&#039;s being built for WRT versus when it&#039;s being built for standard Linux (changing some default file locations, number of devices to cache, etc). It more or less all boils down to changing some variables depending on what kind of system it&#039;s being built for.</p><p>I would like it to happen as transparently as possible, so my idea was to use some conditional compilation setup to change a few variables based on the compiler used. I have been reading up on #ifdef and using compiler macros to determine things like the OS and architecture, but I can&#039;t figure out how to apply this to OpenWRT.</p><p>Is there any accepted way to do this? Should I just check for non-x86 architectures? Is there a macro I can check for that will correspond to the cross-compiler?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p156983">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">aport</div>
					<div class="post-datetime">
						10 Feb 2012, 23:29					</div>
				</div>
				<div class="post-content content">
					<p>In the OpenWrt Makefile for your package, why not define something in cflags that you can use?<br /></p><div class="codebox"><pre><code>TARGET_CFLAGS += -DOPENWRT_BUILD</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p156992">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">MS3FGX</div>
					<div class="post-datetime">
						11 Feb 2012, 04:02					</div>
				</div>
				<div class="post-content content">
					<p>Good point, that certainly works. Just didn&#039;t know if this is something that was common and had an accepted convention. Thanks.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p156993">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						11 Feb 2012, 04:02					</div>
				</div>
				<div class="post-content content">
					<p>The OpenWRT Makefile under the root directory has a line to check OPENWRT_BUILD variable.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>