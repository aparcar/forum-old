<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> how to use the new block-mount ?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 19 Jun 2015 and 6 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 5 of 9</div><nav><ul><li><a href="viewtopic.php%3Fid=44939&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=44939&amp;p=3.html">3</a></li><li><a href="viewtopic.php%3Fid=44939&amp;p=4.html">4</a></li><li class="pagination-current"><span>5</span></li><li><a href="viewtopic.php%3Fid=44939&amp;p=6.html">6</a></li><li><a href="viewtopic.php%3Fid=44939&amp;p=7.html">7</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=44939&amp;p=9.html">9</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p208266">
				<div class="post-metadata">
					<div class="post-num">Post #101</div>
					<div class="post-author">harhar</div>
					<div class="post-datetime">
						27 Jul 2013, 12:49					</div>
				</div>
				<div class="post-content content">
					<p>The most recent build in <a href="http://downloads.openwrt.org/snapshots/trunk/ar71xx/packages/">http://downloads.openwrt.org/snapshots/ … /packages/</a> is r37528. Looking forward to install &gt;=r37551..</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p208270">
				<div class="post-metadata">
					<div class="post-num">Post #102</div>
					<div class="post-author">makakasirapuka</div>
					<div class="post-datetime">
						27 Jul 2013, 13:17					</div>
				</div>
				<div class="post-content content">
					<p>harhar, what are you looking for in packages? just three hours left for 37560: <br /><a href="http://buildbot.openwrt.org:8010/builders/ar71xx/builds/275">http://buildbot.openwrt.org:8010/builde … builds/275</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p208314">
				<div class="post-metadata">
					<div class="post-num">Post #103</div>
					<div class="post-author">makakasirapuka</div>
					<div class="post-datetime">
						28 Jul 2013, 00:38					</div>
				</div>
				<div class="post-content content">
					<p>how do I check if alsa or oss is enabled in the build I downloaded from the above link? <br />I&#039;m trying to setup&nbsp; a sound card, but I can&#039;t get rid of cracks and pops...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p208359">
				<div class="post-metadata">
					<div class="post-num">Post #104</div>
					<div class="post-author">harhar</div>
					<div class="post-datetime">
						28 Jul 2013, 17:34					</div>
				</div>
				<div class="post-content content">
					<p>It&#039;s working out of the box (using r37568) yippie!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p208380">
				<div class="post-metadata">
					<div class="post-num">Post #105</div>
					<div class="post-author">Montbra</div>
					<div class="post-datetime">
						29 Jul 2013, 00:55					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>harhar wrote:</cite><blockquote><p>It&#039;s working out of the box (using r37568) yippie!</p></blockquote></div><p>It&#039;s working in my TP-Link TL-WR1043N/ND v1 too. Thanks Jow and all developers.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p208404">
				<div class="post-metadata">
					<div class="post-num">Post #106</div>
					<div class="post-author">silverk</div>
					<div class="post-datetime">
						29 Jul 2013, 12:30					</div>
				</div>
				<div class="post-content content">
					<p>working!</p><p>DISTRIB_DESCRIPTION=&quot;OpenWrt Barrier Breaker r37568&quot; (snapshot built on 28-Jul-2013 03:28 )<br />on<br />system type&nbsp; &nbsp; &nbsp; &nbsp; : Atheros AR9330 rev 1<br />machine&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : TP-LINK TL-MR10U</p><p>following modules installed: kmod-usb-storage kmod-fs-ext4 block-mount libmount kmod-usb-ohci</p><p>configured not as / but /overlay as described here <a href="http://wiki.openwrt.org/doc/howto/extroot#openwrt.barrier.breaker.trunk">http://wiki.openwrt.org/doc/howto/extro … aker.trunk</a></p><p>many thanks for fixing</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p208419">
				<div class="post-metadata">
					<div class="post-num">Post #107</div>
					<div class="post-author">waldoo</div>
					<div class="post-datetime">
						29 Jul 2013, 15:32					</div>
				</div>
				<div class="post-content content">
					<p>now it is also working on my asus wl500gp v1.<br />i only have the note that is seems that doing a &quot;sysupgrade -c ....&quot; is saving also the openwrt_release&nbsp; openwrt_version? the last days after flashing i always had the same Firmware Version in luci so i was always a bit confused <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />Anyhow it is working as &quot;/&quot; on my stick with the last trunk snapshot<br />thx all</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p208432">
				<div class="post-metadata">
					<div class="post-num">Post #108</div>
					<div class="post-author">gently</div>
					<div class="post-datetime">
						29 Jul 2013, 18:30					</div>
				</div>
				<div class="post-content content">
					<p>doesn&#039;t work for me, tried a couple of times, increased the delay_root to 10 secs, r37568, tp-link wr-720n v3</p><p>however i see overlay in tmp:<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# ls /tmp/ -la | grep overlay
drwxr-xr-x    2 root     root            40 Jan  1  1970 overlay</code></pre></div><div class="codebox"><pre><code>root@OpenWrt:~# cat /etc/config/fstab
config &#039;global&#039;
        option  anon_swap       &#039;0&#039;
        option  anon_mount      &#039;0&#039;
        option  auto_swap       &#039;1&#039;
        option  auto_mount      &#039;1&#039;
        option  delay_root      &#039;10&#039;
        option  check_fs        &#039;0&#039;

config &#039;mount&#039;
        option  target  &#039;/mnt/sda&#039;
        option  uuid    &#039;5071aa7e-2cfe-4e6a-a232-125a2ab4a125&#039;
        option  enabled &#039;0&#039;

config &#039;mount&#039;
        option  target  &#039;/overlay&#039;
        option  uuid    &#039;6397357e-01ac-4976-8d1b-ddd2c9e0584e&#039;
        option  enabled &#039;1&#039;

config &#039;swap&#039;
        option  uuid    &#039;72973a2d-032b-4db1-91b8-aaf4429ea724&#039;
        option  enabled &#039;1&#039;</code></pre></div><div class="codebox"><pre><code>root@OpenWrt:~# block detect
config &#039;global&#039;
        option  anon_swap       &#039;0&#039;
        option  anon_mount      &#039;0&#039;
        option  auto_swap       &#039;1&#039;
        option  auto_mount      &#039;1&#039;
        option  delay_root      &#039;5&#039;
        option  check_fs        &#039;0&#039;

config &#039;mount&#039;
        option  target  &#039;/mnt/sda&#039;
        option  uuid    &#039;5071aa7e-2cfe-4e6a-a232-125a2ab4a125&#039;
        option  enabled &#039;0&#039;

config &#039;mount&#039;
        option  target  &#039;/mnt/sda1&#039;
        option  uuid    &#039;6397357e-01ac-4976-8d1b-ddd2c9e0584e&#039;
        option  enabled &#039;0&#039;

config &#039;swap&#039;
        option  uuid    &#039;72973a2d-032b-4db1-91b8-aaf4429ea724&#039;
        option  enabled &#039;0&#039;</code></pre></div><div class="codebox"><pre><code>root@OpenWrt:~# block info
/dev/mtdblock2: UUID=&quot;ccfa28d7-7b0b3e26-61b36307-16c08e58&quot; VERSION=&quot;4.0&quot; TYPE=&quot;squashfs&quot;
/dev/mtdblock3: TYPE=&quot;jffs2&quot;
/dev/sda: UUID=&quot;5071aa7e-2cfe-4e6a-a232-125a2ab4a125&quot; VERSION=&quot;1.0&quot; TYPE=&quot;ext2&quot;
/dev/sda1: UUID=&quot;6397357e-01ac-4976-8d1b-ddd2c9e0584e&quot; NAME=&quot;EXT_JOURNAL&quot; VERSION=&quot;1.0&quot; TYPE=&quot;ext3&quot;
/dev/sda2: UUID=&quot;72973a2d-032b-4db1-91b8-aaf4429ea724&quot; VERSION=&quot;2&quot; TYPE=&quot;swap&quot;</code></pre></div><div class="codebox"><pre><code>root@OpenWrt:~# mount
rootfs on / type rootfs (rw)
/dev/root on /rom type squashfs (ro,relatime)
proc on /proc type proc (rw,noatime)
sysfs on /sys type sysfs (rw,noatime)
tmpfs on /tmp type tmpfs (rw,nosuid,nodev,noatime)
/dev/mtdblock3 on /overlay type jffs2 (rw,noatime)
overlayfs:/overlay on / type overlayfs (rw,noatime,lowerdir=/,upperdir=/overlay)
tmpfs on /dev type tmpfs (rw,relatime,size=512k,mode=755)
devpts on /dev/pts type devpts (rw,relatime,mode=600)
debugfs on /sys/kernel/debug type debugfs (rw,noatime)</code></pre></div><br /><p>noticied strange lines in logread output:<br /></p><div class="codebox"><pre><code>Thu Jan  1 00:00:26 1970 daemon.info sysinit: this file has been obseleted. please call &quot;/sbin/block mount&quot; directly
Thu Jan  1 00:00:27 1970 auth.error kernel: [   27.050000] sd 3:0:0:0: [sda] 3911680 512-byte logical blocks: (2.00 GB/1.86 GiB)
Thu Jan  1 00:00:27 1970 auth.error kernel: [   27.060000] sd 3:0:0:0: [sda] Write cache: enabled, read cache: enabled, doesn&#039;t support DPO or FUA
Thu Jan  1 00:00:27 1970 auth.info kernel: [   27.100000]  sda: sda1 sda2
Thu Jan  1 00:00:27 1970 daemon.info sysinit: /dev/mtdblock3 is already mounted
Thu Jan  1 00:00:27 1970 auth.info kernel: [   27.470000] Adding 65532k swap on /dev/sda2.  Priority:-1 extents:1 across:65532k</code></pre></div>											<p class="post-edited">(Last edited by <strong>gently</strong> on 29 Jul 2013, 19:02)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p208447">
				<div class="post-metadata">
					<div class="post-num">Post #109</div>
					<div class="post-author">kurczaq</div>
					<div class="post-datetime">
						29 Jul 2013, 20:53					</div>
				</div>
				<div class="post-content content">
					<p>/dev/sda: UUID=&quot;5071aa7e-2cfe-4e6a-a232-125a2ab4a125&quot; VERSION=&quot;1.0&quot; TYPE=&quot;ext2&quot;</p><p>something is wrong with your usb drive / partitions... sda should not be detected as partition!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p208586">
				<div class="post-metadata">
					<div class="post-num">Post #110</div>
					<div class="post-author">djrh</div>
					<div class="post-datetime">
						31 Jul 2013, 05:15					</div>
				</div>
				<div class="post-content content">
					<p>I have a weird problem on WDR3600 (currently on Bleeding Edge, r37619)</p><p>The first time I configure fstab and reboot the router, it works fine:<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# df
Filesystem           1K-blocks      Used Available Use% Mounted on
rootfs                  958872     14764    878184   2% /
/dev/root                 1792      1792         0 100% /rom
tmpfs                    63196       352     62844   1% /tmp
/dev/sda1               958872     14764    878184   2% /overlay
overlayfs:/overlay      958872     14764    878184   2% /
tmpfs                      512         0       512   0% /dev</code></pre></div><p>Then I login, reboot WIHTOUT CHANGING ANYTHING, and the extroot does not work anymore. WTF??? PLEASE HELP:<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# df
Filesystem           1K-blocks      Used Available Use% Mounted on
rootfs                    5184      2828      2356  55% /
/dev/root                 1792      1792         0 100% /rom
tmpfs                    63196       352     62844   1% /tmp
/dev/mtdblock3            5184      2828      2356  55% /overlay
overlayfs:/overlay        5184      2828      2356  55% /
tmpfs                      512         0       512   0% /dev</code></pre></div><p>I tried with another USB key, but it has the same behaviour <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" />((</p><p>My info:<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# block info
/dev/mtdblock2: UUID=&quot;4057e985-d5377bc4-ed68f609-bf189eca&quot; VERSION=&quot;4.0&quot; TYPE=&quot;squashfs&quot;
/dev/mtdblock3: TYPE=&quot;jffs2&quot;
/dev/sda1: UUID=&quot;cebc1024-1f22-483e-b02c-8b111e79e9e1&quot; NAME=&quot;EXT_JOURNAL&quot; VERSION=&quot;1.0&quot; TYPE=&quot;ext4&quot;</code></pre></div><p>I use OVERLAY:<br /></p><div class="codebox"><pre><code>config &#039;global&#039;
        option  anon_swap       &#039;0&#039;
        option  anon_mount      &#039;0&#039;
        option  auto_swap       &#039;1&#039;
        option  auto_mount      &#039;1&#039;
        option  delay_root      &#039;0&#039;
        option  check_fs        &#039;0&#039;

config &#039;mount&#039;
        option  target  &#039;/overlay&#039;
        option  uuid    &#039;cebc1024-1f22-483e-b02c-8b111e79e9e1&#039;
        option  enabled &#039;1&#039;</code></pre></div><div class="codebox"><pre><code>Wed Jul 31 02:10:11 2013 daemon.info sysinit: this file has been obseleted. please call &quot;/sbin/block mount&quot; directly
Wed Jul 31 02:10:11 2013 daemon.info sysinit: /dev/mtdblock3 is already mounted</code></pre></div>											<p class="post-edited">(Last edited by <strong>djrh</strong> on 31 Jul 2013, 05:18)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p208587">
				<div class="post-metadata">
					<div class="post-num">Post #111</div>
					<div class="post-author">djrh</div>
					<div class="post-datetime">
						31 Jul 2013, 05:16					</div>
				</div>
				<div class="post-content content">
					<p>additional info:</p><div class="codebox"><pre><code>root@OpenWrt:~# mount
rootfs on / type rootfs (rw)
/dev/root on /rom type squashfs (ro,relatime)
proc on /proc type proc (rw,noatime)
sysfs on /sys type sysfs (rw,noatime)
tmpfs on /tmp type tmpfs (rw,nosuid,nodev,noatime)
/dev/mtdblock3 on /overlay type jffs2 (rw,noatime)
overlayfs:/overlay on / type overlayfs (rw,noatime,lowerdir=/,upperdir=/overlay)
tmpfs on /dev type tmpfs (rw,relatime,size=512k,mode=755)
devpts on /dev/pts type devpts (rw,relatime,mode=600)
debugfs on /sys/kernel/debug type debugfs (rw,noatime)</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p208592">
				<div class="post-metadata">
					<div class="post-num">Post #112</div>
					<div class="post-author">djrh</div>
					<div class="post-datetime">
						31 Jul 2013, 06:44					</div>
				</div>
				<div class="post-content content">
					<p>I think I found something relevant. The only way to make it work after it stops working is to reformat the usb drive by following this:</p><div class="codebox"><pre><code>mkfs.ext4 /dev/sda1  
mount /dev/sda1 /mnt
mkdir /tmp/cproot
mount --bind / /tmp/cproot
tar -C /tmp/cproot -cvf - . | tar -C /mnt -xvf -
sync ; umount /mnt
umount /tmp/cproot


block detect &gt; /etc/config/fstab


vi /etc/config/fstab</code></pre></div><p>After the first reboot, I get this in the log file:</p><p>Thu Jan&nbsp; 1 00:00:12 1970 auth.error kernel: [&nbsp; &nbsp; 9.890000] sd 0:0:0:0: [sda] Attached SCSI removable disk<br />Thu Jan&nbsp; 1 00:00:12 1970 auth.info kernel: [&nbsp; &nbsp;11.740000] EXT4-fs (sda1): mounted filesystem with ordered data mode. Opts: </p><br /><p>After the second, I get an extra line:</p><p>Thu Jan&nbsp; 1 00:00:12 1970 auth.error kernel: [&nbsp; &nbsp; 9.820000] sd 0:0:0:0: [sda] Attached SCSI removable disk<br />Thu Jan&nbsp; 1 00:00:12 1970 auth.info kernel: [&nbsp; &nbsp;11.980000] EXT4-fs (sda1): recovery complete<br />Thu Jan&nbsp; 1 00:00:12 1970 auth.info kernel: [&nbsp; &nbsp;11.990000] EXT4-fs (sda1): mounted filesystem with ordered data mode. Opts: </p><br /><p>I think that there is something that try to &quot;recover&quot; the data on the USB, but it actually messes it up. HELP!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p208595">
				<div class="post-metadata">
					<div class="post-num">Post #113</div>
					<div class="post-author">djrh</div>
					<div class="post-datetime">
						31 Jul 2013, 07:08					</div>
				</div>
				<div class="post-content content">
					<p>So the problem is that after the first reboot, it mounts /dev/sda to /overlay. But on second reboot, it does something on the USB, so after the reboot it won&#039;t work anymore. I am thinking, the USB was the root, so OpenWRT thinks it did not shut down properly, so it runs some scan at startup.</p><p>Am I the only one with this problem?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p208604">
				<div class="post-metadata">
					<div class="post-num">Post #114</div>
					<div class="post-author">johan666</div>
					<div class="post-datetime">
						31 Jul 2013, 10:05					</div>
				</div>
				<div class="post-content content">
					<p>As I said previously <a href="https://forum.openwrt.org/viewtopic.php?pid=207741#p207741">https://forum.openwrt.org/viewtopic.php … 41#p207741</a><br />You need to delete that file, otherwise extroot will think that you extroot partition has changed and invalid.<br />I think that is a bug.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p208624">
				<div class="post-metadata">
					<div class="post-num">Post #115</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						31 Jul 2013, 13:45					</div>
				</div>
				<div class="post-content content">
					<p>Yes it is a bug that happens if the uuid string is longer than 32 bytes (the internal sprintf buffer to write it to the extroot tag file is only 32 byte large so the uuid is truncated and is detected as being invalid on the next boot).</p><p>Fixed with <a href="https://dev.openwrt.org/changeset/37623">https://dev.openwrt.org/changeset/37623</a> (<a href="http://nbd.name/gitweb.cgi?p=luci2/ubox.git;a=commit;h=21737b1ff2e0be28b68293c7ac198a8fe505cbc2">http://nbd.name/gitweb.cgi?p=luci2/ubox … 8fe505cbc2</a>)</p><p>As a temporary workaround one can do something like:<br /></p><div class="codebox"><pre><code>echo -n &quot;cebc1024-1f22-483e-b02c-8b111e79e9e1&quot; &gt; /etc/.extroot-uuid</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p208639">
				<div class="post-metadata">
					<div class="post-num">Post #116</div>
					<div class="post-author">gently</div>
					<div class="post-datetime">
						31 Jul 2013, 15:59					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>kurczaq wrote:</cite><blockquote><p>/dev/sda: UUID=&quot;5071aa7e-2cfe-4e6a-a232-125a2ab4a125&quot; VERSION=&quot;1.0&quot; TYPE=&quot;ext2&quot;</p><p>something is wrong with your usb drive / partitions... sda should not be detected as partition!</p></blockquote></div><p>I investigated a bit and it looks really strange, system detects the partion while it is not there, here we go:</p><div class="codebox"><pre><code>root@OpenWrt:~# dmesg | grep sda
[   11.030000] sd 3:0:0:0: [sda] Attached SCSI removable disk
[   17.600000] sd 3:0:0:0: [sda] 3911680 512-byte logical blocks: (2.00 GB/1.86 GiB)
[   17.680000] sd 3:0:0:0: [sda] Write cache: enabled, read cache: enabled, doesn&#039;t support DPO or FUA
[   18.110000]  sda: unknown partition table</code></pre></div><div class="codebox"><pre><code>root@OpenWrt:~# fdisk -l /dev/sda

Disk /dev/sda (Sun disk label): 62 heads, 62 sectors, 1017 cylinders
Units = sectors of 1 * 512 bytes

   Device Flag    Start       End    Blocks   Id  System</code></pre></div><div class="codebox"><pre><code>root@OpenWrt:~# fdisk -l

Disk /dev/mtdblock0: 0 MB, 131072 bytes
255 heads, 63 sectors/track, 0 cylinders, total 256 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes


Disk /dev/mtdblock1: 1 MB, 1059840 bytes
255 heads, 63 sectors/track, 0 cylinders, total 2070 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes


Disk /dev/mtdblock2: 2 MB, 2937344 bytes
255 heads, 63 sectors/track, 0 cylinders, total 5737 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes


Disk /dev/mtdblock3: 1 MB, 1114112 bytes
255 heads, 63 sectors/track, 0 cylinders, total 2176 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes


Disk /dev/mtdblock4: 0 MB, 65536 bytes
255 heads, 63 sectors/track, 0 cylinders, total 128 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes


Disk /dev/mtdblock5: 3 MB, 3997696 bytes
255 heads, 63 sectors/track, 0 cylinders, total 7808 sectors
Units = sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes


Disk /dev/sda (Sun disk label): 62 heads, 62 sectors, 1017 cylinders
Units = sectors of 1 * 512 bytes

   Device Flag    Start       End    Blocks   Id  System</code></pre></div><div class="codebox"><pre><code>root@OpenWrt:~# cat /proc/partitions
major minor  #blocks  name

  31        0        128 mtdblock0
  31        1       1035 mtdblock1
  31        2       2868 mtdblock2
  31        3       1088 mtdblock3
  31        4         64 mtdblock4
  31        5       3904 mtdblock5
   8        0    1955840 sda</code></pre></div><div class="codebox"><pre><code>root@OpenWrt:~# block info
/dev/mtdblock2: UUID=&quot;4057e985-d5377bc4-ed68f609-bf189eca&quot; VERSION=&quot;4.0&quot; TYPE=&quot;squashfs&quot;
/dev/mtdblock3: TYPE=&quot;jffs2&quot;
/dev/sda: UUID=&quot;5071aa7e-2cfe-4e6a-a232-125a2ab4a125&quot; VERSION=&quot;1.0&quot; TYPE=&quot;ext2&quot;</code></pre></div><div class="codebox"><pre><code>root@OpenWrt:~# block detect
config &#039;global&#039;
        option  anon_swap       &#039;0&#039;
        option  anon_mount      &#039;0&#039;
        option  auto_swap       &#039;1&#039;
        option  auto_mount      &#039;1&#039;
        option  delay_root      &#039;5&#039;
        option  check_fs        &#039;0&#039;

config &#039;mount&#039;
        option  target  &#039;/mnt/sda&#039;
        option  uuid    &#039;5071aa7e-2cfe-4e6a-a232-125a2ab4a125&#039;
        option  enabled &#039;0&#039;</code></pre></div><p>is it a bug or i&#039;m missing something?</p>											<p class="post-edited">(Last edited by <strong>gently</strong> on 31 Jul 2013, 16:02)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p208640">
				<div class="post-metadata">
					<div class="post-num">Post #117</div>
					<div class="post-author">gently</div>
					<div class="post-datetime">
						31 Jul 2013, 16:10					</div>
				</div>
				<div class="post-content content">
					<p>looks like managed to wipe everything with the following command:<br />dd if=/dev/zero of=/dev/sda</p><p>now there is no orphand partition:<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# block info
/dev/mtdblock2: UUID=&quot;4057e985-d5377bc4-ed68f609-bf189eca&quot; VERSION=&quot;4.0&quot; TYPE=&quot;squashfs&quot;
/dev/mtdblock3: TYPE=&quot;jffs2&quot;</code></pre></div><div class="codebox"><pre><code>root@OpenWrt:~# block detect
config &#039;global&#039;
        option  anon_swap       &#039;0&#039;
        option  anon_mount      &#039;0&#039;
        option  auto_swap       &#039;1&#039;
        option  auto_mount      &#039;1&#039;
        option  delay_root      &#039;5&#039;
        option  check_fs        &#039;0&#039;</code></pre></div>											<p class="post-edited">(Last edited by <strong>gently</strong> on 31 Jul 2013, 17:22)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p208644">
				<div class="post-metadata">
					<div class="post-num">Post #118</div>
					<div class="post-author">gently</div>
					<div class="post-datetime">
						31 Jul 2013, 16:35					</div>
				</div>
				<div class="post-content content">
					<p>configured everything, copied /overlay and it is still mounted to tmp: <br /></p><div class="codebox"><pre><code>root@OpenWrt:~# ls -la /tmp/ | grep overlay
drwxr-xr-x    2 root     root            40 Jan  1  1970 overlay</code></pre></div><div class="codebox"><pre><code>root@OpenWrt:~# block info
/dev/mtdblock2: UUID=&quot;4057e985-d5377bc4-ed68f609-bf189eca&quot; VERSION=&quot;4.0&quot; TYPE=&quot;squashfs&quot;
/dev/mtdblock3: TYPE=&quot;jffs2&quot;
/dev/sda1: VERSION=&quot;2&quot; TYPE=&quot;swap&quot;
/dev/sda2: UUID=&quot;5b108ccb-3dd1-4df9-993b-f262411120bd&quot; NAME=&quot;EXT_JOURNAL&quot; VERSION=&quot;1.0&quot; TYPE=&quot;ext4&quot;</code></pre></div><div class="codebox"><pre><code>root@OpenWrt:~# block detect
config &#039;global&#039;
        option  anon_swap       &#039;0&#039;
        option  anon_mount      &#039;0&#039;
        option  auto_swap       &#039;1&#039;
        option  auto_mount      &#039;1&#039;
        option  delay_root      &#039;5&#039;
        option  check_fs        &#039;0&#039;

config &#039;swap&#039;
        option  device  &#039;/dev/sda1&#039;
        option  enabled &#039;0&#039;

config &#039;mount&#039;
        option  target  &#039;/mnt/sda2&#039;
        option  uuid    &#039;5b108ccb-3dd1-4df9-993b-f262411120bd&#039;
        option  enabled &#039;0&#039;</code></pre></div><div class="codebox"><pre><code>root@OpenWrt:~# cat /etc/config/fstab
config &#039;global&#039;
        option  anon_swap       &#039;0&#039;
        option  anon_mount      &#039;0&#039;
        option  auto_swap       &#039;1&#039;
        option  auto_mount      &#039;1&#039;
        option  delay_root      &#039;5&#039;
        option  check_fs        &#039;0&#039;

config &#039;swap&#039;
        option  device  &#039;/dev/sda1&#039;
        option  enabled &#039;1&#039;

config &#039;mount&#039;
        option  target  &#039;/overlay&#039;
        option  uuid    &#039;5b108ccb-3dd1-4df9-993b-f262411120bd&#039;
        option  enabled &#039;1&#039;</code></pre></div><div class="codebox"><pre><code>root@OpenWrt:~# df -h
Filesystem                Size      Used Available Use% Mounted on
rootfs                    1.1M   1004.0K     84.0K  92% /
/dev/root                 1.8M      1.8M         0 100% /rom
tmpfs                    14.1M     72.0K     14.1M   0% /tmp
/dev/mtdblock3            1.1M   1004.0K     84.0K  92% /overlay
overlayfs:/overlay        1.1M   1004.0K     84.0K  92% /
tmpfs                   512.0K         0    512.0K   0% /dev</code></pre></div><p>still in the logread<br /></p><div class="codebox"><pre><code>Thu Jan  1 00:00:35 1970 daemon.info sysinit: this file has been obseleted. please call &quot;/sbin/block mount&quot; directly
Thu Jan  1 00:00:35 1970 daemon.error netifd: wan (965): Sending select for 10.68.85.8...
Thu Jan  1 00:00:35 1970 daemon.error netifd: wan (965): Lease of 10.68.85.8 obtained, lease time 43200
Thu Jan  1 00:00:35 1970 daemon.info sysinit: /dev/mtdblock3 is already mounted</code></pre></div>											<p class="post-edited">(Last edited by <strong>gently</strong> on 31 Jul 2013, 16:42)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p208647">
				<div class="post-metadata">
					<div class="post-num">Post #119</div>
					<div class="post-author">gently</div>
					<div class="post-datetime">
						31 Jul 2013, 16:49					</div>
				</div>
				<div class="post-content content">
					<p>tried with root / - same results</p><div class="codebox"><pre><code>root@OpenWrt:~# cat /etc/config/fstab
config &#039;global&#039;
        option  anon_swap       &#039;0&#039;
        option  anon_mount      &#039;0&#039;
        option  auto_swap       &#039;1&#039;
        option  auto_mount      &#039;1&#039;
        option  delay_root      &#039;10&#039;
        option  check_fs        &#039;0&#039;

config &#039;swap&#039;
        option  device  &#039;/dev/sda1&#039;
        option  enabled &#039;1&#039;

config &#039;mount&#039;
        option  target  &#039;/&#039;
        option  uuid    &#039;5b108ccb-3dd1-4df9-993b-f262411120bd&#039;
        option  enabled &#039;1&#039;</code></pre></div><div class="codebox"><pre><code>root@OpenWrt:~# df -h
Filesystem                Size      Used Available Use% Mounted on
rootfs                    1.1M   1004.0K     84.0K  92% /
/dev/root                 1.8M      1.8M         0 100% /rom
tmpfs                    14.1M     76.0K     14.1M   1% /tmp
/dev/mtdblock3            1.1M   1004.0K     84.0K  92% /overlay
overlayfs:/overlay        1.1M   1004.0K     84.0K  92% /
tmpfs                   512.0K         0    512.0K   0% /dev</code></pre></div>											<p class="post-edited">(Last edited by <strong>gently</strong> on 31 Jul 2013, 16:50)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p208652">
				<div class="post-metadata">
					<div class="post-num">Post #120</div>
					<div class="post-author">djrh</div>
					<div class="post-datetime">
						31 Jul 2013, 17:28					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jow wrote:</cite><blockquote><p>Yes it is a bug that happens if the uuid string is longer than 32 bytes (the internal sprintf buffer to write it to the extroot tag file is only 32 byte large so the uuid is truncated and is detected as being invalid on the next boot).</p><p>Fixed with <a href="https://dev.openwrt.org/changeset/37623">https://dev.openwrt.org/changeset/37623</a> (<a href="http://nbd.name/gitweb.cgi?p=luci2/ubox.git;a=commit;h=21737b1ff2e0be28b68293c7ac198a8fe505cbc2">http://nbd.name/gitweb.cgi?p=luci2/ubox … 8fe505cbc2</a>)</p><p>As a temporary workaround one can do something like:<br /></p><div class="codebox"><pre><code>echo -n &quot;cebc1024-1f22-483e-b02c-8b111e79e9e1&quot; &gt; /etc/.extroot-uuid</code></pre></div></blockquote></div><br /><p>Ok,</p><p>This work, BUT !!! It only works if you do NOT copy the root files. When I copied the file from the root, it did NOT work. </p><p>When I formatted the partition WITHOUT copying the files, it worked fine.</p><p><strong><br />Now, WHY THE HECK I CANNOT INSTALL OPENVPN???<br /></strong></p><div class="codebox"><pre><code>root@OpenWrt:~# opkg install openvpn
Unknown package &#039;openvpn&#039;.
Collected errors:
 * opkg_install_cmd: Cannot install package openvpn.</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p208654">
				<div class="post-metadata">
					<div class="post-num">Post #121</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						31 Jul 2013, 17:50					</div>
				</div>
				<div class="post-content content">
					<p>There is no openvpn, install either openvpn-openssl or openvpn-nossl.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p208655">
				<div class="post-metadata">
					<div class="post-num">Post #122</div>
					<div class="post-author">djrh</div>
					<div class="post-datetime">
						31 Jul 2013, 18:14					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jow wrote:</cite><blockquote><p>There is no openvpn, install either openvpn-openssl or openvpn-nossl.</p></blockquote></div><p>Thanks, I was following an outdated how-to: <a href="http://wiki.openwrt.org/doc/howto/vpn.openvpn">http://wiki.openwrt.org/doc/howto/vpn.openvpn</a></p><p>I suppose there is NO Luci&nbsp; Openvpn add-in anymore?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p208720">
				<div class="post-metadata">
					<div class="post-num">Post #123</div>
					<div class="post-author">djrh</div>
					<div class="post-datetime">
						1 Aug 2013, 05:53					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jow wrote:</cite><blockquote><p>Yes it is a bug that happens if the uuid string is longer than 32 bytes (the internal sprintf buffer to write it to the extroot tag file is only 32 byte large so the uuid is truncated and is detected as being invalid on the next boot).</p><p>Fixed with <a href="https://dev.openwrt.org/changeset/37623">https://dev.openwrt.org/changeset/37623</a> (<a href="http://nbd.name/gitweb.cgi?p=luci2/ubox.git;a=commit;h=21737b1ff2e0be28b68293c7ac198a8fe505cbc2">http://nbd.name/gitweb.cgi?p=luci2/ubox … 8fe505cbc2</a>)</p><p>As a temporary workaround one can do something like:<br /></p><div class="codebox"><pre><code>echo -n &quot;cebc1024-1f22-483e-b02c-8b111e79e9e1&quot; &gt; /etc/.extroot-uuid</code></pre></div></blockquote></div><br /><p>GRRRRRR, NOT working. It only works if I reboot second time WITHOUT installing anything. The moment I install something and reboot, it can&#039;t overlay <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p208724">
				<div class="post-metadata">
					<div class="post-num">Post #124</div>
					<div class="post-author">djrh</div>
					<div class="post-datetime">
						1 Aug 2013, 07:22					</div>
				</div>
				<div class="post-content content">
					<p>So I decided to try with&nbsp; hard drive instead of USB key - same issue. Is it possible that the USB 1.1 and USB 2.0 drivers are in conflict?</p><div class="codebox"><pre><code>[    4.020000] usbcore: registered new interface driver usbfs
[    4.020000] usbcore: registered new interface driver hub
[    4.030000] usbcore: registered new device driver usb
[    4.200000] ehci_hcd: USB 2.0 &#039;Enhanced&#039; Host Controller (EHCI) Driver
[    4.210000] ehci-platform: EHCI generic platform driver
[    4.210000] ehci-platform ehci-platform: EHCI Host Controller
[    4.220000] ehci-platform ehci-platform: new USB bus registered, assigned bus number 1
[    4.230000] ehci-platform ehci-platform: irq 3, io mem 0x1b000000
[    4.250000] ehci-platform ehci-platform: USB 2.0 started, EHCI 1.00
[    4.250000] hub 1-0:1.0: USB hub found
[    4.260000] hub 1-0:1.0: 1 port detected
[    4.310000] ohci_hcd: USB 1.1 &#039;Open&#039; Host Controller (OHCI) Driver
[    4.670000] usb 1-1: new high-speed USB device number 2 using ehci-platform
[    4.820000] hub 1-1:1.0: USB hub found
[    4.820000] hub 1-1:1.0: 4 ports detected
[    5.110000] usb 1-1.2: new high-speed USB device number 3 using ehci-platform
[    6.470000] eth0: link up (1000Mbps/Full duplex)
[    7.960000] jffs2: notice: (365) jffs2_build_xattr_subsystem: complete building xattr subsystem, 1 of xdatum (1 unchecked, 0 orphan) and 14 of xref (0 dead, 0 orphan) found.
[    8.080000] SCSI subsystem initialized
[    8.500000] usb-storage 1-1.2:1.0: USB Mass Storage device detected
[    8.510000] scsi0 : usb-storage 1-1.2:1.0
[    8.520000] usbcore: registered new interface driver usb-storage
[    9.520000] scsi 0:0:0:0: Direct-Access     Initio   WD600VE-75HDT1   1.06 PQ: 0 ANSI: 0
[    9.530000] sd 0:0:0:0: [sda] 117210240 512-byte logical blocks: (60.0 GB/55.8 GiB)
[    9.540000] sd 0:0:0:0: [sda] Write Protect is off
[    9.540000] sd 0:0:0:0: [sda] Mode Sense: 23 00 00 00
[    9.540000] sd 0:0:0:0: [sda] No Caching mode page present
[    9.550000] sd 0:0:0:0: [sda] Assuming drive cache: write through
[    9.560000] sd 0:0:0:0: [sda] No Caching mode page present
[    9.560000] sd 0:0:0:0: [sda] Assuming drive cache: write through
[    9.620000]  sda: sda1
[    9.620000] sd 0:0:0:0: [sda] No Caching mode page present
[    9.630000] sd 0:0:0:0: [sda] Assuming drive cache: write through
[    9.640000] sd 0:0:0:0: [sda] Attached SCSI disk
[   13.810000] EXT4-fs (sda1): recovery complete
[   13.820000] EXT4-fs (sda1): mounted filesystem with ordered data mode. Opts: </code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p208726">
				<div class="post-metadata">
					<div class="post-num">Post #125</div>
					<div class="post-author">johan666</div>
					<div class="post-datetime">
						1 Aug 2013, 08:23					</div>
				</div>
				<div class="post-content content">
					<p>Mine is like that, pivot overlay working</p><div class="codebox"><pre><code>[    3.300000] sd 0:0:0:0: [sda] 2054144 512-byte logical blocks: (1.05 GB/1003 MiB)
[    3.310000] sd 0:0:0:0: [sda] Write Protect is off
[    3.310000] sd 0:0:0:0: [sda] Mode Sense: 0b 00 00 08
[    3.310000] sd 0:0:0:0: [sda] No Caching mode page present
[    3.320000] sd 0:0:0:0: [sda] Assuming drive cache: write through
[    3.330000] sd 0:0:0:0: [sda] No Caching mode page present
[    3.330000] sd 0:0:0:0: [sda] Assuming drive cache: write through
[    3.340000]  sda: sda1 sda2 sda3
[    3.340000] sd 0:0:0:0: [sda] No Caching mode page present
[    3.350000] sd 0:0:0:0: [sda] Assuming drive cache: write through
[    3.350000] sd 0:0:0:0: [sda] Attached SCSI removable disk
[    6.170000] eth0: link up (100Mbps/Full duplex)
[    7.250000] jffs2: notice: (347) jffs2_build_xattr_subsystem: complete building xattr subsystem, 20 of xdatum (0 unchecked, 20 orphan) and 30 of xref (0 dead, 30 orphan) found.
[    7.280000] EXT4-fs (sda1): warning: mounting unchecked fs, running e2fsck is recommended
[    7.290000] EXT4-fs (sda1): mounted filesystem without journal. Opts:</code></pre></div>									</div>
			</article>

			
		
						<div class="notice">
				<p>Sorry, posts 126 to 125 are missing from our archive.</p>
			</div>
		
		
	
	<div class="pagination"><div class="pagination-number">Page 5 of 9</div><nav><ul><li><a href="viewtopic.php%3Fid=44939&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=44939&amp;p=3.html">3</a></li><li><a href="viewtopic.php%3Fid=44939&amp;p=4.html">4</a></li><li class="pagination-current"><span>5</span></li><li><a href="viewtopic.php%3Fid=44939&amp;p=6.html">6</a></li><li><a href="viewtopic.php%3Fid=44939&amp;p=7.html">7</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=44939&amp;p=9.html">9</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0.001 -->

</body>
</html>