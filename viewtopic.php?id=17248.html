<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> WRT54GS v1 &gt;&gt; all mac addresses the same!</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 28 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p74432">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">curlynostrill</div>
					<div class="post-datetime">
						8 Oct 2008, 23:46					</div>
				</div>
				<div class="post-content content">
					<p>After much struggle and failed tftps I finally got rid of x-wrt (same problem: wrong port map) and got kamikaze on my WRT54GS V1.&nbsp; I had this same problem with dd-wrt.</p><p>All my ifaces have the same mac addresses and WAN gets no ip address.</p><div class="codebox"><pre><code>root@OpenWrt:~# ifconfig
br-lan    Link encap:Ethernet  HWaddr 00:12:17:xx:xx:DD
          inet addr:192.168.1.1  Bcast:192.168.1.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:138 errors:0 dropped:0 overruns:0 frame:0
          TX packets:87 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:11659 (11.3 KiB)  TX bytes:10484 (10.2 KiB)

eth0      Link encap:Ethernet  HWaddr 00:12:17:xx:xx:DD
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:314 errors:0 dropped:0 overruns:0 frame:0
          TX packets:225 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:27221 (26.5 KiB)  TX bytes:56818 (55.4 KiB)
          Interrupt:5

eth0.0    Link encap:Ethernet  HWaddr 00:12:17:xx:xx:DD
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:138 errors:0 dropped:0 overruns:0 frame:0
          TX packets:87 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:12211 (11.9 KiB)  TX bytes:10832 (10.5 KiB)

eth0.1    Link encap:Ethernet  HWaddr 00:12:17:xx:xx:DD
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:181 errors:0 dropped:0 overruns:0 frame:0
          TX packets:141 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:9854 (9.6 KiB)  TX bytes:45543 (44.4 KiB)

lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)</code></pre></div><p>I thought I&#039;m supposed to have: 00:12:17:xx:xx:<span class="bbu"><strong>DD</strong></span>, 00:12:17:xx:xx:<span class="bbu"><strong>DE</strong></span>, 00:12:17:xx:xx:<span class="bbu"><strong>DF</strong></span></p><p>I &quot;fixed&quot; the problem with the dd-wrt install by many resets and finally getting the original linksys firmware loaded which put everything right again.</p><p>Now, unfortunately, in my confusion I&#039;ve accidentally reflashed with an official 54G instead of 54GS firmware and can&#039;t get it to take anything else at all. <img src="https://forum.openwrt.org/img/smilies/roll.png" width="15" height="15" alt="roll" /> doh.&nbsp; Still trying though.&nbsp; It does work well with the wrong official firmware, though.</p>											<p class="post-edited">(Last edited by <strong>curlynostrill</strong> on 8 Oct 2008, 23:55)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p74434">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">MMCM</div>
					<div class="post-datetime">
						9 Oct 2008, 00:38					</div>
				</div>
				<div class="post-content content">
					<p>I think, everythings ok with all interfaces having the same MAC. All those interfaces are based on the same physical interface, either as a bridge (br-lan) or as a virtual interface (vlan). Since those interfaces are on different vlans, it&#039;s no problem to share the same MAC.<br />If you don&#039;t get an IP via DHCP on the WAN interface (eth0.1?), it may be necessary to assign the MAC address registered with your provider to that particular interface.<br />You could connect the WAN port to the LAN port of another router, to check if the DHCP client on the WAN port is working normally.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p74435">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">curlynostrill</div>
					<div class="post-datetime">
						9 Oct 2008, 01:01					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for the reply, MMCM<br /></p><div class="quotebox"><cite>MMCM wrote:</cite><blockquote><p>... You could connect the WAN port to the LAN port of another router, to check if the DHCP client on the WAN port is working normally.</p></blockquote></div><p>There&#039;s my dillema.&nbsp; I get some really strange behaviors.&nbsp; The WAN connects to my main router (pfsense) and when I connect a wire to the WRT&#039;s LAN with the WAN connected to pfsense my client gets an IP assigned by pfsense.&nbsp; At one point I took a shot in the dark and plugged the WAN cable into WRT&#039;s LAN-4 and the WRT correctly got it&#039;s WAN address from pfsense (10.1.1.50) and my client on WRT&#039;s LAN got it&#039;s appropriate address from WRT (192.168.1.x).</p><p>It seems to me somehow the default setup may be WRT54GL centric where the port mappings are (from my understanding) reversed or something from the old style.</p><p>I&#039;m confused.</p>											<p class="post-edited">(Last edited by <strong>curlynostrill</strong> on 9 Oct 2008, 01:02)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p74439">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">curlynostrill</div>
					<div class="post-datetime">
						9 Oct 2008, 07:22					</div>
				</div>
				<div class="post-content content">
					<p>ok, well I remedied my firmware lockout by editing the linksys *firmware54gs*.bin in <a href="http://notepad-plus.sourceforge.net/uk/site.htm">notepad++</a> changing the 4th character in the file </p><div class="codebox"><pre><code>W54S...(blah,unreadable)...</code></pre></div><p>to &#039;G&#039; like this </p><div class="codebox"><pre><code>W54G...(blah,unreadable)...</code></pre></div><p>so that the incorrect WRT54G firmware would think that the WRT54GS firmware was correct. The firmware took and I was in... whew.</p><p>Now, I loaded WhiteRussian resulting in the same condition where I only had one MAC ascribed to all IFs.&nbsp; I edited the static DHCP entry in my main firewall and the WRT WAN finally got the proper DHCP IP assigned.&nbsp; triple whew.</p><p>I just hope I don&#039;t have multiple DHCP servers on the same subnet now.</p><p>I&#039;m going to sleep for a few days now.</p><p>Thanks for the help.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p74442">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">phorn</div>
					<div class="post-datetime">
						9 Oct 2008, 08:52					</div>
				</div>
				<div class="post-content content">
					<p>In response to the original question, you can set a &quot;option hwaddr 00:xx:xx:xx:xx:xx&quot; for individual VLANS of an interface separately.</p><p>The only tricky part is the bridge--since you can set the hwaddr of an interface in the bridge, but the bridge itself can only have one single MAC address, and the MAC address the bridge has must be in one of its interfaces.</p><p>If you want to try it from the command line, run &quot;ifconfig eth0.1 hwaddr 00:11:22:33:44:55&quot; and it will change it just for eth0.1 while leaving eth0 alone.<br />I suspect this is what the original firmware did anyway.</p><p>But really it shouldn&#039;t matter if they have the same address, as long as they aren&#039;t both connected to the same computer or something weird.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p74481">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">curlynostrill</div>
					<div class="post-datetime">
						9 Oct 2008, 19:05					</div>
				</div>
				<div class="post-content content">
					<p>phorn: thank you, thank you, thank you for your informative input.&nbsp; That&#039;s exactly what I was looking for.</p><p>I&#039;ve now put x-wrt kamikaze on the box and it seems once the wireless is enabled a new mac address is created for the wlan-lan bridge.&nbsp; excellent.</p><p>thanks</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>