<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> TP-Link TL-WDR3600 (AR9344) overclocking</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 7 Apr 2018 and 19 Apr 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 3 of 3</div><nav><ul><li><a href="viewtopic.php%3Fid=44012&amp;p=1.html">1</a></li><li><a href="viewtopic.php%3Fid=44012&amp;p=2.html">2</a></li><li class="pagination-current"><span>3</span></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p211501">
				<div class="post-metadata">
					<div class="post-num">Post #51</div>
					<div class="post-author">headless.cross</div>
					<div class="post-datetime">
						3 Sep 2013, 12:16					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>pepe2k wrote:</cite><blockquote><p>It will be available later, because I&#039;m on my holidays.</p></blockquote></div><p>Have a nice time <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" />.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p213334">
				<div class="post-metadata">
					<div class="post-num">Post #52</div>
					<div class="post-author">Evgeniy1</div>
					<div class="post-datetime">
						27 Sep 2013, 23:29					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>pepe2k wrote:</cite><blockquote><div class="quotebox"><cite>headless.cross wrote:</cite><blockquote><p> is OC available for AR9344?</p></blockquote></div><p>It will be available later, because I&#039;m on my holidays.</p></blockquote></div><p>When you planning publish OC code ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p213484">
				<div class="post-metadata">
					<div class="post-num">Post #53</div>
					<div class="post-author">pepe2k</div>
					<div class="post-datetime">
						29 Sep 2013, 22:13					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Evgeniy1 wrote:</cite><blockquote><div class="quotebox"><cite>pepe2k wrote:</cite><blockquote><div class="quotebox"><cite>headless.cross wrote:</cite><blockquote><p> is OC available for AR9344?</p></blockquote></div><p>It will be available later, because I&#039;m on my holidays.</p></blockquote></div><p>When you planning publish OC code ?</p></blockquote></div><p>Here is my current to-do list, regarding to my U-Boot mod project:</p><p>1. O/C recovery mode and more O/C profiles for AR9331 (also for underclocking).<br />2. AR9341 support (MR3420v2 etc.).<br />3. O/C recovery mode and O/C profiles for AR9344/AR9341.<br />4. Solution for OFW kernel loading bug.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p219058">
				<div class="post-metadata">
					<div class="post-num">Post #54</div>
					<div class="post-author">Dioptimizer</div>
					<div class="post-datetime">
						3 Dec 2013, 00:55					</div>
				</div>
				<div class="post-content content">
					<p><a href="http://Censored">Censored</a><br />datasheet</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p219060">
				<div class="post-metadata">
					<div class="post-num">Post #55</div>
					<div class="post-author">pepe2k</div>
					<div class="post-datetime">
						3 Dec 2013, 01:16					</div>
				</div>
				<div class="post-content content">
					<p>Great! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />Did you find also datasheet for AR9341?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p219148">
				<div class="post-metadata">
					<div class="post-num">Post #56</div>
					<div class="post-author">Dioptimizer</div>
					<div class="post-datetime">
						4 Dec 2013, 07:00					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>pepe2k wrote:</cite><blockquote><p>Great! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />Did you find also datasheet for AR9341?</p></blockquote></div><p>No, I have not found it.</p><p>Unless we have significant differences in architecture?<br />There is a press release of these two processors (AR9341 / AR9344) - so that we could compare its characteristics?</p><br /><p>P.S.<br />By the way, can someone help and show me: what the answer openwrt-console (on ar9344 and/or ar9331 device of course) with following commands?<br /></p><div class="quotebox"><blockquote><p>ls /sys/bus/platform/drivers/ar933x-uart/</p></blockquote></div><div class="quotebox"><blockquote><p>ls /sys/bus/platform/drivers/serial8250/</p></blockquote></div><p>Thanks anyway.</p>											<p class="post-edited">(Last edited by <strong>Dioptimizer</strong> on 4 Dec 2013, 07:11)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p219172">
				<div class="post-metadata">
					<div class="post-num">Post #57</div>
					<div class="post-author">alphasparc</div>
					<div class="post-datetime">
						4 Dec 2013, 13:42					</div>
				</div>
				<div class="post-content content">
					<p>root@OpenWrt:/# ls /sys/bus/platform/drivers/serial8250/<br />bind&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; serial8250&nbsp; &nbsp; serial8250.0&nbsp; uevent&nbsp; &nbsp; &nbsp; &nbsp; unbind</p><p>root@OpenWrt:/# ls /sys/bus/platform/drivers/ar933x-uart/<br />ar933x-uart&nbsp; bind&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;uevent&nbsp; &nbsp; &nbsp; &nbsp;unbind</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p220621">
				<div class="post-metadata">
					<div class="post-num">Post #58</div>
					<div class="post-author">Evgeniy1</div>
					<div class="post-datetime">
						22 Dec 2013, 15:58					</div>
				</div>
				<div class="post-content content">
					<p>Any news about OC for 9344 ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p220622">
				<div class="post-metadata">
					<div class="post-num">Post #59</div>
					<div class="post-author">pepe2k</div>
					<div class="post-datetime">
						22 Dec 2013, 16:45					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Evgeniy1 wrote:</cite><blockquote><p>Any news about OC for 9344 ?</p></blockquote></div><p>The project is currently at the highlighted stage <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>1. O/C recovery mode and more O/C profiles for AR9331 (also for underclocking).<br /><strong>2. AR9341 support (MR3420v2 etc.).</strong><br />3. O/C recovery mode and O/C profiles for AR9344/AR9341.<br />4. Solution for OFW kernel loading bug.<br />5. QCA955x support.</p><p>Overclocking for AR9331 platform is already done, I&#039;m working on the AR9341 support (WR841Nv8 is working, but I need to make some changes in network driver). After that, I am going to rebuild PLL initialization for AR934x (currently it is based on SRIF which isn&#039;t documented) and add options to save and load all PLL configuration registers to/from FLASH (like for AR9331).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p222389">
				<div class="post-metadata">
					<div class="post-num">Post #60</div>
					<div class="post-author">alphasparc</div>
					<div class="post-datetime">
						11 Jan 2014, 10:47					</div>
				</div>
				<div class="post-content content">
					<p>Hi pepe2k I faced the following issue.<br />I upgrade the flash to 16MB Winbond Chip and compiled the code using GCC 4.6. openwrt toolchain.<br />Occasionally it will boot occasionally it will not boot, especially from a cold boot.<br />Do you face a similar issue?<br />I check the RAM which I also upgraded to 64MB using memtester so that should not be an issue.<br />I forgot to mention my machine is MR3420v2 HW V 2.2.</p>											<p class="post-edited">(Last edited by <strong>alphasparc</strong> on 11 Jan 2014, 10:50)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p222402">
				<div class="post-metadata">
					<div class="post-num">Post #61</div>
					<div class="post-author">pepe2k</div>
					<div class="post-datetime">
						11 Jan 2014, 13:11					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>alphasparc wrote:</cite><blockquote><p>Hi pepe2k I faced the following issue.<br />I upgrade the flash to 16MB Winbond Chip and compiled the code using GCC 4.6. openwrt toolchain.<br />Occasionally it will boot occasionally it will not boot, especially from a cold boot.<br />Do you face a similar issue?<br />I check the RAM which I also upgraded to 64MB using memtester so that should not be an issue.<br />I forgot to mention my machine is MR3420v2 HW V 2.2.</p></blockquote></div><p>Hi alphasparc, can you post an output/bootlog from UART console?<br />Or maybe you already know which stage it hangs at?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p222405">
				<div class="post-metadata">
					<div class="post-num">Post #62</div>
					<div class="post-author">alphasparc</div>
					<div class="post-datetime">
						11 Jan 2014, 13:52					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>pepe2k wrote:</cite><blockquote><div class="quotebox"><cite>alphasparc wrote:</cite><blockquote><p>Hi pepe2k I faced the following issue.<br />I upgrade the flash to 16MB Winbond Chip and compiled the code using GCC 4.6. openwrt toolchain.<br />Occasionally it will boot occasionally it will not boot, especially from a cold boot.<br />Do you face a similar issue?<br />I check the RAM which I also upgraded to 64MB using memtester so that should not be an issue.<br />I forgot to mention my machine is MR3420v2 HW V 2.2.</p></blockquote></div><p>Hi alphasparc, can you post an output/bootlog from UART console?<br />Or maybe you already know which stage it hangs at?</p></blockquote></div><p>I only have access to serial console the problem is that if it boots it boots successfully otherwise it hangs.<br />I can&#039;t get any output from the serial consoles if it fails.</p><p>When it boots successfully<br />1)All the LED lights up then only power LED Remains lighted<br />When it fails <br />1)Only Power LED lights up and remains lighted up indefinitely.(Hang no output at all)</p>											<p class="post-edited">(Last edited by <strong>alphasparc</strong> on 11 Jan 2014, 13:53)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p222409">
				<div class="post-metadata">
					<div class="post-num">Post #63</div>
					<div class="post-author">pepe2k</div>
					<div class="post-datetime">
						11 Jan 2014, 14:23					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>alphasparc wrote:</cite><blockquote><p>I only have access to serial console the problem is that if it boots it boots successfully otherwise it hangs.<br />I can&#039;t get any output from the serial consoles if it fails.</p><p>When it boots successfully<br />1)All the LED lights up then only power LED Remains lighted<br />When it fails <br />1)Only Power LED lights up and remains lighted up indefinitely.(Hang no output at all)</p></blockquote></div><p>It seems to be a serious problem. I don&#039;t have now any MR3420v2, only WR841Nv8 (but it&#039;s almost the same hardware, so I&#039;m able to make some tests).</p><p>I changed behavior of the LEDs for this model. In original TP-Link U-Boot version, the LEDs are turned on from the beginning and turned off later. In my modification, LEDs are turned off earlier (before low level initialization) and then lights up during network initialization. So, I think that in your case, the device hangs somewhere in low level initialization - maybe there is a problem with PLL and clocks, because I haven&#039;t yet checked and rewritten it.</p><p>I suppose that this problem doesn&#039;t exist with default U-Boot from original TP-Link&#039;s firmware (have you checked that)?<br />Please, try this version (<a href="http://www.tech-blog.pl/pliki/u-boot_mod_mr3420v2.rar">http://www.tech-blog.pl/pliki/u-boot_mod_mr3420v2.rar</a>) and let me know if it helped.</p><p>Could also read full mark from your AR9341? For example, on my WR841Nv8 I have AR9341-AL1A, but I have seen already different, probably newer, revisions.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p222410">
				<div class="post-metadata">
					<div class="post-num">Post #64</div>
					<div class="post-author">alphasparc</div>
					<div class="post-datetime">
						11 Jan 2014, 14:28					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>pepe2k wrote:</cite><blockquote><p>It seems to be a serious problem. I don&#039;t have now any MR3420v2, only WR841Nv8 (but it&#039;s almost the same hardware, so I&#039;m able to make some tests).</p><p>I changed behavior of the LEDs for this model. In original TP-Link U-Boot version, the LEDs are turned on from the beginning and turned off later. In my modification, LEDs are turned off earlier (before low level initialization) and then lights up during network initialization. So, I think that in your case, the device hangs somewhere in low level initialization - maybe there is a problem with PLL and clocks, because I haven&#039;t yet checked and rewritten it.</p><p>I suppose that this problem doesn&#039;t exist with default U-Boot from original TP-Link&#039;s firmware (have you checked that)?<br />Please, try this version (<a href="http://www.tech-blog.pl/pliki/u-boot_mod_mr3420v2.rar">http://www.tech-blog.pl/pliki/u-boot_mod_mr3420v2.rar</a>) and let me know if it helped.</p><p>Could also read full mark from your AR9341? For example, on my WR841Nv8 I have AR9341-AL1A, but I have seen already different, probably newer, revisions.</p></blockquote></div><p>I checked my cpu revision is the same AR9341-AL1A<br />I will be testing your uboot will be back with replies soon.</p><p>I downloaded and tested your version.<br />Works Perfect 100% successful boot.<br />Now I am puzzled, is it the compiler?</p><p>I uploaded the source <a href="https://www.mediafire.com/?40qhh7trfs0zf09">here</a><br />Btw great job!</p>											<p class="post-edited">(Last edited by <strong>alphasparc</strong> on 11 Jan 2014, 18:03)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p222418">
				<div class="post-metadata">
					<div class="post-num">Post #65</div>
					<div class="post-author">pepe2k</div>
					<div class="post-datetime">
						11 Jan 2014, 15:45					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>alphasparc wrote:</cite><blockquote><p>I downloaded and tested your version.<br />Works Perfect 100% successful boot.<br />Now I am puzzled, is it the compiler?</p></blockquote></div><p>Compiler, linker... I don&#039;t know.</p><p>To be sure in 100% that it works, please make more tests. And, if you can, send me please your binary image and any changes which you have made in sources (in Makefile, I suppose).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p224978">
				<div class="post-metadata">
					<div class="post-num">Post #66</div>
					<div class="post-author">snowrice</div>
					<div class="post-datetime">
						10 Feb 2014, 11:13					</div>
				</div>
				<div class="post-content content">
					<p>any update of AR9344 OC profile? Thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p224979">
				<div class="post-metadata">
					<div class="post-num">Post #67</div>
					<div class="post-author">pepe2k</div>
					<div class="post-datetime">
						10 Feb 2014, 11:21					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>snowrice wrote:</cite><blockquote><p>any update of AR9344 OC profile? Thanks</p></blockquote></div><p>Working on that.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p243101">
				<div class="post-metadata">
					<div class="post-num">Post #68</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						7 Aug 2014, 15:08					</div>
				</div>
				<div class="post-content content">
					<p>How&#039;s the work going? <img src="https://forum.openwrt.org/img/smilies/tongue.png" width="15" height="15" alt="tongue" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p245598">
				<div class="post-metadata">
					<div class="post-num">Post #69</div>
					<div class="post-author">idaniel</div>
					<div class="post-datetime">
						1 Sep 2014, 13:29					</div>
				</div>
				<div class="post-content content">
					<p>I saw from the tests that 780/480/240 is a stable setting and I want to try it out. However I did not see in the source files any define for 780/480/240, how do you set it ? Many thanks.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p245609">
				<div class="post-metadata">
					<div class="post-num">Post #70</div>
					<div class="post-author">alphasparc</div>
					<div class="post-datetime">
						1 Sep 2014, 14:34					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>idaniel wrote:</cite><blockquote><p>I saw from the tests that 780/480/240 is a stable setting and I want to try it out. However I did not see in the source files any define for 780/480/240, how do you set it ? Many thanks.</p></blockquote></div><p>Btw 780 is not stable for me only 700 is.<br />Take a look here.<br />u-boot/board/ar7240/common/lowlevel_init_934x.S<br /></p><div class="codebox"><pre><code>#if !defined(CONFIG_AP123)
/*    refdiv    nint    nfrac */
li    t4,    ((0x8 &lt;&lt; 27) | (112 &lt;&lt; 18) | 0);// cpu freq = (40 MHz refclk/refdiv 8) * Nint
li    t5,    ((0x8 &lt;&lt; 27) | (90 &lt;&lt; 18) | 0);    // ddr freq = (40 MHz refclk/refdiv 8) * Nint
j    2f
nop
1:
li    t4,    ((0x5 &lt;&lt; 27) | (112 &lt;&lt; 18) | 0);// cpu freq = (25 MHz refclk/refdiv 5) * Nint
li    t5,    ((0x5 &lt;&lt; 27) | (90 &lt;&lt; 18) | 0);    // ddr freq = (25 MHz refclk/refdiv 5) * Nint
j    2f
nop
#else /* defined(CONFIG_AP123) */
/*    refdiv    nint    nfrac */
li    t4,    ((0x8 &lt;&lt; 27) | (107 &lt;&lt; 18) | 0);// cpu freq = (40 MHz refclk/refdiv 8) * Nint
li    t5,    ((0x8 &lt;&lt; 27) | (160 &lt;&lt; 18) | 0);// ddr freq = (40 MHz refclk/refdiv 8) * Nint
j    2f
nop
1:
li    t4,    ((0x5 &lt;&lt; 27) | (107 &lt;&lt; 18) | 0);// cpu freq = (25 MHz refclk/refdiv 5) * Nint
li    t5,    ((0x5 &lt;&lt; 27) | (160 &lt;&lt; 18) | 0);// ddr freq = (25 MHz refclk/refdiv 5) * Nint
j    2f
nop
#endif /* !defined(CONFIG_AP123) */</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p252877">
				<div class="post-metadata">
					<div class="post-num">Post #71</div>
					<div class="post-author">mowgli80</div>
					<div class="post-datetime">
						2 Nov 2014, 20:16					</div>
				</div>
				<div class="post-content content">
					<p>I am able to compile firmware from GIT. Now how do I modify the above code to overclock?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p252915">
				<div class="post-metadata">
					<div class="post-num">Post #72</div>
					<div class="post-author">carrapato</div>
					<div class="post-datetime">
						3 Nov 2014, 06:27					</div>
				</div>
				<div class="post-content content">
					<p>Is it possible to write to registers during standard U-boot console, in a unmodified platform? </p><p>I.e: </p><p>1&gt;I tap into U-boot menu, from serial console of a ar9344 based thing<br />2&gt;write to the registers from command line<br />3&gt; call kernel entry point, and let device boot</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 3 of 3</div><nav><ul><li><a href="viewtopic.php%3Fid=44012&amp;p=1.html">1</a></li><li><a href="viewtopic.php%3Fid=44012&amp;p=2.html">2</a></li><li class="pagination-current"><span>3</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>