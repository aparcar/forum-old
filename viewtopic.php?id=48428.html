<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> LG FM 300 LTE Router</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 28 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p222730">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">neerd</div>
					<div class="post-datetime">
						14 Jan 2014, 19:09					</div>
				</div>
				<div class="post-content content">
					<p>I own a LG FM 300 LTE Router with an old Firmware (from Vodafone) and the FW update (with the easybox) didn&#039;t work.<br />While searching the web for a solution I found the Service Manual from LG (<a href="http://www.cpkb.org/wiki/LG_FM300_service_manual">http://www.cpkb.org/wiki/LG_FM300_service_manual</a>).</p><p>It shows that the LG has a BCM5358U @ 533 MHz with Integrated 2.4 GHz radio, USB Host,...<br />256 MB RAM, N25Q128 is a 128 Mbit (16Mb x 8) serial Flash memory and L2000 LTE Modem (connected via pci-express?)</p><p>In the firmware binary from VF (<a href="http://media.vodafone.de/www/assets/software/FM300-00-V11f02-262-02-APR-13-2013.bin">http://media.vodafone.de/www/assets/sof … 3-2013.bin</a>) i couldn&#039;t find any uboot or linux strings (<a href="http://www.devttys0.com/2011/05/reverse-engineering-firmware-linksys-wag120n/">http://www.devttys0.com/2011/05/reverse … s-wag120n/</a>) ...</p><p>Is it possible to get this device woking with openwrt as (cheap) standalone LTE router?</p><p>Or is there another possibility to flash this device? On the VF Forum (<a href="https://forum.vodafone.de/t5/LTE-Hardware/Dual-WAN/td-p/122287/page/2">https://forum.vodafone.de/t5/LTE-Hardwa … 287/page/2</a>) somebody stated that he had connect his PC with a gender-changer to the USB-Hostport and got a Hello (shell?).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p243978">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">shaap</div>
					<div class="post-datetime">
						15 Aug 2014, 19:39					</div>
				</div>
				<div class="post-content content">
					<p>I managed to get OpenWRT running on that device. You need to patch the kernel, as it is not able to detect the serial flash otherwise. I will uplaod the patch during the next days. Flashing works via CFE, either via tftp or via miniCFE Webserver. The Mini-USB port hidden under the case is in fact not USB but TTL serial port. You need a 3.3 V level shifter and can then connect it to RS232. Everything on the board works, except for the LTE miniPCIE card, for which I was not able to get the matching ethernet driver (TTY driver is gdm724x from staging, only needs VID/PID patching).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p244049">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">neerd</div>
					<div class="post-datetime">
						16 Aug 2014, 20:15					</div>
				</div>
				<div class="post-content content">
					<p>Sounds great. Any ideas to get the LTE Modem working? What do we need to get this working.&nbsp; </p><p>Found a open source Homepage from LG with a request form for source code.&nbsp; <a href="https://www.lg.com/global/support/opensource/opensourceList?superOsCategoryId=CAT00000001&amp;osCategoryId=CAT00000002">https://www.lg.com/global/support/opens … AT00000002</a></p><p>I have two FM 300. I could try to sniff the uart traffic?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p263871">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Oekel</div>
					<div class="post-datetime">
						2 Feb 2015, 18:18					</div>
				</div>
				<div class="post-content content">
					<p>Anything new to this problem?<br />Searching for a alternative LTE-Modem to use wit Deutsche Telekom. But Huawei only produces Router and no stand alone modems.&nbsp; I hoped to do that with the LG FM300</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p287703">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">passero</div>
					<div class="post-datetime">
						15 Aug 2015, 18:08					</div>
				</div>
				<div class="post-content content">
					<p>Any news? I mean, there&#039;s a way to use LG FM300 with OpenWrt or without attach it to Easybox?<br />Thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p315815">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">att15</div>
					<div class="post-datetime">
						20 Mar 2016, 13:08					</div>
				</div>
				<div class="post-content content">
					<p>Hi shaap,</p><p>do you have uploaded the patch or the whole image for flashing?</p><p>Would be nice If you&#039;d do so...</p><p>Thanks a lot!</p><p>Cheers,</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p330006">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">rAndy</div>
					<div class="post-datetime">
						28 Jun 2016, 08:10					</div>
				</div>
				<div class="post-content content">
					<p>Basically, the patch below is enough to let it boot, but there&#039;s some things to be fixed:</p><p>call to bcma_sflash_cmd(cc, BCMA_CC_FLASHCTL_ST_RES) in driver_chipcommon_sflash.c:bcma_sflash_init() always returns 0xff either with &#039;bcma_cc_write32(cc, BCMA_CC_FLASHADDR, 0)&#039; or with &#039;bcma_cc_write32(cc, BCMA_CC_FLASHADDR, 1)&#039;,&nbsp; so i don&#039;t know atm if the value is really 0xff or the cmd is just doing nothing (and one should try SRES instead); that&#039;s why the new entry is located at 0xff in the patch</p><p>numblocks is limited to 128, giving 8Mb flash size instead of 16; this is meant to be so, as the partition layout could be wrong (it is, actually), so one doesn&#039;t risk to overwrite nvram (located at the end of flash); partitions layout is still to be fixed</p><p>wireless isn&#039;t correctly recognized</p><br /><p>i&#039;m looking into it; for the impatient / anyone willing too to port this board, have a try:</p><div class="codebox"><pre><code>diff --git a/drivers/bcma/driver_chipcommon_sflash.c b/drivers/bcma/driver_chipcommon_sflash.c
index 35b13a0..eca01ab 100644
--- a/drivers/bcma/driver_chipcommon_sflash.c
+++ b/drivers/bcma/driver_chipcommon_sflash.c
@@ -39,6 +39,7 @@ static const struct bcma_sflash_tbl_e bcma_sflash_st_tbl[] = {
        { &quot;M25P64&quot;, 0x16, 0x10000, 128, },
        { &quot;M25FL128&quot;, 0x17, 0x10000, 256, },
        { &quot;MX25L25635F&quot;, 0x18, 0x10000, 512, },
+       { &quot;N25Q128&quot;, 0xff, 0x10000, 128, },
        { NULL },
 };
 </code></pre></div>											<p class="post-edited">(Last edited by <strong>rAndy</strong> on 28 Jun 2016, 09:44)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p330011">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">rAndy</div>
					<div class="post-datetime">
						28 Jun 2016, 11:45					</div>
				</div>
				<div class="post-content content">
					<p>ok, wrong partition layout was due to my &#039;conservative&#039; approach not to pass whole flash size, so nvram couldn&#039;t be found (it&#039;s at the very end); using </p><div class="codebox"><pre><code>diff --git a/drivers/bcma/driver_chipcommon_sflash.c b/drivers/bcma/driver_chipcommon_sflash.c
index 35b13a0..eca01ab 100644
--- a/drivers/bcma/driver_chipcommon_sflash.c
+++ b/drivers/bcma/driver_chipcommon_sflash.c
@@ -39,6 +39,7 @@ static const struct bcma_sflash_tbl_e bcma_sflash_st_tbl[] = {
        { &quot;M25P64&quot;, 0x16, 0x10000, 128, },
        { &quot;M25FL128&quot;, 0x17, 0x10000, 256, },
        { &quot;MX25L25635F&quot;, 0x18, 0x10000, 512, },
+       { &quot;N25Q128&quot;, 0xff, 0x10000, 256, },
        { NULL },
 };
 </code></pre></div><p>produces in dmesg</p><div class="quotebox"><blockquote><p>[&nbsp; &nbsp; 0.810000] Creating 10 MTD partitions on &quot;bcm47xxsflash&quot;:<br />[&nbsp; &nbsp; 0.810000] 0x000000000000-0x000000020000 : &quot;boot&quot;<br />[&nbsp; &nbsp; 0.820000] 0x000000020000-0x00000002001c : &quot;firmware&quot;<br />[&nbsp; &nbsp; 0.830000] 0x00000002001c-0x00000002090c : &quot;loader&quot;<br />[&nbsp; &nbsp; 0.830000] 0x00000002090c-0x000000138800 : &quot;linux&quot;<br />[&nbsp; &nbsp; 0.840000] 0x000000138800-0x000000c00000 : &quot;rootfs&quot;<br />[&nbsp; &nbsp; 0.850000] mtd: device 4 (rootfs) set to be root filesystem<br />[&nbsp; &nbsp; 0.850000] 1 squashfs-split partitions found on MTD device rootfs<br />[&nbsp; &nbsp; 0.860000] 0x000000360000-0x000000c00000 : &quot;rootfs_data&quot;<br />[&nbsp; &nbsp; 0.870000] 0x000000c00000-0x000000fe0000 : &quot;firmware&quot;<br />[&nbsp; &nbsp; 0.870000] 0x000000c0001c-0x000000d6aec4 : &quot;linux&quot;<br />[&nbsp; &nbsp; 0.880000] 0x000000d6aec4-0x000000fe0000 : &quot;rootfs&quot;<br />[&nbsp; &nbsp; 0.890000] 0x000000fe0000-0x000000ff0000 : &quot;nvram&quot;<br />[&nbsp; &nbsp; 0.890000] 0x000000ff0000-0x000001000000 : &quot;nvram&quot;</p></blockquote></div><p>which is close to the original firmware dmesg</p><div class="quotebox"><blockquote><p>Creating 9 MTD partitions on &quot;sflash&quot;:<br />0x00000000-0x00020000 : &quot;boot&quot;<br />0x00020000-0x00400000 : &quot;linux&quot;<br />0x0018aec4-0x00400000 : &quot;rootfs&quot;<br />0x00400000-0x00c00000 : &quot;dummy&quot;<br />0x00c00000-0x00f00000 : &quot;linux1&quot;<br />0x00d6aec4-0x00f00000 : &quot;rootfs1&quot;<br />0x00f00000-0x00fe0000 : &quot;nvbackup&quot;<br />0x00fe0000-0x00ff0000 : &quot;nvram1&quot;<br />0x00ff0000-0x01000000 : &quot;nvram&quot;</p></blockquote></div><p>actually, there&#039;s 11 partitions, last two are nvrams</p><p>The original layout foresees another kernel+rootfs (linux1, rootfs1), so we got nearly 4Mb flash unused<br />code; bcm47xxpart.c goes scanning flash looking for magics, maybe by resetting first bytes of those we can get that space back</p><p>another point is letting &quot;nvbackup&quot; partition be recognized (offsetting tail of second &quot;rootfs&quot; partition, looks like):<br /></p><div class="quotebox"><blockquote><p>00000000&nbsp; 4c 45 4e 56 e0 e2 00 00&nbsp; 01 00 00 00 60 06 01 00&nbsp; |LENV........`...|</p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333638">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">rAndy</div>
					<div class="post-datetime">
						8 Aug 2016, 13:26					</div>
				</div>
				<div class="post-content content">
					<p>Oh boy, this was a bad trip... Days to diggin into gpl broadcom tarball&nbsp; (http://opensource.lge.com/osSch/list?types=ALL&amp;search=fm300 , then download zip file) to find out, their own lzma version has harcoded params</p><p>Without using included lzma and trx (they&#039;re i386 binaries) the system boots once and the no more</p><p>i guess it could work with openwrt lzma version (4.65 at the time of writing) with following parameters: &#039;-eos -d24 -fb32 -mc16&#039;, i haven&#039;t tested it at the moment;</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>