<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> porting from x86 to mips(mikrotik routerboard 433)</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 12 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p148471">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">pro_processor</div>
					<div class="post-datetime">
						14 Nov 2011, 19:17					</div>
				</div>
				<div class="post-content content">
					<p>Hi.<br />I have a server application that runs on my hardware that have x86, successfully.</p><p>I want to port it to mikrotik routerboard 433.<br />I have cross compiled the application well and loaded the binary to the routerboard.<br />however the application does not run successfully.<br />i traced with strace and the application runs well until some place and then it fails.</p><p>I will copy the strace outputs from the succesfull x86 device and the routerboard, and the comparison shows the differences.</p><p>This part is from the device that have x86</p><p>open(&quot;/opt/labris/etc/labris-lmc/lmc.conf&quot;, O_RDONLY|O_LARGEFILE) = 4<br />read(4, &quot;# \n# Global Settings\n#\n\n[global]\n# Bind interface\n# This<br />option is mandatory. LMC daemon will accepts connections \n# coming to<br />this interface only. It is usually set to host&#039;s external\n#<br />interface.\n#bind = eth0\n\n# maximum number of connection count\nccount<br />&quot;..., 8191) = 4269<br />read(4, &quot;&quot;, 8191)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />close(4)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />clone(Process 4626 attached<br />child_stack=0, flags=CLONE_CHILD_CLEARTID|CLONE_CHILD_SETTID|SIGCHLD,<br />child_tidptr=0xb7f2d728) = 4626<br />[pid&nbsp; 4625] exit_group(0)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = ?<br />setsid()&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 4626<br />chdir(&quot;/&quot;)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />open(&quot;/dev/null&quot;, O_RDWR)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 4<br />fstat64(4, {st_mode=S_IFCHR|0666, st_rdev=makedev(1, 3), ...}) = 0<br />dup2(4, 0)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />dup2(4, 1)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 1<br />dup2(4, 2)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 2<br />close(4)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0</p><p>As seen, the app. opens and reads the file (&quot;/opt/labris/etc/labris-lmc/lmc.conf takes the number of the bytes and then close the file.<br />It is what I want.</p><p>However in the application that I use routerboard,<br />open(&quot;/opt/labris/etc/labris-lmc/lmc.conf&quot;, O_RDONLY) = 4<br />ioctl(4, TIOCNXCL, 0x7faa64a8)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = -1 ENOTTY (Inappropriate ioctl<br />for device)<br />brk(0x479000)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0x479000<br />_llseek(4, 0, [0], SEEK_SET)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;# \n# Global Settings\n#\n\n[global]&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;\n# Bind interface\n# This option &quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;is mandatory. LMC daemon will ac&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;cepts connections \n# coming to t&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;his interface only. It is usuall&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;y set to host&#039;s external\n# inter&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;face.\nbind = eth0\n\n# maximum num&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;ber of connection count\nccount =&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot; 100\n\n# Port\n# LMC daemon will l&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;isten to this port. Default is 4&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;000.\nport = 4000\n\n# enable sessi&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />brk(0x47a000)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0x47a000<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;ons\nsessions_enabled = 0\n\n# keep&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;alive: set it to 1 to check if c&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;onnection is up\nkeepalive = 1\n\n#&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot; keepidle: interval (in seconds)&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot; between subsequential keepalive&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot; probes, \n# regardless of what t&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;he connection has exchanged in t&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;he meantime\n# NOTE: 30 is for CC&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot; mode\nkeepidle = 30\n\n# the inter&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;val between the last data packet&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot; sent (simple ACKs \n# are not co&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;nsidered data) and the first kee&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;palive probe \n# NOTE: 3 is for C&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;C mode\nkeepintvl = 3\n\n# the numb&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;er of unacknowledged probes to s&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;end before considering the \n# co&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;nnection dead and notifying the &quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;application layer\n# NOTE: 5 is f&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;or CC mode\nkeepcnt = 5\n\n# SSL Se&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;ttings\n# SSL certificate of LMC &quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;daemon\nssl_cert = /opt/labris/et&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;c/labris-lmc/certs/server.crt\n\n#&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot; SSL private key of LMC daemon.\n&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;#ssl_key = ../certs/testkey-2004&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;.pem\nssl_key = /opt/labris/etc/l&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;abris-lmc/certs/server.key\n\n# Us&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;ers database path.\nusers = /opt/&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;labris/etc/labris-lmc/users.lst\n&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;\n# Users ACL database path.\nacl &quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;= /opt/labris/etc/labris-lmc/use&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;rs.acl\n\n# Plugin (module) direct&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;ory. .SO files are loaded in thi&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;s\n# directory will be loaded.\npl&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;ugin_dir = /opt/labris/lib/labri&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;s-lmc/modules\n\n# Authentication &quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;module.\nauthmod_dir = /opt/labri&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;s/lib/labris-lmc/auth\n\n\n# Firewa&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;ll Module Settings #############&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;####################\n[firewall]\n&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;log_file = /var/log/messages\nflu&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;sh_conntrack = no\nmax_policies =&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot; 20\nmax_backups = 200\nmax_object&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;s = 1000\nmax_rules = 300\n\n\n# LMC&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot; Module Settings ###############&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;#######################\n[lmc]\nau&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;th = password\ndhcpd_init = /etc/&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;init.d/dhcpd\ndhcpd_daemon = /usr&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;/sbin/dhcpd\nnamed_init = /etc/in&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;it.d/named\nnamed_daemon = /usr/s&quot;, 32) = 32<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />read(4, &quot;bin/named\n\n&quot;, 32)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 11<br />read(4, &quot;&quot;, 21)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY|O_NONBLOCK) = 0<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0<br />fcntl64(4, F_GETFL)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0 (flags O_RDONLY)<br />fcntl64(4, F_SETFL, O_RDONLY)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0</p><p>It opens the file open(&quot;/opt/labris/etc/labris-lmc/lmc.conf&quot;,&nbsp; but it reads the file line by line.I dont care this because it reads the file and the fcntl64 works continiously.IT is not problem for me , cause the file is read. but after the last 2 lines of the file&nbsp; (read(4, &quot;bin/named\n\n&quot;, 32)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 11), read(4, &quot;&quot;, 21)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0),&nbsp; &nbsp; the fcntl64 continiues working and it enters to an infinite loop.What is the problem ? Is it a problem that is related with fcntl64 func of uclibc.?</p><p>Thanks for help<br />Good luck</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p148473">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						14 Nov 2011, 19:20					</div>
				</div>
				<div class="post-content content">
					<p>This looks more like as if the termination condition of the read loop in your application is wrong. It might work fine on glibc due to slightly different stdio behaviour. It is impossible to tell whats wrong from looking at the strace above. All I can say is that other stdio using programs work flawlessly on uclibc.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p148475">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">pro_processor</div>
					<div class="post-datetime">
						14 Nov 2011, 19:26					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for response jow.</p><p>I thought that uclibc must work successfully,<br />but the above device with x86 works fine with glibc and i think that it can be caused by uclibc.<br />I did not understand why glibc reads the file and close succesfully but uclibc can not do this?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p148481">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						14 Nov 2011, 19:54					</div>
				</div>
				<div class="post-content content">
					<p>There happens a lot of stuff between fopen(), fread(), fclose(), feof() and the syscalls open(), read(), write() etc. I&#039;m not convinced that uclibc is to blame here, post some excerpt of the code reading the file.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>