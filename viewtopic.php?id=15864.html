<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> 2.6.25.4 booting on a BCM5354 (CFE troubles)</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 1 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p69023">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">sbrown</div>
					<div class="post-datetime">
						1 Jun 2008, 23:09					</div>
				</div>
				<div class="post-content content">
					<p>I have an Asus wl520gu. I can&#039;t find the right entry point for the cfe api. The one in bcm47xx/prom.c (0xBFC00500) works for the 5352 on an Asus wl500gp but not the 5354. It just hangs at &quot;Starting program&quot;. I tested prom_putchar on the 5352, so its cfe api does work.</p><p>I checked 2.6.23, the Asus GPL code and dd-wrt, but the cfe api isn&#039;t used.</p><p>If I turn off CONFIG_EARLY_PRINTK and commented out prom_init_cfe, prom_init_console and prom_init_cmdline in prom.c, the 5354 boots. Either I have the wrong entry point or the api functionality is missing from the cfe. The cfe is rather stripped down, no ping, no nvram functions either than set, etc. This was probably done either to save space or confound the evil people who replace factory firmware.</p><p>Any idea, short of disassembling the 5354 cfe, on how to determine whether the api is really there and, if so, how to find the entry point?</p><p>The fw_arg&#039;s passed from both processors cfe&#039;s are below.</p><p>Steve</p><div class="codebox"><pre><code>========================= BCM5354 ================
Loader:raw Filesys:raw Dev:flash0.os File: Options:(null)
Loading: .. 3752 bytes read
Entry at 0x80001000
Closing network.
Starting program at 0x80001000
Linux version 2.6.23.17 (brown@mythtv.cortland.com) (gcc version 4.1.2) #3 Sat May 31 16:00:27 PDT 2008
arch/mips/kernel/setup.c:528
arch/mips/kernel/setup.c:530
arch/mips/bcm947xx/prom.c:44
arch/mips/bcm947xx/prom.c:50 arg0:0xea8 arg1:0x80434760 arg2:0x80434760 arg3:0x80420084
arch/mips/bcm947xx/prom.c:52 arg3[0]:0x8fbf0014 arg3[1]:0x8fb00010 arg3[2]:0x3e00008 arg3[3]:0x27bd0018
arch/mips/bcm947xx/prom.c:66 mem:0x1000000
arch/mips/kernel/setup.c:532
CPU revision is: 00029029
arch/mips/kernel/setup.c:542
ssb: Core 0 found: ChipCommon (cc 0x800, rev 0x14, vendor 0x4243)


======================== BCM5352 ================
Starting program at 0x80001000
Linux version 2.6.23.17 (brown@mythtv.cortland.com) (gcc version 4.1.2) #3 Sat May 31 16:00:27 PDT 2008
arch/mips/kernel/setup.c:528
arch/mips/kernel/setup.c:530
arch/mips/bcm947xx/prom.c:44
arch/mips/bcm947xx/prom.c:50 arg0:0xea8 arg1:0x8043b5c0 arg2:0x8043b5c0 arg3:0x80424e7c
arch/mips/bcm947xx/prom.c:52 arg3[0]:0x8fbf0014 arg3[1]:0x8fb00010 arg3[2]:0x3e00008 arg3[3]:0x27bd0018
arch/mips/bcm947xx/prom.c:66 mem:0x1000000
arch/mips/kernel/setup.c:532
CPU revision is: 00029008
arch/mips/kernel/setup.c:542
ssb: Core 0 found: ChipCommon (cc 0x800, rev 0x0E, vendor 0x4243)
ssb: Core 1 found: Fast Ethernet (cc 0x806, rev 0x09, vendor 0x4243)</code></pre></div>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>