<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> [How To] Asterisk 11+GSM/SMS channel+Google Voice+OpenWRT SIP Client</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 25 Apr 2018 and 5 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 4</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=53874&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=53874&amp;p=3.html">3</a></li><li><a href="viewtopic.php%3Fid=53874&amp;p=4.html">4</a></li></ul></nav></div>
			
		
		
			<article class="post" id="p253590">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						8 Nov 2014, 09:32					</div>
				</div>
				<div class="post-content content">
					<p>Check also my previous How-to&#039;s: </p><p>[How To] Cheap Digital Stereo WiFi Internet Radio &amp; MP3 Player:<br />(<a href="https://forum.openwrt.org/viewtopic.php?id=49013">https://forum.openwrt.org/viewtopic.php?id=49013</a>)</p><p>and<br />[How To] Control a simple DIY relay board via internet Web page or SMS:<br /><a href="https://forum.openwrt.org/viewtopic.php?pid=258891#p258891">https://forum.openwrt.org/viewtopic.php … 91#p258891</a></p><p>and<br />[How To] Web SMS server with OpenWRT:<br /><a href="https://forum.openwrt.org/viewtopic.php?id=60910">https://forum.openwrt.org/viewtopic.php?id=60910</a></p><p>------------------------------------------------------</p><p><strong>How To create a Voip gateway with OpenWrt <span style="color: #FF0000">Barrier_Breaker</span> + Asterisk11</strong> <br /><span class="bbu">(don&#039;t use chaos calmer, it sucks, many asterisk 11 modules are missing!)</span></p><p>------------------------------------------------------</p><p>After reading and testing hundreds of incorrect and/or incomplete How-To&#039;s on this subject, I decided to create a serious one!</p><p>The Voip gateway has the following features:</p><p>SIP extensions (voip phones)<br />SIP channels (voip providers)<br />GSM channel (mobile phone line in/out) <br />SMS channel (mobile SMS in/out)<br />Voicemail (welcome audio messages + mini-sendmail to send recorded audio messages as mail attachements)</p><p>Hardware I used:<br />TP-Link TL-WR710n<br />Huawei e169 3G USB dongle<br />1 GB USB flash ext4 formatted (Overlay)<br />4 ports external powered USB Hub</p><p>Note: use only an external powered USB HUB (5V 1A or more), the Huawey dongle requires 0.5 A, the router itself is not capable of handling such a high current.</p><p>You can find my DEMO configuration files and other interesting stuffs @ my site: <span style="color: #FF0000">REMOVED</span>&nbsp; ( under /software/openwrt/)</p><p>notes: <br />in the DEMO configuration files I used Italian language setting (it,IT), you can change it to match your desidered language (ex. en,EN) by editing /etc/asterisk/ configuration files.</p><br /><p>The audio sound files (many languages) are here: <a href="http://downloads.asterisk.org/pub/telephony/sounds/">http://downloads.asterisk.org/pub/telephony/sounds/</a> , untar and put them on &#039;/var/lib/asterisk/sounds&#039;.</p><p>---- [How to] --------------------------------------------------------------------</p><p>- External USB Overlay Instructions - OpenWrt Barrier Breaker - (single partition ext4 formatted USB Flash):</p><p><strong>opkg update<br />opkg install kmod-usb-uhci<br />opkg install kmod-usb-ohci<br />opkg install kmod-usb2<br />opkg install kmod-usb-core kmod-usb-storage usbutils block-mount kmod-fs-ext4</strong></p><p>Mount the filesystem:</p><p><strong>mkdir /mnt/sda1<br />mount /dev/sda1 /mnt/sda1</strong></p><p>Copy contents from /overlay to usb device:</p><p><strong>tar -C /overlay -cvf - . | tar -C /mnt/sda1 -xf -</strong></p><p>Generate fstab file:</p><p><strong>block detect &gt; /etc/config/fstab</strong></p><p>Edit fstab file:</p><p><strong>vi /etc/config/fstab</strong></p><p>change the target to &#039;/overlay&#039; <br />change enabled option from &#039;0&#039; to &#039;1&#039;</p><p>Do not change UUID or other settings!</p><p>Reboot and check if everything is OK with the &quot;df -kh&quot; command:</p><p>root@OpenWrt:~# df -kh<br />Filesystem&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Size&nbsp; &nbsp; &nbsp; Used Available Use% Mounted on<br />rootfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 802.4M&nbsp; &nbsp; 512.3M&nbsp; &nbsp; 232.5M&nbsp; 69% /<br />/dev/root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2.3M&nbsp; &nbsp; &nbsp; 2.3M&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 100% /rom<br />tmpfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 14.1M&nbsp; &nbsp; &nbsp; 1.4M&nbsp; &nbsp; &nbsp;12.7M&nbsp; 10% /tmp<br />/dev/sda1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;802.4M&nbsp; &nbsp; 512.3M&nbsp; &nbsp; 232.5M&nbsp; 69% /overlay<br />overlayfs:/overlay&nbsp; &nbsp; &nbsp; 802.4M&nbsp; &nbsp; 512.3M&nbsp; &nbsp; 232.5M&nbsp; 69% /<br />tmpfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;512.0K&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; 512.0K&nbsp; &nbsp;0% /dev</p><p>Install the following packages:</p><p><strong>opkg update<br />opkg install mini-sendmail</strong></p><p><strong>opkg install asterisk11 asterisk11-app-authenticate asterisk11-app-chanisavail asterisk11-app-chanspy asterisk11-app-directed_pickup asterisk11-app-disa asterisk11-app-exec </strong></p><p><strong>opkg install asterisk11-app-mixmonitor asterisk11-app-read asterisk11-app-readexten asterisk11-app-record asterisk11-app-sayunixtime asterisk11-app-senddtmf </strong></p><p><strong>opkg install asterisk11-app-sms asterisk11-app-stack asterisk11-app-system asterisk11-app-verbose asterisk11-app-waituntil asterisk11-app-while asterisk11-chan-dongle</strong></p><p><strong>opkg install asterisk11-codec-a-mu asterisk11-codec-alaw asterisk11-codec-gsm asterisk11-codec-resample asterisk11-curl asterisk11-format-gsm asterisk11-format-sln </strong></p><p><strong>opkg install asterisk11-format-wav asterisk11-format-wav-gsm asterisk11-func-blacklist asterisk11-func-channel asterisk11-func-cut asterisk11-func-devstate </strong></p><p><strong>opkg install asterisk11-func-extstate asterisk11-func-global asterisk11-func-groupcount asterisk11-func-shell asterisk11-func-uri asterisk11-pbx-spool asterisk11-res-agi </strong></p><p><strong>opkg install asterisk11-res-clioriginate asterisk11-res-xmpp asterisk11-sounds asterisk11-voicemail asterisk11-res-timing-timerfd </strong></p><p>Download and copy (overwrite the existing files) the following DEMO configuration files on /etc/asterisk :<br /><span style="color: #FF0000">REMOVED</span></p><p>note: edit them with your own settings!</p><p>disable autostart of asterisk from init.d with the command:<br /><strong>/etc/init.d/asterisk disable</strong></p><p>instead put the following lines in your &quot;/etc/rc.local&quot; file:<br /><em><span style="color: #0000FF"><br /># Put your custom commands here that should be executed once<br /># the system init finished. By default this file does nothing.<br />/bin/sleep 10<br />/etc/init.d/asterisk start<br />exit 0</span></em></p><p>note: to avoid problems asterisk has to be started only after the network is up and running (delay=10 seconds).</p><p>------------------------------------------------------<br />Internal DEMO extensions (see extensions.conf):</p><p>200: (rings for 20 seconds then hangs up if no answer)<br />user=200 - password=P@ssword</p><p>201: (goes to voicemail after 20 seconds if no answer)<br />user=201 - password=P@ssword</p><p>98: to manage voicemail from the phone <br />password=1234</p><p>Note: you can change passwords by editing sip.conf and voicemail.conf</p><p>--------------------------------------------------------</p><p>Command to get the Asterisk CLI:<br /><strong>asterisk -vvvr</strong></p><p>useful asterisk CLI commands:</p><p>OpenWrt*CLI&gt; voicemail show users<br />OpenWrt*CLI&gt; sip show registry<br />OpenWrt*CLI&gt; sip show peers<br />OpenWrt*CLI&gt; dongle show devices</p><p>more to follow ... <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p><span class="postimg"><img src="http://www.lovisolo.com/asterisk/software/openwrt/asterisk.jpg" alt="http://www.lovisolo.com/asterisk/software/openwrt/asterisk.jpg" /></span></p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 13 Nov 2015, 14:24)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p253635">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">dem</div>
					<div class="post-datetime">
						8 Nov 2014, 17:54					</div>
				</div>
				<div class="post-content content">
					<p>Excellent&nbsp; &nbsp;I&#039;ve been looking for a good Asterisk How-To.&nbsp; &nbsp;I&#039;m going to try this with a cordless SIP phone and Openwrt router in Spain</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p263369">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						29 Jan 2015, 11:54					</div>
				</div>
				<div class="post-content content">
					<p>UPDATE 29/01/2015</p><p>If you experience audio scattering on SIP channel or on MOH (Music On Hold), install also res-timing-timerfd module:</p><p><strong>opkg update<br />opkg install asterisk11-res-timing-timerfd</strong></p><p>to enable timing-timerfd edit &quot;/etc/asterisk/modules.conf&quot; and add the following line:</p><p><em><span style="color: #0000FF">load =&gt; res_timing_timerfd.so</span></em></p><p><span class="bbu">IMPORTANT NOTE: do not enable res-timing-timerfd if you use chan_dongle</span></p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 9 Jun 2015, 18:13)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p263371">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						29 Jan 2015, 12:02					</div>
				</div>
				<div class="post-content content">
					<p><span class="bbu">Baresip Openwrt SIP client</span></p><p>Baresip it&#039;s a nice program but official documentation is hardly inexistent and sucks, like many small linux programs, as usual I had to figure out how to configure and use it.<br />How the hell do they create programs without writing a decent documentation?&nbsp; <img src="https://forum.openwrt.org/img/smilies/mad.png" width="15" height="15" alt="mad" />&nbsp; <img src="https://forum.openwrt.org/img/smilies/mad.png" width="15" height="15" alt="mad" /></p><p>- Prerequisites:</p><p>1) install Alsa and USB audio support<br />2) connect an USB audio adapter with a speaker and a microphone or a USB phone / headset (with microphone)<br />note: you might also use a USB webcam with internal microphone or just a USB microphone, in both cases you don&#039;t need an USB audio adapter but you won&#039;t have any speaker (one way audio)<br />3) adjust audio levels of speaker and microphone with command: <strong>alsamixer</strong></p><p>note: see my other &quot;How To&quot; for detailed instructions how to configure USB audio: <a href="https://forum.openwrt.org/viewtopic.php?pid=225463#p225463">https://forum.openwrt.org/viewtopic.php … 63#p225463</a></p><br /><p>- Installation and configuration of Baresip on Barrier Breaker (Baresip doesn&#039;t work on Attitue Adjustment: broken audio!):</p><p><strong>opkg update<br />opkg install kmod-usb-hid<br />opkg install kmod-hid kmod-hid-generic<br />opkg install baresip baresip-mod-alsa baresip-mod-cons baresip-mod-evdev baresip-mod-g711<br />opkg install baresip-mod-stdio baresip-mod-uuid</strong></p><p>Launch baresip once to generate the default configuration files on /root/.baresip:</p><p><strong>baresip</strong></p><p>after a few seconds stop it with ctrl+c<br />then you need to edit the configuration files</p><p><strong>cd /root/.baresip</strong></p><p>first edit &quot;accounts&quot; file</p><p>delete everything and insert the following line (use the values of your SIP accont):<br /><em><span style="color: #0000FF"><br />&lt;sip:<strong>user</strong>:<strong>password</strong>@<strong>sip-provider.com</strong>:<strong>port</strong>&gt;;stunserver=stun:stun.voip.eutelia.it<br /></span></em></p><p>Note: you can add optional parameters to this line just by adding one or more of them with the following format:<br />&lt;sip:user:password@domain;uri-params&gt;;addr-params</p><p>example:<br />&lt;sip:user:password@sip-provider.com:5060;transport=udp&gt;;answermode=auto;stunserver=stun:stun.voip.eutelia.it</p><p>list of optional URI params:</p><p>#&nbsp; &nbsp; ;transport={udp,tcp,tls}</p><p>list of optional addr-params:</p><p>#&nbsp; &nbsp; ;answermode={manual,early,auto}<br />#&nbsp; &nbsp; ;audio_codecs=speex/16000,pcma,...<br />#&nbsp; &nbsp; ;auth_user=username<br />#&nbsp; &nbsp; ;mediaenc={srtp,srtp-mand,srtp-mandf,dtls_srtp,zrtp}<br />#&nbsp; &nbsp; ;medianat={stun,turn,ice}<br />#&nbsp; &nbsp; ;outbound=&quot;sip:primary.example.com;transport=tcp&quot;<br />#&nbsp; &nbsp; ;outbound2=sip:secondary.example.com<br />#&nbsp; &nbsp; ;ptime={10,20,30,40,...}<br />#&nbsp; &nbsp; ;regint=3600<br />#&nbsp; &nbsp; ;regq=0.5<br />#&nbsp; &nbsp; ;rtpkeep={zero,stun,dyna,rtcp}<br />#&nbsp; &nbsp; ;sipnat={outbound}<br />#&nbsp; &nbsp; ;stunserver=stun:[user:pass]@host[:port]</p><p><span class="bbu">NOTE:</span></p><p>if you have installed Asterisk11 on the same router and you want to connect Baresip to local Asterisk, this is the account configuration example:<br /><em><span style="color: #0000FF">&lt;sip:user:password@localhost&gt;;answermode=manual</span></em></p><br /><p>then edit&nbsp; &quot;config&quot; file</p><p>delete everything and insert the following lines:<br /><em><span style="color: #0000FF"><br />#comments added by pilovis<br />#<br />poll_method&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;epoll<br />input_device&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /dev/input/event0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #eventually adapt input device path for your system<br />input_port&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 5555<br />sip_trans_bsize&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;128<br />audio_player&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; alsa,default&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # audio speaker device<br />audio_source&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; alsa,default&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# audio microphone device<br />audio_alert&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;alsa,default&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# audio ring device<br />#<br /># if you want to use more than one audio device you need to use: alsa,default:CARD=devicename<br /># to discover device name use command: aplay -L<br /># -----------------------------------------------------------<br />audio_srate&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8000-48000<br />audio_channels&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1-2<br />rtp_tos&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;184<br />rtcp_enable&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;yes<br />rtcp_mux&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; no<br />#jitter_buffer_delay&nbsp; &nbsp; &nbsp;15-35&nbsp; # uncomment this line only in case you use an external voip provider and you experience high ping latence<br />rtp_stats&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;no<br />dns_server&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 8.8.8.8:53&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# use your preferred DNS server<br />module_path&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/usr/lib/baresip/modules<br />module&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; stdio.so<br />module&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; evdev.so<br />module&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; g711.so<br />module&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; alsa.so<br />module&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; stun.so<br />module&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; turn.so<br />module_tmp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; account.so<br />module_app&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; contact.so<br />module_app&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; menu.so<br />natbd_server&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; creytiv.com&nbsp; # I&#039;m not sure this line is necessary when you set &quot;stunserver&quot; option on user account <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# and/or for local accounts: &lt;user:password@localhost&gt;<br />natbd_interval&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 600&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# same as above, you might try to comment &quot;#&quot; both lines and test if baresip works<br /># eof<br /></span></em></p><p>Launch Baresip:</p><p><strong>baresip</strong></p><p>then press &quot;?&quot; for all available commands</p><p>-------------------------------------------------------------------------------------</p><p>- <span class="bbu">Baresip remote audio monitoring</span></p><p>Make an automatic SIP phone call with the following command:</p><p><strong>(/bin/echo sip:other-user@voip-provider.com; /bin/sleep 60; /bin/echo q) | /usr/bin/baresip -f /root/.baresip -e d</strong></p><p>Note: &quot;sleep 60; echo q&quot; set the total call duration time at 60 seconds including ring time, after that &quot;quit&quot; command is sent to baresip, even if the remote party has not answered the call yet.</p><p>When the remote party answers the phone, he/she hears the ambient audio captured from the local microphone, also if he/she talks, his/her voice is sent to the local speaker (if connected and active).</p><p>-------------------------------------------------------------------------------------------------</p><p>- <span class="bbu">Launch Baresip as a daemon and configure it to auto answer all incoming calls</span></p><p>first configure baresip for auto answer all incoming calls by editing the &quot;/root/.baresip/accounts&quot; file as the following:</p><p><em><span style="color: #0000FF">&lt;sip:user:password@sip-provider.com:5060;transport=udp&gt;;answermode=<strong>auto</strong>;stunserver=stun:stun.voip.eutelia.it<br /></span></em><br />then launch it as a daemon with the following command:</p><p><strong>/usr/bin/baresip -f /root/.baresip -d </strong></p><p>note: &quot;-f /root/.baresip&quot; tells Baresip where to find configuration file, &quot;-d&quot; sends Baresip to background as a daemon, to have a complete option list use &quot;baresip --help&quot;.</p><p>then try to call your local sip account, baresip won&#039;t ring but will answer the call and will start streaming the local audio to you (remote caller), same as above, if you talk,&nbsp; people near to the openwrt router will hear your voice through the speaker (speakerphone mode)</p><p>NOTE: if you use baresip as a daemon and you also want to issue an automatic call from local (openwrt) to remote (eg.: your mobile), you should change the previous auto call command to the following:</p><p><strong>(/bin/echo sip:other-user@voip-provider.com; /bin/sleep 60; /bin/echo b) | /usr/bin/baresip -f /root/.baresip -e d</strong></p><p>basically here we are sending &quot;b&quot; command (HANGUP CALL) to baresip instead of &quot;q&quot; (QUIT BARESIP) because we want to keep baresip running in background.</p><p>If you want to use a USB Voip phone or a USB headset but you want to have a separate speaker that rings for the incoming calls, you need an extra USB audio adapter for the speaker, alsa will recognize it with a different device name, then you just need to modifiy &quot;config&quot; file as the following:</p><p><em><span style="color: #0000FF">audio_player&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; alsa,<strong>default:CARD=headset_devicename</strong><br />audio_source&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; alsa,<strong>default:CARD=headset_devicename</strong><br />audio_alert&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;alsa,<strong>default:CARD=other_devicename</strong></span></em></p><p>note: to find the two device names launch command: <strong>aplay -L</strong>&nbsp; <br />----------------------------------------------------------------------------------------</p><p>- <span class="bbu">USB Keypad</span></p><p>if you connect an USB numeric keypad to your router, you can use it to answer the incoming calls (Enter Key) and/or to dial phone numbers followed by &quot;Enter&quot; key to start the call.<br />To hangup/cancel the call press &quot;Del&quot; key.<br />Unfortunately the &quot;#&quot; key is not implemented, nor available with any shortcut <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>Note: if you want to use the keypad to accept incoming calls by pressing &quot;Enter&quot;, you need to modify the account configuration file as the following:</p><p><em><span style="color: #0000FF">&lt;sip:user:password@sip-provider.com:5060;transport=udp&gt;;<strong>answermode=manual</strong></span></em></p><p><span class="postimg"><img src="http://www.lindy.co.uk/images/usb-numeric-keypad-p763-1172_zoom.jpg" alt="http://www.lindy.co.uk/images/usb-numeric-keypad-p763-1172_zoom.jpg" /></span></p><p>If you use a USB Phone you don&#039;t need the USB audio adapter.</p><p><span class="postimg"><img src="http://blog.ashfame.com/wp-content/uploads/2008/02/usb_phone.jpg" alt="http://blog.ashfame.com/wp-content/uploads/2008/02/usb_phone.jpg" /></span></p><p>if you install &quot;kmod-usb-cm109&quot; you can use some (old) USB Voip phones with support of their integrated keys, like<br />KIP 1000, G-talk , Atcom au100, Allied-Telesis Corega USBPH01.</p><p><span class="postimg"><img src="http://www.komunikate.eu.com/images/kip1000.jpg" alt="http://www.komunikate.eu.com/images/kip1000.jpg" /></span> <span class="postimg"><img src="http://www.voicesource.co.za/images/au-100.jpeg" alt="http://www.voicesource.co.za/images/au-100.jpeg" /></span><span class="postimg"><img src="http://i00.i.aliimg.com/photo/v0/493348222/Original_yealink_wireless_voip_usb_skype_phone.jpg_220x220.jpg" alt="http://i00.i.aliimg.com/photo/v0/493348222/Original_yealink_wireless_voip_usb_skype_phone.jpg_220x220.jpg" /></span></p><br /><p>- To <span class="bbu">start Baresip at bootup</span> but only after Asterisk has fully started, add the following lines to /etc/rc.local:</p><p><em><span style="color: #0000FF">/bin/sleep 10<br />/etc/init.d/asterisk start<br /><strong>/bin/sleep 5<br />/usr/bin/baresip -f /root/.baresip -d &amp;&amp;</strong><br />exit 0<br /></span></em></p><p>Don&#039;t use /etc/init.d/baresip enable or start, cause is broken (config path missing) and will not start at bootup nor will launch baresip daemon <img src="https://forum.openwrt.org/img/smilies/mad.png" width="15" height="15" alt="mad" /> <img src="https://forum.openwrt.org/img/smilies/mad.png" width="15" height="15" alt="mad" /></p><p>----------------------------------------------------------------------------------<br />addendum 07/02/2015</p><p>If you want to control/monitor Baresip running as a backgroud daemon you need to enable console interface mode (UI console),</p><p>first edit Baresip &quot;config&quot; file and uncomment (remove &quot;#&quot;) the following line under UI modules section:</p><p>#module&nbsp; &nbsp; &nbsp;cons.so</p><p>then restart Baresip and you can telnet to 5555 port:</p><p><strong>telnet <em>baresip_IP</em> 5555</strong></p><p>note: <br />you do not need to use any password to login.<br />Baresip_IP is the IP address of your router<br />h+return for help</p><p><span class="bbu">Security</span>: NEVER expose port 5555 of Baresip console to the Internet or outside of your private LAN!</p><p>UI console mode may also be usefull to control baresip daemon running in background, examples:</p><p>to quit baresip daemon:<br /><strong>echo q | telnet localhost 5555</strong></p><p>to hangup a call:<br /><strong>echo b | telnet localhost 5555</strong></p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 9 Jun 2015, 18:14)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p263448">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						30 Jan 2015, 01:26					</div>
				</div>
				<div class="post-content content">
					<p><span class="bbu">Google Voice configuration - Openwrt Asterisk 11 </span></p><p><span class="bbu">UPDATE 02/01/2016</span></p><p>Install missing packages:</p><p><strong>opkg update<br />opkg install libsasl2 libssh libopenssl<br />opkg install asterisk11-chan-motif<br />opkg install asterisk11-res-xmpp</strong></p><p>edit /etc/asterisk/motif.conf</p><p>delete everything and put the following lines:</p><p><em><span style="color: #0000FF">[default](!)<br />disallow=all<br />allow=ulaw<br />context=from-internal ; Default context that incoming sessions will land in</span></em></p><p><em><span style="color: #0000FF">[google]<br />context=incoming-motif<br />disallow=all<br />allow=ulaw<br />connection=google<br /></span></em><br />edit /etc/asterisk/modules.conf</p><p>add the following line:<br /><em><span style="color: #0000FF"><br />load =&gt; chan_motif.so<br /></span></em><br />edit /etc/asterisk/xmpp.conf</p><p>delete everything and put the following lines:</p><p><em><span style="color: #0000FF">[general]</span></em></p><p><em><span style="color: #0000FF">[google]<br />type=client<br />serverhost=talk.google.com<br />username=<strong>you</strong>@gmail.com<br />secret=<strong>yourpassword</strong><br />priority=25<br />port=5222<br />usetls=yes<br />usesasl=yes<br />status=available<br />statusmessage=&quot;I am available&quot;<br />timeout=5<br /></span></em></p><p>edit /etc/asterisk/extensions.conf</p><p>add the following lines:</p><p><em><span style="color: #0000FF">[incoming-motif]</span></em></p><p><em><span style="color: #0000FF">exten =&gt; google,1,NoOp()<br />exten =&gt; google,2,Answer()<br />exten =&gt; google,3,SendDTMF(1)<br />exten =&gt; google,4,Set(crazygooglecid=${CALLERID(name)})<br />exten =&gt; google,5,Set(stripcrazysuffix=${CUT(crazygooglecid,@,1)})<br />exten =&gt; google,6,Set(CALLERID(all)=${stripcrazysuffix})<br />exten =&gt; google,7,Dial(SIP/200,20,D(:1))<br />exten =&gt; google,8,Hangup()</span></em></p><br /><p><em><span style="color: #0000FF">[from-internal]</span></em></p><p><em><span style="color: #0000FF">; outgoing Google Voice<br />exten =&gt; _1XXXXXXXXXX,1,Dial(Motif/google/${EXTEN}@voice.google.com,,r)<br />exten =&gt; _+1XXXXXXXXXX,1,Dial(Motif/google/${EXTEN}@voice.google.com,,r)<br /></span></em><br />edit /etc/asterisk/rtp.conf</p><p>uncomment the following line:<br /><em><span style="color: #0000FF"><br />icesupport=true<br /></span></em></p><p>edit /etc/asterisk/sip.conf</p><p>add the following lines under [general] section:<br /><em><span style="color: #0000FF"><br />tcpbindaddr=0.0.0.0<br />tcpenable=yes<br /></span></em></p><br /><p>Note:<br />use yours values for the fields:<br /><strong>you</strong>@gmail.com<br /><strong>yourpassword</strong> <br />and SIP/<strong>extension</strong> (example: SIP/100)</p><p><span class="bbu">IMPORTANT</span></p><p>Do not forget to enable &quot;<strong>Access for less secure apps</strong>&quot; from this page:<br /><a href="https://www.google.com/settings/security/lesssecureapps">https://www.google.com/settings/security/lesssecureapps</a></p><p>(you need to login to your Google account)</p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 2 Jan 2016, 11:42)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p263590">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						31 Jan 2015, 03:26					</div>
				</div>
				<div class="post-content content">
					<p><strong>Asterisk SMS2mail</strong></p><p><span class="bbu">Configuration to receive SMS from chan_dongle and forward them by email</span></p><p><strong>opkg update<br />opkg install asterisk11-func-base64<br />opkg install mini-sendmail </strong></p><p>Edit &quot;etc/asterisk/extensions.conf&quot;</p><p>add the following lines at the end of the file:</p><p><em><span style="color: #0000FF">[from-pstn]</span></em></p><p><em><span style="color: #0000FF">; SMS2email<br />exten =&gt; sms,1,Noop(Incoming SMS from ${CALLERID(num)} ${BASE64_DECODE(${SMS_BASE64})})<br />exten =&gt; sms,2,System(echo &#039;From: ${CALLERID(num)} &lt;sms-openwrt@domain.com&gt;\nTo: &lt;myself@mail.com&gt;\nSubject:Received SMS\nFrom: ${CALLERID(num)}\n${BASE64_DECODE(${SMS_BASE64})}&#039; &gt;&gt; /var/log/asterisk/sms.txt)</span></em></p><p><em><span style="color: #0000FF">exten =&gt; sms,3,System(/usr/sbin/mini_sendmail -fsms-openwrt@domain.com -ssmtp.mail.com -p25 myself@mail.com &lt; /var/log/asterisk/sms.txt)<br />exten =&gt; sms,4,System(rm -f /var/log/asterisk/sms.txt)<br />exten =&gt; sms,5,Hangup()</span></em></p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 31 Jan 2015, 17:24)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p263717">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						1 Feb 2015, 14:13					</div>
				</div>
				<div class="post-content content">
					<p>If you want to use your custom audio messages in Asterisk do the following.</p><p>- Install sox:</p><p><strong>opkg update<br />opkg install sox</strong></p><p>create custom directory:</p><p><strong>mkdir /usr/lib/asterisk/sounds/custom</strong></p><br /><p>- Command to convert wav to sln for Asterisk (Openwrt needs 2 minutes or more to convert a file):</p><p><strong>sox message.wav -t raw -r 8000 -s -2 -c 1 message.sln</strong></p><p>note: the source audio files to be converted should be recorded in wav 16 bit (Microsoft) PCM format.</p><br /><p>then move converted file &quot;message.sln&quot; to /usr/lib/asterisk/sounds/custom.</p><br /><p>- Example of extension.conf:<br /><em><span style="color: #0000FF">exten =&gt; s,n,Playback(./custom/message)</span></em></p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 26 Mar 2015, 07:35)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p263858">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						2 Feb 2015, 16:20					</div>
				</div>
				<div class="post-content content">
					<p>Another interesting functionality to add to to our OpenWRT PBX: </p><p><span class="bbu"><strong>Chan Spy</strong>: listen in on a call, or whisper into a conversation.</span></p><p>If you have not installed it previously, you need to install app_chanspy module:</p><p><strong>opkg update<br />opkg install asterisk11-app-chanspy</strong></p><p>Also, you need at least &quot;beep.ulaw&quot; audio file in /usr/lib/asterisk/sounds directory.</p><br /><p>Then simply add the following lines at the end of the file &quot;/etc/asterisk/extensions.conf&quot;:</p><p><em><span style="color: #0000FF">[from-internal]</span></em></p><p><em><span style="color: #0000FF">;Chanspy Scanning<br />exten =&gt; 555,1,Chanspy(all,b)</span></em></p><p>save and restart Asterisk.</p><p>Now by dialing 555 from another extension you can&nbsp; listen in on a call.</p><p>While spying, the following actions may be performed:</p><p>Dialing # cycles the volume level.<br />Dialing * will stop spying and look for another channel to spy on.<br />Dialing a series of digits followed by # builds a channel name to append to &lt;chanprefix&gt;<br />(e.g. run ChanSpy(Agent) and dial 1234# while spying to jump to channel Agent/1234)</p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 8 Feb 2015, 15:48)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p263861">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						2 Feb 2015, 16:41					</div>
				</div>
				<div class="post-content content">
					<p>Another nice one <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p><span class="bbu"><strong>Make a phone call to your router and execute a system (Linux shell) command inside OpenWRT</strong></span> </p><p>If you have not installed it previously, you need to install app_system module:</p><p><strong>opkg update<br />opkg install asterisk11-app-system</strong></p><p>example line for the diaplan:</p><p><em><span style="color: #0000FF">exten =&gt; s,n,System(/path/command)</span></em></p><p>Details:<br />System(command) - System command alone<br />System(command arg1 arg2 etc) - Pass in some arguments<br />System(command|args) - Use the standard asterisk syntax to pass in arguments</p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 4 Feb 2015, 16:59)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p263887">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						2 Feb 2015, 21:54					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve just discovered that Chan_dongle is broken on Asterisk 11 <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>When I wrote the first How-to I was using a Barrier Breaker (Ar71xx) snapshot and chan_dongle was working well, now I&#039;m using Barrier Breaker final (BRCM63XX) + Asterisk 11 + chan_dongle and I have the following one way audio problem:</p><p>GSM -&gt; Voip&nbsp; &nbsp; is ok, clear audio;<br />Voip -&gt; GSM&nbsp; &nbsp; noise instead of channel audio</p><p>My system is , Vodafone Station - Huawei EchoLife HG553 - 64 Mbytes RAM + USB external Overlay, dongle connected through a powered HUB.</p><p>I tried to change codecs and enable or disable res_timing without any success.</p><p>I tested Huawei E169 &amp; K3765, found same problem on both dongles.</p><p>This problem arose about a year ago, but up to now nobody seems to have taken care of this issue <img src="https://forum.openwrt.org/img/smilies/mad.png" width="15" height="15" alt="mad" /></p><p><span class="bbu">UPDATE: go on reading this 3D, you&#039;ll find the solution for this problem.</span></p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 9 Jun 2015, 18:18)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264110">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						4 Feb 2015, 10:05					</div>
				</div>
				<div class="post-content content">
					<p>Addendum:</p><p>if you note that Baresip after some time loses registration and does not register anymore, try to change the registration configuration file as the following:</p><p><em><span style="color: #0000FF">&lt;sip:user:password@sip-provider.com:port;transport=udp&gt;;answermode=manual;<strong>regint=120;rtpkeep=stun</strong>;stunserver=stun:stun.voip.eutelia.it</span></em></p><p>note: the above is a single line.</p><p>Instead, if asterisk is in on the same router, change the registration configuration file as the following:</p><p><em><span style="color: #0000FF">&lt;sip:user:password@localhost&gt;;answermode=manual</span></em></p><p>Also, you can try to add to the (Baresip) user configuration of local Asterisk (/etc/asterisk/sip.conf ) the following lines:</p><p><em><span style="color: #0000FF">qualify=yes<br />nat=no # if Asterisk is on a remote server use nat=yes<br />insecure=invite,port</span></em></p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 16 Apr 2015, 18:14)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264113">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">hoatienii</div>
					<div class="post-datetime">
						4 Feb 2015, 10:34					</div>
				</div>
				<div class="post-content content">
					<p>If forum have Thanks button, i will click 1000 times for your post. You have many good [How to].</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264117">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						4 Feb 2015, 10:53					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>hoatienii wrote:</cite><blockquote><p>If forum have Thanks button, i will click 1000 times for your post. You have many good [How to].</p></blockquote></div><p> If coders had written “decent” documentations for their programs, my HOW-TOs wouldn’t be necessary <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /><br />Maybe a day they&#039;ll learn that the documentation is as much important as the coding, a good program but with a lack of documentation becomes a bad program, hardly usable and consequently hardly used.</p><p>Thank you <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Maurizio</p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 5 Feb 2015, 22:25)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264150">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						4 Feb 2015, 15:54					</div>
				</div>
				<div class="post-content content">
					<p>If you use Voip on your router I would suggest you to always enable QoS.</p><p>If you have not installed it previously, you need to install app_qos module:</p><p><strong>opkg update<br />opkg install luci-app-qos</strong></p><p>then add the following two rules to the luci Network&gt;QoS configuration page:</p><p>first rule)</p><p>target = priority<br />source host =all<br />Destination host = all<br />Service = all<br />Protocol = all<br />Ports = 5060,5061,5222<br />Number of bytes: leave it empty<br />Comment = SIP and Google Voice</p><p>second rule) </p><p>target = priority<br />source host =all<br />Destination host = all<br />Service = all<br />Protocol = all<br />Ports = 10000:20000<br />Number of bytes: leave it empty<br />Comment = Asterisk RTP stream</p><p>Leave other default rules as they are, insert just your download and upload internet connection speed (be conservative -10%).</p><p>Save &amp; Apply, then reboot.</p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 4 Feb 2015, 16:06)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264153">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						4 Feb 2015, 16:30					</div>
				</div>
				<div class="post-content content">
					<p>Some useful infos:</p><p>Asterisk needs minimum 30 Mbytes of ram to run smoothly on OpenWRT, <br />Baresip needs about 16 Mbytes, (total 46 Mbytes for both)<br />Asterisk uses from 8 to 20% of CPU power (@ 300 Mhz), <br />Baresip uses from 10 to 20% of CPU<br />Asterisk launches multiple concurrent istances (PIDs), about 25!<br />Baresip launches one istance when idle, up to three istances when in a call.</p><p>Each &quot;g711u/a codec&quot; SIP channel needs 128 kbit/s (up/down) bandwidth to work smootly, 80 Kbit/s is the minimum.<br />Each &quot;g729 codec&quot; SIP channel (if available) needs 48 Kbit/s bandwidth to work smootly, 32kbit/s is the minimum.</p><p>Do not expect asterisk to handle more than one or two concurrent calls on OpenWRT <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>To monitor CPU and ram usage, install htop</p><p><strong>opkg install htop</strong></p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 4 Feb 2015, 17:06)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264160">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">gently</div>
					<div class="post-datetime">
						4 Feb 2015, 17:30					</div>
				</div>
				<div class="post-content content">
					<p>I run without baresip, only asterisk 11 with extroot and swap on sd card, 3 concurrent calls are fine from CPU usage perspective.<br />21 sip peer registered</p><p>tp-link wr710n EU</p><p>I plan to go for WT3020 soon to get rid of swap on sd card.</p>											<p class="post-edited">(Last edited by <strong>gently</strong> on 4 Feb 2015, 17:32)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264162">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						4 Feb 2015, 17:49					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>gently wrote:</cite><blockquote><p>I run without baresip, only asterisk 11 with extroot and swap on sd card, 3 concurrent calls are fine from CPU usage perspective.<br />21 sip peer registered</p><p>tp-link wr710n EU</p><p>I plan to go for WT3020 soon to get rid of swap on sd card.</p></blockquote></div><p>Tp-link TL-WR710n EU is a very good router to run OpenWRT and Asterisk but it has only 32 Mbytes of ram, swap might help a lot but Flash memories have limited lifetime due to writing/erase wear-out problem.<br />A solution could be to connect an USB2Sata adapter and use a real Hard Disk with Extroot and Swap on it.</p><p>In your case I would suggest you to use two different SD cards, one for extroot and the other for Swap, if the Swap SD becomes unusable due to wear-out, you just need to put in a new one, swap formatted, eventually adjust fstab and reboot the router.<br />Otherwise with just one SD card you may lose the entire filesystem.</p><p>Note that also internal router flash memory suffers from wear-out problem, but if you have extroot, your internal flash is completely safe because you won&#039;t never write anything to it <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /> , except in case you reflash Openwrt too many times to your router.<br />In the past I permanently damaged two Fonera routers just by reflashing them 5 or 6 times!</p><p>Keep in mind that any process, like &quot;logging&quot;, that writes too frequently to the router internal flash memory, may reduce lifespan of it, log services that write too much should be disabled after the set-up of the router has been completed.</p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 4 Feb 2015, 19:41)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264255">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">gently</div>
					<div class="post-datetime">
						5 Feb 2015, 14:27					</div>
				</div>
				<div class="post-content content">
					<p>thanks for the hint about lifetime of the sticks, you are correct, that is why I want to upgrade to WT3020 and avoid using swap.</p><p>for disaster recovery I have a $15/year VPS server on the Internet <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264352">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">gently</div>
					<div class="post-datetime">
						6 Feb 2015, 10:56					</div>
				</div>
				<div class="post-content content">
					<p>why chan_donge is sucks?</p><p>it works flawlessly for me</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264363">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						6 Feb 2015, 12:09					</div>
				</div>
				<div class="post-content content">
					<p>The chan_dongle doesn&#039;t work on Barrier Breaker nor on Chaos Calmer for BCM63xx, one way audio, no matter what dongle you use (I tested E169 and K3765 Huawei dongles).</p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 8 Feb 2015, 15:50)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p264737">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">hoatienii</div>
					<div class="post-datetime">
						9 Feb 2015, 05:58					</div>
				</div>
				<div class="post-content content">
					<p>Can you linksys pap2 for this [how to]? If ok, i will buy this</p>											<p class="post-edited">(Last edited by <strong>hoatienii</strong> on 9 Feb 2015, 05:59)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p265001">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						10 Feb 2015, 22:50					</div>
				</div>
				<div class="post-content content">
					<p>My last message of this [How To] is to warn you about the reliability of Asterisk with Baresip on OpenWRT.<br />I do not want to delude you, but do not expect a very reliable and stable system, Baresip easily lost the SIP registration and when this happens, it usually does not reconnect again, you need to reboot the router or kill the process and restart it.<br />Also, the audio quality of Baresip with OpenWRT is very bad compared to other SIP clients using the same codecs.</p><p>If you have an old unused router, it is ok to play with it and OpenWRT Voip, but do not waste money to buy a new router to make a PBX on it, if you want a reliable PBX, use Raspberry (same cost of a router), or better, an old PC/laptop with a full linux distro.</p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 16 Feb 2015, 15:30)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p265121">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">gently</div>
					<div class="post-datetime">
						11 Feb 2015, 13:47					</div>
				</div>
				<div class="post-content content">
					<p>please blame baresip only <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>uptime of my asterisk was 250 days, ~2000 calls (not much, home use). no issues at all!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p265140">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						11 Feb 2015, 16:57					</div>
				</div>
				<div class="post-content content">
					<p>You might be right, onestly I didn&#039;t test Asterisk alone without Baresip, maybe Baresip is causing Asterisk to unregister so frequently.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p266386">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">nague</div>
					<div class="post-datetime">
						21 Feb 2015, 14:55					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m trying to use chan_dongle on Barrier Breaker, my chipset’s router is AR71xx so I hope the one way issue is not present… but I have some doubts.</p><p>My dongle is Huawei E180. Voice is enable. And I’m using a powered USB Hub.</p><p>At time this time, I’m having two issues with outgoing calls (incoming not tested yet):</p><p>-&nbsp; &nbsp; The dongle stuck on Dialing state each time I want to make a call… until a dongle reset<br />-&nbsp; &nbsp; I can hear from the GSM =&gt; VoIP (even if the dongle is in the Dialing state), but not in the other side</p><p>Any idea to help me?</p>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 1 of 4</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=53874&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=53874&amp;p=3.html">3</a></li><li><a href="viewtopic.php%3Fid=53874&amp;p=4.html">4</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0.001 -->

</body>
</html>