<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> D-link DIR-505 support?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 2 Apr 2018 and 5 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 9 of 11</div><nav><ul><li><a href="viewtopic.php%3Fid=38742&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=38742&amp;p=7.html">7</a></li><li><a href="viewtopic.php%3Fid=38742&amp;p=8.html">8</a></li><li class="pagination-current"><span>9</span></li><li><a href="viewtopic.php%3Fid=38742&amp;p=10.html">10</a></li><li><a href="viewtopic.php%3Fid=38742&amp;p=11.html">11</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p247319">
				<div class="post-metadata">
					<div class="post-num">Post #201</div>
					<div class="post-author">metai</div>
					<div class="post-datetime">
						17 Sep 2014, 19:46					</div>
				</div>
				<div class="post-content content">
					<p>Yes, you can use the mode switch for pretty much anything you want -- however, keep in mind that the &quot;charge&quot; position turns the router off and is pretty easy to accidentally switch to.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p247507">
				<div class="post-metadata">
					<div class="post-num">Post #202</div>
					<div class="post-author">micha-uhl</div>
					<div class="post-datetime">
						19 Sep 2014, 18:23					</div>
				</div>
				<div class="post-content content">
					<p>the switch and the pushbutton are not used by openwrt?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p247522">
				<div class="post-metadata">
					<div class="post-num">Post #203</div>
					<div class="post-author">metai</div>
					<div class="post-datetime">
						19 Sep 2014, 20:34					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m not entirely sure about the wps button. My 505 is still happily buzzing along on r37855, and it&#039;s not used there, but that may have changed in the meantime. At any rate, how the button is used can be redefined, even if it comes with a default behaviour.</p><p>The switch is just a set of GPIOs which OpenWrt by default doesn&#039;t even know about. I believe they have to be exported to be queried.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p248119">
				<div class="post-metadata">
					<div class="post-num">Post #204</div>
					<div class="post-author">micha-uhl</div>
					<div class="post-datetime">
						25 Sep 2014, 21:55					</div>
				</div>
				<div class="post-content content">
					<p>I would linke to use the WPS button for reboot or shutdown. When preesing the real reset button, the Router makes a factory reset, all data and settings are lost. How could I realise this? The button should work on gpio11.&nbsp; The Router works with mpd as webradio, controlled by mpdroid.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p248168">
				<div class="post-metadata">
					<div class="post-num">Post #205</div>
					<div class="post-author">metai</div>
					<div class="post-datetime">
						26 Sep 2014, 07:51					</div>
				</div>
				<div class="post-content content">
					<p>Have a look at /etc/rc.button/, in there are the scripts that handle button presses, they are quite straightforward. I don&#039;t think you have to go through GPIOs for the wps button, it should be recognized out of the box as &quot;wps&quot;, and should just work in a script named &quot;wps&quot;. (Didn&#039;t try it yet myself though.)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p248346">
				<div class="post-metadata">
					<div class="post-num">Post #206</div>
					<div class="post-author">micha-uhl</div>
					<div class="post-datetime">
						28 Sep 2014, 10:52					</div>
				</div>
				<div class="post-content content">
					<p>thank you, I added a script &quot;wps&quot;:</p><p>#!/bin/sh</p><p>[ &quot;${ACTION}&quot; = &quot;released&quot; ] || exit 0</p><p>. /lib/functions.sh</p><p>logger &quot;$BUTTON pressed for $SEEN seconds&quot;</p><p>if [ &quot;$SEEN&quot; -lt 1 ]<br />then<br />&nbsp; &nbsp; &nbsp; &nbsp; echo &quot;REBOOT&quot; &gt; /dev/console<br />&nbsp; &nbsp; &nbsp; &nbsp; sync<br />&nbsp; &nbsp; &nbsp; &nbsp; reboot<br />elif [ &quot;$SEEN&quot; -gt 3 ]<br />then<br />&nbsp; &nbsp; &nbsp; &nbsp; echo &quot;SHUTDOWN&quot; &gt; /dev/console<br />&nbsp; &nbsp; &nbsp; &nbsp; sync<br />&nbsp; &nbsp; &nbsp; &nbsp; poweroff<br />fi</p><p>it works for reboot and shutdown.<br />Now I need to autostart mpc, set in the rc.local doesn´t work.<br />I ´ve added &quot;mpc load playlist&quot; and &quot;mpc start&quot;, but the mpc doesn´t start.<br />When I start the rc.local with &quot;. /etc/rc.local&quot; it works. Why don´t the rc.local not run?<br />The same on my WR-703n works.</p><p>edit: now it works! I added a &quot;sleep 10&quot; in the file.(must be more then 7sec!)</p>											<p class="post-edited">(Last edited by <strong>micha-uhl</strong> on 29 Sep 2014, 17:12)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p248918">
				<div class="post-metadata">
					<div class="post-num">Post #207</div>
					<div class="post-author">ach</div>
					<div class="post-datetime">
						3 Oct 2014, 03:24					</div>
				</div>
				<div class="post-content content">
					<p>Hello guys, </p><p>My project is a i2c temperature sensor. Now i have a DIR505A1 working fine and logger my bedroom temp. </p><p><a href="http://imgur.com/a/tjuTF">http://imgur.com/a/tjuTF</a><br /><a href="https://thingspeak.com/channels/16282/">https://thingspeak.com/channels/16282/</a></p><p>But i trying of recover another bricked DIR505A1, i cant make it work. </p><p>I try with all type of firmware: AA with patch, BB, D-Link original and none works</p><p>Dlink firmware recovery not work, i can load recover web page but none firmware work after restart. </p><p>This is my console:</p><div class="codebox"><pre><code>U-Boot 1.1.4 (Feb  9 2012 - 20:12:45)

AP121 (ar9331) U-boot

DRAM:  64 MB
Top of RAM usable for U-Boot at: 84000000
Reserving 161k for U-Boot at: 83fd4000
Reserving 192k for malloc() at: 83fa4000
Reserving 44 Bytes for Board Info at: 83fa3fd4
Reserving 36 Bytes for Global Data at: 83fa3fb0
Reserving 128k for boot params() at: 83f83fb0
Stack Pointer at: 83f83f98
Now running in RAM - U-Boot at: 83fd4000
============================================ 
Date:Feb  9 2012  Time:20:12:45
Cameo Version: v1.00 Build:03
Module Name: D-Link DIR-505A1
============================================ 
id read 0x100000ff
flash size 8388608, sector count = 128
Flash:  8 MB
Using default environment

In:    serial
Out:   serial
Err:   serial
Net:   ag7240_enet_initialize...
: cfg1 0x5 cfg2 0x7114
eth0: 90:94:e4:d3:96:5c
eth0 up
: cfg1 0xf cfg2 0x7214
eth1: 00:03:7f:ff:ff:fe
athrs26_reg_init_lan
ATHRS26: resetting s26
ATHRS26: s26 reset done
eth1 up
eth0, eth1
Hit any key to stop autoboot:  0 
## Booting image at 9f080000 ...
Bad Magic Number
ar7240&gt; 
ar7240&gt; 
ar7240&gt; 
ar7240&gt; 
ar7240&gt; printenv
bootargs=console=ttyS0,115200 root=31:06 rootfstype=squashfs init=/sbin/init mtdparts=ar7240-nor0:64k(u-boot),64k(ART),64k(mac),64k(nvram),256k(language),1024k(uImage),6656k(rootfs)
bootcmd=bootm 0x9f080000
bootdelay=2
baudrate=115200
ethaddr=0x00:0xaa:0xbb:0xcc:0xdd:0xee
stdin=serial
stdout=serial
stderr=serial
ethact=eth0
filesize=780054
fileaddr=81000000
ipaddr=192.168.0.1
serverip=192.168.0.20

Environment size: 401/65532 bytes

ar7240&gt; tftpboot 0x81000000 openwrt-ar71xx-generic-dir-505-a1-squashfs-factory.bin
Using eth0 device
TFTP from server 192.168.0.20; our IP address is 192.168.0.1
Filename &#039;openwrt-ar71xx-generic-dir-505-a1-squashfs-factory.bin&#039;.
Load address: 0x81000000
Loading: #################################################################
         #################################################################
         #################################################################
done
Bytes transferred = 7864404 (780054 hex)
ar7240&gt; bootm 0x81000000
## Booting image at 81000000 ...
Bad Magic Number
ar7240&gt; </code></pre></div><p> </p><p>Any suggestion? </p><p>Another of my projects:<br />riotNAS - Similar to pirate box but using samba.<br />[Google Translate link] <br /><a href="http://bit.ly/1rBtX9I">http://bit.ly/1rBtX9I</a></p><p>Sorry my bad english, i am work in my language too. </p><p>Thanks in advance.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p249060">
				<div class="post-metadata">
					<div class="post-num">Post #208</div>
					<div class="post-author">ach</div>
					<div class="post-datetime">
						3 Oct 2014, 23:21					</div>
				</div>
				<div class="post-content content">
					<p>Hello again, </p><p>I resolve my problem with this method.</p><p>1.- Get a image of firmware partition in my working device:</p><div class="codebox"><pre><code>root@lis001:~# cat /proc/mtd
dev:    size   erasesize  name
mtd0: 00010000 00010000 &quot;u-boot&quot;
mtd1: 00010000 00010000 &quot;art&quot;
mtd2: 00010000 00010000 &quot;mac&quot;
mtd3: 00010000 00010000 &quot;nvram&quot;
mtd4: 00040000 00010000 &quot;language&quot;
mtd5: 00100000 00010000 &quot;kernel&quot;
mtd6: 00680000 00010000 &quot;rootfs&quot;
mtd7: 004a0000 00010000 &quot;rootfs_data&quot;
mtd8: 00780000 00010000 &quot;firmware&quot;
root@lis001:~# dd if=/dev/mtd8 of=/tmp/firmware.backup
15360+0 records in
15360+0 records out
root@lis001:~# ls -la /tmp/firmware.backup 
-rw-r--r--    1 root     root       7864320 Oct  3 15:39 /tmp/firmware.backup
root@lis001:~# </code></pre></div><p>2.- Put this image in my bricked DIR-505</p><div class="codebox"><pre><code>ar7240&gt; tftpboot 0x81000000 firmware.backup
Using eth0 device
TFTP from server 192.168.0.20; our IP address is 192.168.0.1
Filename &#039;firmware.backup&#039;.
Load address: 0x81000000
Loading: #################################################################
         #################################################################
         #################################################################
done
Bytes transferred = 7864320 (780000 hex) 

ar7240&gt; erase 0x9f080000 +0x780000
Erase Flash from 0x9f080000 to 0xffffffff in Bank # 1 
First 0x8 last 0x7f sector size 0x10000                                                                                127
Erased 120 sectors

ar7240&gt; cp.b 0x81000000 0x9f080000 0x780000
Copy to Flash... write addr: 9f080000
done</code></pre></div><p>And restart y voila! working again! but what about with the image of openwrt in repository?? I look this:</p><p>OpenWRT repository image: <br />Bytes 7864404 (780054 hex)<br />Data in firmware partition extracted <br />Bytes 7864320 (780000 hex) </p><p>Ok, then test this:</p><div class="codebox"><pre><code>dd skip=84 if=openwrt-ar71xx-generic-dir-505-a1-squashfs-factory.bin of=firstcut.bin bs=1</code></pre></div><p>And after use this:<br /></p><div class="codebox"><pre><code>mtd -r write firstcut.bin firmware</code></pre></div><p>And this work too. Why this initial 84 bytes? I dont know but i am happy with my debricked router <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Please, any can get me a explain about this?</p><p>Thanks and happy hacking!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p252649">
				<div class="post-metadata">
					<div class="post-num">Post #209</div>
					<div class="post-author">olorin</div>
					<div class="post-datetime">
						31 Oct 2014, 17:19					</div>
				</div>
				<div class="post-content content">
					<p>Hi ach,</p><p>I am also planning to create a kind of &quot;room sensor&quot; out of the DIR-505. </p><p>Could you please share your setup of the i2c sensor you connected? Which cable connection corresponds to which GPIO line (maybe a numbered PCB picture)? What software/configuration do you use to read the sensor? </p><p>Maybe this would be something to add to the OpenWrt Wiki, too. Or we create a small howto in the forum out of that.</p><p>Thanks in advance</p><p>Andreas</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p252793">
				<div class="post-metadata">
					<div class="post-num">Post #210</div>
					<div class="post-author">shad</div>
					<div class="post-datetime">
						2 Nov 2014, 00:39					</div>
				</div>
				<div class="post-content content">
					<p>Hi ach,</p><p>Pretty much like Andreas, I&#039;m also wondering, how you built your temperature sensor (mostly because I&#039;m planning to do the same).</p><p>My guess, from your pictures, would be that your repurposed the switch and used its GPIO to connect the sensor. Is that right?</p><p>Regards,<br />Shad</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p266811">
				<div class="post-metadata">
					<div class="post-num">Post #211</div>
					<div class="post-author">Tito1337</div>
					<div class="post-datetime">
						25 Feb 2015, 03:07					</div>
				</div>
				<div class="post-content content">
					<p>Hi everybody with a DIR-505!</p><p>I was a little silly and did something stupid (well, that&#039;s the point of flashing OpenWRT isn&#039;t it? <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" />) I overwrote some mtd partitions that I had no backups... I&#039;m pretty sure that the ART partition (mtd1) shouldn&#039;t be full of 0xFF and that the MAC partition (mtd2) should&#039;nt contain the first 64 bytes of a firmware <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></p><p>If somebody would be kind enough to upload a dump of all its mtd partitions, it would be most appreciated. <strong>Otherwise my DIR-505 is going to the garbage bin...</strong></p><p>If you don&#039;t know how to do it it&#039;s pretty simple. On a running instance of OpenWRT :<br /></p><div class="codebox"><pre><code># dd if=/dev/mtd0 of=/tmp/mtd0</code></pre></div><p>On your Linux machine :<br /></p><div class="codebox"><pre><code>scp root@192.168.1.1:/tmp/mtd0 .</code></pre></div><p>I think that I only need mtd1 and mtd2, but if you would be kind enough to upload all mtds (0 to 8) I would be sure to have everything I need.</p><p><strong>By advance, thank you very much !</strong></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p266828">
				<div class="post-metadata">
					<div class="post-num">Post #212</div>
					<div class="post-author">metai</div>
					<div class="post-datetime">
						25 Feb 2015, 10:11					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Tito1337 wrote:</cite><blockquote><p>If somebody would be kind enough to upload a dump of all its mtd partitions,</p></blockquote></div><p><a href="http://www.filedropper.com/dir505mtd0mtd4">http://www.filedropper.com/dir505mtd0mtd4</a> contains mtd0 to mtd4 and should be enough to get you up and running again, at least to the Emergency Flash facility. mtd2 has the NIC part of the MAC address replaced with 00:00:00/00:00:01, so make up a new one for yourself. And for obvious reasons I won&#039;t give you mtd5 (which would include mtd6 and mtd7) of a device in use. HTH, HAND</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p266839">
				<div class="post-metadata">
					<div class="post-num">Post #213</div>
					<div class="post-author">grisina</div>
					<div class="post-datetime">
						25 Feb 2015, 12:40					</div>
				</div>
				<div class="post-content content">
					<p>Based in UK, just got hold of a DIR-505 (P/N EIR505BEU....A1E) but yet to open up to access serial.&nbsp; Been tearing apart the stock firmware and interestingly the tftpd seems to allow the download of anything on the filesystem.&nbsp; It&#039;s therefore possible to backup all the mtd partitions by doing a get on /dev/mtdblock[0-6]&nbsp; &nbsp;(but writing appears to be blocked)<br /><a href="http://www.xn--80acbggrbac8bclycdxk.com">интериорни врати</a></p>											<p class="post-edited">(Last edited by <strong>grisina</strong> on 4 Mar 2015, 15:48)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p266867">
				<div class="post-metadata">
					<div class="post-num">Post #214</div>
					<div class="post-author">Tito1337</div>
					<div class="post-datetime">
						25 Feb 2015, 16:56					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>metai wrote:</cite><blockquote><p><a href="http://www.filedropper.com/dir505mtd0mtd4">http://www.filedropper.com/dir505mtd0mtd4</a> contains mtd0 to mtd4 and should be enough to get you up and running again</p></blockquote></div><p>Thank you very much! I suppose I will also have to correct the checksum but I understand that you don&#039;t include the Mac <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>EDIT1 : Also, it&#039;s normal that mtd1 is full of 0xFF?</p><p>EDIT2 : WiFi works again! Thanks again!</p>											<p class="post-edited">(Last edited by <strong>Tito1337</strong> on 25 Feb 2015, 17:33)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p266878">
				<div class="post-metadata">
					<div class="post-num">Post #215</div>
					<div class="post-author">metai</div>
					<div class="post-datetime">
						25 Feb 2015, 18:16					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Tito1337 wrote:</cite><blockquote><p>Thank you very much! I suppose I will also have to correct the checksum but I understand that you don&#039;t include the Mac <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p></blockquote></div><p>Ah, sorry, I wasn&#039;t aware that there was a checksum, but you seem to know your way around anyway. Also, including the MAC isn&#039;t so much a &quot;security issue&quot; I am worried about (that would be mtd5 to mtd7 that contains sensible data) rather than something that is <em>supposed</em> to be unique. Can&#039;t have people run around the interwebs with my router&#039;s MAC. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><div class="quotebox"><blockquote><p>EDIT1 : Also, it&#039;s normal that mtd1 is full of 0xFF?</p></blockquote></div><p>It isn&#039;t, have a look at offset 0x1000.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p266888">
				<div class="post-metadata">
					<div class="post-num">Post #216</div>
					<div class="post-author">Tito1337</div>
					<div class="post-datetime">
						25 Feb 2015, 19:00					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>metai wrote:</cite><blockquote><p>Ah, sorry, I wasn&#039;t aware that there was a checksum</p></blockquote></div><p>I <a href="http://wiki.openwrt.org/doc/howto/restore_art_partition#modyfing_mac_on_art_partition">read somewhere</a> that the ART partition was storing the wireless MAC address with a checksum.</p><p>But I didn&#039;t run into any issues and the WiFi went right back up with your images (and my original Mac addresses in it) without any checksum trick. Maybe D-Link didn&#039;t bother storing the MAC in the ART partition.</p><div class="quotebox"><cite>metai wrote:</cite><blockquote><p>have a look at offset 0x1000.</p></blockquote></div><p>Good catch. At that offset there is something that looks like a default MAC address &quot;.0:11:22:33:44:55&quot;, maybe that&#039;s why I didn&#039;t have to modify the checksum.</p>											<p class="post-edited">(Last edited by <strong>Tito1337</strong> on 25 Feb 2015, 19:00)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p266892">
				<div class="post-metadata">
					<div class="post-num">Post #217</div>
					<div class="post-author">Tito1337</div>
					<div class="post-datetime">
						25 Feb 2015, 19:46					</div>
				</div>
				<div class="post-content content">
					<p><strong>Ok now that my router is up &amp; running again I will try to share some of the acquired knowledge for future reference and hopefully help others.</strong></p><p>My DIR-505 was bricked : no firmware was booting and the U-Boot environment was waiting for instructions. This expressed in a solid red LED. The D-Link emergency flash webpage was still showing up but didn&#039;t flash the firmware correctly.</p><p>I hooked up serial like indicated on the <a href="http://wiki.openwrt.org/toh/d-link/dir-505">DIR-505 wiki page</a>. The 3.3V isn&#039;t necessary. I powered it with mains power but I think you can hookup 5V directly like described on the wiki. The U-Boot environment can access all of memory :<br /> * 0x00000000 to 0x84000000 : 64MB RAM (with some U-Boot code in the upper addresses)<br /> * 0x9f000000 to 0x9f800000 : 8MB FLASH</p><p>Here is the partition table of the FLASH :<br /></p><div class="codebox"><pre><code>MTD  |  Name       | Flash range                   | U-Boot address | Notes
------------------------------------------------------------------------------------------
mtd0 | u-boot      | 0x000000000000-0x000000010000 | 0x9f000000     | Bootloader /!\
mtd1 | ART         | 0x000000010000-0x000000020000 | 0x9f010000     | Atheros Radio Test
mdt2 | mac         | 0x000000020000-0x000000030000 | 0x9f020000     | MAC addresses
mtd3 | nvram       | 0x000000030000-0x000000040000 | 0x9f030000     | 
mtd4 | language    | 0x000000040000-0x000000080000 | 0x9f040000     |
mtd5 | firmware    | 0x000000080000-0x000000800000 | 0x9f080000     | Flash firmware here
mtd6 | kernel      | 0x000000080000-0x00000018e4dd | 0x9f080000     | First part of mtd5
mtd7 | rootfs      | 0x00000018e4dd-0x000000800000 | 0x9f18e4dd     | Second part of mtd5
mtd8 | rootfs_data | 0x0000003b0000-0x000000800000 | 0x9f3b0000     | Third part of mtd5</code></pre></div><p>From U-Boot you can flash any of these partition. You need to connect your computer by ethernet and give it IP address 192.168.0.100. Configure a TFTP server with image.bin in the root. I can safely recommend using the 0x81000000 RAM address :<br /></p><div class="codebox"><pre><code>tftpboot 0x81000000 image.bin          # charge from TFTP to RAM
erase 0x9f080000 +0x780000             # erase firmware FLASH
cp.b 0x81000000 0x9f080000 0x780000    # copy from RAM to FLASH</code></pre></div><p>You will notice that this requires an image.bin of 0x780000 (hexa) = 7864320 (decimal) bytes. OpenWRT or D-Link images are 7864404 bytes, so 84 bytes too large. This is because <a href="https://forum.openwrt.org/viewtopic.php?id=38742#p175161">there is a header for the flashing software</a>. You can safely <a href="https://forum.openwrt.org/viewtopic.php?pid=249060#p249060">remove these 84 bytes</a> :<br /></p><div class="codebox"><pre><code>dd skip=84 if=original.bin of=image.bin bs=1</code></pre></div><p>Or you could maybe try to flash an unmodified image by offsetting the cp.b (84 decimal = 54 hexa) but <span class="bbu">I didn&#039;t try this</span>:<br /></p><div class="codebox"><pre><code>cp.b 0x81000054 0x9f080000 0x780000</code></pre></div><p><strong>I hope this will help someone. Don&#039;t forget to backup the entire flash before you begin hacking!</strong></p>											<p class="post-edited">(Last edited by <strong>Tito1337</strong> on 25 Feb 2015, 19:51)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p272228">
				<div class="post-metadata">
					<div class="post-num">Post #218</div>
					<div class="post-author">votsalo</div>
					<div class="post-datetime">
						13 Apr 2015, 00:25					</div>
				</div>
				<div class="post-content content">
					<p>I cannot connect to my OpenWRT DIR-505 device through an ethernet switch.<br />I have setup my eth interface to have a static ip address with the DHCP server enabled.<br />If I plug a cable directly from the DIR-505 to my PC, my PC gets an IP address through DHCP.&nbsp; I can ping the device, ssh to it, etc.<br />But if I put an ethernet switch between the PC and the DIR-505, I cannot do any of the above.&nbsp; Even if I set the ip address of my PC to be in the same network as the DIR-505, I cannot ping it.<br />I have tested the ethernet switch between my PC and another router, so I know it works.</p><p>What could be causing this?<br />The switch is NETGEAR FS605v3</p><p>I also tried connecting the DIR-505 with my PC through another router&#039;s switch, and it worked, even though the DIR-505 and the other router had different network addresses.&nbsp; I just had to force the ip address on my PC to be in the same network as the DIR-505. (e.g. 192.168.5.x/24 vs 192.168.2.x/24)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p272235">
				<div class="post-metadata">
					<div class="post-num">Post #219</div>
					<div class="post-author">tmo26</div>
					<div class="post-datetime">
						13 Apr 2015, 01:28					</div>
				</div>
				<div class="post-content content">
					<p>Post your /etc/config/network.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p272236">
				<div class="post-metadata">
					<div class="post-num">Post #220</div>
					<div class="post-author">votsalo</div>
					<div class="post-datetime">
						13 Apr 2015, 01:30					</div>
				</div>
				<div class="post-content content">
					<p>config interface &#039;loopback&#039;<br />&nbsp; &nbsp; option ifname &#039;lo&#039;<br />&nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; option ipaddr &#039;127.0.0.1&#039;<br />&nbsp; &nbsp; option netmask &#039;255.0.0.0&#039;</p><p>config globals &#039;globals&#039;<br />&nbsp; &nbsp; option ula_prefix &#039;fd02:0e08:a54d::/48&#039;</p><p>config interface &#039;lan&#039;<br />&nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; option ipaddr &#039;192.168.5.1&#039;<br />&nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;<br />&nbsp; &nbsp; option _orig_ifname &#039;eth0&#039;<br />&nbsp; &nbsp; option _orig_bridge &#039;false&#039;<br />&nbsp; &nbsp; option ifname &#039;eth1&#039;</p><p>config interface &#039;wwan&#039;<br />&nbsp; &nbsp; option proto &#039;dhcp&#039;<br />&nbsp; &nbsp; option hostname &#039;OpenWrt&#039;</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p272241">
				<div class="post-metadata">
					<div class="post-num">Post #221</div>
					<div class="post-author">votsalo</div>
					<div class="post-datetime">
						13 Apr 2015, 02:02					</div>
				</div>
				<div class="post-content content">
					<p>The switch uses the store-and-forward method, which means it examines each packet for errors and drops the ones that have CRC errors (checksum) or perhaps other errors (too short or too long).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p272272">
				<div class="post-metadata">
					<div class="post-num">Post #222</div>
					<div class="post-author">votsalo</div>
					<div class="post-datetime">
						13 Apr 2015, 10:40					</div>
				</div>
				<div class="post-content content">
					<p>More on the 505-switch communication issue:</p><p>I believe the problem is called by a hardware bug or by incomplete implementation of auto-mid/midx.&nbsp; The problem could be on either the DIR-505 or the FS605v3.&nbsp; The switch is not that old (circa 2010) but it is a discontinued model with specifications that state it supports &quot;Auto Uplink TM (Auto MDI-X)&quot;.&nbsp; The fact that they use a trademarked name for the feature makes me suspicious.&nbsp; On the other end, the 505 specs state that it supports IEE 802.3u, but it does not explicitly state Auto MDI-X.</p><p>I suspect that if I buy a new switch, it would work with the 505.</p><p>The 505 can communicate with my PC with either kind of cable (straight-through or crossover).</p><p>I would also like to point out that the 505 is picky about RJ-45 connector sizes.&nbsp; My crossover cable barely fits in the 505.&nbsp; I made the cable myself with commercial connectors.&nbsp; I cannot see any difference in connector sizes when I put my cable side-by-side with other cables.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p278721">
				<div class="post-metadata">
					<div class="post-num">Post #223</div>
					<div class="post-author">bashywash</div>
					<div class="post-datetime">
						3 Jun 2015, 11:04					</div>
				</div>
				<div class="post-content content">
					<p>My brother ended up heating up the iron too hot and took the pad off the RX UART line. Does anyone know any other leads on the board I can use for the RX line? </p><p>thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p278742">
				<div class="post-metadata">
					<div class="post-num">Post #224</div>
					<div class="post-author">votsalo</div>
					<div class="post-datetime">
						3 Jun 2015, 16:09					</div>
				</div>
				<div class="post-content content">
					<p>Has the price of this device gone up?&nbsp; In my country (Greece), it went from 29 euros to 39 euros in several stores that I have checked.<br />I was able to buy it for ~ 25 euros ~ two months ago.<br />People have mentioned that they&#039;ve bought it for $22 or $25 in this topic.&nbsp; Is it still available at these prices?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p278805">
				<div class="post-metadata">
					<div class="post-num">Post #225</div>
					<div class="post-author">bashywash</div>
					<div class="post-datetime">
						4 Jun 2015, 03:44					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>votsalo wrote:</cite><blockquote><p>Has the price of this device gone up?&nbsp; In my country (Greece), it went from 29 euros to 39 euros in several stores that I have checked.<br />I was able to buy it for ~ 25 euros ~ two months ago.<br />People have mentioned that they&#039;ve bought it for $22 or $25 in this topic.&nbsp; Is it still available at these prices?</p></blockquote></div><p>Looking at Ebay, they are going for that range $22-$25 for new units. Most are the newer &quot;L&quot; units but they work just fine with OpenWrt</p>											<p class="post-edited">(Last edited by <strong>bashywash</strong> on 4 Jun 2015, 03:44)</p>
									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 9 of 11</div><nav><ul><li><a href="viewtopic.php%3Fid=38742&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=38742&amp;p=7.html">7</a></li><li><a href="viewtopic.php%3Fid=38742&amp;p=8.html">8</a></li><li class="pagination-current"><span>9</span></li><li><a href="viewtopic.php%3Fid=38742&amp;p=10.html">10</a></li><li><a href="viewtopic.php%3Fid=38742&amp;p=11.html">11</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>