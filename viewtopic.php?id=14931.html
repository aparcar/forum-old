<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> upx for large applications?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 2 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p65267">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">michu</div>
					<div class="post-datetime">
						17 Mar 2008, 10:58					</div>
				</div>
				<div class="post-content content">
					<p>I just realized, that upx also support mips/mipsel/arm... and i assume the compression of upx is better than the fs compression. would it make sense to compress larger files (perhaps &gt; 50k) with upx, or would this result in a overhaed because of the double compression (upx and fs)?</p><p>cheers<br />michu</p><p>edit:<br />just compressed busybox (kamikaze 7.09):<br />658987 -&gt;&nbsp; &nbsp; 285144&nbsp; &nbsp;43.27%&nbsp; linux/mipsel&nbsp; &nbsp;busybox</p>											<p class="post-edited">(Last edited by <strong>michu</strong> on 17 Mar 2008, 11:16)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p65269">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">forum2008</div>
					<div class="post-datetime">
						17 Mar 2008, 11:25					</div>
				</div>
				<div class="post-content content">
					<p>Why? There are better routers with more flash and RAM...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p65270">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">michu</div>
					<div class="post-datetime">
						17 Mar 2008, 11:29					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>forum2008 wrote:</cite><blockquote><p>Why? There are better routers with more flash and RAM...</p></blockquote></div><p>I use a asus wl 500gp with 8mb of flash... but im slowly running out of free flash space and I dont want to store my apps on a external memory stick nor hdd...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p65272">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Kaloz</div>
					<div class="post-datetime">
						17 Mar 2008, 12:03					</div>
				</div>
				<div class="post-content content">
					<p>Both squashfs and jffs2 are compressed, so pre-compressing the packages with UPX doesn&#039;t make sense..</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p65273">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">michu</div>
					<div class="post-datetime">
						17 Mar 2008, 12:18					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Kaloz wrote:</cite><blockquote><p>Both squashfs and jffs2 are compressed, so pre-compressing the packages with UPX doesn&#039;t make sense..</p></blockquote></div><p>i know that.. but my *guess* was, that upx has a better compression ratio than the on-the-fly jffs2 compression. so this would make sense when using large application? does jffs compress the file, even the compressed file is larger than the uncompressed file?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p65274">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">forum2008</div>
					<div class="post-datetime">
						17 Mar 2008, 12:19					</div>
				</div>
				<div class="post-content content">
					<p>And from where do you take the CPU horsepower for decompressing? The CPU of most consumer routers is already too slow to route 30mbits...</p>											<p class="post-edited">(Last edited by <strong>forum2008</strong> on 17 Mar 2008, 12:20)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p65275">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">michu</div>
					<div class="post-datetime">
						17 Mar 2008, 12:37					</div>
				</div>
				<div class="post-content content">
					<p>well I guess i give it a try... of course there is a tradeoff between cpu and diskspace, but loading a daemon one and saving 30% diskspace (just a wild guess) may be worth it... I&#039;ll check it</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p65312">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">Wodin</div>
					<div class="post-datetime">
						18 Mar 2008, 00:48					</div>
				</div>
				<div class="post-content content">
					<p>Besides, some of us don&#039;t have anywhere close to 30mbps Internet connections. <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>Although I think using upx is probably more trouble than it&#039;s worth.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p65345">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">michu</div>
					<div class="post-datetime">
						18 Mar 2008, 23:04					</div>
				</div>
				<div class="post-content content">
					<p>disk free BEFORE upx:<br /></p><div class="codebox"><pre><code>root@OpenWrt:/# df -h
Filesystem                Size      Used Available Use% Mounted on
/dev/mtdblock3            5.7M      5.2M    468.0k  92% /jffs</code></pre></div><p>disk free AFTER upx:&nbsp; &nbsp; <br /></p><div class="codebox"><pre><code>root@OpenWrt:/# df -h
Filesystem                Size      Used Available Use% Mounted on
/dev/mtdblock3            5.7M      5.0M    676.0k  88% /jffs</code></pre></div><p>-&gt; more than 200k are freed!</p><p>I compressed those files<br /></p><div class="codebox"><pre><code>     81219 -&gt;     28828   35.49%  linux/mipsel   bemusedlinuxserver
    245730 -&gt;     96996   39.47%  linux/mipsel   bluetoothd
    378051 -&gt;    131244   34.72%  linux/mipsel   dbus-daemon
    268111 -&gt;     95564   35.64%  linux/mipsel   hcid
    250987 -&gt;    104900   41.79%  linux/mipsel   pppd
    371891 -&gt;    105740   28.43%  linux/mipsel   strace
    159319 -&gt;     60876   38.21%  linux/mipsel   lcd4linux
     61259 -&gt;     23708   38.70%  linux/mipsel   mpc
    217639 -&gt;     82700   38.00%  linux/mipsel   mpd
     67787 -&gt;     22276   32.86%  linux/mipsel   sdptool</code></pre></div><p>the funniest part is the execution time:<br /></p><div class="codebox"><pre><code>root@OpenWrt:/# time mpc.nonc
Morcheeba - Washed Away (Feat. Thomas Dybdahl)
[playing] #43/88   0:28/4:22 (11%)
volume:100%   repeat: on    random: on
real    0m 0.45s
user    0m 0.00s
sys     0m 0.01s

root@OpenWrt:/# time mpc
Morcheeba - Washed Away (Feat. Thomas Dybdahl)
[playing] #43/88   0:30/4:22 (11%)
volume:100%   repeat: on    random: on
real    0m 0.34s
user    0m 0.01s
sys     0m 0.01s</code></pre></div><p>mpc.nonc is the uncompressed file! perhaps its faster due less reading on the slow flash?</p><p>so my opinion is that upx is not that stupid... what you think?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p65370">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">Kaloz</div>
					<div class="post-datetime">
						19 Mar 2008, 10:11					</div>
				</div>
				<div class="post-content content">
					<p>You forgot something - with &quot;ls&quot; you will hardly see the size of the files they take on the disk, as that will show the uncompressed size (jffs2 compresses on the fly).&nbsp; Instead of this, one could start with an empty jffs2 (eg. right after reflash), and compare the output of df -h after installing only the uncompressed or only (after another reflash) the upx compressed binaries.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p65372">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">michu</div>
					<div class="post-datetime">
						19 Mar 2008, 10:29					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Kaloz wrote:</cite><blockquote><p>You forgot something - with &quot;ls&quot; you will hardly see the size of the files they take on the disk, as that will show the uncompressed size (jffs2 compresses on the fly).&nbsp; Instead of this, one could start with an empty jffs2 (eg. right after reflash), and compare the output of df -h after installing only the uncompressed or only (after another reflash) the upx compressed binaries.</p></blockquote></div><p>ok... aren&#039;t there any jffs2 tools available? for example a tool like jffs2info /path/file - outputs size on disk.</p><p>so you mean, a df -h outputs only the uncompressed files size and not the actual free space on the disk? this means if df shows there is 100k of free space, its possible to install (for example) 150k due compression?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p65394">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">Kaloz</div>
					<div class="post-datetime">
						19 Mar 2008, 18:22					</div>
				</div>
				<div class="post-content content">
					<p>Exactly, but you can&#039;t really predict the compressed size.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>