<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Support for Marvell 88F5xx81 based routers</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 18 Jan 2014 and 6 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 42 of 46</div><nav><ul><li><a href="viewtopic.php%3Fid=12358&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=12358&amp;p=40.html">40</a></li><li><a href="viewtopic.php%3Fid=12358&amp;p=41.html">41</a></li><li class="pagination-current"><span>42</span></li><li><a href="viewtopic.php%3Fid=12358&amp;p=43.html">43</a></li><li><a href="viewtopic.php%3Fid=12358&amp;p=44.html">44</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=12358&amp;p=46.html">46</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p140622">
				<div class="post-metadata">
					<div class="post-num">Post #1026</div>
					<div class="post-author">stevellion</div>
					<div class="post-datetime">
						4 Aug 2011, 23:04					</div>
				</div>
				<div class="post-content content">
					<p>Solved it.&nbsp; Needed to select a channel.&nbsp; If channel is set to Auto, the interface won&#039;t come up.. no warning as to why... - perhaps the hover help on the channel should point this out!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p142884">
				<div class="post-metadata">
					<div class="post-num">Post #1027</div>
					<div class="post-author">Tischnoetentoet</div>
					<div class="post-datetime">
						5 Sep 2011, 15:57					</div>
				</div>
				<div class="post-content content">
					<p>Hi, </p><p>I am writng this from my phone (knly internet I got ATM), so sorry for short message.</p><p>I have a wrt350n v2, and flashed it with the latest orion rc. Everything works except internet. I have 2 strange ports:</p><p>Eth0 (has same mac as lan, uses data, no ip)<br />Wan (uses wan, cannot get ANY connection)</p><p>When my modem starts, it flashes the &quot;link&quot; led, so I guess it cannot communicate with the router. Anyone has any idea?</p><p>Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p142913">
				<div class="post-metadata">
					<div class="post-num">Post #1028</div>
					<div class="post-author">maddes.b</div>
					<div class="post-datetime">
						5 Sep 2011, 23:39					</div>
				</div>
				<div class="post-content content">
					<p>@Tischnoetentoet:<br />Currently this seems to be a setup related issue, not something Orion Hardware specific or build specific (that&#039;s the topic of this thread).<br />Please search a fitting thread or create a new one (unless you find Kernel oops in your logs). Thanks.</p><p>Despite that, here are some info and thoughts about your problem.</p><p>First, the information given is way too insufficient.<br />Examples:<br /> * Did you check the status page in the web interface? Did you check the logs? Anything special there?<br /> * What does &quot;orion rc&quot; mean? Are you using Backfire 10.03.1-rc5? Or latest trunk from snapshots or your own build?<br /> * Can you access the Luci interface from your PC? Or do you use an alternate web interface like X-Wrt? Or do you use uci on the console?<br /> * How did you setup your WAN access? PPoE, DHCP, static? What did the provider tell you to use?<br /> * Did you read through the <a href="http://wiki.openwrt.org/">Wiki</a>? What pages did you follow?</p><p>Second, I assume you mean a DSL modem, not an old analog one.<br />Then &quot;Link&quot; is often for the link to your provider. The connection to the router is called &quot;LAN&quot; most of the time.<br />So check out your modem manual to make sure.</p><p>If the &quot;link&quot; LED is for LAN access, then blinking normally means that there is traffic.<br />Check that your PC uses your router as your gateway, and that PC and router are in the same subnet.</p><p>Good luck<br />Maddes</p>											<p class="post-edited">(Last edited by <strong>maddes.b</strong> on 5 Sep 2011, 23:43)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p142939">
				<div class="post-metadata">
					<div class="post-num">Post #1029</div>
					<div class="post-author">Tischnoetentoet</div>
					<div class="post-datetime">
						6 Sep 2011, 09:36					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for your reply. </p><p>I used this one:</p><p><a href="http://downloads.openwrt.org/backfire/10.03.1-rc5/orion/openwrt-wrt350nv2-squashfs-webupgrade.img">http://downloads.openwrt.org/backfire/1 … pgrade.img</a></p><p>Everything worked, I could access the router (via the Luci interface). Wireless worked, my internal network including DHCP (internal) worked. However, WAN via DHCP did not work, somehow it could not communicate with my (cable) modem.</p><p>After trying to fix it for 4 hours, I decided to just buy a new router (NETGEAR WNDR4000), which is much more stable and faster.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p142950">
				<div class="post-metadata">
					<div class="post-num">Post #1030</div>
					<div class="post-author">Slowmo</div>
					<div class="post-datetime">
						6 Sep 2011, 11:50					</div>
				</div>
				<div class="post-content content">
					<p>Hi, I have a small problem with Orion as well. When using a build from trunk, my wireless LED does not work on WRT350Nv2.<br />What I see from luci configuration is:<br /></p><div class="codebox"><pre><code>Name:          Wireless LED (green)
LED Name:      ath9k-phy0
Default state: not checked
Trigger:       netdev
Device:        wlan0
Trigger Mode:  Link On; Transmit; Receive</code></pre></div><p>In kernel log there is a line which could indicate the problem:<br /></p><div class="codebox"><pre><code>leds-gpio: probe of leds-gpio failed with error -22</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p144427">
				<div class="post-metadata">
					<div class="post-num">Post #1031</div>
					<div class="post-author">maddes.b</div>
					<div class="post-datetime">
						25 Sep 2011, 14:00					</div>
				</div>
				<div class="post-content content">
					<p>I completely bricked my WRT350N v2 (test device, not my prod device) by killing my U-Boot partition.<br />This came while trying to adopt the Lantiq&#039;s <a href="https://dev.openwrt.org/browser/trunk/target/linux/lantiq/patches-3.0/210-mtd_uimage_split.patch">210-mtd_uimage_split.patch</a> for Orion.<br />Unfortunately it doesn&#039;t do any sanity checks, so suddenly the complete flash became &quot;rootfs_data&quot; and got formatted with JFFS2.<br />I got a connection with may USB JTAG cable, with DirkNL&#039;s help I could run a zImage from RAM with NFS root and found out what was missing to setup the system for reflashing the U-Boot partition.<br />Will try to collect all information in this post (if there&#039;s not already one containing all).</p><p><span class="bbu"><strong>Important Notes:</strong></span><br />* As long as your U-Boot boots you have better options to recover your device (see <a href="http://wiki.openwrt.org/toh/linksys/wrt350nv2#flashing.and.recovery.methods">WRT350N v2 wiki page</a>)<br />* As long as your device is working make a backup of <span class="bbu">all</span> mtd partitions, so you are able to recover all of them when bricked.</p><p><span class="bbu">My setup:</span><br />* Windows 7 Ultimate 64-Bit<br />* No parallel port (damn!) or serial port on that PC<br />* Amontec <a href="http://www.amontec.com/jtagkey2.shtml">JTAGkey2</a> (USB JTAG, fully compatible to first JTAGkey, but with RTCK support, wider voltage conversion, etc.)<br />* <a href="http://openocd.sourceforge.net/">OpenOCD</a> 0.5.0, Windows build from <a href="http://www.freddiechopin.info/">Freddie Chopin</a><br />* Serial connection to WRT350N v2<br />* Virtual Machine with Debian 6.0 &quot;Squeeze&quot; (AMD64) for running a NFS server (package nfs-kernel-server) for the bricked router to get a root filesystem. I use a bridged interface, so that the VM is directly in the network.<br />&nbsp; &nbsp;Unfortunately it seems a NFS server on an ARM 64-Bit machine like the Orion chipset doesn&#039;t seem to work. Also EXT2/3/4 is recommended for exporting via NFS, this also failed on my WRT350N v2 (ext3 on USB stick).<br />&nbsp; &nbsp;This VM is also useful to revive your device through &quot;download mode&quot; with a modified upslug2 (see <a href="http://wiki.openwrt.org/toh/linksys/wrt350nv2#flashing.and.recovery.methods">wiki</a> and <a href="https://forum.openwrt.org/viewtopic.php?pid=121911#p121911">post #953</a>).<br />* Another router with DHCP that can send DHCP options to the NFS kernel on the bricked router. I used a router running OpenWrt, otherwise the DHCP of Debian inside VM could be used too.</p><p><span class="bbu">JTAG connection:</span><br /><a href="http://www.amontec.com/jtag_pinout.shtml">Amontec&#039;s 20-pin ARM JTAG header layout</a> is ARM standard.<br />Amontec&#039;s <a href="http://www.amontec.com/jtagkey2.shtml">JTAGkey2</a> also supports ARM&#039;s RTCK for adaptive clocking.</p><p>Connected all cables from JTAGkey2 adapter to WRT350Nv2 board, but with TDI and TMS switched (pins 5 &lt;-&gt; 7) (see <a href="https://forum.openwrt.org/viewtopic.php?pid=74212#p74212">post #165</a> from buytenh/DirkNL).<br />I also switched the corresponding VSS grounds (pins 6 &lt;-&gt; 8).<br />On Amontec&#039;s JTAGkey2 pin 1 has a red cover and pin 20 a black cover.<br /><span class="postimg"><img src="http://ftp.maddes.net/hardware/WRT350Nv2/WRT350Nv2_JTAG_small.jpg" alt="http://ftp.maddes.net/hardware/WRT350Nv2/WRT350Nv2_JTAG_small.jpg" /></span></p><p>TODO: Build OpenWrt image with NFS root; NFS server setup (/etc/exports, /etc/hosts.allow)</p><p><span class="bbu">OpenOCD configuration:</span><br />* Extracted OpenOCD 0.5.0<br />* Installed its libusb ft2232 drivers for my Amontec JTAGkey2<br />* Created &quot;wrt350nv2.cfg&quot; in its board folder<br /></p><div class="codebox"><pre><code># Linksys WRT350Nv2 

# SoC: Marvell Orion 88F5181 with Feroceon CPU (ARMv5TE)
#      Documentation at http://www.embeddedarm.com/
#      under Support -&gt; Documentation -&gt; Third-Party manuals
#                    -&gt; MV88F5182 files (sister SoC with SATA)

set CPUTAPID 0x07926041
source [find target/feroceon.cfg]

# use RCLK (adaptive clock speed), fallback 3 MHz = 3000KHz
# (otherwise use &quot;adapter_khz&quot;, before 0.5.0 use &quot;jtag_khz&quot;, before 0.2.0 use &quot;jtag_speed&quot;)
jtag_rclk 3000

arm7_9 dcc_downloads enable
arm7_9 fast_memory_access enable

# define NOR flash bank
# (TODO: can not be written to, seems some register values are missing in init)
set _FLASHNAME $_CHIPNAME.flash
flash bank $_FLASHNAME cfi 0xff800000 0x00800000 1 1 $_TARGETNAME jedec_probe</code></pre></div><p>* Setup hardware as described in OpenOCD documentation, chapter 5.1 &quot;Hooking up the JTAG Adapter&quot;<br />* Called: &quot;bin/openocd-0.5.0.exe&quot; -f &quot;interface/jtagkey2.cfg&quot; -f &quot;board/wrt350nv2.cfg&quot;<br />* Connected via telnet to localhost:4444<br />** Checked status via &quot;targets&quot; command<br />** dump_image from flash at 0xff800000 worked (as expected one JFFS2 marker and lots of 0xff)<br />** If your U-Boot is still working then the device is already initialized by U-Boot. You can just halt it. But you should set the correct MAC address (see label on device), as the typical 00:00:00:00:51:81 always failed me to get DHCP info.<br /></p><div class="codebox"><pre><code>halt

# when U-Boot started, then just set the correct MAC address in the already moved registers
mww 0xF1072418 0xAABBCCDD
mww 0xF1072414 0x0000EEFF</code></pre></div><p>** Otherwise halt the device via a reset. Then initialize the WRT350N&#039;s device registers with a script from DirkNL, not 100% but allows to boot zImage from RAM.<br /></p><div class="codebox"><pre><code>init
reset init

#ram latency settings
mww 0xD0001400 0x03148400
mww 0xD0001404 0x04041000
mww 0xD0001408 0x11602220
mww 0xD000140C 0x0000040C
mww 0xD0001410 0x00000000
mww 0xD0001414 0x00000000
mww 0xD0001418 0x00000000
mww 0xD000141C 0x00000062
mww 0xD0001420 0x00000000

#additional SDRAM settings
mww 0xF10014C0 0x071F128A
mww 0xF10014C4 0x071F128A

#ram size register settings
mww 0xD0001504 0x01FF0001
mww 0xD000150C 0x00000000
mww 0xD0001510 0x20000000
mww 0xD0001514 0x00000000
mww 0xD000151C 0x00000000

#ram init
mww 0xD0001480 0x00000001

#serial setup
mww 0xD001200C 0x83
mww 0xD0012000 0x5A
mww 0xD001200C 0x03

#serial test
mww 0xD0012000 0x30
mww 0xD0012000 0x31
mww 0xD0012000 0x32
mww 0xD0012000 0x33
mww 0xD0012000 0x34

#CPU map registers
mww 0xD0020060 0x00FF7941
mww 0xD0020064 0xF0000000

#cpu pci-e
mww 0xD0020100 0x00000003
mww 0xD0020104 0x00000000

#interrupt
mww 0xD0020204 0x106203C9

#mac (NOTE: use value from label on your device)
mww 0xD0072418 0xAABBCCDD
mww 0xD0072414 0x0000EEFF

#gpio
mww 0xD0010100 0x0000006E
mww 0xD0010104 0xFFFFF21C
mww 0xD0010108 0x00000000
mww 0xD001010C 0x00000530
mww 0xD0010110 0x0000054E
mww 0xD0010114 0x00000591
mww 0xD0010118 0x00000000
mww 0xD001011C 0x00000010

#PCI-e
mww 0xD0041804 0x01FF0001
mww 0xD0041808 0x00000000
mww 0xD004180C 0x00000000
mww 0xD00418F8 0x8000003C
mww 0xD00418FC 0x0000010B

#PCI
mww 0xD0030D3C 0x00000009
mww 0xD0030C00 0x2107E371
mww 0xD0030C78 0x8001380C
mww 0xD0031D58 0x00000100
mww 0xD004 0x3F2A3B0B

#PCI/MPP
mww 0xD0031D1C 0x03F3FFFF

#MPP
mww 0xD0010000 0x00000003
mww 0xD0010004 0x11110010
mww 0xD0010050 0x00001111
mww 0xD0010008 0x03FF0000
mww 0xD0010010 0x10410636

#NAND flash control register
mww 0xD00104E8 0xFFFF0000

#register move
mww 0xD0020080 0xF1000000</code></pre></div><p>** Boot a zImage by DirkNL with NFS support<br /></p><div class="codebox"><pre><code>load_image /path/to/zImage 0x00400000 bin
resume 0x00400000</code></pre></div><p>* Now continue on the serial connection to the bricked router. You should see the kernel boot log, that the device got its IP plus DHCP options and is now loading from the NFS root.<br />&nbsp; &nbsp;There will be several errors, but normally these can be ignored.<br />&nbsp; &nbsp;Hit enter and execute the following commands.<br /></p><div class="codebox"><pre><code>mount -t proc proc /proc
mount -t sysfs sysfs /sys
mount -t tmpfs tmpfs /dev
mkdir -p /dev/pts ; mount -t devpts devpts /dev/pts
mount -t tmpfs tmpfs /tmp
mkdir -p /dev/shm
mknod -m 666 ./dev/null c 1 3
mknod -m 644 ./dev/urandom c 1 9

passwd
/etc/init.d/dropbear start

cat /proc/mtd</code></pre></div><p>This gives you SSH access to the bricked device, now just copy back the original contents of the mtd partitions to unbrick your device. Especially U-Boot and the eRcOmM part have to be intact.<br />Use the output of &quot;cat /proc/mtd&quot; above to flash the correct partitions.<br />Example:<br /></p><div class="codebox"><pre><code>dd if=lang.wrt350nv2.org of=/dev/mtdblock2
dd if=nvram.wrt350nv2.org of=/dev/mtdblock3
dd if=u-boot.wrt350nv2.org of=/dev/mtdblock4
dd if=eRcOmM_do_not_touch.wrt350nv2.org of=/dev/mtdblock5
dd if=openwrt-wrt350nv2-squashfs.img of=/dev/mtdblock5</code></pre></div><p><span class="bbu">Failures:</span><br />* &quot;halt&quot; doesn&#039;t work, but &quot;reset halt/init&quot; always succeeds. <span class="bbu">Update:</span> &quot;halt&quot; always works when U-Boot has initialized the device, so DirkNL&#039;s init sequence needs some more enhancement.<br />* Flashing directly doesn&#039;t work (registers?). I get OpenOCD errors even when device was initialized by U-Boot, seems OpenOCD doesn&#039;t know this flash.<br />* Connected via gdb to localhost:3333, but couldn&#039;t load/execute an ramdisk image (needs to be tested again)</p><p><span class="bbu">Related collected info:</span><br />* From Wiki:<br />&nbsp; <a href="http://wiki.openwrt.org/toh/linksys/wrt350nv2#jtag">WRT350N v2 info page</a> (contains as of June 2012 only the information from this post)<br />&nbsp; <a href="http://wiki.openwrt.org/doc/hardware/port.jtag">JTAG</a> (with sub-pages and lots of links)<br />* From Forum:<br />&nbsp; <a href="https://forum.openwrt.org/viewtopic.php?pid=66943#p66943">posts #66 - #68</a> (pictures of board)<br />&nbsp; <a href="https://forum.openwrt.org/viewtopic.php?pid=71276#p71276">posts #123-125</a> (link to <a href="http://forum.sparkfun.com/viewtopic.php?t=8751">SparkFun Electronics forum thread: flashing marvell feroceon 88f5181</a>)<br />&nbsp; <a href="https://forum.openwrt.org/viewtopic.php?pid=74374#p74374">post #168</a> (DirkNL explaining what Buyenth and he did)<br />&nbsp; <a href="https://forum.openwrt.org/viewtopic.php?pid=74650#p74650">post #178 &amp; 182</a> (relghuar&#039;s experience)<br />* From Internet:<br />&nbsp; <a href="http://openocd.berlios.de/doc/html/Debug-Adapter-Hardware.html#Debug-Adapter-Hardware">Hardware list from OpenOCD</a><br />&nbsp; <a href="http://buffalo.nas-central.org/index.php/JTAG_%26_OpenOCD_for_LS-Pro">JTAG with OpenOCD on LS-Pro</a> (also an Orion chipset)</p><br /><p><span class="bbu">Building OpenOCD on and for Linux</span>: (here on Debian 6.0 &quot;Squeeze&quot; in a Virtual Machine (VM) with VirtualBox)<br /></p><div class="codebox"><pre><code>0.) prerequisites
aptitude install git-core libtool
# USB must be enabled/present for ftdx2xxx test (e.g. Virtual Machine: enable USB)

1.) FTDI library
# prepare working directory
cd ~/work
[ ! -d ftdi ] &amp;&amp; mkdir ftdi
cd ftdi
# get and extract files
wget -N http://www.ftdichip.com/Drivers/D2XX/Linux/libftd2xx1.0.4.tar.gz
tar -xvf libftd2xx1.0.4.tar.gz
cd libftd2xx1.0.4
# fix some stuff
chmod -v -x *.h *.txt
find build -type f -name &quot;*.so*&quot; -print0 | xargs -0 chmod -v -x
# install to /usr, unlike README.dat which says /usr/local
BASEDIR=/usr
cp -v *.h ${BASEDIR}/include/
cd build/i386
cp -v libftd2xx* ${BASEDIR}/lib
ln -s libftd2xx.so.1.0.4 ${BASEDIR}/lib/libftd2xx.so.0
ln -s libftd2xx.so.0 ${BASEDIR}/lib/libftd2xx.so
# if you want to uninstall:
#  rm ${BASEDIR}/include/ftd2xx.h ${BASEDIR}/include/WinTypes.h
#  rm ${BASEDIR}/lib/libftd2xx* 

2.) OpenOCD
cd ~/work
mkdir -p openocd/source
cd openocd/source

# initial checkout (first time)
git clone git://openocd.git.sourceforge.net/gitroot/openocd/openocd .

# update source (later times)
git pull 

# prepare build
./bootstrap
./configure --enable-maintainer-mode --enable-ft2232_ftd2xx
#--enable-maintainer-mode (necessary to create &quot;version.texi&quot;)
#
#--enable-ft2232_ftd2xx
#--with_ftd2xx_linux_tardir=${HOME}/work/ftdi/libftd2xx1.0.4
#--with-ftd2xx-lib=shared
#--with-ftd2xx-lib=static
#
#--enable-ft2232_libftdi
#
#--enable-usbprog

# do build and install
make
make install</code></pre></div>											<p class="post-edited">(Last edited by <strong>maddes.b</strong> on 24 Jun 2012, 02:56)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p144429">
				<div class="post-metadata">
					<div class="post-num">Post #1032</div>
					<div class="post-author">StrikerNL</div>
					<div class="post-datetime">
						25 Sep 2011, 14:16					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>maddes.b wrote:</cite><blockquote><p>words.</p></blockquote></div><p>Matthias, get in touch with Dirk. Do you still have his e-mail? He restored his bricked WRT350n through JTAG (u-boot gone/broken). He&#039;ll be able to help you.</p><p>As I recall, it was pretty lowlevel stuff by the way. Manually initialising memory registers et cetera. Way beyond my own expertise <img src="https://forum.openwrt.org/img/smilies/tongue.png" width="15" height="15" alt="tongue" /></p>											<p class="post-edited">(Last edited by <strong>StrikerNL</strong> on 25 Sep 2011, 14:18)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p145496">
				<div class="post-metadata">
					<div class="post-num">Post #1033</div>
					<div class="post-author">StrikerNL</div>
					<div class="post-datetime">
						10 Oct 2011, 10:44					</div>
				</div>
				<div class="post-content content">
					<p>Me and DirkNL have been messing around trying to get the keys (reset/WPS) to work, we followed most of the instructions in <a href="https://forum.openwrt.org/viewtopic.php?pid=120958#p120958">this post</a> (<em>why is wrt350n-v2-setup.c in the kernel still not patched with the EV_KEY type?</em>). It took some doing but finally we got the buttons to show up in /proc/interrupts and the counters incrementing on key press.</p><p>However, in the end, we&#039;re stuck at the hotplug scripts; we created scripts in /etc/hotplug.d/button/*, but they do not seem to get called at all. We do have the relevant module(s) loaded.</p><p>Does anyone have any idea where we might be going wrong?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p145498">
				<div class="post-metadata">
					<div class="post-num">Post #1034</div>
					<div class="post-author">Nilfred</div>
					<div class="post-datetime">
						10 Oct 2011, 11:25					</div>
				</div>
				<div class="post-content content">
					<p>@maddes.b: I don&#039;t own a JTAG cable and my CA-42 pickup annoying noise (is intended for emergency purposes only).<br />I suspect, for the post date, that same luck taints your WNR854T build <img src="https://forum.openwrt.org/img/smilies/roll.png" width="15" height="15" alt="roll" /><br />Ping me when that pitfall gets cleared. I will test your patch/build way after You <img src="https://forum.openwrt.org/img/smilies/tongue.png" width="15" height="15" alt="tongue" /><br />Is your <a href="https://dev.openwrt.org/attachment/ticket/8183/trunk_orion_flexible_kernel_mtd_support.patch">old patch</a> what we are testing? Show me the source, please.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p145500">
				<div class="post-metadata">
					<div class="post-num">Post #1035</div>
					<div class="post-author">Nilfred</div>
					<div class="post-datetime">
						10 Oct 2011, 11:40					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>StrikerNL wrote:</cite><blockquote><p>Does anyone have any idea where we might be going wrong?</p></blockquote></div><p>See ticket <a href="https://dev.openwrt.org/ticket/8729">#8729</a>: Updated Setup to handle IRQ on reset button without gpio_keys module (both modes)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p145512">
				<div class="post-metadata">
					<div class="post-num">Post #1036</div>
					<div class="post-author">StrikerNL</div>
					<div class="post-datetime">
						10 Oct 2011, 13:58					</div>
				</div>
				<div class="post-content content">
					<p>@Nilfred is this WNR854T specific? Or should this also work for WRT350NV2? Or does it need adjusting (by us)?</p>											<p class="post-edited">(Last edited by <strong>StrikerNL</strong> on 10 Oct 2011, 14:03)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p145533">
				<div class="post-metadata">
					<div class="post-num">Post #1037</div>
					<div class="post-author">Nilfred</div>
					<div class="post-datetime">
						10 Oct 2011, 20:53					</div>
				</div>
				<div class="post-content content">
					<p>@StrikerNL: I don&#039;t know <img src="https://forum.openwrt.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /><br />I test <strong>Tanguy</strong>&#039;s patch for the LEDs handling, WNR854T doesn&#039;t have a WPS button to play with, but reset works as seen in <a href="http://tanguy.wdscript.fr/index.php?q=wnr854t">his site</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p145540">
				<div class="post-metadata">
					<div class="post-num">Post #1038</div>
					<div class="post-author">maddes.b</div>
					<div class="post-datetime">
						10 Oct 2011, 23:09					</div>
				</div>
				<div class="post-content content">
					<p>@Nilfred:<br />The issue that bricked my test device is fixed, already verified on my prod device - still working <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />But that&#039;s not what you could test for me.</p><p>I cleaned up the image makefile for the Orion generic target, and also changed WNR854T creation to use the kernel partition directly for the uImage, and not as a JFFS2 partition with an uImage file.<br />Now I&#039;m interested if this boots.</p><p>I built flash and ramdisk images of trunk r28395, available <a href="ftp://ftp.maddes.net/openwrt/trunk/orion/wnr854t_direct_uimage_test_r28395/">here</a>.<br />The svn diff is directly in the first directory.<br />Try first the ramdisk image and if possible flash the squashfs or jffs2 image.<br />If you flash an image, then make sure you have still an image of your current installation <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />As this has a fixed mtd layout, your U-Boot should be secure, and you will be able to flash from U-Boot as a last resort.</p><p>If this works/boots, then the image structure for WNR854T and WRT350Nv2 can be aligned, which is a prerequisite for dynamic flexible kernel size support (very long term <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> ).</p><p><span class="bbu">Side note for flashing the new images:</span><br />As the first partition looks different the file lib/upgrade/platform.sh has to be adopted like this:<br /></p><div class="codebox"><pre><code>        # Netgear WNR854T (on old images the kernel partition is jffs2 which holds the uimage as a file)
        &#039;Netgear WNR854T&#039;)
               [ &quot;${magic}&quot; != &#039;2705&#039; ] &amp;&amp; [ &quot;${magic}&quot; != &#039;8519&#039; ] &amp;&amp; {
                       echo &quot;Invalid image type ${magic}.&quot;
                       return 1
               }</code></pre></div>											<p class="post-edited">(Last edited by <strong>maddes.b</strong> on 16 Oct 2011, 12:56)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p146122">
				<div class="post-metadata">
					<div class="post-num">Post #1039</div>
					<div class="post-author">Nilfred</div>
					<div class="post-datetime">
						18 Oct 2011, 20:19					</div>
				</div>
				<div class="post-content content">
					<p>Step 1: Prepare the host<br /></p><div class="quotebox"><blockquote><p>$ lsb_release -dcs<br />Ubuntu 10.04.3 LTS<br />lucid<br />$ sudo apt-get install tftpd-hpa<br />$ sudo cp ~/Descargas/OpenWrt/orion/r28395/ramdisk/openwrt-wnr854t-uImage.mini.ramdisk /var/lib/tftpboot<br />$ screen /dev/ttyUSB0 115200<br />Marvell&gt;&gt; printenv<br />ipaddr=192.168.1.1<br />serverip=192.168.1.2<br /># Ctrl-a k y<br />$ sudo ifconfig eth0 192.168.1.2 up<br />$ screen /dev/ttyUSB0 115200</p></blockquote></div><p>Step 2: Test ramdisk image<br /></p><div class="codebox"><pre><code>Marvell&gt;&gt; tftpboot 0x400000 openwrt-wnr854t-uImage.mini.ramdisk
Using egiga0 device
TFTP from server 192.168.1.2; our IP address is 192.168.1.1
Filename &#039;openwrt-wnr854t-uImage.mini.ramdisk&#039;.
Load address: 0x400000
Loading: #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         ####################################
done
Bytes transferred = 2179872 (214320 hex)
Marvell&gt;&gt; bootm 0x400000
## Booting image at 00400000 ...
   Image Name:   Linux-3.0.3
   Created:      2011-10-10  19:49:17 UTC
   Image Type:   ARM Linux Kernel Image (uncompressed)
   Data Size:    2179808 Bytes =  2.1 MB
   Load Address: 00008000
   Entry Point:  00008000
   Verifying Checksum ... OK
OK

Starting kernel ...

Uncompressing Linux... done, booting the kernel.
Linux version 3.0.3 (maddes@devdebian6-amd64) (gcc version 4.5.4 20110808 (prere
lease) (Linaro GCC 4.5-2011.08) ) #2 Mon Oct 10 21:49:08 CEST 2011
CPU: Feroceon [41069260] revision 0 (ARMv5TEJ), cr=a0053177
CPU: VIVT data cache, VIVT instruction cache
Machine: Netgear WNR854T
Clearing invalid memory bank 0KB@0xffffffff
Clearing invalid memory bank 0KB@0xffffffff
Clearing invalid memory bank 0KB@0xffffffff
Ignoring unrecognised tag 0x00000000
Ignoring unrecognised tag 0x00000000
Ignoring unrecognised tag 0x00000000
Ignoring tag cmdline (using the default kernel command line)
Memory policy: ECC disabled, Data cache writeback
Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 8128
Kernel command line: root=/dev/mtdblock1 rootfstype=squashfs,jffs2 noinitrd cons
ole=ttyS0,115200
PID hash table entries: 128 (order: -3, 512 bytes)
Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
Memory: 32MB = 32MB total
Memory: 25984k/25984k available, 6784k reserved, 0K highmem
Virtual kernel memory layout:
    vector  : 0xffff0000 - 0xffff1000   (   4 kB)
    fixmap  : 0xfff00000 - 0xfffe0000   ( 896 kB)
    DMA     : 0xffc00000 - 0xffe00000   (   2 MB)
    vmalloc : 0xc2800000 - 0xfd800000   ( 944 MB)
    lowmem  : 0xc0000000 - 0xc2000000   (  32 MB)
    modules : 0xbf000000 - 0xc0000000   (  16 MB)
      .init : 0xc0008000 - 0xc03b3000   (3756 kB)
      .text : 0xc03b3000 - 0xc0630000   (2548 kB)
      .data : 0xc0630000 - 0xc06436c0   (  78 kB)
       .bss : 0xc06436e4 - 0xc064fa50   (  49 kB)
NR_IRQS:64
sched_clock: 32 bits at 166MHz, resolution 5ns, wraps every 25769ms
Calibrating delay loop... 331.77 BogoMIPS (lpj=1658880)
pid_max: default: 32768 minimum: 301
Mount-cache hash table entries: 512
CPU: Testing write buffer coherency: ok
NET: Registered protocol family 16
Orion ID: MV88F5181-Rev-B1. TCLK=166666667.
MPP setup: unknown orion5x variant (dev 0x5181 rev 0x3)
Applying Orion-1/Orion-NAS PCIe config read transaction workaround
PCI: bus0: Fast back to back transfers disabled
PCI: bus1: Fast back to back transfers enabled
pci 0000:01:07.0: BAR 0: assigned [mem 0xe8000000-0xe800ffff]
pci 0000:01:07.0: BAR 0: set to [mem 0xe8000000-0xe800ffff] (PCI address [0xe800
0000-0xe800ffff])
pci 0000:01:07.0: BAR 1: assigned [mem 0xe8010000-0xe801ffff]
pci 0000:01:07.0: BAR 1: set to [mem 0xe8010000-0xe801ffff] (PCI address [0xe801
0000-0xe801ffff])
bio: create slab &lt;bio-0&gt; at 0
Switching to clocksource orion_clocksource
NET: Registered protocol family 2
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 1024 (order: 1, 8192 bytes)
TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
TCP: Hash tables configured (established 1024 bind 1024)
TCP reno registered
UDP hash table entries: 256 (order: 0, 4096 bytes)
UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
NET: Registered protocol family 1
squashfs: version 4.0 (2009/01/31) Phillip Lougher
JFFS2 version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006
 Red Hat, Inc.
msgmni has been set to 50
io scheduler noop registered
io scheduler deadline registered (default)
Serial: 8250/16550 driver, 2 ports, IRQ sharing disabled
serial8250.0: ttyS0 at MMIO 0xf1012000 (irq = 3) is a 16550A
console [ttyS0] enabled
physmap platform flash device: 00800000 at f4000000
physmap-flash.0: Found 1 x16 devices at 0x0 in 16-bit bank. Manufacturer ID 0x00
0089 Chip ID 0x000017
Intel/Sharp Extended Query Table at 0x0031
Intel/Sharp Extended Query Table at 0x0031
Using buffer write method
cfi_cmdset_0001: Erase suspend on write enabled
Using physmap partition information
Creating 4 MTD partitions on &quot;physmap-flash.0&quot;:
0x000000000000-0x000000110000 : &quot;kernel&quot;
mtd: partition &quot;kernel&quot; must either start or end on erase block boundary or be s
maller than an erase block -- forcing read-only
0x000000110000-0x000000760000 : &quot;rootfs&quot;
mtd: partition &quot;rootfs&quot; must either start or end on erase block boundary or be s
maller than an erase block -- forcing read-only
mtd: partition &quot;rootfs&quot; set to be root filesystem
split_squashfs: no squashfs found in &quot;physmap-flash.0&quot;
0x000000760000-0x0000007a0000 : &quot;uboot&quot;
0x000000000000-0x000000760000 : &quot;image&quot;
mv643xx_eth: MV-643xx 10/100/1000 ethernet driver version 1.4
mv643xx_eth smi: probed
mv643xx_eth_port mv643xx_eth_port.0: eth0: port 0 with MAC address 00:00:00:00:5
1:81
i2c /dev entries driver
TCP westwood registered
NET: Registered protocol family 17
Distributed Switch Architecture driver version 0.1
eth0[0]: detected a Marvell 88E6131 switch
dsa slave smi: probed
802.1Q VLAN Support v1.8
drivers/rtc/hctosys.c: unable to open rtc device (rtc0)
Freeing init memory: 3756K
- preinit -
Press the [f] key and hit [enter] to enter failsafe mode
- regular preinit -
- init -

Please press Enter to activate this console. mv643xx_eth_port mv643xx_eth_port.0
: eth0: link up, 1000 Mb/s, full duplex, flow control disabled
device lan3 entered promiscuous mode
device eth0 entered promiscuous mode
device eth0 left promiscuous mode
br-lan: port 1(lan3) entering disabled state
device eth0 entered promiscuous mode
device lan4 entered promiscuous mode
br-lan: port 2(lan4) entering disabled state
device lan1 entered promiscuous mode
br-lan: port 3(lan1) entering disabled state
lan1: link up, 1000 Mb/s, full duplex, flow control disabled
br-lan: port 3(lan1) entering forwarding state
br-lan: port 3(lan1) entering forwarding state
device lan2 entered promiscuous mode
br-lan: port 4(lan2) entering disabled state
Compat-wireless backport release: compat-wireless-2011-09-28-6-g8163a60
Backport based on wireless-testing.git master-2011-10-05
cfg80211: Calling CRDA to update world regulatory domain
cfg80211: World regulatory domain updated:
cfg80211:     (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp)
cfg80211:     (2402000 KHz - 2472000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (2457000 KHz - 2482000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (2474000 KHz - 2494000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (5170000 KHz - 5250000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (5735000 KHz - 5835000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
PPP generic driver version 2.4.2
ip_tables: (C) 2000-2006 Netfilter Core Team
NET: Registered protocol family 24
nf_conntrack version 0.5.0 (464 buckets, 1856 max)



BusyBox v1.18.5 (2011-10-10 21:26:11 CEST) built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 ATTITUDE ADJUSTMENT (bleeding edge, r28395) ----------
  * 1/4 oz Vodka      Pour all ingredients into mixing
  * 1/4 oz Gin        tin with ice, strain into glass.
  * 1/4 oz Amaretto
  * 1/4 oz Triple sec
  * 1/4 oz Peach schnapps
  * 1/4 oz Sour mix
  * 1 splash Cranberry juice
 -----------------------------------------------------
root@OpenWrt:/# uci show network
network.loopback=interface
network.loopback.ifname=lo
network.loopback.proto=static
network.loopback.ipaddr=127.0.0.1
network.loopback.netmask=255.0.0.0
network.eth0=interface
network.eth0.ifname=eth0
network.wan=interface
network.wan.ifname=wan
network.wan.proto=dhcp
network.wan.hostname=openwrt
network.lan=interface
network.lan.ifname=lan1 lan2 lan3 lan4
network.lan.type=bridge
network.lan.proto=static
network.lan.ipaddr=192.168.1.1
network.lan.netmask=255.255.255.0
root@OpenWrt:/# opkg list-installed
base-files - 81-r28395
busybox - 1.18.5-1
crda - 1.1.1-1
dnsmasq - 2.58-1
dropbear - 0.53.1-4
firewall - 2-35
hotplug2 - 1.0-beta-4
iptables - 1.4.10-4
iptables-mod-conntrack - 1.4.10-4
iptables-mod-nat - 1.4.10-4
iw - 3.1-1
kernel - 3.0.3-1
kmod-ath - 3.0.3+2011-10-05-1
kmod-ath9k - 3.0.3+2011-10-05-1
kmod-ath9k-common - 3.0.3+2011-10-05-1
kmod-cfg80211 - 3.0.3+2011-10-05-1
kmod-crc-ccitt - 3.0.3-1
kmod-crypto-arc4 - 3.0.3-1
kmod-ipt-conntrack - 3.0.3-1
kmod-ipt-core - 3.0.3-1
kmod-ipt-nat - 3.0.3-1
kmod-ipt-nathelper - 3.0.3-1
kmod-mac80211 - 3.0.3+2011-10-05-1
kmod-ppp - 3.0.3-1
kmod-pppoe - 3.0.3-1
libc - 0.9.32-81
libgcc - 4.5-linaro-81
libip4tc - 1.4.10-4
libnl-tiny - 0.1-2
libuci - 2011-07-18.3-1
libxtables - 1.4.10-4
maddes - 1.0-1
mtd - 16
opkg - 618-1
ppp - 2.4.5-2
ppp-mod-pppoe - 2.4.5-2
uci - 2011-07-18.3-1
wireless-tools - 29-4
wpad-mini - 20110527-2
root@OpenWrt:/# df
Filesystem           1K-blocks      Used Available Use% Mounted on
tmpfs                    14872        36     14836   0% /tmp
tmpfs                      512         0       512   0% /dev
root@OpenWrt:/# ls /dev/mtd*
/dev/mtd0       /dev/mtd1ro     /dev/mtd3       /dev/mtdblock1
/dev/mtd0ro     /dev/mtd2       /dev/mtd3ro     /dev/mtdblock2
/dev/mtd1       /dev/mtd2ro     /dev/mtdblock0  /dev/mtdblock3
root@OpenWrt:/# cat /proc/mtd
dev:    size   erasesize  name
mtd0: 00110000 00020000 &quot;kernel&quot;
mtd1: 00650000 00020000 &quot;rootfs&quot;
mtd2: 00040000 00020000 &quot;uboot&quot;
mtd3: 00760000 00020000 &quot;image&quot;
root@OpenWrt:/# reboot
root@OpenWrt:/# br-lan: port 3(lan1) entering forwarding state
&lt;ýdevice eth0 left promiscuous mode
device lan2 left promiscuous mode
br-lan: port 4(lan2) entering disabled state
device lan1 left promiscuous mode
br-lan: port 3(lan1) entering disabled state
device lan4 left promiscuous mode
br-lan: port 2(lan4) entering disabled state
device lan3 left promiscuous mode
br-lan: port 1(lan3) entering disabled state
lan1: link down
Restarting system.

         __  __                      _ _
        |  \/  | __ _ _ ____   _____| | |
        | |\/| |/ _` | &#039;__\ \ / / _ \ | |
        | |  | | (_| | |   \ V /  __/ | |
        |_|  |_|\__,_|_|    \_/ \___|_|_|
 _   _     ____              _
| | | |   | __ )  ___   ___ | |_
| | | |___|  _ \ / _ \ / _ \| __|
| |_| |___| |_) | (_) | (_) | |_
 \___/    |____/ \___/ \___/ \__|  ** LOADER **
 ** MARVELL BOARD: RD-88F5181L-VOIP-GE LE GE RT v1.05

U-Boot 1.1.1 (Apr 18 2007 - 16:05:00) Marvell version: 1.7.3

DRAM CS[0] base 0x00000000   size  32MB
DRAM Total size  32MB
[8192kB@ff800000] Flash:  8 MB
Addresses 20M - 0M are saved for the U-Boot usage.
Mem malloc Initialization (20M - 16M): Done
*** Warning - bad CRC, using default environment


Soc: 88F5181 B1
CPU: ARM926 (Rev 0) running @ 500Mhz
SysClock = 166Mhz , TClock = 166Mhz


USB 0: host mode
PCI 0: PCI Express Root Complex Interface
PCI 1: Conventional PCI, speed = 33000000
Net:   egiga0 [PRIME]
Hit any key to stop autoboot:  0</code></pre></div><p>Step 3: Test old image<br /></p><div class="codebox"><pre><code>Marvell&gt;&gt; run standalone
### JFFS2 loading &#039;uImage&#039; to 0x400000
Scanning JFFS2 FS: .\ Unknown node type: 2006 len 12700 offset 0x33ce64       .
 Unknown node type: 2006 len 9032 offset 0x4ddcb8
Unknown node type: 2006 len 1228 offset 0x4ffb34                              \
Unknown node type: 2006 len 6828 offset 0x51e554                              .
 Unknown node type: 2006 len 7636 offset 0x53e22c                             .
 Unknown node type: 2006 len 11948 offset 0x55d154                            ..
..  Unknown node type: 2006 len 21536 offset 0x57abe0                         /
Unknown node type: 2006 len 1744 offset 0x59f930                              .
 Unknown node type: 2006 len 10264 offset 0x5bd7e8                            -
Unknown node type: 2006 len 7652 offset 0x5fe21c                              .
 Unknown node type: 2006 len 8100 offset 0x61e05c                             |
Unknown node type: e008 len 52 offset 0x74a34c
Unknown node type: e009 len 28 offset 0x74a380
Unknown node type: e009 len 28 offset 0x74a424                                .
done.
### JFFS2 load complete: 916992 bytes loaded to 0x400000
## Booting image at 00400000 ...
   Image Name:   Linux-2.6.37.4
   Created:      2011-04-11  17:56:15 UTC
   Image Type:   ARM Linux Kernel Image (uncompressed)
   Data Size:    916928 Bytes = 895.4 kB
   Load Address: 00008000
   Entry Point:  00008000
   Verifying Checksum ... OK
OK

Starting kernel ...

Uncompressing Linux... done, booting the kernel.
Linux version 2.6.37.4 (alfredo@pentacool) (gcc version 4.5.2 (Linaro GCC 4.5-20
11.02-0) ) #8 Mon Apr 11 14:56:12 ART 2011
CPU: Feroceon [41069260] revision 0 (ARMv5TEJ), cr=a0053177
CPU: VIVT data cache, VIVT instruction cache
Machine: Netgear WNR854T
Clearing invalid memory bank 0KB@0xffffffff
Clearing invalid memory bank 0KB@0xffffffff
Clearing invalid memory bank 0KB@0xffffffff
Ignoring unrecognised tag 0x00000000
Ignoring unrecognised tag 0x00000000
Ignoring unrecognised tag 0x00000000
Ignoring unrecognised tag 0x54410009
Ignoring unrecognised tag 0x41000403
Memory policy: ECC disabled, Data cache writeback
Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 8128
Kernel command line: root=/dev/mtdblock1 rootfstype=squashfs,jffs2 noinitrd cons
ole=ttyS0,115200
PID hash table entries: 128 (order: -3, 512 bytes)
Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
Memory: 32MB = 32MB total
Memory: 29956k/29956k available, 2812k reserved, 0K highmem
Virtual kernel memory layout:
    vector  : 0xffff0000 - 0xffff1000   (   4 kB)
    fixmap  : 0xfff00000 - 0xfffe0000   ( 896 kB)
    DMA     : 0xffc00000 - 0xffe00000   (   2 MB)
    vmalloc : 0xc2800000 - 0xfd800000   ( 944 MB)
    lowmem  : 0xc0000000 - 0xc2000000   (  32 MB)
    modules : 0xbf000000 - 0xc0000000   (  16 MB)
      .init : 0xc0008000 - 0xc0021000   ( 100 kB)
      .text : 0xc0021000 - 0xc024e000   (2228 kB)
      .data : 0xc024e000 - 0xc0260560   (  74 kB)
NR_IRQS:64
Calibrating delay loop... 332.59 BogoMIPS (lpj=1662976)
pid_max: default: 32768 minimum: 301
Mount-cache hash table entries: 512
CPU: Testing write buffer coherency: ok
NET: Registered protocol family 16
Orion ID: MV88F5181-Rev-B1. TCLK=166666667.
Applying Orion-1/Orion-NAS PCIe config read transaction workaround
PCI: bus0: Fast back to back transfers disabled
PCI: bus1: Fast back to back transfers enabled
pci 0000:01:07.0: BAR 0: assigned [mem 0xe8000000-0xe800ffff]
pci 0000:01:07.0: BAR 0: set to [mem 0xe8000000-0xe800ffff] (PCI address [0xe800
0000-0xe800ffff])
pci 0000:01:07.0: BAR 1: assigned [mem 0xe8010000-0xe801ffff]
pci 0000:01:07.0: BAR 1: set to [mem 0xe8010000-0xe801ffff] (PCI address [0xe801
0000-0xe801ffff])
bio: create slab &lt;bio-0&gt; at 0
Switching to clocksource orion_clocksource
NET: Registered protocol family 2
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 1024 (order: 1, 8192 bytes)
TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
TCP: Hash tables configured (established 1024 bind 1024)
TCP reno registered
UDP hash table entries: 256 (order: 0, 4096 bytes)
UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
NET: Registered protocol family 1
squashfs: version 4.0 (2009/01/31) Phillip Lougher
JFFS2 version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006
 Red Hat, Inc.
msgmni has been set to 58
io scheduler noop registered
io scheduler deadline registered (default)
Serial: 8250/16550 driver, 2 ports, IRQ sharing disabled
serial8250.0: ttyS0 at MMIO 0xf1012000 (irq = 3) is a 16550A
console [ttyS0] enabled
physmap platform flash device: 00800000 at f4000000
physmap-flash.0: Found 1 x16 devices at 0x0 in 16-bit bank. Manufacturer ID 0x00
0089 Chip ID 0x000017
Intel/Sharp Extended Query Table at 0x0031
Intel/Sharp Extended Query Table at 0x0031
Using buffer write method
cfi_cmdset_0001: Erase suspend on write enabled
cmdlinepart partition parsing not available
RedBoot partition parsing not available
Using physmap partition information
Creating 4 MTD partitions on &quot;physmap-flash.0&quot;:
0x000000000000-0x000000100000 : &quot;kernel&quot;
0x000000100000-0x000000760000 : &quot;rootfs&quot;
mtd: partition &quot;rootfs&quot; set to be root filesystem
mtd: partition &quot;rootfs_data&quot; created automatically, ofs=320000, len=440000
0x000000320000-0x000000760000 : &quot;rootfs_data&quot;
0x000000760000-0x0000007a0000 : &quot;uboot&quot;
0x000000000000-0x000000760000 : &quot;image&quot;
MV-643xx 10/100/1000 ethernet driver version 1.4
mv643xx_eth smi: probed
net eth0: port 0 with MAC address 00:00:00:00:51:81
i2c /dev entries driver
TCP westwood registered
NET: Registered protocol family 17
Distributed Switch Architecture driver version 0.1
eth0[0]: detected a Marvell 88E6131 switch
dsa slave smi: probed
802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;
All bugs added by David S. Miller &lt;davem@redhat.com&gt;
VFS: Mounted root (squashfs filesystem) readonly on device 31:1.
Freeing init memory: 100K
- preinit -
Press the [f] key and hit [enter] to enter failsafe mode
- regular preinit -
JFFS2 notice: (1302) jffs2_build_xattr_subsystem: complete building xattr subsys
tem, 1 of xdatum (0 unchecked, 0 orphan) and 2 of xref (0 dead, 0 orphan) found.
switching to jffs2
- init -

Please press Enter to activate this console. eth0: link up, 1000 Mb/s, full dupl
ex, flow control disabled
device lan3 entered promiscuous mode
device eth0 entered promiscuous mode
device lan4 entered promiscuous mode
lan1: link up, 1000 Mb/s, full duplex, flow control disabled
device lan1 entered promiscuous mode
br-lan: port 3(lan1) entering forwarding state
br-lan: port 3(lan1) entering forwarding state
device lan2 entered promiscuous mode
Compat-wireless backport release: compat-wireless-2011-01-31-26-gf7606f5
Backport based on wireless-testing.git master-2011-03-24
cfg80211: Calling CRDA to update world regulatory domain
cfg80211: World regulatory domain updated:
cfg80211:     (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp)
cfg80211:     (2402000 KHz - 2472000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (2457000 KHz - 2482000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (2474000 KHz - 2494000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (5170000 KHz - 5250000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (5735000 KHz - 5835000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)


BusyBox v1.17.3 (2011-04-11 06:32:56 ART) built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 ATTITUDE ADJUSTMENT (bleeding edge, r26358) ----------
  * 1/4 oz Vodka      Pour all ingredents into mixing
  * 1/4 oz Gin        tin with ice, strain into glass.
  * 1/4 oz Amaretto
  * 1/4 oz Triple sec
  * 1/4 oz Peach schnapps
  * 1/4 oz Sour mix
  * 1 splash Cranberry juice
 -----------------------------------------------------
root@OpenWrt:/# Marvell TOPDOG(R) 802.11 Wireless Network Driver version 0.12
PPP generic driver version 2.4.2
ieee80211 phy0: 88w8363 v4, 001b2fd746a0, STA firmware 2.1.4.25
ip_tables: (C) 2000-2006 Netfilter Core Team
NET: Registered protocol family 24
nf_conntrack version 0.5.0 (469 buckets, 1876 max)
xt_time: kernel timezone is -0000
u32 classifier
    Performance counters on
    input device check on
    Actions configured
Mirror/redirect action on

root@OpenWrt:/# cat /proc/mtd
dev:    size   erasesize  name
mtd0: 00100000 00020000 &quot;kernel&quot;
mtd1: 00660000 00020000 &quot;rootfs&quot;
mtd2: 00440000 00020000 &quot;rootfs_data&quot;
mtd3: 00040000 00020000 &quot;uboot&quot;
mtd4: 00760000 00020000 &quot;image&quot;
root@OpenWrt:/#</code></pre></div><p>Step 4: Save logfile<br /></p><div class="quotebox"><cite>screen command wrote:</cite><blockquote><p>Ctrl-a : hardcopy -h hardcopy1.txt</p></blockquote></div><p>Step 5: Flash new image within ramdisk image<br />TODO<br />RO rootfs may result from unaligned mtd to erase block.<br />Should I go ahead anyway?</p><p>PS: Newbies please: Don&#039;t full quote this long post!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p146130">
				<div class="post-metadata">
					<div class="post-num">Post #1040</div>
					<div class="post-author">maddes.b</div>
					<div class="post-datetime">
						18 Oct 2011, 21:19					</div>
				</div>
				<div class="post-content content">
					<p>Hello Nilfred,</p><p>a question first: you still can boot your old image and it is still working, correct?</p><p>Give me some time to analyze all the logs in detail.</p><p>Thanks for your daring braveness<br />Maddes</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p146137">
				<div class="post-metadata">
					<div class="post-num">Post #1041</div>
					<div class="post-author">Nilfred</div>
					<div class="post-datetime">
						18 Oct 2011, 22:51					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>maddes.b wrote:</cite><blockquote><p>you still can boot your old image and it is still working, correct?</p></blockquote></div><p>Correct: As shown in Step 3.<br />Indeed there is a show-stopper hidden step: Compare the logs before continue <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /><br /></p><div class="quotebox"><cite>meld wrote:</cite><blockquote><p>-0x000000000000-0x000000100000 : &quot;kernel&quot;<br />-0x000000100000-0x000000760000 : &quot;rootfs&quot;<br />+0x000000000000-0x000000110000 : &quot;kernel&quot;<br />+mtd: partition &quot;kernel&quot; must either start or end on erase block boundary or be s<br />+maller than an erase block -- forcing read-only<br />+0x000000110000-0x000000760000 : &quot;rootfs&quot;<br />+mtd: partition &quot;rootfs&quot; must either start or end on erase block boundary or be s<br />+maller than an erase block -- forcing read-only</p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p146205">
				<div class="post-metadata">
					<div class="post-num">Post #1042</div>
					<div class="post-author">maddes.b</div>
					<div class="post-datetime">
						19 Oct 2011, 21:00					</div>
				</div>
				<div class="post-content content">
					<p>The MTD partition issue is caused due to a different erase size for the flash on the WNR854T (128KiB vs. 64KiB on WRT350Nv2).<br />I already adopted my kernel size from 1088KiB to 1152KiB, so that my builds will work also on WNR854T.</p><p>For the dynamic kernel size patch I had the erase size already accounted.<br />But that comes after the squashfs test.</p><p>@Nilfred:<br />A new ramdisk image is available for tftpbooting <a href="ftp://ftp.maddes.net/openwrt/trunk/orion/build_28489/ramdisk/">here</a>.<br />Just need the tftpboot log for this ramdisk image.</p><p>See you soon.<br />Maddes</p>											<p class="post-edited">(Last edited by <strong>maddes.b</strong> on 19 Oct 2011, 21:46)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p146239">
				<div class="post-metadata">
					<div class="post-num">Post #1043</div>
					<div class="post-author">Nilfred</div>
					<div class="post-datetime">
						20 Oct 2011, 09:06					</div>
				</div>
				<div class="post-content content">
					<p>Short history: squashfs doesn&#039;t boot.</p><p>Intended test procedure:</p><div class="quotebox"><blockquote><p>sudo rm /var/lib/tftpboot/openwrt-wnr854t-uImage.mini.ramdisk<br />sudo cp ~/Descargas/OpenWrt/orion/r28489/ramdisk/openwrt-wnr854t-uImage.release+ipv6-luci.ramdisk /var/lib/tftpboot<br />cp ~/Descargas/OpenWrt/orion/r28489/openwrt-wnr854t-jffs2-128k.release+ipv6-luci.img ~/Descargas/OpenWrt/orion/r28489/openwrt-wnr854t-squashfs.release+ipv6-luci.img /var/www<br />sudo ifconfig eth0 192.168.1.2 up<br />screen /dev/ttyUSB0 115200<br />tftpboot 0x400000 openwrt-wnr854t-uImage.release+ipv6-luci.ramdisk<br />bootm 0x400000<br />Ctrl-a : hardcopy -h 854hardcopy4.txt<br />Ctrl-a k y<br />rm /etc/opkg/zzzmaddes.conf<br />sed -i -e &#039;s!http://.*$!http://192.168.1.2/openwrt/orion/r28475/packages!&#039; /etc/opkg.conf<br />sudo ln -s ~/Descargas/OpenWrt/orion/r28475 /var/www/openwrt/orion/r28475<br />sysupgrade -n <a href="http://192.168.1.2/openwrt-wnr854t-squashfs.release+ipv6-luci.img">http://192.168.1.2/openwrt-wnr854t-squa … 6-luci.img</a><br />sudo cp ~/Descargas/OpenWrt/orion/r28489/openwrt-wnr854t-jffs2-128k.release+ipv6-luci.img /var/lib/tftpboot<br />tftpboot 0x400000 openwrt-wnr854t-jffs2-128k.release+ipv6-luci.img<br />sysupgrade -n <a href="http://192.168.1.2/openwrt-wnr854t-jffs2-128k.release+ipv6-luci.img">http://192.168.1.2/openwrt-wnr854t-jffs … 6-luci.img</a></p></blockquote></div><p>Long history: <br />- ramdisk goes well, but log has serious serial interference that gedit tell me I try to open a binary file. I will try again later with another text editor.</p><p>Logged from here:<br />- Mess with opkg<br />- Try to install luci in ramdisk and fail<br />- sysupgrade to squashfs and fail to boot<br />- tftpboot jffs2-128k<br />- sysupgrade to jffs2-128k<br />- Install luci<br /></p><div class="codebox"><pre><code>root@OpenWrt:/# opkg list-installed
base-files - 82-r28489
busybox - 1.18.5-1
crda - 1.1.1-1
dnsmasq - 2.58-1
dropbear - 0.53.1-4
firewall - 2-35
hotplug2 - 1.0-beta-4
iptables - 1.4.10-4
iptables-mod-conntrack - 1.4.10-4
iptables-mod-nat - 1.4.10-4
iw - 3.1-1
kernel - 3.0.3-1
kmod-ath - 3.0.3+2011-10-05-1
kmod-ath9k - 3.0.3+2011-10-05-1
kmod-ath9k-common - 3.0.3+2011-10-05-1
kmod-cfg80211 - 3.0.3+2011-10-05-1
kmod-crc-ccitt - 3.0.3-1
kmod-crypto-arc4 - 3.0.3-1
kmod-ipt-conntrack - 3.0.3-1
kmod-ipt-core - 3.0.3-1
kmod-ipt-nat - 3.0.3-1
kmod-ipt-nathelper - 3.0.3-1
kmod-mac80211 - 3.0.3+2011-10-05-1
kmod-ppp - 3.0.3-1
kmod-pppoe - 3.0.3-1
libc - 0.9.32-82
libgcc - 4.5-linaro-82
libip4tc - 1.4.10-4
libnl-tiny - 0.1-2
libuci - 2011-07-18.3-1
libxtables - 1.4.10-4
maddes - 1.0-1
mtd - 16
opkg - 618-2
ppp - 2.4.5-2
ppp-mod-pppoe - 2.4.5-2
uci - 2011-07-18.3-1
uhttpd - 27
wireless-tools - 29-4
wpad-mini - 20110527-2
root@OpenWrt:/# cat /etc/opkg.conf
src/gz snapshots http://downloads.openwrt.org/snapshots/trunk/orion/packages
dest root /
dest ram /tmp
lists_dir ext /var/opkg-lists
option overlay_root /overlay
root@OpenWrt:/# opkg  update
Downloading http://downloads.openwrt.org/snapshots/trunk/orion/packages/Packages
.gz.
wget: bad address &#039;downloads.openwrt.org&#039;
Downloading ftp://ftp.maddes.net/openwrt/trunk/orion/build_28489/flash/packages/
Packages.gz.
wget: bad address &#039;ftp.maddes.net&#039;
Collected errors:
 * opkg_download: Failed to download http://downloads.openwrt.org/snapshots/trun
k/orion/packages/Packages.gz, wget returned 1.
 * opkg_download: Failed to download ftp://ftp.maddes.net/openwrt/trunk/orion/bu
ild_28489/flash/packages/Packages.gz, wget returned 1.
root@OpenWrt:/# ls /etc
TZ                     hotplug.d              profile
banner                 hotplug2-common.rules  protocols
config                 hotplug2-init.rules    rc.common
crontabs               hotplug2.rules         rc.d
diag.sh                init.d                 rc.local
dnsmasq.conf           inittab                resolv.conf
dropbear               modules.d              services
ethers                 mtab                   shells
firewall.user          opkg                   sysctl.conf
fstab                  opkg.conf              sysupgrade.conf
functions.sh           passwd                 uci-defaults
group                  ppp
hosts                  preinit
root@OpenWrt:/# ls /etc/opkg
zzzmaddes.conf
root@OpenWrt:/# cat /etc/opkg/zzzmaddes.conf
src/gz Maddes ftp://ftp.maddes.net/openwrt/trunk/orion/build_28489/flash/package
s
root@OpenWrt:/# sed -i -e &#039;s!http://.*$!http://192.168.1.2/openwrt/orion/r28475/
packages!&#039; /etc/opkg.conf
root@OpenWrt:/# cat /etc/opkg.conf
src/gz snapshots http://192.168.1.2/openwrt/orion/r28475/packages
dest root /
dest ram /tmp
lists_dir ext /var/opkg-lists
option overlay_root /overlay
root@OpenWrt:/# opkg  update
Downloading http://192.168.1.2/openwrt/orion/r28475/packages/Packages.gz.
wget: server returned error: HTTP/1.1 404 Not Found
Downloading ftp://ftp.maddes.net/openwrt/trunk/orion/build_28489/flash/pa
ckages/Packages.gz.
wget: bad address &#039;ftp.maddes.net&#039;
Collected errors:
 * opkg_download: Failed to download http://192.168.1.2/openwrt/orion/r28475/pac
kages/Packages.gz, wget returned 1.
 * opkg_download: Failed to download ftp://ftp.maddes.net/openwrt/trunk/orion/bu
ild_28489/flash/packages/Packages.gz, wget returned 1.
root@OpenWrt:/# rm /etc/opkg/zzzmaddes.conf
root@OpenWrt:/# opkg  update
Downloading http://192.168.1.2/openwrt/orion/r28475/packages/Packages.gz.
wget: server returned error: HTTP/1.1 404 Not Found
Collected errors:
 * opkg_download: Failed to download http://192.168.1.2/openwrt/orion/r28475/pac
kages/Packages.gz, wget returned 1.
root@OpenWrt:/# opkg  update
Downloading http://192.168.1.2/openwrt/orion/r28475/packages/Packages.gz.
Inflating http://192.168.1.2/openwrt/orion/r28475/packages/Packages.gz.
Updated list of available packages in /var/opkg-lists/snapshots.
root@OpenWrt:/# opkg install luci
Installing luci (trunk+svn7746-1) to root...
Collected errors:
 * verify_pkg_installable: Only have 0kb available on filesystem /overlay, pkg l
uci needs 1
 * opkg_install_cmd: Cannot install package luci.
root@OpenWrt:/# which sysupgrade
/sbin/sysupgrade
root@OpenWrt:/# df
Filesystem           1K-blocks      Used Available Use% Mounted on
tmpfs                    14812      1504     13308  10% /tmp
tmpfs                      512         0       512   0% /dev
root@OpenWrt:/# sysupgrade --help
Usage: /sbin/sysupgrade [options] &lt;image file or URL&gt;

Options:
        -d &lt;delay&gt;   add a delay before rebooting
        -f &lt;config&gt;  restore configuration from .tar.gz (file or url)
        -i           interactive mode
        -c           attempt to preserve all changed files in /etc/
        -n           do not save configuration over reflash
        -q           less verbose
        -v           more verbose
        -h / --help  display this help

root@OpenWrt:/# sysupgrade -n http://192.168.1.2/openwrt-wnr854t-squashfs.releas
e+ipv6-luci.img
Performing system upgrade...
Unlocking image ...

Writing from &lt;stdin&gt; to image ...  [w]^H^Hh[w]^H^H^
Upgrade completed
Rebooting system...
Restarting system.

         __  __                      _ _
        |  \/  | __ _ _ ____   _____| | |
        | |\/| |/ _` | &#039;__\ \ / / _ \ | |
        | |  | | (_| | |   \ V /  __/ | |
        |_|  |_|\__,_|_|    \_/ \___|_|_|
 _   _     ____              _
| | | |   | __ )  ___   ___ | |_
| | | |___|  _ \ / _ \ / _ \| __|
| |_| |___| |_) | (_) | (_) | |_
 \___/    |____/ \___/ \___/ \__|  ** LOADER **
 ** MARVELL BOARD: RD-88F5181L-VOIP-GE LE GE RT v1.05

U-Boot 1.1.1 (Apr 18 2007 - 16:05:00) Marvell version: 1.7.3

DRAM CS[0] base 0x00000000   size  32MB
DRAM Total size  32MB
[8192kB@ff800000] Flash:  8 MB
Addresses 20M - 0M are saved for the U-Boot usage.
Mem malloc Initialization (20M - 16M): Done
*** Warning - bad CRC, using default environment


Soc: 88F5181 B1
CPU: ARM926 (Rev 0) running @ 500Mhz
SysClock = 166Mhz , TClock = 166Mhz


USB 0: host mode
PCI 0: PCI Express Root Complex Interface
PCI 1: Conventional PCI, speed = 33000000
Net:   egiga0 [PRIME]
Hit any key to stop autoboot:  0
Marvell&gt;&gt; run standalone
### JFFS2 loading &#039;uImage&#039; to 0x400000
Scanning JFFS2 FS: .  Unknown node type: 2006 len 12700 offset 0x33ce64       .
 Unknown node type: 2006 len 9032 offset 0x4ddcb8
Unknown node type: 2006 len 1228 offset 0x4ffb34                              \
Unknown node type: 2006 len 6828 offset 0x51e554                              .
 Unknown node type: 2006 len 7636 offset 0x53e22c                             .
 Unknown node type: 2006 len 11948 offset 0x55d154                            ..
..  Unknown node type: 2006 len 21536 offset 0x57abe0                         /
Unknown node type: 2006 len 1744 offset 0x59f930                              .
 Unknown node type: 2006 len 10264 offset 0x5bd7e8                            -
Unknown node type: 2006 len 7652 offset 0x5fe21c                              .
 Unknown node type: 2006 len 8100 offset 0x61e05c                             |
Unknown node type: e008 len 52 offset 0x74a34c
Unknown node type: e009 len 28 offset 0x74a380
Unknown node type: e009 len 28 offset 0x74a424                                .
done.
find_inode failed for name=uImage
load: Failed to find inode
### JFFS2 LOAD ERROR&lt;0&gt; for uImage!
## Booting image at 00400000 ...
Bad Magic Number...do_bootm
Start Gemtek tftpd for Netgear GE RT!
TFTP Server IP is : 192.168.1.1
Load address: 0x400000

Abort
Marvell&gt;&gt; run standalone
### JFFS2 loading &#039;uImage&#039; to 0x400000
find_inode failed for name=uImage
load: Failed to find inode
### JFFS2 LOAD ERROR&lt;0&gt; for uImage!
## Booting image at 00400000 ...
Bad Magic Number...do_bootm
Start Gemtek tftpd for Netgear GE RT!
TFTP Server IP is : 192.168.1.1
Load address: 0x400000

Abort
Marvell&gt;&gt; tftpboot 0x400000 openwrt-wnr854t-jffs2-128k.release+ipv6-luci.img
Using egiga0 device
TFTP from server 192.168.1.2; our IP address is 192.168.1.1
Filename &#039;openwrt-wnr854t-jffs2-128k.release+ipv6-luci.img&#039;.
Load address: 0x400000
Loading: #################################################################
         ################################################################
Marvell&gt;&gt; bootm 0x400000
## Booting image at 00400000 ...
   Image Name:   Linux-3.0.3
   Created:      2011-10-19  18:09:14 UTC
   Image Type:   ARM Linux Kernel Image (uncompressed)
   Data Size:    1050192 Bytes =  1 MB
   Load Address: 00008000
   Entry Point:  00008000
   Verifying Checksum ... OK
OK

Starting kernel ...

Uncompressing Linux... done, booting the kernel.
Linux version 3.0.3 (maddes@devdebian6-amd64) (gcc version 4.5.4 20110808 (prere
lease) (Linaro GCC 4.5-2011.08) ) #3 Wed Oct 19 20:09:07 CEST 2011
CPU: Feroceon [41069260] revision 0 (ARMv5TEJ), cr=a0053177
CPU: VIVT data cache, VIVT instruction cache
Machine: Netgear WNR854T
Clearing invalid memory bank 0KB@0xffffffff
Clearing invalid memory bank 0KB@0xffffffff
Clearing invalid memory bank 0KB@0xffffffff
Ignoring unrecognised tag 0x00000000
Ignoring unrecognised tag 0x00000000
Ignoring unrecognised tag 0x00000000
Ignoring tag cmdline (using the default kernel command line)
Memory policy: ECC disabled, Data cache writeback
Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 8128
Kernel command line: root=/dev/mtdblock1 rootfstype=squashfs,jffs2 noinitrd cons
ole=ttyS0,115200
PID hash table entries: 128 (order: -3, 512 bytes)
Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
Memory: 32MB = 32MB total
Memory: 29508k/29508k available, 3260k reserved, 0K highmem
Virtual kernel memory layout:
    vector  : 0xffff0000 - 0xffff1000   (   4 kB)
    fixmap  : 0xfff00000 - 0xfffe0000   ( 896 kB)
    DMA     : 0xffc00000 - 0xffe00000   (   2 MB)
    vmalloc : 0xc2800000 - 0xfd800000   ( 944 MB)
    lowmem  : 0xc0000000 - 0xc2000000   (  32 MB)
    modules : 0xbf000000 - 0xc0000000   (  16 MB)
      .init : 0xc0008000 - 0xc0024000   ( 112 kB)
      .text : 0xc0024000 - 0xc02bd000   (2660 kB)
      .data : 0xc02be000 - 0xc02d2480   (  82 kB)
       .bss : 0xc02d24a4 - 0xc02dec64   (  50 kB)
NR_IRQS:64
sched_clock: 32 bits at 166MHz, resolution 5ns, wraps every 25769ms
Calibrating delay loop... 331.77 BogoMIPS (lpj=1658880)
pid_max: default: 32768 minimum: 301
Mount-cache hash table entries: 512
CPU: Testing write buffer coherency: ok
NET: Registered protocol family 16
Orion ID: MV88F5181-Rev-B1. TCLK=166666667.
MPP setup: unknown orion5x variant (dev 0x5181 rev 0x3)
Applying Orion-1/Orion-NAS PCIe config read transaction workaround
PCI: bus0: Fast back to back transfers disabled
PCI: bus1: Fast back to back transfers enabled
pci 0000:01:07.0: BAR 0: assigned [mem 0xe8000000-0xe800ffff]
pci 0000:01:07.0: BAR 0: set to [mem 0xe8000000-0xe800ffff] (PCI address [0xe800
0000-0xe800ffff])
pci 0000:01:07.0: BAR 1: assigned [mem 0xe8010000-0xe801ffff]
pci 0000:01:07.0: BAR 1: set to [mem 0xe8010000-0xe801ffff] (PCI address [0xe801
0000-0xe801ffff])
bio: create slab &lt;bio-0&gt; at 0
Switching to clocksource orion_clocksource
NET: Registered protocol family 2
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 1024 (order: 1, 8192 bytes)
TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
TCP: Hash tables configured (established 1024 bind 1024)
TCP reno registered
UDP hash table entries: 256 (order: 0, 4096 bytes)
UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
NET: Registered protocol family 1
squashfs: version 4.0 (2009/01/31) Phillip Lougher
JFFS2 version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006
 Red Hat, Inc.
msgmni has been set to 57
io scheduler noop registered
io scheduler deadline registered (default)
Serial: 8250/16550 driver, 2 ports, IRQ sharing disabled
serial8250.0: ttyS0 at MMIO 0xf1012000 (irq = 3) is a 16550A
console [ttyS0] enabled
physmap platform flash device: 00800000 at f4000000
physmap-flash.0: Found 1 x16 devices at 0x0 in 16-bit bank. Manufacturer ID 0x00
0089 Chip ID 0x000017
Intel/Sharp Extended Query Table at 0x0031
Intel/Sharp Extended Query Table at 0x0031
Using buffer write method
cfi_cmdset_0001: Erase suspend on write enabled
Using physmap partition information
Creating 4 MTD partitions on &quot;physmap-flash.0&quot;:
0x000000000000-0x000000120000 : &quot;kernel&quot;
0x000000120000-0x000000760000 : &quot;rootfs&quot;
mtd: partition &quot;rootfs&quot; set to be root filesystem
mtd: partition &quot;rootfs_data&quot; created automatically, ofs=280000, len=4E0000
0x000000280000-0x000000760000 : &quot;rootfs_data&quot;
0x000000760000-0x0000007a0000 : &quot;uboot&quot;
0x000000000000-0x000000760000 : &quot;image&quot;
mv643xx_eth: MV-643xx 10/100/1000 ethernet driver version 1.4
mv643xx_eth smi: probed
mv643xx_eth_port mv643xx_eth_port.0: eth0: port 0 with MAC address 00:00:00:00:5
1:81
i2c /dev entries driver
TCP westwood registered
NET: Registered protocol family 17
Bridge firewalling registered
Distributed Switch Architecture driver version 0.1
eth0[0]: detected a Marvell 88E6131 switch
dsa slave smi: probed
802.1Q VLAN Support v1.8
drivers/rtc/hctosys.c: unable to open rtc device (rtc0)
VFS: Mounted root (squashfs filesystem) readonly on device 31:1.
Freeing init memory: 112K
- preinit -
Press the [f] key and hit [enter] to enter failsafe mode
- regular preinit -
jffs2 not ready yet; using ramdisk
- init -

Please press Enter to activate this console. mv643xx_eth_port mv643xx_eth_port.0
: eth0: link up, 1000 Mb/s, full duplex, flow control disabled
device lan3 entered promiscuous mode
device eth0 entered promiscuous mode
ttyS0: 1 input overrun(s)
device eth0 left promiscuous mode
br-lan: port 1(lan3) entering disabled state
3) entering disadevice eth0 entered promiscuous mode
device lan4 entered promiscuous mode
br-lan: port 2(lan4) entering disabled state
disabdevice lan1 entered promiscuous mode
ttyS0: 3 input overrun(s)
enteredbr-lan: port 3(lan1) entering disabled state
lan1: link up, 1000 Mb/s, full duplex, flow control disabled
br-lan: port 3(lan1) entering forwarding state
br-lan: port 3(lan1) entering forwarding state
device lan2 entered promiscuous mode
br-lan: port 4(lan2) entering disabled state
Compat-wireless backport release: compat-wireless-2011-09-28-6-g8163a60
Backport based on wireless-testing.git master-2011-10-05
ttyS0: 1 input overrun(s)
cfg80211: Calling CRDA to update world regulatory domain
cfg80211: World regulatory domain updated:
cfg80211:     (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp)
cfg80211:     (2402000 KHz - 2472000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (2457000 KHz - 2482000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (2474000 KHz - 2494000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (5170000 KHz - 5250000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (5735000 KHz - 5835000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
ttyS0: 1 input overrun(s)
PPP gen
eric driver version 2.4.2
ip_tables: (C) 2000-2006 Netfilter Core Team
NET: Registered protocol family 24
nf_conntrack version 0.5.0 (462 buckets, 1848 max)
jffs2_scan_eraseblock(): End of filesystem marker found at 0x0
jffs2_build_filesystem(): unlocking the mtd device... done.
jffs2_build_filesystem(): erasing all blocks after the end marker... done.
JFFS2 notice: (2045) jffs2_build_xattr_subsystem: complete building xattr subsys
tem, 0 of xdatum (0 unchecked, 0 orphan) and 0 of xref (0 dead, 0 orphan) found.



BusyBox v1.18.5 (2011-10-15 22:09:28 CEST) built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 ATTITUDE ADJUSTMENT (bleeding edge, r28489) ----------
  * 1/4 oz Vodka      Pour all ingredients into mixing
  * 1/4 oz Gin        tin with ice, strain into glass.
  * 1/4 oz Amaretto
  * 1/4 oz Triple sec
  * 1/4 oz Peach schnapps
  * 1/4 oz Sour mix
  * 1 splash Cranberry juice
 -----------------------------------------------------
root@OpenWrt:/# df
Filesystem           1K-blocks      Used Available Use% Mounted on
/dev/root                 1408      1408         0 100% /rom
tmpfs                    14812        40     14772   0% /tmp
tmpfs                      512         0       512   0% /dev
root                     14808        28     14780   0% /tmp/root
/dev/mtdblock2            4992       396      4596   8% /overlay
overlayfs:/overlay        4992       396      4596   8% /
root@OpenWrt:/# cat /proc/mtd
dev:    size   erasesize  name
mtd0: 00120000 00020000 &quot;kernel&quot;
mtd1: 00640000 00020000 &quot;rootfs&quot;
mtd2: 004e0000 00020000 &quot;rootfs_data&quot;
mtd3: 00040000 00020000 &quot;uboot&quot;
root@OpenWrt:/# sysupgrade -n http://192.168.1.2/openwrt-wnr854t-jffs2-128k.rele
ase+ipv6-luci.img
Switching to ramdisk...
Performing system upgrade...
upgrade...

upgradUnlocking image ...

Writing from &lt;stdin&gt; to image ...  [ ]nÿZýing from ýý[w]^H^H^H[e]^Hh[w]^H^H^
Upgrade completed
Rebooting system...
Restarting system.

         __  __                      _ _
        |  \/  | __ _ _ ____   _____| | |
        | |\/| |/ _` | &#039;__\ \ / / _ \ | |
        | |  | | (_| | |   \ V /  __/ | |
        |_|  |_|\__,_|_|    \_/ \___|_|_|
 _   _     ____              _
| | | |   | __ )  ___   ___ | |_
| | | |___|  _ \ / _ \ / _ \| __|
| |_| |___| |_) | (_) | (_) | |_
 \___/    |____/ \___/ \___/ \__|  ** LOADER **
 ** MARVELL BOARD: RD-88F5181L-VOIP-GE LE GE RT v1.05

U-Boot 1.1.1 (Apr 18 2007 - 16:05:00) Marvell version: 1.7.3

DRAM CS[0] base 0x00000000   size  32MB
DRAM Total size  32MB
[8192kB@ff800000] Flash:  8 MB
Addresses 20M - 0M are saved for the U-Boot usage.
Mem malloc Initialization (20M - 16M): Done
*** Warning - bad CRC, using default environment


Soc: 88F5181 B1
CPU: ARM926 (Rev 0) running @ 500Mhz
SysClock = 166Mhz , TClock = 166Mhz


USB 0: host mode
PCI 0: PCI Express Root Complex Interface
PCI 1: Conventional PCI, speed = 33000000
Net:   egiga0 [PRIME]
Hit any key to stop autoboot:  0
Marvell&gt;&gt; run standalone
### JFFS2 loading &#039;uImage&#039; to 0x400000
Scanning JFFS2 FS: ......\ Unknown node type: e008 len 52 offset 0x721d68
Unknown node type: e009 len 28 offset 0x721d9c
Unknown node type: e009 len 28 offset 0x721f90
Unknown node type: e009 len 28 offset 0x7223e4                                 d
one.
find_inode failed for name=uImage
load: Failed to find inode
### JFFS2 LOAD ERROR&lt;0&gt; for uImage!
## Booting image at 00400000 ...
   Image Name:   Linux-3.0.3
   Created:      2011-10-19  18:09:14 UTC
   Image Type:   ARM Linux Kernel Image (uncompressed)
   Data Size:    1050192 Bytes =  1 MB
   Load Address: 00008000
   Entry Point:  00008000
   Verifying Checksum ... OK
OK

Starting kernel ...

Uncompressing Linux... done, booting the kernel.
Linux version 3.0.3 (maddes@devdebian6-amd64) (gcc version 4.5.4 20110808 (prere
lease) (Linaro GCC 4.5-2011.08) ) #3 Wed Oct 19 20:09:07 CEST 2011
CPU: Feroceon [41069260] revision 0 (ARMv5TEJ), cr=a0053177
CPU: VIVT data cache, VIVT instruction cache
Machine: Netgear WNR854T
Clearing invalid memory bank 0KB@0xffffffff
Clearing invalid memory bank 0KB@0xffffffff
Clearing invalid memory bank 0KB@0xffffffff
Ignoring unrecognised tag 0x00000000
Ignoring unrecognised tag 0x00000000
Ignoring unrecognised tag 0x00000000
Ignoring tag cmdline (using the default kernel command line)
Memory policy: ECC disabled, Data cache writeback
Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 8128
Kernel command line: root=/dev/mtdblock1 rootfstype=squashfs,jffs2 noinitrd cons
ole=ttyS0,115200
PID hash table entries: 128 (order: -3, 512 bytes)
Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
Memory: 32MB = 32MB total
Memory: 29508k/29508k available, 3260k reserved, 0K highmem
Virtual kernel memory layout:
    vector  : 0xffff0000 - 0xffff1000   (   4 kB)
    fixmap  : 0xfff00000 - 0xfffe0000   ( 896 kB)
    DMA     : 0xffc00000 - 0xffe00000   (   2 MB)
    vmalloc : 0xc2800000 - 0xfd800000   ( 944 MB)
    lowmem  : 0xc0000000 - 0xc2000000   (  32 MB)
    modules : 0xbf000000 - 0xc0000000   (  16 MB)
      .init : 0xc0008000 - 0xc0024000   ( 112 kB)
      .text : 0xc0024000 - 0xc02bd000   (2660 kB)
      .data : 0xc02be000 - 0xc02d2480   (  82 kB)
       .bss : 0xc02d24a4 - 0xc02dec64   (  50 kB)
NR_IRQS:64
sched_clock: 32 bits at 166MHz, resolution 5ns, wraps every 25769ms
Calibrating delay loop... 331.77 BogoMIPS (lpj=1658880)
pid_max: default: 32768 minimum: 301
Mount-cache hash table entries: 512
CPU: Testing write buffer coherency: ok
NET: Registered protocol family 16
Orion ID: MV88F5181-Rev-B1. TCLK=166666667.
MPP setup: unknown orion5x variant (dev 0x5181 rev 0x3)
Applying Orion-1/Orion-NAS PCIe config read transaction workaround
PCI: bus0: Fast back to back transfers disabled
PCI: bus1: Fast back to back transfers enabled
pci 0000:01:07.0: BAR 0: assigned [mem 0xe8000000-0xe800ffff]
pci 0000:01:07.0: BAR 0: set to [mem 0xe8000000-0xe800ffff] (PCI address [0xe800
0000-0xe800ffff])
pci 0000:01:07.0: BAR 1: assigned [mem 0xe8010000-0xe801ffff]
pci 0000:01:07.0: BAR 1: set to [mem 0xe8010000-0xe801ffff] (PCI address [0xe801
0000-0xe801ffff])
bio: create slab &lt;bio-0&gt; at 0
Switching to clocksource orion_clocksource
NET: Registered protocol family 2
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 1024 (order: 1, 8192 bytes)
TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
TCP: Hash tables configured (established 1024 bind 1024)
TCP reno registered
UDP hash table entries: 256 (order: 0, 4096 bytes)
UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
NET: Registered protocol family 1
squashfs: version 4.0 (2009/01/31) Phillip Lougher
JFFS2 version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006
 Red Hat, Inc.
msgmni has been set to 57
io scheduler noop registered
io scheduler deadline registered (default)
Serial: 8250/16550 driver, 2 ports, IRQ sharing disabled
serial8250.0: ttyS0 at MMIO 0xf1012000 (irq = 3) is a 16550A
console [ttyS0] enabled
physmap platform flash device: 00800000 at f4000000
physmap-flash.0: Found 1 x16 devices at 0x0 in 16-bit bank. Manufacturer ID 0x00
0089 Chip ID 0x000017
Intel/Sharp Extended Query Table at 0x0031
Intel/Sharp Extended Query Table at 0x0031
Using buffer write method
cfi_cmdset_0001: Erase suspend on write enabled
Using physmap partition information
Creating 4 MTD partitions on &quot;physmap-flash.0&quot;:
0x000000000000-0x000000120000 : &quot;kernel&quot;
0x000000120000-0x000000760000 : &quot;rootfs&quot;
mtd: partition &quot;rootfs&quot; set to be root filesystem
split_squashfs: no squashfs found in &quot;physmap-flash.0&quot;
0x000000760000-0x0000007a0000 : &quot;uboot&quot;
0x000000000000-0x000000760000 : &quot;image&quot;
mv643xx_eth: MV-643xx 10/100/1000 ethernet driver version 1.4
mv643xx_eth smi: probed
mv643xx_eth_port mv643xx_eth_port.0: eth0: port 0 with MAC address 00:00:00:00:5
1:81
i2c /dev entries driver
TCP westwood registered
NET: Registered protocol family 17
Bridge firewalling registered
Distributed Switch Architecture driver version 0.1
eth0[0]: detected a Marvell 88E6131 switch
dsa slave smi: probed
802.1Q VLAN Support v1.8
drivers/rtc/hctosys.c: unable to open rtc device (rtc0)
jffs2_scan_eraseblock(): End of filesystem marker found at 0x1e0000
jffs2_build_filesystem(): unlocking the mtd device... done.
jffs2_build_filesystem(): erasing all blocks after the end marker... done.
one.

JFFS2 notice: (1) jffs2_build_xattr_subsystem: complete building xattr subsystem
, 0 of xdatum (0 unchecked, 0 orphan) and 0 of xref (0 dead, 0 orphan) found.
VFS: Mounted root (jffs2 filesystem) on device 31:1.
Freeing init memory: 112K
- preinit -
Press the [f] key and hit [enter] to enter failsafe mode
- regular preinit -
- init -

Please press Enter to activate this console. mv643xx_eth_port mv643xx_eth_port.0
: eth0: link up, 1000 Mb/s, full duplex, flow control disabled
device lan3 entered promiscuous mode
device eth0 entered promiscuous mode
promdevice eth0 left promiscuous mode
br-lan: port 1(lan3) entering disabled state
disabled device eth0 entered promiscuous mode
device lan4 entered promiscuous mode
br-lan: port 2(lan4) entering disabled state
(lan4) elan1: link up, 1000 Mb/s, full duplex, flow control disabled
device lan1 entered promiscuous mode
br-lan: port 3(lan1) entering forwarding state
br-lan: port 3(lan1) entering forwarding state
br-lan: port 3(lan1) entering forwarding state
br-lan: port 3(lan1) entering forwarding state
br-lan: port 3(lan1) entering forwarding state
device lan2 entered promiscuous mode
br-lan: port 4(lan2) entering disabled state
e



BusyBox v1.18.5 (2011-10-15 22:09:28 CEST) built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 ATTITUDE ADJUSTMENT (bleeding edge, r28489) ----------
  * 1/4 oz Vodka      Pour all ingredients into mixing
  * 1/4 oz Gin        tin with ice, strain into glass.
  * 1/4 oz Amaretto
  * 1/4 oz Triple sec
  * 1/4 oz Peach schnapps
  * 1/4 oz Sour mix
  * 1 splash Cranberry juice
 -----------------------------------------------------
root@OpenWrt:/#
root@OpenWrt:/# Compat-wireless backport release: compat-wireless-2011-09-28-6-g
8163a60
Backport based on wireless-testing.git master-2011-10-05
cfg80211: Calling CRDA to update world regulatory domain
cfg80211: World regulatory domain updated:
cfg80211:     (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp)
cfg80211:     (2402000 KHz - 2472000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (2457000 KHz - 2482000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (2474000 KHz - 2494000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (5170000 KHz - 5250000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (5735000 KHz - 5835000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
PPP generic driver version 2.4.2
ip_tables: (C) 2000-2006 Netfilter Core Team
NET: Registered protocol family 24
nf_conntrack version 0.5.0 (462 buckets, 1848 max)

root@OpenWrt:/# rm /etc/opkg/zzzmaddes.conf
root@OpenWrt:/# sed -i -e &#039;s!http://.*$!http://192.168.1.2/openwrt/orion/r28475/
packages!&#039; /etc/opkg.conf
root@OpenWrt:/# opkg update
Downloading http://192.168.1.2/openwrt/orion/r28475/packages/Packages.gz.
Inflating http://192.168.1.2/openwrt/orion/r28475/packages/Packages.gz.
Updated list of available packages in /var/opkg-lists/snapshots.
root@OpenWrt:/# opkg install luci
Installing luci (trunk+svn7746-1) to root...
Downloading http://192.168.1.2/openwrt/orion/r28475/packages/luci_trunk+svn7746-
1_orion.ipk.
Installing luci-mod-admin-full (trunk+svn7746-1) to root...
Downloading http://192.168.1.2/openwrt/orion/r28475/packages/luci-mod-admin-full
_trunk+svn7746-1_orion.ipk.
Installing luci-mod-admin-core (trunk+svn7746-1) to root...
Downloading http://192.168.1.2/openwrt/orion/r28475/packages/luci-mod-admin-core
_trunk+svn7746-1_orion.ipk.
Installing luci-lib-web (trunk+svn7746-1) to root...
Downloading http://192.168.1.2/openwrt/orion/r28475/packages/luci-lib-web_trunk+
svn7746-1_orion.ipk.
Installing luci-lib-core (trunk+svn7746-1) to root...
Downloading http://192.168.1.2/openwrt/orion/r28475/packages/luci-lib-core_trunk
+svn7746-1_orion.ipk.
Installing lua (5.1.4-8) to root...
Downloading http://192.168.1.2/openwrt/orion/r28475/packages/lua_5.1.4-8_orion.i
pk.
Installing liblua (5.1.4-8) to root...
Downloading http://192.168.1.2/openwrt/orion/r28475/packages/liblua_5.1.4-8_orio
n.ipk.
Installing libuci-lua (2011-07-18.3-1) to root...
Downloading http://192.168.1.2/openwrt/orion/r28475/packages/libuci-lua_2011-07-
18.3-1_orion.ipk.
Installing luci-lib-sys (trunk+svn7746-1) to root...
Downloading http://192.168.1.2/openwrt/orion/r28475/packages/luci-lib-sys_trunk+
svn7746-1_orion.ipk.
Installing luci-lib-nixio (trunk+svn7746-1) to root...
Downloading http://192.168.1.2/openwrt/orion/r28475/packages/luci-lib-nixio_trun
k+svn7746-1_orion.ipk.
Installing luci-sgi-cgi (trunk+svn7746-1) to root...
Downloading http://192.168.1.2/openwrt/orion/r28475/packages/luci-sgi-cgi_trunk+
svn7746-1_orion.ipk.
Installing luci-lib-lmo (trunk+svn7746-1) to root...
Downloading http://192.168.1.2/openwrt/orion/r28475/packages/luci-lib-lmo_trunk+
svn7746-1_orion.ipk.
Installing luci-proto-core (trunk+svn7746-1) to root...
Downloading http://192.168.1.2/openwrt/orion/r28475/packages/luci-proto-core_tru
nk+svn7746-1_orion.ipk.
Installing luci-proto-ppp (trunk+svn7746-1) to root...
Downloading http://192.168.1.2/openwrt/orion/r28475/packages/luci-proto-ppp_trun
k+svn7746-1_orion.ipk.
Installing luci-i18n-english (trunk+svn7746-1) to root...
Downloading http://192.168.1.2/openwrt/orion/r28475/packages/luci-i18n-english_t
runk+svn7746-1_orion.ipk.
Installing luci-lib-ipkg (trunk+svn7746-1) to root...
Downloading http://192.168.1.2/openwrt/orion/r28475/packages/luci-lib-ipkg_trunk
+svn7746-1_orion.ipk.
Installing luci-theme-openwrt (trunk+svn7746-1) to root...
Downloading http://192.168.1.2/openwrt/orion/r28475/packages/luci-theme-openwrt_
trunk+svn7746-1_orion.ipk.
Installing luci-theme-base (trunk+svn7746-1) to root...
Downloading http://192.168.1.2/openwrt/orion/r28475/packages/luci-theme-base_tru
nk+svn7746-1_orion.ipk.
Installing luci-app-firewall (trunk+svn7746-1) to root...
Downloading http://192.168.1.2/openwrt/orion/r28475/packages/luci-app-firewall_t
runk+svn7746-1_orion.ipk.
Installing libiwinfo (16) to root...
Downloading http://192.168.1.2/openwrt/orion/r28475/packages/libiwinfo_16_orion.
ipk.
Configuring luci-lib-sys.
Configuring liblua.
Configuring libuci-lua.
Configuring lua.
Configuring luci-lib-core.
Configuring luci-lib-nixio.
Configuring luci-sgi-cgi.
Configuring luci-lib-lmo.
Configuring luci-lib-web.
Configuring luci-proto-core.
Configuring luci-proto-ppp.
Configuring luci-i18n-english.
Configuring luci-mod-admin-core.
Configuring libiwinfo.
Configuring luci-theme-base.
Configuring luci-theme-openwrt.
Configuring luci-app-firewall.
Configuring luci-lib-ipkg.
Configuring luci-mod-admin-full.
Configuring luci.
root@OpenWrt:/#</code></pre></div><p>Conclusion: U-Boot search for a file in jffs2 and when not found boots anyway. This file can be deleted and replaced for an easier sysupgrade? OpenWRT rolling release?? <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p146272">
				<div class="post-metadata">
					<div class="post-num">Post #1044</div>
					<div class="post-author">maddes.b</div>
					<div class="post-datetime">
						20 Oct 2011, 19:06					</div>
				</div>
				<div class="post-content content">
					<p>The first 1152KiB (0x120000 bytes, 1.125MB) of the squashfs and jffs2 images are identical.<br />Both have the correct magic number for the U-Boot image (0x27051956).<br />I also re-downloaded the images from my server and verified their MD5 checksums successfully.<br />The U-Boot image is also independent of any squashfs or jffs2 filesystem.<br />In my eyes the squashfs image should have booted too, as there shouldn&#039;t be an U-Boot issue at all.</p><p>Mayeb a flash issue?<br /></p><div class="quotebox"><cite>Nilfred wrote:</cite><blockquote><p>Writing from &lt;stdin&gt; to image ...&nbsp; <span style="color: red">[ ]nÿZýing from ýý[w]^H^H^H[e]^Hh[w]^H^H^</span></p></blockquote></div><p>Also the squashfs booted somehow (No, I do not have any explanation for this):<br /></p><div class="quotebox"><cite>Nilfred wrote:</cite><blockquote><p>Creating 4 MTD partitions on &quot;physmap-flash.0&quot;:<br />0x000000000000-0x000000120000 : &quot;kernel&quot;<br /><strong>0x000000120000-0x000000760000 : &quot;rootfs&quot;<br />mtd: partition &quot;rootfs&quot; set to be root filesystem<br />mtd: partition &quot;rootfs_data&quot; created automatically, ofs=280000, len=4E0000</strong><br />0x000000280000-0x000000760000 : &quot;rootfs_data&quot;<br />0x000000760000-0x0000007a0000 : &quot;uboot&quot;<br />0x000000000000-0x000000760000 : &quot;image&quot;<br />...<br /><strong>VFS: Mounted root (squashfs filesystem) readonly on device 31:1.</strong></p></blockquote></div><p>vs.<br /></p><div class="quotebox"><cite>Nilfred wrote:</cite><blockquote><p>Creating 4 MTD partitions on &quot;physmap-flash.0&quot;:<br />0x000000000000-0x000000120000 : &quot;kernel&quot;<br /><strong>0x000000120000-0x000000760000 : &quot;rootfs&quot;<br />mtd: partition &quot;rootfs&quot; set to be root filesystem<br />split_squashfs: no squashfs found in &quot;physmap-flash.0&quot;</strong><br />0x000000760000-0x0000007a0000 : &quot;uboot&quot;<br />0x000000000000-0x000000760000 : &quot;image&quot;<br />...<br /><strong>VFS: Mounted root (jffs2 filesystem) on device 31:1.</strong></p></blockquote></div><p>Would you mind to do the following:<br />1. Verify the MD5 checksums of the images on your PC (md5sum --check &lt;md5sums file&gt;)<br />2. On the router go to /tmp (RAM disk) and use wget to download the squashfs image from your PC.<br />3. Verify its MD5 checksum manually on the router (md5sum --binary openwrt-wnr854t-jffs2-128k.release+ipv6-luci.img) against md5sums file<br />4. Sysupgrade from /tmp directly (sysupgrade -n openwrt-wnr854t-jffs2-128k.release+ipv6-luci.img)<br />5. Check if it boots</p><p>If it still fails, the only step I can think of is to pad the final image for the erase size (128KiB, 0x20000) and re-try.<br /></p><div class="codebox"><pre><code>PC: dd if=openwrt-wnr854t-squashfs.release+ipv6-luci.img of=openwrt-wnr854t-squashfs.release+ipv6-luci.padded.img bs=128k conv=sync
Router: wget http://192.168.1.2/openwrt-wnr854t-squashfs.release+ipv6-luci.padded.img
sysupgrade -n openwrt-wnr854t-jffs2-128k.release+ipv6-luci.padded.img</code></pre></div><p>Thanks<br />Maddes</p><p>P.S.:<br />The WNR854T feature to boot the kernel from a &quot;uImage&quot; file inside a JFFS2 partition would allow to merge kernel and rootfs partitions into one rootfs partition.<br />This way the kernel size would never matter. If someone is interested, we could test this after the above tests are done.</p><p>On the other hand, a squashfs image has the big advantage of &quot;firstboot&quot; for normal and/or unexperienced users.</p>											<p class="post-edited">(Last edited by <strong>maddes.b</strong> on 20 Oct 2011, 19:08)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p146296">
				<div class="post-metadata">
					<div class="post-num">Post #1045</div>
					<div class="post-author">Nilfred</div>
					<div class="post-datetime">
						21 Oct 2011, 02:45					</div>
				</div>
				<div class="post-content content">
					<p>I figured out how to open the first part from the old log:<br /></p><div class="codebox"><pre><code>Marvell&gt;&gt; tftpboot 0x400000 openwrt-wnr854t-uImage.release+ipv6-luci.ramdisk
Using egiga0 device
TFTP from server 192.168.1.2; our IP address is 192.168.1.1
Filename &#039;openwrt-wnr854t-uImage.release+ipv6-luci.ramdisk&#039;.
Load address: 0x400000
Loading: #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################
done
Bytes transferred = 2246608 (2247d0 hex)
Marvell&gt;&gt; bootm 0x400000
## Booting image at 00400000 ...
   Image Name:   Linux-3.0.3
   Created:      2011-10-19  18:22:06 UTC
   Image Type:   ARM Linux Kernel Image (uncompressed)
   Data Size:    2246544 Bytes =  2.1 MB
   Load Address: 00008000
   Entry Point:  00008000
   Verifying Checksum ... OK
OK

Starting kernel ...

Uncompressing Linux... done, booting the kernel.
Linux version 3.0.3 (maddes@devdebian6-amd64) (gcc version 4.5.4 20110808 (prere
lease) (Linaro GCC 4.5-2011.08) ) #4 Wed Oct 19 20:21:57 CEST 2011
CPU: Feroceon [41069260] revision 0 (ARMv5TEJ), cr=a0053177
CPU: VIVT data cache, VIVT instruction cache
Machine: Netgear WNR854T
Clearing invalid memory bank 0KB@0xffffffff
Clearing invalid memory bank 0KB@0xffffffff
Clearing invalid memory bank 0KB@0xffffffff
Ignoring unrecognised tag 0x00000000
Ignoring unrecognised tag 0x00000000
Ignoring unrecognised tag 0x00000000
Ignoring tag cmdline (using the default kernel command line)
Memory policy: ECC disabled, Data cache writeback
Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 8128
Kernel command line: root=/dev/mtdblock1 rootfstype=squashfs,jffs2 noinitrd cons
ole=ttyS0,115200
PID hash table entries: 128 (order: -3, 512 bytes)
Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
Memory: 32MB = 32MB total
Memory: 25780k/25780k available, 6988k reserved, 0K highmem
Virtual kernel memory layout:
    vector  : 0xffff0000 - 0xffff1000   (   4 kB)
    fixmap  : 0xfff00000 - 0xfffe0000   ( 896 kB)
    DMA     : 0xffc00000 - 0xffe00000   (   2 MB)
    vmalloc : 0xc2800000 - 0xfd800000   ( 944 MB)
    lowmem  : 0xc0000000 - 0xc2000000   (  32 MB)
    modules : 0xbf000000 - 0xc0000000   (  16 MB)
      .init : 0xc0008000 - 0xc03c8000   (3840 kB)
      .text : 0xc03c8000 - 0xc0661000   (2660 kB)
      .data : 0xc0662000 - 0xc0676480   (  82 kB)
       .bss : 0xc06764a4 - 0xc0682c64   (  50 kB)
NR_IRQS:64
sched_clock: 32 bits at 166MHz, resolution 5ns, wraps every 25769ms
Calibrating delay loop... 331.77 BogoMIPS (lpj=1658880)
pid_max: default: 32768 minimum: 301
Mount-cache hash table entries: 512
CPU: Testing write buffer coherency: ok
NET: Registered protocol family 16
Orion ID: MV88F5181-Rev-B1. TCLK=166666667.
MPP setup: unknown orion5x variant (dev 0x5181 rev 0x3)
Applying Orion-1/Orion-NAS PCIe config read transaction workaround
PCI: bus0: Fast back to back transfers disabled
PCI: bus1: Fast back to back transfers enabled
pci 0000:01:07.0: BAR 0: assigned [mem 0xe8000000-0xe800ffff]
pci 0000:01:07.0: BAR 0: set to [mem 0xe8000000-0xe800ffff] (PCI address [0xe800
0000-0xe800ffff])
pci 0000:01:07.0: BAR 1: assigned [mem 0xe8010000-0xe801ffff]
pci 0000:01:07.0: BAR 1: set to [mem 0xe8010000-0xe801ffff] (PCI address [0xe801
0000-0xe801ffff])
bio: create slab &lt;bio-0&gt; at 0
Switching to clocksource orion_clocksource
NET: Registered protocol family 2
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 1024 (order: 1, 8192 bytes)
TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
TCP: Hash tables configured (established 1024 bind 1024)
TCP reno registered
UDP hash table entries: 256 (order: 0, 4096 bytes)
UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
NET: Registered protocol family 1
squashfs: version 4.0 (2009/01/31) Phillip Lougher
JFFS2 version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006
 Red Hat, Inc.
msgmni has been set to 50
io scheduler noop registered
io scheduler deadline registered (default)
Serial: 8250/16550 driver, 2 ports, IRQ sharing disabled
serial8250.0: ttyS0 at MMIO 0xf1012000 (irq = 3) is a 16550A
console [ttyS0] enabled
physmap platform flash device: 00800000 at f4000000
physmap-flash.0: Found 1 x16 devices at 0x0 in 16-bit bank. Manufacturer ID 0x00
0089 Chip ID 0x000017
Intel/Sharp Extended Query Table at 0x0031
Intel/Sharp Extended Query Table at 0x0031
Using buffer write method
cfi_cmdset_0001: Erase suspend on write enabled
Using physmap partition information
Creating 4 MTD partitions on &quot;physmap-flash.0&quot;:
0x000000000000-0x000000120000 : &quot;kernel&quot;
0x000000120000-0x000000760000 : &quot;rootfs&quot;
mtd: partition &quot;rootfs&quot; set to be root filesystem
split_squashfs: no squashfs found in &quot;physmap-flash.0&quot;
0x000000760000-0x0000007a0000 : &quot;uboot&quot;
0x000000000000-0x000000760000 : &quot;image&quot;
mv643xx_eth: MV-643xx 10/100/1000 ethernet driver version 1.4
mv643xx_eth smi: probed
mv643xx_eth_port mv643xx_eth_port.0: eth0: port 0 with MAC address 00:00:00:00:5
1:81
i2c /dev entries driver
TCP westwood registered
NET: Registered protocol family 17
Bridge firewalling registered
Distributed Switch Architecture driver version 0.1
eth0[0]: detected a Marvell 88E6131 switch
dsa slave smi: probed
802.1Q VLAN Support v1.8
drivers/rtc/hctosys.c: unable to open rtc device (rtc0)
Freeing init memory: 3840K
- preinit -
Press the [f] key and hit [enter] to enter failsafe mode
- regular preinit -
- init -

Please press Enter to activate this console. mv643xx_eth_port mv643xx_eth_port.0
: eth0: link up, 1000 Mb/s, full duplex, flow control disabled
device lan3 entered promiscuous mode
device eth0 entered promiscuous mode
device eth0 left promiscuous mode
br-lan: port 1(lan3) entering disabled state
device eth0 entered promiscuous mode
device lan4 entered promiscuous mode
br-lan: port 2(lan4) entering disabled state
device lan1 entered promiscuous mode
br-lan: port 3(lan1) entering disabled state


BusyBox v1.18.5 (2011-10-15 22:09:28 CEST) built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 ATTITUDE ADJUSTMENT (bleeding edge, r28489) ----------
  * 1/4 oz Vodka      Pour all ingredients into mixing
  * 1/4 oz Gin        tin with ice, strain into glass.
  * 1/4 oz Amaretto
  * 1/4 oz Triple sec
  * 1/4 oz Peach schnapps
  * 1/4 oz Sour mix
  * 1 splash Cranberry juice
 -----------------------------------------------------
lan1: link up, 1000 Mb/s, full duplex, flow control disabled
root@OpenWrt:/# br-lan: port 3(lan1) entering forwarding state
br-lan: port 3(lan1) entering forwarding state
device lan2 entered promiscuous mode
br-lan: port 4(lan2) entering disabled state
Compat-wireless backport release: compat-wireless-2011-09-28-6-g8163a60
Backport based on wireless-testing.git master-2011-10-05
cfg80211: Calling CRDA to update world regulatory domain
ttyS0: 1 input overrun(s)
cfg80211: World regulatory domain updated:
cfg80211:     (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp)
cfg80211:     (2402000 KHz - 2472000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (2457000 KHz - 2482000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (2474000 KHz - 2494000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (5170000 KHz - 5250000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (5735000 KHz - 5835000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
PPP generic driver version 2.4.2
ip_tables: (C) 2000-2006 Netfilter Core Team
NET: Registered protocol family 24
nf_conntrack version 0.5.0 (462 buckets, 1848 max)
root@OpenWrt:/# opkg list-installed</code></pre></div><p>Now the news:<br /></p><div class="quotebox"><cite>maddes.b wrote:</cite><blockquote><p>The first 1152KiB (0x120000 bytes, 1.125MB) of the squashfs and jffs2 images are identical.<br />Both have the correct magic number for the U-Boot image (0x27051956).<br />I also re-downloaded the images from my server and verified their MD5 checksums successfully.<br />The U-Boot image is also independent of any squashfs or jffs2 filesystem.<br />In my eyes the squashfs image should have booted too, as there shouldn&#039;t be an U-Boot issue at all.</p></blockquote></div><p>Good news: squashfs image boots once.<br />Bad news: Both images don&#039;t boot twice after a power cycle.<br /></p><div class="quotebox"><cite>maddes.b wrote:</cite><blockquote><p>Mayeb a flash issue?<br /></p><div class="quotebox"><cite>Nilfred wrote:</cite><blockquote><p>Writing from &lt;stdin&gt; to image ...&nbsp; <span style="color: red">[ ]nÿZýing from ýý[w]^H^H^H[e]^Hh[w]^H^H^</span></p></blockquote></div></blockquote></div><p>That&#039;s only unfiltered interference picked in serial cable. I hand remove mostly before posting.<br /></p><div class="quotebox"><cite>maddes.b wrote:</cite><blockquote><p>Also the squashfs booted somehow (No, I do not have any explanation for this):</p></blockquote></div><p>At that time, there was squashfs image in flash, but tftpboot jff2 image in RAM. Quite a mess.<br /></p><div class="quotebox"><cite>maddes.b wrote:</cite><blockquote><p>The WNR854T feature to boot the kernel from a &quot;uImage&quot; file inside a JFFS2 partition would allow to merge kernel and rootfs partitions into one rootfs partition.<br />This way the kernel size would never matter. If someone is interested, we could test this after the above tests are done.</p></blockquote></div><p>/me raises his hand.</p><p>Preparation:<br /></p><div class="quotebox"><blockquote><p>cd ~/Descargas/OpenWrt/orion/r28489<br />md5sum openwrt-wnr854t-squashfs.release+ipv6-luci.img<br />a7789615a62080c2e19a891fa905d34f&nbsp; openwrt-wnr854t-squashfs.release+ipv6-luci.img<br />dd if=openwrt-wnr854t-squashfs.release+ipv6-luci.img of=openwrt-wnr854t-squashfs.release+ipv6-luci.padded.img bs=128k conv=sync<br />21+1 registros de entrada<br />22+0 registros de salida<br />2883584 bytes (2,9 MB) copiados, 0,00618049 s, 467 MB/s<br />sudo cp openwrt-wnr854t-squashfs.release+ipv6-luci.padded.img /var/www<br />md5sum openwrt-wnr854t-squashfs.release+ipv6-luci.padded.img<br />f633e752633b1b5b7f667dd81cb2f5e3&nbsp; openwrt-wnr854t-squashfs.release+ipv6-luci.padded.img<br />cd ~<br />sudo ifconfig eth0 192.168.1.2 up<br />screen /dev/ttyUSB0 115200<br />run standalone<br />Ctrl-a : hardcopy -h 854hardcopy5.txt<br />tftpboot 0x400000 openwrt-wnr854t-jffs2-128k.release+ipv6-luci.img<br />bootm 0x400000<br />Ctrl-a : hardcopy -h 854hardcopy6.txt</p></blockquote></div><p>Now, I should have jff2 image with luci working, so luci will test md5 for me...<br /></p><div class="codebox"><pre><code>         __  __                      _ _
        |  \/  | __ _ _ ____   _____| | |
        | |\/| |/ _` | &#039;__\ \ / / _ \ | |
        | |  | | (_| | |   \ V /  __/ | |
        |_|  |_|\__,_|_|    \_/ \___|_|_|
 _   _     ____              _
| | | |   | __ )  ___   ___ | |_
| | | |___|  _ \ / _ \ / _ \| __|
| |_| |___| |_) | (_) | (_) | |_
 \___/    |____/ \___/ \___/ \__|  ** LOADER **
 ** MARVELL BOARD: RD-88F5181L-VOIP-GE LE GE RT v1.05

U-Boot 1.1.1 (Apr 18 2007 - 16:05:00) Marvell version: 1.7.3

DRAM CS[0] base 0x00000000   size  32MB
DRAM Total size  32MB
[8192kB@ff800000] Flash:  8 MB
Addresses 20M - 0M are saved for the U-Boot usage.
Mem malloc Initialization (20M - 16M): Done
*** Warning - bad CRC, using default environment


Soc: 88F5181 B1
CPU: ARM926 (Rev 0) running @ 500Mhz
SysClock = 166Mhz , TClock = 166Mhz


USB 0: host mode
PCI 0: PCI Express Root Complex Interface
PCI 1: Conventional PCI, speed = 33000000
Net:   egiga0 [PRIME]
Hit any key to stop autoboot:  0
Marvell&gt;&gt; run standalone
### JFFS2 loading &#039;uImage&#039; to 0x400000
Scanning JFFS2 FS: .......  Unknown node type: 2006 len 8504 offset 0x2fdec8  .
 Unknown node type: 2006 len 13724 offset 0x3bca64                            -
Unknown node type: 2006 len 6140 offset 0x3de804                              .
 Unknown node type: 2006 len 8500 offset 0x3fdecc                             .
 Unknown node type: 2006 len 13364 offset 0x41cbcc                             d
one.
find_inode failed for name=uImage
load: Failed to find inode
### JFFS2 LOAD ERROR&lt;0&gt; for uImage!
## Booting image at 00400000 ...
Bad Magic Number...do_bootm
Start Gemtek tftpd for Netgear GE RT!
TFTP Server IP is : 192.168.1.1
Load address: 0x400000</code></pre></div><p>Surprise! I don&#039;t have a working image as when turn off, but luci is still installed:<br /></p><div class="codebox"><pre><code>Abort
Marvell&gt;&gt; tftpboot 0x400000 openwrt-wnr854t-jffs2-128k.release+ipv6-luci.img
Using egiga0 device
TFTP from server 192.168.1.2; our IP address is 192.168.1.1
Filename &#039;openwrt-wnr854t-jffs2-128k.release+ipv6-luci.img&#039;.
Load address: 0x400000
Loading: #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         ##############################
done
Bytes transferred = 3145732 (300004 hex)
Marvell&gt;&gt; bootm 0x400000
## Booting image at 00400000 ...
   Image Name:   Linux-3.0.3
   Created:      2011-10-19  18:09:14 UTC
   Image Type:   ARM Linux Kernel Image (uncompressed)
   Data Size:    1050192 Bytes =  1 MB
   Load Address: 00008000
   Entry Point:  00008000
   Verifying Checksum ... OK
OK

Starting kernel ...

Uncompressing Linux... done, booting the kernel.
Linux version 3.0.3 (maddes@devdebian6-amd64) (gcc version 4.5.4 20110808 (prere
lease) (Linaro GCC 4.5-2011.08) ) #3 Wed Oct 19 20:09:07 CEST 2011
CPU: Feroceon [41069260] revision 0 (ARMv5TEJ), cr=a0053177
CPU: VIVT data cache, VIVT instruction cache
Machine: Netgear WNR854T
Clearing invalid memory bank 0KB@0xffffffff
Clearing invalid memory bank 0KB@0xffffffff
Clearing invalid memory bank 0KB@0xffffffff
Ignoring unrecognised tag 0x00000000
Ignoring unrecognised tag 0x00000000
Ignoring unrecognised tag 0x00000000
Ignoring tag cmdline (using the default kernel command line)
Memory policy: ECC disabled, Data cache writeback
Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 8128
Kernel command line: root=/dev/mtdblock1 rootfstype=squashfs,jffs2 noinitrd cons
ole=ttyS0,115200
PID hash table entries: 128 (order: -3, 512 bytes)
Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
Memory: 32MB = 32MB total
Memory: 29508k/29508k available, 3260k reserved, 0K highmem
Virtual kernel memory layout:
    vector  : 0xffff0000 - 0xffff1000   (   4 kB)
    fixmap  : 0xfff00000 - 0xfffe0000   ( 896 kB)
    DMA     : 0xffc00000 - 0xffe00000   (   2 MB)
    vmalloc : 0xc2800000 - 0xfd800000   ( 944 MB)
    lowmem  : 0xc0000000 - 0xc2000000   (  32 MB)
    modules : 0xbf000000 - 0xc0000000   (  16 MB)
      .init : 0xc0008000 - 0xc0024000   ( 112 kB)
      .text : 0xc0024000 - 0xc02bd000   (2660 kB)
      .data : 0xc02be000 - 0xc02d2480   (  82 kB)
       .bss : 0xc02d24a4 - 0xc02dec64   (  50 kB)
NR_IRQS:64
sched_clock: 32 bits at 166MHz, resolution 5ns, wraps every 25769ms
Calibrating delay loop... 331.77 BogoMIPS (lpj=1658880)
pid_max: default: 32768 minimum: 301
Mount-cache hash table entries: 512
CPU: Testing write buffer coherency: ok
NET: Registered protocol family 16
Orion ID: MV88F5181-Rev-B1. TCLK=166666667.
MPP setup: unknown orion5x variant (dev 0x5181 rev 0x3)
Applying Orion-1/Orion-NAS PCIe config read transaction workaround
PCI: bus0: Fast back to back transfers disabled
PCI: bus1: Fast back to back transfers enabled
pci 0000:01:07.0: BAR 0: assigned [mem 0xe8000000-0xe800ffff]
pci 0000:01:07.0: BAR 0: set to [mem 0xe8000000-0xe800ffff] (PCI address [0xe800
0000-0xe800ffff])
pci 0000:01:07.0: BAR 1: assigned [mem 0xe8010000-0xe801ffff]
pci 0000:01:07.0: BAR 1: set to [mem 0xe8010000-0xe801ffff] (PCI address [0xe801
0000-0xe801ffff])
bio: create slab &lt;bio-0&gt; at 0
Switching to clocksource orion_clocksource
NET: Registered protocol family 2
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 1024 (order: 1, 8192 bytes)
TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
TCP: Hash tables configured (established 1024 bind 1024)
TCP reno registered
UDP hash table entries: 256 (order: 0, 4096 bytes)
UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
NET: Registered protocol family 1
squashfs: version 4.0 (2009/01/31) Phillip Lougher
JFFS2 version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006
 Red Hat, Inc.
msgmni has been set to 57
io scheduler noop registered
io scheduler deadline registered (default)
Serial: 8250/16550 driver, 2 ports, IRQ sharing disabled
serial8250.0: ttyS0 at MMIO 0xf1012000 (irq = 3) is a 16550A
console [ttyS0] enabled
physmap platform flash device: 00800000 at f4000000
physmap-flash.0: Found 1 x16 devices at 0x0 in 16-bit bank. Manufacturer ID 0x00
0089 Chip ID 0x000017
Intel/Sharp Extended Query Table at 0x0031
Intel/Sharp Extended Query Table at 0x0031
Using buffer write method
cfi_cmdset_0001: Erase suspend on write enabled
Using physmap partition information
Creating 4 MTD partitions on &quot;physmap-flash.0&quot;:
0x000000000000-0x000000120000 : &quot;kernel&quot;
0x000000120000-0x000000760000 : &quot;rootfs&quot;
mtd: partition &quot;rootfs&quot; set to be root filesystem
split_squashfs: no squashfs found in &quot;physmap-flash.0&quot;
0x000000760000-0x0000007a0000 : &quot;uboot&quot;
0x000000000000-0x000000760000 : &quot;image&quot;
mv643xx_eth: MV-643xx 10/100/1000 ethernet driver version 1.4
mv643xx_eth smi: probed
mv643xx_eth_port mv643xx_eth_port.0: eth0: port 0 with MAC address 00:00:00:00:5
1:81
i2c /dev entries driver
TCP westwood registered
NET: Registered protocol family 17
Bridge firewalling registered
Distributed Switch Architecture driver version 0.1
eth0[0]: detected a Marvell 88E6131 switch
dsa slave smi: probed
802.1Q VLAN Support v1.8
drivers/rtc/hctosys.c: unable to open rtc device (rtc0)
JFFS2 notice: (1) jffs2_build_xattr_subsystem: complete building xattr subsystem
, 0 of xdatum (0 unchecked, 0 orphan) and 0 of xref (0 dead, 0 orphan) found.
VFS: Mounted root (jffs2 filesystem) on device 31:1.
Freeing init memory: 112K
- preinit -
Press the [f] key and hit [enter] to enter failsafe mode
- regular preinit -
- init -

Please press Enter to activate this console. mv643xx_eth_port mv643xx_eth_port.0
: eth0: link up, 1000 Mb/s, full duplex, flow control disabled
device lan3 entered promiscuous mode
device eth0 entered promiscuous mode
device eth0 left promiscuous mode
br-lan: port 1(lan3) entering disabled state
device eth0 entered promiscuous mode
device lan4 entered promiscuous mode
br-lan: port 2(lan4) entering disabled state
device lan1 entered promiscuous mode
br-lan: port 3(lan1) entering disabled state
 ttyS0: 1 input overrun(s)
port 3(lan1) lan1: link up, 1000 Mb/s, full duplex, flow control disabled
br-lan: port 3(lan1) entering forwarding state
br-lan: port 3(lan1) entering forwarding state
device lan2 entered promiscuous mode
br-lan: port 4(lan2) entering disabled state
Compat-wireless backport release: compat-wireless-2011-09-28-6-g8163a60
Backport based on wireless-testing.git master-2011-10-05
cfg80211: Calling CRDA to update world regulatory domain
cfg80211: World regulatory domain updated:
cfg80211:     (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp)
cfg80211:     (2402000 KHz - 2472000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (2457000 KHz - 2482000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (2474000 KHz - 2494000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (5170000 KHz - 5250000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (5735000 KHz - 5835000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
PPP generic driver version 2.4.2
ip_tables: (C) 2000-2006 Netfilter Core Team
NET: Registered protocol family 24
nf_conntrack version 0.5.0 (462 buckets, 1848 max)



BusyBox v1.18.5 (2011-10-15 22:09:28 CEST) built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 ATTITUDE ADJUSTMENT (bleeding edge, r28489) ----------
  * 1/4 oz Vodka      Pour all ingredients into mixing
  * 1/4 oz Gin        tin with ice, strain into glass.
  * 1/4 oz Amaretto
  * 1/4 oz Triple sec
  * 1/4 oz Peach schnapps
  * 1/4 oz Sour mix
  * 1 splash Cranberry juice
 -----------------------------------------------------
root@OpenWrt:/# opkg list-installed
base-files - 82-r28489
busybox - 1.18.5-1
crda - 1.1.1-1
dnsmasq - 2.58-1
dropbear - 0.53.1-4
firewall - 2-35
hotplug2 - 1.0-beta-4
iptables - 1.4.10-4
iptables-mod-conntrack - 1.4.10-4
iptables-mod-nat - 1.4.10-4
iw - 3.1-1
kernel - 3.0.3-1
kmod-ath - 3.0.3+2011-10-05-1
kmod-ath9k - 3.0.3+2011-10-05-1
kmod-ath9k-common - 3.0.3+2011-10-05-1
kmod-cfg80211 - 3.0.3+2011-10-05-1
kmod-crc-ccitt - 3.0.3-1
kmod-crypto-arc4 - 3.0.3-1
kmod-ipt-conntrack - 3.0.3-1
kmod-ipt-core - 3.0.3-1
kmod-ipt-nat - 3.0.3-1
kmod-ipt-nathelper - 3.0.3-1
kmod-mac80211 - 3.0.3+2011-10-05-1
kmod-ppp - 3.0.3-1
kmod-pppoe - 3.0.3-1
libc - 0.9.32-82
libgcc - 4.5-linaro-82
libip4tc - 1.4.10-4
libiwinfo - 16
liblua - 5.1.4-8
libnl-tiny - 0.1-2
libuci - 2011-07-18.3-1
libuci-lua - 2011-07-18.3-1
libxtables - 1.4.10-4
lua - 5.1.4-8
luci - trunk+svn7746-1
luci-app-firewall - trunk+svn7746-1
luci-i18n-english - trunk+svn7746-1
luci-lib-core - trunk+svn7746-1
luci-lib-ipkg - trunk+svn7746-1
luci-lib-lmo - trunk+svn7746-1
luci-lib-nixio - trunk+svn7746-1
luci-lib-sys - trunk+svn7746-1
luci-lib-web - trunk+svn7746-1
luci-mod-admin-core - trunk+svn7746-1
luci-mod-admin-full - trunk+svn7746-1
luci-proto-core - trunk+svn7746-1
luci-proto-ppp - trunk+svn7746-1
luci-sgi-cgi - trunk+svn7746-1
luci-theme-base - trunk+svn7746-1
luci-theme-openwrt - trunk+svn7746-1
maddes - 1.0-1
mtd - 16
opkg - 618-2
ppp - 2.4.5-2
ppp-mod-pppoe - 2.4.5-2
uci - 2011-07-18.3-1
uhttpd - 27
wireless-tools - 29-4
wpad-mini - 20110527-2</code></pre></div><p>At this point squashfs upload was done with luci:<br /></p><div class="codebox"><pre><code>root@OpenWrt:/# Restarting system.

         __  __                      _ _
        |  \/  | __ _ _ ____   _____| | |
        | |\/| |/ _` | &#039;__\ \ / / _ \ | |
        | |  | | (_| | |   \ V /  __/ | |
        |_|  |_|\__,_|_|    \_/ \___|_|_|
 _   _     ____              _
| | | |   | __ )  ___   ___ | |_
| | | |___|  _ \ / _ \ / _ \| __|
| |_| |___| |_) | (_) | (_) | |_
 \___/    |____/ \___/ \___/ \__|  ** LOADER **
 ** MARVELL BOARD: RD-88F5181L-VOIP-GE LE GE RT v1.05

U-Boot 1.1.1 (Apr 18 2007 - 16:05:00) Marvell version: 1.7.3

DRAM CS[0] base 0x00000000   size  32MB
DRAM Total size  32MB
[8192kB@ff800000] Flash:  8 MB
Addresses 20M - 0M are saved for the U-Boot usage.
Mem malloc Initialization (20M - 16M): Done
*** Warning - bad CRC, using default environment


Soc: 88F5181 B1
CPU: ARM926 (Rev 0) running @ 500Mhz
SysClock = 166Mhz , TClock = 166Mhz


USB 0: host mode
PCI 0: PCI Express Root Complex Interface
PCI 1: Conventional PCI, speed = 33000000
Net:   egiga0 [PRIME]
Hit any key to stop autoboot:  0
Marvell&gt;&gt; run standalone
### JFFS2 loading &#039;uImage&#039; to 0x400000
Scanning JFFS2 FS: .  Unknown node type: 2006 len 8504 offset 0x2fdec8        .
 Unknown node type: 2006 len 13724 offset 0x3bca64                            -
Unknown node type: 2006 len 6140 offset 0x3de804                              .
 Unknown node type: 2006 len 8500 offset 0x3fdecc                             .
 Unknown node type: 2006 len 13364 offset 0x41cbcc                             d
one.
find_inode failed for name=uImage
load: Failed to find inode
### JFFS2 LOAD ERROR&lt;0&gt; for uImage!
## Booting image at 00400000 ...
   Image Name:   Linux-3.0.3
   Created:      2011-10-19  18:09:14 UTC
   Image Type:   ARM Linux Kernel Image (uncompressed)
   Data Size:    1050192 Bytes =  1 MB
   Load Address: 00008000
   Entry Point:  00008000
   Verifying Checksum ... OK
OK

Starting kernel ...

Uncompressing Linux... done, booting the kernel.
Linux version 3.0.3 (maddes@devdebian6-amd64) (gcc version 4.5.4 20110808 (prere
lease) (Linaro GCC 4.5-2011.08) ) #3 Wed Oct 19 20:09:07 CEST 2011
CPU: Feroceon [41069260] revision 0 (ARMv5TEJ), cr=a0053177
CPU: VIVT data cache, VIVT instruction cache
Machine: Netgear WNR854T
Clearing invalid memory bank 0KB@0xffffffff
Clearing invalid memory bank 0KB@0xffffffff
Clearing invalid memory bank 0KB@0xffffffff
Ignoring unrecognised tag 0x00000000
Ignoring unrecognised tag 0x00000000
Ignoring unrecognised tag 0x00000000
Ignoring tag cmdline (using the default kernel command line)
Memory policy: ECC disabled, Data cache writeback
Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 8128
Kernel command line: root=/dev/mtdblock1 rootfstype=squashfs,jffs2 noinitrd cons
ole=ttyS0,115200
PID hash table entries: 128 (order: -3, 512 bytes)
Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
Memory: 32MB = 32MB total
Memory: 29508k/29508k available, 3260k reserved, 0K highmem
Virtual kernel memory layout:
    vector  : 0xffff0000 - 0xffff1000   (   4 kB)
    fixmap  : 0xfff00000 - 0xfffe0000   ( 896 kB)
    DMA     : 0xffc00000 - 0xffe00000   (   2 MB)
    vmalloc : 0xc2800000 - 0xfd800000   ( 944 MB)
    lowmem  : 0xc0000000 - 0xc2000000   (  32 MB)
    modules : 0xbf000000 - 0xc0000000   (  16 MB)
      .init : 0xc0008000 - 0xc0024000   ( 112 kB)
      .text : 0xc0024000 - 0xc02bd000   (2660 kB)
      .data : 0xc02be000 - 0xc02d2480   (  82 kB)
       .bss : 0xc02d24a4 - 0xc02dec64   (  50 kB)
NR_IRQS:64
sched_clock: 32 bits at 166MHz, resolution 5ns, wraps every 25769ms
Calibrating delay loop... 331.77 BogoMIPS (lpj=1658880)
pid_max: default: 32768 minimum: 301
Mount-cache hash table entries: 512
CPU: Testing write buffer coherency: ok
NET: Registered protocol family 16
Orion ID: MV88F5181-Rev-B1. TCLK=166666667.
MPP setup: unknown orion5x variant (dev 0x5181 rev 0x3)
Applying Orion-1/Orion-NAS PCIe config read transaction workaround
PCI: bus0: Fast back to back transfers disabled
PCI: bus1: Fast back to back transfers enabled
pci 0000:01:07.0: BAR 0: assigned [mem 0xe8000000-0xe800ffff]
pci 0000:01:07.0: BAR 0: set to [mem 0xe8000000-0xe800ffff] (PCI address [0xe800
0000-0xe800ffff])
pci 0000:01:07.0: BAR 1: assigned [mem 0xe8010000-0xe801ffff]
pci 0000:01:07.0: BAR 1: set to [mem 0xe8010000-0xe801ffff] (PCI address [0xe801
0000-0xe801ffff])
bio: create slab &lt;bio-0&gt; at 0
Switching to clocksource orion_clocksource
NET: Registered protocol family 2
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 1024 (order: 1, 8192 bytes)
TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
TCP: Hash tables configured (established 1024 bind 1024)
TCP reno registered
UDP hash table entries: 256 (order: 0, 4096 bytes)
UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
NET: Registered protocol family 1
squashfs: version 4.0 (2009/01/31) Phillip Lougher
JFFS2 version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006
 Red Hat, Inc.
msgmni has been set to 57
io scheduler noop registered
io scheduler deadline registered (default)
Serial: 8250/16550 driver, 2 ports, IRQ sharing disabled
serial8250.0: ttyS0 at MMIO 0xf1012000 (irq = 3) is a 16550A
console [ttyS0] enabled
physmap platform flash device: 00800000 at f4000000
physmap-flash.0: Found 1 x16 devices at 0x0 in 16-bit bank. Manufacturer ID 0x00
0089 Chip ID 0x000017
Intel/Sharp Extended Query Table at 0x0031
Intel/Sharp Extended Query Table at 0x0031
Using buffer write method
cfi_cmdset_0001: Erase suspend on write enabled
Using physmap partition information
Creating 4 MTD partitions on &quot;physmap-flash.0&quot;:
0x000000000000-0x000000120000 : &quot;kernel&quot;
0x000000120000-0x000000760000 : &quot;rootfs&quot;
mtd: partition &quot;rootfs&quot; set to be root filesystem
mtd: partition &quot;rootfs_data&quot; created automatically, ofs=280000, len=4E0000
0x000000280000-0x000000760000 : &quot;rootfs_data&quot;
0x000000760000-0x0000007a0000 : &quot;uboot&quot;
0x000000000000-0x000000760000 : &quot;image&quot;
mv643xx_eth: MV-643xx 10/100/1000 ethernet driver version 1.4
mv643xx_eth smi: probed
mv643xx_eth_port mv643xx_eth_port.0: eth0: port 0 with MAC address 00:00:00:00:5
1:81
i2c /dev entries driver
TCP westwood registered
NET: Registered protocol family 17
Bridge firewalling registered
Distributed Switch Architecture driver version 0.1
eth0[0]: detected a Marvell 88E6131 switch
dsa slave smi: probed
802.1Q VLAN Support v1.8
drivers/rtc/hctosys.c: unable to open rtc device (rtc0)
VFS: Mounted root (squashfs filesystem) readonly on device 31:1.
Freeing init memory: 112K
- preinit -
Press the [f] key and hit [enter] to enter failsafe mode
- regular preinit -
jffs2 not ready yet; using ramdisk
- init -

Please press Enter to activate this console. mv643xx_eth_port mv643xx_eth_port.0
: eth0: link up, 1000 Mb/s, full duplex, flow control disabled
device lan3 entered promiscuous mode
device eth0 entered promiscuous mode
device eth0 left promiscuous mode
br-lan: port 1(lan3) entering disabled state
device eth0 entered promiscuous mode
device lan4 entered promiscuous mode
br-lan: port 2(lan4) entering disabled state
device lan1 entered promiscuous mode
lan1: link up, 1000 Mb/s, full duplex, flow control disabled
br-lan: port 3(lan1) entering forwarding state
br-lan: port 3(lan1) entering forwarding state
br-lan: port 3(lan1) entering forwarding state
br-lan: port 3(lan1) entering forwarding state
br-lan: port 3(lan1) entering forwarding state
device lan2 entered promiscuous mode
br-lan: port 4(lan2) entering disabled state
Compat-wireless backport release: compat-wireless-2011-09-28-6-g8163a60
Backport based on wireless-testing.git master-2011-10-05
cfg80211: Calling CRDA to update world regulatory domain
cfg80211: World regulatory domain updated:
cfg80211:     (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp)
cfg80211:     (2402000 KHz - 2472000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (2457000 KHz - 2482000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (2474000 KHz - 2494000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (5170000 KHz - 5250000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (5735000 KHz - 5835000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
PPP generic driver version 2.4.2
ip_tables: (C) 2000-2006 Netfilter Core Team
NET: Registered protocol family 24
nf_conntrack version 0.5.0 (462 buckets, 1848 max)
ttyS0: 1 input overrun(s)
jffs2_scan_eraseblock(): End of filesystem marker found at 0x0
jffs2_build_filesystem(): unlocking the mtd device... done.
jffs2_build_filesystem(): erasing all blocks after the end marker... done.
JFFS2 notice: (2045) jffs2_build_xattr_subsystem: complete building xattr subsys
tem, 0 of xdatum (0 unchecked, 0 orphan) and 0 of xref (0 dead, 0 orphan) found.
cttyS0: 1 input overrun(s)



BusyBox v1.18.5 (2011-10-15 22:09:28 CEST) built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 ATTITUDE ADJUSTMENT (bleeding edge, r28489) ----------
  * 1/4 oz Vodka      Pour all ingredients into mixing
  * 1/4 oz Gin        tin with ice, strain into glass.
  * 1/4 oz Amaretto
  * 1/4 oz Triple sec
  * 1/4 oz Peach schnapps
  * 1/4 oz Sour mix
  * 1 splash Cranberry juice
 -----------------------------------------------------
root@OpenWrt:/# reboot
root@OpenWrt:/# br-lan: port 3(lan1) entering forwarding state
device eth0 left promiscuous mode
device lan2 left promiscuous mode
br-lan: port 4(lan2) entering disabled state
ttyS0: 1 input overrun(s)
device lan1 left promiscuous mode
br-lan: port 3(lan1) entering disabled state
device lan4 left promiscuous mode
br-lan: port 2(lan4) entering disabled state
device lan3 left promiscuous mode
br-lan: port 1(lan3) entering disabled state
lan1: link down
Restarting system.

         __  __                      _ _
        |  \/  | __ _ _ ____   _____| | |
        | |\/| |/ _` | &#039;__\ \ / / _ \ | |
        | |  | | (_| | |   \ V /  __/ | |
        |_|  |_|\__,_|_|    \_/ \___|_|_|
 _   _     ____              _
| | | |   | __ )  ___   ___ | |_
| | | |___|  _ \ / _ \ / _ \| __|
| |_| |___| |_) | (_) | (_) | |_
 \___/    |____/ \___/ \___/ \__|  ** LOADER **
 ** MARVELL BOARD: RD-88F5181L-VOIP-GE LE GE RT v1.05

U-Boot 1.1.1 (Apr 18 2007 - 16:05:00) Marvell version: 1.7.3

DRAM CS[0] base 0x00000000   size  32MB
DRAM Total size  32MB
[8192kB@ff800000] Flash:  8 MB
Addresses 20M - 0M are saved for the U-Boot usage.
Mem malloc Initialization (20M - 16M): Done
*** Warning - bad CRC, using default environment


Soc: 88F5181 B1
CPU: ARM926 (Rev 0) running @ 500Mhz
SysClock = 166Mhz , TClock = 166Mhz


USB 0: host mode
PCI 0: PCI Express Root Complex Interface
PCI 1: Conventional PCI, speed = 33000000
Net:   egiga0 [PRIME]
Hit any key to stop autoboot:  0
Marvell&gt;&gt; run standalone
### JFFS2 loading &#039;uImage&#039; to 0x400000
Scanning JFFS2 FS: .  Unknown node type: e008 len 52 offset 0x721d68
Unknown node type: e009 len 28 offset 0x721d9c
Unknown node type: e009 len 28 offset 0x721f90
Unknown node type: e009 len 28 offset 0x7223e4                                 d
one.
find_inode failed for name=uImage
load: Failed to find inode
### JFFS2 LOAD ERROR&lt;0&gt; for uImage!
## Booting image at 00400000 ...
   Image Name:   Linux-3.0.3
   Created:      2011-10-19  18:09:14 UTC
   Image Type:   ARM Linux Kernel Image (uncompressed)
   Data Size:    1050192 Bytes =  1 MB
   Load Address: 00008000
   Entry Point:  00008000
   Verifying Checksum ... OK
OK

Starting kernel ...

Uncompressing Linux... done, booting the kernel.
Linux version 3.0.3 (maddes@devdebian6-amd64) (gcc version 4.5.4 20110808 (prere
lease) (Linaro GCC 4.5-2011.08) ) #3 Wed Oct 19 20:09:07 CEST 2011
CPU: Feroceon [41069260] revision 0 (ARMv5TEJ), cr=a0053177
CPU: VIVT data cache, VIVT instruction cache
Machine: Netgear WNR854T
Clearing invalid memory bank 0KB@0xffffffff
Clearing invalid memory bank 0KB@0xffffffff
Clearing invalid memory bank 0KB@0xffffffff
Ignoring unrecognised tag 0x00000000
Ignoring unrecognised tag 0x00000000
Ignoring unrecognised tag 0x00000000
Ignoring tag cmdline (using the default kernel command line)
Memory policy: ECC disabled, Data cache writeback
Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 8128
Kernel command line: root=/dev/mtdblock1 rootfstype=squashfs,jffs2 noinitrd cons
ole=ttyS0,115200
PID hash table entries: 128 (order: -3, 512 bytes)
Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
Memory: 32MB = 32MB total
Memory: 29508k/29508k available, 3260k reserved, 0K highmem
Virtual kernel memory layout:
    vector  : 0xffff0000 - 0xffff1000   (   4 kB)
    fixmap  : 0xfff00000 - 0xfffe0000   ( 896 kB)
    DMA     : 0xffc00000 - 0xffe00000   (   2 MB)
    vmalloc : 0xc2800000 - 0xfd800000   ( 944 MB)
    lowmem  : 0xc0000000 - 0xc2000000   (  32 MB)
    modules : 0xbf000000 - 0xc0000000   (  16 MB)
      .init : 0xc0008000 - 0xc0024000   ( 112 kB)
      .text : 0xc0024000 - 0xc02bd000   (2660 kB)
      .data : 0xc02be000 - 0xc02d2480   (  82 kB)
       .bss : 0xc02d24a4 - 0xc02dec64   (  50 kB)
NR_IRQS:64
sched_clock: 32 bits at 166MHz, resolution 5ns, wraps every 25769ms
Calibrating delay loop... 331.77 BogoMIPS (lpj=1658880)
pid_max: default: 32768 minimum: 301
Mount-cache hash table entries: 512
CPU: Testing write buffer coherency: ok
NET: Registered protocol family 16
Orion ID: MV88F5181-Rev-B1. TCLK=166666667.
MPP setup: unknown orion5x variant (dev 0x5181 rev 0x3)
Applying Orion-1/Orion-NAS PCIe config read transaction workaround
PCI: bus0: Fast back to back transfers disabled
PCI: bus1: Fast back to back transfers enabled
pci 0000:01:07.0: BAR 0: assigned [mem 0xe8000000-0xe800ffff]
pci 0000:01:07.0: BAR 0: set to [mem 0xe8000000-0xe800ffff] (PCI address [0xe800
0000-0xe800ffff])
pci 0000:01:07.0: BAR 1: assigned [mem 0xe8010000-0xe801ffff]
pci 0000:01:07.0: BAR 1: set to [mem 0xe8010000-0xe801ffff] (PCI address [0xe801
0000-0xe801ffff])
bio: create slab &lt;bio-0&gt; at 0
Switching to clocksource orion_clocksource
NET: Registered protocol family 2
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 1024 (order: 1, 8192 bytes)
TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
TCP: Hash tables configured (established 1024 bind 1024)
TCP reno registered
UDP hash table entries: 256 (order: 0, 4096 bytes)
UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
NET: Registered protocol family 1
squashfs: version 4.0 (2009/01/31) Phillip Lougher
JFFS2 version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006
 Red Hat, Inc.
msgmni has been set to 57
io scheduler noop registered
io scheduler deadline registered (default)
Serial: 8250/16550 driver, 2 ports, IRQ sharing disabled
serial8250.0: ttyS0 at MMIO 0xf1012000 (irq = 3) is a 16550A
console [ttyS0] enabled
physmap platform flash device: 00800000 at f4000000
physmap-flash.0: Found 1 x16 devices at 0x0 in 16-bit bank. Manufacturer ID 0x00
0089 Chip ID 0x000017
Intel/Sharp Extended Query Table at 0x0031
Intel/Sharp Extended Query Table at 0x0031
Using buffer write method
cfi_cmdset_0001: Erase suspend on write enabled
Using physmap partition information
Creating 4 MTD partitions on &quot;physmap-flash.0&quot;:
0x000000000000-0x000000120000 : &quot;kernel&quot;
0x000000120000-0x000000760000 : &quot;rootfs&quot;
mtd: partition &quot;rootfs&quot; set to be root filesystem
mtd: partition &quot;rootfs_data&quot; created automatically, ofs=280000, len=4E0000
0x000000280000-0x000000760000 : &quot;rootfs_data&quot;
0x000000760000-0x0000007a0000 : &quot;uboot&quot;
0x000000000000-0x000000760000 : &quot;image&quot;
mv643xx_eth: MV-643xx 10/100/1000 ethernet driver version 1.4
mv643xx_eth smi: probed
mv643xx_eth_port mv643xx_eth_port.0: eth0: port 0 with MAC address 00:00:00:00:5
1:81
i2c /dev entries driver
TCP westwood registered
NET: Registered protocol family 17
Bridge firewalling registered
Distributed Switch Architecture driver version 0.1
eth0[0]: detected a Marvell 88E6131 switch
dsa slave smi: probed
802.1Q VLAN Support v1.8
drivers/rtc/hctosys.c: unable to open rtc device (rtc0)
VFS: Mounted root (squashfs filesystem) readonly on device 31:1.
Freeing init memory: 112K
- preinit -
Press the [f] key and hit [enter] to enter failsafe mode
- regular preinit -
JFFS2 notice: (1304) jffs2_build_xattr_subsystem: complete building xattr subsy
stem, 1 of xdatum (0 unchecked, 0 orphan) and 3 of xref (0 dead, 2 orphan) found
.
[ttyS0: 1 input overrun(s)
complete switching to jffs2
- init -

Please press Enter to activate this console.

BusyBox v1.18.5 (2011-10-15 22:09:28 CEST) built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 ATTITUDE ADJUSTMENT (bleeding edge, r28489) ----------
  * 1/4 oz Vodka      Pour all ingredients into mixing
  * 1/4 oz Gin        tin with ice, strain into glass.
  * 1/4 oz Amaretto
  * 1/4 oz Triple sec
  * 1/4 oz Peach schnapps
  * 1/4 oz Sour mix
  * 1 splash Cranberry juice
 -----------------------------------------------------
root@(none):/# complete mv643xx_eth_port mv643xx_eth_port.0: eth0: l
ink up, 1000 Mb/s, full duplex, flow control disabled
device lan3 entered promiscuous mode
device eth0 entered promiscuous mode
device eth0 left promiscuous mode
br-lan: port 1(lan3) entering disabled state
device eth0 entered promiscuous mode
ttyS0: 1 input overrun(s)
eth0 entered device lan4 entered promiscuous mode
br-lan: port 2(lan4) entering disabled state
device lan1 entered promiscuous mode
br-lan: port 3(lan1) entering disabled state
ttyS0: 1 input overrun(s)
lan1: link up, 1000 Mb/s, full duplex, flow control disabled
br-lan: port 3(lan1) entering forwarding state
br-lan: port 3(lan1) entering forwarding state
device lan2 entered promiscuous mode
br-lan: port 4(lan2) entering disabled state
Compat-wireless backport release: compat-wireless-2011-09-28-6-g8163a60
Backport based on wireless-testing.git master-2011-10-05
cfg80211: Calling CRDA to update world regulatory domain
cfg80211: World regulatory domain updated:
cfg80211:     (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp)
cfg80211:     (2402000 KHz - 2472000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (2457000 KHz - 2482000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (2474000 KHz - 2494000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (5170000 KHz - 5250000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (5735000 KHz - 5835000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
PPP generic driver version 2.4.2
ip_tables: (C) 2000-2006 Netfilter Core Team
NET: Registered protocol family 24
nf_conntrack version 0.5.0 (462 buckets, 1848 max)</code></pre></div><p>And then screen hangs.<br />So, I will prepare a normal image to test if boot twice. I remember &quot;Bad magic number&quot; issue raises when switching FS and solves uploading an old vendor image.<br />Edit: DONE<br />- normal image test. Success: Boot many times.<br />TODO:<br />- squashfs padded test.<br />- squashfs not booting after a power cycle log.</p>											<p class="post-edited">(Last edited by <strong>Nilfred</strong> on 21 Oct 2011, 05:15)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p146793">
				<div class="post-metadata">
					<div class="post-num">Post #1046</div>
					<div class="post-author">Nilfred</div>
					<div class="post-datetime">
						27 Oct 2011, 04:49					</div>
				</div>
				<div class="post-content content">
					<p>Boot with official r28475:<br /></p><div class="codebox"><pre><code>         __  __                      _ _
        |  \/  | __ _ _ ____   _____| | |
        | |\/| |/ _` | &#039;__\ \ / / _ \ | |
        | |  | | (_| | |   \ V /  __/ | |
        |_|  |_|\__,_|_|    \_/ \___|_|_|
 _   _     ____              _
| | | |   | __ )  ___   ___ | |_
| | | |___|  _ \ / _ \ / _ \| __|
| |_| |___| |_) | (_) | (_) | |_
 \___/    |____/ \___/ \___/ \__|  ** LOADER **
 ** MARVELL BOARD: RD-88F5181L-VOIP-GE LE GE RT v1.05

U-Boot 1.1.1 (Apr 18 2007 - 16:05:00) Marvell version: 1.7.3

DRAM CS[0] base 0x00000000   size  32MB
DRAM Total size  32MB
[8192kB@ff800000] Flash:  8 MB
Addresses 20M - 0M are saved for the U-Boot usage.
Mem malloc Initialization (20M - 16M): Done
*** Warning - bad CRC, using default environment


Soc: 88F5181 B1
CPU: ARM926 (Rev 0) running @ 500Mhz
SysClock = 166Mhz , TClock = 166Mhz


USB 0: host mode
PCI 0: PCI Express Root Complex Interface
PCI 1: Conventional PCI, speed = 33000000
Net:   egiga0 [PRIME]
Hit any key to stop autoboot:  0
### JFFS2 loading &#039;uImage&#039; to 0x400000
Scanning JFFS2 FS: ./ Unknown node type: 2006 len 2268 offset 0x3bf724        -
Unknown node type: 2006 len 1432 offset 0x3dfa68
Unknown node type: 2006 len 1140 offset 0x3ffb8c                              \
Unknown node type: 2006 len 1104 offset 0x41fbb0
Unknown node type: 2006 len 1212 offset 0x43fb44                              |
Unknown node type: 2006 len 2600 offset 0x45f5d8                              .
 Unknown node type: 2006 len 10616 offset 0x47d688                            /
Unknown node type: 2006 len 8628 offset 0x49de4c
Unknown node type: 2006 len 2332 offset 0x4bf6e4                              -
Unknown node type: 2006 len 3536 offset 0x4df230                              .
 Unknown node type: 2006 len 12120 offset 0x4fd0a8                            .
 Unknown node type: 2006 len 8144 offset 0x51e030
Unknown node type: 2006 len 4336 offset 0x53ef10                              .
 Unknown node type: 2006 len 12708 offset 0x57ce5c                            .
 Unknown node type: 2006 len 14424 offset 0x59c7a8
Unknown node type: 2006 len 5108 offset 0x5bec0c                              .
 Unknown node type: 2006 len 9188 offset 0x5ddc1c
Unknown node type: 2006 len 13044 offset 0x5fcd0c                             .
 Unknown node type: e008 len 52 offset 0x7217d4
Unknown node type: e009 len 28 offset 0x721808
Unknown node type: e009 len 28 offset 0x7219fc
Unknown node type: e009 len 28 offset 0x721e50
Unknown node type: 2006 len 11912 offset 0x73d178                              d
one.
### JFFS2 load complete: 935020 bytes loaded to 0x400000
## Booting image at 00400000 ...
   Image Name:   Linux-3.0.3
   Created:      2011-10-18  11:50:35 UTC
   Image Type:   ARM Linux Kernel Image (uncompressed)
   Data Size:    934956 Bytes = 913 kB
   Load Address: 00008000
   Entry Point:  00008000
   Verifying Checksum ... OK
OK

Starting kernel ...

Uncompressing Linux... done, booting the kernel.
Linux version 3.0.3 (buildslave@dd.das-iro.de) (gcc version 4.5.4 20110808 (prer
elease) (Linaro GCC 4.5-2011.08) ) #1 Tue Oct 18 13:50:31 CEST 2011
CPU: Feroceon [41069260] revision 0 (ARMv5TEJ), cr=a0053177
CPU: VIVT data cache, VIVT instruction cache
Machine: Netgear WNR854T
Clearing invalid memory bank 0KB@0xffffffff
Clearing invalid memory bank 0KB@0xffffffff
Clearing invalid memory bank 0KB@0xffffffff
Ignoring unrecognised tag 0x00000000
Ignoring unrecognised tag 0x00000000
Ignoring unrecognised tag 0x00000000
Ignoring tag cmdline (using the default kernel command line)
Memory policy: ECC disabled, Data cache writeback
Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 8128
Kernel command line: root=/dev/mtdblock1 rootfstype=squashfs,jffs2 noinitrd cons
ole=ttyS0,115200
PID hash table entries: 128 (order: -3, 512 bytes)
Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
Memory: 32MB = 32MB total
Memory: 29812k/29812k available, 2956k reserved, 0K highmem
Virtual kernel memory layout:
    vector  : 0xffff0000 - 0xffff1000   (   4 kB)
    fixmap  : 0xfff00000 - 0xfffe0000   ( 896 kB)
    DMA     : 0xffc00000 - 0xffe00000   (   2 MB)
    vmalloc : 0xc2800000 - 0xfd800000   ( 944 MB)
    lowmem  : 0xc0000000 - 0xc2000000   (  32 MB)
    modules : 0xbf000000 - 0xc0000000   (  16 MB)
      .init : 0xc0008000 - 0xc0024000   ( 112 kB)
      .text : 0xc0024000 - 0xc0271000   (2356 kB)
      .data : 0xc0272000 - 0xc0286480   (  82 kB)
       .bss : 0xc02864a4 - 0xc0292c64   (  50 kB)
NR_IRQS:64
sched_clock: 32 bits at 166MHz, resolution 5ns, wraps every 25769ms
Calibrating delay loop... 331.77 BogoMIPS (lpj=1658880)
pid_max: default: 32768 minimum: 301
Mount-cache hash table entries: 512
CPU: Testing write buffer coherency: ok
NET: Registered protocol family 16
Orion ID: MV88F5181-Rev-B1. TCLK=166666667.
MPP setup: unknown orion5x variant (dev 0x5181 rev 0x3)
Applying Orion-1/Orion-NAS PCIe config read transaction workaround
PCI: bus0: Fast back to back transfers disabled
PCI: bus1: Fast back to back transfers enabled
pci 0000:01:07.0: BAR 0: assigned [mem 0xe8000000-0xe800ffff]
pci 0000:01:07.0: BAR 0: set to [mem 0xe8000000-0xe800ffff] (PCI address [0xe800
0000-0xe800ffff])
pci 0000:01:07.0: BAR 1: assigned [mem 0xe8010000-0xe801ffff]
pci 0000:01:07.0: BAR 1: set to [mem 0xe8010000-0xe801ffff] (PCI address [0xe801
0000-0xe801ffff])
bio: create slab &lt;bio-0&gt; at 0
Switching to clocksource orion_clocksource
NET: Registered protocol family 2
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 1024 (order: 1, 8192 bytes)
TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
TCP: Hash tables configured (established 1024 bind 1024)
TCP reno registered
UDP hash table entries: 256 (order: 0, 4096 bytes)
UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
NET: Registered protocol family 1
squashfs: version 4.0 (2009/01/31) Phillip Lougher
JFFS2 version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006
 Red Hat, Inc.
msgmni has been set to 58
io scheduler noop registered
io scheduler deadline registered (default)
Serial: 8250/16550 driver, 2 ports, IRQ sharing disabled
serial8250.0: ttyS0 at MMIO 0xf1012000 (irq = 3) is a 16550A
console [ttyS0] enabled
physmap platform flash device: 00800000 at f4000000
physmap-flash.0: Found 1 x16 devices at 0x0 in 16-bit bank. Manufacturer ID 0x00
0089 Chip ID 0x000017
Intel/Sharp Extended Query Table at 0x0031
Intel/Sharp Extended Query Table at 0x0031
Using buffer write method
cfi_cmdset_0001: Erase suspend on write enabled
Using physmap partition information
Creating 4 MTD partitions on &quot;physmap-flash.0&quot;:
0x000000000000-0x000000100000 : &quot;kernel&quot;
0x000000100000-0x000000760000 : &quot;rootfs&quot;
mtd: partition &quot;rootfs&quot; set to be root filesystem
mtd: partition &quot;rootfs_data&quot; created automatically, ofs=260000, len=500000
0x000000260000-0x000000760000 : &quot;rootfs_data&quot;
0x000000760000-0x0000007a0000 : &quot;uboot&quot;
0x000000000000-0x000000760000 : &quot;image&quot;
mv643xx_eth: MV-643xx 10/100/1000 ethernet driver version 1.4
mv643xx_eth smi: probed
mv643xx_eth_port mv643xx_eth_port.0: eth0: port 0 with MAC address 00:00:00:00:5
1:81
i2c /dev entries driver
TCP westwood registered
NET: Registered protocol family 17
Bridge firewalling registered
Distributed Switch Architecture driver version 0.1
eth0[0]: detected a Marvell 88E6131 switch
dsa slave smi: probed
802.1Q VLAN Support v1.8
drivers/rtc/hctosys.c: unable to open rtc device (rtc0)
VFS: Mounted root (squashfs filesystem) readonly on device 31:1.
Freeing init memory: 112K
- preinit -
Press the [f] key and hit [enter] to enter failsafe mode
- regular preinit -
JFFS2 notice: (1304) jffs2_build_xattr_subsystem: complete building xattr subsys
tem, 1 of xdatum (1 unchecked, 0 orphan) and 3 of xref (0 dead, 2 orphan) found.
switching to jffs2
- init -

Please press Enter to activate this console. mv643xx_eth_port mv643xx_eth_port.0
: eth0: link up, 1000 Mb/s, full duplex, flow control disabled
device lan3 entered promiscuous mode
device eth0 entered promiscuous mode
device lan4 entered promiscuous mode
device lan1 entered promiscuous mode
device lan2 entered promiscuous mode
Compat-wireless backport release: compat-wireless-2011-09-28-6-g8163a60
Backport based on wireless-testing.git master-2011-10-05
cfg80211: Calling CRDA to update world regulatory domain
cfg80211: World regulatory domain updated:
cfg80211:     (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp)
cfg80211:     (2402000 KHz - 2472000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (2457000 KHz - 2482000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (2474000 KHz - 2494000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (5170000 KHz - 5250000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
cfg80211:     (5735000 KHz - 5835000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
PPP generic driver version 2.4.2
ip_tables: (C) 2000-2006 Netfilter Core Team
NET: Registered protocol family 24
nf_conntrack version 0.5.0 (467 buckets, 1868 max)
xt_time: kernel timezone is -0000</code></pre></div><p>Change platform.sh:<br /></p><div class="quotebox"><blockquote><p>grep 8519 /lib/upgrade/platform.sh<br />&nbsp; &nbsp; &nbsp; &nbsp; [ &quot;${magic}&quot; != &#039;8519&#039; ] &amp;&amp; {<br /><strong>sed -i -e &#039;/8519/ s/\(\[.*\)8519\(.*\){/\12705\2\18519\2{/&#039; /lib/upgrade/platform.sh</strong><br />grep 8519 /lib/upgrade/platform.sh<br />&nbsp; &nbsp; &nbsp; &nbsp; [ &quot;${magic}&quot; != &#039;2705&#039; ] &amp;&amp; [ &quot;${magic}&quot; != &#039;8519&#039; ] &amp;&amp; {</p></blockquote></div><p>Flash openwrt-wnr854t-squashfs.release+ipv6-luci.padded.img from luci:<br /></p><div class="codebox"><pre><code>lan3: link down
br-lan: port 1(lan3) entering forwarding state
Restarting system.

         __  __                      _ _
        |  \/  | __ _ _ ____   _____| | |
        | |\/| |/ _` | &#039;__\ \ / / _ \ | |
        | |  | | (_| | |   \ V /  __/ | |
        |_|  |_|\__,_|_|    \_/ \___|_|_|
 _   _     ____              _
| | | |   | __ )  ___   ___ | |_
| | | |___|  _ \ / _ \ / _ \| __|
| |_| |___| |_) | (_) | (_) | |_
 \___/    |____/ \___/ \___/ \__|  ** LOADER **
 ** MARVELL BOARD: RD-88F5181L-VOIP-GE LE GE RT v1.05

U-Boot 1.1.1 (Apr 18 2007 - 16:05:00) Marvell version: 1.7.3

DRAM CS[0] base 0x00000000   size  32MB
DRAM Total size  32MB
[8192kB@ff800000] Flash:  8 MB
Addresses 20M - 0M are saved for the U-Boot usage.
Mem malloc Initialization (20M - 16M): Done
*** Warning - bad CRC, using default environment


Soc: 88F5181 B1
CPU: ARM926 (Rev 0) running @ 500Mhz
SysClock = 166Mhz , TClock = 166Mhz


USB 0: host mode
PCI 0: PCI Express Root Complex Interface
PCI 1: Conventional PCI, speed = 33000000
Net:   egiga0 [PRIME]
Hit any key to stop autoboot:  0
### JFFS2 loading &#039;uImage&#039; to 0x400000
Scanning JFFS2 FS: .  Unknown node type: 2006 len 2268 offset 0x3bf724        -
Unknown node type: 2006 len 1432 offset 0x3dfa68
Unknown node type: 2006 len 1140 offset 0x3ffb8c                              \
Unknown node type: 2006 len 1104 offset 0x41fbb0
Unknown node type: 2006 len 1212 offset 0x43fb44                              |
Unknown node type: 2006 len 2600 offset 0x45f5d8                              .
 Unknown node type: 2006 len 10616 offset 0x47d688                            /
Unknown node type: 2006 len 8628 offset 0x49de4c
Unknown node type: 2006 len 2332 offset 0x4bf6e4                              -
Unknown node type: 2006 len 3536 offset 0x4df230                              .
 Unknown node type: 2006 len 12120 offset 0x4fd0a8                            .
 Unknown node type: 2006 len 8144 offset 0x51e030
Unknown node type: 2006 len 4336 offset 0x53ef10                              .
 Unknown node type: 2006 len 12708 offset 0x57ce5c                            .
 Unknown node type: 2006 len 14424 offset 0x59c7a8
Unknown node type: 2006 len 5108 offset 0x5bec0c                              .
 Unknown node type: 2006 len 9188 offset 0x5ddc1c
Unknown node type: 2006 len 13044 offset 0x5fcd0c                             .
 Unknown node type: e008 len 52 offset 0x7217d4
Unknown node type: e009 len 28 offset 0x721808
Unknown node type: e009 len 28 offset 0x7219fc
Unknown node type: e009 len 28 offset 0x721e50
Unknown node type: 2006 len 11912 offset 0x73d178                              d
one.
find_inode failed for name=uImage
load: Failed to find inode
### JFFS2 LOAD ERROR&lt;0&gt; for uImage!
## Booting image at 00400000 ...
   Image Name:   Linux-3.0.3
   Created:      2011-10-18  11:50:35 UTC
   Image Type:   ARM Linux Kernel Image (uncompressed)
   Data Size:    934956 Bytes = 913 kB
   Load Address: 00008000
   Entry Point:  00008000
   Verifying Checksum ... OK
OK

Starting kernel ...

Uncompressing Linux... done, booting the kernel.
Linux version 3.0.3 (buildslave@dd.das-iro.de) (gcc version 4.5.4 20110808 (prer
elease) (Linaro GCC 4.5-2011.08) ) #1 Tue Oct 18 13:50:31 CEST 2011
CPU: Feroceon [41069260] revision 0 (ARMv5TEJ), cr=a0053177
CPU: VIVT data cache, VIVT instruction cache
Machine: Netgear WNR854T
Clearing invalid memory bank 0KB@0xffffffff
Clearing invalid memory bank 0KB@0xffffffff
Clearing invalid memory bank 0KB@0xffffffff
Ignoring unrecognised tag 0x00000000
Ignoring unrecognised tag 0x00000000
Ignoring unrecognised tag 0x00000000
Ignoring tag cmdline (using the default kernel command line)
Memory policy: ECC disabled, Data cache writeback
Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 8128
Kernel command line: root=/dev/mtdblock1 rootfstype=squashfs,jffs2 noinitrd cons
ole=ttyS0,115200
PID hash table entries: 128 (order: -3, 512 bytes)
Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
Memory: 32MB = 32MB total
Memory: 29812k/29812k available, 2956k reserved, 0K highmem
Virtual kernel memory layout:
    vector  : 0xffff0000 - 0xffff1000   (   4 kB)
    fixmap  : 0xfff00000 - 0xfffe0000   ( 896 kB)
    DMA     : 0xffc00000 - 0xffe00000   (   2 MB)
    vmalloc : 0xc2800000 - 0xfd800000   ( 944 MB)
    lowmem  : 0xc0000000 - 0xc2000000   (  32 MB)
    modules : 0xbf000000 - 0xc0000000   (  16 MB)
      .init : 0xc0008000 - 0xc0024000   ( 112 kB)
      .text : 0xc0024000 - 0xc0271000   (2356 kB)
      .data : 0xc0272000 - 0xc0286480   (  82 kB)
       .bss : 0xc02864a4 - 0xc0292c64   (  50 kB)
NR_IRQS:64
sched_clock: 32 bits at 166MHz, resolution 5ns, wraps every 25769ms
Calibrating delay loop... 331.77 BogoMIPS (lpj=1658880)
pid_max: default: 32768 minimum: 301
Mount-cache hash table entries: 512
CPU: Testing write buffer coherency: ok
NET: Registered protocol family 16
Orion ID: MV88F5181-Rev-B1. TCLK=166666667.
MPP setup: unknown orion5x variant (dev 0x5181 rev 0x3)
Applying Orion-1/Orion-NAS PCIe config read transaction workaround
PCI: bus0: Fast back to back transfers disabled
PCI: bus1: Fast back to back transfers enabled
pci 0000:01:07.0: BAR 0: assigned [mem 0xe8000000-0xe800ffff]
pci 0000:01:07.0: BAR 0: set to [mem 0xe8000000-0xe800ffff] (PCI address [0xe800
0000-0xe800ffff])
pci 0000:01:07.0: BAR 1: assigned [mem 0xe8010000-0xe801ffff]
pci 0000:01:07.0: BAR 1: set to [mem 0xe8010000-0xe801ffff] (PCI address [0xe801
0000-0xe801ffff])
bio: create slab &lt;bio-0&gt; at 0
Switching to clocksource orion_clocksource
NET: Registered protocol family 2
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 1024 (order: 1, 8192 bytes)
TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
TCP: Hash tables configured (established 1024 bind 1024)
TCP reno registered
UDP hash table entries: 256 (order: 0, 4096 bytes)
UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
NET: Registered protocol family 1
squashfs: version 4.0 (2009/01/31) Phillip Lougher
JFFS2 version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006
 Red Hat, Inc.
msgmni has been set to 58
io scheduler noop registered
io scheduler deadline registered (default)
Serial: 8250/16550 driver, 2 ports, IRQ sharing disabled
serial8250.0: ttyS0 at MMIO 0xf1012000 (irq = 3) is a 16550A
console [ttyS0] enabled
physmap platform flash device: 00800000 at f4000000
physmap-flash.0: Found 1 x16 devices at 0x0 in 16-bit bank. Manufacturer ID 0x00
0089 Chip ID 0x000017
Intel/Sharp Extended Query Table at 0x0031
Intel/Sharp Extended Query Table at 0x0031
Using buffer write method
cfi_cmdset_0001: Erase suspend on write enabled
Using physmap partition information
Creating 4 MTD partitions on &quot;physmap-flash.0&quot;:
0x000000000000-0x000000100000 : &quot;kernel&quot;
0x000000100000-0x000000760000 : &quot;rootfs&quot;
mtd: partition &quot;rootfs&quot; set to be root filesystem
split_squashfs: no squashfs found in &quot;physmap-flash.0&quot;
0x000000760000-0x0000007a0000 : &quot;uboot&quot;
0x000000000000-0x000000760000 : &quot;image&quot;
mv643xx_eth: MV-643xx 10/100/1000 ethernet driver version 1.4
mv643xx_eth smi: probed
mv643xx_eth_port mv643xx_eth_port.0: eth0: port 0 with MAC address 00:00:00:00:5
1:81
i2c /dev entries driver
TCP westwood registered
NET: Registered protocol family 17
Bridge firewalling registered
Distributed Switch Architecture driver version 0.1
eth0[0]: detected a Marvell 88E6131 switch
dsa slave smi: probed
802.1Q VLAN Support v1.8
drivers/rtc/hctosys.c: unable to open rtc device (rtc0)
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00000000: 0xf2e5 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00000004: 0x977e in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00000008: 0x75ce in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0000000c: 0x38fb in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00000010: 0xfd0f in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00000014: 0x68a2 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00000018: 0x9556 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0000001c: 0x3484 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00000020: 0xabab in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00000024: 0x97cc in
stead
Further such events for this erase block will not be printed
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00020000: 0x7368 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00020004: 0x022b in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00020008: 0x1250 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00020010: 0x000c in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00020014: 0x0004 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00020018: 0x06c0 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0002001c: 0x0004 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00020020: 0x0930 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00020028: 0x5542 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00020030: 0x553a in
stead
Further such events for this erase block will not be printed
Empty flash at 0x00020038 ends at 0x00020040
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00040000: 0x9b26 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00040004: 0x0513 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00040008: 0x9cf4 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0004000c: 0xa578 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00040010: 0x5f3c in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00040014: 0xea20 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00040018: 0x8743 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0004001c: 0x63e9 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00040020: 0xb6d6 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00040024: 0x7649 in
stead
Further such events for this erase block will not be printed
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00060000: 0x5012 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00060004: 0x0265 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00060008: 0x6ca3 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0006000c: 0xd979 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00060010: 0x5ad6 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00060014: 0xfc11 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00060018: 0xee1b in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0006001c: 0x8bcc in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00060020: 0x4d24 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00060024: 0xbb84 in
stead
Further such events for this erase block will not be printed
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00080000: 0x22d6 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00080004: 0x6584 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00080008: 0x5b73 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0008000c: 0x8fff in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00080010: 0x4214 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00080014: 0x29c7 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00080018: 0xd101 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0008001c: 0xcc67 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00080020: 0x95dc in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00080024: 0x0f38 in
stead
Further such events for this erase block will not be printed
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000a0000: 0x736f in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000a0004: 0xc6d9 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000a0008: 0x6adf in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000a000c: 0x4715 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000a0010: 0x859b in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000a0014: 0xb967 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000a0018: 0x5bc2 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000a001c: 0x268c in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000a0020: 0x3547 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000a0024: 0xb572 in
stead
Further such events for this erase block will not be printed
Old JFFS2 bitmask found at 0x000ba5d4
You cannot use older JFFS2 filesystems with newer kernels
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000c0000: 0xa39d in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000c0004: 0x8863 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000c0008: 0x00f0 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000c000c: 0xf9c1 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000c0010: 0x315a in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000c0014: 0xc578 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000c0018: 0xfdfa in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000c001c: 0x16e9 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000c0020: 0x9b2c in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000c0024: 0x6ae7 in
stead
Further such events for this erase block will not be printed
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000e0000: 0x2272 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000e0004: 0xe5f4 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000e0008: 0x19c1 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000e000c: 0x0cbb in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000e0010: 0xa9bf in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000e0014: 0x4853 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000e0018: 0x8263 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000e001c: 0xebcc in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000e0020: 0x3213 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x000e0024: 0x5e58 in
stead
Further such events for this erase block will not be printed
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00100000: 0x5a97 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00100004: 0x1df4 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00100008: 0x28b3 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0010000c: 0x1602 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00100010: 0xedc8 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00100014: 0xa7b2 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00100018: 0xd42f in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0010001c: 0x77f9 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00100020: 0x8bba in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00100024: 0x2769 in
stead
Further such events for this erase block will not be printed
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00120000: 0xf826 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00120004: 0x17e6 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00120008: 0xba40 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0012000c: 0x54fd in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00120010: 0x83ec in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00120014: 0x3ba4 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00120018: 0x9f15 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0012001c: 0x56ba in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00120020: 0xcb4c in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00120024: 0x814c in
stead
Further such events for this erase block will not be printed
Old JFFS2 bitmask found at 0x0012c89c
You cannot use older JFFS2 filesystems with newer kernels
Old JFFS2 bitmask found at 0x0013a774
You cannot use older JFFS2 filesystems with newer kernels
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00140000: 0xfbd4 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00140004: 0x1334 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00140008: 0x0139 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0014000c: 0x9cc1 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00140010: 0x3d1c in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00140014: 0xf173 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00140018: 0x9a2a in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0014001c: 0x866f in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00140020: 0x2c81 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00140024: 0x6c6e in
stead
Further such events for this erase block will not be printed
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00160000: 0x782f in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00160004: 0xfb21 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00160008: 0xe9e5 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0016000c: 0xb0b8 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00160010: 0x9466 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00160014: 0x4559 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00160018: 0xffd3 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0016001c: 0xf9e7 in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00160020: 0x665e in
stead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00160024: 0xbf6c in
stead
Further such events for this erase block will not be printed
Empty flash at 0x00165544 ends at 0x00166000
Empty flash at 0x00166004 ends at 0x00170000
jffs2_scan_eraseblock(): End of filesystem marker found at 0x180000
Cowardly refusing to erase blocks on filesystem with no valid JFFS2 nodes
empty_blocks 39, bad_blocks 0, c-&gt;nr_blocks 51
VFS: Cannot open root device &quot;mtdblock1&quot; or unknown-block(31,1)
Please append a correct &quot;root=&quot; boot option; here are the available partitions:
1f00            1024 mtdblock0  (driver?)
1f01            6528 mtdblock1  (driver?)
1f02             256 mtdblock2  (driver?)
1f03            7552 mtdblock3  (driver?)
Kernel panic - not syncing: VFS: Unable to mount root fs on unknown-block(31,1)
Backtrace:
Function entered at [&lt;c0027b74&gt;] from [&lt;c022445c&gt;]
 r6:c18a2000 r5:c00210ec r4:c0286c20 r3:60000013
Function entered at [&lt;c0224444&gt;] from [&lt;c02244c0&gt;]
Function entered at [&lt;c0224460&gt;] from [&lt;c0008da4&gt;]
 r3:60000013 r2:00000000 r1:c1817f60 r0:c0239b30
 r7:00008000
Function entered at [&lt;c0008bd0&gt;] from [&lt;c0008eb8&gt;]
Function entered at [&lt;c0008e64&gt;] from [&lt;c0009004&gt;]
 r5:c00210ec r4:c0286524
Function entered at [&lt;c0008ed0&gt;] from [&lt;c0008a40&gt;]
 r5:c00206c8 r4:c00206c8
Function entered at [&lt;c0008954&gt;] from [&lt;c0036828&gt;]
 r5:c0008954 r4:00000000</code></pre></div><p>Anyway, here comes the power cycle:<br /></p><div class="codebox"><pre><code>         __  __                      _ _
        |  \/  | __ _ _ ____   _____| | |
        | |\/| |/ _` | &#039;__\ \ / / _ \ | |
        | |  | | (_| | |   \ V /  __/ | |
        |_|  |_|\__,_|_|    \_/ \___|_|_|
 _   _     ____              _
| | | |   | __ )  ___   ___ | |_
| | | |___|  _ \ / _ \ / _ \| __|
| |_| |___| |_) | (_) | (_) | |_
 \___/    |____/ \___/ \___/ \__|  ** LOADER **
 ** MARVELL BOARD: RD-88F5181L-VOIP-GE LE GE RT v1.05

U-Boot 1.1.1 (Apr 18 2007 - 16:05:00) Marvell version: 1.7.3

DRAM CS[0] base 0x00000000   size  32MB
DRAM Total size  32MB
[8192kB@ff800000] Flash:  8 MB
Addresses 20M - 0M are saved for the U-Boot usage.
Mem malloc Initialization (20M - 16M): Done
*** Warning - bad CRC, using default environment


Soc: 88F5181 B1
CPU: ARM926 (Rev 0) running @ 500Mhz
SysClock = 166Mhz , TClock = 166Mhz


USB 0: host mode
PCI 0: PCI Express Root Complex Interface
PCI 1: Conventional PCI, speed = 33000000
Net:   egiga0 [PRIME]
Hit any key to stop autoboot:  0
### JFFS2 loading &#039;uImage&#039; to 0x400000
Scanning JFFS2 FS: .  Unknown node type: 2006 len 2268 offset 0x3bf724        -
Unknown node type: 2006 len 1432 offset 0x3dfa68
Unknown node type: 2006 len 1140 offset 0x3ffb8c                              \
Unknown node type: 2006 len 1104 offset 0x41fbb0
Unknown node type: 2006 len 1212 offset 0x43fb44                              |
Unknown node type: 2006 len 2600 offset 0x45f5d8                              .
 Unknown node type: 2006 len 10616 offset 0x47d688                            /
Unknown node type: 2006 len 8628 offset 0x49de4c
Unknown node type: 2006 len 2332 offset 0x4bf6e4                              -
Unknown node type: 2006 len 3536 offset 0x4df230                              .
 Unknown node type: 2006 len 12120 offset 0x4fd0a8                            .
 Unknown node type: 2006 len 8144 offset 0x51e030
Unknown node type: 2006 len 4336 offset 0x53ef10                              .
 Unknown node type: 2006 len 12708 offset 0x57ce5c                            .
 Unknown node type: 2006 len 14424 offset 0x59c7a8
Unknown node type: 2006 len 5108 offset 0x5bec0c                              .
 Unknown node type: 2006 len 9188 offset 0x5ddc1c
Unknown node type: 2006 len 13044 offset 0x5fcd0c                             .
 Unknown node type: e008 len 52 offset 0x7217d4
Unknown node type: e009 len 28 offset 0x721808
Unknown node type: e009 len 28 offset 0x7219fc
Unknown node type: e009 len 28 offset 0x721e50
Unknown node type: 2006 len 11912 offset 0x73d178                              d
one.
find_inode failed for name=uImage
load: Failed to find inode
### JFFS2 LOAD ERROR&lt;0&gt; for uImage!
## Booting image at 00400000 ...
Bad Header Checksum...do_bootm
Start Gemtek tftpd for Netgear GE RT!
TFTP Server IP is : 192.168.1.1
Load address: 0x400000</code></pre></div><p>All done!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p149020">
				<div class="post-metadata">
					<div class="post-num">Post #1047</div>
					<div class="post-author">mrk</div>
					<div class="post-datetime">
						19 Nov 2011, 18:38					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>StrikerNL wrote:</cite><blockquote><p>Me and DirkNL have been messing around trying to get the keys (reset/WPS) to work, we followed most of the instructions in <a href="https://forum.openwrt.org/viewtopic.php?pid=120958#p120958">this post</a><br />.......</p><p>Does anyone have any idea where we might be going wrong?</p></blockquote></div><p>Hello StrickerNL,<br />after I&#039;ve read Your post, I reanimated my wrt350nv2 (which became rather dusty) and tried to solve Your issue with the latest trunk.</p><p>It is still working with kernel 3.0.3 and trunk 29255!<br />In my config, I have the failsafe-patch according to <a href="https://forum.openwrt.org/viewtopic.php?pid=122554#p122554">this post</a>.</p><p>When You peek into the files of the patch, You will find <em>03_reset_button_orion</em>, which activates the kernel-modules <em>gpio-keys</em> and <em>button-hotplug</em> while preinit-phase. I don&#039;t know, if button-hotplug will be started later as well, but when You include failsafe, it should work.</p><p>Good luck!</p>											<p class="post-edited">(Last edited by <strong>mrk</strong> on 19 Nov 2011, 18:40)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p149032">
				<div class="post-metadata">
					<div class="post-num">Post #1048</div>
					<div class="post-author">StrikerNL</div>
					<div class="post-datetime">
						19 Nov 2011, 21:01					</div>
				</div>
				<div class="post-content content">
					<p>@mrk thanks, we will take a look soon. Should work in Backfire 10.03.1 RC5 or RC6 then? Or just trunk?</p><p>[s]@everyone else, I&#039;m experiencing TERRIBLE wifi stability (as in, will work for 5 to 15 minutes, then /sbin/wifi is needed to get clients to connect again) with my WRT350N v2 on RC6. I did build my own firmware, enabling channels 12 &amp; 13 (force ath9k to honor user channel setting or something in menuconfig). RC5 was mostly fine though, with the same patch applied. Anyone?[/s] <strong>Never mind, I seem to be having some kind of other problem (with RC6), probably not WiFi related. Will be looking into it soon. My network/wifi is currently practically unusable :S</strong></p>											<p class="post-edited">(Last edited by <strong>StrikerNL</strong> on 21 Nov 2011, 10:49)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p149365">
				<div class="post-metadata">
					<div class="post-num">Post #1049</div>
					<div class="post-author">cmoegele</div>
					<div class="post-datetime">
						23 Nov 2011, 13:37					</div>
				</div>
				<div class="post-content content">
					<p>I read the latest posts too late, ( today) after discovering WIFI problems with latest trunk from yesterday.<br />Evrything seems to look fine but I´m not able to connect any WLan-devices to the router,... <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /><br />Is it a problem of the ath9k, should I give the ath5k a try or is this useless ?</p><p>So you think solution is go back to RC5? I´m not the Subversion Pro ,... is this possibly to teh actual trunk, or do I have to <br />checkout a new one ?</p><p>Best regards</p><p>cmoegele</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p153181">
				<div class="post-metadata">
					<div class="post-num">Post #1050</div>
					<div class="post-author">veger</div>
					<div class="post-datetime">
						5 Jan 2012, 12:47					</div>
				</div>
				<div class="post-content content">
					<p>I have the same problem. I cannot get the WiFi working.<br />After a fresh install, it shows two radios, both seems to respond to eachother: if I start one, both have their their status updated.<br />Some of my wireless capable devices see the network, others don&#039;t. But non of them are able to connect to it (I tried all encryption methods available)</p><p>It seems that it is a bug in OpenWRT? Should I create a new ticket for this?</p>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 42 of 46</div><nav><ul><li><a href="viewtopic.php%3Fid=12358&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=12358&amp;p=40.html">40</a></li><li><a href="viewtopic.php%3Fid=12358&amp;p=41.html">41</a></li><li class="pagination-current"><span>42</span></li><li><a href="viewtopic.php%3Fid=12358&amp;p=43.html">43</a></li><li><a href="viewtopic.php%3Fid=12358&amp;p=44.html">44</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=12358&amp;p=46.html">46</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0.001 -->

</body>
</html>