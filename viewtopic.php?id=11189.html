<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Writing to usb harddrive freezes Asus wl-500gP</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 10 Feb 2018 and 27 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=11189&amp;p=2.html">2</a></li></ul></nav></div>
			
		
		
			<article class="post" id="p50533">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">nesse</div>
					<div class="post-datetime">
						15 Jun 2007, 08:02					</div>
				</div>
				<div class="post-content content">
					<p>My Asus wl-500 gP runs flawlessly, except when I write/read to the the external usb harddisk it sometimes freezes. It does that under the following conditions:</p><p>1. When copying a large file (500mb or larger) to it.<br />2. Many smaller files (5-10mb) in a row under an extended period of time.<br />3. When reading from it under a longer period of time, like when watching a move.</p><p>The only way to unfreeze it is to remove the power cable and put it back in. <br />The harddrive needs to be restarted too. The led indicating write/read from the usb disk sometimes gets stuck lighted up when this happens. Once restarted everything is back to normal. </p><p>It happens at least 70% of the time I try to copy a large file/many smaller to it and more seldom when reading from it. Usually it freezes when I&#039;ve been writing to it for 10 or more minutes, sometimes all goes well for half an hour (which is what puzzles me the most).</p><p>The disk is 500gb, less than a month old and running ext3. The same problem occurs both when writing files via vsftpd and reading/writing via samba. There is plenty of ram available.</p><p>I am using Kamikaze 7.06 (broadcom2.4), but I&#039;ve had the same problems with whiterussian and previous kamikaze builds as well. The usb drivers and disk are configured as per the wiki.</p><p>Any help/ideas would be greatly appreciated, I use this disk for all my storage so you can imagine how annoying it gets! Let me know if you need additional info.</p><p>Thanks,<br />nesse</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p50655">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">nesse</div>
					<div class="post-datetime">
						17 Jun 2007, 05:39					</div>
				</div>
				<div class="post-content content">
					<p>UPDATE:</p><p>I connected the disk to my computer running windows xp via ext2fsd and got a &quot;disk full&quot; error after a couple of minutes when copying a large file to it. So I reckon it&#039;s probably a filesystem error(?). Did an e2fsck, but still received the same error afterwards.</p><p>Any ideas guys?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p50719">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">dries</div>
					<div class="post-datetime">
						18 Jun 2007, 11:25					</div>
				</div>
				<div class="post-content content">
					<p>I have exactly the same problem; <br />However, I do not think it is related to the disk being full. </p><p>I&#039;ve had this problem a number of times, even if the disk isn&#039;t even near to being full.</p><p>It only happens when the disk is under heavy load; (copying large file or multiple small files).</p><p>And, the router itself doesn&#039;t crash/hang; Only accessing the disk blocks. In my case, I cannot login any longer, but <br />everything else still works (dns, nat, ...)</p><p>I&#039;ve tried attaching the disk directly or through an USB-1 hub; Made no difference.</p><p>I&#039;m hoping that kernel 2.6 will fix this issue...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p50722">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">nesse</div>
					<div class="post-datetime">
						18 Jun 2007, 12:17					</div>
				</div>
				<div class="post-content content">
					<p>Problem solved!</p><p>I don&#039;t understand how, but it turns out the partition table had gotten screwed up. Partition table doctor (windows) found the errors automatically and corrected them, I then reconnected it to the router and did a e2fsck, after that all has been fine!</p><p>Hope this helps you dries!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p50962">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">nesse</div>
					<div class="post-datetime">
						21 Jun 2007, 11:53					</div>
				</div>
				<div class="post-content content">
					<p>Doh, turns out it was a false alarm. Was working nicely for a couple of days, now its back to its regular crashing self..</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p51346">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">bluerussian</div>
					<div class="post-datetime">
						27 Jun 2007, 06:05					</div>
				</div>
				<div class="post-content content">
					<p>I am also experiencing similar things, though probably closer to netddos&#039; problem from March 2006: <a href="http://forum.openwrt.org/viewtopic.php?pid=22160#p22160">http://forum.openwrt.org/viewtopic.php?pid=22160#p22160</a>.</p><p>I have the WL-500GP, an external USB 2.0 hdd enclosure (with a SATA-II drive inside). The filesystem is xfs, and is accessible to my WinXP via samba. When I run azureus, the file gets downloaded directly to the router&#039;s external hdd. Like netddos, after awhile, the transfer stops and I get write errors and WinXP can no longer access the drive.</p><p>However, I can *still* login to the router, umount the drive, and when I remount it, everything works again. I can drag-and-drop 2 GB files directly to the drive in WinXP. I can stream large videos off of it with no dropped frames or errors. No problems.</p><p>But the errors come back as soon as I do bittorrent/azureus.</p><br /><br /><p>UPDATE: Actually, the more I experiment with controlling various factors in attempting to consistently reproduce the errors, the more I&#039;m beginning to suspect that my problem, at least, has to do with the speed to which data is being written to the disk (which may have to do with load/stress also, as dries intimated).</p><p>If my torrents are downloaded at about 100 KB/s (that&#039;s kiloBYTES) or less (and uploading at 32KB/s), there are NO problems. If the total download speed is 300 KB/s or more, I get the write errors and &quot;freeze&quot; that the OP (nesse) describes.</p><p>It doesn&#039;t make sense as my network is 100 Mb/s (that&#039;s megaBITS) and USB 2.0 is theoretically 480 Mb/s. Even assuming less-than-theoretical, I&#039;m nowhere near these numbers. But I can pretty consistently reproduce this now.</p><p>I don&#039;t think it&#039;s bittorrent-specific like I originally thought. I think it just boils down to the write speed. It&#039;s just that bittorrent allows me to control that variable (d/l speed) in order to more clearly bring the problem into focus.</p><p>But no, I have not yet found the &quot;optimal&quot; speed at which I can d/l without errors. I just know it&#039;s somewhere between 100 KB/s and 300 KB/s.</p>											<p class="post-edited">(Last edited by <strong>bluerussian</strong> on 27 Jun 2007, 07:24)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p51349">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">LaySoft</div>
					<div class="post-datetime">
						27 Jun 2007, 11:16					</div>
				</div>
				<div class="post-content content">
					<p>Hello!</p><p>I have ASUS wl-500gp with kamikaze too, and x-wrt webif. USB devices (pendrive and multi card reader) appears on webif status/usb menu, but can&#039;t mounted it. I found an error report:</p><p><a href="https://dev.openwrt.org/ticket/1819">https://dev.openwrt.org/ticket/1819</a></p><p>dmesg creates same error for me.</p><p>How do you install kmod-fs-vfat package, because it depends kmod-nls-base, which is not in brcm2.x packages? I tried to install with -nodeps option, and it&#039;s installed, but maybe this caused my problem?</p><p>Under white-russian everything works well.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p51541">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">mib</div>
					<div class="post-datetime">
						30 Jun 2007, 06:31					</div>
				</div>
				<div class="post-content content">
					<p>I have the exact same problem since WhiteRussian I dunno why no one is fixing it.</p><p>If you run - cat /etc/meminfo, you will find that the cache (inactive) takes about &gt; 10Mb and the router started chocked up and freeze... </p><p>I read from other thread that remounting the drive can solve the problem then obviously something is wrong at the USB or the disk driver module. May be you can try to run a cron to remount the drive regularly.</p><p>But some one in the DEV team has to look at the problem and fix this.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p51549">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">Kevin</div>
					<div class="post-datetime">
						30 Jun 2007, 08:52					</div>
				</div>
				<div class="post-content content">
					<p>has anyone with this problem checked dmesg for errors?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p51563">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">mib</div>
					<div class="post-datetime">
						30 Jun 2007, 16:44					</div>
				</div>
				<div class="post-content content">
					<p>The problem is that when the router got choked up you can&#039;t even telnet into it... the router will not respond at all not even ping<br />Is there anyway you can get the dmesg printed somehow?</p>											<p class="post-edited">(Last edited by <strong>mib</strong> on 30 Jun 2007, 16:45)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p51682">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">tuigje</div>
					<div class="post-datetime">
						2 Jul 2007, 21:51					</div>
				</div>
				<div class="post-content content">
					<p>I have an wl-500gp, with kamikaze, 2.4 kernel (svn version).<br />I&#039;m using the EHCI-usb drivers.</p><p>I also freezes, but only when i copy a lot of files over samba, or very<br />large ones (&gt;2GB).</p><p>copying via ncftp (running on kamikaze) is faster and is stable up to now.</p><p>I just assumed it was a bug in samba, but maybe i&#039;m wrong</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p51713">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">mib</div>
					<div class="post-datetime">
						3 Jul 2007, 10:41					</div>
				</div>
				<div class="post-content content">
					<p>tuigje, did you check your /proc/meminfo and see if there&#039;re large amount of Inactive Cache? or the free memory?</p><p>I think somehow when any programs access the drive via some way (probably thru driver API calls) will trigger the problem. I tried vsftp, samba, ctorrent... and found the problem was in common that when the disk access reaches certain level (certain written size or certain time of continous run), the cache for inactive connections pumps up and not going away... and then after a while the router got chocked and eventually completely stop. A hard-reset is needed.</p><p>That&#039;s why I think the issue is on the USB or the disk driver layer. Using EHCI driver may help... I&#039;ll give a try later.</p>											<p class="post-edited">(Last edited by <strong>mib</strong> on 3 Jul 2007, 11:29)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p54046">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">splendid</div>
					<div class="post-datetime">
						17 Aug 2007, 00:38					</div>
				</div>
				<div class="post-content content">
					<p>These seem like very similar problems that I&#039;m having with my WL-700ge. My router crashes on large file transfers or lots of small files. Can anybody confirm that they only have these problems when transferring files over a wireless connection?</p><p>EDIT: I have posted my problem here - <a href="http://forum.openwrt.org/viewtopic.php?id=12103">http://forum.openwrt.org/viewtopic.php?id=12103</a><br />and here - <a href="https://dev.openwrt.org/ticket/2221">https://dev.openwrt.org/ticket/2221</a></p>											<p class="post-edited">(Last edited by <strong>splendid</strong> on 17 Aug 2007, 00:39)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p54051">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">SyncRo</div>
					<div class="post-datetime">
						17 Aug 2007, 01:47					</div>
				</div>
				<div class="post-content content">
					<p>Maybe the same problem as here:<br /><a href="http://forum.openwrt.org/viewtopic.php?id=12124">http://forum.openwrt.org/viewtopic.php?id=12124</a></p><p>But I had posted dmesg line&nbsp; :-)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p54082">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">mib</div>
					<div class="post-datetime">
						17 Aug 2007, 13:45					</div>
				</div>
				<div class="post-content content">
					<p>The problem exists not only when wireless is used. I&#039;m using the ethernet port only but it has the same problem.<br />Did you check the meminfo and see if the Inactive Cache keep pumping up when you access your drive and eventually the router choked?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p54141">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">splendid</div>
					<div class="post-datetime">
						18 Aug 2007, 11:37					</div>
				</div>
				<div class="post-content content">
					<p>My /proc/meminfo seems to remain fairly stable. And I note from <a href="http://forum.openwrt.org/viewtopic.php?id=11317">http://forum.openwrt.org/viewtopic.php?id=11317</a> nesse seems to have fixed the problem with a new external USB drive. Doesn&#039;t seem like the problems are related.</p>											<p class="post-edited">(Last edited by <strong>splendid</strong> on 18 Aug 2007, 11:39)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p54152">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">obsy</div>
					<div class="post-datetime">
						18 Aug 2007, 17:13					</div>
				</div>
				<div class="post-content content">
					<p>Try remove kmod-usb2. Sometimes helps.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p56067">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">max2k5</div>
					<div class="post-datetime">
						20 Sep 2007, 13:36					</div>
				</div>
				<div class="post-content content">
					<p>Any solutions yet for this problem? <br />I also have it with Kamikaze 7.06, Asus WL500gP and a Samsung 500GB hd over usb...</p><br /><p>Best regards,<br />max</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p56236">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">mib</div>
					<div class="post-datetime">
						22 Sep 2007, 18:41					</div>
				</div>
				<div class="post-content content">
					<p>none so far.....</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p60211">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">memento</div>
					<div class="post-datetime">
						10 Dec 2007, 01:17					</div>
				</div>
				<div class="post-content content">
					<p>Is there any solution for this problem? or any workaround? i would like to use a 500gb hdd as the base of a ftp server but it freeze whenever i try to heavily read/write it.:/<br />I think it has nothing to do with the connection of network, i read somebody wrote that this is because of the wireless but it freeze with wired connection too....</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p60212">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">memento</div>
					<div class="post-datetime">
						10 Dec 2007, 01:31					</div>
				</div>
				<div class="post-content content">
					<p>i removed kmod-usb2, but now the tranfer speed continually jumping from 0 to 2.5mb/s(and the vsftpd&#039;s load is changing in the same rhythm from 1 to 75%) but the router doesn&#039;t freeze yet...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p60221">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">max2k5</div>
					<div class="post-datetime">
						10 Dec 2007, 09:11					</div>
				</div>
				<div class="post-content content">
					<p>Ya, I think now you are only using USB1.1, thus having less transfer speed = less cpu load = less chance to overload system/driver/whatever causes the problem = less crashes.<br />If usb2 is really the full reason, crashes should have vanished completely, if usb1.1 is only using less load, crashes are only less frequent. <br />Did you test that? How many dvd isos did you copy? <img src="https://forum.openwrt.org/img/smilies/tongue.png" width="15" height="15" alt="tongue" /><br />Would be interesting...</p><p>Cheers,<br />max</p><p>UPDATE: I just checked, also with removing kmod-usb2, and after that, my speed went down from ca. 2.6 to 0.7. <br />Also the crashes came only after 1.2 GB, instead of 600 MB earlier. <br />=&gt; still no solution for our problem! <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>[OpenWRT 7.09, Asus WL-500gP]</p>											<p class="post-edited">(Last edited by <strong>max2k5</strong> on 10 Dec 2007, 21:50)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p60240">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">memento</div>
					<div class="post-datetime">
						10 Dec 2007, 22:27					</div>
				</div>
				<div class="post-content content">
					<p>yeah, crash came after a few hour...:( i read about running debian in theese routers, after my exams i&#039;ll try it.. i hope there will be some workaround.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p60263">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">a.mOk</div>
					<div class="post-datetime">
						11 Dec 2007, 09:57					</div>
				</div>
				<div class="post-content content">
					<p>i have the problem,too. It dont&#039;works with samba, but it works fine with pure-ftpd</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p60264">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">max2k5</div>
					<div class="post-datetime">
						11 Dec 2007, 10:15					</div>
				</div>
				<div class="post-content content">
					<p>Is there a way to install a pure Debian/MIPS? I was also looking in that direction, and they always use the openwrt kernel to boot the system, and just use debian sysv, libs etc, but not debian kernel...</p><div class="quotebox"><cite>memento wrote:</cite><blockquote><p>yeah, crash came after a few hour...:( i read about running debian in theese routers, after my exams i&#039;ll try it.. i hope there will be some workaround.</p></blockquote></div>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=11189&amp;p=2.html">2</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>