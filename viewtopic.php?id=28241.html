<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> A war against ISP&#039;s monopoly aka WR1043ND+Vlan.</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 31 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p126098">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">azzkickr</div>
					<div class="post-datetime">
						21 Jan 2011, 09:05					</div>
				</div>
				<div class="post-content content">
					<p>Hello there,</p><p>For the last few weeks I&#039;ve been trying to solve a problem many people in Lithuania struggle with. Here&#039;s an introduction:</p><p>In Lithuania, where I am now, the national ISP gives fibre optic connections (100Mbps symmetric for 20€/month) and provides IPTV service over the fibre as well. Trouble is that they force users to use their own crappy equipment. The answer is always the same - users can not (or are not supposed to) use their own routers therefore, obviously, the provider will not help configuring one&#039;s router. They redirect us to another company that provides paid support, but on arrival they say they only deal with officially approved hardware. Enough to say that the hardware they provide has most of configuration options hidden/blocked and is targeted mainly to home users checking mail / downloading movies.</p><p>So as a matter of a fight against the monopoly I&#039;ve had this brilliant idea of getting a VLAN-capable router, installing DD-WRT or OpenWrt, making it all work and then posting it on Lithuanian forums so everyone can have it working for half the price operator charges and obviously with better quality, stability etc.</p><p>OK. so here&#039;s the situation:<br /><span class="postimg"><img src="http://2.bp.blogspot.com/_b9_Yw-OI7VE/S8Yg5yzqGkI/AAAAAAAABFA/brYCjjzgIyY/s400/teo2.png" alt="http://2.bp.blogspot.com/_b9_Yw-OI7VE/S8Yg5yzqGkI/AAAAAAAABFA/brYCjjzgIyY/s400/teo2.png" /></span><br /></p><div class="codebox"><pre><code>TEO - Lithuanian Telecom
Zebra - ISP, Division of TEO
MGMT - Management (I suppose)
GALA - IPTV service
IPTV STB - Set-Top Box (Sort of a decoder if you wish) plugged into an ordinary TV</code></pre></div><p>This tutorial written for DD-WRT<br /><a href="http://www.dd-wrt.com/wiki/index.php/Setting_up_IPTV_without_impact_to_LAN_and_Wireless_traffic">http://www.dd-wrt.com/wiki/index.php/Se … ss_traffic</a> is no longer helpful as the GUI have changed and there&#039;s no instruction on how to do it in terminal[/url] I didn&#039;t find anything similar for OpenWrt.</p><p>My goal is to:</p><p>1. Make the Set-Top box able to stream TV channels<br />2. Make it possible to watch TV also on computers (also via WiFi, if possible)<br />3. Maintain normal functionality for everything else</p><p>I&#039;ve found two sites with some information on the setup but firstly - they are in Lithuanian (which I don&#039;t speak) and secondly - none of them provides complete information. One is a complete guide on how to achieve it on Debian<br /><a href="http://www.atviras.lt/Straipsniai/GalaLinijosSrautoPanaudojimas">http://www.atviras.lt/Straipsniai/GalaL … naudojimas</a><br />I recommend using google chrome with autotranslate from Lithuanian to understand anything not being code;</p><p>The second is a blog with people trying to make it work with DD-WRT with some results:<br /><a href="http://shmandre.blogspot.com/2011/01/gala-tv-ir-zebra-internetas.html">http://shmandre.blogspot.com/2011/01/ga … netas.html</a><br />Getting PCs and TV to work with original Pirelli DRG125G router: <a href="http://shmandre.blogspot.com/2010/04/gala-tv-ir-zebra-internetas-per_14.html">http://shmandre.blogspot.com/2010/04/ga … er_14.html</a><br /><a href="http://shmandre.blogspot.com/2010/03/gala-tv-tinklas.html">http://shmandre.blogspot.com/2010/03/ga … nklas.html</a></p><p>What I&#039;m asking for is for you to tell me how to achieve it. </p><p>Anyways - <a href="http://apaga.pl/config_pirelli.txt">here</a>- the original router&#039;s config file. Earlier in this post - a full instruction on how to make it with Debian. Plus some additional info.</p><p>What I can&#039;t do is translate the debian steps, add pieces of old config and strips of information from blogs to compile a step-by-step tutorial to liberate the people here from the ISP&#039;s tyranny. </p><p>Help me Obi-Wan Kenobi... You&#039;re my only hope...</p><p>*Pictures &quot;borrowed&quot; from shmandre.blogspot.com</p><p>And please, go easy on me...</p><p>like: ssh to the router, <br />opkg update &amp;&amp; opkg install nano<br />cd /etc/config<br />nano network</p><p>paste the following:<br />blablabla</p><p>reboot<br />check if it works; if it does, say how cool we are. If not - look into some logs, paste them here and let&#039;s try again.</p><p><img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p126224">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">azzkickr</div>
					<div class="post-datetime">
						22 Jan 2011, 18:55					</div>
				</div>
				<div class="post-content content">
					<p>Seriously?</p><p>As soon as one puts IPTV in the subject - no answers, literally. Does it really scare so much?</p><p>So in other words:</p><p>I have _some_ stuff coming to vlan6. Please help me create a vlan6 on switch port 4 and make the stuff addressed for it go there...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p126252">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Lubomir</div>
					<div class="post-datetime">
						23 Jan 2011, 02:34					</div>
				</div>
				<div class="post-content content">
					<p>Its funny, i just make nearly same thing before 1 day <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /><br />You just have to take port 1 and 3 as one vlan a second vlan separately for iptv and everything should go out through the wan port. The wan port should have the default internet vlan tag. Work with ethx.xx for tagging. Get a router that does not have problems with tag over 16. Then bridge all together on virtual wan ports and you are done <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>PS: Does OpenWRT support IEEE 802.1p? <a href="https://forum.openwrt.org/viewtopic.php?id=28262">https://forum.openwrt.org/viewtopic.php?id=28262</a></p>											<p class="post-edited">(Last edited by <strong>Lubomir</strong> on 23 Jan 2011, 02:52)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p126253">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">azzkickr</div>
					<div class="post-datetime">
						23 Jan 2011, 02:38					</div>
				</div>
				<div class="post-content content">
					<p>Yes, yes, I&#039;m quite aware of what theoretically needs to be done.<br />What I&#039;m asking for is simply for anybody to actually write the commands for me. And since my TV is on vlan6 - can you explain a bit more why is it so important that my router supports tag over 16? (It does up to 4k I think, but anyway...)</p><p>And dear Lubomir, since you have done that already - can you simply paste the /etc/config/network and other files you&#039;ve modified here?</p><p>That&#039;d be most appreciated <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p126256">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">Lubomir</div>
					<div class="post-datetime">
						23 Jan 2011, 02:57					</div>
				</div>
				<div class="post-content content">
					<p>You write there something about vlan100 and i did not understand why. And where is the difference between vlan 5 and 6?<br />Can you just explain how the traffic goes trough the router and how is the communication based on the other vlan&#039;s then the normal one? Every vlan is separate network. You have to know how to sign up. Internet is normaly PPPoE. How does iptv work?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p126257">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">azzkickr</div>
					<div class="post-datetime">
						23 Jan 2011, 03:05					</div>
				</div>
				<div class="post-content content">
					<p>hello again...</p><p>Forgive me my lameness, please <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>OK - so... The optic fibre comes to my place, goes to a converter to ethernet. This ethernet cable can be either plugged in a pc and then internet works normally, but no TV. If plugged to the original router - there&#039;s TV and internet. So based on the <a href="http://apaga.pl/config_pirelli.txt">original router&#039;s config</a>and some other documentation I realized there&#039;s some vlan thing going on here (I never had to do with vlans before). So I got a reasonably priced router with vlan capability and gigabit wan port - TP-Link WR1043ND.</p><p>1. I assume theres no pppoe whatsoever here. Yes, the original router config file includes adsl modem config but it&#039;s not in use as the wan port is ethernet.<br />2. I know for a fact that vlan6 is (forgive me the lame terminology) where the TV thing is going on. I suppose it means that packets for TV are tagged as vlan6 or something...<br />3. I don&#039;t think I need any of the vlan5 thing as based on the picture above - it&#039;s some internal isp&#039;s management thing. I mean I hope so...</p><p>Hope that clears things a bit.</p><p>And thanks for your interest <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /><br />2.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p126258">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">Lubomir</div>
					<div class="post-datetime">
						23 Jan 2011, 03:12					</div>
				</div>
				<div class="post-content content">
					<p>You write: The optic fibre comes to my place, goes to a converter to ethernet. This ethernet cable can be either plugged in a pc and then internet works normally</p><p>????<br />How should THIS work? I know the technology many ISP&#039;s use and i never heard of something like this o_O You have to register so that they know who you are. What is this &quot;converter&quot;???</p><p>Please sniff first with wireshark to understand how the network is exyctly working before starting to try to make a solution for this.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p126259">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">azzkickr</div>
					<div class="post-datetime">
						23 Jan 2011, 03:30					</div>
				</div>
				<div class="post-content content">
					<p>Jesus Christ...</p><p>No, I don&#039;t have to register. They are pretty much aware where they put the optic fibres. And I suppose, the optic -&gt; ethernet thing has some sort of an ID. Maybe. Anyway - see the pictures yourself, <a href="http://apaga.pl/optic">http://apaga.pl/optic</a></p><p>Look, why don&#039;t we skip the part where you say my setup is impossible, no ISP does that, my converter does not exist, I write about vlan100 in stead of 100Mbps... I think we&#039;re just both tired (at least here it&#039;s 3:24 AM) so let me word again what I&#039;m silently hoping someone could help me with:</p><p>1. Treat everything as it was just ethernet OK? No pppoa pppoe, none of this shit...<br />2. Internet is on (i think) untagged vlan 0 or 1, anyway - the default one...<br />3. IPTV is on Vlan6.</p><p>Please help me, instruct me step by step how to create the vlan6 on switch port 6 and make the firewall ignore the multicast traffic (not block it in case it does). Write something like this, please:</p><p>1. log in to your router<br />2. cd /etc/config/<br />2.a if you hate vi type opkg update &amp;&amp; opkg install nano<br />3. vi or nano ./network<br />4. paste this:<br />blablablablablablabla<br />5. reboot<br />6. check if it works and if yes enjoy, if not, paste some_log here.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p126661">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">azzkickr</div>
					<div class="post-datetime">
						27 Jan 2011, 20:20					</div>
				</div>
				<div class="post-content content">
					<p>OK, so this:</p><div class="codebox"><pre><code>config &#039;interface&#039; &#039;loopback&#039;
       option &#039;ifname&#039;   &#039;lo&#039;
       option &#039;proto&#039;    &#039;static&#039;
       option &#039;ipaddr&#039;   &#039;127.0.0.1&#039;
       option &#039;netmask&#039;  &#039;255.0.0.0&#039;

config &#039;interface&#039; &#039;lan&#039;
        option &#039;ifname&#039;   &#039;eth0.2&#039;
        option &#039;type&#039;     &#039;bridge&#039;
        option &#039;proto&#039;    &#039;static&#039;
        option &#039;ipaddr&#039;   &#039;192.168.1.1&#039;
        option &#039;netmask&#039;  &#039;255.255.255.0&#039;

config &#039;interface&#039; &#039;wan&#039;
        option &#039;ifname&#039; &#039;eth0.1&#039;
        option &#039;proto&#039; &#039;dhcp&#039;

config &#039;interface&#039; &#039;vlan6&#039;
        option &#039;ifname&#039; &#039;eth0.6&#039;
        option &#039;proto&#039; &#039;none&#039;
        option &#039;defaultroute&#039; &#039;0&#039;
        option &#039;peerdns&#039; &#039;0&#039;

config &#039;interface&#039; &#039;vlan5&#039;
        option &#039;ifname&#039; &#039;eth0.5&#039;
        option &#039;proto&#039; &#039;none&#039;
        option &#039;defaultroute&#039; &#039;0&#039;
        option &#039;peerdns&#039; &#039;0&#039;

config &#039;switch&#039;
        option &#039;name&#039; &#039;rtl8366rb&#039;
        option &#039;reset&#039; &#039;1&#039;
        option &#039;enable_vlan&#039; &#039;1&#039;

config &#039;switch_vlan&#039;
        option &#039;device&#039; &#039;rtl8366rb&#039;
        option &#039;vlan&#039; &#039;6&#039;
        option &#039;ports&#039; &#039;0t 4 5t&#039;

config &#039;switch_vlan&#039;
        option &#039;device&#039; &#039;rtl8366rb&#039;
        option &#039;vlan&#039; &#039;5&#039;
        option &#039;ports&#039; &#039;0t 5t&#039;

config &#039;switch_vlan&#039;
        option &#039;device&#039; &#039;rtl8366rb&#039;
        option &#039;vlan&#039; &#039;1&#039;
        option &#039;ports&#039; &#039;0 5t&#039;

config &#039;switch_vlan&#039;
        option &#039;device&#039; &#039;rtl8366rb&#039;
        option &#039;vlan&#039; &#039;2&#039;
        option &#039;ports&#039; &#039;1 2 3 5t&#039;</code></pre></div><p>Did the trick - meaning I have settop box working.</p><p>Any ideas how can I make it also work on a PC?</p><p>Lithuanian instruction for Pirelli DRG125 (from google translator)</p><p>Log in to the router. This can be done any browser the introduction of the router&#039;s IP address. In most cases an IP router is 192.168.1.254. When connected to a router, you will need to enter a user name and password. If I am not mistaken, the standard configuration and a user name and password are the same - &quot;admin&quot;.<br />&nbsp; &nbsp; Activate IGMP, IGMP fast-leave IGMP multicast and unicast the functionality. In order to choose the &quot;Advanced&quot;&gt; &quot;Routing&quot; section for Routing Protocols &quot;tick tick the appropriate options. Activate the changes by clicking the &quot;Apply&quot;<br />&nbsp; &nbsp; Activate the IP routing between the internal network and GALA TV Network (VLAN6). Need a menu to choose the &quot;Network Connections&quot;. Then activate the bridge of IPTV &quot;link. In this way, open the Gala TV subnet configuration page. Column of the &quot;Settings&quot; under &quot;Internet Protocol&quot; select &quot;Obtain an IP address automatically&quot;. Activate the changes by clicking the &quot;Apply&quot;. The column &quot;routing&quot; in the &#039;Routing Mode &quot;to&quot; NAPT &quot;tick tick&quot; Multicast - IGMP Proxy Default &quot;and add a route (route) to the&quot; Destination &quot;239.2.0.0 and netmask&quot; 255.255.0.0. Activate the changes by clicking the &quot;Apply&quot;<br />&nbsp; &nbsp; Activate IGMP intranet. Need a menu to choose the &quot;Network Connections&quot;. Then activate the LAN Bridge &#039;link. In this way, open the internal network configuration page. The column &quot;routing&quot; in the &#039;Multicast - IGMP Proxy Internal&#039; (put a check mark) and choose &quot;IGMPv3.<br />&nbsp; &nbsp; Reload the router. Choose the menu item &quot;Advanced&quot; and then &quot;reboot&quot;. Wait 2-3 minutes and can be tested.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>