<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> No LAN with RB493 and Kamikaze - Please Help</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 19 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p81998">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">robrob</div>
					<div class="post-datetime">
						16 Feb 2009, 23:37					</div>
				</div>
				<div class="post-content content">
					<p>The only ehternet port that functions on my RB493AH is the WAN port, eth0. eth1 is found but the IPC178+ switch isn&#039;t initialized so no LAN ports will ping transmit or receive. I&#039;m using the latest SVN co of the Kamikaze trunk. Using make menuconfig I reset and then set up for the AR7100 target. It builds fine but no LAN ports.</p><p>Here&#039;s the dmesg, note the:<br />ag71xx_mdio: probed<br />eth0: Atheros AG71xx at 0xb9000000, irq 4<br />eth1: Atheros AG71xx at 0xba000000, irq 5<br />eth1: connected to PHY at 0:00 [uid=02430d80, driver=Generic PHY]<br />I believe the driver should equal something specifically for the IC178+ switch.</p><div class="codebox"><pre><code>root@OpenWrt:/# dmesg
Linux version 2.6.28.5 (rob@Server) (gcc version 4.1.2) #2 Sun Feb 15 12:24:52 E
ST 2009
prom: fw_arg0=00000007, fw_arg1=a0861c00, fw_arg2=00000000, fw_arg3=00000000
MyLoader: sysp=55555555, boardp=55555555, parts=55555555
console [early0] enabled
CPU revision is: 00019374 (MIPS 24Kc)
Atheros AR7161 rev 2 (id:0xaa), CPU:680.000 MHz, AHB:170.000 MHz, DDR:340.000 MH
z
Determined physical RAM map:
 memory: 08000000 @ 00000000 (usable)
Initrd not found or empty - disabling initrd
Zone PFN ranges:
  Normal   0x00000000 -&gt; 0x00008000
Movable zone start PFN for each node
early_node_map[1] active PFN ranges
    0: 0x00000000 -&gt; 0x00008000
On node 0 totalpages: 32768
free_area_init_node: node 0, pgdat 80275800, node_mem_map 81000000
  Normal zone: 256 pages used for memmap
  Normal zone: 0 pages reserved
  Normal zone: 32512 pages, LIFO batch:7
  Movable zone: 0 pages used for memmap
Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 32512
Kernel command line: rootfstype=squashfs,yaffs,jffs2 noinitrd console=ttyS0,1152
00 init=/etc/preinit
Primary instruction cache 64kB, VIPT, 4-way, linesize 32 bytes.
Primary data cache 32kB, 4-way, VIPT, cache aliases, linesize 32 bytes
Writing ErrCtl register=00000800
Readback ErrCtl register=00000800
PID hash table entries: 512 (order: 9, 2048 bytes)
Dentry cache hash table entries: 16384 (order: 4, 65536 bytes)
Inode-cache hash table entries: 8192 (order: 3, 32768 bytes)
Memory: 127004k/131072k available (1816k kernel code, 3892k reserved, 326k data,
 132k init, 0k highmem)
SLUB: Genslabs=6, HWalign=32, Order=0-3, MinObjects=0, CPUs=1, Nodes=1
Calibrating delay loop... 452.19 BogoMIPS (lpj=2260992)
Mount-cache hash table entries: 512
net_namespace: 480 bytes
NET: Registered protocol family 16
MIPS: machine is MikroTik RouterBOARD 493/AH
registering PCI controller with io_map_base unset
pci 0000:00:00.0: reg 10 32bit mmio: [0x000000-0xfffffff]
pci 0000:00:00.0: reg 14 io port: [0x00-0xff]
pci 0000:00:00.0: supports D1 D2
pci 0000:00:00.0: PME# supported from D0 D1 D2 D3hot
pci 0000:00:00.0: PME# disabled
pci 0000:00:12.0: reg 10 32bit mmio: [0x000000-0x00ffff]
pci 0000:00:14.0: reg 10 32bit mmio: [0x000000-0x00ffff]
pci 0000:00:14.0: PME# supported from D0 D3hot
pci 0000:00:14.0: PME# disabled
PCI: mapping irq 32 to pin1@0000:00:12.0
PCI: mapping irq 34 to pin1@0000:00:14.0
NET: Registered protocol family 2
Switched to high resolution mode on CPU 0
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 4096 (order: 3, 32768 bytes)
TCP bind hash table entries: 4096 (order: 2, 16384 bytes)
TCP: Hash tables configured (established 4096 bind 4096)
TCP reno registered
NET: Registered protocol family 1
squashfs: version 3.0 (2006/03/15) Phillip Lougher
Registering mini_fo version $Id$
JFFS2 version 2.2. (NAND) (SUMMARY)  Ã‚Â© 2001-2006 Red Hat, Inc.
yaffs Feb 15 2009 07:20:20 Installing.
msgmni has been set to 248
io scheduler noop registered
io scheduler deadline registered (default)
Serial: 8250/16550 driver1 ports, IRQ sharing disabled
serial8250.0: ttyS0 at MMIO 0x18020000 (irq = 11) is a 16550A
console handover: boot [early0] -&gt; real [ttyS0]
ag71xx_mdio: probed  &lt;&lt;&lt;&lt;&lt;**********************************************
eth0: Atheros AG71xx at 0xb9000000, irq 4
eth1: Atheros AG71xx at 0xba000000, irq 5
eth1: connected to PHY at 0:00 [uid=02430d80, driver=Generic PHY]   &lt;&lt;&lt;&lt;&lt;**************************
NAND flash driver for RouterBoard 4xx series version 0.1.10
NAND SPI clock 28333 kHz (AHB 170000 kHz / 6)
FLASH SPI clock 28333 kHz (AHB 170000 kHz / 6)
NAND device: Manufacturer ID: 0xad, Chip ID: 0x76 (Hynix NAND 64MiB 3,3V 8-bit)
Scanning device for bad blocks
Creating 3 MTD partitions on &quot;NAND 64MiB 3,3V 8-bit&quot;:
0x00000000-0x00040000 : &quot;booter&quot;
0x00040000-0x00400000 : &quot;kernel&quot;
0x00400000-0x04000000 : &quot;rootfs&quot;
mtd: partition &quot;rootfs&quot; set to be root filesystem
split_squashfs: error occured while reading from &quot;NAND 64MiB 3,3V 8-bit&quot;
Atheros AR71xx SPI Controller driver version 0.2.2
Atheros AR71xx hardware watchdog driver version 0.1.0
ar71xx-wdt: timeout=15 secs (max=25)
TCP vegas registered
NET: Registered protocol family 17
802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;
All bugs added by David S. Miller &lt;davem@redhat.com&gt;
yaffs: dev is 32505858 name is &quot;mtdblock2&quot;
yaffs: passed flags &quot;&quot;
yaffs: Attempting MTD mount on 31.2, &quot;mtdblock2&quot;
yaffs_read_super: isCheckpointed 0
VFS: Mounted root (yaffs filesystem) readonly.
Freeing unused kernel memory: 132k freed
Please be patient, while OpenWrt loads ...
Algorithmics/MIPS FPU Emulator v1.5
save exit: isCheckpointed 0
ar71xx: pll_reg 0xb8050010: 0x1099
eth0: link up (100Mbps/Full duplex)
device eth0 entered promiscuous mode
br-lan: topology change detected, propagating
br-lan: port 1(eth0) entering forwarding state
device eth1 entered promiscuous mode
cfg80211: Using static regulatory domain info
cfg80211: Regulatory domain: US
        (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp)
        (2402000 KHz - 2472000 KHz @ 40000 KHz), (600 mBi, 2700 mBm)
        (5170000 KHz - 5190000 KHz @ 40000 KHz), (600 mBi, 2300 mBm)
        (5190000 KHz - 5210000 KHz @ 40000 KHz), (600 mBi, 2300 mBm)
        (5210000 KHz - 5230000 KHz @ 40000 KHz), (600 mBi, 2300 mBm)
        (5230000 KHz - 5330000 KHz @ 40000 KHz), (600 mBi, 2300 mBm)
        (5735000 KHz - 5835000 KHz @ 40000 KHz), (600 mBi, 3000 mBm)
cfg80211: Calling CRDA for country: US
PCI: Enabling device 0000:00:14.0 (0000 -&gt; 0002)
ar71xx: pll_reg 0xb8050014: 0x1099
eth1: link up (100Mbps/Full duplex)
br-lan: port 1(eth0) entering disabled state
br-lan: topology change detected, propagating
br-lan: port 2(eth1) entering forwarding state
br-lan: topology change detected, propagating
br-lan: port 1(eth0) entering forwarding state
phy0: Selected rate control algorithm &#039;ath9k_rate_control&#039;
cfg80211: Calling CRDA for country: AM
Registered led device: ath9k-phy0::radio
Registered led device: ath9k-phy0::assoc
Registered led device: ath9k-phy0::tx
Registered led device: ath9k-phy0::rx
phy0: Atheros AR9160 MAC/BB Rev:0 AR5133 RF Rev:b0: mem=0xb0010000, irq=34
PPP generic driver version 2.4.2
ip_tables: (C) 2000-2006 Netfilter Core Team
nf_conntrack version 0.5.0 (2048 buckets, 8192 max)
CONFIG_NF_CT_ACCT is deprecated and will be removed soon. Please use
nf_conntrack.acct=1 kernel paramater, acct=1 nf_conntrack module option or
sysctl net.netfilter.nf_conntrack_acct=1 to enable it.
wlan: trunk
ath_hal: module license &#039;Proprietary&#039; taints kernel.
ath_hal: 2008-10-02 (AR5210, AR5211, AR5212, AR5416, RF5111, RF5112, RF2413, RF5
413, RF2133, RF2425, REGOPS_FUNC, DFS, XR)
ath_rate_minstrel: Minstrel automatic rate control algorithm 1.2 (trunk)
ath_rate_minstrel: look around rate set to 10%
ath_rate_minstrel: EWMA rolloff level set to 75%
ath_rate_minstrel: max segment size in the mrr set to 6000 us
wlan: mac acl policy registered
ath_pci: trunk
PCI: Enabling device 0000:00:12.0 (0000 -&gt; 0002)
Atheros HAL provided by OpenWrt, DD-WRT and MakSat Technologies
wifi0: 11a rates: 6Mbps 9Mbps 12Mbps 18Mbps 24Mbps 36Mbps 48Mbps 54Mbps
wifi0: 11b rates: 1Mbps 2Mbps 5.5Mbps 11Mbps
wifi0: 11g rates: 1Mbps 2Mbps 5.5Mbps 11Mbps 6Mbps 9Mbps 12Mbps 18Mbps 24Mbps 36
Mbps 48Mbps 54Mbps
wifi0: turboA rates: 6Mbps 9Mbps 12Mbps 18Mbps 24Mbps 36Mbps 48Mbps 54Mbps
wifi0: turboG rates: 6Mbps 12Mbps 18Mbps 24Mbps 36Mbps 48Mbps 54Mbps
wifi0: H/W encryption support: WEP AES AES_CCM TKIP
ath_pci: wifi0: Atheros 5212: mem=0x10000000, irq=32
device wlan0 entered promiscuous mode
wlan0: deauthenticating by local choice (reason=3)
br-lan: port 3(wlan0) entering disabled state
br-lan: topology change detected, propagating
br-lan: port 3(wlan0) entering forwarding state
br-lan: port 3(wlan0) entering disabled state
device ath0 entered promiscuous mode
br-lan: topology change detected, propagating
br-lan: port 4(ath0) entering forwarding state
ar71xx-wdt: enabling watchdog timer
root@OpenWrt:/#</code></pre></div><p>Here&#039;s the lsmod:<br /></p><div class="codebox"><pre><code>root@OpenWrt:/# lsmod
Module                  Size  Used by    Tainted: P
ath_pci               107824  0
wlan_xauth               416  0
wlan_wep                3584  0
wlan_tkip               8928  0
wlan_ccmp               4992  0
wlan_acl                2048  0
ath_rate_minstrel       8384  1
ath_hal               291264  3 ath_pci,ath_rate_minstrel
wlan_scan_sta           7168  0
wlan_scan_ap            4544  1
wlan                  148880  10 ath_pci,wlan_xauth,wlan_wep,wlan_tkip,wlan_ccmp
,wlan_acl,ath_rate_minstrel,wlan_scan_sta,wlan_scan_ap
nf_nat_tftp              416  0
nf_conntrack_tftp       2416  1 nf_nat_tftp
nf_nat_irc               832  0
nf_conntrack_irc        2752  1 nf_nat_irc
nf_nat_ftp              1408  0
nf_conntrack_ftp        4864  1 nf_nat_ftp
ipt_MASQUERADE          1120  1
iptable_nat             2864  1
nf_nat                 10752  5 nf_nat_tftp,nf_nat_irc,nf_nat_ftp,ipt_MASQUERADE
,iptable_nat
xt_state                 800  6
nf_conntrack_ipv4       7744  9 iptable_nat,nf_nat
nf_defrag_ipv4           640  1 nf_conntrack_ipv4
nf_conntrack           39280  11 nf_nat_tftp,nf_conntrack_tftp,nf_nat_irc,nf_con
ntrack_irc,nf_nat_ftp,nf_conntrack_ftp,ipt_MASQUERADE,iptable_nat,nf_nat,xt_stat
e,nf_conntrack_ipv4
ipt_REJECT              1792  2
xt_TCPMSS               1984  1
ipt_LOG                 4480  0
xt_multiport            1824  0
xt_mac                   544  0
xt_limit                1024  1
iptable_mangle          1120  0
iptable_filter           928  1
ip_tables               8144  3 iptable_nat,iptable_mangle,iptable_filter
xt_tcpudp               1824  3
x_tables                8944  11 ipt_MASQUERADE,iptable_nat,xt_state,ipt_REJECT,
xt_TCPMSS,ipt_LOG,xt_multiport,xt_mac,xt_limit,ip_tables,xt_tcpudp
ppp_async               6720  0
ppp_generic            20320  1 ppp_async
slhc                    4416  1 ppp_generic
ath9k                 241952  0
mac80211              194528  1 ath9k
cfg80211               36576  2 ath9k,mac80211
crc_ccitt                960  1 ppp_async
arc4                     800  2
aes_generic            28656  0
deflate                 1504  0
hmac                    2720  0
ecb                     1376  2
cbc                     2144  0
crypto_hash             2624  1 hmac
cryptomgr              70800  0
crypto_blkcipher        7664  3 ecb,cbc,cryptomgr
aead                    3744  1 cryptomgr
crypto_algapi           9152  9 arc4,aes_generic,deflate,hmac,ecb,cbc,cryptomgr,
crypto_blkcipher,aead
root@OpenWrt:/#
root@OpenWrt:/# lsmod
Module                  Size  Used by    Tainted: P
ath_pci               107824  0
wlan_xauth               416  0
wlan_wep                3584  0
wlan_tkip               8928  0
wlan_ccmp               4992  0
wlan_acl                2048  0
ath_rate_minstrel       8384  1
ath_hal               291264  3 ath_pci,ath_rate_minstrel
wlan_scan_sta           7168  0
wlan_scan_ap            4544  1
wlan                  148880  10 ath_pci,wlan_xauth,wlan_wep,wlan_tkip,wlan_ccmp
,wlan_acl,ath_rate_minstrel,wlan_scan_sta,wlan_scan_ap
nf_nat_tftp              416  0
nf_conntrack_tftp       2416  1 nf_nat_tftp
nf_nat_irc               832  0
nf_conntrack_irc        2752  1 nf_nat_irc
nf_nat_ftp              1408  0
nf_conntrack_ftp        4864  1 nf_nat_ftp
ipt_MASQUERADE          1120  1
iptable_nat             2864  1
nf_nat                 10752  5 nf_nat_tftp,nf_nat_irc,nf_nat_ftp,ipt_MASQUERADE
,iptable_nat
xt_state                 800  6
nf_conntrack_ipv4       7744  9 iptable_nat,nf_nat
nf_defrag_ipv4           640  1 nf_conntrack_ipv4
nf_conntrack           39280  11 nf_nat_tftp,nf_conntrack_tftp,nf_nat_irc,nf_con
ntrack_irc,nf_nat_ftp,nf_conntrack_ftp,ipt_MASQUERADE,iptable_nat,nf_nat,xt_stat
e,nf_conntrack_ipv4
ipt_REJECT              1792  2
xt_TCPMSS               1984  1
ipt_LOG                 4480  0
xt_multiport            1824  0
xt_mac                   544  0
xt_limit                1024  1
iptable_mangle          1120  0
iptable_filter           928  1
ip_tables               8144  3 iptable_nat,iptable_mangle,iptable_filter
xt_tcpudp               1824  3
x_tables                8944  11 ipt_MASQUERADE,iptable_nat,xt_state,ipt_REJECT,
xt_TCPMSS,ipt_LOG,xt_multiport,xt_mac,xt_limit,ip_tables,xt_tcpudp
ppp_async               6720  0
ppp_generic            20320  1 ppp_async
slhc                    4416  1 ppp_generic
ath9k                 241952  0
mac80211              194528  1 ath9k
cfg80211               36576  2 ath9k,mac80211
crc_ccitt                960  1 ppp_async
arc4                     800  2
aes_generic            28656  0
deflate                 1504  0
hmac                    2720  0
ecb                     1376  2
cbc                     2144  0
crypto_hash             2624  1 hmac
cryptomgr              70800  0
crypto_blkcipher        7664  3 ecb,cbc,cryptomgr
aead                    3744  1 cryptomgr
crypto_algapi           9152  9 arc4,aes_generic,deflate,hmac,ecb,cbc,cryptomgr,
crypto_blkcipher,aead
root@OpenWrt:/#</code></pre></div><div class="codebox"><pre><code>root@OpenWrt:/# ifconfig
ath0      Link encap:Ethernet  HWaddr 00:0C:42:2B:41:74
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:61 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:0 (0.0 B)  TX bytes:15662 (15.2 KiB)

br-lan    Link encap:Ethernet  HWaddr 00:0C:42:2B:41:74
          inet addr:192.168.1.7  Bcast:192.168.1.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:82 errors:0 dropped:0 overruns:0 frame:0
          TX packets:19 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:19438 (18.9 KiB)  TX bytes:1918 (1.8 KiB)

eth0      Link encap:Ethernet  HWaddr 00:0C:42:33:2B:86
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:82 errors:0 dropped:0 overruns:0 frame:0
          TX packets:19 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:20586 (20.1 KiB)  TX bytes:1918 (1.8 KiB)
          Interrupt:4

eth1      Link encap:Ethernet  HWaddr 00:0C:42:33:2B:87
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:79 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 B)  TX bytes:20124 (19.6 KiB)
          Interrupt:5

lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:4 errors:0 dropped:0 overruns:0 frame:0
          TX packets:4 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:448 (448.0 B)  TX bytes:448 (448.0 B)

wifi0     Link encap:UNSPEC  HWaddr 00-0C-42-2B-41-74-00-4C-00-00-00-00-00-00-00
-00
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:2041 errors:0 dropped:0 overruns:0 frame:4
          TX packets:1834 errors:33 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:195
          RX bytes:147006 (143.5 KiB)  TX bytes:194834 (190.2 KiB)
          Interrupt:32

root@OpenWrt:/#</code></pre></div><div class="codebox"><pre><code>root@OpenWrt:/# iwconfig
lo        no wireless extensions.

eth0      no wireless extensions.

eth1      no wireless extensions.

br-lan    no wireless extensions.

wmaster0  no wireless extensions.

wlan0     IEEE 802.11abgn  Mode:Master  Frequency:2.432 GHz  Tx-Power=20 dBm
          Retry min limit:7   RTS thr:off   Fragment thr=2352 B
          Encryption key:off
          Power Management:off
          Link Quality:0  Signal level:0  Noise level:0
          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:0   Missed beacon:0

wifi0     no wireless extensions.

ath0      IEEE 802.11a  ESSID:&quot;OpenWrtMad&quot;  Nickname:&quot;&quot;
          Mode:Master  Frequency:5.2 GHz  Access Point: 00:0C:42:2B:41:74
          Bit Rate:0 kb/s   Tx-Power:15 dBm   Sensitivity=1/1
          Retry:off   RTS thr:off   Fragment thr:off
          Encryption key:off
          Power Management:off
          Link Quality=0/70  Signal level=-96 dBm  Noise level=-96 dBm
          Rx invalid nwid:293  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:0   Missed beacon:0

root@OpenWrt:/#</code></pre></div><p>Anyone see what would cause the LAN ports to not function?</p><p>Thanks in advance,</p><p>Rob</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p82000">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Yanira</div>
					<div class="post-datetime">
						16 Feb 2009, 23:42					</div>
				</div>
				<div class="post-content content">
					<p>Have you built a image with the patches from <a href="http://inst.eecs.berkeley.edu/~pathorn/ip175c/">http://inst.eecs.berkeley.edu/~pathorn/ip175c/</a> ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p82077">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">robrob</div>
					<div class="post-datetime">
						17 Feb 2009, 20:31					</div>
				</div>
				<div class="post-content content">
					<p>Yanira,</p><p>Thanks for the reply but Patrick&#039;s ip175c patch just enables VLAN on the 175/178 switch (his words). The problem with the patch is it&#039;s for the 2.6.26 kernel and I need the latest kernel for ath9k 80211n support.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p82103">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">robrob</div>
					<div class="post-datetime">
						18 Feb 2009, 05:08					</div>
				</div>
				<div class="post-content content">
					<p>I forgot to mention, I have the same problem with the precompiled trunk download file for the AR7100, but RouterOS works perfectly with all 9 ethernet ports working.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p82114">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">Yanira</div>
					<div class="post-datetime">
						18 Feb 2009, 11:40					</div>
				</div>
				<div class="post-content content">
					<p>You have to build by yourself with the patches below:</p><p>- <a href="http://inst.eecs.berkeley.edu/~pathorn/ip175c/phylib/icplus-v3.1.patch">http://inst.eecs.berkeley.edu/~pathorn/ … v3.1.patch</a> (from <a href="http://inst.eecs.berkeley.edu/~pathorn/ip175c/phylib/)">http://inst.eecs.berkeley.edu/~pathorn/ip175c/phylib/)</a><br />and<br />- <a href="http://jan.willies.info/990-phyfix.patch">http://jan.willies.info/990-phyfix.patch</a></p><p>After configuring the switch in /etc/config/network it works just fine. My DIR-300 also has a 175c switch.</p>											<p class="post-edited">(Last edited by <strong>Yanira</strong> on 18 Feb 2009, 11:41)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p82154">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">robrob</div>
					<div class="post-datetime">
						18 Feb 2009, 19:29					</div>
				</div>
				<div class="post-content content">
					<p>Both of those patches are for the 2.6.26 kernel which I did have up and running but without ath9k functioning. I guess this confirms that the RB4xx routers will only function with the old kernel. I need the newer kernel for the ath9k and 11n support. Thanks for the help guys.</p><p>Rob</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p82613">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">phorn</div>
					<div class="post-datetime">
						25 Feb 2009, 08:31					</div>
				</div>
				<div class="post-content content">
					<p>Hi,<br />Sorry, I have been busy with other projects lately. Turns out that atheros *still* has the old kernel 2.6.26.8 marked as the default in target/linux/atheros/Makefile, which would explain why I haven&#039;t noticed on my router</p><p>Anyway, I tried manually changing it to 2.6.28 and compiled with that.&nbsp; The only error I got was on line 1159 regarding a debug statement, but if I comment it out, it compiles.<br />Basically, add // to the beginning of line 1159 to comment it out.</p><p>I have not yet tested actually running the driver, but it does seem to compile except for that one thing. Is something else is tripping you up?<br />I&#039;ll see if I can find some time on Thursday to test reflashing with 2.6.28.</p><p>Actually, while I&#039;m on the subject, it would be wonderful for this to be included in mainline Openwrt so that people don&#039;t have to resort to patching and compiling from source.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p87553">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">mangatono</div>
					<div class="post-datetime">
						7 May 2009, 19:57					</div>
				</div>
				<div class="post-content content">
					<p>Good day gentlemen,</p><p>Are there any news ? </p><p>this are my outputs: <br /></p><div class="codebox"><pre><code> ---------------------------------------------------
root@OpenWrt:/# dmesg 
Linux version 2.6.26.5 (taro@Hokan) (gcc version 4.1.2) #1 Thu May 7 14:32:42 CEST 2009
prom: fw_arg0=00000007, fw_arg1=a0861c00, fw_arg2=00000000, fw_arg3=00000000
MyLoader: sysp=ffffffff, boardp=ffffffff, parts=fffffffb
console [early0] enabled
CPU revision is: 00019374 (MIPS 24K)
Determined physical RAM map:
 memory: 08000000 @ 00000000 (usable)
Entering add_active_range(0, 0, 32768) 0 entries of 256 used
Initrd not found or empty - disabling initrd
Zone PFN ranges:
  Normal          0 -&gt;    32768
Movable zone start PFN for each node
early_node_map[1] active PFN ranges
    0:        0 -&gt;    32768
On node 0 totalpages: 32768
  Normal zone: 256 pages used for memmap
  Normal zone: 0 pages reserved
  Normal zone: 32512 pages, LIFO batch:7
  Movable zone: 0 pages used for memmap
Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 32512
Kernel command line: root=/dev/mtdblock2 rootfstype=squashfs,yaffs,jffs2 noinitrd console=ttyS0,115200 init=/etc/preinit
Primary instruction cache 64kB, VIPT, 4-way, linesize 32 bytes.
Primary data cache 32kB, 4-way, VIPT, cache aliases, linesize 32 bytes
Writing ErrCtl register=00040020
Readback ErrCtl register=00040020
PID hash table entries: 512 (order: 9, 2048 bytes)
Dentry cache hash table entries: 16384 (order: 4, 65536 bytes)
Inode-cache hash table entries: 8192 (order: 3, 32768 bytes)
Memory: 125540k/131072k available (1761k kernel code, 5436k reserved, 313k data, 1748k init, 0k highmem)
SLUB: Genslabs=6, HWalign=32, Order=0-3, MinObjects=0, CPUs=1, Nodes=1
Calibrating delay loop... 452.19 BogoMIPS (lpj=2260992)
Mount-cache hash table entries: 512
net_namespace: 484 bytes
NET: Registered protocol family 16
MIPS: machine is MikroTik RouterBOARD 493/AH
registering PCI controller with io_map_base unset
NET: Registered protocol family 2
Switched to high resolution mode on CPU 0
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 4096 (order: 3, 32768 bytes)
TCP bind hash table entries: 4096 (order: 2, 16384 bytes)
TCP: Hash tables configured (established 4096 bind 4096)
TCP reno registered
NET: Registered protocol family 1
squashfs: version 3.0 (2006/03/15) Phillip Lougher
Registering mini_fo version $Id$
JFFS2 version 2.2. (NAND) (SUMMARY)  Â© 2001-2006 Red Hat, Inc.
yaffs May  7 2009 14:29:01 Installing. 
msgmni has been set to 245
io scheduler noop registered
io scheduler deadline registered (default)
Serial: 8250/16550 driver $Revision: 1.90 $ 1 ports, IRQ sharing disabled
serial8250.0: ttyS0 at MMIO 0x18020000 (irq = 11) is a 16550A
console handover: boot [early0] -&gt; real [ttyS0]
ICPlus: IP178C detected
ag71xx_mdio: probed
eth0: Atheros AG71xx at 0xb9000000, irq 4
eth0: connected to 0 PHYs
eth1: Atheros AG71xx at 0xba000000, irq 5
eth1: connected to PHY at 0:00 [uid=02430d80, driver=ICPlus]
NAND flash driver for RouterBoard 4xx series version 0.1.10
NAND SPI clock 28333 kHz (AHB 170000 kHz / 6)
FLASH SPI clock 28333 kHz (AHB 170000 kHz / 6)
NAND device: Manufacturer ID: 0xad, Chip ID: 0x76 (Hynix NAND 64MiB 3,3V 8-bit)
Scanning device for bad blocks
Bad eraseblock 1024 at 0x01000000
Bad eraseblock 2608 at 0x028c0000
Bad eraseblock 3428 at 0x03590000
Creating 3 MTD partitions on &quot;NAND 64MiB 3,3V 8-bit&quot;:
0x00000000-0x00040000 : &quot;booter&quot;
0x00040000-0x00400000 : &quot;kernel&quot;
0x00400000-0x04000000 : &quot;rootfs&quot;
mtd: partition &quot;rootfs&quot; set to be root filesystem
split_squashfs: no squashfs found in &quot;NAND 64MiB 3,3V 8-bit&quot;
Atheros AR71xx SPI Controller driver version 0.2.2
Atheros AR71xx hardware watchdog driver version 0.1.0
ar71xx-wdt: timeout=15 secs (max=25)
Registered led device: rb4xx:yellow:user
TCP vegas registered
NET: Registered protocol family 17
802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;
All bugs added by David S. Miller &lt;davem@redhat.com&gt;
Freeing unused kernel memory: 1748k freed
Algorithmics/MIPS FPU Emulator v1.5
eth1: link up (100Mbps/Full duplex)
eth0: link up (100Mbps/Full duplex)
br-lan: Dropping NETIF_F_UFO since no NETIF_F_HW_CSUM feature.
device eth0 entered promiscuous mode
br-lan: port 1(eth0) entering learning state
br-lan: topology change detected, propagating
br-lan: port 1(eth0) entering forwarding state
switch_robo: Unknown symbol nvram_get
switch-ip175c: Found a IP178C chip at ag71xx_mdio, id 0
switch-ip175c: Found IP178C switch at bus id 0:00 (PHY 0)
switch-ip175c: Found IP178C switch at bus id 0:01 (PHY 1)
switch-ip175c: Found IP178C switch at bus id 0:02 (PHY 2)
switch-ip175c: Found IP178C switch at bus id 0:03 (PHY 3)
switch-ip175c: Found IP178C switch at bus id 0:04 (PHY 4)
switch-ip175c: Found IP178C switch at bus id 0:05 (PHY 5)
switch-ip175c: Found IP178C switch at bus id 0:06 (PHY 6)
switch-ip175c: Found IP178C switch at bus id 0:07 (PHY 7)
nbd: registered device at major 43
PPP generic driver version 2.4.2
ip_tables: (C) 2000-2006 Netfilter Core Team
nf_conntrack version 0.5.0 (2048 buckets, 8192 max)
wlan: trunk
ath_hal: module license &#039;Proprietary&#039; taints kernel.
ath_hal: 2008-10-02 (AR5210, AR5211, AR5212, AR5416, RF5111, RF5112, RF2413, RF5413, RF2133, RF2425, REGOPS_FUNC, DFS, XR)
ath_rate_minstrel: Minstrel automatic rate control algorithm 1.2 (trunk)
ath_rate_minstrel: look around rate set to 10%
ath_rate_minstrel: EWMA rolloff level set to 75%
ath_rate_minstrel: max segment size in the mrr set to 6000 us
wlan: mac acl policy registered
ath_pci: trunk
br-lan: port 1(eth0) entering disabled state
br-lan: port 1(eth0) entering learning state
br-lan: topology change detected, propagating
br-lan: port 1(eth0) entering forwarding state
ar71xx-wdt: enabling watchdog timer
root@OpenWrt:/#</code></pre></div><p>user-switch<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# ./user-switch 
Router Enabled: 0
VLANs Enabled: 0
Tagged Ports: 0 1 2 3 4 5
Untgged Ports: 0 1 2 3 4 5
Number of VLANs: 2
Port info:
    Port 0 shares with {0,1,2,3,4,5} and defaults to VLAN 65535
    Port 1 shares with {0,1,2,3,4,5} and defaults to VLAN 65535
    Port 2 shares with {0,1,2,3,4,5} and defaults to VLAN 65535
    Port 3 shares with {0,1,2,3,4,5} and defaults to VLAN 65535
    Port 4 shares with {0,1,2,3,4,5} and defaults to VLAN 65535
    Port 5 shares with {0,1,2,3,4,5} and defaults to VLAN 65535
VLAN info:
    VLAN 0 contains ports {3}
    VLAN 1 contains ports {0,1,2,5}
    VLAN 2 contains ports {5}
    VLAN 3 contains ports {1}
    VLAN 4 contains ports {0}
    VLAN 5 contains ports 
    VLAN 6 contains ports {0}
    VLAN 7 contains ports 
    VLAN 8 contains ports {0}
    VLAN 9 contains ports 
    VLAN 10 contains ports {0}
    VLAN 11 contains ports 
    VLAN 12 contains ports {0}
    VLAN 13 contains ports 
    VLAN 14 contains ports {0}
    VLAN 15 contains ports 

root@OpenWrt:~#</code></pre></div><p>I`m using latest svn 2.6.26&nbsp; and CONFIG_IP175C_PHY=y in kernel config</p><div class="codebox"><pre><code> 

root@OpenWrt:/proc/switch/0# cat version  reg name driver enable enable_router  
0.3  
9
IP178C
ip175c
1
0
root@OpenWrt:/proc/switch/0#</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p87889">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">oz</div>
					<div class="post-datetime">
						13 May 2009, 12:57					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>Is there patches for RB493AH IC+ IP178C switch available for kernel 2.6.28 for trunk branch?</p><p>Thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p88081">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">mangatono</div>
					<div class="post-datetime">
						16 May 2009, 11:10					</div>
				</div>
				<div class="post-content content">
					<p>I will try to compile the 2.6.28 kernel today, but I`m not very sure it will work.&nbsp; I quess we need some patch, because the hardware is so specific. </p><p>Update will be follow ..... maybe <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>UPDATE : still not working, grrrrr c.c</p>											<p class="post-edited">(Last edited by <strong>mangatono</strong> on 22 May 2009, 10:15)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p88758">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">robrob</div>
					<div class="post-datetime">
						26 May 2009, 16:09					</div>
				</div>
				<div class="post-content content">
					<p>Success with the RB493AH and the IP175/178 switch driver.</p><p>phorn&#039;s switch driver and patch now work with the 2.6.28 kernel.</p><p>This is all it took (with some troubleshooting) to make the RB493 fully functional:</p><p>Fresh svn checkout<br />Placed phorn&#039;s patch <a href="http://inst.eecs.berkeley.edu/~pathorn/ip175c/ar71xx-ip175c.patch">http://inst.eecs.berkeley.edu/~pathorn/ … 175c.patch</a> in the top kamikaze directory<br />implemented the patch with this command: patch -p0 &lt; ar71xx-ip175c.patch<br />Selected &quot;Target Profile/AR7xx&quot; and &quot;Base system/swconfig&quot; in &quot;make menuconfig&quot;<br />Compiled Kamikaze<br />Edited the /etc/config/network:<br /></p><div class="codebox"><pre><code>config switch eth1
option reset 1
option enable_vlan 1

config switch_vlan
option device eth1
option vlan 1
option ports &quot;0 1 2 3 4 5 8t&quot;

config switch_vlan
option device eth1
option vlan 2
option ports &quot;6 7 8t&quot;

config interface lan
option ifname &quot;eth1.1&quot;
option proto static
option type bridge
option ipaddr 192.168.2.1
option netmask 255.255.255.0

config interface lan2
option ifname &quot;eth1.2&quot;
option proto static
option ipaddr 192.168.3.1
option netmask 255.255.255.0

config interface wan
option ifname &quot;eth0&quot;
option proto static
option ipaddr 192.168.1.7
option netmask 255.255.255.0
option gateway 192.168.1.1
option dns 208.67.222.222</code></pre></div><p>Edited /etc/config/firewall.</p>											<p class="post-edited">(Last edited by <strong>robrob</strong> on 27 May 2009, 14:21)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p99153">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">jstech666</div>
					<div class="post-datetime">
						22 Dec 2009, 21:01					</div>
				</div>
				<div class="post-content content">
					<p>Hi all;</p><p>Just got 2&nbsp; rb493s&nbsp; and I&#039;m eager to try things out.<br />If the switch chip is functional for this board .. what is left to get running on it?<br />Curious that there is not&nbsp; profile setup for the routerboard 493s in the main build environment.</p><p>Jay</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p109169">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">dklann</div>
					<div class="post-datetime">
						16 May 2010, 05:24					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>robrob wrote:</cite><blockquote><p>Success with the RB493AH and the IP175/178 switch driver.</p><p>... snip snip ...</p><p>Selected &quot;Target Profile/AR7xx&quot; and &quot;Base system/swconfig&quot; in &quot;make menuconfig&quot;<br />Compiled Kamikaze<br />Edited the /etc/config/network:<br /></p><div class="codebox"><pre><code>config switch eth1
option reset 1
option enable_vlan 1

config switch_vlan
option device eth1
option vlan 1
option ports &quot;0 1 2 3 4 5 8t&quot;

(snipped ...)</code></pre></div><p>Edited /etc/config/firewall.</p></blockquote></div><p>@robrob: Thanks for posting your config. I recently bought a<br />Routerboard 493AH and did not like the RouterOS at all.</p><p>Took me a while to get the UCI configuration correct, but yours was<br />the one that finally made my rb493 work like I want it to.</p><p>Current SVN: 21463 worked out of the box. It was simply a matter of<br />getting the correct VLAN configuration.</p><p>The PoE port (labeld Eth1 on the case, and eth0 in &quot;ifconfig&quot; output)<br />is the WAN. &quot;lan&quot; is jacks Eth2 through Eth7 (swconfig ports 0 through<br />5). &quot;lan2&quot; is jacks Eth8 and Eth9 (swconfig ports 6 and 7. And port 8<br />is the CPU port.</p><p>Here&#039;s my working network configuration (required no firewall changes for the &quot;lan&quot; network to work):<br /></p><div class="codebox"><pre><code>config switch eth1
    option reset 1
    option enable_vlan 1

config switch_vlan
    option device eth1
    option vlan 1
    option ports &quot;0 1 2 3 4 5 8t&quot;

config switch_vlan
    option device eth1
    option vlan 2
    option ports &quot;6 7 8t&quot;

config interface loopback
    option ifname lo
    option proto static
    option ipaddr 127.0.0.1
    option netmask 255.0.0.0

config interface wan
    option ifname eth0
    option proto dhcp

config interface lan
    option ifname &quot;eth1.1&quot;
    option proto static
    option type bridge
    option ipaddr 192.168.1.1
    option netmask 255.255.255.0

config interface lan2
    option ifname &quot;eth1.2&quot;
    option proto static
    option ipaddr 192.168.2.1
    option netmask 255.255.255.0</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p109473">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">robrob</div>
					<div class="post-datetime">
						20 May 2010, 01:48					</div>
				</div>
				<div class="post-content content">
					<p>That&#039;s good news, maybe I&#039;ll flash my 493AH back to OpenWrt.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>