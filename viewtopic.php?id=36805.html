<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Help with IPsec/openwrt Basics</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 14 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p167179">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Avatarofmight</div>
					<div class="post-datetime">
						12 May 2012, 17:42					</div>
				</div>
				<div class="post-content content">
					<p>Hey everyone</p><p>Sorry in advance, I&#039;m new at this. I am looking to get more into networking and I have very little Linux experience and possibly less in scripting.</p><p>One of the things I am wanting to implement IPsec tunnels between 2 site routers. I read through the Wiki page on IPsec basics, troubleshot and stumbled though the package installs, but now i know i have all the packages it says I need.</p><p>Now I sarted going on to the configuration, and I&#039;m not seeing the files it is saying I should see.<br />I am seeing:<br />/etc/racoon.conf: Central configuration file &amp; endpoint definitions<br />/etc/racoon/psk.txt: List of preshared keys<br />/etc/racoon/setkey.conf: Security policies for tunnels</p><p>And not any of these:</p><p>/etc/config/racoon: The OpenWrt configuration file for racoon<br />/etc/init.d/racoon: The racoon start script. It will generate the required configuration files for racoon<br />/var/racoon/racoon.conf: The generated racoon config<br />/var/racoon/psk.txt : The generated file with preshared keys<br />/var/racoon/cert: The folder with generated certificates</p><p>Which this guide seems to be based around.</p><p>I am running Backfire 10.03.1<br />on a Netgear WNDR3700 that uses ar71xx</p><p>ipsec-tools are 0.7.3-3</p><p>Alright, so, back to my question:</p><p>I am wondering if this guide applies to a different version; and if so, if you could direct me to some good informational forum posts and/or guides to help me out. I have been googling for a bit and I&#039;m just getting a little frustrated. (first time actually registering for any forum to fix a problem &gt;.&lt;)</p><p>If this guide is for this version, what am I doing wrong? I tried just creating /etc/config/racoon, but doesn&#039;t seem to start anything, (that&#039;s when I realized none of the other files are where the guide said they were)</p><p>I just again ask for a little patience, I am a novice [probably biting off a bit more than I can chew at the moment but I&#039;m not giving in!] <img src="https://forum.openwrt.org/img/smilies/tongue.png" width="15" height="15" alt="tongue" /></p>											<p class="post-edited">(Last edited by <strong>Avatarofmight</strong> on 12 May 2012, 17:46)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p167209">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">aport</div>
					<div class="post-datetime">
						13 May 2012, 00:03					</div>
				</div>
				<div class="post-content content">
					<p>The site <a href="http://rpc.one.pl">http://rpc.one.pl</a>/ has a lot of very good guides, a few of them regarding ipsec-tools and racoon. It&#039;s in Polish, but Google Translate works pretty well.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p167228">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">birnenschnitzel</div>
					<div class="post-datetime">
						13 May 2012, 11:18					</div>
				</div>
				<div class="post-content content">
					<p>@aport: Thanks for that link. Maybe you could share this experience in the official wiki so it will be helpful for beginners </p><p>Now back to the wiki documentation. Configuration of OpenWrt should be done with a standard interface (called UCI). Whatever daemon you are running the config files should be built a similar way so users can customize the device easily. The IPsec VPN part follows that way while aports link is about configuring racoon directly. </p><p>IPsec VPNs are not very complex to setup. The most difficult is to understand what is going on. Thats why the wiki pages are so long and hopefully well documentet. Basically it boils down to the following steps.</p><p>1. install packages<br />2. create /etc/init.d/racoon from the wiki coding<br />3. create /etc/racoon/firewall.sh from the wiki coding and put a call to it into /etc/firewall.user<br />4. define a new VPN connection in /etc/config/racoon. Syntax: <a href="http://wiki.openwrt.org/doc/uci/racoon">http://wiki.openwrt.org/doc/uci/racoon</a> and example: <a href="http://wiki.openwrt.org/doc/howto/vpn.ipsec.site2site">http://wiki.openwrt.org/doc/howto/vpn.ipsec.site2site</a></p><p>Markus</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p203217">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">dcd742000</div>
					<div class="post-datetime">
						30 May 2013, 17:18					</div>
				</div>
				<div class="post-content content">
					<p>Hi All ad Markus,</p><p>Pls help me, i&#039;m newbee with OpenWrt and Linux also, i have racoon issue when make ipsec site to site vpn from </p><p>openwrt tplink 3040 TL-MR3040 v1Attitude Adjustment 12.09-rc1 /LuCI 0.11 Branch (0.11+svn9425) kernel 3.3.8<br />WAN 3G/LAN 192.168.0.0/24</p><p>call to </p><p>draytek 2910(WAN ADSL myremote.dyndns.net/LAN 128.0.0.0/24)<br />I tested IPSec VPN site to site from 2 draytek 2910 roouters together and tunnel made well.</p><p>I follow those racoon howtos:<br /><a href="http://wiki.openwrt.org/doc/howto/vpn.ipsec.site2site.racoon?s">http://wiki.openwrt.org/doc/howto/vpn.i … e.racoon?s</a>[]=site&amp;s[]=site<br /><a href="http://wiki.openwrt.org/doc/howto/vpn.ipsec.firewall.racoon">http://wiki.openwrt.org/doc/howto/vpn.i … all.racoon</a><br /><a href="http://wiki.openwrt.org/doc/howto/vpn.ipsec.basics.racoon">http://wiki.openwrt.org/doc/howto/vpn.i … ics.racoon</a></p><p>after restart firewall and&nbsp; start racoon<br />/etc/init.d/racoon start i have those message in ssh terminal:</p><p>root@OpenWrt:~# /etc/init.d/racoon start<br />Foreground mode.<br />2013-05-30 18:47:54: INFO: @(#)ipsec-tools 0.8.0 (<a href="http://ipsec-tools.sourceforge.net">http://ipsec-tools.sourceforge.net</a>)<br />2013-05-30 18:47:54: INFO: @(#)This product linked OpenSSL 1.0.1c 10 May 2012 (<a href="http://www.openssl.org/">http://www.openssl.org/</a>)<br />2013-05-30 18:47:54: INFO: Reading configuration from &quot;/var/racoon/racoon.conf&quot;<br />2013-05-30 18:47:55: INFO: 10.66.4.184[500] used for NAT-T<br />2013-05-30 18:47:55: INFO: 10.66.4.184[500] used as isakmp port (fd=7)<br />2013-05-30 18:47:55: INFO: 10.66.4.184[4500] used for NAT-T<br />2013-05-30 18:47:55: INFO: 10.66.4.184[4500] used as isakmp port (fd=8)<br />2013-05-30 18:47:55: INFO: 10.210.187.201[500] used for NAT-T<br />2013-05-30 18:47:55: INFO: 10.210.187.201[500] used as isakmp port (fd=9)<br />2013-05-30 18:47:55: INFO: 10.210.187.201[4500] used for NAT-T<br />2013-05-30 18:47:55: INFO: 10.210.187.201[4500] used as isakmp port (fd=10)<br />2013-05-30 18:47:55: INFO: 127.0.0.0[500] used for NAT-T<br />2013-05-30 18:47:55: INFO: 127.0.0.0[500] used as isakmp port (fd=11)<br />2013-05-30 18:47:55: INFO: 127.0.0.0[4500] used for NAT-T<br />2013-05-30 18:47:55: INFO: 127.0.0.0[4500] used as isakmp port (fd=12)<br />2013-05-30 18:47:55: INFO: 127.0.0.1[500] used for NAT-T<br />2013-05-30 18:47:55: INFO: 127.0.0.1[500] used as isakmp port (fd=13)<br />2013-05-30 18:47:55: INFO: 127.0.0.1[4500] used for NAT-T<br />2013-05-30 18:47:55: INFO: 127.0.0.1[4500] used as isakmp port (fd=14)<br />2013-05-30 18:47:55: INFO: 192.168.0.1[500] used for NAT-T<br />2013-05-30 18:47:55: INFO: 192.168.0.1[500] used as isakmp port (fd=15)<br />2013-05-30 18:47:55: INFO: 192.168.0.1[4500] used for NAT-T<br />2013-05-30 18:47:55: INFO: 192.168.0.1[4500] used as isakmp port (fd=16)<br />2013-05-30 18:47:55: INFO: ::1[500] used as isakmp port (fd=17)<br />2013-05-30 18:47:55: INFO: ::1[4500] used as isakmp port (fd=18)<br />2013-05-30 18:47:55: INFO: fe80::92f6:52ff:fe80:4a93[500] used as isakmp port (fd=19)<br />2013-05-30 18:47:55: INFO: fe80::92f6:52ff:fe80:4a93[4500] used as isakmp port (fd=20)<br />2013-05-30 19:56:20: INFO: 10.78.50.203[500] used for NAT-T<br />2013-05-30 19:56:20: INFO: 10.78.50.203[500] used as isakmp port (fd=7)<br />2013-05-30 19:56:20: INFO: 10.78.50.203[4500] used for NAT-T<br />2013-05-30 19:56:20: INFO: 10.78.50.203[4500] used as isakmp port (fd=8)</p><p>in LuCI =&gt;status=&gt;processes i saw<br />{racoon} /bin/sh /etc/rc.common /etc/init.d/racoon start<br />/usr/sbin/racoon -F -f /var/racoon/racoon.conf<br />/usr/sbin/dropbear -P /var/run/dropbear.1.pid -p 22</p><p>but sorry because i don&#039;t know what to do next to see tunnel, because until this step tunnel not yet established (i see in remote router draytek, i still cannot ping 128.0.0.1)</p><p>Thank for your attention and reply</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>