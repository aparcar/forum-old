<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Please help. PPPoA gets IP Addr, but no internal lan can connect.</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 12 Apr 2018 and 22 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 2 of 2</div><nav><ul><li><a href="viewtopic.php%3Fid=24587&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p108575">
				<div class="post-metadata">
					<div class="post-num">Post #26</div>
					<div class="post-author">hato</div>
					<div class="post-datetime">
						5 May 2010, 14:29					</div>
				</div>
				<div class="post-content content">
					<p>At least my problem still exists (Just tried SVN21371). The router was updated by the &quot;Flash firmware&quot; function of LUCI. And the configuration was preserved during flashing (In fact I tried sysupgrade before, it resulted the same). But as you may already notice, my situation is a little different than Star&#039;s.&nbsp; The default route is always added. The Internet connection just doesn&#039;t work though the pppoe-wan is up with a valid IP. Is there anything I can provide to help the debug of this? This is my only router available. So please provide the information list you need all at one time if possible.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p108592">
				<div class="post-metadata">
					<div class="post-num">Post #27</div>
					<div class="post-author">hato</div>
					<div class="post-datetime">
						5 May 2010, 17:06					</div>
				</div>
				<div class="post-content content">
					<p>A relevant question: How can I go back to a specific svn version (include the package state related)? Simply svn -r rxxxxx up seemed not do the trick.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p108595">
				<div class="post-metadata">
					<div class="post-num">Post #28</div>
					<div class="post-author">Star Shadow</div>
					<div class="post-datetime">
						5 May 2010, 17:36					</div>
				</div>
				<div class="post-content content">
					<p>@hato: svn co svn://.......... -rxxxxxxx</p><p>@jow: With the latest trunk, I cannot bring up a connection at all now. Even if I manually type in the command:<br />pppd plugin pppoatm.so 0.0.38 user .......... password ........ noauth<br />Nothing. Before, it would bring up ppp0, but now, not a thing. I made a fresh config, and I am sure I compiled everything in correctly. I have all ppp modules I could find.</p><p>Is there something I am overlooking?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p108610">
				<div class="post-metadata">
					<div class="post-num">Post #29</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						5 May 2010, 20:25					</div>
				</div>
				<div class="post-content content">
					<p>Whats in logread? Have you tried pppd with debug mode?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p108611">
				<div class="post-metadata">
					<div class="post-num">Post #30</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						5 May 2010, 20:26					</div>
				</div>
				<div class="post-content content">
					<p>hato: please check whether the ppp interface gets added to the firewall (iptables -nvL | grep ppp)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p108617">
				<div class="post-metadata">
					<div class="post-num">Post #31</div>
					<div class="post-author">hato</div>
					<div class="post-datetime">
						5 May 2010, 21:51					</div>
				</div>
				<div class="post-content content">
					<p>Sorry for the confusion that may caused by my post. After re-compiling svn 21277 (and no internet), I compared the packages installed in the old and new 21277 side by side. Then I realized that the newly compiled one has one extra module, ipt-queue which was auto-selected once I tried the dsl-qos-queue (and that failed too, then I deselected this package, but wasn&#039;t aware of the auto-selected kernel module). After removing that module by rmmod, the internet access came back instantly. And then I retried the latest svn, it worked like a charm.</p><p>Thanks for the effort anyway. And keep up with the great job. I love you guys.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p108637">
				<div class="post-metadata">
					<div class="post-num">Post #32</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						6 May 2010, 01:14					</div>
				</div>
				<div class="post-content content">
					<p>hato: great, thanks for the feedback. I started to get crazy since I could not reproduce it <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p108673">
				<div class="post-metadata">
					<div class="post-num">Post #33</div>
					<div class="post-author">Star Shadow</div>
					<div class="post-datetime">
						6 May 2010, 16:12					</div>
				</div>
				<div class="post-content content">
					<p>I tried the latest trunk, as of a few hours ago from this post, and when I try to restart the network init.d, I get this:<br />root@OpenWrt:~# /etc/init.d/network restart<br />ifup: can&#039;t open &#039;/etc/network/interfaces&#039;: No such file or directory</p><p>Could that be part of the issue?</p><p>Then when I tried to start pppd manually, but it still doesn&#039;t show up.</p><p>The only difference is that I add wan0, instead of wan, but I add it to the wan group. Then I use the interface pppoa-wan0. That&#039;s the only thing I am doing different than when I first posted this.</p><p>What packages, so I double check to make sure I have everything installed right?</p><p>Thanks.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p108746">
				<div class="post-metadata">
					<div class="post-num">Post #34</div>
					<div class="post-author">Star Shadow</div>
					<div class="post-datetime">
						7 May 2010, 22:39					</div>
				</div>
				<div class="post-content content">
					<p>Jow, whatever you did in the latest updates, I finally got pppd to work. I need to have the solos-pci.ko compiled into the kernel instead of as a module. No matter what I did, I could not get the card recognized until I did that. Does have ATM and the card driver compiled into the kernel make a difference in how pppd works? Because I still can&#039;t get the mac address to show up on the interfaces page. Also, it connects now and I can get a webpage, but then after a couple minutes, it no longer works. The interface page still shows an IP address, but no web pages come up. :S</p><p>Also, when I start the router up, at the very beginning of the syslog, there is this:<br />May&nbsp; 7 20:21:51 Lanfear daemon.notice pppd[1440]: pppd 2.4.4 started by root, uid 0<br />May&nbsp; 7 20:21:51 Lanfear daemon.info pppd[1440]: Using interface ppp0<br />May&nbsp; 7 20:21:51 Lanfear daemon.notice pppd[1440]: Connect: ppp0 &lt;--&gt; /dev/pts/0</p><p>It tries to start ppp0, but there is nothing configured, so it doesn&#039;t connect right since I need 0.0.38, and most likely only uses XX.YY instead.</p><p>This is a list of all packages installed. Maybe there is something here I don&#039;t need and is conflicting?<br /><a href="http://dpaste.com/191989/">http://dpaste.com/191989/</a><br />Maybe there is something I don&#039;t have that I need?</p><p>Thanks. Almost there.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p108747">
				<div class="post-metadata">
					<div class="post-num">Post #35</div>
					<div class="post-author">Star Shadow</div>
					<div class="post-datetime">
						7 May 2010, 22:57					</div>
				</div>
				<div class="post-content content">
					<p>Jow, I have more for you. I think this is why it&#039;s not working. I get a permission denied. How do I fix? Also, when I start the router, it doesn&#039;t connect to the DSL line, but when I go in to the interface and restart the network, it gets an IP. Why doesn&#039;t it on boot?</p><p>pppoa-wan Link encap:Point-to-Point Protocol&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:BLAH2&nbsp; P-t-P:BLAH1&nbsp; Mask:255.255.255.255<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP POINTOPOINT RUNNING NOARP MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:4 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:4 errors:0 dropped:3 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:5 <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:64 (64.0 B)&nbsp; TX bytes:82 (82.0 B)</p><br /><p>May&nbsp; 7 20:45:35 Lanfear daemon.info pppd[1918]: Plugin pppoatm.so loaded.<br />May&nbsp; 7 20:45:35 Lanfear daemon.notice pppd[1918]: pppd 2.4.4 started by root, uid 0<br />May&nbsp; 7 20:45:35 Lanfear user.debug kernel: Device: 0 Vpi: 0 Vci: 38<br />May&nbsp; 7 20:45:35 Lanfear daemon.info pppd[1918]: Renamed ppp0 to pppoa-wan<br />May&nbsp; 7 20:45:35 Lanfear daemon.info pppd[1918]: Using interface pppoa-wan<br />May&nbsp; 7 20:45:35 Lanfear daemon.notice pppd[1918]: Connect: pppoa-wan &lt;--&gt; 0.0.38<br />May&nbsp; 7 20:45:36 Lanfear daemon.info pppd[1918]: Terminating on signal 15<br />May&nbsp; 7 20:45:41 Lanfear daemon.info pppd[1983]: Plugin pppoatm.so loaded.<br />May&nbsp; 7 20:45:41 Lanfear daemon.notice pppd[1983]: pppd 2.4.4 started by root, uid 0<br />May&nbsp; 7 20:45:41 Lanfear user.debug kernel: Device: 0 Vpi: 0 Vci: 38<br />May&nbsp; 7 20:45:41 Lanfear daemon.info pppd[1983]: Renamed ppp0 to pppoa-wan<br />May&nbsp; 7 20:45:41 Lanfear daemon.info pppd[1983]: Using interface pppoa-wan<br />May&nbsp; 7 20:45:41 Lanfear daemon.notice pppd[1983]: Connect: pppoa-wan &lt;--&gt; 0.0.38<br />May&nbsp; 7 20:45:41 Lanfear daemon.warn dnsmasq[1661]: failed to access /tmp/resolv.conf.auto: No such file or directory</p><p>May&nbsp; 7 20:45:43 Lanfear daemon.info pppd[1983]: Terminating on signal 15<br />May&nbsp; 7 20:45:43 Lanfear daemon.notice pppd[1983]: Connection terminated.</p><p>May&nbsp; 7 20:45:49 Lanfear daemon.info pppd[2462]: Plugin pppoatm.so loaded.<br />May&nbsp; 7 20:45:49 Lanfear daemon.notice pppd[2462]: pppd 2.4.4 started by root, uid 0<br />May&nbsp; 7 20:45:50 Lanfear user.debug kernel: Device: 0 Vpi: 0 Vci: 38<br />May&nbsp; 7 20:45:50 Lanfear daemon.info pppd[2462]: Renamed ppp0 to pppoa-wan<br />May&nbsp; 7 20:45:50 Lanfear daemon.info pppd[2462]: Using interface pppoa-wan<br />May&nbsp; 7 20:45:50 Lanfear daemon.notice pppd[2462]: Connect: pppoa-wan &lt;--&gt; 0.0.38<br />May&nbsp; 7 20:45:52 Lanfear daemon.info pppd[2462]: CHAP authentication succeeded<br />May&nbsp; 7 20:45:52 Lanfear daemon.notice pppd[2462]: CHAP authentication succeeded</p><p>May&nbsp; 7 20:45:52 Lanfear daemon.notice pppd[2462]: local&nbsp; IP address BLAH1<br />May&nbsp; 7 20:45:52 Lanfear daemon.notice pppd[2462]: remote IP address BLAH2<br />May&nbsp; 7 20:45:52 Lanfear daemon.notice pppd[2462]: primary&nbsp; &nbsp;DNS address BLAH3<br />May&nbsp; 7 20:45:52 Lanfear daemon.notice pppd[2462]: secondary DNS address BLAH4<br />May&nbsp; 7 20:45:52 Lanfear user.info firewall: info adding lan (br-lan) to zone lan<br />May&nbsp; 7 20:45:53 Lanfear user.info kernel: device wlan0 entered promiscuous mode<br />May&nbsp; 7 20:45:53 Lanfear user.info kernel: br-lan: port 2(wlan0) entering forwarding state<br />May&nbsp; 7 20:45:53 Lanfear daemon.err dnsmasq[1661]: failed to read /tmp/resolv.conf.auto: Permission denied<br />May&nbsp; 7 20:45:56 Lanfear user.info firewall: info adding wan (pppoa-wan) to zone wan</p><p>May&nbsp; 7 20:46:03 Lanfear daemon.info dnsmasq[2990]: started, version 2.52 cachesize 150<br />May&nbsp; 7 20:46:03 Lanfear daemon.info dnsmasq[2990]: compile time options: IPv6 GNU-getopt no-DBus no-I18N DHCP TFTP<br />May&nbsp; 7 20:46:03 Lanfear daemon.info dnsmasq-dhcp[2990]: DHCP, IP range 192.168.1.10 -- 192.168.1.160, lease time 12h<br />May&nbsp; 7 20:46:03 Lanfear daemon.info dnsmasq[2990]: using local addresses only for domain lan<br />May&nbsp; 7 20:46:03 Lanfear daemon.err dnsmasq[2990]: failed to read /tmp/resolv.conf.auto: Permission denied<br />May&nbsp; 7 20:46:03 Lanfear daemon.warn dnsmasq[2990]: no servers found in /tmp/resolv.conf.auto, will retry<br />May&nbsp; 7 20:46:03 Lanfear daemon.info dnsmasq[2990]: read /etc/hosts - 1 addresses<br />May&nbsp; 7 20:46:03 Lanfear daemon.info dnsmasq-dhcp[2990]: read /etc/ethers - 0 addresses</p><p>May&nbsp; 7 20:46:11 Lanfear daemon.err dnsmasq[2990]: failed to read /tmp/resolv.conf.auto: Permission denied<br />May&nbsp; 7 20:46:12 Lanfear daemon.info dnsmasq-dhcp[2990]: DHCPREQUEST(br-lan) 192.168.1.37 00:16:ea:78:7a:90 <br />May&nbsp; 7 20:46:12 Lanfear daemon.info dnsmasq-dhcp[2990]: DHCPACK(br-lan) 192.168.1.37 00:16:ea:78:7a:90 dingus<br />May&nbsp; 7 20:46:13 Lanfear daemon.err dnsmasq[2990]: failed to read /tmp/resolv.conf.auto: Permission denied<br />May&nbsp; 7 20:46:52 Lanfear daemon.err dnsmasq[2990]: failed to read /tmp/resolv.conf.auto: Permission denied<br />May&nbsp; 7 20:46:57 Lanfear daemon.err dnsmasq[2990]: failed to read /tmp/resolv.conf.auto: Permission denied<br />May&nbsp; 7 20:47:34 Lanfear daemon.err dnsmasq[2990]: failed to read /tmp/resolv.conf.auto: Permission denied</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p108807">
				<div class="post-metadata">
					<div class="post-num">Post #36</div>
					<div class="post-author">Star Shadow</div>
					<div class="post-datetime">
						9 May 2010, 14:46					</div>
				</div>
				<div class="post-content content">
					<p>I still haven&#039;t found out how to fix that permission error. The file is rw r r, so everyone should be able to read it.</p><p>See:<br />root@OpenWrt:/# ls -l /tmp/resolv.conf*<br />-rw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 32 May&nbsp; 9 12:59 /tmp/resolv.conf<br />-rw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 May&nbsp; 9 12:59 /tmp/resolv.conf.auto</p><p>The file exists, it&#039;s named right, so why can&#039;t it read it?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p108842">
				<div class="post-metadata">
					<div class="post-num">Post #37</div>
					<div class="post-author">Star Shadow</div>
					<div class="post-datetime">
						10 May 2010, 12:07					</div>
				</div>
				<div class="post-content content">
					<p>I should mention that I am using the ext2 images. Maybe I don&#039;t have the right ext2 packages installed for the right permissions?</p><p>This is getting very frustrating. I just can&#039;t figure out why this is happening like so.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p108912">
				<div class="post-metadata">
					<div class="post-num">Post #38</div>
					<div class="post-author">Star Shadow</div>
					<div class="post-datetime">
						11 May 2010, 14:28					</div>
				</div>
				<div class="post-content content">
					<p>*bump* This is still not solved. I checked out an earlier revision in hopes that it fixes the problem.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p108919">
				<div class="post-metadata">
					<div class="post-num">Post #39</div>
					<div class="post-author">Star Shadow</div>
					<div class="post-datetime">
						11 May 2010, 17:05					</div>
				</div>
				<div class="post-content content">
					<p>I tried 21360 and it worked perfectly. Well, except for the minor thing that the pppd connection doesn&#039;t connect unless I login and select save and apply on the network interface to restart the process and then it connects. So something with the latest updates cause the permission denied thing.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p108969">
				<div class="post-metadata">
					<div class="post-num">Post #40</div>
					<div class="post-author">zorxd</div>
					<div class="post-datetime">
						12 May 2010, 18:00					</div>
				</div>
				<div class="post-content content">
					<p>Does this bug affect every PPPoE user? If it&#039;s the case, I won&#039;t compile a new trunk revision.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 2 of 2</div><nav><ul><li><a href="viewtopic.php%3Fid=24587&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>