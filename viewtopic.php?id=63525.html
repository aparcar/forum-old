<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> DDNS Issues</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 26 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p315812">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">richard-laing</div>
					<div class="post-datetime">
						20 Mar 2016, 12:43					</div>
				</div>
				<div class="post-content content">
					<p>Hi there I am having an issue with my DDNS script running on my edge router, this is running version 15.05 Chaos Calmer.</p><p>I have setup the DDNS settings however I keep getting a DNS error on the lookup of the registered IP of the current domain name I am trying to point at my router, I would note that this configuration is the same as my older outer that was running version 14 and the username and password are correct at this point in time.</p><p>Any ideas on what I should change?</p><p> </p><div class="codebox"><pre><code>102858  note : PID &#039;7239&#039; started at 2016-03-20 10:28
 102858       : ddns version  : 2.6.4-1
 102858       : uci configuration:
ddns.myddns_ipv4.cacert=&#039;/etc/ssl/certs&#039;
ddns.myddns_ipv4.domain=&#039;xxxxx&#039;
ddns.myddns_ipv4.enabled=&#039;1&#039;
ddns.myddns_ipv4.force_ipversion=&#039;1&#039;
ddns.myddns_ipv4.interface=&#039;wan&#039;
ddns.myddns_ipv4.ip_interface=&#039;pppoa-wan&#039;
ddns.myddns_ipv4.ip_source=&#039;interface&#039;
ddns.myddns_ipv4.lookup_host=&#039;xxxxxxx&#039;
ddns.myddns_ipv4.password=&#039;aaaaaaa&#039;
ddns.myddns_ipv4.service_name=&#039;dnsdynamic.org&#039;
ddns.myddns_ipv4.use_https=&#039;1&#039;
ddns.myddns_ipv4.use_logfile=&#039;1&#039;
ddns.myddns_ipv4.use_syslog=&#039;2&#039;
ddns.myddns_ipv4.username=&#039;yyyyyyy&#039;
ddns.myddns_ipv4=service
 102858       : verbose mode  : 0 - run normal, NO console output
 102901       : check interval: 600 seconds
 102901       : force interval: 259200 seconds
 102901       : retry interval: 60 seconds
 102901       : retry counter : 0 times
 102901       : No old process
 102901       : last update: never
 102901       : Detect registered/public IP
 102902       : #&gt; /usr/bin/host -t A -4 xxxxxxxx  &gt;/var/run/ddns/myddns_ipv4.dat 2&gt;/var/run/ddns/myddns_ipv4.err
 102911 ERROR : BIND host error: &#039;1&#039;
 102911       :
 102911       : Detect registered/public IP
 102911       : #&gt; /usr/bin/host -t A -4 xxxxxxxx  &gt;/var/run/ddns/myddns_ipv4.dat 2&gt;/var/run/ddns/myddns_ipv4.err
 102911 ERROR : BIND host error: &#039;1&#039;
 102911       :
 102912  WARN : Get registered/public IP for &#039;xxxxxxx&#039; failed - retry 1/0 in 60 seconds
 103012       : #&gt; /usr/bin/host -t A -4 xxxxxxxx  &gt;/var/run/ddns/myddns_ipv4.dat 2&gt;/var/run/ddns/myddns_ipv4.err
 103012 ERROR : BIND host error: &#039;1&#039;
 103012       :
 103012  WARN : Get registered/public IP for &#039;xxxxxxxxx&#039; failed - retry 2/0 in 60 seconds
 103112       : #&gt; /usr/bin/host -t A -4 xxxxxxxxx  &gt;/var/run/ddns/myddns_ipv4.dat 2&gt;/var/run/ddns/myddns_ipv4.err
 103112 ERROR : BIND host error: &#039;1&#039;
 103112       :
 103112  WARN : Get registered/public IP for &#039;xxxxxxx&#039; failed - retry 3/0 in 60 seconds</code></pre></div><br /><div class="codebox"><pre><code>config service &#039;myddns_ipv4&#039;
        option enabled &#039;1&#039;
        option username &#039;&#039;
        option use_logfile &#039;1&#039;
        option use_https &#039;1&#039;
        option cacert &#039;/etc/ssl/certs&#039;
        option use_syslog &#039;2&#039;
        option password &#039;&#039;
        option service_name &#039;dnsdynamic.org&#039;
        option domain &#039;xxxxxxxxx&#039;
        option lookup_host &#039;xxxxxxxx&#039;
        option force_ipversion &#039;1&#039;
        option interface &#039;wan&#039;
        option ip_source &#039;interface&#039;
        option ip_interface &#039;pppoa-wan&#039;</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p315814">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">richard-laing</div>
					<div class="post-datetime">
						20 Mar 2016, 12:55					</div>
				</div>
				<div class="post-content content">
					<p>One more thing I also tired the diagnostic steps listed on the DDNS setup page and my nslookup is working </p><div class="codebox"><pre><code>wget -O- http://checkip.dyndns.com
--2016-03-20 10:53:10--  http://checkip.dyndns.com/
Resolving checkip.dyndns.com... 216.146.43.70, 216.146.38.70, 91.198.22.70
Connecting to checkip.dyndns.com|216.146.43.70|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 105 [text/html]
Saving to: &#039;STDOUT&#039;

-                          0%[                                     ]       0  --.-KB/s             &lt;html&gt;&lt;head&gt;&lt;title&gt;Current IP Check&lt;/title&gt;&lt;/head&gt;&lt;body&gt;Current IP Address: xx.xx.xx.xx&lt;/body&gt;&lt;/html&gt;
-                        100%[====================================&gt;]     105  --.-KB/s   in 0s

2016-03-20 10:53:14 (1.08 MB/s) - written to stdout [105/105]</code></pre></div><div class="codebox"><pre><code>nslookup google-public-dns-a.google.com
Server:    192.168.1.1
Address 1: 192.168.1.1 XHOST.lan

Name:      google-public-dns-a.google.com
Address 1: 2001:4860:4860::8888 google-public-dns-a.google.com
Address 2: 8.8.8.8 google-public-dns-a.google.com</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p315822">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">richard-laing</div>
					<div class="post-datetime">
						20 Mar 2016, 14:36					</div>
				</div>
				<div class="post-content content">
					<p>Hi there I Have some follow up on this issue, I went and downgraded my DDNS scripts to the version that was in 14, the version of the package is as follows &#039;ddns-scripts_1.0.0-23_all.ipk&#039;</p><p>I now have the DDNS working correctly I understand there some major changes since this version can some please confirm that my configuration above is compatible with 2.6?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p315865">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">chris5560</div>
					<div class="post-datetime">
						20 Mar 2016, 20:59					</div>
				</div>
				<div class="post-content content">
					<p>Why do you not use ddns-scripts 2.4 provided with CC 15.05 ? But there should be no difference to 2.6.<br />The major difference between 1.0 and 2.x is that you can &quot;force_ipversion&quot; so in your OLD config you never FORCE to use IPv4 or IPv6 communication. You see in log &quot;BIND host error: &#039;1&#039;&quot;. So for whatever reason BIND has a problem with pure IPv4 communication in your environment.<br />You should remove &quot;force_ipversion&quot; or set to &quot;0&quot; in your configuration.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p315899">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">k4i</div>
					<div class="post-datetime">
						21 Mar 2016, 04:57					</div>
				</div>
				<div class="post-content content">
					<p>Sometimes you can resolve an address by nslookup when ddns scripts fail to do so, this can happen when dnsmasq is configured to bind to one specific address, that is, the router lan address 192.168.1.1. If that&#039;s your case, change the configuration adding one more address to bind: 127.0.0.1.</p><p>Good luck.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p315927">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">richard-laing</div>
					<div class="post-datetime">
						21 Mar 2016, 13:30					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>chris5560 wrote:</cite><blockquote><p>Why do you not use ddns-scripts 2.4 provided with CC 15.05 ? But there should be no difference to 2.6.<br />The major difference between 1.0 and 2.x is that you can &quot;force_ipversion&quot; so in your OLD config you never FORCE to use IPv4 or IPv6 communication. You see in log &quot;BIND host error: &#039;1&#039;&quot;. So for whatever reason BIND has a problem with pure IPv4 communication in your environment.<br />You should remove &quot;force_ipversion&quot; or set to &quot;0&quot; in your configuration.</p></blockquote></div><p>I tried this config with the default version and it failed to work this is why I updated into version 2.6 with no luck.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p315929">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">richard-laing</div>
					<div class="post-datetime">
						21 Mar 2016, 13:31					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>k4i wrote:</cite><blockquote><p>Sometimes you can resolve an address by nslookup when ddns scripts fail to do so, this can happen when dnsmasq is configured to bind to one specific address, that is, the router lan address 192.168.1.1. If that&#039;s your case, change the configuration adding one more address to bind: 127.0.0.1.</p><p>Good luck.</p></blockquote></div><p>I will look at the DNS settings and make sure both the real and the loop address are stated and post the results, thanks for the idea.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p315930">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">richard-laing</div>
					<div class="post-datetime">
						21 Mar 2016, 13:33					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>chris5560 wrote:</cite><blockquote><p>Why do you not use ddns-scripts 2.4 provided with CC 15.05 ? But there should be no difference to 2.6.<br />The major difference between 1.0 and 2.x is that you can &quot;force_ipversion&quot; so in your OLD config you never FORCE to use IPv4 or IPv6 communication. You see in log &quot;BIND host error: &#039;1&#039;&quot;. So for whatever reason BIND has a problem with pure IPv4 communication in your environment.<br />You should remove &quot;force_ipversion&quot; or set to &quot;0&quot; in your configuration.</p></blockquote></div><p>I added &quot;Force_ipversion&quot; into the configuration however even without that inside the same error still occurs, I will remove it once more and see what happens, also I not support IPV6 on my network at present.</p>											<p class="post-edited">(Last edited by <strong>richard-laing</strong> on 21 Mar 2016, 13:34)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p316012">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">chris5560</div>
					<div class="post-datetime">
						21 Mar 2016, 23:42					</div>
				</div>
				<div class="post-content content">
					<p>You have BIND host installed anyway, try to use &quot;option dns_server&quot; to force ddns-scripts (2.x) to use a specific DNS.<br />i.e. google-public-dns-a.google.com<br />This will ignore your local DNS.<br />Does this help ?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>