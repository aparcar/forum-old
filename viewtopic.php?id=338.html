<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Locked Router/Lost root password on wrt54gs</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 24 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p1599">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">opus</div>
					<div class="post-datetime">
						17 Aug 2004, 20:30					</div>
				</div>
				<div class="post-content content">
					<p>I have a OpenWRT install that for some reason won&#039;t respond to the root password that I set.&nbsp; &nbsp;It was setup with telnet disabled and SSH enabled.&nbsp; For some reason I can&#039;t figure out what happened to the root password.</p><p>Is there a way I can get into the box, or did I sucessfully turn this into a doorstop?</p><p>I tried resetting my router, including holding down the reset button while booting.&nbsp; I read in the documentation that this requires 5 seconds, however, a friend of mine saids 10 seconds.&nbsp; &nbsp;I have tried this for 5 seconds with no luck.&nbsp; Interesting enough, however, my SSID changed to &quot;linksys&quot; it still will not allow me to login.&nbsp; Is there any other way of totally resetting everything back to factory defaults, or, OpenWRT defaults?</p><p>Also, if this doesn&#039;t work and all else fails is there a way I can build a JTAG interface and reset the /etc/passwd file? Has anyone successfully done this or something like it?</p><p>Thanks for any help</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p1600">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">mbm</div>
					<div class="post-datetime">
						17 Aug 2004, 20:32					</div>
				</div>
				<div class="post-content content">
					<p>openwrt failsafe:<br />wait for the dmz light; hold reset for 2 seconds. telnet 192.168.1.1</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p14362">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">dl</div>
					<div class="post-datetime">
						27 Oct 2005, 09:29					</div>
				</div>
				<div class="post-content content">
					<p>I just had the same issue. SSH was working fine but root password suddenly doesn&#039;t work anymore. Went to failsafe but can&#039;t access from lan even after clearing arp cache. Managed to get in from wireless side (in failsafe) but when I re-enter the passwd I get an error updating passwd file. Mounted the jffs and still get the same error. Probably a simple solution but I&#039;m clueless here.</p><p>Router is functioning fine otherwise, I just wanted to make some admin changes and can&#039;t get in.</p><p>- DL</p>											<p class="post-edited">(Last edited by <strong>dl</strong> on 27 Oct 2005, 09:33)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p21064">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">emss</div>
					<div class="post-datetime">
						18 Feb 2006, 17:46					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><div class="quotebox"><cite>dl wrote:</cite><blockquote><p>I just had the same issue. SSH was working fine but root password suddenly doesn&#039;t work anymore. Went to failsafe but can&#039;t access from lan even after clearing arp cache. Managed to get in from wireless side (in failsafe) but when I re-enter the passwd I get an error updating passwd file. Mounted the jffs and still get the same error. Probably a simple solution but I&#039;m clueless here.</p></blockquote></div><p>Same problem here, I can reach the gs in failsafe mode but can&#039;t change the root password.</p><p>[edit]</p><p>Solved, mount_root worked flawlessly, then I used the password line mentionned at the end of this page :<br /><a href="http://rotz.org/archives/2005/03/openwrt_root_pa.html">http://rotz.org/archives/2005/03/openwrt_root_pa.html</a></p><p>After reboot, I was then able to log in and then upgrade to RC4</p><p>[/edit]</p><p>I&#039;ve tried available howtos to reset root password, but none has worked till now (the main problem is that I can&#039;t mount / read write to change /etc/passwd)<br />Is there any way to mount / rw or is it easier to upgrade to the lastest RC available ?</p><p>Some more information regarding the settings :</p><br /><p>BusyBox v1.00 (2005.07.14-12:13+0000) Built-in shell (ash)<br />Enter &#039;help&#039; for a list of built-in commands.</p><p>&nbsp; _______&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;________&nbsp; &nbsp; &nbsp; &nbsp; __<br /> |&nbsp; &nbsp; &nbsp; &nbsp;|.-----.-----.-----.|&nbsp; |&nbsp; |&nbsp; |.----.|&nbsp; |_<br /> |&nbsp; &nbsp;-&nbsp; &nbsp;||&nbsp; _&nbsp; |&nbsp; -__|&nbsp; &nbsp; &nbsp;||&nbsp; |&nbsp; |&nbsp; ||&nbsp; &nbsp;_||&nbsp; &nbsp;_|<br /> |_______||&nbsp; &nbsp;__|_____|__|__||________||__|&nbsp; |____|<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |__| W I R E L E S S&nbsp; &nbsp;F R E E D O M<br /> WHITE RUSSIAN (RC1) -------------------------------<br />&nbsp; * 2 oz Vodka&nbsp; &nbsp;Mix the Vodka and Kahlua together<br />&nbsp; * 1 oz Kahlua&nbsp; over ice, then float the cream or<br />&nbsp; * 1/2oz cream&nbsp; milk on the top.<br /> ---------------------------------------------------<br />root@OpenWrt:/# ps ax<br />&nbsp; PID&nbsp; Uid&nbsp; &nbsp; &nbsp;VmSize Stat Command<br />&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp; &nbsp; 392 S&nbsp; &nbsp;init<br />&nbsp; &nbsp; 2 root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SW&nbsp; [keventd]<br />&nbsp; &nbsp; 3 root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RWN [ksoftirqd_CPU0]<br />&nbsp; &nbsp; 4 root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SW&nbsp; [kswapd]<br />&nbsp; &nbsp; 5 root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SW&nbsp; [bdflush]<br />&nbsp; &nbsp; 6 root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SW&nbsp; [kupdated]<br />&nbsp; &nbsp; 7 root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SW&nbsp; [mtdblockd]<br />&nbsp; &nbsp;14 root&nbsp; &nbsp; &nbsp; &nbsp; 424 S&nbsp; &nbsp;/bin/sh /etc/preinit noinitrd<br />&nbsp; &nbsp;41 root&nbsp; &nbsp; &nbsp; &nbsp; 384 S&nbsp; &nbsp;syslogd -C 16<br />&nbsp; &nbsp;45 root&nbsp; &nbsp; &nbsp; &nbsp; 340 S&nbsp; &nbsp;klogd<br />&nbsp; &nbsp;50 root&nbsp; &nbsp; &nbsp; &nbsp; 392 S&nbsp; &nbsp;init<br />&nbsp; 752 nobody&nbsp; &nbsp; &nbsp; 432 S&nbsp; &nbsp;dnsmasq -l /tmp/dhcp.leases -K -F 192.168.1.100,192.1<br />&nbsp; 766 root&nbsp; &nbsp; &nbsp; &nbsp; 420 S&nbsp; &nbsp;/usr/sbin/dropbear<br />&nbsp; 767 root&nbsp; &nbsp; &nbsp; &nbsp; 388 S&nbsp; &nbsp;httpd -p 80 -h /www -r WRT54G Router<br />&nbsp; 829 root&nbsp; &nbsp; &nbsp; &nbsp; 324 S&nbsp; &nbsp;telnetd -l /bin/login<br /> 1004 root&nbsp; &nbsp; &nbsp; &nbsp; 472 S&nbsp; &nbsp;/bin/ash --login<br /> 1124 root&nbsp; &nbsp; &nbsp; &nbsp; 384 R&nbsp; &nbsp;ps ax<br />root@OpenWrt:/# mount<br />/dev/root on / type jffs2 (ro)<br />none on /dev type devfs (rw)<br />none on /proc type proc (rw)<br />none on /tmp type tmpfs (rw,nosuid,nodev)<br />none on /dev/pts type devpts (rw)<br />root@OpenWrt:/# ls -al /dev/mtd/*<br />crw-rw-rw-&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; 90,&nbsp; &nbsp;0 Jan&nbsp; 1&nbsp; 1970 /dev/mtd/0<br />cr--r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; 90,&nbsp; &nbsp;1 Jan&nbsp; 1&nbsp; 1970 /dev/mtd/0ro<br />crw-rw-rw-&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; 90,&nbsp; &nbsp;2 Jan&nbsp; 1&nbsp; 1970 /dev/mtd/1<br />cr--r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; 90,&nbsp; &nbsp;3 Jan&nbsp; 1&nbsp; 1970 /dev/mtd/1ro<br />crw-rw-rw-&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; 90,&nbsp; &nbsp;4 Jan&nbsp; 1&nbsp; 1970 /dev/mtd/2<br />cr--r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; 90,&nbsp; &nbsp;5 Jan&nbsp; 1&nbsp; 1970 /dev/mtd/2ro<br />crw-rw-rw-&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; 90,&nbsp; &nbsp;6 Jan&nbsp; 1&nbsp; 1970 /dev/mtd/3<br />cr--r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; 90,&nbsp; &nbsp;7 Jan&nbsp; 1&nbsp; 1970 /dev/mtd/3ro<br />root@OpenWrt:/# ls -al /dev/mtdblock/*<br />brw-rw-rw-&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; 31,&nbsp; &nbsp;0 Jan&nbsp; 1&nbsp; 1970 /dev/mtdblock/0<br />brw-rw-rw-&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; 31,&nbsp; &nbsp;1 Jan&nbsp; 1&nbsp; 1970 /dev/mtdblock/1<br />brw-rw-rw-&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; 31,&nbsp; &nbsp;2 Jan&nbsp; 1&nbsp; 1970 /dev/mtdblock/2<br />brw-rw-rw-&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; 31,&nbsp; &nbsp;3 Jan&nbsp; 1&nbsp; 1970 /dev/mtdblock/3<br />root@OpenWrt:/# ls -al<br />drwxr-xr-x&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 Jun 25&nbsp; 2005 .<br />drwxr-xr-x&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 Jun 25&nbsp; 2005 ..<br />drwxr-xr-x&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 Jul 16&nbsp; 2005 bin<br />drwxr-xr-x&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 Jan&nbsp; 1&nbsp; 1970 dev<br />drwxr-xr-x&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 Jan&nbsp; 1 00:03 etc<br />drwxr-xr-x&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 Jul 16&nbsp; 2005 lib<br />dr-xr-xr-x&nbsp; &nbsp;26 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 Jan&nbsp; 1 00:00 proc<br />drwxr-xr-x&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 Apr 20&nbsp; 2005 rom<br />drwxr-xr-x&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 Jul 16&nbsp; 2005 sbin<br />drwxrwxrwt&nbsp; &nbsp; 4 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 100 Jan&nbsp; 1 00:00 tmp<br />drwxr-xr-x&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 Jun 25&nbsp; 2005 usr<br />lrwxrwxrwx&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4 Jul 16&nbsp; 2005 var -&gt; /tmp<br />drwxr-xr-x&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 Feb&nbsp; 6&nbsp; 2005 www<br />root@OpenWrt:/#</p><p>Regards</p><p>Eric Masson</p>											<p class="post-edited">(Last edited by <strong>emss</strong> on 18 Feb 2006, 19:11)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p21068">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">wook</div>
					<div class="post-datetime">
						18 Feb 2006, 19:15					</div>
				</div>
				<div class="post-content content">
					<p>I had a similar problem until I realized my problem; I wasn&#039;t using the root user account with SSH.&nbsp; On a linux box, the command is: ssh -l root 192.168.1.1</p><p>Hope this helps</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p43357">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Chris_Jenks</div>
					<div class="post-datetime">
						27 Feb 2007, 18:58					</div>
				</div>
				<div class="post-content content">
					<p>I just updated two of my whiterussian WRT54G/S&#039;s after months without updates. Here are the updates on one of the boxes:</p><p>Upgrading base-files on root from 8 to 9...<br />Upgrading busybox on root from 1.00-3 to 1.00-5...<br />Upgrading dnsmasq on root from 2.27-1 to 2.35-1...<br />&nbsp; &nbsp; *** dnsmasq.conf (Y/I/N/O) [default=N] ? N<br />Upgrading kmod-brcm-wl on root from 2.4.30-brcm-3 to 2.4.30-brcm-5...<br />Upgrading kmod-diag on root from 2.4.30-brcm-3 to 2.4.30-brcm-5...<br />Upgrading kmod-ppp on root from 2.4.30-brcm-3 to 2.4.30-brcm-5...<br />Upgrading kmod-ppp on root from 2.4.30-brcm-3 to 2.4.30-brcm-5...<br />Upgrading kmod-pppoe on root from 2.4.30-brcm-3 to 2.4.30-brcm-5...<br />Upgrading kmod-wlcompat on root from 2.4.30-brcm-3 to 2.4.30-brcm-4...<br />Upgrading mtd on root from 4 to 5...<br />Upgrading uclibc on root from 0.9.27-8 to 0.9.27-9...<br />Installing libgcc (3.4.4-9) to root...</p><p>&nbsp; Fortunately I went on to play with the firewall, which prompted me to try shelling in with a second session rather than disconnecting my first session. That&#039;s when I found out that my root (and only) password on both routers no longer worked:</p><p>jenkster@earth:~/web/puzzle$ ssh root@75.36.158.117<br />root@75.36.158.117&#039;s password:<br />Permission denied, please try again.<br />root@75.36.158.117&#039;s password:</p><p>&nbsp; Since I still had sessions on both routers, I was able to successfully set the passwords back using passwd, and then ssh worked again. Nearly bricking the router is a stinky problem to have from merely updating.</p><p>&nbsp; Yours,</p><p>&nbsp; &nbsp; Chris</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p43378">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">Spynexes</div>
					<div class="post-datetime">
						27 Feb 2007, 22:57					</div>
				</div>
				<div class="post-content content">
					<p>Another idea is get a serial connection to your router. There should be some information where to find the serial connector on your board. <br />For my WL-500gP I found the information here: <a href="http://www.dd-wrt.com/phpBB2/viewtopic.php?p=42261">http://www.dd-wrt.com/phpBB2/viewtopic.php?p=42261</a></p><p>When you are using a serial console, you see all the boot messages of the device and you can login as root without a passwort. (just hit enter)</p><p>Worked for me but involves some hardware knowledge.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>