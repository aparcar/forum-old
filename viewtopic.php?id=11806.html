<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Asterisk blocks when no internet ...</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 17 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p52875">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">noelbou</div>
					<div class="post-datetime">
						26 Jul 2007, 20:30					</div>
				</div>
				<div class="post-content content">
					<p>Hello All,</p><p>I have a WRTSL54GS running OpenWrt &amp; asterisk 1.4.2 and after loosing internet connectivity (ISP problems) i realised that the * would not answer an outside call (from PSTN / FXO) or any call from any extension. I found that the CLI was displaying an expected error about my SIP VOIP account registration and was trying to register, got timeout and pause for 20 sec. and try again to register with the VoIP provider. </p><p>I found that * would only answer when doing that 20 sec. pause and as soon as it was trying to register it stopped replying ... <br />The CPU usage when registering was low ...&nbsp; but no answer ... The CLI seemed normal ... </p><p>This is quite annoying as i expected to be able to do normal calls to the other ext. and using the PSTN line when the Internet is down ... </p><p>Anyone has an idea on how this can be fixed ?<br />Should this be reported as a bug ? (Is it already known ?)<br />Tnx for any help ...</p><p>Noel</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p52943">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">noelbou</div>
					<div class="post-datetime">
						27 Jul 2007, 21:28					</div>
				</div>
				<div class="post-content content">
					<p>An update ...:</p><p>After some more testing ...<br />Actually if you disconnect the system from the wan ...<br />it get stuck like this on all DNS lookups and it seems to block eveything in all * processes ... It actually takes 4-5 mins before it finally gets to the &quot;Asterisk Ready&quot; prompt !!! (?)</p><p>As before it would answer an ext. only in the 20 sec. pause in between registration retries (which take &gt; 1 min to timeout) ...</p><p>Then i replace my sip registration domain name by the actual IP address and .. it now no longer &quot;blocks&quot; on the registration attempts ... which again indicate a DNS problem (DNS requests block everything when no WAN connections)</p><p>So this might not be an * problem at all but maybe a dnsmasq problem / bug (?)</p><p>Anyone know anything about this &quot;blocking&quot; on DNS request with no wan connection problem ?</p><p>Is there an alternative to dnsmasq (under WR 0.9) ?</p><p>Tnx</p><p>Noel</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>