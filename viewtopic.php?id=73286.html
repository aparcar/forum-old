<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Issue when installing customized  version of opkg</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 13 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p372316">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">sferjani</div>
					<div class="post-datetime">
						16 Feb 2018, 12:17					</div>
				</div>
				<div class="post-content content">
					<p>Dear all,</p><p>I have an issue with the default opkg version provided by openwrt Chaos Calmer r49404, when I try to update a package on the target, it doesn&#039;t download and install its dependencies. <br />So I tried to install a customized version, but I got an issue while building my rootfs image. The build of the opkg package seems to be good, logs below<br /></p><div class="codebox"><pre><code>install -d -m0755 /home/sferjani/SmartKey/openwrt.git/staging_dir/target-mipsel_24kec+dsp_glibc-2.21/root-ramips/tmp-opkg/usr/lib/opkg
install -d -m0755 /home/sferjani/SmartKey/openwrt.git/staging_dir/target-mipsel_24kec+dsp_glibc-2.21/root-ramips/tmp-opkg/bin
install -d -m0755 /home/sferjani/SmartKey/openwrt.git/staging_dir/target-mipsel_24kec+dsp_glibc-2.21/root-ramips/tmp-opkg/usr/bin
install -d -m0755 /home/sferjani/SmartKey/openwrt.git/staging_dir/target-mipsel_24kec+dsp_glibc-2.21/root-ramips/tmp-opkg/sbin
install -d -m0755 /home/sferjani/SmartKey/openwrt.git/staging_dir/target-mipsel_24kec+dsp_glibc-2.21/root-ramips/tmp-opkg/etc/opkg
install -d -m0755 /home/sferjani/SmartKey/openwrt.git/staging_dir/target-mipsel_24kec+dsp_glibc-2.21/root-ramips/tmp-opkg/etc/opkg/certs
cp -fpR ./files/opkg.conf /home/sferjani/SmartKey/openwrt.git/staging_dir/target-mipsel_24kec+dsp_glibc-2.21/root-ramips/tmp-opkg/etc/opkg/opkg.conf
cp -fpR ./files/arch.conf /home/sferjani/SmartKey/openwrt.git/staging_dir/target-mipsel_24kec+dsp_glibc-2.21/root-ramips/tmp-opkg/etc/opkg/arch.conf
cp -fpR ./files/trusted.gpg /home/sferjani/SmartKey/openwrt.git/staging_dir/target-mipsel_24kec+dsp_glibc-2.21/root-ramips/tmp-opkg/etc/opkg/trusted.gpg
cp -fpR ./files/root.ca /home/sferjani/SmartKey/openwrt.git/staging_dir/target-mipsel_24kec+dsp_glibc-2.21/root-ramips/tmp-opkg/etc/opkg/certs/root.ca
install -m0755 ./files/opkg-un.sh /home/sferjani/SmartKey/openwrt.git/staging_dir/target-mipsel_24kec+dsp_glibc-2.21/root-ramips/tmp-opkg/sbin/opkg-un.sh
install -m0755 ./files/opkg-urlkey.sh /home/sferjani/SmartKey/openwrt.git/staging_dir/target-mipsel_24kec+dsp_glibc-2.21/root-ramips/tmp-opkg/sbin/opkg-urlkey.sh
install -m0755 ./files/opkg-pwd.sh /home/sferjani/SmartKey/openwrt.git/staging_dir/target-mipsel_24kec+dsp_glibc-2.21/root-ramips/tmp-opkg/sbin/opkg-pwd.sh
install -m0755 /home/sferjani/SmartKey/openwrt.git/build_dir/target-mipsel_24kec+dsp_glibc-2.21/opkg-unsigned/opkg-0.1.8/ipkg-install/usr/bin/opkg-cl /home/sferjani/SmartKey/openwrt.git/staging_dir/target-mipsel_24kec+dsp_glibc-2.21/root-ramips/tmp-opkg/bin/opkg
install -m0755 /home/sferjani/SmartKey/openwrt.git/build_dir/target-mipsel_24kec+dsp_glibc-2.21/opkg-unsigned/opkg-0.1.8/ipkg-install/usr/bin/opkg-key /home/sferjani/SmartKey/openwrt.git/staging_dir/target-mipsel_24kec+dsp_glibc-2.21/root-ramips/tmp-opkg/usr/bin/
install -m0755 /home/sferjani/SmartKey/openwrt.git/build_dir/target-mipsel_24kec+dsp_glibc-2.21/opkg-unsigned/opkg-0.1.8/ipkg-install/usr/bin/update-alternatives /home/sferjani/SmartKey/openwrt.git/staging_dir/target-mipsel_24kec+dsp_glibc-2.21/root-ramips/tmp-opkg/usr/bin/
SHELL= /home/sferjani/SmartKey/openwrt.git/staging_dir/host/bin/flock /home/sferjani/SmartKey/openwrt.git/tmp/.root-copy.flock -c &#039;cp -fpR /home/sferjani/SmartKey/openwrt.git/staging_dir/target-mipsel_24kec+dsp_glibc-2.21/root-ramips/tmp-opkg/. /home/sferjani/SmartKey/openwrt.git/staging_dir/target-mipsel_24kec+dsp_glibc-2.21/root-ramips/&#039;
rm -rf /home/sferjani/SmartKey/openwrt.git/staging_dir/target-mipsel_24kec+dsp_glibc-2.21/root-ramips/tmp-opkg
touch /home/sferjani/SmartKey/openwrt.git/staging_dir/target-mipsel_24kec+dsp_glibc-2.21/root-ramips/stamp/.opkg_installed
if [ -f /home/sferjani/SmartKey/openwrt.git/staging_dir/target-mipsel_24kec+dsp_glibc-2.21/pkginfo/opkg.unsigned.install.clean ]; then rm -f /home/sferjani/SmartKey/openwrt.git/staging_dir/target-mipsel_24kec+dsp_glibc-2.21/pkginfo/opkg.unsigned.install /home/sferjani/SmartKey/openwrt.git/staging_dir/target-mipsel_24kec+dsp_glibc-2.21/pkginfo/opkg.unsigned.install.clean; fi; echo &quot;opkg&quot; &gt;&gt; /home/sferjani/SmartKey/openwrt.git/staging_dir/target-mipsel_24kec+dsp_glibc-2.21/pkginfo/opkg.unsigned.install
rm -rf /home/sferjani/SmartKey/openwrt.git/tmp/stage-opkg
mkdir -p /home/sferjani/SmartKey/openwrt.git/tmp/stage-opkg/host /home/sferjani/SmartKey/openwrt.git/staging_dir/target-mipsel_24kec+dsp_glibc-2.21/packages /home/sferjani/SmartKey/openwrt.git/staging_dir/host/packages
mkdir -p /home/sferjani/SmartKey/openwrt.git/tmp/stage-opkg/usr/include
cp -fpR /home/sferjani/SmartKey/openwrt.git/build_dir/target-mipsel_24kec+dsp_glibc-2.21/opkg-unsigned/opkg-0.1.8/ipkg-install/usr/include/libopkg /home/sferjani/SmartKey/openwrt.git/tmp/stage-opkg/usr/include/
install -d -m0755  /home/sferjani/SmartKey/openwrt.git/tmp/stage-opkg/usr/lib
cp -fpR /home/sferjani/SmartKey/openwrt.git/build_dir/target-mipsel_24kec+dsp_glibc-2.21/opkg-unsigned/opkg-0.1.8/ipkg-install/usr/lib/lib*.so* /home/sferjani/SmartKey/openwrt.git/tmp/stage-opkg/usr/lib
cp -fpR /home/sferjani/SmartKey/openwrt.git/build_dir/target-mipsel_24kec+dsp_glibc-2.21/opkg-unsigned/opkg-0.1.8/ipkg-install/usr/lib/lib*.{a,la} /home/sferjani/SmartKey/openwrt.git/tmp/stage-opkg/usr/lib
install -d -m0755 /home/sferjani/SmartKey/openwrt.git/tmp/stage-opkg/usr/lib/pkgconfig
cp -fpR /home/sferjani/SmartKey/openwrt.git/build_dir/target-mipsel_24kec+dsp_glibc-2.21/opkg-unsigned/opkg-0.1.8/ipkg-install/usr/lib/pkgconfig/* /home/sferjani/SmartKey/openwrt.git/tmp/stage-opkg/usr/lib/pkgconfig
find /home/sferjani/SmartKey/openwrt.git/tmp/stage-opkg -name &#039;*.la&#039; | xargs -r rm -f;       find /home/sferjani/SmartKey/openwrt.git/tmp/stage-opkg -name &#039;*.la&#039; | xargs -r rm -f; 
if [ -f /home/sferjani/SmartKey/openwrt.git/staging_dir/target-mipsel_24kec+dsp_glibc-2.21/packages/opkg.unsigned.list ]; then /home/sferjani/SmartKey/openwrt.git/scripts/clean-package.sh &quot;/home/sferjani/SmartKey/openwrt.git/staging_dir/target-mipsel_24kec+dsp_glibc-2.21/packages/opkg.unsigned.list&quot; &quot;/home/sferjani/SmartKey/openwrt.git/staging_dir/target-mipsel_24kec+dsp_glibc-2.21&quot;; fi
if [ -d /home/sferjani/SmartKey/openwrt.git/tmp/stage-opkg ]; then (cd /home/sferjani/SmartKey/openwrt.git/tmp/stage-opkg; find ./ &gt; /home/sferjani/SmartKey/openwrt.git/tmp/stage-opkg.files);     SHELL= /home/sferjani/SmartKey/openwrt.git/staging_dir/host/bin/flock /home/sferjani/SmartKey/openwrt.git/tmp/.staging-dir.flock -c &#039; mv /home/sferjani/SmartKey/openwrt.git/tmp/stage-opkg.files /home/sferjani/SmartKey/openwrt.git/staging_dir/target-mipsel_24kec+dsp_glibc-2.21/packages/opkg.unsigned.list &amp;&amp; cp -fpR /home/sferjani/SmartKey/openwrt.git/tmp/stage-opkg/* /home/sferjani/SmartKey/openwrt.git/staging_dir/target-mipsel_24kec+dsp_glibc-2.21/; &#039;; fi
rm -rf /home/sferjani/SmartKey/openwrt.git/tmp/stage-opkg
touch /home/sferjani/SmartKey/openwrt.git/staging_dir/target-mipsel_24kec+dsp_glibc-2.21/stamp/.opkg.unsigned_installed
make[3]: Leaving directory `/home/sferjani/SmartKey/openwrt.git/package/system/opkg&#039;</code></pre></div><p> </p><p>but later I got this error :</p><div class="codebox"><pre><code> 
make[2]: Entering directory `/home/sferjani/SmartKey/openwrt.git&#039;
find /home/sferjani/SmartKey/openwrt.git/staging_dir/target-mipsel_24kec+dsp_glibc-2.21/root-ramips -type d | xargs -r chmod 0755
rm -rf /home/sferjani/SmartKey/openwrt.git/build_dir/target-mipsel_24kec+dsp_glibc-2.21/root-ramips
[ -d /home/sferjani/SmartKey/openwrt.git/build_dir/target-mipsel_24kec+dsp_glibc-2.21/root-ramips/tmp ] || mkdir -p /home/sferjani/SmartKey/openwrt.git/build_dir/target-mipsel_24kec+dsp_glibc-2.21/root-ramips/tmp
/home/sferjani/SmartKey/openwrt.git/staging_dir/host/bin/.libs/lt-opkg-cl: error while loading shared libraries: libopkg.so.0: cannot open shared object file: No such file or directory
make[2]: *** [package/install] Error 127
make[2]: Leaving directory `/home/sferjani/SmartKey/openwrt.git&#039;
make[1]: *** [/home/sferjani/SmartKey/openwrt.git/staging_dir/target-mipsel_24kec+dsp_glibc-2.21/stamp/.package_install] Error 2
make[1]: Leaving directory `/home/sferjani/SmartKey/openwrt.git&#039;
make: *** [world] Error 2</code></pre></div><p> </p><p>Can somebody&nbsp; give me some hint to fix this issue ?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>