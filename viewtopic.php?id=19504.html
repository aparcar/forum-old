<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Linksys WAP54G v2 - internet sharing w/o additional router</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 12 Feb 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p84450">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Galamb</div>
					<div class="post-datetime">
						24 Mar 2009, 12:29					</div>
				</div>
				<div class="post-content content">
					<p>Dear Professionals,</p><p>Recently I received a WAP54G v2 device, I successfully flashed with WhiteRussian 0.9 micro (it&#039;s only 2Mb flash so AFAIK it&#039;s my only option). My goal is the following:</p><p>1. Plug LAN port to a cable modem, receive public internet IP via DHCP, so it will be directly connected to Internet.<br />2. Use WIFI as LAN network, provide DHCP to wifi clients and do the routing &amp; firewalling.<br />Note: No, I do not have any wired or wireless routers so I want to use the AP + smart OpenWRT linux to achieve routing also. And no, I do not want to buy a small 4-port wired router because I really want to do all the things with WAP54G device.</p><p>Honestly I&#039;m a bit mixed up because 99% of the documentation refers to WRT54G-series and those are different. I&#039;d like to be extra careful, seeing so much people bricked his/her device... but after 3 days of reading I&#039;m more ambiguous than before - I really need some fundamentals. What I think I understand already:</p><p>1. I saw from dmesg that eth1 is the WIFI, eth0 is LAN.<br />2. There is a br0 interface, bridging eth0 &amp; eth1 together. From nvram settings:<br />&nbsp; &nbsp; &nbsp;lan_ifname=br0<br />&nbsp; &nbsp; &nbsp;lan_ifnames=eth0 eth1</p><p>3. There is a wan interface, with many nvram settings. It seems it served as connection to LAN side when the Linksys official firmware was active (I&#039;m not sure about that but I can see nvram settings like &quot;wan_desc=Default connection&quot; so it seems these were the factory defaults.) I also can see that wlan_device=vlan1</p><p>4. About the different vlans: I understand that there is vlan0 &amp; vlan1. The vlan0 consists &quot;1 2 3 4 5*&quot; while vlan1 is &quot;0 5&quot;. Of course in the WAP54G there is no such LAN ports 1 2 3 4 since it is just a humble AP. I&#039;m not sure I should do anything with these vlans at all.</p><br /><p>I thought it is enough to separate WIFI and LAN interfaces, so I&#039;ve done some changes:</p><div class="codebox"><pre><code>lan_ifname=eth0
nvram set lan_ifnames=eth0
nvram set lan_proto=dhcpclient
nvram set lan_hwaddr=aa:bb:cc:dd:ee (I needed to clone for internet connection working)
nvram set wl0_proto=static
nvram set wl0_ifname=eth1
nvram set wl0_ipaddr=192.168.0.1
nvram set wl0_netmask=255.255.255.0
nvram commit</code></pre></div><p>&quot;Certainly&quot; after rebooting I could not reach the device, nor getting IP address from wifi but after a half day of struggling I could restore the original status.</p><p>So what did I wrong? I&#039;m really not sure which one is to configure: WAN or LAN interface? This is much confusing. Could you help me, please?</p><p>Is my original plan feasible at all? If you have examples for that please don&#039;t hesitate to answer... :-)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p84805">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Galamb</div>
					<div class="post-datetime">
						28 Mar 2009, 17:22					</div>
				</div>
				<div class="post-content content">
					<p>Hi All,</p><p>I didn&#039;t expect too much since it is not the developers&#039; focus but you guys are beyond my expectations... :-) I was waiting at least for one question or two.<br />Well, I&#039;m still having only 2Mb so Kamikaze is not an option for me. Thank you for listening... :-(</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>