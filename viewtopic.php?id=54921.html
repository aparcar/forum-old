<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> MBIM with Sierra Wirless EM7345 Problem</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 26 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p259860">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">peterg</div>
					<div class="post-datetime">
						4 Jan 2015, 16:29					</div>
				</div>
				<div class="post-content content">
					<p>I have a problem to get a Sierra Wirless EM7345 LTE modem running using the mbim driver on OpenWRT.</p><p>Modem: Sierra Wirless EM7345<br />System: Ralink RT5350 based (<a href="http://vocore.io/">http://vocore.io/</a>)<br />OpenWRT built from GIT with mbim support and umbim util (built 43730)</p><p>I get the following error/msgs when trying to connect:</p><p>Fri Jan&nbsp; 2 08:11:10 2015 daemon.notice netifd: Interface &#039;wwan&#039; is setting up now<br />Fri Jan&nbsp; 2 08:11:10 2015 daemon.notice netifd: wwan (2210): wwan[2210] Using proto:wwan device:/dev/cdc-wdm0 iface:wwan0 desc:<br />Fri Jan&nbsp; 2 08:11:10 2015 daemon.notice netifd: wwan (2210): mbim[2210] Reading capabilities<br />Fri Jan&nbsp; 2 08:11:10 2015 daemon.notice netifd: wwan (2210):&nbsp; &nbsp;devicetype: 0001 - embedded<br />Fri Jan&nbsp; 2 08:11:10 2015 daemon.notice netifd: wwan (2210):&nbsp; &nbsp;cellularclass: 0001<br />Fri Jan&nbsp; 2 08:11:10 2015 daemon.notice netifd: wwan (2210):&nbsp; &nbsp;voiceclass: 0001 - no-voice<br />Fri Jan&nbsp; 2 08:11:10 2015 daemon.notice netifd: wwan (2210):&nbsp; &nbsp;simclass: 0002<br />Fri Jan&nbsp; 2 08:11:10 2015 daemon.notice netifd: wwan (2210):&nbsp; &nbsp;dataclass: 003F<br />Fri Jan&nbsp; 2 08:11:10 2015 daemon.notice netifd: wwan (2210):&nbsp; &nbsp;smscaps: 0003<br />Fri Jan&nbsp; 2 08:11:10 2015 daemon.notice netifd: wwan (2210):&nbsp; &nbsp;controlcaps: 0001<br />Fri Jan&nbsp; 2 08:11:10 2015 daemon.notice netifd: wwan (2210):&nbsp; &nbsp;maxsessions: 0008<br />Fri Jan&nbsp; 2 08:11:10 2015 daemon.notice netifd: wwan (2210):&nbsp; &nbsp;deviceid: 013937000093169<br />Fri Jan&nbsp; 2 08:11:10 2015 daemon.notice netifd: wwan (2210):&nbsp; &nbsp;firmwareinfo: FIH7160_V1.1_MODEM_01.1349.12<br />Fri Jan&nbsp; 2 08:11:10 2015 daemon.notice netifd: wwan (2210):&nbsp; &nbsp;hardwareinfo: XMM7160_V1.1_MBIM_GNSS_NAND_RE<br />Fri Jan&nbsp; 2 08:11:10 2015 daemon.notice netifd: wwan (2210): mbim[2210] Checking pin<br />Fri Jan&nbsp; 2 08:11:10 2015 daemon.notice netifd: wwan (2210): Pin Unlocked<br />Fri Jan&nbsp; 2 08:11:10 2015 daemon.notice netifd: wwan (2210): mbim[2210] Checking subscriber<br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: wwan (2210):&nbsp; &nbsp;readystate: 0001 - initialized<br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: wwan (2210):&nbsp; &nbsp;simiccid: 89852445672231366837<br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: wwan (2210):&nbsp; &nbsp;subscriberid: 454061114094683<br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: wwan (2210): mbim[2210] Register with network<br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: wwan (2210):&nbsp; &nbsp;nwerror: 0000 - unknown<br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: wwan (2210):&nbsp; &nbsp;registerstate: 0003 - home<br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: wwan (2210):&nbsp; &nbsp;registermode: 0001 - automatic<br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: wwan (2210):&nbsp; &nbsp;availabledataclasses: 0020 - lte<br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: wwan (2210):&nbsp; &nbsp;currentcellularclass: 0001 - gsm<br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: wwan (2210):&nbsp; &nbsp;provider_id: 45406<br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: wwan (2210):&nbsp; &nbsp;provider_name: SmarTone HK<br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: wwan (2210):&nbsp; &nbsp;roamingtext: (null)<br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: wwan (2210): mbim[2210] Attach to network<br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: wwan (2210):&nbsp; &nbsp;nwerror: 0000 - unknown<br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: wwan (2210):&nbsp; &nbsp;packetservicestate: 0002 - attached<br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: wwan (2210):&nbsp; &nbsp;uplinkspeed: 50000000<br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: wwan (2210):&nbsp; &nbsp;downlinkspeed: 100000000<br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: wwan (2210): mbim[2210] Connect to network<br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: wwan (2210):&nbsp; &nbsp;sessionid: 0<br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: wwan (2210):&nbsp; &nbsp;activationstate: 0001 - activated<br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: wwan (2210):&nbsp; &nbsp;voicecallstate: 0000 - none<br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: wwan (2210):&nbsp; &nbsp;nwerror: 0000 - unknown<br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: wwan (2210):&nbsp; &nbsp;iptype: 0001 - ipv4<br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: wwan (2210): mbim[2210] Connected, starting DHCP<br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: Interface &#039;wwan&#039; is now up<br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: Network device &#039;wwan0&#039; link is up<br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: Network alias &#039;wwan0&#039; link is up<br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: Interface &#039;wwan_dhcp&#039; is enabled<br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: Interface &#039;wwan_dhcp&#039; has link connectivity <br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: Interface &#039;wwan_dhcp&#039; is setting up now<br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: wwan (2210): Command failed: Unknown error<br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: Interface &#039;wwan_dhcpv6&#039; is enabled<br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: Interface &#039;wwan_dhcpv6&#039; has link connectivity <br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: Interface &#039;wwan_dhcpv6&#039; is setting up now<br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: wwan (2210): Command failed: Unknown error<br />Fri Jan&nbsp; 2 08:11:11 2015 daemon.notice netifd: wwan_dhcp (2271): udhcpc (v1.22.1) started<br />Fri Jan&nbsp; 2 08:11:12 2015 user.notice firewall: Reloading firewall due to ifup of wwan (wwan0)<br />Fri Jan&nbsp; 2 08:11:12 2015 daemon.notice netifd: wwan_dhcp (2271): Sending discover...<br />Fri Jan&nbsp; 2 08:11:15 2015 daemon.notice netifd: wwan_dhcp (2271): Sending discover...<br />Fri Jan&nbsp; 2 08:11:18 2015 daemon.notice netifd: wwan_dhcp (2271): Sending discover...<br />Fri Jan&nbsp; 2 08:13:54 2015 daemon.notice netifd: wwan_dhcp (2271): Received SIGTERM</p><p>When using the modem / sim card on a Ubuntu 14.04 system with modemmanager it works out of the box.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p260055">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">peterg</div>
					<div class="post-datetime">
						5 Jan 2015, 14:41					</div>
				</div>
				<div class="post-content content">
					<p>on further research it seems that the EM7345 does not have an integrated DHCP server and I would need to get the IP configuration via MBIM and set it up manually. </p><p>The problem: I used the uci configuration (proto wwan) to trigger mbim setup but don&#039;t know how to do it manually.<br />The &quot;umbim&quot; command is no documented and a simple &quot;umbim -d /dev/cdc-wdc0 connect&quot; won&#039;t work. <br />Is &#039;ifup wwan&#039; just calling the umbim command and I just know the correct commands or does it directly interact with libmbim?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p261225">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">peterg</div>
					<div class="post-datetime">
						13 Jan 2015, 09:51					</div>
				</div>
				<div class="post-content content">
					<p>Does anyone have a similar problem even with other MBIM modems, if not that particular one?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>