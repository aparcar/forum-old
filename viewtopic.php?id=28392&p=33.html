<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Build for WNDR3700/WNDR3800</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 9 Jul 2013 and 6 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 33 of 63</div><nav><ul><li><a href="viewtopic.php%3Fid=28392&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=28392&amp;p=31.html">31</a></li><li><a href="viewtopic.php%3Fid=28392&amp;p=32.html">32</a></li><li class="pagination-current"><span>33</span></li><li><a href="viewtopic.php%3Fid=28392&amp;p=34.html">34</a></li><li><a href="viewtopic.php%3Fid=28392&amp;p=35.html">35</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=28392&amp;p=63.html">63</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
						<div class="notice">
				<p>Sorry, posts 801 to 806 are missing from our archive.</p>
			</div>
		
		
		
			<article class="post" id="p220210">
				<div class="post-metadata">
					<div class="post-num">Post #807</div>
					<div class="post-author">beatmag</div>
					<div class="post-datetime">
						17 Dec 2013, 14:57					</div>
				</div>
				<div class="post-content content">
					<p>Thanks jow!!!!!!!!!! and hnyman.<br/>Will try tomorrow hopefully. Will report back in the bug 13781 and also here <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile"/><br/>thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p220339">
				<div class="post-metadata">
					<div class="post-num">Post #808</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						18 Dec 2013, 20:11					</div>
				</div>
				<div class="post-content content">
					<p>In the new 39132 build I have added a few busybox config options back to menuconfig, from which they were removed by devs in 39106. Users of the firmware should see no difference, but if somebody is building a private build and need additional options, you might take a look at the busybox config file. (package/utils/busybox/Config.in)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p220340">
				<div class="post-metadata">
					<div class="post-num">Post #809</div>
					<div class="post-author">burning daylight</div>
					<div class="post-datetime">
						18 Dec 2013, 20:15					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m trying to install kmod-bridge package, which does not work <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad"/><br/></p><div class="codebox"><pre><code>Installing kmod-bridge (3.3.8-1) to root...
Downloading http://downloads.openwrt.org/attitude_adjustment/12.09/ar71xx/generic/packages/kmod-bridge_3.3.8-1_ar71xx.ipk.

Collected errors:
 * satisfy_dependencies_for: Cannot satisfy the following dependencies for kmod-bridge:
 *     kernel (= 3.3.8-1-d6597ebf6203328d3519ea3c3371a493) *     kernel (= 3.3.8-1-d6597ebf6203328d3519ea3c3371a493) *     kernel (= 3.3.8-1-d6597ebf6203328d3519ea3c3371a493) * 
 * opkg_install_cmd: Cannot install package kmod-bridge.</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p220343">
				<div class="post-metadata">
					<div class="post-num">Post #810</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						18 Dec 2013, 20:29					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>burning daylight wrote:</cite><blockquote><p>I&#039;m trying to install kmod-bridge package, which does not work <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad"/></p></blockquote></div><p>There is a kernel module checksum validation. Trying to install add-on modules from repository to private builds will practically always produce an error. </p><p>You can use opkg option &quot;force-depends&quot;, but the router may get bricked, if the module is incompatible.<br/><a href="http://wiki.openwrt.org/doc/techref/opkg#options">http://wiki.openwrt.org/doc/techref/opkg#options</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p220345">
				<div class="post-metadata">
					<div class="post-num">Post #811</div>
					<div class="post-author">burning daylight</div>
					<div class="post-datetime">
						18 Dec 2013, 20:48					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>hnyman wrote:</cite><blockquote><p>You can use opkg option &quot;force-depends&quot;, but the router may get bricked, if the module is incompatible.</p></blockquote></div><div class="quotebox"><cite>hnyman wrote:</cite><blockquote><p>Note: As I have been building my version with standard kernel options, the Attitude Adjustment 12.09 and trunk snapshot modules should be compatible with my builds, in case somebody wishes to add modules to my build.</p></blockquote></div><p>Thanks!<br/>Does this mean, that chases to brick router are in fact very low? If I brick it, is it _completely_ bricked or I will be able to re-flash it again?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p220347">
				<div class="post-metadata">
					<div class="post-num">Post #812</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						18 Dec 2013, 21:10					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>burning daylight wrote:</cite><blockquote><p>Does this mean, that chases to brick router are in fact very low? If I brick it, is it _completely_ bricked or I will be able to re-flash it again?</p></blockquote></div><p>Yes, the risk is really low.<br/>And yes, WNDR3700 family has a good built-in recovery mode in the bootloader, so even if Openwrt itself would not work, you can always reflash it using the TFTP method. I have done that dozen times in the past 3 years. Wiki has good advice: <a href="http://wiki.openwrt.org/toh/netgear/wndr3700#recovery.flash.in.failsafe.mode">http://wiki.openwrt.org/toh/netgear/wndr3700#recovery.flash.in.failsafe.mode</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p220376">
				<div class="post-metadata">
					<div class="post-num">Post #813</div>
					<div class="post-author">beatmag</div>
					<div class="post-datetime">
						19 Dec 2013, 03:36					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>hnyman wrote:</cite><blockquote><p>I have uploaded r39101 with dnsmasq fixes made by jow.</p></blockquote></div><p>Thankyou jow and hnyman.</p><p>This has fixed the DHCP issues with UCI and my guest network not getting a DHCP Range.<br/>Thankyou so much!!!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p220396">
				<div class="post-metadata">
					<div class="post-num">Post #814</div>
					<div class="post-author">beatmag</div>
					<div class="post-datetime">
						19 Dec 2013, 11:53					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve got 1024kb set in my syslog size.<br/>But I&#039;m only getting a few pages out of it .............strange.....</p><p>searching to see if i can fix it.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p220397">
				<div class="post-metadata">
					<div class="post-num">Post #815</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						19 Dec 2013, 13:00					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>beatmag wrote:</cite><blockquote><p>I&#039;ve got 1024kb set in my syslog size.<br/>But I&#039;m only getting a few pages out of it .............strange.....</p><p>searching to see if i can fix it.</p></blockquote></div><p>You can&#039;t. As far as I know, the option has currently no impact...<br/>Devs have hardcode the log size to 16 kB, but I have doubled it to 32 kB. Larger than that seems to cause trouble. See <a href="https://dev.openwrt.org/ticket/14227">https://dev.openwrt.org/ticket/14227</a></p>											<p class="post-edited">(Last edited by <strong>hnyman</strong> on 19 Dec 2013, 13:00)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p220404">
				<div class="post-metadata">
					<div class="post-num">Post #816</div>
					<div class="post-author">beatmag</div>
					<div class="post-datetime">
						19 Dec 2013, 14:37					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>hnyman wrote:</cite><blockquote><div class="quotebox"><cite>beatmag wrote:</cite><blockquote><p>I&#039;ve got 1024kb set in my syslog size.<br/>But I&#039;m only getting a few pages out of it .............strange.....</p><p>searching to see if i can fix it.</p></blockquote></div><p>You can&#039;t. As far as I know, the option has currently no impact...<br/>Devs have hardcode the log size to 16 kB, but I have doubled it to 32 kB. Larger than that seems to cause trouble. See <a href="https://dev.openwrt.org/ticket/14227">https://dev.openwrt.org/ticket/14227</a></p></blockquote></div><p>oh what a strange bug.<br/>thanks for the info.<br/>i will keep an eye on the bug.</p><p>in terms of wifi stability and performance.......... would barrier breaker current build be alot better than attitude adjustment?</p><p>did you create a tool or script that just writes straight to the log to watch it blow up quicker?<br/>i might try that see if i can find anything.</p>											<p class="post-edited">(Last edited by <strong>beatmag</strong> on 19 Dec 2013, 14:43)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p220410">
				<div class="post-metadata">
					<div class="post-num">Post #817</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						19 Dec 2013, 15:34					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>beatmag wrote:</cite><blockquote><p>did you create a tool or script that just writes straight to the log to watch it blow up quicker?<br/>i might try that see if i can find anything.</p></blockquote></div><p>I am not sure if &quot;writing to log&quot; is the problem, or if the &quot;logread&quot; code is the problem. (logread may hang, but &quot;logread -l&quot; may work at the same time, as I wrote to the bug comments.) </p><p>In any case, the hardcoded log size in my build is now 32 kB, and if you want a larger one, you have to compile it by yourself.</p><p>Wifi in BB trunk has seen lots of improvements compared to AA.</p>											<p class="post-edited">(Last edited by <strong>hnyman</strong> on 19 Dec 2013, 15:35)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p220535">
				<div class="post-metadata">
					<div class="post-num">Post #818</div>
					<div class="post-author">Manp</div>
					<div class="post-datetime">
						21 Dec 2013, 15:14					</div>
				</div>
				<div class="post-content content">
					<p>i&#039;m having another strange problem with Barrier Breaker r39101, if i set wireless security to WEP-Shared Key i&#039;m completely unable to connect to the wireless network. i tried multiple devices and they all trow similar errors. basically the wireless network is seen as unprotected, and the client don&#039;t ask for a password but just says it&#039;s impossible to connect.</p><p>once i switch to wpa2 i&#039;m able to connect just fine. if i switch back to WEP-Shared Key it stops connecting.</p><p>i tried both with only one ssid with WEP-Shared Key security and with multiple ssid one with WPA2 and one with WEP-Shared Key on radio0 and the one with WEP-Shared Key security always fails to connect.</p><p>not sure what to think, it used to work just fine (i used the WEP-Shared Key protected SSID to connect the Nintendo DS)</p><p>EDIT:<br/>this config:</p><p>/etc/config/wireless<br/></p><div class="codebox"><pre><code>config wifi-iface
    option device &#039;radio0&#039;
    option mode &#039;ap&#039;
    option network &#039;guest&#039;
    option ssid &#039;guest&#039;
    option encryption &#039;wep-shared&#039;
    option key &#039;1&#039;
    option key1 &#039;s:pocasicurezza&#039;</code></pre></div><p>generates this:<br/>/var/run/hostapd-phy0.conf<br/></p><div class="codebox"><pre><code>interface=wlan0
ctrl_interface=/var/run/hostapd
disassoc_low_ack=1
preamble=1
wmm_enabled=1
ignore_broadcast_ssid=0
wep_default_key=
auth_algs=2
wpa=0
ssid=guest
bssid=c4:3d:c7:97:79:45</code></pre></div><p>looks like there&#039;s something wrong to me. wep_default_key= should, i guess, contain my wep key, instead it&#039;s empty.</p><br/><p>EDIT2:<br/>everyting works fine on Attitude r39137</p><p>config gets generated with the right wep key</p><p>/var/run/hostapd-phy0.conf<br/></p><div class="codebox"><pre><code>interface=wlan0
ctrl_interface=/var/run/hostapd-phy0
disassoc_low_ack=1
preamble=1
wep_key0=706f63617369637572657a7a61
wep_default_key=0
auth_algs=2
wpa=0
ssid=OpenWrt
bridge=br-lan
wmm_enabled=1
bssid=c4:3d:c7:97:79:45
ignore_broadcast_ssid=0</code></pre></div>											<p class="post-edited">(Last edited by <strong>Manp</strong> on 21 Dec 2013, 17:17)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p220605">
				<div class="post-metadata">
					<div class="post-num">Post #819</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						22 Dec 2013, 11:05					</div>
				</div>
				<div class="post-content content">
					<p>Some kmod kernel module related errors seem to have popped by due to 39118, but they are most likely harmless log spam caused by qos-scripts. See <a href="https://dev.openwrt.org/ticket/14659">https://dev.openwrt.org/ticket/14659</a></p><p>Additionally, I lost clients&#039; ipv6 functionality with 39154, but it works again with 39155. As I see that check-in having no relevance for wired ipv6, I guess there may be some error condition that may occasionally materialise and may cause 6relayd to get killed.&nbsp; See <a href="https://dev.openwrt.org/ticket/14658">https://dev.openwrt.org/ticket/14658</a></p><p>@Manp:<br/>Like said earlier, my build has the standard wifi components, so there should be nothing build-specific. If there are WEP related errors, you might file a bug about them. (Comparing to Attitude does not help much as that has so old wifi code. You should try to see what is the newest trunk build where it still worked, so that a regression window could be defined.) </p><p>EDIT: apparently there really is a WEP bug due to new netifd/wifi integration and a patch has been proposed: <a href="https://lists.openwrt.org/pipermail/openwrt-devel/2013-December/023034.html">https://lists.openwrt.org/pipermail/openwrt-devel/2013-December/023034.html</a></p>											<p class="post-edited">(Last edited by <strong>hnyman</strong> on 22 Dec 2013, 14:16)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p220624">
				<div class="post-metadata">
					<div class="post-num">Post #820</div>
					<div class="post-author">Manp</div>
					<div class="post-datetime">
						22 Dec 2013, 16:53					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>hnyman wrote:</cite><blockquote><p>@Manp:<br/>Like said earlier, my build has the standard wifi components, so there should be nothing build-specific. If there are WEP related errors, you might file a bug about them. (Comparing to Attitude does not help much as that has so old wifi code. You should try to see what is the newest trunk build where it still worked, so that a regression window could be defined.) </p><p>EDIT: apparently there really is a WEP bug due to new netifd/wifi integration and a patch has been proposed: <a href="https://lists.openwrt.org/pipermail/openwrt-devel/2013-December/023034.html">https://lists.openwrt.org/pipermail/openwrt-devel/2013-December/023034.html</a></p></blockquote></div><p>i was looking for someone who could confirm it was a bug, since i was unable to find anyone else with the same problem. which you actually did <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile"/></p><p>now, can you implement that patch in your build or should we wait until it&#039;s added to trunk?</p><p>as always thanks for the answer btw <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile"/></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p220628">
				<div class="post-metadata">
					<div class="post-num">Post #821</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						22 Dec 2013, 17:19					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Manp wrote:</cite><blockquote><p>now, can you implement that patch in your build or should we wait until it&#039;s added to trunk?</p></blockquote></div><p>I might add it to my build if you first test that it works for you.<br/>In the live system the file to be edited is &quot;/lib/netifd/hostapd.sh&quot;. 4 lines need to be edited in it. You might edit it by hand, as it is just a shell script...</p><p>However, I have made a patched copy of the script and stored in the WEP-patch folder at Dropbox. Direct link: <a href="https://db.tt/yW9gbFm6">https://db.tt/yW9gbFm6</a><br/>Replace /lib/netifd/hostapd.sh with that and try WEP again.&nbsp; (The original /lib/netifd/hostapd.sh will always be available in your system as /rom/lib/netifd/hostapd.sh in case you want to revert to it.)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p220651">
				<div class="post-metadata">
					<div class="post-num">Post #822</div>
					<div class="post-author">Manp</div>
					<div class="post-datetime">
						22 Dec 2013, 19:30					</div>
				</div>
				<div class="post-content content">
					<p>seems to work, but only if the WEP protected SSID comes before the other WPA SSIDs inside the configuration file.<br/>as in wlan0=wep and wlan0-1=wpa.</p><p>if for whatever reason (editing the config file or from luci) i set wlan0=wpa and wlan0-1=wep i get this in system log:</p><div class="codebox"><pre><code>Sat Dec 21 23:21:41 2013 daemon.notice netifd: radio0 (11600): Configuration file: /var/run/hostapd-phy0.conf
Sat Dec 21 23:21:41 2013 daemon.notice netifd: radio0 (11600): Using interface wlan0 with hwaddr c4:3d:c7:97:79:45 and ssid &quot;MelaG&quot;
Sat Dec 21 23:21:41 2013 daemon.notice netifd: radio0 (11600): Could not set WEP encryption.
Sat Dec 21 23:21:41 2013 daemon.notice netifd: radio0 (11600): Interface initialization failed
Sat Dec 21 23:21:41 2013 daemon.notice netifd: radio0 (11600): wlan0: Unable to setup interface.
Sat Dec 21 23:21:41 2013 daemon.notice netifd: radio0 (11600): Device setup failed: HOSTAPD_START_FAILED</code></pre></div><p>just to be more clear, this configuration:</p><div class="codebox"><pre><code>config wifi-device &#039;radio0&#039;
    option type &#039;mac80211&#039;
    option macaddr &#039;c4:3d:c7:97:79:45&#039;
    option hwmode &#039;11ng&#039;
    list ht_capab &#039;SHORT-GI-40&#039;
    list ht_capab &#039;TX-STBC&#039;
    list ht_capab &#039;RX-STBC1&#039;
    list ht_capab &#039;DSSS_CCK-40&#039;
    option htmode &#039;HT40-&#039;
    option country &#039;IT&#039;
    option channel &#039;6&#039;
    option txpower &#039;20&#039;

config wifi-iface
    option device &#039;radio0&#039;
    option mode &#039;ap&#039;
    option ssid &#039;MelaBacata&#039;
    option network &#039;guest&#039;
    option hidden &#039;1&#039;
    option encryption &#039;wep-shared&#039;
    option key &#039;1&#039;
    option key1 &#039;s:pocasicurezza&#039;

config wifi-iface
    option device &#039;radio0&#039;
    option network &#039;lan&#039;
    option mode &#039;ap&#039;
    option ssid &#039;wpassid&#039;
    option encryption &#039;psk2&#039;
    option key &#039;mykeyhere&#039;
    option wps_pushbutton &#039;1&#039;
    option wps_pin &#039;mypinhere&#039;</code></pre></div><p>works just fine, while this one:</p><div class="codebox"><pre><code>config wifi-device &#039;radio0&#039;
    option type &#039;mac80211&#039;
    option macaddr &#039;c4:3d:c7:97:79:45&#039;
    option hwmode &#039;11ng&#039;
    list ht_capab &#039;SHORT-GI-40&#039;
    list ht_capab &#039;TX-STBC&#039;
    list ht_capab &#039;RX-STBC1&#039;
    list ht_capab &#039;DSSS_CCK-40&#039;
    option htmode &#039;HT40-&#039;
    option country &#039;IT&#039;
    option channel &#039;6&#039;
    option txpower &#039;20&#039;

config wifi-iface
    option device &#039;radio0&#039;
    option network &#039;lan&#039;
    option mode &#039;ap&#039;
    option ssid &#039;wpassid&#039;
    option encryption &#039;psk2&#039;
    option key &#039;mykeyhere&#039;
    option wps_pushbutton &#039;1&#039;
    option wps_pin &#039;mypinhere&#039;

config wifi-iface
    option device &#039;radio0&#039;
    option mode &#039;ap&#039;
    option ssid &#039;MelaBacata&#039;
    option network &#039;guest&#039;
    option hidden &#039;1&#039;
    option encryption &#039;wep-shared&#039;
    option key &#039;1&#039;
    option key1 &#039;s:pocasicurezza&#039;</code></pre></div><p>always fails to bring up any wireless interface on radio0.</p><p>also, this problem doesn&#039;t seem to be related to the script since the hostapd-phy0.conf that the fixed script (the patched one) generates contains apparently no errors.</p><p>is seems to be something like this: <a href="https://dev.openwrt.org/ticket/11279">https://dev.openwrt.org/ticket/11279</a><br/>but not quite the same since it completely fails to even start hostapd on radio0.</p><p>btw, thanks for the help <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile"/></p>											<p class="post-edited">(Last edited by <strong>Manp</strong> on 22 Dec 2013, 19:37)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p220658">
				<div class="post-metadata">
					<div class="post-num">Post #823</div>
					<div class="post-author">eigma</div>
					<div class="post-datetime">
						22 Dec 2013, 21:38					</div>
				</div>
				<div class="post-content content">
					<p>I have only tested my patch on a radio0-WEP, radio1-WEP configuration. Unfortunately I cannot change the configuration of my router right now as it&#039;s in active use.</p><p>Can you compare the generated hostapd config files (-phy0.conf and -phy1.conf) for the working and broken cases? Is there a difference in the generated config? Otherwise it might just be the order in which hostapd is started, and then it might be a hostapd or mac80211 bug.</p><p>Edit: also please post the configs.</p>											<p class="post-edited">(Last edited by <strong>eigma</strong> on 22 Dec 2013, 21:39)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p220679">
				<div class="post-metadata">
					<div class="post-num">Post #824</div>
					<div class="post-author">Manp</div>
					<div class="post-datetime">
						23 Dec 2013, 03:45					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>eigma wrote:</cite><blockquote><p>I have only tested my patch on a radio0-WEP, radio1-WEP configuration. Unfortunately I cannot change the configuration of my router right now as it&#039;s in active use.</p><p>Can you compare the generated hostapd config files (-phy0.conf and -phy1.conf) for the working and broken cases? Is there a difference in the generated config? Otherwise it might just be the order in which hostapd is started, and then it might be a hostapd or mac80211 bug.</p><p>Edit: also please post the configs.</p></blockquote></div><p>config that works:</p><p>/etc/config/wireless<br/></p><div class="codebox"><pre><code>config wifi-device &#039;radio0&#039;
    option type &#039;mac80211&#039;
    option macaddr &#039;c4:3d:c7:97:79:45&#039;
    option hwmode &#039;11ng&#039;
    list ht_capab &#039;SHORT-GI-40&#039;
    list ht_capab &#039;TX-STBC&#039;
    list ht_capab &#039;RX-STBC1&#039;
    list ht_capab &#039;DSSS_CCK-40&#039;
    option htmode &#039;HT40-&#039;
    option country &#039;IT&#039;
    option channel &#039;6&#039;
    option txpower &#039;20&#039;

config wifi-iface
    option device &#039;radio0&#039;
    option mode &#039;ap&#039;
    option ssid &#039;MelaBacata&#039;
    option network &#039;guest&#039;
    option encryption &#039;wep-shared&#039;
    option key &#039;1&#039;
    option key1 &#039;s:pocasicurezza&#039;
    option hidden &#039;1&#039;
    option macfilter &#039;allow&#039;
    list maclist &#039;mymachere&#039;

config wifi-iface
    option device &#039;radio0&#039;
    option network &#039;lan&#039;
    option mode &#039;ap&#039;
    option ssid &#039;mywpassidhere&#039;
    option encryption &#039;psk2&#039;
    option key &#039;mywpakeyhere&#039;
    option wps_pushbutton &#039;1&#039;
    option wps_pin &#039;mypinhere&#039;

config wifi-device &#039;radio1&#039;
    option type &#039;mac80211&#039;
    option channel &#039;36&#039;
    option macaddr &#039;c4:3d:c7:97:79:47&#039;
    option hwmode &#039;11na&#039;
    list ht_capab &#039;SHORT-GI-40&#039;
    list ht_capab &#039;TX-STBC&#039;
    list ht_capab &#039;RX-STBC1&#039;
    list ht_capab &#039;DSSS_CCK-40&#039;
    option txpower &#039;17&#039;
    option htmode &#039;HT40+&#039;
    option country &#039;IT&#039;

config wifi-iface
    option device &#039;radio1&#039;
    option network &#039;lan&#039;
    option mode &#039;ap&#039;
    option encryption &#039;psk2&#039;
    option wps_pushbutton &#039;1&#039;
    option ssid &#039;mywpassidhere&#039;
    option key &#039;mykeyhere&#039;
    option wps_pin &#039;mypinhere&#039;</code></pre></div><p>/var/run/hostapd-phy0.conf<br/></p><div class="codebox"><pre><code>driver=nl80211
logger_syslog=127
logger_syslog_level=2
logger_stdout=127
logger_stdout_level=2
country_code=IT
ieee80211d=1
hw_mode=g
channel=6

ieee80211n=1
ht_capab=[HT40-][SHORT-GI-40][TX-STBC][RX-STBC1][DSSS_CCK-40]

interface=wlan0
ctrl_interface=/var/run/hostapd
disassoc_low_ack=1
preamble=1
wmm_enabled=1
ignore_broadcast_ssid=1
wep_key0=706f63617369637572657a7a61
wep_default_key=0
auth_algs=2
wpa=0
ssid=MelaBacata
macaddr_acl=1
accept_mac_file=/var/run/hostapd-wlan0.maclist
bssid=c4:3d:c7:97:79:45


bss=wlan0-1
ctrl_interface=/var/run/hostapd
disassoc_low_ack=1
preamble=1
wmm_enabled=1
ignore_broadcast_ssid=0
wpa_passphrase=mywpakeyhere
auth_algs=1
wpa=2
wpa_pairwise=CCMP
eap_server=1
ap_pin=mypinhere
wps_state=2
ap_setup_locked=0
device_type=6-0050F204-1
device_name=OpenWrt AP
manufacturer=openwrt.org
config_methods=push_button
ssid=mywpassidhere
bridge=br-lan
okc=0
disable_pmksa_caching=1
bssid=c6:3d:c7:97:79:45</code></pre></div><p>config that fails:<br/>/etc/config/wireless<br/></p><div class="codebox"><pre><code>config wifi-device &#039;radio0&#039;
    option type &#039;mac80211&#039;
    option macaddr &#039;c4:3d:c7:97:79:45&#039;
    option hwmode &#039;11ng&#039;
    list ht_capab &#039;SHORT-GI-40&#039;
    list ht_capab &#039;TX-STBC&#039;
    list ht_capab &#039;RX-STBC1&#039;
    list ht_capab &#039;DSSS_CCK-40&#039;
    option htmode &#039;HT40-&#039;
    option country &#039;IT&#039;
    option channel &#039;6&#039;
    option txpower &#039;20&#039;

config wifi-iface
    option device &#039;radio0&#039;
    option network &#039;lan&#039;
    option mode &#039;ap&#039;
    option ssid &#039;mywpassidhere&#039;
    option encryption &#039;psk2&#039;
    option key &#039;mywpakeyhere&#039;
    option wps_pushbutton &#039;1&#039;
    option wps_pin &#039;mypinhere&#039;

config wifi-iface
    option device &#039;radio0&#039;
    option mode &#039;ap&#039;
    option ssid &#039;MelaBacata&#039;
    option network &#039;guest&#039;
    option encryption &#039;wep-shared&#039;
    option key &#039;1&#039;
    option key1 &#039;s:pocasicurezza&#039;
    option hidden &#039;1&#039;
    option macfilter &#039;allow&#039;
    list maclist &#039;mymachere&#039;

config wifi-device &#039;radio1&#039;
    option type &#039;mac80211&#039;
    option channel &#039;36&#039;
    option macaddr &#039;c4:3d:c7:97:79:47&#039;
    option hwmode &#039;11na&#039;
    list ht_capab &#039;SHORT-GI-40&#039;
    list ht_capab &#039;TX-STBC&#039;
    list ht_capab &#039;RX-STBC1&#039;
    list ht_capab &#039;DSSS_CCK-40&#039;
    option txpower &#039;17&#039;
    option htmode &#039;HT40+&#039;
    option country &#039;IT&#039;

config wifi-iface
    option device &#039;radio1&#039;
    option network &#039;lan&#039;
    option mode &#039;ap&#039;
    option encryption &#039;psk2&#039;
    option wps_pushbutton &#039;1&#039;
    option ssid &#039;myradio1ssidhere&#039;
    option key &#039;mykeyhere&#039;
    option wps_pin &#039;mypinhere&#039;</code></pre></div><p>/var/run/hostapd-phy0.conf<br/></p><div class="codebox"><pre><code>driver=nl80211
logger_syslog=127
logger_syslog_level=2
logger_stdout=127
logger_stdout_level=2
country_code=IT
ieee80211d=1
hw_mode=g
channel=6

ieee80211n=1
ht_capab=[HT40-][SHORT-GI-40][TX-STBC][RX-STBC1][DSSS_CCK-40]

interface=wlan0
ctrl_interface=/var/run/hostapd
disassoc_low_ack=1
preamble=1
wmm_enabled=1
ignore_broadcast_ssid=0
wpa_passphrase=mywpakeyhere
auth_algs=1
wpa=2
wpa_pairwise=CCMP
eap_server=1
ap_pin=mypinhere
wps_state=2
ap_setup_locked=0
device_type=6-0050F204-1
device_name=OpenWrt AP
manufacturer=openwrt.org
config_methods=push_button
ssid=mywpassidhere
bridge=br-lan
okc=0
disable_pmksa_caching=1
bssid=c4:3d:c7:97:79:45


bss=wlan0-1
ctrl_interface=/var/run/hostapd
disassoc_low_ack=1
preamble=1
wmm_enabled=1
ignore_broadcast_ssid=1
wep_key0=6d797770616b657968657265
wep_default_key=0
auth_algs=2
wpa=0
ssid=MelaBacata
macaddr_acl=1
accept_mac_file=/var/run/hostapd-wlan0-1.maclist
bssid=c6:3d:c7:97:79:45</code></pre></div><p>i think there&#039;s a bug here. as you can see in the working and broken case there are two different values for the wep_key0 value, but the wep key is the same in both cases.</p><p>in the working case wep_key0=706f63617369637572657a7a61 which transates to &quot;pocasicurezza&quot; which is my actual wep key</p><p>in the broken case wep_key0=6d797770616b657968657265 which translates to &quot;mywpakeyhere&quot;! so in the broken case the script is actually using the wpa key from the wpa protected interface to generate the wep key for the wep protected interface which result in an invalid wep key!</p><p>if i change my wpa key so the script generates a valid wep key from it then it works in both cases, so the bug is certainly somewhere in the script that generates the hostapd-phyX.conf file.</p><p>hope this makes sense <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile"/></p>											<p class="post-edited">(Last edited by <strong>Manp</strong> on 23 Dec 2013, 04:02)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p220686">
				<div class="post-metadata">
					<div class="post-num">Post #825</div>
					<div class="post-author">eigma</div>
					<div class="post-datetime">
						23 Dec 2013, 06:18					</div>
				</div>
				<div class="post-content content">
					<p>Two things, one to gather more information, the other a possible fix.</p><p>1) Edit /lib/netifd/netifd-wireless.sh and insert this line at the beginning, before the NETIFD_MAIN_DIR line:<br/></p><div class="codebox"><pre><code>echo &quot;$@&quot; &gt;&gt;/tmp/netifd.log</code></pre></div><p>Then run &#039;wifi reload radio0&#039; and post the contents of /tmp/netifd.log.</p><p>Restore the netifd-wireless.sh to rom (rm /overlay/lib/netifd/netifd-wireless.sh).</p><p>2) Edit /lib/netifd/hostapd.sh, around line 236, after this line:<br/></p><div class="codebox"><pre><code>local wep_keyidx=0</code></pre></div><p>Insert this line:<br/></p><div class="codebox"><pre><code>json_get_vars key</code></pre></div><p>Then wifi reload and check the hostapd config.</p>											<p class="post-edited">(Last edited by <strong>eigma</strong> on 23 Dec 2013, 06:18)</p>
									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 33 of 63</div><nav><ul><li><a href="viewtopic.php%3Fid=28392&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=28392&amp;p=31.html">31</a></li><li><a href="viewtopic.php%3Fid=28392&amp;p=32.html">32</a></li><li class="pagination-current"><span>33</span></li><li><a href="viewtopic.php%3Fid=28392&amp;p=34.html">34</a></li><li><a href="viewtopic.php%3Fid=28392&amp;p=35.html">35</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=28392&amp;p=63.html">63</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0.001 -->

</body>
</html>