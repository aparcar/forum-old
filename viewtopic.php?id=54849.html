<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Java Environment on OpenWrt (OXNAS)</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 29 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p259353">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">aschuetze</div>
					<div class="post-datetime">
						31 Dec 2014, 21:59					</div>
				</div>
				<div class="post-content content">
					<p>Hi guys,</p><p>after days of hard work with lots of try&amp;error i finally managed to build firmware from snapshots for oxnas. to my big disappointment i noticed that till today noone managed to get a working java environment on that devices? how it comes? i tried to get rid of crappy medion firmware to switch to an better supported one, but with ffp i was at least able to run embedded java from oracle on my medion nas... its the last part of my puzzle for running minimserver on my nas with an way better firmware. there seems to be no packages of embedded java (oracle, phoneme, jamvm, etc) or any instructions how to compile one on my nas. can anyone plz help me out or explain why java isn&#039;t supported? it seems even arch or debian would come with java support on that device - but i prefer openwrt with luci as my knowledge still seems to be quite basic! <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>thx i.a. alex</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259359">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">probono</div>
					<div class="post-datetime">
						31 Dec 2014, 23:14					</div>
				</div>
				<div class="post-content content">
					<p>Sorry to be slightly OT: While I do not have an answer regarding Java, I would be interested if you installed OpenWrt into the flash memory of your oxnas device. Does it use squashfs and overlayfs, so that you can always revert to a &quot;known good&quot; OpenWrt installation?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259364">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">aschuetze</div>
					<div class="post-datetime">
						1 Jan 2015, 02:59					</div>
				</div>
				<div class="post-content content">
					<p>Yes i did. Thx to UART i always can stop boot process, run boot_rescue and flash new firmware. Back to Java! <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259378">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">zloop</div>
					<div class="post-datetime">
						1 Jan 2015, 11:39					</div>
				</div>
				<div class="post-content content">
					<p>JamVM is available in oldpackages. It should build without errors for trunk.</p><br /><div class="quotebox"><blockquote><p>it seems even arch or debian would come with java support on that device</p></blockquote></div><p>Arch or Debian probably have more developers and maintainers.<br />You can submit and maintain JamVM to the github packages repo via pull request.</p><p>Since GNU Linux is Free Software you can check the cross platform patches that are used in other distributions for Java.<br />- debian: <a href="https://packages.debian.org/sid/openjdk-8-jdk">https://packages.debian.org/sid/openjdk-8-jdk</a><br />- fedora: <a href="http://pkgs.fedoraproject.org/cgit/java-1.8.0-openjdk.git/">http://pkgs.fedoraproject.org/cgit/java â€¦ enjdk.git/</a></p><p>Most OpenWrt targets can support Java only with extroot - less interesting for most developers.<br />(Not to mention the constant security fixes you have to track when using java<br />(afaik latest sidechannel in JSSE - <a href="https://www.youtube.com/watch?v=c4tNU5BjvLM">https://www.youtube.com/watch?v=c4tNU5BjvLM</a> )</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259407">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">stamasd</div>
					<div class="post-datetime">
						1 Jan 2015, 17:03					</div>
				</div>
				<div class="post-content content">
					<p>Watching with interest. I have a half-mind about running a minecraft server on my router. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259408">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">aschuetze</div>
					<div class="post-datetime">
						1 Jan 2015, 17:10					</div>
				</div>
				<div class="post-content content">
					<p>thx zloop, oldpackages was a very good hint. now i managed to create firmware with jamvm 1.6 included (after installing openjdk on build machine). &quot;jamvm -version&quot; is showing a running java vm now and i need to figure out how to set paths for running with minimserver! i fear as jamvm 1.6 is based on java 1.5 it wont work anyways, as minimserver requires java 7 at least. jamvm 2.0 seems to support the latest java versions, but is not available yet for openwrt. guess next weeks would be fiddling around how to get jamvm 2.0 for openwrt... anyone? <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></p><p>life isn&#039;t easy for a windows guy... <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>											<p class="post-edited">(Last edited by <strong>aschuetze</strong> on 1 Jan 2015, 17:13)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259422">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">stamasd</div>
					<div class="post-datetime">
						1 Jan 2015, 19:39					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>aschuetze wrote:</cite><blockquote><p>thx zloop, oldpackages was a very good hint. now i managed to create firmware with jamvm 1.6 included (after installing openjdk on build machine). &quot;jamvm -version&quot; is showing a running java vm now and i need to figure out how to set paths for running with minimserver! i fear as jamvm 1.6 is based on java 1.5 it wont work anyways, as minimserver requires java 7 at least. jamvm 2.0 seems to support the latest java versions, but is not available yet for openwrt. guess next weeks would be fiddling around how to get jamvm 2.0 for openwrt... anyone? <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></p><p>life isn&#039;t easy for a windows guy... <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p></blockquote></div><p>I have a development environment set for ramips, I&#039;ll give it a shot to compiling jamvm 2.0... wish me luck (it&#039;s not exactly easy for this Linux guy either, don&#039;t feel bad)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259428">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">aschuetze</div>
					<div class="post-datetime">
						1 Jan 2015, 20:44					</div>
				</div>
				<div class="post-content content">
					<p>big THX for giving it a try, your help is much appreciated! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> i already got:</p><p>root@NAS-Server:/usr/bin# /usr/share/minimserver/bin/startc<br />MinimServer: Java 7 or later is required: current version is 1.5.0<br />java.lang.reflect.InvocationTargetException<br />&nbsp; &nbsp;at java.lang.reflect.VMMethod.invoke(Native Method)<br />&nbsp; &nbsp;at java.lang.reflect.Method.invoke(Method.java:327)<br />&nbsp; &nbsp;at jamvm.java.lang.JarLauncher.main(JarLauncher.java:50)<br />Caused by: java.awt.AWTError: Cannot load AWT toolkit: gnu.java.awt.peer.gtk.GtkToolkit<br />&nbsp; &nbsp;at java.awt.Toolkit.getDefaultToolkit(Toolkit.java:607)<br />&nbsp; &nbsp;at javax.swing.plaf.basic.BasicLookAndFeel.initialize(BasicLookAndFeel.java:1720)<br />&nbsp; &nbsp;at javax.swing.UIManager.setLookAndFeel(UIManager.java:912)<br />&nbsp; &nbsp;at javax.swing.UIManager.&lt;clinit&gt;(UIManager.java:245)<br />&nbsp; &nbsp;at org.jminim.launch.Launcher.reportErrorUC(Launcher.java:427)<br />&nbsp; &nbsp;at org.jminim.launch.Launcher.launch(Launcher.java:118)<br />&nbsp; &nbsp;at com.minimserver.launch.LaunchServer.main(LaunchServer.java:30)<br />&nbsp; &nbsp;at java.lang.reflect.VMMethod.invoke(Native Method)<br />&nbsp; &nbsp;...2 more<br />Caused by: java.lang.UnsatisfiedLinkError: Native library `gtkpeer&#039; not found (as file `libgtkpeer.so&#039;) in gnu.classpath.boot.library.path and java.library.path<br />&nbsp; &nbsp;at java.lang.Runtime.loadLibrary(Runtime.java:763)<br />&nbsp; &nbsp;at java.lang.System.loadLibrary(System.java:670)<br />&nbsp; &nbsp;at gnu.java.awt.peer.gtk.GtkToolkit.&lt;clinit&gt;(GtkToolkit.java:177)<br />&nbsp; &nbsp;at java.lang.VMClass.forName(Native Method)<br />&nbsp; &nbsp;at java.lang.Class.forName(Class.java:233)<br />&nbsp; &nbsp;at java.awt.Toolkit.getDefaultToolkit(Toolkit.java:583)<br />&nbsp; &nbsp;...9 more</p><p>so it seems just a question of newer version! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> would your ramips build easily become part of trunk, so i can compile for arm (oxnas)? sorry, stupid question i guess, but i got info overflow over the last week - never openwrt&#039;ed before and am more than proud already building own firmwares... <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259431">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">stamasd</div>
					<div class="post-datetime">
						1 Jan 2015, 21:01					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>aschuetze wrote:</cite><blockquote><p>big THX for giving it a try, your help is much appreciated! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> i already got:</p><br /><p>so it seems just a question of newer version! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> would your ramips build easily become part of trunk, so i can compile for arm (oxnas)? sorry, stupid question i guess, but i got info overflow over the last week - never openwrt&#039;ed before and am more than proud already building own firmwares... <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></p></blockquote></div><p>I am not a developer, just an end-user like you (built my first firmware less than a month ago). <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> Can&#039;t commit anything to trunk. I&#039;ll try to&nbsp; get it compiled for my architecture, then if it works I may give it a try for oxnas and see if I can package it and make it available for download. Compiling may take a long time as I&#039;m doing this on a laptop.</p><p>(and no this is not completely disinterested - as I said I may have a use for java myself)</p>											<p class="post-edited">(Last edited by <strong>stamasd</strong> on 1 Jan 2015, 21:02)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259432">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">aschuetze</div>
					<div class="post-datetime">
						1 Jan 2015, 21:06					</div>
				</div>
				<div class="post-content content">
					<p><img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> take your time! maybe someone else can step in and help us out here. i was quite surprised that noone seems to be in need for java on openwrt devices!? :-O at least the net doesnt come up with very helpful information for guys like me. <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /> feeling quite close now achieving my goal and all the hours since xmas may pay off somehow! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259433">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">stamasd</div>
					<div class="post-datetime">
						1 Jan 2015, 21:29					</div>
				</div>
				<div class="post-content content">
					<p>TBH, java is in general quite a resource hog, and most devices that run openwrt are fairly short on cpu cycles and memory. Not really surprising that java doesn&#039;t have high demand here.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259437">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">aschuetze</div>
					<div class="post-datetime">
						1 Jan 2015, 21:38					</div>
				</div>
				<div class="post-content content">
					<p><img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> i already got that point, but isnt that the beauty of having an modular os? Seeing openwrt as a real alternative for lot of nas devices with the nice to handle luci, i assume more and more java based apps may get used on openwrt.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259442">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">danak6jq</div>
					<div class="post-datetime">
						1 Jan 2015, 22:30					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m running JamVM 2.0.0 + classpath 0.99 on Barrier Breaker / Carambola2 - obviously happy to provide the patches you&#039;ll need:</p><p>- classpath has a serious bug where conversion of doubles/floats to strings leaks memory. The patch for that is in the associated bug report (easily found with google) and easy to apply.</p><p>- classpath glibj.zip is compressed with standard jar (zip) compression. It gets *larger* when incorporated into squashfs. So you will want to patch the generation of glibj.zip or re-compress it with -0 compression. While you&#039;ll find glibj.zip is now 20MB, the resulting firmware image will be 700K smaller in the end. Really.</p><p>- A complete OpenWRT firmware build including JamVM 2.0.0 and full classpath0.99 is ~9MB for a Carambola2 and runs with a reasonable memory footprint.</p><p>- If you use the -verbose:class option of jamvm, you can collect information on which classes you really need and substantially reduce the size of classpath glibj.zip.</p>											<p class="post-edited">(Last edited by <strong>danak6jq</strong> on 2 Jan 2015, 01:58)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259452">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">stamasd</div>
					<div class="post-datetime">
						1 Jan 2015, 23:29					</div>
				</div>
				<div class="post-content content">
					<p>I was able to compile jamvm 2.0 for ramips; the stripped binary is 388kB.<br />To compile it for oxnas though I will have to build a whole new toolchain. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259464">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">stamasd</div>
					<div class="post-datetime">
						2 Jan 2015, 02:51					</div>
				</div>
				<div class="post-content content">
					<p>Here is jamvm-2.0.0 compiled for oxnas. It is not a opkg package but simply a package that you can unarchive in / to get the binaries in their proper places. I can&#039;t check if it works since I don&#039;t have an ARM device with OpenWRT installed. I did not attempt to compile classpath, that would be a separate exercise of larger scope.</p><p>Download here: <a href="http://www.filedropper.com/jamvm200oxnastar">http://www.filedropper.com/jamvm200oxnastar</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259493">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">aschuetze</div>
					<div class="post-datetime">
						2 Jan 2015, 11:33					</div>
				</div>
				<div class="post-content content">
					<p>Wow, that was fast progress. Will try asap and get back to you guys. Thx again.</p><p>@danak6jq: you gave new riddles to solve, will google+read+google+read... <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259499">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">probono</div>
					<div class="post-datetime">
						2 Jan 2015, 12:18					</div>
				</div>
				<div class="post-content content">
					<p>It would be nice if you could make an OpenWrt Makefile out of it, so that we can build it for other platforms as well. Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259520">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">aschuetze</div>
					<div class="post-datetime">
						2 Jan 2015, 15:05					</div>
				</div>
				<div class="post-content content">
					<p>after creating ln -s /usr/bin/jamvm /usr/bin/java i&#039;m getting:</p><p>root@OpenWrt:/# java -version<br />java version &quot;1.5.0&quot;<br />JamVM version 2.0.0<br />Copyright (C) 2003-2014 Robert Lougher &lt;rob@jamvm.org.uk&gt;</p><p>This program is free software; you can redistribute it and/or<br />modify it under the terms of the GNU General Public License<br />as published by the Free Software Foundation; either version 2,<br />or (at your option) any later version.</p><p>This program is distributed in the hope that it will be useful,<br />but WITHOUT ANY WARRANTY; without even the implied warranty of<br />MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.&nbsp; See the<br />GNU General Public License for more details.</p><p>Build information:</p><p>Execution Engine: inline-threaded interpreter with stack-caching<br />Compiled with: gcc 4.8.3</p><p>Boot Library Path: /usr/local/classpath/lib/classpath<br />Boot Class Path: /home/silviu/openwrt/jamvm200oxnas-install/share/jamvm/classes.zip:/usr/local/classpath/share/classpath/glibj.zip</p><p>which means jamvm 2.0 seems to run succesfully! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> when starting minimserver now i&#039;m getting:</p><p>root@OpenWrt:/# /usr/share/minimserver/bin/startc<br />Exception occurred while VM initialising.<br />java/lang/NoClassDefFoundError: jamvm/java/lang/VMClassLoaderData</p><p>at least its not starting with java 7 required message, but it seems that class path and library path are compiled into jamvm and dont match the folder structure of my device. guess i need somehow compile it myself - any recommended guides? till yet i used the openwrt feeds to get required components into my firmware. compiling classpath and jamvm 2.0 in my chain seems to be the key.</p>											<p class="post-edited">(Last edited by <strong>aschuetze</strong> on 2 Jan 2015, 15:06)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259521">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">stamasd</div>
					<div class="post-datetime">
						2 Jan 2015, 15:11					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>probono wrote:</cite><blockquote><p>It would be nice if you could make an OpenWrt Makefile out of it, so that we can build it for other platforms as well. Thanks!</p></blockquote></div><p>I can try (never done that before, but it doesn&#039;t look too complicated). But that would make an unmaintained and unsupported package, since I don&#039;t have any time to dedicate on a regular or even irregular basis to maintaining it.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259525">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">stamasd</div>
					<div class="post-datetime">
						2 Jan 2015, 15:26					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>aschuetze wrote:</cite><blockquote><p>after creating ln -s /usr/bin/jamvm /usr/bin/java i&#039;m getting:</p><p>root@OpenWrt:/# java -version<br />java version &quot;1.5.0&quot;<br />JamVM version 2.0.0<br />Copyright (C) 2003-2014 Robert Lougher &lt;rob@jamvm.org.uk&gt;</p><p>This program is free software; you can redistribute it and/or<br />modify it under the terms of the GNU General Public License<br />as published by the Free Software Foundation; either version 2,<br />or (at your option) any later version.</p><p>This program is distributed in the hope that it will be useful,<br />but WITHOUT ANY WARRANTY; without even the implied warranty of<br />MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.&nbsp; See the<br />GNU General Public License for more details.</p><p>Build information:</p><p>Execution Engine: inline-threaded interpreter with stack-caching<br />Compiled with: gcc 4.8.3</p><p>Boot Library Path: /usr/local/classpath/lib/classpath<br />Boot Class Path: /home/silviu/openwrt/jamvm200oxnas-install/share/jamvm/classes.zip:/usr/local/classpath/share/classpath/glibj.zip</p><p>which means jamvm 2.0 seems to run succesfully! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> when starting minimserver now i&#039;m getting:</p><p>root@OpenWrt:/# /usr/share/minimserver/bin/startc<br />Exception occurred while VM initialising.<br />java/lang/NoClassDefFoundError: jamvm/java/lang/VMClassLoaderData</p><p>at least its not starting with java 7 required message, but it seems that class path and library path are compiled into jamvm and dont match the folder structure of my device. guess i need somehow compile it myself - any recommended guides? till yet i used the openwrt feeds to get required components into my firmware. compiling classpath and jamvm 2.0 in my chain seems to be the key.</p></blockquote></div><p>Looks like the java interpreter is looking for its classes in 2 locations, both of which don&#039;t exist on your machine. The first one is its own built-in classes, but it&#039;s prefixed with my install path which doesn&#039;t exist on your machine. The other one is probably the default inslall location for the GNU classpath, which also doesn&#039;t exist there.</p><p>Here are the steps that I took.<br />First I installed a fresh copy of the OpenWRT repository in a separate directory - not to have any stuff contaminated with some of my ramips experiments. I built the toolchain for oxnas there (~/openwrt/git-oxnas/oxnas)<br />Downloaded jamvm <a href="http://downloads.sourceforge.net/project/jamvm/jamvm/JamVM%202.0.0/jamvm-2.0.0.tar.gz">http://downloads.sourceforge.net/projec â€¦ 0.0.tar.gz</a><br />Configured jamvm with the following:</p><div class="codebox"><pre><code>PATH=$PATH:/home/user/openwrt/git-oxnas/openwrt/staging_dir/toolchain-arm_mpcore_gcc-4.8-linaro_uClibc-0.9.33.2_eabi/bin
export PATH
STAGING_DIR=/home/user/openwrt/git-oxnas/openwrt/staging_dir/toolchain-arm_mpcore_gcc-4.8-linaro_uClibc-0.9.33.2_eabi/
export STAGING_DIR
./configure --build=x86_64-unknown-linux-gnu --host=arm-openwrt-linux --prefix=/home/silviu/openwrt/jamvm200oxnas-install
make
make install</code></pre></div><p>then simply compressed the contents of the install directory to make the package.</p><p>One small problem I ran into for the configuration is that cross-compiled zlib is required; I got around it by enabling zlib to be built when I do &quot;make menuconfig&quot; then just fish the binaries and headers from build_dir/target and copy them into staging_dir/toolchain/{lib and include}. Then configure finishes without a glitch.</p>											<p class="post-edited">(Last edited by <strong>stamasd</strong> on 2 Jan 2015, 15:30)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259526">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">aschuetze</div>
					<div class="post-datetime">
						2 Jan 2015, 15:38					</div>
				</div>
				<div class="post-content content">
					<p>big THX, will try next! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259570">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">danak6jq</div>
					<div class="post-datetime">
						2 Jan 2015, 19:35					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>stamasd wrote:</cite><blockquote><p>Here are the steps that I took.<br />First I installed a fresh copy of the OpenWRT repository in a separate directory - not to have any stuff contaminated with some of my ramips experiments. I built the toolchain for oxnas there (~/openwrt/git-oxnas/oxnas)<br />Downloaded jamvm <a href="http://downloads.sourceforge.net/project/jamvm/jamvm/JamVM%202.0.0/jamvm-2.0.0.tar.gz">http://downloads.sourceforge.net/projec â€¦ 0.0.tar.gz</a><br />Configured jamvm with the following:</p><div class="codebox"><pre><code>PATH=$PATH:/home/user/openwrt/git-oxnas/openwrt/staging_dir/toolchain-arm_mpcore_gcc-4.8-linaro_uClibc-0.9.33.2_eabi/bin
export PATH
STAGING_DIR=/home/user/openwrt/git-oxnas/openwrt/staging_dir/toolchain-arm_mpcore_gcc-4.8-linaro_uClibc-0.9.33.2_eabi/
export STAGING_DIR
./configure --build=x86_64-unknown-linux-gnu --host=arm-openwrt-linux --prefix=/home/silviu/openwrt/jamvm200oxnas-install
make
make install</code></pre></div><p>then simply compressed the contents of the install directory to make the package.</p><p>One small problem I ran into for the configuration is that cross-compiled zlib is required; I got around it by enabling zlib to be built when I do &quot;make menuconfig&quot; then just fish the binaries and headers from build_dir/target and copy them into staging_dir/toolchain/{lib and include}. Then configure finishes without a glitch.</p></blockquote></div><p>I wanted a turn-key build. So I took the existing jamvm Makefile: feeds/oldpackages/lang/jamvm/Makefile and updated it to pull down and build JamVM 2.0.0, then placed that Makefile in my own (local) custom feed as jamvm2. After configuring my feeds.conf.default to include the local feed and the usual ./scripts/feeds update -a / install -a, I ran &#039;make menuconfig&#039;, selected jamvm2 under Languages/Java and ran &#039;make&#039;</p><p>This takes care of the dependency on GNU classpath automatically - that&#039;s the problem with just cross-compiling jamvm and bundling up the install directory, you won&#039;t inherently get the dependencies.</p><p>Specifically, this line in jamvm/Makefile is worth paying attention to:</p><p>&nbsp; DEPENDS:=+zlib +libpthread +librt +classpath @!avr32</p><p>For classpath, I needed to include the floating point string-coversion patches, and I modified the classpath/Makefile to pick up classpath-0.99.&nbsp; Hence, I get turn-key builds and package creation with the OpenWRT buildroot bits. I don&#039;t think there&#039;s any reason the patches involved won&#039;t work for any OpenWRT platform supported by jamvm.</p><p>It is worth learning how to create your own local feed; it isn&#039;t difficult and makes life easier.</p><p>Anyone care to suggest a place to stash an archive of the patches I used?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259584">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">makro</div>
					<div class="post-datetime">
						2 Jan 2015, 20:43					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>danak6jq wrote:</cite><blockquote><p>Anyone care to suggest a place to stash an archive of the patches I used?</p></blockquote></div><p><a href="https://github.com/openwrt/packages">https://github.com/openwrt/packages</a> <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>If you aren&#039;t interested in maintaining it, making a git repository on Github that people could add to their feeds would probably be welcome too. But having Buildbot do the work is as turn-key as it gets.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259585">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">danak6jq</div>
					<div class="post-datetime">
						2 Jan 2015, 20:59					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>makro wrote:</cite><blockquote><div class="quotebox"><cite>danak6jq wrote:</cite><blockquote><p>Anyone care to suggest a place to stash an archive of the patches I used?</p></blockquote></div><p><a href="https://github.com/openwrt/packages">https://github.com/openwrt/packages</a> <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>If you aren&#039;t interested in maintaining it, making a git repository on Github that people could add to their feeds would probably be welcome too. But having Buildbot do the work is as turn-key as it gets.</p></blockquote></div><p>I suppose I asked for it, right? :-)&nbsp; OK, I&#039;ll have to figure out how to submit my changes, never been to that particular rodeo before. Of course I much prefer having changes that I want integrated up-stream so I never have to worry about them.</p><p>There&#039;s probably an FAQ for package maintainers... will look when I have time later.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259587">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">aschuetze</div>
					<div class="post-datetime">
						2 Jan 2015, 21:15					</div>
				</div>
				<div class="post-content content">
					<p>great to see we are all in some kind of school now, different classes of course! <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>