<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Use a TL-WDR3600 with a Technicolor 7200</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 2 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p246021">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Curvature</div>
					<div class="post-datetime">
						4 Sep 2014, 18:38					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I am a customer of Unitymedia NRW, Germany. They are a cable TV internet provider. They have me a Technicolor TC7200 which is very limited in its options. Additionally, it is controlled by them, so I cannot do very much with it.</p><p>The ISP uses DS-Lite to give me an IPv6 address. The TC7200 does not support bridge mode, only router mode. Since there is no way to set up the firewall like I want, use the supplied USB ports, I would like to have another router (and firewall) between the ISP modem and my home network (setup B):</p><p><span class="postimg"><img src="http://i.stack.imgur.com/bFZCt.png" alt="http://i.stack.imgur.com/bFZCt.png" /></span></p><p>With the stock firmware of the TL-WDR3600, I was not able to get IPv6 working correctly. If I let the WDR3600 obtain its IP with DHCPv6, it will give my computers a /128 address which cannot be correct. When trying to use prefix delegation within the WDR3600, my devices to not get any global IPv6 address. Somebody <a href="http://www.unitymediakabelbwforum.de/viewtopic.php?f=53&amp;t=26812&amp;p=299659#p299659">in a German forum</a> told me that this is simply because the TC7200 does not support prefix delegation.</p><p>He told me that the only option I have is to use Barrier Breaker with its “Hybrid-/Relay-Mode” and let the computers use the same IPv6 subnet that the TC7200 provides. The only upside is that the WDR3600 might be able to act as a firewall.</p><p>This leads me to my main question: Would it be possible to set up an IPv6 firewall in the WDR3600 (with Barrier Breaker) such that the ISP cannot get into my home network, although it already has the TC7200 in my living room?</p><p>How much expertise is needed for this? I use Linux for four years now, but my focus is more on programming higher level applications, nothing hardware related. Would you say that it would be an overall improvement for me to attempt to flash the WDR3600 with Barrier Breaker and set it up like I showed in the picture? Or would you rather say that the hazzle is not worth the isolation from the ISP?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p246145">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">nozombian</div>
					<div class="post-datetime">
						5 Sep 2014, 21:32					</div>
				</div>
				<div class="post-content content">
					<p>I don&#039;t know anything about ipv6, but we have this modem too in here from upc, several months ago it was really not possible to set it as bridge, the first versions of firmware had problems with port forwarding, forwarded ports had big packet loss, you could&#039;t even set internal IPs... it really sucked. But from what I heard the bridge now works, so it is finally usable modem. Ask your provider if they have newer firmware, I returned that crap long time ago and bought used cisco 3208 instead.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p246151">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Curvature</div>
					<div class="post-datetime">
						5 Sep 2014, 21:57					</div>
				</div>
				<div class="post-content content">
					<p>The bridge mode is available in the Web UI, but it is locked. The customer support told me that (as if that was something good) that this feature is disabled. Since I do not have any public IPv4 address, port forwarding is not really a concern right now. My provider has locked me on this hardware, there is no way to use my own hardware. The MAC address from the modem is what logs me into their network.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p246844">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">dpsi</div>
					<div class="post-datetime">
						12 Sep 2014, 12:12					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Curvature wrote:</cite><blockquote><p>Since I do not have any public IPv4 address</p></blockquote></div><p>Thats probably why you can&#039;t used bridged mode, theres nothing to &quot;bridge&quot;</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p265638">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">azrdev</div>
					<div class="post-datetime">
						15 Feb 2015, 18:37					</div>
				</div>
				<div class="post-content content">
					<p>Hi,<br />just hijacking this thread, because it&#039;s also my issue. So, this applies to me:<br /></p><div class="quotebox"><cite>Curvature wrote:</cite><blockquote><p>They have me a Technicolor TC7200 which is very limited in its options. Additionally, it is controlled by them, so I cannot do very much with it.</p><p>The ISP uses DS-Lite to give me an IPv6 address. The TC7200 does not support bridge mode, only router mode</p></blockquote></div><div class="quotebox"><cite>Curvature wrote:</cite><blockquote><p>the TC7200 does not support prefix delegation</p></blockquote></div><p>And I&#039;d like to do this:<br /></p><div class="quotebox"><cite>Curvature wrote:</cite><blockquote><p>use Barrier Breaker with its “Hybrid-/Relay-Mode” and let the computers use the same IPv6 subnet that the TC7200 provides</p></blockquote></div><p>My own router is a 1043ND v1&nbsp; with Barrier Breaker (r42625).</p><p>Now, the default config should enable the relay mode &amp; supply those IPv6 addresses to clients. I do get IPv6 addresses on the clients, but they are not routable beyond my openwrt box.</p><p><strong><em>Can you help me debugging the new odhcpd relay/hybrid mode?</em></strong></p><br /><br /><p>Some of the IPv6 addresses in my net, by machine:</p><h5>TC7200</h5><p><strong>&quot;Internet&quot;</strong><br />IPv6 Address:<br />&nbsp; fe80::8af7:c7ff:fe80:3a0/64<br />&nbsp; 2a02:xxxx:yyyy:5:1c0d:7498:46b5:9e84/128<br /><strong>&quot;LAN&quot;</strong><br />IPv6 Address&nbsp; &nbsp; 2a02:xxxx:zzzz:5b00:8af7:c7ff:fe80:3a2/64<br />IPv6 Prefix&nbsp; &nbsp; 2a02:xxxx:zzzz:5b00::/59<br />Eth-Switch Lan(3) 2a02:xxxx:zzzz:5b00::/64<br />ITC 2a02:xxxx:zzzz:5b00::/64</p><h5>OpenWrt</h5><p><strong>eth0.2 (wan)</strong><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: 2a02:xxxx:zzzz:5b00::1/128 Scope:Global<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: 2a02:xxxx:zzzz:5b00:b248:7aff:fed1:6c0c/64 Scope:Global<br /><strong>br-lan</strong><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: fd50:d71a:6c18::1/60 Scope:Global<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: 2a02:xxxx:zzzz:5b1c::1/62 Scope:Global<br /></p><h5>Client @ OpenWrt</h5><p>&nbsp; &nbsp; inet6 2a02:xxxx:zzzz:5b1c:d169:198a:fccd:23d9/64 scope global noprefixroute dynamic <br />&nbsp; &nbsp; inet6 fd50:d71a:6c18::946/128 scope global noprefixroute dynamic </p><br /><p><em>fe80:</em> addresses are link-local, ignore them (omitted most of them).<br /><em>fd50:</em> seem to exist only in my LAN, as I understand wikipedia those should be only valid there &amp; not globally routable.<br /><em>2a02:</em> seem to be the addresses gotten from upstream - but I don&#039;t understand how OpenWrt is getting the 2a02:x:z:5b1c: prefix (which it supplies to clients) from the 2a02:x:z:5b00: prefix the TC7200 gives it an address in, neither if that&#039;s the way things should be in relay mode.</p><h5>OpenWrt config</h5><p>Since I tried some different configuration settings, here my current settings.</p><p>/etc/config/dhcp<br /></p><div class="codebox"><pre><code>config dhcp &#039;lan&#039;
        option interface &#039;lan&#039;
        ...
        option ra &#039;hybrid&#039;
        option dhcpv6 &#039;hybrid&#039;
        option ndp &#039;hybrid&#039;
        option ra_management &#039;1&#039;
        option ra_default &#039;1&#039;

config dhcp &#039;wan&#039;
        option interface &#039;wan&#039;
        option ignore &#039;1&#039;

config dhcp &#039;wan6&#039;
        option ifname @wan
        option dhcpv6 &#039;hybrid&#039;
        option ra &#039;hybrid&#039;
        option ndp &#039;hybrid&#039;
        option master &#039;1&#039;

config odhcpd &#039;odhcpd&#039;
        option maindhcp &#039;0&#039;
        ...</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p277660">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Hank</div>
					<div class="post-datetime">
						27 May 2015, 00:51					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>I cannot find even one success-story with the Technicolor TC7200, Unitymedia and IPv6.</p><p>And I&#039;m in the same boat now, I guess. It seems to be impossible to put an OpenWrt-Router behind the TC7200-Modemrouter and to have IPv6-connectivity from behind the OpenWrt then :-(.</p><p>I tested it with OpenWrt Chaos Calmer 15.05-rc1 on a TP-Link WR1043NDv1. First I stopped the &quot;firewall&quot; for IPv4 and IPv6 on the TC7200.</p><p>I tried several things, but so far the IPv6-routing always ends on the TC7200, when tried from a client-PC behind the OpenWrt. Even with the default OpenWrt config (&quot;perform reset&quot;) this szenario is reproducible. Example:</p><p>PC# traceroute6 ipv6.google.com<br />traceroute to ipv6.google.com (2a00:1450:4001:800::1004), 30 hops max, 80 byte packets<br /> 1&nbsp; 2a02:908:X:1 (2a02:908:X:1)&nbsp; 2.382 ms&nbsp; 2.352 ms&nbsp; 2.322 ms<br /> 2&nbsp; 2a02:908:X:Y (2a02:908:X:Y)&nbsp; 2.293 ms&nbsp; 2.263 ms&nbsp; 2.201 ms<br /> 3&nbsp; * * *<br /> 4&nbsp; * * *<br /> 5&nbsp; * * *</p><p>Some more details:</p><p>My OpenWrt gets an IPv6 address with netmask /128 from the TC7200 (a single address? not even a /64 net??)<br />-&gt;<br /></p><div class="codebox"><pre><code>IPv6 WAN Status
eth0.2  Address: 2a02:908:X/128
Gateway: fe80:X
DNS 1: 2a02:908:2:1109::11
DNS 2: 2a02:908:2:1104::11
Connected: 0h 10m 19s</code></pre></div><p>On the LAN-side of the OpenWrt I see a /62 address then -&gt;</p><div class="codebox"><pre><code>root@OpenWrt:~# ifconfig                                                                      
br-lan
[..]
          inet6 addr: 2a02:908:X::1/62 Scope:Global</code></pre></div><p>The client-PC gets an IPv6-address with /64 from the OpenWrt ...<br /></p><div class="codebox"><pre><code>PC# ifconfig
eth0
[..]
          inet6 addr: 2a02:908:X/64 Scope:Global</code></pre></div><p>... and a default route via link-local: </p><div class="codebox"><pre><code>PC# ip -6 route
2a02:908:X::/64 dev eth0  proto kernel  metric 256  expires 57sec
fd43:X::/64 dev eth0  proto kernel  metric 256  expires 7199sec
fe80::/64 dev eth0  proto kernel  metric 256
default via fe80::X dev eth0  proto static  metric 1
default via fe80::X dev eth0  proto kernel  metric 1024  expires 1799sec</code></pre></div><p>Besides the described default-config szenario I tried various hybrid mode settings on the LAN-side DHCP-settings for IPv6, but it never became better. The routing from the client-PC always stops at the TC7200. To me it looks, as if the TC7200 is not aware of any IPv6-networks behind a second router like the OpenWrt.</p><p>I guess I will recall the contract with Unitymedia again, which is possible within two months of testing for a new customer. It seems to be impossible to do *real* internet with their ds-lite implementation.</p><p>bye</p><p>PS: Technicolor TC7200<br />SW-Version&nbsp; &nbsp; &nbsp; STD6.02.11<br />HW-Version&nbsp; &nbsp; &nbsp; 1.0</p>											<p class="post-edited">(Last edited by <strong>Hank</strong> on 27 May 2015, 08:57)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>