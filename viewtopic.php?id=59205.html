<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Making Your Own NAS With WiTi Board</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 15 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p289107">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">benn.huang</div>
					<div class="post-datetime">
						25 Aug 2015, 08:13					</div>
				</div>
				<div class="post-content content">
					<p><span class="postimg"><img src="https://mqmaker.com/wp-content/uploads/2015/08/witi_nas.jpg" alt="WiTi NAS" /></span><br />&nbsp; &nbsp; If you want to find a low power, scalable Mini server for NAS storage server, the WiTi board can be an option. WiTi is a board powered by Mediatek MT7621A dual core processor @ 880MHz, but with 4 Gigabit Ethernet LAN ports, 2 Gigabit WAN ports, 802.11 b/g/n and 802.11ac WiFi with up to 4 external antennas, 30 expansion ports, two SATA ports, as well as a USB 3.0 port. With the features, we can turn the WiTi to an extensible NAS(Network Attached Storage). This post is going to show you how to make it.</p><p><strong>1.What We Need?</strong></p><p>WiTi Board&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;x1<br />SATA Cable&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x2<br />3.5” 1TB HDD&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x2<br />Ethernet Cable&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;x2<br />USB-2-Serial Cable&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;x1<br />12V@4A Power Supply&nbsp; &nbsp; x1<br />PC (Ubuntu 14.04)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x1</p><p><strong>2.Getting Source Code</strong></p><p>WiTi runs open source OpenWRT. The git repositories are hosted by github.com. We can download the source code with following commands</p><p><span style="color: blue"><br />$mkdir -pv $your_own_place/WiTi<br />$cd&nbsp; $your_own_place/WiTi<br />$git clone <a href="https://github.com/mqmaker/witi-openwrt.git">https://github.com/mqmaker/witi-openwrt.git</a> openwrt<br /></span></p><p><strong>3.Customizing &amp; Compiling</strong></p><p>WiTi has no RAID Card inside, so we need md driver &amp; mdadm tool to support software RAID array.&nbsp; One of the benefit of using software RAID is that, you will never worry how to buy a specified RAID Card many years later. It’s quite simple&nbsp; to support software RAID on WiTi platform</p><p><span style="color: blue"><br />$cd openwrt<br />$make menuconfig<br /></span></p><p><strong>Add mdadm</strong></p><p><span class="postimg"><img src="https://mqmaker.com/wp-content/uploads/2015/08/openwrt_1_1.png" alt="mdadm" /></span></p><p><strong>Add md/dm-mod</strong></p><p><span class="postimg"><img src="https://mqmaker.com/wp-content/uploads/2015/08/openwrt_1_2.png" alt="kmod" /></span></p><p>We need to enable kmod-md-mod &amp; mdadm &amp; kmod-dm as shown above.</p><p>After that, our customized OpenWRT image will support software RAID.&nbsp; The whole RAID array size may be too big for us, we can split the whole RAID array to different logical volume with LVM2 tools. The following commands help you to install LVM2, iostat, vmstat, top, samba, openssh applications which are useful for our NAS server.</p><p><span style="color: blue"><br />$./scripts/feeds update -a<br />$./scripts/feeds install lvm2<br />$./scripts/feeds install procps procps-top dstat sysstat<br />$./scripts/feeds install openssh-server<br />$./scripts/feeds install luci-app-samba<br /></span></p><p>And don’t forget to enable those packages in Ncurses GUI! It’s time to start a long time compiling process.</p><p><span style="color: blue"><br /> $make V=s -j4<br /></span></p><p>Finally, we get our customized OpenWrt image!</p><p><span style="color: blue"><br />$tree -L 1 bin/ramips/<br />bin/ramips/<br />├── md5sums<br />├── openwrt-ramips-mt7621-root.squashfs<br />├── openwrt-ramips-mt7621-uImage.bin<br />├── openwrt-ramips-mt7621-vmlinux.bin<br />├── openwrt-ramips-mt7621-vmlinux.elf<br />├── openwrt-ramips-mt7621-witi-squashfs-sysupgrade.bin<br />└── packages<br /></span></p><p><strong>4.Writing Image To WiTi</strong></p><p>We can write the image to WiTi board via TLL(USB-TO-SERIAL) cable. Here we update the firmware image via web page</p><p><strong>Goto system page</strong></p><p><span class="postimg"><img src="https://mqmaker.com/wp-content/uploads/2015/08/update_firmware_1.png" alt="system page" /></span></p><br /><p><strong>Chose image to update</strong></p><p><span class="postimg"><img src="https://mqmaker.com/wp-content/uploads/2015/08/update_firmware_2.png" alt="update image" /></span></p><br /><p>The page is quite straightforward. It’s esay for us to update new firmware. After writing our image into WiTi,&nbsp; the system will reboot automatically. And we can hack into the WiTi OS now!</p><p><span class="postimg"><img src="https://mqmaker.com/wp-content/uploads/2015/08/witi_console1.png" alt="login" /></span></p> <br /><br /><p>We’ve taken a small video showing that the peak current is 3.57A@12V with two 3.5” HDD when WiTi starts up.</p><p><a href="https://www.youtube.com/embed/H0GJV7rv_S0">https://www.youtube.com/embed/H0GJV7rv_S0</a></p><br /><p><strong>5.Creating RAID Array</strong></p><p>For ssh access to WiTi, we need to set a root passwd via serial console(We can set the root password by web page GUI also).</p><p><span style="color: blue"><br />#passwd root<br />#(change-your-root-passwd-here)<br /></span></p><p>Now it’s time to create a level-1 RAID array on the two HDD. The following content is the operation commands and the output log.</p><p><span style="color: blue"><br />root@Witi:/# mdadm -Cv /dev/md0 -l1 -n2 /dev/sda1 /dev/sdb1<br />mdadm: Note: this array has metadata at the start and<br />&nbsp; &nbsp; may not be suitable as a boot device.&nbsp; If you plan to<br />&nbsp; &nbsp; store ‘/boot’ on this device please ensure that<br />&nbsp; &nbsp; your boot-loader understands md/v1.x metadata, or use<br />&nbsp; &nbsp; –metadata=0.90<br />mdadm: /dev/sdb1 appears to contain an ext2fs file system<br />&nbsp; &nbsp; size=972964864K&nbsp; mtime=Sun Aug 16 16:04:16 2015<br />mdadm: size set to 52395904K<br />Continue creating array? y<br />mdadm: Defaulting to version 1.2 metadata<br />[&nbsp; 223.224000] md: bind&lt;sda1&gt;<br />[&nbsp; 223.228000] md: bind&lt;sdb1&gt;<br />[&nbsp; 223.236000] md/raid1:md0: not clean — starting background reconstruction<br />[&nbsp; 223.248000] md/raid1:md0: active with 2 out of 2 mirrors<br />[&nbsp; 223.260000] md0: detected capacity change from 0 to 53653405696<br />mdadm: array [&nbsp; 223.272000] md: resync of RAID array md0<br />/dev/md0 started[&nbsp; 223.284000] md: minimum _guaranteed_&nbsp; speed: 1000 KB/sec/disk.<br />[&nbsp; 223.296000] md: using maximum available idle IO bandwidth (but not more than 200000 KB/sec) for resync.<br />.<br />[&nbsp; 223.316000] md: using 128k window, over a total of 52395904k.<br />root@Witi:/# cat /proc/mdstat <br />Personalities : [linear] [raid0] [raid1] [raid6] [raid5] [raid4] <br />md0 : active raid1 sdb1[1] sda1[0]<br />&nbsp; &nbsp; &nbsp; 52395904 blocks super 1.2 [2/2] [UU]<br />&nbsp; &nbsp; &nbsp; [&gt;………………..]&nbsp; resync =&nbsp; 3.0% (1579264/52395904) finish=9.6min speed=87736K/sec<br />&nbsp; &nbsp; &nbsp; <br />unused devices: &lt;none&gt;<br />root@Witi:/# cat /proc/mdstat <br />Personalities : [linear] [raid0] [raid1] [raid6] [raid5] [raid4] <br />md0 : active raid1 sdb1[1] sda1[0]<br />&nbsp; &nbsp; &nbsp; 52395904 blocks super 1.2 [2/2] [UU]<br />&nbsp; &nbsp; &nbsp; [&gt;………………..]&nbsp; resync =&nbsp; 3.8% (1993472/52395904) finish=9.6min speed=86672K/sec<br />&nbsp; &nbsp; &nbsp; <br />unused devices: &lt;none&gt;<br />root@Witi:/# cat /proc/mdstat <br />Personalities : [linear] [raid0] [raid1] [raid6] [raid5] [raid4] <br />md0 : active raid1 sdb1[1] sda1[0]<br />&nbsp; &nbsp; &nbsp; 52395904 blocks super 1.2 [2/2] [UU]<br />&nbsp; &nbsp; &nbsp; [&gt;………………..]&nbsp; resync =&nbsp; 4.2% (2246912/52395904) finish=9.6min speed=86419K/sec<br />&nbsp; &nbsp; &nbsp; <br />unused devices: &lt;none&gt;<br /></span></p><p>We can see that, the RAID array has been created and the syncing IO speed is ~86MB/s. It’s the performance without any IO performance tuning.</p><p><strong>6.Creating Logical Volume</strong></p><p>Here we create a logical volume on the RAID array, and make ext4 filesystem on it.</p><p><span style="color: blue"><br />root@Witi:/# lvm pvcreate&nbsp; /dev/md0<br />&nbsp; Physical volume “/dev/md0″ successfully created</span></p><p><span style="color: blue">root@Witi:/# lvm vgcreate myvg0 /dev/md0<br />&nbsp; Volume group “myvg0″ successfully created<br />root@Witi:/# lvm lvcreate -n lv0 -L30G myvg0<br />[&nbsp; 747.104000] bio: create slab &lt;bio-1&gt; at 1<br />&nbsp; Logical volume “lv0″ created<br /></span></p><p>Before making filesystem on the volume, we do some dd test</p><p><span style="color: blue"><br />#dd if=/dev/zero of=/dev/myvg0/lv0 bs=1M<br /></span></p><p>the iostat output:</p><p><span style="color: blue"><br />avg-cpu:&nbsp; %user&nbsp; &nbsp;%nice %system %iowait&nbsp; %steal&nbsp; &nbsp;%idle<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.17&nbsp; &nbsp; 0.00&nbsp; &nbsp;47.87&nbsp; &nbsp; 1.00&nbsp; &nbsp; 0.00&nbsp; &nbsp;50.96</span></p><p><span style="color: blue">Device:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tps&nbsp; &nbsp; kB_read/s&nbsp; &nbsp; kB_wrtn/s&nbsp; &nbsp; kB_read&nbsp; &nbsp; kB_wrtn<br />mtdblock0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock5&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock6&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />sda&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;135.67&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp;69329.33&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp;207988<br />sdb&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;134.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp;68476.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp;205428<br />md0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;16384.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp;65536.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp;196608</span></p><p><span style="color: blue">avg-cpu:&nbsp; %user&nbsp; &nbsp;%nice %system %iowait&nbsp; %steal&nbsp; &nbsp;%idle<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; 0.00&nbsp; &nbsp;48.17&nbsp; &nbsp; 1.33&nbsp; &nbsp; 0.00&nbsp; &nbsp;50.50</span></p><p><span style="color: blue">Device:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tps&nbsp; &nbsp; kB_read/s&nbsp; &nbsp; kB_wrtn/s&nbsp; &nbsp; kB_read&nbsp; &nbsp; kB_wrtn<br />mtdblock0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock5&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock6&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />sda&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;134.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp;68608.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp;205824<br />sdb&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;134.67&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp;68949.33&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp;206848<br />md0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;17408.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp;69632.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp;208896</span></p><p><span style="color: blue">avg-cpu:&nbsp; %user&nbsp; &nbsp;%nice %system %iowait&nbsp; %steal&nbsp; &nbsp;%idle<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; 0.00&nbsp; &nbsp;48.25&nbsp; &nbsp; 1.16&nbsp; &nbsp; 0.00&nbsp; &nbsp;50.58</span></p><p><span style="color: blue">Device:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tps&nbsp; &nbsp; kB_read/s&nbsp; &nbsp; kB_wrtn/s&nbsp; &nbsp; kB_read&nbsp; &nbsp; kB_wrtn<br />mtdblock0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock5&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock6&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />sda&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;136.33&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp;69802.67&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp;209408<br />sdb&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;132.33&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp;67754.67&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp;203264<br />md0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;17066.67&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp;68266.67&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp;204800</span></p><p><span style="color: blue">#dd if=/dev/myvg0/lv0 of=/dev/null bs=1M</span></p><p><span style="color: blue">avg-cpu:&nbsp; %user&nbsp; &nbsp;%nice %system %iowait&nbsp; %steal&nbsp; &nbsp;%idle<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.17&nbsp; &nbsp; 0.00&nbsp; &nbsp;28.27&nbsp; &nbsp; 0.17&nbsp; &nbsp; 0.00&nbsp; &nbsp;71.39</span></p><p><span style="color: blue">Device:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tps&nbsp; &nbsp; kB_read/s&nbsp; &nbsp; kB_wrtn/s&nbsp; &nbsp; kB_read&nbsp; &nbsp; kB_wrtn<br />mtdblock0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock5&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock6&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />sda&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;587.00&nbsp; &nbsp; &nbsp;75136.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp;225408&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />sdb&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />md0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;18773.33&nbsp; &nbsp; &nbsp;75093.33&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp;225280&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0</span></p><p><span style="color: blue">avg-cpu:&nbsp; %user&nbsp; &nbsp;%nice %system %iowait&nbsp; %steal&nbsp; &nbsp;%idle<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; 0.00&nbsp; &nbsp;28.39&nbsp; &nbsp; 0.08&nbsp; &nbsp; 0.00&nbsp; &nbsp;71.52</span></p><p><span style="color: blue">Device:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tps&nbsp; &nbsp; kB_read/s&nbsp; &nbsp; kB_wrtn/s&nbsp; &nbsp; kB_read&nbsp; &nbsp; kB_wrtn<br />mtdblock0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock5&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock6&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />sda&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;591.33&nbsp; &nbsp; &nbsp;75690.67&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp;227072&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />sdb&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />md0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;18922.67&nbsp; &nbsp; &nbsp;75690.67&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp;227072&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0</span></p><p><span style="color: blue">avg-cpu:&nbsp; %user&nbsp; &nbsp;%nice %system %iowait&nbsp; %steal&nbsp; &nbsp;%idle<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.25&nbsp; &nbsp; 0.00&nbsp; &nbsp;28.75&nbsp; &nbsp; 0.08&nbsp; &nbsp; 0.00&nbsp; &nbsp;70.92</span></p><p><span style="color: blue">Device:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tps&nbsp; &nbsp; kB_read/s&nbsp; &nbsp; kB_wrtn/s&nbsp; &nbsp; kB_read&nbsp; &nbsp; kB_wrtn<br />mtdblock0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock5&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />mtdblock6&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />sda&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;590.00&nbsp; &nbsp; &nbsp;75520.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp;226560&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />sdb&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />md0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;18880.00&nbsp; &nbsp; &nbsp;75520.00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00&nbsp; &nbsp; &nbsp;226560&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />root@Witi:/# mkfs.ext4 /dev/myvg0/lv0<br />mke2fs 1.42.4 (12-June-2012)<br />Filesystem label=<br />OS type: Linux<br />Block size=4096 (log=2)<br />Fragment size=4096 (log=2)<br />Stride=0 blocks, Stripe width=0 blocks<br />…<br />#lvm<br />#lvm&gt; lvs<br />&nbsp; LV&nbsp; &nbsp;VG&nbsp; &nbsp; Attr&nbsp; &nbsp; &nbsp; &nbsp;LSize&nbsp; Pool Origin Data%&nbsp; Move Log Cpy%Sync Convert<br />&nbsp; lv0&nbsp; myvg0 -wi-a—– 30.00g&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; lv1&nbsp; myvg0 -wi-a—– 15.00g&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />#lvm&gt; pvs<br />&nbsp; PV&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;VG&nbsp; &nbsp; Fmt&nbsp; Attr PSize&nbsp; PFree<br />&nbsp; /dev/md0&nbsp; &nbsp;myvg0 lvm2 a–&nbsp; 49.96g 4.96g<br />#lvm&gt; vgs<br />&nbsp; VG&nbsp; &nbsp; #PV #LV #SN Attr&nbsp; &nbsp;VSize&nbsp; VFree<br />&nbsp; myvg0&nbsp; &nbsp;1&nbsp; &nbsp;2&nbsp; &nbsp;0 wz–n- 49.96g 4.96g<br />#lvm&gt; quit<br />&nbsp; Exiting.<br /></span></p><p><strong>7.Setting Up Samba Service</strong></p><p>First we need to add root user to smb<br /><span style="color: blue"><br />#smbpasswd -a root<br /></span></p><p>and mount the volume</p><p><span style="color: blue"><br />#mount /dev/myvg0/lv0 /mnt/lv0<br /></span></p><p>Now we add a share folder via web page</p><p><strong>Login the web page</strong></p><p><span class="postimg"><img src="https://mqmaker.com/wp-content/uploads/2015/08/login-1.png" alt="login" /></span></p><br /><p><strong>Goto Network Shares</strong></p><p><span class="postimg"><img src="https://mqmaker.com/wp-content/uploads/2015/08/add_shares_1.png" alt="network share" /></span></p><br /><p><strong>Add a new share</strong></p><p><span class="postimg"><img src="https://mqmaker.com/wp-content/uploads/2015/08/add_share_2.png" alt="add a new share" /></span></p><br /><p>Don’t forget to enable root user</p><p><span class="postimg"><img src="https://mqmaker.com/wp-content/uploads/2015/08/add_share_3.png" alt="enable root" /></span></p> <br /><br /><p><strong>8.Test</strong></p><p><strong>Samba</strong></p><p><span class="postimg"><img src="https://mqmaker.com/wp-content/uploads/2015/08/samba_test1.png" alt="samba" /></span></p><p>16MB-20MB@samba</p><p><strong>Iperf(Wired Ethernet)</strong></p><p><span class="postimg"><img src="https://mqmaker.com/wp-content/uploads/2015/08/nat_enable.png" alt="https://mqmaker.com/wp-content/uploads/2015/08/nat_enable.png" /></span><br /><span class="postimg"><img src="https://mqmaker.com/wp-content/uploads/2015/08/witi_iperf_test_1.png" alt="https://mqmaker.com/wp-content/uploads/2015/08/witi_iperf_test_1.png" /></span></p><br /><p>From <a href="https://mqmaker.com/making-your-own-nas-with-witi-board/">https://mqmaker.com/making-your-own-nas … iti-board/</a></p>											<p class="post-edited">(Last edited by <strong>benn.huang</strong> on 25 Aug 2015, 08:55)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p289111">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">benn.huang</div>
					<div class="post-datetime">
						25 Aug 2015, 08:52					</div>
				</div>
				<div class="post-content content">
					<p><a href="http://www.cnx-software.com/2015/08/12/witi-openwrt-router-board-features-6-ethernet-ports-dual-band-wifi-sata-and-usb-3-0-ports-crowdfunding/">CNXSOFT REPORT - WiTi OpenWRT Router Board Features 6 Ethernet Ports, Dual Band WiFi, SATA and USB 3.0 Ports (Crowdfunding)</a></p>											<p class="post-edited">(Last edited by <strong>benn.huang</strong> on 25 Aug 2015, 09:00)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p289114">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">benn.huang</div>
					<div class="post-datetime">
						25 Aug 2015, 09:02					</div>
				</div>
				<div class="post-content content">
					<p><a href="https://forum.syncthing.net/t/successful-ported-syncthing-to-witi-board-openwrt-mips-cpu-880mhz-256mb-sata3-0/5465">It&#039;s possible to run syncthing</a></p>											<p class="post-edited">(Last edited by <strong>benn.huang</strong> on 25 Aug 2015, 09:03)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p289125">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">alphasparc</div>
					<div class="post-datetime">
						25 Aug 2015, 11:05					</div>
				</div>
				<div class="post-content content">
					<p>Can you run this benchmark with and without HW NAT?<br />wiki.openwrt.org/inbox/benchmark.nat<br />Also show us the HW NAT config&nbsp; page?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p289131">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">benn.huang</div>
					<div class="post-datetime">
						25 Aug 2015, 12:28					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>alphasparc wrote:</cite><blockquote><p>Can you run this benchmark with and without HW NAT?<br />wiki.openwrt.org/inbox/benchmark.nat<br />Also show us the HW NAT config&nbsp; page?</p></blockquote></div><p>The NAT may not work on my test. I just simply enable it in MTK openwrt menuconfig.<br />When I check the kernel config, I find the NAT option still be disabled <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p>											<p class="post-edited">(Last edited by <strong>benn.huang</strong> on 25 Aug 2015, 12:31)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p289133">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">alphasparc</div>
					<div class="post-datetime">
						25 Aug 2015, 13:04					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>benn.huang wrote:</cite><blockquote><div class="quotebox"><cite>alphasparc wrote:</cite><blockquote><p>Can you run this benchmark with and without HW NAT?<br />wiki.openwrt.org/inbox/benchmark.nat<br />Also show us the HW NAT config&nbsp; page?</p></blockquote></div><p>The NAT may not work on my test. I just simply enable it in MTK openwrt menuconfig.<br />When I check the kernel config, I find the NAT option still be disabled <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p></blockquote></div><p>That means HW NAT is not supported properly, it is still doing NAT in software.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p289252">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">benn.huang</div>
					<div class="post-datetime">
						26 Aug 2015, 11:45					</div>
				</div>
				<div class="post-content content">
					<p>I have compiled &amp; loaded the hw_nat kernel module. Also I change another linux pc to do the iperf test.</p><p>iperf -c 192.168.100.1 -t 20&nbsp; -w 40k</p><p>output:<br /><span style="color: blue"><br />[&nbsp; 3] 297.0-300.0 sec&nbsp; &nbsp;141 MBytes&nbsp; &nbsp;394 Mbits/sec<br />[&nbsp; 3] 300.0-303.0 sec&nbsp; &nbsp;142 MBytes&nbsp; &nbsp;396 Mbits/sec<br />[&nbsp; 3] 303.0-306.0 sec&nbsp; &nbsp;141 MBytes&nbsp; &nbsp;395 Mbits/sec<br />[&nbsp; 3] 306.0-309.0 sec&nbsp; &nbsp;142 MBytes&nbsp; &nbsp;396 Mbits/sec<br />[&nbsp; 3] 309.0-312.0 sec&nbsp; &nbsp;142 MBytes&nbsp; &nbsp;396 Mbits/sec<br />[&nbsp; 3] 312.0-315.0 sec&nbsp; &nbsp;141 MBytes&nbsp; &nbsp;394 Mbits/sec<br />[&nbsp; 3] 315.0-318.0 sec&nbsp; &nbsp;142 MBytes&nbsp; &nbsp;397 Mbits/sec<br />[&nbsp; 3] 318.0-321.0 sec&nbsp; &nbsp;141 MBytes&nbsp; &nbsp;394 Mbits/sec<br />[&nbsp; 3] 321.0-324.0 sec&nbsp; &nbsp;141 MBytes&nbsp; &nbsp;395 Mbits/sec<br />[&nbsp; 3] 324.0-327.0 sec&nbsp; &nbsp;142 MBytes&nbsp; &nbsp;397 Mbits/sec<br />[&nbsp; 3] 327.0-330.0 sec&nbsp; &nbsp;142 MBytes&nbsp; &nbsp;396 Mbits/sec<br />[&nbsp; 3] 330.0-333.0 sec&nbsp; &nbsp;142 MBytes&nbsp; &nbsp;397 Mbits/sec<br />[&nbsp; 3] 333.0-336.0 sec&nbsp; &nbsp;141 MBytes&nbsp; &nbsp;395 Mbits/sec<br />[&nbsp; 3] 336.0-339.0 sec&nbsp; &nbsp;142 MBytes&nbsp; &nbsp;396 Mbits/sec<br />[&nbsp; 3] 339.0-342.0 sec&nbsp; &nbsp;142 MBytes&nbsp; &nbsp;397 Mbits/sec<br />[&nbsp; 3] 342.0-345.0 sec&nbsp; &nbsp;141 MBytes&nbsp; &nbsp;394 Mbits/sec<br />[&nbsp; 3] 345.0-348.0 sec&nbsp; &nbsp;142 MBytes&nbsp; &nbsp;396 Mbits/sec<br />[&nbsp; 3] 348.0-351.0 sec&nbsp; &nbsp;141 MBytes&nbsp; &nbsp;395 Mbits/sec<br />[&nbsp; 3] 351.0-354.0 sec&nbsp; &nbsp;142 MBytes&nbsp; &nbsp;396 Mbits/sec<br />[&nbsp; 3] 354.0-357.0 sec&nbsp; &nbsp;142 MBytes&nbsp; &nbsp;397 Mbits/sec<br />[&nbsp; 3] 357.0-360.0 sec&nbsp; &nbsp;141 MBytes&nbsp; &nbsp;394 Mbits/sec<br /></span></p><p>WiTi&#039;s top output</p><p><span style="color: blue"><br />top - 08:38:32 up&nbsp; 1:44,&nbsp; 0 users,&nbsp; load average: 2.14, 1.79, 1.53<br />Tasks:&nbsp; 73 total,&nbsp; &nbsp;3 running,&nbsp; 70 sleeping,&nbsp; &nbsp;0 stopped,&nbsp; &nbsp;0 zombie<br />Cpu0&nbsp; :&nbsp; 0.0%us,&nbsp; 0.0%sy,&nbsp; 0.0%ni,&nbsp; 0.0%id,&nbsp; 0.0%wa,&nbsp; 0.0%hi,100.0%s<br />Cpu1&nbsp; :&nbsp; 0.7%us,&nbsp; 0.7%sy,&nbsp; 0.0%ni, 98.7%id,&nbsp; 0.0%wa,&nbsp; 0.0%hi,&nbsp; 0.0%s<br />Cpu2&nbsp; :&nbsp; 0.0%us,&nbsp; 0.3%sy,&nbsp; 0.0%ni, 99.7%id,&nbsp; 0.0%wa,&nbsp; 0.0%hi,&nbsp; 0.0%s</span><br /><span style="color: #FF0000">Cpu3&nbsp; :&nbsp; 0.0%us, 99.0%sy,&nbsp; 0.0%ni,&nbsp; 1.0%id,&nbsp; 0.0%wa,&nbsp; 0.0%hi,&nbsp; 0.0%s </span><span style="color: blue"><br />Mem:&nbsp; &nbsp; 255596k total,&nbsp; &nbsp; 60748k used,&nbsp; &nbsp;194848k free,&nbsp; &nbsp; &nbsp;7092k buf<br />Swap:&nbsp; &nbsp; &nbsp; &nbsp; 0k total,&nbsp; &nbsp; &nbsp; &nbsp; 0k used,&nbsp; &nbsp; &nbsp; &nbsp; 0k free,&nbsp; &nbsp; 21960k cac</span></p><p><span style="color: blue">&nbsp; PID USER&nbsp; &nbsp; &nbsp; PR&nbsp; NI&nbsp; VIRT&nbsp; RES&nbsp; SHR S %CPU %MEM&nbsp; &nbsp; TIME+&nbsp; COMMAND<br />&nbsp; &nbsp; 3 root&nbsp; &nbsp; &nbsp; 20&nbsp; &nbsp;0&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; 0&nbsp; &nbsp; 0 R&nbsp; &nbsp;99&nbsp; 0.0&nbsp; 30:58.44 ksoftir</span><br /><span style="color: #FF0000">8137 root&nbsp; &nbsp; &nbsp; 20&nbsp; &nbsp;0&nbsp; 1360&nbsp; 600&nbsp; 396 R&nbsp; &nbsp;99&nbsp; 0.2&nbsp; &nbsp;9:00.32 iperf&nbsp; </span><span style="color: blue"><br /> 8372 root&nbsp; &nbsp; &nbsp; 20&nbsp; &nbsp;0&nbsp; 1340&nbsp; 592&nbsp; 432 R&nbsp; &nbsp; 1&nbsp; 0.2&nbsp; &nbsp;0:04.47 top&nbsp; &nbsp; <br />&nbsp; 128 root&nbsp; &nbsp; &nbsp; 20&nbsp; &nbsp;0&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; 0&nbsp; &nbsp; 0 S&nbsp; &nbsp; 0&nbsp; 0.0&nbsp; &nbsp;0:15.41 kworker<br />&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp; 20&nbsp; &nbsp;0&nbsp; 1428&nbsp; 664&nbsp; 464 S&nbsp; &nbsp; 0&nbsp; 0.3&nbsp; &nbsp;0:03.43 procd&nbsp; <br />&nbsp; &nbsp; 2 root&nbsp; &nbsp; &nbsp; 20&nbsp; &nbsp;0&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; 0&nbsp; &nbsp; 0 S&nbsp; &nbsp; 0&nbsp; 0.0&nbsp; &nbsp;0:00.00 kthread<br />&nbsp; &nbsp; 7 root&nbsp; &nbsp; &nbsp; RT&nbsp; &nbsp;0&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; 0&nbsp; &nbsp; 0 S&nbsp; &nbsp; 0&nbsp; 0.0&nbsp; &nbsp;0:02.10 migrati<br />&nbsp; &nbsp; 4 root&nbsp; &nbsp; &nbsp; 20&nbsp; &nbsp;0&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; 0&nbsp; &nbsp; 0 S&nbsp; &nbsp; 0&nbsp; 0.0&nbsp; &nbsp;0:00.00 kworker<br />&nbsp; &nbsp; 5 root&nbsp; &nbsp; &nbsp; &nbsp;0 -20&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; 0&nbsp; &nbsp; 0 S&nbsp; &nbsp; 0&nbsp; 0.0&nbsp; &nbsp;0:00.02 kworker<br />&nbsp; &nbsp;10 root&nbsp; &nbsp; &nbsp; RT&nbsp; &nbsp;0&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; 0&nbsp; &nbsp; 0 S&nbsp; &nbsp; 0&nbsp; 0.0&nbsp; &nbsp;0:02.17 migrati<br />&nbsp; &nbsp;11 root&nbsp; &nbsp; &nbsp; 20&nbsp; &nbsp;0&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; 0&nbsp; &nbsp; 0 S&nbsp; &nbsp; 0&nbsp; 0.0&nbsp; &nbsp;0:00.28 ksoftir<br />&nbsp; &nbsp; 8 root&nbsp; &nbsp; &nbsp; 20&nbsp; &nbsp;0&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; 0&nbsp; &nbsp; 0 S&nbsp; &nbsp; 0&nbsp; 0.0&nbsp; &nbsp;0:00.00 rcu_bh <br /></span></p><p>lsmod</p><p><span style="color: blue"><br />root@Witi-1:~# lsmod<br />ahci&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;11009&nbsp; 0 <br />arc4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1504&nbsp; 0 <br />async_memcpy&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;606&nbsp; 1 raid456<br />async_pq&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1764&nbsp; 1 raid456<br />async_raid6_recov&nbsp; &nbsp; &nbsp; &nbsp;1073&nbsp; 1 raid456<br />async_tx&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;953&nbsp; 5 raid456<br />async_xor&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1081&nbsp; 2 raid456<br />cifs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 214798&nbsp; 0 <br />cramfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;39156&nbsp; 0 <br />crc16&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 999&nbsp; 1 ext4<br />crc_ccitt&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1003&nbsp; 1 ppp_async<br />des_generic&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 18291&nbsp; 0 <br />dm_crypt&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;16697&nbsp; 0 <br />dm_log&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 8872&nbsp; 2 dm_mirror<br />dm_mirror&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 13552&nbsp; 0 <br />dm_mod&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;72763&nbsp; 3 dm_crypt<br />dm_region_hash&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 7759&nbsp; 1 dm_mirror<br />dns_resolver&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4112&nbsp; 0 <br />ecb&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1753&nbsp; 0 <br />exfat&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;101837&nbsp; 0 <br />exportfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3418&nbsp; 1 nfsd<br />ext4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 355708&nbsp; 0 <br />fat&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 52943&nbsp; 2 msdos<br />fscache&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 53820&nbsp; 0 <br />fuse&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;79248&nbsp; 0 <br />hmac&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2777&nbsp; 0 </span><br /><span style="color: #FF0000">hw_nat&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;31602&nbsp; 0 </span><span style="color: blue"><br />ip6_tables&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;10563&nbsp; 3 ip6table_raw<br />ip6t_REJECT&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2636&nbsp; 2 <br />ip6table_filter&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 755&nbsp; 1 <br />ip6table_mangle&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1171&nbsp; 1 <br />ip6table_raw&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;714&nbsp; 1 <br />ip_set&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;23569 12 xt_set<br />ip_set_bitmap_ip&nbsp; &nbsp; &nbsp; &nbsp; 7055&nbsp; 0 <br />ip_set_bitmap_ipmac&nbsp; &nbsp; &nbsp;6921&nbsp; 0 <br />ip_set_bitmap_port&nbsp; &nbsp; &nbsp; 6315&nbsp; 0 <br />ip_set_hash_ip&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;17534&nbsp; 0 <br />ip_set_hash_ipport&nbsp; &nbsp; &nbsp;18462&nbsp; 0 <br />ip_set_hash_ipportip&nbsp; &nbsp;19326&nbsp; 0 <br />ip_set_hash_ipportnet&nbsp; &nbsp;24818&nbsp; 0 <br />ip_set_hash_net&nbsp; &nbsp; &nbsp; &nbsp; 21482&nbsp; 0 <br />ip_set_hash_netiface&nbsp; &nbsp;23925&nbsp; 0 <br />ip_set_hash_netport&nbsp; &nbsp; 23370&nbsp; 0 <br />ip_set_list_set&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;7802&nbsp; 0 <br />ip_tables&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 10360&nbsp; 4 iptable_nat<br />ip_tunnel&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 11642&nbsp; 1 sit<br />ipt_ECN&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1488&nbsp; 0 <br />ipt_MASQUERADE&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1410&nbsp; 1 <br />ipt_REJECT&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1977&nbsp; 2 <br />iptable_filter&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;800&nbsp; 1 <br />iptable_mangle&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1072&nbsp; 1 <br />iptable_nat&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1961&nbsp; 1 <br />iptable_raw&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 759&nbsp; 1 <br />jbd2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;67502&nbsp; 1 ext4<br />libahci&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 19778&nbsp; 1 ahci<br />libata&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 139159&nbsp; 2 ahci<br />linear&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3887&nbsp; 0 <br />lockd&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 62670&nbsp; 3 nfsd<br />loop&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;14861&nbsp; 0 <br />mbcache&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;5450&nbsp; 1 ext4<br />md4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3017&nbsp; 0 <br />md5&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1553&nbsp; 0 <br />md_mod&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 120062&nbsp; 4 raid456<br />msdos&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;7142&nbsp; 0 <br />mt76x2e&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1281983&nbsp; 1 <br />nf_conntrack&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;51983 17 iptable_nat<br />nf_conntrack_ftp&nbsp; &nbsp; &nbsp; &nbsp; 5579&nbsp; 1 nf_nat_ftp<br />nf_conntrack_ipv4&nbsp; &nbsp; &nbsp; &nbsp;5862 10 <br />nf_conntrack_ipv6&nbsp; &nbsp; &nbsp; &nbsp;7035&nbsp; 3 <br />nf_conntrack_irc&nbsp; &nbsp; &nbsp; &nbsp; 3019&nbsp; 1 nf_nat_irc<br />nf_defrag_ipv4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;843&nbsp; 1 nf_conntrack_ipv4<br />nf_defrag_ipv6&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;13930&nbsp; 1 nf_conntrack_ipv6<br />nf_nat&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;11131&nbsp; 7 iptable_nat<br />nf_nat_ftp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1364&nbsp; 0 <br />nf_nat_ipv4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3029&nbsp; 1 iptable_nat<br />nf_nat_irc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1070&nbsp; 0 <br />nfnetlink&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3026&nbsp; 1 ip_set<br />nfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;128357&nbsp; 1 nfsv3<br />nfsd&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;89014&nbsp; 0 <br />nfsv3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 21024&nbsp; 0 <br />nls_base&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 5417 11 exfat<br />nls_cp437&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4497&nbsp; 0 <br />nls_cp850&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3729&nbsp; 0 <br />nls_iso8859_1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2965&nbsp; 0 <br />nls_iso8859_15&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3478&nbsp; 0 <br />nls_utf8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;944&nbsp; 0 <br />ntfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 101101&nbsp; 0 <br />ppp_async&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8082&nbsp; 0 <br />ppp_generic&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 24058&nbsp; 3 pppoe<br />pppoe&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 10043&nbsp; 0 <br />pppox&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1410&nbsp; 1 pppoe<br />raid0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8107&nbsp; 0 <br />raid1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 35642&nbsp; 0 <br />raid456&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 79376&nbsp; 0 <br />raid6_pq&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;83515&nbsp; 2 async_raid6_recov<br />ralink_wdt&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2103&nbsp; 0 <br />scsi_mod&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;90190&nbsp; 4 sg<br />sd_mod&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;29880&nbsp; 0 <br />sg&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;23934&nbsp; 0 <br />sha256_generic&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 9484&nbsp; 0 <br />sit&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 13412&nbsp; 0 <br />slhc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4649&nbsp; 1 ppp_generic<br />sunrpc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 179187&nbsp; 4 nfsd<br />tunnel4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2013&nbsp; 1 sit<br />usb_common&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1144&nbsp; 1 usbcore<br />usb_storage&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 39183&nbsp; 0 <br />usbcore&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;131823&nbsp; 2 usb_storage<br />vfat&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 9396&nbsp; 0 <br />x_tables&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;13278 41 ipt_MASQUERADE<br />xhci_hcd&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;90512&nbsp; 0 <br />xor&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;5932&nbsp; 1 async_xor<br />xt_CLASSIFY&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 637&nbsp; 0 <br />xt_CT&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3226&nbsp; 0 <br />xt_DSCP&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1643&nbsp; 0 <br />xt_HL&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1459&nbsp; 0 <br />xt_LOG&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;10614&nbsp; 0 <br />xt_REDIRECT&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1286&nbsp; 0 <br />xt_TCPMSS&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3055&nbsp; 2 <br />xt_comment&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;555 63 <br />xt_connbytes&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1735&nbsp; 0 <br />xt_connlimit&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2990&nbsp; 0 <br />xt_connmark&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1317&nbsp; 2 <br />xt_conntrack&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2505 10 <br />xt_dscp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1107&nbsp; 0 <br />xt_ecn&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1458&nbsp; 0 <br />xt_helper&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1019&nbsp; 0 <br />xt_hl&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 857&nbsp; 0 <br />xt_length&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 772&nbsp; 1 <br />xt_limit&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1284 20 <br />xt_mac&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;675&nbsp; 0 <br />xt_mark&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 749 40 <br />xt_multiport&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1334&nbsp; 4 <br />xt_nat&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1385&nbsp; 0 <br />xt_recent&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;7661&nbsp; 0 <br />xt_set&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 5200&nbsp; 0 <br />xt_state&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;839&nbsp; 0 <br />xt_statistic&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1031&nbsp; 0 <br />xt_tcpmss&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1049&nbsp; 0 <br />xt_tcpudp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1847&nbsp; 8 <br />xt_time&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1795&nbsp; 0 <br />zlib_deflate&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;19219&nbsp; 0 <br />zlib_inflate&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;12580&nbsp; 1 cramfs<br /></span></p><br /><p>1. hwnat has been enabled (Do I need more configuration?)<br />2. iperf result will depend on the test PC<br />3. iperf has not make use of the multi processor</p>											<p class="post-edited">(Last edited by <strong>benn.huang</strong> on 26 Aug 2015, 11:52)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p289254">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">zloop</div>
					<div class="post-datetime">
						26 Aug 2015, 12:17					</div>
				</div>
				<div class="post-content content">
					<p>- there is iperf-mt<br />- measuring between pc1 (WAN port) and pc2(LAN port) with enabled NAT translation (w/w-o hwnat) and then with routing should result in different performance numbers without router CPU limit<br />- some ppl use PPPoE on WAN - some hw has very reduced throughput in this case</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p289255">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">augustus_meyer</div>
					<div class="post-datetime">
						26 Aug 2015, 12:28					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>zloop wrote:</cite><blockquote><p>- some ppl use PPPoE on WAN</p></blockquote></div><p>Standard protocol for DSL-connections in Germany.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p289262">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">nitroshift</div>
					<div class="post-datetime">
						26 Aug 2015, 15:18					</div>
				</div>
				<div class="post-content content">
					<p>@benn.huang</p><p>HW NAT module does not work on its own. It integrates some hooks in netfilter so any traffic in an already established connection does not pass through the main CPU any longer.</p><p>nitroshift</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p289269">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">benn.huang</div>
					<div class="post-datetime">
						26 Aug 2015, 15:45					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nitroshift wrote:</cite><blockquote><p>@benn.huang</p><p>HW NAT module does not work on its own. It integrates some hooks in netfilter so any traffic in an already established connection does not pass through the main CPU any longer.</p><p>nitroshift</p></blockquote></div><p>I still don&#039;t know how to test the max throughput. Please when you get the board, help me to test it <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p289270">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">benn.huang</div>
					<div class="post-datetime">
						26 Aug 2015, 15:45					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m quite new to openwrt world <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p289272">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">makarel</div>
					<div class="post-datetime">
						26 Aug 2015, 15:56					</div>
				</div>
				<div class="post-content content">
					<p>the extent the marketing goes.. rolf</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p289275">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">nitroshift</div>
					<div class="post-datetime">
						26 Aug 2015, 16:00					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>benn.huang wrote:</cite><blockquote><p>&lt;SNIP&gt;. Please when you get the board, help me to test it <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></p></blockquote></div><p>Sure will do <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>nitroshift</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p289276">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">alphasparc</div>
					<div class="post-datetime">
						26 Aug 2015, 16:01					</div>
				</div>
				<div class="post-content content">
					<p>If HW NAT is working Throughput should be 1Gbps at least without question.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p289277">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">nitroshift</div>
					<div class="post-datetime">
						26 Aug 2015, 16:03					</div>
				</div>
				<div class="post-content content">
					<p>@makarel</p><p>care to join #openwrt on freenode IRC?</p><p>nitroshift</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p289291">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">makarel</div>
					<div class="post-datetime">
						26 Aug 2015, 17:35					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nitroshift wrote:</cite><blockquote><p>@makarel</p><p>care to join #openwrt on freenode IRC?</p><p>nitroshift</p></blockquote></div><p>im on advanced noob division.. long way till dev section<br />for now im just browsing OWRT forum/wiki.. mostly tryin to get a grip on linux</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p289455">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">nitroshift</div>
					<div class="post-datetime">
						27 Aug 2015, 21:49					</div>
				</div>
				<div class="post-content content">
					<p>After I receive the board I will start looking how the HW nat module interacts with the network stack.</p><p>@benn.huang</p><p>Your speed tests are correct, it seems that the hardware nat module isn&#039;t working and all network traffic is being handled by the main CPU.</p><p>nitroshift</p>											<p class="post-edited">(Last edited by <strong>nitroshift</strong> on 27 Aug 2015, 22:36)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p292678">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						20 Sep 2015, 16:08					</div>
				</div>
				<div class="post-content content">
					<p>I am just curious why use samba instead of NFS.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>