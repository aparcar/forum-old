<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Need help compiling OpenWRT with language support</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 23 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p249480">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">camaradadennis</div>
					<div class="post-datetime">
						7 Oct 2014, 03:26					</div>
				</div>
				<div class="post-content content">
					<p>Hello all. I&#039;m very pleased to have discovered OpenWRT and i am already using it on my TP-LINK WDR3600 router at home.</p><p>However, when trying to compile Barrier Breaker from source, with &quot;Full language support&quot;, in the global build settings ticked, i always end with the following error:</p><div class="codebox"><pre><code>make -r world: build failed. Please re-run make with V=s to see what&#039;s going on
/home/camarada/Modelos/openwrt/include/toplevel.mk:171: recipe for target &#039;world&#039; failed
make: *** [world] Error 1</code></pre></div><p>With make V=s, the error part of the output is like this:</p><div class="codebox"><pre><code>make[3]: Entering directory &#039;/home/camarada/Modelos/openwrt/toolchain/uClibc/headers&#039;
PATH=&#039;/home/camarada/Modelos/openwrt/staging_dir/toolchain-mips_34kc_gcc-4.8-linaro_uClibc-0.9.33.2/bin:/home/camarada/Modelos/openwrt/staging_dir/host/bin:/home/camarada/Modelos/openwrt/staging_dir/toolchain-mips_34kc_gcc-4.8-linaro_uClibc-0.9.33.2/bin:/home/camarada/Modelos/openwrt/staging_dir/host/bin:/home/camarada/Modelos/openwrt/staging_dir/toolchain-mips_34kc_gcc-4.8-linaro_uClibc-0.9.33.2/bin:/home/camarada/Modelos/openwrt/staging_dir/host/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games&#039; make -C /home/camarada/Modelos/openwrt/build_dir/toolchain-mips_34kc_gcc-4.8-linaro_uClibc-0.9.33.2/uClibc-0.9.33.2 PREFIX=&quot;/home/camarada/Modelos/openwrt/build_dir/toolchain-mips_34kc_gcc-4.8-linaro_uClibc-0.9.33.2/uClibc-dev/&quot; DEVEL_PREFIX=/ RUNTIME_PREFIX=&quot;/home/camarada/Modelos/openwrt/build_dir/toolchain-mips_34kc_gcc-4.8-linaro_uClibc-0.9.33.2/uClibc-dev/&quot; HOSTCC=&quot;gcc&quot; CC=&quot;mips-openwrt-linux-uclibc-gcc&quot; CPU_CFLAGS=&quot;-Os -pipe -mno-branch-likely -mips32r2 -mtune=34kc -fno-caller-saves -fhonour-copts -Wno-error=unused-but-set-variable -msoft-float&quot; ARCH=&quot;&quot;mips&quot;&quot; pregen install_headers
make[4]: Entering directory &#039;/home/camarada/Modelos/openwrt/build_dir/toolchain-mips_34kc_gcc-4.8-linaro_uClibc-0.9.33.2/uClibc-0.9.33.2&#039;
gcc extra/locale/gen_ldc.c  -o extra/locale/gen_ldc    -Os -Wall  -I./extra/locale -D__WCHAR_ENABLED=1
In file included from extra/locale/gen_ldc.c:45:0:
extra/locale/locale_mmap.h:11:45: error: &#039;__LOCALE_DATA_WCctype_II_LEN&#039; undeclared here (not in a function)
 #define __LOCALE_DATA_WCctype_TBL_LEN      (__LOCALE_DATA_WCctype_II_LEN + __LOCALE_DATA_WCctype_TI_LEN + __LOCALE_DATA_WCctype_UT_LEN)
                                             ^
extra/locale/locale_mmap.h:46:32: note: in expansion of macro &#039;__LOCALE_DATA_WCctype_TBL_LEN&#039;
  const unsigned char tblwctype[__LOCALE_DATA_WCctype_TBL_LEN];
                                ^
extra/locale/locale_mmap.h:11:76: error: &#039;__LOCALE_DATA_WCctype_TI_LEN&#039; undeclared here (not in a function)
 #define __LOCALE_DATA_WCctype_TBL_LEN      (__LOCALE_DATA_WCctype_II_LEN + __LOCALE_DATA_WCctype_TI_LEN + __LOCALE_DATA_WCctype_UT_LEN)
                                                                            ^
extra/locale/locale_mmap.h:46:32: note: in expansion of macro &#039;__LOCALE_DATA_WCctype_TBL_LEN&#039;
  const unsigned char tblwctype[__LOCALE_DATA_WCctype_TBL_LEN];
                                ^
extra/locale/locale_mmap.h:11:107: error: &#039;__LOCALE_DATA_WCctype_UT_LEN&#039; undeclared here (not in a function)
 #define __LOCALE_DATA_WCctype_TBL_LEN      (__LOCALE_DATA_WCctype_II_LEN + __LOCALE_DATA_WCctype_TI_LEN + __LOCALE_DATA_WCctype_UT_LEN)
                                                                                                           ^
extra/locale/locale_mmap.h:46:32: note: in expansion of macro &#039;__LOCALE_DATA_WCctype_TBL_LEN&#039;
  const unsigned char tblwctype[__LOCALE_DATA_WCctype_TBL_LEN];
                                ^
In file included from extra/locale/gen_ldc.c:45:0:
extra/locale/locale_mmap.h:12:45: error: &#039;__LOCALE_DATA_WCuplow_II_LEN&#039; undeclared here (not in a function)
 #define __LOCALE_DATA_WCuplow_TBL_LEN      (__LOCALE_DATA_WCuplow_II_LEN + __LOCALE_DATA_WCuplow_TI_LEN + __LOCALE_DATA_WCuplow_UT_LEN)
                                             ^
extra/locale/locale_mmap.h:47:32: note: in expansion of macro &#039;__LOCALE_DATA_WCuplow_TBL_LEN&#039;
  const unsigned char tblwuplow[__LOCALE_DATA_WCuplow_TBL_LEN];
                                ^
extra/locale/locale_mmap.h:12:76: error: &#039;__LOCALE_DATA_WCuplow_TI_LEN&#039; undeclared here (not in a function)
 #define __LOCALE_DATA_WCuplow_TBL_LEN      (__LOCALE_DATA_WCuplow_II_LEN + __LOCALE_DATA_WCuplow_TI_LEN + __LOCALE_DATA_WCuplow_UT_LEN)
                                                                            ^
extra/locale/locale_mmap.h:47:32: note: in expansion of macro &#039;__LOCALE_DATA_WCuplow_TBL_LEN&#039;
  const unsigned char tblwuplow[__LOCALE_DATA_WCuplow_TBL_LEN];
                                ^
extra/locale/locale_mmap.h:12:107: error: &#039;__LOCALE_DATA_WCuplow_UT_LEN&#039; undeclared here (not in a function)
 #define __LOCALE_DATA_WCuplow_TBL_LEN      (__LOCALE_DATA_WCuplow_II_LEN + __LOCALE_DATA_WCuplow_TI_LEN + __LOCALE_DATA_WCuplow_UT_LEN)
                                                                                                           ^
extra/locale/locale_mmap.h:47:32: note: in expansion of macro &#039;__LOCALE_DATA_WCuplow_TBL_LEN&#039;
  const unsigned char tblwuplow[__LOCALE_DATA_WCuplow_TBL_LEN];
                                ^
extra/locale/locale_mmap.h:13:49: error: &#039;__LOCALE_DATA_WCuplow_diffs&#039; undeclared here (not in a function)
 #define __LOCALE_DATA_WCuplow_diff_TBL_LEN (2 * __LOCALE_DATA_WCuplow_diffs)
                                                 ^
extra/locale/locale_mmap.h:48:31: note: in expansion of macro &#039;__LOCALE_DATA_WCuplow_diff_TBL_LEN&#039;
  const int16_t tblwuplow_diff[__LOCALE_DATA_WCuplow_diff_TBL_LEN];
                               ^
extra/locale/gen_ldc.c: In function &#039;main&#039;:
extra/locale/gen_ldc.c:195:14: error: &#039;__LOCALE_DATA_WCctype_data&#039; undeclared (first use in this function)
  out_uc(lso, __LOCALE_DATA_WCctype_data, __LOCALE_DATA_WCctype_TBL_LEN, &quot;tblwctype&quot;);
              ^
extra/locale/gen_ldc.c:195:14: note: each undeclared identifier is reported only once for each function it appears in
extra/locale/gen_ldc.c:196:14: error: &#039;__LOCALE_DATA_WCuplow_data&#039; undeclared (first use in this function)
  out_uc(lso, __LOCALE_DATA_WCuplow_data, __LOCALE_DATA_WCuplow_TBL_LEN, &quot;tblwuplow&quot;);
              ^
extra/locale/gen_ldc.c:197:15: error: &#039;__LOCALE_DATA_WCuplow_diff_data&#039; undeclared (first use in this function)
  out_i16(lso, __LOCALE_DATA_WCuplow_diff_data, __LOCALE_DATA_WCuplow_diff_TBL_LEN, &quot;tblwuplow_diff&quot;);
               ^
extra/locale/Makefile.in:151: recipe for target &#039;extra/locale/gen_ldc&#039; failed
make[4]: *** [extra/locale/gen_ldc] Error 1
make[4]: Leaving directory &#039;/home/camarada/Modelos/openwrt/build_dir/toolchain-mips_34kc_gcc-4.8-linaro_uClibc-0.9.33.2/uClibc-0.9.33.2&#039;
Makefile:25: recipe for target &#039;/home/camarada/Modelos/openwrt/staging_dir/toolchain-mips_34kc_gcc-4.8-linaro_uClibc-0.9.33.2/stamp/.uclibc_headers_installed&#039; failed
make[3]: *** [/home/camarada/Modelos/openwrt/staging_dir/toolchain-mips_34kc_gcc-4.8-linaro_uClibc-0.9.33.2/stamp/.uclibc_headers_installed] Error 2
make[3]: Leaving directory &#039;/home/camarada/Modelos/openwrt/toolchain/uClibc/headers&#039;
toolchain/Makefile:86: recipe for target &#039;toolchain/uClibc/headers/install&#039; failed
make[2]: *** [toolchain/uClibc/headers/install] Error 2
make[2]: Leaving directory &#039;/home/camarada/Modelos/openwrt&#039;
toolchain/Makefile:85: recipe for target &#039;/home/camarada/Modelos/openwrt/staging_dir/toolchain-mips_34kc_gcc-4.8-linaro_uClibc-0.9.33.2/stamp/.toolchain_install&#039; failed
make[1]: *** [/home/camarada/Modelos/openwrt/staging_dir/toolchain-mips_34kc_gcc-4.8-linaro_uClibc-0.9.33.2/stamp/.toolchain_install] Error 2
make[1]: Leaving directory &#039;/home/camarada/Modelos/openwrt&#039;
/home/camarada/Modelos/openwrt/include/toplevel.mk:171: recipe for target &#039;world&#039; failed
make: *** [world] Error 2</code></pre></div><p>When i try to compile without this option, it all goes well. I&#039;m trying to deploy openwrt with owncloud on my TP-LINK WDR3600 router...</p><p>Can anyone point me why i get this error?</p><p>Many thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p249515">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">_DS_</div>
					<div class="post-datetime">
						7 Oct 2014, 09:52					</div>
				</div>
				<div class="post-content content">
					<p><a href="https://dev.openwrt.org/ticket/13095">https://dev.openwrt.org/ticket/13095</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p249549">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">camaradadennis</div>
					<div class="post-datetime">
						7 Oct 2014, 15:58					</div>
				</div>
				<div class="post-content content">
					<p>Many thanks!<br />I know i can apply the patch by myself, just have to do a little diging about how it is done. But, in a question related to development process, isn&#039;t the patch going to be merged into the main code?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p249585">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">_DS_</div>
					<div class="post-datetime">
						7 Oct 2014, 19:23					</div>
				</div>
				<div class="post-content content">
					<p>I have no idea, just did quick goolging. You can ask devs in maillist.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p250077">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">camaradadennis</div>
					<div class="post-datetime">
						11 Oct 2014, 00:14					</div>
				</div>
				<div class="post-content content">
					<p>I need help applying the patch. To recap, i&#039;m trying to compile Barrier Breaker with Full Language Support. Compilation goes well without this option. There is a patch said to correct this in <a href="http://patchwork.openwrt.org/patch/6298/.">http://patchwork.openwrt.org/patch/6298/.</a></p><p>However, due to my lack of knowledge in programing, i can&#039;t get it to work and therefore ask for help from the community here.</p><p>I&#039;m trying to follow instructions in <a href="http://wiki.openwrt.org/doc/devel/patches.">http://wiki.openwrt.org/doc/devel/patches.</a></p><p>I&#039;ve tried to simple rename the patch &quot;991-gen_wctype.patch&quot; and put it in ~/openwrt/toolchain/uClibc/patches-0.9.33.2/ but it was a no go.</p><p>Next, i tried to run (with quilt installed and configured according to wiki instructions)<br /></p><div class="codebox"><pre><code>make toolchain/uClibc/{clean,prepare} V=99 QUILT=1
cd build_dir/toolchain-mips_34kc_gcc-4.8-linaro_uClibc-0.9.33.2/uClibc/
quilt push -a</code></pre></div><p>Output for the last command shows </p><div class="codebox"><pre><code>File series fully applied, ends at patch 991-gen_wctype.patch</code></pre></div><p>But then when i </p><div class="codebox"><pre><code>cd ../../.. &amp;&amp; make</code></pre></div><p> i still get the same error...</p><p>What else should i do?</p><p>thanks in advance</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p250081">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						11 Oct 2014, 01:20					</div>
				</div>
				<div class="post-content content">
					<p>There should be a lot of ways to perform such a patch. However, using <a href="http://wiki.openwrt.org/doc/devel/patches">quilt</a> to apply such a patch is one of the best ways to do, IMHO. The following is the list of steps I would usually perform to use <a href="http://wiki.openwrt.org/doc/devel/patches">quilt</a> to apply such a patch:<br /></p><ol class="decimal"><li><p>Download the patched file from the link you provided above. In my case, I just clicked the <a href="http://patchwork.openwrt.org/patch/6298/raw">patch</a> with my Google Chrome on my debian desktop computer and it gets downloaded into my ~/Download directory.</p></li><li><p>Then, go to your OpenWRT source root directory and execute <em>patch -p1 &lt; ~/Downloads/OpenWrt-Devel-toolchain-uClibc-fix-compile-with-full-language-support-enabled-fixes-13095.patch</em> to extract the real patched file (if your download directory is different, then adjust it accordingly). At this point, it will create the patched file in your <em>toolchain/uClibc/patches-0.9.33.2/991-gen_wctype.patch</em> and you are good to proceed the compilation. However, if you would like to use <a href="http://wiki.openwrt.org/doc/devel/patches">quilt</a> to manage your patched file, then proceed to the next steps.</p></li><li><p>Rename the current <em>toolchain/uClibc/patches-0.9.33.2/991-gen_wctype.patch</em> file to something else, i.e. <em>mv toolchain/uClibc/patches-0.9.33.2/991-gen_wctype.patch toolchain/uClibc/patches-0.9.33.2/991-gen_wctype.patch.sav</em></p></li><li><p>Execute <em>quilt new toolchain-uClibc-patches-0.9.33.2-991-gen_wctype.patch</em> to create your new patch file.</p></li><li><p>Execute <em>quilt edit toolchain/uClibc/patches-0.9.33.2/991-gen_wctype.patch</em> to edit the associated patched file (Here, I used the same original patched file name. Now, you see why we needed to rename the original patched file). Once you are in the quilt editor (mine is configured a <em>vi</em> editor, I type <em>:r toolchain/uClibc/patches-0.9.33.2/991-gen_wctype.patch.sav</em> and hit return to load the patched file into my editor. In this case, the file is inserted below the top line. Then, I move the cursor to the top empty line and press <em>dd</em> to remove it.</p></li><li><p>Exit the editor. In my case with a <em>vi</em> editor, I just press <em>Shift+ZZ</em>.</p></li><li><p>Now, do a <em>quilt refresh</em> to update your newly create patched file.</p></li><li><p>At this point, you can safely delete the <em>toolchain/uClibc/patches-0.9.33.2/991-gen_wctype.patch.sav</em> file.</p></li></ol><p>That is all there to it. If you want to remove the patchedf ile, just execute <em>quilt del toolchain-uClibc-patches-0.9.33.2-991-gen_wctype.patch</em> and a <em>quilt refresh</em> while you are still in the OpenWRT source root directory.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>