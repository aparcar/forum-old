<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Strange MTU issues</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 20 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p102490">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">dchardy</div>
					<div class="post-datetime">
						8 Feb 2010, 19:58					</div>
				</div>
				<div class="post-content content">
					<p>I just started running OpenWRT (Kamikaze 8.09.2) on a WRAP board with 2 CM9 cards in 802.11a AP/bridge mode, and have similar clients that connect to it, but running pebble linux (debian w/2.4 kernel).&nbsp; The AP used to run pebble linux, and now with OpenWRT, I was suddenly getting problems submitting form data, webpages stalling, etc - which sounded like an MTU problem. Turned out that I could not ping the gateway beyond the AP/bridge with packets &gt; 1478 bytes (ping -s 1470 works, -s 1471 or more doesn&#039;t). Setting MTU on the AP had no effect, but setting the MTU on the client to *1499* (rather than default 1500) allowed packets &gt; 1480 to go thru. Problem is sort of solved, but what&#039;s up with this ? Even more oddly, packets of exactly 1479 bytes (ping -s 1471) *do not pass* thru the OpenWRT AP at all, even with the MTU of 1499 !&nbsp; &nbsp; </p><p>(other info: pinging the AP from clients always works, regardless of MTU or packet size. pinging another device on the same subnet as the AP *does not* work with client MTU 1500 and packets &gt;1478, so it doesn&#039;t seem like an issue with the gateway.&nbsp; The pings don&#039;t even leave the OpenWRT AP. )</p><p>Any ideas would be appreciated, this is really bugging me. </p><p>-David</p>											<p class="post-edited">(Last edited by <strong>dchardy</strong> on 8 Feb 2010, 19:59)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p102762">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">dchardy</div>
					<div class="post-datetime">
						12 Feb 2010, 02:12					</div>
				</div>
				<div class="post-content content">
					<p>Gee, nobody?</p><p>There really does appear to be something very wrong with OpenWRT&#039;s bridging, at least with my particular config. I switched back to the pebble linux CF card, and all is fine. With openWRT, I investigated further and found that when I used MTU of 1500 on the client and pinged with across the AP w/packets &gt; 1471, only the 2nd fragment was making it thru, which of course was discarded by the router. Very odd....</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p102825">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">sborilla</div>
					<div class="post-datetime">
						12 Feb 2010, 23:50					</div>
				</div>
				<div class="post-content content">
					<p>I appear to observe similar problems.</p><p>With Kamikaze 8.09.2 (did not check on ...1) some sites (like <a href="http://www.linkedin.com">www.linkedin.com</a>) did not display at all.<br />I checked the MTU setting on the WAN port, but it was set correctly.</p><p>After reducing the MTU size on the CLIENTs (OpenSUSEs and XP machines, both attached via LAN or WLAN) manually to 1492, the behaviour vanishes and the sites display correctly.</p><p>So, certainly, the workaround is obvious, but this appears to me to be a defect, too.</p><p>Is there another way to take logs, other than tcpdump?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p102829">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">dchardy</div>
					<div class="post-datetime">
						13 Feb 2010, 00:50					</div>
				</div>
				<div class="post-content content">
					<p>Thank goodness, I&#039;m not crazy. </p><p>I haven&#039;t found any tools beside tcpdump to troubleshoot.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p102838">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						13 Feb 2010, 04:01					</div>
				</div>
				<div class="post-content content">
					<p>Did you enable the mtu_fix in the firewall config? It was moved from the forwarding section to the zone section between 8.09.1 and 8.09.2, if you restored an old firewall config the fix is no longer enabled.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>