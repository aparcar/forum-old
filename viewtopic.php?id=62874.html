<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Capabilities of ash (shell of OpenWrt)</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 15 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p312349">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Max Hopper</div>
					<div class="post-datetime">
						23 Feb 2016, 15:51					</div>
				</div>
				<div class="post-content content">
					<p>Has anyone the specifications for the shell of OpenWrt (BusyBox/ash) implementation?</p><p><span style="color: #ff008f"><strong>R</strong>eading <strong>T</strong>he <strong>F</strong>ine <strong>W</strong>eb</span> reveals but an ancient document of nascent <strong>ash</strong>&#039;s capabilities. When writing scripts with guidance of <strong>bash</strong> documentation, often are it&#039;s built-in functions not implemented, e.g., string replacement (<em>{1/%abc/xyz}</em>).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p312367">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">cvmiller</div>
					<div class="post-datetime">
						23 Feb 2016, 19:36					</div>
				</div>
				<div class="post-content content">
					<p>BusyBox implementations are often limited. Have you thought about installing the &#039;bash&#039; package, and just using a real shell?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p312426">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Max Hopper</div>
					<div class="post-datetime">
						24 Feb 2016, 18:15					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>cvmiller wrote:</cite><blockquote><p>BusyBox implementations are often limited.</p></blockquote></div><p>Obviously. Thus, the search for documentation.</p><div class="quotebox"><cite>cvmiller wrote:</cite><blockquote><p>... the &#039;bash&#039; package, and just using a real shell?</p></blockquote></div><p>Overrated. <strong>ash</strong> is sufficient for background scripts although stumbling about blindly when missing a <strong>built-in</strong> is vexing.</p><p>N.B. - <strong>ash</strong> is sufficient for the OpenWrt hackers and unpins the platform</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p312431">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">lems</div>
					<div class="post-datetime">
						24 Feb 2016, 19:01					</div>
				</div>
				<div class="post-content content">
					<p>According to this post on <a href="http://stackoverflow.com/a/2191917">StackOverflow</a>, busybox&#039; sh is actually dash:</p><p><a href="http://www.in-ulm.de/~mascheck/various/ash/#busybox">http://www.in-ulm.de/~mascheck/various/ash/#busybox</a></p><p>So since NetBSD&#039;s /bin/sh is ash, too, its manpage should give a good overview of what&#039;s supported.</p><p><a href="http://netbsd.gw.com/cgi-bin/man-cgi?sh++NetBSD-current">http://netbsd.gw.com/cgi-bin/man-cgi?sh++NetBSD-current</a></p><p>Or see the dash manpage:</p><p><a href="http://linux.die.net/man/1/dash">http://linux.die.net/man/1/dash</a></p><p>My own bourne shell scripts have been running fine, but I only use the shell&#039;s simple substring processing, or use awk or sed instead.</p><p>I think that&nbsp; ash has some features that the original bourne shell did not have, like the <em>local</em> keyword (for functions). </p><p>Yash is another shell that adheres to POSIX in a pretty strict fashion, as far as I know, maybe some of its documentation is useful as well:</p><p><a href="http://yash.osdn.jp/doc/">http://yash.osdn.jp/doc/</a></p><p>Also, a good resource is the heirloom project&#039;s sh page:<br /><a href="http://heirloom.sourceforge.net/sh.html">http://heirloom.sourceforge.net/sh.html</a></p><p>(heirloom sh is a port of the traditional bourne shell to modern unix systems.)<br />The heirloom shell, for example, does not support substring processing, which ash <em>does</em> support, though.</p><p>You could run your scripts through heirloom sh, or you could make use of a script&nbsp; called <a href="https://anonscm.debian.org/git/collab-maint/devscripts.git/tree/scripts/checkbashisms.pl">checkbashisms</a> used by Debian:<br /><a href="http://packages.qa.debian.org/d/devscripts.html">http://packages.qa.debian.org/d/devscripts.html</a></p><p>Quite a lot of links, I hope some of them are useful. I think if you follow the NetBSD manpage, your scripts should run fine.</p>											<p class="post-edited">(Last edited by <strong>lems</strong> on 24 Feb 2016, 19:38)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p312434">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">silentcreek</div>
					<div class="post-datetime">
						24 Feb 2016, 19:52					</div>
				</div>
				<div class="post-content content">
					<p>When scripting for BusyBox ash, I would just limit myself to features that are in the POSIX standard. String substitution is not one of them. BusyBox has only a short <a href="https://git.busybox.net/busybox/plain/shell/README">readme</a> which references <a href="http://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html">this page</a> as a pseudo-documentation of features.</p><p>Now, from a practical standpoint, especially when you convert bash scripts for ash or any lighter shell implementation, I found Shellcheck to be a very useful tool for spotting problems and bashisms. There is even an <a href="http://www.shellcheck.net/">online validator</a> where you can paste your scripts to validate them.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p312456">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">cvmiller</div>
					<div class="post-datetime">
						24 Feb 2016, 21:53					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>silentcreek wrote:</cite><blockquote><p>Now, from a practical standpoint, especially when you convert bash scripts for ash or any lighter shell implementation, I found Shellcheck to be a very useful tool for spotting problems and bashisms. There is even an <a href="http://www.shellcheck.net/">online validator</a> where you can paste your scripts to validate them.</p></blockquote></div><p>Thanks, I&#039;ll check out shellcheck. Probably most of my shell scripts would just work in ash.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>