<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> [How To] Home Automation - Relay Board controlled from Web page or SMS</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 17 Apr 2018 and 5 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 4</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=54722&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=54722&amp;p=3.html">3</a></li><li><a href="viewtopic.php%3Fid=54722&amp;p=4.html">4</a></li></ul></nav></div>
			
		
		
			<article class="post" id="p258583">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						24 Dec 2014, 15:53					</div>
				</div>
				<div class="post-content content">
					<p>Check also my other How To&#039;s:</p><p>[How To] Openwrt + Asterisk11 + GSM/SMS channel (chan_dongle):<br /><a href="https://forum.openwrt.org/viewtopic.php?pid=253590#p253590">https://forum.openwrt.org/viewtopic.php … 90#p253590</a></p><p>and </p><p>[HowTo] Openwrt cheap Digital Stereo WiFi Internet Radio &amp; MP3 Player:<br /><a href="https://forum.openwrt.org/viewtopic.php?pid=225463#p225463">https://forum.openwrt.org/viewtopic.php … 63#p225463</a></p><p>and<br />[How To] Web SMS server with OpenWRT:<br /><a href="https://forum.openwrt.org/viewtopic.php?id=60910">https://forum.openwrt.org/viewtopic.php?id=60910</a></p><p>-----------------------------------------------------------------------------------------</p><p>Quick and Mini How-to: </p><p><strong>&quot;OpenWRT - Controlling leds and a simple 5V relay board via Web interface&quot; <br />on TP-Link TL-WR741nd with <span style="color: #FF0000">OpenWRT Backfire</span></strong>.</p><p><a href="http://wiki.openwrt.org/toh/tp-link/tl-wr741nd">http://wiki.openwrt.org/toh/tp-link/tl-wr741nd</a></p><p><span class="postimg"><img src="https://fbcdn-sphotos-b-a.akamaihd.net/hphotos-ak-xfp1/v/t1.0-9/10425149_883059205040493_4569737742625033521_n.jpg?oh=99c7a37b37405a502f85b95b4e106f74&amp;oe=553F0304&amp;__gda__=1430263693_4ad5c3e55499555b9640b57b2682d89c" alt="https://fbcdn-sphotos-b-a.akamaihd.net/hphotos-ak-xfp1/v/t1.0-9/10425149_883059205040493_4569737742625033521_n.jpg?oh=99c7a37b37405a502f85b95b4e106f74&amp;amp;oe=553F0304&amp;amp;__gda__=1430263693_4ad5c3e55499555b9640b57b2682d89c" /></span></p><p>First, check you have the following kernel module and sofware installed:<br /><strong>opkg update<br />opkg install kmod-leds-gpio<br />opkg install kmod-ledtrig-gpio kmod-ledtrig-default-on<br />opkg install mini-sendmail</strong></p><br /><p>Led commands (example for &quot;SYS&quot; led = &quot;DS1&quot; on PCB)<br />---------------------------------------------------&nbsp; &nbsp;</p><p>led green:system (1= led on - 0= led off):</p><p><span style="color: #0000FF">&nbsp; &nbsp;/bin/echo 1 &gt; /sys/devices/platform/leds-gpio/leds/tl-wr741nd:green:system/brightness<br />&nbsp; &nbsp;/bin/echo 0 &gt; /sys/devices/platform/leds-gpio/leds/tl-wr741nd:green:system/brightness<br /></span></p><br /><p>Check led state<br />---------------------</p><p><span style="color: #0000FF">&nbsp; cat /sys/devices/platform/leds-gpio/leds/tl-wr741nd:green:system/brightness&nbsp; </span></p><br /><p><span style="color: #FF0000">Note: the other available Led on this router is QSS : tl-wr741nd:green:qss</span></p><br /><p>-------------------------------------</p><p>Startup settings,&nbsp; edit /etc/rc.local:</p><p><span style="color: #0000FF">/bin/echo none &gt; /sys/devices/platform/leds-gpio/leds/tl-wr741nd:green:system/trigger<br />/bin/echo 1 &gt; /sys/devices/platform/leds-gpio/leds/tl-wr741nd:green:system/brightness<br />exit 0</span></p><p>note: set default led status = off</p><p>--------<br />cgi-bin<br />--------</p><p>- edit /www/cgi-bin/on.cgi:</p><p><span style="color: #0000FF"> #!/bin/ash<br />echo &#039;ON&#039;<br />/bin/sh /root/on<br />cat /www/cgi-bin/enabled.txt | mini_sendmail -fsender@domain.com -ssmtp.domain.com -p25 user@domain.com</span></p><p>note: switch on relay board and than send activation notification by email</p><p>- edit /www/cgi-bin/off.cgi:</p><p><span style="color: #0000FF">#!/bin/ash<br />echo &#039;OFF&#039;<br />/bin/sh /root/off<br />cat /www/cgi-bin/disabled.txt | mini_sendmail -fsender@domain.com -ssmtp.domain.com -p25 user@domain.com</span></p><p>note: switch ff relay board and than send deactivation notification by email</p><br /><p>- edit /www/cgi-bin/test.cgi:<br /><span style="color: #0000FF"><br />#!/bin/ash<br />echo &#039;0 = Activated, 1 = Deactivated&#039;<br />echo &#039; &#039;<br />/bin/cat /sys/devices/platform/leds-gpio/leds/tl-wr741nd:green:system/brightness</span></p><p>note: show cannels status on screen (web page)</p><br /><p>- edit /www/cgi-bin/enabled.txt:<br /><span style="color: #0000FF">&nbsp; &nbsp;<br />subject: Activated!</span></p><br /><p>- edit /www/cgi-bin/disabled.txt:<br /> <span style="color: #0000FF"> <br />subject: Deactivated!</span></p><br /><p>---------<br />Scripts:<br />---------</p><p>- edit /root/on:</p><p><span style="color: #0000FF"><br />/bin/echo 0 &gt; /sys/devices/platform/leds-gpio/leds/tl-wr741nd:green:system/brightness</span></p><br /><p>- edit /root/off:</p><p> <span style="color: #0000FF"><br />/bin/echo 1 &gt; /sys/devices/platform/leds-gpio/leds/tl-wr741nd:green:system/brightness</span></p><br /><p>-----------------------------------------------<br /><span style="color: #FF0000">Important Notes: </span></p><p>- All cgi and scripts need &quot;chmod 777&quot;<br />- The signal from led catode is inverted: when the led is OFF the signal voltage is high = relay ON , when the led is ON the signal voltage is low = relay OFF<br />- The router starts blinking all leds on the startup sequence for several seconds, to avoid the relay board triggering on and off during router bootup, you need to (hardware) delay the activation of the relay boards until the router is fully booted, you may use a NE555 timer or better add a digital/relay logic to wait til the router is fully up.<br />-----------------------------------------------</p><br /><p>Web control panel (basic example)<br />-----------------------------------------</p><p>give the following comand:<br /><strong>mv index.html luci.html</strong></p><p>-edit /www/index.html:</p><p><span style="color: #0000FF">------------------------------------------------<br />&lt;br&gt;<br />CENTRALINA DI COMANDO<br />&lt;br&gt;<br />------------------------------------------------<br />&lt;p&gt;<br />&lt;FORM ACTION=&quot;/cgi-bin/off.cgi&quot;&gt;<br />&lt;INPUT TYPE=SUBMIT VALUE=&quot;Switch off&quot;&gt;<br />&lt;/FORM&gt;<br />&lt;FORM ACTION=&quot;/cgi-bin/on.cgi&quot;&gt;<br />&lt;INPUT TYPE=SUBMIT VALUE=&quot;Switch on&quot;&gt;<br />&lt;/FORM&gt;<br />&lt;p&gt;<br />------------------------------------------------<br />&lt;br&gt;<br />STATUS CHECK<br />&lt;br&gt;<br />------------------------------------------------<br />&lt;p&gt;<br />&lt;FORM ACTION=&quot;/cgi-bin/test.cgi&quot;&gt;<br /> &lt;INPUT TYPE=SUBMIT VALUE=&quot;check status&quot;&gt;<br />&lt;/FORM&gt;</span></p><p><span style="color: #0000FF">&lt;p&gt;<br />------------------------------------------------<br />&lt;form action=&quot;luci.html&quot;&gt;<br />&lt;input type=&quot;submit&quot; value=&quot;Luci control panel&quot;&gt;<br />&lt;/form&gt;<br />&lt;p&gt;<br />------------------------------------------------<br />&lt;p&gt; by P.M. Lovisolo 2014</span></p><br /><p>-----------------------------------------</p><p>GPIO pin (3V) = Led Catode of DS1 (Sys led) close to C382, opposite to &quot;+&quot; label<br />Transistor = 2n2222 or equivalent<br />Diode=1n4004 or equivalent<br />Resistors = 1/4W 5 or 10%</p><p>Note: you may add a red led with a 1Kohm drop resistor in parallel to the relay coil.</p><p><span class="postimg"><img src="http://2.bp.blogspot.com/-L-UOlMsomPw/UGrXD5zr2iI/AAAAAAAAAJU/AgIuzHv97ZM/s1600/Relay-revised.gif" alt="http://2.bp.blogspot.com/-L-UOlMsomPw/UGrXD5zr2iI/AAAAAAAAAJU/AgIuzHv97ZM/s1600/Relay-revised.gif" /></span></p><p><span style="color: #FF0000"><strong>Be very careful when soldering!<br />After the soldering process, block the connection wires to the PCB with a drop of glue to prevent pulling fragile pads away from router pcb!</strong></span></p><p>----------------------------------------------------------------------<br /> GPIOs are commonly used in router devices for buttons or leds. They only safely supply or sink (pull to GND) a maximum of 4mA aprox., and the voltage is usually 3V when active. Only two states are possible: high or low. Depending on how a device is activated by a GPIO, active low or active high is defined.</p><p>&nbsp; &nbsp; active high: the device is activated when the GPIO is HIGH<br />&nbsp; &nbsp; active low: the device is activated when the GPIO is LOW</p><p>Depending on your router model you may have the following configurations:</p><p><span class="postimg"><img src="http://wiki.openwrt.org/_media/media/gpios-high_low.png" alt="http://wiki.openwrt.org/_media/media/gpios-high_low.png" /></span></p><p><strong>NOTES:</strong></p><p>If you have installed OpenWrt on your router the leds should be controlled by the leds_gpio kernel module. Every led will have an entry in sysfs under /sys/class/leds</p><p>To manually control a led you should first set the trigger file to none, otherwise the led will be controlled for its original function, i.e. ethernet activity indicator:<br />echo none &gt; trigger<br />Then you can set the value by writing to the brightness file. This file represents the brightness level which should range from 0 to the value contained in the max_brightness file. However, in most cases there will not be hardware brightness control for the leds (like with GPIO), so 0 will turn OFF the led and any non-zero value will turn it ON:<br />echo 0 &gt; brightness<br />echo 1 &gt; brightness</p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 13 Nov 2015, 14:24)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p258590">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">hoatienii</div>
					<div class="post-datetime">
						24 Dec 2014, 17:04					</div>
				</div>
				<div class="post-content content">
					<p>Great project!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p258591">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						24 Dec 2014, 17:04					</div>
				</div>
				<div class="post-content content">
					<p>If you use a Router with USB interface you can add SMS control functionality to the relay board using <strong>Gnokii</strong>.</p><p>Simply send a SMS to activate or deactivate a led (relay board).</p><p>Note: thanks to: <a href="http://www.nabuk.org/f/index.php?topic=2864.0">http://www.nabuk.org/f/index.php?topic=2864.0</a></p><p><span class="bbu">example of SMS command script for Huawei E169 USB 3G dongle and TP-Link TL-MR3020 router (Attitude Adjustment):</span></p><p><strong>opkg update<br />opkg install luci-proto-3g <br />opkg install kmod-usb-core<br />opkg install kmod-usb-uhci<br />opkg install kmod-usb-ohci<br />opkg install kmod-usb2<br />opkg install usbutils<br />opkg install libusb usb-modeswitch usb-modeswitch-data kmod-usb-serial kmod-usb-serial-option kmod-usb-serial-wwan <br />opkg install gnokii<br />mkdir /root/sms</strong></p><p>Now plug the USB 3G dongle and restart the router, than check with dmesg that you see 3 lines like this:<br />usb 1-1: GSM modem (1-port) converter now attached to ttyUSBx</p><p>if so, edit /root/getsms.sh:<br /><span style="color: #0000FF"><br />####################################<br /># TP-Link TL-MR3020 + Huawei E 169 3G dongle + Gnokii<br /># OpenWRT Attitude Adjustment<br />#<br /># GetSMS - controlla la presenza di<br /># nuovi SMS sulla periferica e se<br /># riconosce dei comandi esegue delle<br /># operazioni.<br />#<br />#SMS#<br />#Send </span> <span style="color: #FF0000"> On </span> <span style="color: #0000FF">text to switch on the relay<br />#Send&nbsp; </span> <span style="color: #FF0000"> Off </span> <span style="color: #0000FF">text to switch off the relay<br />####################################</span></p><p><span style="color: #0000FF"># Variabili<br />folder=/root/sms&nbsp; &nbsp; # Cartella di destinazione<br />newsms=$folder/newsms&nbsp; &nbsp; # Nuovi SMS<br />dbsms=$folder/dbsms&nbsp; &nbsp; # Database SMS<br />newcmd=$folder/newcmd&nbsp; &nbsp; # Nuovi comandi<br />dbcmd=$folder/dbcmd&nbsp; &nbsp; # Database comandi</span></p><p><span style="color: #0000FF">numsms=3&nbsp; &nbsp; &nbsp; &nbsp; # Numero di SMS da leggere</span></p><p><span style="color: #0000FF"># Riempie il file newsms<br />gnokii --getsms ME 0 $numsms -d &gt; $newsms</span></p><p><span style="color: #0000FF"># Riempie il file newcmd<br />grep Text -A1 $newsms | grep -v &quot;Text\|--&quot; &gt; $newcmd</span></p><p><span style="color: #0000FF"># Conta i comandi<br />numcmd=$(grep -c &quot;^&quot; $newcmd)</span></p><p><span style="color: #0000FF"># Se non ci sono nuovi comandi non prosegue<br />if [ $numcmd -eq 0 ]<br />then<br />&nbsp; &nbsp; exit 1<br />fi</span></p><p><span style="color: #0000FF"># Analizza i comandi<br />for ancmd in $(cat $newcmd)<br />do<br />&nbsp; &nbsp; case $ancmd<br />&nbsp; &nbsp; in<br />&nbsp; &nbsp; &nbsp; &nbsp; On) echo 0 &gt; /sys/devices/platform/leds-gpio/leds/tp-link:green:3g/brightness&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # canale ON<br />&nbsp; &nbsp; &nbsp; &nbsp; echo $ancmd &gt;&gt; $dbcmd;;<br />&nbsp; &nbsp; &nbsp; &nbsp; Off) echo 1 &gt; /sys/devices/platform/leds-gpio/leds/tp-link:green:3g/brightness&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # canale OFF<br />&nbsp; &nbsp; &nbsp; &nbsp; echo $ancmd &gt;&gt; $dbcmd;;<br />&nbsp; &nbsp; &nbsp; &nbsp; *) ;;<br />&nbsp; &nbsp; esac<br />done</span></p><p><span style="color: #0000FF"># Aggiunge gli sms al database SMS<br />cat $newsms &gt;&gt; $dbsms</span></p><p><span style="color: #0000FF"># Svuota i file newcmd e newsms<br />&gt; $newcmd<br />&gt; $newsms</span></p><p><span style="color: #0000FF"># Svuota memoria SMS<br />gnokii --deletesms ME 0 4<br />gnokii --deletesms SM 0 4</span></p><p><span style="color: #0000FF">exit 0</span></p><p>save the file than:</p><p><strong>chmod 777 /root/getsms.sh</strong></p><br /><p><span class="bbu">Gnokii configuration file</span></p><p>edit /root/.gnokiirc:</p><br /><p><span style="color: #0000FF">[global]<br />model = AT<br />port = /dev/ttyUSB2<br />connection = serial</span></p><p>save the file than:</p><p><strong>cp /root/.gnokiirc /etc/.gnokiirc</strong></p><br /><p><span class="bbu">Cron configuration file (check for new SMS every 60 seconds</span></p><p>edit /etc/crontabs/root:</p><p><span style="color: #0000FF">*/1 * * * * /bin/sh /root/getsms.sh</span></p><p>save the file than:</p><p><strong>chmod 777 /etc/crontabs/root</strong></p><p>-----------------------------------------------<br />NOTE: you can also send SMS messages from OpenWRT with gnokii using the following commandline:<br /><strong>echo &quot;SMS test message from OpenWRT&quot; | gnokii --sendsms +39393xxxxxx</strong><br />-----------------------------------------------</p><p><strong><span class="bbu">LOGGING</span></strong></p><p><span class="bbu">Example of /root/sms/dbcmd (commands database):</span></p><p>On<br />Off<br />Off<br />On<br />Off<br />On<br />Off<br />On<br />Off</p><p><span class="bbu">Example of /root/sms/dbsms (sms database):</span></p><p>0. Inbox Message (unread)<br />Date/time: 24/05/2014 15:49:29 +0200<br />Sender: 8214 Msg Center: +393358822000<br />Text:<br />On<br />0. Inbox Message (unread)<br />Date/time: 24/05/2014 15:50:19 +0200<br />Sender: 8214 Msg Center: +393358819500<br />Text:<br />Off<br />0. Inbox Message (unread)<br />Date/time: 24/05/2014 15:53:28 +0200<br />Sender: 8214 Msg Center: +393358822000<br />Text:<br />Off<br />0. Inbox Message (unread)<br />Date/time: 24/05/2014 16:13:19 +0200<br />Sender: 8214 Msg Center: +393358823500<br />Text:<br />On<br />0. Inbox Message (unread)<br />Date/time: 24/05/2014 16:14:14 +0200<br />Sender: 8214 Msg Center: +393358823500<br />Text:<br />Off<br />0. Inbox Message (unread)<br />Date/time: 24/05/2014 16:40:52 +0200<br />Sender: 8214 Msg Center: +393358819500<br />Text:<br />On<br />0. Inbox Message (unread)<br />Date/time: 24/05/2014 16:41:17 +0200<br />Sender: 8214 Msg Center: +393358822000<br />Text:<br />Off<br />0. Inbox Message (unread)<br />Date/time: 24/05/2014 20:13:03 +0200<br />Sender: 8214 Msg Center: +393358819500<br />Text:<br />On<br />0. Inbox Message (unread)<br />Date/time: 24/05/2014 20:14:14 +0200<br />Sender: 8214 Msg Center: +393358819500<br />Text:<br />Off</p><p>--------------------------------------------------------------</p><p><strong>TEST</strong></p><p>root@OpenWrt:~# gnokii --identify<br />GNOKII Version 0.6.21<br />IMEI&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: 3581090248xxxxx<br />Manufacturer : huawei<br />Model&nbsp; &nbsp; &nbsp; &nbsp; : E169<br />Product name : E169<br />Revision&nbsp; &nbsp; &nbsp;: 11.314.11.00.00</p><p><span class="bbu">1) when no SMS received:</span></p><p>root@OpenWrt:~# sh /root/getsms.sh<br />GNOKII Version 0.6.21<br />GetSMS ME 0 failed! (The given location is empty.)<br />GetSMS ME 1 failed! (The given location is empty.)<br />GetSMS ME 2 failed! (The given location is empty.)<br />GetSMS ME 3 failed! (The given location is empty.)</p><p>root@OpenWrt:~# cat /sys/devices/platform/leds-gpio/leds/tp-link:green:3g/brightness<br />0</p><p>THE RELAY IS OFF</p><p><span class="bbu">2) SMS sent with On text (Date/time: 24/12/2014 17:35:05 +0100):</span></p><p>root@OpenWrt:~# sh /root/getsms.sh<br />GNOKII Version 0.6.21<br />(message deleted)<br />GetSMS ME 1 failed! (The given location is empty.)<br />GetSMS ME 2 failed! (The given location is empty.)<br />GetSMS ME 3 failed! (The given location is empty.)</p><p>Content of /root/sms/dbsms:<br /><span style="color: #0000FF">0. Inbox Message (unread)<br />Date/time: 24/12/2014 17:35:05 +0100<br />Sender: 8214 Msg Center: +393358822000<br />Text:<br />On</span></p><p>Content of /root/sms/dbcmd:<br /><span style="color: #0000FF">On</span></p><p>root@OpenWrt:~# cat /sys/devices/platform/leds-gpio/leds/tp-link:green:3g/brightness<br /><span style="color: #0000FF">1</span></p><p>THE RELAY IS ON</p><p><span class="bbu">3) SMS sent with Off text (Date/time: 24/12/2014 17:40:25 +0100):</span></p><p>root@OpenWrt:~# sh /root/getsms.sh<br />GNOKII Version 0.6.21<br />(message deleted)<br />GetSMS ME 1 failed! (The given location is empty.)<br />GetSMS ME 2 failed! (The given location is empty.)<br />GetSMS ME 3 failed! (The given location is empty.)</p><p>Content of /root/sms/dbsms:<span style="color: #0000FF"><br />0. Inbox Message (unread)<br />Date/time: 24/12/2014 17:35:05 +0100<br />Sender: 8214 Msg Center: +393358822000<br />Text:<br />On<br />0. Inbox Message (unread)<br />Date/time: 24/12/2014 17:40:25 +0100<br />Sender: 8214 Msg Center: +393358822000<br />Text:<br />Off</span></p><p>Content of /root/sms/dbcmd:<br /><span style="color: #0000FF">On<br />Off</span></p><p>root@OpenWrt:~# cat /sys/devices/platform/leds-gpio/leds/tp-link:green:3g/brightness<br /><span style="color: #0000FF">0</span></p><p>THE RELAY IS OFF</p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 22 Feb 2015, 17:35)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p258599">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">hoatienii</div>
					<div class="post-datetime">
						24 Dec 2014, 18:00					</div>
				</div>
				<div class="post-content content">
					<p>You could delete line #define TL_WR741NDV4_GPIO_LED_SYSTEM&nbsp; &nbsp; 27 and {&nbsp; &nbsp;.name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= &quot;tp-link:green:system&quot;,<br />&nbsp; &nbsp; .gpio&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= TL_WR741NDV4_GPIO_LED_SYSTEM,&nbsp; &nbsp;.active_low&nbsp; &nbsp; &nbsp;= 1,&nbsp; &nbsp; &nbsp;} <br />on mach-tl-wr741nd-v4.c file then compile to use echo &quot;27&quot; &gt; /sys/class/gpio/export<br />echo &quot;out&quot; &gt; /sys/class/gpio/gpio27/direction<br />echo &quot;1&quot; &gt; /sys/class/gpio/gpio27/value</p>											<p class="post-edited">(Last edited by <strong>hoatienii</strong> on 24 Dec 2014, 18:02)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p258743">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">hoatienii</div>
					<div class="post-datetime">
						26 Dec 2014, 11:31					</div>
				</div>
				<div class="post-content content">
					<p>When i click Swicth on or off, relay work fine but on web page it display &quot; The CGI process did not produce any response&quot;</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p258819">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						26 Dec 2014, 22:57					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>hoatienii wrote:</cite><blockquote><p>When i click Swicth on or off, relay work fine but on web page it display &quot; The CGI process did not produce any response&quot;</p></blockquote></div><p>Are You using Backfire?</p><p>If you use <strong>Attitude Adjustment</strong> the cgi code for &quot;echo&quot; command is different (I don&#039;t know why)</p><p><span style="color: #0000FF">#!/bin/ash<br />/bin/sh /root/on<br />cat /www/cgi-bin/enabled.txt | mini_sendmail -fsender@domain.com -ssmtp.domain.com -p25 user@domain.com<br />echo &#039;&#039;<br />echo &#039;&#039;<br />/bin/cat /sys/devices/platform/leds-gpio.0/leds/HW553:blue:adsl/brightness<br />echo &#039;1 = Off, 0 = On&#039;</span></p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 28 Dec 2014, 01:22)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p258831">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">hoatienii</div>
					<div class="post-datetime">
						27 Dec 2014, 01:18					</div>
				</div>
				<div class="post-content content">
					<p>Yes! My router on AA firmware.<br /> <a href="https://www.youtube.com/watch?v=jNJFbEl1Edk">https://www.youtube.com/watch?v=jNJFbEl1Edk</a><br />Thanks your reply!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p258888">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						28 Dec 2014, 00:24					</div>
				</div>
				<div class="post-content content">
					<p>You may add an USB Keyboard to locally control the relay board using triggerhappy.</p><p>See <a href="https://forum.openwrt.org/viewtopic.php?id=49013">https://forum.openwrt.org/viewtopic.php?id=49013</a> for more info and instructions about Triggerhappy</p><p>I installed Openwrt Attitude Adjustment on Huawei EchoLife HG553 (Vodafone Station) with USB keyboard, USB webcam, USB 3G dongle to obtain a 3 channels remote control with the following features:</p><p>- Local control via USB keyboard/keypad<br />- Remote control via internet webpage<br />- Remote control via SMS (internet connection not needed) <br />- Email and SMS notification for any channel status change<br />- Video remote control via USB webcam (mjpg-streamer)<br />- Audio remote control via USB webcam&#039;s microphone (ssh arecord | aplay - alsa)</p><p>Vodafone Station has three usable channels with two leds each (red and blue), I used the blue leds to indicate channels deactivated and the red ones to indicate active channels .<br />Also, Vodafone Station does not have the problem that many routers have during startup sequence when all leds blink for several seconds. </p><p>You can buy single 3V/5V relay board on Ebay for about 4 Euro each</p><p><span class="postimg"><img src="http://i00.i.aliimg.com/wsphoto/v0/1118077886/FREE-SHIPPING-font-b-3-3v-b-font-font-b-relay-b-font-module-compatible-5v.jpg" alt="http://i00.i.aliimg.com/wsphoto/v0/1118077886/FREE-SHIPPING-font-b-3-3v-b-font-font-b-relay-b-font-module-compatible-5v.jpg" /></span></p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 28 Dec 2014, 01:03)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p258891">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						28 Dec 2014, 00:47					</div>
				</div>
				<div class="post-content content">
					<p><strong>Openwrt Attitude Adjustment on Huawei EchoLife HG553 (Vodafone Station)</strong><br /><span style="color: #FF0000"><strong>Three channels remote control</strong></span></p><p><em><span style="color: #0000FF">#Channels OFF - blue leds ON - red leds OFF<br /># relay boards connected to blue led catodes<br />#<br /># channel 1<br />/bin/echo 1 &gt; /sys/devices/platform/leds-gpio.0/leds/HW553:blue:adsl/brightness<br />/bin/echo 0 &gt; /sys/devices/platform/leds-gpio.0/leds/HW553:red:adsl/brightness<br /># channel 2<br />/bin/echo 1 &gt; /sys/devices/platform/leds-gpio.0/leds/HW553:blue:internetkey/brightness<br />/bin/echo 0 &gt; /sys/devices/platform/leds-gpio.0/leds/HW553:red:internetkey/brightness<br /># channel 3<br />/bin/echo 1 &gt; /sys/devices/platform/leds-gpio.0/leds/HW553:blue:lan/brightness<br />/bin/echo 0 &gt; /sys/devices/platform/leds-gpio.0/leds/HW553:red:lan/brightness</span></em></p><br /><p><em><span style="color: #0000FF">#Channels ON- blue leds OFF - red leds ON<br />#relay boards connected to blue led catodes<br />#<br /># channel 1<br />/bin/echo 0 &gt; /sys/devices/platform/leds-gpio.0/leds/HW553:blue:adsl/brightness<br />/bin/echo 1 &gt; /sys/devices/platform/leds-gpio.0/leds/HW553:red:adsl/brightness<br /># channel 2<br />/bin/echo 0 &gt; /sys/devices/platform/leds-gpio.0/leds/HW553:blue:internetkey/brightness<br />/bin/echo 1 &gt; /sys/devices/platform/leds-gpio.0/leds/HW553:red:internetkey/brightness<br /># channel 3<br />/bin/echo 0 &gt; /sys/devices/platform/leds-gpio.0/leds/HW553:blue:lan/brightness<br />/bin/echo 1 &gt; /sys/devices/platform/leds-gpio.0/leds/HW553:red:lan/brightness</span></em></p><p>NOTE: red leds are not connected to anything, they are just used to show channels status.</p><br /><p><strong>-Web page example:</strong><br /><em><span style="color: #0000FF"><br />&lt;meta http-equiv=&quot;refresh&quot; content=&quot;5; URL=index.html&quot;&gt;<br />&lt;iframe <br />src =&quot;/cgi-bin/test.cgi&quot;<br />width=&quot;48%&quot;&gt;<br />&lt;/iframe&gt;<br />&lt;br&gt;<br />----------------------------------------------------------------------------------------------------------------------------------<br />&lt;br&gt;<br />Numero per comando da SMS: +393349xxx<br />&lt;br&gt;<br />testo SMS da inviare:<br />&lt;br&gt;<br />CANALE 1 = &lt;b&gt;On1&lt;/b&gt; e &lt;b&gt;Off1&lt;/b&gt; / CANALE 2 = &lt;b&gt;On2&lt;/b&gt; e &lt;b&gt;Off2&lt;/b&gt; / CANALE 3 = &lt;b&gt;On3&lt;/b&gt; e &lt;b&gt;Off3&lt;/b&gt;<br />&lt;br&gt;<br />----------------------------------------------------------------------------------------------------------------------------------<br />&lt;br&gt;<br />COMANDI CANALE 1<br />&lt;p&gt;<br />&lt;FORM ACTION=&quot;/cgi-bin/off1.cgi&quot;&gt;<br />&lt;INPUT TYPE=SUBMIT VALUE=&quot;Spegni&quot;&gt;<br />&lt;/FORM&gt;<br />&lt;FORM ACTION=&quot;/cgi-bin/on1.cgi&quot;&gt;<br />&lt;INPUT TYPE=SUBMIT VALUE=&quot;Accendi&quot;&gt;<br />&lt;/FORM&gt;<br />&lt;p&gt;<br />------------------------------------------------<br />&lt;br&gt;<br />COMANDI CANALE 2<br />&lt;p&gt;<br />&lt;FORM ACTION=&quot;/cgi-bin/off2.cgi&quot;&gt;<br />&lt;INPUT TYPE=SUBMIT VALUE=&quot;Spegni&quot;&gt;<br />&lt;/FORM&gt;<br />&lt;FORM ACTION=&quot;/cgi-bin/on2.cgi&quot;&gt;<br />&lt;INPUT TYPE=SUBMIT VALUE=&quot;Accendi&quot;&gt;<br />&lt;/FORM&gt;<br />&lt;p&gt;<br />------------------------------------------------<br />&lt;br&gt;<br />COMANDI CANALE 3<br />&lt;p&gt;<br />&lt;FORM ACTION=&quot;/cgi-bin/off3.cgi&quot;&gt;<br />&lt;INPUT TYPE=SUBMIT VALUE=&quot;Spegni&quot;&gt;<br />&lt;/FORM&gt;<br />&lt;FORM ACTION=&quot;/cgi-bin/on3.cgi&quot;&gt;<br />&lt;INPUT TYPE=SUBMIT VALUE=&quot;Accendi&quot;&gt;<br />&lt;/FORM&gt;<br />&lt;p&gt;<br />------------------------------------------------<br />&lt;br&gt;<br />&lt;form action=&quot;luci.html&quot;&gt;<br />&lt;input type=&quot;submit&quot; value=&quot;Pannello di controllo&quot;&gt;<br />&lt;/form&gt;<br />&lt;p&gt;<br />------------------------------------------------<br />&lt;br&gt;<br />&lt;form action=&quot;http://192.168.1.143:8081/javascript_simple.html&quot;&gt;<br />&lt;input type=&quot;submit&quot; value=&quot;Webcam&quot;&gt;<br />&lt;/form&gt;<br />&lt;p&gt;<br />------------------------------------------------<br />&lt;p&gt; by P.M. Lovisolo 2014<br />&lt;br&gt;<br />parknat12@yahoo.com</span></em></p><br /><p><strong>- /www/cgi-bin/test.cgi:</strong></p><p><em><span style="color: #0000FF">#!/bin/ash<br />echo &#039;&#039;<br />echo &#039;&#039;<br />/bin/cat /sys/devices/platform/leds-gpio.0/leds/HW553:blue:adsl/brightness<br />echo &#039;&#039;<br />echo &#039;&#039;<br />/bin/cat /sys/devices/platform/leds-gpio.0/leds/HW553:blue:internetkey/brightness<br />echo &#039;&#039;<br />echo &#039;&#039;<br />/bin/cat /sys/devices/platform/leds-gpio.0/leds/HW553:blue:lan/brightness<br />echo &#039;&#039;<br />echo &#039;Canali 1,2,3 : 1 = spento, 0 = acceso&#039;<br /></span></em></p><br /><p><strong>Important notes:</strong><br /><span style="color: #FF0000">connect 3G&nbsp; dongle directly to the upper USB port<br />Connect a powered (5V) USB HUB to the lower USB port, than connect USB webcam ad USB keyboard to the USB Hub.</span></p><p><span class="postimg"><img src="http://i272.photobucket.com/albums/jj194/hedenlife/10012011003.jpg" alt="http://i272.photobucket.com/albums/jj194/hedenlife/10012011003.jpg" /></span></p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 29 Dec 2014, 12:35)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p258903">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">hoatienii</div>
					<div class="post-datetime">
						28 Dec 2014, 04:04					</div>
				</div>
				<div class="post-content content">
					<p>And how control via audio?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p258925">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						28 Dec 2014, 11:28					</div>
				</div>
				<div class="post-content content">
					<p>Remote Audio Monitoring<br />------------------------------</p><p>I used a Microsoft HD 5000 USB webcam (1280x720 px max) with integrated microphone.</p><p><strong>opkg install kmod-usb-core kmod-usb-ohci kmod-usb-uhci <br />opkg install kmod-sound-core kmod-usb-audio usbutils kmod-sound-cs5535audio<br />opkg install kmod-sound-i8x0 kmod-sound-soc-core<br />opkg install kmod-usb2<br />opkg install alsa-utils<br />opkg install alsa-lib</strong></p><p>Open port 22 TCP on the ADSL router and forward it to the Openwrt device.</p><p>to listen to the audio:<br /><strong>ssh root@IP_ADDRESS -p 22 arecord -r 8000 -t wav -c 1 -f S16_LE | aplay -r 8000 -t wav -c 1 -f S16_LE</strong><br />note: you need to enter root password.</p><p>Note: you&#039;d better change ssh port to a non standard value (ex. 24)</p><p>Extra stuffs.<br />---------------</p><p>to control the audio levels:<br /><strong>alsamixer </strong><br />(F4 for input controls - esc to exit)</p><p>To save anytime your current audio volume level, launch (locally) the following command:<br /><strong>/usr/sbin/alsactl -f /etc/alsa0.state store 0</strong></p><p>and then to restore this on boot, create the file &quot;/etc/init.d/alsa-cfg&quot; and put the following text:</p><p><em><span style="color: #0000FF">#!/bin/sh /etc/rc.common<br />&nbsp; START=98<br />&nbsp; start() {&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; alsactl -f /etc/alsa0.state restore 0<br />&nbsp; }</span></em></p><p>then make it executable:<br /><strong>chmod +x /etc/init.d/alsa-cfg</strong></p><p>then enable it on boot with the following two commands:<br /><strong>/etc/init.d/alsa-cfg enable</strong></p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 28 Dec 2014, 12:08)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p258927">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						28 Dec 2014, 11:38					</div>
				</div>
				<div class="post-content content">
					<p>Remote Video Monitoring<br />------------------------------</p><p>- Microsoft HD 5000 webcam (autofocus)</p><p><strong>opkg install kmod-video-uvc<br />opkg install kmod-i2c-core<br />opkg install kmod-video-core<br />opkg install kmod-usb-core<br />opkg install kmod-usb-uhci<br />opkg install kmod-usb-ohci<br />opkg install kmod-usb2<br />opkg install usbutils<br />opkg install kmod-video-gspca-core<br />opkg install kmod-video-gspca-sonixj<br />opkg install mjpg-streamer<br /></strong><br />than edit /etc/config/mjpg-streamer:</p><p><span style="color: #0000FF"><em>config mjpg-streamer core<br />&nbsp; &nbsp; &nbsp; &nbsp; option enabled&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;1&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; option device&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;/dev/video0&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; option resolution&nbsp; &nbsp; &nbsp; &nbsp;&quot;640x480&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; option fps&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;1&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; option www&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;/www/webcam&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; option port&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;8081&quot;</em></span></p><p>note: to keep low CPU % usage do not go over 640x480 pixels resolution and 3 fps max (HD 5000 can go up to 1280x720 px)</p><p>enable mjpg-streamer at boot:<br /><strong>/etc/init.d/mjpg-streamer enable</strong></p><p>Open port 8081 TCP on the ADSL router and forward it to the Openwrt device.</p><p>to see the webcam:<br />http://IP_ADDRESS:8081</p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 28 Dec 2014, 12:02)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p258929">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">tmo26</div>
					<div class="post-datetime">
						28 Dec 2014, 12:22					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>pilovis wrote:</cite><blockquote><p>- Microsoft HD 5000 webcam (autofocus)</p><p><strong>opkg install kmod-video-uvc<br />opkg install kmod-i2c-core<br />opkg install kmod-video-core<br />opkg install kmod-usb-core<br />opkg install kmod-usb-uhci<br />opkg install kmod-usb-ohci<br />opkg install kmod-usb2<br />opkg install usbutils<br />opkg install kmod-video-gspca-core<br />opkg install kmod-video-gspca-sonixj<br />opkg install mjpg-streamer<br /></strong></p></blockquote></div><p>You certainly do not need kmod-video-gspca-core and kmod-video-gspca-sonixj for a UVC webcam, which the HD5000 is.</p><p>kmod-usb-uhci and kmod-usb-ohci should&#039;nt be necessary for a USB 2.0 webcam, which the HD5000 is.</p><p>usbutils is nice to have, but not needed for webcam support (although lsusb can be a great help)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p258931">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						28 Dec 2014, 12:34					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>tmo26 wrote:</cite><blockquote><p>You certainly do not need kmod-video-gspca-core and kmod-video-gspca-sonixj for a UVC webcam, which the HD5000 is.</p><p>kmod-usb-uhci and kmod-usb-ohci should&#039;nt be necessary for a USB 2.0 webcam, which the HD5000 is.</p><p>usbutils is nice to have, but not needed for webcam support (although lsusb can be a great help)</p></blockquote></div><p>kmod-video-gspca-sonixj (JPEG) is necessary for Mjpeg streaming!<br />Also, without kmod-video-gspca-core, HD5000 &amp; Mjpg-streamer do not work.</p><p>kmod-usb-uhci and kmod-usb-ohci are not necessary just for video streaming, but do not hurt <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />, you need them for the others features described above.</p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 28 Dec 2014, 12:46)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p258938">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">tmo26</div>
					<div class="post-datetime">
						28 Dec 2014, 13:50					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>pilovis wrote:</cite><blockquote><p>kmod-video-gspca-sonixj (JPEG) is necessary for Mjpeg streaming!<br />Also, without kmod-video-gspca-core, HD5000 &amp; Mjpg-streamer do not work.</p></blockquote></div><p>Nope, just checked it out with my HD5000: Streaming works perfectly without the above kmods.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p258957">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">hoatienii</div>
					<div class="post-datetime">
						28 Dec 2014, 17:13					</div>
				</div>
				<div class="post-content content">
					<p>My web control page run on php.<br />I install php and lighttpd.</p><p>my&nbsp; &nbsp;/www/index.php</p><div class="codebox"><pre><code>&lt;?php
session_start();
$up = array(
    &#039;u&#039;    =&gt; &quot;d033e22ae348aeb5660fc2140aec35850c4da997&quot;,
    &#039;p&#039;    =&gt; &quot;d033e22ae348aeb5660fc2140aec35850c4da997&quot;
);
if(isset($_POST[&#039;login&#039;]) &amp;&amp; $up[&#039;u&#039;]===sha1($_POST[&#039;username&#039;]) &amp;&amp; $up[&#039;p&#039;]===sha1($_POST[&#039;password&#039;])){
    $_SESSION[&#039;username&#039;] = $_POST[&#039;username&#039;];
    $_SESSION[&#039;password&#039;] = $_POST[&#039;password&#039;];
};
if(isset($_POST[&#039;logout&#039;])){
    unset($_SESSION[&#039;username&#039;]);
    unset($_SESSION[&#039;password&#039;]);
}

if(isset($_SESSION[&#039;username&#039;]) &amp;&amp; isset($_SESSION[&#039;password&#039;])){
    if($up[&#039;u&#039;]===sha1($_SESSION[&#039;username&#039;]) &amp;&amp; $up[&#039;p&#039;]===sha1($_SESSION[&#039;password&#039;])){
        if(isset($_POST[&#039;router&#039;])) {
            $contents = file_get_contents(&quot;{$_SERVER[&#039;DOCUMENT_ROOT&#039;]}./{$_POST[&#039;router&#039;]}.sh&quot;);
            echo shell_exec($contents);
        }
        ?&gt;
        &lt;style&gt;
            form{
                width: 226px;
            }
            input{
                margin-top: 5px;
                margin-bottom: 5px;
                color: #fff;
                background-color: #449d44;
                border-color: #398439;
                text-decoration: none;
                display: inline-block;
                padding: 6px 12px;
                font-weight: 400;
                line-height: 1.42857143;
                background-image: none;
                border: 1px solid transparent;
                border-radius: 4px;
                font-family: inherit;
                -webkit-appearance: button;
                cursor: pointer;
                text-transform: none;
                overflow: visible;
                width: 100px;
                font-size: 14px;
            }
            @media only screen and (max-device-width: 480px){
                form{
                    width: 100%;
                }
                input {
                    width: 100%;
                    height: 100px;
                    font-size: 50px;
                }
            }
        &lt;/style&gt;
        &lt;form method=&quot;post&quot; action=&quot;&lt;?php echo $_SERVER[&#039;PHP_SELF&#039;]; ?&gt;&quot;&gt;
            &lt;input type=&quot;submit&quot; name=&quot;router&quot; value=&quot;on_one&quot;&gt;&lt;br&gt;
            &lt;input type=&quot;submit&quot; name=&quot;router&quot; value=&quot;off_one&quot;&gt;&lt;br&gt;
            &lt;input type=&quot;submit&quot; name=&quot;logout&quot; value=&quot;Log Out&quot;&gt;&lt;br&gt; 
        &lt;/form&gt;
        &lt;?php
    } else {
        // clear session
        unset($_SESSION[&#039;username&#039;]);
        unset($_SESSION[&#039;password&#039;]);
    }
}else{
    ?&gt;
        &lt;style&gt;
            form{
                margin: 0 auto;
                padding: 20px;
                width: 226px;
            }
            input {
                margin: 10px 0px 10px 10px;
                width: 173px;
                width: 100px;
                font-size: 14px;
            }
            input[type=&quot;submit&quot;] {
                padding: 5px;
                width: 70px;
                float: right;
            }
            @media only screen and (max-device-width: 480px){
                form{
                    width: 100%;
                }
                input {
                    width: 100%;
                    height: 100px;
                    font-size: 50px;
                }
                input[type=&quot;submit&quot;] {
                    width: 100%;
                }
            }
        &lt;/style&gt;
        &lt;form method=&quot;post&quot; action=&quot;&lt;?php echo $_SERVER[&#039;PHP_SELF&#039;]; ?&gt;&quot;&gt;
            User : &lt;input type=&quot;text&quot; name=&quot;username&quot;&gt;&lt;br&gt;
            Pass : &lt;input type=&quot;password&quot; name=&quot;password&quot;&gt;&lt;br&gt;
            &lt;input type=&quot;submit&quot; name=&quot;login&quot; value=&quot;Login&quot;&gt;
        &lt;/form&gt;
    &lt;?php
    
}
?&gt;</code></pre></div><br /><p>put on_one.sh and off_ond.sh into /www folder</p><p>on_one.sh: echo &quot;0&quot; &gt; /sys/class/gpio/gpio2/value<br />off_one.sh: echo &quot;1&quot; &gt; /sys/class/gpio/gpio2/value</p><p>change user and pass line: </p><p>&nbsp; &nbsp; &#039;u&#039;&nbsp; &nbsp; =&gt; &quot;d033e22ae348aeb5660fc2140aec35850c4da997&quot;,<br />&nbsp; &nbsp; &#039;p&#039;&nbsp; &nbsp; =&gt; &quot;d033e22ae348aeb5660fc2140aec35850c4da997</p><p>my example is user/pass is admin<br />go to <a href="http://www.sha1-online.com/">http://www.sha1-online.com/</a> create sha for user and pass</p>											<p class="post-edited">(Last edited by <strong>hoatienii</strong> on 28 Dec 2014, 17:17)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p258958">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						28 Dec 2014, 17:36					</div>
				</div>
				<div class="post-content content">
					<p>in case you do not have any internet connectivity and want to have the channel status report sent by SMS:</p><p>- create empty DB file /root/status (just once)<br /><strong>touch /root/status</strong></p><p>- edit /root/sms-status:</p><p><em><span style="color: #0000FF">####################################<br /># Openwrt + USB dongle + Gnokii<br />#<br /># Write channel status to file<br />####################################</span></em></p><p><em><span style="color: #0000FF"># Variabili<br />folder=/root&nbsp; &nbsp; # Cartella di destinazione<br />dbstatus=$folder/status&nbsp; &nbsp; # File Status</span></em></p><p><em><span style="color: #0000FF"># Cancella file /root/status<br />rm /root/status</span></em></p><p><em><span style="color: #0000FF"># Aggiunge status canali al file<br />echo &quot;Status canali 1,2,3 : 1=Off, 0=On&quot; &gt;&gt; $dbstatus<br />cat&nbsp; /sys/devices/platform/leds-gpio.0/leds/HW553:blue:adsl/brightness &gt;&gt; $dbstatus<br />cat&nbsp; /sys/devices/platform/leds-gpio.0/leds/HW553:blue:internetkey/brightness &gt;&gt; $dbstatus<br />cat&nbsp; /sys/devices/platform/leds-gpio.0/leds/HW553:blue:lan/brightness &gt;&gt; $dbstatus<br />exit 0</span></em></p><p>than:<br /><strong>chmod 777 /root/sms-status</strong></p><br /><p>- edit /www/cgi-bin/sms.cgi:</p><p><em><span style="color: #0000FF">#!/bin/ash<br />/bin/sh /root/sms-status<br />cat /root/status | gnokii --sendsms +393336xxxxxx<br />cat /root/status | mini_sendmail -fsender@domain.com -ssmtp.provider.com -p25 user@domain.com</span></em></p><p>note: this cgi sends channels status by SMS and email, if you don&#039;t need email notification delete the last line.</p><p>than:<br /><strong>chmod 777 /www/cgi-bin/sms.cgi</strong></p><p>to get the status by SMS run:<br /><strong>sh /www/cgi-bin/sms.cgi</strong></p><p>- [Optional] Cron configuration file (sends channels status by email every night at 00:00):</p><p>edit /etc/crontabs/root ad add the following line:</p><p><strong>0 0 * * * cat /root/status | mini_sendmail -fsender@domain.com -ssmtp.provider.com -p25 user@domain.com</strong><br />----------------------------------------------------------------</p><p>Modifications to file &quot;/root/getsms.sh&quot; file for three channels control and Status feedback by SMS:</p><p>...<br /><em><span style="color: #0000FF"># Analizza i comandi<br />for ancmd in $(cat $newcmd)<br />do<br />&nbsp; &nbsp; case $ancmd<br />&nbsp; &nbsp; in<br />&nbsp; &nbsp; &nbsp; &nbsp; On1) /www/cgi-bin/on1.cgi&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Canale 1 ON + email<br />&nbsp; &nbsp; &nbsp; &nbsp; echo $ancmd &gt;&gt; $dbcmd;;<br />&nbsp; &nbsp; &nbsp; &nbsp; Off1) /www/cgi-bin/off1.cgi&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Canale 1 OFF + email<br />&nbsp; &nbsp; &nbsp; &nbsp; echo $ancmd &gt;&gt; $dbcmd;;<br />&nbsp; &nbsp; &nbsp; &nbsp; On2) /www/cgi-bin/on2.cgi&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Canale 2 ON + email<br />&nbsp; &nbsp; &nbsp; &nbsp; echo $ancmd &gt;&gt; $dbcmd;;<br />&nbsp; &nbsp; &nbsp; &nbsp; Off2) /www/cgi-bin/off2.cgi&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Canale 2 OFF + email<br />&nbsp; &nbsp; &nbsp; &nbsp; echo $ancmd &gt;&gt; $dbcmd;;<br />&nbsp; &nbsp; &nbsp; &nbsp; On3) /www/cgi-bin/on3.cgi&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Canale 3 ON + email<br />&nbsp; &nbsp; &nbsp; &nbsp; echo $ancmd &gt;&gt; $dbcmd;;<br />&nbsp; &nbsp; &nbsp; &nbsp; Off3) /www/cgi-bin/off3.cgi&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Canale 3 OFF + email<br />&nbsp; &nbsp; &nbsp; &nbsp; echo $ancmd &gt;&gt; $dbcmd;;<br />&nbsp; &nbsp; &nbsp; &nbsp; Status) /www/cgi-bin/sms.cgi&nbsp; &nbsp; &nbsp; # Aggiorna status canali lo manda per SMS<br />&nbsp; &nbsp; &nbsp; &nbsp; echo $ancmd &gt;&gt; $dbcmd;;<br />&nbsp; &nbsp; &nbsp; &nbsp; *) ;;<br />&nbsp; &nbsp; esac<br />done</span></em><br />...</p><p>Note: remember to create &quot;/www/cgi-bin/on(x).cgi&quot; and &quot;/www/cgi-bin/off(x).cgi&quot; files</p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 29 Dec 2014, 12:32)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p258963">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						28 Dec 2014, 18:45					</div>
				</div>
				<div class="post-content content">
					<p>Please note this device can be fully controlled and monitored by SMS, without needing any internet connectivity <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />This sounds quite strange for a router <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /> , but is very helpful if you want to remote control something in distant areas where there is no internet coverage, or you want to keep full control on it, even if there is an internet outage.<br />Obviously if you have Internet connectivity (Wi-fi/3G/LAN) you&#039;ll have more options available, like audio and video remote monitoring.</p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 28 Dec 2014, 18:59)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259057">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						29 Dec 2014, 16:29					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve just added another feature to this Home Automation Server:<br /><strong><em>Auto-restore of previous channels status after a reboot/crash/power outage</em></strong></p><p>You&#039;ll find all my &quot;ready-to-use&quot; configuration files and script, for Vodafone Station Huawei EchoLife HG553 + OpenWRT Attitude Adjustment, here: <br /><a href="http://www.lovisolo.com/asterisk/software/openwrt/Vodafone-Station-Home-Automation-Server/">http://www.lovisolo.com/asterisk/softwa … on-Server/</a></p><p>If you want to use a different router, you&#039;ll just need to change the &quot;/sys/devices/platform/leds-gpio...&quot; trigger lines, with the ones suitable for your board.</p><p>Complete list of the board functionalities (using my files above):</p><p>- Three (or six) indipendent channels output (via simple relays board)<br />- Multiple input control (USB keyboard/USB keypad/USB mouse keys) with triggerhappy <br />- Full local control via keyboard/keypad/mouse<br />- Full local monitoring via red/blue leds on the router<br />- Full remote/local control/monitoring via internet webpage<br />- Full remote control/monitoring via SMS (internet connection not needed)<br />- Email and/or SMS notification for any channel status change<br />- Automatic restore of the previous channels status after a reboot/crash<br />- Realtime video remote/local control via USB webcam (mjpg-streamer)<br />- Realtime audio remote/local control via USB webcam&#039;s microphone (ssh arecord | aplay - alsa)</p><p><span class="bbu">Web Control/Monitoring Page (including Luci &amp; Webcam):</span></p><p>http://IP_Address/index.html </p><p><span class="bbu">List of remote SMS commands:</span></p><p><strong>On1</strong> = Activate Channel 1<br /><strong>On2</strong> = Activate Channel 2<br /><strong>On3</strong> = Activate Channel 3<br /><strong>Off1</strong> = Deactivate Channel 1<br /><strong>Off2</strong> = Deactivate Channel 2<br /><strong>Off3</strong> = Deactivate Channel 3<br /><strong>Status</strong> = Send all channels status by SMS</p><p><span class="bbu">List of local USB Keyboard control keys</span></p><p><strong>F1</strong> = Activate Channel 1<br /><strong>F2</strong> = Activate Channel 2<br /><strong>F3</strong> = Activate Channel 3<br /><strong>F4</strong> = Deactivate Channel 1<br /><strong>F5</strong> = Deactivate Channel 2<br /><strong>F6</strong> = Deactivate Channel 3<br /><strong>F9</strong> = Activate All Channels<br /><strong>F10</strong> = Deactivate All Channels</p><p>Enjoy <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><br /><p>Final notes: with Vodafone Station Huawei EchoLife HG553, you can have up to six indipendent output channels if you control and use both, red and blue leds, to drive the relays.</p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 29 Dec 2014, 20:17)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259071">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">hoatienii</div>
					<div class="post-datetime">
						29 Dec 2014, 18:21					</div>
				</div>
				<div class="post-content content">
					<p>Could you give how to control relay with keyboard? Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259073">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						29 Dec 2014, 18:25					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>hoatienii wrote:</cite><blockquote><p>Could you give how to control relay with keyboard? Thanks!</p></blockquote></div><p>It is implemented in my triggerhappy configuration file (/etc/triggerhappy/triggers.d/example.conf)<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; <strong>opkg update<br />&nbsp; &nbsp; opkg install kmod-usb-hid<br />&nbsp; &nbsp; opkg install kmod-hid kmod-hid-generic<br />&nbsp; &nbsp; opkg install triggerhappy<br />&nbsp; &nbsp; opkg install kmod-button-hotplug<br />&nbsp; &nbsp; opkg install kmod-gpio-button-hotplug</strong></p><p>launch the following command to find &quot;eventcodes&quot; for available buttons (KEY_LABEL):<br />&nbsp; &nbsp; <strong>thd --dump /dev/input/event*</strong></p><p>example (press a key):</p><p>root@OpenWrt:~# thd --dump /dev/input/event*<br />EV_KEY&nbsp; &nbsp; KEY_KP5&nbsp; &nbsp; 1&nbsp; &nbsp; /dev/input/event0<br /># KEY_KP5&nbsp; &nbsp; 1&nbsp; &nbsp; command<br />EV_KEY&nbsp; &nbsp; KEY_KP5&nbsp; &nbsp; 2&nbsp; &nbsp; /dev/input/event0<br /># KEY_KP5&nbsp; &nbsp; 2&nbsp; &nbsp; command<br />EV_KEY&nbsp; &nbsp; KEY_KP5&nbsp; &nbsp; 2&nbsp; &nbsp; /dev/input/event0<br /># KEY_KP5&nbsp; &nbsp; 2&nbsp; &nbsp; command<br />EV_KEY&nbsp; &nbsp; KEY_KP5&nbsp; &nbsp; 2&nbsp; &nbsp; /dev/input/event0<br /># KEY_KP5&nbsp; &nbsp; 2&nbsp; &nbsp; command<br />EV_KEY&nbsp; &nbsp; KEY_KP5&nbsp; &nbsp; 0&nbsp; &nbsp; /dev/input/event0<br /># KEY_KP5&nbsp; &nbsp; 0&nbsp; &nbsp; command<br />EV_KEY&nbsp; &nbsp; KEY_KP1&nbsp; &nbsp; 1&nbsp; &nbsp; /dev/input/event0<br /># KEY_KP1&nbsp; &nbsp; 1&nbsp; &nbsp; command<br />EV_KEY&nbsp; &nbsp; KEY_KP1&nbsp; &nbsp; 0&nbsp; &nbsp; /dev/input/event0<br /># KEY_KP1&nbsp; &nbsp; 0&nbsp; &nbsp; command<br />EV_KEY&nbsp; &nbsp; KEY_KP1&nbsp; &nbsp; 1&nbsp; &nbsp; /dev/input/event0<br /># KEY_KP1&nbsp; &nbsp; 1&nbsp; &nbsp; command<br />EV_KEY&nbsp; &nbsp; KEY_KP1&nbsp; &nbsp; 0&nbsp; &nbsp; /dev/input/event0<br /># KEY_KP1&nbsp; &nbsp; 0&nbsp; &nbsp; command</p><p>Note: A value of 1 corresponds to pressing a key, while 2 is generated by holding it; releasing it yields a value of 0.</p><br /><p> edit /etc/triggerhappy/triggers.d/example.conf:<br /><em><br /># This is an example configuration for the triggerhappy daemon (thd)<br /># please note that every file to be processed must end in &quot;.conf&quot;<br /># To view a list of supported event codes, use &quot;thd --listevents&quot; or<br /># &quot;thd --dump /dev/input/event*&quot;<br />#<br /># Format:<br /># &lt;eventcode&gt; &lt;value&gt; &lt;command&gt;<br /># values for key events are 1 (pressed), 0 (released) or 2 (held)<br />#<br />KEY_F1 /bin/sh /root/1on<br />KEY_F2 /bin/sh /root/2on<br />KEY_F3 /bin/sh /root/3on<br />KEY_F4 /bin/sh /root/1off<br />KEY_F5 /bin/sh /root/2off<br />KEY_F6 /bin/sh /root/3off<br />KEY_F9 /bin/sh /root/allon<br />KEY_F10 /bin/sh /root/alloff<br />#eof</em></p><p>Note: you may need to adjust the &quot;KEY_LABELS&quot; if you use a different keyboard from mine or if you want to use just a small USB keypad, check your keyboard/keypad with the command <strong>thd --dump /dev/input/event*</strong> and than press the desired key to see its Key_label name.</p><p>than:<br /><strong>/etc/init.d/triggerhappy enable<br />/etc/init.d/triggerhappy start</strong></p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 10 Jan 2015, 12:53)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259076">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						29 Dec 2014, 19:12					</div>
				</div>
				<div class="post-content content">
					<p>Now I did the dirty job <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> but still need to implement the followings features:</p><p>- Withelist for the authorized SMS senders, only authorized numbers can issue commands to the router.<br />- Simple autentication login with password for the control web page by inserting the control panel into a custom luci module (preferred) or using something like htpasswd.<br />- Graphical indications for the channels status on the web control page (ex. red and green dots).</p><p>Is anyone willing to help me? <br />Please do not use PHP, it&#039;s too resources costly for this small router <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>											<p class="post-edited">(Last edited by <strong>pilovis</strong> on 29 Dec 2014, 20:56)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259134">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">hoatienii</div>
					<div class="post-datetime">
						30 Dec 2014, 04:33					</div>
				</div>
				<div class="post-content content">
					<p>Use USB drive for more storage. My router dlink dir615c2 400mhz,4MB flash, i use usb drive for more storage to install php and lighttpd. My web control run php with display status of relay. <br />Here my index.php<br /></p><div class="codebox"><pre><code>&lt;?php
@ob_start();
session_start();
$up = array(
    &#039;u&#039;    =&gt; &quot;d033e22ae348aeb5660fc2140aec35850c4da997&quot;,
    &#039;p&#039;    =&gt; &quot;d033e22ae348aeb5660fc2140aec35850c4da997&quot;
);
if(isset($_POST[&#039;login&#039;]) &amp;&amp; $up[&#039;u&#039;]===sha1($_POST[&#039;username&#039;]) &amp;&amp; $up[&#039;p&#039;]===sha1($_POST[&#039;password&#039;])){
    $_SESSION[&#039;username&#039;] = $_POST[&#039;username&#039;];
    $_SESSION[&#039;password&#039;] = $_POST[&#039;password&#039;];
};
if(isset($_POST[&#039;logout&#039;])){
    unset($_SESSION[&#039;username&#039;]);
    unset($_SESSION[&#039;password&#039;]);
}

if(isset($_SESSION[&#039;username&#039;]) &amp;&amp; isset($_SESSION[&#039;password&#039;])){
    if($up[&#039;u&#039;]===sha1($_SESSION[&#039;username&#039;]) &amp;&amp; $up[&#039;p&#039;]===sha1($_SESSION[&#039;password&#039;])){
        
        $arrMode = array(
            &#039;status0&#039;    =&gt; &#039;cat /sys/class/gpio/gpio0/value&#039;,
            &#039;on one&#039;    =&gt; &quot;echo &#039;0&#039; &gt; /sys/class/gpio/gpio0/value&quot;, 
            &#039;off one&#039;    =&gt; &quot;echo &#039;1&#039; &gt; /sys/class/gpio/gpio0/value&quot;,
            &#039;status2&#039;    =&gt; &#039;cat /sys/class/gpio/gpio2/value&#039;,
            &#039;on two&#039;    =&gt; &quot;echo &#039;0&#039; &gt; /sys/class/gpio/gpio2/value&quot;, 
            &#039;off two&#039;    =&gt; &quot;echo &#039;1&#039; &gt; /sys/class/gpio/gpio2/value&quot;, 
            &#039;status7&#039;    =&gt; &#039;cat /sys/class/gpio/gpio7/value&#039;,
            &#039;on three&#039;    =&gt; &quot;echo &#039;0&#039; &gt; /sys/class/gpio/gpio7/value&quot;, 
            &#039;off three&#039;    =&gt; &quot;echo &#039;1&#039; &gt; /sys/class/gpio/gpio7/value&quot;, 
            &#039;status9&#039;    =&gt; &#039;cat /sys/class/gpio/gpio9/value&#039;,
            &#039;on four&#039;    =&gt; &quot;echo &#039;0&#039; &gt; /sys/class/gpio/gpio9/value&quot;, 
            &#039;off four&#039;    =&gt; &quot;echo &#039;1&#039; &gt; /sys/class/gpio/gpio9/value&quot;, 
        );
        
        if(isset($_POST[&#039;router&#039;])) {
            // $contents = file_get_contents(&quot;{$_SERVER[&#039;DOCUMENT_ROOT&#039;]}./{$_POST[&#039;router&#039;]}.sh&quot;);
            echo shell_exec($arrMode[$_POST[&#039;router&#039;]]);
        }
        $status0 = shell_exec($arrMode[&#039;status0&#039;]);
        $status2 = shell_exec($arrMode[&#039;status2&#039;]);
        $status7 = shell_exec($arrMode[&#039;status7&#039;]);
        $status9 = shell_exec($arrMode[&#039;status9&#039;]);
        ?&gt;
        &lt;style&gt;
            form{
                width: 226px;
            }
            input{
                margin-top: 5px;
                margin-bottom: 5px;
                color: #fff;
                text-decoration: none;
                display: inline-block;
                padding: 6px 12px;
                font-weight: 400;
                line-height: 1.42857143;
                background-image: none;
                border: 1px solid transparent;
                border-radius: 4px;
                font-family: inherit;
                -webkit-appearance: button;
                cursor: pointer;
                text-transform: none;
                overflow: visible;
                width: 100px;
                font-size: 14px;
            }
            input.on{
                background-color: #449d44;
                border-color: #398439;
            }
            input.off{
                background-color: #E40606;
                border-color: #E40606;
            }
            @media only screen and (max-device-width: 480px){
                form{
                    width: 100%;
                }
                input {
                    width: 100%;
                    height: 100px;
                    font-size: 50px;
                }
            }
        &lt;/style&gt;
        &lt;form method=&quot;post&quot; action=&quot;&lt;?php echo $_SERVER[&#039;PHP_SELF&#039;]; ?&gt;&quot;&gt;
            &lt;input class=&quot;&lt;?php if((int)($status0)==0) echo &#039;on&#039;; else echo &#039;off&#039;;?&gt;&quot; type=&quot;submit&quot; name=&quot;router&quot; value=&quot;&lt;?php if((int)($status0)==1) echo &#039;on&#039;; else echo &#039;off&#039;;?&gt; one&quot;&gt;&lt;br&gt;
            &lt;input class=&quot;&lt;?php if((int)($status2)==0) echo &#039;on&#039;; else echo &#039;off&#039;;?&gt;&quot; type=&quot;submit&quot; name=&quot;router&quot; value=&quot;&lt;?php if((int)($status2)==1) echo &#039;on&#039;; else echo &#039;off&#039;;?&gt; two&quot;&gt;&lt;br&gt;
            &lt;input class=&quot;&lt;?php if((int)($status7)==0) echo &#039;on&#039;; else echo &#039;off&#039;;?&gt;&quot; type=&quot;submit&quot; name=&quot;router&quot; value=&quot;&lt;?php if((int)($status7)==1) echo &#039;on&#039;; else echo &#039;off&#039;;?&gt; three&quot;&gt;&lt;br&gt;
            &lt;input class=&quot;&lt;?php if((int)($status9)==0) echo &#039;on&#039;; else echo &#039;off&#039;;?&gt;&quot; type=&quot;submit&quot; name=&quot;router&quot; value=&quot;&lt;?php if((int)($status9)==1) echo &#039;on&#039;; else echo &#039;off&#039;;?&gt; four&quot;&gt;&lt;br&gt;
            &lt;hr&gt;
            &lt;input class=&quot;off&quot; type=&quot;submit&quot; name=&quot;logout&quot; value=&quot;Log Out&quot;&gt;&lt;br&gt; 
        &lt;/form&gt;
        &lt;?php
    } else {
        // clear session
        unset($_SESSION[&#039;username&#039;]);
        unset($_SESSION[&#039;password&#039;]);
    }
}else{
    ?&gt;
        &lt;style&gt;
            form{
                margin: 0 auto;
                padding: 20px;
                width: 226px;
            }
            input {
                margin: 10px 0px 10px 10px;
                width: 173px;
                width: 100px;
                font-size: 14px;
            }
            input[type=&quot;submit&quot;] {
                padding: 5px;
                width: 70px;
                float: right;
            }
            @media only screen and (max-device-width: 480px){
                form{
                    width: 100%;
                }
                input {
                    width: 100%;
                    height: 100px;
                    font-size: 50px;
                }
                input[type=&quot;submit&quot;] {
                    width: 100%;
                }
            }
        &lt;/style&gt;
        &lt;form method=&quot;post&quot; action=&quot;&lt;?php echo $_SERVER[&#039;PHP_SELF&#039;]; ?&gt;&quot;&gt;
            User : &lt;input type=&quot;text&quot; name=&quot;username&quot;&gt;&lt;br&gt;
            Pass : &lt;input type=&quot;password&quot; name=&quot;password&quot;&gt;&lt;br&gt;
            &lt;input type=&quot;submit&quot; name=&quot;login&quot; value=&quot;Login&quot;&gt;
        &lt;/form&gt;
    &lt;?php
    
}
?&gt;</code></pre></div><br /><p>default user/pass is admin/admin</p><p><span class="postimg"><img src="https://lh3.googleusercontent.com/-pftJGLXMhp4/VKCSpCYgBvI/AAAAAAAAJnQ/p5fQk3NcgVE/w361-h577-no/Screenshot_2014-12-29-01-44-26.png" alt="https://lh3.googleusercontent.com/-pftJGLXMhp4/VKCSpCYgBvI/AAAAAAAAJnQ/p5fQk3NcgVE/w361-h577-no/Screenshot_2014-12-29-01-44-26.png" /></span></p><p><span class="postimg"><img src="https://lh6.googleusercontent.com/-s5nRG3GUGLk/VKCSoE9bjSI/AAAAAAAAJnE/52m9UF1kNBQ/w361-h577-no/Screenshot_2014-12-29-01-44-05.png" alt="https://lh6.googleusercontent.com/-s5nRG3GUGLk/VKCSoE9bjSI/AAAAAAAAJnE/52m9UF1kNBQ/w361-h577-no/Screenshot_2014-12-29-01-44-05.png" /></span></p>											<p class="post-edited">(Last edited by <strong>hoatienii</strong> on 30 Dec 2014, 04:49)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259139">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">pilovis</div>
					<div class="post-datetime">
						30 Dec 2014, 06:45					</div>
				</div>
				<div class="post-content content">
					<p>Nice <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Good job!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p259140">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">hoatienii</div>
					<div class="post-datetime">
						30 Dec 2014, 07:10					</div>
				</div>
				<div class="post-content content">
					<p>Only triggerhappy package for support keyboard?</p>											<p class="post-edited">(Last edited by <strong>hoatienii</strong> on 30 Dec 2014, 08:35)</p>
									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 1 of 4</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=54722&amp;p=2.html">2</a></li><li><a href="viewtopic.php%3Fid=54722&amp;p=3.html">3</a></li><li><a href="viewtopic.php%3Fid=54722&amp;p=4.html">4</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>