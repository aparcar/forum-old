<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> How to change -mfloat-abi to softfp from hard..?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 2 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p336523">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">rameshbabu.p</div>
					<div class="post-datetime">
						30 Aug 2016, 15:10					</div>
				</div>
				<div class="post-content content">
					<p>Hi All,</p><p>I am working on 14.08 and 16.02 openWRT code. I am getting an error when I compile my code in openWRT 16.02 and 14.08. The error is </p><p>/home/ramesh/GIT_TEST_1408_cns3xxx_2/md_es_1408/gateworks-openwrt_1408/trunk/staging_dir/toolchain-arm_mpcore+vfp_gcc-4.8-linaro_uClibc-0.9.33.2_eabi/lib/gcc/arm-openwrt-linux-uclibcgnueabi/4.8.3<strong>/../../../../arm-openwrt-linux-uclibcgnueabi/bin/ld: error: patcher uses VFP register arguments, </strong>/home/ramesh/GIT_TEST_1408_cns3xxx_2/md_es_1408/gateworks-openwrt_1408/trunk/staging_dir/target-arm_mpcore+vfp_uClibc-0.9.33.2_eab<strong>i/usr/share/md-meshap/aes/aes_wrap.o does not</strong></p><p>/home/ramesh/GIT_TEST_1408_cns3xxx_2/md_es_1408/gateworks-openwrt_1408/trunk/staging_dir/toolchain-arm_mpcore+vfp_gcc-4.8-linaro_uClibc-0.9.33.2_eabi/lib/gcc/arm-openwrt-linux-uclibcgnueabi/4.8.3/../../../../arm-openwrt-linux-uclibcgnueabi<strong>/bin/ld: failed to merge target specific data of file</strong> /home/ramesh/GIT_TEST_1408_cns3xxx_2/md_es_1408/gateworks-openwrt_1408/trunk/staging_dir/target-arm_mpcore+vfp_uClibc-0.9.33.2_eabi/usr/share/md-meshap/aes/aes_wrap.o<br /><strong>collect2: error: ld returned 1 exit status</strong><br />make[5]: *** [patcher] Error 1<br />make[5]: Leaving directory `/home/ramesh/GIT_TEST_1408_cns3xxx_2/md_es_1408/gateworks-openwrt_1408/trunk/build_dir/target-arm_mpcore+vfp_uClibc-0.9.33.2_eabi/patcher&#039;<br />make[4]: *** [/home/ramesh/GIT_TEST_1408_cns3xxx_2/md_es_1408/gateworks-openwrt_1408/trunk/build_dir/target-arm_mpcore+vfp_uClibc-0.9.33.2_eabi/patcher/.built] Error 2<br />make[4]: Leaving directory `/home/ramesh/GIT_TEST_1408_cns3xxx_2/md_es_1408/gateworks-openwrt_1408/trunk/package/embeddedstudios/md-patcher&#039;<br />make[3]: *** [package/embeddedstudios/md-patcher/compile] Error 2<br />make[3]: *** Waiting for unfinished jobs....</p><br /><p>I have googled this error, People are saying we can correct this error by changing <strong>-mfloat-abi to softfp from hard.</strong></p><p>I tried changing it.. But I couldn&#039;t do it .. So can anyone suggest me to change this..??</p><br /><p>Thanks,<br />Ramesh</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p336561">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">elektroman</div>
					<div class="post-datetime">
						30 Aug 2016, 19:38					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>rameshbabu.p wrote:</cite><blockquote><p>I have googled this error, People are saying we can correct this error by changing <strong>-mfloat-abi to softfp from hard.</strong></p><p>I tried changing it.. But I couldn&#039;t do it .. So can anyone suggest me to change this..??</p></blockquote></div><p>There is some trouble with your toolchain.<br /></p><div class="codebox"><pre><code>make dirclean</code></pre></div><p>will fix this.<br />A this pint OpenWRT creates a shiny new toolchain</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p338478">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">rameshbabu.p</div>
					<div class="post-datetime">
						17 Sep 2016, 14:41					</div>
				</div>
				<div class="post-content content">
					<p>Hi Elektroman,</p><p>I have tried doing make dirclean and then gave a compile. <strong>But still mfloat-abi is hard only</strong></p><p>Please give some more info on this.</p><p>Thanks,<br />Ramesh</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p338506">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">elektroman</div>
					<div class="post-datetime">
						17 Sep 2016, 22:12					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>rameshbabu.p wrote:</cite><blockquote><p>I have tried doing make dirclean and then gave a compile. <strong>But still mfloat-abi is hard only</strong></p></blockquote></div><p>They must be some error in .config<br />The simplest way is to start from a clean (removed) one.</p><p>I checked current git with uClibc and this compiles like a charm.<br />For doing this enable<br />[ ] Advanced configuration options-&gt;Show broken platforms</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p338636">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">rameshbabu.p</div>
					<div class="post-datetime">
						19 Sep 2016, 15:22					</div>
				</div>
				<div class="post-content content">
					<p>Hi Elektroman,</p><p>I have enabled <strong>[ ] Advanced configuration options-&gt;Show broken platforms</strong> this flag in configuration and I given a clean build.</p><p>But still <strong>mfloat-abi is hard</strong> only</p><p>Please suggest me some more info on this.</p><p>Thanks,<br />Ramesh</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p343194">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">rameshbabu.p</div>
					<div class="post-datetime">
						7 Nov 2016, 12:47					</div>
				</div>
				<div class="post-content content">
					<p>Still am not able to make it to soft...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p343231">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">dl12345</div>
					<div class="post-datetime">
						7 Nov 2016, 19:17					</div>
				</div>
				<div class="post-content content">
					<p>Soft float is an explicit CONFIG option.</p><div class="codebox"><pre><code>make menuconfig
Advanced Configuration Options (for developers) --&gt; Target Options --&gt; Use software floating point by default</code></pre></div><p>If you&#039;re lazy, just edit the .config and add the option CONFIG_SOFT_FLOAT=y. You will need to do a make dirclean and completely rebuild your toolchain. The soft float option depends on one of the following targets being set: arm || armeb || powerpc || mipsel || mips || mips64el || mips64</p><p>On a more fundamental level, you appear to have an ABI mismatch and blindly changing the SOFT_FLOAT option may or may not fix it. That is to say, your patcher app seems to be using hard float ABI and the aes_wrap.o component is using soft float ABI. The error message &quot;patcher uses VFP register arguments ..... /aes/aes_wrap.o does not&quot; indicates an ABI mismatch.</p><p>What is this &quot;patcher&quot; and &quot;mdmeshapp&quot; you are trying to compile? Are they both Openwrt packages or your own code? If it is your own code, then you might be compiling it with incorrect command line switches to GCC.</p><p>Suggest posting your Makefiles....</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p344652">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">rameshbabu.p</div>
					<div class="post-datetime">
						24 Nov 2016, 07:57					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dl12345 wrote:</cite><blockquote><p>Soft float is an explicit CONFIG option.</p><div class="codebox"><pre><code>make menuconfig
Advanced Configuration Options (for developers) --&gt; Target Options --&gt; Use software floating point by default</code></pre></div><p>If you&#039;re lazy, just edit the .config and add the option CONFIG_SOFT_FLOAT=y. You will need to do a make dirclean and completely rebuild your toolchain. The soft float option depends on one of the following targets being set: arm || armeb || powerpc || mipsel || mips || mips64el || mips64</p><p>On a more fundamental level, you appear to have an ABI mismatch and blindly changing the SOFT_FLOAT option may or may not fix it. That is to say, your patcher app seems to be using hard float ABI and the aes_wrap.o component is using soft float ABI. The error message &quot;patcher uses VFP register arguments ..... /aes/aes_wrap.o does not&quot; indicates an ABI mismatch.</p><p>What is this &quot;patcher&quot; and &quot;mdmeshapp&quot; you are trying to compile? Are they both Openwrt packages or your own code? If it is your own code, then you might be compiling it with incorrect command line switches to GCC.</p><p>Suggest posting your Makefiles....</p></blockquote></div><br /><p>Its working for me. I have manually edited the .config file and tried its working but it is not working when I do it via make menuconfig. </p><p>But I have a doubt, If we use softap mfloat-abi will it take more CPU cycles..?</p><p>&quot;patcher&quot; and &quot;mdmeshapp&quot; these are my own source code. </p><p>Thanks,<br />Ramesh</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p344671">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">dl12345</div>
					<div class="post-datetime">
						24 Nov 2016, 14:22					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>rameshbabu.p wrote:</cite><blockquote><p>But I have a doubt, If we use softap mfloat-abi will it take more CPU cycles..?</p></blockquote></div><p>Yes</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p344752">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">rameshbabu.p</div>
					<div class="post-datetime">
						25 Nov 2016, 13:36					</div>
				</div>
				<div class="post-content content">
					<p>Then I have to go with mfloat as hard only in order to reduce the usage of CPU cycle. <br />So Can I fix this linking error when I use hard?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p344756">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">dl12345</div>
					<div class="post-datetime">
						25 Nov 2016, 13:54					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>rameshbabu.p wrote:</cite><blockquote><p>Then I have to go with mfloat as hard only in order to reduce the usage of CPU cycle. <br />So Can I fix this linking error when I use hard?</p></blockquote></div><p>Yes, use the correct compiler options in your Makefiles, but you haven&#039;t posted your makefiles</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>