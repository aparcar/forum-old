<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> CPU Frequency Scaling on x86</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 12 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p277451">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">mamarley</div>
					<div class="post-datetime">
						25 May 2015, 03:57					</div>
				</div>
				<div class="post-content content">
					<p>I have just installed the 15.05-rc1 x86 generic build on an older laptop with a Core 2 Duo T7500 processor.&nbsp; Almost everything is working fine, but the CPU runs continuously at the full speed of 2.2gHz instead of throttling down when idle as it should.&nbsp; I searched the forum, wiki, and Google and looked through the list of available packages for anything cpufreq related, but couldn&#039;t find anything.&nbsp; Is it possible to get CPU frequency scaling to work with OpenWRT x86, or would it be necessary to recompile the kernel for this?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p277492">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">mirko_47</div>
					<div class="post-datetime">
						25 May 2015, 14:54					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m not able to answer to your question, and I&#039;m sorry about that, but since I saw CPU frequency scaling options only into kernel menuconfig I think that it is necessary to recompile, but as I said I&#039;m not sure.</p><p>In any case, I&#039;m curious, how did u measured the CPU frequency?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p277493">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">mamarley</div>
					<div class="post-datetime">
						25 May 2015, 14:57					</div>
				</div>
				<div class="post-content content">
					<p>I used &quot;cat /proc/cpuinfo&quot;.</p><p>I can definitely recompile the kernel and I may very well end up doing that; I was just hoping to avoid that <img src="https://forum.openwrt.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p277505">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">mirko_47</div>
					<div class="post-datetime">
						25 May 2015, 16:22					</div>
				</div>
				<div class="post-content content">
					<p>If I don&#039;t mistake cpuinfo contains only the info about the CPU, I mean it&#039;s a static read of the cpu properties (stuff like cache, cores, ...), is not a dynamic read of the status of the CPU.<br />So the frequency that you&#039;re reading is the is the maximum frequency of the CPU.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p277506">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">zo0ok</div>
					<div class="post-datetime">
						25 May 2015, 16:29					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>mirko_47 wrote:</cite><blockquote><p>If I don&#039;t mistake cpuinfo contains only the info about the CPU, I mean it&#039;s a static read of the cpu properties (stuff like cache, cores, ...), is not a dynamic read of the status of the CPU.<br />So the frequency that you&#039;re reading is the is the maximum frequency of the CPU.</p></blockquote></div><p>I dont think so (my CPU is 3GHz)</p><div class="codebox"><pre><code>$ cat /proc/cpuinfo 
processor    : 0
vendor_id    : AuthenticAMD
cpu family    : 16
model        : 6
model name    : AMD Athlon(tm) II X2 250 Processor
stepping    : 2
microcode    : 0x100009f
cpu MHz        : 800.000
cache size    : 1024 KB
physical id    : 0
siblings    : 2
core id        : 0
cpu cores    : 2
apicid        : 0
initial apicid    : 0
fpu        : yes
fpu_exception    : yes
cpuid level    : 5
wp        : yes
flags        : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ht syscall nx mmxext fxsr_opt pdpe1gb rdtscp lm 3dnowext 3dnow constant_tsc rep_good nopl nonstop_tsc extd_apicid pni monitor cx16 popcnt lahf_lm cmp_legacy svm extapic cr8_legacy abm sse4a misalignsse 3dnowprefetch osvw ibs skinit wdt hw_pstate npt lbrv svm_lock nrip_save vmmcall
bugs        : tlb_mmatch apic_c1e fxsave_leak
bogomips    : 5999.78
TLB size    : 1024 4K pages
clflush size    : 64
cache_alignment    : 64
address sizes    : 48 bits physical, 48 bits virtual
power management: ts ttp tm stc 100mhzsteps hwpstate

...and the other core...</code></pre></div><p>The 800Mhz value changes with load.<br />This is not from OpenWrt though, but I guess the Linux kernel behaves and reports the same in OpenWrt and Xubuntu.</p>											<p class="post-edited">(Last edited by <strong>zo0ok</strong> on 25 May 2015, 16:30)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p277508">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">zo0ok</div>
					<div class="post-datetime">
						25 May 2015, 16:40					</div>
				</div>
				<div class="post-content content">
					<p>I would check:<br /></p><div class="codebox"><pre><code>/sys/bus/cpu/drivers/processor/cpu0/cpufreq</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p277509">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">mamarley</div>
					<div class="post-datetime">
						25 May 2015, 16:42					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>zo0ok wrote:</cite><blockquote><p>I would check:<br /></p><div class="codebox"><pre><code>/sys/bus/cpu/drivers/processor/cpu0/cpufreq</code></pre></div></blockquote></div><p>That file doesn&#039;t exist.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p277511">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">zo0ok</div>
					<div class="post-datetime">
						25 May 2015, 16:48					</div>
				</div>
				<div class="post-content content">
					<p>Ok... I dont have an x86/x64 OpenWrt-machine. You should have<br /></p><div class="codebox"><pre><code>/sys/bus/cpu/drivers</code></pre></div><p>On my OpenWrt (ar71xx) that folder is empty, but in Xubuntu (x64) it contains stuff.</p><p>I think usually you should have some daemon checking system load and adjusting cpufreq. But I think you can also manually change cpufreq by writing to (virtual) files somewhere under that folder. However, as mentioned earlier, a kernel recompile or kernel module might be required. Again, no personal experience with OpenWrt on x64.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p277513">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">mamarley</div>
					<div class="post-datetime">
						25 May 2015, 16:51					</div>
				</div>
				<div class="post-content content">
					<p>There isn&#039;t anything under there pertaining to cpufreq, so I did &quot;ls -al / | grep -i cpufreq&quot; and that didn&#039;t turn up anything either.&nbsp; It looks like the OpenWRT kernel just doesn&#039;t support it on x86.&nbsp; I should probably file a bug.&nbsp; That is a pretty important thing to be missing.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p277519">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">mirko_47</div>
					<div class="post-datetime">
						25 May 2015, 17:43					</div>
				</div>
				<div class="post-content content">
					<p>maybe this can help you:<br /><a href="http://unix.stackexchange.com/a/87537">http://unix.stackexchange.com/a/87537</a><br />so it seems that I was defenetly wrong, sorry.</p>											<p class="post-edited">(Last edited by <strong>mirko_47</strong> on 25 May 2015, 22:53)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p277603">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						26 May 2015, 15:21					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>mamarley wrote:</cite><blockquote><div class="quotebox"><cite>zo0ok wrote:</cite><blockquote><p>I would check:<br /></p><div class="codebox"><pre><code>/sys/bus/cpu/drivers/processor/cpu0/cpufreq</code></pre></div></blockquote></div><p>That file doesn&#039;t exist.</p></blockquote></div><p>On my GoFLEX Home, it is under (which is a symbolic link):<br /></p><div class="codebox"><pre><code>[root@GoFLEX:/root 20%] # ls /sys/bus/cpu/devices/cpu0/cpufreq/cpuinfo_cur_freq</code></pre></div><p>When my system is idle, the CPU frequency shows about 400 MHz as below:<br /></p><div class="codebox"><pre><code>[root@GoFLEX:/root 20%] # cat /sys/bus/cpu/devices/cpu0/cpufreq/cpuinfo_cur_freq 
400000
[root@GoFLEX:/root 21%] # cat /proc/cpuinfo 
processor    : 0
model name    : Feroceon 88FR131 rev 1 (v5l)
BogoMIPS    : 397.03
Features    : swp half fastmult edsp 
CPU implementer    : 0x56
CPU architecture: 5TE
CPU variant    : 0x2
CPU part    : 0x131
CPU revision    : 1

Hardware    : Marvell Kirkwood (Flattened Device Tree)
Revision    : 0000
Serial        : 0000000000000000
[root@GoFLEX:/root 22%] #</code></pre></div><p>However, when I start doing some heavy works on my GoFLEX Home, the CPU frequency throttled to max as shown below:<br /></p><div class="codebox"><pre><code>[root@GoFLEX:/root 23%] # cat /sys/bus/cpu/devices/cpu0/cpufreq/cpuinfo_cur_freq
1200000
[root@GoFLEX:/root 24%] # cat /proc/cpuinfo
processor    : 0
model name    : Feroceon 88FR131 rev 1 (v5l)
BogoMIPS    : 1191.11
Features    : swp half fastmult edsp 
CPU implementer    : 0x56
CPU architecture: 5TE
CPU variant    : 0x2
CPU part    : 0x131
CPU revision    : 1

Hardware    : Marvell Kirkwood (Flattened Device Tree)
Revision    : 0000
Serial        : 0000000000000000
[root@GoFLEX:/root 25%] #</code></pre></div>											<p class="post-edited">(Last edited by <strong>mazilo</strong> on 26 May 2015, 15:23)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p277637">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">mirko_47</div>
					<div class="post-datetime">
						26 May 2015, 22:26					</div>
				</div>
				<div class="post-content content">
					<p>from what I can see here: <a href="https://drive.google.com/file/d/0BxHW2MMDoAYfWXc1ZVF5MnVWVjg/view?usp=sharing">https://drive.google.com/file/d/0BxHW2M … sp=sharing</a><br />it seems that the default CPUFreq governor for x86 is performance, which sets the frequency to the max frequency; so as I said I&#039;m not sure, but maybe this can be the cause.</p><p>according to what is written here:<br /><a href="https://www.kernel.org/doc/Documentation/cpu-freq/governors.txt">https://www.kernel.org/doc/Documentatio … ernors.txt</a><br /><a href="https://wiki.archlinux.org/index.php/CPU_frequency_scaling">https://wiki.archlinux.org/index.php/CP … cy_scaling</a><br />you shuold use &quot;ondemand&quot; frequency scaling governor.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p300725">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">subbia</div>
					<div class="post-datetime">
						21 Nov 2015, 22:56					</div>
				</div>
				<div class="post-content content">
					<p>Guys,<br />sorry but I&#039;m playing with it and had no possibility to find any relevant infos around. Could you please explain to a newbie to openwrt how to turn on cpu prefquency scaling on x86? It&#039;s the only thing blocking me on putting it in production.</p><p>Thanks in advance!</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>