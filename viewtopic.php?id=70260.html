<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> WPA Enterprise client - can&#039;t connect to network</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 20 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p354428">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">juniorjpdj</div>
					<div class="post-datetime">
						17 Mar 2017, 16:55					</div>
				</div>
				<div class="post-content content">
					<p>Hi everyone,</p><p>I&#039;m tryharding to connect my openwrt mini-router to university wifi (WPA EAP).<br />I tried to use luci, but it&#039;s not working.<br />I&#039;ve installed full wpad and now I&#039;m trying to connect to network using wpa_supplicant.</p><p>I managed to connect to network on my PC using the same config of wpa_supplicant, but can&#039;t make it working at openwrt.</p><p>Log from pc:<br /></p><div class="codebox"><pre><code>juniorjpdj@Junior-x220 ~/root % sudo wpa_supplicant -iwlp3s0 -csupp.cfg
Successfully initialized wpa_supplicant
wlp3s0: SME: Trying to authenticate with 00:04:96:82:d8:80 (SSID=&#039;eduroam&#039; freq=5260 MHz)
wlp3s0: Trying to associate with 00:04:96:82:d8:80 (SSID=&#039;eduroam&#039; freq=5260 MHz)
wlp3s0: Associated with 00:04:96:82:d8:80
wlp3s0: CTRL-EVENT-SUBNET-STATUS-UPDATE status=0
wlp3s0: CTRL-EVENT-EAP-STARTED EAP authentication started
wlp3s0: CTRL-EVENT-EAP-PROPOSED-METHOD vendor=0 method=25 -&gt; NAK
wlp3s0: CTRL-EVENT-EAP-PROPOSED-METHOD vendor=0 method=13
wlp3s0: CTRL-EVENT-EAP-METHOD EAP vendor 0 method 13 (TLS) selected
wlp3s0: CTRL-EVENT-EAP-PEER-CERT depth=1 subject=&#039;/DC=pl/DC=edu/DC=put/DC=local/CN=ADENA-CA&#039; hash=a4882294ffd8d3ff9cce3ba2cf3b224798c55d7997bed9bca560aeca3f76c0b8
wlp3s0: CTRL-EVENT-EAP-PEER-CERT depth=1 subject=&#039;/DC=pl/DC=edu/DC=put/DC=local/CN=ADENA-CA&#039; hash=a4882294ffd8d3ff9cce3ba2cf3b224798c55d7997bed9bca560aeca3f76c0b8
wlp3s0: CTRL-EVENT-EAP-PEER-CERT depth=0 subject=&#039;/C=PL/ST=Wielkopolska/L=Poznan/O=Politechnika Poznanska/OU=DOiE/CN=nac.put.poznan.pl&#039; hash=44314dad99255cc647e21db82810fe57c06484692a5393d60196639f6e39bdde
wlp3s0: CTRL-EVENT-EAP-SUCCESS EAP authentication completed successfully
wlp3s0: WPA: Key negotiation completed with 00:04:96:82:d8:80 [PTK=CCMP GTK=CCMP]
wlp3s0: CTRL-EVENT-CONNECTED - Connection to 00:04:96:82:d8:80 completed [id=0 id_str=]
^Cwlp3s0: CTRL-EVENT-DISCONNECTED bssid=00:04:96:82:d8:80 reason=3 locally_generated=1
nl80211: deinit ifname=wlp3s0 disabled_11b_rates=0
wlp3s0: CTRL-EVENT-TERMINATING </code></pre></div><p>Log from openwrt:<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# wpa_supplicant -iwlan0 -csupp.cfg
Successfully initialized wpa_supplicant
wlan0: SME: Trying to authenticate with 00:04:96:82:e5:00 (SSID=&#039;eduroam&#039; freq=2442 MHz)
wlan0: SME: Trying to authenticate with 00:04:96:85:28:f0 (SSID=&#039;eduroam&#039; freq=2442 MHz)
wlan0: Trying to associate with 00:04:96:85:28:f0 (SSID=&#039;eduroam&#039; freq=2442 MHz)
wlan0: Associated with 00:04:96:85:28:f0
wlan0: CTRL-EVENT-DISCONNECTED bssid=00:04:96:85:28:f0 reason=4 locally_generated=1
wlan0: SME: Trying to authenticate with 00:04:96:85:5d:d0 (SSID=&#039;eduroam&#039; freq=2412 MHz)
wlan0: Trying to associate with 00:04:96:85:5d:d0 (SSID=&#039;eduroam&#039; freq=2412 MHz)
wlan0: Associated with 00:04:96:85:5d:d0
wlan0: CTRL-EVENT-DISCONNECTED bssid=00:04:96:85:5d:d0 reason=4 locally_generated=1
wlan0: SME: Trying to authenticate with 00:04:96:82:e5:00 (SSID=&#039;eduroam&#039; freq=2442 MHz)
wlan0: Trying to associate with 00:04:96:82:e5:00 (SSID=&#039;eduroam&#039; freq=2442 MHz)
wlan0: Associated with 00:04:96:82:e5:00
wlan0: CTRL-EVENT-EAP-STARTED EAP authentication started
wlan0: CTRL-EVENT-EAP-PROPOSED-METHOD vendor=0 method=25 -&gt; NAK
wlan0: CTRL-EVENT-EAP-PROPOSED-METHOD vendor=0 method=13
PKCS #5: unsupported encryption algorithm 1.2.840.113549.1.5.13
TLSv1: Failed to parse private key
TLS: Failed to load private key
TLS: Failed to set TLS connection parameters
EAP-TLS: Failed to initialize SSL.
wlan0: EAP: Failed to initialize EAP method: vendor 0 method 13 (TLS)
wlan0: CTRL-EVENT-EAP-FAILURE EAP authentication failed
wlan0: CTRL-EVENT-DISCONNECTED bssid=00:04:96:82:e5:00 reason=23
wlan0: CTRL-EVENT-SSID-TEMP-DISABLED id=0 ssid=&quot;eduroam&quot; auth_failures=1 duration=10 reason=AUTH_FAILED
^Cnl80211: deinit ifname=wlan0 disabled_11b_rates=0
wlan0: CTRL-EVENT-TERMINATING 
root@OpenWrt:~# </code></pre></div><p>I also tried to install openssl and it didn&#039;t change anything :/</p><p>Can someone help me?</p><p>I almost forgot to give wpa_supplicant config, here is it:<br /></p><div class="codebox"><pre><code>network={
   ssid=&quot;eduroam&quot;
   key_mgmt=WPA-EAP
   eap=TLS
   identity=&quot;XXXX&quot;
   client_cert=&quot;/root/XXXX.crt&quot;
   private_key=&quot;/root/XXXX.key&quot;
   private_key_passwd=&quot;XXXXXXX&quot;
}</code></pre></div>											<p class="post-edited">(Last edited by <strong>juniorjpdj</strong> on 17 Mar 2017, 17:11)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>