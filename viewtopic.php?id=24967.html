<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> WR1043ND: Wireless clients disconect</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 24 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p109938">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">rymn</div>
					<div class="post-datetime">
						27 May 2010, 11:38					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>today i discovered a problem with my TP-Link WR1043ND running openwrt latest stable releasse.<br />The Wireless connection was cut of by the router and about one minute later i could reconnect (see logread on the bottom).<br />Why does the router disconnected the wireless-clients?</p><p>Thanks fpr help</p><p>Ray</p><p>May 27 09:13:08 openwrt daemon.info hostapd: wlan0: STA 00:04:20:YY:YY:YY WPA: group key handshake completed (RSN)<br />May 27 09:13:09 openwrt daemon.info hostapd: wlan0: STA 00:19:7d:XX:XX:XX WPA: group key handshake completed (RSN)<br />May 27 09:13:09 openwrt daemon.info hostapd: wlan0: STA 00:19:7d:XX:XX:XX WPA: received EAPOL-Key 2/2 Group with unexpected replay counter<br />May 27 09:23:08 openwrt daemon.info hostapd: wlan0: STA 00:19:7d:XX:XX:XX WPA: group key handshake completed (RSN)<br />May 27 09:23:08 openwrt daemon.info hostapd: wlan0: STA 00:04:20:YY:YY:YY WPA: group key handshake completed (RSN)<br />May 27 09:33:08 openwrt daemon.info hostapd: wlan0: STA 00:04:20:YY:YY:YY WPA: group key handshake completed (RSN)<br />May 27 09:33:08 openwrt daemon.info hostapd: wlan0: STA 00:19:7d:XX:XX:XX WPA: group key handshake completed (RSN)<br />May 27 09:43:08 openwrt daemon.info hostapd: wlan0: STA 00:04:20:YY:YY:YY WPA: group key handshake completed (RSN)<br />May 27 09:43:08 openwrt daemon.info hostapd: wlan0: STA 00:19:7d:XX:XX:XX WPA: group key handshake completed (RSN)<br />May 27 09:53:08 openwrt daemon.info hostapd: wlan0: STA 00:19:7d:XX:XX:XX WPA: group key handshake completed (RSN)<br />May 27 09:53:08 openwrt daemon.info hostapd: wlan0: STA 00:04:20:YY:YY:YY WPA: group key handshake completed (RSN)<br />May 27 10:03:08 openwrt daemon.info hostapd: wlan0: STA 00:04:20:YY:YY:YY WPA: group key handshake completed (RSN)<br />May 27 10:03:08 openwrt daemon.info hostapd: wlan0: STA 00:19:7d:XX:XX:XX WPA: group key handshake completed (RSN)<br />May 27 10:13:08 openwrt daemon.info hostapd: wlan0: STA 00:19:7d:XX:XX:XX WPA: group key handshake completed (RSN)<br />May 27 10:13:08 openwrt daemon.info hostapd: wlan0: STA 00:04:20:YY:YY:YY WPA: group key handshake completed (RSN)<br />May 27 10:23:08 openwrt daemon.info hostapd: wlan0: STA 00:19:7d:XX:XX:XX WPA: group key handshake completed (RSN)<br />May 27 10:23:08 openwrt daemon.info hostapd: wlan0: STA 00:04:20:YY:YY:YY WPA: group key handshake completed (RSN)<br />May 27 10:25:03 openwrt daemon.info dnsmasq-dhcp[1225]: DHCPREQUEST(br-lan) 192.168.1.6 00:01:e3:11:11:11<br />May 27 10:27:21 openwrt daemon.info dnsmasq-dhcp[1225]: DHCPDISCOVER(br-lan) 00:16:41:ZZ:ZZ:ZZ<br />May 27 10:27:21 openwrt daemon.info dnsmasq-dhcp[1225]: DHCPOFFER(br-lan) 192.168.1.3 00:16:41:ZZ:ZZ:ZZ<br />May 27 10:27:21 openwrt daemon.info dnsmasq-dhcp[1225]: DHCPREQUEST(br-lan) 192.168.1.3 00:16:41:ZZ:ZZ:ZZ<br />May 27 10:27:21 openwrt daemon.info dnsmasq-dhcp[1225]: DHCPACK(br-lan) 192.168.1.3 00:16:41:ZZ:ZZ:ZZ<br />May 27 10:27:31 openwrt authpriv.info dropbear[10476]: Child connection from 192.168.1.3:1271<br />May 27 10:27:36 openwrt authpriv.notice dropbear[10476]: password auth succeeded for &#039;root&#039; from 192.168.1.3:1271<br /><strong><br />May 27 10:28:28 openwrt daemon.info hostapd: wlan0: STA 00:19:7d:XX:XX:XX IEEE 802.11: disassociated due to inactivity<br />May 27 10:28:29 openwrt daemon.info hostapd: wlan0: STA 00:19:7d:XX:XX:XX IEEE 802.11: deauthenticated due to inactivity<br />May 27 10:28:58 openwrt daemon.info hostapd: wlan0: STA 00:04:20:YY:YY:YY IEEE 802.11: authenticated<br />May 27 10:28:58 openwrt daemon.info hostapd: wlan0: STA 00:04:20:YY:YY:YY IEEE 802.11: associated (aid 1)<br />May 27 10:28:58 openwrt daemon.info hostapd: wlan0: STA 00:04:20:YY:YY:YY WPA: pairwise key handshake completed (RSN)<br />May 27 10:29:16 openwrt daemon.info hostapd: wlan0: STA 00:19:7d:XX:XX:XX IEEE 802.11: authenticated<br />May 27 10:29:16 openwrt daemon.info hostapd: wlan0: STA 00:19:7d:XX:XX:XX IEEE 802.11: associated (aid 2)<br />May 27 10:29:16 openwrt daemon.info hostapd: wlan0: STA 00:19:7d:XX:XX:XX WPA: pairwise key handshake completed (RSN)<br /></strong><br />May 27 10:29:20 openwrt daemon.info dnsmasq-dhcp[1225]: DHCPDISCOVER(br-lan) 00:19:7d:XX:XX:XX<br />May 27 10:29:20 openwrt daemon.info dnsmasq-dhcp[1225]: DHCPOFFER(br-lan) 192.168.1.2 00:19:7d:XX:XX:XX<br />May 27 10:29:20 openwrt daemon.info dnsmasq-dhcp[1225]: DHCPREQUEST(br-lan) 192.168.1.2 00:19:7d:XX:XX:XX<br />May 27 10:29:20 openwrt daemon.info dnsmasq-dhcp[1225]: DHCPACK(br-lan) 192.168.1.2 00:19:7d:XX:XX:XX<br />May 27 10:29:24 openwrt daemon.info dnsmasq-dhcp[1225]: DHCPREQUEST(br-lan) 192.168.1.2 00:19:7d:XX:XX:XX<br />May 27 10:29:24 openwrt daemon.info dnsmasq-dhcp[1225]: DHCPACK(br-lan) 192.168.1.2 00:19:7d:XX:XX:XX</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p109949">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">mr_gobble</div>
					<div class="post-datetime">
						27 May 2010, 14:36					</div>
				</div>
				<div class="post-content content">
					<p>I am glad to see that I am not the only one experiencing this.&nbsp; In my case, I think it might have something to do with the Wireless N capability.&nbsp; I have another laptop that only has a Wireless G network card and it has not had any issues.&nbsp; I think I am going to disable the Wireless N capabilities on the router for now and see if this problem goes away.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111347">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Noerr</div>
					<div class="post-datetime">
						17 Jun 2010, 01:28					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve updated to newest trunk r21744&nbsp; (10.jun.2010)<br />and still having drop outs every once in a while.&nbsp; Sometimes I&#039;m able to reconnect after several tries sometimes I can&#039;t any more<br />error logs<br /></p><div class="codebox"><pre><code>hostapd: wlan0: STA 11:22:33:44:55:66 WPA: received EAPOL-Key 2/4 Pairwise with unexpected replay counter
....
Jun 16 22:46:21 owrt daemon.info hostapd: wlan0: STA 11:22:33:44:55:66 IEEE 802.11: authenticated
Jun 16 22:46:21 owrt daemon.info hostapd: wlan0: STA 11:22:33:44:55:66 IEEE 802.11: associated (aid 1)
Jun 16 22:46:24 owrt daemon.info hostapd: wlan0: STA 11:22:33:44:55:66 IEEE 802.11: deauthenticated due to local deauth request</code></pre></div><p>Should this be a bug report?</p><p>Regards</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111350">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Pitou</div>
					<div class="post-datetime">
						17 Jun 2010, 02:35					</div>
				</div>
				<div class="post-content content">
					<p>Noerr,</p><p>I get exactly the same error along with other ones.</p><p>I don&#039;t know how to report a bug, but I think it would be a good time.</p><p>Pitou!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111366">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">MaSTeRMinD</div>
					<div class="post-datetime">
						17 Jun 2010, 11:16					</div>
				</div>
				<div class="post-content content">
					<p>There is bug report <a href="https://dev.openwrt.org/ticket/7363">https://dev.openwrt.org/ticket/7363</a><br />Not sure if we need another one, but problem is serious and the only solution is G mode.<br />In G+N mode sometimes client is disconnected, sometimes router wireless crashes and only reboot fixes it. The problem occurs with all N clients.</p>											<p class="post-edited">(Last edited by <strong>MaSTeRMinD</strong> on 17 Jun 2010, 11:19)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111377">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Pitou</div>
					<div class="post-datetime">
						17 Jun 2010, 14:00					</div>
				</div>
				<div class="post-content content">
					<p>This bug report seems fine to me and btw setting HT20 only and I really mean no other parameter like SHORT-GI or anything else. Check your /var/run/hostapd-phy0.conf and look for the &quot;ht_capab&quot; line. make sure it contains only [HT20]. It seems more stable for me. No disconnect since 24 hours.</p><p>Pitou.</p>											<p class="post-edited">(Last edited by <strong>Pitou</strong> on 17 Jun 2010, 14:04)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111653">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">Noerr</div>
					<div class="post-datetime">
						21 Jun 2010, 12:08					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve updated to r21838 firmware with hope something changed.</p><p>btw:&nbsp; is there any changelog for trunk releases?</p><p>I&#039;ll try with HT-20 only config after I try latest firmware for a while.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111654">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						21 Jun 2010, 12:11					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Noerr wrote:</cite><blockquote><p>btw:&nbsp; is there any changelog for trunk releases?</p></blockquote></div><p>See <a href="https://dev.openwrt.org/log/trunk">https://dev.openwrt.org/log/trunk</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111917">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">Noerr</div>
					<div class="post-datetime">
						25 Jun 2010, 20:35					</div>
				</div>
				<div class="post-content content">
					<p>thanks jow, that is very useful.</p><p>I&#039;ve updated to&nbsp; &nbsp;r21859 23.jun.2010, and&nbsp; so far runs smooth.&nbsp; No disconnects yet.&nbsp; Have to test few more days, but it seem it&#039;s more stable.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111973">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">Pitou</div>
					<div class="post-datetime">
						26 Jun 2010, 20:59					</div>
				</div>
				<div class="post-content content">
					<p>Noerr, could you post your wireless settings?</p><p>Thanks!</p><p>Pitou!</p>											<p class="post-edited">(Last edited by <strong>Pitou</strong> on 26 Jun 2010, 21:04)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p112051">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">dirtyfreebooter</div>
					<div class="post-datetime">
						28 Jun 2010, 00:16					</div>
				</div>
				<div class="post-content content">
					<p>Agreed. Noerr please post your settings. I am using trunk with a DIR-825 and this disconnecting is annoying to see the least :-)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p112493">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">Noerr</div>
					<div class="post-datetime">
						5 Jul 2010, 14:38					</div>
				</div>
				<div class="post-content content">
					<p>sorry for late reply<br />my settings are plain and simple.<br />/etc/config/wireless<br /></p><div class="codebox"><pre><code>config wifi-device  radio0
        option type     mac80211
        option channel  5
        option macaddr  00:11:22:33:44:55
        option hwmode   11ng
        option htmode   HT20
        list ht_capab   SHORT-GI-40
        list ht_capab   DSSS_CCK-40
        # REMOVE THIS LINE TO ENABLE WIFI:
        option disabled 0

config wifi-iface
        option device   radio0
        option network  lan
        option mode     ap
        option ssid     OPENWRT
        option encryption psk2
        option key      MyPass</code></pre></div><p>/etc/config/network<br /></p><div class="codebox"><pre><code>config &#039;interface&#039; &#039;loopback&#039;
       option &#039;ifname&#039;   &#039;lo&#039;
       option &#039;proto&#039;    &#039;static&#039;
       option &#039;ipaddr&#039;   &#039;127.0.0.1&#039;
       option &#039;netmask&#039;  &#039;255.0.0.0&#039;

config &#039;interface&#039; &#039;lan&#039;
        option &#039;ifname&#039;   &#039;eth0.1&#039;
        option &#039;type&#039;     &#039;bridge&#039;
        option &#039;proto&#039;    &#039;dhcp&#039;

config &#039;interface&#039; &#039;wan&#039;
        option &#039;ifname&#039; &#039;eth0.2&#039;
        option &#039;proto&#039; &#039;dhcp&#039;
        option mtu      1400      

config &#039;switch&#039;
        option &#039;name&#039; &#039;rtl8366rb&#039;
        option &#039;reset&#039; &#039;1&#039;
        option &#039;enable_vlan&#039; &#039;1&#039;

config &#039;switch_vlan&#039;
        option &#039;device&#039; &#039;rtl8366rb&#039;
        option &#039;vlan&#039; &#039;1&#039;
        option &#039;ports&#039; &#039;1 2 3 4 5t&#039;

config &#039;switch_vlan&#039;
        option &#039;device&#039; &#039;rtl8366rb&#039;
        option &#039;vlan&#039; &#039;2&#039;
        option &#039;ports&#039; &#039;0 5t&#039;</code></pre></div><p>Be aware my router is set as Access Point<br />I tested firmware revision from jun.30.2010, and still disconnects sometimes.</p><p>I also find interesting observation, that while I wasn&#039;t able to connect via WiFi, as soon as I&#039;ve plugged in eth cable and ssh to router, wifi started to work, without and fixes.</p><p>Regards</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p112529">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">Pitou</div>
					<div class="post-datetime">
						5 Jul 2010, 23:38					</div>
				</div>
				<div class="post-content content">
					<p>Noerr,</p><p>Latest trunk is much more stable. I&#039;ll keep testing.....</p><p>Now it comes to performance. Using iperf, I usually get 70 mb/s. I remember I was getting more around 150-170 mb/s some time ago.<br />Also, after letting the client PC sit for a couple of hours, the speed drops to around 30mb/s. I then reconnect the wireless on the PC and I get full speed again immediately.</p><p>Pitou!</p><p>Update: I just changed the channel and played with HT40-/+ and I now get around 120 mb/s, but the speed still drops after some time. I have to reconnect.</p>											<p class="post-edited">(Last edited by <strong>Pitou</strong> on 6 Jul 2010, 13:44)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p112543">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">Noerr</div>
					<div class="post-datetime">
						6 Jul 2010, 10:19					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve updated to&nbsp; r22048&nbsp; 4.jul.2010 firmware<br />and now it is disconnecting even more often</p><p>my log returns bunch of entries like</p><div class="codebox"><pre><code>Jul  6 09:14:52 rutr daemon.info hostapd: wlan0: STA 00:11:22:33:44:55 IEEE 802.11: authenticated
Jul  6 09:14:52 rutr daemon.info hostapd: wlan0: STA 00:11:22:33:44:55 IEEE 802.11: associated (aid 1)
Jul  6 09:14:56 rutr daemon.info hostapd: wlan0: STA 00:11:22:33:44:55 IEEE 802.11: deauthenticated due to local deauth reques</code></pre></div><p>I have to test iperf&nbsp; also to see what is going on, but I&#039;m supprised how 941 works much better than 1043</p><br /><p>Regards</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p112585">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">simpat1zq</div>
					<div class="post-datetime">
						6 Jul 2010, 20:41					</div>
				</div>
				<div class="post-content content">
					<p>I only skimmed over the other posts in this thread, so I&#039;m not sure if this was mentioned. But I had this same problem on my dad&#039;s Dell laptop(e1505, I replaced the stock wifi card with a wireless N one), but my Asus EEEPC worked just fine(Also a wireless N card). I fixed it on my dad&#039;s by not letting the Dell software manage the wireless card and just using Windows(My laptop already used Windows to manage the wifi). After I did that, it has worked perfectly. Can anyone else see if that would work for them?</p><p>And my sister had the same thing happen to her when she visited. She also had the same problem(also wireless N/Dell), but she didn&#039;t want to mess with it.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p112642">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">Noerr</div>
					<div class="post-datetime">
						7 Jul 2010, 13:40					</div>
				</div>
				<div class="post-content content">
					<p>sorry but I don&#039;t use windoze.&nbsp; <br />It&#039;s clear unstable code in ath9k or mac82011 driver</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p117840">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">Bad Joker</div>
					<div class="post-datetime">
						25 Sep 2010, 11:25					</div>
				</div>
				<div class="post-content content">
					<p>I guess this issue is still not completly fixed, in my case I tried latest 10.03.1 RC3 and still have disconnects.</p><p>I start to think that this issue is related to neighborhood N networks. Because I have days were I have no disconnect at all, then another day I got disconnects like hell. I have to do a check if neighborhood networks are related to this.</p><p>Another hint to this:<br /></p><div class="quotebox"><cite>Pitou wrote:</cite><blockquote><p>Update: I just changed the channel and played with HT40-/+ and I now get around 120 mb/s, but the speed still drops after some time. I have to reconnect.</p></blockquote></div><p>The software is very &quot;sensitive&quot; related to neighborhood networks, TP Link factory fw is not.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p156002">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">sniffski</div>
					<div class="post-datetime">
						1 Feb 2012, 18:22					</div>
				</div>
				<div class="post-content content">
					<p>Hello,<br />I have the same issue with wireless N client PCs, and so far I found a way to workaround this by starting trace to the router&#039;s IP address in background of the client PC. Best solution is in screen start &quot;mtr &lt;router IP&gt;&quot; and detach from that screen.</p><p>br</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p156023">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						2 Feb 2012, 00:09					</div>
				</div>
				<div class="post-content content">
					<p>already tried various builds?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>