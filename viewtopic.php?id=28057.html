<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> TL-WR1043ND and K3570-Z 3G modem problem</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 22 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p124938">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">radir</div>
					<div class="post-datetime">
						9 Jan 2011, 13:22					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I have a TP-Link TL-WR1043ND router and Vodafone K3570-Z 3G modem.</p><p>I try to follow the guide here: <a href="http://wiki.openwrt.org/doc/recipes/3gdongle">http://wiki.openwrt.org/doc/recipes/3gdongle</a> . If I am correct the expected result to have at the end a ttyUSB device which can be used as the modem. My problem is that I see no ttyUSB at all. Anyone any suggestion pls?</p><p>Some probably useful data:</p><div class="codebox"><pre><code>Backfire (10.03, r20728)
Linux OpenWrt 2.6.32.10 #20 Tue Apr 6 15:01:26 CEST 2010 mips GNU/Linux

3G dongle not plugged-in
 
 dmesg
 Linux version 2.6.32.10 (openwrt@wrt1.marcant.net) (gcc version 4.3.3 (GCC) ) #20 Tue Apr 6 15:01:26 CEST 2010
prom: fw_arg0=00000007, fw_arg1=a1f77fb0, fw_arg2=a1f78440, fw_arg3=00000008
MyLoader: sysp=ffffffff, boardp=ffffffff, parts=fbfe7fff
bootconsole [early0] enabled
CPU revision is: 00019374 (MIPS 24Kc)
Atheros AR9132 rev 2, CPU:400.000 MHz, AHB:200.000 MHz, DDR:400.000 MHz
Determined physical RAM map:
 memory: 02000000 @ 00000000 (usable)
Initrd not found or empty - disabling initrd
Zone PFN ranges:
  Normal   0x00000000 -&gt; 0x00002000
Movable zone start PFN for each node
early_node_map[1] active PFN ranges
    0: 0x00000000 -&gt; 0x00002000
On node 0 totalpages: 8192
free_area_init_node: node 0, pgdat 802d0210, node_mem_map 81000000
  Normal zone: 64 pages used for memmap
  Normal zone: 0 pages reserved
  Normal zone: 8128 pages, LIFO batch:0
Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 8128
Kernel command line: rootfstype=squashfs,yaffs,jffs2 noinitrd console=ttyS0,115200 board=TL-WR1043ND
PID hash table entries: 128 (order: -3, 512 bytes)
Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
Primary instruction cache 64kB, VIPT, 4-way, linesize 32 bytes.
Primary data cache 32kB, 4-way, VIPT, cache aliases, linesize 32 bytes
Writing ErrCtl register=00000000
Readback ErrCtl register=00000000
Memory: 29332k/32768k available (2101k kernel code, 3436k reserved, 397k data, 152k init, 0k highmem)
SLUB: Genslabs=7, HWalign=32, Order=0-3, MinObjects=0, CPUs=1, Nodes=1
Hierarchical RCU implementation.
NR_IRQS:56
Calibrating delay loop... 266.24 BogoMIPS (lpj=1331200)
Mount-cache hash table entries: 512
NET: Registered protocol family 16
MIPS: machine is TP-LINK TL-WR1043ND
bio: create slab &lt;bio-0&gt; at 0
Switching to clocksource MIPS
NET: Registered protocol family 2
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 1024 (order: 1, 8192 bytes)
TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
TCP: Hash tables configured (established 1024 bind 1024)
TCP reno registered
NET: Registered protocol family 1
squashfs: version 4.0 (2009/01/31) Phillip Lougher
Registering mini_fo version $Id$
JFFS2 version 2.2. (NAND) (SUMMARY)  Â© 2001-2006 Red Hat, Inc.
yaffs Mar 28 2010 17:53:41 Installing.
msgmni has been set to 57
io scheduler noop registered
io scheduler deadline registered (default)
Serial: 8250/16550 driver, 1 ports, IRQ sharing disabled
serial8250.0: ttyS0 at MMIO 0x18020000 (irq = 11) is a 16550A
console [ttyS0] enabled, bootconsole disabled
Atheros AR71xx SPI Controller driver version 0.2.4
m25p80 spi0.0: s25sl064a (8192 Kbytes)
spi0.0: searching for MyLoader partition table at offset 0x10000
spi0.0: searching for MyLoader partition table at offset 0x20000
spi0.0: searching for MyLoader partition table at offset 0x30000
spi0.0: searching for MyLoader partition table at offset 0x40000
spi0.0: no MyLoader partition table found
Searching for RedBoot partition table in spi0.0 at offset 0x7e0000
Searching for RedBoot partition table in spi0.0 at offset 0x7f0000
No RedBoot partition table detected in spi0.0
spi0.0: no WRT160NL signature found
Creating 5 MTD partitions on &quot;spi0.0&quot;:
0x000000000000-0x000000020000 : &quot;u-boot&quot;
0x000000020000-0x000000160000 : &quot;kernel&quot;
0x000000160000-0x0000007f0000 : &quot;rootfs&quot;
mtd: partition &quot;rootfs&quot; set to be root filesystem
mtd: partition &quot;rootfs_data&quot; created automatically, ofs=2A0000, len=550000
0x0000002a0000-0x0000007f0000 : &quot;rootfs_data&quot;
0x0000007f0000-0x000000800000 : &quot;art&quot;
0x000000020000-0x0000007f0000 : &quot;firmware&quot;
Realtek RTL8366RB ethernet switch driver version 0.2.0
rtl8366rb rtl8366rb: using GPIO pins 18 (SDA) and 19 (SCK)
rtl8366rb rtl8366rb: RTL5937 ver. 2 chip found
rtl8366-rtl: probed
eth0: Atheros AG71xx at 0xb9000000, irq 4
eth0: using fixed link parameters
Atheros AR71xx hardware watchdog driver version 0.1.0
ar71xx-wdt: timeout=15 secs (max=21)
TCP westwood registered
NET: Registered protocol family 17
802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;
All bugs added by David S. Miller &lt;davem@redhat.com&gt;
VFS: Mounted root (squashfs filesystem) readonly on device 31:2.
Freeing unused kernel memory: 152k freed
Please be patient, while OpenWrt loads ...
gpio-buttons driver version 0.1.2
input: gpio-buttons as /devices/platform/gpio-buttons/input/input0
Button Hotplug driver version 0.3.1
ar71xx: pll_reg 0xb8050014: 0x1a000000
eth0: link up (1000Mbps/Full duplex)
Registered led device: tl-wr1043nd:green:usb
Registered led device: tl-wr1043nd:green:system
Registered led device: tl-wr1043nd:green:qss
Registered led device: tl-wr1043nd:green:wlan
mini_fo: using base directory: /
mini_fo: using storage directory: /overlay
eth0: link down
ar71xx: pll_reg 0xb8050014: 0x1a000000
eth0: link up (1000Mbps/Full duplex)
device eth0.1 entered promiscuous mode
device eth0 entered promiscuous mode
br-lan: port 1(eth0.1) entering forwarding state
usbcore: registered new interface driver usbfs
usbcore: registered new interface driver hub
usbcore: registered new device driver usb
PPP generic driver version 2.4.2
ip_tables: (C) 2000-2006 Netfilter Core Team
NET: Registered protocol family 24
ehci_hcd: USB 2.0 &#039;Enhanced&#039; Host Controller (EHCI) Driver
ar71xx-ehci ar71xx-ehci: Atheros AR91xx built-in EHCI controller
ar71xx-ehci ar71xx-ehci: new USB bus registered, assigned bus number 1
ar71xx-ehci ar71xx-ehci: irq 3, io mem 0x1b000000
ar71xx-ehci ar71xx-ehci: USB 2.0 started, EHCI 1.00
usb usb1: configuration #1 chosen from 1 choice
hub 1-0:1.0: USB hub found
hub 1-0:1.0: 1 port detected
nf_conntrack version 0.5.0 (460 buckets, 1840 max)
CONFIG_NF_CT_ACCT is deprecated and will be removed soon. Please use
nf_conntrack.acct=1 kernel parameter, acct=1 nf_conntrack module option or
sysctl net.netfilter.nf_conntrack_acct=1 to enable it.
uhci_hcd: USB Universal Host Controller Interface driver
usbcore: registered new interface driver usbserial
USB Serial support registered for generic
usbcore: registered new interface driver usbserial_generic
usbserial: USB Serial Driver core
USB Serial support registered for GSM modem (1-port)
usbcore: registered new interface driver option
option: v0.7.2:USB Driver for GSM modems
ar71xx-wdt: enabling watchdog timer

dev list
root@OpenWrt:~# ls /dev
console             mtd3ro              null
cpu_dma_latency     mtd4                port
full                mtd4ro              ppp
kmsg                mtd5                ptmx
log                 mtd5ro              pts
mem                 mtdblock0           random
mtd0                mtdblock1           shm
mtd0ro              mtdblock2           tty
mtd1                mtdblock3           ttyS0
mtd1ro              mtdblock4           urandom
mtd2                mtdblock5           usb1
mtd2ro              network_latency     watchdog
mtd3                network_throughput  zero


root@OpenWrt:~# cat /proc/bus/usb/devices

T:  Bus=01 Lev=00 Prnt=00 Port=00 Cnt=00 Dev#=  1 Spd=480 MxCh= 1
B:  Alloc=  0/800 us ( 0%), #Int=  0, #Iso=  0
D:  Ver= 2.00 Cls=09(hub  ) Sub=00 Prot=01 MxPS=64 #Cfgs=  1
P:  Vendor=1d6b ProdID=0002 Rev= 2.06
S:  Manufacturer=Linux 2.6.32.10 ehci_hcd
S:  Product=Atheros AR91xx built-in EHCI controller
S:  SerialNumber=ar71xx-ehci
C:* #Ifs= 1 Cfg#= 1 Atr=e0 MxPwr=  0mA
I:* If#= 0 Alt= 0 #EPs= 1 Cls=09(hub  ) Sub=00 Prot=00 Driver=hub
E:  Ad=81(I) Atr=03(Int.) MxPS=   4 Ivl=256ms

For some reason there is no lsusb on system
root@OpenWrt:~# lsusb
-ash: lsusb: not found


***************
after 3G dongle plugged-in (but not switched from CDROM mode)

root@OpenWrt:~# cat /proc/bus/usb/devices

T:  Bus=01 Lev=00 Prnt=00 Port=00 Cnt=00 Dev#=  1 Spd=480 MxCh= 1
B:  Alloc=  0/800 us ( 0%), #Int=  0, #Iso=  0
D:  Ver= 2.00 Cls=09(hub  ) Sub=00 Prot=01 MxPS=64 #Cfgs=  1
P:  Vendor=1d6b ProdID=0002 Rev= 2.06
S:  Manufacturer=Linux 2.6.32.10 ehci_hcd
S:  Product=Atheros AR91xx built-in EHCI controller
S:  SerialNumber=ar71xx-ehci
C:* #Ifs= 1 Cfg#= 1 Atr=e0 MxPwr=  0mA
I:* If#= 0 Alt= 0 #EPs= 1 Cls=09(hub  ) Sub=00 Prot=00 Driver=hub
E:  Ad=81(I) Atr=03(Int.) MxPS=   4 Ivl=256ms

T:  Bus=01 Lev=01 Prnt=01 Port=00 Cnt=01 Dev#=  2 Spd=480 MxCh= 0
D:  Ver= 2.00 Cls=00(&gt;ifc ) Sub=00 Prot=00 MxPS=64 #Cfgs=  1
P:  Vendor=19d2 ProdID=1007 Rev= 0.00
S:  Manufacturer=Vodafone (ZTE)
S:  Product=Vodafone Mobile Broadband K3570-Z
S:  SerialNumber=P680A8VDFD000000
C:* #Ifs= 1 Cfg#= 1 Atr=a0 MxPwr=500mA
I:* If#= 0 Alt= 0 #EPs= 2 Cls=08(stor.) Sub=06 Prot=50 Driver=(none)
E:  Ad=01(O) Atr=02(Bulk) MxPS= 512 Ivl=0ms
E:  Ad=81(I) Atr=02(Bulk) MxPS= 512 Ivl=0ms

root@OpenWrt:~# ls /dev
1-1                 mtd3ro              port
console             mtd4                ppp
cpu_dma_latency     mtd4ro              ptmx
full                mtd5                pts
kmsg                mtd5ro              random
log                 mtdblock0           shm
mem                 mtdblock1           tty
mtd0                mtdblock2           ttyS0
mtd0ro              mtdblock3           urandom
mtd1                mtdblock4           usb1
mtd1ro              mtdblock5           watchdog
mtd2                network_latency     zero
mtd2ro              network_throughput
mtd3                null

dmesg
usb 1-1: new high speed USB device using ar71xx-ehci and address 2
usb 1-1: configuration #1 chosen from 1 choice

-------------------------------
plugged in and switched to modem mode
root@OpenWrt:~# usb_modeswitch -W
Reading config file: /etc/usb-modeswitch.conf

 * usb-modeswitch: handle USB devices with multiple modes
 * Version 1.1.0 (C) Josua Dietze 2010
 * Based on libusb 0.1.12

 ! PLEASE REPORT NEW CONFIGURATIONS !

DefaultVendor=  0x19d2
DefaultProduct= 0x1007
TargetVendor=   0x19d2
TargetProduct=  0x1008
TargetClass=    not set

DetachStorageOnly=0
HuaweiMode=0
SierraMode=0
SonyMode=0
GCTMode=0
MessageEndpoint= not set
MessageContent=&quot;5553424312345678000000000000061b000000020000000000000000000000&quot;
NeedResponse=1
ResponseEndpoint= not set
Interface=0x00

InquireDevice enabled (default)
Success check enabled, max. wait time 20 seconds
System integration mode disabled

usb_set_debug: Setting debugging level to 15 (on)
usb_os_find_busses: Found 001
usb_os_find_busses: Skipping non bus directory devices
usb_os_find_devices: Found 002 on 001
usb_os_find_devices: Found 001 on 001
error obtaining child information: Inappropriate ioctl for device

Looking for target devices ...
  searching devices, found USB ID 19d2:1007
   found matching vendor ID
  searching devices, found USB ID 1d6b:0002
 No devices in target mode or class found
Looking for default devices ...
  searching devices, found USB ID 19d2:1007
   found matching vendor ID
   found matching product ID
  searching devices, found USB ID 1d6b:0002
 Found default devices (1)
Accessing device 002 on bus 001 ...
Using endpoints 0x01 (out) and 0x81 (in)
Inquiring device details; driver will be detached ...
Looking for active driver ...
USB error: could not get bound driver: No data available
 No driver found. Either detached before or never attached

SCSI inquiry data (for identification)
-------------------------
  Vendor String: Vodafone
   Model String:  USB SCSI CD-ROM
Revision String:  USB
-------------------------

USB description data (for identification)
-------------------------
Manufacturer: Vodafone (ZTE)
     Product: Vodafone Mobile Broadband K3570-Z
  Serial No.: P680A8VDFD000000
-------------------------
Setting up communication with interface 0 ...
Trying to send the message to endpoint 0x01 ...
 OK, message successfully sent
Reading the response to the message ...
 OK, response successfully read (13 bytes).

Checking for mode switch (max. 20 times, once per second) ...
 Waiting for original device to vanish ...
 Waiting for original device to vanish ...
USB error: could not claim interface 0: No such device
 Original device can&#039;t be accessed anymore. Good.
 Searching for target devices ...
usb_os_find_devices: Found 001 on 001
  searching devices, found USB ID 1d6b:0002
 Searching for target devices ...
usb_os_find_devices: Found 001 on 001
  searching devices, found USB ID 1d6b:0002
 Searching for target devices ...
usb_os_find_devices: Found 001 on 001
  searching devices, found USB ID 1d6b:0002
 Searching for target devices ...
usb_os_find_devices: Found 001 on 001
  searching devices, found USB ID 1d6b:0002
 Searching for target devices ...
usb_os_find_devices: Found 001 on 001
  searching devices, found USB ID 1d6b:0002
 Searching for target devices ...
usb_os_find_devices: Found 001 on 001
  searching devices, found USB ID 1d6b:0002
 Searching for target devices ...
usb_os_find_devices: Found 003 on 001
usb_os_find_devices: Found 001 on 001
error obtaining child information: Inappropriate ioctl for device
  searching devices, found USB ID 19d2:1008
   found matching vendor ID
   found matching product ID

Found target device 003 on bus 001

Target device description data
-------------------------
Manufacturer: Vodafone (ZTE)
     Product: Vodafone Mobile Broadband K3570-Z
  Serial No.: P680A8VDFD000000
-------------------------
 Found correct target device

Mode switch succeeded. Bye.

usb 1-1: usbfs: process 891 (usb_modeswitch) did not claim interface 0 before use
usb 1-1: USB disconnect, address 2
usb 1-1: new high speed USB device using ar71xx-ehci and address 3
usb 1-1: configuration #1 chosen from 1 choice

root@OpenWrt:~# cat /proc/bus/usb/devices

T:  Bus=01 Lev=00 Prnt=00 Port=00 Cnt=00 Dev#=  1 Spd=480 MxCh= 1
B:  Alloc=  0/800 us ( 0%), #Int=  0, #Iso=  0
D:  Ver= 2.00 Cls=09(hub  ) Sub=00 Prot=01 MxPS=64 #Cfgs=  1
P:  Vendor=1d6b ProdID=0002 Rev= 2.06
S:  Manufacturer=Linux 2.6.32.10 ehci_hcd
S:  Product=Atheros AR91xx built-in EHCI controller
S:  SerialNumber=ar71xx-ehci
C:* #Ifs= 1 Cfg#= 1 Atr=e0 MxPwr=  0mA
I:* If#= 0 Alt= 0 #EPs= 1 Cls=09(hub  ) Sub=00 Prot=00 Driver=hub
E:  Ad=81(I) Atr=03(Int.) MxPS=   4 Ivl=256ms

T:  Bus=01 Lev=01 Prnt=01 Port=00 Cnt=01 Dev#=  3 Spd=480 MxCh= 0
D:  Ver= 2.00 Cls=00(&gt;ifc ) Sub=00 Prot=00 MxPS=64 #Cfgs=  1
P:  Vendor=19d2 ProdID=1008 Rev= 0.00
S:  Manufacturer=Vodafone (ZTE)
S:  Product=Vodafone Mobile Broadband K3570-Z
S:  SerialNumber=P680A8VDFD000000
C:* #Ifs= 5 Cfg#= 1 Atr=a0 MxPwr=500mA
I:* If#= 0 Alt= 0 #EPs= 2 Cls=ff(vend.) Sub=ff Prot=ff Driver=(none)
E:  Ad=81(I) Atr=02(Bulk) MxPS= 512 Ivl=0ms
E:  Ad=01(O) Atr=02(Bulk) MxPS= 512 Ivl=4ms
I:* If#= 1 Alt= 0 #EPs= 2 Cls=ff(vend.) Sub=ff Prot=ff Driver=(none)
E:  Ad=82(I) Atr=02(Bulk) MxPS= 512 Ivl=0ms
E:  Ad=02(O) Atr=02(Bulk) MxPS= 512 Ivl=4ms
I:* If#= 2 Alt= 0 #EPs= 2 Cls=ff(vend.) Sub=ff Prot=ff Driver=(none)
E:  Ad=83(I) Atr=02(Bulk) MxPS= 512 Ivl=0ms
E:  Ad=03(O) Atr=02(Bulk) MxPS= 512 Ivl=4ms
I:* If#= 3 Alt= 0 #EPs= 3 Cls=ff(vend.) Sub=ff Prot=ff Driver=(none)
E:  Ad=84(I) Atr=03(Int.) MxPS=  64 Ivl=2ms
E:  Ad=85(I) Atr=02(Bulk) MxPS= 512 Ivl=0ms
E:  Ad=04(O) Atr=02(Bulk) MxPS= 512 Ivl=4ms
I:* If#= 4 Alt= 0 #EPs= 3 Cls=ff(vend.) Sub=ff Prot=ff Driver=(none)
E:  Ad=86(I) Atr=03(Int.) MxPS=  64 Ivl=2ms
E:  Ad=87(I) Atr=02(Bulk) MxPS= 512 Ivl=0ms
E:  Ad=05(O) Atr=02(Bulk) MxPS= 512 Ivl=4ms



root@OpenWrt:~# ls /dev
1-1                 mtd3ro              port
console             mtd4                ppp
cpu_dma_latency     mtd4ro              ptmx
full                mtd5                pts
kmsg                mtd5ro              random
log                 mtdblock0           shm
mem                 mtdblock1           tty
mtd0                mtdblock2           ttyS0
mtd0ro              mtdblock3           urandom
mtd1                mtdblock4           usb1
mtd1ro              mtdblock5           watchdog
mtd2                network_latency     zero
mtd2ro              network_throughput
mtd3                null</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p124943">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">written_direcon</div>
					<div class="post-datetime">
						9 Jan 2011, 14:03					</div>
				</div>
				<div class="post-content content">
					<p>Also install the <em>usb-modeswitch-<strong>data</strong></em> package.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p124963">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">radir</div>
					<div class="post-datetime">
						9 Jan 2011, 18:55					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for quick response but at <a href="http://downloads.openwrt.org/backfire/10.03/ar71xx/packages/">http://downloads.openwrt.org/backfire/1 … /packages/</a> I cannot find this package. Where can it be found?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125027">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">playdude</div>
					<div class="post-datetime">
						10 Jan 2011, 09:27					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>radir wrote:</cite><blockquote><p>Thanks for quick response but at <a href="http://downloads.openwrt.org/backfire/10.03/ar71xx/packages/">http://downloads.openwrt.org/backfire/1 … /packages/</a> I cannot find this package. Where can it be found?</p></blockquote></div><p>It&#039;s available in backfire 10.03.1-rc4.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125073">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">written_direcon</div>
					<div class="post-datetime">
						10 Jan 2011, 19:02					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>radir wrote:</cite><blockquote><p>Thanks for quick response but at <a href="http://downloads.openwrt.org/backfire/10.03/ar71xx/packages/">http://downloads.openwrt.org/backfire/1 … /packages/</a> I cannot find this package. Where can it be found?</p></blockquote></div><p>You can always build by yourself.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125083">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						10 Jan 2011, 20:36					</div>
				</div>
				<div class="post-content content">
					<p><a href="http://josefsson.org/openwrt/dongle.html">Wireless Router with a 3G/UMTS/HSDPA dongle</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125150">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">radir</div>
					<div class="post-datetime">
						11 Jan 2011, 15:34					</div>
				</div>
				<div class="post-content content">
					<p>Thanks all but still not reached a working internet connection ...</p><p>usb-modeswitch-data package: i did copy it from developer&#039;s site manually before i saw playdude&#039;s comment. but it is good to know it will be part of the new release.<br />I read fyi&#039;s guide too - wish it would be such nice and simple :-)</p><p>i have all the packages installed mentioned in wiki guide and fyi&#039;s blog but the most I can get is an error message saying &#039;timeout for writing PIN.wan(3g)&#039;. Which means by now dongle is recognized as a modem, there is a tty device linked to it, ifup tries to kick in the proper hw but something is still missing.</p><p>Also I am a bit confused how and if to use usb_modeswitch at all as sometime I receive an other error message from ifup saying &#039;cannot write to /dev/ttyUSB&#039;. So, does the usb-modeswitch-data install an usb hotplug/init script to <em>automatically</em> switch dongle to modem mode, or still have to do it manually (e.g. in rc.local)?<br />My understanding that comgt package&nbsp; installs some chat/ppp scripts so would assume if in /etc/config/network I add the proper 3G network options I would only really need to run ifup, or need further manual tweaking?</p><p>Thanks.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125718">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">radir</div>
					<div class="post-datetime">
						17 Jan 2011, 16:40					</div>
				</div>
				<div class="post-content content">
					<p>FYI - Backfire (10.03.1-rc4, r24045) almost solved my problem. Apply this firmware then add the required packages and seems everything to work. If anyone else uses this dongle bear in mind that it has 4 serial ports and only one is the actual modem. In my case it is ttyUSB3 (the others are for diagnostics, SMS, whatever ...)</p><p>Though rc4 is dropping connection sporadically and only a reboot helps to get modem connect back to carrier ... is this a known problem with resolution or nature of rc release? May try to go back to 10.03 and start over everything.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125727">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">Orca</div>
					<div class="post-datetime">
						17 Jan 2011, 18:38					</div>
				</div>
				<div class="post-content content">
					<p>1. I do not own a UMTS modem myself, so I cannot test anything.</p><p>2. I didn&#039;t write that howto, I merely&nbsp; copied it from within a device-article, so it would be found more easily.</p><p>3. I am glad you found it when you looked for help with your problem, and I am sad it does not provide the intended help!</p><p>4. Now that your problem is solved, why don&#039;t you go back and mend/patch/repair/correct that article, so that the next guys can benefit from our combined knowledge?</p><p>That&#039;s the basic idea behind a wiki and the advantage over a forum.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125757">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">snowyowlster</div>
					<div class="post-datetime">
						17 Jan 2011, 23:42					</div>
				</div>
				<div class="post-content content">
					<p>Take a look at this.<br /><a href="https://lists.openwrt.org/pipermail/openwrt-devel/2010-August/007833.html">https://lists.openwrt.org/pipermail/ope … 07833.html</a></p><br /><br /><div class="quotebox"><cite>radir wrote:</cite><blockquote><p>FYI - Backfire (10.03.1-rc4, r24045) almost solved my problem. Apply this firmware then add the required packages and seems everything to work. If anyone else uses this dongle bear in mind that it has 4 serial ports and only one is the actual modem. In my case it is ttyUSB3 (the others are for diagnostics, SMS, whatever ...)</p><p>Though rc4 is dropping connection sporadically and only a reboot helps to get modem connect back to carrier ... is this a known problem with resolution or nature of rc release? May try to go back to 10.03 and start over everything.</p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125982">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">radir</div>
					<div class="post-datetime">
						19 Jan 2011, 22:56					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Orca wrote:</cite><blockquote><p>4. Now that your problem is solved</p></blockquote></div><p>no really yet ... still has the mysterious disconnect problem.</p><div class="quotebox"><cite>snowyowlster wrote:</cite><blockquote><p>Take a look at this.<br /><a href="https://lists.openwrt.org/pipermail/openwrt-devel/2010-August/007833.html">https://lists.openwrt.org/pipermail/ope … 07833.html</a></p></blockquote></div><p>Well, it is not 100% identical to my case, let me show logread output:</p><p>there is a problem with link, should not be but for some reason no response to keepalive<br /></p><div class="codebox"><pre><code>#1
Nov 19 20:39:09 OpenWrt daemon.info pppd[1177]: No response to 3 echo-requests
Nov 19 20:39:09 OpenWrt daemon.notice pppd[1177]: Serial link appears to be disconnected.
Nov 19 20:39:09 OpenWrt daemon.info pppd[1177]: Connect time 10.7 minutes.
Nov 19 20:39:09 OpenWrt daemon.info pppd[1177]: Sent 594607 bytes, received 1889984 bytes.
Nov 19 20:39:15 OpenWrt daemon.notice pppd[1177]: Connection terminated.</code></pre></div><p>as nothing happens, no automatic reconnection attempt try to re-establish connection manually<br /></p><div class="codebox"><pre><code>#2
root@OpenWrt:~# date
Fri Nov 19 20:42:42 CET 2010
root@OpenWrt:~# ifup wan
root@OpenWrt:~# logread
Nov 19 20:42:58 OpenWrt daemon.err pppd[1177]: ioctl(TIOCSETD, N_TTY): Interrupted system call (line 575)
Nov 19 20:43:13 OpenWrt daemon.info dnsmasq[1100]: reading /tmp/resolv.conf.auto
Nov 19 20:43:13 OpenWrt daemon.info dnsmasq[1100]: using nameserver 1.1.1.1#53
Nov 19 20:43:13 OpenWrt daemon.info dnsmasq[1100]: using nameserver 80.244.98.166#53
Nov 19 20:43:13 OpenWrt daemon.info dnsmasq[1100]: using nameserver 80.244.96.1#53
Nov 19 20:43:13 OpenWrt daemon.info dnsmasq[1100]: using local addresses only for domain lan
Nov 19 20:43:13 OpenWrt daemon.notice pppd[1676]: pppd 2.4.4 started by root, uid 0
Nov 19 20:43:13 OpenWrt daemon.info pppd[1676]: Using interface 3g-wan
Nov 19 20:43:13 OpenWrt daemon.notice pppd[1676]: local  IP address 10.64.64.64
Nov 19 20:43:13 OpenWrt daemon.notice pppd[1676]: remote IP address 10.112.112.112
Nov 19 20:43:17 OpenWrt daemon.info pppd[1676]: Starting link
Nov 19 20:43:17 OpenWrt daemon.notice pppd[1676]: Removed stale lock on ttyUSB3 (pid 1177)</code></pre></div><p>after a little while<br /></p><div class="codebox"><pre><code>#3
Nov 19 20:43:48 OpenWrt local2.info chat[1688]: abort on (BUSY)
Nov 19 20:43:48 OpenWrt local2.info chat[1688]: abort on (NO CARRIER)
Nov 19 20:43:48 OpenWrt local2.info chat[1688]: abort on (ERROR)
Nov 19 20:43:48 OpenWrt local2.info chat[1688]: report (CONNECT)
Nov 19 20:43:48 OpenWrt local2.info chat[1688]: timeout set to 10 seconds
Nov 19 20:43:48 OpenWrt local2.info chat[1688]: send (AT&amp;F^M)
Nov 19 20:43:58 OpenWrt local2.info chat[1688]: alarm
Nov 19 20:43:58 OpenWrt local2.info chat[1688]:  -- write timed out
Nov 19 20:43:58 OpenWrt local2.err chat[1688]: Failed
Nov 19 20:44:03 OpenWrt daemon.err pppd[1676]: Connect script failed</code></pre></div><p>seems modem is locked/not writable! </p><p>What I don&#039;t get is if pppd terminates connection gracefully (#1) what kind of lock remains on USB port/device which is reported to be removed (#2) though it is really not (#3)</p><p>And if reach this state only reboot helps :-(</p><p>my config is btw <br />config &#039;interface&#039; &#039;wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ifname&#039; &#039;ppp0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;service&#039; &#039;umts&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;apn&#039; &#039;internet.vodafone.net&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;device&#039; &#039;/dev/ttyUSB3&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;proto&#039; &#039;3g&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;demand&#039; &#039;300&#039;<br />I was wondering if problem may caused by weak power supplied for USB port due to bigger load on for example wifi or CPU intensive process?</p>											<p class="post-edited">(Last edited by <strong>radir</strong> on 19 Jan 2011, 23:17)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p126786">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">radir</div>
					<div class="post-datetime">
						29 Jan 2011, 14:38					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>radir wrote:</cite><blockquote><p>I was wondering if problem may caused by weak power supplied for USB port due to bigger load on for example wifi or CPU intensive process?</p></blockquote></div><p>Using an external USB hub with power supply <em>seems</em> to help: connection gets more stable. But maybe it is just my wishful thinking* at least it does hurt that&#039;s for sure :-)</p><p>*unfortunately i see trace dumps in log file (as no WAN no time server for synchronizing to so ignore the timestamps):<br /></p><div class="codebox"><pre><code>Nov 20 13:58:11 OpenWrt user.warn kernel: ------------[ cut here ]------------
Nov 20 13:58:11 OpenWrt user.warn kernel: WARNING: at drivers/usb/serial/usb-serial.c:394 0x808e89e0()
Nov 20 13:58:11 OpenWrt user.warn kernel: Modules linked in: option usbserial uhci_hcd ath_pci ath_hal(P) nf_nat_tftp nf_conntrack_tftp nf_nat_irc nf_conntrack_irc nf_nat_ftp nf_conntrack_ftp ipt_MASQUERADE iptable_nat nf_nat xt_NOTRACK iptable_raw xt_state nf_conntrac
Nov 20 13:58:11 OpenWrt user.warn kernel: Call Trace:[&lt;800683a4&gt;] 0x800683a4
Nov 20 13:58:11 OpenWrt user.warn kernel: [&lt;800683a4&gt;] 0x800683a4
Nov 20 13:58:11 OpenWrt user.warn kernel: [&lt;8007cfa4&gt;] 0x8007cfa4
Nov 20 13:58:11 OpenWrt user.warn kernel: [&lt;808e89e0&gt;] 0x808e89e0
Nov 20 13:58:11 OpenWrt user.warn kernel: [&lt;808e89e0&gt;] 0x808e89e0
Nov 20 13:58:11 OpenWrt user.warn kernel: [&lt;801e3874&gt;] 0x801e3874
Nov 20 13:58:11 OpenWrt user.warn kernel: [&lt;81b92ce4&gt;] 0x81b92ce4
Nov 20 13:58:11 OpenWrt user.warn kernel: [&lt;81b93604&gt;] 0x81b93604
Nov 20 13:58:11 OpenWrt user.warn kernel: [&lt;80c1e170&gt;] 0x80c1e170
Nov 20 13:58:11 OpenWrt user.warn kernel: [&lt;80082210&gt;] 0x80082210
Nov 20 13:58:11 OpenWrt user.warn kernel: [&lt;80082a08&gt;] 0x80082a08
Nov 20 13:58:11 OpenWrt user.warn kernel: [&lt;80078a50&gt;] 0x80078a50
Nov 20 13:58:11 OpenWrt user.warn kernel: [&lt;80082ae8&gt;] 0x80082ae8
Nov 20 13:58:11 OpenWrt user.warn kernel: [&lt;800789fc&gt;] 0x800789fc
Nov 20 13:58:11 OpenWrt user.warn kernel: [&lt;800772e0&gt;] 0x800772e0
Nov 20 13:58:11 OpenWrt user.warn kernel: [&lt;80082d70&gt;] 0x80082d70
Nov 20 13:58:11 OpenWrt user.warn kernel: [&lt;80068c64&gt;] 0x80068c64
Nov 20 13:58:11 OpenWrt user.warn kernel: [&lt;80c87ec4&gt;] 0x80c87ec4
Nov 20 13:58:11 OpenWrt user.warn kernel: [&lt;8008e82c&gt;] 0x8008e82c
Nov 20 13:58:11 OpenWrt user.warn kernel: [&lt;80270000&gt;] 0x80270000
Nov 20 13:58:11 OpenWrt user.warn kernel: [&lt;80068c64&gt;] 0x80068c64
Nov 20 13:58:11 OpenWrt user.warn kernel: [&lt;800926b8&gt;] 0x800926b8
Nov 20 13:58:11 OpenWrt user.warn kernel: [&lt;8008e704&gt;] 0x8008e704
Nov 20 13:58:11 OpenWrt user.warn kernel: [&lt;8009220c&gt;] 0x8009220c
Nov 20 13:58:11 OpenWrt user.warn kernel: [&lt;8006c8cc&gt;] 0x8006c8cc
Nov 20 13:58:11 OpenWrt user.warn kernel: [&lt;80270000&gt;] 0x80270000
Nov 20 13:58:11 OpenWrt user.warn kernel: [&lt;80092190&gt;] 0x80092190
Nov 20 13:58:11 OpenWrt user.warn kernel: [&lt;8006c8bc&gt;] 0x8006c8bc
Nov 20 13:58:11 OpenWrt user.warn kernel: ---[ end trace fae905166ac29734 ]---</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p126788">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">radir</div>
					<div class="post-datetime">
						29 Jan 2011, 14:45					</div>
				</div>
				<div class="post-content content">
					<p>i found a bug report <a href="https://dev.openwrt.org/ticket/8734">https://dev.openwrt.org/ticket/8734</a> similar to this case with different router but same symptoms. Workaround is indeed to use USB hub with power supply as per comments.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>