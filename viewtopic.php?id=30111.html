<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> How to go from OpenWRT to DD-WRT (or stock) on WZR-HP-G300NH?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 31 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p135656">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">UberB</div>
					<div class="post-datetime">
						20 May 2011, 11:54					</div>
				</div>
				<div class="post-content content">
					<p>Hi guys,</p><p>I went from stock to dd-wrt to openwrt, but lately my wifi has been crashing a lot. So I&#039;d like to go back to DD-WRT but I&#039;m really afraid of bricking my router.</p><p>Can I just use the mtd linux command on the wiki? Because the DD-WRT image file isn&#039;t a .trx but a .bin. Do I have to strip the header and then rename to .trx? Do I need to use tftp?</p><p>Not sure what to do here and I have read documentation but it is a bit lacking in detail. I&#039;ve never used TFTP before so if that&#039;s necessary, I&#039;d greatly appreciate some clear detailed instructions on how to do so.</p><p>Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p135661">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Orca</div>
					<div class="post-datetime">
						20 May 2011, 12:11					</div>
				</div>
				<div class="post-content content">
					<p>For TFTP try&nbsp; <a href="http://wiki.openwrt.org/doc/techref/bootloader">http://wiki.openwrt.org/doc/techref/bootloader</a> and <a href="http://wiki.openwrt.org/toh/d-link/dir-300">http://wiki.openwrt.org/toh/d-link/dir-300</a><br />For bin vs trx: I don&#039;t know, especially what DD-WRT needs/wants. The difference is explained here: <a href="http://wiki.openwrt.org/doc/techref/header">http://wiki.openwrt.org/doc/techref/header</a></p><p>No idea when this is relevant.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p135682">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						20 May 2011, 17:18					</div>
				</div>
				<div class="post-content content">
					<p>I think you should give <a href="http://downloads.openwrt.org/snapshots/backfire/10.03.1-RC5-testing/">rc5</a> a shot.</p><p><a href="http://www.dd-wrt.com/phpBB2/viewtopic.php?t=87579">DD-WRT Forum :: View topic - Buffalo WZR-HP-G300NH brick after flashing WHR firmware</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p135685">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						20 May 2011, 17:41					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>UberB wrote:</cite><blockquote><p>I went from stock to dd-wrt to openwrt, ...</p></blockquote></div><p>I am just curious and would appreciate if you can provide information on how did you flash your router from DD-WRT to OpenWRT. Currently, I have an old Linksys WRT54GS v3.1 flashed with DD-WRT Mega firmware and am would like to flash it with a self-built OpenWRT firmware. Since you had done that, it will be easier just to ask how you did it. Thanks.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p135691">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						20 May 2011, 20:23					</div>
				</div>
				<div class="post-content content">
					<p><a href="http://wiki.openwrt.org/toh/linksys/wrt54g#using.the.mtd.command.line.tool">Linksys WRT54G/L/S - OpenWrt Wiki</a>. Either tftp method or mtd utility can do the job.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p135714">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">UberB</div>
					<div class="post-datetime">
						21 May 2011, 04:13					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>mazilo wrote:</cite><blockquote><div class="quotebox"><cite>UberB wrote:</cite><blockquote><p>I went from stock to dd-wrt to openwrt, ...</p></blockquote></div><p>I am just curious and would appreciate if you can provide information on how did you flash your router from DD-WRT to OpenWRT. Currently, I have an old Linksys WRT54GS v3.1 flashed with DD-WRT Mega firmware and am would like to flash it with a self-built OpenWRT firmware. Since you had done that, it will be easier just to ask how you did it. Thanks.</p></blockquote></div><p>Check the instructions under the WZR-HP-G300NH wiki; I followed them to the letter. Basically you just use SSH and mtd linux.</p><br /><div class="quotebox"><cite>fyi wrote:</cite><blockquote><p>I think you should give <a href="http://downloads.openwrt.org/snapshots/backfire/10.03.1-RC5-testing/">rc5</a> a shot.</p><p><a href="http://www.dd-wrt.com/phpBB2/viewtopic.php?t=87579">DD-WRT Forum :: View topic - Buffalo WZR-HP-G300NH brick after flashing WHR firmware</a></p></blockquote></div><p>OK i can give it a try but how would I flash it? I can just use the GUI for this one right? I assume I use the sysupgrade file.</p><p>Unfortunately I forgot whether I flashed the squashfs or jffs2 image last time. Is there any way for me to find out which version I have?</p>											<p class="post-edited">(Last edited by <strong>UberB</strong> on 21 May 2011, 04:18)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p135715">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						21 May 2011, 04:36					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>UberB wrote:</cite><blockquote><div class="quotebox"><cite>mazilo wrote:</cite><blockquote><div class="quotebox"><cite>UberB wrote:</cite><blockquote><p>I went from stock to dd-wrt to openwrt, ...</p></blockquote></div><p>I am just curious and would appreciate if you can provide information on how did you flash your router from DD-WRT to OpenWRT. Currently, I have an old Linksys WRT54GS v3.1 flashed with DD-WRT Mega firmware and am would like to flash it with a self-built OpenWRT firmware. Since you had done that, it will be easier just to ask how you did it. Thanks.</p></blockquote></div><p>Check the instructions under the WZR-HP-G300NH wiki; I followed them to the letter. Basically you just use SSH and mtd linux.</p></blockquote></div><p>Thanks.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p135719">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">UberB</div>
					<div class="post-datetime">
						21 May 2011, 08:58					</div>
				</div>
				<div class="post-content content">
					<p>Update: I think I have found a way to go from OpenWRT to DD-WRT by googling around: </p><p>1. Simply download the proper DD-WRT file, i.e. wzr-hp-g300nh-dd-wrt-webupgrade-MULTI.bin<br />2. Using a hex editor, strip the first 28 bytes so that the file begins with 27 05 19 56<br />3. Flash using web GUI</p><p>Can anyone confirm if this would work? For the record, I downloaded the latest openwrt rc5 bin file and compared the headers; both begin with 27 05 19 56.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p135721">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						21 May 2011, 10:52					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>UberB wrote:</cite><blockquote><p>OK i can give it a try but how would I flash it? I can just use the GUI for this one right? I assume I use the sysupgrade file.</p><p>Unfortunately I forgot whether I flashed the squashfs or jffs2 image last time. Is there any way for me to find out which version I have?</p></blockquote></div><p>It doesn&#039;t matter which image you had installed but I suggest that you&#039;d better install the squashfs rootfs. In that case you can always restore default settings by erasing rootfs_data if you mess it up.<br /></p><div class="codebox"><pre><code>sysupgrade -n openwrt-xxxxxxxx-sysupgrade.bin
mtd -r write openwrt-xxxxxxxx-sysupgrade.bin firmware</code></pre></div><p>If you&#039;d like to revert to DD-WRT, just strip 28 bytes DD-WRT header off from wzr-hp-g300nh-dd-wrt-webupgrade-MULTI.bin and override the &quot;firmware&quot; partition.<br /></p><div class="codebox"><pre><code>dd bs=28 skip=1 if=/tmp/wzr-hp-g300nh-dd-wrt-webupgrade-MULTI.bin of=/tmp/firmware.bin
mtd -r write /tmp/firmware.bin firmware</code></pre></div><p><a href="https://forum.openwrt.org/viewtopic.php?pid=116706">OpenWrt / [HELP needed] WZR-HP-G300NH back to original firmware</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p135723">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">UberB</div>
					<div class="post-datetime">
						21 May 2011, 11:52					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>fyi wrote:</cite><blockquote><div class="quotebox"><cite>UberB wrote:</cite><blockquote><p>OK i can give it a try but how would I flash it? I can just use the GUI for this one right? I assume I use the sysupgrade file.</p><p>Unfortunately I forgot whether I flashed the squashfs or jffs2 image last time. Is there any way for me to find out which version I have?</p></blockquote></div><p>If you&#039;d like to revert to DD-WRT, just strip 28 bytes DD-WRT header off from wzr-hp-g300nh-dd-wrt-webupgrade-MULTI.bin and override the &quot;firmware&quot; partition.<br /></p><div class="codebox"><pre><code>dd bs=28 skip=1 if=/tmp/wzr-hp-g300nh-dd-wrt-webupgrade-MULTI.bin of=/tmp/firmware.bin
mtd -r write /tmp/firmware.bin firmware</code></pre></div><p><a href="https://forum.openwrt.org/viewtopic.php?pid=116706">OpenWrt / [HELP needed] WZR-HP-G300NH back to original firmware</a></p></blockquote></div><p>I&#039;ve already done this if you see my post above. Now, is it better for me to use the LuCI GUI or SSH client to flash the firmware?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p135724">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						21 May 2011, 13:04					</div>
				</div>
				<div class="post-content content">
					<p>It depends on where you edit the DD-WRT binary. LuCI GUI calls sysupgrade internally and I think sysupgrade will check the firmware integrity.<br /></p><div class="codebox"><pre><code>dd bs=28 skip=1 if=/tmp/wzr-hp-g300nh-dd-wrt-webupgrade-MULTI.bin of=/tmp/firmware.bin
sysupgrade -n /tmp/firmware.bin</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p135729">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">Orca</div>
					<div class="post-datetime">
						21 May 2011, 15:14					</div>
				</div>
				<div class="post-content content">
					<p>I do not think sysupgrade was meant to write other OS. sysupgrade is shell script, read it to understand what it does and does not.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p135744">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						21 May 2011, 19:04					</div>
				</div>
				<div class="post-content content">
					<p>Read the &quot;<a href="http://wiki.openwrt.org/toh/buffalo/wzr-hp-g300h#migrate.from.dd-wrt.to.openwrt">Buffalo WZR-HP-G300NH - OpenWrt Wiki</a>&quot; for yourself.<br /></p><div class="quotebox"><blockquote><p>mtd -r write openwrt-ar71xx-wzr-hp-g300nh-squashfs-sysupgrade.bin linux</p></blockquote></div><p>Why do you think you can directly write OpenWrt sysupgrade binary over DD-WRT linux partition?</p><p><a href="https://forum.openwrt.org/viewtopic.php?id=24783">OpenWrt / MZK-W04NU with 10.03</a></p>											<p class="post-edited">(Last edited by <strong>fyi</strong> on 21 May 2011, 19:47)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p135763">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">UberB</div>
					<div class="post-datetime">
						22 May 2011, 03:17					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>fyi wrote:</cite><blockquote><p>It depends on where you edit the DD-WRT binary. LuCI GUI calls sysupgrade internally and I think sysupgrade will check the firmware integrity.<br /></p><div class="codebox"><pre><code>dd bs=28 skip=1 if=/tmp/wzr-hp-g300nh-dd-wrt-webupgrade-MULTI.bin of=/tmp/firmware.bin
sysupgrade -n /tmp/firmware.bin</code></pre></div></blockquote></div><p>Sorry I don&#039;t really understand what you mean by this post. I am certain that I hex edited properly because the dd-wrt bin file now begins with the exact same header as the openwrt image. So now, it should be safe for me to flash via GUI yes?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p135776">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						22 May 2011, 11:59					</div>
				</div>
				<div class="post-content content">
					<p>Yes. In case it doesn&#039;t work (I doubt it), the mtd method should work. Something I learn from sysupgrade for Atheros platform is that it switches to ramfs before the upgrade so I think it&#039;s safer to upgrade with LuCI GUI or sysupgrade than running the mtd utility directly.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>