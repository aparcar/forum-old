<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Netgear WNR854T with Atheros Wireless Card</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 24 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p96561">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">roubaozi</div>
					<div class="post-datetime">
						29 Oct 2009, 04:46					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I am very new to OpenWrt and this is the first time I am trying to put OpenWrt on my WNR854T router, I have replaced the mini-pci card with an Atheros wireless card which should be supported by OpenWrt, but I am not able to enable wireless for some reason.</p><p>The image I am using is:<br /><a href="http://downloads.x-wrt.org/xwrt/kamikaze/snapshots/orion/openvpn/openwrt-wnr854t-squashfs-webupgrade.img">openwrt-wnr854t-squashfs-webupgrade.img</a>&nbsp; (Oct 28, 2009)</p><p>I can see this message from serial when the router boots up:<br /></p><div class="codebox"><pre><code>Registered led device: ath9k-phy0::radio
Registered led device: ath9k-phy0::assoc
Registered led device: ath9k-phy0::tx
Registered led device: ath9k-phy0::rx
phy0: Atheros AR5416 MAC/BB Rev:2 AR5133 RF Rev:81: mem=0xc2a00000, irq=36</code></pre></div><p>Here is my /etc/config/wireless file:<br /></p><div class="codebox"><pre><code>config &#039;wifi-device&#039; &#039;wifi0&#039;
        option &#039;type&#039; &#039;atheros&#039;
        option &#039;macaddr&#039; &#039;00:07:c1:31:05:30&#039;
        option &#039;country&#039; &#039;&#039;
        option &#039;hwmode&#039; &#039;&#039;
        option &#039;channel&#039; &#039;0&#039;
        option &#039;maxassoc&#039; &#039;&#039;
        option &#039;distance&#039; &#039;20&#039;
        option &#039;diversity&#039; &#039;&#039;
        option &#039;txantenna&#039; &#039;&#039;
        option &#039;rxantenna&#039; &#039;&#039;
        option &#039;disabled&#039; &#039;0&#039;
        option &#039;antenna&#039; &#039;&#039;

config &#039;wifi-iface&#039;
        option &#039;device&#039; &#039;wifi0&#039;
        option &#039;network&#039; &#039;lan&#039;
        option &#039;mode&#039; &#039;ap&#039;
        option &#039;ssid&#039; &#039;MYSSID&#039;
        option &#039;bssid&#039; &#039;&#039;
        option &#039;encryption&#039; &#039;psk2&#039;
        option &#039;server&#039; &#039;&#039;
        option &#039;port&#039; &#039;&#039;
        option &#039;hidden&#039; &#039;0&#039;
        option &#039;isolate&#039; &#039;0&#039;
        option &#039;txpower&#039; &#039;&#039;
        option &#039;bgscan&#039; &#039;0&#039;
        option &#039;frag&#039; &#039;&#039;
        option &#039;rts&#039; &#039;&#039;
        option &#039;wds&#039; &#039;0&#039;
        option &#039;key&#039; &#039;MYKEY&#039;
        option &#039;key1&#039; &#039;&#039;
        option &#039;key2&#039; &#039;&#039;
        option &#039;key3&#039; &#039;&#039;
        option &#039;key4&#039; &#039;&#039;
        option &#039;80211h&#039; &#039;&#039;
        option &#039;compression&#039; &#039;&#039;
        option &#039;bursting&#039; &#039;&#039;
        option &#039;ff&#039; &#039;&#039;</code></pre></div><p>But when I tried to turn wireless on:<br /></p><div class="codebox"><pre><code>wifi up</code></pre></div><p>I got:<br /></p><div class="codebox"><pre><code>wifi0(atheros): Interface type not supported
wifi0(atheros): Interface type not supported</code></pre></div><p>So, what else do I need to do to enable wireless on my router.</p><p>Thanks in advance.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p96563">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">roubaozi</div>
					<div class="post-datetime">
						29 Oct 2009, 06:01					</div>
				</div>
				<div class="post-content content">
					<p>I guess that was because the /lib/wifi/atheros.sh is missing, where can I find the script then? Thanks.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p96577">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Nilfred</div>
					<div class="post-datetime">
						29 Oct 2009, 14:28					</div>
				</div>
				<div class="post-content content">
					<p>Please read <a href="https://forum.openwrt.org/viewtopic.php?id=12358">here</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p96641">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">roubaozi</div>
					<div class="post-datetime">
						30 Oct 2009, 04:58					</div>
				</div>
				<div class="post-content content">
					<p>Changed wifi type to &quot;mac80211&quot; and changed &quot;hwmode&quot; to &quot;11ng&quot;, wifi is now working (even the wireless LED is off), next step will be enable HT-40 mode.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p96678">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">roubaozi</div>
					<div class="post-datetime">
						31 Oct 2009, 05:21					</div>
				</div>
				<div class="post-content content">
					<p>looks like 5ghz N is not supported by the current hostapd?</p><p>driver shows the wireless card support dual bands:<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# iw list
Wiphy phy0
        Band 1:
                HT capabilities: 0x104e
                        * 20/40 MHz operation
                        * SM PS disabled
                        * 40 MHz short GI
                        * max A-MSDU len 3839
                        * DSSS/CCK 40 MHz
                HT A-MPDU factor: 0x0003 (65535 bytes)
                HT A-MPDU density: 0x0006 (8 usec)
                HT MCS set: ff ff 00 00 00 00 00 00 00 00 00 00 01 00 00 00
                HT TX/RX MCS rate indexes supported:
                        MCS index 0
                        MCS index 1
                        MCS index 2
                        MCS index 3
                        MCS index 4
                        MCS index 5
                        MCS index 6
                        MCS index 7
                        MCS index 8
                        MCS index 9
                        MCS index 10
                        MCS index 11
                        MCS index 12
                        MCS index 13
                        MCS index 14
                        MCS index 15
                Frequencies:
                        * 2412 MHz [1] (20.0 dBm)
                        * 2417 MHz [2] (20.0 dBm)
                        * 2422 MHz [3] (20.0 dBm)
                        * 2427 MHz [4] (20.0 dBm)
                        * 2432 MHz [5] (20.0 dBm)
                        * 2437 MHz [6] (20.0 dBm)
                        * 2442 MHz [7] (20.0 dBm)
                        * 2447 MHz [8] (20.0 dBm)
                        * 2452 MHz [9] (20.0 dBm)
                        * 2457 MHz [10] (20.0 dBm)
                        * 2462 MHz [11] (20.0 dBm)
                        * 2467 MHz [12] (disabled)
                        * 2472 MHz [13] (disabled)
                        * 2484 MHz [14] (disabled)
                Bitrates (non-HT):
                        * 1.0 Mbps
                        * 2.0 Mbps (short preamble supported)
                        * 5.5 Mbps (short preamble supported)
                        * 11.0 Mbps (short preamble supported)
                        * 6.0 Mbps
                        * 9.0 Mbps
                        * 12.0 Mbps
                        * 18.0 Mbps
                        * 24.0 Mbps
                        * 36.0 Mbps
                        * 48.0 Mbps
                        * 54.0 Mbps
        Band 2:
                HT capabilities: 0x104e
                        * 20/40 MHz operation
                        * SM PS disabled
                        * 40 MHz short GI
                        * max A-MSDU len 3839
                        * DSSS/CCK 40 MHz
                HT A-MPDU factor: 0x0003 (65535 bytes)
                HT A-MPDU density: 0x0006 (8 usec)
                HT MCS set: ff ff 00 00 00 00 00 00 00 00 00 00 01 00 00 00
                HT TX/RX MCS rate indexes supported:
                        MCS index 0
                        MCS index 1
                        MCS index 2
                        MCS index 3
                        MCS index 4
                        MCS index 5
                        MCS index 6
                        MCS index 7
                        MCS index 8
                        MCS index 9
                        MCS index 10
                        MCS index 11
                        MCS index 12
                        MCS index 13
                        MCS index 14
                        MCS index 15
                Frequencies:
                        * 5180 MHz [36] (30.0 dBm) (passive scanning, no IBSS)
                        * 5200 MHz [40] (30.0 dBm) (passive scanning, no IBSS)
                        * 5220 MHz [44] (30.0 dBm) (passive scanning, no IBSS)
                        * 5240 MHz [48] (30.0 dBm) (passive scanning, no IBSS)
                        * 5260 MHz [52] (30.0 dBm) (passive scanning, no IBSS, radar detection)
                        * 5280 MHz [56] (30.0 dBm) (passive scanning, no IBSS, radar detection)
                        * 5300 MHz [60] (30.0 dBm) (passive scanning, no IBSS, radar detection)
                        * 5320 MHz [64] (30.0 dBm) (passive scanning, no IBSS, radar detection)
                        * 5500 MHz [100] (disabled)
                        * 5520 MHz [104] (disabled)
                        * 5540 MHz [108] (disabled)
                        * 5560 MHz [112] (disabled)
                        * 5580 MHz [116] (disabled)
                        * 5600 MHz [120] (disabled)
                        * 5620 MHz [124] (disabled)
                        * 5640 MHz [128] (disabled)
                        * 5660 MHz [132] (disabled)
                        * 5680 MHz [136] (disabled)
                        * 5700 MHz [140] (disabled)
                        * 5745 MHz [149] (30.0 dBm) (passive scanning, no IBSS)
                        * 5765 MHz [153] (30.0 dBm) (passive scanning, no IBSS)
                        * 5785 MHz [157] (30.0 dBm) (passive scanning, no IBSS)
                        * 5805 MHz [161] (30.0 dBm) (passive scanning, no IBSS)
                        * 5825 MHz [165] (30.0 dBm) (passive scanning, no IBSS)
                Bitrates (non-HT):
                        * 6.0 Mbps
                        * 9.0 Mbps
                        * 12.0 Mbps
                        * 18.0 Mbps
                        * 24.0 Mbps
                        * 36.0 Mbps
                        * 48.0 Mbps
                        * 54.0 Mbps
        max # scan SSIDs: 4
        Supported interface modes:
                 * IBSS
                 * managed
                 * AP
                 * AP/VLAN
                 * monitor
                 * mesh point</code></pre></div><p>But when I tried to enable 5ghz N:<br />/etc/config/wireless<br /></p><div class="codebox"><pre><code>config &#039;wifi-device&#039; &#039;wifi0&#039;
        option &#039;type&#039; &#039;mac80211&#039;
        option &#039;macaddr&#039; &#039;00:07:c1:31:05:30&#039;
        option &#039;channel&#039; &#039;44&#039;
        option &#039;distance&#039; &#039;20&#039;
        option &#039;disabled&#039; &#039;0&#039;
        option &#039;antenna&#039; &#039;&#039;
        option &#039;country&#039; &#039;ca&#039;
        option &#039;hwmode_11n&#039; &#039;n&#039;
        option &#039;ht_capab&#039; &#039;[HT40-][SHORT-GI-40][DSSS_CCK-40]&#039;
        option &#039;diversity&#039; &#039;1&#039;</code></pre></div><p>It complains:<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# wifi up
Configuration file: /var/run/hostapd-wlan0.conf
Line 4: unknown hw_mode &#039;n&#039;
1 errors found in configuration file &#039;/var/run/hostapd-wlan0.conf&#039;
enable_mac80211(wifi0): Failed to set up wpa for interface wlan0</code></pre></div><p>So, how do I enable N-only? and how do I enable 5ghz N-only?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p96728">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">roubaozi</div>
					<div class="post-datetime">
						1 Nov 2009, 22:39					</div>
				</div>
				<div class="post-content content">
					<p>Would anybody tell me how to enable Wireless N only mode and how to enable 5ghz N? </p><p>Thanks!</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>