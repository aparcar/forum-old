<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Kamikaze r10141, ixP4xx on WG302(v1): eth0: MII read failed</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 29 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p61409">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">cdtdaddy</div>
					<div class="post-datetime">
						8 Jan 2008, 12:01					</div>
				</div>
				<div class="post-content content">
					<p>Hi all,<br />i&#039;ve successfully installed kamikaze trunk (r10141) on a wg302 but i&#039;m having troubles with ethernet.</p><p>Although the microcode seems to loads, eth0 is unusable and i&#039;m getting a flood of the following kernel message: &quot;eth0: MII read failed&quot;.<br />Mac address of eth0 is null (00:00:00:00:00:00) but i can configure the device with ifconfig.</p><p>Another strange thing is that the image seems not contains kmod-ixp4xx-npe (selected from kernel-modules -&gt; network devices) and i&#039;m <strong>not</strong> getting the following messages at boot time:<br /></p><div class="codebox"><pre><code>ixp4xx_mac driver 0.3.1: eth0 on NPE-B with PHY[0] initialized
ixp4xx_mac driver 0.3.1: eth1 on NPE-C with PHY[1] initialized</code></pre></div><p>I&#039;m following this (<a href="http://wiki.openwrt.org/OpenWrtDocs/Hardware/Netgear/WG302">http://wiki.openwrt.org/OpenWrtDocs/Har â€¦ gear/WG302</a>) guide.</p><p>My full dmsg output:</p><div class="codebox"><pre><code>root@OpenWrt:/#
root@OpenWrt:/#
root@OpenWrt:/#
root@OpenWrt:/# dmesg
Linux version 2.6.23.12 (davide@openvpngw) (gcc version 4.1.2) #5 Mon Jan 7 22:27:14 CET 2008
CPU: XScale-IXP42x Family [690541f1] revision 1 (ARMv5TE), cr=000039ff
Machine: Intel IXDP425 Development Platform
Warning: bad configuration page, trying to continue
Memory policy: ECC disabled, Data cache writeback
On node 0 totalpages: 4096
  DMA zone: 32 pages used for memmap
  DMA zone: 0 pages reserved
  DMA zone: 4064 pages, LIFO batch:0
  Normal zone: 0 pages used for memmap
  Movable zone: 0 pages used for memmap
CPU0: D VIVT undefined 5 cache
CPU0: I cache: 32768 bytes, associativity 32, 32 byte lines, 32 sets
CPU0: D cache: 32768 bytes, associativity 32, 32 byte lines, 32 sets
Built 1 zonelists in Zone order.  Total pages: 4064
Kernel command line: root=/dev/mtdblock2 rootfstype=squashfs,jffs2 noinitrd console=ttyS0,115200 init=/etc/preinit
PID hash table entries: 64 (order: 6, 256 bytes)
Dentry cache hash table entries: 2048 (order: 1, 8192 bytes)
Inode-cache hash table entries: 1024 (order: 0, 4096 bytes)
Memory: 16MB = 16MB total
Memory: 14120KB available (1816K code, 170K data, 92K init)
Calibrating delay loop... 266.24 BogoMIPS (lpj=1331200)
Mount-cache hash table entries: 512
CPU: Testing write buffer coherency: ok
NET: Registered protocol family 16
IXP4xx: Using 16MiB expansion bus window size
PCI: IXP4xx is host
PCI: IXP4xx Using direct access for memory space
PCI: bus0: Fast back to back transfers enabled
dmabounce: registered device 0000:00:02.0 on pci bus
NET: Registered protocol family 2
Time: OSTS clocksource has been installed.
Switched to high resolution mode on CPU 0
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 512 (order: 0, 4096 bytes)
TCP bind hash table entries: 512 (order: -1, 2048 bytes)
TCP: Hash tables configured (established 512 bind 512)
TCP reno registered
IXP4xx Queue Manager initialized.
squashfs: version 3.0 (2006/03/15) Phillip Lougher
Registering mini_fo version $Id$
JFFS2 version 2.2. (NAND) (SUMMARY)  B) 2001-2006 Red Hat, Inc.
io scheduler noop registered
io scheduler deadline registered (default)
Serial: 8250/16550 driver $Revision: 1.90 $ 2 ports, IRQ sharing disabled
serial8250.0: ttyS0 at MMIO 0xc8000000 (irq = 15) is a XScale
console [ttyS0] enabled
serial8250.0: ttyS1 at MMIO 0xc8001000 (irq = 13) is a XScale
eth0: MII PHY 0 on NPE-B
eth0: MII read failed
eth0: MII read failed
eth1: MII PHY 1 on NPE-C
eth1: MII read failed
eth1: MII read failed
IXP4XX-Flash.0: Found 1 x16 devices at 0x0 in 16-bit bank
IXP4XX-Flash.0: Found an alias at 0x800000 for the chip at 0x0
 Intel/Sharp Extended Query Table at 0x0031
Using buffer write method
cfi_cmdset_0001: Erase suspend on write enabled
erase region 0: offset=0x0,size=0x20000,blocks=64
Searching for RedBoot partition table in IXP4XX-Flash.0 at offset 0x7e0000
7 RedBoot partitions found on MTD device IXP4XX-Flash.0
Creating 7 MTD partitions on &quot;IXP4XX-Flash.0&quot;:
0x00000000-0x00060000 : &quot;RedBoot&quot;
0x00060000-0x00160000 : &quot;kernel&quot;
0x00160000-0x00780000 : &quot;rootfs&quot;
mtd: partition &quot;rootfs_data&quot; created automatically, ofs=260000, len=520000
0x00260000-0x00780000 : &quot;rootfs_data&quot;
0x00780000-0x007c0000 : &quot;unallocated&quot;
0x007c0000-0x007c1000 : &quot;RedBoot config&quot;
0x007c1000-0x007c2000 : &quot;Config backup&quot;
mtd: partition &quot;Config backup&quot; doesn&#039;t start on an erase block boundary -- force read-only
0x007e0000-0x00800000 : &quot;FIS directory&quot;
i2c /dev entries driver
isl1208 0-006f: chip found, driver version 0.2
isl1208 0-006f: rtc core: registered isl1208 as rtc0
i2c-gpio i2c-gpio.0: using pins 7 (SDA) and 6 (SCL)
IXP4xx Watchdog Timer: heartbeat 60 sec
nf_conntrack version 0.5.0 (1024 buckets, 4096 max)
ip_tables: (C) 2000-2006 Netfilter Core Team
TCP westwood registered
NET: Registered protocol family 1
NET: Registered protocol family 17
802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;
All bugs added by David S. Miller &lt;davem@redhat.com&gt;
XScale DSP coprocessor detected.
isl1208 0-006f: hctosys: invalid date/time
VFS: Mounted root (squashfs filesystem) readonly.
Freeing init memory: 92K
Warning: unable to open an initial console.
mini_fo: using base directory: /
mini_fo: using storage directory: /tmp/root
NPE-B: firmware&#039;s license can be found in /usr/share/doc/LICENSE.IPL
NPE-B: firmware functionality 0x0, revision 0x2:1
eth0: MII read failed
eth0: MII read failed
eth0: link down
PPP generic driver version 2.4.2
wlan: 0.8.4.2 (svn r2978)
ath_hal: module license &#039;Proprietary&#039; taints kernel.
ath_hal: 0.9.30.13 (AR5210, AR5211, AR5212, AR5416, RF5111, RF5112, RF2413, RF5413, RF2133, REGOPS_FUNC)
ath_rate_minstrel: Minstrel automatic rate control algorithm 1.2 (svn r2978)
ath_rate_minstrel: look around rate set to 10%
ath_rate_minstrel: EWMA rolloff level set to 75%
ath_rate_minstrel: max segment size in the mrr set to 6000 us
wlan: mac acl policy registered
ath_pci: 0.9.4.5 (svn r2978)
PCI: enabling device 0000:00:02.0 (0340 -&gt; 0342)
ath_pci: switching rfkill capability off
ath_pci: switching per-packet transmit power control off
wifi0: 11b rates: 1Mbps 2Mbps 5.5Mbps 11Mbps
wifi0: 11g rates: 1Mbps 2Mbps 5.5Mbps 11Mbps 6Mbps 9Mbps 12Mbps 18Mbps 24Mbps 36Mbps 48Mbps 54Mbps
wifi0: turboG rates: 6Mbps 12Mbps 18Mbps 24Mbps 36Mbps 48Mbps 54Mbps
wifi0: H/W encryption support: WEP AES AES_CCM TKIP
wifi0: mac 5.6 phy 4.1 radio 4.6
wifi0: Use hw queue 1 for WME_AC_BE traffic
wifi0: Use hw queue 0 for WME_AC_BK traffic
wifi0: Use hw queue 2 for WME_AC_VI traffic
wifi0: Use hw queue 3 for WME_AC_VO traffic
wifi0: Use hw queue 8 for CAB traffic
wifi0: Use hw queue 9 for beacons
wifi0: Atheros 5212: mem=0x48000000, irq=27
eth0: MII read failed
eth0: MII read failed
eth0: MII read failed
eth0: MII read failed
eth0: MII read failed
eth0: MII read failed
jffs2_scan_eraseblock(): End of filesystem marker found at 0x0
jffs2_build_filesystem(): unlocking the mtd device... &lt;3&gt;eth0: MII read failed
eth0: MII read failed
eth0: MII read failed
NPE-C: firmware&#039;s license can be found in /usr/share/doc/LICENSE.IPL
NPE-C: firmware functionality 0x0, revision 0x2:1
eth1: MII read failed
eth1: MII read failed
eth1: link down</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p62025">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">acoul</div>
					<div class="post-datetime">
						21 Jan 2008, 14:32					</div>
				</div>
				<div class="post-content content">
					<p>I think you have to skip the following NPE-B loading through tftp step.<br /></p><div class="codebox"><pre><code>    * load microcode from tftp server 

RedBoot&gt; load -r -b %{FREEMEMLO} NPE-B

    * write microcode to flash. Attention: Be sure to specify the corrent startaddress 0x50780000=startaddress of root partition plus size of root partition (0x620000, see above), as redboot otherwise places the microcode within the root partition. Bug or feature? 

RedBoot&gt; fis create -f 0x50780000 microcode</code></pre></div>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>