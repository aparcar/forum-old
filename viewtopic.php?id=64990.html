<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Extroot on the SD card reader of my 4G dongle?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 29 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p325003">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Retroplayer</div>
					<div class="post-datetime">
						20 May 2016, 21:04					</div>
				</div>
				<div class="post-content content">
					<p>I am configuring a hotspot to be installed in my vehicle using a TP-LINK TL-MR3020 router and Huawei E3272 4G LTE dongle on the T-Mobile network.</p><p>I had extroot working on a usb flash stick, but I was having trouble with the 4G dongle coming up as SDA1 during boot before usbmodeswitch could catch it, so the router would not see the extroot on the flash drive.</p><p>Then it occurred to me that the Huawei dongle has an SD card reader built in, why not just extroot to that? So, I managed to set up extroot on the SDcard, all was good.</p><p>Then I installed USB-modeswitch and (lol) now it can no longer see the SD card. <img src="https://forum.openwrt.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /></p><p>Is there a way to use the 4G modem of the dongle for internet and the SD card reader portion at the same time?</p><p>Not a complete noobie to openwrt, but let&#039;s just assume that I am because I am starting to feel like it!</p><p>Thanks for any help!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p325035">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Xotic750</div>
					<div class="post-datetime">
						20 May 2016, 23:49					</div>
				</div>
				<div class="post-content content">
					<p>I saw a post recently where someone was having a similar issue, I don&#039;t know whether they solved the problem or not but it would be worth doing a search and I would guess that <em>usb-modeswitch</em> would be a good keyword to use.</p>											<p class="post-edited">(Last edited by <strong>Xotic750</strong> on 21 May 2016, 00:19)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p325039">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Retroplayer</div>
					<div class="post-datetime">
						20 May 2016, 23:59					</div>
				</div>
				<div class="post-content content">
					<p>Thanks, I&#039;ll give it a try. Not always easy to guess just the right keywords for searching.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p325040">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">vernonjvs</div>
					<div class="post-datetime">
						21 May 2016, 00:13					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Retroplayer wrote:</cite><blockquote><p>I am configuring a hotspot to be installed in my vehicle using a TP-LINK TL-MR3020 router and Huawei E3272 4G LTE dongle on the T-Mobile network.</p><p>I had extroot working on a usb flash stick, but I was having trouble with the 4G dongle coming up as SDA1 during boot before usbmodeswitch could catch it, so the router would not see the extroot on the flash drive.</p><p>Then it occurred to me that the Huawei dongle has an SD card reader built in, why not just extroot to that? So, I managed to set up extroot on the SDcard, all was good.</p><p>Then I installed USB-modeswitch and (lol) now it can no longer see the SD card. <img src="https://forum.openwrt.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /></p><p>Is there a way to use the 4G modem of the dongle for internet and the SD card reader portion at the same time?</p><p>Not a complete noobie to openwrt, but let&#039;s just assume that I am because I am starting to feel like it!</p><p>Thanks for any help!</p></blockquote></div><p>Don&#039;t know if this works but there is a thread <a href="https://forum.openwrt.org/viewtopic.php?id=63891">here</a> and a Wiki section <a href="https://wiki.openwrt.org/doc/howto/extroot#extroot_to_a_card_in_a_slot_of_an_usb-dongle">here</a> thanks to <a href="https://forum.openwrt.org/profile.php?id=4377">booBot</a>.</p><p>Good Luck!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p325061">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">Retroplayer</div>
					<div class="post-datetime">
						21 May 2016, 04:03					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>vernonjvs wrote:</cite><blockquote><p>Don&#039;t know if this works but there is a thread <a href="https://forum.openwrt.org/viewtopic.php?id=63891">here</a> and a Wiki section <a href="https://wiki.openwrt.org/doc/howto/extroot#extroot_to_a_card_in_a_slot_of_an_usb-dongle">here</a> thanks to <a href="https://forum.openwrt.org/profile.php?id=4377">booBot</a>.</p><p>Good Luck!</p></blockquote></div><p>Yes, the Wiki section did the trick! Thank you! I sorta remembered that I could turn off the virtual cd-rom. No more usbmodeswitch needed!</p><p>Now I just need to remember how to get the 4G working again and set up failsafe to prefer Wifi and only use the 4G in the absence of it.</p>											<p class="post-edited">(Last edited by <strong>Retroplayer</strong> on 21 May 2016, 04:04)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p325091">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">booBot</div>
					<div class="post-datetime">
						21 May 2016, 10:23					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Retroplayer wrote:</cite><blockquote><p>Yes, the Wiki section did the trick!</p></blockquote></div><p>Good!<br /><img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Could you share your modem&#039;s model and firmware version - I&#039;d like to update the list in the wiki.</p><p>And please comment whether the AT-commands were exactly as I used for my modem or did you have to use their analogs for your&#039;s? If commands were different - please share too.</p>											<p class="post-edited">(Last edited by <strong>booBot</strong> on 21 May 2016, 10:25)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p325100">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">Retroplayer</div>
					<div class="post-datetime">
						21 May 2016, 11:26					</div>
				</div>
				<div class="post-content content">
					<p>This came from using the Mobile Partner software that came on the virtual CD-ROM:</p><div class="codebox"><pre><code>Device name: E3372
Hardware Version: CL1E3372SM Ver.A
Firmware Version: 21.286.03.01.209
Software Version: 23.015.11.00.03</code></pre></div><p>My understanding is that the firmware 21.* is already in stick mode and not Hilink.</p><p>The Setport menu was a bit different. </p><div class="codebox"><pre><code>Send:AT^SETPORT=?

Recieve: AT^SETPORT=?
Recieve: ^SETPORT:3: 3G DIAG
Recieve: ^SETPORT:10: 4G MODEM
Recieve: ^SETPORT:1: 3G MODEM
Recieve: ^SETPORT:12: 4G PCUI
Recieve: ^SETPORT:13: 4G DIAG
Recieve: ^SETPORT:5: 3G GPS
Recieve: ^SETPORT:14: 4G GPS
Recieve: ^SETPORT:A: BLUE TOOTH
Recieve: ^SETPORT:16: NCM
Recieve: ^SETPORT:A1: CDROM
Recieve: ^SETPORT:A2: SD
Recieve: OK

Send:AT^SETPORT?

Recieve: AT^SETPORT?
Recieve: ^SETPORT:FF;12,16,A2
Recieve: OK</code></pre></div><p>I turned on only the NCM function, but I have not gotten the modem to work yet, so I am probably going to need to change it. The important thing of course was the removal of the virtual cd-rom.</p><p>Looking at those settings, could you recommend what I should turn on/off? I&#039;d like the modem to be able to use 4G when available, but 3G when it&#039;s not. My data plan is also unlimited, but 4G up to 3GB/month and then reverts to 3G speeds.</p><p>Should I turn on all the &quot;modems&quot;?</p><p>BTW, GPS and BLUETOOTH give me errors. This stick doesn&#039;t appear to have those features.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p325102">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">Retroplayer</div>
					<div class="post-datetime">
						21 May 2016, 11:43					</div>
				</div>
				<div class="post-content content">
					<p>Re-arranged to hopefully be a little more clear:</p><br /><div class="codebox"><pre><code>Recieve: ^SETPORT:1: 3G MODEM
Recieve: ^SETPORT:3: 3G DIAG    *
Recieve: ^SETPORT:5: 3G GPS     *

Recieve: ^SETPORT:10: 4G MODEM
Recieve: ^SETPORT:12: 4G PCUI
Recieve: ^SETPORT:13: 4G DIAG   *
Recieve: ^SETPORT:14: 4G GPS    *

Recieve: ^SETPORT:16: NCM

Recieve: ^SETPORT:A: BLUE TOOTH *
Recieve: ^SETPORT:A1: CDROM
Recieve: ^SETPORT:A2: SD</code></pre></div><p>Items marked with an asterisk cause an error if I attempt to set them.</p><p>I changed it to ^SETPORT:FF;12,1,10,16,A2 to see if I will have any more luck.</p>											<p class="post-edited">(Last edited by <strong>Retroplayer</strong> on 21 May 2016, 11:44)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p325113">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">booBot</div>
					<div class="post-datetime">
						21 May 2016, 13:22					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;d rather had it like that:<br /></p><div class="codebox"><pre><code>at^setport=&quot;ff;1,3,10,12,13,16,a2&quot;</code></pre></div><p>You may omit the &quot;16&quot; there if you want a plain PPP-style modem.<br />Just re-enable all the <strong>DIAG</strong>s and do not disable the <strong>PCUI</strong>.</p><p>EDIT:<br />The &quot;NCM&quot; (shown as &quot;16&quot;) is a network adapter style of connection (instead of /dev/ttyUSBx it will use something other). I plan to try it too - may be it has a bit smaller footprint compared to the set of all PPP-related modules.</p>											<p class="post-edited">(Last edited by <strong>booBot</strong> on 21 May 2016, 13:28)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p325119">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">Retroplayer</div>
					<div class="post-datetime">
						21 May 2016, 13:56					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>booBot wrote:</cite><blockquote><p>I&#039;d rather had it like that:<br /></p><div class="codebox"><pre><code>at^setport=&quot;ff;1,3,10,12,13,16,a2&quot;</code></pre></div><p>You may omit the &quot;16&quot; there if you want a plain PPP-style modem.<br />Just re-enable all the <strong>DIAG</strong>s and do not disable the <strong>PCUI</strong>.</p><p>EDIT:<br />The &quot;NCM&quot; (shown as &quot;16&quot;) is a network adapter style of connection (instead of /dev/ttyUSBx it will use something other). I plan to try it too - may be it has a bit smaller footprint compared to the set of all PPP-related modules.</p></blockquote></div><p>The DIAG ports cause an ERROR response and will not set with the AT commands. I cannot turn them on for some reason. Would have loved to use the GPS as a GPS is part of my overall plan, but it also causes an error.</p><p>A PPP style modem is ok, maybe. I am just looking for the fastest speed to take advantage of the 4G. There are so many different methods and options, it has been difficult to find information. I did have it working at one time but I ended up with so much bloat from trying so many different things that I got lost in what finally worked and my configuration files were a mess. I unfortunately don&#039;t know what I did to get it working before.</p><p>As for NCM, from the reading I have done, it requires the CDC-ETHER package which I cannot find in attitude adjustment.</p><p>When only the NCM was turned on and Luci-Proto-3g installed, the router would crash when trying to configure a new interface from the GUI.No error was given. It would just kick me back to the main login screen.</p><p>I&#039;d be happy to be your guinea pig to try various things for your wiki entry. Even though I may eventually stumble on getting it working, I would prefer to understand why and how so that I can optimize it and make for the cleanest solution. The 4G and 3G stuff is a bit over my head right now.</p>											<p class="post-edited">(Last edited by <strong>Retroplayer</strong> on 21 May 2016, 13:57)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p325127">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">booBot</div>
					<div class="post-datetime">
						21 May 2016, 14:44					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m far from being an expert here.</p><p>Did<br /></p><div class="codebox"><pre><code>at^setport=&quot;ff;1,3,10,12,13,a2&quot;</code></pre></div><p>answer with &quot;OK&quot;?</p><p>If so, I think you should not touch those interfaces yourself, let the <strong>comgt</strong> do its job.<br />All you have to do is to point to /dev/ttyUSB0 in the network settings. At least - it worked for me <em>automagically</em> from then on.</p><p>I&#039;d be glad to help you - I&#039;m also interested in this topic very much.</p><p>EDIT:<br />Do you mean that you DID NOT explicetely disable the &quot;1&quot;, &quot;3&quot; and &quot;13&quot; yourself (in the previous AT-command)? What was before the<br /></p><div class="codebox"><pre><code>AT^SETPORT?
^SETPORT:FF;12,16,A2</code></pre></div><p>dialog?</p>											<p class="post-edited">(Last edited by <strong>booBot</strong> on 21 May 2016, 14:54)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p325133">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">Retroplayer</div>
					<div class="post-datetime">
						21 May 2016, 15:24					</div>
				</div>
				<div class="post-content content">
					<p>If 3 or 13 is anywhere in the string, the AT command will result in an error.</p><p>They were not turned on in the original config.</p><p>^SETPORT:A1,A2;12,10,16,A2 was the original string if I remember correctly.</p><p>Unfortunately I changed it from the factory several months ago, so even what it said yesterday is not the original string.</p><p>In the list above, I can set anything (or all) that do not have asterisks (*). Any of the choices with asterisks will give an error and the settings will not change at all (ie. it will ignore everything else.)</p><p>I turned on all the modems (1,10, and 16) and Luci still crashes when I try to add a new interface. It was not doing that before. Hmm...</p>											<p class="post-edited">(Last edited by <strong>Retroplayer</strong> on 21 May 2016, 15:27)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p330176">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">gentong</div>
					<div class="post-datetime">
						30 Jun 2016, 07:09					</div>
				</div>
				<div class="post-content content">
					<p>hello..<br />mine is e3372h hilink version.<br />extroot on microsd card cannot run. <br />seems, usbmodeswicth is the culprit. since the usbmodeswitch was run, the /dev/sda was broken. <br />i tired to send AT command in debug mode, but when i send it, it gives me ERROR.<br />why ? does the hilink version cannot send AT commands ? i sent it with AT^SETPORT=&quot;FF;A2,A3&quot; but ERROR<br />AT^SETPORT? can give the result<br />AT^RESET also can<br />i want to disable cd emulation, because i thought the problem caused by that.</p><p>if i change the firmware into mobile partner i can disable the cd rom emulation using AT command. and extroot from micro sd card working fine.</p>											<p class="post-edited">(Last edited by <strong>gentong</strong> on 30 Jun 2016, 07:15)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>