<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> swconfig help output meaning - vlans: 16 vlans: 4096</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 30 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p317057">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">geek007</div>
					<div class="post-datetime">
						28 Mar 2016, 06:09					</div>
				</div>
				<div class="post-content content">
					<p>I am using CC 15.05.1 version with Mediatek MT7621 SoC.</p><p>I want to get the SoC switch features.</p><p>I try to use swconfig to get some features it has and output is:</p><p>root@OpenWrt:/# swconfig dev mt7530 help<br />switch0: mt7530(mt7530), ports: 8 (cpu @ 6), vlans: 16<br />&nbsp; &nbsp; &nbsp;--switch<br />&nbsp; &nbsp; &nbsp; &nbsp; Attribute 1 (int): enable_vlan (VLAN mode (1:enabled))<br />&nbsp; &nbsp; &nbsp; &nbsp; Attribute 2 (none): apply (Activate changes in the hardware)<br />&nbsp; &nbsp; &nbsp; &nbsp; Attribute 3 (none): reset (Reset the switch)<br />&nbsp; &nbsp; &nbsp;--vlan<br />&nbsp; &nbsp; &nbsp; &nbsp; Attribute 1 (int): vid (VLAN ID (0-4094))<br />&nbsp; &nbsp; &nbsp; &nbsp; Attribute 2 (ports): ports (VLAN port mapping)<br />&nbsp; &nbsp; &nbsp;--port<br />&nbsp; &nbsp; &nbsp; &nbsp; Attribute 1 (string): mib (Get MIB counters for port)<br />&nbsp; &nbsp; &nbsp; &nbsp; Attribute 2 (int): pvid (Primary VLAN ID)<br />&nbsp; &nbsp; &nbsp; &nbsp; Attribute 3 (string): link (Get port link information)</p><p>I checked the swconfig documentation on openwrt documentation pages and got this switch feature:</p><br /><p>swconfig dev rtl8366rb help<br />switch1: rtl8366rb(RTL8366RB), ports: 6 (cpu @ 5), vlans: 4096<br />&nbsp; &nbsp; &nbsp;--switch<br />&nbsp; &nbsp; &nbsp; &nbsp; Attribute 1 (int): enable_learning (Enable learning, enable aging)<br />&nbsp; &nbsp; &nbsp; &nbsp; Attribute 2 (int): enable_vlan (Enable VLAN mode)<br />&nbsp; &nbsp; &nbsp; &nbsp; Attribute 3 (int): enable_vlan4k (Enable VLAN 4K mode)<br />&nbsp; &nbsp; &nbsp; &nbsp; Attribute 4 (none): reset_mibs (Reset all MIB counters)<br />&nbsp; &nbsp; &nbsp; &nbsp; Attribute 5 (int): blinkrate (Get/Set LED blinking rate (0 = 43ms, 1 = 84ms, 2 = 120ms, 3 = 170ms, 4 = 340ms, 5 = 670ms))<br />&nbsp; &nbsp; &nbsp; &nbsp; Attribute 6 (int): enable_qos (Enable QOS)<br />&nbsp; &nbsp; &nbsp; &nbsp; Attribute 7 (none): apply (Activate changes in the hardware)<br />&nbsp; &nbsp; &nbsp; &nbsp; Attribute 8 (none): reset (Reset the switch)<br />&nbsp; &nbsp; &nbsp;--vlan<br />&nbsp; &nbsp; &nbsp; &nbsp; Attribute 1 (string): info (Get vlan information)<br />&nbsp; &nbsp; &nbsp; &nbsp; Attribute 2 (int): fid (Get/Set vlan FID)<br />&nbsp; &nbsp; &nbsp; &nbsp; Attribute 3 (ports): ports (VLAN port mapping)<br />&nbsp; &nbsp; &nbsp;--port<br />&nbsp; &nbsp; &nbsp; &nbsp; Attribute 1 (none): reset_mib (Reset single port MIB counters)<br />&nbsp; &nbsp; &nbsp; &nbsp; Attribute 2 (string): mib (Get MIB counters for port)<br />&nbsp; &nbsp; &nbsp; &nbsp; Attribute 3 (int): led (Get/Set port group (0 - 3) led mode (0 - 15))<br />&nbsp; &nbsp; &nbsp; &nbsp; Attribute 4 (int): disable (Get/Set port state (enabled or disabled))<br />&nbsp; &nbsp; &nbsp; &nbsp; Attribute 5 (int): rate_in (Get/Set port ingress (incoming) bandwidth limit in kbps)<br />&nbsp; &nbsp; &nbsp; &nbsp; Attribute 6 (int): rate_out (Get/Set port egress (outgoing) bandwidth limit in kbps)<br />&nbsp; &nbsp; &nbsp; &nbsp; Attribute 7 (int): pvid (Primary VLAN ID)<br />&nbsp; &nbsp; &nbsp; &nbsp; Attribute 8 (string): link (Get port link information)</p><p>so vlans: 16 to vlans: 4096 --&gt; what difference it makes in switch function ?</p><p>If someone help in understanding of meaning of &quot;vlans :&quot; section in this switch function would be helpful.<br />Thanks in advance!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p317073">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">bolvan</div>
					<div class="post-datetime">
						28 Mar 2016, 09:49					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>geek007 wrote:</cite><blockquote><p>so vlans: 16 to vlans: 4096 --&gt; what difference it makes in switch function ?</p><p>If someone help in understanding of meaning of &quot;vlans :&quot; section in this switch function would be helpful.</p></blockquote></div><p>Its the maximum number of vlans switch can support.<br />RTL8366 switches have several operation modes. One of them use vlan table with size 16, another uses 4096 entry table. Also many modes and options not covered by the driver.<br />vlan4k option tells driver which mode to use.<br />Practically there&#039;s no difference. Who needs &gt;16 vlans on 4 port switch ?</p>											<p class="post-edited">(Last edited by <strong>bolvan</strong> on 28 Mar 2016, 09:51)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p317187">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">geek007</div>
					<div class="post-datetime">
						29 Mar 2016, 05:30					</div>
				</div>
				<div class="post-content content">
					<p>Yes, this switch has 5 ports only.</p><p>But I wounder if this vlans: 16 means if it connected to other switches then only 16 tagged vlans are possible ??<br />may be this limitation because of vlan table.</p><p>so vlans: 16 and vlans: 4096 makes big difference if one wants to use this for layer 2 use.<br />is that correct ???</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p317207">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">bolvan</div>
					<div class="post-datetime">
						29 Mar 2016, 09:22					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>geek007 wrote:</cite><blockquote><p>But I wounder if this vlans: 16 means if it connected to other switches then only 16 tagged vlans are possible ??</p></blockquote></div><p>Yes.<br />It doesnt mean vlan id must be only 1..16. It can be any, but 16 is the maximum number of vlans with any id because vlan table has only 16 entries.<br />I found some critical bugs in RTL8366S switch and had to study hardware docs and driver code. From what I understand it works like this.<br />Although I havent tested the case when tagged traffic enters untagged port. May be if a port is untagged and cpu is also untagged then frames are passed as is and host can use their vlan header to separate to eth0.1, eth0.2, .... Or if all ports are untagged then switch acts as simple non-controlled switch. Its logical. So, 16 entry table puts limits only on internal switch operation where tags are involved.</p>											<p class="post-edited">(Last edited by <strong>bolvan</strong> on 29 Mar 2016, 09:34)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p317257">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">stas2z</div>
					<div class="post-datetime">
						29 Mar 2016, 15:55					</div>
				</div>
				<div class="post-content content">
					<p>mt7530 switch hardware supports VLAN4K<br />it&#039;s a fault of openwrt mt7621 switch driver as it written using mt7620 switch codebase (mt7620 internal which supports 16 vlan table entries only)</p>											<p class="post-edited">(Last edited by <strong>stas2z</strong> on 29 Mar 2016, 15:59)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p317345">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">geek007</div>
					<div class="post-datetime">
						30 Mar 2016, 07:32					</div>
				</div>
				<div class="post-content content">
					<p>@stas2z , I checked swconfig source for: </p><p>switch0: mt7530(mt7530), ports: 8 (cpu @ 6), vlans: 16</p><p>line generation with mt7530(mt7530) generation and it is just alias for switch driver name. so this gsw is different than mt7530 and same with mt7620.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p317347">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">stas2z</div>
					<div class="post-datetime">
						30 Mar 2016, 10:31					</div>
				</div>
				<div class="post-content content">
					<p>mt7621 contains fully featured mt7530 gsw packaged into the SoC, it supports 4094 entries vlan table<br />common registers are compatible with mt7620, but it&#039;s a different and much more powerful switch</p><p>the source you checked is your problem, openwrt devs need to refactor 7621 switch driver code cuz atm it&#039;s based on 7620 code and don&#039;t consider a mt7530 hardware difference</p>											<p class="post-edited">(Last edited by <strong>stas2z</strong> on 30 Mar 2016, 10:39)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p317678">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">geek007</div>
					<div class="post-datetime">
						1 Apr 2016, 12:59					</div>
				</div>
				<div class="post-content content">
					<p>I am using OpenWRT CC 15.05.1 version for MT7621A SoC.</p><p>I checked #make kernel_menuconfig<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;--&gt;Device Driver<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; --&gt;Networking device support<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; --&gt;Ethernet driver support<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;--&gt;Ralink ethernet driver<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;--&gt;MAC Type(MT7620)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; --&gt;mt7620</p><br /><p>there is only open option for Ethernet driver selection --&gt; mt7620</p><p>I traced soure in &lt;openwrt&gt;/build_dir/target-mipsel_1004kc+dsp_uClibc-0.9.33.2/linux-ramips_mt7621/linux-3.18.27/drivers/net/ethernet/ralink/ </p><p>built-in.o&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.gsw_mt7620a.o.cmd&nbsp; &nbsp; &nbsp;mdio_rt2880.c&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .mt7530.o.cmd&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ralink_soc_eth.c&nbsp; &nbsp; &nbsp; &nbsp;soc_rt2880.c<br />.built-in.o.cmd&nbsp; &nbsp; &nbsp; &nbsp; Kconfig&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mdio_rt2880.h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ralink-eth.o&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ralink_soc_eth.h&nbsp; &nbsp; &nbsp; &nbsp;soc_rt305x.c<br />esw_rt3052.c&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Makefile&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;modules.builtin&nbsp; &nbsp; &nbsp; &nbsp; .ralink-eth.o.cmd&nbsp; &nbsp; &nbsp; ralink_soc_eth.o&nbsp; &nbsp; &nbsp; &nbsp;soc_rt3883.c<br />esw_rt3052.h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mdio.c&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;modules.order&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ralink_ethtool.c&nbsp; &nbsp; &nbsp; &nbsp;.ralink_soc_eth.o.cmd&nbsp; <br />gsw_mt7620a.c&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mdio.h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mt7530.c&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ralink_ethtool.h&nbsp; &nbsp; &nbsp; &nbsp;soc_mt7620.c&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />gsw_mt7620a.h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mdio.o&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mt7530.h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ralink_ethtool.o&nbsp; &nbsp; &nbsp; &nbsp;soc_mt7620.o&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />gsw_mt7620a.o&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .mdio.o.cmd&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mt7530.o&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.ralink_ethtool.o.cmd&nbsp; .soc_mt7620.o.cmd </p><br /><p>With selection of mt7620 gsw_mt7620a.c file is used.</p><p>but mt7530.c driver file also have </p><p>#define MT7530_NUM_VLANS&nbsp; &nbsp; &nbsp; &nbsp; 16</p><p>this which says vlans are 16.</p><p>what do you mean by &quot;openwrt devs need to refactor 7621 switch driver code&quot; ????</p><p>If I change this VLANS count will it help??</p><p>I am also checking mediatek mt7621 pdf documents but found docs are too short and brief.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p317701">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">stas2z</div>
					<div class="post-datetime">
						1 Apr 2016, 17:13					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>geek007 wrote:</cite><blockquote><p>but mt7530.c driver file also have </p><p>#define MT7530_NUM_VLANS&nbsp; &nbsp; &nbsp; &nbsp; 16</p><p>this which says vlans are 16.</p><p>If I change this VLANS count will it help??</p></blockquote></div><p>yes, mt7530.c is a part of openwrt ralink eth driver used for mt7530 init and swconfig control<br />you can try to change this value and recompile, but as im not a guy who written it and also don&#039;t have time to analyze this code, i can&#039;t give you any warranty of success<br /></p><div class="quotebox"><cite>geek007 wrote:</cite><blockquote><p>what do you mean by &quot;openwrt devs need to refactor 7621 switch driver code&quot; ????</p></blockquote></div><p>i mean this code requires improving to provide a better support of mt7621 gsw<br /></p><div class="quotebox"><cite>geek007 wrote:</cite><blockquote><p>I am also checking mediatek mt7621 pdf documents but found docs are too short and brief.</p></blockquote></div><p>you need mt7621 programming guide to find an info about mt7530 features and registers, but this document is private an supplied only for mediatek customers so im not sure it&#039;s available for downloading somewhere<br />if you need a generic info about mediatek/ralink switches u can get mt7620 programming guide which is leaked and can be found via google, but it doesn&#039;t contains mt7530 specific data.</p>											<p class="post-edited">(Last edited by <strong>stas2z</strong> on 1 Apr 2016, 17:14)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>