<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> 15.05 iptables modules don&#039;t load at boot</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 27 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p302014">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">stb</div>
					<div class="post-datetime">
						1 Dec 2015, 22:55					</div>
				</div>
				<div class="post-content content">
					<p>15.05 iptables modules don&#039;t load at boot</p><p>I&#039;ve got a strange problem: after boot, the firewall rules are not applied, because some<br />of the iptables modules are not loaded, but only on a specific build:</p><br /><p>Here&#039;s a working one, from a TP-Link TL-WR1043N/ND v1<br /></p><div class="codebox"><pre><code>BusyBox v1.23.2 (2015-07-25 15:09:46 CEST) built-in shell (ash)

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 -----------------------------------------------------
 CHAOS CALMER (15.05, r46767)
 -----------------------------------------------------
  * 1 1/2 oz Gin            Shake with a glassful
  * 1/4 oz Triple Sec       of broken ice and pour
  * 3/4 oz Lime Juice       unstrained into a goblet.
  * 1 1/2 oz Orange Juice
  * 1 tsp. Grenadine Syrup
 -----------------------------------------------------
root@amun:~# lsmod
arc4                    1232  2 
ath                    19280  3 ath9k
ath9k                  83696  0 
ath9k_common           15760  1 ath9k
ath9k_hw              331712  2 ath9k
cfg80211              204048  4 ath9k
compat                  1120  4 ath9k
crc16                    944  1 ext4
crc_ccitt                944  1 ppp_async
crypto_blkcipher        9744  1 arc4
crypto_hash             8416  2 ext4
ehci_hcd               31888  1 ehci_platform
ehci_platform           3408  0 
ext4                  303024  0 
gpio_button_hotplug     4400  0 
ip6_tables              9056  3 ip6table_raw
ip6t_REJECT             1104  2 
ip6table_filter          528  1 
ip6table_mangle          992  1 
ip6table_raw             496  1 
ip_tables               9200  4 iptable_nat
ipt_MASQUERADE           544  1 
ipt_REJECT               832  2 
iptable_filter           592  1 
iptable_mangle           864  1 
iptable_nat              688  1 
iptable_raw              560  1 
ipv6                  261168 46 nf_conntrack_ipv6
jbd2                   43424  1 ext4
ledtrig_usbdev          1856  0 
mac80211              362512  1 ath9k
mbcache                 4112  1 ext4
nf_conntrack           44800 11 nf_nat_ipv4
nf_conntrack_ftp        5200  1 nf_nat_ftp
nf_conntrack_ipv4       5072  8 
nf_conntrack_ipv6       5456  3 
nf_conntrack_rtcache    2400  0 
nf_defrag_ipv4           720  1 nf_conntrack_ipv4
nf_defrag_ipv6          8800  1 nf_conntrack_ipv6
nf_log_common           2240  2 nf_log_ipv4
nf_log_ipv4             3056  0 
nf_log_ipv6             3216  0 
nf_nat                  9168  5 nf_nat_ipv4
nf_nat_ftp              1120  0 
nf_nat_ipv4             3968  1 iptable_nat
nf_nat_masquerade_ipv4    1184  1 ipt_MASQUERADE
nf_reject_ipv4          1760  1 ipt_REJECT
nf_reject_ipv6          1856  1 ip6t_REJECT
nls_base                4656  1 usbcore
ppp_async               6240  0 
ppp_generic            20176  3 pppoe
pppoe                   8032  0 
pppox                   1136  1 pppoe
scsi_mod               79856  2 usb_storage
sd_mod                 25520  0 
slhc                    4080  1 ppp_generic
tun                    15024  2 
usb_common              1008  1 usbcore
usb_storage            36240  0 
usbcore               111392  4 ledtrig_usbdev
x_tables                9776 26 ipt_REJECT
xt_CT                   2144  0 
xt_LOG                   688  0 
xt_REDIRECT              976  0 
xt_TCPMSS               2528  2 
xt_comment               400 55 
xt_conntrack            2080 10 
xt_id                    400  0 
xt_limit                 912 20 
xt_mac                   544  0 
xt_mark                  592  0 
xt_multiport            1104  0 
xt_nat                   992  0 
xt_state                 608  0 
xt_tcpudp               1616 10 
xt_time                 1552  0 </code></pre></div><p>On a TP-Link Archer C7 v1, I get this:<br /></p><div class="codebox"><pre><code>BusyBox v1.23.2 (2015-07-25 15:09:46 CEST) built-in shell (ash)

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 -----------------------------------------------------
 CHAOS CALMER (15.05, r46767)
 -----------------------------------------------------
  * 1 1/2 oz Gin            Shake with a glassful
  * 1/4 oz Triple Sec       of broken ice and pour
  * 3/4 oz Lime Juice       unstrained into a goblet.
  * 1 1/2 oz Orange Juice
  * 1 tsp. Grenadine Syrup
 -----------------------------------------------------
root@OpenWrt:/# lsmod
arc4                    1232  0 
ath                    19280  1 ath10k_core
ath10k_core           166080  1 ath10k_pci
ath10k_pci             21448  1 
cfg80211              204048  3 ath10k_core
compat                  1120  3 ath10k_pci
crypto_blkcipher        9744  1 arc4
ehci_hcd               31888  1 ehci_platform
ehci_platform           3408  0 
gpio_button_hotplug     4400  0 
ip6_tables              9056  3 ip6table_raw
ip6t_REJECT             1104  0 
ip6table_filter          528  0 
ip6table_mangle          992  0 
ip6table_raw             496  1 
ipv6                  261168 26 nf_reject_ipv6
ledtrig_usbdev          1856  0 
mac80211              362512  1 ath10k_core
nf_log_common           2240  1 nf_log_ipv6
nf_log_ipv6             3216  0 
nf_reject_ipv6          1856  1 ip6t_REJECT
nls_base                4656  1 usbcore
usb_common              1008  1 usbcore
usbcore               111392  3 ledtrig_usbdev
x_tables                9776  5 ip6t_REJECT</code></pre></div><p>If I manually modprobe all modules (ipt*, nf_*, xt_*), I can /etc/init.d/firewall restart<br />and have everything work. But it&#039;s not coming up by itself, which is very frustrating.</p><p>The C7 has been sysupgraded from an earlier release. If I nuke the config completely,<br />I get the same, very short, module list.&nbsp; So I believe it&#039;s not my config that is causing<br />this.</p><p>Are there files I can copy over from the working 1043 box to fix the loading issue?</p><p>Here&#039;s the logread from the freshly booted C7 (with virgin config):<br /></p><div class="codebox"><pre><code>Wed Sep  9 04:05:08 2015 kern.info kernel: [    1.530000] eth0: Atheros AG71xx at 0xb9000000, irq 4, mode:RGMII
Wed Sep  9 04:05:08 2015 kern.info kernel: [    2.120000] eth1: Atheros AG71xx at 0xba000000, irq 5, mode:SGMII
Wed Sep  9 04:05:08 2015 kern.info kernel: [    2.120000] TCP: cubic registered
Wed Sep  9 04:05:08 2015 kern.info kernel: [    2.130000] NET: Registered protocol family 17
Wed Sep  9 04:05:08 2015 kern.info kernel: [    2.130000] bridge: automatic filtering via arp/ip/ip6tables has been deprecated. Update your scripts to load br_netfilter if you need this.
Wed Sep  9 04:05:08 2015 kern.notice kernel: [    2.140000] Bridge firewalling registered
Wed Sep  9 04:05:08 2015 kern.info kernel: [    2.150000] 8021q: 802.1Q VLAN Support v1.8
Wed Sep  9 04:05:08 2015 kern.info kernel: [    2.160000] VFS: Mounted root (squashfs filesystem) readonly on device 31:2.
Wed Sep  9 04:05:08 2015 kern.info kernel: [    2.170000] Freeing unused kernel memory: 224K (80368000 - 803a0000)
Wed Sep  9 04:05:08 2015 user.info kernel: [    3.230000] init: Console is alive
Wed Sep  9 04:05:08 2015 user.info kernel: [    3.230000] init: - watchdog -
Wed Sep  9 04:05:08 2015 kern.info kernel: [    4.540000] usbcore: registered new interface driver usbfs
Wed Sep  9 04:05:08 2015 kern.info kernel: [    4.540000] usbcore: registered new interface driver hub
Wed Sep  9 04:05:08 2015 kern.info kernel: [    4.550000] usbcore: registered new device driver usb
Wed Sep  9 04:05:08 2015 kern.info kernel: [    4.560000] ehci_hcd: USB 2.0 &#039;Enhanced&#039; Host Controller (EHCI) Driver
Wed Sep  9 04:05:08 2015 kern.info kernel: [    4.570000] ehci-platform: EHCI generic platform driver
Wed Sep  9 04:05:08 2015 kern.info kernel: [    4.570000] ehci-platform ehci-platform.0: EHCI Host Controller
Wed Sep  9 04:05:08 2015 kern.info kernel: [    4.580000] ehci-platform ehci-platform.0: new USB bus registered, assigned bus number 1
Wed Sep  9 04:05:08 2015 kern.info kernel: [    4.590000] ehci-platform ehci-platform.0: TX-TX IDP fix enabled
Wed Sep  9 04:05:08 2015 kern.info kernel: [    4.590000] ehci-platform ehci-platform.0: irq 48, io mem 0x1b000000
Wed Sep  9 04:05:08 2015 kern.info kernel: [    4.620000] ehci-platform ehci-platform.0: USB 2.0 started, EHCI 1.00
Wed Sep  9 04:05:08 2015 kern.info kernel: [    4.620000] hub 1-0:1.0: USB hub found
Wed Sep  9 04:05:08 2015 kern.info kernel: [    4.630000] hub 1-0:1.0: 1 port detected
Wed Sep  9 04:05:08 2015 kern.info kernel: [    4.630000] ehci-platform ehci-platform.1: EHCI Host Controller
Wed Sep  9 04:05:08 2015 kern.info kernel: [    4.640000] ehci-platform ehci-platform.1: new USB bus registered, assigned bus number 2
Wed Sep  9 04:05:08 2015 kern.info kernel: [    4.650000] ehci-platform ehci-platform.1: TX-TX IDP fix enabled
Wed Sep  9 04:05:08 2015 kern.info kernel: [    4.650000] ehci-platform ehci-platform.1: irq 49, io mem 0x1b400000
Wed Sep  9 04:05:08 2015 kern.info kernel: [    4.680000] ehci-platform ehci-platform.1: USB 2.0 started, EHCI 1.00
Wed Sep  9 04:05:08 2015 kern.info kernel: [    4.680000] hub 2-0:1.0: USB hub found
Wed Sep  9 04:05:08 2015 kern.info kernel: [    4.690000] hub 2-0:1.0: 1 port detected
Wed Sep  9 04:05:08 2015 user.info kernel: [    5.290000] init: - preinit -
Wed Sep  9 04:05:08 2015 kern.info kernel: [    6.070000] eth1: link up (1000Mbps/Full duplex)
Wed Sep  9 04:05:08 2015 kern.notice kernel: [    6.090000] random: procd urandom read with 9 bits of entropy available
Wed Sep  9 04:05:08 2015 user.warn kernel: [    9.320000] mount_root: no usable overlay filesystem found, using tmpfs overlay
Wed Sep  9 04:05:08 2015 kern.info kernel: [    9.400000] eth1: link down
Wed Sep  9 04:05:08 2015 user.info kernel: [    9.410000] procd: - early -
Wed Sep  9 04:05:08 2015 user.info kernel: [    9.410000] procd: - watchdog -
Wed Sep  9 04:05:08 2015 user.info kernel: [   10.030000] procd: - ubus -
Wed Sep  9 04:05:08 2015 user.info kernel: [   11.050000] procd: - init -
Wed Sep  9 04:05:08 2015 kern.info kernel: [   11.630000] NET: Registered protocol family 10
Wed Sep  9 04:05:08 2015 kern.info kernel: [   11.640000] ip6_tables: (C) 2000-2006 Netfilter Core Team
Wed Sep  9 04:05:08 2015 kern.info kernel: [   11.650000] Loading modules backported from Linux version master-2015-03-09-0-g141f155
Wed Sep  9 04:05:08 2015 kern.info kernel: [   11.660000] Backport generated by backports.git backports-20150129-0-gdd4a670
Wed Sep  9 04:05:08 2015 kern.info kernel: [   11.680000] cfg80211: Calling CRDA to update world regulatory domain
Wed Sep  9 04:05:08 2015 kern.info kernel: [   11.710000] cfg80211: World regulatory domain updated:
Wed Sep  9 04:05:08 2015 kern.info kernel: [   11.710000] cfg80211:  DFS Master region: unset
Wed Sep  9 04:05:08 2015 kern.info kernel: [   11.720000] cfg80211:   (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp), (dfs_cac_time)
Wed Sep  9 04:05:08 2015 kern.info kernel: [   11.730000] cfg80211:   (2402000 KHz - 2472000 KHz @ 40000 KHz), (N/A, 2000 mBm), (N/A)
Wed Sep  9 04:05:08 2015 kern.info kernel: [   11.730000] cfg80211:   (2457000 KHz - 2482000 KHz @ 40000 KHz), (N/A, 2000 mBm), (N/A)
Wed Sep  9 04:05:08 2015 kern.info kernel: [   11.740000] cfg80211:   (2474000 KHz - 2494000 KHz @ 20000 KHz), (N/A, 2000 mBm), (N/A)
Wed Sep  9 04:05:08 2015 kern.info kernel: [   11.750000] cfg80211:   (5170000 KHz - 5250000 KHz @ 80000 KHz), (N/A, 2000 mBm), (N/A)
Wed Sep  9 04:05:08 2015 kern.info kernel: [   11.760000] cfg80211:   (5250000 KHz - 5330000 KHz @ 80000 KHz, 160000 KHz AUTO), (N/A, 2000 mBm), (0 s)
Wed Sep  9 04:05:08 2015 kern.info kernel: [   11.770000] cfg80211:   (5490000 KHz - 5730000 KHz @ 160000 KHz), (N/A, 2000 mBm), (0 s)
Wed Sep  9 04:05:08 2015 kern.info kernel: [   11.780000] cfg80211:   (5735000 KHz - 5835000 KHz @ 80000 KHz), (N/A, 2000 mBm), (N/A)
Wed Sep  9 04:05:08 2015 kern.info kernel: [   11.780000] cfg80211:   (57240000 KHz - 63720000 KHz @ 2160000 KHz), (N/A, 0 mBm), (N/A)
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.830000] PCI: Enabling device 0000:01:00.0 (0000 -&gt; 0002)
Wed Sep  9 04:05:08 2015 kern.info kernel: [   11.830000] ath10k_pci 0000:01:00.0: pci irq legacy interrupts 0 irq_mode 0 reset_mode 0
Wed Sep  9 04:05:08 2015 kern.alert kernel: [   11.890000] Data bus error, epc == 87be9128, ra == 87be9128
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] Oops[#1]:
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] CPU: 0 PID: 625 Comm: kmodloader Not tainted 3.18.20 #1
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] task: 87be09b0 ti: 87b14000 task.ti: 87b14000
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] $ 0   : 00000000 00000000 deadc0de 87121704
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] $ 4   : b2009030 0002bb38 00000196 ffff00fe
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] $ 8   : 00000010 80064f40 00000001 001e0040
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] $12   : 00000003 772863a0 0000000b 773173d0
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] $16   : 871dd720 00000000 00000000 ffff90a0
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] $20   : 80350000 ffffffff 871deef4 87be9284
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] $24   : 77308000 8006de4c                  
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] $28   : 87b14000 87b15bc8 00000007 87be9128
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] Hi    : 00000196
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] Lo    : 2a840000
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] epc   : 87be9128 0x87be9128 [ath10k_pci@87be8000+0x5370]
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000]     Not tainted
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] ra    : 87be9128 0x87be9128 [ath10k_pci@87be8000+0x5370]
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] Status: 1100fc03      KERNEL EXL IE 
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] Cause : 0080001c
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] PrId  : 00019750 (MIPS 74Kc)
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] Modules linked in: ath10k_pci(+) ath10k_core ath mac80211 cfg80211 compat ledtrig_usbdev ip6t_REJECT nf_reject_ipv6 nf_log_ipv6 nf_log_common ip6table_raw ip6table_mangle ip6table_filter ip6_tables x_tables ipv6 arc4 crypto_blkcipher ehci_platform ehci_hcd gpio_button_hotplug usbcore nls_base usb_common
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] Process kmodloader (pid: 625, threadinfo=87b14000, task=87be09b0, tls=77abc440)
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] Stack : 87be9284 87be8e84 87bec87c 87bec85c 87bf0000 871dd720 00000001 87bec87c
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000]         87bec85c 87bf0000 8786c400 87be9ac0 00000000 801e9864 87beef00 80359ee4
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000]         87be9f30 871dd720 00000001 87be9be8 871dd720 800a62b8 871dd860 87107be8
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000]         8786c400 871deef4 871dd720 87bf0000 871dd720 00000000 87bf0000 871dec4c
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000]         87be8f90 87bea660 87069af0 87069b90 87bec958 00000000 87becabc 871dd720
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000]         ...
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] Call Trace:[&lt;87be9284&gt;] 0x87be9284 [ath10k_pci@87be8000+0x5370]
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;87be8e84&gt;] 0x87be8e84 [ath10k_pci@87be8000+0x5370]
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;87be9ac0&gt;] 0x87be9ac0 [ath10k_pci@87be8000+0x5370]
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;801e9864&gt;] 0x801e9864
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;87be9f30&gt;] 0x87be9f30 [ath10k_pci@87be8000+0x5370]
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;87be9be8&gt;] 0x87be9be8 [ath10k_pci@87be8000+0x5370]
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;800a62b8&gt;] 0x800a62b8
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;87107be8&gt;] 0x87107be8 [ath10k_core@87100000+0x288c0]
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;87be8f90&gt;] 0x87be8f90 [ath10k_pci@87be8000+0x5370]
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;87bea660&gt;] 0x87bea660 [ath10k_pci@87be8000+0x5370]
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;801c7774&gt;] 0x801c7774
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;801ec6c4&gt;] 0x801ec6c4
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;801ecce8&gt;] 0x801ecce8
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;801a5bec&gt;] 0x801a5bec
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;801ecf14&gt;] 0x801ecf14
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;801eb178&gt;] 0x801eb178
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;801ece98&gt;] 0x801ece98
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;801eb230&gt;] 0x801eb230
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;802ecca4&gt;] 0x802ecca4
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;801eb008&gt;] 0x801eb008
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;801ec418&gt;] 0x801ec418
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;800909c4&gt;] 0x800909c4
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;801a3480&gt;] 0x801a3480
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;801ed3ec&gt;] 0x801ed3ec
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;8009eb70&gt;] 0x8009eb70
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;80090a3c&gt;] 0x80090a3c
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;87bef000&gt;] 0x87bef000 [ath10k_pci@87be8000+0x5370]
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;87bef02c&gt;] 0x87bef02c [ath10k_pci@87be8000+0x5370]
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;800ee3cc&gt;] 0x800ee3cc
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;87bef000&gt;] 0x87bef000 [ath10k_pci@87be8000+0x5370]
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;800694d4&gt;] 0x800694d4
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;800cbc44&gt;] 0x800cbc44
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;800ef83c&gt;] 0x800ef83c
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;800ef914&gt;] 0x800ef914
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;800be398&gt;] 0x800be398
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;800ef604&gt;] 0x800ef604
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;800bc1a0&gt;] 0x800bc1a0
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;800efd38&gt;] 0x800efd38
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;800be6a4&gt;] 0x800be6a4
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;800efe10&gt;] 0x800efe10
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;800be6a4&gt;] 0x800be6a4
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;800be704&gt;] 0x800be704
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] [&lt;80062b5c&gt;] 0x80062b5c
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] 
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] 
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   11.890000] Code: 8e041538  0c06e458  00822021 &lt;14550007&gt; 00408821  8e82db8c  00531023  0440fff4  00000000 
Wed Sep  9 04:05:08 2015 kern.warn kernel: [   12.250000] ---[ end trace 2702c5f968681fd4 ]---
Wed Sep  9 04:05:12 2015 daemon.err mount_root: no jffs2 marker found
Wed Sep  9 04:05:12 2015 kern.notice kernel: [   19.100000] jffs2: notice: (958) jffs2_build_xattr_subsystem: complete building xattr subsystem, 0 of xdatum (0 unchecked, 0 orphan) and 0 of xref (0 dead, 0 orphan) found.
Wed Sep  9 04:05:13 2015 daemon.info mount_root: performing overlay whiteout
Wed Sep  9 04:05:14 2015 user.emerg syslog: setting up led USB1
Wed Sep  9 04:05:14 2015 user.emerg syslog: setting up led USB2
Wed Sep  9 04:05:14 2015 user.emerg syslog: setting up led WLAN2G
Wed Sep  9 04:05:14 2015 user.emerg syslog: Skipping trigger &#039;phy1tpt&#039; for led &#039;WLAN2G&#039; due to missing kernel module
Wed Sep  9 04:05:14 2015 user.emerg syslog: setting up led WLAN5G
Wed Sep  9 04:05:14 2015 user.emerg syslog: Skipping trigger &#039;phy0tpt&#039; for led &#039;WLAN5G&#039; due to missing kernel module
Wed Sep  9 04:05:14 2015 daemon.info procd: - init complete -
Wed Sep  9 04:05:14 2015 kern.info kernel: [   21.320000] eth1: link up (1000Mbps/Full duplex)
Wed Sep  9 04:05:14 2015 kern.info kernel: [   21.320000] device eth1 entered promiscuous mode
Wed Sep  9 04:05:14 2015 kern.info kernel: [   21.340000] IPv6: ADDRCONF(NETDEV_UP): br-lan: link is not ready
Wed Sep  9 04:05:14 2015 daemon.notice netifd: Interface &#039;lan&#039; is enabled
Wed Sep  9 04:05:14 2015 daemon.notice netifd: Interface &#039;lan&#039; is setting up now
Wed Sep  9 04:05:14 2015 daemon.notice netifd: Interface &#039;lan&#039; is now up
Wed Sep  9 04:05:14 2015 daemon.notice netifd: Interface &#039;loopback&#039; is enabled
Wed Sep  9 04:05:14 2015 daemon.notice netifd: Interface &#039;loopback&#039; is setting up now
Wed Sep  9 04:05:14 2015 daemon.notice netifd: Interface &#039;loopback&#039; is now up
Wed Sep  9 04:05:14 2015 kern.info kernel: [   21.370000] IPv6: ADDRCONF(NETDEV_UP): eth0: link is not ready
Wed Sep  9 04:05:14 2015 daemon.notice netifd: Interface &#039;wan&#039; is enabled
Wed Sep  9 04:05:14 2015 daemon.notice netifd: Interface &#039;wan6&#039; is enabled
Wed Sep  9 04:05:14 2015 daemon.notice netifd: Network device &#039;eth1&#039; link is up
Wed Sep  9 04:05:14 2015 daemon.notice netifd: Network device &#039;lo&#039; link is up
Wed Sep  9 04:05:14 2015 daemon.notice netifd: Interface &#039;loopback&#039; has link connectivity 
Wed Sep  9 04:05:15 2015 user.notice firewall: Reloading firewall due to ifup of lan (br-lan)
Wed Sep  9 04:05:15 2015 kern.info kernel: [   22.320000] br-lan: port 1(eth1) entered forwarding state
Wed Sep  9 04:05:15 2015 kern.info kernel: [   22.320000] br-lan: port 1(eth1) entered forwarding state
Wed Sep  9 04:05:15 2015 daemon.notice netifd: Bridge &#039;br-lan&#039; link is up
Wed Sep  9 04:05:15 2015 daemon.notice netifd: Interface &#039;lan&#039; has link connectivity 
Wed Sep  9 04:05:15 2015 kern.info kernel: [   22.340000] IPv6: ADDRCONF(NETDEV_CHANGE): br-lan: link becomes ready
Wed Sep  9 04:05:16 2015 kern.info kernel: [   22.730000] eth0: link up (1000Mbps/Full duplex)
Wed Sep  9 04:05:16 2015 kern.info kernel: [   22.730000] IPv6: ADDRCONF(NETDEV_CHANGE): eth0: link becomes ready
Wed Sep  9 04:05:16 2015 daemon.notice netifd: Network device &#039;eth0&#039; link is up
Wed Sep  9 04:05:16 2015 daemon.notice netifd: Interface &#039;wan&#039; has link connectivity 
Wed Sep  9 04:05:16 2015 daemon.notice netifd: Interface &#039;wan&#039; is setting up now
Wed Sep  9 04:05:16 2015 daemon.notice netifd: Interface &#039;wan6&#039; has link connectivity 
Wed Sep  9 04:05:16 2015 daemon.notice netifd: Interface &#039;wan6&#039; is setting up now
Wed Sep  9 04:05:16 2015 daemon.notice netifd: wan (1056): udhcpc (v1.23.2) started
Wed Sep  9 04:05:16 2015 daemon.notice netifd: wan (1056): Sending discover...
Wed Sep  9 04:05:17 2015 kern.info kernel: [   24.320000] br-lan: port 1(eth1) entered forwarding state
Wed Sep  9 04:05:18 2015 kern.info kernel: [   24.730000] Atheros AR8216/AR8236/AR8316 ag71xx-mdio.0:00: Port 5 is up
Wed Sep  9 04:05:19 2015 daemon.notice netifd: wan (1056): Sending discover...
Wed Sep  9 04:05:20 2015 daemon.info dnsmasq[1091]: started, version 2.73 cachesize 150
Wed Sep  9 04:05:20 2015 daemon.info dnsmasq[1091]: compile time options: IPv6 GNU-getopt no-DBus no-i18n no-IDN DHCP no-DHCPv6 no-Lua TFTP no-conntrack no-ipset no-auth no-DNSSEC loop-detect inotify
Wed Sep  9 04:05:20 2015 daemon.info dnsmasq[1091]: DNS service limited to local subnets
Wed Sep  9 04:05:20 2015 daemon.info dnsmasq-dhcp[1091]: DHCP, IP range 192.168.1.100 -- 192.168.1.249, lease time 12h
Wed Sep  9 04:05:20 2015 daemon.info dnsmasq[1091]: using local addresses only for domain lan
Wed Sep  9 04:05:20 2015 daemon.warn dnsmasq[1091]: no servers found in /tmp/resolv.conf.auto, will retry
Wed Sep  9 04:05:20 2015 daemon.info dnsmasq[1091]: read /etc/hosts - 1 addresses
Wed Sep  9 04:05:20 2015 daemon.info dnsmasq[1091]: read /tmp/hosts/dhcp - 1 addresses
Wed Sep  9 04:05:20 2015 daemon.info dnsmasq-dhcp[1091]: read /etc/ethers - 0 addresses
Wed Sep  9 04:05:22 2015 daemon.notice netifd: wan (1056): Sending discover...
Wed Sep  9 04:05:26 2015 daemon.info dnsmasq-dhcp[1091]: DHCPDISCOVER(br-lan) a8:20:66:0b:30:29 
Wed Sep  9 04:05:26 2015 daemon.info dnsmasq-dhcp[1091]: DHCPOFFER(br-lan) 192.168.1.247 a8:20:66:0b:30:29 
Wed Sep  9 04:05:27 2015 daemon.info dnsmasq-dhcp[1091]: DHCPREQUEST(br-lan) 192.168.1.247 a8:20:66:0b:30:29 
Wed Sep  9 04:05:27 2015 daemon.info dnsmasq-dhcp[1091]: DHCPACK(br-lan) 192.168.1.247 a8:20:66:0b:30:29 W4DEUMSY9001002
Wed Sep  9 04:05:48 2015 authpriv.info dropbear[1180]: Not backgrounding
Wed Sep  9 04:06:10 2015 kern.notice kernel: [   77.500000] random: nonblocking pool is initialized</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p302016">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">stb</div>
					<div class="post-datetime">
						1 Dec 2015, 23:16					</div>
				</div>
				<div class="post-content content">
					<p>One small addition: in my various attempts to fix a potential error in the firmware upgrade, I&#039;ve noticed that the reboot that sysupgrade starts never happens. The ssh connection stays connected and it continues to echo characters. I have to powercycle to have to box reboot.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p302017">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">stb</div>
					<div class="post-datetime">
						1 Dec 2015, 23:43					</div>
				</div>
				<div class="post-content content">
					<p>As another datapoint, I have a C7 v2 running as an access point which has all iptables modules loaded. It&#039;s running a custom build, but off the release branch (r47277).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p302932">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">stb</div>
					<div class="post-datetime">
						8 Dec 2015, 21:18					</div>
				</div>
				<div class="post-content content">
					<p>I just realized that the wifi modules are also not loaded (properly).</p><p>From an C7 v1 running 14.07:<br /></p><div class="codebox"><pre><code># lsmod
arc4                    1312  2 
ath                    19717  4 ath9k
ath10k_core            90806  1 ath10k_pci
ath10k_pci             22748  0 
ath9k                  88369  0 
ath9k_common           11437  1 ath9k
ath9k_hw              314943  2 ath9k
cfg80211              197703  5 ath9k
compat                  1988  5 ath9k
crc_ccitt               1019  1 ppp_async
...</code></pre></div><p>On the one running 15.05:<br /></p><div class="codebox"><pre><code># lsmod
arc4                    1232  0 
ath                    19280  1 ath10k_core
ath10k_core           166080  1 ath10k_pci
ath10k_pci             21448  1 
cfg80211              204048  3 ath10k_core
compat                  1120  3 ath10k_pci
crypto_blkcipher        9744  1 arc4
...</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p309401">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">invliD</div>
					<div class="post-datetime">
						28 Jan 2016, 22:10					</div>
				</div>
				<div class="post-content content">
					<p>I have the exact same issue with an Archer C7 v1 running 15.05. Did you eventually find a solution?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p310511">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">invliD</div>
					<div class="post-datetime">
						6 Feb 2016, 17:08					</div>
				</div>
				<div class="post-content content">
					<p>I fixed the issue by building my own image and not including ath10k. I think the kernel oops during boot is due to ath10k not finding any wireless module it supports and that prevents a lot of other modules from loading.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>