<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> New Broadcom BCM63xx codebase with GPL&#039;d Ethernet and USB support</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 8 Feb 2018 and 7 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 2 of 30</div><nav><ul><li><a href="viewtopic.php%3Fid=17370&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li><li><a href="viewtopic.php%3Fid=17370&amp;p=3.html">3</a></li><li><a href="viewtopic.php%3Fid=17370&amp;p=4.html">4</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=17370&amp;p=30.html">30</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p75817">
				<div class="post-metadata">
					<div class="post-num">Post #26</div>
					<div class="post-author">t3l3m4k0</div>
					<div class="post-datetime">
						3 Nov 2008, 16:15					</div>
				</div>
				<div class="post-content content">
					<p>I tested. Loading goes away,&nbsp; but finaly it crashes.</p><p>Any idea would be apreciated.</p><p>log here:<br /></p><div class="codebox"><pre><code>CFE version 1.0.37-0.8 for BCM96348 (32bit,SP,BE)
Build Date: Â¥|  2Â¤Ã« 14 14:18:59 CST 2008 (root@Yau)
Copyright (C) 2000,2001,2002,2003 Broadcom Corporation.

Initializing Arena.
Initializing Devices.
CPU type 0x29107: 256MHz, Bus: 128MHz, Ref: 32MHz

Total memory used by CFE:  0x80401000 - 0x80524880 (1194112)
Initialized Data:          0x8041C810 - 0x8041E210 (6656)
BSS Area:                  0x8041E210 - 0x80422880 (18032)
Local Heap:                0x80422880 - 0x80522880 (1048576)
Stack Area:                0x80522880 - 0x80524880 (8192)
Text (code) segment:       0x80401000 - 0x8041C804 (112644)
Boot area (physical):      0x00525000 - 0x00565000
Relocation Factor:         I:00000000 - D:00000000

Board IP address                : 192.168.1.19:ffffff00
Host IP address                 : 192.168.1.21
Gateway IP address              : 192.168.1.1
Run from flash/host (f/h)       : f
Default host run file name      : vmlinux
Default host flash file name    : bcm963xx_fs_kernel
Boot delay (0-9 seconds)        : 2
Board Id Name                   : 96348GW
Psi size in KB                  : 24
Number of MAC Addresses (1-32)  : 10
Base MAC Address                : 11:22:33:44:55:60
Ethernet PHY Type               : Internal
Memory size in MB               : 16

*** Press any key to stop auto run (2 seconds) ***
Auto run second count down: 0
GPIOio_PIN_HIGH is Off
Code Address: 0x80010000, Entry Address: 0x80010000
Decompression OK!
Entry at 0x80010000
Closing network.
Starting program at 0x80010000
Linux version 2.6.27.4 (od1sea@1t4k4) (gcc version 3.4.6 (OpenWrt-2.0)) #3 Mon N                                                                             ov 3 14:25:37 CET 2008
Detected Broadcom 0x6348 CPU revision a2
CPU frequency is 256000000 MHz
16MB of RAM installed
board_bcm963xx: CFE version: 1.0.37-0.8
console [early0] enabled
CPU revision is: 00029107 (Broadcom BCM6348)
board_bcm963xx: board name: 96348GW
Determined physical RAM map:
 memory: 01000000 @ 00000000 (usable)
Initrd not found or empty - disabling initrd
Zone PFN ranges:
  Normal   0x00000000 -&gt; 0x00001000
Movable zone start PFN for each node
early_node_map[1] active PFN ranges
    0: 0x00000000 -&gt; 0x00001000
Built 1 zonelists in Zone order, mobility grouping off.  Total pages: 4064
Kernel command line: root=/dev/mtdblock2 rootfstype=squashfs,jffs2 init=/etc/pre                                                                             init noinitrd console=ttyS0,115200
Primary instruction cache 16kB, VIPT, 2-way, linesize 16 bytes.
Primary data cache 8kB, 2-way, VIPT, no aliases, linesize 16 bytes
PID hash table entries: 64 (order: 6, 256 bytes)
Dentry cache hash table entries: 2048 (order: 1, 8192 bytes)
Inode-cache hash table entries: 1024 (order: 0, 4096 bytes)
Memory: 13660k/16384k available (1914k kernel code, 2724k reserved, 339k data, 1                                                                             20k init, 0k highmem)
Calibrating delay loop... 255.48 BogoMIPS (lpj=510976)
Mount-cache hash table entries: 512
net_namespace: 592 bytes
NET: Registered protocol family 16
registering PCI controller with io_map_base unset
bus: 00 index 0 io port: [8000000, 800ffff]
bus: 00 index 1 mmio: [30000000, 37ffffff]
NET: Registered protocol family 2
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 512 (order: 0, 4096 bytes)
TCP bind hash table entries: 512 (order: -1, 2048 bytes)
TCP: Hash tables configured (established 512 bind 512)
TCP reno registered
NET: Registered protocol family 1
audit: initializing netlink socket (disabled)
type=2000 audit(0.265:1): initialized
squashfs: version 3.0 (2006/03/15) Phillip Lougher
Registering mini_fo version $Id$
JFFS2 version 2.2. (NAND) (SUMMARY)  Ã‚Â© 2001-2006 Red Hat, Inc.
msgmni has been set to 26
io scheduler noop registered
io scheduler cfq registered (default)
bcm63xx_uart.0: ttyS0 at MMIO 0xfffe0300 (irq = 10) is a bcm63xx_uart
console handover: boot [early0] -&gt; real [ttyS0]
bcm63xx_enet MII bus: probed
bcm963xx: 0x00400000 at 0x1fc00000
bcm963xx: Found 1 x16 devices at 0x0 in 16-bit bank
 Amd/Fujitsu Extended Query Table at 0x0040
number of CFI chips: 1
cfi_cmdset_0002: Disabling erase-suspend-program due to code brokenness.
bcm963xx: Read Signature value of CFE1CFE1
bcm963xx: CFE bootloader detected
bcm963xx: CFE boot tag found with version 6 and board type 96348GW.
bcm963xx: Partition 0 is CFE offset 0 and length 10000
bcm963xx: Partition 1 is Kernel offset 10100 and length bf205
bcm963xx: Partition 2 is Rootfs offset d0000 and length 120000
bcm963xx: Partition 3 is OpenWrt offset 1f0000 and length 200000
bcm963xx: Partition 4 is NVRAM offset 3f0000 and length 10000
Creating 5 MTD partitions on &quot;bcm963xx&quot;:
0x00000000-0x00010000 : &quot;CFE&quot;
0x00010100-0x000cf305 : &quot;Kernel&quot;
mtd: partition &quot;Kernel&quot; doesn&#039;t start on an erase block boundary -- force read-o                                                                             nly
0x000d0000-0x001f0000 : &quot;Rootfs&quot;
0x001f0000-0x003f0000 : &quot;OpenWrt&quot;
0x003f0000-0x00400000 : &quot;NVRAM&quot;
TCP bic registered
NET: Registered protocol family 17
VFS: Mounted root (squashfs filesystem) readonly.
Freeing unused kernel memory: 120k freed
Please be patient, while OpenWrt loads ...
Algorithmics/MIPS FPU Emulator v1.5
Kernel panic - not syncing: Attempted to kill init!</code></pre></div>											<p class="post-edited">(Last edited by <strong>t3l3m4k0</strong> on 3 Nov 2008, 16:17)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p75818">
				<div class="post-metadata">
					<div class="post-num">Post #27</div>
					<div class="post-author">florian_</div>
					<div class="post-datetime">
						3 Nov 2008, 16:24					</div>
				</div>
				<div class="post-content content">
					<p>Could you guys report your dmesg&#039;s to the linux-mips mailing-list in reply to Maxime&#039;s patches. Subject is &quot;[PATCH/RFC v1 00/12] Support for Broadcom 63xx SOCs&quot;. Thank you very much !</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p75819">
				<div class="post-metadata">
					<div class="post-num">Post #28</div>
					<div class="post-author">nbd</div>
					<div class="post-datetime">
						3 Nov 2008, 16:29					</div>
				</div>
				<div class="post-content content">
					<p>this should take care of the mtd problem: <a href="http://nbd.name/brcm63xx-mtd.patch">http://nbd.name/brcm63xx-mtd.patch</a><br />please test and if it works, i&#039;ll commit it</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p75824">
				<div class="post-metadata">
					<div class="post-num">Post #29</div>
					<div class="post-author">lamaatje</div>
					<div class="post-datetime">
						3 Nov 2008, 19:17					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>florian_ wrote:</cite><blockquote><p>Could you guys report your dmesg&#039;s to the linux-mips mailing-list in reply to Maxime&#039;s patches. Subject is &quot;[PATCH/RFC v1 00/12] Support for Broadcom 63xx SOCs&quot;. Thank you very much !</p></blockquote></div><p>I am new here and trying to bring OpenWrt to dutch tele2 users. <br />My posts are about generating an OpenWrt image that is downloadable on an ancient version of CFE that is installed on DV201AMR and DV2020.<br />If there is a better location for these posts, please advise. TIA</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p75851">
				<div class="post-metadata">
					<div class="post-num">Post #30</div>
					<div class="post-author">t3l3m4k0</div>
					<div class="post-datetime">
						4 Nov 2008, 10:46					</div>
				</div>
				<div class="post-content content">
					<p>@ florian_<br />I take note.</p><p>@ nbd<br />Thx for your fast reponse.<br />I tried it but it crashes again. I can&#039;t post output because i tried to reconfigure CFE and now router are bricked.<br />Today i will try to recover with JTAG, other times i do it. After recover i try it again, capture log and post it.</p><br /><p>I have one question more, after applied patch, for first time i executed only &quot;make&quot;, and no changes are noticed. For second time i deleted build_dir and changes are commited. How i must compile to apply patch without delete build_dir?</p><p>Thanks in advanced.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p75853">
				<div class="post-metadata">
					<div class="post-num">Post #31</div>
					<div class="post-author">spirit</div>
					<div class="post-datetime">
						4 Nov 2008, 12:44					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>t3l3m4k0 wrote:</cite><blockquote><p>I tested. Loading goes away,&nbsp; but finaly it crashes.</p><p>Any idea would be apreciated.</p><p>log here:<br /></p><div class="codebox"><pre><code>CFE version 1.0.37-0.8 for BCM96348 (32bit,SP,BE)
Build Date: Â¥|  2Â¤Ã« 14 14:18:59 CST 2008 (root@Yau)
Copyright (C) 2000,2001,2002,2003 Broadcom Corporation.

Initializing Arena.
Initializing Devices.
CPU type 0x29107: 256MHz, Bus: 128MHz, Ref: 32MHz

Total memory used by CFE:  0x80401000 - 0x80524880 (1194112)
Initialized Data:          0x8041C810 - 0x8041E210 (6656)
BSS Area:                  0x8041E210 - 0x80422880 (18032)
Local Heap:                0x80422880 - 0x80522880 (1048576)
Stack Area:                0x80522880 - 0x80524880 (8192)
Text (code) segment:       0x80401000 - 0x8041C804 (112644)
Boot area (physical):      0x00525000 - 0x00565000
Relocation Factor:         I:00000000 - D:00000000

Board IP address                : 192.168.1.19:ffffff00
Host IP address                 : 192.168.1.21
Gateway IP address              : 192.168.1.1
Run from flash/host (f/h)       : f
Default host run file name      : vmlinux
Default host flash file name    : bcm963xx_fs_kernel
Boot delay (0-9 seconds)        : 2
Board Id Name                   : 96348GW
Psi size in KB                  : 24
Number of MAC Addresses (1-32)  : 10
Base MAC Address                : 11:22:33:44:55:60
Ethernet PHY Type               : Internal
Memory size in MB               : 16

*** Press any key to stop auto run (2 seconds) ***
Auto run second count down: 0
GPIOio_PIN_HIGH is Off
Code Address: 0x80010000, Entry Address: 0x80010000
Decompression OK!
Entry at 0x80010000
Closing network.
Starting program at 0x80010000
Linux version 2.6.27.4 (od1sea@1t4k4) (gcc version 3.4.6 (OpenWrt-2.0)) #3 Mon N                                                                             ov 3 14:25:37 CET 2008
Detected Broadcom 0x6348 CPU revision a2
CPU frequency is 256000000 MHz
16MB of RAM installed
board_bcm963xx: CFE version: 1.0.37-0.8
console [early0] enabled
CPU revision is: 00029107 (Broadcom BCM6348)
board_bcm963xx: board name: 96348GW
Determined physical RAM map:
 memory: 01000000 @ 00000000 (usable)
Initrd not found or empty - disabling initrd
Zone PFN ranges:
  Normal   0x00000000 -&gt; 0x00001000
Movable zone start PFN for each node
early_node_map[1] active PFN ranges
    0: 0x00000000 -&gt; 0x00001000
Built 1 zonelists in Zone order, mobility grouping off.  Total pages: 4064
Kernel command line: root=/dev/mtdblock2 rootfstype=squashfs,jffs2 init=/etc/pre                                                                             init noinitrd console=ttyS0,115200
Primary instruction cache 16kB, VIPT, 2-way, linesize 16 bytes.
Primary data cache 8kB, 2-way, VIPT, no aliases, linesize 16 bytes
PID hash table entries: 64 (order: 6, 256 bytes)
Dentry cache hash table entries: 2048 (order: 1, 8192 bytes)
Inode-cache hash table entries: 1024 (order: 0, 4096 bytes)
Memory: 13660k/16384k available (1914k kernel code, 2724k reserved, 339k data, 1                                                                             20k init, 0k highmem)
Calibrating delay loop... 255.48 BogoMIPS (lpj=510976)
Mount-cache hash table entries: 512
net_namespace: 592 bytes
NET: Registered protocol family 16
registering PCI controller with io_map_base unset
bus: 00 index 0 io port: [8000000, 800ffff]
bus: 00 index 1 mmio: [30000000, 37ffffff]
NET: Registered protocol family 2
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 512 (order: 0, 4096 bytes)
TCP bind hash table entries: 512 (order: -1, 2048 bytes)
TCP: Hash tables configured (established 512 bind 512)
TCP reno registered
NET: Registered protocol family 1
audit: initializing netlink socket (disabled)
type=2000 audit(0.265:1): initialized
squashfs: version 3.0 (2006/03/15) Phillip Lougher
Registering mini_fo version $Id$
JFFS2 version 2.2. (NAND) (SUMMARY)  Ã‚Â© 2001-2006 Red Hat, Inc.
msgmni has been set to 26
io scheduler noop registered
io scheduler cfq registered (default)
bcm63xx_uart.0: ttyS0 at MMIO 0xfffe0300 (irq = 10) is a bcm63xx_uart
console handover: boot [early0] -&gt; real [ttyS0]
bcm63xx_enet MII bus: probed
bcm963xx: 0x00400000 at 0x1fc00000
bcm963xx: Found 1 x16 devices at 0x0 in 16-bit bank
 Amd/Fujitsu Extended Query Table at 0x0040
number of CFI chips: 1
cfi_cmdset_0002: Disabling erase-suspend-program due to code brokenness.
bcm963xx: Read Signature value of CFE1CFE1
bcm963xx: CFE bootloader detected
bcm963xx: CFE boot tag found with version 6 and board type 96348GW.
bcm963xx: Partition 0 is CFE offset 0 and length 10000
bcm963xx: Partition 1 is Kernel offset 10100 and length bf205
bcm963xx: Partition 2 is Rootfs offset d0000 and length 120000
bcm963xx: Partition 3 is OpenWrt offset 1f0000 and length 200000
bcm963xx: Partition 4 is NVRAM offset 3f0000 and length 10000
Creating 5 MTD partitions on &quot;bcm963xx&quot;:
0x00000000-0x00010000 : &quot;CFE&quot;
0x00010100-0x000cf305 : &quot;Kernel&quot;
mtd: partition &quot;Kernel&quot; doesn&#039;t start on an erase block boundary -- force read-o                                                                             nly
0x000d0000-0x001f0000 : &quot;Rootfs&quot;
0x001f0000-0x003f0000 : &quot;OpenWrt&quot;
0x003f0000-0x00400000 : &quot;NVRAM&quot;
TCP bic registered
NET: Registered protocol family 17
VFS: Mounted root (squashfs filesystem) readonly.
Freeing unused kernel memory: 120k freed
Please be patient, while OpenWrt loads ...
Algorithmics/MIPS FPU Emulator v1.5
Kernel panic - not syncing: Attempted to kill init!</code></pre></div></blockquote></div><p>It seems, that your kernel panics quite at the end of the initialization at the final step before/at running the init process. The file system has already been mounted ... maybe init=/etc/preinit (see bootline) is invalid?!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p75893">
				<div class="post-metadata">
					<div class="post-num">Post #32</div>
					<div class="post-author">t3l3m4k0</div>
					<div class="post-datetime">
						5 Nov 2008, 00:54					</div>
				</div>
				<div class="post-content content">
					<p>Router recovered,&nbsp; other time.<br />here results after patch applied. Seem it can&#039;t mount rootfs</p><br /><div class="codebox"><pre><code>CFE version 1.0.37-0.8 for BCM96348 (32bit,SP,BE)
Build Date: Â¤@  2Â¤Ã« 20 18:37:34 CST 2006 (root@localhost.localdomain)
Copyright (C) 2000,2001,2002,2003 Broadcom Corporation.

Initializing Arena.
Initializing Devices.
CPU type 0x29107: 256MHz, Bus: 128MHz, Ref: 32MHz

Total memory used by CFE:  0x80401000 - 0x805246F0 (1193712)
Initialized Data:          0x8041C680 - 0x8041E080 (6656)
BSS Area:                  0x8041E080 - 0x804226F0 (18032)
Local Heap:                0x804226F0 - 0x805226F0 (1048576)
Stack Area:                0x805226F0 - 0x805246F0 (8192)
Text (code) segment:       0x80401000 - 0x8041C67C (112252)
Boot area (physical):      0x00525000 - 0x00565000
Relocation Factor:         I:00000000 - D:00000000

Board IP address                : 192.168.1.19:ffffff00
Host IP address                 : 192.168.1.21
Gateway IP address              :
Run from flash/host (f/h)       : f
Default host run file name      : vmlinux
Default host flash file name    : bcm963xx_fs_kernel
Boot delay (0-9 seconds)        : 2
Board Id Name                   : 96348GW
Psi size in KB                  : 24
Number of MAC Addresses (1-32)  : 11
Base MAC Address                : 11:22:33:44:55:66
Ethernet PHY Type               : Internal
Memory size in MB               : 16

*** Press any key to stop auto run (2 seconds) ***
Auto run second count down: 0
GPIOio_PIN_HIGH is Off
Code Address: 0x80010000, Entry Address: 0x80010000
Decompression OK!
Entry at 0x80010000
Closing network.
Starting program at 0x80010000
Linux version 2.6.27.4 (od1sea@1t4k4) (gcc version 3.4.6 (OpenWrt-2.0)) #2 Tue Nov 4 21:22:02 CET 2008
Detected Broadcom 0x6348 CPU revision a2
CPU frequency is 256000000 MHz
16MB of RAM installed
board_bcm963xx: CFE version: 1.0.37-0.8
console [early0] enabled
CPU revision is: 00029107 (Broadcom BCM6348)
board_bcm963xx: board name: 96348GW
Determined physical RAM map:
 memory: 01000000 @ 00000000 (usable)
Initrd not found or empty - disabling initrd
Zone PFN ranges:
  Normal   0x00000000 -&gt; 0x00001000
Movable zone start PFN for each node
early_node_map[1] active PFN ranges
    0: 0x00000000 -&gt; 0x00001000
Built 1 zonelists in Zone order, mobility grouping off.  Total pages: 4064
Kernel command line: root=/dev/mtdblock2 rootfstype=squashfs,jffs2 init=/etc/preinit noinitrd console=ttyS0,115200
Primary instruction cache 16kB, VIPT, 2-way, linesize 16 bytes.
Primary data cache 8kB, 2-way, VIPT, no aliases, linesize 16 bytes
PID hash table entries: 64 (order: 6, 256 bytes)
Dentry cache hash table entries: 2048 (order: 1, 8192 bytes)
Inode-cache hash table entries: 1024 (order: 0, 4096 bytes)
Memory: 13660k/16384k available (1914k kernel code, 2724k reserved, 339k data, 120k init, 0k highmem)
Calibrating delay loop... 255.48 BogoMIPS (lpj=510976)
Mount-cache hash table entries: 512
net_namespace: 592 bytes
NET: Registered protocol family 16
registering PCI controller with io_map_base unset
bus: 00 index 0 io port: [8000000, 800ffff]
bus: 00 index 1 mmio: [30000000, 37ffffff]
NET: Registered protocol family 2
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 512 (order: 0, 4096 bytes)
TCP bind hash table entries: 512 (order: -1, 2048 bytes)
TCP: Hash tables configured (established 512 bind 512)
TCP reno registered
NET: Registered protocol family 1
audit: initializing netlink socket (disabled)
type=2000 audit(0.265:1): initialized
squashfs: version 3.0 (2006/03/15) Phillip Lougher
Registering mini_fo version $Id$
JFFS2 version 2.2. (NAND) (SUMMARY)  Ã‚Â© 2001-2006 Red Hat, Inc.
msgmni has been set to 26
io scheduler noop registered
io scheduler cfq registered (default)
bcm63xx_uart.0: ttyS0 at MMIO 0xfffe0300 (irq = 10) is a bcm63xx_uart
console handover: boot [early0] -&gt; real [ttyS0]
bcm63xx_enet MII bus: probed
bcm963xx: 0x00400000 at 0x1fc00000
bcm963xx: Found 1 x16 devices at 0x0 in 16-bit bank
 Amd/Fujitsu Extended Query Table at 0x0040
number of CFI chips: 1
cfi_cmdset_0002: Disabling erase-suspend-program due to code brokenness.
bcm963xx: Read Signature value of CFE1CFE1
bcm963xx: CFE bootloader detected
bcm963xx: CFE boot tag found with version 6 and board type 96348GW-11.
bcm963xx: Partition 0 is CFE offset 0 and length 10000
bcm963xx: Partition 1 is kernel offset 10100 and length bf175
bcm963xx: Partition 2 is rootfs offset d0000 and length 320000
bcm963xx: Partition 3 is nvram offset 3f0000 and length 10000
bcm963xx: Partition 4 is &lt;NULL&gt; offset 0 and length 0
Creating 5 MTD partitions on &quot;bcm963xx&quot;:
0x00000000-0x00010000 : &quot;CFE&quot;
0x00010100-0x000cf275 : &quot;kernel&quot;
mtd: partition &quot;kernel&quot; doesn&#039;t start on an erase block boundary -- force read-only
0x000d0000-0x003f0000 : &quot;rootfs&quot;
mtd: partition &quot;rootfs&quot; set to be root filesystem
mtd: partition &quot;rootfs_data&quot; created automatically, ofs=260000, len=190000
0x00260000-0x003f0000 : &quot;rootfs_data&quot;
0x003f0000-0x00400000 : &quot;nvram&quot;
0x00000000-0x00400000 : &quot;&lt;NULL&gt;&quot;
CPU 0 Unable to handle kernel paging request at virtual address 00000000, epc == 80154394, ra == 80154374
Oops[#1]:
Cpu 0
$ 0   : 00000000 10008400 8020a4c0 00000000
$ 4   : 8023d810 00000000 802132a0 ffff00fe
$ 8   : 802c3fe0 00008400 00000000 802d2000
$12   : 00000000 003ff004 00000000 00008000
$16   : 803b2b80 803127f0 00000006 80260000
$20   : 00000004 00000005 80327280 00000000
$24   : 802699a8 80020000
$28   : 802c2000 802c3ea0 00000000 80154374
Hi    : 00000130
Lo    : 00000130
epc   : 80154394 0x80154394
    Not tainted
ra    : 80154374 0x80154374
Status: 10008403    KERNEL EXL IE
Cause : 00800008
BadVA : 00000000
PrId  : 00029107 (Broadcom BCM6348)
Modules linked in:
Process swapper (pid: 1, threadinfo=802c2000, task=802c18e8, tls=00000000)
Stack : 00190000 00000000 802132a0 ffff00fe 80280000 00000000 80280000 80240000
        80252708 00000000 00000000 8025288c 802f14e8 00000001 00000001 00000000
        00000008 802c3ef8 802c3ef8 80280000 43464531 43464531 00000008 802525b8
        80260168 8025ffc0 80260000 80260000 8001ae04 8001ae04 8023a008 0000007f
        802080b8 00000000 00000122 0000007f 002e8f00 0000007f 80270000 800d4894
        ...
Call Trace:[&lt;80252708&gt;] 0x80252708
[&lt;8025288c&gt;] 0x8025288c
[&lt;802525b8&gt;] 0x802525b8
[&lt;8001ae04&gt;] 0x8001ae04
[&lt;8001ae04&gt;] 0x8001ae04
[&lt;800d4894&gt;] 0x800d4894
[&lt;800d44ec&gt;] 0x800d44ec
[&lt;8006b870&gt;] 0x8006b870
[&lt;802449e8&gt;] 0x802449e8
[&lt;802449cc&gt;] 0x802449cc
[&lt;8001d2f0&gt;] 0x8001d2f0
[&lt;8001d2e0&gt;] 0x8001d2e0


Code: 3c028021  2442a4c0  8e230000 &lt;90640000&gt; 90410000  24630001  14240004  24420001  1480fffb
Kernel panic - not syncing: Attempted to kill init!</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p75895">
				<div class="post-metadata">
					<div class="post-num">Post #33</div>
					<div class="post-author">nbd</div>
					<div class="post-datetime">
						5 Nov 2008, 01:29					</div>
				</div>
				<div class="post-content content">
					<p>Here is the updated version which should fix the null pointer dereference: <a href="http://nbd.name/brcm63xx-mtd.2.patch">http://nbd.name/brcm63xx-mtd.2.patch</a><br />Please revert the previous patch, apply this one, then test.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p75896">
				<div class="post-metadata">
					<div class="post-num">Post #34</div>
					<div class="post-author">t3l3m4k0</div>
					<div class="post-datetime">
						5 Nov 2008, 01:38					</div>
				</div>
				<div class="post-content content">
					<p>sir,<br />you are fast, fast, fast</p><p>i wil try tomorow.</p><p>thanks, thanks, thanks.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p75913">
				<div class="post-metadata">
					<div class="post-num">Post #35</div>
					<div class="post-author">AndreyPopov</div>
					<div class="post-datetime">
						5 Nov 2008, 14:53					</div>
				</div>
				<div class="post-content content">
					<p>anybody can post link to already compiled image?<br />and I test.</p><p>I&#039;m not have installed any Linux version to try make image. I only have windows and routers.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p75918">
				<div class="post-metadata">
					<div class="post-num">Post #36</div>
					<div class="post-author">t3l3m4k0</div>
					<div class="post-datetime">
						5 Nov 2008, 15:34					</div>
				</div>
				<div class="post-content content">
					<p>@AndreyPopov,<br />you must install anything that can run linux</p><br /><p>@nbd<br />still does not seem right</p><p>many thanks</p><div class="codebox"><pre><code>CFE version 1.0.37-0.8 for BCM96348 (32bit,SP,BE)
Build Date: Â¤@  2Â¤Ã« 20 18:37:34 CST 2006 (root@localhost.localdomain)
Copyright (C) 2000,2001,2002,2003 Broadcom Corporation.

Initializing Arena.
Initializing Devices.
CPU type 0x29107: 256MHz, Bus: 128MHz, Ref: 32MHz

Total memory used by CFE:  0x80401000 - 0x805246F0 (1193712)
Initialized Data:          0x8041C680 - 0x8041E080 (6656)
BSS Area:                  0x8041E080 - 0x804226F0 (18032)
Local Heap:                0x804226F0 - 0x805226F0 (1048576)
Stack Area:                0x805226F0 - 0x805246F0 (8192)
Text (code) segment:       0x80401000 - 0x8041C67C (112252)
Boot area (physical):      0x00525000 - 0x00565000
Relocation Factor:         I:00000000 - D:00000000

Board IP address                : 192.168.1.19:ffffff00
Host IP address                 : 192.168.1.21
Gateway IP address              :
Run from flash/host (f/h)       : f
Default host run file name      : vmlinux
Default host flash file name    : bcm963xx_fs_kernel
Boot delay (0-9 seconds)        : 2
Board Id Name                   : 96348GW
Psi size in KB                  : 24
Number of MAC Addresses (1-32)  : 11
Base MAC Address                : 11:22:33:44:55:66
Ethernet PHY Type               : Internal
Memory size in MB               : 16

*** Press any key to stop auto run (2 seconds) ***
Auto run second count down: 0
GPIOio_PIN_HIGH is Off
Code Address: 0x80010000, Entry Address: 0x80010000
Decompression OK!
Entry at 0x80010000
Closing network.
Starting program at 0x80010000
Linux version 2.6.27.4 (od1sea@1t4k4) (gcc version 3.4.6 (OpenWrt-2.0)) #1 Wed Nov 5 08:04:37 CET 2008
Detected Broadcom 0x6348 CPU revision a2
CPU frequency is 256000000 MHz
16MB of RAM installed
board_bcm963xx: CFE version: 1.0.37-0.8
console [early0] enabled
CPU revision is: 00029107 (Broadcom BCM6348)
board_bcm963xx: board name: 96348GW
Determined physical RAM map:
 memory: 01000000 @ 00000000 (usable)
Initrd not found or empty - disabling initrd
Zone PFN ranges:
  Normal   0x00000000 -&gt; 0x00001000
Movable zone start PFN for each node
early_node_map[1] active PFN ranges
    0: 0x00000000 -&gt; 0x00001000
Built 1 zonelists in Zone order, mobility grouping off.  Total pages: 4064
Kernel command line: root=/dev/mtdblock2 rootfstype=squashfs,jffs2 init=/etc/preinit noinitrd console=ttyS0,115200
Primary instruction cache 16kB, VIPT, 2-way, linesize 16 bytes.
Primary data cache 8kB, 2-way, VIPT, no aliases, linesize 16 bytes
PID hash table entries: 64 (order: 6, 256 bytes)
Dentry cache hash table entries: 2048 (order: 1, 8192 bytes)
Inode-cache hash table entries: 1024 (order: 0, 4096 bytes)
Memory: 13660k/16384k available (1914k kernel code, 2724k reserved, 339k data, 120k init, 0k highmem)
Calibrating delay loop... 255.48 BogoMIPS (lpj=510976)
Mount-cache hash table entries: 512
net_namespace: 592 bytes
NET: Registered protocol family 16
registering PCI controller with io_map_base unset
bus: 00 index 0 io port: [8000000, 800ffff]
bus: 00 index 1 mmio: [30000000, 37ffffff]
NET: Registered protocol family 2
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 512 (order: 0, 4096 bytes)
TCP bind hash table entries: 512 (order: -1, 2048 bytes)
TCP: Hash tables configured (established 512 bind 512)
TCP reno registered
NET: Registered protocol family 1
audit: initializing netlink socket (disabled)
type=2000 audit(0.265:1): initialized
squashfs: version 3.0 (2006/03/15) Phillip Lougher
Registering mini_fo version $Id$
JFFS2 version 2.2. (NAND) (SUMMARY)  Ã‚Â© 2001-2006 Red Hat, Inc.
msgmni has been set to 26
io scheduler noop registered
io scheduler cfq registered (default)
bcm63xx_uart.0: ttyS0 at MMIO 0xfffe0300 (irq = 10) is a bcm63xx_uart
console handover: boot [early0] -&gt; real [ttyS0]
bcm63xx_enet MII bus: probed
bcm963xx: 0x00400000 at 0x1fc00000
bcm963xx: Found 1 x16 devices at 0x0 in 16-bit bank
 Amd/Fujitsu Extended Query Table at 0x0040
number of CFI chips: 1
cfi_cmdset_0002: Disabling erase-suspend-program due to code brokenness.
bcm963xx: Read Signature value of CFE1CFE1
bcm963xx: CFE bootloader detected
bcm963xx: CFE boot tag found with version 6 and board type 96348GW-11.
bcm963xx: Partition 0 is CFE offset 0 and length 10000
bcm963xx: Partition 1 is kernel offset 10100 and length bf1cf
bcm963xx: Partition 2 is rootfs offset d0000 and length 320000
bcm963xx: Partition 3 is nvram offset 3f0000 and length 10000
Creating 4 MTD partitions on &quot;bcm963xx&quot;:
0x00000000-0x00010000 : &quot;CFE&quot;
0x00010100-0x000cf2cf : &quot;kernel&quot;
mtd: partition &quot;kernel&quot; doesn&#039;t start on an erase block boundary -- force read-only
0x000d0000-0x003f0000 : &quot;rootfs&quot;
mtd: partition &quot;rootfs&quot; set to be root filesystem
mtd: partition &quot;rootfs_data&quot; created automatically, ofs=260000, len=190000
0x00260000-0x003f0000 : &quot;rootfs_data&quot;
0x003f0000-0x00400000 : &quot;nvram&quot;
TCP bic registered
NET: Registered protocol family 17
VFS: Mounted root (squashfs filesystem) readonly.
Freeing unused kernel memory: 120k freed
Please be patient, while OpenWrt loads ...
Algorithmics/MIPS FPU Emulator v1.5
Kernel panic - not syncing: Attempted to kill init!</code></pre></div>											<p class="post-edited">(Last edited by <strong>t3l3m4k0</strong> on 5 Nov 2008, 15:37)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p75921">
				<div class="post-metadata">
					<div class="post-num">Post #37</div>
					<div class="post-author">lamaatje</div>
					<div class="post-datetime">
						5 Nov 2008, 17:19					</div>
				</div>
				<div class="post-content content">
					<p>I got things running on my davolink DV201AMR/DV2020 with ancient CFE:</p><div class="codebox"><pre><code>ntry at 0x80014450                  
Closing n        
Starting program at 0x80014450                              
Linux version 2.6.27.4 (stefan@hobbydebian) (gcc version 4.1.2) #4 Wed Nov 5 018                                                                                
Detected Broadcom 0x6348 CPU revision b0                                        
CPU frequency is 256000000 MHz                              
16MB of RAM installed                    
board_bcm963xx: CFE version: 1.0.37-0.6                                      
console [early0] enabled                        
CPU revision is: 00029107 (Broadcom BCM6348)                                            
board_bcm963xx: board name: DV201AMR                                    
Determined physical RAM map:                            
memory: 01000000 @ 00000000 (usable)                                    
Initrd not found or empty - disabling initrd                                            
Zone PFN ranges:                
  Normal   0x00000000 -&gt; 0x00001000                                  
Movable zone start PFN for each node                                    
early_node_map[1] active PFN ranges                                  
    0: 0x00000000 -&gt; 0x00001000                              
Built 1 zonelists in Zone order, mobility grouping off.  Total pages: 4064                                                                          
Kernel command line: root=/dev/mtdblock1 rootfstype=squashfs,jffs2 init=/etc/pr0                                                                                
Primary instruction cache 16kB, VIPT, 2-way, linesize 16 bytes.                                                              
Primary data cache 8kB, 2-way, VIPT, no aliases, linesize 16 bytes                                                                  
PID hash table entries: 64 (order: 6, 256 bytes)                                                
Dentry cache hash table entries: 2048 (order: 1, 8192 bytes)                                                            
Inode-cache hash table entries: 1024 (order: 0, 4096 bytes)                                                          
Memory: 13736k/16384k available (1857k kernel code, 2648k reserved, 320k data, )                                                                                
Calibrating delay loop... 255.48 BogoMIPS (lpj=510976)                                                      
Mount-cache hash table entries: 512                                  
net_namespace: 592 bytes                        
NET: Registered protocol family 16                                  
registering PCI controller with io_map_base unset                                                
bus: 00 index 0 io port: [8000000, 800ffff]                                          
bus: 00 index 1 mmio: [30000000, 37ffffff]                                          
NET: Registered protocol family 2                                
IP route cache hash table entries: 1024 (order: 0, 409                                                    
TCP established hash table entries: 512 (order: 0, 4096 bytes)                                                              
TCP bind hash table entries: 512 (order: -1, 2048 bytes)                                                        
TCP: Hash tables configured (established 512 bind 512)                                                      
TCP reno registered                  
NET: Registered protocol family 1                                
audit: initializing netlink socket (disabled)                                            
type=2000 audit(0.273:1): initialized                                    
squashfs: version 3.0 (2006/03/15) Phillip Lougher                                                  
Registering mini_fo version $Id$                                
JFFS2 version 2.2. (NAND) (SUMMARY)  Ã‚Â© 2001-2006 Red Hat, Inc.                                                              
msgmni has been set to 26                        
io scheduler noop registered                            
io scheduler cfq registered (default)                                    
bcm63xx_uart.0: ttyS0 at MMIO 0xfffe0300 (irq = 10) is a bcm63xx_uart                                                                    
console handover: boot [early0] -&gt; real [ttyS0]                                              
bcm63xx_enet MII bus: probed                            
bcm963xx: 0x00400000 at 0x1fc00000                                  
bcm963xx: Found 1 x16 devices at 0x0 in 16-bit bank                                                  
NOR chip too large to fit in mapping. Attempting to cope...                                                          
Amd/Fujitsu Extended Query Table at 0x0040                                          
number of CFI chips: 1                      
cfi_cmdset_0002: Disabling erase-suspend-program due to code brokenness.                                                                        
Reducing visibility of 8192KiB chip to 4096Ki                                            
bcm963xx: Read Signature value of CFE1CFE1                                          
bcm963xx: CFE bootloader detected                                
bcm963xx: CFE boot tag found with version 6 and board type DV201AMR.                                                                    
lamadbg: rootA 3217096960 | rootL 1259776 | kernelA 3218356736 | kernelL 761855                                                                              
bcm963xx: Partition 0 is CFE offset 0 and length 10000                                                      
bcm963xx: Partition 1 is Rootfs+Kernel offset 20000 and length 1f0000                                                                    
bcm963xx: Partition 2 is OpenWrt offset 200000 and length 1f0000                                                                
bcm963xx: Partition 3 is NVRAM offset 3f0000 and length 10000                                                            
Creating 4 MTD partitions on &quot;bcm963xx                                    
0x00000000-0x00010000 : &quot;CFE&quot;                            
0x00020000-0x00210000 : &quot;Rootfs+Kernel&quot;                                      
0x00200000-0x003f0000 : &quot;OpenWrt&quot;                                
0x003f0000-0x00400000 : &quot;NVRAM&quot;                              
TCP bic registered                  
NET: Registered protocol family 17                                  
VFS: Mounted root (squashfs filesystem) readonly.                                                
Freeing unused kernel memory: 120k freed                                        
Please be patient, while OpenWrt loads ...                                          
Algorithmics/MIPS FPU Emulator v1.5                                  
- preinit -          
Press CTRL-C for failsafe                        
- init -        

Please press Enter to activate this console. br-lan: Dropping NETIF_F_UFO since.                                                                                
device eth0 entered promiscuous                            
device eth0 left promiscuous mode                                
device eth0 entered promiscuous mode                                    
device eth0 left promiscuous mode                                
ieee80211: 802.11 data/management/control stack, git-1.1.13                    
ieee80211: Copyright (C) 2004-2005 Intel Corporation &lt;jketreno@linux.intel.com&gt;
PPP generic driver version 2.4.2
ip_tables: (C) 2000-2006 Netfilter Core Team
nf_conntrack version 0.5.0 (1024 buckets, 4096 max)
CONFIG_NF_CT_ACCT is deprecated and will be removed soon. Plase use
nf_conntrack.acct=1 kernel paramater, acct=1 nf_conntrack module option or
sysctl net.netfilter.nf_conntrack_acct=1 to enable it.



BusyBox v1.11.2 (2008-11-05 00:05:25 CET) built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
|       |.-----.-----.-----.|  |  |  |.----.|  |_
|   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
|_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
KAMIKAZE (bleeding edge, r13097) -------------------
  * 10 oz Vodka       Shake well with ice and strain
  * 10 oz Triple sec  mixture into 10 shot glasses.
  * 10 oz lime juice  Salute!
---------------------------------------------------
root@OpenWrt:/#</code></pre></div><p>Did some modifications but code in bcm963xx-flash.c should be rewritten imho.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p75923">
				<div class="post-metadata">
					<div class="post-num">Post #38</div>
					<div class="post-author">t3l3m4k0</div>
					<div class="post-datetime">
						5 Nov 2008, 17:42					</div>
				</div>
				<div class="post-content content">
					<p>@lamaatje</p><p>Congratulations.</p><p>Please,</p><p>can you explain something about your work?<br />changes in bcm963xx-flash.c&nbsp; and others files?<br />how you has loaded firmware?</p><p>nice dmesg.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p75924">
				<div class="post-metadata">
					<div class="post-num">Post #39</div>
					<div class="post-author">nbd</div>
					<div class="post-datetime">
						5 Nov 2008, 17:51					</div>
				</div>
				<div class="post-content content">
					<p>@t3l3m4k0: Actually the mtd part seems right now. It successfully mounted the rootfs. Your user space is crashing, did you make any changes to the package selection?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p75925">
				<div class="post-metadata">
					<div class="post-num">Post #40</div>
					<div class="post-author">nbd</div>
					<div class="post-datetime">
						5 Nov 2008, 17:52					</div>
				</div>
				<div class="post-content content">
					<p>@lamaatje: your flash map changes don&#039;t seem right to me (judging from the dmesg). The rootfs partition always needs to be called &#039;rootfs&#039; and the flash map driver is not supposed to create the overlay partition itself (that is already done by a generic kernel patch)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p75927">
				<div class="post-metadata">
					<div class="post-num">Post #41</div>
					<div class="post-author">t3l3m4k0</div>
					<div class="post-datetime">
						5 Nov 2008, 18:07					</div>
				</div>
				<div class="post-content content">
					<p>@nbd</p><p>i made changes in package selection.<br />i will restart from zero.</p><br /><p>thnks</p><p>pd:</p><p>i see some changes in lamaatge dmesg<br /></p><div class="codebox"><pre><code>Kernel command line: root=/dev/mtdblock1 rootfstype=squashfs,jffs2 init=/etc/pr0</code></pre></div>											<p class="post-edited">(Last edited by <strong>t3l3m4k0</strong> on 5 Nov 2008, 18:09)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p75941">
				<div class="post-metadata">
					<div class="post-num">Post #42</div>
					<div class="post-author">lamaatje</div>
					<div class="post-datetime">
						5 Nov 2008, 22:34					</div>
				</div>
				<div class="post-content content">
					<p>@t3l3m4k0&nbsp; &nbsp;what is needed for the kernel is an access location in the flash where the rootfs starts. Access to the flash is done via an mtdblockdevice. So the trick of getting a rfs mounted is creating a suitable partition. Since CFE determines where kernel and rfs are located during flashing the whole concept of partitioning in bcm963xx-flash.c seems useless to me, since CFE header+rfs+kernel are contigous in flash always directly after CFE. I discovered that mtdblockdevices have problems with eraseblock alignment so I tweaked the flashimage a little such that the total image is eraseblock aligned, theoretical for read access this is not a requirement but in practice there are problems. <br />mtdblock1 is defined in such a way that it contains the start of rfs. <br />There are also bugs:<br /></p><div class="codebox"><pre><code> 
static int bcm963xx_detect_cfe(struct mtd_info *master)
{
       int idoffset = 0x4e0;
       static char idstring[8] = &quot;CFE1CFE1&quot;;
       char buf[8];
       int ret;
       size_t retlen;

       ret = master-&gt;read(master, idoffset, 8, &amp;retlen, (void *)buf);
       printk(&quot;bcm963xx: Read Signature value of %s\n&quot;, buf);
       return strcmp(idstring,buf);
}</code></pre></div><p>non zero terminated strings are compared.</p><p>@nbd&nbsp; overlay partition, please explain?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p75948">
				<div class="post-metadata">
					<div class="post-num">Post #43</div>
					<div class="post-author">t3l3m4k0</div>
					<div class="post-datetime">
						6 Nov 2008, 01:33					</div>
				</div>
				<div class="post-content content">
					<p>@lamaatje,<br />Thanks for your reply. I understand your concept but it is over my little knoledge.</p><p>@nbd<br />I&#039;m recompiling from zero to reflash router, if it fails i must wait for some improvements, thanks for your aid.</p><p>that is i do to compile:<br /></p><div class="codebox"><pre><code>uname -a

Linux 1t4k4 2.6.22.14-72.fc6 #1 SMP Wed Nov 21 15:12:59 EST 2007 i686 athlon i386 GNU/Linux

cd /

mkdir /openwrt

cd openwrt

svn co https://svn.openwrt.org/openwrt/trunk/

cd /openwrt/trunk/target/linux/brcm63xx/files/drivers/mtd/maps/

wget http://nbd.name/brcm63xx-mtd.2.patch

patch -b bcm963xx-flash.c brcm63xx-mtd.2.patch

cd /openwrt/trunk/target/linux/brcm63xx/image/

vi Makefile

# after
    # Neufbox4
    $(call Image/Build/CFE,$(1),96358VW,6358)
# added targets to Makefile 
    # Comtrend
    $(call Image/Build/CFE,$(1),96348GW,6348)
    $(call Image/Build/CFE,$(1),96348GW-10,6348-10)
    $(call Image/Build/CFE,$(1),96348GW-11,6348-11)
    $(call Image/Build/CFE,$(1),96348GW-11,6348)


cd /openwrt/trunk/

make menuconfig

    [*] Advanced configuration options (for developers)  ---&gt; 
        [*]   Show broken platforms / packages
        Target System (Broadcom BCM63xx [2.6])  ---&gt; 
         (X) Broadcom BCM63xx [2.6] 
    [*]image configuration
        ---Imageconfiguration
        (192.168.1.1) LAN DNS server
        (static) LAN Protoco (NEW)
        (192.168.1.1) LAN Gateway
        (255.255.255.0) LAN Network Mask (NEW)
        (192.168.1.19) LAN IP Address (NEW)

make V=99</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p75949">
				<div class="post-metadata">
					<div class="post-num">Post #44</div>
					<div class="post-author">lamaatje</div>
					<div class="post-datetime">
						6 Nov 2008, 02:29					</div>
				</div>
				<div class="post-content content">
					<p>Get it also to work having image end-address erase block aligned:</p><div class="codebox"><pre><code>bcm963xx: Read Signature value of CFE1CFE1
bcm963xx: CFE bootloader detected
bcm963xx: CFE boot tag found with version 6 and board type DV201AMR.
bcm963xx: Partition 0 is CFE offset 0 and length 10000
bcm963xx: Partition 1 is Rootfs+Kernel offset 10100 and length 1dff00
bcm963xx: Partition 2 is OpenWrt offset 1f0000 and length 200000
bcm963xx: Partition 3 is NVRAM offset 3f0000 and length 10000
Creating 4 MTD partitions on &quot;bcm963xx&quot;:
0x00000000-0x00010000 : &quot;CFE&quot;
0x00010100-0x001f0000 : &quot;Rootfs+Kernel&quot;
mtd: partition &quot;Rootfs+Kernel&quot; doesn&#039;t start on an erase block boundary -- force read-only
0x001f0000-0x003f0000 : &quot;OpenWrt&quot;
0x003f0000-0x00400000 : &quot;NVRAM&quot;</code></pre></div><p>@t3l3m4k0 noted your compiler version may be old for such a new kernel&nbsp; gcc version 3.4.6 (OpenWrt-2.0), it is not the trunk version!</p><p>@@nbd&nbsp; how do I add boardsupport for my DV201AMR / DV2020&nbsp; in kernel config:</p><p>Machine selection&nbsp; ---&gt;<br />Board support (Generic Broadcom 963xx boards)&nbsp; ---&gt;<br />&nbsp; &nbsp; &nbsp;â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ï¿½ï¿½&nbsp; â”‚<br />&nbsp; &nbsp; &nbsp;â”‚ â”‚&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(X) Generic Broadcom 963xx boards&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; â”‚ â”‚<br />&nbsp; &nbsp; &nbsp;â”‚ â”‚&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;( ) Inventel Livebox(es) boards&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; â”‚</p><p>making it a selectable option like above</p>											<p class="post-edited">(Last edited by <strong>lamaatje</strong> on 6 Nov 2008, 02:50)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p75969">
				<div class="post-metadata">
					<div class="post-num">Post #45</div>
					<div class="post-author">t3l3m4k0</div>
					<div class="post-datetime">
						6 Nov 2008, 12:10					</div>
				</div>
				<div class="post-content content">
					<p>@lamaatje, thx i updated gcc. Good work.<br />@nbd</p><p>from zero, seem something in mtd drivers has changed, no partitions detected.<br /></p><div class="codebox"><pre><code>CFE version 1.0.37-0.8 for BCM96348 (32bit,SP,BE)
Build Date: Â¤@  2Â¤Ã« 20 18:37:34 CST 2006 (root@localhost.localdomain)
Copyright (C) 2000,2001,2002,2003 Broadcom Corporation.

Initializing Arena.
Initializing Devices.
CPU type 0x29107: 256MHz, Bus: 128MHz, Ref: 32MHz

Total memory used by CFE:  0x80401000 - 0x805246F0 (1193712)
Initialized Data:          0x8041C680 - 0x8041E080 (6656)
BSS Area:                  0x8041E080 - 0x804226F0 (18032)
Local Heap:                0x804226F0 - 0x805226F0 (1048576)
Stack Area:                0x805226F0 - 0x805246F0 (8192)
Text (code) segment:       0x80401000 - 0x8041C67C (112252)
Boot area (physical):      0x00525000 - 0x00565000
Relocation Factor:         I:00000000 - D:00000000

Board IP address                : 192.168.1.19:ffffff00
Host IP address                 : 192.168.1.21
Gateway IP address              :
Run from flash/host (f/h)       : f
Default host run file name      : vmlinux
Default host flash file name    : bcm963xx_fs_kernel
Boot delay (0-9 seconds)        : 2
Board Id Name                   : 96348GW
Psi size in KB                  : 24
Number of MAC Addresses (1-32)  : 11
Base MAC Address                : 11:22:33:44:55:66
Ethernet PHY Type               : Internal
Memory size in MB               : 16

*** Press any key to stop auto run (2 seconds) ***
Auto run second count down: 0
GPIOio_PIN_HIGH is Off
Code Address: 0x80010000, Entry Address: 0x80010000
Decompression OK!
Entry at 0x80010000
Closing network.
Starting program at 0x80010000
Linux version 2.6.27.4 (od1sea@1t4k4) (gcc version 4.1.2) #3 Thu Nov 6 09:39:01 CET 2008
Detected Broadcom 0x6348 CPU revision a2
CPU frequency is 256000000 MHz
16MB of RAM installed
board_bcm963xx: CFE version: 1.0.37-0.8
console [early0] enabled
CPU revision is: 00029107 (Broadcom BCM6348)
board_bcm963xx: board name: 96348GW
Determined physical RAM map:
 memory: 01000000 @ 00000000 (usable)
Initrd not found or empty - disabling initrd
Zone PFN ranges:
  Normal   0x00000000 -&gt; 0x00001000
Movable zone start PFN for each node
early_node_map[1] active PFN ranges
    0: 0x00000000 -&gt; 0x00001000
Built 1 zonelists in Zone order, mobility grouping off.  Total pages: 4064
Kernel command line: root=/dev/mtdblock2 rootfstype=squashfs,jffs2 init=/etc/preinit noinitrd console=ttyS0,115200
Primary instruction cache 16kB, VIPT, 2-way, linesize 16 bytes.
Primary data cache 8kB, 2-way, VIPT, no aliases, linesize 16 bytes
PID hash table entries: 64 (order: 6, 256 bytes)
Dentry cache hash table entries: 2048 (order: 1, 8192 bytes)
Inode-cache hash table entries: 1024 (order: 0, 4096 bytes)
Memory: 13736k/16384k available (1860k kernel code, 2648k reserved, 317k data, 120k init, 0k highmem)
Calibrating delay loop... 255.48 BogoMIPS (lpj=510976)
Mount-cache hash table entries: 512
net_namespace: 592 bytes
NET: Registered protocol family 16
registering PCI controller with io_map_base unset
bus: 00 index 0 io port: [8000000, 800ffff]
bus: 00 index 1 mmio: [30000000, 37ffffff]
NET: Registered protocol family 2
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 512 (order: 0, 4096 bytes)
TCP bind hash table entries: 512 (order: -1, 2048 bytes)
TCP: Hash tables configured (established 512 bind 512)
TCP reno registered
NET: Registered protocol family 1
audit: initializing netlink socket (disabled)
type=2000 audit(0.265:1): initialized
squashfs: version 3.0 (2006/03/15) Phillip Lougher
Registering mini_fo version $Id$
JFFS2 version 2.2. (NAND) (SUMMARY)  Ã‚Â© 2001-2006 Red Hat, Inc.
msgmni has been set to 26
io scheduler noop registered
io scheduler cfq registered (default)
bcm63xx_uart.0: ttyS0 at MMIO 0xfffe0300 (irq = 10) is a bcm63xx_uart
console handover: boot [early0] -&gt; real [ttyS0]
bcm63xx_enet MII bus: probed
bcm963xx: 0x00400000 at 0x1fc00000
bcm963xx: Found 1 x16 devices at 0x0 in 16-bit bank
 Amd/Fujitsu Extended Query Table at 0x0040
number of CFI chips: 1
cfi_cmdset_0002: Disabling erase-suspend-program due to code brokenness.
bcm963xx: Read Signature value of CFE1CFE1$ÃŽ0$Ã Ãœ$ÃŽ0
Searching for RedBoot partition table in bcm963xx at offset 0x3f0000
No RedBoot partition table detected in bcm963xx
Creating 0 MTD partitions on &quot;bcm963xx&quot;:
TCP bic registered
NET: Registered protocol family 17
VFS: Cannot open root device &quot;mtdblock2&quot; or unknown-block(0,0)
Please append a correct &quot;root=&quot; boot option; here are the available partitions:
Kernel panic - not syncing: VFS: Unable to mount root fs on unknown-block(0,0)</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p75975">
				<div class="post-metadata">
					<div class="post-num">Post #46</div>
					<div class="post-author">lamaatje</div>
					<div class="post-datetime">
						6 Nov 2008, 14:33					</div>
				</div>
				<div class="post-content content">
					<p>@t3l3m4k0</p><p>bcm963xx: Read Signature value of CFE1CFE1$ÃŽ0$ï¿½ Ãœ$ÃŽ0&nbsp; -&gt; this is caused by the bug I was refering to, buf is not zero terminated strcmp fails, this is the old code. Clean prob destroyed your patches, patch again?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p75976">
				<div class="post-metadata">
					<div class="post-num">Post #47</div>
					<div class="post-author">lamaatje</div>
					<div class="post-datetime">
						6 Nov 2008, 14:50					</div>
				</div>
				<div class="post-content content">
					<p>I am totally new to OpenWrt, got it running op DV201AMR but network setup seems not ok, cannot ping to and from the box<br /></p><div class="codebox"><pre><code>root@OpenWrt:/# ifconfig                        
br-lan    Link encap:Ethernet  HWaddr 00:1D:60:0                                
          inet addr:192.168.1.1  Bcast:192.168.1.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:1 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:0 (0.0 B)  TX bytes:402 (402.0 B)

eth0      Link encap:Ethernet  HWaddr 00:1D:60:01:A3:7E
          UP BROADCAST MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
          Interrupt:16

lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)</code></pre></div><p>Probably has to do with setting up switch ports, have no experience with this. Since it is an ADSL box the wan port also fails.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p75983">
				<div class="post-metadata">
					<div class="post-num">Post #48</div>
					<div class="post-author">tomolewis</div>
					<div class="post-datetime">
						6 Nov 2008, 16:34					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m watching this thread, i hope you guys will be able to make a stable port to the DG834GT with wifi etc <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>thanks for everybodys efforts</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p75998">
				<div class="post-metadata">
					<div class="post-num">Post #49</div>
					<div class="post-author">spirit</div>
					<div class="post-datetime">
						6 Nov 2008, 21:52					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>lamaatje wrote:</cite><blockquote><p>I am totally new to OpenWrt, got it running op DV201AMR but network setup seems not ok, cannot ping to and from the box<br /></p><div class="codebox"><pre><code>root@OpenWrt:/# ifconfig                        
br-lan    Link encap:Ethernet  HWaddr 00:1D:60:0                                
          inet addr:192.168.1.1  Bcast:192.168.1.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:1 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:0 (0.0 B)  TX bytes:402 (402.0 B)

eth0      Link encap:Ethernet  HWaddr 00:1D:60:01:A3:7E
          UP BROADCAST MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
          Interrupt:16

lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)</code></pre></div><p>Probably has to do with setting up switch ports, have no experience with this. Since it is an ADSL box the wan port also fails.</p></blockquote></div><p>Well, your br-lan hwaddr is truncated ... it must have a hwaddr of excatly 6 bytes like the eth0 port.<br />I suppose bridge-control package is installed so please check</p><p># brctl show<br />bridge name&nbsp; &nbsp; &nbsp;bridge id&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;STP enabled&nbsp; &nbsp; &nbsp;interfaces<br />br0-lan&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8000.xxxxxxxxxxxx&nbsp; &nbsp; &nbsp; &nbsp;no&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eth0<br />(or something like that)</p><p>If the logical bridge doesn&#039;t have an interface attached try:<br /># brctl addif br-lan eth0</p><p>Afterwards the ping should work.</p><p>I guess, the base startup files have to be reworked for the bc63xx platform.</p>											<p class="post-edited">(Last edited by <strong>spirit</strong> on 6 Nov 2008, 23:15)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p76002">
				<div class="post-metadata">
					<div class="post-num">Post #50</div>
					<div class="post-author">lamaatje</div>
					<div class="post-datetime">
						6 Nov 2008, 23:21					</div>
				</div>
				<div class="post-content content">
					<p>Thx, for your help, I now see a complete hwaddr, so maybe something went wrong copying from console.<br /></p><div class="codebox"><pre><code>root@OpenWrt:/# brctl show
bridge name     bridge id               STP enabled     interfaces
br-lan          8000.001d6001a37e       no              eth0</code></pre></div><p>ping still not working</p>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 2 of 30</div><nav><ul><li><a href="viewtopic.php%3Fid=17370&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li><li><a href="viewtopic.php%3Fid=17370&amp;p=3.html">3</a></li><li><a href="viewtopic.php%3Fid=17370&amp;p=4.html">4</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=17370&amp;p=30.html">30</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>