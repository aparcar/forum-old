<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Need help for d-link DIR-300 rev. B1</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 2 Oct 2014 and 6 Sep 2015.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 2 of 3</div><nav><ul><li><a href="viewtopic.php%3Fid=28010&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li><li><a href="viewtopic.php%3Fid=28010&amp;p=3.html">3</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p132504">
				<div class="post-metadata">
					<div class="post-num">Post #26</div>
					<div class="post-author">boink</div>
					<div class="post-datetime">
						8 Apr 2011, 09:41					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for the patch.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p132550">
				<div class="post-metadata">
					<div class="post-num">Post #27</div>
					<div class="post-author">Zanzani</div>
					<div class="post-datetime">
						9 Apr 2011, 01:39					</div>
				</div>
				<div class="post-content content">
					<p>Hi there,</p><p>I&#039;m following this thread with great attention to see if the solution for my RA3050 router comes along.<br/>The routers I&#039;ve got are some OEM boxes branded &quot;KÖNIG&quot;, type CMP-WNAP20. They have a WAN-, only one LAN-port and no USB. 16MB RAM and 8MB flash. There is a pinheader onboard to easily connect a serial port buffer. They are sold rather cheap and the vendor still has pleny of them in stock.<br/>I photographed one of them. Please have look on <a href="http://www.xs4all.nl/~mlf/RT3050/">http://www.xs4all.nl/~mlf/RT3050/</a> and tell me if you recognise it. Maybe it&#039;s sold under another name too.</p><p>I&#039;ve flashed them with all available flavors of firmware. DD-WRT works quite well but I really want to use OpenWrt cause I want to use it as more than just a router.<br/>However, I cannot get the WAN-port to work using OpenWrt. What ever patch I tried (like the RT3.5 patch) there&#039;s no communication over WAN. <br/>I compiled-in tcpdump. I can see the packets arrive and the device even tries to answer to the who-is and ping requests but nothing comes out. The only packets coming out of the WAN-port I can see are some multicast announcements but nothing else.</p><p>Is there anyone who can give me a valuable hint on this? And/or is someone willing to investigate it? I can make a setup next week that lets you telnet to the serial port.</p><p>I hope I can get my fingers behind it soon because I have great plans with these boxes.</p><p>BTW: I don&#039;t care about wireless yet. I can wait till there&#039;s more development done on that.</p><p>Cheers,</p><p>Erik</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p132553">
				<div class="post-metadata">
					<div class="post-num">Post #28</div>
					<div class="post-author">LinkZ</div>
					<div class="post-datetime">
						9 Apr 2011, 04:56					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Zanzani wrote:</cite><blockquote><p>Hi there,</p><p>I&#039;m following this thread with great attention to see if the solution for my RA3050 router comes along.<br/>The routers I&#039;ve got are some OEM boxes branded &quot;KÖNIG&quot;, type CMP-WNAP20. They have a WAN-, only one LAN-port and no USB. 16MB RAM and 8MB flash. There is a pinheader onboard to easily connect a serial port buffer. They are sold rather cheap and the vendor still has pleny of them in stock.<br/>I photographed one of them. Please have look on <a href="http://www.xs4all.nl/~mlf/RT3050/">http://www.xs4all.nl/~mlf/RT3050/</a> and tell me if you recognise it. Maybe it&#039;s sold under another name too.</p><p>I&#039;ve flashed them with all available flavors of firmware. DD-WRT works quite well but I really want to use OpenWrt cause I want to use it as more than just a router.<br/>However, I cannot get the WAN-port to work using OpenWrt. What ever patch I tried (like the RT3.5 patch) there&#039;s no communication over WAN. <br/>I compiled-in tcpdump. I can see the packets arrive and the device even tries to answer to the who-is and ping requests but nothing comes out. The only packets coming out of the WAN-port I can see are some multicast announcements but nothing else.</p><p>Is there anyone who can give me a valuable hint on this? And/or is someone willing to investigate it? I can make a setup next week that lets you telnet to the serial port.</p><p>I hope I can get my fingers behind it soon because I have great plans with these boxes.</p><p>BTW: I don&#039;t care about wireless yet. I can wait till there&#039;s more development done on that.</p><p>Cheers,</p><p>Erik</p></blockquote></div><p>The switch driver for rt305x (ramips_esw) currently has the VLANs hard-coded, as there is no swconfig support yet in ramips (to configure the VLANs).&nbsp; So if your router ports are configured differently than the default (which is LLLL/W for the dir-300 and fonera 2.0n), then your WAN either will be on wrong port or not available at all... this was the case with my router (HW550-3G, which is W/LLLL).&nbsp; You can manually set the VLANs in your build to match your router (see ramips_esw.c).</p><p>Regards,<br/>Layne</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p132615">
				<div class="post-metadata">
					<div class="post-num">Post #29</div>
					<div class="post-author">Zanzani</div>
					<div class="post-datetime">
						10 Apr 2011, 02:33					</div>
				</div>
				<div class="post-content content">
					<p>Thank you Layne,</p><p>I did some changes on ramips_esw.c. As I have no experience on this and as I&#039;m not a programmer I had to guess what determines the VLAN assignment. At about line 255 I found this:</p><p>&nbsp; &nbsp; /* set default vlan */<br/>&nbsp; &nbsp; rt305x_esw_set_vlan_id(esw, 0, 1);<br/>&nbsp; &nbsp; rt305x_esw_set_vlan_id(esw, 1, 2);<br/>&nbsp; &nbsp; rt305x_esw_set_vmsc(esw, 0,<br/>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;(BIT(RT305X_ESW_PORT0) | BIT(RT305X_ESW_PORT1) |<br/>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; BIT(RT305X_ESW_PORT2) | BIT(RT305X_ESW_PORT3) |<br/>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; BIT(RT305X_ESW_PORT6)));<br/>&nbsp; &nbsp; rt305x_esw_set_vmsc(esw, 1,<br/>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;(BIT(RT305X_ESW_PORT4 | BIT(RT305X_ESW_PORT6)));<br/>&nbsp; &nbsp; rt305x_esw_set_vmsc(esw, 2, 0);<br/>&nbsp; &nbsp; rt305x_esw_set_vmsc(esw, 3, 0);</p><p>This seemed to me the place where the different ports are set to respectively VLAN1 and VLAN2. After some unsuccessful compiles because of little experience and late-night tiredness the following lines seem to to exactly what I need:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;(BIT(RT305X_ESW_PORT4) | BIT(RT305X_ESW_PORT1) |<br/>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; BIT(RT305X_ESW_PORT2) | BIT(RT305X_ESW_PORT3) |<br/>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; BIT(RT305X_ESW_PORT6)));<br/>&nbsp; &nbsp; rt305x_esw_set_vmsc(esw, 1,<br/>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;(BIT(RT305X_ESW_PORT0 | BIT(RT305X_ESW_PORT6)));</p><p>As you see I just swapped PORT0 and 4. This equals to the knowledge I got after comparing the traces on the pcb with the datasheet (that&#039;s what I&#039;m far more experienced in). Than, indeed, it comes out that my device is soldered as W/L (respectively port 0 and 1) where the default OpenWrt-trunk uses LLLL/W (respectively port 0 to 4). </p><p>However this kind of configuration is far from perfect it&#039;s now time for me to go to my next challenge on these devices: OpenVPN and virtual hosts on uhttpd.</p><p>Many thanks for now,</p><p>Erik</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p132699">
				<div class="post-metadata">
					<div class="post-num">Post #30</div>
					<div class="post-author">boink</div>
					<div class="post-datetime">
						11 Apr 2011, 16:28					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve build a firmware for DIR-600 rev B using latest trunk&nbsp; and all the mac addreses are in the form of 11:22:33:44:55:66. I&#039;ve managed to change them using&nbsp; webif with the real mac addresses of the router but they don&#039;t survive past reboot. Any clues ?</p>											<p class="post-edited">(Last edited by <strong>boink</strong> on 11 Apr 2011, 16:28)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p132711">
				<div class="post-metadata">
					<div class="post-num">Post #31</div>
					<div class="post-author">LinkZ</div>
					<div class="post-datetime">
						11 Apr 2011, 17:35					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>boink wrote:</cite><blockquote><p>I&#039;ve build a firmware for DIR-600 rev B using latest trunk&nbsp; and all the mac addreses are in the form of 11:22:33:44:55:66. I&#039;ve managed to change them using&nbsp; webif with the real mac addresses of the router but they don&#039;t survive past reboot. Any clues ?</p></blockquote></div><p>The eth0 MAC address is currently hard-coded in the driver.&nbsp; The driver needs to be updated to pull it from the eeprom.&nbsp; It works fine with the hard-coded value for now though.&nbsp; Just keep in mind that ramips targets are still a WIP.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p132866">
				<div class="post-metadata">
					<div class="post-num">Post #32</div>
					<div class="post-author">be.cool</div>
					<div class="post-datetime">
						13 Apr 2011, 07:39					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>LinkZ wrote:</cite><blockquote><p><a href="http://patchwork.midlink.org/patch/865/">http://patchwork.midlink.org/patch/865/</a></p></blockquote></div><p>Some body has used this patch? What is the difference from using this patch and the network patchs from: <a href="https://forum.openwrt.org/viewtopic.php?pid=130692#p130692">https://forum.openwrt.org/viewtopic.php?pid=130692#p130692</a> ?</p><p>I could sucessfuly build openWrt trunk to my dir-600 B2 but I? getting some weird behavior. Some times I have trouble when I try to connect through WiFi with WPA2 enabled. My computer says that it can&#039;t connect to network after typing the correct password, or it connects but i don&#039;t get an ip address by DHCP. After some time I can connect and get an address and them I&#039;m able to browse the internet or access another computers in the network.<br/>The WiFi speed is not good too. I can only get about 2 MB/s in file transfers or some times even below that.</p><p>Other thing I noticed is the amount of mtd partitions when running OpenWRT:</p><p>root@OpenWrt:~# cat /proc/mtd <br/>dev:&nbsp; &nbsp; size&nbsp; &nbsp;erasesize&nbsp; name<br/>mtd0: 00030000 00010000 &quot;u-boot&quot;<br/>mtd1: 00010000 00010000 &quot;u-boot-env&quot;<br/>mtd2: 00010000 00010000 &quot;factory&quot;<br/>mtd3: 000d0000 00010000 &quot;kernel&quot;<br/>mtd4: 002e0000 00010000 &quot;rootfs&quot;<br/>mtd5: 00180000 00010000 &quot;rootfs_data&quot;<br/>mtd6: 003b0000 00010000 &quot;firmware&quot;</p><p>Is this really correct? </p><p>When I revert back to the original D-link Firmware the router behaves even poorly than OpenWRT. Most problems occur on WiFi. I can connect to wifi, get an address but can&#039;t ping anything. Not even the router.</p><p>Any help or comment about these problems? Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p132882">
				<div class="post-metadata">
					<div class="post-num">Post #33</div>
					<div class="post-author">boink</div>
					<div class="post-datetime">
						13 Apr 2011, 12:19					</div>
				</div>
				<div class="post-content content">
					<p>The patch has nothing to do with wireless, it only adds some config files to identify the device as DIR-600 rev.B. I&#039;ve flashed my router which is a DIR-600 rev. B with the latest trunk and i get the same mtd partitions:</p><br/><p>root@OpenWrt:/etc/init.d# cat /proc/mtd<br/>dev:&nbsp; &nbsp; size&nbsp; &nbsp;erasesize&nbsp; name<br/>mtd0: 00030000 00010000 &quot;u-boot&quot;<br/>mtd1: 00010000 00010000 &quot;u-boot-env&quot;<br/>mtd2: 00010000 00010000 &quot;factory&quot;<br/>mtd3: 000d0000 00010000 &quot;kernel&quot;<br/>mtd4: 002e0000 00010000 &quot;rootfs&quot;<br/>mtd5: 000a0000 00010000 &quot;rootfs_data&quot;<br/>mtd6: 003b0000 00010000 &quot;firmware&quot;</p><p>I don&#039;t think that&#039;s an issue. My problem is that the settings are not saved to nvram. I&#039;ve modified some settings regarding network with uci, but after reboot they don&#039;t persist. And sometimes luci gets corrupted after reboot.</p><p>root@OpenWrt:/www/cgi-bin# ./luci<br/>/usr/lib/lua/luci/dispatcher.lua:163: /etc/config/luci seems to be corrupt, unable to find section &#039;main&#039;<br/>stack traceback:<br/>&nbsp; &nbsp; &nbsp; &nbsp; [C]: in function &#039;assert&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; /usr/lib/lua/luci/dispatcher.lua:163: in function &#039;dispatch&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; /usr/lib/lua/luci/dispatcher.lua:146: in function &lt;/usr/lib/lua/luci/dispatcher.lua:145&gt;<br/>Status: 500 Internal Server Error<br/>Content-Type: text/plain<br/>Cache-Control: no-cache<br/>Expires: 0</p><p>/usr/lib/lua/luci/dispatcher.lua:163: /etc/config/luci seems to be corrupt, unable to find section &#039;main&#039;<br/>stack traceback:<br/>&nbsp; &nbsp; &nbsp; &nbsp; [C]: in function &#039;assert&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; /usr/lib/lua/luci/dispatcher.lua:163: in function &#039;dispatch&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; /usr/lib/lua/luci/dispatcher.lua:146: in function &lt;/usr/lib/lua/luci/dispatcher.lua:145&gt;root@OpenWrt:/www/cgi-bin#&nbsp; /etc/config/luci seems to be corrupt, unable<br/>/bin/ash: /etc/config/luci: Permission denied</p>											<p class="post-edited">(Last edited by <strong>boink</strong> on 13 Apr 2011, 12:22)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p132885">
				<div class="post-metadata">
					<div class="post-num">Post #34</div>
					<div class="post-author">RoundSparrow</div>
					<div class="post-datetime">
						13 Apr 2011, 12:34					</div>
				</div>
				<div class="post-content content">
					<p>Another RT3050 user here. I put up a photograph of the Tenda 3G611R+ system board:<br/> <span class="postimg"><img src="http://sites.google.com/site/stephengutknecht/Home/Tenda_3G611RPLUS_internal1_medium1.jpg" alt="http://sites.google.com/site/stephengutknecht/Home/Tenda_3G611RPLUS_internal1_medium1.jpg"/></span><br/> <span class="postimg"><img src="http://sites.google.com/site/stephengutknecht/Home/Tenda_3G611RPLUS_internal2_medium1.jpg" alt="http://sites.google.com/site/stephengutknecht/Home/Tenda_3G611RPLUS_internal2_medium1.jpg"/></span></p><p>keywordz: Tenda 3G 3G611R 3G611R+ 611R 611R+ D-Link USB Ralink router wifi 801.11n 3G622R 622R</p>											<p class="post-edited">(Last edited by <strong>RoundSparrow</strong> on 14 Apr 2011, 12:17)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p132926">
				<div class="post-metadata">
					<div class="post-num">Post #35</div>
					<div class="post-author">be.cool</div>
					<div class="post-datetime">
						13 Apr 2011, 18:42					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>boink wrote:</cite><blockquote><p>The patch has nothing to do with wireless, it only adds some config files to identify the device as DIR-600 rev.B. I&#039;ve flashed my router which is a DIR-600 rev. B with the latest trunk and i get the same mtd partitions:</p><br/><p>root@OpenWrt:/etc/init.d# cat /proc/mtd<br/>dev:&nbsp; &nbsp; size&nbsp; &nbsp;erasesize&nbsp; name<br/>mtd0: 00030000 00010000 &quot;u-boot&quot;<br/>mtd1: 00010000 00010000 &quot;u-boot-env&quot;<br/>mtd2: 00010000 00010000 &quot;factory&quot;<br/>mtd3: 000d0000 00010000 &quot;kernel&quot;<br/>mtd4: 002e0000 00010000 &quot;rootfs&quot;<br/>mtd5: 000a0000 00010000 &quot;rootfs_data&quot;<br/>mtd6: 003b0000 00010000 &quot;firmware&quot;</p><p>I don&#039;t think that&#039;s an issue. My problem is that the settings are not saved to nvram. I&#039;ve modified some settings regarding network with uci, but after reboot they don&#039;t persist. And sometimes luci gets corrupted after reboot.</p><p>root@OpenWrt:/www/cgi-bin# ./luci<br/>/usr/lib/lua/luci/dispatcher.lua:163: /etc/config/luci seems to be corrupt, unable to find section &#039;main&#039;<br/>stack traceback:<br/>&nbsp; &nbsp; &nbsp; &nbsp; [C]: in function &#039;assert&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; /usr/lib/lua/luci/dispatcher.lua:163: in function &#039;dispatch&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; /usr/lib/lua/luci/dispatcher.lua:146: in function &lt;/usr/lib/lua/luci/dispatcher.lua:145&gt;<br/>Status: 500 Internal Server Error<br/>Content-Type: text/plain<br/>Cache-Control: no-cache<br/>Expires: 0</p><p>/usr/lib/lua/luci/dispatcher.lua:163: /etc/config/luci seems to be corrupt, unable to find section &#039;main&#039;<br/>stack traceback:<br/>&nbsp; &nbsp; &nbsp; &nbsp; [C]: in function &#039;assert&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; /usr/lib/lua/luci/dispatcher.lua:163: in function &#039;dispatch&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; /usr/lib/lua/luci/dispatcher.lua:146: in function &lt;/usr/lib/lua/luci/dispatcher.lua:145&gt;root@OpenWrt:/www/cgi-bin#&nbsp; /etc/config/luci seems to be corrupt, unable<br/>/bin/ash: /etc/config/luci: Permission denied</p></blockquote></div><p>Hi boink.</p><p>Well, I applied the patch and built a new OpenWrt image with the latest trunk. I also applied the network patchs from previous posts.</p><p>The image that gets created is: openwrt-ramips-rt305x-dir-600-b2-squashfs-sysupgrade.bin</p><p>The router boots ok, i can get ethernet working and access internet through it. But with wifi. No luck. With or without encryption I&#039;m getting the same problems. Some times I can&#039;t even connect. <br/>When using WPA/WPA2 my computer says that the password is not correct, but I&#039;m sure i had entered the correct password. Without encryption I can aways connect and receive IP through DHCP after some time (this is a little bit slow, even when i connected using ethernet) but I can&#039;t ping the router or any thing else using wifi I only receive DHCP packets. The Ethernet aways works as expected.</p><p>After rebooting my configurations are aways saved, but I built a small image, leaving about 1,5 MB to the jffs partition (which is mtd5).</p><p>What I think it&#039;s strange is that the offsets of the mtd partitions are not the same as the patch from LinkZ. </p><p>I hope these problems are related only with the wireless drivers, not with the hardware it self. While using D-link firmware I could see a kernel panic a couple of times. The kernel used was 2.6.21 from D-link&#039;s GPL source code.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p132946">
				<div class="post-metadata">
					<div class="post-num">Post #36</div>
					<div class="post-author">LinkZ</div>
					<div class="post-datetime">
						13 Apr 2011, 21:58					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>be.cool wrote:</cite><blockquote><p>What I think it&#039;s strange is that the offsets of the mtd partitions are not the same as the patch from LinkZ.</p></blockquote></div><p>This is because the flash partitions are set in the kernel command line, which overwrites the partitions in the board configuration.&nbsp; See the image/Makefile:</p><div class="codebox"><pre><code>mtdlayout_4M=mtdparts=physmap-flash.0:192k(u-boot)ro,64k(u-boot-env)ro,64k(factory)ro,832k(kernel),2944k(rootfs),3776k@0x50000(firmware)</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p132952">
				<div class="post-metadata">
					<div class="post-num">Post #37</div>
					<div class="post-author">be.cool</div>
					<div class="post-datetime">
						13 Apr 2011, 23:10					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>LinkZ wrote:</cite><blockquote><div class="quotebox"><cite>be.cool wrote:</cite><blockquote><p>What I think it&#039;s strange is that the offsets of the mtd partitions are not the same as the patch from LinkZ.</p></blockquote></div><p>This is because the flash partitions are set in the kernel command line, which overwrites the partitions in the board configuration.&nbsp; See the image/Makefile:</p><div class="codebox"><pre><code>mtdlayout_4M=mtdparts=physmap-flash.0:192k(u-boot)ro,64k(u-boot-env)ro,64k(factory)ro,832k(kernel),2944k(rootfs),3776k@0x50000(firmware)</code></pre></div></blockquote></div><p>I don&#039;t quite understand.&nbsp; So You&#039;re saying that my partitions are wrong? I&#039;m thinking that what is causing the Original D-Link firmware to malfunction are the partitions or some garbage in them.</p><p>I got the Original firmware (ver 2.02) to work correctly yesterday. But after upgrading to 2.05, the wifi stopped working. And continued not working after flashing OpenWRT.</p><p>I&#039;m starting to wonder if my device hardware is the source of these problems.</p><p>Edit:<br/>I also noted that the partition &quot;rootfs_data&quot; that appears on my device, isn&#039;t mentioned in trunk/target/linux/ramips/image/Makefile at the 4M generic mtd layout variable.</p>											<p class="post-edited">(Last edited by <strong>be.cool</strong> on 13 Apr 2011, 23:55)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p132956">
				<div class="post-metadata">
					<div class="post-num">Post #38</div>
					<div class="post-author">LinkZ</div>
					<div class="post-datetime">
						14 Apr 2011, 00:19					</div>
				</div>
				<div class="post-content content">
					<p>No, your partitions are fine.&nbsp; I&#039;m just saying that the partition definitions in the mach-dir-600-revb.c file won&#039;t be used, because the flash physmap is set in the kernel command line.&nbsp; Either way it doesn&#039;t matter though.&nbsp; The partition names don&#039;t make any difference (only the addresses)... and the bootloader, bootloader config and factory config are the only partitions that must be the same (and they are).</p><p>The rootfs_data partition is created automatically.&nbsp; It is your writable jffs2 partition.</p><p>Whatever problems you&#039;re having with wifi, I&#039;m pretty sure it has nothing to do with the partitions.&nbsp; However, if your radio uses configuration data from the bootloader config partition (or NVRAM), then it&#039;s possible that data is corrupted.&nbsp; Usually restoring to the factory settings (i.e. a 30-30-30) reset using the FACTORY firmware will restore NVRAM and/or the bootloader config data... but I don&#039;t know about the DIR-600 for sure.</p><p>Regards,<br/>Layne</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p132961">
				<div class="post-metadata">
					<div class="post-num">Post #39</div>
					<div class="post-author">be.cool</div>
					<div class="post-datetime">
						14 Apr 2011, 01:17					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>LinkZ wrote:</cite><blockquote><p>No, your partitions are fine.&nbsp; I&#039;m just saying that the partition definitions in the mach-dir-600-revb.c file won&#039;t be used, because the flash physmap is set in the kernel command line.&nbsp; Either way it doesn&#039;t matter though.&nbsp; The partition names don&#039;t make any difference (only the addresses)... and the bootloader, bootloader config and factory config are the only partitions that must be the same (and they are).</p><p>The rootfs_data partition is created automatically.&nbsp; It is your writable jffs2 partition.</p><p>Whatever problems you&#039;re having with wifi, I&#039;m pretty sure it has nothing to do with the partitions.&nbsp; However, if your radio uses configuration data from the bootloader config partition (or NVRAM), then it&#039;s possible that data is corrupted.&nbsp; Usually restoring to the factory settings (i.e. a 30-30-30) reset using the FACTORY firmware will restore NVRAM and/or the bootloader config data... but I don&#039;t know about the DIR-600 for sure.</p><p>Regards,<br/>Layne</p></blockquote></div><p>Thank you Layne for clearing the things up for me.</p><p>I&#039;ll try as you suggested a a 30-30-30 reset with the default firmware from D-link.</p><p>But just for curiosity. Is there any one here that have this radio working properly with any of the available firmwares: OpenWRT, DD-WRT and D-link&#039;s official firmware?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p132974">
				<div class="post-metadata">
					<div class="post-num">Post #40</div>
					<div class="post-author">be.cool</div>
					<div class="post-datetime">
						14 Apr 2011, 06:45					</div>
				</div>
				<div class="post-content content">
					<p>The 30-30-30 reset flash procedure didn&#039;t work (I ended up in the rescue firmware upload tool). I reverted back to the original D-Link firmware but I can&#039;t get the wireless to work correctly. It works when it wants. The only systematic thing I see is that only arp requests/responses and dhcp trafic is flowing through the wireless interface. Nothing else.</p><p>The problems started to occur after flashing dd-wrt firmware.</p><p>Does somebody know how to wipe the mtd partitions completely ? Leaving just the u-boot and u-boot-env partitons intact? Or know that may be happening?</p><p>Thanks!</p><p>Edit:<br/>I&#039;ve run wireshark on my computer to listen in the wireless interface while connected to dir-600 with stock firmware. I could confirm that only arp requests (i managed to arping the router successfully ) are being routed though the wifi interface. I&#039;m not geting why...</p>											<p class="post-edited">(Last edited by <strong>be.cool</strong> on 14 Apr 2011, 07:55)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p132982">
				<div class="post-metadata">
					<div class="post-num">Post #41</div>
					<div class="post-author">boink</div>
					<div class="post-datetime">
						14 Apr 2011, 09:07					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m running wireless on DD-WRT without issues. And it seems to work on OPENWRT as well. As for stock firmware I can&#039;t tell, as I&#039;ve flashed it from the day I boughted.</p>											<p class="post-edited">(Last edited by <strong>boink</strong> on 14 Apr 2011, 09:07)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p133004">
				<div class="post-metadata">
					<div class="post-num">Post #42</div>
					<div class="post-author">be.cool</div>
					<div class="post-datetime">
						14 Apr 2011, 16:06					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>boink wrote:</cite><blockquote><p>I&#039;m running wireless on DD-WRT without issues. And it seems to work on OPENWRT as well. As for stock firmware I can&#039;t tell, as I&#039;ve flashed it from the day I boughted.</p></blockquote></div><p>The same problem happens in DD-WRT and OpenWRT in my radio. Wich version of dd-wrt firmware you are using?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p133017">
				<div class="post-metadata">
					<div class="post-num">Post #43</div>
					<div class="post-author">boink</div>
					<div class="post-datetime">
						14 Apr 2011, 19:03					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m using the latest build from <a href="ftp://dd-wrt.com/others/eko/BrainSlayer-V24-preSP2/2011/04-09-11-r16785/dlink-dir600b/">ftp://dd-wrt.com/others/eko/BrainSlayer-V24-preSP2/2011/04-09-11-r16785/dlink-dir600b/</a> , but I haven&#039;t encountered any issues with previous releases.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p133034">
				<div class="post-metadata">
					<div class="post-num">Post #44</div>
					<div class="post-author">be.cool</div>
					<div class="post-datetime">
						14 Apr 2011, 21:28					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>boink wrote:</cite><blockquote><p>I&#039;m using the latest build from <a href="ftp://dd-wrt.com/others/eko/BrainSlayer-V24-preSP2/2011/04-09-11-r16785/dlink-dir600b/">ftp://dd-wrt.com/others/eko/BrainSlayer-V24-preSP2/2011/04-09-11-r16785/dlink-dir600b/</a> , but I haven&#039;t encountered any issues with previous releases.</p></blockquote></div><p>I downloaded and flashed the latest firmware on my device. The wifi interface starte working and I could make some file transferences, the speed wasn&#039;t too good, but it worked.</p><p>So I started to do some configurations. Added WPA2 but i could only connect to the wifi network, not get an IP adress via dhcp. I removed the WPA2 and it started to work again.<br/>Then I tried WPA, but again I could connect to the network but can&#039;t obtain an IP.<br/>After removing this configuration, the wifi interface stopped working at all. I can associate to the wifi network and get an IP, but can&#039;t ping or access anything. Just arping the router it-self</p><p>Another thing I noticed it that for the short time the wireless worked after flashing dd-wrt the RX rate was very high, about 54 Mbps, now that the wifi is not working, the RX Rate (DD-WRT wireless status page) shows only 5.5 Mbps (some times it drops to 1 Mbps) for RX and full 65 Mbps for TX.</p>											<p class="post-edited">(Last edited by <strong>be.cool</strong> on 14 Apr 2011, 22:09)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p133038">
				<div class="post-metadata">
					<div class="post-num">Post #45</div>
					<div class="post-author">PopOpen</div>
					<div class="post-datetime">
						14 Apr 2011, 21:51					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>RoundSparrow wrote:</cite><blockquote><p>Another RT3050 user here. I put up a photograph of the Tenda 3G611R+ system board:<br/>keywordz: Tenda 3G 3G611R 3G611R+ 611R 611R+ D-Link USB Ralink router wifi 801.11n 3G622R 622R</p></blockquote></div><p>@RoundSparrow: Hey! That look like a cool router, I see from the pictures that there is an extra, but unused antenna trace! Perhaps that thing can do more than you think... Although I can&#039;t see from the photo if it&#039;s also missing the components. If you have any good stuff please add your device+info to the main OpenWRT website! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile"/></p>											<p class="post-edited">(Last edited by <strong>PopOpen</strong> on 14 Apr 2011, 21:53)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p134334">
				<div class="post-metadata">
					<div class="post-num">Post #46</div>
					<div class="post-author">boink</div>
					<div class="post-datetime">
						30 Apr 2011, 07:41					</div>
				</div>
				<div class="post-content content">
					<p>Any news on the ramips port ? Seems it hasn&#039;t been updated in&nbsp; trunk for over a month.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p136849">
				<div class="post-metadata">
					<div class="post-num">Post #47</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						10 Jun 2011, 18:48					</div>
				</div>
				<div class="post-content content">
					<p><a href="https://www.dd-wrt.com/phpBB2/viewtopic.php?t=140146">DD-WRT Forum :: View topic - rt3050/52 datasheet preliminary edition</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p139420">
				<div class="post-metadata">
					<div class="post-num">Post #48</div>
					<div class="post-author">petdr</div>
					<div class="post-datetime">
						19 Jul 2011, 07:24					</div>
				</div>
				<div class="post-content content">
					<p>I am attempting to copy a large file (500Mb) from a computer on the wireless network to a computer on the wired network attached to the lan.&nbsp; After a few megabytes are transferred, I am no longer able to contact the computer on the wired network, until after I reboot the router.</p><p>See <a href="https://dev.openwrt.org/ticket/9743">https://dev.openwrt.org/ticket/9743</a> for more details</p><p>My question is: are other people able to do this on their DIR 600 VB2? If yes, what version of trunk are they using?&nbsp; I may need to downgrade to an older version of the firmware.&nbsp; Also I had exactly the same problem with this router, using the standard dlink firmware, so maybe it&#039;s a hardware fault?</p><p>** EDIT 2011/09/30 ** with revision 28314 of the trunk I can no longer reproduce this problem.</p>											<p class="post-edited">(Last edited by <strong>petdr</strong> on 30 Sep 2011, 06:38)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p139571">
				<div class="post-metadata">
					<div class="post-num">Post #49</div>
					<div class="post-author">Hank</div>
					<div class="post-datetime">
						21 Jul 2011, 17:04					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>made my first steps with OpenWrt and this is my first post.<br/>I had success building the latest trunk rev27711 for my D-Link DIR-300 B1,&nbsp; chip Ralink RT3052.&nbsp; Maybe someone needs this info.</p><p>I tested the default functionality, that is I get a DHCP-lease on the LAN side, receive a DHCP-lease on the WAN-interface from my local DHCP-server and can route through the&nbsp; DIR-300 B1 to the internet.</p><p>Wireless can be switched on telneting from LAN to 192.168.1.1 and enabling WIFI in root@OpenWrt:/#/etc/config/wireless. But I didn&#039;t test at the moment, if I can connect to WIFI.</p><p>For building I followed the advice in the Wiki: <a href="http://wiki.openwrt.org/toh/d-link/dir-300revb">http://wiki.openwrt.org/toh/d-link/dir-300revb</a>. Flashing the new firmware was done from the original D-Link Web-GUI.</p><p>My interest for OpenWrt woke up reading this article about IPv6-Tunnels:<br/><a href="http://www.heise.de/netze/artikel/IPv6-Zugang-fuers-LAN-nachruesten-1260260.html">http://www.heise.de/netze/artikel/IPv6-Zugang-fuers-LAN-nachruesten-1260260.html</a></p><p>I hope I will be able to configure a Gogo6-Tunnel later with OpenWrt, as described on Page 3:<br/><a href="http://www.heise.de/netze/artikel/IPv6-Zugang-fuers-LAN-nachruesten-1260260.html?artikelseite=3">http://www.heise.de/netze/artikel/IPv6-Zugang-fuers-LAN-nachruesten-1260260.html?artikelseite=3</a></p><p>Thanks to all developers!</p>											<p class="post-edited">(Last edited by <strong>Hank</strong> on 21 Jul 2011, 17:07)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p139796">
				<div class="post-metadata">
					<div class="post-num">Post #50</div>
					<div class="post-author">Hank</div>
					<div class="post-datetime">
						24 Jul 2011, 00:51					</div>
				</div>
				<div class="post-content content">
					<p>An appendix to my last post. After replacing the original D-Link firmware with a basic trunk version of OpenWrt I missed some commands like ip6tables. So I recompiled the trunk with selecting ip6tables in &#039;make menuconfig&#039; and make. As a noob, it was difficult for me to find out afterwards, how to reflash OpenWrt for the first time. The original Web-GUI of the router wasn&#039;t available at this point and I had to select, which of the compiled firmware-binaries were apropriate. I found a small hint in <a href="http://wiki.openwrt.org/toh/d-link/dir-300">http://wiki.openwrt.org/toh/d-link/dir-300</a> to use the tool &#039;sysupgrade&#039;.</p><p>So I ...</p><p>* changed telnet to ssh access with the command passwd on the router.<br/>* uploaded the new firmware from the LAN with &#039;scp openwrt-ramips-rt305x-dir-300-b1-squashfs-sysupgrade.bin root@192.168.1.1:/tmp/&#039;.<br/>* flashed it on the router with &#039;sysupgrade /tmp/openwrt-ramips-rt305x-dir-300-b1-squashfs-sysupgr<br/>ade.bin&#039;.</p><p>Now the command ip6tables for example works on my DIR-300B1.</p><p>I hope this was helpful for other starters.</p><p>cheers</p>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 2 of 3</div><nav><ul><li><a href="viewtopic.php%3Fid=28010&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li><li><a href="viewtopic.php%3Fid=28010&amp;p=3.html">3</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>