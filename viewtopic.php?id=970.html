<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Redirecting HTTP</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 19 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p4594">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">kff322</div>
					<div class="post-datetime">
						13 Feb 2005, 20:08					</div>
				</div>
				<div class="post-content content">
					<p>Hello everyone!</p><p> I am using my WRT54G V2 as a web server and I want to make it so that anyone who connects to the wireless AP and enters any web site is automaticly redirected to the web server on the WRT at 192.168.1.1. Who would I go about doing this? Possibly with out installing any extra packages.</p><p>Cheers</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p4595">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">netmaster</div>
					<div class="post-datetime">
						13 Feb 2005, 20:28					</div>
				</div>
				<div class="post-content content">
					<div class="codebox"><pre><code>iptables -t nat -A PREROUTING -i eth1 -p tcp --dport 80 -j REDIRECT --to-port 80</code></pre></div><p>if eth1 is interface where client come from and 80 is local web server port.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p4605">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">kff322</div>
					<div class="post-datetime">
						14 Feb 2005, 00:28					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for your help although when i attempt to enter another site eg. google.com i still get &quot;Can not resolve address&quot; or even if enter 192.168.1.x address i am still not routed to the web server. Does any one know how to do this?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p4613">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">kff322</div>
					<div class="post-datetime">
						14 Feb 2005, 03:00					</div>
				</div>
				<div class="post-content content">
					<p>How can I make it that when someone connects to my router via wireless,opens there web browser and does <a href="http://www.anywebsite.com">www.anywebsite.com</a> its points them to my WRt&#039;s web server 192.168.1.1. Mind that the WRT is alone and not connected to any other network</p><p>Cheers :!:</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p4614">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">Javiergonzalez00</div>
					<div class="post-datetime">
						14 Feb 2005, 04:09					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><p>How can I make it that when someone connects to my router via wireless,opens there web browser and does <a href="http://www.anywebsite.com">www.anywebsite.com</a> its points them to my WRt&#039;s web server 192.168.1.1. Mind that the WRT is alone and not connected to any other network</p><p>Cheers :!:</p></blockquote></div><p>$IPT -t nat -A PREROUTING -i $WIFI -p tcp --dport 80 -j REDIRECT --to-port 80</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p4615">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">kff322</div>
					<div class="post-datetime">
						14 Feb 2005, 05:09					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for your support although i get an error: -t not found. Im kind a linux n00b some help would be greatful</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p4626">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">sittingduck</div>
					<div class="post-datetime">
						14 Feb 2005, 21:03					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><p>Hello everyone!</p><p> I am using my WRT54G V2 as a web server and I want to make it so that anyone who connects to the wireless AP and enters any web site is automaticly redirected to the web server on the WRT at 192.168.1.1.<br />Cheers</p></blockquote></div><p>Exactly what i am doing and here is my firewall settings:<br />.<br />.<br />.<br />LAN=$(nvram get lan_ifname)<br />IPT=/usr/sbin/iptables</p><p># allow these MAC:s <br />$IPT -t nat -A PREROUTING -m mac --mac-source 00:12:21:29:1a:46 -i $LAN -j ACCEPT<br />$IPT -t nat -A PREROUTING -m mac --mac-source 00:33:48:ee:21:d3 -i $LAN -j ACCEPT<br /># deny ALL other traffic (redir to FW &amp; Log) <br />$IPT -t nat -A PREROUTING -p tcp -i $LAN -j DNAT --to 192.168.1.1<br />.<br />.<br />.</p><p>And make sure that your dhcp is right configured (GW &amp; DNS)</p><p>domain-needed<br />bogus-priv<br />filterwin2k<br />local=/lan/<br />domain=lan<br />except-interface=vlan1<br />dhcp-leasefile=/etc/dhcp.leases<br />dhcp-range=lan,192.168.1.30,static,255.255.255.0,12h<br />dhcp-range=lan,192.168.1.31,static,255.255.255.0,12h<br />dhcp-host=net:lan,00:12:21:29:1a:46,192.168.1.30<br />dhcp-host=net:lan,00:33:48:ee:21:d3,192.168.1.31<br />dhcp-option=lan,1,255.255.255.0<br />dhcp-option=lan,3,192.168.1.1<br />dhcp-option=lan,6,192.168.1.1</p><p>/S.D</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p4646">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">peterm</div>
					<div class="post-datetime">
						15 Feb 2005, 14:45					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>i need a transparent proxy that works with OpenWRT. But i need also a special feature of this proxy: like tinyproxy the transparent proxy must send (inject) a request header field with the clients ip address at the wifi interface.</p><p>Do you know if there is something out there, that can do this task ?</p><p>Thank you for your attention, Peter.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p4647">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">florian_</div>
					<div class="post-datetime">
						15 Feb 2005, 14:50					</div>
				</div>
				<div class="post-content content">
					<p>tinyproxy with transparent support has already been ported :</p><p><a href="http://openwrt.alphacore.net/tinyproxy_1.6.3_mipsel.ipk">http://openwrt.alphacore.net/tinyproxy_1.6.3_mipsel.ipk</a></p><p>It should fit to your need as is.</p><p>If the transparency is not working then add something like this to your existing firewall script :</p><div class="codebox"><pre><code>$IPT -t nat -A PREROUTING -i $WIFI -s 192.168.0.0/255.255.255.0 -p tcp -m tcp --dport 80 -j REDIRECT --to-port 8080</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p4648">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">peterm</div>
					<div class="post-datetime">
						15 Feb 2005, 18:02					</div>
				</div>
				<div class="post-content content">
					<p>Dear RItalMan,</p><p>many thanks for your response.</p><p>Yes, after some readings i realized that with iptables any proxy can be transparent.</p><p>So coming to my next stop: The proxy will put a header field with the clients ip address, but afterwards i need to redirect (any) request at port 80 to a specific address for authentification (login).</p><p>I think tinyproxy cannot do that. I think squid can with &quot;redirect_program&quot; option. Do you know of any redirect_program for squid for OpenWRT platform.</p><p>Again thank you for your attention,<br />Regards, Peter</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p4653">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">kff322</div>
					<div class="post-datetime">
						16 Feb 2005, 00:10					</div>
				</div>
				<div class="post-content content">
					<p>I tried inserting these commands using the &quot;NVRAM&quot; command or am i supposed to put these into some .conf file?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p4658">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">Jannes</div>
					<div class="post-datetime">
						16 Feb 2005, 02:11					</div>
				</div>
				<div class="post-content content">
					<p>/etc/init.d/S45firewall :</p><div class="codebox"><pre><code>LAN=$(nvram get lan_ifname)
IPT=/usr/sbin/iptables

# allow these MAC:s
$IPT -t nat -A PREROUTING -m mac --mac-source 00:12:21:29:1a:46 -i $LAN -j ACCEPT
$IPT -t nat -A PREROUTING -m mac --mac-source 00:33:48:ee:21:d3 -i $LAN -j ACCEPT
# deny ALL other traffic (redir to FW &amp; Log)
$IPT -t nat -A PREROUTING -p tcp -i $LAN -j DNAT --to 192.168.1.1 </code></pre></div><p>/etc/dnsmasq.conf<br /></p><div class="codebox"><pre><code>domain-needed
bogus-priv
filterwin2k
local=/lan/
domain=lan
except-interface=vlan1
dhcp-leasefile=/etc/dhcp.leases
dhcp-range=lan,192.168.1.30,static,255.255.255.0,12h
dhcp-range=lan,192.168.1.31,static,255.255.255.0,12h
dhcp-host=net:lan,00:12:21:29:1a:46,192.168.1.30
dhcp-host=net:lan,00:33:48:ee:21:d3,192.168.1.31
dhcp-option=lan,1,255.255.255.0
dhcp-option=lan,3,192.168.1.1
dhcp-option=lan,6,192.168.1.1</code></pre></div><p>Look in wiki documentation to see how to edit those files if they&#039;re read-only.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p34778">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">Fenix-TX</div>
					<div class="post-datetime">
						2 Oct 2006, 18:16					</div>
				</div>
				<div class="post-content content">
					<p>Hi! i put that rule and i have this message when i run the firewall script:</p><div class="codebox"><pre><code>root@OpenWrt:/etc/init.d# iptables -t nat -A PREROUTING -i eth1 -p tcp --dport 80 -j REDIRECT --to-ports 80
iptables v1.3.3: Unknown arg `--to-ports&#039;
Try `iptables -h&#039; or &#039;iptables --help&#039; for more information.</code></pre></div><p>I tried with --to-port and i have the same message, i&#039;m using whiterussian rc5</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>