<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Mount Points - dont work!... help</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 19 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p149253">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">d-Byte</div>
					<div class="post-datetime">
						22 Nov 2011, 08:41					</div>
				</div>
				<div class="post-content content">
					<p>from one day ago i back to openwrt, i has some problems again but some i solve it..</p><p>1. now the say what it is.. the sd card is mounted by his mod on /overlay!<br />working fine here.<br />but in the web-man &quot;System-&gt;Mount Points&quot;</p><p><span class="postimg"><img src="http://img827.imageshack.us/img827/751/51203041.png" alt="http://img827.imageshack.us/img827/751/51203041.png" /></span></p><br /><p>2. AutoMount SWAP File dont works!</p><p>the swapon command works fine if i type in shell</p><p>======<br />root@OpenWrt:~# free<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; total&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;used&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;free&nbsp; &nbsp; &nbsp; &nbsp;shared&nbsp; &nbsp; &nbsp; buffers<br />&nbsp; Mem:&nbsp; &nbsp; &nbsp; &nbsp; 14324&nbsp; &nbsp; &nbsp; &nbsp; 12972&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1352&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1624<br /> Swap:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br />Total:&nbsp; &nbsp; &nbsp; &nbsp; 14324&nbsp; &nbsp; &nbsp; &nbsp; 12972&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1352<br />root@OpenWrt:~# df<br />Filesystem&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1K-blocks&nbsp; &nbsp; &nbsp; Used Available Use% Mounted on<br />/dev/root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1728&nbsp; &nbsp; &nbsp; 1728&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 100% /rom<br />tmpfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;7160&nbsp; &nbsp; &nbsp; &nbsp;128&nbsp; &nbsp; &nbsp; 7032&nbsp; &nbsp;2% /tmp<br />/dev/mtdblock/4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;257404&nbsp; &nbsp; &nbsp;75180&nbsp; &nbsp; 169170&nbsp; 31% /overlay<br />mini_fo:/overlay&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1728&nbsp; &nbsp; &nbsp; 1728&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 100% /<br />/dev/sdcard/part1&nbsp; &nbsp; &nbsp; &nbsp;257404&nbsp; &nbsp; &nbsp;75180&nbsp; &nbsp; 169170&nbsp; 31% /overlay<br />root@OpenWrt:~# swapon /overlay/swap<br />root@OpenWrt:~# free<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; total&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;used&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;free&nbsp; &nbsp; &nbsp; &nbsp;shared&nbsp; &nbsp; &nbsp; buffers<br />&nbsp; Mem:&nbsp; &nbsp; &nbsp; &nbsp; 14324&nbsp; &nbsp; &nbsp; &nbsp; 12556&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1768&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1356<br /> Swap:&nbsp; &nbsp; &nbsp; &nbsp; 63992&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; 63992<br />Total:&nbsp; &nbsp; &nbsp; &nbsp; 78316&nbsp; &nbsp; &nbsp; &nbsp; 12556&nbsp; &nbsp; &nbsp; &nbsp; 65760<br />root@OpenWrt:~#<br />======<br />how it do it ?<br />1- dd if=/dev/zero of=/overlay/swap bs=1k count=*SIZE OF FILE*<br />2- mkswap /overlay/swap<br />3- swapon&nbsp; /overlay/swap</p><p>i have others partions on SD Card but again dont work mount for it..<br />======<br />root@OpenWrt:~# cd /dev/sdcard/<br />root@OpenWrt:/dev/sdcard# ls -al<br />drwxr-xr-x&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 Jan&nbsp; 1&nbsp; 1970 .<br />drwxr-xr-x&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0 Jan&nbsp; 1&nbsp; 1970 ..<br />brw-------&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp;254,&nbsp; &nbsp;0 Jan&nbsp; 1&nbsp; 1970 disc<br />brw-------&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp;254,&nbsp; &nbsp;1 Jan&nbsp; 1&nbsp; 1970 part1<br />brw-------&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp;254,&nbsp; &nbsp;2 Jan&nbsp; 1&nbsp; 1970 part2<br />brw-------&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp;254,&nbsp; &nbsp;3 Jan&nbsp; 1&nbsp; 1970 part3<br />======</p><p>Here is the dmesg <a href="http://pastebin.com/mZd5Xxug">http://pastebin.com/mZd5Xxug</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p149258">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">MBS</div>
					<div class="post-datetime">
						22 Nov 2011, 09:57					</div>
				</div>
				<div class="post-content content">
					<p>1: Your solution should work, but the preffered solution is to mount it to some mountpoint (lets call it /mnt/extroot) and mark it as the rootfilesystem in /etc/fstab. The wiki entry for extroot explains it.<br />2: Looks good to me.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p149292">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">d-Byte</div>
					<div class="post-datetime">
						22 Nov 2011, 16:51					</div>
				</div>
				<div class="post-content content">
					<p>i dont want only to replace /overlay because gives me an error with installation of more packages ... no free space on some drive/folder</p><p>now trying to <strong>whole_rootfs</strong> [ <a href="http://wiki.openwrt.org/doc/howto/extroot">http://wiki.openwrt.org/doc/howto/extroot</a> ]<br />sdcard by default is mounted on /sdcard</p><p>LOGz will say more :: <br /></p><div class="codebox"><pre><code>login as: root
root@192.168.1.1&#039;s password:


BusyBox v1.15.3 (2011-10-28 22:43:32 CEST) built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 Backfire (10.03.1-RC6, r28680) --------------------
  * 1/3 shot Kahlua    In a shot glass, layer Kahlua
  * 1/3 shot Bailey&#039;s  on the bottom, then Bailey&#039;s,
  * 1/3 shot Vodka     then Vodka.
 ---------------------------------------------------
root@core:~# df
Filesystem           1K-blocks      Used Available Use% Mounted on
/dev/root                 1728      1728         0 100% /rom
tmpfs                     7160       124      7036   2% /tmp
/dev/mtdblock/4           1536       488      1048  32% /overlay
mini_fo:/overlay          1728      1728         0 100% /
/dev/sdcard/part1       958488     25480    884320   3% /sdcard
root@core:~# mount
rootfs on / type rootfs (rw)
/dev/root on /rom type squashfs (ro)
none on /dev type devfs (rw)
none on /proc type proc (rw)
tmpfs on /tmp type tmpfs (rw,nosuid,nodev)
devpts on /dev/pts type devpts (rw)
/dev/mtdblock/4 on /overlay type jffs2 (rw)
mini_fo:/overlay on / type mini_fo (rw)
/dev/sdcard/part1 on /sdcard type ext3 (rw)
root@core:~# dd if=/dev/zero of=/sdcard/swap bs=1k count=32767
32767+0 records in
32767+0 records out
root@core:~# mkswap /sdcard/swap
Setting up swapspace version 1, size = 33549312 bytes
UUID=e01331f1-45ec-454b-ab8b-b8ee00046c01
root@core:~# free
              total         used         free       shared      buffers
  Mem:        14324        12960         1364            0          876
 Swap:            0            0            0
Total:        14324        12960         1364
root@core:~# swapon /sdcard/swap
root@core:~# free
              total         used         free       shared      buffers
  Mem:        14324        12844         1480            0          896
 Swap:        32756            0        32756
Total:        47080        12844        34236
root@core:~# reboot
root@core:~#</code></pre></div><p>i put in /etc/config/fstab<br />config mount <br />option target / <br />option device /sdcard<br />option fstype ext3 <br />option options rw,sync <br />option enabled 1 <br />option enabled_fsck 0</p><p>the file system in &quot;mount points&quot; show me the /sdcard is filesystem of /dev/sdcard/part1</p><div class="codebox"><pre><code>root@core:~# mkfs.ext3 /dev/sdcard/part1
mke2fs 1.41.11 (14-Mar-2010)
Filesystem label=
OS type: Linux
Block size=4096 (log=2)
Fragment size=4096 (log=2)
Stride=0 blocks, Stripe width=0 blocks
60928 inodes, 243456 blocks
12172 blocks (5.00%) reserved for the super user
First data block=0
Maximum filesystem blocks=251658240
8 block groups
32768 blocks per group, 32768 fragments per group
7616 inodes per group
Superblock backups stored on blocks:
        32768, 98304, 163840, 229376

Writing inode tables: done
Creating journal (4096 blocks): done
Writing superblocks and filesystem accounting information: done

This filesystem will be automatically checked every 23 mounts or
180 days, whichever comes first.  Use tune2fs -c or -i to override.</code></pre></div><p>mkdir /tmp/cproot<br />mount --bind / /tmp/cproot<br />tar -C /tmp/cproot -cvf - . | tar -C /sdcard -xvf -<br />umount /tmp/cproot</p>											<p class="post-edited">(Last edited by <strong>d-Byte</strong> on 22 Nov 2011, 17:09)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p149316">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">MBS</div>
					<div class="post-datetime">
						22 Nov 2011, 21:11					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>d-Byte wrote:</cite><blockquote><p>option device /sdcard</p></blockquote></div><p>You probably want this to be /dev/sdcard/part1.<br />About your swap issue: <a href="http://wiki.openwrt.org/doc/uci/fstab">http://wiki.openwrt.org/doc/uci/fstab</a><br />It&#039;s probably easiest and safest to use a swap partition instead of a file. Otherwise you would need to make sure the filesystem is mounted before the swapfile will be accessed.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>