<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> iptables logging</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 5 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p171135">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">slthomason</div>
					<div class="post-datetime">
						28 Jun 2012, 08:07					</div>
				</div>
				<div class="post-content content">
					<p>Hi there,</p><p>I am trying to get a simple logging iptables rule like this working to log all traffic info coming into the router on port 443:</p><div class="codebox"><pre><code>iptables -I INPUT -i br-lan -p tcp --dport 443 -j LOG</code></pre></div><p>But I must be missing some packages.&nbsp; So far I have these packages installed:</p><p>iptables <br />iptables-mod-conntrack<br />iptables-mod-extra <br />iptables-mod-iprange<br />iptables-mod-nat </p><p>along with their corresponding kmod.&nbsp; Am I missing a package?&nbsp; Is my iptable rule wrong for this?&nbsp; I just haven&#039;t been able to even get anything logging, so I am suspect that I am missing a package needed.&nbsp; Please let me know.</p><p>Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p171251">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">slthomason</div>
					<div class="post-datetime">
						29 Jun 2012, 18:20					</div>
				</div>
				<div class="post-content content">
					<p>Bump.&nbsp; Anyone have any ideas on this one?&nbsp; Anyone done any iptables logging?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p171264">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						29 Jun 2012, 21:39					</div>
				</div>
				<div class="post-content content">
					<p>Logging support is part of the standard iptables package and the above rule works for me.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p171272">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">slthomason</div>
					<div class="post-datetime">
						29 Jun 2012, 23:12					</div>
				</div>
				<div class="post-content content">
					<p>Hmmm .... I must be doing something wrong.&nbsp; Just to make sure I am not making a dumb mistake - it was logging to /tmp/log/messages, right?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p171273">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						29 Jun 2012, 23:24					</div>
				</div>
				<div class="post-content content">
					<p>No, it logs to dmesg, you should be able to see the messages with &quot;logread&quot;.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p171274">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">slthomason</div>
					<div class="post-datetime">
						29 Jun 2012, 23:45					</div>
				</div>
				<div class="post-content content">
					<p>Hmmm ... maybe that is what I was missing.&nbsp; Is there a way to change where it logs to?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p171282">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						30 Jun 2012, 01:31					</div>
				</div>
				<div class="post-content content">
					<p>Not directly, you can only configure the log server (syslogd, klogd) or replace them with syslog-ng to implement more sophisticated logging (e.g. some messages to a file, rest via network)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p171283">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">slthomason</div>
					<div class="post-datetime">
						30 Jun 2012, 01:45					</div>
				</div>
				<div class="post-content content">
					<p>Sounds good.&nbsp; I will look into that.&nbsp; Thanks for the response!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p171405">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">slthomason</div>
					<div class="post-datetime">
						3 Jul 2012, 08:55					</div>
				</div>
				<div class="post-content content">
					<p>Any idea what would cause this:</p><p>root@ph:/# logread<br />logread: can&#039;t find syslogd buffer: No such file or directory</p><p>Not sure what would cause that.&nbsp; Any ideas?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p172492">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">slthomason</div>
					<div class="post-datetime">
						17 Jul 2012, 10:55					</div>
				</div>
				<div class="post-content content">
					<p>I have tried to hunt down regarding the error message shown above:</p><p>root@ph:/# logread<br />logread: can&#039;t find syslogd buffer: No such file or directory</p><p>but with no luck.&nbsp; I am guess that this is the reason I am not getting logs either.&nbsp; </p><p>Anyone have any idea what would cause that?&nbsp; When I strace logread I get this:</p><div class="codebox"><pre><code>root@ph:~# strace logread
execve(&quot;/sbin/logread&quot;, [&quot;logread&quot;], [/* 10 vars */]) = 0
old_mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS|0x4000000,                                      -1, 0) = 0x2ba73000
stat(&quot;/etc/ld.so.cache&quot;, 0x7fa030e0)    = -1 ENOENT (No such file or directory)
open(&quot;/lib/libcrypt.so.0&quot;, O_RDONLY)    = 3
fstat(3, {st_mode=S_IFREG|0755, st_size=9824, ...}) = 0
old_mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS|0x4000000,                                      -1, 0) = 0x2ba74000
read(3, &quot;\177ELF\1\2\1\0\0\0\0\0\0\0\0\0\0\3\0\10\0\0\0\1\0\0\4`\0\0\0004&quot;..., 4                                     096) = 4096
old_mmap(NULL, 147456, PROT_NONE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2ba84000
old_mmap(0x2ba84000, 9756, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_FIXED, 3, 0) = 0                                     x2ba84000
old_mmap(0x2ba96000, 1632, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED, 3, 0x200                                     0) = 0x2ba96000
old_mmap(0x2ba97000, 67808, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANON                                     YMOUS, -1, 0) = 0x2ba97000
close(3)                                = 0
munmap(0x2ba74000, 4096)                = 0
open(&quot;/lib/libm.so.0&quot;, O_RDONLY)        = 3
fstat(3, {st_mode=S_IFREG|0755, st_size=84116, ...}) = 0
old_mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS|0x4000000,                                      -1, 0) = 0x2ba74000
read(3, &quot;\177ELF\1\2\1\0\0\0\0\0\0\0\0\0\0\3\0\10\0\0\0\1\0\0\26\0\0\0\0004&quot;...,                                      4096) = 4096
old_mmap(NULL, 151552, PROT_NONE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2baa8000
old_mmap(0x2baa8000, 83664, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_FIXED, 3, 0) =                                      0x2baa8000
old_mmap(0x2bacc000, 2196, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED, 3, 0x140                                     00) = 0x2bacc000
close(3)                                = 0
munmap(0x2ba74000, 4096)                = 0
open(&quot;/lib/libgcc_s.so.1&quot;, O_RDONLY)    = 3
fstat(3, {st_mode=S_IFREG|0644, st_size=76936, ...}) = 0
old_mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS|0x4000000,                                      -1, 0) = 0x2ba74000
read(3, &quot;\177ELF\1\2\1\0\0\0\0\0\0\0\0\0\0\3\0\10\0\0\0\1\0\0006\320\0\0\0004&quot;..                                     ., 4096) = 4096
old_mmap(NULL, 143360, PROT_NONE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2bacd000
old_mmap(0x2bacd000, 76528, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_FIXED, 3, 0) =                                      0x2bacd000
old_mmap(0x2baef000, 3208, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED, 3, 0x120                                     00) = 0x2baef000
close(3)                                = 0
munmap(0x2ba74000, 4096)                = 0
open(&quot;/lib/libc.so.0&quot;, O_RDONLY)        = 3
fstat(3, {st_mode=S_IFREG|0755, st_size=351360, ...}) = 0
old_mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS|0x4000000,                                      -1, 0) = 0x2ba74000
read(3, &quot;\177ELF\1\2\1\0\0\0\0\0\0\0\0\0\0\3\0\10\0\0\0\1\0\0\234@\0\0\0004&quot;...,                                      4096) = 4096
old_mmap(NULL, 438272, PROT_NONE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2baf0000
old_mmap(0x2baf0000, 343436, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_FIXED, 3, 0) =                                      0x2baf0000
old_mmap(0x2bb54000, 7296, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED, 3, 0x540                                     00) = 0x2bb54000
old_mmap(0x2bb56000, 17092, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANON                                     YMOUS, -1, 0) = 0x2bb56000
close(3)                                = 0
munmap(0x2ba74000, 4096)                = 0
open(&quot;/lib/libc.so.0&quot;, O_RDONLY)        = 3
fstat(3, {st_mode=S_IFREG|0755, st_size=351360, ...}) = 0
close(3)                                = 0
open(&quot;/lib/libc.so.0&quot;, O_RDONLY)        = 3
fstat(3, {st_mode=S_IFREG|0755, st_size=351360, ...}) = 0
close(3)                                = 0
open(&quot;/lib/libc.so.0&quot;, O_RDONLY)        = 3
fstat(3, {st_mode=S_IFREG|0755, st_size=351360, ...}) = 0
close(3)                                = 0
stat(&quot;/lib/ld-uClibc.so.0&quot;, {st_mode=S_IFREG|0755, st_size=28980, ...}) = 0
old_mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS|0x4000000,                                      -1, 0) = 0x2ba74000
set_thread_area(0x2ba7b2d0)             = 0
mprotect(0x2bb54000, 4096, PROT_READ)   = 0
mprotect(0x2ba82000, 4096, PROT_READ)   = 0
ioctl(0, TIOCNXCL, {B38400 opost isig icanon echo ...}) = 0
ioctl(1, TIOCNXCL, {B38400 opost isig icanon echo ...}) = 0
getuid()                                = 0
ipc(0x17, 0x414e4547, 0, 0, 0, 0)       = -1 ENOENT (No such file or directory)
brk(0)                                  = 0xa1d000
brk(0xa1e000)                           = 0xa1e000
brk(0xa1f000)                           = 0xa1f000
brk(0xa20000)                           = 0xa20000
write(2, &quot;logread: can&#039;t find syslogd buff&quot;..., 62logread: can&#039;t find syslogd bu                                     ffer: No such file or directory
) = 62
exit_group(1)                           = ?</code></pre></div><p>help!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p172587">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">slthomason</div>
					<div class="post-datetime">
						18 Jul 2012, 08:16					</div>
				</div>
				<div class="post-content content">
					<p>So I flashed an RS Pro to the latest and greatest firmware (<a href="http://downloads.openwrt.org/snapshots/trunk/ar71xx/openwrt-ar71xx-generic-ubnt-rspro-jffs2-factory.bin">http://downloads.openwrt.org/snapshots/ … actory.bin</a>) and logread works.&nbsp; So I added the iptables rule that we discussed at first:</p><p>iptables -I INPUT -i br-lan -p tcp --dport 443 -j LOG</p><p>And it added without error.&nbsp; However, I then go and browse on the client and it doesn&#039;t leave any logs.</p><p>Ideas?</p><p>Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p172590">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">ninno</div>
					<div class="post-datetime">
						18 Jul 2012, 08:39					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>slthomason wrote:</cite><blockquote><p>iptables -I INPUT -i br-lan -p tcp --dport 443 -j LOG</p></blockquote></div><p>Should work, does your rule count any packets?<br />iptables -L INPUT -v -n</p><p>If not, maybe try without specifying the interface first.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p172591">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">slthomason</div>
					<div class="post-datetime">
						18 Jul 2012, 08:44					</div>
				</div>
				<div class="post-content content">
					<p>root@OpenWrt:/tmp/log# iptables -L INPUT -v -n<br />Chain INPUT (policy ACCEPT 0 packets, 0 bytes)<br /> pkts bytes target&nbsp; &nbsp; &nbsp;prot opt in&nbsp; &nbsp; &nbsp;out&nbsp; &nbsp; &nbsp;source&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;destination<br />&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp;0 LOG&nbsp; &nbsp; &nbsp; &nbsp; tcp&nbsp; --&nbsp; br-lan *&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;tcp dpt:443 LOG flags 0 level 4<br />&nbsp; 428&nbsp; 337K ACCEPT&nbsp; &nbsp; &nbsp;all&nbsp; --&nbsp; *&nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ctstate RELATED,ESTABLISHED<br />&nbsp; &nbsp;12&nbsp; &nbsp;790 ACCEPT&nbsp; &nbsp; &nbsp;all&nbsp; --&nbsp; lo&nbsp; &nbsp; &nbsp;*&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0/0<br />&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp;0 syn_flood&nbsp; tcp&nbsp; --&nbsp; *&nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;tcp flags:0x17/0x02<br />&nbsp; 113 11073 input_rule&nbsp; all&nbsp; --&nbsp; *&nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0/0<br />&nbsp; 113 11073 input&nbsp; &nbsp; &nbsp; all&nbsp; --&nbsp; *&nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0/0</p><br /><p>So you are saying to try it like this:</p><p>iptables -I INPUT -p tcp --dport 443 -j LOG</p><p>?</p><p>I tried that, and then the count looked like this:<br />root@OpenWrt:/# iptables -L INPUT -v -n<br />Chain INPUT (policy ACCEPT 0 packets, 0 bytes)<br /> pkts bytes target&nbsp; &nbsp; &nbsp;prot opt in&nbsp; &nbsp; &nbsp;out&nbsp; &nbsp; &nbsp;source&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;destination<br />&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp;0 LOG&nbsp; &nbsp; &nbsp; &nbsp; tcp&nbsp; --&nbsp; *&nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;tcp dpt:443 LOG flags 0 level 4<br />&nbsp; &nbsp;55&nbsp; 9766 ACCEPT&nbsp; &nbsp; &nbsp;all&nbsp; --&nbsp; *&nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ctstate RELATED,ESTABLISHED<br />&nbsp; &nbsp; 8&nbsp; &nbsp;544 ACCEPT&nbsp; &nbsp; &nbsp;all&nbsp; --&nbsp; lo&nbsp; &nbsp; &nbsp;*&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0/0<br />&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp;0 syn_flood&nbsp; tcp&nbsp; --&nbsp; *&nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;tcp flags:0x17/0x02<br />&nbsp; &nbsp;16&nbsp; 1442 input_rule&nbsp; all&nbsp; --&nbsp; *&nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0/0<br />&nbsp; &nbsp;16&nbsp; 1442 input&nbsp; &nbsp; &nbsp; all&nbsp; --&nbsp; *&nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0/0</p><p>Your help is very appreciated.&nbsp; Again - this is a vanilla, freshly flashed router.</p><p>Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p172594">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">ninno</div>
					<div class="post-datetime">
						18 Jul 2012, 09:15					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>slthomason wrote:</cite><blockquote><p>So you are saying to try it like this:</p><p>iptables -I INPUT -p tcp --dport 443 -j LOG</p><p>I tried that, and then the count looked like this:<br />root@OpenWrt:/# iptables -L INPUT -v -n<br />Chain INPUT (policy ACCEPT 0 packets, 0 bytes)<br /> pkts bytes target&nbsp; &nbsp; &nbsp;prot opt in&nbsp; &nbsp; &nbsp;out&nbsp; &nbsp; &nbsp;source&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;destination<br />&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp;0 LOG&nbsp; &nbsp; &nbsp; &nbsp; tcp&nbsp; --&nbsp; *&nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;tcp dpt:443 LOG flags 0 level 4<br />&nbsp; &nbsp;55&nbsp; 9766 ACCEPT&nbsp; &nbsp; &nbsp;all&nbsp; --&nbsp; *&nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ctstate RELATED,ESTABLISHED<br />&nbsp; &nbsp; 8&nbsp; &nbsp;544 ACCEPT&nbsp; &nbsp; &nbsp;all&nbsp; --&nbsp; lo&nbsp; &nbsp; &nbsp;*&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0/0<br />&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp;0 syn_flood&nbsp; tcp&nbsp; --&nbsp; *&nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;tcp flags:0x17/0x02<br />&nbsp; &nbsp;16&nbsp; 1442 input_rule&nbsp; all&nbsp; --&nbsp; *&nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0/0<br />&nbsp; &nbsp;16&nbsp; 1442 input&nbsp; &nbsp; &nbsp; all&nbsp; --&nbsp; *&nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;0.0.0.0/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0.0.0/0</p><p>Your help is very appreciated.&nbsp; Again - this is a vanilla, freshly flashed router.</p><p>Thanks!</p></blockquote></div><p>Yes, thats what i meant, but the counter still does not show any hits, so it cant have logged anything:</p><div class="codebox"><pre><code> pkts bytes target     prot opt in     out     source               destination
    0     0 LOG        tcp  --  *      *       0.0.0.0/0            0.0.0.0/0           tcp dpt:443 LOG flags 0 level 4</code></pre></div><p>To be clear: you tried to access the IP of your router, not any other client on the network (telnet &lt;ip-of-your-router&gt; 443)?<br />The INPUT rule only matches packets directed to the router itself.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p172596">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">slthomason</div>
					<div class="post-datetime">
						18 Jul 2012, 09:27					</div>
				</div>
				<div class="post-content content">
					<p>What I am trying to do is capture the requested IP address of every request on port 443 going thru the router.&nbsp; i.e. If I hit <a href="https://facebook.com">https://facebook.com</a> from the browser on the client, I would like to see the corresponding IP address logged on the router (in my case - 66.220.149.11).&nbsp; Does that makes sense?</p><p>Thanks for your help!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p172670">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">ninno</div>
					<div class="post-datetime">
						18 Jul 2012, 22:02					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>slthomason wrote:</cite><blockquote><p>What I am trying to do is capture the requested IP address of every request on port 443 going thru the router.&nbsp; i.e. If I hit <a href="https://facebook.com">https://facebook.com</a> from the browser on the client, I would like to see the corresponding IP address logged on the router (in my case - 66.220.149.11).&nbsp; Does that makes sense?</p><p>Thanks for your help!</p></blockquote></div><p>Well, in this case you need the forwarding queue:</p><p>iptables -I FORWARD -p tcp --dport 443 -j LOG</p><p>This will cause a lot of logging, you should limit that, for example only to new connections<br />iptables -I FORWARD -p tcp --dport 443 -m state --state NEW -j LOG</p><p>Where you can catch which packet you can see in the diagram for example:<br /><a href="http://en.wikipedia.org/wiki/Iptables">http://en.wikipedia.org/wiki/Iptables</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p172767">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">slthomason</div>
					<div class="post-datetime">
						19 Jul 2012, 19:27					</div>
				</div>
				<div class="post-content content">
					<p>awesome!&nbsp; That is what I was missing.&nbsp; Thanks a ton for your help!</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>