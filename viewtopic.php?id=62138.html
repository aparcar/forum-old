<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Slow Samba Transfer rate on Openwrt X86 builds</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 30 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p307473">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">remlei</div>
					<div class="post-datetime">
						13 Jan 2016, 12:56					</div>
				</div>
				<div class="post-content content">
					<p>my spec is this:</p><p>- Atom 330 based motherboard with ich7r 4 sata port (raid 5) intel based ITX platform<br />- 4GB RAM<br />- 4 x 4TB WD RED<br />- 150watt PSU.<br />- ext4 formatted</p><p>On my homebrew NAS, it can attain upto 95mB/s (megabyte) transfer rate on Samba and 50mB/s on NFS which is based on Arch Linux OS. </p><p>Since my homebew NAS is just sitting idle most of the time, I decided to just combine everything as one with OpenWRT x86 builds acting as a router and a NAS, went ahead and downloaded the SDK and enabled the intel raid controllers on it. Which works fine and able to detect my drive parody just fine and mounted.</p><p>The weird thing is I cant past 29-30mB/s transfer rate, which is pathetically slow compared to my Arch Linux install, I lost abouit 120% of the performance that im formerly getting. then I think maybe the low MTU is the issue, but nah, my arch linux install is also using the same MTU size.</p><p>I did try using both generic and x64 build, none of them makes the difference. Tried tweaking a little on samba config, which I gain about 5-6mB/s speed, but that&#039;s still too slow.</p><p>I tried disable the RAID and just put a single SSD on it, and still same performance im getting.</p><p>Tried using the trunk build, which im avoiding as long as possible, still the same performance im getting.</p><p>Tried using older builds, they did far more worst than the current stable build (CC).</p><p>Any thoughts? Or OpenWRT is just not optimized on my build?<br />Any tweaks/patch that I can do?</p><p>edit: one thing that I found is one of the thread in my CPU is maxed out while the other one is sitting almost idle. maybe this is the issue but my arch install with samba able to manage to maxed out the one cpu thread and 25% on the other one while transferring files over 95mB/s (average 86mB/s).</p><p>tried disable HT if that helps, but nah still the same.</p>											<p class="post-edited">(Last edited by <strong>remlei</strong> on 13 Jan 2016, 13:07)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p307700">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">discrucio</div>
					<div class="post-datetime">
						15 Jan 2016, 04:39					</div>
				</div>
				<div class="post-content content">
					<p>If you have a working buildroot you could try building an updated samba package, and enable SMB3.</p><p>Code:<br /><a href="https://github.com/wongsyrone/openwrt-1/tree/master/package/external/samba40related/samba4">https://github.com/wongsyrone/openwrt-1 … ted/samba4</a></p><p>Further tuning in smb.conf, though your x86 platform should be plenty sufficient:<br /><a href="https://linuxengineering.wordpress.com/2014/08/03/performance-tuning-with-pogoplug-v4/">https://linuxengineering.wordpress.com/ … goplug-v4/</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p307704">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">RangerZ</div>
					<div class="post-datetime">
						15 Jan 2016, 06:30					</div>
				</div>
				<div class="post-content content">
					<p>I have a PC-Engines ALIX w 100mb Ethernet.&nbsp; I use an x86 version from downloads, currently CC RC2.&nbsp; I have a USB thumb drive in this and I test speed with Tutosoft Lan Speedtest Lit 1.3.&nbsp; I am getting about 70-73 up and down over a handful of tests.</p><p>I also have a TP-Link WDR3600 on DD-WRT and get bout 172 up and 120 down.&nbsp; All but the ALIX is GB.</p><p>I have done nothing special, but using EXT3 formatted devices, clients are windows.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>