<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Set a hotspot with Captive portal But NO internet connection.</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 23 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p213123">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">hansnyc</div>
					<div class="post-datetime">
						25 Sep 2013, 07:25					</div>
				</div>
				<div class="post-content content">
					<p>We want to create a wifi hotspot. Using obviously a wifi router, people who sign on to this network will see a captive portal page and be redirected to a locally hosted webpage. This set up must work WITHOUT an internet connection.<br />This is for an interactive art installation. We attendees in the exhibit will use their phone to connect with a projection, using websocket connection.<br />But the location does not have internet.<br />So we want people to connect to the router, get the captive portal page to come up and redirect them to a locally hosted webpage on our machine in the exhibit.<br />We are totally newbie to openwrt and would much appreciate a walkthrough on what to install and how to modify the firmware and settings to set this up.<br />Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p213555">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">joky</div>
					<div class="post-datetime">
						30 Sep 2013, 19:22					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>usually the process is as following:</p><p>1.) Client register into WiFi<br />2.) Client asks for IP-Adress (DHCP)<br />3.) DHCP-Server returns IP-Adress and some configuration (DNS Server, Gateway)<br />4.) Client opens a web-page (iPhone and other mobile devices check for this automatically, others have to open a web-browser manually).<br />5.) Requested Domain is beeing resolved to somewhere, eg. the captive portal<br />6.) Router redirects to Captive Portal</p><p>1. - 4.) is no problem with standard OpenWRT<br />5.) the DNS query must be answered either by using an internet connection (DNS Masquerading) or by faking the domains, eg. redirecting <a href="http://www.google.com">www.google.com</a> to 192.168.1.254<br />6.) Redirection can be realized either by a captive portal software or with a simple NAT-Forwarding rule in the routers firewall. Redirect should lead to a server and generate a &quot;HTTP/1.1 302 - Temporary moved&quot; which leads to the real webserver.</p><p>This is theoretically all you need, but as you see there are a lot of services to configure. If you need any specific help let me know.</p><p>regards</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p213573">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">hansnyc</div>
					<div class="post-datetime">
						1 Oct 2013, 02:04					</div>
				</div>
				<div class="post-content content">
					<p>Thanks Joky,</p><p>So you are saying that we might not even need openwrt?</p><p>Is that something you could help us set up?</p><p>We could use a freelancer&#039;s help on this.</p><p>Can you walk us through how to set this up?</p><p>We have a linksys WRT54GL v1.1</p><p>Thank you so much for your response and your time.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p213627">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">sash-kan</div>
					<div class="post-datetime">
						1 Oct 2013, 19:05					</div>
				</div>
				<div class="post-content content">
					<p>f.e., your &quot;captive portal&quot;/&quot;locally hosted webserver&quot; is connected to the router and has ip-address 192.168.1.2<br />all you need is to add a line to /etc/dnsmasq.conf:<br /></p><div class="codebox"><pre><code>address=/#/192.168.1.2</code></pre></div><p>and reboot the router.</p>											<p class="post-edited">(Last edited by <strong>sash-kan</strong> on 1 Oct 2013, 19:06)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p231650">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">DAAVE</div>
					<div class="post-datetime">
						29 Apr 2014, 01:25					</div>
				</div>
				<div class="post-content content">
					<p>Hi ! I am facing the same problem !<br />trying to set up an offline captive portal with a splash page...<br />Any success ?<br />Any help would be highly appreciated.<br />Thank you so much.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p279386">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">sajjadhalai</div>
					<div class="post-datetime">
						9 Jun 2015, 10:14					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>joky wrote:</cite><blockquote><p>Hi,</p><p>usually the process is as following:</p><p>1.) Client register into WiFi<br />2.) Client asks for IP-Adress (DHCP)<br />3.) DHCP-Server returns IP-Adress and some configuration (DNS Server, Gateway)<br />4.) Client opens a web-page (iPhone and other mobile devices check for this automatically, others have to open a web-browser manually).<br />5.) Requested Domain is beeing resolved to somewhere, eg. the captive portal<br />6.) Router redirects to Captive Portal</p><p>1. - 4.) is no problem with standard OpenWRT<br />5.) the DNS query must be answered either by using an internet connection (DNS Masquerading) or by faking the domains, eg. redirecting <a href="http://www.google.com">www.google.com</a> to 192.168.1.254<br />6.) Redirection can be realized either by a captive portal software or with a simple NAT-Forwarding rule in the routers firewall. Redirect should lead to a server and generate a &quot;HTTP/1.1 302 - Temporary moved&quot; which leads to the real webserver.</p><p>This is theoretically all you need, but as you see there are a lot of services to configure. If you need any specific help let me know.</p><p>regards</p></blockquote></div><br /><p>Dear, Can u explain me Number 5 , how can i resolve it by faking domains..i want to that should be without internet<br />adn number 6 had solved.. by using nodogsplash, or nat forwarding rules, <br /></p><div class="codebox"><pre><code> iptables -t nat -I PREROUTING -j DNAT -s $IP -p tcp --to-destination $AP
iptables -t nat -I PREROUTING -j DNAT -s $IP -p udp --to-destination $AP</code></pre></div><p>i did it worked but when no internet connection it didnt, so plz only number 5 can u plz help me.<br />i got some help from here plz...<a href="https://forum.openwrt.org/viewtopic.php?id=57082">https://forum.openwrt.org/viewtopic.php?id=57082</a></p>											<p class="post-edited">(Last edited by <strong>sajjadhalai</strong> on 9 Jun 2015, 10:38)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p279627">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">KHAN85</div>
					<div class="post-datetime">
						10 Jun 2015, 20:18					</div>
				</div>
				<div class="post-content content">
					<p>sajjadhalai see the previous reply of sash-kan to fake domains with dnsmasq.</p><p>another tips:<br />-force dns with iptables to dnsmasq server (for users with another dns servers set)<br />-modify dnsmasq code to change dns-responses TTL to 0 (to avoid errors when user reconnect to internet and avoid connections to previous fake domains).</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>