<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> TP-Link TL-WR1043ND v1.8 and a 3G USB modem?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 28 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p199706">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">blankcat</div>
					<div class="post-datetime">
						26 Apr 2013, 11:27					</div>
				</div>
				<div class="post-content content">
					<p>Hello, this is my first post here since few days of reading anything and everything I could find <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>The router is as stated above TP-Link TL-WR1043ND v1.8. <br />The USB modem is a Huawei E173-u2, unlocked.<br />Couple of days ago I flashed the router with Attitude Adjustment 12.09-rc1.</p><p>And my question is about getting to work the 3G modem through the USB port, that I&#039;d like to test if could work. I am not familiar at all with Linux and maybe that leaded me here posting this.</p><p>I am not sure if I am in the right step in my router, but I entered a page in the interface, where I could change the WAN port settings. There was something like HSPA/UMTS and similar, but when I tried to use it, the interface says that I have to download &quot;comgt&quot;. I have found a file, named &quot;comgt_0.32-21_ar71xx.ipk&quot;, but I am unable to add it in the software section of the router.</p><p>And since my only internet comes through the 3G modem, I am so far unable to test if I can install it when I connect the router through the WAN port to an ISP. </p><p>So I am asking for a bit of help, that could lead me to better understand what I am doing, and where I am doing wrong <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></p><p>Thank you in advance.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p199819">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">blankcat</div>
					<div class="post-datetime">
						27 Apr 2013, 08:35					</div>
				</div>
				<div class="post-content content">
					<p>Bumping this up a bit.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p200011">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">blankcat</div>
					<div class="post-datetime">
						29 Apr 2013, 11:52					</div>
				</div>
				<div class="post-content content">
					<p>Any reference to me about reading a topic, either in English or Russian, would come in handy too. </p><p>Thank you in advance.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p200084">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">sle85276</div>
					<div class="post-datetime">
						29 Apr 2013, 21:01					</div>
				</div>
				<div class="post-content content">
					<p><a href="http://wiki.openwrt.org/doc/techref/opkg">http://wiki.openwrt.org/doc/techref/opkg</a> may solve your installation problems</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p200090">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">blankcat</div>
					<div class="post-datetime">
						29 Apr 2013, 21:20					</div>
				</div>
				<div class="post-content content">
					<p>Alright, I could say I pretty much understand what&#039;s in the wiki, but what if I am not a Linux user? </p><p>At least can I ask for a recommendation of a good emulator and Linux distribution for Win7? I am 50% sure I can manage with command line only, but if there is anything graphic to east my efforts, I would appreciate it <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p200102">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">angelos</div>
					<div class="post-datetime">
						29 Apr 2013, 23:03					</div>
				</div>
				<div class="post-content content">
					<p>The procedure is very easy.<br />First you install the necessary packages and then you configure things.<br />From the command line:</p><div class="codebox"><pre><code>opkg install comgt</code></pre></div><div class="codebox"><pre><code>opkg install kmod-usb2</code></pre></div><p>(I suppose the router has a USB 2.0 port, if it has a USB 1.1 port, you have to install kmod-usb-ohci and/or kmod-usb-uhci)<br /></p><div class="codebox"><pre><code>opkg install kmod-usb-serial</code></pre></div><div class="codebox"><pre><code>opkg install kmod-usb-serial-option</code></pre></div><div class="codebox"><pre><code>opkg install kmod-usb-serial-wwan</code></pre></div><p>(This is not needed because the previous package [serial-option] will install it anyway).<br /></p><div class="codebox"><pre><code>opkg install kmod-usb-acm</code></pre></div><div class="codebox"><pre><code>opkg install usb-modeswitch</code></pre></div><div class="codebox"><pre><code>opkg install usb-modeswitch-data</code></pre></div><div class="codebox"><pre><code>opkg install sdparm</code></pre></div><div class="codebox"><pre><code>opkg install luci-proto-3g</code></pre></div><p>Then you add these lines to /etc/config/network:<br />(Enter your PIN and the APN of your mobile provider. You may have to enter a different /dev/ttyUSB* device, it depends on your config, check /dev/ for device names).</p><div class="codebox"><pre><code>config interface &#039;wan2&#039;
    option ifname &#039;ppp0&#039;
    option pincode &#039;1234&#039;
    option device &#039;/dev/ttyUSB0&#039;
    option apn &#039;internet&#039;
    option service &#039;umts&#039;
    option proto &#039;3g&#039;
    option auto &#039;0&#039;</code></pre></div><p>And finally, you adjust the dial-out string in /etc/chatscripts/3g.chat<br />For example, my provider requires this...<br /></p><div class="codebox"><pre><code>&quot;ATD*99#&quot;</code></pre></div><p>You can also add this line to the script:<br /></p><div class="codebox"><pre><code>OK      &quot;AT+CSQ&quot;</code></pre></div><p>This will print the Signal Quality in the system log.</p><p>Also, add &quot;wan2&quot; interface in zone wan, in /etc/config/firewall<br />for example:<br />--------------------------------------------------<br />config zone&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; option name &#039;wan&#039;&nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; option input &#039;REJECT&#039;&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; option output &#039;ACCEPT&#039; <br />&nbsp; &nbsp; &nbsp; &nbsp; option forward &#039;REJECT&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option masq &#039;1&#039;&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; option mtu_fix &#039;1&#039;&nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; option network &#039;wan <strong>wan2</strong>&#039;<br />--------------------------------------------------</p><p>Reboot and you are ready to go. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>PS:<br />If your router has no access to the Internet and you need to make all the above in offline mode, download the &quot;packages&quot; folder from the OpenWrt server using wget for example, setup a http/ftp server on your pc and put the packages folder there (if you are using windows you can install Xampp), give your NIC a static IP and change the line in /etc/opkg.conf so it points to your server.</p><p>Also, if you are not familiar with the unix/linux &quot;vi&quot; command (needed to make changes in the above files), install nano which is a much easier editor.</p>											<p class="post-edited">(Last edited by <strong>angelos</strong> on 29 Apr 2013, 23:48)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p200125">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">blankcat</div>
					<div class="post-datetime">
						30 Apr 2013, 00:40					</div>
				</div>
				<div class="post-content content">
					<p>Thank you. Will post the results here, if anyone is interested. Downloading Ubuntu now, but will try both it and in Win.</p><p>Just don&#039;t expect any results in short timeline <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>											<p class="post-edited">(Last edited by <strong>blankcat</strong> on 30 Apr 2013, 00:41)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>