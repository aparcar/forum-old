<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Bidirectional gpio in adm5120 - how to?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 2 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p68488">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">gorec</div>
					<div class="post-datetime">
						21 May 2008, 12:09					</div>
				</div>
				<div class="post-content content">
					<p>Help please - i want use 5120 for smart home apllication - how i can use gpio on latest svn kamikaze for input in userspace?<br />some like a <br />cat /dev/gpioXX<br />or <br />cat /proc/dev/gpioxx<br />and how i can change gpio directional - for output or input like a<br />echo &quot;input&quot; &gt; /dev/gpioXX <br />echo &quot;output&quot; &gt; /dev/gpioXX <br />or similar...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p68500">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">gorec</div>
					<div class="post-datetime">
						21 May 2008, 16:51					</div>
				</div>
				<div class="post-content content">
					<p>I can&#039;t find how make char device wich work with gpio for input... help me please...<br />i inet i found only <a href="http://www.sunspot.co.uk/Projects/sweexproject.htm">http://www.sunspot.co.uk/Projects/sweexproject.htm</a><br />and <a href="http://www.ipb-halle.de/~ronald/ADM5120">http://www.ipb-halle.de/~ronald/ADM5120</a>, but it&#039;s only for 2.4 kernel :-((</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p68504">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">nlinux</div>
					<div class="post-datetime">
						21 May 2008, 17:01					</div>
				</div>
				<div class="post-content content">
					<p>do you actually have /dev/gpio node being created?&nbsp; I&#039;m using the latest trunk on IXP4xx boards (Avila Gateworks) more specifically and the node is not being created with the latest trunk.&nbsp; </p><p>If you have it, then lucky you <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />&nbsp; Install the gpioctl package and you should get some control of your gpio pins.&nbsp; I was just getting comfortable using them in the 2.6.23 kernels, and now they are gone <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p68531">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">gorec</div>
					<div class="post-datetime">
						22 May 2008, 07:03					</div>
				</div>
				<div class="post-content content">
					<p>no - i does not have /dev/gpio <br />when i use gpioctl utility - they said error:</p><p>root@OpenWrt:/# gpioctl dirin 2<br />Error whilst opening /dev/gpio</p><p>Even when I create /dev/gpio - gpioctl does not work:</p><p>root@OpenWrt:/# mknod /dev/gpio c 167 2<br />root@OpenWrt:/# ls -l /dev/g*<br />crw-r--r--&nbsp; &nbsp; 1 root&nbsp; &nbsp; &nbsp;root&nbsp; &nbsp; &nbsp;167,&nbsp; &nbsp;2 Jan&nbsp; 1 00:05 /dev/gpio<br />root@OpenWrt:/# gpioctl dirin 2<br />Error whilst opening /dev/gpio<br />root@OpenWrt:/#&nbsp; &nbsp; </p><p>Has tried to use buttons-driver - it is loaded, but so does not work, or I simply have not understood as it to use:</p><p>oot@OpenWrt:/# lsmod<br />Module&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Size&nbsp; Used by&nbsp; &nbsp; Not tainted<br />...<br />gpio_buttons&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2080&nbsp; 0<br />input_polldev&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1584&nbsp; 1 gpio_buttons<br />...<br />input_core&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;18160&nbsp; 2 gpio_buttons,input_polldev<br />...<br />root@OpenWrt:/# </p><p>Can though somebody to advise in what direction to dig this question? Use adm5120 as the device for house automation interests, therefore it is necessary to receive a maximum quantity of inputs and outputs operated of userspace</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p68534">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">Slammer</div>
					<div class="post-datetime">
						22 May 2008, 08:04					</div>
				</div>
				<div class="post-content content">
					<p>House automation does not need very fast I/O<br />You can always, use remote I/O devices with serial or network interfaces.<br />If you want to use adm5120 as base of a home automation system, another option for I/O is I2C interface.<br />Which adm5120 device are you using ?</p>											<p class="post-edited">(Last edited by <strong>Slammer</strong> on 22 May 2008, 08:07)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p68540">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">gorec</div>
					<div class="post-datetime">
						22 May 2008, 10:38					</div>
				</div>
				<div class="post-content content">
					<p>Yes, it agree - very fast exchange with external devices is not necessary to me, but the idea to use additional rs232 or network devices calls into question into use most adm5120. Originally my idea consist that adm5120 represents itself as www a server by means of which there is a management and adjustment of parameters of house system, and executive devices and gauges are connected through the minimal outcome (the relay, transistor keys) to gauges (ÐºÐ¾Ð½Ñ†ÐµÐ²Ð¸ÐºÐ¸, thermodes, photogauges) and on executive devices through the relay and keys.<br />i&#039;m use planet xrt-401d - it&#039;s trivial adm5120 based broadband router.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p68570">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">gorec</div>
					<div class="post-datetime">
						22 May 2008, 21:12					</div>
				</div>
				<div class="post-content content">
					<p>I have a little more understood - the problem what platform br6104k has no in the board description (trunk/build_dir/linux-adm5120_router_le/linux-2.6.24.7/arch/mips/adm5120/platform.c) of the device for direct access to gpio but only hcd and flash - prompt in what direction to dig further?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p68662">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">gorec</div>
					<div class="post-datetime">
						24 May 2008, 22:52					</div>
				</div>
				<div class="post-content content">
					<p>Really nobody uses similar devices for input of the discrete information - for example for the house signal system or for calculation something...? - I have tried 2.4 all with a branch works!!!, but openwrt it is grinded under 2.6 help please...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p70568">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">Slammer</div>
					<div class="post-datetime">
						6 Jul 2008, 23:13					</div>
				</div>
				<div class="post-content content">
					<p>While gpio is included in kernel, still no /dev/gpio....<br />Still with SVN 11667 we dont have access to gpio.<br />Any help?</p><p>Edit:<br />I didn&#039;t noticed... there is a relevant ticket : <a href="https://dev.openwrt.org/cgi-bin/trac.fcgi/ticket/3518">https://dev.openwrt.org/cgi-bin/trac.fcgi/ticket/3518</a></p>											<p class="post-edited">(Last edited by <strong>Slammer</strong> on 6 Jul 2008, 23:32)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p70611">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">bifferos</div>
					<div class="post-datetime">
						7 Jul 2008, 19:04					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Slammer wrote:</cite><blockquote><p>While gpio is included in kernel, still no /dev/gpio....<br />Still with SVN 11667 we dont have access to gpio.<br />Any help?</p><p>Edit:<br />I didn&#039;t noticed... there is a relevant ticket : <a href="https://dev.openwrt.org/cgi-bin/trac.fcgi/ticket/3518">https://dev.openwrt.org/cgi-bin/trac.fcgi/ticket/3518</a></p></blockquote></div><p>I haven&#039;t looked at the latest SVN, but if GPIO is included in the kernel it is not very hard to write your <br />own module which allows access to GPIO (in either direction).</p><p>Some example kernel module code here:<br /><a href="http://linux-adm5120.svn.sourceforge.net/svnroot/linux-adm5120/OpenWrt/gpio-proxy/src/gpio-proxy.c">http://linux-adm5120.svn.sourceforge.ne … io-proxy.c</a><br /><a href="http://linux-adm5120.svn.sourceforge.net/svnroot/linux-adm5120/OpenWrt/gpio-proxy">http://linux-adm5120.svn.sourceforge.ne … gpio-proxy</a></p><p>And here is some userland code<br /><a href="http://linux-adm5120.svn.sourceforge.net/svnroot/linux-adm5120/OpenWrt/gpio-proxyd">http://linux-adm5120.svn.sourceforge.ne … pio-proxyd</a></p><p>...Although I suspect this does far more than what you need.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p70624">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">Slammer</div>
					<div class="post-datetime">
						8 Jul 2008, 01:04					</div>
				</div>
				<div class="post-content content">
					<p>Thanks bifferos!&nbsp; gpio_proxy module did the job.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p71614">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">gorec</div>
					<div class="post-datetime">
						1 Aug 2008, 08:59					</div>
				</div>
				<div class="post-content content">
					<p>Big thank&#039;s bifferos !!! gpio-proxy real cool...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p71616">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">Slammer</div>
					<div class="post-datetime">
						1 Aug 2008, 12:36					</div>
				</div>
				<div class="post-content content">
					<p>Anyway, I am not using the gpio-proxyd directly.<br />I am using simple routines in userland (based on gpio-proxyd code) inside my program.<br />I can share the code if someone is interested.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p71617">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">gorec</div>
					<div class="post-datetime">
						1 Aug 2008, 12:55					</div>
				</div>
				<div class="post-content content">
					<p>Yes - i have such interest...<br />I can&#039;t make gpio on my device work :-( even with gpio-proxy...<br />i try&#039;d gpioctl but they need char device /dev/gpio wich does not maked with my platform edimax-br6104k (planet xrt401d in real)<br />it&#039;s aslo have reset button connected to gpio2 and 11 Leds (2*port(5)+1*power) led&#039;s work like a sharm but button not :-(<br />nor gpio-button nor hotplug-buttons ...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p71625">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">Slammer</div>
					<div class="post-datetime">
						1 Aug 2008, 16:22					</div>
				</div>
				<div class="post-content content">
					<p>With gpio-proxy code you can read the state on any input (like button) but there is no hotplug or event support.<br />You just read the state of an input with a function eg.&nbsp; </p><p>input = GetInput( n )</p><p>n is the input number.</p>											<p class="post-edited">(Last edited by <strong>Slammer</strong> on 1 Aug 2008, 16:23)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p71785">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">bifferos</div>
					<div class="post-datetime">
						5 Aug 2008, 11:36					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>gorec wrote:</cite><blockquote><p>Yes - i have such interest...<br />I can&#039;t make gpio on my device work :-( even with gpio-proxy...<br />i try&#039;d gpioctl but they need char device /dev/gpio wich does not maked with my platform edimax-br6104k (planet xrt401d in real)<br />it&#039;s aslo have reset button connected to gpio2 and 11 Leds (2*port(5)+1*power) led&#039;s work like a sharm but button not :-(<br />nor gpio-button nor hotplug-buttons ...</p></blockquote></div><p>Did you load button-hotplug module?&nbsp; I haven&#039;t tried but it is supposed to generate an input event for hotplug rules.<br />(but only for the reset button).&nbsp; Unfortunately, this is only working in polled mode.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p71957">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">gorec</div>
					<div class="post-datetime">
						8 Aug 2008, 11:36					</div>
				</div>
				<div class="post-content content">
					<p>Big thank&#039;s to juhosd!<br />All gpio interaction work just fine!<br />I&#039;m very-very glad!!!<br />gpioctl via /dev/gpio char dev work ok<br />buttons-hotplug work too (with event mechanizm!!!)</p><p>It&#039;s enought for any automation... and smart home application...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p71964">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">acoul</div>
					<div class="post-datetime">
						8 Aug 2008, 14:29					</div>
				</div>
				<div class="post-content content">
					<p>now we just need a little wiki about this ;-)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p102664">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">256mxr</div>
					<div class="post-datetime">
						10 Feb 2010, 18:34					</div>
				</div>
				<div class="post-content content">
					<p>How to load that gpio-proxy???</p><p>I have the same problem in not accessing gpio in /dev/gpio</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>