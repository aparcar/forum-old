<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Multi-WAN Load Balancing</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 29 Mar 2018 and 3 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 5 of 14</div><nav><ul><li><a href="viewtopic.php%3Fid=23904&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=23904&amp;p=3.html">3</a></li><li><a href="viewtopic.php%3Fid=23904&amp;p=4.html">4</a></li><li class="pagination-current"><span>5</span></li><li><a href="viewtopic.php%3Fid=23904&amp;p=6.html">6</a></li><li><a href="viewtopic.php%3Fid=23904&amp;p=7.html">7</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=23904&amp;p=14.html">14</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p108873">
				<div class="post-metadata">
					<div class="post-num">Post #101</div>
					<div class="post-author">snowyowlster</div>
					<div class="post-datetime">
						10 May 2010, 18:53					</div>
				</div>
				<div class="post-content content">
					<p>Cool. Look forward to trying it out. Will report back</p><p>Snowyowlster.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p108972">
				<div class="post-metadata">
					<div class="post-num">Post #102</div>
					<div class="post-author">andyballon</div>
					<div class="post-datetime">
						12 May 2010, 18:35					</div>
				</div>
				<div class="post-content content">
					<p>yep. i&#039;m trying 1.09 now and load balancing does seem to be better using multi-threaded download managers.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p109093">
				<div class="post-metadata">
					<div class="post-num">Post #103</div>
					<div class="post-author">SouthPawn</div>
					<div class="post-datetime">
						14 May 2010, 15:59					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>andyballon wrote:</cite><blockquote><p>yep. i&#039;m trying 1.09 now and load balancing does seem to be better using multi-threaded download managers.</p></blockquote></div><p>By allowing this method of balancing, it leaves it up to the client on how many new connections they want to make.</p><p>Definitely install 1.0.12 though, as I&#039;ve made it so you can still use the original balancing method and the new method simultaneously. </p><p>The old method offers some benefits, particularly if there is an incompatibility in the load balancing with regards to a particular application or site.</p><p>Anyhow, another big change is the probability matrix which I struggled with for a while, but it is now corrected.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p109150">
				<div class="post-metadata">
					<div class="post-num">Post #104</div>
					<div class="post-author">andyballon</div>
					<div class="post-datetime">
						15 May 2010, 17:57					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>SouthPawn wrote:</cite><blockquote><p>The old method offers some benefits, particularly if there is an incompatibility in the load balancing with regards to a particular application or site.</p></blockquote></div><p>Right you are there. I had a problem accessing our cpanel with 1.09. My work around was I routed all traffic going there through one interface. <br />I&#039;ll give 1.0.12 soon and give you feedback as soon as I can.</p><p>Thanks!</p>											<p class="post-edited">(Last edited by <strong>andyballon</strong> on 15 May 2010, 17:58)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p109237">
				<div class="post-metadata">
					<div class="post-num">Post #105</div>
					<div class="post-author">SystemR89</div>
					<div class="post-datetime">
						17 May 2010, 14:48					</div>
				</div>
				<div class="post-content content">
					<p>I am using a fonera 2.0g and i can reach 3 gateway with&nbsp; only one interface in different subnets. Can i create virtual devices (eth0.1, eth0.2, eth0.3) using them as wan?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p109247">
				<div class="post-metadata">
					<div class="post-num">Post #106</div>
					<div class="post-author">SouthPawn</div>
					<div class="post-datetime">
						17 May 2010, 18:07					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>SystemR89 wrote:</cite><blockquote><p>I am using a fonera 2.0g and i can reach 3 gateway with&nbsp; only one interface in different subnets. Can i create virtual devices (eth0.1, eth0.2, eth0.3) using them as wan?</p></blockquote></div><p>Yes, I recently tested this type of configuration, it seems to work, at least in basic testing w/o QoS. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>											<p class="post-edited">(Last edited by <strong>SouthPawn</strong> on 17 May 2010, 23:16)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p109991">
				<div class="post-metadata">
					<div class="post-num">Post #107</div>
					<div class="post-author">cowboydrg</div>
					<div class="post-datetime">
						27 May 2010, 22:09					</div>
				</div>
				<div class="post-content content">
					<p>Hi SouthPawn, </p><p>I&#039;m using your scripts and I am loving it, however, I do have a small issue with it. It seems that specifying default route does nothing in my case.&nbsp; </p><p>etc/config/multiwan file:<br />config &#039;multiwan&#039; &#039;config&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;default_route&#039; &#039;wan&#039;</p><p>config &#039;interface&#039; &#039;wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;icmp_hosts&#039; &#039;dns&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;timeout&#039; &#039;3&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;health_fail_retries&#039; &#039;3&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;health_recovery_retries&#039; &#039;5&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;dns&#039; &#039;auto&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;health_interval&#039; &#039;5&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;failover_to&#039; &#039;fastbalancer&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;weight&#039; &#039;5&#039;</p><p>config &#039;interface&#039; &#039;wan2&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;icmp_hosts&#039; &#039;dns&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;timeout&#039; &#039;3&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;health_fail_retries&#039; &#039;3&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;health_recovery_retries&#039; &#039;5&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;dns&#039; &#039;auto&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;health_interval&#039; &#039;5&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;failover_to&#039; &#039;fastbalancer&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;weight&#039; &#039;5&#039;</p><p>config &#039;mwanfw&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;wanrule&#039; &#039;wan&#039;</p><br /><p>etc/config/network file:<br />config &#039;switch&#039; &#039;eth0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;vlan101&#039; &#039;0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;vlan102&#039; &#039;0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;vlan103&#039; &#039;0&#039;</p><p>config &#039;interface&#039; &#039;loopback&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ifname&#039; &#039;lo&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;proto&#039; &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ipaddr&#039; &#039;127.0.0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;netmask&#039; &#039;255.0.0.0&#039;</p><p>config &#039;interface&#039; &#039;wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ifname&#039; &#039;eth0.101&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;proto&#039; &#039;dhcp&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;defaultroute&#039; &#039;0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;peerdns&#039; &#039;0&#039;</p><p>config &#039;interface&#039; &#039;wan2&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;proto&#039; &#039;dhcp&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ifname&#039; &#039;eth0.102&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;defaultroute&#039; &#039;0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;peerdns&#039; &#039;0&#039;</p><p>config &#039;interface&#039; &#039;lan1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ifname&#039; &#039;eth0.103&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;proto&#039; &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ipaddr&#039; &#039;192.168.1.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;netmask&#039; &#039;255.255.255.0&#039;</p><br /><p>Kernel IP routing table<br />Destination&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Gateway&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Genmask&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Flags&nbsp; &nbsp; &nbsp; Metric&nbsp; &nbsp; &nbsp; Ref&nbsp; &nbsp; Use&nbsp; &nbsp; &nbsp;Iface<br />192.168.100.0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;255.255.255.0&nbsp; &nbsp; &nbsp; U&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; eth0.102<br />192.168.101.0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;255.255.255.0&nbsp; &nbsp; &nbsp; U&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; eth0.101<br />192.168.1.0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;255.255.255.0&nbsp; &nbsp; &nbsp; U&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; eth0.103<br />default&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 192.168.100.254&nbsp; &nbsp; &nbsp; 0.0.0.0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UG&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; eth0.102<br />default&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 192.168.101.252&nbsp; &nbsp; &nbsp; 0.0.0.0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UG&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; eth0.101<br />default&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 192.168.101.252&nbsp; &nbsp; &nbsp; 0.0.0.0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UG&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; eth0.101</p><br /><p>I want wan to be my primary connection and wan2 serve as a backup. However, I get connected to wan2 whenever OpenWrt reboots regardless of what I choose as default route. The only time when I&#039;m routed through wan is when I bring down wan2 manually by running &quot;ifdown wan2&quot; and fail-over kicks in. Please advice if I am doing something wrong and how this issue can be fixed.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p109999">
				<div class="post-metadata">
					<div class="post-num">Post #108</div>
					<div class="post-author">SouthPawn</div>
					<div class="post-datetime">
						27 May 2010, 23:41					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>cowboydrg wrote:</cite><blockquote><p>I want wan to be my primary connection and wan2 serve as a backup. However, I get connected to wan2 whenever OpenWrt reboots regardless of what I choose as default route. The only time when I&#039;m routed through wan is when I bring down wan2 manually by running &quot;ifdown wan2&quot; and fail-over kicks in. Please advice if I am doing something wrong and how this issue can be fixed.</p></blockquote></div><p>Can you give me the output of &#039;iptables -L MultiWanRules -t mangle -v&#039;, &#039;ip route show table 10&#039;, &#039;iptables -L FW1MARK -t mangle -v&#039;, and &#039;ip rule&#039; ?</p><p>Thanks <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110012">
				<div class="post-metadata">
					<div class="post-num">Post #109</div>
					<div class="post-author">cowboydrg</div>
					<div class="post-datetime">
						28 May 2010, 00:59					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for the quick reply, here are the outputs:</p><p>root@OpenWrt:/# iptables -L MultiWanRules -t mangle -v<br />Chain MultiWanRules (2 references)<br /> pkts&nbsp; &nbsp; &nbsp;bytes&nbsp; &nbsp; &nbsp;target&nbsp; &nbsp; &nbsp; &nbsp;prot&nbsp; &nbsp; &nbsp;opt&nbsp; &nbsp; &nbsp; in&nbsp; &nbsp; &nbsp; out&nbsp; &nbsp; &nbsp;source&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;destination<br /> 2984&nbsp; &nbsp; &nbsp;206K&nbsp; &nbsp; FW1MARK&nbsp; &nbsp; &nbsp;all&nbsp; &nbsp; &nbsp; &nbsp;--&nbsp; &nbsp; &nbsp; any&nbsp; &nbsp; any&nbsp; &nbsp;anywhere&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; anywhere&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mark match 0x0<br />&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp;FastBalancer&nbsp; all&nbsp; &nbsp; &nbsp; &nbsp;--&nbsp; &nbsp; &nbsp; any&nbsp; &nbsp; any&nbsp; &nbsp;anywhere&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; anywhere&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mark match 0x0</p><p>&quot;ip route show table 10&quot; returns nothing so I ran &quot;ip route&quot; instead, hopefully this is what you were looking for:<br />root@OpenWrt:/# ip route<br />192.168.100.0/24 dev eth0.102&nbsp; src 192.168.100.102<br />192.168.101.0/24 dev eth0.101&nbsp; src 192.168.101.164<br />192.168.1.0/24&nbsp; &nbsp; dev eth0.103&nbsp; src 192.168.1.1<br />default via 192.168.100.254 dev eth0.102<br />default via 192.168.101.252 dev eth0.101<br />default via 192.168.101.252 dev eth0.101&nbsp; src 192.168.101.164</p><p>root@OpenWrt:/# iptables -L FW1MARK -t mangle -v<br />Chain FW1MARK (6 references)<br /> pkts&nbsp; &nbsp;bytes&nbsp; &nbsp; &nbsp;target&nbsp; &nbsp; &nbsp;prot&nbsp; &nbsp; opt&nbsp; &nbsp; &nbsp;in&nbsp; &nbsp; &nbsp;out&nbsp; &nbsp; &nbsp;source&nbsp; &nbsp; &nbsp; destination<br /> 9343&nbsp; &nbsp;897K&nbsp; &nbsp; &nbsp; MARK&nbsp; &nbsp; &nbsp; all&nbsp; &nbsp; &nbsp; &nbsp;--&nbsp; &nbsp; any&nbsp; &nbsp; any&nbsp; &nbsp;anywhere&nbsp; &nbsp; anywhere&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MARK set 0x10<br /> 9343&nbsp; &nbsp;897K&nbsp; CONNMARK&nbsp; &nbsp;all&nbsp; &nbsp; &nbsp; --&nbsp; &nbsp; any&nbsp; &nbsp; any&nbsp; &nbsp;anywhere&nbsp; &nbsp; anywhere&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CONNMARK save</p><p>root@OpenWrt:/# ip rule<br />ip: RTNETLINK answers: Operation not supported<br />ip: dump terminated</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110015">
				<div class="post-metadata">
					<div class="post-num">Post #110</div>
					<div class="post-author">SouthPawn</div>
					<div class="post-datetime">
						28 May 2010, 01:15					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>cowboydrg wrote:</cite><blockquote><p>root@OpenWrt:/# ip rule<br />ip: RTNETLINK answers: Operation not supported<br />ip: dump terminated</p></blockquote></div><p>There&#039;s the problem, it sounds like this would most likely be caused by CONFIG_IP_MULTIPLE_TABLES not being enabled in your kernel.</p><p>The reason ifdown wan2 seemingly makes it work is not because it enables failover, but because it disables the last configured interface, leaving the first wan to be the only default route and therefore all traffic goes through it. In the current setup you would see the same behavior with or without the Multi-WAN script.</p><p>Hope this helps,<br />-Craig</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110016">
				<div class="post-metadata">
					<div class="post-num">Post #111</div>
					<div class="post-author">cowboydrg</div>
					<div class="post-datetime">
						28 May 2010, 01:35					</div>
				</div>
				<div class="post-content content">
					<p>I checked my kernel-build configuration and it seems that the feature is enabled and compiled into the kernel image.</p><p>Symbol: IP_MULTIPLE_TABLES [=y]&nbsp; &nbsp;<br />&nbsp; ? Prompt: IP: policy routing&nbsp; &nbsp; &nbsp;<br />&nbsp; ?&nbsp; &nbsp;Defined at net/ipv4/Kconfig:101&nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; ?&nbsp; &nbsp;Depends on: NET [=y] &amp;&amp; INET [=y] &amp;&amp; IP_ADVANCED_ROUTER [=y] <br />&nbsp; ?&nbsp; &nbsp;Location: <br />&nbsp; ?&nbsp; &nbsp; &nbsp;-&gt; Networking support (NET [=y])&nbsp; <br />&nbsp; ?&nbsp; &nbsp; &nbsp; &nbsp;-&gt; Networking options <br />&nbsp; ?&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-&gt; TCP/IP networking (INET [=y]) <br />&nbsp; ?&nbsp; &nbsp;Selects: FIB_RULES [=y] </p><p>Any further advices would be greatly appreciated, thanks.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p110086">
				<div class="post-metadata">
					<div class="post-num">Post #112</div>
					<div class="post-author">cowboydrg</div>
					<div class="post-datetime">
						28 May 2010, 20:01					</div>
				</div>
				<div class="post-content content">
					<p>An update on my problem, I deselected and selected the option and recompiled it.&nbsp; Now it&#039;s working nicely, thanks <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111170">
				<div class="post-metadata">
					<div class="post-num">Post #113</div>
					<div class="post-author">daniel_bergamini</div>
					<div class="post-datetime">
						14 Jun 2010, 03:55					</div>
				</div>
				<div class="post-content content">
					<p>SouthPawn,</p><p>I totally appreciate your efforts with this script. I struggled a little with the installation a while and ultimately followed andyballon&#039;s instructions and was able to get it into a working configuration. My goal is to use it to fail-over between 2 moderately failure prone connections.</p><p>The hardware is a (classic) WRT54GS, wan is on eth0.1 (option &#039;vlan1&#039; &#039;0 5&#039;) and wan2 is on eth0.2 (option &#039;vlan2&#039; &#039;1 5&#039;). Both are Ethernet based (when they connect to the router). My goal is to use wan2 when its available and fail back to wan. As such I have my default_route, in multiwan, set to wan2. Everything works great, until wan2 fails (ping timeout). Traffic to sites with already cached DNS entries appears to work fine, but the strangest thing happens.</p><p>Calls to the DNS servers on the WAN interface appear to be coming from WAN2&#039;s IP address. Obviously this doesn&#039;t work properly, as these are 2 different providers with different IP spaces. I&#039;ve tried all kinds of config changes but nothing I do seems to work around this issue. Failing the connections manually (ifdown or ifup on wan or wan2) doesn&#039;t appear to exhibit this behavior.</p><p>Thoughts? Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111194">
				<div class="post-metadata">
					<div class="post-num">Post #114</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						14 Jun 2010, 12:33					</div>
				</div>
				<div class="post-content content">
					<p>Hi Craig,</p><br /><p>Been using your script for quite some time now and it really works great. But maybe you could help me with a specific set-up? What i want to achieve is the following:</p><p>I have three ISP links. Two of them are flat-fee/high bandwidth connections. These two are balanced and works great. The third connection is a 3G low bandwidth/high-cost link. I would like to let the 3G kick-in when both other isp have failed. My firewall config is already setup so that only business critical traffic can traverse over the 3G link. </p><p>How do i setup your multiwan script so that the first 2 links are balanced and the third kicks in only after both have failed?</p><p>Thank you for your time !</p><br /><p>Greetz Adze</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111195">
				<div class="post-metadata">
					<div class="post-num">Post #115</div>
					<div class="post-author">Priyantha Bleeker</div>
					<div class="post-datetime">
						14 Jun 2010, 12:52					</div>
				</div>
				<div class="post-content content">
					<p>Wow this sounds great <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /><br />Has somebody already experience with this in combination with a Netgear WNDR3700 or TP-Link WR1043ND (I have them both with OpenWRT installed) working ?</p><p>And does this method mean that you may use both(or more) connections together to burst download and upload speeds by example ?<br />My home situation is right now the following:<br />- 1 ADSL(2) connection of 8 Mbit<br />- 1 ADSL(2) connection of 8/10 Mbit is comming soon<br />- 1 ADSL(2) connection of 8/10 Mbit is comming maybe <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>I do use right now a Linksys VPN-Router(type I don&#039;t know at the moment) which is connected with my Alcatel SpeedTouch 546v6 ADSL2 modem, that lot is connected to my Cisco 2924 as my main switch to distribute trough my building(I do live in a company building). On the main floor I have 1 Netgear WNDR3700 with OpenWRT running to provide WiFi access and two TP-Link 1043ND also to provide WiFi access, all three of these WiFi devices to have their own small &#039;network&#039; at this moment(from the Linksys VPN-Router trough my Cisco everything is connected to the WAN ports on the WiFI devices), but this is not the ideal situation I think.</p><p>I think I would like the following devices to use for the new situation:</p><p>- Cisco 2924 as my main switch to all the patchpanels trough the building<br />- Alcatel SpeedTouch 546v6 ADSL2 modem<br />- &quot;Some&quot; ADSL(2) modem<br />- &quot;Some&quot; ADSL(2) modem(for maybe the third line)<br />- TP-Link 1043ND with OpenWRT<br />- TP-Link 1043ND with OpenWRT<br />- Nethear WNDR3700 with OpenWRT</p><p>I think it is best to move the old Linksys VPN-Router, which is used right now, move away and not to use it anymore.<br />The idea is I think to use one of the TP-Link&#039;s OR the Netgear as my main router, with Multi-WAN Load Balancing thingie on it, and use the other WiFI devices to provide WiFi access trough the building just as plain AccessPoints without routing or NAT-ting them self.</p><p>So the question is <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /> Which is best solution ? How do I build this properly ?</p><p>Thanks in Advance.</p><p>Greetz, Priyantha</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111208">
				<div class="post-metadata">
					<div class="post-num">Post #116</div>
					<div class="post-author">SouthPawn</div>
					<div class="post-datetime">
						14 Jun 2010, 18:41					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>daniel_bergamini wrote:</cite><blockquote><p>SouthPawn,</p><p>I totally appreciate your efforts with this script. I struggled a little with the installation a while and ultimately followed andyballon&#039;s instructions and was able to get it into a working configuration. My goal is to use it to fail-over between 2 moderately failure prone connections.</p><p>The hardware is a (classic) WRT54GS, wan is on eth0.1 (option &#039;vlan1&#039; &#039;0 5&#039;) and wan2 is on eth0.2 (option &#039;vlan2&#039; &#039;1 5&#039;). Both are Ethernet based (when they connect to the router). My goal is to use wan2 when its available and fail back to wan. As such I have my default_route, in multiwan, set to wan2. Everything works great, until wan2 fails (ping timeout). Traffic to sites with already cached DNS entries appears to work fine, but the strangest thing happens.</p><p>Calls to the DNS servers on the WAN interface appear to be coming from WAN2&#039;s IP address. Obviously this doesn&#039;t work properly, as these are 2 different providers with different IP spaces. I&#039;ve tried all kinds of config changes but nothing I do seems to work around this issue. Failing the connections manually (ifdown or ifup on wan or wan2) doesn&#039;t appear to exhibit this behavior.</p><p>Thoughts? Thanks!</p></blockquote></div><p>Hmm, sounds odd... if you could, provide an output of &#039;iptables -t mangle -L MultiWanDNS -v&#039; and paste what&#039;s in the /tmp/resolv.conf.auto as well as &#039;iptables -t mangle -L FW1MARK&#039; and &#039;iptables -t mangle -L FW2MARK&#039; while in failover.</p><div class="quotebox"><cite>Adze wrote:</cite><blockquote><p>How do i setup your multiwan script so that the first 2 links are balanced and the third kicks in only after both have failed?</p></blockquote></div><p>option &#039;weight&#039; &#039;disable&#039; within /etc/config/multiwan for the third wan, or from LuCI select None for the balance ratio for that interface, this will keep it from being load balanced.</p><p>As for failing over to the third only after both interfaces have failed, that can be difficult as really you can only specify one alternate route for each failed wan. (currently)<br />The &#039;failover to&#039; option only applies to the custom configured outbound rules and default route, since the routes will be removed from the load balancer tables upon failure.</p><div class="quotebox"><cite>Priyantha Bleeker wrote:</cite><blockquote><p>So the question is&nbsp; Which is best solution ? How do I build this properly ?</p></blockquote></div><p>Unfortunetly I have no experience with any of the hardware mentioned, that question might be best answered in a seperate thread.</p><p>Thanks all,<br />-Craig</p>											<p class="post-edited">(Last edited by <strong>SouthPawn</strong> on 18 Jun 2010, 17:21)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111226">
				<div class="post-metadata">
					<div class="post-num">Post #117</div>
					<div class="post-author">daniel_bergamini</div>
					<div class="post-datetime">
						15 Jun 2010, 03:29					</div>
				</div>
				<div class="post-content content">
					<p>FYI, I have DNS on eth0.1/wan set to 4.2.2.1 and 4.2.2.3 and eth0.2/wan2 set to 4.2.2.4 and 4.2.2.6 (in /etc/config/network). Mostly for easier reading and troubleshooting. Both interfaces are DHCP, eth0.1/wan is a valid public IP, eth0.2/wan2 is behind NAT and always gets assigned 192.168.100.100. There is just no valid reason for 192.168.100.100 to try and transmit over eth0.1/wan.</p><div class="quotebox"><cite>SouthPawn wrote:</cite><blockquote><p>Hmm, sounds odd...</p></blockquote></div><p>Indeed. It would appear it does not have to be in a failover state for wan2&#039;s IP to try and talk on wan&#039;s interface. Here are some tcptumps from eth0.1 as I first booted everything up tonight and started my IM client (not in a failover state):<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# tcpdump -i eth0.1 -n net 4.2.2 and not icmp
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on eth0.1, link-type EN10MB (Ethernet), capture size 96 bytes
19:44:51.245808 IP 192.168.100.100.49859 &gt; 4.2.2.1.53: 6724+ A? omega.contacts.msn.com. (40)
19:44:51.246516 IP 192.168.100.100.49859 &gt; 4.2.2.3.53: 6724+ A? omega.contacts.msn.com. (40)</code></pre></div><p>(Obviously nobody responded to the above requests.) Vs. wan2 which actually can communicate with that IP:</p><div class="codebox"><pre><code>root@OpenWrt:~# tcpdump -i eth0.2 -n net 4.2.2 and not icmp
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on eth0.2, link-type EN10MB (Ethernet), capture size 96 bytes
19:44:46.241766 IP 192.168.100.100.49859 &gt; 4.2.2.4.53: 6724+ A? omega.contacts.msn.com. (40)
19:44:51.245103 IP 192.168.100.100.49859 &gt; 4.2.2.6.53: 6724+ A? omega.contacts.msn.com. (40)
19:44:51.247077 IP 192.168.100.100.49859 &gt; 4.2.2.4.53: 6724+ A? omega.contacts.msn.com. (40)
19:44:51.576133 IP 4.2.2.4.53 &gt; 192.168.100.100.49859: 6724 2/0/0 CNAME[|domain]
19:44:51.734450 IP 4.2.2.6.53 &gt; 192.168.100.100.49859: 6724 2/0/0 CNAME[|domain]</code></pre></div><div class="quotebox"><cite>SouthPawn wrote:</cite><blockquote><p>if you could, provide an output of &#039;iptables -t mangle -L MultiWanDNS -v&#039;</p></blockquote></div><div class="codebox"><pre><code>root@OpenWrt:~# iptables -t mangle -L MultiWanDNS -v
Chain MultiWanDNS (2 references)
 pkts bytes target     prot opt in     out     source               destination         
   92  7656 FW1MARK    all  --  any    any     anywhere             vnsc-pri.sys.gtei.net 
   92  7656 FW1MARK    all  --  any    any     anywhere             vnsc-lc.sys.gtei.net 
  307 24983 FW2MARK    all  --  any    any     anywhere             vnsc-pri-dsl.genuity.net 
  105  9136 FW2MARK    all  --  any    any     anywhere             vnsc-lc-dsl.genuity.net</code></pre></div><p>Because I like numbers better:<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# iptables -t mangle -L MultiWanDNS -v -n
Chain MultiWanDNS (2 references)
 pkts bytes target     prot opt in     out     source               destination         
  109  9084 FW1MARK    all  --  *      *       0.0.0.0/0            4.2.2.1             
  109  9084 FW1MARK    all  --  *      *       0.0.0.0/0            4.2.2.3             
  467 38351 FW2MARK    all  --  *      *       0.0.0.0/0            4.2.2.4             
  123 10648 FW2MARK    all  --  *      *       0.0.0.0/0            4.2.2.6</code></pre></div><div class="quotebox"><cite>SouthPawn wrote:</cite><blockquote><p>and paste what&#039;s in the /tmp/resolv.conf.auto</p></blockquote></div><div class="codebox"><pre><code>root@OpenWrt:~# cat /tmp/resolv.conf.auto 
nameserver 4.2.2.1
nameserver 4.2.2.3
nameserver 4.2.2.4
nameserver 4.2.2.6</code></pre></div><p>When a failure occurs it deletes the values of the nameserver associated with the interface that drops, eg when wan2 goes down, the .4 and .6 nameservers disappear from the list and dnsmasq appears to notice them missing after reading the file. I&#039;m sure you&#039;re aware of all that but here is what logread shows me:<br /></p><div class="codebox"><pre><code>Jun 14 19:58:30 OpenWrt user.notice root: [Multi-WAN Notice]: wan2 has failed and is currently offline.
Jun 14 19:58:32 OpenWrt daemon.info dnsmasq[849]: reading /tmp/resolv.conf.auto
Jun 14 19:58:32 OpenWrt daemon.info dnsmasq[849]: using nameserver 4.2.2.3#53
Jun 14 19:58:32 OpenWrt daemon.info dnsmasq[849]: using nameserver 4.2.2.1#53
Jun 14 19:58:32 OpenWrt daemon.info dnsmasq[849]: using local addresses only for domain lan
Jun 14 19:59:18 OpenWrt user.notice root: [Multi-WAN Notice]: wan2 has recovered and is back online!
Jun 14 19:59:20 OpenWrt daemon.info dnsmasq[849]: reading /tmp/resolv.conf.auto
Jun 14 19:59:20 OpenWrt daemon.info dnsmasq[849]: using nameserver 4.2.2.6#53
Jun 14 19:59:20 OpenWrt daemon.info dnsmasq[849]: using nameserver 4.2.2.4#53
Jun 14 19:59:20 OpenWrt daemon.info dnsmasq[849]: using nameserver 4.2.2.3#53
Jun 14 19:59:20 OpenWrt daemon.info dnsmasq[849]: using nameserver 4.2.2.1#53
Jun 14 19:59:20 OpenWrt daemon.info dnsmasq[849]: using local addresses only for domain lan</code></pre></div><div class="quotebox"><cite>SouthPawn wrote:</cite><blockquote><p>as well as &#039;iptables -t mangle -L FW1MARK&#039;</p></blockquote></div><div class="codebox"><pre><code>root@OpenWrt:~# iptables -t mangle -L FW1MARK
Chain FW1MARK (6 references)
target     prot opt source               destination         
MARK       all  --  anywhere             anywhere            MARK set 0x10 
CONNMARK   all  --  anywhere             anywhere            CONNMARK save</code></pre></div><div class="quotebox"><cite>SouthPawn wrote:</cite><blockquote><p>and &#039;iptables -t mangle -L FW2MARK&#039; while in failover.</p></blockquote></div><div class="codebox"><pre><code>root@OpenWrt:~# iptables -t mangle -L FW2MARK
Chain FW2MARK (3 references)
target     prot opt source               destination         
MARK       all  --  anywhere             anywhere            MARK set 0x20 
FW1MARK    all  --  anywhere             anywhere            
CONNMARK   all  --  anywhere             anywhere            CONNMARK save</code></pre></div><p>Like you asked, above was while wan2 is failed. FW2MARK looks a lot more like FW1MARK while wan2 is online:<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# iptables -t mangle -L FW2MARK
Chain FW2MARK (5 references)
target     prot opt source               destination         
MARK       all  --  anywhere             anywhere            MARK set 0x20 
CONNMARK   all  --  anywhere             anywhere            CONNMARK save</code></pre></div><p>Thanks so much for your assistance. Argh, totally monopolizing the thread but I feel really close, I&#039;m just no good with iptables. Hopefully it&#039;s a quick, easy, obvious fix. Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111292">
				<div class="post-metadata">
					<div class="post-num">Post #118</div>
					<div class="post-author">SouthPawn</div>
					<div class="post-datetime">
						16 Jun 2010, 06:04					</div>
				</div>
				<div class="post-content content">
					<p>Everything seems normal as far the resolv file, the failover rules, etc..</p><p>We must take a look at &#039;ip rule show&#039;, &#039;ip route show table 10&#039;, &#039;ip route show table 20&#039; and &#039;ip route show table 123&#039;</p><p>Of course you&#039;re welcome to mask your public IP if you don&#039;t want it displayed. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Thanks,</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111349">
				<div class="post-metadata">
					<div class="post-num">Post #119</div>
					<div class="post-author">daniel_bergamini</div>
					<div class="post-datetime">
						17 Jun 2010, 02:28					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>SouthPawn wrote:</cite><blockquote><p>&#039;ip rule show&#039;, &#039;ip route show table 10&#039;, &#039;ip route show table 20&#039; and &#039;ip route show table 123&#039;</p></blockquote></div><p>I&#039;m too exhausted to break them all out, so here you go. (Seems better this way as it imbeds a scroll bar, keeping the post shorter. Replaced my public IP with 1.2.3.4 and gateway with 1.2.3.1. Thanks again!</p><div class="codebox"><pre><code>root@OpenWrt:~# ip rule show
0:    from all lookup local 
10:    from 1.2.3.4 lookup MWAN1 
11:    from all fwmark 0x10 lookup MWAN1 
20:    from 192.168.100.100 lookup MWAN2 
21:    from all fwmark 0x20 lookup MWAN2 
123:    from all fwmark 0x123 lookup LoadBalancer 
32766:    from all lookup main 
32767:    from all lookup default 

root@OpenWrt:~# ip route show table 10
192.168.100.0/24 dev eth0.2  proto kernel  scope link  src 192.168.100.100 
192.168.1.0/24 dev br-lan  proto kernel  scope link  src 192.168.1.1 
70.41.160.0/22 dev eth0.1  proto kernel  scope link  src 1.2.3.4 
default via 1.2.3.1 dev eth0.1  proto static  src 1.2.3.4 

root@OpenWrt:~# ip route show table 20
192.168.100.0/24 dev eth0.2  proto kernel  scope link  src 192.168.100.100 
192.168.1.0/24 dev br-lan  proto kernel  scope link  src 192.168.1.1 
70.41.160.0/22 dev eth0.1  proto kernel  scope link  src 1.2.3.4 
default via 192.168.100.1 dev eth0.2  proto static  src 192.168.100.100 

root@OpenWrt:~# ip route show table 123
192.168.100.0/24 dev eth0.2  proto kernel  scope link  src 192.168.100.100 
192.168.1.0/24 dev br-lan  proto kernel  scope link  src 192.168.1.1 
70.41.160.0/22 dev eth0.1  proto kernel  scope link  src 1.2.3.4 
default via 192.168.100.1 dev eth0.2  proto static</code></pre></div><p>Not sure its normal or not. I don&#039;t know if I mentioned I&#039;m not using balancing, which I believe is what 123 is for. I&#039;m questioning if the eth0.2 should be in table 10 and eth0.1 should be in table 20 but I&#039;m sure you&#039;ll tell me. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> Nice to see the troubleshooting methodology. Did anyone end up setting up a wiki? If not, where should it be setup. I&#039;m happy to share what I&#039;ve learned for the community.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111400">
				<div class="post-metadata">
					<div class="post-num">Post #120</div>
					<div class="post-author">SouthPawn</div>
					<div class="post-datetime">
						17 Jun 2010, 21:01					</div>
				</div>
				<div class="post-content content">
					<p>It&#039;s a bug... will squish shortly.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111403">
				<div class="post-metadata">
					<div class="post-num">Post #121</div>
					<div class="post-author">daniel_bergamini</div>
					<div class="post-datetime">
						17 Jun 2010, 23:20					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>SouthPawn wrote:</cite><blockquote><p>It&#039;s a bug... will squish shortly.</p></blockquote></div><p>Glad to know I&#039;m not going crazy, or at least this doesn&#039;t prove without a doubt that I&#039;m going crazy. Thanks for troubleshooting with me and taking care of the problem. If it&#039;s going to take a while to fix, I&#039;m not opposed to implementing a workaround or helping to work out the problem. Please let me know if I can help.</p><p>Another thing I&#039;ll mention is that when I installed this package (or as a result of one of the pre-requisites) my Switch Config menu option disappeared from LuCI. Is this normal/expected? I feel like a couple of other things may have changed (disappeared as well). I just remember playing around with the switch config through the gui before installing the package and when I went back to troubleshoot afterwards, it was gone.</p><p>I don&#039;t mind managing the config through the /etc/config folder but...</p><p>Any idea if this is eventually going to make it into the repository? I think this is valuable enough to be available automatically for install. Anyway, thanks again!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111420">
				<div class="post-metadata">
					<div class="post-num">Post #122</div>
					<div class="post-author">SouthPawn</div>
					<div class="post-datetime">
						18 Jun 2010, 06:27					</div>
				</div>
				<div class="post-content content">
					<p>Updated, 1.0.13 should take care of it, let me know if it does not. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Thanks Daniel,<br />-Craig</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111492">
				<div class="post-metadata">
					<div class="post-num">Post #123</div>
					<div class="post-author">tysonedwards</div>
					<div class="post-datetime">
						19 Jun 2010, 02:17					</div>
				</div>
				<div class="post-content content">
					<p>SouthPawn, I am unable to download a copy of your script as your FTP server is set to require authentication.</p><p>Can you please look into this / send me a copy via other means?</p><p>Thanks for your help, and I look forward to trying this out.</p><p>~Tyson</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111495">
				<div class="post-metadata">
					<div class="post-num">Post #124</div>
					<div class="post-author">SouthPawn</div>
					<div class="post-datetime">
						19 Jun 2010, 03:07					</div>
				</div>
				<div class="post-content content">
					<p>Updated.. try again, sorry, it had something in there that shouldn&#039;t of been... it&#039;s now 1.0.13b.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p111498">
				<div class="post-metadata">
					<div class="post-num">Post #125</div>
					<div class="post-author">daniel_bergamini</div>
					<div class="post-datetime">
						19 Jun 2010, 04:58					</div>
				</div>
				<div class="post-content content">
					<p>Ok tried 13b, appears to be doing exactly the opposite. wan&#039;s IP on wan2&#039;s interface. There might be other problems but I haven&#039;t determined if it&#039;s something on my end or not.</p><p>What are the new table numbers?</p><p>*update: I also saw an example of wan2&#039;s IP on wan&#039;s interface again. Almost seems worse now somehow?</p><p>Also I found /etc/iproute2/rt_tables, which answers my questions about the new table names (I noticed a reference to starting at 300 in your first post for the new version, which makes more sense now). So what I&#039;m seeing is 300 for the balancer and 300+eth0.x*10, so eth0.1 = 310, eth0.2 = 320 and so on. Sadly, I don&#039;t have any routes in those tables.</p><div class="codebox"><pre><code>root@OpenWrt:/usr/bin# cat /etc/iproute2/rt_tables 
#
# reserved values
#
255    local
254    main
253    default
0    unspec
#
# local
#
#1    inr.ruhep
310     MWAN1
320     MWAN2
300     LoadBalancer
root@OpenWrt:/usr/bin# ip route show table 310
root@OpenWrt:/usr/bin# ip route show table 320
root@OpenWrt:/usr/bin# ip route show table 300</code></pre></div><p>Also, I don&#039;t know if I mentioned I&#039;m running Kamakaze, should that cause any problems? I don&#039;t have a problem upgrading, it just usually takes me a while to remember the whole process and get everything setup the way I like, so I only do it once a year or so.</p><p>Thanks again for working on it!</p>											<p class="post-edited">(Last edited by <strong>daniel_bergamini</strong> on 19 Jun 2010, 15:01)</p>
									</div>
			</article>

			
		
						<div class="notice">
				<p>Sorry, posts 126 to 125 are missing from our archive.</p>
			</div>
		
		
	
	<div class="pagination"><div class="pagination-number">Page 5 of 14</div><nav><ul><li><a href="viewtopic.php%3Fid=23904&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=23904&amp;p=3.html">3</a></li><li><a href="viewtopic.php%3Fid=23904&amp;p=4.html">4</a></li><li class="pagination-current"><span>5</span></li><li><a href="viewtopic.php%3Fid=23904&amp;p=6.html">6</a></li><li><a href="viewtopic.php%3Fid=23904&amp;p=7.html">7</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=23904&amp;p=14.html">14</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0.001 -->

</body>
</html>