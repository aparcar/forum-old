<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> RTL8188CUS on MediaTek 7688 Duo</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 14 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p341011">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Lo Eye Kyu</div>
					<div class="post-datetime">
						13 Oct 2016, 15:02					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m attempting to work around a problem in the MediaTek 7688 Duo board which has wifi on-board but does not support non-broadcast SSIDs in the current firmware revision (v.0.9.3).&nbsp; So I thought I&#039;d throw on a USB WIFI adapter, configure that, and bypass the issue.&nbsp; Of course, I can&#039;t even get the USB WIFI adapter running so cannot test.</p><p>As the board&#039;s a little curious per wifi since it has a radio onboard and is primarily designed to alternate between &quot;station&quot; and &quot;AP&quot; modes depending upon where you&#039;re at in the configuration process, the steps below reflect that. I followed MediaTek&#039;s instructions to get basically started here:</p><p>1) Clean wipe/install of board using factory default firmware v.0.9.3 via USB update<br />2) Connect to 7688 Duo AP via HTTP Set pwd and reboot into Station mode <br />3) Connect via SSH to Station mode <br />4) opkg update <br />5) opkg install usbutils <br />6) Plug in USB WIFI adapter (RTL8188CUS) <br />7) lsusb <br />--- <br />Bus 002 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub <br />Bus 001 Device 003: ID 0bda:8176 Realtek Semiconductor Corp. <br />RTL8188CUS 802.11n WLAN Adapter <br />Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub <br />--- <br />7) opkg list | grep RTL8188 <br />8) opkg install kmod-rtl8192cu <br />9) Connect to HTTP and reset to AP mode &amp; reboot <br />10) SSH to 7688 AP <br />11) vi /etc/config/wireless <br />12) the reboot to AP mode causes the board to auto-create two new &quot;config&quot; items at bottom (radio1).&nbsp; Edited these to reflect my environment: <br />--- <br />config wifi-device radio1 <br />&nbsp; option type mac80211 <br />&nbsp; option channel 11&nbsp; <em>(I also tried auto here) </em><br />&nbsp; option hwmode 11g <br />&nbsp; option path &#039;101c1000.ohci/usb2/2-1/2-1:1.0&#039; <br />&nbsp; option htmode HT20 </p><p>config wifi-iface <br />&nbsp; option device radio1 <br />&nbsp; option network wan <br />&nbsp; option mode sta <br />&nbsp; option TPLink_AP&nbsp; <em>(set to the AP connected to the internet) </em><br />&nbsp; option encryption psk2&nbsp; <em>(the encryption used on my router) </em><br />&nbsp; option key my_AP_key&nbsp; <em>(the key for that router)</em> <br />-- <br />13) :wq <br />14) wifi <br />15) reconnect to 7688 AP via SSH <br />16) run dmesg <br />--- snip---<br />[ 1163.970000] &lt;==== rt28xx_init, Status=0<br />[ 1164.030000] rtl8192cu: MAC auto ON okay!<br />[ 1164.030000] ttyS2: 3 input overrun(s)<br />[ 1164.070000] rtl8192cu: Tx queue select: 0x05<br /><strong>[ 1164.510000] IPv6: ADDRCONF(NETDEV_UP): wlan0: link is not ready</strong><br />[ 1164.900000] device ra0 entered promiscuous mode<br />[ 1164.910000] br-lan: port 2(ra0) entered forwarding state<br />[ 1164.920000] br-lan: port 2(ra0) entered forwarding state<br />[ 1166.920000] br-lan: port 2(ra0) entered forwarding state<br />[ 1166.930000] ttyS2: 6 input overrun(s)<br />[ 1175.600000] rtl8192cu: MAC auto ON okay!<br />[ 1175.650000] rtl8192cu: Tx queue select: 0x05<br />[ 1175.650000] ttyS2: 1 input overrun(s)<br />[ 1176.080000] IPv6: ADDRCONF(NETDEV_UP): wlan0: link is not ready<br />---<br />17) No obvious errors seen <br />18) run dmesg | grep &quot;Error&quot; <br />19) No errors seen <br />20) wifi (reset wifi just in case) <br />21) reconnect to AP via SSH <br />22) run dmesg <br />23) same info as beore<br />24) ping &quot;TPLink_AP&quot; IP address <em>(192.168.1.224)</em><br />25) arp -a <br />26) get MAC address <br />--- <br />IP address&nbsp; &nbsp; &nbsp; &nbsp;HW type&nbsp; &nbsp; &nbsp;Flags&nbsp; &nbsp; &nbsp; &nbsp;HW address&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Mask <br /> Device <br />192.168.1.224&nbsp; &nbsp; 0x1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x2&nbsp; &nbsp; &nbsp; &nbsp; <strong> 64:70:02:61:13:10 </strong>&nbsp; &nbsp; * <br /> apcli0 <br />192.168.1.250&nbsp; &nbsp; 0x1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;64:70:02:61:11:9c&nbsp; &nbsp; &nbsp;* <br /> apcli0 <br />192.168.1.254&nbsp; &nbsp; 0x1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;60:c3:97:09:2a:61&nbsp; &nbsp; &nbsp;* <br /> apcli0 <br />--- <br />27) vi /etc/config/wireless <br />28) add line to &quot;config wifi-iface&quot;: <br />--- <br />config wifi-iface <br />&nbsp; option device radio1 <br />&nbsp; option network wan <br />&nbsp; option mode sta <br />&nbsp; option Linksys_AP <br />&nbsp; option encryption psk2 <br />&nbsp; option key my_AP_key <br /><strong>&nbsp; option bssid 64:70:02:61:13:10 </strong><br />--- <br />29) :wq <br />30) wifi <br />31) reconnect to 7688 AP via SSH <br />32) ping 8.8.8.8&nbsp; -&gt; No Network path <br />33) ifconfig shows no IP address for the new interface. <br />---<br />root@mylinkit:~# ifconfig<br />br-lan&nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 9C:65:F9:1C:23:27&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:192.168.100.1&nbsp; Bcast:192.168.100.255&nbsp; Mask:255.255.255.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: fda5:20e3:60b1::1/60 Scope:Global<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: fe80::9e65:f9ff:fe1c:2327/64 Scope:Link<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:9888 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:9739 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0 <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:644663 (629.5 KiB)&nbsp; TX bytes:887771 (866.9 KiB)</p><p>eth0&nbsp; &nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 9C:65:F9:1C:23:27&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:429 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000 <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:0 (0.0 B)&nbsp; TX bytes:47388 (46.2 KiB)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Interrupt:5 </p><p>eth0.1&nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 9C:65:F9:1C:23:27&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: fe80::9e65:f9ff:fe1c:2327/64 Scope:Link<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:26 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0 <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:0 (0.0 B)&nbsp; TX bytes:6188 (6.0 KiB)</p><p>lo&nbsp; &nbsp; &nbsp; &nbsp; Link encap:Local Loopback&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:127.0.0.1&nbsp; Mask:255.0.0.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: ::1/128 Scope:Host<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP LOOPBACK RUNNING&nbsp; MTU:65536&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:4932 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:4932 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0 <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:338848 (330.9 KiB)&nbsp; TX bytes:338848 (330.9 KiB)</p><p>ra0&nbsp; &nbsp; &nbsp; &nbsp;Link encap:Ethernet&nbsp; HWaddr 9C:65:F9:1C:3E:93&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: fe80::9e65:f9ff:fe1c:3e93/64 Scope:Link<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:11908 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:28818 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000 <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:1186148 (1.1 MiB)&nbsp; TX bytes:1508682 (1.4 MiB)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Interrupt:6 </p><p><strong>wlan0&nbsp; &nbsp; &nbsp;Link encap:Ethernet&nbsp; HWaddr 7C:DD:90:B0:EE:44&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:0 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:0 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000 <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:0 (0.0 B)&nbsp; TX bytes:0 (0.0 B)</strong><br />---<br />34) iw list <br />---<br />root@mylinkit:~# iw list <br />Wiphy phy0 <br />&nbsp; &nbsp; &nbsp; &nbsp; max # scan SSIDs: 4 <br />&nbsp; &nbsp; &nbsp; &nbsp; max scan IEs length: 2257 bytes <br />&nbsp; &nbsp; &nbsp; &nbsp; RTS threshold: 2347 <br />&nbsp; &nbsp; &nbsp; &nbsp; Retry short limit: 7 <br />&nbsp; &nbsp; &nbsp; &nbsp; Retry long limit: 4 <br />&nbsp; &nbsp; &nbsp; &nbsp; Coverage class: 0 (up to 0m) <br />&nbsp; &nbsp; &nbsp; &nbsp; Available Antennas: TX 0 RX 0 <br />&nbsp; &nbsp; &nbsp; &nbsp; Supported interface modes: <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* IBSS <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* managed <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* AP <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* AP/VLAN <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* monitor <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* mesh point <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* P2P-client <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* P2P-GO <br />&nbsp; &nbsp; &nbsp; &nbsp; Band 1: <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Capabilities: 0x1862 <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; HT20/HT40 <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Static SM Power Save <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX HT20 SGI <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX HT40 SGI <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; No RX STBC <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Max AMSDU length: 7935 bytes <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DSSS/CCK HT40 <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Maximum RX AMPDU length 65535 bytes (exponent: 0x003) <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Minimum RX AMPDU time spacing: 16 usec (0x07) <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; HT TX/RX MCS rate indexes supported: 0-7, 32 <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Frequencies: <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 2412 MHz [1] (20.0 dBm) <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 2417 MHz [2] (20.0 dBm) <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 2422 MHz [3] (20.0 dBm) <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 2427 MHz [4] (20.0 dBm) <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 2432 MHz [5] (20.0 dBm) <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 2437 MHz [6] (20.0 dBm) <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 2442 MHz [7] (20.0 dBm) <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 2447 MHz [8] (20.0 dBm) <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 2452 MHz [9] (20.0 dBm) <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 2457 MHz [10] (20.0 dBm) <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 2462 MHz [11] (20.0 dBm) <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 2467 MHz [12] (disabled) <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 2472 MHz [13] (disabled) <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * 2484 MHz [14] (disabled) <br />&nbsp; &nbsp; &nbsp; <strong>&nbsp; interface combinations are not supported </strong><br />&nbsp; &nbsp; &nbsp; &nbsp; HT Capability overrides: <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* MCS: ff ff ff ff ff ff ff ff ff ff <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* maximum A-MSDU length <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* supported channel width <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* short GI for 40 MHz <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* max A-MPDU length exponent <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* min MPDU start spacing <br />---</p><p>So that&#039;s where I am.&nbsp; The issue appears to revolve around the message &quot;interface combinations are not supported&quot; but I have no idea what&#039;s throwing this.&nbsp; I am assuming something to do with having the original radio still broadcasting.&nbsp; </p><p>I&#039;ve tried a quick hack to disable the original radio just via the /etc/config/wireless (no blacklisting yet) and just use the USB one but I never see it connect to the AP and I&#039;m not able to SSH back into it (wipe to factory and try...try...again).&nbsp; I&#039;m considering spending time setting up a serial link to the board just to ensure I can access it during boot to see what&#039;s going on.&nbsp; </p><p>Any thoughts/ideas appreciated.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>