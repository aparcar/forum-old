<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Backup/ Restore Stock image (MT7620n)</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 8 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p229546">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Sorlas</div>
					<div class="post-datetime">
						8 Apr 2014, 07:19					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>I&#039;ve bought a little router to which i tried to bring openwrt to. <a href="https://forum.openwrt.org/viewtopic.php?id=49564">Click here for more</a>. I&#039;am now so far that i would like to flash an other image to my router but before that i want to be able to backup and restore the old one.<br /><a href="http://www.poray.com.cn/Upfiles/down/PORAY_7620X8S_Chinese_V14.09_20130806103007_upgrade.bin">Stock image download link</a></p><p>I think the only way to backup my stock image is to do it with uboot because there are no available commands in the terminal e.g. dd.</p><p>I got uboot access and terminal acces to it. Can anybody help me and find out how to backup the existing image or to restore the stock image?</p><p>Information from the terminal:</p><div class="codebox"><pre><code># help

Built-in commands:
-------------------
        . : break cd chdir continue eval exec exit export false hash
        help local pwd read readonly return set shift source times trap
        true type ulimit umask unset wait



# free
              total         used         free       shared      buffers
  Mem:        59524        19504        40020            0            0
 Swap:            0            0            0
Total:        59524        19504        40020

# cat /proc/mtd
dev:    size   erasesize  name
mtd0: 00030000 00010000 &quot;Bootloader&quot;
mtd1: 00010000 00010000 &quot;Config&quot;
mtd2: 00010000 00010000 &quot;Factory&quot;
mtd3: 007b0000 00010000 &quot;Kernel&quot;


# cat /proc/cpuinfo
system type             : Ralink SoC
processor               : 0
cpu model               : MIPS 24Kc V5.0
BogoMIPS                : 386.04
wait instruction        : yes
microsecond timers      : yes
tlb_entries             : 32
extra interrupt vector  : yes
hardware watchpoint     : yes, count: 4, address/irw mask: [0x0ff8, 0x0ff8, 0x0ffb, 0x0ff8]
ASEs implemented        : mips16 dsp
shadow register sets    : 1
core                    : 0
VCED exceptions         : not available
VCEI exceptions         : not available


# ps
  PID USER       VSZ STAT COMMAND
    1 admin     1476 S    /init
    2 admin        0 SW   [kthreadd]
    3 admin        0 SW   [ksoftirqd/0]
    4 admin        0 SW   [kworker/0:0]
    5 admin        0 SW   [kworker/u:0]
    6 admin        0 SW&lt;  [khelper]
    7 admin        0 SW   [sync_supers]
    8 admin        0 SW   [bdi-default]
    9 admin        0 SW&lt;  [kblockd]
   10 admin        0 SW   [khubd]
   11 admin        0 SW   [kseriod]
   12 admin        0 SW   [kswapd0]
   13 admin        0 SW&lt;  [crypto]
   18 admin        0 SW   [mtdblock0]
   19 admin        0 SW   [mtdblock1]
   20 admin        0 SW   [mtdblock2]
   21 admin        0 SW   [mtdblock3]
   22 admin        0 SW   [kworker/u:1]
   29 admin        0 SW   [kworker/0:1]
   30 admin        0 SW&lt;  [kpsmoused]
   31 admin        0 SW&lt;  [usbhid_resumer]
   64 admin     1408 S    sysK
   67 admin     1088 S    httpd
   69 admin     1408 S    usb_monitor
   74 admin     3432 S    thttpd -c **.cgi -d /etc_ro/web/ -p 6060 -l /var/log/
  129 admin        0 SW   [RtmpCmdQTask]
  150 admin     1520 S    syslogd
  153 admin      956 S    udhcpd /var/config/udhcpd.conf
  160 admin      952 S    dnsmasq -h -i br0 -r /var/config/resolv.conf
  163 admin     1404 S    upgraded
  164 admin     1524 S    telnetd
  181 admin     5516 S    smbd
  198 admin      912 S    udhcpc -i apcli0 -p /var/run/udhcpc.pid -s /var/link/
  208 admin     1532 S    -sh
  214 admin     1524 R    ps


# cat meminfo
MemTotal:          59524 kB
MemFree:           39984 kB
Buffers:               0 kB
Cached:            11732 kB
SwapCached:            0 kB
Active:             4680 kB
Inactive:           8604 kB
Active(anon):       1552 kB
Inactive(anon):        0 kB
Active(file):       3128 kB
Inactive(file):     8604 kB
Unevictable:           0 kB
Mlocked:               0 kB
SwapTotal:             0 kB
SwapFree:              0 kB
Dirty:                 0 kB
Writeback:             0 kB
AnonPages:          1580 kB
Mapped:             1448 kB
Shmem:                 0 kB
Slab:               4896 kB
SReclaimable:        480 kB
SUnreclaim:         4416 kB
KernelStack:         280 kB
PageTables:          184 kB
NFS_Unstable:          0 kB
Bounce:                0 kB
WritebackTmp:          0 kB
CommitLimit:       47616 kB
Committed_AS:       6180 kB
VmallocTotal:    1048372 kB
VmallocUsed:         972 kB
VmallocChunk:    1045720 kB

# cat version
Linux version 2.6.36 (root@MaxWong) (gcc version 3.4.2) #368 Tue Aug 6 10:29:57 CST 2013

 cat partitions
major minor  #blocks  name

  31        0        192 mtdblock0
  31        1         64 mtdblock1
  31        2         64 mtdblock2
  31        3       7872 mtdblock3</code></pre></div><p>U-Boot boot sequence:</p><div class="codebox"><pre><code>U-Boot 1.1.3 (Jan  7 2013 - 11:32:07)

Board: Ralink APSoC DRAM:  64 MB
relocate_code Pointer at: 83fb4000
enable ephy clock...done. rf reg 29 = 5
SSC disabled.
spi_wait_nsec: 29
spi device id: c8 40 17 c8 40 (4017c840)
Warning: un-recognized chip ID, please update bootloader!
raspi_read: from:30000 len:1000
raspi_read: from:30000 len:1000
============================================
Ralink UBoot Version: 4.1.0.0
--------------------------------------------
ASIC 7620_MP (Port5&lt;-&gt;None)
DRAM component: 512 Mbits DDR, width 16
DRAM bus: 16 bit
Total memory: 64 MBytes
Flash component: SPI Flash
Date:Jan  7 2013  Time:11:32:07
============================================
icache: sets:512, ways:4, linesz:32 ,total:65536
dcache: sets:256, ways:4, linesz:32 ,total:32768

 ##### The CPU freq = 580 MHZ ####
 estimate memory size =64 Mbytes

Please choose the operation:
   1: Load system code to SDRAM via TFTP.
   2: Load system code then write to Flash via TFTP.
   3: Boot system code via Flash (default).
   4: Entr boot command line interface.
   7: Load Boot Loader code then write to Flash via Serial.
   9: Load Boot Loader code then write to Flash via TFTP.
 0

3: System Boot system code via Flash.
## Booting image at bc050000 ...
raspi_read: from:50000 len:40
   Image Name:   Linux Kernel Image
   Image Type:   MIPS Linux Kernel Image (lzma compressed)
   Data Size:    4508895 Bytes =  4.3 MB
   Load Address: 80000000
   Entry Point:  8000c310
raspi_read: from:50040 len:44ccdf
   Verifying Checksum ... OK
   Uncompressing Kernel Image ... OK
No initrd
## Transferring control to Linux (at address 8000c310) ...
## Giving linux memsize in MB, 64

Starting kernel ...


LINUX started...

 THIS IS ASIC
Linux version 2.6.36 (root@MaxWong) (gcc version 3.4.2) #368 Tue Aug 6 10:29:57
CST 2013

 The CPU feqenuce set to 580 MHz

 MIPS CPU sleep mode enabled.
 PCIE: bypass PCIe DLL.
 PCIE: Elastic buffer control: Addr:0x68 -&gt; 0xB4
 disable all power about PCIe
 PCIE: PLL power down for MT7620N
CPU revision is: 00019650 (MIPS 24Kc)
Determined physical RAM map:
 memory: 04000000 @ 00000000 (usable)
Initrd not found or empty - disabling initrd
Zone PFN ranges:
  Normal   0x00000000 -&gt; 0x00004000
Movable zone start PFN for each node
early_node_map[1] active PFN ranges
    0: 0x00000000 -&gt; 0x00004000
Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 16256
Kernel command line: console=ttyS1,57600n8 root=/dev/ram0 console=ttyS0
PID hash table entries: 256 (order: -2, 1024 bytes)
Dentry cache hash table entries: 8192 (order: 3, 32768 bytes)
Inode-cache hash table entries: 4096 (order: 2, 16384 bytes)
Primary instruction cache 64kB, VIPT, 4-way, linesize 32 bytes.
Primary data cache 32kB, 4-way, PIPT, no aliases, linesize 32 bytes
Writing ErrCtl register=000048ab
Readback ErrCtl register=000048ab
Memory: 56628k/65536k available (4324k kernel code, 8908k reserved, 839k data, 2
896k init, 0k highmem)
NR_IRQS:128
MTK/Ralink System Tick Counter init... cd:804edf18, m:214748, s:32
Console: colour dummy device 80x25
console [ttyS1] enabled
Calibrating delay loop... 386.04 BogoMIPS (lpj=772096)
pid_max: default: 32768 minimum: 301
Mount-cache hash table entries: 512
NET: Registered protocol family 16
bio: create slab &lt;bio-0&gt; at 0
usbcore: registered new interface driver usbfs
usbcore: registered new interface driver hub
usbcore: registered new device driver usb
Switching to clocksource Ralink external timer
NET: Registered protocol family 2
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 2048 (order: 2, 16384 bytes)
TCP bind hash table entries: 2048 (order: 1, 8192 bytes)
TCP: Hash tables configured (established 2048 bind 2048)
TCP reno registered
UDP hash table entries: 256 (order: 0, 4096 bytes)
UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
NET: Registered protocol family 1
RT3xxx EHCI/OHCI init.
squashfs: version 4.0 (2009/01/31) Phillip Lougher
NTFS driver 2.1.29 [Flags: R/W].
fuse init (API version 7.15)
Block layer SCSI generic (bsg) driver version 0.4 loaded (major 254)
io scheduler noop registered (default)
HDLC line discipline maxframe=4096
N_HDLC line discipline registered.
Ralink gpio driver initialized
Serial: 8250/16550 driver, 2 ports, IRQ sharing disabled
serial8250: ttyS0 at MMIO 0x10000500 (irq = 37) is a 16550A
serial8250: ttyS1 at MMIO 0x10000c00 (irq = 12) is a 16550A
brd: module loaded
deice id : c8 40 17 c8 40 (4017c840)
maxflash(c8 4017c840) (8192 Kbytes)
mtd .name = raspi, .size = 0x00800000 (0M) .erasesize = 0x00000008 (0K) .numeras
eregions = 65536
Creating 4 MTD partitions on &quot;raspi&quot;:
0x000000000000-0x000000030000 : &quot;Bootloader&quot;
0x000000030000-0x000000040000 : &quot;Config&quot;
0x000000040000-0x000000050000 : &quot;Factory&quot;
0x000000050000-0x000000800000 : &quot;Kernel&quot;
rdm_major = 253
SMACCR1 -- : 0x00008c88
SMACCR0 -- : 0x2b000004
Ralink APSoC Ethernet Driver Initilization. v3.0  256 rx/tx descriptors allocate
d, mtu = 1500!
SMACCR1 -- : 0x00008c88
SMACCR0 -- : 0x2b000004
PROC INIT OK!
PPP generic driver version 2.4.2
PPP Deflate Compression module registered
PPP BSD Compression module registered
PPP MPPE Compression module registered
NET: Registered protocol family 24


=== pAd = c0105000, size = 711224 ===

&lt;-- RTMPAllocTxRxRingMemory, Status=0
&lt;-- RTMPAllocAdapterBlock, Status=0
AP Driver version-2.7.1.5
ehci_hcd: USB 2.0 &#039;Enhanced&#039; Host Controller (EHCI) Driver
rt3xxx-ehci rt3xxx-ehci: Ralink EHCI Host Controller
rt3xxx-ehci rt3xxx-ehci: new USB bus registered, assigned bus number 1
rt3xxx-ehci rt3xxx-ehci: irq 18, io mem 0x101c0000
rt3xxx-ehci rt3xxx-ehci: USB 0.0 started, EHCI 1.00
hub 1-0:1.0: USB hub found
hub 1-0:1.0: 1 port detected
ohci_hcd: USB 1.1 &#039;Open&#039; Host Controller (OHCI) Driver
rt3xxx-ohci rt3xxx-ohci: RT3xxx OHCI Controller
rt3xxx-ohci rt3xxx-ohci: new USB bus registered, assigned bus number 2
rt3xxx-ohci rt3xxx-ohci: irq 18, io mem 0x101c1000
hub 2-0:1.0: USB hub found
hub 2-0:1.0: 1 port detected
usbcore: registered new interface driver cdc_acm
cdc_acm: v0.26:USB Abstract Control Model driver for USB modems and ISDN adapter
s
i8042.c: i8042 controller self test timeout.
Trying to free nonexistent resource &lt;0000000000000060-000000000000006f&gt;
mice: PS/2 mouse device common for all mice
usbcore: registered new interface driver usbhid
usbhid: USB HID core driver
nf_conntrack version 0.5.0 (884 buckets, 3536 max)
nf_conntrack_rtsp v0.6.21 loading
matchsize=264
xt_time: kernel timezone is -0000
nf_nat_rtsp v0.6.21 loading
ip_tables: (C) 2000-2006 Netfilter Core Team, Type=Linux
TCP cubic registered
NET: Registered protocol family 17
802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;
All bugs added by David S. Miller &lt;davem@redhat.com&gt;
_nvram_read checksum = c26e save checksum = c26e
Freeing unused kernel memory: 2896k freed
Hit enter to continue...7620.
switch reg write offset=2004, value=ff0003
switch reg write offset=2104, value=ff0003
switch reg write offset=2204, value=ff0003
switch reg write offset=2304, value=ff0003
switch reg write offset=2404, value=ff0003
switch reg write offset=2504, value=ff0003
switch reg write offset=2010, value=81000c0
switch reg write offset=2110, value=81000c0
switch reg write offset=2210, value=81000c0
switch reg write offset=2310, value=81000c0
switch reg write offset=2410, value=81000c0
switch reg write offset=2510, value=81000c0
switch reg write offset=2610, value=8100000
switch reg write offset=2710, value=8100000
switch reg write offset=2604, value=20ff0003
switch reg write offset=27Raeth v3.0 (04Tasklet, ,SkbRecyclev)
alue=
phy_tx_ring = 0x02eed000, tx_ring = 0xa2eed000

phy_rx_ring0 = 0x02eee000, rx_ring0 = 0xa2eee000
SMACCR1 -- : 0x00008c88
SMACCR0 -- : 0x2b000004
20CDMA_CSG_CFG = 81000000
ffGDMA1_FWD_CFG = 20710000
0003
switch reg write offset=2610, value=81000000
switch reg write offset=2014, value=10001
switch reg write offset=2114, value=10001
switch reg write offset=2214, value=10001
switch reg write offset=2314, value=10001
switch reg write offset=2414, valAlgorithmics/MIPS FPU Emulator v1.5
ue=10002
switch reg write offset=2514, value=10001
SCSI subsystem initialized
Initializing USB Mass Storage driver...
usbcore: registered new interface driver usb-storage
USB Mass Storage support registered.
ifconfig: ioctl 0x8913 failed: No such device
ifconfig: ioctl 0x8913 failed: No such device
ifconfig: ioctl 0x8913 failed: No such device
ifconfig: ioctl 0x8913 failed: No such device
RX DESC a2dbb000  size = 2048
RTMP_TimerListAdd: add timer obj c0175d70!
RTMP_TimerListAdd: add timer obj c0141e40!
RTMP_TimerListAdd: add timer obj c0142290!
RTMP_TimerListAdd: add timer obj c0142324!
RTMP_TimerListAdd: add timer obj c01423b8!
RTMP_TimerListAdd: add timer obj c014244c!
RTMP_TimerListAdd: add timer obj c01424e0!
RTMP_TimerListAdd: add timer obj c0142574!
RTMP_TimerListAdd: add timer obj c0142608!
RTMP_TimerListAdd: add timer obj c014269c!
RTMP_TimerListAdd: add timer obj c0142730!
RTMP_TimerListAdd: add timer obj c01427c4!
RTMP_TimerListAdd: add timer obj c0142858!
RTMP_TimerListAdd: add timer obj c01428ec!
RTMP_TimerListAdd: add timer obj c0142980!
RTMP_TimerListAdd: add timer obj c0142a14!
RTMP_TimerListAdd: add timer obj c0142aa8!
RTMP_TimerListAdd: add timer obj c0142b3c!
RTMP_TimerListAdd: add timer obj c0141e14!
RTMP_TimerListAdd: add timer obj c0142264!
RTMP_TimerListAdd: add timer obj c01422f8!
RTMP_TimerListAdd: add timer obj c014238c!
RTMP_TimerListAdd: add timer obj c0142420!
RTMP_TimerListAdd: add timer obj c01424b4!
RTMP_TimerListAdd: add timer obj c0142548!
RTMP_TimerListAdd: add timer obj c01425dc!
RTMP_TimerListAdd: add timer obj c0142670!
RTMP_TimerListAdd: add timer obj c0142704!
RTMP_TimerListAdd: add timer obj c0142798!
RTMP_TimerListAdd: add timer obj c014282c!
RTMP_TimerListAdd: add timer obj c01428c0!
RTMP_TimerListAdd: add timer obj c0142954!
RTMP_TimerListAdd: add timer obj c01429e8!
RTMP_TimerListAdd: add timer obj c0142a7c!
RTMP_TimerListAdd: add timer obj c0142b10!
RTMP_TimerListAdd: add timer obj c0141de8!
RTMP_TimerListAdd: add timer obj c014c8dc!
RTMP_TimerListAdd: add timer obj c014c9f8!
RTMP_TimerListAdd: add timer obj c014c908!
RTMP_TimerListAdd: add timer obj c0143cbc!
RTMP_TimerListAdd: add timer obj c010a530!
RTMP_TimerListAdd: add timer obj c010b36c!
RTMP_TimerListAdd: add timer obj c010c1a8!
RTMP_TimerListAdd: add timer obj c010cfe4!
RTMP_TimerListAdd: add timer obj c010de20!
RTMP_TimerListAdd: add timer obj c010ec5c!
RTMP_TimerListAdd: add timer obj c010fa98!
RTMP_TimerListAdd: add timer obj c01108d4!
RTMP_TimerListAdd: add timer obj c01439cc!
APSDCapable[0]=0
APSDCapable[1]=0
APSDCapable[2]=0
APSDCapable[3]=0
APSDCapable[4]=0
APSDCapable[5]=0
APSDCapable[6]=0
APSDCapable[7]=0
APSDCapable[8]=0
APSDCapable[9]=0
APSDCapable[10]=0
APSDCapable[11]=0
APSDCapable[12]=0
APSDCapable[13]=0
APSDCapable[14]=0
APSDCapable[15]=0
default ApCliAPSDCapable[0]=0
1. Phy Mode = 6
2. Phy Mode = 6
E2PROM: D0 target power=0xff20
E2PROM: 40 MW Power Delta= 0
3. Phy Mode = 6
RTMP_TimerListAdd: add timer obj c010a128!
AntCfgInit: primary/secondary ant 0/1
Initialize RF Central Registers for E2 !!!
Initialize RF Central Registers for E3 !!!
Initialize RF Channel Registers for E2 !!!
Initialize RF Channel Registers for E3 !!!
Initialize RF DCCal Registers for E2 !!!
Initialize RF DCCal Registers for E3 !!!
D1 = 0, D2 = 12, CalCode = 28 !!!
RT6352_Temperature_Init : BBPR49 = 0x0
RT6352_Temperature_Init : TemperatureRef25C = 0xfffffff6
Current Temperature from BBP_R49=0xfffffffe
 TX BW Filter Calibration !!!
 RX BW Filter Calibration !!!
LOFT Calibration Done!
IQCalibration Start!
IQCalibration Done! CH = 0, (gain= 0, phase=3d)
IQCalibration Start!
IQCalibration Done! CH = 1, (gain= f, phase=3e)
TX IQ Calibration Done!
RTMPSetPhyMode: channel is out of range, use first channel=0
MCS Set = ff ff 00 00 00
SYNC - BBP R4 to 20MHz.l
RTMP_TimerListAdd: add timer obj c014422c!
ADC clcok selection for E3 !!!
Shielding clock selection !!!
Main bssid = 78:d3:8d:02:28:fe
&lt;==== rt28xx_init, Status=0
0x1300 = 00064380
killall: rt2860apd: no process killed
rt2860apd: No such file or directory
device eth2 entered promiscuous mode
device ra0 entered promiscuous mode
device eth2.1 entered promiscuous mode
br0: port 2(eth2.1) entering forwarding state
br0: port 2(eth2.1) entering forwarding state
br0: port 1(ra0) entering forwarding state
br0: port 1(ra0) entering forwarding state
info, udhcp server (v0.9.8) started
time.windows.com: Unknown host
open error
Open /proc/max/macfilter Failed
Interface doesn&#039;t accept private ioctl...
set (8BE2): Invalid argument
Open /proc/max/trackerurl Failed
samba.sh PorayNet WORKGROUP
smbpasswd -a admin admin
startsmbfilepwent_internal: file /etc/smbpasswd did not exist. File successfully
 created.
Added user admin.
device eth2 left promiscuous mode
br0: port 2(eth2.1) entering forwarding state
device eth2 entered promiscuous mode
br0: port 2(eth2.1) entering forwarding state
br0: port 2(eth2.1) entering forwarding state
ADC clcok selection for E3 !!!
Shielding clock selection !!!
IDLE
info, udhcp client (v0.9.8) started
info, Sending discover... (8)
echo (201): /proc/198/oom_adj is deprecated, please use /proc/198/oom_score_adj
instead.
Hit enter to continue...RTMP_TimerListAdd: add timer obj c018ba28!
RTMP_TimerListAdd: add timer obj c018bbe0!
drivers/net/wireless/rt2860v2_ap/../rt2860v2/ap/ap_data.c:4354 assert pEntry-&gt;Ai
d == pRxWI-&gt;WirelessCliIDfailed
info, Sending discover... (10)
info, Sending discover... (12)
info, Sending select for 192.168.1.38...
info, (1) Lease of 192.168.1.38 obtained, lease time 86400
signalling USER1
USER1
Restart service=[time_zone]
IDLE
Hit enter to continue...Keep TIME = 2140963752
Restart WAN service because WAN IP address changed
killall: g3dial: no process killed
info, udhcp server (v0.9.8) started
access_service_total = 0
Open /proc/max/3ginfo Failed
start_qos: No such file or directory
Hit enter to continue...25567 00017.817  298660.0      0.0  1395756586232708.1
47302.2         0
Hit enter to continue...</code></pre></div>											<p class="post-edited">(Last edited by <strong>Sorlas</strong> on 8 Apr 2014, 08:44)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p229549">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Sorlas</div>
					<div class="post-datetime">
						8 Apr 2014, 09:46					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>With the unexspected help of a colleague of mine i managed to read the image from the flash and copy it to the connected USB drive.</p><div class="codebox"><pre><code>cat /dev/mtd3 &gt; /media/sda/sda1/backup</code></pre></div><p>With the following command i managed to copy the full 8MB flash to my USB-Drive.</p><div class="codebox"><pre><code>cat /dev/mtd* &gt; /media/sda/sda1/backupfull</code></pre></div><p>I think this is the frimware because if i open it with a hex editor it starts with the following:</p><div class="codebox"><pre><code>00000000h: 27 05 19 56 E7 14 BD 42 52 00 5F AF 00 44 CC DF ; &#039;..Vç.½BR._¯.DÌß
00000010h: 80 00 00 00 80 00 C3 10 87 4D D2 82 05 05 02 03 ; €...€.Ã.‡MÒ‚....
00000020h: 4C 69 6E 75 78 20 4B 65 72 6E 65 6C 20 49 6D 61 ; Linux Kernel Ima
00000030h: 67 65 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ; ge..............</code></pre></div><p>This is the firmware in executable form, right?</p><p>Now the question if i use <span style="color: blue">2: Load system code then write to Flash via TFTP.</span> do i need to flash the whole 8MB or just the previously read out firmware (ca. 7MB)?</p><p>Which option does not touch my bootloader?</p>											<p class="post-edited">(Last edited by <strong>Sorlas</strong> on 8 Apr 2014, 09:53)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p229775">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Sorlas</div>
					<div class="post-datetime">
						10 Apr 2014, 11:11					</div>
				</div>
				<div class="post-content content">
					<p>Soo i found out myself how to backup/ restore the image in my case. My Stock image is encrypted.<br />A restore directly in the bootloader was not possible because of some strange error which said that there is not enough space on the flash.</p><p><strong>Backup Image:</strong></p><p>1. Check which is the kernel partition<br /></p><div class="codebox"><pre><code># cat /proc/mtd
dev:    size   erasesize  name
mtd0: 00030000 00010000 &quot;Bootloader&quot;
mtd1: 00010000 00010000 &quot;Config&quot;
mtd2: 00010000 00010000 &quot;Factory&quot;
mtd3: 007b0000 00010000 &quot;Kernel&quot;</code></pre></div><p>2. Backup your image by using cat<br /></p><div class="codebox"><pre><code># cat /dev/mtd3 &gt; /PLACE WHERE YOU WANT IT TO BE</code></pre></div><p>3. Save your image in a &quot;safe&quot; place</p><p><strong>Restore factory image:</strong></p><p>1. Choose in the bootloader the option to load firmware into SDRAM and then boot your previously saved image (Option 1)<br /></p><div class="codebox"><pre><code>Please choose the operation:
   1: Load system code to SDRAM via TFTP.
   2: Load system code then write to Flash via TFTP.
   3: Boot system code via Flash (default).
   4: Entr boot command line interface.
   7: Load Boot Loader code then write to Flash via Serial.
   9: Load Boot Loader code then write to Flash via TFTP.</code></pre></div><p>2. Load your backup image via TFTP</p><p>3. Use the regular Webinterface to &quot;upgrade&quot; firmware. This will flash the stock image.</p><p>4. Finished!</p><p>In my case this method work really well but it requires a previously made backup of the unencrypted image. I don&#039;t know why someone should encrypt their image when its then unencrypted saved in the flash ... hmm chinese thinking maybe</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>