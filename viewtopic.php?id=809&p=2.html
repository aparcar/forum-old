<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> WRT54G v2.2 / WRT54GS v1.1</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 6 Apr 2018 and 6 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 2 of 2</div><nav><ul><li><a href="viewtopic.php%3Fid=809&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p3850">
				<div class="post-metadata">
					<div class="post-num">Post #26</div>
					<div class="post-author">knightofoldcode</div>
					<div class="post-datetime">
						11 Jan 2005, 02:09					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><p>The power LED is still flashing.&nbsp; I waited for at least 15 minutes, then plugged the power plug and replugged it in, the LED is still flashing, but the WaRT still booted into OpenWaRT, and is working fine otherthan the original power LED flashing.&nbsp; I can still get into Telnet on the WaRT.&nbsp; I&#039;ll install SSH and I&#039;ll be on my way, unless the Power LED means something.&nbsp; <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />&nbsp; For the moment I&#039;ll ignore it.&nbsp; <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p></blockquote></div><p>I have attempted to modify the state of the LED&#039;s using the following command:</p><div class="codebox"><pre><code>echo &quot;0x01&quot; &gt; /proc/sys/diag</code></pre></div><p>However it did nothing.&nbsp; Command wasn&#039;t error&#039;d out, just silently terminated, after doing a cat on the file in question it returned &quot;1&quot; as expected.&nbsp; &nbsp;Again, the LED did NOT show any difference.</p><p>My suspicions, (And I know almost nothing about this.) is that OpenWaRT is making the power LED stop flashing once booted, to simulate the stock firmware and indicate to user that the WaRT is booted.&nbsp; However the new hardware version has changed something concerning the LED&#039;s and causes the command previuosuly mentioned not to work anymore.&nbsp; However I have NO clue how to fix it, just wanted to enlighten anyone that might know what&#039;s going on, &#039;cause I don&#039;t.&nbsp; <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p3851">
				<div class="post-metadata">
					<div class="post-num">Post #27</div>
					<div class="post-author">yissnn</div>
					<div class="post-datetime">
						11 Jan 2005, 02:16					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve restored completely my G2.2, and re-flashed with RoDents, as said.</p><p>Still the same problem with the wireless!!</p><p>any clues?? </p><p>Thanks<br />yurgi</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p3855">
				<div class="post-metadata">
					<div class="post-num">Post #28</div>
					<div class="post-author">thyeh</div>
					<div class="post-datetime">
						11 Jan 2005, 05:30					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><div class="quotebox"><blockquote><div class="quotebox"><blockquote><p>I tried TheRoDent&#039;s firmware on my GS1.1 but failed. The tftp is successful, but after that the power led keeps flashing.</p></blockquote></div><p>Which hardware version are you using?&nbsp; v2.0, or v2.2?, or any other?</p></blockquote></div><p>I have successfully flashed my firmware with Rodents modified bin.&nbsp; However, I am also experiencing the same problems as you had, ie, flashing power LED.&nbsp; However approximately 30 seconds after the tftp was complete I telnetted to my WaRT, and it worked just fine for me.&nbsp; The power LED is still flashing.&nbsp; I waited for at least 15 minutes, then plugged the power plug and replugged it in, the LED is still flashing, but the WaRT still booted into OpenWaRT, and is working fine otherthan the original power LED flashing.&nbsp; I can still get into Telnet on the WaRT.&nbsp; I&#039;ll install SSH and I&#039;ll be on my way, unless the Power LED means something.&nbsp; <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />&nbsp; For the moment I&#039;ll ignore it.&nbsp; <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><br /><p>I&#039;ll post back my results.</p><p>thyeh:&nbsp; Can you telnet into the WaRT?...&nbsp; Remember that you need to telnet into the IP that was originally set.&nbsp; IE, to tftp it you need to tftp to 192.168.1.1, however for the rest of the time you need to telnet into the WaRT&#039;s address, mine is 192.168.1.250</p></blockquote></div><p>My hardware is GS v1.1. Using openwrt-gs-code.bin.</p><p>I tried the whole procedure again. This time I am sure that it was at 192.168.1.1 on Linksys&#039;s 3.37.2 firmware. But still I get the same result. After the successful tftp, the power led flashes. After 10 min I unpluged then repluged the power, power led flashes. And still I cannot telnet into it.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p3860">
				<div class="post-metadata">
					<div class="post-num">Post #29</div>
					<div class="post-author">marcosmas</div>
					<div class="post-datetime">
						11 Jan 2005, 15:31					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><p>The v2.2 unit I have doesn&#039;t seem to use the ADMTek switch controller. It has a chip labeled BCM5325EKQM, manufactured by Broadcom instead of the ADMtek controller.</p></blockquote></div><p>I wonder if it is possible to separate the 5 ports into differents vlans in the new WRT54G v2.2.<br />With the ADMTek switch it was possible with the admcfg tool and the adm.o module, or I also configured many vlans separating the ports with the adm6996.o module.<br />I haven&#039;t bought a new v2.2 yet so I didn&#039;t try this task.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p3861">
				<div class="post-metadata">
					<div class="post-num">Post #30</div>
					<div class="post-author">TheRoDent</div>
					<div class="post-datetime">
						11 Jan 2005, 15:35					</div>
				</div>
				<div class="post-content content">
					<p>My apologies. It would appear as if there is a problem with the wireless interface on the image I&#039;ve built.</p><p>I should hopefully have it sorted out within a few hours once I&#039;ve completed the full 3.37.2 integration into the OpenWRT tree.</p><p>Unfortunately, it seems like the new driver doesn&#039;t support the IOCTL&#039;s so things like iwconfig won&#039;t work anymore. Not a big issue I suppose, but sad nonetheless.</p><p>I&#039;ll look into the diag LED issue. Haven&#039;t really paid the flashing LED much attention, seeing as I don&#039;t have a front cover on my development WRT.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p3878">
				<div class="post-metadata">
					<div class="post-num">Post #31</div>
					<div class="post-author">TheRoDent</div>
					<div class="post-datetime">
						11 Jan 2005, 23:55					</div>
				</div>
				<div class="post-content content">
					<p>I have now completed a buildroot for openwrt, entirely based on the Linksys 3.37.2 code.</p><p>New snapshot image is available at <a href="http://rodent.za.net/files/openwrt/">http://rodent.za.net/files/openwrt/</a></p><p>I&#039;ve confirmed that the wireless works, and the diag LED is now back to it&#039;s normal nonblinking state <br /> <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /> </p><p>Untested on a GS, but my v2.2 54G took it just fine. I took the liberty to include the &quot;wl&quot; utility, since a wrt without it is pretty useless.</p><p>I&#039;ll upload the buildroot as soon as I&#039;ve had some dinner.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p3880">
				<div class="post-metadata">
					<div class="post-num">Post #32</div>
					<div class="post-author">knightofoldcode</div>
					<div class="post-datetime">
						12 Jan 2005, 01:05					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><div class="quotebox"><blockquote><div class="quotebox"><blockquote><p>Which hardware version are you using?&nbsp; v2.0, or v2.2?, or any other?</p></blockquote></div><p>I have successfully flashed my firmware with Rodents modified bin.&nbsp; However, I am also experiencing the same problems as you had, ie, flashing power LED.&nbsp; However approximately 30 seconds after the tftp was complete I telnetted to my WaRT, and it worked just fine for me.&nbsp; The power LED is still flashing.&nbsp; I waited for at least 15 minutes, then plugged the power plug and replugged it in, the LED is still flashing, but the WaRT still booted into OpenWaRT, and is working fine otherthan the original power LED flashing.&nbsp; I can still get into Telnet on the WaRT.&nbsp; I&#039;ll install SSH and I&#039;ll be on my way, unless the Power LED means something.&nbsp; <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />&nbsp; For the moment I&#039;ll ignore it.&nbsp; <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><br /><p>I&#039;ll post back my results.</p><p>thyeh:&nbsp; Can you telnet into the WaRT?...&nbsp; Remember that you need to telnet into the IP that was originally set.&nbsp; IE, to tftp it you need to tftp to 192.168.1.1, however for the rest of the time you need to telnet into the WaRT&#039;s address, mine is 192.168.1.250</p></blockquote></div><p>My hardware is GS v1.1. Using openwrt-gs-code.bin.</p><p>I tried the whole procedure again. This time I am sure that it was at 192.168.1.1 on Linksys&#039;s 3.37.2 firmware. But still I get the same result. After the successful tftp, the power led flashes. After 10 min I unpluged then repluged the power, power led flashes. And still I cannot telnet into it.</p></blockquote></div><p>In that case I&#039;m unfortunately of no help.&nbsp; (If I was any tobegin with.)&nbsp; I have a WRT54G V2.2.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p3881">
				<div class="post-metadata">
					<div class="post-num">Post #33</div>
					<div class="post-author">knightofoldcode</div>
					<div class="post-datetime">
						12 Jan 2005, 01:08					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><p>My apologies. It would appear as if there is a problem with the wireless interface on the image I&#039;ve built.</p><p>I should hopefully have it sorted out within a few hours once I&#039;ve completed the full 3.37.2 integration into the OpenWRT tree.</p><p>Unfortunately, it seems like the new driver doesn&#039;t support the IOCTL&#039;s so things like iwconfig won&#039;t work anymore. Not a big issue I suppose, but sad nonetheless.</p><p>I&#039;ll look into the diag LED issue. Haven&#039;t really paid the flashing LED much attention, seeing as I don&#039;t have a front cover on my development WRT.</p></blockquote></div><br /><p>LED wasn&#039;t a big concern, just confirming that the same issue was occuring with mine.</p><div class="quotebox"><blockquote><p>Unfortunately, it seems like the new driver doesn&#039;t support the IOCTL&#039;s so things like iwconfig won&#039;t work anymore. Not a big issue I suppose, but sad nonetheless.</p></blockquote></div><p>I noticed that, but didn&#039;t think anything of it, as I&#039;m not used to what the previous versions of the WRT had, or didn&#039;t have.&nbsp; I also noticed it didn&#039;t have &quot;wl&quot; and greatly appreciate it being included in the bin.</p><br /><p>I&#039;ll flash the new bin tonight, I&#039;m &quot;working&quot; (or pretending to be), once I get off, I&#039;ll flash it and give you my results.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p3882">
				<div class="post-metadata">
					<div class="post-num">Post #34</div>
					<div class="post-author">yissnn</div>
					<div class="post-datetime">
						12 Jan 2005, 01:34					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve tried it, IT WORKS!!!!</p><p>Yes, works perfectly indeed. I just want to thank RoDent for his effort and his contribution!!</p><p>By the way... I&#039;ve noticed I have to bring up the wireless every time I boot up. I read somewhere to do it like this:</p><p>wlconfig vlan0 up<br />wlconfig eth1 up<br />wlconfig eth2 up<br />wlconfig eth3 up</p><p>being these 4 interfaces my lan_interfaces. Is it correct? Any other ways to do it?<br />Is it necessary to add a script to do it automatically at start up, or is there a cleaner way??<br />thank you</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p3883">
				<div class="post-metadata">
					<div class="post-num">Post #35</div>
					<div class="post-author">TheRoDent</div>
					<div class="post-datetime">
						12 Jan 2005, 01:55					</div>
				</div>
				<div class="post-content content">
					<p>It appears as if the new &quot;wl.o&quot; modules leaves the interface in a &quot;down&quot; state when the module is inserted.</p><p>A simple &quot;ifconfig eth1 up&quot; in one of your startup scripts should do the trick.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p3884">
				<div class="post-metadata">
					<div class="post-num">Post #36</div>
					<div class="post-author">TheRoDent</div>
					<div class="post-datetime">
						12 Jan 2005, 02:27					</div>
				</div>
				<div class="post-content content">
					<p>Buildroot for 3.37.2 available:</p><p><a href="http://rodent.za.net/files/openwrt/buildroot.tar.bz2">http://rodent.za.net/files/openwrt/buildroot.tar.bz2</a></p><p>Changes (off the top of my head)<br />-Uses 3.37.2 kernel<br />-Netfilter-revert patch disabled (p-o-m seems to patch ok)<br />-Modified version of addpattern to set the extra flag required for the new hardware<br />-added a small patch to correct a compile problem in mtd (due to 3.37.3) changes</p><p>make/openwrt.mk<br />---------------<br />-various changes in the openwrt.mk file, mostly for includes, etc.<br />-symlink used to create &quot;WRT54GS&quot; subdir, so that patches can still apply cleanly<br />-new LINKSYSDIR variable that indicates the location of the extracted linksys code (defined in top level Makefile)<br />-add &quot;customize step&quot; to copy &quot;wl&quot; binary to the rootfs</p><p>Probably lots more I&#039;ve forgotten. I&#039;ll go through a proper diff sometime and write up a complete changelist.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p3885">
				<div class="post-metadata">
					<div class="post-num">Post #37</div>
					<div class="post-author">froot</div>
					<div class="post-datetime">
						12 Jan 2005, 05:34					</div>
				</div>
				<div class="post-content content">
					<p>The latest version (dated 12-Jan-2005 00:09) boots on my gs v1.1. I haven&#039;t tried anything else yet.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p3886">
				<div class="post-metadata">
					<div class="post-num">Post #38</div>
					<div class="post-author">GPSFan</div>
					<div class="post-datetime">
						12 Jan 2005, 06:33					</div>
				</div>
				<div class="post-content content">
					<p>TheRoDent<br />Just grabbed your new buildroot, and it completeded building successfully. However, the image it generated,<br />openwrt-g-code.bin is a different size than the binary from here: <a href="http://rodent.za.net/files/openwrt/">http://rodent.za.net/files/openwrt/</a> <br />(1598464 vs 1602560)</p><p>Normally this would not bother me, but I ran file on several of the binaries in ./buildroot/build_mipsel/root/.... <br />and I get &quot;ERROR: corrupted section header file&quot;<br />I have built openwrt from sources before (March 2004) and file correctly identifies those binaries.<br />My question is what might cause this, all I did was dl the tar.bz2 of buildroot, untar it and ran make.<br />In addition running file on the busybox in the ../busybox-1.00 directory reports &quot;ELF 32-bit LSB MIPS-II.....&quot; as it should. And this busybox binary is a different size from the one in the target root/bin.<br />It&#039;s as if the make .... install is hoseing up the bin&#039;s as it populates the target root directory.</p><p> Thanks...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p3890">
				<div class="post-metadata">
					<div class="post-num">Post #39</div>
					<div class="post-author">TheRoDent</div>
					<div class="post-datetime">
						12 Jan 2005, 10:00					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><p>TheRoDent<br />Just grabbed your new buildroot, and it completeded building successfully. However, the image it generated,<br />openwrt-g-code.bin is a different size than the binary from here: <a href="http://rodent.za.net/files/openwrt/">http://rodent.za.net/files/openwrt/</a> <br />(1598464 vs 1602560)</p></blockquote></div><p>This size difference is interesting, but could be because I copied something additional into my root whilst I was messing around, or because I was still using the linksys addpattern utility at that point. </p><p>Also this is what my sources/dl looks like. It might be different from yours for various reasons. </p><div class="codebox"><pre><code>-rw-r--r--  1 root root    108839 Mar  5  2004 bbc-0.54.3.tgz
-rw-r--r--  1 root root  10575077 Oct 29  2003 binutils-2.14.90.0.7.tar.bz2
-rw-r--r--  1 root root    160605 Jun  8  2004 bridge-utils-1.0.4.tar.gz
-rw-r--r--  1 root root   1118427 Oct 13 11:49 busybox-1.00.tar.bz2
-rw-r--r--  1 root root    134456 Dec 13 22:56 dnsmasq-2.19.tar.gz
-rw-r--r--  1 root root  23279245 Feb 22  2004 gcc-3.3.3.tar.bz2
-rw-r--r--  1 root root    156988 Oct 17 14:33 iptables-1.2.11.tar.bz2
-rw-r--r--  1 root root    302551 Mar 30  2004 libpcap-0.8.3.tar.gz
-rw-r--r--  1 root root    318494 Oct  9 23:55 patch-o-matic-20041009.tar.bz2
-rw-r--r--  1 root root    734588 Jan  5 23:10 sed-4.0.8.tar.gz
-rw-r--r--  1 root root    168340 Aug 31 15:26 squashfs2.0-r2.tar.gz
-rw-r--r--  1 root root   1688686 Jan  1 09:11 uClibc-20050101.tar.bz2
-rw-r--r--  1 root root    119523 Jun 18  2003 wireless_tools.26.tar.gz
-rw-r--r--  1 root root 187839483 Jan  9 10:12 wrt54gs.3.37.2.tgz</code></pre></div><div class="quotebox"><blockquote><p>Normally this would not bother me, but I ran file on several of the binaries in ./buildroot/build_mipsel/root/.... <br />and I get &quot;ERROR: corrupted section header file&quot;</p></blockquote></div><p>file on /usr/sbin/dnsmasq for me: <br /></p><div class="codebox"><pre><code>dnsmasq: ELF 32-bit LSB executable, mips-2 MIPS R3000_LE [bfd bug], version 1 (SYSV), dynamically linked (uses shared libs)file: corrupted section header size.</code></pre></div><p>The &quot;corrupted section header size&quot; is most likely due to &quot;sstrip&quot; the utility used to bare-bone strip the elf-executables that goes on the image. It does some magic with the section headers. This is pretty normal. 2.07 binaries give exactly the same output.</p><p>I don&#039;t think the size difference is anything to fret about. The difference is exactly 4096 bytes, so it&#039;s probably padding.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p3891">
				<div class="post-metadata">
					<div class="post-num">Post #40</div>
					<div class="post-author">GPSFan</div>
					<div class="post-datetime">
						12 Jan 2005, 17:02					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><p>Also this is what my sources/dl looks like. It might be different from yours for various reasons. </p><div class="codebox"><pre><code>-rw-r--r--  1 root root    108839 Mar  5  2004 bbc-0.54.3.tgz
-rw-r--r--  1 root root  10575077 Oct 29  2003 binutils-2.14.90.0.7.tar.bz2
-rw-r--r--  1 root root    160605 Jun  8  2004 bridge-utils-1.0.4.tar.gz
-rw-r--r--  1 root root   1118427 Oct 13 11:49 busybox-1.00.tar.bz2
-rw-r--r--  1 root root    134456 Dec 13 22:56 dnsmasq-2.19.tar.gz
-rw-r--r--  1 root root  23279245 Feb 22  2004 gcc-3.3.3.tar.bz2
-rw-r--r--  1 root root    156988 Oct 17 14:33 iptables-1.2.11.tar.bz2
-rw-r--r--  1 root root    302551 Mar 30  2004 libpcap-0.8.3.tar.gz
-rw-r--r--  1 root root    318494 Oct  9 23:55 patch-o-matic-20041009.tar.bz2
-rw-r--r--  1 root root    734588 Jan  5 23:10 sed-4.0.8.tar.gz
-rw-r--r--  1 root root    168340 Aug 31 15:26 squashfs2.0-r2.tar.gz
-rw-r--r--  1 root root   1688686 Jan  1 09:11 uClibc-20050101.tar.bz2
-rw-r--r--  1 root root    119523 Jun 18  2003 wireless_tools.26.tar.gz
-rw-r--r--  1 root root 187839483 Jan  9 10:12 wrt54gs.3.37.2.tgz</code></pre></div></blockquote></div><p>My sources match the above with the exception of sed,&nbsp; &nbsp;buildroot won&#039;t download a new sed if it is alreaduy installed on your system. I have sed version 4.0.7.</p><br /><div class="quotebox"><blockquote><p>file on /usr/sbin/dnsmasq for me: <br /></p><div class="codebox"><pre><code>dnsmasq: ELF 32-bit LSB executable, mips-2 MIPS R3000_LE [bfd bug], version 1 (SYSV), dynamically linked (uses shared libs)file: corrupted section header size.</code></pre></div></blockquote></div><p>I get <br /></p><div class="codebox"><pre><code> dnsmasq: ERROR: corrupted section header size </code></pre></div><p>I have file-4.06</p><div class="quotebox"><blockquote><p>The &quot;corrupted section header size&quot; is most likely due to &quot;sstrip&quot; the utility used to bare-bone strip the elf-executables that goes on the image. It does some magic with the section headers. This is pretty normal. 2.07 binaries give exactly the same output.</p><br /><p>I don&#039;t think the size difference is anything to fret about. The difference is exactly 4096 bytes, so it&#039;s probably padding.</p></blockquote></div><p>I&#039;m not going to worry about the size issue, but I think I&#039;ll do a bit of pokeing around in the Makefile(s) to see what&#039;s really going on. I might also flash your image, and then ftp over one of my bins and try to run it. That would give me a hint as to whether the bins in my build were really hosed or not.</p><br /><p>Thanks for the help...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p3892">
				<div class="post-metadata">
					<div class="post-num">Post #41</div>
					<div class="post-author">GPSFan</div>
					<div class="post-datetime">
						12 Jan 2005, 20:17					</div>
				</div>
				<div class="post-content content">
					<p>TheRoDent</p><p>Well I flashed your image and it worked fine, except boot_wait was set to off when it started up.<br />I then set boot_wait to on and re-flashed it, all-ok.<br />I then verified boot_wait was still on, it was.<br />I then flashed the image I built. <br />It booted and boot_wait was still on. <br />Things are running fine.</p><p>Great work.</p><p>I poked around in the make files &amp; archives, and it looks like the stripping that takes place during the populating of the target root is now using &quot;sstrip&quot; which comes from sources/openwrt/tools/sstrip.c rather than the one from binutils.<br />Reading that code enlightened me as to why I got the error from file.</p><p>Thanks again...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p3894">
				<div class="post-metadata">
					<div class="post-num">Post #42</div>
					<div class="post-author">TheRoDent</div>
					<div class="post-datetime">
						12 Jan 2005, 21:27					</div>
				</div>
				<div class="post-content content">
					<p>I use file-3.37-3.1, which is probably where the difference comes in.</p><br /><p>Interesting about the boot_wait, I&#039;d have figured that firstboot sets that upon first bootup - firstboot hasn&#039;t changed at all, but I&#039;m not too sure if that is how it&#039;s supposed to happen, or whether it is actually firstboot&#039;s job either.</p><p>Glad to hear it&#039;s worked.</p><p>I&#039;ve tried building some of the packages, some of which are broken. Not too sure exactly why that is (patches for some failing to apply), but I&#039;ve had no problems installing the current openwrt packages from openwrt.org yet, so it&#039;s not very high on my priority list.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p3945">
				<div class="post-metadata">
					<div class="post-num">Post #43</div>
					<div class="post-author">agenthh</div>
					<div class="post-datetime">
						15 Jan 2005, 00:23					</div>
				</div>
				<div class="post-content content">
					<p>One of the most recent builds now works on my WRT54GS v1.1. I can&#039;t remember which one, but the buildroot compiled happily and works well. I managed to mostly brick it thanks to interface-wrt, but a bootwait flash has made it all well again.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p3948">
				<div class="post-metadata">
					<div class="post-num">Post #44</div>
					<div class="post-author">knightofoldcode</div>
					<div class="post-datetime">
						15 Jan 2005, 11:06					</div>
				</div>
				<div class="post-content content">
					<p>I must be missing something here.&nbsp; Am I correct that the correct procedure to re-flash a WaRT is as follows:</p><p>1) Verify that boot_wait is set to on.<br />2) reboot WaRT and on another linux machine execute tftp to send WaRT new flash.<br />3) After the WaRT reboots, get telnet access.&nbsp; After telnet log in and do what you need to do making sure to give firstboot plenty of time to do it&#039;s thing.<br />4) Make sure boot_wait is still set to on.<br />5) reboot and see if you can still get in.</p><p>I&#039;ve done these things and it _appears_ as though it didn&#039;t flash with the new image.&nbsp; Does the image overwrite _everything_?&nbsp; Or does it just rewrite the OpenWaRT software?&nbsp; Because my previous modifications to scripts and other portions of the file system have remained even after the flash.</p><p>tftp executes and seems as though it completed successfully, it never error&#039;ed out, either time I performed the flash.</p><p>Am I missing something here?</p><p>Or is this a bug?&nbsp; (I really doubt that.&nbsp; <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Edit:&nbsp; I&#039;m using the following bin:&nbsp; <a href="http://rodent.za.net/files/openwrt/openwrt-g-code.bin">http://rodent.za.net/files/openwrt/openwrt-g-code.bin</a>&nbsp; Could this link be for a older bin?</p><p>TIA,<br />Knight.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p3963">
				<div class="post-metadata">
					<div class="post-num">Post #45</div>
					<div class="post-author">sephail</div>
					<div class="post-datetime">
						17 Jan 2005, 08:36					</div>
				</div>
				<div class="post-content content">
					<p>I currently purchased a WRT54GS v1.1 (I&#039;ve had some experience with the older v1.0 revision). I successfully flashed RoDent&#039;s firmware and it was working fine for a while...</p><p>I&#039;m not sure if this is specific to the v1.1 hardware, but I&#039;m having the following problem and no one that I&#039;ve spoken to with the old hardware seems to have had it (and as yet few people seem to have a v1.1). My router is effectively &#039;bricked&#039; and in the following state after attempting to re-flash the firmware (a slightly modified version of RoDent&#039;s buildroot, with no significant changes that would provoke such behavior).</p><p>Upon power-on, the router is stuck in the bootloader waiting for a tftp transfer. The power LED flashes and the DMZ LED blinks approximately once every second. I transfer an image and it successfully flashes (or seems to), however, the router then becomes stuck in a state where the power LED is flashing and the DMZ LED is steady on. It will stay in this state until power cycled, where it repeats the same behavior over again (i.e., the beginning of this paragraph).</p><p>I&#039;ve tried to hook up a serial console (ttyS0) using the appropriate 0v - 3.3v -&gt; RS-232 level shifting circuitry, yet no matter what baud, bits, parity, stop bit, etc. settings I try, I simply get garbage (however, the router _is_ sending something). Of course I&#039;ve tried the standard 115200 8N1 setting numerous times to no avail.</p><p>If anyone has any suggestions on how to get the router out of this state, I&#039;d appreciate any tips <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>- Joe</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p3967">
				<div class="post-metadata">
					<div class="post-num">Post #46</div>
					<div class="post-author">marcosmas</div>
					<div class="post-datetime">
						17 Jan 2005, 13:41					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><p>I have now completed a buildroot for openwrt, entirely based on the Linksys 3.37.2 code.</p><p>New snapshot image is available at <a href="http://rodent.za.net/files/openwrt/">http://rodent.za.net/files/openwrt/</a></p><p>I&#039;ve confirmed that the wireless works, and the diag LED is now back to it&#039;s normal nonblinking state</p></blockquote></div><p>Hello, I have problems compiling this buildroot:<br /></p><div class="codebox"><pre><code>make[1]: Entering directory `/home/marcos.schonfeld/WRT54G-3.37.2/buildroot/build_mipsel/WRT54GS_3_37_2_1109_US/release/src/linux/linux&#039;
make[1]: *** No rule to make target `zImage&#039;.  Stop.
make[1]: Leaving directory `/home/marcos.schonfeld/WRT54G-3.37.2/buildroot/build_mipsel/WRT54GS_3_37_2_1109_US/release/src/linux/linux&#039;
make: *** [/home/marcos.schonfeld/WRT54G-3.37.2/buildroot/build_mipsel/WRT54GS_3_37_2_1109_US/release/src/linux/linux/arch/mips/brcm-boards/bcm947xx/compressed/vmlinuz] Error 2</code></pre></div><p>Can anyone help me?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p3981">
				<div class="post-metadata">
					<div class="post-num">Post #47</div>
					<div class="post-author">netmaster</div>
					<div class="post-datetime">
						18 Jan 2005, 13:37					</div>
				</div>
				<div class="post-content content">
					<p>today morning i got 40 of v2.2 routers from linksys and until there is not available switch chip reprogramming interface similar to adm6996, i have nothing to do with them. I have found list of compatible routers from openwrt FAQ. Does anybody can suggests quick and painless hardware replacement for WRT54G v2.0 from that list? Must use same antenna connectors and exactly same openwrt firmware like older WRT54G&#039;s.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p3985">
				<div class="post-metadata">
					<div class="post-num">Post #48</div>
					<div class="post-author">wbx</div>
					<div class="post-datetime">
						18 Jan 2005, 14:33					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I tried the new firmware <a href="http://rodent.za.net/files/openwrt/openwrt-gs-code.bin">http://rodent.za.net/files/openwrt/openwrt-gs-code.bin</a><br />on my Linksys WRT56GS and got following via serial line:<br />(it probably helps to debug some minor bugs)</p><p>Reading :: CODE Pattern is CORRECT!<br />upgrade_ver[v2.7.1] upgrade_ver[20701] 4712_ver[15000]<br />CODE Pattern is CORRECT!<br />upgrade_ver[v2.7.1] upgrade_ver[20701] 4712_ver[15000]<br />Done. 1602560 bytes read<br />fname=flash1.trx <br />CODE Pattern is correct! (W54S)<br />Programming...done. 1602528 bytes written<br />Loader:raw Filesys:raw Dev:flash0.os File: Options:(null)<br />Loading: ...... 1634304 bytes read<br />Entry at 0x80001000<br />Closing network.<br />Starting program at 0x80001000<br />CPU revision is: 00029007<br />Primary instruction cache 8kb, linesize 16 bytes (2 ways)<br />Primary data cache 4kb, linesize 16 bytes (2 ways)&nbsp; &nbsp; &nbsp; &nbsp;<br />Linux version 2.4.20 (root@cms2) (gcc version 3.3.3) #1 Tue Jan 11 22:51:19 SAST 2005<br />Determined physical RAM map:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br /> memory: 02000000 @ 00000000 (usable)<br />On node 0 totalpages: 8192&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />zone(0): 8192 pages.&nbsp; &nbsp; &nbsp; <br />zone(1): 0 pages.&nbsp; &nbsp;<br />zone(2): 0 pages.<br />Kernel command line: root=/dev/mtdblock2 rootfstype=squashfs inCPU: BCM4712 rev 1 at 200 MHz&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />Calibrating delay loop... 199.47 BogoMIPS<br />Memory: 30396k/32768k available (1404k kernel code, 2372k reserved, 100k data, 68k init, 0k highmem)<br />Dentry cache hash table entries: 4096 (order: 3, 32768 bytes)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />Inode cache hash table entries: 2048 (order: 2, 16384 bytes) <br />Mount-cache hash table entries: 512 (order: 0, 4096 bytes)&nbsp; <br />Buffer-cache hash table entries: 1024 (order: 0, 4096 bytes)<br />Page-cache hash table entries: 8192 (order: 3, 32768 bytes) <br />Checking for &#039;wait&#039; instruction...&nbsp; unavailable.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />POSIX conformance testing by UNIFIX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />PCI: Disabled&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />PCI: Fixing up bus 0<br />Linux NET4.0 for Linux 2.4<br />Based upon Swansea University Computer Society NET3.039<br />Initializing RT netlink socket&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />Starting kswapd&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />devfs: v1.12c (20020818) Richard Gooch (rgooch@atnf.csiro.au)<br />devfs: boot_options: 0x1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />JFFS2 version 2.1. (C) 2001 Red Hat, Inc., designed by Axis Communications AB.<br />pty: 256 Unix98 ptys configured&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />Serial driver version 5.05c (2001-07-08) with MANY_PORTS SHARE_IRQ SERIAL_PCI enabled<br />ttyS00 at 0xb8000300 (irq = 3) is a 16550A&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />ttyS01 at 0xb8000400 (irq = 0) is a 16550A<br />Software Watchdog Timer: 0.05, timer margin: 60 sec<br />loop: loaded (max 8 devices)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />PPP generic driver version 2.4.2<br />Flash device: 0x800000 at 0x1c000000<br />Physically mapped flash: squashfs filesystem found at block 913<br />Creating 5 MTD partitions on &quot;Physically mapped flash&quot;:&nbsp; &nbsp; &nbsp; &nbsp; <br />0x00000000-0x00040000 : &quot;pmon&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />0x00040000-0x007e0000 : &quot;linux&quot;<br />0x000e4448-0x001c5d6b : &quot;rootfs&quot;<br />mtd: partition &quot;rootfs&quot; doesn&#039;t start on an erase block boundary -- force read-only<br />0x007e0000-0x00800000 : &quot;nvram&quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />0x001e0000-0x007e0000 : &quot;OpenWrt&quot;<br />sflash: found no supported devices<br />NET4: Linux TCP/IP 1.0 for NET4.0 <br />IP Protocols: ICMP, UDP, TCP&nbsp; &nbsp; &nbsp;<br />IP: routing cache hash table of 512 buckets, 4Kbytes<br />TCP: Hash tables configured (established 2048 bind 4096)<br />ip_conntrack version 2.1 (256 buckets, 2048 max) - 344 bytes per conntrack<br />ip_conntrack_pptp version 1.9 loaded&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />ip_nat_pptp version 1.5 loaded&nbsp; &nbsp; &nbsp; <br />ip_tables: (C) 2000-2002 Netfilter core team<br />NET4: Unix domain sockets 1.0/SMP for Linux NET4.0.<br />NET4: Ethernet Bridge 008 for NET4.0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />Bridge firewalling registered&nbsp; &nbsp; &nbsp; &nbsp;<br />802.1Q VLAN Support v1.7 Ben Greear &lt;greearb@candelatech.com&gt;<br />All bugs added by David S. Miller &lt;davem@redhat.com&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />VFS: Mounted root (squashfs filesystem) readonly.&nbsp; &nbsp;<br />Mounted devfs on /dev&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />Freeing unused kernel memory: 68k freed<br />Algorithmics/MIPS FPU Emulator v1.5&nbsp; &nbsp; <br />Using /lib/modules/2.4.20/diag.o&nbsp; &nbsp;<br />diag boardtype: 00000101<br />using v2 hardware&nbsp; &nbsp; &nbsp; &nbsp;<br />led -&gt; 00&nbsp; &nbsp; &nbsp; &nbsp; <br />led -&gt; 01<br />Unlocking mtd4<br />jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00000000: 0xe188 instead<br />jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00000004: 0x4811 instead<br />jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00000008: 0xb130 instead<br />jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x0000000c: 0xc48c instead<br />... many more of this ...<br />Further such events for this erase block will not be printed&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />JFFS2: Erase block at 0x00000000 is not formatted. It will be erased<br />....<br />Further such events for this erase block will not be printed&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />Old JFFS2 bitmask found at 0x00045978&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />You cannot use older JFFS2 filesystems with newer kernels<br />JFFS2: Erase block at 0x00040000 is not formatted. It will be erased<br />...<br />Further such events for this erase block will not be printed&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />JFFS2: Erase block at 0x00180000 is not formatted. It will be erased<br />jffs2_read_inode(): No data nodes found for ino #6&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />jffs2_read_inode(): But it has children so we fake some modes for it<br />umount: /rom/dev: Device or resource busy&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />init started:&nbsp; BusyBox v1.00 (2005.01.11-21:04+0000) multi-call binary<br />kernel.panic = 3<br />net.ipv4.ip_forward = 1<br />net.ipv4.icmp_echo_ignore_broadcasts = 1<br />net.ipv4.icmp_ignore_bogus_error_responses = 1<br />net.ipv4.tcp_fin_timeout = 30<br />net.ipv4.tcp_keepalive_time = 120<br />net.ipv4.tcp_timestamps = 0<br />jffs2.bbc: SIZE compression mode activated.<br />jffs2_read_inode(): No data nodes found for ino #10<br />jffs2_read_inode(): But it has children so we fake some modes for it<br />Using /lib/modules/2.4.20/et.o&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />5325E&nbsp; &nbsp;phy=FFFFFFFF<br />eth0: Broadcom BCM47xx 10/100 Mbps Ethernet Controller 3.60.13.0<br />Using /lib/modules/2.4.20/wl.o&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />eth1: Broadcom BCM4320 802.11 Wireless Controller 3.60.13.0<br />device eth0 entered promiscuous mode&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />SIOCGIFFLAGS: No such device&nbsp; &nbsp; &nbsp; &nbsp; <br />bridge br0 doesn&#039;t exist; can&#039;t delete it<br />vlan0: add 01:00:5e:00:00:01 mcast address to master interface<br />device eth1 entered promiscuous mode&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br /># eth2 ignored: can&#039;t find/create&nbsp; &nbsp;<br /># eth3 ignored: can&#039;t find/create<br />br0: port 2(eth1) entering learning state<br />br0: port 1(vlan0) entering learning state<br />br0: port 2(eth1) entering forwarding state<br />br0: topology change detected, propagating <br />br0: port 1(vlan0) entering forwarding state<br />br0: topology change detected, propagating&nbsp; <br />info, udhcpc (v0.9.9-pre) started&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />vlan1: add 01:00:5e:00:00:01 mcast address to master interface<br />debug, Sending discover...&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />#&nbsp; ignored: can&#039;t find/create<br />awk: /proc/net/wireless: No such file or directory<br />Usage: wlconf &lt;ifname&gt; up|down<br />debug, Sending discover...<br />Starting sshd: debug, Sending discover...<br />OK<br />led -&gt; 00</p><br /><p>bye</p><p>waldemar</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p3994">
				<div class="post-metadata">
					<div class="post-num">Post #49</div>
					<div class="post-author">marcosmas</div>
					<div class="post-datetime">
						18 Jan 2005, 22:09					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><p>today morning i got 40 of v2.2 routers from linksys and until there is not available switch chip reprogramming interface similar to adm6996, i have nothing to do with them.</p></blockquote></div><p>Hi, I&#039;m interesting in separating the 5 ethernet ports into different vlans and route between them and the wireless interface. I have some wrt54g v2.0 and use the adm6996 module to program the switch but in the new v2.2 there isn&#039;t the ADMtek switch. So i searched in the forum and found this topic</p><p><a href="http://www.openwrt.org/forum/viewtopic.php?t=744&amp;start=0&amp;postdays=0&amp;postorder=asc&amp;highlight=vlan+nvram">http://www.openwrt.org/forum/viewtopic. … vlan+nvram</a></p><div class="quotebox"><blockquote><p>And finally a discussion of the vlan structure<br />(sorry for repeating anything already said but I&#039;m just putting all the info in one place)</p><p>The WRT54G is essentially a WAP54G (wireless access point) with a 6 port switch. There&#039;s only one physical ethernet connection and that&#039;s wired internally into port 5 of the switch; the WAN is port 0 and the LAN is ports 1-4. The separation of the WAN and LAN interfaces is done by the switch itself. The switch has a vlan map which tells it which vlans can be accessed through which ports.</p><p>The vlan configuration is based on two variables (per vlan) in nvram.</p><p>vlan0ports=&quot;1 2 3 4 5*&quot; (use ports 1-4 on the back, 5 is the wrt54g itself)<br />vlan0hwname=&quot;et0&quot;</p><p>When the et module (ethernet driver) loads it will read from vlan0ports to vlan15ports, behind the scenes the ethernet driver is using these variables to generate a more complex configuration which will be sent to the switch. When packets are recieved from external devices they need to be assigned a vlan id, and when packets are sent to those external devices the vlan tags need to be removed.</p><p>PVID represents the primary vlan id, in other words if a packet doesn&#039;t have a vlan tag, which vlan does it belong to? The ethernet driver handles this rather trivially, in the case of vlan0ports=&quot;1 2 3 4 5*&quot;, ports 1-4 are set to PVID 0 (vlan0). Since the wrt needs to recieve packets from both the LAN (vlan0) and the WAN (vlan1), port 5 is a special case appearing in both vlan0ports and vlan1ports. This is where the &#039;*&#039; is used -- it determines the PVID of port 5, which is also the only port not to untag packets (for hopefully obvious reasons).</p><p>The second variable, vlan0hwname is used by the network configuration program (or script in the case of openwrt). As with the wl drivers, the et drivers could potentially control multiple devices, et0 being the first. As with the wl drivers, et0 represents the first ethernet device handled by the ethernet (et) driver. Unfortunately the order of the eth devices in linux may not match the order used by et (eth0 != et0). Instead it&#039;s handled as follows:</p><p>vlan0hwname=et0 =&gt; et0macaddr=xx:xx:xx:xx:xx:xx =&gt; find interface with matching mac address</p></blockquote></div><p>In this topic, it is said that it&#039;s possible to configure the vlanid for each port with the nvram settings. Now I don&#039;t have a wrt54g v2.2 to try this configuration so i ask anybody who has a v2.2 to try this config after I got a new v2.2 unit. Thanks in advance.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p3995">
				<div class="post-metadata">
					<div class="post-num">Post #50</div>
					<div class="post-author">soulhunter</div>
					<div class="post-datetime">
						19 Jan 2005, 05:01					</div>
				</div>
				<div class="post-content content">
					<p>That&#039;s exactly what I&#039;m going to test.</p><p>Are this changes going to be added to the official OpenWRT?</p><p>I had made several suggestions, but I don&#039;t see any of them ever merged, nor commented <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /> .</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 2 of 2</div><nav><ul><li><a href="viewtopic.php%3Fid=809&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>