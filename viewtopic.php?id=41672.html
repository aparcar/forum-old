<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Compiling bleeding edge: swconfig/cli.c needs linux/switch.h</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 5 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p189064">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">spacewrench</div>
					<div class="post-datetime">
						16 Jan 2013, 02:37					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m compiling svnversion 35011 from scratch on a Ubuntu-12.04 VM, targeting an Alfa Hornet-UB board.&nbsp; The kernel in OpenWRT/trunk is 3.6.11, whereas Ubuntu is running 3.2.0-34.&nbsp; The default compilation dies in swconfig when cli.c can&#039;t find &lt;linux/switch.h&gt;.&nbsp; This file was apparently added to the kernel sometime between 3.2.0 and 3.6.11, but more importantly, I believe the failure means that the OpenWRT build system isn&#039;t redirecting include paths properly -- for some reason, the cross compiler is looking in the <em><strong>system&#039;s</strong></em> /usr/include/linux directory rather than OpenWRT/trunk/build_dir/target-mips_r2_uClibc-0.9.33.2/linux-ar71xx_generic/linux-3.6.11/include/linux.</p><p>Have I made a stupid error, or is this just something that most developers don&#039;t hit because they&#039;re running the same kernel on their development boxes as the kernel in the OpenWRT tree?</p><p>Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p189081">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">robthebrew</div>
					<div class="post-datetime">
						16 Jan 2013, 10:09					</div>
				</div>
				<div class="post-content content">
					<p>How did you prepare your build environment?<br />If you use Buildroot (<a href="http://wiki.openwrt.org/doc/howto/buildroot.exigence">http://wiki.openwrt.org/doc/howto/buildroot.exigence</a>) then the whole toolchain and libraries are prepared for you. At which point it doesn&#039;t matter what your host is running.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p189117">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">hyujitong</div>
					<div class="post-datetime">
						16 Jan 2013, 17:17					</div>
				</div>
				<div class="post-content content">
					<p>As already mentioned above, the kernel version version doesn&#039;t matter.&nbsp; The easiest solution would be just start clean with the build making sure all source files are checked out properly.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p189119">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">spacewrench</div>
					<div class="post-datetime">
						16 Jan 2013, 17:59					</div>
				</div>
				<div class="post-content content">
					<p>I am using a Buildroot, which is why I was surprised to see it looking outside the tree.&nbsp; I&#039;ll try a fresh checkout, and if no luck, will post the compiler invocation for help figuring out what &quot;-I&quot; option is wrong/missing.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p189129">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">hyujitong</div>
					<div class="post-datetime">
						16 Jan 2013, 20:04					</div>
				</div>
				<div class="post-content content">
					<p>Probably you are missing some required compilers or related files.&nbsp; Does running &quot;make prereq&quot; spit out any messages?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p189150">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">spacewrench</div>
					<div class="post-datetime">
						17 Jan 2013, 08:14					</div>
				</div>
				<div class="post-content content">
					<p>make prereq doesn&#039;t complain at all.&nbsp; However, with a complete fresh download, and following the instructions at buildroot.exigence, I got a clean build (including swconfig).</p><p>Not sure what was wrong; I guess it was cruft in my old tree.</p><p>Sorry to bother you all!</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>