<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Issue with Samba</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 13 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p192599">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">aleics</div>
					<div class="post-datetime">
						20 Feb 2013, 13:06					</div>
				</div>
				<div class="post-content content">
					<p>Hi all,<br />I upgraded Openwrt on my HG553 and now I can&#039;t share via samba my usb pen. <br />Could you help me please? </p><p>Openwrt:<br />-----------<br />uname -a<br />Linux OpenWrt 3.3.8</p><p>samba3.6</p><p>df /usb<br />/dev/sda1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 7845064&nbsp; &nbsp; 154804&nbsp; &nbsp;7290940&nbsp; &nbsp;2% /usb</p><p>/etc/samba/smb.conf<br />[global]<br />&nbsp; &nbsp; &nbsp; &nbsp; netbios name = openwrt<br />&nbsp; &nbsp; &nbsp; &nbsp; display charset = UTF-8<br />&nbsp; &nbsp; &nbsp; &nbsp; interfaces = 127.0.0.1/8 lo 192.168.3.1/24 br-lan<br />&nbsp; &nbsp; &nbsp; &nbsp; server string = openwrt<br />&nbsp; &nbsp; &nbsp; &nbsp; unix charset = UTF-8<br />&nbsp; &nbsp; &nbsp; &nbsp; workgroup = openwrt<br />&nbsp; &nbsp; &nbsp; &nbsp; browseable = yes<br />&nbsp; &nbsp; &nbsp; &nbsp; deadtime = 30<br />&nbsp; &nbsp; &nbsp; &nbsp; domain master = yes<br />&nbsp; &nbsp; &nbsp; &nbsp; encrypt passwords = true<br />&nbsp; &nbsp; &nbsp; &nbsp; enable core files = no<br />&nbsp; &nbsp; &nbsp; &nbsp; guest account = nobody<br />&nbsp; &nbsp; &nbsp; &nbsp; guest ok = yes<br />&nbsp; &nbsp; &nbsp; &nbsp; invalid users = root<br />&nbsp; &nbsp; &nbsp; &nbsp; local master = yes<br />&nbsp; &nbsp; &nbsp; &nbsp; load printers = no<br />&nbsp; &nbsp; &nbsp; &nbsp; map to guest = Bad User<br />&nbsp; &nbsp; &nbsp; &nbsp; max protocol = SMB2<br />&nbsp; &nbsp; &nbsp; &nbsp; min receivefile size = 16384<br />&nbsp; &nbsp; &nbsp; &nbsp; null passwords = yes<br />&nbsp; &nbsp; &nbsp; &nbsp; obey pam restrictions = yes<br />&nbsp; &nbsp; &nbsp; &nbsp; os level = 20<br />&nbsp; &nbsp; &nbsp; &nbsp; passdb backend = smbpasswd<br />&nbsp; &nbsp; &nbsp; &nbsp; preferred master = yes<br />&nbsp; &nbsp; &nbsp; &nbsp; printable = no<br />&nbsp; &nbsp; &nbsp; &nbsp; security = user<br />&nbsp; &nbsp; &nbsp; &nbsp; smb encrypt = disabled<br />&nbsp; &nbsp; &nbsp; &nbsp; smb passwd file = /etc/samba/smbpasswd<br />&nbsp; &nbsp; &nbsp; &nbsp; socket options = TCP_NODELAY SO_KEEPALIVE IPTOS_LOWDELAY<br />&nbsp; &nbsp; &nbsp; &nbsp; syslog = 2<br />&nbsp; &nbsp; &nbsp; &nbsp; use sendfile = yes<br />&nbsp; &nbsp; &nbsp; &nbsp; writeable = yes<br />[homes]<br />&nbsp; &nbsp; &nbsp; &nbsp; comment&nbsp; &nbsp; &nbsp;= Home Directories<br />&nbsp; &nbsp; &nbsp; &nbsp; browsable&nbsp; &nbsp;= no<br />&nbsp; &nbsp; &nbsp; &nbsp; read only&nbsp; &nbsp;= no<br />&nbsp; &nbsp; &nbsp; &nbsp; create mode = 0750<br />[usb]<br />&nbsp; &nbsp; &nbsp; &nbsp; path = /usb<br />&nbsp; &nbsp; &nbsp; &nbsp; read only = no<br />&nbsp; &nbsp; &nbsp; &nbsp; guest ok = yes<br />&nbsp; &nbsp; &nbsp; &nbsp; create mask = 0777<br />&nbsp; &nbsp; &nbsp; &nbsp; directory mask = 0777</p><p>ps |grep mb<br />32438 root&nbsp; &nbsp; &nbsp; 3128 S&nbsp; &nbsp; /usr/sbin/smbd -D<br />32440 root&nbsp; &nbsp; &nbsp; 3208 S&nbsp; &nbsp; /usr/sbin/nmbd -D</p><p>/etc/config/firewall<br />config &#039;rule&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;src&#039; &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;proto&#039; &#039;udp&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;dest_port&#039; &#039;137-138&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;target&#039; &#039;ACCEPT&#039;<br />config &#039;rule&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;src&#039; &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;proto&#039; &#039;tdp&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;dest_port&#039; &#039;139&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;target&#039; &#039;ACCEPT&#039;<br />config &#039;rule&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;src&#039; &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;proto&#039; &#039;tcp&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;dest_port&#039; &#039;445&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;target&#039; &#039;ACCEPT&#039;</p><p>The XP client is on the same network, can ping OpenWRT router but with no result on map network and with:<br />net view \\192.168.3.1<br />System error 53 has occurred</p><p>The network path was not found.</p><p>Thanks a lot for your help.<br />Alex</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p192818">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">yatakama</div>
					<div class="post-datetime">
						22 Feb 2013, 16:51					</div>
				</div>
				<div class="post-content content">
					<p>Try using security = share first. Also, increase the log level to syslog = 3 to assist debugging. Don&#039;t forget to create a password for the guest account (nobody) in /etc/samba/smbpasswd. You might also need to set browsable = yes for the usb share.<br />Follow the instructions on the wiki page: <a href="http://wiki.openwrt.org/doc/uci/samba">http://wiki.openwrt.org/doc/uci/samba</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p194350">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">aleics</div>
					<div class="post-datetime">
						9 Mar 2013, 17:20					</div>
				</div>
				<div class="post-content content">
					<p>It works, fine!<br />Thanks</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>