<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> WRT54G wiki schematic - WRT54GS v3 ports are reversed</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 9 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p12666">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Void Main</div>
					<div class="post-datetime">
						24 Sep 2005, 18:54					</div>
				</div>
				<div class="post-content content">
					<p>Who created the really nice schematic image of the WRT54G on the wiki?</p><p><span class="postimg"><img src="http://voidmain.is-a-geek.net/i/WRT54_sw1_internal_architecture.png" alt="http://voidmain.is-a-geek.net/i/WRT54_sw1_internal_architecture.png" /></span></p><p>I love the image and it works great for my WRT54G but I just purchased a WRT54GS (v3) and the internal ports are reversed from the G. The labels on the back of the unit are the same but the internal port numbers are reversed. I have modified the image to match my WRT54GS and wondered if you could either make my image better or just use my image and add it to the wiki? Or I could do it too I guess. I am curious though if all versions of the 54GS are this way or just this one version. Here&#039;s my 54GS image:</p><p><span class="postimg"><img src="http://voidmain.is-a-geek.net/i/WRT54_sw2_internal_architecture.png" alt="http://voidmain.is-a-geek.net/i/WRT54_sw2_internal_architecture.png" /></span></p><p>And the difference between the 54G vlan*ports nvram variables and the 54GS:</p><p>default 54G:<br /></p><div class="codebox"><pre><code>vlan0ports=1 2 3 4 5*
vlan1ports=0 5</code></pre></div><p>default 54GS:<br /></p><div class="codebox"><pre><code>vlan0ports=3 2 1 0 5*
vlan1ports=4 5</code></pre></div><p>Thanks!</p><p>EDIT: Updated images.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p12669">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">sailor</div>
					<div class="post-datetime">
						24 Sep 2005, 19:53					</div>
				</div>
				<div class="post-content content">
					<p>The port/vlan assignments have changed on WRT54G V4 as well. They&#039;re probably just rationalising the 2 configurations.</p><p>vlan0: 0 1 2 3 5t&nbsp; (LAN Ports)<br />vlan1: 4 5t&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (WAN Port)</p><p>The case labels for the ports is the same as your drawing of the GS V4 as well.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p12674">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Void Main</div>
					<div class="post-datetime">
						24 Sep 2005, 21:19					</div>
				</div>
				<div class="post-content content">
					<p>I guess it must be the new switch. I know different switches are used in different versions of the G and GS. At least it&#039;s still configurable. It would be nice to get a good list of all of the different versions of G and GS and then I (or the person who originally added this section) could update the wiki and the labels on the schematic images.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p12709">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">dl</div>
					<div class="post-datetime">
						25 Sep 2005, 03:38					</div>
				</div>
				<div class="post-content content">
					<p>Below is from hw v3.1, obviously not the default config. Note that the cable I&#039;m on is plugged into the port labeled &quot;2&quot; on the back, not the &quot;(3)&quot; that robocfg is showing. I&#039;ve got another dozen unopened v3.1&#039;s here so will post a default config when I setup the next one. I did notice that default nvram vars seem to have changed quite a bit with Linksys firmware v4.x vs v3.x.</p><p>- DL</p><div class="codebox"><pre><code>root@nihotspotmark:/# robocfg show
Switch: enabled
Port 0(W): 100FD enabled stp: none vlan: 3 mac: 00:00:00:00:00:00
Port 1(4):  DOWN enabled stp: none vlan: 3 mac: 00:00:00:00:00:00
Port 2(3): 100FD enabled stp: none vlan: 3 mac: 00:00:00:00:00:00
Port 3(2):  DOWN enabled stp: none vlan: 3 mac: 00:00:00:00:00:00
Port 4(1):  DOWN enabled stp: none vlan: 3 mac: 00:00:00:00:00:00
Port 5(C): 100FD enabled stp: none vlan: 3 mac: 00:00:00:00:00:00
VLANs: BCM5325/535x enabled mac_check mac_hash
vlan0:
vlan1:
vlan2:
vlan3: 0 1 2 3 4 5t
vlan4:
vlan5:
vlan6:
vlan7:
vlan8:
vlan9:
vlan10: 0t 5t
vlan11:
vlan12:
vlan13:
vlan14:
vlan15:
root@nihotspotmark:/# nvram show|grep vlan
vlan3hwname=et0
vlan10ports=0 5
size: 9931 bytes (22837 left)
wan_ifnames=vlan1
vlan3ports=0 1 2 3 4 5*
lan_ifname=vlan3
wan_iface=vlan10
wan_ifname=vlan10
vlan10hwname=et0</code></pre></div>											<p class="post-edited">(Last edited by <strong>dl</strong> on 25 Sep 2005, 03:39)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p12710">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">Void Main</div>
					<div class="post-datetime">
						25 Sep 2005, 03:49					</div>
				</div>
				<div class="post-content content">
					<p>Is there any way you can verify your port configurations by not using robocfg? I think it&#039;s broken on the new switches.&nbsp; &nbsp;In fact I just installed robocfg on my and it displays the same thing. The second port numbers in parens (x) is wrong in the robocfg show command. The 1st column is correct. Your port setup is just like my GS v3 and the GS schematic at the top of this page should match your configuration. Thanks for the info! Anybody else?</p><p>EDIT: I updated the images to reflect the WRT54 models. I know that WRT54G v2 are right WRT54GS v3 (the ones I have). I think the other versions are right and if anyone can verify which ones I haven&#039;t listed also match the images that would be great.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p12783">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">dl</div>
					<div class="post-datetime">
						26 Sep 2005, 10:47					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Void Main wrote:</cite><blockquote><p>Is there any way you can verify your port configurations by not using robocfg?</p></blockquote></div><p>I don&#039;t know any way to do this other than to split the switch using vlans. However, I&#039;ve setup a dozen or so v3 and v3.1 hw so far and every one the wan appears to be port 0. And when working out my hotspot setup (hw v3.1 iirc) I left port 4 on vlan0 in case of screwups (many) and don&#039;t recall ever noting that this didn&#039;t correspond with labeled port 4 on the back. So it appears that with hw v3 and v3.1 the ports are not reversed. ie vlanXports corresponds with the label on the back. Sorry, I&#039;m too lazy to do a vlan test - all I really care about is wan vs lan ports, so I can&#039;t state this with certainty other than that the wan port is port 0 as my config would break otherwise.</p><p>ps: note that my units are all &quot;G&quot;, not &quot;GS&quot;. It seems that GS are often one step ahead of G.</p><p>- DL</p>											<p class="post-edited">(Last edited by <strong>dl</strong> on 26 Sep 2005, 11:31)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p12811">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">Void Main</div>
					<div class="post-datetime">
						26 Sep 2005, 17:25					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dl wrote:</cite><blockquote><div class="quotebox"><cite>Void Main wrote:</cite><blockquote><p>Is there any way you can verify your port configurations by not using robocfg?</p></blockquote></div><p>I don&#039;t know any way to do this other than to split the switch using vlans. However, I&#039;ve setup a dozen or so v3 and v3.1 hw so far and every one the wan appears to be port 0. And when working out my hotspot setup (hw v3.1 iirc) I left port 4 on vlan0 in case of screwups (many) and don&#039;t recall ever noting that this didn&#039;t correspond with labeled port 4 on the back. So it appears that with hw v3 and v3.1 the ports are not reversed. ie vlanXports corresponds with the label on the back. Sorry, I&#039;m too lazy to do a vlan test - all I really care about is wan vs lan ports, so I can&#039;t state this with certainty other than that the wan port is port 0 as my config would break otherwise.</p><p>ps: note that my units are all &quot;G&quot;, not &quot;GS&quot;. It seems that GS are often one step ahead of G.</p><p>- DL</p></blockquote></div><p>I&#039;m sorry, you should be correct on this. In fact I already had WRT54G v3.x on my images listed just as you say (correct me if I am wrong). It&#039;s the v4 of the G that has changed.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p12849">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">gerd</div>
					<div class="post-datetime">
						27 Sep 2005, 10:52					</div>
				</div>
				<div class="post-content content">
					<p>Hi !</p><p>Hm nice do you also have such a nice drawing for WRT54G V1 ? for me it&#039;s always confusing talking about these issues, because it seems everybody (expect me) does have at least a WRT54G V2 :-(<br /></p><div class="quotebox"><cite>Void Main wrote:</cite><blockquote><p>Who created the really nice schematic image of the WRT54G on the wiki?<br /><a href="http://voidmain.is-a-geek.net/i/WRT54_sw1_internal_architecture.png">http://voidmain.is-a-geek.net/i/WRT54_s … ecture.png</a></p><p>I love the image and it works great for my WRT54G but I just purchased a WRT54GS (v3) and the internal ports are reversed from the G. The labels on the back of the unit are the same but the internal port numbers are reversed. I have modified the image to match my WRT54GS and wondered if you could either make my image better or just use my image and add it to the wiki? Or I could do it too I guess. I am curious though if all versions of the 54GS are this way or just this one version. Here&#039;s my 54GS image:</p><p><a href="http://voidmain.is-a-geek.net/i/WRT54_sw2_internal_architecture.png">http://voidmain.is-a-geek.net/i/WRT54_s … ecture.png</a></p><p>And the difference between the 54G vlan*ports nvram variables and the 54GS:</p><p>default 54G:<br /></p><div class="codebox"><pre><code>vlan0ports=1 2 3 4 5*
vlan1ports=0 5</code></pre></div><p>default 54GS:<br /></p><div class="codebox"><pre><code>vlan0ports=3 2 1 0 5*
vlan1ports=4 5</code></pre></div><p>Thanks!</p><p>EDIT: Updated images.</p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p12867">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">Void Main</div>
					<div class="post-datetime">
						27 Sep 2005, 14:54					</div>
				</div>
				<div class="post-content content">
					<p>I also have a v1 and v1.1 and I think the port layout is the same as the v2. The problem is it is a different switch and the vlan variables don&#039;t work with it. There used to be a utility called &quot;admcfg&quot; and a kernel module called adm.o so you could control the switch. I have not seen this utility for White Russian RC2 or RC3. Even on the older&nbsp; OpenWRT versions that did have it I could control the ports on it but I could never get routing to work properly. Now that I look back on it it may have been just incorrect iptables issues though. I would like to see an admcfg and kernel module for RC2 and 3 so I can do this on my old units.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p12889">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">gerd</div>
					<div class="post-datetime">
						27 Sep 2005, 21:00					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Void Main wrote:</cite><blockquote><p>I also have a v1 and v1.1 and I think the port layout is the same as the v2.</p></blockquote></div><p>AFAIR at least WIFI is known as eth2<br /></p><div class="quotebox"><cite>Void Main wrote:</cite><blockquote><p>The problem is it is a different switch and the vlan variables don&#039;t work with it. There used to be a utility called &quot;admcfg&quot; and a kernel module called adm.o so you could control the switch.</p></blockquote></div><p>Control ok, i also never get it work a setup like diffrent subnet on each port...<br /></p><div class="quotebox"><cite>Void Main wrote:</cite><blockquote><p>I have not seen this utility for White Russian RC2 or RC3. Even on the older&nbsp; OpenWRT versions that did have it I could control the ports on it but I could never get routing to work properly. Now that I look back on it it may have been just incorrect iptables issues though. I would like to see an admcfg and kernel module for RC2 and 3 so I can do this on my old units.</p></blockquote></div><p>So older on openwrt versions you can setup different subnets on each port ? Or was i only not patience enough ?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>