<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> what kind of bridge should I use?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 28 Mar 2018 and 26 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=35874&amp;p=2.html">2</a></li></ul></nav></div>
			
		
		
			<article class="post" id="p162702">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">fenio</div>
					<div class="post-datetime">
						31 Mar 2012, 10:56					</div>
				</div>
				<div class="post-content content">
					<p>Hello.</p><p>I&#039;m trying to use OpenWRT to bump strenght of signal wifi in my apartment and I have problem to create working configuration.</p><p>Here&#039;s description of what exacly I want to achieve:</p><p>Remote AP with internet access &lt;-&gt; (wifi wpa2/psk) &lt;-&gt; My AP (openwrt) &lt;-&gt; (wired) &lt;-&gt; Server<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (wifi wpa2/psk)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Laptop2&nbsp; &nbsp; &nbsp; Laptop3</p><p>So basically there&#039;s no wired internet access. Only remote AP has internet access and I can&#039;t reconfigure it. I can connect it only with my AP in the client mode (no WDS). </p><p>I tried to configure routed bridge mode but I suppose it&#039;s for wired clients on my AP side. I couldn&#039;t figure out how to connect both wired and wifi clients through it.</p><p>I downloaded also Gargoyle version of OpenWRT and well I could create working configuration but stability of such solution is poor (probably because some ugly hacks named ARPNAT). </p><p>Is it possible to achieve working configuration on vanilla OpenWRT in my scenario?</p><p>What kind of bridge should I use in this case?</p><p>regards<br />fEnIo</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p162718">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">j8soot</div>
					<div class="post-datetime">
						31 Mar 2012, 12:57					</div>
				</div>
				<div class="post-content content">
					<p>Without WDS or 4-address-mode you can only use ARPNAT and from what I have read about it in Gargoyle it shouldn&#039;t be such a poor solution and yes it&#039;s a hack but it makes it possible to achieve a working configuration.</p><p>What are the stability issues?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p162721">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">fenio</div>
					<div class="post-datetime">
						31 Mar 2012, 13:11					</div>
				</div>
				<div class="post-content content">
					<p>Well the server (on my schema from previous post) is being reachable from time to time. Tried to debug it but without success.<br />Seems that NAT of ARPs causes some weird behaviour with bridged interfaces. </p><p>During debugging I&#039;ve been able to hang my AP sending ARP broadcasts. </p><p>Without using wired clients it works quite well, but I want to use that wired server for backup purposes.</p><p>Gargoyle uses ARPNAT for this... and what is being used in DD-WRT? I&#039;ve been able to use similar setup on it, but I wanted to use OpenWRT cause I had problems using package system on DD-WRT (which was hard to debug without strace).</p><p>Anyway if the only solution under OpenWRT is WDS then I&#039;ll try to achieve it.</p><p>Any particular howto I should read? </p><p>Am I able to get working both wired and wireless clients using WDS?<br />What will be the broadcast domain in such scenario? I don&#039;t want to send my backups trough remote AP and back to my AP and wired server connected to it. </p><p>Thanks for your response.</p><p>regards<br />fEnIo</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p162727">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">j8soot</div>
					<div class="post-datetime">
						31 Mar 2012, 14:42					</div>
				</div>
				<div class="post-content content">
					<p>DD-WRT also uses ARPNAT.</p><p>I am also new to OpenWRT. I have used WDS with other routers but I only know the basics so far for OpenWRT.</p><p>The WDS bridge creates a common broadcast domain and I would expect local traffic to be handled locally.</p><p>I am using ath9k but the Broadcom WDS recipe was useful for understanding WDS:</p><p><a href="http://wiki.openwrt.org/doc/recipes/broadcomwds">http://wiki.openwrt.org/doc/recipes/broadcomwds</a></p><p>You can install Luci on the routers and use it to easily configure WDS as a means of getting started.</p>											<p class="post-edited">(Last edited by <strong>j8soot</strong> on 31 Mar 2012, 14:42)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p162819">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">fenio</div>
					<div class="post-datetime">
						1 Apr 2012, 09:49					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve set up WDS between these two routers, but now I can&#039;t connect to my AP (it&#039;s working as WDS client).<br />It should work this way? I mean after bridging my AP is fully transparent and I can&#039;t ssh to it?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p162850">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">fenio</div>
					<div class="post-datetime">
						1 Apr 2012, 13:10					</div>
				</div>
				<div class="post-content content">
					<p>Ok. Forget my last question. It was firewall.</p><p>Anyway WDS seems to be quite unstable <img src="https://forum.openwrt.org/img/smilies/hmm.png" width="15" height="15" alt="hmm" /><br />Every 5-15 minutes I need to restart networking on my AP cause it stops seeing remote AP.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p162864">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">j8soot</div>
					<div class="post-datetime">
						1 Apr 2012, 14:22					</div>
				</div>
				<div class="post-content content">
					<p>Did you check system log to see if it shows any problems?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p162908">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">fenio</div>
					<div class="post-datetime">
						1 Apr 2012, 18:18					</div>
				</div>
				<div class="post-content content">
					<p>Sure I&#039;ve checked it. Unfortunatelly there is no info about problems.<br />Happily it starts to work more stable (1-2h instead of 5-15m), so maybe I can write some script to detect loss and restart networking.<br />Sounds totally stupid, but I don&#039;t have other ideas right now.</p><p>Some hints how to debug it when it happens again?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p162960">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">j8soot</div>
					<div class="post-datetime">
						2 Apr 2012, 03:37					</div>
				</div>
				<div class="post-content content">
					<p>I have setup a WDS bridge between two WR1043ND routers running trunk r31152 and they have been fine for a few hours. I will see how it goes over the next 24 hours.</p><p>I am not sure how to debug the issue you are having.</p><p>I have posted my WDS wireless settings in another thread on here:</p><p><a href="https://forum.openwrt.org/viewtopic.php?pid=162958#p162958">https://forum.openwrt.org/viewtopic.php … 58#p162958</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p162984">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">fenio</div>
					<div class="post-datetime">
						2 Apr 2012, 12:11					</div>
				</div>
				<div class="post-content content">
					<p>Here goes my config:</p><p>config interface &#039;loopback&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;lo&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;127.0.0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.0.0.0&#039;</p><p>config interface &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option type &#039;bridge&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;192.168.2.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;</p><p>config interface &#039;wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option _orig_ifname &#039;wlan0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option _orig_bridge &#039;false&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;192.168.0.2&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option gateway &#039;192.168.0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option broadcast &#039;192.168.0.255&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option dns &#039;192.168.0.1&#039;</p><p>config wifi-device &#039;radio0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option type &#039;mac80211&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option channel &#039;6&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option macaddr &#039;xx:xx:xx:xx:xx:xx&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option hwmode &#039;11gn&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option htmode &#039;HT20&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; list ht_capab &#039;SHORT-GI-40&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; list ht_capab &#039;DSS_CCK-40&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option txpower &#039;20&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option country &#039;US&#039;</p><p>config wifi-iface<br />&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;radio0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option network &#039;wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ssid &#039;Ania&amp;Aga&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option encryption &#039;none&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option wds &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option mode &#039;ap&#039;</p><p>Seems that you have two &quot;config wifi-iface&quot; stanzas. Maybe this is a problem on my setup?</p>											<p class="post-edited">(Last edited by <strong>fenio</strong> on 2 Apr 2012, 12:44)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p162991">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">j8soot</div>
					<div class="post-datetime">
						2 Apr 2012, 12:42					</div>
				</div>
				<div class="post-content content">
					<p>It&#039;s two because the WDS client interface doesn&#039;t provide access for wireless devices (only wired) so I created the access point interface first for those wireless devices and created the second interface for the WDS client.</p><p>Can you also post here your client router configs too?</p><p>Also, I noticed others on here do not post the real mac addresses instead they mask out the mac address with XX:XX:XX:XX:XX or replace it like I do with 11:22:33:44:55:66. It seems it&#039;s best to hide your mac addresses.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p162993">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">fenio</div>
					<div class="post-datetime">
						2 Apr 2012, 12:45					</div>
				</div>
				<div class="post-content content">
					<p>This *is* my client config. And it will be hard to paste server&#039;s configuration cause it&#039;s TP-Link without OpenWRT and I can&#039;t flash with, so it uses original firmware and I simply setup up WDS with its GUI.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p162994">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">j8soot</div>
					<div class="post-datetime">
						2 Apr 2012, 12:48					</div>
				</div>
				<div class="post-content content">
					<p>Also my WDS bridge is working without problems. After the WDS connection is established the WDS client produces no other log entries but the WDS AP (main router) shows these:</p><div class="codebox"><pre><code>Apr  2 09:09:01 OpenWrt daemon.info hostapd: wlan0: STA xx:xx:xx:xx:xx:xx WPA: group key handshake completed (RSN)
Apr  2 09:19:01 OpenWrt daemon.info hostapd: wlan0: STA xx:xx:xx:xx:xx:xx WPA: group key handshake completed (RSN)
Apr  2 09:29:01 OpenWrt daemon.info hostapd: wlan0: STA xx:xx:xx:xx:xx:xx WPA: group key handshake completed (RSN)
Apr  2 09:39:01 OpenWrt daemon.info hostapd: wlan0: STA xx:xx:xx:xx:xx:xx WPA: group key handshake completed (RSN)
Apr  2 09:49:01 OpenWrt daemon.info hostapd: wlan0: STA xx:xx:xx:xx:xx:xx WPA: group key handshake completed (RSN)
Apr  2 09:59:01 OpenWrt daemon.info hostapd: wlan0: STA xx:xx:xx:xx:xx:xx WPA: group key handshake completed (RSN)
Apr  2 10:09:01 OpenWrt daemon.info hostapd: wlan0: STA xx:xx:xx:xx:xx:xx WPA: group key handshake completed (RSN)</code></pre></div><p>It repeats like that every hour.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p162995">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">j8soot</div>
					<div class="post-datetime">
						2 Apr 2012, 12:53					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>fenio wrote:</cite><blockquote><p>This *is* my client config. And it will be hard to paste server&#039;s configuration cause it&#039;s TP-Link without OpenWRT and I can&#039;t flash with, so it uses original firmware and I simply setup up WDS with its GUI.</p></blockquote></div><p>Oh right! That is a strange client config but now it makes more sense now I know you are using TP-Link stock firmware on the main router!</p><p>I tested the same configuration recently so I know for certain that WDS works perfectly between TP-Link stock firmware and OpenWRT.<br />I posted in another thread how I configured for TP-Link stock firmware to OpenWRT:</p><p><a href="https://forum.openwrt.org/viewtopic.php?pid=162617#p162617">https://forum.openwrt.org/viewtopic.php … 17#p162617</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p163062">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">fenio</div>
					<div class="post-datetime">
						2 Apr 2012, 19:52					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for your patience <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>My current config is:</p><p>Remote AP... mostly as in your setup (no encryption and other addresses).</p><p>AP with OpenWRT:</p><p>network:</p><p>config interface &#039;loopback&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;lo&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;127.0.0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.0.0.0&#039;</p><p>config interface &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option type &#039;bridge&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;192.168.0.2&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option gateway &#039;192.168.0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option dns &#039;192.168.0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth0.1&#039;</p><p>wireless:</p><p>config wifi-device &#039;radio0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option type &#039;mac80211&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option channel &#039;6&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option macaddr &#039;xx:xx:xx:xx:xx:xx&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option hwmode &#039;11gn&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option htmode &#039;HT20&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; list ht_capab &#039;SHORT-GI-40&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; list ht_capab &#039;DSS_CCK-40&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option txpower &#039;20&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option country &#039;US&#039;</p><p>config wifi-iface<br />&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;radio0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ssid &#039;Ania&amp;Aga&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option encryption &#039;none&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option wds &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option mode &#039;ap&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option network &#039;lan&#039;</p><p>This seem to work quite well, but now what do I have to do to be able to use wired server?<br />I set up 192.168.0.10 address on it and I can&#039;t even ping 192.168.0.2 nor 192.168.0.1 (remote AP).</p><p>I turned off firewall so it has to be something else.</p>											<p class="post-edited">(Last edited by <strong>fenio</strong> on 2 Apr 2012, 19:53)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p163064">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">fenio</div>
					<div class="post-datetime">
						2 Apr 2012, 20:05					</div>
				</div>
				<div class="post-content content">
					<p>Ok. Just as I thought. I has something to do with VLANs.<br />I simply renamed eth0.1 to eth0 (as I don&#039;t need VLAN) and it works.</p><p>Let&#039;s see how stable it is <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p163067">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">fenio</div>
					<div class="post-datetime">
						2 Apr 2012, 20:08					</div>
				</div>
				<div class="post-content content">
					<p>Well... not so easy <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /><br />I can ping that server from my network but the server itself doesn&#039;t have internet access. It can ping my AP, but not remote AP.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p163077">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">j8soot</div>
					<div class="post-datetime">
						2 Apr 2012, 20:43					</div>
				</div>
				<div class="post-content content">
					<p>Have all routers using the same subnet.</p><p>So when TP-Link stock firmware router is still using 192.168.1.1 for OpenWRT router will have static ip of 192.168.1.2 and the gateway and DNS set to 192.168.1.1.</p><p>Once you do that it should work perfectly.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p163078">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">j8soot</div>
					<div class="post-datetime">
						2 Apr 2012, 20:45					</div>
				</div>
				<div class="post-content content">
					<p>Also I forgot to add, make sure to disable dnsmasq and firewall on the OpenWRT router (or reconfigure instead of disable but I&#039;m not sure about that part yet) as those functions are handled by the TP-Link stock firmware router.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p163079">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">fenio</div>
					<div class="post-datetime">
						2 Apr 2012, 20:51					</div>
				</div>
				<div class="post-content content">
					<p>But it doesn&#039;t work. Wired devices for some reason doesn&#039;t have internet access.<br />I disabled firewall and all DHCP related services.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p163084">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">j8soot</div>
					<div class="post-datetime">
						2 Apr 2012, 21:34					</div>
				</div>
				<div class="post-content content">
					<p>That is strange.</p><p>My setup is different now as it is OpenWRT &lt;-&gt; WDS &lt;-&gt; OpenWRT &lt;-&gt; wired main router. The network config is:<br /></p><div class="codebox"><pre><code>root@OpenWrt:/etc/config# cat network

config interface &#039;loopback&#039;
        option ifname &#039;lo&#039;
        option proto &#039;static&#039;
        option ipaddr &#039;127.0.0.1&#039;
        option netmask &#039;255.0.0.0&#039;

config interface &#039;lan&#039;
        option ifname &#039;eth0.1&#039;
        option type &#039;bridge&#039;
        option proto &#039;static&#039;
        option netmask &#039;255.255.255.0&#039;
        option ipaddr &#039;192.168.2.2&#039;
        option gateway &#039;192.168.2.254&#039;
        option dns &#039;192.168.2.254&#039;

config interface &#039;wan&#039;
        option ifname &#039;eth0.2&#039;
        option proto &#039;dhcp&#039;

config switch
        option name &#039;rtl8366rb&#039;
        option reset &#039;1&#039;
        option enable_vlan &#039;1&#039;

config switch_vlan
        option device &#039;rtl8366rb&#039;
        option vlan &#039;1&#039;
        option ports &#039;1 2 3 4 5t&#039;

config switch_vlan
        option device &#039;rtl8366rb&#039;
        option vlan &#039;2&#039;
        option ports &#039;0 5t&#039;</code></pre></div><p>The other WDS router has 192.168.2.1 and the wired main router has 192.168.2.254 and provides DHCP and internet.</p><p>On your OpenWRT router the changes from defaults should only be to configure the WDS AP settings and configure the lan static ip to 192.168.1.2 and it&#039;s gateway and dns to 192.168.1.1 and of course disable the unwanted services.</p><p>If you do that and ssh into the OpenWRT router can you ping <a href="http://www.google.com">www.google.com</a> etc?</p><p>The other wired devices should simply reach the TP-Link stock firmware router via the WDS bridge for DHCP and get ip such as 192.168.1.100 with gateway 192.168.1.1 and DNS will be whatever the PPPOE WAN has provided the TP-Link stock firmware router.</p><p>Do the wired devices receive those settings?</p>											<p class="post-edited">(Last edited by <strong>j8soot</strong> on 2 Apr 2012, 21:37)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p163088">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">fenio</div>
					<div class="post-datetime">
						2 Apr 2012, 21:56					</div>
				</div>
				<div class="post-content content">
					<p>I suppose the problem is with lack of switch settings. I removed them (don&#039;t know why now).<br />Wired devices don&#039;t receive setting cause I want them to be configured manually.</p><p>I&#039;m trying to find default switch config from freshly flashed OpenWRT. </p><p>Really don&#039;t know why I&#039;ve removed that part... probably to set up the closest to your set up.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p163096">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">j8soot</div>
					<div class="post-datetime">
						2 Apr 2012, 22:28					</div>
				</div>
				<div class="post-content content">
					<p>I think you will get it working if you go back to defaults and configure it again.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p163098">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">fenio</div>
					<div class="post-datetime">
						2 Apr 2012, 22:34					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ll try it tomorrow.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p163248">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">fenio</div>
					<div class="post-datetime">
						4 Apr 2012, 12:37					</div>
				</div>
				<div class="post-content content">
					<p>I close to give up... I can&#039;t believe it&#039;s not possible to simply use LuCI to configure my scenario.</p><p>Now AP works as repeater but AP itself doesn&#039;t have internet access and wired devices either.</p>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=35874&amp;p=2.html">2</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>