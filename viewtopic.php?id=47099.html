<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> My MR3020 Project &quot;brain child&quot;</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 26 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p216392">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">sfranzyshen</div>
					<div class="post-datetime">
						1 Nov 2013, 01:31					</div>
				</div>
				<div class="post-content content">
					<p>MR3020 + internal 4 port usb hub + internal 8G usb flash + 2nd external usb port + internal usb bluetooth v4 + external antenna + internal arduino pro mini + external IDC 40-pin connector passing out arduino data lines &amp; the MR3020&#039;s I2C &amp; UART<br /><span class="postimg"><img src="https://scontent-b-dfw.xx.fbcdn.net/hphotos-prn2/1383669_10151743761322807_275283681_n.jpg" alt="https://scontent-b-dfw.xx.fbcdn.net/hphotos-prn2/1383669_10151743761322807_275283681_n.jpg" /></span><br /><span class="postimg"><img src="https://scontent-a-dfw.xx.fbcdn.net/hphotos-ash3/1012713_10151743762207807_1530247469_n.jpg" alt="https://scontent-a-dfw.xx.fbcdn.net/hphotos-ash3/1012713_10151743762207807_1530247469_n.jpg" /></span><br /><span class="postimg"><img src="https://scontent-b-dfw.xx.fbcdn.net/hphotos-frc3/1390602_10151736221492807_837451939_n.jpg" alt="https://scontent-b-dfw.xx.fbcdn.net/hphotos-frc3/1390602_10151736221492807_837451939_n.jpg" /></span></p>											<p class="post-edited">(Last edited by <strong>sfranzyshen</strong> on 4 Nov 2013, 01:18)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p216394">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Flopsoft</div>
					<div class="post-datetime">
						1 Nov 2013, 01:58					</div>
				</div>
				<div class="post-content content">
					<p>wow, this is what I&#039;m doing, you made it so perfectly !</p><p>respect !</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p216466">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">sfranzyshen</div>
					<div class="post-datetime">
						1 Nov 2013, 20:11					</div>
				</div>
				<div class="post-content content">
					<p>A few more photos of the usb install ... I used a metal frame from an old usb mount from a atx pc case. I soldered the two usb connectors together at the front using the frame and at the back with a ground strap.</p><p><span class="postimg"><img src="http://i51.photobucket.com/albums/f382/sfranzyshen/usb1.png" alt="http://i51.photobucket.com/albums/f382/sfranzyshen/usb1.png" /></span><br /><span class="postimg"><img src="http://i51.photobucket.com/albums/f382/sfranzyshen/usb2.png" alt="http://i51.photobucket.com/albums/f382/sfranzyshen/usb2.png" /></span></p><p>Here is the layout for the 40-pin header ... I didn&#039;t do any level converting on the router side of things ... so becareful! </p><p><span class="postimg"><img src="http://i51.photobucket.com/albums/f382/sfranzyshen/40pin-2.png" alt="http://i51.photobucket.com/albums/f382/sfranzyshen/40pin-2.png" /></span></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p217129">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">sfranzyshen</div>
					<div class="post-datetime">
						9 Nov 2013, 19:02					</div>
				</div>
				<div class="post-content content">
					<p>I have finished up on the &quot;brain child&quot; project and here is my conclusion. First I want to say that I like how things turned out. Second I want to say I wouldn&#039;t do it again. Unless you REALLY need everything in one tiny box. Don&#039;t open your router period.</p><p>The next approach I will take is everything modular. Instead of opening the router and adding I2c. I&#039;m going to add I2C via a usb device. Instead of adding an external antenna, I&#039;m going to add an external usb wifi adapter with an external antenna. Instead of adding the arduino via UART or I2C ... I&#039;m going to add a arduino nano via usb. Finally, I&#039;m going to connect the rest of the usb devices (usb 8gb &amp; usb bluetooth) via an external (powered) usb hub.</p><p><span class="postimg"><img src="http://i51.photobucket.com/albums/f382/sfranzyshen/DSCN1516.jpg" alt="http://i51.photobucket.com/albums/f382/sfranzyshen/DSCN1516.jpg" /></span></p>											<p class="post-edited">(Last edited by <strong>sfranzyshen</strong> on 9 Nov 2013, 19:12)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p217307">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">sfranzyshen</div>
					<div class="post-datetime">
						11 Nov 2013, 21:32					</div>
				</div>
				<div class="post-content content">
					<p>Successful at programming the arduino with the mr3020 using avrdude. </p><p>Here is a shot with the project hooked up to a breadboard with a level converter between the mr3020&#039;s uart and arduino&#039;s uart. I used the arduino ide to build the sketch from a laptop. Then scp (copied) the .hex file to the router over the network. Finally, I used avrdude on the router to upload the hex file to the arduino. Also I used screen from the router to communicate back and forth with the arduino over uart. I am powering the whole thing with a 5600ah usb battery.</p><p><span class="postimg"><img src="http://i51.photobucket.com/albums/f382/sfranzyshen/DSCN1518.jpg" alt="http://i51.photobucket.com/albums/f382/sfranzyshen/DSCN1518.jpg" /></span></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p217315">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">sfranzyshen</div>
					<div class="post-datetime">
						11 Nov 2013, 23:04					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>sfranzyshen wrote:</cite><blockquote><p>Successful at programming the arduino with the mr3020 using avrdude.</p></blockquote></div><p>One problem I have is the arduino needs to be reset before avrdude can upload the hex file. With a normal USB-UART the dtr is connected with reset to reset the arduino before the upload. I was thinking about using a gpio from the router to handle this, but I think I have found a better way. <a href="http://www.instructables.com/id/two-ways-to-reset-arduino-in-software/">Two ways to reset arduino in software</a> Now this will require any firmware I upload to include a software reset function builtin, but it beats needing to hit the reset button manually.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p217406">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">MBS</div>
					<div class="post-datetime">
						12 Nov 2013, 23:51					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>sfranzyshen wrote:</cite><blockquote><p>I have finished up on the &quot;brain child&quot; project and here is my conclusion. First I want to say that I like how things turned out. Second I want to say I wouldn&#039;t do it again. Unless you REALLY need everything in one tiny box. Don&#039;t open your router period.</p><p>The next approach I will take is everything modular. Instead of opening the router and adding I2c. I&#039;m going to add I2C via a usb device. Instead of adding an external antenna, I&#039;m going to add an external usb wifi adapter with an external antenna. Instead of adding the arduino via UART or I2C ... I&#039;m going to add a arduino nano via usb. Finally, I&#039;m going to connect the rest of the usb devices (usb 8gb &amp; usb bluetooth) via an external (powered) usb hub.</p></blockquote></div><p>Hot-plugging devices via USB is certainly convenient, but if longterm reliability is a requirement, you will probably be more satisfied with the solution you presented here (soldering I2C and UART to the board). Random USB disconnects can be a big pain in the ass.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>