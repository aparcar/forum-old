<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Cifs share mounts but cannot see files</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 1 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p255438">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">a_user</div>
					<div class="post-datetime">
						24 Nov 2014, 22:23					</div>
				</div>
				<div class="post-content content">
					<p>Hello</p><p>I want to mount a remote device (TOSHIBA EXT NTFS), connected to a vodafon &#039;easybox&#039;.</p><p>root@OpenWrt:/mnt# mount.cifs //192.168.2.1/backup2t/ /mnt/backup2t -rw --verbose -o&nbsp; user=a_user,pass=****<br />mount.cifs kernel mount options: ip=192.168.2.1,unc=\\192.168.2.1\backup2t,,ver=1,user=a_user,pass=****<br />root@OpenWrt:/mnt# df<br />Filesystem&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1K-blocks&nbsp; &nbsp; &nbsp; Used Available Use% Mounted on<br />rootfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 15579732&nbsp; &nbsp; 373648&nbsp; 14424416&nbsp; &nbsp;3% /<br />/dev/root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2048&nbsp; &nbsp; &nbsp; 2048&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 100% /rom<br />tmpfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 63340&nbsp; &nbsp; &nbsp; 1448&nbsp; &nbsp; &nbsp;61892&nbsp; &nbsp;2% /tmp<br />tmpfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 512&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp;512&nbsp; &nbsp;0% /dev<br />/dev/sda1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;15579732&nbsp; &nbsp; 373648&nbsp; 14424416&nbsp; &nbsp;3% /overlay<br />overlayfs:/overlay&nbsp; &nbsp; 15579732&nbsp; &nbsp; 373648&nbsp; 14424416&nbsp; &nbsp;3% /<br />/dev/sdb1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 975785200&nbsp; 44826744 882120468&nbsp; &nbsp;5% /mnt/sdb1<br />//192.168.2.1/backup2t/<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1953410044&nbsp; &nbsp; 228976 1953181068&nbsp; &nbsp;0% /mnt/backup2t</p><p>I can save files on the mounted device, but the files are empty.</p><p>Also, &#039;ls&#039; doesn&#039;t&nbsp; work<br />ls -l doesn&#039;t list any files<br />root@OpenWrt:/mnt# ls -l /mnt/backup2t/<br />-&gt; no response...</p><p>Mounting the same device with nautilus (Ubuntu 12.04) from another client of the network works:<br />nadine@nadine-Lenovo-G585:~/.gvfs$ ls -l backup2t\ auf\ 192.168.2.1/<br />insgesamt 81575<br />-rwx------ 1 nadine nadine 83532344 Nov&nbsp; 7&nbsp; 2013 NTI Backup Now EZ.exe<br />drwx------ 1 nadine nadine&nbsp; &nbsp; &nbsp; &nbsp; 0 Nov 24 18:12 Test<br />-rwx------ 1 nadine nadine&nbsp; &nbsp; &nbsp; &nbsp; 0 Nov 24 18:08 test2.txt<br />-rwx------ 1 nadine nadine&nbsp; &nbsp; &nbsp; &nbsp; 0 Nov 24 18:07 test.txt<br />drwx------ 1 nadine nadine&nbsp; &nbsp; &nbsp; &nbsp; 0 Okt 25 22:53 twonkymedia.db</p><p>Thanks in advance,<br />a_user</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p255492">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">a_user</div>
					<div class="post-datetime">
						25 Nov 2014, 12:52					</div>
				</div>
				<div class="post-content content">
					<p>I tried this after installing kmod-nls-utf8:<br />mount.cifs kernel mount options: ip=192.168.2.1,unc=\\192.168.2.1\backup2t,iocharset=utf8,file_mode=0777,dir_mode=0777,nounix,noserverino,ver=1,user=a_user,pass=********</p><p>saved files are still empty and ls still doesn&#039;t work..</p>											<p class="post-edited">(Last edited by <strong>a_user</strong> on 25 Nov 2014, 12:58)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p255496">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						25 Nov 2014, 13:35					</div>
				</div>
				<div class="post-content content">
					<p>You forgot to mention, which Openwrt version you are using. It has impact to the needed options.</p><p>Your situation might be different, as the drive seems to mount, but you might still read my old message:<br /><a href="https://forum.openwrt.org/viewtopic.php?pid=202745#p202745">https://forum.openwrt.org/viewtopic.php â€¦ 45#p202745</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p255504">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">a_user</div>
					<div class="post-datetime">
						25 Nov 2014, 14:58					</div>
				</div>
				<div class="post-content content">
					<p>Thanks hnyman...<br />root@OpenWrt:/mnt# uname -r<br />3.3.8</p><p>now i specified the unc and sec option (i hope this is correct):</p><p>root@OpenWrt:/mnt# mount.cifs //192.168.2.1/backup2t/ /mnt/backup2t -rw --verbose -o user=a_user,pass=***,dom=WORKGROUP,iocharset=utf8,file_<br />mode=0777,dir_mode=0777,nounix,noserverino,sec=ntlm,unc=\\\\192.168.2.1\\backup2t</p><p>-&gt; &#039;ls&#039; is still not working...</p><p>i can have access through the Server Message Block protocol:</p><p>root@OpenWrt:/mnt# smbclient -U a_user //192.168.2.1/backup2t/<br />Enter a_user&#039;s password: <br />smb: \&gt; ls<br />&nbsp; .&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;D&nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; Thu Jan&nbsp; 1 01:00:00 1970<br />&nbsp; ..&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; D&nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; Thu Jan&nbsp; 1 01:00:00 1970<br />&nbsp; NTI Backup Now EZ.exe&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;A 83532344&nbsp; Thu Nov&nbsp; 7 02:07:10 2013<br />&nbsp; test2.txt&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; Tue Nov 25 12:06:39 2014<br />&nbsp; twonkymedia.db&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; D&nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; Sat Oct 25 22:53:46 2014</p><p>&nbsp; &nbsp; &nbsp; &nbsp; 59613 blocks of size 33554432. 59606 blocks available<br />smb: \&gt;</p>											<p class="post-edited">(Last edited by <strong>a_user</strong> on 25 Nov 2014, 15:51)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p255558">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">a_user</div>
					<div class="post-datetime">
						25 Nov 2014, 22:50					</div>
				</div>
				<div class="post-content content">
					<p>I tried a permanently mount via fstab. However, there seems to be a problem with block-mount:</p><br /><p>root@OpenWrt:~# opkg install block-mount <br />Package block-mount (0.2.0-9) installed in root is up to date.</p><p>root@OpenWrt:~# block detect &gt; /etc/config/fstab<br />-ash: block: not found</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p255584">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">eduperez</div>
					<div class="post-datetime">
						26 Nov 2014, 09:03					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>a_user wrote:</cite><blockquote><p>I tried a permanently mount via fstab. However, there seems to be a problem with block-mount:</p><br /><p>root@OpenWrt:~# opkg install block-mount <br />Package block-mount (0.2.0-9) installed in root is up to date.</p><p>root@OpenWrt:~# block detect &gt; /etc/config/fstab<br />-ash: block: not found</p></blockquote></div><p>&quot;block&quot; is part of &quot;block-mount&quot;, and should be at &quot;/sbin/block&quot;; if that is not the case, I would try reinstalling &quot;block-mount&quot;.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p255587">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						26 Nov 2014, 09:37					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>a_user wrote:</cite><blockquote><p>root@OpenWrt:/mnt# uname -r<br />3.3.8</p></blockquote></div><p>Based on the kernel version, you are using the unsupported old Attitude Adjustment 12.09. It has old block-mount implementation (separate package instead of being part of ubox) and other differences compared to the current stable Barrier Breaker 14.07 (or trunk), so the advice on Wiki is partially wrong for you. I suggest that you update your router to the current version first, and then try it again.</p><p>Ps. Have you installed the needed nls files? kmod-nls-utf8 or some others might be needed ?<br />Have you checked system log or kernel log for possible errors? (commands: &quot;logread&quot; and &quot;dmesg&quot;)</p>											<p class="post-edited">(Last edited by <strong>hnyman</strong> on 26 Nov 2014, 09:53)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p255672">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">a_user</div>
					<div class="post-datetime">
						26 Nov 2014, 23:06					</div>
				</div>
				<div class="post-content content">
					<p>Thanks to all. <br />kmod-nls-utf8 and some other nls packages are installed. I guess mount.cifs should run on Attitude Adjustment 12.09 as well. Is block-mount a precondition for mount.cifs? The funny thing is, that I can mount a remote device (unix server I guess) via openvpn tunnel with mount.cifs and without any problem. Thus, the problem seems to be cifs / easybox specific, while gvfs can deal with it&nbsp; (no specs just username, password that&#039;s it) - funny.<br />However, I will update the router tomorrow, but I don&#039;t expect much from it.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>