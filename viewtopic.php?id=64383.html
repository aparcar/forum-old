<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Extroot and /  how to undo please?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 29 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p320941">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">baxterdmutt</div>
					<div class="post-datetime">
						23 Apr 2016, 04:01					</div>
				</div>
				<div class="post-content content">
					<p>Somehow when I followed the instructions to add extroot to a usb drive I managed to also have the / &quot;root&quot; directory move onto the usb stick as well.&nbsp; I&#039;ve tried searching the forums and google on how to put it back to the way it was but I can&#039;t find anything. So my listing looks like this and I know from the instructions that / should not have grown.&nbsp; I&#039;m also having a problem where I can only mount the second usb stick by using the mount /dev/sdb1 command (it was working using block mount before).&nbsp; Block mount and luci can&#039;t mount it or see it.&nbsp; Dmesg confirms it&#039;s there and I can mount with &quot;mount /dev/sdb1 /mnt/share&quot; so I think this has to do with whatever I&#039;ve done to root.<br />Filesystem&nbsp; &nbsp; Mount Point&nbsp; &nbsp; Available&nbsp; &nbsp; Used<br />roots&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 804.83 MB / 898.37 MB&nbsp; &nbsp; &nbsp; &nbsp; 4% (31.04 MB)<br />/dev/root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /rom&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.00 B / 2.25 MB&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;100% (2.25 MB)<br />temps&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /tmp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;60.98 MB / 61.62 MB&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1% (660.00 KB)<br />/dev/sda1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/overlay&nbsp; &nbsp; &nbsp; 804.83 MB / 898.37 MB&nbsp; &nbsp; &nbsp; &nbsp; 4% (31.04 MB)<br />overlayfs:/overlay&nbsp; &nbsp; /&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;804.83 MB / 898.37 MB&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4% (31.04 MB)<br />temps&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /dev&nbsp; &nbsp; &nbsp; &nbsp; 512.00 KB / 512.00 KB&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0% (0.00 B)</p><p>Thanks all</p>											<p class="post-edited">(Last edited by <strong>baxterdmutt</strong> on 23 Apr 2016, 04:44)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p320963">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Max Hopper</div>
					<div class="post-datetime">
						23 Apr 2016, 09:57					</div>
				</div>
				<div class="post-content content">
					<p>Post <em>/dev/mtd{1..9}/etc/fstab</em>.</p><div class="quotebox"><cite>OpenWrt AP wrote:</cite><blockquote><p>root@OpenWrt:~# df -h<br />Filesystem&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Size&nbsp; &nbsp; &nbsp; Used Available Use% Mounted on<br />/dev/root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2.0M&nbsp; &nbsp; &nbsp; 2.0M&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 100% /rom<br />tmpfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 13.8M&nbsp; &nbsp; &nbsp;80.0K&nbsp; &nbsp; &nbsp;13.7M&nbsp; &nbsp;1% /tmp<br />/dev/sda2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1.8G&nbsp; &nbsp; &nbsp;10.2M&nbsp; &nbsp; &nbsp; 1.7G&nbsp; &nbsp;1% /overlay<br />overlayfs:/overlay&nbsp; &nbsp; &nbsp; &nbsp; 1.8G&nbsp; &nbsp; &nbsp;10.2M&nbsp; &nbsp; &nbsp; 1.7G&nbsp; &nbsp;1% /<br />tmpfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;512.0K&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; 512.0K&nbsp; &nbsp;0% /dev<br />/dev/sda1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1.9G&nbsp; &nbsp; &nbsp; 4.0K&nbsp; &nbsp; &nbsp; 1.9G&nbsp; &nbsp;0% /mnt/vfat<br />/dev/sda2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1.8G&nbsp; &nbsp; &nbsp;10.2M&nbsp; &nbsp; &nbsp; 1.7G&nbsp; &nbsp;1% /mnt/ext2</p></blockquote></div><p><strong>HINT</strong>: remove the USB drive and boot the AP.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p320984">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">baxterdmutt</div>
					<div class="post-datetime">
						23 Apr 2016, 18:01					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Max Hopper wrote:</cite><blockquote><p>Post <em>/dev/mtd{1..9}/etc/fstab</em>.</p><div class="quotebox"><cite>OpenWrt AP wrote:</cite><blockquote><p>root@OpenWrt:~# df -h<br />Filesystem&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Size&nbsp; &nbsp; &nbsp; Used Available Use% Mounted on<br />/dev/root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2.0M&nbsp; &nbsp; &nbsp; 2.0M&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 100% /rom<br />tmpfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 13.8M&nbsp; &nbsp; &nbsp;80.0K&nbsp; &nbsp; &nbsp;13.7M&nbsp; &nbsp;1% /tmp<br />/dev/sda2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1.8G&nbsp; &nbsp; &nbsp;10.2M&nbsp; &nbsp; &nbsp; 1.7G&nbsp; &nbsp;1% /overlay<br />overlayfs:/overlay&nbsp; &nbsp; &nbsp; &nbsp; 1.8G&nbsp; &nbsp; &nbsp;10.2M&nbsp; &nbsp; &nbsp; 1.7G&nbsp; &nbsp;1% /<br />tmpfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;512.0K&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; 512.0K&nbsp; &nbsp;0% /dev<br />/dev/sda1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1.9G&nbsp; &nbsp; &nbsp; 4.0K&nbsp; &nbsp; &nbsp; 1.9G&nbsp; &nbsp;0% /mnt/vfat<br />/dev/sda2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1.8G&nbsp; &nbsp; &nbsp;10.2M&nbsp; &nbsp; &nbsp; 1.7G&nbsp; &nbsp;1% /mnt/ext2</p></blockquote></div><p><strong>HINT</strong>: remove the USB drive and boot the AP.</p></blockquote></div><p>Tried that. The above listing shows the same with or without the USB drive in the AP&nbsp; after a reboot!&nbsp; It shows there&#039;s an overlay even when there isn&#039;t. And if I reboot without the USB ans ssh in and do an ls, nothing returns as if I&#039;m ls&#039;ing an empty directory. But the router works.</p>											<p class="post-edited">(Last edited by <strong>baxterdmutt</strong> on 23 Apr 2016, 18:12)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p320986">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Max Hopper</div>
					<div class="post-datetime">
						23 Apr 2016, 18:39					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>baxterdmutt wrote:</cite><blockquote><p>The above listing shows the same with or without the USB drive in the AP&nbsp; after a reboot!</p></blockquote></div><p>Remarkable. &#039;cloud&#039; storage is now passé.</p><div class="quotebox"><cite>baxterdmutt wrote:</cite><blockquote><p>... reboot without the USB ans ssh in and do an ls, nothing returns as if I&#039;m ls&#039;ing an empty directory.</p></blockquote></div><p>It is. Try -</p><div class="codebox"><pre><code>ls /</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p320990">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">baxterdmutt</div>
					<div class="post-datetime">
						23 Apr 2016, 19:01					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Max Hopper wrote:</cite><blockquote><div class="quotebox"><cite>baxterdmutt wrote:</cite><blockquote><p>The above listing shows the same with or without the USB drive in the AP&nbsp; after a reboot!</p></blockquote></div><p>Remarkable. &#039;cloud&#039; storage is now passé.</p></blockquote></div><p> <br />Ok. I think it&#039;s weird also and kind of funny, but can it be fixed?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p320993">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">baxterdmutt</div>
					<div class="post-datetime">
						23 Apr 2016, 19:08					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Max Hopper wrote:</cite><blockquote><div class="quotebox"><cite>baxterdmutt wrote:</cite><blockquote><p>... reboot without the USB ans ssh in and do an ls, nothing returns as if I&#039;m ls&#039;ing an empty directory.</p></blockquote></div><p>It is. Try -</p><div class="codebox"><pre><code>ls /</code></pre></div></blockquote></div><p> It still shows empty but there are certainly files there because the AP works and if I vi /etc/fstab I can see the file (read only) I can only edit it with the USB inserted. Yet if I cd /etc/config It&#039;s empty without the USB</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p321000">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">sera</div>
					<div class="post-datetime">
						23 Apr 2016, 20:47					</div>
				</div>
				<div class="post-content content">
					<p>You could run /sbin/firstboot to reset your router, assuming you have backups or don&#039;t care.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p321003">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">baxterdmutt</div>
					<div class="post-datetime">
						23 Apr 2016, 21:01					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>sera wrote:</cite><blockquote><p>You could run /sbin/firstboot to reset your router, assuming you have backups or don&#039;t care.</p></blockquote></div><p> I thought that might be a solution, but had hoped there were some config files that may have gotten messed up and I could fix them. I only know about the fstab and it does show anything for the root pointing to the USB.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p321009">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">sera</div>
					<div class="post-datetime">
						23 Apr 2016, 22:16					</div>
				</div>
				<div class="post-content content">
					<p>You know best what you did and alas what to change back. Also it&#039;s likely that you confuse /etc/fstab with /etc/config/fstab.</p><p>As it appears you still have some level of access you can possibly back up what you need. Maybe the configuration files are already safe on the now unplugged usb drive.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p321014">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">baxterdmutt</div>
					<div class="post-datetime">
						23 Apr 2016, 23:12					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>sera wrote:</cite><blockquote><p>You know best what you did and alas what to change back. Also it&#039;s likely that you confuse /etc/fstab with /etc/config/fstab.</p><p>As it appears you still have some level of access you can possibly back up what you need. Maybe the configuration files are already safe on the now unplugged usb drive.</p></blockquote></div><p>So I followed the instruction on the USB Extroot wiki page to the T.&nbsp; So I don&#039;t know more than that would likely be caused by a bug. It initially looked like it worked fine and then when I plugged in a second USB (my AP has 2 ports) everything changed and the problems started. I didn&#039;t do anything. <br />And I only have the 3 fstab files. One at /etc/config/fstab and the other at /overlay/upper/etc/config/fstab and then the one in the /tmp directory. As I understand it that&#039;s normal. Also if I add a mount to the /etc/config/fstab and do a block mount it is ignored but if I use the mount command and do mount /dev/sdb1 /mint/share it mounts. <br />I think I&#039;m just going to reset the AP and start over. I must have found a bug, but since no one else has come across it it&#039;s probably a one off. Thanks for helping though.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>