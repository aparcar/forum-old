<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Wifi Roaming</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 21 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p303099">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Fox1</div>
					<div class="post-datetime">
						10 Dec 2015, 00:56					</div>
				</div>
				<div class="post-content content">
					<p>Does anyone use wifi 802.11r roaming?<br />With UCI I could not put more r0kh.<br />It would be helpful for a configuration.<br />Thank you<br />Fox1</p>											<p class="post-edited">(Last edited by <strong>Fox1</strong> on 10 Dec 2015, 00:56)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p303277">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">luqiusuoit</div>
					<div class="post-datetime">
						11 Dec 2015, 08:11					</div>
				</div>
				<div class="post-content content">
					<p>1.Without UCI ,I want to just edit /etc/config/wireless according to <a href="https://wiki.openwrt.org/doc/uci/wireless?s">https://wiki.openwrt.org/doc/uci/wireless?s</a>[]=802&amp;s[]=11r.<br />There is something about &quot;Fast BSS transition Options&quot; in this URL.<br />Is this right?<br />2.Do you edit other file?<br />3. Can you give a example?</p><p>Thank you very mush! <img src="https://forum.openwrt.org/img/smilies/tongue.png" width="15" height="15" alt="tongue" /></p>											<p class="post-edited">(Last edited by <strong>luqiusuoit</strong> on 11 Dec 2015, 08:12)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p303281">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">J1mbo</div>
					<div class="post-datetime">
						11 Dec 2015, 09:10					</div>
				</div>
				<div class="post-content content">
					<p>I have these enabled but I&#039;ve not yet sniffed the LAN side of the AP to confirm if it&#039;s working. I&#039;m running full hostapd (instead of wpad-mini).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p303487">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">J1mbo</div>
					<div class="post-datetime">
						13 Dec 2015, 11:01					</div>
				</div>
				<div class="post-content content">
					<p>Currently I can see the AP&#039;s announcing a mobility domain -</p><div class="codebox"><pre><code>Mobility Domain Identifier: 0xeeee
FT Capability and Policy: 1
Fast BSS Transition over DS: 1
Resource Request Protocol Capability: 0</code></pre></div><p>However I&#039;m yet to observe a fast roam. Here are the three AP&#039;s 802.11r sections:</p><div class="codebox"><pre><code>    # 802.11r Fast Roaming
    option ieee80211r       &#039;1&#039;
    option nasid         &#039;04A151B240B1&#039;
    option r1_key_holder    &#039;04A151B240B1&#039;
    option mobility_domain    &#039;EEEE&#039;
    option r0kh        &#039;C0:4A:00:AB:E7:0E,C04A00ABE70E,0f0e0d0c0b0a09080706050403020100&#039;
    option r0kh        &#039;C0:4A:00:AB:FA:EC,C04A00ABFAEC,0f0e0d0c0b0a09080706050403020101&#039;
    option r1kh        &#039;C0:4A:00:AB:E7:0E,C0:4A:00:AB:E7:0E,000102030405060708090a0b0c0d0e0f&#039;
    option r1kh        &#039;C0:4A:00:AB:FA:EC,C0:4A:00:AB:FA:EC,010102030405060708090a0b0c0d0e0f&#039;
    option pmk_r1_push      &#039;1&#039;</code></pre></div><div class="codebox"><pre><code>    # 802.11r Fast Roaming
    option ieee80211r    &#039;1&#039;
    option nasid        &#039;C04A00ABE70E&#039;
    option r1_key_holder    &#039;C04A00ABE70E&#039;
    option mobility_domain    &#039;EEEE&#039;
    option r0kh        &#039;04:A1:51:B2:40:B1,04A151B240B1,000102030405060708090a0b0c0d0e0f&#039;
    option r0kh        &#039;C0:4A:00:AB:FA:EC,C04A00ABFAEC,0f0e0d0c0b0a09080706050403020102&#039;
    option r1kh        &#039;04:A1:51:B2:40:B1,04:A1:51:B2:40:B1,0f0e0d0c0b0a09080706050403020100&#039;
    option r1kh        &#039;C0:4A:00:AB:FA:EC,C0:4A:00:AB:FA:EC,020102030405060708090a0b0c0d0e0f&#039;
    option pmk_r1_push    &#039;1&#039;</code></pre></div><div class="codebox"><pre><code>    # 802.11r Fast Roaming
    option ieee80211r    &#039;1&#039;
    option nasid        &#039;C04A00ABFAEC&#039;
    option r1_key_holder    &#039;C04A00ABFAEC&#039;
    option mobility_domain    &#039;EEEE&#039;
    option r0kh        &#039;04:A1:51:B2:40:B1,04A151B240B1,010102030405060708090a0b0c0d0e0f&#039;
    option r0kh        &#039;C0:4A:00:AB:E7:0E,C04A00ABE70E,020102030405060708090a0b0c0d0e0f&#039;
    option r1kh        &#039;04:A1:51:B2:40:B1,04:A1:51:B2:40:B1,0f0e0d0c0b0a09080706050403020101&#039;
    option r1kh        &#039;C0:4A:00:AB:E7:0E,C0:4A:00:AB:E7:0E,0f0e0d0c0b0a09080706050403020102&#039;
    option pmk_r1_push    &#039;1&#039;</code></pre></div><p>My understanding is that source AP r0kh and target AP r1kh should be paired.</p>											<p class="post-edited">(Last edited by <strong>J1mbo</strong> on 13 Dec 2015, 11:02)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p304071">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">J1mbo</div>
					<div class="post-datetime">
						18 Dec 2015, 00:22					</div>
				</div>
				<div class="post-content content">
					<p>In short: I don&#039;t think 802.11r works currently.</p><p>After trying numerous options the 802.11i and 802.11r ethertypes 0x88C7 and 0x890D are conspicuous by their absence on the LAN (the networks are reporting over-the-DS method).</p><p>Tested on 15.05 with iPad Air as the 802.11r capable client. It doesn&#039;t roam at all with &#039;r enabled.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p304182">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Fox1</div>
					<div class="post-datetime">
						19 Dec 2015, 00:29					</div>
				</div>
				<div class="post-content content">
					<p>In /var/run/hostapd-phy0.conf is </p><p> nas_identifier=C04A00ABFAEC<br /> mobility_domain=EEEE<br /> r0_key_lifetime=10000<br /> r1_key_holder=C04A00ABFAEC<br /> reassociation_deadline=1000<br /> pmk_r1_push=1<br /> r0kh=C0:4A:00:AB:E7:0E C04A00ABE70E 020102030405060708090a0b0c0d0e0f<br /> r1kh=C0:4A:00:AB:E7:0E C0:4A:00:AB:E7:0E 0f0e0d0c0b0a09080706050403020102<br /> wpa_key_mgmt=WPA-EAP FT-EAP<br /> okc=0<br /> disable_pmksa_caching=1</p><p>but only one line with r0kh</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p304188">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">J1mbo</div>
					<div class="post-datetime">
						19 Dec 2015, 01:16					</div>
				</div>
				<div class="post-content content">
					<p>Change those lines to list instead of option.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p304227">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">Fox1</div>
					<div class="post-datetime">
						19 Dec 2015, 15:28					</div>
				</div>
				<div class="post-content content">
					<p>J1mbo: Is it working when you Change Option to list?<br />Can you see any entry in logread related to 802.11r?<br />Witch package is better? wpad or hostapd?<br />Thanks <br />chf1</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p304250">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">J1mbo</div>
					<div class="post-datetime">
						19 Dec 2015, 20:44					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve been using full hostapd but I can&#039;t make it work. Using List for R0KH/R1KH correctly populates /var/run/hostapd.conf however.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>