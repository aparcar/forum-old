<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> qca9531-nand boot</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 29 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p305393">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">353664407</div>
					<div class="post-datetime">
						29 Dec 2015, 14:47					</div>
				</div>
				<div class="post-content content">
					<p>Hi all :<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;I&#039;m trying to add a nand flash to qca9531. And in the uboot I can read and write the nand flash.But when i flash the firmware into the nand flash and reboot.I got a log file like below:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; U-Boot 1.1.4 (Nov 18 2015 - 10:40:10)</p><p>cus531 - Honey Bee 2.0DRAM:&nbsp; <br />sri<br />Honey Bee 2.0<br />ath_ddr_initial_config(195): (16bit) ddr2 init<br />tap = 0x00000003<br />Tap (low, high) = (0x8, 0x23)<br />Tap values = (0x15, 0x15, 0x15, 0x15)<br />128 MB<br />Top of RAM usable for U-Boot at: 88000000<br />Reserving 213k for U-Boot at: 87fc8000<br />Reserving 192k for malloc() at: 87f98000<br />Reserving 44 Bytes for Board Info at: 87f97fd4<br />Reserving 36 Bytes for Global Data at: 87f97fb0<br />Reserving 128k for boot params() at: 87f77fb0<br />Stack Pointer at: 87f77f98<br />Now running in RAM - U-Boot at: 87fc8000<br />Flash Manuf Id 0xef, DeviceId0 0x40, DeviceId1 0x18<br />flash size 0MB, sector count = 8<br />Flash: 512 kB<br />*** Warning *** : PCIe WLAN Module not found !!!<br />In:&nbsp; &nbsp; serial<br />Out:&nbsp; &nbsp;serial<br />Err:&nbsp; &nbsp;serial<br />Net:&nbsp; &nbsp;ath_gmac_enet_initialize...<br />No valid address in Flash. Using fixed address<br />No valid address in Flash. Using fixed address<br />ath_gmac_enet_initialize: reset mask:c02200 <br />Scorpion ----&gt;S27 PHY*<br />S27 reg init<br />: cfg1 0x800c0000 cfg2 0x7114<br />eth0: 00:03:7f:09:0b:ad<br />athrs27_phy_setup ATHR_PHY_CONTROL 4 :1000<br />athrs27_phy_setup ATHR_PHY_SPEC_STAUS 4 :10<br />eth0 up<br />Honey Bee ----&gt;&nbsp; MAC 1 S27 PHY *<br />S27 reg init<br />ATHRS27: resetting s27<br />ATHRS27: s27 reset done<br />: cfg1 0x800c0000 cfg2 0x7214<br />eth1: 00:03:7f:09:0b:ad<br />athrs27_phy_setup ATHR_PHY_CONTROL 0 :1000<br />athrs27_phy_setup ATHR_PHY_SPEC_STAUS 0 :10<br />athrs27_phy_setup ATHR_PHY_CONTROL 1 :1000<br />athrs27_phy_setup ATHR_PHY_SPEC_STAUS 1 :10<br />athrs27_phy_setup ATHR_PHY_CONTROL 2 :1000<br />athrs27_phy_setup ATHR_PHY_SPEC_STAUS 2 :10<br />athrs27_phy_setup ATHR_PHY_CONTROL 3 :1000<br />athrs27_phy_setup ATHR_PHY_SPEC_STAUS 3 :10<br />eth1 up<br />eth0, eth1<br />Qualcomm Atheros SPI NAND Driver, Version 0.1 (c) 2014&nbsp; Qualcomm Atheros Inc.<br />====== NAND Parameters ======<br />sc = 0x87ff67a0 page = 0x800 block = 0x20000Setting 0x181162c0 to 0x4a95a100<br />Hit any key to stop autoboot:&nbsp; 0 <br />## Booting image at 9fe80000 ...<br />&nbsp; &nbsp;Image Name:&nbsp; &nbsp;MIPS OpenWrt Linux-3.3.8<br />&nbsp; &nbsp;Created:&nbsp; &nbsp; &nbsp; 2015-09-18&nbsp; 15:42:56 UTC<br />&nbsp; &nbsp;Image Type:&nbsp; &nbsp;MIPS Linux Multi-File Image (lzma compressed)<br />&nbsp; &nbsp;Data Size:&nbsp; &nbsp; 1084747 Bytes =&nbsp; 1 MB<br />&nbsp; &nbsp;Load Address: 80060000<br />&nbsp; &nbsp;Entry Point:&nbsp; 80060000<br />&nbsp; &nbsp;Contents:<br />&nbsp; &nbsp;Image 0:&nbsp; 1084739 Bytes =&nbsp; 1 MB<br />&nbsp; &nbsp;Verifying Checksum at 0x9fe80040 ...OK<br />&nbsp; &nbsp;Uncompressing Multi-File Image ... OK<br />No initrd<br />## Transferring control to Linux (at address 80060000) ...<br />## Giving linux memsize in bytes, 134217728</p><p>Starting kernel ...</p><p>[&nbsp; &nbsp; 0.000000] Linux version 3.3.8 (iverson@ubuntu) (gcc version 4.6.3 20120201 (prerelease) (Linaro GCC 4.6-2012.02) ) #3 Sat Sep 12 10:53:28 PDT 2015<br />[&nbsp; &nbsp; 0.000000] bootconsole [early0] enabled<br />[&nbsp; &nbsp; 0.000000] CPU revision is: 00019374 (MIPS 24Kc)<br />[&nbsp; &nbsp; 0.000000] SoC: Qualcomm Atheros QCA9531 rev 2<br />[&nbsp; &nbsp; 0.000000] Clocks: CPU:650.000MHz, DDR:597.607MHz, AHB:216.666MHz, Ref:25.000MHz<br />[&nbsp; &nbsp; 0.000000] Determined physical RAM map:<br />[&nbsp; &nbsp; 0.000000]&nbsp; memory: 08000000 @ 00000000 (usable)<br />[&nbsp; &nbsp; 0.000000] Initrd not found or empty - disabling initrd<br />[&nbsp; &nbsp; 0.000000] Zone PFN ranges:<br />[&nbsp; &nbsp; 0.000000]&nbsp; &nbsp;Normal&nbsp; &nbsp;0x00000000 -&gt; 0x00008000<br />[&nbsp; &nbsp; 0.000000] Movable zone start PFN for each node<br />[&nbsp; &nbsp; 0.000000] Early memory PFN ranges<br />[&nbsp; &nbsp; 0.000000]&nbsp; &nbsp; &nbsp;0: 0x00000000 -&gt; 0x00008000<br />[&nbsp; &nbsp; 0.000000] Built 1 zonelists in Zone order, mobility grouping on.&nbsp; Total pages: 32512<br />[&nbsp; &nbsp; 0.000000] Kernel command line:&nbsp; board=AP147 console=ttyS0,115200 mtdparts=spi0.0:256k(u-boot)ro,64k(u-boot-env)ro,14528k(rootfs),1472k(kernel),64k(art),16000k@0x50000(firmware) rootfstype=squashfs,jffs2 noinitrd<br />[&nbsp; &nbsp; 0.000000] PID hash table entries: 512 (order: -1, 2048 bytes)<br />[&nbsp; &nbsp; 0.000000] Dentry cache hash table entries: 16384 (order: 4, 65536 bytes)<br />[&nbsp; &nbsp; 0.000000] Inode-cache hash table entries: 8192 (order: 3, 32768 bytes)<br />[&nbsp; &nbsp; 0.000000] Primary instruction cache 64kB, VIPT, 4-way, linesize 32 bytes.<br />[&nbsp; &nbsp; 0.000000] Primary data cache 32kB, 4-way, VIPT, cache aliases, linesize 32 bytes<br />[&nbsp; &nbsp; 0.000000] Writing ErrCtl register=00000000<br />[&nbsp; &nbsp; 0.000000] Readback ErrCtl register=00000000<br />[&nbsp; &nbsp; 0.000000] Memory: 126192k/131072k available (2277k kernel code, 4880k reserved, 617k data, 220k init, 0k highmem)<br />[&nbsp; &nbsp; 0.000000] SLUB: Genslabs=9, HWalign=32, Order=0-3, MinObjects=0, CPUs=1, Nodes=1<br />[&nbsp; &nbsp; 0.000000] NR_IRQS:83<br />[&nbsp; &nbsp; 0.000000] Calibrating delay loop... 432.53 BogoMIPS (lpj=2162688)<br />[&nbsp; &nbsp; 0.060000] pid_max: default: 32768 minimum: 301<br />[&nbsp; &nbsp; 0.060000] Mount-cache hash table entries: 512<br />[&nbsp; &nbsp; 0.070000] Performance counters: mips/24K PMU enabled, 2 32-bit counters available to each CPU, irq 13<br />[&nbsp; &nbsp; 0.080000] Initialized recycle list for cpu 0.<br />[&nbsp; &nbsp; 0.080000] NET: Registered protocol family 16<br />[&nbsp; &nbsp; 0.090000] gpiochip_add: registered GPIOs 0 to 17 on device: ath79<br />[&nbsp; &nbsp; 0.090000] MIPS: machine is Qualcomm Atheros AP147 reference board<br />[&nbsp; &nbsp; 0.100000] ar724x-pci ar724x-pci.0: PCIe link is down<br />[&nbsp; &nbsp; 0.100000] registering PCI controller with io_map_base unset<br />[&nbsp; &nbsp; 0.110000] ar71xx: invalid MDIO id 1<br />[&nbsp; &nbsp; 0.520000] bio: create slab &lt;bio-0&gt; at 0<br />[&nbsp; &nbsp; 0.520000] PCI host bridge to bus 0000:00<br />[&nbsp; &nbsp; 0.530000] pci_bus 0000:00: root bus resource [mem 0x10000000-0x11ffffff]<br />[&nbsp; &nbsp; 0.530000] pci_bus 0000:00: root bus resource [io&nbsp; 0x0000]<br />[&nbsp; &nbsp; 0.540000] Switching to clocksource MIPS<br />[&nbsp; &nbsp; 0.540000] NET: Registered protocol family 2<br />[&nbsp; &nbsp; 0.550000] IP route cache hash table entries: 1024 (order: 0, 4096 bytes)<br />[&nbsp; &nbsp; 0.550000] TCP established hash table entries: 4096 (order: 3, 32768 bytes)<br />[&nbsp; &nbsp; 0.560000] TCP bind hash table entries: 4096 (order: 2, 16384 bytes)<br />[&nbsp; &nbsp; 0.560000] TCP: Hash tables configured (established 4096 bind 4096)<br />[&nbsp; &nbsp; 0.570000] TCP reno registered<br />[&nbsp; &nbsp; 0.570000] UDP hash table entries: 256 (order: 0, 4096 bytes)<br />[&nbsp; &nbsp; 0.580000] UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)<br />[&nbsp; &nbsp; 0.580000] NET: Registered protocol family 1<br />[&nbsp; &nbsp; 0.600000] squashfs: version 4.0 (2009/01/31) Phillip Lougher<br />[&nbsp; &nbsp; 0.610000] JFFS2 version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006 Red Hat, Inc.<br />[&nbsp; &nbsp; 0.620000] msgmni has been set to 246<br />[&nbsp; &nbsp; 0.620000] io scheduler noop registered<br />[&nbsp; &nbsp; 0.620000] io scheduler deadline registered (default)<br />[&nbsp; &nbsp; 0.630000] Serial: 8250/16550 driver, 1 ports, IRQ sharing disabled<br />[&nbsp; &nbsp; 0.660000] serial8250.0: ttyS0 at MMIO 0x18020000 (irq = 11) is a 16550A<br />[&nbsp; &nbsp; 0.660000] console [ttyS0] enabled, bootconsole disabled<br />[&nbsp; &nbsp; 0.660000] console [ttyS0] enabled, bootconsole disabled<br />[&nbsp; &nbsp; 0.680000] m25p80 spi0.0: unrecognized JEDEC id c80008<br />[&nbsp; &nbsp; 0.700000] ag71xx_mdio: probed<br />[&nbsp; &nbsp; 0.840000] ag71xx_mdio: probed<br />[&nbsp; &nbsp; 0.840000] eth0: Atheros AG71xx at 0xb9000000, irq 4<br />[&nbsp; &nbsp; 1.400000] ag71xx ag71xx.0: eth0: connected to PHY at ag71xx-mdio.1:04 [uid=004dd042, driver=Generic PHY]<br />[&nbsp; &nbsp; 1.410000] eth1: Atheros AG71xx at 0xba000000, irq 5<br />[&nbsp; &nbsp; 1.970000] eth1: Found an AR934X built-in switch<br />[&nbsp; &nbsp; 3.000000] TCP cubic registered<br />[&nbsp; &nbsp; 3.000000] NET: Registered protocol family 17<br />[&nbsp; &nbsp; 3.010000] 8021q: 802.1Q VLAN Support v1.8<br />[&nbsp; &nbsp; 3.010000] ### of_selftest(): No testcase data in device tree; not running tests<br />[&nbsp; &nbsp; 3.020000] VFS: Cannot open root device &quot;(null)&quot; or unknown-block(0,0)<br />[&nbsp; &nbsp; 3.030000] Please append a correct &quot;root=&quot; boot option; here are the available partitions:<br />[&nbsp; &nbsp; 3.030000] Kernel panic - not syncing: VFS: Unable to mount root fs on unknown-block(0,0)</p><br /><br /><br /><br /><p>and i wonder if something wrong with the uboot.&quot;Kernel command line:&nbsp; board=AP147 console=ttyS0,115200 mtdparts=spi0.0:256k(u-boot)ro,64k(u-boot-env)ro,14528k(rootfs),1472k(kernel),64k(art),16000k@0x50000(firmware) rootfstype=squashfs,jffs2 noinitrd&quot;&nbsp; The &quot;mtdparts&quot;didn&#039;t read the nand flash.</p><br /><p>Does anybody can help??</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p305397">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">pepe2k</div>
					<div class="post-datetime">
						29 Dec 2015, 15:56					</div>
				</div>
				<div class="post-content content">
					<p>You are missing SPI NAND driver in kernel.<br />Edit: &quot;m25p80 spi0.0: unrecognized JEDEC id c80008&quot;, your chips is working, but is not supported by m25p80 driver - it&#039;s for SPI NOR chip type.</p>											<p class="post-edited">(Last edited by <strong>pepe2k</strong> on 29 Dec 2015, 16:16)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p350760">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">ronaldoafonso</div>
					<div class="post-datetime">
						31 Jan 2017, 21:59					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>&nbsp; I&#039;m trying to run OpenWrt on the RouterBoard mAP 2nd (<a href="https://routerboard.com/RBmAP2nD">https://routerboard.com/RBmAP2nD</a>) and as its main page says it has a QCA9531 CPU.</p><p>&nbsp; Were your able to run OpenWrt on your board?</p><p>&nbsp; Can you please point me how I can compile OpenWrt in order to include support for the QCA9531 CPU?</p><p>&nbsp; Thanks in advance ...</p><p>[]s<br />Ronaldo</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>