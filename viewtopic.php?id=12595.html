<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Flashing my F*n - fis/fi memory addresses don&#039;t match the Wiki!?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 2 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p55955">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">splame</div>
					<div class="post-datetime">
						19 Sep 2007, 01:31					</div>
				</div>
				<div class="post-content content">
					<p>Hi all,</p><p>Hopefully this is a simple problem with a simple answer that will avoid me turning my new toy into a paperweight.</p><p>I&#039;ve patched the router with out.hex and can reboot and telnet in as often as I like. I&#039;m a bit weary of the fi and fis commands as they look like they&#039;ll blow away the Redboot access - is this correct or am I reasonably safe?</p><p>I&#039;m up to the part of the <a href="http://wiki.openwrt.org/OpenWrtDocs/Hardware/Fon/Fonera#head-fc94b8d0cef76dcfcd035ce20c35ba4e1de20794">flashing guide</a> that reads like so:</p><div class="codebox"><pre><code>RedBoot&gt; lo -r -b %{FREEMEMLO} openwrt-atheros-2.6-vmlinux.lzma
Using default protocol (TFTP)
Raw file loaded 0x80041000-0x800f0fff, assumed entry at 0x80041000</code></pre></div><p>Except mine reads:</p><div class="codebox"><pre><code>RedBoot&gt; lo -r -b %{FREEMEMLO} openwrt-atheros-2.6-vmlinux.lzma
Using default protocol (TFTP)
Raw file loaded 0x80040800-0x801007ff, assumed entry at 0x80040800</code></pre></div><p>Am I right in thinking that I need to replace the references to 0x80041000 in the next line with the location of where the file is loaded on my router, 0x80040800 ? From what I can see the -e and -r setting for fi are telling it where in ram to read the data from - I am quite possibly wrong though?</p><p>Thanks in advance! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p55985">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">sid77</div>
					<div class="post-datetime">
						19 Sep 2007, 13:47					</div>
				</div>
				<div class="post-content content">
					<p>I spent two nights on irc talking with forum2006_ and I finally managed to flash openwrt kamikaze 7.07 on LaFonera, take a look at my tutorial: <a href="http://sid77.livejournal.com/2007/09/12/">http://sid77.livejournal.com/2007/09/12/</a></p><p>wiki page needs an absolute cleanup, unfortunately I haven&#039;t much free time now (I haven&#039;t STILL configured openwrt, but I can telnet into it, so I can assure you it&#039;s working ;-) )</p><p>ciao</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p55987">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">splame</div>
					<div class="post-datetime">
						19 Sep 2007, 14:29					</div>
				</div>
				<div class="post-content content">
					<p>Ah - the write up on your page makes sense to me!</p><p>Thanks for writing it all down and sharing <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p55991">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">glp</div>
					<div class="post-datetime">
						19 Sep 2007, 14:48					</div>
				</div>
				<div class="post-content content">
					<p>You could also take a look at this:</p><p><a href="http://wiki.x-wrt.org/index.php/Kamikaze_Installation">http://wiki.x-wrt.org/index.php/Kamikaze_Installation</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p55994">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">sid77</div>
					<div class="post-datetime">
						19 Sep 2007, 16:04					</div>
				</div>
				<div class="post-content content">
					<p>x-wrt wiki page describe the very same instructions reported on openwrt wiki and those will NOT work if you&#039;re trying to flash a previously dd-wrt flashed LaFonera (see my blog post).<br />I think it&#039;s because dd-wrt instructs you to create a nvram block in RedBoot, causing some problems when computing the free space.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p56016">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">splame</div>
					<div class="post-datetime">
						19 Sep 2007, 21:34					</div>
				</div>
				<div class="post-content content">
					<p>That worked a treat - now all I need to do is get eth0 thinking it&#039;s a firewalled WAN port and wifi0 up and running with WPA - yay!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p56028">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">splame</div>
					<div class="post-datetime">
						20 Sep 2007, 01:35					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve got LAN and WIFI up and can SSH into either - which is nice, but I&#039;m struggling with config to match a standard consumer wifi router style widget.</p><p>What I ideally want is as follows:</p><p>Lappy w/ wifi -&gt; f*n*r* wifi (with DCHP) -&gt; WAN (with firewall, still inside the f*n*r* at this stage) &gt; cable modem (with own that passes on dhcp stuff from ISP).</p><p>So from what I can see I need to change the /etc/config/network to be something like:</p><div class="codebox"><pre><code>config interface loopback
        option ifname   lo
        option proto    static
        option ipaddr   127.0.0.1
        option netmask  255.0.0.0

config interface wan
        option ifname   eth0
        option dhcp
        
config interface lan
        option type     bridge
        option proto    static
        option ipaddr   192.168.1.1
        option netmask  255.255.255.0</code></pre></div><p>But I&#039;m really not sure as I can&#039;t find a f*n*r* specific example. :\</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p56049">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">sid77</div>
					<div class="post-datetime">
						20 Sep 2007, 10:00					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve just discovered, thanks to another night in irc and Bartman2007 support, that I haven&#039;t properly setup the jffs2 mtd partition with my instructions.<br />This way, every time LaFonera is rebooted, every modification is lost.<br />Which howto do you follow? mine or x-wrt?<br />If it was mine it would be interesting to discover if you have this issue too, if it was x-wrt one and your openwrt is working propwerly, the &quot;magick&quot; should lay behind the &quot;fis init&quot; command issued before starting creating mtd partitions, as it&#039;s the only command missing from openwrt wiki flashing instructions.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p56051">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">splame</div>
					<div class="post-datetime">
						20 Sep 2007, 10:09					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve just this morning found that my settings aren&#039;t being saved either - which is a bit of a drag - but at least I can reliably screw things up and get it going again. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p56080">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">sid77</div>
					<div class="post-datetime">
						20 Sep 2007, 15:12					</div>
				</div>
				<div class="post-content content">
					<p>ok, at least it&#039;s not an heisenbug ;-)<br />this w-e I&#039;ll be very busy, however I&#039;m going to experiment a bit in the near future. In the meanwhile you could try out x-wrt wiki instructions as I&#039;m more and more confident that official wiki error is just that missing init.<br />(or you could just go with dd-wrt as long as there&#039;s no working flashing method)</p><p>ciao</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p56107">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">splame</div>
					<div class="post-datetime">
						20 Sep 2007, 21:42					</div>
				</div>
				<div class="post-content content">
					<p>The x-wrt flashing method works - and settings are retained. And redboot is still there obediently waiting for 10secs incase there is a telnet connection.</p><p>I still can&#039;t fathom the networking setup. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p56123">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">splame</div>
					<div class="post-datetime">
						21 Sep 2007, 00:38					</div>
				</div>
				<div class="post-content content">
					<p>Okay - so I followed this post - <a href="http://forum.openwrt.org/viewtopic.php?id=11553">http://forum.openwrt.org/viewtopic.php?id=11553</a> - but that bricked the fon, so back to redboot to reflash the rootfs.</p><p>Then I tried <a href="http://forum.openwrt.org/viewtopic.php?id=12352">http://forum.openwrt.org/viewtopic.php?id=12352</a> - Which did give me a DHCP assigned address on eth0 and I can SSH in - but there is no DHCP server for the wifi connections - and manual connections don&#039;t want to work.</p><p>:\</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p56134">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">sid77</div>
					<div class="post-datetime">
						21 Sep 2007, 10:40					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>splame wrote:</cite><blockquote><p>The x-wrt flashing method works</p></blockquote></div><p>good!</p><div class="quotebox"><cite>splame wrote:</cite><blockquote><p>Okay - so I followed this post - <a href="http://forum.openwrt.org/viewtopic.php?id=11553">http://forum.openwrt.org/viewtopic.php?id=11553</a> - but that bricked the fon, so back to redboot to reflash the rootfs.</p></blockquote></div><p>uhmm they look to me just as generic network configurations, I can hardly trust that the fonera was bricked, maybe it was just on a different network than your own ;-)</p><div class="quotebox"><cite>splame wrote:</cite><blockquote><p>Then I tried <a href="http://forum.openwrt.org/viewtopic.php?id=12352">http://forum.openwrt.org/viewtopic.php?id=12352</a> - Which did give me a DHCP assigned address on eth0 and I can SSH in - but there is no DHCP server for the wifi connections - and manual connections don&#039;t want to work.</p><p>:\</p></blockquote></div><p>I&#039;ll join you in the &quot;configuration quest&quot; from monday ;-)<br />I hope to set up this ap fast and do some wiki cleanup.</p><p>ciao</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p56135">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">splame</div>
					<div class="post-datetime">
						21 Sep 2007, 10:49					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><p>...I can hardly trust that the fonera was bricked, maybe it was just on a different network than your own ;-)</p></blockquote></div><p>I did a pretty extensive IP scan to find it - but yeah bricked in the sense that it&#039;s doing it&#039;s own thing and isn&#039;t letting SSH in, rather than bricked in the sense that I need to go and get a serial cable. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p56136">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">Kevin</div>
					<div class="post-datetime">
						21 Sep 2007, 10:53					</div>
				</div>
				<div class="post-content content">
					<p>some quick comments:<br />the parts that MUST be the same when flashing are the load address/entry point for the kernel (0x80041000, as written) and the name &quot;rootfs&quot; for the root filesystem, which openwrt searches for when mounting root. everything else can be up to you. if people actually read the readboot docs before doing this most of the problems wouldn&#039;t occur.<br />the install guide for openwrt on the wiki is one of the better I have seen, since it calculates the size of the rootfs partition based on the free space after flashing the kernel, instead of using random hardcoded numbers like every other posted guide I have seen. this requires some sanity checks on your part though.&nbsp; if your partition table already has entries in it (you already have rootfs), fis free would obviously not report any free space, or very little. my recommendation is to do fis init before flashing openwrt for the first time, which will also get rid of any stray &quot;nvram&quot; partitions and allow the most efficient usage of space.<br />normal procedure for my devices:<br />load -r -b 0x80041000 openwrt-vmlinuxblah<br />fis create linux<br />load -r -b %{FREEMEMLO} openwrt-rootfsblah<br />fis create [-l 0xLENGTH] rootfs (-l if not overwriting an old partition)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p56142">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">splame</div>
					<div class="post-datetime">
						21 Sep 2007, 13:27					</div>
				</div>
				<div class="post-content content">
					<p>Interesting thanks Kevin.</p><p>The Redboot docs are a little intimidating given their size and the amount of useful stuff Redboot can do. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p56589">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">sid77</div>
					<div class="post-datetime">
						27 Sep 2007, 23:25					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m stuck at the same point :-/<br />It would be nice to get some more documentation</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>