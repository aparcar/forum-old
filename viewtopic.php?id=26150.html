<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Disk Cache - RAM not free?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 19 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p115317">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Memphis</div>
					<div class="post-datetime">
						16 Aug 2010, 19:23					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve a strange problem. On my 1043ND with 64MB&nbsp; RAM i&#039;ve the following Ram usage:</p><div class="codebox"><pre><code>Mem: 58184K used, 3488K free, 0K shrd, 292K buff, 34988K cached</code></pre></div><p>As you can see there is 35MB cached - which is theoretically&nbsp; usable by allocations of applications.</p><p>But when I transfer a big file via FTP i get the following errors in log:</p><div class="codebox"><pre><code>Aug 16 18:12:24 Gateway user.err kernel: skbuff alloc of size 3872 failed
Aug 16 18:12:25 Gateway user.warn kernel: __alloc_pages_slowpath: 56 callbacks suppressed
Aug 16 18:12:25 Gateway user.warn kernel: swapper: page allocation failure. order:1, mode:0x4020
Aug 16 18:12:25 Gateway user.warn kernel: Call Trace:[&lt;80068898&gt;] 0x80068898
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;80068898&gt;] 0x80068898
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;800b6054&gt;] 0x800b6054
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;800d2844&gt;] 0x800d2844
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;800d2d18&gt;] 0x800d2d18
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;83b17698&gt;] 0x83b17698
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;8394c038&gt;] 0x8394c038
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;80221b08&gt;] 0x80221b08
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;8394c038&gt;] 0x8394c038
Aug 16 18:12:25 Gateway user.warn kernel: 16384 pages RAM
Aug 16 18:12:25 Gateway user.warn kernel: 966 pages reserved
Aug 16 18:12:25 Gateway user.warn kernel: 1177 pages shared
Aug 16 18:12:25 Gateway user.warn kernel: 14089 pages non-shared
Aug 16 18:12:25 Gateway user.warn kernel: SLUB: Unable to allocate memory on node -1 (gfp=0x20)
Aug 16 18:12:25 Gateway user.warn kernel:   cache: kmalloc-8192, object size: 8192, buffer size: 8192, default order: 3, min order: 1
Aug 16 18:12:25 Gateway user.warn kernel:   node 0: slabs: 0, objs: 0, free: 0
Aug 16 18:12:25 Gateway user.err kernel: skbuff alloc of size 3872 failed
Aug 16 18:12:25 Gateway user.warn kernel: swapper: page allocation failure. order:1, mode:0x4020
Aug 16 18:12:25 Gateway user.warn kernel: Call Trace:[&lt;80068898&gt;] 0x80068898
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;80068898&gt;] 0x80068898
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;800b6054&gt;] 0x800b6054
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;8007cfc8&gt;] 0x8007cfc8
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;800d2844&gt;] 0x800d2844
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;801b74e4&gt;] 0x801b74e4
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;800d2d18&gt;] 0x800d2d18
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;83b17698&gt;] 0x83b17698
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;8394c038&gt;] 0x8394c038
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;80221b08&gt;] 0x80221b08
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;8394c038&gt;] 0x8394c038
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;83b4647c&gt;] 0x83b4647c
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;83b40588&gt;] 0x83b40588
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;83b446c8&gt;] 0x83b446c8
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;80082104&gt;] 0x80082104
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;800aad98&gt;] 0x800aad98
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;800828d0&gt;] 0x800828d0
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;800829b0&gt;] 0x800829b0
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;8006082c&gt;] 0x8006082c
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;80060a00&gt;] 0x80060a00
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;8017a050&gt;] 0x8017a050
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;8006cad4&gt;] 0x8006cad4
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;80060a20&gt;] 0x80060a20
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;80318a90&gt;] 0x80318a90
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;803183dc&gt;] 0x803183dc
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;80064610&gt;] 0x80064610
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;80071d44&gt;] 0x80071d44
Aug 16 18:12:25 Gateway user.warn kernel: Mem-Info:
Aug 16 18:12:25 Gateway user.warn kernel: Normal per-cpu:
Aug 16 18:12:25 Gateway user.warn kernel: CPU    0: hi:   18, btch:   3 usd:  12
Aug 16 18:12:25 Gateway user.warn kernel: active_anon:1556 inactive_anon:2209 isolated_anon:0
Aug 16 18:12:25 Gateway user.warn kernel:  active_file:299 inactive_file:7728 isolated_file:0
Aug 16 18:12:25 Gateway user.warn kernel:  unevictable:0 dirty:0 writeback:0 unstable:0
Aug 16 18:12:25 Gateway user.warn kernel:  free:841 slab_reclaimable:209 slab_unreclaimable:1705
Aug 16 18:12:25 Gateway user.warn kernel:  mapped:235 shmem:724 pagetables:115 bounce:0
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;800d2844&gt;] 0x800d2844
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;801b74e4&gt;] 0x801b74e4
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;800d2d18&gt;] 0x800d2d18
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;83b17698&gt;] 0x83b17698
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;8394c038&gt;] 0x8394c038
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;80221b08&gt;] 0x80221b08
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;8394c038&gt;] 0x8394c038
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;83b4647c&gt;] 0x83b4647c
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;83b40588&gt;] 0x83b40588
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;83b446c8&gt;] 0x83b446c8
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;80082104&gt;] 0x80082104
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;800aad98&gt;] 0x800aad98
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;800828d0&gt;] 0x800828d0
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;800829b0&gt;] 0x800829b0
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;8006082c&gt;] 0x8006082c
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;80060a00&gt;] 0x80060a00
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;8017a050&gt;] 0x8017a050
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;8006cad4&gt;] 0x8006cad4
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;80060a20&gt;] 0x80060a20
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;80318a90&gt;] 0x80318a90
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;803183dc&gt;] 0x803183dc
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;80064610&gt;] 0x80064610
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;80071d44&gt;] 0x80071d44
Aug 16 18:12:25 Gateway user.warn kernel: Mem-Info:
Aug 16 18:12:25 Gateway user.warn kernel: Normal per-cpu:
Aug 16 18:12:25 Gateway user.warn kernel: CPU    0: hi:   18, btch:   3 usd:  12
Aug 16 18:12:25 Gateway user.warn kernel: active_anon:1556 inactive_anon:2209 isolated_anon:0
Aug 16 18:12:25 Gateway user.warn kernel:  active_file:299 inactive_file:7728 isolated_file:0
Aug 16 18:12:25 Gateway user.warn kernel:  unevictable:0 dirty:0 writeback:0 unstable:0
Aug 16 18:12:25 Gateway user.warn kernel:  free:841 slab_reclaimable:209 slab_unreclaimable:1705
Aug 16 18:12:25 Gateway user.warn kernel:  mapped:235 shmem:724 pagetables:115 bounce:0
Aug 16 18:12:25 Gateway user.warn kernel: Normal free:3364kB min:1016kB low:1268kB high:1524kB active_anon:6224kB inactive_anon:8836kB active_file:1196kB inactive_file:30912kB unevictable:0kB isolated(anon):0kB isolated(file):0kB present:65024kB mlocked:0kB dirty:0kB w
Aug 16 18:12:25 Gateway user.warn kernel: lowmem_reserve[]: 0 0
Aug 16 18:12:25 Gateway user.warn kernel: Normal: 793*4kB 12*8kB 0*16kB 3*32kB 0*64kB 0*128kB 0*256kB 0*512kB 0*1024kB 0*2048kB 0*4096kB = 3364kB
Aug 16 18:12:25 Gateway user.warn kernel: 8752 total pagecache pages
Aug 16 18:12:25 Gateway user.warn kernel: 16384 pages RAM
Aug 16 18:12:25 Gateway user.warn kernel: 966 pages reserved
Aug 16 18:12:25 Gateway user.warn kernel: 1177 pages shared
Aug 16 18:12:25 Gateway user.warn kernel: 14089 pages non-shared
Aug 16 18:12:25 Gateway user.warn kernel: SLUB: Unable to allocate memory on node -1 (gfp=0x20)
Aug 16 18:12:25 Gateway user.warn kernel:   cache: kmalloc-8192, object size: 8192, buffer size: 8192, default order: 3, min order: 1
Aug 16 18:12:25 Gateway user.warn kernel:   node 0: slabs: 0, objs: 0, free: 0
Aug 16 18:12:25 Gateway user.err kernel: skbuff alloc of size 3872 failed
Aug 16 18:12:25 Gateway user.warn kernel: swapper: page allocation failure. order:1, mode:0x4020
Aug 16 18:12:25 Gateway user.warn kernel: Call Trace:[&lt;80068898&gt;] 0x80068898
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;80068898&gt;] 0x80068898
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;800b6054&gt;] 0x800b6054
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;8007cfc8&gt;] 0x8007cfc8
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;800d2844&gt;] 0x800d2844
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;801b74e4&gt;] 0x801b74e4
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;800d2d18&gt;] 0x800d2d18
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;83b17698&gt;] 0x83b17698
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;8394c038&gt;] 0x8394c038
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;80221b08&gt;] 0x80221b08
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;8394c038&gt;] 0x8394c038
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;83b4647c&gt;] 0x83b4647c
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;83b40588&gt;] 0x83b40588
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;83b446c8&gt;] 0x83b446c8
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;80082104&gt;] 0x80082104
Aug 16 18:12:25 Gateway user.warn kernel: [&lt;800aad98&gt;] 0x800aad98</code></pre></div><p>Seems odd doesnt it? I would expect that the memory cache gets reduced when an application needs more RAM.</p><p>ciao</p><p>Memphis</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p115327">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">dirtyfreebooter</div>
					<div class="post-datetime">
						16 Aug 2010, 20:15					</div>
				</div>
				<div class="post-content content">
					<p>I also have 64MB and run transmission and see the exact same warning messages.</p><div class="codebox"><pre><code># free
             total       used       free     shared    buffers     cached
Mem:         62116      60520       1596          0       4452      24380
-/+ buffers/cache:      31688      30428
Swap:       128512       4060     124452</code></pre></div><p>skbuff are kernel socket buffers, and this happens to me almost always during a large wireless transfer. They are warnings, not errors, and though the wireless transfers hiccup while trying to allocate the memory, they do eventually complete.</p><p>I&#039;m not sure if this is a problem or just verbose logging, but in either case it seems to take quite some time for the kernel to evict some of those cached pages and/or find some pages for skbuff.</p><p>The thing that bothers me the most, I never seem to go over 4MB swap of usage. If allocations are failing, why isn&#039;t more swap being used? skbuff are kernel buffers, so they themselves cannot be swapped (as kernel allocations do not use virtual memory), but it seems like there is plenty of userspace applications to be swapped.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p115380">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Memphis</div>
					<div class="post-datetime">
						17 Aug 2010, 09:43					</div>
				</div>
				<div class="post-content content">
					<p>Just wanted to add that the transfers (which was also wireless) finished successfull. But maybe there is an issue anyhow...</p><p>And maybe this could be related. I switch off my WLAN over night (via QSS button). And as i issue free at todays morning (wlan still off) i see that the cached size has been reduced to 10mb</p><div class="codebox"><pre><code>Mem: 34520K used, 27152K free, 0K shrd, 1904K buff, 10144K cached</code></pre></div><p>could this be an ATH9k issue which holds much memory pages in cache? But this would be strange because the cache should only be used as disk cache ...</p>											<p class="post-edited">(Last edited by <strong>Memphis</strong> on 17 Aug 2010, 09:54)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p115384">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">dirtyfreebooter</div>
					<div class="post-datetime">
						17 Aug 2010, 11:22					</div>
				</div>
				<div class="post-content content">
					<p>So I&#039;ve been playing around with the VM kernel parameters to here is what I found. I&#039;ve only tested it for less than 6 hours, but I&#039;ve put a huge transmission + wireless transfer load again and again and I haven&#039;t yet seen those warnings.. Here is what I did.</p><p>1) Configured busybox (1.17.1 in trunk r22685) to allocate memory with malloc() instead of on the stack. On the stack is quicker, but is more suited for systems with small memories. 64MB is small, but it is not super small.</p><p>2) Tuned two parameters to the kernel VM using /etc/sysctl.conf</p><div class="codebox"><pre><code>vm.swappiness=100
vm.vfs_cache_pressure=200</code></pre></div><p>vm.swappiness controls how much the kernel favors swap over RAM. A high swappiness value means that the kernel will be more apt to unmap mapped pages, i.e. it won&#039;t be afraid to use swap. values are from 0 to 100, default is 60. I set it to 100 because I don&#039;t care if my ntpclient or uhttpd goes into swap. I just don&#039;t want the new allocations to fail and have to retry until something get evicted, which is what seems to cause the choppy performance under heavy load.</p><p>vm.vfs_cache_pressure controls the tendency of the kernel to reclaim the memory which is used for caching of directory and inode objects (files, which transmission uses lots and lots of files). The default value of vfs_cache_pressure=100 the kernel will attempt to reclaim dentries and inodes at a &quot;fair&quot; rate with respect to pagecache and swapcache reclaim. Decreasing vfs_cache_pressure causes the kernel to prefer to retain dentry and inode caches. Increasing vfs_cache_pressure beyond 100 causes the kernel to prefer to reclaim dentries and inodes. I set it to 200, the max, because I&#039;d rather see the wireless skbuff allocation succeed and let the page cache shrink.</p><p>This seems to sway the kernel into swapping more and shrink the page cache quicker, so other allocations don&#039;t seem to fail. There still could possibly be a memory leak in ATH9K, but I doubt it. I&#039;ve had my router up for 20+ days after seeing those *warning* messages and if it was a leak, eventually the system would come to halt, but it doesn&#039;t. I just think that the kernel was trying to be fair with the memory allocations, which caused the hiccups.</p><p>I dunno for sure though, but I&#039;ll run this setup for as long as it seems to work...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p115385">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">dirtyfreebooter</div>
					<div class="post-datetime">
						17 Aug 2010, 11:25					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Memphis wrote:</cite><blockquote><p>Just wanted to add that the transfers (which was also wireless) finished successfull. But maybe there is an issue anyhow...</p><p>And maybe this could be related. I switch off my WLAN over night (via QSS button). And as i issue free at todays morning (wlan still off) i see that the cached size has been reduced to 10mb</p><div class="codebox"><pre><code>Mem: 34520K used, 27152K free, 0K shrd, 1904K buff, 10144K cached</code></pre></div><p>could this be an ATH9k issue which holds much memory pages in cache? But this would be strange because the cache should only be used as disk cache ...</p></blockquote></div><p>ATH9K doesn&#039;t use its own cache, it uses the SLAB cache, i.e. the global kernel cache where everybody inside the kernel gets their objects from (it gets skbuff objects, socket buffers from the SLAB cache). That way the kernel has global knowledge of memory usage. If every subsystem in the kernel used their own caches, we would be running in memory issues all the time, this is why the global SLAB cache was developed. (first on solaris 5, then linux implemented the same concept in 2.6)</p>											<p class="post-edited">(Last edited by <strong>dirtyfreebooter</strong> on 17 Aug 2010, 11:25)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p115386">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Memphis</div>
					<div class="post-datetime">
						17 Aug 2010, 11:39					</div>
				</div>
				<div class="post-content content">
					<p>Thanks man - i&#039;ll give this a try ...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p115414">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">dirtyfreebooter</div>
					<div class="post-datetime">
						17 Aug 2010, 18:37					</div>
				</div>
				<div class="post-content content">
					<p>unfortunately this wasn&#039;t the holy grail for me...<br /></p><div class="codebox"><pre><code>Aug 17 05:56:16 router user.warn kernel: swapper: page allocation failure. order:1, mode:0x4020
Aug 17 05:56:16 router user.warn kernel: Call Trace:[&lt;800682cc&gt;] 0x800682cc
Aug 17 05:56:16 router user.warn kernel: [&lt;800682cc&gt;] 0x800682cc
Aug 17 05:56:16 router user.warn kernel: [&lt;800b361c&gt;] 0x800b361c
Aug 17 05:56:16 router user.warn kernel: [&lt;800d4688&gt;] 0x800d4688
Aug 17 05:56:16 router user.warn kernel: [&lt;801e4e20&gt;] 0x801e4e20
Aug 17 05:56:16 router user.warn kernel: [&lt;800d4b6c&gt;] 0x800d4b6c
Aug 17 05:56:16 router user.warn kernel: [&lt;83b76038&gt;] 0x83b76038
Aug 17 05:56:16 router user.warn kernel: [&lt;801ceb58&gt;] 0x801ceb58
Aug 17 05:56:16 router user.warn kernel: [&lt;83b76038&gt;] 0x83b76038
Aug 17 05:56:16 router user.warn kernel: [&lt;801fce54&gt;] 0x801fce54
Aug 17 05:56:16 router user.warn kernel: [&lt;8009b6e0&gt;] 0x8009b6e0
Aug 17 05:56:16 router user.warn kernel: [&lt;83045b58&gt;] 0x83045b58
Aug 17 05:56:16 router user.warn kernel: [&lt;80095964&gt;] 0x80095964
Aug 17 05:56:16 router user.warn kernel: [&lt;801f7060&gt;] 0x801f7060
Aug 17 05:56:16 router user.warn kernel: [&lt;830401f8&gt;] 0x830401f8
Aug 17 05:56:16 router user.warn kernel: [&lt;8009b6e0&gt;] 0x8009b6e0
Aug 17 05:56:16 router user.warn kernel: [&lt;801ec81c&gt;] 0x801ec81c
Aug 17 05:56:16 router user.warn kernel: [&lt;83044054&gt;] 0x83044054
Aug 17 05:56:16 router user.warn kernel: [&lt;80081d60&gt;] 0x80081d60
Aug 17 05:56:16 router user.warn kernel: [&lt;800a7d88&gt;] 0x800a7d88
Aug 17 05:56:16 router user.warn kernel: [&lt;80082554&gt;] 0x80082554
Aug 17 05:56:16 router user.warn kernel: [&lt;80082634&gt;] 0x80082634
Aug 17 05:56:16 router user.warn kernel: [&lt;8006082c&gt;] 0x8006082c
Aug 17 05:56:16 router user.warn kernel: [&lt;80060a00&gt;] 0x80060a00
Aug 17 05:56:16 router user.warn kernel: [&lt;8006b24c&gt;] 0x8006b24c
Aug 17 05:56:16 router user.warn kernel: [&lt;8006c72c&gt;] 0x8006c72c
Aug 17 05:56:16 router user.warn kernel: [&lt;80060a20&gt;] 0x80060a20
Aug 17 05:56:16 router user.warn kernel: [&lt;802aca54&gt;] 0x802aca54
Aug 17 05:56:16 router user.warn kernel: [&lt;802ac3a8&gt;] 0x802ac3a8
Aug 17 05:56:16 router user.info kernel: Mem-Info:
Aug 17 05:56:16 router user.warn kernel: Normal per-cpu:
Aug 17 05:56:16 router user.warn kernel: CPU    0: hi:   18, btch:   3 usd:   9
Aug 17 05:56:16 router user.warn kernel: active_anon:892 inactive_anon:901 isolated_anon:0
Aug 17 05:56:16 router user.warn kernel:  active_file:4582 inactive_file:3022 isolated_file:0
Aug 17 05:56:16 router user.warn kernel:  unevictable:0 dirty:750 writeback:0 unstable:0
Aug 17 05:56:16 router user.warn kernel:  free:398 slab_reclaimable:345 slab_unreclaimable:4260
Aug 17 05:56:16 router user.warn kernel:  mapped:407 shmem:6 pagetables:100 bounce:0
Aug 17 05:56:16 router user.warn kernel: Normal free:1592kB min:1016kB low:1268kB high:1524kB active_anon:3568kB inactive_anon:3604kB active_file:18328kB inactive_file:12088kB unevictable:0kB isolated(anon):0kB isolated(file):0kB present:65024kB mlocked:0kB dirty:3000
Aug 17 05:56:16 router user.warn kernel: lowmem_reserve[]: 0 0
Aug 17 05:56:16 router user.warn kernel: Normal: 366*4kB 14*8kB 1*16kB 0*32kB 0*64kB 0*128kB 0*256kB 0*512kB 0*1024kB 0*2048kB 0*4096kB = 1592kB
Aug 17 05:56:16 router user.warn kernel: 7797 total pagecache pages
Aug 17 05:56:16 router user.warn kernel: 187 pages in swap cache
Aug 17 05:56:16 router user.warn kernel: Swap cache stats: add 2490, delete 2303, find 697/848
Aug 17 05:56:16 router user.warn kernel: Free swap  = 123200kB
Aug 17 05:56:16 router user.warn kernel: Total swap = 128512kB
Aug 17 05:56:16 router user.info kernel: 16384 pages RAM
Aug 17 05:56:16 router user.info kernel: 857 pages reserved
Aug 17 05:56:16 router user.info kernel: 8479 pages shared
Aug 17 05:56:16 router user.info kernel: 7449 pages non-shared
Aug 17 05:56:16 router user.warn kernel: SLUB: Unable to allocate memory on node -1 (gfp=0x20)
Aug 17 05:56:16 router user.warn kernel:   cache: kmalloc-8192, object size: 8192, buffer size: 8192, default order: 3, min order: 1
Aug 17 05:56:16 router user.warn kernel:   node 0: slabs: 0, objs: 0, free: 0
Aug 17 05:56:16 router user.err kernel: skbuff alloc of size 3872 failed</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p117766">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">kabal</div>
					<div class="post-datetime">
						24 Sep 2010, 03:46					</div>
				</div>
				<div class="post-content content">
					<p>Hi all.</p><p>I have similar problems with this router (TP-Link WR1043ND 64MB mod). </p><div class="codebox"><pre><code>Sep 22 19:37:52 OpenWrt user.warn kernel: SLUB: Unable to allocate memory on node -1 (gfp=0x20)
Sep 22 19:37:52 OpenWrt user.warn kernel:   cache: kmalloc-8192, object size: 8192, buffer size: 8192, default order: 3, min order: 1
Sep 22 19:37:52 OpenWrt user.warn kernel:   node 0: slabs: 0, objs: 0, free: 0
Sep 22 19:37:52 OpenWrt user.err kernel: skbuff alloc of size 3872 failed
Sep 22 19:37:52 OpenWrt user.warn kernel: transmission-da: page allocation failure. order:1, mode:0x4020
Sep 22 19:37:52 OpenWrt user.warn kernel: Call Trace:[&lt;80068374&gt;] 0x80068374
Sep 22 19:37:52 OpenWrt user.warn kernel: [&lt;80068374&gt;] 0x80068374
Sep 22 19:37:52 OpenWrt user.warn kernel: [&lt;800b4dc8&gt;] 0x800b4dc8
Sep 22 19:37:52 OpenWrt user.warn kernel: [&lt;8007ceac&gt;] 0x8007ceac
Sep 22 19:37:52 OpenWrt user.warn kernel: [&lt;800d5e4c&gt;] 0x800d5e4c
Sep 22 19:37:52 OpenWrt user.warn kernel: [&lt;8019e35c&gt;] 0x8019e35c
Sep 22 19:37:52 OpenWrt user.warn kernel: [&lt;800d6330&gt;] 0x800d6330
Sep 22 19:37:52 OpenWrt user.warn kernel: [&lt;801028f4&gt;] 0x801028f4
Sep 22 19:37:52 OpenWrt user.warn kernel: [&lt;80160b78&gt;] 0x80160b78
Sep 22 19:37:52 OpenWrt user.warn kernel: [&lt;83022038&gt;] 0x83022038
Sep 22 19:37:52 OpenWrt user.warn kernel: [&lt;801e03a0&gt;] 0x801e03a0
Sep 22 19:37:52 OpenWrt user.warn kernel: [&lt;83022038&gt;] 0x83022038
Sep 22 19:37:52 OpenWrt user.warn kernel: [&lt;830a652c&gt;] 0x830a652c
Sep 22 19:37:52 OpenWrt user.warn kernel: [&lt;80103434&gt;] 0x80103434
Sep 22 19:37:52 OpenWrt user.warn kernel: [&lt;80107adc&gt;] 0x80107adc
Sep 22 19:37:52 OpenWrt user.warn kernel: [&lt;830a4624&gt;] 0x830a4624
Sep 22 19:37:52 OpenWrt user.warn kernel: [&lt;80081f38&gt;] 0x80081f38
Sep 22 19:37:52 OpenWrt user.warn kernel: [&lt;800a7f60&gt;] 0x800a7f60
Sep 22 19:37:52 OpenWrt user.warn kernel: [&lt;8008272c&gt;] 0x8008272c
Sep 22 19:37:52 OpenWrt user.warn kernel: [&lt;8008280c&gt;] 0x8008280c
Sep 22 19:37:52 OpenWrt user.warn kernel: [&lt;8006082c&gt;] 0x8006082c
Sep 22 19:37:52 OpenWrt user.warn kernel: [&lt;800ad66c&gt;] 0x800ad66c
Sep 22 19:37:52 OpenWrt user.warn kernel: [&lt;80064128&gt;] 0x80064128
Sep 22 19:37:52 OpenWrt user.warn kernel: [&lt;800b0804&gt;] 0x800b0804
Sep 22 19:37:52 OpenWrt user.warn kernel: [&lt;800d8ea0&gt;] 0x800d8ea0
Sep 22 19:37:52 OpenWrt user.warn kernel: [&lt;830a3bb4&gt;] 0x830a3bb4
Sep 22 19:37:52 OpenWrt user.warn kernel: [&lt;830a4a90&gt;] 0x830a4a90
Sep 22 19:37:52 OpenWrt user.warn kernel: [&lt;8009236c&gt;] 0x8009236c
Sep 22 19:37:52 OpenWrt user.warn kernel: [&lt;80078870&gt;] 0x80078870
Sep 22 19:37:52 OpenWrt user.warn kernel: [&lt;800ab8fc&gt;] 0x800ab8fc
Sep 22 19:37:52 OpenWrt user.warn kernel: [&lt;800d9b0c&gt;] 0x800d9b0c
Sep 22 19:37:52 OpenWrt user.warn kernel: [&lt;8009b760&gt;] 0x8009b760
Sep 22 19:37:52 OpenWrt user.warn kernel: [&lt;800d9be8&gt;] 0x800d9be8
Sep 22 19:37:52 OpenWrt user.warn kernel: [&lt;80081dc0&gt;] 0x80081dc0
Sep 22 19:37:52 OpenWrt user.warn kernel: [&lt;80062544&gt;] 0x80062544
Sep 22 19:37:52 OpenWrt user.info kernel: Mem-Info:
Sep 22 19:37:52 OpenWrt user.warn kernel: Normal per-cpu:
Sep 22 19:37:52 OpenWrt user.warn kernel: CPU    0: hi:   18, btch:   3 usd:   4
Sep 22 19:37:52 OpenWrt user.warn kernel: active_anon:1180 inactive_anon:1353 isolated_anon:0
Sep 22 19:37:52 OpenWrt user.warn kernel:  active_file:3855 inactive_file:4935 isolated_file:0
Sep 22 19:37:52 OpenWrt user.warn kernel:  unevictable:0 dirty:257 writeback:0 unstable:0
Sep 22 19:37:52 OpenWrt user.warn kernel: active_anon:1180 inactive_anon:1353 isolated_anon:0
Sep 22 19:37:52 OpenWrt user.warn kernel:  active_file:3855 inactive_file:4935 isolated_file:0
Sep 22 19:37:52 OpenWrt user.warn kernel:  unevictable:0 dirty:257 writeback:0 unstable:0
Sep 22 19:37:52 OpenWrt user.warn kernel:  free:303 slab_reclaimable:388 slab_unreclaimable:2549
Sep 22 19:37:52 OpenWrt user.warn kernel:  mapped:361 shmem:6 pagetables:47 bounce:0
Sep 22 19:37:52 OpenWrt user.warn kernel: Normal free:1212kB min:1016kB low:1268kB high:1524kB active_anon:4720kB inactive_anon:5412kB active_file:15420kB inactive_file:19740kB unevictable:0kB isolated(anon):0kB isolated(file):0kB present:65024kB mlocked:0kB dirty:1028
Sep 22 19:37:52 OpenWrt user.warn kernel: lowmem_reserve[]: 0 0
Sep 22 19:37:52 OpenWrt user.warn kernel: Normal: 255*4kB 0*8kB 8*16kB 0*32kB 1*64kB 0*128kB 0*256kB 0*512kB 0*1024kB 0*2048kB 0*4096kB = 1212kB
Sep 22 19:37:52 OpenWrt user.warn kernel: 8985 total pagecache pages
Sep 22 19:37:52 OpenWrt user.warn kernel: 181 pages in swap cache
Sep 22 19:37:52 OpenWrt user.warn kernel: Swap cache stats: add 1966, delete 1785, find 700/968
Sep 22 19:37:52 OpenWrt user.warn kernel: Free swap  = 248316kB
Sep 22 19:37:52 OpenWrt user.warn kernel: Total swap = 249976kB
Sep 22 19:37:52 OpenWrt user.info kernel: 16384 pages RAM
Sep 22 19:37:52 OpenWrt user.info kernel: 881 pages reserved
Sep 22 19:37:52 OpenWrt user.info kernel: 7307 pages shared
Sep 22 19:37:52 OpenWrt user.info kernel: 8140 pages non-shared
Sep 22 19:37:52 OpenWrt user.warn kernel: SLUB: Unable to allocate memory on node -1 (gfp=0x20)
Sep 22 19:37:52 OpenWrt user.warn kernel:   cache: kmalloc-8192, object size: 8192, buffer size: 8192, default order: 3, min order: 1
Sep 22 19:37:52 OpenWrt user.warn kernel:   node 0: slabs: 0, objs: 0, free: 0
Sep 22 19:37:52 OpenWrt user.err kernel: skbuff alloc of size 3872 failed</code></pre></div><p>If You manage to somehow&nbsp; solve this problem?</p>											<p class="post-edited">(Last edited by <strong>kabal</strong> on 24 Sep 2010, 03:48)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p117769">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">dirtyfreebooter</div>
					<div class="post-datetime">
						24 Sep 2010, 05:18					</div>
				</div>
				<div class="post-content content">
					<p>Its not really a no problem. They warnings, I never once had them panic the system. Transmission is a giant memory hog. The only real thing you can do is really limit your transmission settings, but I find it not worth it.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p117819">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">kabal</div>
					<div class="post-datetime">
						25 Sep 2010, 03:24					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dirtyfreebooter wrote:</cite><blockquote><p>Its not really a no problem. They warnings, I never once had them panic the system. Transmission is a giant memory hog. The only real thing you can do is really limit your transmission settings, but I find it not worth it.</p></blockquote></div><p>Thanks for answer.<br />In my case, these entries occurred only when my wireless card (radio) was set in &quot;sta&quot; (wisp) mode. When wireless card is set to AP this warnings non exists.. so I think that this is a bug of wi-fi ATH9k drivers in &quot;sta&quot; (wisp) mode. </p><p>What&#039;s more..I cant set router in &quot;AP+sta&quot; mode.. radio works in AP but cant connect to another wirelees network (sta mode). Dmesg says:<br /></p><div class="codebox"><pre><code>Adding 249604k swap on /dev/sda2.  Priority:-1 extents:1 across:249604k
device wlan0 entered promiscuous mode
br-lan: port 2(wlan0) entering forwarding state
device wlan0 left promiscuous mode
br-lan: port 2(wlan0) entering disabled state
device wlan0 entered promiscuous mode
br-lan: port 2(wlan0) entering forwarding state
wlan1: direct probe to 00:24:b2:c0:27:bc (try 1)
wlan1: direct probe responded
wlan1: authenticate with 00:24:b2:c0:27:bc (try 1)
wlan1: authenticated
wlan1: deauthenticating from 00:24:b2:c0:27:bc by local choice (reason=3)
wlan1: authenticate with 00:24:b2:c0:27:bc (try 1)
wlan1: authenticated
wlan1: deauthenticating from 00:24:b2:c0:27:bc by local choice (reason=3)
ar71xx-wdt: enabling watchdog timer
wlan1: authenticate with 00:24:b2:c0:27:bc (try 1)
wlan1: authenticated
wlan1: deauthenticating from 00:24:b2:c0:27:bc by local choice (reason=3)
wlan1: authenticate with 00:24:b2:c0:27:bc (try 1)
wlan1: authenticated
wlan1: deauthenticating from 00:24:b2:c0:27:bc by local choice (reason=3)
etc.</code></pre></div><p>Now router radio still works as WISP.. I do not pay attention to kernel warnings..<br />Thanks again&nbsp; <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>Regards</p>											<p class="post-edited">(Last edited by <strong>kabal</strong> on 25 Sep 2010, 03:30)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p122986">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						10 Dec 2010, 14:35					</div>
				</div>
				<div class="post-content content">
					<p>I had this problem when running NZBget on WNDR3700 both in trunk and backfire. After a lot of testing I found the configuration trunk+uClibc 0.9.30.1+SLOB memory allocator+100 swappiness to remedy this.</p><p>EDIT: No it didn&#039;t... Tried 2.6.37-rc5 as well with SLAB/SLOB and different swappiness/cache pressure but no luck... Why can&#039;t it allocate memory when there&#039;s plenty free swap? I don&#039;t get it.</p>											<p class="post-edited">(Last edited by <strong>arokh</strong> on 13 Dec 2010, 00:46)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p123450">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">Igor</div>
					<div class="post-datetime">
						18 Dec 2010, 14:55					</div>
				</div>
				<div class="post-content content">
					<p><a href="https://dev.openwrt.org/ticket/6728">https://dev.openwrt.org/ticket/6728</a></p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>