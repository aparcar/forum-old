<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Problem &quot;upgrading&quot; TP-LINK MR-3220 to OpenWRT using www</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 16 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p176333">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">laurentp</div>
					<div class="post-datetime">
						30 Aug 2012, 00:55					</div>
				</div>
				<div class="post-content content">
					<p>Hi, <br />I just got an MR3220, (it is not paid yet, so I can&#039;t disassemble it to solder serial...), <br />I want to flash OpenWRT to it. <br />I have read that I have to use trunk, so downloaded an image (bin).<br />Now if I want to flash it from TP-LINK www, IF filename is openwrt*, www refuses to start upgrade.<br />IF I change NAME to some existing TP-LINK image, I can &quot;start&quot; upgrade (&quot;Do you really...?&quot;), but then I get:<br />&quot;Error code: 18005<br />Upgrade unsuccessfully because the version of the upgraded file was incorrect. Please check the file name.&quot;</p><p>[I have even downgraded firmware to version from TP-LINK site dated 2011, but this does not help]</p><p>Sticker on the back says &quot;Ver 1.2&quot;<br />Hardware revision: MR3220 v1</p><p>Anyone help?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176335">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">vido</div>
					<div class="post-datetime">
						30 Aug 2012, 01:31					</div>
				</div>
				<div class="post-content content">
					<p>I have a same router and my flashing was all ok.<br />Ok can u post whole name of binary file that u used ?<br />If u make any changes to router then u need to reset it to factory default settings ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176336">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">laurentp</div>
					<div class="post-datetime">
						30 Aug 2012, 01:56					</div>
				</div>
				<div class="post-content content">
					<p>It&#039;s a bit crazy:<br />now I have firmware (TP-LINK), 3.12.19 (110617), and despite of &quot;factory defaults&quot;<br />router refuses to upgrade to ANY firmware, (including TP-LINK&#039;s), <br />with a &quot;Please choose a file to upgrade&quot; message box.... WTF?</p><p>I have tried to use: <a href="http://downloads.openwrt.org/snapshots/trunk/ar71xx/openwrt-ar71xx-generic-tl-mr3220-v1-squashfs-factory.bin">http://downloads.openwrt.org/snapshots/ â€¦ actory.bin</a><br />this file.</p><p>[edit]<br />The message box is a bug in some JavaScript used, I guess, as it appears EVEN with router powered down...<br />[/edit]</p><p>[edit2 - SOLVED]<br />What worked:<br />copying OpenWRT to /tmp - short path, <br />renaming ot after TP-LINK firmware, with last part (xxxxx) being date of the file (don&#039;t know if it is really needed, but I did this way, and now I have OpenWRT on this device...<br />[/edit2]</p>											<p class="post-edited">(Last edited by <strong>laurentp</strong> on 30 Aug 2012, 02:49)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176339">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">vido</div>
					<div class="post-datetime">
						30 Aug 2012, 02:35					</div>
				</div>
				<div class="post-content content">
					<p>ok very strange, have you tried to reset it with H/W button (reset) button on back and restore to default in web UI ? have you tried it on both ways ?</p><p>My only guess it&#039;s because you&#039;re downgraded firmware, did u tried newer/older TP Link updates then 3.12.19 ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176341">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">laurentp</div>
					<div class="post-datetime">
						30 Aug 2012, 02:50					</div>
				</div>
				<div class="post-content content">
					<p>Look at my edit second [edit], now it works.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176343">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">laurentp</div>
					<div class="post-datetime">
						30 Aug 2012, 02:58					</div>
				</div>
				<div class="post-content content">
					<p>Now time to build my own firmware <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" />....<br />I don&#039;t need *netfilter* stuff, I want LuCI and need to test if anyRemote will fit on this...<br />And my scripts need bash, ~850kB <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>After flashing default firmware (trunk) I have 1200kB free.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176346">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">vido</div>
					<div class="post-datetime">
						30 Aug 2012, 03:48					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>laurentp wrote:</cite><blockquote><p>Now time to build my own firmware <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" />....<br />I don&#039;t need *netfilter* stuff, I want LuCI and need to test if anyRemote will fit on this...<br />And my scripts need bash, ~850kB <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>After flashing default firmware (trunk) I have 1200kB free.</p></blockquote></div><p>This is great news, and I&#039;m also thinking about compressing a open wrt but now I have other problems</p><p>If you come up to maybe 2048kb free it would be nice to post that binary somewhere.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176349">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">laurentp</div>
					<div class="post-datetime">
						30 Aug 2012, 06:18					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>vido wrote:</cite><blockquote><p>This is great news, and I&#039;m also thinking about compressing a open wrt but now I have other problems</p><p>If you come up to maybe 2048kb free it would be nice to post that binary somewhere.</p></blockquote></div><p>OK, but this will NOT be a router, just AP / WDS, no LuCI as I can say for now, <br />- madplay &amp; deps (+usb-snd), <br />- anyRemote and deps, POSSIBLY bluez-utils for configuration, but those are HEAVY (&amp;deps)...<br />- bash (it it fits.. for my scripts).</p><p>Putting all those on squashfs should me more effective than on jffs2 (compression).</p><p>Is it possible to attach binary here?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176354">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">written_direcon</div>
					<div class="post-datetime">
						30 Aug 2012, 08:34					</div>
				</div>
				<div class="post-content content">
					<p>I bought my TL-WR3020 a week ago and flashing via the stock web interface went fine.</p><p>You can download the image I used and build by myself from <a href="ftp://ftp.custom-openwrt-builds.info/mr3020/builds/normal/r33288/">here</a>. It includes 3G (incl. usb-modeswitch) stuff and LuCI Web UI and extroot. E. g. I use a 3G dongle with an SD card + extroot and it works well! It&#039;s trunk r33288.</p>											<p class="post-edited">(Last edited by <strong>written_direcon</strong> on 30 Aug 2012, 08:54)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176393">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">vido</div>
					<div class="post-datetime">
						30 Aug 2012, 15:57					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><p>Is it possible to attach binary here?</p></blockquote></div><p>I think, here you can not attach the file larger than 2 Mb, but there are so many sites where you can, for example you can use dropbox</p><p>greeting</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p186716">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">2face</div>
					<div class="post-datetime">
						22 Dec 2012, 08:22					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>written_direcon wrote:</cite><blockquote><p>I bought my TL-WR3020 a week ago and flashing via the stock web interface went fine.</p><p>You can download the image I used and build by myself from <a href="ftp://ftp.custom-openwrt-builds.info/mr3020/builds/normal/r33288/">here</a>. It includes 3G (incl. usb-modeswitch) stuff and LuCI Web UI and extroot. E. g. I use a 3G dongle with an SD card + extroot and it works well! It&#039;s trunk r33288.</p></blockquote></div><br /><p>link is not working</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p303729">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">johnf</div>
					<div class="post-datetime">
						15 Dec 2015, 15:00					</div>
				</div>
				<div class="post-content content">
					<p>I also experienced this issue. It&#039;s definately filename length related. I moved the file to /tmp/ (out of /home/user/Downloads) but it still didn&#039;t work. I then renamed the file to openwrt-1043-factory.bin and I was able to load it. It&#039;s not looking for a specific naming convention, just a short name.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p334978">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">Egor</div>
					<div class="post-datetime">
						18 Aug 2016, 22:14					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><p>I also experienced this issue. It&#039;s definately filename length related.</p></blockquote></div><p>The issue is actually hilarious. Quoting their (unobfuscated) JavaScript code:<br /></p><div class="codebox"><pre><code>var arr = tmp.substr(tmp.lastIndexOf(&#039;\\&#039;) + 1);
if(arr.length &gt;= 64)
{
    alert(js_bad_file=&quot;Please choose a file to upgrade!&quot;);
    return false;
}</code></pre></div><p>I was flushing this build:<br /></p><div class="codebox"><pre><code>openwrt-15.05.1-ar71xx-generic-tl-mr3020-v1-squashfs-factory.bin</code></pre></div><p>Exactly 64 characters!</p><p>Renaming to something shorter is sufficient, like openwrt.bin (having &quot;.bin&quot; is important, there is another check for that). No need to move to /tmp or any other place.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>