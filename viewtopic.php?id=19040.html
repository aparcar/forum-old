<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Problem creating nas0 device</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 21 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p82423">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">MikeJ</div>
					<div class="post-datetime">
						23 Feb 2009, 03:43					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>I have tried to create this device several times and I keep ending up with this error:</p><p>root@OpenWrt:/etc/config# br2684ctl -c 0 -a 0.35<br />br2684ctl[1774]: socket creation failed: Address family not supported by protocol<br />br2684ctl[1774]: Communicating over ATM 0.0.35, encapsulation: LLC</p><p>br2684ctl[1774]: failed to create socket 124, reason: Address family not supported by protocol<br />br2684ctl[1774]: setsockopt SO_SNDBUF: (-1) Unknown error -1</p><p>br2684ctl[1774]: setsockopt SO_ATMQOS 9<br />br2684ctl[1774]: Fatal: failed to connect on socket</p><p>I have succesfully configured the pppoe using the documented uci commands for OpenWRT Kamikaze 8.09 but if I can&#039;t bridge the ppp0 device I cannot use it.</p><p>Has anyone else experienced the above errors trying to create the nic nas0? Any suggestions?</p><p>Mike</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p82437">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">MikeJ</div>
					<div class="post-datetime">
						23 Feb 2009, 06:30					</div>
				</div>
				<div class="post-content content">
					<p>Update:</p><p>I was able to create the device but now have the following error:</p><p>br2684ctl[2392]: Interface &quot;nas0&quot; created sucessfully<br />br2684ctl[2392]: Communicating over ATM 0.0.35, encapsulation: LLC<br />br2684ctl[2392]: Fatal: failed to connect on socket; No such device</p><p>Any help is much appreciated.</p><p>Thanks,<br />Mike</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p82470">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">KillaB</div>
					<div class="post-datetime">
						23 Feb 2009, 16:11					</div>
				</div>
				<div class="post-content content">
					<p>Please see the following thread for various DSL configurations:<br /><a href="http://forum.openwrt.org/viewtopic.php?id=17161">http://forum.openwrt.org/viewtopic.php?id=17161</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p82512">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">MikeJ</div>
					<div class="post-datetime">
						24 Feb 2009, 00:05					</div>
				</div>
				<div class="post-content content">
					<p>Thank you for the quick reply.</p><p>Unfortunately, though, it didn&#039;t help me. For some reason I cannot even create the nas0 interface because of this error:</p><p>br2684ctl[2392]: Fatal: failed to connect on socket; No such device</p><p>I cannot set my wan interface to nas0 because technically it doesn&#039;t exist yet (even though it said it has been created).</p><p>Essentially, all I need to do is bridge my WAN to my LAN using PPPoE. The stock firmware seems to do this automatically when you authenticate as a pppoe user (creates some sort of a bridged network device on which both the LAN and WAN connect). </p><p>Can you suggest a step-by-step approach to make this work? I plan on writing a wiki myself once I get it working but need a hand with what really should be a simple task....</p><p>Thanks,<br />Mike</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p82514">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">KillaB</div>
					<div class="post-datetime">
						24 Feb 2009, 00:11					</div>
				</div>
				<div class="post-content content">
					<p>Please post the contents of &quot;/etc/config/network&quot; excluding your pppoe username/password.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p83433">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">MikeJ</div>
					<div class="post-datetime">
						8 Mar 2009, 06:35					</div>
				</div>
				<div class="post-content content">
					<p>Sorry for the delayed response, KillaB. I&#039;ve had nothing but problems trying to sort out my pppoe. Here is my config (as you asked):</p><p>This is my OS</p><p>root@OpenWrt:/# uname -a<br />Linux OpenWrt 2.6.25.17 #16 Sun Feb 15 00:19:46 CET 2009 mips unknown</p><p>(yes, I made sure I did these commands using the 2.4 kernel first)</p><p>nvram set boot_wait=on<br />nvram set boot_time=10<br />nvram commit &amp;&amp; reboot</p><br /><p>Here is the network file (excluding password, etc.)</p><br /><p>config &#039;switch&#039; &#039;eth0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;vlan0&#039; &#039;0 1 2 3 5*&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;vlan1&#039; &#039;4 5&#039;</p><p>config &#039;interface&#039; &#039;loopback&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ifname&#039; &#039;lo&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;proto&#039; &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ipaddr&#039; &#039;127.0.0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;netmask&#039; &#039;255.0.0.0&#039;</p><p>config &#039;interface&#039; &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;type&#039; &#039;bridge&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ifname&#039; &#039;eth0.0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;proto&#039; &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ipaddr&#039; &#039;192.168.1.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;netmask&#039; &#039;255.255.255.0&#039;</p><p>config &#039;interface&#039; &#039;wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ifname&#039; &#039;eth0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;proto&#039; &#039;pppoe&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;username&#039; &#039;user&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;password&#039; &#039;pass&#039;</p><p>As you can see, there&#039;s no entry for NAS0. </p><p>This version of the OS is the stock openwrt found here: (just so you know I haven&#039;t tweaked anything). </p><p><a href="http://downloads.openwrt.org/kamikaze/8.09/brcm47xx/openwrt-wrt54g-squashfs.bin">http://downloads.openwrt.org/kamikaze/8 â€¦ uashfs.bin</a></p><br /><p>Thanks for your help / suggestions. Sorry again for the long delay in responding.</p><p>Mike</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p83464">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">janprunk</div>
					<div class="post-datetime">
						8 Mar 2009, 18:24					</div>
				</div>
				<div class="post-content content">
					<p>Hi !</p><p>I think that I have the same problem...</p><p>root@OpenWrt:~# br2684ctl -c 0 -a 0.35<br />br2684ctl[525]: socket creation failed: Address family not supported by protocol<br />br2684ctl[525]: Communicating over ATM 0.0.35, encapsulation: LLC<br />br2684ctl[525]: failed to create socket 124, reason: Address family not supported by protocol<br />br2684ctl[525]: setsockopt SO_SNDBUF: (-1) Unknown error -1<br />br2684ctl[525]: setsockopt SO_ATMQOS 9<br />br2684ctl[525]: Fatal: failed to connect on socket; Bad file descriptor</p><p>With this setup:</p><p>config &#039;switch&#039; &#039;eth0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;vlan0&#039; &#039;0 1 2 3 5*&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;vlan1&#039; &#039;4 5&#039;</p><p>config &#039;interface&#039; &#039;loopback&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ifname&#039; &#039;lo&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;proto&#039; &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ipaddr&#039; &#039;127.0.0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;netmask&#039; &#039;255.0.0.0&#039;</p><p>config &#039;interface&#039; &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;type&#039; &#039;bridge&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ifname&#039; &#039;eth0.0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;proto&#039; &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ipaddr&#039; &#039;192.168.1.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;netmask&#039; &#039;255.255.255.0&#039;</p><p>config &#039;atm-bridge&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;atmdev&#039; &#039;nas0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;unit&#039; &#039;0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;encaps&#039; &#039;llc&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;vpi&#039; &#039;0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;vci&#039; &#039;35&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;payload&#039; &#039;routed&#039;</p><p>config &#039;interface&#039; &#039;wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ifname&#039; &#039;nas0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;proto&#039; &#039;pppoe&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;username&#039; &#039;myusername&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;password&#039; &#039;mypassword&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;keepalive&#039; &#039;10&#039;</p><p>Any hint is apreciated.</p><p>Regards, <br />Jan</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p83468">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">janprunk</div>
					<div class="post-datetime">
						8 Mar 2009, 19:26					</div>
				</div>
				<div class="post-content content">
					<p>I would also like to mention that previously in White Russian the PPPoE worked.</p><p>And also this - I am using Linksys WRT54GL router.</p>											<p class="post-edited">(Last edited by <strong>janprunk</strong> on 8 Mar 2009, 19:28)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p84327">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">splat</div>
					<div class="post-datetime">
						22 Mar 2009, 05:11					</div>
				</div>
				<div class="post-content content">
					<p>I also have a wrt54gl and am having the same problems,<br />I installed br2684ctl and notice near the bottom of /etc/init.d/br2684ctl it has <br /></p><div class="codebox"><pre><code>insmod br2684 &gt;/dev/null 2&gt;/dev/null</code></pre></div><p>but there is no br2684.o anywhere on my system for it to installed... where can I get it?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p84707">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">janprunk</div>
					<div class="post-datetime">
						27 Mar 2009, 11:42					</div>
				</div>
				<div class="post-content content">
					<p>Has anyone come up with a solution for this error, its kinda disabling the internet usage for us at this stage.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p88880">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">janprunk</div>
					<div class="post-datetime">
						28 May 2009, 06:27					</div>
				</div>
				<div class="post-content content">
					<p>Has this bug been fixed, yet ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p88905">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">Wodin</div>
					<div class="post-datetime">
						28 May 2009, 18:24					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>splat wrote:</cite><blockquote><p>I also have a wrt54gl and am having the same problems,<br />I installed br2684ctl and notice near the bottom of /etc/init.d/br2684ctl it has <br /></p><div class="codebox"><pre><code>insmod br2684 &gt;/dev/null 2&gt;/dev/null</code></pre></div><p>but there is no br2684.o anywhere on my system for it to installed... where can I get it?</p></blockquote></div><p>You need the kmod-atm package.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>