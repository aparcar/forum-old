<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Openvpn client , how to setup?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 29 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p234989">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">diaconuliviu85</div>
					<div class="post-datetime">
						29 May 2014, 13:28					</div>
				</div>
				<div class="post-content content">
					<p>Hello </p><p>As my first post here I want to say hello and to thank you for your hard work. </p><p>I tried to install OpenVPN client is installed correctly, but I have a problem I do not know to configure. <br />Where exactly add these commands in the wiki.<br />config &#039;openvpn&#039; &#039;name_of_the_connection&#039;</p><br /><p>&nbsp; &nbsp; option &#039;client&#039; &#039;1&#039;<br />&nbsp; &nbsp; option &#039;remote&#039; &#039;xx.xxx.xxx.xx&#039;<br />&nbsp; &nbsp; option &#039;port&#039; &#039;1194&#039;<br />&nbsp; &nbsp; option &#039;proto&#039; &#039;udp&#039;<br />&nbsp; &nbsp; option &#039;dev&#039; &#039;tap0&#039;<br />&nbsp; &nbsp; option &#039;ca&#039; &#039;/path/to/ca.crt&#039;<br />&nbsp; &nbsp; option &#039;cert&#039; &#039;/path/to/client.crt&#039;<br />&nbsp; &nbsp; option &#039;key&#039; &#039;/path/to/client.key&#039;<br />&nbsp; &nbsp; option &#039;comp_lzo&#039; &#039;1&#039;<br />&nbsp; &nbsp; option &#039;keepalive&#039; &#039;10 120&#039;<br />&nbsp; &nbsp; option &#039;status&#039; &#039;/tmp/openvpn.status&#039;<br />&nbsp; &nbsp; option &#039;persist-key&#039; &#039;1&#039;<br />&nbsp; &nbsp; option &#039;persist-tun&#039; &#039;1&#039;<br />&nbsp; &nbsp; option &#039;verb&#039; &#039;7&#039;<br />&nbsp; &nbsp; option &#039;mute&#039; &#039;20&#039;<br />&nbsp; &nbsp; option &#039;nobind&#039; &#039;1&#039;</p><p>the question is where do I add?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p234992">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">qasdfdsaq</div>
					<div class="post-datetime">
						29 May 2014, 13:52					</div>
				</div>
				<div class="post-content content">
					<p>This needs to go in the file /etc/config/openvpn</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p234998">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						29 May 2014, 15:45					</div>
				</div>
				<div class="post-content content">
					<p>You need to replace dashes with underscores; &quot;persist_key&quot; &amp; &quot;persist_tun&quot;</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235051">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">zxdavb</div>
					<div class="post-datetime">
						29 May 2014, 22:43					</div>
				</div>
				<div class="post-content content">
					<p>diaconuliviu85,</p><p>You didn&#039;t make it clear if the OpenVPN client is the OpenWRT router (or if the router is the OpenVPN server).&nbsp; Assuming the OpenWRT router <em>is</em> the OpenVPN client then...</p><p>You could edit <strong>/etc/config/openvpn</strong> directly, or get a copy from the OpenVPN server and massage it a bit (a somewhat more reliable option, as the client configuration should &#039;match&#039; that of the server).&nbsp; </p><p>Alternatively, you could use UCI commands, which may work out better for you.</p><p>I don&#039;t know what wiki you were looking at, but (among other issues) TUN is generally preferred over TAP (i.e. option &#039;dev&#039; &#039;tap0&#039;).&nbsp; Maybe you could look at this wiki: <a href="http://wiki.openwrt.org/doc/howto/vpn.openvpn">http://wiki.openwrt.org/doc/howto/vpn.openvpn</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235058">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">qasdfdsaq</div>
					<div class="post-datetime">
						29 May 2014, 23:21					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>zxdavb wrote:</cite><blockquote><p>I don&#039;t know what wiki you were looking at, but (among other issues) TUN is generally preferred over TAP (i.e. option &#039;dev&#039; &#039;tap0&#039;).&nbsp; Maybe you could look at this wiki: <a href="http://wiki.openwrt.org/doc/howto/vpn.openvpn">http://wiki.openwrt.org/doc/howto/vpn.openvpn</a></p></blockquote></div><p>He was looking at:<br /><a href="http://wiki.openwrt.org/doc/howto/vpn.client.openvpn.tap">http://wiki.openwrt.org/doc/howto/vpn.c … penvpn.tap</a></p><p>Which is the firs Google result for &quot;Openvpn client Openwrt&quot;</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235175">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">diaconuliviu85</div>
					<div class="post-datetime">
						30 May 2014, 20:24					</div>
				</div>
				<div class="post-content content">
					<p>I do not know what to do , I put all you have it right, just like the tutorial but not working.</p><br /><p>config &#039; openvpn &#039; &#039; name_of_the_connection &#039;<br />        option &#039; client &#039; &#039;1 &#039;<br />        option &#039; remote &#039; &#039;1xx.xx.xx.xx &#039;<br />        option &#039; port &#039; &#039;1xx &#039;<br />        option &#039; proto &#039; &#039; tcp &#039;<br />        option &#039; dev &#039; &#039; tap0 &#039;<br />        option &#039; that &#039; &#039; / etc / openvpn / ca.crt &#039;<br />        option &#039; certain &#039; &#039; / etc/openvpn/client15.crt &#039;<br />        option &#039; key&#039; &#039;/ etc/openvpn/client15.key &#039;<br />        option &#039; comp_lzo &#039; &#039;1 &#039;<br />        option &#039; keepalive &#039; &#039;10 120 &#039;<br />        option &#039; status&#039; &#039;/ tmp / openvpn.status &#039;<br />        option persist -key &#039; &#039;1&#039;<br />        option persist -tun &#039; &#039;1&#039;<br />        option &#039; verb &#039; &#039;7 &#039;<br />        option &#039; move &#039; &#039;20 &#039;<br />        option &#039; nobind &#039; &#039;1 &#039;</p><br /><p>firewall</p><p>config areas<br />        option name &#039; VPN_client &#039;<br />        input option &#039; ACCEPT &#039;<br />        forward option &#039; REJECT &#039;<br />        output option &#039; ACCEPT &#039;<br />        network option &#039; VPN_client &#039;</p><p>config forwarding<br />        dest option &#039; lan &#039;<br />        src option &#039; VPN_client &#039;</p><p>config forwarding<br />        dest option &#039; VPN_client &#039;<br />        src option &#039; lan &#039;</p><br /><p>But do not go in there luci openvpn client. but 0 traffic. What was wrong ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235188">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">3zl</div>
					<div class="post-datetime">
						30 May 2014, 22:39					</div>
				</div>
				<div class="post-content content">
					<p>somethings messed up here<br />additionally as jow wrote....take care of the hyphens which are missing<br />copy-paste problem ?</p><br /><p><strong>&nbsp; &nbsp;option persist -key &#039; &#039;1&#039;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-&gt;&nbsp; option &#039;persist_key&#039;&nbsp; &nbsp; &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp;option persist -tun &#039; &#039;1&#039;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -&gt;&nbsp; option &#039;persist_tun &#039;&nbsp; &nbsp;&#039;1&#039;<br /></strong></p><br /><p>to check for syntax errors in uci config files use</p><p>&quot;uci show openvpn&quot;</p><p>regards<br />3zl</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235191">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">zxdavb</div>
					<div class="post-datetime">
						30 May 2014, 23:03					</div>
				</div>
				<div class="post-content content">
					<p>Actually, your config files are all over the shop!&nbsp; Are you sure they&#039;re your actual files?&nbsp; They can&#039;t be, you must be retyping them, right?</p><p>You have to help the community help you.&nbsp; You must at least cut-and-paste your config files, rather than retyping them.&nbsp; Please execute the following &amp; copy-and-paste the results here.<br /></p><div class="codebox"><pre><code>uci show openvpn</code></pre></div><p>In addition, I suggest <em>again</em> you use the wiki at: <a href="http://wiki.openwrt.org/doc/howto/vpn.openvpn">http://wiki.openwrt.org/doc/howto/vpn.openvpn</a>.&nbsp; The other wiki mentioned here (the one with TAP) is effectively two years out-of-date!&nbsp; This wiki will show you how to configure a OpenVPN client &amp; server, and a PKI!&nbsp; It also has many tips on troubleshooting.</p><p>If yu want to persist with your configuration, then I suggest that you do the following.&nbsp; Firstly, get rid of (it does nothing useful for you):<br /></p><div class="codebox"><pre><code>option &#039;status&#039; &#039;/tmp/openvpn.status&#039;</code></pre></div><p>Instead, use:<br /></p><div class="codebox"><pre><code>option &#039;log&#039; &#039;/tmp/openvpn.log&#039;
option verb 3</code></pre></div><p>An alternative (better?) way to do the above three changes is (where XXX is the name of your configuration):<br /></p><div class="codebox"><pre><code>uci del openvpn.XXX.status
uci set openvpn.XXX.log=/tmp/openvpn.log
uci set openvpn.XXX.verb=3</code></pre></div><p>Then you can execute the following to restart openvpn, and this time you&#039;ll also create a log file:<br /></p><div class="codebox"><pre><code>uci commit openvpn
/etc/init.d/openvpn restart</code></pre></div><p>The, use this command to see what happened.&nbsp; I suggest you post the results here!<br /></p><div class="codebox"><pre><code>cat /tmp/openvpn.log</code></pre></div><p>Many people may be in a position to help you if you do the above, including me!</p>											<p class="post-edited">(Last edited by <strong>zxdavb</strong> on 31 May 2014, 00:22)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235200">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">zxdavb</div>
					<div class="post-datetime">
						31 May 2014, 00:08					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>qasdfdsaq wrote:</cite><blockquote><div class="quotebox"><cite>zxdavb wrote:</cite><blockquote><p>I don&#039;t know what wiki you were looking at, but (among other issues) TUN is generally preferred over TAP (i.e. option &#039;dev&#039; &#039;tap0&#039;).&nbsp; Maybe you could look at this wiki: <a href="http://wiki.openwrt.org/doc/howto/vpn.openvpn">http://wiki.openwrt.org/doc/howto/vpn.openvpn</a></p></blockquote></div><p>He was looking at:<br /><a href="http://wiki.openwrt.org/doc/howto/vpn.client.openvpn.tap">http://wiki.openwrt.org/doc/howto/vpn.c … penvpn.tap</a></p><p>Which is the firs Google result for &quot;Openvpn client Openwrt&quot;</p></blockquote></div><p>That wiki is really two years out of date (if you look at the differences).&nbsp; I have taken the liberty to add an informal &#039;warning&#039; to the top of that particular wiki (i.e the TAP wiki).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235209">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">qasdfdsaq</div>
					<div class="post-datetime">
						31 May 2014, 02:52					</div>
				</div>
				<div class="post-content content">
					<p>Yes, it may be out of date, but it is still the first Google result. Can&#039;t blame him for trying it.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p235223">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">zxdavb</div>
					<div class="post-datetime">
						31 May 2014, 10:40					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>qasdfdsaq wrote:</cite><blockquote><p>Yes, it may be out of date, but it is still the first Google result. Can&#039;t blame him for trying it.</p></blockquote></div><p>I agree completely, that&#039;s why I added a warning to the top of that wiki.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>