<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> usb with linksys 350</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 25 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p115926">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">delacosta456</div>
					<div class="post-datetime">
						26 Aug 2010, 16:38					</div>
				</div>
				<div class="post-content content">
					<p>Hi<br />i am new in openwrt and flashed my linksys WRT 350 v2 with the latest firmware blackfire 10.3.<br />I am trying to use flash disk for installing package but dont know ho to do it successfull .i have tried several tutorial on how to mount usb flash disk but it not working please can you help ...&nbsp; below is my kenel log </p><p>Linux version 2.6.32.10 (openwrt@wrt1.marcant.net) (gcc version 4.3.3 (GCC) ) #16 Tue Apr 6 16:58:21 CEST 2010<br />CPU: Feroceon [41069260] revision 0 (ARMv5TEJ), cr=a0053177<br />CPU: VIVT data cache, VIVT instruction cache<br />Machine: Linksys WRT350N v2<br />Clearing invalid memory bank 0KB@0xffffffff<br />Clearing invalid memory bank 0KB@0xffffffff<br />Clearing invalid memory bank 0KB@0xffffffff<br />Ignoring unrecognised tag 0x00000000<br />Ignoring unrecognised tag 0x00000000<br />Ignoring unrecognised tag 0x00000000<br />Memory policy: ECC disabled, Data cache writeback<br />On node 0 totalpages: 8192<br />free_area_init_node: node 0, pgdat c0260654, node_mem_map c0272000<br />&nbsp; Normal zone: 64 pages used for memmap<br />&nbsp; Normal zone: 0 pages reserved<br />&nbsp; Normal zone: 8128 pages, LIFO batch:0<br />Built 1 zonelists in Zone order, mobility grouping on.&nbsp; Total pages: 8128<br />Kernel command line: root=/dev/mtdblock1 rootfstype=squashfs,jffs2 noinitrd console=ttyS0,115200<br />PID hash table entries: 128 (order: -3, 512 bytes)<br />Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)<br />Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)<br />Memory: 32MB = 32MB total<br />Memory: 29984KB available (2232K code, 137K data, 96K init, 0K highmem)<br />Hierarchical RCU implementation.<br />NR_IRQS:64<br />Calibrating delay loop... 332.59 BogoMIPS (lpj=1662976)<br />Mount-cache hash table entries: 512<br />CPU: Testing write buffer coherency: ok<br />NET: Registered protocol family 16<br />Orion ID: MV88F5181L-Rev-A1. TCLK=166666667.<br />Applying Orion-1/Orion-NAS PCIe config read transaction workaround<br />pci 0000:00:00.0: reg 10 64bit mmio pref: [0xf1000000-0xf10fffff]<br />pci 0000:00:00.0: reg 18 32bit mmio: [0x000000-0x1ffffff]<br />PCI: bus0: Fast back to back transfers disabled<br />pci 0000:01:00.0: reg 10 64bit mmio pref: [0x000000-0x1ffffff]<br />pci 0000:01:00.0: reg 18 64bit mmio pref: [0x10000000-0x1fffffff]<br />pci 0000:01:00.0: reg 20 64bit mmio: [0xf1000000-0xf10fffff]<br />pci 0000:01:00.0: reg 30 32bit mmio pref: [0xe0000000-0xe7ffffff]<br />pci 0000:01:00.0: supports D1 D2<br />pci 0000:01:00.0: PME# supported from D0 D1 D2 D3hot<br />pci 0000:01:00.0: PME# disabled<br />pci 0000:01:07.0: reg 10 32bit mmio: [0x40000000-0x4000ffff]<br />PCI: bus1: Fast back to back transfers enabled<br />bio: create slab &lt;bio-0&gt; at 0<br />Switching to clocksource orion_clocksource<br />NET: Registered protocol family 2<br />IP route cache hash table entries: 1024 (order: 0, 4096 bytes)<br />TCP established hash table entries: 1024 (order: 1, 8192 bytes)<br />TCP bind hash table entries: 1024 (order: 0, 4096 bytes)<br />TCP: Hash tables configured (established 1024 bind 1024)<br />TCP reno registered<br />NET: Registered protocol family 1<br />squashfs: version 4.0 (2009/01/31) Phillip Lougher<br />Registering mini_fo version $Id$<br />JFFS2 version 2.2. (NAND) (SUMMARY)&nbsp; Â© 2001-2006 Red Hat, Inc.<br />msgmni has been set to 58<br />io scheduler noop registered<br />io scheduler deadline registered (default)<br />Serial: 8250/16550 driver, 2 ports, IRQ sharing disabled<br />serial8250.0: ttyS0 at MMIO 0xf1012000 (irq = 3) is a 16550A<br />console [ttyS0] enabled<br />physmap platform flash device: 00800000 at f4000000<br />physmap-flash.0: Found 1 x16 devices at 0x0 in 8-bit bank<br />Amd/Fujitsu Extended Query Table at 0x0040<br />physmap-flash.0: Swapping erase regions for broken CFI table.<br />number of CFI chips: 1<br />cfi_cmdset_0002: Disabling erase-suspend-program due to code brokenness.<br />cmdlinepart partition parsing not available<br />RedBoot partition parsing not available<br />Using physmap partition information<br />Creating 7 MTD partitions on &quot;physmap-flash.0&quot;:<br />0x000000000000-0x000000100000 : &quot;kernel&quot;<br />0x000000100000-0x000000750000 : &quot;rootfs&quot;<br />mtd: partition &quot;rootfs&quot; set to be root filesystem<br />mtd: partition &quot;rootfs_data&quot; created automatically, ofs=290000, len=4C0000 <br />0x000000290000-0x000000750000 : &quot;rootfs_data&quot;<br />0x000000760000-0x0000007a0000 : &quot;lang&quot;<br />0x0000007a0000-0x0000007c0000 : &quot;nvram&quot;<br />0x0000007c0000-0x000000800000 : &quot;u-boot&quot;<br />0x000000750000-0x000000760000 : &quot;eRcOmM_do_not_touch&quot;<br />0x000000000000-0x000000750000 : &quot;image&quot;<br />MV-643xx 10/100/1000 ethernet driver version 1.4<br />mv643xx_eth smi: probed<br />net eth0: port 0 with MAC address 00:00:00:00:51:81<br />i2c /dev entries driver<br />Registered led device: wrt350nv2:green:power<br />Registered led device: wrt350nv2:green:security<br />Registered led device: wrt350nv2:orange:power<br />Registered led device: wrt350nv2:green:usb<br />Registered led device: wrt350nv2:green:wireless<br />TCP westwood registered<br />NET: Registered protocol family 17<br />Distributed Switch Architecture driver version 0.1<br />eth0[0]: detected a Marvell 88E6131 switch<br />dsa slave smi: probed<br />802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;<br />All bugs added by David S. Miller &lt;davem@redhat.com&gt;<br />drivers/rtc/hctosys.c: unable to open rtc device (rtc0)<br />VFS: Mounted root (squashfs filesystem) readonly on device 31:1.<br />Freeing init memory: 96K<br />Please be patient, while OpenWrt loads ...<br />mini_fo: using base directory: /<br />mini_fo: using storage directory: /overlay<br />eth0: link up, 1000 Mb/s, full duplex, flow control disabled<br />device lan2 entered promiscuous mode<br />device eth0 entered promiscuous mode<br />device lan1 entered promiscuous mode<br />lan1: link up, 100 Mb/s, full duplex, flow control disabled<br />wan: link up, 100 Mb/s, full duplex, flow control disabled<br />br-lan: port 2(lan1) entering forwarding state<br />device lan3 entered promiscuous mode<br />device lan4 entered promiscuous mode<br />Generic kernel compatibility enabled based on linux-next next-20100113<br />cfg80211: Calling CRDA to update world regulatory domain<br />cfg80211: World regulatory domain updated:<br />&nbsp; &nbsp; (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp)<br />&nbsp; &nbsp; (2402000 KHz - 2472000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)<br />&nbsp; &nbsp; (2457000 KHz - 2482000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)<br />&nbsp; &nbsp; (2474000 KHz - 2494000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)<br />&nbsp; &nbsp; (5170000 KHz - 5250000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)<br />&nbsp; &nbsp; (5735000 KHz - 5835000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)<br />SCSI subsystem initialized<br />usbcore: registered new interface driver usbfs<br />usbcore: registered new interface driver hub<br />usbcore: registered new device driver usb<br />ath: EEPROM regdomain: 0x37<br />ath: EEPROM indicates we should expect a direct regpair map<br />ath: Country alpha2 being used: AW<br />ath: Regpair used: 0x37<br />phy0: Selected rate control algorithm &#039;ath9k_rate_control&#039;<br />Registered led device: ath9k-phy0::radio<br />Registered led device: ath9k-phy0::assoc<br />Registered led device: ath9k-phy0::tx<br />Registered led device: ath9k-phy0::rx<br />phy0: Atheros AR5416 MAC/BB Rev:2 AR2133 RF Rev:81 mem=0xc2b00000, irq=36<br />cfg80211: Calling CRDA for country: AW<br />cfg80211: Regulatory domain changed to country: AW<br />&nbsp; &nbsp; (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp)<br />&nbsp; &nbsp; (2402000 KHz - 2482000 KHz @ 40000 KHz), (N/A, 2000 mBm)<br />&nbsp; &nbsp; (5170000 KHz - 5250000 KHz @ 40000 KHz), (N/A, 2000 mBm)<br />&nbsp; &nbsp; (5250000 KHz - 5330000 KHz @ 40000 KHz), (N/A, 2000 mBm)<br />&nbsp; &nbsp; (5490000 KHz - 5710000 KHz @ 40000 KHz), (N/A, 2700 mBm)<br />PPP generic driver version 2.4.2<br />ip_tables: (C) 2000-2006 Netfilter Core Team<br />NET: Registered protocol family 24<br />ehci_hcd: USB 2.0 &#039;Enhanced&#039; Host Controller (EHCI) Driver<br />orion-ehci orion-ehci.0: Marvell Orion EHCI<br />orion-ehci orion-ehci.0: new USB bus registered, assigned bus number 1<br />orion-ehci orion-ehci.0: irq 17, io mem 0xf1050000<br />orion-ehci orion-ehci.0: USB 2.0 started, EHCI 1.00<br />usb usb1: configuration #1 chosen from 1 choice<br />hub 1-0:1.0: USB hub found<br />hub 1-0:1.0: 1 port detected<br />nf_conntrack version 0.5.0 (470 buckets, 1880 max)<br />CONFIG_NF_CT_ACCT is deprecated and will be removed soon. Please use<br />nf_conntrack.acct=1 kernel parameter, acct=1 nf_conntrack module option or<br />sysctl net.netfilter.nf_conntrack_acct=1 to enable it.<br />usb 1-1: new high speed USB device using orion-ehci and address 2<br />usb 1-1: configuration #1 chosen from 1 choice<br />uhci_hcd: USB Universal Host Controller Interface driver<br />Initializing USB Mass Storage driver...<br />scsi0 : SCSI emulation for USB Mass Storage devices<br />usbcore: registered new interface driver usb-storage<br />USB Mass Storage support registered.<br />usb-storage: device found at 2<br />usb-storage: waiting for device to settle before scanning<br />scsi 0:0:0:0: Direct-Access&nbsp; &nbsp; &nbsp;Generic&nbsp; USB2.0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1.00 PQ: 0 ANSI: 2<br />sd 0:0:0:0: [sda] 2037248 512-byte logical blocks: (1.04 GB/994 MiB)<br />usb-storage: device scan complete<br />sd 0:0:0:0: [sda] Write Protect is off<br />sd 0:0:0:0: [sda] Mode Sense: 03 00 00 00<br />sd 0:0:0:0: [sda] Assuming drive cache: write through<br />sd 0:0:0:0: [sda] Assuming drive cache: write through<br />sda: sda1<br />sd 0:0:0:0: [sda] Assuming drive cache: write through<br />sd 0:0:0:0: [sda] Attached SCSI removable disk</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p116042">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">pale</div>
					<div class="post-datetime">
						28 Aug 2010, 18:53					</div>
				</div>
				<div class="post-content content">
					<p>mount /dev/sda1 /mnt will mount your flash drive at&nbsp; /mnt</p><br /><p>There appears to be 2 ways of getting the system to boot from usb flash, one is</p><p><a href="http://wiki.openwrt.org/doc/howto/rootfsonexternalstorage">http://wiki.openwrt.org/doc/howto/rootf â¦ nalstorage</a></p><p>and the other </p><p><a href="http://wiki.openwrt.org/oldwiki/usbstoragehowto">http://wiki.openwrt.org/oldwiki/usbstoragehowto</a></p><p>the first requires block-extroot to be part of the flash ie you will have to compile your own flash image . I have tried just installing the packages and it wont work ( on a asus wl-600g that is) the ipk file says this too.</p><p>the second is older and some what involved and doesn&#039;t quite fit. I have just got it workng I believe ( it needs a few tests) I will post my method soon. ( this is for the asus wl-600g but should be the same ) . The trouble with the old method is that the usb modules dont get loaded soon enough . some of the /etc/rc.d/S** has to be run before you can pivot root. I dont know if this is a 10.03 thing but I think I have a work around.</p><p>pale</p><p>EDIT :</p><p>I cannot get the <br />init calls &quot;/etc/init.d/rcS S boot&quot; <br />to read the /etc/init.d/rcS on the external fs . It somehow finds the one on the jffs even though I have pivot root ed before this point. ( this is driving me spare aagghhh)</p><p>I can get the system to to mount the usb drives and pivot root . Thus any thing that I now install goes to the usb fs . If I install samba3 the S60samba start script goes in the external usbfs /etc/rc.d/ and thus does NOT get run on a reboot. as init looks in the internal jffs&nbsp; /etc/rc.d/. the only way I have managed to get thing to work is to manualy copy the S60samba script to the internal jffs /etc/rc.d/. I have managed to pivot root at S17 so stuff after this can see the usb fs.</p><p>I dont know where to get the source for 10.03-1 rc1 from to compile a firmware with block-extroot in it.</p>											<p class="post-edited">(Last edited by <strong>pale</strong> on 30 Aug 2010, 16:36)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p116578">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">delacosta456</div>
					<div class="post-datetime">
						6 Sep 2010, 22:47					</div>
				</div>
				<div class="post-content content">
					<p>Hi Pale and thanks for your answer</p><p>i&nbsp; having a problem with my WRT350N V2 on wich i install openwrt blackfire 10.03 &quot;orion&quot; image</p><p>i am was planning to extend the overlay to could install more package that is why i follow this howto for 10.3: <a href="http://wiki.openwrt.org/inbox/howto/configure-external-storage-overlay">http://wiki.openwrt.org/inbox/howto/con â¦ ge-overlay</a>When follow all instructions i can see that the overlay is extend but when i installl package it still install to the root directory .End when the root directory is full i have a segmentation fault while status still showing me a lot of free space on the overlay that did not move att all even after installing packages...<br />But when i change the destination in opkg.conf to &quot; dest root /overlay &quot; instead of &quot; dest root /&#039; the new mounted overlay grown u and confirm that packages are installed on new overlay but it seem that those packages are not load when system boot from external storage ...( i mean menu did not show ..like when i install coovachilli and webif lua coova chilli...) i have even try to add to etc/profile PATH bin lib and usr / bin or sbin but menu still don&#039;t show </p><p>is there anything i haven&#039;t tried....please need a help...</p><br /><p>Serge ZOUMENOU</p>											<p class="post-edited">(Last edited by <strong>delacosta456</strong> on 6 Sep 2010, 22:50)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p116896">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">pale</div>
					<div class="post-datetime">
						11 Sep 2010, 12:55					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m afraid that is about all I know at the moment , I am learning this stuff too. </p><p>pale</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>