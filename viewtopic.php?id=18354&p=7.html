<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> TP-Link TL-WR941N WR941ND - Atheros AP81 platform, USB port</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 13 Jun 2015 and 6 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 7 of 8</div><nav><ul><li><a href="viewtopic.php%3Fid=18354&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=18354&amp;p=5.html">5</a></li><li><a href="viewtopic.php%3Fid=18354&amp;p=6.html">6</a></li><li class="pagination-current"><span>7</span></li><li><a href="viewtopic.php%3Fid=18354&amp;p=8.html">8</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p122665">
				<div class="post-metadata">
					<div class="post-num">Post #151</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						5 Dec 2010, 18:50					</div>
				</div>
				<div class="post-content content">
					<p>Is it true that for TL-WR941ND v1-v3 the Flash Memory Command &quot;erase&quot; and &quot;cp&quot; were removed in U-Boot 1.1.4 (Jun 18 2009 - 15:08:27) and later as reported <a href="https://forum.openwrt.org/viewtopic.php?pid=98836#p98836">here</a> by fzfq3m?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p123614">
				<div class="post-metadata">
					<div class="post-num">Post #152</div>
					<div class="post-author">idrAX</div>
					<div class="post-datetime">
						21 Dec 2010, 12:04					</div>
				</div>
				<div class="post-content content">
					<p>Can somebody help me? I can&#039;t get usb working on 941ndV3.5(Board rev.1.2): i&#039;ve flashed modded uboot, added 2 lines in target file, soldered r96 and 5V power line (and shortened r1000 r1001), but there is no activity on the port. All needed kernel modules also installed. Log:<br /></p><div class="codebox"><pre><code>Mar 27 05:44:00 trololo syslog.info syslogd started: BusyBox v1.17.3
Mar 27 05:44:00 trololo user.notice kernel: No RedBoot partition table detected in spi0.0
Mar 27 05:44:00 trololo user.notice kernel: spi0.0: no WRT160NL signature found
Mar 27 05:44:00 trololo user.notice kernel: Creating 5 MTD partitions on &quot;spi0.0&quot;:
Mar 27 05:44:00 trololo user.notice kernel: 0x000000000000-0x000000020000 : &quot;u-boot&quot;
Mar 27 05:44:00 trololo user.notice kernel: 0x000000020000-0x000000160000 : &quot;kernel&quot;
Mar 27 05:44:00 trololo user.notice kernel: 0x000000160000-0x0000003f0000 : &quot;rootfs&quot;
Mar 27 05:44:00 trololo user.notice kernel: mtd: partition &quot;rootfs&quot; set to be root filesystem
Mar 27 05:44:00 trololo user.info kernel: mtd: partition &quot;rootfs_data&quot; created automatically, ofs=380000, len=70000 
Mar 27 05:44:00 trololo user.notice kernel: 0x000000380000-0x0000003f0000 : &quot;rootfs_data&quot;
Mar 27 05:44:00 trololo user.notice kernel: 0x0000003f0000-0x000000400000 : &quot;art&quot;
Mar 27 05:44:00 trololo user.notice kernel: 0x000000020000-0x0000003f0000 : &quot;firmware&quot;
Mar 27 05:44:00 trololo user.info kernel: ag71xx_mdio: probed
Mar 27 05:44:00 trololo user.info kernel: eth0: Atheros AG71xx at 0xb9000000, irq 4
Mar 27 05:44:00 trololo user.debug kernel: eth0: using fixed link parameters
Mar 27 05:44:00 trololo user.info kernel: Atheros AR71xx hardware watchdog driver version 0.1.0
Mar 27 05:44:00 trololo user.debug kernel: ar71xx-wdt: timeout=15 secs (max=42)
Mar 27 05:44:00 trololo user.info kernel: TCP westwood registered
Mar 27 05:44:00 trololo user.info kernel: NET: Registered protocol family 17
Mar 27 05:44:00 trololo user.notice kernel: Distributed Switch Architecture driver version 0.1
Mar 27 05:44:00 trololo user.info kernel: eth0[0]: detected a Marvell 88E6060 switch
Mar 27 05:44:00 trololo user.info kernel: dsa slave smi: probed
Mar 27 05:44:00 trololo user.info kernel: 802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;
Mar 27 05:44:00 trololo user.info kernel: All bugs added by David S. Miller &lt;davem@redhat.com&gt;
Mar 27 05:44:00 trololo user.warn kernel: VFS: Mounted root (squashfs filesystem) readonly on device 31:2.
Mar 27 05:44:00 trololo user.info kernel: Freeing unused kernel memory: 148k freed
Mar 27 05:44:00 trololo user.warn kernel: Please be patient, while OpenWrt loads ...
Mar 27 05:44:00 trololo user.info kernel: input: gpio-buttons as /devices/platform/gpio-buttons/input/input0
Mar 27 05:44:00 trololo user.info kernel: Button Hotplug driver version 0.4.1
Mar 27 05:44:00 trololo user.debug kernel: ar71xx: pll_reg 0xb8050014: 0x13000a44
Mar 27 05:44:00 trololo user.info kernel: eth0: link up (100Mbps/Full duplex)
Mar 27 05:44:00 trololo user.info kernel: Registered led device: tl-wr941nd:green:system
Mar 27 05:44:00 trololo user.info kernel: Registered led device: tl-wr941nd:red:qss
Mar 27 05:44:00 trololo user.info kernel: Registered led device: tl-wr941nd:green:qss
Mar 27 05:44:00 trololo user.info kernel: Registered led device: tl-wr941nd:green:wlan
Mar 27 05:44:00 trololo user.info kernel: mini_fo: using base directory: /
Mar 27 05:44:00 trololo user.info kernel: mini_fo: using storage directory: /overlay
Mar 27 05:44:00 trololo user.info kernel: eth0: link down
Mar 27 05:44:00 trololo user.debug kernel: ar71xx: pll_reg 0xb8050014: 0x13000a44
Mar 27 05:44:00 trololo user.info kernel: eth0: link up (100Mbps/Full duplex)
Mar 27 05:44:01 trololo user.info kernel: device eth0 entered promiscuous mode
Mar 27 05:44:01 trololo user.info kernel: wan: link up, 100 Mb/s, full duplex, flow control disabled
Mar 27 05:44:02 trololo user.info kernel: PPP generic driver version 2.4.2
Mar 27 05:44:02 trololo user.info kernel: NET: Registered protocol family 24
Mar 27 05:44:02 trololo user.notice rdate: No usable time server for loopback found
Mar 27 05:44:03 trololo user.info kernel: device lan1 entered promiscuous mode
Mar 27 05:44:03 trololo user.info kernel: lan1: link up, 100 Mb/s, full duplex, flow control disabled
Mar 27 05:44:03 trololo user.info kernel: br-lan: port 1(lan1) entering forwarding state
Mar 27 05:44:03 trololo user.notice rdate: No usable time server for eth found
Mar 27 05:44:03 trololo daemon.info pppd[527]: Plugin rp-pppoe.so loaded.
Mar 27 05:44:03 trololo user.info kernel: device lan2 entered promiscuous mode
Mar 27 05:44:04 trololo user.info kernel: device lan3 entered promiscuous mode
Mar 27 05:44:04 trololo user.info kernel: device lan4 entered promiscuous mode
Mar 27 05:44:04 trololo user.info kernel: Compat-wireless backport release: compat-wireless-2010-12-10-3-g880bb0b
Mar 27 05:44:04 trololo user.info kernel: Backport based on wireless-testing.git master-2010-12-16
Mar 27 05:44:05 trololo user.info kernel: cfg80211: Calling CRDA to update world regulatory domain
Mar 27 05:44:06 trololo user.notice kernel: SCSI subsystem initialized
Mar 27 05:44:06 trololo user.info kernel: cfg80211: World regulatory domain updated:
Mar 27 05:44:06 trololo user.info kernel: cfg80211:     (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp)
Mar 27 05:44:06 trololo user.info kernel: cfg80211:     (2402000 KHz - 2472000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
Mar 27 05:44:06 trololo user.info kernel: cfg80211:     (2457000 KHz - 2482000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
Mar 27 05:44:06 trololo user.info kernel: cfg80211:     (2474000 KHz - 2494000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
Mar 27 05:44:06 trololo user.info kernel: cfg80211:     (5170000 KHz - 5250000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
Mar 27 05:44:06 trololo user.info kernel: cfg80211:     (5735000 KHz - 5835000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
Mar 27 05:44:06 trololo user.notice rdate: No usable time server for lan found
Mar 27 05:44:06 trololo user.info kernel: usbcore: registered new interface driver usbfs
Mar 27 05:44:06 trololo user.info kernel: usbcore: registered new interface driver hub
Mar 27 05:44:06 trololo user.info kernel: usbcore: registered new device driver usb
Mar 27 05:44:08 trololo user.debug kernel: ath: EEPROM regdomain: 0x0
Mar 27 05:44:08 trololo user.debug kernel: ath: EEPROM indicates default country code should be used
Mar 27 05:44:08 trololo user.debug kernel: ath: doing EEPROM country-&gt;regdmn map search
Mar 27 05:44:08 trololo user.debug kernel: ath: country maps to regdmn code: 0x3a
Mar 27 05:44:08 trololo user.debug kernel: ath: Country alpha2 being used: US
Mar 27 05:44:08 trololo user.debug kernel: ath: Regpair used: 0x3a
Mar 27 05:44:08 trololo user.debug kernel: ieee80211 phy0: Selected rate control algorithm &#039;minstrel_ht&#039;
Mar 27 05:44:08 trololo user.info kernel: ieee80211 phy0: Atheros AR9100 MAC/BB Rev:0 AR2133 RF Rev:a2 mem=0xb80c0000, irq=2
Mar 27 05:44:08 trololo user.info kernel: cfg80211: Calling CRDA for country: US
Mar 27 05:44:08 trololo user.info kernel: cfg80211: Regulatory domain changed to country: US
Mar 27 05:44:08 trololo user.info kernel: cfg80211:     (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp)
Mar 27 05:44:08 trololo user.info kernel: cfg80211:     (2402000 KHz - 2472000 KHz @ 40000 KHz), (300 mBi, 2700 mBm)
Mar 27 05:44:08 trololo user.info kernel: cfg80211:     (5170000 KHz - 5250000 KHz @ 40000 KHz), (300 mBi, 1700 mBm)
Mar 27 05:44:08 trololo user.info kernel: cfg80211:     (5250000 KHz - 5330000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
Mar 27 05:44:08 trololo user.info kernel: cfg80211:     (5490000 KHz - 5600000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
Mar 27 05:44:08 trololo user.info kernel: cfg80211:     (5650000 KHz - 5710000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
Mar 27 05:44:08 trololo user.info kernel: cfg80211:     (5735000 KHz - 5835000 KHz @ 40000 KHz), (300 mBi, 3000 mBm)
Mar 27 05:44:09 trololo user.info kernel: ip_tables: (C) 2000-2006 Netfilter Core Team
Mar 27 05:44:09 trololo user.info kernel: ehci_hcd: USB 2.0 &#039;Enhanced&#039; Host Controller (EHCI) Driver
Mar 27 05:44:09 trololo user.info kernel: ar71xx-ehci ar71xx-ehci: Atheros AR91xx built-in EHCI controller
Mar 27 05:44:09 trololo user.info kernel: ar71xx-ehci ar71xx-ehci: new USB bus registered, assigned bus number 1
Mar 27 05:44:09 trololo user.info kernel: ar71xx-ehci ar71xx-ehci: irq 3, io mem 0x1b000000
Mar 27 05:44:09 trololo user.info kernel: ar71xx-ehci ar71xx-ehci: USB 2.0 started, EHCI 1.00
Mar 27 05:44:09 trololo user.info kernel: usb usb1: configuration #1 chosen from 1 choice
Mar 27 05:44:09 trololo user.info kernel: hub 1-0:1.0: USB hub found
Mar 27 05:44:09 trololo user.info kernel: hub 1-0:1.0: 1 port detected
Mar 27 05:44:09 trololo user.warn kernel: nf_conntrack version 0.5.0 (462 buckets, 1848 max)
Mar 27 05:44:09 trololo user.warn kernel: CONFIG_NF_CT_ACCT is deprecated and will be removed soon. Please use
Mar 27 05:44:09 trololo user.warn kernel: nf_conntrack.acct=1 kernel parameter, acct=1 nf_conntrack module option or
Mar 27 05:44:09 trololo user.warn kernel: sysctl net.netfilter.nf_conntrack_acct=1 to enable it.
Mar 27 05:44:10 trololo user.info kernel: xt_time: kernel timezone is -0000
Mar 27 05:44:11 trololo user.info kernel: IMQ driver loaded successfully.
Mar 27 05:44:11 trololo user.info kernel:     Hooking IMQ before NAT on PREROUTING.
Mar 27 05:44:11 trololo user.info kernel:     Hooking IMQ after NAT on POSTROUTING.
Mar 27 05:44:11 trololo user.info kernel: ohci_hcd: USB 1.1 &#039;Open&#039; Host Controller (OHCI) Driver
Mar 27 05:44:11 trololo user.info kernel: Initializing USB Mass Storage driver...
Mar 27 05:44:11 trololo user.info kernel: usbcore: registered new interface driver usb-storage
Mar 27 05:44:11 trololo user.info kernel: USB Mass Storage support registered.
Mar 27 05:44:13 trololo user.info kernel: device wlan0 entered promiscuous mode
Mar 27 05:44:13 trololo user.info kernel: br-lan: port 5(wlan0) entering forwarding state</code></pre></div>											<p class="post-edited">(Last edited by <strong>idrAX</strong> on 21 Dec 2010, 12:08)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p123664">
				<div class="post-metadata">
					<div class="post-num">Post #153</div>
					<div class="post-author">Philth</div>
					<div class="post-datetime">
						22 Dec 2010, 01:57					</div>
				</div>
				<div class="post-content content">
					<p>@idrAX</p><p>I have the v4 which has the AR7240 processor. It only supports USB 1.1 using the ohci driver. </p><p>AFAIK the AR9132 in the V3 supports USB 2.0. Try using the uhci driver instead or enabling the driver for USB 2.0 in the kernel or both. If none of these help then try looking at the hardware.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p123890">
				<div class="post-metadata">
					<div class="post-num">Post #154</div>
					<div class="post-author">idrAX</div>
					<div class="post-datetime">
						24 Dec 2010, 20:26					</div>
				</div>
				<div class="post-content content">
					<p>Nice, it was hardware problem. Now everything works fine.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p124636">
				<div class="post-metadata">
					<div class="post-num">Post #155</div>
					<div class="post-author">regressor</div>
					<div class="post-datetime">
						6 Jan 2011, 15:00					</div>
				</div>
				<div class="post-content content">
					<p>OK. I did it. Again.... <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> Device: TP-Link TL-WR941ND V3.5, hardware REV: 1.2<br />USB2.0 works just fine. To get it working I made following:</p><p>1. Solder +5V circuit (see pic1)<br />2. Solder r1000/r1001 22 omhs resistors<br />3. Solder usb D+/D- pull-down lines at the bottom of pcb (15K)<br />4. Solder usb plug<br />5. Solder r96 4.7k resistor near main cpu (Atheros AR9132) - they call it USB_RREF<br />6. Solder r356 bridge (000) at p1 serial and connector<br />7. Builded and flashed Openwrt backfire from svn<br />8. Flashed u-boot provided by xiaochuan on china forum (it make some usb initialization)</p><p>Power circuit (2 x caps 470ufx16v, 8 x ceramic smd caps 0,1/0,01uf, 1 x LM78L05-TO-92, 1 x murrata choke, 6 x smd bridges): <br />I forgot to highlight one soldered bridge right at the 78l05 - it routes +9v to regulator input pin<br /><a href="http://www.radikal.ru"><span class="postimg"><img src="http://i019.radikal.ru/1101/5e/effa5ee8e3a3.jpg" alt="http://i019.radikal.ru/1101/5e/effa5ee8e3a3.jpg" /></span></a></p><p>Pull-down resistors (I made one of these using 10k + 4k + 1k):<br /><a href="http://www.radikal.ru"><span class="postimg"><img src="http://i012.radikal.ru/1101/0e/d116079cd252.jpg" alt="http://i012.radikal.ru/1101/0e/d116079cd252.jpg" /></span></a></p><p>USB_RREF r96 resistor:<br /><a href="http://www.radikal.ru"><span class="postimg"><img src="http://s009.radikal.ru/i308/1101/07/d46ce0ded22c.jpg" alt="http://s009.radikal.ru/i308/1101/07/d46ce0ded22c.jpg" /></span></a></p><p>USB plug (for flashdrive):<br /><a href="http://www.radikal.ru"><span class="postimg"><img src="http://s013.radikal.ru/i325/1101/d9/aaf0ca8401d3.jpg" alt="http://s013.radikal.ru/i325/1101/d9/aaf0ca8401d3.jpg" /></span></a></p><p>Flashing u-boot:<br />Link: <a href="http://www.home-wifi.com/bbs/thread-3454-1-1.html">http://www.home-wifi.com/bbs/thread-3454-1-1.html</a></p><p>0. Download patched u-boot and tftp server<br />1. Connect serial cable &amp; power on device<br />2. Enter u-boot (tp) (ar7100&gt; should appear)<br />3. Set 192.168.1.2 ip on your computer <br />4. Start tftp and put into its directory u-boot-ok.bin<br />5. At device u-boot prompt type:</p><p><strong>ar7100&gt; tftp 0x80800000 u-boot-ok.bin</strong><br />set link to 100M full by lqm.<br />Using eth0 device<br />TFTP from server 10.10.104.8; our IP address is 10.10.104.220<br />Filename &#039;u-boot-ok.bin&#039;.<br />Load address: 0x80800000<br />Loading: ##########################<br />done<br />Bytes transferred = 131072 (20000 hex)<br /><strong>ar7100&gt; erase 0xbf000000 +0x20000</strong></p><p>First 0x0 last 0x1 sector size 0x10000<br />&nbsp; &nbsp;1<br />Erased 2 sectors<br /><strong>ar7100&gt; cp.b 0x80800000 0xbf000000 0x20000</strong><br />Copy to Flash... write addr: bf000000<br />done<br /><strong>ar7100&gt; reset</strong></p><p><strong>!!Please make sure u-boot-ok.bin downloaded ok before erase &amp; cp commands!!</strong></p><p>usb 1-1: new high speed USB device using ar71xx-ehci and address 2<br />usb 1-1: configuration #1 chosen from 1 choice<br />scsi0 : SCSI emulation for USB Mass Storage devices<br />scsi 0:0:0:0: Direct-Access&nbsp; &nbsp; &nbsp;JetFlash TS4GJFV20&nbsp; &nbsp; &nbsp; &nbsp; 8.07 PQ: 0 ANSI: 2<br />sd 0:0:0:0: [sda] 8011776 512-byte logical blocks: (4.10 GB/3.82 GiB)<br />sd 0:0:0:0: [sda] Write Protect is off<br />sd 0:0:0:0: [sda] Assuming drive cache: write through<br />sd 0:0:0:0: [sda] Assuming drive cache: write through<br /> sda: sda1<br />sd 0:0:0:0: [sda] Assuming drive cache: write through<br />sd 0:0:0:0: [sda] Attached SCSI removable disk</p><p>P.S. I downloaded tp-link GPL source code for wr941nd and wr1043n to compare u-boot code. And found this function called during wr1043n startup:</p><p>void ar7100_usb_initial_config(void)<br />{<br />&nbsp; &nbsp; ar7100_reg_wr_nf(AR7100_USB_PLL_CONFIG, 0x00001030);<br />}</p><p>Is is possible to add this code to Openwrt ?</p>											<p class="post-edited">(Last edited by <strong>regressor</strong> on 7 Jan 2011, 04:30)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125684">
				<div class="post-metadata">
					<div class="post-num">Post #156</div>
					<div class="post-author">Sr2004</div>
					<div class="post-datetime">
						17 Jan 2011, 03:23					</div>
				</div>
				<div class="post-content content">
					<p>Friends, I have my WR941ND dead for more than 6 months, I do not remember as I install openwrt, just remember that you install and look me 2 months to install the web application, in the end it started by web, and upon review terminal in the WIFI did not recognize me, I only recognize the eth, is now dead, and would revive the original firmware or a openwrt or dd-wrt to use operating usb, some help dear friends</p><p> PD: I understand electronics, computer, because my work is repairing mobile phones, and the tools I have RS232, COM1 or more on FTDI</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125708">
				<div class="post-metadata">
					<div class="post-num">Post #157</div>
					<div class="post-author">Philth</div>
					<div class="post-datetime">
						17 Jan 2011, 14:07					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Sr2004 wrote:</cite><blockquote><p>, is now dead,</p></blockquote></div><p>How dead? Lights? Console? Please define dead.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p125756">
				<div class="post-metadata">
					<div class="post-num">Post #158</div>
					<div class="post-author">Sr2004</div>
					<div class="post-datetime">
						17 Jan 2011, 23:29					</div>
				</div>
				<div class="post-content content">
					<p>it comprises, boat, I can log on, but I can not activate or install the Web option, and I have the option of wifi, I do not recognize it, I just want to return to their original version and not as it could for uboot, some help</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p126787">
				<div class="post-metadata">
					<div class="post-num">Post #159</div>
					<div class="post-author">hsys</div>
					<div class="post-datetime">
						29 Jan 2011, 14:41					</div>
				</div>
				<div class="post-content content">
					<p>hi, i have just got a new wr941nd v5 (rev 1.1), and the PCB looks different from the one in wiki. i need a serial console but i cannot even find where P1 is. i took a photo of the board.<br /><span class="postimg"><img src="http://file.lifetoy.org/tl-wr941n-v5.jpg" alt="http://file.lifetoy.org/tl-wr941n-v5.jpg" /></span><br />could anyone help me to identify the serial pins? much thanks in advance <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p127087">
				<div class="post-metadata">
					<div class="post-num">Post #160</div>
					<div class="post-author">kotofei</div>
					<div class="post-datetime">
						1 Feb 2011, 21:18					</div>
				</div>
				<div class="post-content content">
					<p>TL-WR941ND v4<br />I`ve succesfully flash gargoyle 1.3.9 on them and it seems all works fine but i got 1 minor problem: there is no 300Mbit connection (as it have been on factory firmware). All my wi-fi/n clients told @130Mbit and signal strenght less than on factory fw at 3-5m distance. I know that there is command line solution (via ssh) but i can`t remember where i`ve found it last time <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" />&nbsp; If there is no solution for now, how i can revert to factory fw?</p><p>Is there any other &quot;ready to flash&quot; *.bin image file with web user interface? Have heard about x-wrt, tomato, dd-wrt but have no idea which better or have more features &quot;out of the box&quot;.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p128160">
				<div class="post-metadata">
					<div class="post-num">Post #161</div>
					<div class="post-author">regressor</div>
					<div class="post-datetime">
						13 Feb 2011, 03:05					</div>
				</div>
				<div class="post-content content">
					<p>Ok. There is no need to flash boot rom to get usb working... Here is the list of changes (add_device_usb shuld be done before network initialization or you got network speed &amp; stability problems):</p><p>1. Edit file target/linux/ar71xx/files/arch/mips/ar71xx/mach-tl-wr941nd.c<br />&nbsp; &nbsp; Add line <span style="color: blue">#include &quot;dev-usb.h&quot;</span> after line <span style="color: blue">#include &quot;dev-leds-gpio.h&quot;</span><br />&nbsp; &nbsp; Add line <span style="color: blue">ar71xx_add_device_usb();</span> before line <span style="color: blue">ar71xx_add_device_mdio(0x0);</span><br />3. Edit file target/linux/ar71xx/files/arch/mips/ar71xx/setup.c<br />&nbsp; &nbsp;Add line <span style="color: blue">ar71xx_pll_wr(0x08, 0x00001030);</span> before line <span style="color: blue">ar71xx_detect_mem_size();</span></p>											<p class="post-edited">(Last edited by <strong>regressor</strong> on 26 Feb 2011, 13:15)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p130295">
				<div class="post-metadata">
					<div class="post-num">Post #162</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						9 Mar 2011, 23:29					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>hsys wrote:</cite><blockquote><p>hi, i have just got a new wr941nd v5 (rev 1.1), and the PCB looks different from the one in wiki. i need a serial console but i cannot even find where P1 is.</p></blockquote></div><p>Can&#039;t help you but in case you brick it...</p><p><a href="https://forum.openwrt.org/viewtopic.php?pid=128790#p128790">OpenWrt / Report from failed attempt with TL-WR1043ND</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p132571">
				<div class="post-metadata">
					<div class="post-num">Post #163</div>
					<div class="post-author">RoundSparrow</div>
					<div class="post-datetime">
						9 Apr 2011, 15:47					</div>
				</div>
				<div class="post-content content">
					<p>Hello, long time no visit. I have a TP-Link TL-WR940N which has fixed (hard cabled) antennas. I purchased mine in Jordan. These are reported to be similar to the 941N except on antenna connection.&nbsp; </p><p>Inside... mine says &quot;Model TL-WR940N Ver.1.2&quot; on the yellow LAN ports. PCB says &quot;11N Wireless Router-8 (AR) A&quot; / &quot;REV:1.0&nbsp; 20008 GFM01&quot;.&nbsp; &nbsp;it is similar to the photo of the 941 v5 posted here but&nbsp; the printed PCB version info is near the LEDs instead of near the power connector.&nbsp; Also note this WR940N has USB port connectors, the newer 941N V5 seems to lack that? ((Photo posted on next message)).&nbsp; The default firmware had this message on the opening page:</p><p>Firmware Version: 3.11.3 Build 100408 Rel.42303n<br />Hardware Version: WR940N v1/WR941N v4 00000000</p><p>Mine does not have the problem Intel flash chip that seems to be giving the dd-wrt users troubles in the past.&nbsp; I flashed it with the 941ND&#039;s &quot;DD-WRT v24-sp2 (11/21/10) std - build 15778&quot; without problem.... I don&#039;t have my OpenWrt build environment handy at the moment.</p><p>keywordz: v1.2 version 1.2 WR940N WR940ND 940 940N 940ND TL TL940ND TL940N TLWR940N TLWR940ND Atheros 3T3R 2.4GHz 802.11n/g/b, Built-in 4-port Switch ath9k wifi 80211n 300Mbps</p>											<p class="post-edited">(Last edited by <strong>RoundSparrow</strong> on 10 Apr 2011, 09:15)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p132575">
				<div class="post-metadata">
					<div class="post-num">Post #164</div>
					<div class="post-author">RoundSparrow</div>
					<div class="post-datetime">
						9 Apr 2011, 16:17					</div>
				</div>
				<div class="post-content content">
					<p>Picture of the 940N Version 1.2: <span class="postimg"><img src="http://sites.google.com/site/stephengutknecht/Home/TPLink_940N_ver1_2_phto2.jpg" alt="http://sites.google.com/site/stephengutknecht/Home/TPLink_940N_ver1_2_phto2.jpg" /></span></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p134541">
				<div class="post-metadata">
					<div class="post-num">Post #165</div>
					<div class="post-author">Windy</div>
					<div class="post-datetime">
						3 May 2011, 13:31					</div>
				</div>
				<div class="post-content content">
					<p>Hi all,</p><p>regressor: THX your description about USB initialisation in the kernel, it works great.<br />But I would like to write it to the u-boot, so I dont need to build kernel, if I want to change.<br />Could you, or someone tell me, how I can write the initialisation to the u-boot?<br />I have the same rev than you (ver 3.5, rev 1.2), but the link (http://www.home-wifi.com/bbs/thread-3454-1-1.html<br />) cannot work.<br />The serial connection works, I can edit the env. vars, but I cannot save them (saveenv dont works), so when the router reboots, its resets to def. (The uboot-envtools<br />also don&#039;t works)</p><p>BTW: you dont need the +5V, some pendrive works great with 3.3 V. (Really the pendrives need 3.3V or less, but they need to reduce the USB&#039;s 5V, so that if it works or not with 3.3 V is depends on the reduce method. I use an FC8308-1 IC based pendrive, and it works great.)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p135465">
				<div class="post-metadata">
					<div class="post-num">Post #166</div>
					<div class="post-author">Sr2004</div>
					<div class="post-datetime">
						17 May 2011, 21:58					</div>
				</div>
				<div class="post-content content">
					<p>hello. I have a WR941ND ver 2.0, and the brick, try to repair it because the wifi did not recognize me now that I have launched wish I could relive it, someone would help me in this feat, please ... I leave my mail for communication, rodrigo13_23@yahoo.es</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p137653">
				<div class="post-metadata">
					<div class="post-num">Post #167</div>
					<div class="post-author">sz_j1991</div>
					<div class="post-datetime">
						22 Jun 2011, 13:50					</div>
				</div>
				<div class="post-content content">
					<p>Hello everyone,<br />I have WR841 Router, and meanwhile I updating the firmware the electricity got cut off and then when I accessed the RS232 with the cable it booted, I tried to write a flash on the address of the firmware but ever since it didn’t boot and I bought a WR1043 instead and I tried to write a firmware on the WR841 flash but I don’t know exactly its address, and this is what I got:<br />erase 0xbf020000 +7c0000<br />tftpboot 0x81000000 code.bin<br />cp.b 0x81000000 0xbf020000 0x7c0000<br />So I thought of doing this, while it was working or on function, I dispatched the flash for the WR1043 and I’ve installed it on the WR841, I managed to write the WR841 and the file on the flash (wr841n_en_3_4_5_up_boot(090226) but it doesn’t boot because I wrote it on the wrong address, the file includes the boot sector (U-BOOT 1.1.4 feb 6 2009). So on what kind of address do I have to write it, can anyone help me out?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p138327">
				<div class="post-metadata">
					<div class="post-num">Post #168</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						1 Jul 2011, 21:38					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>sz_j1991 wrote:</cite><blockquote><p>I managed to write the WR841 and the file on the flash (wr841n_en_3_4_5_up_boot(090226) but it doesn’t boot because I wrote it on the wrong address</p></blockquote></div><p>Question not the address but the stock firmware. File name with &quot;boot&quot; contains the U-Boot bootloader which you don&#039;t need.<br /></p><div class="codebox"><pre><code>dd if=wr841n_en_3_4_5_up_boot(090226).bin of=wr841n_en_3_4_5_up(090226).bin skip=257 bs=512</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p138422">
				<div class="post-metadata">
					<div class="post-num">Post #169</div>
					<div class="post-author">sz_j1991</div>
					<div class="post-datetime">
						4 Jul 2011, 16:42					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>fyi wrote:</cite><blockquote><div class="quotebox"><cite>sz_j1991 wrote:</cite><blockquote><p>I managed to write the WR841 and the file on the flash (wr841n_en_3_4_5_up_boot(090226) but it doesn’t boot because I wrote it on the wrong address</p></blockquote></div><p>Question not the address but the stock firmware. File name with &quot;boot&quot; contains the U-Boot bootloader which you don&#039;t need.<br /></p><div class="codebox"><pre><code>dd if=wr841n_en_3_4_5_up_boot(090226).bin of=wr841n_en_3_4_5_up(090226).bin skip=257 bs=512</code></pre></div></blockquote></div><p>Now the problem is this: <a href="http://www.szj1991.co.nr/wr841.html">http://www.szj1991.co.nr/wr841.html</a></p><p>&quot; ath_ahb: No devices found, driver not installed.&quot;</p><p>&nbsp; &nbsp; Wireless radio part not working. <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p138436">
				<div class="post-metadata">
					<div class="post-num">Post #170</div>
					<div class="post-author">MBS</div>
					<div class="post-datetime">
						4 Jul 2011, 21:12					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;d guess your art-partition doesn&#039;t contain valid data. u-boot is also complaining (Net: ag7100_enet_initialize...<br />No valid address in Flash. Using fixed address<br />).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p138439">
				<div class="post-metadata">
					<div class="post-num">Post #171</div>
					<div class="post-author">sz_j1991</div>
					<div class="post-datetime">
						4 Jul 2011, 22:42					</div>
				</div>
				<div class="post-content content">
					<p>How to repair this? Now the wr841 v3 is in stil runing but the wireless is not working <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" />(</p>											<p class="post-edited">(Last edited by <strong>sz_j1991</strong> on 4 Jul 2011, 22:46)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p138461">
				<div class="post-metadata">
					<div class="post-num">Post #172</div>
					<div class="post-author">MBS</div>
					<div class="post-datetime">
						5 Jul 2011, 11:29					</div>
				</div>
				<div class="post-content content">
					<p>get someone to dump their art-partition, change the mac with a hex-editor to your values (mentioned in wr1043nd wiki) and flash it in using u-boot.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p143526">
				<div class="post-metadata">
					<div class="post-num">Post #173</div>
					<div class="post-author">dDaYb</div>
					<div class="post-datetime">
						13 Sep 2011, 14:23					</div>
				</div>
				<div class="post-content content">
					<p>Hello,<br />I&#039;ve just bough v 3.6, is it considered v.4 as per wiki (<a href="http://wiki.openwrt.org/toh/tp-link/tl-wr941nd">http://wiki.openwrt.org/toh/tp-link/tl-wr941nd</a>)?<br />should I flash AR7240 image there?<br />many thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p143553">
				<div class="post-metadata">
					<div class="post-num">Post #174</div>
					<div class="post-author">MBS</div>
					<div class="post-datetime">
						13 Sep 2011, 20:06					</div>
				</div>
				<div class="post-content content">
					<p><a href="http://www.tplink.com/en/article/?articleid=46">http://www.tplink.com/en/article/?articleid=46</a><br />I would guess it is more likely a v3. But better compare your firmware version with the ones they offer for download.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p143556">
				<div class="post-metadata">
					<div class="post-num">Post #175</div>
					<div class="post-author">dDaYb</div>
					<div class="post-datetime">
						13 Sep 2011, 20:15					</div>
				</div>
				<div class="post-content content">
					<p>thanks, v3, worked fine... untill I installed another package and it was said no more space was available...<br />Now I am trying to connect to its serial interface, could you please help me with that pad that should be bridged. v. 3.6 is a bit different:<br /><a href="https://picasaweb.google.com/105470531537498048787/Total_share#5653762155549293954">https://picasaweb.google.com/1054705315 … 5549293954</a><br /><a href="https://picasaweb.google.com/105470531537498048787/Total_share#5653762177487021426">https://picasaweb.google.com/1054705315 … 7487021426</a><br />is it still R356?</p>											<p class="post-edited">(Last edited by <strong>dDaYb</strong> on 19 Sep 2011, 06:57)</p>
									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 7 of 8</div><nav><ul><li><a href="viewtopic.php%3Fid=18354&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=18354&amp;p=5.html">5</a></li><li><a href="viewtopic.php%3Fid=18354&amp;p=6.html">6</a></li><li class="pagination-current"><span>7</span></li><li><a href="viewtopic.php%3Fid=18354&amp;p=8.html">8</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0.001 -->

</body>
</html>