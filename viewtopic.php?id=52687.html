<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Problems with ipv6 in LAN / barrier breaker rc3</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 6 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p246809">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">awerthmann</div>
					<div class="post-datetime">
						12 Sep 2014, 03:54					</div>
				</div>
				<div class="post-content content">
					<p>I have a WR1043N/ND v1 with barrier breaker rc3.</p><p>My isp (cable) provides ipv6 / ipv4 dual stack. The openwrt router is connected to the cable modem.</p><p>On the router i can successfully ping6 <a href="http://www.google.com">www.google.com</a>.</p><p>On my LAN PC I can NOT ping -6 <a href="http://www.google.com">www.google.com</a> (timeout). On the router I can see an echo request but no echo reply.</p><p>I have no IPv6 connectivity on LAN PCs, only on the router itself. Please help me..</p><p>Wireshark on the LAN PC tells me if I want to ping -6:</p><div class="codebox"><pre><code>20    2.877646000    2a02:2450:1032:2:484e:389e:158e:6c20    2a00:1450:4008:801::1018    ICMPv6    94    Echo (ping) request id=0x0001, seq=84, hop limit=128 (no response found!)</code></pre></div><br /><p>ifstatus wan6:</p><div class="codebox"><pre><code>{
        &quot;up&quot;: true,
        &quot;pending&quot;: false,
        &quot;available&quot;: true,
        &quot;autostart&quot;: true,
        &quot;uptime&quot;: 4690,
        &quot;l3_device&quot;: &quot;eth0.2&quot;,
        &quot;proto&quot;: &quot;dhcpv6&quot;,
        &quot;device&quot;: &quot;eth0.2&quot;,
        &quot;metric&quot;: 0,
        &quot;delegation&quot;: true,
        &quot;ipv4-address&quot;: [

        ],
        &quot;ipv6-address&quot;: [
                {
                        &quot;address&quot;: &quot;2a02:2450:3:2000:7dce:2039:7a23:9589&quot;,
                        &quot;mask&quot;: 128,
                        &quot;preferred&quot;: 600110,
                        &quot;valid&quot;: 1204910
                }
        ],
        &quot;ipv6-prefix&quot;: [
                {
                        &quot;address&quot;: &quot;2a02:2450:1032:2::&quot;,
                        &quot;mask&quot;: 64,
                        &quot;preferred&quot;: 600110,
                        &quot;valid&quot;: 1204910,
                        &quot;class&quot;: &quot;wan6&quot;,
                        &quot;assigned&quot;: {
                                &quot;lan&quot;: {
                                        &quot;address&quot;: &quot;2a02:2450:1032:2::&quot;,
                                        &quot;mask&quot;: 64
                                }
                        }
                }
        ],
        &quot;ipv6-prefix-assignment&quot;: [

        ],
        &quot;route&quot;: [
                {
                        &quot;target&quot;: &quot;::&quot;,
                        &quot;mask&quot;: 0,
                        &quot;nexthop&quot;: &quot;fe80::21b:8fff:feee:1ce2&quot;,
                        &quot;metric&quot;: 1024,
                        &quot;valid&quot;: 1762,
                        &quot;source&quot;: &quot;2a02:2450:1032:2::\/64&quot;
                },
                {
                        &quot;target&quot;: &quot;::&quot;,
                        &quot;mask&quot;: 0,
                        &quot;nexthop&quot;: &quot;fe80::21b:8fff:feee:1ce2&quot;,
                        &quot;metric&quot;: 1024,
                        &quot;valid&quot;: 1762,
                        &quot;source&quot;: &quot;::\/128&quot;
                },
                {
                        &quot;target&quot;: &quot;::&quot;,
                        &quot;mask&quot;: 0,
                        &quot;nexthop&quot;: &quot;fe80::21b:8fff:feee:1ce2&quot;,
                        &quot;metric&quot;: 1024,
                        &quot;valid&quot;: 1762,
                        &quot;source&quot;: &quot;2a02:2450:3:2000:7dce:2039:7a23:9589\/128&quot;
                }
        ],
        &quot;dns-server&quot;: [
                &quot;2a02:2450:dd3f:400f::10&quot;,
                &quot;2a02:2450:dd3f:400f::11&quot;
        ],
        &quot;dns-search&quot;: [

        ],
        &quot;inactive&quot;: {
                &quot;ipv4-address&quot;: [

                ],
                &quot;ipv6-address&quot;: [

                ],
                &quot;route&quot;: [

                ],
                &quot;dns-server&quot;: [

                ],
                &quot;dns-search&quot;: [

                ]
        },
        &quot;data&quot;: {
                &quot;passthru&quot;: &quot;001700202a022450dd3f400f00000000000000102a022450dd3f400f0000000000000011&quot;
        }
}</code></pre></div><br /><p>ifconfig:</p><div class="codebox"><pre><code>br-lan    Link encap:Ethernet  HWaddr A0:F3:C1:5B:60:E6
          inet addr:192.168.1.1  Bcast:192.168.1.255  Mask:255.255.255.0
          inet6 addr: 2a02:2450:1032:2::1/64 Scope:Global
          inet6 addr: fdc4:70db:28a1::1/60 Scope:Global
          inet6 addr: fe80::a2f3:c1ff:fe5b:60e6/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:25963 errors:0 dropped:0 overruns:0 frame:0
          TX packets:31613 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:3468375 (3.3 MiB)  TX bytes:20578138 (19.6 MiB)

eth0      Link encap:Ethernet  HWaddr A0:F3:C1:5B:60:E6
          inet6 addr: fe80::a2f3:c1ff:fe5b:60e6/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:53052 errors:0 dropped:5 overruns:3376 frame:0
          TX packets:49412 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:22788721 (21.7 MiB)  TX bytes:23485575 (22.3 MiB)
          Interrupt:4

eth0.1    Link encap:Ethernet  HWaddr A0:F3:C1:5B:60:E6
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:28403 errors:0 dropped:0 overruns:0 frame:0
          TX packets:30635 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:3950873 (3.7 MiB)  TX bytes:20348176 (19.4 MiB)

eth0.2    Link encap:Ethernet  HWaddr A0:F3:C1:5B:60:E6
          inet addr:86.56.22.10  Bcast:86.56.22.127  Mask:255.255.255.128
          inet6 addr: 2a02:2450:3:2000:7dce:2039:7a23:9589/128 Scope:Global
          inet6 addr: fe80::a2f3:c1ff:fe5b:60e6/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:24625 errors:0 dropped:0 overruns:0 frame:0
          TX packets:18771 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:17880497 (17.0 MiB)  TX bytes:2938242 (2.8 MiB)

lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:280 errors:0 dropped:0 overruns:0 frame:0
          TX packets:280 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:33176 (32.3 KiB)  TX bytes:33176 (32.3 KiB)

wlan0     Link encap:Ethernet  HWaddr A0:F3:C1:5B:60:E6
          inet6 addr: fe80::a2f3:c1ff:fe5b:60e6/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:1221 errors:0 dropped:0 overruns:0 frame:0
          TX packets:1341 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:153603 (150.0 KiB)  TX bytes:300359 (293.3 KiB)</code></pre></div><br /><p>/etc/config/network:</p><div class="codebox"><pre><code>config interface &#039;lan&#039;
        option ifname &#039;eth0.1&#039;
        option force_link &#039;1&#039;
        option type &#039;bridge&#039;
        option proto &#039;static&#039;
        option ipaddr &#039;192.168.1.1&#039;
        option netmask &#039;255.255.255.0&#039;
        option ip6assign &#039;60&#039;

config interface &#039;wan&#039;
        option ifname &#039;eth0.2&#039;
        option proto &#039;dhcp&#039;

config interface &#039;wan6&#039;
        option ifname &#039;@wan&#039;
        option proto &#039;dhcpv6&#039;</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p246848">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">CyrusFF</div>
					<div class="post-datetime">
						12 Sep 2014, 14:10					</div>
				</div>
				<div class="post-content content">
					<p>I don&#039;t see anything obviously wrong here on your side or OpenWrt&#039;s.</p><p>If you haven&#039;t (accidentally) modified or broken the IPv6 firewall setting of OpenWrt I suspect its a routing problem on your ISP&#039;s side for the prefix your clients get addresses from.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p246850">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">awerthmann</div>
					<div class="post-datetime">
						12 Sep 2014, 14:38					</div>
				</div>
				<div class="post-content content">
					<p>Thank you for your answer.</p><p>Yes that is strange. If I ping6 to <a href="http://www.google.com">www.google.com</a> on the OpenWrt Box I can see a echo request and echo reply (tcpdump).</p><p>When I ping -6 to <a href="http://www.google.com">www.google.com</a> from a (windows) lan client, I can see the echo request (IPv6 address from the prefix range as source) in tcpdump, but a echo reply never reaches the wan interface.</p><p>I other words this IPv6 connection is unusable if I want to use IPv6 on the lan machines ?<br />Is there anything I can do ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p246980">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">awerthmann</div>
					<div class="post-datetime">
						14 Sep 2014, 02:11					</div>
				</div>
				<div class="post-content content">
					<p>perhaps a problem on my side ?</p><p>ip -6 rule</p><div class="codebox"><pre><code>0:      from all lookup local
32766:  from all lookup main
4200000000:     from 2a02:2450:1032:2::1/64 iif br-lan unreachable
4200000001:     from all iif lo failed_policy
4200000004:     from all iif br-lan failed_policy
4200000006:     from all iif eth0.2 failed_policy
4200000006:     from all iif eth0.2 failed_policy</code></pre></div><br /><p>ip -6 route</p><div class="codebox"><pre><code>default from :: via fe80::21b:8fff:feee:1ce2 dev eth0.2  proto static  metric 1024
default from 2a02:2450:3:2000:ccb6:dfa3:eb1d:5fc6 via fe80::21b:8fff:feee:1ce2 dev eth0.2  proto static  metric 1024
default from 2a02:2450:1032:2::/64 via fe80::21b:8fff:feee:1ce2 dev eth0.2  proto static  metric 1024
2a02:2450:1032:2::/64 dev br-lan  proto kernel  metric 256  expires 1159108sec
unreachable 2a02:2450:1032:2::/64 dev lo  proto static  metric 2147483647  error -128
fda7:376d:6946::/60 dev br-lan  proto kernel  metric 256
unreachable fda7:376d:6946::/48 dev lo  proto static  metric 2147483647  error -128
fe80::/64 dev eth0  proto kernel  metric 256
fe80::/64 dev br-lan  proto kernel  metric 256
fe80::/64 dev eth0.2  proto kernel  metric 256</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p247348">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">awerthmann</div>
					<div class="post-datetime">
						18 Sep 2014, 01:46					</div>
				</div>
				<div class="post-content content">
					<p>ping6 2a02:2450:dd3f:400f::10 (my ISP DNS server) on the OpenWrt box:</p><p>tcpdump -i eth0.2 ip6 on the OpenWrt box gives me:<br /></p><div class="codebox"><pre><code>22:30:25.715054 IP6 2a02:2450:3:2800:30c8:8a52:fd92:4d3b &gt; ha-ns1-cust.ip-platform.net: ICMP6, echo request, seq 0, length 64
22:30:25.725301 IP6 ha-ns1-cust.ip-platform.net &gt; 2a02:2450:3:2800:30c8:8a52:fd92:4d3b: ICMP6, echo reply, seq 0, length 64
22:30:26.715559 IP6 2a02:2450:3:2800:30c8:8a52:fd92:4d3b &gt; ha-ns1-cust.ip-platform.net: ICMP6, echo request, seq 1, length 64
22:30:26.725618 IP6 ha-ns1-cust.ip-platform.net &gt; 2a02:2450:3:2800:30c8:8a52:fd92:4d3b: ICMP6, echo reply, seq 1, length 64</code></pre></div><p>-&gt; everything seems fine</p><p>.. now on a lan client</p><p>ping -6 2a02:2450:dd3f:400f::10 (my ISP DNS server) on a windows lan pc</p><p>tcpdump -i eth0.2 ip6 on the OpenWrt box gives me:<br /></p><div class="codebox"><pre><code>22:34:16.615741 IP6 2a02:2450:1032:8000:e195:21bc:c193:9cae &gt; ha-ns1-cust.ip-platform.net: ICMP6, echo request, seq 66, length 40
22:34:21.593709 IP6 2a02:2450:1032:8000:e195:21bc:c193:9cae &gt; ha-ns1-cust.ip-platform.net: ICMP6, echo request, seq 67, length 40
22:34:26.594108 IP6 2a02:2450:1032:8000:e195:21bc:c193:9cae &gt; ha-ns1-cust.ip-platform.net: ICMP6, echo request, seq 68, length 40</code></pre></div><p>-&gt; there is no reply, but why ?</p><br /><p>now a tracert -6 2a02:2450:dd3f:400f::10 on a windows lan client:</p><div class="codebox"><pre><code>(ha-ns1-cust.ip-platform.net [2a02:2450:dd3f:400f::10] max. 30 hops)

  1    &lt;1 ms    &lt;1 ms    &lt;1 ms  2a02:2450:1032:8000::1
  2    11 ms    11 ms     7 ms  2a02:2450:3:2000::1
  3     *        *        *</code></pre></div><p>and here is the tcpdump output on the OpenWrt Box while tracert:<br /></p><div class="codebox"><pre><code>22:42:27.086767 IP6 2a02:2450:1032:8000:e195:21bc:c193:9cae &gt; ha-ns1-cust.ip-platform.net: ICMP6, echo request, seq 90, length 72
22:42:27.096408 IP6 2a02:2450:3:2000::1 &gt; 2a02:2450:1032:8000:e195:21bc:c193:9cae: ICMP6, time exceeded in-transit for ha-ns1-cust.ip-platform.net, length 120
22:42:27.097435 IP6 2a02:2450:1032:8000:e195:21bc:c193:9cae &gt; ha-ns1-cust.ip-platform.net: ICMP6, echo request, seq 91, length 72
22:42:27.108410 IP6 2a02:2450:3:2000::1 &gt; 2a02:2450:1032:8000:e195:21bc:c193:9cae: ICMP6, time exceeded in-transit for ha-ns1-cust.ip-platform.net, length 120
22:42:27.109949 IP6 2a02:2450:1032:8000:e195:21bc:c193:9cae &gt; ha-ns1-cust.ip-platform.net: ICMP6, echo request, seq 92, length 72
22:42:27.120411 IP6 2a02:2450:3:2000::1 &gt; 2a02:2450:1032:8000:e195:21bc:c193:9cae: ICMP6, time exceeded in-transit for ha-ns1-cust.ip-platform.net, length 120
22:42:28.111798 IP6 2a02:2450:1032:8000:e195:21bc:c193:9cae &gt; ha-ns1-cust.ip-platform.net: ICMP6, echo request, seq 93, length 72</code></pre></div><br /><p>Any idea what is wrong ? The ISP says with their router IPv6 would work, but how they do it ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p249677">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">awerthmann</div>
					<div class="post-datetime">
						8 Oct 2014, 09:39					</div>
				</div>
				<div class="post-content content">
					<p>Ok, my ISP is driving me crazy.. I have sent them a detailed error report and they always tell me it is my fault, I haven&#039;t<br />configured my computers correctly... <img src="https://forum.openwrt.org/img/smilies/mad.png" width="15" height="15" alt="mad" /> <img src="https://forum.openwrt.org/img/smilies/mad.png" width="15" height="15" alt="mad" /> <img src="https://forum.openwrt.org/img/smilies/mad.png" width="15" height="15" alt="mad" /></p><p>never ever go to ISP Telecolumbus in Germany !!</p><p>----</p><p>traceroute6 <a href="http://www.google.com">www.google.com</a> (on the openwrt box):</p><div class="codebox"><pre><code>traceroute to www.google.com (2a00:1450:4008:800::1010) from 2a02:2450:3:2800:7d44:9904:960:d58c, 30 hops max, 16 byte packets
 1  2a02:2450:3:2000::1 (2a02:2450:3:2000::1)  6.751 ms  9.437 ms  16.636 ms
 2  2a02:2450:c800:3001::1 (2a02:2450:c800:3001::1)  10.165 ms  9.656 ms  7.842 ms
 3  2a02:2450:c8b0:7::2 (2a02:2450:c8b0:7::2)  8.947 ms  13.575 ms  12.335 ms
 4  2a02:2450:c8d0:1003::2 (2a02:2450:c8d0:1003::2)  11.634 ms  14.215 ms  16.605 ms
 5  2a02:2450:c8d0:f002::2 (2a02:2450:c8d0:f002::2)  15.003 ms  13.28 ms  13.182 ms
 6  2001:7f8:19:1::3b41:1 (2001:7f8:19:1::3b41:1)  11.857 ms  12.215 ms  12.775 ms
 7  2001:4860::1:0:6e0f (2001:4860::1:0:6e0f)  12.671 ms  12.928 ms  17.02 ms
 8  2001:4860:0:1::4b (2001:4860:0:1::4b)  11.166 ms  24.488 ms  9.258 ms
 9  2a00:1450:4008:800:: (2a00:1450:4008:800::)  10.879 ms  10.283 ms  15.724 ms</code></pre></div><p>tracert -6 <a href="http://www.google.com">www.google.com</a> (on a windows7 lan pc)</p><div class="codebox"><pre><code>Routenverfolgung zu www.google.com [2a00:1450:4008:800::1010] über maximal 30 Ab
schnitte:

  1    &lt;1 ms    &lt;1 ms    &lt;1 ms  2a02:2450:1032:8001::1
  2    10 ms     8 ms     7 ms  2a02:2450:3:2000::1
  3     *        *        *     Zeitüberschreitung der Anforderung.
  4     *        *        *     Zeitüberschreitung der Anforderung.
  5     *        *
(only timeouts from here)</code></pre></div><p>Is there any change for a valid working ipv6 on my clients ? bridging etc ? my isp is soo stupid..</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>