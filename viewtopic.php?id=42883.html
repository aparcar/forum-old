<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> TP-LINK WR841N set-up help</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 29 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p194869">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">crystalcastle</div>
					<div class="post-datetime">
						14 Mar 2013, 16:14					</div>
				</div>
				<div class="post-content content">
					<p>I am having issues with setting up my TP-LINK TL-WR841N flashed to OpenWrt. I have several more routers like this at home, which usually work with DD-WRT, however, the version that I received is v8, and as of writing this, v8 is not supported. </p><p>After flashing to OpenWrt, I tried to configure it so that it works like a switch and a Wifi AP. However, as soon as I plug it into my network, it kills it: everything times out. I can&#039;t connect to the internet, and sometimes I can&#039;t even connect to local network devices. I already reset it to defaults once, but that didn&#039;t help. Could someone please tell me what I am doing wrong? I suspect DHCP has something to do with it. My DHCP server is the ISP&#039;s modem, which is at 192.168.1.1. The network then goes through a DD-WRT router which acts like a switch and AP, switching all of the network for my house. Next there are cables going to devices, one going to another DD-WRT router, and then this one that goes to the new TP-LINK router. All the other routers work flawlessly.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p194890">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						14 Mar 2013, 17:59					</div>
				</div>
				<div class="post-content content">
					<p>OpenWrt has the same IP range as your existing network, you need to change it before attaching it to your network.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p194914">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">hojuruku</div>
					<div class="post-datetime">
						15 Mar 2013, 03:03					</div>
				</div>
				<div class="post-content content">
					<p>I have a 941nd has a strange switch chip. Check if yours is the same. If you make the mistake of adding eth0 to a bridge you will have game over scenario. In wireshark you will see duplicate transmits and some with invalid ethernet frame type status. Fix is by serial cable or failsafe mode. The latter did not work for me hence I had to turn a nokia dku-5 into a serial cable. Yours is same switch if you see lan1-4 and wan interfaces. Also could be arp conflict on pc. Isolate isp router from your pc and openwrt, then type arp -d * to flush arp cache or just reboot windoze pc.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p196559">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">crystalcastle</div>
					<div class="post-datetime">
						29 Mar 2013, 01:32					</div>
				</div>
				<div class="post-content content">
					<p>Ok, WiFi works now, however as soon as I plug in something over ethernet (DHCP device), the WiFi also stops working. Then I have to restart the router to get it working again.</p>											<p class="post-edited">(Last edited by <strong>crystalcastle</strong> on 29 Mar 2013, 02:29)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p196630">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">nozombian</div>
					<div class="post-datetime">
						29 Mar 2013, 16:49					</div>
				</div>
				<div class="post-content content">
					<p>1. change wr841nd ip in /etc/config/network to something like 192.168.1.254 (that&#039;s what jow said)<br />2. disable dhcp and firewall, bridge eth0 and eth1 - google &quot;dumb ap&quot; recipe</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p196638">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">crystalcastle</div>
					<div class="post-datetime">
						29 Mar 2013, 19:32					</div>
				</div>
				<div class="post-content content">
					<p>Yeah just tried that, but it still doesn&#039;t work. Now I can&#039;t connect over WiFi.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p196639">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						29 Mar 2013, 20:26					</div>
				</div>
				<div class="post-content content">
					<p>192.168.1.254 is still in the same subnet. Imeant something like 192.168.<strong>2</strong>.1</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p196646">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">nozombian</div>
					<div class="post-datetime">
						29 Mar 2013, 22:20					</div>
				</div>
				<div class="post-content content">
					<p>Yes, the same network, configured as a bridge, with turned nat off (that&#039;s what dumb ap describes). It is useless to NAT a NATed NAT at home.</p><p>crystalcastle: could you post your /etc/config/network and wireless ?</p><p>I have wr841nd v8 too configured as dumb ap and it works, except I had trouble with bridging of the wan port to lan. What on wr741nd and wr1043nd works just fine, on wr841nd wasn&#039;t working, but I had no time to find out why, I needed only 2 lan ports.</p>											<p class="post-edited">(Last edited by <strong>nozombian</strong> on 29 Mar 2013, 22:20)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p196653">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">crystalcastle</div>
					<div class="post-datetime">
						30 Mar 2013, 02:46					</div>
				</div>
				<div class="post-content content">
					<p>I followed <a href="http://wiki.openwrt.org/doc/recipes/dumbap">this guide</a> on how to make it a dumb AP, combined it with the 192.168.2.1 IP also. This is what I have in the config and wireless files:<br /></p><div class="codebox"><pre><code>/etc/config/network
config interface &#039;loopback&#039;
        option ifname &#039;lo&#039;
        option proto &#039;static&#039;
        option ipaddr &#039;127.0.0.1&#039;
        option netmask &#039;255.0.0.0&#039;

config interface &#039;lan&#039;
        option ifname &#039;eth0.1 eth1&#039;
        option type &#039;bridge&#039;
        option proto &#039;static&#039;
        option ipaddr &#039;192.168.2.1&#039;
        option netmask &#039;255.255.255.0&#039;

config interface &#039;wan&#039;
        option ifname &#039;eth0&#039;
        option proto &#039;dhcp&#039;

config switch
        option name &#039;switch0&#039;
        option reset &#039;1&#039;
        option enable_vlan &#039;1&#039;

config switch_vlan
        option device &#039;switch0&#039;
        option vlan &#039;1&#039;
        option ports &#039;0 1 2 3 4&#039;



/etc/config/wireless
config interface &#039;loopback&#039;
config wifi-device  radio0
        option type     mac80211
        option channel  11
        option macaddr  64:70:02:f7:04:0c
        option hwmode   11ng
        option htmode   HT20
        list ht_capab   LDPC
        list ht_capab   SHORT-GI-20
        list ht_capab   SHORT-GI-40
        list ht_capab   TX-STBC
        list ht_capab   RX-STBC1
        list ht_capab   DSSS_CCK-40
        # REMOVE THIS LINE TO ENABLE WIFI:
        option disabled 1

config wifi-iface
        option device   radio0
        option network  lan
        option mode     ap
        option ssid     APName 
        option encryption psk2
        option key      my-wifi-key </code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p196742">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">nozombian</div>
					<div class="post-datetime">
						31 Mar 2013, 04:01					</div>
				</div>
				<div class="post-content content">
					<p>If you have it in dumb ap mode, you can set the ip to some unused IP in your network range to have the access to the router without changing your computer ip <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>You have one part wrong, wr841nd uses eth0 and eth1, not eth0.1 I think, so you should have something like<br /></p><div class="codebox"><pre><code>.
.
config interface &#039;lan&#039;
        option ifname &#039;eth0 eth1&#039;
.
.</code></pre></div>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>