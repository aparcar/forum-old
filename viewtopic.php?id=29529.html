<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Flashing openwrt trunk image on Fritz!Box 7140</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 30 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p132969">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Dominor</div>
					<div class="post-datetime">
						14 Apr 2011, 04:13					</div>
				</div>
				<div class="post-content content">
					<p>Hello!<br />From what I&#039;ve read in the OpenWRT documentation, AVM Fritz!Box 7170 is supported with the latest trunk. However, no flashing or installations instructions are provided in the wiki.<br />Still, I tried to install/flash a self-compiled image to the AVM Fritz!Box 7140. Although it is not listed as supported, it is practically identical in hardware to the 7170.<br />My question is how to install or flash the image into the router. While searching through Google, I came across with this page <a href="http://deve.loping.net/files/FRITZ-WRT-HOWTO.html">http://deve.loping.net/files/FRITZ-WRT-HOWTO.html</a>, which tells me to use the fritz-flash perl script (<a href="http://deve.loping.net/files/fritz-flash">http://deve.loping.net/files/fritz-flash</a>).<br />The script successfully ftps and uploads the image into router, but the subsequent checksumming of the image fails and upon rebooting the router is bricked, though ready to be flashed in the first 20 seconds.<br />I am not sure if this is the correct procedure to flash the openwrt image, especially considering the script doesn&#039;t seem to be up-to-date.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p132990">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Orca</div>
					<div class="post-datetime">
						14 Apr 2011, 12:16					</div>
				</div>
				<div class="post-content content">
					<p>Whoever is going to help you with this, PLEASE UPDATE THE WIKI.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p200988">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Dominor</div>
					<div class="post-datetime">
						7 May 2013, 04:07					</div>
				</div>
				<div class="post-content content">
					<p>Greetings, fellow users of Openwrt!<br />I&#039;m here again trying to flash Openwrt to the Fritzbox 7140. I haven&#039;t used it for quite a long time. Now I intend to use it as an IPTV + ADSL2+ router/modem, possibly with the router part being performed by a new router I recently purchased: the TP-LINK TL-WDR3600. For this purpose, I need to use a modified firmware in the Fritzbox. I can either use Freetz or Openwrt. Freetz is certainly more compatible with the router and I can install with it the minimally necessary packages like igmpproxy, iptables, br2684ctl and udhcpc. However, it&#039;s stuck on this router with a 2.6.13 kernel with a iptables conntrack module that can lead to spontaneous reboots. So I am considering going with Openwrt, because it allows for a more recent kernel and also out of curiosity. <br />Again, I&#039;m using the <a href="http://deve.loping.net/files/fritz-flash">fritz-flash</a> script, with little success. It seems to flash sucessfully. In fact, unlike in my previous post, the checksumming part succeeds. The problem is that after I remove and reinsert the power plug to reboot the router, I&#039;m not sure of what&#039;s happening then. The power led flashes 3-4 times and then the router stands there with the info led blinking indefinitely. I&#039;m not sure if it&#039;s that the router doesn&#039;t boot successfully for some unknown reason or that the firmware wasn&#039;t flashed correctly before. I&#039;m under the impression others have managed to at least flash the openwrt into the fritzbox 7140 and make it boot. Am I missing some crucial step, which may be not documented?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p201233">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Dominor</div>
					<div class="post-datetime">
						9 May 2013, 03:42					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m trying to flash openwrt trunk (latest revision). Perhaps another earlier revision might work. Anybody knows one specific openwrt revision that works with the fritzbox 7140/7170? Anyway, now I&#039;m going to try attitude adjustment.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p201240">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						9 May 2013, 05:43					</div>
				</div>
				<div class="post-content content">
					<p>If you haven&#039;t perusal this <a href="http://wiki.openwrt.org/toh/avm/fritz.box.wlan.7170">AVM Fritz!Box Fon WLAN 7170</a>,&nbsp; then you may want to do so.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p201242">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Dominor</div>
					<div class="post-datetime">
						9 May 2013, 05:52					</div>
				</div>
				<div class="post-content content">
					<p>Yes, I&#039;ve checked that wiki entry about Fritzbox 7140. In fact, that&#039;s where I&#039;ve got the flashing instructions.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p210049">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">robra</div>
					<div class="post-datetime">
						18 Aug 2013, 01:43					</div>
				</div>
				<div class="post-content content">
					<p>I am experiencing the same problems.</p><p>I tried flashing the openwrt-ar7-squashfs.bin in two different ways:<br /></p><ul><li><p>By following the instructions in <a href="http://wiki.openwrt.org/doc/howto/generic.flashing.ftp">http://wiki.openwrt.org/doc/howto/generic.flashing.ftp</a></p></li><li><p>Using the fritz-flash script<a href="http://deve.loping.net/files/fritz-flash">http://deve.loping.net/files/fritz-flash</a>.</p></li></ul><p>In both cases the process seemed to be succesful but after reboot, the INFO light just kept blinking while I was unsuccesful in my attempts to obtain an IP address by DHCP (which according to my interpretation of the <a href="http://wiki.openwrt.org/doc/howto/firstlogin">First Login</a> instructions should work).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p210070">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">zloop</div>
					<div class="post-datetime">
						18 Aug 2013, 12:12					</div>
				</div>
				<div class="post-content content">
					<p>I don&#039;t know if this issue is related but :</p><p>on another platform there is no switch support available with newer kernels<br />your switch: ADM6996 <a href="http://wiki.openwrt.org/oldwiki/hardware/avm?s">http://wiki.openwrt.org/oldwiki/hardware/avm?s</a>[]=7140</p><p>ticket and mailing list entry regarding ADM6996<br /><a href="https://dev.openwrt.org/changeset/37650">https://dev.openwrt.org/changeset/37650</a><br /><a href="https://lists.openwrt.org/pipermail/openwrt-devel/2013-July/020663.html">https://lists.openwrt.org/pipermail/ope â€¦ 20663.html</a></p><p>You could ask on the mailing list - there were some commits on lantiq platform recently - that platform is used by other Fritz!Box hardware</p><p>Maybe look at serial output to have an idea whats happening ?</p>											<p class="post-edited">(Last edited by <strong>zloop</strong> on 18 Aug 2013, 12:14)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p217652">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">Dominor</div>
					<div class="post-datetime">
						16 Nov 2013, 05:09					</div>
				</div>
				<div class="post-content content">
					<p>I appreciate your answer. I&#039;m not sure if the switch tip is entirely useful <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" />.<br />I finally managed to get serial console access to this router.<br />I both flashed a pre-compiled openwrt attitude adjustment and a self-compiled one both named: <br />openwrt-EVA-3.3-squashfs.bin</p><p>Again the INFO LED of the router blinks indefinately. However I managed to get serial console output during and after flashing as shown below.</p><div class="codebox"><pre><code> (AVM) EVA Revision: 1.340 Version: 1340

(C) Copyright 2005 AVM Date: Sep 13 2007 Time: 10:35:07 (1) 2 0x0-0x41B

[FLASH:] MACRONIX Top-Flash 8MB 
[FLASH:](Eraseregion [0] 127 sectors a 64kB) 
[FLASH:](Eraseregion [1] 8 sectors a 8kB) 
[SYSTEM:] OHIO on 211MHz/125MHz 

Eva_AVM &gt;
&lt;ERROR: FIRMWARE_CHECK_SUM&gt;


&lt;ERROR: FIRMWARE_CHECK_SUM &gt;restart

(AVM) EVA Revision: 1.340 Version: 1340

(C) Copyright 2005 AVM Date: Sep 13 2007 Time: 10:35:07 (1) 2 0x0-0x41B

[FLASH:] MACRONIX Top-Flash 8MB 
[FLASH:](Eraseregion [0] 127 sectors a 64kB) 
[FLASH:](Eraseregion [1] 8 sectors a 8kB) 
[SYSTEM:] OHIO on 211MHz/125MHz 

Eva_AVM &gt;

Eva_AVM &gt;

Eva_AVM &gt;

Eva_AVM &gt;

Eva_AVM &gt;
erase mtd1 .......................................................................................................................
Eva_AVM &gt;
flash .................................check mtd1


Eva_AVM &gt;restart

(AVM) EVA Revision: 1.340 Version: 1340

(C) Copyright 2005 AVM Date: Sep 13 2007 Time: 10:35:07 (1) 2 0x0-0x41B

[FLASH:] MACRONIX Top-Flash 8MB 
[FLASH:](Eraseregion [0] 127 sectors a 64kB) 
[FLASH:](Eraseregion [1] 8 sectors a 8kB) 
[SYSTEM:] OHIO on 211MHz/125MHz 

Eva_AVM &gt;
&lt;ERROR: FIRMWARE_CHECK_SUM&gt;


&lt;ERROR: FIRMWARE_CHECK_SUM &gt; </code></pre></div><p>I expected some form of kernel error probably related to the switch as you pointed out or to the wifi chipset.<br />Surprinsingly I got a firmware checksum error. It seems to me the bootloader fails to load the kernel from mtd1 due to some checksum error, which is strange since the checksumming test done by the eva ftp server passes. I guess it is possible the image produced by openwrt isn&#039;t supplied with the needed checksum.<br />Also this is the output of the printenv command:</p><div class="codebox"><pre><code>&lt;ERROR: FIRMWARE_CHECK_SUM &gt;printenv

HWRevision            107.1.0.0
ProductID             Fritz_Box_7140_AnnexA
SerialNumber          0000000000000000
annex                 A
autoload              yes
bootloaderVersion     1.340
bootserport           tty0
cpufrequency          211968000
firstfreeaddress      0x946C0D14
firmware_version      avm
flashsize             0x00800000
kernel_args           init=/etc/preinit
maca                  00:1C:4A:5A:1B:80
macb                  00:1C:4A:5A:1B:81
macwlan               00:1C:4A:4B:9A:28
macdsl                00:1C:4A:5A:1B:82
memsize               0x02000000
modetty0              38400,n,8,1,hw
modetty1              38400,n,8,1,hw
mtd0                  0x90000000,0x90000000
mtd1                  0x90010000,0x90780000
mtd2                  0x90000000,0x90010000
mtd3                  0x90780000,0x907C0000
mtd4                  0x907C0000,0x90800000
my_ipaddress          192.168.178.1
prompt                Eva_AVM
req_fullrate_freq     125000000
sysfrequency          125000000
urlader-version       1340
usb_board_mac         00:1C:4A:5A:1B:83
usb_rndis_mac         00:1C:4A:5A:1B:84
usb_device_id         0x3D00
usb_revision_id       0x0200
usb_manufacturer_name  AVM
wlan_key              7636269799580107
wlan_cal              001D,03F6,002E,00DE,010A,00E1,010A,030C,0321

&lt;ERROR: FIRMWARE_CHECK_SUM &gt;</code></pre></div>											<p class="post-edited">(Last edited by <strong>Dominor</strong> on 16 Nov 2013, 05:14)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>