<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> How to format new partition on external USB HDD at WL-500gP?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 25 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p46085">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">solarhk</div>
					<div class="post-datetime">
						8 Apr 2007, 16:44					</div>
				</div>
				<div class="post-content content">
					<p>The router can find and mount the HDD.&nbsp; </p><p>After I installed the package &quot;e2fsprogs&quot;.&nbsp; I try to execute &quot;mke2fs&quot;,&nbsp; it said &quot;sh: mke2fs: not found&quot;.&nbsp; &nbsp;I found 2 command at /opt/sbin.&nbsp; Which are:</p><div class="codebox"><pre><code>-rwxr-xr-x    2 root     root        50332 Mar 31 08:44 mkfs.ext2
-rwxr-xr-x    2 root     root        50332 Mar 31 08:44 mkfs.ext3</code></pre></div><p>I tried to execute those 2 command,&nbsp; but the result are same &quot;sh: mkfs.ext?: not found&quot;</p><p>Any suggest about that?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46087">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">ScarEye</div>
					<div class="post-datetime">
						8 Apr 2007, 17:06					</div>
				</div>
				<div class="post-content content">
					<p>if you installed e2fsprogs make sure you installed.&nbsp; kmod-ext2 and kmod-ext3 packages. </p><p>After that&#039;s all done.&nbsp; Make sure you installed the USB drivers to support your usb devices.</p><p>To format your usb storage drive. you can</p><br /><p>mke2fs /mnt/wutever<br />mkfs.ext2 /mnt/wutever<br />mkfs.ext3 /mnt/wutever</p><br /><p>Once the drives are formatted you can mount them.</p><br /><p>-ScarEye</p>											<p class="post-edited">(Last edited by <strong>ScarEye</strong> on 8 Apr 2007, 17:21)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46089">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">solarhk</div>
					<div class="post-datetime">
						8 Apr 2007, 17:21					</div>
				</div>
				<div class="post-content content">
					<p>Thx,&nbsp; I installed the kmod-ext2, kmod-ext3 and kmod-usb2&nbsp; already.&nbsp; Here are my installed packages.</p><div class="codebox"><pre><code>Action    Package    Version    Description
Uninstall    base-files    9    OpenWrt filesystem structure and scripts
Uninstall    base-files-brcm    2    Board/architecture specific files
Uninstall    bridge    1.0.6-1    Ethernet bridging tools
Uninstall    busybox    1.00-5    Core utilities for embedded Linux systems
Uninstall    dnsmasq    2.35-1    A lightweight DNS and DHCP server
Uninstall    dropbear    0.48.1-1    Lightweight SSH client and server system
Uninstall    e2fsprogs    1.39-2    Ext2 Filesystem Utilities
Uninstall    fdisk    2.12r-1    
Uninstall    haserl    0.8.0-1    a CGI wrapper to embed shell scripts in HTML documents
Uninstall    ipkg    0.99.149-2    lightweight package management system
Uninstall    iptables    1.3.3-2    The netfilter firewalling software for IPv4
Uninstall    iwlib    28.pre7-1    Library for setting up WiFi cards using the Wireless Extension
Uninstall    kernel    2.4.30-brcm-5    
Uninstall    kmod-brcm-wl    2.4.30-brcm-5    Proprietary driver for Broadcom Wireless chipsets
Uninstall    kmod-diag    2.4.30-brcm-5    Kernel modules for LEDs and buttons
Uninstall    kmod-ext2    2.4.30-brcm-5    Kernel modules for EXT2 filesystem support
Uninstall    kmod-ext3    2.4.30-brcm-5    Kernel modules for EXT3 filesystem support
Uninstall    kmod-ipt-nat-default    2.4.30-brcm-5    Default Netfilter (IPv4) NAT kernel modules for special protocols
Uninstall    kmod-ppp    2.4.30-brcm-5    PPP support
Uninstall    kmod-pppoe    2.4.30-brcm-5    PPP over Ethernet support
Uninstall    kmod-switch    2.4.30-brcm-1    switch driver for robo/admtek switch
Uninstall    kmod-usb-core    2.4.30-brcm-5    Kernel Support for USB
Uninstall    kmod-usb-storage    2.4.30-brcm-5    Kernel modules for USB storage support
Uninstall    kmod-usb2    2.4.30-brcm-5    Kernel driver for USB2 controllers
Uninstall    kmod-wlcompat    2.4.30-brcm-4    Compatibility module for using the Wireless Extension with broadcom&#039;s wl
Uninstall    mtd    5    Tool for modifying the flash chip
Uninstall    ntpclient    2003_194-2    NTP client for setting system time from NTP servers.
Uninstall    nvram    1    NVRAM utility and libraries for Broadcom hardware
Uninstall    ppp    2.4.3-7    a PPP (Point-to-Point Protocol) daemon (with MPPE/MPPC support)
Uninstall    ppp-mod-pppoe    2.4.3-7    a PPPoE (PPP over Ethernet) plugin for PPP
Uninstall    uclibc    0.9.27-9    Standard C library for embedded Linux systems
Uninstall    webif    0.2-1    A modular, extensible web interface for OpenWrt.
Uninstall    webif-theme-zephyr    0.3-7    Zephyr theme for webif^2.
Uninstall    wificonf    6    Replacement utility for wlconf
Uninstall    wireless-tools    28.pre7-1    Tools for setting up WiFi cards using the Wireless Extension</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46091">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">ScarEye</div>
					<div class="post-datetime">
						8 Apr 2007, 17:26					</div>
				</div>
				<div class="post-content content">
					<p>Restart your router.&nbsp; Once booted up do a dmesg and put it up here.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46092">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">kebul</div>
					<div class="post-datetime">
						8 Apr 2007, 17:32					</div>
				</div>
				<div class="post-content content">
					<p>The shell cannot find the programs in the search PATH. You can start them only by the full path or ./&lt;program&gt; in /opt/sbin.<br />Follow the guide to install packages off the root:<br /><a href="http://wiki.openwrt.org/UsbStorageHowto#head-3c6cbace3d9963db44aa1fd1f3fcd09fc64dc92b">http://wiki.openwrt.org/UsbStorageHowto â€¦ 9fc64dc92b</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46100">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">solarhk</div>
					<div class="post-datetime">
						8 Apr 2007, 18:57					</div>
				</div>
				<div class="post-content content">
					<p>Here are the dmesg after reboot.</p><div class="codebox"><pre><code>root@OpenWrt:~# dmesg
CPU revision is: 00029006
Primary instruction cache 16kB, physically tagged, 2-way, linesize 16 bytes.
Primary data cache 16kB, 2-way, linesize 16 bytes.
Linux version 2.4.30 (nbd@ds10) (gcc version 3.4.4 (OpenWrt-1.0)) #1 Sat Feb 3 13:16:08 CET 2007
Setting the PFC value as 0x15
Determined physical RAM map:
 memory: 02000000 @ 00000000 (usable)
On node 0 totalpages: 8192
zone(0): 8192 pages.
zone(1): 0 pages.
zone(2): 0 pages.
Kernel command line: root=/dev/mtdblock2 rootfstype=squashfs,jffs2 init=/etc/preinit noinitrd console=ttyS0,115200
CPU: BCM4704 rev 8 at 264 MHz
Using 132.000 MHz high precision timer.
Calibrating delay loop... 263.78 BogoMIPS
Memory: 30436k/32768k available (1455k kernel code, 2332k reserved, 104k data, 80k init, 0k highmem)
Dentry cache hash table entries: 4096 (order: 3, 32768 bytes)
Inode cache hash table entries: 2048 (order: 2, 16384 bytes)
Mount cache hash table entries: 512 (order: 0, 4096 bytes)
Buffer cache hash table entries: 1024 (order: 0, 4096 bytes)
Page-cache hash table entries: 8192 (order: 3, 32768 bytes)
Checking for &#039;wait&#039; instruction...  unavailable.
POSIX conformance testing by UNIFIX
PCI: Fixing up bus 0
PCI: Fixing up bridge
PCI: Setting latency timer of device 01:00.0 to 64
PCI: Fixing up bus 1
Linux NET4.0 for Linux 2.4
Based upon Swansea University Computer Society NET3.039
Initializing RT netlink socket
Starting kswapd
Registering mini_fo version $Id$
devfs: v1.12c (20020818) Richard Gooch (rgooch@atnf.csiro.au)
devfs: boot_options: 0x1
JFFS2 version 2.1. (C) 2001 Red Hat, Inc., designed by Axis Communications AB.
Squashfs 2.1-r2 (released 2004/12/15) (C) 2002-2004 Phillip Lougher
pty: 256 Unix98 ptys configured
Serial driver version 5.05c (2001-07-08) with MANY_PORTS SHARE_IRQ SERIAL_PCI enabled
ttyS00 at 0xb8000300 (irq = 3) is a 16550A
ttyS01 at 0xb8000400 (irq = 0) is a 16550A
b44.c:v0.93 (Mar, 2004)
PCI: Setting latency timer of device 00:01.0 to 64
eth0: Broadcom 47xx 10/100BaseT Ethernet 00:18:f3:70:5e:22
PCI: Setting latency timer of device 00:02.0 to 64
eth1: Broadcom 47xx 10/100BaseT Ethernet 40:10:18:00:00:2d
Physically mapped flash: Found an alias at 0x800000 for the chip at 0x0
Physically mapped flash: Found an alias at 0x1000000 for the chip at 0x0
Physically mapped flash: Found an alias at 0x1800000 for the chip at 0x0
 Amd/Fujitsu Extended Query Table v1.3 at 0x0040
number of CFI chips: 1
cfi_cmdset_0002: Disabling fast programming due to code brokenness.
Flash device: 0x800000 at 0x1c000000
bootloader size: 262144
Physically mapped flash: Filesystem type: squashfs, size=0xfb158
Creating 5 MTD partitions on &quot;Physically mapped flash&quot;:
0x00000000-0x00040000 : &quot;cfe&quot;
0x00040000-0x007f0000 : &quot;linux&quot;
0x000be400-0x001c0000 : &quot;rootfs&quot;
mtd: partition &quot;rootfs&quot; doesn&#039;t start on an erase block boundary -- force read-only
0x007f0000-0x00800000 : &quot;nvram&quot;
0x001c0000-0x007f0000 : &quot;OpenWrt&quot;
Initializing Cryptographic API
NET4: Linux TCP/IP 1.0 for NET4.0
IP Protocols: ICMP, UDP, TCP, IGMP
IP: routing cache hash table of 512 buckets, 4Kbytes
TCP: Hash tables configured (established 2048 bind 4096)
ip_conntrack version 2.1 (5953 buckets, 5953 max) - 332 bytes per conntrack
ip_tables: (C) 2000-2002 Netfilter core team
NET4: Unix domain sockets 1.0/SMP for Linux NET4.0.
NET4: Ethernet Bridge 008 for NET4.0
802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;
All bugs added by David S. Miller &lt;davem@redhat.com&gt;
VFS: Mounted root (squashfs filesystem) readonly.
Mounted devfs on /dev
Freeing unused kernel memory: 80k freed
Algorithmics/MIPS FPU Emulator v1.5
diag: Detected &#039;ASUS WL-500g Premium&#039;
Probing device eth0: found!
b44: eth0: Link is up at 100 Mbps, full duplex.
b44: eth0: Flow control is off for TX and off for RX.
mini_fo: using base directory: /
mini_fo: using storage directory: /jffs
jffs2.bbc: SIZE compression mode activated.
PCI: Setting latency timer of device 01:02.0 to 64
PCI: Enabling device 01:02.0 (0004 -&gt; 0006)
eth2: Broadcom BCM4318 802.11 Wireless Controller 3.90.37.0
Journalled Block Device driver loaded
BFL_ENETADM not set in boardflags. Use force=1 to ignore.
usb.c: registered new driver usbdevfs
usb.c: registered new driver hub
SCSI subsystem driver Revision: 1.00
Initializing USB Mass Storage driver...
usb.c: registered new driver usb-storage
USB Mass Storage support registered.
PCI: Enabling device 01:03.2 (0000 -&gt; 0002)
ehci_hcd 01:03.2: PCI device 1106:3104
ehci_hcd 01:03.2: irq 2, pci mem c01c3000
usb.c: new USB bus registered, assigned bus number 1
EHCI: Enabling VIA 6212 workarounds
ehci_hcd 01:03.2: USB 2.0 enabled, EHCI 1.00, driver 2003-Dec-29/2.4
hub.c: USB hub found
hub.c: 4 ports detected
device eth0 entered promiscuous mode
hub.c: new USB device 01:03.2-1, assigned address 2
scsi0 : SCSI emulation for USB Mass Storage devices
  Vendor: Maxtor 6  Model: L300R0            Rev: 0811
  Type:   Direct-Access                      ANSI SCSI revision: 02
Attached scsi disk sda at scsi0, channel 0, id 0, lun 0
SCSI device sda: 586114704 512-byte hdwr sectors (300091 MB)
Partition check:
 /dev/scsi/host0/bus0/target0/lun0: p1
WARNING: USB Mass Storage data integrity not assured
USB Mass Storage device found at 2
jffs2: attempt to mount non-MTD device 08:01
SQUASHFS error: Can&#039;t find a SQUASHFS superblock on sd(8,1)
EXT2-fs warning: mounting unchecked fs, running e2fsck is recommended
b44: eth0: Link is up at 100 Mbps, full duplex.
b44: eth0: Flow control is off for TX and off for RX.
vlan0: add 01:00:5e:00:00:01 mcast address to master interface
vlan0: dev_set_promiscuity(master, 1)
vlan0: dev_set_allmulti(master, 1)
device eth2 entered promiscuous mode
eth2: attempt to add interface with same source address.
br0: port 2(eth2) entering listening state
br0: port 1(vlan0) entering listening state
br0: port 2(eth2) entering learning state
br0: port 2(eth2) entering forwarding state
br0: topology change detected, propagating
br0: port 1(vlan0) entering learning state
br0: port 1(vlan0) entering forwarding state
br0: topology change detected, propagating
vlan1: add 01:00:5e:00:00:01 mcast address to master interface
CSLIP: code copyright 1989 Regents of the University of California
PPP generic driver version 2.4.2
root@OpenWrt:~#</code></pre></div><p>I also read the the UsbStroageHowTo.....,&nbsp; however,&nbsp; I can&#039;t find the mke2fs.<br />I found mkfs.ext2, mkfs.ext3&nbsp; and tried execute the command,&nbsp; both using ./&lt;program&gt; or full path. It just return &quot;-ash: mkfs.ext3: not found&quot; as following.<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# cd /opt/sbin
root@OpenWrt:/opt/sbin# ls
badblocks     e2fsck        findfs        logsave       resize2fs
blkid         e2image       fsck          mkfs.ext2     tune2fs
debugfs       e2label       fsck.ext2     mkfs.ext3
dumpe2fs      filefrag      fsck.ext3     mklost+found
root@OpenWrt:/opt/sbin# mkfs.ext3
-ash: mkfs.ext3: not found
root@OpenWrt:/opt/sbin# ./mkfs.ext3
-ash: ./mkfs.ext3: not found
root@OpenWrt:/opt/sbin#
root@OpenWrt:/opt/sbin# pwd
/opt/sbin
root@OpenWrt:/opt/sbin# /opt/sbin/mkfs.ext3
-ash: /opt/sbin/mkfs.ext3: not found
root@OpenWrt:/opt/sbin#</code></pre></div><p>Thank you for your suggest and I am looking forward to hearing more suggest from you.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46102">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">kebul</div>
					<div class="post-datetime">
						8 Apr 2007, 19:17					</div>
				</div>
				<div class="post-content content">
					<p>Do the executables have the executable permission?<br />Where did you install the e2fsprogs from? It can be linked against a library that is not present in your system.<br />Remove this package and install the e2fsprogs package from the RC6 backports!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46103">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">ScarEye</div>
					<div class="post-datetime">
						8 Apr 2007, 19:30					</div>
				</div>
				<div class="post-content content">
					<p>Okay, your router is seeing the USB device which is good.&nbsp; &nbsp;Now do what kebul said.&nbsp; Remove e2fsprogs and reinstall it<br />from here.&nbsp; &nbsp;<a href="http://downloads.openwrt.org/backports/rc5/e2fsprogs_1.38-1_mipsel.ipk">http://downloads.openwrt.org/backports/ â€¦ mipsel.ipk</a></p>											<p class="post-edited">(Last edited by <strong>ScarEye</strong> on 8 Apr 2007, 19:31)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46106">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">solarhk</div>
					<div class="post-datetime">
						8 Apr 2007, 19:56					</div>
				</div>
				<div class="post-content content">
					<p>oh, the command can be found now!&nbsp; Thx.</p><p>I install the e2fsprogs from optware.&nbsp; Which should be 1.39.&nbsp; Since I use the web interface, and I can&#039;t find it in backport package list.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>