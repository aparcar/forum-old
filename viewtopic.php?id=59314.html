<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> strongswan troubles with EAP-MSCHAPV2</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 23 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p289911">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">n4p</div>
					<div class="post-datetime">
						31 Aug 2015, 23:32					</div>
				</div>
				<div class="post-content content">
					<p>Hello everybody,<br />i tried to follow the howto from the wiki to setup an vpn server with strongswan for my android clients. But it seems with the current version of strongswan ( 5.3.2 ) the EAP-MSCHAPV2 plugin won&#039;t get loaded.</p><p>Also i need to limit the plugins with charon, if not it would stuck in a restart loop.</p><p>Especually anybody can help me to fix that? Would be great! <br />Currently using Chaos Calmer 15.05 for this setup.</p><p>And here the log outputs:</p><div class="codebox"><pre><code>Mon Aug 31 22:13:39 2015 daemon.info syslog: 08[CFG] added configuration &#039;roadwarrior&#039;
Mon Aug 31 22:13:52 2015 daemon.info syslog: 04[NET] received packet: from xxx.xxx.xxx.254[11894] to xxx.xxx.xxx.154[500] (1012 bytes)
Mon Aug 31 22:13:52 2015 daemon.info syslog: 04[ENC] parsed IKE_SA_INIT request 0 [ SA KE No N(NATD_S_IP) N(NATD_D_IP) N(FRAG_SUP) N(HASH_ALG) ]
Mon Aug 31 22:13:52 2015 daemon.info syslog: 04[IKE] xxx.xxx.xxx.254 is initiating an IKE_SA
Mon Aug 31 22:13:52 2015 authpriv.info syslog: 04[IKE] xxx.xxx.xxx.254 is initiating an IKE_SA
Mon Aug 31 22:13:53 2015 daemon.info syslog: 04[IKE] remote host is behind NAT
Mon Aug 31 22:13:53 2015 daemon.info syslog: 04[IKE] sending cert request for &quot;C=AT, O=HeimNetz, CN=xxxx&quot;
Mon Aug 31 22:13:53 2015 daemon.info syslog: 04[ENC] generating IKE_SA_INIT response 0 [ SA KE No N(NATD_S_IP) N(NATD_D_IP) CERTREQ N(HASH_ALG) N(MULT_AUTH) ]
Mon Aug 31 22:13:53 2015 daemon.info syslog: 04[NET] sending packet: from xxx.xxx.xxx.154[500] to xxx.xxx.xxx.254[11894] (481 bytes)
Mon Aug 31 22:13:55 2015 daemon.info syslog: 03[NET] received packet: from xxx.xxx.xxx.254[22502] to xxx.xxx.xxx.154[4500] (4700 bytes)
Mon Aug 31 22:13:55 2015 daemon.info syslog: 03[ENC] parsed IKE_AUTH request 1 [ IDi CERT N(INIT_CONTACT) CERTREQ AUTH CPRQ(ADDR ADDR6 DNS DNS6) N(ESP_TFC_PAD_N) SA TSi TSr N(MOBIKE_SUP) N(NO_ADD_ADDR) N(MULT_AUTH) N(EAP_ONLY) N(AUTH_FOLLOWS) ]
Mon Aug 31 22:13:55 2015 daemon.info syslog: 03[IKE] received cert request for &quot;C=AT, O=HeimNetz, CN=xxxx&quot;
Mon Aug 31 22:13:55 2015 daemon.info syslog: 03[IKE] received 153 cert requests for an unknown ca
Mon Aug 31 22:13:55 2015 daemon.info syslog: 03[IKE] received end entity cert &quot;C=AT, O=HeimNetz, CN=client&quot;
Mon Aug 31 22:13:55 2015 daemon.info syslog: 03[CFG] looking for peer configs matching xxx.xxx.xxx.154[%any]...xxx.xxx.xxx.254[C=AT, O=HeimNetz, CN=client]
Mon Aug 31 22:13:55 2015 daemon.info syslog: 03[CFG] selected peer config &#039;roadwarrior&#039;
Mon Aug 31 22:13:55 2015 daemon.info syslog: 03[CFG]   using trusted ca certificate &quot;C=AT, O=HeimNetz, CN=xxxx&quot;
Mon Aug 31 22:13:55 2015 daemon.info syslog: 03[CFG] checking certificate status of &quot;C=AT, O=HeimNetz, CN=client&quot;
Mon Aug 31 22:13:55 2015 daemon.info syslog: 03[CFG] certificate status is not available
Mon Aug 31 22:13:55 2015 daemon.info syslog: 03[CFG]   reached self-signed root ca with a path length of 0
Mon Aug 31 22:13:55 2015 daemon.info syslog: 03[CFG]   using trusted certificate &quot;C=AT, O=HeimNetz, CN=client&quot;
Mon Aug 31 22:13:55 2015 daemon.info syslog: 03[IKE] authentication of &#039;C=AT, O=HeimNetz, CN=client&#039; with RSA_EMSA_PKCS1_SHA256 successful
Mon Aug 31 22:13:55 2015 daemon.info syslog: 03[IKE] received ESP_TFC_PADDING_NOT_SUPPORTED, not using ESPv3 TFC padding
Mon Aug 31 22:13:55 2015 daemon.info syslog: 03[IKE] peer supports MOBIKE
Mon Aug 31 22:13:55 2015 daemon.info syslog: 03[IKE] authentication of xxx.xxx.xxx.org&#039; (myself) with RSA_EMSA_PKCS1_SHA256 successful
Mon Aug 31 22:13:55 2015 daemon.info syslog: 03[IKE] sending end entity cert &quot;C=AT, O=HeimNetz, CN=xxx.xxx.xxx.org&quot;
Mon Aug 31 22:13:55 2015 daemon.info syslog: 03[ENC] generating IKE_AUTH response 1 [ IDr CERT AUTH ]
Mon Aug 31 22:13:55 2015 daemon.info syslog: 03[NET] sending packet: from xxx.xxx.xxx.154[4500] to xxx.xxx.xxx.254[22502] (1260 bytes)
Mon Aug 31 22:13:55 2015 daemon.info syslog: 02[NET] received packet: from xxx.xxx.xxx.254[22502] to xxx.xxx.xxx.154[4500] (76 bytes)
Mon Aug 31 22:13:55 2015 daemon.info syslog: 02[ENC] parsed IKE_AUTH request 2 [ IDi ]
Mon Aug 31 22:13:55 2015 daemon.info syslog: 02[IKE] loading EAP_MSCHAPV2 method failed
Mon Aug 31 22:13:55 2015 daemon.info syslog: 02[ENC] generating IKE_AUTH response 2 [ EAP/FAIL ]
Mon Aug 31 22:13:55 2015 daemon.info syslog: 02[NET] sending packet: from xxx.xxx.xxx.154[4500] to xxx.xxx.xxx.254[22502] (76 bytes</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p289976">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">n4p</div>
					<div class="post-datetime">
						1 Sep 2015, 12:20					</div>
				</div>
				<div class="post-content content">
					<p>fixed!!</p><p>solution:</p><div class="codebox"><pre><code>charon {
  load = aes des sha1 sha2 md4 md5 pem pkcs1 gmp random nonce x509 curl revocation hmac xcbc stroke kernel-netlink socket-default fips-prf eap-mschapv2 eap-identity updown
}</code></pre></div><p>and mschapv2 will be loaded.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>