<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> StrongSWan Site2Site with FQDN Identifiers</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 31 May 2013.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p200059">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">redflag237</div>
					<div class="post-datetime">
						29 Apr 2013, 17:41					</div>
				</div>
				<div class="post-content content">
					<p>Hi together,</p><p>Unfortunately i cannot find any good documentation for my problem.<br/>I followed this tutorial for the init script: <a href="http://wiki.openwrt.org/doc/howto/vpn.ipsec.basics">http://wiki.openwrt.org/doc/howto/vpn.ipsec.basics</a></p><p>I tried to setup a SiteToSite VPN using FQDN Identifier. <br/>My Logs on both sides tells me that there was no proposal found.</p><p>Can someone show me an example for FQDN Identifiers, please?</p><p>this is my current config (part one):</p><p>config &#039;remote&#039; &#039;bratwurst&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option &#039;enabled&#039; &#039;1&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option &#039;gateway&#039; &#039;location1.no-ip.org&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option &#039;authentication_method&#039; &#039;psk&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option &#039;pre_shared_key&#039; &#039;verysecretkey&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option &#039;exchange_mode&#039; &#039;aggressive&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option &#039;my_identifier&#039; &#039;location2.no-ip.org&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; list&nbsp; &nbsp;&#039;p1_proposal&#039; &#039;pre_g2_aes_sha1&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; list&nbsp; &nbsp;&#039;sainfo&#039; &#039;location1_lan&#039;</p><p>config &#039;p1_proposal&#039; &#039;pre_g2_aes_sha1&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option &#039;encryption_algorithm&#039; &#039;aes128&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option &#039;hash_algorithm&#039; &#039;sha1&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option &#039;dh_group&#039; &#039;2&#039;</p><p>config &#039;tunnel&#039; &#039;location1_lan&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option &#039;local_subnet&#039; &#039;10.178.1.160/27&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option &#039;remote_subnet&#039; &#039;192.168.1.0/24&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option &#039;p2_proposal&#039; &#039;g2_aes_sha1&#039;</p><p>config &#039;p2_proposal&#039; &#039;g2_aes_sha1&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option &#039;pfs_group&#039; &#039;2&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option &#039;encryption_algorithm&#039; &#039;aes128&#039;<br/>&nbsp; &nbsp; &nbsp; &nbsp; option &#039;authentication_algorithm&#039; &#039;sha1&#039;</p><br/><p>Peer System is a normal pfSense Firewall (running old racoon). Connection fails at Phase1 with not finding the matching proposals.<br/>I think that the layout is wrong for fqdn identifiers.</p><p>Best regards,</p><p>redflag237</p>											<p class="post-edited">(Last edited by <strong>redflag237</strong> on 30 Apr 2013, 10:36)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p200163">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">redflag237</div>
					<div class="post-datetime">
						30 Apr 2013, 10:37					</div>
				</div>
				<div class="post-content content">
					<p>~updated post with my complete config.</p><p>I found this post, where a config with fqdn identifiers is set up.<br/><a href="http://layer9.wordpress.com/2010/07/28/ipsec-vpn-mit-strongswan-und-fritzbox-fon-wlan-7270-v3/">http://layer9.wordpress.com/2010/07/28/ipsec-vpn-mit-strongswan-und-fritzbox-fon-wlan-7270-v3/</a><br/>It&#039;s German, but maybe Google translator might help.</p><p>Problem: StrongSwan expects an IP as right identifier, until a &#039;rightid&#039; with @fqdn is set.<br/>I don&#039;t have any experience on that - could someone help, please?</p><p>The Script does not seem to own that field.</p><p>Best regards,</p><p>redflag237</p>											<p class="post-edited">(Last edited by <strong>redflag237</strong> on 30 Apr 2013, 10:53)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p200774">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">birnenschnitzel</div>
					<div class="post-datetime">
						5 May 2013, 12:35					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>thanks for that information. Some of the parameters got lost when I translated the racoon stuff over to Strongswan. Everything in the wiki regarding this issue was updated. Now you can use &quot;local_identifier&quot; and &quot;remote_identifier&quot; parameters in /etc/config/ipsec</p><p>Don&#039;t forget to download the newest version of ipsec start script.</p><p>Markus</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>