<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> ip_conntrack/ nf_conntrack / netfilters</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 6 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p367855">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">kevincleynen</div>
					<div class="post-datetime">
						5 Nov 2017, 07:07					</div>
				</div>
				<div class="post-content content">
					<p>Hello guys,<br />Anyone on this forum here that has some <br />experience on adjusting the conntrack and hashsize filters ? <br />and setting your own value&#039;s and start up script<br />like iptables/nat/ip_conntrack/....</p><p>Im an DD-wrt user at this moment, but im just curious,<br />how the console is configured for OpenWrt? <br />Or could help me further on these config&#039;s,<br />This is the Start up script and adjustments i&#039;m using now <br /></p><div class="quotebox"><blockquote><p>#!/bin/sh/<br />sleep 300<br />sysctl -w kernel.shm_rmid_forced=1<br />echo 1 &gt; /proc/sys/kernel/modules_disabled<br />echo 524288 &gt; /sys/module/nf_conntrack/parameters/hashsize <br />echo 1048576 &gt; /proc/sys/net/ipv4/netfilter/ip_conntrack_max<br />echo 8192 &gt; /proc/sys/net/netfilter/nf_conntrack_expect_max<br />echo 1440000 &gt; /proc/sys/net/ipv4/tcp_max_tw_buckets<br />echo 16384 &gt; /proc/sys/net/ipv4/tcp_max_orphans<br />echo 65536 &gt; /proc/sys/net/core/netdev_max_backlog<br />echo 65536 &gt; /proc/sys/net/ipv4/tcp_max_syn_backlog<br />echo 131072 &gt; /proc/sys/net/core/somaxconn <br />echo 131072 &gt; /proc/sys/vm/min_free_kbytes<br />echo 268435456 &gt; /proc/sys/net/core/optmem_max<br />echo 524288 4194304 268435456 &gt; /proc/sys/net/ipv4/tcp_mem<br />echo 524288 4194304 268435456 &gt; /proc/sys/net/ipv4/tcp_rmem<br />echo 524288 4194304 268435456 &gt; /proc/sys/net/ipv4/tcp_wmem<br />echo 262144 2097152 134217728 &gt; /proc/sys/net/ipv4/udp_mem<br />echo 4194304 &gt; /proc/sys/net/core/rmem_default<br />echo 268435456 &gt; /proc/sys/net/core/rmem_max<br />echo 4194304 &gt; /proc/sys/net/core/wmem_default<br />echo 268435456 &gt; /proc/sys/net/core/wmem_max<br />echo 262144 &gt; /proc/sys/net/ipv4/udp_rmem_min <br />echo 262144 &gt; /proc/sys/net/ipv4/udp_wmem_min<br />echo 1492 &gt; /proc/sys/net/ipv6/conf/all/mtu<br />echo 1492 &gt; /proc/sys/net/ipv6/conf/ppp0/mtu<br />echo 1492 &gt; /proc/sys/net/ipv6/conf/eth0/mtu<br />echo 2048 &gt; /proc/sys/net/ipv6/neigh/default/gc_thresh1<br />echo 4096 &gt; /proc/sys/net/ipv6/neigh/default/gc_thresh2<br />echo 8192 &gt; /proc/sys/net/ipv6/neigh/default/gc_thresh3<br />echo 60 &gt; /proc/sys/net/ipv6/neigh/default/base_reachable_time_ms<br />echo 240 &gt; /proc/sys/net/ipv6/neigh/default/gc_stale_time<br />echo 4096 &gt; /proc/sys/net/ipv6/route/gc_thresh<br />echo 268435456 &gt; /proc/sys/kernel/shmall<br />echo 536870912 &gt; /proc/sys/kernel/shmmax<br />echo 4194304 &gt; /proc/sys/kernel/msgmax<br />echo 262144 &gt;&nbsp; /proc/sys/kernel/msgmnb<br />echo 8192 &gt; /proc/sys/kernel/msgmni<br />echo 0 &gt; /proc/sys/kernel/sysrq<br />echo 1 &gt; /proc/sys/fs/suid_dumpable<br />echo 4096 &gt; /proc/sys/vm/dirty_bytes<br />echo 1 &gt; /proc/sys/vm/overcommit_memory<br />echo 4096 &gt; /proc/sys/net/ipv4/tcp_base_mss<br />echo 30 &gt; /proc/sys/net/ipv4/ipfrag_time<br />echo 8192 &gt; /proc/sys/net/ipv4/neigh/default/gc_thresh3<br />echo 4096 &gt; /proc/sys/net/ipv4/neigh/default/gc_thresh2<br />echo 2048 &gt; /proc/sys/net/ipv4/neigh/default/gc_thresh1<br />echo 30 &gt; /proc/sys/net/ipv4/neigh/default/gc_interval<br />echo 240 &gt; /proc/sys/net/ipv4/neigh/default/gc_stale_time<br />echo 60 &gt; /proc/sys/net/ipv4/neigh/default/base_reachable_time_ms<br />echo 240 &gt; /proc/sys/net/ipv4/neigh/eth0/gc_stale_time <br />echo 1 &gt; /proc/sys/net/ipv4/tcp_syncookies<br />echo 1 &gt; /proc/sys/net/ipv4/tcp_window_scaling<br />echo 1 &gt; /proc/sys/net/ipv4/ip_forward<br />echo 1 &gt; /proc/sys/net/ipv4/tcp_no_metrics_save<br />echo 1 &gt; /proc/sys/net/ipv4/tcp_moderate_rcvbuf<br />echo performance &gt; /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor<br />echo performance &gt; /sys/devices/system/cpu/cpu1/cpufreq/scaling_governor<br />echo 1 &gt; /proc/sys/net/ipv4/tcp_tw_reuse<br />echo 1 &gt; /proc/sys/net/ipv4/tcp_tw_recycle<br />echo 1 &gt; /proc/sys/net/ipv4/tcp_ecn<br />echo 3 &gt; /proc/sys/net/ipv4/tcp_reordering<br />echo 6 &gt; /proc/sys/net/ipv4/tcp_syn_retries<br />echo 2 &gt; /proc/sys/net/ipv4/tcp_synack_retries<br />echo 30 &gt; /proc/sys/net/ipv4/tcp_timeout_syn_recv<br />echo 120 &gt; /proc/sys/net/ipv4/tcp_timeout_syn_sent<br />echo 15 &gt; /proc/sys/net/ipv4/tcp_timeout_last_ack<br />echo 150 &gt; /proc/sys/net/ipv4/tcp_timeout_time_wait<br />echo 1 &gt; /proc/sys/net/ipv4/tcp_timestamps<br />echo 300 &gt; /proc/sys/net/ipv4/tcp_timeout_unacknowledged <br />echo 1 &gt; /proc/sys/net/ipv4/tcp_retrans_collapse<br />echo 10 &gt; /proc/sys/net/ipv4/tcp_fin_timeout<br />echo 6 &gt; /proc/sys/net/ipv4/route/redirect_number<br />echo 1800 &gt; /proc/sys/net/ipv4/tcp_keepalive_time<br />echo 30 &gt; /proc/sys/net/ipv4/tcp_keepalive_intvl <br />echo 5 &gt; /proc/sys/net/ipv4/tcp_keepalive_probes <br />echo 1 &gt; /proc/sys/net/ipv4/tcp_sack<br />echo 0 &gt; /proc/sys/net/ipv4/tcp_slow_start_after_idle<br />echo 1 &gt; /proc/sys/net/ipv4/conf/all/rp_filter<br />echo 1 &gt; /proc/sys/net/ipv6/conf/all/rp_filter<br />echo 1 &gt; /proc/sys/net/ipv4/conf/all/arp_ignore<br />echo 1 &gt; /proc/sys/net/ipv4/conf/all/arp_filter<br />echo 1 &gt; /proc/sys/net/ipv4/icmp_echo_ignore_all<br />echo 1 &gt; /proc/sys/net/ipv4/icmp_echo_ignore_broadcasts <br />echo 1 &gt; /proc/sys/net/ipv4/icmp_ignore_bogus_error_responses <br />echo 0 &gt; /proc/sys/net/ipv4/conf/all/send_redirects<br />echo 0 &gt; /proc/sys/net/ipv4/conf/all/secure_redirects<br />echo 0 &gt; /proc/sys/net/ipv4/conf/all/accept_redirects<br />echo 0 &gt; /proc/sys/net/ipv4/conf/all/accept_source_route<br />echo 0 &gt; /proc/sys/net/ipv6/conf/all/accept_source_route<br />echo 0 &gt; /proc/sys/net/ipv6/conf/all/accept_redirect<br />echo 30000 65535 &gt; /proc/sys/net/ipv4/ip_local_port_range<br />echo 1 &gt; /proc/sys/net/ipv4/tcp_abort_on_overflow<br />echo 1 &gt; /proc/sys/net/ipv4/tcp_mtu_probing<br />echo 0 &gt; /proc/sys/net/ipv4/tcp_orphan_retries<br />echo 0 &gt; /proc/sys/net/ipv6/conf/all/dad_transmits<br />echo 0 &gt; /proc/sys/net/ipv6/conf/default/dad_transmits<br />echo 3 &gt; /proc/sys/net/ipv4/tcp_fastopen<br />echo 1 &gt; /proc/sys/net/ipv4/route.flush<br />echo 1 &gt; /proc/sys/net/ipv6/route.flush<br />echo 120 &gt; /proc/sys/net/ipv4/netfilter/ip_conntrack_generic_timeout<br />echo 86400 &gt; /proc/sys/net/ipv4/netfilter/ip_conntrack_tcp_timeout_established<br />sysctl -w net.ipv4.tcp_congestion_control=htcp<br />/sbin/ifconfig eth0 txqueuelen 8192</p></blockquote></div><p>Dont look at the value&#039;s to much, cause im still changing these value&#039;s.. </p><p>If anyone has experience using these code&#039;s with SSH<br />and how to config them correctly to adjust Linux <br />on your own router, cause atleast OpenWrt/DD-wrt <br />is using Linux servers.</p><p>Thanks for reading, and hope to find some users.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>