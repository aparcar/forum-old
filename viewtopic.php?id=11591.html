<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> OpenVPN client on WRT make dnsmasq use DNS servers pushed from server</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 26 Feb 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p52135">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">g18c</div>
					<div class="post-datetime">
						11 Jul 2007, 09:59					</div>
				</div>
				<div class="post-content content">
					<p>Hi, im running OpenVPN as a client on my WRT, the server is pushing the dns server dhcp option to the client however it is not being set. When the OpenVPN client connects i would like the dns server to be used over the VPN rather than my local router&#039;s dns server, any direction which scripts should i add/edit?</p><p>I need dnsmasq to be running as i would like lan clients to use the WRT as the dns server. I simply want the requests to be forwarded to the server on the lan but the /tmp/resolv.conf files are not changed.</p><p>Current files are:</p><p># cat /tmp/resolv.conf<br />nameserver 127.0.0.1<br />search lan</p><p># cat /tmp/resolv.conf.auto<br />nameserver 192.168.1.1</p><p>i am running White Russian 0.9</p><p>Thanks in advance</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p52144">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">g18c</div>
					<div class="post-datetime">
						11 Jul 2007, 13:04					</div>
				</div>
				<div class="post-content content">
					<p>Right i have managed to read the option in the up-script for the openvpn client and it works, i set in the up script:</p><p>dns1=`echo ${foreign_option_1} | sed -e &#039;s/dhcp-option DNS //g&#039;`<br />echo nameserver $dns1 &gt; /tmp/resolv.conf.auto</p><p>and all is good <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Cheers</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>