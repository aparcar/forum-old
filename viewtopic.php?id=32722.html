<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Creating images with custom kernel</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 25 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p147348">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">sza2</div>
					<div class="post-datetime">
						2 Nov 2011, 15:04					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I finally was able to manage compiling a custom kernel for my USB/DVB-T device - maybe it was my fault but I found it quite difficult.</p><p>Is there a way to specify which part of the kernel I want to build (specifying to create module or build it in) and force the system to include those modules to the filesystem (and not build kmod-XXX)?</p><p>The main menuconfig (obviously) does not contain all the possible kernel options. However the modified .config in kernel directory always been overwritten by some generated default config. Furthermore it is necessary to transfer the .ko modules to /lib/modules/2.6.XX on the device manually.</p><p>Can I specify somewhere (even by modifying config files manually) those things?</p><p>/sza2</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p147350">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						2 Nov 2011, 15:20					</div>
				</div>
				<div class="post-content content">
					<p>Its constructed from target/linux/generic/config-* and target/linux/$arch/config-*. You can use&nbsp; make kernel_menuconfig&nbsp; to influence options.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p147373">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">sza2</div>
					<div class="post-datetime">
						2 Nov 2011, 18:01					</div>
				</div>
				<div class="post-content content">
					<p>Well, I&#039;ve tried it (I think I did it earlier too), but it seems the .config used to compile the kernel which will be put to the image does not match with the one I set with kernel_menuconfig.</p><p>I started make kernel_menuconfig in the top level directory, I made the necessary configuration and save that. Then I ran make, but the compiled kernel does not built upon my settings but those which are in build_dir/linux-ar71xx_generic/linux-2.6.39.4 (in my case).</p><p>If I issue kernel_menuconfig again, it reflects those setting I made (not the compiled one), so it seems it stored anywhere else, and the building process uses something else.</p><p>/sza2</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p147378">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						2 Nov 2011, 20:02					</div>
				</div>
				<div class="post-content content">
					<p>Yes in target/linux/generic/config-*. Run svn diff on it and move the relevant symbols to your target config.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p147408">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">sza2</div>
					<div class="post-datetime">
						3 Nov 2011, 00:21					</div>
				</div>
				<div class="post-content content">
					<p>So, I still can&#039;t understand.</p><p>I&#039;ve an MR-3220. As I see, the config generated in target/linux/ar71xx/ and the name is config-2.6.39. I assume, I have to issue svn diff in this directory. But where to put the symbols? I thought, those should be added to config-2.6.39 in target/linux/generic. However it does not seems to work. After running make in the top level directory, the .config in build_dir/linux-ar71xx_generic/linux-2.6.39.4 does not contain the changes I made.</p><p>/sza2</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p147474">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						3 Nov 2011, 14:40					</div>
				</div>
				<div class="post-content content">
					<p>Target config overrules generic config so make sure your symbols are distributed accordingly.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>