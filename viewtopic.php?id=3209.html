<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> promiscuous mode?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 6 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p15093">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">aaicr</div>
					<div class="post-datetime">
						8 Nov 2005, 22:18					</div>
				</div>
				<div class="post-content content">
					<p>Been looking for about a week now and does not seem like anyone else has had this problem.&nbsp; -must- just be me then...</p><p>On both a wrt54g v1 and v2 tcpdump seems to only be able to show traffic which is destined for the interface.&nbsp; Though dmesg shows the interface goes into promiscuous mode, tcpdump does not seem to agree.&nbsp; Get the same results on all wired interfaces.&nbsp; ...am not using the wireless interface at all.&nbsp; Only have wan and lan1 plugged in, have tried tcpdump on all interfaces save for eth2 with the same results. </p><p>The goal is just to play with snort (with very limited rules) on a &#039;monitored&#039; switch port.</p><p>some dmesg output:<br />vlan1: dev_set_promiscuity(master, 1)<br />device vlan1 entered promiscuous mode<br />vlan1: dev_set_promiscuity(master, -1)<br />device vlan1 left promiscuous mode</p><p>root@OpenWrt:/# nvram show | sort | more<br />size: 1339 bytes (31429 left)<br />boardnum=42<br />boardtype=bcm94710dev<br />boot_ver=v1.0<br />boot_wait=off<br />clkfreq=125<br />dl_ram_addr=a0001000<br />et0macaddr=00:06:25:EB:9F:16<br />et0mdcport=0<br />et0phyaddr=30<br />et1macaddr=00:06:25:EB:9F:17<br />et1mdcport=1<br />et1phyaddr=30<br />lan_gateway=192.168.0.1<br />lan_ipaddr=192.168.0.12<br />lan_netmask=255.255.255.0<br />os_flash_addr=bfc40000<br />os_ram_addr=80001000<br />pmon_ver=PMON 3.11.30.5<br />scratch=a0180000<br />sdram_config=0x0000<br />sdram_init=0x0419<br />sdram_ncdl=0x00000000<br />sdram_refresh=0x8040<br />watchdog=1000<br />wl0_active_mac=<br />wl0_afterburner_override=-1<br />wl0_antdiv=-1<br />wl0_auth=0<br />wl0_auth_mode=disabled<br />wl0_bcn=100<br />wl0_channel=6<br />wl0_closed=0<br />wl0_corerev=4<br />wl0_country=Worldwide<br />wl0_country_code=AU<br />wl0_dtim=1<br />wl0_frag=2346<br />wl0_frameburst=on<br />wl0_gmode=1<br />wl0_gmode_protection=auto<br />wl0_hwaddr=00:06:25:E8:DC:98<br />wl0_ifname=eth2<br />wl0_infra=1<br />wl0_key1=<br />wl0_key2=<br />wl0_key3=<br />wl0_key4=<br />wl0_key=1<br />wl0_lazywds=1<br />wl0_mac_deny=<br />wl0_mac_list=<br />wl0_maclist=<br />wl0_macmode1=disabled<br />wl0_macmode=disabled<br />wl0_mode=ap<br />wl0_net_mode=mixed<br />wl0_passphrase=<br />wl0_phytype=g<br />wl0_phytypes=g<br />wl0_plcphdr=long<br />wl0_radio=1<br />wl0_radioids=BCM2050<br />wl0_radius_ipaddr=<br />wl0_radius_key=<br />wl0_radius_port=1812<br />wl0_rate=0<br />wl0_rateset=default<br />wl0_rts=2347<br />wl0_ssid=linksys<br />wl0_unit=0<br />wl0_wds=<br />wl0_wep=off<br />wl0_wep_bit=64<br />wl0_wep_buf=<br />wl0_wep_gen=<br />wl0_wep_last=<br />wl0_wpa_gtk_rekey=3600<br />wl0_wpa_psk=<br />wl_country_code=AU<br />root@OpenWrt:/proc/net/vlan# </p><p>Maybe I&#039;ve got the version of libpcap or something?</p><p>root@OpenWrt:/# ipkg status<br />Package: dropbear<br />Status: install ok installed<br />Root: /<br />Conffiles: /etc/init.d/S51dropbear 0f0787230acf61853b7c2dc0ed182d59<br />Version: 0.44test3</p><p>Package: snort<br />Status: install ok installed<br />Root: /<br />Conffiles: /etc/default/snort 718ba1d7ee545058cb911d801a31f417 /etc/snort/snort.conf 2fdd016f652b129ecb884a64fc56a40d /etc/snort/threshold.conf 832db4c78f78ccd6847f228e469d62d0<br />Version: 2.3.3-1</p><p>Package: libnet<br />Status: install ok installed<br />Root: /<br />Version: 1.0.2a-7</p><p>Package: libpcap<br />Status: install ok installed<br />Root: /<br />Version: 0.8.3-1</p><p>Package: libpcre<br />Status: install ok installed<br />Root: /<br />Version: 5.0-3</p><p>Package: libgcc<br />Status: install ok installed<br />Root: /<br />Version: 3.4.4-2</p><p>Package: tcpdump<br />Status: install ok installed<br />Root: /<br />Version: 3.8.3-1</p><br /><p>Thanks.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p15173">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">aaicr</div>
					<div class="post-datetime">
						10 Nov 2005, 09:34					</div>
				</div>
				<div class="post-content content">
					<p>Think I figured it out.&nbsp; The interfaces are switched, so unless you can span from one port to another I should not expect to see all frames.&nbsp; ...makes sense now that I think about it.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p15194">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Void Main</div>
					<div class="post-datetime">
						10 Nov 2005, 23:33					</div>
				</div>
				<div class="post-content content">
					<p>Sniff the bridge interface br0.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p15228">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Rupan</div>
					<div class="post-datetime">
						11 Nov 2005, 11:32					</div>
				</div>
				<div class="post-content content">
					<p>AFAIK wireless is different enough from wierd that promiscuous isn&#039;t enough.&nbsp; If you want to sniff ALL traffic going over the airwaves, you&#039;ll have to bring down the wireless network interface and put it in monitor mode.&nbsp; Then you&#039;ll need some software (such as kismet) to sniff.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p15229">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">Vincent Bernat</div>
					<div class="post-datetime">
						11 Nov 2005, 11:38					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Rupan wrote:</cite><blockquote><p>AFAIK wireless is different enough from wierd that promiscuous isn&#039;t enough.&nbsp; If you want to sniff ALL traffic going over the airwaves, you&#039;ll have to bring down the wireless network interface and put it in monitor mode.&nbsp; Then you&#039;ll need some software (such as kismet) to sniff.</p></blockquote></div><p>When the interface is in monitor mode, tcpdump can sniff too.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p15271">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">aaicr</div>
					<div class="post-datetime">
						12 Nov 2005, 09:29					</div>
				</div>
				<div class="post-content content">
					<p>I appreciate the replies.</p><p>But, I am not using the wireless interface at all.&nbsp; Have it downed actually.&nbsp; <br />I want to sniff all traffic hitting one of the wired interfaces.&nbsp; -I guess- the problem is that since the wired ports are switched, the br0 interface only sees frames the switch will send it (which would be multicast or broadcast frames or frames actually destined to one of the interfaces).&nbsp; On a &quot;regular&quot; switch I would have to set up a port span to mirror all frames the wired port sees to the internal port (port 5, right?).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p15286">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">Void Main</div>
					<div class="post-datetime">
						12 Nov 2005, 15:07					</div>
				</div>
				<div class="post-content content">
					<p>I have never seen a way to select ports for span (monitor/mirroring) so if the capability exists in the switch nobody has exposed it as far as I have seen. This has been asked a few times before. The only way you&#039;ll be able to sniff the traffic on the switch is to either not run it through a switch and plug a hub into one of the ports or separate each port into their own vlan and then sniff each vlan but that&#039;s a lot of extra work and complexity.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>