<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> I can not automatically receive their network settings</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 20 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p97706">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">stockjp</div>
					<div class="post-datetime">
						21 Nov 2009, 06:04					</div>
				</div>
				<div class="post-content content">
					<p>I want to use dhcp server.</p><p>but do not run function.</p><br /><p>[/etc/config/network]</p><p>config &#039;interface&#039; &#039;loopback&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ifname&#039; &#039;lo&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;proto&#039; &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ipaddr&#039; &#039;127.0.0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;netmask&#039; &#039;255.0.0.0&#039;</p><p>config &#039;interface&#039; &#039;lan_l&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;type&#039; &#039;bridge&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ifname&#039; &#039;eth0.0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;proto&#039; &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ipaddr&#039; &#039;192.168.200.11&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;netmask&#039; &#039;255.255.255.0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;gateway&#039; &#039;192.168.200.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;defaultroute&#039; &#039;0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;peerdns&#039; &#039;0&#039;</p><p>config &#039;interface&#039; &#039;lan_r&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;type&#039; &#039;bridge&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ifname&#039; &#039;eth0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;proto&#039; &#039;dhcp&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;ipaddr&#039; &#039;192.168.200.11&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;netmask&#039; &#039;255.255.255.0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;dns&#039; &#039;&#039;</p><p>[/etc/config/dhcp]</p><p>config &#039;dnsmasq&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;domainneeded&#039; &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;boguspriv&#039; &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;localise_queries&#039; &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;domain&#039; &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;expandhosts&#039; &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;authoritative&#039; &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;readethers&#039; &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;leasefile&#039; &#039;/tmp/dhcp.leases&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;resolvfile&#039; &#039;/tmp/resolv.conf.auto&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;local&#039; &#039;/lan_l/&#039;</p><p>config &#039;dhcp&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;interface&#039; &#039;lan_l&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;start&#039; &#039;100&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;limit&#039; &#039;150&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;leasetime&#039; &#039;12h&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option &#039;dynamicdhcp&#039; &#039;1&#039;</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p98327">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">lucapost</div>
					<div class="post-datetime">
						5 Dec 2009, 15:35					</div>
				</div>
				<div class="post-content content">
					<p>I have similar problem, but I don&#039;t like luci,uci, webif, therefore only manual settings for me.</p><p>My interesting is about this dnsmaq option:<br /></p><div class="codebox"><pre><code>    --dhcp-hostsfile=&lt;filename&gt;     Read DHCP host specs from file</code></pre></div><p>Where I set this? In /etc/config/dhcp?<br />What is the correct syntax of &lt;filename&gt;?</p><p>I have wgt634u with 8.09.<br />Thanks, Luca.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p98339">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">blubberdiblub</div>
					<div class="post-datetime">
						5 Dec 2009, 19:29					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>lucapost wrote:</cite><blockquote><p>My interesting is about this dnsmaq option:<br /></p><div class="codebox"><pre><code>    --dhcp-hostsfile=&lt;filename&gt;     Read DHCP host specs from file</code></pre></div><p>Where I set this? In /etc/config/dhcp?<br />What is the correct syntax of &lt;filename&gt;?</p></blockquote></div><p>You could either set this in /etc/dnsmasq.conf with a line saying &quot;dhcp-hostsfile=/path/to/your/file&quot; (there are no double dashes in front of the option when it appears in that config file) or in /etc/config/dhcp in the &quot;config dnsmasq&quot; section with a line like<br /></p><div class="codebox"><pre><code>    option    dhcphostsfile    /path/to/your/file</code></pre></div><p>(note the absence of a dash)</p><p>I would probably prefer setting it in /etc/config/dhcp, since that is more openwrt-like and can easily be operated on with uci.</p><p>Concerning the syntax, <a href="http://www.thekelleys.org.uk/dnsmasq/docs/dnsmasq-man.html">http://www.thekelleys.org.uk/dnsmasq/do … q-man.html</a> says it is the same as what you would put after the --dhcp-host= option, one entry per line.</p><p>But pondering on that, if you don&#039;t really need an extra file and if you also don&#039;t need any of the fancier features of the --dhcp-host option, you should probably consider not using the dhcphostfile option at all and just put all the hosts into /etc/config/dhcp. You do that by creating one section for each host you want to define. Like that:<br /></p><div class="codebox"><pre><code>config host
    option name    foobar
    option mac    00:01:23:ab:cd:ef
    option ip    192.168.1.45
    option dhcp_option    42,192.168.1.1</code></pre></div><p>Option mac and option ip are mandatory. Option name and option dhcp_option are optional, but name is required if you want any of your dhcp_option lines in that section to have an effect.</p><p>Since I for myself only need to map mac addresses to hostnames (the hostnames are mapped to ip addresses in my /etc/hosts file), I don&#039;t even need that possibility, I just use an /etc/ethers file instead.</p><br /><p>Regards,<br />Niels Böhm</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p98379">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">lucapost</div>
					<div class="post-datetime">
						6 Dec 2009, 12:48					</div>
				</div>
				<div class="post-content content">
					<p>thanks you very much for complete details!</p><p>LP</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p98875">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">lucapost</div>
					<div class="post-datetime">
						16 Dec 2009, 17:19					</div>
				</div>
				<div class="post-content content">
					<p>I have another question about dnsmasq config. In my /etc/config/dhcp i have this options<br /></p><div class="codebox"><pre><code>config dnsmasq
       ...
       option expandhosts    1
       ...


config host
        option name             pippo
        option mac              XX:XX:XX:XX:XX:XX
        option ip               192.168.1.2</code></pre></div><p>I think that expandhost setting read only /etc/hosts, and not &quot;config host&quot;. <br />In my client and router i have only &quot;127.0.0.1 localhost&quot; in /etc/hosts, and if I ping my router (it name is openwrt) i get:<br /></p><div class="codebox"><pre><code>#&gt; ping openwrt
ping: unknown host openwrt</code></pre></div><p>Is correct this behaviour? the only way for resolv the name of my clients is insert there in /etc/hosts in my router?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>