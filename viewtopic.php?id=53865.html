<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Re: LZMA ERROR 1 - must RESET</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 29 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p253542">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">donhamilton</div>
					<div class="post-datetime">
						7 Nov 2014, 19:37					</div>
				</div>
				<div class="post-content content">
					<p>My second TL-WR703N is in perpetual reset (message above).</p><p>Is there any cure for this ?</p><p>Here is the serial port messages:</p><p>U-Boot 1.1.4 (Sep 25 2012 - 09:04:47)</p><p>AP121 (ar9330) U-boot</p><p>DRAM:&nbsp; 32 MB<br />led turning on for 1s...<br />id read 0x100000ff<br />flash size 4194304, sector count = 64<br />Flash:&nbsp; 4 MB<br />Using default environment</p><p>In:&nbsp; &nbsp; serial<br />Out:&nbsp; &nbsp;serial<br />Err:&nbsp; &nbsp;serial<br />Net:&nbsp; &nbsp;ag7240_enet_initialize...<br />No valid address in Flash. Using fixed address<br />No valid address in Flash. Using fixed address<br />: cfg1 0x5 cfg2 0x7114<br />eth0: 00:03:7f:09:0b:ad<br />ag7240_phy_setup<br />eth0 up<br />: cfg1 0xf cfg2 0x7214<br />eth1: 00:03:7f:09:0b:ad<br />athrs26_reg_init_lan<br />ATHRS26: resetting s26<br />ATHRS26: s26 reset done<br />ag7240_phy_setup<br />eth1 up<br />eth0, eth1<br />Autobooting in 1 seconds<br />## Booting image at 9f020000 ...<br />&nbsp; &nbsp;Uncompressing Kernel Image ... ERROR: LzmaDecode.c, 543</p><p>Decoding error = 1<br />LZMA ERROR 1 - must RESET</p><p>U-Boot 1.1.4 (Sep 25 2012 - 09:04:47)</p><p>AP121 (ar9330) U-boot</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p253545">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						7 Nov 2014, 20:28					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>donhamilton wrote:</cite><blockquote><p>&nbsp; &nbsp;Uncompressing Kernel Image ... ERROR: LzmaDecode.c, 543</p><p>Decoding error = 1<br />LZMA ERROR 1 - must RESET</p></blockquote></div><p>That sounds quite much like an issue I had with my wndr3700 build 2 years.<br />There the error was on line 547, but probably a slightly different u-boot version.<br />The reason was finally identified as a too wide dictionary in the lzma encoding in the firmware image creation phase.<br />The devs set a special limit for wndr3700, but that was not been set for other routers.</p><p>Read this thread: <a href="https://forum.openwrt.org/viewtopic.php?id=40565">https://forum.openwrt.org/viewtopic.php?id=40565</a><br />(old bug about that: <a href="https://dev.openwrt.org/ticket/12454#comment:14">https://dev.openwrt.org/ticket/12454#comment:14</a> )<br />(and even older discussion <a href="https://lists.openwrt.org/pipermail/openwrt-devel/2012-June/015846.html">https://lists.openwrt.org/pipermail/ope … 15846.html</a> )</p><p>The cure for wndr3700 was to set -d20 paramater, limiting the dictionary size to 2^20 bytes (instead of the old -d23).</p>											<p class="post-edited">(Last edited by <strong>hnyman</strong> on 7 Nov 2014, 20:31)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p253546">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">donhamilton</div>
					<div class="post-datetime">
						7 Nov 2014, 20:32					</div>
				</div>
				<div class="post-content content">
					<p>I got the original Chinese firmware re-loaded.</p><p>Learned how to get W7 to tftp ! :-)</p><p>Now back to&nbsp; openwrt.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p253548">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">donhamilton</div>
					<div class="post-datetime">
						7 Nov 2014, 20:43					</div>
				</div>
				<div class="post-content content">
					<p>My goal was to get Linkduino loaded, and now I have it.</p><p>Thanks for looking.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p373877">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">valentis</div>
					<div class="post-datetime">
						16 Mar 2018, 19:14					</div>
				</div>
				<div class="post-content content">
					<p>Greetings,</p><p>Sorry to reopen a very old thread, but I seem to have the same problem on a UAP. I&#039;m wondering if you could tell me where in the source tree I could change the parameters for the LZMA call that compresses the kernel.</p><p>&nbsp; &nbsp; Thanks,<br />&nbsp; &nbsp; Val</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p373884">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						16 Mar 2018, 20:27					</div>
				</div>
				<div class="post-content content">
					<p>The place depends on your router and the packaging process for the image.</p><p>For ar71xx router wndr3700 the command is in ar71xx generic image Makefile.</p><p><a href="https://git.openwrt.org/?p=openwrt/openwrt.git;a=blob;f=target/linux/ar71xx/image/generic.mk;h=37231e022893ed5e88a350b6e850f2d9b0282eee;hb=HEAD#l567">https://git.openwrt.org/?p=openwrt/open … =HEAD#l567</a></p><br /><p>There is special parameter -d20 to set the dictionary size of 20 bits for lzma compression on line 567<br />For explanations check the links above.</p>											<p class="post-edited">(Last edited by <strong>hnyman</strong> on 16 Mar 2018, 20:28)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p373925">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">valentis</div>
					<div class="post-datetime">
						17 Mar 2018, 18:28					</div>
				</div>
				<div class="post-content content">
					<p>Cool, </p><p>In my .config file I see where you would select the wndr3700 device eg:</p><p>CONFIG_TARGET_ar71xx_generic_DEVICE_wndr3700</p><p>Though since I have an UAP I have this selected instead:</p><p> CONFIG_TARGET_ar71xx_generic_DEVICE_ubnt-unifi=y</p><p>My problem is that in the above Makefile, I don&#039;t see any defines for unifi devices, so I&#039;m still not sure where to put the lmza -d20 change.</p><p>&nbsp; &nbsp;Thanks,<br />&nbsp; &nbsp; Val</p>											<p class="post-edited">(Last edited by <strong>valentis</strong> on 17 Mar 2018, 18:30)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p373927">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						17 Mar 2018, 19:36					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>valentis wrote:</cite><blockquote><p>Though since I have an UAP I have this selected instead:</p><p> CONFIG_TARGET_ar71xx_generic_DEVICE_ubnt-unifi=y</p><p>My problem is that in the above Makefile, I don&#039;t see any defines for unifi devices, so I&#039;m still not sure where to put the lmza -d20 change.</p></blockquote></div><p>If you spend a few minutes browsing the source code tree, you would find the Makefile for ubnt devices....<br /><a href="https://git.openwrt.org/?p=openwrt/openwrt.git;a=blob;f=target/linux/ar71xx/image/generic-ubnt.mk;h=478ac3ea8b10cb71e887596853b18b033e78af02;hb=HEAD#l104">https://git.openwrt.org/?p=openwrt/open … =HEAD#l104</a></p><p>Some of the devices there seem to have the lzma compression step defined.<br />Not sure about your exact device.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>