<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> CBI questions</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 29 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p344724">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">stangri</div>
					<div class="post-datetime">
						25 Nov 2016, 05:02					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve discovered the beauty of CBI and want to create a &quot;Quick WiFi Setup&quot; page, but I have a question.</p><p>Right now this is what my cbi file looks like:<br /></p><div class="codebox"><pre><code>local iface = luci.model.uci.cursor():get_first(&quot;wireless&quot;, &quot;wifi-iface&quot;)
m = Map(&quot;wireless&quot;, &quot;WiFi Quick Config&quot;)
s1 = m:section(NamedSection, iface, &quot;wifi-iface&quot;, &quot;WiFi Options&quot;)
p11 = s1:option(Value,&quot;ssid&quot;,&quot;WiFi Name&quot;)
p12 = s1:option(Value,&quot;key&quot;,&quot;WiFi Password&quot;)
s2 = m:section(NamedSection, &quot;radio0&quot;, &quot;wifi-device&quot;, &quot;WiFi Device Options&quot;)
p21 = s2:option(ListValue, &quot;channel&quot;, &quot;Channel&quot;)
p21:value(&quot;auto&quot;, &quot;Auto Channel&quot;)
p21:value(&quot;1&quot;, &quot;Channel 1&quot;)
p21:value(&quot;2&quot;, &quot;Channel 2&quot;)
p21:value(&quot;3&quot;, &quot;Channel 3&quot;)
p21:value(&quot;4&quot;, &quot;Channel 4&quot;)
p21:value(&quot;5&quot;, &quot;Channel 5&quot;)
p21:value(&quot;6&quot;, &quot;Channel 6&quot;)
p21:value(&quot;7&quot;, &quot;Channel 7&quot;)
p21:value(&quot;8&quot;, &quot;Channel 8&quot;)
p21:value(&quot;9&quot;, &quot;Channel 9&quot;)
p21:value(&quot;10&quot;, &quot;Channel 10&quot;)
p21:value(&quot;11&quot;, &quot;Channel 11&quot;)
return m</code></pre></div><p>And it of course creates two sections (as per screenshot below). <br /><span class="postimg"><img src="https://s18.postimg.org/lr9wegpnd/Screen_Shot_2016_11_24_at_07_45_54.png" alt="https://s18.postimg.org/lr9wegpnd/Screen_Shot_2016_11_24_at_07_45_54.png" /></span></p><p>How can I roll all these settings into one section visually?</p><p>Also, how can I create an item which would depend on another item not containing specific value, but just being non-empty? I want to add the encryption only if the password is non-empty. What&#039;s the best way to do that?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p345324">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">hostle19</div>
					<div class="post-datetime">
						30 Nov 2016, 18:00					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>stangri wrote:</cite><blockquote><p>I&#039;ve discovered the beauty of CBI and want to create a &quot;Quick WiFi Setup&quot; page, but I have a question.</p><p>Right now this is what my cbi file looks like:<br /></p><div class="codebox"><pre><code>local iface = luci.model.uci.cursor():get_first(&quot;wireless&quot;, &quot;wifi-iface&quot;)
m = Map(&quot;wireless&quot;, &quot;WiFi Quick Config&quot;)
s1 = m:section(NamedSection, iface, &quot;wifi-iface&quot;, &quot;WiFi Options&quot;)
p11 = s1:option(Value,&quot;ssid&quot;,&quot;WiFi Name&quot;)
p12 = s1:option(Value,&quot;key&quot;,&quot;WiFi Password&quot;)
s2 = m:section(NamedSection, &quot;radio0&quot;, &quot;wifi-device&quot;, &quot;WiFi Device Options&quot;)
p21 = s2:option(ListValue, &quot;channel&quot;, &quot;Channel&quot;)
p21:value(&quot;auto&quot;, &quot;Auto Channel&quot;)
p21:value(&quot;1&quot;, &quot;Channel 1&quot;)
p21:value(&quot;2&quot;, &quot;Channel 2&quot;)
p21:value(&quot;3&quot;, &quot;Channel 3&quot;)
p21:value(&quot;4&quot;, &quot;Channel 4&quot;)
p21:value(&quot;5&quot;, &quot;Channel 5&quot;)
p21:value(&quot;6&quot;, &quot;Channel 6&quot;)
p21:value(&quot;7&quot;, &quot;Channel 7&quot;)
p21:value(&quot;8&quot;, &quot;Channel 8&quot;)
p21:value(&quot;9&quot;, &quot;Channel 9&quot;)
p21:value(&quot;10&quot;, &quot;Channel 10&quot;)
p21:value(&quot;11&quot;, &quot;Channel 11&quot;)
return m</code></pre></div><p>And it of course creates two sections (as per screenshot below). <br /><span class="postimg"><img src="https://s18.postimg.org/lr9wegpnd/Screen_Shot_2016_11_24_at_07_45_54.png" alt="https://s18.postimg.org/lr9wegpnd/Screen_Shot_2016_11_24_at_07_45_54.png" /></span></p><p>How can I roll all these settings into one section visually?</p><p>Also, how can I create an item which would depend on another item not containing specific value, but just being non-empty? I want to add the encryption only if the password is non-empty. What&#039;s the best way to do that?</p></blockquote></div><br /><p>not sure if this is what you&#039;re after...</p><div class="codebox"><pre><code>local iface = luci.model.uci.cursor():get_first(&quot;wireless&quot;, &quot;wifi-iface&quot;)
m = Map(&quot;wireless&quot;, &quot;WiFi Quick Config&quot;)
s1 = m:section(NamedSection, iface, &quot;wifi-iface&quot;, &quot;WiFi Options&quot;)
p11 = s1:option(Value,&quot;ssid&quot;,&quot;WiFi Name&quot;)
p12 = s1:option(Value,&quot;key&quot;,&quot;WiFi Password&quot;)
p12.password = true
p21 = s1:option(ListValue, &quot;channel&quot;, &quot;Channel&quot;)
p21:value(&quot;auto&quot;, &quot;Auto Channel&quot;)
p21:value(&quot;1&quot;, &quot;Channel 1&quot;)
p21:value(&quot;2&quot;, &quot;Channel 2&quot;)
p21:value(&quot;3&quot;, &quot;Channel 3&quot;)
p21:value(&quot;4&quot;, &quot;Channel 4&quot;)
p21:value(&quot;5&quot;, &quot;Channel 5&quot;)
p21:value(&quot;6&quot;, &quot;Channel 6&quot;)
p21:value(&quot;7&quot;, &quot;Channel 7&quot;)
p21:value(&quot;8&quot;, &quot;Channel 8&quot;)
p21:value(&quot;9&quot;, &quot;Channel 9&quot;)
p21:value(&quot;10&quot;, &quot;Channel 10&quot;)
p21:value(&quot;11&quot;, &quot;Channel 11&quot;)
return m</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p345353">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">stangri</div>
					<div class="post-datetime">
						1 Dec 2016, 00:05					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>hostle19 wrote:</cite><blockquote><p>not sure if this is what you&#039;re after...</p><div class="codebox"><pre><code>local iface = luci.model.uci.cursor():get_first(&quot;wireless&quot;, &quot;wifi-iface&quot;)
m = Map(&quot;wireless&quot;, &quot;WiFi Quick Config&quot;)
s1 = m:section(NamedSection, iface, &quot;wifi-iface&quot;, &quot;WiFi Options&quot;)
p11 = s1:option(Value,&quot;ssid&quot;,&quot;WiFi Name&quot;)
p12 = s1:option(Value,&quot;key&quot;,&quot;WiFi Password&quot;)
p12.password = true
p21 = s1:option(ListValue, &quot;channel&quot;, &quot;Channel&quot;)
p21:value(&quot;auto&quot;, &quot;Auto Channel&quot;)
p21:value(&quot;1&quot;, &quot;Channel 1&quot;)
p21:value(&quot;2&quot;, &quot;Channel 2&quot;)
p21:value(&quot;3&quot;, &quot;Channel 3&quot;)
p21:value(&quot;4&quot;, &quot;Channel 4&quot;)
p21:value(&quot;5&quot;, &quot;Channel 5&quot;)
p21:value(&quot;6&quot;, &quot;Channel 6&quot;)
p21:value(&quot;7&quot;, &quot;Channel 7&quot;)
p21:value(&quot;8&quot;, &quot;Channel 8&quot;)
p21:value(&quot;9&quot;, &quot;Channel 9&quot;)
p21:value(&quot;10&quot;, &quot;Channel 10&quot;)
p21:value(&quot;11&quot;, &quot;Channel 11&quot;)
return m</code></pre></div></blockquote></div><p>That doesn&#039;t work because there&#039;s no channel option in wifi-iface section.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p345373">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">hostle19</div>
					<div class="post-datetime">
						1 Dec 2016, 03:20					</div>
				</div>
				<div class="post-content content">
					<p>you can just remove the title from the second section .. this will just space it a little different. Other than that I think its more work then it&#039;s worth ...</p><div class="codebox"><pre><code>local iface = luci.model.uci.cursor():get_first(&quot;wireless&quot;, &quot;wifi-iface&quot;)
m = Map(&quot;wireless&quot;, &quot;WiFi Quick Config&quot;)
s1 = m:section(NamedSection, iface, &quot;wifi-iface&quot;, &quot;WiFi Options&quot;)
p11 = s1:option(Value,&quot;ssid&quot;,&quot;WiFi Name&quot;)
p12 = s1:option(Value,&quot;key&quot;,&quot;WiFi Password&quot;)
p12.password = true
s2 = m:section(NamedSection, &quot;radio0&quot;, &quot;wifi-device&quot;)
p21 = s2:option(ListValue, &quot;channel&quot;, &quot;Channel&quot;)
p21:value(&quot;auto&quot;, &quot;Auto Channel&quot;)
for i=1,11 do
 p21:value(i, &quot;Channel &quot;..i)
end
return m</code></pre></div>											<p class="post-edited">(Last edited by <strong>hostle19</strong> on 1 Dec 2016, 05:26)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p345404">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">stangri</div>
					<div class="post-datetime">
						1 Dec 2016, 16:54					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for your suggestion, it would still show channel in a separate cbi-box. I&#039;m guessing the answer to my quest would be use of templates to combine configs from different sections into one &quot;box&quot;.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>