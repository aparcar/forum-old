<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> How to make use of /tmp space for packages?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 15 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p97210">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">dosser</div>
					<div class="post-datetime">
						11 Nov 2009, 14:56					</div>
				</div>
				<div class="post-content content">
					<p>Hey folks,</p><p>Been using OpenWRT successfully for about a year now and love it. Recently I&#039;ve wanted to be able to use typical Linux apps like dig, host, etc from the router itself like any other Linux terminal. However whenever I try to install the respective utility, in this case bind-dig, it fails due to lack of space for related dependencies.</p><p>My question really is - how do I make use of what seems to be almost 7Mb of unused space in /tmp for installing packages? I did try adding the following to opkg.conf:</p><p>dest test /tmp/pkgs</p><p>in order to try to force the package install to /tmp but still the same error:</p><p>root@OpenWrt:~# cat /etc/opkg.conf <br />src/gz snapshots <a href="http://downloads.openwrt.org/kamikaze/8.09.1/brcm-2.4/packages">http://downloads.openwrt.org/kamikaze/8 … 4/packages</a><br />dest root /<br />dest ram /tmp<br />lists_dir ext /var/opkg-lists<br />option overlay_root /jffs<br />src X-Wrt <a href="http://downloads.x-wrt.org/xwrt/kamikaze/8.09/brcm-2.4/packages">http://downloads.x-wrt.org/xwrt/kamikaz … 4/packages</a><br />root@OpenWrt:~# echo dest test /tmp/pkgs/ &gt;&gt; /etc/opkg.conf <br />root@OpenWrt:~# <br />root@OpenWrt:~# cat /etc/opkg.conf <br />src/gz snapshots <a href="http://downloads.openwrt.org/kamikaze/8.09.1/brcm-2.4/packages">http://downloads.openwrt.org/kamikaze/8 … 4/packages</a><br />dest root /<br />dest ram /tmp<br />lists_dir ext /var/opkg-lists<br />option overlay_root /jffs<br />src X-Wrt <a href="http://downloads.x-wrt.org/xwrt/kamikaze/8.09/brcm-2.4/packages">http://downloads.x-wrt.org/xwrt/kamikaz … 4/packages</a><br />dest test /tmp/pkgs/<br />root@OpenWrt:~# <br />root@OpenWrt:~# opkg update<br />Downloading <a href="http://downloads.openwrt.org/kamikaze/8.09.1/brcm-2.4/packages/Packages.gz">http://downloads.openwrt.org/kamikaze/8 … ackages.gz</a><br />Connecting to downloads.openwrt.org (78.24.191.177:80)<br />Packages.gz&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 100% |*******************************|&nbsp; &nbsp;130k 00:00:00 ETA<br />Inflating <a href="http://downloads.openwrt.org/kamikaze/8.09.1/brcm-2.4/packages/Packages.gz">http://downloads.openwrt.org/kamikaze/8 … ackages.gz</a><br />Updated list of available packages in /var/opkg-lists/snapshots<br />Downloading <a href="http://downloads.x-wrt.org/xwrt/kamikaze/8.09/brcm-2.4/packages/Packages">http://downloads.x-wrt.org/xwrt/kamikaz … s/Packages</a><br />Connecting to downloads.x-wrt.org (88.198.39.176:80)<br />Packages&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;100% |*******************************| 64346&nbsp; --:--:-- ETA<br />Updated list of available packages in /var/opkg-lists/X-Wrt<br />root@OpenWrt:~# <br />root@OpenWrt:~# <br />root@OpenWrt:~# opkg -dest test install bind-dig<br />Installing bind-dig (9.5.0-P1-1.1) to test...<br />Downloading <a href="http://downloads.openwrt.org/kamikaze/8.09.1/brcm-2.4/packages/bind-dig_9.5.0-P1-1.1_mipsel.ipk">http://downloads.openwrt.org/kamikaze/8 … mipsel.ipk</a><br />Connecting to downloads.openwrt.org (78.24.191.177:80)<br />bind-dig_9.5.0-P1-1. 100% |*******************************| 32240&nbsp; --:--:-- ETA<br />Installing bind-libs (9.5.0-P1-1.1) to test...<br />Collected errors:<br /> * Only have 1100 available blocks on filesystem /tmp/pkgs/, pkg bind-libs needs 1883<br />root@OpenWrt:~# </p><br /><p>I have some Linux experience but am well aware that this could come back to my lack of understanding of mount points, filesystems, etc <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>Any help would be really appreciated cause it&#039;s doing my head in <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p97211">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">dosser</div>
					<div class="post-datetime">
						11 Nov 2009, 14:58					</div>
				</div>
				<div class="post-content content">
					<p>Some background:</p><p>root@OpenWrt:~# uname -a<br />Linux OpenWrt 2.4.35.4 #12 Mon Jun 1 21:52:49 UTC 2009 mips unknown</p><p>on WRT54GL v1.1</p><p>root@OpenWrt:~# df -h<br />Filesystem&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Size&nbsp; &nbsp; &nbsp; Used Available Use% Mounted on<br />rootfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1.6M&nbsp; &nbsp; &nbsp; 1.6M&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 100% /<br />/dev/root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1.6M&nbsp; &nbsp; &nbsp; 1.6M&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 100% /rom<br />tmpfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;7.0M&nbsp; &nbsp; 788.0k&nbsp; &nbsp; &nbsp; 6.2M&nbsp; 11% /tmp<br />/dev/mtdblock/4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1.7M&nbsp; &nbsp; 628.0k&nbsp; &nbsp; &nbsp; 1.1M&nbsp; 36% /jffs<br />mini_fo:/jffs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1.6M&nbsp; &nbsp; &nbsp; 1.6M&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 100% /</p>											<p class="post-edited">(Last edited by <strong>dosser</strong> on 11 Nov 2009, 14:59)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p97214">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						11 Nov 2009, 15:16					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dosser wrote:</cite><blockquote><p>My question really is - how do I make use of what seems to be almost 7Mb of unused space in /tmp for installing packages?</p></blockquote></div><p>AFAIK, /tmp is volatile RAM space. In other words, everything stored on /tmp directory will vanish when the device is power cycle. So, it makes no sense trying to install a package on /tmp</p><p>I looks like the <strong>/jffs</strong> partition on your device only has about 1.1M space left that can be used to hold writable files + additional packages.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p97223">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">dosser</div>
					<div class="post-datetime">
						11 Nov 2009, 16:50					</div>
				</div>
				<div class="post-content content">
					<p>many thanks for the pointer, and yes - I agree re the /tmp being a ramdisk as I found this pointed out somewhere too.</p><p>I tried using /jffs but same issue <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>root@OpenWrt:/jffs# cat /etc/opkg.conf <br />src/gz snapshots <a href="http://downloads.openwrt.org/kamikaze/8.09.1/brcm-2.4/packages">http://downloads.openwrt.org/kamikaze/8 … 4/packages</a><br />dest root /<br />dest ram /tmp<br />lists_dir ext /var/opkg-lists<br />option overlay_root /jffs<br />src X-Wrt <a href="http://downloads.x-wrt.org/xwrt/kamikaze/8.09/brcm-2.4/packages">http://downloads.x-wrt.org/xwrt/kamikaz … 4/packages</a><br />dest test /tmp/pkgs/<br />dest pkgs /jffs/pkgs/<br />root@OpenWrt:/jffs# <br />root@OpenWrt:/jffs# opkg -dest pkgs install bind-dig<br />Installing bind-dig (9.5.0-P1-1.1) to pkgs...<br />Downloading <a href="http://downloads.openwrt.org/kamikaze/8.09.1/brcm-2.4/packages/bind-dig_9.5.0-P1-1.1_mipsel.ipk">http://downloads.openwrt.org/kamikaze/8 … mipsel.ipk</a><br />Connecting to downloads.openwrt.org (78.24.191.177:80)<br />bind-dig_9.5.0-P1-1. 100% |******************************************************************| 32240&nbsp; --:--:-- ETA<br />Installing bind-libs (9.5.0-P1-1.1) to pkgs...<br />Collected errors:<br /> * Only have 1100 available blocks on filesystem /jffs/pkgs/, pkg bind-libs needs 1883<br />root@OpenWrt:/jffs# </p><p>so it seems that I&#039;m stuck with what I&#039;ve got as determined by available flash space on the 54GL...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p97226">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						11 Nov 2009, 18:08					</div>
				</div>
				<div class="post-content content">
					<p>Remember, your <strong>/jffs</strong> partition only had 1.1MB space left. If you tried to install a package of size near to 1MB in size, chances are it won&#039;t get installed unless the *.ipkg in not in compressed mode.</p><p>Off topic. Your router seemed to have very small amount of Flash space. Why hack it to add an SD card. I have my Netgear WGT634U boots off of an external USB memory stick with a 25MB swapped space (see below).<br /></p><div class="codebox"><pre><code>BusyBox v1.14.4 (2009-11-08 15:30:32 EST) built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 KAMIKAZE (bleeding edge, r18352) ------------------
  * 10 oz Vodka       Shake well with ice and strain
  * 10 oz Triple sec  mixture into 10 shot glasses.
  * 10 oz lime juice  Salute!
 ---------------------------------------------------
root@WGT634U:~# df
Filesystem           1K-blocks      Used Available Use% Mounted on
/dev/root                 1920      1920         0 100% /usb/sda1/rom
tmpfs                    14536        72     14464   0% /tmp
tmpfs                      512         0       512   0% /dev
/dev/mtdblock3            4480       396      4084   9% /jffs
mini_fo:/jffs             1920      1920         0 100% /usb/sda1
/dev/sda1               463444     19334    420182   4% /</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p97228">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">dosser</div>
					<div class="post-datetime">
						11 Nov 2009, 19:00					</div>
				</div>
				<div class="post-content content">
					<p>thanks for your reply, yeah - adding the SD card was something I was looking at, however for the functionality I require it may not justify the effort required. </p><p>Essentially I wanted to make sure that there wasn&#039;t something / some trick that I was missing to allow me to add more packages to the router to make it more usable for what I want.</p><p>Seems like there&#039;s no secret <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>Cheers for the dig out, I&#039;ll have a think about the SD stuff, think I&#039;ve seen some guides elsewhere on the wiki on how to do that procedure...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p97250">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">rmbell</div>
					<div class="post-datetime">
						12 Nov 2009, 06:30					</div>
				</div>
				<div class="post-content content">
					<p>It is a fairly easy process to add an SD card, and its quite rewarding <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><div class="codebox"><pre><code>BusyBox v1.11.2 (2009-09-06 23:21:43 UTC) built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 KAMIKAZE (8.09.2-RC2, r17574) -------------------------
  * 10 oz Vodka       Shake well with ice and strain
  * 10 oz Triple sec  mixture into 10 shot glasses.
  * 10 oz lime juice  Salute!
 ---------------------------------------------------
root@OpenWrt:~# df -h
Filesystem                Size      Used Available Use% Mounted on
rootfs                  725.6M     30.9M    657.8M   4% /
/dev/root                 1.6M      1.6M         0 100% /rom
tmpfs                     7.0M     52.0k      7.0M   1% /tmp
/dev/mtdblock/4           1.7M      1.3M    412.0k  76% /jffs
mini_fo:/jffs             1.6M      1.6M         0 100% /mnt
/dev/mmc/disc0/part1    725.6M     30.9M    657.8M   4% /
mini_fo:/jffs             1.6M      1.6M         0 100% /etc
root@OpenWrt:~# free
              total         used         free       shared      buffers
  Mem:        14344        14012          332            0         1480
 Swap:       251188            0       251188
Total:       265532        14012       251520</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p247402">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">xnagyg</div>
					<div class="post-datetime">
						18 Sep 2014, 16:46					</div>
				</div>
				<div class="post-content content">
					<p>For the records - if you know you have enough space:<br />you have to change the line<br />option overlay_root /jffs<br />to <br />option overlay_root /</p><p>as opkg has a bug to check the free space independent of the destination</p><p>or you can specify the opkg parameter to<br />--force-space&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Disable free space checks</p>											<p class="post-edited">(Last edited by <strong>xnagyg</strong> on 18 Sep 2014, 16:46)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p247472">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">dpsi</div>
					<div class="post-datetime">
						19 Sep 2014, 11:08					</div>
				</div>
				<div class="post-content content">
					<p>In all seriousness, how can we have opkg install to /tmp. lets say i wanted to install nano or iftop temporarily.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p247481">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">written_direcon</div>
					<div class="post-datetime">
						19 Sep 2014, 13:15					</div>
				</div>
				<div class="post-content content">
					<p>Why not trying to set the overlay to the ram disk?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p247483">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">zo0ok</div>
					<div class="post-datetime">
						19 Sep 2014, 13:45					</div>
				</div>
				<div class="post-content content">
					<p>I downloaded nano, and unpacked it:</p><div class="codebox"><pre><code>root@OpenWrt:/tmp# opkg update
Downloading http://downloads.openwrt.org/barrier_breaker/14.07-rc2/brcm47xx/legacy/packages/Packages.gz.
Updated list of available packages in /var/opkg-lists/barrier_breaker.
root@OpenWrt:/tmp# opkg download nano
Downloading http://downloads.openwrt.org/barrier_breaker/14.07-rc2/brcm47xx/legacy/packages/nano_2.3.6-1_brcm47xx.ipk.
Downloaded nano as ./nano_2.3.6-1_brcm47xx.ipk.
root@OpenWrt:/tmp# mkdir nanotmp
root@OpenWrt:/tmp# cd nanotmp/
root@OpenWrt:/tmp/nanotmp# tar -xzf ../nano_2.3.6-1_brcm47xx.ipk 
root@OpenWrt:/tmp/nanotmp# ls -l
-rw-r--r--    1 1000     1000           373 Jul 27 13:34 control.tar.gz
-rw-r--r--    1 1000     1000         28157 Jul 27 13:34 data.tar.gz
-rw-r--r--    1 1000     1000             4 Jul 27 13:34 debian-binary
root@OpenWrt:/tmp/nanotmp# tar -xzf data.tar.gz 
root@OpenWrt:/tmp/nanotmp# ls
control.tar.gz  data.tar.gz     debian-binary   usr
root@OpenWrt:/tmp/nanotmp# cd usr/
root@OpenWrt:/tmp/nanotmp/usr# ls
bin
root@OpenWrt:/tmp/nanotmp/usr# cd bin/
root@OpenWrt:/tmp/nanotmp/usr/bin# ls
nano
root@OpenWrt:/tmp/nanotmp/usr/bin# ./nano 
./nano: can&#039;t load library &#039;libncurses.so.5&#039;</code></pre></div><p>So that works... but I also need to install libncurses (which I dont want to). But if I did the same with libncurses I would probably just need to symlink the so-file somewhere in tmp to /usr/lib.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>