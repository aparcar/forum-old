<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> WRT54G V 2.0 flashes via tftp but doesnt boot anyway</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 23 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p7229">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">PietR</div>
					<div class="post-datetime">
						16 May 2005, 22:03					</div>
				</div>
				<div class="post-content content">
					<p>Brick or not a Brick - please help !!!<br />Hi, <br />I flashed an OpenWRT in my WRT54G V2.0 and tried to flash anoter firmware over tftp but ter must be an failure so the PowerLED does not stop flashing after a restart. <br />To find out what happens I connected an Serial Interface to the console and looked after the Boot Process.<br />...<br />&quot;Boot Program checksum is invalid&quot;<br />...<br />Reading :: Failed ::Timeout occured<br />...<br />CFE&gt; <br />I ensured to set the boot_wait=on</p><p>OK </p><p>So I tried to upload an Linksys Firmware V2.02 US (Size &lt;3MB) via tftp<br />my Client told my that all the Bytes were sent propperly and the serial Console said CODE pattern is correct and started programming to fname=flash1.trx <br />Programming...done. 2929632 bytes written <br />after that the router did not come up and showed the <br />Error Message:<br />Loading: 376832 bytes read<br />Failed.<br />Could not load flash0.os:: Error</p><br /><p>So my Questions:<br />How can I fix my Router?<br />or if itÂ´not that easy answered...</p><p>How can I Flash an flash0.os, how do i obtain an working flash0.os? <br />Where do I find a Description about the Devices and their contents? </p><p>Who has experiences in fixing the complete Flash Devices </p><p>Will I be Happy after soldering&nbsp; an JTAG aund using it?<br />and How?</p><p>Thanx in Advance - ItÂ´s hard to get an V2.0 these days.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p7241">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">frogzoo</div>
					<div class="post-datetime">
						17 May 2005, 04:43					</div>
				</div>
				<div class="post-content content">
					<p>If you&#039;ve got a serial interface, you&#039;re well on your way to a fully working WRT54 - can&#039;t wait till some sensible manufacturer makes them like this off the shelf.</p><p>Re: Your problems flashing, see post <a href="http://openwrt.org/forum/viewtopic.php?id=1523">http://openwrt.org/forum/viewtopic.php?id=1523</a></p><p>Things that might make the difference:<br />1 - setting rexmt to 1<br />2 - using binary mode/not text</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p7256">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">TheRoDent</div>
					<div class="post-datetime">
						17 May 2005, 13:08					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve found the CFE ethernet driver for the V2.2&#039;s as flakey as the kernel driver, if the CPU isn&#039;t slightly overclocked.<br />This causes random TFTP aborts, and transfer errors which isn&#039;t always visible without turning on the TFTP verbose, and trace options.</p><p>If you have a serial console, do an nvram set clkfreq=216 in the CFE, and see if your TFTP&#039;s work better.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p7272">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">PietR</div>
					<div class="post-datetime">
						17 May 2005, 20:57					</div>
				</div>
				<div class="post-content content">
					<p>Hi <br />Thanks for your replies!<br />so first i Tried the tftp script:<br />after setting boot wait I Powered on the Device...<br />and uploaded the file (identical size below as the .bin file)</p><p>CFE version 1.0.37 for BCM947XX (32bit,SP,LE)<br />Build Date: Fri Feb 27 15:23:38 CST 2004 (root@honor)<br />Copyright (C) 2000,2001,2002,2003 Broadcom Corporation.</p><p>Initializing Arena.<br />Initializing Devices.<br />et0: Broadcom BCM47xx 10/100 Mbps Ethernet Controller 3.50.21.0<br />CPU type 0x29007: 200MHz<br />Total memory: 0x2000000 bytes (32MB)</p><p>Total memory used by CFE:&nbsp; 0x80334DC0 - 0x8043A310 (1070416)<br />Initialized Data:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x80334DC0 - 0x80336F40 (8576)<br />BSS Area:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x80336F40 - 0x80338310 (5072)<br />Local Heap:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x80338310 - 0x80438310 (1048576)<br />Stack Area:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x80438310 - 0x8043A310 (8192)<br />Text (code) segment:&nbsp; &nbsp; &nbsp; &nbsp;0x80300000 - 0x8030F220 (61984)<br />Boot area (physical):&nbsp; &nbsp; &nbsp; 0x0043B000 - 0x0047B000<br />Relocation Factor:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;I:00000000 - D:00000000</p><p>Boot version: v2.3<br />The boot is CFE</p><p>mac_init(): Find mac [00:****] in location 1<br />Nothing...<br />Device eth0:&nbsp; hwaddr 00****, ipaddr 192.168.1.1, mask 255.255.255.0<br />&nbsp; &nbsp; &nbsp; &nbsp; gateway not set, nameserver not set<br />Boot program checksum is invalid<br />Reading :: CODE Pattern is CORRECT!<br />upgrade_ver[v2.0.8] upgrade_ver[20008] 4712_ver[15000]<br />Done. 2929664 bytes read<br />fname=flash1.trx <br />CODE Pattern is correct!<br />Programming...done. 2929632 bytes written<br />Loader:raw Filesys:raw Dev:flash0.os File: Options:(null)<br />Loading: .. 376832 bytes read<br />Failed.<br />Could not load flash0.os:: Error<br />CFE&gt;</p><p>but still no Luck...</p><p>How can I flash the flash0.os, has anyone a working image?</p>											<p class="post-edited">(Last edited by <strong>PietR</strong> on 18 May 2005, 21:03)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p7275">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">PietR</div>
					<div class="post-datetime">
						17 May 2005, 21:15					</div>
				</div>
				<div class="post-content content">
					<p>Hi, here is the next trial with the Overclocking - still no Luck!</p><p>nvram get clkfreq<br />200<br />*** command status = 0<br />CFE&gt; nvram set clkfreq=216<br />*** command status = 0<br />CFE&gt; nvram commit<br />*** command status = 0<br />CFE&gt; nvram set boot_wait=onn<br />*** command status = 0<br />CFE&gt; nvram commit<br />*** command status = 0<br />CFE&gt; nvram show<br />os_ram_addr=80001000<br />il0macaddr=00:90:******<br />boardrev=0x10<br />et0macaddr=00:0F:*******<br />watchdog=5000<br />boot_wait=on<br />et0mdcport=0<br />pmon_ver=CFE 3.51.21.0<br />gpio2=adm_eecs<br />gpio3=adm_eesk<br />vlan0ports=1 2 3 4 5*<br />gpio5=adm_eedi<br />gpio6=adm_rc<br />os_flash_addr=bfc40000<br />sromrev=2<br />boardtype=0x0101<br />lan_netmask=255.255.255.0<br />wl0id=0x4320<br />ag0=255<br />wl0gpio2=0<br />wl0gpio3=0<br />boardflags2=0<br />pa0itssit=62<br />cctl=0<br />pa0maxpwr=0x48<br />clkfreq=216<br />lan_ipaddr=192.168.1.1<br />aa0=3<br />vlan1hwname=et0<br />sdram_config=0x0032<br />vlan1ports=0 5<br />scratch=a0180000<br />ccode=0<br />boardflags=0x0188<br />sdram_refresh=0x0000<br />sdram_ncdl=0x21<br />et0phyaddr=30<br />pa0b0=0x170c<br />pa0b1=0xfa24<br />pa0b2=0xfe70<br />sdram_init=0x0000<br />vlan0hwname=et0<br />dl_ram_addr=a0001000<br />boot_ver=v2.3<br />boardnum=42<br />size: 730 bytes (32038 left)<br />*** command status = 0<br />CFE&gt; <br />###Power OFF###<br />CFE version 1.0.37 for BCM947XX (32bit,SP,LE)<br />Build Date: Fri Feb 27 15:23:38 CST 2004 (root@honor)<br />Copyright (C) 2000,2001,2002,2003 Broadcom Corporation.</p><p>Initializing Arena.<br />Initializing Devices.<br />et0: Broadcom BCM47xx 10/100 Mbps Ethernet Controller 3.50.21.0<br />CPU type 0x29007: 252MHz<br />Total memory: 0x2000000 bytes (32MB)</p><p>Total memory used by CFE:&nbsp; 0x80334DC0 - 0x8043A310 (1070416)<br />Initialized Data:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x80334DC0 - 0x80336F40 (8576)<br />BSS Area:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x80336F40 - 0x80338310 (5072)<br />Local Heap:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x80338310 - 0x80438310 (1048576)<br />Stack Area:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x80438310 - 0x8043A310 (8192)<br />Text (code) segment:&nbsp; &nbsp; &nbsp; &nbsp;0x80300000 - 0x8030F220 (61984)<br />Boot area (physical):&nbsp; &nbsp; &nbsp; 0x0043B000 - 0x0047B000<br />Relocation Factor:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;I:00000000 - D:00000000</p><p>Boot version: v2.3<br />The boot is CFE</p><p>mac_init(): Find mac [00:****] in location 1<br />Nothing...<br />Device eth0:&nbsp; hwaddr 00-**** ipaddr 192.168.1.1, mask 255.255.255.0<br />&nbsp; &nbsp; &nbsp; &nbsp; gateway not set, nameserver not set<br />Boot program checksum is invalid<br />Reading :: CODE Pattern is CORRECT!<br />upgrade_ver[v2.0.8] upgrade_ver[20008] 4712_ver[15000]<br />Done. 2929664 bytes read<br />fname=flash1.trx <br />CODE Pattern is correct!<br />Programming...done. 2929632 bytes written<br />Loader:raw Filesys:raw Dev:flash0.os File: Options:(null)<br />Loading: .. 376832 bytes read<br />Failed.<br />Could not load flash0.os:: Error<br />CFE&gt; nvram set clkfreq=200<br />*** command status = 0<br />CFE&gt; nvram commit<br />*** command status = 0<br />CFE&gt; reboot</p>											<p class="post-edited">(Last edited by <strong>PietR</strong> on 18 May 2005, 21:02)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p7334">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">PietR</div>
					<div class="post-datetime">
						18 May 2005, 21:00					</div>
				</div>
				<div class="post-content content">
					<p>Hi,<br />i found it out!!<br />To get a tftp I shorted Pin 15 and 16 of the flash with a Multimeter and Must have made a permanent connection with it. <br />After I warmed it with a soldering Iron I could flash it as promised. Now I can go for new Adventueres - Thanks!<br />p.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p7899">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">NathanA</div>
					<div class="post-datetime">
						2 Jun 2005, 06:05					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>PietR wrote:</cite><blockquote><p>Hi,<br />i found it out!!<br />To get a tftp I shorted Pin 15 and 16 of the flash with a Multimeter and Must have made a permanent connection with it. <br />After I warmed it with a soldering Iron I could flash it as promised. Now I can go for new Adventueres - Thanks!<br />p.</p></blockquote></div><p>You, sir...</p><p>...ARE MY FREAKING HERO!!!!!</p><p>After <a href="http://openwrt.org/forum/viewtopic.php?id=1418">this debacle</a>, I was sure that I had just managed to flush the money used to purchase my Trendnet router down the toilet and had despaired of ever managing to fix the router.</p><p>However, after I read your post, I figured, what have I got to lose?</p><p>I took a tack, and used it to scrape between the spaces of the pins I had been shorting earlier with a small &quot;jewlers&quot; screwdriver, just to make sure that there was no material in between that would be causing a short.&nbsp; Then I brought out the soldering iron and ever-so-gently tried to warm up the solder just in case there was a break in the connection or a cold solder joint or something.</p><p>I plugged it in, hooked the JTAG cable up, and BOY, was I ever surprised and relieved to see that it was ACTUALLY READING AND WRITING DATA!!!!&nbsp; IT&#039;S ALIVE!!&nbsp; And now that I have the JTAG soldered on, I can go about fixing my earlier mistake that started this whole mess.</p><p>Thank you!!</p><p>-- Nathan</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>