<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> OpenWRT RPi and I2C</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 6 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p342222">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">kb06</div>
					<div class="post-datetime">
						27 Oct 2016, 00:46					</div>
				</div>
				<div class="post-content content">
					<p>Dear,</p><p>I have bought i2c for my RPi 1 and tried to run HD44780 LCD.<br />Unfortunately without any luck. I have OpenWRT from trunk, I&#039;ve installed packages responsible for i2c and gpio:</p><div class="codebox"><pre><code>i2c-tools - 3.1.2-1
kmod-i2c-algo-bit - 4.4.14-1
kmod-i2c-algo-pcf - 4.4.14-1
kmod-i2c-bcm2708 - 4.4.14-1
kmod-i2c-bcm2835 - 4.4.14-1
kmod-i2c-core - 4.4.14-1
kmod-i2c-gpio - 4.4.14-1
kmod-i2c-gpio-custom - 4.4.14-2
kmod-i2c-mux - 4.4.14-1</code></pre></div><div class="codebox"><pre><code>kmod-gpio-pca953x - 4.4.14-1
kmod-gpio-pcf857x - 4.4.14-1
kmod-i2c-gpio - 4.4.14-1
kmod-i2c-gpio-custom - 4.4.14-2
kmod-spi-gpio - 4.4.14-1</code></pre></div><p>...and nothing. i2c still not detected in /dev<br />Below photos of my i2c and rpi. I hope everything is connected fine...</p><p><span class="postimg"><img src="http://kab.pl/i2c/i2c.jpg" alt="http://kab.pl/i2c/i2c.jpg" /></span><br /><span class="postimg"><img src="http://kab.pl/i2c/rpi.jpg" alt="http://kab.pl/i2c/rpi.jpg" /></span></p><p>And at the end of the post all installed packages from openwrt.<br />Any ideas what I am doing wrong?</p><div class="codebox"><pre><code>root@OpenWrt:~# opkg list-installed
ath9k-htc-firmware - 2016-01-25-52442afee9907bc32a058f22bb3295d040677c26-1
base-files - 169-12009
brcm2708-gpu-fw - 2016-06-08-70143fe9d371cd6486a80d6765e93b5574212b64
busybox - 1.24.2-1
dnsmasq - 2.76-1
dropbear - 2016.74-1
eudev - 3.2-1
firewall - 2016-01-29
fstools - 2016-07-24-addd7dc21fe99f2701c1d4708071578052af401d
hostapd - 2016-06-15-1
hostapd-common - 2016-06-15-1
hostapd-common-old - 2016-06-15-1
hostapd-utils - 2016-06-15-1
i2c-tools - 3.1.2-1
ip6tables - 1.4.21-2
iptables - 1.4.21-2
iw - 4.3-1
jshn - 2016-07-29-290c64ef5b5c3e75be851594f269d6a9568e64e5
jsonfilter - 2016-07-02-dea067ad67d977c247c300c06676a06adf21e0c7
kernel - 4.4.14-1-f69c0724d9df718fd3e3acf528d7ed56
kmod-ath - 4.4.14+2016-05-12-1
kmod-ath9k-common - 4.4.14+2016-05-12-1
kmod-ath9k-htc - 4.4.14+2016-05-12-1
kmod-cfg80211 - 4.4.14+2016-05-12-1
kmod-crypto-aead - 4.4.14-1
kmod-crypto-ecb - 4.4.14-1
kmod-crypto-hash - 4.4.14-1
kmod-crypto-manager - 4.4.14-1
kmod-crypto-null - 4.4.14-1
kmod-crypto-pcompress - 4.4.14-1
kmod-crypto-sha1 - 4.4.14-1
kmod-fs-vfat - 4.4.14-1
kmod-gpio-pca953x - 4.4.14-1
kmod-gpio-pcf857x - 4.4.14-1
kmod-gre - 4.4.14-1
kmod-hid - 4.4.14-1
kmod-hid-generic - 4.4.14-1
kmod-i2c-algo-bit - 4.4.14-1
kmod-i2c-algo-pcf - 4.4.14-1
kmod-i2c-bcm2708 - 4.4.14-1
kmod-i2c-bcm2835 - 4.4.14-1
kmod-i2c-core - 4.4.14-1
kmod-i2c-gpio - 4.4.14-1
kmod-i2c-gpio-custom - 4.4.14-2
kmod-i2c-mux - 4.4.14-1
kmod-iio-core - 4.4.14-1
kmod-input-core - 4.4.14-1
kmod-input-evdev - 4.4.14-1
kmod-ip6tables - 4.4.14-1
kmod-ipt-conntrack - 4.4.14-1
kmod-ipt-core - 4.4.14-1
kmod-ipt-nat - 4.4.14-1
kmod-iptunnel - 4.4.14-1
kmod-ledtrig-usbdev - 4.4.14-1
kmod-lib-crc-ccitt - 4.4.14-1
kmod-lib-textsearch - 4.4.14-1
kmod-mac80211 - 4.4.14+2016-05-12-1
kmod-mii - 4.4.14-1
kmod-mppe - 4.4.14-1
kmod-nf-conntrack - 4.4.14-1
kmod-nf-conntrack6 - 4.4.14-1
kmod-nf-ipt - 4.4.14-1
kmod-nf-ipt6 - 4.4.14-1
kmod-nf-nat - 4.4.14-1
kmod-nf-nathelper - 4.4.14-1
kmod-nf-nathelper-extra - 4.4.14-1
kmod-nls-base - 4.4.14-1
kmod-nls-cp437 - 4.4.14-1
kmod-nls-iso8859-1 - 4.4.14-1
kmod-ppp - 4.4.14-1
kmod-pppoe - 4.4.14-1
kmod-pppox - 4.4.14-1
kmod-pptp - 4.4.14-1
kmod-slhc - 4.4.14-1
kmod-sound-arm-bcm2835 - 4.4.14-1
kmod-sound-core - 4.4.14-1
kmod-spi-bitbang - 4.4.14-1
kmod-spi-gpio - 4.4.14-1
kmod-usb-core - 4.4.14-1
kmod-usb-hid - 4.4.14-1
kmod-usb-net - 4.4.14-1
kmod-usb-net-cdc-ether - 4.4.14-1
kmod-usb-net-rndis - 4.4.14-1
kmod-usb2 - 4.4.14-1
lcd4linux-full - r1203-3
libblkid - 2.28-1
libblobmsg-json - 2016-07-29-290c64ef5b5c3e75be851594f269d6a9568e64e5
libbz2 - 1.0.6-2
libc - 1.1.15-1
libdbus - 1.10.4-1
libexpat - 2.1.0-3
libffi - 3.2.1-2
libgcc - 5.3.0-1
libgd - 2.1.1-1
libip4tc - 1.4.21-2
libip6tc - 1.4.21-2
libiwinfo - 2016-01-25-e4aca3910dff532ed878d0ceaf1ab6e8ad7719bf
libiwinfo-lua - 2016-01-25-e4aca3910dff532ed878d0ceaf1ab6e8ad7719bf
libjpeg - 9a-1
libjson-c - 0.12-1
libjson-script - 2016-07-29-290c64ef5b5c3e75be851594f269d6a9568e64e5
liblua - 5.1.5-1
libmpdclient - 2.10-1
libmysqlclient - 5.1.73-2
libncursesw - 5.9-3
libnl-tiny - 0.1-5
libpng - 1.2.56-1
libpthread - 1.1.15-1
libreadline - 6.3-1
librt - 1.1.15-1
libsqlite3 - 3130000-2
libubox - 2016-07-29-290c64ef5b5c3e75be851594f269d6a9568e64e5
libubus - 2016-07-02-053be7df871e05478284235732f8b0608089512f
libubus-lua - 2016-07-02-053be7df871e05478284235732f8b0608089512f
libuci - 2016-07-04.1-1
libuci-lua - 2016-07-04.1-1
libuclient - 2016-01-28-2e0918c7e0612449024caaaa8d44fb2d7a33f5f3
libudev - 3.2-1
libusb-1.0 - 1.0.20-1
libusb-compat - 0.1.4-2
libuuid - 2.28-1
libxtables - 1.4.21-2
logd - 2016-07-19-aead2c0cbffdda9b46d74a998a4c6aeef423b21a
lua - 5.1.5-1
luci - git-16.288.36935-1e1a706-1
luci-app-firewall - git-16.288.36935-1e1a706-1
luci-app-samba - git-16.288.36935-1e1a706-1
luci-base - git-16.288.36935-1e1a706-1
luci-lib-ip - git-16.288.36935-1e1a706-1
luci-lib-jsonc - git-16.288.36935-1e1a706-1
luci-lib-nixio - git-16.288.36935-1e1a706-1
luci-mod-admin-full - git-16.288.36935-1e1a706-1
luci-proto-ipv6 - git-16.288.36935-1e1a706-1
luci-proto-ppp - git-16.288.36935-1e1a706-1
luci-theme-bootstrap - git-16.288.36935-1e1a706-1
mtd - 21
netifd - 2016-06-06-99e6dc68bbac5a57a0ebca810a9dc36e38667821
odhcp6c - 2016-02-08-7533a6243dc3ac5a747cf6ccbc4d0539dafd3e07
odhcpd - 2016-10-09-801cfeea100ca7b211c9841f0fcb757b17f47860
opkg - 9c97d5ecd795709c8584e972bfdf3aee3a5b846d-12
ppp - 2.4.7-9
ppp-mod-pppoe - 2.4.7-9
ppp-mod-pptp - 2.4.7-9
procd - 2016-07-29-2c9f5d4af1559b840c42f1443ede9f9fe809c58b
python-base - 2.7.12-2
python-light - 2.7.12-2
python-smbus - 3.1.2-1
resolveip - 2
rpcd - 2016-06-30-23417e94d25570e6d62542bac46edd51e8e0243a
samba36-client - 3.6.25-5
samba36-server - 3.6.25-5
terminfo - 5.9-3
ubox - 2016-07-19-aead2c0cbffdda9b46d74a998a4c6aeef423b21a
ubus - 2016-07-02-053be7df871e05478284235732f8b0608089512f
ubusd - 2016-07-02-053be7df871e05478284235732f8b0608089512f
uci - 2016-07-04.1-1
uclibcxx - 0.2.4-2
uclient-fetch - 2016-01-28-2e0918c7e0612449024caaaa8d44fb2d7a33f5f3
uhttpd - 2015-11-08-fe01ef3f52adae9da38ef47926cd50974af5d6b7
uhttpd-mod-ubus - 2015-11-08-fe01ef3f52adae9da38ef47926cd50974af5d6b7
usbutils - 007-4
usign - 2016-07-04-ef6419142a3b0fbcddcccf536e3c1880302c6f89
wpa-supplicant - 2016-06-15-1
zlib - 1.2.8-1</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p342269">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">kb06</div>
					<div class="post-datetime">
						27 Oct 2016, 16:10					</div>
				</div>
				<div class="post-content content">
					<p>I found the problem.</p><p>In /boot/config.txt there should be:</p><div class="codebox"><pre><code>dtparam=i2c_arm=on
dtparam=i2c0=on
dtparam=i2c1=on
dtparam=spi=on
dtparam=i2s=on</code></pre></div><p>And now it is detected:</p><div class="codebox"><pre><code>root@OpenWrt:~# i2cdetect 0
WARNING! This program can confuse your I2C bus, cause data loss and worse!
I will probe file /dev/i2c-0.
I will probe address range 0x03-0x77.
Continue? [Y/n] y
     0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f
00:          -- -- -- -- -- -- -- -- -- -- -- -- --
10: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
20: -- -- -- -- -- -- -- 27 -- -- -- -- -- -- -- --
30: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
40: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
50: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
60: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
70: -- -- -- -- -- -- -- --</code></pre></div><p>But now I have a problem with HD44780 driver for lcd4linux:</p><div class="codebox"><pre><code>lcd4linux.c: initializing driver HD44780
drv_init(HD44780) failed: no such driver
Error initializing driver HD44780: Exit!</code></pre></div><p>I have lcd4linux-full, do you have a driver for hd4780 or do I need to compile it by myself?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>