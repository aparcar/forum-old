<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> WNDR3700 exploration</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 1 Oct 2014 and 7 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 20 of 20</div><nav><ul><li><a href="viewtopic.php%3Fid=22311&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=22311&amp;p=18.html">18</a></li><li><a href="viewtopic.php%3Fid=22311&amp;p=19.html">19</a></li><li class="pagination-current"><span>20</span></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p127048">
				<div class="post-metadata">
					<div class="post-num">Post #476</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						1 Feb 2011, 13:27					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Comitizer wrote:</cite><blockquote><p>What are the ramifications of switching from wpad-mini to wpad?</p></blockquote></div><p>Both wpad and wpad-mini are just wrappers around &#039;hostapd&#039; with support packages.<br /><a href="https://dev.openwrt.org/browser/trunk/package/hostapd/Makefile">https://dev.openwrt.org/browser/trunk/p … d/Makefile</a></p><p>-&#039;wpad-mini&#039; is the base system with only WPA(2)-PSK authentication.<br />- full &#039;wpad&#039; supports IEEE 802.1x/WPA/EAP/RADIUS (adds the &#039;WPA supplicant&#039; package with OpenSSL library)</p><p>The &#039;hostapd-utils&#039; just adds a small hostapd_cli command line tool for messaging with the daemon.</p><p>Firmware size grows maybe 100 kB.</p><p>(Of course, in home usage the EAP/RADIUS functionality is not needed for anything, but the additional SSL encryption support seems to come with it. So thatswhy it is needed for the WPS to function.)</p>											<p class="post-edited">(Last edited by <strong>hnyman</strong> on 1 Feb 2011, 13:27)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p139200">
				<div class="post-metadata">
					<div class="post-num">Post #477</div>
					<div class="post-author">Sunsun</div>
					<div class="post-datetime">
						15 Jul 2011, 20:48					</div>
				</div>
				<div class="post-content content">
					<p>Hi guys!<br />Would someone be so kind to share caldata dump (mdr8 area) from wndr3700NA?<br />Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p142457">
				<div class="post-metadata">
					<div class="post-num">Post #478</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						29 Aug 2011, 14:11					</div>
				</div>
				<div class="post-content content">
					<p>Netgear seems to be introducing a new version of WNDR3700, the WNDR3700v3. <br />It is already presented on their support website, but status is still &quot;Coming soon&quot;.<br /><a href="http://support.netgear.com/app/products/model/a_id/19278">http://support.netgear.com/app/products … a_id/19278</a></p><p>Info and pics at the FCC regulator site:<br /><a href="https://fjallfoss.fcc.gov/oetcf/eas/reports/ViewExhibitReport.cfm?mode=Exhibits&amp;RequestTimeout=500&amp;calledFromFrame=N&amp;application_id=651807&amp;fcc_id=%27PY311200166%27">https://fjallfoss.fcc.gov/oetcf/eas/rep … 1200166%27</a></p><p>That v3 version will be different than v1 or v2 in major way, as the Atheros chip architecture is changed to Broadcom. So, v3 will have almost nothing in common with the v1 and v2.<br /><a href="http://www.wikidevi.com/wiki/Netgear_WNDR3700v3">http://www.wikidevi.com/wiki/Netgear_WNDR3700v3</a><br />CPU1: Broadcom BCM4718A1<br />Based on the specs there, the flash memory will be back to 8 MB.<br />(So, for anybody interested in the 16 MB v2 version, now is the time to make purchase, as long as they are available...)</p><p>I have added a reference to WNDR3700v3 to the Openwrt wiki article, but I have no idea when somebody will conjure up the needed configuration and build script...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p142463">
				<div class="post-metadata">
					<div class="post-num">Post #479</div>
					<div class="post-author">mohnkhan</div>
					<div class="post-datetime">
						29 Aug 2011, 15:58					</div>
				</div>
				<div class="post-content content">
					<p>I wish they called that model something else than WNDR:(.., something which would clearly tell us firmware enthusiasts even in our dreams.. That it’s a different beast altogether. </p><p>Anyway thanks for your update.. heads-up</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p142474">
				<div class="post-metadata">
					<div class="post-num">Post #480</div>
					<div class="post-author">Borromini</div>
					<div class="post-datetime">
						29 Aug 2011, 20:08					</div>
				</div>
				<div class="post-content content">
					<p>Won&#039;t the switch to Broadcom pretty much mean OpenWrt won&#039;t support the device? Or am I too pessimistic? Broadcom 802.11abgn support is already in staging, but the stability and reliability of brcmscmac leaves a lot to be desired, especially if you&#039;d want to use it as an AP...</p>											<p class="post-edited">(Last edited by <strong>Borromini</strong> on 29 Aug 2011, 20:10)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p153850">
				<div class="post-metadata">
					<div class="post-num">Post #481</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						11 Jan 2012, 20:26					</div>
				</div>
				<div class="post-content content">
					<p>I noticed an interesting question in Arokh&#039;s thread and I wrote the needed hotplug script, so I am copying that also here:</p><div class="quotebox"><cite>avbohemen wrote:</cite><blockquote><p>What is correct configuration to make the WAN/eth1 LED work like the LAN switch LEDs (orange on 100Mbps, green on 1000Mbps)?</p></blockquote></div><p>The script monitors &#039;ifup&#039; actions from &#039;wan&#039; interface, then queries the link speed and sets the wan LED to green if speed=1000, otherwise to yellow.</p><p>Place this into a new file named&nbsp; /etc/hotplug.d/iface/99-wanspeed and it should work:<br /></p><div class="codebox"><pre><code>#!/bin/sh

if [ &quot;$ACTION&quot; = ifup ]; then
        if [ &quot;$INTERFACE&quot; = &quot;wan&quot; ] ; then
                SPEED=$(cat /sys/class/net/eth1/speed)
                if [ &quot;$SPEED&quot; = &quot;1000&quot; ] ; then
                        logger &quot;ifup $INTERFACE, speed $SPEED: set wan LED to green&quot;
                        echo &quot;1&quot; &gt; /sys/class/leds/netgear\:green\:wan/brightness
                else
                        logger &quot;ifup $INTERFACE, speed $SPEED: set wan LED to yellow&quot;
                        echo &quot;0&quot; &gt; /sys/class/leds/netgear\:green\:wan/brightness
                fi
        fi
fi</code></pre></div><p>EDIT 9.11.2014: LED name change from wndr3700 to netgear, as BB and trunk use that name.</p>											<p class="post-edited">(Last edited by <strong>hnyman</strong> on 9 Nov 2014, 13:55)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p160160">
				<div class="post-metadata">
					<div class="post-num">Post #482</div>
					<div class="post-author">SDNick484</div>
					<div class="post-datetime">
						8 Mar 2012, 21:04					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve been running SVN r26387 for quite some time now (almost a year now) on my first gen WNDR3700.&nbsp; So far everything runs very well, but as it&#039;s been quite some time I was wondering if there&#039;s any significant reason to upgrade to a more recent release (I just pulled r30857)?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p160163">
				<div class="post-metadata">
					<div class="post-num">Post #483</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						8 Mar 2012, 21:21					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>SDNick484 wrote:</cite><blockquote><p>I was wondering if there&#039;s any significant reason to upgrade to a more recent release (I just pulled r30857)?</p></blockquote></div><p>Probably nothing significant, unless you need newly added functionalities like jumbo frames etc. </p><p>However, there have been somewhat meaningful changes to firewall defaults etc., and those might make it worthwhile to update, especially if you use IPv6 to any extent. Maybe QoS has also improved somewhat thanks to options included in newer kernels.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p160208">
				<div class="post-metadata">
					<div class="post-num">Post #484</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						9 Mar 2012, 11:08					</div>
				</div>
				<div class="post-content content">
					<p>There&#039;s been tons of development in the ath9k driver, so you might experience better wireless performance.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p160243">
				<div class="post-metadata">
					<div class="post-num">Post #485</div>
					<div class="post-author">SDNick484</div>
					<div class="post-datetime">
						9 Mar 2012, 19:22					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for the responses.&nbsp; I don&#039;t have a need for Jumbo Frames (in my experience they cause more headaches than they solve), and I&#039;m not currently leveraging QoS (although if I add a VoIP for the house, this may be interesting).&nbsp; I&#039;m pretty satisfied with my current WiFi performance, but if I do upgrade it&#039;s due to those ath9k changes.&nbsp; I have to say I&#039;m still very impressed with this router.&nbsp; I frequently have 6-10 WiFi clients (including four behind a bridge) and it keeps up without issue.&nbsp; I plan to add a wired switch to get more gigabit ports this weekend.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p239647">
				<div class="post-metadata">
					<div class="post-num">Post #486</div>
					<div class="post-author">joao.sousa</div>
					<div class="post-datetime">
						8 Jul 2014, 16:04					</div>
				</div>
				<div class="post-content content">
					<p>Hi, <br />I&#039;ve just successfully installed OpenWRT on my Netgear R3700 v1, to secure the bridge connection with WPA, since this is not possible with the original firmware.</p><p>However, while configuring it, I&#039;ve realized that this is just to much for my skills.</p><p>So now I&#039;m trying to restore the router&#039;s default settings, through LuCi web panel, and on System&gt;Backup/Firmware&gt;Flash Operations (Actions): Restore Backup, I can upload a configuration file.</p><p>I have the original Netgear configuration file (NETGEAR_WNDR3700.cfg), but can I restore the backup this easily?<br />Is it as simple as it was to upload and install OpenWRT?</p><p>Here&#039;s the printscreen of the menu.<br /><a href="http://ep1.pinkbike.org/p5pb11153817/p5pb11153817.jpg">http://ep1.pinkbike.org/p5pb11153817/p5pb11153817.jpg</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p239657">
				<div class="post-metadata">
					<div class="post-num">Post #487</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						8 Jul 2014, 17:57					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>joao.sousa wrote:</cite><blockquote><p>I&#039;m trying to restore the router&#039;s default settings, through LuCi web panel, and on System&gt;Backup/Firmware&gt;Flash Operations (Actions): Restore Backup, I can upload a configuration file.</p><p>I have the original Netgear configuration file (NETGEAR_WNDR3700.cfg), but can I restore the backup this easily?</p></blockquote></div><p>If you want to return to original Netgear firmware and settings, you need to follow the TFTP recovery flash advice.<br /><a href="http://wiki.openwrt.org/toh/netgear/wndr3700#recovery.flash.in.failsafe.mode">http://wiki.openwrt.org/toh/netgear/wnd … lsafe.mode</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p239749">
				<div class="post-metadata">
					<div class="post-num">Post #488</div>
					<div class="post-author">joao.sousa</div>
					<div class="post-datetime">
						9 Jul 2014, 16:30					</div>
				</div>
				<div class="post-content content">
					<p>Thank you! This was pretty easy actually!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p291911">
				<div class="post-metadata">
					<div class="post-num">Post #489</div>
					<div class="post-author">afkar.ec</div>
					<div class="post-datetime">
						15 Sep 2015, 08:49					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I have to configure cat /etc/hotplug.d/button/00-wps file for following condition:<br />if [ &quot;$BUTTON&quot; = &quot;BTN_2&quot; ] &amp;&amp; [ &quot;$ACTION&quot; = &quot;pressed&quot; ]; then</p><p>I have to check eth0.1 if link is up then have ON status led otherwise OFF.</p><p>Could you please reply, how i can add such condition in that file.</p><div class="quotebox"><cite>hnyman wrote:</cite><blockquote><p>I wanted to make the OpenWrt build for WNDR3700 more &quot;feature-complete&quot;, so I searched for information enabling the two buttons on the WNDR3700. Here are short explanations, how to enable the WiFi button and the WPS button. I have done the work on Backfire 10.03.1-SVN branch, but there shouldn&#039;t be difference to Kamikaze/trunk.</p><p>Based on SVN revision: r25261 Backfire<br />Build examples and SVN diffs: <a href="http://koti.welho.com/hnyman1/Openwrt/">http://koti.welho.com/hnyman1/Openwrt/</a><br />Build process and included features explained here: <a href="https://forum.openwrt.org/viewtopic.php?id=28392">https://forum.openwrt.org/viewtopic.php?id=28392</a></p><p>Buttons have different names in Backfire and in Kamikaze/trunk:<br /></p><div class="codebox"><pre><code>Backfire:  reset=BTN_0,  wps=BTN_1,  wifi=BTN_2
trunk:  reset=reset,  wps=wps,  wifi=BTN_2</code></pre></div><p>Note: I added a logger line to the scripts, so that each button event gets noted in Syslog.</p><p><strong>WiFi button:</strong></p><p>The button automatics is pretty much already in place. It only requires hotplugging the button event to the &#039;/sbin/wifi&#039; script. <br />- The button toggles WiFi off, it at least one radio was on. <br />- And if both radios were off, it toggles WiFi on according to the specs set in normal Wifi config.</p><p>The simple button script just requires adding a file &#039;/etc/hotplug.d/button/10-radio-toggle&#039;. </p><div class="codebox"><pre><code>root@OpenWrt:/# cat /etc/hotplug.d/button/10-radio-toggle

#!/bin/sh
if [ &quot;$BUTTON&quot; = &quot;BTN_2&quot; ] &amp;&amp; [ &quot;$ACTION&quot; = &quot;pressed&quot; ]; then
    if [ -d /var/run/hostapd-phy0 -o -d /var/run/hostapd-phy1 ]; then
        logger &quot;WiFi button used: WiFi down&quot;
        /sbin/wifi down
    else
        logger &quot;WiFi button used: WiFi up&quot;
        /sbin/wifi up
    fi
fi</code></pre></div><p><strong>WPS button:</strong></p><p>If you have a WPS-enabled network device (like a modern USB dongle) supporting Wi-Fi Protected Setup (WPS), you can negotiate joining the router&#039;s Wifi network without manually entering SSID &amp; passkey. You just initiate &quot;WPS authentication&quot; by pushing the similar WPS button on the device (or launching the process by its driver/control software). After the device has initiated the authentication process, you can accept the transaction by using the WPS button on WNDR3700. The connection should then get negotiated, and in most cases in future your PC should remember the received network settings from then on. </p><p>After finding the information and browsing the hostapd package sourcecode, the needed actions for enabling the WPS button are pretty simple:</p><p>1) Using WPS authentication requires <strong>replacing the default &#039;wpad-mini&#039; package with &#039;wpad&#039; and &#039;hostapd-utils&#039;</strong>. The reason is that the tool &quot;hostapd_cli&quot; and some needed support functions are not included in &#039;wpad-mini&#039;.</p><p>WPS authentication itself is launched with a command: hostapd_cli -p /var/run/hostapd-phy0 wps_pbc</p><p>It tells the running hostapd daemon to participate in ongoing WPS authentication sequence. It needs to be run separately for each radio (= each existing hostapd process). </p><p>2) And it only works if the <strong>&#039;/etc/config/wireless&#039; has been modified</strong> to include info about WPS authentication being allowed by <strong>adding the option &#039;wps_pushbutton&#039; &#039;1&#039; to the wifi-iface section of (each) radio</strong>. Additionally, the encryption should be WPA2-PSK (or maybe WPA-PSK is enough, I haven&#039;t tested).<br /> (Looks like the version of hostapd scripts in OpenWrt does not support the full scope of hostapd&#039;s capabilities, so many of the config options documented in hostapd docs are left unused.)</p><p>That config file is read when radios are turned on, so after editing the config, restart the radios in WNDR3700.<br />At this point, you should be able to test it by running it from command line. If the message gets passed to hostapd, you should see there result &#039;OK&#039; there. Otherwise the result is &#039;FAIL&#039;.<br />&gt; root@OpenWrt:~# hostapd_cli -p /var/run/hostapd-phy0 wps_pbc<br />&gt; Selected interface &#039;wlan0&#039;<br />&gt; OK<br />&gt; root@OpenWrt:~#</p><p>3) Add a hotplug <strong>button event script to launch the process</strong>.</p><p>I modified directly the hostapd package source ( /package/hostapd/files/wps-hotplug.sh ), as the hotplug script gets automatically installed to &#039;/etc/hotplug.d/button/50-wps&#039; with the package.&nbsp; See below.</p><p>The script launches hostapd_cli for each radio and lights the WPS led for 10 seconds. There is no monitoring of the result, or anything like that. It is just a dumb script using the hostapd_cli command to pass the message to the hostapd daemon.<br />Remember to check the button name: Backfire:&nbsp; wps=&quot;BTN_1&quot;,&nbsp; trunk:&nbsp; wps=&quot;wps&quot;<br /></p><div class="codebox"><pre><code>root@OpenWrt:/# cat /etc/hotplug.d/button/50-wps

if [ &quot;$ACTION&quot; = &quot;pressed&quot; -a &quot;$BUTTON&quot; = &quot;BTN_1&quot; ]; then
        echo &quot;255&quot; &gt; /sys/devices/platform/leds-gpio/leds/wndr3700:green:wps/brightness
        for dir in /var/run/hostapd-*; do
                [ -d &quot;$dir&quot; ] || continue
                logger &quot;WPS button active: $dir&quot;
                hostapd_cli -p &quot;$dir&quot; wps_pbc
        done
        sleep 10
        echo &quot;0&quot; &gt; /sys/devices/platform/leds-gpio/leds/wndr3700:green:wps/brightness
fi</code></pre></div><div class="codebox"><pre><code>root@OpenWrt:/# cat /etc/config/wireless
...
config &#039;wifi-iface&#039;
        option &#039;device&#039; &#039;radio0&#039;
        option &#039;network&#039; &#039;lan&#039;
        option &#039;mode&#039; &#039;ap&#039;
        option &#039;ssid&#039; &#039;public&#039;
        option &#039;encryption&#039; &#039;psk2&#039;
        option &#039;key&#039; &#039;SecretKey&#039;
        option &#039;wps_pushbutton&#039; &#039;1&#039;
...</code></pre></div><p>If everything goes ok, you should see in Syslog not only the button events, but also succesful WPS authentication:<br /></p><div class="codebox"><pre><code>Jan 31 21:11:09 OpenWrt user.notice root: WiFi button used: WiFi up
Jan 31 21:11:09 OpenWrt user.info kernel: ADDRCONF(NETDEV_UP): wlan0: link is not ready
Jan 31 21:11:09 OpenWrt user.info kernel: device wlan0 entered promiscuous mode
Jan 31 21:11:09 OpenWrt user.info kernel: br-lan: port 2(wlan0) entering forwarding state
...
Jan 31 21:12:00 OpenWrt user.notice root: WPS button active: /var/run/hostapd-phy0
Jan 31 21:12:00 OpenWrt user.notice root: WPS button active: /var/run/hostapd-phy1
Jan 31 21:12:03 OpenWrt daemon.info hostapd: wlan0: STA 1c:af:f7:f6:11:dc IEEE 802.11: authenticated
Jan 31 21:12:03 OpenWrt daemon.info hostapd: wlan0: STA 1c:af:f7:f6:11:dc IEEE 802.11: associated (aid 1)
Jan 31 21:12:04 OpenWrt daemon.warn hostapd: wlan0: STA 1c:af:f7:f6:11:dc IEEE 802.1X: authentication failed - EAP type: 0 ((null))
Jan 31 21:12:04 OpenWrt daemon.info hostapd: wlan0: STA 1c:af:f7:f6:11:dc IEEE 802.1X: Supplicant used different EAP type: 254 ((null))
Jan 31 21:12:04 OpenWrt daemon.info hostapd: wlan0: STA 1c:af:f7:f6:11:dc IEEE 802.11: disassociated
Jan 31 21:12:05 OpenWrt daemon.info hostapd: wlan0: STA 1c:af:f7:f6:11:dc IEEE 802.11: deauthenticated due to inactivity
Jan 31 21:12:17 OpenWrt daemon.info hostapd: wlan0: STA 1c:af:f7:f6:11:dc IEEE 802.11: authenticated
Jan 31 21:12:17 OpenWrt daemon.info hostapd: wlan0: STA 1c:af:f7:f6:11:dc IEEE 802.11: associated (aid 1)
Jan 31 21:12:17 OpenWrt daemon.info hostapd: wlan0: STA 1c:af:f7:f6:11:dc RADIUS: starting accounting session 4D47094D-00000000
Jan 31 21:12:17 OpenWrt daemon.info hostapd: wlan0: STA 1c:af:f7:f6:11:dc WPA: pairwise key handshake completed (RSN)
Jan 31 21:12:29 OpenWrt daemon.info dnsmasq-dhcp[1855]: DHCPREQUEST(br-lan) 192.168.1.190 1c:af:f7:f6:11:dc 
Jan 31 21:12:29 OpenWrt daemon.info dnsmasq-dhcp[1855]: DHCPACK(br-lan) 192.168.1.190 1c:af:f7:f6:11:dc HNH57JG</code></pre></div><p>EDIT: added a note about the correct button names in Backfire and trunk.<br />If you want to check the button names on your system, you can use the following hotplug script that just logs the button &#039;pressed&#039; actions into system log:<br /></p><div class="codebox"><pre><code>root@OpenWrt:/etc/config# cat /etc/hotplug.d/button/02-log
#!/bin/sh
if [ &quot;$ACTION&quot; = &quot;pressed&quot; ]; then
        logger &quot;button: &quot;$BUTTON
fi</code></pre></div></blockquote></div>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 20 of 20</div><nav><ul><li><a href="viewtopic.php%3Fid=22311&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=22311&amp;p=18.html">18</a></li><li><a href="viewtopic.php%3Fid=22311&amp;p=19.html">19</a></li><li class="pagination-current"><span>20</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0.001 -->

</body>
</html>