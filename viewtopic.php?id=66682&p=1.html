<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> OpenVPN</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 30 Mar 2018 and 1 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=66682&amp;p=2.html">2</a></li></ul></nav></div>
			
		
		
			<article class="post" id="p333748">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">davidc502</div>
					<div class="post-datetime">
						9 Aug 2016, 03:06					</div>
				</div>
				<div class="post-content content">
					<p>I have a question about OpenVPN.&nbsp; Essentially I want to create a tunnel from my router to VPN server. My router will be the &quot;client&quot;.</p><p>Are the instructions found here still accurate to accomplish this goal?&nbsp; <a href="https://wiki.openwrt.org/doc/howto/vpn.openvpn">https://wiki.openwrt.org/doc/howto/vpn.openvpn</a></p><p>Do I need to do anything else to &quot;basically&quot; set it up than what I&#039;m putting below? Are there other considerations? I do have the protocol, OpenVPN server IP, User/Passwords etc. </p><p>opkg update<br />opkg install openvpn-openssl openvpn-easy-rsa</p><p>build-ca<br />build-dh<br />build-key-server my-server<br />build-key-pkcs12 my-client</p><p>cp /etc/easy-rsa/keys/ca.crt /etc/easy-rsa/keys/my-server.* /etc/easy-rsa/keys/dh2048.pem /etc/openvpn<br />scp /etc/easy-rsa/keys/ca.crt /etc/easy-rsa/keys/my-client.* root@CLIENT_IP_ADDRESS:/etc/openvpn</p><p>Configure the OpenWrt client</p><p>echo &gt; /etc/config/openvpn<br />uci set openvpn.myvpn=openvpn<br />uci set openvpn.myvpn.enabled=1<br />uci set openvpn.myvpn.dev=tun<br />uci set openvpn.myvpn.proto=udp<br />uci set openvpn.myvpn.verb=3<br />uci set openvpn.myvpn.ca=/etc/openvpn/ca.crt<br />uci set openvpn.myvpn.cert=/etc/openvpn/my-client.crt<br />uci set openvpn.myvpn.key=/etc/openvpn/my-client.key<br />uci set openvpn.myvpn.client=1<br />uci set openvpn.myvpn.remote_cert_tls=server<br />uci set openvpn.myvpn.remote=&quot;SERVER_IP_ADDRESS 1194&quot;<br />uci commit openvpn<br />/etc/init.d/openvpn start</p><br /><p>Thanks,</p><p>David</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333749">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">davidc502</div>
					<div class="post-datetime">
						9 Aug 2016, 03:18					</div>
				</div>
				<div class="post-content content">
					<p>These are the packages installed --</p><div class="codebox"><pre><code>root@lede:~# opkg install openvpn-openssl openvpn-easy-rsa
Installing openvpn-openssl (2.3.11-2) to root...
Downloading [url]http://davidc502sis.dynamic-dns.net/snapshots/packages/base/openvpn-openssl_2.3.11-2_arm_cortex-a9_vfpv3.ipk.[/url]
Installing liblzo (2.09-1) to root...
Downloading [url]http://davidc502sis.dynamic-dns.net/snapshots/packages/base/liblzo_2.09-1_arm_cortex-a9_vfpv3.ipk.[/url] 
Installing libopenssl (1.0.2h-1) to root...
Downloading [url]http://davidc502sis.dynamic-dns.net/snapshots/packages/base/libopenssl_1.0.2h-1_arm_cortex-a9_vfpv3.ipk.[/url] 
Installing openvpn-easy-rsa (2013-01-30-2) to root...
Downloading [url]http://davidc502sis.dynamic-dns.net/snapshots/packages/base/openvpn-easy-rsa_2013-01-30-2_arm_cortex-a9_vfpv3.ipk.[/url]  
Installing openssl-util (1.0.2h-1) to root...
Downloading [url]http://davidc502sis.dynamic-dns.net/snapshots/packages/base/openssl-util_1.0.2h-1_arm_cortex-a9_vfpv3.ipk.[/url] 
Configuring libopenssl.
Configuring openssl-util.
Configuring liblzo.
Configuring openvpn-openssl.
Configuring openvpn-easy-rsa.
root@lede:~# opkg install luci-app-openvpn
Installing luci-app-openvpn (git-16.217.35130-6a11f71-1) to root...
Downloading [url]http://davidc502sis.dynamic-dns.net/snapshots/packages/luci/luci-app-openvpn_git-16.217.35130-6a11f71-1_all.ipk.[/url] 
Configuring luci-app-openvpn.</code></pre></div>											<p class="post-edited">(Last edited by <strong>davidc502</strong> on 9 Aug 2016, 03:21)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333753">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">RangerZ</div>
					<div class="post-datetime">
						9 Aug 2016, 05:04					</div>
				</div>
				<div class="post-content content">
					<p>You have the correct packages.&nbsp; </p><p>There are 2 basic ways to config openvpn.&nbsp; The article cited places a *.conf file in the openvpn directory.&nbsp; There would also be a reference to this in the etc\config\openvpn file.&nbsp; Alternatively you can have a etc\config\openvpn file with all the config in it.&nbsp; I use the later, and I think most of the other wikis do to.&nbsp; Be aware that if you use the first method, that you may need to clearout the default installed etc\config\openvpn file (back it up).</p><p>You do not need to install openvpn-easy-rsa on the router.&nbsp; You use it just to configure the keys.&nbsp; You can download it to your PC (from OpenVPN) and build the keys much easier that way.&nbsp; Think about how many keys (device) you will have, and consider generating extra keys now.&nbsp; I do not&nbsp; think you can just add more keys, but need to regen them all (not positive)&nbsp; Also you do not need to really use your real personal info that you are prompted for in the keys (name and email among them), but need to use something.</p><p>This link is to the only &quot;Client&quot; wiki article:&nbsp; <a href="https://wiki.openwrt.org/doc/howto/vpn.client.openvpn.tun">https://wiki.openwrt.org/doc/howto/vpn. … penvpn.tun</a><br />I think this is the best current article on the site: <a href="https://wiki.openwrt.org/doc/howto/openvpn-streamlined-server-setup">https://wiki.openwrt.org/doc/howto/open … rver-setup</a><br />but search the wiki for openvpn.&nbsp; Most of the wikis are written from the perspective of a OpenVPN server on a OpenWrt device with the connecting client being the device with the client software on it.&nbsp; The client parts are weak in their config reference for an OpenWrt Client device.</p><p>Are&nbsp; you connecting to a service?&nbsp; If so most will have a linux script you can use as a reference.&nbsp; </p><p>Personally I use WINScp to edit all my (openvpn) files.&nbsp; It&#039;s just easier to use.</p><p>I find the Luci controls for stop/start/etc a bit buggy.&nbsp; Restart seems to work.&nbsp; The OpenVPN does not always disable the single instance properly.&nbsp; It seems to restart.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333755">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">davidc502</div>
					<div class="post-datetime">
						9 Aug 2016, 05:12					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>RangerZ wrote:</cite><blockquote><p>You have the correct packages.&nbsp; </p><p>There are 2 basic ways to config openvpn.&nbsp; The article cited places a *.conf file in the openvpn directory.&nbsp; There would also be a reference to this in the etc\config\openvpn file.&nbsp; Alternatively you can have a etc\config\openvpn file with all the config in it.&nbsp; I use the later, and I think most of the other wikis do to.&nbsp; Be aware that if you use the first method, that you may need to clearout the default installed etc\config\openvpn file (back it up).</p><p>You do not need to install openvpn-easy-rsa on the router.&nbsp; You use it just to configure the keys.&nbsp; You can download it to your PC (from OpenVPN) and build the keys much easier that way.&nbsp; Think about how many keys (device) you will have, and consider generating extra keys now.&nbsp; I do not&nbsp; think you can just add more keys, but need to regen them all (not positive)&nbsp; Also you do not need to really use your real personal info that you are prompted for in the keys (name and email among them), but need to use something.</p><p>This link is to the only &quot;Client&quot; wiki article:&nbsp; <a href="https://wiki.openwrt.org/doc/howto/vpn.client.openvpn.tun">https://wiki.openwrt.org/doc/howto/vpn. … penvpn.tun</a><br />I think this is the best current article on the site: <a href="https://wiki.openwrt.org/doc/howto/openvpn-streamlined-server-setup">https://wiki.openwrt.org/doc/howto/open … rver-setup</a><br />but search the wiki for openvpn.&nbsp; Most of the wikis are written from the perspective of a OpenVPN server on a OpenWrt device with the connecting client being the device with the client software on it.&nbsp; The client parts are weak in their config reference for an OpenWrt Client device.</p><p>Are&nbsp; you connecting to a service?&nbsp; If so most will have a linux script you can use as a reference.&nbsp; </p><p>Personally I use WINScp to edit all my (openvpn) files.&nbsp; It&#039;s just easier to use.</p><p>I find the Luci controls for stop/start/etc a bit buggy.&nbsp; Restart seems to work.&nbsp; The OpenVPN does not always disable the single instance properly.&nbsp; It seems to restart.</p></blockquote></div><p>correct -- the service is torguard.. there&#039;s a script available for DDWRT and I&#039;ve used some of it to figure out some of the setting.</p><div class="codebox"><pre><code>#!/bin/sh

USERNAME=&quot;USERNAME-HERE&quot;
PASSWORD=&quot;PASSWORD-HERE&quot;

PROTOCOL=&quot;udp&quot;
# Add - delete - edit servers between ##BB## and ##EE##
REMOTE_SERVERS=&quot;
##BB##
# USAMiami
remote fl.east.usa.torguardvpnaccess.com 80
##EE##
&quot;

#### DO NOT CHANGE below this line unless you know exactly what you&#039;re doing ####

CA_CRT=&#039;-----BEGIN CERTIFICATE-----
MIIEwTCCA6mgAwIBAgIJAKROjebUHo0gMA0GCSqGSIb3DQEBBQUAMIGbMQswCQYD
VQQGEwJVUzELMAkGA1UECBMCRkwxEDAOBgNVBAcTB09ybGFuZG8xETAPBgNVBAoT
CFRvckd1YXJkMQwwCgYDVQQLEwNWUE4xEzARBgNVBAMTClRHLU9WUE4tQ0ExETAP
BgNVBCkTCFRvckd1YXJkMSQwIgYJKoZIhvcNAQkBFhVzeXNhZG1pbkB0b3JndWFy
ZC5uZXQwHhcNMTQwNDE3MTAwOTIzWhcNMjQwNDE0MTAwOTIzWjCBmzELMAkGA1UE
BhMCVVMxCzAJBgNVBAgTAkZMMRAwDgYDVQQHEwdPcmxhbmRvMREwDwYDVQQKEwhU
b3JHdWFyZDEMMAoGA1UECxMDVlBOMRMwEQYDVQQDEwpURy1PVlBOLUNBMREwDwYD
VQQpEwhUb3JHdWFyZDEkMCIGCSqGSIb3DQEJARYVc3lzYWRtaW5AdG9yZ3VhcmQu
bmV0MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAws1hJzlbWKlm3DEO
XyQpmvtxwrsR4CIYMi8C6np5w74lTRYmGBcuuPqAT3ig2DnH9HNNFx1WWZbYO8pU
a1tdn7uYErJi4EP9/t2l3uXCNgoWYVdVP1j5EXIY1oacOv9srbNZHeWpxHIb1wZr
1i4sLsdaifOibgVZI91FATXGrVdFDaQb2OjyJrFW8b4xbC8pBJxQDzqPeu9mkVpu
OhBuU+dM+9h+8Bj0tpdAernEAt8CbHIywe9Rjm0JLrYmCPKuB5ldVgG3rYQWFa3X
YWjrWtr//nGM4f4WKOFc2PHWA2gI3JwdynTNLsB9NQi0N7hhR6lmtCMeqHlm0oAz
4Ad4gQIDAQABo4IBBDCCAQAwHQYDVR0OBBYEFJvAPA1gnlD/majxi+43jL0XDfqQ
MIHQBgNVHSMEgcgwgcWAFJvAPA1gnlD/majxi+43jL0XDfqQoYGhpIGeMIGbMQsw
CQYDVQQGEwJVUzELMAkGA1UECBMCRkwxEDAOBgNVBAcTB09ybGFuZG8xETAPBgNV
BAoTCFRvckd1YXJkMQwwCgYDVQQLEwNWUE4xEzARBgNVBAMTClRHLU9WUE4tQ0Ex
ETAPBgNVBCkTCFRvckd1YXJkMSQwIgYJKoZIhvcNAQkBFhVzeXNhZG1pbkB0b3Jn
dWFyZC5uZXSCCQCkTo3m1B6NIDAMBgNVHRMEBTADAQH/MA0GCSqGSIb3DQEBBQUA
A4IBAQBRG46DnL/8EAPbi/eOQli5WO7lRHYyZJdlLUMlsnwkp6Ul6BMJq8q3UX3z
+pqDf3wzj94y/IpGQgE4l0fgAdwf/C7F533TSwU/vi+5PDWfwD2WmGqVmcmXn6Rp
9Fwr+oryRw8GfsVBLZHTkWF1RZrRAr8hWZhNySGFwSXlEIicvNy+9mlFhk2Nb46w
ioZKc1Lc7/okeXNWHPv6Dlm39TcNBpGX/xNoWBzqs1EtA1ZGvMcQHsKLfi3Nbaab
BYe08KWsfeZA+ih4BZ6y2E+x84NYHRebqijXTtHp35coyXllBL/+LBoZ86hKszEx
F3pjGU0+8NzvdPUbKndhzyPPnHF1
-----END CERTIFICATE-----&#039;

OPVPNENABLE=`nvram get openvpncl_enable | awk &#039;$1 == &quot;0&quot; {print $1}&#039;`

if [ &quot;$OPVPNENABLE&quot; != 0 ]; then
   nvram set openvpncl_enable=0
   nvram commit
fi

sleep 10
mkdir /tmp/torguard; cd /tmp/torguard
echo -e &quot;$USERNAME\n$PASSWORD&quot; &gt; userpass.conf
echo &quot;$CA_CRT&quot; &gt; ca.crt
echo &quot;#!/bin/sh
iptables -t nat -I POSTROUTING -o tun0 -j MASQUERADE&quot; &gt; route-up.sh
echo &quot;#!/bin/sh
iptables -t nat -D POSTROUTING -o tun0 -j MASQUERADE&quot; &gt; route-down.sh
chmod 644 ca.crt; chmod 600 userpass.conf; chmod 700 route-up.sh route-down.sh
sleep 10
echo &quot;client
auth-user-pass /tmp/torguard/userpass.conf
management 127.0.0.1 5001
management-log-cache 50
dev tun0
proto $PROTOCOL
comp-lzo adaptive
fast-io
script-security 2
mtu-disc yes
verb 4
mute 5
cipher AES-128-CBC
auth sha1
tun-mtu 1500
resolv-retry infinite
nobind
persist-key
persist-tun
tls-client
remote-cert-tls server
log-append torguard.log
ca ca.crt
status-version 3
status status
daemon
$REMOTE_SERVERS&quot; &gt; torguard.conf
ln -s /tmp/torguard/torguard.log /tmp/torguard.log
ln -s /tmp/torguard/status /tmp/status
(killall openvpn; openvpn --config /tmp/torguard/torguard.conf --route-up /tmp/torguard/route-up.sh --down /tmp/torguard/route-down.sh) &amp;
exit</code></pre></div>											<p class="post-edited">(Last edited by <strong>davidc502</strong> on 9 Aug 2016, 05:13)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333760">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">RangerZ</div>
					<div class="post-datetime">
						9 Aug 2016, 08:06					</div>
				</div>
				<div class="post-content content">
					<p>The unbutu config files are here, step 2, there are 2 URLs (1 ea for UDP and TCP)<br /><a href="https://torguard.net/knowledgebase.php?action=displayarticle&amp;id=53">https://torguard.net/knowledgebase.php? … &amp;id=53</a><br />I think you want the UDP ones.&nbsp; They give you the key as a file.&nbsp; In OpenWrt one generally puts the key in the \etc\openvpn folder.&nbsp; You can put the *.ovpn file there too, but you will need to edit the etc\config\openvpn file to point to it.&nbsp; I do not know the syntax for this.&nbsp; I know there were some recent forum posts on this.&nbsp; might be in the first link you referenced.&nbsp; You would need to reformat the file into &quot;OpenWrt&quot; format to use the OpenWrt openvpn file directly, so the former is probably easier (and less subject to errors).</p><p>I would be interested in knowing the performance you actually get.<br />What is your home service speed and device?</p><p>I do not think you need the RSA tool at all.&nbsp; They are giving you the key(s) I think.</p>											<p class="post-edited">(Last edited by <strong>RangerZ</strong> on 9 Aug 2016, 08:08)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333861">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">davidc502</div>
					<div class="post-datetime">
						10 Aug 2016, 04:13					</div>
				</div>
				<div class="post-content content">
					<p>Good news... Without a whole lot of work, I was able to pop a tunnel to VPN... however I didn&#039;t have a route out , so I need to look into why.</p><div class="codebox"><pre><code>Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: OpenVPN 2.3.11 arm-openwrt-linux-gnu [SSL (OpenSSL)] [LZO] [EPOLL] [MH] [IPv6]
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: library versions: OpenSSL 1.0.2h  3 May 2016, LZO 2.09
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: crypto_adjust_frame_parameters: Adjusting frame parameters for crypto by 56 bytes
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: LZO compression initialized
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: Control Channel MTU parms [ L:1558 D:1212 EF:38 EB:0 ET:0 EL:3 ]
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: Socket Buffers: R=[163840-&gt;163840] S=[163840-&gt;163840]
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: Data Channel MTU parms [ L:1558 D:1450 EF:58 EB:143 ET:0 EL:3 AF:3/1 ]
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: Local Options String: &#039;V4,dev-type tun,link-mtu 1558,tun-mtu 1500,proto UDPv4,comp-lzo,cipher AES-128-CBC,auth SHA1,keysize 128,key-method 2,tls-client&#039;
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: Expected Remote Options String: &#039;V4,dev-type tun,link-mtu 1558,tun-mtu 1500,proto UDPv4,comp-lzo,cipher AES-128-CBC,auth SHA1,keysize 128,key-method 2,tls-server&#039;
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: Local Options hash (VER=V4): &#039;66096c33&#039;
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: Expected Remote Options hash (VER=V4): &#039;691e95c7&#039;
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: NOTE: UID/GID downgrade will be delayed because of --client, --pull, or --up-delay
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 link local: [undef]
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 link remote: [AF_INET]173.44.49.122:1194
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]:  event_wait returned 1
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 WRITE [14] to [AF_INET]173.44.49.122:1194: P_CONTROL_HARD_RESET_CLIENT_V2 kid=0 sid=266579f1 8da860af [ ] pid=0 DATA 
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 write returned 14
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]:  event_wait returned 1
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 read returned 26
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 READ [26] from [AF_INET]173.44.49.122:1194: P_CONTROL_HARD_RESET_SERVER_V2 kid=0 sid=73ad65e9 daff1294 [ 0 sid=266579f1 8da860af ] pid=0 DATA 
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: TLS: Initial packet from [AF_INET]173.44.49.122:1194, sid=73ad65e9 daff1294
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]:  event_wait returned 1
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 WRITE [22] to [AF_INET]173.44.49.122:1194: P_ACK_V1 kid=0 sid=266579f1 8da860af [ 0 sid=73ad65e9 daff1294 ]
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 write returned 22
Tue Aug  9 19:59:05 2016 daemon.warn openvpn(sample_client)[11266]: WARNING: this configuration may cache passwords in memory -- use the auth-nocache option to prevent this
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]:  event_wait returned 1
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 WRITE [242] to [AF_INET]173.44.49.122:1194: P_CONTROL_V1 kid=0 sid=266579f1 8da860af [ ] pid=1 DATA 16030100 df010000 db0303ca eb60dcde 2f484069 6d17b705 d36ba62c 1707249[more...]
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 write returned 242
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]:  event_wait returned 1
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 read returned 1200
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 READ [1200] from [AF_INET]173.44.49.122:1194: P_CONTROL_V1 kid=0 sid=73ad65e9 daff1294 [ 1 sid=266579f1 8da860af ] pid=1 DATA 16030300 31020000 2d030357 aa7c59e7 6eb5b55f 0701e9b5 ae4950f6 e08a294[more...]
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]:  event_wait returned 1
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 WRITE [22] to [AF_INET]173.44.49.122:1194: P_ACK_V1 kid=0 sid=266579f1 8da860af [ 1 sid=73ad65e9 daff1294 ]
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 write returned 22
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]:  event_wait returned 1
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 read returned 1188
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 READ [1188] from [AF_INET]173.44.49.122:1194: P_CONTROL_V1 kid=0 sid=73ad65e9 daff1294 [ ] pid=2 DATA 1ee8927c 1fb6703c f267a8c5 acd1d307 130cad79 2a669259 d66e6006 b0b7345[more...]
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]:  event_wait returned 1
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 WRITE [22] to [AF_INET]173.44.49.122:1194: P_ACK_V1 kid=0 sid=266579f1 8da860af [ 2 sid=73ad65e9 daff1294 ]
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 write returned 22
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]:  event_wait returned 1
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 read returned 1073
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 READ [1073] from [AF_INET]173.44.49.122:1194: P_CONTROL_V1 kid=0 sid=73ad65e9 daff1294 [ ] pid=3 DATA 00038201 0100511b 8e839cbf fc1003db 8bf78e42 58b958ee e5447632 6497652[more...]
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: VERIFY OK: depth=1, C=US, ST=FL, L=Orlando, O=TorGuard, OU=VPN, CN=TG-OVPN-CA, name=TorGuard, emailAddress=sysadmin@torguard.net
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: Validating certificate key usage
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: ++ Certificate has key usage  00a0, expects 00a0
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: VERIFY KU OK
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: Validating certificate extended key usage
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: ++ Certificate has EKU (str) TLS Web Server Authentication, expects TLS Web Server Authentication
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: VERIFY EKU OK
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: VERIFY OK: depth=0, C=US, ST=FL, L=Orlando, O=TorGuard, OU=VPN, CN=TG-OVPN-CA, name=TorGuard, emailAddress=sysadmin@torguard.net
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]:  event_wait returned 1
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 WRITE [344] to [AF_INET]173.44.49.122:1194: P_CONTROL_V1 kid=0 sid=266579f1 8da860af [ 3 sid=73ad65e9 daff1294 ] pid=2 DATA 16030301 06100001 02010035 a3a73a7d 2fd06b58 8d475c6f 77a4d9d3 978ff54[more...]
Tue Aug  9 19:59:05 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 write returned 344
Tue Aug  9 19:59:06 2016 daemon.notice openvpn(sample_client)[11266]:  event_wait returned 1
Tue Aug  9 19:59:06 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 read returned 77
Tue Aug  9 19:59:06 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 READ [77] from [AF_INET]173.44.49.122:1194: P_CONTROL_V1 kid=0 sid=73ad65e9 daff1294 [ 2 sid=266579f1 8da860af ] pid=4 DATA 14030300 01011603 030028fb e321d33b 228700f4 9de9e49a a4ccea03 541e912[more...]
Tue Aug  9 19:59:06 2016 daemon.notice openvpn(sample_client)[11266]:  event_wait returned 1
Tue Aug  9 19:59:06 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 WRITE [364] to [AF_INET]173.44.49.122:1194: P_CONTROL_V1 kid=0 sid=266579f1 8da860af [ 4 sid=73ad65e9 daff1294 ] pid=3 DATA 17030301 4d286422 f8a44644 7c6280a9 6ba2d93f 989c3994 fb3843a6 84b5efe[more...]
Tue Aug  9 19:59:06 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 write returned 364
Tue Aug  9 19:59:06 2016 daemon.notice openvpn(sample_client)[11266]:  event_wait returned 1
Tue Aug  9 19:59:06 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 read returned 261
Tue Aug  9 19:59:06 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 READ [261] from [AF_INET]173.44.49.122:1194: P_CONTROL_V1 kid=0 sid=73ad65e9 daff1294 [ 3 sid=266579f1 8da860af ] pid=5 DATA 17030300 e6fbe321 d33b2287 01dbacab 61916127 fc1d9b9d fc9d150a 9d370ca[more...]
Tue Aug  9 19:59:06 2016 daemon.warn openvpn(sample_client)[11266]: WARNING: &#039;tun-mtu&#039; is used inconsistently, local=&#039;tun-mtu 1500&#039;, remote=&#039;tun-mtu 1532&#039;
Tue Aug  9 19:59:06 2016 daemon.warn openvpn(sample_client)[11266]: WARNING: &#039;cipher&#039; is used inconsistently, local=&#039;cipher AES-128-CBC&#039;, remote=&#039;cipher [null-cipher]&#039;
Tue Aug  9 19:59:06 2016 daemon.warn openvpn(sample_client)[11266]: WARNING: &#039;keysize&#039; is used inconsistently, local=&#039;keysize 128&#039;, remote=&#039;keysize 0&#039;
Tue Aug  9 19:59:06 2016 daemon.notice openvpn(sample_client)[11266]: Data Channel Encrypt: Cipher &#039;AES-128-CBC&#039; initialized with 128 bit key
Tue Aug  9 19:59:06 2016 daemon.notice openvpn(sample_client)[11266]: Data Channel Encrypt: Using 160 bit message hash &#039;SHA1&#039; for HMAC authentication
Tue Aug  9 19:59:06 2016 daemon.notice openvpn(sample_client)[11266]: Data Channel Decrypt: Cipher &#039;AES-128-CBC&#039; initialized with 128 bit key
Tue Aug  9 19:59:06 2016 daemon.notice openvpn(sample_client)[11266]: Data Channel Decrypt: Using 160 bit message hash &#039;SHA1&#039; for HMAC authentication
Tue Aug  9 19:59:06 2016 daemon.notice openvpn(sample_client)[11266]:  event_wait returned 1
Tue Aug  9 19:59:06 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 WRITE [22] to [AF_INET]173.44.49.122:1194: P_ACK_V1 kid=0 sid=266579f1 8da860af [ 5 sid=73ad65e9 daff1294 ]
Tue Aug  9 19:59:06 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 write returned 22
Tue Aug  9 19:59:06 2016 daemon.notice openvpn(sample_client)[11266]: Control Channel: TLSv1.2, cipher TLSv1/SSLv3 DHE-RSA-AES256-GCM-SHA384, 2048 bit RSA
Tue Aug  9 19:59:06 2016 daemon.notice openvpn(sample_client)[11266]: [TG-OVPN-CA] Peer Connection Initiated with [AF_INET]173.44.49.122:1194
Tue Aug  9 19:59:07 2016 daemon.notice openvpn(sample_client)[11266]:  event_wait returned 0
Tue Aug  9 19:59:08 2016 daemon.notice openvpn(sample_client)[11266]:  event_wait returned 0
Tue Aug  9 19:59:08 2016 daemon.notice openvpn(sample_client)[11266]: SENT CONTROL [TG-OVPN-CA]: &#039;PUSH_REQUEST&#039; (status=1)
Tue Aug  9 19:59:08 2016 daemon.notice openvpn(sample_client)[11266]:  event_wait returned 1
Tue Aug  9 19:59:08 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 WRITE [56] to [AF_INET]173.44.49.122:1194: P_CONTROL_V1 kid=0 sid=266579f1 8da860af [ ] pid=4 DATA 17030300 25286422 f8a44644 7d9d675a cbd44707 0b431e2f f5f36c2c 1478d98[more...]
Tue Aug  9 19:59:08 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 write returned 56
Tue Aug  9 19:59:08 2016 daemon.notice openvpn(sample_client)[11266]:  event_wait returned 1
Tue Aug  9 19:59:08 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 read returned 22
Tue Aug  9 19:59:08 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 READ [22] from [AF_INET]173.44.49.122:1194: P_ACK_V1 kid=0 sid=73ad65e9 daff1294 [ 4 sid=266579f1 8da860af ]
Tue Aug  9 19:59:08 2016 daemon.notice openvpn(sample_client)[11266]:  event_wait returned 1
Tue Aug  9 19:59:08 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 read returned 211
Tue Aug  9 19:59:08 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 READ [211] from [AF_INET]173.44.49.122:1194: P_CONTROL_V1 kid=0 sid=73ad65e9 daff1294 [ ] pid=6 DATA 17030300 c0fbe321 d33b2287 025b15a5 ae70dbfb 4ce64e31 8e6adb48 4110b57[more...]
Tue Aug  9 19:59:08 2016 daemon.notice openvpn(sample_client)[11266]: PUSH: Received control message: &#039;PUSH_REPLY,redirect-gateway def1,dhcp-option DNS 10.25.0.1,dhcp-option DNS 10.25.0.1,route 10.25.0.1,topology net30,ping 5,ping-restart 30,ifconfig 10.25.0.6 10.25.0.5&#039;
Tue Aug  9 19:59:08 2016 daemon.notice openvpn(sample_client)[11266]: OPTIONS IMPORT: timers and/or timeouts modified
Tue Aug  9 19:59:08 2016 daemon.notice openvpn(sample_client)[11266]: OPTIONS IMPORT: --ifconfig/up options modified
Tue Aug  9 19:59:08 2016 daemon.notice openvpn(sample_client)[11266]: OPTIONS IMPORT: route options modified
Tue Aug  9 19:59:08 2016 daemon.notice openvpn(sample_client)[11266]: OPTIONS IMPORT: --ip-win32 and/or --dhcp-option options modified
Tue Aug  9 19:59:08 2016 daemon.notice openvpn(sample_client)[11266]: TUN/TAP device tun0 opened
Tue Aug  9 19:59:08 2016 daemon.notice openvpn(sample_client)[11266]: TUN/TAP TX queue length set to 100
Tue Aug  9 19:59:08 2016 daemon.notice openvpn(sample_client)[11266]: do_ifconfig, tt-&gt;ipv6=0, tt-&gt;did_ifconfig_ipv6_setup=0
Tue Aug  9 19:59:08 2016 daemon.notice openvpn(sample_client)[11266]: /sbin/ifconfig tun0 10.25.0.6 pointopoint 10.25.0.5 mtu 1500
Tue Aug  9 19:59:08 2016 daemon.notice openvpn(sample_client)[11266]: /sbin/route add -net 173.44.49.122 netmask 255.255.255.255 gw 216.170.192.1
Tue Aug  9 19:59:08 2016 daemon.notice openvpn(sample_client)[11266]: /sbin/route add -net 0.0.0.0 netmask 128.0.0.0 gw 10.25.0.5
Tue Aug  9 19:59:08 2016 daemon.notice openvpn(sample_client)[11266]: /sbin/route add -net 128.0.0.0 netmask 128.0.0.0 gw 10.25.0.5
Tue Aug  9 19:59:08 2016 daemon.notice openvpn(sample_client)[11266]: /sbin/route add -net 10.25.0.1 netmask 255.255.255.255 gw 10.25.0.5
Tue Aug  9 19:59:08 2016 daemon.notice openvpn(sample_client)[11266]: UID set to nobody
Tue Aug  9 19:59:08 2016 daemon.notice openvpn(sample_client)[11266]: Initialization Sequence Completed
Tue Aug  9 19:59:08 2016 daemon.notice openvpn(sample_client)[11266]:  event_wait returned 1
Tue Aug  9 19:59:08 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 WRITE [22] to [AF_INET]173.44.49.122:1194: P_ACK_V1 kid=0 sid=266579f1 8da860af [ 6 sid=73ad65e9 daff1294 ]
Tue Aug  9 19:59:08 2016 daemon.notice openvpn(sample_client)[11266]: UDPv4 write returned 22</code></pre></div><p>**EDIT --&nbsp; I have 100mbps fiber service right now, so I don&#039;t think I&#039;m going to max out the processor before I get to 100. Will test when finished with config.</p>											<p class="post-edited">(Last edited by <strong>davidc502</strong> on 10 Aug 2016, 04:20)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333868">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">davidc502</div>
					<div class="post-datetime">
						10 Aug 2016, 04:59					</div>
				</div>
				<div class="post-content content">
					<p>Okay... now I&#039;m connected and is working properly. The issue was I didn&#039;t set up the option port of 80.</p><p>Speed tests are abysmal <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" />&nbsp; &nbsp;I&#039;m getting a whopping 6mbps/6mbps !</p><p>Looks like about 50% of the cpu is being used at 6mbps....</p><p>27876&nbsp; &nbsp; &nbsp;1 nobody&nbsp; &nbsp;R&nbsp; &nbsp; &nbsp;3096&nbsp; &nbsp;1%&nbsp; 42% /usr/sbin/openvpn --syslog openvpn(sa</p><br /><p>***EDIT*** Looking around it appears, I need to enable marvel-cesa when I start openVPN.</p>											<p class="post-edited">(Last edited by <strong>davidc502</strong> on 10 Aug 2016, 05:43)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333881">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">alexandrosio</div>
					<div class="post-datetime">
						10 Aug 2016, 08:33					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>davidc502 wrote:</cite><blockquote><p>Okay... now I&#039;m connected and is working properly. The issue was I didn&#039;t set up the option port of 80.</p><p>Speed tests are abysmal <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" />&nbsp; &nbsp;I&#039;m getting a whopping 6mbps/6mbps !</p><p>Looks like about 50% of the cpu is being used at 6mbps....</p><p>27876&nbsp; &nbsp; &nbsp;1 nobody&nbsp; &nbsp;R&nbsp; &nbsp; &nbsp;3096&nbsp; &nbsp;1%&nbsp; 42% /usr/sbin/openvpn --syslog openvpn(sa</p><br /><p>***EDIT*** Looking around it appears, I need to enable marvel-cesa when I start openVPN.</p></blockquote></div><p>David, you might want to take a look at this <a href="https://www.loganmarchione.com/2014/10/openwrt-with-openvpn-client-on-tp-link-tl-mr3020/">https://www.loganmarchione.com/2014/10/ … tl-mr3020/</a>; It came in handy, when I was setting up my OpenVPN client. However, I don&#039;t believe your speed issue is b/c of the crypto accelerator not being engaged, since I was getting 25 mbps/12 mbps even when Marvell CESA was not enabled. Yesterday, I compiled my own build, and I have managed to get Marvell CESA to work; but, as it seems, it only works when I perform an openssl benchmark with the <strong>-evp</strong> argument, and not as it should be. Take a look at here --&gt; <a href="https://forum.openwrt.org/viewtopic.php?pid=333866#p333866">https://forum.openwrt.org/viewtopic.php … 66#p333866</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333909">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">RangerZ</div>
					<div class="post-datetime">
						10 Aug 2016, 14:10					</div>
				</div>
				<div class="post-content content">
					<p>Did you uncomment the buffer lines at the bottom of the config file?</p><p>I would also test at different times of the day, as well as test some different servers.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333923">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">davidc502</div>
					<div class="post-datetime">
						10 Aug 2016, 16:14					</div>
				</div>
				<div class="post-content content">
					<p>@ RangerZ --&nbsp; I didn&#039;t copy/verbatim the DDWRT config file;&nbsp; I used it as a guideline to build my own.</p><p>@alexandrosio -- Thanks - will take a look at the resources.</p><p>The slowness appears to be a configuration issue on my end...&nbsp; From what I&#039;m reading there are several options to help optimize.. Will work further on it tonight.</p>											<p class="post-edited">(Last edited by <strong>davidc502</strong> on 10 Aug 2016, 19:39)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333931">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">RangerZ</div>
					<div class="post-datetime">
						10 Aug 2016, 17:03					</div>
				</div>
				<div class="post-content content">
					<p>Actually I was looking at the vendors Ubuntu files from the link in post 5.&nbsp; </p><div class="codebox"><pre><code># Uncomment these directives if you have speed issues
;sndbuf 393216
;rcvbuf 393216
;push &quot;sndbuf 393216&quot;
;push &quot;rcvbuf 393216&quot;</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p334004">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">davidc502</div>
					<div class="post-datetime">
						11 Aug 2016, 02:07					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>RangerZ wrote:</cite><blockquote><p>Actually I was looking at the vendors Ubuntu files from the link in post 5.&nbsp; </p><div class="codebox"><pre><code># Uncomment these directives if you have speed issues
;sndbuf 393216
;rcvbuf 393216
;push &quot;sndbuf 393216&quot;
;push &quot;rcvbuf 393216&quot;</code></pre></div></blockquote></div><p>I&#039;ve tried all 4 options with no change in speed.&nbsp; Still looking.</p>											<p class="post-edited">(Last edited by <strong>davidc502</strong> on 11 Aug 2016, 02:39)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p334008">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">davidc502</div>
					<div class="post-datetime">
						11 Aug 2016, 03:33					</div>
				</div>
				<div class="post-content content">
					<p>Wanted to try cryptodev but this is the message...</p><p>root@lede:~# openssl speed -engine cryptodev -evp aes-256-cbc<br />invalid engine &quot;cryptodev&quot;</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p334010">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">alexandrosio</div>
					<div class="post-datetime">
						11 Aug 2016, 03:58					</div>
				</div>
				<div class="post-content content">
					<p>David try the <em>openssl engine</em> command to see if the cryptodev engine is available to openssl.</p><p>Also, make sure your .config file follows what&#039;s included below:<br /></p><div class="codebox"><pre><code>CONFIG_OPENSSL_ENGINE_DIGEST=y
CONFIG_OPENSSL_HARDWARE_SUPPORT=y
CONFIG_OPENSSL_ENGINE_CRYPTO=y</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p334014">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">davidc502</div>
					<div class="post-datetime">
						11 Aug 2016, 06:03					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>alexandrosio wrote:</cite><blockquote><p>David try the <em>openssl engine</em> command to see if the cryptodev engine is available to openssl.</p><p>Also, make sure your .config file follows what&#039;s included below:<br /></p><div class="codebox"><pre><code>CONFIG_OPENSSL_ENGINE_DIGEST=y
CONFIG_OPENSSL_HARDWARE_SUPPORT=y
CONFIG_OPENSSL_ENGINE_CRYPTO=y</code></pre></div></blockquote></div><p>It looks like those are build options. Will look at adding them this Friday night when the new wifi drivers are added.</p>											<p class="post-edited">(Last edited by <strong>davidc502</strong> on 11 Aug 2016, 06:03)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p334016">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">RangerZ</div>
					<div class="post-datetime">
						11 Aug 2016, 06:25					</div>
				</div>
				<div class="post-content content">
					<p>I just took a look on the TorGuard site to see what speed &quot;promises&quot; they have.&nbsp; The last item on the FAQ page <a href="https://torguard.net/faq.php">https://torguard.net/faq.php</a> offers the following.<br /></p><div class="quotebox"><blockquote><p>Bandwidth and speeds are not limited in any way. All of our servers feature gigabit+ port speeds, so DL rates can vary from 5mbps – 100mbps+ depending on your connection speed, server load, CPU, distance from you to the location you are connecting to and ping, speed has many factors!</p></blockquote></div><p>I then had the little chat box popup.....<br /></p><div class="quotebox"><blockquote><p>I have a 100Mbit internet service. What kind of speeds can I expect over your US based connections. Is there any place this info is listed? Read</p><p>Emma VPN speed depends on Your ISP connection speed and the speed to the server where you are connecting. All our servers are on 1Gbit\100Mbit lines.</p></blockquote></div><p>Non-committal as I expected.</p><p>I have found reviews at extreme ends of the speed spectrum.<br />This review on Tom&#039;s Hardware finds&nbsp; your speeds are in line with the report, and actually better than most.<br /><a href="http://www.tomshardware.com/reviews/torguard-vpn-service,4133.html#p5">http://www.tomshardware.com/reviews/tor … 33.html#p5</a><br />This review fairs a lot better, <a href="http://best10vpn.com/torguard/review/">http://best10vpn.com/torguard/review/</a> and suggests the type of speed hit I would expect for having to encrypt/decrypt.</p><p>I guess I am suggesting that you may need to look at elements other than your config.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p334081">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">davidc502</div>
					<div class="post-datetime">
						11 Aug 2016, 18:39					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>davidc502 wrote:</cite><blockquote><div class="quotebox"><cite>alexandrosio wrote:</cite><blockquote><p>David try the <em>openssl engine</em> command to see if the cryptodev engine is available to openssl.</p><p>Also, make sure your .config file follows what&#039;s included below:<br /></p><div class="codebox"><pre><code>CONFIG_OPENSSL_ENGINE_DIGEST=y
CONFIG_OPENSSL_HARDWARE_SUPPORT=y
CONFIG_OPENSSL_ENGINE_CRYPTO=y</code></pre></div></blockquote></div><p>It looks like those are build options. Will look at adding them this Friday night when the new wifi drivers are added.</p></blockquote></div><p>The options have now been included in the .config to enable openssl support. So, will do more testing after this new build is installed on the 1900ac hardware.</p><p>davidc502@ubuntu:~/Desktop/lede/source$ cat .config |grep CONFIG_OPENSSL_<br />CONFIG_OPENSSL_WITH_EC=y<br /># CONFIG_OPENSSL_WITH_EC2M is not set<br /># CONFIG_OPENSSL_WITH_SSL3 is not set<br />CONFIG_OPENSSL_WITH_DEPRECATED=y<br />CONFIG_OPENSSL_WITH_COMPRESSION=y<br />CONFIG_OPENSSL_WITH_NPN=y<br />CONFIG_OPENSSL_WITH_PSK=y<br />CONFIG_OPENSSL_WITH_SRP=y<br />CONFIG_OPENSSL_ENGINE_DIGEST=y &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; ADDED<br />CONFIG_OPENSSL_HARDWARE_SUPPORT=y&nbsp; &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; ADDED<br />CONFIG_OPENSSL_ENGINE_CRYPTO=y&nbsp; &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; ADDED</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p334086">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">davidc502</div>
					<div class="post-datetime">
						11 Aug 2016, 18:46					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>RangerZ wrote:</cite><blockquote><p>I just took a look on the TorGuard site to see what speed &quot;promises&quot; they have.&nbsp; The last item on the FAQ page <a href="https://torguard.net/faq.php">https://torguard.net/faq.php</a> offers the following.<br /></p><div class="quotebox"><blockquote><p>Bandwidth and speeds are not limited in any way. All of our servers feature gigabit+ port speeds, so DL rates can vary from 5mbps – 100mbps+ depending on your connection speed, server load, CPU, distance from you to the location you are connecting to and ping, speed has many factors!</p></blockquote></div><p>I then had the little chat box popup.....<br /></p><div class="quotebox"><blockquote><p>I have a 100Mbit internet service. What kind of speeds can I expect over your US based connections. Is there any place this info is listed? Read</p><p>Emma VPN speed depends on Your ISP connection speed and the speed to the server where you are connecting. All our servers are on 1Gbit\100Mbit lines.</p></blockquote></div><p>Non-committal as I expected.</p><p>I have found reviews at extreme ends of the speed spectrum.<br />This review on Tom&#039;s Hardware finds&nbsp; your speeds are in line with the report, and actually better than most.<br /><a href="http://www.tomshardware.com/reviews/torguard-vpn-service,4133.html#p5">http://www.tomshardware.com/reviews/tor … 33.html#p5</a><br />This review fairs a lot better, <a href="http://best10vpn.com/torguard/review/">http://best10vpn.com/torguard/review/</a> and suggests the type of speed hit I would expect for having to encrypt/decrypt.</p><p>I guess I am suggesting that you may need to look at elements other than your config.</p></blockquote></div><p>I absolutely appreciate what you&#039;re saying here to start this off <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /> </p><p>Speed tests run from the PC show a full 100mbps bandwidth running torrents.. Well, at least from the 2 sites tried (Atlanta and Miami).&nbsp; For the 3 years, I&#039;ve had the service (5 bucks a month), at least running from my PC, I haven&#039;t had any speed issues. Yeah, whilst torrenting, there have been fluctuations, but they haven&#039;t lasted any more than a few minutes, and then the speed jumps back up... At least that&#039;s been my experience with the service, and others probably vastly differ <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />&nbsp; I&#039;m not trying to defend Torguard, but am just stating what I&#039;ve seen over the last 3 years... and if I were to catalog this a little further, I don&#039;t run it that often, so if I were connected 24/7, the speeds would probably drastically differ. Just a guess, but people connected more often probably do see more problems.</p><p>With that said, I would like to expect the same out of the router, but don&#039;t know if it is realistic.</p>											<p class="post-edited">(Last edited by <strong>davidc502</strong> on 11 Aug 2016, 18:47)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p334099">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">RangerZ</div>
					<div class="post-datetime">
						11 Aug 2016, 20:30					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><p>Speed tests run from the PC show a full 100mbps bandwidth running torrents.</p></blockquote></div><p>If this is a VPN service, then I will agree something is wrong.&nbsp; Their current $5.95 service is just a proxy (I think) their $9.95 is VPN, but you may be on a grandfathered plan.&nbsp; </p><p>I expect a hit from the relatively lower level router hardware, but the 1900AC is better than my ALIX.&nbsp; &nbsp;I can beat the 6 using my little GL.inet AR150 to call home (with a good connection).</p><p>There are some things about tweaking OpenVPN on the OpenVPN site and other blogs.&nbsp; I use a similar set of directives that I notes above, along with a lowered MTU, which if I recall gained me about 20-30% speed boost, however I also had control of the server.&nbsp; This is still not the magnitude of difference you are talking about.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p334131">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">davidc502</div>
					<div class="post-datetime">
						12 Aug 2016, 01:53					</div>
				</div>
				<div class="post-content content">
					<p>It&#039;s interesting because originally, I signed up for the proxy service, but that same year they made the VPN client available. Ended up downloading the VPN client and it works just fine, and I&#039;ve checked with WireShark and sure enough, the traffic is encrypted.</p><p>So, I&#039;m not ever going to complain, unless they back bill me for the 3 years I&#039;ve been using it. lol&nbsp; **shhhh, I think if you have the 5.99 proxy service, VPN works too.&nbsp; It&#039;s either that or something changed over the period of time I&#039;ve been with them.</p>											<p class="post-edited">(Last edited by <strong>davidc502</strong> on 12 Aug 2016, 01:54)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p334364">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">RangerZ</div>
					<div class="post-datetime">
						13 Aug 2016, 21:00					</div>
				</div>
				<div class="post-content content">
					<p>I see you have added this to the new build.&nbsp; </p><p>Did you conquer the speed issue?</p><p>It might be worth posting your config for other potential users of torquard.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p334373">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">davidc502</div>
					<div class="post-datetime">
						13 Aug 2016, 22:03					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>RangerZ wrote:</cite><blockquote><p>I see you have added this to the new build.&nbsp; </p><p>Did you conquer the speed issue?</p><p>It might be worth posting your config for other potential users of torquard.</p></blockquote></div><p>Cryptodev is set -- See below -- However, speeds haven&#039;t changed at all.. I&#039;m perplexed? Thoughts?</p><div class="codebox"><pre><code>root@lede:~# openssl speed -engine cryptodev -evp aes-256-cbc
engine &quot;cryptodev&quot; set.
Doing aes-256-cbc for 3s on 16 size blocks: 193434 aes-256-cbc&#039;s in 0.04s
Doing aes-256-cbc for 3s on 64 size blocks: 190799 aes-256-cbc&#039;s in 0.04s
Doing aes-256-cbc for 3s on 256 size blocks: 173022 aes-256-cbc&#039;s in 0.13s
Doing aes-256-cbc for 3s on 1024 size blocks: 126870 aes-256-cbc&#039;s in 0.06s
Doing aes-256-cbc for 3s on 8192 size blocks: 29231 aes-256-cbc&#039;s in 0.00s
OpenSSL 1.0.2h  3 May 2016
built on: reproducible build, date unspecified
options:bn(64,32) rc4(ptr,char) des(idx,cisc,2,long) aes(partial) blowfish(ptr)
compiler: arm-openwrt-linux-muslgnueabi-gcc -I. -I.. -I../include  -fPIC -DOPENSSL_PIC -DZLIB_SHARED -DZLIB -DOPENSSL_THREADS -D_REENTRANT -DDSO_DLFCN -DHAVE_DLFCN_H -I/home/ag33e33/Desktop/lede/source/staging_dir/target-arm_cortex-a9+vfpv3_musl-1.1.15_eabi/usr/include -I/home/ag33e33/Desktop/lede/source/staging_dir/target-arm_cortex-a9+vfpv3_musl-1.1.15_eabi/include -I/home/ag33e33/Desktop/lede/source/staging_dir/toolchain-arm_cortex-a9+vfpv3_gcc-5.4.0_musl-1.1.15_eabi/usr/include -I/home/ag33e33/Desktop/lede/source/staging_dir/toolchain-arm_cortex-a9+vfpv3_gcc-5.4.0_musl-1.1.15_eabi/include/fortify -I/home/ag33e33/Desktop/lede/source/staging_dir/toolchain-arm_cortex-a9+vfpv3_gcc-5.4.0_musl-1.1.15_eabi/include -znow -zrelro -DOPENSSL_SMALL_FOOTPRINT -DHAVE_CRYPTODEV -DUSE_CRYPTODEV_DIGESTS -DOPENSSL_NO_ERR -DTERMIOS -Os -pipe -mcpu=cortex-a9 -mfpu=vfpv3-d16 -fno-caller-saves -fno-plt -fhonour-copts -Wno-error=unused-but-set-variable -Wno-error=unused-result -mfloat-abi=soft -iremap /home/ag33e33/Desktop/lede/source/build_dir/target-arm_cortex-a9+vfpv3_musl-1.1.15_eabi/openssl-1.0.2h:openssl-1.0.2h -Wformat -Werror=format-security -fstack-protector -D_FORTIFY_SOURCE=1 -Wl,-z,now -Wl,-z,relro -fpic -I/home/ag33e33/Desktop/lede/source/package/libs/openssl/include -ffunction-sections -fdata-sections -fomit-frame-pointer -Wall
The &#039;numbers&#039; are in 1000s of bytes per second processed.
type             16 bytes     64 bytes    256 bytes   1024 bytes   8192 bytes
aes-256-cbc      77373.60k   305278.40k   340720.25k  2165248.00k         infk</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p334375">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">davidc502</div>
					<div class="post-datetime">
						13 Aug 2016, 22:05					</div>
				</div>
				<div class="post-content content">
					<p>Notice the change when I take out the -eap option...<br /></p><div class="codebox"><pre><code>root@lede:~# openssl speed -engine cryptodev aes-256-cbc
engine &quot;cryptodev&quot; set.
Doing aes-256 cbc for 3s on 16 size blocks: 3950368 aes-256 cbc&#039;s in 3.00s
Doing aes-256 cbc for 3s on 64 size blocks: 1058301 aes-256 cbc&#039;s in 2.99s
Doing aes-256 cbc for 3s on 256 size blocks: 271044 aes-256 cbc&#039;s in 3.00s
Doing aes-256 cbc for 3s on 1024 size blocks: 68217 aes-256 cbc&#039;s in 2.99s
Doing aes-256 cbc for 3s on 8192 size blocks: 8521 aes-256 cbc&#039;s in 3.00s</code></pre></div><p>appears to be much faster with that option. At least with the test.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p334376">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">anomeome</div>
					<div class="post-datetime">
						13 Aug 2016, 22:09					</div>
				</div>
				<div class="post-content content">
					<p>The metrics are little confusing, but your first one with -evp is good. Look at the time it took 0.04 secs to do the run, rather than the full 3 secs. You also should not need the -engine specifier if things are right with openssl build</p><p>openssl engine -t -c</p>											<p class="post-edited">(Last edited by <strong>anomeome</strong> on 13 Aug 2016, 22:13)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p334378">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">davidc502</div>
					<div class="post-datetime">
						13 Aug 2016, 22:15					</div>
				</div>
				<div class="post-content content">
					<p>In the luci configuration I put the following</p><p>engine= cryptodev -eap</p><p>I&#039;ve tried it both ways.. with and without the -evp option with no change.</p><p>Looking at the logs, It appears the -evp option is being ignored in this text box.</p><p>Is there another place where this option can be set?</p><p>Logging ---<br /></p><div class="codebox"><pre><code>Sat Aug 13 14:15:30 2016 daemon.notice openvpn(sample_client)[5972]: library versions: OpenSSL 1.0.2h  3 May 2016, LZO 2.09
Sat Aug 13 14:15:30 2016 daemon.notice openvpn(sample_client)[5972]: Initializing OpenSSL support for engine &#039;cryptodev&#039;
Sat Aug 13 14:15:30 2016 daemon.notice openvpn(sample_client)[5972]: crypto_adjust_frame_parameters: Adjusting frame parameters for crypto by 56 bytes
Sat Aug 13 14:15:30 2016 daemon.notice openvpn(sample_client)[5972]: LZO compression initialized
Sat Aug 13 14:15:30 2016 daemon.warn openvpn(sample_client)[5972]: WARNING: normally if you use --mssfix and/or --fragment, you should also set --tun-mtu 1500 (currently it is 1558)
Sat Aug 13 14:15:30 2016 daemon.notice openvpn(sample_client)[5972]: Control Channel MTU parms [ L:1616 D:1212 EF:38 EB:0 ET:0 EL:3 ]
Sat Aug 13 14:15:30 2016 daemon.notice openvpn(sample_client)[5972]: Socket Buffers: R=[163840-&gt;327680] S=[163840-&gt;327680]
Sat Aug 13 14:15:30 2016 daemon.notice openvpn(sample_client)[5972]: Data Channel MTU parms [ L:1616 D:1450 EF:58 EB:143 ET:0 EL:3 AF:3/1 ]
Sat Aug 13 14:15:30 2016 daemon.notice openvpn(sample_client)[5972]: Local Options String: &#039;V4,dev-type tun,link-mtu 1616,tun-mtu 1558,proto UDPv4,comp-lzo,cipher AES-128-CBC,auth SHA1,keysize 128,key-method 2,tls-client&#039;
Sat Aug 13 14:15:30 2016 daemon.notice openvpn(sample_client)[5972]: Expected Remote Options String: &#039;V4,dev-type tun,link-mtu 1616,tun-mtu 1558,proto UDPv4,comp-lzo,cipher AES-128-CBC,auth SHA1,keysize 128,key-method 2,tls-server&#039;</code></pre></div>											<p class="post-edited">(Last edited by <strong>davidc502</strong> on 13 Aug 2016, 22:33)</p>
									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=66682&amp;p=2.html">2</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>