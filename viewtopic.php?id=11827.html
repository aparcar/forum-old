<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> WL-500GP 7.06 Audio works update to 7.07 not</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 6 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p52953">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">casio</div>
					<div class="post-datetime">
						28 Jul 2007, 03:42					</div>
				</div>
				<div class="post-content content">
					<p>Yesterday I installed Kamikaze 7.06 and plugged my USB Audio device (CMedia chipset) installed kmod-usb-core, kmod-soundcore, kmod-usb-audio and everything worked with in 10 minutes!</p><p>Afterwards I wanted to install the kmod-fs-xxx packages but got an depenencie error with kmod-nls-base. This is solved in Kamikaze 7.07 so today I flashed my router again. Installed the same kernel mods as listed above but no audio worked at all... The led of the USB Audio device (red) doesn&#039;t lit as it should be... </p><p>Does anyone had the same problem, am I doing something sily? Mabye it remebers something about the usb device? It works fine in my laptop (ubuntu).</p><p>dmesg: (below is the (not) interresting part)<br /></p><div class="codebox"><pre><code>CPU revision is: 00029006
Primary instruction cache 16kB, physically tagged, 2-way, linesize 16 bytes.
Primary data cache 16kB, 2-way, linesize 16 bytes.
Linux version 2.4.34 (nbd@ds10) (gcc version 3.4.6 (OpenWrt-2.0)) #13 Fri Jun 1 15:51:35 CEST 2007
Setting the PFC to its default value
Determined physical RAM map:
 memory: 02000000 @ 00000000 (usable)
On node 0 totalpages: 8192
zone(0): 8192 pages.
zone(1): 0 pages.
zone(2): 0 pages.
Kernel command line: root=/dev/mtdblock2 rootfstype=squashfs,jffs2 init=/etc/preinit noinitrd console=ttyS0,115200
CPU: BCM4704 rev 9 at 264 MHz
Using 132.000 MHz high precision timer.
Calibrating delay loop... 262.96 BogoMIPS
Memory: 30440k/32768k available (1459k kernel code, 2328k reserved, 100k data, 80k init, 0k highmem)Dentry cache hash table entries: 4096 (order: 3, 32768 bytes)
Inode cache hash table entries: 2048 (order: 2, 16384 bytes)
Mount cache hash table entries: 512 (order: 0, 4096 bytes)
Buffer cache hash table entries: 1024 (order: 0, 4096 bytes)
Page-cache hash table entries: 8192 (order: 3, 32768 bytes)
Checking for &#039;wait&#039; instruction...  unavailable.
POSIX conformance testing by UNIFIX
PCI: Initializing host
PCI: Fixing up bus 0
PCI: Fixing up bridge
PCI: Setting latency timer of device 01:00.0 to 64
PCI: Fixing up bus 1
Linux NET4.0 for Linux 2.4
Based upon Swansea University Computer Society NET3.039
Initializing RT netlink socket
Starting kswapd
Registering mini_fo version $Id$
devfs: v1.12c (20020818) Richard Gooch (rgooch@atnf.csiro.au)
devfs: boot_options: 0x1
JFFS2 version 2.1. (C) 2001 Red Hat, Inc., designed by Axis Communications AB.
squashfs: version 3.0 (2006/03/15) Phillip Lougher
pty: 256 Unix98 ptys configured
Serial driver version 5.05c (2001-07-08) with MANY_PORTS SHARE_IRQ SERIAL_PCI enabled
ttyS00 at 0xb8000300 (irq = 3) is a 16550A
ttyS01 at 0xb8000400 (irq = 3) is a 16550A
b44.c:v0.93 (Mar, 2004)
PCI: Setting latency timer of device 00:01.0 to 64
eth0: Broadcom 47xx 10/100BaseT Ethernet 00:1b:fc:6b:7e:e4
PCI: Setting latency timer of device 00:02.0 to 64
eth1: Broadcom 47xx 10/100BaseT Ethernet 40:10:18:00:00:2d
Physically mapped flash: Found an alias at 0x800000 for the chip at 0x0
Physically mapped flash: Found an alias at 0x1000000 for the chip at 0x0
Physically mapped flash: Found an alias at 0x1800000 for the chip at 0x0
 Amd/Fujitsu Extended Query Table v1.3 at 0x0040
number of CFI chips: 1
cfi_cmdset_0002: Disabling fast programming due to code brokenness.
Flash device: 0x800000 at 0x1c000000
bootloader size: 262144
Physically mapped flash: Filesystem type: squashfs, size=0x11e3cf
Creating 5 MTD partitions on &quot;Physically mapped flash&quot;:
0x00000000-0x00040000 : &quot;cfe&quot;
0x00040000-0x007f0000 : &quot;linux&quot;
0x000be000-0x001e0000 : &quot;rootfs&quot;
mtd: partition &quot;rootfs&quot; doesn&#039;t start on an erase block boundary -- force read-only
0x007f0000-0x00800000 : &quot;nvram&quot;
0x001e0000-0x007f0000 : &quot;rootfs_data&quot;
sflash: found no supported devices
Initializing Cryptographic API
NET4: Linux TCP/IP 1.0 for NET4.0
IP Protocols: ICMP, UDP, TCP, IGMP
IP: routing cache hash table of 512 buckets, 4Kbytes
TCP: Hash tables configured (established 2048 bind 4096)
ip_conntrack version 2.1 (5953 buckets, 5953 max) - 360 bytes per conntrack
ip_tables: (C) 2000-2002 Netfilter core team
NET4: Unix domain sockets 1.0/SMP for Linux NET4.0.
NET4: Ethernet Bridge 008 for NET4.0
802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;
All bugs added by David S. Miller &lt;davem@redhat.com&gt;
VFS: Mounted root (squashfs filesystem) readonly.
Mounted devfs on /dev
Freeing unused kernel memory: 80k freed
Algorithmics/MIPS FPU Emulator v1.5
diag: Detected &#039;ASUS WL-500g Premium&#039;
b44: eth0: Link is up at 100 Mbps, full duplex.
b44: eth0: Flow control is off for TX and off for RX.
Probing device eth0: found!
mini_fo: using base directory: /
mini_fo: using storage directory: /jffs
jffs2.bbc: SIZE compression mode activated.
b44: eth0: Link is up at 100 Mbps, full duplex.
b44: eth0: Flow control is off for TX and off for RX.
eth0.0: dev_set_promiscuity(master, 1)
device eth0 entered promiscuous mode
device eth0.0 entered promiscuous mode
BFL_ENETADM not set in boardflags. Use force=1 to ignore.
br-lan: port 1(eth0.0) entering learning state
br-lan: port 1(eth0.0) entering forwarding state
br-lan: topology change detected, propagating
usb.c: registered new driver usbdevfs
usb.c: registered new driver hub
eth0.1: add 01:00:5e:00:00:01 mcast address to master interface
PCI: Setting latency timer of device 01:02.0 to 64
PCI: Enabling device 01:02.0 (0004 -&gt; 0006)
wl0: Broadcom BCM4318 802.11 Wireless Controller 4.80.53.0
CSLIP: code copyright 1989 Regents of the University of California
PPP generic driver version 2.4.2
usb.c: registered new driver audio
audio.c: v1.0.0:USB Audio Class driver</code></pre></div><p>ipkg list_installed:<br /></p><div class="codebox"><pre><code>base-files-brcm-2.4 - 8-7431 -
bridge - 1.0.6-1 -
busybox - 1.4.2-1 -
dnsmasq - 2.38-1 -
dropbear - 0.49-1 -
iptables - 1.3.5-1 -
kernel - 2.4.34-brcm-1 -
kmod-alsa - 1.0.14rc1-1 -
kmod-brcm-wl - 2.4.34+4.80.53.0-1 -
kmod-diag - 1+2.4.34-brcm-1 -
kmod-ipt-nathelper - 2.4.34-brcm-1 -
kmod-ppp - 2.4.34-brcm-1 -
kmod-pppoe - 2.4.34-brcm-1 -
kmod-soundcore - 2.4.34-brcm-1 -
kmod-switch - 2.4.34-brcm-1 -
kmod-usb-audio - 2.4.34-brcm-1 -
kmod-usb-core - 2.4.34-brcm-1 -
kmod-wlcompat - 2.4.34+brcm-4 -
libgcc - 3.4.6-8 -
mtd - 5 -
nas - 4.80.53.0-1 -
nvram - 1 -
ppp - 2.4.3-7 -
ppp-mod-pppoe - 2.4.3-7 -
uclibc - 0.9.28-8 -
wireless-tools - 28-1 -
wlc - 4.80.53.0-1 -</code></pre></div><p>By the way I am more a hardwar guy... I am setting up a uC to the serial connection with a graphical display plus touch screen and a volume knob. The whole thing is going to be a set of two (or more) WL routers wireless connected to the network with a MP3 share. The idee is to be able to listen to music (different) in all rooms of the appartment and also to listen synchronized to the same song.</p><p>[update]<br />Afterwards I flashed the router back to 7.06 (I couln&#039;t find any thing that I did wrong) but still not any positive result.</p>											<p class="post-edited">(Last edited by <strong>casio</strong> on 30 Jul 2007, 13:13)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p53085">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">casio</div>
					<div class="post-datetime">
						30 Jul 2007, 13:17					</div>
				</div>
				<div class="post-content content">
					<p>Maybe my problem has something related to this topic: <a href="http://forum.openwrt.org/viewtopic.php?id=8138">http://forum.openwrt.org/viewtopic.php?id=8138</a>. I did install kmod-usb2 (when using 7.07) to test my USB HDD which worked fine. Then I installed kmod-souncore and kmod-usb-audio but I couldn&#039;t get the audio to work...</p><p>It sounds silly but could it help flashing back to the original firmware from asus and then again back to 7.06?</p><p>[update]</p><p>Went back to the original asus firmware and reset everything to default. Then I flashed to OpenWrt Kamikaze 7.06 again installed the kmod-usb-core, kmod-soudcore, and the kmod-usb-audio but no succes!?</p><p>Currently I&#039;m building the firmware with de dev buildroot enviroment and include the module code in the kernel instead of loading the modules in a later stage. Hoping this solves the problem...</p>											<p class="post-edited">(Last edited by <strong>casio</strong> on 31 Jul 2007, 16:44)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p53204">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">casio</div>
					<div class="post-datetime">
						1 Aug 2007, 11:13					</div>
				</div>
				<div class="post-content content">
					<p>Everything works fine now! I downloaded the latest build environment files with subversion</p><div class="codebox"><pre><code>svn co https://svn.openwrt.org/openwrt/tags/kamikaze_7.07</code></pre></div><p>see <a href="https://dev.openwrt.org/">https://dev.openwrt.org/</a> for more information. I configured the kernel with<br /></p><div class="codebox"><pre><code>make menuconfig</code></pre></div><p>selected the correct HW, profile (router type), and the required modifications like soundcore, usb-audio, some for the USB storage and file system support.</p><p>Afterwards I saved the configuration and typed<br /></p><div class="codebox"><pre><code>make</code></pre></div><p>to compile everything and create a firmware. Then I flashed the new created firmware and it works!</p><p>I still don&#039;t have an explanation why it worked the first time using the ipkg and insmod method and after upgrading the firmware not… Maybe some USB guru has the answers?</p><p>Now back to the graphical display with touch screen…</p>											<p class="post-edited">(Last edited by <strong>casio</strong> on 1 Aug 2007, 11:15)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>