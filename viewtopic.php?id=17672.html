<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Use RIP/Quagga between two routers</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 18 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p76365">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Fiete</div>
					<div class="post-datetime">
						13 Nov 2008, 12:53					</div>
				</div>
				<div class="post-content content">
					<p>Hey dear community,</p><p>I am a newbie on the terrain of OpenWRT, but I love it... and I would like be an expert <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /> Now my problem!</p><p>For a test I want to use the RIP protocol. I had found the quagga Package but the How 2&#039;s in the net not really help me. I know what RIP is, but I don&#039;t know how to configure it in quagga.</p><p>My Configuration</p><p>&nbsp; &nbsp; 192.168.3.1&nbsp; &nbsp;&nbsp; -&nbsp; 192.168.3.2<br />+--------+&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+--------+<br />| router1 |---------------&nbsp; &nbsp; | router2 |<br />+--------+&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; +--------+<br />192.168.1.1&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 192.168.2.1<br />&nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<br />&nbsp; &nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<br />+----+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; +----+<br />| PC&nbsp; |&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | PC&nbsp; &nbsp;|<br />|&nbsp; &nbsp;1&nbsp; &nbsp;|&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |&nbsp; &nbsp;2&nbsp; &nbsp;|<br />+----+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+----+<br />192.168.1.2&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; 192.168.2.2</p><p>PC 1 become a entry <br />route add -net 192.168.2.0 netmask 255.255.255.0 gw 192.168.1.1<br />PC 2 become a entry, too.<br />route add -net 192.168.1.0 netmask 255.255.255.0 gw 192.168.2.1</p><p>The router configuration are now use static routes. But I would like use RIP...</p><p>I absolutely don&#039;t know what I write in my zebra.conf, ripd.conf etc. Can anybody help me please?</p><p>Router&#039;s = Asus WL-500GP â†’ OpenWRT kamikaze revision 13055</p><p>sry for English and the beatiful chart <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></p><p>thank you<br />Kind regards from GER/BERLIN</p><p>Fiete</p>											<p class="post-edited">(Last edited by <strong>Fiete</strong> on 13 Nov 2008, 12:54)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p76367">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">sentenza</div>
					<div class="post-datetime">
						13 Nov 2008, 13:18					</div>
				</div>
				<div class="post-content content">
					<p>Perhaps just have a look at the Fine Manual at <a href="http://www.quagga.net/docs/docs-info.php#SEC37">http://www.quagga.net/docs/docs-info.php#SEC37</a>...</p><p>If you know what rip is about, this should be straightforward.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p76377">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Fiete</div>
					<div class="post-datetime">
						13 Nov 2008, 15:08					</div>
				</div>
				<div class="post-content content">
					<p>Ok thanks sentenza</p><p>I had configure my router 1 and PC 1</p><p>PC IP - 192.168.1.2<br />Router 1 IP - 192.168.1.3<br />-Vlan 1 &#039;0 5&#039;</p><p>My PC is directly connected on the WAN port of my router.</p><p>ripd.conf --&gt;</p><p>router rip<br />network 192.168.3.0/24<br />network eth0<br />network eth0.1</p><p>zebra.conf --&gt;</p><p>hostname router1<br />password zebra<br />enable password zebra<br />log stdout</p><div class="codebox"><pre><code>root@Router_1:/# ifconfig
eth0      Link encap:Ethernet  HWaddr 00:22:15:2F:80:62  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:1385 errors:0 dropped:0 overruns:0 frame:0
          TX packets:854 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:101153 (98.7 KiB)  TX bytes:70751 (69.0 KiB)
          Interrupt:4 

eth0.1    Link encap:Ethernet  HWaddr 00:22:15:2F:80:62  
          inet addr:192.168.1.3  Bcast:192.168.1.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:1381 errors:0 dropped:0 overruns:0 frame:0
          TX packets:858 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:72483 (70.7 KiB)  TX bytes:67060 (65.4 KiB)

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:1384 errors:0 dropped:0 overruns:0 frame:0
          TX packets:1384 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:63154 (61.6 KiB)  TX bytes:63154 (61.6 KiB)</code></pre></div><div class="codebox"><pre><code>root@Router_1:/# telnet localhost 2061
...
router1&gt;enable
...
router1# configure terminal
router1(config)# interface eth0.1
router1(config-if)# show running-config 

Current configuration:
!
hostname router1
password zebra
enable password zebra
log stdout
!
interface eth0
!
interface eth0.1
 ip address 192.168.1.3/24
!
interface eth1
!
interface lo
!
interface wl0
!
ip forwarding
ipv6 forwarding
!
line vty  
!
end</code></pre></div><p>When I take a sniffer on the Interface of my PC, I don&#039;t can see a RIP protocol.</p><p>What is wrong? I&#039;m Stupid? I&#039;m forgot something? please tell me...</p><p>Kind regards</p><p>Fiete</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p76400">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">sentenza</div>
					<div class="post-datetime">
						13 Nov 2008, 23:17					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Fiete wrote:</cite><blockquote><p>Ok thanks sentenza</p><p>I had configure my router 1 and PC 1</p><p>PC IP - 192.168.1.2<br />Router 1 IP - 192.168.1.3<br />-Vlan 1 &#039;0 5&#039;</p><p>My PC is directly connected on the WAN port of my router.</p><p>ripd.conf --&gt;</p><p>router rip<br />network 192.168.3.0/24<br />network eth0<br />network eth0.1</p><p>zebra.conf --&gt;</p><p>hostname router1<br />password zebra<br />enable password zebra<br />log stdout</p><div class="codebox"><pre><code>root@Router_1:/# ifconfig
eth0      Link encap:Ethernet  HWaddr 00:22:15:2F:80:62  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:1385 errors:0 dropped:0 overruns:0 frame:0
          TX packets:854 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:101153 (98.7 KiB)  TX bytes:70751 (69.0 KiB)
          Interrupt:4 

eth0.1    Link encap:Ethernet  HWaddr 00:22:15:2F:80:62  
          inet addr:192.168.1.3  Bcast:192.168.1.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:1381 errors:0 dropped:0 overruns:0 frame:0
          TX packets:858 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:72483 (70.7 KiB)  TX bytes:67060 (65.4 KiB)

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:1384 errors:0 dropped:0 overruns:0 frame:0
          TX packets:1384 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:63154 (61.6 KiB)  TX bytes:63154 (61.6 KiB)</code></pre></div><div class="codebox"><pre><code>root@Router_1:/# telnet localhost 2061
...
router1&gt;enable
...
router1# configure terminal
router1(config)# interface eth0.1
router1(config-if)# show running-config 

Current configuration:
!
hostname router1
password zebra
enable password zebra
log stdout
!
interface eth0
!
interface eth0.1
 ip address 192.168.1.3/24
!
interface eth1
!
interface lo
!
interface wl0
!
ip forwarding
ipv6 forwarding
!
line vty  
!
end</code></pre></div><p>When I take a sniffer on the Interface of my PC, I don&#039;t can see a RIP protocol.</p><p>What is wrong? I&#039;m Stupid? I&#039;m forgot something? please tell me...</p><p>Kind regards</p><p>Fiete</p></blockquote></div><p>These are the information of zebra, not ripd. Are you sure the ripd process is running? I think the console is on a different port, but can&#039;t remember.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p76983">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">Fiete</div>
					<div class="post-datetime">
						24 Nov 2008, 12:30					</div>
				</div>
				<div class="post-content content">
					<p>I think its enabled, because i had type this command</p><p>ripd -d</p><p>thats mean ripd start in deamon mode</p><p>When i telnet my router I can&#039;t use the router rip command.<br />And when i telnet localhost:2601 on my router I can&#039;t use the router rip command too.</p>											<p class="post-edited">(Last edited by <strong>Fiete</strong> on 24 Nov 2008, 12:41)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p76991">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Fiete</div>
					<div class="post-datetime">
						24 Nov 2008, 15:06					</div>
				</div>
				<div class="post-content content">
					<p>OK however I do... It works <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>When i sniff from PC 1 or PC 2 all 30sec. come a Ripv2 Packet. And between the Routers too.</p><p>The test is a little bit different between the first.</p><p>PC 1 --&gt; 192.168.1.2/24<br />ROUTER 1 --&gt; 192.168.1.1/24 AND 192.168.3.1/30</p><p>PC 2 --&gt; 192.168.4.2/24<br />ROUTER 2 --&gt; 192.168.4.1/24 AND 192.168.3.2/30 </p><p>And here comes the but....</p><p>The routing table on Router 2 look like the following</p><div class="codebox"><pre><code>root@Router_2:/# route
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
192.168.3.0     *               255.255.255.252 U     0      0        0 eth0.2
192.168.4.0     *               255.255.255.0   U     0      0        0 eth0.1
192.168.1.0     *               255.255.255.0   U     0      0        0 br-lan</code></pre></div><p>The new Interface</p><div class="codebox"><pre><code>br-lan    Link encap:Ethernet  HWaddr 00:22:15:26:B2:65  
          inet addr:192.168.1.1  Bcast:192.168.1.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:163 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:0 (0.0 B)  TX bytes:7206 (7.0 KiB)</code></pre></div><p>And Router 1</p><div class="codebox"><pre><code>root@Router_1:/# route
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
192.168.3.0     *               255.255.255.252 U     0      0        0 eth0.2
192.168.1.0     *               255.255.255.0   U     0      0        0 eth0.1</code></pre></div><p>The configuration is the same.... I don&#039;t know why it only work at one Router. <br />The ping between PC 1 and PC 2 doesn&#039;t work.</p><br /><p>ripd.conf ROUTER 1 </p><div class="codebox"><pre><code>router rip
network 192.168.3.0/30
network 192.168.1.0/24</code></pre></div><p>ripd.conf ROUTER 2</p><div class="codebox"><pre><code>router rip
network 192.168.3.0/30
network 192.168.4.0/24</code></pre></div><p>Fiete</p>											<p class="post-edited">(Last edited by <strong>Fiete</strong> on 24 Nov 2008, 15:09)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p76993">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">Fiete</div>
					<div class="post-datetime">
						24 Nov 2008, 15:59					</div>
				</div>
				<div class="post-content content">
					<p>Oh sorry i had build a error... the &quot;new Interface&quot; br-lan was configure from me... when it is down... the routing table from router 2 look like the table from router 1 the only different switch the ip adresses 192.168.1.0 and 192.168.4.0</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p77062">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">Fiete</div>
					<div class="post-datetime">
						25 Nov 2008, 15:35					</div>
				</div>
				<div class="post-content content">
					<p>Ok i think my configuration is correct, but it don&#039;t work... <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>I had make some sreenshots..</p><p>BETWEEN THE ROUTER&#039;S:</p><p><span class="postimg"><img src="http://img152.imageshack.us/img152/5926/10ne6.png" alt="http://img152.imageshack.us/img152/5926/10ne6.png" /></span></p><p>AND</p><p><span class="postimg"><img src="http://img149.imageshack.us/img149/6273/40sy4.png" alt="http://img149.imageshack.us/img149/6273/40sy4.png" /></span></p><p>AND AT PC 2</p><p><span class="postimg"><img src="http://img227.imageshack.us/my.php?image=41mt6.png" alt="http://img227.imageshack.us/my.php?image=41mt6.png" /></span></p><p>AND AT PC 1<br /><a href="http://imageshack.us"><span class="postimg"><img src="http://img504.imageshack.us/img504/9684/lalawj6.png" alt="http://img504.imageshack.us/img504/9684/lalawj6.png" /></span></a><br /><a href="http://g.imageshack.us/img504/lalawj6.png/1/"><span class="postimg"><img src="http://img504.imageshack.us/img504/lalawj6.png/1/w1280.png" alt="http://img504.imageshack.us/img504/lalawj6.png/1/w1280.png" /></span></a></p><p>You can see the RIPv2 Packets... everything is right, but a ping between pc 1/2 doesn&#039;t work.</p><div class="codebox"><pre><code>Router_2# show ip rip status 
Routing Protocol is &quot;rip&quot;
  Sending updates every 30 seconds with +/-50%, next due in 16 seconds
  Timeout after 180 seconds, garbage collect after 120 seconds
  Outgoing update filter list for all interface is not set
  Incoming update filter list for all interface is not set
  Default redistribution metric is 1
  Redistributing:
  Default version control: send version 2, receive version 2 
    Interface        Send  Recv   Key-chain
    eth0.1           2     2      
    eth0.2           2     2      
  Routing for Networks:
    192.168.3.0/29
    192.168.4.0/24
  Routing Information Sources:
    Gateway          BadPackets BadRoutes  Distance Last Update
    192.168.3.1             51         0       120   00:00:25
  Distance: (default is 120)</code></pre></div><div class="codebox"><pre><code>Router_1# show ip rip status
Routing Protocol is &quot;rip&quot;
  Sending updates every 30 seconds with +/-50%, next due in 9 seconds
  Timeout after 180 seconds, garbage collect after 120 seconds
  Outgoing update filter list for all interface is not set
  Incoming update filter list for all interface is not set
  Default redistribution metric is 1
  Redistributing:
  Default version control: send version 2, receive version 2 
    Interface        Send  Recv   Key-chain
    eth0.1           2     2      
    eth0.2           2     2      
  Routing for Networks:
    192.168.1.0/24
    192.168.3.0/29
  Routing Information Sources:
    Gateway          BadPackets BadRoutes  Distance Last Update
    192.168.3.2             56         0       120   00:00:06
  Distance: (default is 120)</code></pre></div><p><img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /> <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /> <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /> <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>I don&#039;t understand why the router&#039;s don&#039;t add a route...?! can no one help me? please?!!! HELP ME! <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>Fiete</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p116050">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">LeonTan</div>
					<div class="post-datetime">
						28 Aug 2010, 21:01					</div>
				</div>
				<div class="post-content content">
					<p>I think I found the problem.</p><p>Are you using quagga 0.98.6-1 by chance? </p><p>Take a look at your own screenshots of RIP status. See the bad packets there?</p><p>It seems like it is unable to accept routing updates. This happened to me as well. </p><p>Do you have logread package? Install it, and use it. It displays the system log onto the monitor. </p><p>keep on refereshing it until you find the problem. Mine showed &quot;RIPv2 dropped because of authentication enabled&quot;. </p><p>Telnet to the RIP daemon and disable RIP authentication mode md5 on the interfaces connected from router 1 and router 2. Do the same for router 2 as well.</p><p>Try then. It should be able to add routes. </p><p>But it seems to me when I keep on restarting the ripd, it just keep on dropping routes.</p><p>NOTE: I am not too sure about this. So I did a telnet shell script for it. </p><div class="quotebox"><cite>Code wrote:</cite><blockquote><p>#!/bin/sh<br /># File name: ripd-telnet.sh</p><p>(<br /> # sleep 1<br /> echo user123;<br /> echo &quot;conf t&quot;;<br /> echo &quot;interface eth0.3&quot;;<br /> echo &quot;no ip rip authentication mode md5&quot;;<br /> echo end;<br /> echo exit;<br />) | telnet localhost 2602</p></blockquote></div><p>Then, changed the mode to executable. chmod +x ripd-telnet.sh</p><p>Add this line into the start function of /etc/init.d/quagga</p><p>./ripd-telnet.sh</p><br /><p>PS: This might not be able to help much since the last post was from 2008.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>