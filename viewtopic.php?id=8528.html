<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Add external UART (RS232) port to free GPIOs</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 31 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p38537">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Dr. Morg</div>
					<div class="post-datetime">
						8 Dec 2006, 02:24					</div>
				</div>
				<div class="post-content content">
					<p>Hello!</p><p>Anybody can tell me if it&#039;s possible to solder some external UART chip to GPIOs for adding support additional RS232 port to device?</p><p>Thanks!</p><p>-Alex</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p38596">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Timo Beil</div>
					<div class="post-datetime">
						9 Dec 2006, 01:25					</div>
				</div>
				<div class="post-content content">
					<p>If you&#039;ve got one of the router types that are supported by the MMC-card hack, it should be possible to use the SSI-code from brainslayer&#039;s MMC-kernel module. You&#039;d have to find an UART with SSI (a microcontroller with SSI and UART would be OK), and you&#039;d have to write quite some code for a rather unique hardware modification...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p38598">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Dr. Morg</div>
					<div class="post-datetime">
						9 Dec 2006, 01:32					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Timo Beil wrote:</cite><blockquote><p>If you&#039;ve got one of the router types that are supported by the MMC-card hack, it should be possible to use the SSI-code from brainslayer&#039;s MMC-kernel module. You&#039;d have to find an UART with SSI (a microcontroller with SSI and UART would be OK), and you&#039;d have to write quite some code for a rather unique hardware modification...</p></blockquote></div><p>Hmm... I thought that MMC driver uses SPI mode for acces.<br />Yes, my device has 11 free GPIOs and I&#039;m already finished SD/MMC driver port for it.<br />Now, I&#039;d like to add additional UART port and use for it minimum GPIOs.</p><p>It will be great if you&#039;d tell me some types and manufacturers of UART microcontrollers.</p><p>Thanks!</p><p>-Alex</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p38599">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Timo Beil</div>
					<div class="post-datetime">
						9 Dec 2006, 01:49					</div>
				</div>
				<div class="post-content content">
					<p>I suggest you give atmel&#039;s mega8 a try<br /><a href="http://www.atmel.com/dyn/resources/prod_documents/doc2486.pdf">http://www.atmel.com/dyn/resources/prod … oc2486.pdf</a></p><p>It&#039;s reasonably cheap and well supported by open source tools.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p38600">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">Dr. Morg</div>
					<div class="post-datetime">
						9 Dec 2006, 02:01					</div>
				</div>
				<div class="post-content content">
					<p>Have you any links to resources about using Atmel mega8 in open source systems?</p><p>What can you say about Exar ST16C1551 (<a href="http://datasheets.name/datasheets/92860/ST16C1551.html">http://datasheets.name/datasheets/92860/ST16C1551.html</a>)?</p><p>Beforehand I thank you!</p><p>-Alex</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p38601">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Timo Beil</div>
					<div class="post-datetime">
						9 Dec 2006, 02:13					</div>
				</div>
				<div class="post-content content">
					<p>You&#039;ll find tools for AVR controllers here: <a href="http://winavr.sourceforge.net/links.html">http://winavr.sourceforge.net/links.html</a></p><p>The uart device you selected looks good - especially because it behaves like a 16550. If you can get it, it would save you the effort of programming a micro controller.</p><p>/T</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p38602">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">Dr. Morg</div>
					<div class="post-datetime">
						9 Dec 2006, 02:22					</div>
				</div>
				<div class="post-content content">
					<p>I have never used and programm microcontrollers, so I&#039;d like to make maximum simple UART mod and use for it minimum GPIOs.</p><p>It looks like Exar ST16C1551 needs to use too much GPIOs for work... <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>Maybe it&#039;s possible to make more simple UART through GPIOs?</p><p>Thanks!</p><p>-Alex</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p38603">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">Timo Beil</div>
					<div class="post-datetime">
						9 Dec 2006, 02:31					</div>
				</div>
				<div class="post-content content">
					<p>The problem is that you need a fixed time base for sending or receiving UART data (there is no clock signal, so the CPU has to poll a port pin or toggle a port pin in fixed time intervals). With so called &quot;bit banging&quot; UART code for microcontrollers /without/ UART on chip, the CPU often can&#039;t do anything else while performing UART transfers. You might find a solution for the time base problem by using a timer interrupt. However, attaching a micro controller with SPI and UART would be a more obvious solution.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p38606">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">Dr. Morg</div>
					<div class="post-datetime">
						9 Dec 2006, 02:40					</div>
				</div>
				<div class="post-content content">
					<p>So, if I&#039;ll use microcontroller with SSI (SPI) and UART can I connect it with minimal number of GPIOs?<br />And how much GPIOs it&#039;s minimum needed?</p><p>Also I&#039;d like to ask you if it&#039;s possible to add USB host support using some of USB host controllers on GPIOs?</p><p>Thanks!</p><p>-Alex</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p38613">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">Timo Beil</div>
					<div class="post-datetime">
						9 Dec 2006, 13:11					</div>
				</div>
				<div class="post-content content">
					<p>?????? Alex,</p><p>you&#039;d need 4 GPIO pins (SI, SO, SCK and /CS). The first 3 pins are can be used as a bus. The /CS signal&nbsp; also can be created by using a de-multiplexer (e.g. 3 pins can be used to select 1 out of 7 devices).<br /><a href="http://www.atmel.com/dyn/resources/prod_documents/doc2455.pdf">http://www.atmel.com/dyn/resources/prod … oc2455.pdf</a> shows an example.</p><p>A question from my side: which router hardware are you using? How did you identify the available GPIO pins? <br />Due to some incomprehensible policy of broadcom, I don&#039;t have neither the schematics of the broadcom reference design nor the data sheet of a member of the BCM47xx family...</p><p>?? ????????<br />/T</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p38622">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">Dr. Morg</div>
					<div class="post-datetime">
						9 Dec 2006, 14:48					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Timo Beil wrote:</cite><blockquote><p>?????? Alex,</p><p>you&#039;d need 4 GPIO pins (SI, SO, SCK and /CS). The first 3 pins are can be used as a bus. The /CS signal&nbsp; also can be created by using a de-multiplexer (e.g. 3 pins can be used to select 1 out of 7 devices).<br /><a href="http://www.atmel.com/dyn/resources/prod_documents/doc2455.pdf">http://www.atmel.com/dyn/resources/prod … oc2455.pdf</a> shows an example.</p></blockquote></div><p>Good example, thanks!<br />It looks like I can use the same 3 GPIOs, which are shares with SD/MMC, for additional 6 devices. Isn&#039;t it?</p><div class="quotebox"><blockquote><p>A question from my side: which router hardware are you using? How did you identify the available GPIO pins? <br />Due to some incomprehensible policy of broadcom, I don&#039;t have neither the schematics of the broadcom reference design nor the data sheet of a member of the BCM47xx family...</p><p>?? ????????<br />/T</p></blockquote></div><p>I&#039;ve use D-Link DWL-G700AP based on Realtek RTL8186 MIPS R3000 SoC.</p><p>As I&#039;m already said,- I&#039;ve port SD/MMC driver for rtl8186 and you can see how I have work with GPIOs: <a href="http://rtl8186.sourceforge.net/SD_driver/mmc.tar.gz">http://rtl8186.sourceforge.net/SD_driver/mmc.tar.gz</a></p><p>PS: Do you speak Russian? <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p38624">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">Timo Beil</div>
					<div class="post-datetime">
						9 Dec 2006, 16:53					</div>
				</div>
				<div class="post-content content">
					<p>Right, you can use the SI/SO/SK you already use for the MMC to connect more devices, as long as you always finish a transfer to one device, before you select the next device. Using a general SPI layer that manages access to several devices looks like a good option. The possibility to connect devices like microcontrollers, a CAN-interface, or even a USB-controller sounds interesting.</p><p>The choice of a demultiplexer isn&#039;t difficult (like <a href="http://pdf1.alldatasheet.com/datasheet-pdf/view/15535/PHILIPS/74HC138.html">http://pdf1.alldatasheet.com/datasheet- … HC138.html</a> ). Because speed isn&#039;t important, even a good old standard CMOS multiplexer will do&nbsp; ( <a href="http://www.alldatasheet.com/datasheet-pdf/pdf/17724/PHILIPS/4051B.html">http://www.alldatasheet.com/datasheet-p … 4051B.html</a> , you&#039;d need additional pull-up resistors).</p><p>-----<br />No, unfortunately I don&#039;t speak Russian (I can read the script and know a few basic words)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p38632">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">Dr. Morg</div>
					<div class="post-datetime">
						9 Dec 2006, 20:56					</div>
				</div>
				<div class="post-content content">
					<p>Heh... may be it isn&#039;t difficult for you, but as I&#039;m already said,- I have never programm microcontrollers and haven&#039;t used multiplexers/demultiplexers with SPI...</p><p>If you can provide some schematic,- it will really great for me!</p><p>Thanks!</p><p>-Alex</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p38640">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">Timo Beil</div>
					<div class="post-datetime">
						10 Dec 2006, 01:02					</div>
				</div>
				<div class="post-content content">
					<p>Well... programming micro-controllers goes from trivial to complex. If you&#039;ve never worked with µCs before, you&#039;ll need some time to get used to it (rich peripherals but generally limited resources, and no operating system). There is a lot of information on the page I pointed to above - but I think that it is is off-topic here.&nbsp; I suggest you start with the datasheet of the ATmega8, and look for application notes on the Atmel web site. You can contact me through PM if you need more information to get started.</p><p>/T</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p38643">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">Dr. Morg</div>
					<div class="post-datetime">
						10 Dec 2006, 04:15					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;d like to invite you cononue thread on our project forum: <a href="http://rtl8186.sourceforge.net/phpBB2/viewtopic.php?t=11">http://rtl8186.sourceforge.net/phpBB2/v … c.php?t=11</a><br />If anyone else interesting in this thread,- wellcome too!</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>