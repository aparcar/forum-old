<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> AR7240 procesor USB pins</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 2 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p109545">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">nosense</div>
					<div class="post-datetime">
						21 May 2010, 00:06					</div>
				</div>
				<div class="post-content content">
					<p>Hello everybody,</p><p>I would like to try add USB to my TL-WR741ND router. Since on the router board there aren&#039;t even electric paths that could be identified as USB, I would like to ask someone with another AR7240 based router (like latest versions of TL-WR841ND and TL-WR941ND) to identify USB pins on procesor. TL-WR741ND is pretty neat device and cost only about 20€/25$. However with USB it would rock the world. The manufacturer specs says the procesor has definitely USB 1.1 support, my task is to find it and make it work.</p><p>Any help would be appreciated.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p109787">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">xssa</div>
					<div class="post-datetime">
						24 May 2010, 22:47					</div>
				</div>
				<div class="post-content content">
					<p>CPU pins 73,74</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p109825">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">nosense</div>
					<div class="post-datetime">
						25 May 2010, 10:46					</div>
				</div>
				<div class="post-content content">
					<p>Thank you very much.</p><p>If I count well USB are the 2 pins marked on the picture, but I still don&#039;t know which is D+ and D-. It will be quite a challenge for my soldering skills, since its necessary to solder wires directly to cpu pins, which are really tiny.</p><p>A little schematics (resistors, capacitors,...) of path from cpu to USB port would be handy. However I think it would be possible to proceed without it.</p><p><span class="postimg"><img src="http://spejlickari.wz.cz/fileget.php?file=AR7240.JPG" alt="http://spejlickari.wz.cz/fileget.php?file=AR7240.JPG" /></span></p>											<p class="post-edited">(Last edited by <strong>nosense</strong> on 25 May 2010, 15:08)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p117440">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">???????</div>
					<div class="post-datetime">
						18 Sep 2010, 12:58					</div>
				</div>
				<div class="post-content content">
					<p>Hello.<br />I would like to know the model TL-R841ND, can be soldered USB. But not to the CPU, another on the board. And what do you want 4 pins on the board, not inadvertently to USB?</p><p>in Russian.<br />????????????.<br />? ????? ?? ?????? ? ?????? TL-?841??, ????? ???????? ???. ?? ?? ? ??, ? ??????? ?? ?????. ????? ????? 4 ??????? ?? ?????,&nbsp; ?? ??? ????</p>											<p class="post-edited">(Last edited by <strong>???????</strong> on 18 Sep 2010, 13:05)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p118131">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">xssa</div>
					<div class="post-datetime">
						30 Sep 2010, 01:12					</div>
				</div>
				<div class="post-content content">
					<p>There are many hw revisions of the TL-R841ND. Can you post your&#039;s photo and show what do you mean ?<br /></p><div class="quotebox"><blockquote><p>4 ??????? ?? ??????</p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p118438">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Bebebe</div>
					<div class="post-datetime">
						4 Oct 2010, 16:33					</div>
				</div>
				<div class="post-content content">
					<p>??????? USB ???????? ??????????? <a href="http://wiki.openwrt.org/toh/tp-link/tl-wr741nd">http://wiki.openwrt.org/toh/tp-link/tl-wr741nd</a> . ???????? ?????????? ????, ? ??? ????? ???????? ???????? ?????????? ??? ????? ??????? ? ?????????? USB. ? ???????????? USB ??????? ??? ????? ???:??. ????.</p><p>Router TPLINK TL-WR741ND. USB soldered according to the guidelines <a href="http://wiki.openwrt.org/toh/tp-link/tl-wr741nd">http://wiki.openwrt.org/toh/tp-link/tl-wr741nd</a>. Help patch the kernel, or better yet put the firmware specifically for this router that supports USB.<br />From a connected USB flash drive that&#039;s such a kernel log<br /> </p><div class="codebox"><pre><code>Linux version 2.6.32.16 (openwrt@ampere) (gcc version 4.3.3 (GCC) ) #1 Wed Aug 25 15:20:15 PDT 2010
prom: fw_arg0=00000007, fw_arg1=a1f87fb0, fw_arg2=a1f88460, fw_arg3=00000004
MyLoader: sysp=00000000, boardp=00008000, parts=ffffffff
bootconsole [early0] enabled
CPU revision is: 00019374 (MIPS 24Kc)
Atheros AR7240 rev 2, CPU:350.000 MHz, AHB:175.000 MHz, DDR:350.000 MHz
Determined physical RAM map:
 memory: 02000000 @ 00000000 (usable)
Initrd not found or empty - disabling initrd
Zone PFN ranges:
  Normal   0x00000000 -&gt; 0x00002000
Movable zone start PFN for each node
early_node_map[1] active PFN ranges
    0: 0x00000000 -&gt; 0x00002000
On node 0 totalpages: 8192
free_area_init_node: node 0, pgdat 802d25a0, node_mem_map 81000000
  Normal zone: 64 pages used for memmap
  Normal zone: 0 pages reserved
  Normal zone: 8128 pages, LIFO batch:0
Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 8128
Kernel command line: rootfstype=squashfs,yaffs,jffs2 noinitrd console=ttyS0,115200 board=TL-WR741ND
PID hash table entries: 128 (order: -3, 512 bytes)
Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
Primary instruction cache 64kB, VIPT, 4-way, linesize 32 bytes.
Primary data cache 32kB, 4-way, VIPT, cache aliases, linesize 32 bytes
Writing ErrCtl register=00000000
Readback ErrCtl register=00000000
Memory: 29304k/32768k available (2109k kernel code, 3464k reserved, 398k data, 152k init, 0k highmem)
SLUB: Genslabs=7, HWalign=32, Order=0-3, MinObjects=0, CPUs=1, Nodes=1
Hierarchical RCU implementation.
NR_IRQS:56
Calibrating delay loop... 232.65 BogoMIPS (lpj=1163264)
Mount-cache hash table entries: 512
NET: Registered protocol family 16
MIPS: machine is TP-LINK TL-WR741ND
registering PCI controller with io_map_base unset
bio: create slab &lt;bio-0&gt; at 0
PCI: fixup device 0000:00:00.0
pci 0000:00:00.0: reg 10 64bit mmio: [0x000000-0x00ffff]
pci 0000:00:00.0: supports D1
pci 0000:00:00.0: PME# supported from D0 D1 D3hot
pci 0000:00:00.0: PME# disabled
PCI: mapping irq 48 to pin1@0000:00:00.0
Switching to clocksource MIPS
NET: Registered protocol family 2
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 1024 (order: 1, 8192 bytes)
TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
TCP: Hash tables configured (established 1024 bind 1024)
TCP reno registered
NET: Registered protocol family 1
squashfs: version 4.0 (2009/01/31) Phillip Lougher
Registering mini_fo version $Id$
JFFS2 version 2.2. (NAND) (SUMMARY)  © 2001-2006 Red Hat, Inc.
yaffs Aug 25 2010 15:11:02 Installing. 
msgmni has been set to 57
io scheduler noop registered
io scheduler deadline registered (default)
Serial: 8250/16550 driver, 1 ports, IRQ sharing disabled
serial8250.0: ttyS0 at MMIO 0x18020000 (irq = 11) is a 16550A
console [ttyS0] enabled, bootconsole disabled
Atheros AR71xx SPI Controller driver version 0.2.4
m25p80 spi0.0: s25sl032a (4096 Kbytes)
spi0.0: searching for MyLoader partition table at offset 0x10000
spi0.0: searching for MyLoader partition table at offset 0x20000
spi0.0: searching for MyLoader partition table at offset 0x30000
spi0.0: searching for MyLoader partition table at offset 0x40000
spi0.0: no MyLoader partition table found
Searching for RedBoot partition table in spi0.0 at offset 0x3e0000
Searching for RedBoot partition table in spi0.0 at offset 0x3f0000
No RedBoot partition table detected in spi0.0
spi0.0: no WRT160NL signature found
Creating 5 MTD partitions on &quot;spi0.0&quot;:
0x000000000000-0x000000020000 : &quot;u-boot&quot;
0x000000020000-0x000000160000 : &quot;kernel&quot;
0x000000160000-0x0000003f0000 : &quot;rootfs&quot;
mtd: partition &quot;rootfs&quot; set to be root filesystem
mtd: partition &quot;rootfs_data&quot; created automatically, ofs=370000, len=80000 
0x000000370000-0x0000003f0000 : &quot;rootfs_data&quot;
0x0000003f0000-0x000000400000 : &quot;art&quot;
0x000000020000-0x0000003f0000 : &quot;firmware&quot;
ag71xx_mdio: probed
eth0: Atheros AG71xx at 0xba000000, irq 5
eth0: Found an AR7240 built-in switch
eth1: Atheros AG71xx at 0xb9000000, irq 4
eth1: using fixed link parameters
Atheros AR71xx hardware watchdog driver version 0.1.0
ar71xx-wdt: timeout=15 secs (max=24)
TCP westwood registered
NET: Registered protocol family 17
802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;
All bugs added by David S. Miller &lt;davem@redhat.com&gt;
VFS: Mounted root (squashfs filesystem) readonly on device 31:2.
Freeing unused kernel memory: 152k freed
Please be patient, while OpenWrt loads ...
gpio-buttons driver version 0.1.2
input: gpio-buttons as /devices/platform/gpio-buttons/input/input0
Button Hotplug driver version 0.3.1
eth0: link up (1000Mbps/Full duplex)
Registered led device: tl-wr741nd:green:system
Registered led device: tl-wr741nd:green:qss
mini_fo: using base directory: /
mini_fo: using storage directory: /overlay
eth0: link down
eth1: link up (100Mbps/Full duplex)
Compat-wireless backport release: compat-wireless-2010-07-13-4-g04898a5
Backport based on wireless-2.6.git v2.6.35-rc6-48432-gdce358e
cfg80211: Calling CRDA to update world regulatory domain
SCSI subsystem initialized
cfg80211: World regulatory domain updated:
    (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp)
    (2402000 KHz - 2472000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
    (2457000 KHz - 2482000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
    (2474000 KHz - 2494000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
    (5170000 KHz - 5250000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
    (5735000 KHz - 5835000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
usbcore: registered new interface driver usbfs
usbcore: registered new interface driver hub
usbcore: registered new device driver usb
PCI: Setting latency timer of device 0000:00:00.0 to 64
ath: EEPROM regdomain: 0x0
ath: EEPROM indicates default country code should be used
ath: doing EEPROM country-&gt;regdmn map search
ath: country maps to regdmn code: 0x3a
ath: Country alpha2 being used: US
ath: Regpair used: 0x3a
phy0: Selected rate control algorithm &#039;minstrel_ht&#039;
Registered led device: ath9k-phy0::radio
Registered led device: ath9k-phy0::assoc
Registered led device: ath9k-phy0::tx
Registered led device: ath9k-phy0::rx
phy0: Atheros AR9285 Rev:2 mem=0xb0000000, irq=48
cfg80211: Calling CRDA for country: US
cfg80211: Regulatory domain changed to country: US
    (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp)
    (2402000 KHz - 2472000 KHz @ 40000 KHz), (300 mBi, 2700 mBm)
    (5170000 KHz - 5250000 KHz @ 40000 KHz), (300 mBi, 1700 mBm)
    (5250000 KHz - 5330000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
    (5490000 KHz - 5600000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
    (5650000 KHz - 5710000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
    (5735000 KHz - 5835000 KHz @ 40000 KHz), (300 mBi, 3000 mBm)
ip_tables: (C) 2000-2006 Netfilter Core Team
ehci_hcd: USB 2.0 &#039;Enhanced&#039; Host Controller (EHCI) Driver
nf_conntrack version 0.5.0 (460 buckets, 1840 max)
CONFIG_NF_CT_ACCT is deprecated and will be removed soon. Please use
nf_conntrack.acct=1 kernel parameter, acct=1 nf_conntrack module option or
sysctl net.netfilter.nf_conntrack_acct=1 to enable it.
ath_hal: module license &#039;Proprietary&#039; taints kernel.
Disabling lock debugging due to kernel taint
ath_hal: 2009-05-08 (AR5210, AR5211, AR5212, AR5416, RF5111, RF5112, RF2413, RF5413, RF2133, RF2425, REGOPS_FUNC, XR)
ath_pci: trunk
wlan: trunk
wlan: mac acl policy registered
ath_rate_minstrel: Minstrel automatic rate control algorithm 1.2 (trunk)
ath_rate_minstrel: look around rate set to 10%
ath_rate_minstrel: EWMA rolloff level set to 75%
ath_rate_minstrel: max segment size in the mrr set to 6000 us
ohci_hcd: USB 1.1 &#039;Open&#039; Host Controller (OHCI) Driver
Initializing USB Mass Storage driver...
usbcore: registered new interface driver usb-storage
USB Mass Storage support registered.
eth0: link up (1000Mbps/Full duplex)
device wlan0 entered promiscuous mode</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p118951">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">PaulFertser</div>
					<div class="post-datetime">
						12 Oct 2010, 21:41					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Bebebe wrote:</cite><blockquote><p>Help patch the kernel, or better yet put the firmware specifically for this router that supports USB.</p></blockquote></div><p>Do you have any real problems compiling the firmware? The procedure is fairly straightforward. Feel free to ping me on irc (freenode) or jabber xmpp://paulfertser@jabber.org (we can have a conversation in russian for your convenience :) )</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p119093">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">Bebebe</div>
					<div class="post-datetime">
						15 Oct 2010, 09:51					</div>
				</div>
				<div class="post-content content">
					<p>Thank you for your response. I&#039;ve already mastered the process of compiling their own firmware. It would be nice to put firmware with USB support website.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p119094">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">PaulFertser</div>
					<div class="post-datetime">
						15 Oct 2010, 10:27					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Bebebe wrote:</cite><blockquote><p>It would be nice to put firmware with USB support website.</p></blockquote></div><p>Well, soldering to those small pins is certainly not the easiest process and requires some effort. I assume that it shouldn&#039;t be hard for someone willing to solder tiny parts to also compile a custom firmware version for his needs. But i agree having a selectable option in menuconfig would be nicer than having to apply a patch.</p><p>BTW, how do you provide the power to your usb devices? Did you put this hack to any use? TBH, my sole motivation to do that was a desire to unleash the functionality that was almost ruined by those greedy morons (they could have easily routed those two lines and placed those two resistors to allow for an easy upgrade).</p><p>Happy hacking! :)</p>											<p class="post-edited">(Last edited by <strong>PaulFertser</strong> on 15 Oct 2010, 10:27)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p119902">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">pokot</div>
					<div class="post-datetime">
						28 Oct 2010, 11:06					</div>
				</div>
				<div class="post-content content">
					<p>Does anybody have a complete pinout for AR7240? I would like to use some GPIO&#039;s which are not connected to LED&#039;s or switches if it possible.<br />thank you!<br />pokot</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p120061">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">andybi</div>
					<div class="post-datetime">
						31 Oct 2010, 02:05					</div>
				</div>
				<div class="post-content content">
					<p>Hi there, I soldered to that tiny parts but I&#039;m not able to compile the custom firmware I need to make it work.</p><p>I agree to the request of a precompiled firmware supporting USB.</p><p>Please help.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p120558">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">claudyus</div>
					<div class="post-datetime">
						7 Nov 2010, 11:53					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>pokot wrote:</cite><blockquote><p>Does anybody have a complete pinout for AR7240? I would like to use some GPIO&#039;s which are not connected to LED&#039;s or switches if it possible.</p></blockquote></div><p>No one have such pinout? </p><p>Whic is the D+ D- and how to connect it to an external USB connector&nbsp; (resistot-capacitor needed)?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p121131">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">Bebebe</div>
					<div class="post-datetime">
						15 Nov 2010, 08:16					</div>
				</div>
				<div class="post-content content">
					<p>I can share firmware with support for USB. How do I add a USB&#039;ll post later with pictures.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p121176">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">claudyus</div>
					<div class="post-datetime">
						15 Nov 2010, 18:24					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Bebebe wrote:</cite><blockquote><p>I can share firmware with support for USB. How do I add a USB&#039;ll post later with pictures.</p></blockquote></div><p>But for a firmware with usb support you can pick any of the ar71xx snapshots... <br />The problem is only to know the pinout.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p135426">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">amishx64</div>
					<div class="post-datetime">
						17 May 2011, 07:00					</div>
				</div>
				<div class="post-content content">
					<p>Hello all.</p><p>I just got done doing this very mod on the DIR-601 router two days ago. Since the processor is very similar, the process will be the same for your routers.</p><p>I have very carefully documented my work and written instructions at <a href="http://wiki.openwrt.org/toh/d-link/dir-600#usb.mod">http://wiki.openwrt.org/toh/d-link/dir-600#usb.mod</a></p><p>That should answer all of the above questions (including pin-out questions), and if you have any more please feel free to ask.</p><p>Please notice that I have yet to upload photos (will do tomorrow probably) and I have a few more minor things to touch up in the article. Currently Ext4 formatted flash drives have been tested and are working.</p><p>Cheers.<br />- amishx64</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>