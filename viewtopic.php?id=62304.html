<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Accessing Huawei HiLink router from outside the LAN</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 29 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p308498">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">boolsheat</div>
					<div class="post-datetime">
						21 Jan 2016, 16:51					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>I have a E3272s modem connected to a TP Link WR710N and running Chaos Calmer.</p><p>Everything works great (even on the 4mb version of the TP-Link also with PPTP client and Watchcat plugins installed) the only thing that I have problems with is accessing the modem from WAN. I forwarded the port 8080 (doesn&#039;t really matter which) to 192.168.1.1:80, where you access the modem over LAN. </p><p>When trying to access, like this: &quot;<a href="http://domain.com:8080">http://domain.com:8080</a>&quot;</p><p>But I get redirected like this: &quot;<a href="http://192.168.1.1/html/index.html?url=domain.com:8080">http://192.168.1.1/html/index.html?url=domain.com:8080</a>&quot;</p><p>Other port forwards (e.g. VNC, HTTP, FTP,...) work nicely.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p308501">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">HerpDerp</div>
					<div class="post-datetime">
						21 Jan 2016, 17:01					</div>
				</div>
				<div class="post-content content">
					<p>I have no idea how that happens, but you could configure the router over SSH instead of with LuCi. Be sure the open a higher port (&gt; 1024) on the WAN and redirect it to the port 22 on the router for security reasons.</p>											<p class="post-edited">(Last edited by <strong>HerpDerp</strong> on 21 Jan 2016, 17:01)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p308504">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">boolsheat</div>
					<div class="post-datetime">
						21 Jan 2016, 17:13					</div>
				</div>
				<div class="post-content content">
					<p>Oh, I can access Luci and OpenWrt without problems. <br />I&#039;d like to access the Huawei modem, that&#039;s where I have the problem.</p><p>TP link (Luci and OpenWrt) are 192.168.2.1, while Huawei HiLink modem is set to 192.168.1.1. So they are on different subnet but that shouldn&#039;t be a problem, I can ping the modem from Luci.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p308510">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">kubco2</div>
					<div class="post-datetime">
						21 Jan 2016, 18:51					</div>
				</div>
				<div class="post-content content">
					<p>Webpage redirect you everytime on local address of usb modem to protect against access from non local side.(e.g. internet)</p><p>You need direct access to usb modem network.<br />So you must have correct routes from PC to usb modem and use IP of usb modem.</p><p>If you are in small network:<br />PC -&gt; router -&gt; usb modem<br />it shouldnt be a problem to access IP of modem 192.168.1.1</p><p>If you want remote access you need login to VPN first, and access from VPN network to usb modem network.</p>											<p class="post-edited">(Last edited by <strong>kubco2</strong> on 21 Jan 2016, 18:56)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p308583">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">boolsheat</div>
					<div class="post-datetime">
						22 Jan 2016, 09:56					</div>
				</div>
				<div class="post-content content">
					<p>Yea, you are right, from LAN it works without problems, but via VPN it doesn&#039;t work, IP&#039;s on the VPN are on a completely different IP range e.g. 10.11.82.xx and I can&#039;t change those.</p><p>Somehow I would need to pretend I&#039;m on LAN get those packets then redirected to me over the internet (VPN).<br />Is there a way to bind a WAN (VPN) IP to a LAN in OpenWrt?</p>											<p class="post-edited">(Last edited by <strong>boolsheat</strong> on 22 Jan 2016, 10:03)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p308669">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">kubco2</div>
					<div class="post-datetime">
						23 Jan 2016, 01:25					</div>
				</div>
				<div class="post-content content">
					<p>VPN server is on same router?<br />If yes:<br /> you need allow zone forward from VPN to wan.</p><p>If no:<br />Can you ping your modem IP(192.168.1.1) when you are in VPN?<br />What is traceroute of modem IP?<br />Probably your VPN server need defined route which directs your packets to your router.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p308998">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">boolsheat</div>
					<div class="post-datetime">
						25 Jan 2016, 18:49					</div>
				</div>
				<div class="post-content content">
					<p>VPN is on a another server, router only acts as a PPTP client.</p><br /><p>So I can&#039;t ping the modem diretctly, I&#039;m using port forwarding on the router to access the modem.</p><p>I can&#039;t really change things on the server, its a rented service. I can only add new users. So something needs to be set on the router which hosts the modem and acts as a PPTP client.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p309273">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">kubco2</div>
					<div class="post-datetime">
						27 Jan 2016, 22:18					</div>
				</div>
				<div class="post-content content">
					<p>As a workaround to preserve transparent of URL for webif, you can translate usb modem IP to router IP in your PC just before it send outgoing <br />packets with <br /></p><div class="codebox"><pre><code>iptables -t nat -A OUTPUT -p tcp -d 192.168.1.1 -j DNAT --to-destination ROUTER_IP</code></pre></div><p>or with windows equivalent command.</p><p>You need port forward on router too.</p><p>To preserve URL you need set port forward correctly too.<br />port forward port 80 on router, or if you port forward 8080 to 192.168.1.1:80, you can append firewall rule in your pc to translate port too<br /></p><div class="codebox"><pre><code>iptables -t nat -A OUTPUT -p tcp -d 192.168.1.1 -j DNAT --to-destination ROUTER_IP:8080</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p309473">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">boolsheat</div>
					<div class="post-datetime">
						29 Jan 2016, 14:06					</div>
				</div>
				<div class="post-content content">
					<p>Hmm, this might work, any idea how to do this in Windows?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p310857">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">boolsheat</div>
					<div class="post-datetime">
						9 Feb 2016, 19:34					</div>
				</div>
				<div class="post-content content">
					<p>I have a new modem now, a Huawei E3372h HiLink and its the same problem, this time it redirects to <a href="http://192.168.8.1/html/index.html?url=\outer">http://192.168.8.1/html/index.html?url=&quot;outer</a> ip&quot;</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p314719">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">tripleNAT</div>
					<div class="post-datetime">
						14 Mar 2016, 08:02					</div>
				</div>
				<div class="post-content content">
					<p>Hello!&nbsp; I don&#039;t use openWRT, but have exactly the same problem with e3272 hilink mode (ip 192.168.1.1, subnet 192.168.1.0/24) when trying to access modem from WAN.&nbsp; </p><p>Modem has its own NAT and plugged into another router Zyxel keenetic 4g III (ip 192.168.1.100, local subnet 192.168.2.0/24). Keenetic running pptp client.</p><p>The server running on another Mikrotik router (192.168.88.0/24) and I have full access to it.&nbsp; I&#039;ve implemented routes on Mikrotik, so can access 192.168.1.0/24 and 192.168.2.0/24 from Mikrotik subnet.&nbsp; Have an access to zyxel (192.168.1.100) and to all the devices behind Zyxel (192.168.2.0/24).&nbsp; <br />&nbsp; &nbsp;<br />The problem is that there is no access (no ping) to hilink modem 192.168.1.1, even there is a route to 192.168.1.0/24 subnet on it.&nbsp; Works only from Zyxel LAN.</p>											<p class="post-edited">(Last edited by <strong>tripleNAT</strong> on 14 Mar 2016, 10:34)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p314748">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">starshipeleven</div>
					<div class="post-datetime">
						14 Mar 2016, 15:17					</div>
				</div>
				<div class="post-content content">
					<p>I usually &quot;solve&quot; the issue by flashing those modems to &quot;stick mode&quot;, and at that point they are fully controlled from the router they are attached to over cdc/ncm protocol.<br />No webpages, no IP, no NAT, no forwarding, no bs. They are just plain USB modems.</p><p>It is also safer as in that mode the obvious vulnerabilities of hilink firmware aren&#039;t there.</p><p>This is the tutorial I followed for a e3272h <a href="http://blog.asiantuntijakaveri.fi/2015/07/convert-huawei-e3372h-153-from.html">http://blog.asiantuntijakaveri.fi/2015/ … -from.html</a></p><p>OpenWrt has the drivers to run these modems in stick mode, and you can even use the onboard microSD card to expand your router&#039;s firmware storage space (for extroot for example, like I did on mine) I don&#039;t know if other routers can work with these devices in stick mode (I doubt it).</p>											<p class="post-edited">(Last edited by <strong>starshipeleven</strong> on 14 Mar 2016, 15:23)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p344697">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">boolsheat</div>
					<div class="post-datetime">
						24 Nov 2016, 20:34					</div>
				</div>
				<div class="post-content content">
					<p>Here&#039;s a solution:<br />You ssh into your openwrt ruter (remote host) like this:</p><ul><li><p>ssh -D 8080 username@remote-host -p sshportnumber<br />e.g.: &quot;ssh -D 8080 admin@domain.com -p 1022&quot;<br />Where the &quot;-p 1022&quot; indicates the ssh server port, if its default 22 this part isn&#039;t needed. Port 8080 is also just for example, you can use something else.</p></li></ul><ul><li><p>Go to you browser proxy settings and set SOCKS host to &quot;localhost&quot; and set the port to the number you set earlier, I used 8080.</p></li></ul><ul><li><p>Now you can browse from the browser exactly the same you could if OpenWrt router would be the device you are browsing from. So to access the Huawei router from the browser you just go 192.168.8.1 if that is the Huawei&#039;s IP or 192.168.1.1 if that is the IP.</p></li></ul>											<p class="post-edited">(Last edited by <strong>boolsheat</strong> on 24 Nov 2016, 20:36)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>