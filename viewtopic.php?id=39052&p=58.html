<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> mwan3; multi-wan policy routing (general topic)</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 22 May 2013 and 6 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 58 of 65</div><nav><ul><li><a href="viewtopic.php%3Fid=39052&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=39052&amp;p=56.html">56</a></li><li><a href="viewtopic.php%3Fid=39052&amp;p=57.html">57</a></li><li class="pagination-current"><span>58</span></li><li><a href="viewtopic.php%3Fid=39052&amp;p=59.html">59</a></li><li><a href="viewtopic.php%3Fid=39052&amp;p=60.html">60</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=39052&amp;p=65.html">65</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p298309">
				<div class="post-metadata">
					<div class="post-num">Post #1426</div>
					<div class="post-author">trumee</div>
					<div class="post-datetime">
						2 Nov 2015, 01:14					</div>
				</div>
				<div class="post-content content">
					<p>This is the version i am using</p><p># opkg install mwan3<br />Package mwan3 (1.6-2) installed in root is up to date</p><p>Is this not the latest version for the CC stable release?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p298337">
				<div class="post-metadata">
					<div class="post-num">Post #1427</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						2 Nov 2015, 09:49					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>trumee wrote:</cite><blockquote><p>I get the following error on starting mwan3. Also, when the ADSL cable is pulled out and re-inserted the ADSL connection doesnt come back on. Any idea what could be wrong?</p><div class="codebox"><pre><code>#mwan3 start
uci: Entry not found
uci: Entry not found
uci: Entry not found
uci: Entry not found</code></pre></div></blockquote></div><p>As mentioned in this thread before, it is probably not mwan3 that is causing this error, but upnp. When you start mwan3, all hotplug events are triggered. Try to disable upnp and try again.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p298448">
				<div class="post-metadata">
					<div class="post-num">Post #1428</div>
					<div class="post-author">trumee</div>
					<div class="post-datetime">
						3 Nov 2015, 02:39					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Adze wrote:</cite><blockquote><p>As mentioned in this thread before, it is probably not mwan3 that is causing this error, but upnp. When you start mwan3, all hotplug events are triggered. Try to disable upnp and try again.</p></blockquote></div><p>Thanks. After disabling the upnp, the errors have gone away. </p><p>Please can you clairify whether luci-app-mwan3 version 1.4-3 in CC r46746 is stable for day to day use? I have read some reports in this thread that there are bugs in that release so wanted to check. I dont want to install trunk version of the whole firmware but would rather update only luci-app-mwan3 if possible?</p><p>Thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p298666">
				<div class="post-metadata">
					<div class="post-num">Post #1429</div>
					<div class="post-author">trumee</div>
					<div class="post-datetime">
						5 Nov 2015, 03:04					</div>
				</div>
				<div class="post-content content">
					<p>After installing luci-app-mwan3 1.4-3 , the uci errors have come back. UPNP is disabled.</p><div class="codebox"><pre><code>Thu Nov  5 06:19:54 2015 daemon.err uhttpd[1215]: uci: Entry not found
Thu Nov  5 06:19:54 2015 daemon.err uhttpd[1215]: uci: Entry not found
Thu Nov  5 06:22:14 2015 daemon.err uhttpd[1215]: uci: Entry not found
Thu Nov  5 06:22:14 2015 daemon.err uhttpd[1215]: uci: Entry not found
Thu Nov  5 06:22:16 2015 daemon.err uhttpd[1215]: uci: Entry not found
Thu Nov  5 06:22:16 2015 daemon.err uhttpd[1215]: uci: Entry not found
Thu Nov  5 06:22:30 2015 daemon.err uhttpd[1215]: uci: Entry not found
Thu Nov  5 06:22:30 2015 daemon.err uhttpd[1215]: uci: Entry not found
Thu Nov  5 06:22:30 2015 daemon.err uhttpd[1215]: uci: Entry not found
Thu Nov  5 06:22:30 2015 daemon.err uhttpd[1215]: uci: Entry not found</code></pre></div><p>Any idea what is the source of this and how can these be removed?</p><p>I have a single failover wan_wan2 rule defined. How can i trigger a ddns update when wan2 becomes the active wan connection after failover?</p>											<p class="post-edited">(Last edited by <strong>trumee</strong> on 5 Nov 2015, 05:20)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p300997">
				<div class="post-metadata">
					<div class="post-num">Post #1430</div>
					<div class="post-author">muronghan</div>
					<div class="post-datetime">
						24 Nov 2015, 05:20					</div>
				</div>
				<div class="post-content content">
					<p>Hi, Adze, thanks a lot for your wonderful job! With mwan3 I could access the whole world and your product was the main reason why I chose OpenWrt rather than other firmware.</p><p>In my city, the bandwidth provided by the biggest ISP is limited to ~100kbps if accessing overseas (well, funny thing is that if accessing domestic sites it is 100Mbps.) So I must use a smaller ISP with poor performance in general, however providing much better service if accessing overseas which is &gt;10Mbps along with the big ISP. </p><p>My idea is to setup dualwan solution on OpenWrt, going thru small ISP if the destination IP is overseas as wan, and going thru big ISP while domestic as wan2. And mwan3 makes everything happen perfectly.</p><p>However, I found the destination IP configuration seemed to limit the number of IP address to around 300. And there are about over 7000 IP rules (in the format of aa.bb.cc.dd/xx) for domestic so I had to manually separate those 7000 into smaller group (less than 300 for each, so about 26 rules as total) rather than just copy-paste only one big group in the destination IP column. Is there any possible to release this limitation? I ask for this favor because the number of IP segment allocated to countries changes quite frequently. Maintaining 26 rules rather than 1 is always a consumption of time.</p><p>Thanks a lot in advance! btw, my mwan3 file size is about 92k bytes. Guess it is the biggest one in this forum? Haha!</p>											<p class="post-edited">(Last edited by <strong>muronghan</strong> on 24 Nov 2015, 05:25)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p301009">
				<div class="post-metadata">
					<div class="post-num">Post #1431</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						24 Nov 2015, 09:43					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>muronghan wrote:</cite><blockquote><p>However, I found the destination IP configuration seemed to limit the number of IP address to around 300. And there are about over 7000 IP rules (in the format of aa.bb.cc.dd/xx) for domestic so I had to manually separate those 7000 into smaller group (less than 300 for each, so about 26 rules as total) rather than just copy-paste only one big group in the destination IP column. Is there any possible to release this limitation? I ask for this favor because the number of IP segment allocated to countries changes quite frequently. Maintaining 26 rules rather than 1 is always a consumption of time.</p></blockquote></div><p>Ipset is your friend. You can create rules with ipset instead of destination ip. This way you only need one mwan3 rule per ISP. More information:</p><p><a href="http://www.linuxjournal.com/content/advanced-firewall-configurations-ipset">http://www.linuxjournal.com/content/adv … ions-ipset</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p301252">
				<div class="post-metadata">
					<div class="post-num">Post #1432</div>
					<div class="post-author">anarchy99</div>
					<div class="post-datetime">
						26 Nov 2015, 02:16					</div>
				</div>
				<div class="post-content content">
					<p>Hi</p><p>I&#039;ve asked already for help regarding VPN interfaces and the setup worked on 12.09 but the same configuration fails in CC and trunk. mwan3 reports nothing, both wwan and vpn interface are down. I can connect only using VPN connection but not main connection at the same time on different virtual wifi interface (except if VPN is disconnected). </p><p>what to do?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p301426">
				<div class="post-metadata">
					<div class="post-num">Post #1433</div>
					<div class="post-author">muronghan</div>
					<div class="post-datetime">
						27 Nov 2015, 15:24					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Adze wrote:</cite><blockquote><div class="quotebox"><cite>muronghan wrote:</cite><blockquote><p>However, I found the destination IP configuration seemed to limit the number of IP address to around 300. And there are about over 7000 IP rules (in the format of aa.bb.cc.dd/xx) for domestic so I had to manually separate those 7000 into smaller group (less than 300 for each, so about 26 rules as total) rather than just copy-paste only one big group in the destination IP column. Is there any possible to release this limitation? I ask for this favor because the number of IP segment allocated to countries changes quite frequently. Maintaining 26 rules rather than 1 is always a consumption of time.</p></blockquote></div><p>Ipset is your friend. You can create rules with ipset instead of destination ip. This way you only need one mwan3 rule per ISP. More information:</p><p><a href="http://www.linuxjournal.com/content/advanced-firewall-configurations-ipset">http://www.linuxjournal.com/content/adv … ions-ipset</a></p></blockquote></div><p>Hi, Adze, is the ipset configuration like this? Given I want to have a.com, b.com,...z.com going thru wan2. And a local faster DNS server for them is 1.2.3.4 let&#039;s say.</p><p>First, I add one line at the end of /etc/dnsmasq.conf i.e. &quot;conf-dir=/etc/dnsmasq.d&quot;; and the second, I create a file so called gowan2.conf under /etc/dnsmasq.conf and edit it as following:</p><p>&nbsp; server=/.a.com/1.2.3.4<br />&nbsp; server=/.b.com/1.2.3.4<br />&nbsp; ...<br />&nbsp; server=/.z.com/1.2.3.4<br />&nbsp; ipset=/.a.com/.b.com/.../.z.com/wan2list</p><p>And the third, I add one configuration in mwan:<br />&nbsp; config rule &#039;gowan2&#039;<br />&nbsp; &nbsp; option sticky &#039;1&#039;<br />&nbsp; &nbsp; option ipset &#039;wan2list&#039;<br />&nbsp; &nbsp; option use_policy &#039;wan2_wan&#039;</p><p>Is that correct?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p301428">
				<div class="post-metadata">
					<div class="post-num">Post #1434</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						27 Nov 2015, 15:29					</div>
				</div>
				<div class="post-content content">
					<p>My dnsmasq knowledge only goes so far, but i would say yes, it is correct. However, remove the sticky option as it makes no sense in a fail-over policy.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p301430">
				<div class="post-metadata">
					<div class="post-num">Post #1435</div>
					<div class="post-author">muronghan</div>
					<div class="post-datetime">
						27 Nov 2015, 15:36					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Adze wrote:</cite><blockquote><p>My dnsmasq knowledge only goes so far, but i would say yes, it is correct. However, remove the sticky option as it makes no sense in a fail-over policy.</p></blockquote></div><p>All right, my fault. sticky thing shall be removed. ..Thanks a lot for your reply. However, then it is the problem coming. When I have 10,000 domain name to put into ipset, the way you supposed to be correct could not work. Was 10,000 too many?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p301432">
				<div class="post-metadata">
					<div class="post-num">Post #1436</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						27 Nov 2015, 15:42					</div>
				</div>
				<div class="post-content content">
					<p>You could and try to increase hashsize and maxelem of your set. 10.000 entries should not be a problem.</p><p><a href="http://www.spinics.net/lists/netfilter/msg54214.html">http://www.spinics.net/lists/netfilter/msg54214.html</a><br /><a href="http://daemonkeeper.net/781/mass-blocking-ip-addresses-with-ipset/">http://daemonkeeper.net/781/mass-blocki … ith-ipset/</a></p>											<p class="post-edited">(Last edited by <strong>Adze</strong> on 27 Nov 2015, 15:44)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p301433">
				<div class="post-metadata">
					<div class="post-num">Post #1437</div>
					<div class="post-author">muronghan</div>
					<div class="post-datetime">
						27 Nov 2015, 15:55					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Adze wrote:</cite><blockquote><p>You could and try to increase hashsize and maxelem of your set. 10.000 entries should not be a problem.</p><p><a href="http://www.spinics.net/lists/netfilter/msg54214.html">http://www.spinics.net/lists/netfilter/msg54214.html</a><br /><a href="http://daemonkeeper.net/781/mass-blocking-ip-addresses-with-ipset/">http://daemonkeeper.net/781/mass-blocki … ith-ipset/</a></p></blockquote></div><p>OK, thx a lot! I will try...and may turn back to you in case of anything unexpected.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p301441">
				<div class="post-metadata">
					<div class="post-num">Post #1438</div>
					<div class="post-author">anarchy99</div>
					<div class="post-datetime">
						27 Nov 2015, 16:22					</div>
				</div>
				<div class="post-content content">
					<p>forgot to add these are the messages i got in diagnostics page:</p><p>Check IP rules</p><p>Missing both of the required interface IP rules</p><p>Check routing table</p><p>Missing required interface routing table 1<br />Missing required interface routing table 2</p><p>hotplug ifup/ifdown has no effect on connections.<br />systemlog shows: No MWAN systemlog history found/No detailed status information available</p><p>troubleshooting with masked MAC addresses</p><div class="codebox"><pre><code>Software versions : 

OpenWrt - OpenWrt Designated Driver r47551
LuCI - git-15.325.46423-c478101

mwan3 - 2.0-0
mwan3-luci - 1.4-4

Output of &quot;cat /etc/config/mwan3&quot; : 

config interface &#039;l2tp&#039;
    option enabled &#039;1&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option timeout &#039;2&#039;
    option interval &#039;5&#039;
    option down &#039;3&#039;
    option up &#039;3&#039;

config interface &#039;wwan&#039;
    option enabled &#039;1&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option timeout &#039;2&#039;
    option interval &#039;5&#039;
    option down &#039;3&#039;
    option up &#039;3&#039;

config member &#039;l2tp_member&#039;
    option interface &#039;l2tp&#039;

config member &#039;wwan_member&#039;
    option interface &#039;wwan&#039;

config policy &#039;l2tp_only&#039;
    list use_member &#039;l2tp_member&#039;
    option last_resort &#039;blackhole&#039;

config policy &#039;wwan_only&#039;
    list use_member &#039;wwan_member&#039;
    option last_resort &#039;blackhole&#039;

config rule &#039;wlan0_1&#039;
    option src_ip &#039;192.168.5.0/24&#039;
    option proto &#039;all&#039;
    option sticky &#039;0&#039;
    option use_policy &#039;l2tp_only&#039;

config rule &#039;wlan0_2&#039;
    option src_ip &#039;192.168.6.0/24&#039;
    option proto &#039;all&#039;
    option sticky &#039;0&#039;
    option use_policy &#039;wwan_only&#039;

config rule &#039;wlan0_3&#039;
    option src_ip &#039;192.168.7.0/24&#039;
    option proto &#039;all&#039;
    option sticky &#039;0&#039;
    option use_policy &#039;l2tp_only&#039;

config rule &#039;lan&#039;
    option src_ip &#039;192.168.4.0/24&#039;
    option proto &#039;all&#039;
    option sticky &#039;0&#039;
    option use_policy &#039;l2tp_only&#039;

config rule &#039;wlan0_4&#039;
    option src_ip &#039;192.168.8.0/24&#039;
    option proto &#039;all&#039;
    option sticky &#039;0&#039;
    option use_policy &#039;blackhole&#039;

Output of &quot;cat /etc/config/network&quot; : 

config interface &#039;loopback&#039;
    option ifname &#039;lo&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;127.0.0.1&#039;
    option netmask &#039;255.0.0.0&#039;

config interface &#039;lan&#039;
    option force_link &#039;1&#039;
    option macaddr &#039;xx:xx:xx:xx:xx:xx&#039;
    option proto &#039;static&#039;
    option netmask &#039;255.255.255.0&#039;
    option delegate &#039;0&#039;
    option _orig_ifname &#039;eth0.1 wlan0 wlan1&#039;
    option _orig_bridge &#039;true&#039;
    option ipaddr &#039;192.168.4.1&#039;
    option ifname &#039;eth0.1&#039;

config interface &#039;wan&#039;
    option ifname &#039;eth0.2&#039;
    option force_link &#039;1&#039;
    option macaddr &#039;xx:xx:xx:xx:xx:xx&#039;
    option proto &#039;dhcp&#039;
    option delegate &#039;0&#039;

config switch
    option name &#039;switch0&#039;
    option reset &#039;1&#039;
    option enable_vlan &#039;1&#039;

config switch_vlan
    option device &#039;switch0&#039;
    option vlan &#039;1&#039;
    option ports &#039;0 1 2 3 6t&#039;

config switch_vlan
    option device &#039;switch0&#039;
    option vlan &#039;2&#039;
    option ports &#039;4 6t&#039;

config interface &#039;l2tp&#039;
    option proto &#039;l2tp&#039;
    option delegate &#039;0&#039;
    option metric &#039;10&#039;
    option server &#039;131.12.114.2&#039;
    USERNAME HIDDEN
    PASSWORD HIDDEN
    option auto &#039;1&#039;

config interface &#039;wlan0_1&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;192.168.5.1&#039;
    option netmask &#039;255.255.255.0&#039;
    option delegate &#039;0&#039;
    option ifname &#039;wlan0&#039;

config interface &#039;wlan0_2&#039;
    option proto &#039;static&#039;
    option delegate &#039;0&#039;
    option ipaddr &#039;192.168.6.1&#039;
    option netmask &#039;255.255.255.0&#039;
    option ifname &#039;wlan0-1&#039;

config interface &#039;wlan0_3&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;192.168.7.1&#039;
    option netmask &#039;255.255.255.0&#039;
    option delegate &#039;0&#039;
    option ifname &#039;wlan0-2&#039;

config interface &#039;wwan&#039;
    option _orig_ifname &#039;wlan2&#039;
    option _orig_bridge &#039;false&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;192.168.0.42&#039;
    option netmask &#039;255.255.254.0&#039;
    option gateway &#039;192.168.0.1&#039;
    option broadcast &#039;192.168.1.255&#039;
    option dns &#039;208.67.222.222 208.67.220.220&#039;
    option delegate &#039;0&#039;
    option metric &#039;20&#039;
    option auto &#039;1&#039;

config interface &#039;wlan0_4&#039;
    option proto &#039;static&#039;
    option delegate &#039;0&#039;
    option ipaddr &#039;192.168.8.1&#039;
    option netmask &#039;255.255.255.0&#039;
    option ifname &#039;wlan0-3&#039;

Output of &quot;ifconfig&quot; : 

eth0      Link encap:Ethernet  HWaddr xx:xx:xx:xx:xx:xx  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:61012 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:21024162 (20.0 MiB)
          Interrupt:5 

eth0.1    Link encap:Ethernet  HWaddr xx:xx:xx:xx:xx:xx  
          inet addr:192.168.4.1  Bcast:192.168.4.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

eth0.2    Link encap:Ethernet  HWaddr xx:xx:xx:xx:xx:xx  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:60698 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:0 (0.0 B)  TX bytes:20758716 (19.7 MiB)

l2tp-l2tp Link encap:Point-to-Point Protocol  
          inet addr:10.10.1.5  P-t-P:10.10.1.1  Mask:255.255.255.255
          UP POINTOPOINT RUNNING NOARP MULTICAST  MTU:1410  Metric:1
          RX packets:5314631 errors:0 dropped:0 overruns:0 frame:0
          TX packets:9093226 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:3 
          RX bytes:1289292537 (1.2 GiB)  TX bytes:12008116178 (11.1 GiB)

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:66792 errors:0 dropped:0 overruns:0 frame:0
          TX packets:66792 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:7084358 (6.7 MiB)  TX bytes:7084358 (6.7 MiB)

mon0      Link encap:UNSPEC  HWaddr E8-94-F6-2C-1F-A8-00-00-00-00-00-00-00-00-00-00  
          UP BROADCAST NOTRAILERS RUNNING PROMISC ALLMULTI  MTU:1500  Metric:1
          RX packets:15777055 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:2620510671 (2.4 GiB)  TX bytes:0 (0.0 B)

wlan0     Link encap:Ethernet  HWaddr xx:xx:xx:xx:xx:xx  
          inet addr:192.168.5.1  Bcast:192.168.5.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:138906320 errors:0 dropped:0 overruns:0 frame:0
          TX packets:73286967 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:193081851392 (179.8 GiB)  TX bytes:9084616580 (8.4 GiB)

wlan0-1   Link encap:Ethernet  HWaddr xx:xx:xx:xx:xx:xx  
          inet addr:192.168.6.1  Bcast:192.168.6.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:5851858 errors:0 dropped:0 overruns:0 frame:0
          TX packets:3491339 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:8450006455 (7.8 GiB)  TX bytes:723819902 (690.2 MiB)

wlan0-2   Link encap:Ethernet  HWaddr xx:xx:xx:xx:xx:xx  
          inet addr:192.168.7.1  Bcast:192.168.7.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:2928178 errors:0 dropped:5868 overruns:0 frame:0
          TX packets:3898468 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:680164281 (648.6 MiB)  TX bytes:4340992467 (4.0 GiB)

wlan0-3   Link encap:Ethernet  HWaddr xx:xx:xx:xx:xx:xx  
          inet addr:192.168.8.1  Bcast:192.168.8.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:1 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:360 (360.0 B)

wlan1     Link encap:Ethernet  HWaddr xx:xx:xx:xx:xx:xx  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:15134 errors:0 dropped:0 overruns:0 frame:0
          TX packets:13130 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:11970095 (11.4 MiB)  TX bytes:9145190 (8.7 MiB)

wlan1-1   Link encap:Ethernet  HWaddr xx:xx:xx:xx:xx:xx  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

wlan1-2   Link encap:Ethernet  HWaddr xx:xx:xx:xx:xx:xx  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:335 errors:0 dropped:117 overruns:0 frame:0
          TX packets:335 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:37000 (36.1 KiB)  TX bytes:43066 (42.0 KiB)

wlan1-3   Link encap:Ethernet  HWaddr xx:xx:xx:xx:xx:xx  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

wlan2     Link encap:Ethernet  HWaddr xx:xx:xx:xx:xx:xx  
          inet addr:192.168.0.42  Bcast:192.168.1.255  Mask:255.255.254.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:8879735 errors:0 dropped:14440 overruns:0 frame:0
          TX packets:14944377 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:2239147203 (2.0 GiB)  TX bytes:21318800695 (19.8 GiB)

Output of &quot;route -n&quot; : 

Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
0.0.0.0         10.10.1.1       0.0.0.0         UG    10     0        0 l2tp-l2tp
0.0.0.0         192.168.0.1     0.0.0.0         UG    20     0        0 wlan2
10.10.1.1       0.0.0.0         255.255.255.255 UH    0      0        0 l2tp-l2tp
131.12.114.2    192.168.0.1     255.255.255.255 UGH   20     0        0 wlan2
192.168.0.0     0.0.0.0         255.255.254.0   U     20     0        0 wlan2
192.168.4.0     0.0.0.0         255.255.255.0   U     0      0        0 eth0.1
192.168.5.0     0.0.0.0         255.255.255.0   U     0      0        0 wlan0
192.168.6.0     0.0.0.0         255.255.255.0   U     0      0        0 wlan0-1
192.168.7.0     0.0.0.0         255.255.255.0   U     0      0        0 wlan0-2
192.168.8.0     0.0.0.0         255.255.255.0   U     0      0        0 wlan0-3

Output of &quot;ip rule show&quot; : 

0:    from all lookup 128 
1:    from all lookup local 
32766:    from all lookup main 
32767:    from all lookup default

Output of &quot;ip route list table 1-250&quot; : 

No data found

Firewall default output policy (must be ACCEPT) : 

ACCEPT

Output of &quot;iptables -L -t mangle -v -n&quot; : 

Chain PREROUTING (policy ACCEPT 20M packets, 15G bytes)
 pkts bytes target     prot opt in     out     source               destination         
  20M   15G fwmark     all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain INPUT (policy ACCEPT 5345K packets, 1506M bytes)
 pkts bytes target     prot opt in     out     source               destination         

Chain FORWARD (policy ACCEPT 14M packets, 13G bytes)
 pkts bytes target     prot opt in     out     source               destination         
  14M   13G mssfix     all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain OUTPUT (policy ACCEPT 9119K packets, 12G bytes)
 pkts bytes target     prot opt in     out     source               destination         

Chain POSTROUTING (policy ACCEPT 23M packets, 26G bytes)
 pkts bytes target     prot opt in     out     source               destination         

Chain fwmark (1 references)
 pkts bytes target     prot opt in     out     source               destination         

Chain mssfix (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 TCPMSS     tcp  --  *      eth0.2  0.0.0.0/0            0.0.0.0/0            tcp flags:0x06/0x02 /* wan (mtu_fix) */ TCPMSS clamp to PMTU
  204  9496 TCPMSS     tcp  --  *      wlan2   0.0.0.0/0            0.0.0.0/0            tcp flags:0x06/0x02 /* wan (mtu_fix) */ TCPMSS clamp to PMTU
 6157  294K TCPMSS     tcp  --  *      l2tp-l2tp  0.0.0.0/0         0.0.0.0/0            tcp flags:0x06/0x02 /* vpn (mtu_fix) */ TCPMSS clamp to PMTU</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p301445">
				<div class="post-metadata">
					<div class="post-num">Post #1439</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						27 Nov 2015, 16:44					</div>
				</div>
				<div class="post-content content">
					<p>Hi anarchy99,</p><br /><p>You are running the brand new (possibly buggy) v2.0 version. Lets find out whats wrong...</p><p>It looks like mwan3 has not even started. There are no rules, no routes and no iptables or whatsoever configered. Could you try the following:</p><div class="codebox"><pre><code>chmod 755 /etc/hotplug.d/iface/15-mwan3
ACTION=ifup DEVICE=wlan2 INTERFACE=wwan /etc/hotplug.d/iface/15-mwan3
echo $?</code></pre></div><p>what number do you get?</p>											<p class="post-edited">(Last edited by <strong>Adze</strong> on 27 Nov 2015, 16:52)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p301467">
				<div class="post-metadata">
					<div class="post-num">Post #1440</div>
					<div class="post-author">anarchy99</div>
					<div class="post-datetime">
						27 Nov 2015, 19:01					</div>
				</div>
				<div class="post-content content">
					<p>it returns number 7. does the mwan3 appear in processes list once its started?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p301506">
				<div class="post-metadata">
					<div class="post-num">Post #1441</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						27 Nov 2015, 23:21					</div>
				</div>
				<div class="post-content content">
					<p>As of version 2.0, mwan3 has exit codes. The following errors are known:</p><p>1: ACTION is not &quot;ïfup&quot; or &quot;ifdown&quot; <br />2: INTERFACE not set<br />3: DEVICE not set<br />4: ip not found<br />5: ipset not found<br />6: iptables not found<br />7: ip6tables not found<br />8: logger not found</p>											<p class="post-edited">(Last edited by <strong>Adze</strong> on 27 Nov 2015, 23:22)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p301508">
				<div class="post-metadata">
					<div class="post-num">Post #1442</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						27 Nov 2015, 23:27					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>anarchy99 wrote:</cite><blockquote><p>it returns number 7. does the mwan3 appear in processes list once its started?</p></blockquote></div><p>mwan3 process does not remain in process list. It exits after tables and rules are set.</p><p>Error 7 means that ip6tables is not found. If you dont use ipv6 that would not be a problem. So consider it a bug. Please comment out line 13 in &quot;/etc/init.d/hotplug.d/iface/15-mwan3. Also comment out line 6 in &quot;/usr/sbin/mwan3&quot;. And try again please.</p><p>Thnx</p>											<p class="post-edited">(Last edited by <strong>Adze</strong> on 27 Nov 2015, 23:28)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p301521">
				<div class="post-metadata">
					<div class="post-num">Post #1443</div>
					<div class="post-author">anarchy99</div>
					<div class="post-datetime">
						28 Nov 2015, 04:16					</div>
				</div>
				<div class="post-content content">
					<p>it works. interfaces are accessible as expected. only ip6 errors remain in log, any way to remove them?</p><div class="codebox"><pre><code>Last 50 MWAN systemlog entries. Newest entries sorted at the top :

Sat Nov 28 03:14:06 2015 daemon.err uhttpd[4893]: /usr/sbin/mwan3: line 1: /usr/sbin/ip6tables: not found
Sat Nov 28 03:14:01 2015 daemon.err uhttpd[4893]: /usr/sbin/mwan3: line 1: /usr/sbin/ip6tables: not found
Sat Nov 28 03:13:56 2015 daemon.err uhttpd[4893]: /usr/sbin/mwan3: line 1: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:16 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 1: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:16 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 1: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:16 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 45: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:16 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 45: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:16 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 45: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:16 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 45: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:16 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 45: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:16 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 45: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:16 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 45: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:16 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 45: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:16 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 45: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:16 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 45: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:16 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 45: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:16 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 45: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:16 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 45: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:16 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 45: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:16 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 45: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:16 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 45: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:16 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 45: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:16 2015 user.notice mwan3: ifup interface wwan (wlan2)
Sat Nov 28 03:12:14 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 1: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:14 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 1: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:14 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 45: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:14 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 45: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:14 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 45: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:14 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 45: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:14 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 45: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:14 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 45: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:14 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 45: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:14 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 45: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:14 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 45: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:14 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 45: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:14 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 45: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:14 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 45: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:14 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 45: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:14 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 45: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:14 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 45: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:14 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 45: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:14 2015 daemon.err uhttpd[4893]: /sbin/hotplug-call: /etc/hotplug.d/iface/15-mwan3: line 45: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:13 2015 user.notice mwan3: ifup interface l2tp (l2tp-l2tp)
Sat Nov 28 03:12:11 2015 daemon.err uhttpd[4893]: /usr/sbin/mwan3: line 174: /usr/sbin/ip6tables: not found
Sat Nov 28 03:12:11 2015 daemon.err uhttpd[4893]: /usr/sbin/mwan3: line 174: /usr/sbin/ip6tables: not found
Sat Nov 28 02:54:40 2015 daemon.err uhttpd[4893]: /usr/sbin/mwan3: line 1: /usr/sbin/ip6tables: not found
Sat Nov 28 02:54:35 2015 daemon.err uhttpd[4893]: /usr/sbin/mwan3: line 1: /usr/sbin/ip6tables: not found</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p301568">
				<div class="post-metadata">
					<div class="post-num">Post #1444</div>
					<div class="post-author">muronghan</div>
					<div class="post-datetime">
						28 Nov 2015, 17:19					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Adze wrote:</cite><blockquote><div class="quotebox"><cite>muronghan wrote:</cite><blockquote><p>However, I found the destination IP configuration seemed to limit the number of IP address to around 300. And there are about over 7000 IP rules (in the format of aa.bb.cc.dd/xx) for domestic so I had to manually separate those 7000 into smaller group (less than 300 for each, so about 26 rules as total) rather than just copy-paste only one big group in the destination IP column. Is there any possible to release this limitation? I ask for this favor because the number of IP segment allocated to countries changes quite frequently. Maintaining 26 rules rather than 1 is always a consumption of time.</p></blockquote></div><p>Ipset is your friend. You can create rules with ipset instead of destination ip. This way you only need one mwan3 rule per ISP. More information:</p><p><a href="http://www.linuxjournal.com/content/advanced-firewall-configurations-ipset">http://www.linuxjournal.com/content/adv … ions-ipset</a></p></blockquote></div><p>Hi, Adze, I put those thousands of CIDR things into /etc/rc.local as following:</p><p>ipset create gotowan2 hash:net hashsize 8192<br />ipset add gotowan2 1.1.0.0/24<br />ipset add gotowan2 1.1.2.0/23<br />ipset add gotowan2 1.1.4.0/22<br />ipset add gotowan2 1.1.8.0/21<br />...... (skip 5000+ CIDR)<br />exit 0</p><p>Add one rule with gotowan2 ipset into /etc/config/mwan3. Reboot the router and it works. Is that what you advised? Thanks a lot!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p301827">
				<div class="post-metadata">
					<div class="post-num">Post #1445</div>
					<div class="post-author">inquba</div>
					<div class="post-datetime">
						30 Nov 2015, 16:50					</div>
				</div>
				<div class="post-content content">
					<p>HI ADZE... Just wondering.... Mwan3 is compatible with HNET-FULL is a homenet packages that include babeld....</p><p>The last time I test mwan3 with babeld&nbsp; I like it both, it does some kind of homing it adds bandwidth from the ISPs interfaces. Giving me 20mbps down and 5 mbps up</p><br /><p>Then I install hnet-full with babeld without mwan3 but seems no homing, it appears that it uses only one ISP of 3 availables instead of 3 as used to with mwan3 babeld... Giving 7 mbps down 1.5 mbps up</p><p>Any experience, comment with Hnet-full?&nbsp; Why with mwan3 does homing. Thanks</p>											<p class="post-edited">(Last edited by <strong>inquba</strong> on 30 Nov 2015, 16:54)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p302965">
				<div class="post-metadata">
					<div class="post-num">Post #1446</div>
					<div class="post-author">bobptz</div>
					<div class="post-datetime">
						9 Dec 2015, 00:49					</div>
				</div>
				<div class="post-content content">
					<p>Hi</p><p>I installed mwan3 with OpenWrt Chaos Calmer 15.05 / LuCI (git-15.248.30277-3836b45) on a TP-LINK WDR3600.</p><p>My first problem is that I get the following error messages at the &quot;MWAN Interface Configuration&quot;:<br />There are currently 2 of 250 supported interfaces configured<br />WARNING: some interfaces have no default route in the main routing table!<br />WARNING: some interfaces are configured incorrectly or not at all in /etc/config/network!<br />WARNING: some interfaces have no metric configured in /etc/config/network!</p><p>Second, I find it difficult to follow this manual: <a href="https://wiki.openwrt.org/doc/howto/mwan3">https://wiki.openwrt.org/doc/howto/mwan3</a><br />For example I did not find anything on how to give priority to voip traffic.</p><p>Can you recommend a simple guide to setup mwan3?&nbsp; Preferably from LUCI ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p303121">
				<div class="post-metadata">
					<div class="post-num">Post #1447</div>
					<div class="post-author">bobptz</div>
					<div class="post-datetime">
						10 Dec 2015, 08:17					</div>
				</div>
				<div class="post-content content">
					<p>Hi</p><p>About the Warning messages, I did find a related post with a solution here:&nbsp; <br /><a href="https://forum.openwrt.org/viewtopic.php?pid=230638#p230638">https://forum.openwrt.org/viewtopic.php … 38#p230638</a></p><p>However my setting in the file /etc/config/network are different, so I could not follow the suggested solution:</p><p>config interface &#039;wan&#039;<br />&nbsp; &nbsp; option ifname &#039;eth0.2&#039;<br />&nbsp; &nbsp; option _orig_ifname &#039;eth0.2&#039;<br />&nbsp; &nbsp; option _orig_bridge &#039;false&#039;<br />&nbsp; &nbsp; option proto &#039;pppoe&#039;</p><p>config interface &#039;WAN2&#039;<br />&nbsp; &nbsp; option ifname &#039;eth0.3&#039;<br />&nbsp; &nbsp; option _orig_ifname &#039;eth0.3&#039;<br />&nbsp; &nbsp; option _orig_bridge &#039;false&#039;<br />&nbsp; &nbsp; option proto &#039;pppoe&#039;</p>											<p class="post-edited">(Last edited by <strong>bobptz</strong> on 10 Dec 2015, 08:20)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p303134">
				<div class="post-metadata">
					<div class="post-num">Post #1448</div>
					<div class="post-author">Adze</div>
					<div class="post-datetime">
						10 Dec 2015, 10:41					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>bobptz wrote:</cite><blockquote><p>Hi</p><p>I installed mwan3 with OpenWrt Chaos Calmer 15.05 / LuCI (git-15.248.30277-3836b45) on a TP-LINK WDR3600.</p><p>My first problem is that I get the following error messages at the &quot;MWAN Interface Configuration&quot;:<br />There are currently 2 of 250 supported interfaces configured<br />WARNING: some interfaces have no default route in the main routing table!<br />WARNING: some interfaces are configured incorrectly or not at all in /etc/config/network!<br />WARNING: some interfaces have no metric configured in /etc/config/network!</p><p>Second, I find it difficult to follow this manual: <a href="https://wiki.openwrt.org/doc/howto/mwan3">https://wiki.openwrt.org/doc/howto/mwan3</a><br />For example I did not find anything on how to give priority to voip traffic.</p><p>Can you recommend a simple guide to setup mwan3?&nbsp; Preferably from LUCI ?</p></blockquote></div><p>Could you please post your current network setup and mwan3 setup? Maybe i can help...</p><p>As to your question about giving priority to VoIP traffic, that can be done with QoS packages, not with mwan3.</p>											<p class="post-edited">(Last edited by <strong>Adze</strong> on 10 Dec 2015, 10:42)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p303384">
				<div class="post-metadata">
					<div class="post-num">Post #1449</div>
					<div class="post-author">bobptz</div>
					<div class="post-datetime">
						12 Dec 2015, 02:26					</div>
				</div>
				<div class="post-content content">
					<p>Hello Adze</p><p>For some reason WAN2 is always OFFLINE.&nbsp; Funny thing is when I connect the modem to the WAN2 port, I can have internet access.&nbsp; I set WAN to disabled and when I connect the WAN port to the modem, again I have internet access.&nbsp; (I setup WAN and WAN2, but I only have ONE modem running right now).</p><p>You asked me to post my network and mwan3 setup.&nbsp; I am not exactly sure what you mean, here is some info I could gather:</p><br /><p>This is the MWAN detailed status:<br /></p><div class="codebox"><pre><code>Interface status:
 interface wan is online (tracking active)
 interface wan2 is unknown

Policy balanced:
 wan (100%)

Policy wan2_only:
 unreachable

Policy wan2_wan:
 wan (100%)

Policy wan_only:
 wan (100%)

Policy wan_wan2:
 wan (100%)

Known networks:
 2.85.239.153
 192.168.1.0
 127.0.0.1
 127.0.0.0
 224.0.0.0/3
 127.255.255.255
 80.106.108.74
 127.0.0.0/8
 192.168.1.1
 192.168.1.0/24
 192.168.1.255

Active rules:
    0     0 S youtube  tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            match-set youtube dst multiport sports 0:65535 multiport dports 80,443 
  458 34992 S https  tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            multiport sports 0:65535 multiport dports 443 
  658 43759 - balanced  all  --  *      *       0.0.0.0/0            0.0.0.0/0</code></pre></div><p>This is the &quot;Trouble shooting data&quot;:<br /></p><div class="codebox"><pre><code>Software versions : 

OpenWrt - OpenWrt Chaos Calmer 15.05
LuCI - git-15.248.30277-3836b45

mwan3 - 1.6-2
mwan3-luci - 1.4-3

Output of &quot;cat /etc/config/mwan3&quot; : 

config interface &#039;wan&#039;
    list track_ip &#039;8.8.4.4&#039;
    list track_ip &#039;8.8.8.8&#039;
    list track_ip &#039;208.67.222.222&#039;
    list track_ip &#039;208.67.220.220&#039;
    option reliability &#039;2&#039;
    option count &#039;1&#039;
    option timeout &#039;2&#039;
    option interval &#039;5&#039;
    option down &#039;3&#039;
    option up &#039;8&#039;
    option enabled &#039;1&#039;

config interface &#039;wan2&#039;
    list track_ip &#039;8.8.8.8&#039;
    list track_ip &#039;208.67.220.220&#039;
    option reliability &#039;1&#039;
    option count &#039;1&#039;
    option timeout &#039;2&#039;
    option interval &#039;5&#039;
    option down &#039;3&#039;
    option up &#039;8&#039;
    option enabled &#039;1&#039;

config member &#039;wan_m1_w3&#039;
    option interface &#039;wan&#039;
    option metric &#039;1&#039;
    option weight &#039;3&#039;

config member &#039;wan_m2_w3&#039;
    option interface &#039;wan&#039;
    option metric &#039;2&#039;
    option weight &#039;3&#039;

config member &#039;wan2_m1_w2&#039;
    option interface &#039;wan2&#039;
    option metric &#039;1&#039;
    option weight &#039;2&#039;

config member &#039;wan2_m2_w2&#039;
    option interface &#039;wan2&#039;
    option metric &#039;2&#039;
    option weight &#039;2&#039;

config policy &#039;wan_only&#039;
    list use_member &#039;wan_m1_w3&#039;

config policy &#039;wan2_only&#039;
    list use_member &#039;wan2_m1_w2&#039;

config policy &#039;balanced&#039;
    list use_member &#039;wan_m1_w3&#039;
    list use_member &#039;wan2_m1_w2&#039;

config policy &#039;wan_wan2&#039;
    list use_member &#039;wan_m1_w3&#039;
    list use_member &#039;wan2_m2_w2&#039;

config policy &#039;wan2_wan&#039;
    list use_member &#039;wan_m2_w3&#039;
    list use_member &#039;wan2_m1_w2&#039;

config rule &#039;youtube&#039;
    option sticky &#039;1&#039;
    option ipset &#039;youtube&#039;
    option dest_port &#039;80,443&#039;
    option proto &#039;tcp&#039;
    option use_policy &#039;balanced&#039;

config rule &#039;https&#039;
    option sticky &#039;1&#039;
    option dest_port &#039;443&#039;
    option proto &#039;tcp&#039;
    option use_policy &#039;balanced&#039;

config rule &#039;default_rule&#039;
    option dest_ip &#039;0.0.0.0/0&#039;
    option use_policy &#039;balanced&#039;

Output of &quot;cat /etc/config/network&quot; : 

config interface &#039;loopback&#039;
    option ifname &#039;lo&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;127.0.0.1&#039;
    option netmask &#039;255.0.0.0&#039;

config globals &#039;globals&#039;
    option ula_prefix &#039;fdf7:1a7c:a459::/48&#039;

config interface &#039;lan&#039;
    option ifname &#039;eth0.1&#039;
    option force_link &#039;1&#039;
    option type &#039;bridge&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;192.168.1.1&#039;
    option netmask &#039;255.255.255.0&#039;
    option ip6assign &#039;60&#039;

config interface &#039;wan&#039;
    option ifname &#039;eth0.2&#039;
    option _orig_ifname &#039;eth0.2&#039;
    option _orig_bridge &#039;false&#039;
    option proto &#039;pppoe&#039;
    USERNAME HIDDEN
    PASSWORD HIDDEN
    option metric &#039;10&#039;

config switch
    option name &#039;switch0&#039;
    option reset &#039;1&#039;
    option enable_vlan &#039;1&#039;
    option mirror_source_port &#039;0&#039;
    option mirror_monitor_port &#039;0&#039;

config switch_vlan
    option device &#039;switch0&#039;
    option vlan &#039;1&#039;
    option vid &#039;1&#039;
    option ports &#039;0t 3 4 5&#039;

config switch_vlan
    option device &#039;switch0&#039;
    option vlan &#039;2&#039;
    option ports &#039;0t 1&#039;
    option vid &#039;2&#039;

config switch_vlan
    option device &#039;switch0&#039;
    option vlan &#039;3&#039;
    option vid &#039;3&#039;
    option ports &#039;0t 2&#039;

config interface &#039;WAN2&#039;
    option ifname &#039;eth0.3&#039;
    option _orig_ifname &#039;eth0.3&#039;
    option _orig_bridge &#039;false&#039;
    option proto &#039;pppoe&#039;
    USERNAME HIDDEN
    PASSWORD HIDDEN
    option metric &#039;20&#039;

Output of &quot;ifconfig&quot; : 

br-lan    Link encap:Ethernet  HWaddr 14:CC:20:BA:5D:2A  
          inet addr:192.168.1.1  Bcast:192.168.1.255  Mask:255.255.255.0
          inet6 addr: fdf7:1a7c:a459::1/60 Scope:Global
          inet6 addr: fe80::16cc:20ff:feba:5d2a/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:21761 errors:0 dropped:0 overruns:0 frame:0
          TX packets:23891 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:2709897 (2.5 MiB)  TX bytes:17254312 (16.4 MiB)

eth0      Link encap:Ethernet  HWaddr 14:CC:20:BA:5D:2A  
          inet6 addr: fe80::16cc:20ff:feba:5d2a/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:46107 errors:0 dropped:0 overruns:0 frame:0
          TX packets:47671 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:20013318 (19.0 MiB)  TX bytes:20241755 (19.3 MiB)
          Interrupt:4 

eth0.1    Link encap:Ethernet  HWaddr 14:CC:20:BA:5D:2A  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:19728 errors:0 dropped:0 overruns:0 frame:0
          TX packets:22020 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:2430301 (2.3 MiB)  TX bytes:16830842 (16.0 MiB)

eth0.2    Link encap:Ethernet  HWaddr 14:CC:20:BA:5D:2A  
          inet6 addr: fe80::16cc:20ff:feba:5d2a/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:26379 errors:0 dropped:59 overruns:0 frame:0
          TX packets:23983 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:16753091 (15.9 MiB)  TX bytes:3084867 (2.9 MiB)

eth0.3    Link encap:Ethernet  HWaddr 14:CC:20:BA:5D:2A  
          inet6 addr: fe80::16cc:20ff:feba:5d2a/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:9 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:0 (0.0 B)  TX bytes:786 (786.0 B)

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:22 errors:0 dropped:0 overruns:0 frame:0
          TX packets:22 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:1995 (1.9 KiB)  TX bytes:1995 (1.9 KiB)

pppoe-wan Link encap:Point-to-Point Protocol  
          inet addr:2.85.239.153  P-t-P:80.106.108.74  Mask:255.255.255.255
          inet6 addr: fe80::94d:b15a:64a7:23aa/10 Scope:Link
          UP POINTOPOINT RUNNING NOARP MULTICAST  MTU:1492  Metric:1
          RX packets:23681 errors:0 dropped:0 overruns:0 frame:0
          TX packets:21342 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:3 
          RX bytes:16435318 (15.6 MiB)  TX bytes:2535520 (2.4 MiB)

wlan0     Link encap:Ethernet  HWaddr 14:CC:20:BA:5D:2B  
          inet6 addr: fe80::16cc:20ff:feba:5d2b/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:2452 errors:0 dropped:0 overruns:0 frame:0
          TX packets:3471 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:359752 (351.3 KiB)  TX bytes:658152 (642.7 KiB)

Output of &quot;route -n&quot; : 

Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
0.0.0.0         80.106.108.74   0.0.0.0         UG    10     0        0 pppoe-wan
80.106.108.74   0.0.0.0         255.255.255.255 UH    0      0        0 pppoe-wan
192.168.1.0     0.0.0.0         255.255.255.0   U     0      0        0 br-lan

Output of &quot;ip rule show&quot; : 

0:    from all lookup 128 
1:    from all lookup local 
1001:    from all iif pppoe-wan lookup main 
2001:    from all fwmark 0x100/0xff00 lookup 1 
2253:    from all fwmark 0xfd00/0xff00 blackhole
2254:    from all fwmark 0xfe00/0xff00 unreachable
32766:    from all lookup main 
32767:    from all lookup default

Output of &quot;ip route list table 1-250&quot; : 

1
default via 80.106.108.74 dev pppoe-wan

Firewall default output policy (must be ACCEPT) : 

ACCEPT

Output of &quot;iptables -L -t mangle -v -n&quot; : 

Chain PREROUTING (policy ACCEPT 45030 packets, 19M bytes)
 pkts bytes target     prot opt in     out     source               destination         
45034   19M mwan3_hook  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
45030   19M fwmark     all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain INPUT (policy ACCEPT 6006 packets, 437K bytes)
 pkts bytes target     prot opt in     out     source               destination         

Chain FORWARD (policy ACCEPT 38828 packets, 19M bytes)
 pkts bytes target     prot opt in     out     source               destination         
38828   19M mssfix     all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain OUTPUT (policy ACCEPT 5925 packets, 849K bytes)
 pkts bytes target     prot opt in     out     source               destination         
 5929  849K mwan3_hook  all  --  *      *       0.0.0.0/0            0.0.0.0/0           

Chain POSTROUTING (policy ACCEPT 44753 packets, 19M bytes)
 pkts bytes target     prot opt in     out     source               destination         

Chain fwmark (1 references)
 pkts bytes target     prot opt in     out     source               destination         

Chain mssfix (1 references)
 pkts bytes target     prot opt in     out     source               destination         
  764 45840 TCPMSS     tcp  --  *      pppoe-wan  0.0.0.0/0            0.0.0.0/0            tcp flags:0x06/0x02 /* wan (mtu_fix) */ TCPMSS clamp to PMTU
    0     0 TCPMSS     tcp  --  *      eth0.3  0.0.0.0/0            0.0.0.0/0            tcp flags:0x06/0x02 /* wan (mtu_fix) */ TCPMSS clamp to PMTU

Chain mwan3_connected (2 references)
 pkts bytes target     prot opt in     out     source               destination         
23391   17M MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            match-set mwan3_connected dst MARK or 0xff00

Chain mwan3_hook (2 references)
 pkts bytes target     prot opt in     out     source               destination         
50963   20M CONNMARK   all  --  *      *       0.0.0.0/0            0.0.0.0/0            CONNMARK restore mask 0xff00
 5172  294K mwan3_ifaces  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00
 5154  293K mwan3_connected  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00
 3537  172K mwan3_track  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00
 1609  110K mwan3_rules  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00
50963   20M CONNMARK   all  --  *      *       0.0.0.0/0            0.0.0.0/0            CONNMARK save mask 0xff00
41222   19M mwan3_connected  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match ! 0xff00/0xff00

Chain mwan3_iface_wan (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MARK       all  --  pppoe-wan *       0.0.0.0/0            0.0.0.0/0            match-set mwan3_connected src mark match 0x0/0xff00 /* default */ MARK or 0xff00
   18  1618 MARK       all  --  pppoe-wan *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* wan */ MARK xset 0x100/0xff00

Chain mwan3_ifaces (1 references)
 pkts bytes target     prot opt in     out     source               destination         
 5172  294K mwan3_iface_wan  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00

Chain mwan3_policy_balanced (3 references)
 pkts bytes target     prot opt in     out     source               destination         
 1026 67620 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* wan 3 3 */ MARK xset 0x100/0xff00

Chain mwan3_policy_wan2_only (0 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* unreachable */ MARK xset 0xfe00/0xff00

Chain mwan3_policy_wan2_wan (0 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* wan 3 3 */ MARK xset 0x100/0xff00

Chain mwan3_policy_wan_only (0 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* wan 3 3 */ MARK xset 0x100/0xff00

Chain mwan3_policy_wan_wan2 (0 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* wan 3 3 */ MARK xset 0x100/0xff00

Chain mwan3_rule_https (1 references)
 pkts bytes target     prot opt in     out     source               destination         
  589 42944 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 MARK xset 0x100/0xff00
    6   406 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            ! match-set mwan3_sticky_https src,src MARK and 0xffff00ff
    6   406 mwan3_policy_balanced  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00
  589 42944 SET        all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match ! 0xfc00/0xfc00 del-set mwan3_sticky_https src,src
  589 42944 SET        all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match ! 0xfc00/0xfc00 add-set mwan3_sticky_https src,src

Chain mwan3_rule_youtube (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 MARK xset 0x100/0xff00
    0     0 MARK       all  --  *      *       0.0.0.0/0            0.0.0.0/0            ! match-set mwan3_sticky_youtube src,src MARK and 0xffff00ff
    0     0 mwan3_policy_balanced  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00
    0     0 SET        all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match ! 0xfc00/0xfc00 del-set mwan3_sticky_youtube src,src
    0     0 SET        all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match ! 0xfc00/0xfc00 add-set mwan3_sticky_youtube src,src

Chain mwan3_rules (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 mwan3_rule_youtube  tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            match-set youtube dst multiport sports 0:65535 multiport dports 80,443 mark match 0x0/0xff00 /* youtube */
  589 42944 mwan3_rule_https  tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            multiport sports 0:65535 multiport dports 443 mark match 0x0/0xff00 /* https */
 1020 67214 mwan3_policy_balanced  all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x0/0xff00 /* default_rule */

Chain mwan3_track (1 references)
 pkts bytes target     prot opt in     out     source               destination         
 1928 61696 MARK       icmp --  *      *       0.0.0.0/0            0.0.0.0/0            match-set mwan3_track_wan dst icmptype 8 length 32 MARK or 0xff00</code></pre></div><br /><p>This is from Network Config:<br /></p><div class="codebox"><pre><code>config interface &#039;loopback&#039;
    option ifname &#039;lo&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;127.0.0.1&#039;
    option netmask &#039;255.0.0.0&#039;

config globals &#039;globals&#039;
    option ula_prefix &#039;fdf7:1a7c:a459::/48&#039;

config interface &#039;lan&#039;
    option ifname &#039;eth0.1&#039;
    option force_link &#039;1&#039;
    option type &#039;bridge&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;192.168.1.1&#039;
    option netmask &#039;255.255.255.0&#039;
    option ip6assign &#039;60&#039;

config interface &#039;wan&#039;
    option ifname &#039;eth0.2&#039;
    option _orig_ifname &#039;eth0.2&#039;
    option _orig_bridge &#039;false&#039;
    option proto &#039;pppoe&#039;
    option username &#039;o9ke4b@otenet.gr&#039;
    option password &#039;rty8-4l&#039;
    option metric &#039;10&#039;

config switch
    option name &#039;switch0&#039;
    option reset &#039;1&#039;
    option enable_vlan &#039;1&#039;
    option mirror_source_port &#039;0&#039;
    option mirror_monitor_port &#039;0&#039;

config switch_vlan
    option device &#039;switch0&#039;
    option vlan &#039;1&#039;
    option vid &#039;1&#039;
    option ports &#039;0t 3 4 5&#039;

config switch_vlan
    option device &#039;switch0&#039;
    option vlan &#039;2&#039;
    option ports &#039;0t 1&#039;
    option vid &#039;2&#039;

config switch_vlan
    option device &#039;switch0&#039;
    option vlan &#039;3&#039;
    option vid &#039;3&#039;
    option ports &#039;0t 2&#039;

config interface &#039;WAN2&#039;
    option ifname &#039;eth0.3&#039;
    option _orig_ifname &#039;eth0.3&#039;
    option _orig_bridge &#039;false&#039;
    option proto &#039;pppoe&#039;
    option username &#039;o9ke4b@otenet.gr&#039;
    option password &#039;rty8-4l&#039;
    option metric &#039;20&#039;</code></pre></div><p>Just in case, here is the IFCONFIG from my pc (I am using ubuntu 14.04):<br /></p><div class="codebox"><pre><code>$ ifconfig
eth2      Link encap:Ethernet  HWaddr d0:50:99:4b:7a:b7  
          inet addr:192.168.1.215  Bcast:192.168.1.255  Mask:255.255.255.0
          inet6 addr: fe80::d250:99ff:fe4b:7ab7/64 Scope:Link
          inet6 addr: fdf7:1a7c:a459:0:d250:99ff:fe4b:7ab7/64 Scope:Global
          inet6 addr: fdf7:1a7c:a459:0:3560:99c8:bff9:148a/64 Scope:Global
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:116407 errors:0 dropped:0 overruns:0 frame:0
          TX packets:79660 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:146480442 (146.4 MB)  TX bytes:8814148 (8.8 MB)
          Interrupt:20 Memory:f7c00000-f7c20000 

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:3958 errors:0 dropped:0 overruns:0 frame:0
          TX packets:3958 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:406723 (406.7 KB)  TX bytes:406723 (406.7 KB)</code></pre></div><p>Also, this is from main menu -&gt; status -&gt; routes:<br /></p><div class="codebox"><pre><code>Active IPv4-Routes
Network     Target     IPv4-Gateway     Metric     Table
wan     0.0.0.0/0     80.106.108.74     0     1
wan     0.0.0.0/0     80.106.108.74     10     main
wan     80.106.108.74         0     main
lan     192.168.1.0/24         0     main</code></pre></div><p>It certainly does not look right.&nbsp; How come I do not see WAN2?&nbsp; </p><p>Does this help you?&nbsp; Please tell me what else you need.</p>											<p class="post-edited">(Last edited by <strong>bobptz</strong> on 12 Dec 2015, 02:53)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p303460">
				<div class="post-metadata">
					<div class="post-num">Post #1450</div>
					<div class="post-author">bobptz</div>
					<div class="post-datetime">
						12 Dec 2015, 23:34					</div>
				</div>
				<div class="post-content content">
					<p>I made a couple of changes in the Firewall settings suggested in a forum.&nbsp; WAN2 still shows Offline even though I have plugged the modem from WAN to WAN2 and I do have internet working, I can browse pages.</p><p>Maybe this diagnostic result helps?<br />Unable to perform diagnostic tests on wan2. There is no physical or virtual device associated with this interface</p><p>Why do I get this?</p>											<p class="post-edited">(Last edited by <strong>bobptz</strong> on 12 Dec 2015, 23:35)</p>
									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 58 of 65</div><nav><ul><li><a href="viewtopic.php%3Fid=39052&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=39052&amp;p=56.html">56</a></li><li><a href="viewtopic.php%3Fid=39052&amp;p=57.html">57</a></li><li class="pagination-current"><span>58</span></li><li><a href="viewtopic.php%3Fid=39052&amp;p=59.html">59</a></li><li><a href="viewtopic.php%3Fid=39052&amp;p=60.html">60</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=39052&amp;p=65.html">65</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0.001 -->

</body>
</html>