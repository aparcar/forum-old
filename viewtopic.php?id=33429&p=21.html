<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> TP-Link TL-MR3020 Support</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 16 Jun 2013 and 7 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 21 of 24</div><nav><ul><li><a href="viewtopic.php%3Fid=33429&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=33429&amp;p=19.html">19</a></li><li><a href="viewtopic.php%3Fid=33429&amp;p=20.html">20</a></li><li class="pagination-current"><span>21</span></li><li><a href="viewtopic.php%3Fid=33429&amp;p=22.html">22</a></li><li><a href="viewtopic.php%3Fid=33429&amp;p=23.html">23</a></li><li><a href="viewtopic.php%3Fid=33429&amp;p=24.html">24</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p248695">
				<div class="post-metadata">
					<div class="post-num">Post #501</div>
					<div class="post-author">john410</div>
					<div class="post-datetime">
						1 Oct 2014, 18:47					</div>
				</div>
				<div class="post-content content">
					<p>Ok, now things are interesting: it worked just fine on the older (v1.8) MR3020.</p><p>I have three MR3020s:</p><p>- 2 are v1.9, and were bought less than a month ago.<br />- 1 is v1.8, bought around March/2014.</p><p>I was trying to run it on a brand-new v1.9, and I got all kinds of USB errors. Modem worked randomly, and connection wasn&#039;t stable.</p><p>Decided to try the same OpenWrt version (BB 14.07) on both. v1.9 still gave errors, v1.8 presented no issues.</p><p>I&#039;ll try it on the other v1.9 as soon as possible. That may shed some light on the real culprit of the issue - a unit issue or a version issue. (well, unless I was lucky enough to get TWO bad v1.9&#039;s...)</p><p>Will report back ASAP</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p248703">
				<div class="post-metadata">
					<div class="post-num">Post #502</div>
					<div class="post-author">tmo26</div>
					<div class="post-datetime">
						1 Oct 2014, 19:31					</div>
				</div>
				<div class="post-content content">
					<p>There are signs that [some] TP-Link Routers have weak USB power:</p><p><a href="http://www.draisberghof.de/usb_modeswitch/bb/viewtopic.php?f=4&amp;t=1850">http://www.draisberghof.de/usb_modeswit … amp;t=1850</a><br /><a href="http://www.draisberghof.de/usb_modeswitch/bb/viewtopic.php?f=3&amp;t=1191">http://www.draisberghof.de/usb_modeswit … amp;t=1191</a><br /><a href="http://dd-wrt.com/phpBB2/viewtopic.php?p=754966">http://dd-wrt.com/phpBB2/viewtopic.php?p=754966</a><br /><a href="https://forum.openwrt.org/viewtopic.php?id=43441">https://forum.openwrt.org/viewtopic.php?id=43441</a></p><p>Search for &quot;weak&quot; in the above pages.</p><p>I think I saw a similar statement here in the openwrt forum, but can&#039;t find it any more.</p><p>Can you measure the USB voltage with and without load?</p>											<p class="post-edited">(Last edited by <strong>tmo26</strong> on 1 Oct 2014, 19:32)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p248727">
				<div class="post-metadata">
					<div class="post-num">Post #503</div>
					<div class="post-author">john410</div>
					<div class="post-datetime">
						2 Oct 2014, 00:30					</div>
				</div>
				<div class="post-content content">
					<p>Well, I thought I was fine with the older one, but after being off for a while, got the same errors when I turned it on again:</p><p>[&nbsp; &nbsp;36.860000] usb 1-1: device descriptor read/64, error -145<br />[&nbsp; &nbsp;37.090000] usb 1-1: new high-speed USB device number 3 using ehci-platform<br />[&nbsp; &nbsp;52.210000] usb 1-1: device descriptor read/64, error -145<br />[&nbsp; &nbsp;67.440000] usb 1-1: device descriptor read/64, error -145<br />[&nbsp; &nbsp;67.670000] usb 1-1: new high-speed USB device number 4 using ehci-platform<br />[&nbsp; &nbsp;78.090000] usb 1-1: device not accepting address 4, error -145<br />[&nbsp; &nbsp;78.210000] usb 1-1: new high-speed USB device number 5 using ehci-platform<br />[&nbsp; &nbsp;88.630000] usb 1-1: device not accepting address 5, error -145<br />[&nbsp; &nbsp;88.630000] hub 1-0:1.0: unable to enumerate USB device on port 1</p><p>Seems that, with OpenWRT, I&#039;ll have to supply extra power.<br />edit: weirdly enough, I got the same errors while supplying extra power too! It seems to be something else entirely. What baffles me is that it works with the original firmware without a hiccup.</p><p>tmo26, I have a USB power meter at home. Do you want me to measure the voltage that comes out of the PSU or USB port of the router?</p>											<p class="post-edited">(Last edited by <strong>john410</strong> on 2 Oct 2014, 01:50)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p248741">
				<div class="post-metadata">
					<div class="post-num">Post #504</div>
					<div class="post-author">tmo26</div>
					<div class="post-datetime">
						2 Oct 2014, 02:06					</div>
				</div>
				<div class="post-content content">
					<p>USB port of the router</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p250051">
				<div class="post-metadata">
					<div class="post-num">Post #505</div>
					<div class="post-author">john410</div>
					<div class="post-datetime">
						10 Oct 2014, 20:44					</div>
				</div>
				<div class="post-content content">
					<p>I still couldn&#039;t do the measurings, as I forgot my USB Power Meter in a friend&#039;s house. But I did some testing, and here&#039;s what I found out so far:</p><p>I can make it connect in LTE mode (blue light), but after a while it drops the connection and, after that, it:</p><p>1) only works in EDGE (green light)<br />2) connect, but doesn&#039;t ping a thing. Drops after a while.<br />3) repeat</p><p>To make it work again, I have to plug it in my PC. It opens the Huawei dialer and gets a EDGE signal. I have to go to options, change it from AUTO to LTE. Now it gets LTE signal again. Back to AUTO. Unplug from PC. Plug on the router.</p><p>Some extra info:</p><p>1) As I said before, I have two MR3020. One runs OpenWRT BB right now, the other runs stock. Modem run without a glitch on stock firmware (140610) for weeks on end.</p><p>2) If I try to plug it on the stock modem after getting the connection dropped and the whole EDGE issue on the OpenWRT router, it won&#039;t connect on the stock router also. I have to do the trick on my PC to make it work again.</p><p>3) After restoring the LTE thing on my PC, if I don&#039;t plug it anywhere else but the stock firmware router it works forever, just like it always did.</p><p>I&#039;ve installed ROOter MultiWeb (from <a href="http://www.ofmodemsandmen.com">http://www.ofmodemsandmen.com</a>) and it worked right out of the box. Two days straight with perfect connection. Even in low signal areas where the EDGE network is used, it switched back to LTE without needing the trick I described before.</p><p>Now I want to know what they did to vanilla OpenWRT to make this work, heh.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p250706">
				<div class="post-metadata">
					<div class="post-num">Post #506</div>
					<div class="post-author">0617</div>
					<div class="post-datetime">
						15 Oct 2014, 22:04					</div>
				</div>
				<div class="post-content content">
					<p>Hello. I need help.<br />It was fully functional 3020 v1 with mr3020nv1_en_3_17_2_up_boot(140408) firmaware.<br />I started flashing <a href="http://downloads.openwrt.org/attitude_adjustment/12.09/ar71xx/generic/openwrt-ar71xx-generic-tl-mr3020-v1-squashfs-factory.bin">openwrt-ar71xx-generic-tl-mr3020-v1-squashfs-factory.bin</a> via WebUI but something goes wrong. 3020 stopped responding. I expected two reboots but there was no one. After 20 minutes i powered off 3020 and than back on. It boots as usual - almost normally - but does not respond to telnet/ssh/http/ping. <br />If one looks at LEDs he could say that boot process looks absolutely normal. My wireless clients start seeing wi-fi network &quot;TP-LINK_POCKET_3020_xxxxxx&quot; with proper MAC digits, but when i try to coonect it ask key which i don&#039;t know (default is empty, but...). WPS button starts blinking when i press it, but still no connection.<br />Change &quot;3G/WISP/AP&quot; switch position causes reboot. <br />I tried to setup dhcp and feeds 3020 - no point. <br />I can&#039;t enter safemode because WPS button does not blinking while booting - it blinks only once.<br />I&#039;ve got no serial adapter right now, so is it possible to do something else to revive 3020?<br />Thank you in advance.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p250732">
				<div class="post-metadata">
					<div class="post-num">Post #507</div>
					<div class="post-author">metai</div>
					<div class="post-datetime">
						16 Oct 2014, 04:22					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>0617 wrote:</cite><blockquote><p>Change &quot;3G/WISP/AP&quot; switch position causes reboot.</p></blockquote></div><p>Which is a clear indication that your MR3020 is not running OpenWrt but is still on the manufacturer&#039;s firmware. I would recommend using the reset button and to start over.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p250801">
				<div class="post-metadata">
					<div class="post-num">Post #508</div>
					<div class="post-author">0617</div>
					<div class="post-datetime">
						16 Oct 2014, 17:19					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>metai wrote:</cite><blockquote><div class="quotebox"><cite>0617 wrote:</cite><blockquote><p>Change &quot;3G/WISP/AP&quot; switch position causes reboot.</p></blockquote></div><p>Which is a clear indication that your MR3020 is not running OpenWrt but is still on the manufacturer&#039;s firmware. I would recommend using the reset button and to start over.</p></blockquote></div><p>You are absolutely right! Thank you alot. Today i just powered it on - and it works!<br />...<br />And now it works on OpenWRT!</p>											<p class="post-edited">(Last edited by <strong>0617</strong> on 16 Oct 2014, 17:36)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p252768">
				<div class="post-metadata">
					<div class="post-num">Post #509</div>
					<div class="post-author">VecH</div>
					<div class="post-datetime">
						1 Nov 2014, 18:57					</div>
				</div>
				<div class="post-content content">
					<p>OpenWRT on the version v1.1 somebody checked it works?</p><p>version 12.09 and 14.07 Stable Stable<br />which of these versions work without problems on the version hardware v1.1?</p>											<p class="post-edited">(Last edited by <strong>VecH</strong> on 1 Nov 2014, 19:02)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p255354">
				<div class="post-metadata">
					<div class="post-num">Post #510</div>
					<div class="post-author">el_ric</div>
					<div class="post-datetime">
						24 Nov 2014, 04:54					</div>
				</div>
				<div class="post-content content">
					<p>Hi:</p><p>I just installed 12.09-RC1 as suggested in 3020 openwrt support page in my MR3020 v1.7 and is working good.<br />I want now to extroot, but in this same topic, there are posts that indicates that it is possible and there are posts that indicates that because it is a stable release that includes luci, there is not free space left to do an exroot.</p><p>¿Can anyone confirm me that it is possible to extroot? I asume I have to install&nbsp; block-mount kmod-usb-storage kmod-fs-ext4, and format in other computer an USB with an ext3/4 partition and an swap partition</p><p>In 12.09-RC1 ¿does the sliding switch have any function?</p><p>bye, and thank you</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p255372">
				<div class="post-metadata">
					<div class="post-num">Post #511</div>
					<div class="post-author">metai</div>
					<div class="post-datetime">
						24 Nov 2014, 10:27					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>el_ric wrote:</cite><blockquote><p>I just installed 12.09-RC1 as suggested in 3020 openwrt support page</p></blockquote></div><p>A common misunderstanding: The wiki page does not list the <em>recommended</em> but the <em>earliest</em> version that will work. You should definitely go with a stable release, not with an RC or with a trunk build.</p><div class="quotebox"><blockquote><p>I want now to extroot, but in this same topic, there are posts that indicates that it is possible and there are posts that indicates that because it is a stable release that includes luci, there is not free space left to do an exroot.</p></blockquote></div><p>I haven&#039;t tried it myself but yes, it is possible that, ironically, the extroot packages might actually not fit anymore. A complete 14.07 image including LuCI leaves the MR3020 with something like 400 kB of free space. The extroot packages aren&#039;t that big, but the ext3/ext4 kernel module takes a huge toll (it&#039;s about 213 kB).</p><p>However, there&#039;s no harm in trying. There&#039;s nothing that breaks if the packages don&#039;t fit, worst case you&#039;d have to restart configuration.</p><div class="quotebox"><blockquote><p>In 12.09-RC1 ¿does the sliding switch have any function?</p></blockquote></div><p>Not by default, no.</p>											<p class="post-edited">(Last edited by <strong>metai</strong> on 24 Nov 2014, 10:28)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p255474">
				<div class="post-metadata">
					<div class="post-num">Post #512</div>
					<div class="post-author">el_ric</div>
					<div class="post-datetime">
						25 Nov 2014, 04:16					</div>
				</div>
				<div class="post-content content">
					<p>Hi:</p><p>First, I have to say that I was confused. I downloaded openwrt from the link &quot;Download the latest Attitude Adjustment from here (recommended)&quot;, so I ended with &quot;ATTITUDE ADJUSTMENT (12.09, r36088)&quot;, which I think is the stable release.</p><p>With this, I got </p><p>from df</p><p>&nbsp; &nbsp; &nbsp; used&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Ava<br />&nbsp; &nbsp; &nbsp; 212&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 876</p><p>and 13084 K free of ram.</p><p>to extroot I had to install kmod-usb-storage (it took 92 K), kmod-fs-ext4 (it took 196 K), and block-mount (it took 136 K).</p><p>So it is needed 424 K to extroot. I ended with 452 K free of Flash. I also ended with 11096 K free of ram.</p><br /><p>But now, with the extroot (200 M of swap and 3,8 G of rootsf), I have almost 3,3 G to install programs :-)</p><p>As far as I know, my 3020 is working good.</p><p>(But I maked an mistake, I should have created 200 M of swap, 1 G of extroot and 2 G of /home). I wil fix it tomorrow.</p><br /><br /><br /><p>Bye, and thank you for the help</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p255489">
				<div class="post-metadata">
					<div class="post-num">Post #513</div>
					<div class="post-author">mokaz</div>
					<div class="post-datetime">
						25 Nov 2014, 12:02					</div>
				</div>
				<div class="post-content content">
					<p>TL-MR3020 / extroot on 3g modem Huawei E173 mSD card slot NOT WORKING PLEASE HELP</p><p>Hi all,</p><p>I&#039;m facing difficulties at being able to mount my micro SD card embedded in my HUAWEI E173 3G dongle.</p><p>I&#039;m not sure what&#039;s missing and i hope its not kmod-fs-ext4 because this is a rather huge package...<br />I&#039;ve build my image with Image Builder but could not afford kmod-fs-ext4 due to router internal storage contrains..</p><div class="codebox"><pre><code>=~=~=~=~=~=~=~=~=~=~=~= PuTTY log 2014.11.24 09:54:06 =~=~=~=~=~=~=~=~=~=~=~=

BusyBox v1.22.1 (2014-09-20 22:01:35 CEST) built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 -----------------------------------------------------
 BARRIER BREAKER (14.07, r42625)
 -----------------------------------------------------
  * 1/2 oz Galliano         Pour all ingredients into
  * 4 oz cold Coffee        an irish coffee mug filled
  * 1 1/2 oz Dark Rum       with crushed ice. Stir.
  * 2 tsp. Creme de Cacao
 -----------------------------------------------------
root@OpenWrt:~# 
root@OpenWrt:~# 
root@OpenWrt:~# 
root@OpenWrt:~# 
root@OpenWrt:~# block info
/dev/mtdblock2: UUID=&quot;5f8a6de9-857e23d0-223a368f-e4c61888&quot; VERSION=&quot;4.0&quot; TYPE=&quot;squashfs&quot;
/dev/mtdblock3: TYPE=&quot;jffs2&quot;
/dev/sda1: UUID=&quot;e7de8034-7061-4f39-9384-318469f79286&quot; LABEL=&quot;1.42.6-4493&quot; NAME=&quot;EXT_JOURNAL&quot; VERSION=&quot;1.0&quot; TYPE=&quot;ext4&quot;
root@OpenWrt:~# 
root@OpenWrt:~# 
root@OpenWrt:~# 
root@OpenWrt:~# 
root@OpenWrt:~# dmesg | grep -E &quot;scsi|usb|sd&quot;
[    4.100000] usbcore: registered new interface driver usbfs
[    4.110000] usbcore: registered new interface driver hub
[    4.110000] usbcore: registered new device driver usb
[    4.200000] usbcore: registered new interface driver usb-storage
[    4.640000] usb 1-1: new high-speed USB device number 2 using ehci-platform
[    4.840000] usb-storage 1-1:1.0: USB Mass Storage device detected
[    4.840000] scsi0 : usb-storage 1-1:1.0
[    4.860000] usb-storage 1-1:1.1: USB Mass Storage device detected
[    4.860000] scsi1 : usb-storage 1-1:1.1
[    5.860000] scsi 0:0:0:0: CD-ROM            HUAWEI   Mass Storage     2.31 PQ: 0 ANSI: 2
[    5.880000] scsi 1:0:0:0: Direct-Access     HUAWEI   SD Storage       2.31 PQ: 0 ANSI: 2
[    5.890000] sd 1:0:0:0: [sda] Attached SCSI removable disk
[   11.830000] usbcore: registered new interface driver usbserial
[   11.830000] usbcore: registered new interface driver usbserial_generic
[   11.850000] usbserial: USB Serial support registered for generic
[   12.200000] usbcore: registered new interface driver option
[   12.220000] usbserial: USB Serial support registered for GSM modem (1-port)
[   17.580000] usb 1-1: USB disconnect, device number 2
[   21.940000] usb 1-1: new high-speed USB device number 3 using ehci-platform
[   22.110000] usb-storage 1-1:1.0: USB Mass Storage device detected
[   22.120000] usb 1-1: GSM modem (1-port) converter now attached to ttyUSB0
[   22.150000] usb-storage 1-1:1.1: USB Mass Storage device detected
[   22.150000] usb-storage 1-1:1.2: USB Mass Storage device detected
[   22.180000] usb-storage 1-1:1.3: USB Mass Storage device detected
[   22.210000] usb 1-1: GSM modem (1-port) converter now attached to ttyUSB1
[   22.210000] usb-storage 1-1:1.4: USB Mass Storage device detected
[   22.240000] usb 1-1: GSM modem (1-port) converter now attached to ttyUSB2
[   22.270000] usb-storage 1-1:1.5: USB Mass Storage device detected
[   22.280000] scsi7 : usb-storage 1-1:1.5
[   22.300000] usb-storage 1-1:1.6: USB Mass Storage device detected
[   22.310000] scsi8 : usb-storage 1-1:1.6
[   23.280000] scsi 7:0:0:0: CD-ROM            HUAWEI   Mass Storage     2.31 PQ: 0 ANSI: 2
[   23.310000] scsi 8:0:0:0: Direct-Access     HUAWEI   SD Storage       2.31 PQ: 0 ANSI: 2
[   23.370000] sd 8:0:0:0: [sda] Attached SCSI removable disk
[ 1319.570000] sd 8:0:0:0: [sda] 3842048 512-byte logical blocks: (1.96 GB/1.83 GiB)
[ 1319.570000] sd 8:0:0:0: [sda] Write cache: enabled, read cache: enabled, doesn&#039;t support DPO or FUA
[ 1319.590000]  sda: sda1
root@OpenWrt:~# 
root@OpenWrt:~# 
root@OpenWrt:~# 
root@OpenWrt:~# mount -t ext4 /dev/sda1 /mnt/sda1
mount: mounting /dev/sda1 on /mnt/sda1 failed: No such device
root@OpenWrt:~# mount -t ext4 /dev/sda1 /mnt/sda1
mount: mounting /dev/sda1 on /mnt/sda1 failed: Invalid argument
root@OpenWrt:~# 
root@OpenWrt:~# 
root@OpenWrt:~# block mount
block: /dev/mtdblock3 is already mounted
block: mounting /dev/sda1 (ext4) as /mnt/sda1 failed (-1) - Unknown error -1
root@OpenWrt:~# logread -l 2
Mon Nov 24 08:55:58 2014 user.err syslog: /dev/mtdblock3 is already mounted
Mon Nov 24 08:55:58 2014 user.err syslog: mounting /dev/sda1 (ext4) as /mnt/sda1 failed (-1) - Unknown error -1
root@OpenWrt:~# 
root@OpenWrt:~# 
root@OpenWrt:~# fdisk -l

Disk /dev/mtdblock0: 128 KiB, 131072 bytes, 256 sectors
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes

Disk /dev/mtdblock1: 1.1 MiB, 1107456 bytes, 2163 sectors
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes

Disk /dev/mtdblock2: 2.8 MiB, 2889728 bytes, 5644 sectors
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes

Disk /dev/mtdblock3: 320 KiB, 327680 bytes, 640 sectors
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes

Disk /dev/mtdblock4: 64 KiB, 65536 bytes, 128 sectors
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes

Disk /dev/mtdblock5: 3.8 MiB, 3997696 bytes, 7808 sectors
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes

Disk /dev/sda: 1.9 GiB, 1967128576 bytes, 3842048 sectors
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: dos
Disk identifier: 0x000640d9

Device    Boot Start       End  Blocks  Id System
/dev/sda1        256   3839534 1919639+ 83 Linux

root@OpenWrt:~# 
root@OpenWrt:~# 
root@OpenWrt:~# opkg list-installed
base-files - 156-r42625
block-mount - 2014-06-22-e0430f5c62f367e5a8e02755412977b02c3fc45e
busybox - 1.22.1-2
chat - 2.4.7-2
comgt - 0.32-23
dnsmasq - 2.71-4
dropbear - 2014.63-2
fdisk - 2.24.1-1
firewall - 2014-09-19
fstools - 2014-06-22-e0430f5c62f367e5a8e02755412977b02c3fc45e
hostapd-common - 2014-06-03.1-1
iptables - 1.4.21-1
iw - 3.15-1
jshn - 2014-08-04-dffbc09baf71b294185a36048166d00066d433b5
jsonfilter - 2014-06-19-cdc760c58077f44fc40adbbe41e1556a67c1b9a9
kernel - 3.10.49-1-0114c71ed85677c9c1e4911437af4743
kmod-ath - 3.10.49+2014-05-22-1
kmod-ath9k - 3.10.49+2014-05-22-1
kmod-ath9k-common - 3.10.49+2014-05-22-1
kmod-cfg80211 - 3.10.49+2014-05-22-1
kmod-crypto-aes - 3.10.49-1
kmod-crypto-arc4 - 3.10.49-1
kmod-crypto-core - 3.10.49-1
kmod-crypto-hash - 3.10.49-1
kmod-gpio-button-hotplug - 3.10.49-1
kmod-ipt-conntrack - 3.10.49-1
kmod-ipt-core - 3.10.49-1
kmod-ipt-nat - 3.10.49-1
kmod-ipt-nathelper - 3.10.49-1
kmod-ipv6 - 3.10.49-1
kmod-ledtrig-usbdev - 3.10.49-1
kmod-lib-crc-ccitt - 3.10.49-1
kmod-lib-crc16 - 3.10.49-1
kmod-mac80211 - 3.10.49+2014-05-22-1
kmod-nls-base - 3.10.49-1
kmod-ppp - 3.10.49-1
kmod-pppoe - 3.10.49-1
kmod-pppox - 3.10.49-1
kmod-scsi-core - 3.10.49-1
kmod-slhc - 3.10.49-1
kmod-usb-core - 3.10.49-1
kmod-usb-serial - 3.10.49-1
kmod-usb-serial-option - 3.10.49-1
kmod-usb-serial-wwan - 3.10.49-1
kmod-usb-storage - 3.10.49-1
kmod-usb2 - 3.10.49-1
libblkid - 2.24.1-1
libblobmsg-json - 2014-08-04-dffbc09baf71b294185a36048166d00066d433b5
libc - 0.9.33.2-1
libgcc - 4.8-linaro-1
libip4tc - 1.4.21-1
libip6tc - 1.4.21-1
libiwinfo - 51
libiwinfo-lua - 51
libjson-c - 0.11-2
libjson-script - 2014-08-04-dffbc09baf71b294185a36048166d00066d433b5
liblua - 5.1.5-1
libnl-tiny - 0.1-3
libpthread - 0.9.33.2-1
librt - 0.9.33.2-1
libubox - 2014-08-04-dffbc09baf71b294185a36048166d00066d433b5
libubus - 2014-09-17-4c4f35cf2230d70b9ddd87638ca911e8a563f2f3
libubus-lua - 2014-09-17-4c4f35cf2230d70b9ddd87638ca911e8a563f2f3
libuci - 2014-04-11.1-1
libuci-lua - 2014-04-11.1-1
libusb-1.0 - 1.0.9-1
libuuid - 2.24.1-1
libxtables - 1.4.21-1
lua - 5.1.5-1
luci - 0.12+svn-r10530-1
luci-app-firewall - 0.12+svn-r10530-1
luci-base - 0.12+svn-r10530-1
luci-lib-nixio - 0.12+svn-r10530-1
luci-mod-admin-full - 0.12+svn-r10530-1
luci-proto-3g - 0.12+svn-r10530-1
luci-proto-ppp - 0.12+svn-r10530-1
luci-theme-bootstrap - 0.12+svn-r10530-1
mtd - 20
netifd - 2014-09-08-46c569989f984226916fec28dd8ef152a664043e
odhcp6c - 2014-08-25-0300fe7589a1701361735ac068e4b57bb1a1896f
odhcpd - 2014-08-23-24452e1e3e9adfd9d8e183db1aa589f77727f5a7
opkg - 9c97d5ecd795709c8584e972bfdf3aee3a5b846d-7
ppp - 2.4.7-2
ppp-mod-pppoe - 2.4.7-2
procd - 2014-09-15-c1a558f7d0c1e6c1ffa5a47d557a7b45205eef1d
swconfig - 10
uboot-envtools - 2014.04-4
ubox - 2014-09-16-5c45b560bc8c9e13682269ed963a8a4a65959518
ubus - 2014-09-17-4c4f35cf2230d70b9ddd87638ca911e8a563f2f3
ubusd - 2014-09-17-4c4f35cf2230d70b9ddd87638ca911e8a563f2f3
uci - 2014-04-11.1-1
uhttpd - 2014-08-25-dabd7dea6445aaa0e5b8d9add1872fa7393b3a85
uhttpd-mod-ubus - 2014-08-25-dabd7dea6445aaa0e5b8d9add1872fa7393b3a85
usb-modeswitch - 2014-07-18-01ecc3b9764d1dd89cf36ede0a2d98f9adb0cd33
wpad-mini - 2014-06-03.1-1
root@OpenWrt:~# 
root@OpenWrt:~# 
root@OpenWrt:~# mount
rootfs on / type rootfs (rw)
/dev/root on /rom type squashfs (ro,relatime)
proc on /proc type proc (rw,noatime)
sysfs on /sys type sysfs (rw,noatime)
tmpfs on /tmp type tmpfs (rw,nosuid,nodev,noatime)
/dev/mtdblock3 on /overlay type jffs2 (rw,noatime)
overlayfs:/overlay on / type overlayfs (rw,noatime,lowerdir=/,upperdir=/overlay)
tmpfs on /dev type tmpfs (rw,relatime,size=512k,mode=755)
devpts on /dev/pts type devpts (rw,relatime,mode=600)
debugfs on /sys/kernel/debug type debugfs (rw,noatime)
root@OpenWrt:~# 
root@OpenWrt:~# 
root@OpenWrt:~# 
root@OpenWrt:~# 
root@OpenWrt:~# </code></pre></div><p>Thanks for your help,<br />regards,<br />m.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p255895">
				<div class="post-metadata">
					<div class="post-num">Post #514</div>
					<div class="post-author">el_ric</div>
					<div class="post-datetime">
						29 Nov 2014, 03:07					</div>
				</div>
				<div class="post-content content">
					<p>Well, I am new at OpenWrt, so I am not very shure, but I think you need some of the kmod-fs packages, depending on the type of filesesystem you are trying to mount.</p><p>But since you are building your own image, may be you could do it without luci to free flash memory (I see in your &quot;list-installed&quot; that it is there), and then install luci in the extroot. </p><p>bye, ricardo</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p258267">
				<div class="post-metadata">
					<div class="post-num">Post #515</div>
					<div class="post-author">el_ric</div>
					<div class="post-datetime">
						20 Dec 2014, 20:17					</div>
				</div>
				<div class="post-content content">
					<p>Need help with non AP network configuration</p><p>Hi:</p><p>I am trying to configure my 3020 as a client only. I do not want to use it to provide internet to other machines. <br />There are some instructions in the web, but that refers to machines with both wan and lan ethernet ports, and as you know, in 3020 there are only a ethernet port. Situation is similar like in unifi ubiquity, and I have read the instructions for that device, but it was no help form me.</p><p>I would like my machine to get internet from the wifi interface, and to be able to access other machines in the same wifi net, and be accesed from the other machines.<br />I would like also to be able to adminsitrate my 3020 both from the wifi interface, or connecting a machine to the ethernet port.<br />I should be able to adminsitrate my 3020 (from the eth port), both when wifi connection is stablished and when it is not. I should be able to conect by ssh to my 3020 from the eth port, and then ssh from the 3020 to other machines in the wifi net.<br />the machine I connect through the eth port should get dhcp from the wifi connection. In any case the 3020 should provide dhcp.</p><br /><p>This is my configuration:</p><p>/etc/config/network</p><p>config interface &#039;loopback&#039;<br />&nbsp; &nbsp; option ifname &#039;lo&#039;<br />&nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; option ipaddr &#039;127.0.0.1&#039;<br />&nbsp; &nbsp; option netmask &#039;255.0.0.0&#039;</p><p>config interface &#039;lan&#039;<br />&nbsp; &nbsp; option ifname &#039;eth0 wwan&#039;<br />&nbsp; &nbsp; option tnype &#039;bridge&#039;<br />&nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;<br />&nbsp; &nbsp; option ipaddr &#039;192.168.1.10&#039;</p><p>config interface &#039;wwan&#039;<br />&nbsp; &nbsp; option proto &#039;dhcp&#039;<br />&nbsp; &nbsp; option hostname &#039;OpenWrt&#039;<br />&nbsp; &nbsp; option peerdns &#039;0&#039;<br />&nbsp; &nbsp; option dns &#039;8.8.8.8 8.8.4.4&#039;</p><br /><br /><p>/etc/config/wireless</p><p>config wifi-device &#039;radio0&#039;<br />&nbsp; &nbsp; option type &#039;mac80211&#039;<br />&nbsp; &nbsp; option macaddr &#039;XX:f3:c1:55:XX:XX&#039;<br />&nbsp; &nbsp; option hwmode &#039;11ng&#039;<br />&nbsp; &nbsp; option htmode &#039;HT20&#039;<br />&nbsp; &nbsp; list ht_capab &#039;SHORT-GI-20&#039;<br />&nbsp; &nbsp; list ht_capab &#039;SHORT-GI-40&#039;<br />&nbsp; &nbsp; list ht_capab &#039;RX-STBC1&#039;<br />&nbsp; &nbsp; list ht_capab &#039;DSSS_CCK-40&#039;<br />&nbsp; &nbsp; option disabled &#039;0&#039;<br />&nbsp; &nbsp; option channel &#039;8&#039;<br />&nbsp; &nbsp; option txpower &#039;20&#039;<br />&nbsp; &nbsp; option country &#039;US&#039;</p><p>config wifi-iface<br />&nbsp; &nbsp; option network &#039;wwan&#039;<br />&nbsp; &nbsp; option ssid &#039;XXXXXX&#039;<br />&nbsp; &nbsp; option encryption &#039;psk&#039;<br />&nbsp; &nbsp; option device &#039;radio0&#039;<br />&nbsp; &nbsp; option mode &#039;sta&#039;<br />&nbsp; &nbsp; option bssid &#039;XX:23:F8:D9:XX:XX&#039;<br />&nbsp; &nbsp; option key &#039;XxXxXxXxXxX&#039;</p><p>Firewall is disabled. With this configuration, I can get internet from the wifi connection, and I can administer my 3020 from other machines in the wifi net. So this is ok. But eth0 has dissapeared, and then i can not connect a machine to my 3020 with eth0.</p><p>My eth port dissapears when I bridge eth0 and wwan. </p><p>lo&nbsp; &nbsp; &nbsp; &nbsp; Link encap:Local Loopback&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:127.0.0.1&nbsp; Mask:255.0.0.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP LOOPBACK RUNNING&nbsp; MTU:16436&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:176 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:176 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0 <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:12816 (12.5 KiB)&nbsp; TX bytes:12816 (12.5 KiB)</p><p>wlan0&nbsp; &nbsp; &nbsp;Link encap:Ethernet&nbsp; HWaddr XX:F3:C1:55:XX:XX&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:192.168.1.36&nbsp; Bcast:192.168.1.255&nbsp; Mask:255.255.255.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:1232 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:1642 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:32 <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:138644 (135.3 KiB)&nbsp; TX bytes:214151 (209.1 KiB)</p><br /><br /><br /><p>¿can anyone explain me what am I doing wrong? ¿why my eth port gets deactivated?.</p><p>bye, ricardo</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p258292">
				<div class="post-metadata">
					<div class="post-num">Post #516</div>
					<div class="post-author">tmo26</div>
					<div class="post-datetime">
						21 Dec 2014, 02:18					</div>
				</div>
				<div class="post-content content">
					<p>Working /etc/config/network for a DIR-505 in client mode (which uses eth1 i/o eth0 as other routers):</p><div class="codebox"><pre><code>config interface &#039;loopback&#039;
        option ifname &#039;lo&#039;
        option proto &#039;static&#039;
        option ipaddr &#039;127.0.0.1&#039;
        option netmask &#039;255.0.0.0&#039;

config interface &#039;lan&#039;
        option ifname &#039;eth1&#039;
        option type &#039;bridge&#039;
        option proto &#039;static&#039;
        option ipaddr &#039;192.168.1.33&#039;
        option netmask &#039;255.255.255.0&#039;

config interface &#039;wwan&#039;
        option proto &#039;dhcp&#039;</code></pre></div><p>Note that in the above example DHCP via wwan gives an IP in the range 192.168.178.xx, while LAN is 192.168.1.xx, which means: They LAN and WWAN have to be in different subnets.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p258339">
				<div class="post-metadata">
					<div class="post-num">Post #517</div>
					<div class="post-author">Wingman2k</div>
					<div class="post-datetime">
						21 Dec 2014, 19:30					</div>
				</div>
				<div class="post-content content">
					<p>Question regarding the switch configuration.<br />Got some trouble with the switch configuration (behaviour of UCI), I used the scripts from jefferyto (00-button) on github. They worked perfectly with AA but on BB the created Symlinks get overwritten when saving the configuration via LUCI and UCI.<br />Is there a simple way to bring back the old behaviour or do the Script needs to be modified to work again.<br />Somehow this looks a bit like a bug to me or is this by purpose.</p><p>The beauty of that Script was the Symlink to /tmp which pointed back to /etc/config/x depending of the position and the changes where saved there. Mounting or overlaying only two files does not work. A workaround is copying them back when they get changed via cron and diff but there should be an better option, I hope.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p258656">
				<div class="post-metadata">
					<div class="post-num">Post #518</div>
					<div class="post-author">mrdarkdragone</div>
					<div class="post-datetime">
						25 Dec 2014, 07:36					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>dddesign wrote:</cite><blockquote><div class="quotebox"><cite>novikorisnik wrote:</cite><blockquote><p>actually I have idea to start/stop playing the radio stream with one long push, and with one short push to change stations from playlist...and maybe with double click to go back trough playlist <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p></blockquote></div><p>buttons activate:<br /># opkg update<br /># opkg install kmod-button-hotplug<br /># mkdir /etc/hotplug.d/button</p><p>for WPS button:<br />add script in this directory:<br />/etc/hotplug.d/button/01-wps-button:<br /></p><div class="codebox"><pre><code>#!/bin/sh

#logger $BUTTON
#logger $ACTION
#logger $SEEN

if [ $BUTTON = &#039;wps&#039; ]
then
    if [ $ACTION = &#039;pressed&#039; ]; then
        # this is a solution to trigger long pushing:
        date +%s &gt; /tmp/pressed
        /usr/bin/button_pressed &amp;
    fi
    if [ $ACTION = &#039;released&#039; ]; then
        0 &gt; /tmp/pressed
        if [ $SEEN = 0 ]; then
            #here action for short push (eg next song in mpd):
            logger WPS: NEXT
            mpc next
        fi
    fi
fi</code></pre></div><p>and in /usr/bin/ this script:<br />/usr/bin/button_pressed:<br /></p><div class="codebox"><pre><code>#!/bin/sh
pressed=`cat /tmp/pressed`
action_2=&quot;do&quot; # after 2 sec, &quot;do&quot; it or not &quot;&quot;
action_4=&quot;do&quot; # after 4 sec, &quot;do&quot; it or not &quot;&quot;
while [ &quot;`cat /tmp/pressed`&quot; -gt 0 ]; do
    now=`date +%s`
    if [ $now = $((pressed+2)) ] &amp;&amp; [ $action_2 = &quot;do&quot; ]; then
        action_2=&quot;done&quot;
        #action here (eg play/pause mpd):
        #use it carefully: this actions execute after 2s pressed button, there is no release necessary.
        if [ &quot;$(mpc | grep play)&quot; = &quot;&quot; ]; then
            logger WPS: play
            mpc play
        else
            logger WPS: pause
            mpc pause
        fi
    fi
    if [ $now = $((pressed+4)) ] &amp;&amp; [ $action_4 = &quot;do&quot; ]; then
        action_4=&quot;done&quot;
        #action here (eg play/pause replay)
        #if the button is still pressed, after the actions before (2sec), following actions execute in addtion
        #use it carefully, these actions are execute after 4s pressed button, no release necessary
        logger WPS: replay
        mpc pause
        mpc play
    fi
done
rm /tmp/pressed</code></pre></div><br /><p>for SLIDER add this script in /etc/hotplug.d<br />/etc/hotplug.d/button/02-slider:<br /></p><div class="codebox"><pre><code>#!/bin/sh
sleep 1
#logger &quot;log: $BUTTON -- $ACTION&quot;

if [ $ACTION == &quot;released&quot; ] ; then
    if [ $BUTTON == &quot;BTN_1&quot; ] ; then  
        logger &quot;Slider 3G&quot;
        #some actions here
        
    elif [ $BUTTON == &quot;BTN_0&quot; ] &amp;&amp; grep -qe &quot;sw1.*in  lo&quot; /sys/kernel/debug/gpio; then
        logger &quot;Slider WISP&quot;
        #some action here

    fi
elif [ $BUTTON == &quot;BTN_0&quot; ] || [ $BUTTON == &quot;BTN_0&quot; ] ; then
    if grep -qe &quot;sw1.*in  hi&quot; /sys/kernel/debug/gpio ; then
        if grep -qe &quot;sw2.*in  hi&quot; /sys/kernel/debug/gpio ; then
            logger &quot;Slider AP&quot;
            #some action here

        fi
    fi
fi</code></pre></div><p>if you want to execute SLIDER scripts while/after booting add this script:<br />/etc/init.d/button_slider<br /></p><div class="codebox"><pre><code>#!/bin/sh /etc/rc.common

START=19
boot() {
    if grep -qe &quot;sw2.*in  hi&quot; /sys/kernel/debug/gpio ; then
        if grep -qe &quot;sw1.*in  hi&quot; /sys/kernel/debug/gpio ; then
            # AP
            logger AP
            #action here:

        else
            # WISP
            logger WISP
            #action here:

        fi
    else
        # 3G
        logger 3G
        #action here:

    fi
}</code></pre></div><p>and enable it:<br /># /etc/init.d/button_slider enable</p><p>don&#039;t forget to make all script executable.</p><p>if you find a solution for double-press, let me know.<br />j</p></blockquote></div><p>Could this be used to enable/disable a second wifi network. I have one where there are two networks on the same radio0 device, one is a client and the other is an AP. My problem with it is if my client wireless is out of range of its AP the second network will not show up either unless I disable the client manually. To do that I have to connect an ethernet which is inconvenient when I only have my phone. I&#039;ve seen this done to disable wifi by device but not just by network...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p258680">
				<div class="post-metadata">
					<div class="post-num">Post #519</div>
					<div class="post-author">metai</div>
					<div class="post-datetime">
						25 Dec 2014, 18:20					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>mrdarkdragone wrote:</cite><blockquote><p>Could this be used to enable/disable a second wifi network. (...) I&#039;ve seen this done to disable wifi by device but not just by network...</p></blockquote></div><p>Yes, most if not all of the wifi enable/disable scripts disable a device, but they can just as easily be modified to enable/disable an interface. Substitute<br /></p><div class="codebox"><pre><code>wireless.device.disable</code></pre></div><p>with<br /></p><div class="codebox"><pre><code>wireless.@wifi-iface[x].disable</code></pre></div><p>where x is the number of the interface you want to disable (interfaces have no identifier, so they must be adressed by their number). For example<br /></p><div class="codebox"><pre><code>uci set wireless.@wifi-iface[1].disabled=1</code></pre></div><p>disables the <em>second</em> wifi-iface.</p>											<p class="post-edited">(Last edited by <strong>metai</strong> on 25 Dec 2014, 18:21)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p258701">
				<div class="post-metadata">
					<div class="post-num">Post #520</div>
					<div class="post-author">mrdarkdragone</div>
					<div class="post-datetime">
						26 Dec 2014, 00:28					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>metai wrote:</cite><blockquote><div class="quotebox"><cite>mrdarkdragone wrote:</cite><blockquote><p>Could this be used to enable/disable a second wifi network. (...) I&#039;ve seen this done to disable wifi by device but not just by network...</p></blockquote></div><p>Yes, most if not all of the wifi enable/disable scripts disable a device, but they can just as easily be modified to enable/disable an interface. Substitute<br /></p><div class="codebox"><pre><code>wireless.device.disable</code></pre></div><p>with<br /></p><div class="codebox"><pre><code>wireless.@wifi-iface[x].disable</code></pre></div><p>where x is the number of the interface you want to disable (interfaces have no identifier, so they must be adressed by their number). For example<br /></p><div class="codebox"><pre><code>uci set wireless.@wifi-iface[1].disabled=1</code></pre></div><p>disables the <em>second</em> wifi-iface.</p></blockquote></div><p>ah ok, thanks, I had found the uci commands to do so but it seems the script doesn&#039;t run or something, i can see in the logread the buttons work but I dont see the code and the interface still remains enabled. I even put it the uci commit wireless in as well.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p260555">
				<div class="post-metadata">
					<div class="post-num">Post #521</div>
					<div class="post-author">ScreamingPict</div>
					<div class="post-datetime">
						8 Jan 2015, 14:28					</div>
				</div>
				<div class="post-content content">
					<p>Quick n00b question- I searched this thread but could not see any mention of the question;</p><p>I presume it&#039;s not possible to set up the TP-Link TL-MR3020 as a USB client (so that it can serve as a USB Eth/Wi-fi adaptor for a laptop) instead of host? </p><p>I&#039;m saying this because I believe that the Mini USB port is for power only and the type-A USB socket is, of course, a USB host, not client. Reverse tethering works for smartphones, but that&#039;s still serving as a USB host to the smartphone.</p><p>Does anybody know?</p><p>Thanks in advance.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p260561">
				<div class="post-metadata">
					<div class="post-num">Post #522</div>
					<div class="post-author">yoyellow</div>
					<div class="post-datetime">
						8 Jan 2015, 14:58					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>ScreamingPict wrote:</cite><blockquote><p>Quick n00b question- I searched this thread but could not see any mention of the question;</p><p>I presume it&#039;s not possible to set up the TP-Link TL-MR3020 as a USB client (so that it can serve as a USB Eth/Wi-fi adaptor for a laptop) instead of host? </p><p>I&#039;m saying this because I believe that the Mini USB port is for power only and the type-A USB socket is, of course, a USB host, not client. Reverse tethering works for smartphones, but that&#039;s still serving as a USB host to the smartphone.</p><p>Does anybody know?</p><p>Thanks in advance.</p></blockquote></div><br /><p>You are correct the mini usb is power only and is not wired in any way to be able to act as a usable data usb port.</p><p>maybe something like this will work: if there are working drivers... : <a href="http://www.ebay.com/bhp/usb-to-usb-transfer-cable">http://www.ebay.com/bhp/usb-to-usb-transfer-cable</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p260639">
				<div class="post-metadata">
					<div class="post-num">Post #523</div>
					<div class="post-author">david.white</div>
					<div class="post-datetime">
						9 Jan 2015, 02:46					</div>
				</div>
				<div class="post-content content">
					<p>I am trying to add an USB WIFI device to the TL-MR3020 without success. lsusb show the device as :<br />Bus 001 Device 002: ID 7392:7811 Edimax Technology Co., Ltd EW-7811Un 802.11n Wireless Adapter [Realtek RTL8188CUS]<br />but it does not show up with ifconfig, and I do not know how to add it or enable it so that I can configure the interface.</p><p>I want to use the USB WIFI to connect to the internet when ethernet is not available.</p><p>Model&nbsp; &nbsp; TP-Link TL-MR3020 v1<br />Firmware Version&nbsp; &nbsp; OpenWrt Barrier Breaker 14.07 / LuCI Trunk (0.12+svn-r10530)<br />Kernel Version&nbsp; &nbsp; 3.10.49</p><p>Any help would be most appreciated.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p260687">
				<div class="post-metadata">
					<div class="post-num">Post #524</div>
					<div class="post-author">ScreamingPict</div>
					<div class="post-datetime">
						9 Jan 2015, 12:41					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>yoyellow wrote:</cite><blockquote><p>You are correct the mini usb is power only and is not wired in any way to be able to act as a usable data usb port.</p><p>maybe something like this will work: if there are working drivers... : <a href="http://www.ebay.com/bhp/usb-to-usb-transfer-cable">http://www.ebay.com/bhp/usb-to-usb-transfer-cable</a></p></blockquote></div><p>Yoyellow- thanks. That confirms my thoughts. Guess I should go back to using my Asus WL-330NUL, or rather I would if the USB was still working on that!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p261573">
				<div class="post-metadata">
					<div class="post-num">Post #525</div>
					<div class="post-author">omiez</div>
					<div class="post-datetime">
						15 Jan 2015, 17:22					</div>
				</div>
				<div class="post-content content">
					<p>I am about to flash mr3020. </p><p>In which position must the switch be to flash Openwrt, 3G/4G,WISP or AP?</p><p>Tnx</p>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 21 of 24</div><nav><ul><li><a href="viewtopic.php%3Fid=33429&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=33429&amp;p=19.html">19</a></li><li><a href="viewtopic.php%3Fid=33429&amp;p=20.html">20</a></li><li class="pagination-current"><span>21</span></li><li><a href="viewtopic.php%3Fid=33429&amp;p=22.html">22</a></li><li><a href="viewtopic.php%3Fid=33429&amp;p=23.html">23</a></li><li><a href="viewtopic.php%3Fid=33429&amp;p=24.html">24</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>