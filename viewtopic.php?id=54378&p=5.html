<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Vonets Var11n Plus uboot</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 1 Apr 2018 and 24 Apr 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 5 of 5</div><nav><ul><li><a href="viewtopic.php%3Fid=54378&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=54378&amp;p=3.html">3</a></li><li><a href="viewtopic.php%3Fid=54378&amp;p=4.html">4</a></li><li class="pagination-current"><span>5</span></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p350228">
				<div class="post-metadata">
					<div class="post-num">Post #101</div>
					<div class="post-author">SixOfFive</div>
					<div class="post-datetime">
						25 Jan 2017, 17:43					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>hackru wrote:</cite><blockquote><p>@mirth, sadly i lost my build directory, but what i did is hardcoded &quot;3&quot; as SDRAM. Then image became bootable.</p></blockquote></div><p>Thanks for that hackru, pointed me in the right direction to unlock var11n as well as the mini 300 to use with chaos calmer and development branch.</p><p>If anybody wants some help or hinters regarding getting openwrt on these, you&#039;ll need a flash programmer to get the initial image, modify it (so that you can interrupt the u-boot) and reflash. I&#039;ll provide a more detailed writeup regarding everything I&#039;ve had to do to make this work in the near future, but am willing to answer questions in the meantime if anybody has any. (Yeah, I know, resurrecting an old thread, but I&#039;ve been working on these devices for the last month, and there is next to no information online regarding getting openwrt on them)</p>											<p class="post-edited">(Last edited by <strong>SixOfFive</strong> on 25 Jan 2017, 18:46)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p351540">
				<div class="post-metadata">
					<div class="post-num">Post #102</div>
					<div class="post-author">thetallone</div>
					<div class="post-datetime">
						9 Feb 2017, 22:56					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>SixOfFive wrote:</cite><blockquote><div class="quotebox"><cite>hackru wrote:</cite><blockquote><p>@mirth, sadly i lost my build directory, but what i did is hardcoded &quot;3&quot; as SDRAM. Then image became bootable.</p></blockquote></div><p>Thanks for that hackru, pointed me in the right direction to unlock var11n as well as the mini 300 to use with chaos calmer and development branch.</p><p>If anybody wants some help or hinters regarding getting openwrt on these, you&#039;ll need a flash programmer to get the initial image, modify it (so that you can interrupt the u-boot) and reflash. I&#039;ll provide a more detailed writeup regarding everything I&#039;ve had to do to make this work in the near future, but am willing to answer questions in the meantime if anybody has any. (Yeah, I know, resurrecting an old thread, but I&#039;ve been working on these devices for the last month, and there is next to no information online regarding getting openwrt on them)</p></blockquote></div><p>Hi i&#039;ve recently purchased a var11n plus and had attached a serial connection but can&#039;t interrupt u-boot as apparently it&#039;s locked? What flash programmer do I need to buy and how do i use it to get the initial image?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p351543">
				<div class="post-metadata">
					<div class="post-num">Post #103</div>
					<div class="post-author">SixOfFive</div>
					<div class="post-datetime">
						9 Feb 2017, 23:17					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>thetallone wrote:</cite><blockquote><p>Hi i&#039;ve recently purchased a var11n plus and had attached a serial connection but can&#039;t interrupt u-boot as apparently it&#039;s locked? What flash programmer do I need to buy and how do i use it to get the initial image?</p></blockquote></div><p>Its even easier if you have a system setup to intercept the vonets communication. proftpd does not work (has to do with null character termination from the vonets for file requests). vsftpd does work. The newVersion.txt file is a simple character replacement (not really encrypted, just obfuscated).</p><p>I&#039;ve stopped using the reader/writer as I no longer need it and can flash these fresh from factory with openwrt in a two step process. First step is to enable telnet on these devices so they can be manually flashed with openwrt (there must be some internal checks in the settings program which checks to see if there is a squashfs image in the file and fails if one is found.) The second step is flashing from the telnet prompt in order to get a true openwrt image in there.</p><p>None of the openwrt images will work with these devices (the stock images). I had to hack together the dts file as well as the mt7620.c file in order to get openwrt to boot and function 99% properly on these. As I had to hack together the dts, I only have 1 network cable operational (the female plug I do not have operational, and as it is not needed in this project, I didn&#039;t pursue making it work)</p><p>Since I will be flashing 20 - 50 of these a day, I needed to cut down on time required to push these out the door (hence reverse engineering vonets &quot;encryption&quot; on the ftp server.)</p><p>If you need to know the model of reader/writer I used in order to de-brick these devices/read the rom/write the rom manually. I can ask my co-worker who&#039;s I borrowed.</p><p>Doesn&#039;t look like I can upload files here, so I&#039;ll have to find a site to upload them to. You will need the openwrt builder, in order to compile the firmwares as well. </p><p>If need be, I can provide the hacked vonet firmware with telnet enabled, the newVersion.txt file targetting the var11n model, as well as a base firmware for the 2nd flash with openwrt. My modified dts and mt7620.c files I can also include. Remember, I&#039;m not a developer for openwrt, I just hacked the snot out of this until I made it work.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p351546">
				<div class="post-metadata">
					<div class="post-num">Post #104</div>
					<div class="post-author">thetallone</div>
					<div class="post-datetime">
						9 Feb 2017, 23:29					</div>
				</div>
				<div class="post-content content">
					<p>If you could get the model number of the programmer that would be great as would like to learn how to do it from fresh and also how to read the flash with it.</p><p>How would I get the hacked telnet version onto it? I assume I would have to fake the public ftp server and ip it looks for when you click upgrade in the guide?&nbsp; The ip/server mentioned earlier in this thread appears to be dead.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p351547">
				<div class="post-metadata">
					<div class="post-num">Post #105</div>
					<div class="post-author">SixOfFive</div>
					<div class="post-datetime">
						9 Feb 2017, 23:52					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>thetallone wrote:</cite><blockquote><p>If you could get the model number of the programmer that would be great as would like to learn how to do it from fresh and also how to read the flash with it.</p><p>How would I get the hacked telnet version onto it? I assume I would have to fake the public ftp server and ip it looks for when you click upgrade in the guide?&nbsp; The ip/server mentioned earlier in this thread appears to be dead.</p></blockquote></div><p>Had to ask, as I thought it was a programmer.. Forgot it was just a chip clip.<br />8 pin chip clip to attach to the memory model, and an SPI compatible device (raspberry pi 2 was used in our environment). Then there are numerous tutorials out there on how to read and write roms using pi&#039;s SPI interface.</p><p>The hacked version .. you are correct. You would need to modify the hosts file so that the vonets servers point at your own machine. Have vsftpd installed and a user setup (qinfang/123456). then you would have the newVersion.txt and related firmware in the ftp directory for that user. The firmware upgrade process will check the newVersion.txt and get the filename from that based on the model/line, download the firmware, run its checks on it, and it thinks its a valid image, and writes it out. After reboot, the model is then accessible via telnet with the login of admin/admin.</p><p>Then its as simple as putting your custom firmware in there with something like:<br />cd /tmp<br />wget site/test.bin<br />mtd_write unlock Kernel<br />mtd_write -r write test.bin Kernel</p><br /><p>Then the unit reboots, and your running openwrt (as long as that test.bin is compiled properly.)</p><p>If you are going to use my dts and mt7620.c in the future, please realize I have only tested this on the development branch, and your results may vary if used with chaos calmer or other branches. the important thing is to get rid of the DDR stuff in mt7620.c so it only runs with &quot;Board has SDRAM&quot; values, and then obviously the dts which sets up the devices (device tree) for linux to use.</p><p>Seriously? Can&#039;t have links?<br />load this in a browser: hvr.biz/var11n-300/</p><p>Stuff in qinfang folder is what you would want in for the qinfang ftp user interception.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p351548">
				<div class="post-metadata">
					<div class="post-num">Post #106</div>
					<div class="post-author">SixOfFive</div>
					<div class="post-datetime">
						10 Feb 2017, 00:11					</div>
				</div>
				<div class="post-content content">
					<p>Also, when compiling with that dts, you obviously select the mt7620 and copy the *7530*.bin firmware built afterwards for the vonets (even though they are mt7620n devices) ... said I had to hack it a lot <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>											<p class="post-edited">(Last edited by <strong>SixOfFive</strong> on 23 Feb 2017, 18:41)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p351549">
				<div class="post-metadata">
					<div class="post-num">Post #107</div>
					<div class="post-author">SixOfFive</div>
					<div class="post-datetime">
						10 Feb 2017, 00:22					</div>
				</div>
				<div class="post-content content">
					<p>if any devs see this, it sure would be nice not to have to go to these great lengths in order to get openwrt onto these. Not putting blame, but maybe take a look at the files on hvr.biz that I posted in my previous link so that the var11n-300&#039;s can have a stock openwrt firmware.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p351552">
				<div class="post-metadata">
					<div class="post-num">Post #108</div>
					<div class="post-author">thetallone</div>
					<div class="post-datetime">
						10 Feb 2017, 00:48					</div>
				</div>
				<div class="post-content content">
					<p>Can you get the chip clip and programmer info as will pick one up. Thanks for the info does it still look for 211.154.131.164 as the ftp server?</p><p>That&#039;s fine it&#039;s only for experimenting with anyway. I will have a look at your link now.</p>											<p class="post-edited">(Last edited by <strong>thetallone</strong> on 10 Feb 2017, 15:25)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p351606">
				<div class="post-metadata">
					<div class="post-num">Post #109</div>
					<div class="post-author">SixOfFive</div>
					<div class="post-datetime">
						10 Feb 2017, 17:40					</div>
				</div>
				<div class="post-content content">
					<p>I can&#039;t post links, but if you search google for &quot;IC Test Clip - SOIC 8-Pin&quot; you should find the clip within the first few links. (Think it was the second link with sparkfun in it)<br />For programmer we just used flashrom program.<br />The vonets search by dns name, not ip. So its easy enough to redirect via hosts file to your own machine.<br />these probably are not all needed, but I added them all in just in case<br />vonets _ com<br />ww _ vonets _ com<br />ftp _ vonets _ com<br />ww _ vonets _ com _ cn</p><p>ww is triple w</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p352737">
				<div class="post-metadata">
					<div class="post-num">Post #110</div>
					<div class="post-author">supertin</div>
					<div class="post-datetime">
						23 Feb 2017, 06:31					</div>
				</div>
				<div class="post-content content">
					<p>Just checking, because the thread is hard to follow... What&#039;s the current status of building OpenWRT for the MINI300? Are there builds floating around (working or partially working)?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p352775">
				<div class="post-metadata">
					<div class="post-num">Post #111</div>
					<div class="post-author">SixOfFive</div>
					<div class="post-datetime">
						23 Feb 2017, 17:26					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>supertin wrote:</cite><blockquote><p>Just checking, because the thread is hard to follow... What&#039;s the current status of building OpenWRT for the MINI300? Are there builds floating around (working or partially working)?</p></blockquote></div><p>Build method for the MINI300 is the same as for VAR11n-300 (firmware will work on both, but the extra ethernet cable on that var11n-300 is not allocated with my dts file and mt7620.c files.)</p><p>Stock firmwares from openwrt will NOT work on the mini300 or var11n-300. Something I wish they would change.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p353100">
				<div class="post-metadata">
					<div class="post-num">Post #112</div>
					<div class="post-author">SixOfFive</div>
					<div class="post-datetime">
						27 Feb 2017, 21:31					</div>
				</div>
				<div class="post-content content">
					<p>update: Remove the port 5 entries in the DTS file to make things more stable.. Random kernel panic will occur with port 5 entries in the DTS I created.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p353314">
				<div class="post-metadata">
					<div class="post-num">Post #113</div>
					<div class="post-author">fresh</div>
					<div class="post-datetime">
						2 Mar 2017, 01:39					</div>
				</div>
				<div class="post-content content">
					<p>Hi SixOfFive, I&#039;ve followed what you&#039;ve written and now I can telnet my var11n-300.<br />I would need some help for building the image:<br />- I read this link: h**ps://wiki_openwrt_org/doc/howto/buildroot.exigence<br />- I did everything till make menuconfig<br />- I put the DTS in .\openwrt\target\linux\ramips\dts (which is where I&#039;ve found another file with the same name)<br />- I don&#039;t know where I should put &quot;mt7620.c&quot;<br />- Moreover, I don&#039;t know how to set menuconfig for this image<br />These are maybe stupid questions but I&#039;m pretty new to this stuff and I&#039;m pretty lost.<br />Thanks in advance</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p354721">
				<div class="post-metadata">
					<div class="post-num">Post #114</div>
					<div class="post-author">fresh</div>
					<div class="post-datetime">
						21 Mar 2017, 15:45					</div>
				</div>
				<div class="post-content content">
					<p>Sorry to bump, but I&#039;m still stuck to my last post.<br />Can anyone help me?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 5 of 5</div><nav><ul><li><a href="viewtopic.php%3Fid=54378&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=54378&amp;p=3.html">3</a></li><li><a href="viewtopic.php%3Fid=54378&amp;p=4.html">4</a></li><li class="pagination-current"><span>5</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>