<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> bootload script</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 31 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p369374">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">aaadam</div>
					<div class="post-datetime">
						8 Dec 2017, 17:32					</div>
				</div>
				<div class="post-content content">
					<p>hello i would like to execute this lines : <br />ifconfig eth0 192.168.8.1<br />ifconfig usb0 192.168.7.3<br />systemctl stop firewalld.service&nbsp; &nbsp; &nbsp;<br />sudo iptables -t nat -A POSTROUTING --out-interface usb0&nbsp; -j MASQUERADE<br />sudo iptables -A FORWARD --in-interface eth0 -j ACCEPT<br />sleep 1<br />echo 1 &gt;&nbsp; /proc/sys/net/ipv4/ip_forward</p><p>at the end of load of linux, I know that i have to do something in&nbsp; init.d but I&#039;m not realy sure what ...<br />I copied example script to /etc/init.d <br />cat example<br />#!/bin/sh <br /># Example script<br /># Copyright (C) 2007 OpenWrt.org</p><p>START=10<br />STOP=15</p><p>boot() {<br />&nbsp; &nbsp; &nbsp; &nbsp; echo boot<br />&nbsp; &nbsp; &nbsp; &nbsp; ifconfig eth0 192.168.8.1<br />&nbsp; &nbsp; &nbsp; &nbsp; ifconfig usb0 192.168.7.3<br />&nbsp; &nbsp; &nbsp; &nbsp; systemctl stop firewalld.service&nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; sudo iptables -t nat -A POSTROUTING --out-interface usb0&nbsp; -j MASQUERADE<br />&nbsp; &nbsp; &nbsp; &nbsp; sudo iptables -A FORWARD --in-interface eth0 -j ACCEPT<br />&nbsp; &nbsp; &nbsp; &nbsp; sleep 1<br />&nbsp; &nbsp; &nbsp; &nbsp; echo 1 &gt;&nbsp; /proc/sys/net/ipv4/ip_forward<br />&nbsp; &nbsp; &nbsp; &nbsp; # commands to run on boot<br />}</p><p>start() {<br />&nbsp; &nbsp; &nbsp; &nbsp; echo start<br />&nbsp; &nbsp; &nbsp; &nbsp; # commands to launch application<br />}</p><p>stop() {<br />&nbsp; &nbsp; &nbsp; &nbsp; echo stop<br />&nbsp; &nbsp; &nbsp; &nbsp; # commands to kill application<br />}<br />/etc/init.d directory output </p><p>:/etc/init.d# ls<br />acpid&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; halt&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mountnfs.sh&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;single<br />alsa-utils&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; hdparm&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mtab.sh&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; skeleton<br />apache2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;hostapd&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; networking&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ssh<br />avahi-daemon&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; hostname.sh&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pppd-dns&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sudo<br />bluetooth&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; hwclock.sh&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;procps&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; udev<br />bootlogs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;kbd&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;udev-mtab<br />bootmisc.sh&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;keyboard-setup&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;rc.local&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;udhcpd<br />capemgr.sh&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; killprocs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rcS&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; umountfs<br />checkfs.sh&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; kmod&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; README&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; umountnfs.sh<br />checkroot-bootclean.sh&nbsp; lightdm&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; reboot&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; umountroot<br />checkroot.sh&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;loadcpufreq&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rmnologin&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;urandom<br />console-setup&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;motd&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;rsync&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; wicd<br />cpufrequtils&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mountall-bootclean.sh&nbsp; rsyslog&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;x11-common<br />cron&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mountall.sh&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;samba&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xrdp<br />dbus&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mountdevsubfs.sh&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;saned<br />example&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mountkernfs.sh&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; screen-cleanup<br />generic-boot-script.sh&nbsp; &nbsp; mountnfs-bootclean.sh&nbsp; sendsigs</p><p>I also enabled this script but its not working. Can someone help me please ??</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p369633">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">th3gr8</div>
					<div class="post-datetime">
						15 Dec 2017, 09:07					</div>
				</div>
				<div class="post-content content">
					<p>Try changing the line &quot;#!/bin/sh &quot; in your script to &quot;#!/bin/sh /etc/rc.common&quot; and then try to enable it and see if it works.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p370261">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">jams</div>
					<div class="post-datetime">
						31 Dec 2017, 12:08					</div>
				</div>
				<div class="post-content content">
					<p>the way to add bootload scriptï¼š<br />1)add new script in /etc/init.d as you have done<br />2)Establish a soft link.&nbsp; ln -s /etc/init.d/name /etc/rc.d/S100name<br />then, the next time you restart your device you can see the result</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>