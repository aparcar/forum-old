<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> TP-Link TL-WR841N v8.0</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 26 Jul 2014 and 6 May 2018.
										Unfortunately there are posts – most likely complete pages – missing.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 5 of 21</div><nav><ul><li><a href="viewtopic.php%3Fid=37010&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=37010&amp;p=3.html">3</a></li><li><a href="viewtopic.php%3Fid=37010&amp;p=4.html">4</a></li><li class="pagination-current"><span>5</span></li><li><a href="viewtopic.php%3Fid=37010&amp;p=6.html">6</a></li><li><a href="viewtopic.php%3Fid=37010&amp;p=7.html">7</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=37010&amp;p=21.html">21</a></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p184085">
				<div class="post-metadata">
					<div class="post-num">Post #101</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						23 Nov 2012, 14:08					</div>
				</div>
				<div class="post-content content">
					<p>uboot is updated by newest firmware (can&#039;t know what are the changes in newer uboot), you can see the version at offset 0x3450:</p><p>&quot;U-Boot 1.1.4 (Aug&nbsp; 2 2012 - 11:33:04)&quot; in 120802 firmware,</p><p>&quot;U-Boot 1.1.4 (Nov&nbsp; 1 2012 - 10:25:34)&quot; in 121101 firmware.</p><p>That is, they put the timestamp of the firmware in u-boot version... Really can&#039;t understand this thing...</p><p>Anyway they say that you can&#039;t downgrade firmware, I assume the oldest firmware does not work ok with new bootloader??</p><p>I still cannot understand what is the current output of your bricked router.. did uboot shows itself or it&#039;s completely dead and must use a flash programmer (or the trick with 2 flash chips in parallel)??</p><br /><p>EDIT: wrong call, there is no warning about using old firmware on new bootloader FOR THIS MODEL, but there is one for 741, really interesting...</p><p><a href="http://www.tp-link.it/support/download/?model=TL-WR741ND&amp;version=V4">http://www.tp-link.it/support/download/ … version=V4</a></p>											<p class="post-edited">(Last edited by <strong>nebbia88</strong> on 23 Nov 2012, 14:10)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p184115">
				<div class="post-metadata">
					<div class="post-num">Post #102</div>
					<div class="post-author">gulweb</div>
					<div class="post-datetime">
						23 Nov 2012, 20:06					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nebbia88 wrote:</cite><blockquote><p>uboot is updated by newest firmware (can&#039;t know what are the changes in newer uboot), you can see the version at offset 0x3450:</p><p>&quot;U-Boot 1.1.4 (Aug&nbsp; 2 2012 - 11:33:04)&quot; in 120802 firmware,</p><p>&quot;U-Boot 1.1.4 (Nov&nbsp; 1 2012 - 10:25:34)&quot; in 121101 firmware.</p><p>That is, they put the timestamp of the firmware in u-boot version... Really can&#039;t understand this thing...</p><p>Anyway they say that you can&#039;t downgrade firmware, I assume the oldest firmware does not work ok with new bootloader??</p><p>I still cannot understand what is the current output of your bricked router.. did uboot shows itself or it&#039;s completely dead and must use a flash programmer (or the trick with 2 flash chips in parallel)??</p><br /><p>EDIT: wrong call, there is no warning about using old firmware on new bootloader FOR THIS MODEL, but there is one for 741, really interesting...</p><p><a href="http://www.tp-link.it/support/download/?model=TL-WR741ND&amp;version=V4">http://www.tp-link.it/support/download/ … version=V4</a></p></blockquote></div><p>Ok, well i suspected something there based on the supplied bootloader. Hmm, version is the same, but &quot;compile&quot; date different. As for using old firmware with more modern boot, note that it worked OK with router #1. I think the original firmware was the Aug 2&nbsp; 2012 release, so that should be the installed bootloader. They are close in mfg, one MAC ends in 74:63:34 and the other 74:62:EA, so there should be no diffs.</p><p>Now #2 it is totally dead, it lights up all leds, no terminal output, probably nuked flash. I have not decided yet, but might go the &quot;dual-flash&quot; path,<br />or just write it off, to learning experience.</p><p>Now, copying flash, I can see that not ALL flash is copied, am I correct in assumig the part NOT copied is stuff unique for the individual such as MAC addresses? I also see that the disposition is different in openwrt and tplink fw, al least mtd partition naming is.</p><p>Also, let us assume I cut out the 257 first block constituting the boot loader, is that the image that goes into the first blocks of flash? What about the header string info, is that ALSO put in flash, or does the mtd skip the header ( guess = 1 block ?)? Does the same go for the image proper?</p>											<p class="post-edited">(Last edited by <strong>gulweb</strong> on 23 Nov 2012, 20:11)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p184129">
				<div class="post-metadata">
					<div class="post-num">Post #103</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						23 Nov 2012, 21:03					</div>
				</div>
				<div class="post-content content">
					<p>read this for flash layout??</p><p><a href="http://wiki.openwrt.org/toh/tp-link/tl-mr3020#original.flash.layout">http://wiki.openwrt.org/toh/tp-link/tl- … ash.layout</a></p><p>yes when copying the final part (art) it&#039;s not copied.. </p><p>the first 3 partitions i think they are exactly like in factory image with included uboot!</p><p>anyway seems identical to openwrt mtd partition scheme! I assume &quot;config&quot; equals to &quot;rootfs_data&quot;...</p>											<p class="post-edited">(Last edited by <strong>nebbia88</strong> on 23 Nov 2012, 21:06)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p184135">
				<div class="post-metadata">
					<div class="post-num">Post #104</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						23 Nov 2012, 21:24					</div>
				</div>
				<div class="post-content content">
					<p>anyway seems that uboot from stock firmware with boot in name, is copied from 0x278-0x201FF TO 0x000-0x1FF87, so first 0x277 bytes of original firmware are just header, checks or i don&#039;t know what..</p><p>got to that conclusion by hexcmp my uboot dump:</p><p>cat /dev/mtd0 &gt; /tmp/mtd0</p><p>to a firmware with boot in name..</p>											<p class="post-edited">(Last edited by <strong>nebbia88</strong> on 23 Nov 2012, 21:27)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p184145">
				<div class="post-metadata">
					<div class="post-num">Post #105</div>
					<div class="post-author">gulweb</div>
					<div class="post-datetime">
						23 Nov 2012, 22:16					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nebbia88 wrote:</cite><blockquote><p>read this for flash layout??</p><p><a href="http://wiki.openwrt.org/toh/tp-link/tl-mr3020#original.flash.layout">http://wiki.openwrt.org/toh/tp-link/tl- … ash.layout</a></p><p>yes when copying the final part (art) it&#039;s not copied.. </p><p>the first 3 partitions i think they are exactly like in factory image with included uboot!</p><p>anyway seems identical to openwrt mtd partition scheme! I assume &quot;config&quot; equals to &quot;rootfs_data&quot;...</p></blockquote></div><p>Ok, that is what I have deduced, but looking at openwrt doc&#039;s it seems <br />boot is same<br />kernel is same<br />rootfs is i block larger than (your link) <br />there is no config partition<br />art is last</p><p>I&nbsp; am getting more and more interested in doing the dual flash trick, it will be interesting to see if art is intact, and also if there IS a config, I guess<br />otherwise I have no mac addresses any more.... :-) well, worry about that later....</p><p>You mention</p><p>anyway seems that uboot from stock firmware with boot in name, is copied from 0x278-0x201FF TO 0x000-0x1FF87, so first 0x277 bytes of original firmware</p><p>Is 000-1ff87 ram addresses when the processor is running? ( they are mentioned at other offses in Uboot ) ??</p>											<p class="post-edited">(Last edited by <strong>gulweb</strong> on 23 Nov 2012, 22:27)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p184146">
				<div class="post-metadata">
					<div class="post-num">Post #106</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						23 Nov 2012, 22:30					</div>
				</div>
				<div class="post-content content">
					<p>no i only made a dump of my wr703 mtd0, and i saw that that is very similar (will be equal if same model) to the 0x278-0201FF part of the stock wr741 firmware with uboot...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p184147">
				<div class="post-metadata">
					<div class="post-num">Post #107</div>
					<div class="post-author">gulweb</div>
					<div class="post-datetime">
						23 Nov 2012, 22:51					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nebbia88 wrote:</cite><blockquote><p>no i only made a dump of my wr703 mtd0, and i saw that that is very similar (will be equal if same model) to the 0x278-0201FF part of the stock wr741 firmware with uboot...</p></blockquote></div><p>Hm, I have to verify the actual addresses if I try this.</p><p>The copyflash example used</p><p>cp.b 0x9f000000 0x81000000 0x3effff ; 9f000000 base of flash ? 81000000 mid of ram ? start + 16 Mb ?? 3effff&nbsp; (4Mb -64 k -1), why the -1?</p><p>My interpretation, copy boot + firmware + (config ??) but not last byte and do not touch art.</p><p>This is what the tplink linux says about the flash (captured on the broken board before I nuked it trying to restore the image)</p><p># cat /proc/mtd <br />dev:&nbsp; &nbsp; size&nbsp; &nbsp;erasesize&nbsp; name<br />mtd0: 00020000 00010000 &quot;u-boot&quot;<br />mtd1: 00100000 00010000 &quot;kernel&quot;<br />mtd2: 002c0000 00010000 &quot;rootfs&quot;<br />mtd3: 00010000 00010000 &quot;config&quot;<br />mtd4: 00010000 00010000 &quot;art&quot;</p><p>so, there is 64k reserved below art for config in the tplink image</p><p>and this is the error I got befor it froze, copied from earlier post, did not save MY message</p><p>wasp&gt; bootm 0x9f020000<br />## Booting image at 9f020000 ...<br />&nbsp; &nbsp;Uncompressing Kernel Image ... Too big uncompressed streamLZMA ERROR 1 - must RESET board to recover</p><p>Now when turning on</p><p>led<br />1&nbsp; &nbsp; 2&nbsp; &nbsp;3&nbsp; &nbsp;4&nbsp; &nbsp;5&nbsp; &nbsp;6&nbsp; &nbsp;7&nbsp; &nbsp;8&nbsp; &nbsp;9<br />on off off on on on on off off = power, WAN, port 1,2,3 <br />completely static</p>											<p class="post-edited">(Last edited by <strong>gulweb</strong> on 23 Nov 2012, 23:25)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p184156">
				<div class="post-metadata">
					<div class="post-num">Post #108</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						24 Nov 2012, 00:05					</div>
				</div>
				<div class="post-content content">
					<p>that error seems common:</p><p><a href="https://forum.openwrt.org/viewtopic.php?pid=180059#p180059">https://forum.openwrt.org/viewtopic.php … 59#p180059</a></p><br /><p><a href="https://forum.openwrt.org/viewtopic.php?pid=170798#p170798">https://forum.openwrt.org/viewtopic.php … 98#p170798</a></p><br /><p><a href="https://forum.openwrt.org/viewtopic.php?id=37670">https://forum.openwrt.org/viewtopic.php?id=37670</a></p><br /><p>the fact that the board DIED completely seems really strange.... i&#039;m starting to think that is not a flash problem <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>BTW what serial adaptor did you use? i was thinking that you did strange tries with resistors, maybe you killed the TX pin??</p><br /><p>0x3EFFFF is last byte of complete flash (-art), it&#039;s obviously -1, if you have a 2 byte flash it will be from 0x0 to 0x1, that is 2-1 XD</p><p>0x9f000000 is ram start i think,</p>											<p class="post-edited">(Last edited by <strong>nebbia88</strong> on 24 Nov 2012, 00:10)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p184157">
				<div class="post-metadata">
					<div class="post-num">Post #109</div>
					<div class="post-author">gulweb</div>
					<div class="post-datetime">
						24 Nov 2012, 00:32					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nebbia88 wrote:</cite><blockquote><p>that error seems common:</p><p><a href="https://forum.openwrt.org/viewtopic.php?pid=180059#p180059">https://forum.openwrt.org/viewtopic.php … 59#p180059</a></p><br /><p><a href="https://forum.openwrt.org/viewtopic.php?pid=170798#p170798">https://forum.openwrt.org/viewtopic.php … 98#p170798</a></p><br /><p><a href="https://forum.openwrt.org/viewtopic.php?id=37670">https://forum.openwrt.org/viewtopic.php?id=37670</a></p><br /><p>the fact that the board DIED completely seems really strange.... i&#039;m starting to think that is not a flash problem <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>BTW what serial adaptor did you use? i was thinking that you did strange tries with resistors, maybe you killed the TX pin??</p><br /><p>0x3EFFFF is last byte of complete flash (-art), it&#039;s obviously -1, if you have a 2 byte flash it will be from 0x0 to 0x1, that is 2-1 XD</p><p>0x9f000000 is ram start i think,</p></blockquote></div><p>Yes, a bit strange, well it is really hard to remeber if you did something wrong, but to the best of my knowledge I have followed<br />the advice here, and also tried to understand the small differences between my case and others. I dont believe I have been careless.</p><p>If you do something sucessfull, you do not expect the same thing to fail on identical hardware. Of course, it is possible<br />i did a stupid typo or something, but TWICE on two different procedures on the same platform?</p><p>About the &quot;resistor&quot; stuff, I use a very simple circuit for level conversion, I have used it on several microprocessors, and<br />it is basicly a NPN transistor that does the conversion. Now, the base of this lives on + 0.6 V, so when the TX pin is high,<br />some small current is sinked from TX. What I found was NOT bad levels, but the total inability of the router to start if<br />this resistor was 10k (which is pretty much standard, and does NOT load the output significantly. However, my observation<br />is that the pin (TX) might have a different function at power on / startup reset, where it *might* indicate a specific<br />startup condition. This is common on a lot of IC&#039;s. However, increasing the value and thus lowering the current drawn<br />from the pin as I described made it work. It is merely an observation for somebody who might use a similar coverter from<br />for example Sparkfun.</p><p>Contrary to you, I believe it HAS to do with the flash, perhaps a timing issue, where som flash roms dont hack it. I had the opportunity<br />to browse around in the broken tplink firmware, and while Linux booted, there were massive squashs errors, wrong pointers, failiure to<br />load modules and components. A not-so-well-informed guess is that the upper part of the flash image was corrupted, so the thing<br />actually booted, and I could log in, i even looked for a fsck, but no such thing.</p>											<p class="post-edited">(Last edited by <strong>gulweb</strong> on 24 Nov 2012, 00:37)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p184159">
				<div class="post-metadata">
					<div class="post-num">Post #110</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						24 Nov 2012, 00:53					</div>
				</div>
				<div class="post-content content">
					<p>Yes so you got 2 faliure, one when restoring tplink fw, and one trying from uboot the second time.. Also probably wrong parameters in uboot (printenv would have been useful to inspect that) makes me think your flash chip was failing.... Time to upgrade to 16M xD</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p184204">
				<div class="post-metadata">
					<div class="post-num">Post #111</div>
					<div class="post-author">gulweb</div>
					<div class="post-datetime">
						24 Nov 2012, 21:32					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nebbia88 wrote:</cite><blockquote><p>Yes so you got 2 faliure, one when restoring tplink fw, and one trying from uboot the second time.. Also probably wrong parameters in uboot (printenv would have been useful to inspect that) makes me think your flash chip was failing.... Time to upgrade to 16M xD</p></blockquote></div><p>For you nebbia88 and all others who can learn something from this:</p><p>I could not get to rest about my router not wanting to cooperate, so I followed the nice tip from nebbia88 to remove the flash chip from the bricked router, and piggybacking it onto the flash in the working router. I lifted pin1 of the &quot;good&quot; router, and attaced some wires and a micro alligator clip so I could select the flash manually. I did this fully aware that I might nuke the only remaining hw. This took some hours, I wish i were 16 again :-)</p><p>I booted the router with the good flash selected, (115kbaud/7S1). I attempted to copy boot+firmware, but leaving the two highest 64 k blocks intact, <br />so I used a size of 0x3dffff, not touching sector 3e (config??) and 3f ( art??). I switched chip select, erased 0-3dffff, and was greeted with &quot;62 sectors erased&quot;, which seems correct. I copied ram to flash. Without changing anything, I switched power off / on. SAME BEHAVIOUR AS BEFORE, leds 1 x x 4 5 6 7 x x ON, nothing on the terminal.</p><p>I repeated the experiment, but still in wasp&gt; but this time I copied only the boot, i.e. the first 0x20000 bytes.</p><p>Power up, SAME AS BEFORE.</p><p>New repeat, this time all first 62 sectors, and boot + firmware.&nbsp; Tried bootm 0x9f020000 </p><br /><p> bootm 0x9f020000<br />## Booting image at 9f020000 ...<br />&nbsp; &nbsp;Uncompressing Kernel Image ... Too big uncompressed streamLZMA ERROR 1 - must RESET board to recover</p><p>and a dead router, no uboot, ledon 1 x x 4 5 6 7 x x</p><p>(note the pattern, it is NOT power + switch ports, maybe it means &quot;xxx -data corrupted, cannot start&quot; ??</p><p>Last try before throwing the piggyback flash in the recycling, I restarted again, but this time i copied ALL flash, 0x400000. Power off/on, and now the thing is booting. So, this is now an identical twin, and MAC addr etc is screwed., but Uboot works. So, 2 possibilities:</p><p>1. there is something that needs to be in config or art, and that something prevents uboot to run. Partition chksum??<br />2. there is a bug in uboot, so the copy operations do not do what you ask it</p><p>So, now I am going to transfer the chip back into the &quot;bricked router&quot; but I think I&#039;ll save that for tomorrow :-)</p>											<p class="post-edited">(Last edited by <strong>gulweb</strong> on 24 Nov 2012, 21:41)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p184210">
				<div class="post-metadata">
					<div class="post-num">Post #112</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						24 Nov 2012, 22:58					</div>
				</div>
				<div class="post-content content">
					<p>My guess is that your second flash chip was blewed.. You&#039;ll find out only trying the good flash on the bricked unit!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p184211">
				<div class="post-metadata">
					<div class="post-num">Post #113</div>
					<div class="post-author">gulweb</div>
					<div class="post-datetime">
						24 Nov 2012, 23:03					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nebbia88 wrote:</cite><blockquote><p>My guess is that your second flash chip was blewed.. You&#039;ll find out only trying the good flash on the bricked unit!</p></blockquote></div><p>No, I don&#039;t think so, I can reboot with either chip on the &quot;good&quot; router, but I will put it back on the &quot;bad&quot; router tomorrow, and se if I indeed have two identical twins now. If that is correct, I will have to dump the config space, so I can edit and fix the MAC addresses, since now both routers are the same. It *seems* to me that copying the WHOLE chip repaired it.</p><p>Edit:</p><p>Now as I am learning more about the HW/Openwrt, it would be good to confirm a few suspicins. The flash on the TL-WR841ND is a serial flash. <br />Thus, when the router is booted, the AR9341 (??) reads the entire contents of the flash into ram, and then starts execution i ram. I cannot find any data sheet, so I am just guessing here. There might be some fields in the image that have special significance, and there might be checksums to make sure the flash contents is correct. This is probably why this failed for me. Now, with a new copy of a working flash, it works, but sadly it is the &quot;wrong&quot; flash, of another unit.</p>											<p class="post-edited">(Last edited by <strong>gulweb</strong> on 25 Nov 2012, 00:14)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p184214">
				<div class="post-metadata">
					<div class="post-num">Post #114</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						25 Nov 2012, 00:15					</div>
				</div>
				<div class="post-content content">
					<p>oh i&#039;m sorry, i completely missed the fact that the #1 board was booting with both chips, in the end... </p><p>BTW did you make a backup of the art partition of the flash of the #2 board before overwriting?</p>											<p class="post-edited">(Last edited by <strong>nebbia88</strong> on 25 Nov 2012, 00:15)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p184217">
				<div class="post-metadata">
					<div class="post-num">Post #115</div>
					<div class="post-author">quorce</div>
					<div class="post-datetime">
						25 Nov 2012, 01:10					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>undermonster wrote:</cite><blockquote><p><strong>I Unbricked my WR841N v8.2 - without hardware hacks.</strong></p><p>I will explain how to revert to STOCK firmware.</p><p>1) Set your Computer IP to 192.168.1.2 (<em>Ethernet, not WiFi</em>)<br />2) Connect to your router, in the WAN port (<em>blue</em>)<br />3) Ping 192.168.1.1 continuously. (<em>Helps identify when it&#039;s ready</em>)<br />4) Turn Router ON. Press the <strong>WPS/Reset</strong> button many times.<br />5) Wait for LED under <strong>gear</strong> icon to flash rapidly.<br />6) Wait for PING to respond (<em>Not failed response</em>)<br />7) Telnet into 192.168.1.1 from your PC<br />8) In telnet, CD to /tmp<br />9) Copy stock firmware (<a href="http://www.tp-link.com/Resources/software/TL-WR841N_V8_120522.zip">Link</a>) to /tmp (<em>wget is installed by default! Download link is ZIP, firmware is BIN!</em>)<br />10) Rename firmware to: tplink.bin<br />11) Type: <span style="color: blue">mtd -r write /tmp/tplink.bin firmware</span><br />12) Wait for &quot;Reboot&quot; message. If error message appears, manually reboot.</p><p>Your router is now back to Factory Defaults.</p></blockquote></div><p>Bricked my WR841n with wrong firmware... <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>I Tried instruction above, without any success... </p><div class="quotebox"><blockquote><p>4) Turn Router ON. Press the <strong>WPS/Reset</strong> button many times.<br />5) Wait for LED under <strong>gear</strong> icon to flash rapidly.</p></blockquote></div><p>My gear icon is still dead... Nothing happend... <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p184218">
				<div class="post-metadata">
					<div class="post-num">Post #116</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						25 Nov 2012, 01:16					</div>
				</div>
				<div class="post-content content">
					<p>What firmware did you used? How do you flashed?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p184219">
				<div class="post-metadata">
					<div class="post-num">Post #117</div>
					<div class="post-author">quorce</div>
					<div class="post-datetime">
						25 Nov 2012, 01:19					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nebbia88 wrote:</cite><blockquote><p>What firmware did you used? How do you flashed?</p></blockquote></div><p>openwrt-ar71xx-generic-tl-wr841n-v8-squashfs-factory</p><p>tplinklogin.net -&gt; upgrade firmware</p><p>(I made it through wifi, not via ethernet cabel...)</p><p>PS. wr841n v.8.2</p>											<p class="post-edited">(Last edited by <strong>quorce</strong> on 25 Nov 2012, 01:19)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p184220">
				<div class="post-metadata">
					<div class="post-num">Post #118</div>
					<div class="post-author">gulweb</div>
					<div class="post-datetime">
						25 Nov 2012, 01:37					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nebbia88 wrote:</cite><blockquote><p>oh i&#039;m sorry, i completely missed the fact that the #1 board was booting with both chips, in the end... </p><p>BTW did you make a backup of the art partition of the flash of the #2 board before overwriting?</p></blockquote></div><p>No, I dont have any backup of either config or art ( I&#039;am still only 98 % shure these are the two critical partitions).<br />I dont see how I could, because just flashing uboot or flashing uboot + fw did not get the router running.<br />I tried to preserve those partitions, but with negative results.</p><p>The ONLY thing that helped was copying the WHOLE 4 mb, i.e. INCLUDING config + art.<br />In retrospect I should have tried boot + firmware + config first, but I had already given up, it was just the<br />final desperate try that brought it to life again.</p><p>Anyway, it cannot be that the firmware part is checksummed as part of the entire flash, because then it would not<br />be possible to swap back and forth between Openwrt and stock (easily). But there must be SOMETHING in<br />partition config and/or art that is the enabler.</p><p>Now I will try to find info on these two partitions, at least enough to be able to reset back the proper MAC addresses.<br />And, now that it boots, it is possible to extract these, and tftp them.</p><p>Could it be that Uboot also needs to read the config partition, and if it is nuked, it will not find any devices?<br />But, it should be able to say so, i.e. Uboot 1.1.4 -- cannot read config</p>											<p class="post-edited">(Last edited by <strong>gulweb</strong> on 25 Nov 2012, 01:39)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p184234">
				<div class="post-metadata">
					<div class="post-num">Post #119</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						25 Nov 2012, 09:43					</div>
				</div>
				<div class="post-content content">
					<p>anyway config partition is not the problem, since it&#039;s erased by a &quot;restore factory defaults&quot;, or am I thinking wrong??</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p184235">
				<div class="post-metadata">
					<div class="post-num">Post #120</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						25 Nov 2012, 09:44					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>quorce wrote:</cite><blockquote><div class="quotebox"><cite>nebbia88 wrote:</cite><blockquote><p>What firmware did you used? How do you flashed?</p></blockquote></div><p>openwrt-ar71xx-generic-tl-wr841n-v8-squashfs-factory</p><p>tplinklogin.net -&gt; upgrade firmware</p><p>(I made it through wifi, not via ethernet cabel...)</p><p>PS. wr841n v.8.2</p></blockquote></div><p>can&#039;t see why you should brick with this... you can&#039;t ping 192.168.1.1? neither with static ip? try also failsafe mode!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p184246">
				<div class="post-metadata">
					<div class="post-num">Post #121</div>
					<div class="post-author">quorce</div>
					<div class="post-datetime">
						25 Nov 2012, 12:12					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nebbia88 wrote:</cite><blockquote><p>can&#039;t see why you should brick with this... you can&#039;t ping 192.168.1.1? neither with static ip? try also failsafe mode!</p></blockquote></div><p>1. set ethernet to 192.168.1.2<br />2. connect via cabel router to pc<br />3. my pc see this router as &quot;Unidentified network&quot;<br />4. cannot ping 192.168.1.1</p><p><img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p184247">
				<div class="post-metadata">
					<div class="post-num">Post #122</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						25 Nov 2012, 12:35					</div>
				</div>
				<div class="post-content content">
					<p>pressing QSS button LOTS of times during startup make the SYS led fast flashing? in normal startup does it flash and after some seconds stay ON?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p184248">
				<div class="post-metadata">
					<div class="post-num">Post #123</div>
					<div class="post-author">gulweb</div>
					<div class="post-datetime">
						25 Nov 2012, 13:04					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nebbia88 wrote:</cite><blockquote><p>anyway config partition is not the problem, since it&#039;s erased by a &quot;restore factory defaults&quot;, or am I thinking wrong??</p></blockquote></div><p>If the config partition only contains user config, and is indeed erased by &quot;restore factory&quot;, then that should not be a problem.</p><p>To get further clarification, description of the contents of config and art is needed, I think a lot can be read from mftplinkfw.c in the tools directory,<br />since it knows a lot about the fw header. Other fragments from other places.</p><p>I tried to download the tplink GPL software kit, and receive 327 Mb, but it does not open as a tar.gz kit, so it is obfuscated, which I think breaks<br />the GPL agreement. Anyone succeeded in unpacking theit software kit??</p><p>Edit: Update</p><p>Flash chips now back in their respective boards, and I now have two working and identical routers.</p>											<p class="post-edited">(Last edited by <strong>gulweb</strong> on 25 Nov 2012, 17:25)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p184291">
				<div class="post-metadata">
					<div class="post-num">Post #124</div>
					<div class="post-author">quorce</div>
					<div class="post-datetime">
						25 Nov 2012, 20:06					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nebbia88 wrote:</cite><blockquote><p>pressing QSS button LOTS of times during startup make the SYS led fast flashing? in normal startup does it flash and after some seconds stay ON?</p></blockquote></div><p>So step by step:<br />- power on<br />- all leds light for a 1 second<br />- all leds off, only power led (first led) is green</p><p>no one led flash <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>edit:<br />Got Sony Ericsson cable (black, red, white and green wire), maybe unbrick via ttl cable?</p>											<p class="post-edited">(Last edited by <strong>quorce</strong> on 25 Nov 2012, 21:23)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p184298">
				<div class="post-metadata">
					<div class="post-num">Post #125</div>
					<div class="post-author">gulweb</div>
					<div class="post-datetime">
						25 Nov 2012, 21:59					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>quorce wrote:</cite><blockquote><div class="quotebox"><cite>nebbia88 wrote:</cite><blockquote><p>pressing QSS button LOTS of times during startup make the SYS led fast flashing? in normal startup does it flash and after some seconds stay ON?</p></blockquote></div><p>So step by step:<br />- power on<br />- all leds light for a 1 second<br />- all leds off, only power led (first led) is green</p><p>no one led flash <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>edit:<br />Got Sony Ericsson cable (black, red, white and green wire), maybe unbrick via ttl cable?</p></blockquote></div><p>If you can get no action from your router, connecting a terminal can give you some idea about what has happened. But it is not always easy :-)</p>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 5 of 21</div><nav><ul><li><a href="viewtopic.php%3Fid=37010&amp;p=1.html">1</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=37010&amp;p=3.html">3</a></li><li><a href="viewtopic.php%3Fid=37010&amp;p=4.html">4</a></li><li class="pagination-current"><span>5</span></li><li><a href="viewtopic.php%3Fid=37010&amp;p=6.html">6</a></li><li><a href="viewtopic.php%3Fid=37010&amp;p=7.html">7</a></li><li class="pagination-ellipsis"><span>...</span></li><li><a href="viewtopic.php%3Fid=37010&amp;p=21.html">21</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0.001 -->

</body>
</html>