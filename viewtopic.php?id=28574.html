<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Good USB drive speed tweak</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 27 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p127941">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">robnitro</div>
					<div class="post-datetime">
						11 Feb 2011, 01:43					</div>
				</div>
				<div class="post-content content">
					<p>On my g300nh I was getting horrid results on writes with time dd tests, around 8 MB/sec.</p><p>I found a tweak that helped it go to 19 MB/sec after looking at some linux forums.</p><p>You can add this line to /etc/sysctl.conf and reboot or run sysctl -p.<br />/sys/block/sda/device/max_sectors=1024</p><p>or if you prefer to put it in a startup script or run it one time.<br />echo 1024 &gt; /sys/block/sda/device/max_sectors</p>											<p class="post-edited">(Last edited by <strong>robnitro</strong> on 11 Feb 2011, 01:43)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p127978">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">playdude</div>
					<div class="post-datetime">
						11 Feb 2011, 13:25					</div>
				</div>
				<div class="post-content content">
					<p>Nice trick! Got my wr1043nd transfer speed from 11 MB/s to 13.5 MB/s.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p128008">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						11 Feb 2011, 17:19					</div>
				</div>
				<div class="post-content content">
					<p>Great tip! Drastically improved my throughput! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p128035">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">robnitro</div>
					<div class="post-datetime">
						11 Feb 2011, 20:45					</div>
				</div>
				<div class="post-content content">
					<p>Now if it could drastically increase my samba and ftp write to router usb hdd speeds.&nbsp; At most I can do is max 10 MB/sec writes on g300nh despite dd write doing 19!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p128040">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">lessthanjoey</div>
					<div class="post-datetime">
						11 Feb 2011, 21:50					</div>
				</div>
				<div class="post-content content">
					<p>Interesting. I can get ~31MB/sec both read+write on my wndr3700. Samba is still limited to about 5.5MB/sec write and 7MB/sec read though <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>EDIT: FTP has similar speeds (if anything, slightly slower) to Samba.</p>											<p class="post-edited">(Last edited by <strong>lessthanjoey</strong> on 11 Feb 2011, 22:08)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193967">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">avalon</div>
					<div class="post-datetime">
						6 Mar 2013, 08:39					</div>
				</div>
				<div class="post-content content">
					<p>Thanks, this doubles write performance. See results for &quot;Seagate Free Agent Desktop, 250GB&quot; in <a href="http://wiki.openwrt.org/inbox/benchmark.usb">http://wiki.openwrt.org/inbox/benchmark.usb</a></p><p>But I notice that going over 30MB/s transfer speeds loads the CPU to 45%<br />I think samba and ftp are limited by CPU. I download a 100MB file over CIFS with around 5MB/s and top show the following CPU load:<br /></p><div class="codebox"><pre><code>8% usr  43% sys   0% nic   0% idle  26% io   0% irq  21% sirq</code></pre></div><p>See my bonnie++ results with and without the max_sectors (use bon_csv2html to convert csv to nice html):<br /></p><div class="codebox"><pre><code>1.96,1.96,felis-way,1,1362551860,64M,,,,15895,11,9900,25,,,26373,39,94.0,16,,,,,,,,,,,,,,,,,,,805ms,285ms,,101ms,554ms,,,,,,
1.96,1.96,felis-way,1,1362552675,64M,,,,31864,67,12645,34,,,33142,45,117.7,19,,,,,,,,,,,,,,,,,,,27761us,197ms,,25956us,532ms,,,,,,</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p194256">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">tului</div>
					<div class="post-datetime">
						8 Mar 2013, 18:40					</div>
				</div>
				<div class="post-content content">
					<p>Really hoping to get some openwrt supported routers with usb 3.0 ports soon.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p194537">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">avalon</div>
					<div class="post-datetime">
						11 Mar 2013, 09:54					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>tului wrote:</cite><blockquote><p>Really hoping to get some openwrt supported routers with usb 3.0 ports soon.</p></blockquote></div><p>As I wrote earlier, the transfer speeds are limited to CPU, not data bus. And you can see IO speed of the only USB 3.0 router in the wiki page is not higher than 2.0<br />With a faster CPU and more memory things may change though.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p194630">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">tului</div>
					<div class="post-datetime">
						12 Mar 2013, 11:54					</div>
				</div>
				<div class="post-content content">
					<p>Some routers with a tablet OMAP 5xxx CPU and USB 3.0 then :-P</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p196449">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">tului</div>
					<div class="post-datetime">
						27 Mar 2013, 20:32					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>tului wrote:</cite><blockquote><p>Some routers with a tablet OMAP 5xxx CPU and USB 3.0 then :-P</p></blockquote></div><p>Or a Snapdragon 600, any of the high end SoCs out now. I&#039;d really like to see an beaglebone or raspberry Pi type device(with a bit beefier CPU) and a built in 4 or 5 port switch that supports VLAN and jumbo packets.</p><p>Kickstarter anyone?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>