<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> wl-500gp V2 pl2303 lockup 2.4.35</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 30 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p68478">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">enzo86</div>
					<div class="post-datetime">
						21 May 2008, 07:22					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>I have been racking my brain trying to get a usb to serial adapter to work with a wl-500gp v2 ( this worked fine with a V1 on WR)</p><p>I am running kamikaze trunk (latest as of tonight) when I try to access the usb serial port the entire system locks up.&nbsp; &nbsp;I have tried setting the correct speed. backporting the 2.6 pl2303 driver , etc but nothing seems to work.&nbsp; This worked correctly on 2.4 on the V1 or this router. I am not able to use 2.6 because of its lack of bcom wifi support. </p><p>A simple&nbsp; &quot;screen /dev/usb/tts/0 2400&quot;&nbsp; will lock up the system<br />or cat /dev/usb/tts/0</p><p>Can anyone offer any help ?</p><p>details below</p><p>root@OpenWrt:~# stty -F /dev/usb/tts/0 speed 2400<br />2400<br />root@OpenWrt:~# stty -F /dev/usb/tts/0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />speed 2400 baud;</p><br /><br /><p> lsmod<br />Module&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Size&nbsp; Used by&nbsp; &nbsp; Tainted: P&nbsp; <br />pl2303&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;13896&nbsp; &nbsp;0 (unused)<br />usbserial&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 23884&nbsp; &nbsp;0 [pl2303]<br />wlcompat&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 9504&nbsp; &nbsp;0 (unused)<br />usb-ohci&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;19252&nbsp; &nbsp;0 (unused)<br />ip_conntrack_tftp&nbsp; &nbsp; &nbsp; &nbsp;1712&nbsp; &nbsp;0 (unused)<br />ip_nat_irc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2336&nbsp; &nbsp;0 (unused)<br />ip_conntrack_irc&nbsp; &nbsp; &nbsp; &nbsp; 3128&nbsp; &nbsp;1<br />ip_nat_ftp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2960&nbsp; &nbsp;0 (unused)<br />ip_conntrack_ftp&nbsp; &nbsp; &nbsp; &nbsp; 4272&nbsp; &nbsp;1<br />ppp_async&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8044&nbsp; &nbsp;0 (unused)<br />ppp_generic&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 22380&nbsp; &nbsp;0 [ppp_async]<br />slhc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 6064&nbsp; &nbsp;0 [ppp_generic]<br />wl&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 666224&nbsp; &nbsp;0 (unused)<br />usbcore&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 71296&nbsp; &nbsp;1 [pl2303 usbserial usb-ohci]<br />switch-robo&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;5052&nbsp; &nbsp;0 (unused)<br />switch-core&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4928&nbsp; &nbsp;0 [switch-robo]<br />diag&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;28544&nbsp; &nbsp;0 (unused)</p><br /><br /><p>root@OpenWrt:~# uname -a<br />Linux OpenWrt 2.4.35.4 #4 Tue May 20 23:39:58 EDT 2008 mips unknown</p><br /><p>Jan&nbsp; 1 00:00:14 OpenWrt user.info kernel: usb-ohci.c: USB OHCI at membase 0xb8003000, IRQ 6<br />Jan&nbsp; 1 00:00:14 OpenWrt user.info kernel: usb-ohci.c: usb-00:03.0, PCI device 14e4:471a<br />Jan&nbsp; 1 00:00:14 OpenWrt user.info kernel: usb.c: new USB bus registered, assigned bus number 1<br />Jan&nbsp; 1 00:00:14 OpenWrt user.info kernel: hub.c: USB hub found<br />Jan&nbsp; 1 00:00:14 OpenWrt user.info kernel: hub.c: 2 ports detected<br />Jan&nbsp; 1 00:00:14 OpenWrt user.info kernel: usb.c: registered new driver serial<br />Jan&nbsp; 1 00:00:14 OpenWrt user.info kernel: usbserial.c: USB Serial support registered for Generic<br />Jan&nbsp; 1 00:00:14 OpenWrt user.info kernel: usbserial.c: USB Serial Driver core v1.4<br />Jan&nbsp; 1 00:00:14 OpenWrt user.info kernel: usbserial.c: USB Serial support registered for PL-2303<br />Jan&nbsp; 1 00:00:14 OpenWrt user.info kernel: pl2303.c: Prolific PL2303 USB to serial adaptor driver v0.10.1<br />Jan&nbsp; 1 00:00:15 OpenWrt user.info : /etc/rc.common: eval: line 1: swapon: not found<br />Jan&nbsp; 1 00:00:15 OpenWrt user.info kernel: hub.c: new USB device 00:03.0-1, assigned address 2<br />Jan&nbsp; 1 00:00:15 OpenWrt user.info kernel: hub.c: USB hub found<br />Jan&nbsp; 1 00:00:15 OpenWrt user.info kernel: hub.c: 2 ports detected<br />Jan&nbsp; 1 00:00:15 OpenWrt user.info : &#039;wl0&#039; is disabled<br />Jan&nbsp; 1 00:00:15 OpenWrt user.info : &#039;wl0&#039; is disabled<br />Jan&nbsp; 1 00:00:15 OpenWrt user.info kernel: hub.c: new USB device 00:03.0-1.1, assigned address 3<br />Jan&nbsp; 1 00:00:15 OpenWrt user.info kernel: usbserial.c: PL-2303 converter detected<br />Jan&nbsp; 1 00:00:15 OpenWrt user.info kernel: usbserial.c: PL-2303 converter now attached to ttyUSB0 (or usb/tts/0 for de</p><p>I put the pl2303 driver in debug this is what i got:</p><div class="codebox"><pre><code>pl2303.c: pl2303_read_int_callback (0)
pl2303.c: pl2303_read_int_callback - length = 10, data = a1 20 00 00 00 00 02 00 9b 00 
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = f8 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 2
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = 80 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = 00 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
pl2303.c: pl2303_read_int_callback (0)
pl2303.c: pl2303_read_int_callback - length = 10, data = a1 20 00 00 00 00 02 00 9b 00 
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = 80 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 2
pl2303.c: pl2303_write - port 0, 1 bytes
pl2303.c: pl2303_write - length = 1, data = 78 
pl2303.c: pl2303_write - port 0, 1 bytes
pl2303.c: pl2303_write - already writing
pl2303.c: pl2303_write - port 0, 1 bytes
pl2303.c: pl2303_write - already writing
pl2303.c: pl2303_write - port 0, 1 bytes
pl2303.c: pl2303_write - already writing
pl2303.c: pl2303_write - port 0, 1 bytes
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = 80 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
pl2303.c: pl2303_write_bulk_callback - port 0
pl2303.c: pl2303_write - length = 1, data = 5e 
pl2303.c: pl2303_write - port 0, 1 bytes
pl2303.c: pl2303_write - already writing
pl2303.c: pl2303_write - port 0, 1 bytes
pl2303.c: pl2303_write - already writing
pl2303.c: pl2303_write - port 0, 1 bytes
pl2303.c: pl2303_write - already writing
pl2303.c: pl2303_write - port 0, 1 bytes
pl2303.c: pl2303_write - already writing
pl2303.c: pl2303_write - port 0, 1 bytes
pl2303.c: pl2303_write - already writing
pl2303.c: pl2303_write - port 0, 1 bytes
pl2303.c: pl2303_write - already writing
pl2303.c: pl2303_write - port 0, 1 bytes
pl2303.c: pl2303_write - already writing
pl2303.c: pl2303_write - port 0, 1 bytes
pl2303.c: pl2303_write - already writing
pl2303.c: pl2303_write - port 0, 1 bytes
pl2303.c: pl2303_write - already writing
pl2303.c: pl2303_write - port 0, 1 bytes
pl2303.c: pl2303_write - already writing
pl2303.c: pl2303_write - port 0, 1 bytes
pl2303.c: pl2303_write - already writing
pl2303.c: pl2303_write - port 0, 1 bytes
pl2303.c: pl2303_write - already writing
pl2303.c: pl2303_write - port 0, 1 bytes
pl2303.c: pl2303_write - already writing
pl2303.c: pl2303_write - port 0, 1 bytes
pl2303.c: pl2303_write - already writing
pl2303.c: pl2303_write - port 0, 1 bytes
pl2303.c: pl2303_write - already writing
pl2303.c: pl2303_write - port 0, 1 bytes
pl2303.c: pl2303_write - already writing
pl2303.c: pl2303_write - port 0, 1 bytes
pl2303.c: pl2303_write - already writing
pl2303.c: pl2303_write - port 0, 1 bytes
pl2303.c: pl2303_write_bulk_callback - port 0
pl2303.c: pl2303_write - length = 1, data = 40 
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = 80 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
pl2303.c: pl2303_write_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = 80 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
pl2303.c: pl2303_read_int_callback (0)
pl2303.c: pl2303_read_int_callback - length = 10, data = a1 20 00 00 00 00 02 00 9b 00 
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = 00 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 2
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = 80 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = 80 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
pl2303.c: pl2303_write - port 0, 1 bytes
pl2303.c: pl2303_write - length = 1, data = 80 
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = 80 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
pl2303.c: pl2303_write_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = 80 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = 80 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = 78 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
pl2303.c: pl2303_read_int_callback (0)
pl2303.c: pl2303_read_int_callback - length = 10, data = a1 20 00 00 00 00 02 00 9b 00 
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = f8 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 2
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = f8 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
pl2303.c: pl2303_write - port 0, 1 bytes
pl2303.c: pl2303_write - length = 1, data = 80 
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = 80 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
pl2303.c: pl2303_write_bulk_callback - port 0
pl2303.c: pl2303_read_int_callback (0)
pl2303.c: pl2303_read_int_callback - length = 10, data = a1 20 00 00 00 00 02 00 9b 00 
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = 00 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 2
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = 80 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = f8 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = 80 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = f8 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
pl2303.c: pl2303_write - port 0, 1 bytes
pl2303.c: pl2303_write - length = 1, data = 80 
pl2303.c: pl2303_read_int_callback (0)
pl2303.c: pl2303_read_int_callback - length = 10, data = a1 20 00 00 00 00 02 00 9b 00 
pl2303.c: pl2303_write_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = 80 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 2
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = f8 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
pl2303.c: pl2303_read_int_callback (0)
pl2303.c: pl2303_read_int_callback - length = 10, data = a1 20 00 00 00 00 02 00 9b 00 
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = 80 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 2
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = f8 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
pl2303.c: pl2303_write - port 0, 1 bytes
pl2303.c: pl2303_write - length = 1, data = f8 
pl2303.c: pl2303_write_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = 80 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = f8 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
pl2303.c: pl2303_read_int_callback (0)
pl2303.c: pl2303_read_int_callback - length = 10, data = a1 20 00 00 00 00 02 00 9b 00 
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = 00 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 2
pl2303.c: pl2303_read_int_callback (0)
pl2303.c: pl2303_read_int_callback - length = 10, data = a1 20 00 00 00 00 02 00 9b 00 
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = f8 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 2
pl2303.c: pl2303_read_int_callback (0)
pl2303.c: pl2303_read_int_callback - length = 10, data = a1 20 00 00 00 00 02 00 9b 00 
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = 00 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 2
pl2303.c: pl2303_write - port 0, 1 bytes
pl2303.c: pl2303_write - length = 1, data = 80 
pl2303.c: pl2303_read_int_callback (0)
pl2303.c: pl2303_read_int_callback - length = 10, data = a1 20 00 00 00 00 02 00 9b 00 
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = f8 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 2
pl2303.c: pl2303_write_bulk_callback - port 0
pl2303.c: pl2303_read_int_callback (0)
pl2303.c: pl2303_read_int_callback - length = 10, data = a1 20 00 00 00 00 02 00 9b 00 
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = f8 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 2
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = 00 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
pl2303.c: pl2303_read_int_callback (0)
pl2303.c: pl2303_read_int_callback - length = 10, data = a1 20 00 00 00 00 02 00 9b 00 
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = 80 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 2
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - length = 1, data = 78 
pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
pl2303.c: pl2303_read_int_callback (0)
pl2303.c: pl2303_read_int_callback - length = 10, data = a1 20 00 00 00 00 02 00 9b 00 
pl2303.c: pl2303_write - port 0, 1 bytes
pl2303.c: pl2303_write - length = 1, data = 5e 
pl2303.c: pl2303_write - port 0, 1 bytes
pl2303.c: pl2303_write - already writing
pl2303.c: pl2303_write - port 0, 1 bytes
pl2303.c: pl2303_write - already writing
pl2303.c: pl2303_write - port 0, 1 bytes
pl2303.c: pl2303_write - already writing
pl2303.c: pl2303_write - port 0, 1 bytes
pl2303.c: pl2303_write - already writing
pl2303.c: pl2303_write_bulk_callback - port 0
pl2303.c: pl2303_write - port 0, 1 bytes
pl2303.c: pl2303_write - length = 1, data = 40 
pl2303.c: pl2303_write_bulk_callback - port 0
pl2303.c: pl2303_close - port 0
pl2303.c: set_control_lines - value = 0, retval = 0
pl2303.c: pl2303_close - shutting down urbs
pl2303.c: pl2303_close - usb_unlink_urb (write_urb) failed with reason: -19
pl2303.c: pl2303_read_int_callback (0)
pl2303.c: pl2303_read_int_callback - length = 10, data = a1 20 00 00 00 00 02 00 0b 00 
pl2303.c: pl2303_read_bulk_callback - port 0
pl2303.c: pl2303_read_bulk_callback - urb-&gt;status = -2
pl2303.c: pl2303_read_bulk_callback - port is closed, exiting.
pl2303.c: pl2303_read_int_callback (0)
pl2303.c: pl2303_read_int_callback - urb shutting down with status: -2</code></pre></div><p>Thanks</p><p>Jason</p>											<p class="post-edited">(Last edited by <strong>enzo86</strong> on 21 May 2008, 07:37)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p70110">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">bkloppenborg</div>
					<div class="post-datetime">
						26 Jun 2008, 10:01					</div>
				</div>
				<div class="post-content content">
					<p>I don&#039;t suppose you could post the pl2303.o kernel module or ipkg for your backport, could you?</p><p>Edit: Nevermind, I just grabbed the drivers from a WhiteRussian box I had sitting around.</p>											<p class="post-edited">(Last edited by <strong>bkloppenborg</strong> on 27 Jun 2008, 00:03)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p70495">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">bkloppenborg</div>
					<div class="post-datetime">
						4 Jul 2008, 23:29					</div>
				</div>
				<div class="post-content content">
					<p>Okay, using the pl2303 module from my WhiteRussian box did detect my adapter and create the hardware link to /dev/usb/tts/0.&nbsp; Even though the device was detected, when I tried to use the serial port, the router would become unresponsive.&nbsp; I have read that the driver from the 2.6 kernel correctly supports this device but I don&#039;t know how to backport the driver.&nbsp; </p><p>Do I simply copy the source code (pl2303.c, pl2303.h) files from the 2.6 kernel and use those in the 2.4 kernel or is there more to it?</p><p>Thanks.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p70537">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">bkloppenborg</div>
					<div class="post-datetime">
						6 Jul 2008, 08:50					</div>
				</div>
				<div class="post-content content">
					<p>After fiddling around a little, I added support for my pl2303 adapter to the kernel&#039;s patch file.&nbsp; After that I tried opening up a ppp connection over the serial port, here&#039;s what I got:</p><div class="codebox"><pre><code>user.info kernel: usbserial.c: PL-2303 converter now attached to ttyUSB0 (or usb/tts/0 for devfs)
user.info kernel: pl2303.c: Prolific PL2303 USB to serial adaptor driver v0.10.1
daemon.notice pppd[453]: pppd 2.4.3 started by root, uid 0
daemon.info pppd[453]: Using interface ppp0
daemon.notice pppd[453]: Connect: ppp0 &lt;--&gt; /dev/usb/tts/0
daemon.notice pppd[453]: local  IP address 192.168.2.20
daemon.notice pppd[453]: remote IP address 192.168.2.10
user.err kernel: usb-ohci.c: OHCI Unrecoverable Error, controller usb-00:03.0 disabled
user.err kernel: pl2303.c: pl2303_write - failed submitting write urb, error -143
user.err kernel: pl2303.c: pl2303_write - failed submitting write urb, error -143
user.err kernel: pl2303.c: pl2303_write - failed submitting write urb, error -143
user.err kernel: pl2303.c: pl2303_write - failed submitting write urb, error -143
user.err kernel: pl2303.c: pl2303_write - failed submitting write urb, error -143
daemon.info pppd[453]: No response to 5 echo-requests
daemon.notice pppd[453]: Serial link appears to be disconnected.
daemon.info pppd[453]: Connect time 0.3 minutes.
daemon.info pppd[453]: Sent 0 bytes, received 0 bytes.
user.err kernel: pl2303.c: pl2303_write - failed submitting write urb, error -143
user.err kernel: pl2303.c: pl2303_write - failed submitting write urb, error -143
daemon.notice pppd[453]: Connection terminated.
daemon.notice pppd[453]: Modem hangup
daemon.info pppd[453]: Exit.</code></pre></div><p>So I put the driver in debug mode and got</p><div class="codebox"><pre><code>user.info kernel: usbserial.c: USB Serial support registered for PL-2303
user.info kernel: usbserial.c: PL-2303 converter detected
user.debug kernel: pl2303.c: device type: 2
user.info kernel: usbserial.c: PL-2303 converter now attached to ttyUSB0 (or usb/tts/0 for devfs)
user.info kernel: pl2303.c: Prolific PL2303 USB to serial adaptor driver v0.10.1
user.debug kernel: pl2303.c: pl2303_open -  port 0
user.debug kernel: pl2303.c: 0xc0:0x1:0x8484:0x0  1 - 2
user.debug kernel: pl2303.c: 0x40:0x1:0x404:0x0  0
user.debug kernel: pl2303.c: 0xc0:0x1:0x8484:0x0  1 - 2
user.debug kernel: pl2303.c: 0xc0:0x1:0x8383:0x0  1 - 7b
user.debug kernel: pl2303.c: 0xc0:0x1:0x8484:0x0  1 - 2
user.debug kernel: pl2303.c: 0x40:0x1:0x404:0x1  0
user.debug kernel: pl2303.c: 0xc0:0x1:0x8484:0x0  1 - 2
user.debug kernel: pl2303.c: 0xc0:0x1:0x8383:0x0  1 - 6
user.debug kernel: pl2303.c: 0x40:0x1:0x0:0x1  0
user.debug kernel: pl2303.c: 0x40:0x1:0x1:0x0  0
user.debug kernel: pl2303.c: 0x40:0x1:0x2:0x44  0
user.debug kernel: pl2303.c: 0x40:0x1:0x8:0x0  0
user.debug kernel: pl2303.c: 0x40:0x1:0x9:0x0  0
user.debug kernel: pl2303.c: pl2303_set_termios -  port 0, initialized = 0
user.debug kernel: pl2303.c: 0xa1:0x21:0:0  7 - 80 25 0 0 0 0 0
user.debug kernel: pl2303.c: pl2303_set_termios - data bits = 8
user.debug kernel: pl2303.c: pl2303_set_termios - baud = 9600
user.debug kernel: pl2303.c: pl2303_set_termios - stop bits = 1
user.debug kernel: pl2303.c: pl2303_set_termios - parity = none
user.debug kernel: pl2303.c: 0x21:0x20:0:0  7
user.debug kernel: pl2303.c: set_control_lines - value = 3, retval = 0
user.debug kernel: pl2303.c: 0xa1:0x21:0:0  7 - 80 25 0 0 0 0 8
user.debug kernel: pl2303.c: pl2303_open - submitting read urb
user.debug kernel: pl2303.c: pl2303_open - submitting interrupt urb
user.debug kernel: pl2303.c: pl2303_ioctl (0) cmd = 0x540d
user.debug kernel: pl2303.c: pl2303_ioctl not supported = 0x540d
user.debug kernel: pl2303.c: pl2303_read_int_callback (0)
user.debug kernel: pl2303.c: pl2303_read_int_callback - length = 10, data = a1 20 00 00 00 00 02 00 83 00 
user.debug kernel: pl2303.c: pl2303_ioctl (0) cmd = 0x540f
user.debug kernel: pl2303.c: pl2303_ioctl not supported = 0x540f
user.debug kernel: pl2303.c: pl2303_set_termios -  port 0, initialized = 1
user.debug kernel: pl2303.c: 0xa1:0x21:0:0  7 - 80 25 0 0 0 0 8
user.debug kernel: pl2303.c: pl2303_set_termios - data bits = 8
user.debug kernel: pl2303.c: pl2303_set_termios - baud = 115200
user.debug kernel: pl2303.c: pl2303_set_termios - stop bits = 1
user.debug kernel: pl2303.c: pl2303_set_termios - parity = none
user.debug kernel: pl2303.c: 0x21:0x20:0:0  7
user.debug kernel: pl2303.c: 0xa1:0x21:0:0  7 - 0 c2 1 0 0 0 8
user.debug kernel: pl2303.c: pl2303_ioctl (0) cmd = 0x540d
user.debug kernel: pl2303.c: pl2303_ioctl not supported = 0x540d
user.debug kernel: pl2303.c: pl2303_close - port 0
user.debug kernel: pl2303.c: set_control_lines - value = 0, retval = 0
user.debug kernel: pl2303.c: pl2303_close - shutting down urbs
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - port 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - urb-&gt;status = -2
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - port is closed, exiting.
user.debug kernel: pl2303.c: pl2303_read_int_callback (0)
user.debug kernel: pl2303.c: pl2303_read_int_callback - urb shutting down with status: -2
daemon.notice pppd[451]: pppd 2.4.3 started by root, uid 0
user.debug kernel: pl2303.c: pl2303_open -  port 0
user.debug kernel: pl2303.c: 0xc0:0x1:0x8484:0x0  1 - 2
user.debug kernel: pl2303.c: 0x40:0x1:0x404:0x0  0
user.debug kernel: pl2303.c: 0xc0:0x1:0x8484:0x0  1 - 2
user.debug kernel: pl2303.c: 0xc0:0x1:0x8383:0x0  1 - 7b
user.debug kernel: pl2303.c: 0xc0:0x1:0x8484:0x0  1 - 2
user.debug kernel: pl2303.c: 0x40:0x1:0x404:0x1  0
user.debug kernel: pl2303.c: 0xc0:0x1:0x8484:0x0  1 - 2
user.debug kernel: pl2303.c: 0xc0:0x1:0x8383:0x0  1 - 6
user.debug kernel: pl2303.c: 0x40:0x1:0x0:0x1  0
user.debug kernel: pl2303.c: 0x40:0x1:0x1:0x0  0
user.debug kernel: pl2303.c: 0x40:0x1:0x2:0x44  0
user.debug kernel: pl2303.c: 0x40:0x1:0x8:0x0  0
user.debug kernel: pl2303.c: 0x40:0x1:0x9:0x0  0
user.debug kernel: pl2303.c: pl2303_set_termios -  port 0, initialized = 1
user.debug kernel: pl2303.c: 0xa1:0x21:0:0  7 - 0 c2 1 0 0 0 8
user.debug kernel: pl2303.c: pl2303_set_termios - data bits = 8
user.debug kernel: pl2303.c: pl2303_set_termios - baud = 115200
user.debug kernel: pl2303.c: pl2303_set_termios - stop bits = 1
user.debug kernel: pl2303.c: pl2303_set_termios - parity = none
user.debug kernel: pl2303.c: 0x21:0x20:0:0  7
user.debug kernel: pl2303.c: set_control_lines - value = 3, retval = 0
user.debug kernel: pl2303.c: 0xa1:0x21:0:0  7 - 0 c2 1 0 0 0 8
user.debug kernel: pl2303.c: pl2303_open - submitting read urb
user.debug kernel: pl2303.c: pl2303_open - submitting interrupt urb
user.debug kernel: pl2303.c: pl2303_ioctl (0) cmd = 0x741b
user.debug kernel: pl2303.c: pl2303_ioctl (0) TIOCMSET/TIOCMBIC/TIOCMSET
user.debug kernel: pl2303.c: set_control_lines - value = 3, retval = 0
user.debug kernel: pl2303.c: pl2303_ioctl (0) cmd = 0x540d
user.debug kernel: pl2303.c: pl2303_ioctl not supported = 0x540d
user.debug kernel: pl2303.c: pl2303_ioctl (0) cmd = 0x5410
user.debug kernel: pl2303.c: pl2303_ioctl not supported = 0x5410
user.debug kernel: pl2303.c: pl2303_set_termios -  port 0, initialized = 1
user.debug kernel: pl2303.c: 0xa1:0x21:0:0  7 - 0 c2 1 0 0 0 8
user.debug kernel: pl2303.c: pl2303_set_termios - data bits = 8
user.debug kernel: pl2303.c: pl2303_set_termios - baud = 115200
user.debug kernel: pl2303.c: pl2303_set_termios - stop bits = 1
user.debug kernel: pl2303.c: pl2303_set_termios - parity = none
user.debug kernel: pl2303.c: 0x21:0x20:0:0  7
user.debug kernel: pl2303.c: 0xa1:0x21:0:0  7 - 0 c2 1 0 0 0 8
user.debug kernel: pl2303.c: 0x40:0x1:0x0:0x61  0
user.debug kernel: pl2303.c: pl2303_ioctl (0) cmd = 0x40047437
user.debug kernel: pl2303.c: pl2303_ioctl not supported = 0x40047437
daemon.info pppd[451]: Using interface ppp0
daemon.notice pppd[451]: Connect: ppp0 &lt;--&gt; /dev/usb/tts/0
user.debug kernel: pl2303.c: pl2303_write - port 0, 39 bytes
user.debug kernel: pl2303.c: pl2303_write - length = 39, data = 7e ff 7d 23 c0 21 7d 21 7d 21 7d 20 7d 30 7d 22 7d 26 7d 20 7d 20 7d 20 7d 20 7d 25 7d 26 7d 3b 4e 67 6d 33 7d 32 7e 
user.debug kernel: pl2303.c: pl2303_write_bulk_callback - port 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - port 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - length = 1, data = 7e 
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - port 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - length = 13, data = ff 7d 23 c0 21 7d 21 7d 27 7d 20 7d 30 
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - port 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - length = 13, data = 7d 22 7d 26 7d 20 7d 20 7d 20 7d 20 7d 
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - port 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - length = 11, data = 25 7d 26 7d 25 2e 7c c9 67 50 7e 
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - port 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - length = 7, data = 7e ff 7d 23 c0 21 7d 
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
user.debug kernel: pl2303.c: pl2303_write - port 0, 38 bytes
user.debug kernel: pl2303.c: pl2303_write - length = 38, data = 7e ff 7d 23 c0 21 7d 22 7d 27 7d 20 7d 30 7d 22 7d 26 7d 20 7d 20 7d 20 7d 20 7d 25 7d 26 7d 25 2e 7c c9 46 ca 7e 
user.debug kernel: pl2303.c: pl2303_write_bulk_callback - port 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - port 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - length = 1, data = 22 
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - port 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - length = 10, data = 7d 21 7d 20 7d 30 7d 22 7d 26 
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - port 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - length = 12, data = 7d 20 7d 20 7d 20 7d 20 7d 25 7d 26 
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - port 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - length = 9, data = 7d 3b 4e 67 6d 7d 32 88 7e 
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
user.debug kernel: pl2303.c: pl2303_write - port 0, 15 bytes
user.debug kernel: pl2303.c: pl2303_write - length = 15, data = ff 03 c0 21 09 00 00 08 1b 4e 67 6d dc eb 7e 
user.debug kernel: pl2303.c: pl2303_write_bulk_callback - port 0
user.debug kernel: pl2303.c: pl2303_write - port 0, 23 bytes
user.debug kernel: pl2303.c: pl2303_write - length = 23, data = ff 03 80 21 01 01 00 10 02 06 00 2d 0f 01 03 06 c0 a8 02 14 f4 0e 7e 
user.debug kernel: pl2303.c: pl2303_write_bulk_callback - port 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - port 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - length = 1, data = ff 
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - port 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - length = 1, data = 03 
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - port 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - length = 1, data = 80 
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - port 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - length = 6, data = 21 01 07 00 10 02 
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - port 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - length = 12, data = 06 00 2d 0f 01 03 06 c0 a8 02 0a e6 
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - port 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - length = 12, data = 4f 7e ff 03 c0 21 0a 00 00 08 05 2e 
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - port 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - length = 11, data = 7c c9 b5 9b 7e ff 03 80 21 02 01 
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - port 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - length = 12, data = 00 10 02 06 00 2d 0f 01 03 06 c0 a8 
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - port 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - length = 5, data = 02 14 d5 94 7e 
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
user.debug kernel: pl2303.c: pl2303_write - port 0, 23 bytes
user.debug kernel: pl2303.c: pl2303_write - length = 23, data = ff 03 80 21 02 07 00 10 02 06 00 2d 0f 01 03 06 c0 a8 02 0a c7 d5 7e 
user.debug kernel: pl2303.c: pl2303_write_bulk_callback - port 0
daemon.notice pppd[451]: local  IP address 192.168.2.20
daemon.notice pppd[451]: remote IP address 192.168.2.10
user.debug kernel: pl2303.c: pl2303_write - port 0, 15 bytes
user.debug kernel: pl2303.c: pl2303_write - length = 15, data = ff 03 c0 21 09 01 00 08 1b 4e 67 6d 09 74 7e 
user.debug kernel: pl2303.c: pl2303_write_bulk_callback - port 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - port 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - length = 1, data = 7e 
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - port 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - length = 6, data = ff 03 c0 21 0a 01 
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - port 0
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - length = 9, data = 00 08 05 2e 7c c9 60 04 7e 
user.debug kernel: pl2303.c: pl2303_read_bulk_callback - tty_flag = 0
user.err kernel: usb-ohci.c: OHCI Unrecoverable Error, controller usb-00:03.0 disabled
user.debug kernel: pl2303.c: pl2303_write - port 0, 16 bytes
user.debug kernel: pl2303.c: pl2303_write - length = 16, data = 7e ff 03 c0 21 09 02 00 08 1b 4e 67 6d 67 dc 7e 
user.err kernel: pl2303.c: pl2303_write - failed submitting write urb, error -143
user.debug kernel: pl2303.c: pl2303_write - port 0, 16 bytes
user.debug kernel: pl2303.c: pl2303_write - length = 16, data = 7e ff 03 c0 21 09 03 00 08 1b 4e 67 6d b2 43 7e 
user.err kernel: pl2303.c: pl2303_write - failed submitting write urb, error -143
user.debug kernel: pl2303.c: pl2303_write - port 0, 16 bytes
user.debug kernel: pl2303.c: pl2303_write - length = 16, data = 7e ff 03 c0 21 09 04 00 08 1b 4e 67 6d aa 84 7e 
user.err kernel: pl2303.c: pl2303_write - failed submitting write urb, error -143
user.debug kernel: pl2303.c: pl2303_write - port 0, 16 bytes
user.debug kernel: pl2303.c: pl2303_write - length = 16, data = 7e ff 03 c0 21 09 05 00 08 1b 4e 67 6d 7f 1b 7e 
user.err kernel: pl2303.c: pl2303_write - failed submitting write urb, error -143
user.debug kernel: pl2303.c: pl2303_write - port 0, 16 bytes
user.debug kernel: pl2303.c: pl2303_write - length = 16, data = 7e ff 03 c0 21 09 06 00 08 1b 4e 67 6d 11 b3 7e 
user.err kernel: pl2303.c: pl2303_write - failed submitting write urb, error -143
daemon.info pppd[451]: No response to 5 echo-requests
daemon.notice pppd[451]: Serial link appears to be disconnected.
daemon.info pppd[451]: Connect time 0.2 minutes.
daemon.info pppd[451]: Sent 0 bytes, received 0 bytes.
user.debug kernel: pl2303.c: pl2303_write - port 0, 36 bytes
user.debug kernel: pl2303.c: pl2303_write - length = 36, data = 7e ff 7d 23 c0 21 7d 25 7d 22 7d 20 7d 37 50 65 65 72 20 6e 6f 74 20 72 65 73 70 6f 6e 64 69 6e 67 2e 50 7e 
user.err kernel: pl2303.c: pl2303_write - failed submitting write urb, error -143
user.debug kernel: pl2303.c: pl2303_write - port 0, 36 bytes
user.debug kernel: pl2303.c: pl2303_write - length = 36, data = 7e ff 7d 23 c0 21 7d 25 7d 23 7d 20 7d 37 50 65 65 72 20 6e 6f 74 20 72 65 73 70 6f 6e 64 69 6e 67 73 f9 7e 
user.err kernel: pl2303.c: pl2303_write - failed submitting write urb, error -143
daemon.notice pppd[451]: Connection terminated.
user.debug kernel: pl2303.c: pl2303_ioctl (0) cmd = 0x5407
user.debug kernel: pl2303.c: pl2303_ioctl not supported = 0x5407
daemon.notice pppd[451]: Modem hangup
user.debug kernel: pl2303.c: pl2303_ioctl (0) cmd = 0x741c
user.debug kernel: pl2303.c: pl2303_ioctl (0) TIOCMSET/TIOCMBIC/TIOCMSET
user.debug kernel: pl2303.c: set_control_lines - value = 2, retval = -143
daemon.info pppd[451]: Exit.
user.debug kernel: pl2303.c: pl2303_ioctl (0) cmd = 0x5410
user.debug kernel: pl2303.c: pl2303_ioctl not supported = 0x5410
user.debug kernel: pl2303.c: pl2303_set_termios -  port 0, initialized = 1
user.debug kernel: pl2303.c: 0xa1:0x21:0:0  -143 - 0 0 0 0 0 0 0
user.debug kernel: pl2303.c: pl2303_set_termios - data bits = 8
user.debug kernel: pl2303.c: pl2303_set_termios - baud = 115200
user.debug kernel: pl2303.c: pl2303_set_termios - stop bits = 1
user.debug kernel: pl2303.c: pl2303_set_termios - parity = none
user.debug kernel: pl2303.c: 0x21:0x20:0:0  -143
user.debug kernel: pl2303.c: set_control_lines - value = 3, retval = -143
user.debug kernel: pl2303.c: 0xa1:0x21:0:0  -143 - 0 0 0 0 0 0 0
user.debug kernel: pl2303.c: pl2303_close - port 0
user.debug kernel: pl2303.c: set_control_lines - value = 0, retval = -143
user.debug kernel: pl2303.c: pl2303_close - shutting down urbs</code></pre></div><p>It looks like everything is going fine until the OHCI module kills the port.&nbsp; This problem is reported by <a href="http://forum.openwrt.org/viewtopic.php?pid=66506#p66506">others as well</a> with indications that the error is fixed in the 2.6 kernel (built with no wifi support).&nbsp; I&#039;m building that version at the moment to see if it indeed works.</p><p>Edit: Tried the 2.6 kernel built from trunk without WiFi support as&nbsp; <a href="http://forum.openwrt.org/viewtopic.php?pid=66506#p66506">suggested</a> however it doesn&#039;t work.&nbsp; Looks like we&#039;re stuck with 2.4 for now.</p>											<p class="post-edited">(Last edited by <strong>bkloppenborg</strong> on 8 Jul 2008, 17:51)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p70540">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">johnrw</div>
					<div class="post-datetime">
						6 Jul 2008, 10:37					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I&#039;m no expert... but these look bad...<br />Jan&nbsp; 1 00:01:50 OpenWrt user.debug kernel: pl2303.c: pl2303_read_bulk_callback - urb-&gt;status = -2<br />Jan&nbsp; 1 00:01:50 OpenWrt user.debug kernel: pl2303.c: pl2303_read_bulk_callback - port is closed, exiting.</p><p>because of these ... pl2303_ioctl not supported = 0x540d, there are quite a few.</p><p>02:03 OpenWrt user.debug kernel: pl2303.c: pl2303_ioctl (0) TIOCMSET/TIOCMBIC/TIOCMSET<br />Jan&nbsp; 1 00:02:03 OpenWrt user.debug kernel: pl2303.c: set_control_lines - value = 3, retval = 0<br />Jan&nbsp; 1 00:02:03 OpenWrt user.debug kernel: pl2303.c: pl2303_ioctl (0) cmd = 0x540d<br />Jan&nbsp; 1 00:02:03 OpenWrt user.debug kernel: pl2303.c: pl2303_ioctl not supported = 0x540d<br />Jan&nbsp; 1 00:02:03 OpenWrt user.debug kernel: pl2303.c: pl2303_ioctl (0) cmd = 0x5410<br />Jan&nbsp; 1 00:02:03 OpenWrt user.debug kernel: pl2303.c: pl2303_ioctl not supported = 0x5410</p><p>Googling &quot;ioctl not supported =&quot;<br />It looks like you are using a driver that uses&nbsp; TIOCMSET/TIOCMBIC/TIOCMSET... ioctls.</p><p>I&#039;d say things are really colliding once you try and use the usb side of things.<br />It&#039;s a serial port emulator on usb hardware.<br />I could be wrong.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p70652">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">bkloppenborg</div>
					<div class="post-datetime">
						8 Jul 2008, 18:15					</div>
				</div>
				<div class="post-content content">
					<p>Well, those don&#039;t seem to be too much of an issue since the PPP connection is negotiated correctly even though those error are present.&nbsp; Who knows, perhaps you&#039;re right.&nbsp; While digging around, I found a <a href="http://www.ussg.iu.edu/hypermail/linux/kernel/9801.2/0999.html">kernel patch</a> that has the commands that error out defined:</p><div class="codebox"><pre><code>#define TIOCNXCL 0x540D
...
#define TIOCSPGRP 0x5410</code></pre></div><p>Sadly, 0x40047437 is not listed.&nbsp; Now there is a <a href="https://dev.openwrt.org/cgi-bin/trac.fcgi/ticket/3245">bug (#3245)</a> that has been reported with the TIOCNXCL command by a user with the WL-500gp (v1) router so perhaps that will get fixed.</p><p>In looking through the logs again, the line that reads</p><div class="codebox"><pre><code>OHCI Unrecoverable Error, controller usb-00:03.0 disabled</code></pre></div><p>is probably the sticking point.&nbsp; From reading other posts on the &quot;OHCI Unrecoverable Error, controller * disabled&quot; messages, it is often due to a DMA problem.&nbsp; I don&#039;t suppose any of the developers could comment on what could be done (if anything) or if they know of a resource that I could read to patch it myself?</p><p>I found another thread that discusses the USB OHCI problem noted above.&nbsp; It is found <a href="http://forum.openwrt.org/viewtopic.php?id=15196">here</a>.</p>											<p class="post-edited">(Last edited by <strong>bkloppenborg</strong> on 23 Jul 2008, 00:33)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p89832">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">bkloppenborg</div>
					<div class="post-datetime">
						13 Jun 2009, 20:17					</div>
				</div>
				<div class="post-content content">
					<p>For completeness I tried svn version 16426 today and no longer have this problem.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>