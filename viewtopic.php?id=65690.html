<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> iptv stops after a few seconds</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 30 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p329049">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Cylac</div>
					<div class="post-datetime">
						19 Jun 2016, 19:46					</div>
				</div>
				<div class="post-content content">
					<p>I managed to get both my internet (vlan 35) and iptv (vlan 36) from my FTTH (Bell Fibe) service working on OpenWRT! Yay!</p><p>The only prob I have now is after a few seconds of switching tv channels the signal freezes. If I switch channels the same thing occurs after roughly the same amount of time. </p><p>I&#039;ve also noticed at times that everything seems to freeze network wise (can&#039;t surf) and that I have to reboot my router to get going again. (flooding?)</p><p>It was suggested to me that it must be a multicasting issue, however I can&#039;t see what the issue could be.</p><p>Any ideas?</p><p><strong>/etc/config/igmpproxy</strong> (I also noticed there&#039;s a /etc/igmpproxy.conf file. Is that file being used for anything?)<br /></p><div class="codebox"><pre><code>config igmpproxy
        option quickleave 1

config phyint wan
        option network iptv
        option direction upstream
        list altnet 0.0.0.0/0

config phyint lan
        option network lan
        option direction downstream
        list altnet 192.168.10.0/24        #same subnet with your LAN subnet</code></pre></div><p><strong>Note:</strong> I had tried just putting <strong>br-lan</strong> instead of <strong>lan</strong> and it didn&#039;t seem to make a difference.</p><p><strong>/etc/config/network</strong><br /></p><div class="codebox"><pre><code>config interface &#039;loopback&#039;
    option ifname &#039;lo&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;127.0.0.1&#039;
    option netmask &#039;255.0.0.0&#039;

config globals &#039;globals&#039;
    option ula_prefix &#039;fd1a:50f0:2558::/48&#039;

config interface &#039;lan&#039;
    option force_link &#039;1&#039;
    option type &#039;bridge&#039;
    option proto &#039;static&#039;
    option netmask &#039;255.255.255.0&#039;
    option ip6assign &#039;60&#039;
    option ipaddr &#039;192.168.10.1&#039;
    option igmp_snooping &#039;1&#039;
    option ifname &#039;eth1.1&#039;

config interface &#039;wan&#039;
    option ifname &#039;eth0.35&#039;
    option proto &#039;pppoe&#039;
    option username &#039;xxxxxxx&#039;
    option password &#039;xxxxxxxx&#039;

config interface &#039;wan6&#039;
    option proto &#039;dhcpv6&#039;
    option ifname &#039;eth0.37&#039;
    option reqaddress &#039;try&#039;
    option reqprefix &#039;auto&#039;

config interface &#039;iptv&#039;
    option ifname &#039;eth0.36 eth1.2&#039;
    option type &#039;bridge&#039;
    option proto &#039;dhcp&#039;
    option delegate &#039;0&#039;
    option broadcast &#039;1&#039;

config switch
    option name &#039;switch0&#039;
    option reset &#039;1&#039;
    option enable_vlan &#039;1&#039;
    option mirror_source_port &#039;0&#039;
    option mirror_monitor_port &#039;0&#039;

config switch_vlan
    option device &#039;switch0&#039;
    option vlan &#039;1&#039;
    option vid &#039;1&#039;
    option ports &#039;0 2 3&#039; #External port 1 and 2 for internet

config switch_vlan
    option device &#039;switch0&#039;
    option vlan &#039;2&#039;
    option vid &#039;2&#039;
    option ports &#039;1 6&#039;

config switch_vlan
    option device &#039;switch0&#039;
    option vlan &#039;35&#039;
    option vid &#039;35&#039;
    option ports &#039;1t 6t&#039;

config switch_vlan
    option device &#039;switch0&#039;
    option vlan &#039;36&#039;
    option vid &#039;36&#039;
    option ports &#039;1t 4 5 6t&#039; #External port 3 and 4 for IPTV receivers

config switch_vlan
    option device &#039;switch0&#039;
    option vlan &#039;37&#039;
    option vid &#039;37&#039;
    option ports &#039;1t 6t&#039;</code></pre></div><p><strong>/etc/config/firewall</strong><br /></p><div class="codebox"><pre><code>config rule
    option name &#039;Allow-DHCP-Renew-iptv&#039;
    option src &#039;iptv&#039;
    option proto &#039;udp&#039;
    option dest_port &#039;68&#039;
    option target &#039;ACCEPT&#039;
    option family &#039;ipv4&#039;

config rule
    option name &#039;Allow-Ping-iptv&#039;
    option src &#039;iptv&#039;
    option proto &#039;icmp&#039;
    option icmp_type &#039;echo-request&#039;
    option family &#039;ipv4&#039;
    option target &#039;ACCEPT&#039;

config zone
    option name &#039;iptv&#039;
    option output &#039;ACCEPT&#039;
    option network &#039;iptv&#039;
    option family &#039;ipv4&#039;
    option masq &#039;1&#039;
    option log &#039;1&#039;
    option input &#039;ACCEPT&#039;
    option forward &#039;ACCEPT&#039;

config rule
    option src &#039;iptv&#039;
    option proto &#039;igmp&#039;
    option target &#039;ACCEPT&#039;

config rule
    option src &#039;iptv&#039;
    option proto &#039;udp&#039;
    option dest &#039;lan&#039;
    option dest_ip &#039;224.0.0.0/4&#039;
    option target &#039;ACCEPT&#039;</code></pre></div><p>I also added this line to <strong>/etc/sysctl.conf</strong><br /></p><div class="codebox"><pre><code>net.ipv4.conf.all.force_igmp_version=2</code></pre></div><p>Ideally I&#039;d like both the computers/wifi/etc and receivers to all be on the same network.. but I think that&#039;ll just cause more issues. Right now the receivers hooked up on ports 3 and 4 get 10.x.x.x ips assigned to it by my providers DHCP server (vlan 36). My internet/wifi/etc is on ports 1 and 2.</p><p>Thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p329063">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">johndoe</div>
					<div class="post-datetime">
						19 Jun 2016, 21:20					</div>
				</div>
				<div class="post-content content">
					<p>There are many duplicates of this thread, you can delete them by pressing the &quot;Delete topic&quot; button at the bottom right of each post.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p329070">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Max Hopper</div>
					<div class="post-datetime">
						19 Jun 2016, 22:03					</div>
				</div>
				<div class="post-content content">
					<p>Is the consumer grade router&#039;s CPU suitable for the traffic?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p330159">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Cylac</div>
					<div class="post-datetime">
						29 Jun 2016, 22:33					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Max Hopper wrote:</cite><blockquote><p>Is the consumer grade router&#039;s CPU suitable for the traffic?</p></blockquote></div><p>I would think so..</p><p>I have a TP-LINK Archer C7 V2</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p330214">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">nague</div>
					<div class="post-datetime">
						30 Jun 2016, 19:58					</div>
				</div>
				<div class="post-content content">
					<p>Hi Cylac,</p><p>Why do you have 2 physicals interfaces map on iptv ?<br />config interface &#039;iptv&#039;<br />&nbsp; &nbsp; option ifname &#039;eth0.36 eth1.2&#039;</p><p>Eth1.2 is your iptv lan side, right ?</p><p>Can you provide a tcpdump log for igmp for wan and lan, when the issue occurs:<br />tcpdump -i eth0.36 igmp<br />tcpdump -i eth1.2 igmp</p>											<p class="post-edited">(Last edited by <strong>nague</strong> on 30 Jun 2016, 19:58)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p330217">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">Cylac</div>
					<div class="post-datetime">
						30 Jun 2016, 20:58					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nague wrote:</cite><blockquote><p>Hi Cylac,</p><p>Why do you have 2 physicals interfaces map on iptv ?<br />config interface &#039;iptv&#039;<br />&nbsp; &nbsp; option ifname &#039;eth0.36 eth1.2&#039;</p><p>Eth1.2 is your iptv lan side, right ?</p><p>Can you provide a tcpdump log for igmp for wan and lan, when the issue occurs:<br />tcpdump -i eth0.36 igmp<br />tcpdump -i eth1.2 igmp</p></blockquote></div><p>Hi nague,</p><p>Yes Eth1.2 is my iptv lan side. I probably bridged the 2 together when I was testing stuff out.</p><p>I know that my iptv receivers need both the IPTV signal and internet feed to work properly. This is why I was trying to get these receivers to work on the same lan as my computers/wifi/etc.</p><p>I will gather those logs for you and post them later today!</p><p>thanks for taking the time to reply and help! <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p330253">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">nague</div>
					<div class="post-datetime">
						1 Jul 2016, 11:38					</div>
				</div>
				<div class="post-content content">
					<p>Cylac, quick questions:<br />- Do you have multiple iptv receivers ?<br />- Is your iptv receivers multi-homed ? (one ip interface for iptv, one for internet/lan access ?)<br />- eth0.36 get ip address on from you provider (by DHCP) ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p330517">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">Cylac</div>
					<div class="post-datetime">
						5 Jul 2016, 06:26					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nague wrote:</cite><blockquote><p>Can you provide a tcpdump log for igmp for wan and lan, when the issue occurs:<br />tcpdump -i eth0.36 igmp<br />tcpdump -i eth1.2 igmp</p></blockquote></div><div class="codebox"><pre><code>tcpdump -i eth0.36 igmp
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on eth0.36, link-type EN10MB (Ethernet), capture size 65535 bytes
23:06:39.784332 IP 0.0.0.0 &gt; all-systems.mcast.net: igmp query v2
23:08:44.779121 IP 0.0.0.0 &gt; all-systems.mcast.net: igmp query v2
23:10:49.762613 IP 0.0.0.0 &gt; all-systems.mcast.net: igmp query v2
23:12:54.752803 IP 0.0.0.0 &gt; all-systems.mcast.net: igmp query v2</code></pre></div><p>I got rid of eth1.2. I placed my iptv interface on eth0.36 only.<br />I placed all my network ports on vlan 1<br />So my LAN interface is set to eth1.1</p><p>I changed my igmpproxy to this:<br /></p><div class="codebox"><pre><code>config igmpproxy
        option quickleave 1

config phyint
        option network iptv
        option direction upstream
        list altnet 0.0.0.0/0

config phyint
        option network lan
        option direction downstream
        list altnet 192.168.1.0/24</code></pre></div><div class="quotebox"><cite>nague wrote:</cite><blockquote><p>Cylac, quick questions:<br />- Do you have multiple iptv receivers ?<br />- Is your iptv receivers multi-homed ? (one ip interface for iptv, one for internet/lan access ?)<br />- eth0.36 get ip address on from you provider (by DHCP) ?</p></blockquote></div><p>Yes I do have multiple receivers. 1 is hooked up via ethernet directly connected to my router and another is wireless.<br />While testing I&#039;m only using the one connected via ethernet. (the WholeHomePVR receiver)<br />From what I can tell my receivers get an ip address for my providers dhcp server.<br />eth0.36 does get a private ip address assigned to it from my provider.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p330521">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">Cylac</div>
					<div class="post-datetime">
						5 Jul 2016, 07:38					</div>
				</div>
				<div class="post-content content">
					<p>got some better log results this time!</p><div class="codebox"><pre><code>tcpdump -i eth0.36 igmp
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on eth0.36, link-type EN10MB (Ethernet), capture size 65535 bytes
00:23:44.596996 IP 0.0.0.0 &gt; all-systems.mcast.net: igmp query v2
00:25:49.586072 IP 0.0.0.0 &gt; all-systems.mcast.net: igmp query v2
00:26:37.253674 IP 10.146.71.97 &gt; igmp.mcast.net: igmp v3 report, 1 group record(s)
00:26:37.554302 IP 10.146.71.97 &gt; igmp.mcast.net: igmp v3 report, 1 group record(s)
00:26:37.917984 IP 10.146.71.97 &gt; igmp.mcast.net: igmp v3 report, 1 group record(s)
00:26:38.419216 IP 10.146.71.97 &gt; igmp.mcast.net: igmp v3 report, 1 group record(s)
00:27:54.570547 IP 0.0.0.0 &gt; all-systems.mcast.net: igmp query v2
00:29:40.780762 IP 10.146.71.97 &gt; igmp.mcast.net: igmp v3 report, 1 group record(s)
00:29:40.782839 IP 10.146.71.97 &gt; igmp.mcast.net: igmp v3 report, 1 group record(s)
00:29:41.605010 IP 10.146.71.97 &gt; igmp.mcast.net: igmp v3 report, 1 group record(s)
00:29:59.556857 IP 0.0.0.0 &gt; all-systems.mcast.net: igmp query v2
00:32:04.546562 IP 0.0.0.0 &gt; all-systems.mcast.net: igmp query v2
00:32:40.790359 IP 10.146.71.97 &gt; igmp.mcast.net: igmp v3 report, 1 group record(s)
00:32:40.791980 IP 10.146.71.97 &gt; igmp.mcast.net: igmp v3 report, 1 group record(s)
00:32:41.787804 IP 10.146.71.97 &gt; igmp.mcast.net: igmp v3 report, 1 group record(s)
00:34:09.537948 IP 0.0.0.0 &gt; all-systems.mcast.net: igmp query v2
00:35:40.802649 IP 10.146.71.97 &gt; igmp.mcast.net: igmp v3 report, 1 group record(s)
00:35:40.804512 IP 10.146.71.97 &gt; igmp.mcast.net: igmp v3 report, 1 group record(s)
00:35:41.469193 IP 10.146.71.97 &gt; igmp.mcast.net: igmp v3 report, 1 group record(s)
00:36:00.149569 IP 10.146.71.97 &gt; igmp.mcast.net: igmp v3 report, 1 group record(s)
00:36:00.989151 IP 10.146.71.97 &gt; igmp.mcast.net: igmp v3 report, 1 group record(s)
00:36:09.145604 IP 10.146.71.97 &gt; igmp.mcast.net: igmp v3 report, 1 group record(s)
00:36:09.998860 IP 10.146.71.97 &gt; igmp.mcast.net: igmp v3 report, 1 group record(s)
00:36:14.572796 IP 0.0.0.0 &gt; all-systems.mcast.net: igmp query v2
00:36:18.889828 IP 10.146.71.97 &gt; igmp.mcast.net: igmp v3 report, 1 group record(s)
00:36:19.507627 IP 10.146.71.97 &gt; igmp.mcast.net: igmp v3 report, 1 group record(s)</code></pre></div><p>so when I switch to a channel.. I get a picture for a few seconds.. then it freezes.. if I switch channels.. it works for a few seconds again.. then freezes... etc etc etc</p>											<p class="post-edited">(Last edited by <strong>Cylac</strong> on 5 Jul 2016, 07:39)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p330562">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">nague</div>
					<div class="post-datetime">
						5 Jul 2016, 19:03					</div>
				</div>
				<div class="post-content content">
					<p>Hi Cylac,</p><p>If you have multiple receivers, you should definitely forget the bridge solution. </p><p>Another point, you’ll never manage to send IPTV over wifi, you’ll freeze the radio. Basically, providers who allow STB over wifi are using unicast tunnel encapsulation to avoid broadcasting packets over the air. And most of time, they also switch to TCP to allow retransmission. The udpxy package can do the job (http encapsulation for udp iptv), but your receivers have to be compatible with http streams.</p><p>At this time, let’s focus on the wired receiver. In my understanding, you should stay with your current lan interface (eth1.1) for both, internet and iptv.</p><p>For the iptv wan interface, you can keep in etc/config/network :<br /></p><div class="codebox"><pre><code>config interface &#039;iptv&#039;
    option ifname &#039;eth0.36&#039;
    option proto &#039;dhcp&#039;
    option defaultroute &#039;0&#039;</code></pre></div><p>and:</p><div class="codebox"><pre><code>config route
        option interface &#039;iptv&#039;
        option target &#039;224.0.0.0&#039;
        option netmask &#039;240.0.0.0&#039;
        option gateway &#039;0.0.0.0&#039;</code></pre></div><p>In the firewall (/etc/config/firewall), you can use this template:</p><div class="codebox"><pre><code>config zone
        option name             &#039;tv&#039;
        option network          &#039;iptv&#039;
        option input            &#039;REJECT&#039;
        option output           &#039;ACCEPT&#039;
        option forward          &#039;REJECT&#039;
        option masq             &#039;1&#039;

config rule
        option src &#039;tv&#039;
        option proto &#039;udp&#039;
        option dest &#039;lan&#039;
        option dest_ip &#039;224.0.0.0/4&#039;
        option target &#039;ACCEPT&#039;

config rule
        option src &#039;tv&#039;
        option proto &#039;igmp&#039;
        option target &#039;ACCEPT&#039;</code></pre></div><p>In case your receivers need unicast routing over iptv wan (this the case here in france with Orange and Bouygues Telecom) :</p><div class="codebox"><pre><code>config forwarding
        option src              lan
        option dest             tv</code></pre></div><p>(if your provider is not using dhcp option 131 to give you routes, you’ll need to specify them in the network configuration)</p><p>Regarding the igmpproxy, I can see in the wireshark log igmpv3 reports, and igmpv2 queries from network. I’m not sure igmproxy is comfortable with both igmp version. You should try mcproxy instead. Here the correct configuration:</p><p>For /etc/config/mcproxy:<br /></p><div class="codebox"><pre><code># Use your own MCProxy config file
config mcproxy &#039;mcproxy_file&#039;
        option disabled &#039;0&#039;
        option respawn &#039;1&#039;
        option file &#039;/etc/mcproxy.conf&#039;

# Use OpenWrt UCI config
config mcproxy &#039;mcproxy&#039;
        option disabled &#039;1&#039;
        option respawn &#039;1&#039;
        option protocol &#039;IGMPv2&#039;</code></pre></div><p>For /etc/mcproxy.conf:<br /></p><div class="codebox"><pre><code>######################################
##-- mcproxy configuration script --##
######################################

# Protocol: IGMPv1|IGMPv2|IGMPv3 (IPv4) - MLDv1|MLDv2 (IPv6)
protocol IGMPv3;

###########################################
# Proxy Instance: upstream ==&gt; downstream
pinstance C: &quot;eth0.36&quot; ==&gt; &quot;br-lan&quot;;
###########################################</code></pre></div><p>(keep Tables and Instance Behaviour for future usage)</p>											<p class="post-edited">(Last edited by <strong>nague</strong> on 5 Jul 2016, 19:06)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p330565">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">Cylac</div>
					<div class="post-datetime">
						5 Jul 2016, 19:49					</div>
				</div>
				<div class="post-content content">
					<p>Hi nague,</p><p>Just a few questions before I commit all these changes:</p><p>1. for the /etc/config/mcproxy file, do I delete all the lines after the configs you provided? I see there&#039;s a bunch of samples listed.<br />2. How to I make sure mcproxy is being used over igmpproxy? Is there any other configs I have to make? Should I disable igmpproxy?</p><p>Here are my config files for verification I configured them properly <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>/etc/config/network<br /></p><div class="codebox"><pre><code>config interface &#039;loopback&#039;
    option ifname &#039;lo&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;127.0.0.1&#039;
    option netmask &#039;255.0.0.0&#039;

config globals &#039;globals&#039;
    option ula_prefix &#039;fdd7:68f9:5948::/48&#039;

config interface &#039;lan&#039;
    option ifname &#039;eth1.1&#039;
    option force_link &#039;1&#039;
    option type &#039;bridge&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;192.168.1.1&#039;
    option netmask &#039;255.255.255.0&#039;
    option ip6assign &#039;60&#039;
    option igmp_snooping &#039;1&#039;

config interface &#039;IPTV&#039;
    option proto &#039;dhcp&#039;
    option ifname &#039;eth0.36&#039;
    option defaultroute &#039;0&#039;

config interface &#039;wan&#039;
    option proto &#039;pppoe&#039;
    option ifname &#039;eth0.35&#039;
    option username &#039;***************&#039;
    option password &#039;**************&#039;
    option peerdns &#039;0&#039;
    option dns &#039;208.67.222.222 208.67.220.220 8.8.8.8&#039; #OpenDNS and Google Public DNS

config interface &#039;wan6&#039;
    option proto &#039;dhcpv6&#039;
    option ifname &#039;eth0.37&#039;
    option reqaddress &#039;try&#039;
    option reqprefix &#039;auto&#039;

config switch
    option name &#039;switch0&#039;
    option reset &#039;1&#039;
    option enable_vlan &#039;1&#039;
    option mirror_source_port &#039;0&#039;
    option mirror_monitor_port &#039;0&#039;

config switch_vlan
    option device &#039;switch0&#039;
    option vlan &#039;1&#039;
    option vid &#039;1&#039;
    option ports &#039;0t 2 3 4 5&#039;

config switch_vlan
    option device &#039;switch0&#039;
    option vlan &#039;2&#039;
    option vid &#039;2&#039;

config switch_vlan
    option device &#039;switch0&#039;
    option vlan &#039;35&#039;
    option ports &#039;1t 6t&#039;
    option vid &#039;35&#039;

config switch_vlan
    option device &#039;switch0&#039;
    option vlan &#039;36&#039;
    option vid &#039;36&#039;
    option ports &#039;1t 6t&#039;

config switch_vlan
    option device &#039;switch0&#039;
    option vlan &#039;37&#039;
    option vid &#039;37&#039;
    option ports &#039;1t 6t&#039;

config route
        option interface &#039;iptv&#039;
        option target &#039;224.0.0.0&#039;
        option netmask &#039;240.0.0.0&#039;
        option gateway &#039;0.0.0.0&#039;</code></pre></div><p>/etc/config/firewall<br /></p><div class="codebox"><pre><code>config defaults
    option syn_flood &#039;1&#039;
    option input &#039;ACCEPT&#039;
    option output &#039;ACCEPT&#039;
    option forward &#039;REJECT&#039;

config zone
    option name &#039;lan&#039;
    option input &#039;ACCEPT&#039;
    option output &#039;ACCEPT&#039;
    option forward &#039;ACCEPT&#039;
    option network &#039;lan&#039;

config zone
    option name &#039;wan&#039;
    option input &#039;REJECT&#039;
    option output &#039;ACCEPT&#039;
    option forward &#039;REJECT&#039;
    option masq &#039;1&#039;
    option mtu_fix &#039;1&#039;
    option network &#039;wan wan6&#039;

config forwarding
    option src &#039;lan&#039;
    option dest &#039;wan&#039;

config rule
    option name &#039;Allow-DHCP-Renew&#039;
    option src &#039;wan&#039;
    option proto &#039;udp&#039;
    option dest_port &#039;68&#039;
    option target &#039;ACCEPT&#039;
    option family &#039;ipv4&#039;

config rule
    option name &#039;Allow-Ping&#039;
    option src &#039;wan&#039;
    option proto &#039;icmp&#039;
    option icmp_type &#039;echo-request&#039;
    option family &#039;ipv4&#039;
    option target &#039;ACCEPT&#039;

config rule
    option name &#039;Allow-IGMP&#039;
    option src &#039;wan&#039;
    option proto &#039;igmp&#039;
    option family &#039;ipv4&#039;
    option target &#039;ACCEPT&#039;

config rule
    option name &#039;Allow-DHCPv6&#039;
    option src &#039;wan&#039;
    option proto &#039;udp&#039;
    option src_ip &#039;fe80::/10&#039;
    option src_port &#039;547&#039;
    option dest_ip &#039;fe80::/10&#039;
    option dest_port &#039;546&#039;
    option family &#039;ipv6&#039;
    option target &#039;ACCEPT&#039;

config rule
    option name &#039;Allow-MLD&#039;
    option src &#039;wan&#039;
    option proto &#039;icmp&#039;
    option src_ip &#039;fe80::/10&#039;
    list icmp_type &#039;130/0&#039;
    list icmp_type &#039;131/0&#039;
    list icmp_type &#039;132/0&#039;
    list icmp_type &#039;143/0&#039;
    option family &#039;ipv6&#039;
    option target &#039;ACCEPT&#039;

config rule
    option name &#039;Allow-ICMPv6-Input&#039;
    option src &#039;wan&#039;
    option proto &#039;icmp&#039;
    list icmp_type &#039;echo-request&#039;
    list icmp_type &#039;echo-reply&#039;
    list icmp_type &#039;destination-unreachable&#039;
    list icmp_type &#039;packet-too-big&#039;
    list icmp_type &#039;time-exceeded&#039;
    list icmp_type &#039;bad-header&#039;
    list icmp_type &#039;unknown-header-type&#039;
    list icmp_type &#039;router-solicitation&#039;
    list icmp_type &#039;neighbour-solicitation&#039;
    list icmp_type &#039;router-advertisement&#039;
    list icmp_type &#039;neighbour-advertisement&#039;
    option limit &#039;1000/sec&#039;
    option family &#039;ipv6&#039;
    option target &#039;ACCEPT&#039;

config rule
    option name &#039;Allow-ICMPv6-Forward&#039;
    option src &#039;wan&#039;
    option dest &#039;*&#039;
    option proto &#039;icmp&#039;
    list icmp_type &#039;echo-request&#039;
    list icmp_type &#039;echo-reply&#039;
    list icmp_type &#039;destination-unreachable&#039;
    list icmp_type &#039;packet-too-big&#039;
    list icmp_type &#039;time-exceeded&#039;
    list icmp_type &#039;bad-header&#039;
    list icmp_type &#039;unknown-header-type&#039;
    option limit &#039;1000/sec&#039;
    option family &#039;ipv6&#039;
    option target &#039;ACCEPT&#039;

config include
    option path &#039;/etc/firewall.user&#039;

config rule
    option src &#039;wan&#039;
    option dest &#039;lan&#039;
    option proto &#039;esp&#039;
    option target &#039;ACCEPT&#039;

config rule
    option src &#039;wan&#039;
    option dest &#039;lan&#039;
    option dest_port &#039;500&#039;
    option proto &#039;udp&#039;
    option target &#039;ACCEPT&#039;

config zone
        option name             &#039;tv&#039;
        option network          &#039;iptv&#039;
        option input            &#039;REJECT&#039;
        option output           &#039;ACCEPT&#039;
        option forward          &#039;REJECT&#039;
        option masq             &#039;1&#039;

config rule
        option src &#039;tv&#039;
        option proto &#039;udp&#039;
        option dest &#039;lan&#039;
        option dest_ip &#039;224.0.0.0/4&#039;
        option target &#039;ACCEPT&#039;

config rule
        option src &#039;tv&#039;
        option proto &#039;igmp&#039;
        option target &#039;ACCEPT&#039;

config forwarding
        option src &#039;lan&#039;
        option dest &#039;tv&#039;</code></pre></div><p>/etc/config/mcproxy<br /></p><div class="codebox"><pre><code># Use your own MCProxy config file
config mcproxy &#039;mcproxy_file&#039;
    option disabled &#039;0&#039;
    option respawn &#039;1&#039;
    option file &#039;/etc/mcproxy.conf&#039;

# Use OpenWrt UCI config
config mcproxy &#039;mcproxy&#039;
    option disabled &#039;1&#039;
    option respawn &#039;1&#039;
    option protocol &#039;IGMPv2&#039;

###########################################

# Simple configuration examples</code></pre></div><p>/etc/mcproxy.conf<br /></p><div class="codebox"><pre><code>######################################
##-- mcproxy configuration script --##
######################################

# Protocol: IGMPv1|IGMPv2|IGMPv3 (IPv4) - MLDv1|MLDv2 (IPv6)
protocol IGMPv3;

###########################################

# Proxy Instance: upstream ==&gt; downstream
pinstance A: ap a1 ==&gt; ap a2;
pinstance B: bp b1 ==&gt; bp b2;
pinstance C: &quot;eth0.36&quot; ==&gt; &quot;br-lan&quot;;
###########################################

# Tables</code></pre></div><p>I appreciate the help! <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p330636">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">nague</div>
					<div class="post-datetime">
						6 Jul 2016, 16:53					</div>
				</div>
				<div class="post-content content">
					<p>Hi Cylac,</p><p>1.&nbsp; &nbsp; Basically, the UCI configuration of this file is disabled :<br /></p><div class="codebox"><pre><code>config mcproxy &#039;mcproxy&#039;
        option disabled &#039;1&#039;</code></pre></div><p>&nbsp; &nbsp; So, you can keep / remove whatever you want, it will not be read</p><p>2.&nbsp; &nbsp; You should disable it:<br /></p><div class="codebox"><pre><code>/etc/init.d/igmpproxy stop
/etc/init.d/igmpproxy disable</code></pre></div><p>I’ve taken a look at your configuration files, it sounds good, except mcproxy.conf: you should comment the pinstance A and B<br /></p><div class="codebox"><pre><code># Proxy Instance: upstream ==&gt; downstream
#pinstance A: ap a1 ==&gt; ap a2;
#pinstance B: bp b1 ==&gt; bp b2;
pinstance C: &quot;eth0.36&quot; ==&gt; &quot;br-lan&quot;;</code></pre></div><p>Maybe you can reorder the zones / rules in firewall, but I’m not even sure this is important.</p><p>Let me know if it&#039;s ok.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p330651">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">Cylac</div>
					<div class="post-datetime">
						6 Jul 2016, 18:56					</div>
				</div>
				<div class="post-content content">
					<p>Thanks nague!</p><p>I&#039;ll make those changes once I get home! </p><p>When I made the other changes you provided I wasn&#039;t getting a picture at all anymore. I&#039;d reboot the receiver and it would just sit at the booting splash image. When this happens I can&#039;t even access any menu options. I can see however on my openwrt that it&#039;s getting an ip assigned to it. So I know it&#039;s on the network at least.</p><p>I had disabled igmpproxy and had to install mcproxy</p><p>I notice this error message when I had to manually restart my firewall:</p><div class="codebox"><pre><code>Warning: Unable to locate ipset utility, disabling ipset support
Warning: Section @zone[2] (tv) has no device, network, subnet or extra options</code></pre></div><p>could it be I&#039;m missing something in my firewall settings?</p><p>I&#039;ll also try to do a <strong>tcpdump -v -i eth0.36</strong> to see what I&#039;m getting now once I connect a receiver.<br />Right now without a receiver I have this going on none stop:<br /></p><div class="codebox"><pre><code>11:55:37.488574 IP (tos 0x40, ttl 27, id 0, offset 0, flags [none], proto UDP (17), length 1360)
    10.2.32.20.47811 &gt; 239.0.56.100.1140: UDP, length 1332
11:55:37.490645 IP (tos 0x40, ttl 27, id 0, offset 0, flags [none], proto UDP (17), length 1356)
    10.2.32.20.47811 &gt; 239.0.56.100.1140: UDP, length 1328
11:55:37.492691 IP (tos 0x40, ttl 27, id 0, offset 0, flags [none], proto UDP (17), length 1356)
    10.2.32.20.47811 &gt; 239.0.56.100.1140: UDP, length 1328</code></pre></div><p>Thanks again</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p330652">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">nague</div>
					<div class="post-datetime">
						6 Jul 2016, 19:03					</div>
				</div>
				<div class="post-content content">
					<p>Cylac, try IPTV in lowercase:<br /></p><div class="codebox"><pre><code>config interface &#039;IPTV&#039;
    option proto &#039;dhcp&#039;
    option ifname &#039;eth0.36&#039;
    option defaultroute &#039;0&#039;</code></pre></div><p>What is your openwrt release ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p330665">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">Cylac</div>
					<div class="post-datetime">
						6 Jul 2016, 22:00					</div>
				</div>
				<div class="post-content content">
					<p>same error after changing IPTV to lowercase.</p><div class="codebox"><pre><code>Warning: Unable to locate ipset utility, disabling ipset support
Warning: Section @zone[2] (tv) has no device, network, subnet or extra options</code></pre></div><p>I&#039;m using OpenWRT Chaos Calmer 15.05.1 <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></p><p>This is all running on a <a href="https://wiki.openwrt.org/toh/tp-link/archer-c5-c7-wdr7500">TP-Link Archer C7</a></p>											<p class="post-edited">(Last edited by <strong>Cylac</strong> on 6 Jul 2016, 22:02)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p330694">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">Cylac</div>
					<div class="post-datetime">
						7 Jul 2016, 02:51					</div>
				</div>
				<div class="post-content content">
					<p>tcpdump is stilling showing records flowing like this none-stop! I&#039;m assuming the port is getting flooded?<br /></p><div class="codebox"><pre><code>19:50:13.239829 IP (tos 0x40, ttl 27, id 0, offset 0, flags [none], proto UDP (17), length 1360)
    10.2.128.165.47811 &gt; 239.0.64.150.1163: UDP, length 1332
19:50:13.240015 IP (tos 0x40, ttl 27, id 0, offset 0, flags [none], proto UDP (17), length 1356)
    10.2.128.165.47811 &gt; 239.0.64.150.1163: UDP, length 1328
19:50:13.240262 IP (tos 0x40, ttl 27, id 0, offset 0, flags [none], proto UDP (17), length 1360)
    10.2.0.18.47811 &gt; 239.0.16.20.1139: UDP, length 1332
19:50:13.241276 IP (tos 0x40, ttl 27, id 0, offset 0, flags [none], proto UDP (17), length 1356)
    10.2.0.18.47811 &gt; 239.0.16.20.1139: UDP, length 1328
19:50:13.243214 IP (tos 0x40, ttl 27, id 0, offset 0, flags [none], proto UDP (17), length 1356)
    10.2.0.18.47811 &gt; 239.0.16.20.1139: UDP, length 1328
19:50:13.244869 IP (tos 0x40, ttl 27, id 0, offset 0, flags [none], proto UDP (17), length 1356)
    10.2.128.165.47811 &gt; 239.0.64.150.1163: UDP, length 1328
19:50:13.245217 IP (tos 0x40, ttl 27, id 0, offset 0, flags [none], proto UDP (17), length 1356)
    10.2.0.18.47811 &gt; 239.0.16.20.1139: UDP, length 1328
19:50:13.246421 IP (tos 0x40, ttl 27, id 0, offset 0, flags [none], proto UDP (17), length 1360)
    10.2.128.165.47811 &gt; 239.0.64.150.1163: UDP, length 1332</code></pre></div><p>I&#039;m also not getting a picture after applying all the setting changes you suggested <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p>											<p class="post-edited">(Last edited by <strong>Cylac</strong> on 7 Jul 2016, 02:52)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p330696">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">dktn</div>
					<div class="post-datetime">
						7 Jul 2016, 04:00					</div>
				</div>
				<div class="post-content content">
					<p>I have TLWR942v2 with 15.05.1 openwrt. I have issue like you.<br />when i watch TV channel for 10 minutes the channel auto jump the next chanel (iptv.m3).<br />i changed igmpproxy to mcproxy, disabe igmp snooping.. but no thing&nbsp; change.<br />please advice me what can I do?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p330718">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">nague</div>
					<div class="post-datetime">
						7 Jul 2016, 11:45					</div>
				</div>
				<div class="post-content content">
					<div class="codebox"><pre><code>Warning: Unable to locate ipset utility, disabling ipset support
Warning: Section @zone[2] (tv) has no device, network, subnet or extra options</code></pre></div><p>This error means that the firewall can’t match the network “iptv” for the zone “tv”. Did you reload network / reboot your router after applying changes on /etc/config/network ?</p><p>If you still have this error, remove the tv zone and modify the wan zone:<br /></p><div class="codebox"><pre><code>config zone
    option name &#039;wan&#039;
    option input &#039;REJECT&#039;
    option output &#039;ACCEPT&#039;
    option forward &#039;REJECT&#039;
    option masq &#039;1&#039;
    option mtu_fix &#039;1&#039;
    option network &#039;wan wan6 iptv&#039;</code></pre></div><p>And of course, rename the src in rules :</p><div class="codebox"><pre><code>config rule
        option src &#039;wan&#039;
        option proto &#039;udp&#039;
        option dest &#039;lan&#039;
        option dest_ip &#039;224.0.0.0/4&#039;
        option target &#039;ACCEPT&#039;

config rule
        option src &#039;wan&#039;
        option proto &#039;igmp&#039;
        option target &#039;ACCEPT&#039;</code></pre></div><p>And remove:<br /></p><div class="codebox"><pre><code>config forwarding
        option src &#039;lan&#039;
        option dest &#039;tv&#039;</code></pre></div><p>Regarding your current tcpdump records, this is absolutely normal: eth0.36 is receiving the multicast group 239.0.64.150 and can’t forward it to the lan interface because firewall rules are not applied.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p330747">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">Cylac</div>
					<div class="post-datetime">
						7 Jul 2016, 17:40					</div>
				</div>
				<div class="post-content content">
					<p>Hi nague, I must be doing something wrong.. this isn&#039;t working for me <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /><br />I&#039;m not even getting a picture at all as I stated in my previous post.<br />At first I was getting a picture.. but was suffering that picture freeze.</p><p>I&#039;ve uploaded some pictures of my setup under Luci. Maybe you (or someone) can see what I might have configured wrong!</p><p>Thanks again</p><p><a href="http://postimg.org/image/70m2cz4nl/"><span class="postimg"><img src="http://s32.postimg.org/70m2cz4nl/screen1.png" alt="http://s32.postimg.org/70m2cz4nl/screen1.png" /></span></a> <a href="http://postimg.org/image/f3k8oap8x/"><span class="postimg"><img src="http://s32.postimg.org/f3k8oap8x/screen3.png" alt="http://s32.postimg.org/f3k8oap8x/screen3.png" /></span></a></p><p><a href="http://postimg.org/image/71w06e6hd/"><span class="postimg"><img src="http://s32.postimg.org/71w06e6hd/screen4.png" alt="http://s32.postimg.org/71w06e6hd/screen4.png" /></span></a> <a href="http://postimg.org/image/6zc4jk2tt/"><span class="postimg"><img src="http://s32.postimg.org/6zc4jk2tt/screen5.png" alt="http://s32.postimg.org/6zc4jk2tt/screen5.png" /></span></a></p><p><a href="http://postimg.org/image/frt378nyp/"><span class="postimg"><img src="http://s32.postimg.org/frt378nyp/screen6.png" alt="http://s32.postimg.org/frt378nyp/screen6.png" /></span></a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p330756">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">nague</div>
					<div class="post-datetime">
						7 Jul 2016, 19:25					</div>
				</div>
				<div class="post-content content">
					<p>Hi Cylac, sorry for this result, I&#039;m doing my best to help you.</p><p>All I can see in your screenshots looks ok... There might be something wrong with mcproxy. Can you porvide me the following log when you request a channel on your receiver:</p><p> tcpdump -i br-lan multicast</p><p>Then, try to go back with igmpproxy to see if you are still able to get a picture (same config as your original post):</p><div class="codebox"><pre><code>/etc/init.d/mcproxy stop
/etc/init.d/igmpproxy start</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p330759">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">Cylac</div>
					<div class="post-datetime">
						7 Jul 2016, 19:33					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nague wrote:</cite><blockquote><p>Hi Cylac, sorry for this result, I&#039;m doing my best to help you.</p><p>All I can see in your screenshots looks ok... There might be something wrong with mcproxy. Can you porvide me the following log when you request a channel on your receiver:</p><p> tcpdump -i br-lan multicast</p><p>Then, try to go back with igmpproxy to see if you are still able to get a picture (same config as your original post):</p><div class="codebox"><pre><code>/etc/init.d/mcproxy stop
/etc/init.d/igmpproxy start</code></pre></div></blockquote></div><p>Oh man don&#039;t get me wrong! I do appreciate your help tremendously! I&#039;m sorry if you took my previous comment the wrong way!</p><p>I&#039;ll go grab the logs you requested and I&#039;ll test igmpproxy again and see what I get!<br />I&#039;ll report back!</p><p>Thanks again</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p330761">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">nague</div>
					<div class="post-datetime">
						7 Jul 2016, 19:36					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Cylac wrote:</cite><blockquote><p>I&#039;ll go grab the logs you requested and I&#039;ll test igmpproxy again and see what I get!<br />I&#039;ll report back!<br />Thanks again</p></blockquote></div><p>No problem, email me via forum, if I can help you live...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p330793">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">Cylac</div>
					<div class="post-datetime">
						8 Jul 2016, 04:12					</div>
				</div>
				<div class="post-content content">
					<p>Thanks nague! </p><p>Here&#039;s an extract of the command: tcpdump -i br-lan multicast</p><div class="codebox"><pre><code>21:06:21.378230 ARP, Request who-has 192.168.1.38 tell CHAOS.local.lan, length 46
21:06:21.419895 ARP, Request who-has 192.168.1.38 tell GATEKEEPER.local.lan, length 28
21:06:22.347228 ARP, Request who-has GATEKEEPER.local.lan tell 192.168.1.209, length 46
21:06:22.413041 ARP, Request who-has 192.168.1.38 tell GATEKEEPER.local.lan, length 28
21:06:23.413043 ARP, Request who-has 192.168.1.38 tell GATEKEEPER.local.lan, length 28
21:06:25.361622 ARP, Request who-has GATEKEEPER.local.lan tell 192.168.1.209, length 46
21:06:25.427208 ARP, Request who-has 192.168.1.38 tell GATEKEEPER.local.lan, length 28
21:06:26.423040 ARP, Request who-has 192.168.1.38 tell GATEKEEPER.local.lan, length 28
21:06:27.335591 IP android-2c350682f0d830a4.local.lan &gt; 239.255.255.250: igmp v2 report 239.255.255.250
21:06:27.423482 ARP, Request who-has 192.168.1.38 tell GATEKEEPER.local.lan, length 28
21:06:27.979620 IP 192.168.1.209 &gt; 239.255.255.250: igmp v2 report 239.255.255.250
21:06:28.377596 ARP, Request who-has GATEKEEPER.local.lan tell 192.168.1.209, length 46
21:06:28.506370 ARP, Request who-has 192.168.1.38 tell GATEKEEPER.local.lan, length 28
21:06:29.503505 ARP, Request who-has 192.168.1.38 tell GATEKEEPER.local.lan, length 28
21:06:30.503037 ARP, Request who-has 192.168.1.38 tell GATEKEEPER.local.lan, length 28
21:06:30.514177 IP 192.168.1.177 &gt; 224.0.0.251: igmp v2 report 224.0.0.251
21:06:31.044250 IP 192.168.1.177 &gt; 239.255.255.250: igmp v2 report 239.255.255.250
21:06:31.265560 IP android-2c350682f0d830a4.local.lan &gt; 224.0.0.251: igmp v2 report 224.0.0.251
21:06:31.326958 IP CHAOS.local.lan.53070 &gt; 192.168.1.255.32414: UDP, length 21
21:06:31.327085 IP CHAOS.local.lan.53069 &gt; 192.168.1.255.32412: UDP, length 21
21:06:31.394112 ARP, Request who-has GATEKEEPER.local.lan tell 192.168.1.209, length 46
21:06:31.619600 IP 192.168.1.209 &gt; 239.255.255.246: igmp v2 report 239.255.255.246
21:06:33.166008 IP Chromecast.local.lan &gt; 239.255.255.250: igmp v2 report 239.255.255.250
21:06:33.455656 ARP, Request who-has 192.168.1.38 tell GATEKEEPER.local.lan, length 28
21:06:34.409746 ARP, Request who-has GATEKEEPER.local.lan tell 192.168.1.209, length 46
21:06:34.453037 ARP, Request who-has 192.168.1.38 tell GATEKEEPER.local.lan, length 28
21:06:35.453036 ARP, Request who-has 192.168.1.38 tell GATEKEEPER.local.lan, length 28
21:06:35.628414 IP CHAOS.local.lan.53068 &gt; 239.255.255.250.1900: UDP, length 94
21:06:36.324107 IP CHAOS.local.lan.53069 &gt; 192.168.1.255.32412: UDP, length 21
21:06:36.324213 IP CHAOS.local.lan.53070 &gt; 192.168.1.255.32414: UDP, length 21
21:06:41.316965 IP CHAOS.local.lan.53070 &gt; 192.168.1.255.32414: UDP, length 21
21:06:41.317073 IP CHAOS.local.lan.53069 &gt; 192.168.1.255.32412: UDP, length 21
21:06:41.523046 ARP, Request who-has 192.168.1.38 tell GATEKEEPER.local.lan, length 28
21:06:42.523044 ARP, Request who-has 192.168.1.38 tell GATEKEEPER.local.lan, length 28
21:06:43.457780 ARP, Request who-has GATEKEEPER.local.lan tell 192.168.1.209, length 46
21:06:45.413193 ARP, Request who-has 192.168.1.38 tell GATEKEEPER.local.lan, length 28
21:06:46.314091 IP CHAOS.local.lan.53070 &gt; 192.168.1.255.32414: UDP, length 21
21:06:46.314198 IP CHAOS.local.lan.53069 &gt; 192.168.1.255.32412: UDP, length 21
21:06:46.413042 ARP, Request who-has 192.168.1.38 tell GATEKEEPER.local.lan, length 28
21:06:46.470849 ARP, Request who-has GATEKEEPER.local.lan tell 192.168.1.209, length 46</code></pre></div><p>I&#039;ll be trying to setup igmpproxy again! I&#039;ll report back!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p330817">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">nague</div>
					<div class="post-datetime">
						8 Jul 2016, 11:31					</div>
				</div>
				<div class="post-content content">
					<p>Hi Cylac, on the wireshark log, I can&#039;t see your iptv receiver requesting a channel.<br />You can try this command to avoid arp requests in log:</p><p>tcpdump -i br-lan multicast and not arp</p>											<p class="post-edited">(Last edited by <strong>nague</strong> on 8 Jul 2016, 12:26)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p330823">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">dktn</div>
					<div class="post-datetime">
						8 Jul 2016, 12:23					</div>
				</div>
				<div class="post-content content">
					<p>do you have settopbox connect to router? what í vlan 37 work for? do you have IP6<br />if you do not use them.<br />try network<br />Config interface &#039;loopback&#039;<br />&nbsp; &nbsp; option ifname &#039;lo&#039;<br />&nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; option ipaddr &#039;127.0.0.1&#039;<br />&nbsp; &nbsp; option netmask &#039;255.0.0.0&#039;</p><p>config globals &#039;globals&#039;<br />&nbsp; &nbsp; option ula_prefix &#039;fdd7:68f9:5948::/48&#039;</p><p>config interface &#039;lan&#039;<br />&nbsp; &nbsp; option ifname &#039;eth1.1&#039;<br />&nbsp; &nbsp; option force_link &#039;1&#039;<br />&nbsp; &nbsp; option type &#039;bridge&#039;<br />&nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; option ipaddr &#039;192.168.1.1&#039;<br />&nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;<br />&nbsp; #&nbsp; option ip6assign &#039;60&#039;<br />&nbsp; &nbsp; option igmp_snooping &#039;1&#039;</p><p>config interface &#039;IPTV&#039;<br />&nbsp; &nbsp; option proto &#039;dhcp&#039;<br />&nbsp; &nbsp; option ifname &#039;eth1.36 eth0.36&#039;<br />&nbsp; &nbsp; option defaultroute &#039;0&#039;</p><p>config interface &#039;wan&#039;<br />&nbsp; &nbsp; option proto &#039;pppoe&#039;<br />&nbsp; &nbsp; option ifname &#039;eth0.35&#039;<br />&nbsp; &nbsp; option username &#039;***************&#039;<br />&nbsp; &nbsp; option password &#039;**************&#039;<br />&nbsp; &nbsp; option peerdns &#039;0&#039;<br />&nbsp; &nbsp; option dns &#039;208.67.222.222 208.67.220.220 8.8.8.8&#039; #OpenDNS and Google Public DNS</p><p># config interface &#039;wan6&#039;<br />&nbsp; #&nbsp; option proto &#039;dhcpv6&#039;<br />&nbsp; &nbsp; # option ifname &#039;eth0.37&#039;<br />&nbsp; &nbsp;# option reqaddress &#039;try&#039;<br />&nbsp; &nbsp;# option reqprefix &#039;auto&#039;</p><p>config switch<br />&nbsp; &nbsp; option name &#039;switch0&#039;<br />&nbsp; &nbsp; option reset &#039;1&#039;<br />&nbsp; &nbsp; option enable_vlan &#039;1&#039;<br />&nbsp; &nbsp; option mirror_source_port &#039;0&#039;<br />&nbsp; &nbsp; option mirror_monitor_port &#039;0&#039;</p><p>config switch_vlan<br />&nbsp; &nbsp; option device &#039;switch0&#039;<br />&nbsp; &nbsp; option vlan &#039;1&#039;<br />&nbsp; &nbsp; option vid &#039;1&#039;<br />&nbsp; &nbsp; option ports &#039;0t 2 3 4 5&#039;</p><p>config switch_vlan<br />&nbsp; &nbsp; option device &#039;switch0&#039;<br />&nbsp; &nbsp; option vlan &#039;2&#039;<br />&nbsp; &nbsp; option vid &#039;2&#039;</p><p>config switch_vlan<br />&nbsp; &nbsp; option device &#039;switch0&#039;<br />&nbsp; &nbsp; option vlan &#039;35&#039;<br />&nbsp; &nbsp; option ports &#039;1 6&#039;<br />&nbsp; &nbsp; option vid &#039;35&#039;</p><p>config switch_vlan<br />&nbsp; &nbsp; option device &#039;switch0&#039;<br />&nbsp; &nbsp; option vlan &#039;36&#039;<br />&nbsp; &nbsp; option vid &#039;36&#039;<br />&nbsp; &nbsp; option ports &#039;1t 6&#039;</p><p># config switch_vlan<br />&nbsp; &nbsp;# option device &#039;switch0&#039;<br />&nbsp; &nbsp; # option vlan &#039;37&#039;<br />&nbsp; &nbsp; # option vid &#039;37&#039;<br />&nbsp; &nbsp; # option ports &#039;1t 6t&#039;</p><p> # config route<br />&nbsp; &nbsp;#&nbsp; &nbsp; &nbsp;option interface &#039;iptv&#039;<br />&nbsp; &nbsp; &nbsp;#&nbsp; &nbsp;option target &#039;224.0.0.0&#039;<br />&nbsp; &nbsp; &nbsp; #&nbsp; option netmask &#039;240.0.0.0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp;# option gateway &#039;0.0.0.0&#039;</p>											<p class="post-edited">(Last edited by <strong>dktn</strong> on 8 Jul 2016, 12:25)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>