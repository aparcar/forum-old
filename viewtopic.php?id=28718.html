<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Makefiles</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 23 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p128787">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">napierzaza</div>
					<div class="post-datetime">
						18 Feb 2011, 20:35					</div>
				</div>
				<div class="post-content content">
					<p>Is there any information in regards to Makefile conventions in the inner .src/ directory? I&#039;ve seen a few decent examples of the root package Makefile. But I haven&#039;t been able to successfully include gpio_dev.h and some other things and I think it&#039;s because of the Makefile.</p><p>Is there an easy way to see full packages for openWRT? I appears as if most are just Makefiles and patches.\</p><p>EDIT: more details</p><p>I&#039;m trying to work with GPIOs (normally) and also using GPIOs as an i2c bus. So I&#039;m getting errors when I try to include &lt;linux/gpio_dev.h&gt; etc</p><div class="codebox"><pre><code>killerwhale:/datastore/openwrt-pidproject/backfire# make package/PIDd/compile V=99
make[1]: Entering directory `/datastore/openwrt-pidproject/backfire&#039;
make[2]: Entering directory `/datastore/openwrt-pidproject/backfire/package/PIDd&#039;
mkdir -p /datastore/openwrt-pidproject/backfire/build_dir/target-mips_uClibc-0.9.30.1/PIDd-0.1
cp -fpR ./src/* /datastore/openwrt-pidproject/backfire/build_dir/target-mips_uClibc-0.9.30.1/PIDd-0.1/
touch /datastore/openwrt-pidproject/backfire/build_dir/target-mips_uClibc-0.9.30.1/PIDd-0.1/.prepared_1a372c82749f4838841c30c704442757
(cd /datastore/openwrt-pidproject/backfire/build_dir/target-mips_uClibc-0.9.30.1/PIDd-0.1/./; if [ -x ./configure ]; then /usr/bin/find /datastore/openwrt-pidproject/backfire/build_dir/target-mips_uClibc-0.9.30.1/PIDd-0.1/ -name config.guess | xargs -r chmod u+w; /usr/bin/find /datastore/openwrt-pidproject/backfire/build_dir/target-mips_uClibc-0.9.30.1/PIDd-0.1/ -name config.guess | xargs -r -n1 cp /datastore/openwrt-pidproject/backfire/scripts/config.guess; /usr/bin/find /datastore/openwrt-pidproject/backfire/build_dir/target-mips_uClibc-0.9.30.1/PIDd-0.1/ -name config.sub | xargs -r chmod u+w; /usr/bin/find /datastore/openwrt-pidproject/backfire/build_dir/target-mips_uClibc-0.9.30.1/PIDd-0.1/ -name config.sub | xargs -r -n1 cp /datastore/openwrt-pidproject/backfire/scripts/config.sub; AR=mips-openwrt-linux-uclibc-ar AS=&quot;mips-openwrt-linux-uclibc-gcc -c -Os -pipe -mips32 -mtune=mips32 -funit-at-a-time -fhonour-copts -msoft-float&quot; LD=mips-openwrt-linux-uclibc-ld NM=mips-openwrt-linux-uclibc-nm CC=&quot;mips-openwrt-linux-uclibc-gcc&quot; GCC=&quot;mips-openwrt-linux-uclibc-gcc&quot; CXX=&quot;mips-openwrt-linux-uclibc-g++&quot; RANLIB=mips-openwrt-linux-uclibc-ranlib STRIP=mips-openwrt-linux-uclibc-strip OBJCOPY=mips-openwrt-linux-uclibc-objcopy OBJDUMP=mips-openwrt-linux-uclibc-objdump SIZE=mips-openwrt-linux-uclibc-size CFLAGS=&quot;-Os -pipe -mips32 -mtune=mips32 -funit-at-a-time -fhonour-copts -msoft-float &quot; CXXFLAGS=&quot;-Os -pipe -mips32 -mtune=mips32 -funit-at-a-time -fhonour-copts -msoft-float &quot; CPPFLAGS=&quot;-I/datastore/openwrt-pidproject/backfire/staging_dir/target-mips_uClibc-0.9.30.1/usr/include -I/datastore/openwrt-pidproject/backfire/staging_dir/target-mips_uClibc-0.9.30.1/include -I/datastore/openwrt-pidproject/backfire/staging_dir/toolchain-mips_gcc-4.3.3+cs_uClibc-0.9.30.1/usr/include -I/datastore/openwrt-pidproject/backfire/staging_dir/toolchain-mips_gcc-4.3.3+cs_uClibc-0.9.30.1/include &quot; LDFLAGS=&quot;-L/datastore/openwrt-pidproject/backfire/staging_dir/target-mips_uClibc-0.9.30.1/usr/lib -L/datastore/openwrt-pidproject/backfire/staging_dir/target-mips_uClibc-0.9.30.1/lib -L/datastore/openwrt-pidproject/backfire/staging_dir/toolchain-mips_gcc-4.3.3+cs_uClibc-0.9.30.1/usr/lib -L/datastore/openwrt-pidproject/backfire/staging_dir/toolchain-mips_gcc-4.3.3+cs_uClibc-0.9.30.1/lib &quot;   ./configure --target=mips-openwrt-linux --host=mips-openwrt-linux --build=i486-linux-gnu --program-prefix=&quot;&quot; --program-suffix=&quot;&quot; --prefix=/usr --exec-prefix=/usr --bindir=/usr/bin --sbindir=/usr/sbin --libexecdir=/usr/lib --sysconfdir=/etc --datadir=/usr/share --localstatedir=/var --mandir=/usr/man --infodir=/usr/info --disable-nls   --with-linux-headers=&quot;&quot;  ; fi; )
touch /datastore/openwrt-pidproject/backfire/build_dir/target-mips_uClibc-0.9.30.1/PIDd-0.1/.configured_
make -C /datastore/openwrt-pidproject/backfire/build_dir/target-mips_uClibc-0.9.30.1/PIDd-0.1 AR=mips-openwrt-linux-uclibc-ar AS=&quot;mips-openwrt-linux-uclibc-gcc -c -Os -pipe -mips32 -mtune=mips32 -funit-at-a-time -fhonour-copts -msoft-float&quot; LD=mips-openwrt-linux-uclibc-ld NM=mips-openwrt-linux-uclibc-nm CC=&quot;mips-openwrt-linux-uclibc-gcc&quot; GCC=&quot;mips-openwrt-linux-uclibc-gcc&quot; CXX=&quot;mips-openwrt-linux-uclibc-g++&quot; RANLIB=mips-openwrt-linux-uclibc-ranlib STRIP=mips-openwrt-linux-uclibc-strip OBJCOPY=mips-openwrt-linux-uclibc-objcopy OBJDUMP=mips-openwrt-linux-uclibc-objdump SIZE=mips-openwrt-linux-uclibc-size CFLAGS=&quot;-Os -pipe -mips32 -mtune=mips32 -funit-at-a-time -fhonour-copts -msoft-float -I/arch/mips/ar531x&quot;
make[3]: Entering directory `/datastore/openwrt-pidproject/backfire/build_dir/target-mips_uClibc-0.9.30.1/PIDd-0.1&#039;
mips-openwrt-linux-uclibc-g++    -c -o Heater.o Heater.cpp
In file included from Heater.cpp:1:
Heater.h:15:24: error: linux/gpio.h: No such file or directory
Heater.cpp: In member function &#039;void Heater::setup(unsigned int, long int)&#039;:
Heater.cpp:12: error: &#039;GPIO_CLEAR&#039; was not declared in this scope
Heater.cpp:22: error: &#039;GPIO_DIR_OUT&#039; was not declared in this scope
Heater.cpp:22: error: &#039;ioctl&#039; was not declared in this scope
Heater.cpp: In member function &#039;void Heater::update(long int)&#039;:
Heater.cpp:37: error: &#039;GPIO_SET&#039; was not declared in this scope
Heater.cpp:42: error: &#039;GPIO_CLEAR&#039; was not declared in this scope
Heater.cpp: In static member function &#039;static void Heater::elementPower(int)&#039;:
Heater.cpp:61: error: &#039;ioctl&#039; was not declared in this scope</code></pre></div>											<p class="post-edited">(Last edited by <strong>napierzaza</strong> on 18 Feb 2011, 20:46)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p128811">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">napierzaza</div>
					<div class="post-datetime">
						19 Feb 2011, 06:43					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve read the doc on Makefiles in the documentation. But now I have no idea how to make it work. I&#039;ve pretty much dead copied the gpioctl makefiles and even with a stub app it doesn&#039;t work.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p128822">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Borromini</div>
					<div class="post-datetime">
						19 Feb 2011, 12:38					</div>
				</div>
				<div class="post-content content">
					<p>That&#039;s not a make problem, it&#039;s not finding the headers, and those should be defined in the C files - ie the code itself. Check the source tarball for references to linux/gpio.h and create a patch if necessary. Googling tells me it should be in your distro&#039;s kernel headers package (and there seem to be lots of gpio.h files in the kernel headers).</p>											<p class="post-edited">(Last edited by <strong>Borromini</strong> on 19 Feb 2011, 12:43)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p128838">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">napierzaza</div>
					<div class="post-datetime">
						19 Feb 2011, 17:03					</div>
				</div>
				<div class="post-content content">
					<p>Where can I find the tarball? I have the downloaded src and can build images fine. But I&#039;ve had trouble trying to even find any headers for gpio_dev.h or i2c_dev.h</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p128842">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">Borromini</div>
					<div class="post-datetime">
						19 Feb 2011, 17:40					</div>
				</div>
				<div class="post-content content">
					<p>The source gets downloaded as a tarball or a zip file, then extracted. You probably already have it on your system. The OpenWrt buildroot should have the kernel headers installed, check it.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>