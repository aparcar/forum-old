<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Asus 500g Deluxe Kamikaze - USB disk not detected on boot</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 24 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p54561">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">zdenal</div>
					<div class="post-datetime">
						25 Aug 2007, 11:04					</div>
				</div>
				<div class="post-content content">
					<p>Hallo,<br />I have upgraded to kamikaze yesterday, an all goes fine. I&#039;m using Kamikaze with 2.4 kernel due to wireless issue(have anybody a news about 2.6 kernel availability with broadcom stable WiFi driver ?)</p><p>I have configured some packages to use /opt destination, which is a USB external harddisk. it works fine, but...<br />after restart,&nbsp; sometime the USB disk is not detected and not mounted. When i unplug it manually and then plug in back, disk is back and abvailable on the /dev/scsi/......../disk(part1) path and can be mounted. All appropriate USB modules are loaded when i try lsmod...</p><p>Have anbybody an idea, what&#039;s wrong with boot sequence? Because my http server is installed on /opt USB disk, i need to start it immediately after restart, without a manual action.</p><p>Thank you very much for your hints and help.</p>											<p class="post-edited">(Last edited by <strong>zdenal</strong> on 25 Aug 2007, 16:05)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p54777">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">zdenal</div>
					<div class="post-datetime">
						29 Aug 2007, 20:26					</div>
				</div>
				<div class="post-content content">
					<p>Hmm, seems to nobody has idea how to solve the problem....</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p54779">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">cybermaus</div>
					<div class="post-datetime">
						29 Aug 2007, 20:42					</div>
				</div>
				<div class="post-content content">
					<p>And if you rmmod / insmod rather then physically disconnect?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p54855">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">LaySoft</div>
					<div class="post-datetime">
						31 Aug 2007, 10:12					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m using kamikaze 7.07 (brcm47xx-2.6) firmware on ASUS WL-500Gp, but i can&#039;t mount USB devices.<br />My /dev dir don&#039;t exists scsi dir or any similar:</p><p>/dev/3-1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/dev/mtdblock2&nbsp; &nbsp; &nbsp; &nbsp;/dev/ttyS1<br />/dev/3-2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/dev/mtdblock3&nbsp; &nbsp; &nbsp; &nbsp;/dev/urandom<br />/dev/console&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/dev/mtdblock4&nbsp; &nbsp; &nbsp; &nbsp;/dev/usb1<br />/dev/full&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /dev/null&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /dev/usb2<br />/dev/kmem&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /dev/port&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /dev/usb3<br />/dev/kmsg&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /dev/ppp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/dev/usbdev1.1_ep00<br />/dev/log&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/dev/ptmx&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /dev/usbdev1.1_ep81<br />/dev/mem&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/dev/pts/&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /dev/usbdev2.1_ep00<br />/dev/mtd0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /dev/random&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /dev/usbdev2.1_ep81<br />/dev/mtd0ro&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /dev/root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /dev/usbdev3.1_ep00<br />/dev/mtd1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /dev/sda&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/dev/usbdev3.1_ep81<br />/dev/mtd1ro&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /dev/sdb&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/dev/usbdev3.2_ep00<br />/dev/mtd2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /dev/sdc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/dev/usbdev3.2_ep01<br />/dev/mtd2ro&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /dev/sdc1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /dev/usbdev3.2_ep82<br />/dev/mtd3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /dev/sdd&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/dev/usbdev3.3_ep00<br />/dev/mtd3ro&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /dev/sde&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/dev/usbdev3.3_ep02<br />/dev/mtd4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /dev/sde1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /dev/usbdev3.3_ep81<br />/dev/mtd4ro&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /dev/shm/&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /dev/zero<br />/dev/mtdblock0&nbsp; &nbsp; &nbsp; &nbsp;/dev/tty<br />/dev/mtdblock1&nbsp; &nbsp; &nbsp; &nbsp;/dev/ttyS0</p><p>Installed packages:</p><p>kmod-fs-vfat&nbsp; &nbsp; 2.6.22-brcm47xx-1<br />kmod-nls-base&nbsp; &nbsp; 2.6.22-brcm47xx-1&nbsp; &nbsp; <br />kmod-scsi-core&nbsp; &nbsp; 2.6.22-brcm47xx-1&nbsp; &nbsp; <br />kmod-usb-core&nbsp; &nbsp; 2.6.22-brcm47xx-1&nbsp; &nbsp; <br />kmod-usb-ohci&nbsp; &nbsp; 2.6.22-brcm47xx-1&nbsp; &nbsp; <br />kmod-usb-storage&nbsp; &nbsp; 2.6.22-brcm47xx-1&nbsp; &nbsp; <br />kmod-usb-uhci&nbsp; &nbsp; 2.6.22-brcm47xx-1&nbsp; &nbsp; <br />kmod-usb2&nbsp; &nbsp; 2.6.22-brcm47xx-1</p><p>My dmesg important output:</p><p>usb 3-2: new high speed USB device using ehci_hcd and address 2<br />usb 3-2: configuration #1 chosen from 1 choice<br />scsi0 : SCSI emulation for USB Mass Storage devices<br />usbcore: registered new interface driver usb-storage<br />USB Mass Storage support registered.<br />usb-storage: device found at 2<br />usb-storage: waiting for device to settle before scanning<br />scsi 0:0:0:0: Direct-Access&nbsp; &nbsp; &nbsp;Generic&nbsp; USB SD Reader&nbsp; &nbsp; 1.00 PQ: 0 ANSI: 0<br />sd 0:0:0:0: [sda] Attached SCSI removable disk<br />scsi 0:0:0:1: Direct-Access&nbsp; &nbsp; &nbsp;Generic&nbsp; USB CF Reader&nbsp; &nbsp; 1.01 PQ: 0 ANSI: 0<br />sd 0:0:0:1: [sdb] Attached SCSI removable disk<br />scsi 0:0:0:2: Direct-Access&nbsp; &nbsp; &nbsp;Generic&nbsp; USB SM Reader&nbsp; &nbsp; 1.02 PQ: 0 ANSI: 0<br />device ath0 entered promiscuous mode<br />br-lan: port 2(ath0) entering learning state<br />br-lan: topology change detected, propagating<br />br-lan: port 2(ath0) entering forwarding state<br />sd 0:0:0:2: [sdc] 256000 512-byte hardware sectors (131 MB)<br />sd 0:0:0:2: [sdc] Write Protect is off<br />sd 0:0:0:2: [sdc] Mode Sense: 03 00 00 00<br />sd 0:0:0:2: [sdc] Assuming drive cache: write through<br />sd 0:0:0:2: [sdc] 256000 512-byte hardware sectors (131 MB)<br />sd 0:0:0:2: [sdc] Write Protect is off<br />sd 0:0:0:2: [sdc] Mode Sense: 03 00 00 00<br />sd 0:0:0:2: [sdc] Assuming drive cache: write through<br /> sdc: sdc1<br />sd 0:0:0:2: [sdc] Attached SCSI removable disk<br />scsi 0:0:0:3: Direct-Access&nbsp; &nbsp; &nbsp;Generic&nbsp; USB MS Reader&nbsp; &nbsp; 1.03 PQ: 0 ANSI: 0<br />sd 0:0:0:3: [sdd] Attached SCSI removable disk<br />usb-storage: device scan complete<br />usb 3-1: new high speed USB device using ehci_hcd and address 3<br />usb 3-1: configuration #1 chosen from 1 choice<br />scsi1 : SCSI emulation for USB Mass Storage devices<br />usb-storage: device found at 3<br />usb-storage: waiting for device to settle before scanning<br />scsi 1:0:0:0: Direct-Access&nbsp; &nbsp; &nbsp;USB 2.0&nbsp; Flash Disk&nbsp; &nbsp; &nbsp; &nbsp;1100 PQ: 0 ANSI: 0 CC<br />S<br />sd 1:0:0:0: [sde] 3963904 512-byte hardware sectors (2030 MB)<br />sd 1:0:0:0: [sde] Write Protect is off<br />sd 1:0:0:0: [sde] Mode Sense: 43 00 00 00<br />sd 1:0:0:0: [sde] Assuming drive cache: write through<br />sd 1:0:0:0: [sde] 3963904 512-byte hardware sectors (2030 MB)<br />sd 1:0:0:0: [sde] Write Protect is off<br />sd 1:0:0:0: [sde] Mode Sense: 43 00 00 00<br />sd 1:0:0:0: [sde] Assuming drive cache: write through<br /> sde: sde1<br />sd 1:0:0:0: [sde] Attached SCSI removable disk<br />usb-storage: device scan complete</p><p>What&#039;s the problem?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p54863">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">Borromini</div>
					<div class="post-datetime">
						31 Aug 2007, 14:07					</div>
				</div>
				<div class="post-content content">
					<p>Do you, at any time, instruct Linux to mount the disk? OpenWRT has, to my knowledge, no &#039;automount&#039; function. So put an entry in your fstab and add a mount command in the custom startup file.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p54881">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">LaySoft</div>
					<div class="post-datetime">
						31 Aug 2007, 18:04					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Borromini wrote:</cite><blockquote><p>Do you, at any time, instruct Linux to mount the disk? OpenWRT has, to my knowledge, no &#039;automount&#039; function. So put an entry in your fstab and add a mount command in the custom startup file.</p></blockquote></div><p>Of course i tried, this is my problem, i don&#039;t know what parameters need mount. In <a href="http://wiki.openwrt.org/UsbStorageHowto?highlight=(usb)">http://wiki.openwrt.org/UsbStorageHowto?highlight=(usb)</a> is many mount command with parameters, like:</p><p>mount /dev/scsi/host0/bus0/target0/lun0/part1 /mnt</p><p>But in my system /dev/scsi don&#039;t exists.</p><p>And in White Russian not need mount command, it &quot;automounts&quot; every USB devices.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p54889">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">Borromini</div>
					<div class="post-datetime">
						31 Aug 2007, 20:12					</div>
				</div>
				<div class="post-content content">
					<p>That path is supposed to be the path to your HD/USB stick. It may vary, but it always is under /dev/scsi afaik. So if it&#039;s not there, that means it is not recognised.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p54919">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">microphone</div>
					<div class="post-datetime">
						1 Sep 2007, 21:40					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>LaySoft wrote:</cite><blockquote><p>I&#039;m using kamikaze 7.07 (brcm47xx-2.6) firmware on ASUS WL-500Gp, but i can&#039;t mount USB devices.<br />My /dev dir don&#039;t exists scsi dir or any similar:<br />What&#039;s the problem?</p></blockquote></div><p>Im having the exact same problem.....its driving me insane....</p><br /><p>EDIT: this is more confusing</p><div class="codebox"><pre><code>root@ZPM:/dev# fdisk -l

Disk /dev/sda: 6000 MB, 6000132096 bytes
185 heads, 62 sectors/track, 1021 cylinders
Units = cylinders of 11470 * 512 = 5872640 bytes

   Device Boot      Start         End      Blocks   Id  System
/dev/sda1               1          44      252309   82  Linux swap / Solaris
/dev/sda2              45         219     1003625   83  Linux
/dev/sda3             220        1021     4599470   83  Linux</code></pre></div><p><strong>EUREKA</strong></p><p>Ive got some good news kids!</p><p>you actually *gasp* have to mount your drives....i know <img src="https://forum.openwrt.org/img/smilies/tongue.png" width="15" height="15" alt="tongue" /></p><p>so what i did was, using a usb drive that i had prepared eariler</p><div class="codebox"><pre><code>swapon /dev/sda1</code></pre></div><p>that fixed my swap......</p><p>then from the /mnt directory</p><div class="codebox"><pre><code>mkdir store
mkdir sml
mount /dev/sda2 /mnt/sml
mount /dev/sda3 /mnt/store</code></pre></div><p>yous gotz yo data</p>											<p class="post-edited">(Last edited by <strong>microphone</strong> on 1 Sep 2007, 22:10)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p54947">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">LaySoft</div>
					<div class="post-datetime">
						2 Sep 2007, 16:23					</div>
				</div>
				<div class="post-content content">
					<p>microphone!</p><p>I tried your suggestions:</p><p>root@LaySoft:~# fdisk -l</p><p>Disk /dev/sda: 2029 MB, 2029518848 bytes<br />17 heads, 32 sectors/track, 7286 cylinders<br />Units = cylinders of 544 * 512 = 278528 bytes</p><p>&nbsp; &nbsp;Device Boot&nbsp; &nbsp; &nbsp; Start&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;End&nbsp; &nbsp; &nbsp; Blocks&nbsp; &nbsp;Id&nbsp; System<br />/dev/sda1&nbsp; &nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1&nbsp; &nbsp; &nbsp; &nbsp; 7287&nbsp; &nbsp; &nbsp;1981936&nbsp; &nbsp; b&nbsp; W95 FAT32<br />root@LaySoft:~# mount /dev/sda1 /mnt<br />mount: mounting /dev/sda1 on /mnt failed<br />root@LaySoft:~# mount /dev/sda /mnt <br />mount: mounting /dev/sda on /mnt failed<br />root@LaySoft:~# </p><p>Don&#039;t works. Which package containts swapon command?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p54970">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">freycinet</div>
					<div class="post-datetime">
						3 Sep 2007, 02:30					</div>
				</div>
				<div class="post-content content">
					<p>LaySoft: <br />Based on the dmesg output you posted earlier, I think your USB disk is sde rather than sda, so you will need to adjust the device paths appropriately. It will also depend on what partitions exist on your USB disk.</p><p>fdisk will let you view and edit the partitions on the disk.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p55040">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">microphone</div>
					<div class="post-datetime">
						4 Sep 2007, 09:54					</div>
				</div>
				<div class="post-content content">
					<p>create a folder in /mnt and the try and mount to that instead of just /mnt....</p><p>swapon is built in i think ??? if you use it on a destination that has been formatted as swap it should work...</p><br /><p>....i have just installed dd-wrt so i cant test it......i&#039;ll reflash back to kam and let you know what happens...</p>											<p class="post-edited">(Last edited by <strong>microphone</strong> on 4 Sep 2007, 09:59)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p55041">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">LaySoft</div>
					<div class="post-datetime">
						4 Sep 2007, 10:09					</div>
				</div>
				<div class="post-content content">
					<p>My linux guru friend solved the problem:</p><p>Need to install kmod-nls-cp437 and kmod-nls-iso8859-1 packages, and everything works now.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p55046">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">microphone</div>
					<div class="post-datetime">
						4 Sep 2007, 11:20					</div>
				</div>
				<div class="post-content content">
					<p>what are those packages for? you know for the sake of wrapping up the thread</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>