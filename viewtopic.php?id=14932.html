<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> AR7 squashfs boot problem</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 5 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p65278">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">carmadamus</div>
					<div class="post-datetime">
						17 Mar 2008, 16:01					</div>
				</div>
				<div class="post-content content">
					<p>I have compiled the latest trunk and tried to run it but ran into a problem. It is my understanding that there is a problem with finding the squashfs partition. I hope anyone has more insights and can give me a hint.</p><p>mtd setup from pspboot:<br /></p><div class="codebox"><pre><code>mtd0            0x900e6000,0x90800000
mtd1            0x90020090,0x900e6000
mtd2            0x90000000,0x90010000
mtd3            0x90010000,0x90020000
mtd4            0x90020000,0x90800000</code></pre></div><p>Boot log:<br /></p><div class="codebox"><pre><code>Booting...
Linux version 2.6.24.2 (user1@workstation) (gcc version 4.1.2) #1 Thu Mar 13 16:50:45 CET 2008
console [early0] enabled
CPU revision is: 00018448 (MIPS 4KEc)
TI AR7 (TNETD7300), ID: 0x0005, Revision: 0x22
Determined physical RAM map:
 memory: 02000000 @ 14000000 (usable)
Initrd not found or empty - disabling initrd
Zone PFN ranges:
  Normal      81920 -&gt;    90112
Movable zone start PFN for each node
early_node_map[1] active PFN ranges
    0:    81920 -&gt;    90112
Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 8128
Kernel command line: init=/etc/preinit rootfstype=squashfs,jffs2, console=ttyS0,38400n8
Primary instruction cache 16kB, VIPT, 4-way, linesize 16 bytes.
Primary data cache 16kB, 4-way, VIPT, no aliases, linesize 16 bytes
Synthesized clear page handler (26 instructions).
Synthesized copy page handler (46 instructions).
Synthesized TLB refill handler (20 instructions).
Synthesized TLB load handler fastpath (32 instructions).
Synthesized TLB store handler fastpath (32 instructions).
Synthesized TLB modify handler fastpath (31 instructions).
PID hash table entries: 128 (order: 7, 512 bytes)
Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
Memory: 28768k/32768k available (2025k kernel code, 4000k reserved, 422k data, 128k init, 0k highmem)
Mount-cache hash table entries: 512
net_namespace: 64 bytes
NET: Registered protocol family 16
Time: MIPS clocksource has been installed.
NET: Registered protocol family 2
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
TCP established hash table entries: 1024 (order: 1, 8192 bytes)
TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
TCP: Hash tables configured (established 1024 bind 1024)
TCP reno registered
squashfs: version 3.0 (2006/03/15) Phillip Lougher
Registering mini_fo version $Id$
JFFS2 version 2.2. (NAND) (SUMMARY)  Ã‚Ã‚Â© 2001-2006 Red Hat, Inc.
io scheduler noop registered
io scheduler deadline registered (default)
Serial: 8250/16550 driver $Revision: 1.90 $ 2 ports, IRQ sharing disabled
serial8250: ttyS0 at MMIO 0x8610e00 (irq = 15) is a TI-AR7
console handover: boot [early0] -&gt; real [ttyS0]
serial8250: ttyS1 at MMIO 0x8610f00 (irq = 16) is a TI-AR7
Fixed MDIO Bus: probed
cpmac-mii: probed
cpmac: device eth0 (regs: 08612800, irq: 41, phy: 0:10, mac: 00:30:54:97:1d:b1)
cpmac: device eth1 (regs: 08610000, irq: 27, phy: 0:1f, mac: 00:30:54:97:1d:b1)
physmap platform flash device: 00800000 at 10000000
physmap-flash.0: Found 1 x16 devices at 0x0 in 16-bit bank
 Amd/Fujitsu Extended Query Table at 0x0040
number of CFI chips: 1
cfi_cmdset_0002: Disabling erase-suspend-program due to code brokenness.
cmdlinepart partition parsing not available
RedBoot partition parsing not available
Unknown magic: 8cf65fb6
4 ar7part partitions found on MTD device physmap-flash.0
Creating 4 MTD partitions on &quot;physmap-flash.0&quot;:
0x00000000-0x00010000 : &quot;loader&quot;
0x00010000-0x00020000 : &quot;config&quot;
0x000b0000-0x00800000 : &quot;linux&quot;
0x000e0000-0x00800000 : &quot;rootfs&quot;
mtd: partition &quot;rootfs&quot; set to be root filesystem
split_squashfs: no squashfs found in &quot;physmap-flash.0&quot;
ar7_wdt: timer margin 59 seconds (prescale 65535, change 57180, freq 62500000)
Registered led device: status
vlynq0: regs 0x08611800, irq 29, mem 0x04000000
vlynq1: regs 0x08611c00, irq 33, mem 0x0c000000
nf_conntrack version 0.5.0 (1024 buckets, 4096 max)
ip_tables: (C) 2000-2006 Netfilter Core Team
TCP vegas registered
NET: Registered protocol family 1
NET: Registered protocol family 17
802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;
All bugs added by David S. Miller &lt;davem@redhat.com&gt;
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00000000: 0x997a instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00000004: 0x53eb instead
(---removed several jffs2 lines---)
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00150020: 0x2ba7 instead
jffs2_scan_eraseblock(): Magic bitmask 0x1985 not found at 0x00150024: 0xc2bb instead
Further such events for this erase block will not be printed
Cowardly refusing to erase blocks on filesystem with no valid JFFS2 nodes
empty_blocks 92, bad_blocks 0, c-&gt;nr_blocks 114
VFS: Cannot open root device &quot;&lt;NULL&gt;&quot; or unknown-block(31,3)
Please append a correct &quot;root=&quot; boot option; here are the available partitions:
1f00         64 mtdblock0 (driver?)
1f01         64 mtdblock1 (driver?)
1f02       7488 mtdblock2 (driver?)
1f03       7296 mtdblock3 (driver?)
Kernel panic - not syncing: VFS: Unable to mount root fs on unknown-block(31,3)
Rebooting in 3 seconds..</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p65311">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Wodin</div>
					<div class="post-datetime">
						18 Mar 2008, 00:44					</div>
				</div>
				<div class="post-content content">
					<p>Try booting from mtd4 instead of mtd1.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p65315">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">carmadamus</div>
					<div class="post-datetime">
						18 Mar 2008, 01:07					</div>
				</div>
				<div class="post-content content">
					<p>Where can I define this?</p><div class="codebox"><pre><code>setenv BOOTCFG m:f:&quot;mtd4&quot;</code></pre></div><p>doesn&#039;t boot at all.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p65316">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">carmadamus</div>
					<div class="post-datetime">
						18 Mar 2008, 01:29					</div>
				</div>
				<div class="post-content content">
					<p>I think <strong>Unknown magic: 8cf65fb6</strong> is the problem. I created the single image with a tool from TI because all the other images created by OpenWRT imagemaker wouldn&#039;t work.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>