<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Bricked Netgear WGR614v7</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 15 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p83308">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">cea</div>
					<div class="post-datetime">
						6 Mar 2009, 11:28					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I&#039;m an owner of the Netgear WGR614v7 router (Atheros AR2317, 2MB Flash MX25L1605 and 8MB RAM). One day I decided to upgrade its firmware to DD-WRT (DLINK DIR-300). I got into VxWorks bootloader by serial console and configure to boot &quot;ap61.ram&quot; image via ftp. Everything was fine until I entered: &quot;fis create -l 0x30000 -e 0xbfc00000 RedBoot&quot; command, after that my router is dead. </p><br /><div class="quotebox"><blockquote><p>ar531xPlus rev 0x00000090 firmware startup...</p><br /><p>Netgear WGR614v7 version 4.1.4.17<br />Creation date: Apr&nbsp; 7 2006, 09:24:09</p><p> 0<br />auto-booting...</p><p>Attached TCP/IP interface to et0.<br />Attaching network interface lo0... done.<br />Loading... 257792<br />Starting at 0x800410bc...</p><p>+Invalid PHY ID1 for enet0 port0.&nbsp; Expected 0x0243, read 0x0000<br />Ethernet eth0: MAC address 00:1b:2f:05:de:e9<br />IP: 192.168.1.1/255.255.255.0, Gateway: 0.0.0.0<br />Default server: 0.0.0.0</p><p>RedBoot(tm) bootstrap and debug environment [RAM]<br />production release, version &quot;2.1.3&quot; - built 18:43:37, Sep 20 2007</p><p>Platform: ap61 (Atheros WiSOC)<br />Copyright (C) 2000, 2001, 2002, 2003, 2004 Red Hat, Inc.<br />Copyright (C) 2007, NewMedia-NET GmbH.</p><p>Board: DLINK DIR-300<br />RAM: 0x80000000-0x81000000, [0x8007ff00-0x80fe1000] available<br />FLASH: 0xbfc00000 - 0xbfdf0000, 32 blocks of 0x00010000 bytes each.<br />DD-WRT&gt;<br />DD-WRT&gt; fconfig -i<br />Relocating Board Data to new location<br />Board Data is already relocated(1)!<br />Initialize non-volatile configuration - continue (y/n)? y<br />Run script at boot: false<br />Use BOOTP for network configuration: true<br />Default server IP address:<br />Console baud rate: 9600<br />GDB connection port: 9000<br />Force console for special debug messages: false<br />Network debug at boot time: false<br />Update RedBoot non-volatile configuration - continue (y/n)? y<br />... Erase from 0xbfde0000-0xbfdf0000: .<br />... Program from 0x80ff0000-0x81000000 at 0xbfde0000: .<br />DD-WRT&gt; fis init<br />About to initialize [format] FLASH image system - continue (y/n)? y<br />*** Initialize FLASH Image System<br />Relocating Board Data to new location.<br />Board Data is already relocated(1)!<br />... Erase from 0xbfde0000-0xbfdf0000: .<br />... Program from 0x80ff0000-0x81000000 at 0xbfde0000: .<br />DD-WRT&gt; ip_address -h 192.168.1.100<br />IP: 192.168.1.1/255.255.255.0, Gateway: 0.0.0.0<br />Default server: 192.168.1.100<br />DD-WRT&gt; load -r -b %{FREEMEMLO} ap61.rom<br />Using default protocol (TFTP)<br />Raw file loaded 0x80080000-0x800a8717, assumed entry at 0x80080000<br />DD-WRT&gt; fis create -l 0x30000 -e 0xbfc00000 RedBoot<br />An image named &#039;RedBoot&#039; exists - continue (y/n)? y<br />... Erase from 0xbfc00000-0xbfc30000: ...<br />... Program from 0x80080000-0x800a8718 at 0xbfc00000: ...<br />... Erase from 0xbfde0000-0xbfdf0000: .<br />... Program from 0x80ff0000-0x81000000 at 0xbfde0000: .<br />DD-WRT&gt; fis list<br />Name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FLASH addr&nbsp; Mem addr&nbsp; &nbsp; Length&nbsp; &nbsp; &nbsp; Entry point<br />RedBoot&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0xBFC00000&nbsp; 0x80080000&nbsp; 0x00030000&nbsp; 0xBFC00000<br />FIS directory&nbsp; &nbsp; &nbsp;0xBFDE0000&nbsp; 0xBFDE0000&nbsp; 0x0000F000&nbsp; 0x00000000<br />RedBoot config&nbsp; &nbsp; 0xBFDEF000&nbsp; 0xBFDEF000&nbsp; 0x00001000&nbsp; 0x00000000<br />DD-WRT&gt; reset<br />... Resetting.</p></blockquote></div><p>So I built buffered wiggler cable and connected it to EJTAG connector in my router. Unfortunatelly urjtag and jtag-0.6 do not recognize flash therefore I decided to use tjtagv (v3.0 RC1 Tornado-MOD). The program recognize my hardware and allow to read/write flash. I copied &quot;ap61.rom&quot; to CFE.BIN and wrote it to flash by &quot;tjtag -flash:cfe /wiggler&quot; command. But when I read the flash (-backup:cfe) and compared it with original file I noticed that each byte is swapped:</p><p>Original file:&nbsp; &nbsp;3C 04 B1 00 34 84 00 64<br />Read from flash: 00 B1 04 3C 64 00 84 34</p><p>As you see 1-st byte is swapped with 4-th byte, 2-nd with 3-rd, 3-rd with 2-nd and 4-th with 1-st. Is this normal? Do I have to prepare file with swapped bytes and write it to flash?</p><p>I&#039;m not sure if &quot;ap61.rom&quot; bootloader file is suitable to my router, unfortunately the router doesn&#039;t boot after uploading it to flash.<br />I suspect that some nvram file is needed but don&#039;t have any.<br />Can anybody help me, what should I do to bring the router to live?</p><p>Best regards.<br />Tom Cea.</p><div class="quotebox"><blockquote><p>c:\2\tjtag&gt;tjtag -probeonly /wiggler</p><p>==============================================<br /> EJTAG Debrick Utility v3.0 RC1 Tornado-MOD<br />==============================================</p><p>Probing bus ... Done</p><p>Instruction Length set to 5</p><p>CPU Chip ID: 00000000000000000000000000000001 (00000001)<br />*** Found a Atheros AR531X/231X CPU chip ***</p><p>&nbsp; &nbsp; - EJTAG IMPCODE ....... : 01000000010000000100000000000000 (40404000)<br />&nbsp; &nbsp; - EJTAG Version ....... : 2.6<br />&nbsp; &nbsp; - EJTAG DMA Support ... : No<br />&nbsp; &nbsp; - EJTAG Implementation flags: R4k ASID_8 NoDMA MIPS32</p><p>Issuing Processor / Peripheral Reset ...&nbsp; ECR: 0x80000000 Done<br />Enabling Memory Writes ... Skipped<br />Halting Processor ...<br />00000000000100010000000000000000 (00110000)<br />00000000000000000000000000000000 (00000000)<br />&lt;Processor Entered Debug Mode!&gt; ... Done<br />Clearing Watchdog ... Done<br />Enabling Atheros Flash Read/Write ... Done</p><p>.RE-Probing Atheros processor....<br />..Found a Atheros AR2317</p><p>Probing Flash at (Flash Window: 0x1fc00000) ...<br />Done</p><p>Flash Vendor ID: 00000000000000000000000011000010 (000000C2)<br />Flash Device ID: 00000000000000000010000000010101 (00002015)<br />*** Found a Macronix MX25L1605D&nbsp; &nbsp; &nbsp; &nbsp; (2MB) Serial Flash Chip ***</p><p>&nbsp; &nbsp; - Flash Chip Window Start .... : 1fc00000<br />&nbsp; &nbsp; - Flash Chip Window Length ... : 00200000<br />&nbsp; &nbsp; - Selected Area Start ........ : 00000000<br />&nbsp; &nbsp; - Selected Area Length ....... : 00000000</p><br /><br /><p> *** REQUESTED OPERATION IS COMPLETE ***</p><p>Resuming Processor ...<br />DEBUGMODULE: Return from DEBUG!<br /> ECR: 0x0000c000</p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p83309">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Bartman007</div>
					<div class="post-datetime">
						6 Mar 2009, 11:35					</div>
				</div>
				<div class="post-content content">
					<p>This is not the dd-wrt forum. We do not support their ap61 bootloader or tjtag.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p145763">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">drekthar</div>
					<div class="post-datetime">
						13 Oct 2011, 19:59					</div>
				</div>
				<div class="post-content content">
					<p>ddwrt does not support this router as it has only 2mb flash you can try openwrt with the redboot bootloader instead</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p148040">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">drekthar</div>
					<div class="post-datetime">
						9 Nov 2011, 18:06					</div>
				</div>
				<div class="post-content content">
					<p>dude the redboot bootloader you&#039;r trying to flash is for the 4mb flash and 16mb ram you should build your own redboot from source for the 2mb spi flash and 8mb ram .....</p><br /><p>ps what is the switch in that router</p>											<p class="post-edited">(Last edited by <strong>drekthar</strong> on 9 Nov 2011, 18:06)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>