<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> block a computer on the LAN for WAN access</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 29 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p39478">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">confiscated</div>
					<div class="post-datetime">
						22 Dec 2006, 17:21					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>I would like to block a computer with a certain IP address to access the Internet.. </p><p>hope somebody can help me with this. </p><br /><p>Also, would be nice but not nesc. if somebody knows how i can make this block for a time range, e.g. with cron like - unblock between 1pm and 4 pm <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>please also specify where i should put the commands, i.e. firewall.user or the firewall file which awk parses.</p>											<p class="post-edited">(Last edited by <strong>confiscated</strong> on 22 Dec 2006, 17:33)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p39499">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">geryhun</div>
					<div class="post-datetime">
						22 Dec 2006, 23:22					</div>
				</div>
				<div class="post-content content">
					<p>Blocking a host by it&#039;s IP address is not always a good idea, because IPs can be changed by the user, so it&#039;s very easy to get access to services blocked by IP-base... Maybe you could try blocking by the host&#039;s MAC address... iptables is the utility you need, but I am not sure if OpenWrt images have the necessary modules compiled in them to allow filtering by MAC-address (they should have... but I&#039;m unsure)<br />Unfortunately, I don&#039;t have the time (and maybe the knowledge) to help you, but I could tell you the basic steps, you need to take:</p><p>1, Block the access to the host, using a firewall rule (iptables) in the /etc/firewall.user file<br />2, Set up a record in the crontab file, which enables access to that host at 1pm - use iptables here, too<br />3, Set another record, which should run at 4pm every day, use the same command as you used in the firewall.user file</p><p>That&#039;s all, I think.</p><p>Bye!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p39501">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">Sonic</div>
					<div class="post-datetime">
						23 Dec 2006, 00:07					</div>
				</div>
				<div class="post-content content">
					<p>Yes IP method can be bypassed but for example it&#039;s okay to just block my little brother ...<br /></p><div class="codebox"><pre><code>iptables -A input_rule -s 192.168.0.96 -j REJECT</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p39914">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Corvus</div>
					<div class="post-datetime">
						30 Dec 2006, 23:19					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>geryhun wrote:</cite><blockquote><p>Blocking a host by it&#039;s IP address is not always a good idea, because IPs can be changed by the user, so it&#039;s very easy to get access to services blocked by IP-base... Maybe you could try blocking by the host&#039;s MAC address... iptables is the utility you need, but I am not sure if OpenWrt images have the necessary modules compiled in them to allow filtering by MAC-address (they should have... but I&#039;m unsure)<br />Unfortunately, I don&#039;t have the time (and maybe the knowledge) to help you, but I could tell you the basic steps, you need to take:</p><p>1, Block the access to the host, using a firewall rule (iptables) in the /etc/firewall.user file<br />2, Set up a record in the crontab file, which enables access to that host at 1pm - use iptables here, too<br />3, Set another record, which should run at 4pm every day, use the same command as you used in the firewall.user file</p><p>That&#039;s all, I think.</p><p>Bye!</p></blockquote></div><p>If you want to block on MAC-address, you can also use the &#039;Static Ip addresses (for DHCP)&#039; to make sure the pc always receives tha same ip address (based on the MAC address). You can find it on the gui under Network - Hosts</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p41402">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">ymhee_bcex</div>
					<div class="post-datetime">
						24 Jan 2007, 06:40					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Sonic wrote:</cite><blockquote><p>Yes IP method can be bypassed but for example it&#039;s okay to just block my little brother ...<br /></p><div class="codebox"><pre><code>iptables -A input_rule -s 192.168.0.96 -j REJECT</code></pre></div></blockquote></div><p>This works... However, shouldn&#039;t the following line in /etc/config/firewall do the same?<br /></p><div class="codebox"><pre><code>drop:src=192.168.0.96</code></pre></div><p>However, it doesn&#039;t seem to work. My little brother still gets out... Or firewall matches only WAN addresses? This is the line that gets generated by x-wrt, but that&#039;s besides the point.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p41412">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">calebz</div>
					<div class="post-datetime">
						24 Jan 2007, 11:08					</div>
				</div>
				<div class="post-content content">
					<p>Think&nbsp; you need to specify the interface the filter should be applied to but Im too noob to help ya.<br />Atm Im trying to make a filter that would only allow access for specified list of MACs that would ignore everything not specified in it.<br />Some1 hinted ebtables for it so Im reading 250pages of a tutorial so I dont mess up and end without router access <img src="https://forum.openwrt.org/img/smilies/tongue.png" width="15" height="15" alt="tongue" /><br />Try reading iptables tutorial/wiki/howtos and you should be able to figure it out by yourself.<br />Remember you need to restart the firewall script after each change!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p41783">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">ymhee_bcex</div>
					<div class="post-datetime">
						30 Jan 2007, 05:35					</div>
				</div>
				<div class="post-content content">
					<p>it is also peculiar, that when I add a line to firewall.user and restart it - the rules from config/firewall are no longer in effect. For example, if I have accept:dport=22 (to be able to control the router from outside), after I run firewall.user - I can&#039;t ssh to the box any more until I come home and re-enable those rules.</p><p>So, apparently, firewall.user wipes out firewall rules.</p><p>Anyway, back to my question - is it possible disable specific computer from accessing the internet?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p78037">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">RoundSparrow</div>
					<div class="post-datetime">
						13 Dec 2008, 18:51					</div>
				</div>
				<div class="post-content content">
					<p>Anyone have a solution to share?</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>