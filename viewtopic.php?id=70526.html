<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> TP-Link TL-MR3020 v1:phy0 exist but wlan0 missing</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 30 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p355870">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">ssyukrillah</div>
					<div class="post-datetime">
						9 Apr 2017, 09:17					</div>
				</div>
				<div class="post-content content">
					<p>Assalam from me to you all...<br />I Require all the master and expert help in my problem<br />after repair boot loop my TP-Link TL-MR3020 v1 then wlan0 was missing and only phy0 no wlan0</p><p>first cause:<br />reading the openwrt about mtdblock of tl-mr3020 there was only 5 mtd listed (u-boot,kernel,rootfs,config, and art)<br />then i try to &quot;cat /proc/mtd&quot;<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# cat /proc/mtd 
dev:    size   erasesize  name
mtd0: 00020000 00010000 &quot;u-boot&quot;
mtd1: 0010c4cc 00010000 &quot;kernel&quot;
mtd2: 002c3b34 00010000 &quot;rootfs&quot;
mtd3: 00090000 00010000 &quot;rootfs_data&quot;
mtd4: 00010000 00010000 &quot;art&quot;
mtd5: 003d0000 00010000 &quot;firmware&quot;</code></pre></div><p>found the 6th MTD5 named firmware, and made me intrest to know what was in it, then i try to mount it:<br /></p><div class="codebox"><pre><code>mount -t jffs2 /dev/mtdblock5 /tmp/mtd5</code></pre></div><p>but then error appear such I/O read error and i try to turn off and on again and bootloop happen.</p><p>Repair bootloop:<br />I&#039;ve done restore the original TL-MR3020v1 firmware and everything run well, the wifi run well, scan and connect as client wifi.. all good...<br />but then after trying to upgrade (flash) with openwrt firmware then wlan0 does not exist.<br />iw phy return phy0 detail<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# iw phy
Wiphy phy0
    max # scan SSIDs: 4
    max scan IEs length: 2257 bytes
    Retry short limit: 7
    Retry long limit: 4
    Coverage class: 0 (up to 0m)
    Device supports AP-side u-APSD.
    Device supports T-DLS.
    Available Antennas: TX 0x1 RX 0x1
    Configured Antennas: TX 0x1 RX 0x1
    Supported interface modes:
         * IBSS
         * managed
         * AP
         * AP/VLAN
         * WDS
         * monitor
         * mesh point
         * P2P-client
         * P2P-GO
    Band 1:
        Capabilities: 0x116e
            HT20/HT40
            SM Power Save disabled
            RX HT20 SGI
            RX HT40 SGI
            RX STBC 1-stream
            Max AMSDU length: 3839 bytes
            DSSS/CCK HT40
        Maximum RX AMPDU length 65535 bytes (exponent: 0x003)
        Minimum RX AMPDU time spacing: 8 usec (0x06)
        HT TX/RX MCS rate indexes supported: 0-7
        Frequencies:
            * 2412 MHz [1] (15.0 dBm)
            * 2417 MHz [2] (18.0 dBm)
            * 2422 MHz [3] (18.0 dBm)
            * 2427 MHz [4] (18.0 dBm)
            * 2432 MHz [5] (18.0 dBm)
            * 2437 MHz [6] (18.0 dBm)
            * 2442 MHz [7] (18.0 dBm)
            * 2447 MHz [8] (18.0 dBm)
            * 2452 MHz [9] (18.0 dBm)
            * 2457 MHz [10] (18.0 dBm)
            * 2462 MHz [11] (15.0 dBm)
            * 2467 MHz [12] (disabled)
            * 2472 MHz [13] (disabled)
            * 2484 MHz [14] (disabled)
    valid interface combinations:
         * #{ managed } &lt;= 2048, #{ AP, mesh point } &lt;= 8, #{ P2P-client, P2P-GO } &lt;= 1, #{ IBSS } &lt;= 1,
           total &lt;= 2048, #channels &lt;= 1, STA/AP BI must match
         * #{ WDS } &lt;= 2048,
           total &lt;= 2048, #channels &lt;= 1, STA/AP BI must match
         * #{ IBSS, AP, mesh point } &lt;= 1,
           total &lt;= 1, #channels &lt;= 1, STA/AP BI must match, radar detect widths: { 20 MHz (no HT), 20 MHz, 40 MHz }

    HT Capability overrides:
         * MCS: ff ff ff ff ff ff ff ff ff ff
         * maximum A-MSDU length
         * supported channel width
         * short GI for 40 MHz
         * max A-MPDU length exponent
         * min MPDU start spacing</code></pre></div><p>but iw dev does not return any wlan listed<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# iw dev
root@OpenWrt:~#</code></pre></div><p>then i try to create dev wlan0 manually using iw, and fail to bring wlan0 up and still cannot have my wlan works again until now<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# iw phy phy0 interface add wlan0 type managed
root@OpenWrt:~# iw dev
phy#0
    Interface wlan0
        ifindex 3716
        wdev 0xe81
        addr ff:ff:ff:ff:ff:ff
        type managed
root@OpenWrt:~# ifconfig wlan0 up
ifconfig: SIOCSIFFLAGS: Cannot assign requested address
root@OpenWrt:~#</code></pre></div><p>logread after first boot i believe needed here:<br /></p><div class="codebox"><pre><code>Wed Sep  9 04:08:10 2015 kern.notice kernel: [    0.000000] Kernel command line:  board=TL-MR3020  console=ttyATH0,115200 rootfstype=squashfs,jffs2 noinitrd
Wed Sep  9 04:08:10 2015 kern.info kernel: [    0.000000] PID hash table entries: 128 (order: -3, 512 bytes)
Wed Sep  9 04:08:10 2015 kern.info kernel: [    0.000000] Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
Wed Sep  9 04:08:10 2015 kern.info kernel: [    0.000000] Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
Wed Sep  9 04:08:10 2015 kern.info kernel: [    0.000000] Writing ErrCtl register=00000000
Wed Sep  9 04:08:10 2015 kern.info kernel: [    0.000000] Readback ErrCtl register=00000000
Wed Sep  9 04:08:10 2015 kern.warn kernel: [    0.000000] Memory: 28516K/32768K available (2621K kernel code, 129K rwdata, 344K rodata, 224K init, 194K bss, 4252K reserved)
Wed Sep  9 04:08:10 2015 kern.info kernel: [    0.000000] SLUB: HWalign=32, Order=0-3, MinObjects=0, CPUs=1, Nodes=1
Wed Sep  9 04:08:10 2015 kern.info kernel: [    0.000000] NR_IRQS:51
Wed Sep  9 04:08:10 2015 kern.info kernel: [    0.000000] Clocks: CPU:400.000MHz, DDR:400.000MHz, AHB:200.000MHz, Ref:25.000MHz
Wed Sep  9 04:08:10 2015 kern.info kernel: [    0.000000] Calibrating delay loop... 265.42 BogoMIPS (lpj=1327104)
Wed Sep  9 04:08:10 2015 kern.info kernel: [    0.080000] pid_max: default: 32768 minimum: 301
Wed Sep  9 04:08:10 2015 kern.info kernel: [    0.080000] Mount-cache hash table entries: 1024 (order: 0, 4096 bytes)
Wed Sep  9 04:08:10 2015 kern.info kernel: [    0.090000] Mountpoint-cache hash table entries: 1024 (order: 0, 4096 bytes)
Wed Sep  9 04:08:10 2015 kern.info kernel: [    0.100000] NET: Registered protocol family 16
Wed Sep  9 04:08:10 2015 kern.info kernel: [    0.100000] MIPS: machine is TP-LINK TL-MR3020
Wed Sep  9 04:08:10 2015 kern.debug kernel: [    0.130000] ar71xx: using random MAC address for eth0
Wed Sep  9 04:08:10 2015 kern.info kernel: [    0.370000] Switched to clocksource MIPS
Wed Sep  9 04:08:10 2015 kern.info kernel: [    0.370000] NET: Registered protocol family 2
Wed Sep  9 04:08:10 2015 kern.info kernel: [    0.380000] TCP established hash table entries: 1024 (order: 0, 4096 bytes)
Wed Sep  9 04:08:10 2015 kern.info kernel: [    0.380000] TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
Wed Sep  9 04:08:10 2015 kern.info kernel: [    0.380000] TCP: Hash tables configured (established 1024 bind 1024)
Wed Sep  9 04:08:10 2015 kern.info kernel: [    0.390000] TCP: reno registered
Wed Sep  9 04:08:10 2015 kern.info kernel: [    0.390000] UDP hash table entries: 256 (order: 0, 4096 bytes)
Wed Sep  9 04:08:10 2015 kern.info kernel: [    0.400000] UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
Wed Sep  9 04:08:10 2015 kern.info kernel: [    0.410000] NET: Registered protocol family 1
Wed Sep  9 04:08:10 2015 kern.debug kernel: [    0.410000] PCI: CLS 0 bytes, default 32
Wed Sep  9 04:08:10 2015 kern.info kernel: [    0.410000] futex hash table entries: 256 (order: -1, 3072 bytes)
Wed Sep  9 04:08:10 2015 kern.info kernel: [    0.440000] squashfs: version 4.0 (2009/01/31) Phillip Lougher
Wed Sep  9 04:08:10 2015 kern.info kernel: [    0.440000] jffs2: version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006 Red Hat, Inc.
Wed Sep  9 04:08:10 2015 kern.info kernel: [    0.450000] msgmni has been set to 55
Wed Sep  9 04:08:10 2015 kern.info kernel: [    0.460000] io scheduler noop registered
Wed Sep  9 04:08:10 2015 kern.info kernel: [    0.460000] io scheduler deadline registered (default)
Wed Sep  9 04:08:10 2015 kern.info kernel: [    0.460000] Serial: 8250/16550 driver, 16 ports, IRQ sharing enabled
Wed Sep  9 04:08:10 2015 kern.info kernel: [    0.470000] ar933x-uart: ttyATH0 at MMIO 0x18020000 (irq = 11, base_baud = 1562500) is a AR933X UART
Wed Sep  9 04:08:10 2015 kern.info kernel: [    0.480000] console [ttyATH0] enabled
Wed Sep  9 04:08:10 2015 kern.info kernel: [    0.490000] bootconsole [early0] disabled
Wed Sep  9 04:08:10 2015 kern.warn kernel: [    0.500000] m25p80 spi0.0: found s25sl032p, expected m25p80
Wed Sep  9 04:08:10 2015 kern.info kernel: [    0.500000] m25p80 spi0.0: s25sl032p (4096 Kbytes)
Wed Sep  9 04:08:10 2015 kern.notice kernel: [    0.510000] 5 tp-link partitions found on MTD device spi0.0
Wed Sep  9 04:08:10 2015 kern.notice kernel: [    0.520000] Creating 5 MTD partitions on &quot;spi0.0&quot;:
Wed Sep  9 04:08:10 2015 kern.notice kernel: [    0.520000] 0x000000000000-0x000000020000 : &quot;u-boot&quot;
Wed Sep  9 04:08:10 2015 kern.notice kernel: [    0.530000] 0x000000020000-0x00000012c4cc : &quot;kernel&quot;
Wed Sep  9 04:08:10 2015 kern.notice kernel: [    0.530000] 0x00000012c4cc-0x0000003f0000 : &quot;rootfs&quot;
Wed Sep  9 04:08:10 2015 kern.notice kernel: [    0.540000] mtd: device 2 (rootfs) set to be root filesystem
Wed Sep  9 04:08:10 2015 kern.notice kernel: [    0.540000] 1 squashfs-split partitions found on MTD device rootfs
Wed Sep  9 04:08:10 2015 kern.notice kernel: [    0.550000] 0x000000360000-0x0000003f0000 : &quot;rootfs_data&quot;
Wed Sep  9 04:08:10 2015 kern.notice kernel: [    0.550000] 0x0000003f0000-0x000000400000 : &quot;art&quot;
Wed Sep  9 04:08:10 2015 kern.notice kernel: [    0.560000] 0x000000020000-0x0000003f0000 : &quot;firmware&quot;
Wed Sep  9 04:08:10 2015 kern.info kernel: [    0.580000] libphy: ag71xx_mdio: probed
Wed Sep  9 04:08:10 2015 kern.info kernel: [    1.170000] ag71xx ag71xx.0: connected to PHY at ag71xx-mdio.1:04 [uid=004dd041, driver=Generic PHY]
Wed Sep  9 04:08:10 2015 kern.info kernel: [    1.180000] eth0: Atheros AG71xx at 0xb9000000, irq 4, mode:MII
Wed Sep  9 04:08:10 2015 kern.info kernel: [    1.180000] TCP: cubic registered
Wed Sep  9 04:08:10 2015 kern.info kernel: [    1.180000] NET: Registered protocol family 17
Wed Sep  9 04:08:10 2015 kern.info kernel: [    1.190000] bridge: automatic filtering via arp/ip/ip6tables has been deprecated. Update your scripts to load br_netfilter if you need this.
Wed Sep  9 04:08:10 2015 kern.notice kernel: [    1.200000] Bridge firewalling registered
Wed Sep  9 04:08:10 2015 kern.info kernel: [    1.200000] 8021q: 802.1Q VLAN Support v1.8
Wed Sep  9 04:08:10 2015 kern.info kernel: [    1.220000] VFS: Mounted root (squashfs filesystem) readonly on device 31:2.
Wed Sep  9 04:08:10 2015 kern.info kernel: [    1.230000] Freeing unused kernel memory: 224K (80368000 - 803a0000)
Wed Sep  9 04:08:10 2015 user.info kernel: [    2.520000] init: Console is alive
Wed Sep  9 04:08:10 2015 user.info kernel: [    2.520000] init: - watchdog -
Wed Sep  9 04:08:10 2015 kern.info kernel: [    4.120000] usbcore: registered new interface driver usbfs
Wed Sep  9 04:08:10 2015 kern.info kernel: [    4.130000] usbcore: registered new interface driver hub
Wed Sep  9 04:08:10 2015 kern.info kernel: [    4.130000] usbcore: registered new device driver usb
Wed Sep  9 04:08:10 2015 kern.info kernel: [    4.140000] ehci_hcd: USB 2.0 &#039;Enhanced&#039; Host Controller (EHCI) Driver
Wed Sep  9 04:08:10 2015 kern.info kernel: [    4.150000] ehci-platform: EHCI generic platform driver
Wed Sep  9 04:08:10 2015 kern.info kernel: [    4.150000] ehci-platform ehci-platform: EHCI Host Controller
Wed Sep  9 04:08:10 2015 kern.info kernel: [    4.160000] ehci-platform ehci-platform: new USB bus registered, assigned bus number 1
Wed Sep  9 04:08:10 2015 kern.info kernel: [    4.170000] ehci-platform ehci-platform: irq 3, io mem 0x1b000000
Wed Sep  9 04:08:10 2015 kern.info kernel: [    4.190000] ehci-platform ehci-platform: USB 2.0 started, EHCI 1.00
Wed Sep  9 04:08:10 2015 kern.info kernel: [    4.190000] hub 1-0:1.0: USB hub found
Wed Sep  9 04:08:10 2015 kern.info kernel: [    4.190000] hub 1-0:1.0: 1 port detected
Wed Sep  9 04:08:10 2015 kern.info kernel: [    4.520000] usb 1-1: new high-speed USB device number 2 using ehci-platform
Wed Sep  9 04:08:10 2015 user.info kernel: [    4.620000] init: - preinit -
Wed Sep  9 04:08:10 2015 kern.info kernel: [    4.850000] hub 1-1:1.0: USB hub found
Wed Sep  9 04:08:10 2015 kern.info kernel: [    4.850000] hub 1-1:1.0: 4 ports detected
Wed Sep  9 04:08:10 2015 kern.notice kernel: [    5.430000] random: procd urandom read with 9 bits of entropy available
Wed Sep  9 04:08:10 2015 kern.info kernel: [    8.210000] eth0: link up (100Mbps/Full duplex)
Wed Sep  9 04:08:10 2015 kern.notice kernel: [    8.710000] jffs2: notice: (355) jffs2_build_xattr_subsystem: complete building xattr subsystem, 0 of xdatum (0 unchecked, 0 orphan) and 0 of xref (0 dead, 0 orphan) found.
Wed Sep  9 04:08:10 2015 user.info kernel: [    8.730000] mount_root: switching to jffs2 overlay
Wed Sep  9 04:08:10 2015 kern.info kernel: [    8.780000] eth0: link down
Wed Sep  9 04:08:10 2015 user.info kernel: [    8.790000] procd: - early -
Wed Sep  9 04:08:10 2015 user.info kernel: [    8.790000] procd: - watchdog -
Wed Sep  9 04:08:10 2015 user.info kernel: [    9.630000] procd: - ubus -
Wed Sep  9 04:08:10 2015 user.info kernel: [   10.640000] procd: - init -
Wed Sep  9 04:08:10 2015 kern.info kernel: [   11.710000] NET: Registered protocol family 10
Wed Sep  9 04:08:10 2015 kern.info kernel: [   11.720000] ip6_tables: (C) 2000-2006 Netfilter Core Team
Wed Sep  9 04:08:10 2015 kern.info kernel: [   11.740000] Loading modules backported from Linux version master-2015-03-09-0-g141f155
Wed Sep  9 04:08:10 2015 kern.info kernel: [   11.740000] Backport generated by backports.git backports-20150129-0-gdd4a670
Wed Sep  9 04:08:10 2015 kern.info kernel: [   11.750000] ip_tables: (C) 2000-2006 Netfilter Core Team
Wed Sep  9 04:08:10 2015 kern.info kernel: [   11.770000] nf_conntrack version 0.5.0 (449 buckets, 1796 max)
Wed Sep  9 04:08:10 2015 kern.info kernel: [   11.820000] xt_time: kernel timezone is -0000
Wed Sep  9 04:08:10 2015 kern.info kernel: [   11.850000] cfg80211: Calling CRDA to update world regulatory domain
Wed Sep  9 04:08:10 2015 kern.info kernel: [   11.850000] cfg80211: World regulatory domain updated:
Wed Sep  9 04:08:10 2015 kern.info kernel: [   11.860000] cfg80211:  DFS Master region: unset
Wed Sep  9 04:08:10 2015 kern.info kernel: [   11.860000] cfg80211:   (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp), (dfs_cac_time)
Wed Sep  9 04:08:10 2015 kern.info kernel: [   11.870000] cfg80211:   (2402000 KHz - 2472000 KHz @ 40000 KHz), (N/A, 2000 mBm), (N/A)
Wed Sep  9 04:08:10 2015 kern.info kernel: [   11.880000] cfg80211:   (2457000 KHz - 2482000 KHz @ 40000 KHz), (N/A, 2000 mBm), (N/A)
Wed Sep  9 04:08:10 2015 kern.info kernel: [   11.890000] cfg80211:   (2474000 KHz - 2494000 KHz @ 20000 KHz), (N/A, 2000 mBm), (N/A)
Wed Sep  9 04:08:10 2015 kern.info kernel: [   11.900000] cfg80211:   (5170000 KHz - 5250000 KHz @ 80000 KHz), (N/A, 2000 mBm), (N/A)
Wed Sep  9 04:08:10 2015 kern.info kernel: [   11.900000] cfg80211:   (5250000 KHz - 5330000 KHz @ 80000 KHz, 160000 KHz AUTO), (N/A, 2000 mBm), (0 s)
Wed Sep  9 04:08:10 2015 kern.info kernel: [   11.910000] cfg80211:   (5490000 KHz - 5730000 KHz @ 160000 KHz), (N/A, 2000 mBm), (0 s)
Wed Sep  9 04:08:10 2015 kern.info kernel: [   11.920000] cfg80211:   (5735000 KHz - 5835000 KHz @ 80000 KHz), (N/A, 2000 mBm), (N/A)
Wed Sep  9 04:08:10 2015 kern.info kernel: [   11.930000] cfg80211:   (57240000 KHz - 63720000 KHz @ 2160000 KHz), (N/A, 0 mBm), (N/A)
Wed Sep  9 04:08:10 2015 kern.info kernel: [   12.010000] PPP generic driver version 2.4.2
Wed Sep  9 04:08:10 2015 kern.info kernel: [   12.020000] NET: Registered protocol family 24
Wed Sep  9 04:08:10 2015 kern.debug kernel: [   12.100000] ath: EEPROM regdomain: 0x0
Wed Sep  9 04:08:10 2015 kern.debug kernel: [   12.100000] ath: EEPROM indicates default country code should be used
Wed Sep  9 04:08:10 2015 kern.debug kernel: [   12.100000] ath: doing EEPROM country-&gt;regdmn map search
Wed Sep  9 04:08:10 2015 kern.debug kernel: [   12.100000] ath: country maps to regdmn code: 0x3a
Wed Sep  9 04:08:10 2015 kern.debug kernel: [   12.100000] ath: Country alpha2 being used: US
Wed Sep  9 04:08:10 2015 kern.debug kernel: [   12.100000] ath: Regpair used: 0x3a
Wed Sep  9 04:08:10 2015 kern.debug kernel: [   12.110000] ieee80211 phy0: Selected rate control algorithm &#039;minstrel_ht&#039;
Wed Sep  9 04:08:10 2015 kern.info kernel: [   12.110000] ieee80211 phy0: Atheros AR9330 Rev:1 mem=0xb8100000, irq=2
Wed Sep  9 04:08:10 2015 kern.info kernel: [   12.120000] cfg80211: Calling CRDA for country: US
Wed Sep  9 04:08:10 2015 kern.info kernel: [   12.130000] cfg80211: Regulatory domain changed to country: US
Wed Sep  9 04:08:10 2015 kern.info kernel: [   12.140000] cfg80211:  DFS Master region: FCC
Wed Sep  9 04:08:10 2015 kern.info kernel: [   12.140000] cfg80211:   (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp), (dfs_cac_time)
Wed Sep  9 04:08:10 2015 kern.info kernel: [   12.150000] cfg80211:   (2402000 KHz - 2472000 KHz @ 40000 KHz), (N/A, 3000 mBm), (N/A)
Wed Sep  9 04:08:10 2015 kern.info kernel: [   12.160000] cfg80211:   (5170000 KHz - 5250000 KHz @ 80000 KHz, 160000 KHz AUTO), (N/A, 1700 mBm), (N/A)
Wed Sep  9 04:08:10 2015 kern.info kernel: [   12.170000] cfg80211:   (5250000 KHz - 5330000 KHz @ 80000 KHz, 160000 KHz AUTO), (N/A, 2300 mBm), (0 s)
Wed Sep  9 04:08:10 2015 kern.info kernel: [   12.180000] cfg80211:   (5735000 KHz - 5835000 KHz @ 80000 KHz), (N/A, 3000 mBm), (N/A)
Wed Sep  9 04:08:10 2015 kern.info kernel: [   12.190000] cfg80211:   (57240000 KHz - 63720000 KHz @ 2160000 KHz), (N/A, 4000 mBm), (N/A)
Wed Sep  9 04:08:15 2015 authpriv.info dropbear[828]: Not backgrounding
Wed Sep  9 04:08:16 2015 user.emerg syslog: setting up led USB
Wed Sep  9 04:08:16 2015 user.emerg syslog: setting up led WLAN
Wed Sep  9 04:08:16 2015 user.emerg syslog: setting up led LAN
Wed Sep  9 04:08:17 2015 daemon.info procd: - init complete -
Wed Sep  9 04:08:18 2015 kern.info kernel: [   22.550000] device eth0 entered promiscuous mode
Wed Sep  9 04:08:18 2015 kern.info kernel: [   22.550000] IPv6: ADDRCONF(NETDEV_UP): br-lan: link is not ready
Wed Sep  9 04:08:18 2015 daemon.notice netifd: Interface &#039;lan&#039; is enabled
Wed Sep  9 04:08:18 2015 daemon.notice netifd: Interface &#039;lan&#039; is setting up now
Wed Sep  9 04:08:18 2015 daemon.notice netifd: Interface &#039;lan&#039; is now up
Wed Sep  9 04:08:18 2015 daemon.notice netifd: Interface &#039;loopback&#039; is enabled
Wed Sep  9 04:08:18 2015 daemon.notice netifd: Interface &#039;loopback&#039; is setting up now
Wed Sep  9 04:08:18 2015 daemon.notice netifd: Interface &#039;loopback&#039; is now up
Wed Sep  9 04:08:18 2015 daemon.notice netifd: Network device &#039;lo&#039; link is up
Wed Sep  9 04:08:18 2015 daemon.notice netifd: Interface &#039;loopback&#039; has link connectivity 
Wed Sep  9 04:08:18 2015 user.notice firewall: Reloading firewall due to ifup of lan (br-lan)
Wed Sep  9 04:08:20 2015 daemon.notice netifd: radio0 (904): Configuration file: /var/run/hostapd-phy0.conf
Wed Sep  9 04:08:20 2015 daemon.notice netifd: radio0 (904): nl80211: deinit ifname=wlan0 disabled_11b_rates=0
Wed Sep  9 04:08:20 2015 daemon.notice netifd: radio0 (904): nl80211 driver initialization failed.
Wed Sep  9 04:08:20 2015 daemon.notice netifd: radio0 (904): wlan0: interface state UNINITIALIZED-&gt;DISABLED
Wed Sep  9 04:08:20 2015 daemon.notice netifd: radio0 (904): wlan0: AP-DISABLED 
Wed Sep  9 04:08:20 2015 daemon.notice netifd: radio0 (904): hostapd_free_hapd_data: Interface wlan0 wasn&#039;t started
Wed Sep  9 04:08:20 2015 daemon.notice netifd: radio0 (904): cat: can&#039;t open &#039;/var/run/wifi-phy0.pid&#039;: No such file or directory
Wed Sep  9 04:08:20 2015 kern.info kernel: [   24.800000] eth0: link up (100Mbps/Full duplex)
Wed Sep  9 04:08:20 2015 daemon.notice netifd: radio0 (904): Command failed: Invalid argument
Wed Sep  9 04:08:20 2015 daemon.notice netifd: radio0 (904): Device setup failed: HOSTAPD_START_FAILED
Wed Sep  9 04:08:20 2015 kern.info kernel: [   25.020000] br-lan: port 1(eth0) entered forwarding state
Wed Sep  9 04:08:20 2015 kern.info kernel: [   25.020000] br-lan: port 1(eth0) entered forwarding state
Wed Sep  9 04:08:20 2015 kern.info kernel: [   25.030000] IPv6: ADDRCONF(NETDEV_CHANGE): br-lan: link becomes ready
Wed Sep  9 04:08:20 2015 daemon.notice netifd: Network device &#039;eth0&#039; link is up
Wed Sep  9 04:08:20 2015 daemon.notice netifd: Bridge &#039;br-lan&#039; link is up
Wed Sep  9 04:08:20 2015 daemon.notice netifd: Interface &#039;lan&#039; has link connectivity 
Wed Sep  9 04:08:22 2015 kern.info kernel: [   27.020000] br-lan: port 1(eth0) entered forwarding state
Wed Sep  9 04:08:23 2015 daemon.info dnsmasq[1072]: started, version 2.73 cachesize 150
Wed Sep  9 04:08:23 2015 daemon.info dnsmasq[1072]: compile time options: IPv6 GNU-getopt no-DBus no-i18n no-IDN DHCP no-DHCPv6 no-Lua TFTP no-conntrack no-ipset no-auth no-DNSSEC loop-detect inotify
Wed Sep  9 04:08:23 2015 daemon.info dnsmasq[1072]: DNS service limited to local subnets
Wed Sep  9 04:08:23 2015 daemon.info dnsmasq-dhcp[1072]: DHCP, IP range 192.168.1.100 -- 192.168.1.249, lease time 12h
Wed Sep  9 04:08:23 2015 daemon.info dnsmasq[1072]: using local addresses only for domain lan
Wed Sep  9 04:08:23 2015 daemon.warn dnsmasq[1072]: no servers found in /tmp/resolv.conf.auto, will retry
Wed Sep  9 04:08:23 2015 daemon.info dnsmasq[1072]: read /etc/hosts - 1 addresses
Wed Sep  9 04:08:23 2015 daemon.info dnsmasq[1072]: read /tmp/hosts/dhcp - 1 addresses
Wed Sep  9 04:08:23 2015 daemon.info dnsmasq-dhcp[1072]: read /etc/ethers - 0 addresses
Wed Sep  9 04:08:23 2015 daemon.warn odhcpd[796]: DHCPV6 CONFIRM IA_NA from 0004552fd28bb58e3cd73b2a5233d7bb628e on br-lan: not on-link 
Wed Sep  9 04:08:24 2015 daemon.info dnsmasq[1072]: read /etc/hosts - 1 addresses
Wed Sep  9 04:08:24 2015 daemon.info dnsmasq[1072]: read /tmp/hosts/odhcpd - 0 addresses
Wed Sep  9 04:08:24 2015 daemon.info dnsmasq[1072]: read /tmp/hosts/dhcp - 1 addresses
Wed Sep  9 04:08:24 2015 daemon.info dnsmasq-dhcp[1072]: read /etc/ethers - 0 addresses
Wed Sep  9 04:08:24 2015 daemon.info dnsmasq-dhcp[1072]: DHCPREQUEST(br-lan) 192.168.1.200 3c:97:0e:43:1f:ec 
Wed Sep  9 04:08:24 2015 daemon.info dnsmasq-dhcp[1072]: DHCPACK(br-lan) 192.168.1.200 3c:97:0e:43:1f:ec debianlenovo
Wed Sep  9 04:08:24 2015 daemon.warn odhcpd[796]: DHCPV6 SOLICIT IA_NA from 0004552fd28bb58e3cd73b2a5233d7bb628e on br-lan: ok fd30:b428:6f96::aec/128 
Wed Sep  9 04:08:25 2015 daemon.warn odhcpd[796]: DHCPV6 REQUEST IA_NA from 0004552fd28bb58e3cd73b2a5233d7bb628e on br-lan: ok fd30:b428:6f96::aec/128 
Wed Sep  9 04:08:25 2015 daemon.info dnsmasq[1072]: read /etc/hosts - 1 addresses
Wed Sep  9 04:08:25 2015 daemon.info dnsmasq[1072]: read /tmp/hosts/odhcpd - 1 addresses
Wed Sep  9 04:08:25 2015 daemon.info dnsmasq[1072]: read /tmp/hosts/dhcp - 1 addresses
Wed Sep  9 04:08:25 2015 daemon.info dnsmasq-dhcp[1072]: read /etc/ethers - 0 addresses
Wed Sep  9 04:09:03 2015 authpriv.info dropbear[1147]: Child connection from 192.168.1.200:44181
Wed Sep  9 04:09:06 2015 authpriv.notice dropbear[1147]: Pubkey auth succeeded for &#039;root&#039; with key md5 b2:e8:b6:e7:d7:d2:69:5e:c6:18:b6:f9:53:ae:c7:5b from 192.168.1.200:44181
Wed Sep  9 04:09:06 2015 kern.notice kernel: [   71.230000] random: nonblocking pool is initialized</code></pre></div><p>i&#039;ve been googleing some and no luck and i believe there was no person that wanted to know what is in &quot;mtd5:firmwware&quot; is then i really need some help from the master and the expert from here<br />thank you so much for you even only to read my problem here :-)</p><br /><p>EDIT:<br />after try and error more on openwrt image and then i think to reflash it with original firmware, and then suddenly now even with the original firmware of tplink still cannot connect wifi, now it become worse and i guess i might made the art image broken. maybe there is some one have the art image of tl mr 3020 v1 that i can try to reflash to my art mtd so it might be fixed my wifi router.. please.... just cat /dev/mtdblock4 &gt; art.img the file that i need because i&#039;ve been googleing some to find it and no luck until now :-(</p><br /><p>Case identified, PROBLEM SOLVED:<br />after trying ddwrt i realize that i mess with MAC address, i did not see that with openwrt because wlan0 was not shown up.<br /></p><div class="codebox"><pre><code>root@DD-WRT:~# iw dev
phy#0
        Interface ath0
                ifindex 9
                wdev 0x3
                addr ff:ff:ff:ff:ff:ff
                type managed
                channel -43 (2192 MHz) NO HT</code></pre></div><p>ddwrt shown that addr was ff:ff:ff:ff:ff:ff<br />and eth become 00:11:22:33:44:55 as listed my netdiscover below<br /></p><div class="codebox"><pre><code> 1 Captured ARP Req/Rep packets, from 1 hosts.   Total size: 60                
 _____________________________________________________________________________
   IP            At MAC Address      Count  Len   MAC Vendor                   
 ----------------------------------------------------------------------------- 
 192.168.1.1     00:11:22:33:44:55    01    060   CIMSYS Inc</code></pre></div><p>and when using original tplink fw, mac address was set also randomly:<br />both wire and wireless MAC was 00-0A-EB-13-7B-00 and that&#039;s was not the original factory MAC<br /></p><div class="codebox"><pre><code>tplink:
Wired
MAC Address:    
00-0A-EB-13-7B-00
IP Address:    
192.168.0.254
Subnet Mask:    
255.255.255.0

Wireless
Operation Mode:    Access Point
Name (SSID):    TP-LINK_POCKET_3020_137B00
Channel:    Auto (Current channel 11)
Mode:    11bgn mixed
Channel Width:    Automatic
MAC Address:    00-0A-EB-13-7B-00</code></pre></div><p>then i try to reflash with openwrt and using luci wifi menu&gt;create client wifi&gt;interfaces menu&gt;edit wwan&gt;advance setting&gt;set &quot;Override MAC address&quot; manually to random mac address&gt;restart&gt; then... it&#039;s alive....<br />and i got my wifi back just now i am using it to connect as client.<br />iw dev now come up:<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# iw dev
phy#0
    Interface wlan0
        ifindex 7
        wdev 0x4
        addr 46:66:3b:97:31:8a
        type managed
        channel 1 (2412 MHz), width: 20 MHz, center1: 2412 MHz</code></pre></div><p>i am glad also thank&#039;s to mk24 to tell me that my wifi card was fine and i do continue my research.</p><p>and come up new question, where openwrt found default mac address?? is that default set from hardware? and how come my wifi mac missing? is that coded at &quot;art&quot; partition? or i mess with firmware partition affected to MAC address??<br />how to repair missing factory mac address? even no need to repair it but yes i wonder to know, i might googleing some for that</p>											<p class="post-edited">(Last edited by <strong>ssyukrillah</strong> on 12 Apr 2017, 21:20)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p355885">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">mk24</div>
					<div class="post-datetime">
						9 Apr 2017, 17:18					</div>
				</div>
				<div class="post-content content">
					<p>If you get results from iw interrogating the wifi driver, the ART partition is probably OK.&nbsp; If ART is corrupted, the wifi driver does not start at all.</p><p>When first flashed, OpenWrt does not set up any wifi.&nbsp; This is intentional, to not have the security risk of an open AP like stock firmware defaults to.&nbsp; </p><p>Does it work if you use the web page or edit /etc/config/wireless to set up wifi.&nbsp; You do not need to manually create interfaces, the UCI system does that based on the contents of /etc/config/wireless.</p>											<p class="post-edited">(Last edited by <strong>mk24</strong> on 9 Apr 2017, 17:20)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p356073">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">ssyukrillah</div>
					<div class="post-datetime">
						12 Apr 2017, 02:46					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>mk24 wrote:</cite><blockquote><p>If you get results from iw interrogating the wifi driver, the ART partition is probably OK.&nbsp; If ART is corrupted, the wifi driver does not start at all.</p><p>When first flashed, OpenWrt does not set up any wifi.&nbsp; This is intentional, to not have the security risk of an open AP like stock firmware defaults to.&nbsp; </p><p>Does it work if you use the web page or edit /etc/config/wireless to set up wifi.&nbsp; You do not need to manually create interfaces, the UCI system does that based on the contents of /etc/config/wireless.</p></blockquote></div><p>you are right, my first try restore tplink firmware works normal, and everytime i try to flash it with openwrt then iw dev did not show any dev, only iw phy show phy0, then i reflash with tplink and it work normal again... this is so confusing me</p><p>i got the image from wiki openwrt org toh tp-link tl-mr3020 directly that i believed where the image was tested.</p><p>i&#039;ve try to use web page to setup wifi and luci got very long time to setup the wifi in any of AP or client mode and no success, and i&#039;ve only small knowledge using uci so i never try uci.</p><p>this content of /etc/config/wireless if needed (with some edit of pwd and ap name :-) )<br /></p><div class="codebox"><pre><code>config wifi-device &#039;radio0&#039;
    option type &#039;mac80211&#039;
    option hwmode &#039;11g&#039;
    option path &#039;platform/ar933x_wmac&#039;
    option htmode &#039;HT20&#039;
    option disabled &#039;0&#039;
    option country &#039;JP&#039;
    option txpower &#039;15&#039;
    option channel &#039;auto&#039;

config wifi-iface
    option device &#039;radio0&#039;
    option mode &#039;ap&#039;
    option ssid &#039;Pocket_AP&#039;
    option network &#039;lan&#039;
    option encryption &#039;psk2&#039;
    option key &#039;passwordhere&#039;

config wifi-iface
    option device &#039;radio0&#039;
    option ssid &#039;APssidhere&#039;
    option mode &#039;sta&#039;
    option network &#039;wwan&#039;
    option encryption &#039;psk-mixed&#039;
    option key &#039;passwordhere&#039;</code></pre></div><p>and... thank you for your reply.... you make me like go to a doctor and the doctor said i was fine, then i am so very glad to hear that :-) thank you, even now i do backup my art image :-D</p>											<p class="post-edited">(Last edited by <strong>ssyukrillah</strong> on 12 Apr 2017, 02:56)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p356076">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">mk24</div>
					<div class="post-datetime">
						12 Apr 2017, 03:43					</div>
				</div>
				<div class="post-content content">
					<p>If you have a sta interface and it cannot connect to its AP, (no signal, wrong SSID, etc)-- none of the other interfaces on that radio will work either.</p><p>So delete / disable the sta interface and see if you can at least get an AP running.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p356082">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">ssyukrillah</div>
					<div class="post-datetime">
						12 Apr 2017, 06:46					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>mk24 wrote:</cite><blockquote><p>If you have a sta interface and it cannot connect to its AP, (no signal, wrong SSID, etc)-- none of the other interfaces on that radio will work either.</p><p>So delete / disable the sta interface and see if you can at least get an AP running.</p></blockquote></div><p>i&#039;ve been trying delete all sta and client config and retry to reconfigure new AP, but when i hit apply then luci got so long time to finish and no AP created, luci said that wifi was not enabled<br />then i delete all and try to scan (i try in client mode) but no wifi detected.<br />i guess that because no wlan0 was found, still only iw phy shown phy0, but no wlan0 on iw dev result :-(</p><p>actually now i use this tl-mr3020 as client mode replacing my broken wifi card laptop that only accept certified wifi card, duh... and using original tp link firmware it work fine just like now i able to browse connect eth0 via tl-mr3020<br />the best what i need is scripting console to run wpa_supplicant my own then wifi work automatically detect whenever AP that i need to connect</p><p>i might test it using other, i might try dd-wrt may be i have luck, but... i&#039;ve try ddwrt and to many limitation...<br />not like openwrt.... free to custom everything....</p>											<p class="post-edited">(Last edited by <strong>ssyukrillah</strong> on 12 Apr 2017, 06:47)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p356128">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">ssyukrillah</div>
					<div class="post-datetime">
						12 Apr 2017, 21:12					</div>
				</div>
				<div class="post-content content">
					<p>Case identified, problem solved:<br />after trying ddwrt i realize that i mess with MAC address, i did not see that with openwrt because wlan0 was not shown up.<br /></p><div class="codebox"><pre><code>root@DD-WRT:~# iw dev
phy#0
        Interface ath0
                ifindex 9
                wdev 0x3
                addr ff:ff:ff:ff:ff:ff
                type managed
                channel -43 (2192 MHz) NO HT</code></pre></div><p>ddwrt shown that addr was ff:ff:ff:ff:ff:ff<br />and eth become 00:11:22:33:44:55 as listed my netdiscover below<br /></p><div class="codebox"><pre><code> 1 Captured ARP Req/Rep packets, from 1 hosts.   Total size: 60                
 _____________________________________________________________________________
   IP            At MAC Address      Count  Len   MAC Vendor                   
 ----------------------------------------------------------------------------- 
 192.168.1.1     00:11:22:33:44:55    01    060   CIMSYS Inc</code></pre></div><p>and when using original tplink fw, mac address was set also randomly:<br />both wire and wireless MAC was 00-0A-EB-13-7B-00 and that&#039;s was not the original factory MAC<br /></p><div class="codebox"><pre><code>tplink:
Wired
MAC Address:    
00-0A-EB-13-7B-00
IP Address:    
192.168.0.254
Subnet Mask:    
255.255.255.0

Wireless
Operation Mode:    Access Point
Name (SSID):    TP-LINK_POCKET_3020_137B00
Channel:    Auto (Current channel 11)
Mode:    11bgn mixed
Channel Width:    Automatic
MAC Address:    00-0A-EB-13-7B-00</code></pre></div><p>then i try to reflash with openwrt and using luci wifi menu&gt;create client wifi&gt;interfaces menu&gt;edit wwan&gt;advance setting&gt;set &quot;Override MAC address&quot; manually to random mac address&gt;restart&gt; then... it&#039;s alive....<br />and i got my wifi back just now i am using it to connect as client.<br />iw dev now come up:<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# iw dev
phy#0
    Interface wlan0
        ifindex 7
        wdev 0x4
        addr 46:66:3b:97:31:8a
        type managed
        channel 1 (2412 MHz), width: 20 MHz, center1: 2412 MHz</code></pre></div><p>i am glad also thank&#039;s to mk24 to tell me that my wifi card was fine and i do continue my research.</p><p>and come up new question, where openwrt found default mac address?? is that default set from hardware? and how come my wifi mac missing? is that coded at &quot;art&quot; partition? or i mess with firmware partition affected to MAC address??<br />how to repair missing factory mac address? even no need to repair it but yes i wonder to know, i might googleing some for that</p>											<p class="post-edited">(Last edited by <strong>ssyukrillah</strong> on 12 Apr 2017, 21:21)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p356179">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">mk24</div>
					<div class="post-datetime">
						13 Apr 2017, 16:39					</div>
				</div>
				<div class="post-content content">
					<p>When you override the MAC, you can use factory one on the sticker to be sure it is unique.&nbsp; The factory MAC is stored in part of the ART.&nbsp; I have a DIR615 with a similar problem, a partly damaged ART requiring setting the MAC manually.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p356401">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">ssyukrillah</div>
					<div class="post-datetime">
						17 Apr 2017, 01:17					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>mk24 wrote:</cite><blockquote><p>When you override the MAC, you can use factory one on the sticker to be sure it is unique.&nbsp; The factory MAC is stored in part of the ART.&nbsp; I have a DIR615 with a similar problem, a partly damaged ART requiring setting the MAC manually.</p></blockquote></div><p>if MAC was part of the ART partition, then i will not play fire by altering the art partition.<br />as long my pocket ap works fine then it would be fine.<br />thank you very much mk24, all your knowledges save my wifi :-)</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>