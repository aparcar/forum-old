<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Cardbus Support on WRT54G3G</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 29 Apr 2018 and 4 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=3276&amp;p=2.html">2</a></li></ul></nav></div>
			
		
		
			<article class="post" id="p15429">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">mrpacket</div>
					<div class="post-datetime">
						15 Nov 2005, 10:31					</div>
				</div>
				<div class="post-content content">
					<p>Updating events from the last couple of days with regard to getting cardbus support running.</p><p>Linksys has produced a new router the WRT54G3G which has a cardbus interface. For pictures, have a look see at&nbsp; <a href="http://202.86.97.200/cgi-bin/wrt54g3g.jpg">http://202.86.97.200/cgi-bin/wrt54g3g.jpg</a>, which is the box with its lid off.</p><p>For those who are interested, there is also some other information at <a href="http://202.86.97.200/cgi-bin/wrt54g3g_dmesg.txt">http://202.86.97.200/cgi-bin/wrt54g3g_dmesg.txt</a> which shows the debug information and the nvram setting.</p><p>So far we have got an o/s on it.. ( thanks to nico, kaloz, nbd and mbm ).&nbsp; And got some support for pcmcia and the cardbus stuff going.&nbsp; &nbsp;We need to load a number of kernal mods</p><p>&nbsp; yenta_socket, ds, and serial_cs&nbsp; &nbsp; </p><p>We also have put onto the system the pcmcia userland tools..</p><p>Now on to get the modules to work, so i can make this box talk on the 3G network</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p15611">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">bryan</div>
					<div class="post-datetime">
						17 Nov 2005, 07:09					</div>
				</div>
				<div class="post-content content">
					<p>I recently purchased one of these Linksys 3G units and was displeased to learn that my intended use is not currently supported by the stock firmware. I intended to use the router with my Verizon EVDO service, assuming that the router was not locked to a Vodafone card. However, if someone is able to get the cardbus working with the OpenWRT firmware, would I be wrong in assuming that the Novatel Merlin v620 card used for my Verizon EVDO account would have a good shot at working?</p><p>Also, the specifications for this unit are nowhere to be found, specifically the amount of RAM and the type of processor. I would assume these specs are similar if not slightly better than the other WRT routers offered by Linksys, but it would be nice to know what can be expected in terms of ability to flash a good sized firmware to the device.</p><p>Thanks folks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p15648">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">mrpacket</div>
					<div class="post-datetime">
						17 Nov 2005, 22:28					</div>
				</div>
				<div class="post-content content">
					<p>Hi Bryan, hav&#039;nt quite got it working yet, but its getting close, and i can see the end in site.&nbsp; &nbsp;While i can&#039;t catagorically say that it will work, i bet it will work with pretty much and pcmcia type II card. :-)&nbsp; &nbsp;As far as ram and chips, almost identical to a WRT54G inside..&nbsp; the kernal debug shows the priamry data.</p><br /><p>root@OpenWrt:/# dmesg<br />CPU revision is: 00029007<br />Primary instruction cache 8kB, physically tagged, 2-way, linesize 16 bytes.<br />Primary data cache 4kB, 2-way, linesize 16 bytes.<br />Linux version 2.4.30 (nbd@ux-2y01) (gcc version 3.4.4) #1 Mon Nov 7 00:11:37 CET 2005<br />Setting the PFC value as 0x15<br />Determined physical RAM map:<br /> memory: 01000000 @ 00000000 (usable)<br />On node 0 totalpages: 4096<br />zone(0): 4096 pages.<br />zone(1): 0 pages.<br />zone(2): 0 pages.<br />Kernel command line: root=/dev/mtdblock2 rootfstype=squashfs,jffs2 init=/etc/preinit noinitrd console=ttyS0,115200<br />CPU: BCM4712 rev 1 at 200 MHz<br />Using 100.000 MHz high precision timer.<br />Calibrating delay loop... 199.47 BogoMIPS<br />Memory: 14284k/16384k available (1398k kernel code, 2100k reserved, 104k data, 80k init, 0k highmem)<br />Dentry cache hash table entries: 2048 (order: 2, 16384 bytes)<br />Inode cache hash table entries: 1024 (order: 1, 8192 bytes)<br />Mount cache hash table entries: 512 (order: 0, 4096 bytes)<br />Buffer cache hash table entries: 1024 (order: 0, 4096 bytes)<br />Page-cache hash table entries: 4096 (order: 2, 16384 bytes)<br />Checking for &#039;wait&#039; instruction...&nbsp; unavailable.<br />POSIX conformance testing by UNIFIX<br />PCI: Fixing up bus 0<br />PCI: Fixing up bridge<br />PCI: Setting latency timer of device 01:00.0 to 64<br />PCI: Fixing up bus 1<br />Linux NET4.0 for Linux 2.4<br />Based upon Swansea University Computer Society NET3.039<br />Initializing RT netlink socket<br />Starting kswapd<br />devfs: v1.12c (20020818) Richard Gooch (rgooch@atnf.csiro.au)<br />devfs: boot_options: 0x1<br />JFFS2 version 2.1. (C) 2001 Red Hat, Inc., designed by Axis Communications AB.<br />Squashfs 2.1-r2 (released 2004/12/15) (C) 2002-2004 Phillip Lougher<br />pty: 256 Unix98 ptys configured<br />Serial driver version 5.05c (2001-07-08) with MANY_PORTS SHARE_IRQ SERIAL_PCI enabled<br />ttyS00 at 0xb8000300 (irq = 3) is a 16550A<br />ttyS01 at 0xb8000400 (irq = 0) is a 16550A<br />Software Watchdog Timer: 0.05, timer margin: 60 sec<br />Physically mapped flash: Found an alias at 0x400000 for the chip at 0x0<br />Physically mapped flash: Found an alias at 0x800000 for the chip at 0x0<br />Physically mapped flash: Found an alias at 0xc00000 for the chip at 0x0<br />Physically mapped flash: Found an alias at 0x1000000 for the chip at 0x0<br />Physically mapped flash: Found an alias at 0x1400000 for the chip at 0x0<br />Physically mapped flash: Found an alias at 0x1800000 for the chip at 0x0<br />Physically mapped flash: Found an alias at 0x1c00000 for the chip at 0x0<br />cfi_cmdset_0001: Erase suspend on write enabled<br />0: offset=0x0,size=0x2000,blocks=8<br />1: offset=0x10000,size=0x10000,blocks=63<br />Using word write method<br />Flash device: 0x400000 at 0x1c000000<br />Creating 5 MTD partitions on &quot;Physically mapped flash&quot;:<br />0x00000000-0x00040000 : &quot;pmon&quot;<br />0x00040000-0x003f0000 : &quot;linux&quot;<br />0x000baf28-0x001bc000 : &quot;rootfs&quot;<br />mtd: partition &quot;rootfs&quot; doesn&#039;t start on an erase block boundary -- force read-only<br />0x003f0000-0x00400000 : &quot;nvram&quot;<br />0x001c0000-0x003f0000 : &quot;OpenWrt&quot;<br />Initializing Cryptographic API<br />NET4: Linux TCP/IP 1.0 for NET4.0<br />IP Protocols: ICMP, UDP, TCP, IGMP<br />IP: routing cache hash table of 512 buckets, 4Kbytes<br />TCP: Hash tables configured (established 1024 bind 2048)<br />ip_conntrack version 2.1 (5953 buckets, 5953 max) - 320 bytes per conntrack<br />ip_tables: (C) 2000-2002 Netfilter core team<br />NET4: Unix domain sockets 1.0/SMP for Linux NET4.0.<br />NET4: Ethernet Bridge 008 for NET4.0<br />802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;<br />All bugs added by David S. Miller &lt;davem@redhat.com&gt;<br />VFS: Mounted root (squashfs filesystem) readonly.<br />Mounted devfs on /dev<br />Freeing unused kernel memory: 80k freed<br />Algorithmics/MIPS FPU Emulator v1.5<br />diag boardtype: 00000101<br />jffs2.bbc: SIZE compression mode activated.<br />PCI: Setting latency timer of device 00:02.0 to 64<br />eth0: Broadcom BCM47xx 10/100 Mbps Ethernet Controller 3.90.23.0<br />PCI: Setting latency timer of device 00:01.0 to 64<br />eth1: Broadcom BCM4320 802.11 Wireless Controller 3.90.37.0<br />device eth0 entered promiscuous mode<br />vlan0: Setting MAC address to&nbsp; 00 14 bf 24 71 0c.<br />VLAN (vlan0):&nbsp; Underlying device (eth0) has same MAC, not checking promiscious mode.<br />vlan0: add 01:00:5e:00:00:01 mcast address to master interface<br />device eth1 entered promiscuous mode<br />eth1: attempt to add interface with same source address.<br />br0: port 2(eth1) entering learning state<br />br0: port 1(vlan0) entering learning state<br />br0: port 2(eth1) entering forwarding state<br />br0: topology change detected, propagating<br />br0: port 1(vlan0) entering forwarding state<br />br0: topology change detected, propagating<br />vlan1: Setting MAC address to&nbsp; 00 14 bf 24 71 0d.<br />vlan1: add 01:00:5e:00:00:01 mcast address to master interface<br />root@OpenWrt:/# cat /proc/pci<br />PCI devices found:<br />&nbsp; Bus&nbsp; 0, device&nbsp; &nbsp;0, function&nbsp; 0:<br />&nbsp; &nbsp; Class 0501: PCI device 14e4:0800 (rev 1).<br />&nbsp; &nbsp; &nbsp; IRQ 3.<br />&nbsp; &nbsp; &nbsp; Non-prefetchable 32 bit memory at 0x18000000 [0x18000fff].<br />&nbsp; &nbsp; &nbsp; Non-prefetchable 32 bit memory at 0x1fc00000 [0x1fffffff].<br />&nbsp; &nbsp; &nbsp; Non-prefetchable 32 bit memory at 0x1c000000 [0x1dffffff].<br />&nbsp; &nbsp; &nbsp; Non-prefetchable 32 bit memory at 0x1a000000 [0x1bffffff].<br />&nbsp; Bus&nbsp; 0, device&nbsp; &nbsp;1, function&nbsp; 0:<br />&nbsp; &nbsp; Class 0280: PCI device 14e4:4320 (rev 1).<br />&nbsp; &nbsp; &nbsp; IRQ 4.<br />&nbsp; &nbsp; &nbsp; Master Capable.&nbsp; Latency=64.&nbsp; <br />&nbsp; &nbsp; &nbsp; Non-prefetchable 32 bit memory at 0x18001000 [0x18001fff].<br />&nbsp; Bus&nbsp; 0, device&nbsp; &nbsp;2, function&nbsp; 0:<br />&nbsp; &nbsp; Class 0200: PCI device 14e4:4713 (rev 1).<br />&nbsp; &nbsp; &nbsp; IRQ 5.<br />&nbsp; &nbsp; &nbsp; Master Capable.&nbsp; Latency=64.&nbsp; <br />&nbsp; &nbsp; &nbsp; Non-prefetchable 32 bit memory at 0x18002000 [0x18002fff].<br />&nbsp; Bus&nbsp; 0, device&nbsp; &nbsp;3, function&nbsp; 0:<br />&nbsp; &nbsp; Class 0c03: PCI device 14e4:4717 (rev 1).<br />&nbsp; &nbsp; &nbsp; IRQ 6.<br />&nbsp; &nbsp; &nbsp; Non-prefetchable 32 bit memory at 0x18003000 [0x18003fff].<br />&nbsp; Bus&nbsp; 0, device&nbsp; &nbsp;4, function&nbsp; 0:<br />&nbsp; &nbsp; Class 0c03: PCI device 14e4:4716 (rev 1).<br />&nbsp; &nbsp; &nbsp; IRQ 2.<br />&nbsp; &nbsp; &nbsp; Non-prefetchable 32 bit memory at 0x18004000 [0x18004fff].<br />&nbsp; Bus&nbsp; 0, device&nbsp; &nbsp;5, function&nbsp; 0:<br />&nbsp; &nbsp; Class 0b30: PCI device 14e4:0816 (rev 1).<br />&nbsp; &nbsp; &nbsp; IRQ 2.<br />&nbsp; &nbsp; &nbsp; Non-prefetchable 32 bit memory at 0x18005000 [0x18005fff].<br />&nbsp; Bus&nbsp; 0, device&nbsp; &nbsp;6, function&nbsp; 0:<br />&nbsp; &nbsp; Class 0500: PCI device 14e4:080f (rev 1).<br />&nbsp; &nbsp; &nbsp; IRQ 3.<br />&nbsp; &nbsp; &nbsp; Non-prefetchable 32 bit memory at 0x18006000 [0x18006fff].<br />&nbsp; &nbsp; &nbsp; Non-prefetchable 32 bit memory at 0x0 [0x7ffffff].<br />&nbsp; &nbsp; &nbsp; Non-prefetchable 32 bit memory at 0x10000000 [0x17ffffff].<br />&nbsp; &nbsp; &nbsp; Non-prefetchable 32 bit memory at 0x80000000 [0x9fffffff].<br />&nbsp; Bus&nbsp; 0, device&nbsp; &nbsp;7, function&nbsp; 0:<br />&nbsp; &nbsp; Class 0604: PCI device 14e4:0804 (rev 1).<br />&nbsp; &nbsp; &nbsp; IRQ 2.<br />&nbsp; &nbsp; &nbsp; Non-prefetchable 32 bit memory at 0x18007000 [0x18007fff].<br />&nbsp; &nbsp; &nbsp; Non-prefetchable 32 bit memory at 0x8000000 [0xfffffff].<br />&nbsp; Bus&nbsp; 1, device&nbsp; &nbsp;0, function&nbsp; 0:<br />&nbsp; &nbsp; Class 0600: PCI device 14e4:4712 (rev 1).<br />&nbsp; &nbsp; &nbsp; IRQ 2.<br />&nbsp; &nbsp; &nbsp; Master Capable.&nbsp; Latency=64.&nbsp; <br />&nbsp; &nbsp; &nbsp; Non-prefetchable 32 bit memory at 0x40000000 [0x40001fff].<br />&nbsp; &nbsp; &nbsp; Prefetchable 32 bit memory at 0x0 [0x7ffffff].<br />&nbsp; Bus&nbsp; 1, device&nbsp; &nbsp;1, function&nbsp; 0:<br />&nbsp; &nbsp; Class 0607: PCI device 104c:ac56 (rev 0).<br />&nbsp; &nbsp; &nbsp; IRQ 2.<br />&nbsp; &nbsp; &nbsp; Master Capable.&nbsp; No bursts.&nbsp; Min Gnt=64.Max Lat=3.<br />&nbsp; &nbsp; &nbsp; Non-prefetchable 32 bit memory at 0x40002000 [0x40002fff].<br />root@OpenWrt:/# nvram show<br />wl_radius_port=1812<br />wl_mac_deny=<br />filter_dport_grp3=<br />filter_dport_grp4=<br />wwan_card_firmware=12.0-12.0&nbsp; [2005-02-09 17:22:37]</p><p>filter_dport_grp5=<br />filter=on<br />wan_unit=0<br />filter_dport_grp6=<br />os_ram_addr=80001000<br />wl0_net_mode=mixed<br />filter_dport_grp7=<br />wl0_frameburst=off<br />filter_dport_grp8=<br />filter_dport_grp9=<br />ddns_username_2=<br />log_ipaddr=0<br />boardrev=0x10<br />il0macaddr=00:14:bf:24:71:0e<br />ppp_idletime=5<br />ppp_passwd=<br />ddns_enable=1<br />bootnv_ver=5<br />et0macaddr=00:14:BF:24:71:0C<br />qos_appport1=0<br />skip_intel_check=0<br />qos_appport2=0<br />ddns_hostname_buf=mobility.kicks-ass.net<br />wl_maxassoc=128<br />wl0_akm=<br />d11g_mode=1<br />wan_get_dns=202.73.198.15 202.73.206.15<br />wl0_wep_buf=<br />qos_appport3=0<br />boot_wait=off<br />watchdog=5000<br />qos_appport4=0<br />wl_phytypes=<br />filter_web_host1=<br />wl0_macmode1=disabled<br />action_service_arg1=<br />qos_appport5=0<br />filter_web_host2=<br />wl0_infra=1<br />qos_appport6=0<br />filter_web_host3=<br />fw_disable=0<br />wl0_country_code=ALL<br />et0mdcport=0<br />qos_appport7=0<br />router_name=WRT54G3G-EU<br />pppoe_keepalive=0<br />filter_web_host4=<br />qos_appport8=0<br />filter_web_host5=<br />https_enable=0<br />filter_web_host6=<br />Intel_firmware_version=v1.41.8<br />wl_infra=1<br />filter_web_host7=<br />cimi=530011101174054<br />l2tp_get_ip=<br />filter_web_host8=<br />filter_web_host9=<br />pptp_server_ip=<br />ppp_get_ac=<br />pmon_ver=CFE 3.91.37.0<br />restore_defaults=0<br />get_sn=<br />wan_run_mtu=1500<br />ppp_username=<br />wl0_wme_sta_be=15 1023 3 0 0 off<br />wan_lease=0<br />filter_port=<br />wwan_card_revision=(HW REV [0:55])</p><p>ddns_enable_buf=1<br />d11g_dtim=1<br />ddns_hostname=mobility.kicks-ass.net<br />wl_radius_ipaddr=<br />http_wanport=8080<br />filter_ip_grp1=<br />filter_ip_grp2=<br />wl0_ifname=eth1<br />filter_ip_grp3=<br />dr_lan_rx=0<br />filter_ip_grp4=<br />lan_domain=<br />wl0_wme_sta_bk=15 1023 7 0 0 off<br />filter_ip_grp5=<br />timer_interval=3600<br />filter_ip_grp6=<br />wwan_start_time=35<br />forward_port0=25-25&gt;192.168.68.153:25-25,tcp,off,E-mail<br />wl_net_reauth=36000<br />pppoe_ac=<br />filter_ip_grp7=<br />filter_rule1=<br />qos_devmac1=00:00:00:00:00:00<br />hb_server_ip=<br />ipsec_pass=1<br />filter_ip_grp8=<br />filter_rule2=<br />forward_port1=1723-1723&gt;192.168.68.153:1723-1723,tcp,off,Virtual Private Networking (VPN)<br />forward_port2=3389-3389&gt;192.168.68.153:3389-3389,tcp,on,Terminal Services<br />qos_devmac2=00:00:00:00:00:00<br />filter_ip_grp9=<br />filter_rule3=<br />gpio5=robo_reset<br />vlan0ports=1 2 3 4 5*<br />filter_rule4=<br />forward_port3=21-21&gt;192.168.68.153:21-21,tcp,off,FTP<br />forward_port4=80-80&gt;192.168.68.153:80-80,tcp,on,Web server<br />filter_rule5=<br />lan_route=<br />filter_ip_grp10=<br />filter_rule6=<br />wl0_mrate=0<br />forward_port5=443-443&gt;192.168.68.153:443-443,tcp,on,Secure Web Server (HTTPS)<br />forward_port6=4125-4125&gt;192.168.68.153:4125-4125,tcp,off,Remote Web Workplace<br />wl0_mode=ap<br />filter_rule7=<br />wan_gateway=10.64.64.64<br />dhcp_start=100<br />filter_rule8=<br />forward_port7=444-444&gt;192.168.68.153:444-444,tcp,off,Windows SharePoint Services intranet sit<br />filter_rule9=<br />eou_configured=1<br />ident_pass=0<br />wl0_ap_isolate=0<br />wl_mrate=0<br />l2tp_server_ip=<br />wl_akm=<br />os_flash_addr=bfc40000<br />wwan_idletime=0<br />wl0_wme_no_ack=off<br />wl0_gmode=1<br />dhcp_lease=0<br />sromrev=2<br />qos_devpri1=0<br />qos_devpri2=0<br />get_mac_index=1<br />boardtype=0x0101<br />is_default=0<br />wl_active_add_mac=0<br />wl_gmode=1<br />ping_ip=<br />stats_server=<br />static_route=<br />d11g_rate=0<br />lan_netmask=255.255.255.0<br />wl0_wep_last=<br />dmz_enable=1<br />wl_wme_sta_vi=7 15 2 6016 3008 off<br />wl0_dtim=1<br />wl0_ssid=INGRAMMICRO<br />http_username=<br />manual_rate=0<br />port_trigger=<br />qos_devname1=<br />wl_wme_ap_be=15 63 3 0 0 off<br />filter_web_host10=<br />qos_devname2=<br />os_date=Aug 22 2005<br />http_lanport=80<br />wl_wme_sta_vo=3 7 2 3264 1504 off<br />wl_plcphdr=long<br />filter_mac_grp1=<br />wwan_card_model=Novatel Merlin U630<br />wl_macmode=disabled<br />ppp_service=<br />ppp_redialperiod=30<br />filter_mac_grp2=<br />wl_wme_ap_bk=15 1023 7 0 0 off<br />filter_mac_grp3=<br />wan_domain=<br />wan_hwname=<br />wl0_key1=<br />wl_phytype=g<br />filter_mac_grp4=<br />wan_netmask=255.255.255.255<br />lan_lease=86400<br />wl0id=0x4320<br />wl0_key2=<br />pppoe_static_ip=<br />filter_mac_grp5=<br />wl_lazywds=1<br />wl0_key3=<br />filter_mac_grp6=<br />wwan_username=<br />wl0_key4=<br />filter_mac_grp7=<br />filter_mac_grp8=<br />filter_client0=<br />filter_mac_grp9=<br />filter_maclist=<br />pptp_pass=1<br />pptp_get_ip=<br />wl_auth_mode=none<br />ppp_demand=1<br />mtu_enable=0<br />ppp_keepalive=0<br />block_activex=0<br />d11g_rts=2347<br />remote_mgt_https=0<br />wl_wpa_psk=mobility<br />http_passwd=admin<br />ag0=255<br />block_wan=1<br />lan_stp=0<br />wl0_wme_ap_vi=7 15 1 6016 3008 off<br />skip_amd_check=0<br />wl_mode=ap<br />wl0_plcphdr=long<br />wl0_rate=0<br />wl0_closed=0<br />wl_wpa_gtk_rekey=3600<br />d11g_rateset=default<br />wl0_macmode=disabled<br />wl0_wme_ap_vo=3 7 1 3264 1504 off<br />lan_dhcp=0<br />wl0_radioids=BCM2050<br />wl0_phytype=g<br />wl0gpio2=0<br />dr_wan_rx=0<br />security_mode2=disabled<br />filter_tod_buf1=<br />wl0_lazywds=1<br />wl0gpio3=0<br />block_proxy=0<br />filter_tod_buf2=<br />filter_tod_buf3=<br />port_rate_limit_1=0<br />filter_tod_buf4=<br />upnp_ssdp_interval=60<br />boardflags2=0<br />nov_netname=vodafone NZ<br />port_rate_limit_2=0<br />filter_tod_buf5=<br />port_rate_limit_3=0<br />dr_lan_tx=0<br />wl0_afterburner=off<br />filter_tod_buf6=<br />http_client_ip=192.168.68.103<br />port_rate_limit_4=0<br />wl_wds_timeout=1<br />filter_tod_buf7=<br />filter_tod10=<br />lan_hwaddr=00:14:BF:24:71:0C<br />get_eou_index=0<br />wl0_antdiv=-1<br />filter_tod_buf8=<br />wan_dns=<br />filter_tod_buf9=<br />http_client_mac=00:14:38:15:25:4F<br />action_service=<br />wl_dtim=1<br />wl_ssid=INGRAMMICRO<br />wl0_wpa_psk=mobility<br />d11g_bcn=100<br />web_wl_filter=0<br />wl_passphrase=<br />daylight_time=1<br />flash_type=Intel 28F320C3 2Mx16 BotB<br />wl0_mac_list=<br />security_mode=disabled<br />dhcp_wins=wan<br />wwan_refresh=0<br />multicast_pass=0<br />filter_tod_buf10=<br />os_server=<br />bcm4712_firmware_version=v1.50.0<br />wwan_pincode=<br />pppoe_static=0<br />wwan_service=umts_first<br />hb_server_domain=<br />wl_key1=<br />wan_proto=dhcp<br />wl_key2=<br />wl0_unit=0<br />wl_key3=<br />wl_key4=<br />wl_country_code=ALL<br />ddns_cache=1130422018,202.73.194.107<br />wl_hwaddr=<br />aol_block_traffic1=0<br />wwan_dial=0<br />aol_block_traffic2=0<br />static_route_name=<br />wl0_net_reauth=36000<br />wl_active_mac=<br />wl_net_mode=mixed<br />ntp_enable=1<br />pa0itssit=62<br />enable_game=0<br />forward_port=http:on:tcp:80:80&gt;153 ftp:off:tcp:21:21&gt;100 tcp:off:both:24:24&gt;100 https:on:tcp:443:443&gt;153 TS:on:tcp:3389:3389&gt;153<br />d11g_frag=2346<br />sel_qosport1=0<br />sel_qosport2=0<br />wl0_wds=<br />filter_mac_grp10=<br />sel_qosport3=0<br />wl_rate=0<br />ppp_static_ip=<br />sel_qosport4=0<br />block_java=0<br />log_level=2<br />cctl=0<br />sel_qosport5=0<br />ntp_server=<br />ct_modules=<br />sel_qosport6=0<br />wan_hwaddr=00:14:BF:24:71:0D<br />sel_qosport7=0<br />sel_qosport8=0<br />lan_ifnames=vlan0 eth1 eth2 eth3<br />wl_macmode1=disabled<br />pppoe_ifname=<br />wl0_radius_port=1812<br />wl0_wme=off<br />wl0_auth=0<br />wl0_mac_deny=<br />wl0_radius_ipaddr=<br />pppoe_service=<br />wl0_wme_sta_vi=7 15 2 6016 3008 off<br />wl_country=ALL<br />pa0maxpwr=0x4e<br />traceroute_ip=<br />ddns_change=<br />remote_management=0<br />wan_ifnames=vlan1<br />block_loopback=0<br />wl0_wme_sta_vo=3 7 2 3264 1504 off<br />wl_crypto=tkip<br />wl_rateset=default<br />wwan_apn=internet<br />wl_wep_bit=64<br />ppp_mru=1500<br />http_method=post<br />nov_signal=Good<br />QoS=0<br />wl_radius_key=<br />filter_port_grp1=<br />lan_proto=static<br />os_name=linux<br />clkfreq=200<br />lan_ipaddr=192.168.68.254<br />filter_port_grp2=<br />vlan1hwname=et0<br />aa0=3<br />wl0_maxassoc=128<br />ddns_passwd_2=<br />filter_port_grp10=<br />filter_port_grp3=<br />dr_wan_tx=0<br />wl_unit=0<br />filter_port_grp4=<br />filter_id=1<br />nov_bearer=3G/UMTS<br />filter_port_grp5=<br />firmware_version=v1.98.4<br />wl0_phytypes=g<br />wl0_frag=2346<br />d11g_channel=11<br />wl0_wep=disabled<br />filter_port_grp6=<br />router_disable=0<br />ddns_username=pdath<br />filter_port_grp7=<br />ddns_passwd=internet<br />pppoe_passwd=<br />filter_port_grp8=<br />wwan_passwd=<br />filter_port_grp9=<br />wwan_connect=1<br />ppp_ac=<br />log_enable=1<br />sdram_config=0x0062<br />filter_web_url10=<br />wl0_country=ALL<br />dmz_ipaddr=100<br />vlan1ports=0 5<br />security_mode_last=<br />wl_wds=<br />ddns_hostname_2=<br />scratch=a0180000<br />filter_summary=0<br />ccode=0<br />wl0_rateset=default<br />wl0_wep_bit=64<br />port_flow_control_1=1<br />wl_wme=off<br />pppoe_idletime=5<br />port_flow_control_2=1<br />get_mac=00:14:BF:24:71:0C<br />ping_times=<br />port_flow_control_3=1<br />wl_wme_ap_vi=7 15 1 6016 3008 off<br />wan_primary=1<br />lan_ifname=br0<br />port_flow_control_4=1<br />filter_services=$NAME:003:DNS$PROT:003:udp$PORT:005:53:53&lt; &gt;$NAME:004:Ping$PROT:004:icmp$PORT:003:0:0&lt; &gt;$NAME:004:HTTP$PROT:003:tcp$PORT:005:80:80&lt; &gt;$NAME:005:HTTPS$PROT:003:tcp$PORT:007:443:443&lt; &gt;$NAME:003:FTP$PROT:003:tcp$PORT:005:21:21&lt; &gt;$NAME:004:POP3$PROT:003:tcp$PORT:007:110:110&lt; &gt;$NAME:004:IMAP$PROT:003:tcp$PORT:007:143:143&lt; &gt;$NAME:004:SMTP$PROT:003:tcp$PORT:005:25:25&lt; &gt;$NAME:004:NNTP$PROT:003:tcp$PORT:007:119:119&lt; &gt;$NAME:006:Telnet$PROT:003:tcp$PORT:005:23:23&lt; &gt;$NAME:004:SNMP$PROT:003:udp$PORT:007:161:161&lt; &gt;$NAME:004:TFTP$PROT:003:udp$PORT:005:69:69&lt; &gt;$NAME:003:IKE$PROT:003:udp$PORT:007:500:500&lt; &gt;<br />boardflags=0x0318<br />sdram_refresh=0x0000<br />dhcp_domain=wan<br />wl_auth=0<br />wl_wep_last=<br />sdram_ncdl=0xfd0009<br />wan_gateway_buf=0.0.0.0<br />wl_wme_ap_vo=3 7 1 3264 1504 off<br />block_cookie=0<br />wl_frameburst=off<br />ezc_enable=1<br />wan_iface=ppp0<br />is_modified=0<br />upnp_wan_proto=<br />dhcp_num=50<br />filter_web_url1=<br />wan_ipaddr=202.73.194.107<br />wan_ipaddr_buf=0.0.0.0<br />filter_web_url2=<br />wl0_passphrase=<br />filter_web_url3=<br />wl0_rts=2347<br />filter_web_url4=<br />filter_web_url5=<br />wl_ifname=<br />filter_web_url6=<br />wan_wins=0.0.0.0<br />ntp_mode=auto<br />wl_wep=disabled<br />http_enable=1<br />filter_web_url7=<br />l2tp_pass=1<br />filter_web_url8=<br />wan_speed=4<br />pppoe_username=<br />filter_web_url9=<br />os_version=3.91.37.0<br />qos_appname1=<br />wl_gmode_protection=off<br />qos_appname2=<br />wl0_wpa_gtk_rekey=3600<br />qos_appname3=<br />mac_clone_enable=0<br />ppp_get_srv=<br />qos_appname4=<br />wl_frag=2346<br />qos_appname5=<br />wan_mtu=1500<br />wl_wep_gen=<br />wl0_key=1<br />qos_appname6=<br />wl0_active_mac=<br />qos_appname7=<br />rate_mode=1<br />wl_maclist=00:04:23:5F:57:A2 00:03:93:EB:D4:6F<br />filter_macmode=deny<br />qos_appname8=<br />console_loglevel=1<br />et0phyaddr=30<br />time_zone=+12 2 4<br />wan_get_domain=<br />wan_ifname=vlan1<br />wl_wme_sta_be=15 1023 3 0 0 off<br />upnp_max_age=180<br />wwan_country=nz<br />wl_radioids=<br />wan_hostname=<br />wl0_radio=1<br />wl_corerev=<br />ppp_mtu=1500<br />ddns_interval=60<br />wl_channel=11<br />manual_boot_nv=0<br />wl_wme_sta_bk=15 1023 7 0 0 off<br />wl0_bcn=100<br />port_priority_1=0<br />port_priority_2=0<br />wl_afterburner=off<br />wl_radio=1<br />ppp_static=0<br />filter_tod1=<br />wl0_hwaddr=00:14:BF:24:71:0E<br />port_priority_3=0<br />filter_tod2=<br />port_priority_4=0<br />filter_tod3=<br />filter_tod4=<br />ezc_version=2<br />wl0_wep_gen=<br />ddns_passwd_buf=internet<br />wk_mode=gateway<br />wl0_gmode_protection=off<br />filter_tod5=<br />pa0b0=0x15eb<br />wwan_ppp_link=1<br />eou_expired_hour=72<br />wl0_maclist=00:04:23:5F:57:A2 00:03:93:EB:D4:6F<br />filter_tod6=<br />pa0b1=0xfa82<br />filter_tod7=<br />pa0b2=0xfe66<br />wl_rts=2347<br />filter_tod8=<br />sdram_init=0x010b<br />wwan_auto=on<br />filter_tod9=<br />aol_block_traffic=0<br />wl_ap_isolate=0<br />lan_wins=<br />vlan0hwname=et0<br />wl_mac_list=00:04:23:5F:57:A2 00:03:93:EB:D4:6F<br />lan_hwnames=<br />dl_ram_addr=a0001000<br />wl_wme_no_ack=off<br />pppoe_demand=1<br />wl0_radius_key=<br />filter_dport_grp10=<br />ddns_username_buf=pdath<br />wl0_wme_ap_be=15 63 3 0 0 off<br />wl0_corerev=7<br />wl_key=1<br />wl0_channel=11<br />wl0_wds_timeout=1<br />dr_setting=0<br />wl0_wme_ap_bk=15 1023 7 0 0 off<br />upnp_enable=1<br />ddns_status=1<br />filter_rule10=<br />wl0_auth_mode=none<br />wl_closed=0<br />boot_ver=v3.6<br />autofw_port0=<br />survey_net=0<br />wl0_crypto=tkip<br />boardnum=42<br />def_hwaddr=00:00:00:00:00:00<br />wl_bcn=100<br />wl_wep_buf=<br />get_sn_index=0<br />filter_dport_grp1=<br />wl_antdiv=-1<br />filter_dport_grp2=<br />size: 10493 bytes (22275 left)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p17978">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">RUok</div>
					<div class="post-datetime">
						30 Dec 2005, 07:40					</div>
				</div>
				<div class="post-content content">
					<p>Any further updates as to if the Verizon EVDO card was able to work, or other non 3G/GPRS cards worked in the slot?</p><p>I am shocked not more people are interested in a 3G mobile WiFi router! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p17981">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">danversj</div>
					<div class="post-datetime">
						30 Dec 2005, 08:41					</div>
				</div>
				<div class="post-content content">
					<p>A cardbus slot could be useful for all sorts of things actually, not just 3G cards.&nbsp; But I wonder how long before the WRT54G3G is shipped with VxWorks firmware?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p18374">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">flyashi</div>
					<div class="post-datetime">
						6 Jan 2006, 08:51					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>danversj wrote:</cite><blockquote><p>But I wonder how long before the WRT54G3G is shipped with VxWorks firmware?</p></blockquote></div><p>Hopefully, a LONG time. But unlikely. Not that I&#039;m a pessimist.</p><p>The optimist thinks that the WRT54G3G will have Linux forever.<br />The pessimist thinks that the WRT54G3G will have Linux for only a short time.<br />The engineer thinks that the WRT54G3G will have Linux for half as long as it should!</p><p>That&#039;s a mod of: optimist sees the glass as half full, pessimist half empty, engineer: twice as big as it needs to be, or 50% efficiency, etc.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p20868">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">mikinho</div>
					<div class="post-datetime">
						14 Feb 2006, 21:36					</div>
				</div>
				<div class="post-content content">
					<p>Hi mates! <br />I&#039;m trying to transform the WRT54G3G to a web proxy. I would like to use some firmware whose behaviour was like SQUID. I think there´s no package for using it. Do you know any other package?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p20880">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">vincentfox</div>
					<div class="post-datetime">
						15 Feb 2006, 02:23					</div>
				</div>
				<div class="post-content content">
					<p>To RUok:</p><p>I am interested, but took a different path. I used a WRTSL54GS unit. The SL has a USB port so I simply attached my cellphone via USB. From there it&#039;s just a matter of some PPP chat scripts.&nbsp; Not as elegant and self-contained as a card in the router. But it works.</p><p>To mikino:<br />Search for &quot;web proxy&quot; on the forums. There are several programs if all you want is basic proxy functions without caching of content.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p20890">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">mikinho</div>
					<div class="post-datetime">
						15 Feb 2006, 12:25					</div>
				</div>
				<div class="post-content content">
					<p>Hi Vincentfox<br />I&#039;ve ask about caching and my boss have told me it would be great if WRT54G3G can be a web proxy with cache functions. In fact, he wanted DNS functions too. <br />I&#039;ll investigate!!<br />thanks <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p20970">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">candlerb</div>
					<div class="post-datetime">
						16 Feb 2006, 23:21					</div>
				</div>
				<div class="post-content content">
					<p>A machine with only 16MB of RAM is going to be an <em>extremely</em> bad web cache. <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /> But if you want a non-caching proxy then you can probably compile up something like junkbuster, if that&#039;s not already been done.</p><p>If you want a DNS server with fixed mappings (foo.example.com -&gt; 192.0.2.1) a simple one is already there: dnsmasq</p><p>However you&#039;re unlikely to be able to run a heavyweight DNS cache like &quot;bind&quot;, because it&#039;ll need a lot more RAM than that. I notice there&#039;s a package called &quot;maradns&quot; for WhiteRussian, which can apparently act as both cache and authoritative server, but no matter how small it is you&#039;re not going to cache a lot of RRs in that amount of RAM.</p><p>If you want a compact DNS cache or web cache, look at something like an EPIA mini-ITX motherboard in a <a href="http://www.mini-itx.com/store/?c=3#p1124">compact case</a>. This is a real PC, and you can give it a 512MB DIMM, as much flash as you like, and a HDD if you wish.</p><p>Note: if you want wireless, that particular case doesn&#039;t take the MII motherboard with PC-card slot, and there&#039;s no room to use the PCI slot. You can use a <a href="http://www.mini-itx.com/store/?c=3#p1151">bigger case</a>, or you can use a USB wireless adaptor. Or just have a separate OpenWRT box for handling switching and wireless.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p21172">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">mikinho</div>
					<div class="post-datetime">
						20 Feb 2006, 14:14					</div>
				</div>
				<div class="post-content content">
					<p>Hi!</p><p>I agree with you Candlerb, I think there isn´t enough memory in order to have a good Caching Web proxy too. <br />I&#039;ve seen SQUID modules are prepared (thanks Florian) and I&#039;ll test them, and perhaps they will be the answer for my question <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>We are trying to&quot;build&quot; an optimized environment for the HTTP-web browsing connections between Wi-fi users and Inet Servers using UMTS connectivity (PEP functions), and I&#039;m still searching information about how I can do it or what the best solution can be.</p><p>Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p21178">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">candlerb</div>
					<div class="post-datetime">
						20 Feb 2006, 15:20					</div>
				</div>
				<div class="post-content content">
					<p>Have you got the WRT54G3G running using OpenWRT? Or do you have a different solution for the UMTS client?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p21291">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">jr</div>
					<div class="post-datetime">
						21 Feb 2006, 23:07					</div>
				</div>
				<div class="post-content content">
					<p>Got couple WRT54G3G&#039;s today with Vodafone 3G/UMTS cards.</p><p>I flashed 19.2.2006 dated Whiterussian branch snapshot from nbd&#039;s webpage to one of them. After OpenWrt install I was unable to access device even in failsafe mode (yes I did wait a long time). It did broadcast &quot;press reset now to enter failsafe&quot; message but never entered either normal nor failsafe mode after that. I held reset button down while powering device up and eventually was able to access it. Now nvram looks very empty so perhaps there was something in nvram left from Linksys firmware that caused problems?</p><p>Vodafone 3G card has NEC USB2 chip and two USB serial ports. I downloaded kmod-pcmcia-core from Nico&#039;s old build. Modules load fine and detect whatever Cardbus card I is plugged in. However when I try to load USB drivers they only detect USB1 controller integrated to Broadcom SoC and ignore NEC USB2 chip on Cardbus slot.</p><p>I can see card plugged in via /proc/pci and it does show proper vendor and device ID&#039;s. Only got Cardbus NEC USB2 adapter, Vodafone 3G card and Realtek RTL8139 cardbus adapter right now so I was unable to test if cardbus support actually works. I&#039;ll test with some other cards later to see if problem is in UHCI driver that&#039;s unable to detect USB2 or in cardbus support itself. Just need to put my OpenWrt compile environment back up first so I can compile necessary modules myself.</p><br /><p>BTW. Linksys has source code on their FTP site for WRT54G3G and there seems to be at least some debug related changes on UHCI driver.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p21383">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">jr</div>
					<div class="post-datetime">
						23 Feb 2006, 01:10					</div>
				</div>
				<div class="post-content content">
					<p>Here&#039;s couple patches to get cardbus side alive. Code is from Linksys source tarball.</p><p>I have successfully read and written to USB flash drive using Cardbus USB2 adapter (OHCI drivers). I also tried with RTL8139 cardbus ethernet adapter but driver fails to load due some PCI resource allocation problem. Vodafone 3G card drivers load but still something wrong with serial port drivers required.</p><div class="codebox"><pre><code>--- linux.x/drivers/pcmcia/yenta.c      2004-11-17 13:54:21.000000000 +0200
+++ linux/drivers/pcmcia/yenta.c        2005-11-02 08:22:05.000000000 +0200
@@ -145,6 +143,7 @@
                val |= (state &amp; CB_CARDSTS) ? SS_STSCHG : 0;
                val |= (state &amp; (CB_CDETECT1 | CB_CDETECT2)) ? 0 : SS_DETECT;
                val |= (state &amp; CB_PWRCYCLE) ? SS_POWERON | SS_READY : 0;
+               printk(&quot;\tyenta_get_status=%x\n&quot;, val);
        } else {
                u8 status = exca_readb(socket, I365_STATUS);
                val |= ((status &amp; I365_CS_DETECT) == I365_CS_DETECT) ? SS_DETECT : 0;
@@ -250,6 +249,7 @@
        }
        yenta_set_power(socket, state);
        socket-&gt;io_irq = state-&gt;io_irq;
+       printk(&quot;\tyenta.c socket-&gt;io_irq=%x\n&quot;, socket-&gt;io_irq);  //Amin add
        bridge = config_readw(socket, CB_BRIDGE_CONTROL) &amp; ~(CB_BRIDGE_CRST | CB_BRIDGE_INTR);
        if (cb_readl(socket, CB_SOCKET_STATE) &amp; CB_CBCARD) {
                u8 intr;
@@ -543,6 +543,7 @@
         * Probe for usable interrupts using the force
         * register to generate bogus card status events.
         */
+#if 0
        cb_writel(socket, CB_SOCKET_EVENT, -1);
        cb_writel(socket, CB_SOCKET_MASK, CB_CSTSMASK);
        exca_writeb(socket, I365_CSCINT, 0);
@@ -560,6 +561,7 @@
 
        mask = probe_irq_mask(val) &amp; 0xffff;
 
+#endif
        bridge_ctrl &amp;= ~CB_BRIDGE_INTR;
        config_writew(socket, CB_BRIDGE_CONTROL, bridge_ctrl);
 
@@ -577,9 +579,8 @@
        socket-&gt;cap.irq_mask = yenta_probe_irq(socket, isa_irq_mask);
        socket-&gt;cap.cb_dev = socket-&gt;dev;
        socket-&gt;cap.bus = NULL;
-
-       printk(KERN_INFO &quot;Yenta ISA IRQ mask 0x%04x, PCI irq %d\n&quot;,
-              socket-&gt;cap.irq_mask, socket-&gt;cb_irq);
+       socket-&gt;cap.irq_mask = 0x6f8;  //Amin test
+       printk(&quot;Yenta IRQ list %04x, PCI irq%d\n&quot;, socket-&gt;cap.irq_mask, socket-&gt;cb_irq);
 }
 
 extern void cardbus_register(pci_socket_t *socket);
@@ -606,9 +607,48 @@
 
        /* Figure out what the dang thing can do for the PCMCIA layer... */
        yenta_get_socket_capabilities(socket, isa_interrupts);
-       printk(KERN_INFO &quot;Socket status: %08x\n&quot;,
-              cb_readl(socket, CB_SOCKET_STATE));
+       printk(&quot;Socket status: %08x\n&quot;, cb_readl(socket, CB_SOCKET_STATE));
 
+//Amin add
+//---------------------------------------------------------
+       config_writew(socket, 0x04, 0x07); 
+//     config_writel(socket, 0x10, 0xffffffff); 
+       config_writew(socket, 0x3e, 0x101); 
+       config_writel(socket, 0x44, 0x000003e0); 
+       config_writel(socket, 0x80, 0x28c0d060); 
+       config_writel(socket, 0x8c, 0x1002); 
+       config_writeb(socket, 0x90, 0xc0); 
+       config_writeb(socket, 0x91, 0x0); 
+       config_writeb(socket, 0x92, 0x64); 
+       config_writeb(socket, 0x93, 0x60); 
+//---------------------------------------------------------
+       config_writel(socket, 0x80, 0x8407161); 
+       config_writel(socket, 0x8c, 0x1002); 
+       config_writeb(socket, 0x91, 0x82); 
+       config_writeb(socket, 0x92, 0x64); 
+       printk(&quot;\tyenta_config_init 04h=%x:40h=%x:42h=%x:44h=%x:80h=%x:8ch=%x:90h=%x:91h=%x:92h=%x:93h=%x:a2h=%x:00h=%x\n&quot;, 
+                                               config_readw(socket, 0x04), 
+                                               config_readw(socket, 0x40), 
+                                               config_readw(socket, 0x42), 
+                                               config_readl(socket, 0x44), 
+                                               config_readl(socket, 0x80), 
+                                               config_readl(socket, 0x8c), 
+                                               config_readb(socket, 0x90), 
+                                               config_readb(socket, 0x91), 
+                                               config_readb(socket, 0x92), 
+                                               config_readb(socket, 0x93), 
+                                               config_readw(socket, 0xa2), 
+                                               config_readl(socket, 0x00) 
+       );
+       printk(&quot;\tyenta_config_init 3ch=%x:3dh=%x:3eh=%x\n&quot;, 
+                                               config_readb(socket, 0x3c), 
+                                               config_readb(socket, 0x3d), 
+                                               config_readw(socket, 0x3e) 
+       );
+       printk(&quot;\tyenta_config_init 805h=%x\n&quot;, 
+                                               exca_readb(socket, 0x05)
+       );
+//Amin add
        /* Register it with the pcmcia layer.. */
        cardbus_register(socket);
 
@@ -749,13 +784,13 @@
        res-&gt;start = 0;
        res-&gt;end = 0;
        root = pci_find_parent_resource(socket-&gt;dev, res);
-
+#if 0
        if (!root)
                return;
 
        start = config_readl(socket, offset) &amp; mask;
        end = config_readl(socket, offset+4) | ~mask;
-       if (start &amp;&amp; end &gt; start &amp;&amp; !override_bios) {
+       if (start &amp;&amp; end &gt; start &amp;&amp; !override_bios) { 
                res-&gt;start = start;
                res-&gt;end = end;
                if (request_resource(root, res) == 0)
@@ -794,9 +829,20 @@
                res-&gt;start = res-&gt;end = 0;
                return;
        }
-
+#endif 
+//Amin add
+       if(type==0x200)
+       {
+               res-&gt;start = 0x40004000;
+               res-&gt;end = 0x40007fff;
+       }        
+//Amin add
        config_writel(socket, offset, res-&gt;start);
        config_writel(socket, offset+4, res-&gt;end);
+//Amin add
+       printk(&quot;\t yenta_allocate for bus=%s offset=%x res-&gt;start=%x\n&quot;, bus-&gt;name, offset, res-&gt;start);
+       printk(&quot;\t yenta_allocate for bus=%s offset=%x res-&gt;end=%x\n&quot;, bus-&gt;name, offset, res-&gt;end);
+//Amin add
 }
 
 /*
@@ -908,9 +945,12 @@
        if (pci_enable_device(dev))
                return -1;
        if (!pci_resource_start(dev, 0)) {
-               printk(KERN_ERR &quot;No cardbus resource!\n&quot;);
+               printk(KERN_ERR &quot;No cardbus resource!\n&quot;); 
                return -1;
        }
+
+       if (dev-&gt;irq==0)
+               return -1;
 
        /*
         * Ok, start setup.. Map the cardbus registers,
@@ -929,7 +969,8 @@
        yenta_allocate_resources(socket);
 
        socket-&gt;cb_irq = dev-&gt;irq;
-
+       printk(&quot;\tyenta_open socket-&gt;cb_irq = dev-&gt;irq=%x\n&quot;, dev-&gt;irq);  //Amin add
+       printk(&quot;\tyenta_open socket-&gt;socket-&gt;base=%x\n&quot;, socket-&gt;base);  //Amin add
        /* Do we have special options for the device? */
        for (i = 0; i &lt; NR_OVERRIDES; i++) {
                struct cardbus_override_struct *d = cardbus_override+i;</code></pre></div><div class="codebox"><pre><code>--- linux.x/arch/mips/bcm947xx/pcibios.c        2006-02-22 21:49:05.000000000 +0200
+++ linux/linux/arch/mips/brcm-boards/bcm947xx/pcibios.c        2005-11-02 08:21:43.000000000 +0200
@@ -186,6 +184,13 @@
                for (ln=b-&gt;devices.next; ln != &amp;b-&gt;devices; ln=ln-&gt;next) {
                        d = pci_dev_b(ln);
                        /* Fix up resource bases */
+// add Amin
+                       if(b-&gt;number == 2)
+                       {
+                               pci_membase = 0x40004000;
+                       }
+                               printk(&quot;PCI: Fixing up bus %d pci_membase=%x\n&quot;, b-&gt;number, pci_membase);
+// add Amin
                        for (pos = 0; pos &lt; 6; pos++) {
                                res = &amp;d-&gt;resource[pos];
                                base = (res-&gt;flags &amp; IORESOURCE_IO) ? &amp;pci_iobase : &amp;pci_membase;
@@ -206,6 +211,7 @@
                        if (pci_find_device(VENDOR_BROADCOM, SB_PCI, NULL))
                                d-&gt;irq = (pci_find_device(VENDOR_BROADCOM, SB_PCI, NULL))-&gt;irq;
                        pci_write_config_byte(d, PCI_INTERRUPT_LINE, d-&gt;irq);
+                       printk(&quot;\tpcibios_fixup_bus d-&gt;irq:%x\n&quot;, d-&gt;irq);
                }
        }
 }
@@ -259,7 +265,10 @@
 
        /* External PCI device enable */
        if (dev-&gt;bus-&gt;number != 0)
+       {
+               printk(&quot;\tpcibios_enable_device() enter pcibios_enable_resources\n&quot;);
                return pcibios_enable_resources(dev);
+       }
 
        /* These cores come out of reset enabled */
        if (dev-&gt;device == SB_MIPS ||
@@ -310,6 +319,13 @@
        pci_read_config_dword(dev, where, &amp;reg);
        reg = (reg &amp; size) | (((u32)(res-&gt;start - root-&gt;start)) &amp; ~size);
        pci_write_config_dword(dev, where, reg);
+
+       if(dev-&gt;bus-&gt;number==2) {
+               //reg = 0x40004000;     /* Original hack */
+               reg = res-&gt;start;       /* FIXED Greg 07-28-5 to enable multi-device card */
+               pci_write_config_dword(dev, where, reg);  /* Enable PCI device */
+               printk(&quot;4704 pcibios_update_resource HACK !!!!! wr[%x]=%x\n&quot;, where, reg);
+       }
 }
 
 static void __init</code></pre></div><div class="codebox"><pre><code>--- linux.x/include/asm-mips/serial.h   2006-02-22 21:59:08.000000000 +0200
+++ linux/linux/include/asm-mips/serial.h       2005-11-02 08:22:20.000000000 +0200
@@ -225,7 +181,14 @@
 
 #ifdef CONFIG_BCM947XX
 /* reserve 4 ports to be configured at runtime */
-#define BCM947XX_SERIAL_PORT_DEFNS { 0, }, { 0, }, { 0, }, { 0, },
+//#define BCM947XX_SERIAL_PORT_DEFNS { 0, }, { 0, }, { 0, }, { 0, },   // original code 
+//--&gt;  940720 Amin add for support Novatel 3g/gprs card 
+#define BCM947XX_SERIAL_PORT_DEFNS     \
+       { 0, BASE_BAUD, 0, 0, STD_COM_FLAGS },  /* ttyS0 */     \
+       { 0, BASE_BAUD, 0, 0, STD_COM_FLAGS },  /* ttyS1 */     \
+       { 0, BASE_BAUD, 0, 0, STD_COM_FLAGS },  /* ttyS2 */     \
+       { 0, BASE_BAUD, 0, 0, STD_COM4_FLAGS }, /* ttyS3 */
+//&lt;--
 #else
 #define BCM947XX_SERIAL_PORT_DEFNS
 #endif</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p21560">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">scoace</div>
					<div class="post-datetime">
						25 Feb 2006, 21:08					</div>
				</div>
				<div class="post-content content">
					<p>jr,</p><p>in which order did you load the kernel modules and how did your output look like</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p21562">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">jr</div>
					<div class="post-datetime">
						25 Feb 2006, 21:36					</div>
				</div>
				<div class="post-content content">
					<p>After you apply those three patches and compile Kamikaze (I used 3263 version) with pcmcia modules they load in proper order.</p><p>Anyway here&#039;s complete log with automatic module loading disabled so you can better see order.</p><div class="codebox"><pre><code>CFE version 1.0.37 for BCM947XX (32bit,SP,LE)
Build Date: ä¸€  9æœˆ 12 17:36:00 CST 2005 (root@NC6K.cybertan.com)
Copyright (C) 2000,2001,2002,2003 Broadcom Corporation.

Initializing Arena
Initializing Devices.

No DPN
et0: Broadcom BCM47xx 10/100 Mbps Ethernet Controller 3.90.37.0
rndis0: Broadcom USB RNDIS Network Adapter (P-t-P)
CPU type 0x29007: 200MHz
Total memory: 16384 KBytes

Total memory used by CFE:  0x80300000 - 0x803A3660 (669280)
Initialized Data:          0x80339570 - 0x8033BC80 (10000)
BSS Area:                  0x8033BC80 - 0x8033D660 (6624)
Local Heap:                0x8033D660 - 0x803A1660 (409600)
Stack Area:                0x803A1660 - 0x803A3660 (8192)
Text (code) segment:       0x80300000 - 0x80339570 (234864)
Boot area (physical):      0x003A4000 - 0x003E4000
Relocation Factor:         I:00000000 - D:00000000

Boot version: v3.6
The boot is CFE

mac_init(): Find mac [00:14:BF:D7:96:FD] in location 0
Nothing...

No eou key find
Device eth0:  hwaddr 00-14-BF-D7-96-FD, ipaddr 192.168.1.1, mask 255.255.255.0
        gateway not set, nameserver not set
Loader:raw Filesys:raw Dev:flash0.os File: Options:(null)
Loading: .. 3732 bytes read
Entry at 0x80001000
Closing network.
Starting program at 0x80001000
CPU revision is: 00029007
Primary instruction cache 8kB, physically tagged, 2-way, linesize 16 bytes.
Primary data cache 4kB, 2-way, linesize 16 bytes.
Linux version 2.4.32 (root@Freeride.adtest.net) (gcc version 3.4.5 (OpenWrt-2.0)) #2 Thu Feb 23 00:42:40 EET 2006
Determined physical RAM map:
 memory: 01000000 @ 00000000 (usable)
On node 0 totalpages: 4096
zone(0): 4096 pages.
zone(1): 0 pages.
zone(2): 0 pages.
Kernel command line: root=/dev/mtdblock2 rootfstype=squashfs,jffs2 init=/etc/preinit noinitrd console=ttyS0,115200
CPU: BCM4712 rev 1 at 200 MHz
Using 100.000 MHz high precision timer.
Calibrating delay loop... 199.47 BogoMIPS
Memory: 14272k/16384k available (1411k kernel code, 2112k reserved, 112k data, 88k init, 0k highmem)
Dentry cache hash table entries: 2048 (order: 2, 16384 bytes)
Inode cache hash table entries: 1024 (order: 1, 8192 bytes)
Mount cache hash table entries: 512 (order: 0, 4096 bytes)
Buffer cache hash table entries: 1024 (order: 0, 4096 bytes)
Page-cache hash table entries: 4096 (order: 2, 16384 bytes)
Checking for &#039;wait&#039; instruction...  unavailable.
POSIX conformance testing by UNIFIX
PCI: Fixing up bus 0
PCI: Fixing up bridge
PCI: Fixing up bus 1
PCI: Fixing up bus 1 pci_membase=40000000
    pcibios_fixup_bus d-&gt;irq:2
PCI: Fixing up bus 1 pci_membase=40002000
    pcibios_fixup_bus d-&gt;irq:2
Linux NET4.0 for Linux 2.4
Based upon Swansea University Computer Society NET3.039
Initializing RT netlink socket
Starting kswapd
devfs: v1.12c (20020818) Richard Gooch (rgooch@atnf.csiro.au)
devfs: boot_options: 0x1
JFFS2 version 2.1. (C) 2001 Red Hat, Inc., designed by Axis Communications AB.
Squashfs 2.2 (released 2005/07/03) (C) 2002-2004, 2005 Phillip Lougher
pty: 256 Unix98 ptys configured
Serial driver version 5.05c (2001-07-08) with MANY_PORTS SHARE_IRQ SERIAL_PCI enabled
ttyS00 at 0xb8000300 (irq = 3) is a 16550A
ttyS01 at 0xb8000400 (irq = 3) is a 16550A
b44.c:v0.93 (Mar, 2004)
eth0: Broadcom 47xx 10/100BaseT Ethernet 00:14:bf:d7:96:fd
cfi_cmdset_0001: Erase suspend on write enabled
Using word write method
Flash device: 0x400000 at 0x1c000000
bootloader size flag: 0
Creating 5 MTD partitions on &quot;Physically mapped flash&quot;:
0x00000000-0x00040000 : &quot;cfe&quot;
0x00040000-0x003f0000 : &quot;linux&quot;
0x000bc400-0x00258000 : &quot;rootfs&quot;
mtd: partition &quot;rootfs&quot; doesn&#039;t start on an erase block boundary -- force read-only
0x003f0000-0x00400000 : &quot;nvram&quot;
0x00260000-0x003f0000 : &quot;OpenWrt&quot;
Initializing Cryptographic API
NET4: Linux TCP/IP 1.0 for NET4.0
IP Protocols: ICMP, UDP, TCP, IGMP
IP: routing cache hash table of 512 buckets, 4Kbytes
TCP: Hash tables configured (established 1024 bind 2048)
ip_conntrack version 2.1 (5953 buckets, 5953 max) - 360 bytes per conntrack
ip_tables: (C) 2000-2002 Netfilter core team
NET4: Unix domain sockets 1.0/SMP for Linux NET4.0.
NET4: Ethernet Bridge 008 for NET4.0
802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;
All bugs added by David S. Miller &lt;davem@redhat.com&gt;
VFS: Mounted root (squashfs filesystem) readonly.
Mounted devfs on /dev
Freeing unused kernel memory: 88k freed
Algorithmics/MIPS FPU Emulator v1.5
diag boardtype: 00000101
Unlocking OpenWrt ...
umount: Couldn&#039;t umount /rom/dev: No such file or directory
init started:  BusyBox v1.1.0 (2006.02.22-22:09+0000) multi-call binary

Please press Enter to activate this console. jffs2.bbc: SIZE compression mode activated.
Probing device eth0: found!
vlan0: dev_set_promiscuity(master, 1)
device eth0 entered promiscuous mode
device vlan0 entered promiscuous mode
vlan0: dev_set_allmulti(master, 1)
br0: port 1(vlan0) entering learning state
br0: port 1(vlan0) entering forwarding state
br0: topology change detected, propagating
eth1: Broadcom BCM4320 802.11 Wireless Controller 3.130.20.0
device eth1 entered promiscuous mode
br0: port 2(eth1) entering learning state
br0: port 2(eth1) entering forwarding state
br0: topology change detected, propagating



BusyBox v1.1.0 (2006.02.22-22:09+0000) Built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 KAMIKAZE (bleeding edge, r3263) -------------------
  * 10 oz Vodka       Shake well with ice and strain
  * 10 oz Triple sec  mixture into 10 shot glasses.
  * 10 oz lime juice  Salute!
 ---------------------------------------------------
root@OpenWrt:/# cd /lib/modules/2.4.32/

root@OpenWrt:/lib/modules/2.4.32# insmod pcmcia_core.o 
Linux Kernel Card Services 3.1.22
  options:  [pci] [cardbus]

root@OpenWrt:/lib/modules/2.4.32# insmod yenta_socket.o 
    pcibios_enable_device() enter pcibios_enable_resources
PCI: Enabling device 01:01.0 (0000 -&gt; 0002)
     yenta_allocate for bus=PCI CardBus #02 offset=1c res-&gt;start=0
     yenta_allocate for bus=PCI CardBus #02 offset=1c res-&gt;end=0
     yenta_allocate for bus=PCI CardBus #02 offset=24 res-&gt;start=40004000
     yenta_allocate for bus=PCI CardBus #02 offset=24 res-&gt;end=40007fff
     yenta_allocate for bus=PCI CardBus #02 offset=2c res-&gt;start=0
     yenta_allocate for bus=PCI CardBus #02 offset=2c res-&gt;end=0
     yenta_allocate for bus=PCI CardBus #02 offset=34 res-&gt;start=0
     yenta_allocate for bus=PCI CardBus #02 offset=34 res-&gt;end=0
    yenta_open socket-&gt;cb_irq = dev-&gt;irq=2
    yenta_open socket-&gt;socket-&gt;base=c015c000
Yenta IRQ list 06f8, PCI irq2
Socket status: 30000820
    yenta_config_init 04h=7:40h=0:42h=0:44h=3e1:80h=8405061:8ch=1002:90h=c0:91h=82:92h=64:93h=60:a2h=fe12:00h=ac56104c
    yenta_config_init 3ch=2:3dh=1:3eh=141
    yenta_config_init 805h=0
    yenta.c socket-&gt;io_irq=0

root@OpenWrt:/lib/modules/2.4.32# insmod ds.o 
    yenta_get_status=1880
    yenta_get_status=1880
    yenta.c socket-&gt;io_irq=0
    yenta.c socket-&gt;io_irq=0
    yenta.c socket-&gt;io_irq=0
    yenta_get_status=19c0
cs: cb_alloc(bus 2): vendor 0x1033, device 0x0035
4704 pcibios_update_resource HACK !!!!! wr[10]=40004000
    pcibios_enable_device() enter pcibios_enable_resources
PCI: Enabling device 02:00.0 (0000 -&gt; 0002)
4704 pcibios_update_resource HACK !!!!! wr[10]=40005000
    pcibios_enable_device() enter pcibios_enable_resources
PCI: Enabling device 02:00.1 (0000 -&gt; 0002)

root@OpenWrt:/lib/modules/2.4.32# cat /proroot@OpenWrt:/lib/modules/2.4.32# cat /proc/pci
PCI devices found:
  Bus  0, device   0, function  0:
    Class 0501: PCI device 14e4:0800 (rev 1).
      IRQ 3.
      Non-prefetchable 32 bit memory at 0x18000000 [0x18000fff].
      Non-prefetchable 32 bit memory at 0x1fc00000 [0x1fffffff].
      Non-prefetchable 32 bit memory at 0x1c000000 [0x1dffffff].
      Non-prefetchable 32 bit memory at 0x1a000000 [0x1bffffff].
  Bus  0, device   1, function  0:
    Class 0280: PCI device 14e4:4320 (rev 1).
      IRQ 4.
      Master Capable.  Latency=64.  
      Non-prefetchable 32 bit memory at 0x18001000 [0x18001fff].
  Bus  0, device   2, function  0:
    Class 0200: PCI device 14e4:4713 (rev 1).
      IRQ 5.
      Master Capable.  Latency=64.  
      Non-prefetchable 32 bit memory at 0x18002000 [0x18002fff].
  Bus  0, device   3, function  0:
    Class 0c03: PCI device 14e4:4717 (rev 1).
      IRQ 6.
      Non-prefetchable 32 bit memory at 0x18003000 [0x18003fff].
  Bus  0, device   4, function  0:
    Class 0c03: PCI device 14e4:4716 (rev 1).
      IRQ 2.
      Non-prefetchable 32 bit memory at 0x18004000 [0x18004fff].
  Bus  0, device   5, function  0:
    Class 0b30: PCI device 14e4:0816 (rev 1).
      IRQ 2.
      Non-prefetchable 32 bit memory at 0x18005000 [0x18005fff].
  Bus  0, device   6, function  0:
    Class 0500: PCI device 14e4:080f (rev 1).
      IRQ 3.
      Non-prefetchable 32 bit memory at 0x18006000 [0x18006fff].
      Non-prefetchable 32 bit memory at 0x0 [0x7ffffff].
      Non-prefetchable 32 bit memory at 0x10000000 [0x17ffffff].
      Non-prefetchable 32 bit memory at 0x80000000 [0x9fffffff].
  Bus  0, device   7, function  0:
    Class 0604: PCI device 14e4:0804 (rev 1).
      IRQ 2.
      Non-prefetchable 32 bit memory at 0x18007000 [0x18007fff].
      Non-prefetchable 32 bit memory at 0x8000000 [0xfffffff].
  Bus  1, device   0, function  0:
    Class 0600: PCI device 14e4:4712 (rev 1).
      IRQ 2.
      Master Capable.  Latency=64.  
      Non-prefetchable 32 bit memory at 0x40000000 [0x40001fff].
      Prefetchable 32 bit memory at 0x0 [0x7ffffff].
  Bus  1, device   1, function  0:
    Class 0607: PCI device 104c:ac56 (rev 0).
      IRQ 2.
      Master Capable.  Latency=168.  Min Gnt=1.Max Lat=5.
      Non-prefetchable 32 bit memory at 0x40002000 [0x40002fff].
  Bus  2, device   0, function  0:
    Class 0c03: PCI device 1033:0035 (rev 67).
      IRQ 2.
      Master Capable.  Latency=8.  Min Gnt=1.Max Lat=42.
      Non-prefetchable 32 bit memory at 0x40004000 [0x40004fff].
  Bus  2, device   0, function  1:
    Class 0c03: PCI device 1033:0035 (rev 67).
      IRQ 2.
      Master Capable.  Latency=8.  Min Gnt=1.Max Lat=42.
      Non-prefetchable 32 bit memory at 0x40005000 [0x40005fff].

root@OpenWrt:/lib/modules/2.4.32# lspci 
00:00.0 FLASH memory: Broadcom Corporation Sentry5 Chipcommon I/O Controller (rev 01)
00:01.0 Network controller: Broadcom Corporation BCM4306 802.11b/g Wireless LAN Controller (rev 01)
00:02.0 Ethernet controller: Broadcom Corporation Sentry5 Ethernet Controller (rev 01)
00:03.0 USB Controller: Broadcom Corporation BCM47xx Sentry5 USB Device Controller (rev 01)
00:04.0 USB Controller: Broadcom Corporation BCM47xx Sentry5 USB Host Controller (rev 01)
00:05.0 MIPS: Broadcom Corporation BCM3302 Sentry5 MIPS32 CPU (rev 01)
00:06.0 RAM memory: Broadcom Corporation Sentry5 DDR/SDR RAM Controller (rev 01)
00:07.0 PCI bridge: Broadcom Corporation Sentry5 PCI Bridge (rev 01)
01:00.0 Host bridge: Broadcom Corporation BCM47xx V.92 56k modem (rev 01)
01:01.0 CardBus bridge: Texas Instruments PCI1510 PC card Cardbus Controller
02:00.0 USB Controller: NEC Corporation USB (rev 43)
02:00.1 USB Controller: NEC Corporation USB (rev 43)

root@OpenWrt:/lib/modules/2.4.32# lspci -vvv
00:00.0 FLASH memory: Broadcom Corporation Sentry5 Chipcommon I/O Controller (rev 01)
    Control: I/O- Mem- BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
    Status: Cap- 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR-
    Interrupt: pin ? routed to IRQ 3
    Region 0: Memory at 18000000 (32-bit, non-prefetchable) [disabled] [size=4K]
    Region 1: Memory at 1fc00000 (32-bit, non-prefetchable) [disabled] [size=4M]
    Region 2: Memory at 1c000000 (32-bit, non-prefetchable) [disabled] [size=32M]
    Region 3: Memory at 1a000000 (32-bit, non-prefetchable) [disabled] [size=32M]
    Expansion ROM at &lt;unassigned&gt; [disabled] [size=2K]

00:01.0 Network controller: Broadcom Corporation BCM4306 802.11b/g Wireless LAN Controller (rev 01)
    Control: I/O- Mem- BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
    Status: Cap- 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR-
    Latency: 64
    Interrupt: pin A routed to IRQ 4
    Region 0: Memory at 18001000 (32-bit, non-prefetchable) [disabled] [size=4K]
    Expansion ROM at &lt;unassigned&gt; [disabled] [size=2K]

00:02.0 Ethernet controller: Broadcom Corporation Sentry5 Ethernet Controller (rev 01)
    Control: I/O- Mem- BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
    Status: Cap- 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR-
    Latency: 64
    Interrupt: pin B routed to IRQ 5
    Region 0: Memory at 18002000 (32-bit, non-prefetchable) [disabled] [size=4K]
    Expansion ROM at &lt;unassigned&gt; [disabled] [size=2K]

00:03.0 USB Controller: Broadcom Corporation BCM47xx Sentry5 USB Device Controller (rev 01) (prog-if 00 [UHCI])
    Control: I/O- Mem- BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
    Status: Cap- 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR-
    Interrupt: pin C routed to IRQ 6
    Region 0: Memory at 18003000 (32-bit, non-prefetchable) [disabled] [size=4K]
    Expansion ROM at &lt;unassigned&gt; [disabled] [size=2K]

00:04.0 USB Controller: Broadcom Corporation BCM47xx Sentry5 USB Host Controller (rev 01) (prog-if 10 [OHCI])
    Control: I/O- Mem- BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
    Status: Cap- 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR-
    Interrupt: pin D routed to IRQ 2
    Region 0: Memory at 18004000 (32-bit, non-prefetchable) [disabled] [size=4K]
    Expansion ROM at &lt;unassigned&gt; [disabled] [size=2K]

00:05.0 MIPS: Broadcom Corporation BCM3302 Sentry5 MIPS32 CPU (rev 01)
    Control: I/O- Mem- BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
    Status: Cap- 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR-
    Interrupt: pin E routed to IRQ 2
    Region 0: Memory at 18005000 (32-bit, non-prefetchable) [disabled] [size=4K]
    Expansion ROM at &lt;unassigned&gt; [disabled] [size=2K]

00:06.0 RAM memory: Broadcom Corporation Sentry5 DDR/SDR RAM Controller (rev 01)
    Control: I/O- Mem- BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
    Status: Cap- 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR-
    Interrupt: pin ? routed to IRQ 3
    Region 0: Memory at 18006000 (32-bit, non-prefetchable) [disabled] [size=4K]
    Region 1: Memory at &lt;unassigned&gt; (32-bit, non-prefetchable) [disabled] [size=128M]
    Region 2: Memory at 10000000 (32-bit, non-prefetchable) [disabled] [size=128M]
    Region 3: Memory at 80000000 (32-bit, non-prefetchable) [disabled] [size=512M]
    Expansion ROM at &lt;unassigned&gt; [disabled] [size=2K]

00:07.0 PCI bridge: Broadcom Corporation Sentry5 PCI Bridge (rev 01) (prog-if 00 [Normal decode])
    Control: I/O- Mem- BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
    Status: Cap+ 66MHz+ UDF+ FastB2B+ ParErr+ DEVSEL=?? &gt;TAbort+ &lt;TAbort+ &lt;MAbort+ &gt;SERR+ &lt;PERR+
    Region 0: Memory at 18007000 (32-bit, non-prefetchable) [disabled] [size=4K]
    Region 1: Memory at 08000000 (32-bit, non-prefetchable) [disabled] [size=128M]
    Bus: primary=00, secondary=01, subordinate=05, sec-latency=64
    I/O behind bridge: 00000000-00000fff
    Memory behind bridge: 00000000-000fffff
    Prefetchable memory behind bridge: 00000000-000fffff
    Secondary status: 66MHz- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &lt;SERR- &lt;PERR-
    Expansion ROM at &lt;unassigned&gt; [disabled] [size=2K]
    BridgeCtl: Parity- SERR- NoISA- VGA- MAbort- &gt;Reset- FastB2B-

01:00.0 Host bridge: Broadcom Corporation BCM47xx V.92 56k modem (rev 01)
    Subsystem: Broadcom Corporation BCM47xx V.92 56k modem
    Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
    Status: Cap- 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort+ &gt;SERR- &lt;PERR-
    Latency: 64
    Interrupt: pin A routed to IRQ 2
    Region 0: Memory at 40000000 (32-bit, non-prefetchable) [size=8K]
    Region 1: Memory at &lt;unassigned&gt; (32-bit, prefetchable) [size=128M]

01:01.0 CardBus bridge: Texas Instruments PCI1510 PC card Cardbus Controller
    Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
    Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=medium &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR-
    Latency: 168, Cache Line Size 08
    Interrupt: pin A routed to IRQ 2
    Region 0: Memory at 40002000 (32-bit, non-prefetchable) [size=4K]
    Bus: primary=01, secondary=02, subordinate=05, sec-latency=176
    Memory window 0: 00000000-00000000 (prefetchable)
    Memory window 1: 40004000-40007000
    I/O window 0: 00000000-00000003
    I/O window 1: 00000000-00000003
    BridgeCtl: Parity+ SERR- ISA- VGA- MAbort- &gt;Reset- 16bInt- PostWrite+
    16-bit legacy interface ports at 0001

02:00.0 USB Controller: NEC Corporation USB (rev 43) (prog-if 10 [OHCI])
    Subsystem: Option N.V. GlobeTrotter Fusion Quad Lite (PPP data)
    Control: I/O- Mem+ BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
    Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=medium &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR-
    Interrupt: pin A routed to IRQ 2
    Region 0: Memory at 40004000 (32-bit, non-prefetchable) [size=4K]
    Capabilities: [40] Power Management version 2
        Flags: PMEClk- DSI- D1+ D2+ AuxCurrent=0mA PME(D0+,D1+,D2+,D3hot+,D3cold-)
        Status: D0 PME-Enable- DSel=0 DScale=0 PME-

02:00.1 USB Controller: NEC Corporation USB (rev 43) (prog-if 10 [OHCI])
    Subsystem: Option N.V. GlobeTrotter Fusion Quad Lite (GSM data)
    Control: I/O- Mem+ BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
    Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=medium &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR-
    Interrupt: pin B routed to IRQ 2
    Region 0: Memory at 40005000 (32-bit, non-prefetchable) [size=4K]
    Capabilities: [40] Power Management version 2
        Flags: PMEClk- DSI- D1+ D2+ AuxCurrent=0mA PME(D0+,D1+,D2+,D3hot+,D3cold-)
        Status: D0 PME-Enable- DSel=0 DScale=0 PME-

root@OpenWrt:/lib/modules/2.4.32# insmod usbcore.o 
usb.c: registered new driver usbdevfs
usb.c: registered new driver hub

root@OpenWrt:/lib/modules/2.4.32# insmod usb-ohci.o 
usb-ohci.c: USB OHCI at membase 0xb8004000, IRQ 2
usb-ohci.c: usb-00:04.0, PCI device 14e4:4716
usb.c: new USB bus registered, assigned bus number 1
Product: USB OHCI Root Hub
SerialNumber: b8004000
hub.c: USB hub found
hub.c: 2 ports detected
    pcibios_enable_device() enter pcibios_enable_resources
usb-ohci.c: USB OHCI at membase 0xc017c000, IRQ 2
usb-ohci.c: usb-02:00.0, PCI device 1033:0035
usb.c: new USB bus registered, assigned bus number 2
Product: USB OHCI Root Hub
SerialNumber: c017c000
hub.c: USB hub found
hub.c: 1 port detected
    pcibios_enable_device() enter pcibios_enable_resources
usb-ohci.c: USB OHCI at membase 0xc017e000, IRQ 2
usb-ohci.c: usb-02:00.1, PCI device 1033:0035
usb.c: new USB bus registered, assigned bus number 3
Product: USB OHCI Root Hub
SerialNumber: c017e000
hub.c: USB hub found
hub.c: 1 port detected
hub.c: new USB device 02:00.1-1, assigned address 2
Manufacturer: Option N.V.
Product: Fusion UMTS Quad-GPRS     
SerialNumber: ?Serial Numbe
usb.c: USB device 2 (vend/prod 0xaf0/0x6300) is not claimed by any active driver.
  Length              = 18
  DescriptorType      = 01
  USB version         = 1.10
  Vendor:Product      = 0af0:6300
  MaxPacketSize0      = 64
  NumConfigurations   = 1
  Device version      = 0.00
  Device Class:SubClass:Protocol = 00:00:00
    Per-interface classes
Configuration:
  bLength             =    9
  bDescriptorType     =   02
  wTotalLength        = 0055
  bNumInterfaces      =   03
  bConfigurationValue =   01
  iConfiguration      =   00
  bmAttributes        =   a0
  MaxPower            =  100mA

  Interface: 0
  Alternate Setting:  0
    bLength             =    9
    bDescriptorType     =   04
    bInterfaceNumber    =   00
    bAlternateSetting   =   00
    bNumEndpoints       =   03
    bInterface Class:SubClass:Protocol =   ff:ff:ff
    iInterface          =   03
    Endpoint:
      bLength             =    7
      bDescriptorType     =   05
      bEndpointAddress    =   81 (in)
      bmAttributes        =   03 (Interrupt)
      wMaxPacketSize      = 0010
      bInterval           =   80
    Endpoint:
      bLength             =    7
      bDescriptorType     =   05
      bEndpointAddress    =   82 (in)
      bmAttributes        =   02 (Bulk)
      wMaxPacketSize      = 0040
      bInterval           =   00
    Endpoint:
      bLength             =    7
      bDescriptorType     =   05
      bEndpointAddress    =   02 (out)
      bmAttributes        =   02 (Bulk)
      wMaxPacketSize      = 0040
      bInterval           =   00

  Interface: 1
  Alternate Setting:  0
    bLength             =    9
    bDescriptorType     =   04
    bInterfaceNumber    =   01
    bAlternateSetting   =   00
    bNumEndpoints       =   02
    bInterface Class:SubClass:Protocol =   ff:ff:ff
    iInterface          =   03
    Endpoint:
      bLength             =    7
      bDescriptorType     =   05
      bEndpointAddress    =   84 (in)
      bmAttributes        =   02 (Bulk)
      wMaxPacketSize      = 0040
      bInterval           =   00
    Endpoint:
      bLength             =    7
      bDescriptorType     =   05
      bEndpointAddress    =   04 (out)
      bmAttributes        =   02 (Bulk)
      wMaxPacketSize      = 0040
      bInterval           =   00

  Interface: 2
  Alternate Setting:  0
    bLength             =    9
    bDescriptorType     =   04
    bInterfaceNumber    =   02
    bAlternateSetting   =   00
    bNumEndpoints       =   02
    bInterface Class:SubClass:Protocol =   ff:ff:ff
    iInterface          =   03
    Endpoint:
      bLength             =    7
      bDescriptorType     =   05
      bEndpointAddress    =   85 (in)
      bmAttributes        =   02 (Bulk)
      wMaxPacketSize      = 0040
      bInterval           =   00
    Endpoint:
      bLength             =    7
      bDescriptorType     =   05
      bEndpointAddress    =   05 (out)
      bmAttributes        =   02 (Bulk)
      wMaxPacketSize      = 0040
      bInterval           =   00

root@OpenWrt:/lib/modules/2.4.32# lsusb
Bus 003 Device 001: ID 0000:0000  
Bus 003 Device 002: ID 0af0:6300 Option 
Bus 002 Device 001: ID 0000:0000  
Bus 001 Device 001: ID 0000:0000  

root@OpenWrt:/lib/modules/2.4.32# lsusb -v

Bus 003 Device 001: ID 0000:0000  
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               1.10
  bDeviceClass            9 Hub
  bDeviceSubClass         0 Unused
  bDeviceProtocol         0 
  bMaxPacketSize0         8
  idVendor           0x0000 
  idProduct          0x0000 
  bcdDevice            0.00
  iManufacturer           0 
  iProduct                2 USB OHCI Root Hub
  iSerial                 1 c017e000
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength           25
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0x40
      Self Powered
    MaxPower                0mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass         9 Hub
      bInterfaceSubClass      0 Unused
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0002  1x 2 bytes
        bInterval             255
Hub Descriptor:
  bLength               9
  bDescriptorType      41
  nNbrPorts             1
  wHubCharacteristic 0x0008
    Ganged power switching
    Per-port overcurrent protection
  bPwrOn2PwrGood       15 * 2 milli seconds
  bHubContrCurrent      0 milli Ampere
  DeviceRemovable    0x00
  PortPwrCtrlMask    0x80 
 Hub Port Status:
   Port 1: 0000.0103 power enable connect

Bus 003 Device 002: ID 0af0:6300 Option 
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               1.10
  bDeviceClass            0 (Defined at Interface level)
  bDeviceSubClass         0 
  bDeviceProtocol         0 
  bMaxPacketSize0        64
  idVendor           0x0af0 Option
  idProduct          0x6300 
  bcdDevice            0.00
  iManufacturer           1 Option N.V.
  iProduct                2 Fusion UMTS Quad-GPRS     
  iSerial                 4 ?Serial Numbe
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength           85
    bNumInterfaces          3
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0xa0
      Remote Wakeup
    MaxPower              100mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           3
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              3 Data Interface
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0010  1x 16 bytes
        bInterval             128
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0040  1x 64 bytes
        bInterval               0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x02  EP 2 OUT
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0040  1x 64 bytes
        bInterval               0
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        1
      bAlternateSetting       0
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              3 Data Interface
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x84  EP 4 IN
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0040  1x 64 bytes
        bInterval               0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x04  EP 4 OUT
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0040  1x 64 bytes
        bInterval               0
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        2
      bAlternateSetting       0
      bNumEndpoints           2
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass    255 Vendor Specific Subclass
      bInterfaceProtocol    255 Vendor Specific Protocol
      iInterface              3 Data Interface
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x85  EP 5 IN
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0040  1x 64 bytes
        bInterval               0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x05  EP 5 OUT
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0040  1x 64 bytes
        bInterval               0

Bus 002 Device 001: ID 0000:0000  
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               1.10
  bDeviceClass            9 Hub
  bDeviceSubClass         0 Unused
  bDeviceProtocol         0 
  bMaxPacketSize0         8
  idVendor           0x0000 
  idProduct          0x0000 
  bcdDevice            0.00
  iManufacturer           0 
  iProduct                2 USB OHCI Root Hub
  iSerial                 1 c017c000
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength           25
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0x40
      Self Powered
    MaxPower                0mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass         9 Hub
      bInterfaceSubClass      0 Unused
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0002  1x 2 bytes
        bInterval             255
Hub Descriptor:
  bLength               9
  bDescriptorType      41
  nNbrPorts             1
  wHubCharacteristic 0x0008
    Ganged power switching
    Per-port overcurrent protection
  bPwrOn2PwrGood       15 * 2 milli seconds
  bHubContrCurrent      0 milli Ampere
  DeviceRemovable    0x00
  PortPwrCtrlMask    0x80 
 Hub Port Status:
   Port 1: 0000.0100 power

Bus 001 Device 001: ID 0000:0000  
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               1.10
  bDeviceClass            9 Hub
  bDeviceSubClass         0 Unused
  bDeviceProtocol         0 
  bMaxPacketSize0         8
  idVendor           0x0000 
  idProduct          0x0000 
  bcdDevice            0.00
  iManufacturer           0 
  iProduct                2 USB OHCI Root Hub
  iSerial                 1 b8004000
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength           25
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0x40
      Self Powered
    MaxPower                0mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass         9 Hub
      bInterfaceSubClass      0 Unused
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0002  1x 2 bytes
        bInterval             255
Hub Descriptor:
  bLength               9
  bDescriptorType      41
  nNbrPorts             2
  wHubCharacteristic 0x0010
    Ganged power switching
    No overcurrent protection
  bPwrOn2PwrGood        2 * 2 milli seconds
  bHubContrCurrent      0 milli Ampere
  DeviceRemovable    0x00
  PortPwrCtrlMask    0x80 
 Hub Port Status:
   Port 1: 0000.0100 power
   Port 2: 0000.0100 power

root@OpenWrt:/lib/modules/2.4.32# cat /proc/interrupts 
           CPU0       
  2:         22            MIPS  PCI device 104c:ac56, usb-ohci, usb-ohci, usb-ohci
  3:       1786            MIPS  serial
  4:       1782            MIPS  eth1
  5:       1551            MIPS  eth0
  7:      19821            MIPS  timer

ERR:          0

root@OpenWrt:/lib/modules/2.4.32#</code></pre></div><p>This is with Cardbus-USB2 adapter and 512MB USB flash.<br /></p><div class="codebox"><pre><code>root@OpenWrt:/lib/modules/2.4.32# insmod usbcore.o 
usb.c: registered new driver usbdevfs
usb.c: registered new driver hub

root@OpenWrt:/lib/modules/2.4.32# insmod usb-ohci.o 
usb-ohci.c: USB OHCI at membase 0xb8004000, IRQ 2
usb-ohci.c: usb-00:04.0, PCI device 14e4:4716
usb.c: new USB bus registered, assigned bus number 1
Product: USB OHCI Root Hub
SerialNumber: b8004000
hub.c: USB hub found
hub.c: 2 ports detected
    pcibios_enable_device() enter pcibios_enable_resources
usb-ohci.c: USB OHCI at membase 0xc017c000, IRQ 2
usb-ohci.c: usb-02:00.0, PCI device 1033:0035
usb.c: new USB bus registered, assigned bus number 2
Product: USB OHCI Root Hub
SerialNumber: c017c000
hub.c: USB hub found
hub.c: 3 ports detected
    pcibios_enable_device() enter pcibios_enable_resources
usb-ohci.c: USB OHCI at membase 0xc017e000, IRQ 2
usb-ohci.c: usb-02:00.1, PCI device 1033:0035
usb.c: new USB bus registered, assigned bus number 3
Product: USB OHCI Root Hub
SerialNumber: c017e000
hub.c: USB hub found
hub.c: 2 ports detected
hub.c: new USB device 02:00.1-1, assigned address 2
Manufacturer: USB     
Product: Flash Disk      
SerialNumber: 106C42E6169B009F
usb.c: USB device 2 (vend/prod 0xea0/0x2168) is not claimed by any active driver.
  Length              = 18
  DescriptorType      = 01
  USB version         = 2.00
  Vendor:Product      = 0ea0:2168
  MaxPacketSize0      = 64
  NumConfigurations   = 1
  Device version      = 2.00
  Device Class:SubClass:Protocol = 00:00:00
    Per-interface classes
Configuration:
  bLength             =    9
  bDescriptorType     =   02
  wTotalLength        = 0027
  bNumInterfaces      =   01
  bConfigurationValue =   01
  iConfiguration      =   00
  bmAttributes        =   80
  MaxPower            =  200mA

  Interface: 0
  Alternate Setting:  0
    bLength             =    9
    bDescriptorType     =   04
    bInterfaceNumber    =   00
    bAlternateSetting   =   00
    bNumEndpoints       =   03
    bInterface Class:SubClass:Protocol =   08:06:50
    iInterface          =   00
    Endpoint:
      bLength             =    7
      bDescriptorType     =   05
      bEndpointAddress    =   81 (in)
      bmAttributes        =   02 (Bulk)
      wMaxPacketSize      = 0040
      bInterval           =   00
    Endpoint:
      bLength             =    7
      bDescriptorType     =   05
      bEndpointAddress    =   02 (out)
      bmAttributes        =   02 (Bulk)
      wMaxPacketSize      = 0040
      bInterval           =   00
    Endpoint:
      bLength             =    7
      bDescriptorType     =   05
      bEndpointAddress    =   83 (in)
      bmAttributes        =   03 (Interrupt)
      wMaxPacketSize      = 0002
      bInterval           =   01

root@OpenWrt:/lib/modules/2.4.32# insmod scsi_mod.o 
SCSI subsystem driver Revision: 1.00

root@OpenWrt:/lib/modules/2.4.32# insmod scsi_mod.o
root@OpenWrt:/lib/modules/2.4.32# insmod sg.o
root@OpenWrt:/lib/modules/2.4.32# insmod usb-storage.o 
Initializing USB Mass Storage driver...
usb.c: registered new driver usb-storage
scsi0 : SCSI emulation for USB Mass Storage devices
  Vendor: Generic   Model: USB Flash Disk    Rev: 2.00
  Type:   Direct-Access                      ANSI SCSI revision: 02
USB Mass Storage support registered.

root@OpenWrt:/lib/modules/2.4.32# insmod fat.o 
root@OpenWrt:/lib/modules/2.4.32# insmod vfat.o 
root@OpenWrt:/lib/modules/2.4.32# insmod ehci-hcd.o 
    pcibios_enable_device() enter pcibios_enable_resources
ehci_hcd 02:00.2: PCI device 1033:00e0
ehci_hcd 02:00.2: irq 2, pci mem c01ba000
usb.c: new USB bus registered, assigned bus number 4
ehci_hcd 02:00.2: USB 2.0 enabled, EHCI 1.00, driver 2003-Dec-29/2.4
Manufacturer: Linux 2.4.32 ehci_hcd
Product: PCI device 1033:00e0
SerialNumber: 02:00.2
hub.c: USB hub found
hub.c: 5 ports detected
usb.c: USB disconnect on device 02:00.1-1 address 2
hub.c: new USB device 02:00.2-2, assigned address 2
Manufacturer: USB     
Product: Flash Disk      
SerialNumber: 106C42E6169B009F

root@OpenWrt:/lib/modules/2.4.32# insmod sd_mod.o 
Attached scsi removable disk sda at scsi0, channel 0, id 0, lun 0
sda: Unit Not Ready, sense:
Current 00:00: sns = 70  6
ASC=28 ASCQ= 0
Raw sense data:0x70 0x00 0x06 0x00 0x00 0x00 0x00 0x0a 0x00 0x00 0x00 0x00 0x28 0x00 0x00 0x00 0x00 0x00 
sda : READ CAPACITY failed.
sda : status = 1, message = 00, host = 0, driver = 08 
Current sd00:00: sns = 70  6
ASC=28 ASCQ= 0
Raw sense data:0x70 0x00 0x06 0x00 0x00 0x00 0x00 0x0a 0x00 0x00 0x00 0x00 0x28 0x00 0x00 0x00 0x00 0x00 
sda : block size assumed to be 512 bytes, disk size 1GB.  
Partition check:
 /dev/scsi/host0/bus0/target0/lun0: I/O error: dev 08:00, sector 0
 I/O error: dev 08:00, sector 0
 unable to read partition table

root@OpenWrt:/lib/modules/2.4.32# mount /dev/scsi/host0/bus0/target0/lun0/part1 /mnt/x -t vfat
SCSI device sda: 1017344 512-byte hdwr sectors (521 MB)
sda: Write Protect is off
 /dev/scsi/host0/bus0/target0/lun0: p1

root@OpenWrt:/lib/modules/2.4.32# find /dev/scsi
/dev/scsi
/dev/scsi/host0
/dev/scsi/host0/bus0
/dev/scsi/host0/bus0/target0
/dev/scsi/host0/bus0/target0/lun0
/dev/scsi/host0/bus0/target0/lun0/generic
/dev/scsi/host0/bus0/target0/lun0/disc
/dev/scsi/host0/bus0/target0/lun0/part1

root@OpenWrt:/lib/modules/2.4.32# df -h
Filesystem                Size      Used Available Use% Mounted on
/dev/mtdblock/4           1.6M    384.0k      1.2M  24% /
none                      7.0M     20.0k      7.0M   0% /tmp
/dev/scsi/host0/bus0/target0/lun0/part1    496.2M    186.0M    310.3M  37% /tmp/mnt/x

root@OpenWrt:/lib/modules/2.4.32# cd /mnt/x
root@OpenWrt:~/mnt/x# mkdir foo
root@OpenWrt:~/mnt/x# cd foo
root@OpenWrt:~/mnt/x# time dd if=/dev/zero of=foo bs=1k count=100000
100000+0 records in
100000+0 records out
real    0m 30.09s
user    0m 1.81s
sys    0m 19.71s

root@OpenWrt:~/mnt/x/foo# dd if=foo of=/dev/null bs=1k
100000+0 records in
100000+0 records out

root@OpenWrt:~/mnt/x/foo# df -h
Filesystem                Size      Used Available Use% Mounted on
/dev/mtdblock/4           1.6M    384.0k      1.2M  24% /
none                      7.0M     20.0k      7.0M   0% /tmp
/dev/scsi/host0/bus0/target0/lun0/part1    496.2M    283.6M    212.6M  57% /tmp/mnt/x

root@OpenWrt:~/mnt/x/foo# rm -f foo 
root@OpenWrt:~/mnt/x/foo# cd
root@OpenWrt:/# umount /mnt/x

usb.c: USB disconnect on device 02:00.2-2 address 2

hub.c: new USB device 02:00.2-2, assigned address 3

Manufacturer: USB     
Product: Flash Disk      
SerialNumber: 106C42E6169B009F
sda: Unit Not Ready, sense:
Current 00:00: sns = 70  6
ASC=28 ASCQ= 0
Raw sense data:0x70 0x00 0x06 0x00 0x00 0x00 0x00 0x0a 0x00 0x00 0x00 0x00 0x28 0x00 0x00 0x00 0x00 0x00 
sda : READ CAPACITY failed.
sda : status = 1, message = 00, host = 0, driver = 08 
Current sd00:00: sns = 70  6
ASC=28 ASCQ= 0
Raw sense data:0x70 0x00 0x06 0x00 0x00 0x00 0x00 0x0a 0x00 0x00 0x00 0x00 0x28 0x00 0x00 0x00 0x00 0x00 
sda : block size assumed to be 512 bytes, disk size 1GB.  
sda: test WP failed, assume Write Enabled
 /dev/scsi/host0/bus0/target0/lun0: I/O error: dev 08:00, sector 0
 I/O error: dev 08:00, sector 0
sda: Unit Not Ready, sense:
Current 00:00: sns = 70  6
ASC=28 ASCQ= 0
Raw sense data:0x70 0x00 0x06 0x00 0x00 0x00 0x00 0x0a 0x00 0x00 0x00 0x00 0x28 0x00 0x00 0x00 0x00 0x00 
sda : READ CAPACITY failed.
sda : status = 1, message = 00, host = 0, driver = 08 
Current sd00:00: sns = 70  6
ASC=28 ASCQ= 0
Raw sense data:0x70 0x00 0x06 0x00 0x00 0x00 0x00 0x0a 0x00 0x00 0x00 0x00 0x28 0x00 0x00 0x00 0x00 0x00 
sda : block size assumed to be 512 bytes, disk size 1GB.  
sda: test WP failed, assume Write Enabled
 /dev/scsi/host0/bus0/target0/lun0: I/O error: dev 08:00, sector 0
 I/O error: dev 08:00, sector 0
sda: Unit Not Ready, sense:
Current 00:00: sns = 70  6
ASC=28 ASCQ= 0
Raw sense data:0x70 0x00 0x06 0x00 0x00 0x00 0x00 0x0a 0x00 0x00 0x00 0x00 0x28 0x00 0x00 0x00 0x00 0x00 
sda : READ CAPACITY failed.
sda : status = 1, message = 00, host = 0, driver = 08 
Current sd00:00: sns = 70  6
ASC=28 ASCQ= 0
Raw sense data:0x70 0x00 0x06 0x00 0x00 0x00 0x00 0x0a 0x00 0x00 0x00 0x00 0x28 0x00 0x00 0x00 0x00 0x00 
sda : block size assumed to be 512 bytes, disk size 1GB.  
sda: test WP failed, assume Write Enabled
 /dev/scsi/host0/bus0/target0/lun0: I/O error: dev 08:00, sector 0
 I/O error: dev 08:00, sector 0
sda: Unit Not Ready, sense:
Current 00:00: sns = 70  6
ASC=28 ASCQ= 0
Raw sense data:0x70 0x00 0x06 0x00 0x00 0x00 0x00 0x0a 0x00 0x00 0x00 0x00 0x28 0x00 0x00 0x00 0x00 0x00 
sda : READ CAPACITY failed.
sda : status = 1, message = 00, host = 0, driver = 08 
Current sd00:00: sns = 70  6
ASC=28 ASCQ= 0
Raw sense data:0x70 0x00 0x06 0x00 0x00 0x00 0x00 0x0a 0x00 0x00 0x00 0x00 0x28 0x00 0x00 0x00 0x00 0x00 
sda : block size assumed to be 512 bytes, disk size 1GB.  
sda: test WP failed, assume Write Enabled
 /dev/scsi/host0/bus0/target0/lun0: I/O error: dev 08:00, sector 0
 I/O error: dev 08:00, sector 0
sda: Unit Not Ready, sense:
Current 00:00: sns = 70  6
ASC=28 ASCQ= 0
Raw sense data:0x70 0x00 0x06 0x00 0x00 0x00 0x00 0x0a 0x00 0x00 0x00 0x00 0x28 0x00 0x00 0x00 0x00 0x00 
sda : READ CAPACITY failed.
sda : status = 1, message = 00, host = 0, driver = 08 
Current sd00:00: sns = 70  6
ASC=28 ASCQ= 0
Raw sense data:0x70 0x00 0x06 0x00 0x00 0x00 0x00 0x0a 0x00 0x00 0x00 0x00 0x28 0x00 0x00 0x00 0x00 0x00 
sda : block size assumed to be 512 bytes, disk size 1GB.  
sda: test WP failed, assume Write Enabled
 /dev/scsi/host0/bus0/target0/lun0: I/O error: dev 08:00, sector 0
 I/O error: dev 08:00, sector 0
sda: Unit Not Ready, sense:
Current 00:00: sns = 70  6
ASC=28 ASCQ= 0
Raw sense data:0x70 0x00 0x06 0x00 0x00 0x00 0x00 0x0a 0x00 0x00 0x00 0x00 0x28 0x00 0x00 0x00 0x00 0x00 
sda : READ CAPACITY failed.
sda : status = 1, message = 00, host = 0, driver = 08 
Current sd00:00: sns = 70  6
ASC=28 ASCQ= 0
Raw sense data:0x70 0x00 0x06 0x00 0x00 0x00 0x00 0x0a 0x00 0x00 0x00 0x00 0x28 0x00 0x00 0x00 0x00 0x00 
sda : block size assumed to be 512 bytes, disk size 1GB.  
sda: test WP failed, assume Write Enabled
 /dev/scsi/host0/bus0/target0/lun0: I/O error: dev 08:00, sector 0
 I/O error: dev 08:00, sector 0

root@OpenWrt:/# lsusb
Bus 004 Device 001: ID 0000:0000  
Bus 004 Device 003: ID 0ea0:2168 Ours Technology, Inc. Transcend JetFlash 2.0 / Astone USB Drive
Bus 003 Device 001: ID 0000:0000  
Bus 002 Device 001: ID 0000:0000  
Bus 001 Device 001: ID 0000:0000  

root@OpenWrt:/# lsusb -v

Bus 004 Device 001: ID 0000:0000  
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass            9 Hub
  bDeviceSubClass         0 Unused
  bDeviceProtocol         1 Single TT
  bMaxPacketSize0         8
  idVendor           0x0000 
  idProduct          0x0000 
  bcdDevice            2.04
  iManufacturer           3 Linux 2.4.32 ehci_hcd
  iProduct                2 PCI device 1033:00e0
  iSerial                 1 02:00.2
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength           25
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0x40
      Self Powered
    MaxPower                0mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass         9 Hub
      bInterfaceSubClass      0 Unused
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0002  1x 2 bytes
        bInterval              12
Hub Descriptor:
  bLength               9
  bDescriptorType      41
  nNbrPorts             5
  wHubCharacteristic 0x0009
    Per-port power switching
    Per-port overcurrent protection
    TT think time 8 FS bits
  bPwrOn2PwrGood       10 * 2 milli seconds
  bHubContrCurrent      0 milli Ampere
  DeviceRemovable    0x00
  PortPwrCtrlMask    0x80 
 Hub Port Status:
   Port 1: 0000.0100 power
   Port 2: 0000.0503 highspeed power enable connect
   Port 3: 0000.0100 power
   Port 4: 0000.0100 power
   Port 5: 0000.0100 power

Bus 004 Device 003: ID 0ea0:2168 Ours Technology, Inc. Transcend JetFlash 2.0 / Astone USB Drive
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass            0 (Defined at Interface level)
  bDeviceSubClass         0 
  bDeviceProtocol         0 
  bMaxPacketSize0        64
  idVendor           0x0ea0 Ours Technology, Inc.
  idProduct          0x2168 Transcend JetFlash 2.0 / Astone USB Drive
  bcdDevice            2.00
  iManufacturer           1 USB     
  iProduct                2 Flash Disk      
  iSerial                 3 106C42E6169B009F
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength           39
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0x80
    MaxPower              200mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           3
      bInterfaceClass         8 Mass Storage
      bInterfaceSubClass      6 SCSI
      bInterfaceProtocol     80 Bulk (Zip)
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x02  EP 2 OUT
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0002  1x 2 bytes
        bInterval               1
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass            0 (Defined at Interface level)
  bDeviceSubClass         0 
  bDeviceProtocol         0 
  bMaxPacketSize0        64
  bNumConfigurations      1

Bus 003 Device 001: ID 0000:0000  
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               1.10
  bDeviceClass            9 Hub
  bDeviceSubClass         0 Unused
  bDeviceProtocol         0 
  bMaxPacketSize0         8
  idVendor           0x0000 
  idProduct          0x0000 
  bcdDevice            0.00
  iManufacturer           0 
  iProduct                2 USB OHCI Root Hub
  iSerial                 1 c017e000
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength           25
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0x40
      Self Powered
    MaxPower                0mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass         9 Hub
      bInterfaceSubClass      0 Unused
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0002  1x 2 bytes
        bInterval             255
Hub Descriptor:
  bLength               9
  bDescriptorType      41
  nNbrPorts             2
  wHubCharacteristic 0x0008
    Ganged power switching
    Per-port overcurrent protection
  bPwrOn2PwrGood       15 * 2 milli seconds
  bHubContrCurrent      0 milli Ampere
  DeviceRemovable    0x00
  PortPwrCtrlMask    0x80 
 Hub Port Status:
   Port 1: 0000.0100 power
   Port 2: 0000.0100 power

Bus 002 Device 001: ID 0000:0000  
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               1.10
  bDeviceClass            9 Hub
  bDeviceSubClass         0 Unused
  bDeviceProtocol         0 
  bMaxPacketSize0         8
  idVendor           0x0000 
  idProduct          0x0000 
  bcdDevice            0.00
  iManufacturer           0 
  iProduct                2 USB OHCI Root Hub
  iSerial                 1 c017c000
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength           25
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0x40
      Self Powered
    MaxPower                0mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass         9 Hub
      bInterfaceSubClass      0 Unused
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0002  1x 2 bytes
        bInterval             255
Hub Descriptor:
  bLength               9
  bDescriptorType      41
  nNbrPorts             3
  wHubCharacteristic 0x0008
    Ganged power switching
    Per-port overcurrent protection
  bPwrOn2PwrGood       15 * 2 milli seconds
  bHubContrCurrent      0 milli Ampere
  DeviceRemovable    0x00
  PortPwrCtrlMask    0x80 
 Hub Port Status:
   Port 1: 0000.0100 power
   Port 2: 0000.0100 power
   Port 3: 0000.0100 power

Bus 001 Device 001: ID 0000:0000  
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               1.10
  bDeviceClass            9 Hub
  bDeviceSubClass         0 Unused
  bDeviceProtocol         0 
  bMaxPacketSize0         8
  idVendor           0x0000 
  idProduct          0x0000 
  bcdDevice            0.00
  iManufacturer           0 
  iProduct                2 USB OHCI Root Hub
  iSerial                 1 b8004000
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength           25
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0x40
      Self Powered
    MaxPower                0mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           1
      bInterfaceClass         9 Hub
      bInterfaceSubClass      0 Unused
      bInterfaceProtocol      0 
      iInterface              0 
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0002  1x 2 bytes
        bInterval             255
Hub Descriptor:
  bLength               9
  bDescriptorType      41
  nNbrPorts             2
  wHubCharacteristic 0x0010
    Ganged power switching
    No overcurrent protection
  bPwrOn2PwrGood        2 * 2 milli seconds
  bHubContrCurrent      0 milli Ampere
  DeviceRemovable    0x00
  PortPwrCtrlMask    0x80 
 Hub Port Status:
   Port 1: 0000.0100 power
   Port 2: 0000.0100 power

root@OpenWrt:/#</code></pre></div>											<p class="post-edited">(Last edited by <strong>jr</strong> on 25 Feb 2006, 22:08)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p21568">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">jr</div>
					<div class="post-datetime">
						25 Feb 2006, 22:09					</div>
				</div>
				<div class="post-content content">
					<p>However, with Cardbus network adapter it doesn&#039;t work.<br /></p><div class="codebox"><pre><code>root@OpenWrt:/# cd /lib/modules/2.4.32/
root@OpenWrt:/lib/modules/2.4.32# insmod pcmcia_core.o 
Linux Kernel Card Services 3.1.22
  options:  [pci] [cardbus]

root@OpenWrt:/lib/modules/2.4.32# insmod yenta_socket.o 
    pcibios_enable_device() enter pcibios_enable_resources
PCI: Enabling device 01:01.0 (0000 -&gt; 0002)
     yenta_allocate for bus=PCI CardBus #02 offset=1c res-&gt;start=0
     yenta_allocate for bus=PCI CardBus #02 offset=1c res-&gt;end=0
     yenta_allocate for bus=PCI CardBus #02 offset=24 res-&gt;start=40004000
     yenta_allocate for bus=PCI CardBus #02 offset=24 res-&gt;end=40007fff
     yenta_allocate for bus=PCI CardBus #02 offset=2c res-&gt;start=0
     yenta_allocate for bus=PCI CardBus #02 offset=2c res-&gt;end=0
     yenta_allocate for bus=PCI CardBus #02 offset=34 res-&gt;start=0
     yenta_allocate for bus=PCI CardBus #02 offset=34 res-&gt;end=0
    yenta_open socket-&gt;cb_irq = dev-&gt;irq=2
    yenta_open socket-&gt;socket-&gt;base=c015c000
Yenta IRQ list 06f8, PCI irq2
Socket status: 30000007
    yenta_config_init 04h=7:40h=0:42h=0:44h=3e1:80h=8405061:8ch=1002:90h=c0:91h=82:92h=64:93h=60:a2h=fe12:00h=ac56104c
    yenta_config_init 3ch=2:3dh=1:3eh=141
    yenta_config_init 805h=0
    yenta.c socket-&gt;io_irq=0

root@OpenWrt:/lib/modules/2.4.32# insmod ds.o 
     yenta_get_status=1880
    yenta_get_status=1880
    yenta.c socket-&gt;io_irq=0
    yenta.c socket-&gt;io_irq=0
    yenta.c socket-&gt;io_irq=0
    yenta_get_status=19c0
cs: cb_alloc(bus 2): vendor 0x10ec, device 0x8139
PCI: Failed to allocate resource 0(1000-0) for 02:00.0
4704 pcibios_update_resource HACK !!!!! wr[14]=40004000
    pcibios_enable_device() enter pcibios_enable_resources
PCI: Enabling device 02:00.0 (0000 -&gt; 0003)

root@OpenWrt:/lib/modules/2.4.32# insmod mii.o 
root@OpenWrt:/lib/modules/2.4.32# insmod 8139too.o 
8139too Fast Ethernet driver 0.9.26
    pcibios_enable_device() enter pcibios_enable_resources
PCI: Unable to reserve I/O region #1:fffff001@1000 for device 02:00.0
PCI: Unable to reserve I/O region #1:fffff001@1000 for device 02:00.0
Trying to free nonexistent resource &lt;00001000-00000000&gt;
Trying to free nonexistent resource &lt;40004000-400041ff&gt;
insmod: init_module: 8139too: No such device

root@OpenWrt:/lib/modules/2.4.32# cat /proc/pci 
PCI devices found:
  Bus  0, device   0, function  0:
    Class 0501: PCI device 14e4:0800 (rev 1).
      IRQ 3.
      Non-prefetchable 32 bit memory at 0x18000000 [0x18000fff].
      Non-prefetchable 32 bit memory at 0x1fc00000 [0x1fffffff].
      Non-prefetchable 32 bit memory at 0x1c000000 [0x1dffffff].
      Non-prefetchable 32 bit memory at 0x1a000000 [0x1bffffff].
  Bus  0, device   1, function  0:
    Class 0280: PCI device 14e4:4320 (rev 1).
      IRQ 4.
      Master Capable.  Latency=64.  
      Non-prefetchable 32 bit memory at 0x18001000 [0x18001fff].
  Bus  0, device   2, function  0:
    Class 0200: PCI device 14e4:4713 (rev 1).
      IRQ 5.
      Master Capable.  Latency=64.  
      Non-prefetchable 32 bit memory at 0x18002000 [0x18002fff].
  Bus  0, device   3, function  0:
    Class 0c03: PCI device 14e4:4717 (rev 1).
      IRQ 6.
      Non-prefetchable 32 bit memory at 0x18003000 [0x18003fff].
  Bus  0, device   4, function  0:
    Class 0c03: PCI device 14e4:4716 (rev 1).
      IRQ 2.
      Non-prefetchable 32 bit memory at 0x18004000 [0x18004fff].
  Bus  0, device   5, function  0:
    Class 0b30: PCI device 14e4:0816 (rev 1).
      IRQ 2.
      Non-prefetchable 32 bit memory at 0x18005000 [0x18005fff].
  Bus  0, device   6, function  0:
    Class 0500: PCI device 14e4:080f (rev 1).
      IRQ 3.
      Non-prefetchable 32 bit memory at 0x18006000 [0x18006fff].
      Non-prefetchable 32 bit memory at 0x0 [0x7ffffff].
      Non-prefetchable 32 bit memory at 0x10000000 [0x17ffffff].
      Non-prefetchable 32 bit memory at 0x80000000 [0x9fffffff].
  Bus  0, device   7, function  0:
    Class 0604: PCI device 14e4:0804 (rev 1).
      IRQ 2.
      Non-prefetchable 32 bit memory at 0x18007000 [0x18007fff].
      Non-prefetchable 32 bit memory at 0x8000000 [0xfffffff].
  Bus  1, device   0, function  0:
    Class 0600: PCI device 14e4:4712 (rev 1).
      IRQ 2.
      Master Capable.  Latency=64.  
      Non-prefetchable 32 bit memory at 0x40000000 [0x40001fff].
      Prefetchable 32 bit memory at 0x0 [0x7ffffff].
  Bus  1, device   1, function  0:
    Class 0607: PCI device 104c:ac56 (rev 0).
      IRQ 2.
      Master Capable.  Latency=168.  Min Gnt=1.Max Lat=5.
      Non-prefetchable 32 bit memory at 0x40002000 [0x40002fff].
  Bus  2, device   0, function  0:
    Class 0200: PCI device 10ec:8139 (rev 16).
      IRQ 2.
      Master Capable.  No bursts.  Min Gnt=32.Max Lat=64.
      Non-prefetchable 32 bit memory at 0x40004000 [0x400041ff].

root@OpenWrt:/lib/modules/2.4.32# cat /proc/interrupts 
           CPU0       
  2:          6            MIPS  PCI device 104c:ac56
  3:       1109            MIPS  serial
  4:       1935            MIPS  eth1
  5:        504            MIPS  eth0
  7:      21374            MIPS  timer

ERR:          0

root@OpenWrt:/lib/modules/2.4.32# lspci -vvv
00:00.0 FLASH memory: Broadcom Corporation Sentry5 Chipcommon I/O Controller (rev 01)
    Control: I/O- Mem- BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
    Status: Cap- 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR-
    Interrupt: pin ? routed to IRQ 3
    Region 0: Memory at 18000000 (32-bit, non-prefetchable) [disabled] [size=4K]
    Region 1: Memory at 1fc00000 (32-bit, non-prefetchable) [disabled] [size=4M]
    Region 2: Memory at 1c000000 (32-bit, non-prefetchable) [disabled] [size=32M]
    Region 3: Memory at 1a000000 (32-bit, non-prefetchable) [disabled] [size=32M]
    Expansion ROM at &lt;unassigned&gt; [disabled] [size=2K]

00:01.0 Network controller: Broadcom Corporation BCM4306 802.11b/g Wireless LAN Controller (rev 01)
    Control: I/O- Mem- BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
    Status: Cap- 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR-
    Latency: 64
    Interrupt: pin A routed to IRQ 4
    Region 0: Memory at 18001000 (32-bit, non-prefetchable) [disabled] [size=4K]
    Expansion ROM at &lt;unassigned&gt; [disabled] [size=2K]

00:02.0 Ethernet controller: Broadcom Corporation Sentry5 Ethernet Controller (rev 01)
    Control: I/O- Mem- BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
    Status: Cap- 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR-
    Latency: 64
    Interrupt: pin B routed to IRQ 5
    Region 0: Memory at 18002000 (32-bit, non-prefetchable) [disabled] [size=4K]
    Expansion ROM at &lt;unassigned&gt; [disabled] [size=2K]

00:03.0 USB Controller: Broadcom Corporation BCM47xx Sentry5 USB Device Controller (rev 01) (prog-if 00 [UHCI])
    Control: I/O- Mem- BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
    Status: Cap- 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR-
    Interrupt: pin C routed to IRQ 6
    Region 0: Memory at 18003000 (32-bit, non-prefetchable) [disabled] [size=4K]
    Expansion ROM at &lt;unassigned&gt; [disabled] [size=2K]

00:04.0 USB Controller: Broadcom Corporation BCM47xx Sentry5 USB Host Controller (rev 01) (prog-if 10 [OHCI])
    Control: I/O- Mem- BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
    Status: Cap- 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR-
    Interrupt: pin D routed to IRQ 2
    Region 0: Memory at 18004000 (32-bit, non-prefetchable) [disabled] [size=4K]
    Expansion ROM at &lt;unassigned&gt; [disabled] [size=2K]

00:05.0 MIPS: Broadcom Corporation BCM3302 Sentry5 MIPS32 CPU (rev 01)
    Control: I/O- Mem- BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
    Status: Cap- 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR-
    Interrupt: pin E routed to IRQ 2
    Region 0: Memory at 18005000 (32-bit, non-prefetchable) [disabled] [size=4K]
    Expansion ROM at &lt;unassigned&gt; [disabled] [size=2K]

00:06.0 RAM memory: Broadcom Corporation Sentry5 DDR/SDR RAM Controller (rev 01)
    Control: I/O- Mem- BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
    Status: Cap- 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR-
    Interrupt: pin ? routed to IRQ 3
    Region 0: Memory at 18006000 (32-bit, non-prefetchable) [disabled] [size=4K]
    Region 1: Memory at &lt;unassigned&gt; (32-bit, non-prefetchable) [disabled] [size=128M]
    Region 2: Memory at 10000000 (32-bit, non-prefetchable) [disabled] [size=128M]
    Region 3: Memory at 80000000 (32-bit, non-prefetchable) [disabled] [size=512M]
    Expansion ROM at &lt;unassigned&gt; [disabled] [size=2K]

00:07.0 PCI bridge: Broadcom Corporation Sentry5 PCI Bridge (rev 01) (prog-if 00 [Normal decode])
    Control: I/O- Mem- BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
    Status: Cap+ 66MHz+ UDF+ FastB2B+ ParErr+ DEVSEL=?? &gt;TAbort+ &lt;TAbort+ &lt;MAbort+ &gt;SERR+ &lt;PERR+
    Region 0: Memory at 18007000 (32-bit, non-prefetchable) [disabled] [size=4K]
    Region 1: Memory at 08000000 (32-bit, non-prefetchable) [disabled] [size=128M]
    Bus: primary=00, secondary=01, subordinate=05, sec-latency=64
    I/O behind bridge: 00000000-00000fff
    Memory behind bridge: 00000000-000fffff
    Prefetchable memory behind bridge: 00000000-000fffff
    Secondary status: 66MHz- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &lt;SERR- &lt;PERR-
    Expansion ROM at &lt;unassigned&gt; [disabled] [size=2K]
    BridgeCtl: Parity- SERR- NoISA- VGA- MAbort- &gt;Reset- FastB2B-

01:00.0 Host bridge: Broadcom Corporation BCM47xx V.92 56k modem (rev 01)
    Subsystem: Broadcom Corporation BCM47xx V.92 56k modem
    Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
    Status: Cap- 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort+ &gt;SERR- &lt;PERR-
    Latency: 64
    Interrupt: pin A routed to IRQ 2
    Region 0: Memory at 40000000 (32-bit, non-prefetchable) [size=8K]
    Region 1: Memory at &lt;unassigned&gt; (32-bit, prefetchable) [size=128M]

01:01.0 CardBus bridge: Texas Instruments PCI1510 PC card Cardbus Controller
    Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
    Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=medium &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR-
    Latency: 168, Cache Line Size 08
    Interrupt: pin A routed to IRQ 2
    Region 0: Memory at 40002000 (32-bit, non-prefetchable) [size=4K]
    Bus: primary=01, secondary=02, subordinate=05, sec-latency=176
    Memory window 0: 00000000-00000000 (prefetchable)
    Memory window 1: 40004000-40007000
    I/O window 0: 00000000-00000003
    I/O window 1: 00000000-00000003
    BridgeCtl: Parity+ SERR- ISA- VGA- MAbort- &gt;Reset- 16bInt- PostWrite+
    16-bit legacy interface ports at 0001

02:00.0 Ethernet controller: Realtek Semiconductor Co., Ltd. RTL-8139/8139C/8139C+ (rev 10)
    Subsystem: Billionton Systems Inc LNR-100 Family 10/100 Base-TX Ethernet
    Control: I/O+ Mem+ BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
    Status: Cap+ 66MHz- UDF- FastB2B+ ParErr- DEVSEL=medium &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR-
    Interrupt: pin A routed to IRQ 2
    Region 0: I/O ports at 1000
    Region 1: Memory at 40004000 (32-bit, non-prefetchable) [size=512]
    Capabilities: [50] Power Management version 2
        Flags: PMEClk- DSI- D1+ D2+ AuxCurrent=0mA PME(D0-,D1+,D2+,D3hot+,D3cold-)
        Status: D0 PME-Enable- DSel=0 DScale=0 PME-</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p21574">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">jr</div>
					<div class="post-datetime">
						26 Feb 2006, 00:49					</div>
				</div>
				<div class="post-content content">
					<p>Ok got communication with 3G card working. I can now send AT-commands, connect to operators network etc. You need to specify card model when loading USB serial port support. In my case proper syntax was &quot;insmod usbserial.o vendor=0x0af0 product=0x6300&quot;.</p><p>Linksys firmware has this weird init program that&#039;s basicly just shell script done in C. I need to go thru it and re-do as plain shell script to automate initializing card, connect to internet, activate openvpn etc.</p><p>Using patches I posted above and proper parameters to usbserial one can get WRT54G3G working with OpenWrt. Cardbus support is hack and broken (blame Linksys), but it does work for this 3G card I have and NEC USB2 adapter.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p21596">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">scoace</div>
					<div class="post-datetime">
						26 Feb 2006, 07:11					</div>
				</div>
				<div class="post-content content">
					<p>Hi Jr,</p><p>looks good. I´ll try it next week. Thanks for the CFE.BIN</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p21620">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">jr</div>
					<div class="post-datetime">
						26 Feb 2006, 21:16					</div>
				</div>
				<div class="post-content content">
					<p>Found out that there&#039;s special driver for 2.6 kernel and 3G cards Vodafone uses (Option N.V.). Linksys uses stock 2.4 usbserial driver. Perhaps this is one reason why it sometimes disconnects and hangs with Linksys firmware.</p><p><a href="http://lkml.org/lkml/2005/5/22/55">http://lkml.org/lkml/2005/5/22/55</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p21629">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">scoace</div>
					<div class="post-datetime">
						26 Feb 2006, 23:32					</div>
				</div>
				<div class="post-content content">
					<p>Hi jr,</p><p>no problems so far with Linux &quot;DEBIAN&quot; 2.6 x86 routers and UMTS. I would like to see openwrt to work with umts &quot;g3g&quot; cards on WRT54G3G. I´ve tried your patches but&nbsp; does not work. Maybe it is possible to send me the patched files ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p21740">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">scoace</div>
					<div class="post-datetime">
						28 Feb 2006, 13:09					</div>
				</div>
				<div class="post-content content">
					<p>Using the patches above I get </p><p>root@G3G:/lib/modules/2.4.32# insmod usbserial vendor=0xaf0 product=0x6000<br />usb.c: registered new driver serial<br />usbserial.c: USB Serial support registered for Generic<br />usbserial.c: Generic converter detected<br />usbserial.c: Generic converter now attached to ttyUSB0 (or usb/tts/0 for devfs)<br />usbserial.c: Generic converter detected<br />usbserial.c: Generic converter now attached to ttyUSB1 (or usb/tts/1 for devfs)<br />usbserial.c: Generic converter detected<br />usbserial.c: Generic converter now attached to ttyUSB2 (or usb/tts/2 for devfs)<br />usbserial.c: USB Serial Driver core v1.4</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p21741">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">mikinho</div>
					<div class="post-datetime">
						28 Feb 2006, 14:03					</div>
				</div>
				<div class="post-content content">
					<p>Hi Scoace... <br />I&#039;ve been reading the last posts..so do you have the 3G-card working??<br />I&#039;ll try these patches during the week too.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p21742">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">scoace</div>
					<div class="post-datetime">
						28 Feb 2006, 14:17					</div>
				</div>
				<div class="post-content content">
					<p>Hi Mikinho,</p><p>I´m not quite shure, because there is no &quot;UMTS&quot; Card in the option Board. I&#039;ll get one tomorrow then we will see. I will keep you up-to-date.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p21766">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">jr</div>
					<div class="post-datetime">
						28 Feb 2006, 20:42					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>mikinho wrote:</cite><blockquote><p>I&#039;ve been reading the last posts..so do you have the 3G-card working??<br />I&#039;ll try these patches during the week too.</p></blockquote></div><p>Yes it&#039;s working with those patches. You just need to configure pppd to dial using /dev/usb/tts/0. See <a href="http://devices.natetrue.com/mobileap/">http://devices.natetrue.com/mobileap/</a> for tips regarding PPP part.</p><p>Scoace, I replied to your private message via mail so check your email. In case it&#039;s not valid address you can find those patches in patch format from my homepage <a href="http://sukkamehulinko.romikselle.com/openwrt/">http://sukkamehulinko.romikselle.com/openwrt/</a> . Put patches 009, 010 and 011 to openwrt/target/linux/brcm-2.4/patches. You can ignore 012 patch.</p>											<p class="post-edited">(Last edited by <strong>jr</strong> on 18 Sep 2006, 09:05)</p>
									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=3276&amp;p=2.html">2</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>