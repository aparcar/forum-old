<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> How can I compile LUCI into binary?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 23 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p255310">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">daaulinh</div>
					<div class="post-datetime">
						23 Nov 2014, 18:49					</div>
				</div>
				<div class="post-content content">
					<p>I wrote a module based on LUCI and now I am finding a way to compile these files into binary.<br />As found on COMPEX&#039;s access points, their modified LUCI files are all binary files. So this is quite good for hiding some important modules, how can I do that? Any help will be appreciated and thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p255348">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Wandy</div>
					<div class="post-datetime">
						24 Nov 2014, 03:31					</div>
				</div>
				<div class="post-content content">
					<p>No, I don&#039;t think the module files are compiled into binary.&nbsp; I wrote some applications, but the process is much similar. You put your files in the directory maybe &quot;modules&quot;, and make some modification in makefile, perhaps some more changes some where else. After all the work, the files will be copied to different directories when you compile the files. But they are just your original files. These files and directories will composed of the file structure of AP. There are some binary file. </p><p>Well, the ap system will compile the .lua file under the controller into binary and store them in a file named luci-indexcache and luci-modulecache for modules I tell from the directory name. The binary files is for efficiency. They are compiled in run time. So This is what I know about it. I hope it can help. If something wrong, please let me know, discussion is always appreciated. </p><p>Best wishes&nbsp; <br />Wandy</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p255393">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">daaulinh</div>
					<div class="post-datetime">
						24 Nov 2014, 13:17					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Wandy wrote:</cite><blockquote><p>No, I don&#039;t think the module files are compiled into binary.&nbsp; I wrote some applications, but the process is much similar. You put your files in the directory maybe &quot;modules&quot;, and make some modification in makefile, perhaps some more changes some where else. After all the work, the files will be copied to different directories when you compile the files. But they are just your original files. These files and directories will composed of the file structure of AP. There are some binary file. </p><p>Well, the ap system will compile the .lua file under the controller into binary and store them in a file named luci-indexcache and luci-modulecache for modules I tell from the directory name. The binary files is for efficiency. They are compiled in run time. So This is what I know about it. I hope it can help. If something wrong, please let me know, discussion is always appreciated. </p><p>Best wishes&nbsp; <br />Wandy</p></blockquote></div><p>Thanks Wandy. As I found on my COMPEX&#039;s box, all of LUCI controller and CBI model files are in binary format (still come with extension of *.lua), and I cannot read the content as text file as usual.</p><p>As in <a href="http://lua-users.org/wiki/LuaTools">http://lua-users.org/wiki/LuaTools</a> , I can found a lot of tools for compile LUA file such as LUADEC51, but do not know how to use them in OpenWrt. I tried to decompile some files I took from my box but failed.</p><p>This is content from controller file named system.lua:<br /></p><div class="codebox"><pre><code>LuaQ                     A@  …€  †À@@€$     $@  @ $€  € $À  À $    $@ @ $€ € $À À  €       module    luci.controller.admin.system    package    seeall    index    action_clock_status    action_packages    action_flashops    action_passwd    action_reboot 
   fork_exec    ltn12_popen           7           J  @  Á€  b@ …À  Á@    A  œ€ Å  A Ü€  €€     Âƒ   J €@  Á€    b@€…@ Á€ œ€ Å  A Ü€ Á @€   J €@  Á€   b@€…@ Á€ œ  @     J €@  Á€  A  b@€…@ ÁÀ œ€ Å   Ü€ A @€   J €@  Á€   b@€…@ ÁÀ œ€ Å   Ü€ A @€€ ÀE  F A@ €    À€   J €@  Á€   b@€…@ ÁÀ œ€ Å   Ü€ A @€ €€ ÀE  F A€ €    @
€   J €@  Á€  Á b@€…@ Á  œ€ Å  A Ü€  @€   J  @  Á€  Á AÁ b@ …      Á@     œ  @  À€   J €@  Á€       b@€…      ÁÀ     œ€ Å  
 Ü€ A
 @€   J €@  Á€  
 b@€…      ÁÀ
 œ€ Å   Ü€ A @€€ ÀE  F A€ €    À    €   J €@  Á€  Á b@€…@ Á  œ€ Å  A Ü€  @€   J  @  Á€  Á AÁ b@ …@ Á 
 œ€ Ă €€      Â   J  @  Á€  Á A
 b@ …@ ÁÀ
 œ€ Ă €€      Â€ ÀE  F A  €    @€   J €@  Á€  A b@€…@ Á€ œ€ Å  Á Ü€  @€   J €@  Á€  A b@€…@ Á€ œ€ Å  Á Ü€  @€   J  @  Á€  A AA b@ …      Á€ œ  @     J €@  Á€  Á b@€…@ Á  œ€ Å  A Ü€  @€ € G      entry    admin    system    alias    _    System           index    cbi    admin_system/system        
   clock_status    call    action_clock_status    admin_system/admin    Administration               services    admin_system/services        Services           nixio    fs    access    /usr/sbin/snmpd    snmp    admin_system/snmp    SNMP        
   /bin/opkg        packages    action_packages        Software     
      ipkg    form    admin_system/ipkg    startup    admin_system/startup    Startup     -      crontab    admin_system/crontab    Scheduled Tasks     .      /etc/config/fstab    fstab    admin_system/fstab 
   Mount Points     2      mount    admin_system/fstab/mount    leaf    swap    admin_system/fstab/swap    /sys/class/leds    leds    admin_system/leds &lt;   &lt;abbr title=&quot;Light Emitting Diode&quot;&gt;LED&lt;/abbr&gt; Configuration     &lt;          flashops    action_flashops    Backup / Flash Firmware     F      backupfiles    admin_system/backupfiles    reboot    action_reboot    Reboot     Z                       9   F      
/      E@  F€À FÀÀ   \  €  W@A @€  ƒÀ€EÀ F Â @ À   \€€Z    €…@  †€B†ÀBÊ  AĂ FĂ †ÁĂ ÆÄ BÄ F‚Ä â@ ĐÀ †œ@ E@  F€À FÀÄ   \@ E@  F€À F@Å @  ÅÀ Æ ÂÁ Ü€ ‰À ‹\@  €           tonumber    luci    http 
   formvalue    set             os    date    *t    sys    call (   date -s &#039;%04d-%02d-%02d %02d:%02d:%02d&#039;    year    month    day    hour    min    sec    prepare_content    application/json    write_json    timestring    %c                     H   ¸      ó      A@  € E€  FÀÀ F Á @ \€ ‚   Ê   
  J€  bA€ € Á ¢A€ Ă E‚  FÂÀFÁÂ \‚ ZB    €A …B †‚BÅ‚  ÆÂÀÆÁĂ Ü‚ ÚB    €Á C œ‚€W€CÀ €€‚‡À € D@ €B    €Â Å‚  ÆÂÀÆÁC Ü‚ W€Á@ €ÚB    €Ă€€  €ƒ  Ă@AAƒ ƒ C€…ƒ  †Ă@†AÁĂ œƒ    €W€A€ €Z     €@    €ÆƒD   Ü €À ÉÀÔ€̀CĂIÁÔ ̀CĂ‰‚‚ € Z  @€Ă€„  EDE@€ €…D @€      À€
É …€EC
IÁ
 EC
‰
‚ € !D   üÛ€  €Åƒ  ÆĂÀÆÁ„ Üƒ Ú   €„E @€      À€    „€DCIÁ DC‰‚ € „  Ä@AAÄ „   €€FÄE \  €    À      €T€LDĂIÁT LDĂ‰‚E„  FÄÀFÁ \„ Z  €€†F œ   
À€    @     ”€ŒDC    IÁ    ” ŒDC    ‰    ‚€ Â  E …F
ÅF
A …    €@ 
ƒ€À€‚  EF F†ÆFFÇ À •Æ
\†  €   €F†G…Æ †H
œ†€ FH
€†@ €Â€ @ €aE  @úE…  F…È
FÅÈ
     ÊÅ ÉE‚ƒÉ…‚…ÉÅ‚ˆÉÅ ‰É‹É„‹ÉEŒÉ…„’ÉÅ“
 FJ@€† †€É†“
 FJ@ † †€É•\E€    €EE F…Æ
FÅÊ
 \E  € -      require    luci.model.ipkg    luci    http 
   formvalue    submit        display 
   installed    string    byte    letter    A            #       A       Z      query    install    url    util    imatch    remove    update    upgrade    nixio    fs    dir    /var/opkg-lists/    stat    mtime    os    time     €Q        template    render    admin_system/packages        no_lists 
   old_lists    stdout    table    concat    stderr    unlink    /tmp/luci-indexcache                     º   C              A@  € E   €  \€ …À  † A†@AÁ€ œ€ ÅÀ Æ ÂA Ü€ W€Â  €Â@  Â € Á A A ä     $B     d‚  ƒ Å‚ ÆÂĂÆÄ$Ă           ÜB Å‚ ÆÂĂÆBÄƒ Ü‚ Ú  @€ÅÂ  €Ü‚ ƒ ĂCEAC € Åƒ ÆĂÅÆÆÜƒ€ Ä DFA„  ¢C  ƒ‹C€ƒ ĂCĂFA C ƒ CGƒGĂG@€…ƒ †ĂC†HC€€.€Å‚ ÆÂĂÆBÄC Ü‚ Ú  À€Å‚ ÆÂĂÆBÄƒ Ü‚ Ú   +€€ …@*€ƒ ĂHIAC     C ƒ ĂEƒIC€ À&#039;€Å‚ ÆÂĂÆBÄĂ     Ü‚ ÚB  €€Å‚ ÆÂĂÆBÄ
 Ü‚ Ú  @€ÅB
 ƒ ĂCCDA
 ƒ C    €ƒ
 Ü‚ €Ê€€ €ƒ€   À€ƒ ĂHIAĂ
  À Üƒ€ ‰Ă–À€Üƒ€ ‰Ăƒ–ÅĂ  ÆÁÆĂË  Üƒ ÆƒË‰Ă—Åƒ ÆĂĂÆCÄ Üƒ Ó€Ó€‰Ă˜C€@€Ă  ACL@ C ƒ ĂHIAƒ Ă  ‰Ă€™‰ƒ ‰ƒÍC€€€ÀÍ €ƒ ĂCCDA ƒ  N€ €C C    €ƒ Eƒ FĂÈFÉC     ÊĂ  „ ODOA„ „ É„„ ODOA „ É„Ÿ  …€ €„ D    € É„ \C€EĂ  À   ¢C ƒ¢\C À    €Ú   @€Å‚ ÆÂĂÆBÄC Ü‚ Ú  €€Å‚ ÆÂÈÆÉC     JĂ  …ƒ †O†COÁƒ œƒ Iƒƒ…ƒ †O†COÁĂ œƒ IƒƒŸIƒĐ ÜB€ÅÂ  ÜB À€Å‚ ÆÂÈÆÉƒ Jƒ  IĂ€™Iƒ ÜB€ € I      require        luci.sys    luci.fs    nixio    fs    access    /lib/upgrade/platform.sh    os    execute /   grep &#039;&quot;rootfs_data&quot;&#039; /proc/mtd &gt;/dev/null 2&gt;&amp;1            tar -xzC/ &gt;/dev/null 2&gt;&amp;1 )   sysupgrade --create-backup - 2&gt;/dev/null    /tmp/firmware.img    luci    http    setfilehandler 
   formvalue    backup    ltn12_popen    header    Content-Disposition +   attachment; filename=&quot;backup-%s-%s.tar.gz&quot;    sys        hostname    date        %Y-%m-%d    prepare_content    application/x-targz    ltn12    pump    all    write    restore    archive        template    render    admin_system/applyreboot    reboot    image    step        tonumber           admin_system/upgrade        checksum    storage    size    stat    keep    unlink    admin_system/flashops    reset_avail    upgrade_avail    image_invalid           1        -n    title    i18n 
   translate    Flashing...    msg ç   The system is flashing now.&lt;br /&gt; DO NOT POWER OFF THE DEVICE!&lt;br /&gt; Wait a few minutes until you try to reconnect. It might be necessary to renew the address of your computer to reach the device again, depending on your settings.    addr    192.168.1.1 
   fork_exec 9   killall dropbear uhttpd; sleep 1; /sbin/sysupgrade %s %q    reset    Erasing... \   The system is erasing the configuration partition now and will reboot itself when finished. &gt;   killall -9 dropbear uhttpd; sleep 1; mtd -r erase rootfs_data        Å   Í        @  €@ AÀ    Ä   ĐÀ€‚UÀ€ € W  €  €@   €    €               os    execute    . /lib/functions.sh;     include /lib/upgrade;  #   platform_check_image %q &gt;/dev/null                     Ï   Ñ           @@ €@ D   P@€€  A @ €€   €       luci    sys    exec 
   md5sum %q    match 
   ^([^%s]+)                     Ó   ç      &gt;      E@  F€À FÀÀ   \€ Z    €E@ F€Á   \  €KÁAÁ \AW@B@ €€B@€EÂ € Á \‚€  €@€a@   ü€€E@  F€À FÀÀ @ \€ Z   À€E@ F€Á @ \  €KÁAÁ \AÚ  À€  @€KÂAÁÂ \‚€ZB   €EÂ €€\‚  Ä@ €a@   û   €               nixio    fs    access 
   /proc/mtd    io    lines    match -   ^([^%s]+)%s+([^%s]+)%s+([^%s]+)%s+&quot;([^%s]+)&quot;    linux        firmware        tonumber           /proc/partitions (   ^%s*(%d+)%s+(%d+)%s+([^%s]+)%s+([^%s]+)    [0-9]                            ́   ú    !   Ä   Ú@  @€   @€Æ @ @À€€Å€  ÆÀÀ€ A Ü€€È   @€Å€  Æ@Á A Ü€€È   Z   À €Ä   Ë€Á@€ Ü@€   € €Ä   ËÀÁÜ@  €       name    image    io    open    w    popen    write    close                                 E  S     #      @@ €@ AÀ  € E   F@À F€À   \€ ƒ  @  @ €Z   À€@   €Å   Æ@ÁÆ€ÁÆÀÁ @  Ü€€€ €  €@ Å   Æ€ÂÆÀÂ JA  I€†Ü@€ €       luci    http 
   formvalue    pwd1    pwd2    sys    user 
   setpasswd    root     
          template    render    admin_system/passwd    stat                     U  [           @@ €@ AÀ  € E   F Á F@Á € Ê@  É €\@€   À €E   FÀÁ FÀÀ \@€  €       luci    http 
   formvalue    reboot        template    render    admin_system/reboot    sys                     ]  s    3   E   F@À \€€ @ @ € € €
€€À  
€…   †À@Á  œ@ …   †@AÁ€ Á œ€€   À€Å   Æ Â  E  FAÂÜ@€Å   Æ Â  E  FÂÜ@€Å   Æ Â  E  FÁÂÜ@€Ë CÜ€ À€†@ €Ë€CÜ@ Å   ÆÀĂ AA €  Ü@  €       nixio    fork            chdir    /    open 
   /dev/null    w+    dup    stderr    stdout    stdin    fileno           close    exec    /bin/sh    -c                     u  ‘    %   E   F@À \À€ Å   Æ€ÀÜ€€ À€@€AA  d    €   €   ^ #  @€ÀÀÀ€  AA@ …  †AA€Á A AA   ÁAA A À  A  € 
      nixio    pipe    fork            close    dup    stdout    exec    /bin/sh    -c        }      &quot;       @ @  €€E€  FÀÀ „ € Á  \À€Ä  Ú@  @€Z   À €@A@ €Â € È      €Ô   À ƒ@ €  À€Ä  Ú    €Ä   ËÀÁÜ@ Ă €̃   €       read           nixio    waitpid    nohang    exited            close                                         </code></pre></div><p>Anymore idea?</p>											<p class="post-edited">(Last edited by <strong>daaulinh</strong> on 24 Nov 2014, 13:18)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p255629">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">HubertB</div>
					<div class="post-datetime">
						26 Nov 2014, 16:43					</div>
				</div>
				<div class="post-content content">
					<p>Fire up &quot;make menuconfig&quot; and have a look at &quot;LuCI ---&gt; Libraries ---&gt; Build Target&quot;. In there, you can select that everything will be precompiled.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>