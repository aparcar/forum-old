<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> boot problem after extroot</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 13 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p233585">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">a_user</div>
					<div class="post-datetime">
						15 May 2014, 20:11					</div>
				</div>
				<div class="post-content content">
					<p>Hello <br />System : ATTITUDE ADJUSTMENT (12.09, r36088)<br />I used an USB&nbsp; device to extent rootfs via /overlay in fstab. Everything is fine except the fact that&nbsp; the system does not come up after reboot. When I remove the USB- storage no boot problems occur.<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# nano /etc/config/fstab

config global automount
        option from_fstab 1
        option anon_mount 1

config global autoswap
        option from_fstab 1
        option anon_swap 0

config mount
      # option target   /mnt/sda1
        option target   /overlay
      # option target   /mnt
        option device   /dev/sda1
        option fstype   ext4
        option options  rw,sync
        option enabled  1
        option enabled_fsck 0
       #option is_rootfs    1

config swap
        option device   /dev/sda2
        option enabled  0</code></pre></div><div class="codebox"><pre><code>root@OpenWrt:~# df
Filesystem           1K-blocks      Used Available Use% Mounted on
rootfs                    5184      5004       180  97% /
/dev/root                 2048      2048         0 100% /rom
tmpfs                    63340       252     63088   0% /tmp
tmpfs                      512         0       512   0% /dev
/dev/mtdblock3        15579732    361024  14437040   2% /overlay
overlayfs:/overlay        5184      5004       180  97% /
/dev/sda1             15579732    361024  14437040   2% /overlay</code></pre></div><p>root@OpenWrt:~# lsusb<br />Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub<br />Bus 001 Device 002: ID 05e3:0608 Genesys Logic, Inc. USB-2.0 4-Port HUB<br />Bus 001 Device 004: ID 0781:556b SanDisk Corp. </p><p>// Here is the systemlog from the boot process:<br /></p><div class="codebox"><pre><code>May 14 21:55:18 OpenWrt daemon.info dnsmasq[1794]: using local addresses only for domain lan
May 14 21:55:18 OpenWrt daemon.info dnsmasq[1794]: read /etc/hosts - 1 addresses
May 14 21:55:20 OpenWrt user.info sysinit: setting up led USB1
May 14 21:55:20 OpenWrt user.info sysinit: setting up led USB2
May 14 21:55:20 OpenWrt user.info sysinit: setting up led WLAN2G</code></pre></div><br /><p>Has anyone an idea what i have done wrong?</p><p>Thank you.<br />a_user</p>											<p class="post-edited">(Last edited by <strong>a_user</strong> on 15 May 2014, 23:34)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p233596">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">a_user</div>
					<div class="post-datetime">
						15 May 2014, 23:01					</div>
				</div>
				<div class="post-content content">
					<p>I am not an expert, but the USB drive appears two times at df:<br /></p><div class="codebox"><pre><code>/dev/mtdblock3        15579732    361024  14437040   2% /overlay
/dev/sda1             15579732    361024  14437040   2% /overlay</code></pre></div><p>is that correct?<br />thanks<br />a_user</p>											<p class="post-edited">(Last edited by <strong>a_user</strong> on 15 May 2014, 23:04)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>