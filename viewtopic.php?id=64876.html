<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> 1900ACS AC radio not working</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 29 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p324156">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">jeffy</div>
					<div class="post-datetime">
						16 May 2016, 20:05					</div>
				</div>
				<div class="post-content content">
					<p>Hi OpenWrt,<br />Any suggestions on investigating the problem below? Did I miss a known issue or is my router broken?</p><p>Thanks!</p><p>The symptoms are illustrated here:</p><p><span class="postimg"><img src="http://i.imgur.com/NC6ikHi.png" alt="http://i.imgur.com/NC6ikHi.png" /></span></p><p>Version CHAOS CALMER (15.05.1, r48532)</p><br /><p>The config is nearly the default, AFAIK.<br /></p><div class="codebox"><pre><code># cat wireless 

config wifi-device &#039;radio0&#039;
    option type &#039;mac80211&#039;
    option channel &#039;36&#039;
    option hwmode &#039;11a&#039;
    option path &#039;soc/soc:pcie-controller/pci0000:00/0000:00:01.0/0000:01:00.0&#039;
    option htmode &#039;VHT80&#039;
    option txpower &#039;20&#039;
    option country &#039;00&#039;

config wifi-iface
    option device &#039;radio0&#039;
    option network &#039;lan&#039;
    option mode &#039;ap&#039;
    option ssid &#039;XXX AC&#039;
    option encryption &#039;psk2&#039;
    option key &#039;YYY&#039;</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324159">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">nenekofi</div>
					<div class="post-datetime">
						16 May 2016, 20:13					</div>
				</div>
				<div class="post-content content">
					<p>Post your /etc/config/network as well.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324161">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">jeffy</div>
					<div class="post-datetime">
						16 May 2016, 20:16					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for much for your interest in helping!</p><div class="codebox"><pre><code># cat network 

config interface &#039;loopback&#039;
    option ifname &#039;lo&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;127.0.0.1&#039;
    option netmask &#039;255.0.0.0&#039;

config globals &#039;globals&#039;
    option ula_prefix &#039;fdc5:XXXX:feb7::/48&#039;

config interface &#039;lan&#039;
    option ifname &#039;eth1&#039;
    option force_link &#039;1&#039;
    option type &#039;bridge&#039;
    option proto &#039;static&#039;
    option netmask &#039;255.255.255.0&#039;
    option ip6assign &#039;60&#039;
    option ipaddr &#039;192.168.0.1&#039;

config interface &#039;wan&#039;
    option ifname &#039;eth0&#039;
    option proto &#039;dhcp&#039;
    option hostname &#039;XXX-apartment-2015&#039;

config interface &#039;wan6&#039;
    option ifname &#039;eth0&#039;
    option proto &#039;dhcpv6&#039;</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324162">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">jeffy</div>
					<div class="post-datetime">
						16 May 2016, 20:19					</div>
				</div>
				<div class="post-content content">
					<p>I probably shouldn&#039;t have taken out part of /etc/config/wireless. This is the config for radio 1 at the end of wireless. It&#039;s working fine.</p><div class="codebox"><pre><code>config wifi-device &#039;radio1&#039;
    option type &#039;mac80211&#039;
    option channel &#039;11&#039;
    option hwmode &#039;11g&#039;
    option path &#039;soc/soc:pcie-controller/pci0000:00/0000:00:02.0/0000:02:00.0&#039;
    option htmode &#039;HT20&#039;
    option txpower &#039;20&#039;
    option country &#039;00&#039;

config wifi-iface
    option device &#039;radio1&#039;
    option network &#039;lan&#039;
    option mode &#039;ap&#039;
    option ssid &#039;XXX&#039;
    option encryption &#039;psk2&#039;
    option key &#039;XXX&#039;</code></pre></div>											<p class="post-edited">(Last edited by <strong>jeffy</strong> on 16 May 2016, 20:19)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324174">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">nenekofi</div>
					<div class="post-datetime">
						16 May 2016, 21:21					</div>
				</div>
				<div class="post-content content">
					<p>Your network and wifi configuration looks ok. Check the wireless key and selected auth/encryption mode to see if it matches what your nexthop router expects. Check your firewall to ensure you have allowed dhcp request/renewal. It should be something like this:</p><div class="codebox"><pre><code>        uci -q add firewall rule
        uci -q set firewall.@rule[-1]=rule
        uci -q set firewall.@rule[-1].name=&#039;Allow-DHCP-wan&#039;
        uci -q set firewall.@rule[-1].src=&#039;wan&#039;
        uci -q set firewall.@rule[-1].proto=&#039;udp&#039;
        uci -q set firewall.@rule[-1].dest_port=&#039;67-68&#039;
        uci -q set firewall.@rule[-1].target=&#039;ACCEPT&#039;
        uci -q set firewall.@rule[-1].family=&#039;ipv4&#039;
     
        uci -q add firewall rule
        uci -q set firewall.@rule[-1]=rule
        uci -q set firewall.@rule[-1].name=&#039;Allow-DHCP-Lan&#039;
        uci -q set firewall.@rule[-1].src=lan
        uci -q set firewall.@rule[-1].src_port=&#039;67-68&#039;
        uci -q set firewall.@rule[-1].dest_port=&#039;67-68&#039;
        uci -q set firewall.@rule[-1].proto=udp
        uci -q set firewall.@rule[-1].target=ACCEPT


        uci -q add firewall rule
        uci -q set firewall.@rule[-1]=rule
        uci -q set firewall.@rule[-1].name=&#039;Allow-DHCPv6&#039;
        uci -q set firewall.@rule[-1].src=&#039;wan&#039;
        uci -q set firewall.@rule[-1].proto=&#039;udp&#039;
        uci -q set firewall.@rule[-1].src_ip=&#039;fc00::/6&#039;
        uci -q set firewall.@rule[-1].dest_ip=&#039;fc00::/6&#039;
        uci -q set firewall.@rule[-1].dest_port=&#039;546&#039;
        uci -q set firewall.@rule[-1].family=&#039;ipv6&#039;
        uci -q set firewall.@rule[-1].target=&#039;ACCEPT&#039;</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324177">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">nenekofi</div>
					<div class="post-datetime">
						16 May 2016, 21:31					</div>
				</div>
				<div class="post-content content">
					<p>Hold up, I take my previous comment back. Are you trying to connect to an upstream router, i.e, are you connecting to another router, or you have an ethernet cable connected to your openwrt router from which you plan to get to the internet. If the answer is the former, then your wireless configuration should be sta, like this:</p><div class="codebox"><pre><code>option mode &#039;sta&#039;</code></pre></div><p>Currently, your configuration looks like you are setup as AP only</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324183">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">jeffy</div>
					<div class="post-datetime">
						16 May 2016, 21:44					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nenekofi wrote:</cite><blockquote><p>Hold up, I take my previous comment back. Are you trying to connect to an upstream router, i.e, are you connecting to another router, or you have an ethernet cable connected to your openwrt router from which you plan to get to the internet. If the answer is the former, then your wireless configuration should be sta, like this:</p><div class="codebox"><pre><code>option mode &#039;sta&#039;</code></pre></div><p>Currently, your configuration looks like you are setup as AP only</p></blockquote></div><p>I don&#039;t have another router (or, I want to create a LAN).</p><p>I&#039;ll try your suggestion when I get back to my apartment.</p><p>I&#039;m not terribly hopeful though, because radio 1 is setup as &quot;ap&quot;, and clients gets a LAN IP and can connect to the internet... :-/</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324227">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">jeffy</div>
					<div class="post-datetime">
						17 May 2016, 05:22					</div>
				</div>
				<div class="post-content content">
					<p>Unfortunately, setting to mode &quot;sta&quot; didn&#039;t have the desired effect. It still says:</p><div class="codebox"><pre><code>Tx-Power: 0 dBm
Signal: 0 dBm
Noise: 0 dBm</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324233">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">davidc502</div>
					<div class="post-datetime">
						17 May 2016, 05:46					</div>
				</div>
				<div class="post-content content">
					<p>In the /etc/config/wireless configuration add &quot;platform&quot; to the path and restart.</p><p>option path &#039;platform/soc/soc:pcie-controller/pci0000:00/0000:00:02.0/0000:02:00.0&#039;</p><p>See if that doesn&#039;t work.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324234">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">jeffy</div>
					<div class="post-datetime">
						17 May 2016, 05:49					</div>
				</div>
				<div class="post-content content">
					<p>Is it supposed to show all zeros when there are no clients connected to the radio?</p><p>If so, I think the mystery is solved!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324235">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">davidc502</div>
					<div class="post-datetime">
						17 May 2016, 05:57					</div>
				</div>
				<div class="post-content content">
					<p>Can clients connect?</p><p>Also, I noticed the country code is 00. Set it for optimal performance for where you live.</p><p>Change it under each wifi &gt; Advanced settings.</p>											<p class="post-edited">(Last edited by <strong>davidc502</strong> on 17 May 2016, 06:04)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324256">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">jeffy</div>
					<div class="post-datetime">
						17 May 2016, 11:01					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>davidc502 wrote:</cite><blockquote><p>Can clients connect?</p><p>Also, I noticed the country code is 00. Set it for optimal performance for where you live.</p><p>Change it under each wifi &gt; Advanced settings.</p></blockquote></div><p>Hi David,<br />I changed my country code as you suggested. I look forward to seeing how it works!</p><p>After restarting the router, clients can connect to both radios. However, when I came back to my apartment after a few hours, I couldn&#039;t connect to either radio. Unfortunately, the logs were cleared when I restarted, so I didn&#039;t catch them.</p><p>This sounds less like a hardware problem, and more like a software issue a software issue, which gives me relief. I think there are some open issues on the 1900AC(S) driver being discussed in the forum, so I&#039;ll read them over and collect any info that might be useful.</p><p>Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324852">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">jeffy</div>
					<div class="post-datetime">
						19 May 2016, 23:27					</div>
				</div>
				<div class="post-content content">
					<p>It&#039;s working better than ever for me. Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p324858">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">davidc502</div>
					<div class="post-datetime">
						20 May 2016, 00:29					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>jeffy wrote:</cite><blockquote><p>It&#039;s working better than ever for me. Thanks!</p></blockquote></div><p>Great! Glad it&#039;s working now!</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>