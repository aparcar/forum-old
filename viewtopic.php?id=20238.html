<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> OpenWRT (kamikaze 8.09) on Linksys WAG54G v2</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 9 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p87580">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">ashketchum</div>
					<div class="post-datetime">
						8 May 2009, 08:37					</div>
				</div>
				<div class="post-content content">
					<p>Hi everyone. I managed to get OpenWRT (kamikaze 8.09) to work on a Linksys WAG54G v2, after making the changes to the cpmac.c file as mentioned in this page <a href="https://dev.openwrt.org/ticket/3923">https://dev.openwrt.org/ticket/3923</a>.</p><p>Now, I would like to know how I can get PPPoE to work. ADSL seems to be working fine. Just need some instructions on how to get PPPoE to work.</p><p>I would also like to know how to fix the LEDs since they are not working correctly. After the firmware boots, the power LED is supposed to be steady green, but instead it blinks red and green. The ethernet LEDs are working fine and so is the DSL LED. But the Wifi and &quot;Internet&quot; LEDs aren&#039;t working.</p><p>Someone, please provide me instructions on how to get PPPoE to work and also how to fix the LEDs.</p><p>Thanks in advance.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p87581">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">ashketchum</div>
					<div class="post-datetime">
						8 May 2009, 09:08					</div>
				</div>
				<div class="post-content content">
					<p>Wow, just after posting this I managed to get PPPoE working after checking settings listed on many different pages on this site. My final configuration that worked is the following.</p><div class="codebox"><pre><code>config &#039;atm-bridge&#039;
        option &#039;unit&#039;   &#039;0&#039;
        option &#039;encaps&#039; &#039;llc&#039;
        option &#039;vpi&#039;    &#039;0&#039;
        option &#039;vci&#039;    &#039;32&#039;
        option &#039;payload&#039; &#039;bridged&#039;

config &#039;interface&#039; &#039;wan&#039;
        option &#039;ifname&#039;         &#039;nas0&#039;
        option &#039;peerdns&#039;        &#039;1&#039;
        option &#039;defaultroute&#039;   &#039;1&#039;
        option &#039;proto&#039;          &#039;pppoe&#039;
        option &#039;username&#039;       &#039;xxxxxx&#039;
        option &#039;password&#039;       &#039;xxxxxx&#039;
        option &#039;keepalive&#039;      &#039;10&#039;</code></pre></div><p>Now I just need to know how to fix the LEDs and also how to get WPA2 to work. When I select encryption as &quot;psk2&quot; in /etc/config/wireless, it just appears unsecured. WEP is working fine though.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p87582">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">ashketchum</div>
					<div class="post-datetime">
						8 May 2009, 10:07					</div>
				</div>
				<div class="post-content content">
					<p>I just successfully installed X-WRT! And I also just found out that the acx driver doesn&#039;t support WPA/WPA2 PSK. <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>Anyway, I would now just like to know how to fix the LEDs. Can anyone help me with that? Thanks.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p89008">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">SiNiESTrO</div>
					<div class="post-datetime">
						31 May 2009, 00:06					</div>
				</div>
				<div class="post-content content">
					<p>Hello! Have you configured the switch succesfully? what changes did you make to get a fully working openwrt over WAG54Gv2?<br />I have built my own openwrt image from an upper 16049 revision of svn without success. </p><p>Any recommendation?</p><p>Thank you.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p89312">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">ashketchum</div>
					<div class="post-datetime">
						4 Jun 2009, 21:19					</div>
				</div>
				<div class="post-content content">
					<p>Its not &quot;fully&quot; working. I later found out that the wireless wasn&#039;t working properly. I could see it in the list of available networks and could even connect to it if i leave encryption disabled but after that nothing. Couldn&#039;t ping the router or do anything else.</p><p>To get the switch to work, I had to make changes to the cpmac.c file as mentioned here --&gt; <a href="https://dev.openwrt.org/ticket/3923">https://dev.openwrt.org/ticket/3923</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p89326">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">SiNiESTrO</div>
					<div class="post-datetime">
						4 Jun 2009, 23:40					</div>
				</div>
				<div class="post-content content">
					<p>What release did you build with those changes?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p95996">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">plutonium</div>
					<div class="post-datetime">
						17 Oct 2009, 03:21					</div>
				</div>
				<div class="post-content content">
					<p>Are you guys aware of this open project (pluto)?</p><p><a href="http://sourceforge.net/projects/project-pluto/">http://sourceforge.net/projects/project-pluto/</a></p><p>It works really well for me for 2 years+</p><p>If you want open-wrt, there may be some good stuff in it for you.&nbsp; Beware the POTS (modem) config in pluto though- it may not be right as it was specific to the Australian PSTN as that is where it was mainly tested.</p><p>I reckon there should be a link on the OpenWRT wiki WAG54g page&nbsp; to that to that project.</p>											<p class="post-edited">(Last edited by <strong>plutonium</strong> on 17 Oct 2009, 03:23)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p97974">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">Jerome49</div>
					<div class="post-datetime">
						27 Nov 2009, 10:41					</div>
				</div>
				<div class="post-content content">
					<p>Hello everybody, </p><p>First i want to apology for my poor english.</p><p>I compiled the last version (kamikaze 8.09), but i am not sure of waht setting i need to use, to be able to flash my WAG54g v2. <br />I use the AR7 setting and i tried to be very close of all recommandation, but my WAG54g v2 always said &quot;Wrong pattern&quot; when i tried to send it with the tftp method.</p><p>ashketchum how did you managed to get OpenWRT to work on a Linksys WAG54G v2 ? <br />When you successfully compiled your OpenWRT which .bin file did you use ? There are so many, but never the right name device <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>Thanks a lot for all your idea and your help</p><p>Regards,</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p98009">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">Jerome49</div>
					<div class="post-datetime">
						28 Nov 2009, 13:47					</div>
				</div>
				<div class="post-content content">
					<p>Hello everybody, </p><p>I successfully compiled the last trunk of (kamikaze 8.09)<br />I make changes to the cpmac.c file as mentioned here --&gt; <a href="https://dev.openwrt.org/ticket/3923">https://dev.openwrt.org/ticket/3923</a><br />I flash my WAG54G v2 with tftp method.</p><p>But now my wag54G is doing circle, He is starting again and again every minutes. I saw every minutes 4 ping successfull</p><p>I don&#039;t know wich setting i need to check in the make menuconfig section. <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p><p>Does anybody can help me ?</p><p>Best Regards</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p101099">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">3lackhawk</div>
					<div class="post-datetime">
						21 Jan 2010, 16:23					</div>
				</div>
				<div class="post-content content">
					<p>The code pattern for WAG54G V2 is WA22 that&#039;s why you have to use openwrt-WA22-squashfs-code.bin or openwrt-WA22-jffs2-64k-code.bin file.</p><p>I think first try flash from here <a href="http://downloads.openwrt.org/kamikaze/8.09.1/ar7/">http://downloads.openwrt.org/kamikaze/8.09.1/ar7/</a></p><p>I played with a WAG54G V2 too but no succes with any other firmware than the original<br />My problem is the switch.It isn&#039;t working with openwrt maybe a bug or something missing etc. driver patch etc...I can&#039;t find the solution....</p><p>Could you write step by step how to make changes to the cpmac.c file ?</p><p>Thanks</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p101960">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">Gabrys</div>
					<div class="post-datetime">
						2 Feb 2010, 16:12					</div>
				</div>
				<div class="post-content content">
					<p>Hi guys,</p><p>I have an European (UK) version of WAG54G V2, when uploading WA22 firmware it says: &quot;Error code 4: Wrong Code Pattern&quot;, but when uploading WA21 it uploads successfully. </p><p>The problem is when firmware upload is done, it keeps blinking green (for about 30 seconds), then blinks once red, and then starts again blinking green (for about 30 seconds) and then blinks once red, and so on.</p><p>With other WA21 firmwares it blinks green for those 30 seconds, and then blinks insanely green-red.</p><p>With openwrt-WA22-jffs2-64k-code.bin from <a href="http://downloads.openwrt.org/kamikaze/8.09.1/ar7/">http://downloads.openwrt.org/kamikaze/8.09.1/ar7/</a> it actually works the best: the firmware loads, then blinks for 30 seconds green, then once red, seems to reboot, and blinks infinitely green. After that I&#039;m able to ping it! But nmap 192.168.1.1 shows the host is down. Wifi </p><p>I tried to build my own image from SVN trunk, I used the resulting WA21 *.bin files, but after uploading them, router didn&#039;t even respond to pings. It&#039;s doing the blinking-green-for-30-secs-once-red-and-again loop.</p><p>Also, I&#039;m not sure what&#039;s the real status of this bug: <a href="https://dev.openwrt.org/ticket/3923">https://dev.openwrt.org/ticket/3923</a> . At that page it says it&#039;s closed, so do I have to patch the cpmac.c when using trunk or not?</p><p>I&#039;m always flashing the&nbsp; using tftp method after reboot. (When using &quot;upload firmware&quot; from web interface it just says &quot;Upload failed&quot; after about 5 seconds of upload).</p><p>I really want to get this router working with shell access. I don&#039;t even care the ADSL feature, I just want a nice ethernet-wifi bridge with cli access (and stuff like iptables).</p><p>I would be really happy if someone shares ANY working openwrt firmware for that device ;-).</p>											<p class="post-edited">(Last edited by <strong>Gabrys</strong> on 2 Feb 2010, 16:19)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p101996">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">SiNiESTrO</div>
					<div class="post-datetime">
						2 Feb 2010, 22:22					</div>
				</div>
				<div class="post-content content">
					<p>Hello guy,</p><p>I think I have a WAG54Gv2-EU as yours. The unique code pattern that works for me is WA21. Builds after 8.09.1 works better and they have some patches applied related to ticket #3124. I had to rebuild it to add &quot;cpmac.dumb_switch=1&quot; option to the kernel command line to get the switch working.</p><p>However my adsl modem can&#039;t sync in routed mode. I&#039;ve rebuilt older &quot;working&quot; versions without success. I don&#039;t know if is a hardware problem and I haven&#039;t tried anymore.</p><p>You can collaborate with the wiki page for this device if you consider. All will thank you.</p><p><a href="http://nuwiki.openwrt.org/inbox/wag54g">http://nuwiki.openwrt.org/inbox/wag54g</a></p>											<p class="post-edited">(Last edited by <strong>SiNiESTrO</strong> on 2 Feb 2010, 22:44)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p103876">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">nicefile</div>
					<div class="post-datetime">
						28 Feb 2010, 00:59					</div>
				</div>
				<div class="post-content content">
					<p>I have just tested my own build of 8.09.2 kamikaze with patched cpmac.Still cant get to work with acx100 driver.<br />shows me &quot;auth algorithm mismatch: our:1 peer:0&quot; in wep and wlan0: tx error 0x20, buf 06! (and so on) with no wep<br />can anyone could share his build ?<br />BTW. mine -EU version is WA21 code pattern.</p>											<p class="post-edited">(Last edited by <strong>nicefile</strong> on 28 Feb 2010, 01:05)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p105469">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">ashketchum</div>
					<div class="post-datetime">
						29 Mar 2010, 01:34					</div>
				</div>
				<div class="post-content content">
					<p>@Gabrys</p><p>In my case when it blinked red and green it meant that it had finished booting. After that I was able to log in to the router with SSH.</p><p>I managed to get wired lan and pppoe working and so was able to browse the web with it but since wireless lan was not working, I couldn&#039;t continue to use it.</p><p>Anyway, my WAG54G v2&#039;s switch stopped working a few months ago and I bought a WAG54G2 to replace it. The latset official firmware still has some bugs. For example UPnP doesn&#039;t work properly. Ports cannot be forwarded automatically using UPnP. So I can&#039;t recommend it. <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></p><p>@nicefile</p><p>I made the modifications to cpmac.c file ( as mentioned on the second post here - <a href="https://dev.openwrt.org/ticket/3923">https://dev.openwrt.org/ticket/3923</a> ) to get the ethernet to work. Didn&#039;t manage to get wireless lan to work. Mine was the EU version also. And I also had the code pattern problem initially. I figured out the correct pattern by trying to upload all of the precompiled firmwares one by one.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>