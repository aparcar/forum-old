<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> WNDR3700 and USB</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 5 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p140669">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">cpr</div>
					<div class="post-datetime">
						5 Aug 2011, 17:46					</div>
				</div>
				<div class="post-content content">
					<p>Hi forum,</p><p>I have <strong>ATTITUDE ADJUSTMENT (bleeding edge, r27832)</strong> on a WNDR3700 Version 1. I want to run it from extroot but I cannot get access to any USB device.</p><p>When I plug in an USB stick I do not get a /dev/sd* , also not when rebooting with a USB stick inserted.</p><p>Here is the full dmesg output:<br /><a href="http://pastebin.com/ZfdiR7cz">http://pastebin.com/ZfdiR7cz</a></p><p>Grepped for &quot;usb&quot; it contains:<br /></p><div class="codebox"><pre><code>usbcore: registered new interface driver usbfs
usbcore: registered new interface driver hub
usbcore: registered new device driver usb
usb 1-1: new high speed USB device number 2 using ar71xx-ehci
Registered led device: wndr3700:green:usb</code></pre></div><p>The output of opkg list-installed is here:<br /><a href="http://pastebin.com/SPgrW1Yf">http://pastebin.com/SPgrW1Yf</a><br />These are the packages containing usb in their name, grepped from that output:<br />kmod-leds-wndr3700-usb - 2.6.39.2-1<br />kmod-ledtrig-usbdev - 2.6.39.2-1<br />kmod-usb-core - 2.6.39.2-1<br />kmod-usb-ohci - 2.6.39.2-1<br />kmod-usb2 - 2.6.39.2-1</p><br /><p>Have I mis-interpreted anything about the USB version to install?<br />Here again some dmesg lines:<br /></p><div class="codebox"><pre><code>usbcore: registered new interface driver usbfs
usbcore: registered new interface driver hub
usbcore: registered new device driver usb
ehci_hcd: USB 2.0 &#039;Enhanced&#039; Host Controller (EHCI) Driver
ar71xx-ehci ar71xx-ehci: Atheros AR71xx built-in EHCI controller
ar71xx-ehci ar71xx-ehci: new USB bus registered, assigned bus number 1
ar71xx-ehci ar71xx-ehci: irq 3, io mem 0x1b000000
ar71xx-ehci ar71xx-ehci: USB 2.0 started, EHCI 1.00
hub 1-0:1.0: USB hub found
hub 1-0:1.0: 2 ports detected
ohci_hcd: USB 1.1 &#039;Open&#039; Host Controller (OHCI) Driver
ar71xx-ohci ar71xx-ohci: Atheros AR71xx built-in OHCI controller
ar71xx-ohci ar71xx-ohci: new USB bus registered, assigned bus number 2
ar71xx-ohci ar71xx-ohci: irq 14, io mem 0x1c000000
hub 2-0:1.0: USB hub found
hub 2-0:1.0: 2 ports detected
usb 1-1: new high speed USB device number 2 using ar71xx-ehci</code></pre></div><p>When I tried to follow <a href="https://wiki.aseith.com/display/PROJECTS/OpenWRT+-+USB+Stick+als+root+overlay+(rootfs%2C+extroot)">https://wiki.aseith.com/display/PROJECT … C+extroot)</a> it seemed as if my &quot;bleeding edge&quot; version does not contain all these packages anymore. There are block-hotplug and block-extroot missing. But I seem to recall they were all merged into block-mount.</p><p>In /proc all that I thought might be relevant is:<br /></p><div class="codebox"><pre><code>root@bronze:~# cat /proc/scsi/usb-storage/0 
   Host scsi0: usb-storage
       Vendor: Generic
      Product: USB Storage
Serial Number: 000000000250
     Protocol: Transparent SCSI
    Transport: Bulk
       Quirks:</code></pre></div><p>Any hints appreciated.</p><br /><p>Another question I do have: There are descriptions for upgrading, e.g. <a href="http://wiki.openwrt.org/doc/howto/generic.sysupgrade">http://wiki.openwrt.org/doc/howto/generic.sysupgrade</a><br />Do they all apply for downgrading, too? Because I might want to try an older version to get USB working...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p140818">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">cpr</div>
					<div class="post-datetime">
						8 Aug 2011, 13:28					</div>
				</div>
				<div class="post-content content">
					<p>Gently bumping! <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p140819">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						8 Aug 2011, 13:33					</div>
				</div>
				<div class="post-content content">
					<p>Did you install kmod-scsi-core?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p140821">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">cpr</div>
					<div class="post-datetime">
						8 Aug 2011, 14:27					</div>
				</div>
				<div class="post-content content">
					<p>Yes, it is installed:<br /># opkg list-installed | grep kmod-scsi<br />kmod-scsi-core - 2.6.39.2-1</p><p>I do not understand the boot process good enough to interprete, why &quot;all things USB&quot; go as far as &quot;hub found, device&nbsp; number ...&quot; but then nothing more...</p><p>Is it easy to downgrade? Is downgrading done the same way as the documentation about upgrading?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p140822">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						8 Aug 2011, 14:42					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>cpr wrote:</cite><blockquote><p>Is it easy to downgrade? Is downgrading done the same way as the documentation about upgrading?</p></blockquote></div><p>Yes, you can just flash an older version on top of a newer version, assuming that the &quot;old version&quot; is still rather new (e.g. flashing 27300 over 27800 should be ok).</p><p>You can pretty freely move up or down inside trunk (or inside Backfire). The only exception are the possible changes in the config file format and/or the other changes in the config files. </p><p>But moving between trunk and Backfire or old Kamikaze versions is more complicated. E.g. Backfire and trunk have slightly different format for network structure in 3700 etc. (I am constantly changing between Backfire and trunk, and the &quot;network&quot; config file is the only differerent one. Otherwise I have identical configs even there.)</p><p>----------------</p><p>One possible piece of advice for you:<br />are you sure that you have installed the support for the filesystem that your stick and disk are using? There seems to be &#039;kmod-fs-ext4&#039; for a Linux file system, but I see no trace of FAT32 ot NTFS support, which are typical file systems for external drives and USB sticks...<br />You might install at least &#039;kmod-fs-msdos&#039; for FAT support.<br />You might also need the &quot;codepage&quot; files, e.g. kmod-nls-iso8859-1 , 437, 850 etc.</p><p><a href="http://wiki.openwrt.org/doc/howto/usb.storage#required.packages">http://wiki.openwrt.org/doc/howto/usb.s … d.packages</a></p>											<p class="post-edited">(Last edited by <strong>hnyman</strong> on 8 Aug 2011, 15:06)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p140823">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						8 Aug 2011, 15:07					</div>
				</div>
				<div class="post-content content">
					<p>Filesystem support doesn&#039;t matter when the device node does not exist.</p><p>@cpr</p><p>I have the config for my build up, you might want to compare with that: <a href="https://forum.openwrt.org/viewtopic.php?id=27722">https://forum.openwrt.org/viewtopic.php?id=27722</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p140829">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">cpr</div>
					<div class="post-datetime">
						8 Aug 2011, 18:31					</div>
				</div>
				<div class="post-content content">
					<p>Thank you!</p><p>Downloaded your <a href="http://enduser.subsignal.org/~trondah/openwrt-wndr3700-r27907-squashfs-sysupgrade.bin">http://enduser.subsignal.org/~trondah/o … pgrade.bin</a> , did a sysupdate -v and am right now partitioning the USB drive!</p><p>Then off to install Nagios! *yay*</p><p>I limited forum-searches to &quot;General Discussion&quot;, for some reason, dunnowhy. Never found your thread. So far.</p>											<p class="post-edited">(Last edited by <strong>cpr</strong> on 8 Aug 2011, 18:31)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>